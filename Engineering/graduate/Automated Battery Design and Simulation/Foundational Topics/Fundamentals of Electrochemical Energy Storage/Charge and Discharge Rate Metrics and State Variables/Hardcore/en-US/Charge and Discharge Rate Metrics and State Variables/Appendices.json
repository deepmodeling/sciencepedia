{
    "hands_on_practices": [
        {
            "introduction": "The relationship between Open-Circuit Voltage ($OCV$) and State of Charge ($SOC$) is a foundational property of any electrochemical cell, forming the basis of most battery models. This practice challenges you to move beyond simple look-up tables by developing a parametric model for the $OCV(SOC)$ curve from noisy data. You will explore how to enforce physical constraints like monotonicity by construction and formulate a regularized optimization problem to ensure the resulting function is both accurate and smooth, a critical skill in automated battery characterization .",
            "id": "3900359",
            "problem": "A lithium-ion cell is tested at a sufficiently low charge/discharge rate (for example, at a C-rate whose magnitude is much less than $1$) with long rest periods such that the measured voltage approximates the Open-Circuit Voltage (OCV). Let the State of Charge (SOC) be denoted by $x \\in [0,1]$, where $x=0$ corresponds to the fully discharged state and $x=1$ to the fully charged state. The Depth of Discharge (DOD) is defined as $\\mathrm{DOD} = 1 - x$. By definition, under galvanostatic operation with current $I(t)$ and nominal capacity $Q_{\\mathrm{nom}}$, the SOC satisfies $\\mathrm{d}x/\\mathrm{d}t = -I(t)/Q_{\\mathrm{nom}}$. For the quasi-equilibrium data considered here, you may neglect dynamic overpotentials and assume the measured voltage equals the OCV.\n\nConsider a single-phase intercalation regime over $x \\in [0,1]$ with constant temperature, where the OCV is a function $V(x)$ of SOC. From basic thermodynamics, the OCV is proportional to the difference of electrochemical potentials between electrodes, and in a stable single-phase region the chemical potential is an increasing function of composition. Therefore, it is physically reasonable to require $V(x)$ to be monotonically nondecreasing in $x$.\n\nYou are given $N$ equilibrium data pairs $\\{(x_i, y_i)\\}_{i=1}^{N}$ with $x_i \\in [0,1]$ denoting SOC and $y_i$ denoting measured OCV in volts. Assume an additive noise model $y_i = V(x_i) + \\eta_i$ with zero-mean noise $\\eta_i$. Let $V_{\\min}$ and $V_{\\max}$ be reliable reference OCV values at $x=0$ and $x=1$, respectively.\n\nTasks:\n1. Starting from the equilibrium definition of OCV in terms of electrode electrochemical potentials and the fact that a stable single-phase free energy has positive curvature, state the monotonicity requirement on $V(x)$ and express it as a differential inequality involving $V'(x)$.\n2. Propose a parametric representation of $V(x)$ that enforces monotonicity by construction via a nonnegative derivative, specifically of the form\n   $$V(x) = E_0 + \\int_{0}^{x} \\left( p(s)^2 + \\varepsilon \\right) \\,\\mathrm{d}s,$$\n   where $p(s)$ is a polynomial with unknown coefficients and $\\varepsilon \\ge 0$ is a small fixed nonnegative constant representing a minimum slope floor. Choose $p(s)$ to be a quadratic polynomial in $s$ with unknown coefficients and derive the closed-form analytic expression for $V(x)$ as a function of $x$ and those coefficients.\n3. Pose a Tikhonov-regularized least-squares problem to estimate the parameters of your model using the data $\\{(x_i,y_i)\\}_{i=1}^{N}$, subject to physically meaningful constraints that include boundary conditions $V(0)=V_{\\min}$ and $V(1)=V_{\\max}$ and a slope bound $0 \\le V'(x) \\le \\gamma_{\\max}$ enforced at a finite set of collocation points in $[0,1]$ for some given $\\gamma_{\\max} > 0$. Use as the regularizer the squared curvature integral $\\int_{0}^{1} \\left(V''(s)\\right)^2 \\,\\mathrm{d}s$. Your formulation must include all decision variables, the objective, and all constraints explicitly in mathematical form.\n4. Provide, as your final answer, the closed-form expression obtained in Task $2$ for $V(x)$ in terms of the polynomial coefficients and $\\varepsilon$. Express the final OCV as a function of SOC without units.\n\nImportant notes:\n- All variables must be clearly defined. State any assumptions you use.\n- Ensure the proposed parameterization is scientifically realistic over $x \\in [0,1]$.\n- The final answer must be a single closed-form analytic expression for $V(x)$ in terms of the chosen parameters, with no units included. No numerical evaluation is required.",
            "solution": "The problem statement has been validated and found to be scientifically grounded, well-posed, and objective. It presents a coherent and standard task in the field of battery modeling, specifically the parametric estimation of the Open-Circuit Voltage (OCV) curve from noisy data under physically meaningful constraints. All provided information is self-consistent and sufficient to proceed with the requested tasks.\n\n1.  Monotonicity Requirement on $V(x)$\n\nThe problem posits, based on thermodynamic principles of stable single-phase systems, that the Open-Circuit Voltage $V(x)$ is a monotonically nondecreasing function of the State of Charge (SOC), $x$. A function is monotonically nondecreasing over an interval if, for any two points in the interval, the function's value at the larger point is greater than or equal to its value at the smaller point.\n\nFor a differentiable function $V(x)$, this property is equivalent to its first derivative being non-negative everywhere in its domain. The derivative of the OCV with respect to SOC, $V'(x) = \\frac{\\mathrm{d}V}{\\mathrm{d}x}$, represents the local slope of the voltage curve. The requirement that $V(x)$ be monotonically nondecreasing over its domain $x \\in [0,1]$ can therefore be expressed as the following differential inequality:\n$$\n\\frac{\\mathrm{d}V}{\\mathrm{d}x} \\ge 0, \\quad \\forall x \\in [0,1]\n$$\nThis inequality ensures that the voltage does not decrease as the cell is charged, which is consistent with the behavior of many lithium-ion battery chemistries in single-phase intercalation regimes.\n\n2.  Parametric Representation for $V(x)$\n\nThe task is to propose a parametric form for $V(x)$ that inherently satisfies the monotonicity constraint. The suggested form is\n$$\nV(x) = E_0 + \\int_{0}^{x} \\left( p(s)^2 + \\varepsilon \\right) \\,\\mathrm{d}s\n$$\nwhere $E_0$ is a constant of integration, $p(s)$ is a function to be defined, and $\\varepsilon \\ge 0$ is a small, fixed constant. By the Fundamental Theorem of Calculus, the derivative of $V(x)$ is $V'(x) = p(x)^2 + \\varepsilon$. Since $p(x)^2 \\ge 0$ for any real-valued function $p(x)$ and $\\varepsilon \\ge 0$ is given, it is guaranteed that $V'(x) \\ge 0$, thus satisfying the monotonicity requirement by construction.\n\nWe are instructed to choose $p(s)$ as a quadratic polynomial in $s$ with unknown coefficients $a_0, a_1, a_2$:\n$$\np(s) = a_2 s^2 + a_1 s + a_0\n$$\nTo find the closed-form expression for $V(x)$, we first compute $p(s)^2$:\n$$\np(s)^2 = (a_2 s^2 + a_1 s + a_0)^2 = a_2^2 s^4 + a_1^2 s^2 + a_0^2 + 2a_1a_2 s^3 + 2a_0a_2 s^2 + 2a_0a_1 s\n$$\nGrouping terms by powers of $s$:\n$$\np(s)^2 = a_2^2 s^4 + (2a_1 a_2) s^3 + (a_1^2 + 2a_0 a_2) s^2 + (2a_0 a_1) s + a_0^2\n$$\nNow, we integrate $p(s)^2 + \\varepsilon$ from $s=0$ to $s=x$:\n$$\n\\int_{0}^{x} \\left( p(s)^2 + \\varepsilon \\right) \\,\\mathrm{d}s = \\int_{0}^{x} \\left( a_2^2 s^4 + 2a_1 a_2 s^3 + (a_1^2 + 2a_0 a_2) s^2 + 2a_0 a_1 s + a_0^2 + \\varepsilon \\right) \\,\\mathrm{d}s\n$$\nPerforming the term-by-term integration yields:\n$$\n\\left[ \\frac{a_2^2}{5}s^5 + \\frac{2a_1 a_2}{4}s^4 + \\frac{a_1^2 + 2a_0 a_2}{3}s^3 + \\frac{2a_0 a_1}{2}s^2 + (a_0^2 + \\varepsilon)s \\right]_0^x\n$$\nEvaluating the definite integral gives:\n$$\n\\frac{a_2^2}{5}x^5 + \\frac{a_1 a_2}{2}x^4 + \\frac{a_1^2 + 2a_0 a_2}{3}x^3 + a_0 a_1 x^2 + (a_0^2 + \\varepsilon)x\n$$\nSubstituting this result back into the expression for $V(x)$, we obtain the final closed-form analytic expression:\n$$\nV(x) = E_0 + \\frac{a_2^2}{5}x^5 + \\frac{a_1 a_2}{2}x^4 + \\frac{a_1^2 + 2a_0 a_2}{3}x^3 + a_0 a_1 x^2 + (a_0^2 + \\varepsilon)x\n$$\nThe parameters of this model are the integration constant $E_0$ and the polynomial coefficients $a_0, a_1, a_2$.\n\n3.  Tikhonov-Regularized Least-Squares Formulation\n\nThe objective is to estimate the model parameters by fitting to the experimental data $\\{(x_i, y_i)\\}_{i=1}^{N}$ while satisfying physical constraints. This can be formulated as a constrained optimization problem.\n\nFirst, we incorporate the boundary condition $V(0) = V_{\\min}$. From our derived expression, $V(0) = E_0$. Thus, we fix $E_0 = V_{\\min}$, which eliminates one parameter. The model becomes:\n$$\nV(x; \\mathbf{a}) = V_{\\min} + \\frac{a_2^2}{5}x^5 + \\frac{a_1 a_2}{2}x^4 + \\frac{a_1^2 + 2a_0 a_2}{3}x^3 + a_0 a_1 x^2 + (a_0^2 + \\varepsilon)x,\n$$\nwhere $\\mathbf{a} = [a_0, a_1, a_2]^T$ is the vector of decision variables.\n\nThe optimization problem is formulated as follows:\n\n**Decision Variables**: The coefficients of the polynomial $p(s)$, denoted by the vector $\\mathbf{a} = [a_0, a_1, a_2]^T \\in \\mathbb{R}^3$.\n\n**Objective Function**: Find $\\mathbf{a}$ that minimizes the Tikhonov-regularized objective function $J(\\mathbf{a})$:\n$$\n\\min_{\\mathbf{a}} J(\\mathbf{a}) = \\sum_{i=1}^{N} \\left( V(x_i; \\mathbf{a}) - y_i \\right)^2 + \\lambda \\int_{0}^{1} \\left(V''(s; \\mathbf{a})\\right)^2 \\,\\mathrm{d}s\n$$\nwhere $\\lambda > 0$ is the Tikhonov regularization parameter that balances the data fit and the smoothness of the resulting curve. The term $V(x_i; \\mathbf{a})$ is the model evaluated at data point $x_i$, and $V''(s; \\mathbf{a})$ is the second derivative (curvature) of the voltage model.\n\n**Constraints**: The optimization is subject to the following constraints:\n1.  Boundary condition at $x=1$: The model must satisfy $V(1) = V_{\\max}$.\n    $$\n    V(1; \\mathbf{a}) = V_{\\min} + \\frac{a_2^2}{5} + \\frac{a_1 a_2}{2} + \\frac{a_1^2 + 2a_0 a_2}{3} + a_0 a_1 + (a_0^2 + \\varepsilon) = V_{\\max}\n    $$\n    This is a quadratic equality constraint on the variables $\\mathbf{a}$.\n\n2.  Slope bounds: The slope $V'(x)$ must be bounded, $0 \\le V'(x) \\le \\gamma_{\\max}$, at a set of $M$ collocation points $\\{z_j\\}_{j=1}^{M}$ in $[0,1]$.\n    We have $V'(x) = p(x)^2 + \\varepsilon$. The lower bound, $V'(x) \\ge \\varepsilon \\ge 0$, is satisfied by construction. The upper bound translates to:\n    $$\n    (a_2 z_j^2 + a_1 z_j + a_0)^2 + \\varepsilon \\le \\gamma_{\\max}, \\quad \\text{for } j = 1, \\dots, M\n    $$\n    This set of $M$ inequalities comprises the quadratic inequality constraints.\n\nThis fully defines the non-linear, constrained optimization problem required to estimate the model parameters.\n\n4.  Final Answer Expression\n\nTask $4$ requests the closed-form expression for $V(x)$ obtained in Task $2$. This expression defines the OCV as a function of SOC $x$ in terms of the model parameters $E_0, a_0, a_1, a_2$ and the fixed constant $\\varepsilon$. This expression is provided in the final answer box below.",
            "answer": "$$\n\\boxed{E_0 + \\frac{a_2^2}{5}x^5 + \\frac{a_1 a_2}{2}x^4 + \\frac{a_1^2 + 2a_0 a_2}{3}x^3 + a_0 a_1 x^2 + (a_0^2 + \\varepsilon)x}\n$$"
        },
        {
            "introduction": "To predict a battery's dynamic behavior, we must translate its physical characteristics into a mathematical framework suitable for simulation and control. This exercise guides you in constructing a state-space representation for a common Equivalent Circuit Model (ECM), capturing not only the evolution of the State of Charge ($SOC$) but also the transient polarization effects . By deriving the system matrices and exploring the concept of observability, you will understand the fundamental conditions required to estimate the battery's internal states from external voltage and current measurements.",
            "id": "3900308",
            "problem": "Consider an Equivalent Circuit Model (ECM) for a lithium-ion cell consisting of an open-circuit voltage source in series with an ohmic resistance and two parallel resistor-capacitor branches that capture polarization dynamics. Define the following quantities and conventions: State of Charge (SOC) $z(t)$, Depth of Discharge (DOD) $d(t)$, Open-Circuit Voltage (OCV) $V_{\\mathrm{oc}}(z)$, series resistance $R_{0}$, branch resistances $R_{1}$ and $R_{2}$, branch capacitances $C_{1}$ and $C_{2}$, and the terminal current $i(t)$ taken as positive for discharge. Let the terminal voltage be $v(t)$. The nominal cell capacity is $Q_{n}$, and depth of discharge is $d(t) = 1 - z(t)$. The ECM is constructed by placing $R_{0}$ in series with two parallel branches $(R_{1}, C_{1})$ and $(R_{2}, C_{2})$, each branch voltage denoted by $v_{1}(t)$ and $v_{2}(t)$ respectively.\n\nStarting from fundamental laws and definitions appropriate to automated battery design and simulation:\n- Charge conservation for SOC: $z(t) = q(t)/Q_{n}$ and $\\frac{dq(t)}{dt} = -i(t)$ for the chosen sign convention.\n- Capacitor constitutive relation: $i_{C}(t) = C \\frac{dv_{C}(t)}{dt}$ and Ohm’s law: $v_{R}(t) = R i_{R}(t)$.\n- Kirchhoff’s laws for the series-parallel network described above.\n\nPerform the following steps:\n1. Construct the continuous-time state-space model with the state vector $x(t) = \\begin{pmatrix} v_{1}(t) \\\\ v_{2}(t) \\\\ z(t) \\end{pmatrix}$, input $u(t) = i(t)$, and output $y(t) = v(t)$, without invoking any shortcut formulas beyond the stated fundamentals.\n2. Linearize the output relation around a fixed operating SOC $z^{\\star}$, where the OCV is approximated by its first-order expansion $V_{\\mathrm{oc}}(z) \\approx V_{\\mathrm{oc}}(z^{\\star}) + \\kappa \\left(z - z^{\\star}\\right)$, with $\\kappa = \\left.\\frac{dV_{\\mathrm{oc}}}{dz}\\right|_{z^{\\star}}$ nonzero and finite. Express the linearized output as an affine function of the states and input, and identify the measurement matrix $C$ and feedthrough term $D$.\n3. Form the $3 \\times 3$ observability matrix $\\mathcal{O} = \\begin{pmatrix} C \\\\ C A \\\\ C A^{2} \\end{pmatrix}$ for the linearized system, where $A$ is the system matrix from step $1$ and $C$ is from step $2$. Then compute its determinant in closed form as a function of $R_{1}$, $R_{2}$, $C_{1}$, $C_{2}$, and $\\kappa$. Assume that all parameters are strictly positive and finite.\n4. Briefly explain, based on your derived model, how voltage and current measurements relate to observability of the states, emphasizing why the slope $\\kappa$ is pivotal and discussing the role (or lack thereof) of the current measurement in the observability calculation.\n\nExpress your final answer as the single closed-form analytic expression for $\\det(\\mathcal{O})$. Do not substitute numerical values, and do not attach units to the final expression. No rounding is required. Your work should be self-contained and scientifically consistent within the stated context.",
            "solution": "We begin by constructing the Equivalent Circuit Model (ECM) from fundamentals. The terminal voltage $v(t)$ is the open-circuit voltage minus the drops across the ohmic resistance and the polarization branches. Let the two parallel resistor-capacitor branches have voltages $v_{1}(t)$ and $v_{2}(t)$ across their capacitors, and let the series resistance be $R_{0}$. Then the terminal voltage is\n$$\nv(t) = V_{\\mathrm{oc}}(z(t)) - v_{1}(t) - v_{2}(t) - R_{0}\\, i(t).\n$$\nThis sign convention is consistent with $i(t) > 0$ indicating discharge, so the ohmic term $R_{0}\\, i(t)$ reduces the terminal voltage relative to the open-circuit voltage.\n\nNext, we derive the state dynamics from capacitor and charge conservation laws. For each polarization branch, the resistor and capacitor are in parallel, so the branch current driven by the terminal current splits between the resistor and capacitor of that branch. The effective branch dynamics commonly used in the Thevenin-type ECM can be succinctly represented by the following standard relations, which follow from $i_{C}(t) = C \\frac{dv(t)}{dt}$, $v_{R}(t) = R i_{R}(t)$, and the constraint that the net branch voltage equals the capacitor voltage $v_{k}(t)$ for branch $k \\in \\{1,2\\}$, yielding a first-order decay of $v_{k}(t)$ driven by the terminal current:\n$$\n\\frac{dv_{1}(t)}{dt} = -\\frac{1}{R_{1} C_{1}}\\, v_{1}(t) + \\frac{1}{C_{1}}\\, i(t),\n\\qquad\n\\frac{dv_{2}(t)}{dt} = -\\frac{1}{R_{2} C_{2}}\\, v_{2}(t) + \\frac{1}{C_{2}}\\, i(t).\n$$\nFor the State of Charge (SOC), we use $z(t) = \\frac{q(t)}{Q_{n}}$ and the conservation of charge $\\frac{dq(t)}{dt} = -i(t)$ with our sign convention, yielding\n$$\n\\frac{dz(t)}{dt} = -\\frac{1}{Q_{n}}\\, i(t).\n$$\nDefining the state vector $x(t) = \\begin{pmatrix} v_{1}(t) \\\\ v_{2}(t) \\\\ z(t) \\end{pmatrix}$ and the input $u(t) = i(t)$, we can write the continuous-time state-space equations\n$$\n\\frac{dx(t)}{dt} = A\\, x(t) + B\\, u(t),\n$$\nwith\n$$\nA = \\begin{pmatrix}\n-\\frac{1}{R_{1} C_{1}} & 0 & 0 \\\\\n0 & -\\frac{1}{R_{2} C_{2}} & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix},\n\\qquad\nB = \\begin{pmatrix}\n\\frac{1}{C_{1}} \\\\\n\\frac{1}{C_{2}} \\\\\n-\\frac{1}{Q_{n}}\n\\end{pmatrix}.\n$$\n\nWe now linearize the output relation around a fixed operating SOC $z^{\\star}$. Let the open-circuit voltage be approximated to first order by\n$$\nV_{\\mathrm{oc}}(z) \\approx V_{\\mathrm{oc}}(z^{\\star}) + \\kappa \\left(z - z^{\\star}\\right),\n\\qquad\n\\kappa = \\left.\\frac{dV_{\\mathrm{oc}}}{dz}\\right|_{z^{\\star}}.\n$$\nDefine the output $y(t) = v(t)$ and consider deviations from the operating point. The linearized output about $(z^{\\star}, v_{1}^{\\star}, v_{2}^{\\star}, i^{\\star})$ (with $v_{1}^{\\star} = 0$, $v_{2}^{\\star} = 0$ at steady state for constant current and sufficiently long times) is\n$$\ny(t) \\approx V_{\\mathrm{oc}}(z^{\\star}) + \\kappa \\left(z(t) - z^{\\star}\\right) - v_{1}(t) - v_{2}(t) - R_{0}\\, i(t).\n$$\nDiscarding constants, the affine mapping of states and input is\n$$\ny(t) = C\\, x(t) + D\\, u(t) + \\text{constant},\n$$\nwhere the measurement matrix $C$ and feedthrough $D$ are\n$$\nC = \\begin{pmatrix} -1 & -1 & \\kappa \\end{pmatrix},\n\\qquad\nD = \\begin{pmatrix} -R_{0} \\end{pmatrix}.\n$$\nFor observability analysis, the constant offset and $D$ do not affect the $(A,C)$ pair’s observability; only $A$ and $C$ matter.\n\nWe now form the observability matrix for the $3$-state system, which we compute explicitly using $A$ and $C$ derived above. Let\n$$\na_{1} = \\frac{1}{R_{1} C_{1}},\n\\qquad\na_{2} = \\frac{1}{R_{2} C_{2}}.\n$$\nThen\n$$\nA = \\operatorname{diag}\\left(-a_{1}, -a_{2}, 0\\right),\n$$\nand we obtain\n$$\nC = \\begin{pmatrix} -1 & -1 & \\kappa \\end{pmatrix},\n\\qquad\nC A = \\begin{pmatrix} -1 & -1 & \\kappa \\end{pmatrix} \\operatorname{diag}\\left(-a_{1}, -a_{2}, 0\\right) = \\begin{pmatrix} a_{1} & a_{2} & 0 \\end{pmatrix},\n$$\n$$\nA^{2} = \\operatorname{diag}\\left(a_{1}^{2}, a_{2}^{2}, 0\\right),\n\\qquad\nC A^{2} = \\begin{pmatrix} -1 & -1 & \\kappa \\end{pmatrix} \\operatorname{diag}\\left(a_{1}^{2}, a_{2}^{2}, 0\\right) = \\begin{pmatrix} -a_{1}^{2} & -a_{2}^{2} & 0 \\end{pmatrix}.\n$$\nThus, the observability matrix is\n$$\n\\mathcal{O} = \n\\begin{pmatrix}\nC \\\\\nC A \\\\\nC A^{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-1 & -1 & \\kappa \\\\\na_{1} & a_{2} & 0 \\\\\n-a_{1}^{2} & -a_{2}^{2} & 0\n\\end{pmatrix}.\n$$\nThe determinant of $\\mathcal{O}$ is readily computed by expanding along the third column (which has only the first element nonzero):\n$$\n\\det(\\mathcal{O}) = \\kappa \\cdot \\det\n\\begin{pmatrix}\na_{1} & a_{2} \\\\\n-a_{1}^{2} & -a_{2}^{2}\n\\end{pmatrix}\n= \\kappa \\left( a_{1} \\left(-a_{2}^{2}\\right) - a_{2} \\left(-a_{1}^{2}\\right) \\right)\n= \\kappa \\left( -a_{1} a_{2}^{2} + a_{2} a_{1}^{2} \\right)\n= \\kappa\\, a_{1} a_{2} \\left( a_{1} - a_{2} \\right).\n$$\nSubstituting back $a_{1}$ and $a_{2}$ yields the closed-form expression\n$$\n\\det(\\mathcal{O}) = \\kappa \\left( \\frac{1}{R_{1} C_{1}} \\right) \\left( \\frac{1}{R_{2} C_{2}} \\right) \\left( \\frac{1}{R_{1} C_{1}} - \\frac{1}{R_{2} C_{2}} \\right).\n$$\n\nFinally, we address observability with voltage and current measurements. The observability of the linearized system depends on the pair $(A,C)$, where $C$ maps the states to the measured terminal voltage. The current $i(t)$ is treated as a known input $u(t)$ in the state-space model; including its measurement does not augment the state-output mapping $C$ because $i(t)$ enters through the feedthrough $D$ and the input channel $B$ rather than directly as a function of the states. Therefore, the rank of the observability matrix is governed by $A$ and $C$ alone. The determinant derived above shows that observability requires $\\kappa \\neq 0$ (the open-circuit voltage must be sensitive to SOC at the operating point) and distinct nonzero polarization rates $a_{1} \\neq a_{2}$ (i.e., distinct time constants $\\tau_{k} = R_{k} C_{k}$). When these conditions hold, the terminal voltage uniquely encodes information about the SOC and polarization states, enabling state estimation in automated battery design and simulation. The current measurement is essential for correct state propagation and input accounting, but it does not increase the observability of the states beyond what $v(t)$ provides in the linearized analysis.",
            "answer": "$$\\boxed{\\kappa \\left( \\frac{1}{R_{1} C_{1}} \\right) \\left( \\frac{1}{R_{2} C_{2}} \\right) \\left( \\frac{1}{R_{1} C_{1}} - \\frac{1}{R_{2} C_{2}} \\right)}$$"
        },
        {
            "introduction": "A robust battery model is only as useful as its ability to predict performance in real-world scenarios, such as charging. This hands-on problem applies core modeling principles to analyze the widely used Constant-Current Constant-Voltage (CC-CV) charging protocol . By deriving the piecewise analytical solution for the State of Charge ($SOC$) trajectory, you will connect the abstract model parameters to a tangible and critical application: accurately predicting the time required to charge a battery.",
            "id": "3900357",
            "problem": "Consider a single lithium-ion cell whose charge dynamics are modeled for automated battery design and simulation. The charge controller applies a constant-current–constant-voltage protocol (CC–CV). Let the state of charge (SOC) be defined by $SOC(t) = \\frac{Q_{\\text{stored}}(t)}{Q_{\\text{nom}}}$ where $Q_{\\text{stored}}(t)$ is the stored charge at time $t$ and $Q_{\\text{nom}}$ is the nominal capacity, and let the depth of discharge (DOD) be $DOD(t) = 1 - SOC(t)$. Assume the following:\n\n- The nominal capacity is $Q_{\\text{nom}} = 3.0\\,\\text{Ah}$.\n- The open circuit voltage is an affine function of SOC given by $OCV(SOC) = V_{0} + \\alpha\\,SOC$ with $V_{0} = 3.3\\,\\text{V}$ and $\\alpha = 0.9\\,\\text{V}$.\n- The internal resistance is constant, $R_{\\text{int}} = 60\\,\\text{m}\\Omega$, over the SOC range considered.\n- The CC current limit is $I_{\\text{CC}} = 4.0\\,\\text{A}$, and the CV voltage limit is $V_{\\text{lim}} = 4.2\\,\\text{V}$.\n- The initial SOC is $SOC(0) = 0.20$.\n- Coulombic efficiency during charging is unity.\n\nStarting only from fundamental definitions and laws (charge conservation $dQ/dt = I$, Ohm’s law for the internal resistance, and the given constitutive relation for $OCV(SOC)$), derive the explicit, piecewise trajectory $SOC(t)$ for the CC–CV charge. Then, compute the total charge time required to reach $SOC = 0.80$, accounting for the transition from CC to CV when the measured terminal voltage $V_{\\text{term}}(t)$ first equals $V_{\\text{lim}}$. Express the final time in seconds and round your answer to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It describes a standard battery charging scenario using a simplified but valid equivalent circuit model. All parameters are provided and are physically realistic.\n\nThe charging process follows a constant-current–constant-voltage (CC–CV) protocol. The analysis is divided into two phases: the CC phase and the CV phase.\n\nThe fundamental equations governing the system are:\n1. The relationship between stored charge $Q_{\\text{stored}}(t)$ and State of Charge $SOC(t)$:\n$$SOC(t) = \\frac{Q_{\\text{stored}}(t)}{Q_{\\text{nom}}}$$\n2. The dynamics of charge accumulation, assuming unity Coulombic efficiency:\n$$\\frac{dQ_{\\text{stored}}(t)}{dt} = I(t)$$\nCombining these gives the differential equation for $SOC(t)$:\n$$Q_{\\text{nom}} \\frac{d(SOC)}{dt} = I(t)$$\n3. The terminal voltage $V_{\\text{term}}(t)$ is described by an equivalent circuit model:\n$$V_{\\text{term}}(t) = OCV(SOC(t)) + I(t)R_{\\text{int}}$$\n4. The open-circuit voltage $OCV$ is an affine function of $SOC$:\n$$OCV(SOC) = V_{0} + \\alpha\\,SOC$$\n\nFirst, we must convert the nominal capacity $Q_{\\text{nom}}$ to SI units (Ampere-seconds or Coulombs):\n$Q_{\\text{nom}} = 3.0\\,\\text{Ah} = 3.0\\,\\text{A} \\times 3600\\,\\text{s} = 10800\\,\\text{As}$.\n\n**Phase 1: Constant Current (CC) Charging**\nThis phase begins at $t=0$ and continues until the terminal voltage $V_{\\text{term}}(t)$ reaches the preset limit $V_{\\text{lim}}$. During this phase, the current is constant: $I(t) = I_{\\text{CC}} = 4.0\\,\\text{A}$.\n\nThe governing equation for $SOC$ is:\n$$Q_{\\text{nom}} \\frac{d(SOC)}{dt} = I_{\\text{CC}}$$\nIntegrating this from $t=0$ to a time $t$ in the CC phase:\n$$\\int_{SOC(0)}^{SOC(t)} d(SOC) = \\frac{I_{\\text{CC}}}{Q_{\\text{nom}}} \\int_{0}^{t} d\\tau$$\n$$SOC(t) - SOC(0) = \\frac{I_{\\text{CC}}}{Q_{\\text{nom}}} t$$\nThus, the $SOC$ trajectory during the CC phase is:\n$$SOC(t) = SOC(0) + \\frac{I_{\\text{CC}}}{Q_{\\text{nom}}} t$$\n\nThe CC phase ends at the transition time, $t_{\\text{trans}}$, when $V_{\\text{term}}(t_{\\text{trans}}) = V_{\\text{lim}}$. The terminal voltage during this phase is:\n$$V_{\\text{term}}(t) = OCV(SOC(t)) + I_{\\text{CC}}R_{\\text{int}} = (V_{0} + \\alpha\\,SOC(t)) + I_{\\text{CC}}R_{\\text{int}}$$\nAt $t = t_{\\text{trans}}$, let $SOC(t_{\\text{trans}}) = SOC_{\\text{trans}}$. The condition is:\n$$V_{\\text{lim}} = V_{0} + \\alpha\\,SOC_{\\text{trans}} + I_{\\text{CC}}R_{\\text{int}}$$\nWe can solve for the state of charge at the transition point:\n$$SOC_{\\text{trans}} = \\frac{V_{\\text{lim}} - V_{0} - I_{\\text{CC}}R_{\\text{int}}}{\\alpha}$$\nUsing the given values: $V_{\\text{lim}} = 4.2\\,\\text{V}$, $V_{0} = 3.3\\,\\text{V}$, $I_{\\text{CC}} = 4.0\\,\\text{A}$, $R_{\\text{int}} = 60\\,\\text{m}\\Omega = 0.060\\,\\Omega$, and $\\alpha = 0.9\\,\\text{V}$.\n$$SOC_{\\text{trans}} = \\frac{4.2 - 3.3 - (4.0 \\times 0.060)}{0.9} = \\frac{0.9 - 0.24}{0.9} = \\frac{0.66}{0.9} = \\frac{11}{15}$$\nNumerically, $SOC_{\\text{trans}} \\approx 0.7333$. Since the target SOC is $0.80$, which is greater than $SOC_{\\text{trans}}$, the cell must enter the CV phase to reach the target.\n\nThe duration of the CC phase, $t_{\\text{trans}}$, is the time taken to reach $SOC_{\\text{trans}}$ from $SOC(0) = 0.20$.\n$$t_{\\text{trans}} = \\frac{Q_{\\text{nom}}}{I_{\\text{CC}}} (SOC_{\\text{trans}} - SOC(0))$$\n$$t_{\\text{trans}} = \\frac{10800\\,\\text{As}}{4.0\\,\\text{A}} \\left(\\frac{11}{15} - 0.20\\right) = 2700\\,\\text{s} \\left(\\frac{11}{15} - \\frac{3}{15}\\right) = 2700\\,\\text{s} \\left(\\frac{8}{15}\\right) = 1440\\,\\text{s}$$\n\n**Phase 2: Constant Voltage (CV) Charging**\nThis phase begins at $t = t_{\\text{trans}}$ and continues towards the final target SOC. During this phase, the terminal voltage is held constant, $V_{\\text{term}}(t) = V_{\\text{lim}}$, and the current $I(t)$ decreases.\n\nFrom the terminal voltage equation:\n$$V_{\\text{lim}} = OCV(SOC(t)) + I(t)R_{\\text{int}} = (V_0 + \\alpha\\,SOC(t)) + I(t)R_{\\text{int}}$$\nWe can express the time-varying current $I(t)$ as:\n$$I(t) = \\frac{V_{\\text{lim}} - V_0 - \\alpha\\,SOC(t)}{R_{\\text{int}}}$$\nSubstituting this into the SOC differential equation:\n$$Q_{\\text{nom}} \\frac{d(SOC)}{dt} = \\frac{V_{\\text{lim}} - V_0 - \\alpha\\,SOC(t)}{R_{\\text{int}}}$$\nThis is a first-order separable ordinary differential equation. We can solve for the time required to charge from $SOC_{\\text{trans}}$ to the final state $SOC_{\\text{final}} = 0.80$. Let this duration be $t_{\\text{CV}} = t_{\\text{final}} - t_{\\text{trans}}$.\n$$\\frac{d(SOC)}{V_{\\text{lim}} - V_0 - \\alpha\\,SOC(t)} = \\frac{dt}{Q_{\\text{nom}}R_{\\text{int}}}$$\nIntegrating from $t_{\\text{trans}}$ to $t_{\\text{final}}$:\n$$\\int_{SOC_{\\text{trans}}}^{SOC_{\\text{final}}} \\frac{d(SOC)}{V_{\\text{lim}} - V_0 - \\alpha\\,SOC} = \\int_{t_{\\text{trans}}}^{t_{\\text{final}}} \\frac{1}{Q_{\\text{nom}}R_{\\text{int}}} dt$$\n$$\\left[ -\\frac{1}{\\alpha} \\ln(V_{\\text{lim}} - V_0 - \\alpha\\,SOC) \\right]_{SOC_{\\text{trans}}}^{SOC_{\\text{final}}} = \\frac{t_{\\text{final}} - t_{\\text{trans}}}{Q_{\\text{nom}}R_{\\text{int}}}$$\n$$t_{\\text{CV}} = t_{\\text{final}} - t_{\\text{trans}} = -\\frac{Q_{\\text{nom}}R_{\\text{int}}}{\\alpha} \\left[ \\ln(V_{\\text{lim}} - V_0 - \\alpha\\,SOC_{\\text{final}}) - \\ln(V_{\\text{lim}} - V_0 - \\alpha\\,SOC_{\\text{trans}}) \\right]$$\n$$t_{\\text{CV}} = \\frac{Q_{\\text{nom}}R_{\\text{int}}}{\\alpha} \\ln\\left(\\frac{V_{\\text{lim}} - V_0 - \\alpha\\,SOC_{\\text{trans}}}{V_{\\text{lim}} - V_0 - \\alpha\\,SOC_{\\text{final}}}\\right)$$\nFrom the CC phase analysis, we know $V_{\\text{lim}} - V_0 - \\alpha\\,SOC_{\\text{trans}} = I_{\\text{CC}}R_{\\text{int}}$. The denominator is $I(t_{\\text{final}})R_{\\text{int}}$. Let's compute these terms.\nNumerator: $I_{\\text{CC}}R_{\\text{int}} = 4.0\\,\\text{A} \\times 0.060\\,\\Omega = 0.24\\,\\text{V}$.\nDenominator: $V_{\\text{lim}} - V_0 - \\alpha\\,SOC_{\\text{final}} = 4.2 - 3.3 - 0.9 \\times 0.80 = 0.9 - 0.72 = 0.18\\,\\text{V}$.\nThe time constant of the CV phase is $\\tau_c = \\frac{Q_{\\text{nom}}R_{\\text{int}}}{\\alpha} = \\frac{10800\\,\\text{As} \\times 0.060\\,\\Omega}{0.9\\,\\text{V}} = \\frac{648}{0.9}\\,\\text{s} = 720\\,\\text{s}$.\n$$t_{\\text{CV}} = 720\\,\\text{s} \\times \\ln\\left(\\frac{0.24}{0.18}\\right) = 720\\,\\text{s} \\times \\ln\\left(\\frac{4}{3}\\right)$$\n\n**Total Charge Time and Piecewise Trajectory**\nThe total time to reach $SOC = 0.80$ is the sum of the durations of the two phases:\n$$t_{\\text{total}} = t_{\\text{trans}} + t_{\\text{CV}} = 1440\\,\\text{s} + 720 \\ln\\left(\\frac{4}{3}\\right)\\,\\text{s}$$\nUsing the value $\\ln(4/3) \\approx 0.28768$, we get:\n$$t_{\\text{total}} \\approx 1440 + 720 \\times 0.28768 = 1440 + 207.13 = 1647.13\\,\\text{s}$$\nRounding to four significant figures, the total time is $1647\\,\\text{s}$.\n\nThe explicit, piecewise trajectory $SOC(t)$ is derived as follows:\nFor the CC phase ($0 \\le t \\le t_{\\text{trans}}$):\n$$SOC(t) = SOC(0) + \\frac{I_{\\text{CC}}}{Q_{\\text{nom}}}t = 0.20 + \\frac{4.0}{10800}t = 0.20 + \\frac{1}{2700}t$$\nFor the CV phase ($t > t_{\\text{trans}}$), the solution to the ODE is of the form $SOC(t) = A + B\\exp(-(t-t_{\\text{trans}})/\\tau_c)$. The steady-state SOC is $A = (V_{\\text{lim}} - V_0)/\\alpha = (4.2-3.3)/0.9 = 1$. The constant $B$ is found from the condition at $t=t_{\\text{trans}}$, giving $B=SOC_{\\text{trans}}-1$.\n$$SOC(t) = 1 + (SOC_{\\text{trans}} - 1)\\exp\\left(-\\frac{t-t_{\\text{trans}}}{\\tau_c}\\right) = 1 + \\left(\\frac{11}{15}-1\\right)\\exp\\left(-\\frac{t-1440}{720}\\right) = 1 - \\frac{4}{15}\\exp\\left(-\\frac{t-1440}{720}\\right)$$\nThe complete piecewise trajectory is:\n$$SOC(t) = \\begin{cases} 0.20 + \\frac{1}{2700}t & \\text{for } 0 \\le t \\le 1440\\,\\text{s} \\\\ 1 - \\frac{4}{15}\\exp\\left(-\\frac{t-1440}{720}\\right) & \\text{for } t > 1440\\,\\text{s} \\end{cases}$$\nThe final requested value is the total time to reach $SOC=0.80$.\n\nFinal calculation:\n$t_{\\text{total}} = 1440 + 720 \\ln(4/3) \\approx 1647.131092...$\nRounding to four significant figures gives $1647$.",
            "answer": "$$\\boxed{1647}$$"
        }
    ]
}