{
    "hands_on_practices": [
        {
            "introduction": "To design high-power batteries, we must move beyond ideal circuit theory and confront real-world operational limits. While the Maximum Power Transfer Theorem provides a theoretical peak, practical battery operation is constrained by factors like minimum allowable voltage and maximum temperature to ensure safety and longevity. This first exercise  challenges you to bridge this gap by formulating and solving a constrained optimization problem. You will discover how operational limits define a feasible operating window and determine the true maximum specific power, a foundational skill in practical battery engineering.",
            "id": "3952506",
            "problem": "A single lithium-ion cell is modeled for high-rate discharge by an ideal source of constant Open-Circuit Voltage (OCV) $U_{0}$ in series with a constant internal resistance $R_{\\mathrm{int}}$. The terminal voltage under a discharge current $I$ is $V(I)=U_{0}-I\\,R_{\\mathrm{int}}$. Joule heating inside the cell is $P_{\\mathrm{loss}}(I)=I^{2}R_{\\mathrm{int}}$. In steady state, the cell’s temperature rise above ambient is modeled by a lumped thermal resistance $R_{\\mathrm{th}}$, so that $\\Delta T(I)=R_{\\mathrm{th}}\\,P_{\\mathrm{loss}}(I)$. The external power delivered to a load is $P_{\\mathrm{ext}}(I)=I\\,V(I)$. The cell has a minimum allowable terminal voltage (voltage floor) $V_{\\min}$ to protect downstream electronics and avoid accelerated degradation, and a maximum allowable cell temperature $T_{\\max}$ with ambient temperature $T_{\\mathrm{amb}}$.\n\nConsider a $U_{0}$-$R_{\\mathrm{int}}$-$R_{\\mathrm{th}}$ cell with the following parameters: $U_{0}=3.7\\,\\mathrm{V}$, $R_{\\mathrm{int}}=0.020\\,\\Omega$, $R_{\\mathrm{th}}=\\frac{35}{18}\\,\\mathrm{K/W}$, $T_{\\max}=60\\,^{\\circ}\\mathrm{C}$, $T_{\\mathrm{amb}}=25\\,^{\\circ}\\mathrm{C}$, $V_{\\min}=3.0\\,\\mathrm{V}$, and cell mass $m=0.070\\,\\mathrm{kg}$. Assume $U_{0}$, $R_{\\mathrm{int}}$, and $R_{\\mathrm{th}}$ are constant with current and temperature over the operating range of interest, and ignore rate-dependent polarization beyond the series resistance.\n\nStarting from the stated definitions and models, do the following:\n\n- Derive $P_{\\mathrm{ext}}(I)$ and show it is strictly concave in $I$ over $I\\ge 0$. Explain why the unconstrained maximizer of $P_{\\mathrm{ext}}(I)$ is not generally feasible when the voltage floor and thermal constraints are enforced, and why the classical Maximum Power Transfer Theorem (MPTT) for linear sources does not directly apply to this electrochemical source under these constraints.\n\n- Formulate the constrained optimization problem to maximize the specific power $P_{\\mathrm{spec}}(I)=\\frac{P_{\\mathrm{ext}}(I)}{m}$ subject to the voltage floor and thermal constraints. Then solve this problem to obtain the optimal discharge current $I^{\\star}$ and the corresponding maximal specific power $P_{\\mathrm{spec}}^{\\star}$.\n\nExpress your final answer as the maximal specific power $P_{\\mathrm{spec}}^{\\star}$ in $\\mathrm{W/kg}$, rounded to four significant figures.",
            "solution": "The problem has been validated and is found to be scientifically grounded, well-posed, and objective. All necessary parameters and models are provided to formulate and solve the requested constrained optimization problem. The problem is a standard exercise in applying fundamental electrical and thermal models to a realistic engineering scenario.\n\nThe first task is to derive the expression for the external power, $P_{\\mathrm{ext}}(I)$, and analyze its properties. The external power is defined as the product of the terminal voltage $V(I)$ and the discharge current $I$.\nGiven the model for the terminal voltage, $V(I)=U_{0}-I\\,R_{\\mathrm{int}}$, the external power is:\n$$ P_{\\mathrm{ext}}(I) = I \\cdot V(I) = I(U_{0}-I\\,R_{\\mathrm{int}}) = U_{0}I - R_{\\mathrm{int}}I^2 $$\nTo determine the concavity of this function for $I \\ge 0$, we compute its second derivative with respect to $I$:\n$$ \\frac{d P_{\\mathrm{ext}}}{dI} = U_{0} - 2R_{\\mathrm{int}}I $$\n$$ \\frac{d^2 P_{\\mathrm{ext}}}{dI^2} = -2R_{\\mathrm{int}} $$\nSince the internal resistance $R_{\\mathrm{int}}$ is a positive physical quantity ($R_{\\mathrm{int}}=0.020\\,\\Omega > 0$), the second derivative $\\frac{d^2 P_{\\mathrm{ext}}}{dI^2}$ is a negative constant. A function with a negative second derivative over its domain is strictly concave. Therefore, $P_{\\mathrm{ext}}(I)$ is a strictly concave function of $I$ for all $I$, including the physical domain $I\\ge0$.\n\nThe unconstrained maximizer of $P_{\\mathrm{ext}}(I)$ is found by setting its first derivative to zero:\n$$ \\frac{d P_{\\mathrm{ext}}}{dI} = U_{0} - 2R_{\\mathrm{int}}I = 0 \\implies I_{\\mathrm{MPTT}} = \\frac{U_{0}}{2R_{\\mathrm{int}}} $$\nThis result corresponds to the classical Maximum Power Transfer Theorem (MPTT) for a DC voltage source with a series resistance, where maximum power is delivered to an external load when the load resistance equals the source's internal resistance. In this state, the terminal voltage is $V(I_{\\mathrm{MPTT}}) = U_{0} - (\\frac{U_{0}}{2R_{\\mathrm{int}}}) R_{\\mathrm{int}} = \\frac{U_{0}}{2}$.\n\nHowever, the MPTT applies to an ideal, unconstrained system. In this problem, the electrochemical cell's operation is limited by two critical constraints: a minimum terminal voltage $V_{\\min}$ and a maximum cell temperature $T_{\\max}$. These constraints define a feasible operating region for the current $I$. If the current $I_{\\mathrm{MPTT}}$ required for maximum power transfer causes the voltage to drop below $V_{\\min}$ or the temperature to rise above $T_{\\max}$, then this operating point is not allowed. The optimization problem is no longer unconstrained, and the MPTT cannot be directly applied to find the *feasible* optimal operating point. The true maximum specific power will then be achieved at a current limited by one of these constraints, which will be less than $I_{\\mathrm{MPTT}}$.\n\nThe second task is to formulate and solve the constrained optimization problem to find the maximum specific power, $P_{\\mathrm{spec}}^{\\star}$. The objective function is to maximize $P_{\\mathrm{spec}}(I) = \\frac{P_{\\mathrm{ext}}(I)}{m}$. Since the mass $m$ is a positive constant, maximizing the specific power $P_{\\mathrm{spec}}(I)$ is equivalent to maximizing the external power $P_{\\mathrm{ext}}(I)$.\n\nThe problem is subject to the following constraints:\n1.  **Voltage Constraint:** The terminal voltage must not fall below $V_{\\min}$.\n    $$ V(I) \\ge V_{\\min} $$\n    $$ U_{0} - I R_{\\mathrm{int}} \\ge V_{\\min} \\implies I R_{\\mathrm{int}} \\le U_{0} - V_{\\min} $$\n    This gives an upper bound on the current:\n    $$ I \\le \\frac{U_{0} - V_{\\min}}{R_{\\mathrm{int}}} \\equiv I_{\\max,V} $$\n2.  **Thermal Constraint:** The cell temperature must not exceed $T_{\\max}$. The cell temperature is $T_{\\mathrm{amb}} + \\Delta T(I)$.\n    $$ T_{\\mathrm{amb}} + \\Delta T(I) \\le T_{\\max} $$\n    Using the given models $\\Delta T(I) = R_{\\mathrm{th}}P_{\\mathrm{loss}}(I)$ and $P_{\\mathrm{loss}}(I) = I^2 R_{\\mathrm{int}}$:\n    $$ R_{\\mathrm{th}} I^2 R_{\\mathrm{int}} \\le T_{\\max} - T_{\\mathrm{amb}} $$\n    $$ I^2 \\le \\frac{T_{\\max} - T_{\\mathrm{amb}}}{R_{\\mathrm{th}} R_{\\mathrm{int}}} $$\n    Since current $I$ must be non-negative, this gives another upper bound:\n    $$ I \\le \\sqrt{\\frac{T_{\\max} - T_{\\mathrm{amb}}}{R_{\\mathrm{th}} R_{\\mathrm{int}}}} \\equiv I_{\\max,T} $$\n3.  **Physical Constraint:** Current must be non-negative, $I \\ge 0$.\n\nThe complete constrained optimization problem is:\n$$ \\text{maximize } P_{\\mathrm{ext}}(I) = U_{0}I - R_{\\mathrm{int}}I^2 $$\n$$ \\text{subject to } 0 \\le I \\le I_{\\max,V} \\text{ and } 0 \\le I \\le I_{\\max,T} $$\nThis can be simplified to maximizing $P_{\\mathrm{ext}}(I)$ over the feasible interval $[0, I_{\\mathrm{lim}}]$, where $I_{\\mathrm{lim}} = \\min(I_{\\max,V}, I_{\\max,T})$.\n\nNow, we substitute the given numerical values:\n$U_{0}=3.7\\,\\mathrm{V}$, $R_{\\mathrm{int}}=0.020\\,\\Omega$, $R_{\\mathrm{th}}=\\frac{35}{18}\\,\\mathrm{K/W}$, $T_{\\max}=60\\,^{\\circ}\\mathrm{C}$, $T_{\\mathrm{amb}}=25\\,^{\\circ}\\mathrm{C}$, $V_{\\min}=3.0\\,\\mathrm{V}$, and $m=0.070\\,\\mathrm{kg}$.\n\nFirst, we calculate the current limits:\n$$ I_{\\max,V} = \\frac{3.7\\,\\mathrm{V} - 3.0\\,\\mathrm{V}}{0.020\\,\\Omega} = \\frac{0.7}{0.020}\\,\\mathrm{A} = 35\\,\\mathrm{A} $$\nThe maximum temperature rise is $\\Delta T_{\\max} = T_{\\max} - T_{\\mathrm{amb}} = 60\\,^{\\circ}\\mathrm{C} - 25\\,^{\\circ}\\mathrm{C} = 35\\,^{\\circ}\\mathrm{C} = 35\\,\\mathrm{K}$.\n$$ I_{\\max,T} = \\sqrt{\\frac{35\\,\\mathrm{K}}{(\\frac{35}{18}\\,\\mathrm{K/W}) \\cdot (0.020\\,\\Omega)}} = \\sqrt{\\frac{18}{0.020}}\\,\\mathrm{A} = \\sqrt{900}\\,\\mathrm{A} = 30\\,\\mathrm{A} $$\nThe overall limit on the current is $I_{\\mathrm{lim}} = \\min(35\\,\\mathrm{A}, 30\\,\\mathrm{A}) = 30\\,\\mathrm{A}$.\nThe feasible region for the current is $I \\in [0, 30\\,\\mathrm{A}]$.\n\nNext, we find the unconstrained maximizer:\n$$ I_{\\mathrm{MPTT}} = \\frac{U_{0}}{2R_{\\mathrm{int}}} = \\frac{3.7\\,\\mathrm{V}}{2 \\cdot 0.020\\,\\Omega} = \\frac{3.7}{0.04}\\,\\mathrm{A} = 92.5\\,\\mathrm{A} $$\nWe are maximizing a strictly concave function $P_{\\mathrm{ext}}(I)$ on the closed interval $[0, I_{\\mathrm{lim}}]$. The vertex of the parabola is at $I_{\\mathrm{MPTT}} = 92.5\\,\\mathrm{A}$. Since $I_{\\mathrm{MPTT}} > I_{\\mathrm{lim}}$, the function $P_{\\mathrm{ext}}(I)$ is strictly increasing over the entire feasible interval $[0, 30\\,\\mathrm{A}]$. Therefore, the maximum value of $P_{\\mathrm{ext}}(I)$ within this interval occurs at the right-hand boundary. The optimal current is:\n$$ I^{\\star} = I_{\\mathrm{lim}} = 30\\,\\mathrm{A} $$\nThis shows that the cell's operation is limited by the thermal constraint.\n\nNow we calculate the maximum external power at this optimal current:\n$$ P_{\\mathrm{ext}}^{\\star} = P_{\\mathrm{ext}}(I^{\\star}) = U_{0}I^{\\star} - R_{\\mathrm{int}}(I^{\\star})^2 $$\n$$ P_{\\mathrm{ext}}^{\\star} = (3.7\\,\\mathrm{V})(30\\,\\mathrm{A}) - (0.020\\,\\Omega)(30\\,\\mathrm{A})^2 = 111\\,\\mathrm{W} - (0.020 \\cdot 900)\\,\\mathrm{W} = 111\\,\\mathrm{W} - 18\\,\\mathrm{W} = 93\\,\\mathrm{W} $$\nFinally, we compute the corresponding maximal specific power, $P_{\\mathrm{spec}}^{\\star}$:\n$$ P_{\\mathrm{spec}}^{\\star} = \\frac{P_{\\mathrm{ext}}^{\\star}}{m} = \\frac{93\\,\\mathrm{W}}{0.070\\,\\mathrm{kg}} \\approx 1328.5714\\,\\mathrm{W/kg} $$\nRounding to four significant figures, we get $1329\\,\\mathrm{W/kg}$.\nAt this optimal current $I^{\\star}=30\\,\\mathrm{A}$, the terminal voltage is $V(30) = 3.7 - 30 \\times 0.02 = 3.7-0.6 = 3.1\\,\\mathrm{V}$, which is above $V_{\\min}=3.0\\,\\mathrm{V}$. The temperature is $T(30) = 25 + (\\frac{35}{18}) \\times (30^2 \\times 0.02) = 25 + (\\frac{35}{18}) \\times 18 = 25 + 35 = 60\\,^{\\circ}\\mathrm{C}$, which is exactly $T_{\\max}$. Both constraints are satisfied.",
            "answer": "$$\n\\boxed{1329}\n$$"
        },
        {
            "introduction": "Building on the concept of a thermal limit, this practice moves from an abstract constraint to a concrete thermal management scenario. Here, the maximum sustainable power is not just an arbitrary limit but is dictated by the fundamental energy balance between heat generation within the battery and heat dissipation to the environment. This problem  requires you to apply a steady-state thermal model, connecting complex electrochemical heat sources—including both irreversible ohmic heating and reversible entropic heating—to the cooling capacity of a system governed by Newton's law of cooling. This exercise will solidify your understanding of the critical interplay between a battery's electrical performance and its thermal design.",
            "id": "3952501",
            "problem": "An automated battery design and simulation pipeline evaluates a prismatic lithium-ion module under steady, uniform forced-air cooling. The thermal controller imposes an allowable surface-to-ambient temperature rise. The module geometry is a rectangular prism of length $l = 0.50\\ \\mathrm{m}$, width $w = 0.30\\ \\mathrm{m}$, and height $h_m = 0.20\\ \\mathrm{m}$, giving a total external area available for convection. The ambient air temperature is $T_{\\infty} = 298\\ \\mathrm{K}$, and an allowable rise of $\\Delta T = 20\\ \\mathrm{K}$ is specified. The convection coefficient is $h = 75\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$ and is uniform over the exposed surface area. Neglect radiation and conduction to supports.\n\nThe pack consists of $N = 12$ identical cells in series with Open-Circuit Voltage (OCV) per cell $U_{\\mathrm{cell}} = 4.0\\ \\mathrm{V}$, so the pack open-circuit voltage is $U_{\\mathrm{ocv}} = N U_{\\mathrm{cell}}$. The pack-level ohmic resistance is $R_{\\mathrm{pack}} = 0.025\\ \\Omega$. The OCV temperature coefficient per cell is $\\left.\\frac{\\partial U_{\\mathrm{cell}}}{\\partial T}\\right|_{I=0} = -2.0 \\times 10^{-4}\\ \\mathrm{V\\,K^{-1}}$ (assume it is constant over the operating range), so the pack-level OCV temperature coefficient is $N$ times the per-cell value. Assume the battery heat generation in steady discharge is well-approximated by the sum of ohmic heating and entropic heating, $q_{\\mathrm{gen}}(I) = I^{2} R_{\\mathrm{pack}} + I T_{s} \\left(\\frac{\\partial U_{\\mathrm{ocv}}}{\\partial T}\\right)$, where $I$ is the discharge current (positive for discharge) and $T_{s}$ is the module surface temperature, which at the allowable rise can be taken as $T_{s} = T_{\\infty} + \\Delta T$. Also assume the terminal voltage under load is $V(I) = U_{\\mathrm{ocv}} - I R_{\\mathrm{pack}}$.\n\nStarting from first principles (energy balance and Newton’s law of cooling), determine the maximum sustained electrical power $P_{\\max} = I V(I)$ that the module can deliver while satisfying the steady-state thermal constraint $q_{\\mathrm{gen}}(I) \\le h A \\Delta T$, where $A$ is the total exposed surface area of the module. Then compute the sustained specific power $P_{\\max}/m$ for module mass $m = 22\\ \\mathrm{kg}$ and the sustained power density $P_{\\max}/V_{\\mathrm{mod}}$ in watts per liter, where $V_{\\mathrm{mod}} = l w h_{m}$ is the module volume.\n\nExpress the sustained electrical power in watts ($\\mathrm{W}$), the specific power in watts per kilogram ($\\mathrm{W\\,kg^{-1}}$), and the power density in watts per liter ($\\mathrm{W\\,L^{-1}}$). Round each of your answers to three significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of thermodynamics and electrochemistry, is well-posed with sufficient and consistent data, and is expressed in objective, formal language. We can proceed with a solution.\n\nThe fundamental principle for this steady-state problem is the energy balance: the rate of heat generated within the battery module, $q_{\\mathrm{gen}}$, must be equal to the rate of heat dissipated to the surroundings, $q_{\\mathrm{cool}}$. The maximum sustained power corresponds to the maximum allowable heat generation rate.\n$$q_{\\mathrm{gen}} = q_{\\mathrm{cool}}$$\nThe problem specifies that the allowable surface-to-ambient temperature rise is $\\Delta T = 20\\ \\mathrm{K}$. The maximum rate of heat dissipation is governed by Newton's law of cooling:\n$$q_{\\mathrm{cool}} = h A \\Delta T$$\nwhere $h = 75\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$ is the convection coefficient and $A$ is the total external surface area of the prismatic module. Given the dimensions $l = 0.50\\ \\mathrm{m}$, $w = 0.30\\ \\mathrm{m}$, and $h_m = 0.20\\ \\mathrm{m}$, the area $A$ is:\n$$A = 2(lw + lh_m + wh_m) = 2((0.50\\ \\mathrm{m})(0.30\\ \\mathrm{m}) + (0.50\\ \\mathrm{m})(0.20\\ \\mathrm{m}) + (0.30\\ \\mathrm{m})(0.20\\ \\mathrm{m}))$$\n$$A = 2(0.15\\ \\mathrm{m^2} + 0.10\\ \\mathrm{m^2} + 0.06\\ \\mathrm{m^2}) = 2(0.31\\ \\mathrm{m^2}) = 0.62\\ \\mathrm{m^2}$$\nThe maximum rate of heat dissipation is therefore:\n$$q_{\\mathrm{cool}} = (75\\ \\mathrm{W\\,m^{-2}\\,K^{-1}})(0.62\\ \\mathrm{m^2})(20\\ \\mathrm{K}) = 930\\ \\mathrm{W}$$\nThis sets the upper limit for the heat generation rate, $q_{\\mathrm{gen}} \\le 930\\ \\mathrm{W}$. To find the maximum power, we set $q_{\\mathrm{gen}}$ to this limit.\n\nThe heat generation is given by the sum of ohmic and entropic heating:\n$$q_{\\mathrm{gen}}(I) = I^{2} R_{\\mathrm{pack}} + I T_{s} \\left(\\frac{\\partial U_{\\mathrm{ocv}}}{\\partial T}\\right)$$\nWe must first calculate the pack-level parameters. The pack consists of $N=12$ cells in series.\nThe pack open-circuit voltage $U_{\\mathrm{ocv}}$ is:\n$$U_{\\mathrm{ocv}} = N U_{\\mathrm{cell}} = 12 \\times 4.0\\ \\mathrm{V} = 48\\ \\mathrm{V}$$\nThe pack-level OCV temperature coefficient is:\n$$\\frac{\\partial U_{\\mathrm{ocv}}}{\\partial T} = N \\left(\\frac{\\partial U_{\\mathrm{cell}}}{\\partial T}\\right) = 12 \\times (-2.0 \\times 10^{-4}\\ \\mathrm{V\\,K^{-1}}) = -2.4 \\times 10^{-3}\\ \\mathrm{V\\,K^{-1}}$$\nThe surface temperature $T_s$ is given by the ambient temperature $T_{\\infty} = 298\\ \\mathrm{K}$ plus the allowable rise $\\Delta T = 20\\ \\mathrm{K}$:\n$$T_s = T_{\\infty} + \\Delta T = 298\\ \\mathrm{K} + 20\\ \\mathrm{K} = 318\\ \\mathrm{K}$$\nThe entropic heating term's coefficient is:\n$$T_{s} \\left(\\frac{\\partial U_{\\mathrm{ocv}}}{\\partial T}\\right) = (318\\ \\mathrm{K})(-2.4 \\times 10^{-3}\\ \\mathrm{V\\,K^{-1}}) = -0.7632\\ \\mathrm{V}$$\nThe pack resistance is $R_{\\mathrm{pack}} = 0.025\\ \\Omega$. Setting $q_{\\mathrm{gen}}(I) = q_{\\mathrm{cool}}$:\n$$I^{2} (0.025\\ \\Omega) + I (-0.7632\\ \\mathrm{V}) = 930\\ \\mathrm{W}$$\nThis can be written as a standard quadratic equation for the current $I$:\n$$0.025 I^2 - 0.7632 I - 930 = 0$$\nWe solve for $I$ using the quadratic formula, $I = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, where $a = 0.025$, $b = -0.7632$, and $c = -930$.\n$$I = \\frac{-(-0.7632) \\pm \\sqrt{(-0.7632)^2 - 4(0.025)(-930)}}{2(0.025)}$$\n$$I = \\frac{0.7632 \\pm \\sqrt{0.58245824 + 93}}{0.05}$$\n$$I = \\frac{0.7632 \\pm \\sqrt{93.58245824}}{0.05} \\approx \\frac{0.7632 \\pm 9.6738}{0.05}$$\nSince discharge current must be positive, we take the positive root:\n$$I_{\\max} \\approx \\frac{0.7632 + 9.6738}{0.05} \\approx \\frac{10.437}{0.05} \\approx 208.74\\ \\mathrm{A}$$\nNow, we calculate the maximum sustained electrical power, $P_{\\max}$. The terminal voltage is $V(I) = U_{\\mathrm{ocv}} - I R_{\\mathrm{pack}}$, so the power is $P = I(U_{\\mathrm{ocv}} - I R_{\\mathrm{pack}})$.\n$$P_{\\max} = I_{\\max}(U_{\\mathrm{ocv}} - I_{\\max} R_{\\mathrm{pack}})$$\n$$P_{\\max} \\approx (208.74\\ \\mathrm{A})(48\\ \\mathrm{V} - (208.74\\ \\mathrm{A})(0.025\\ \\Omega))$$\n$$P_{\\max} \\approx 208.74\\ (48 - 5.2185) = 208.74 \\times 42.7815 \\approx 8930.36\\ \\mathrm{W}$$\nRounding to three significant figures, the maximum sustained power is $8.93 \\times 10^3\\ \\mathrm{W}$.\n\nNext, we compute the specific power and power density.\nThe module mass is given as $m = 22\\ \\mathrm{kg}$. The specific power is:\n$$\\frac{P_{\\max}}{m} \\approx \\frac{8930.36\\ \\mathrm{W}}{22\\ \\mathrm{kg}} \\approx 405.925\\ \\mathrm{W\\,kg^{-1}}$$\nRounding to three significant figures, the specific power is $406\\ \\mathrm{W\\,kg^{-1}}$.\n\nThe module volume is $V_{\\mathrm{mod}} = lwh_m$:\n$$V_{\\mathrm{mod}} = (0.50\\ \\mathrm{m})(0.30\\ \\mathrm{m})(0.20\\ \\mathrm{m}) = 0.03\\ \\mathrm{m^3}$$\nSince $1\\ \\mathrm{L} = 10^{-3}\\ \\mathrm{m^3}$, the volume in liters is:\n$$V_{\\mathrm{mod}} = 0.03\\ \\mathrm{m^3} \\times \\frac{1000\\ \\mathrm{L}}{1\\ \\mathrm{m^3}} = 30\\ \\mathrm{L}$$\nThe power density is:\n$$\\frac{P_{\\max}}{V_{\\mathrm{mod}}} \\approx \\frac{8930.36\\ \\mathrm{W}}{30\\ \\mathrm{L}} \\approx 297.679\\ \\mathrm{W\\,L^{-1}}$$\nRounding to three significant figures, the power density is $298\\ \\mathrm{W\\,L^{-1}}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 8.93 \\times 10^3 & 406 & 298 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Ultimately, designing for high specific power and power density is a system-level challenge. This final hands-on practice  synthesizes cell-level characteristics and operational constraints into a complete pack-level simulation. You will construct a system model from the bottom up, accounting for the series-parallel architecture of the cell array and the parasitic resistance of interconnections. By determining the maximum power output of the entire pack within a specified voltage window, this exercise demonstrates how to translate component properties into the system-wide performance metrics that drive the design of applications like electric vehicles.",
            "id": "3952556",
            "problem": "A single battery cell is characterized by an open-circuit voltage function $U(x)$ and an internal resistance function $R_{\\mathrm{int}}(x)$, where $x$ is the State of Charge (SOC). Consider a pack composed of $N_s$ cells in series and $N_p$ cells in parallel. The pack includes a lumped busbar resistance $R_{\\mathrm{bus}}$ (treated as series at the pack level). Under a discharge current $I \\geq 0$, the pack terminal voltage is defined by the composition of series and parallel connections and Ohm's law. The pack electrical power is the product of its terminal voltage and current. The pack has voltage limits $V_{\\min}$ and $V_{\\max}$ such that admissible operation requires $V_{\\min} \\leq V_{\\mathrm{pack}}(I,x) \\leq V_{\\max}$.\n\nFrom first principles, use the definitions of open-circuit voltage, Ohm's law, and series–parallel equivalences to derive the pack terminal voltage $V_{\\mathrm{pack}}(I,x)$ as a function of $I$ and $x$, and the corresponding pack power $P(I,x)$. Then, for a given $x$, $N_s$, $N_p$, $R_{\\mathrm{bus}}$, $V_{\\min}$, and $V_{\\max}$, determine the maximum admissible pack power $P_{\\max}$ over all $I \\geq 0$ satisfying the voltage limits. Finally, normalize $P_{\\max}$ to obtain the specific power $P_{\\max}/m_{\\mathrm{pack}}$ and volumetric power density $P_{\\max}/V_{\\mathrm{pack,geom}}$, where $m_{\\mathrm{pack}}$ and $V_{\\mathrm{pack,geom}}$ are the total pack mass and total geometric pack volume obtained by summing contributions from all cells and the busbar assembly.\n\nAll outputs must be expressed in the following physical units and formats:\n- Pack-level maximum electrical power $P_{\\max}$ in watts, denoted $\\mathrm{W}$.\n- Specific power $P_{\\max}/m_{\\mathrm{pack}}$ in watts per kilogram, denoted $\\mathrm{W/kg}$.\n- Volumetric power density $P_{\\max}/V_{\\mathrm{pack,geom}}$ in watts per cubic meter, denoted $\\mathrm{W/m^3}$.\nExpress each quantity as a decimal number.\n\nUse the following parameterized cell models and pack properties. For each test case, compute $P_{\\max}$, $P_{\\max}/m_{\\mathrm{pack}}$, and $P_{\\max}/V_{\\mathrm{pack,geom}}$.\n\nCell models shared across all cases:\n- Open-circuit voltage function $U(x) = u_0 + u_1 x + u_2 x^2$ with coefficients $u_0 = 3.30\\,\\mathrm{V}$, $u_1 = 0.70\\,\\mathrm{V}$, $u_2 = 0.20\\,\\mathrm{V}$.\n- Internal resistance function $R_{\\mathrm{int}}(x) = r_0 + r_1 (1-x)^2$ with coefficients $r_0 = 0.0030\\,\\Omega$, $r_1 = 0.0020\\,\\Omega$.\n\nPack-level composition and constraints to apply in all cases:\n- For discharge current $I \\geq 0$, the pack terminal voltage is $V_{\\mathrm{pack}}(I,x)$ obtained from series–parallel composition and Ohm's law using $U(x)$ and $R_{\\mathrm{int}}(x)$.\n- The pack voltage limits are $V_{\\min}$ and $V_{\\max}$; only currents $I$ such that $V_{\\mathrm{pack}}(I,x) \\in [V_{\\min}, V_{\\max}]$ are admissible.\n- Pack mass and volume are $m_{\\mathrm{pack}} = N_s N_p m_{\\mathrm{cell}} + m_{\\mathrm{bus}}$ and $V_{\\mathrm{pack,geom}} = N_s N_p V_{\\mathrm{cell}} + V_{\\mathrm{bus}}$.\n\nTest suite:\n- Case $1$ (happy path):\n  - $x = 0.50$.\n  - $N_s = 96$, $N_p = 4$.\n  - $R_{\\mathrm{bus}} = 0.010\\,\\Omega$.\n  - $V_{\\min} = 300.0\\,\\mathrm{V}$, $V_{\\max} = 400.0\\,\\mathrm{V}$.\n  - $m_{\\mathrm{cell}} = 0.045\\,\\mathrm{kg}$, $m_{\\mathrm{bus}} = 3.0\\,\\mathrm{kg}$.\n  - $V_{\\mathrm{cell}} = 2.4\\times 10^{-5}\\,\\mathrm{m^3}$, $V_{\\mathrm{bus}} = 0.0030\\,\\mathrm{m^3}$.\n- Case $2$ (boundary, pack minimum voltage equals open-circuit voltage):\n  - $x = 1.00$.\n  - $N_s = 96$, $N_p = 4$.\n  - $R_{\\mathrm{bus}} = 0.000\\,\\Omega$.\n  - $V_{\\min} = 403.2\\,\\mathrm{V}$, $V_{\\max} = 410.0\\,\\mathrm{V}$.\n  - $m_{\\mathrm{cell}} = 0.045\\,\\mathrm{kg}$, $m_{\\mathrm{bus}} = 2.0\\,\\mathrm{kg}$.\n  - $V_{\\mathrm{cell}} = 2.4\\times 10^{-5}\\,\\mathrm{m^3}$, $V_{\\mathrm{bus}} = 0.0025\\,\\mathrm{m^3}$.\n- Case $3$ (edge, upper voltage limit below open-circuit pack voltage with larger busbar resistance and different parallel count):\n  - $x = 0.80$.\n  - $N_s = 96$, $N_p = 3$.\n  - $R_{\\mathrm{bus}} = 0.050\\,\\Omega$.\n  - $V_{\\min} = 280.0\\,\\mathrm{V}$, $V_{\\max} = 360.0\\,\\mathrm{V}$.\n  - $m_{\\mathrm{cell}} = 0.050\\,\\mathrm{kg}$, $m_{\\mathrm{bus}} = 4.0\\,\\mathrm{kg}$.\n  - $V_{\\mathrm{cell}} = 2.5\\times 10^{-5}\\,\\mathrm{m^3}$, $V_{\\mathrm{bus}} = 0.0040\\,\\mathrm{m^3}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is itself a comma-separated list of the three decimal numbers $[P_{\\max},P_{\\max}/m_{\\mathrm{pack}},P_{\\max}/V_{\\mathrm{pack,geom}}]$ for the corresponding test case, in watts, watts per kilogram, and watts per cubic meter, respectively. For example, the output format must look like $[[a,b,c],[d,e,f],[g,h,i]]$.",
            "solution": "The problem is valid as it is scientifically grounded in standard electrical circuit theory (Thévenin models, series/parallel combinations), well-posed, and provides a complete and consistent set of parameters for calculation.\n\nThe solution requires deriving the pack-level electrical model and then solving a constrained optimization problem to find the maximum power.\n\n**1. Derivation of Pack Electrical Model**\n\nA single cell is modeled with an open-circuit voltage (OCV) $U(x)$ and an internal resistance $R_{\\mathrm{int}}(x)$, where $x$ is the state of charge. The battery pack consists of $N_s$ cells in series and $N_p$ cells in parallel.\n\nFirst, consider a single string of $N_s$ cells in series. The total OCV and resistance of the string are:\n$$U_{\\mathrm{string}}(x) = N_s U(x)$$\n$$R_{\\mathrm{string}}(x) = N_s R_{\\mathrm{int}}(x)$$\n\nNext, $N_p$ of these strings are connected in parallel. The equivalent OCV of the parallel combination is the same as the OCV of a single string. The equivalent resistance is found by combining the string resistances in parallel:\n$$U_{\\mathrm{pack,cells}}(x) = U_{\\mathrm{string}}(x) = N_s U(x)$$\n$$R_{\\mathrm{pack,cells}}(x) = \\left( \\sum_{j=1}^{N_p} \\frac{1}{R_{\\mathrm{string}}(x)} \\right)^{-1} = \\frac{R_{\\mathrm{string}}(x)}{N_p} = \\frac{N_s}{N_p} R_{\\mathrm{int}}(x)$$\n\nThe total pack model includes a lumped busbar resistance $R_{\\mathrm{bus}}$ in series at the pack level. The final pack OCV, which we denote $U_{\\mathrm{ocv}}$, is unchanged. The total pack equivalent resistance, $R_{\\mathrm{eq}}$, is the sum of the cell bank's resistance and the busbar resistance.\n$$U_{\\mathrm{ocv}}(x) = N_s U(x)$$\n$$R_{\\mathrm{eq}}(x) = \\frac{N_s}{N_p} R_{\\mathrm{int}}(x) + R_{\\mathrm{bus}}$$\n\nThe terminal voltage of the pack, $V_{\\mathrm{pack}}$, under a total discharge current $I \\ge 0$, is given by Ohm's law applied to this equivalent circuit:\n$$V_{\\mathrm{pack}}(I,x) = U_{\\mathrm{ocv}}(x) - I \\cdot R_{\\mathrm{eq}}(x)$$\n\nThe electrical power delivered by the pack, $P(I,x)$, is the product of its terminal voltage and current:\n$$P(I,x) = V_{\\mathrm{pack}}(I,x) \\cdot I = I \\cdot U_{\\mathrm{ocv}}(x) - I^2 \\cdot R_{\\mathrm{eq}}(x)$$\n\n**2. Constrained Power Maximization**\n\nFor a fixed SOC $x$, the power $P(I)$ is a quadratic function of current $I$, representing a downward-opening parabola. The unconstrained maximum of this parabola occurs at its vertex, found by setting the derivative $\\frac{dP}{dI}$ to zero:\n$$\\frac{dP}{dI} = U_{\\mathrm{ocv}}(x) - 2 I \\cdot R_{\\mathrm{eq}}(x) = 0 \\implies I_{\\mathrm{peak}} = \\frac{U_{\\mathrm{ocv}}(x)}{2 R_{\\mathrm{eq}}(x)}$$\n\nThe operation is constrained by the pack voltage limits, $V_{\\min} \\le V_{\\mathrm{pack}}(I,x) \\le V_{\\max}$. Since $V_{\\mathrm{pack}}(I,x)$ is a monotonically decreasing function of $I$, these voltage limits define an admissible interval for the current $I \\ge 0$.\n\nFrom $V_{\\mathrm{pack}}(I,x) \\ge V_{\\min}$:\n$$U_{\\mathrm{ocv}}(x) - I \\cdot R_{\\mathrm{eq}}(x) \\ge V_{\\min} \\implies I \\le \\frac{U_{\\mathrm{ocv}}(x) - V_{\\min}}{R_{\\mathrm{eq}}(x)}$$\nThis defines the maximum admissible current, $I_{\\max, \\mathrm{adm}}$. For a positive discharge current to be possible, we must have $U_{\\mathrm{ocv}}(x) \\ge V_{\\min}$. If $U_{\\mathrm{ocv}}(x) < V_{\\min}$, no discharge is possible, and the maximum power is $0 \\, \\mathrm{W}$.\n\nFrom $V_{\\mathrm{pack}}(I,x) \\le V_{\\max}$:\n$$U_{\\mathrm{ocv}}(x) - I \\cdot R_{\\mathrm{eq}}(x) \\le V_{\\max} \\implies I \\ge \\frac{U_{\\mathrm{ocv}}(x) - V_{\\max}}{R_{\\mathrm{eq}}(x)}$$\nThis defines a lower bound for the current. This lower bound is positive only if $U_{\\mathrm{ocv}}(x) > V_{\\max}$.\n\nCombining with $I \\ge 0$, the admissible current interval is $[I_{\\min, \\mathrm{adm}}, I_{\\max, \\mathrm{adm}}]$:\n$$I_{\\min, \\mathrm{adm}} = \\max\\left(0, \\frac{U_{\\mathrm{ocv}}(x) - V_{\\max}}{R_{\\mathrm{eq}}(x)}\\right)$$\n$$I_{\\max, \\mathrm{adm}} = \\frac{U_{\\mathrm{ocv}}(x) - V_{\\min}}{R_{\\mathrm{eq}}(x)}$$\nIf $I_{\\min, \\mathrm{adm}} > I_{\\max, \\mathrm{adm}}$, the admissible current set is empty, and thus $P_{\\max} = 0 \\, \\mathrm{W}$.\n\nThe maximum admissible power, $P_{\\max}$, is the maximum value of the parabolic function $P(I)$ on the closed interval $[I_{\\min, \\mathrm{adm}}, I_{\\max, \\mathrm{adm}}]$. The optimal current, $I_{\\mathrm{opt}}$, is found by clamping $I_{\\mathrm{peak}}$ to this interval:\n$$I_{\\mathrm{opt}} = \\max(I_{\\min, \\mathrm{adm}}, \\min(I_{\\mathrm{peak}}, I_{\\max, \\mathrm{adm}}))$$\nThe maximum power is then calculated at this optimal current:\n$$P_{\\max} = P(I_{\\mathrm{opt}}, x) = I_{\\mathrm{opt}} \\cdot U_{\\mathrm{ocv}}(x) - I_{\\mathrm{opt}}^2 \\cdot R_{\\mathrm{eq}}(x)$$\n\n**3. Specific Power and Power Density**\n\nThe pack mass $m_{\\mathrm{pack}}$ and geometric volume $V_{\\mathrm{pack,geom}}$ are calculated from the cell and busbar contributions:\n$$m_{\\mathrm{pack}} = N_s N_p m_{\\mathrm{cell}} + m_{\\mathrm{bus}}$$\n$$V_{\\mathrm{pack,geom}} = N_s N_p V_{\\mathrm{cell}} + V_{\\mathrm{bus}}$$\n\nThe specific power and volumetric power density are then found by normalizing $P_{\\max}$ by these quantities:\n$$\\text{Specific Power} = \\frac{P_{\\max}}{m_{\\mathrm{pack}}}$$\n$$\\text{Volumetric Power Density} = \\frac{P_{\\max}}{V_{\\mathrm{pack,geom}}}$$\n\nThis complete algorithm is implemented for each test case provided.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes maximum power, specific power, and power density for battery pack test cases.\n    \"\"\"\n\n    def U_cell(x, u0, u1, u2):\n        \"\"\"Calculates open-circuit voltage of a single cell.\"\"\"\n        return u0 + u1 * x + u2 * x**2\n\n    def R_int_cell(x, r0, r1):\n        \"\"\"Calculates internal resistance of a single cell.\"\"\"\n        return r0 + r1 * (1 - x)**2\n\n    def calculate_power_metrics(params):\n        \"\"\"\n        Calculates P_max, P_max/m_pack, and P_max/V_pack_geom for a single test case.\n        \"\"\"\n        x, Ns, Np, R_bus, V_min, V_max, m_cell, m_bus, V_cell, V_bus = params\n        \n        # Cell model parameters (shared across all cases)\n        u0, u1, u2 = 3.30, 0.70, 0.20\n        r0, r1 = 0.0030, 0.0020\n\n        # Step 1: Calculate cell-level properties at the given SOC\n        U_c = U_cell(x, u0, u1, u2)\n        R_int_c = R_int_cell(x, r0, r1)\n\n        # Step 2: Calculate pack-level equivalent circuit properties\n        U_ocv = Ns * U_c\n        R_eq = (Ns / Np) * R_int_c + R_bus\n\n        # Step 3: Handle edge case where OCV is below V_min (no discharge possible)\n        if U_ocv < V_min:\n            return 0.0, 0.0, 0.0\n\n        # Step 4: Determine the admissible current interval [I_min_adm, I_max_adm]\n        # Upper bound on current from V_min\n        I_max_adm = (U_ocv - V_min) / R_eq\n        \n        # Lower bound on current from V_max and I >= 0\n        I_min_adm = 0.0\n        if U_ocv > V_max:\n            I_min_adm = (U_ocv - V_max) / R_eq\n            \n        # If the interval is invalid, no discharge is possible.\n        if I_min_adm > I_max_adm:\n            return 0.0, 0.0, 0.0\n            \n        # Step 5: Determine the optimal current for maximum power\n        # Current for unconstrained peak power (vertex of the power parabola)\n        I_peak = U_ocv / (2 * R_eq)\n        \n        # Clamp the peak-power current to the admissible interval\n        I_opt = max(I_min_adm, min(I_peak, I_max_adm))\n        \n        # Step 6: Calculate maximum admissible power\n        P_max = I_opt * U_ocv - I_opt**2 * R_eq\n        # An equivalent calculation: V_pack_at_opt = U_ocv - I_opt * R_eq; P_max = V_pack_at_opt * I_opt\n\n        # Step 7: Calculate total pack mass and volume\n        m_pack = Ns * Np * m_cell + m_bus\n        V_pack_geom = Ns * Np * V_cell + V_bus\n        \n        # Step 8: Calculate specific power and volumetric power density\n        # Handle division by zero for mass/volume if they were zero, though not expected here.\n        specific_power = P_max / m_pack if m_pack > 0 else 0.0\n        volumetric_power_density = P_max / V_pack_geom if V_pack_geom > 0 else 0.0\n\n        return P_max, specific_power, volumetric_power_density\n\n    # Define the test cases from the problem statement.\n    # Format: (x, Ns, Np, R_bus, V_min, V_max, m_cell, m_bus, V_cell, V_bus)\n    test_cases = [\n        # Case 1\n        (0.50, 96, 4, 0.010, 300.0, 400.0, 0.045, 3.0, 2.4e-5, 0.0030),\n        # Case 2\n        (1.00, 96, 4, 0.000, 403.2, 410.0, 0.045, 2.0, 2.4e-5, 0.0025),\n        # Case 3\n        (0.80, 96, 3, 0.050, 280.0, 360.0, 0.050, 4.0, 2.5e-5, 0.0040),\n    ]\n\n    results = []\n    for case in test_cases:\n        p_max, p_spec, p_vol = calculate_power_metrics(case)\n        results.append((p_max, p_spec, p_vol))\n\n    # Format the results into the required string \"[[a,b,c],[d,e,f],...]\"\n    formatted_results = []\n    for p_max, p_spec, p_vol in results:\n        formatted_results.append(f\"[{p_max},{p_spec},{p_vol}]\")\n    \n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}