{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，动手实践是深化理解的关键。我们的第一个练习将从一个基本但功能强大的工具——量纲分析——开始。通过将球形颗粒内的扩散问题无量纲化，我们不仅可以简化复杂的偏微分方程，还能揭示控制该过程的两个核心无量纲数：傅里叶数（Fourier number）和毕渥数（Biot number）。这个练习旨在培养您识别和解释控制系统行为的关键参数的能力，这是所有输运现象和工程分析的基石。",
            "id": "3950996",
            "problem": "锂离子电池电极中一个半径为 $R$ 的球形嵌入颗粒，作为锂固态扩散的活性材料区域。固态浓度场为 $c(r,t)$，其中 $r$ 是径向坐标，$t$ 是时间。假设固态扩散系数 $D$ 为常数且扩散是各向同性的。设表面的向外法向摩尔通量由线性界面动力学控制，其传质系数为 $k$，使得表面通量与表面浓度和外部施加的参考浓度 $c_{\\mathrm{e}}$ 之差成正比。其控制物理基于菲克第一定律 $J_{r}=-D\\,\\partial c/\\partial r$ 和球坐标系下的局部质量守恒。颗粒中心的对称性条件要求在 $r=0$ 处 $\\partial c/\\partial r=0$。在表面 $r=R$ 处，动力学边界条件将扩散通量和界面动力学联系起来。初始条件为均匀浓度 $c(r,0)=c_{0}$。\n\n从这些基本定律和条件出发，通过引入一个无量纲径向坐标和一个无量纲时间变量来推导该扩散问题的无量纲形式，其中无量纲时间变量应分离出由颗粒尺寸和扩散系数决定的特征固态扩散时间尺度。使用一种浓度标度，使得界面边界条件在无量纲浓度下是齐次的。在你的推导中，确定控制内部扩散和表面动力学相互作用的两个关键无量纲数：傅里叶数 $\\mathrm{Fo}$ 和毕奥数 $\\mathrm{Bi}$。\n\n使用 LaTeX 的 $\\mathrm{pmatrix}$ 环境，将 $\\mathrm{Fo}$ 和 $\\mathrm{Bi}$ 的最终表达式仅用参数 $D$、$R$、$k$ 和 $t$ 表示，并以单行矩阵的形式报告。最终答案必须是单一的闭式解析表达式。最终答案中不应包含任何单位。",
            "solution": "该问题要求推导球形颗粒内固态扩散问题的无量纲形式，并确定其控制性无量纲数，即傅里叶数 ($\\mathrm{Fo}$) 和毕奥数 ($\\mathrm{Bi}$)。\n\n首先，我们必须以有量纲形式构建完整的数学模型。扩散的控制性偏微分方程 (PDE) 是由菲克第一定律和局部质量守恒原理结合得到的。\n\n浓度为 $c(r, t)$ 的物质的局部质量守恒由下式给出：\n$$\n\\frac{\\partial c}{\\partial t} + \\nabla \\cdot \\mathbf{J} = 0\n$$\n其中 $\\mathbf{J}$ 是摩尔通量矢量。在球坐标系中，对于各向同性扩散，通量的径向分量 $J_r$ 由菲克第一定律给出：\n$$\nJ_r = -D \\frac{\\partial c}{\\partial r}\n$$\n其中 $D$ 是恒定的固态扩散系数。在球坐标系中，假设径向对称，通量矢量的散度为 $\\nabla \\cdot \\mathbf{J} = \\frac{1}{r^2}\\frac{\\partial}{\\partial r}(r^2 J_r)$。将菲克定律代入守恒方程，得到该几何构型的菲克第二定律：\n$$\n\\frac{\\partial c}{\\partial t} = \\frac{D}{r^2}\\frac{\\partial}{\\partial r}\\left(r^2 \\frac{\\partial c}{\\partial r}\\right)\n$$\n该偏微分方程控制着在 $r \\in [0, R]$ 和 $t > 0$ 范围内的浓度场 $c(r,t)$。\n\n接下来，我们根据问题陈述指定初始条件和边界条件。\n初始条件为均匀浓度 $c_0$：\n$$\nc(r, 0) = c_0 \\quad \\text{for } 0 \\le r \\le R\n$$\n第一个边界条件是颗粒中心 ($r=0$) 的对称性条件：\n$$\n\\left. \\frac{\\partial c}{\\partial r} \\right|_{r=0} = 0\n$$\n第二个边界条件位于颗粒表面 ($r=R$)。问题陈述表明，向外法向摩尔通量 $J_r(R,t)$ 由线性界面动力学控制：\n$$\nJ_r(R,t) = k(c(R,t) - c_{\\mathrm{e}})\n$$\n其中 $k$ 是传质系数，$c_{\\mathrm{e}}$ 是外部参考浓度。通过将此通量的动力学表达式与表面的菲克第一定律相等，我们得到罗宾边界条件：\n$$\n-D \\left. \\frac{\\partial c}{\\partial r} \\right|_{r=R} = k(c(R,t) - c_{\\mathrm{e}})\n$$\n\n在建立了完整的初边值问题后，我们对其进行无量纲化。我们引入以下无量纲变量：\n\n1.  无量纲浓度 $\\theta$。问题要求选择一种能使 $r=R$ 处的边界条件齐次化的形式。$c(R,t) - c_{\\mathrm{e}}$ 项提示我们应使用一种平移和缩放的浓度。我们将 $\\theta$ 定义为：\n    $$\n    \\theta = \\frac{c(r,t) - c_{\\mathrm{e}}}{c_0 - c_{\\mathrm{e}}}\n    $$\n    这假设 $c_0 \\neq c_{\\mathrm{e}}$，这对于一个非平凡问题是必要的。\n\n2.  无量纲径向坐标 $\\rho$，通过用颗粒半径 $R$ 进行标度：\n    $$\n    \\rho = \\frac{r}{R}\n    $$\n    空间域变为 $\\rho \\in [0, 1]$。\n\n3.  无量纲时间 $\\tau$。问题要求分离出特征扩散时间尺度，即 $R^2/D$。我们将 $\\tau$ 定义为：\n    $$\n    \\tau = \\frac{Dt}{R^2}\n    $$\n    这个无量纲数组就是傅里叶数 $\\mathrm{Fo}$。\n\n现在我们使用链式法则变换导数：\n$$\n\\frac{\\partial}{\\partial t} = \\frac{\\partial \\tau}{\\partial t} \\frac{\\partial}{\\partial \\tau} = \\frac{D}{R^2} \\frac{\\partial}{\\partial \\tau}\n$$\n$$\n\\frac{\\partial}{\\partial r} = \\frac{\\partial \\rho}{\\partial r} \\frac{\\partial}{\\partial \\rho} = \\frac{1}{R} \\frac{\\partial}{\\partial \\rho}\n$$\n浓度 $c$ 用 $\\theta$ 表示为：\n$$\nc(r,t) = c_{\\mathrm{e}} + (c_0 - c_{\\mathrm{e}})\\theta(\\rho, \\tau)\n$$\n\n我们将这些代入控制性偏微分方程：\n$$\n\\frac{\\partial}{\\partial t} \\left[ c_{\\mathrm{e}} + (c_0 - c_{\\mathrm{e}})\\theta \\right] = \\frac{D}{r^2}\\frac{\\partial}{\\partial r}\\left(r^2 \\frac{\\partial}{\\partial r}\\left[ c_{\\mathrm{e}} + (c_0 - c_{\\mathrm{e}})\\theta \\right]\\right)\n$$\n常数项 $c_{\\mathrm{e}}$ 在求导后消失。\n$$\n(c_0 - c_{\\mathrm{e}}) \\frac{\\partial \\theta}{\\partial t} = \\frac{D(c_0 - c_{\\mathrm{e}})}{r^2}\\frac{\\partial}{\\partial r}\\left(r^2 \\frac{\\partial \\theta}{\\partial r}\\right)\n$$\n现在，对导数和变量应用链式法则变换：\n$$\n(c_0 - c_{\\mathrm{e}}) \\left(\\frac{D}{R^2} \\frac{\\partial \\theta}{\\partial \\tau}\\right) = \\frac{D(c_0 - c_{\\mathrm{e}})}{(R\\rho)^2} \\left(\\frac{1}{R}\\frac{\\partial}{\\partial \\rho}\\right) \\left((R\\rho)^2 \\left(\\frac{1}{R}\\frac{\\partial \\theta}{\\partial \\rho}\\right)\\right)\n$$\n从两侧消去常数因子 $(c_0 - c_{\\mathrm{e}})$：\n$$\n\\frac{D}{R^2} \\frac{\\partial \\theta}{\\partial \\tau} = \\frac{D}{R^2 \\rho^2} \\frac{1}{R}\\frac{\\partial}{\\partial \\rho}\\left(R \\rho^2 \\frac{\\partial \\theta}{\\partial \\rho}\\right)\n$$\n$$\n\\frac{D}{R^2} \\frac{\\partial \\theta}{\\partial \\tau} = \\frac{D}{R^3 \\rho^2} (R) \\frac{\\partial}{\\partial \\rho}\\left(\\rho^2 \\frac{\\partial \\theta}{\\partial \\rho}\\right) = \\frac{D}{R^2 \\rho^2} \\frac{\\partial}{\\partial \\rho}\\left(\\rho^2 \\frac{\\partial \\theta}{\\partial \\rho}\\right)\n$$\n两边同除以 $D/R^2$ 得到无量纲偏微分方程：\n$$\n\\frac{\\partial \\theta}{\\partial \\tau} = \\frac{1}{\\rho^2} \\frac{\\partial}{\\partial \\rho}\\left(\\rho^2 \\frac{\\partial \\theta}{\\partial \\rho}\\right)\n$$\n\n接下来，我们变换初始条件和边界条件。\n初始条件 $c(r,0) = c_0$ 变为：\n$$\n\\theta(\\rho, 0) = \\frac{c(r,0) - c_{\\mathrm{e}}}{c_0 - c_{\\mathrm{e}}} = \\frac{c_0 - c_{\\mathrm{e}}}{c_0 - c_{\\mathrm{e}}} = 1\n$$\n中心的对称性条件 $\\left. \\frac{\\partial c}{\\partial r} \\right|_{r=0} = 0$ 变为：\n$$\n\\left. (c_0 - c_{\\mathrm{e}}) \\frac{1}{R} \\frac{\\partial \\theta}{\\partial \\rho} \\right|_{\\rho=0} = 0 \\implies \\left. \\frac{\\partial \\theta}{\\partial \\rho} \\right|_{\\rho=0} = 0\n$$\n表面的动力学边界条件 $-D \\left. \\frac{\\partial c}{\\partial r} \\right|_{r=R} = k(c(R,t) - c_{\\mathrm{e}})$ 变换如下：\n$$\n-D \\left. (c_0 - c_{\\mathrm{e}}) \\frac{1}{R} \\frac{\\partial \\theta}{\\partial \\rho} \\right|_{\\rho=1} = k \\left[ (c_{\\mathrm{e}} + (c_0 - c_{\\mathrm{e}})\\theta(1, \\tau)) - c_{\\mathrm{e}} \\right]\n$$\n$$\n-\\frac{D(c_0 - c_{\\mathrm{e}})}{R} \\left. \\frac{\\partial \\theta}{\\partial \\rho} \\right|_{\\rho=1} = k (c_0 - c_{\\mathrm{e}})\\theta(1, \\tau)\n$$\n消去 $(c_0 - c_{\\mathrm{e}})$ 并重新整理，得到无量纲边界条件：\n$$\n\\left. \\frac{\\partial \\theta}{\\partial \\rho} \\right|_{\\rho=1} = -\\left(\\frac{kR}{D}\\right) \\theta(1, \\tau)\n$$\n现在，该边界条件在 $\\theta$ 上是齐次的，正如所要求的那样。出现的无量纲数组是 $\\frac{kR}{D}$。该数组代表表面传质速率与颗粒内部扩散速率之比，定义为传质毕奥数 $\\mathrm{Bi}$。\n\n因此，控制该问题的两个关键无量纲数是：\n1.  傅里叶数 $\\mathrm{Fo}$，源于时间的无量纲化：\n    $$\n    \\mathrm{Fo} = \\tau = \\frac{Dt}{R^2}\n    $$\n2.  毕奥数 $\\mathrm{Bi}$，源于表面动力学边界条件的无量纲化：\n    $$\n    \\mathrm{Bi} = \\frac{kR}{D}\n    $$\n\n问题要求仅用给定的参数 $D$、$R$、$k$ 和 $t$ 来表示这些最终表达式。\n傅里叶数的表达式为 $\\mathrm{Fo} = \\frac{Dt}{R^2}$。\n毕奥数的表达式为 $\\mathrm{Bi} = \\frac{kR}{D}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{Dt}{R^2}  \\frac{kR}{D}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在识别出关键参数后，下一步是求解控制方程。虽然解析解形式优美，但许多实际问题，尤其是在电池模拟中，都依赖于数值方法。本练习将引导您使用“线方法”（method of lines）实现一个数值解，并将其与一个常用的半无限近似解析解进行比较。通过这个过程，您将获得偏微分方程数值模拟的实践经验，并学会如何评判简化解析模型在工程应用中的适用范围和有效性。",
            "id": "3950980",
            "problem": "您的任务是量化一种用于活性材料中固态扩散的半无限解析近似在早期时间的准确性，并与有限长度的数值解进行对比，这一任务是在自动化电池设计与仿真的背景下进行的。物理系统是一个厚度为 $L$ 的一维平面板，代表活性材料的深度，其初始浓度均匀为 $c_0$。锂嵌入过程通过在面向电解质的表面（$x=0$ 处）施加一个恒定的摩尔通量 $J$ 来建模，而背面（$x=L$ 处）是不可渗透的。扩散由菲克第二定律控制，扩散系数 $D$ 为常数。\n\n使用的基本定律和定义：\n- 针对具有恒定扩散系数的固体的一维扩散的菲克第二定律：\n$$\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^2 c}{\\partial x^2}.$$\n- 边界条件：\n  - 在面向电解质的表面（$x=0$），一个恒定的摩尔通量 $J$ 进入固体：\n  $$-D \\left.\\frac{\\partial c}{\\partial x}\\right|_{x=0} = J.$$\n  - 在背面（$x=L$），通量为零（不可渗透边界）：\n  $$\\left.\\frac{\\partial c}{\\partial x}\\right|_{x=L} = 0.$$\n- 初始条件：\n$$c(x,0) = c_0.$$\n所有浓度单位必须为 $\\mathrm{mol/m^3}$，通量单位为 $\\mathrm{mol/m^2/s}$，厚度单位为 $\\mathrm{m}$，扩散系数单位为 $\\mathrm{m^2/s}$，时间单位为 $\\mathrm{s}$。\n\n您的程序必须：\n1. 从基本定律出发，推导当扩散长度远小于板厚时，表面浓度在 $x=0$ 处作为时间 $t$ 的函数的半无限近似解。不要依赖任何没有根据的启发式方法；从给定的基本定律开始。\n2. 使用线方法求解偏微分方程（PDE），计算表面浓度 $c(0,t)$ 的有限长度数值解。空间上采用中心有限差分格式，时间上采用常微分方程（ODE）求解器。使用一致的数值边界处理方法施加 $x=0$ 处的通量边界条件和 $x=L$ 处的零通量边界条件。使用至少 $N=61$ 个空间节点来解析板的厚度，并确保数值的稳定性和准确性。\n3. 通过计算表面浓度偏移的相对误差，比较表面浓度的半无限近似解 $c_{\\mathrm{semi}}(0,t)$ 与有限长度数值解 $c_{\\mathrm{num}}(0,t)$：\n$$e(t) = \\frac{\\left| \\left(c_{\\mathrm{num}}(0,t)-c_0\\right) - \\left(c_{\\mathrm{semi}}(0,t)-c_0\\right) \\right|}{\\max\\left(\\left|c_{\\mathrm{semi}}(0,t)-c_0\\right|,\\ \\delta\\right)},$$\n其中 $\\delta$ 是一个小的正常数正则化常数，用于避免在 $J=0$ 时出现除以零的情况。使用 $\\delta = 10^{-12}$ $\\mathrm{mol/m^3}$。\n4. 确定最大的时间 $t_{\\max}$，使得对于所有 $t \\in [0, t_{\\max}]$，都有 $e(t) \\le \\varepsilon$，其中 $\\varepsilon$ 是用户指定的以小数表示的容差（不是百分比）。换句话说，您的 $t_{\\max}$ 必须标志着连续的早期时间窗口的结束，在此窗口内，半无限近似在边界效应显著影响解之前保持在指定的误差容差内是准确的。\n5. 使用一个在 $t_{\\min}$ 和 $t_{\\mathrm{upper}}$ 之间的几何间隔时间网格，其中 $t_{\\min} = 10^{-8}$，$t_{\\mathrm{upper}} = \\alpha L^2 / D$，且 $\\alpha = 0.1$，以捕捉与扩散长度成比例的早期时间动态。使用 $N_t = 60$ 个时间点。所有时间单位均为 $\\mathrm{s}$。\n\n测试套件：\n为以下每组参数计算 $t_{\\max}$（单位为秒）。所有输出必须以 $\\mathrm{s}$ 为单位。\n- 情况 1：$D = 1.0 \\times 10^{-14}\\ \\mathrm{m^2/s}$，$L = 5.0 \\times 10^{-6}\\ \\mathrm{m}$，$J = 1.0 \\times 10^{-4}\\ \\mathrm{mol/m^2/s}$，$c_0 = 2.3 \\times 10^{4}\\ \\mathrm{mol/m^3}$，$\\varepsilon = 0.05$。\n- 情况 2：$D = 1.0 \\times 10^{-14}\\ \\mathrm{m^2/s}$，$L = 5.0 \\times 10^{-6}\\ \\mathrm{m}$，$J = 0.0\\ \\mathrm{mol/m^2/s}$，$c_0 = 2.3 \\times 10^{4}\\ \\mathrm{mol/m^3}$，$\\varepsilon = 0.05$。\n- 情况 3：$D = 1.0 \\times 10^{-14}\\ \\mathrm{m^2/s}$，$L = 1.0 \\times 10^{-6}\\ \\mathrm{m}$，$J = 1.0 \\times 10^{-4}\\ \\mathrm{mol/m^2/s}$，$c_0 = 2.3 \\times 10^{4}\\ \\mathrm{mol/m^3}$，$\\varepsilon = 0.02$。\n- 情况 4：$D = 5.0 \\times 10^{-15}\\ \\mathrm{m^2/s}$，$L = 1.0 \\times 10^{-5}\\ \\mathrm{m}$，$J = 2.0 \\times 10^{-4}\\ \\mathrm{mol/m^2/s}$，$c_0 = 2.3 \\times 10^{4}\\ \\mathrm{mol/m^3}$，$\\varepsilon = 0.05$。\n\n算法要求：\n- 空间离散化：在 $[0,L]$ 上使用 $N=61$ 个等距节点。将空间步长表示为 $dx = L/(N-1)$。\n- 数值边界实现：\n  - 在 $x=0$ 处：通过与导数一致的单侧虚拟节点构造施加通量边界，使用关系式 $c_{-1} = c_1 + 2\\,dx\\,J/D$，这强制满足 $-D(c_1 - c_{-1})/(2\\,dx) = J$。\n  - 在 $x=L$ 处：通过满足 $c_N = c_{N-2}$ 的虚拟节点施加零通量边界，这强制满足 $(c_N - c_{N-2})/(2\\,dx) = 0$。\n- 时间积分：使用适用于扩散动力学的刚性求解器求解得到的常微分方程组。\n- 半无限近似：从基本定律推导出一个显式的表面浓度 $c_{\\mathrm{semi}}(0,t)$，该解在早期时间（当 $\\sqrt{D t} \\ll L$ 时）有效。\n- 误差窗口计算：将 $t_{\\max}$ 确定为所选网格中满足所有先前时间点 $e(t) \\le \\varepsilon$ 的最大时间。如果 $e(t)$ 在网格的第一个时间点就超过 $\\varepsilon$，则返回 $t_{\\max} = 0$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含 4 个测试用例的 $t_{\\max}$ 结果值，格式为一个用方括号括起来的逗号分隔列表，每个值格式化到六位小数，例如 $\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4\\right]$。这些值必须以 $\\mathrm{s}$ 为单位。\n\n不需要用户输入；所有参数均已在上方固定并提供。您必须在整个过程中确保物理真实性和数值一致性。",
            "solution": "该问题被评估为有效。这是一个具有科学依据、适定的化学工程和材料科学问题，专门解决固态扩散问题。控制方程、初始条件和边界条件都陈述清晰且物理上一致。数值和解析任务定义明确，所提供的参数对于电池电极材料是现实的。\n\n### 1. 半无限解析解的推导\n\n该问题要求推导半无限固体的表面浓度，这在早期时间，即当扩散长度 $\\sqrt{Dt}$ 远小于板厚 $L$ 时，是有限板的一个有效近似。\n\n半无限介质（$x \\in [0, \\infty)$）的控制系统为：\n- 偏微分方程（PDE）：$\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^2 c}{\\partial x^2}$\n- 初始条件（IC）：$c(x,0) = c_0$\n- 边界条件1（表面通量）：$-D \\left.\\frac{\\partial c}{\\partial x}\\right|_{x=0} = J$\n- 边界条件2（远离表面的浓度）：$\\lim_{x \\to \\infty} c(x,t) = c_0$\n\n为了简化求解过程，我们定义浓度相对于初始状态的偏移量为 $\\theta(x,t) = c(x,t) - c_0$。系统变换为：\n- PDE：$\\frac{\\partial \\theta}{\\partial t} = D \\frac{\\partial^2 \\theta}{\\partial x^2}$\n- IC：$\\theta(x,0) = 0$\n- BC1：$-D \\left.\\frac{\\partial \\theta}{\\partial x}\\right|_{x=0} = J$\n- BC2：$\\lim_{x \\to \\infty} \\theta(x,t) = 0$\n\n我们使用关于时间的拉普拉斯变换来求解这个线性偏微分方程，其中 $\\bar{\\theta}(x,s) = \\mathcal{L}\\{\\theta(x,t)\\}$。变换偏微分方程并应用初始条件，得到一个关于空间变量 $x$ 的常微分方程（ODE）：\n$$s\\bar{\\theta}(x,s) - \\theta(x,0) = D \\frac{d^2 \\bar{\\theta}}{dx^2} \\implies \\frac{d^2 \\bar{\\theta}}{dx^2} - \\frac{s}{D} \\bar{\\theta} = 0$$\n此ODE的通解为 $\\bar{\\theta}(x,s) = A e^{\\sqrt{s/D}x} + B e^{-\\sqrt{s/D}x}$。\n\n边界条件也被变换：\n- 无穷远处的条件 $\\lim_{x \\to \\infty} \\theta(x,t) = 0$ 意味着 $\\lim_{x \\to \\infty} \\bar{\\theta}(x,s) = 0$。这要求指数增长项的系数 $A$ 为零。因此，解简化为 $\\bar{\\theta}(x,s) = B e^{-\\sqrt{s/D}x}$。\n- 通量边界条件变换为 $-D \\frac{d\\bar{\\theta}}{dx}\\big|_{x=0} = \\mathcal{L}\\{J\\} = \\frac{J}{s}$。\n我们计算 $\\bar{\\theta}(x,s)$ 的导数：$\\frac{d\\bar{\\theta}}{dx} = -B\\sqrt{\\frac{s}{D}}e^{-\\sqrt{s/D}x}$。\n在 $x=0$ 处，这给出 $\\frac{d\\bar{\\theta}}{dx}\\big|_{x=0} = -B\\sqrt{\\frac{s}{D}}$。\n将此代入变换后的通量边界条件：\n$$-D \\left(-B\\sqrt{\\frac{s}{D}}\\right) = \\frac{J}{s} \\implies B\\sqrt{sD} = \\frac{J}{s} \\implies B = \\frac{J}{\\sqrt{D}}s^{-3/2}$$\n所以，拉普拉斯域中的解是 $\\bar{\\theta}(x,s) = \\frac{J}{\\sqrt{D}}s^{-3/2} e^{-\\sqrt{s/D}x}$。\n\n我们感兴趣的是在 $x=0$ 处的表面浓度，即 $\\bar{\\theta}(0,s) = \\frac{J}{\\sqrt{D}}s^{-3/2}$。\n为了找到 $\\theta(0,t)$，我们对 $\\bar{\\theta}(0,s)$ 进行拉普拉斯逆变换。使用已知的变换对 $\\mathcal{L}^{-1}\\{s^{-3/2}\\} = 2\\sqrt{t/\\pi}$，我们得到：\n$$\\theta(0,t) = \\mathcal{L}^{-1}\\left\\{\\frac{J}{\\sqrt{D}}s^{-3/2}\\right\\} = \\frac{J}{\\sqrt{D}} \\left(2\\sqrt{\\frac{t}{\\pi}}\\right) = 2J\\sqrt{\\frac{t}{\\pi D}}$$\n最后，转换回原始浓度变量 $c(x,t)$：\n$$c_{\\mathrm{semi}}(0,t) = c_0 + \\theta(0,t) = c_0 + 2J\\sqrt{\\frac{t}{\\pi D}}$$\n这就是半无限近似中表面浓度的所需解析表达式。\n\n### 2. 通过线方法(MOL)进行数值求解\n\n有限长度的数值解是使用线方法计算的。空间域 $[0, L]$ 被离散化为 $N$ 个等距节点 $x_i = i \\cdot dx$（$i=0, 1, \\dots, N-1$），其中空间步长为 $dx = L/(N-1)$。偏微分方程 $\\frac{\\partial c}{\\partial t} = D \\frac{\\partial^2 c}{\\partial x^2}$ 被转换为一个耦合的常微分方程组。\n\n对于内部节点（$i = 1, \\dots, N-2$），中心有限差分格式近似空间二阶导数：\n$$\\frac{d c_i}{d t} = D \\frac{c_{i+1} - 2c_i + c_{i-1}}{dx^2}$$\n\n边界节点（$i=0$ 和 $i=N-1$）需要基于指定的虚拟节点法进行特殊处理。\n\n**在 $x=0$ 处（节点 $i=0$）：**\n恒定通量边界条件为 $-D \\left.\\frac{\\partial c}{\\partial x}\\right|_{x=0} = J$。这使用围绕 $x=0$ 的中心差分进行离散化，涉及一个在 $x=-dx$ 处的虚拟节点 $c_{-1}$：\n$$-D \\frac{c_1 - c_{-1}}{2dx} = J \\implies c_{-1} = c_1 + \\frac{2Jdx}{D}$$\n然后，节点 $i=0$ 处的PDE可以写成 $\\frac{dc_0}{dt} = D \\frac{c_1 - 2c_0 + c_{-1}}{dx^2}$。代入 $c_{-1}$ 的表达式：\n$$\\frac{d c_0}{d t} = D \\frac{c_1 - 2c_0 + \\left(c_1 + \\frac{2Jdx}{D}\\right)}{dx^2} = D \\frac{2c_1 - 2c_0}{dx^2} + \\frac{2J}{dx} = \\frac{2D}{dx^2}(c_1 - c_0) + \\frac{2J}{dx}$$\n\n**在 $x=L$ 处（节点 $i=N-1$）：**\n不可渗透边界条件为 $\\left.\\frac{\\partial c}{\\partial x}\\right|_{x=L} = 0$。这使用围绕 $x_{N-1}=L$ 的中心差分进行离散化，涉及一个在 $x=L+dx$ 处的虚拟节点 $c_N$：\n$$\\frac{c_N - c_{N-2}}{2dx} = 0 \\implies c_N = c_{N-2}$$\n节点 $i=N-1$ 处的PDE为 $\\frac{dc_{N-1}}{dt} = D \\frac{c_N - 2c_{N-1} + c_{N-2}}{dx^2}$。代入 $c_N$ 的表达式：\n$$\\frac{d c_{N-1}}{d t} = D \\frac{c_{N-2} - 2c_{N-1} + c_{N-2}}{dx^2} = \\frac{2D}{dx^2}(c_{N-2} - c_{N-1})$$\n\n这构成了一个包含 $N$ 个刚性、线性、一阶常微分方程的方程组，可以写成 $\\frac{d\\vec{c}}{dt} = \\mathbf{A}\\vec{c} + \\vec{b}$ 的形式。该系统从初始条件 $c_i(0) = c_0$（对所有 $i$）开始，使用刚性ODE求解器进行数值积分。\n\n### 3. 误差计算与时间窗口确定\n\n半无限模型的准确性通过表面浓度偏移的相对误差来量化：\n$$e(t) = \\frac{\\left| \\left(c_{\\mathrm{num}}(0,t)-c_0\\right) - \\left(c_{\\mathrm{semi}}(0,t)-c_0\\right) \\right|}{\\max\\left(\\left|c_{\\mathrm{semi}}(0,t)-c_0\\right|,\\ \\delta\\right)}$$\n其中 $c_{\\mathrm{num}}(0,t)$ 是表面的数值解，$c_{\\mathrm{semi}}(0,t)$ 是解析近似解，$\\delta = 10^{-12} \\, \\mathrm{mol/m^3}$ 是一个正则化常数。\n\n模拟在一个从 $t_{\\min} = 10^{-8} \\, \\mathrm{s}$ 到 $t_{\\mathrm{upper}} = 0.1 L^2 / D$ 的几何间隔时间网格上进行，共 $N_t=60$ 个点。然后我们从这个网格中找到最大的时间 $t_{\\max}$，使得误差 $e(t)$ 在任何之前的时间点都没有超过容差 $\\varepsilon$。如果 $e(t)$ 在第一个时间点就超过了 $\\varepsilon$，$t_{\\max}$ 设置为 $0$。\n\n### 4. 特殊情况：$J=0$\n\n当施加的通量 $J=0$ 时，解析解变为 $c_{\\mathrm{semi}}(0,t) = c_0$。对于数值解，表面的ODE变为 $\\frac{dc_0}{dt} = \\frac{2D}{dx^2}(c_1 - c_0)$。在所有 $i$ 的初始条件都为均匀的 $c_i(0)=c_0$ 且没有外部强迫项的情况下，浓度梯度在任何地方都始终为零。因此，$\\frac{d\\vec{c}}{dt} = \\vec{0}$，数值解保持为 $c_{\\mathrm{num}}(x,t)=c_0$。因此，误差 $e(t)$ 对所有 $t$ 恒为零。在这种情况下，误差永远不会超过任何正容差 $\\varepsilon$，所以 $t_{\\max}$ 是评估网格中的最大时间，$t_{\\mathrm{upper}}$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the maximum time t_max for which a semi-infinite diffusion model\n    is accurate within a given tolerance, compared to a finite-length numerical model.\n    \"\"\"\n    \n    test_cases = [\n        # D (m^2/s), L (m), J (mol/m^2/s), c0 (mol/m^3), epsilon\n        (1.0e-14, 5.0e-6, 1.0e-4, 2.3e4, 0.05),\n        (1.0e-14, 5.0e-6, 0.0, 2.3e4, 0.05),\n        (1.0e-14, 1.0e-6, 1.0e-4, 2.3e4, 0.02),\n        (5.0e-15, 1.0e-5, 2.0e-4, 2.3e4, 0.05),\n    ]\n\n    results = []\n\n    # Shared parameters\n    N = 61  # Number of spatial nodes\n    N_t = 60 # Number of time points\n    t_min = 1.0e-8 # s\n    delta = 1.0e-12 # mol/m^3\n\n    for D, L, J, c0, epsilon in test_cases:\n        \n        t_upper = 0.1 * L**2 / D\n        \n        # Special case for zero flux\n        if J == 0.0:\n            results.append(t_upper)\n            continue\n            \n        t_eval = np.geomspace(t_min, t_upper, N_t)\n        dx = L / (N - 1)\n\n        def dcdt(t, c):\n            \"\"\"\n            RHS of the ODE system for the method of lines.\n            c is the concentration vector [c_0, c_1, ..., c_{N-1}].\n            \"\"\"\n            dcdt_arr = np.zeros(N)\n            \n            # Interior nodes (i=1 to N-2)\n            dcdt_arr[1:-1] = (D / dx**2) * (c[2:] - 2 * c[1:-1] + c[:-2])\n            \n            # Boundary at x=0 (i=0)\n            # dc0/dt = 2D/dx^2 * (c1 - c0) + 2J/dx\n            dcdt_arr[0] = (2 * D / dx**2) * (c[1] - c[0]) + (2 * J / dx)\n            \n            # Boundary at x=L (i=N-1)\n            # d(c_{N-1})/dt = 2D/dx^2 * (c_{N-2} - c_{N-1})\n            dcdt_arr[-1] = (2 * D / dx**2) * (c[-2] - c[-1])\n            \n            return dcdt_arr\n\n        # Initial condition: uniform concentration\n        c_initial = np.full(N, c0)\n\n        # Solve the system of ODEs\n        sol = solve_ivp(\n            fun=dcdt,\n            t_span=(t_eval[0], t_eval[-1]),\n            y0=c_initial,\n            t_eval=t_eval,\n            method='BDF', # Stiff solver\n        )\n        \n        # Extract numerical solution for surface concentration\n        c_num_surface = sol.y[0, :]\n\n        # Calculate semi-infinite analytical solution for surface concentration\n        c_semi_surface = c0 + 2 * J * np.sqrt(t_eval / (np.pi * D))\n        \n        # Calculate concentration excursions\n        excursion_num = c_num_surface - c0\n        excursion_semi = c_semi_surface - c0\n\n        # Calculate relative error\n        numerator = np.abs(excursion_num - excursion_semi)\n        denominator = np.maximum(np.abs(excursion_semi), delta)\n        error = numerator / denominator\n        \n        # Find t_max\n        # Find the first index where the error exceeds the tolerance\n        invalid_indices = np.where(error > epsilon)[0]\n        \n        t_max = 0.0 # Default value\n        if len(invalid_indices) == 0:\n            # If error never exceeds tolerance, t_max is the last time point\n            t_max = t_eval[-1]\n        else:\n            first_invalid_idx = invalid_indices[0]\n            if first_invalid_idx > 0:\n                # t_max is the time point just before the first failure\n                t_max = t_eval[first_invalid_idx - 1]\n            # else, if first_invalid_idx is 0, t_max remains 0\n\n        results.append(t_max)\n        \n    # Format and print the final results\n    print(f\"[{','.join(f'{val:.6f}' for val in results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "我们建立的扩散模型依赖于像扩散系数 $D$ 这样的材料属性，这些属性必须通过实验来确定。最后一个练习旨在连接理论模型与物理现实，展示如何从实验数据中提取这些关键参数。您将使用阿伦尼乌斯（Arrhenius）关系对不同温度下的扩散系数测量数据进行线性回归，以确定活化能 $E_a$ 和指前因子 $D_0$。这项实践不仅展示了从原始数据到物理上有意义的模型参数的完整工作流程，还引入了模型选择的概念，这对于严谨的科学研究至关重要。",
            "id": "3950999",
            "problem": "提供了锂离子正极活性材料的扩散系数 $D$ 作为绝对温度 $T$ 的函数的几组实验测量数据。在由菲克定律和晶格中的热激活跳跃控制的固态扩散中，越过单一主导能垒的热激活输运产生的温度依赖性，与扩散系数的对数和绝对温度的倒数之间的线性关系相符。您的任务是：\n\n- 基于菲克扩散和热激活跳跃的第一性原理推导，证明当单一活化能垒控制质量输运时，使用 $\\ln D$ 对 $1/T$ 的线性回归模型的合理性。\n- 对 $\\ln D$ 与 $1/T$ 的关系实施普通最小二乘回归，以获得线性拟合参数，并从中提取活化能 $E_a$ 和指前因子 $D_0$。\n- 通过信息论准则，比较线性模型与 $1/T$ 的二次模型的拟合优度，以评估与单能垒阿伦尼乌斯行为的偏差。具体来说，计算两个模型之间的信息准则差异，并判断数据是否足够符合阿伦尼乌斯行为。\n\n科学假设和要求：\n- 绝对温度 $T$ 以开尔文为单位，扩散系数 $D$ 以平方米/秒为单位。您必须返回以焦耳/摩尔为单位的活化能 $E_a$ 和以平方米/秒为单位的指前因子 $D_0$。\n- 对非阿伦尼乌斯行为的评估必须基于比较 $\\ln D$ 对 $1/T$ 的线性模型与二次模型的拟合情况，并使用一个对模型复杂性进行惩罚的标准信息准则。报告线性模型准则与二次模型准则之间的差异。定义一个布尔分类，如果数据足够符合阿伦尼乌斯行为，则返回 $\\text{True}$，否则返回 $\\text{False}$。使用准则差异的固定阈值 $2$ 来做出此分类决策。\n- 除所述基本原理外，不要假设任何快捷公式。您的回归和模型比较必须从第一性原理出发实现。\n\n数值细节：\n- 使用摩尔气体常数 $R$ 将 $\\ln D$ 对 $1/T$ 关系的斜率与 $E_a$ 联系起来。\n- 以焦耳/摩尔为单位报告 $E_a$，以平方米/秒为单位报告 $D_0$。\n- 所有对数均为自然对数。\n\n测试套件：\n对于下面的每个测试用例，温度数组 $T$ 以开尔文为单位，扩散系数数组 $D$ 以平方米/秒为单位。您的程序必须独立处理每个用例，并为每个用例返回一个列表，其中包含 $[E_a,\\ D_0,\\ \\Delta,\\ \\text{is\\_Arrhenius}]$，$E_a$ 是一个以焦耳/摩尔为单位的浮点数，$D_0$ 是一个以平方米/秒为单位的浮点数，$\\Delta$ 是一个代表线性和二次模型之间信息准真差异的浮点数，$\\text{is\\_Arrhenius}$ 是一个使用阈值 $2$ 的布尔分类。\n\n- 案例1（标称类阿伦尼乌斯行为）：\n  - $T = [280.0,\\ 300.0,\\ 320.0,\\ 340.0,\\ 360.0]$ (开尔文)\n  - $D = [1.5\\times 10^{-14},\\ 4.9\\times 10^{-14},\\ 1.4\\times 10^{-13},\\ 4.0\\times 10^{-13},\\ 8.0\\times 10^{-13}]$ (平方米/秒)\n- 案例2（类阿伦尼乌斯行为，伴有明显实验噪声）：\n  - $T = [280.0,\\ 300.0,\\ 320.0,\\ 340.0,\\ 360.0]$ (开尔文)\n  - $D = [2.1\\times 10^{-13},\\ 2.7\\times 10^{-13},\\ 2.5\\times 10^{-13},\\ 2.9\\times 10^{-13},\\ 3.8\\times 10^{-13}]$ (平方米/秒)\n- 案例3（非阿伦尼乌斯，双区域行为）：\n  - $T = [260.0,\\ 280.0,\\ 300.0,\\ 320.0,\\ 340.0]$ (开尔文)\n  - $D = [1.0\\times 10^{-14},\\ 1.6\\times 10^{-14},\\ 2.5\\times 10^{-14},\\ 8.5\\times 10^{-13},\\ 2.4\\times 10^{-12}]$ (平方米/秒)\n- 案例4（在整个温度范围内扩散系数接近恒定；边缘案例）：\n  - $T = [280.0,\\ 300.0,\\ 320.0,\\ 340.0,\\ 360.0]$ (开尔文)\n  - $D = [1.00\\times 10^{-11},\\ 1.05\\times 10^{-11},\\ 1.02\\times 10^{-11},\\ 1.06\\times 10^{-11},\\ 1.01\\times 10^{-11}]$ (平方米/秒)\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试用例的结果，形式为方括号内以逗号分隔的列表。每个用例的结果本身必须是一个列表，顺序为 $[E_a,\\ D_0,\\ \\Delta,\\ \\text{is\\_Arrhenius}]$。\n- 例如：$[[E_{a,1},D_{0,1},\\Delta_1,\\text{is\\_Arrhenius}_1],[E_{a,2},D_{0,2},\\Delta_2,\\text{is\\_Arrhenius}_2],[E_{a,3},D_{0,3},\\Delta_3,\\text{is\\_Arrhenius}_3],[E_{a,4},D_{0,4},\\Delta_4,\\text{is\\_Arrhenius}_4]]$。",
            "solution": "从与温度相关的数据中确定扩散的活化能和指前因子是材料科学和物理化学中的一项标准任务。首先评估问题陈述的有效性。\n\n### 步骤1：提取给定信息\n- **任务**：分析扩散系数 $D$ 与绝对温度 $T$ 的实验数据。\n- **理论框架**：固态扩散由菲克定律和晶格中具有单一主导能垒的热激活跳跃所控制。这导致 $\\ln D$ 和 $1/T$ 之间存在线性关系。\n- **方法论**：\n    1. 从第一性原理出发，证明 $\\ln D$ 对 $1/T$ 的线性回归模型的合理性。\n    2. 实施普通最小二乘 (OLS) 回归以找到线性拟合参数。\n    3. 从这些参数中提取活化能 $E_a$ 和指前因子 $D_0$。\n    4. 使用信息准则，通过比较线性模型和 $1/T$ 的二次模型来评估非阿伦尼乌斯行为。\n- **科学假设与要求**：\n    - $T$ 的单位是开尔文 (K)，$D$ 的单位是平方米/秒 (m²/s)。\n    - $E_a$ 必须以焦耳/摩尔 (J/mol) 为单位返回，$D_0$ 以 m²/s 为单位返回。\n    - 模型比较必须使用惩罚复杂性的标准信息准则。\n    - 模型比较的输出为 $\\Delta = \\text{IC}_{\\text{linear}} - \\text{IC}_{\\text{quadratic}}$。\n    - 一个布尔分类 `is_Arrhenius`，如果数据足够符合阿伦尼乌斯行为（定义为 $\\Delta  2$），则为 `True`，否则为 `False`。\n    - 所有对数均为自然对数 ($\\ln$)。\n    - 将使用摩尔气体常数 $R$。\n- **测试数据**：\n    - **案例1**：$T = [280.0, 300.0, 320.0, 340.0, 360.0]$；$D = [1.5\\times 10^{-14}, 4.9\\times 10^{-14}, 1.4\\times 10^{-13}, 4.0\\times 10^{-13}, 8.0\\times 10^{-13}]$。\n    - **案例2**：$T = [280.0, 300.0, 320.0, 340.0, 360.0]$；$D = [2.1\\times 10^{-13}, 2.7\\times 10^{-13}, 2.5\\times 10^{-13}, 2.9\\times 10^{-13}, 3.8\\times 10^{-13}]$。\n    - **案例3**：$T = [260.0, 280.0, 300.0, 320.0, 340.0]$；$D = [1.0\\times 10^{-14}, 1.6\\times 10^{-14}, 2.5\\times 10^{-14}, 8.5\\times 10^{-13}, 2.4\\times 10^{-12}]$。\n    - **案例4**：$T = [280.0, 300.0, 320.0, 340.0, 360.0]$；$D = [1.00\\times 10^{-11}, 1.05\\times 10^{-11}, 1.02\\times 10^{-11}, 1.06\\times 10^{-11}, 1.01\\times 10^{-11}]$。\n\n### 步骤2：使用提取的给定信息进行验证\n- **科学依据**：该问题基于阿伦尼乌斯方程，这是一个用于描述包括固态扩散在内的速率过程的温度依赖性的基础且经过经验验证的模型。使用普通最小二乘法进行参数估计和使用信息准则（如AIC）进行模型选择是标准的、严谨的统计方法。该问题在科学上是合理的。\n- **适定性**：该问题提供了具体的输入数据（$T$、$D$），并要求具体的、明确定义的输出（$E_a$、$D_0$、$\\Delta$、`is_Arrhenius`）。过程被明确概述，为每个测试用例导出一个唯一且有意义的解。\n- **客观性**：该问题以精确的、定量的术语陈述，没有任何主观或有偏见的语言。\n- **不完整或矛盾的设置**：该问题是自洽的。虽然它提到了“一个标准信息准则”，但这是可以接受的，因为它允许实施任何适当的选择，例如符合描述的赤池信息准则 (AIC)。分类的阈值已明确给出 ($\\Delta  2$)。\n- **不切实际或不可行**：对于锂离子在正极材料中的扩散，温度范围和扩散系数量级在物理上是现实的。\n- **其他缺陷**：该问题没有其他已识别的缺陷，如不适定、同义反复或无法验证。\n\n### 步骤3：结论与行动\n问题是有效的。将提供一个完整的解决方案。\n\n### 基于原理的解决方案设计\n\n#### 1. 阿伦尼乌斯关系的理论证明\n通过跳跃机制的固态扩散涉及离子或原子从一个晶格位置移动到相邻的空位。这个过程要求扩散物种克服一个势能垒。这个能垒的高度就是活化能 $E_a$。\n\n根据统计力学，一个粒子拥有足够热能以越过此能垒的概率与玻尔兹曼因子 $\\exp\\left(-\\frac{E_a}{k_B T}\\right)$ 成正比，其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。与跳跃速率成正比的扩散系数 $D$ 因此会表现出类似的温度依赖性。这种关系由阿伦尼乌斯方程形式化：\n$$D(T) = D_0 \\exp\\left(-\\frac{E_a}{RT}\\right)$$\n在此形式中，$E_a$ 代表摩尔活化能（单位 J/mol），$R$ 是摩尔气体常数。$D_0$ 项是指前因子，它综合了跳跃距离、尝试频率和晶格的几何因子等因素。\n\n为了建立一个适用于回归分析的线性模型，我们对阿伦尼乌斯方程两边取自然对数：\n$$\\ln(D) = \\ln\\left(D_0 \\exp\\left(-\\frac{E_a}{RT}\\right)\\right)$$\n利用对数的性质，上式简化为：\n$$\\ln(D) = \\ln(D_0) - \\frac{E_a}{R} \\left(\\frac{1}{T}\\right)$$\n该方程是直线方程 $y = c + mx$ 的形式，其中：\n- 因变量是 $y = \\ln(D)$。\n- 自变量是 $x = 1/T$。\n- y轴截距是 $c = \\ln(D_0)$。\n- 斜率是 $m = -E_a/R$。\n\n这种直接的理论联系证明了在 $\\ln(D)$ 对 $1/T$ 的图上使用线性回归来确定参数 $m$ 和 $c$ 的合理性，并由此可以提取出 $E_a$ 和 $D_0$。\n\n#### 2. 普通最小二乘 (OLS) 回归\n给定 $n$ 个数据点 $(T_i, D_i)$。我们将其转换为 $(x_i, y_i)$，其中 $x_i = 1/T_i$ 且 $y_i = \\ln(D_i)$。我们希望找到一个能最好地拟合数据的模型的参数 $\\boldsymbol{\\beta}$。对于一个次数为 $p-1$ 的通用多项式模型 $y = \\beta_0 + \\beta_1 x + \\dots + \\beta_{p-1} x^{p-1}$，我们可以使用矩阵代数。\n\n令 $\\mathbf{y}$ 为观测值 $y_i$ 的向量。模型可以写成 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}$，其中 $\\mathbf{X}$ 是设计矩阵，$\\boldsymbol{\\beta}$ 是系数向量，$\\boldsymbol{\\epsilon}$ 是误差向量。使残差平方和 ($\\text{RSS} = \\boldsymbol{\\epsilon}^T \\boldsymbol{\\epsilon}$) 最小化的 $\\boldsymbol{\\beta}$ 的OLS估计由以下正规方程给出：\n$$\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}$$\n\n对于**线性模型** ($M_1: y = \\beta_0 + \\beta_1 x$)：\n设计矩阵 $\\mathbf{X}_1$ 是一个 $n \\times 2$ 的矩阵：\n$$\\mathbf{X}_1 = \\begin{pmatrix} 1  x_1 \\\\ 1  x_2 \\\\ \\vdots  \\vdots \\\\ 1  x_n \\end{pmatrix}, \\quad \\boldsymbol{\\beta} = \\begin{pmatrix} \\beta_0 \\\\ \\beta_1 \\end{pmatrix}$$\n估计系数为 $\\hat{\\beta}_0 = c$ 和 $\\hat{\\beta}_1 = m$。由此，我们计算：\n$$E_a = -\\hat{\\beta}_1 R$$\n$$D_0 = \\exp(\\hat{\\beta}_0)$$\n\n对于**二次模型** ($M_2: y = \\gamma_0 + \\gamma_1 x + \\gamma_2 x^2$)：\n设计矩阵 $\\mathbf{X}_2$ 是一个 $n \\times 3$ 的矩阵：\n$$\\mathbf{X}_2 = \\begin{pmatrix} 1  x_1  x_1^2 \\\\ 1  x_2  x_2^2 \\\\ \\vdots  \\vdots  \\vdots \\\\ 1  x_n  x_n^2 \\end{pmatrix}, \\quad \\boldsymbol{\\gamma} = \\begin{pmatrix} \\gamma_0 \\\\ \\gamma_1 \\\\ \\gamma_2 \\end{pmatrix}$$\nOLS过程相同，得出估计值 $\\hat{\\boldsymbol{\\gamma}}$。\n\n#### 3. 使用赤池信息准则 (AIC) 进行模型比较\n简单的阿伦尼乌斯模型并不总是足够的。多种扩散机制或相变可能导致阿伦尼우스图弯曲。二次模型 $M_2$ 提供了一种捕捉这种曲率的方法。为了判断 $M_2$ 的额外复杂性是否被数据所支持，我们使用信息准则。\n\n赤池信息准则 (AIC) 是一个合适的选择。对于具有正态分布误差的最小二乘模型，AIC可以计算为：\n$$\\text{AIC} = n \\ln\\left(\\frac{\\text{RSS}}{n}\\right) + 2k$$\n其中 $n$ 是数据点的数量，$\\text{RSS}$ 是模型的残差平方和，$k$ 是估计参数的数量。对于回归模型，$k$ 包括回归系数的数量，再加上残差方差 ($\\sigma^2$) 的一个参数。\n\n- 对于线性模型 ($M_1$)：$k_1 = 2 \\text{ (对应 } \\beta_0, \\beta_1) + 1 \\text{ (对应 } \\sigma^2) = 3$。\n- 对于二次模型 ($M_2$)：$k_2 = 3 \\text{ (对应 } \\gamma_0, \\gamma_1, \\gamma_2) + 1 \\text{ (对应 } \\sigma^2) = 4$。\n\n每个模型的 RSS 是根据预测值 $\\hat{\\mathbf{y}} = \\mathbf{X}\\hat{\\boldsymbol{\\beta}}$ 计算的：\n$$\\text{RSS} = \\sum_{i=1}^n (y_i - \\hat{y}_i)^2$$\n\n问题要求计算差值 $\\Delta = \\text{AIC}_1 - \\text{AIC}_2$。\n$$\\Delta = \\left[n \\ln\\left(\\frac{\\text{RSS}_1}{n}\\right) + 2k_1\\right] - \\left[n \\ln\\left(\\frac{\\text{RSS}_2}{n}\\right) + 2k_2\\right]$$\n$$\\Delta = n \\ln\\left(\\frac{\\text{RSS}_1}{\\text{RSS}_2}\\right) + 2(k_1 - k_2) = n \\ln\\left(\\frac{\\text{RSS}_1}{\\text{RSS}_2}\\right) - 2$$\n\n分类规则是：如果 $\\Delta  2$，则 `is_Arrhenius` 为 `True`。这个阈值意味着，如果支持更复杂的二次模型的证据不充分（即 AIC 的减少量小于 $2$），则认为更简单的线性（阿伦尼乌斯）模型足以描述数据。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of analyzing temperature-dependent diffusion data.\n    For each test case, it performs linear and quadratic regression on ln(D) vs 1/T,\n    extracts Arrhenius parameters, and compares the models using AIC.\n    \"\"\"\n\n    # Molar gas constant in J/(mol·K)\n    R = 8.314462618\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (nominal Arrhenius-like behavior)\n        (\n            np.array([280.0, 300.0, 320.0, 340.0, 360.0]),\n            np.array([1.5e-14, 4.9e-14, 1.4e-13, 4.0e-13, 8.0e-13])\n        ),\n        # Case 2 (Arrhenius-like with noticeable experimental noise)\n        (\n            np.array([280.0, 300.0, 320.0, 340.0, 360.0]),\n            np.array([2.1e-13, 2.7e-13, 2.5e-13, 2.9e-13, 3.8e-13])\n        ),\n        # Case 3 (non-Arrhenius, two-regime behavior)\n        (\n            np.array([260.0, 280.0, 300.0, 320.0, 340.0]),\n            np.array([1.0e-14, 1.6e-14, 2.5e-14, 8.5e-13, 2.4e-12])\n        ),\n        # Case 4 (near-constant diffusivity across temperature; edge case)\n        (\n            np.array([280.0, 300.0, 320.0, 340.0, 360.0]),\n            np.array([1.00e-11, 1.05e-11, 1.02e-11, 1.06e-11, 1.01e-11])\n        ),\n    ]\n\n    results = []\n    \n    for T_data, D_data in test_cases:\n        # Transform variables for regression\n        n = len(T_data)\n        x_var = 1.0 / T_data\n        y_var = np.log(D_data)\n\n        # ---- Linear Model (M1: y = b0 + b1*x) ----\n        # Construct the design matrix X1\n        X1 = np.vstack([np.ones(n), x_var]).T\n        \n        # Calculate coefficients using OLS normal equation: beta = (X'X)^-1 * X'y\n        try:\n            beta1 = np.linalg.inv(X1.T @ X1) @ X1.T @ y_var\n        except np.linalg.LinAlgError:\n            # Handle potential singularity for edge cases, though unlikely here\n            results.append([float('nan'), float('nan'), float('nan'), False])\n            continue\n            \n        # Extract physical parameters from linear fit\n        # c = beta1[0] = ln(D0) -> D0 = exp(beta1[0])\n        # m = beta1[1] = -Ea/R -> Ea = -beta1[1] * R\n        D0 = np.exp(beta1[0])\n        Ea = -beta1[1] * R\n\n        # Calculate Residual Sum of Squares (RSS) for the linear model\n        y_pred1 = X1 @ beta1\n        RSS1 = np.sum((y_var - y_pred1)**2)\n\n        # Calculate AIC for the linear model\n        # k1 = number of parameters (beta0, beta1) + variance = 3\n        k1 = 3\n        if RSS1 > 0:\n            AIC1 = n * np.log(RSS1 / n) + 2 * k1\n        else:\n            # Perfect fit, log(0) is -inf. In practice use a very small number or handle as a special case.\n            # AIC would be -inf, model is perfectly predictive.\n            AIC1 = -np.inf\n\n        # ---- Quadratic Model (M2: y = g0 + g1*x + g2*x^2) ----\n        # Construct the design matrix X2\n        X2 = np.vstack([np.ones(n), x_var, x_var**2]).T\n\n        # Calculate coefficients using OLS\n        try:\n            beta2 = np.linalg.inv(X2.T @ X2) @ X2.T @ y_var\n        except np.linalg.LinAlgError:\n            # Handle potential singularity\n            results.append([float('nan'), float('nan'), float('nan'), False])\n            continue\n\n        # Calculate RSS for the quadratic model\n        y_pred2 = X2 @ beta2\n        RSS2 = np.sum((y_var - y_pred2)**2)\n\n        # Calculate AIC for the quadratic model\n        # k2 = number of parameters (gamma0, gamma1, gamma2) + variance = 4\n        k2 = 4\n        if RSS2 > 0:\n            AIC2 = n * np.log(RSS2 / n) + 2 * k2\n        else:\n            AIC2 = -np.inf\n\n        # ---- Model Comparison ----\n        # Calculate the AIC difference\n        if np.isinf(AIC1) or np.isinf(AIC2):\n            # If one model is a perfect fit and the other isn't, the difference is infinite.\n            # A perfect quadratic fit to imperfect linear data implies strong non-Arrhenius behavior.\n            Delta = AIC1 - AIC2\n        else:\n            Delta = AIC1 - AIC2\n            # Alternative calculation: delta = n * np.log(RSS1/RSS2) - 2\n            # which is equivalent, but avoids intermediate AIC values\n        \n        # Classify based on the threshold\n        is_Arrhenius = Delta  2.0\n\n        # Append results for the current case\n        results.append([Ea, D0, Delta, is_Arrhenius])\n\n    # Format the final output string\n    # Using a nested list comprehension with f-strings for precise formatting\n    output_str = \"[\" + \",\".join([\n        f\"[{res[0]:.6f},{res[1]:.6e},{res[2]:.6f},{str(res[3]).lower()}]\" \n        for res in results\n    ]) + \"]\"\n    \n    print(output_str)\n\nsolve()\n```"
        }
    ]
}