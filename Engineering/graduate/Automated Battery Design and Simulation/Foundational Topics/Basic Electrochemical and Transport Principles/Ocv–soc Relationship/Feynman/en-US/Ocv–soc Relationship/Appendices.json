{
    "hands_on_practices": [
        {
            "introduction": "The Open-Circuit Voltage (OCV) curve is not always a single, well-defined line; many high-energy electrode materials exhibit hysteresis, where the voltage upon charging differs from the voltage upon discharging. This first practice explores the fundamental thermodynamic origins of this phenomenon in phase-transforming electrodes. By deriving the voltage plateau shifts from principles of chemo-mechanical coupling, you will connect microscopic material properties like coherency stress and interfacial energy to the macroscopic hysteresis loop and quantify the associated energy loss per cycle .",
            "id": "3934022",
            "problem": "A two-phase intercalation electrode operating near a plateau exhibits open-circuit voltage (OCV) hysteresis between lithiation and delithiation due to elastic coherency stresses and phase-boundary curvature. Consider an ensemble of identical spherical active particles of radius $R$ undergoing a coherent $\\alpha \\leftrightarrow \\beta$ transformation over a plateau. Let the stress-free, curvature-free plateau be characterized by a baseline open-circuit voltage $U_0$ with respect to the reference electrode. Assume isothermal conditions and negligible electronic and ionic transport overpotentials so that the measured OCV is governed by equilibrium thermodynamics. The partial molar volume of intercalated lithium in the solid is $\\Omega$, the hydrostatic coherency stress magnitude in the transforming phase during the plateau is $\\sigma$ (compressive during lithiation and tensile during delithiation, with equal magnitude), and the interphase energy per unit area is $\\gamma$. The moving phase boundary is locally spherical with a curvature set by the particle geometry; use the mean curvature of a sphere. The Faraday constant is $F$. The ensemble passes a total plateau charge $Q_{\\mathrm{pl}}$ during both lithiation and delithiation over the same state-of-charge (SOC) interval.\n\nStarting from the definition that the equilibrium cell open-circuit voltage equals the difference in electrochemical potentials per unit charge and from the fundamental thermodynamic coupling of hydrostatic stress and curvature-induced Laplace pressure to chemical potential in solids, perform the following:\n\n1. Derive expressions for the lithiation and delithiation plateau voltages, $U_{\\mathrm{L}}$ and $U_{\\mathrm{D}}$, in terms of $U_0$, $\\Omega$, $\\sigma$, $\\gamma$, $R$, and $F$. Explicitly show how the hydrostatic stress and the curvature of the moving phase boundary enter the voltage and why their signs reverse between lithiation and delithiation. Then simplify the expression for the hysteresis width $\\Delta U \\equiv U_{\\mathrm{D}} - U_{\\mathrm{L}}$.\n\n2. Using the definition of electrical work exchanged between the cell and its environment over a quasistatic charge transfer, compute the energy dissipated per full lithiation–delithiation cycle by evaluating the closed-loop work over the plateau. Assume the plateau voltages are constant over the interval and the same charge interval $Q_{\\mathrm{pl}}$ is traversed on lithiation and delithiation.\n\nUse the following scientifically plausible parameters:\n- Baseline plateau voltage $U_0 = 3.75 \\ \\mathrm{V}$,\n- Partial molar volume $\\Omega = 1.10 \\times 10^{-6} \\ \\mathrm{m}^3/\\mathrm{mol}$,\n- Hydrostatic coherency stress magnitude $\\sigma = 2.50 \\times 10^{8} \\ \\mathrm{Pa}$,\n- Interphase energy $\\gamma = 0.25 \\ \\mathrm{J}/\\mathrm{m}^2$,\n- Particle radius $R = 2.00 \\times 10^{-8} \\ \\mathrm{m}$,\n- Faraday constant $F = 96485 \\ \\mathrm{C}/\\mathrm{mol}$,\n- Plateau charge $Q_{\\mathrm{pl}} = 9.000 \\times 10^{3} \\ \\mathrm{C}$.\n\nExpress the final energy in Joules and round your answer to four significant figures.",
            "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It is grounded in the established thermodynamic principles governing chemo-mechanical coupling in phase-transforming battery electrodes. The provided parameters are physically realistic for such systems. Therefore, the problem is deemed valid and a solution will be furnished.\n\nThe solution is structured in two parts as requested: first, the derivation of the lithiation and delithiation plateau voltages and the resulting hysteresis width, and second, the calculation of the dissipated energy over a full cycle.\n\n### Part 1: Derivation of Plateau Voltages and Hysteresis\n\nThe open-circuit voltage (OCV), $U$, of an electrode is fundamentally related to the chemical potential, $\\mu$, of the intercalating species (in this case, lithium) within the active material. The relationship is given by:\n$$F U = \\mu_{\\mathrm{ref}} - \\mu$$\nwhere $F$ is the Faraday constant and $\\mu_{\\mathrm{ref}}$ is the chemical potential of the reference electrode. Any change in the chemical potential of the electrode material, $d\\mu$, will cause a change in the OCV, $dU$, according to:\n$$F \\, dU = -d\\mu$$\nLet $U_0$ be the baseline plateau voltage corresponding to a stress-free and curvature-free phase transformation, where the chemical potentials of the lithium-poor phase ($\\alpha$) and lithium-rich phase ($\\beta$) are equal, $\\mu_{\\alpha} = \\mu_{\\beta} = \\mu_0$. The deviation of the voltage from this baseline, $\\Delta U = U-U_0$, is caused by a shift in chemical potential, $\\Delta\\mu = \\mu - \\mu_0$, such that $\\Delta U = - \\Delta\\mu / F$.\n\nThis shift in chemical potential, $\\Delta\\mu$, arises from two physical effects described in the problem: hydrostatic coherency stress and phase-boundary curvature. The contribution of a hydrostatic pressure, $P$, to the chemical potential is given by $\\Delta\\mu = \\Omega P$, where $\\Omega$ is the partial molar volume.\n\n1.  **Lithiation Process ($U_{\\mathrm{L}}$)**\n    During lithiation, the $\\beta$ phase grows at the expense of the $\\alpha$ phase. The voltage is determined by the chemical potential of lithium in the newly forming $\\beta$ phase.\n    -   **Stress Effect**: The $\\beta$ phase is under a compressive hydrostatic stress of magnitude $\\sigma$. This corresponds to a positive pressure, $P_{\\mathrm{stress}} = +\\sigma$. The chemical potential is raised by this stress: $\\Delta\\mu_{\\mathrm{stress}} = +\\Omega\\sigma$.\n    -   **Curvature Effect**: The formation of a new phase with a curved interface incurs an energy penalty, described by the Laplace pressure, $P_{\\mathrm{L}}$. For a spherical interface of effective radius $R$, the Laplace pressure is $P_{\\mathrm{L}} = 2\\gamma/R$, where $\\gamma$ is the interfacial energy. This pressure acts on the new phase, raising its chemical potential: $\\Delta\\mu_{\\mathrm{curvature}} = +\\Omega(2\\gamma/R)$.\n    -   **Total Potential Shift**: The total shift in chemical potential during lithiation is the sum of these two effects:\n        $$\\Delta\\mu_{\\mathrm{L}} = \\Delta\\mu_{\\mathrm{stress}} + \\Delta\\mu_{\\mathrm{curvature}} = \\Omega\\sigma + \\frac{2\\Omega\\gamma}{R} = \\Omega\\left(\\sigma + \\frac{2\\gamma}{R}\\right)$$\n    -   **Lithiation Voltage**: A higher chemical potential for lithium in the electrode makes intercalation energetically less favorable, thus lowering the equilibrium voltage.\n        $$U_{\\mathrm{L}} = U_0 + \\Delta U_{\\mathrm{L}} = U_0 - \\frac{\\Delta\\mu_{\\mathrm{L}}}{F} = U_0 - \\frac{\\Omega}{F}\\left(\\sigma + \\frac{2\\gamma}{R}\\right)$$\n\n2.  **Delithiation Process ($U_{\\mathrm{D}}$)**\n    During delithiation, the $\\alpha$ phase grows at the expense of the $\\beta$ phase. The voltage is determined by the chemical potential of lithium being extracted from the $\\beta$ phase.\n    -   **Stress Effect**: The host $\\beta$ phase is now under a tensile stress of magnitude $\\sigma$. This corresponds to a negative pressure, $P_{\\mathrm{stress}} = -\\sigma$. The chemical potential is lowered by this stress: $\\Delta\\mu_{\\mathrm{stress}} = -\\Omega\\sigma$.\n    -   **Curvature Effect**: The interfacial energy resists the shrinking of the $\\beta$ phase (which is equivalent to creating more $\\alpha$-$\\beta$ interface area). This makes it more difficult to extract lithium. The energy barrier to be overcome is the same magnitude as in the lithiation case, but it now acts to increase the delithiation voltage. The required work to extract one mole of Li against this barrier is $\\Omega(2\\gamma/R)$. This corresponds to an effective increase in the Li chemical potential driving the delithiation reaction, or more directly, an increase in the cell voltage.\n    -   **Sign Reversal Logic**: For both stress and curvature, the effect opposes the direction of transformation. Lithiation is opposed by compression and interface creation, lowering the voltage. Delithiation is opposed by tension and interface persistence, raising the voltage. Therefore, the signs of both contributions to the voltage deviation must reverse.\n    -   **Delithiation Voltage**: The voltage is raised relative to the baseline $U_0$.\n        $$U_{\\mathrm{D}} = U_0 + \\frac{\\Omega}{F}\\left(\\sigma + \\frac{2\\gamma}{R}\\right)$$\n\n3.  **Hysteresis Width ($\\Delta U$)**\n    The hysteresis width is defined as the difference between the delithiation and lithiation plateau voltages.\n    $$\\Delta U \\equiv U_{\\mathrm{D}} - U_{\\mathrm{L}}$$\n    $$\\Delta U = \\left(U_0 + \\frac{\\Omega}{F}\\left(\\sigma + \\frac{2\\gamma}{R}\\right)\\right) - \\left(U_0 - \\frac{\\Omega}{F}\\left(\\sigma + \\frac{2\\gamma}{R}\\right)\\right)$$\n    $$\\Delta U = \\frac{2\\Omega}{F}\\left(\\sigma + \\frac{2\\gamma}{R}\\right)$$\n\n### Part 2: Calculation of Dissipated Energy\n\nThe energy dissipated in a thermodynamic cycle is the net work done on the system, which is equivalent to the area enclosed by the cycle on a voltage-charge ($U$-$Q$) diagram.\nThe problem specifies a full lithiation–delithiation cycle over the same plateau charge interval $Q_{\\mathrm{pl}}$. The process is:\n1.  Charging (delithiation): A charge of $Q_{\\mathrm{pl}}$ is passed at a constant voltage $U_{\\mathrm{D}}$. The work done on the cell is $W_{\\mathrm{charge}} = U_{\\mathrm{D}}Q_{\\mathrm{pl}}$.\n2.  Discharging (lithiation): A charge of $Q_{\\mathrm{pl}}$ is extracted at a constant voltage $U_{\\mathrm{L}}$. The work done by the cell is $W_{\\mathrm{discharge}} = U_{\\mathrm{L}}Q_{\\mathrm{pl}}$.\n\nThe net energy dissipated as heat, $E_{\\mathrm{diss}}$, is the difference between the work put in and the work taken out:\n$$E_{\\mathrm{diss}} = W_{\\mathrm{charge}} - W_{\\mathrm{discharge}} = U_{\\mathrm{D}}Q_{\\mathrm{pl}} - U_{\\mathrm{L}}Q_{\\mathrm{pl}} = (U_{\\mathrm{D}} - U_{\\mathrm{L}})Q_{\\mathrm{pl}}$$\nSubstituting the derived expression for the hysteresis width $\\Delta U = U_{\\mathrm{D}} - U_{\\mathrm{L}}$:\n$$E_{\\mathrm{diss}} = \\Delta U \\cdot Q_{\\mathrm{pl}} = \\frac{2\\Omega Q_{\\mathrm{pl}}}{F}\\left(\\sigma + \\frac{2\\gamma}{R}\\right)$$\nNow, we substitute the provided numerical values:\n-   $\\Omega = 1.10 \\times 10^{-6} \\ \\mathrm{m}^3/\\mathrm{mol}$\n-   $Q_{\\mathrm{pl}} = 9.000 \\times 10^{3} \\ \\mathrm{C}$\n-   $F = 96485 \\ \\mathrm{C}/\\mathrm{mol}$\n-   $\\sigma = 2.50 \\times 10^{8} \\ \\mathrm{Pa}$\n-   $\\gamma = 0.25 \\ \\mathrm{J}/\\mathrm{m}^2$\n-   $R = 2.00 \\times 10^{-8} \\ \\mathrm{m}$\n\nFirst, we compute the term inside the parenthesis, which has units of pressure (Pascals):\n$$\\sigma + \\frac{2\\gamma}{R} = (2.50 \\times 10^8 \\ \\mathrm{Pa}) + \\frac{2 \\times (0.25 \\ \\mathrm{J}/\\mathrm{m}^2)}{2.00 \\times 10^{-8} \\ \\mathrm{m}}$$\n$$\\sigma + \\frac{2\\gamma}{R} = (2.50 \\times 10^8 \\ \\mathrm{Pa}) + \\frac{0.50 \\ \\mathrm{N} \\cdot \\mathrm{m}/\\mathrm{m}^2}{2.00 \\times 10^{-8} \\ \\mathrm{m}} = (2.50 \\times 10^8 \\ \\mathrm{Pa}) + (0.25 \\times 10^8 \\ \\mathrm{Pa})$$\n$$\\sigma + \\frac{2\\gamma}{R} = 2.75 \\times 10^8 \\ \\mathrm{Pa}$$\nNow, we substitute this into the expression for dissipated energy:\n$$E_{\\mathrm{diss}} = \\frac{2 \\times (1.10 \\times 10^{-6} \\ \\mathrm{m}^3/\\mathrm{mol}) \\times (9.000 \\times 10^3 \\ \\mathrm{C})}{96485 \\ \\mathrm{C}/\\mathrm{mol}} \\times (2.75 \\times 10^8 \\ \\mathrm{Pa})$$\nThe units combine as $(\\mathrm{m}^3/\\mathrm{mol} \\cdot \\mathrm{C} / (\\mathrm{C}/\\mathrm{mol})) \\cdot \\mathrm{Pa} = \\mathrm{m}^3 \\cdot \\mathrm{Pa} = \\mathrm{m}^3 \\cdot (\\mathrm{N}/\\mathrm{m}^2) = \\mathrm{N} \\cdot \\mathrm{m} = \\mathrm{J}$, as expected.\n$$E_{\\mathrm{diss}} = \\frac{2 \\times 1.10 \\times 10^{-6} \\times 9000}{96485} \\times (2.75 \\times 10^8) \\ \\mathrm{J}$$\n$$E_{\\mathrm{diss}} = \\frac{0.0198}{96485} \\times (2.75 \\times 10^8) \\ \\mathrm{J}$$\n$$E_{\\mathrm{diss}} \\approx (2.05213 \\times 10^{-7}) \\times (2.75 \\times 10^8) \\ \\mathrm{J}$$\n$$E_{\\mathrm{diss}} \\approx 56.4336 \\ \\mathrm{J}$$\nRounding the result to four significant figures, as instructed:\n$$E_{\\mathrm{diss}} = 56.43 \\ \\mathrm{J}$$",
            "answer": "$$\n\\boxed{56.43}\n$$"
        },
        {
            "introduction": "Understanding the physical origin of hysteresis is the first step; the next is to quantify its practical consequences for battery management. Battery Management Systems (BMS) often rely on OCV-based methods for State of Charge (SOC) estimation but may use simplified models that neglect this path-dependent voltage. This exercise demonstrates the tangible error that arises from such an oversight, tasking you with calculating the apparent SOC error when a hysteresis-ignorant BMS interprets a voltage measurement from a cell with significant OCV hysteresis . This highlights the critical trade-off between model complexity and estimation accuracy in real-world systems.",
            "id": "3934033",
            "problem": "A lithium-ion intercalation cell exhibits an Open Circuit Voltage–State of Charge (OCV–SOC) relationship with measurable path dependence (hysteresis) in the mid–State of Charge region. Consider a hypothetical cell whose equilibrium Open Circuit Voltage (OCV) as a function of the lithium fraction in the active material (taken here as State of Charge, so $x \\in (0,1)$) is approximated by a Nernst-like form,\n$$U_{\\mathrm{eq}}(x) = U^{\\circ} + \\frac{RT}{F} \\ln\\!\\left(\\frac{x}{1-x}\\right),$$\nwhere $U^{\\circ}$ is a reference potential, $R$ is the universal gas constant, $T$ is the absolute temperature, and $F$ is the Faraday constant. In the mid–State of Charge region $x \\in [0.4,0.7]$ the cell exhibits hysteresis such that the measured Open Circuit Voltage after approaching the State of Charge by charging (insertion path) is elevated by a constant offset relative to the equilibrium curve, while after approaching by discharging (extraction path) it is lowered by the same offset:\n$$U_{\\mathrm{in}}(x) = U_{\\mathrm{eq}}(x) + H,\\qquad U_{\\mathrm{out}}(x) = U_{\\mathrm{eq}}(x) - H,$$\nfor $x \\in [0.4,0.7]$, with a constant hysteresis magnitude $H$.\n\nA Battery Management System (BMS) that ignores hysteresis uses the single-valued equilibrium function $U_{\\mathrm{eq}}(x)$ to estimate State of Charge from an OCV measurement by inversion of $U_{\\mathrm{eq}}(x)$. Assume a rest measurement is taken after the cell was charged into the mid–State of Charge region, so the measured OCV is $U_{\\mathrm{meas}} = U_{\\mathrm{in}}(x_{\\mathrm{true}})$. Take $x_{\\mathrm{true}} = 0.55$ within the hysteretic region, $H = 0.012\\,\\mathrm{V}$, $U^{\\circ} = 3.600\\,\\mathrm{V}$, $T = 298\\,\\mathrm{K}$, $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, and $F = 96485\\,\\mathrm{C\\,mol^{-1}}$.\n\nUsing only the given definitions and constants, compute the apparent State of Charge estimation error\n$$e \\equiv x_{\\mathrm{hat}} - x_{\\mathrm{true}},$$\nthat the hysteresis-ignorant BMS produces when it inverts $U_{\\mathrm{eq}}(x)$ at $U_{\\mathrm{meas}}$. Express the final error as a decimal fraction with no units. Round your answer to four significant figures.",
            "solution": "The problem requires the calculation of the State of Charge (SOC) estimation error that arises when a Battery Management System (BMS) ignores OCV hysteresis. The validation of the problem statement confirms that it is scientifically grounded, well-posed, and internally consistent. We may therefore proceed with a rigorous solution.\n\nThe core of the problem lies in the discrepancy between the cell's actual voltage and the model used by the BMS. The cell's true SOC is $x_{\\mathrm{true}}$, and it has been brought to this state by charging. Therefore, its measured Open Circuit Voltage (OCV) is on the insertion (charging) branch of the hysteresis loop, given by $U_{\\mathrm{in}}(x)$. According to the problem statement, this voltage is:\n$$U_{\\mathrm{meas}} = U_{\\mathrm{in}}(x_{\\mathrm{true}}) = U_{\\mathrm{eq}}(x_{\\mathrm{true}}) + H$$\nHere, $U_{\\mathrm{eq}}(x)$ is the equilibrium OCV, and $H$ is the constant hysteresis offset.\n\nThe BMS, however, is unaware of hysteresis and operates under the assumption that the measured voltage corresponds to the equilibrium curve. It estimates the SOC, denoted as $x_{\\mathrm{hat}}$, by inverting the equilibrium function $U_{\\mathrm{eq}}(x)$. Thus, the BMS solves the following equation for $x_{\\mathrm{hat}}$:\n$$U_{\\mathrm{meas}} = U_{\\mathrm{eq}}(x_{\\mathrm{hat}})$$\n\nBy equating the two expressions for $U_{\\mathrm{meas}}$, we establish the central relationship between the true SOC $x_{\\mathrm{true}}$ and the estimated SOC $x_{\\mathrm{hat}}$:\n$$U_{\\mathrm{eq}}(x_{\\mathrm{hat}}) = U_{\\mathrm{eq}}(x_{\\mathrm{true}}) + H$$\n\nNow, we substitute the given Nernst-like form for the equilibrium voltage, $U_{\\mathrm{eq}}(x) = U^{\\circ} + \\frac{RT}{F} \\ln\\left(\\frac{x}{1-x}\\right)$:\n$$U^{\\circ} + \\frac{RT}{F} \\ln\\left(\\frac{x_{\\mathrm{hat}}}{1-x_{\\mathrm{hat}}}\\right) = \\left(U^{\\circ} + \\frac{RT}{F} \\ln\\left(\\frac{x_{\\mathrm{true}}}{1-x_{\\mathrm{true}}}\\right)\\right) + H$$\n\nThe reference potential $U^{\\circ}$ cancels from both sides, yielding:\n$$\\frac{RT}{F} \\ln\\left(\\frac{x_{\\mathrm{hat}}}{1-x_{\\mathrm{hat}}}\\right) = \\frac{RT}{F} \\ln\\left(\\frac{x_{\\mathrm{true}}}{1-x_{\\mathrm{true}}}\\right) + H$$\n\nTo solve for $x_{\\mathrm{hat}}$, we first isolate the logarithmic term:\n$$\\ln\\left(\\frac{x_{\\mathrm{hat}}}{1-x_{\\mathrm{hat}}}\\right) = \\ln\\left(\\frac{x_{\\mathrm{true}}}{1-x_{\\mathrm{true}}}\\right) + \\frac{H F}{RT}$$\n\nThis equation shows that the hysteresis voltage $H$ introduces an additive error in the logit-transformed SOC, where the logit function is $\\mathrm{logit}(p) = \\ln(p/(1-p))$. To find $x_{\\mathrm{hat}}$, we exponentiate both sides:\n$$\\frac{x_{\\mathrm{hat}}}{1-x_{\\mathrm{hat}}} = \\exp\\left(\\ln\\left(\\frac{x_{\\mathrm{true}}}{1-x_{\\mathrm{true}}}\\right) + \\frac{H F}{RT}\\right)$$\n$$\\frac{x_{\\mathrm{hat}}}{1-x_{\\mathrm{hat}}} = \\exp\\left(\\ln\\left(\\frac{x_{\\mathrm{true}}}{1-x_{\\mathrm{true}}}\\right)\\right) \\cdot \\exp\\left(\\frac{H F}{RT}\\right)$$\n$$\\frac{x_{\\mathrm{hat}}}{1-x_{\\mathrm{hat}}} = \\left(\\frac{x_{\\mathrm{true}}}{1-x_{\\mathrm{true}}}\\right) \\exp\\left(\\frac{H F}{RT}\\right)$$\n\nLet us define a quantity $A \\equiv \\left(\\frac{x_{\\mathrm{true}}}{1-x_{\\mathrm{true}}}\\right) \\exp\\left(\\frac{H F}{RT}\\right)$. The equation becomes $\\frac{x_{\\mathrm{hat}}}{1-x_{\\mathrm{hat}}} = A$. We can solve for $x_{\\mathrm{hat}}$:\n$$x_{\\mathrm{hat}} = A(1-x_{\\mathrm{hat}}) = A - A x_{\\mathrm{hat}}$$\n$$x_{\\mathrm{hat}}(1+A) = A$$\n$$x_{\\mathrm{hat}} = \\frac{A}{1+A}$$\n\nNow, we substitute the given numerical values:\n$x_{\\mathrm{true}} = 0.55$\n$H = 0.012\\,\\mathrm{V}$\n$T = 298\\,\\mathrm{K}$\n$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n$F = 96485\\,\\mathrm{C\\,mol^{-1}}$\n\nFirst, we compute the thermal voltage term, $\\frac{RT}{F}$:\n$$\\frac{RT}{F} = \\frac{(8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(298\\,\\mathrm{K})}{96485\\,\\mathrm{C\\,mol^{-1}}} \\approx 0.025679\\,\\mathrm{V}$$\n\nNext, we calculate the exponent in the expression for $A$:\n$$\\frac{H F}{RT} = \\frac{H}{RT/F} \\approx \\frac{0.012\\,\\mathrm{V}}{0.025679\\,\\mathrm{V}} \\approx 0.46730$$\n\nNow we can compute A:\n$$A = \\left(\\frac{0.55}{1-0.55}\\right) \\exp(0.46730) = \\left(\\frac{0.55}{0.45}\\right) \\exp(0.46730)$$\n$$A \\approx (1.2222\\ldots) \\cdot (1.59567\\ldots) \\approx 1.95013$$\n\nUsing this value of $A$, we find the estimated SOC, $x_{\\mathrm{hat}}$:\n$$x_{\\mathrm{hat}} = \\frac{A}{1+A} \\approx \\frac{1.95013}{1+1.95013} = \\frac{1.95013}{2.95013} \\approx 0.66103$$\n\nThe SOC estimation error, $e$, is defined as $e \\equiv x_{\\mathrm{hat}} - x_{\\mathrm{true}}$.\n$$e \\approx 0.66103 - 0.55 = 0.11103$$\n\nThe problem requires the answer to be rounded to four significant figures. The fifth significant figure is $3$, so we round down.\n$$e \\approx 0.1110$$\n\nThis positive error indicates that because the measured voltage was elevated by hysteresis on the charging path, the BMS overestimated the State of Charge.",
            "answer": "$$\n\\boxed{0.1110}\n$$"
        },
        {
            "introduction": "In addition to equilibrium phenomena like hysteresis, practical OCV characterization is complicated by dynamic effects. When a cell is under load, even at slow rates, the measured terminal voltage deviates from the true equilibrium OCV due to overpotentials from the cell's internal impedance. This exercise tackles the challenge of distinguishing the true OCV from this \"pseudo-OCV\" measured during cycling by building a dynamic model to simulate the process and then applying a physics-based correction to recover the underlying equilibrium relationship—a core skill in battery diagnostics and data analysis .",
            "id": "3934006",
            "problem": "You are tasked with constructing, analyzing, and correcting the determination of Open Circuit Voltage (OCV) as a function of State of Charge (SOC) during slow cycling in a lithium-ion cell, under the constraint of finite overpotentials caused by impedance. The scientific goal is to quantify how impedance growth biases pseudo-OCV estimates obtained during slow cycling, and to implement a physically principled correction that recovers the equilibrium OCV–SOC relationship. The work must begin from foundational principles suitable for automated battery design and simulation.\n\nBegin from the following fundamental base:\n- The definition of State of Charge (SOC) under galvanostatic operation: for a cell of capacity $Q$ in ampere-hours, the SOC $s(t)$ evolves according to $s(t) = s_0 - \\dfrac{1}{Q \\cdot 3600}\\int_0^t I(\\tau)\\,\\mathrm{d}\\tau$, where $I(t)$ is the applied current in amperes and time $t$ is in seconds.\n- The terminal voltage $V(t)$ of the cell under load equals the equilibrium voltage (Open Circuit Voltage) $U(s(t))$ minus the sum of overpotentials $ \\eta(t)$ due to internal impedance and reaction kinetics: $V(t) = U(s(t)) - \\eta(t)$.\n- For sufficiently small overpotentials, reaction kinetics can be linearized, yielding a linear time-invariant equivalent circuit representation (e.g., an ohmic resistance in series with a first-order relaxation element). You must rely on physically justified linear time-invariant reasoning to model the dynamic overpotential caused by finite current during slow cycling.\n\nYour tasks:\n1. Use the provided ground-truth OCV data as a function of SOC, defined at nodes and interpreted by cubic spline interpolation, to construct a smooth function $U(s)$ for $s \\in [0,1]$. The node values are:\n   - SOC nodes $s_i$: $[0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]$ (dimensionless).\n   - OCV nodes $U_i$ in volts: $[3.0, 3.25, 3.5, 3.6, 3.65, 3.7, 3.75, 3.85, 3.95, 4.1, 4.2]$.\n2. Under slow cycling with piecewise constant or slowly varying current, construct a physically justified dynamic overpotential model $\\eta(t)$ based on a linear time-invariant equivalent circuit comprising:\n   - An ohmic resistance $R_s$ in $\\Omega$.\n   - A first-order relaxation element characterized by a resistance $R_1$ in $\\Omega$ and a time constant $\\tau$ in seconds, reflecting linearized charge-transfer plus double-layer dynamics.\n   The model must be derived from first principles (e.g., Ohm's law and linearized kinetics) without relying on pre-provided shortcut formulas. Your model must account for the time-dependent evolution of the overpotential when the current changes and must be implementable in discrete time.\n3. Simulate slow-cycling discharge from an initial SOC $s_0$ to a final SOC $s_{\\mathrm{end}}$ using specified $Q$, time step $\\Delta t$, and current profile $I(t)$. For each time step, compute $s(t)$, the measured terminal voltage $V_{\\mathrm{meas}}(t)$ using $U(s(t))$ and your $\\eta(t)$ model, and the pseudo-OCV estimate $U_{\\mathrm{pseudo}}(s(t))$ obtained by naively equating measured voltage to OCV, i.e., $U_{\\mathrm{pseudo}}(s(t)) = V_{\\mathrm{meas}}(t)$.\n4. Propose and implement a principled correction method that uses your impedance model to recover an estimate $\\widehat{U}(s(t))$ of the equilibrium OCV. The method must add back the modeled overpotentials from the measured voltage at each time step, i.e., $\\widehat{U}(s(t)) = V_{\\mathrm{meas}}(t) + \\widehat{\\eta}(t)$, where $\\widehat{\\eta}(t)$ is computed from the known current profile and identified impedance parameters.\n5. Quantify the effect of impedance growth by computing error metrics between $U(s(t))$ and the uncorrected pseudo-OCV $U_{\\mathrm{pseudo}}(s(t))$, and between $U(s(t))$ and the corrected estimate $\\widehat{U}(s(t))$. Use:\n   - Root-mean-square error (RMSE): $\\mathrm{RMSE} = \\sqrt{\\dfrac{1}{N}\\sum_{k=1}^N \\left(\\widehat{U}(s_k) - U(s_k)\\right)^2}$, with $N$ samples.\n   - Maximum absolute error (MAX): $\\mathrm{MAX} = \\max_{k} \\left| \\widehat{U}(s_k) - U(s_k) \\right|$.\n   Express all voltage errors in volts.\n\nTest suite and parameters (use exactly these values and units):\n- Global OCV nodes (for cubic spline interpolation):\n  - SOC nodes $s_i$: $[0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]$.\n  - OCV nodes $U_i$ in volts: $[3.0, 3.25, 3.5, 3.6, 3.65, 3.7, 3.75, 3.85, 3.95, 4.1, 4.2]$.\n- Case $1$ (nominal impedance, slow constant discharge):\n  - Capacity $Q = 2.0\\,\\mathrm{Ah}$.\n  - Initial SOC $s_0 = 0.90$ (dimensionless).\n  - Final SOC $s_{\\mathrm{end}} = 0.20$ (dimensionless).\n  - Time step $\\Delta t = 10\\,\\mathrm{s}$.\n  - Constant current $I(t) \\equiv 0.10\\,\\mathrm{A}$ (discharge).\n  - Impedance parameters: $R_s = 0.05\\,\\Omega$, $R_1 = 0.015\\,\\Omega$, $\\tau = 200\\,\\mathrm{s}$.\n- Case $2$ (aged impedance growth, same slow constant discharge):\n  - Capacity $Q = 2.0\\,\\mathrm{Ah}$.\n  - Initial SOC $s_0 = 0.90$.\n  - Final SOC $s_{\\mathrm{end}} = 0.20$.\n  - Time step $\\Delta t = 10\\,\\mathrm{s}$.\n  - Constant current $I(t) \\equiv 0.10\\,\\mathrm{A}$.\n  - Impedance parameters: $R_s = 0.08\\,\\Omega$, $R_1 = 0.050\\,\\Omega$, $\\tau = 600\\,\\mathrm{s}$.\n- Case $3$ (aged impedance, very small current, boundary condition):\n  - Capacity $Q = 2.0\\,\\mathrm{Ah}$.\n  - Initial SOC $s_0 = 0.90$.\n  - Final SOC $s_{\\mathrm{end}} = 0.20$.\n  - Time step $\\Delta t = 10\\,\\mathrm{s}$.\n  - Constant current $I(t) \\equiv 0.005\\,\\mathrm{A}$.\n  - Impedance parameters: $R_s = 0.08\\,\\Omega$, $R_1 = 0.050\\,\\Omega$, $\\tau = 600\\,\\mathrm{s}$.\n\nRequired outputs for each case:\n- Compute four floats in volts: $\\left[\\mathrm{RMSE}_{\\mathrm{uncorr}}, \\mathrm{RMSE}_{\\mathrm{corr}}, \\mathrm{MAX}_{\\mathrm{uncorr}}, \\mathrm{MAX}_{\\mathrm{corr}}\\right]$, where “uncorr” compares $U_{\\mathrm{pseudo}}(s)$ to $U(s)$ and “corr” compares $\\widehat{U}(s)$ to $U(s)$.\n- Your program should produce a single line of output containing the results as a comma-separated list of three sublists in the order of Cases $1,2,3$, enclosed in square brackets. For example: $[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],[a_3,b_3,c_3,d_3]]$, where each $a_i,b_i,c_i,d_i$ is a float in volts.\n\nAll numerical answers must be expressed in volts as floats (no units in the numeric output string, but computed in volts). Angles do not appear in this problem. Percentages must be expressed as dimensionless decimals if needed, but this test suite does not use percentages.",
            "solution": "The user-provided problem is assessed as scientifically grounded, well-posed, and complete. All necessary data and physical principles for a unique solution are provided. The problem asks for the modeling of battery voltage during slow cycling, quantification of errors in OCV estimation due to impedance, and the implementation of a physics-based correction method. This is a standard and meaningful problem in battery modeling and diagnostics.\n\nThe solution proceeds in five steps as outlined in the problem description.\n\n### 1. Ground-Truth OCV-SOC Relationship\nThe equilibrium Open Circuit Voltage (OCV) as a function of State of Charge (SOC), denoted as $U(s)$, is the foundation of the model. The problem provides a set of discrete data points $(s_i, U_i)$. To create a continuous and differentiable function $U(s)$ for any SOC $s \\in [0, 1]$, we employ cubic spline interpolation. This method constructs a piecewise cubic polynomial function that passes through all data nodes, ensuring smoothness (continuity of the first and second derivatives) across the entire domain. The given nodes are:\n- SOC nodes $s_i$: $[0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]$\n- OCV nodes $U_i$ (in Volts): $[3.0, 3.25, 3.5, 3.6, 3.65, 3.7, 3.75, 3.85, 3.95, 4.1, 4.2]$\nA function `U_spline(s)` is constructed using these nodes, which will serve as the ground-truth OCV for the simulation.\n\n### 2. Dynamic Overpotential Model\nThe terminal voltage $V(t)$ deviates from the OCV $U(s(t))$ due to overpotential $\\eta(t)$:\n$$V(t) = U(s(t)) - \\eta(t)$$\nBy convention, discharge current $I(t)$ is positive, leading to a positive overpotential (voltage drop), so $V(t)  U(s(t))$. The overpotential is modeled using a linear time-invariant (LTI) equivalent circuit consisting of a series ohmic resistor $R_s$ and a single parallel Resistor-Capacitor (RC) network ($R_1, C_1$). The time constant of the RC network is $\\tau = R_1 C_1$.\n\nThe total overpotential $\\eta(t)$ is the sum of the voltage drops across these elements:\n$$\\eta(t) = \\eta_s(t) + \\eta_1(t)$$\n- The voltage drop across the ohmic resistor $R_s$ is instantaneous and given by Ohm's law: $\\eta_s(t) = I(t) R_s$.\n- The voltage drop across the RC network, $\\eta_1(t)$, represents slower dynamic processes like charge transfer and double-layer effects. The relationship between the current $I(t)$ flowing through the RC network and the voltage $\\eta_1(t)$ across it is described by the first-order ordinary differential equation (ODE):\n$$I(t) = \\frac{\\eta_1(t)}{R_1} + C_1 \\frac{d\\eta_1(t)}{dt}$$\nMultiplying by $R_1$ and using $\\tau = R_1 C_1$, we get:\n$$\\frac{d\\eta_1(t)}{dt} + \\frac{1}{\\tau}\\eta_1(t) = \\frac{1}{C_1}I(t) = \\frac{R_1}{\\tau}I(t)$$\nTo implement this in a discrete-time simulation with time step $\\Delta t$, we solve this ODE for a piecewise constant current $I_k$ over the interval $[t_k, t_{k+1}]$. The exact solution gives the update rule for the RC overpotential state $\\eta_{1,k} = \\eta_1(t_k)$:\n$$\\eta_{1,k+1} = \\eta_1(t_{k+1}) = \\eta_{1,k} e^{-\\Delta t/\\tau} + I_k R_1 (1 - e^{-\\Delta t/\\tau})$$\nThe total overpotential at time step $k+1$ is therefore:\n$$\\eta_{k+1} = I_{k+1} R_s + \\eta_{1,k+1}$$\nFor the specified problem, the current $I(t)$ is constant throughout the discharge, so $I_k = I$ for all $k$.\n\n### 3. Simulation of Slow-Cycling Discharge\nThe discharge process is simulated step-by-step. The state of the system at any time $t_k = k \\Delta t$ is described by the SOC $s_k$ and the RC overpotential $\\eta_{1,k}$.\n- **Initialization**: At $t_0=0$, the system starts at $s_0$ and is assumed to be at rest, so the dynamic overpotential is zero: $\\eta_{1,0} = 0$.\n- **Iteration**: The simulation proceeds from an initial SOC $s_0$ and stops when the SOC falls below the final SOC $s_{\\mathrm{end}}$. For each step from $k$ to $k+1$:\n    1. The SOC is updated using the discrete form of the definition (Coulomb counting):\n       $$s_{k+1} = s_k - \\frac{I \\cdot \\Delta t}{Q \\cdot 3600}$$\n    2. The RC overpotential state is updated using the discrete-time formula derived above:\n       $$\\eta_{1,k+1} = \\eta_{1,k} e^{-\\Delta t/\\tau} + I R_1 (1 - e^{-\\Delta t/\\tau})$$\n    3. The total overpotential at $t_{k+1}$ is calculated:\n       $$\\eta_{k+1} = I R_s + \\eta_{1,k+1}$$\n    4. The true OCV at the new SOC is found using the spline function: $U_{k+1} = U(s_{k+1})$.\n    5. The \"measured\" terminal voltage is simulated: $V_{\\mathrm{meas}, k+1} = U_{k+1} - \\eta_{k+1}$.\n    6. The uncorrected, naive pseudo-OCV is recorded: $U_{\\mathrm{pseudo}, k+1} = V_{\\mathrm{meas}, k+1}$.\nThe process generates time series of the true OCV $U(s_k)$ and the pseudo-OCV $U_{\\mathrm{pseudo}}(s_k)$ for $k=1, 2, \\dots, N$.\n\n### 4. Principled OCV Correction\nThe proposed correction method aims to recover the true OCV from the measured terminal voltage by compensating for the overpotential. The corrected OCV estimate, $\\widehat{U}(s)$, is given by:\n$$\\widehat{U}(s_k) = V_{\\mathrm{meas}, k} + \\widehat{\\eta}_k$$\nHere, $\\widehat{\\eta}_k$ is the estimated overpotential. In this simulation, we assume the impedance model and its parameters ($R_s, R_1, \\tau$) are known perfectly. Therefore, the estimated overpotential $\\widehat{\\eta}_k$ is identical to the one used to generate the data, $\\eta_k$. The calculation for $\\widehat{\\eta}_k$ follows the same steps as for $\\eta_k$, using the known current history $I$ and impedance parameters.\nConsequently, the correction becomes:\n$$\\widehat{U}_{k+1} = V_{\\mathrm{meas}, k+1} + \\eta_{k+1} = (U_{k+1} - \\eta_{k+1}) + \\eta_{k+1} = U_{k+1}$$\nThis demonstrates that if the impedance model is accurate and its parameters are known, the true OCV can be perfectly recovered. The error of the corrected estimate will be zero (or within floating-point precision of zero).\n\n### 5. Error Quantification\nThe performance of the naive estimation and the corrected estimation are quantified using Root-Mean-Square Error (RMSE) and Maximum Absolute Error (MAX) against the ground-truth OCV, $U(s)$. For a series of $N$ simulated points:\n- **Uncorrected Errors**:\n  - $\\mathrm{RMSE}_{\\mathrm{uncorr}} = \\sqrt{\\frac{1}{N}\\sum_{k=1}^N (U_{\\mathrm{pseudo}, k} - U_k)^2} = \\sqrt{\\frac{1}{N}\\sum_{k=1}^N (-\\eta_k)^2}$\n  - $\\mathrm{MAX}_{\\mathrm{uncorr}} = \\max_{k} |U_{\\mathrm{pseudo}, k} - U_k| = \\max_{k} |\\eta_k|$\n- **Corrected Errors**:\n  - $\\mathrm{RMSE}_{\\mathrm{corr}} = \\sqrt{\\frac{1}{N}\\sum_{k=1}^N (\\widehat{U}_k - U_k)^2} = 0$\n  - $\\mathrm{MAX}_{\\mathrm{corr}} = \\max_{k} |\\widehat{U}_k - U_k| = 0$\n\nThe results will highlight the magnitude of the error introduced by impedance and the effectiveness of the physics-based correction. Case 1 demonstrates the error for a nominal cell. Case 2 shows how this error increases significantly with aging (impedance growth). Case 3 serves as a boundary check, showing that the error becomes negligible as the measurement current approaches zero, confirming that slow-rate cycling approximates equilibrium conditions.",
            "answer": "[[0.006331940984852031, 0.0, 0.006497750109963283, 0.0],[0.01258957827297926, 0.0, 0.01299942475510008, 0.0],[0.000629478913648963, 0.0, 0.000649971237755004, 0.0]]"
        }
    ]
}