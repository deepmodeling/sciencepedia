{
    "hands_on_practices": [
        {
            "introduction": "一个全电池的开路电压-荷电状态（OCV-SOC）曲线并非任意的，它从根本上取决于其组成电极的特性以及它们之间的平衡方式。本练习将引导您根据单个电极的容量和总锂库存来确定电池的有效化学计量范围。通过掌握这一过程，您将理解电池设计者如何为特定应用设计出所需的电压窗口和容量。",
            "id": "3934017",
            "problem": "一个锂离子全电池耦合了一个正极嵌锂主体和一个负极嵌锂主体，其锂位化学计量数分别为 $x_p \\in [x_p^{\\min}, x_p^{\\max}]$ 和 $x_n \\in [x_n^{\\min}, x_n^{\\max}]$。设 $N_p$ 和 $N_n$ 分别表示正极和负极活性材料中晶格位点的总摩尔数，因此 $N_p x_p$ 和 $N_n x_n$ 分别是驻留在每个主体中的锂的摩尔数。设 $L_0$ 为活性材料中可循环锂的总量，因此根据锂守恒定律，在平衡状态下有 $N_p x_p + N_n x_n = L_0$。定义电极平衡比 $b \\equiv N_n/N_p$。全电池的开路电压 (OCV) 为 $U_{\\mathrm{cell}}(x_p,x_n) = U_p(x_p) - U_n(x_n)$，其中 $U_p(\\cdot)$ 和 $U_n(\\cdot)$ 分别是正极和负极主体相对于锂参比电极的半电池平衡电势。假设 $U_p(\\cdot)$ 和 $U_n(\\cdot)$ 在上述化学计量区间上是定义良好的单值函数。在恒流充电下，锂从正极移动到负极，因此 $dx_p  0$ 且 $dx_n  0$；在放电下，$dx_p  0$ 且 $dx_n  0$。\n\n电池的荷电状态 (SOC) 定义为在由锂守恒和部分锂化边界决定的可行集上，随 $x_n$ 单调增加（等价地，随 $x_p$ 单调减少）。SOC 端点是在不违反任何化学计量边界的情况下可达到的两个极端平衡状态。最大 OCV 窗口是放电末端 SOC 时的 OCV 与充电末端 SOC 时的 OCV 之间的差值。\n\n哪个选项用 $x_p^{\\min}, x_p^{\\max}, x_n^{\\min}, x_n^{\\max}, N_p, N_n$（或等价地用 $b$ 和 $L_0/N_p$）正确地表达了充电和放电时的有效化学计量端点以及由此产生的最大 OCV 窗口？\n\nA. 充电端点为\n$$\nx_p^{\\mathrm{ch}}=\\max\\!\\left(x_p^{\\min},\\,\\frac{L_0-N_n x_n^{\\max}}{N_p}\\right),\\quad\nx_n^{\\mathrm{ch}}=\\frac{L_0-N_p x_p^{\\mathrm{ch}}}{N_n}.\n$$\n放电端点为\n$$\nx_p^{\\mathrm{dis}}=\\min\\!\\left(x_p^{\\max},\\,\\frac{L_0-N_n x_n^{\\min}}{N_p}\\right),\\quad\nx_n^{\\mathrm{dis}}=\\frac{L_0-N_p x_p^{\\mathrm{dis}}}{N_n}.\n$$\n最大 OCV 窗口为\n$$\n\\Delta U_{\\max}=\\Big[U_p\\!\\big(x_p^{\\mathrm{dis}}\\big)-U_n\\!\\big(x_n^{\\mathrm{dis}}\\big)\\Big]-\\Big[U_p\\!\\big(x_p^{\\mathrm{ch}}\\big)-U_n\\!\\big(x_n^{\\mathrm{ch}}\\big)\\Big].\n$$\n\nB. 充电端点为\n$$\nx_p^{\\mathrm{ch}}=\\min\\!\\left(x_p^{\\min},\\,\\frac{L_0-N_n x_n^{\\max}}{N_p}\\right),\\quad\nx_n^{\\mathrm{ch}}=\\frac{L_0-N_p x_p^{\\mathrm{ch}}}{N_n}.\n$$\n放电端点为\n$$\nx_p^{\\mathrm{dis}}=\\max\\!\\left(x_p^{\\max},\\,\\frac{L_0-N_n x_n^{\\min}}{N_p}\\right),\\quad\nx_n^{\\mathrm{dis}}=\\frac{L_0-N_p x_p^{\\mathrm{dis}}}{N_n}.\n$$\n最大 OCV 窗口为\n$$\n\\Delta U_{\\max}=\\Big[U_p\\!\\big(x_p^{\\mathrm{dis}}\\big)-U_n\\!\\big(x_n^{\\mathrm{dis}}\\big)\\Big]-\\Big[U_p\\!\\big(x_p^{\\mathrm{ch}}\\big)-U_n\\!\\big(x_n^{\\mathrm{ch}}\\big)\\Big].\n$$\n\nC. 充电端点为\n$$\nx_p^{\\mathrm{ch}}=x_p^{\\min},\\quad x_n^{\\mathrm{ch}}=x_n^{\\max};\n$$\n放电端点为\n$$\nx_p^{\\mathrm{dis}}=x_p^{\\max},\\quad x_n^{\\mathrm{dis}}=x_n^{\\min}.\n$$\n最大 OCV 窗口为\n$$\n\\Delta U_{\\max}=\\Big[U_p\\!\\big(x_p^{\\max}\\big)-U_n\\!\\big(x_n^{\\min}\\big)\\Big]-\\Big[U_p\\!\\big(x_p^{\\min}\\big)-U_n\\!\\big(x_n^{\\max}\\big)\\Big],\n$$\n与 $L_0$ 和 $b$ 无关。\n\nD. 充电端点为\n$$\nx_n^{\\mathrm{ch}}=\\max\\!\\left(x_n^{\\max},\\,\\frac{L_0-N_p x_p^{\\min}}{N_n}\\right),\\quad\nx_p^{\\mathrm{ch}}=\\frac{L_0-N_n x_n^{\\mathrm{ch}}}{N_p}.\n$$\n放电端点为\n$$\nx_n^{\\mathrm{dis}}=\\min\\!\\left(x_n^{\\min},\\,\\frac{L_0-N_p x_p^{\\max}}{N_n}\\right),\\quad\nx_p^{\\mathrm{dis}}=\\frac{L_0-N_n x_n^{\\mathrm{dis}}}{N_p}.\n$$\n最大 OCV 窗口为\n$$\n\\Delta U_{\\max}=\\Big[U_p\\!\\big(x_p^{\\mathrm{dis}}\\big)-U_n\\!\\big(x_n^{\\mathrm{dis}}\\big)\\Big]-\\Big[U_p\\!\\big(x_p^{\\mathrm{ch}}\\big)-U_n\\!\\big(x_n^{\\mathrm{ch}}\\big)\\Big].\n$$",
            "solution": "该问题陈述是基于一个标准的零维平衡模型来确定锂离子电池操作范围的有效练习。它具有科学依据、是适定的，并且是客观的。所有必要的参数和约束都已提供，足以推导出唯一解。\n\n电池的状态由正极的化学计量数 $x_p$ 和负极的化学计量数 $x_n$ 描述。可行状态由以下三个同时满足的约束条件决定：\n1.  正极的化学计量数是有界的：$x_p \\in [x_p^{\\min}, x_p^{\\max}]$。\n2.  负极的化学计量数是有界的：$x_n \\in [x_n^{\\min}, x_n^{\\max}]$。\n3.  可循环锂的总量是守恒的：$N_p x_p + N_n x_n = L_0$。\n\n第三个约束，即锂守恒定律，可以被重新整理以用一个化学计量数表示另一个。例如，将 $x_p$ 表示为 $x_n$ 的函数：\n$$x_p = \\frac{L_0 - N_n x_n}{N_p}$$\n同样地，\n$$x_n = \\frac{L_0 - N_p x_p}{N_n}$$\n这种线性关系意味着所有可能的平衡状态 $(x_p, x_n)$ 的集合形成一个线段。该线段的端点由该直线与化学计量极限 $[x_p^{\\min}, x_p^{\\max}] \\times [x_n^{\\min}, x_n^{\\max}]$ 定义的矩形边界的交点确定。\n\n问题将荷电状态 (SOC) 定义为随 $x_n$ 单调增加。因此，电池工作窗口的充电末端对应于 $x_n$ 的最大可达值，而放电末端对应于 $x_n$ 的最小可达值。\n\n让我们推导充电末端的化学计量数，记为 $(x_p^{\\mathrm{ch}}, x_n^{\\mathrm{ch}})$。这个状态对应于最高的 SOC，这意味着 $x_n$ 被最大化而 $x_p$ 被最小化。让我们找出 $x_p$ 的最小可能值。\n$x_p$ 的值必须满足其自身的下界：\n$$x_p \\ge x_p^{\\min}$$\n此外，对应的 $x_n = (L_0 - N_p x_p)/N_n$ 的值不得超过其上界 $x_n^{\\max}$：\n$$\\frac{L_0 - N_p x_p}{N_n} \\le x_n^{\\max}$$\n$$L_0 - N_p x_p \\le N_n x_n^{\\max}$$\n$$L_0 - N_n x_n^{\\max} \\le N_p x_p$$\n$$x_p \\ge \\frac{L_0 - N_n x_n^{\\max}}{N_p}$$\n为了使状态有效，$x_p$ 必须同时满足两个下界。因此，$x_p$ 的最小可能值是这两个下界中的最大值：\n$$x_p^{\\mathrm{ch}} = \\max\\left(x_p^{\\min},\\,\\frac{L_0 - N_n x_n^{\\max}}{N_p}\\right)$$\n相应的负极化学计量数可以从守恒定律中求得：\n$$x_n^{\\mathrm{ch}} = \\frac{L_0 - N_p x_p^{\\mathrm{ch}}}{N_n}$$\n\n接下来，让我们推导放电末端的化学计量数，记为 $(x_p^{\\mathrm{dis}}, x_n^{\\mathrm{dis}})$。这个状态对应于最低的 SOC，这意味着 $x_n$ 被最小化而 $x_p$ 被最大化。让我们找出 $x_p$ 的最大可能值。\n$x_p$ 的值必须满足其自身的上界：\n$$x_p \\le x_p^{\\max}$$\n此外，对应的 $x_n = (L_0 - N_p x_p)/N_n$ 的值不得低于其下界 $x_n^{\\min}$：\n$$\\frac{L_0 - N_p x_p}{N_n} \\ge x_n^{\\min}$$\n$$L_0 - N_p x_p \\ge N_n x_n^{\\min}$$\n$$N_p x_p \\le L_0 - N_n x_n^{\\min}$$\n$$x_p \\le \\frac{L_0 - N_n x_n^{\\min}}{N_p}$$\n为了使状态有效，$x_p$ 必须同时满足两个上界。因此，$x_p$ 的最大可能值是这两个上界中的最小值：\n$$x_p^{\\mathrm{dis}} = \\min\\left(x_p^{\\max},\\,\\frac{L_0 - N_n x_n^{\\min}}{N_p}\\right)$$\n相应的负极化学计量数可以从守恒定律中求得：\n$$x_n^{\\mathrm{dis}} = \\frac{L_0 - N_p x_p^{\\mathrm{dis}}}{N_n}$$\n\n最大 OCV 窗口定义为放电末端的 OCV 减去充电末端的 OCV。电池的 OCV 为 $U_{\\mathrm{cell}} = U_p(x_p) - U_n(x_n)$。\n所以，OCV 窗口为：\n$$ \\Delta U_{\\max} = U_{\\mathrm{cell}}(x_p^{\\mathrm{dis}}, x_n^{\\mathrm{dis}}) - U_{\\mathrm{cell}}(x_p^{\\mathrm{ch}}, x_n^{\\mathrm{ch}}) $$\n$$ \\Delta U_{\\max} = \\Big[U_p(x_p^{\\mathrm{dis}}) - U_n(x_n^{\\mathrm{dis}})\\Big] - \\Big[U_p(x_p^{\\mathrm{ch}}) - U_n(x_n^{\\mathrm{ch}})\\Big] $$\n\n现在我们来评估每个选项。\n\nA. 该选项陈述：\n充电端点为 $x_p^{\\mathrm{ch}}=\\max\\!\\left(x_p^{\\min},\\,\\frac{L_0-N_n x_n^{\\max}}{N_p}\\right)$ 和 $x_n^{\\mathrm{ch}}=\\frac{L_0-N_p x_p^{\\mathrm{ch}}}{N_n}$。\n放电端点为 $x_p^{\\mathrm{dis}}=\\min\\!\\left(x_p^{\\max},\\,\\frac{L_0-N_n x_n^{\\min}}{N_p}\\right)$ 和 $x_n^{\\mathrm{dis}}=\\frac{L_0-N_p x_p^{\\mathrm{dis}}}{N_n}$。\n最大 OCV 窗口为 $\\Delta U_{\\max}=\\Big[U_p\\!\\big(x_p^{\\mathrm{dis}}\\big)-U_n\\!\\big(x_n^{\\mathrm{dis}}\\big)\\Big]-\\Big[U_p\\!\\big(x_p^{\\mathrm{ch}}\\big)-U_n\\!\\big(x_n^{\\mathrm{ch}}\\big)\\Big]$。\n这些表达式与我们推导出的结果完全匹配。\n结论：**正确**。\n\nB. 该选项陈述：\n$x_p^{\\mathrm{ch}}=\\min\\!\\left(x_p^{\\min},\\,\\frac{L_0-N_n x_n^{\\max}}{N_p}\\right)$。这是不正确的。根据推导，$x_p$ 的最小值必须是两个下界中的最大值，而不是最小值。\n$x_p^{\\mathrm{dis}}=\\max\\!\\left(x_p^{\\max},\\,\\frac{L_0-N_n x_n^{\\min}}{N_p}\\right)$。这是不正确的。根据推导，$x_p$ 的最大值必须是两个上界中的最小值，而不是最大值。min 和 max 的使用颠倒了。\n结论：**不正确**。\n\nC. 该选项陈述：\n$x_p^{\\mathrm{ch}}=x_p^{\\min}, x_n^{\\mathrm{ch}}=x_n^{\\max}$ 和 $x_p^{\\mathrm{dis}}=x_p^{\\max}, x_n^{\\mathrm{dis}}=x_n^{\\min}$。这是一个特殊情况，仅当锂总量 $L_0$ 与电极容量完美匹配时才会发生（即 $L_0 = N_p x_p^{\\min} + N_n x_n^{\\max}$ 和 $L_0 = N_p x_p^{\\max} + N_n x_n^{\\min}$，这通常是不可能的，除非两个电极的可循环容量完全相同）。通常情况下，工作窗口在每一端仅受一个电极的化学计量极限的限制。这个选项过度简化了一般情况。它还错误地声称结果与 $L_0$ 和平衡比 $b = N_n/N_p$ 无关，而我们的推导清楚地表明端点依赖于这些参数。\n结论：**不正确**。\n\nD. 该选项陈述了以 $x_n$ 表示的端点：\n$x_n^{\\mathrm{ch}}=\\max\\!\\left(x_n^{\\max},\\,\\frac{L_0-N_p x_p^{\\min}}{N_n}\\right)$。充电末端是 $x_n$ 的最大可达值。$x_n$ 的值受其自身上界 $x_n^{\\max}$ 和由 $x_p \\ge x_p^{\\min}$ 施加的边界 $x_n \\le (L_0 - N_p x_p^{\\min})/N_n$ 的限制。因此，$x_n$ 的最大值是这两个上界中的最小值：$x_n^{\\mathrm{ch}} = \\min(x_n^{\\max}, (L_0 - N_p x_p^{\\min})/N_n)$。该选项错误地使用了 $\\max$。\n$x_n^{\\mathrm{dis}}=\\min\\!\\left(x_n^{\\min},\\,\\frac{L_0-N_p x_p^{\\max}}{N_n}\\right)$。放电末端是 $x_n$ 的最小可达值。$x_n$ 必须大于其自身下界 $x_n^{\\min}$ 和由 $x_p \\le x_p^{\\max}$ 施加的边界 $x_n \\ge (L_0 - N_p x_p^{\\max})/N_n$。因此，$x_n$ 的最小值是这两个下界中的最大值：$x_n^{\\mathrm{dis}} = \\max(x_n^{\\min}, (L_0 - N_p x_p^{\\max})/N_n)$。该选项错误地使用了 $\\min$。\nmin 和 max 的使用颠倒了。\n结论：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "许多先进的电极材料会表现出 OCV 迟滞现象，即在相同的荷电状态下，充电电压与放电电压不同。本练习提供了一个定量场景，用于计算当电池管理系统（BMS）忽略此现象时所产生的显著荷电状态（SOC）估算误差。这项练习将加深您对精确建模迟滞现象对于可靠电池状态估算至关重要性的理解。",
            "id": "3934033",
            "problem": "一种锂离子嵌入式电池的开路电压-荷电状态（OCV–SOC）关系在中等荷电状态区域表现出可测量的路径依赖性（迟滞现象）。考虑一个假设的电池，其平衡开路电压（OCV）作为活性材料中锂分数（此处作为荷电状态，因此 $x \\in (0,1)$）的函数，可由一个类能斯特形式近似表示：\n$$U_{\\mathrm{eq}}(x) = U^{\\circ} + \\frac{RT}{F} \\ln\\!\\left(\\frac{x}{1-x}\\right),$$\n其中 $U^{\\circ}$ 是一个参考电位，$R$ 是通用气体常数，$T$ 是绝对温度，$F$ 是法拉第常数。在中等荷电状态区域 $x \\in [0.4,0.7]$，该电池表现出迟滞现象，使得通过充电（嵌入路径）达到该荷电状态后测得的开路电压相对于平衡曲线有一个恒定的正向偏移，而通过放电（脱出路径）达到该荷电状态后，则有相同大小的负向偏移：\n$$U_{\\mathrm{in}}(x) = U_{\\mathrm{eq}}(x) + H,\\qquad U_{\\mathrm{out}}(x) = U_{\\mathrm{eq}}(x) - H,$$\n对于 $x \\in [0.4,0.7]$，迟滞幅度 $H$ 是一个常数。\n\n一个忽略迟滞现象的电池管理系统（BMS）使用单值平衡函数 $U_{\\mathrm{eq}}(x)$，通过反解 $U_{\\mathrm{eq}}(x)$ 来从 OCV 测量值估计荷电状态。假设在电池充电至中等荷电状态区域后进行了一次静置测量，因此测得的 OCV 为 $U_{\\mathrm{meas}} = U_{\\mathrm{in}}(x_{\\mathrm{true}})$。取迟滞区域内的真实荷电状态为 $x_{\\mathrm{true}} = 0.55$，迟滞幅度 $H = 0.012\\,\\mathrm{V}$，参考电位 $U^{\\circ} = 3.600\\,\\mathrm{V}$，温度 $T = 298\\,\\mathrm{K}$，通用气体常数 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，以及法拉第常数 $F = 96485\\,\\mathrm{C\\,mol^{-1}}$。\n\n仅使用给定的定义和常数，计算当忽略迟滞现象的 BMS 在 $U_{\\mathrm{meas}}$ 处对 $U_{\\mathrm{eq}}(x)$ 进行反解时产生的表观荷电状态估计误差\n$$e \\equiv x_{\\mathrm{hat}} - x_{\\mathrm{true}},$$\n将最终误差表示为无单位的小数。将答案四舍五入到四位有效数字。",
            "solution": "本题要求计算当电池管理系统（BMS）忽略 OCV 迟滞现象时产生的荷电状态（SOC）估计误差。对问题陈述的验证表明，其科学上合理、问题设定良好且内部一致。因此，我们可以进行严谨的求解。\n\n问题的核心在于电池的实际电压与 BMS 所使用的模型之间的差异。电池的真实 SOC 是 $x_{\\mathrm{true}}$，并且是通过充电达到此状态的。因此，其测得的开路电压（OCV）位于迟滞环的嵌入（充电）分支上，由 $U_{\\mathrm{in}}(x)$ 给出。根据问题陈述，该电压为：\n$$U_{\\mathrm{meas}} = U_{\\mathrm{in}}(x_{\\mathrm{true}}) = U_{\\mathrm{eq}}(x_{\\mathrm{true}}) + H$$\n此处，$U_{\\mathrm{eq}}(x)$ 是平衡 OCV，$H$ 是恒定的迟滞偏移量。\n\n然而，BMS 未能意识到迟滞现象，并在假设测得电压对应于平衡曲线的条件下运行。它通过反解平衡函数 $U_{\\mathrm{eq}}(x)$ 来估计 SOC（记为 $x_{\\mathrm{hat}}$）。因此，BMS 求解以下方程以得到 $x_{\\mathrm{hat}}$：\n$$U_{\\mathrm{meas}} = U_{\\mathrm{eq}}(x_{\\mathrm{hat}})$$\n\n通过令 $U_{\\mathrm{meas}}$ 的两个表达式相等，我们建立了真实 SOC $x_{\\mathrm{true}}$ 和估计 SOC $x_{\\mathrm{hat}}$ 之间的核心关系：\n$$U_{\\mathrm{eq}}(x_{\\mathrm{hat}}) = U_{\\mathrm{eq}}(x_{\\mathrm{true}}) + H$$\n\n现在，我们代入给定的平衡电压的类能斯特形式，$U_{\\mathrm{eq}}(x) = U^{\\circ} + \\frac{RT}{F} \\ln\\left(\\frac{x}{1-x}\\right)$：\n$$U^{\\circ} + \\frac{RT}{F} \\ln\\left(\\frac{x_{\\mathrm{hat}}}{1-x_{\\mathrm{hat}}}\\right) = \\left(U^{\\circ} + \\frac{RT}{F} \\ln\\left(\\frac{x_{\\mathrm{true}}}{1-x_{\\mathrm{true}}}\\right)\\right) + H$$\n\n参考电位 $U^{\\circ}$ 从两侧消去，得到：\n$$\\frac{RT}{F} \\ln\\left(\\frac{x_{\\mathrm{hat}}}{1-x_{\\mathrm{hat}}}\\right) = \\frac{RT}{F} \\ln\\left(\\frac{x_{\\mathrm{true}}}{1-x_{\\mathrm{true}}}\\right) + H$$\n\n为了求解 $x_{\\mathrm{hat}}$，我们首先分离对数项：\n$$\\ln\\left(\\frac{x_{\\mathrm{hat}}}{1-x_{\\mathrm{hat}}}\\right) = \\ln\\left(\\frac{x_{\\mathrm{true}}}{1-x_{\\mathrm{true}}}\\right) + \\frac{H F}{RT}$$\n\n这个方程表明，迟滞电压 $H$ 在经过 logit 变换的 SOC 中引入了一个加性误差，其中 logit 函数为 $\\mathrm{logit}(p) = \\ln(p/(1-p))$。为了求得 $x_{\\mathrm{hat}}$，我们对两边取指数：\n$$\\frac{x_{\\mathrm{hat}}}{1-x_{\\mathrm{hat}}} = \\exp\\left(\\ln\\left(\\frac{x_{\\mathrm{true}}}{1-x_{\\mathrm{true}}}\\right) + \\frac{H F}{RT}\\right)$$\n$$\\frac{x_{\\mathrm{hat}}}{1-x_{\\mathrm{hat}}} = \\exp\\left(\\ln\\left(\\frac{x_{\\mathrm{true}}}{1-x_{\\mathrm{true}}}\\right)\\right) \\cdot \\exp\\left(\\frac{H F}{RT}\\right)$$\n$$\\frac{x_{\\mathrm{hat}}}{1-x_{\\mathrm{hat}}} = \\left(\\frac{x_{\\mathrm{true}}}{1-x_{\\mathrm{true}}}\\right) \\exp\\left(\\frac{H F}{RT}\\right)$$\n\n让我们定义一个量 $A \\equiv \\left(\\frac{x_{\\mathrm{true}}}{1-x_{\\mathrm{true}}}\\right) \\exp\\left(\\frac{H F}{RT}\\right)$。方程变为 $\\frac{x_{\\mathrm{hat}}}{1-x_{\\mathrm{hat}}} = A$。我们可以解出 $x_{\\mathrm{hat}}$：\n$$x_{\\mathrm{hat}} = A(1-x_{\\mathrm{hat}}) = A - A x_{\\mathrm{hat}}$$\n$$x_{\\mathrm{hat}}(1+A) = A$$\n$$x_{\\mathrm{hat}} = \\frac{A}{1+A}$$\n\n现在，我们代入给定的数值：\n$x_{\\mathrm{true}} = 0.55$\n$H = 0.012\\,\\mathrm{V}$\n$T = 298\\,\\mathrm{K}$\n$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n$F = 96485\\,\\mathrm{C\\,mol^{-1}}$\n\n首先，我们计算热电压项 $\\frac{RT}{F}$：\n$$\\frac{RT}{F} = \\frac{(8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(298\\,\\mathrm{K})}{96485\\,\\mathrm{C\\,mol^{-1}}} \\approx 0.025679\\,\\mathrm{V}$$\n\n接下来，我们计算 $A$ 表达式中的指数：\n$$\\frac{H F}{RT} = \\frac{H}{RT/F} \\approx \\frac{0.012\\,\\mathrm{V}}{0.025679\\,\\mathrm{V}} \\approx 0.46730$$\n\n现在我们可以计算 A：\n$$A = \\left(\\frac{0.55}{1-0.55}\\right) \\exp(0.46730) = \\left(\\frac{0.55}{0.45}\\right) \\exp(0.46730)$$\n$$A \\approx (1.2222\\ldots) \\cdot (1.59567\\ldots) \\approx 1.95013$$\n\n使用这个 $A$ 值，我们求出估计的 SOC，$x_{\\mathrm{hat}}$：\n$$x_{\\mathrm{hat}} = \\frac{A}{1+A} \\approx \\frac{1.95013}{1+1.95013} = \\frac{1.95013}{2.95013} \\approx 0.66103$$\n\nSOC 估计误差 $e$ 定义为 $e \\equiv x_{\\mathrm{hat}} - x_{\\mathrm{true}}$。\n$$e \\approx 0.66103 - 0.55 = 0.11103$$\n\n题目要求将答案四舍五入到四位有效数字。第五位有效数字是 3，所以我们向下舍入。\n$$e \\approx 0.1110$$\n\n这个正误差表明，由于测量电压在充电路径上因迟滞现象而升高，BMS 高估了荷电状态。",
            "answer": "$$\n\\boxed{0.1110}\n$$"
        },
        {
            "introduction": "在实践中，由于电池内阻引起的动力学过电势，当有电流流过时，我们无法直接测量到真正的平衡 OCV。这个编程练习将指导您模拟一个慢速循环实验，量化阻抗在一个“伪 OCV”测量中引入的误差，并实现一个基于物理原理的校正方法。这将为您提供一种从真实世界实验数据中提取纯净 OCV-SOC 曲线的实用方法。",
            "id": "3934006",
            "problem": "您的任务是在存在由阻抗引起的有限过电位约束下，构建、分析和校正锂离子电池在慢速循环过程中开路电压 (OCV) 作为荷电状态 (SOC) 函数的确定方法。科学目标是量化阻抗增长如何使慢速循环期间获得的伪 OCV 估算产生偏差，并实施一种基于物理原理的校正方法，以恢复平衡状态下的 OCV–SOC 关系。这项工作必须从适用于自动化电池设计和模拟的基本原理开始。\n\n从以下基本依据开始：\n- 恒流操作下荷电状态 (SOC) 的定义：对于一个容量为 $Q$ 安时的电池，SOC $s(t)$ 的演变遵循 $s(t) = s_0 - \\dfrac{1}{Q \\cdot 3600}\\int_0^t I(\\tau)\\,\\mathrm{d}\\tau$，其中 $I(t)$ 是以安培为单位的施加电流，时间 $t$ 以秒为单位。\n- 负载下电池的端电压 $V(t)$ 等于平衡电压（开路电压）$U(s(t))$ 减去由内阻和反应动力学引起的过电位之和 $\\eta(t)$：$V(t) = U(s(t)) - \\eta(t)$。\n- 对于足够小的过电位，反应动力学可以线性化，从而得到一个线性时不变等效电路表示（例如，一个欧姆电阻与一个一阶弛豫元件串联）。您必须依赖基于物理的线性时不变推理来为慢速循环期间有限电流引起的动态过电位建模。\n\n您的任务：\n1. 使用所提供的作为 SOC 函数的基准 OCV 数据（在节点上定义，并通过三次样条插值进行解释），为 $s \\in [0,1]$ 构建一个平滑函数 $U(s)$。节点值如下：\n   - SOC 节点 $s_i$：$[0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]$（无量纲）。\n   - OCV 节点 $U_i$（单位：伏特）：$[3.0, 3.25, 3.5, 3.6, 3.65, 3.7, 3.75, 3.85, 3.95, 4.1, 4.2]$。\n2. 在慢速循环和分段恒定或缓慢变化的电流下，基于一个由以下部分组成的线性时不变等效电路，构建一个有物理依据的动态过电位模型 $\\eta(t)$：\n   - 一个欧姆电阻 $R_s$（单位：$\\Omega$）。\n   - 一个由电阻 $R_1$（单位：$\\Omega$）和时间常数 $\\tau$（单位：秒）表征的一阶弛豫元件，反映了线性化的电荷转移和双电层动力学。\n   该模型必须从第一性原理（例如，欧姆定律和线性化动力学）推导得出，不得依赖于预先提供的简化公式。您的模型必须考虑当电流变化时过电位的时间相关演变，并且必须能在离散时间内实现。\n3. 使用指定的 $Q$、时间步长 $\\Delta t$ 和电流曲线 $I(t)$，模拟从初始 SOC $s_0$ 到最终 SOC $s_{\\mathrm{end}}$ 的慢速循环放电。对于每个时间步，计算 $s(t)$、使用 $U(s(t))$ 和您的 $\\eta(t)$ 模型计算的测量端电压 $V_{\\mathrm{meas}}(t)$，以及通过简单地将测量电压等同于 OCV（即 $U_{\\mathrm{pseudo}}(s(t)) = V_{\\mathrm{meas}}(t)$）获得的伪 OCV 估算值 $U_{\\mathrm{pseudo}}(s(t))$。\n4. 提出并实施一种基于原理的校正方法，该方法使用您的阻抗模型来恢复平衡 OCV 的估算值 $\\widehat{U}(s(t))$。该方法必须在每个时间步将建模的过电位加回到测量电压上，即 $\\widehat{U}(s(t)) = V_{\\mathrm{meas}}(t) + \\widehat{\\eta}(t)$，其中 $\\widehat{\\eta}(t)$ 是根据已知的电流曲线和已识别的阻抗参数计算得出的。\n5. 通过计算 $U(s(t))$ 与未校正的伪 OCV $U_{\\mathrm{pseudo}}(s(t))$ 之间，以及 $U(s(t))$ 与校正后的估算值 $\\widehat{U}(s(t))$ 之间的误差度量，来量化阻抗增长的影响。使用：\n   - 均方根误差 (RMSE)：$\\mathrm{RMSE} = \\sqrt{\\dfrac{1}{N}\\sum_{k=1}^N \\left(\\widehat{U}(s_k) - U(s_k)\\right)^2}$，其中 $N$ 为样本数。\n   - 最大绝对误差 (MAX)：$\\mathrm{MAX} = \\max_{k} \\left| \\widehat{U}(s_k) - U(s_k) \\right|$。\n   所有电压误差均以伏特表示。\n\n测试套件和参数（请精确使用这些值和单位）：\n- 全局 OCV 节点（用于三次样条插值）：\n  - SOC 节点 $s_i$：$[0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]$。\n  - OCV 节点 $U_i$（单位：伏特）：$[3.0, 3.25, 3.5, 3.6, 3.65, 3.7, 3.75, 3.85, 3.95, 4.1, 4.2]$。\n- 情况 1（标称阻抗，慢速恒流放电）：\n  - 容量 $Q = 2.0\\,\\mathrm{Ah}$。\n  - 初始 SOC $s_0 = 0.90$（无量纲）。\n  - 最终 SOC $s_{\\mathrm{end}} = 0.20$（无量纲）。\n  - 时间步长 $\\Delta t = 10\\,\\mathrm{s}$。\n  - 恒定电流 $I(t) \\equiv 0.10\\,\\mathrm{A}$（放电）。\n  - 阻抗参数：$R_s = 0.05\\,\\Omega$，$R_1 = 0.015\\,\\Omega$，$\\tau = 200\\,\\mathrm{s}$。\n- 情况 2（老化阻抗增长，相同的慢速恒流放电）：\n  - 容量 $Q = 2.0\\,\\mathrm{Ah}$。\n  - 初始 SOC $s_0 = 0.90$。\n  - 最终 SOC $s_{\\mathrm{end}} = 0.20$。\n  - 时间步长 $\\Delta t = 10\\,\\mathrm{s}$。\n  - 恒定电流 $I(t) \\equiv 0.10\\,\\mathrm{A}$。\n  - 阻抗参数：$R_s = 0.08\\,\\Omega$，$R_1 = 0.050\\,\\Omega$，$\\tau = 600\\,\\mathrm{s}$。\n- 情况 3（老化阻抗，极小电流，边界条件）：\n  - 容量 $Q = 2.0\\,\\mathrm{Ah}$。\n  - 初始 SOC $s_0 = 0.90$。\n  - 最终 SOC $s_{\\mathrm{end}} = 0.20$。\n  - 时间步长 $\\Delta t = 10\\,\\mathrm{s}$。\n  - 恒定电流 $I(t) \\equiv 0.005\\,\\mathrm{A}$。\n  - 阻抗参数：$R_s = 0.08\\,\\Omega$，$R_1 = 0.050\\,\\Omega$，$\\tau = 600\\,\\mathrm{s}$。\n\n每种情况所需的输出：\n- 计算四个浮点数（单位：伏特）：$\\left[\\mathrm{RMSE}_{\\mathrm{uncorr}}, \\mathrm{RMSE}_{\\mathrm{corr}}, \\mathrm{MAX}_{\\mathrm{uncorr}}, \\mathrm{MAX}_{\\mathrm{corr}}\\right]$，其中“uncorr”比较的是 $U_{\\mathrm{pseudo}}(s)$ 与 $U(s)$，“corr”比较的是 $\\widehat{U}(s)$ 与 $U(s)$。\n- 您的程序应生成一行输出，其中包含按情况 1、2、3 的顺序排列的三个子列表组成的逗号分隔列表，并用方括号括起来。例如：$[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],[a_3,b_3,c_3,d_3]]$，其中每个 $a_i,b_i,c_i,d_i$ 都是以伏特为单位的浮点数。\n\n所有数值答案必须以伏特为单位表示为浮点数（数字输出字符串中不含单位，但计算时以伏特为单位）。本问题不涉及角度。如果需要，百分比必须表示为无量纲小数，但本测试套件不使用百分比。",
            "solution": "用户提供的问题被评估为科学上合理、提法明确且完整。唯一解所需的所有必要数据和物理原理均已提供。该问题要求对慢速循环期间的电池电压进行建模，量化由阻抗引起的 OCV 估算误差，并实施一种基于物理的校正方法。这是电池建模与诊断领域一个标准且有意义的问题。\n\n解决方案按问题描述中概述的五个步骤进行。\n\n### 1. 基准 OCV-SOC 关系\n作为荷电状态 (SOC) 函数的平衡开路电压 (OCV)，表示为 $U(s)$，是模型的基础。问题提供了一组离散数据点 $(s_i, U_i)$。为了为任何 SOC $s \\in [0, 1]$ 创建一个连续可微的函数 $U(s)$，我们采用三次样条插值。此方法构建一个分段三次多项式函数，该函数穿过所有数据节点，确保在整个定义域内的光滑性（一阶和二阶导数的连续性）。给定的节点是：\n- SOC 节点 $s_i$：$[0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]$\n- OCV 节点 $U_i$（单位：伏特）：$[3.0, 3.25, 3.5, 3.6, 3.65, 3.7, 3.75, 3.85, 3.95, 4.1, 4.2]$\n使用这些节点构建一个函数 `U_spline(s)`，它将作为模拟的基准 OCV。\n\n### 2. 动态过电位模型\n由于过电位 $\\eta(t)$ 的存在，端电压 $V(t)$ 会偏离 OCV $U(s(t))$：\n$$V(t) = U(s(t)) - \\eta(t)$$\n按照惯例，放电电流 $I(t)$ 为正，导致正的过电位（电压降），因此 $V(t)  U(s(t))$。过电位使用一个线性时不变 (LTI) 等效电路进行建模，该电路由一个串联欧姆电阻 $R_s$ 和一个并联电阻-电容 (RC) 网络（$R_1, C_1$）组成。RC 网络的时间常数为 $\\tau = R_1 C_1$。\n\n总过电位 $\\eta(t)$ 是这些元件上电压降的总和：\n$$\\eta(t) = \\eta_s(t) + \\eta_1(t)$$\n- 欧姆电阻 $R_s$ 上的电压降是瞬时的，由欧姆定律给出：$\\eta_s(t) = I(t) R_s$。\n- RC 网络上的电压降 $\\eta_1(t)$ 代表较慢的动态过程，如电荷转移和双电层效应。流经 RC 网络的电流 $I(t)$ 与其两端电压 $\\eta_1(t)$ 之间的关系由以下一阶常微分方程 (ODE) 描述：\n$$I(t) = \\frac{\\eta_1(t)}{R_1} + C_1 \\frac{d\\eta_1(t)}{dt}$$\n两边乘以 $R_1$ 并使用 $\\tau = R_1 C_1$，我们得到：\n$$\\frac{d\\eta_1(t)}{dt} + \\frac{1}{\\tau}\\eta_1(t) = \\frac{1}{C_1}I(t) = \\frac{R_1}{\\tau}I(t)$$\n为了在时间步长为 $\\Delta t$ 的离散时间模拟中实现这一点，我们针对在区间 $[t_k, t_{k+1}]$ 上的分段恒定电流 $I_k$ 求解此 ODE。精确解给出了 RC 过电位状态 $\\eta_{1,k} = \\eta_1(t_k)$ 的更新规则：\n$$\\eta_{1,k+1} = \\eta_1(t_{k+1}) = \\eta_{1,k} e^{-\\Delta t/\\tau} + I_k R_1 (1 - e^{-\\Delta t/\\tau})$$\n因此，在时间步 $k+1$ 的总过电位是：\n$$\\eta_{k+1} = I_{k+1} R_s + \\eta_{1,k+1}$$\n对于指定的问题，电流 $I(t)$ 在整个放电过程中是恒定的，因此对于所有 $k$，$I_k = I$。\n\n### 3. 慢速循环放电的模拟\n放电过程是逐步模拟的。在任何时间 $t_k = k \\Delta t$ 的系统状态由 SOC $s_k$ 和 RC 过电位 $\\eta_{1,k}$ 描述。\n- **初始化**：在 $t_0=0$ 时，系统从 $s_0$ 开始，并假定处于静止状态，因此动态过电位为零：$\\eta_{1,0} = 0$。\n- **迭代**：模拟从初始 SOC $s_0$ 开始，当 SOC 降至最终 SOC $s_{\\mathrm{end}}$ 以下时停止。对于从 $k$ 到 $k+1$ 的每一步：\n    1. 使用定义的离散形式（库仑计数）更新 SOC：\n       $$s_{k+1} = s_k - \\frac{I \\cdot \\Delta t}{Q \\cdot 3600}$$\n    2. 使用上面推导的离散时间公式更新 RC 过电位状态：\n       $$\\eta_{1,k+1} = \\eta_{1,k} e^{-\\Delta t/\\tau} + I R_1 (1 - e^{-\\Delta t/\\tau})$$\n    3. 计算在 $t_{k+1}$ 的总过电位：\n       $$\\eta_{k+1} = I R_s + \\eta_{1,k+1}$$\n    4. 使用样条函数找到新 SOC 下的真实 OCV：$U_{k+1} = U(s_{k+1})$。\n    5. 模拟“测量”的端电压：$V_{\\mathrm{meas}, k+1} = U_{k+1} - \\eta_{k+1}$。\n    6. 记录未经校正的、朴素的伪 OCV：$U_{\\mathrm{pseudo}, k+1} = V_{\\mathrm{meas}, k+1}$。\n该过程生成了真实 OCV $U(s_k)$ 和伪 OCV $U_{\\mathrm{pseudo}}(s_k)$ 在 $k=1, 2, \\dots, N$ 的时间序列。\n\n### 4. 基于原理的 OCV 校正\n所提出的校正方法旨在通过补偿过电位，从测量的端电压中恢复真实的 OCV。校正后的 OCV 估算值 $\\widehat{U}(s)$ 由下式给出：\n$$\\widehat{U}(s_k) = V_{\\mathrm{meas}, k} + \\widehat{\\eta}_k$$\n这里，$\\widehat{\\eta}_k$ 是估算的过电位。在此模拟中，我们假设阻抗模型及其参数（$R_s, R_1, \\tau$）是完全已知的。因此，估算的过电位 $\\widehat{\\eta}_k$ 与用于生成数据的过电位 $\\eta_k$ 是相同的。$\\widehat{\\eta}_k$ 的计算遵循与 $\\eta_k$ 相同的步骤，使用已知的电流历史 $I$ 和阻抗参数。\n因此，校正变为：\n$$\\widehat{U}_{k+1} = V_{\\mathrm{meas}, k+1} + \\eta_{k+1} = (U_{k+1} - \\eta_{k+1}) + \\eta_{k+1} = U_{k+1}$$\n这表明，如果阻抗模型是准确的并且其参数已知，那么真实的 OCV 就可以被完全恢复。校正后估算值的误差将为零（或在浮点精度范围内为零）。\n\n### 5. 误差量化\n使用均方根误差 (RMSE) 和最大绝对误差 (MAX) 对比基准 OCV $U(s)$，来量化朴素估计和校正估计的性能。对于一系列 $N$ 个模拟点：\n- **未校正误差**：\n  - $\\mathrm{RMSE}_{\\mathrm{uncorr}} = \\sqrt{\\frac{1}{N}\\sum_{k=1}^N (U_{\\mathrm{pseudo}, k} - U_k)^2} = \\sqrt{\\frac{1}{N}\\sum_{k=1}^N (-\\eta_k)^2}$\n  - $\\mathrm{MAX}_{\\mathrm{uncorr}} = \\max_{k} |U_{\\mathrm{pseudo}, k} - U_k| = \\max_{k} |\\eta_k|$\n- **校正后误差**：\n  - $\\mathrm{RMSE}_{\\mathrm{corr}} = \\sqrt{\\frac{1}{N}\\sum_{k=1}^N (\\widehat{U}_k - U_k)^2} = 0$\n  - $\\mathrm{MAX}_{\\mathrm{corr}} = \\max_{k} |\\widehat{U}_k - U_k| = 0$\n\n结果将突显由阻抗引入的误差大小以及基于物理的校正的有效性。情况 1 展示了标称电池的误差。情况 2 显示了随着老化（阻抗增长），该误差如何显著增加。情况 3 作为边界检查，表明当测量电流趋近于零时，误差变得可以忽略不计，这证实了慢速循环近似于平衡条件。",
            "answer": "```python\nimport numpy as np\nfrom scipy.interpolate import CubicSpline\n\ndef solve():\n    \"\"\"\n    Constructs, analyzes, and corrects OCV-SOC determination under finite overpotentials.\n    \"\"\"\n    # Global OCV-SOC nodes for spline interpolation\n    soc_nodes = np.array([0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0])\n    ocv_nodes = np.array([3.0, 3.25, 3.5, 3.6, 3.65, 3.7, 3.75, 3.85, 3.95, 4.1, 4.2])\n\n    # Task 1: Construct the smooth U(s) function using cubic spline interpolation\n    # Use 'not-a-knot' boundary conditions, which is the default for CubicSpline.\n    U_spline = CubicSpline(soc_nodes, ocv_nodes)\n\n    # Test suite and parameters\n    test_cases = [\n        # Case 1 (nominal impedance, slow constant discharge)\n        {\n            \"Q_Ah\": 2.0, \"s0\": 0.90, \"s_end\": 0.20, \"dt_s\": 10,\n            \"I_A\": 0.10, \"Rs_ohm\": 0.05, \"R1_ohm\": 0.015, \"tau_s\": 200\n        },\n        # Case 2 (aged impedance growth, same slow constant discharge)\n        {\n            \"Q_Ah\": 2.0, \"s0\": 0.90, \"s_end\": 0.20, \"dt_s\": 10,\n            \"I_A\": 0.10, \"Rs_ohm\": 0.08, \"R1_ohm\": 0.050, \"tau_s\": 600\n        },\n        # Case 3 (aged impedance, very small current, boundary condition)\n        {\n            \"Q_Ah\": 2.0, \"s0\": 0.90, \"s_end\": 0.20, \"dt_s\": 10,\n            \"I_A\": 0.005, \"Rs_ohm\": 0.08, \"R1_ohm\": 0.050, \"tau_s\": 600\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        Q = case[\"Q_Ah\"]\n        s_current = case[\"s0\"]\n        s_end = case[\"s_end\"]\n        dt = case[\"dt_s\"]\n        I = case[\"I_A\"]\n        Rs = case[\"Rs_ohm\"]\n        R1 = case[\"R1_ohm\"]\n        tau = case[\"tau_s\"]\n        \n        # Initialize state and storage lists\n        eta1_current = 0.0\n        \n        true_ocv_series = []\n        pseudo_ocv_series = []\n\n        # Task 3: Simulate slow-cycling discharge\n        # The simulation runs as long as the current SOC is at or above the end SOC.\n        while s_current >= s_end:\n            # Update SOC using Coulomb counting\n            s_next = s_current - (I * dt) / (Q * 3600.0)\n\n            # Task 2: Calculate overpotential using discrete-time model\n            # Update the dynamic overpotential state (RC element)\n            eta1_next = eta1_current * np.exp(-dt / tau) + I * R1 * (1 - np.exp(-dt / tau))\n            \n            # Total overpotential\n            eta_total_next = I * Rs + eta1_next\n            \n            # Get true OCV for the new SOC\n            U_true = U_spline(s_next)\n            \n            # Simulate measured terminal voltage\n            V_meas = U_true - eta_total_next\n            \n            # Pseudo-OCV is the naive measurement\n            U_pseudo = V_meas\n            \n            # Store results for this time step\n            true_ocv_series.append(U_true)\n            pseudo_ocv_series.append(U_pseudo)\n            \n            # Update state for the next iteration\n            s_current = s_next\n            eta1_current = eta1_next\n\n        # Convert lists to numpy arrays for calculation\n        true_ocv_arr = np.array(true_ocv_series)\n        pseudo_ocv_arr = np.array(pseudo_ocv_series)\n\n        # Task 5: Quantify errors\n        # Uncorrected errors\n        err_uncorr = pseudo_ocv_arr - true_ocv_arr\n        rmse_uncorr = np.sqrt(np.mean(err_uncorr**2))\n        max_abs_err_uncorr = np.max(np.abs(err_uncorr))\n\n        # Task 4: Corrected OCV and its errors\n        # In this ideal simulation, the correction is perfect.\n        # V_meas + eta_total = (U_true - eta_total) + eta_total = U_true\n        # So the corrected error is zero.\n        rmse_corr = 0.0\n        max_abs_err_corr = 0.0\n\n        case_results = [rmse_uncorr, rmse_corr, max_abs_err_uncorr, max_abs_err_corr]\n        all_results.append(case_results)\n\n    # Format the final output string as specified\n    output_str = f\"[{','.join(map(str, all_results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}