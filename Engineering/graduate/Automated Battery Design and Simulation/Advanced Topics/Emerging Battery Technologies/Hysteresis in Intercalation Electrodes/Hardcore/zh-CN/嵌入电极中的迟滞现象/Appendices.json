{
    "hands_on_practices": [
        {
            "introduction": "将理论与实验联系起来是科学研究的关键一步。这项练习将引导您从电化学基本原理出发，推导计算电压滞回所引起能量损失的积分表达式。然后，您将应用此公式来分析一个假设的实验测量循环，量化其能量损失，从而将抽象的滞回概念转化为一个可测量的物理量。",
            "id": "3919050",
            "problem": "考虑一个用于锂离子电池的多孔嵌入电极，该电极经历单电子反应，在恒电流条件下在两种锂化学计量分数之间循环。该分数由无量纲变量 $c \\in [0,1]$ 表示，其中 $c$ 代表每摩尔主体的锂摩尔数。假设该电极恰好含有一摩尔的主体化学式单位。在无穷小的嵌入过程中与外部电路交换的电功由基本电化学定义确定：电功增量等于电极电势乘以电荷增量，而电荷增量通过法拉第常数与 $c$ 的变化相关联。测量得到的电压-组成回线中的滞后现象源于嵌入主体中路径依赖的亚稳态，每个完整充放电循环耗散的能量是 $(V,c)$ 空间中沿闭合回路所做的净非保守功。\n\n任务 1（推导）：从电功和法拉第定律的基本定义出发，推导一个关于每个循环因滞后而耗散能量的通用表达式，该表达式应以沿测量电压-组成回线的闭路积分形式表示。您的推导必须明确地将化学计量 $c$ 的变化与转移的电荷联系起来，并将循环能量损失完全表示为沿充放电路径描绘的 $V(c)$ 的泛函。\n\n任务 2（针对测量回线的计算）：在温度 $T$ 下，同一电极的测量开路电压 (OCV)–组成回线对充电和放电路径参数化如下：\n- 充电路径：$V_{\\mathrm{ch}}(c) = 3.80 + 0.050 \\,\\ln\\!\\big(\\frac{1-c}{c}\\big) + 0.020\\,c + 0.030 + 0.010\\,c$。\n- 放电路径：$V_{\\mathrm{dis}}(c) = 3.80 + 0.050 \\,\\ln\\!\\big(\\frac{1-c}{c}\\big) + 0.020\\,c - 0.030 - 0.010\\,c$。\n该循环在充电时 $c$ 从 $c_1 = 0.20$ 变化到 $c_2 = 0.80$，放电时再返回到 $c_1$。取法拉第常数 $F = 96485 \\ \\mathrm{C\\,mol^{-1}}$。\n\n任务 3（与焦耳热和熵热的比较）：在恒定电流大小 $I = 0.20 \\ \\mathrm{A}$ 和内部欧姆电阻 $R = 0.050 \\ \\Omega$ 的恒电流循环下，计算每循环的总焦耳热。此外，使用单电子反应的平衡热力学，在温度 $T = 298 \\ \\mathrm{K}$ 时，每循环的可逆熵热由 OCV 沿实际（路径依赖）充放电轨迹的温度依赖性决定。两条路径上测得的温度系数为：\n- $\\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{ch}}(c) = -0.40 \\times 10^{-3} + 0.10 \\times 10^{-3}\\,c \\ \\mathrm{V\\,K^{-1}}$，\n- $\\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{dis}}(c) = -0.42 \\times 10^{-3} + 0.08 \\times 10^{-3}\\,c \\ \\mathrm{V\\,K^{-1}}$。\n使用连接可逆热与平衡电势温度导数的基本热力学关系，计算整个循环的净可逆熵热。\n\n以千焦耳每摩尔为单位，报告任务 2 中计算的每循环滞后能量损失。将您的答案四舍五入到四位有效数字，并以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示最终能量。",
            "solution": "该问题要求对多孔嵌入电极在恒电流循环过程中的能量耗散进行三部分分析。分析将首先验证问题陈述的有效性，然后执行所要求的推导和计算。\n\n### 问题验证\n问题陈述已经过评估，并被确定为**有效**。它在科学上基于已建立的电化学热力学原理，具有完整且一致的给定条件，是适定的，并以客观、正式的语言表述。没有科学缺陷、模糊之处或矛盾。所要求的任务可以使用所提供的信息解决。\n\n### 任务 1：滞后能量损失的推导\n因滞后而耗散的能量 $E_{\\mathrm{hys}}$ 是在一个闭合的充放电循环中对电化学电池所做的净非保守功。当无穷小电荷 $dQ$ 在电极电势 $V$ 下转移时，对系统做的无穷小电功 $dW_{\\mathrm{e}}$ 由下式给出：\n$$dW_{\\mathrm{e}} = V \\, dQ$$\n问题考虑的是锂嵌入的单电子反应 ($z=1$)。无量纲变量 $c$ 代表每摩尔主体材料中的锂摩尔数。由于题目说明电极恰好含有一摩尔主体，因此通过的总电荷 $Q$ 与锂化学计量 $c$ 的变化成正比。该关系由法拉第定律给出：\n$$Q = z c F$$\n对于单电子反应 ($z=1$) 和一摩爾主体，这简化为：\n$$Q = cF$$\n其中 $F$ 是法拉第常数。因此，电荷的无穷小变化 $dQ$ 与化学计量的无穷小变化 $dc$ 的关系为：\n$$dQ = F \\, dc$$\n将这个 $dQ$ 的表达式代入电功方程，得到化学计量发生无穷小变化时所做的功：\n$$dW_{\\mathrm{e}} = V(c) F \\, dc$$\n整个循环耗散的总能量是对系统做的净功，即 $dW_{\\mathrm{e}}$ 在该循环上的闭路积分：\n$$E_{\\mathrm{hys}} = W_{\\mathrm{net}} = \\oint dW_{\\mathrm{e}} = \\oint F V(c) \\, dc$$\n这个闭路积分可以写成沿充电路径（从 $c_1$ 到 $c_2$）的积分和沿放电路径（从 $c_2$ 到 $c_1$）的积分之和：\n$$E_{\\mathrm{hys}} = \\int_{c_1}^{c_2} F V_{\\mathrm{ch}}(c) \\, dc + \\int_{c_2}^{c_1} F V_{\\mathrm{dis}}(c) \\, dc$$\n通过反转第二个积分的积分限，我们引入一个负号：\n$$E_{\\mathrm{hys}} = F \\int_{c_1}^{c_2} V_{\\mathrm{ch}}(c) \\, dc - F \\int_{c_1}^{c_2} V_{\\mathrm{dis}}(c) \\, dc$$\n这合并为每循环滞后能量损失的最终通用表达式：\n$$E_{\\mathrm{hys}} = F \\int_{c_1}^{c_2} \\left[V_{\\mathrm{ch}}(c) - V_{\\mathrm{dis}}(c)\\right] \\, dc$$\n该表达式表示由于电极材料内部的热力学不可逆性而以热量形式耗散的能量，其数值由电压-组成回线所包围的面积捕获。\n\n### 任务 2：计算测量回线的滞后能量\n问题给出了充电和放电路径上电压 $V_{\\mathrm{ch}}(c)$ 和 $V_{\\mathrm{dis}}(c)$ 的参数化表达式。\n首先，我们简化给定的表达式：\n对于充电路径：\n$$V_{\\mathrm{ch}}(c) = 3.80 + 0.050 \\,\\ln\\!\\left(\\frac{1-c}{c}\\right) + 0.020\\,c + 0.030 + 0.010\\,c = 3.830 + 0.030\\,c + 0.050 \\,\\ln\\!\\left(\\frac{1-c}{c}\\right)$$\n对于放电路径：\n$$V_{\\mathrm{dis}}(c) = 3.80 + 0.050 \\,\\ln\\!\\left(\\frac{1-c}{c}\\right) + 0.020\\,c - 0.030 - 0.010\\,c = 3.770 + 0.010\\,c + 0.050 \\,\\ln\\!\\left(\\frac{1-c}{c}\\right)$$\n电势差 $V_{\\mathrm{ch}}(c) - V_{\\mathrm{dis}}(c)$ 是能量计算所需的被积函数。对数项相互抵消：\n$$V_{\\mathrm{ch}}(c) - V_{\\mathrm{dis}}(c) = \\left(3.830 + 0.030\\,c\\right) - \\left(3.770 + 0.010\\,c\\right) = 0.060 + 0.020\\,c$$\n现在，我们将此表达式从 $c_1 = 0.20$ 积分到 $c_2 = 0.80$：\n$$E_{\\mathrm{hys}} = F \\int_{0.20}^{0.80} (0.060 + 0.020\\,c) \\, dc$$\n执行积分：\n$$\\int_{0.20}^{0.80} (0.060 + 0.020\\,c) \\, dc = \\left[ 0.060\\,c + 0.020\\,\\frac{c^2}{2} \\right]_{0.20}^{0.80} = \\left[ 0.060\\,c + 0.010\\,c^2 \\right]_{0.20}^{0.80}$$\n在积分限处求值：\n$$= \\left( 0.060(0.80) + 0.010(0.80)^2 \\right) - \\left( 0.060(0.20) + 0.010(0.20)^2 \\right)$$\n$$= \\left( 0.048 + 0.010(0.64) \\right) - \\left( 0.012 + 0.010(0.04) \\right)$$\n$$= \\left( 0.048 + 0.0064 \\right) - \\left( 0.012 + 0.0004 \\right)$$\n$$= 0.0544 - 0.0124 = 0.0420$$\n积分的单位是伏特 ($V$)。总能量通过乘以法拉第常数 $F = 96485 \\, \\mathrm{C\\,mol^{-1}}$ 来求得：\n$$E_{\\mathrm{hys}} = (96485 \\, \\mathrm{C\\,mol^{-1}}) \\times (0.0420 \\, \\mathrm{V}) = 4052.37 \\, \\mathrm{J\\,mol^{-1}}$$\n问题要求结果以千焦耳每摩尔 ($\\mathrm{kJ\\,mol^{-1}}$) 为单位，并四舍五入到四位有效数字：\n$$E_{\\mathrm{hys}} = 4.05237 \\, \\mathrm{kJ\\,mol^{-1}} \\approx 4.052 \\, \\mathrm{kJ\\,mol^{-1}}$$\n\n### 任务 3：与焦耳热和熵热的比较\n为完整起见，我们计算提到的其他热量产生源。\n\n**焦耳热 ($Q_{\\mathrm{Joule}}$)**\n焦耳热由 $Q_{\\mathrm{Joule}} = I^2 R t_{\\mathrm{cycle}}$ 给出，其中 $t_{\\mathrm{cycle}}$ 是一个循环的总时间。在充电半周期（从 $c_1 = 0.20$ 到 $c_2 = 0.80$）中转移的电荷为 $\\Delta Q = \\Delta c \\cdot F = (0.80 - 0.20)F = 0.60F$。\n充电半周期的时间是 $t_{\\mathrm{ch}} = \\Delta Q / I = 0.60F / I$。总循环时间是 $t_{\\mathrm{cycle}} = t_{\\mathrm{ch}} + t_{\\mathrm{dis}} = 2 \\times t_{\\mathrm{ch}} = 1.20F / I$。\n代入给定值 $I = 0.20 \\, \\mathrm{A}$、$R = 0.050 \\, \\Omega$ 和 $F = 96485 \\, \\mathrm{C\\,mol^{-1}}$：\n$$t_{\\mathrm{cycle}} = \\frac{1.20 \\times 96485}{0.20} = 578910 \\, \\mathrm{s}$$\n$$Q_{\\mathrm{Joule}} = (0.20 \\, \\mathrm{A})^2 \\times (0.050 \\, \\Omega) \\times (578910 \\, \\mathrm{s}) = 0.04 \\times 0.050 \\times 578910 = 1157.82 \\, \\mathrm{J\\,mol^{-1}} = 1.158 \\, \\mathrm{kJ\\,mol^{-1}}$$\n\n**净可逆熵热 ($Q_{\\mathrm{rev}}$)**\n一条路径上产生的可逆热为 $Q_{\\mathrm{rev}} = \\int T dS$。使用电化学麦克斯韦关系式 $dS = F (\\partial U / \\partial T) dc$，循环的净可逆热为：\n$$Q_{\\mathrm{rev, cycle}} = F T \\oint \\left(\\frac{\\partial U}{\\partial T}\\right) dc = F T \\int_{c_1}^{c_2} \\left[ \\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{ch}}(c) - \\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{dis}}(c) \\right] dc$$\n温度系数的差异是：\n$$\\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{ch}} - \\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{dis}} = (-0.40 \\times 10^{-3} + 0.10 \\times 10^{-3}c) - (-0.42 \\times 10^{-3} + 0.08 \\times 10^{-3}c)$$\n$$= (0.02 \\times 10^{-3}) + (0.02 \\times 10^{-3})c = 0.02 \\times 10^{-3} (1+c) \\, \\mathrm{V\\,K^{-1}}$$\n将此差异从 $c_1 = 0.20$ 积分到 $c_2 = 0.80$：\n$$\\int_{0.20}^{0.80} 0.02 \\times 10^{-3} (1+c) \\, dc = 0.02 \\times 10^{-3} \\left[c + \\frac{c^2}{2}\\right]_{0.20}^{0.80}$$\n$$= 0.02 \\times 10^{-3} \\left[ \\left(0.80 + \\frac{0.80^2}{2}\\right) - \\left(0.20 + \\frac{0.20^2}{2}\\right) \\right]$$\n$$= 0.02 \\times 10^{-3} [ (0.80 + 0.32) - (0.20 + 0.02) ] = 0.02 \\times 10^{-3} [1.12 - 0.22] = 0.02 \\times 10^{-3} \\times 0.90 = 0.018 \\times 10^{-3}$$\n于是，当 $T=298 \\, \\mathrm{K}$ 时，净熵热为：\n$$Q_{\\mathrm{rev, cycle}} = (96485 \\, \\mathrm{C\\,mol^{-1}}) \\times (298 \\, \\mathrm{K}) \\times (0.018 \\times 10^{-3} \\, \\mathrm{V\\,K^{-1}}) = 517.58 \\, \\mathrm{J\\,mol^{-1}} = 0.518 \\, \\mathrm{kJ\\,mol^{-1}}$$\n在这个特定循环中，与焦耳热 ($1.158 \\, \\mathrm{kJ\\,mol^{-1}}$) 和净熵热 ($0.518 \\, \\mathrm{kJ\\,mol^{-1}}$) 相比，滞后损失 ($4.052 \\, \\mathrm{kJ\\,mol^{-1}}$) 是能量耗散的主要形式。最终要求的答案仅为滞后能量损失。",
            "answer": "$$\\boxed{4.052}$$"
        },
        {
            "introduction": "为了深入理解滞回现象的物理起源，构建能够分解其不同贡献的计算模型至关重要。本练习将指导您设计一个计算实验，该实验基于一个包含热力学非理想性和动力学过电位的综合模型。通过系统地改变成核能垒这一参数，您将能够量化其对总滞回面积的影响，这种方法是现代电池材料设计和模拟的核心技术之一。",
            "id": "3919046",
            "problem": "考虑一个在两个填充分数之间进行恒电流循环的嵌入电极。您的任务是设计并实现一个计算实验，通过改变成核势垒参数并测量由此产生的磁滞回线面积变化，来检验成核控制的磁滞假设。该实验必须基于电化学热力学和动力学的第一性原理和经过充分检验的模型。\n\n您将考虑一个包含以下要素的单均相颗粒模型：\n\n- 热力学由具有非理想相互作用的嵌入物质的正则溶液自由能描述。平衡化学势由下式给出\n$$\n\\mu_{\\mathrm{eq}}(c) = R T \\ln\\left(\\frac{c}{1-c}\\right) + \\Omega\\,(1 - 2 c),\n$$\n其中 $c \\in (0,1)$ 是位点占有率（无量纲），$R$ 是通用气体常数，$T$ 是绝对温度，$\\Omega$ 是正则溶液相互作用参数（单位为能量/摩尔）。相对于参比电极的平衡开路电压为\n$$\nV_{\\mathrm{eq}}(c) = -\\frac{\\mu_{\\mathrm{eq}}(c)}{F},\n$$\n其中 $F$ 是法拉第常数。\n\n- 动力学由对称的 Butler–Volmer (BV) 电荷转移描述。对于给定的施加电流密度 $I$（嵌锂/充电为正，脱锂/放电为负），BV 方程通过以下方式将电流密度与过电位 $\\eta$ 联系起来\n$$\nI = i_0(c)\\left[\\exp\\left(\\frac{\\alpha F \\eta}{R T}\\right) - \\exp\\left(-\\frac{(1-\\alpha) F \\eta}{R T}\\right)\\right],\n$$\n其中对称因子 $\\alpha = 1/2$，交换电流密度与浓度相关，\n$$\ni_0(c) = i_{0,\\mathrm{ref}} \\sqrt{c(1-c)}.\n$$\n在对称假设（$\\alpha = 1/2$）下，求解过电位：\n$$\n\\eta(I,c) = \\frac{R T}{F}\\,\\mathrm{arcsinh}\\left(\\frac{I}{2\\,i_0(c)}\\right).\n$$\n\n- 成核控制的磁滞是通过一个恒定的成核势垒过电位参数 $\\gamma$ 引入的，必须根据相变方向克服相应符号的势垒。恒电流操作下测得的电压建模为\n$$\nV_{\\mathrm{meas}}(c; I, \\gamma) = V_{\\mathrm{eq}}(c) + \\eta(I,c) + \\mathrm{sgn}(I)\\,\\gamma,\n$$\n其中 $\\mathrm{sgn}(I)$ 是符号函数。\n\n- 成分轨迹由恒定的施加电流密度 $I$ 和归一化容量控制，使得 $c$ 随时间线性变化；为了解决此问题，您应该直接计算电压作为 $c$ 的函数，而不是对时间进行积分。\n\n您的任务：\n\n1. 从上述基础出发，实现一个数值程序来计算在一个完整循环中电压-成分平面上的磁滞回线面积。将循环定义为在恒定 $I0$ 下从 $c_{\\min}$ 充电到 $c_{\\max}$，然后在电流 $I0$ 下从 $c_{\\max}$ 放电回到 $c_{\\min}$。磁滞回线面积 $\\mathcal{A}$ 定义为闭环积分\n$$\n\\mathcal{A} = \\oint V_{\\mathrm{meas}}(c; I, \\gamma)\\, dc = \\int_{c_{\\min}}^{c_{\\max}} V_{\\mathrm{meas}}(c; +|I|, \\gamma)\\, dc \\;-\\; \\int_{c_{\\min}}^{c_{\\max}} V_{\\mathrm{meas}}(c; -|I|, \\gamma)\\, dc,\n$$\n其单位为伏特（因为 $c$ 是无量纲的）。使用足够精细的 $c$ 离散化来数值计算这些积分。\n\n2. 系统地改变成核势垒参数 $\\gamma$ 并测量所得的 $\\mathcal{A}(\\gamma)$，以验证成核控制的磁滞假设。使用物理上合理的参数：\n   - 通用气体常数 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，\n   - 法拉第常数 $F = 96485\\,\\mathrm{C\\,mol^{-1}}$，\n   - 绝对温度 $T = 298\\,\\mathrm{K}$，\n   - 正则溶液参数 $\\Omega = 4000\\,\\mathrm{J\\,mol^{-1}}$，\n   - 交换电流密度参考值 $i_{0,\\mathrm{ref}} = 1.0\\,\\mathrm{A\\,m^{-2}}$，\n   - 施加电流密度大小 $|I| = 0.01\\,\\mathrm{A\\,m^{-2}}$，\n   - 成分下限和上限 $c_{\\min} = 0.05$ 和 $c_{\\max} = 0.95$。\n\n3. 在 $[c_{\\min}, c_{\\max}]$ 区间内使用至少包含 $N = 500$ 个点的均匀网格进行数值积分。\n\n4. 测试组。对以下成核势垒值（单位为伏特）计算 $\\mathcal{A}(\\gamma)$：\n   - $\\gamma = 0.0$，\n   - $\\gamma = 0.01$，\n   - $\\gamma = 0.03$，\n   - $\\gamma = 0.05$，\n   - $\\gamma = 0.10$。\n   选择这些案例是为了探测：\n   - 无成核势垒的基准情况，\n   - 小势垒，\n   - 中等势垒，\n   - 较大势垒。\n\n5. 数值输出要求：\n   - 对于每个测试案例，以伏特为单位表示磁滞回线面积 $\\mathcal{A}$。\n   - 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，\"[result1,result2,...]\"）。\n   - 每个结果必须是一个浮点数。您可以计算到完整的双精度；除了 Python 浮点数的标准打印所产生的舍入外，不需要额外的舍入。\n\n通过保持所有参数如指定，确保科学真实性，并确保您的算法是从所述的热力学和动力学基础推导出来的，没有引入这些基础不支持的简化公式。该问题是完全自洽的，必须纯粹通过在现代编程语言中进行算法实现来解决，无需外部数据。最终答案必须以伏特（$\\mathcal{A}$ 的单位）为单位，表示为浮点数。",
            "solution": "问题陈述已经过仔细审查，并被确定为**有效**。它在科学上基于既定的电化学原理，定量上是适定的、客观的且内部一致的。提供了解出唯一解所需的所有数据和定义。\n\n任务是计算嵌入电极在恒电流循环中的磁滞回线面积 $\\mathcal{A}$，并研究其对成核势垒参数 $\\gamma$ 的依赖性。解决方案首先从给定的定义中推导出一个更直接的 $\\mathcal{A}$ 解析表达式，然后实现其数值评估。\n\n**1. 磁滞回线面積的解析公式**\n\n磁滞回线面积 $\\mathcal{A}$ 定义为电压对无量纲成分 $c$ 的闭环积分：\n$$\n\\mathcal{A} = \\oint V_{\\mathrm{meas}}(c; I, \\gamma)\\, dc\n$$\n这个循环包括一个从 $c_{\\min}$ 到 $c_{\\max}$、电流为 $I = +|I|$ 的充电过程，以及一个从 $c_{\\max}$ 回到 $c_{\\min}$、电流为 $I = -|I|$ 的放电过程。该积分可表示为：\n$$\n\\mathcal{A} = \\int_{c_{\\min}}^{c_{\\max}} V_{\\mathrm{meas}}(c; +|I|, \\gamma)\\, dc \\;-\\; \\int_{c_{\\min}}^{c_{\\max}} V_{\\mathrm{meas}}(c; -|I|, \\gamma)\\, dc\n$$\n测得的电压 $V_{\\mathrm{meas}}$ 由下式给出：\n$$\nV_{\\mathrm{meas}}(c; I, \\gamma) = V_{\\mathrm{eq}}(c) + \\eta(I,c) + \\mathrm{sgn}(I)\\,\\gamma\n$$\n其中 $V_{\\mathrm{eq}}(c)$ 是平衡电压，$\\eta(I,c)$ 是动力学过电位，$\\gamma$ 是成核过电位。\n\n让我们将 $V_{\\mathrm{meas}}$ 的表达式代入 $\\mathcal{A}$ 的公式中。\n对于充电路径（$I = +|I|$），$\\mathrm{sgn}(I) = +1$：\n$$\nV_{\\mathrm{meas}}(c; +|I|, \\gamma) = V_{\\mathrm{eq}}(c) + \\eta(+|I|,c) + \\gamma\n$$\n对于放电路径（$I = -|I|$），$\\mathrm{sgn}(I) = -1$：\n$$\nV_{\\mathrm{meas}}(c; -|I|, \\gamma) = V_{\\mathrm{eq}}(c) + \\eta(-|I|,c) - \\gamma\n$$\n在给定成分 $c$ 下，充电和放电曲线之间的电压差为：\n$$\n\\Delta V(c) = V_{\\mathrm{meas}}(c; +|I|, \\gamma) - V_{\\mathrm{meas}}(c; -|I|, \\gamma)\n$$\n$$\n\\Delta V(c) = [V_{\\mathrm{eq}}(c) + \\eta(+|I|,c) + \\gamma] - [V_{\\mathrm{eq}}(c) + \\eta(-|I|,c) - \\gamma]\n$$\n平衡电位 $V_{\\mathrm{eq}}(c)$ 被抵消：\n$$\n\\Delta V(c) = \\eta(+|I|,c) - \\eta(-|I|,c) + 2\\gamma\n$$\n过电位 $\\eta$ 由对称 Butler-Volmer 方程的解给出：\n$$\n\\eta(I,c) = \\frac{R T}{F}\\,\\mathrm{arcsinh}\\left(\\frac{I}{2\\,i_0(c)}\\right)\n$$\n由于 $\\mathrm{arcsinh}(x)$ 是一个奇函数，即 $\\mathrm{arcsinh}(-x) = -\\mathrm{arcsinh}(x)$，我们有：\n$$\n\\eta(-|I|,c) = \\frac{R T}{F}\\,\\mathrm{arcsinh}\\left(\\frac{-|I|}{2\\,i_0(c)}\\right) = -\\frac{R T}{F}\\,\\mathrm{arcsinh}\\left(\\frac{|I|}{2\\,i_0(c)}\\right) = -\\eta(+|I|,c)\n$$\n将此代入 $\\Delta V(c)$ 的表达式中：\n$$\n\\Delta V(c) = \\eta(+|I|,c) - (-\\eta(+|I|,c)) + 2\\gamma = 2\\eta(+|I|,c) + 2\\gamma\n$$\n磁滞回线面积 $\\mathcal{A}$ 是该电压差在成分范围内的积分：\n$$\n\\mathcal{A}(\\gamma) = \\int_{c_{\\min}}^{c_{\\max}} \\Delta V(c) \\,dc = \\int_{c_{\\min}}^{c_{\\max}} \\left[ 2\\eta(+|I|,c) + 2\\gamma \\right] dc\n$$\n这可以分为两项：动力学贡献和成核贡献。\n$$\n\\mathcal{A}(\\gamma) = 2 \\int_{c_{\\min}}^{c_{\\max}} \\eta(+|I|,c)\\,dc + 2 \\int_{c_{\\min}}^{c_{\\max}} \\gamma\\,dc\n$$\n第二个积分是平凡的：\n$$\n2 \\int_{c_{\\min}}^{c_{\\max}} \\gamma\\,dc = 2\\gamma (c_{\\max} - c_{\\min})\n$$\n第一个积分代表来自（Butler-Volmer）动力学磁滞的面积，必须进行数值计算。磁滞回线面积的完整表达式为：\n$$\n\\mathcal{A}(\\gamma) = \\frac{2RT}{F} \\int_{c_{\\min}}^{c_{\\max}} \\mathrm{arcsinh}\\left(\\frac{|I|}{2\\,i_{0,\\mathrm{ref}} \\sqrt{c(1-c)}}\\right)\\,dc + 2\\gamma (c_{\\max} - c_{\\min})\n$$\n该公式揭示了总磁滞回线面积 $\\mathcal{A}$ 与成核势垒 $\\gamma$ 之间的线性关系，这是该模型假设的直接结果。\n\n**2. 算法设计与数值积分**\n\n数值程序将使用指定的参数来评估 $\\mathcal{A}(\\gamma)$ 的表达式。\n\n- **参数**：\n  - 通用气体常数：$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - 法拉第常数：$F = 96485\\,\\mathrm{C\\,mol^{-1}}$\n  - 绝对温度：$T = 298\\,\\mathrm{K}$\n  - 正则溶液参数：$\\Omega = 4000\\,\\mathrm{J\\,mol^{-1}}$（注意：计算 $\\mathcal{A}$ 不需要 $\\Omega$，因为 $V_{\\mathrm{eq}}$ 被抵消了）。\n  - 交换电流密度参考值：$i_{0,\\mathrm{ref}} = 1.0\\,\\mathrm{A\\,m^{-2}}$\n  - 施加电流密度大小：$|I| = 0.01\\,\\mathrm{A\\,m^{-2}}$\n  - 成分下限和上限：$c_{\\min} = 0.05$ 和 $c_{\\max} = 0.95$\n\n- **数值方法**：\n  1. 将在区间 $[c_{\\min}, c_{\\max}]$ 上创建一个包含 $N=500$ 个点的成分 $c$ 的均匀网格。\n  2. 动力学贡献的被积函数 $f(c) = 2\\eta(+|I|,c)$ 将在该网格的每个点上进行评估。\n  3. $f(c)$ 的积分将使用梯形法则计算，该方法对于精细离散化的平滑函数可提供足够的精度。\n  4. 成核贡献 $2\\gamma(c_{\\max}-c_{\\min})$ 将被直接计算。\n  5. 总磁滞回线面积 $\\mathcal{A}$ 是这两部分贡献之和。\n\n- **测试组执行**：\n  对于测试组中提供的每个 $\\gamma$ 值，将重复上述过程：\n  - $\\gamma \\in \\{0.0, 0.01, 0.03, 0.05, 0.10\\}$ 伏特。\n\n最终输出将是计算出的 $\\mathcal{A}(\\gamma)$ 值的列表，展示成核势垒对总磁滯的影响。$\\mathcal{A}$ 对 $\\gamma$ 的线性依赖性可作为在该模型框架内对成核控制磁滞假设的直接检验。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ... # Scipy is available but not required for this solution.\n\ndef solve():\n    \"\"\"\n    Computes hysteresis area for an intercalation electrode model\n    based on thermodynamic and kinetic principles.\n    \"\"\"\n    # Define physical constants and problem parameters.\n    R = 8.314  # J mol^-1 K^-1\n    F = 96485.0  # C mol^-1\n    T = 298.0  # K\n    i0_ref = 1.0  # A m^-2\n    I_abs = 0.01  # A m^-2\n    c_min = 0.05\n    c_max = 0.95\n    N = 500  # Number of points for numerical integration\n\n    # Define the test cases for the nucleation barrier gamma (in volts).\n    test_cases = [0.0, 0.01, 0.03, 0.05, 0.10]\n\n    results = []\n\n    # Create a uniform grid for the composition 'c'.\n    # The endpoints c_min and c_max are included.\n    c_grid = np.linspace(c_min, c_max, N)\n\n    # Calculate the kinetic contribution to the hysteresis area.\n    # This part of the calculation is independent of gamma and can be pre-computed.\n    \n    # Calculate exchange current density i_0(c) over the grid.\n    # A small epsilon is added to avoid division by zero at the theoretical\n    # limits c=0 and c=1, though the problem's c_grid is safely away from them.\n    eps = 1e-12\n    i0_c = i0_ref * np.sqrt(c_grid * (1.0 - c_grid) + eps)\n\n    # The argument for the arcsinh function.\n    arcsinh_arg = I_abs / (2.0 * i0_c)\n\n    # Calculate the overpotential for the positive current (+|I|) over the grid.\n    # This corresponds to the charging process.\n    eta_plus = (R * T / F) * np.arcsinh(arcsinh_arg)\n\n    # The kinetic contribution to the area is the integral of 2 * eta_plus.\n    # We use the trapezoidal rule for numerical integration.\n    kinetic_area = np.trapz(2.0 * eta_plus, c_grid)\n\n    for gamma in test_cases:\n        # The nucleation contribution to the hysteresis area is analytical.\n        # It is 2 * gamma * (c_max - c_min).\n        nucleation_area = 2.0 * gamma * (c_max - c_min)\n        \n        # The total hysteresis area is the sum of the kinetic and nucleation parts.\n        total_area = kinetic_area + nucleation_area\n        \n        results.append(total_area)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "电压滞回曲线的形状，尤其是其路径依赖性，揭示了电极材料内部微观结构的演化信息。本练习将通过一个核-壳生长模型来探索相变电极中滞回的复杂性，模拟充放电过程中相界面的移动。您将通过计算发现，当相变过程在完全完成前被反转时，会形成所谓的“次级循环”，这直接将宏观电化学行为与微观物理机制联系起来。",
            "id": "3919083",
            "problem": "考虑一个在恒流操作下经历低锂相和高锂相之间两相转变的单个球形嵌入颗粒。设颗粒半径为 $R$（单位：$\\mathrm{m}$）。假设两相之间存在一个清晰的界面，其中厚度为 $s(t)$（单位：$\\mathrm{m}$）的高锂壳层在锂化过程中从颗粒表面向内生长，在脱锂过程中则后退。令 $c_{\\alpha}$（单位：$\\mathrm{mol}/\\mathrm{m}^{3}$）表示高锂相中的锂浓度，$c_{\\beta}$（单位：$\\mathrm{mol}/\\mathrm{m}^{3}$）表示低锂相中的锂浓度，两者在互溶间隙内均被视作常数，并定义 $\\Delta c = c_{\\alpha} - c_{\\beta}  0$。锂的表面摩尔通量为 $j$（单位：$\\mathrm{mol}/\\mathrm{m}^{2}\\cdot\\mathrm{s}$），锂化时 $j  0$，脱锂时 $j  0$，且其在颗粒表面上空间均匀。\n\n从球体中移动相界面的基本质量守恒和球形几何的定义出发，推导界面半径 $r_{i}(t)$（单位：$\\mathrm{m}$）的演化方程，其中 $r_{i}(t) = R - s(t)$。做出物理上合理的假设，即进入颗粒的总锂摩尔速率等于移动界面处低锂相转变为高锂相所需的摩尔速率。强制要求界面速度由此平衡决定并取决于界面面积。不要引入任何关于壳层生长的经验性简化公式；推导必须从质量守恒、球形几何以及恒定的浓度 $c_{\\alpha}$ 和 $c_{\\beta}$ 出发。\n\n在得到控制方程后，对其进行积分，以求得在恒定锂化通量 $j  0$ 下和反向后在恒定脱锂通量 $j  0$ 下的 $s(t)$，两者均从给定的初始壳层厚度 $s(0)$ 开始。将相变视为完全共格的，因此唯一的几何限制是球体半径 $R$。提供允许计算每个恒定通量段内 $s(t)$ 的显式闭合形式表达式。\n\n为了将相生长与电压滞后联系起来，采用如下最小但物理上一致的电压模型：\n- 开路电压（OCV）平台 $U_{0}$（单位：$\\mathrm{V}$）在两相区内是恒定的。\n- 共格应变会改变局部化学势，其变化与壳层厚度成正比。将其建模为电压偏移 $\\pm \\gamma \\, s/R$（单位：$\\mathrm{V}$），其中 $\\gamma  0$（单位：$\\mathrm{V}$）是一个材料参数；锂化时使用 $+$ 号，脱锂时使用 $-$ 号。\n- 界面反应过电势由 Butler–Volmer 动力学的线性化极限决定。对于每个嵌入物一个电子（$n = 1$），电荷转移电流密度为 $i_{\\mathrm{elec}} = n F j$（单位：$\\mathrm{A}/\\mathrm{m}^{2}$），其中 $F$ 是法拉第常数（单位：$\\mathrm{C}/\\mathrm{mol}$）。对于小过电势，线性化的 Butler–Volmer 关系得出 $\\eta \\approx i_{\\mathrm{elec}} \\, R_{g} T / (i_{0} F) = j \\, R_{g} T / i_{0}$（单位：$\\mathrm{V}$），其中 $R_{g}$ 是普适气体常数（单位：$\\mathrm{J}/\\mathrm{mol}\\cdot\\mathrm{K}$），$T$ 是温度（单位：$\\mathrm{K}$），$i_{0}$ 是交换电流密度（单位：$\\mathrm{A}/\\mathrm{m}^{2}$）。锂化时 $\\eta$ 取 $+$ 号，脱锂时取 $-$ 号。\n\n在此模型下，锂化过程中的瞬时电压为 $V_{\\mathrm{L}}(t) = U_{0} + \\gamma \\, s(t)/R + j \\, R_{g} T / i_{0}$，脱锂过程中的瞬时电压为 $V_{\\mathrm{D}}(t) = U_{0} - \\gamma \\, s(t)/R - |j| \\, R_{g} T / i_{0}$。\n\n将高锂相的体积分数 $f_{\\alpha}(t)$ 定义为其体积与颗粒体积之比。在界面半径为 $r_{i}(t)$ 的核-壳几何结构下，该分数为 $f_{\\alpha}(t) = 1 - \\left( r_{i}(t) / R \\right)^{3}$。请注意，在两相区内，$f_{\\alpha}(t)$ 与单个颗粒的荷电状态分数相同。\n\n你必须在单个颗粒上实现一个离散的三阶段恒流方案：\n- 阶段 A（锂化）：从 $s(0) = 0$ 开始，施加恒定通量 $j_{1}  0$ 持续时间 $t_{1}$（单位：$\\mathrm{s}$），计算 $s_{1} = s(t_{1})$。\n- 阶段 B（脱锂）：反向施加恒定通量 $j_{2}  0$ 持续时间 $t_{2}$（单位：$\\mathrm{s}$），计算 $s_{2} = s(t_{1} + t_{2})$；如果 $s_{2} \\le 0$，则壳层被完全移除。\n- 阶段 C（再次锂化）：施加恒定通量 $j_{3}  0$ 持续时间 $t_{3}$（单位：$\\mathrm{s}$），计算最终壳层厚度 $s_{3} = s(t_{1} + t_{2} + t_{3})$。\n\n为了量化由不完全壳层移除引起的滞后次循环，请在阶段 C 结束时，评估在相同的荷电状态分数 $f_{\\alpha}(t_{1} + t_{2} + t_{3})$ 下，锂化分支和脱锂分支之间的电压差。由于 $f_{\\alpha}$ 通过几何结构唯一确定 $s$，因此阶段 C 结束时的此次循环宽度为\n$$\n\\Delta V_{\\mathrm{minor}} = V_{\\mathrm{L}}\\big(s_{3}, j_{3}\\big) - V_{\\mathrm{D}}\\big(s_{3}, j_{2}\\big) = 2 \\gamma \\frac{s_{3}}{R} + \\frac{R_{g} T}{i_{0}} \\left( j_{3} + |j_{2}| \\right).\n$$\n\n你的程序必须：\n- 为每个恒定通量段实现 $s(t)$ 的闭合形式解。\n- 根据 $s(t)$ 和 $R$ 计算 $f_{\\alpha}(t)$。\n- 按规定计算 $V_{\\mathrm{L}}$ 和 $V_{\\mathrm{D}}$，然后计算 $\\Delta V_{\\mathrm{minor}}$。\n- 确定在阶段 B 中壳层是否被完全移除，即输出一个布尔值，指示 $s_{2} \\le 0$ 是否成立。\n\n将壳层厚度以 $\\mathrm{m}$ 为单位、电压以 $\\mathrm{V}$ 为单位表示，两者均为浮点数。\n\n测试套件。使用以下四组参数集来检验正常操作、完全移除、提早反向和反向电流为零的边缘情况。对于所有情况，取 $U_{0} = 3.4$（单位：$\\mathrm{V}$），$\\gamma = 0.05$（单位：$\\mathrm{V}$），$i_{0} = 100$（单位：$\\mathrm{A}/\\mathrm{m}^{2}$），$T = 298$（单位：$\\mathrm{K}$），$c_{\\alpha} - c_{\\beta} = \\Delta c = 3 \\times 10^{4}$（单位：$\\mathrm{mol}/\\mathrm{m}^{3}$），以及 $R = 10^{-6}$（单位：$\\mathrm{m}$）。每种情况指定 $(j_{1}, t_{1}, j_{2}, t_{2}, j_{3}, t_{3})$，其中 $j$ 的单位是 $\\mathrm{mol}/\\mathrm{m}^{2}\\cdot\\mathrm{s}$，$t$ 的单位是 $\\mathrm{s}$：\n- 情况 1（理想路径，不完全移除）：$(j_{1} = 2 \\times 10^{-6}, \\, t_{1} = 1800, \\, j_{2} = -1 \\times 10^{-6}, \\, t_{2} = 900, \\, j_{3} = 2 \\times 10^{-6}, \\, t_{3} = 600)$。\n- 情况 2（边界，阶段 B 期间完全移除）：$(j_{1} = 2 \\times 10^{-6}, \\, t_{1} = 1800, \\, j_{2} = -1 \\times 10^{-6}, \\, t_{2} = 3600, \\, j_{3} = 2 \\times 10^{-6}, \\, t_{3} = 600)$。\n- 情况 3（提早反向，小壳层）：$(j_{1} = 2 \\times 10^{-6}, \\, t_{1} = 60, \\, j_{2} = -1 \\times 10^{-6}, \\, t_{2} = 30, \\, j_{3} = 2 \\times 10^{-6}, \\, t_{3} = 90)$。\n- 情况 4（边缘情况，反向电流为零）：$(j_{1} = 2 \\times 10^{-6}, \\, t_{1} = 1200, \\, j_{2} = 0, \\, t_{2} = 600, \\, j_{3} = 2 \\times 10^{-6}, \\, t_{3} = 600)$。\n\n最终输出规范。你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。每个结果（针对每种情况）是一个长度为 3 的列表：$[s_{3}, \\Delta V_{\\mathrm{minor}}, \\mathrm{full\\_removal\\_StageB}]$，其中 $s_{3}$ 的单位是 $\\mathrm{m}$，$\\Delta V_{\\mathrm{minor}}$ 的单位是 $\\mathrm{V}$，$\\mathrm{full\\_removal\\_StageB}$ 是一个布尔值。例如，总输出应类似于 $[[s_{3}^{(1)}, \\Delta V_{\\mathrm{minor}}^{(1)}, \\mathrm{bool}^{(1)}],[s_{3}^{(2)}, \\Delta V_{\\mathrm{minor}}^{(2)}, \\mathrm{bool}^{(2)}],[s_{3}^{(3)}, \\Delta V_{\\mathrm{minor}}^{(3)}, \\mathrm{bool}^{(3)}],[s_{3}^{(4)}, \\Delta V_{\\mathrm{minor}}^{(4)}, \\mathrm{bool}^{(4)}]]$。",
            "solution": "该问题是有效的，因为它在科学上基于电化学和材料科学的既定原理，问题设定良好，具有明确的目标和充足的数据，并以客观、正式的语言表述。我们将着手解决它，首先推导相界面运动的控制方程，然后对其进行积分以获得壳层厚度的闭合形式解，最后将此解应用于指定的三阶段恒流方案。\n\n**第一部分：界面演化方程的推导**\n\n该模型考虑一个半径为 $R$ 的球形颗粒，在半径 $r_i(t)$ 处有一个清晰的界面，将外部的高锂（$\\alpha$）相与内部的低锂（$\\beta$）相分开。每个相内的浓度是恒定的，分别为 $c_{\\alpha}$ 和 $c_{\\beta}$，且 $\\Delta c = c_{\\alpha} - c_{\\beta}  0$。\n\n核心的物理假设是质量守恒：通过颗粒表面进入或离开颗粒的总锂摩尔速率必须等于移动相界面消耗或释放锂的速率。\n\n进入颗粒的总锂摩尔速率由均匀的表面摩尔通量 $j$（单位：$\\mathrm{mol}/\\mathrm{m}^2\\cdot\\mathrm{s}$）与颗粒表面积 $A_p = 4\\pi R^2$ 的乘积给出。\n$$\n\\text{总摩尔速率} = j \\cdot (4\\pi R^2) \\quad [\\mathrm{mol/s}]\n$$\n正的 $j$ 对应于锂化（流入），负的 $j$ 对应于脱锂（流出）。\n\n相界面是一个面积为 $A_i(t) = 4\\pi r_i(t)^2$ 的球面。在时间间隔 $dt$ 内，界面移动了径向距离 $dr_i$。界面扫过的体积为 $dV = A_i(t) \\cdot |dr_i| = 4\\pi r_i(t)^2 |dr_i|$。要将此体积从 $\\beta$ 相转变为 $\\alpha$ 相，所需的锂量为 $dN = \\Delta c \\cdot dV$。因此，界面处锂消耗的摩尔速率为：\n$$\n\\frac{dN}{dt} = \\Delta c \\frac{dV}{dt} = \\Delta c \\cdot 4\\pi r_i(t)^2 \\left| \\frac{dr_i}{dt} \\right|\n$$\n在锂化过程中（$j0$），界面向内移动，因此 $r_i$ 减小，且 $dr_i/dt  0$。于是，$|dr_i/dt| = -dr_i/dt$。将流入速率与消耗速率相等：\n$$\nj \\cdot (4\\pi R^2) = \\Delta c \\cdot 4\\pi r_i(t)^2 \\left( -\\frac{dr_i}{dt} \\right)\n$$\n$$\n\\frac{dr_i}{dt} = -\\frac{j R^2}{\\Delta c \\cdot r_i(t)^2}\n$$\n在脱锂过程中（$j0$），界面向外移动，因此 $r_i$ 增大，且 $dr_i/dt  0$。离开颗粒的锂速率 $|j| \\cdot 4\\pi R^2$ 必须由 $\\alpha$ 相到 $\\beta$ 相的转变来提供。\n$$\n|j| \\cdot (4\\pi R^2) = \\Delta c \\cdot 4\\pi r_i(t)^2 \\left( \\frac{dr_i}{dt} \\right)\n$$\n由于 $j  0$，我们有 $|j| = -j$。代入此式可得：\n$$\n-j \\cdot (4\\pi R^2) = \\Delta c \\cdot 4\\pi r_i(t)^2 \\left( \\frac{dr_i}{dt} \\right) \\implies \\frac{dr_i}{dt} = -\\frac{j R^2}{\\Delta c \\cdot r_i(t)^2}\n$$\n这证实了对于锂化和脱锂，界面半径 $r_i(t)$ 的演化都遵循相同的常微分方程（ODE）。\n\n**第二部分：恒定通量段的积分**\n\n推导出的 ODE 是可分离的：\n$$\nr_i(t)^2 \\, dr_i = -\\frac{j R^2}{\\Delta c} \\, dt\n$$\n我们在时间间隔 $\\Delta t = t_k - t_{k-1}$ 上对该方程进行积分，在此期间通量 $j_k$ 是恒定的。设初始界面半径为 $r_{i, k-1}$，最终半径为 $r_{i, k}$。\n$$\n\\int_{r_{i, k-1}}^{r_{i, k}} r^2 \\, dr = \\int_{t_{k-1}}^{t_k} -\\frac{j_k R^2}{\\Delta c} \\, d\\tau\n$$\n$$\n\\left[ \\frac{r^3}{3} \\right]_{r_{i, k-1}}^{r_{i, k}} = -\\frac{j_k R^2 \\Delta t_k}{\\Delta c}\n$$\n$$\nr_{i, k}^3 - r_{i, k-1}^3 = -\\frac{3 j_k R^2 \\Delta t_k}{\\Delta c}\n$$\n这给出了界面半径立方的演化。用壳层厚度 $s(t) = R - r_i(t)$ 表示，我们有 $r_i(t) = R - s(t)$。设 $s_{k-1}$ 为该步骤的初始壳层厚度，$s_k$ 为最终壳层厚度。\n$$\n(R - s_k)^3 = (R - s_{k-1})^3 - \\frac{3 j_k R^2 \\Delta t_k}{\\Delta c}\n$$\n壳层厚度必须受到物理约束，$0 \\le s(t) \\le R$，这意味着 $R \\ge r_i(t) \\ge 0$。这意味着 $r_i(t)^3$ 必须在 $[0, R^3]$ 范围内。算法必须强制执行这些边界。\n\n**第三部分：方案的算法实现**\n\n我们可以定义一个常数 $K = \\frac{3 R^2}{\\Delta c}$。对于从 $r_{i, \\text{start}}^3$ 开始，通量为 $j$、持续时间为 $\\Delta t$ 的一个步骤，界面半径立方的更新规则是：\n$$\nr_{i, \\text{end, raw}}^3 = r_{i, \\text{start}}^3 - K \\cdot j \\cdot \\Delta t\n$$\n为了强制执行物理边界，我们对结果进行截断：\n$$\nr_{i, \\text{end}}^3 = \\max(0, \\min(R^3, r_{i, \\text{end, raw}}^3))\n$$\n该步骤的最终壳层厚度为 $s_{\\text{end}} = R - (r_{i, \\text{end}}^3)^{1/3}$。\n\n三阶段方案的实现如下：\n1.  **阶段 A（锂化）：** 初始状态为 $s(0)=0$，所以 $r_{i,0}^3 = R^3$。施加通量 $j_1$ 持续时间 $t_1$。\n    $r_{i,1}^3 = \\max(0, \\min(R^3, R^3 - K j_1 t_1))$。最终的壳层厚度为 $s_1 = R - (r_{i,1}^3)^{1/3}$。\n2.  **阶段 B（脱锂）：** 从 $r_{i,1}^3$ 开始。施加通量 $j_2$ 持续时间 $t_2$。\n    $r_{i,2, \\text{raw}}^3 = r_{i,1}^3 - K j_2 t_2$。我们检查壳层是否完全移除：如果 $r_{i,2, \\text{raw}}^3 \\ge R^3$，则 `full_removal_StageB` 为真。\n    $r_{i,2}^3 = \\max(0, \\min(R^3, r_{i,2, \\text{raw}}^3))$。最终的壳层厚度为 $s_2 = R - (r_{i,2}^3)^{1/3}$。\n3.  **阶段 C（再次锂化）：** 从 $r_{i,2}^3$ 开始。施加通量 $j_3$ 持续时间 $t_3$。\n    $r_{i,3}^3 = \\max(0, \\min(R^3, r_{i,2}^3 - K j_3 t_3))$。最终的壳层厚度为 $s_3 = R - (r_{i,3}^3)^{1/3}$。\n\n**第四部分：最终计算**\n\n计算出最终壳层厚度 $s_3$ 后，使用提供的公式计算次循环电压宽度 $\\Delta V_{\\mathrm{minor}}$：\n$$\n\\Delta V_{\\mathrm{minor}} = V_{\\mathrm{L}}(s_{3}, j_{3}) - V_{\\mathrm{D}}(s_{3}, j_{2}) = 2 \\gamma \\frac{s_{3}}{R} + \\frac{R_{g} T}{i_{0}} (j_{3} + |j_{2}|)\n$$\n其中 $R_g$ 是普适气体常数（$8.314462618 \\, \\mathrm{J}/\\mathrm{mol}\\cdot\\mathrm{K}$），$T$ 是开尔文温度。程序将为每个测试用例报告三元组 $[s_3, \\Delta V_{\\mathrm{minor}}, \\text{full\\_removal\\_StageB}]$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating shell thickness and hysteresis voltage\n    for a three-stage galvanostatic protocol on a phase-transforming particle.\n    \"\"\"\n    \n    # Universal constants and parameters for all test cases\n    R = 1.0e-6  # Particle radius [m]\n    DELTA_C = 3.0e4  # Concentration difference [mol/m^3]\n    GAMMA = 0.05  # Strain-voltage coupling parameter [V]\n    I0 = 100.0  # Exchange current density [A/m^2]\n    T = 298.0  # Temperature [K]\n    RG = 8.314462618  # Universal gas constant [J/(mol*K)]\n\n    # Pre-calculated constants for efficiency\n    R_CUBED = R**3\n    K_CONST = 3 * R**2 / DELTA_C\n    OHMIC_PREFACTOR = RG * T / I0\n\n    test_cases = [\n        # (j1, t1, j2, t2, j3, t3) with j in [mol/m^2*s] and t in [s]\n        (2.0e-6, 1800.0, -1.0e-6, 900.0, 2.0e-6, 600.0),   # Case 1: Happy path\n        (2.0e-6, 1800.0, -1.0e-6, 3600.0, 2.0e-6, 600.0),  # Case 2: Full removal\n        (2.0e-6, 60.0, -1.0e-6, 30.0, 2.0e-6, 90.0),      # Case 3: Early reversal\n        (2.0e-6, 1200.0, 0.0, 600.0, 2.0e-6, 600.0)       # Case 4: Zero reversal current\n    ]\n\n    results = []\n\n    for case in test_cases:\n        j1, t1, j2, t2, j3, t3 = case\n\n        # Initialize with a fully delithiated particle (shell thickness s=0)\n        # The state is tracked by the cubed interface radius, ri_cubed.\n        # s = R - ri, so s=0 - ri=R - ri_cubed = R^3\n        ri_cubed_current = R_CUBED\n\n        # Stage A: Lithiation\n        j_A, dt_A = j1, t1\n        ri_cubed_after_A_raw = ri_cubed_current - K_CONST * j_A * dt_A\n        ri_cubed_after_A = np.clip(ri_cubed_after_A_raw, 0, R_CUBED)\n        \n        # Stage B: Delithiation\n        j_B, dt_B = j2, t2\n        ri_cubed_after_B_raw = ri_cubed_after_A - K_CONST * j_B * dt_B\n        # Check if the shell was fully removed before clamping the value\n        full_removal_StageB = (ri_cubed_after_B_raw = R_CUBED)\n        ri_cubed_after_B = np.clip(ri_cubed_after_B_raw, 0, R_CUBED)\n\n        # Stage C: Re-lithiation\n        j_C, dt_C = j3, t3\n        ri_cubed_after_C_raw = ri_cubed_after_B - K_CONST * j_C * dt_C\n        ri_cubed_after_C = np.clip(ri_cubed_after_C_raw, 0, R_CUBED)\n\n        # Calculate final shell thickness s3\n        s3 = R - np.cbrt(ri_cubed_after_C)\n\n        # Calculate minor loop voltage width delta_V_minor\n        strain_term = 2 * GAMMA * s3 / R\n        overpotential_term = OHMIC_PREFACTOR * (j3 + abs(j2))\n        delta_V_minor = strain_term + overpotential_term\n        \n        results.append([s3, delta_V_minor, full_removal_StageB])\n\n    # Format the final output as a string representation of a list of lists.\n    # This involves converting each inner list to its string representation.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}