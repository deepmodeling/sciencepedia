{
    "hands_on_practices": [
        {
            "introduction": "Understanding the energy efficiency of a battery cycle is paramount in battery design, and hysteresis is a primary source of inefficiency. This first practice establishes the fundamental thermodynamic connection between the observed voltage hysteresis and the irreversible energy loss during cycling . By deriving the energy dissipated from first principles and applying the formula to a representative voltage-composition ($V-c$) loop, you will learn to quantify the energetic penalty of hysteresis and contextualize its magnitude by comparing it to other forms of heat generation.",
            "id": "3919050",
            "problem": "Consider a porous intercalation electrode for a lithium-ion battery undergoing a single-electron reaction, cycled galvanostatically between two lithium stoichiometric fractions per mole of host, denoted by the dimensionless variable $c \\in [0,1]$, where $c$ represents moles of lithium per mole of host. Assume the electrode contains exactly one mole of host formula units. The electrical work exchanged with the external circuit during infinitesimal intercalation is determined by fundamental electrochemical definitions: the electrical work increment equals the electrode potential times the charge increment, and the charge increment is related to the change in $c$ through the Faraday constant. Hysteresis in the measured voltage–composition loop arises from path-dependent metastable states in the intercalation host, and the energy dissipated per full charge–discharge cycle is the net nonconservative work over the closed loop in $(V,c)$-space.\n\nTask 1 (derivation): Starting from the fundamental definitions of electrical work and Faraday’s law, derive a general expression for the energy dissipated per cycle due to hysteresis in terms of a closed-path integral over the measured voltage–composition loop. Your derivation must explicitly connect the change in stoichiometry $c$ to the charge transferred and express the cycle energy loss solely as a functional of $V(c)$ traced along charge and discharge.\n\nTask 2 (evaluation for a measured loop): A measured Open-Circuit Voltage (OCV)–composition loop for the same electrode at temperature $T$ is parameterized as follows for the charge and discharge paths:\n- Charge path: $V_{\\mathrm{ch}}(c) = 3.80 + 0.050 \\,\\ln\\!\\big(\\frac{1-c}{c}\\big) + 0.020\\,c + 0.030 + 0.010\\,c$.\n- Discharge path: $V_{\\mathrm{dis}}(c) = 3.80 + 0.050 \\,\\ln\\!\\big(\\frac{1-c}{c}\\big) + 0.020\\,c - 0.030 - 0.010\\,c$.\nThe cycle traverses $c$ from $c_1 = 0.20$ to $c_2 = 0.80$ on charge and back to $c_1$ on discharge. Take the Faraday constant as $F = 96485 \\ \\mathrm{C\\,mol^{-1}}$.\n\nTask 3 (comparison to Joule and entropic heating): Under galvanostatic cycling with constant current magnitude $I = 0.20 \\ \\mathrm{A}$ and internal ohmic resistance $R = 0.050 \\ \\Omega$, compute the total Joule heating per cycle. Further, using equilibrium thermodynamics for a single-electron reaction, the reversible entropic heat per cycle at temperature $T = 298 \\ \\mathrm{K}$ is determined by the temperature dependence of the OCV along the actual (path-dependent) charge and discharge trajectories. The measured temperature coefficients on the two paths are:\n- $\\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{ch}}(c) = -0.40 \\times 10^{-3} + 0.10 \\times 10^{-3}\\,c \\ \\mathrm{V\\,K^{-1}}$,\n- $\\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{dis}}(c) = -0.42 \\times 10^{-3} + 0.08 \\times 10^{-3}\\,c \\ \\mathrm{V\\,K^{-1}}$.\nCompute the net reversible entropic heat over the full cycle using basic thermodynamic relations connecting reversible heat and the temperature derivative of the equilibrium potential.\n\nReport the hysteresis energy loss per cycle computed in Task 2 in kilojoules per mole. Round your answer to four significant figures and express the final energy in $\\mathrm{kJ\\,mol^{-1}}$.",
            "solution": "### Task 1: Derivation of Hysteresis Energy Loss\nThe energy dissipated due to hysteresis, $E_{\\mathrm{hys}}$, is the net nonconservative work done on the electrochemical cell over a closed charge-discharge cycle. The infinitesimal electrical work, $dW_{\\mathrm{e}}$, done on the system when an infinitesimal charge, $dQ$, is transferred at an electrode potential $V$ is given by:\n$$dW_{\\mathrm{e}} = V \\, dQ$$\nThe problem considers a single-electron reaction ($z=1$) for the intercalation of lithium. The dimensionless variable $c$ represents the moles of lithium per mole of host material. Since the electrode is stated to contain exactly one mole of host, the total charge $Q$ passed is directly proportional to the change in lithium stoichiometry $c$. The relationship is given by Faraday's law:\n$$Q = z c F$$\nFor a single-electron reaction ($z=1$) and one mole of host, this simplifies to:\n$$Q = cF$$\nwhere $F$ is the Faraday constant. The infinitesimal change in charge, $dQ$, is therefore related to the infinitesimal change in stoichiometry, $dc$, by:\n$$dQ = F \\, dc$$\nSubstituting this expression for $dQ$ into the equation for electrical work gives the work done over an infinitesimal change in stoichiometry:\n$$dW_{\\mathrm{e}} = V(c) F \\, dc$$\nThe total energy dissipated over a full cycle is the net work done on the system, which is the closed-path integral of $dW_{\\mathrm{e}}$ over the cycle:\n$$E_{\\mathrm{hys}} = W_{\\mathrm{net}} = \\oint dW_{\\mathrm{e}} = \\oint F V(c) \\, dc$$\nThis closed-path integral can be written as the sum of the integral along the charging path (from $c_1$ to $c_2$) and the integral along the discharging path (from $c_2$ to $c_1$):\n$$E_{\\mathrm{hys}} = \\int_{c_1}^{c_2} F V_{\\mathrm{ch}}(c) \\, dc + \\int_{c_2}^{c_1} F V_{\\mathrm{dis}}(c) \\, dc$$\nBy reversing the limits of the second integral, we introduce a negative sign:\n$$E_{\\mathrm{hys}} = F \\int_{c_1}^{c_2} V_{\\mathrm{ch}}(c) \\, dc - F \\int_{c_1}^{c_2} V_{\\mathrm{dis}}(c) \\, dc$$\nThis combines into the final general expression for the hysteresis energy loss per cycle:\n$$E_{\\mathrm{hys}} = F \\int_{c_1}^{c_2} \\left[V_{\\mathrm{ch}}(c) - V_{\\mathrm{dis}}(c)\\right] \\, dc$$\nThis expression represents the energy dissipated as heat due to thermodynamic irreversibility within the electrode material, captured by the area enclosed by the voltage-composition loop.\n\n### Task 2: Evaluation of Hysteresis Energy for a Measured Loop\nThe problem provides parameterized expressions for the voltage on the charge and discharge paths, $V_{\\mathrm{ch}}(c)$ and $V_{\\mathrm{dis}}(c)$.\nFirst, we simplify the given expressions:\nFor the charge path:\n$$V_{\\mathrm{ch}}(c) = 3.80 + 0.050 \\,\\ln\\!\\left(\\frac{1-c}{c}\\right) + 0.020\\,c + 0.030 + 0.010\\,c = 3.830 + 0.030\\,c + 0.050 \\,\\ln\\!\\left(\\frac{1-c}{c}\\right)$$\nFor the discharge path:\n$$V_{\\mathrm{dis}}(c) = 3.80 + 0.050 \\,\\ln\\!\\left(\\frac{1-c}{c}\\right) + 0.020\\,c - 0.030 - 0.010\\,c = 3.770 + 0.010\\,c + 0.050 \\,\\ln\\!\\left(\\frac{1-c}{c}\\right)$$\nThe difference in potential, $V_{\\mathrm{ch}}(c) - V_{\\mathrm{dis}}(c)$, is the integrand required for the energy calculation. The logarithmic terms cancel out:\n$$V_{\\mathrm{ch}}(c) - V_{\\mathrm{dis}}(c) = \\left(3.830 + 0.030\\,c\\right) - \\left(3.770 + 0.010\\,c\\right) = 0.060 + 0.020\\,c$$\nNow, we integrate this expression from $c_1 = 0.20$ to $c_2 = 0.80$:\n$$E_{\\mathrm{hys}} = F \\int_{0.20}^{0.80} (0.060 + 0.020\\,c) \\, dc$$\nPerforming the integration:\n$$\\int_{0.20}^{0.80} (0.060 + 0.020\\,c) \\, dc = \\left[ 0.060\\,c + 0.020\\,\\frac{c^2}{2} \\right]_{0.20}^{0.80} = \\left[ 0.060\\,c + 0.010\\,c^2 \\right]_{0.20}^{0.80}$$\nEvaluating at the limits of integration:\n$$= \\left( 0.060(0.80) + 0.010(0.80)^2 \\right) - \\left( 0.060(0.20) + 0.010(0.20)^2 \\right)$$\n$$= \\left( 0.048 + 0.010(0.64) \\right) - \\left( 0.012 + 0.010(0.04) \\right)$$\n$$= \\left( 0.048 + 0.0064 \\right) - \\left( 0.012 + 0.0004 \\right)$$\n$$= 0.0544 - 0.0124 = 0.0420$$\nThe integral has units of volts ($V$). The total energy is found by multiplying by the Faraday constant, $F = 96485 \\, \\mathrm{C\\,mol^{-1}}$:\n$$E_{\\mathrm{hys}} = (96485 \\, \\mathrm{C\\,mol^{-1}}) \\times (0.0420 \\, \\mathrm{V}) = 4052.37 \\, \\mathrm{J\\,mol^{-1}}$$\nThe problem asks for the result in kilojoules per mole ($\\mathrm{kJ\\,mol^{-1}}$), rounded to four significant figures:\n$$E_{\\mathrm{hys}} = 4.05237 \\, \\mathrm{kJ\\,mol^{-1}} \\approx 4.052 \\, \\mathrm{kJ\\,mol^{-1}}$$\n\n### Task 3: Comparison to Joule and Entropic Heating\nFor completeness, we compute the other sources of heat generation mentioned.\n\n**Joule Heating ($Q_{\\mathrm{Joule}}$)**\nJoule heating is given by $Q_{\\mathrm{Joule}} = I^2 R t_{\\mathrm{cycle}}$, where $t_{\\mathrm{cycle}}$ is the total time for one cycle. The charge transferred during the charge half-cycle (from $c_1 = 0.20$ to $c_2 = 0.80$) is $\\Delta Q = \\Delta c \\cdot F = (0.80 - 0.20)F = 0.60F$.\nThe time for the charge half-cycle is $t_{\\mathrm{ch}} = \\Delta Q / I = 0.60F / I$.\nThe total cycle time is $t_{\\mathrm{cycle}} = t_{\\mathrm{ch}} + t_{\\mathrm{dis}} = 2 \\times t_{\\mathrm{ch}} = 1.20F / I$.\nSubstituting the given values $I = 0.20 \\, \\mathrm{A}$, $R = 0.050 \\, \\Omega$, and $F = 96485 \\, \\mathrm{C\\,mol^{-1}}$:\n$$t_{\\mathrm{cycle}} = \\frac{1.20 \\times 96485}{0.20} = 578910 \\, \\mathrm{s}$$\n$$Q_{\\mathrm{Joule}} = (0.20 \\, \\mathrm{A})^2 \\times (0.050 \\, \\Omega) \\times (578910 \\, \\mathrm{s}) = 0.04 \\times 0.050 \\times 578910 = 1157.82 \\, \\mathrm{J\\,mol^{-1}} = 1.158 \\, \\mathrm{kJ\\,mol^{-1}}$$\n\n**Net Reversible Entropic Heat ($Q_{\\mathrm{rev}}$)**\nThe reversible heat generated over a path is $Q_{\\mathrm{rev}} = \\int T dS$. Using the electrochemical Maxwell relation $dS = F (\\partial U / \\partial T) dc$, the net reversible heat over the cycle is:\n$$Q_{\\mathrm{rev, cycle}} = F T \\oint \\left(\\frac{\\partial U}{\\partial T}\\right) dc = F T \\int_{c_1}^{c_2} \\left[ \\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{ch}}(c) - \\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{dis}}(c) \\right] dc$$\nThe difference in the temperature coefficients is:\n$$\\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{ch}} - \\left(\\frac{\\partial U}{\\partial T}\\right)_{\\mathrm{dis}} = (-0.40 \\times 10^{-3} + 0.10 \\times 10^{-3}c) - (-0.42 \\times 10^{-3} + 0.08 \\times 10^{-3}c)$$\n$$= (0.02 \\times 10^{-3}) + (0.02 \\times 10^{-3})c = 0.02 \\times 10^{-3} (1+c) \\, \\mathrm{V\\,K^{-1}}$$\nIntegrating this difference from $c_1 = 0.20$ to $c_2 = 0.80$:\n$$\\int_{0.20}^{0.80} 0.02 \\times 10^{-3} (1+c) \\, dc = 0.02 \\times 10^{-3} \\left[c + \\frac{c^2}{2}\\right]_{0.20}^{0.80}$$\n$$= 0.02 \\times 10^{-3} \\left[ \\left(0.80 + \\frac{0.80^2}{2}\\right) - \\left(0.20 + \\frac{0.20^2}{2}\\right) \\right]$$\n$$= 0.02 \\times 10^{-3} [ (0.80 + 0.32) - (0.20 + 0.02) ] = 0.02 \\times 10^{-3} [1.12 - 0.22] = 0.02 \\times 10^{-3} \\times 0.90 = 0.018 \\times 10^{-3}$$\nThe net entropic heat is then, with $T=298 \\, \\mathrm{K}$:\n$$Q_{\\mathrm{rev, cycle}} = (96485 \\, \\mathrm{C\\,mol^{-1}}) \\times (298 \\, \\mathrm{K}) \\times (0.018 \\times 10^{-3} \\, \\mathrm{V\\,K^{-1}}) = 517.58 \\, \\mathrm{J\\,mol^{-1}} = 0.518 \\, \\mathrm{kJ\\,mol^{-1}}$$\nIn this specific cycle, the hysteresis loss ($4.052 \\, \\mathrm{kJ\\,mol^{-1}}$) is the dominant form of energy dissipation compared to Joule heating ($1.158 \\, \\mathrm{kJ\\,mol^{-1}}$) and net entropic heating ($0.518 \\, \\mathrm{kJ\\,mol^{-1}}$). The final requested answer is only the hysteresis energy loss.",
            "answer": "$$\\boxed{4.052}$$"
        },
        {
            "introduction": "The total observed voltage hysteresis is a composite of multiple physical phenomena, including both equilibrium and non-equilibrium effects. This practice challenges you to dissect this composite behavior by comparing a simple rate-independent model with a rate-dependent model that incorporates Butler-Volmer kinetics . By evaluating which model better fits measured data under various cycling rates, you will gain critical insight into the domains of validity for different modeling assumptions and learn to identify when kinetic limitations become the dominant source of voltage inefficiency.",
            "id": "3919092",
            "problem": "Consider a single-particle model of a Lithium Iron Phosphate (LFP) intercalation electrode cycled galvanostatically at constant current density. Two classes of voltage hysteresis models are employed in automated battery design and simulation: a rate-independent hysteresis model and a rate-dependent model that includes kinetic overpotential. You will compare these models and decide which one better captures measured voltage loop widths under specified conditions.\n\nFundamental base and assumptions:\n- The Open Circuit Voltage (OCV) hysteresis of the two-phase LFP system arises from a non-convex free-energy landscape and is modeled as a rate-independent voltage loop of width $\\Delta U_{\\mathrm{eq}}$ across a specified state-of-charge window. In the rate-independent model, the predicted voltage loop width is taken as $\\Delta U_{\\mathrm{eq}}$ (a material parameter).\n- The kinetic overpotential $\\eta$ at the particle interface follows the Butler–Volmer (BV) relation for interfacial charge transfer, a widely accepted electrochemical formula. For a symmetric charge-transfer coefficient, the BV relation reads\n$$\ni \\;=\\; i_{0}\\,\\big(\\exp\\!\\big(\\tfrac{\\alpha F \\eta}{R T}\\big)\\;-\\;\\exp\\!\\big(-\\tfrac{(1-\\alpha) F \\eta}{R T}\\big)\\big)\n$$\nwhere $i$ is the applied current density, $i_{0}$ is the exchange current density, $\\alpha$ is the charge-transfer coefficient, $R$ is the universal gas constant, $T$ is the absolute temperature, and $F$ is Faraday’s constant. For this problem, assume $\\alpha = \\tfrac{1}{2}$, spatially uniform states, and negligible mass transport limitations, focusing only on kinetic overpotential effects.\n- Under galvanostatic cycling, the kinetic overpotential has opposite sign on charge versus discharge, and the resulting hysteresis loop width in the rate-dependent model is widened by $2\\,|\\eta|$ relative to the equilibrium loop width.\n\nYour task:\n- For each test case, compute the predicted hysteresis loop width under both models:\n  1. Rate-independent model: $W_{\\mathrm{RI}} = \\Delta U_{\\mathrm{eq}}$.\n  2. Rate-dependent model: derive $\\eta$ from the BV relation above under the stated assumptions, then compute $W_{\\mathrm{RD}} = \\Delta U_{\\mathrm{eq}} + 2\\,|\\eta|$.\n- Compare $W_{\\mathrm{RI}}$ and $W_{\\mathrm{RD}}$ to the measured loop width $W_{\\mathrm{meas}}$. Select the model with the smaller absolute error. If the errors are equal within numerical precision, select the rate-independent model.\n\nConstants and parameters:\n- Use $R = 8.314$ joules per mole per kelvin, $F = 96485$ coulombs per mole, $T = 298$ kelvin, and $\\alpha = \\tfrac{1}{2}$.\n- Use $\\Delta U_{\\mathrm{eq}} = 0.06$ volts for LFP.\n\nUnits:\n- Current density $i$ and exchange current density $i_{0}$ must be used in amperes per square meter.\n- Voltage widths $W_{\\mathrm{RI}}$, $W_{\\mathrm{RD}}$, and $W_{\\mathrm{meas}}$ must be in volts.\n\nTest suite:\nProvide results for the following test cases, each as a tuple $(i, i_{0}, W_{\\mathrm{meas}})$ with units as specified above.\n- Case $1$ (near-equilibrium, slow cycling): $(0.2, 10, 0.06)$\n- Case $2$ (moderate kinetics): $(20, 10, 0.150)$\n- Case $3$ (fast kinetics, high exchange): $(200, 1000, 0.070)$\n- Case $4$ (very slow cycling): $(0.001, 1, 0.060)$\n\nRequired final output format:\n- Your program should produce a single line of output containing the model selections for all test cases as a comma-separated list enclosed in square brackets, where $0$ denotes the rate-independent model and $1$ denotes the rate-dependent model. For example, the output should look like $[0,1,1,0]$ (with no additional text).",
            "solution": "The task is to determine which of two models—a rate-independent model or a rate-dependent model—better predicts the measured voltage hysteresis loop width, $W_{\\mathrm{meas}}$, for a Lithium Iron Phosphate (LFP) electrode under various galvanostatic cycling conditions.\n\nThe first model, the rate-independent model, assumes the entire hysteresis arises from thermodynamic effects within the material. The predicted voltage loop width, $W_{\\mathrm{RI}}$, is therefore constant and equal to the equilibrium hysteresis width, $\\Delta U_{\\mathrm{eq}}$.\n$$\nW_{\\mathrm{RI}} = \\Delta U_{\\mathrm{eq}}\n$$\nGiven the material parameter $\\Delta U_{\\mathrm{eq}} = 0.06 \\text{ V}$, this model predicts a constant loop width of $0.06 \\text{ V}$ regardless of the applied current.\n\nThe second model, the rate-dependent model, incorporates the effect of kinetic overpotential, $\\eta$, which arises from the energy barrier for charge transfer at the electrode-electrolyte interface. This overpotential adds to the voltage on charge and subtracts from it on discharge, thus widening the hysteresis loop. The total predicted width, $W_{\\mathrm{RD}}$, is the sum of the equilibrium hysteresis and the kinetic contribution, which is $2|\\eta|$.\n$$\nW_{\\mathrm{RD}} = \\Delta U_{\\mathrm{eq}} + 2|\\eta|\n$$\nThe kinetic overpotential $\\eta$ is determined by the Butler-Volmer equation, which relates the applied current density, $i$, to the exchange current density, $i_0$, and $\\eta$:\n$$\ni = i_{0}\\,\\left(\\exp\\left(\\frac{\\alpha F \\eta}{R T}\\right) - \\exp\\left(-\\frac{(1-\\alpha) F \\eta}{R T}\\right)\\right)\n$$\nwhere $F$ is Faraday's constant ($96485 \\text{ C/mol}$), $R$ is the universal gas constant ($8.314 \\text{ J/(mol·K)}$), and $T$ is the absolute temperature ($298 \\text{ K}$). The problem specifies a symmetric charge-transfer coefficient, $\\alpha = \\frac{1}{2}$. Substituting $\\alpha = \\frac{1}{2}$ simplifies the equation:\n$$\ni = i_{0}\\,\\left(\\exp\\left(\\frac{F \\eta}{2 R T}\\right) - \\exp\\left(-\\frac{F \\eta}{2 R T}\\right)\\right)\n$$\nThis expression is equivalent to the hyperbolic sine function, $\\sinh(x) = \\frac{e^x - e^{-x}}{2}$. By setting $x = \\frac{F \\eta}{2 R T}$, we can rewrite the equation as:\n$$\ni = 2 i_{0} \\sinh\\left(\\frac{F \\eta}{2 R T}\\right)\n$$\nTo find the overpotential $\\eta$, we must solve this equation for $\\eta$. This is achieved by algebraic rearrangement and the application of the inverse hyperbolic sine function, $\\text{arsinh}$:\n$$\n\\frac{i}{2 i_{0}} = \\sinh\\left(\\frac{F \\eta}{2 R T}\\right)\n$$\n$$\n\\text{arsinh}\\left(\\frac{i}{2 i_{0}}\\right) = \\frac{F \\eta}{2 R T}\n$$\n$$\n\\eta = \\frac{2 R T}{F} \\text{arsinh}\\left(\\frac{i}{2 i_{0}}\\right)\n$$\nSince the applied current density $i$ and exchange current density $i_0$ are defined as positive quantities, the argument of $\\text{arsinh}$ is positive, ensuring $\\eta$ is also positive. Thus, $|\\eta| = \\eta$.\n\nFor each test case, specified by a tuple $(i, i_0, W_{\\mathrm{meas}})$, we perform the following steps:\n$1$. Calculate the predicted width from the rate-independent model, $W_{\\mathrm{RI}} = 0.06 \\text{ V}$.\n$2$. Calculate the kinetic overpotential $\\eta$ using the derived formula.\n$3$. Calculate the predicted width from the rate-dependent model, $W_{\\mathrm{RD}} = 0.06 + 2\\eta$.\n$4$. Calculate the absolute error for each model: $E_{\\mathrm{RI}} = |W_{\\mathrm{RI}} - W_{\\mathrm{meas}}|$ and $E_{\\mathrm{RD}} = |W_{\\mathrm{RD}} - W_{\\mathrm{meas}}|$.\n$5$. Select the model that yields the smaller error. If $E_{\\mathrm{RI}} \\le E_{\\mathrm{RD}}$, the rate-independent model (coded as $0$) is chosen. Otherwise, the rate-dependent model (coded as $1$) is chosen.\n\nFor example, for Case $2$: $(i, i_0, W_{\\mathrm{meas}}) = (20 \\text{ A/m}^2, 10 \\text{ A/m}^2, 0.150 \\text{ V})$.\nThe thermal voltage term is $\\frac{RT}{F} \\approx \\frac{8.314 \\times 298}{96485} \\approx 0.025676 \\text{ V}$.\nThe overpotential is:\n$$\n\\eta = 2 \\times 0.025676 \\text{ V} \\times \\text{arsinh}\\left(\\frac{20}{2 \\times 10}\\right) = 0.051352 \\text{ V} \\times \\text{arsinh}(1)\n$$\nUsing $\\text{arsinh}(1) \\approx 0.88137$, we find:\n$$\n\\eta \\approx 0.051352 \\times 0.88137 \\approx 0.04526 \\text{ V}\n$$\nNow we compute the predicted loop widths and their errors:\n- Rate-independent model:\n  $W_{\\mathrm{RI}} = 0.06 \\text{ V}$\n  $E_{\\mathrm{RI}} = |0.06 - 0.150| = 0.09 \\text{ V}$\n- Rate-dependent model:\n  $W_{\\mathrm{RD}} = \\Delta U_{\\mathrm{eq}} + 2\\eta \\approx 0.06 + 2(0.04526) = 0.06 + 0.09052 = 0.15052 \\text{ V}$\n  $E_{\\mathrm{RD}} = |0.15052 - 0.150| \\approx 0.00052 \\text{ V}$\nSince $E_{\\mathrm{RD}}  E_{\\mathrm{RI}}$, the rate-dependent model ($1$) is selected for this case. This procedure is repeated for all test cases. The results indicate that for slow cycling (small ratio of $i/i_0$), the kinetic effects are negligible and the rate-independent model is sufficient. For faster cycling, the kinetic overpotential becomes significant, and the rate-dependent model provides a much more accurate prediction.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the battery hysteresis model comparison problem.\n\n    For each test case, this function calculates the predicted voltage hysteresis\n    loop width using two models: a rate-independent (RI) model and a\n    rate-dependent (RD) model. It then compares the absolute error of each\n    model's prediction against a measured width to determine which model is\n    a better fit.\n    \"\"\"\n    # Define constants and parameters.\n    R = 8.314  # Universal gas constant in J/(mol·K)\n    F = 96485  # Faraday's constant in C/mol\n    T = 298.0  # Absolute temperature in Kelvin\n    DELTA_U_EQ = 0.06  # Rate-independent equilibrium hysteresis width in Volts\n\n    # The test suite provides cases as tuples of:\n    # (applied current density i, exchange current density i_0, measured width W_meas)\n    # i and i_0 are in A/m^2; W_meas is in Volts.\n    test_cases = [\n        (0.2, 10.0, 0.06),   # Case 1: Near-equilibrium, slow cycling\n        (20.0, 10.0, 0.150), # Case 2: Moderate kinetics\n        (200.0, 1000.0, 0.070),# Case 3: Fast kinetics, high exchange\n        (0.001, 1.0, 0.060), # Case 4: Very slow cycling\n    ]\n\n    results = []\n    \n    # Pre-calculate the voltage term from the Butler-Volmer derivation\n    voltage_term_2RT_over_F = (2.0 * R * T) / F\n\n    for case in test_cases:\n        i, i_0, W_meas = case\n\n        # 1. Rate-Independent Model\n        # The predicted width is simply the equilibrium hysteresis width.\n        W_ri = DELTA_U_EQ\n        error_ri = abs(W_ri - W_meas)\n\n        # 2. Rate-Dependent Model\n        # First, calculate the kinetic overpotential eta (η).\n        # The argument for arsinh is i / (2 * i_0).\n        arsinh_arg = i / (2.0 * i_0)\n        # eta = (2*R*T/F) * arcsinh(i / (2*i_0))\n        eta = voltage_term_2RT_over_F * np.arcsinh(arsinh_arg)\n        \n        # The predicted width includes the kinetic contribution.\n        # W_rd = ΔU_eq + 2 * |η|. Since eta is positive, |η|=η.\n        W_rd = DELTA_U_EQ + 2.0 * eta\n        error_rd = abs(W_rd - W_meas)\n\n        # 3. Compare models and select the best fit.\n        # Select rate-independent (0) if its error is less than or equal to\n        # the rate-dependent model's error (tie-breaker rule).\n        # Otherwise, select rate-dependent (1).\n        if error_ri = error_rd:\n            results.append(0)\n        else:\n            results.append(1)\n\n    # Print the final result in the specified format: [0,1,1,0]\n    # The map(str, ...) converts each integer in the list to a string.\n    # ','.join(...) creates the comma-separated string.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "To truly understand hysteresis in many battery materials, we must model the underlying physical processes at the particle level, particularly for those that undergo phase transformations. This exercise guides you through a mechanism-based simulation of a two-phase intercalation particle using a classic core-shell model derived from mass conservation principles . By tracking the growth and recession of the new phase, you will directly connect microscopic structural evolution to the macroscopic voltage response and uncover the physical origin of complex, path-dependent behaviors like minor hysteresis loops.",
            "id": "3919083",
            "problem": "Consider a single spherical intercalation particle undergoing two-phase transformation between a low-lithium phase and a high-lithium phase under galvanostatic operation. Let the particle radius be $R$ (in $\\mathrm{m}$). Assume a sharp interface between the two phases, where a high-lithium shell of thickness $s(t)$ (in $\\mathrm{m}$) grows inward from the particle surface during lithiation and recedes during delithiation. Let $c_{\\alpha}$ (in $\\mathrm{mol}/\\mathrm{m}^{3}$) denote the lithium concentration in the high-lithium phase and $c_{\\beta}$ (in $\\mathrm{mol}/\\mathrm{m}^{3}$) denote the lithium concentration in the low-lithium phase, both treated as constants within the miscibility gap, and define $\\Delta c = c_{\\alpha} - c_{\\beta} > 0$. The surface molar flux of lithium is $j$ (in $\\mathrm{mol}/\\mathrm{m}^{2}\\cdot\\mathrm{s}$), with $j > 0$ for lithiation and $j  0$ for delithiation, and it is spatially uniform over the particle surface.\n\nStarting from fundamental mass conservation at a moving phase boundary in a sphere and the definition of the spherical geometry, derive the evolution equation of the interface radius $r_{i}(t)$ (in $\\mathrm{m}$), where $r_{i}(t) = R - s(t)$. Make the physically justified assumption that the total molar rate of lithium entering the particle equals the molar rate required to transform low-lithium phase into high-lithium phase at the moving interface. Enforce that the interfacial velocity is determined by this balance and depends on the interface area. Do not introduce any empirical shortcut formula for shell growth; the derivation must start from mass conservation, spherical geometry, and constant concentrations $c_{\\alpha}$ and $c_{\\beta}$.\n\nHaving obtained the governing equation, integrate it to obtain $s(t)$ under a constant lithiation flux $j > 0$ and, under reversal, under a constant delithiation flux $j  0$, both starting from a given initial shell thickness $s(0)$. Treat the transformation as fully coherent so that the only geometric limitation is the sphere’s radius $R$. Provide explicit closed-form expressions that allow computing $s(t)$ during each constant-flux segment.\n\nTo connect phase growth to voltage hysteresis, adopt a minimal but physically consistent voltage model as follows:\n- The Open Circuit Voltage (OCV) plateau $U_{0}$ (in $\\mathrm{V}$) is constant within the two-phase region.\n- Coherency strain modifies the local chemical potential in proportion to the shell thickness. Model this as a voltage shift $\\pm \\gamma \\, s/R$ (in $\\mathrm{V}$), where $\\gamma > 0$ (in $\\mathrm{V}$) is a material parameter; use the $+$ sign for lithiation and the $-$ sign for delithiation.\n- The interfacial reaction overpotential is governed by the linearized limit of the Butler–Volmer kinetics. With electrons per intercalant $n = 1$, the charge-transfer current density is $i_{\\mathrm{elec}} = n F j$ (in $\\mathrm{A}/\\mathrm{m}^{2}$), where $F$ is the Faraday constant (in $\\mathrm{C}/\\mathrm{mol}$). For small overpotentials, the linearized Butler–Volmer relation yields $\\eta \\approx i_{\\mathrm{elec}} \\, R_{g} T / (i_{0} F) = j \\, R_{g} T / i_{0}$ (in $\\mathrm{V}$), where $R_{g}$ is the universal gas constant (in $\\mathrm{J}/\\mathrm{mol}\\cdot\\mathrm{K}$), $T$ is temperature (in $\\mathrm{K}$), and $i_{0}$ is the exchange current density (in $\\mathrm{A}/\\mathrm{m}^{2}$). Take $\\eta$ with the $+$ sign for lithiation and the $-$ sign for delithiation.\n\nUnder this model, the instantaneous voltage during lithiation is $V_{\\mathrm{L}}(t) = U_{0} + \\gamma \\, s(t)/R + j \\, R_{g} T / i_{0}$ and during delithiation is $V_{\\mathrm{D}}(t) = U_{0} - \\gamma \\, s(t)/R - |j| \\, R_{g} T / i_{0}$.\n\nDefine the volume fraction of the high-lithium phase $f_{\\alpha}(t)$ as the ratio of its volume to the particle volume. Under the core–shell geometry with interface radius $r_{i}(t)$, this fraction is $f_{\\alpha}(t) = 1 - \\left( r_{i}(t) / R \\right)^{3}$. Note that $f_{\\alpha}(t)$ is the same as the state-of-charge fraction on a per-particle basis within the two-phase region.\n\nYou must implement a discrete three-stage galvanostatic protocol on a single particle:\n- Stage A (lithiation): starting from $s(0) = 0$, apply constant flux $j_{1} > 0$ for time $t_{1}$ (in $\\mathrm{s}$), compute $s_{1} = s(t_{1})$.\n- Stage B (delithiation): reverse with constant flux $j_{2}  0$ for time $t_{2}$ (in $\\mathrm{s}$), compute $s_{2} = s(t_{1} + t_{2})$; if $s_{2} \\le 0$, the shell is fully removed.\n- Stage C (re-lithiation): apply constant flux $j_{3} > 0$ for time $t_{3}$ (in $\\mathrm{s}$), compute the final shell thickness $s_{3} = s(t_{1} + t_{2} + t_{3})$.\n\nTo quantify a minor loop in hysteresis caused by incomplete shell removal, evaluate the voltage difference at the end of Stage C between the lithiation branch and the delithiation branch at the same state-of-charge fraction $f_{\\alpha}(t_{1} + t_{2} + t_{3})$. Since $f_{\\alpha}$ uniquely determines $s$ via the geometry, this minor-loop width at the end of Stage C is\n$$\n\\Delta V_{\\mathrm{minor}} = V_{\\mathrm{L}}\\big(s_{3}, j_{3}\\big) - V_{\\mathrm{D}}\\big(s_{3}, j_{2}\\big) = 2 \\gamma \\frac{s_{3}}{R} + \\frac{R_{g} T}{i_{0}} \\left( j_{3} + |j_{2}| \\right).\n$$\n\nYour program must:\n- Implement the closed-form $s(t)$ for each constant-flux segment.\n- Compute $f_{\\alpha}(t)$ from $s(t)$ and $R$.\n- Compute $V_{\\mathrm{L}}$ and $V_{\\mathrm{D}}$ as specified and then $\\Delta V_{\\mathrm{minor}}$.\n- Determine whether the shell was fully removed in Stage B, i.e., output a boolean indicating if $s_{2} \\le 0$.\n\nExpress shell thicknesses in $\\mathrm{m}$ and voltages in $\\mathrm{V}$, both as floating-point numbers.\n\nTest Suite. Use the following four parameter sets to exercise normal operation, full removal, early reversal, and zero-reversal-current edge case. For all cases, take $U_{0} = 3.4$ (in $\\mathrm{V}$), $\\gamma = 0.05$ (in $\\mathrm{V}$), $i_{0} = 100$ (in $\\mathrm{A}/\\mathrm{m}^{2}$), $T = 298$ (in $\\mathrm{K}$), $c_{\\alpha} - c_{\\beta} = \\Delta c = 3 \\times 10^{4}$ (in $\\mathrm{mol}/\\mathrm{m}^{3}$), and $R = 10^{-6}$ (in $\\mathrm{m}$). Each case specifies $(j_{1}, t_{1}, j_{2}, t_{2}, j_{3}, t_{3})$ with $j$ in $\\mathrm{mol}/\\mathrm{m}^{2}\\cdot\\mathrm{s}$ and $t$ in $\\mathrm{s}$:\n- Case $1$ (happy path, incomplete removal): $(j_{1} = 2 \\times 10^{-6}, \\, t_{1} = 1800, \\, j_{2} = -1 \\times 10^{-6}, \\, t_{2} = 900, \\, j_{3} = 2 \\times 10^{-6}, \\, t_{3} = 600)$.\n- Case $2$ (boundary, full removal during Stage B): $(j_{1} = 2 \\times 10^{-6}, \\, t_{1} = 1800, \\, j_{2} = -1 \\times 10^{-6}, \\, t_{2} = 3600, \\, j_{3} = 2 \\times 10^{-6}, \\, t_{3} = 600)$.\n- Case $3$ (early reversal, small shell): $(j_{1} = 2 \\times 10^{-6}, \\, t_{1} = 60, \\, j_{2} = -1 \\times 10^{-6}, \\, t_{2} = 30, \\, j_{3} = 2 \\times 10^{-6}, \\, t_{3} = 90)$.\n- Case $4$ (edge case, zero reversal current): $(j_{1} = 2 \\times 10^{-6}, \\, t_{1} = 1200, \\, j_{2} = 0, \\, t_{2} = 600, \\, j_{3} = 2 \\times 10^{-6}, \\, t_{3} = 600)$.\n\nFinal Output Specification. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each result (per case) is a list of length $3$: $[s_{3}, \\Delta V_{\\mathrm{minor}}, \\mathrm{full\\_removal\\_StageB}]$, where $s_{3}$ is in $\\mathrm{m}$, $\\Delta V_{\\mathrm{minor}}$ is in $\\mathrm{V}$, and $\\mathrm{full\\_removal\\_StageB}$ is a boolean. For example, the overall output should look like $[[s_{3}^{(1)}, \\Delta V_{\\mathrm{minor}}^{(1)}, \\mathrm{bool}^{(1)}],[s_{3}^{(2)}, \\Delta V_{\\mathrm{minor}}^{(2)}, \\mathrm{bool}^{(2)}],[s_{3}^{(3)}, \\Delta V_{\\mathrm{minor}}^{(3)}, \\mathrm{bool}^{(3)}],[s_{3}^{(4)}, \\Delta V_{\\mathrm{minor}}^{(4)}, \\mathrm{bool}^{(4)}]]$.",
            "solution": "### Part 1: Derivation of the Interface Evolution Equation\n\nThe model considers a spherical particle of radius $R$ with a sharp interface at radius $r_i(t)$ separating an outer high-lithium ($\\alpha$) phase from an inner low-lithium ($\\beta$) phase. The concentrations within each phase are constant, $c_{\\alpha}$ and $c_{\\beta}$ respectively, with $\\Delta c = c_{\\alpha} - c_{\\beta} > 0$.\n\nThe core physical assumption is the conservation of mass: the total molar rate of lithium entering or leaving the particle through its surface must equal the rate at which lithium is consumed or released by the moving phase boundary.\n\nThe total molar rate of lithium entering the particle is given by the product of the uniform surface molar flux, $j$ (in $\\mathrm{mol}/\\mathrm{m}^2\\cdot\\mathrm{s}$), and the particle's surface area, $A_p = 4\\pi R^2$.\n$$\n\\text{Total Molar Rate} = j \\cdot (4\\pi R^2) \\quad [\\mathrm{mol/s}]\n$$\nA positive $j$ corresponds to lithiation (influx), and a negative $j$ corresponds to delithiation (outflux).\n\nThe phase boundary is a sphere of area $A_i(t) = 4\\pi r_i(t)^2$. In a time interval $dt$, the interface moves by a radial distance $dr_i$. The volume swept by the interface is $dV = A_i(t) \\cdot |dr_i| = 4\\pi r_i(t)^2 |dr_i|$. To transform this volume from phase $\\beta$ to phase $\\alpha$, the amount of lithium required is $dN = \\Delta c \\cdot dV$. The molar rate of lithium consumption at the interface is thus:\n$$\n\\frac{dN}{dt} = \\Delta c \\frac{dV}{dt} = \\Delta c \\cdot 4\\pi r_i(t)^2 \\left| \\frac{dr_i}{dt} \\right|\n$$\nDuring lithiation ($j>0$), the interface moves inward, so $r_i$ decreases, and $dr_i/dt  0$. Thus, $|dr_i/dt| = -dr_i/dt$. Equating the influx to the consumption rate:\n$$\nj \\cdot (4\\pi R^2) = \\Delta c \\cdot 4\\pi r_i(t)^2 \\left( -\\frac{dr_i}{dt} \\right)\n$$\n$$\n\\frac{dr_i}{dt} = -\\frac{j R^2}{\\Delta c \\cdot r_i(t)^2}\n$$\nDuring delithiation ($j0$), the interface moves outward, so $r_i$ increases, and $dr_i/dt > 0$. The rate of lithium leaving the particle, $|j| \\cdot 4\\pi R^2$, must be supplied by the transformation from phase $\\alpha$ to $\\beta$.\n$$\n|j| \\cdot (4\\pi R^2) = \\Delta c \\cdot 4\\pi r_i(t)^2 \\left( \\frac{dr_i}{dt} \\right)\n$$\nSince $j  0$, we have $|j| = -j$. Substituting this gives:\n$$\n-j \\cdot (4\\pi R^2) = \\Delta c \\cdot 4\\pi r_i(t)^2 \\left( \\frac{dr_i}{dt} \\right) \\implies \\frac{dr_i}{dt} = -\\frac{j R^2}{\\Delta c \\cdot r_i(t)^2}\n$$\nThis confirms that the same ordinary differential equation (ODE) governs the evolution of the interface radius $r_i(t)$ for both lithiation and delithiation.\n\n### Part 2: Integration for Constant-Flux Segments\n\nThe derived ODE is separable:\n$$\nr_i(t)^2 \\, dr_i = -\\frac{j R^2}{\\Delta c} \\, dt\n$$\nWe integrate this equation over a time interval $\\Delta t = t_k - t_{k-1}$ during which the flux $j_k$ is constant. Let the initial interface radius be $r_{i, k-1}$ and the final radius be $r_{i, k}$.\n$$\n\\int_{r_{i, k-1}}^{r_{i, k}} r^2 \\, dr = \\int_{t_{k-1}}^{t_k} -\\frac{j_k R^2}{\\Delta c} \\, d\\tau\n$$\n$$\n\\left[ \\frac{r^3}{3} \\right]_{r_{i, k-1}}^{r_{i, k}} = -\\frac{j_k R^2}{\\Delta c} \\Delta t_k\n$$\n$$\nr_{i, k}^3 - r_{i, k-1}^3 = -\\frac{3 j_k R^2 \\Delta t_k}{\\Delta c}\n$$\nThis gives the evolution of the cubed interface radius. In terms of shell thickness $s(t) = R - r_i(t)$, we have $r_i(t) = R - s(t)$. Let $s_{k-1}$ be the initial shell thickness and $s_k$ be the final one for the step.\n$$\n(R - s_k)^3 = (R - s_{k-1})^3 - \\frac{3 j_k R^2 \\Delta t_k}{\\Delta c}\n$$\nThe shell thickness must be physically constrained, $0 \\le s(t) \\le R$, which implies $R \\ge r_i(t) \\ge 0$. This means $r_i(t)^3$ must be within the range $[0, R^3]$. The algorithm must enforce these bounds.\n\n### Part 3: Algorithmic Implementation of the Protocol\n\nWe can define a constant $K = \\frac{3 R^2}{\\Delta c}$. The update rule for the cubed interface radius over a step with flux $j$ and duration $\\Delta t$, starting from $r_{i, \\text{start}}^3$, is:\n$$\nr_{i, \\text{end, raw}}^3 = r_{i, \\text{start}}^3 - K \\cdot j \\cdot \\Delta t\n$$\nTo enforce physical bounds, we clamp the result:\n$$\nr_{i, \\text{end}}^3 = \\max(0, \\min(R^3, r_{i, \\text{end, raw}}^3))\n$$\nThe final shell thickness for the step is $s_{\\text{end}} = R - (r_{i, \\text{end}}^3)^{1/3}$.\n\nThe three-stage protocol is implemented as follows:\n1.  **Stage A (Lithiation):** Initial state is $s(0)=0$, so $r_{i,0}^3 = R^3$. Apply flux $j_1$ for time $t_1$.\n    $r_{i,1}^3 = \\max(0, \\min(R^3, R^3 - K j_1 t_1))$. The final shell thickness is $s_1 = R - (r_{i,1}^3)^{1/3}$.\n2.  **Stage B (Delithiation):** Start from $r_{i,1}^3$. Apply flux $j_2$ for time $t_2$.\n    $r_{i,2, \\text{raw}}^3 = r_{i,1}^3 - K j_2 t_2$. We check for full shell removal: `full_removal_StageB` is true if $r_{i,2, \\text{raw}}^3 \\ge R^3$.\n    $r_{i,2}^3 = \\max(0, \\min(R^3, r_{i,2, \\text{raw}}^3))$. The final shell thickness is $s_2 = R - (r_{i,2}^3)^{1/3}$.\n3.  **Stage C (Re-lithiation):** Start from $r_{i,2}^3$. Apply flux $j_3$ for time $t_3$.\n    $r_{i,3}^3 = \\max(0, \\min(R^3, r_{i,2}^3 - K j_3 t_3))$. The final shell thickness is $s_3 = R - (r_{i,3}^3)^{1/3}$.\n\n### Part 4: Final Calculations\n\nAfter computing the final shell thickness $s_3$, the minor-loop voltage width $\\Delta V_{\\mathrm{minor}}$ is calculated using the provided formula:\n$$\n\\Delta V_{\\mathrm{minor}} = V_{\\mathrm{L}}(s_{3}, j_{3}) - V_{\\mathrm{D}}(s_{3}, j_{2}) = 2 \\gamma \\frac{s_{3}}{R} + \\frac{R_{g} T}{i_{0}} (j_{3} + |j_{2}|)\n$$\nwhere $R_g$ is the universal gas constant ($8.314462618 \\, \\mathrm{J}/\\mathrm{mol}\\cdot\\mathrm{K}$) and $T$ is the temperature in Kelvin. The program will report the triplet $[s_3, \\Delta V_{\\mathrm{minor}}, \\text{full\\_removal\\_StageB}]$ for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating shell thickness and hysteresis voltage\n    for a three-stage galvanostatic protocol on a phase-transforming particle.\n    \"\"\"\n    \n    # Universal constants and parameters for all test cases\n    R = 1.0e-6  # Particle radius [m]\n    DELTA_C = 3.0e4  # Concentration difference [mol/m^3]\n    GAMMA = 0.05  # Strain-voltage coupling parameter [V]\n    I0 = 100.0  # Exchange current density [A/m^2]\n    T = 298.0  # Temperature [K]\n    RG = 8.314462618  # Universal gas constant [J/(mol*K)]\n\n    # Pre-calculated constants for efficiency\n    R_CUBED = R**3\n    K_CONST = 3 * R**2 / DELTA_C\n    OHMIC_PREFACTOR = RG * T / I0\n\n    test_cases = [\n        # (j1, t1, j2, t2, j3, t3) with j in [mol/m^2*s] and t in [s]\n        (2.0e-6, 1800.0, -1.0e-6, 900.0, 2.0e-6, 600.0),   # Case 1: Happy path\n        (2.0e-6, 1800.0, -1.0e-6, 3600.0, 2.0e-6, 600.0),  # Case 2: Full removal\n        (2.0e-6, 60.0, -1.0e-6, 30.0, 2.0e-6, 90.0),      # Case 3: Early reversal\n        (2.0e-6, 1200.0, 0.0, 600.0, 2.0e-6, 600.0)       # Case 4: Zero reversal current\n    ]\n\n    results = []\n\n    for case in test_cases:\n        j1, t1, j2, t2, j3, t3 = case\n\n        # Initialize with a fully delithiated particle (shell thickness s=0)\n        # The state is tracked by the cubed interface radius, ri_cubed.\n        # s = R - ri, so s=0 -> ri=R -> ri_cubed = R^3\n        ri_cubed_current = R_CUBED\n\n        # Stage A: Lithiation\n        j_A, dt_A = j1, t1\n        ri_cubed_after_A_raw = ri_cubed_current - K_CONST * j_A * dt_A\n        ri_cubed_after_A = np.clip(ri_cubed_after_A_raw, 0, R_CUBED)\n        \n        # Stage B: Delithiation\n        j_B, dt_B = j2, t2\n        ri_cubed_after_B_raw = ri_cubed_after_A - K_CONST * j_B * dt_B\n        # Check if the shell was fully removed before clamping the value\n        full_removal_StageB = (ri_cubed_after_B_raw >= R_CUBED)\n        ri_cubed_after_B = np.clip(ri_cubed_after_B_raw, 0, R_CUBED)\n\n        # Stage C: Re-lithiation\n        j_C, dt_C = j3, t3\n        ri_cubed_after_C_raw = ri_cubed_after_B - K_CONST * j_C * dt_C\n        ri_cubed_after_C = np.clip(ri_cubed_after_C_raw, 0, R_CUBED)\n\n        # Calculate final shell thickness s3\n        s3 = R - np.cbrt(ri_cubed_after_C)\n\n        # Calculate minor loop voltage width delta_V_minor\n        strain_term = 2 * GAMMA * s3 / R\n        overpotential_term = OHMIC_PREFACTOR * (j3 + abs(j2))\n        delta_V_minor = strain_term + overpotential_term\n        \n        results.append([s3, delta_V_minor, full_removal_StageB])\n\n    # Format the final output as a string representation of a list of lists.\n    # This involves converting each inner list to its string representation.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}