{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any battery model is its equilibrium behavior, dictated by thermodynamics. This first practice connects the microscopic world of atomic interactions, described by a regular solution model for Gibbs free energy, to the macroscopic, measurable open-circuit voltage of an electrode. By deriving the chemical potential and equilibrium voltage, you will practice a core skill in electrochemistry: translating a material's thermodynamic properties into its electrochemical potential .",
            "id": "3950667",
            "problem": "Consider a single-phase intercalation solid in a Solid-State Battery where lithium occupies intercalation sites with fractional occupancy $c \\in (0,1)$. The molar Gibbs free energy per mole of intercalation sites is modeled by a regular solution form\n$$\ng(c) = R T \\left[c \\ln c + (1-c)\\ln(1-c)\\right] + \\Omega\\, c(1-c),\n$$\nwhere $R$ is the universal gas constant, $T$ is the absolute temperature, and $\\Omega$ is a composition-independent interaction parameter. Treat $g(c)$ as the molar free energy of the host with respect to lithium composition $c$ under isothermal, isobaric conditions, neglecting elastic, electrostatic, and gradient energy contributions.\n\nStarting from the definition of chemical potential as the partial derivative of Gibbs free energy with respect to the number of moles of a species at fixed temperature and pressure, derive the composition-dependent lithium chemical potential $\\mu(c)$ associated with $g(c)$. Then, starting from the equilibrium of electrochemical potentials for the interfacial reaction $\\mathrm{Li}^{+} + e^{-} \\rightleftharpoons \\mathrm{Li}(\\text{solid})$ and taking the lithium metal reference $\\mathrm{Li}/\\mathrm{Li}^{+}$ so that $\\mu_{\\mathrm{Li}}^{\\mathrm{metal}}$ is the molar chemical potential of lithium in the metal, obtain the closed-form expression for the open-circuit equilibrium voltage $V_{\\mathrm{eq}}(c)$ of the intercalation electrode versus $\\mathrm{Li}/\\mathrm{Li}^{+}$.\n\nExpress $\\mu(c)$ in joules per mole and $V_{\\mathrm{eq}}(c)$ in volts. Report your final expressions symbolically. No numerical evaluation is required. The final answer must be a single analytical expression or, if multiple quantities are requested, a single row matrix containing those expressions.",
            "solution": "The user wants to derive the chemical potential and equilibrium voltage for a solid-state battery electrode.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n\n-   **System**: A single-phase intercalation solid in a Solid-State Battery.\n-   **State Variable**: Fractional occupancy of lithium intercalation sites, $c \\in (0,1)$.\n-   **Molar Gibbs Free Energy**: The molar Gibbs free energy per mole of intercalation sites is given by the regular solution model:\n    $$g(c) = R T \\left[c \\ln c + (1-c)\\ln(1-c)\\right] + \\Omega\\, c(1-c)$$\n-   **Constants**: $R$ (universal gas constant), $T$ (absolute temperature), $\\Omega$ (composition-independent interaction parameter).\n-   **Assumptions**: Isothermal and isobaric conditions. Elastic, electrostatic, and gradient energy contributions are neglected.\n-   **Definition**: Chemical potential is the partial derivative of Gibbs free energy with respect to the number of moles of a species at fixed temperature and pressure.\n-   **Interfacial Reaction**: $\\mathrm{Li}^{+} + e^{-} \\rightleftharpoons \\mathrm{Li}(\\text{solid})$.\n-   **Reference Electrode**: The reference is the lithium metal electrode, $\\mathrm{Li}/\\mathrm{Li}^{+}$.\n-   **Reference Chemical Potential**: $\\mu_{\\mathrm{Li}}^{\\mathrm{metal}}$ is the molar chemical potential of lithium in the metal.\n-   **Quantities to Derive**:\n    1.  The composition-dependent lithium chemical potential, $\\mu(c)$.\n    2.  The open-circuit equilibrium voltage, $V_{\\mathrm{eq}}(c)$, of the intercalation electrode versus the $\\mathrm{Li}/\\mathrm{Li}^{+}$ reference.\n\n**1.2. Validate Using Extracted Givens**\n\n-   **Scientific Grounding**: The problem is based on the regular solution model, a standard and fundamental theory in chemical thermodynamics and materials science used to describe the free energy of mixing in solid solutions, including intercalation compounds. The derivation of chemical potential from Gibbs free energy and the relationship between chemical potential and electrode potential are core principles of electrochemistry. The problem is scientifically sound.\n-   **Well-Posedness**: The problem provides a specific functional form for the free energy, clear definitions, and a well-defined reference state. It asks for the derivation of two specific physical quantities, $\\mu(c)$ and $V_{\\mathrm{eq}}(c)$. All necessary information is provided, and the problem structure leads to a unique analytical solution.\n-   **Objectivity**: The problem is stated using precise, objective, and standard scientific language. It is free from any subjective or ambiguous terminology.\n\n**1.3. Verdict and Action**\n\nThe problem is valid as it is scientifically grounded, well-posed, and objective. It does not violate any of the invalidity criteria. We may proceed to the solution.\n\n### Step 2: Solution Derivation\n\n**2.1. Derivation of the Chemical Potential, $\\mu(c)$**\n\nThe problem asks for the lithium chemical potential $\\mu(c)$ associated with the molar Gibbs free energy $g(c)$. In the context of an intercalation solid, where lithium atoms occupy sites on a fixed lattice, the relevant chemical potential is the \"insertion potential.\" This is the change in the total Gibbs free energy, $G$, of the system when one mole of lithium is inserted, which corresponds to filling one mole of vacant sites.\n\nLet $N$ be the total number of moles of intercalation sites. The total Gibbs free energy of the system is $G = N \\cdot g(c)$. The fractional occupancy is $c = n_{\\mathrm{Li}} / N$, where $n_{\\mathrm{Li}}$ is the number of moles of lithium in the solid.\n\nThe chemical potential for the intercalation process is defined as the partial derivative of the total Gibbs free energy $G$ with respect to the number of moles of lithium $n_{\\mathrm{Li}}$, while keeping the total number of sites $N$ constant (along with temperature $T$ and pressure $P$).\n$$\n\\mu(c) = \\left( \\frac{\\partial G}{\\partial n_{\\mathrm{Li}}} \\right)_{T,P,N}\n$$\nWe can apply the chain rule:\n$$\n\\mu(c) = \\frac{\\partial}{\\partial n_{\\mathrm{Li}}} \\left[ N \\cdot g(c) \\right] = N \\frac{dg(c)}{dc} \\frac{\\partial c}{\\partial n_{\\mathrm{Li}}}\n$$\nSince $c = n_{\\mathrm{Li}} / N$, the derivative $\\frac{\\partial c}{\\partial n_{\\mathrm{Li}}}$ is equal to $1/N$. Substituting this into the expression for $\\mu(c)$:\n$$\n\\mu(c) = N \\frac{dg}{dc} \\frac{1}{N} = \\frac{dg}{dc}\n$$\nThus, the chemical potential is the first derivative of the molar Gibbs free energy with respect to the composition $c$. Now we compute this derivative from the given expression for $g(c)$:\n$$\ng(c) = R T \\left[c \\ln c + (1-c)\\ln(1-c)\\right] + \\Omega c(1-c)\n$$\nDifferentiating with respect to $c$:\n$$\n\\frac{dg}{dc} = \\frac{d}{dc} \\left( R T \\left[c \\ln c + (1-c)\\ln(1-c)\\right] + \\Omega [c - c^2] \\right)\n$$\n$$\n\\frac{dg}{dc} = R T \\left[ \\left(1 \\cdot \\ln c + c \\cdot \\frac{1}{c}\\right) + \\left(-1 \\cdot \\ln(1-c) + (1-c) \\cdot \\frac{-1}{1-c}\\right) \\right] + \\Omega (1 - 2c)\n$$\n$$\n\\frac{dg}{dc} = R T \\left[ \\ln c + 1 - \\ln(1-c) - 1 \\right] + \\Omega (1 - 2c)\n$$\n$$\n\\frac{dg}{dc} = R T \\left[ \\ln c - \\ln(1-c) \\right] + \\Omega (1 - 2c)\n$$\nThis gives the final expression for the chemical potential:\n$$\n\\mu(c) = R T \\ln\\left(\\frac{c}{1-c}\\right) + \\Omega (1 - 2c)\n$$\nThis expression is in joules per mole, as required.\n\n**2.2. Derivation of the Equilibrium Voltage, $V_{\\mathrm{eq}}(c)$**\n\nThe open-circuit equilibrium voltage, $V_{\\mathrm{eq}}(c)$, of an electrode is the difference in its electric potential, $\\phi_{\\mathrm{solid}}$, and the electric potential of a reference electrode, $\\phi_{\\mathrm{ref}}$.\n$$\nV_{\\mathrm{eq}} = \\phi_{\\mathrm{solid}} - \\phi_{\\mathrm{ref}}\n$$\nAt equilibrium, the electrochemical potential, $\\tilde{\\mu}_i = \\mu_i + z_i F \\phi$, of all species involved in the electrode reactions are balanced. For the intercalation electrode reaction $\\mathrm{Li}^{+} + e^{-} \\rightleftharpoons \\mathrm{Li}(\\text{solid})$, we have:\n$$\n\\tilde{\\mu}_{\\mathrm{Li}^{+}}^{\\mathrm{electrolyte}} + \\tilde{\\mu}_{e^{-}}^{\\mathrm{solid}} = \\tilde{\\mu}_{\\mathrm{Li}}^{\\mathrm{solid}}\n$$\nSubstituting the expressions for electrochemical potential:\n$$\n\\left( \\mu_{\\mathrm{Li}^{+}}^{\\mathrm{electrolyte}} + F\\phi_{\\mathrm{electrolyte}} \\right) + \\left( \\mu_{e^{-}}^{\\mathrm{solid}} - F\\phi_{\\mathrm{solid}} \\right) = \\mu_{\\mathrm{Li}}^{\\mathrm{solid}}(c)\n$$\nRearranging to solve for the electrode potential $\\phi_{\\mathrm{solid}}$:\n$$\n-F\\phi_{\\mathrm{solid}} = \\mu_{\\mathrm{Li}}^{\\mathrm{solid}}(c) - \\mu_{\\mathrm{Li}^{+}}^{\\mathrm{electrolyte}} - \\mu_{e^{-}}^{\\mathrm{solid}} - F\\phi_{\\mathrm{electrolyte}}\n$$\nThe problem specifies a lithium metal reference electrode, $\\mathrm{Li}/\\mathrm{Li}^{+}$, for which the reaction is $\\mathrm{Li}^{+} + e^{-} \\rightleftharpoons \\mathrm{Li}(\\text{metal})$. At equilibrium, we have a similar balance:\n$$\n\\tilde{\\mu}_{\\mathrm{Li}^{+}}^{\\mathrm{electrolyte}} + \\tilde{\\mu}_{e^{-}}^{\\mathrm{ref}} = \\tilde{\\mu}_{\\mathrm{Li}}^{\\mathrm{metal}}\n$$\n$$\n\\left( \\mu_{\\mathrm{Li}^{+}}^{\\mathrm{electrolyte}} + F\\phi_{\\mathrm{electrolyte}} \\right) + \\left( \\mu_{e^{-}}^{\\mathrm{ref}} - F\\phi_{\\mathrm{ref}} \\right) = \\mu_{\\mathrm{Li}}^{\\mathrm{metal}}\n$$\nHere, $\\mu_{\\mathrm{Li}}^{\\mathrm{metal}}$ is the chemical potential of lithium in the metal reference, as given in the problem. Rearranging for the reference potential $\\phi_{\\mathrm{ref}}$:\n$$\n-F\\phi_{\\mathrm{ref}} = \\mu_{\\mathrm{Li}}^{\\mathrm{metal}} - \\mu_{\\mathrm{Li}^{+}}^{\\mathrm{electrolyte}} - \\mu_{e^{-}}^{\\mathrm{ref}} - F\\phi_{\\mathrm{electrolyte}}\n$$\nTo find the voltage $V_{\\mathrm{eq}} = \\phi_{\\mathrm{solid}} - \\phi_{\\mathrm{ref}}$, we subtract the two rearranged equations:\n$$\n-F(\\phi_{\\mathrm{solid}} - \\phi_{\\mathrm{ref}}) = (\\mu_{\\mathrm{Li}}^{\\mathrm{solid}}(c) - \\mu_{\\mathrm{Li^{+}}}^{\\mathrm{electrolyte}} - \\mu_{e^{-}}^{\\mathrm{solid}}) - (\\mu_{\\mathrm{Li}}^{\\mathrm{metal}} - \\mu_{\\mathrm{Li^{+}}}^{\\mathrm{electrolyte}} - \\mu_{e^{-}}^{\\mathrm{ref}})\n$$\n$$\n-FV_{\\mathrm{eq}} = \\mu_{\\mathrm{Li}}^{\\mathrm{solid}}(c) - \\mu_{\\mathrm{Li}}^{\\mathrm{metal}} - (\\mu_{e^{-}}^{\\mathrm{solid}} - \\mu_{e^{-}}^{\\mathrm{ref}})\n$$\nAt open-circuit, there is no net current flow between the electrode and the reference. This implies that they are in electronic equilibrium, so the chemical potential of electrons (the Fermi level) is equal in both: $\\mu_{e^{-}}^{\\mathrm{solid}} = \\mu_{e^{-}}^{\\mathrm{ref}}$. Therefore, the term $(\\mu_{e^{-}}^{\\mathrm{solid}} - \\mu_{e^{-}}^{\\mathrm{ref}})$ is zero. The equation simplifies to:\n$$\n-FV_{\\mathrm{eq}}(c) = \\mu_{\\mathrm{Li}}^{\\mathrm{solid}}(c) - \\mu_{\\mathrm{Li}}^{\\mathrm{metal}}\n$$\nThe chemical potential of lithium in the solid, $\\mu_{\\mathrm{Li}}^{\\mathrm{solid}}(c)$, is the quantity we derived in the first part, $\\mu(c)$.\n$$\nV_{\\mathrm{eq}}(c) = -\\frac{\\mu(c) - \\mu_{\\mathrm{Li}}^{\\mathrm{metal}}}{F}\n$$\nSubstituting the expression for $\\mu(c)$:\n$$\nV_{\\mathrm{eq}}(c) = -\\frac{1}{F} \\left[ R T \\ln\\left(\\frac{c}{1-c}\\right) + \\Omega (1 - 2c) - \\mu_{\\mathrm{Li}}^{\\mathrm{metal}} \\right]\n$$\nThis is the final expression for the equilibrium voltage in volts. The problem requests symbolic expressions for both $\\mu(c)$ and $V_{\\mathrm{eq}}(c)$. We will report both in a row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nR T \\ln\\left(\\frac{c}{1-c}\\right) + \\Omega (1 - 2c) & -\\frac{1}{F}\\left(R T \\ln\\left(\\frac{c}{1-c}\\right) + \\Omega(1 - 2c) - \\mu_{\\mathrm{Li}}^{\\mathrm{metal}}\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "When a battery operates, its voltage deviates from equilibrium due to various resistances, especially at the interfaces. This practice guides you through building an impedance model from first principles, combining Butler-Volmer kinetics for charge transfer with double-layer capacitance. You will learn to translate the physical phenomena at an electrode-electrolyte interface into a frequency-dependent impedance, a crucial step in diagnosing and parameterizing battery models using techniques like Electrochemical Impedance Spectroscopy (EIS) .",
            "id": "3950676",
            "problem": "A planar working electrode is in intimate contact with a homogeneous solid electrolyte of thickness $L$ and ionic conductivity $\\kappa_{i}$. The geometric area of the electrode–electrolyte interface is $A$. The interfacial redox reaction at the working electrode follows Butler–Volmer kinetics with exchange current density $j_{0}$ (defined per geometric area), charge-transfer symmetry factor $\\alpha$ with $0<\\alpha<1$, temperature $T$, universal gas constant $R$, and Faraday constant $F$. The same interface also exhibits a double-layer (interfacial) capacitance per geometric area $C_{dl}$. The counter electrode at the far side of the electrolyte is non-polarizable (negligible interfacial impedance). Mass transport in the electrolyte is purely migrational and described by Ohm’s law, and any concentration gradients or chemical capacitances can be neglected. The electrolyte’s conductivity is frequency independent in the range of interest.\n\nA small sinusoidal current perturbation at angular frequency $\\omega$ is applied to the working electrode under zero direct-current bias, and the resulting voltage response between the working electrode metal and the counter electrode metal is measured, as in Electrochemical Impedance Spectroscopy (EIS).\n\nStarting from first principles appropriate for this system, namely:\n- Butler–Volmer kinetics for the faradaic current density $j$ as a function of overpotential $\\eta$ at the working electrode,\n- the definition of the double-layer current density as the time derivative of the interfacial charge, and\n- Ohm’s law for ionic conduction through the electrolyte,\n\nderive, under the small-signal (linear) approximation about zero overpotential, the closed-form expression for the total complex impedance $Z(\\omega)$ measured between the working electrode metal and the counter electrode metal. Express $Z(\\omega)$ in terms of $R$, $T$, $F$, $j_{0}$, $C_{dl}$, $\\kappa_{i}$, $L$, $A$, and $\\omega$. Provide the final answer as a single closed-form analytic expression. Do not include units in the final expression. No numerical evaluation is required.",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, objective, and internally consistent. It describes a standard electrochemical system for which impedance is to be calculated, a classic problem in physical electrochemistry. All provided parameters are physically meaningful and sufficient for the derivation, with one minor ambiguity. The Butler-Volmer equation's dependence on the number of electrons transferred, $n$, is not explicitly stated. However, the request to express the final answer solely in terms of the given variables ($R$, $T$, $F$, etc.) strongly implies that $n$ should not appear. This is satisfied by making the common assumption that $n=1$, which we will adopt for this derivation. Therefore, the problem is considered valid and a solution will be provided.\n\nThe total complex impedance, $Z(\\omega)$, measured between the working electrode and the non-polarizable counter electrode is the series combination of the impedance of the solid electrolyte, $Z_{el}$, and the impedance of the working electrode-electrolyte interface, $Z_{int}$. The negligible impedance of the counter electrode means it does not contribute to the total impedance.\n$$\nZ(\\omega) = Z_{el} + Z_{int}\n$$\n\nFirst, we derive the expression for the electrolyte impedance, $Z_{el}$. The problem states that mass transport in the electrolyte is purely migrational and described by Ohm's law. For a homogeneous conductor of uniform cross-sectional area $A$, thickness $L$, and ionic conductivity $\\kappa_i$, the resistance is given by:\n$$\nR_{el} = \\frac{L}{\\kappa_i A}\n$$\nSince the electrolyte's conductivity is given as frequency-independent, its impedance is purely real and equal to this resistance.\n$$\nZ_{el} = R_{el} = \\frac{L}{\\kappa_i A}\n$$\n\nNext, we derive the expression for the interfacial impedance, $Z_{int}$. At the electrode-electrolyte interface, the total current can flow through two parallel pathways: the faradaic reaction (charge transfer) and the charging/discharging of the electrochemical double layer. Therefore, the interfacial impedance is the result of a parallel combination of the charge-transfer impedance, $Z_{ct}$, and the double-layer capacitance impedance, $Z_{dl}$.\nThe total interfacial admittance, $Y_{int}$, is the sum of the individual admittances:\n$$\nY_{int} = Y_{ct} + Y_{dl} = \\frac{1}{Z_{ct}} + \\frac{1}{Z_{dl}}\n$$\nThe interfacial impedance is the reciprocal of the total interfacial admittance:\n$$\nZ_{int} = \\frac{1}{Y_{int}} = \\left( \\frac{1}{Z_{ct}} + \\frac{1}{Z_{dl}} \\right)^{-1}\n$$\n\nLet's determine the individual impedance components, $Z_{ct}$ and $Z_{dl}$.\n\nThe charge-transfer process is described by Butler-Volmer kinetics. The faradaic current density, $j_f$, is a function of the overpotential $\\eta$:\n$$\nj_f = j_{0} \\left[ \\exp\\left(\\frac{(1-\\alpha)nF\\eta}{RT}\\right) - \\exp\\left(-\\frac{\\alpha nF\\eta}{RT}\\right) \\right]\n$$\nwhere $n$ is the number of electrons transferred in the elementary reaction step. The problem requires a small-signal (linear) approximation about zero overpotential ($\\eta \\to 0$). In this limit, the faradaic process behaves as a pure resistor, known as the charge-transfer resistance, $R_{ct}$. The impedance $Z_{ct}$ is thus purely real, $Z_{ct} = R_{ct}$. The value of $R_{ct}$ is related to the total faradaic current $I_f = j_f A$ by $R_{ct} = \\left(\\frac{dI_f}{d\\eta}\\right)^{-1}|_{\\eta=0}$.\nFirst, we find the derivative of the current density with respect to overpotential:\n$$\n\\frac{dj_f}{d\\eta} = j_{0} \\left[ \\frac{(1-\\alpha)nF}{RT}\\exp\\left(\\frac{(1-\\alpha)nF\\eta}{RT}\\right) + \\frac{\\alpha nF}{RT}\\exp\\left(-\\frac{\\alpha nF\\eta}{RT}\\right) \\right]\n$$\nEvaluating this at zero overpotential, $\\eta=0$:\n$$\n\\frac{dj_f}{d\\eta}\\bigg|_{\\eta=0} = j_{0} \\left( \\frac{(1-\\alpha)nF}{RT} + \\frac{\\alpha nF}{RT} \\right) = j_{0} \\frac{nF}{RT}\n$$\nThe \"charge-transfer conductance\" per unit area is $g'_{ct} = \\frac{j_0 nF}{RT}$. The total charge-transfer resistance $R_{ct}$ for an electrode of area $A$ is:\n$$\nR_{ct} = \\frac{1}{A g'_{ct}} = \\frac{RT}{nFAj_0}\n$$\nAs established during validation, we assume $n=1$:\n$$\nZ_{ct} = R_{ct} = \\frac{RT}{FAj_0}\n$$\n\nThe double-layer acts as a capacitor. The problem gives the double-layer capacitance per geometric area as $C_{dl}$. For an electrode of area $A$, the total double-layer capacitance is $C_{dl, total} = C_{dl} A$. The impedance of a capacitor with capacitance $C$ at angular frequency $\\omega$ is given by $Z_C = \\frac{1}{i\\omega C}$, where $i$ is the imaginary unit ($i^2 = -1$).\nTherefore, the double-layer impedance is:\n$$\nZ_{dl} = \\frac{1}{i\\omega C_{dl, total}} = \\frac{1}{i\\omega C_{dl} A}\n$$\n\nNow we can calculate the total interfacial impedance $Z_{int}$ by combining $Z_{ct}$ and $Z_{dl}$ in parallel:\n$$\nZ_{int} = \\left( \\frac{1}{Z_{ct}} + \\frac{1}{Z_{dl}} \\right)^{-1} = \\left( \\frac{1}{R_{ct}} + i\\omega C_{dl} A \\right)^{-1}\n$$\n$$\nZ_{int} = \\frac{R_{ct}}{1 + i\\omega R_{ct} C_{dl} A}\n$$\nSubstituting the expression for $R_{ct}$:\n$$\nZ_{int} = \\frac{\\frac{RT}{FAj_0}}{1 + i\\omega \\left(\\frac{RT}{FAj_0}\\right) C_{dl} A} = \\frac{\\frac{RT}{FAj_0}}{1 + i\\omega \\frac{RTC_{dl}}{Fj_0}}\n$$\nNote that the area $A$ appears in the numerator of the right-hand term in the denominator (from $C_{dl,total}$) and in the denominator of the left-hand term (from $R_{ct}$), thus cancelling out in the time constant $\\tau = R_{ct}C_{dl,total} = \\frac{RTC_{dl}}{Fj_0}$.\n\nFinally, the total complex impedance $Z(\\omega)$ is the sum of the electrolyte resistance and the interfacial impedance:\n$$\nZ(\\omega) = Z_{el} + Z_{int} = \\frac{L}{\\kappa_i A} + \\frac{\\frac{RT}{FAj_0}}{1 + i\\omega \\frac{RTC_{dl}}{Fj_0}}\n$$\nThis is the closed-form expression for the total complex impedance of the described electrochemical cell under the given conditions. All variables in the expression ($R$, $T$, $F$, $j_{0}$, $C_{dl}$, $\\kappa_{i}$, $L$, $A$, and $\\omega$) are those specified in the problem statement. The charge-transfer symmetry factor $\\alpha$ does not appear in the final linearized expression, which is a correct result for the impedance at zero DC bias.",
            "answer": "$$\\boxed{\\frac{L}{\\kappa_{i} A} + \\frac{\\frac{RT}{FAj_{0}}}{1 + i \\omega \\frac{RT C_{dl}}{F j_{0}}}}$$"
        },
        {
            "introduction": "A physical model is only useful if it can accurately predict real-world behavior, and this requires confronting it with experimental data. This final practice completes the modeling workflow by bridging theory with experimental reality, introducing the crucial concept of model validation. You will derive a simple physics-based voltage model, calibrate an error model to account for systematic and random discrepancies using a \"calibration\" dataset, and then use a rigorous statistical framework to assess the model's predictive power against new, independent data sets .",
            "id": "3950666",
            "problem": "You are validating a calibrated predictive model for a Solid-State Battery (SSB) under constant-current operation against independent data sets. The model observable is the terminal voltage. The physical model must be derived from charge conservation and ionic conduction in a solid electrolyte, without invoking any shortcut formulas. Derive the terminal voltage expression from first principles, then formalize an error model with additive bias and variance, and use it to compute predictive intervals and quantify model discrepancy on independent validation data.\n\nFundamental base:\n- Ionic charge conservation: $\\nabla \\cdot \\mathbf{i}_{\\mathrm{e}} = 0$ in steady state, where $\\mathbf{i}_{\\mathrm{e}}$ is the electrolyte ionic current density vector.\n- Ohm's law for ionic conduction in the electrolyte: $\\mathbf{i}_{\\mathrm{e}} = -\\kappa_{\\mathrm{eff}} \\nabla \\phi_{\\mathrm{e}}$, where $\\kappa_{\\mathrm{eff}}$ is the effective ionic conductivity of the solid electrolyte and $\\phi_{\\mathrm{e}}$ is the electrolyte potential.\n- Under one-dimensional through-thickness conduction in the electrolyte of thickness $L$ with uniform applied current density $J$ and constant properties, derive the electrolyte potential drop $\\Delta \\phi_{\\mathrm{e}}$.\n- Include interfacial area-specific resistance losses modeled as an additional potential drop proportional to current density with coefficient $R_{\\mathrm{ASR}}$.\n- Under constant-current discharge at a fixed state of charge, derive the model terminal voltage $V_{\\mathrm{model}}(J)$ based on the equilibrium potential $U_{\\mathrm{eq}}$, electrolyte potential drop, and interfacial resistance losses.\n- Formalize an additive error model for observations: $V_{\\mathrm{obs}} = V_{\\mathrm{model}} + \\beta + \\varepsilon$, where $\\beta$ is a constant bias and $\\varepsilon$ is a random error with zero mean and constant variance. Assume $\\varepsilon$ is independent across observations and follows a Gaussian distribution with variance $\\sigma^2$. The parameters $\\beta$ and $\\sigma^2$ are unknown and must be estimated from calibration data.\n\nYour program must:\n1. Implement the physically derived $V_{\\mathrm{model}}(J)$ for the specified parameters.\n2. Using the provided calibration data, estimate the bias $\\hat{\\beta}$ and variance $\\hat{\\sigma}^2$ of the residuals $r_i = V_{\\mathrm{obs},i} - V_{\\mathrm{model},i}$ with unbiased estimators.\n3. Derive and implement the predictive distribution for a future observation residual $r_{\\mathrm{new}}$ when both $\\beta$ and $\\sigma^2$ are unknown but estimated from $n$ calibration residuals. Use the correct distribution arising from the combination of Gaussian errors and parameter uncertainty; do not assume parameters are known.\n4. From that predictive distribution, derive the two-sided $(1-\\alpha)$ predictive interval for $V_{\\mathrm{obs}}$ at confidence level $1-\\alpha$, and implement it for $\\alpha = 0.05$.\n5. For each validation data set, compute:\n   - The coverage fraction (expressed as a decimal) of the observed voltages relative to the predictive intervals derived in item $4$.\n   - The average negative log predictive density (using the natural logarithm) of the observed voltages under the predictive distribution derived in item $3$.\n\nPhysical parameters and data (units specified):\n- Equilibrium potential: $U_{\\mathrm{eq}} = 4.2$ volts (express all voltages in volts).\n- Electrolyte thickness: $L = 1.0 \\times 10^{-4}$ meters.\n- Effective ionic conductivity: $\\kappa_{\\mathrm{eff}} = 0.5$ siemens per meter.\n- Total interfacial area-specific resistance: $R_{\\mathrm{ASR}} = 1.0 \\times 10^{-4}$ ohm-square meters.\n- Calibration data: current densities $J_{\\mathrm{cal}} = [50, 100, 150, 200, 250]$ amperes per square meter, observed voltages $V_{\\mathrm{obs,cal}} = [4.171, 4.167, 4.143, 4.135, 4.109]$ volts.\n- Validation set A (happy path): $J_{\\mathrm{A}} = [80, 160, 240]$ amperes per square meter, $V_{\\mathrm{obs,A}} = [4.169, 4.137, 4.120]$ volts.\n- Validation set B (bias-dominated): $J_{\\mathrm{B}} = [100, 200, 300]$ amperes per square meter, $V_{\\mathrm{obs,B}} = [4.141, 4.108, 4.080]$ volts.\n- Validation set C (variance-dominated): $J_{\\mathrm{C}} = [50, 150, 250]$ amperes per square meter, $V_{\\mathrm{obs,C}} = [4.195, 4.130, 4.133]$ volts.\n- Confidence level: $1-\\alpha = 0.95$ (use radians or degrees does not apply; use natural logarithm for densities).\n\nTest suite specification and required outputs:\n- Use the given calibration data to estimate $\\hat{\\beta}$ and $\\hat{\\sigma}^2$.\n- For each validation set (A, B, C), compute:\n  - Coverage fraction as a decimal in $[0,1]$.\n  - Average negative log predictive density (natural log).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following exact order:\n  $[\\hat{\\beta}, \\hat{\\sigma}^2, \\mathrm{cov}_A, \\mathrm{nlpd}_A, \\mathrm{cov}_B, \\mathrm{nlpd}_B, \\mathrm{cov}_C, \\mathrm{nlpd}_C]$.\nAll voltages must be in volts and variances in volts squared. The coverage fractions and densities are dimensionless. No additional text should be printed.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It provides a complete set of data and a clear set of tasks based on established principles of electrochemistry and statistical inference.\n\nThe solution is developed in four parts:\n1.  Derivation of the physics-based voltage model.\n2.  Estimation of the statistical error model parameters from calibration data.\n3.  Derivation of the predictive distribution and interval for new observations.\n4.  Application of the model to validation datasets to compute coverage and predictive density.\n\n**Part 1: Physics-Based Voltage Model Derivation**\n\nThe problem provides the fundamental equations for steady-state ionic transport in the electrolyte:\n- Charge conservation: $\\nabla \\cdot \\mathbf{i}_{\\mathrm{e}} = 0$\n- Ohm's law for ionic conduction: $\\mathbf{i}_{\\mathrm{e}} = -\\kappa_{\\mathrm{eff}} \\nabla \\phi_{\\mathrm{e}}$\n\nHere, $\\mathbf{i}_{\\mathrm{e}}$ is the ionic current density vector, $\\kappa_{\\mathrm{eff}}$ is the effective ionic conductivity, and $\\phi_{\\mathrm{e}}$ is the electrolyte potential. Combining these two equations yields Laplace's equation for the electric potential in the electrolyte:\n$$ \\nabla \\cdot (-\\kappa_{\\mathrm{eff}} \\nabla \\phi_{\\mathrm{e}}) = 0 $$\nAssuming constant $\\kappa_{\\mathrm{eff}}$, this simplifies to:\n$$ \\nabla^2 \\phi_{\\mathrm{e}} = 0 $$\nThe problem specifies one-dimensional conduction through the electrolyte thickness, which we can define along the $x$-axis from $x=0$ to $x=L$. The equation becomes:\n$$ \\frac{d^2 \\phi_{\\mathrm{e}}}{dx^2} = 0 $$\nIn this one-dimensional case, the current density vector $\\mathbf{i}_{\\mathrm{e}}$ has only an $x$-component, $i_{e,x}$, which is equal to the constant applied current density, $J$. Ohm's law is:\n$$ J = -\\kappa_{\\mathrm{eff}} \\frac{d\\phi_{\\mathrm{e}}}{dx} $$\nTo find the potential drop across the electrolyte, we integrate this equation from $x=0$ to $x=L$:\n$$ \\int_{\\phi_{\\mathrm{e}}(0)}^{\\phi_{\\mathrm{e}}(L)} d\\phi_{\\mathrm{e}} = \\int_{0}^{L} -\\frac{J}{\\kappa_{\\mathrm{eff}}} dx $$\n$$ \\phi_{\\mathrm{e}}(L) - \\phi_{\\mathrm{e}}(0) = -\\frac{J L}{\\kappa_{\\mathrm{eff}}} $$\nThe ohmic overpotential, $\\eta_{\\mathrm{ohmic}}$, is the magnitude of this potential drop, representing an energy loss.\n$$ \\eta_{\\mathrm{ohmic}} = |\\phi_{\\mathrm{e}}(L) - \\phi_{\\mathrm{e}}(0)| = \\frac{J L}{\\kappa_{\\mathrm{eff}}} $$\nIn addition to the bulk electrolyte resistance, there are interfacial resistances at the electrode-electrolyte boundaries. The associated potential drop, or overpotential $\\eta_{\\mathrm{interface}}$, is modeled as being proportional to the current density, with the coefficient being the total area-specific resistance, $R_{\\mathrm{ASR}}$.\n$$ \\eta_{\\mathrm{interface}} = J R_{\\mathrm{ASR}} $$\nThe terminal voltage during discharge, $V_{\\mathrm{model}}(J)$, is the equilibrium potential $U_{\\mathrm{eq}}$ reduced by all overpotentials (losses).\n$$ V_{\\mathrm{model}}(J) = U_{\\mathrm{eq}} - \\eta_{\\mathrm{ohmic}} - \\eta_{\\mathrm{interface}} $$\n$$ V_{\\mathrm{model}}(J) = U_{\\mathrm{eq}} - \\frac{J L}{\\kappa_{\\mathrm{eff}}} - J R_{\\mathrm{ASR}} $$\nThis can be written more compactly as:\n$$ V_{\\mathrm{model}}(J) = U_{\\mathrm{eq}} - J \\left( \\frac{L}{\\kappa_{\\mathrm{eff}}} + R_{\\mathrm{ASR}} \\right) $$\nUsing the given physical parameters:\n- $U_{\\mathrm{eq}} = 4.2$ V\n- $L = 1.0 \\times 10^{-4}$ m\n- $\\kappa_{\\mathrm{eff}} = 0.5$ S/m\n- $R_{\\mathrm{ASR}} = 1.0 \\times 10^{-4}$ $\\Omega \\cdot \\text{m}^2$\n\nThe total resistance term is:\n$$ R_{\\mathrm{total}} = \\frac{L}{\\kappa_{\\mathrm{eff}}} + R_{\\mathrm{ASR}} = \\frac{1.0 \\times 10^{-4} \\text{ m}}{0.5 \\text{ S/m}} + 1.0 \\times 10^{-4} \\text{ } \\Omega \\cdot \\text{m}^2 = 2.0 \\times 10^{-4} \\text{ } \\Omega \\cdot \\text{m}^2 + 1.0 \\times 10^{-4} \\text{ } \\Omega \\cdot \\text{m}^2 = 3.0 \\times 10^{-4} \\text{ } \\Omega \\cdot \\text{m}^2 $$\nSo, the final physical model is:\n$$ V_{\\mathrm{model}}(J) = 4.2 - J \\cdot (3.0 \\times 10^{-4}) $$\n\n**Part 2: Parameter Estimation**\n\nThe error model is $V_{\\mathrm{obs}} = V_{\\mathrm{model}} + \\beta + \\varepsilon$, where $\\varepsilon \\sim N(0, \\sigma^2)$. This implies the residuals $r_i = V_{\\mathrm{obs},i} - V_{\\mathrm{model},i}$ are distributed as $r_i \\sim N(\\beta, \\sigma^2)$. We use the $n=5$ calibration data points to estimate $\\beta$ and $\\sigma^2$.\n\n- Current densities $J_{\\mathrm{cal}} = [50, 100, 150, 200, 250]$ A/m$^2$.\n- Observed voltages $V_{\\mathrm{obs,cal}} = [4.171, 4.167, 4.143, 4.135, 4.109]$ V.\n\nFirst, we calculate $V_{\\mathrm{model}}$ for each calibration point:\n- $V_{\\mathrm{model}}(50) = 4.2 - 50(3 \\times 10^{-4}) = 4.185$ V\n- $V_{\\mathrm{model}}(100) = 4.2 - 100(3 \\times 10^{-4}) = 4.170$ V\n- $V_{\\mathrm{model}}(150) = 4.2 - 150(3 \\times 10^{-4}) = 4.155$ V\n- $V_{\\mathrm{model}}(200) = 4.2 - 200(3 \\times 10^{-4}) = 4.140$ V\n- $V_{\\mathrm{model}}(250) = 4.2 - 250(3 \\times 10^{-4}) = 4.125$ V\n\nNext, we calculate the residuals $r_i = V_{\\mathrm{obs},i} - V_{\\mathrm{model},i}$:\n- $r_1 = 4.171 - 4.185 = -0.014$\n- $r_2 = 4.167 - 4.170 = -0.003$\n- $r_3 = 4.143 - 4.155 = -0.012$\n- $r_4 = 4.135 - 4.140 = -0.005$\n- $r_5 = 4.109 - 4.125 = -0.016$\n\nThe unbiased estimator for the bias $\\beta$ is the sample mean of the residuals, $\\hat{\\beta} = \\bar{r}$:\n$$ \\hat{\\beta} = \\frac{1}{5} (-0.014 - 0.003 - 0.012 - 0.005 - 0.016) = \\frac{-0.050}{5} = -0.010 \\text{ V} $$\nThe unbiased estimator for the variance $\\sigma^2$ is the sample variance, $\\hat{\\sigma}^2 = s^2$:\n$$ \\hat{\\sigma}^2 = \\frac{1}{n-1} \\sum_{i=1}^n (r_i - \\bar{r})^2 = \\frac{1}{4} [(-0.004)^2 + (0.007)^2 + (-0.002)^2 + (0.005)^2 + (-0.006)^2] $$\n$$ \\hat{\\sigma}^2 = \\frac{1}{4} [1.6 \\times 10^{-5} + 4.9 \\times 10^{-5} + 0.4 \\times 10^{-5} + 2.5 \\times 10^{-5} + 3.6 \\times 10^{-5}] = \\frac{13.0 \\times 10^{-5}}{4} = 3.25 \\times 10^{-5} \\text{ V}^2 $$\n\n**Part 3: Predictive Distribution and Interval**\n\nWe need the distribution for a future residual $r_{\\mathrm{new}}$ given the calibration residuals $\\mathbf{r}$. The difference between a new residual and the sample mean of calibration residuals, $r_{\\mathrm{new}} - \\bar{r}$, has a distribution $N(0, \\sigma^2(1 + 1/n))$.\nTo form a statistic independent of the unknown $\\sigma^2$, we standardize this difference using the sample standard deviation $s = \\sqrt{\\hat{\\sigma}^2}$. The resulting quantity follows a Student's t-distribution with $n-1$ degrees of freedom:\n$$ \\frac{r_{\\mathrm{new}} - \\bar{r}}{s \\sqrt{1 + 1/n}} \\sim t_{n-1} $$\nTherefore, the predictive distribution for $r_{\\mathrm{new}}$ is a scaled and shifted t-distribution with location $\\bar{r}$, scale $s \\sqrt{1 + 1/n}$, and degrees of freedom $\\nu = n-1$:\n$$ r_{\\mathrm{new}} \\sim \\bar{r} + t_{n-1} \\cdot s \\sqrt{1 + 1/n} $$\nThe two-sided $(1-\\alpha)$ predictive interval for $r_{\\mathrm{new}}$ is:\n$$ \\left[ \\bar{r} - t_{\\alpha/2, n-1} \\cdot s \\sqrt{1 + 1/n}, \\quad \\bar{r} + t_{\\alpha/2, n-1} \\cdot s \\sqrt{1 + 1/n} \\right] $$\nFor our problem: $n=5$, $\\nu = 4$, $\\alpha = 0.05$. The critical value is $t_{0.025, 4}$.\nThe predictive interval for a new observation $V_{\\mathrm{obs,new}}$ is obtained by adding $V_{\\mathrm{model,new}}$ to the interval for $r_{\\mathrm{new}}$:\n$$ V_{\\mathrm{obs,new}} \\in V_{\\mathrm{model,new}} + \\bar{r} \\pm t_{\\alpha/2, 4} \\cdot s \\sqrt{1 + 1/5} $$\nThe probability density function (PDF) for $r_{\\mathrm{new}}$ is that of a non-standardized t-distribution $f(x; \\nu, \\mu, \\lambda)$ with parameters $\\nu=n-1$, $\\mu=\\bar{r}$, and scale $\\lambda = s \\sqrt{1+1/n}$. We use this PDF to calculate the log predictive density.\n\n**Part 4: Validation Calculations**\n\nFor each validation set, we will compute the coverage and the average negative log predictive density (NLPD). The NLPD for a set of $m$ observations is:\n$$ \\text{NLPD} = -\\frac{1}{m} \\sum_{j=1}^m \\ln p(r_{\\mathrm{obs},j} | \\mathbf{r}) $$\nwhere $p(r_{\\mathrm{obs},j} | \\mathbf{r})$ is the predictive PDF of the t-distribution evaluated at the observed residual $r_{\\mathrm{obs},j} = V_{\\mathrm{obs},j} - V_{\\mathrm{model},j}$. The computation is performed numerically in the accompanying code. The coverage is the fraction of validation points $V_{\\mathrm{obs},j}$ that fall within their respective predictive intervals. The numerical results for the validation sets are computed by the program and presented in the final answer.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t\n\ndef solve():\n    \"\"\"\n    Derives the physical model for an SSB, calibrates an error model,\n    and validates it against independent data sets.\n    \"\"\"\n    # Physical parameters\n    U_eq = 4.2  # volts\n    L = 1.0e-4  # meters\n    kappa_eff = 0.5  # siemens per meter\n    R_ASR = 1.0e-4  # ohm-square meters\n\n    # Calibration data\n    J_cal = np.array([50, 100, 150, 200, 250])  # A/m^2\n    V_obs_cal = np.array([4.171, 4.167, 4.143, 4.135, 4.109])  # volts\n\n    # Validation sets\n    validation_sets = {\n        'A': {'J': np.array([80, 160, 240]), 'V_obs': np.array([4.169, 4.137, 4.120])},\n        'B': {'J': np.array([100, 200, 300]), 'V_obs': np.array([4.141, 4.108, 4.080])},\n        'C': {'J': np.array([50, 150, 250]), 'V_obs': np.array([4.195, 4.130, 4.133])},\n    }\n\n    # Confidence level\n    alpha = 0.05\n    n_cal = len(J_cal)\n\n    # --- Step 1: Implement the physical model V_model(J) ---\n    R_total = (L / kappa_eff) + R_ASR\n    \n    def v_model(J):\n        return U_eq - J * R_total\n\n    # --- Step 2: Estimate bias and variance from calibration data ---\n    V_model_cal = v_model(J_cal)\n    residuals_cal = V_obs_cal - V_model_cal\n    \n    # Unbiased estimator for bias (mean of residuals)\n    beta_hat = np.mean(residuals_cal)\n    \n    # Unbiased estimator for variance (sample variance of residuals)\n    sigma2_hat = np.var(residuals_cal, ddof=1)\n\n    # --- Step 3 & 4: Derive predictive distribution and interval ---\n    # The predictive distribution for a new residual is a Student's t-distribution\n    df = n_cal - 1  # Degrees of freedom\n    s = np.sqrt(sigma2_hat)  # Sample standard deviation of residuals\n    \n    # Scale parameter for the predictive t-distribution\n    pred_scale = s * np.sqrt(1 + 1 / n_cal)\n    \n    # Critical value for the predictive interval\n    t_crit = t.ppf(1 - alpha / 2, df)\n    \n    # Interval half-width for a new residual\n    interval_half_width = t_crit * pred_scale\n\n    # --- Step 5: Compute metrics for each validation set ---\n    results = [beta_hat, sigma2_hat]\n\n    for key in ['A', 'B', 'C']:\n        V_set = validation_sets[key]\n        J_val = V_set['J']\n        V_obs_val = V_set['V_obs']\n        \n        m_val = len(J_val)\n        \n        # Calculate model predictions for the validation set\n        V_model_val = v_model(J_val)\n        \n        # Account for systemic bias in the prediction\n        V_pred_mean = V_model_val + beta_hat\n\n        # Calculate predictive interval for each validation point\n        pred_lower = V_pred_mean - interval_half_width\n        pred_upper = V_pred_mean + interval_half_width\n        \n        # Compute coverage fraction\n        is_covered = (V_obs_val >= pred_lower) & (V_obs_val <= pred_upper)\n        coverage_fraction = np.sum(is_covered) / m_val\n        \n        # Compute average negative log predictive density (NLPD)\n        # Residuals for the validation set\n        residuals_val = V_obs_val - V_model_val\n        \n        # Log PDF of the predictive t-distribution evaluated at the observed residuals\n        log_pdf_vals = t.logpdf(residuals_val, df, loc=beta_hat, scale=pred_scale)\n        \n        # Average NLPD\n        avg_nlpd = -np.mean(log_pdf_vals)\n        \n        results.extend([coverage_fraction, avg_nlpd])\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}