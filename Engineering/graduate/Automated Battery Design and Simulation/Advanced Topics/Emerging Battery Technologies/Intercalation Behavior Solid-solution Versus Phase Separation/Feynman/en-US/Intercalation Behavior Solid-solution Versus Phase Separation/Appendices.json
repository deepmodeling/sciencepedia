{
    "hands_on_practices": [
        {
            "introduction": "The regular solution model provides a powerful yet simple framework for understanding the thermodynamics of mixing in materials. The central principle is that a homogeneous solution is stable only when its free energy is convex with respect to composition. This practice guides you through deriving the critical temperature ($$), the threshold below which phase separation becomes possible, directly linking the microscopic interaction energy $\\Omega$ to a macroscopic property.",
            "id": "3920383",
            "problem": "An automated materials design workflow for intercalation electrodes must decide whether to activate phase-field simulation for phase separation or a simpler homogeneous model. The decision is based on the convexity of the homogeneous Helmholtz free energy per intercalation site as a function of the lithium filling fraction. Consider a host lattice with one intercalation site per lattice position, where the lithium filling fraction is $c \\in (0,1)$, the temperature is $T$, and the mean-field interaction parameter is $\\Omega  0$ (energy per site). The per-site Helmholtz free energy is modeled by the widely used regular solution form\n$$\ng(c,T) = k_{B} T \\left[c \\ln c + (1-c) \\ln (1-c)\\right] + \\Omega\\, c(1-c),\n$$\nwhere $k_{B}$ is the Boltzmann constant. In this workflow, a miscibility gap is flagged when the free energy becomes non-convex in composition, namely when there exists $c \\in (0,1)$ such that the second derivative $g''(c)  0$. Using the definition of convexity and the free energy model above, derive from first principles the closed-form expression for the highest temperature at which the free energy can be non-convex for some $c \\in (0,1)$, that is, the minimal temperature threshold separating solid-solution behavior from the possibility of phase separation. Provide this temperature as a single analytical expression in terms of $\\Omega$ and $k_{B}$. Express your final answer in Kelvin. Do not introduce any empirical fitting parameters beyond those specified. The final result must be a single closed-form analytic expression.",
            "solution": "The problem requires the derivation of the critical temperature, $T_c$, which marks the boundary between solid-solution behavior and the onset of phase separation in a host lattice for intercalation. This boundary is defined by the convexity of the Helmholtz free energy per site, $g(c,T)$, as a function of the lithium filling fraction, $c$.\n\nThe provided model for the Helmholtz free energy per site is the regular solution model:\n$$\ng(c,T) = k_{B} T \\left[c \\ln c + (1-c) \\ln (1-c)\\right] + \\Omega\\, c(1-c)\n$$\nwhere $c$ is the filling fraction, $c \\in (0,1)$, $T$ is the absolute temperature, $k_B$ is the Boltzmann constant, and $\\Omega  0$ is the mean-field interaction parameter. The first term represents the entropy of mixing, and the second term represents the enthalpy of mixing.\n\nPhase separation is thermodynamically favored when the free energy curve $g(c)$ is non-convex for some range of compositions. A function is non-convex where its second derivative is negative. The problem statement defines this condition for a miscibility gap as the existence of a composition $c \\in (0,1)$ such that the second derivative with respect to composition is negative:\n$$\n\\frac{\\partial^2 g}{\\partial c^2}  0\n$$\n\nTo find the temperature threshold, we must first compute this second derivative. We begin with the first derivative of $g(c,T)$ with respect to $c$:\n$$\n\\frac{\\partial g}{\\partial c} = \\frac{\\partial}{\\partial c} \\left( k_{B} T \\left[c \\ln c + (1-c) \\ln (1-c)\\right] + \\Omega c - \\Omega c^2 \\right)\n$$\nUsing the product rule for differentiation on the logarithmic terms:\n$$\n\\frac{\\partial g}{\\partial c} = k_{B} T \\left[ \\left(1 \\cdot \\ln c + c \\cdot \\frac{1}{c}\\right) + \\left(-1 \\cdot \\ln(1-c) + (1-c) \\cdot \\frac{-1}{1-c}\\right) \\right] + \\Omega(1 - 2c)\n$$\n$$\n\\frac{\\partial g}{\\partial c} = k_{B} T \\left[ (\\ln c + 1) - (\\ln(1-c) + 1) \\right] + \\Omega(1 - 2c)\n$$\n$$\n\\frac{\\partial g}{\\partial c} = k_{B} T \\left[ \\ln c - \\ln(1-c) \\right] + \\Omega(1 - 2c) = k_{B} T \\ln\\left(\\frac{c}{1-c}\\right) + \\Omega(1 - 2c)\n$$\nThis expression is proportional to the difference between the chemical potential of the intercalated species and the chemical potential of a vacancy.\n\nNext, we compute the second derivative, $\\frac{\\partial^2 g}{\\partial c^2}$:\n$$\n\\frac{\\partial^2 g}{\\partial c^2} = \\frac{\\partial}{\\partial c} \\left( k_{B} T \\left[ \\ln c - \\ln(1-c) \\right] + \\Omega(1 - 2c) \\right)\n$$\n$$\n\\frac{\\partial^2 g}{\\partial c^2} = k_{B} T \\left( \\frac{1}{c} - \\frac{-1}{1-c} \\right) - 2\\Omega\n$$\n$$\n\\frac{\\partial^2 g}{\\partial c^2} = k_{B} T \\left( \\frac{1}{c} + \\frac{1}{1-c} \\right) - 2\\Omega\n$$\nCombining the terms in the parenthesis:\n$$\n\\frac{\\partial^2 g}{\\partial c^2} = k_{B} T \\left( \\frac{1-c+c}{c(1-c)} \\right) - 2\\Omega = \\frac{k_{B} T}{c(1-c)} - 2\\Omega\n$$\nThe condition for non-convexity (and thus, for the possibility of phase separation) is $\\frac{\\partial^2 g}{\\partial c^2}  0$:\n$$\n\\frac{k_{B} T}{c(1-c)} - 2\\Omega  0\n$$\nRearranging this inequality to solve for the temperature $T$:\n$$\nT  \\frac{2\\Omega}{k_B} c(1-c)\n$$\nThis inequality shows that for a given temperature $T$, non-convexity occurs if there exists a composition $c \\in (0,1)$ that satisfies this condition. The problem asks for the highest temperature at which non-convexity is possible. This corresponds to the critical temperature, $T_c$. Above $T_c$, the free energy is convex for all compositions (i.e., $\\frac{\\partial^2 g}{\\partial c^2}  0$ for all $c \\in (0,1)$), meaning the material forms a solid solution at all filling fractions. Below $T_c$, there is a range of compositions where phase separation can occur.\n\nThe critical temperature $T_c$ is the boundary case. It is the highest temperature for which the inequality $T  \\frac{2\\Omega}{k_B} c(1-c)$ can be satisfied for some $c$. This requires finding the maximum value of the function $f(c) = c(1-c)$ on the interval $c \\in (0,1)$.\nLet's find the maximum of $f(c) = c - c^2$ by finding its critical points:\n$$\n\\frac{df}{dc} = 1 - 2c\n$$\nSetting the derivative to zero:\n$$\n1 - 2c = 0 \\implies c = \\frac{1}{2}\n$$\nTo confirm this is a maximum, we check the second derivative:\n$$\n\\frac{d^2f}{dc^2} = -2\n$$\nSince the second derivative is negative, $c = \\frac{1}{2}$ corresponds to a local maximum. As $f(c)$ is a downward-opening parabola, this is the global maximum on the domain $(0,1)$.\nThe maximum value of $c(1-c)$ is therefore:\n$$\nf\\left(\\frac{1}{2}\\right) = \\frac{1}{2}\\left(1-\\frac{1}{2}\\right) = \\frac{1}{4}\n$$\nThe condition for non-convexity to be possible at any composition is that the temperature $T$ must be less than the maximum value of the right-hand side of the inequality. The critical temperature $T_c$ is exactly this maximum value.\n$$\nT_c = \\frac{2\\Omega}{k_B} \\cdot \\max_{c \\in (0,1)}[c(1-c)]\n$$\nSubstituting the maximum value of $\\frac{1}{4}$:\n$$\nT_c = \\frac{2\\Omega}{k_B} \\cdot \\frac{1}{4}\n$$\n$$\nT_c = \\frac{\\Omega}{2k_B}\n$$\nThis is the highest temperature at which the free energy can be non-convex for some composition $c$. For any temperature $T  T_c$, the condition $T  \\frac{2\\Omega}{k_B} c(1-c)$ holds for all $c \\in (0,1)$, implying $\\frac{\\partial^2 g}{\\partial c^2}  0$ everywhere, and the system is a stable solid solution. For $T  T_c$, there is a continuous range of compositions around $c=\\frac{1}{2}$ for which $\\frac{\\partial^2 g}{\\partial c^2}  0$, defining the spinodal region where phase separation is spontaneous. The derived expression provides the required analytical form in terms of $\\Omega$ and $k_B$. The problem's mention of Kelvin units simply specifies the physical unit of the resulting symbolic temperature.",
            "answer": "$$\\boxed{\\frac{\\Omega}{2k_{B}}}$$"
        },
        {
            "introduction": "While thermodynamics tells us if phase separation is favorable, kinetics tells us how fast it occurs. In non-ideal systems, diffusion is driven by gradients in chemical potential, and the thermodynamic factor is the key quantity that relates these gradients to concentration. This practice ($$) involves deriving this factor from the free energy model and analyzing its behavior near the spinodal, revealing its direct connection to thermodynamic instability.",
            "id": "3920353",
            "problem": "An intercalation host used in automated battery design and simulation can often be modeled as a lattice gas with a fraction of occupied intercalation sites denoted by $c \\in (0,1)$. Assume the host is well described by the symmetric regular solution model with the Helmholtz free energy per lattice site given by\n$$\nf(c) = k_B T \\left[ c \\ln c + (1-c) \\ln(1-c) \\right] + \\Omega \\, c (1-c),\n$$\nwhere $k_B$ is the Boltzmann constant, $T$ is the absolute temperature, and $\\Omega$ is a temperature-independent interaction parameter characterizing short-range enthalpic interactions between intercalated species. Define the dimensionless interaction parameter $\\chi \\equiv \\Omega/(k_B T)$.\n\nStarting from the fundamental definition of chemical potential for a homogeneous system, $\\mu(c) = \\frac{d f}{d c}$, and the definition of the thermodynamic factor\n$$\n\\Gamma(c) = \\frac{c}{k_B T} \\frac{d \\mu}{d c},\n$$\nderive a closed-form analytic expression for $\\Gamma(c)$ in terms of $c$ and $\\chi$. Then, identify the spinodal condition based on the curvature of the free energy and discuss the behavior of $\\Gamma(c)$ as $c$ approaches the spinodal composition(s), making clear whether $\\Gamma(c)$ diverges or vanishes and what quantity diverges instead. Express your final answer as the closed-form expression for $\\Gamma(c)$ in terms of $c$ and $\\chi$. No numerical approximation or rounding is required, and no units are needed for $\\Gamma(c)$ because it is dimensionless.",
            "solution": "The problem is well-posed and scientifically grounded, resting on the standard regular solution model used in condensed matter physics and materials science. We may proceed with the solution.\n\nThe Helmholtz free energy per lattice site, $f(c)$, for a symmetric regular solution is given as:\n$$\nf(c) = k_B T \\left[ c \\ln c + (1-c) \\ln(1-c) \\right] + \\Omega \\, c (1-c)\n$$\nwhere $c$ is the fraction of occupied sites, $k_B$ is the Boltzmann constant, $T$ is the absolute temperature, and $\\Omega$ is the interaction parameter.\n\nThe chemical potential, $\\mu(c)$, is defined as the first derivative of the free energy with respect to the concentration $c$:\n$$\n\\mu(c) = \\frac{d f}{d c}\n$$\nWe compute this derivative:\n$$\n\\mu(c) = \\frac{d}{dc} \\left( k_B T \\left[ c \\ln c + (1-c) \\ln(1-c) \\right] + \\Omega (c - c^2) \\right)\n$$\nUsing the product rule for the logarithmic terms and the power rule for the interaction term:\n$$\n\\frac{d}{dc}(c \\ln c) = (1)\\ln c + c\\left(\\frac{1}{c}\\right) = \\ln c + 1\n$$\n$$\n\\frac{d}{dc}((1-c) \\ln(1-c)) = (-1)\\ln(1-c) + (1-c)\\left(\\frac{-1}{1-c}\\right) = -\\ln(1-c) - 1\n$$\n$$\n\\frac{d}{dc}(\\Omega (c - c^2)) = \\Omega (1 - 2c)\n$$\nCombining these results, the chemical potential is:\n$$\n\\mu(c) = k_B T \\left[ (\\ln c + 1) + (-\\ln(1-c) - 1) \\right] + \\Omega (1 - 2c)\n$$\n$$\n\\mu(c) = k_B T \\left[ \\ln c - \\ln(1-c) \\right] + \\Omega (1 - 2c)\n$$\n$$\n\\mu(c) = k_B T \\ln\\left(\\frac{c}{1-c}\\right) + \\Omega (1 - 2c)\n$$\nNext, we need the derivative of the chemical potential, $\\frac{d\\mu}{dc}$, to find the thermodynamic factor, $\\Gamma(c)$. This derivative is also the second derivative of the free energy, $\\frac{d^2f}{dc^2}$, which represents the curvature of the free energy surface.\n$$\n\\frac{d\\mu}{dc} = \\frac{d}{dc} \\left( k_B T \\ln\\left(\\frac{c}{1-c}\\right) + \\Omega (1 - 2c) \\right)\n$$\nThe derivative of the logarithmic part is:\n$$\n\\frac{d}{dc} \\ln\\left(\\frac{c}{1-c}\\right) = \\frac{d}{dc}(\\ln c - \\ln(1-c)) = \\frac{1}{c} - \\frac{-1}{1-c} = \\frac{1}{c} + \\frac{1}{1-c} = \\frac{1-c+c}{c(1-c)} = \\frac{1}{c(1-c)}\n$$\nThe derivative of the interaction part is:\n$$\n\\frac{d}{dc} (\\Omega (1-2c)) = -2\\Omega\n$$\nCombining these, we get:\n$$\n\\frac{d\\mu}{dc} = \\frac{k_B T}{c(1-c)} - 2\\Omega\n$$\nThe thermodynamic factor, $\\Gamma(c)$, is defined as:\n$$\n\\Gamma(c) = \\frac{c}{k_B T} \\frac{d \\mu}{d c}\n$$\nSubstituting our expression for $\\frac{d\\mu}{dc}$:\n$$\n\\Gamma(c) = \\frac{c}{k_B T} \\left( \\frac{k_B T}{c(1-c)} - 2\\Omega \\right)\n$$\nDistributing the pre-factor:\n$$\n\\Gamma(c) = \\frac{c \\cdot k_B T}{k_B T \\cdot c(1-c)} - \\frac{c \\cdot 2\\Omega}{k_B T}\n$$\n$$\n\\Gamma(c) = \\frac{1}{1-c} - \\frac{2c\\Omega}{k_B T}\n$$\nFinally, we use the definition of the dimensionless interaction parameter, $\\chi \\equiv \\Omega/(k_B T)$, to arrive at the closed-form expression for $\\Gamma(c)$:\n$$\n\\Gamma(c) = \\frac{1}{1-c} - 2\\chi c\n$$\nThis is the required expression for the thermodynamic factor.\n\nFor the second part of the problem, we analyze the spinodal condition. The boundary of the spinodal region, where phase separation becomes spontaneous, is defined by the condition that the curvature of the free energy is zero. A negative curvature, $\\frac{d^2f}{dc^2}  0$, corresponds to an unstable region.\n$$\n\\text{Spinodal condition: } \\quad \\frac{d^2f}{dc^2} = 0\n$$\nSince $\\frac{d^2f}{dc^2} = \\frac{d\\mu}{dc}$, this is equivalent to:\n$$\n\\frac{d\\mu}{dc} = \\frac{k_B T}{c(1-c)} - 2\\Omega = 0\n$$\nThis defines the spinodal compositions, $c_s$.\nNow, let's examine the behavior of $\\Gamma(c)$ as $c$ approaches a spinodal composition $c_s$. From the definition $\\Gamma(c) = \\frac{c}{k_B T} \\frac{d\\mu}{dc}$, it is clear that as $c \\rightarrow c_s$, the term $\\frac{d\\mu}{dc} \\rightarrow 0$. Therefore, the thermodynamic factor $\\Gamma(c)$ vanishes at the spinodal:\n$$\n\\lim_{c \\to c_s} \\Gamma(c) = \\frac{c_s}{k_B T} \\cdot 0 = 0\n$$\nWhile $\\Gamma(c)$ vanishes, a different quantity related to the thermodynamics of the system diverges. The susceptibility of the system to concentration fluctuations is proportional to the inverse of the free energy curvature. In statistical mechanics, the mean-square fluctuation in concentration, $\\langle (\\Delta c)^2 \\rangle$, is given by a formula involving this inverse curvature:\n$$\n\\langle (\\Delta c)^2 \\rangle \\propto \\left(\\frac{d^2f}{dc^2}\\right)^{-1}\n$$\nAt the spinodal, $\\frac{d^2f}{dc^2} = 0$. Consequently, the quantity that diverges at the spinodal is the inverse curvature of the free energy, $\\left(\\frac{d^2f}{dc^2}\\right)^{-1}$, which signifies infinite susceptibility to concentration fluctuations and the onset of phase separation. This quantity can be expressed in terms of the thermodynamic factor:\n$$\n\\left(\\frac{d^2f}{dc^2}\\right)^{-1} = \\left(\\frac{d\\mu}{dc}\\right)^{-1} = \\left(\\frac{k_B T \\Gamma(c)}{c}\\right)^{-1} = \\frac{c}{k_B T \\Gamma(c)}\n$$\nAs $c \\rightarrow c_s$, the denominator $\\Gamma(c) \\rightarrow 0$, causing the entire expression to diverge.",
            "answer": "$$\\boxed{\\frac{1}{1-c} - 2 \\chi c}$$"
        },
        {
            "introduction": "The ultimate goal of thermodynamic modeling is often to predict a material's phase diagram. For phase-separating systems, this requires finding the equilibrium compositions, which are determined by the common tangent construction on the free energy curve. This hands-on practice ($$) challenges you to translate this geometric principle into a robust numerical algorithm, a fundamental skill for automating the analysis of phase stability in materials simulation workflows.",
            "id": "3920354",
            "problem": "Construct a complete, runnable program that, given dimensionless free-energy samples of a one-component intercalation host, detects two-phase coexistence by computing the lower convex envelope of the graph of the free-energy density versus composition and verifying the common tangent conditions to identify the coexisting compositions $c_{\\alpha}$ and $c_{\\beta}$. The program must implement a numerically robust algorithm that starts from fundamental thermodynamic principles: at fixed average composition $c$, a heterogeneous system minimizes the total Gibbs free energy subject to mass conservation, and equilibrium between two homogeneous phases at compositions $c_{\\alpha}$ and $c_{\\beta}$ requires equality of the intensive chemical potential (the common tangent slope) and the supporting line lying below the free-energy curve between $c_{\\alpha}$ and $c_{\\beta}$. The algorithm must be derived from this base and implemented without shortcut formulas.\n\nDefinitions and fundamental base:\n- Let $c \\in (0,1)$ denote the dimensionless fraction of occupied intercalation sites.\n- Let $g(c)$ denote the dimensionless Gibbs free energy per site, expressed in units of thermal energy $k_{\\mathrm{B}} T$ so that $g(c)$ is unitless.\n- At fixed average composition $c$, the equilibrium state minimizes the convex envelope of $g(c)$, and two-phase coexistence is present if and only if there exists a line $y = m c + b$ with slope $m$ and intercept $b$ such that $g(c_{\\alpha}) = m c_{\\alpha} + b$, $g(c_{\\beta}) = m c_{\\beta} + b$, $g'(c_{\\alpha}) = m$, $g'(c_{\\beta}) = m$, and $g(c) \\ge m c + b$ for all $c$ in the interval $[c_{\\alpha}, c_{\\beta}]$. The set of points of tangency $(c_{\\alpha}, g(c_{\\alpha}))$ and $(c_{\\beta}, g(c_{\\beta}))$ form a segment of the lower convex envelope of $g(c)$.\n\nProgram requirements:\n- The program must sample $g(c)$ over a uniform grid of $N$ points on the open interval $(\\epsilon, 1 - \\epsilon)$, with $N \\in \\mathbb{N}$ and $\\epsilon  0$ specified by each test case.\n- The program must compute the lower convex envelope of the set of sampled points $\\{(c_i, g(c_i))\\}_{i=0}^{N-1}$ using a numerically stable geometric algorithm that operates on the ordered set by $c$ and constructs the lower convex hull (for example, a monotone chain algorithm) without relying on precomputed analytical coexistence conditions. Every decision in the algorithm must be based on the principles of convexity and the common tangent conditions.\n- The program must verify the common tangent conditions numerically at candidate endpoints $c_{\\alpha}$ and $c_{\\beta}$ identified from the lower convex envelope. Specifically, if $(c_i, g_i)$ and $(c_j, g_j)$ with $i  j$ are consecutive vertices of the lower convex envelope and $j - i  1$, then the segment between them is a candidate tie-line. The program must accept this segment as a two-phase coexistence tie-line if:\n  1. The estimated derivatives $g'(c_i)$ and $g'(c_j)$ (computed by finite differences on the grid) are equal to the segment slope $m = (g_j - g_i)/(c_j - c_i)$ within a small tolerance $\\tau_s$, i.e., $|g'(c_i) - m| \\le \\tau_s$ and $|g'(c_j) - m| \\le \\tau_s$.\n  2. For every interior grid point index $k$ with $i  k  j$, the vertical distance $g(c_k) - (g_i + m (c_k - c_i))$ is nonnegative within a small tolerance $\\tau_{\\ell}$, and strictly positive for at least one such interior index, i.e., $\\min_{ikj} \\left[g(c_k) - (g_i + m (c_k - c_i))\\right] \\ge -\\tau_{\\ell}$ and $\\max_{ikj} \\left[g(c_k) - (g_i + m (c_k - c_i))\\right]  \\tau_{\\ell}$. These conditions ensure the line is a supporting line that touches only at the endpoints and lies below the curve between them.\n- If multiple tie-lines satisfy the conditions, the program must select the first such segment encountered when scanning hull edges from low to high $c$.\n- If no tie-line is found, the program must output the empty list to indicate no phase coexistence.\n\nFree-energy models for the test suite:\n- Regular solution model for intercalation:\n  $$g(c) = c \\ln c + (1 - c) \\ln (1 - c) + \\omega c (1 - c) + \\delta c,$$\n  where $\\omega$ is the dimensionless interaction parameter and $\\delta$ is a dimensionless linear bias that breaks symmetry. The derivative is $g'(c) = \\ln\\left(\\frac{c}{1-c}\\right) + \\omega (1 - 2 c) + \\delta$ and the second derivative is $g''(c) = \\frac{1}{c} + \\frac{1}{1-c} - 2 \\omega$.\n- Landau-type double-well model:\n  $$g(c) = a (c - c_0)^4 - b (c - c_0)^2,$$\n  where $a  0$, $b  0$, and $c_0 \\in (0,1)$.\n\nNumerical details:\n- The program must use a uniform grid $c_i = \\epsilon + \\frac{i}{N-1} (1 - 2 \\epsilon)$ for $i \\in \\{0, 1, \\dots, N-1\\}$.\n- The finite-difference approximation for $g'(c_i)$ should use a central difference for interior points and one-sided differences at the boundaries.\n- The tolerances must be chosen to avoid false positives near marginal convexity. Use $\\tau_s = 5 \\times 10^{-3}$ and $\\tau_{\\ell} = 1 \\times 10^{-5}$.\n\nTest suite:\nProvide the following $5$ test cases, each specifying the free-energy model and parameters. For each case, report the result as either the empty list (no coexistence) or a list containing the two coexisting compositions $[c_{\\alpha}, c_{\\beta}]$, rounded to $4$ decimal places, as decimals without any physical unit.\n1. Regular solution, $\\omega = 1.0$, $\\delta = 0.0$, $N = 1001$, $\\epsilon = 10^{-9}$.\n2. Regular solution, $\\omega = 3.0$, $\\delta = 0.0$, $N = 2001$, $\\epsilon = 10^{-9}$.\n3. Regular solution, $\\omega = 3.0$, $\\delta = 0.2$, $N = 2001$, $\\epsilon = 10^{-9}$.\n4. Regular solution, $\\omega = 2.0$, $\\delta = 0.0$, $N = 2001$, $\\epsilon = 10^{-9}$.\n5. Landau double well, $a = 10.0$, $b = 1.0$, $c_0 = 0.5$, $N = 1001$, $\\epsilon = 0.0$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case's result must itself be either an empty list or a two-element list of floats rounded to $4$ decimal places. For example, a possible output line could be $[\\,[0.2764,0.7236],[],[0.2100,0.7900],[],[0.2764,0.7236]\\,]$. There must be no additional text printed.\n\nAll quantities are dimensionless, so no physical units are required. All angles are irrelevant, and no angle units are used. All numbers reported must be decimals, not percentages.",
            "solution": "The problem requires the development of a numerical algorithm to detect two-phase coexistence in a one-component intercalation system. This is achieved by analyzing the dimensionless Gibbs free energy per site, $g(c)$, as a function of the dimensionless composition, $c \\in (0,1)$. The fundamental thermodynamic principle guiding this analysis is that an equilibrium system at constant temperature and pressure minimizes its total Gibbs free energy.\n\nWhen the free energy function $g(c)$ is convex, i.e., $g''(c) > 0$ for all $c$, the system exists as a single, homogeneous solid solution at any average composition. However, if $g(c)$ has a region of non-convexity, i.e., $g''(c)  0$, it is energetically favorable for the system to phase-separate into two distinct phases with compositions $c_{\\alpha}$ and $c_{\\beta}$. These compositions are determined by the common tangent construction. The total free energy of this heterogeneous mixture lies on the straight line segment connecting the points $(c_{\\alpha}, g(c_{\\alpha}))$ and $(c_{\\beta}, g(c_{\\beta}))$ on the free energy curve. For this state to be the minimum energy state, this line segment, known as a tie-line, must be a supporting line for the function $g(c)$, meaning the function $g(c)$ must lie on or above this line for all $c \\in [c_{\\alpha}, c_{\\beta}]$.\n\nThis geometric condition is equivalent to the thermodynamic condition for phase equilibrium: the chemical potential, $\\mu(c)$, which is the derivative of the Gibbs free energy per site, $\\mu(c) = g'(c)$, must be equal in the two coexisting phases.\n$$\n\\mu(c_{\\alpha}) = \\mu(c_{\\beta})\n$$\nThe common value of the chemical potential is equal to the slope, $m$, of the common tangent line.\n$$\nm = g'(c_{\\alpha}) = g'(c_{\\beta}) = \\frac{g(c_{\\beta}) - g(c_{\\alpha})}{c_{\\beta} - c_{\\alpha}}\n$$\nThe set of all such tie-lines for a given function $g(c)$ forms the lower convex envelope of the graph of $g(c)$. If the lower convex envelope of $g(c)$ is identical to $g(c)$ itself, no phase separation occurs. If they differ over some interval $[c_{\\alpha}, c_{\\beta}]$, then phase separation occurs, and the compositions of the coexisting phases are precisely $c_{\\alpha}$ and $c_{\\beta}$.\n\nThe algorithmic approach to solve this problem is as follows:\n\n1.  **Discretization and Function Evaluation**: The continuous free-energy function $g(c)$ is sampled on a discrete, uniform grid of $N$ points, $\\{c_i\\}_{i=0}^{N-1}$, over the interval $(\\epsilon, 1-\\epsilon)$, where $c_i = \\epsilon + \\frac{i}{N-1} (1 - 2\\epsilon)$. This generates a set of discrete points $\\{(c_i, g_i)\\}_{i=0}^{N-1}$, where $g_i = g(c_i)$.\n\n2.  **Lower Convex Hull Computation**: The lower convex envelope of the continuous function is approximated by the lower convex hull of the set of sampled points. A numerically stable and efficient method for this is the monotone chain algorithm (a variant of Andrew's algorithm). This algorithm processes the points, which are already sorted by their $c$-coordinate, and builds the lower hull by maintaining a chain of vertices that always exhibits a \"left turn\" or remains collinear. For three consecutive points $p_1, p_2, p_3$ sorted by their $c$-coordinate, a left turn is identified if the $z$-component of the cross product of the vectors $\\vec{p_1 p_2}$ and $\\vec{p_1 p_3}$ is non-negative. If adding a new point $p_3$ to a chain ending in $p_1, p_2$ results in a right turn, the point $p_2$ is not part of the lower hull and is removed from the chain. This process is repeated until the chain property is restored, after which $p_3$ is added.\n\n3.  **Tie-Line Identification and Verification**: The vertices of the computed lower convex hull provide candidate tie-lines. A tie-line corresponding to phase separation exists if two non-consecutive grid points $(c_i, g_i)$ and $(c_j, g_j)$ (where the indices satisfy $j - i  1$) become consecutive vertices on the lower convex hull. Each such segment is a candidate that must be rigorously verified against the thermodynamic conditions using the provided numerical tolerances.\n\n    a.  **Numerical Derivative**: The derivative $g'(c)$ is approximated at each grid point $c_i$ using finite differences. A central difference scheme, $g'(c_i) \\approx \\frac{g_{i+1} - g_{i-1}}{c_{i+1} - c_{i-1}}$, is used for interior points ($0  i  N-1$), while one-sided forward and backward differences are used at the grid boundaries $c_0$ and $c_{N-1}$, respectively.\n\n    b.  **Slope Condition**: The slope of the candidate tie-line, $m = \\frac{g_j - g_i}{c_j - c_i}$, must match the numerical derivatives at the endpoints within a tolerance $\\tau_s = 5 \\times 10^{-3}$. That is, $|g'(c_i) - m| \\le \\tau_s$ and $|g'(c_j) - m| \\le \\tau_s$.\n\n    c.  **Supporting Line Condition**: The line segment must lie below or on the free energy curve for all intermediate grid points. This is checked by ensuring that the vertical distance from each point $(c_k, g_k)$ with $i  k  j$ to the line is non-negative, within a tolerance $\\tau_{\\ell} = 1 \\times 10^{-5}$. Formally, $\\min_{ikj} \\left[ g_k - (g_i + m(c_k - c_i)) \\right] \\ge -\\tau_{\\ell}$. To exclude trivial cases of a flat curve segment, it is also required that at least one intermediate point lies strictly above the line: $\\max_{ikj} \\left[ g_k - (g_i + m(c_k - c_i)) \\right]  \\tau_{\\ell}$.\n\n4.  **Result Selection**: The problem specifies that if multiple tie-lines satisfy these conditions, the first one encountered while scanning the hull edges from lower to higher composition $c$ is to be selected. If no segment satisfies all conditions, the system is a single-phase solid solution across the entire composition range, and the result is an empty list. Otherwise, the result is the list $[c_i, c_j]$ corresponding to the identified coexisting phase compositions.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to process test cases for phase coexistence detection.\n    \"\"\"\n\n    def g_regular(c, omega, delta):\n        \"\"\"Regular solution model free energy.\"\"\"\n        # Handle endpoints to avoid log(0) if they are on the grid.\n        # Although problem states c is in (epsilon, 1-epsilon), a very small epsilon\n        # can lead to floating point issues.\n        c = np.clip(c, 1e-12, 1 - 1e-12)\n        term1 = c * np.log(c)\n        term2 = (1 - c) * np.log(1 - c)\n        term3 = omega * c * (1 - c)\n        term4 = delta * c\n        return term1 + term2 + term3 + term4\n\n    def g_landau(c, a, b, c0):\n        \"\"\"Landau-type double-well model free energy.\"\"\"\n        return a * (c - c0)**4 - b * (c - c0)**2\n\n    def compute_derivative(g, h):\n        \"\"\"Computes the numerical derivative using finite differences.\"\"\"\n        N = len(g)\n        dg = np.zeros(N)\n        # Forward difference for the first point\n        dg[0] = (g[1] - g[0]) / h\n        # Backward difference for the last point\n        dg[-1] = (g[-1] - g[-2]) / h\n        # Central difference for interior points\n        for i in range(1, N - 1):\n            dg[i] = (g[i+1] - g[i-1]) / (2 * h)\n        return dg\n\n    def lower_convex_hull(points):\n        \"\"\"\n        Computes the lower convex hull of a set of 2D points using a monotone chain algorithm.\n        Points are expected to be pre-sorted by their x-coordinate.\n        Returns the indices of the points on the lower hull.\n        \"\"\"\n        if len(points) = 2:\n            return list(range(len(points)))\n\n        lower = []\n        for i in range(len(points)):\n            p_i = points[i]\n            # While the last segment of the hull makes a \"right turn\" or is vertical, pop the last point.\n            # A non-left turn (right or collinear) has a cross product = 0.\n            # We must handle floating point arithmetic carefully.\n            while len(lower) = 2:\n                p_prev1_idx = lower[-1]\n                p_prev2_idx = lower[-2]\n                p_prev1 = points[p_prev1_idx]\n                p_prev2 = points[p_prev2_idx]\n                \n                # Cross product: (x2-x1)(y3-y1) - (y2-y1)(x3-x1)\n                # For lower hull, we want this to be = 0 (left turn or collinear).\n                # We pop if it's  0 (right turn).\n                cross_product = (p_prev1[0] - p_prev2[0]) * (p_i[1] - p_prev2[1]) - \\\n                                (p_prev1[1] - p_prev2[1]) * (p_i[0] - p_prev2[0])\n                if cross_product  -1e-12: # Tolerance for floating point\n                    lower.pop()\n                else:\n                    break\n            lower.append(i)\n        return lower\n\n    def find_coexistence(c_grid, g_grid, N, tau_s, tau_l):\n        \"\"\"\n        Main logic to find coexisting phases for a given energy landscape.\n        \"\"\"\n        if N  3:\n            return []\n\n        h = c_grid[1] - c_grid[0]\n        dg_dc = compute_derivative(g_grid, h)\n        \n        points = list(zip(c_grid, g_grid))\n        hull_indices = lower_convex_hull(points)\n\n        for k in range(len(hull_indices) - 1):\n            i = hull_indices[k]\n            j = hull_indices[k+1]\n\n            if j - i = 1:\n                continue  # Not a tie-line over intermediate points\n\n            c_i, g_i = c_grid[i], g_grid[i]\n            c_j, g_j = c_grid[j], g_grid[j]\n            \n            # Avoid division by zero, though unlikely with distinct hull points\n            if abs(c_j - c_i)  1e-12:\n                continue\n\n            m = (g_j - g_i) / (c_j - c_i) # Slope of the candidate tie-line\n\n            # 1. Verify slope condition\n            slope_cond_i = abs(dg_dc[i] - m) = tau_s\n            slope_cond_j = abs(dg_dc[j] - m) = tau_s\n            \n            if not (slope_cond_i and slope_cond_j):\n                continue\n\n            # 2. Verify supporting line condition\n            vertical_distances = []\n            for l_idx in range(i + 1, j):\n                g_line = g_i + m * (c_grid[l_idx] - c_i)\n                distance = g_grid[l_idx] - g_line\n                vertical_distances.append(distance)\n            \n            if not vertical_distances: # Should not happen if j - i  1\n                continue\n                \n            min_dist = min(vertical_distances)\n            max_dist = max(vertical_distances)\n            \n            support_cond_min = min_dist = -tau_l\n            support_cond_max = max_dist  tau_l\n\n            if support_cond_min and support_cond_max:\n                c_alpha = round(c_i, 4)\n                c_beta = round(c_j, 4)\n                return [c_alpha, c_beta]\n        \n        return []\n\n    test_cases = [\n        {'model': 'regular', 'params': {'omega': 1.0, 'delta': 0.0}, 'N': 1001, 'epsilon': 1e-9},\n        {'model': 'regular', 'params': {'omega': 3.0, 'delta': 0.0}, 'N': 2001, 'epsilon': 1e-9},\n        {'model': 'regular', 'params': {'omega': 3.0, 'delta': 0.2}, 'N': 2001, 'epsilon': 1e-9},\n        {'model': 'regular', 'params': {'omega': 2.0, 'delta': 0.0}, 'N': 2001, 'epsilon': 1e-9},\n        {'model': 'landau', 'params': {'a': 10.0, 'b': 1.0, 'c0': 0.5}, 'N': 1001, 'epsilon': 0.0},\n    ]\n\n    tau_s = 5e-3\n    tau_l = 1e-5\n    results = []\n\n    for case in test_cases:\n        N = case['N']\n        epsilon = case['epsilon']\n        \n        c = np.linspace(epsilon, 1 - epsilon, N)\n        \n        if case['model'] == 'regular':\n            g = g_regular(c, **case['params'])\n        elif case['model'] == 'landau':\n            g = g_landau(c, **case['params'])\n        \n        result = find_coexistence(c, g, N, tau_s, tau_l)\n        results.append(result)\n\n    # Format the final output string as required.\n    # `str()` on a list produces the correct string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}