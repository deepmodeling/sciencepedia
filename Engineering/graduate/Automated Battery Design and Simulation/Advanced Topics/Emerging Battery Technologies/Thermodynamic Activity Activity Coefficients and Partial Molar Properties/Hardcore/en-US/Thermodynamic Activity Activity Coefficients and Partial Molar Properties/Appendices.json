{
    "hands_on_practices": [
        {
            "introduction": "Understanding the non-ideal behavior of mixtures is central to modeling battery systems, particularly the solvent blends in electrolytes. This exercise provides foundational practice in deriving the activity coefficients for individual components from a single, unified expression for the molar excess Gibbs energy, the Redlich–Kister series. By starting from this master function, you will see how thermodynamic consistency, as dictated by the Gibbs–Duhem relation, is intrinsically satisfied. ",
            "id": "3957123",
            "problem": "An automated battery design and simulation workflow calibrates the nonideal mixing behavior of a binary solvent blend used in a lithium-ion cell electrolyte at fixed temperature and pressure. Let the mixture be composed of component $1$ and component $2$ with mole fractions $x_1$ and $x_2$, where $x_1 + x_2 = 1$ and $0 < x_1 < 1$. The molar excess Gibbs free energy $g^{E}(x_1)$ at the given temperature and pressure is represented by the Redlich–Kister series\n$$\n\\frac{g^{E}(x_1)}{R T} \\;=\\; \\sum_{k=0}^{K} A_k \\, x_1 \\, x_2 \\, (x_1 - x_2)^{k},\n$$\nwhere $R$ is the universal gas constant, $T$ is the absolute temperature, $A_k$ are composition-independent dimensionless parameters at the specified $T$ and $P$, and $K$ is a nonnegative integer. \n\nStarting only from the definitions of chemical potential, partial molar properties, thermodynamic activity and activity coefficients, and the Gibbs–Duhem relation at constant temperature and pressure, derive closed-form expressions for the natural logarithms of the activity coefficients $\\ln \\gamma_1(x_1)$ and $\\ln \\gamma_2(x_1)$ implied by the above $g^{E}(x_1)$, expressed solely in terms of $x_1$, $x_2$, the integer index $k$, and the parameters $A_k$. Then verify that the resulting $\\ln \\gamma_1(x_1)$ and $\\ln \\gamma_2(x_1)$ satisfy Gibbs–Duhem consistency at constant temperature and pressure.\n\nYour final answer must be the ordered pair $\\big(\\ln \\gamma_1(x_1), \\ln \\gamma_2(x_1)\\big)$ as a single closed-form analytic expression. No numerical evaluation is required and no rounding is needed. Express the final answer without units.",
            "solution": "The problem requires the derivation of expressions for the activity coefficients of a binary mixture from its molar excess Gibbs free energy, $g^E$, and a subsequent verification of their thermodynamic consistency via the Gibbs–Duhem relation.\n\nFirst, we establish the fundamental thermodynamic relationships. The chemical potential of component $i$ in a non-ideal mixture, $\\mu_i$, is related to its activity, $a_i$, by the definition $\\mu_i = \\mu_i^\\circ + RT \\ln a_i$, where $\\mu_i^\\circ$ is the chemical potential in a standard state. The activity is expressed as the product of mole fraction, $x_i$, and the activity coefficient, $\\gamma_i$, so $a_i = \\gamma_i x_i$. This leads to $\\mu_i = \\mu_i^\\circ + RT \\ln x_i + RT \\ln \\gamma_i$. The chemical potential for an ideal mixture is $\\mu_i^{id} = \\mu_i^\\circ + RT \\ln x_i$. The excess chemical potential, $\\mu_i^E$, is defined as the difference $\\mu_i^E = \\mu_i - \\mu_i^{id} = RT \\ln \\gamma_i$.\n\nThe excess chemical potential, $\\mu_i^E$, is identical to the partial molar excess Gibbs free energy, $\\bar{g}_i^E$. Thus, we have the key relation:\n$$\n\\ln \\gamma_i = \\frac{\\bar{g}_i^E}{R T}\n$$\nThe partial molar property $\\bar{g}_i^E$ is related to the total molar excess Gibbs free energy of the mixture, $g^E$. For a binary mixture, the molar excess Gibbs free energy is given by the summation rule:\n$$\ng^E = x_1 \\bar{g}_1^E + x_2 \\bar{g}_2^E\n$$\nAt constant temperature $T$ and pressure $P$, the Gibbs–Duhem equation for excess properties dictates:\n$$\nx_1 d\\bar{g}_1^E + x_2 d\\bar{g}_2^E = 0\n$$\nSince $x_1 + x_2 = 1$, we have $x_2 = 1 - x_1$ and $dx_2 = -dx_1$. The Gibbs–Duhem equation can be written in terms of a single independent variable, $x_1$:\n$$\nx_1 \\frac{d\\bar{g}_1^E}{dx_1} + x_2 \\frac{d\\bar{g}_2^E}{dx_1} = 0\n$$\nTo find expressions for $\\bar{g}_1^E$ and $\\bar{g}_2^E$ in terms of $g^E$ and its derivatives, we differentiate the summation rule for $g^E$ with respect to $x_1$:\n$$\n\\frac{dg^E}{dx_1} = \\frac{d}{dx_1}(x_1 \\bar{g}_1^E + (1-x_1)\\bar{g}_2^E) = \\bar{g}_1^E + x_1 \\frac{d\\bar{g}_1^E}{dx_1} - \\bar{g}_2^E + (1-x_1)\\frac{d\\bar{g}_2^E}{dx_1}\n$$\n$$\n\\frac{dg^E}{dx_1} = \\bar{g}_1^E - \\bar{g}_2^E + x_1 \\frac{d\\bar{g}_1^E}{dx_1} + x_2 \\frac{d\\bar{g}_2^E}{dx_1}\n$$\nInvoking the Gibbs–Duhem relation, the last two terms sum to zero, which simplifies the above to:\n$$\n\\frac{dg^E}{dx_1} = \\bar{g}_1^E - \\bar{g}_2^E\n$$\nWe now solve the system of two linear equations for $\\bar{g}_1^E$ and $\\bar{g}_2^E$:\n1. $g^E = x_1 \\bar{g}_1^E + x_2 \\bar{g}_2^E$\n2. $\\frac{dg^E}{dx_1} = \\bar{g}_1^E - \\bar{g}_2^E$\n\nFrom (2), $\\bar{g}_2^E = \\bar{g}_1^E - \\frac{dg^E}{dx_1}$. Substituting this into (1):\n$g^E = x_1 \\bar{g}_1^E + x_2 (\\bar{g}_1^E - \\frac{dg^E}{dx_1}) = (x_1+x_2)\\bar{g}_1^E - x_2 \\frac{dg^E}{dx_1} = \\bar{g}_1^E - x_2 \\frac{dg^E}{dx_1}$.\nThis yields the expression for $\\bar{g}_1^E$:\n$$\n\\bar{g}_1^E = g^E + x_2 \\frac{dg^E}{dx_1}\n$$\nSimilarly, substituting $\\bar{g}_1^E = \\bar{g}_2^E + \\frac{dg^E}{dx_1}$ into (1) gives the expression for $\\bar{g}_2^E$:\n$$\n\\bar{g}_2^E = g^E - x_1 \\frac{dg^E}{dx_1}\n$$\nDividing by $RT$, we obtain the expressions for the natural logarithm of the activity coefficients:\n$$\n\\ln \\gamma_1 = \\frac{g^E}{RT} + x_2 \\frac{d(g^E/RT)}{dx_1}\n$$\n$$\n\\ln \\gamma_2 = \\frac{g^E}{RT} - x_1 \\frac{d(g^E/RT)}{dx_1}\n$$\nThe problem provides the Redlich–Kister series for $g^E$:\n$$\n\\frac{g^{E}(x_1)}{R T} \\;=\\; \\sum_{k=0}^{K} A_k \\, x_1 \\, x_2 \\, (x_1 - x_2)^{k}\n$$\nLet's define $f(x_1) = \\frac{g^E}{RT}$. To facilitate differentiation, we express $f(x_1)$ purely in terms of $x_1$:\n$f(x_1) = x_1(1-x_1) \\sum_{k=0}^{K} A_k (2x_1 - 1)^k$.\nWe must now calculate the derivative $f'(x_1) = \\frac{df}{dx_1}$. Using the product rule:\n$$\nf'(x_1) = \\frac{d}{dx_1}\\left[x_1(1-x_1)\\right] \\sum_{k=0}^{K} A_k (2x_1 - 1)^k + x_1(1-x_1) \\frac{d}{dx_1}\\left[\\sum_{k=0}^{K} A_k (2x_1 - 1)^k\\right]\n$$\n$$\nf'(x_1) = (1-2x_1) \\sum_{k=0}^{K} A_k (2x_1 - 1)^k + x_1(1-x_1) \\sum_{k=0}^{K} A_k \\cdot k(2x_1 - 1)^{k-1} \\cdot 2\n$$\nNow we substitute $f(x_1)$ and $f'(x_1)$ into the expression for $\\ln \\gamma_1$.\n$$\n\\ln \\gamma_1 = f(x_1) + x_2 f'(x_1) = f(x_1) + (1-x_1)f'(x_1)\n$$\n$$\n\\ln \\gamma_1 = x_1(1-x_1) \\sum_{k=0}^{K} A_k (2x_1 - 1)^k + (1-x_1) \\left[ (1-2x_1) \\sum_{k=0}^{K} A_k (2x_1-1)^k + 2kx_1(1-x_1) \\sum_{k=0}^{K} A_k (2x_1-1)^{k-1} \\right]\n$$\nWe analyze the contribution from a single term $k$ of the series:\nLet $\\ln \\gamma_{1,k}$ be the contribution to $\\ln \\gamma_1$ from the term with coefficient $A_k$.\n$$\n\\ln \\gamma_{1,k} = A_k \\left( x_1(1-x_1)(2x_1-1)^k + (1-x_1) \\left[ (1-2x_1)(2x_1-1)^k + 2kx_1(1-x_1)(2x_1-1)^{k-1} \\right] \\right)\n$$\nFactor out $A_k (1-x_1)$:\n$$\n\\ln \\gamma_{1,k} = A_k (1-x_1) \\left[ x_1(2x_1-1)^k + (1-2x_1)(2x_1-1)^k + 2kx_1(1-x_1)(2x_1-1)^{k-1} \\right]\n$$\nThe first two terms inside the bracket combine: $x_1(2x_1-1)^k + (1-2x_1)(2x_1-1)^k = (x_1 + 1 - 2x_1)(2x_1-1)^k = (1-x_1)(2x_1-1)^k$.\n$$\n\\ln \\gamma_{1,k} = A_k (1-x_1) \\left[ (1-x_1)(2x_1-1)^k + 2kx_1(1-x_1)(2x_1-1)^{k-1} \\right]\n$$\nFactor out $(1-x_1)$ again:\n$$\n\\ln \\gamma_{1,k} = A_k (1-x_1)^2 \\left[ (2x_1-1)^k + 2kx_1(2x_1-1)^{k-1} \\right]\n$$\nSubstituting $x_2 = 1-x_1$ and $x_1 - x_2 = 2x_1 - 1$, and summing over $k$:\n$$\n\\ln \\gamma_1(x_1) = \\sum_{k=0}^{K} A_k x_2^2 \\left[ (x_1 - x_2)^k + 2k x_1 (x_1 - x_2)^{k-1} \\right]\n$$\nNext, we derive the expression for $\\ln \\gamma_2$:\n$$\n\\ln \\gamma_2 = f(x_1) - x_1 f'(x_1)\n$$\nAgain, we analyze the contribution from a single term $k$:\n$$\n\\ln \\gamma_{2,k} = A_k \\left( x_1(1-x_1)(2x_1-1)^k - x_1 \\left[ (1-2x_1)(2x_1-1)^k + 2kx_1(1-x_1)(2x_1-1)^{k-1} \\right] \\right)\n$$\nFactor out $A_k x_1$:\n$$\n\\ln \\gamma_{2,k} = A_k x_1 \\left[ (1-x_1)(2x_1-1)^k - (1-2x_1)(2x_1-1)^k - 2kx_1(1-x_1)(2x_1-1)^{k-1} \\right]\n$$\nThe first two terms inside the bracket combine: $(1-x_1 - (1-2x_1))(2x_1-1)^k = (1-x_1-1+2x_1)(2x_1-1)^k = x_1(2x_1-1)^k$.\n$$\n\\ln \\gamma_{2,k} = A_k x_1 \\left[ x_1(2x_1-1)^k - 2kx_1(1-x_1)(2x_1-1)^{k-1} \\right]\n$$\nFactor out $x_1$ again:\n$$\n\\ln \\gamma_{2,k} = A_k x_1^2 \\left[ (2x_1-1)^k - 2k(1-x_1)(2x_1-1)^{k-1} \\right]\n$$\nSubstituting $x_2=1-x_1$ and $x_1 - x_2 = 2x_1 - 1$, and summing over $k$:\n$$\n\\ln \\gamma_2(x_1) = \\sum_{k=0}^{K} A_k x_1^2 \\left[ (x_1 - x_2)^k - 2k x_2 (x_1 - x_2)^{k-1} \\right]\n$$\nFinally, we must verify that the resulting expressions for $\\ln \\gamma_1$ and $\\ln \\gamma_2$ satisfy Gibbs–Duhem consistency. As shown in the initial derivation, the relationships $\\bar{g}_1^E = g^E + x_2 \\frac{dg^E}{dx_1}$ and $\\bar{g}_2^E = g^E - x_1 \\frac{dg^E}{dx_1}$ are themselves direct consequences of the Gibbs–Duhem equation. Any pair of partial molar properties derived using these relationships from a continuous and differentiable function $g^E(x_1)$ is mathematically guaranteed to be consistent with the Gibbs–Duhem equation. To demonstrate this explicitly, we showed that $\\frac{d\\bar{g}_1^E}{dx_1} = x_2 \\frac{d^2 g^E}{dx_1^2}$ and $\\frac{d\\bar{g}_2^E}{dx_1} = -x_1 \\frac{d^2 g^E}{dx_1^2}$. Substituting these into the Gibbs–Duhem equation (divided by $dx_1$):\n$$\nx_1 \\frac{d\\bar{g}_1^E}{dx_1} + x_2 \\frac{d\\bar{g}_2^E}{dx_1} = x_1 \\left(x_2 \\frac{d^2 g^E}{dx_1^2}\\right) + x_2 \\left(-x_1 \\frac{d^2 g^E}{dx_1^2}\\right) = x_1 x_2 \\frac{d^2 g^E}{dx_1^2} - x_1 x_2 \\frac{d^2 g^E}{dx_1^2} = 0\n$$\nThis holds for any valid $g^E$ function, including the given Redlich–Kister series. Thus, the derived expressions for $\\ln \\gamma_1$ and $\\ln \\gamma_2$ are thermodynamically consistent.\n\nThe final expressions for the natural logarithms of the activity coefficients are:\nFor component 1:\n$$\n\\ln \\gamma_1(x_1) = x_2^2 \\sum_{k=0}^{K} A_k \\left[ (x_1 - x_2)^k + 2k x_1 (x_1 - x_2)^{k-1} \\right]\n$$\nFor component 2:\n$$\n\\ln \\gamma_2(x_1) = x_1^2 \\sum_{k=0}^{K} A_k \\left[ (x_1 - x_2)^k - 2k x_2 (x_1 - x_2)^{k-1} \\right]\n$$\nThese can be combined into an ordered pair as requested.",
            "answer": "$$\n\\boxed{\\left( x_2^2 \\sum_{k=0}^{K} A_k \\left[ (x_1 - x_2)^k + 2k x_1 (x_1 - x_2)^{k-1} \\right], \\; x_1^2 \\sum_{k=0}^{K} A_k \\left[ (x_1 - x_2)^k - 2k x_2 (x_1 - x_2)^{k-1} \\right] \\right)}\n$$"
        },
        {
            "introduction": "The performance of a battery is critically dependent on how ions move through the electrolyte, a process governed by gradients in chemical potential. This practice problem transitions from general theory to a specific, quantitative application by asking you to calculate the thermodynamic factor, $\\Gamma$. This crucial parameter quantifies how non-ideal interactions, captured by a model like the Davies equation for the activity coefficient, modify the driving force for salt diffusion compared to an ideal solution. ",
            "id": "3957132",
            "problem": "An automated battery design and simulation engine for an aqueous lithium-ion cell requires the thermodynamic factor to evaluate the chemical potential-driven salt transport in the electrolyte under concentrated solution theory. Consider a fully dissociated $\\mathrm{1:1}$ electrolyte at $T=298\\,\\mathrm{K}$ with salt molality $m=0.30\\,\\mathrm{mol\\,kg^{-1}}$. The mean molal activity coefficient $\\gamma_{\\pm}$ is to be modeled by the Davies equation with the temperature-dependent coefficient $A=0.509$ (appropriate for water at $T=298\\,\\mathrm{K}$). The ionic strength $I$ is defined by the standard expression for electrolytes. Use fundamental definitions of activity and chemical potential to construct the thermodynamic factor\n$$\\Gamma=1+\\frac{\\partial \\ln\\gamma_{\\pm}}{\\partial \\ln m},$$\nand evaluate it numerically for the specified electrolyte and conditions. Interpret physically how the computed value of $\\Gamma$ modifies the salt diffusion driving force in the concentrated solution framework. Round your final numerical value of $\\Gamma$ to four significant figures. Express the final answer as a dimensionless number.",
            "solution": "The thermodynamic factor, $\\Gamma$, is defined as:\n$$\n\\Gamma = 1 + \\frac{\\partial \\ln\\gamma_{\\pm}}{\\partial \\ln m}\n$$\nwhere $\\gamma_{\\pm}$ is the mean molal activity coefficient and $m$ is the molality of the salt.\n\nFirst, we must express the mean molal activity coefficient, $\\gamma_{\\pm}$, as a function of molality, $m$. The problem specifies the use of the Davies equation:\n$$\n\\log_{10}(\\gamma_{\\pm}) = -A |z_+ z_-| \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right)\n$$\nHere, $A$ is a constant, $z_+$ and $z_-$ are the charge numbers of the cation and anion, respectively, and $I$ is the ionic strength of the solution.\n\nFor the specified fully dissociated $1:1$ electrolyte, we have $z_+ = +1$ and $z_- = -1$, so $|z_+ z_-| = 1$. The ionic strength $I$ is defined as $I = \\frac{1}{2} \\sum_i m_i z_i^2$, where $m_i$ is the molality of ion $i$. For a $1:1$ electrolyte of molality $m$, the molality of the cation is $m_+ = m$ and that of the anion is $m_- = m$. Therefore, the ionic strength is:\n$$\nI = \\frac{1}{2} (m \\cdot (1)^2 + m \\cdot (-1)^2) = \\frac{1}{2}(m+m) = m\n$$\nThus, for this specific case, the ionic strength is equal to the molality. Substituting $I=m$ and $|z_+ z_-|=1$ into the Davies equation gives:\n$$\n\\log_{10}(\\gamma_{\\pm}) = -A \\left( \\frac{\\sqrt{m}}{1+\\sqrt{m}} - 0.3 m \\right)\n$$\nTo perform the derivative with respect to the natural logarithm, it is convenient to convert the base-$10$ logarithm to a natural logarithm using the identity $\\ln(x) = \\ln(10) \\log_{10}(x)$:\n$$\n\\ln(\\gamma_{\\pm}) = -A \\ln(10) \\left( \\frac{\\sqrt{m}}{1+\\sqrt{m}} - 0.3 m \\right)\n$$\nNow, we must compute the derivative term $\\frac{\\partial \\ln\\gamma_{\\pm}}{\\partial \\ln m}$. We can use the chain rule relationship $\\frac{\\partial f}{\\partial \\ln x} = x \\frac{\\partial f}{\\partial x}$. In our case, $f = \\ln(\\gamma_{\\pm})$ and $x=m$:\n$$\n\\frac{\\partial \\ln\\gamma_{\\pm}}{\\partial \\ln m} = m \\frac{\\partial}{\\partial m} \\left( \\ln(\\gamma_{\\pm}) \\right)\n$$\nWe first compute the derivative of $\\ln(\\gamma_{\\pm})$ with respect to $m$:\n$$\n\\frac{\\partial}{\\partial m} \\left( \\ln(\\gamma_{\\pm}) \\right) = -A \\ln(10) \\frac{\\partial}{\\partial m} \\left( \\frac{m^{1/2}}{1+m^{1/2}} - 0.3 m \\right)\n$$\nLet's differentiate the terms inside the parenthesis. For the first term, using the quotient rule:\n$$\n\\frac{\\partial}{\\partial m} \\left(\\frac{m^{1/2}}{1+m^{1/2}}\\right) = \\frac{(\\frac{1}{2}m^{-1/2})(1+m^{1/2}) - m^{1/2}(\\frac{1}{2}m^{-1/2})}{(1+m^{1/2})^2} = \\frac{\\frac{1}{2}m^{-1/2} + \\frac{1}{2} - \\frac{1}{2}}{(1+m^{1/2})^2} = \\frac{1}{2\\sqrt{m}(1+\\sqrt{m})^2}\n$$\nThe derivative of the second term is simply:\n$$\n\\frac{\\partial}{\\partial m} (-0.3m) = -0.3\n$$\nCombining these results, we get:\n$$\n\\frac{\\partial}{\\partial m} \\left( \\ln(\\gamma_{\\pm}) \\right) = -A \\ln(10) \\left( \\frac{1}{2\\sqrt{m}(1+\\sqrt{m})^2} - 0.3 \\right)\n$$\nNow, we multiply by $m$ to find the desired derivative:\n$$\n\\frac{\\partial \\ln\\gamma_{\\pm}}{\\partial \\ln m} = m \\left[ -A \\ln(10) \\left( \\frac{1}{2\\sqrt{m}(1+\\sqrt{m})^2} - 0.3 \\right) \\right] = -A \\ln(10) \\left( \\frac{m}{2\\sqrt{m}(1+\\sqrt{m})^2} - 0.3m \\right)\n$$\n$$\n\\frac{\\partial \\ln\\gamma_{\\pm}}{\\partial \\ln m} = -A \\ln(10) \\left( \\frac{\\sqrt{m}}{2(1+\\sqrt{m})^2} - 0.3m \\right)\n$$\nWe are given $m=0.30\\,\\mathrm{mol\\,kg^{-1}}$ and $A=0.509$. We can now substitute these values into the expression.\nLet's evaluate the terms:\n$$\n\\sqrt{m} = \\sqrt{0.30}\n$$\n$$\n\\frac{\\partial \\ln\\gamma_{\\pm}}{\\partial \\ln m} = -0.509 \\times \\ln(10) \\left( \\frac{\\sqrt{0.30}}{2(1+\\sqrt{0.30})^2} - 0.3(0.30) \\right)\n$$\nUsing numerical values $\\sqrt{0.30} \\approx 0.54772$ and $\\ln(10) \\approx 2.30259$:\n$$\n\\frac{\\partial \\ln\\gamma_{\\pm}}{\\partial \\ln m} \\approx -0.509 \\times 2.30259 \\left( \\frac{0.54772}{2(1+0.54772)^2} - 0.09 \\right)\n$$\n$$\n\\frac{\\partial \\ln\\gamma_{\\pm}}{\\partial \\ln m} \\approx -1.1720 \\left( \\frac{0.54772}{2(1.54772)^2} - 0.09 \\right) \\approx -1.1720 \\left( \\frac{0.54772}{4.7909} - 0.09 \\right)\n$$\n$$\n\\frac{\\partial \\ln\\gamma_{\\pm}}{\\partial \\ln m} \\approx -1.1720 \\left( 0.11432 - 0.09 \\right) = -1.1720 \\times 0.02432 \\approx -0.028503\n$$\nFinally, we calculate the thermodynamic factor $\\Gamma$:\n$$\n\\Gamma = 1 + \\frac{\\partial \\ln\\gamma_{\\pm}}{\\partial \\ln m} \\approx 1 - 0.028503 = 0.971497\n$$\nRounding the result to four significant figures, we get $\\Gamma = 0.9715$.\n\nThe physical interpretation of this result relates to the driving force for salt diffusion. In concentrated solution theory, the flux of salt is driven by the gradient of the electrolyte chemical potential, $\\nabla \\mu_e$. The chemical potential for a $1:1$ electrolyte is $\\mu_e = \\mu_e^{\\ominus} + 2RT\\ln(m\\gamma_{\\pm})$. The gradient of this potential can be written as:\n$$\n\\nabla \\mu_e = 2RT \\nabla(\\ln m + \\ln \\gamma_{\\pm}) = 2RT \\left( \\frac{\\nabla m}{m} + \\frac{\\partial \\ln \\gamma_{\\pm}}{\\partial m} \\nabla m \\right)\n$$\nBy expressing the derivative with respect to $\\ln m$, this becomes:\n$$\n\\nabla \\mu_e = 2RT \\left( 1 + \\frac{\\partial \\ln \\gamma_{\\pm}}{\\partial \\ln m} \\right) \\nabla(\\ln m) = 2RT \\Gamma \\frac{\\nabla m}{m}\n$$\nFor an ideal solution, $\\gamma_{\\pm}=1$, which means $\\ln \\gamma_{\\pm}=0$ and $\\Gamma=1$. In this case, the driving force is directly proportional to the relative gradient of concentration, $\\frac{\\nabla m}{m}$. The thermodynamic factor $\\Gamma$ thus quantifies the deviation from ideal behavior. Our calculated value is $\\Gamma \\approx 0.9715$, which is less than $1$. This indicates that at a molality of $0.30\\,\\mathrm{mol\\,kg^{-1}}$, the solute-solute and solute-solvent interactions (accounted for by the activity coefficient) reduce the effective driving force for diffusion by approximately $2.85\\%$ compared to an ideal solution at the same concentration. This reduction implies that the non-ideal interactions stabilize the electrolyte, slightly diminishing the thermodynamic impetus for ions to move down a concentration gradient.",
            "answer": "$$\\boxed{0.9715}$$"
        },
        {
            "introduction": "The final step in developing a robust battery simulation is to bridge thermodynamic theory with computational practice. This advanced exercise guides you through the process of parameterizing a thermodynamically consistent model—the two-parameter Margules equation—by fitting it to data, a core task in automated design workflows. You will implement a regression that inherently respects the Gibbs–Duhem relation and then numerically verify this consistency, mirroring the validation procedures used in professional simulation software. ",
            "id": "3957095",
            "problem": "Consider a binary solvent mixture used in lithium-ion battery electrolytes, idealized as components $1$ and $2$, at constant temperature $T$ and pressure $p$. The nonideality of mixing is described by the activity coefficients $\\gamma_1(x_1)$ and $\\gamma_2(x_1)$, where $x_1$ is the mole fraction of component $1$ and $x_2 = 1 - x_1$. The activities are defined by $a_i = x_i \\gamma_i$, and the chemical potentials satisfy $\\mu_i = \\mu_i^\\circ(T,p) + RT \\ln a_i$, where $R$ is the universal gas constant. The molar excess Gibbs free energy is $G^{E}$, and the activity coefficients are related to $G^{E}$ through the fundamental relation for partial molar excess quantities: for a binary mixture,\n$$\n\\ln \\gamma_i = \\frac{1}{RT}\\left(\\bar{G}_i^{E}\\right) = \\left.\\frac{\\partial \\left(n G^{E}/(RT)\\right)}{\\partial n_i}\\right|_{T,p,n_{j \\ne i}},\n$$\nwhere $n$ is the total number of moles. The Gibbs–Duhem equation at constant $T$ and $p$ for a binary mixture implies the differential identity\n$$\nx_1 \\, d \\ln \\gamma_1 + x_2 \\, d \\ln \\gamma_2 = 0.\n$$\n\nYou must derive, implement, and fit a two-parameter Margules model for this binary mixture in a way that enforces Gibbs–Duhem consistency during regression. Begin from the definitions above and from a binary excess Gibbs free energy representation (expressed per mole) that depends only on composition and whose parameters are dimensionless. Your derivation must identify explicit expressions for $\\ln \\gamma_1(x_1)$ and $\\ln \\gamma_2(x_1)$ that follow from a single excess Gibbs free energy function $G^{E}(x_1)$ and therefore satisfy the Gibbs–Duhem constraint by construction.\n\nThen implement a numerical procedure to estimate the model parameters by least squares regression against synthetic “measured” data generated from known parameter sets. The enforcement of Gibbs–Duhem consistency during regression must be achieved by using a parameterization that comes from a single $G^{E}(x_1)$ function and must also be verified a posteriori by a discrete check of the Gibbs–Duhem identity on a composition grid using centered finite differences.\n\nAll quantities in this problem are dimensionless. Report the final numerical answers as dimensionless numbers.\n\nTasks to complete:\n\n1. Starting from the relations for activities, chemical potentials, and the definition of excess Gibbs free energy given above, derive composition-dependent expressions for $\\ln \\gamma_1(x_1)$ and $\\ln \\gamma_2(x_1)$ for a two-parameter Margules model with parameters $A_{12}$ and $A_{21}$ that are dimensionless. Your expressions must be derived from a single $G^{E}(x_1)$ and hence be Gibbs–Duhem consistent. Do not assume any shortcut formulas; derive them from the fundamental definitions and the chosen $G^{E}(x_1)$.\n\n2. For each test case, generate synthetic “measured” data $\\{\\ln \\gamma_1(x_1^{(k)}), \\ln \\gamma_2(x_1^{(k)})\\}$ on a uniform composition grid using the derived model expressions and the true parameters. Use a uniform grid of $N$ points with $x_1^{(k)} \\in [0.02, 0.98]$ for $k = 1, \\ldots, N$, where $N = 49$ so that the spacing is $0.02$.\n\n3. For each test case, fit the model parameters by minimizing the sum of squared residuals between the model predictions and the synthetic data for both components simultaneously over the entire grid. Enforce Gibbs–Duhem consistency during regression by representing $\\ln \\gamma_1$ and $\\ln \\gamma_2$ via a single $G^{E}(x_1)$ parameterization and additionally verify the consistency numerically by computing the discrete approximation of\n$$\nx_1 \\frac{d \\ln \\gamma_1}{d x_1} + x_2 \\frac{d \\ln \\gamma_2}{d x_1}\n$$\nusing centered finite differences at the interior grid points. Report the maximum absolute value over the interior as a diagnostic of consistency.\n\n4. Use the following test suite of true parameter values $(A_{12}, A_{21})$ (dimensionless) to generate the synthetic data:\n- Case $1$ (symmetric nonideality): $(A_{12}, A_{21}) = (1.2, 1.2)$.\n- Case $2$ (asymmetric nonideality): $(A_{12}, A_{21}) = (1.8, 0.6)$.\n- Case $3$ (near-ideal mixture): $(A_{12}, A_{21}) = (0.08, 0.05)$.\n\n5. For each case, output three numbers: the fitted $\\hat{A}_{12}$, the fitted $\\hat{A}_{21}$, and the maximum absolute discrete Gibbs–Duhem residual described above. All outputs are dimensionless. Round $\\hat{A}_{12}$ and $\\hat{A}_{21}$ to $4$ decimal places and the maximum absolute Gibbs–Duhem residual to $8$ decimal places.\n\nFinal output format:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain $9$ numbers in the following order:\n$$\n[\\hat{A}_{12}^{(1)}, \\hat{A}_{21}^{(1)}, r_{\\mathrm{GD}}^{(1)}, \\hat{A}_{12}^{(2)}, \\hat{A}_{21}^{(2)}, r_{\\mathrm{GD}}^{(2)}, \\hat{A}_{12}^{(3)}, \\hat{A}_{21}^{(3)}, r_{\\mathrm{GD}}^{(3)}],\n$$\nwhere $r_{\\mathrm{GD}}^{(i)}$ is the maximum absolute discrete Gibbs–Duhem residual for case $i$. Print the numbers rounded as specified above without units, since they are dimensionless.",
            "solution": "The problem requires the derivation and implementation of a two-parameter Margules model for the activity coefficients of a binary mixture, ensuring Gibbs–Duhem consistency. The model parameters are to be estimated by fitting to synthetic data, and the consistency is to be verified numerically.\n\n### 1. Derivation of the Margules Activity Coefficient Model\n\nThe foundation of a thermodynamically consistent activity coefficient model is that all partial molar properties are derived from a single expression for the total excess property of the mixture. For a binary mixture, the activity coefficients $\\gamma_1$ and $\\gamma_2$ are related to the molar excess Gibbs free energy, $G^E$, through the relation for partial molar excess Gibbs energies, $\\bar{G}_i^E$:\n$$\nRT \\ln \\gamma_i = \\bar{G}_i^E = \\left. \\frac{\\partial (n G^E)}{\\partial n_i} \\right|_{T,p,n_{j \\ne i}}\n$$\nwhere $n = n_1 + n_2$ is the total number of moles, and $n_i$ is the number of moles of component $i$. This relationship ensures that the derived expressions for $\\ln \\gamma_i$ will satisfy the Gibbs–Duhem equation.\n\nThe problem specifies a two-parameter Margules model. The dimensionless molar excess Gibbs free energy, $g^E = G^E/(RT)$, for this model is given by:\n$$\ng^E = x_1 x_2 (A_{21} x_1 + A_{12} x_2)\n$$\nwhere $x_1$ and $x_2$ are the mole fractions of components $1$ and $2$, and $A_{12}$ and $A_{21}$ are the dimensionless Margules parameters. We must evaluate the partial derivatives with respect to mole numbers. To do this, we express $g^E$ in terms of $n_1$ and $n_2$:\n$$\nn g^E = n \\left(\\frac{n_1}{n}\\right) \\left(\\frac{n_2}{n}\\right) \\left( A_{21} \\frac{n_1}{n} + A_{12} \\frac{n_2}{n} \\right) = \\frac{n_1 n_2 (A_{21} n_1 + A_{12} n_2)}{(n_1+n_2)^2}\n$$\nNow, we compute $\\ln \\gamma_1$ by differentiating with respect to $n_1$ at constant $n_2$:\n$$\n\\ln \\gamma_1 = \\left. \\frac{\\partial (n g^E)}{\\partial n_1} \\right|_{n_2} = \\frac{\\partial}{\\partial n_1} \\left( \\frac{A_{21}n_1^2 n_2 + A_{12}n_1 n_2^2}{(n_1+n_2)^2} \\right)\n$$\nUsing the quotient rule for differentiation, $\\frac{d}{dx} (\\frac{u}{v}) = \\frac{u'v - uv'}{v^2}$, we obtain:\n$$\n\\ln \\gamma_1 = \\frac{(2A_{21}n_1 n_2 + A_{12}n_2^2)(n_1+n_2)^2 - (A_{21}n_1^2 n_2 + A_{12}n_1 n_2^2) \\cdot 2(n_1+n_2)}{(n_1+n_2)^4}\n$$\nSimplifying by canceling a factor of $(n_1+n_2)$:\n$$\n\\ln \\gamma_1 = \\frac{(2A_{21}n_1 n_2 + A_{12}n_2^2)(n_1+n_2) - 2(A_{21}n_1^2 n_2 + A_{12}n_1 n_2^2)}{(n_1+n_2)^3}\n$$\nExpanding the terms in the numerator:\n$$\n\\text{Numerator} = (2A_{21}n_1^2 n_2 + 2A_{21}n_1 n_2^2 + A_{12}n_1 n_2^2 + A_{12}n_2^3) - (2A_{21}n_1^2 n_2 + 2A_{12}n_1 n_2^2)\n$$\n$$\n= 2A_{21}n_1 n_2^2 - A_{12}n_1 n_2^2 + A_{12}n_2^3 = n_2^2 [ (2A_{21}-A_{12})n_1 + A_{12}n_2 ]\n$$\nSubstituting this back into the expression for $\\ln \\gamma_1$ and converting to mole fractions ($x_i = n_i/n$):\n$$\n\\ln \\gamma_1 = \\frac{n_2^2 [ (2A_{21}-A_{12})n_1 + A_{12}n_2 ]}{(n_1+n_2)^3} = \\left(\\frac{n_2}{n}\\right)^2 \\left[ (2A_{21}-A_{12})\\frac{n_1}{n} + A_{12}\\frac{n_2}{n} \\right]\n$$\n$$\n\\ln \\gamma_1 = x_2^2 [ (2A_{21}-A_{12})x_1 + A_{12}x_2 ]\n$$\nUsing $x_2=1-x_1$, we can write this purely in terms of $x_1$:\n$$\n\\ln \\gamma_1(x_1) = (1-x_1)^2 [A_{12} + 2(A_{21} - A_{12}) x_1]\n$$\nBy symmetry, the expression for $\\ln \\gamma_2$ is obtained by interchanging indices $1 \\leftrightarrow 2$ and parameters $A_{12} \\leftrightarrow A_{21}$:\n$$\n\\ln \\gamma_2(x_2) = (1-x_2)^2 [A_{21} + 2(A_{12} - A_{21}) x_2]\n$$\nSubstituting $x_2 = 1-x_1$, we get the expression as a function of $x_1$:\n$$\n\\ln \\gamma_2(x_1) = x_1^2 [A_{21} + 2(A_{12} - A_{21}) (1-x_1)]\n$$\nThese two equations together constitute the Gibbs–Duhem consistent two-parameter Margules model for activity coefficients.\n\n### 2. Numerical Procedure for Parameter Estimation\n\nThe parameters $A_{12}$ and $A_{21}$ are estimated by minimizing the sum of squared residuals between the model predictions and the synthetic data. The objective function is:\n$$\nS(A_{12}, A_{21}) = \\sum_{k=1}^{N} \\left[ (\\ln \\gamma_{1,k}^{\\text{model}} - \\ln \\gamma_{1,k}^{\\text{data}})^2 + (\\ln \\gamma_{2,k}^{\\text{model}} - \\ln \\gamma_{2,k}^{\\text{data}})^2 \\right]\n$$\nThe model expressions are linear with respect to the parameters $A_{12}$ and $A_{21}$:\n$$\n\\ln \\gamma_1^{\\text{model}} = (1-x_1)^2(1-2x_1) A_{12} + 2x_1(1-x_1)^2 A_{21}\n$$\n$$\n\\ln \\gamma_2^{\\text{model}} = 2x_1^2(1-x_1) A_{12} + x_1^2(2x_1-1) A_{21}\n$$\nThis forms a linear least-squares problem of the form $Y = X \\beta$, where $\\beta = [A_{12}, A_{21}]^T$. The design matrix $X$ is of size $(2N \\times 2)$, and the observation vector $Y$ is of size $(2N \\times 1)$. The solution is found using a standard linear algebra solver, such as `numpy.linalg.lstsq`.\n\n### 3. Gibbs–Duhem Consistency Verification\n\nThe Gibbs–Duhem equation at constant temperature and pressure for a binary mixture can be written as:\n$$\nx_1 \\frac{d \\ln \\gamma_1}{d x_1} + x_2 \\frac{d \\ln \\gamma_2}{d x_1} = 0\n$$\nTo verify this numerically, we use the fitted parameters $\\hat{A}_{12}$ and $\\hat{A}_{21}$ to calculate $\\ln \\gamma_1$ and $\\ln \\gamma_2$ on the composition grid. The derivatives are approximated using a second-order centered finite difference scheme at each interior grid point $x_1^{(k)}$ (for $k=2, ..., N-1$):\n$$\n\\left. \\frac{d \\ln \\gamma_i}{d x_1} \\right|_{x_1^{(k)}} \\approx \\frac{\\ln \\gamma_i(x_1^{(k+1)}) - \\ln \\gamma_i(x_1^{(k-1)})}{2h}\n$$\nwhere $h = x_1^{(k+1)} - x_1^{(k)}$ is the grid spacing. The Gibbs–Duhem residual at each interior point is:\n$$\nr_k = x_1^{(k)} \\left( \\frac{\\ln \\gamma_{1,k+1} - \\ln \\gamma_{1,k-1}}{2h} \\right) + (1-x_1^{(k)}) \\left( \\frac{\\ln \\gamma_{2,k+1} - \\ln \\gamma_{2,k-1}}{2h} \\right)\n$$\nThe diagnostic quantity $r_{\\mathrm{GD}}$ is the maximum absolute value of these residuals over all interior points, $r_{\\mathrm{GD}} = \\max_k |r_k|$. Since the model is thermodynamically consistent by derivation, this value is expected to be close to machine precision, limited only by floating-point arithmetic and the discretization error of the finite difference approximation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting and verifying a two-parameter Margules model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.2, 1.2),  # Case 1: symmetric nonideality\n        (1.8, 0.6),  # Case 2: asymmetric nonideality\n        (0.08, 0.05), # Case 3: near-ideal mixture\n    ]\n\n    results = []\n\n    # Grid parameters\n    N = 49\n    x1_min = 0.02\n    x1_max = 0.98\n    x1_grid = np.linspace(x1_min, x1_max, N)\n    h = x1_grid[1] - x1_grid[0]\n\n    def margules_ln_gamma(x1, A12, A21):\n        \"\"\"\n        Calculates ln(gamma1) and ln(gamma2) using the two-parameter Margules model.\n        \n        Args:\n            x1 (np.ndarray): Mole fraction of component 1.\n            A12 (float): Margules parameter.\n            A21 (float): Margules parameter.\n            \n        Returns:\n            tuple[np.ndarray, np.ndarray]: (ln(gamma1), ln(gamma2))\n        \"\"\"\n        x2 = 1.0 - x1\n        ln_gamma1 = x2**2 * (A12 + 2 * (A21 - A12) * x1)\n        ln_gamma2 = x1**2 * (A21 + 2 * (A12 - A21) * x2)\n        return ln_gamma1, ln_gamma2\n\n    for A12_true, A21_true in test_cases:\n        # Task 2: Generate synthetic \"measured\" data\n        lng1_data, lng2_data = margules_ln_gamma(x1_grid, A12_true, A21_true)\n\n        # Task 3: Fit model parameters by least squares\n        \n        # Construct the linear system Y = X * beta, where beta = [A12, A21]\n        \n        # Y vector (observations)\n        Y = np.concatenate([lng1_data, lng2_data])\n        \n        # X matrix (design matrix)\n        x1 = x1_grid\n        x2 = 1.0 - x1\n        \n        # Coefficients for A12 and A21 in the expression for ln(gamma1)\n        C1_12 = x2**2 * (1 - 2*x1)\n        C1_21 = 2 * x1 * x2**2\n        \n        # Coefficients for A12 and A21 in the expression for ln(gamma2)\n        C2_12 = 2 * x1**2 * x2\n        C2_21 = x1**2 * (1 - 2*x2)\n\n        X_block1 = np.vstack([C1_12, C1_21]).T\n        X_block2 = np.vstack([C2_12, C2_21]).T\n        X = np.vstack([X_block1, X_block2])\n        \n        # Solve the linear least-squares problem\n        beta_fit, _, _, _ = np.linalg.lstsq(X, Y, rcond=None)\n        A12_fit, A21_fit = beta_fit\n\n        # Task 3: Verify Gibbs-Duhem consistency a posteriori\n        \n        # Calculate ln(gamma) with the fitted parameters\n        lng1_fit, lng2_fit = margules_ln_gamma(x1_grid, A12_fit, A21_fit)\n        \n        # Calculate derivatives using centered finite differences on interior points\n        interior_x1 = x1_grid[1:-1]\n        interior_x2 = 1.0 - interior_x1\n        \n        d_lng1_dx1 = (lng1_fit[2:] - lng1_fit[:-2]) / (2 * h)\n        d_lng2_dx1 = (lng2_fit[2:] - lng2_fit[:-2]) / (2 * h)\n        \n        # Calculate the Gibbs-Duhem residual at each interior point\n        gd_residuals = interior_x1 * d_lng1_dx1 + interior_x2 * d_lng2_dx1\n        \n        # Find the maximum absolute residual\n        max_abs_gd_residual = np.max(np.abs(gd_residuals)) if gd_residuals.size > 0 else 0.0\n\n        # Store results with specified rounding\n        results.append(f\"{A12_fit:.4f}\")\n        results.append(f\"{A21_fit:.4f}\")\n        results.append(f\"{max_abs_gd_residual:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}