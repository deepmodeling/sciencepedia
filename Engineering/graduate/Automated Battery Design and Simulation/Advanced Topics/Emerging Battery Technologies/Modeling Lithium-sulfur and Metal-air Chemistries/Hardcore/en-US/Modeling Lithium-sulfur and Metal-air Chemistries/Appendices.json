{
    "hands_on_practices": [
        {
            "introduction": "A core task in battery modeling is to connect microscopic ion dynamics to macroscopic transport properties. This exercise demonstrates how to derive the electrolyte's ionic conductivity, $\\kappa$, from fundamental principles starting with the Nernst–Planck flux equation. By applying this derivation to a hypothetical Li-S electrolyte and comparing the result to a measured value, you will practice inferring the degree of ion dissociation, a key phenomenon affecting performance in non-ideal electrolytes .",
            "id": "3929806",
            "problem": "A Lithium–Sulfur (Li–S) flow catholyte is prepared as a single-salt solution of dissolved $\\mathrm{Li}_2\\mathrm{S}_6$ in an aprotic ether solvent at temperature $T=298\\ \\mathrm{K}$. The analytical concentration of $\\mathrm{Li}_2\\mathrm{S}_6$ is $c_0 = 0.50\\ \\mathrm{mol}\\ \\mathrm{L}^{-1}$. In the electrolyte, $\\mathrm{Li}_2\\mathrm{S}_6$ undergoes dissociation according to $\\mathrm{Li}_2\\mathrm{S}_6 \\rightleftharpoons 2\\,\\mathrm{Li}^+ + \\mathrm{S}_6^{2-}$. Let $\\alpha \\in [0,1]$ denote the degree of dissociation (the fraction of $\\mathrm{Li}_2\\mathrm{S}_6$ units that are dissociated into free ions). Assume there is no supporting salt, no convection, spatial homogeneity, and local electroneutrality. The electrophoretic mobilities (as defined in the Nernst–Planck flux with $D_i = u_i R T$) at $T=298\\ \\mathrm{K}$ are $u_{\\mathrm{Li}^+} = 1.60 \\times 10^{-13}$ and $u_{\\mathrm{S}_6^{2-}} = 0.60 \\times 10^{-13}$, and the absolute value of the charge of each species is given by its valence $z_i$ times the Faraday constant $F = 96485\\ \\mathrm{C}\\ \\mathrm{mol}^{-1}$. A bulk conductivity measurement at $T=298\\ \\mathrm{K}$ yields a value of $\\kappa_{\\mathrm{meas}} = 1.564\\ \\mathrm{S}\\ \\mathrm{m}^{-1}$.\n\nStarting only from the Nernst–Planck flux definition for each species, the Einstein relation connecting diffusivity and mobility, the definition of current density from ionic fluxes, and Ohm’s law relating current density to the electric field, derive the expression for the electrolyte’s bulk conductivity $\\kappa$ in terms of $\\{z_i,u_i,c_i\\}$. Then, using the stated assumptions, express the species concentrations $\\{c_i\\}$ in terms of $c_0$ and $\\alpha$, compute the fully dissociated conductivity (i.e., at $\\alpha=1$), and use the measured conductivity to infer the numerical value of the dissociation fraction $\\alpha$. \n\nReport the final inferred $\\alpha$ as a unitless decimal rounded to four significant figures. If you compute any intermediate conductivity values, express them in $\\mathrm{S}\\ \\mathrm{m}^{-1}$. Use the conversion $1\\ \\mathrm{mol}\\ \\mathrm{L}^{-1} = 1000\\ \\mathrm{mol}\\ \\mathrm{m}^{-3}$.",
            "solution": "The starting point is the Nernst–Planck flux for species $i$ in an isothermal, homogeneous solution without convection:\n$$\n\\mathbf{N}_i = -D_i \\nabla c_i - z_i u_i F c_i \\nabla \\phi,\n$$\nwhere $D_i$ is the diffusivity, $u_i$ is the electrophoretic mobility as defined via the migration term, $z_i$ is the valence, $F$ is the Faraday constant, and $\\phi$ is the electric potential. The Einstein relation connects $D_i$ and $u_i$ as\n$$\nD_i = u_i R T,\n$$\nwith $R$ the gas constant and $T$ the absolute temperature.\n\nUnder the stated conditions of spatial homogeneity (bulk, no concentration gradients), $\\nabla c_i = \\mathbf{0}$, so the flux is purely migrational:\n$$\n\\mathbf{N}_i = - z_i u_i F c_i \\nabla \\phi.\n$$\nThe current density $\\mathbf{J}$ is given by the sum over species of charge transported by each flux,\n$$\n\\mathbf{J} = F \\sum_i z_i \\mathbf{N}_i = F \\sum_i z_i \\left(- z_i u_i F c_i \\nabla \\phi \\right) = - F^2 \\sum_i z_i^2 u_i c_i \\nabla \\phi.\n$$\nOhm’s law relates the current density to the electric field $\\mathbf{E} = - \\nabla \\phi$:\n$$\n\\mathbf{J} = \\kappa \\mathbf{E} = - \\kappa \\nabla \\phi.\n$$\nMatching the two expressions for $\\mathbf{J}$, we identify the bulk conductivity as\n$$\n\\kappa = F^2 \\sum_i z_i^2 u_i c_i.\n$$\n\nFor the $\\mathrm{Li}_2\\mathrm{S}_6$ dissociation equilibrium $\\mathrm{Li}_2\\mathrm{S}_6 \\rightleftharpoons 2\\,\\mathrm{Li}^+ + \\mathrm{S}_6^{2-}$, if a fraction $\\alpha$ of the analytical concentration $c_0$ is dissociated, the bulk concentrations of the charged species are\n$$\nc_{\\mathrm{Li}^+} = 2 \\alpha c_0,\\qquad c_{\\mathrm{S}_6^{2-}} = \\alpha c_0.\n$$\nThe valences are $z_{\\mathrm{Li}^+} = +1$ and $z_{\\mathrm{S}_6^{2-}} = -2$. Because $\\kappa$ depends on $z_i^2$, the sign of $z_i$ does not affect the magnitude of each contribution. Hence,\n$$\n\\kappa(\\alpha) = F^2 \\left[z_{\\mathrm{Li}^+}^2 u_{\\mathrm{Li}^+} c_{\\mathrm{Li}^+} + z_{\\mathrm{S}_6^{2-}}^2 u_{\\mathrm{S}_6^{2-}} c_{\\mathrm{S}_6^{2-}}\\right] \n= F^2 \\left[(1)^2 u_{\\mathrm{Li}^+} \\cdot (2 \\alpha c_0) + (2)^2 u_{\\mathrm{S}_6^{2-}} \\cdot (\\alpha c_0)\\right].\n$$\nFactor out $\\alpha$:\n$$\n\\kappa(\\alpha) = \\alpha F^2 \\left[2 u_{\\mathrm{Li}^+} c_0 + 4 u_{\\mathrm{S}_6^{2-}} c_0\\right].\n$$\nDefine the fully dissociated conductivity as $\\kappa_{\\mathrm{full}} \\equiv \\kappa(\\alpha=1)$:\n$$\n\\kappa_{\\mathrm{full}} = F^2 \\left[2 u_{\\mathrm{Li}^+} c_0 + 4 u_{\\mathrm{S}_6^{2-}} c_0\\right].\n$$\nWith $c_0 = 0.50\\ \\mathrm{mol}\\ \\mathrm{L}^{-1} = 500\\ \\mathrm{mol}\\ \\mathrm{m}^{-3}$, $u_{\\mathrm{Li}^+} = 1.60 \\times 10^{-13}$, $u_{\\mathrm{S}_6^{2-}} = 0.60 \\times 10^{-13}$, and $F = 96485\\ \\mathrm{C}\\ \\mathrm{mol}^{-1}$, compute the bracketed factor:\n$$\n2 u_{\\mathrm{Li}^+} c_0 + 4 u_{\\mathrm{S}_6^{2-}} c_0 = 2\\,(1.60 \\times 10^{-13})\\,(500) + 4\\,(0.60 \\times 10^{-13})\\,(500).\n$$\nEvaluate each term:\n$$\n2\\,(1.60 \\times 10^{-13})\\,(500) = (3.20 \\times 10^{-13})\\,(500) = 1.60 \\times 10^{-10},\n$$\n$$\n4\\,(0.60 \\times 10^{-13})\\,(500) = (2.40 \\times 10^{-13})\\,(500) = 1.20 \\times 10^{-10}.\n$$\nSum:\n$$\n1.60 \\times 10^{-10} + 1.20 \\times 10^{-10} = 2.80 \\times 10^{-10}.\n$$\nNow compute\n$$\n\\kappa_{\\mathrm{full}} = F^2 \\times 2.80 \\times 10^{-10},\\quad F^2 = (96485)^2 = 9{,}309{,}355{,}225.\n$$\nThus,\n$$\n\\kappa_{\\mathrm{full}} = 9.309355225 \\times 10^{9} \\times 2.80 \\times 10^{-10} = 2.606619463\\ \\mathrm{S}\\ \\mathrm{m}^{-1}.\n$$\nAssuming ideal behavior of the mobilities with respect to dissociation (i.e., neutral, undissociated $\\mathrm{Li}_2\\mathrm{S}_6$ pairs do not contribute to conductivity and the mobilities of the charged species are unchanged), the measured conductivity relates linearly to $\\alpha$:\n$$\n\\kappa_{\\mathrm{meas}} = \\alpha\\, \\kappa_{\\mathrm{full}} \\quad \\Longrightarrow \\quad \\alpha = \\frac{\\kappa_{\\mathrm{meas}}}{\\kappa_{\\mathrm{full}}}.\n$$\nInsert the measured value $\\kappa_{\\mathrm{meas}} = 1.564\\ \\mathrm{S}\\ \\mathrm{m}^{-1}$:\n$$\n\\alpha = \\frac{1.564}{2.606619463} \\approx 0.60001086.\n$$\nRounded to four significant figures, the inferred dissociation fraction is\n$$\n\\alpha = 0.6000.\n$$\nThis implies that a fraction $1 - \\alpha \\approx 0.4000$ of $\\mathrm{Li}_2\\mathrm{S}_6$ remains as neutral, non-conductive ion pairs (or higher aggregates) under the stated conditions, a level of ion association consistent with reduced conductivity relative to the fully dissociated prediction.",
            "answer": "$$\\boxed{0.6000}$$"
        },
        {
            "introduction": "Real-world battery electrodes are complex porous media, where ion and reactant transport is hindered by the solid matrix. This practice introduces the concept of an effective diffusion coefficient, a cornerstone of homogenized porous electrode models. You will derive the widely used Bruggeman relation from physical arguments and then use it to analyze how sensitive the effective diffusivity is to key microstructural parameters like porosity and tortuosity .",
            "id": "3929838",
            "problem": "Consider a porous cathode in a Lithium-Sulfur (Li-S) battery where the charge-carrying species of interest is the tetrathiolate anion $\\mathrm{S}_4^{2-}$ dissolved in the liquid electrolyte phase occupying the pore space. At the microscopic scale, transport of $\\mathrm{S}_4^{2-}$ within the electrolyte obeys Fick’s first law in the electrolyte-filled domain: the local molar flux $\\mathbf{J}$ satisfies $\\mathbf{J} = - D \\nabla c$, where $D$ is the tracer diffusion coefficient of $\\mathrm{S}_4^{2-}$ in the bulk electrolyte and $c$ is the local molar concentration. In a homogenized, one-dimensional (1D), steady-state, isotropic porous medium of thickness $L$ with porosity $\\epsilon \\in (0,1)$ and a geometric tortuosity factor $\\psi \\ge 1$ (defined as the ratio of the average path length through the pore phase to the straight length $L$), the macroscale flux $\\bar{J}$ is related to a macroscale concentration gradient $dc/dx$ by an effective constitutive relation $\\bar{J} = - D_{\\text{eff}} \\, dc/dx$. \n\nStarting from these fundamental definitions and laws, and using only physical reasoning based on:\n- geometric area restriction due to porosity, and \n- path length stretching due to tortuosity, \n\nderive an expression for the effective diffusion coefficient $D_{\\text{eff}}$ as a function of $D$, $\\epsilon$, and $\\psi$ under the assumptions that: (i) diffusion occurs only in the electrolyte-filled pore space, (ii) the microstructure is statistically isotropic, and (iii) the macroscopic gradient is sufficiently small that linear response holds. Then, adopt a widely used power-law closure for the tortuosity–porosity relationship, introducing a Bruggeman-type exponent $b \\ge 1$ via a model of the form $\\psi(\\epsilon, b)$ such that $D_{\\text{eff}}$ becomes a function $D_{\\text{eff}}(D,\\epsilon,b)$ expressible as a power law in $\\epsilon$. \n\nNext, analytically compute the following sensitivity measures of $D_{\\text{eff}}(D,\\epsilon,b)$ with respect to the pore structure parameters:\n- the partial derivative with respect to porosity, $\\partial D_{\\text{eff}}/\\partial \\epsilon$,\n- the partial derivative with respect to the Bruggeman exponent, $\\partial D_{\\text{eff}}/\\partial b$,\n- the log–log sensitivity of $D_{\\text{eff}}$ to porosity, $S_{\\epsilon} = \\partial \\ln D_{\\text{eff}} / \\partial \\ln \\epsilon$,\n- the logarithmic sensitivity of $D_{\\text{eff}}$ to the Bruggeman exponent, $S_{b} = \\partial \\ln D_{\\text{eff}} / \\partial b$,\n- and the log–log sensitivity of $D_{\\text{eff}}$ to the geometric tortuosity factor (at fixed $\\epsilon$), $S_{\\psi} = \\partial \\ln D_{\\text{eff}} / \\partial \\ln \\psi$.\n\nAll values of $D_{\\text{eff}}$ and its dimensional derivatives must be expressed in square meters per second (m$^2$/s). All sensitivity measures $S_{\\epsilon}$, $S_{b}$, and $S_{\\psi}$ must be dimensionless.\n\nImplement your derived expressions in a program that evaluates the quantities listed above for the following test suite of physically plausible parameter sets $(D,\\epsilon,b)$:\n1. $(4.0 \\times 10^{-10} \\text{ m}^2/\\text{s}, \\; 0.55, \\; 1.5)$,\n2. $(4.0 \\times 10^{-10} \\text{ m}^2/\\text{s}, \\; 0.20, \\; 1.5)$,\n3. $(4.0 \\times 10^{-10} \\text{ m}^2/\\text{s}, \\; 0.90, \\; 1.5)$,\n4. $(3.0 \\times 10^{-10} \\text{ m}^2/\\text{s}, \\; 0.60, \\; 1.0)$,\n5. $(1.2 \\times 10^{-10} \\text{ m}^2/\\text{s}, \\; 0.45, \\; 2.0)$.\n\nFor each test case, your program should compute and return a list containing, in this exact order:\n- $D_{\\text{eff}}$ in m$^2$/s,\n- $\\partial D_{\\text{eff}}/\\partial \\epsilon$ in m$^2$/s,\n- $\\partial D_{\\text{eff}}/\\partial b$ in m$^2$/s,\n- $S_{\\epsilon}$ (dimensionless),\n- $S_{b}$ (dimensionless),\n- $S_{\\psi}$ (dimensionless).\n\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list of lists enclosed in square brackets, for example: \"[[case1_values],[case2_values],...]\" where each numeric entry is a real number. No additional text should be printed.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and internally consistent. It presents a standard problem in transport phenomena within porous media, grounded in Fick's law and effective medium theory. The definitions of porosity, tortuosity, and the Bruggeman relation are standard in the field. The provided parameters are physically plausible for electrochemical systems. Therefore, the problem is valid, and a full solution is presented below.\n\nThe derivation and solution proceed in three main stages:\n1. Derivation of the general expression for the effective diffusion coefficient $D_{\\text{eff}}$ in terms of the bulk diffusion coefficient $D$, porosity $\\epsilon$, and tortuosity $\\psi$.\n2. Specialization of this expression using a Bruggeman-type model for tortuosity, leading to an expression for $D_{\\text{eff}}$ as a function of $D$, $\\epsilon$, and a Bruggeman exponent $b$.\n3. Analytical calculation of the required sensitivity measures.\n\n**1. Derivation of the Effective Diffusion Coefficient $D_{\\text{eff}}(\\boldsymbol{D}, \\boldsymbol{\\epsilon}, \\boldsymbol{\\psi})$**\n\nWe start from the local description of diffusion in the electrolyte phase, Fick's first law:\n$$\n\\mathbf{J} = -D \\nabla c\n$$\nwhere $\\mathbf{J}$ is the local molar flux, $D$ is the bulk diffusion coefficient, and $c$ is the local concentration of the species $\\mathrm{S}_4^{2-}$.\n\nWe aim to find a macroscopic, or homogenized, version of this law that relates the macroscale flux $\\bar{J}$ to the macroscale concentration gradient $dc/dx$ in a one-dimensional porous medium of thickness $L$. The macroscopic law is given as:\n$$\n\\bar{J} = -D_{\\text{eff}} \\frac{dc}{dx}\n$$\nTo derive $D_{\\text{eff}}$, we consider the physical effects of the porous structure on the transport process, as directed by the problem statement.\n\n- **Geometric Area Restriction:** Diffusion can only occur through the pore space. For a total cross-sectional area $A$ of the porous medium, the area available for transport is the pore area, $A_{\\text{pore}} = \\epsilon A$. The macroscale flux $\\bar{J}$, defined as the total molar flow rate per total cross-sectional area, is thus reduced by a factor of $\\epsilon$ compared to the local flux within the pores.\n$$\n\\bar{J} \\propto \\epsilon\n$$\n\n- **Path Length Stretching:** The diffusion path through the tortuous pore network is longer than the straight-line thickness $L$ of the medium. The geometric tortuosity $\\psi$ is defined as the ratio of the average path length, $L_{\\text{path}}$, to the straight-line length, $L$.\n$$\n\\psi = \\frac{L_{\\text{path}}}{L} \\ge 1\n$$\nFor a given macroscopic concentration difference $\\Delta c$ across the thickness $L$, the macroscopic gradient has a magnitude of $\\Delta c / L$. However, the actual concentration gradient that drives diffusion along the pore path is experienced over the length $L_{\\text{path}}$. Assuming a linear profile along the path, this local gradient magnitude is $g_{\\text{local}} = \\Delta c / L_{\\text{path}}$. We can express this in terms of the macroscopic gradient magnitude $g_{\\text{macro}} = \\Delta c / L$:\n$$\ng_{\\text{local}} = \\frac{\\Delta c}{\\psi L} = \\frac{1}{\\psi} g_{\\text{macro}}\n$$\nThe local flux magnitude along the path is therefore $J_{\\text{path}} = D g_{\\text{local}} = D \\frac{g_{\\text{macro}}}{\\psi}$. The flux is reduced by a factor of $\\psi$ due to tortuosity.\n\nCombining these two effects: the total molar flow rate (moles per time) through the medium is the local flux density multiplied by the pore area:\n$$\n\\text{Flow Rate} = J_{\\text{path}} \\times A_{\\text{pore}} = \\left(D \\frac{g_{\\text{macro}}}{\\psi}\\right) \\times (\\epsilon A)\n$$\nThe macroscopic flux $\\bar{J}$ is the flow rate per total area $A$:\n$$\n\\bar{J} = \\frac{\\text{Flow Rate}}{A} = \\frac{1}{A} \\left(D\\frac{\\epsilon}{\\psi} g_{\\text{macro}} A\\right) = D \\frac{\\epsilon}{\\psi} g_{\\text{macro}}\n$$\nReplacing $g_{\\text{macro}}$ with the gradient $dc/dx$ (and reintroducing the sign convention), we have:\n$$\n\\bar{J} = -D \\frac{\\epsilon}{\\psi} \\frac{dc}{dx}\n$$\nComparing this with the definition $\\bar{J} = -D_{\\text{eff}} \\frac{dc}{dx}$, we arrive at the expression for the effective diffusion coefficient:\n$$\nD_{\\text{eff}} = D \\frac{\\epsilon}{\\psi}\n$$\n\n**2. Introduction of the Bruggeman Model**\n\nThe problem requires adopting a power-law closure for the tortuosity-porosity relationship of the form $\\psi(\\epsilon, b)$ such that $D_{\\text{eff}}$ becomes a power law in $\\epsilon$. The most common model of this type is the Bruggeman relation, which posits that $D_{\\text{eff}}$ is directly proportional to a power of the porosity:\n$$\nD_{\\text{eff}}(D, \\epsilon, b) = D \\epsilon^b\n$$\nHere, $b$ is the Bruggeman exponent. To ensure this is consistent with our physically derived expression, we equate the two forms for $D_{\\text{eff}}$:\n$$\nD \\epsilon^b = D \\frac{\\epsilon}{\\psi}\n$$\nSolving for the tortuosity $\\psi$, we find the specific model for $\\psi(\\epsilon, b)$ that satisfies the problem's conditions:\n$$\n\\psi(\\epsilon, b) = \\frac{\\epsilon}{\\epsilon^b} = \\epsilon^{1-b}\n$$\nThis form is consistent with the physical constraints. Since $\\epsilon \\in (0, 1)$ and the problem specifies $b \\ge 1$, the exponent $(1-b)$ is less than or equal to zero, which ensures that $\\psi = \\epsilon^{1-b} \\ge 1$, as required for a geometric tortuosity.\n\nOur final expression for the effective diffusion coefficient is therefore:\n$$\nD_{\\text{eff}}(D, \\epsilon, b) = D \\epsilon^b\n$$\n\n**3. Calculation of Sensitivity Measures**\n\nWe now compute the required partial derivatives and logarithmic sensitivities based on the expression $D_{\\text{eff}} = D \\epsilon^b$.\n\n- **Partial derivative with respect to porosity, $\\partial D_{\\text{eff}}/\\partial \\epsilon$**:\nUsing the power rule for differentiation:\n$$\n\\frac{\\partial D_{\\text{eff}}}{\\partial \\epsilon} = \\frac{\\partial}{\\partial \\epsilon} (D \\epsilon^b) = D b \\epsilon^{b-1}\n$$\n\n- **Partial derivative with respect to the Bruggeman exponent, $\\partial D_{\\text{eff}}/\\partial b$**:\nTreating $b$ as the variable and recalling that $\\frac{d}{dx} a^x = a^x \\ln a$:\n$$\n\\frac{\\partial D_{\\text{eff}}}{\\partial b} = \\frac{\\partial}{\\partial b} (D \\epsilon^b) = D \\frac{\\partial}{\\partial b} (\\epsilon^b) = D \\epsilon^b \\ln \\epsilon\n$$\nNote that since $\\epsilon  1$, $\\ln \\epsilon$ is negative, so this derivative will be negative, meaning $D_{\\text{eff}}$ decreases as $b$ increases for a fixed $\\epsilon$.\n\n- **Log–log sensitivity of $D_{\\text{eff}}$ to porosity, $S_{\\epsilon} = \\partial \\ln D_{\\text{eff}} / \\partial \\ln \\epsilon$**:\nFirst, take the natural logarithm of $D_{\\text{eff}}$:\n$$\n\\ln D_{\\text{eff}} = \\ln(D \\epsilon^b) = \\ln D + b \\ln \\epsilon\n$$\nNow, differentiate with respect to $\\ln \\epsilon$:\n$$\nS_{\\epsilon} = \\frac{\\partial (\\ln D + b \\ln \\epsilon)}{\\partial \\ln \\epsilon} = b\n$$\nThis is a classic result: the log-log sensitivity of a power-law function is simply its exponent.\n\n- **Logarithmic sensitivity of $D_{\\text{eff}}$ to the Bruggeman exponent, $S_{b} = \\partial \\ln D_{\\text{eff}} / \\partial b$**:\nUsing the expression for $\\ln D_{\\text{eff}}$ from the previous step, we differentiate with respect to $b$:\n$$\nS_{b} = \\frac{\\partial (\\ln D + b \\ln \\epsilon)}{\\partial b} = \\ln \\epsilon\n$$\n\n- **Log–log sensitivity of $D_{\\text{eff}}$ to the geometric tortuosity factor, $S_{\\psi} = \\partial \\ln D_{\\text{eff}} / \\partial \\ln \\psi$ (at fixed $\\epsilon$)**:\nFor this calculation, we must return to the general expression $D_{\\text{eff}} = D \\frac{\\epsilon}{\\psi}$, where $\\psi$ is treated as an independent variable (since $\\epsilon$ is held constant).\nTaking the natural logarithm:\n$$\n\\ln D_{\\text{eff}} = \\ln \\left( D \\frac{\\epsilon}{\\psi} \\right) = \\ln D + \\ln \\epsilon - \\ln \\psi\n$$\nDifferentiating with respect to $\\ln \\psi$:\n$$\nS_{\\psi} = \\frac{\\partial (\\ln D + \\ln \\epsilon - \\ln \\psi)}{\\partial \\ln \\psi} = -1\n$$\nThis result indicates a simple inverse relationship: a $1\\%$ increase in tortuosity leads to a $1\\%$ decrease in effective diffusivity, all else being equal.\n\n**Summary of Formulae for Implementation:**\n- $D_{\\text{eff}} = D \\epsilon^b$\n- $\\frac{\\partial D_{\\text{eff}}}{\\partial \\epsilon} = D b \\epsilon^{b-1}$\n- $\\frac{\\partial D_{\\text{eff}}}{\\partial b} = D \\epsilon^b \\ln \\epsilon$\n- $S_{\\epsilon} = b$\n- $S_{b} = \\ln \\epsilon$\n- $S_{\\psi} = -1$\n\nThese expressions will now be implemented to evaluate the quantities for the given test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates effective diffusion properties in a porous medium for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple (D, epsilon, b) where:\n    # D: bulk diffusion coefficient in m^2/s\n    # epsilon: porosity (dimensionless)\n    # b: Bruggeman exponent (dimensionless)\n    test_cases = [\n        (4.0e-10, 0.55, 1.5),\n        (4.0e-10, 0.20, 1.5),\n        (4.0e-10, 0.90, 1.5),\n        (3.0e-10, 0.60, 1.0),\n        (1.2e-10, 0.45, 2.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        D, epsilon, b = case\n        \n        # Based on the derived formulae:\n        # D_eff = D * epsilon^b\n        # dD_eff/d_epsilon = D * b * epsilon^(b-1)\n        # dD_eff/d_b = D * epsilon^b * ln(epsilon) = D_eff * ln(epsilon)\n        # S_epsilon = b\n        # S_b = ln(epsilon)\n        # S_psi = -1\n\n        # Calculate D_eff in m^2/s\n        d_eff = D * (epsilon ** b)\n        \n        # Calculate partial derivative wrt epsilon in m^2/s\n        d_deff_depsilon = D * b * (epsilon ** (b - 1.0))\n        \n        # Calculate partial derivative wrt Bruggeman exponent in m^2/s\n        d_deff_db = d_eff * np.log(epsilon)\n        \n        # Calculate log-log sensitivity to porosity (dimensionless)\n        s_epsilon = b\n        \n        # Calculate logarithmic sensitivity to Bruggeman exponent (dimensionless)\n        s_b = np.log(epsilon)\n        \n        # Calculate log-log sensitivity to tortuosity (dimensionless)\n        s_psi = -1.0\n        \n        # Collect the results for the current case\n        case_results = [\n            d_eff,\n            d_deff_depsilon,\n            d_deff_db,\n            s_epsilon,\n            s_b,\n            s_psi\n        ]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # Example: [[-1.2, 3.4], [5.6, -7.8]]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The development of reliable simulation tools hinges on rigorous code verification—the process of ensuring your program correctly solves the mathematical model. This exercise introduces the Method of Manufactured Solutions (MMS), a powerful technique for quantifying the accuracy of a numerical solver. You will implement a finite difference scheme for steady-state reaction-diffusion and conduction equations and use a manufactured solution to verify that your code achieves the expected theoretical order of convergence .",
            "id": "3929841",
            "problem": "Consider a one-dimensional porous cathode slab for either a Lithium–Sulfur chemistry or a Metal–Air chemistry, modeled on the domain $x \\in [0,L]$. Start from the following foundational principles that hold in both chemistries:\n- Species conservation for a representative dissolved species with an effective homogeneous reaction, which at steady state reduces to a reaction–diffusion balance.\n- Charge conservation in the electrolyte phase with a linear constitutive relation between current density and potential gradient, which at steady state reduces to an elliptic conduction equation.\n\nFrom these bases, the steady-state governing equations for the concentration field $c(x)$ and the electrolyte potential field $\\phi(x)$ with constant effective coefficients are:\n$$-D \\frac{\\mathrm{d}^2 c}{\\mathrm{d}x^2} + k\\,c = S(x), \\quad x \\in (0,L),$$\n$$-\\kappa \\frac{\\mathrm{d}^2 \\phi}{\\mathrm{d}x^2} = R(x), \\quad x \\in (0,L),$$\nsubject to homogeneous Dirichlet boundary conditions $c(0)=c(L)=0$ and $\\phi(0)=\\phi(L)=0$, and where $D$ (effective diffusivity), $k$ (effective first-order volumetric reaction rate), and $\\kappa$ (effective ionic conductivity) are positive constants. The source terms $S(x)$ and $R(x)$ are chosen via the Method of Manufactured Solutions (MMS) to enforce exact solutions:\n$$c^\\star(x) = \\sin\\!\\left(\\frac{\\pi x}{L}\\right), \\quad \\phi^\\star(x) = \\sin\\!\\left(\\frac{2\\pi x}{L}\\right),$$\nwith the convention that all angular arguments are in radians. Consistency requires\n$$S(x) = -D\\,\\frac{\\mathrm{d}^2 c^\\star}{\\mathrm{d}x^2} + k\\,c^\\star(x), \\quad R(x) = -\\kappa\\,\\frac{\\mathrm{d}^2 \\phi^\\star}{\\mathrm{d}x^2}.$$\n\nYour task is to verify numerical convergence by performing grid refinement and computing the observed order of accuracy for both $c(x)$ and $\\phi(x)$ using a second-order finite difference discretization on uniform grids. Proceed as follows:\n- For each test case, define a uniform grid with $N$ nodes, spacing $h = L/(N-1)$, and approximate the second derivatives with a standard centered stencil. Enforce the Dirichlet boundary conditions strongly at $x=0$ and $x=L$.\n- For each $N$, solve the resulting linear systems for $c(x)$ and $\\phi(x)$.\n- Compute the discrete error fields $e_c(x_i) = c_{\\text{num}}(x_i) - c^\\star(x_i)$ and $e_\\phi(x_i) = \\phi_{\\text{num}}(x_i) - \\phi^\\star(x_i)$ at all grid points $x_i$.\n- Approximate the continuous $L^2$ error norms with the trapezoidal-rule-consistent scaling\n$$\\|e_c\\|_2 \\approx \\sqrt{h \\sum_{i=0}^{N-1} \\left(e_c(x_i)\\right)^2}, \\qquad \\|e_\\phi\\|_2 \\approx \\sqrt{h \\sum_{i=0}^{N-1} \\left(e_\\phi(x_i)\\right)^2}.$$\n- Estimate the observed order of accuracy $p_c$ and $p_\\phi$ by performing a least-squares linear fit of $\\log\\!\\left(\\|e\\|_2\\right)$ versus $\\log(h)$ over the grid sequence; the slope is the estimate of the order for each field.\n\nUse the following scientifically plausible test suite of parameter sets (use International System of Units, with $L$ in $\\mathrm{m}$, $D$ in $\\mathrm{m^2/s}$, $k$ in $\\mathrm{s^{-1}}$, and $\\kappa$ in $\\mathrm{S/m}$; orders of accuracy are dimensionless):\n- Test case $1$: $L=1.0\\times 10^{-4}$, $D=1.0\\times 10^{-10}$, $k=5.0$, $\\kappa=5.0\\times 10^{-1}$.\n- Test case $2$: $L=5.0\\times 10^{-4}$, $D=5.0\\times 10^{-11}$, $k=2.0$, $\\kappa=5.0\\times 10^{-2}$.\n- Test case $3$: $L=5.0\\times 10^{-5}$, $D=1.0\\times 10^{-12}$, $k=1.0\\times 10^{2}$, $\\kappa=1.5$.\n\nFor each test case, use the grid sequence $N \\in \\{25, 50, 100, 200\\}$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[p_c^{(1)}, p_\\phi^{(1)}, p_c^{(2)}, p_\\phi^{(2)}, p_c^{(3)}, p_\\phi^{(3)}]$, where superscripts denote the test case index. Round each reported order to $6$ decimal places.",
            "solution": "The user-provided problem statement is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- **Governing Equations**:\n    - For concentration $c(x)$: $-D \\frac{\\mathrm{d}^2 c}{\\mathrm{d}x^2} + k\\,c = S(x)$, for $x \\in (0,L)$.\n    - For potential $\\phi(x)$: $-\\kappa \\frac{\\mathrm{d}^2 \\phi}{\\mathrm{d}x^2} = R(x)$, for $x \\in (0,L)$.\n- **Parameters**: $D, k, \\kappa$ are positive constants.\n- **Boundary Conditions**: $c(0)=c(L)=0$ and $\\phi(0)=\\phi(L)=0$ (homogeneous Dirichlet).\n- **Manufactured Solutions**:\n    - $c^\\star(x) = \\sin(\\frac{\\pi x}{L})$\n    - $\\phi^\\star(x) = \\sin(\\frac{2\\pi x}{L})$\n- **Source Term Definitions**:\n    - $S(x) = -D\\,\\frac{\\mathrm{d}^2 c^\\star}{\\mathrm{d}x^2} + k\\,c^\\star(x)$\n    - $R(x) = -\\kappa\\,\\frac{\\mathrm{d}^2 \\phi^\\star}{\\mathrm{d}x^2}$\n- **Numerical Method**:\n    - Discretization: Second-order finite difference on a uniform grid.\n    - Grid: $N$ nodes, spacing $h = L/(N-1)$.\n    - Boundary Condition Enforcement: Strong imposition.\n- **Error Analysis**:\n    - Error definition: $e(x_i) = u_{\\text{num}}(x_i) - u^\\star(x_i)$.\n    - Norm: Discrete $L^2$ norm approximation $\\|e\\|_2 \\approx \\sqrt{h \\sum_{i=0}^{N-1} (e(x_i))^2}$.\n    - Order of Accuracy Estimation ($p$): Least-squares linear fit of $\\log(\\|e\\|_2)$ versus $\\log(h)$.\n- **Test Cases**:\n    - Case 1: $L=1.0\\times 10^{-4}$, $D=1.0\\times 10^{-10}$, $k=5.0$, $\\kappa=5.0\\times 10^{-1}$.\n    - Case 2: $L=5.0\\times 10^{-4}$, $D=5.0\\times 10^{-11}$, $k=2.0$, $\\kappa=5.0\\times 10^{-2}$.\n    - Case 3: $L=5.0\\times 10^{-5}$, $D=1.0\\times 10^{-12}$, $k=1.0\\times 10^{2}$, $\\kappa=1.5$.\n- **Grid Sequence**: $N \\in \\{25, 50, 100, 200\\}$.\n- **Output Format**: Comma-separated list $[p_c^{(1)}, p_\\phi^{(1)}, p_c^{(2)}, p_\\phi^{(2)}, p_c^{(3)}, p_\\phi^{(3)}]$ with values rounded to $6$ decimal places.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is based on standard, linear, second-order ordinary differential equations that model fundamental physical phenomena: the Helmholtz equation for reaction-diffusion processes and the Poisson equation for electrostatics. These are canonical models in chemical engineering and physics. The Method of Manufactured Solutions (MMS) is a standard, rigorous technique for the verification of numerical codes. The parameter values are physically plausible for porous battery electrodes.\n2.  **Well-Posed**: The governing equations are linear second-order ODEs. For a finite domain $x \\in [0,L]$ with specified Dirichlet boundary conditions at both ends, the problems are well-posed Sturm-Liouville problems, guaranteeing the existence of unique, stable solutions. The manufactured solutions are smooth ($C^\\infty$), ensuring the source terms are also well-behaved. The numerical discretization via centered differences leads to diagonally dominant (and thus non-singular) tridiagonal linear systems, which have unique solutions.\n3.  **Objective**: The problem is stated using precise mathematical language and unambiguous instructions. There are no subjective or opinion-based elements.\n4.  **Complete and Consistent**: The problem provides all necessary information: governing equations, boundary conditions, all physical and numerical parameters, the exact solutions to be manufactured, the specific numerical method to be used, the grid refinement sequence, the error norm definition, and the procedure for calculating the order of accuracy. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A reasoned solution will be provided.\n\nThe objective is to verify the second-order convergence of a finite difference scheme for two linear, second-order boundary value problems. We proceed by first defining the analytical source terms required by the Method of Manufactured Solutions, then discretizing the governing equations, and finally implementing a grid refinement study to compute the observed order of accuracy.\n\n**1. Analytical Source Terms**\nThe source terms $S(x)$ and $R(x)$ are derived by substituting the manufactured solutions $c^\\star(x)$ and $\\phi^\\star(x)$ into their respective differential equations.\n\nFor the concentration field $c^\\star(x) = \\sin(\\frac{\\pi x}{L})$:\nThe first and second derivatives are:\n$$ \\frac{\\mathrm{d}c^\\star}{\\mathrm{d}x} = \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x}{L}\\right) $$\n$$ \\frac{\\mathrm{d}^2 c^\\star}{\\mathrm{d}x^2} = -\\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right) = -\\left(\\frac{\\pi}{L}\\right)^2 c^\\star(x) $$\nSubstituting into the definition of $S(x)$:\n$$ S(x) = -D \\left(-\\left(\\frac{\\pi}{L}\\right)^2 c^\\star(x)\\right) + k c^\\star(x) = \\left(D \\left(\\frac{\\pi}{L}\\right)^2 + k\\right) \\sin\\left(\\frac{\\pi x}{L}\\right) $$\n\nFor the potential field $\\phi^\\star(x) = \\sin(\\frac{2\\pi x}{L})$:\nThe second derivative is:\n$$ \\frac{\\mathrm{d}^2 \\phi^\\star}{\\mathrm{d}x^2} = -\\left(\\frac{2\\pi}{L}\\right)^2 \\sin\\left(\\frac{2\\pi x}{L}\\right) = -\\left(\\frac{2\\pi}{L}\\right)^2 \\phi^\\star(x) $$\nSubstituting into the definition of $R(x)$:\n$$ R(x) = -\\kappa \\left(-\\left(\\frac{2\\pi}{L}\\right)^2 \\sin\\left(\\frac{2\\pi x}{L}\\right)\\right) = \\kappa \\left(\\frac{2\\pi}{L}\\right)^2 \\sin\\left(\\frac{2\\pi x}{L}\\right) $$\n\n**2. Finite Difference Discretization**\nWe define a uniform grid on the domain $[0,L]$ with $N$ nodes $x_i = i h$ for $i=0, 1, \\dots, N-1$, where the grid spacing is $h = L/(N-1)$. The value of a function $u(x)$ at a grid node $x_i$ is denoted $u_i$.\n\nThe second derivative is approximated using a second-order accurate central difference stencil:\n$$ \\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2}\\bigg|_{x_i} \\approx \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} $$\nThis approximation is applied to the interior nodes $i=1, 2, \\dots, N-2$. The homogeneous Dirichlet boundary conditions are enforced strongly by setting $c_0=c_{N-1}=0$ and $\\phi_0=\\phi_{N-1}=0$.\n\nApplying the stencil to the equation for $c(x)$:\n$$ -D \\left(\\frac{c_{i-1} - 2c_i + c_{i+1}}{h^2}\\right) + k c_i = S(x_i), \\quad \\text{for } i=1, \\dots, N-2 $$\nRearranging this equation gives the general row of the linear system for the unknown interior values $c_1, \\dots, c_{N-2}$:\n$$ -\\frac{D}{h^2} c_{i-1} + \\left(\\frac{2D}{h^2} + k\\right) c_i - \\frac{D}{h^2} c_{i+1} = S(x_i) $$\nThis defines an $(N-2) \\times (N-2)$ tridiagonal system of linear equations $A_c \\vec{c}_\\text{int} = \\vec{b}_c$.\n\nSimilarly, applying the stencil to the equation for $\\phi(x)$:\n$$ -\\kappa \\left(\\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2}\\right) = R(x_i), \\quad \\text{for } i=1, \\dots, N-2 $$\nRearranging gives the linear system for $\\phi_1, \\dots, \\phi_{N-2}$:\n$$ -\\frac{\\kappa}{h^2} \\phi_{i-1} + \\frac{2\\kappa}{h^2} \\phi_i - \\frac{\\kappa}{h^2} \\phi_{i+1} = R(x_i) $$\nThis defines a second $(N-2) \\times (N-2)$ tridiagonal system $A_\\phi \\vec{\\phi}_\\text{int} = \\vec{b}_\\phi$.\n\n**3. Error Analysis and Order of Accuracy**\nFor each test case and for each grid size $N$ in the sequence $\\{25, 50, 100, 200\\}$, we construct and solve these two linear systems. The numerical solutions, $c_{\\text{num}}$ and $\\phi_{\\text{num}}$, are compared to the exact solutions, $c^\\star$ and $\\phi^\\star$, at the grid nodes.\n\nThe error vector for each field is $e_u(x_i) = u_{\\text{num}}(x_i) - u^\\star(x_i)$. The discrete $L^2$ error norm is then computed as specified:\n$$ \\|e_u\\|_2 \\approx \\sqrt{h \\sum_{i=0}^{N-1} (e_u(x_i))^2} $$\nNote that since the boundary conditions are enforced strongly and the manufactured solutions also satisfy them, the error at the boundary nodes $i=0$ and $i=N-1$ is identically zero.\n\nThe theoretical convergence of a numerical method is described by the relation $\\|e\\|_2 \\approx C h^p$, where $C$ is a constant and $p$ is the order of accuracy. For the second-order stencil used, we expect $p \\approx 2$. To find the observed order of accuracy, we take the logarithm of this relation:\n$$ \\log(\\|e\\|_2) \\approx \\log(C) + p \\log(h) $$\nThis shows a linear relationship between $\\log(\\|e\\|_2)$ and $\\log(h)$. Therefore, by computing the error norms for a sequence of decreasing grid spacings $h$, we can estimate $p$ as the slope of a line fitted to the $(\\log(h), \\log(\\|e\\|_2))$ data points. A least-squares linear regression is used for this purpose. This procedure is performed for both $c(x)$ and $\\phi(x)$ for each set of physical parameters.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to perform grid refinement and calculate convergence orders.\n    \"\"\"\n\n    def solve_case(L, D, k, kappa):\n        \"\"\"\n        Solves the BVP for a single set of parameters over a sequence of grids.\n        \n        Args:\n            L (float): Domain length [m].\n            D (float): Effective diffusivity [m^2/s].\n            k (float): Effective reaction rate [1/s].\n            kappa (float): Effective ionic conductivity [S/m].\n            \n        Returns:\n            tuple: A tuple (p_c, p_phi) containing the observed orders of accuracy.\n        \"\"\"\n        N_values = [25, 50, 100, 200]\n        h_values = []\n        errors_c = []\n        errors_phi = []\n\n        for N in N_values:\n            # 1. Grid setup\n            h = L / (N - 1)\n            h_values.append(h)\n            # Full grid including boundaries\n            x_full = np.linspace(0.0, L, N)\n            # Interior grid for solving the linear system\n            x_interior = x_full[1:-1]\n            num_interior = N - 2\n\n            # 2. Solve for concentration c(x)\n            # A_c matrix (tridiagonal)\n            diag_c = (2.0 * D / h**2 + k) * np.ones(num_interior)\n            off_diag_c = (-D / h**2) * np.ones(num_interior - 1)\n            A_c = np.diag(diag_c) + np.diag(off_diag_c, k=1) + np.diag(off_diag_c, k=-1)\n            \n            # b_c vector (source term S(x))\n            S_interior = (D * (np.pi / L)**2 + k) * np.sin(np.pi * x_interior / L)\n            b_c = S_interior\n            \n            # Solve for interior points\n            c_interior = np.linalg.solve(A_c, b_c)\n            # Reconstruct full solution with boundary conditions\n            c_num = np.concatenate(([0.0], c_interior, [0.0]))\n            \n            # Compute error for c(x)\n            c_exact = np.sin(np.pi * x_full / L)\n            e_c = c_num - c_exact\n            error_norm_c = np.sqrt(h * np.sum(e_c**2))\n            errors_c.append(error_norm_c)\n\n            # 3. Solve for potential phi(x)\n            # A_phi matrix (tridiagonal)\n            diag_phi = (2.0 * kappa / h**2) * np.ones(num_interior)\n            off_diag_phi = (-kappa / h**2) * np.ones(num_interior - 1)\n            A_phi = np.diag(diag_phi) + np.diag(off_diag_phi, k=1) + np.diag(off_diag_phi, k=-1)\n            \n            # b_phi vector (source term R(x))\n            R_interior = kappa * (2.0 * np.pi / L)**2 * np.sin(2.0 * np.pi * x_interior / L)\n            b_phi = R_interior\n\n            # Solve for interior points\n            phi_interior = np.linalg.solve(A_phi, b_phi)\n            # Reconstruct full solution with boundary conditions\n            phi_num = np.concatenate(([0.0], phi_interior, [0.0]))\n\n            # Compute error for phi(x)\n            phi_exact = np.sin(2.0 * np.pi * x_full / L)\n            e_phi = phi_num - phi_exact\n            error_norm_phi = np.sqrt(h * np.sum(e_phi**2))\n            errors_phi.append(error_norm_phi)\n\n        # 4. Calculate order of accuracy using linear regression on log-log data\n        log_h = np.log(h_values)\n        log_errors_c = np.log(errors_c)\n        log_errors_phi = np.log(errors_phi)\n\n        # np.polyfit returns [slope, intercept]; slope is the order p\n        p_c, _ = np.polyfit(log_h, log_errors_c, 1)\n        p_phi, _ = np.polyfit(log_h, log_errors_phi, 1)\n\n        return p_c, p_phi\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0e-4, 1.0e-10, 5.0, 5.0e-1),  # Test case 1\n        (5.0e-4, 5.0e-11, 2.0, 5.0e-2),  # Test case 2\n        (5.0e-5, 1.0e-12, 1.0e2, 1.5)    # Test case 3\n    ]\n\n    results = []\n    for case in test_cases:\n        L_case, D_case, k_case, kappa_case = case\n        p_c_res, p_phi_res = solve_case(L_case, D_case, k_case, kappa_case)\n        results.append(p_c_res)\n        results.append(p_phi_res)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}