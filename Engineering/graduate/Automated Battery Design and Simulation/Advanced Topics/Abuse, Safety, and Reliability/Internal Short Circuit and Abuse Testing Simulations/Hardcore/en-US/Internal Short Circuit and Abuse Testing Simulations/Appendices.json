{
    "hands_on_practices": [
        {
            "introduction": "In battery safety simulation, choosing the right level of model complexity is a critical first step. While a full three-dimensional thermal model of a jelly roll is comprehensive, it is also computationally expensive. This practice guides you through a fundamental analysis to determine when a simpler one-dimensional model might be sufficient . By deriving characteristic thermal diffusion times directly from the heat equation, you will develop the essential skill of using dimensional analysis to justify model simplifications, a powerful tool for any simulation engineer.",
            "id": "3921550",
            "problem": "A cylindrical jelly-roll lithium-ion cell experiences a localized Internal Short Circuit (ISC) event that deposits heat near an axial midplane over a short duration. To assess whether a one-dimensional (1D) through-thickness thermal model suffices to simulate the early transient during such short events, compare thermal diffusion time scales across the electrode-separator stack thickness and across the jelly-roll radius. Begin from the heat conduction equation and fundamental thermophysical definitions, without invoking any pre-derived shortcut relations, and derive the characteristic diffusion time scales by dimensional analysis.\n\nConsider the following scientifically plausible, homogenized effective properties and dimensions for the composite stack and jelly roll:\n- Effective mass density: $\\rho = 2.2 \\times 10^{3}\\ \\mathrm{kg\\,m^{-3}}$,\n- Effective specific heat capacity: $c_{p} = 9.0 \\times 10^{2}\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$,\n- Effective through-thickness thermal conductivity of the layered electrode-separator stack: $k_{z} = 0.55\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$,\n- Effective radial thermal conductivity across the jelly roll: $k_{r} = 0.20\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$,\n- Electrode-separator stack thickness (two coatings plus separator, treated as one slab): $L_{z} = 1.5 \\times 10^{-4}\\ \\mathrm{m}$,\n- Characteristic radial length from the ISC site to the cell casing: $L_{r} = 8.0 \\times 10^{-3}\\ \\mathrm{m}$.\n\nUsing the heat conduction equation and dimensional analysis, derive the characteristic thermal diffusion time across the thickness, $t_{z}$, and across the radius, $t_{r}$, and use these to infer the regime of event duration $t_{\\mathrm{event}}$ for which a 1D through-thickness thermal model is adequate during short transients (i.e., when cross-thickness temperature gradients relax but radial redistribution remains limited). As your final numeric output, report the ratio $t_{r}/t_{z}$. Round your final ratio to three significant figures and express it as a pure number (dimensionless) in scientific notation.",
            "solution": "The analysis begins with the fundamental governing equation for heat transfer in a solid, the heat conduction equation. In the absence of fluid motion and considering a potential internal heat source $\\dot{q}$, the equation is:\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} = \\nabla \\cdot (k \\nabla T) + \\dot{q}\n$$\nHere, $\\rho$ is the mass density, $c_p$ is the specific heat capacity at constant pressure, $T$ is the temperature, $t$ is time, $k$ is the thermal conductivity (which can be a tensor in anisotropic materials), and $\\dot{q}$ is the volumetric heat generation rate.\n\nThe characteristic thermal diffusion time, $\\tau$, is the time scale over which heat diffuses across a characteristic length, $L$. To derive this time scale, we perform a dimensional analysis on the transient and diffusive terms of the heat equation, as the diffusion time scale is an intrinsic property of the heat propagation, independent of the source term $\\dot{q}$. We balance the transient term with the divergence of the heat flux term:\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} \\sim \\nabla \\cdot (k \\nabla T)\n$$\nWe replace the differential operators with characteristic scales. Let $\\Delta T$ be a characteristic temperature difference over the length scale $L$, and let $\\tau$ be the characteristic time for this thermal change to occur.\nThe left-hand side (transient term) scales as:\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} \\sim \\rho c_p \\frac{\\Delta T}{\\tau}\n$$\nThe right-hand side (diffusion term) scales as:\n$$\n\\nabla \\cdot (k \\nabla T) \\sim \\frac{k \\Delta T}{L^2}\n$$\nEquating the scales of these two terms gives:\n$$\n\\rho c_p \\frac{\\Delta T}{\\tau} \\sim \\frac{k \\Delta T}{L^2}\n$$\nThe characteristic temperature difference $\\Delta T$ cancels, leaving a relationship for the characteristic time $\\tau$:\n$$\n\\tau \\sim \\frac{\\rho c_p L^2}{k}\n$$\nThis expression represents the characteristic time for thermal diffusion. It is often expressed in terms of the thermal diffusivity, $\\alpha$, which is defined as $\\alpha = \\frac{k}{\\rho c_p}$. With this definition, the scaling becomes $\\tau \\sim \\frac{L^2}{\\alpha}$. The problem requires derivation from fundamental properties, so we will use the full expression.\n\nThe problem specifies two principal directions for heat flow, each with its own characteristic length and thermal conductivity. We apply the derived scaling relationship to each direction.\n\n1.  **Through-thickness diffusion time ($t_z$):**\n    For diffusion across the electrode-separator stack thickness, the characteristic length is $L_z$ and the relevant thermal conductivity is the effective through-thickness value, $k_z$. The corresponding characteristic time, $t_z$, is:\n    $$\n    t_z = \\frac{\\rho c_p L_z^2}{k_z}\n    $$\n\n2.  **Radial diffusion time ($t_r$):**\n    For diffusion across the jelly-roll radius, the characteristic length is $L_r$ and the conductivity is the effective radial value, $k_r$. The characteristic time, $t_r$, is:\n    $$\n    t_r = \\frac{\\rho c_p L_r^2}{k_r}\n    $$\n    The problem asks for the ratio of these two time scales, $\\frac{t_r}{t_z}$. We can form this ratio symbolically:\n    $$\n    \\frac{t_r}{t_z} = \\frac{\\left( \\frac{\\rho c_p L_r^2}{k_r} \\right)}{\\left( \\frac{\\rho c_p L_z^2}{k_z} \\right)}\n    $$\n    The material properties $\\rho$ and $c_p$ are treated as homogenized effective properties for the entire volume, so they cancel out:\n    $$\n    \\frac{t_r}{t_z} = \\frac{L_r^2}{k_r} \\cdot \\frac{k_z}{L_z^2} = \\left(\\frac{k_z}{k_r}\\right) \\left(\\frac{L_r}{L_z}\\right)^2\n    $$\n    This expression shows that the ratio of time scales depends on the ratio of thermal conductivities and the square of the ratio of the characteristic lengths.\n\nA one-dimensional ($1$D) through-thickness thermal model is a reasonable approximation when heat has had sufficient time to equilibrate across the thickness, but has not yet had significant time to spread radially. This corresponds to an event duration, $t_{\\mathrm{event}}$, that satisfies the condition $t_z \\ll t_{\\mathrm{event}} \\ll t_r$. A large ratio of $t_r/t_z$ indicates that such an intermediate time regime exists and is broad, justifying the use of a simplified $1$D model for early transient analysis following a short, localized heat deposition event.\n\nWe now substitute the given numerical values into the derived expression for the ratio:\n-   $k_z = 0.55\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n-   $k_r = 0.20\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n-   $L_z = 1.5 \\times 10^{-4}\\ \\mathrm{m}$\n-   $L_r = 8.0 \\times 10^{-3}\\ \\mathrm{m}$\n\nThe ratio is calculated as:\n$$\n\\frac{t_r}{t_z} = \\left(\\frac{0.55}{0.20}\\right) \\left(\\frac{8.0 \\times 10^{-3}}{1.5 \\times 10^{-4}}\\right)^2\n$$\n$$\n\\frac{t_r}{t_z} = (2.75) \\left(\\frac{80}{1.5}\\right)^2 = (2.75) \\left(\\frac{160}{3}\\right)^2\n$$\n$$\n\\frac{t_r}{t_z} = (2.75) \\left(\\frac{25600}{9}\\right) = \\frac{11}{4} \\cdot \\frac{25600}{9} = 11 \\cdot \\frac{6400}{9} = \\frac{70400}{9}\n$$\n$$\n\\frac{t_r}{t_z} \\approx 7822.22...\n$$\nThe problem requires the final answer to be rounded to three significant figures and expressed in scientific notation.\n$$\n\\frac{t_r}{t_z} \\approx 7.82 \\times 10^3\n$$\nThis large value confirms that radial heat diffusion is substantially slower than through-thickness diffusion, providing a wide time window where a $1$D model is a valid simplification.",
            "answer": "$$\n\\boxed{7.82 \\times 10^{3}}\n$$"
        },
        {
            "introduction": "Internal short circuits create extreme local conditions, such as current crowding and intense Joule heating, that simpler models often fail to capture. To accurately predict these phenomena, we turn to continuum models that solve the governing partial differential equations across the geometry. This practice provides a hands-on guide to implementing a two-dimensional axisymmetric Finite Volume Method (FVM) solver to simulate a localized short from first principles . You will learn how to mathematically represent a defect and compute the resulting current density enhancement, gaining insight into the core of advanced multiphysics simulation tools.",
            "id": "3921556",
            "problem": "You are tasked with implementing a mathematically consistent and computationally robust model of a localized internal short circuit in a two-dimensional axisymmetric conduction domain and computing the resulting local current density enhancement at the electrode-separator interface. The formulation must start from first principles and employ physically meaningful boundary conditions that can be implemented in a discrete solver.\n\nThe physical base is the steady-state conduction of electric charge in a homogeneous, isotropic medium with axisymmetric geometry. The governing equations are:\n- Conservation of charge: $\\nabla \\cdot \\mathbf{J} = 0$.\n- Ohm’s law for a homogeneous isotropic conductor: $\\mathbf{J} = -\\sigma \\nabla \\phi$ with conductivity $\\sigma$ in siemens per meter.\nCombining these yields the Laplace equation:\n$$\n\\nabla \\cdot \\left( \\sigma \\nabla \\phi \\right) = 0.\n$$\nIn cylindrical coordinates with axisymmetry (no dependence on the azimuthal angle), the operator is:\n$$\n\\frac{1}{r} \\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial \\phi}{\\partial r}\\right) + \\frac{\\partial^2 \\phi}{\\partial z^2} = 0,\n$$\nvalid for $r \\in [0,R]$ and $z \\in [0,L]$, where $R$ is the outer radius in meters and $L$ is the thickness in meters.\n\nTo represent electrode coupling consistently with an applied potential difference and allow nonuniform current distribution, model the top and bottom $z$-boundaries by linearized interfacial kinetics (a Robin boundary condition):\n$$\n-\\sigma \\frac{\\partial \\phi}{\\partial n} = k_{\\text{int}} \\left(\\phi - \\phi_{\\text{elec}}\\right),\n$$\nwhere $k_{\\text{int}}$ is the interfacial conductance in siemens per square meter and $\\phi_{\\text{elec}}$ is the uniform electrode potential in volts. Set $\\phi_{\\text{elec}} = 0$ at $z=0$ and $\\phi_{\\text{elec}} = V_{\\text{app}}$ at $z=L$, where $V_{\\text{app}}$ is the applied potential difference in volts. Impose zero radial flux at $r = 0$ and $r = R$ for physical insulation and symmetry:\n$$\n\\left. \\frac{\\partial \\phi}{\\partial r} \\right|_{r=0} = 0, \\quad \\left. \\frac{\\partial \\phi}{\\partial r} \\right|_{r=R} = 0.\n$$\n\nImplement a localized short circuit as a high-conductance interfacial link that enforces potential continuity between the two opposing boundary nodes in the limit of infinite conductance. Concretely, at a band of radii centered at $r = r_s$ of width $w_s$, add a shunt conductance per unit area $g_s$ (in siemens per square meter) that couples the bottom and top boundary at matching radial positions. In the limit $g_s \\to \\infty$, this link enforces $\\phi(r,0) \\approx \\phi(r,L)$ over the shorted band, representing a metallic dendrite bridging the electrodes. For finite but large $g_s$, the “potential continuity” is approximate and yields a large, localized current path.\n\nDiscretize the domain using a Finite Volume Method (FVM) on a uniform grid with $N_r$ cells in the radial direction and $N_z$ cells in the axial direction. Let the nodal potentials be $\\phi_{i,k}$ at cell centers $(r_i,z_k)$ with radial spacing $\\Delta r = R/N_r$ and axial spacing $\\Delta z = L/N_z$. Use control volumes with face areas and distances consistent with axisymmetric geometry:\n- Radial face at $r = r_f$ has area $A_r = 2 \\pi r_f \\Delta z$ and separation $\\Delta r$, yielding conductance $G_r = \\sigma A_r / \\Delta r$.\n- Axial face at $z = z_f$ for a control volume centered at $r=r_i$ has area $A_z = 2 \\pi r_i \\Delta r$ and separation $\\Delta z$, yielding conductance $G_z = \\sigma A_z / \\Delta z$.\n\nImpose the interfacial boundary condition at $z=0$ and $z=L$ by connecting each boundary control volume to its electrode with a lumped conductance $G_{\\text{int}} = k_{\\text{int}} A_z$. This yields, for a boundary node at $z=0$, a contribution $G_{\\text{int}}(\\phi_{i,0}-0)$; for a boundary node at $z=L$, a contribution $G_{\\text{int}}(\\phi_{i,N_z-1} - V_{\\text{app}})$. The outer radius $r=R$ and the axis $r=0$ are treated as insulated faces by omitting radial neighbor fluxes on those faces.\n\nImplement the localized short by adding, at each boundary node pair $(i,0)$ and $(i,N_z-1)$ whose center radius $r_i$ lies in the band $[r_s - w_s/2,\\, r_s + w_s/2]$, a shunt conductance $G_s = g_s A_z$ linking the two nodes. This contributes $G_s(\\phi_{i,0} - \\phi_{i,N_z-1})$ to the nodal current balance at $z=0$ and the opposite at $z=L$.\n\nAfter solving the resulting linear system for $\\phi_{i,k}$, compute the local normal current density entering from the bottom electrode at each radial location as\n$$\nJ_{\\text{bot}}(r_i) = k_{\\text{int}} \\left(\\phi_{i,0} - 0\\right),\n$$\nin amperes per square meter. Define the enhancement factor as the ratio of the maximum local bottom current density to a far-field median baseline, excluding the shorted band and its immediate neighbors to avoid contamination:\n$$\n\\mathcal{E} = \\frac{\\max_i J_{\\text{bot}}(r_i)}{\\operatorname{median}\\{J_{\\text{bot}}(r_i) : r_i \\notin [r_s - 2 w_s,\\, r_s + 2 w_s]\\}}.\n$$\nIf the exclusion interval removes all radial positions, instead use the reduced exclusion $[r_s - w_s,\\, r_s + w_s]$. Report $\\mathcal{E}$ as a dimensionless float rounded to six decimal places.\n\nYour program must implement the above model and produce results for the following test suite. All quantities are in SI units, with $r_s$ and $w_s$ in meters, $\\sigma$ in siemens per meter, $k_{\\text{int}}$ in siemens per square meter, $R$ and $L$ in meters, and $V_{\\text{app}}$ in volts. The mesh sizes $N_r$ and $N_z$ are integers.\n\nTest cases:\n- Case A (happy path, strong short): $\\sigma = 1.2$, $k_{\\text{int}} = 5000$, $R = 0.005$, $L = 1.0 \\times 10^{-4}$, $V_{\\text{app}} = 0.1$, $r_s = 0.002$, $w_s = 4.0 \\times 10^{-4}$, $g_s = 1.0 \\times 10^{8}$, $N_r = 60$, $N_z = 20$.\n- Case B (no short baseline): same as Case A but with $g_s = 0$.\n- Case C (short near the axis, narrow band): $\\sigma = 0.8$, $k_{\\text{int}} = 8000$, $R = 0.003$, $L = 8.0 \\times 10^{-5}$, $V_{\\text{app}} = 0.05$, $r_s = 2.0 \\times 10^{-4}$, $w_s = 3.0 \\times 10^{-4}$, $g_s = 5.0 \\times 10^{7}$, $N_r = 50$, $N_z = 18$.\n- Case D (weaker interface, moderate short): $\\sigma = 1.5$, $k_{\\text{int}} = 1000$, $R = 0.004$, $L = 1.2 \\times 10^{-4}$, $V_{\\text{app}} = 0.2$, $r_s = 0.003$, $w_s = 5.0 \\times 10^{-4}$, $g_s = 2.0 \\times 10^{7}$, $N_r = 70$, $N_z = 24$.\n\nYour program must produce a single line of output containing a list of four floats corresponding to the enhancement factors $\\mathcal{E}$ for the four cases, in the order A, B, C, D, rounded to six decimal places, formatted as a comma-separated list enclosed in square brackets (for example, $[\\text{E}_A,\\text{E}_B,\\text{E}_C,\\text{E}_D]$). No other output is permitted. Express the enhancement factor as a dimensionless float with six digits after the decimal point.",
            "solution": "We derive and implement a numerical model for axisymmetric conduction with a localized short from first principles. The governing physics is steady charge conservation, $\\nabla \\cdot \\mathbf{J} = 0$, combined with Ohm’s law for a homogeneous conductor, $\\mathbf{J} = -\\sigma \\nabla \\phi$, where $\\sigma$ is a scalar conductivity. These lead to the Laplace equation $\\nabla \\cdot (\\sigma \\nabla \\phi) = 0$. In cylindrical coordinates for axisymmetry, the equation is $(1/r)\\partial_r(r \\partial_r \\phi) + \\partial_{zz} \\phi = 0$ over the rectangle $r \\in [0,R]$, $z \\in [0,L]$.\n\nAt the top ($z=L$) and bottom ($z=0$) boundaries, we adopt a Robin boundary condition derived from a linear interfacial kinetics model with interfacial conductance $k_{\\text{int}}$:\n$$\n-\\sigma \\frac{\\partial \\phi}{\\partial n} = k_{\\text{int}} \\left(\\phi - \\phi_{\\text{elec}}\\right).\n$$\nThis condition relates the normal flux to the potential difference between the electrolyte and the electrode. It is advantageous because it provides a physically meaningful way to control current distributions given electrode potentials $\\phi_{\\text{elec}}$: at $z=0$, set $\\phi_{\\text{elec}} = 0$; at $z=L$, set $\\phi_{\\text{elec}} = V_{\\text{app}}$. On the radial boundaries, we impose insulation and symmetry:\n$$\n\\left. \\frac{\\partial \\phi}{\\partial r} \\right|_{r=0} = 0, \\quad \\left. \\frac{\\partial \\phi}{\\partial r} \\right|_{r=R} = 0.\n$$\n\nTo represent a localized internal short circuit, we add a high-conductance shunt coupling across the separator thickness localized in a narrow radial band. In the limit of very large shunt conductance per unit area $g_s$, the potentials on the two opposite faces within the band satisfy $\\phi(r,0) \\approx \\phi(r,L)$, which is the intended “potential continuity” across the defect representing a highly conductive metallic bridge.\n\nWe discretize the Laplace equation using a Finite Volume Method (FVM). Divide $r \\in [0,R]$ into $N_r$ equal cells of width $\\Delta r = R/N_r$ and $z \\in [0,L]$ into $N_z$ equal cells of height $\\Delta z = L/N_z$. Let the control volume centers be at $r_i = (i + 1/2)\\Delta r$ for $i = 0,1,\\dots,N_r-1$, and $z_k = (k + 1/2)\\Delta z$ for $k = 0,1,\\dots,N_z-1$. Associate an unknown potential $\\phi_{i,k}$ to each control volume.\n\nFor a control volume centered at $(r_i,z_k)$, the net current leaving the volume is the sum of fluxes through its faces, which must balance external sources or sinks. For axisymmetric geometry, the area of a radial face located at $r_f$ is $A_r = 2\\pi r_f \\Delta z$, while the area of an axial face is $A_z = 2\\pi r_i \\Delta r$. The conductance across a face is $G = \\sigma A / d$, where $d$ is the separation distance ($\\Delta r$ or $\\Delta z$). This yields the standard five-point stencil in $(r,z)$ adapted to axisymmetry:\n- Left radial face between $(i-1,k)$ and $(i,k)$: $r_f = (r_{i-1} + r_i)/2$, $A_r = 2\\pi r_f \\Delta z$, $G_{\\text{left}} = \\sigma A_r / \\Delta r$; contributes $G_{\\text{left}}(\\phi_{i,k} - \\phi_{i-1,k})$.\n- Right radial face between $(i,k)$ and $(i+1,k)$: $r_f = (r_i + r_{i+1})/2$, $A_r = 2\\pi r_f \\Delta z$, $G_{\\text{right}} = \\sigma A_r / \\Delta r$; contributes $G_{\\text{right}}(\\phi_{i,k} - \\phi_{i+1,k})$.\n- Bottom axial face between $(i,k-1)$ and $(i,k)$: $A_z = 2\\pi r_i \\Delta r$, $G_{\\text{down}} = \\sigma A_z / \\Delta z$; contributes $G_{\\text{down}}(\\phi_{i,k} - \\phi_{i,k-1})$.\n- Top axial face between $(i,k)$ and $(i,k+1)$: $A_z = 2\\pi r_i \\Delta r$, $G_{\\text{up}} = \\sigma A_z / \\Delta z$; contributes $G_{\\text{up}}(\\phi_{i,k} - \\phi_{i,k+1})$.\n\nAt $r=0$ and $r=R$, we omit the radial neighbor on the absent side, which enforces zero radial flux there. At $z=0$ and $z=L$, we add the Robin boundary condition by connecting the boundary control volumes to the electrodes via a lumped conductance $G_{\\text{int}} = k_{\\text{int}} A_z$. For a bottom boundary node $(i,0)$, the boundary contribution is $G_{\\text{int}}(\\phi_{i,0} - \\phi_{\\text{elec,bot}})$ with $\\phi_{\\text{elec,bot}} = 0$. For a top boundary node $(i,N_z-1)$, it is $G_{\\text{int}}(\\phi_{i,N_z-1} - \\phi_{\\text{elec,top}})$ with $\\phi_{\\text{elec,top}} = V_{\\text{app}}$. In the linear system form $\\mathbf{A}\\boldsymbol{\\phi} = \\mathbf{b}$, each such Robin term adds $G_{\\text{int}}$ to the diagonal and contributes $G_{\\text{int}} \\phi_{\\text{elec}}$ to the right-hand side.\n\nTo incorporate the localized short, identify all radial indices $i$ such that $r_i \\in [r_s - w_s/2,\\, r_s + w_s/2]$ and add a shunt conductance $G_s = g_s A_z$ between the pair of nodes $(i,0)$ and $(i,N_z-1)$. In the linear system, this contributes to both nodes’ balance:\n- Add $+G_s$ to both diagonals for $(i,0)$ and $(i,N_z-1)$.\n- Add $-G_s$ to the off-diagonal entries coupling $(i,0)$ with $(i,N_z-1)$ and vice versa.\nThese terms represent a high-conductance path directly linking the two faces at the same radial location and enforce $\\phi_{i,0} \\approx \\phi_{i,N_z-1}$ when $G_s$ is very large. Because the electrodes are represented by finite $k_{\\text{int}}$, the presence of the short redistributes interfacial currents by locally tying together the potentials, thereby creating a strong current density near the defect.\n\nOnce $\\boldsymbol{\\phi}$ is solved, the local normal current density at the bottom electrode is\n$$\nJ_{\\text{bot}}(r_i) = k_{\\text{int}} \\left(\\phi_{i,0} - 0\\right).\n$$\nThis follows directly from the Robin boundary condition: the interfacial current density is proportional to the potential drop across the interface. To quantify the local enhancement caused by the short, compute\n$$\n\\mathcal{E} = \\frac{\\max_i J_{\\text{bot}}(r_i)}{\\operatorname{median}\\{J_{\\text{bot}}(r_i) : r_i \\notin [r_s - 2 w_s,\\, r_s + 2 w_s]\\}}.\n$$\nIf the exclusion interval removes all indices, use the weaker exclusion interval $[r_s - w_s,\\, r_s + w_s]$. The resulting $\\mathcal{E}$ is dimensionless.\n\nAlgorithmic steps:\n1. Construct the radial and axial grids with $N_r$ and $N_z$, with $\\Delta r = R/N_r$ and $\\Delta z = L/N_z$, and centers $r_i$ and $z_k$.\n2. Initialize a sparse matrix $\\mathbf{A}$ of size $(N_r N_z) \\times (N_r N_z)$ and a right-hand side vector $\\mathbf{b}$.\n3. For each node $(i,k)$, accumulate face conductances $G_{\\text{left}}$, $G_{\\text{right}}$, $G_{\\text{down}}$, and $G_{\\text{up}}$ where applicable, adding to $\\mathbf{A}$ the diagonal and off-diagonal contributions corresponding to $(\\phi_{i,k} - \\phi_{\\text{neighbor}})$.\n4. For nodes at $z=0$ and $z=L$, add Robin boundary contributions with $G_{\\text{int}} = k_{\\text{int}} \\cdot 2\\pi r_i \\Delta r$ to the diagonal and to $\\mathbf{b}$ with the appropriate electrode potential.\n5. For each $i$ in the short band $[r_s - w_s/2,\\, r_s + w_s/2]$, add the shunt coupling between $(i,0)$ and $(i,N_z-1)$ with $G_s = g_s \\cdot 2\\pi r_i \\Delta r$ as described above.\n6. Solve $\\mathbf{A}\\boldsymbol{\\phi} = \\mathbf{b}$ for $\\boldsymbol{\\phi}$.\n7. Extract $\\phi_{i,0}$ for all $i$ and compute $J_{\\text{bot}}(r_i) = k_{\\text{int}} \\phi_{i,0}$.\n8. Compute the enhancement factor $\\mathcal{E}$ as the ratio of the maximum to the median of $J_{\\text{bot}}$ outside the exclusion band.\n9. Repeat for all test cases.\n\nUnits and realism: $\\sigma$ is in siemens per meter, $k_{\\text{int}}$ in siemens per square meter, $R$ and $L$ in meters, $V_{\\text{app}}$ in volts, and $g_s$ in siemens per square meter. The mesh sizes $N_r$ and $N_z$ are integers. The use of a Robin boundary condition ensures that current densities can redistribute in response to the localized short. In the no-short baseline with uniform parameters, the solution is radially uniform, and the enhancement should be unity within discretization tolerance. With a strong shunt, the local tie between bottom and top boundary potentials drives a significant increase in local interfacial current density near the short.\n\nNumerical considerations: The assembled matrix is symmetric positive definite for $\\sigma > 0$ and $k_{\\text{int}} \\ge 0$, and the addition of shunt conductances preserves positive definiteness. A sparse direct solver is suitable. Care must be taken at $r=0$ to not introduce spurious terms; the omission of the inner radial face implements the $\\partial \\phi/\\partial r = 0$ symmetry condition. The axisymmetric face areas $2\\pi r$ are included to conserve current correctly.\n\nThe program must output a single line with four floats corresponding to the enhancement factors for cases A, B, C, and D, rounded to six decimal places and formatted as $[\\cdot,\\cdot,\\cdot,\\cdot]$.",
            "answer": "[24.316007,1.000000,83.275811,10.370535]"
        },
        {
            "introduction": "Advanced abuse models can depend on numerous physical parameters, from material properties to reaction kinetics, many of which carry significant uncertainty. A brute-force exploration of this vast parameter space is computationally prohibitive. This practice introduces an efficient strategy: global sensitivity analysis using the Morris method to screen for the most critical parameters . By implementing this screening experiment, you will learn a powerful technique to identify which inputs drive the model's output, helping to focus research, guide experimental efforts, and build more robust simulations.",
            "id": "3921483",
            "problem": "You are tasked with implementing a One-At-a-Time (OAT) global sensitivity screening experiment based on the Morris method to identify non-influential parameters in a simplified internal short circuit abuse scenario for a lithium-ion cell. The goal is to decide which parameters can be fixed prior to running computationally expensive multiphysics simulations. The screening will use a physically derived lumped thermal model and will operate on a discretized parameter space.\n\nStarting from the following context-appropriate physical foundations:\n- Ohm’s law and Joule heating: for a cell with open-circuit voltage $V$ and total internal resistance $R_{tot}$, short-circuit current is $I = V / R_{tot}$ and total electrical power dissipation is $P_{elec} = I^2 R_{tot} = V^2 / R_{tot}$.\n- Lumped energy balance: with lumped thermal capacitance $C$ and combined convection coefficient times area $hA$, the cell temperature $T(t)$ evolves according to\n$$\nC \\frac{dT}{dt} = P_{elec} + Q_{rxn}(T) - hA \\left(T - T_a\\right),\n$$\nwhere $T_a$ is ambient temperature and $Q_{rxn}(T)$ is an exothermic reaction heat source activated beyond an onset temperature $T_{on}$.\n- Reaction heat modeling: use an Arrhenius-type activation above onset,\n$$\nQ_{rxn}(T) = H \\cdot \\mathbf{1}_{\\{T > T_{on}\\}} \\cdot \\exp\\left(-\\frac{E_a}{R_g T}\\right),\n$$\nwith reaction heat scale $H$ in $\\mathrm{W}$, activation energy $E_a$ in $\\mathrm{J/mol}$, and universal gas constant $R_g$ in $\\mathrm{J/(mol\\cdot K)}$.\n\nDefine the quantity of interest (QOI) as the maximum temperature reached over a fixed simulation horizon $[0, t_{end}]$,\n$$\nT_{max} = \\max_{t \\in [0,t_{end}]} T(t),\n$$\nwith initial condition $T(0) = T_a$. All temperatures must be in $\\mathrm{K}$, voltages in $\\mathrm{V}$, resistances in $\\Omega$, thermal capacitance in $\\mathrm{J/K}$, and convection coefficient-times-area in $\\mathrm{W/K}$. The universal gas constant should be taken as $R_g = 8.314\\,\\mathrm{J/(mol\\cdot K)}$.\n\nImplement the Morris OAT method on a $p$-level grid for a $d$-dimensional parameter vector $x \\in [0,1]^d$. The physical parameter vector is obtained by affine mapping of each normalized component $x_i$ to its physical range $[L_i, U_i]$ via\n$$\n\\theta_i(x_i) = L_i + x_i (U_i - L_i).\n$$\nUse the grid step $\\delta = 1/(p-1)$ so that a single parameter move corresponds to one grid increment. For each of $r$ random OAT trajectories:\n- Draw a random base point $x^{(0)}$ with each component on the grid $\\{0, \\delta, 2\\delta, \\dots, 1-\\delta\\}$ so that a forward move by $\\delta$ remains in $[0,1]$.\n- Draw a random permutation of the coordinate indices $\\pi$ of $\\{1,2,\\dots,d\\}$. Starting from $x^{(0)}$, for $j = 1$ to $d$, increment the coordinate $i = \\pi(j)$ by $\\delta$ to define $x^{(j)} = x^{(j-1)} + \\delta e_i$, where $e_i$ is the $i$-th standard basis vector.\n- For each such move, compute the elementary effect for coordinate $i$ as the forward difference quotient on the normalized domain:\n$$\nEE_i = \\frac{f\\big(x^{(j)}\\big) - f\\big(x^{(j-1)}\\big)}{\\delta},\n$$\nwhere $f(x)$ is the QOI $T_{max}$ obtained by integrating the energy balance over $[0, t_{end}]$ with Euler’s explicit method at a fixed time step $dt$.\n\nAggregate, for each parameter $i$, the collection of elementary effects across all trajectories to compute\n- the mean of absolute effects $\\mu_i^* = \\frac{1}{N_i} \\sum |EE_i|$,\n- and the standard deviation $\\sigma_i$ of the (signed) $EE_i$ values,\nwhere $N_i$ is the number of elementary effects collected for parameter $i$ (equal to $r$ under the procedure described).\n\nDecision rule: classify parameter $i$ as non-influential if both $\\mu_i^* \\le \\varepsilon$ and $\\sigma_i \\le \\gamma$, with thresholds $\\varepsilon$ and $\\gamma$ specified per test case. Thresholds are in $\\mathrm{K}$ per unit normalized step.\n\nYour program must implement this procedure and evaluate the following test suite. In all cases, take the activation energy to be fixed at $E_a = 1.2 \\times 10^5\\,\\mathrm{J/mol}$.\n\nTest case A (general case):\n- Parameter ranges (lower $L_i$, upper $U_i$):\n    - $V$: $[3.6, 4.2]\\,\\mathrm{V}$,\n    - $R_s$: $[0.002, 0.010]\\,\\Omega$,\n    - $R_{sh}$: $[0.0005, 0.0050]\\,\\Omega$,\n    - $C$: $[2000, 10000]\\,\\mathrm{J/K}$,\n    - $hA$: $[3, 25]\\,\\mathrm{W/K}$,\n    - $T_a$: $[298, 320]\\,\\mathrm{K}$,\n    - $T_{on}$: $[370, 420]\\,\\mathrm{K}$,\n    - $H$: $[0, 400]\\,\\mathrm{W}$.\n- Grid levels $p = 6$, trajectories $r = 10$, simulation horizon $t_{end} = 120\\,\\mathrm{s}$, time step $dt = 0.05\\,\\mathrm{s}$, thresholds $\\varepsilon = 1.0\\,\\mathrm{K}$ and $\\gamma = 0.5\\,\\mathrm{K}$.\n\nTest case B (edge case: reaction suppressed):\n- Parameter ranges:\n    - $V$: $[3.6, 4.2]\\,\\mathrm{V}$,\n    - $R_s$: $[0.002, 0.010]\\,\\Omega$,\n    - $R_{sh}$: $[0.0005, 0.0050]\\,\\Omega$,\n    - $C$: $[2000, 10000]\\,\\mathrm{J/K}$,\n    - $hA$: $[3, 25]\\,\\mathrm{W/K}$,\n    - $T_a$: $[298, 320]\\,\\mathrm{K}$,\n    - $T_{on}$: $[370, 420]\\,\\mathrm{K}$,\n    - $H$: $[0, 0]\\,\\mathrm{W}$.\n- Grid levels $p = 4$, trajectories $r = 8$, simulation horizon $t_{end} = 60\\,\\mathrm{s}$, time step $dt = 0.05\\,\\mathrm{s}$, thresholds $\\varepsilon = 0.8\\,\\mathrm{K}$ and $\\gamma = 0.4\\,\\mathrm{K}$.\n\nTest case C (boundary cooling-dominated regime):\n- Parameter ranges:\n    - $V$: $[3.6, 4.2]\\,\\mathrm{V}$,\n    - $R_s$: $[0.002, 0.010]\\,\\Omega$,\n    - $R_{sh}$: $[0.0005, 0.0050]\\,\\Omega$,\n    - $C$: $[2000, 10000]\\,\\mathrm{J/K}$,\n    - $hA$: $[20, 25]\\,\\mathrm{W/K}$,\n    - $T_a$: $[298, 320]\\,\\mathrm{K}$,\n    - $T_{on}$: $[370, 420]\\,\\mathrm{K}$,\n    - $H$: $[0, 400]\\,\\mathrm{W}$.\n- Grid levels $p = 6$, trajectories $r = 12$, simulation horizon $t_{end} = 180\\,\\mathrm{s}$, time step $dt = 0.05\\,\\mathrm{s}$, thresholds $\\varepsilon = 0.5\\,\\mathrm{K}$ and $\\gamma = 0.3\\,\\mathrm{K}$.\n\nYour program should output, for each test case, a Boolean list of length $8$ in the parameter order $\\left[V, R_s, R_{sh}, C, hA, T_a, T_{on}, H\\right]$ indicating non-influential parameters under the decision rule. The final output must be a single line containing a comma-separated list of the three Boolean lists enclosed in square brackets, for example\n$$\n[\\,[b_{A1},\\dots,b_{A8}],\\,[b_{B1},\\dots,b_{B8}],\\,[b_{C1},\\dots,b_{C8}]\\,],\n$$\nwith each $b_{\\cdot\\cdot}$ equal to either $\\mathrm{True}$ or $\\mathrm{False}$.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, mathematically well-posed, and provides a complete and consistent set of definitions, parameters, and objectives. The physical model, while simplified, is based on fundamental principles of thermal and electrical engineering. The Morris method for sensitivity analysis is a standard and appropriate technique for the stated goal of parameter screening. All required data for the three test cases are provided without ambiguity. The one minor point of interpretation is the definition of the total resistance $R_{tot}$ from the given series resistance $R_s$ and short-circuit resistance $R_{sh}$. The most direct and physically consistent interpretation for a simplified short-circuit model is that the voltage source drives a current through these two resistances in series, thus $R_{tot} = R_s + R_{sh}$. All other aspects of the problem are explicitly defined. We may therefore proceed with the solution.\n\nThe objective is to implement a global sensitivity screening using the Morris One-At-a-Time (OAT) method to identify non-influential parameters in a lumped-parameter thermal model of a lithium-ion cell experiencing an internal short circuit. A parameter is deemed non-influential if its corresponding sensitivity indices fall below specified thresholds.\n\nFirst, we formalize the physical model. The system is described by an ordinary differential equation (ODE) for the cell's temperature $T(t)$. The parameters to be investigated are the open-circuit voltage $V$, series resistance $R_s$, short-circuit resistance $R_{sh}$, thermal capacitance $C$, heat transfer coefficient-area product $hA$, ambient temperature $T_a$, reaction onset temperature $T_{on}$, and reaction heat scale $H$. The state variable is temperature $T(t)$, and the initial condition is $T(0) = T_a$.\n\nThe energy balance equation is given by:\n$$\nC \\frac{dT}{dt} = P_{elec} + Q_{rxn}(T) - Q_{cool}(T, T_a)\n$$\nwhere:\n1.  $P_{elec}$ is the electrical power dissipated as heat due to the short circuit. Based on Ohm's law, the current is $I = V / R_{tot}$ and the power is $P_{elec} = I^2 R_{tot}$. As reasoned above, we define the total resistance as $R_{tot} = R_s + R_{sh}$. This yields a constant Joule heating term:\n    $$\n    P_{elec} = \\frac{V^2}{R_s + R_{sh}}\n    $$\n2.  $Q_{rxn}(T)$ is the heat generated by exothermic side reactions, modeled with an Arrhenius-type expression activated above an onset temperature $T_{on}$:\n    $$\n    Q_{rxn}(T) = H \\cdot \\mathbf{1}_{\\{T > T_{on}\\}} \\cdot \\exp\\left(-\\frac{E_a}{R_g T}\\right)\n    $$\n    Here, $\\mathbf{1}_{\\{\\cdot\\}}$ is the indicator function, $E_a$ is the activation energy (fixed at $1.2 \\times 10^5\\,\\mathrm{J/mol}$), and $R_g$ is the universal gas constant ($8.314\\,\\mathrm{J/(mol\\cdot K)}$).\n3.  $Q_{cool}(T, T_a)$ is the heat lost to the environment via convection, described by Newton's law of cooling:\n    $$\n    Q_{cool}(T, T_a) = hA (T - T_a)\n    $$\n\nThe quantity of interest (QOI) is the maximum temperature reached during a simulation of duration $t_{end}$:\n$$\nT_{max} = \\max_{t \\in [0,t_{end}]} T(t)\n$$\nTo find $T_{max}$, we must solve the ODE numerically. We employ the explicit Euler method with a fixed time step $dt$. The temperature at time step $n+1$ is updated from the temperature at time step $n$ as:\n$$\nT^{n+1} = T^n + \\frac{dt}{C} \\left[ \\frac{V^2}{R_s + R_{sh}} + Q_{rxn}(T^n) - hA(T^n - T_a) \\right]\n$$\nThis integration is performed from $t=0$ to $t=t_{end}$, starting with $T^0 = T_a$, and the maximum temperature encountered is recorded. This entire calculation defines our model function, $f(x)$, where $x$ is the vector of normalized parameters.\n\nThe Morris method is a global sensitivity analysis technique that explores the parameter space through a series of trajectories. The $d=8$ dimensional parameter space is normalized to the unit hypercube $x \\in [0,1]^d$. The physical parameter vector $\\theta = [V, R_s, R_{sh}, C, hA, T_a, T_{on}, H]^T$ is obtained by scaling each component $x_i$ from its normalized range to its physical range $[L_i, U_i]$:\n$$\n\\theta_i(x_i) = L_i + x_i (U_i - L_i)\n$$\nThe parameter space is discretized into a $p$-level grid. The step size along any dimension in the normalized space is $\\delta = 1/(p-1)$.\n\nThe screening process involves generating $r$ random OAT trajectories. For each trajectory:\n1.  A random base point $x^{(0)}$ is chosen. Its components $x_i^{(0)}$ are selected from the grid $\\{0, \\delta, 2\\delta, \\dots, 1-\\delta\\}$ such that a forward step of $\\delta$ is always possible within the $[0,1]$ domain. This means each $x_i^{(0)}$ is drawn from $\\{0, \\delta, \\dots, (p-2)\\delta\\}$.\n2.  A random permutation $\\pi$ of the parameter indices $\\{0, 1, \\dots, d-1\\}$ is generated to determine the order of perturbation.\n3.  Starting with $y^{(0)} = f(x^{(0)})$, the trajectory is constructed by sequentially stepping each parameter. For $j=1, \\dots, d$, let $i = \\pi(j-1)$ be the index of the parameter to be perturbed. The new point is $x^{(j)} = x^{(j-1)} + \\delta e_i$, where $e_i$ is the $i$-th standard basis vector. The model is evaluated at this new point to get $y^{(j)} = f(x^{(j)})$.\n4.  The elementary effect for parameter $i$ for this trajectory is calculated as the finite difference:\n    $$\n    EE_i = \\frac{y^{(j)} - y^{(j-1)}}{\\delta} = \\frac{f(x^{(j)}) - f(x^{(j-1)})}{\\delta}\n    $$\n    This value is stored, and the process continues with $x^{(j)}$ becoming the base for the next perturbation.\n\nAfter generating $r$ trajectories, we will have collected $r$ elementary effects for each of the $d$ parameters. From this collection of effects $\\{EE_{i,1}, EE_{i,2}, \\dots, EE_{i,r}\\}$ for each parameter $i$, we compute two statistical measures:\n1.  The mean of the absolute values of the elementary effects, $\\mu_i^*$:\n    $$\n    \\mu_i^* = \\frac{1}{r} \\sum_{k=1}^{r} |EE_{i,k}|\n    $$\n    This metric estimates the overall influence of parameter $i$ on the output.\n2.  The standard deviation of the elementary effects, $\\sigma_i$:\n    $$\n    \\sigma_i = \\sqrt{\\frac{1}{r-1} \\sum_{k=1}^{r} (EE_{i,k} - \\bar{EE}_i)^2}\n    $$\n    where $\\bar{EE}_i$ is the mean of the $EE_{i,k}$. This metric estimates the extent of non-linear effects or interactions with other parameters. A high $\\sigma_i$ indicates that the effect of parameter $i$ changes depending on the values of other parameters.\n\nFinally, a parameter $i$ is classified as non-influential if both its metrics are below the given thresholds $\\varepsilon$ and $\\gamma$:\n$$\n\\text{Non-influential} \\iff (\\mu_i^* \\le \\varepsilon) \\land (\\sigma_i \\le \\gamma)\n$$\nThis entire procedure is applied to each of the three test cases specified, yielding a Boolean list for each case indicating the classification of each of the $8$ parameters.",
            "answer": "[[False, False, False, False, False, False, True, True],[False, False, False, True, False, False, True, True],[False, False, False, True, True, False, True, True]]"
        }
    ]
}