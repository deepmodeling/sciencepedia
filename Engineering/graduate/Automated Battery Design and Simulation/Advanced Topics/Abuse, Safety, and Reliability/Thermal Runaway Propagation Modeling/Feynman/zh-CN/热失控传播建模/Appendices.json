{
    "hands_on_practices": [
        {
            "introduction": "在构建热模型时，我们面临一个基本抉择：是采用将电池视为一个均温整体的集总参数模型，还是采用能够描述内部温度梯度的分布式模型。这个选择并非随意的，而是由系统内部热传导与外部热对流之间的竞争关系决定的。本实践将通过推导和计算毕渥数（Biot number），帮助你从第一性原理出发，掌握判断模型保真度选择的物理准则 。",
            "id": "3956756",
            "problem": "一个模块中的锂离子软包电池在热失控传播的早期阶段被建模。电极堆可被理想化为一个厚度为 $L$ 的一维平板，其一个面与冷板冷却剂接触，另一面与隔热背衬接触（与冷板相比，相邻组件带走的热量可忽略不计）。冷板对温度为 $T_{\\infty}$ 的流体施加对流作用，其特征是传热系数为 $h$。在电极堆内部，热量沿厚度方向传导，其等效导热系数为 $k$，该系数考虑了电极、隔膜和集流体的分层复合结构。在快速放热事件中，可能会发生内部体积生热，但为了评估空间集总法的适用性，我们关注厚度方向的内部传导与冷却面的外部对流之间的竞争关系。\n\n仅从傅里叶热传导定律和牛顿冷却定律出发，构建一个无量纲群，用于比较在这种单面冷却配置下，沿厚度方向的内部传导热阻与冷却表面的外部对流热阻。然后，使用以下代表大型软包电池的参数，计算该无量纲群的值：\n- 电极堆厚度 $L = 3.75\\ \\mathrm{mm}$，\n- 厚度方向等效导热系数 $k = 0.30\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$，\n- 冷却面处的对流传热系数 $h = 500\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n\n根据第一性原理和您所构建的无量纲群的含义，陈述在热失控传播过程中，何时对电极堆使用集总电容热模型是合理的，以及何时需要使用分层传导模型。将您计算出的无量纲数表示为一个纯数，并将您的答案四舍五入到四位有效数字。",
            "solution": "问题陈述经评估具有科学依据、提法明确、客观且完整。它基于热传递的基本原理（傅里叶热传导定律和牛顿冷却定律），并应用于电池热管理中的一个现实工程场景。给定的参数在物理上是合理的，并且量纲一致。因此，该问题是有效的，将提供解答。\n\n目标是推导一个无量纲群，用于比较电芯厚度方向的内部传导热阻与冷却表面的外部对流热阻。这需要基于第一性原理来构建这两个热阻的表达式。\n\n让我们考虑一个厚度为 $L$、横截面积为 $A$ 的一维平板。热量沿厚度方向（我们定义为 $x$ 方向）流动，从位于 $x=0$ 的绝热面流向位于 $x=L$ 的冷却面。\n\n由传导引起的内部热阻 $R_{\\text{cond}}$，是从傅里叶热传导定律推导出来的。该定律指出，热通量 $q_x$ 与温度梯度成正比：\n$$q_x = -k \\frac{dT}{dx}$$\n其中 $k$ 是导热系数。通过面积 $A$ 的总传热速率 $Q$ 为 $Q = q_x A$。对于通过厚度为 $L$ 的平板的稳态热传导，我们可以将温度梯度近似为 $\\frac{\\Delta T_{\\text{internal}}}{L}$，其中 $\\Delta T_{\\text{internal}}$ 是绝热面和冷却面之间的温差。那么传热速率为：\n$$Q \\approx kA \\frac{\\Delta T_{\\text{internal}}}{L}$$\n热阻定义为驱动热流的温差与热流速率之比。因此，内部传导热阻为：\n$$R_{\\text{cond}} = \\frac{\\Delta T_{\\text{internal}}}{Q} = \\frac{L}{kA}$$\n请注意，在这种单面冷却配置中，整个厚度 $L$ 代表了传导的特征长度。\n\n由对流引起的外部热阻 $R_{\\text{conv}}$，是从牛顿冷却定律推导出来的。该定律描述了从温度为 $T_s$ 的固体表面到温度为 $T_{\\infty}$ 的周围流体之间的热传递：\n$$Q = hA (T_s - T_{\\infty})$$\n其中 $h$ 是对流传热系数，$\\Delta T_{\\text{external}} = T_s - T_{\\infty}$ 是表面与流体之间的温差。因此，外部对流热阻为：\n$$R_{\\text{conv}} = \\frac{\\Delta T_{\\text{external}}}{Q} = \\frac{1}{hA}$$\n\n问题要求一个无量纲群，用于比较内部传导热阻和外部对流热阻。我们通过计算它们的比值来构建这个群：\n$$\\text{Dimensionless Group} = \\frac{R_{\\text{cond}}}{R_{\\text{conv}}} = \\frac{L/kA}{1/hA}$$\n面积 $A$ 被消掉，得到表达式：\n$$\\text{Dimensionless Group} = \\frac{hL}{k}$$\n这个无量纲群被称为毕渥数，记为 $Bi$。\n\n毕渥数 $Bi = \\frac{hL}{k}$ 的物理意义是，它代表了物体*内部*的传热阻力与物体*表面*的传热阻力之比。\n\n当物体内部的温度梯度可以忽略不计时，使用集总电容热模型是合理的，这意味着在任何给定时刻，物体的温度可以被认为是其整个体积内均匀的。这种情况发生在内部传导热阻远小于外部对流热阻时（$R_{\\text{cond}} \\ll R_{\\text{conv}}$）。如果内阻很低，热量在物体内部重新分布的速度远快于从表面散失的速度。用毕渥数表示，这个判据为：\n$$Bi = \\frac{hL}{k} \\ll 1$$\n在工程实践中，当 $Bi  0.1$ 时，通常认为集总电容模型是适用的。对于不小的 $Bi$ 值（例如 $Bi > 0.1$），物体内部的温度梯度是显著的。这意味着需要一个分层传导模型（即，求解偏微分热方程）来准确地捕捉电极堆内的空间温度分布。\n\n现在，我们用给定的参数计算这个无量纲群的值：\n- 电极堆厚度 $L = 3.75\\ \\mathrm{mm} = 3.75 \\times 10^{-3}\\ \\mathrm{m}$\n- 厚度方向等效导热系数 $k = 0.30\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n- 对流传热系数 $h = 500\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n\n将这些值代入毕渥数的表达式中：\n$$Bi = \\frac{hL}{k} = \\frac{(500\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}) \\times (3.75 \\times 10^{-3}\\ \\mathrm{m})}{0.30\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}}$$\n$$Bi = \\frac{1.875\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}}{0.30\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}}$$\n$$Bi = 6.25$$\n问题要求答案四舍五入到四位有效数字。\n$$Bi = 6.250$$\n由于 $Bi = 6.250$，远大于 $0.1$，内部传导热阻比外部对流热阻大 $6$ 倍以上。这意味着在电极堆的厚度方向上会产生显著的温度梯度。因此，对于这种情况，集总电容模型将非常不准确，必须使用分层传导模型。",
            "answer": "$$\\boxed{6.250}$$"
        },
        {
            "introduction": "建立模型后，下一步是从中提取有意义的物理洞见。对于热失控而言，一个至关重要的动力学参数是温度指数增长的特征时间尺度，它直接关系到安全系统的响应速度要求。本练习将引导你应用线性稳定性分析这一强大工具，对非线性的热平衡方程进行线性化，从而推导出热失控的特征时间 。",
            "id": "3956764",
            "problem": "电池包中的单个锂离子电池被建模为具有温度 $T(t)$ 的空间集总热容体。第一性原理能量平衡方程为\n$m c_{p} \\,\\frac{dT}{dt} = \\dot{Q}_{\\text{rxn}}(T) - h A \\left(T - T_{\\text{amb}}\\right)$,\n其中，$m$ 是电池质量，$c_{p}$ 是等压热容，$\\dot{Q}_{\\text{rxn}}(T)$ 是由分解反应引起的热激活放热速率，$h$ 是到冷却流的有效对流传热系数，$A$ 是外部传热面积，$T_{\\text{amb}}$ 是环境温度。假设在温度 $T^{\\ast}$ 处存在一个稳态，满足 $\\dot{Q}_{\\text{rxn}}(T^{\\ast}) = h A \\left(T^{\\ast} - T_{\\text{amb}}\\right)$。反应热速率是阿伦尼乌斯激活的，其形式为 $\\dot{Q}_{\\text{rxn}}(T) = Q_{0}\\,\\exp\\!\\left(-\\frac{E}{R\\,T}\\right)$，其中 $Q_{0}$ 是指前因子，$E$ 是活化能，$R$ 是通用气体常数。\n\n仅使用能量平衡和阿伦尼乌斯形式，在 $T^{\\ast}$ 附近进行一阶线性化，得到一个关于扰动 $\\theta(t) \\equiv T(t)-T^{\\ast}$ 的标量线性常微分方程，其形式为 $\\frac{d\\theta}{dt} = \\lambda\\,\\theta$，并由此根据在 $T^{\\ast}$ 处评估的基本量，确定特征时间尺度 $\\tau \\equiv \\lambda^{-1}$。然后，使用以下数据，计算 $\\tau$ 的数值。\n\n给定数据：\n- $m = 0.070$ kg, $c_{p} = 1000$ J kg$^{-1}$ K$^{-1}$，因此 $m c_{p}$ 是有限正数。\n- $h = 8.0$ W m$^{-2}$ K$^{-1}$ 且 $A = 0.010$ m$^{2}$。\n- $T_{\\text{amb}} = 300$ K 且 $T^{\\ast} = 500$ K。\n- $E = 1.10 \\times 10^{5}$ J mol$^{-1}$ 且 $R = 8.314$ J mol$^{-1}$ K$^{-1}$。\n- 在 $T^{\\ast}$ 处的稳态放热量为 $\\dot{Q}_{\\text{rxn}}(T^{\\ast}) = 50.0$ W。\n\n说明：\n1. 从第一性原理出发，符号化地推导出线性化增长率 $\\lambda$，并清楚地说明在 $T^{\\ast}$ 处的各量如何进入表达式。\n2. 使用阿伦尼乌斯形式和给定数据，计算 $\\frac{\\partial \\dot{Q}_{\\text{rxn}}}{\\partial T}\\big|_{T^{\\ast}}$。\n3. 计算特征时间尺度 $\\tau \\equiv \\lambda^{-1}$，并将最终结果以秒为单位表示。将答案四舍五入到三位有效数字。\n你的最终答案必须是一个数字（最终方框答案中不带单位）。在你的推导过程中，说明你所做的任何假设，并根据给定的基本方程论证每一步。",
            "solution": "首先根据指定标准验证问题。\n\n**步骤 1：提取给定信息**\n- 控制常微分方程：$m c_{p} \\,\\frac{dT}{dt} = \\dot{Q}_{\\text{rxn}}(T) - h A \\left(T - T_{\\text{amb}}\\right)$。\n- 生热率：$\\dot{Q}_{\\text{rxn}}(T) = Q_{0}\\,\\exp\\!\\left(-\\frac{E}{R\\,T}\\right)$。\n- 稳态条件：在稳态温度 $T^{\\ast}$ 处，$\\dot{Q}_{\\text{rxn}}(T^{\\ast}) = h A \\left(T^{\\ast} - T_{\\text{amb}}\\right)$。\n- 扰动变量：$\\theta(t) \\equiv T(t)-T^{\\ast}$。\n- 期望的线性化形式：$\\frac{d\\theta}{dt} = \\lambda\\,\\theta$。\n- 特征时间尺度的定义：$\\tau \\equiv \\lambda^{-1}$。\n- 数据：\n  - $m = 0.070$ kg\n  - $c_{p} = 1000$ J kg$^{-1}$ K$^{-1}$\n  - $h = 8.0$ W m$^{-2}$ K$^{-1}$\n  - $A = 0.010$ m$^{2}$\n  - $T_{\\text{amb}} = 300$ K\n  - $T^{\\ast} = 500$ K\n  - $E = 1.10 \\times 10^{5}$ J mol$^{-1}$\n  - $R = 8.314$ J mol$^{-1}$ K$^{-1}$\n  - $\\dot{Q}_{\\text{rxn}}(T^{\\ast}) = 50.0$ W\n\n**步骤 2：使用提取的给定信息进行验证**\n基于以下分析，该问题被认为是有效的：\n- **科学依据**：该问题描述了一个集总参数热模型，这是传热学和化学工程中一个标准且有效的简化。能量平衡方程是热力学第一定律的直接应用。对反应项使用阿伦尼乌斯速率定律是化学动力学的基本原理。线性稳定性分析法是分析系统在稳态附近行为的标准数学技术。\n- **适定性**：该问题是适定的。它提供了一个清晰的控制方程、所有必要的参数和边界条件，以及一组特定的任务（推导和计算）。这些信息足以确定特征时间尺度 $\\tau$ 的唯一解。\n- **客观性**：该问题使用精确、客观的科学语言陈述。它没有歧义、主观看法或基于意见的陈述。\n- **一致性**：所有提供的数据在量纲上是一致的，并且对于所建模的系统（一个锂离子电池）在物理上是合理的。稳态条件是明确给出的，并且与控制方程一致。\n\n**步骤 3：结论与行动**\n问题有效。现在开始推导解答。\n\n推导从给定的电池温度 $T(t)$ 的能量平衡方程开始：\n$$m c_{p} \\,\\frac{dT}{dt} = \\dot{Q}_{\\text{rxn}}(T) - h A \\left(T - T_{\\text{amb}}\\right)$$\n我们需要分析系统在稳态温度 $T^{\\ast}$ 附近的稳定性。在此稳态下，温度是恒定的，所以 $\\frac{dT}{dt} = 0$。稳态下的控制方程是：\n$$0 = \\dot{Q}_{\\text{rxn}}(T^{\\ast}) - h A \\left(T^{\\ast} - T_{\\text{amb}}\\right)$$\n这与所提供的稳态条件一致。\n\n为了进行线性稳定性分析，我们引入一个对稳态温度的小扰动 $\\theta(t)$：\n$$T(t) = T^{\\ast} + \\theta(t)$$\n对时间求导，并注意 $T^{\\ast}$ 是一个常数，我们得到：\n$$\\frac{dT}{dt} = \\frac{d\\theta}{dt}$$\n将这些代入原始的能量平衡方程得到：\n$$m c_{p} \\frac{d\\theta}{dt} = \\dot{Q}_{\\text{rxn}}(T^{\\ast} + \\theta) - h A \\left((T^{\\ast} + \\theta) - T_{\\text{amb}}\\right)$$\n我们可以将右侧（RHS）重新排列为：\n$$\\text{RHS} = \\dot{Q}_{\\text{rxn}}(T^{\\ast} + \\theta) - h A \\left(T^{\\ast} - T_{\\text{amb}}\\right) - h A \\theta$$\n使用稳态条件 $\\dot{Q}_{\\text{rxn}}(T^{\\ast}) = h A (T^{\\ast} - T_{\\text{amb}})$，我们可以进行代换，但更直接的方法是线性化整个右侧。设 $F(T) = \\dot{Q}_{\\text{rxn}}(T) - h A (T - T_{\\text{amb}})$。我们在 $T = T^{\\ast}$ 附近对 $F(T)$ 进行一阶泰勒级数展开：\n$$F(T) \\approx F(T^{\\ast}) + \\frac{dF}{dT}\\bigg|_{T^{\\ast}} (T - T^{\\ast})$$\n根据稳态的定义，$F(T^{\\ast})=0$。其导数为：\n$$\\frac{dF}{dT} = \\frac{d}{dT} \\left[ \\dot{Q}_{\\text{rxn}}(T) - h A (T - T_{\\text{amb}}) \\right] = \\frac{d\\dot{Q}_{\\text{rxn}}}{dT} - h A$$\n在 $T^{\\ast}$ 处求值：\n$$\\frac{dF}{dT}\\bigg|_{T^{\\ast}} = \\frac{d\\dot{Q}_{\\text{rxn}}}{dT}\\bigg|_{T^{\\ast}} - h A$$\n将这些代回 $F(T) = F(T^{\\ast}+\\theta)$ 的展开式中：\n$$F(T^{\\ast}+\\theta) \\approx 0 + \\left( \\frac{d\\dot{Q}_{\\text{rxn}}}{dT}\\bigg|_{T^{\\ast}} - h A \\right) \\theta$$\n此处所做的假设是扰动 $\\theta$ 足够小，使得这个一阶近似是准确的。因此，关于 $\\theta(t)$ 的线性化微分方程为：\n$$m c_{p} \\frac{d\\theta}{dt} = \\left( \\frac{d\\dot{Q}_{\\text{rxn}}}{dT}\\bigg|_{T^{\\ast}} - h A \\right) \\theta$$\n为了匹配所要求的形式 $\\frac{d\\theta}{dt} = \\lambda \\theta$，我们除以热容 $m c_{p}$：\n$$\\frac{d\\theta}{dt} = \\frac{1}{m c_{p}} \\left( \\frac{d\\dot{Q}_{\\text{rxn}}}{dT}\\bigg|_{T^{\\ast}} - h A \\right) \\theta$$\n由此，我们确定线性化增长率 $\\lambda$：\n$$\\lambda = \\frac{1}{m c_{p}} \\left( \\frac{d\\dot{Q}_{\\text{rxn}}}{dT}\\bigg|_{T^{\\ast}} - h A \\right)$$\n\n接下来，我们使用阿伦尼乌斯形式 $\\dot{Q}_{\\text{rxn}}(T) = Q_{0} \\exp\\left(-\\frac{E}{RT}\\right)$ 来计算生热率的导数。使用链式法则：\n$$\\frac{d\\dot{Q}_{\\text{rxn}}}{dT} = Q_{0} \\cdot \\exp\\left(-\\frac{E}{RT}\\right) \\cdot \\frac{d}{dT}\\left(-\\frac{E}{RT}\\right)$$\n$$\\frac{d\\dot{Q}_{\\text{rxn}}}{dT} = Q_{0} \\exp\\left(-\\frac{E}{RT}\\right) \\cdot \\left(\\frac{E}{RT^2}\\right)$$\n我们可以认出 $Q_{0} \\exp\\left(-\\frac{E}{RT}\\right)$ 项就是 $\\dot{Q}_{\\text{rxn}}(T)$ 本身。所以，我们可以写成：\n$$\\frac{d\\dot{Q}_{\\text{rxn}}}{dT} = \\dot{Q}_{\\text{rxn}}(T) \\frac{E}{RT^2}$$\n在稳态温度 $T^{\\ast}$ 处对此进行求值得到：\n$$\\frac{d\\dot{Q}_{\\text{rxn}}}{dT}\\bigg|_{T^{\\ast}} = \\dot{Q}_{\\text{rxn}}(T^{\\ast}) \\frac{E}{R(T^{\\ast})^2}$$\n这样就完成了符号推导。现在我们计算数值。\n\n首先，我们计算导数项的值（说明 2）：\n$$\\frac{d\\dot{Q}_{\\text{rxn}}}{dT}\\bigg|_{T^{\\ast}} = (50.0 \\, \\text{W}) \\frac{1.10 \\times 10^5 \\, \\text{J mol}^{-1}}{(8.314 \\, \\text{J mol}^{-1} \\text{K}^{-1})(500 \\, \\text{K})^2} = \\frac{50.0 \\times 1.10 \\times 10^5}{8.314 \\times 250000} \\, \\text{W K}^{-1}$$\n$$\\frac{d\\dot{Q}_{\\text{rxn}}}{dT}\\bigg|_{T^{\\ast}} = \\frac{5.5 \\times 10^6}{2.0785 \\times 10^6} \\, \\text{W K}^{-1} \\approx 2.64614 \\, \\text{W K}^{-1}$$\n\n接下来，我们计算 $\\lambda$ 所需的其他项：\n- 热容项：$m c_{p} = (0.070 \\, \\text{kg}) \\times (1000 \\, \\text{J kg}^{-1} \\text{K}^{-1}) = 70 \\, \\text{J K}^{-1}$。\n- 热损失项：$h A = (8.0 \\, \\text{W m}^{-2} \\text{K}^{-1}) \\times (0.010 \\, \\text{m}^2) = 0.080 \\, \\text{W K}^{-1}$。\n\n现在我们可以计算 $\\lambda$：\n$$\\lambda = \\frac{1}{70 \\, \\text{J K}^{-1}} \\left( 2.64614 \\, \\text{W K}^{-1} - 0.080 \\, \\text{W K}^{-1} \\right)$$\n$$\\lambda = \\frac{2.56614 \\, \\text{W K}^{-1}}{70 \\, \\text{J K}^{-1}} = \\frac{2.56614 \\, (\\text{J s}^{-1}) \\text{K}^{-1}}{70 \\, \\text{J K}^{-1}} \\approx 0.036659 \\, \\text{s}^{-1}$$\n\n最后，我们计算特征时间尺度 $\\tau = \\lambda^{-1}$（说明 3）：\n$$\\tau = \\frac{1}{\\lambda} \\approx \\frac{1}{0.036659 \\, \\text{s}^{-1}} \\approx 27.278 \\, \\text{s}$$\n按照要求将结果四舍五入到三位有效数字：\n$$\\tau \\approx 27.3 \\, \\text{s}$$",
            "answer": "$$\\boxed{27.3}$$"
        },
        {
            "introduction": "任何理论模型的预测能力都取决于其参数的准确性。本章的最终实践将聚焦于建模流程中的关键一环：如何利用实验数据来估计模型参数。本练习将介绍贝叶斯推断（Bayesian inference）这一强大的统计框架，它不仅能估计参数值，还能量化不确定性 。",
            "id": "3956820",
            "problem": "考虑电池自动设计和仿真任务中的热失控传播建模参数推断问题。在许多成熟模型中，单个电池在传播前阶段的主要放热反应释热速率由一个Arrhenius型关系式描述。设在绝对温度 $T$ 下测得的产热速率模型为 $q(T) = A \\exp\\!\\left(-\\frac{E_a}{R T}\\right)$，其中 $A$ 是单位为瓦特的前指数因子，$E_a$ 是单位为焦耳/摩尔的活化能。假设测量过程受到对数正态分布的乘性噪声影响，其对数误差是独立的高斯误差。具体来说，用以下对数测量模型定义观测数据 $\\{(T_i, y_i)\\}_{i=1}^n$\n$$\n\\ln y_i = \\ln A - \\frac{E_a}{R\\,T_i} + \\varepsilon_i,\n$$\n其中 $R$ 是通用气体常数，$\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$ 是独立同分布的。假设为 $E_a$ 和 $\\ln A$ 设置了独立的高斯先验，\n$$\nE_a \\sim \\mathcal{N}(\\mu_E, \\sigma_E^2), \\quad \\ln A \\sim \\mathcal{N}(\\mu_A, \\sigma_A^2),\n$$\n并且 $E_a$ 和 $\\ln A$ 先验不相关。\n\n从这些假设和上述基本原理（Arrhenius关系式和高斯噪声）出发，通过对与 $1/T$ 相关的斜率进行适当的重参数化，将推断问题重构为线性高斯回归形式。然后，从高斯噪声模型中推导似然函数，使用贝叶斯法则推导线性参数的高斯后验分布，并将该后验分布映射回活化能 $E_a$，以获得其后验均值和方差的闭式解。您的程序必须为下面的每个测试用例计算 $E_a$ 的后验均值和后验方差，并按规定格式生成最终输出。\n\n常数和单位：\n- 使用 $R = 8.314$ 焦耳/摩尔·开尔文。\n- 所有温度 $T_i$ 的单位均为开尔文。\n- 所有热率 $y_i$ 的单位均为瓦特。\n- 报告 $E_a$ 的后验均值（单位为焦耳/摩尔）和后验方差（单位为 $(\\text{焦耳/摩尔})^2$）。\n\n测试套件（每个用例为 $(\\{T_i\\}, \\{y_i\\}, \\sigma, \\mu_A, \\sigma_A^2, \\mu_E, \\sigma_E^2)$）：\n\n1. 一般情况（中等噪声，信息丰富的先验）：\n   - 温度：$[500.0, 520.0, 540.0, 560.0, 580.0]$。\n   - 测得的热率：$[1.733, 4.129, 12.91, 26.33, 62.0]$。\n   - 噪声标准差：$\\sigma = 0.15$。\n   - $\\ln A$ 的先验：均值 $\\mu_A = 26.937$，方差 $\\sigma_A^2 = 0.25$。\n   - $E_a$ 的先验：均值 $\\mu_E = 110000.0$，方差 $\\sigma_E^2 = 10000.0^2$。\n\n2. 边界情况（接近零噪声，弱信息先验）：\n   - 温度：$[500.0, 520.0, 540.0, 560.0, 580.0]$。\n   - 测得的热率：$[1.65, 4.47, 11.45, 27.4, 62.0]$。\n   - 噪声标准差：$\\sigma = 1.0\\times 10^{-6}$。\n   - $\\ln A$ 的先验：均值 $\\mu_A = 26.937$，方差 $\\sigma_A^2 = 1.0$。\n   - $E_a$ 的先验：均值 $\\mu_E = 110000.0$，方差 $\\sigma_E^2 = 20000.0^2$。\n\n3. 高噪声情况（数据受严重扰动）：\n   - 温度：$[500.0, 520.0, 540.0, 560.0, 580.0]$。\n   - 测得的热率：$[2.720, 2.999, 13.99, 20.31, 68.52]$。\n   - 噪声标准差：$\\sigma = 0.5$。\n   - $\\ln A$ 的先验：均值 $\\mu_A = 26.937$，方差 $\\sigma_A^2 = 0.25$。\n   - $E_a$ 的先验：均值 $\\mu_E = 110000.0$，方差 $\\sigma_E^2 = 10000.0^2$。\n\n4. 边缘情况（数据点最少）：\n   - 温度：$[520.0, 580.0]$。\n   - 测得的热率：$[4.60, 60.77]$。\n   - 噪声标准差：$\\sigma = 0.15$。\n   - $\\ln A$ 的先验：均值 $\\mu_A = 26.937$，方差 $\\sigma_A^2 = 0.25$。\n   - $E_a$ 的先验：均值 $\\mu_E = 110000.0$，方差 $\\sigma_E^2 = 10000.0^2$。\n\n5. 先验不匹配情况（强偏倚先验）：\n   - 温度：$[500.0, 520.0, 540.0, 560.0, 580.0]$。\n   - 测得的热率：$[1.733, 4.129, 12.91, 26.33, 62.0]$。\n   - 噪声标准差：$\\sigma = 0.15$。\n   - $\\ln A$ 的先验：均值 $\\mu_A = 24.0$，方差 $\\sigma_A^2 = 0.04$。\n   - $E_a$ 的先验：均值 $\\mu_E = 80000.0$，方差 $\\sigma_E^2 = 5000.0^2$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试用例的顺序排列结果。对于每个测试用例，将 $E_a$ 的后验均值（单位为焦耳/摩尔）紧接着 $E_a$ 的后验方差（单位为 $(\\text{焦耳/摩尔})^2$）附加到列表中。例如，最终输出应类似于 $[m_1,v_1,m_2,v_2,m_3,v_3,m_4,v_4,m_5,v_5]$，其中 $m_k$ 和 $v_k$ 是浮点数。",
            "solution": "该问题要求在贝叶斯框架内推导并计算活化能 $E_a$ 的后验均值和方差。物理模型是用于产热的Arrhenius关系式，统计模型假设测量值存在对数正态的乘性噪声。推导过程主要分为四个步骤：将问题重构为标准的贝叶斯线性回归，推导线性模型参数的先验分布，应用贝叶斯定理求得线性参数的后验分布，最后将此后验分布变换回去，以获得 $E_a$ 的所需统计量。\n\n### 步骤 1：重构为线性高斯模型\n\n给定的测量模型是：\n$$\n\\ln y_i = \\ln A - \\frac{E_a}{R\\,T_i} + \\varepsilon_i\n$$\n其中 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$ 是独立同分布的噪声项。该方程已是线性模型的形式。为与标准回归表示法保持一致，我们进行重参数化。令响应变量为 $z_i = \\ln y_i$，预测变量为 $x_i = 1/T_i$。我们将线性参数 $\\beta_0$ 和 $\\beta_1$ 定义为：\n$$\n\\beta_0 = \\ln A \\quad \\text{and} \\quad \\beta_1 = -\\frac{E_a}{R}\n$$\n根据这些定义，单个观测 $i$ 的测量模型变为：\n$$\nz_i = \\beta_0 + \\beta_1 x_i + \\varepsilon_i\n$$\n对于包含 $n$ 个观测的完整数据集 $\\{(T_i, y_i)\\}_{i=1}^n$，我们可以将其表示为矩阵形式：\n$$\n\\mathbf{z} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}\n$$\n其中：\n- $\\mathbf{z} = [\\ln y_1, \\ln y_2, \\dots, \\ln y_n]^T$ 是观测到的对数热率的 $n \\times 1$ 向量。\n- $\\boldsymbol{\\beta} = [\\beta_0, \\beta_1]^T$ 是未知参数的 $2 \\times 1$ 向量。\n- $\\mathbf{X}$ 是 $n \\times 2$ 的设计矩阵，其中第 $i$ 行为 $[1, x_i] = [1, 1/T_i]$。\n$$\n\\mathbf{X} = \\begin{pmatrix}\n1  1/T_1 \\\\\n1  1/T_2 \\\\\n\\vdots  \\vdots \\\\\n1  1/T_n\n\\end{pmatrix}\n$$\n- $\\boldsymbol{\\varepsilon} = [\\varepsilon_1, \\varepsilon_2, \\dots, \\varepsilon_n]^T$ 是噪声项的 $n \\times 1$ 向量，其分布为 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^2 \\mathbf{I}_n)$，其中 $\\mathbf{I}_n$ 是 $n \\times n$ 的单位矩阵。\n\n根据此公式，给定参数 $\\boldsymbol{\\beta}$ 时数据 $\\mathbf{z}$ 的似然是一个多元高斯分布：\n$$\np(\\mathbf{z} | \\boldsymbol{\\beta}, \\sigma^2) = \\mathcal{N}(\\mathbf{z} | \\mathbf{X}\\boldsymbol{\\beta}, \\sigma^2 \\mathbf{I}_n) \\propto \\exp\\left(-\\frac{1}{2\\sigma^2} (\\mathbf{z} - \\mathbf{X}\\boldsymbol{\\beta})^T (\\mathbf{z} - \\mathbf{X}\\boldsymbol{\\beta})\\right)\n$$\n\n### 步骤 2：先验分布的推导\n\n问题指定了原始物理参数 $\\ln A$ 和 $E_a$ 的独立高斯先验：\n$$\n\\ln A \\sim \\mathcal{N}(\\mu_A, \\sigma_A^2) \\quad \\text{and} \\quad E_a \\sim \\mathcal{N}(\\mu_E, \\sigma_E^2)\n$$\n我们必须将这些先验转换为我们线性参数向量 $\\boldsymbol{\\beta} = [\\beta_0, \\beta_1]^T$ 的先验。\n$\\beta_0 = \\ln A$ 的先验是直接给出的：\n$$\np(\\beta_0) = \\mathcal{N}(\\beta_0 | \\mu_A, \\sigma_A^2)\n$$\n对于 $\\beta_1 = -E_a/R$，我们使用高斯随机变量线性变换的性质。$\\beta_1$ 的均值和方差为：\n$$\n\\mathbb{E}[\\beta_1] = \\mathbb{E}[-E_a/R] = -\\frac{1}{R}\\mathbb{E}[E_a] = -\\frac{\\mu_E}{R}\n$$\n$$\n\\text{Var}(\\beta_1) = \\text{Var}(-E_a/R) = \\left(-\\frac{1}{R}\\right)^2 \\text{Var}(E_a) = \\frac{\\sigma_E^2}{R^2}\n$$\n因此，$\\beta_1$ 的先验为：\n$$\np(\\beta_1) = \\mathcal{N}\\left(\\beta_1 \\Big| -\\frac{\\mu_E}{R}, \\frac{\\sigma_E^2}{R^2}\\right)\n$$\n由于 $\\ln A$ 和 $E_a$ 是先验独立的，$\\beta_0$ 和 $\\beta_1$ 也是先验独立的。$\\boldsymbol{\\beta}$ 的联合先验分布是一个多元高斯分布 $p(\\boldsymbol{\\beta}) = \\mathcal{N}(\\boldsymbol{\\beta} | \\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0)$，其均值向量为 $\\boldsymbol{\\mu}_0$，协方差矩阵为 $\\boldsymbol{\\Sigma}_0$：\n$$\n\\boldsymbol{\\mu}_0 = \\begin{pmatrix} \\mu_A \\\\ -\\mu_E/R \\end{pmatrix}, \\quad \\boldsymbol{\\Sigma}_0 = \\begin{pmatrix} \\sigma_A^2  0 \\\\ 0  \\sigma_E^2/R^2 \\end{pmatrix}\n$$\n\n### 步骤 3：后验分布的推导\n\n我们使用贝叶斯法则来求 $\\boldsymbol{\\beta}$ 的后验分布：\n$$\np(\\boldsymbol{\\beta} | \\mathbf{z}) \\propto p(\\mathbf{z} | \\boldsymbol{\\beta}) p(\\boldsymbol{\\beta})\n$$\n由于似然和先验都是高斯分布，后验也将是高斯分布，即 $p(\\boldsymbol{\\beta} | \\mathbf{z}) = \\mathcal{N}(\\boldsymbol{\\beta} | \\boldsymbol{\\mu}_n, \\boldsymbol{\\Sigma}_n)$。这是具有共轭先验的贝叶斯线性回归的标准结果。后验协方差矩阵 $\\boldsymbol{\\Sigma}_n$ 和后验均值向量 $\\boldsymbol{\\mu}_n$ 由以下公式给出：\n$$\n\\boldsymbol{\\Sigma}_n = \\left(\\boldsymbol{\\Sigma}_0^{-1} + \\frac{1}{\\sigma^2}\\mathbf{X}^T\\mathbf{X}\\right)^{-1}\n$$\n$$\n\\boldsymbol{\\mu}_n = \\boldsymbol{\\Sigma}_n \\left(\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 + \\frac{1}{\\sigma^2}\\mathbf{X}^T\\mathbf{z}\\right)\n$$\n其中先验精度矩阵 $\\boldsymbol{\\Sigma}_0^{-1}$ 为：\n$$\n\\boldsymbol{\\Sigma}_0^{-1} = \\begin{pmatrix} 1/\\sigma_A^2  0 \\\\ 0  R^2/\\sigma_E^2 \\end{pmatrix}\n$$\n这些方程为线性参数 $\\beta_0$ 和 $\\beta_1$ 的后验分布提供了闭式解。\n\n### 步骤 4：将后验映射到 $E_a$\n\n最后一步是求出我们感兴趣的原始参数 $E_a$ 的后验均值和方差。我们使用关系式 $E_a = -R\\beta_1$。$\\boldsymbol{\\beta}$ 的后验分布是一个多元高斯分布。这意味着任何单个分量（如 $\\beta_1$）的边际分布也是高斯分布。从后验 $\\mathcal{N}(\\boldsymbol{\\beta} | \\boldsymbol{\\mu}_n, \\boldsymbol{\\Sigma}_n)$ 中，$\\beta_1$ 的边际分布为：\n$$\np(\\beta_1 | \\mathbf{z}) = \\mathcal{N}(\\beta_1 | \\mu_{n,1}, \\Sigma_{n,11})\n$$\n其中 $\\mu_{n,1}$ 是 $\\boldsymbol{\\mu}_n$ 的第二个元素，$\\Sigma_{n,11}$ 是 $\\boldsymbol{\\Sigma}_n$ 的第二个对角元素（索引为 $(1,1)$）。\n\n使用线性变换 $E_a = -R\\beta_1$，我们可以求出 $E_a$ 的后验均值和方差：\n-   **$E_a$ 的后验均值**：\n    $$\n    \\mathbb{E}[E_a | \\mathbf{z}] = \\mathbb{E}[-R\\beta_1 | \\mathbf{z}] = -R \\cdot \\mathbb{E}[\\beta_1| \\mathbf{z}] = -R \\cdot \\mu_{n,1}\n    $$\n-   **$E_a$ 的后验方差**：\n    $$\n    \\text{Var}(E_a | \\mathbf{z}) = \\text{Var}(-R\\beta_1 | \\mathbf{z}) = (-R)^2 \\cdot \\text{Var}(\\beta_1| \\mathbf{z}) = R^2 \\cdot \\Sigma_{n,11}\n    $$\n这些公式使得我们可以直接计算每个测试用例所需的量。所提供代码中实现的算法直接遵循了这些推导出的表达式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_posterior(T_data, y_data, sigma, mu_A, sigma_A2, mu_E, sigma_E2):\n    \"\"\"\n    Computes the posterior mean and variance of the activation energy Ea.\n\n    Args:\n        T_data (list): List of temperatures in Kelvin.\n        y_data (list): List of measured heat rates in Watts.\n        sigma (float): Standard deviation of the logarithmic measurement noise.\n        mu_A (float): Prior mean of ln(A).\n        sigma_A2 (float): Prior variance of ln(A).\n        mu_E (float): Prior mean of Ea.\n        sigma_E2 (float): Prior variance of Ea.\n\n    Returns:\n        tuple: A tuple containing the posterior mean of Ea and posterior variance of Ea.\n    \"\"\"\n    R = 8.314  # Universal gas constant in J/(mol·K)\n\n    # Convert data lists to numpy arrays for vectorized operations\n    T = np.array(T_data, dtype=np.float64)\n    y = np.array(y_data, dtype=np.float64)\n    n = len(T)\n\n    # Step 1: Reformulate as a linear model z = X*beta + epsilon\n    # z = ln(y), x = 1/T\n    # beta = [beta_0, beta_1]^T = [ln(A), -Ea/R]^T\n    z = np.log(y)\n    x = 1.0 / T\n\n    # Construct the design matrix X\n    X = np.ones((n, 2), dtype=np.float64)\n    X[:, 1] = x\n\n    # Step 2: Define the prior distribution for beta\n    # Prior mean for beta\n    mu_0 = np.array([mu_A, -mu_E / R], dtype=np.float64)\n\n    # Prior covariance and precision for beta\n    Sigma_0 = np.array([[sigma_A2, 0.0], [0.0, sigma_E2 / (R**2)]], dtype=np.float64)\n    # Check for non-invertible prior covariance (e.g., zero variance)\n    if np.abs(np.linalg.det(Sigma_0))  1e-30:\n        # Use pseudo-inverse for stability, although not expected here\n        Sigma_0_inv = np.linalg.pinv(Sigma_0)\n    else:\n        Sigma_0_inv = np.linalg.inv(Sigma_0)\n\n    # Step 3: Compute the posterior distribution N(mu_n, Sigma_n) for beta\n    # Precision of the likelihood\n    lambda_lik = 1.0 / (sigma**2)\n\n    # Posterior precision matrix\n    # Sigma_n_inv = Sigma_0_inv + (1/sigma^2) * X^T * X\n    XTX = X.T @ X\n    Sigma_n_inv = Sigma_0_inv + lambda_lik * XTX\n\n    # Posterior covariance matrix\n    Sigma_n = np.linalg.inv(Sigma_n_inv)\n\n    # Posterior mean vector\n    # mu_n = Sigma_n * (Sigma_0_inv * mu_0 + (1/sigma^2) * X^T * z)\n    XTz = X.T @ z\n    mu_n = Sigma_n @ (Sigma_0_inv @ mu_0 + lambda_lik * XTz)\n\n    # Step 4: Map the posterior of beta back to the posterior of Ea\n    # The posterior for beta_1 is Gaussian with mean mu_n[1] and variance Sigma_n[1, 1].\n    # Ea = -R * beta_1\n    mu_n_beta1 = mu_n[1]\n    Sigma_n_beta1_var = Sigma_n[1, 1]\n\n    # Posterior mean of Ea\n    Ea_posterior_mean = -R * mu_n_beta1\n    \n    # Posterior variance of Ea\n    Ea_posterior_variance = (R**2) * Sigma_n_beta1_var\n\n    return Ea_posterior_mean, Ea_posterior_variance\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # 1. General case\n        (\n            [500.0, 520.0, 540.0, 560.0, 580.0],\n            [1.733, 4.129, 12.91, 26.33, 62.0],\n            0.15, 26.937, 0.25, 110000.0, 10000.0**2\n        ),\n        # 2. Boundary case (near-zero noise)\n        (\n            [500.0, 520.0, 540.0, 560.0, 580.0],\n            [1.65, 4.47, 11.45, 27.4, 62.0],\n            1.0e-6, 26.937, 1.0, 110000.0, 20000.0**2\n        ),\n        # 3. High-noise case\n        (\n            [500.0, 520.0, 540.0, 560.0, 580.0],\n            [2.720, 2.999, 13.99, 20.31, 68.52],\n            0.5, 26.937, 0.25, 110000.0, 10000.0**2\n        ),\n        # 4. Edge case (minimal data)\n        (\n            [520.0, 580.0],\n            [4.60, 60.77],\n            0.15, 26.937, 0.25, 110000.0, 10000.0**2\n        ),\n        # 5. Prior-mismatch case\n        (\n            [500.0, 520.0, 540.0, 560.0, 580.0],\n            [1.733, 4.129, 12.91, 26.33, 62.0],\n            0.15, 24.0, 0.04, 80000.0, 5000.0**2\n        ),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack the case tuple and call the computation function\n        mean, variance = compute_posterior(*case)\n        # Append results to the list\n        results.append(mean)\n        results.append(variance)\n\n    # Final print statement in the exact required format.\n    # Format each number to a reasonable number of decimal places for consistency\n    formatted_results = [f\"{r:.8f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}