{
    "hands_on_practices": [
        {
            "introduction": "The first line of defense in a cyber-physical system is often a robust physical design that can tolerate faults and malicious actions. This exercise explores the fundamental principle of redundancy as a means to guarantee system safety, specifically for detecting thermal runaway in a battery pack. You will apply basic probability theory to determine the minimum number of sensors, $n$, required to ensure a target detection probability even when a fixed number of sensors, $f$, are compromised by a worst-case adversary .",
            "id": "3903121",
            "problem": "A lithium-ion battery pack is instrumented with $n$ redundant temperature sensors for early detection of thermal runaway. The Battery Management System (BMS) uses an alarm rule that triggers an emergency shutdown if any sensor reports an overtemperature condition. Each uncompromised sensor, when an actual overtemperature condition is present, independently fails to report it with probability $\\beta \\in (0,1)$ (that is, each has false negative rate $\\beta$). To model cyber-physical adversaries, assume up to $f$ sensors can be compromised and will always suppress alarms (worst-case adversarial behavior). Assume conditional independence of sensor misses across uncompromised sensors given the presence of a true overtemperature condition.\n\nDesign the smallest integer $n$ such that, even in the presence of up to $f$ compromised sensors, the probability that the BMS triggers an alarm when an overtemperature condition is present (the detection probability) is at least $1-\\beta$. Express your final answer as a closed-form expression for $n$ in terms of $f$ and $\\beta$. No rounding is required. State the final expression without units.",
            "solution": "The problem statement is first validated according to the specified criteria.\n\n### Step 1: Extract Givens\n- Total number of redundant temperature sensors: $n$.\n- Maximum number of sensors that can be compromised by an adversary: $f$.\n- The probability that an uncompromised sensor fails to report a true overtemperature condition (false negative rate): $\\beta$.\n- The domain for the false negative rate is $\\beta \\in (0,1)$.\n- Compromised sensors are assumed to always suppress alarms (i.e., they always fail to report an overtemperature condition).\n- Sensor failures (for uncompromised sensors) are conditionally independent given a true overtemperature condition.\n- The Battery Management System (BMS) alarm triggers if any single sensor reports an overtemperature condition.\n- The required minimum probability of detection: The probability that the BMS triggers an alarm when an overtemperature condition is present must be at least $1-\\beta$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity:\n- **Scientifically Grounded**: The problem is based on standard principles of probability theory and reliability engineering, applied to a realistic and critical application in cyber-physical security for battery systems. The model, while simplified (e.g., worst-case adversary, conditional independence), is a legitimate formalization for system design and analysis. It does not violate any scientific laws.\n- **Well-Posed**: The problem asks for the smallest integer $n$ that satisfies a specific probabilistic constraint. All variables and conditions are clearly defined, leading to a solvable inequality. A unique minimum integer solution is expected to exist.\n- **Objective**: The language is precise and uses standard technical terminology. It is free from ambiguity, subjectivity, or opinion.\n- **Completeness and Consistency**: The problem provides all necessary information ($n$, $f$, $\\beta$, the alarm logic, the adversarial model, and the performance requirement) to formulate a mathematical solution. There are no internal contradictions. For a solution to be meaningful, it is implicit that $n$ must be an integer and $n \\ge f$, which is consistent with the physical setup.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be derived.\n\n### Solution Derivation\nLet $A$ be the event that the BMS triggers an alarm, and let $O$ be the event that a true overtemperature condition is present. The problem requires that the conditional probability of detection, $P(A|O)$, satisfies the inequality:\n$$P(A|O) \\geq 1-\\beta$$\n\nThe alarm is triggered if *any* sensor reports a high temperature. It is easier to calculate the probability of the complementary event, $A^c$, which is the event that *no* sensor triggers an alarm (i.e., all sensors fail to report the overtemperature condition). The probability of detection can then be expressed as:\n$$P(A|O) = 1 - P(A^c|O)$$\n\nSubstituting this into the requirement gives:\n$$1 - P(A^c|O) \\geq 1-\\beta$$\n$$ -P(A^c|O) \\geq -\\beta$$\nMultiplying by $-1$ reverses the inequality sign:\n$$P(A^c|O) \\leq \\beta$$\nThis means the probability of a total system failure (no alarm being triggered during an actual overtemperature event) must be no greater than $\\beta$.\n\nThe problem specifies a worst-case adversarial model where up to $f$ sensors can be compromised. A compromised sensor always fails to report an alarm. To maximize the probability of system failure, $P(A^c|O)$, the adversary will compromise the maximum number of sensors allowed, which is $f$. Therefore, we must design the system to meet the safety requirement even under this worst-case scenario.\n\nIn this worst-case scenario, we have:\n- $f$ sensors that are compromised.\n- $n-f$ sensors that are uncompromised.\n\nFor the event $A^c$ to occur, all $n$ sensors must fail to report the overtemperature.\n- The probability that a compromised sensor fails to report is $1$ by definition.\n- The probability that an uncompromised sensor fails to report is $\\beta$, also by definition.\n\nGiven the conditional independence of failures among the uncompromised sensors, the probability that *all* $n-f$ of them fail to report is the product of their individual failure probabilities, which is $\\beta^{n-f}$. The probability that the $f$ compromised sensors fail to report is $1^f = 1$.\n\nTherefore, the total probability of system failure in the worst case is:\n$$P(A^c|O) = (\\text{Prob. all compromised fail}) \\times (\\text{Prob. all uncompromised fail})$$\n$$P(A^c|O) = (1)^f \\times (\\beta)^{n-f} = \\beta^{n-f}$$\n\nNow, we substitute this expression into our derived requirement:\n$$\\beta^{n-f} \\leq \\beta$$\nThis can be written as:\n$$\\beta^{n-f} \\leq \\beta^1$$\n\nTo solve for the exponent $n-f$, we consider the properties of the base $\\beta$. The problem states that $\\beta \\in (0,1)$. For a base in this interval, the logarithm function $\\log_{\\beta}(x)$ is a strictly decreasing function. Applying this logarithm to both sides of the inequality requires reversing the inequality sign:\n$$\\log_{\\beta}(\\beta^{n-f}) \\geq \\log_{\\beta}(\\beta^1)$$\n$$n-f \\geq 1$$\n$$n \\geq f+1$$\n\nThe problem asks for the smallest integer $n$ that satisfies this condition. The smallest integer $n$ satisfying $n \\geq f+1$ is $n = f+1$. This result is necessary for the system to have at least one functioning sensor in the worst-case scenario, whose individual failure probability of $\\beta$ would meet the system-level failure tolerance of $\\beta$. Any larger value of $n$ would provide additional redundancy and a failure probability lower than $\\beta$.",
            "answer": "$$\\boxed{f+1}$$"
        },
        {
            "introduction": "Moving beyond simple hardware redundancy, modern security relies on intelligent, model-based anomaly detection. This practice introduces the concept of a reachable set, a powerful tool from control theory that defines a \"safe\" envelope for the system's state. You will determine if a sensor measurement falls outside this certified safe region and quantify the statistical confidence of this anomaly detection using the Mahalanobis distance, which properly accounts for measurement noise characteristics . This approach provides a rigorous framework for distinguishing between normal system variations and genuine security incidents.",
            "id": "3903065",
            "problem": "A grid-connected modular lithium-ion battery pack is monitored by a state estimator that outputs a reachable set for the cell-averaged cyber-physical state vector $x \\in \\mathbb{R}^{2}$ consisting of state-of-charge and temperature, denoted $x = [\\mathrm{SOC}, T]^{\\top}$. Over a fixed prediction horizon and under bounded actuation and thermal inputs, the automated design tool certifies that the reachable set at the sampling instant is the ellipsoid\n$$\n\\mathcal{E} = \\left\\{ x \\in \\mathbb{R}^{2} : (x - \\mu)^{\\top} S^{-1} (x - \\mu) \\leq 1 \\right\\},\n$$\nwith center $\\mu = \\begin{pmatrix} 0.6 \\\\ 300 \\end{pmatrix}$ and shape matrix $S = \\mathrm{diag}(0.01, 9)$, where state-of-charge is unitless in the interval $[0,1]$ and temperature $T$ is measured in Kelvin. A sensor suite provides a measurement $y \\in \\mathbb{R}^{2}$ of the state with zero-mean Gaussian noise, modeled as $y = x + v$, where $v \\sim \\mathcal{N}(0, R)$ with covariance $R = \\mathrm{diag}(0.0004, 1)$. At the current time, the measured state is\n$$\ny = \\begin{pmatrix} 0.75 \\\\ 300 \\end{pmatrix}.\n$$\n\nAssume an anomaly detector that declares an anomaly if and only if the measured state $y$ lies outside the predicted reachable set $\\mathcal{E}$. To quantify the detection confidence under the Gaussian measurement model, define the test statistic as the minimum squared Mahalanobis distance from $y$ to the reachable set,\n$$\nd^{\\star} = \\min_{x \\in \\mathcal{E}} (y - x)^{\\top} R^{-1} (y - x).\n$$\nUnder the null hypothesis that the true state $x$ lies in $\\mathcal{E}$ and the measurement noise is Gaussian with covariance $R$, use the whitened noise model to express the worst-case false-alarm probability as the upper bound $\\exp(-d^{\\star}/2)$ for dimension $n = 2$, and define the detection confidence as $c = 1 - \\exp(-d^{\\star}/2)$.\n\nTasks:\n- Determine whether $y \\in \\mathcal{E}$ or $y \\notin \\mathcal{E}$.\n- Compute the detection confidence $c$ as defined above.\n\nExpress the final answer as the value of $c$ (dimensionless). Round your answer to four significant figures. Do not include any units in your final answer.",
            "solution": "We begin with the definition of the reachable set $\\mathcal{E}$ as an ellipsoid\n$$\n\\mathcal{E} = \\left\\{ x \\in \\mathbb{R}^{2} : (x - \\mu)^{\\top} S^{-1} (x - \\mu) \\leq 1 \\right\\},\n$$\nwhere $\\mu = \\begin{pmatrix} 0.6 \\\\ 300 \\end{pmatrix}$ and $S = \\mathrm{diag}(0.01, 9)$. The measurement model is $y = x + v$ with $v \\sim \\mathcal{N}(0, R)$ and $R = \\mathrm{diag}(0.0004, 1)$.\n\nStep $1$: Membership test of $y$ in $\\mathcal{E}$. The membership condition is\n$$\nq(y) \\equiv (y - \\mu)^{\\top} S^{-1} (y - \\mu) \\leq 1.\n$$\nCompute $y - \\mu$:\n$$\ny - \\mu = \\begin{pmatrix} 0.75 - 0.6 \\\\ 300 - 300 \\end{pmatrix} = \\begin{pmatrix} 0.15 \\\\ 0 \\end{pmatrix}.\n$$\nCompute $S^{-1} = \\mathrm{diag}(100, 1/9)$. Then\n$$\nq(y) = \\begin{pmatrix} 0.15 & 0 \\end{pmatrix} \\begin{pmatrix} 100 & 0 \\\\ 0 & 1/9 \\end{pmatrix} \\begin{pmatrix} 0.15 \\\\ 0 \\end{pmatrix} = 100 \\cdot (0.15)^{2} + \\frac{1}{9} \\cdot 0^{2} = 100 \\cdot 0.0225 = 2.25.\n$$\nSince $q(y) = 2.25 > 1$, we conclude $y \\notin \\mathcal{E}$, so the detector declares an anomaly.\n\nStep $2$: Compute the minimum squared Mahalanobis distance $d^{\\star} = \\min_{x \\in \\mathcal{E}} (y - x)^{\\top} R^{-1} (y - x)$.\n\nWe use the following fundamental setup. Let $W = R^{-1} = \\mathrm{diag}(1/0.0004, 1/1) = \\mathrm{diag}(2500, 1)$. We must solve the convex optimization problem\n$$\n\\min_{x} \\ (y - x)^{\\top} W (y - x) \\quad \\text{subject to} \\quad (x - \\mu)^{\\top} S^{-1} (x - \\mu) \\leq 1.\n$$\nThe Lagrangian for the boundary case (since $y \\notin \\mathcal{E}$, the minimizer lies on the boundary) is\n$$\n\\mathcal{L}(x, \\lambda) = (y - x)^{\\top} W (y - x) + \\lambda \\left[(x - \\mu)^{\\top} S^{-1} (x - \\mu) - 1 \\right], \\quad \\lambda \\geq 0.\n$$\nSetting the gradient with respect to $x$ to zero gives\n$$\n-2 W (y - x) + 2 \\lambda S^{-1} (x - \\mu) = 0 \\quad \\Rightarrow \\quad W (x - y) + \\lambda S^{-1} (x - \\mu) = 0.\n$$\nThis yields the linear system\n$$\n\\left( W + \\lambda S^{-1} \\right) x = W y + \\lambda S^{-1} \\mu.\n$$\nBecause $W$ and $S^{-1}$ are diagonal and $y - \\mu$ is aligned with the first coordinate axis, the optimal $x^{\\star}$ is also aligned along the first axis, with the second coordinate equal to the center $\\mu_{2}$. Intuitively, and formally by symmetry, the closest point on the ellipsoid to $y$ in this weighted norm is the boundary point along the ray from $\\mu$ through $y$. The ellipsoid boundary is given by\n$$\n\\frac{(x_{1} - \\mu_{1})^{2}}{0.01} + \\frac{(x_{2} - \\mu_{2})^{2}}{9} = 1.\n$$\nSince $y_{2} = \\mu_{2}$, the nearest boundary point satisfies $x_{2}^{\\star} = \\mu_{2}$ and\n$$\n\\frac{(x_{1}^{\\star} - \\mu_{1})^{2}}{0.01} = 1 \\quad \\Rightarrow \\quad |x_{1}^{\\star} - \\mu_{1}| = \\sqrt{0.01} = 0.1,\n$$\nwith the sign chosen to be in the direction of $y_{1} - \\mu_{1} > 0$, hence\n$$\nx_{1}^{\\star} = \\mu_{1} + 0.1 = 0.6 + 0.1 = 0.7, \\quad x_{2}^{\\star} = \\mu_{2} = 300.\n$$\nTherefore, the minimizing boundary point is $x^{\\star} = \\begin{pmatrix} 0.7 \\\\ 300 \\end{pmatrix}$, and the minimum squared Mahalanobis distance is\n$$\nd^{\\star} = (y - x^{\\star})^{\\top} W (y - x^{\\star}) = \\begin{pmatrix} 0.05 \\\\ 0 \\end{pmatrix}^{\\top} \\begin{pmatrix} 2500 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0.05 \\\\ 0 \\end{pmatrix} = 2500 \\cdot (0.05)^{2} + 1 \\cdot 0^{2} = 2500 \\cdot 0.0025 = 6.25.\n$$\n\nStep $3$: Detection confidence. Under the whitened model, if $z = R^{-1/2} v \\sim \\mathcal{N}(0, I_{2})$, then $\\|z\\|^{2}$ has a chi-square distribution with $2$ degrees of freedom. The worst-case false-alarm probability for observing a point at least as incompatible with $\\mathcal{E}$ as $y$ is upper bounded by the tail probability\n$$\np_{\\mathrm{fa}} \\leq \\Pr\\left( \\chi^{2}_{2} \\geq d^{\\star} \\right) = \\exp\\!\\left( -\\frac{d^{\\star}}{2} \\right),\n$$\nwhere we used the fact that for $k = 2$, the survival function is $\\Pr(\\chi^{2}_{2} \\ge t) = \\exp(-t/2)$. Thus the detection confidence is\n$$\nc = 1 - \\exp\\!\\left( -\\frac{d^{\\star}}{2} \\right) = 1 - \\exp\\!\\left( -\\frac{6.25}{2} \\right) = 1 - \\exp(-3.125).\n$$\nCompute the numerical value:\n$$\n\\exp(-3.125) \\approx 0.0439369 \\quad \\Rightarrow \\quad c \\approx 1 - 0.0439369 = 0.9560631.\n$$\nRounded to four significant figures, the confidence is\n$$\nc \\approx 0.9561.\n$$",
            "answer": "$$\\boxed{0.9561}$$"
        },
        {
            "introduction": "The most advanced defense strategies are proactive, designing controllers that are inherently resilient to a class of attacks and uncertainties. This exercise demonstrates how to achieve such resilience in a Model Predictive Control (MPC) framework through the technique of constraint tightening. You will derive the necessary safety margin, $\\delta$, that must be applied to the nominal predictions to guarantee that the battery's true state never violates critical safety limits on voltage or temperature, even under the influence of bounded actuator attacks and model uncertainties .",
            "id": "3903132",
            "problem": "Consider a linearized discrete-time cyber-physical model of a lithium-ion battery cell around a fixed operating point, used within a nominal open-loop Model Predictive Control (MPC) planner. The nominal prediction model is\n$$\n\\hat{x}_{k+1} = A \\hat{x}_{k} + B u_{k},\n$$\nwhere $\\hat{x}_{k} \\in \\mathbb{R}^{n}$ is the predicted state, $u_{k} \\in \\mathbb{R}$ is the planned actuator command (current setpoint), $A \\in \\mathbb{R}^{n \\times n}$ and $B \\in \\mathbb{R}^{n \\times 1}$ are known system matrices obtained from first-principles linearization and system identification. The actual closed-loop system subject to a bounded actuator attack and bounded model uncertainty evolves as\n$$\nx_{k+1} = A x_{k} + B\\left(u_{k} + a_{k}\\right) + w_{k},\n$$\nwith $x_{k} \\in \\mathbb{R}^{n}$ the actual state, $a_{k} \\in \\mathbb{R}$ an actuator attack signal, and $w_{k} \\in \\mathbb{R}^{n}$ an additive lumped uncertainty accounting for model mismatch and unmodeled disturbances over the sampling interval. Assume the following bounds, known a priori:\n$$\n|a_{k}| \\le \\bar{a}, \\quad \\|w_{k}\\|_{2} \\le \\bar{w}, \\quad \\text{for all } k \\in \\{0,1,\\dots,N-1\\},\n$$\nwhere $\\bar{a} \\ge 0$ and $\\bar{w} \\ge 0$ are given constants, and $\\|\\cdot\\|_{2}$ denotes the Euclidean norm for vectors and the induced $2$-norm for matrices. The initial condition is matched, $\\hat{x}_{0} = x_{0}$.\n\nThe outputs of interest are the cell terminal voltage and the core temperature,\n$$\nV_{\\text{cell},k} = c_{V}^{\\top} x_{k}, \\quad T_{k} = c_{T}^{\\top} x_{k},\n$$\nwith $c_{V}, c_{T} \\in \\mathbb{R}^{n}$ known from the linearization and thermal-electrochemical coupling. Denote $C \\in \\mathbb{R}^{2 \\times n}$ with rows $c_{V}^{\\top}$ and $c_{T}^{\\top}$, and define the componentwise output constraints\n$$\nV_{\\text{cell},k} \\le V_{\\max}, \\quad T_{k} \\le T_{\\max}, \\quad \\text{for all } k \\in \\{1,\\dots,N\\}.\n$$\n\nTo robustly enforce these constraints under all admissible attack and uncertainty sequences over the horizon of length $N \\in \\mathbb{N}$, the nominal MPC planner applies a componentwise constraint tightening $\\delta = [\\delta_{V} \\ \\delta_{T}]^{\\top} \\in \\mathbb{R}^{2}_{\\ge 0}$ to the predicted outputs so that the predictions satisfy\n$$\nc_{V}^{\\top} \\hat{x}_{k} \\le V_{\\max} - \\delta_{V}, \\quad c_{T}^{\\top} \\hat{x}_{k} \\le T_{\\max} - \\delta_{T}, \\quad \\text{for all } k \\in \\{1,\\dots,N\\}.\n$$\nBy construction, this tightening must guarantee that the actual outputs satisfy $V_{\\text{cell},k} \\le V_{\\max}$ and $T_{k} \\le T_{\\max}$ for all $k \\in \\{1,\\dots,N\\}$ and for all admissible sequences $\\{a_{k}\\}$ and $\\{w_{k}\\}$.\n\nStarting only from the definitions above, properties of the Euclidean norm and the induced $2$-norm (triangle inequality and submultiplicativity), and the linear time-invariant state transition, derive the minimal componentwise tightening $\\delta$ that ensures robust satisfaction of the output constraints over the entire horizon. Express your final answer as a single closed-form analytic row vector in terms of $A$, $B$, $c_{V}$, $c_{T}$, $\\bar{a}$, $\\bar{w}$, and $N$, using the induced $2$-norm. No numerical evaluation is required. Provide the final expression for the tightening as a row matrix $\\begin{pmatrix}\\delta_{V} & \\delta_{T}\\end{pmatrix}$. No rounding is needed, and no units should be included in the final expression.",
            "solution": "The problem requires the derivation of the minimal componentwise constraint tightening, $\\delta = [\\delta_{V} \\ \\delta_{T}]^{\\top}$, for a nominal Model Predictive Control (MPC) planner to ensure robust satisfaction of output constraints for a battery system under actuator attacks and model uncertainty.\n\nLet us define the state estimation error as $e_{k} = x_{k} - \\hat{x}_{k}$, where $x_{k}$ is the actual state and $\\hat{x}_{k}$ is the predicted state. The initial condition is $x_{0} = \\hat{x}_{0}$, which implies $e_{0} = 0$.\n\nThe dynamics of the error can be found by subtracting the nominal model from the actual system model:\n$$\nx_{k+1} - \\hat{x}_{k+1} = \\left(A x_{k} + B(u_{k} + a_{k}) + w_{k}\\right) - \\left(A \\hat{x}_{k} + B u_{k}\\right)\n$$\n$$\ne_{k+1} = A(x_{k} - \\hat{x}_{k}) + B a_{k} + w_{k}\n$$\n$$\ne_{k+1} = A e_{k} + B a_{k} + w_{k}\n$$\nThis is a linear time-invariant recurrence relation for the error $e_k$. We can unroll this recurrence starting from the initial condition $e_{0} = 0$:\n$$\ne_{1} = A e_{0} + B a_{0} + w_{0} = B a_{0} + w_{0}\n$$\n$$\ne_{2} = A e_{1} + B a_{1} + w_{1} = A(B a_{0} + w_{0}) + B a_{1} + w_{1} = A B a_{0} + A w_{0} + B a_{1} + w_{1}\n$$\nBy induction, the general solution for $e_{k}$ at any time step $k \\ge 1$ is given by:\n$$\ne_{k} = A^{k} e_{0} + \\sum_{j=0}^{k-1} A^{k-1-j} \\left( B a_{j} + w_{j} \\right)\n$$\nSince $e_{0}=0$, this simplifies to:\n$$\ne_{k} = \\sum_{j=0}^{k-1} A^{k-1-j} (B a_{j} + w_{j})\n$$\n\nThe actual outputs are $y_k = C x_k$, where $C$ has rows $c_V^\\top$ and $c_T^\\top$. The componentwise constraints are $c_V^\\top x_k \\le V_{\\max}$ and $c_T^\\top x_k \\le T_{\\max}$. Let us consider a generic output constraint $c_i^\\top x_k \\le Y_{\\max}$, where $i \\in \\{V, T\\}$.\nThe MPC planner enforces the tightened constraint $c_i^\\top \\hat{x}_k \\le Y_{\\max} - \\delta_i$.\nTo guarantee robust satisfaction, the actual output must satisfy the original constraint under all admissible attacks $\\{a_k\\}$ and uncertainties $\\{w_k\\}$. We can write the actual output in terms of the prediction and the error:\n$$\nc_i^\\top x_k = c_i^\\top (\\hat{x}_k + e_k) = c_i^\\top \\hat{x}_k + c_i^\\top e_k\n$$\nSubstituting the tightened constraint that the planner enforces:\n$$\nc_i^\\top x_k \\le (Y_{\\max} - \\delta_i) + c_i^\\top e_k\n$$\nTo ensure that $c_i^\\top x_k \\le Y_{\\max}$ is always satisfied, we must have:\n$$\n(Y_{\\max} - \\delta_i) + c_i^\\top e_k \\le Y_{\\max} \\quad \\implies \\quad c_i^\\top e_k \\le \\delta_i\n$$\nThis inequality must hold for all $k \\in \\{1,\\dots,N\\}$ and for all admissible sequences of attacks $\\{a_j\\}_{j=0}^{k-1}$ and uncertainties $\\{w_j\\}_{j=0}^{k-1}$. Therefore, the tightening $\\delta_i$ must be greater than or equal to the maximum possible value of $c_i^\\top e_k$ over the entire horizon and all possible disturbances. The minimal tightening is the tightest such bound:\n$$\n\\delta_i = \\max_{k \\in \\{1,\\dots,N\\}} \\left( \\sup_{\\{a_j\\}, \\{w_j\\}} c_i^\\top e_k \\right)\n$$\nwhere the supremum is taken over all sequences satisfying $|a_j| \\le \\bar{a}$ and $\\|w_j\\|_2 \\le \\bar{w}$.\n\nLet's compute the supremum of $c_i^\\top e_k$ for a fixed $k$. Substituting the expression for $e_k$:\n$$\nc_i^\\top e_k = c_i^\\top \\left( \\sum_{j=0}^{k-1} \\left( A^{k-1-j} B a_j + A^{k-1-j} w_j \\right) \\right) = \\sum_{j=0}^{k-1} \\left( c_i^\\top A^{k-1-j} B a_j + c_i^\\top A^{k-1-j} w_j \\right)\n$$\nSince the choices of $a_j$ and $w_j$ at each time step $j$ are independent, the supremum of the sum is the sum of the suprema of each term:\n$$\n\\sup_{\\{a_j\\},\\{w_j\\}} c_i^\\top e_k = \\sum_{j=0}^{k-1} \\left( \\sup_{|a_j| \\le \\bar{a}} (c_i^\\top A^{k-1-j} B a_j) + \\sup_{\\|w_j\\|_2 \\le \\bar{w}} (c_i^\\top A^{k-1-j} w_j) \\right)\n$$\nFor the first term, $c_i^\\top A^{k-1-j} B$ is a scalar. The expression $s \\cdot a_j$ subject to $|a_j| \\le \\bar{a}$ is maximized when $a_j$ takes its maximum magnitude with the same sign as $s$, leading to a supremum of $|s| \\bar{a}$. Thus:\n$$\n\\sup_{|a_j| \\le \\bar{a}} (c_i^\\top A^{k-1-j} B a_j) = |c_i^\\top A^{k-1-j} B| \\bar{a}\n$$\nFor the second term, let the row vector be $v_j^\\top = c_i^\\top A^{k-1-j}$. We want to find $\\sup_{\\|w_j\\|_2 \\le \\bar{w}} v_j^\\top w_j$. By the Cauchy-Schwarz inequality, $v_j^\\top w_j \\le \\|v_j\\|_2 \\|w_j\\|_2$. The maximum is achieved when $w_j$ is aligned with $v_j$, i.e., $w_j = \\bar{w} \\frac{v_j}{\\|v_j\\|_2}$. The supremum is $\\|v_j\\|_2 \\bar{w}$. The vector $v_j$ is the transpose of $v_j^\\top$, so $v_j = (A^{k-1-j})^\\top c_i$. Therefore:\n$$\n\\sup_{\\|w_j\\|_2 \\le \\bar{w}} (c_i^\\top A^{k-1-j} w_j) = \\|(A^{k-1-j})^\\top c_i\\|_2 \\bar{w}\n$$\nCombining these results, the worst-case deviation for output $i$ at time $k$ is:\n$$\nd_{i,k} \\triangleq \\sup_{\\{a_j\\},\\{w_j\\}} c_i^\\top e_k = \\sum_{j=0}^{k-1} \\left( |c_i^\\top A^{k-1-j} B| \\bar{a} + \\|(A^{k-1-j})^\\top c_i\\|_2 \\bar{w} \\right)\n$$\nTo simplify the expression, let's change the summation index to $m = k-1-j$. As $j$ goes from $0$ to $k-1$, $m$ goes from $k-1$ to $0$.\n$$\nd_{i,k} = \\sum_{m=0}^{k-1} \\left( |c_i^\\top A^m B| \\bar{a} + \\|(A^m)^\\top c_i\\|_2 \\bar{w} \\right)\n$$\nThe minimal tightening $\\delta_i$ must be valid for all $k \\in \\{1,\\dots,N\\}$, so $\\delta_i = \\max_{k \\in \\{1,\\dots,N\\}} d_{i,k}$.\nThe terms in the summation are non-negative, since $\\bar{a} \\ge 0$, $\\bar{w} \\ge 0$, the absolute value is non-negative, and the norm is non-negative. Therefore, $d_{i,k}$ is a monotonically non-decreasing function of $k$:\n$$\nd_{i, k+1} = d_{i,k} + \\left( |c_i^\\top A^k B| \\bar{a} + \\|(A^k)^\\top c_i\\|_2 \\bar{w} \\right) \\ge d_{i,k}\n$$\nThe maximum value of $d_{i,k}$ over the horizon $\\{1,\\dots,N\\}$ must occur at the final step, $k=N$.\n$$\n\\delta_i = d_{i,N} = \\sum_{m=0}^{N-1} \\left( |c_i^\\top A^m B| \\bar{a} + \\|(A^m)^\\top c_i\\|_2 \\bar{w} \\right)\n$$\nApplying this general formula for the voltage ($i=V$) and temperature ($i=T$) constraints, we get:\n$$\n\\delta_V = \\sum_{m=0}^{N-1} \\left( \\bar{a} |c_V^\\top A^m B| + \\bar{w} \\|(A^m)^\\top c_V\\|_2 \\right)\n$$\n$$\n\\delta_T = \\sum_{m=0}^{N-1} \\left( \\bar{a} |c_T^\\top A^m B| + \\bar{w} \\|(A^m)^\\top c_T\\|_2 \\right)\n$$\nThe final answer is requested as a row matrix $\\begin{pmatrix} \\delta_V & \\delta_T \\end{pmatrix}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sum_{m=0}^{N-1} \\left( \\bar{a} |c_V^\\top A^m B| + \\bar{w} \\|(A^m)^\\top c_V\\|_2 \\right) & \\sum_{m=0}^{N-1} \\left( \\bar{a} |c_T^\\top A^m B| + \\bar{w} \\|(A^m)^\\top c_T\\|_2 \\right) \\end{pmatrix}}\n$$"
        }
    ]
}