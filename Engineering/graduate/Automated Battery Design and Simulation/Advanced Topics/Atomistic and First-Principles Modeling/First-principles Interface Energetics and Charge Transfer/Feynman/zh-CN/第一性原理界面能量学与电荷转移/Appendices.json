{
    "hands_on_practices": [
        {
            "introduction": "理解界面处电荷转移的第一步是掌握其基本的热力学驱动力。本练习从两种不同材料接触的理想化场景出发，运用功函数这一核心概念来推导接触电势差，并预测初始电子自发流动的方向。通过这个经典的分析练习，你将巩固对费米能级$E_F$对齐和电化学势平衡等基本原理的理解，这是所有界面电荷现象的基石。",
            "id": "3915114",
            "problem": "考虑两个半无限、洁净的金属电极，分别标记为材料 $A$ 和材料 $B$。它们在超高真空中紧密接触，温度 $T$ 足够低以至于热发射可以忽略不计。它们的表面是原子级平整且无污染的，因此唯一的界面效应是为达到平衡而发生的电子电荷转移。材料的功函数定义为 $\\phi \\equiv E_{\\mathrm{vac}} - E_{F}$，其中 $E_{\\mathrm{vac}}$ 是局部真空能级，$E_{F}$ 是费米能级，两者都参考一个共同的零点能量。接触前，测得的功函数分别为 $\\phi_{A} = 4.35\\,\\mathrm{eV}$ 和 $\\phi_{B} = 5.20\\,\\mathrm{eV}$。接触后，电子会重新分布，直到费米能级对齐，从而在界面上建立一个内建电势阶跃。你可以取元电荷大小为 $e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$，并在关联能量差与电势差时使用广为接受的等效关系 $1\\,\\mathrm{eV} = e \\times 1\\,\\mathrm{V}$。\n\n从功函数的定义以及电子电化学平衡的要求（界面两侧具有共同的费米能级）出发，推导两种材料在平衡时的内建接触电势差 $\\Delta V \\equiv V_{B} - V_{A}$。然后，确定在达到平衡之前，初始接触时电子自发流动的方向。使用以下编码表示流动方向：定义一个符号变量 $s$，如果电子从 $A$ 流向 $B$，则 $s=+1$；如果电子从 $B$ 流向 $A$，则 $s=-1$。\n\n你的最终答案必须是一个包含 $(\\Delta V, s)$ 的双元素行矩阵，并按此顺序排列。接触电势以伏特为单位表示，并四舍五入到四位有效数字。方向符号 $s$ 是无量纲的，必须精确地给出 $+1$ 或 $-1$，无需四舍五入。",
            "solution": "问题要求推导和计算当两种不同金属接触时产生的内建接触电势差 $\\Delta V$，并确定由符号变量 $s$ 表示的电子自发流动方向。\n\n控制两种材料界面处电子行为的基本原理是系统趋向于达到热力学平衡。对于导电固体中的电子，这种平衡状态的特征是整个系统具有单一、均匀的电化学势。在温度 $T$ 低到可以忽略热效应的情况下，电化学势与费米能级 $E_F$ 相同。\n\n我们首先分析两种半无限金属——材料 $A$ 和材料 $B$——在它们接触之前的状态。材料的功函数 $\\phi$ 定义为将一个电子从费米能级 $E_F$ 移动到局部真空能级 $E_{\\mathrm{vac}}$ 所需的能量，后者是材料表面外真空中静止电子的能量。因此，功函数由关系式 $\\phi = E_{\\mathrm{vac}} - E_F$ 给出。\n\n给定的功函数为材料 $A$ 的 $\\phi_A = 4.35\\,\\mathrm{eV}$ 和材料 $B$ 的 $\\phi_B = 5.20\\,\\mathrm{eV}$。当两种材料在真空中相距很远时，我们可以通过对齐它们的真空能级来建立一个共同的能量参考，使得 $E_{\\mathrm{vac}, A} = E_{\\mathrm{vac}, B} = E_{\\mathrm{vac, common}}$。那么，孤立材料的初始费米能级由下式给出：\n$$E_{F,A} = E_{\\mathrm{vac, common}} - \\phi_A$$\n$$E_{F,B} = E_{\\mathrm{vac, common}} - \\phi_B$$\n\n由于 $\\phi_A  \\phi_B$（具体来说，$4.35\\,\\mathrm{eV}  5.20\\,\\mathrm{eV}$），直接可以得出 $E_{F,A} > E_{F,B}$。这意味着在接触之前，材料 $A$ 中处于费米能级的电子比材料 $B$ 中处于费米能级的电子具有更高的能量。\n\n建立紧密接触后，就为电子转移创造了一条路径。为了最小化系统的总能量，电子会自发地从费米能级较高的材料流向费米能级较低的材料。在这种情况下，电子从材料 $A$ 流向材料 $B$。这个过程会一直持续到达到平衡为止。\n\n电子流动的方向决定了符号变量 $s$ 的值。问题定义了从 $A$ 流向 $B$ 时 $s=+1$，从 $B$ 流向 $A$ 时 $s=-1$。由于我们已经确定电子从 $A$ 流向 $B$，所以符号变量的值为 $s = +1$。\n\n从 $A$ 到 $B$ 的电子净转移导致材料 $B$ 的表面积累净负电荷，而材料 $A$ 的表面积累净正电荷。这种电荷分离在界面处形成一个电偶极层，进而产生一个从 $A$ 指向 $B$ 的局部电场。该电场在两种材料的体材料之间产生宏观静电势差。这个差值就是接触电势差 $\\Delta V \\equiv V_B - V_A$。\n\n在平衡状态下，净电荷流动停止，这发生在两种材料的费米能级对齐到一个共同值 $E_F$ 时。固有的功函数 $\\phi_A$ 和 $\\phi_B$ 仍然是它们各自材料的属性。在界面处，局部真空能级现在因接触电势而相互移动。其关系如下：\n$$E_{\\mathrm{vac}, A} = E_F + \\phi_A$$\n$$E_{\\mathrm{vac}, B} = E_F + \\phi_B$$\n此处，$E_{\\mathrm{vac}, A}$ 和 $E_{\\mathrm{vac}, B}$ 分别是界面处材料 $A$ 和材料 $B$ 外部的真空能级，$E_F$ 是组合系统的共同费米能级。\n\n两个局部真空能级之间的能量差为：\n$$\\Delta E_{\\mathrm{vac}} = E_{\\mathrm{vac}, B} - E_{\\mathrm{vac}, A} = (E_F + \\phi_B) - (E_F + \\phi_A) = \\phi_B - \\phi_A$$\n这个能量差完全是由于界面上的静电势差造成的。一个电荷为 $-e$（其中 $e$ 是元电荷的大小）的电子在静电势 $V$ 中的势能是 $U = -eV$。因此，电子在界面两侧之间移动的势能差与接触电势差 $\\Delta V$ 直接相关：\n$$\\Delta E_{\\mathrm{vac}} = -e (V_B - V_A) = -e \\Delta V$$\n通过令 $\\Delta E_{\\mathrm{vac}}$ 的两个表达式相等，我们得到：\n$$-e \\Delta V = \\phi_B - \\phi_A$$\n解出接触电势差 $\\Delta V$，得到：\n$$\\Delta V = \\frac{\\phi_A - \\phi_B}{e}$$\n我们已知数值 $\\phi_A = 4.35\\,\\mathrm{eV}$ 和 $\\phi_B = 5.20\\,\\mathrm{eV}$。将这些值代入方程：\n$$\\Delta V = \\frac{4.35\\,\\mathrm{eV} - 5.20\\,\\mathrm{eV}}{e} = \\frac{-0.85\\,\\mathrm{eV}}{e}$$\n问题陈述了等效关系 $1\\,\\mathrm{eV} = e \\times 1\\,\\mathrm{V}$。这使得我们可以将以电子伏特为单位的能量差直接转换为以伏特为单位的电势差：\n$$\\Delta V = \\frac{-0.85 \\times (e \\cdot 1\\,\\mathrm{V})}{e} = -0.85\\,\\mathrm{V}$$\n问题要求 $\\Delta V$ 的结果表示为四位有效数字。因此，我们写作：\n$$\\Delta V = -0.8500\\,\\mathrm{V}$$\n负号表示材料 $B$ 的电势低于材料 $A$ 的电势（$V_B  V_A$），这与一个从 $A$ 指向 $B$ 并阻止电子进一步流动的电场是一致的。\n\n最终答案要求一个包含 $(\\Delta V, s)$ 的双元素行矩阵。我们已经求得 $\\Delta V = -0.8500$ 和 $s = +1$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.8500  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "为了使用第一性原理方法精确模拟如前述的界面现象，确保计算结果的可靠性至关重要。本动手编程练习将带你深入计算科学的核心实践——收敛性测试。通过构建简化的误差模型，你将学习如何系统地确定计算所需的最小参数，如真空层厚度、板层厚度以及$k$点网格密度，以确保功函数和能带对齐等关键界面属性达到预设的精度目标。 掌握这一技能是进行任何可靠计算研究的必备前提。",
            "id": "3915134",
            "problem": "你的任务是设计一个完整、可运行的程序，该程序基于基本收敛行为，量化在电池界面的第一性原理模拟中常用的平板模型计算中功函数和能带对齐的收敛性，并提出达到目标精度的标准。目标是处理在周期性边界条件下，通过真空层分离、有限平板厚度以及通过$k$点采样的布里渊区（BZ）积分下，功函数和界面能带对齐的收敛问题，并为这两个量同时满足指定精度目标建立最小参数值。\n\n从功函数的定义 $ \\Phi = V_{\\mathrm{vac}} - E_{\\mathrm{F}} $ 开始，其中 $ \\Phi $ 是功函数，$ V_{\\mathrm{vac}} $ 是渐近真空势，$ E_{\\mathrm{F}} $ 是费米能级；以及从通过平板界面两端的静电势和能带边对齐定义的界面能带对齐偏移 $ \\Delta E $ 开始。在周期性边界条件和使用真空间隔的情况下，$ \\Phi $ 和 $ \\Delta E $ 的误差来源于跨真空层的伪静电相互作用、平板厚度引起的有限尺寸量子化效应，以及源于$k$点采样的数值积分误差。这些误差贡献建模如下，并被视为有效的基础：\n\n- 对于足够厚的真空区域，由真空层分离引起的误差呈指数衰减，建模为 $ |\\delta X_{\\mathrm{vac}}(L_{\\mathrm{vac}})| = A_{\\mathrm{vac}} \\exp(-L_{\\mathrm{vac}}/\\lambda) $，其中 $ X \\in \\{\\Phi,\\Delta E\\} $，$ L_{\\mathrm{vac}} $ 是真空厚度（单位为 $ \\mathrm{\\AA} $），$ \\lambda $ 是特征衰减长度（单位为 $ \\mathrm{\\AA} $），$ A_{\\mathrm{vac}} $ 是幅值（单位为 $ \\mathrm{eV} $）。\n- 由量子限制效应引起的有限平板厚度误差建模为 $ |\\delta X_{\\mathrm{slab}}(N)| = A_{\\mathrm{slab}} N^{-2} $，其中 $ N $ 是平板中的原子层数（无量纲整数），$ A_{\\mathrm{slab}} $ 的单位是 $ \\mathrm{eV} $。\n- 对于平滑可观测量的布里渊区积分，其$k$点采样误差建模为 $ |\\delta X_{k}(N_k)| = A_k N_k^{-\\beta} $，其中 $ N_k $ 是积分中使用的$k$点总数（无量纲整数），$ A_k $ 的单位是 $ \\mathrm{eV} $，$ \\beta $ 是一个反映被积函数光滑度和维度的正指数。\n\n假设总绝对误差受各独立贡献的量值之和的限制，通过三角不等式：\n$$\n|X - X_\\infty| \\le |\\delta X_{\\mathrm{vac}}| + |\\delta X_{\\mathrm{slab}}| + |\\delta X_k| ,\n$$\n其中 $ X_\\infty $ 是收敛值（$ L_{\\mathrm{vac}} \\to \\infty $，$ N \\to \\infty $，$ N_k \\to \\infty $）。为保证达到目标精度 $ \\epsilon $，采用一种保守的误差预算分配方法，即要求对于每个量 $ X $，每个独立贡献都必须以 $ \\epsilon/3 $ 为界。\n\n你的程序必须实现以下任务：\n- 对每个测试用例，计算最小真空厚度 $ L_{\\mathrm{vac}}^{\\mathrm{min}} $ （单位 $ \\mathrm{\\AA} $，报告时四舍五入到 $ 0.01 \\ \\mathrm{\\AA} $）、最小平板厚度 $ N^{\\mathrm{min}} $ （无量纲整数层数）和最小$k$点数量 $ N_k^{\\mathrm{min}} $ （无量纲整数），这些参数需同时满足 $ \\Phi $ 和 $ \\Delta E $ 的目标精度分配。使用保守规则，即 $ \\Phi $ 和 $ \\Delta E $ 的联合标准是这两个量各参数的逐分量最大值，即 $ L_{\\mathrm{vac}}^{\\mathrm{min}} = \\max(L_{\\mathrm{vac},\\Phi}^{\\mathrm{min}}, L_{\\mathrm{vac},\\Delta E}^{\\mathrm{min}}) $，$ N^{\\mathrm{min}} = \\max(N_{\\Phi}^{\\mathrm{min}}, N_{\\Delta E}^{\\mathrm{min}}) $，以及 $ N_k^{\\mathrm{min}} = \\max(N_{k,\\Phi}^{\\mathrm{min}}, N_{k,\\Delta E}^{\\mathrm{min}}) $。\n- 所有能量单位必须以 $ \\mathrm{eV} $ 处理。\n- 真空厚度必须以 $ \\mathrm{\\AA} $ 为单位报告，并四舍五入到 $ 0.01 \\ \\mathrm{\\AA} $。\n- 平板厚度 $ N $ 和$k$点数量 $ N_k $ 必须是整数（使用满足约束的最小整数）。\n- 你不应估计或拟合 $ X_\\infty $；在上述误差预算分配下，确定最小参数值并不需要它。\n\n测试套件：\n为以下三个参数集提供结果。每个集合分别包含 $ \\Phi $ 和 $ \\Delta E $ 的参数，以及目标精度 $ \\epsilon_{\\Phi} $ 和 $ \\epsilon_{\\Delta E} $。\n\n- 案例 $ 1 $:\n  - $ \\Phi $ 参数：$ A_{\\mathrm{vac}} = 0.20 \\ \\mathrm{eV} $, $ \\lambda = 3.00 \\ \\mathrm{\\AA} $, $ A_{\\mathrm{slab}} = 0.50 \\ \\mathrm{eV} $, $ A_k = 0.15 \\ \\mathrm{eV} $, $ \\beta = 1.60 $, 目标 $ \\epsilon_{\\Phi} = 0.01 \\ \\mathrm{eV} $。\n  - $ \\Delta E $ 参数：$ A_{\\mathrm{vac}}' = 0.10 \\ \\mathrm{eV} $, $ \\lambda' = 2.00 \\ \\mathrm{\\AA} $, $ A_{\\mathrm{slab}}' = 0.30 \\ \\mathrm{eV} $, $ A_k' = 0.08 \\ \\mathrm{eV} $, $ \\beta' = 1.80 $, 目标 $ \\epsilon_{\\Delta E} = 0.01 \\ \\mathrm{eV} $。\n\n- 案例 $ 2 $:\n  - $ \\Phi $ 参数：$ A_{\\mathrm{vac}} = 0.30 \\ \\mathrm{eV} $, $ \\lambda = 5.00 \\ \\mathrm{\\AA} $, $ A_{\\mathrm{slab}} = 0.40 \\ \\mathrm{eV} $, $ A_k = 0.20 \\ \\mathrm{eV} $, $ \\beta = 1.20 $, 目标 $ \\epsilon_{\\Phi} = 0.005 \\ \\mathrm{eV} $。\n  - $ \\Delta E $ 参数：$ A_{\\mathrm{vac}}' = 0.25 \\ \\mathrm{eV} $, $ \\lambda' = 4.00 \\ \\mathrm{\\AA} $, $ A_{\\mathrm{slab}}' = 0.35 \\ \\mathrm{eV} $, $ A_k' = 0.10 \\ \\mathrm{eV} $, $ \\beta' = 1.50 $, 目标 $ \\epsilon_{\\Delta E} = 0.008 \\ \\mathrm{eV} $。\n\n- 案例 $ 3 $:\n  - $ \\Phi $ 参数：$ A_{\\mathrm{vac}} = 0.02 \\ \\mathrm{eV} $, $ \\lambda = 3.00 \\ \\mathrm{\\AA} $, $ A_{\\mathrm{slab}} = 0.10 \\ \\mathrm{eV} $, $ A_k = 0.03 \\ \\mathrm{eV} $, $ \\beta = 2.00 $, 目标 $ \\epsilon_{\\Phi} = 0.02 \\ \\mathrm{eV} $。\n  - $ \\Delta E $ 参数：$ A_{\\mathrm{vac}}' = 0.01 \\ \\mathrm{eV} $, $ \\lambda' = 2.50 \\ \\mathrm{\\AA} $, $ A_{\\mathrm{slab}}' = 0.06 \\ \\mathrm{eV} $, $ A_k' = 0.02 \\ \\mathrm{eV} $, $ \\beta' = 1.70 $, 目标 $ \\epsilon_{\\Delta E} = 0.02 \\ \\mathrm{eV} $。\n\n最终输出格式：\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果必须是列表 $ [L_{\\mathrm{vac}}^{\\mathrm{min}}, N^{\\mathrm{min}}, N_k^{\\mathrm{min}}] $，其中 $ L_{\\mathrm{vac}}^{\\mathrm{min}} $ 以 $ \\mathrm{\\AA} $ 为单位报告到 $ 0.01 \\ \\mathrm{\\AA} $，$ N^{\\mathrm{min}} $ 和 $ N_k^{\\mathrm{min}} $ 为整数。例如，输出应类似于 $ [[L_1,N_1,Nk_1],[L_2,N_2,Nk_2],[L_3,N_3,Nk_3]] $。",
            "solution": "目标是确定最小的数值参数，以确保功函数 $ \\Phi $ 和能带对齐 $ \\Delta E $ 达到目标精度。这是从基本定义和在周期性边界条件下平板模型计算的经过充分检验的收敛行为出发的。功函数 $ \\Phi $ 由 $ \\Phi = V_{\\mathrm{vac}} - E_{\\mathrm{F}} $ 定义，而界面能带对齐 $ \\Delta E $ 由界面两侧的电势对齐和能带边差异定义。在带有真空填充的平板模型计算中，有三个主要的数值误差来源会影响 $ \\Phi $ 和 $ \\Delta E $：\n\n- 由真空厚度 $ L_{\\mathrm{vac}} $ 减小的、跨越重复平板的伪静电相互作用，由于求解具有局域电荷分布及镜像的泊松方程，该误差遵循指数衰减，从而得到模型 $ |\\delta X_{\\mathrm{vac}}(L_{\\mathrm{vac}})| = A_{\\mathrm{vac}} \\exp(-L_{\\mathrm{vac}}/\\lambda) $，其中 $ X \\in \\{\\Phi,\\Delta E\\} $，$ A_{\\mathrm{vac}} $ 是以 $ \\mathrm{eV} $ 为单位的幅值，$ \\lambda $ 是以 $ \\mathrm{\\AA} $ 为单位的特征衰减长度。\n- 来自平板厚度 $ N $ 层的有限尺寸量子化误差，可以与箱中粒子趋势和有效质量理论联系起来；能级间距和导出的可观测量通常随厚度呈代数衰减，对于足够厚的平板，这可以很好地近似为 $ |\\delta X_{\\mathrm{slab}}(N)| = A_{\\mathrm{slab}} N^{-2} $，其中 $ A_{\\mathrm{slab}} $ 以 $ \\mathrm{eV} $ 为单位。\n- 通过$k$点采样对平滑可观测量进行布里渊区（BZ）积分时，数值积分误差随点数呈代数衰减，建模为 $ |\\delta X_k(N_k)| = A_k N_k^{-\\beta} $，其中 $ A_k $ 以 $ \\mathrm{eV} $ 为单位，$ \\beta  0 $ 取决于被积函数的光滑度和维度。\n\n根据三角不等式，\n$$\n|X - X_\\infty| \\le |\\delta X_{\\mathrm{vac}}| + |\\delta X_{\\mathrm{slab}}| + |\\delta X_k| ,\n$$\n因此，保证 $ |X - X_\\infty| \\le \\epsilon_X $ 的一个充分条件是将误差预算均等地分配给每个来源：\n$$\n|\\delta X_{\\mathrm{vac}}| \\le \\epsilon_X/3, \\quad |\\delta X_{\\mathrm{slab}}| \\le \\epsilon_X/3, \\quad |\\delta X_k| \\le \\epsilon_X/3 .\n$$\n将此保守分配独立应用于每个量 $ X \\in \\{\\Phi,\\Delta E\\} $，会产生三个不等式，通过反解这些不等式可得到最小参数：\n\n- 真空厚度标准：\n$$\nA_{\\mathrm{vac}} \\exp(-L_{\\mathrm{vac}}/\\lambda) \\le \\epsilon_X/3 \\quad \\Rightarrow \\quad\n\\exp(-L_{\\mathrm{vac}}/\\lambda) \\le \\frac{\\epsilon_X}{3 A_{\\mathrm{vac}}} \\quad \\Rightarrow \\quad\nL_{\\mathrm{vac}} \\ge \\lambda \\ln\\!\\left(\\frac{3 A_{\\mathrm{vac}}}{\\epsilon_X}\\right) .\n$$\n如果 $ 3 A_{\\mathrm{vac}} \\le \\epsilon_X $，则该不等式对 $ L_{\\mathrm{vac}} \\ge 0 $ 成立，因此最小值为 $ L_{\\mathrm{vac}}^{\\mathrm{min}} = 0 $。\n\n- 平板厚度标准：\n$$\nA_{\\mathrm{slab}} N^{-2} \\le \\epsilon_X/3 \\quad \\Rightarrow \\quad\nN \\ge \\sqrt{\\frac{3 A_{\\mathrm{slab}}}{\\epsilon_X}} .\n$$\n因为 $ N $ 必须是整数，所以最小实际平板厚度为 $ N^{\\mathrm{min}} = \\left\\lceil \\sqrt{\\frac{3 A_{\\mathrm{slab}}}{\\epsilon_X}} \\right\\rceil $。\n\n- $k$点采样标准：\n$$\nA_k N_k^{-\\beta} \\le \\epsilon_X/3 \\quad \\Rightarrow \\quad\nN_k \\ge \\left(\\frac{3 A_k}{\\epsilon_X}\\right)^{1/\\beta} .\n$$\n因为 $ N_k $ 必须是整数，所以最小实际数量为 $ N_k^{\\mathrm{min}} = \\left\\lceil \\left(\\frac{3 A_k}{\\epsilon_X}\\right)^{1/\\beta} \\right\\rceil $。\n\n为确保 $ \\Phi $ 和 $ \\Delta E $ 同时达到各自的目标，取从两组独立参数中获得的最小值的逐分量最大值：\n$$\nL_{\\mathrm{vac}}^{\\mathrm{min}} = \\max\\!\\left(L_{\\mathrm{vac},\\Phi}^{\\mathrm{min}}, L_{\\mathrm{vac},\\Delta E}^{\\mathrm{min}}\\right),\n\\quad\nN^{\\mathrm{min}} = \\max\\!\\left(N_{\\Phi}^{\\mathrm{min}}, N_{\\Delta E}^{\\mathrm{min}}\\right),\n\\quad\nN_k^{\\mathrm{min}} = \\max\\!\\left(N_{k,\\Phi}^{\\mathrm{min}}, N_{k,\\Delta E}^{\\mathrm{min}}\\right).\n$$\n\n问题陈述要求的实现细节：\n- 能量必须以 $ \\mathrm{eV} $ 为单位处理。\n- 真空厚度 $ L_{\\mathrm{vac}}^{\\mathrm{min}} $以 $ \\mathrm{\\AA} $ 为单位报告，四舍五入到 $ 0.01 \\ \\mathrm{\\AA} $。\n- 平板厚度 $ N^{\\mathrm{min}} $ 和k点数量 $ N_k^{\\mathrm{min}} $ 必须是整数（使用满足界限的最小整数）。\n- 最终输出是一行，包含一个列表，其中包含每个案例的结果，格式为 $ [[L_1,N_1,Nk_1],[L_2,N_2,Nk_2],[L_3,N_3,Nk_3]] $。\n\n该程序直接编码了这些推导过程，并将其应用于给定的测试套件。在所述的保守误差分配下，确定最小参数不需要外部数据或对 $ X_\\infty $ 进行拟合。对于自动化电池设计和模拟中的第一性原理界面能量学和电荷转移计算，这种方法在科学上是合理的，它提供了可复现的收敛标准，以平衡真空间隔、平板厚度和$k$点采样。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef minimal_vacuum_thickness(A_vac: float, lam: float, eps: float) - float:\n    \"\"\"\n    Compute minimal vacuum thickness L_vac_min (in Angstrom) such that\n    A_vac * exp(-L/lam) = eps/3. If 3*A_vac = eps, return 0.0.\n    \"\"\"\n    rhs_ratio = (3.0 * A_vac) / eps\n    if rhs_ratio = 1.0:\n        return 0.0\n    return lam * np.log(rhs_ratio)\n\ndef minimal_slab_layers(A_slab: float, eps: float) - int:\n    \"\"\"\n    Compute minimal integer number of layers N_min such that\n    A_slab / N^2 = eps/3 - N = sqrt(3*A_slab/eps).\n    \"\"\"\n    required = np.sqrt((3.0 * A_slab) / eps)\n    # Smallest integer satisfying the inequality\n    return int(np.ceil(required))\n\ndef minimal_kpoints(A_k: float, beta: float, eps: float) - int:\n    \"\"\"\n    Compute minimal integer number of k-points Nk_min such that\n    A_k / Nk^beta = eps/3 - Nk = (3*A_k/eps)^(1/beta).\n    \"\"\"\n    required = ((3.0 * A_k) / eps) ** (1.0 / beta)\n    # Smallest integer satisfying the inequality; enforce at least 1 k-point\n    return max(1, int(np.ceil(required)))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary with parameters for Phi and DeltaE and their targets.\n    test_cases = [\n        {\n            \"phi\": {\"A_vac\": 0.20, \"lam\": 3.00, \"A_slab\": 0.50, \"A_k\": 0.15, \"beta\": 1.60, \"eps\": 0.01},\n            \"dE\":  {\"A_vac\": 0.10, \"lam\": 2.00, \"A_slab\": 0.30, \"A_k\": 0.08, \"beta\": 1.80, \"eps\": 0.01},\n        },\n        {\n            \"phi\": {\"A_vac\": 0.30, \"lam\": 5.00, \"A_slab\": 0.40, \"A_k\": 0.20, \"beta\": 1.20, \"eps\": 0.005},\n            \"dE\":  {\"A_vac\": 0.25, \"lam\": 4.00, \"A_slab\": 0.35, \"A_k\": 0.10, \"beta\": 1.50, \"eps\": 0.008},\n        },\n        {\n            \"phi\": {\"A_vac\": 0.02, \"lam\": 3.00, \"A_slab\": 0.10, \"A_k\": 0.03, \"beta\": 2.00, \"eps\": 0.02},\n            \"dE\":  {\"A_vac\": 0.01, \"lam\": 2.50, \"A_slab\": 0.06, \"A_k\": 0.02, \"beta\": 1.70, \"eps\": 0.02},\n        },\n    ]\n\n    results_strs = []\n\n    for case in test_cases:\n        # Compute minima for Phi\n        L_phi = minimal_vacuum_thickness(case[\"phi\"][\"A_vac\"], case[\"phi\"][\"lam\"], case[\"phi\"][\"eps\"])\n        N_phi = minimal_slab_layers(case[\"phi\"][\"A_slab\"], case[\"phi\"][\"eps\"])\n        Nk_phi = minimal_kpoints(case[\"phi\"][\"A_k\"], case[\"phi\"][\"beta\"], case[\"phi\"][\"eps\"])\n\n        # Compute minima for Delta E\n        L_dE = minimal_vacuum_thickness(case[\"dE\"][\"A_vac\"], case[\"dE\"][\"lam\"], case[\"dE\"][\"eps\"])\n        N_dE = minimal_slab_layers(case[\"dE\"][\"A_slab\"], case[\"dE\"][\"eps\"])\n        Nk_dE = minimal_kpoints(case[\"dE\"][\"A_k\"], case[\"dE\"][\"beta\"], case[\"dE\"][\"eps\"])\n\n        # Joint criteria: componentwise maxima\n        L_joint = max(L_phi, L_dE)\n        N_joint = max(N_phi, N_dE)\n        Nk_joint = max(Nk_phi, Nk_dE)\n\n        # Round vacuum thickness to 0.01 Angstrom as specified\n        L_joint_rounded = round(L_joint + 1e-12, 2)  # small epsilon to avoid -0.00\n\n        # Build sublist string with specified formatting\n        sublist_str = f\"[{L_joint_rounded:.2f},{N_joint},{Nk_joint}]\"\n        results_strs.append(sublist_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_strs)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了如何建立可靠的计算模型之后，我们便可以应用这些严格的方法来解决实际的科学问题。本练习将引导你运用第一性原理热力学框架，计算固态电解质与正极材料界面的形成能 $\\gamma_{\\mathrm{int}}$，这是评估电池界面稳定性的一个关键物理量。通过这个实践，你将学会如何将从密度泛函理论(DFT)计算中获得的总能量与变化的锂化学势 $\\mu_{\\mathrm{Li}}$ 相关联，从而获得对真实电化学环境下界面热力学行为的深刻洞察。",
            "id": "3915077",
            "problem": "在一个包含两个相同界面的周期性板状超胞中，固体电解质和阴极形成了一个共格界面。在自动化电池设计和模拟中，该界面在与一个锂（Li）库进行锂交换时的能量学取决于锂的化学势。您必须从第一性原理出发，使用从头算热力学对锂进行巨正则处理，来构建界面能量学的公式。\n\n使用以下基础：\n- 系统在温度 $T$ 下的吉布斯自由能 $G$ 满足 $dG = -S\\,dT + V\\,dP + \\sum_i \\mu_i\\,dN_i$，其中 $S$ 是熵，$V$ 是体积，$P$ 是压力，$\\mu_i$ 是化学势，$N_i$ 是粒子数。\n- 在巨正则系综（GCE）中，巨势为 $\\Omega = G - \\sum_i \\mu_i N_i$。\n- 对于零温和可忽略压力下的固相，在从头算热力学中通常近似为 $G \\approx E$，其中 $E$ 是通过密度泛函理论（DFT）计算得到的总电子能量。\n\n任务：\n1. 严格从上述定义出发（不引入任何快捷公式），推导出一个板状超胞的单位面积界面自由能 $\\,\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}})\\,$ 作为锂化学势 $\\,\\mu_{\\mathrm{Li}}\\,$ 的函数表达式。该超胞包含 $\\,n_{\\mathrm{int}}\\,$ 个相同界面，其中固体电解质和阴极的化学式单位数量分别为 $\\,N_{\\mathrm{el}}\\,$ 和 $\\,N_{\\mathrm{cath}}\\,$。相对于这些体相的化学计量组合，该板状结构可能存在锂的过量或亏损，量化为 $\\,\\Delta N_{\\mathrm{Li}}\\,$。假设体相的参考是它们在相同 $\\,\\mu_{\\mathrm{Li}}\\,$下的化学计量组成。您的推导应清楚地展示 $\\,\\mu_{\\mathrm{Li}}\\,$ 如何通过巨势线性进入表达式，以及如何通过除以界面数量和界面面积得到 $\\,\\gamma_{\\mathrm{int}}$。\n2. 将推导出的表达式实现为一个完整的、可运行的程序，该程序为一组锂化学势，计算多个超胞和重构的 $\\,\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}})\\,$（单位为 $\\mathrm{J}/\\mathrm{m}^2$）。使用换算因子 $\\,1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}\\,$ 和 $\\,1\\,\\text{\\AA}^2 = 10^{-20}\\,\\mathrm{m}^2$。\n3. 通过计算指定案例对在测试的 $\\,\\mu_{\\mathrm{Li}}$ 值范围内的最大绝对偏差 $\\,\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}})\\,$，报告对超胞尺寸和界面重构的敏感性。\n\n假设：\n- 在 $\\,T \\approx 0\\,\\mathrm{K}\\,$ 和可忽略的压力下工作，因此 $\\,G \\approx E\\,$，并且 $\\,pV\\,$ 和 $\\,TS\\,$ 的贡献可以忽略。\n- 每个测试的板状结构包含 $\\,n_{\\mathrm{int}} = 2\\,$ 个相同界面。\n- 因厚度而异的板状结构，其界面面积 $\\,A\\,$ 相同。\n\n单位：\n- 输入能量的单位根据指定为每个超胞或每个化学式单位的 $\\mathrm{eV}$。\n- 界面面积 $\\,A\\,$ 的单位为 $\\text{\\AA}^2$。\n- 锂化学势 $\\,\\mu_{\\mathrm{Li}}\\,$ 的单位为每个原子的 $\\mathrm{eV}$。\n- 最终的界面能 $\\,\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}})\\,$ 以 $\\mathrm{J}/\\mathrm{m}^2$ 表示，四舍五入到六位小数。\n\n测试套件（四个案例：两种超胞厚度和两种重构）：\n- 每个化学式单位的共同体相参考能量：\n  - 固体电解质：$E_{\\mathrm{el}}^{\\mathrm{bulk}} = -400.0\\,\\mathrm{eV}$。\n  - 阴极：$E_{\\mathrm{cath}}^{\\mathrm{bulk}} = -210.0\\,\\mathrm{eV}$。\n- 界面面积和界面数量：\n  - $A = 100.0\\,\\text{\\AA}^2$, $n_{\\mathrm{int}} = 2$。\n- 待评估的锂化学势（有序列表）：\n  - $\\mu_{\\mathrm{Li}} \\in \\{-2.0\\,\\mathrm{eV}, -1.0\\,\\mathrm{eV}, 0.0\\,\\mathrm{eV}\\}$。\n\n将四个测试案例定义为元组 $(E_{\\mathrm{int}}, N_{\\mathrm{el}}, N_{\\mathrm{cath}}, \\Delta N_{\\mathrm{Li}}, A, n_{\\mathrm{int}})$：\n1. 小超胞，重构 A：\n   - $E_{\\mathrm{int}} = -2037.0\\,\\mathrm{eV}$，$N_{\\mathrm{el}} = 3$，$N_{\\mathrm{cath}} = 4$，$\\Delta N_{\\mathrm{Li}} = +2$，$A = 100.0\\,\\text{\\AA}^2$，$n_{\\mathrm{int}} = 2$。\n2. 大（更厚）超胞，重构 A：\n   - $E_{\\mathrm{int}} = -4076.6\\,\\mathrm{eV}$，$N_{\\mathrm{el}} = 6$，$N_{\\mathrm{cath}} = 8$，$\\Delta N_{\\mathrm{Li}} = +2$，$A = 100.0\\,\\text{\\AA}^2$，$n_{\\mathrm{int}} = 2$。\n3. 小超胞，重构 B：\n   - $E_{\\mathrm{int}} = -2035.8\\,\\mathrm{eV}$，$N_{\\mathrm{el}} = 3$，$N_{\\mathrm{cath}} = 4$，$\\Delta N_{\\mathrm{Li}} = 0$，$A = 100.0\\,\\text{\\AA}^2$，$n_{\\mathrm{int}} = 2$。\n4. 大（更厚）超胞，重构 B：\n   - $E_{\\mathrm{int}} = -4076.0\\,\\mathrm{eV}$，$N_{\\mathrm{el}} = 6$，$N_{\\mathrm{cath}} = 8$，$\\Delta N_{\\mathrm{Li}} = 0$，$A = 100.0\\,\\text{\\AA}^2$，$n_{\\mathrm{int}} = 2$。\n\n需要报告的敏感性指标（每个都四舍五入到六位小数）：\n- 重构 A 的超胞尺寸敏感性：在三个 $\\,\\mu_{\\mathrm{Li}}\\,$ 值中，案例 2 和案例 1 之间的最大绝对差。\n- 重构 B 的超胞尺寸敏感性：在三个 $\\,\\mu_{\\mathrm{Li}}\\,$ 值中，案例 4 和案例 3 之间的最大绝对差。\n- 小超胞厚度下的重构敏感性：在三个 $\\,\\mu_{\\mathrm{Li}}\\,$ 值中，案例 3 和案例 1 之间的最大绝对差。\n- 大超胞厚度下的重构敏感性：在三个 $\\,\\mu_{\\mathrm{Li}}\\,$ 值中，案例 4 和案例 2 之间的最大绝对差。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个列表，该列表由以下部分组成：\n  - 四个子列表，每个子列表按三个 $\\,\\mu_{\\mathrm{Li}}\\,$ 值 $[-2.0,-1.0,0.0]$ 的顺序给出相应案例的 $\\,\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}})\\,$（单位为 $\\mathrm{J}/\\mathrm{m}^2$）。\n  - 随后是四个浮点数，按顺序给出上述定义的敏感性指标：尺寸敏感性 A、尺寸敏感性 B、重构敏感性（小）、重构敏感性（大）。\n- 所有浮点数必须四舍五入到六位小数，并且整个结构必须打印为单个逗号分隔的列表，并用方括号括起来，例如：$[\\,[x_1,x_2,x_3],\\,[y_1,y_2,y_3],\\,[z_1,z_2,z_3],\\,[w_1,w_2,w_3],\\,s_A,\\,s_B,\\,r_{\\mathrm{small}},\\,r_{\\mathrm{large}}\\,]$。",
            "solution": "该问题在科学上是合理的，阐述清晰，并包含了推导和计算界面能量学所需的所有信息。因此，该问题被认定为有效。\n\n### 第 1 部分：界面自由能的推导\n\n目标是推导单位面积的界面自由能 $\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}})$ 作为锂化学势 $\\mu_{\\mathrm{Li}}$ 的函数表达式。推导将从提供的基本热力学定义开始。\n\n我们考虑一个在零温（$T=0\\,\\mathrm{K}$）和可忽略压力（$P \\approx 0$）下的系统，对于该系统，吉布斯自由能 $G$ 可以很好地用密度泛函理论（DFT）计算的总电子能量 $E$ 来近似，即 $G \\approx E$。该系统相对于锂处于巨正则系综中，意味着它可以与一个具有固定化学势 $\\mu_{\\mathrm{Li}}$ 的库交换锂原子。相关的热力学势是巨势 $\\Omega$，定义为：\n$$\n\\Omega = G - \\sum_i \\mu_i N_i\n$$\n在我们的情况下，唯一交换的物种是锂，因此表达式简化为 $\\Omega = G - \\mu_{\\mathrm{Li}} N_{\\mathrm{Li}}$。使用 $T=0\\,\\mathrm{K}$ 近似，这变为：\n$$\n\\Omega = E - \\mu_{\\mathrm{Li}} N_{\\mathrm{Li}}\n$$\n其中 $E$ 是系统的总能量，$N_{\\mathrm{Li}}$ 是其中的锂原子数。\n\n界面自由能 $\\gamma_{\\mathrm{int}}$ 表示形成界面所需的、相对于组成体相材料的单位面积过量巨势。为了计算这个值，我们使用一种减法方案。我们将包含界面的超胞的巨势 $\\Omega_{\\mathrm{slab}}$ 与由等量分离的体相组成的参考系统 $\\Omega_{\\mathrm{ref}}$ 的巨势进行比较。\n\n界面系统是一个横截面积为 $A$、包含 $n_{\\mathrm{int}}$ 个界面的板状超胞。其通过 DFT 计算的总能量为 $E_{\\mathrm{int}}$。该板状结构由 $N_{\\mathrm{el}}$ 个固体电解质化学式单位和 $N_{\\mathrm{cath}}$ 个阴极化学式单位构成。此板状结构中的锂原子总数为 $N_{\\mathrm{Li}}^{\\mathrm{slab}}$。该板状结构的巨势为：\n$$\n\\Omega_{\\mathrm{slab}} = E_{\\mathrm{int}} - N_{\\mathrm{Li}}^{\\mathrm{slab}} \\mu_{\\mathrm{Li}}\n$$\n\n参考系统由 $N_{\\mathrm{el}}$ 个体相固体电解质化学式单位和 $N_{\\mathrm{cath}}$ 个体相阴极化学式单位组成，它们是分开的，不形成界面。该参考系统的总能量是其各组分能量的总和：\n$$\nE_{\\mathrm{ref}} = N_{\\mathrm{el}} E_{\\mathrm{el}}^{\\mathrm{bulk}} + N_{\\mathrm{cath}} E_{\\mathrm{cath}}^{\\mathrm{bulk}}\n$$\n其中 $E_{\\mathrm{el}}^{\\mathrm{bulk}}$ 和 $E_{\\mathrm{cath}}^{\\mathrm{bulk}}$ 分别是各自体相在其化学计量形式下每个化学式单位的 DFT 计算能量。设 $n_{\\mathrm{Li}}^{\\mathrm{el}}$ 和 $n_{\\mathrm{Li}}^{\\mathrm{cath}}$ 分别是一个体相电解质和一个体相阴极化学式单位中的锂原子数。这个化学计量参考系统中的锂原子总数为：\n$$\nN_{\\mathrm{Li}}^{\\mathrm{ref}} = N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}\n$$\n问题将 $\\Delta N_{\\mathrm{Li}}$ 定义为板状超胞中相对于此化学计量体相组合的锂的过量或亏损。因此，板状结构中的锂原子数为：\n$$\nN_{\\mathrm{Li}}^{\\mathrm{slab}} = N_{\\mathrm{Li}}^{\\mathrm{ref}} + \\Delta N_{\\mathrm{Li}} = (N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}) + \\Delta N_{\\mathrm{Li}}\n$$\n我们现在可以用这些量来写出板状结构的巨势 $\\Omega_{\\mathrm{slab}}$：\n$$\n\\Omega_{\\mathrm{slab}} = E_{\\mathrm{int}} - ( (N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}) + \\Delta N_{\\mathrm{Li}} ) \\mu_{\\mathrm{Li}}\n$$\n类似地，参考系统的巨势 $\\Omega_{\\mathrm{ref}}$ 为：\n$$\n\\Omega_{\\mathrm{ref}} = E_{\\mathrm{ref}} - N_{\\mathrm{Li}}^{\\mathrm{ref}} \\mu_{\\mathrm{Li}} = (N_{\\mathrm{el}} E_{\\mathrm{el}}^{\\mathrm{bulk}} + N_{\\mathrm{cath}} E_{\\mathrm{cath}}^{\\mathrm{bulk}}) - (N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}) \\mu_{\\mathrm{Li}}\n$$\n\n在板状结构中形成界面所需的总过量巨势 $\\Delta\\Omega_{\\mathrm{int}}^{\\mathrm{total}}$ 是差值 $\\Omega_{\\mathrm{slab}} - \\Omega_{\\mathrm{ref}}$：\n$$\n\\Delta\\Omega_{\\mathrm{int}}^{\\mathrm{total}} = \\left[ E_{\\mathrm{int}} - ( (N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}) + \\Delta N_{\\mathrm{Li}} ) \\mu_{\\mathrm{Li}} \\right] - \\left[ (N_{\\mathrm{el}} E_{\\mathrm{el}}^{\\mathrm{bulk}} + N_{\\mathrm{cath}} E_{\\mathrm{cath}}^{\\mathrm{bulk}}) - (N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}) \\mu_{\\mathrm{Li}} \\right]\n$$\n展开并消去项：\n$$\n\\Delta\\Omega_{\\mathrm{int}}^{\\mathrm{total}} = E_{\\mathrm{int}} - (N_{\\mathrm{el}} E_{\\mathrm{el}}^{\\mathrm{bulk}} + N_{\\mathrm{cath}} E_{\\mathrm{cath}}^{\\mathrm{bulk}}) - (N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}) \\mu_{\\mathrm{Li}} - \\Delta N_{\\mathrm{Li}} \\mu_{\\mathrm{Li}} + (N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}) \\mu_{\\mathrm{Li}}\n$$\n涉及化学计量体相中锂原子数 $n_{\\mathrm{Li}}^{\\mathrm{el}}$ 和 $n_{\\mathrm{Li}}^{\\mathrm{cath}}$ 的项相互抵消。这是一个关键的简化，使得计算可以在不需要知道体相材料具体化学式的情况下进行，仅依赖于过量锂的数量 $\\Delta N_{\\mathrm{Li}}$。得到的表达式为：\n$$\n\\Delta\\Omega_{\\mathrm{int}}^{\\mathrm{total}} = E_{\\mathrm{int}} - (N_{\\mathrm{el}} E_{\\mathrm{el}}^{\\mathrm{bulk}} + N_{\\mathrm{cath}} E_{\\mathrm{cath}}^{\\mathrm{bulk}}) - \\Delta N_{\\mathrm{Li}} \\mu_{\\mathrm{Li}}\n$$\n这个量代表了超胞中形成 $n_{\\mathrm{int}}$ 个界面的总巨自由形成能。单位面积的界面自由能 $\\gamma_{\\mathrm{int}}$ 是通过将这个总过量能量除以总界面面积 $n_{\\mathrm{int}} A$ 得到的。\n$$\n\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}}) = \\frac{\\Delta\\Omega_{\\mathrm{int}}^{\\mathrm{total}}}{n_{\\mathrm{int}} A}\n$$\n代入 $\\Delta\\Omega_{\\mathrm{int}}^{\\mathrm{total}}$ 的表达式，得到最终公式：\n$$\n\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}}) = \\frac{1}{n_{\\mathrm{int}} A} \\left[ E_{\\mathrm{int}} - (N_{\\mathrm{el}} E_{\\mathrm{el}}^{\\mathrm{bulk}} + N_{\\mathrm{cath}} E_{\\mathrm{cath}}^{\\mathrm{bulk}}) - \\Delta N_{\\mathrm{Li}} \\mu_{\\mathrm{Li}} \\right]\n$$\n这个推导出的表达式在 $\\mu_{\\mathrm{Li}}$ 中是线性的，斜率为 $-\\Delta N_{\\mathrm{Li}} / (n_{\\mathrm{int}} A)$，y轴截距对应于 $\\mu_{\\mathrm{Li}} = 0$ 时的形成能。\n\n### 第 2 部分：实现与敏感性分析\n\n程序将实现推导出的公式。对于每个测试案例，它将遍历给定的 $\\mu_{\\mathrm{Li}}$ 值列表并计算 $\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}})$。能量值的单位是 $\\mathrm{eV}$，面积的单位是 $\\text{\\AA}^2$。结果必须使用提供的换算因子转换为国际单位制（$\\mathrm{J}/\\mathrm{m}^2$）。\n\n算法步骤如下：\n1.  定义用于单位换算的物理常数。\n2.  将输入数据（体相能量、$\\mu_{\\mathrm{Li}}$ 值和测试案例参数）存储在适当的数据结构中。\n3.  对于四个测试案例中的每一个：\n    a. 初始化一个列表以存储当前案例的结果。\n    b. 对于每个 $\\mu_{\\mathrm{Li}}$ 值：\n        i. 计算参考体相组分的能量：$E_{\\mathrm{ref}} = N_{\\mathrm{el}} E_{\\mathrm{el}}^{\\mathrm{bulk}} + N_{\\mathrm{cath}} E_{\\mathrm{cath}}^{\\mathrm{bulk}}$。\n        ii. 使用推导的公式计算总过量巨势 $\\Delta\\Omega_{\\mathrm{int}}^{\\mathrm{total}}$（单位为 $\\mathrm{eV}$）。\n        iii. 通过除以 $n_{\\mathrm{int}} A$ 计算 $\\gamma_{\\mathrm{int}}$（单位为 $\\mathrm{eV}/\\text{\\AA}^2$）。\n        iv. 将 $\\gamma_{\\mathrm{int}}$ 从 $\\mathrm{eV}/\\text{\\AA}^2$ 转换为 $\\mathrm{J}/\\mathrm{m}^2$。\n        v. 将转换后的值附加到当前案例的结果列表中。\n4. 在计算完所有案例的 $\\gamma_{\\mathrm{int}}$ 值后，计算四个指定的敏感性指标。每个指标是一对案例之间 $\\gamma_{\\mathrm{int}}$ 的最大绝对差，该差值在 $\\mu_{\\mathrm{Li}}$ 值范围内进行评估。例如，对于尺寸敏感性 A，我们计算 $\\max(|\\gamma_{2}(\\mu_{\\mathrm{Li}}) - \\gamma_{1}(\\mu_{\\mathrm{Li}})|)$，其中 $\\mu_{\\mathrm{Li}} \\in \\{-2.0, -1.0, 0.0\\}$。\n5. 将所有计算值（四个 $\\gamma_{\\mathrm{int}}$ 列表和四个敏感性指标）格式化为六位小数。\n6. 按照指定的列表格式组装最终的输出字符串。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the interface free energy for electrolyte-cathode interfaces\n    in a grand canonical ensemble for Lithium, and reports on numerical sensitivities.\n    \"\"\"\n\n    # --- Givens and Constants ---\n\n    # Physical constants for unit conversion\n    EV_TO_J = 1.602176634e-19  # Joules per eV\n    AA2_TO_M2 = 1e-20         # square meters per square Angstrom\n\n    # Common bulk reference energies per formula unit (eV)\n    E_el_bulk = -400.0\n    E_cath_bulk = -210.0\n\n    # Lithium chemical potentials to evaluate (eV)\n    mu_li_values = np.array([-2.0, -1.0, 0.0])\n\n    # Test cases: (E_int, N_el, N_cath, dN_Li, A, n_int)\n    # E_int: total energy of interface slab supercell (eV)\n    # N_el: number of electrolyte formula units\n    # N_cath: number of cathode formula units\n    # dN_Li: excess number of Li atoms\n    # A: interface area (Å^2)\n    # n_int: number of identical interfaces in the slab\n    test_cases = [\n        # Case 1: Small supercell, reconstruction A\n        (-2037.0, 3, 4, 2, 100.0, 2),\n        # Case 2: Large supercell, reconstruction A\n        (-4076.6, 6, 8, 2, 100.0, 2),\n        # Case 3: Small supercell, reconstruction B\n        (-2035.8, 3, 4, 0, 100.0, 2),\n        # Case 4: Large supercell, reconstruction B\n        (-4076.0, 6, 8, 0, 100.0, 2),\n    ]\n\n    # --- Calculation of Interface Energy ---\n    \n    all_gamma_results = []\n\n    def calculate_gamma_ev_per_aa2(E_int, N_el, N_cath, dN_Li, A, n_int, mu_li):\n        # Calculate the energy of the reference bulk components\n        E_ref_bulk = N_el * E_el_bulk + N_cath * E_cath_bulk\n        \n        # Calculate the total excess grand potential in eV\n        # Formula: ΔΩ = E_int - E_ref_bulk - ΔN_Li * μ_Li\n        delta_omega_total = E_int - E_ref_bulk - dN_Li * mu_li\n        \n        # Normalize by total interface area to get γ_int in eV/Å^2\n        gamma = delta_omega_total / (n_int * A)\n        return gamma\n\n    for case in test_cases:\n        E_int, N_el, N_cath, dN_Li, A, n_int = case\n        \n        # Calculate gamma for each mu_Li value. Can be vectorized with numpy.\n        gamma_ev_aa2 = calculate_gamma_ev_per_aa2(E_int, N_el, N_cath, dN_Li, A, n_int, mu_li_values)\n        \n        # Convert units from eV/Å^2 to J/m^2\n        gamma_j_m2 = gamma_ev_aa2 * (EV_TO_J / AA2_TO_M2)\n        \n        all_gamma_results.append(gamma_j_m2)\n\n    # --- Sensitivity Analysis ---\n\n    # Unpack gamma results for clarity\n    gamma_case1 = all_gamma_results[0]\n    gamma_case2 = all_gamma_results[1]\n    gamma_case3 = all_gamma_results[2]\n    gamma_case4 = all_gamma_results[3]\n\n    # Supercell size sensitivity for reconstruction A (case 2 vs 1)\n    sens_size_A = np.max(np.abs(gamma_case2 - gamma_case1))\n\n    # Supercell size sensitivity for reconstruction B (case 4 vs 3)\n    sens_size_B = np.max(np.abs(gamma_case4 - gamma_case3))\n\n    # Reconstruction sensitivity at small thickness (case 3 vs 1)\n    sens_recon_small = np.max(np.abs(gamma_case3 - gamma_case1))\n\n    # Reconstruction sensitivity at large thickness (case 4 vs 2)\n    sens_recon_large = np.max(np.abs(gamma_case4 - gamma_case2))\n    \n    sensitivities = [sens_size_A, sens_size_B, sens_recon_small, sens_recon_large]\n\n    # --- Formatting Output ---\n    \n    # Format gamma lists to strings with 6 decimal places\n    formatted_gamma_lists = [\n        f\"[{','.join([f'{g:.6f}' for g in glist])}]\"\n        for glist in all_gamma_results\n    ]\n    \n    # Format sensitivity values to strings with 6 decimal places\n    formatted_sens = [f'{s:.6f}' for s in sensitivities]\n    \n    # Combine all parts into a single string as per the required output format\n    final_output_str = f\"[{','.join(formatted_gamma_lists + formatted_sens)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}