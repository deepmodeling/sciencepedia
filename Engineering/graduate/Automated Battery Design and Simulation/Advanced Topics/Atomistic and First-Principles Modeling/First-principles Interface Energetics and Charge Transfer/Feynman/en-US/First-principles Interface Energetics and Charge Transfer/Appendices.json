{
    "hands_on_practices": [
        {
            "introduction": "The formation of an interface between two dissimilar materials is fundamentally an electronic process driven by the quest for thermodynamic equilibrium. This practice explores the initial consequence of bringing two metals into contact: the alignment of their Fermi levels ($E_F$). By calculating the resulting contact potential from the materials' intrinsic work functions, you will gain a foundational understanding of the built-in electric fields that dictate charge distribution and energy band bending at any heterointerface .",
            "id": "3915114",
            "problem": "Consider two semi-infinite, clean metallic electrodes, labeled material $A$ and material $B$, brought into intimate contact in ultra-high vacuum at temperature $T$ sufficiently low that thermal emission is negligible. Their surfaces are atomically flat and free of contaminants, so that the only interface effect is electronic charge transfer to reach equilibrium. The work function of a material is defined by $\\phi \\equiv E_{\\mathrm{vac}} - E_{F}$, where $E_{\\mathrm{vac}}$ is the local vacuum level and $E_{F}$ is the Fermi level, both referenced to a common energy zero. Prior to contact, the measured work functions are $\\phi_{A} = 4.35\\,\\mathrm{eV}$ and $\\phi_{B} = 5.20\\,\\mathrm{eV}$. Upon contact, electrons redistribute until the Fermi levels align, establishing a built-in electric potential step across the interface. You may take the elementary charge magnitude to be $e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$ and use the widely accepted equivalence $1\\,\\mathrm{eV} = e \\times 1\\,\\mathrm{V}$ when relating energy differences to potential differences.\n\nStarting from the definitions of work function and the requirement of electrochemical equilibrium for electrons (common Fermi level across the interface), derive the built-in contact potential difference $\\Delta V \\equiv V_{B} - V_{A}$ between the two materials at equilibrium. Then, determine the direction of spontaneous electron flow upon initial contact before equilibrium is reached. Use the following encoding for the flow direction: define a sign variable $s$ such that $s=+1$ if electrons flow from $A$ to $B$, and $s=-1$ if electrons flow from $B$ to $A$.\n\nYour final answer must be a two-entry row matrix containing $(\\Delta V, s)$ in that order. Express the contact potential in volts and round it to four significant figures. The direction sign $s$ is dimensionless and must be given exactly as $+1$ or $-1$ without any rounding.",
            "solution": "The problem requires the derivation and calculation of the built-in contact potential difference, $\\Delta V$, and the determination of the direction of spontaneous electron flow, represented by a sign variable $s$, when two dissimilar metals are brought into contact.\n\nThe fundamental principle governing the behavior of electrons at the interface between two materials is the tendency of the system to reach thermodynamic equilibrium. For electrons in conducting solids, this equilibrium state is characterized by a single, uniform electrochemical potential across the entire system. At temperatures, $T$, low enough to neglect thermal effects, the electrochemical potential is identical to the Fermi level, $E_F$.\n\nLet us first analyze the state of the two semi-infinite metals, material $A$ and material $B$, before they are brought into contact. The work function, $\\phi$, of a material is defined as the energy required to move an electron from the Fermi level, $E_F$, to the local vacuum level, $E_{\\mathrm{vac}}$, which is the energy of a stationary electron in the vacuum just outside the material's surface. The work function is thus given by the relation $\\phi = E_{\\mathrm{vac}} - E_F$.\n\nThe given work functions are $\\phi_A = 4.35\\,\\mathrm{eV}$ for material $A$ and $\\phi_B = 5.20\\,\\mathrm{eV}$ for material $B$. When the materials are separated by a large distance in vacuum, we can establish a common energy reference by aligning their vacuum levels, such that $E_{\\mathrm{vac}, A} = E_{\\mathrm{vac}, B} = E_{\\mathrm{vac, common}}$. The initial Fermi levels of the isolated materials are then given by:\n$$E_{F,A} = E_{\\mathrm{vac, common}} - \\phi_A$$\n$$E_{F,B} = E_{\\mathrm{vac, common}} - \\phi_B$$\n\nSince $\\phi_A < \\phi_B$ (specifically, $4.35\\,\\mathrm{eV} < 5.20\\,\\mathrm{eV}$), it follows directly that $E_{F,A} > E_{F,B}$. This means that prior to contact, the electrons at the Fermi level in material $A$ have a higher energy than those at the Fermi level in material $B$.\n\nUpon establishing intimate contact, a path for electron transfer is created. To minimize the total energy of the system, electrons will spontaneously flow from the material with the higher Fermi level to the material with the lower Fermi level. In this case, electrons flow from material $A$ to material $B$. This process continues until equilibrium is achieved.\n\nThe direction of electron flow determines the value of the sign variable $s$. The problem defines $s=+1$ for flow from $A$ to $B$ and $s=-1$ for flow from $B$ to $A$. As we have established that electrons flow from $A$ to $B$, the value of the sign variable is $s = 1$.\n\nThe net transfer of electrons from $A$ to $B$ results in the accumulation of a net negative charge on the surface of material $B$ and a net positive charge on the surface of material $A$. This separation of charge forms an electric dipole layer at the interface, which in turn generates a localized electric field pointing from $A$ to $B$. This electric field creates a difference in the macroscopic electrostatic potential between the bulk of the two materials. This difference is the contact potential difference, $\\Delta V \\equiv V_B - V_A$.\n\nAt equilibrium, the net flow of charge ceases, which occurs when the Fermi levels of the two materials align to a common value, $E_F$. The intrinsic work functions, $\\phi_A$ and $\\phi_B$, remain properties of their respective materials. At the interface, the local vacuum levels are now shifted relative to each other by the contact potential. The relations are:\n$$E_{\\mathrm{vac}, A} = E_F + \\phi_A$$\n$$E_{\\mathrm{vac}, B} = E_F + \\phi_B$$\nHere, $E_{\\mathrm{vac}, A}$ and $E_{\\mathrm{vac}, B}$ are the vacuum levels just outside material $A$ and material $B$ at the interface, respectively, and $E_F$ is the common Fermi level of the combined system.\n\nThe difference in energy between the two local vacuum levels is:\n$$\\Delta E_{\\mathrm{vac}} = E_{\\mathrm{vac}, B} - E_{\\mathrm{vac}, A} = (E_F + \\phi_B) - (E_F + \\phi_A) = \\phi_B - \\phi_A$$\nThis energy difference is entirely due to the difference in electrostatic potential across the interface. The potential energy of an electron with charge $-e$ (where $e$ is the elementary charge magnitude) in an electrostatic potential $V$ is $U = -eV$. Thus, the difference in potential energy for an electron moving between the two sides of the interface is directly related to the contact potential difference $\\Delta V$:\n$$\\Delta E_{\\mathrm{vac}} = -e (V_B - V_A) = -e \\Delta V$$\nBy equating the two expressions for $\\Delta E_{\\mathrm{vac}}$, we obtain:\n$$-e \\Delta V = \\phi_B - \\phi_A$$\nSolving for the contact potential difference, $\\Delta V$, yields:\n$$\\Delta V = \\frac{\\phi_A - \\phi_B}{e}$$\nWe are given the values $\\phi_A = 4.35\\,\\mathrm{eV}$ and $\\phi_B = 5.20\\,\\mathrm{eV}$. Substituting these into the equation:\n$$\\Delta V = \\frac{4.35\\,\\mathrm{eV} - 5.20\\,\\mathrm{eV}}{e} = \\frac{-0.85\\,\\mathrm{eV}}{e}$$\nThe problem states the equivalence $1\\,\\mathrm{eV} = e \\times 1\\,\\mathrm{V}$. This allows for a direct conversion of the energy difference in electron-volts to a potential difference in volts:\n$$\\Delta V = \\frac{-0.85 \\times (e \\cdot 1\\,\\mathrm{V})}{e} = -0.85\\,\\mathrm{V}$$\nThe problem requires the result for $\\Delta V$ to be expressed to four significant figures. Therefore, we write:\n$$\\Delta V = -0.8500\\,\\mathrm{V}$$\nThe negative sign indicates that the potential of material $B$ is lower than that of material $A$ ($V_B < V_A$), which is consistent with an electric field pointing from $A$ to $B$ that opposes further electron flow.\n\nThe final answer requires a two-entry row matrix containing $(\\Delta V, s)$. We have found $\\Delta V = -0.8500$ and $s = 1$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.8500 & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Beyond simple electronic equilibrium, the thermodynamic stability of a battery interface depends on the operating conditions, particularly the chemical potential of the active ion (e.g., $\\mu_{\\mathrm{Li}}$). This exercise guides you through the formulation and implementation of *ab initio* thermodynamics to compute the interface free energy ($\\gamma_{\\mathrm{int}}$) within a grand canonical framework. This practice is essential for predicting which interface structures are stable at different states of charge and for understanding degradation mechanisms .",
            "id": "3915077",
            "problem": "A solid electrolyte and a cathode form a coherent interface in a periodic slab supercell that contains two identical interfaces. In automated battery design and simulation, the energetics of this interface under Lithium (Li) exchange with a reservoir depend on the Lithium chemical potential. Starting from first principles, you must formulate the interface energetics using ab initio thermodynamics for the grand canonical treatment of Lithium.\n\nUse the following foundational base:\n- The Gibbs free energy $G$ of a system at temperature $T$ satisfies $dG = -S\\,dT + V\\,dP + \\sum_i \\mu_i\\,dN_i$, where $S$ is entropy, $V$ is volume, $P$ is pressure, $\\mu_i$ are chemical potentials, and $N_i$ are particle numbers.\n- In the Grand Canonical Ensemble (GCE), the grand potential is $\\Omega = G - \\sum_i \\mu_i N_i$.\n- For zero temperature and solid phases under negligible pressure, it is common in ab initio thermodynamics to approximate $G \\approx E$, where $E$ is the total electronic energy obtained from Density Functional Theory (DFT) calculations.\n\nTask:\n1. Starting strictly from the definitions above (without introducing any shortcut formulas), derive the expression for the interface free energy per area $\\,\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}})\\,$ as a function of the Lithium chemical potential $\\,\\mu_{\\mathrm{Li}}\\,$, for a slab supercell containing $\\,n_{\\mathrm{int}}\\,$ identical interfaces and in which the counts of the solid electrolyte and cathode formula units are $\\,N_{\\mathrm{el}}\\,$ and $\\,N_{\\mathrm{cath}}\\,$, respectively. The slab may have an excess or deficit of Lithium relative to the stoichiometric combination of those bulk phases, quantified by $\\,\\Delta N_{\\mathrm{Li}}\\,$. Assume the reference for the bulk phases is their stoichiometric compositions at the same $\\,\\mu_{\\mathrm{Li}}\\,$. Your derivation should clearly show how $\\,\\mu_{\\mathrm{Li}}\\,$ enters linearly through the grand potential, and how division by the number of interfaces and the interface area produces $\\,\\gamma_{\\mathrm{int}}$.\n2. Implement the derived expression in a complete, runnable program that computes $\\,\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}})\\,$ in $\\mathrm{J}/\\mathrm{m}^2$ for multiple supercells and reconstructions, for a set of Lithium chemical potentials. Use the conversion factors $\\,1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}\\,$ and $\\,1\\,\\text{\\AA}^2 = 10^{-20}\\,\\mathrm{m}^2$.\n3. Report sensitivity to supercell size and to interface reconstruction by computing the maximum absolute deviation in $\\,\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}})\\,$ across the tested $\\,\\mu_{\\mathrm{Li}}$ values for specified pairs of cases.\n\nAssumptions:\n- Work at $\\,T \\approx 0\\,\\mathrm{K}\\,$ and negligible pressure, so $\\,G \\approx E\\,$ and $\\,pV\\,$ and $\\,TS\\,$ contributions can be neglected.\n- Each tested slab contains $\\,n_{\\mathrm{int}} = 2\\,$ identical interfaces.\n- The interface area $\\,A\\,$ is the same across slabs that differ by thickness.\n\nUnits:\n- Input energies are in $\\mathrm{eV}$ per supercell or per formula unit as specified.\n- Interface area $\\,A\\,$ is in $\\text{\\AA}^2$.\n- Lithium chemical potential $\\,\\mu_{\\mathrm{Li}}\\,$ is in $\\mathrm{eV}$ per atom.\n- Express the final interface energy $\\,\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}})\\,$ in $\\mathrm{J}/\\mathrm{m}^2$, rounded to six decimal places.\n\nTest suite (four cases: two supercell thicknesses and two reconstructions):\n- Common bulk reference energies per formula unit:\n  - Solid electrolyte: $E_{\\mathrm{el}}^{\\mathrm{bulk}} = -400.0\\,\\mathrm{eV}$.\n  - Cathode: $E_{\\mathrm{cath}}^{\\mathrm{bulk}} = -210.0\\,\\mathrm{eV}$.\n- Interface area and number of interfaces:\n  - $A = 100.0\\,\\text{\\AA}^2$, $n_{\\mathrm{int}} = 2$.\n- Lithium chemical potentials to evaluate (ordered list):\n  - $\\mu_{\\mathrm{Li}} \\in \\{-2.0\\,\\mathrm{eV}, -1.0\\,\\mathrm{eV}, 0.0\\,\\mathrm{eV}\\}$.\n\nDefine the four test cases as tuples $(E_{\\mathrm{int}}, N_{\\mathrm{el}}, N_{\\mathrm{cath}}, \\Delta N_{\\mathrm{Li}}, A, n_{\\mathrm{int}})$:\n1. Small supercell, reconstruction A:\n   - $E_{\\mathrm{int}} = -2037.0\\,\\mathrm{eV}$, $N_{\\mathrm{el}} = 3$, $N_{\\mathrm{cath}} = 4$, $\\Delta N_{\\mathrm{Li}} = +2$, $A = 100.0\\,\\text{\\AA}^2$, $n_{\\mathrm{int}} = 2$.\n2. Large (thicker) supercell, reconstruction A:\n   - $E_{\\mathrm{int}} = -4076.6\\,\\mathrm{eV}$, $N_{\\mathrm{el}} = 6$, $N_{\\mathrm{cath}} = 8$, $\\Delta N_{\\mathrm{Li}} = +2$, $A = 100.0\\,\\text{\\AA}^2$, $n_{\\mathrm{int}} = 2$.\n3. Small supercell, reconstruction B:\n   - $E_{\\mathrm{int}} = -2035.8\\,\\mathrm{eV}$, $N_{\\mathrm{el}} = 3$, $N_{\\mathrm{cath}} = 4$, $\\Delta N_{\\mathrm{Li}} = 0$, $A = 100.0\\,\\text{\\AA}^2$, $n_{\\mathrm{int}} = 2$.\n4. Large (thicker) supercell, reconstruction B:\n   - $E_{\\mathrm{int}} = -4076.0\\,\\mathrm{eV}$, $N_{\\mathrm{el}} = 6$, $N_{\\mathrm{cath}} = 8$, $\\Delta N_{\\mathrm{Li}} = 0$, $A = 100.0\\,\\text{\\AA}^2$, $n_{\\mathrm{int}} = 2$.\n\nSensitivity metrics to report (each rounded to six decimal places):\n- Supercell size sensitivity for reconstruction A: the maximum absolute difference between case $2$ and case $1$ across the three $\\,\\mu_{\\mathrm{Li}}\\,$ values.\n- Supercell size sensitivity for reconstruction B: the maximum absolute difference between case $4$ and case $3$ across the three $\\,\\mu_{\\mathrm{Li}}\\,$ values.\n- Reconstruction sensitivity at small supercell thickness: the maximum absolute difference between case $3$ and case $1$ across the three $\\,\\mu_{\\mathrm{Li}}\\,$ values.\n- Reconstruction sensitivity at large supercell thickness: the maximum absolute difference between case $4$ and case $2$ across the three $\\,\\mu_{\\mathrm{Li}}\\,$ values.\n\nFinal output format:\n- Your program should produce a single line of output containing a list composed of:\n  - Four sublists, each giving $\\,\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}})\\,$ in $\\mathrm{J}/\\mathrm{m}^2$ for the corresponding case, ordered by the three $\\,\\mu_{\\mathrm{Li}}\\,$ values $[-2.0,-1.0,0.0]$.\n  - Followed by four floats giving the sensitivity metrics defined above, in the order: size sensitivity A, size sensitivity B, reconstruction sensitivity (small), reconstruction sensitivity (large).\n- All floats must be rounded to six decimal places, and the entire structure must be printed as a single comma-separated list enclosed in square brackets, for example: $[\\,[x_1,x_2,x_3],\\,[y_1,y_2,y_3],\\,[z_1,z_2,z_3],\\,[w_1,w_2,w_3],\\,s_A,\\,s_B,\\,r_{\\mathrm{small}},\\,r_{\\mathrm{large}}\\,]$.",
            "solution": "The problem is scientifically grounded, well-posed, and contains all necessary information to derive and compute the interface energetics. Therefore, it is deemed valid.\n\n### Part 1: Derivation of the Interface Free Energy\n\nThe objective is to derive the expression for the interface free energy per unit area, $\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}})$, as a function of the Lithium chemical potential $\\mu_{\\mathrm{Li}}$. The derivation will begin from the fundamental thermodynamic definitions provided.\n\nWe consider a system at zero temperature ($T=0\\,\\mathrm{K}$) and negligible pressure ($P \\approx 0$), for which the Gibbs free energy $G$ is well-approximated by the total electronic energy $E$ from Density Functional Theory (DFT), i.e., $G \\approx E$. The system is in the grand canonical ensemble with respect to Lithium, meaning it can exchange Li atoms with a reservoir at a fixed chemical potential $\\mu_{\\mathrm{Li}}$. The relevant thermodynamic potential is the grand potential, $\\Omega$, defined as:\n$$\n\\Omega = G - \\sum_i \\mu_i N_i\n$$\nIn our case, the only species being exchanged is Lithium, so the expression simplifies to $\\Omega = G - \\mu_{\\mathrm{Li}} N_{\\mathrm{Li}}$. Using the $T=0\\,\\mathrm{K}$ approximation, this becomes:\n$$\n\\Omega = E - \\mu_{\\mathrm{Li}} N_{\\mathrm{Li}}\n$$\nwhere $E$ is the total energy of the system and $N_{\\mathrm{Li}}$ is the number of Li atoms in it.\n\nThe interface free energy, $\\gamma_{\\mathrm{int}}$, represents the excess grand potential per unit area required to form the interface, relative to the constituent bulk materials. To calculate this, we use a subtractive scheme. We compare the grand potential of the supercell containing the interface, $\\Omega_{\\mathrm{slab}}$, with the grand potential of a reference system, $\\Omega_{\\mathrm{ref}}$, composed of the equivalent amounts of the separate bulk phases.\n\nThe interface system is a slab supercell of cross-sectional area $A$, containing $n_{\\mathrm{int}}$ interfaces. Its total energy, calculated via DFT, is $E_{\\mathrm{int}}$. The slab is constructed from $N_{\\mathrm{el}}$ formula units of the solid electrolyte and $N_{\\mathrm{cath}}$ formula units of the cathode. The total number of lithium atoms in this slab is $N_{\\mathrm{Li}}^{\\mathrm{slab}}$. The grand potential of this slab is:\n$$\n\\Omega_{\\mathrm{slab}} = E_{\\mathrm{int}} - N_{\\mathrm{Li}}^{\\mathrm{slab}} \\mu_{\\mathrm{Li}}\n$$\n\nThe reference system is composed of $N_{\\mathrm{el}}$ formula units of the bulk solid electrolyte and $N_{\\mathrm{cath}}$ formula units of the bulk cathode, separate and not forming an interface. The total energy of this reference system is the sum of the energies of its components:\n$$\nE_{\\mathrm{ref}} = N_{\\mathrm{el}} E_{\\mathrm{el}}^{\\mathrm{bulk}} + N_{\\mathrm{cath}} E_{\\mathrm{cath}}^{\\mathrm{bulk}}\n$$\nwhere $E_{\\mathrm{el}}^{\\mathrm{bulk}}$ and $E_{\\mathrm{cath}}^{\\mathrm{bulk}}$ are the DFT-calculated energies per formula unit of the respective bulk phases in their stoichiometric forms. Let $n_{\\mathrm{Li}}^{\\mathrm{el}}$ and $n_{\\mathrm{Li}}^{\\mathrm{cath}}$ be the number of Li atoms in one formula unit of the bulk electrolyte and cathode, respectively. The total number of Li atoms in this stoichiometric reference system is:\n$$\nN_{\\mathrm{Li}}^{\\mathrm{ref}} = N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}\n$$\nThe problem defines $\\Delta N_{\\mathrm{Li}}$ as the excess or deficit of Lithium in the slab supercell relative to this stoichiometric bulk combination. Therefore, the number of Li atoms in the slab is:\n$$\nN_{\\mathrm{Li}}^{\\mathrm{slab}} = N_{\\mathrm{Li}}^{\\mathrm{ref}} + \\Delta N_{\\mathrm{Li}} = (N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}) + \\Delta N_{\\mathrm{Li}}\n$$\nWe can now write the grand potential of the slab, $\\Omega_{\\mathrm{slab}}$, in terms of these quantities:\n$$\n\\Omega_{\\mathrm{slab}} = E_{\\mathrm{int}} - ( (N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}) + \\Delta N_{\\mathrm{Li}} ) \\mu_{\\mathrm{Li}}\n$$\nThe grand potential of the reference system, $\\Omega_{\\mathrm{ref}}$, is similarly:\n$$\n\\Omega_{\\mathrm{ref}} = E_{\\mathrm{ref}} - N_{\\mathrm{Li}}^{\\mathrm{ref}} \\mu_{\\mathrm{Li}} = (N_{\\mathrm{el}} E_{\\mathrm{el}}^{\\mathrm{bulk}} + N_{\\mathrm{cath}} E_{\\mathrm{cath}}^{\\mathrm{bulk}}) - (N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}) \\mu_{\\mathrm{Li}}\n$$\n\nThe total excess grand potential for forming the interfaces in the slab, $\\Delta\\Omega_{\\mathrm{int}}^{\\mathrm{total}}$, is the difference $\\Omega_{\\mathrm{slab}} - \\Omega_{\\mathrm{ref}}$:\n$$\n\\Delta\\Omega_{\\mathrm{int}}^{\\mathrm{total}} = \\left[ E_{\\mathrm{int}} - ( (N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}) + \\Delta N_{\\mathrm{Li}} ) \\mu_{\\mathrm{Li}} \\right] - \\left[ (N_{\\mathrm{el}} E_{\\mathrm{el}}^{\\mathrm{bulk}} + N_{\\mathrm{cath}} E_{\\mathrm{cath}}^{\\mathrm{bulk}}) - (N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}) \\mu_{\\mathrm{Li}} \\right]\n$$\nExpanding and canceling terms:\n$$\n\\Delta\\Omega_{\\mathrm{int}}^{\\mathrm{total}} = E_{\\mathrm{int}} - (N_{\\mathrm{el}} E_{\\mathrm{el}}^{\\mathrm{bulk}} + N_{\\mathrm{cath}} E_{\\mathrm{cath}}^{\\mathrm{bulk}}) - (N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}) \\mu_{\\mathrm{Li}} - \\Delta N_{\\mathrm{Li}} \\mu_{\\mathrm{Li}} + (N_{\\mathrm{el}} n_{\\mathrm{Li}}^{\\mathrm{el}} + N_{\\mathrm{cath}} n_{\\mathrm{Li}}^{\\mathrm{cath}}) \\mu_{\\mathrm{Li}}\n$$\nThe terms involving the number of Li atoms in the stoichiometric bulk phases, $n_{\\mathrm{Li}}^{\\mathrm{el}}$ and $n_{\\mathrm{Li}}^{\\mathrm{cath}}$, cancel out. This is a crucial simplification that allows the calculation to proceed without needing to know the explicit chemical formulae of the bulk materials, relying only on the excess Li count $\\Delta N_{\\mathrm{Li}}$. The resulting expression is:\n$$\n\\Delta\\Omega_{\\mathrm{int}}^{\\mathrm{total}} = E_{\\mathrm{int}} - (N_{\\mathrm{el}} E_{\\mathrm{el}}^{\\mathrm{bulk}} + N_{\\mathrm{cath}} E_{\\mathrm{cath}}^{\\mathrm{bulk}}) - \\Delta N_{\\mathrm{Li}} \\mu_{\\mathrm{Li}}\n$$\nThis quantity represents the total grand free energy of formation for the $n_{\\mathrm{int}}$ interfaces in the supercell. The interface free energy per unit area, $\\gamma_{\\mathrm{int}}$, is obtained by dividing this total excess energy by the total interface area, which is $n_{\\mathrm{int}} A$.\n$$\n\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}}) = \\frac{\\Delta\\Omega_{\\mathrm{int}}^{\\mathrm{total}}}{n_{\\mathrm{int}} A}\n$$\nSubstituting the expression for $\\Delta\\Omega_{\\mathrm{int}}^{\\mathrm{total}}$ gives the final formula:\n$$\n\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}}) = \\frac{1}{n_{\\mathrm{int}} A} \\left[ E_{\\mathrm{int}} - (N_{\\mathrm{el}} E_{\\mathrm{el}}^{\\mathrm{bulk}} + N_{\\mathrm{cath}} E_{\\mathrm{cath}}^{\\mathrm{bulk}}) - \\Delta N_{\\mathrm{Li}} \\mu_{\\mathrm{Li}} \\right]\n$$\nThis derived expression is linear in $\\mu_{\\mathrm{Li}}$, with a slope of $-\\Delta N_{\\mathrm{Li}} / (n_{\\mathrm{int}} A)$ and a y-intercept corresponding to the formation energy at $\\mu_{\\mathrm{Li}} = 0$.\n\n### Part 2: Implementation and Sensitivity Analysis\n\nThe program will implement the derived formula. For each test case, it will iterate through the given list of $\\mu_{\\mathrm{Li}}$ values and calculate $\\gamma_{\\mathrm{int}}(\\mu_{\\mathrm{Li}})$. The energy values are in $\\mathrm{eV}$, and the area is in $\\text{\\AA}^2$. The result must be converted to SI units ($\\mathrm{J}/\\mathrm{m}^2$) using the provided conversion factors.\n\nThe algorithmic steps are:\n1.  Define physical constants for unit conversion.\n2.  Store the input data (bulk energies, $\\mu_{\\mathrm{Li}}$ values, and test case parameters) in appropriate data structures.\n3.  For each of the four test cases:\n    a. Initialize a list to store the results for the current case.\n    b. For each value of $\\mu_{\\mathrm{Li}}$:\n        i. Calculate the reference bulk energy: $E_{\\mathrm{ref}} = N_{\\mathrm{el}} E_{\\mathrm{el}}^{\\mathrm{bulk}} + N_{\\mathrm{cath}} E_{\\mathrm{cath}}^{\\mathrm{bulk}}$.\n        ii. Calculate the total excess grand potential $\\Delta\\Omega_{\\mathrm{int}}^{\\mathrm{total}}$ in $\\mathrm{eV}$ using the derived formula.\n        iii. Calculate $\\gamma_{\\mathrm{int}}$ in $\\mathrm{eV}/\\text{\\AA}^2$ by dividing by $n_{\\mathrm{int}} A$.\n        iv. Convert $\\gamma_{\\mathrm{int}}$ from $\\mathrm{eV}/\\text{\\AA}^2$ to $\\mathrm{J}/\\mathrm{m}^2$.\n        v. Append the converted value to the results list for the current case.\n4. After computing the $\\gamma_{\\mathrm{int}}$ values for all cases, calculate the four specified sensitivity metrics. Each metric is the maximum absolute difference in $\\gamma_{\\mathrm{int}}$ between a pair of cases, evaluated across the range of $\\mu_{\\mathrm{Li}}$ values. For example, for size sensitivity A, we compute $\\max(|\\gamma_{2}(\\mu_{\\mathrm{Li}}) - \\gamma_{1}(\\mu_{\\mathrm{Li}})|)$ for $\\mu_{\\mathrm{Li}} \\in \\{-2.0, -1.0, 0.0\\}$.\n5. Format all computed values (the four lists of $\\gamma_{\\mathrm{int}}$ and the four sensitivity metrics) to six decimal places.\n6. Assemble the final output string in the specified list format.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the interface free energy for electrolyte-cathode interfaces\n    in a grand canonical ensemble for Lithium, and reports on numerical sensitivities.\n    \"\"\"\n\n    # --- Givens and Constants ---\n\n    # Physical constants for unit conversion\n    EV_TO_J = 1.602176634e-19  # Joules per eV\n    AA2_TO_M2 = 1e-20         # square meters per square Angstrom\n\n    # Common bulk reference energies per formula unit (eV)\n    E_el_bulk = -400.0\n    E_cath_bulk = -210.0\n\n    # Lithium chemical potentials to evaluate (eV)\n    mu_li_values = np.array([-2.0, -1.0, 0.0])\n\n    # Test cases: (E_int, N_el, N_cath, dN_Li, A, n_int)\n    # E_int: total energy of interface slab supercell (eV)\n    # N_el: number of electrolyte formula units\n    # N_cath: number of cathode formula units\n    # dN_Li: excess number of Li atoms\n    # A: interface area (Å^2)\n    # n_int: number of identical interfaces in the slab\n    test_cases = [\n        # Case 1: Small supercell, reconstruction A\n        (-2037.0, 3, 4, 2, 100.0, 2),\n        # Case 2: Large supercell, reconstruction A\n        (-4076.6, 6, 8, 2, 100.0, 2),\n        # Case 3: Small supercell, reconstruction B\n        (-2035.8, 3, 4, 0, 100.0, 2),\n        # Case 4: Large supercell, reconstruction B\n        (-4076.0, 6, 8, 0, 100.0, 2),\n    ]\n\n    # --- Calculation of Interface Energy ---\n    \n    all_gamma_results = []\n\n    def calculate_gamma_ev_per_aa2(E_int, N_el, N_cath, dN_Li, A, n_int, mu_li):\n        # Calculate the energy of the reference bulk components\n        E_ref_bulk = N_el * E_el_bulk + N_cath * E_cath_bulk\n        \n        # Calculate the total excess grand potential in eV\n        # Formula: ΔΩ = E_int - E_ref_bulk - ΔN_Li * μ_Li\n        delta_omega_total = E_int - E_ref_bulk - dN_Li * mu_li\n        \n        # Normalize by total interface area to get γ_int in eV/Å^2\n        gamma = delta_omega_total / (n_int * A)\n        return gamma\n\n    for case in test_cases:\n        E_int, N_el, N_cath, dN_Li, A, n_int = case\n        \n        # Calculate gamma for each mu_Li value. Can be vectorized with numpy.\n        gamma_ev_aa2 = calculate_gamma_ev_per_aa2(E_int, N_el, N_cath, dN_Li, A, n_int, mu_li_values)\n        \n        # Convert units from eV/Å^2 to J/m^2\n        gamma_j_m2 = gamma_ev_aa2 * (EV_TO_J / AA2_TO_M2)\n        \n        all_gamma_results.append(gamma_j_m2)\n\n    # --- Sensitivity Analysis ---\n\n    # Unpack gamma results for clarity\n    gamma_case1 = all_gamma_results[0]\n    gamma_case2 = all_gamma_results[1]\n    gamma_case3 = all_gamma_results[2]\n    gamma_case4 = all_gamma_results[3]\n\n    # Supercell size sensitivity for reconstruction A (case 2 vs 1)\n    sens_size_A = np.max(np.abs(gamma_case2 - gamma_case1))\n\n    # Supercell size sensitivity for reconstruction B (case 4 vs 3)\n    sens_size_B = np.max(np.abs(gamma_case4 - gamma_case3))\n\n    # Reconstruction sensitivity at small thickness (case 3 vs 1)\n    sens_recon_small = np.max(np.abs(gamma_case3 - gamma_case1))\n\n    # Reconstruction sensitivity at large thickness (case 4 vs 2)\n    sens_recon_large = np.max(np.abs(gamma_case4 - gamma_case2))\n    \n    sensitivities = [sens_size_A, sens_size_B, sens_recon_small, sens_recon_large]\n\n    # --- Formatting Output ---\n    \n    # Format gamma lists to strings with 6 decimal places\n    formatted_gamma_lists = [\n        f\"[{','.join([f'{g:.6f}' for g in glist])}]\"\n        for glist in all_gamma_results\n    ]\n    \n    # Format sensitivity values to strings with 6 decimal places\n    formatted_sens = [f'{s:.6f}' for s in sensitivities]\n    \n    # Combine all parts into a single string as per the required output format\n    final_output_str = f\"[{','.join(formatted_gamma_lists + formatted_sens)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Understanding the energetics of an interface is crucial, but for a battery to function, charges must also move across it efficiently. This exercise delves into the kinetics of interfacial electron transfer using the framework of Marcus theory, focusing on the reorganization energy ($\\lambda$) and the reaction free energy ($\\Delta G^0$). By analyzing the statistical distributions of the vertical energy gap sampled during a molecular dynamics simulation, you will learn how to connect atomistic fluctuations to macroscopic charge transfer rates .",
            "id": "3915142",
            "problem": "An automated battery design and simulation workflow requires quantitative estimation of the reorganization energy $\\lambda$ and the standard free energy change $\\Delta G^0$ for an interfacial electron transfer between a redox couple and an electrode, derived from first-principles sampling of solvent configurations. Consider the canonical ensemble at temperature $T$ and two electronic states of the redox system: reduced ($R$) and oxidized ($O$). Let $U_R(\\mathbf{q})$ and $U_O(\\mathbf{q})$ denote the Born–Oppenheimer potential energy surfaces as functions of nuclear coordinates $\\mathbf{q}$. Define the collective reaction coordinate as the instantaneous vertical energy gap\n$$\n\\Delta E(\\mathbf{q}) = U_O(\\mathbf{q}) - U_R(\\mathbf{q}).\n$$\nAssume the linear-response and harmonic-solvent approximations at the interface: the effective solvent coordinate $x$ has free energy surfaces $G_R(x) = \\frac{\\kappa}{2}(x - x_R)^2$ and $G_O(x) = \\frac{\\kappa}{2}(x - x_O)^2 + \\Delta G^0$, with the same curvature $\\kappa$ and minima at $x_R$ and $x_O$, respectively. Under these assumptions, the distributions of $\\Delta E$ sampled from ab initio Molecular Dynamics (AIMD) in the reduced and oxidized ensembles are Gaussian with equal variance. The reorganization energy is defined by\n$$\n\\lambda = \\frac{\\kappa}{2}(x_O - x_R)^2,\n$$\nand the standard free energy change is the offset between the minima,\n$$\n\\Delta G^0 = G_O(x_O) - G_R(x_R).\n$$\nUsing the canonical ensemble and the harmonic approximation, show that the ensemble means of $\\Delta E$ satisfy\n$$\n\\langle \\Delta E \\rangle_R = \\lambda + \\Delta G^0, \\quad \\langle \\Delta E \\rangle_O = -\\lambda + \\Delta G^0,\n$$\nand the ensemble variance satisfies\n$$\n\\mathrm{Var}(\\Delta E) = 2 k_B T \\lambda,\n$$\nwhere $k_B$ is the Boltzmann constant and $T$ is the absolute temperature.\n\nTask: Write a complete, runnable program that, for each test case below, generates synthetic AIMD-like samples of $\\Delta E$ for both ensembles using the Gaussian statistics implied by the above assumptions, then estimates $\\lambda$ and $\\Delta G^0$ using the mean-based relations\n$$\n\\hat{\\lambda} = \\frac{\\langle \\Delta E \\rangle_R - \\langle \\Delta E \\rangle_O}{2}, \\quad \\widehat{\\Delta G^0} = \\frac{\\langle \\Delta E \\rangle_R + \\langle \\Delta E \\rangle_O}{2}.\n$$\nAs an internal consistency check, your algorithm should also compute the variance-based estimate\n$$\n\\hat{\\lambda}_{\\mathrm{var}} = \\frac{\\widehat{\\mathrm{Var}}(\\Delta E)}{2 k_B T},\n$$\nwhere $\\widehat{\\mathrm{Var}}(\\Delta E)$ is the pooled sample variance across the two ensembles; this internal check must not affect the final reported numbers.\n\nFor each test case, generate $\\Delta E$ samples in electronvolts (eV) using the following procedure:\n- Given $T$ (in kelvin), $\\lambda_{\\mathrm{true}}$ (in eV), and $\\Delta G^0_{\\mathrm{true}}$ (in eV), set the ensemble means\n  $$\n  \\mu_R = \\lambda_{\\mathrm{true}} + \\Delta G^0_{\\mathrm{true}}, \\quad \\mu_O = -\\lambda_{\\mathrm{true}} + \\Delta G^0_{\\mathrm{true}}.\n  $$\n- Set the standard deviation $\\sigma = \\sqrt{2 k_B T \\lambda_{\\mathrm{true}}}$ in eV using $k_B = 8.617333262\\times 10^{-5}\\,\\mathrm{eV/K}$.\n- Draw $N_R$ samples of $\\Delta E$ in the reduced ensemble from a normal distribution $\\mathcal{N}(\\mu_R, \\sigma^2)$.\n- Draw $N_O$ samples of $\\Delta E$ in the oxidized ensemble from a normal distribution $\\mathcal{N}(\\mu_O, \\sigma^2)$.\n- Use independent random number generator seeds per test case to ensure reproducibility.\n\nYou must express all energies in electronvolts (eV). Report $\\hat{\\lambda}$ and $\\widehat{\\Delta G^0}$ for each test case, rounded to six decimal places.\n\nTest Suite:\n- Case 1 (general): $T = 300\\,\\mathrm{K}$, $\\lambda_{\\mathrm{true}} = 0.200\\,\\mathrm{eV}$, $\\Delta G^0_{\\mathrm{true}} = -0.050\\,\\mathrm{eV}$, $N_R = 2000$, $N_O = 2000$, seed $= 42$.\n- Case 2 (boundary, symmetric driving): $T = 298\\,\\mathrm{K}$, $\\lambda_{\\mathrm{true}} = 0.050\\,\\mathrm{eV}$, $\\Delta G^0_{\\mathrm{true}} = 0.000\\,\\mathrm{eV}$, $N_R = 3000$, $N_O = 3000$, seed $= 123$.\n- Case 3 (edge, small reorganization at elevated temperature): $T = 350\\,\\mathrm{K}$, $\\lambda_{\\mathrm{true}} = 0.005\\,\\mathrm{eV}$, $\\Delta G^0_{\\mathrm{true}} = 0.100\\,\\mathrm{eV}$, $N_R = 5000$, $N_O = 5000$, seed $= 999$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a two-element list $[\\hat{\\lambda}, \\widehat{\\Delta G^0}]$ in eV, rounded to six decimal places. For example: [[0.200000,-0.050000],[0.050000,0.000000],[0.005000,0.100000].",
            "solution": "The problem requires the estimation of the reorganization energy $\\lambda$ and the standard free energy change $\\Delta G^0$ for an interfacial electron transfer process, based on synthetically generated data that mimics results from ab initio Molecular Dynamics (AIMD) simulations. The validation of the problem statement confirms that it is scientifically sound, well-posed, and objective, resting upon the established principles of Marcus theory for electron transfer under the linear-response and harmonic-solvent approximations.\n\nThe theoretical framework is defined by the free energy surfaces for the reduced ($R$) and oxidized ($O$) states of a redox couple, given as parabolas with identical curvature $\\kappa$:\n$$\nG_R(x) = \\frac{\\kappa}{2}(x - x_R)^2\n$$\n$$\nG_O(x) = \\frac{\\kappa}{2}(x - x_O)^2 + \\Delta G^0\n$$\nHere, $x$ represents a collective solvent coordinate, and $x_R$ and $x_O$ are the equilibrium solvent coordinates for the respective electronic states. The standard free energy change, $\\Delta G^0$, is the energy difference between the minima of the two surfaces: $\\Delta G^0 = G_O(x_O) - G_R(x_R)$. The reorganization energy, $\\lambda$, quantifies the energy required to distort the solvent from the equilibrium configuration of one state to that of the other, defined as:\n$$\n\\lambda = \\frac{\\kappa}{2}(x_O - x_R)^2\n$$\nThe central observable is the vertical energy gap, $\\Delta E(\\mathbf{q}) = U_O(\\mathbf{q}) - U_R(\\mathbf{q})$, where $U_R$ and $U_O$ are the Born-Oppenheimer potential energy surfaces as functions of all nuclear coordinates $\\mathbf{q}$. Within the harmonic approximation, fluctuations in $\\Delta E$ sampled from the canonical ensemble at temperature $T$ follow a Gaussian distribution.\n\nThe problem provides key relations for the ensemble means and variance of $\\Delta E$:\n$1$. The mean of $\\Delta E$ sampled in the reduced state ensemble (denoted by subscript $R$):\n$$\n\\langle \\Delta E \\rangle_R = \\lambda + \\Delta G^0\n$$\nThis corresponds to the average vertical energy difference when the system is in equilibrium with the reduced state. The average nuclear configuration is that which minimizes $G_R$, and the vertical transition energy from this configuration is, by definition of $\\lambda$ and $\\Delta G^0$ in this model, $\\lambda + \\Delta G^0$.\n\n$2$. The mean of $\\Delta E$ sampled in the oxidized state ensemble (denoted by subscript $O$):\n$$\n\\langle \\Delta E \\rangle_O = -\\lambda + \\Delta G^0\n$$\nThis corresponds to the average vertical energy difference when the system is in equilibrium with the oxidized state. The average configuration minimizes $G_O$, and the vertical transition energy to the reduced state surface is $-\\lambda$. The energy gap is thus $\\Delta G^0 - \\lambda$.\n\n$3$. The variance of $\\Delta E$ for both ensembles:\n$$\n\\mathrm{Var}(\\Delta E) = 2 k_B T \\lambda\n$$\nThis relation is a consequence of the fluctuation-dissipation theorem applied to the harmonic model, where the variance of the energy gap is proportional to thermal energy ($k_B T$) and the reorganization energy $\\lambda$, which itself is related to the system's response function (curvature $\\kappa$). The variance is identical for both ensembles due to the assumption of equal curvature for $G_R(x)$ and $G_O(x)$.\n\nThe task is to estimate $\\lambda$ and $\\Delta G^0$ from sample means of $\\Delta E$. The provided relations for the means form a system of two linear equations with two unknowns, $\\lambda$ and $\\Delta G^0$:\n$$\n\\begin{cases}\n\\langle \\Delta E \\rangle_R = \\lambda + \\Delta G^0 \\\\\n\\langle \\Delta E \\rangle_O = -\\lambda + \\Delta G^0\n\\end{cases}\n$$\nSolving this system yields the estimators. Subtracting the second equation from the first gives:\n$$\n\\langle \\Delta E \\rangle_R - \\langle \\Delta E \\rangle_O = (\\lambda + \\Delta G^0) - (-\\lambda + \\Delta G^0) = 2\\lambda\n$$\n$$\n\\implies \\lambda = \\frac{\\langle \\Delta E \\rangle_R - \\langle \\Delta E \\rangle_O}{2}\n$$\nAdding the two equations gives:\n$$\n\\langle \\Delta E \\rangle_R + \\langle \\Delta E \\rangle_O = (\\lambda + \\Delta G^0) + (-\\lambda + \\Delta G^0) = 2\\Delta G^0\n$$\n$$\n\\implies \\Delta G^0 = \\frac{\\langle \\Delta E \\rangle_R + \\langle \\Delta E \\rangle_O}{2}\n$$\nThe estimators for $\\lambda$ and $\\Delta G^0$, denoted by $\\hat{\\lambda}$ and $\\widehat{\\Delta G^0}$ respectively, are therefore obtained by replacing the true ensemble means with the calculated sample means from the generated data.\n\nThe algorithmic procedure will be as follows:\n$1$. For each test case specified by true parameters ($\\lambda_{\\mathrm{true}}$, $\\Delta G^0_{\\mathrm{true}}$), temperature ($T$), sample sizes ($N_R$, $N_O$), and a random seed, execute the following steps.\n$2$. Define the Boltzmann constant $k_B = 8.617333262 \\times 10^{-5}\\,\\mathrm{eV/K}$.\n$3$. Calculate the parameters for the two Gaussian distributions:\n    - Mean for the reduced ensemble: $\\mu_R = \\lambda_{\\mathrm{true}} + \\Delta G^0_{\\mathrm{true}}$.\n    - Mean for the oxidized ensemble: $\\mu_O = -\\lambda_{\\mathrm{true}} + \\Delta G^0_{\\mathrm{true}}$.\n    - Variance for both ensembles: $\\sigma^2 = 2 k_B T \\lambda_{\\mathrm{true}}$. The standard deviation is $\\sigma = \\sqrt{\\sigma^2}$.\n$4$. Initialize a random number generator with the specified seed to ensure reproducibility.\n$5$. Generate $N_R$ random samples for the reduced state from the normal distribution $\\mathcal{N}(\\mu_R, \\sigma^2)$.\n$6$. Generate $N_O$ random samples for the oxidized state from the normal distribution $\\mathcal{N}(\\mu_O, \\sigma^2)$.\n$7$. Compute the sample mean for each set of generated data: $\\overline{\\Delta E}_R$ and $\\overline{\\Delta E}_O$.\n$8$. Use the sample means to calculate the estimates $\\hat{\\lambda}$ and $\\widehat{\\Delta G^0}$ using the derived formulae:\n$$\n\\hat{\\lambda} = \\frac{\\overline{\\Delta E}_R - \\overline{\\Delta E}_O}{2}, \\quad \\widehat{\\Delta G^0} = \\frac{\\overline{\\Delta E}_R + \\overline{\\Delta E}_O}{2}\n$$\n$9$. As an internal consistency check, compute the pooled sample variance $\\widehat{\\mathrm{Var}}(\\Delta E)$ from the two samples. The correct formula for pooled variance assuming equal true variances is $\\widehat{\\mathrm{Var}}(\\Delta E) = \\frac{(N_R-1)s_R^2 + (N_O-1)s_O^2}{N_R+N_O-2}$, where $s_R^2$ and $s_O^2$ are the sample variances. Then, compute the variance-based estimate $\\hat{\\lambda}_{\\mathrm{var}} = \\frac{\\widehat{\\mathrm{Var}}(\\Delta E)}{2 k_B T}$. This value is not included in the final output.\n$10$. Collect the computed $[\\hat{\\lambda}, \\widehat{\\Delta G^0}]$ for each test case, formatted to six decimal places.\n$11$. Present the final results as a single string, representing a list of lists in the specified format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Generates synthetic AIMD-like samples of the vertical energy gap and\n    estimates the reorganization energy (lambda) and standard free energy\n    change (Delta G^0) for interfacial electron transfer.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case: (T in K, lambda_true in eV, delta_g0_true in eV, N_R, N_O, seed)\n    test_cases = [\n        (300.0, 0.200, -0.050, 2000, 2000, 42),\n        (298.0, 0.050, 0.000, 3000, 3000, 123),\n        (350.0, 0.005, 0.100, 5000, 5000, 999),\n    ]\n\n    # Boltzmann constant in eV/K\n    k_B = 8.617333262e-5\n\n    results = []\n    for case in test_cases:\n        T, lambda_true, delta_g0_true, N_R, N_O, seed = case\n\n        # Initialize random number generator for reproducibility\n        rng = np.random.default_rng(seed)\n\n        # 1. Set the ensemble means for the Gaussian distributions\n        mu_R = lambda_true + delta_g0_true\n        mu_O = -lambda_true + delta_g0_true\n\n        # 2. Set the standard deviation\n        # The variance is Var(DeltaE) = 2 * k_B * T * lambda\n        # Handle the edge case where lambda is zero to avoid numerical issues.\n        if lambda_true > 0:\n            variance = 2 * k_B * T * lambda_true\n            sigma = np.sqrt(variance)\n        else:\n            sigma = 0.0\n\n        # 3. Draw samples from the normal distributions\n        samples_R = rng.normal(loc=mu_R, scale=sigma, size=N_R)\n        samples_O = rng.normal(loc=mu_O, scale=sigma, size=N_O)\n\n        # 4. Calculate sample means\n        mean_R = np.mean(samples_R)\n        mean_O = np.mean(samples_O)\n\n        # 5. Estimate lambda and Delta G^0 using the mean-based relations\n        lambda_hat = (mean_R - mean_O) / 2\n        delta_g0_hat = (mean_R + mean_O) / 2\n\n        # 6. Internal consistency check (not for final output)\n        # Compute the pooled sample variance\n        if N_R + N_O > 2:\n            var_R = np.var(samples_R, ddof=1)\n            var_O = np.var(samples_O, ddof=1)\n            pooled_var = ((N_R - 1) * var_R + (N_O - 1) * var_O) / (N_R + N_O - 2)\n            \n            # Compute the variance-based estimate for lambda\n            if k_B * T > 0:\n                lambda_hat_var = pooled_var / (2 * k_B * T)\n            # This lambda_hat_var is calculated as required but not used in the output.\n\n        # 7. Store the results, rounded to six decimal places\n        results.append([round(lambda_hat, 6), round(delta_g0_hat, 6)])\n\n    # 8. Final print statement in the exact required format.\n    result_strings = [f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        }
    ]
}