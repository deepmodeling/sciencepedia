{
    "hands_on_practices": [
        {
            "introduction": "Macroscopic thermodynamic properties are essential for continuum models, particularly for predicting thermal behavior in batteries. This exercise demonstrates a fundamental principle of statistical mechanics: macroscopic response functions, like heat capacity, can be determined from microscopic fluctuations at equilibrium. By analyzing the energy fluctuations from a Molecular Dynamics (MD) simulation, you will calculate the constant-volume heat capacity, $C_V$, and then use a thermodynamic relation to find the constant-pressure heat capacity, $C_p$, providing a direct link from atomistic trajectories to continuum thermodynamics. ",
            "id": "3923605",
            "problem": "You are designing a computational pipeline to link atomistic Molecular Dynamics (MD) results to continuum thermodynamic parameters relevant for automated battery design and simulation. Starting from fundamental thermodynamic definitions and canonical ensemble results, you must implement a program that estimates the heat capacity at constant volume and at constant pressure for representative battery materials from MD energy time series.\n\nDefinitions to use:\n- The heat capacity at constant volume is defined as $C_V = \\left(\\frac{\\partial U}{\\partial T}\\right)_V$, where $U$ is internal energy and $T$ is temperature.\n- The heat capacity at constant pressure is defined as $C_p = \\left(\\frac{\\partial H}{\\partial T}\\right)_p$, where $H$ is enthalpy.\n- In the canonical ensemble, energy fluctuations relate to the constant-volume heat capacity via $C_V = \\frac{\\langle E^2\\rangle - \\langle E\\rangle^2}{k_B T^2}$, where $E$ is the system energy and $k_B$ is the Boltzmann constant. The angle brackets denote ensemble averages.\n\nTo map the atomistic estimate to a continuum molar quantity, let $N_{\\text{units}}$ be the number of formula units or molecules represented in the MD system, and let $N_A$ be the Avogadro constant. The number of moles is $n_{\\text{moles}} = \\frac{N_{\\text{units}}}{N_A}$, and the molar volume is $v_m = \\frac{V}{n_{\\text{moles}}}$ for system volume $V$. Then the molar heat capacities are\n- $c_{V,m} = \\frac{C_V}{n_{\\text{moles}}}$,\n- $c_{p,m} = c_{V,m} + \\frac{T \\alpha^2 v_m}{\\kappa_T}$,\nwhere $\\alpha$ is the volumetric thermal expansion coefficient and $\\kappa_T$ is the isothermal compressibility. The identity $C_p - C_V = \\frac{T \\alpha^2 V}{\\kappa_T}$ is a well-tested relation for condensed matter systems, and dividing by $n_{\\text{moles}}$ yields the molar form $c_{p,m} - c_{V,m} = \\frac{T \\alpha^2 v_m}{\\kappa_T}$.\n\nProgram requirements:\n- Implement a program that computes $c_{V,m}$ and $c_{p,m}$ for each test case specified below, using the canonical ensemble fluctuation estimator $C_V = \\frac{\\langle E^2\\rangle - \\langle E\\rangle^2}{k_B T^2}$ with sample averages computed as arithmetic means over the provided MD energy time series.\n- The MD energies are provided in electronvolts; convert energies to joules using the elementary charge $e = 1.602176634 \\times 10^{-19}$ coulombs. Use $k_B = 1.380649 \\times 10^{-23}$ joules per kelvin and $N_A = 6.02214076 \\times 10^{23}$ per mole.\n- Express both $c_{V,m}$ and $c_{p,m}$ in joules per mole per kelvin, rounded to six decimal places.\n- For numerical stability, if the computed variance $\\langle E^2\\rangle - \\langle E\\rangle^2$ is negative due to finite precision, clip it to $0$.\n\nTest suite:\n- Case A (Layered oxide, LiCoO$_2$-like):\n  - Energy time series in electronvolts: $[-100002.5, -100000.8, -99998.7, -100003.3, -99999.5, -100001.2, -99997.9, -100002.1, -100000.3, -99998.9, -100001.8, -99999.1]$\n  - Temperature in kelvin: $300$\n  - Number of units: $5000$\n  - Volume in cubic meters: $1.626\\times 10^{-25}$\n  - Thermal expansion coefficient in per kelvin: $1.5\\times 10^{-5}$\n  - Isothermal compressibility in per pascal: $1.6\\times 10^{-11}$\n\n- Case B (Graphite-like solid):\n  - Energy time series in electronvolts: $[-50001.2, -49999.9, -50000.3, -50002.1, -49998.5, -50000.7, -50001.5, -49999.0, -50000.0, -50001.0]$\n  - Temperature in kelvin: $300$\n  - Number of units: $10000$\n  - Volume in cubic meters: $8.798\\times 10^{-26}$\n  - Thermal expansion coefficient in per kelvin: $2.5\\times 10^{-6}$\n  - Isothermal compressibility in per pascal: $3.0\\times 10^{-11}$\n\n- Case C (Liquid electrolyte):\n  - Energy time series in electronvolts: $[-20010.3, -19995.7, -20005.1, -20000.2, -19990.8, -20012.4, -19998.6, -20007.9, -19993.3, -20001.6, -19997.2, -20009.8]$\n  - Temperature in kelvin: $300$\n  - Number of units: $2000$\n  - Volume in cubic meters: $3.321\\times 10^{-25}$\n  - Thermal expansion coefficient in per kelvin: $7.0\\times 10^{-4}$\n  - Isothermal compressibility in per pascal: $4.5\\times 10^{-10}$\n\n- Case D (Edge case: negligible energy fluctuation):\n  - Energy time series in electronvolts: $[-1000.0, -1000.0, -1000.0, -1000.0, -1000.0, -1000.0]$\n  - Temperature in kelvin: $300$\n  - Number of units: $1000$\n  - Volume in cubic meters: $4.980\\times 10^{-26}$\n  - Thermal expansion coefficient in per kelvin: $1.0\\times 10^{-5}$\n  - Isothermal compressibility in per pascal: $1.0\\times 10^{-11}$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output two floats in order: first $c_{V,m}$, then $c_{p,m}$, both in joules per mole per kelvin, rounded to six decimal places. The overall output should be a single list aggregating all cases in order A, B, C, D, for example, $[c_{V,m}^{(A)}, c_{p,m}^{(A)}, c_{V,m}^{(B)}, c_{p,m}^{(B)}, c_{V,m}^{(C)}, c_{p,m}^{(C)}, c_{V,m}^{(D)}, c_{p,m}^{(D)}]$.",
            "solution": "The problem requires the implementation of a computational method to determine the molar heat capacity at constant volume, $c_{V,m}$, and at constant pressure, $c_{p,m}$, from molecular dynamics (MD) simulation data. The theoretical foundation for this task lies in statistical mechanics and thermodynamics.\n\nThe heat capacity at constant volume, $C_V$, for a system in the canonical (NVT) ensemble is related to the fluctuations in its total energy, $E$. The specific formula provided is a cornerstone of statistical mechanics:\n$$C_V = \\frac{\\langle E^2\\rangle - \\langle E\\rangle^2}{k_B T^2} = \\frac{\\sigma_E^2}{k_B T^2}$$\nHere, $T$ is the absolute temperature of the system, $k_B$ is the Boltzmann constant ($1.380649 \\times 10^{-23}$ J/K), and the angle brackets $\\langle \\cdot \\rangle$ denote an ensemble average. The term $\\sigma_E^2 = \\langle E^2\\rangle - \\langle E\\rangle^2$ is the variance of the energy. In a computational setting where we have a time series of energy values $\\{E_1, E_2, \\dots, E_N\\}$ from an MD simulation, the ensemble averages are estimated by sample averages (arithmetic means):\n$$\\langle E \\rangle \\approx \\bar{E} = \\frac{1}{N} \\sum_{i=1}^{N} E_i$$\n$$\\langle E^2 \\rangle \\approx \\overline{E^2} = \\frac{1}{N} \\sum_{i=1}^{N} E_i^2$$\nThe energies provided in the problem are in units of electronvolts (eV) and must be converted to joules (J), the standard unit of energy in the International System of Units (SI), for consistency with the units of $k_B$. This conversion is done using the elementary charge, $e = 1.602176634 \\times 10^{-19}$ C, where $1$ eV equals $1.602176634 \\times 10^{-19}$ J. Due to finite precision arithmetic, the computed variance $\\overline{E^2} - \\bar{E}^2$ could be slightly negative; the problem specifies to clip such values to $0$.\n\nOnce $C_V$ (in J/K) is calculated for the entire simulation cell, it must be converted to an intensive molar quantity, $c_{V,m}$ (in J/(mol·K)). This is accomplished by dividing by the number of moles, $n_{\\text{moles}}$, present in the simulation. The number of moles is calculated from the number of formula units or molecules, $N_{\\text{units}}$, and the Avogadro constant, $N_A = 6.02214076 \\times 10^{23}$ mol$^{-1}$:\n$$n_{\\text{moles}} = \\frac{N_{\\text{units}}}{N_A}$$\nThus, the molar heat capacity at constant volume is:\n$$c_{V,m} = \\frac{C_V}{n_{\\text{moles}}}$$\nTo find the molar heat capacity at constant pressure, $c_{p,m}$, we use the provided thermodynamic identity, which is valid for condensed matter systems:\n$$c_{p,m} = c_{V,m} + \\frac{T \\alpha^2 v_m}{\\kappa_T}$$\nThis relation requires the volumetric thermal expansion coefficient, $\\alpha$, the isothermal compressibility, $\\kappa_T$, and the molar volume, $v_m$. The molar volume is the system volume, $V$, divided by the number of moles:\n$$v_m = \\frac{V}{n_{\\text{moles}}}$$\nCombining these steps, the complete algorithm for each test case is as follows:\n\n1.  Take the energy time series $E_i^{\\text{eV}}$ and convert each value to joules: $E_i^{\\text{J}} = E_i^{\\text{eV}} \\times e$.\n2.  Compute the mean energy $\\bar{E} = \\frac{1}{N} \\sum E_i^{\\text{J}}$ and the mean squared energy $\\overline{E^2} = \\frac{1}{N} \\sum (E_i^{\\text{J}})^2$.\n3.  Calculate the energy variance $\\sigma_E^2 = \\overline{E^2} - \\bar{E}^2$. If $\\sigma_E^2  0$, set $\\sigma_E^2 = 0$.\n4.  Compute the system's heat capacity at constant volume: $C_V = \\frac{\\sigma_E^2}{k_B T^2}$.\n5.  Determine the number of moles in the system: $n_{\\text{moles}} = N_{\\text{units}} / N_A$.\n6.  Calculate the molar heat capacity at constant volume: $c_{V,m} = \\frac{C_V}{n_{\\text{moles}}}$.\n7.  Calculate the molar volume: $v_m = \\frac{V}{n_{\\text{moles}}}$.\n8.  Calculate the correction term to find the heat capacity at constant pressure: $\\Delta c_m = \\frac{T \\alpha^2 v_m}{\\kappa_T}$.\n9.  Compute the molar heat capacity at constant pressure: $c_{p,m} = c_{V,m} + \\Delta c_m$.\n10. Round both $c_{V,m}$ and $c_{p,m}$ to six decimal places as required.\n\nThis procedure is systematically applied to the data provided for each of the four test cases. Case D, with constant energy values, represents a scenario with zero energy fluctuation, leading to $\\sigma_E^2 = 0$ and consequently $c_{V,m} = 0$. However, $c_{p,m}$ will be non-zero as the correction term $\\Delta c_m$ is generally positive.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the molar heat capacity at constant volume (c_V,m) and\n    constant pressure (c_p,m) from molecular dynamics energy time series data.\n    \"\"\"\n    \n    # Define physical constants as per the problem statement.\n    e = 1.602176634e-19  # Elementary charge in Coulombs (J/eV)\n    k_B = 1.380649e-23     # Boltzmann constant in J/K\n    N_A = 6.02214076e23    # Avogadro constant in 1/mol\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A (Layered oxide)\",\n            \"energies_eV\": [-100002.5, -100000.8, -99998.7, -100003.3, -99999.5, -100001.2, -99997.9, -100002.1, -100000.3, -99998.9, -100001.8, -99999.1],\n            \"T_K\": 300,\n            \"N_units\": 5000,\n            \"V_m3\": 1.626e-25,\n            \"alpha_per_K\": 1.5e-5,\n            \"kappa_T_per_Pa\": 1.6e-11,\n        },\n        {\n            \"name\": \"Case B (Graphite-like solid)\",\n            \"energies_eV\": [-50001.2, -49999.9, -50000.3, -50002.1, -49998.5, -50000.7, -50001.5, -49999.0, -50000.0, -50001.0],\n            \"T_K\": 300,\n            \"N_units\": 10000,\n            \"V_m3\": 8.798e-26,\n            \"alpha_per_K\": 2.5e-6,\n            \"kappa_T_per_Pa\": 3.0e-11,\n        },\n        {\n            \"name\": \"Case C (Liquid electrolyte)\",\n            \"energies_eV\": [-20010.3, -19995.7, -20005.1, -20000.2, -19990.8, -20012.4, -19998.6, -20007.9, -19993.3, -20001.6, -19997.2, -20009.8],\n            \"T_K\": 300,\n            \"N_units\": 2000,\n            \"V_m3\": 3.321e-25,\n            \"alpha_per_K\": 7.0e-4,\n            \"kappa_T_per_Pa\": 4.5e-10,\n        },\n         {\n            \"name\": \"Case D (Edge case: negligible energy fluctuation)\",\n            \"energies_eV\": [-1000.0, -1000.0, -1000.0, -1000.0, -1000.0, -1000.0],\n            \"T_K\": 300,\n            \"N_units\": 1000,\n            \"V_m3\": 4.980e-26,\n            \"alpha_per_K\": 1.0e-5,\n            \"kappa_T_per_Pa\": 1.0e-11,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract parameters for the current case\n        energies_eV = np.array(case[\"energies_eV\"])\n        T = case[\"T_K\"]\n        N_units = case[\"N_units\"]\n        V = case[\"V_m3\"]\n        alpha = case[\"alpha_per_K\"]\n        kappa_T = case[\"kappa_T_per_Pa\"]\n\n        # 1. Convert energies from eV to Joules\n        energies_J = energies_eV * e\n\n        # 2. Compute mean energy and mean squared energy\n        mean_E = np.mean(energies_J)\n        mean_E2 = np.mean(energies_J**2)\n\n        # 3. Calculate energy variance and clip if negative\n        var_E = mean_E2 - mean_E**2\n        if var_E  0:\n            var_E = 0.0\n        \n        # 4. Compute heat capacity at constant volume (for the simulation cell)\n        C_V = var_E / (k_B * T**2)\n\n        # 5. Calculate number of moles\n        n_moles = N_units / N_A\n        \n        # 6. Calculate molar heat capacity at constant volume\n        # Handle division by zero if n_moles is zero (not expected with given inputs)\n        c_Vm = C_V / n_moles if n_moles  0 else 0.0\n\n        # 7. Calculate molar volume\n        v_m = V / n_moles if n_moles  0 else 0.0\n        \n        # 8. Calculate the difference between c_p,m and c_V,m\n        cp_cv_diff = (T * alpha**2 * v_m) / kappa_T\n\n        # 9. Compute molar heat capacity at constant pressure\n        c_pm = c_Vm + cp_cv_diff\n        \n        # 10. Round results to six decimal places and append to the list\n        results.append(round(c_Vm, 6))\n        results.append(round(c_pm, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Building upon equilibrium properties, we now explore how atomistic simulations inform transport phenomena, which are critical for battery performance. In concentrated systems like battery electrodes, diffusion is driven by gradients in chemical potential, not just concentration, a non-ideality captured by the thermodynamic factor, $\\Theta$. This practice guides you through calculating the chemical potential, $\\mu(c)$, from atomistic data and using its concentration dependence to compute the chemical diffusion coefficient, $D_{\\text{chem}}$, a vital input for continuum transport models. ",
            "id": "3923615",
            "problem": "You are given a task that bridges atomistic simulation outputs to continuum-scale transport parameters for a lithium intercalation host in a battery electrode. Let the intercalant fraction be denoted by $c$, defined as the fraction of available lattice sites occupied, where $c \\in (0,1)$. The temperature is denoted by $T$ and is measured in $\\mathrm{K}$ (Kelvin). The Boltzmann constant $k_{\\mathrm{B}}$ is $1.380649 \\times 10^{-23}$ in $\\mathrm{J/K}$ (Joules per Kelvin). The Molecular Dynamics (MD) outputs consist either of Widom insertion energy samples or thermodynamic integration derivatives.\n\nFundamental base:\n- The excess chemical potential $\\mu_{\\mathrm{ex}}(c)$ obtained by the Widom insertion method is given by\n$$\n\\mu_{\\mathrm{ex}}(c) = -k_{\\mathrm{B}} T \\ln \\left\\langle \\exp\\left( -\\frac{\\Delta U}{k_{\\mathrm{B}} T} \\right) \\right\\rangle,\n$$\nwhere $\\Delta U$ is the insertion energy change and $\\langle \\cdot \\rangle$ is an ensemble average over independent insertions.\n- In thermodynamic integration, one has access to $\\frac{\\partial \\mu_{\\mathrm{ex}}}{\\partial c}$, from which $\\mu_{\\mathrm{ex}}(c)$ is obtained by numerical integration given a reference value at a known $c$, e.g., using the trapezoidal rule.\n- The ideal lattice mixing contribution to the chemical potential is\n$$\n\\mu_{\\mathrm{id}}(c) = k_{\\mathrm{B}} T \\ln \\left(\\frac{c}{1-c}\\right).\n$$\n- The thermodynamic factor $\\Theta(c)$ relating tracer diffusion to chemical diffusion in concentrated solution theory is\n$$\n\\Theta(c) = \\frac{1}{1-c} + \\frac{c}{k_{\\mathrm{B}} T} \\frac{\\partial \\mu_{\\mathrm{ex}}(c)}{\\partial c}.\n$$\n- The chemical diffusion coefficient is given by\n$$\nD_{\\mathrm{chem}}(c) = \\Theta(c)\\, D_{\\mathrm{tr}},\n$$\nwhere $D_{\\mathrm{tr}}$ is the tracer diffusion coefficient.\n\nYour program must:\n- For each test case, compute $\\mu_{\\mathrm{ex}}(c)$ from the provided atomistic data (Widom insertion energies or thermodynamic integration derivatives).\n- Compute $\\Theta(c)$ via the formula above.\n- Compute $D_{\\mathrm{chem}}(c) = \\Theta(c)\\, D_{\\mathrm{tr}}$.\n- Produce a single line of output containing the values $D_{\\mathrm{chem}}(c)$ for all concentrations across all test cases, as a comma-separated list enclosed in square brackets. All values must be in $\\mathrm{m^2/s}$ (square meters per second) and expressed as standard floating-point numbers. The list must be ordered exactly as specified in the test suite below.\n\nNumerical guidance:\n- When using Widom insertion samples, compute $\\mu_{\\mathrm{ex}}(c)$ using the ensemble average of $\\exp(-\\Delta U/k_{\\mathrm{B}} T)$ over the provided samples for that $c$.\n- Compute $\\frac{\\partial \\mu_{\\mathrm{ex}}}{\\partial c}$ by finite differences over the provided $c$ grid. Use a central difference for interior points and one-sided differences for endpoints.\n- When using thermodynamic integration, compute $\\mu_{\\mathrm{ex}}(c)$ via numerical integration starting from the provided reference $\\mu_{\\mathrm{ex}}(c_0)$ using the trapezoidal rule over the $c$ grid, and use the provided $\\frac{\\partial \\mu_{\\mathrm{ex}}}{\\partial c}$ values directly for $\\Theta(c)$.\n\nPhysical units:\n- All insertion energies $\\Delta U$ are provided in $\\mathrm{J}$ (Joules).\n- All temperatures $T$ are provided in $\\mathrm{K}$ (Kelvin).\n- All tracer diffusion coefficients $D_{\\mathrm{tr}}$ are provided in $\\mathrm{m^2/s}$ (square meters per second).\n- Output $D_{\\mathrm{chem}}(c)$ in $\\mathrm{m^2/s}$ (square meters per second).\n\nTest suite:\n- Case $1$ (Widom insertion, moderate occupancy):\n  - $T = 300$.\n  - $D_{\\mathrm{tr}} = 1.0 \\times 10^{-10}$.\n  - Concentrations $c$: $[0.05, 0.10, 0.20]$.\n  - For $c = 0.05$, $\\Delta U$ samples (in $\\mathrm{J}$): $[-8.01 \\times 10^{-21}, -6.00 \\times 10^{-21}, -7.20 \\times 10^{-21}, -7.80 \\times 10^{-21}, -6.40 \\times 10^{-21}, -8.50 \\times 10^{-21}, -5.50 \\times 10^{-21}, -7.00 \\times 10^{-21}, -6.90 \\times 10^{-21}, -7.30 \\times 10^{-21}]$.\n  - For $c = 0.10$, $\\Delta U$ samples (in $\\mathrm{J}$): $[-5.00 \\times 10^{-21}, -4.00 \\times 10^{-21}, -4.50 \\times 10^{-21}, -3.80 \\times 10^{-21}, -4.20 \\times 10^{-21}, -5.20 \\times 10^{-21}, -3.60 \\times 10^{-21}, -4.70 \\times 10^{-21}, -4.10 \\times 10^{-21}, -4.90 \\times 10^{-21}]$.\n  - For $c = 0.20$, $\\Delta U$ samples (in $\\mathrm{J}$): $[-2.00 \\times 10^{-21}, -1.00 \\times 10^{-21}, -1.50 \\times 10^{-21}, -0.80 \\times 10^{-21}, -1.20 \\times 10^{-21}, -2.20 \\times 10^{-21}, -0.60 \\times 10^{-21}, -1.70 \\times 10^{-21}, -1.10 \\times 10^{-21}, -1.90 \\times 10^{-21}]$.\n- Case $2$ (Thermodynamic integration, broader occupancy):\n  - $T = 310$.\n  - $D_{\\mathrm{tr}} = 1.5 \\times 10^{-10}$.\n  - Concentrations $c$: $[0.05, 0.15, 0.30, 0.50]$.\n  - Provided derivatives $\\frac{\\partial \\mu_{\\mathrm{ex}}}{\\partial c}$ (in $\\mathrm{J}$): $[8.0 \\times 10^{-21}, 1.2 \\times 10^{-20}, 2.0 \\times 10^{-20}, 3.5 \\times 10^{-20}]$ corresponding to each $c$.\n  - Reference excess chemical potential: $\\mu_{\\mathrm{ex}}(c_0 = 0.05) = -6.0 \\times 10^{-21}$ (in $\\mathrm{J}$).\n- Case $3$ (Widom insertion, high occupancy edge behavior):\n  - $T = 300$.\n  - $D_{\\mathrm{tr}} = 8.0 \\times 10^{-11}$.\n  - Concentrations $c$: $[0.80, 0.90, 0.95]$.\n  - For $c = 0.80$, $\\Delta U$ samples (in $\\mathrm{J}$): $[1.00 \\times 10^{-21}, 1.20 \\times 10^{-21}, 0.80 \\times 10^{-21}, 1.10 \\times 10^{-21}, 0.90 \\times 10^{-21}, 1.30 \\times 10^{-21}, 0.70 \\times 10^{-21}, 1.00 \\times 10^{-21}, 0.95 \\times 10^{-21}, 1.05 \\times 10^{-21}]$.\n  - For $c = 0.90$, $\\Delta U$ samples (in $\\mathrm{J}$): $[1.80 \\times 10^{-21}, 2.20 \\times 10^{-21}, 1.60 \\times 10^{-21}, 2.00 \\times 10^{-21}, 1.70 \\times 10^{-21}, 2.40 \\times 10^{-21}, 1.50 \\times 10^{-21}, 1.90 \\times 10^{-21}, 1.85 \\times 10^{-21}, 2.10 \\times 10^{-21}]$.\n  - For $c = 0.95$, $\\Delta U$ samples (in $\\mathrm{J}$): $[2.50 \\times 10^{-21}, 2.70 \\times 10^{-21}, 2.30 \\times 10^{-21}, 2.60 \\times 10^{-21}, 2.40 \\times 10^{-21}, 2.80 \\times 10^{-21}, 2.20 \\times 10^{-21}, 2.55 \\times 10^{-21}, 2.45 \\times 10^{-21}, 2.65 \\times 10^{-21}]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with all $ D_{\\mathrm{chem}}(c) $ values for Case $1$ in the order of $c$, followed by Case $2$ in the order of $c$, followed by Case $3$ in the order of $c$:\n$$\n[\\;D_{\\mathrm{chem}}(c_{1,1}),\\, D_{\\mathrm{chem}}(c_{1,2}),\\, D_{\\mathrm{chem}}(c_{1,3}),\\, D_{\\mathrm{chem}}(c_{2,1}),\\, D_{\\mathrm{chem}}(c_{2,2}),\\, D_{\\mathrm{chem}}(c_{2,3}),\\, D_{\\mathrm{chem}}(c_{2,4}),\\, D_{\\mathrm{chem}}(c_{3,1}),\\, D_{\\mathrm{chem}}(c_{3,2}),\\, D_{\\mathrm{chem}}(c_{3,3})\\;].\n$$\nAll values must be in $\\mathrm{m^2/s}$.",
            "solution": "This problem requires the calculation of the chemical diffusion coefficient, $D_{\\text{chem}}(c)$, from atomistic simulation data. The approach bridges microscopic information to a macroscopic transport property via the thermodynamic factor, $\\Theta(c)$. The chemical diffusivity is given by $D_{\\text{chem}}(c) = \\Theta(c) \\, D_{\\text{tr}}$, where $D_{\\text{tr}}$ is the tracer diffusivity. The thermodynamic factor itself is calculated as:\n$$\n\\Theta(c) = \\frac{1}{1-c} + \\frac{c}{k_{\\mathrm{B}} T} \\frac{\\partial \\mu_{\\mathrm{ex}}(c)}{\\partial c}\n$$\nThe primary task is to find the derivative of the excess chemical potential, $\\frac{\\partial \\mu_{\\mathrm{ex}}(c)}{\\partial c}$, using the methods specified for each case (Widom insertion or thermodynamic integration), and then combine the results to find $D_{\\text{chem}}(c)$. The solution for each case proceeds as follows.\n\n**Case 1: Widom Insertion (moderate occupancy)**\nFor this case, we first calculate the excess chemical potential, $\\mu_{\\mathrm{ex}}(c)$, at each concentration $c=[0.05, 0.10, 0.20]$ using the provided Widom insertion energy samples, $\\Delta U$, and the formula:\n$$ \\mu_{\\mathrm{ex}}(c) = -k_{\\mathrm{B}} T \\ln \\left\\langle \\exp\\left( -\\frac{\\Delta U}{k_{\\mathrm{B}} T} \\right) \\right\\rangle $$\nNext, we compute the derivative $\\frac{\\partial \\mu_{\\mathrm{ex}}}{\\partial c}$ at each concentration point using finite differences on the grid of $c$. A forward difference is used for the first point ($c=0.05$), a central difference for the interior point ($c=0.10$), and a backward difference for the last point ($c=0.20$). With these derivatives, we calculate $\\Theta(c)$ and then $D_{\\mathrm{chem}}(c)$ for each concentration.\n\n**Case 2: Thermodynamic Integration (broader occupancy)**\nIn this case, the values of $\\frac{\\partial \\mu_{\\mathrm{ex}}}{\\partial c}$ are provided directly for each concentration $c=[0.05, 0.15, 0.30, 0.50]$. This simplifies the procedure, as we can directly substitute these values into the formula for the thermodynamic factor $\\Theta(c)$ and subsequently calculate the chemical diffusion coefficient $D_{\\mathrm{chem}}(c)$. The instruction to compute $\\mu_{\\mathrm{ex}}(c)$ via integration is noted, but it is not necessary for this specific calculation.\n\n**Case 3: Widom Insertion (high occupancy edge behavior)**\nThe procedure for this case is identical to Case 1. We first compute $\\mu_{\\mathrm{ex}}(c)$ from the $\\Delta U$ samples provided for the high-occupancy concentrations $c = [0.80, 0.90, 0.95]$. We then use finite differences to find the derivative $\\frac{\\partial \\mu_{\\mathrm{ex}}}{\\partial c}$ at each point. Finally, we calculate the thermodynamic factor $\\Theta(c)$ and the chemical diffusion coefficient $D_{\\mathrm{chem}}(c)$.\n\nBy executing these steps for all three cases, we obtain a list of $D_{\\text{chem}}(c)$ values, which are then formatted as requested for the final output.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of computing chemical diffusion coefficients from atomistic data.\n    \"\"\"\n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    def calculate_gradient(y, x):\n        \"\"\"\n        Computes the gradient of y with respect to x using finite differences.\n        Uses forward/backward differences at the endpoints and central differences\n        for the interior points. This handles non-uniformly spaced grids.\n        \"\"\"\n        n = len(x)\n        if n  2:\n            raise ValueError(\"Need at least two points to compute a gradient.\")\n        \n        dydx = np.zeros(n)\n        \n        # Forward difference for the first point\n        dydx[0] = (y[1] - y[0]) / (x[1] - x[0])\n        \n        # Central difference for interior points\n        for i in range(1, n - 1):\n            dydx[i] = (y[i+1] - y[i-1]) / (x[i+1] - x[i-1])\n            \n        # Backward difference for the last point\n        if n  1:\n            dydx[n-1] = (y[n-1] - y[n-2]) / (x[n-1] - x[n-2])\n            \n        return dydx\n\n    def solve_widom_case(T, D_tr, c_values, dU_samples_map):\n        \"\"\"\n        Processes a test case based on Widom insertion data.\n        \"\"\"\n        kBT = k_B * T\n        mu_ex_values = []\n        \n        for c in c_values:\n            dU_samples = np.array(dU_samples_map[c])\n            exp_term_avg = np.mean(np.exp(-dU_samples / kBT))\n            mu_ex = -kBT * np.log(exp_term_avg)\n            mu_ex_values.append(mu_ex)\n        \n        mu_ex_values = np.array(mu_ex_values)\n        dmu_dc_values = calculate_gradient(mu_ex_values, c_values)\n        \n        D_chem_values = []\n        for i, c in enumerate(c_values):\n            dmu_dc = dmu_dc_values[i]\n            # Thermodynamic factor Theta(c)\n            Theta = 1.0 / (1.0 - c) + (c / kBT) * dmu_dc\n            D_chem = Theta * D_tr\n            D_chem_values.append(D_chem)\n            \n        return D_chem_values\n\n    def solve_ti_case(T, D_tr, c_values, dmu_dc_values):\n        \"\"\"\n        Processes a test case based on Thermodynamic Integration data.\n        \"\"\"\n        kBT = k_B * T\n        D_chem_values = []\n        \n        for i, c in enumerate(c_values):\n            dmu_dc = dmu_dc_values[i]\n            # Thermodynamic factor Theta(c)\n            Theta = 1.0 / (1.0 - c) + (c / kBT) * dmu_dc\n            D_chem = Theta * D_tr\n            D_chem_values.append(D_chem)\n            \n        return D_chem_values\n\n    # Overall results list\n    all_results = []\n    \n    # === Case 1 ===\n    T1 = 300.0\n    D_tr1 = 1.0e-10\n    c1 = np.array([0.05, 0.10, 0.20])\n    dU1_map = {\n        0.05: np.array([-8.01e-21, -6.00e-21, -7.20e-21, -7.80e-21, -6.40e-21, -8.50e-21, -5.50e-21, -7.00e-21, -6.90e-21, -7.30e-21]),\n        0.10: np.array([-5.00e-21, -4.00e-21, -4.50e-21, -3.80e-21, -4.20e-21, -5.20e-21, -3.60e-21, -4.70e-21, -4.10e-21, -4.90e-21]),\n        0.20: np.array([-2.00e-21, -1.00e-21, -1.50e-21, -0.80e-21, -1.20e-21, -2.20e-21, -0.60e-21, -1.70e-21, -1.10e-21, -1.90e-21])\n    }\n    results1 = solve_widom_case(T1, D_tr1, c1, dU1_map)\n    all_results.extend(results1)\n\n    # === Case 2 ===\n    T2 = 310.0\n    D_tr2 = 1.5e-10\n    c2 = np.array([0.05, 0.15, 0.30, 0.50])\n    dmu_dc2 = np.array([8.0e-21, 1.2e-20, 2.0e-20, 3.5e-20])\n    results2 = solve_ti_case(T2, D_tr2, c2, dmu_dc2)\n    all_results.extend(results2)\n\n    # === Case 3 ===\n    T3 = 300.0\n    D_tr3 = 8.0e-11\n    c3 = np.array([0.80, 0.90, 0.95])\n    dU3_map = {\n        0.80: np.array([1.00e-21, 1.20e-21, 0.80e-21, 1.10e-21, 0.90e-21, 1.30e-21, 0.70e-21, 1.00e-21, 0.95e-21, 1.05e-21]),\n        0.90: np.array([1.80e-21, 2.20e-21, 1.60e-21, 2.00e-21, 1.70e-21, 2.40e-21, 1.50e-21, 1.90e-21, 1.85e-21, 2.10e-21]),\n        0.95: np.array([2.50e-21, 2.70e-21, 2.30e-21, 2.60e-21, 2.40e-21, 2.80e-21, 2.20e-21, 2.55e-21, 2.45e-21, 2.65e-21])\n    }\n    results3 = solve_widom_case(T3, D_tr3, c3, dU3_map)\n    all_results.extend(results3)\n    \n    # Print final output in the required format\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This advanced exercise provides profound insight by connecting the shape of the atomistic free energy landscape of a charge-transfer reaction to the continuum Butler-Volmer symmetry factor, $\\alpha$. This phenomenological parameter has a deep physical meaning, reflecting how much the reaction's transition state resembles the products in terms of charge configuration. By deriving and calculating $\\alpha$ from a model of the atomistic reaction coordinate, you will uncover the physical origin of this crucial electrochemical kinetic parameter. ",
            "id": "3923623",
            "problem": "Consider a single-electron transfer step at a battery electrode where the microscopic reaction proceeds along a scalar atomistic reaction coordinate $s$. At zero applied overpotential $\\eta=0$, the intrinsic atomistic free energy landscape along $s$ is a symmetric double-well modeled by\n$$\nG_{0}(s) = E_{b} + A\\left(s^{2} - s_{m}^{2}\\right)^{2},\n$$\nwith constants $E_{b} > 0$, $A > 0$, and $s_{m} > 0$. The initial state corresponds to the left minimum near $s \\approx -s_{m}$, the final state to the right minimum near $s \\approx s_{m}$, and the saddle point (transition state) lies at $s=0$. When a small overpotential $\\eta$ is applied, the free energy landscape is modified by the electrostatic work associated with the progression of charge transfer along $s$, producing\n$$\nG(s;\\eta) = G_{0}(s) - F\\,\\eta\\, q(s),\n$$\nwhere $F$ is the Faraday constant and $q(s)$ denotes the fraction of the electron transferred at coordinate $s$, assumed to be a monotonically increasing map from the initial state ($q \\approx 0$) to the final state ($q \\approx 1$). In atomistic simulations of this step, the fractional charge along the path is well approximated by the logistic function\n$$\nq(s) = \\frac{1}{1 + \\exp\\!\\big(-\\lambda\\,(s - s_{q})\\big)},\n$$\nwith parameters $\\lambda = 5$ and $s_{q} = 0.2$ (in consistent internal units for $s$). \n\nStarting from transition state theory (TST), which states that the rate constant depends on the free energy barrier via $k(\\eta) \\propto \\exp\\!\\big(-\\Delta G^{\\ddagger}(\\eta)/(k_{B}T)\\big)$, and the above energetic description of how an overpotential modifies the atomistic free energy, derive the expression for how the barrier $\\Delta G^{\\ddagger}(\\eta)$ depends on $\\eta$ in the linear response near $\\eta=0$. Use this to identify the symmetry factor $\\alpha$ that links atomistic results to the continuum Butler–Volmer description, and estimate its value from the given $q(s)$. Then, provide a principled justification for why $\\alpha$ must lie within the closed interval $[0,1]$ under the stated physical assumptions.\n\nCompute the numerical value of $\\alpha$ implied by the given $q(s)$ and the baseline $G_{0}(s)$, and express your final answer as a dimensionless number rounded to four significant figures.",
            "solution": "The central task is to derive the electrochemical symmetry factor, $\\alpha$, from the provided atomistic free energy model. The symmetry factor is a key parameter in the Butler-Volmer equation, which describes the dependence of the electrochemical reaction rate on the applied overpotential, $\\eta$.\n\nAccording to transition state theory (TST), the rate constant $k$ is proportional to an exponential function of the activation free energy barrier, $\\Delta G^{\\ddagger}$:\n$$\nk(\\eta) \\propto \\exp\\left(-\\frac{\\Delta G^{\\ddagger}(\\eta)}{k_{B}T}\\right)\n$$\nThe Butler-Volmer formulation for the forward reaction posits a linear relationship between the activation barrier and the overpotential for small $\\eta$:\n$$\n\\Delta G^{\\ddagger}(\\eta) \\approx \\Delta G^{\\ddagger}(0) - \\alpha F \\eta\n$$\nHere, $\\alpha$ is the symmetry factor (or more precisely, the anodic transfer coefficient), and $F$ is the Faraday constant. From this relationship, we can define $\\alpha$ via the derivative of the activation barrier with respect to the overpotential, evaluated at equilibrium ($\\eta=0$):\n$$\n\\alpha = -\\frac{1}{F} \\left. \\frac{d\\Delta G^{\\ddagger}(\\eta)}{d\\eta} \\right|_{\\eta=0}\n$$\nThe activation barrier $\\Delta G^{\\ddagger}(\\eta)$ is the difference between the free energy at the transition state (saddle point) $s_{TS}(\\eta)$ and the free energy at the initial reactant state $s_{R}(\\eta)$:\n$$\n\\Delta G^{\\ddagger}(\\eta) = G(s_{TS}(\\eta), \\eta) - G(s_{R}(\\eta), \\eta)\n$$\nTo find the derivative of $\\Delta G^{\\ddagger}$ with respect to $\\eta$, we apply the chain rule:\n$$\n\\frac{d\\Delta G^{\\ddagger}}{d\\eta} = \\left[ \\frac{\\partial G}{\\partial s}\\bigg|_{s_{TS}} \\frac{ds_{TS}}{d\\eta} + \\frac{\\partial G}{\\partial \\eta}\\bigg|_{s_{TS}} \\right] - \\left[ \\frac{\\partial G}{\\partial s}\\bigg|_{s_{R}} \\frac{ds_{R}}{d\\eta} + \\frac{\\partial G}{\\partial \\eta}\\bigg|_{s_{R}} \\right]\n$$\nBy definition, the transition state and the reactant state are stationary points on the free energy surface, meaning the first partial derivative of $G$ with respect to the reaction coordinate $s$ is zero at these points:\n$$\n\\frac{\\partial G}{\\partial s}\\bigg|_{s_{TS}} = 0 \\quad \\text{and} \\quad \\frac{\\partial G}{\\partial s}\\bigg|_{s_{R}} = 0\n$$\nThis is an application of the Hellmann-Feynman theorem. The expression for the derivative of the barrier simplifies considerably:\n$$\n\\frac{d\\Delta G^{\\ddagger}}{d\\eta} = \\frac{\\partial G}{\\partial \\eta}\\bigg|_{s_{TS}(\\eta)} - \\frac{\\partial G}{\\partial \\eta}\\bigg|_{s_{R}(\\eta)}\n$$\nThe free energy $G(s; \\eta)$ is given as $G(s;\\eta) = G_{0}(s) - F\\,\\eta\\, q(s)$. The partial derivative with respect to $\\eta$ is:\n$$\n\\frac{\\partial G}{\\partial \\eta} = -F\\,q(s)\n$$\nSubstituting this into the expression for the barrier's derivative, we get:\n$$\n\\frac{d\\Delta G^{\\ddagger}}{d\\eta} = -F\\,q\\big(s_{TS}(\\eta)\\big) - \\Big(-F\\,q\\big(s_{R}(\\eta)\\big)\\Big) = -F \\left[ q\\big(s_{TS}(\\eta)\\big) - q\\big(s_{R}(\\eta)\\big) \\right]\n$$\nWe need to evaluate this expression at $\\eta=0$. At zero overpotential, the positions of the transition state and the reactant minimum are determined by the intrinsic landscape $G_0(s)$. The problem states that for $G_0(s)$, the transition state is at $s=0$ and the initial state minimum is near $s \\approx -s_m$. Thus, $s_{TS}(0) = 0$ and $s_{R}(0) = -s_m$.\n$$\n\\left. \\frac{d\\Delta G^{\\ddagger}}{d\\eta} \\right|_{\\eta=0} = -F \\left[ q(0) - q(-s_m) \\right]\n$$\nNow we substitute this back into the definition of $\\alpha$:\n$$\n\\alpha = -\\frac{1}{F} \\left( -F \\left[ q(0) - q(-s_m) \\right] \\right) = q(0) - q(-s_m)\n$$\nThe problem states that the initial state, located at $s \\approx -s_m$, corresponds to a fractional charge transfer of $q \\approx 0$. This is a physical boundary condition on the model, implying that we should take $q(-s_m) = 0$ as the reference for charge transfer. This is a reasonable assumption, as the reactant well is typically located in a region where the charge transfer coordinate has its asymptotic initial-state value. Under this assumption, the expression for the symmetry factor simplifies to:\n$$\n\\alpha = q(s_{TS}(0)) = q(0)\n$$\nThis result provides a clear physical interpretation: the symmetry factor $\\alpha$ is the fraction of total charge that has been transferred at the transition state of the reaction at equilibrium.\n\nNext, we provide a principled justification for why $\\alpha$ must lie in the closed interval $[0,1]$.\n1.  The function $q(s)$ is defined as the \"fraction of the electron transferred\" at a given point $s$ along the atomistic reaction coordinate. By its definition as a fraction, its value must be bounded between $0$ and $1$.\n2.  The problem states that $q(s)$ is a monotonically increasing map from the initial state (where $q \\approx 0$) to the final state (where $q \\approx 1$).\n3.  The transition state, at $s_{TS}(0)=0$, lies geometrically between the initial state (at $s_R(0)=-s_m  0$) and the final state (at $s_P(0)=s_m  0$).\n4.  Since $q(s)$ is monotonic, its value at the intermediate point $s=0$ must lie between its values at the initial and final states. That is, $q(-s_m) \\le q(0) \\le q(s_m)$.\n5.  Given the physical boundary conditions $q(-s_m) \\approx 0$ and $q(s_m) \\approx 1$, it follows directly that $0 \\le q(0) \\le 1$.\n6.  Since we have identified $\\alpha = q(0)$, we conclude that $0 \\le \\alpha \\le 1$.\n\nFinally, we compute the numerical value of $\\alpha$ using the given functional form for $q(s)$ and its parameters.\n$$\nq(s) = \\frac{1}{1 + \\exp(-\\lambda(s - s_{q}))}\n$$\nWith $\\lambda = 5$ and $s_q = 0.2$, we evaluate $\\alpha = q(0)$:\n$$\n\\alpha = q(0) = \\frac{1}{1 + \\exp(-\\lambda(0 - s_{q}))} = \\frac{1}{1 + \\exp(\\lambda s_{q})}\n$$\nSubstituting the numerical values for the parameters:\n$$\n\\alpha = \\frac{1}{1 + \\exp(5 \\times 0.2)} = \\frac{1}{1 + \\exp(1)}\n$$\nUsing the value for $e \\approx 2.71828...$, we calculate:\n$$\n\\alpha = \\frac{1}{1 + 2.7182818...} = \\frac{1}{3.7182818...} \\approx 0.2689414...\n$$\nRounding the result to four significant figures, as requested.\n$$\n\\alpha \\approx 0.2689\n$$",
            "answer": "$$\\boxed{0.2689}$$"
        }
    ]
}