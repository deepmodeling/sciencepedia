{
    "hands_on_practices": [
        {
            "introduction": "电子态密度（DOS）是连接量子力学计算与材料电子特性的核心概念。通过将态密度积分到费米能级，我们可以从根本上验证模拟体系的电子总数，这是确保计算模型自洽性的关键一步。这个实践练习将引导你从第一性原理出发，推导并应用这一基本关系，从而加深对电子结构和化学计量之间联系的理解 。",
            "id": "3904873",
            "problem": "考虑一种电极材料，该材料在密度泛函理论（DFT; Density Functional Theory）的自旋极化 Kohn–Sham 表述框架下进行建模，使用沿固定轴的共线自旋。自旋通道指数为 $\\sigma \\in \\{\\uparrow,\\downarrow\\}$。从第一性原理出发：Kohn–Sham 轨道的归一化、用于占据数的泡利不相容原理，以及自旋分辨态密度（DOS; density of states）的定义，即单位能量、单位晶胞内的单粒子 Kohn–Sham 态的数量。使用在温度 $T$ 和化学势（费米能）$E_{F}$ 下的费米-狄拉克分布给出的标准平衡占据数，然后取 $T \\to 0$ 的极限。\n\n任务1（推导）：基于上述基础，推导单位晶胞内总价电子数作为自旋分辨态密度和占据数的泛函的一般表达式，然后写出其零温特殊形式，用一个对自旋分辨态密度积分到 $E_{F}$ 的能量积分表示。\n\n任务2（应用）：考虑一个理想化的铁磁性阴极晶胞，其价带由以下粗粒化的自旋分辨态密度函数（每个单位晶胞）描述，该函数相对于一个固定的零能点给出，且费米能位于 $E_{F} = -1\\,\\mathrm{eV}$：\n- 自旋向上DOS：\n  对于 $E \\in [-5\\,\\mathrm{eV},-2\\,\\mathrm{eV}]$，$D_{\\uparrow}(E) = 2\\,\\mathrm{eV}^{-1}$；对于 $E \\in [-2\\,\\mathrm{eV},0\\,\\mathrm{eV}]$，$D_{\\uparrow}(E) = 1\\,\\mathrm{eV}^{-1}$；其他情况下 $D_{\\uparrow}(E)=0$。\n- 自旋向下DOS：\n  对于 $E \\in [-4\\,\\mathrm{eV},1\\,\\mathrm{eV}]$，$D_{\\downarrow}(E) = 1.5\\,\\mathrm{eV}^{-1}$；其他情况下 $D_{\\downarrow}(E)=0$。\n\n假设温度为零，因此在每个自旋通道中，$E \\leq E_{F}$ 的态被完全占据，$E > E_{F}$ 的态为空。使用您推导出的关系，计算单位晶胞内的总价电子数。以“电子/单位晶胞”为单位表示您的最终结果。给出精确答案，不要四舍五入。",
            "solution": "用户提供了一个分为两部分的问题。第一部分，从密度泛函理论（DFT）中的自旋分辨态密度（DOS）推导总价电子数。第二部分，将此推导出的公式应用于零温下的理想铁磁材料。\n\n### 问题验证\n\n根据指定标准对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 系统模型：自旋极化的 Kohn–Sham DFT，具有共线自旋，指数为 $\\sigma \\in \\{\\uparrow,\\downarrow\\}$。\n- 基本原理：Kohn–Sham 轨道的归一化，泡利不相容原理，以及自旋分辨态密度 $D_{\\sigma}(E)$ 的定义，即单位能量、单位晶胞内的态数。\n- 统计：平衡占据数由温度 $T$ 和化学势 $E_F$ 下的费米-狄拉克分布 $f(E, T, E_F)$ 决定。\n- 条件：应用零温极限 ($T \\to 0$)。\n- 任务1：推导单位晶胞内总价电子数 $N_{val}$ 作为 $D_{\\sigma}(E)$ 和占据数的泛函的一般表达式，然后将其特化为 $T=0$ 的情况。\n- 任务2：对于一个理想化的铁磁性阴极，在 $E_F = -1\\,\\mathrm{eV}$ 和 $T=0$ 的条件下，使用给定的分段 DOS 函数计算 $N_{val}$：\n  - 对于 $E \\in [-5\\,\\mathrm{eV},-2\\,\\mathrm{eV}]$，$D_{\\uparrow}(E) = 2\\,\\mathrm{eV}^{-1}$；对于 $E \\in [-2\\,\\mathrm{eV},0\\,\\mathrm{eV}]$，$D_{\\uparrow}(E) = 1\\,\\mathrm{eV}^{-1}$；其他情况下 $D_{\\uparrow}(E)=0$。\n  - 对于 $E \\in [-4\\,\\mathrm{eV},1\\,\\mathrm{eV}]$，$D_{\\downarrow}(E) = 1.5\\,\\mathrm{eV}^{-1}$；其他情况下 $D_{\\downarrow}(E)=0$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于固态物理和DFT的标准、公认原理。所有概念都是该领域的基础。\n- **适定性**：问题陈述清晰。任务1是一个标准的推导。任务2提供了计算唯一解所需的所有数据（$D_{\\sigma}(E)$ 的显式形式和 $E_F$ 的值）。\n- **客观性**：问题使用精确、明确的科学语言表述。\n- **一致性与完备性**：问题自成体系且内部一致。提供的DOS函数虽然简化，但对于一个玩具模型来说在数学和物理上是合理的。铁磁性假设（$D_{\\uparrow}(E) \\neq D_{\\downarrow}(E)$）与所提供的数据一致。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。将继续进行求解过程。\n\n### 任务1：推导\n\n在一个单位晶胞内，对于给定的自旋通道 $\\sigma$，在无穷小能量区间 $[E, E+dE]$ 内的单粒子 Kohn-Sham 态的数量由 $D_{\\sigma}(E)dE$ 给出，其中 $D_{\\sigma}(E)$ 是自旋分辨态密度。\n\n根据量子统计原理，能量为 $E$ 的态被电子占据的概率由费米-狄拉克分布函数给出：\n$$ f(E, T, E_F) = \\frac{1}{\\exp\\left(\\frac{E-E_F}{k_B T}\\right) + 1} $$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$E_F$ 是费米能（化学势）。\n\n在能量区间 $[E, E+dE]$ 内，单位晶胞中自旋为 $\\sigma$ 的电子数（记作 $dN_{\\sigma}$）是可用态数与其占据概率的乘积：\n$$ dN_{\\sigma} = f(E, T, E_F) D_{\\sigma}(E) dE $$\n\n为了找到自旋为 $\\sigma$ 的总价电子数 $N_{\\sigma}$，我们必须将此量对所有可能的能量进行积分：\n$$ N_{\\sigma} = \\int_{-\\infty}^{\\infty} dN_{\\sigma} = \\int_{-\\infty}^{\\infty} f(E, T, E_F) D_{\\sigma}(E) dE $$\n\n单位晶胞内的总价电子数 $N_{val}$ 是来自两个自旋通道（$\\sigma = \\uparrow$ 和 $\\sigma = \\downarrow$）贡献的总和：\n$$ N_{val} = N_{\\uparrow} + N_{\\downarrow} = \\sum_{\\sigma \\in \\{\\uparrow, \\downarrow\\}} \\int_{-\\infty}^{\\infty} f(E, T, E_F) D_{\\sigma}(E) dE $$\n这就是总价电子数作为自旋分辨态密度和占据函数泛函的一般表达式。\n\n对于零温特殊情况，我们考虑极限 $T \\to 0$。在此极限下，费米-狄拉克分布变为一个亥维赛德阶跃函数 $\\Theta(E_F - E)$：\n$$ \\lim_{T \\to 0} f(E, T, E_F) = \\begin{cases} 1  \\text{if } E \\leq E_F \\\\ 0  \\text{if } E > E_F \\end{cases} $$\n这反映了 $T=0$ 时的泡利不相容原理：所有能量小于或等于费米能的态都被完全占据（每个态1个电子，因为我们已经考虑了自旋通道），而所有能量大于费米能的态都是空的。\n\n将零温占据函数代入 $N_{val}$ 的一般表达式中，得到：\n$$ N_{val}(T=0) = \\sum_{\\sigma \\in \\{\\uparrow, \\downarrow\\}} \\int_{-\\infty}^{\\infty} \\Theta(E_F - E) D_{\\sigma}(E) dE $$\n阶跃函数 $\\Theta(E_F - E)$ 仅在 $E \\leq E_F$ 时非零。因此，它有效地将积分上限设置为 $E_F$：\n$$ N_{val} = \\sum_{\\sigma \\in \\{\\uparrow, \\downarrow\\}} \\int_{-\\infty}^{E_F} D_{\\sigma}(E) dE $$\n这就是所要求的零温特殊形式。该公式表明，单位晶胞内的总价电子数是总态密度 $D_{total}(E) = D_{\\uparrow}(E) + D_{\\downarrow}(E)$ 从 $-\\infty$ 到费米能 $E_F$ 的积分。\n\n### 任务2：应用\n\n我们将推导出的零温公式应用于给定的理想化铁磁性阴极。\n总价电子数为 $N_{val} = N_{\\uparrow} + N_{\\downarrow}$，其中：\n$$ N_{\\uparrow} = \\int_{-\\infty}^{E_F} D_{\\uparrow}(E) dE \\quad \\text{and} \\quad N_{\\downarrow} = \\int_{-\\infty}^{E_F} D_{\\downarrow}(E) dE $$\n给定的费米能为 $E_F = -1\\,\\mathrm{eV}$。\n\n首先，我们计算自旋向上的电子数 $N_{\\uparrow}$。态密度 $D_{\\uparrow}(E)$ 是分段的。我们将积分分解到 $D_{\\uparrow}(E)$ 非零的区间上，积分上限为 $E_F = -1\\,\\mathrm{eV}$。\n$D_{\\uparrow}(E)$ 的非零区域是 $[-5\\,\\mathrm{eV}, -2\\,\\mathrm{eV}]$ 和 $[-2\\,\\mathrm{eV}, 0\\,\\mathrm{eV}]$。积分到 $E_F = -1\\,\\mathrm{eV}$ 覆盖了整个第一区域和第二区域的一部分。\n$$ N_{\\uparrow} = \\int_{-5\\,\\mathrm{eV}}^{-2\\,\\mathrm{eV}} (2\\,\\mathrm{eV}^{-1}) \\,dE + \\int_{-2\\,\\mathrm{eV}}^{-1\\,\\mathrm{eV}} (1\\,\\mathrm{eV}^{-1}) \\,dE $$\n计算积分（电子数是无量纲的量）：\n$$ N_{\\uparrow} = 2 \\times [E]_{-5}^{-2} + 1 \\times [E]_{-2}^{-1} $$\n$$ N_{\\uparrow} = 2 \\times ((-2) - (-5)) + 1 \\times ((-1) - (-2)) $$\n$$ N_{\\uparrow} = 2 \\times (3) + 1 \\times (1) $$\n$$ N_{\\uparrow} = 6 + 1 = 7 $$\n所以，每个单位晶胞有 $7$ 个自旋向上的价电子。\n\n接下来，我们计算自旋向下的电子数 $N_{\\downarrow}$。态密度 $D_{\\downarrow}(E)$ 在区间 $[-4\\,\\mathrm{eV}, 1\\,\\mathrm{eV}]$ 上非零。积分到 $E_F = -1\\,\\mathrm{eV}$ 覆盖了这个区域的一部分。\n$$ N_{\\downarrow} = \\int_{-4\\,\\mathrm{eV}}^{-1\\,\\mathrm{eV}} (1.5\\,\\mathrm{eV}^{-1}) \\,dE $$\n计算积分：\n$$ N_{\\downarrow} = 1.5 \\times [E]_{-4}^{-1} $$\n$$ N_{\\downarrow} = 1.5 \\times ((-1) - (-4)) $$\n$$ N_{\\downarrow} = 1.5 \\times (3) $$\n$$ N_{\\downarrow} = 4.5 $$\n所以，每个单位晶胞有 $4.5$ 个自旋向下的价电子。\n\n最后，单位晶胞内的总价电子数 $N_{val}$ 是自旋向上和自旋向下贡献的总和：\n$$ N_{val} = N_{\\uparrow} + N_{\\downarrow} = 7 + 4.5 = 11.5 $$\n单位晶胞内的总价电子数为 $11.5$。非整数值在物理上是有意义的，因为它代表了周期性晶体中定义的单位晶胞体积内的平均电子密度。$N_{\\uparrow}$ 和 $N_{\\downarrow}$ 之间的差异导致了净自旋磁化，这与材料是铁磁性的一致。",
            "answer": "$$\\boxed{11.5}$$"
        },
        {
            "introduction": "在许多电极材料中，电荷载流子并非以自由电子的形式存在，而是形成一种名为“极化子”的准粒子，其中电荷被局域的晶格畸变所“包裹”。本练习将指导你设计一个量化诊断方法，通过综合分析电荷密度差异和结构变化，来识别这一关键的物理现象。掌握这种方法对于表征电极材料中的电荷输运机制至关重要 。",
            "id": "3904815",
            "problem": "您的任务是使用密度泛函理论（DFT）设计并实现一种程序化诊断方法，以确认电极材料中是否存在小极化子局域化。该诊断方法必须基于以下物理图像：晶体中的局域化电荷会在空间上产生集中的电子密度变化，并引发局部的结构畸变。任务必须从以下基本原理出发：Kohn-Sham 密度泛函理论（DFT）定义了相互作用电子系统的基态电子密度 $\\rho(\\mathbf{r})$；一个电子的加入或移除会产生一个变化 $\\Delta \\rho(\\mathbf{r}) = \\rho_{\\text{charged}}(\\mathbf{r}) - \\rho_{\\text{neutral}}(\\mathbf{r})$。小极化子是一种准粒子，由局域在少数原子位点上的电荷以及由电子-声子耦合引起的局域晶格畸变共同构成。基于此，推导出一个数学上精确的诊断标准，该标准需结合电荷密度差的空间局域化量度与局域畸变幅度的量度。在一个程序中实现该诊断方法，该程序接收离散数据，并为每个案例输出一个布尔值，以指示极化子是否局域化。\n\n您将使用一种离散近似方法，其中区域被划分为 $N$ 个不相交的盆或单元 $\\{\\Omega_i\\}_{i=1}^N$。每个单元的电荷差定义为 $\\Delta q_i = \\int_{\\Omega_i} \\Delta \\rho(\\mathbf{r})\\,\\mathrm{d}^3 r$，以电子为单位。由于电子极化子（$\\Delta q_i > 0$）和空穴极化子（$\\Delta q_i  0$）都可能存在，您的局域化量度必须依赖于 $|\\Delta q_i|$。同时，您会获得候选极化子位点周围的参考（未畸变）结构和弛豫（畸变）结构的局域键长。键长以埃（angstrom）为单位提供，并且必须始终按此单位处理。\n\n您推导出的诊断标准必须使用以下阈值为每个测试案例生成一个布尔决策，您必须将这些阈值应用于您推导的量度，不得简化其推导过程：\n- 电荷局域化的有效位点数必须小于或等于 $S_{\\mathrm{max}} = 3.0$。\n- 平均局域键长畸变幅度必须大于或等于 $D_{\\mathrm{min}} = 0.02$。\n\n不涉及角度。键长单位为埃。根据定义，畸变是无量纲的。每个测试案例的最终输出必须是一个布尔值，指示根据您推导的量度，两个条件是否都得到满足。\n\n您的程序必须为以下测试套件实现该诊断方法。每个测试案例提供 $(N, \\{\\Delta q_i\\}_{i=1}^N, \\{d^{(0)}_j\\}_{j=1}^M, \\{d_j\\}_{j=1}^M)$，其中 $N$ 是单元数，$\\Delta q_i$ 是每个单元的电荷差（单位：电子），$d^{(0)}_j$ 是参考键长（单位：埃），$d_j$ 是弛豫键长（单位：埃）。所有案例中键的数量 $M$ 均为 $6$。\n\n- 案例 A（理想情况：电子极化子局域化并伴有显著畸变）：$N = 12$, $\\{\\Delta q_i\\} = [0.02, 0.01, 0.01, 0.02, 0.02, 0.80, 0.06, 0.02, 0.01, 0.00, 0.00, 0.01]$, $\\{d^{(0)}_j\\} = [2.00, 2.00, 2.00, 2.00, 2.00, 2.00]$ 埃, $\\{d_j\\} = [2.10, 2.06, 1.94, 1.95, 2.00, 2.00]$ 埃。\n- 案例 B（离域电荷伴有微小畸变）：$N = 12$, $\\{\\Delta q_i\\} = [0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]$, $\\{d^{(0)}_j\\} = [2.00, 2.00, 2.00, 2.00, 2.00, 2.00]$ 埃, $\\{d_j\\} = [2.01, 2.01, 1.99, 1.99, 2.00, 2.00]$ 埃。\n- 案例 C（空穴极化子局域化并伴有显著畸变）：$N = 12$, $\\{\\Delta q_i\\} = [-0.02, -0.01, -0.01, -0.02, -0.02, -0.75, -0.08, -0.03, -0.02, 0.00, 0.00, -0.01]$, $\\{d^{(0)}_j\\} = [2.00, 2.00, 2.00, 2.00, 2.00, 2.00]$ 埃, $\\{d_j\\} = [1.90, 1.95, 2.06, 2.05, 2.00, 2.00]$ 埃。\n- 案例 D（电荷密度处于局域化临界状态，但畸变不足）：$N = 12$, $\\{\\Delta q_i\\} = [0.02, 0.01, 0.01, 0.02, 0.02, 0.80, 0.06, 0.02, 0.01, 0.00, 0.00, 0.01]$, $\\{d^{(0)}_j\\} = [2.00, 2.00, 2.00, 2.00, 2.00, 2.00]$ 埃, $\\{d_j\\} = [2.01, 2.00, 1.99, 2.00, 2.00, 2.00]$ 埃。\n- 案例 E（双位点极化子伴有中等程度畸变）：$N = 12$, $\\{\\Delta q_i\\} = [0.00, 0.00, 0.00, 0.48, 0.48, 0.01, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00]$, $\\{d^{(0)}_j\\} = [2.00, 2.00, 2.00, 2.00, 2.00, 2.00]$ 埃, $\\{d_j\\} = [2.08, 2.06, 1.94, 1.94, 2.00, 2.00]$ 埃。\n\n您的程序必须：\n- 从第一性原理出发，推导出一个将 $\\{|\\Delta q_i|\\}$ 归一化为 $N$ 个单元上的离散概率分布的方法，一个基于此分布且有数学依据的局域化指数，以及一个基于所提供键长的畸变度量。\n- 通过检查推导出的有效支撑尺寸是否小于或等于 $S_{\\mathrm{max}}$，以及推导出的平均畸变是否大于或等于 $D_{\\mathrm{min}}$，来确定每个案例的极化子是否局域化（以布尔值表示）。\n- 生成单行输出，其中包含一个用方括号括起来的、逗号分隔的布尔值列表，例如 `[True,False,True,False,True]`。\n\n每个案例的最终输出类型是一个布尔值。键长必须以埃为单位处理。畸变必须是无量纲的。不涉及角度。程序不得读取外部文件或接受输入，并且必须仅对提供的测试套件进行操作。",
            "solution": "问题陈述已经过分析，并被认为是有效的。它在科学上基于密度泛函理论的原理和小极化子的物理学。这是一个适定问题，提供了一套自洽的数据和明确的目标，要求从第一性原理推导物理上有意义的度量。语言是客观的，提供的数值数据在物理上是合理的。任务是推导并应用一个诊断方法，这在计算材料科学中构成了一个非凡但可解的问题。\n\n目标是基于两个标准为小极化子局域化制定一个定量诊断方法：电荷密度差 $\\Delta\\rho(\\mathbf{r})$ 的空间局域化程度，以及相关联的局域晶格畸变的幅度。我们获得了电荷和键长的离散数据，必须为几个测试案例生成布尔决策。\n\n首先，我们推导电荷局域化的度量。问题提供了 $N$ 个离散单元内的净电荷差 $\\Delta q_i$，其中 $\\Delta q_i = \\int_{\\Omega_i} \\Delta \\rho(\\mathbf{r})\\,\\mathrm{d}^3 r$。一个局域化的极化子意味着大部分的多余电荷（对于电子极化子，$\\sum_i \\Delta q_i \\approx +1$）或电荷亏损（对于空穴极化子，$\\sum_i \\Delta q_i \\approx -1$）集中在少数几个单元中。为了创建一个对电子和空穴极化子都适用的通用度量，我们必须使用电荷差的绝对值 $|\\Delta q_i|$。\n\n我们可以将电荷变化幅度的分布概念化为一个离散概率分布。让我们为每个单元 $i=1, \\dots, N$ 定义一组非负权重 $w_i = |\\Delta q_i|$。为了形成一个概率分布 $\\{p_i\\}$，我们对这些权重进行归一化：\n$$\np_i = \\frac{w_i}{\\sum_{k=1}^N w_k} = \\frac{|\\Delta q_i|}{\\sum_{k=1}^N |\\Delta q_k|}\n$$\n这个量 $p_i$ 代表在单元 $i$ 中发生电荷重新分布总幅度的分数。根据定义，$p_i \\ge 0$ 且 $\\sum_{i=1}^N p_i = 1$。\n\n高度局域化的电荷分布对应于一个急剧峰值的概率分布，而离域电荷则对应于一个类均匀分布。一种量化分布局域化程度的标准且有物理意义的方法是通过其信息熵。分布 $\\{p_i\\}$ 的香农熵由下式给出：\n$$\nH = -\\sum_{i=1}^N p_i \\ln p_i\n$$\n其中如果 $p_i=0$，则项 $p_i \\ln p_i$ 取为 $0$。对于一个完全局域化的分布（所有电荷都在一个单元中，即对某个 $k$ 有 $p_k=1$ 且 $p_{i \\ne k}=0$），熵 $H$ 是最小的（$H=0$）。对于一个完全离域的分布（电荷均匀分布在所有 $N$ 个单元中，即对所有 $i$ 有 $p_i=1/N$），熵是最大的（$H=\\ln N$）。\n\n为了将此熵解释为电荷分布的“有效位点数”，我们将局域化指数 $S$ 定义为熵的指数：\n$$\nS = \\exp(H) = \\exp\\left(-\\sum_{i=1}^N p_i \\ln p_i\\right)\n$$\n这个量，有时被称为困惑度或有效模式数，其范围从单一位点上完美局域化的 $S=1$ 到 $N$ 个位点上完美离域化的 $S=N$。极化子局域化的第一个条件是，这个有效位点数必须低于给定的阈值 $S_{\\mathrm{max}}$：\n$$\nS \\le S_{\\mathrm{max}} = 3.0\n$$\n\n其次，我们推导局域晶格畸变的度量。我们已知 $M$ 个参考键长 $\\{d_j^{(0)}\\}_{j=1}^M$ 以及在弛豫（带电）结构中对应的键长 $\\{d_j\\}_{j=1}^M$。问题要求一个无量纲的平均畸变幅度度量。\n\n对于每个键 $j$，长度变化为 $\\Delta d_j = d_j - d_j^{(0)}$。为了使此变化无量纲且独立于绝对键长，我们计算相对畸变：\n$$\n\\delta_j = \\frac{d_j - d_j^{(0)}}{d_j^{(0)}}\n$$\n由于畸变可以涉及键的伸长（$\\delta_j > 0$）和压缩（$\\delta_j  0$），而我们关心的是结构变化的总体幅度，因此我们考虑相对畸变的绝对值 $|\\delta_j|$。\n\n为了获得一个代表平均局域畸变的单一指标，我们计算所有 $M$ 个键的这些幅度的算术平均值：\n$$\nD = \\frac{1}{M}\\sum_{j=1}^M |\\delta_j| = \\frac{1}{M}\\sum_{j=1}^M \\left| \\frac{d_j - d_j^{(0)}}{d_j^{(0)}} \\right|\n$$\n这个度量 $D$ 是一个无量纲的、半正定的量，它量化了极化子位点周围键长变化的平均幅度。极化子局域化的第二个条件是，这个平均畸变必须高于给定的阈值 $D_{\\mathrm{min}}$：\n$$\nD \\ge D_{\\mathrm{min}} = 0.02\n$$\n\n最终的极化子诊断是这两个条件的布尔“与”运算。当且仅当电荷足够局域化（$S \\le S_{\\mathrm{max}}$）且晶格畸变足够大（$D \\ge D_{\\mathrm{min}}$）时，系统才被确定为存在一个局域化的小极化子。这个组合标准正确地捕捉了极化子作为同时具有电荷和晶格畸变特性的准粒子的双重性质。现在将实现该逻辑并将其应用于所提供的测试案例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ... # Scipy is available but not required for this implementation.\n\ndef solve():\n    \"\"\"\n    Derives and applies a diagnostic for small polaron localization based on DFT data.\n    The diagnostic evaluates two conditions:\n    1. Charge Localization: The effective number of sites for charge spread must be low.\n    2. Lattice Distortion: The average local bond distortion must be high.\n    A polaron is considered localized if both conditions are met.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = {\n        \"Case A\": {\n            \"N\": 12,\n            \"delta_q\": np.array([0.02, 0.01, 0.01, 0.02, 0.02, 0.80, 0.06, 0.02, 0.01, 0.00, 0.00, 0.01]),\n            \"d0\": np.array([2.00, 2.00, 2.00, 2.00, 2.00, 2.00]),\n            \"d\": np.array([2.10, 2.06, 1.94, 1.95, 2.00, 2.00]),\n        },\n        \"Case B\": {\n            \"N\": 12,\n            \"delta_q\": np.array([0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083, 0.083]),\n            \"d0\": np.array([2.00, 2.00, 2.00, 2.00, 2.00, 2.00]),\n            \"d\": np.array([2.01, 2.01, 1.99, 1.99, 2.00, 2.00]),\n        },\n        \"Case C\": {\n            \"N\": 12,\n            \"delta_q\": np.array([-0.02, -0.01, -0.01, -0.02, -0.02, -0.75, -0.08, -0.03, -0.02, 0.00, 0.00, -0.01]),\n            \"d0\": np.array([2.00, 2.00, 2.00, 2.00, 2.00, 2.00]),\n            \"d\": np.array([1.90, 1.95, 2.06, 2.05, 2.00, 2.00]),\n        },\n        \"Case D\": {\n            \"N\": 12,\n            \"delta_q\": np.array([0.02, 0.01, 0.01, 0.02, 0.02, 0.80, 0.06, 0.02, 0.01, 0.00, 0.00, 0.01]),\n            \"d0\": np.array([2.00, 2.00, 2.00, 2.00, 2.00, 2.00]),\n            \"d\": np.array([2.01, 2.00, 1.99, 2.00, 2.00, 2.00]),\n        },\n        \"Case E\": {\n            \"N\": 12,\n            \"delta_q\": np.array([0.00, 0.00, 0.00, 0.48, 0.48, 0.01, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00]),\n            \"d0\": np.array([2.00, 2.00, 2.00, 2.00, 2.00, 2.00]),\n            \"d\": np.array([2.08, 2.06, 1.94, 1.94, 2.00, 2.00]),\n        },\n    }\n\n    # Define thresholds from the problem statement\n    S_max = 3.0\n    D_min = 0.02\n\n    def check_polaron_localization(delta_q, d0, d):\n        \"\"\"\n        Calculates the localization index S and distortion metric D for a single case.\n        Returns a boolean indicating if the polaron is localized.\n        \"\"\"\n        # 1. Calculate the charge localization index S\n        abs_delta_q = np.abs(delta_q)\n        total_abs_q = np.sum(abs_delta_q)\n\n        # Handle the edge case of no charge difference\n        if total_abs_q == 0:\n            # If there's no charge, it's perfectly delocalized over all sites.\n            # Could be N, but this case isn't physically interesting for a polaron search.\n            # In any case, it's not localized on a few sites.\n            S = float('inf') \n        else:\n            p = abs_delta_q / total_abs_q\n            # Filter out p_i = 0 to avoid log(0) errors. The term p_i*log(p_i) is 0 for p_i=0.\n            p_nonzero = p[p > 0]\n            # Calculate Shannon entropy H\n            H = -np.sum(p_nonzero * np.log(p_nonzero))\n            # Calculate localization index S (effective number of sites)\n            S = np.exp(H)\n        \n        is_charge_localized = (S = S_max)\n\n        # 2. Calculate the lattice distortion metric D\n        # Use np.divide to handle potential division by zero if a bond length is 0,\n        # although physically d0 should always be positive.\n        fractional_distortion = np.divide(d - d0, d0)\n        D = np.mean(np.abs(fractional_distortion))\n        \n        is_distorted = (D >= D_min)\n\n        # 3. Final polaron diagnostic\n        is_polaron_localized = is_charge_localized and is_distorted\n        \n        return is_polaron_localized\n\n    results = []\n    # The order of cases must be preserved for the final output.\n    case_order = [\"Case A\", \"Case B\", \"Case C\", \"Case D\", \"Case E\"]\n    for case_name in case_order:\n        case_data = test_cases[case_name]\n        result = check_polaron_localization(case_data[\"delta_q\"], case_data[\"d0\"], case_data[\"d\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The output format for booleans in Python's str() is 'True' or 'False'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "虽然密度泛函理论（DFT）为我们提供了精确的零温基态能量，但真实的电池在有限温度下工作。这项实践旨在展示如何通过引入热效应——包括声子振动自由能和构型熵——来弥合理论与现实之间的差距，从而预测符合实际工作条件的开路电压。这是将基础DFT计算结果转化为具有实际预测价值的电化学性质的关键一步 。",
            "id": "3904866",
            "problem": "要求您实现一个基于第一性原理的计算工作流，将振动自由能和构型熵修正纳入锂嵌入电极材料的有限温度吉布斯自由能 $G(T)$ 中，并利用此方法预测有限温度下的开路电压。该场景基于密度泛函理论 (DFT) 和统计力学，其中 DFT 是一种用于获得总能量 $E_{\\mathrm{DFT}}$ 的量子力学方法，而统计力学用于计算振动和构型贡献。您的程序必须计算给定组分的 $G(T)$，结合金属锂的化学势将其整合为锂嵌入步骤的反应自由能，然后将其转化为电压。\n\n从以下基本事实和定义开始：\n- 吉布斯自由能定义为 $G = U - T S + p V$。对于环境条件下的凝聚相固体， $pV$ 项可以忽略不计，因此 $G(T)$ 可以近似为 $G(T) \\approx E_{\\mathrm{DFT}} + F_{\\mathrm{vib}}(T) - T S_{\\mathrm{conf}}(x)$，其中 $E_{\\mathrm{DFT}}$ 是来自密度泛函理论 (DFT) 的总能量， $F_{\\mathrm{vib}}(T)$ 是温度 $T$ 下的振动亥姆霍兹自由能， $S_{\\mathrm{conf}}(x)$ 是在一组等效位点上锂/空位以分数占有率 $x$ 混合所产生的构型熵。\n- 在声子的谐振子近似中，每个角频率为 $\\omega_i$ 的简正模对振动亥姆霍兹自由能的贡献如下\n$$\nF_{\\mathrm{vib}}(T) = \\sum_{i} \\left( \\frac{1}{2}\\hbar \\omega_i + k_B T \\ln\\left(1 - e^{-\\hbar \\omega_i / (k_B T)} \\right) \\right),\n$$\n其中 $k_B$ 是玻尔兹曼常数，$\\hbar$ 是约化普朗克常数。如果频率以周/秒 $f_i$ 给出，则 $\\omega_i = 2 \\pi f_i$。\n- 对于每个化学式单位中 $N_{\\mathrm{sites}}$ 个等效位点上锂和空位的二元理想混合，构型熵为\n$$\nS_{\\mathrm{conf}}(x) = -k_B N_{\\mathrm{sites}} \\left[ x \\ln x + (1-x) \\ln (1-x) \\right],\n$$\n对于 $0  x  1$ 成立，且根据连续性 $S_{\\mathrm{conf}}(0) = S_{\\mathrm{conf}}(1) = 0$。\n- 对于主体材料中从 $x_2$ 到 $x_1$ 的锂嵌入反应，\n$$\n\\Delta G(T) = G_{\\mathrm{host}}(x_1,T) - G_{\\mathrm{host}}(x_2,T) - (x_1 - x_2)\\,\\mu_{\\mathrm{Li}}(T),\n$$\n其中 $\\mu_{\\mathrm{Li}}(T)$ 是每个原子的金属锂化学势（通过 DFT 和振动贡献近似），以及\n$$\nG_{\\mathrm{host}}(x,T) = E_{\\mathrm{DFT}}^{\\mathrm{host}}(x) + F_{\\mathrm{vib}}^{\\mathrm{host}}(x,T) - T S_{\\mathrm{conf}}(x).\n$$\n- 温度 $T$ 下的开路电压由下式给出\n$$\nV(T) = -\\frac{\\Delta G(T)}{x_1 - x_2}.\n$$\n当所有能量以每个化学式单位和每个原子的电子伏特为单位进行追踪时，该表达式将以伏特为单位得出电压，因为每电子 $1\\,\\mathrm{eV}$ 对应于 $1\\,\\mathrm{V}$。\n\n您的程序必须使用以下数值和物理输入及约定来实现上述原理：\n- 使用 $k_B = 8.617333262\\times 10^{-5}\\,\\mathrm{eV/K}$ 和 $\\hbar = 6.582119569\\times 10^{-16}\\,\\mathrm{eV\\cdot s}$。使用 $\\omega = 2\\pi f$ 和 $1\\,\\mathrm{THz} = 10^{12}\\,\\mathrm{Hz}$。所有振动频率均以太赫兹 (THz) 给出。\n- 主体材料的组分由每个化学式单位的锂分数 $x$ 参数化，每个化学式单位有 $N_{\\mathrm{sites}} = 1$ 个位点。使用以下主体材料的密度泛函理论 (DFT) 总能量（单位为电子伏特，每个化学式单位）：\n    - $E_{\\mathrm{DFT}}^{\\mathrm{host}}(0.0) = -100.000\\,\\mathrm{eV}$，\n    - $E_{\\mathrm{DFT}}^{\\mathrm{host}}(0.5) = -102.500\\,\\mathrm{eV}$，\n    - $E_{\\mathrm{DFT}}^{\\mathrm{host}}(0.95) = -104.100\\,\\mathrm{eV}$，\n    - $E_{\\mathrm{DFT}}^{\\mathrm{host}}(1.0) = -104.200\\,\\mathrm{eV}$。\n- 主体材料在各组分 $x$ 下的振动频率（单位 THz）（每个化学式单位，谐振子简正模）：\n    - 对于 $x=0.0$: $[5.0,\\,8.0,\\,12.0,\\,15.0,\\,3.0,\\,7.0,\\,10.0,\\,14.0,\\,18.0]$，\n    - 对于 $x=0.5$: $[4.5,\\,7.5,\\,11.5,\\,14.5,\\,2.5,\\,6.5,\\,9.5,\\,13.5,\\,17.0]$，\n    - 对于 $x=0.95$: $[4.2,\\,7.0,\\,11.0,\\,14.0,\\,2.2,\\,6.2,\\,9.2,\\,13.2,\\,16.5]$，\n    - 对于 $x=1.0$: $[4.0,\\,6.8,\\,10.8,\\,13.8,\\,2.0,\\,6.0,\\,9.0,\\,13.0,\\,16.0]$。\n- 金属锂（每个原子）的 DFT 能量和振动频率（单位 THz）：\n    - $E_{\\mathrm{DFT}}^{\\mathrm{Li}} = -1.600\\,\\mathrm{eV}$，\n    - 频率 $[2.0,\\,4.0,\\,6.0]$。\n\n算法要求：\n- 实现一个鲁棒的 $F_{\\mathrm{vib}}(T)$ 计算方法，该方法在 $T=0$ 时返回零点能 $\\sum_i \\frac{1}{2}\\hbar\\omega_i$，否则使用完整的谐振子自由能表达式。通过为极小的 $T$ 实现一个阈值来避免数值问题。\n- 实现 $S_{\\mathrm{conf}}(x)$ 时，需对 $x=0$ 和 $x=1$ 进行数值稳定的处理，以使 $S_{\\mathrm{conf}}(0)=S_{\\mathrm{conf}}(1)=0$。\n\n测试套件：\n计算以下四种情况下的电压（单位为伏特 V），并四舍五入到六位小数：\n1. $T = 300\\,\\mathrm{K}$， $x_2=0.0$， $x_1=0.5$。\n2. $T = 1\\,\\mathrm{K}$， $x_2=0.0$， $x_1=0.5$。\n3. $T = 1000\\,\\mathrm{K}$， $x_2=0.5$， $x_1=1.0$。\n4. $T = 300\\,\\mathrm{K}$， $x_2=0.95$， $x_1=1.0$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[v_1,v_2,v_3,v_4]$），其中每个 $v_i$ 是预测的电压值（单位为伏特），四舍五入到六位小数。不应打印任何其他文本。所有内部计算必须一致地使用所提供的常数和单位，并且最终答案必须以 $\\mathrm{V}$ 表示。",
            "solution": "该问题要求实现一个计算工作流，用于确定锂嵌入电极在有限温度下的开路电压。该方法论植根于密度泛函理论（DFT）的总能计算原理和统计力学的热与熵对吉布斯自由能贡献的原理。解决方案将基于所提供的物理模型和数据，通过严谨、分步的推导来构建。\n\n对于在可忽略压力下的固相，其温度为 $T$ 时的吉布斯自由能 $G(T)$ 可由亥姆霍兹自由能 $A(T) = U - TS$ 近似。在我们的模型中，这被进一步分解为：\n$$\nG(T) \\approx G(x,T) = E_{\\mathrm{DFT}}(x) + F_{\\mathrm{vib}}(x,T) - T S_{\\mathrm{conf}}(x)\n$$\n在此， $x$ 是锂的分数占有率， $E_{\\mathrm{DFT}}(x)$ 是从DFT获得的 $T=0\\,\\mathrm{K}$ 时的静态总能量， $F_{\\mathrm{vib}}(x,T)$ 是振动亥姆霍兹自由能， $S_{\\mathrm{conf}}(x)$ 是由锂离子和空位的统计排列产生的构型熵。\n\n计算流程的结构如下：\n\n1.  **热力学量的建模：** 我们首先建立鲁棒的函数，用于计算任何给定组分和温度下的组成热力学量。\n\n    -   **振动亥姆霍兹自由能, $F_{\\mathrm{vib}}(T)$：** 在谐振子近似下，一组角频率为 $\\{\\omega_i\\}$ 的简正模的振动自由能由下式给出：\n        $$\n        F_{\\mathrm{vib}}(T) = \\sum_{i} \\left( \\frac{1}{2}\\hbar \\omega_i + k_B T \\ln\\left(1 - e^{-\\hbar \\omega_i / (k_B T)} \\right) \\right)\n        $$\n        第一项 $\\sum_i \\frac{1}{2}\\hbar \\omega_i$ 是与温度无关的零点能 (ZPE)。第二项代表对自由能的热贡献。实现时必须处理输入频率 $f_i$ （单位 THz）到角频率 $\\omega_i = 2 \\pi f_i$ 的转换。在数值上，对于非常小的 $T$，对数的参数会趋近于0，这可能导致不稳定。在 $T \\to 0\\,\\mathrm{K}$ 时，对数项消失，$F_{\\mathrm{vib}}(0)$ 正确地简化为零点能。我们的实现遵循此极限，并使用数值稳定的库函数（即 `numpy.log1p`）来精确计算对数项。使用的物理常数是玻尔兹曼常数 $k_B=8.617333262\\times 10^{-5}\\,\\mathrm{eV/K}$ 和约化普朗克常数 $\\hbar = 6.582119569\\times 10^{-16}\\,\\mathrm{eV\\cdot s}$。\n\n    -   **构型熵, $S_{\\mathrm{conf}}(x)$：** 对于每个化学式单位中 $N_{\\mathrm{sites}}$ 个等效位点上的锂和空位的理想固溶体，构型熵由玻尔兹曼混合公式给出：\n        $$\n        S_{\\mathrm{conf}}(x) = -k_B N_{\\mathrm{sites}} \\left[ x \\ln x + (1-x) \\ln (1-x) \\right]\n        $$\n        该表达式对 $x \\in (0,1)$ 有效。对于纯相 $x=0$ 和 $x=1$，不存在构型无序，因此 $S_{\\mathrm{conf}}(0)=S_{\\mathrm{conf}}(1)=0$。实现时必须明确处理这些端点条件，以避免计算 $\\ln(0)$ 时的数值错误。问题指定 $N_{\\mathrm{sites}} = 1$。\n\n2.  **化学势和吉布斯自由能的计算：**\n\n    -   **金属锂的化学势, $\\mu_{\\mathrm{Li}}(T)$：** 锂化学势的参考标准取为纯金属锂。其每个原子的吉布斯自由能计算如下：\n        $$\n        \\mu_{\\mathrm{Li}}(T) = G_{\\mathrm{Li}}(T) = E_{\\mathrm{DFT}}^{\\mathrm{Li}} + F_{\\mathrm{vib}}^{\\mathrm{Li}}(T)\n        $$\n        此处，$E_{\\mathrm{DFT}}^{\\mathrm{Li}}$ 和金属锂的振动频率是已知的。纯元素的构型熵为零。\n\n    -   **主体材料的吉布斯自由能, $G_{\\mathrm{host}}(x,T)$：** 使用第一步中开发的函数以及为主体材料在不同组分 $x$ 下提供的 DFT 能量和振动频率，我们计算每个化学式单位的总吉布斯自由能：\n        $$\n        G_{\\mathrm{host}}(x,T) = E_{\\mathrm{DFT}}^{\\mathrm{host}}(x) + F_{\\mathrm{vib}}^{\\mathrm{host}}(x,T) - T S_{\\mathrm{conf}}(x)\n        $$\n\n3.  **开路电压的确定：** 电动势，或称开路电压 ($V$)，由电化学反应的吉布斯自由能变化决定。对于 $(x_1 - x_2)$ 份锂嵌入主体材料的反应 $\\mathrm{Host}(x_2) + (x_1 - x_2)\\mathrm{Li} \\rightarrow \\mathrm{Host}(x_1)$，此过程的吉布斯自由能变为：\n    $$\n    \\Delta G(T) = G_{\\mathrm{host}}(x_1,T) - G_{\\mathrm{host}}(x_2,T) - (x_1 - x_2)\\,\\mu_{\\mathrm{Li}}(T)\n    $$\n    电压是单位转移电荷的自由能变化的负值。当所有能量单位为电子伏特 (eV)，并考虑转移了 $(x_1 - x_2)$ 个电子（对应 $(x_1 - x_2)$ 个 Li$^+$ 离子）时，电压（单位为伏特 V）为：\n    $$\n    V(T) = -\\frac{\\Delta G(T)}{x_1 - x_2} = -\\left( \\frac{G_{\\mathrm{host}}(x_1,T) - G_{\\mathrm{host}}(x_2,T)}{x_1 - x_2} - \\mu_{\\mathrm{Li}}(T) \\right)\n    $$\n    项 $\\frac{G_{\\mathrm{host}}(x_1,T) - G_{\\mathrm{host}}(x_2,T)}{x_1 - x_2}$ 是主体材料中锂化学势 $\\mu_{\\mathrm{Li}}^{\\mathrm{host}}(T)$ 的有限差分近似。\n\n最终的程序实现了这整个工作流。它定义了物理常数和输入数据，实现了用于计算 $F_{\\mathrm{vib}}(T)$ 和 $S_{\\mathrm{conf}}(x)$ 的函数，然后将它们组合起来计算 $G_{\\mathrm{host}}(x,T)$ 和 $\\mu_{\\mathrm{Li}}(T)$。最后，它遍历指定的测试用例，计算每个用例的电压，将结果四舍五入到六位小数，并打印格式化的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes open-circuit voltages at finite temperature for a Li-intercalation electrode.\n    The calculation is based on DFT total energies and statistical mechanics for\n    vibrational and configurational contributions to the Gibbs free energy.\n    \"\"\"\n\n    # Define the physical constants provided in the problem statement.\n    k_B = 8.617333262e-5  # Boltzmann constant in eV/K\n    hbar = 6.582119569e-16 # Reduced Planck constant in eV*s\n\n    # Define the input data for the host material.\n    E_dft_host = {\n        0.0: -100.000,\n        0.5: -102.500,\n        0.95: -104.100,\n        1.0: -104.200,\n    }\n    freqs_host = {\n        0.0: np.array([5.0, 8.0, 12.0, 15.0, 3.0, 7.0, 10.0, 14.0, 18.0]),\n        0.5: np.array([4.5, 7.5, 11.5, 14.5, 2.5, 6.5, 9.5, 13.5, 17.0]),\n        0.95: np.array([4.2, 7.0, 11.0, 14.0, 2.2, 6.2, 9.2, 13.2, 16.5]),\n        1.0: np.array([4.0, 6.8, 10.8, 13.8, 2.0, 6.0, 9.0, 13.0, 16.0]),\n    }\n    N_sites = 1\n\n    # Define the input data for Lithium metal.\n    E_dft_li = -1.600\n    freqs_li = np.array([2.0, 4.0, 6.0])\n\n    def calculate_F_vib(T, freqs_thz):\n        \"\"\"\n        Calculates the vibrational Helmholtz free energy F_vib(T) in the harmonic approximation.\n        \n        Args:\n            T (float): Temperature in Kelvin.\n            freqs_thz (np.ndarray): Array of vibrational frequencies in THz.\n\n        Returns:\n            float: Vibrational free energy in eV.\n        \"\"\"\n        # omega = 2 * pi * f\n        omegas = 2 * np.pi * freqs_thz * 1e12  # Angular frequencies in rad/s\n\n        # Zero-point energy (ZPE) = sum(0.5 * hbar * omega)\n        zpe = 0.5 * hbar * np.sum(omegas)\n\n        # At T=0, F_vib is just the ZPE. Use a small threshold for numerical stability.\n        if T  1e-6:\n            return zpe\n\n        # Thermal contribution to free energy\n        k_B_T = k_B * T\n        hbar_omegas = hbar * omegas\n        \n        # Argument of the exponential: x = hbar * omega / (k_B * T)\n        # Avoid division by zero if k_B_T is zero, though already handled by T check.\n        exponents = hbar_omegas / k_B_T\n        \n        # Use np.log1p for better numerical precision for log(1-y) where y is small.\n        # log(1 - exp(-x)) = log1p(-exp(-x))\n        thermal_terms = k_B_T * np.log1p(-np.exp(-exponents))\n        thermal_F = np.sum(thermal_terms)\n        \n        return zpe + thermal_F\n\n    def calculate_S_conf(x):\n        \"\"\"\n        Calculates the configurational entropy S_conf(x) for ideal binary mixing.\n\n        Args:\n            x (float): Lithium fraction, between 0 and 1.\n\n        Returns:\n            float: Configurational entropy in eV/K.\n        \"\"\"\n        # For pure phases (x=0 or x=1), entropy is 0. Use tolerance for float comparison.\n        if x  1e-9 or x > (1.0 - 1e-9):\n            return 0.0\n        \n        return -k_B * N_sites * (x * np.log(x) + (1 - x) * np.log(1 - x))\n\n    def calculate_G_host(x, T):\n        \"\"\"\n        Calculates the Gibbs free energy G(x, T) for the host material.\n        \n        Args:\n            x (float): Lithium fraction.\n            T (float): Temperature in Kelvin.\n            \n        Returns:\n            float: Gibbs free energy in eV.\n        \"\"\"\n        E_dft = E_dft_host[x]\n        freqs = freqs_host[x]\n        \n        F_vib = calculate_F_vib(T, freqs)\n        S_conf = calculate_S_conf(x)\n        \n        return E_dft + F_vib - T * S_conf\n\n    def calculate_mu_li(T):\n        \"\"\"\n        Calculates the chemical potential mu(T) for lithium metal.\n\n        Args:\n            T (float): Temperature in Kelvin.\n\n        Returns:\n            float: Chemical potential of Li metal in eV/atom.\n        \"\"\"\n        F_vib = calculate_F_vib(T, freqs_li)\n        # S_conf for a pure element is 0.\n        return E_dft_li + F_vib\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (300, 0.0, 0.5),   # Case 1\n        (1, 0.0, 0.5),     # Case 2\n        (1000, 0.5, 1.0),  # Case 3\n        (300, 0.95, 1.0),  # Case 4\n    ]\n\n    results = []\n    for T, x2, x1 in test_cases:\n        # Calculate Gibbs free energies for the host at initial and final compositions\n        G_host_x1 = calculate_G_host(x1, T)\n        G_host_x2 = calculate_G_host(x2, T)\n        \n        # Calculate the chemical potential of the Li reservoir\n        mu_li_T = calculate_mu_li(T)\n        \n        # Calculate the change in Gibbs free energy for the reaction\n        delta_x = x1 - x2\n        delta_G = G_host_x1 - G_host_x2 - delta_x * mu_li_T\n        \n        # Calculate the voltage\n        voltage = -delta_G / delta_x\n        \n        # Round to six decimal places as specified\n        results.append(round(voltage, 6))\n\n    # Format the final list of results into the required output string.\n    # Using .6f ensures that numbers like 2.0 are printed as 2.000000.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}