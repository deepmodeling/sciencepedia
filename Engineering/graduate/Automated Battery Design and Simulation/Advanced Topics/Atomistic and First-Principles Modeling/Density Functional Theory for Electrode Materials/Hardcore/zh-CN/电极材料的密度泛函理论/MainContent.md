## 引言
[密度泛函理论](@entry_id:139027)（DFT）作为现代计算材料科学的基石，为从原子尺度理解和设计新型[电极材料](@entry_id:199373)提供了前所未有的强大工具。随着对更高能量密度、更快充放电速率和更长[循环寿命](@entry_id:275737)储能设备的需求日益迫切，深入掌握DFT以指导材料研发变得至关重要。然而，在理论的量子力学基础与复杂的实际应用之间存在着一道认知鸿沟，使得研究人员难以充分利用这一工具。本文旨在系统地弥合这一鸿沟，为读者构建一个从基础原理到前沿应用的完整知识体系。

在接下来的内容中，我们将分三大部分展开：第一章“原理与机制”将深入剖析DFT的核心理论，包括[Hohenberg-Kohn定理](@entry_id:139793)、[Kohn-Sham方法](@entry_id:263733)，以及处理自相互作用误差和范德华力等关键挑战的实用[近似方案](@entry_id:267451)。第二章“应用与交叉学科联系”将展示DFT如何用于预测电极材料的[热力学稳定性](@entry_id:142877)、电化学电压、离子扩散动力学以及与力学和数据科学等领域的交叉应用。最后，在“动手实践”部分，我们将通过具体的计算问题，巩固理论知识并培养解决实际问题的能力。通过这一结构化的学习路径，读者将能够全面掌握使用DFT进行电极材料研究的核心技能。

## 原理与机制

本章旨在深入阐述[密度泛函理论](@entry_id:139027)（Density Functional Theory, DFT）应用于电极材料研究的核心科学原理与关键计算机制。我们将从其量子力学基础出发，逐步构建起一个从抽象理论到实际计算，再到误差修正的完整知识框架。我们将系统地探讨DFT如何成为预测和理解[电极材料](@entry_id:199373)性能（如嵌锂电压、[离子扩散](@entry_id:1126715)和稳定性）的强大工具，同时揭示其在实际应用中遇到的挑战及相应的先进解决方案。

### DFT的基石：[Hohenberg-Kohn定理](@entry_id:139793)

密度泛函理论的合法性根植于两项深刻的定理，即由Pierre Hohenberg和[Walter Kohn](@entry_id:1133945)于1964年提出的**Hohenberg-Kohn (HK) 定理**。这些定理革命性地指出，一个多电子体系的基态性质完全由其基态电子密度 $n_0(\mathbf{r})$ 唯一确定。这使得电子密度——一个仅依赖于三个空间坐标的函数——取代了极其复杂的、依赖于所有电子坐标的[多体波函数](@entry_id:203043)，成为描述系统的基本变量。

**第一[Hohenberg-Kohn定理](@entry_id:139793)**断言，对于一个给定的非简并基态，其电子密度 $n_0(\mathbf{r})$ 唯一地确定了系统所处的外界势 $v_{\text{ext}}(\mathbf{r})$（最多相差一个无关紧要的常数）。由于[哈密顿量](@entry_id:144286)由动能、电子间相互作用和外界势完全定义，而前两者对于任何电子系统都是普适的，因此 $n_0(\mathbf{r})$ 也就唯一确定了整个系统的[哈密顿量](@entry_id:144286)，进而确定了包括[多体波函数](@entry_id:203043)在内的所有基态性质。

该定理的证明是一个优雅的“[反证法](@entry_id:276604)”（reductio ad absurdum），其根基是量子力学中的**[瑞利-里兹变分原理](@entry_id:185834)**。考虑一个晶体[电极材料](@entry_id:199373)，其电子在周期性外势（由原子核阵列产生）中运动。假设存在两个不同的、不只相差一个常数的周期性外势 $v(\mathbf{r})$ 和 $v'(\mathbf{r})$，它们却“意外地”对应着完全相同的基[态密度](@entry_id:147894) $n_0(\mathbf{r})$。设其对应的哈密顿量分别为 $\hat{H}$ 和 $\hat{H}'$，基态[波函数](@entry_id:201714)为 $\Psi_0$ 和 $\Psi'_0$，基态能量为 $E_v$ 和 $E_{v'}$。根据变分原理，将一个系统的基态[波函数](@entry_id:201714)作为另一个系统的[试探波函数](@entry_id:142892)，其[能量期望值](@entry_id:174035)必然严格大于后者的基态能量。这会导出两个不等式：$E_v < E_{v'} + \int n_0(\mathbf{r}) (v(\mathbf{r}) - v'(\mathbf{r})) d\mathbf{r}$ 和 $E_{v'} < E_v + \int n_0(\mathbf{r}) (v'(\mathbf{r}) - v(\mathbf{r})) d\mathbf{r}$。将这两个不等式相加，将得到一个明显的逻辑矛盾 $E_v + E_{v'} < E_v + E_{v'}$。这个矛盾证明了我们的初始假设是错误的，因此从基[态密度](@entry_id:147894)到外势的映射必须是唯一的。这一结论对于简并基态，通过系综密度的概念进行推广后依然成立，为DFT在真实晶体材料中的应用奠定了坚实的理论基础 。

**第二[Hohenberg-Kohn定理](@entry_id:139793)**则建立了一个关于能量的变分原理。它指出，存在一个**[普适泛函](@entry_id:140176)** $F[n]$，它仅依赖于电子密度 $n$，而与具体的外势 $v_{\text{ext}}$ 无关。这个泛函包含了系统的动能和电子间[相互作用能](@entry_id:264333)。对于一个给定的外势 $v(\mathbf{r})$，包含该外势的总能量泛函为 $E_v[n] = F[n] + \int n(\mathbf{r})v(\mathbf{r})d\mathbf{r}$。该定理断言，对于真实的基[态密度](@entry_id:147894) $n_0(\mathbf{r})$，这个泛函的取值达到其最小值，即真实的基态能量。这意味着我们可以通过在所有满足条件的密度中搜寻使能量[泛函最小化](@entry_id:184561)的那个密度，来确定系统的基[态密度](@entry_id:147894)和基态能量。

### [Kohn-Sham方法](@entry_id:263733)：实用的计算框架

尽管HK定理在理论上极为强大，但[普适泛函](@entry_id:140176) $F[n]$ 的具体形式是未知的。特别是其中的动能部分 $T[n]$ 难以精确表达为密度的泛函。1965年，[Walter Kohn](@entry_id:1133945)和Lu Jeu Sham提出了一个巧妙的解决方案，即**Kohn-Sham (KS) 方法**。

KS方法的核心思想是，构建一个虚拟的、无相互作用的电子系统，使其具有与真实相互作用系统完全相同的基态电子密度 $n(\mathbf{r})$。对于这样一个无相互作用的系统，其动能可以精确地写成单[电子轨道](@entry_id:157718) $\phi_i$ 的函数：$T_s[n] = \sum_i \langle \phi_i | -\frac{\hbar^2}{2m}\nabla^2 | \phi_i \rangle$。

通过这种方式，真实系统的总能量泛函可以被重新分解为：
$$ E[n] = T_s[n] + E_{\text{ext}}[n] + E_{\text{H}}[n] + E_{\text{xc}}[n] $$
这里，$T_s[n]$ 是[无相互作用系统](@entry_id:143064)的动能，$E_{\text{ext}}[n] = \int v_{\text{ext}}(\mathbf{r}) n(\mathbf{r}) d\mathbf{r}$ 是外势能，$E_{\text{H}}[n] = \frac{1}{2} \iint \frac{n(\mathbf{r})n(\mathbf{r'})}{|\mathbf{r}-\mathbf{r'}|} d\mathbf{r} d\mathbf{r'}$ 是电子密度的经典静电排斥能（哈特里能）。所有复杂的、难以处理的量子[多体效应](@entry_id:173569)，包括真实动能与无相互作用动能之差、以及所有非经典的交换和关联效应，都被归入了一个新的项——**交换关联泛函** $E_{\text{xc}}[n]$。

将变分原理应用于这个能量表达式，可以导出一组类似于单[电子薛定谔方程](@entry_id:177999)的**[Kohn-Sham方程](@entry_id:143968)**：
$$ \left( -\frac{\hbar^2}{2m}\nabla^2 + v_{\text{eff}}(\mathbf{r}) \right) \phi_i(\mathbf{r}) = \varepsilon_i \phi_i(\mathbf{r}) $$
其中，[有效势](@entry_id:1124192) $v_{\text{eff}}(\mathbf{r}) = v_{\text{ext}}(\mathbf{r}) + v_{\text{H}}(\mathbf{r}) + v_{\text{xc}}(\mathbf{r})$，而交换关联势 $v_{\text{xc}}(\mathbf{r})$ 是交换关联能对密度的泛函导数。这些方程可以通过自洽迭代的方式求解，从而得到系统的基态密度和总能量。

KS方法的巨大成功在于，它将最困难的部分隔离在 $E_{\text{xc}}[n]$ 之中。虽然 $E_{\text{xc}}[n]$ 的精确形式仍然未知，但我们可以为其构建一系列越来越精确的近似。

### 交换关联泛函的近似：“[雅各布天梯](@entry_id:139901)”

DFT的实践核心在于为交换关联泛函 $E_{\text{xc}}[n]$ 寻找好的近似。物理学家John Perdew形象地将其比喻为一座通往“[化学精度](@entry_id:171082)天堂”的“[雅各布天梯](@entry_id:139901)”，每一级代表一种更复杂、但通常也更准确的泛函形式。

最简单的近似是**[局域密度近似](@entry_id:138982)（Local Density Approximation, [LDA](@entry_id:138982)）**，它假设在空间的每一点，交换关联能密度与具有相同密度的[均匀电子气](@entry_id:195006)相同。更高一级是**[广义梯度近似](@entry_id:274118)（Generalized Gradient Approximation, GGA）**，如著名的PBE (Perdew-Burke-Ernzerhof) 泛函，它不仅考虑了电子密度本身，还考虑了其梯度 $\nabla n(\mathbf{r})$，从而更好地描述了非均匀电子系统。

不同泛函的选择对计算结果有显著影响。例如，在一个模拟项目中，我们需要评估不同泛函对[电极材料](@entry_id:199373)关键性能的预测能力。假设我们使用三种泛函——PBE、PBEsol（为固体优化的PBE）和SCAN（一种[元-GGA泛函](@entry_id:177894)）——来研究一种立方结构的主体材料。研究发现，它们会给出不同的[晶格常数](@entry_id:158935) $a$ 和表面能 $\gamma$ 的预测值。这些看似微小的差异会通过物理模型显著传递到对电池性能的宏观预测上。例如，嵌锂电压 $V$ 与嵌锂[反应能](@entry_id:143747) $\Delta E$ 直接相关（$V \approx -\Delta E/e$），而 $\Delta E$ 包含体相能量和表面能的贡献。对于纳米颗粒电极，其[表面积与体积之比](@entry_id:140511)很大，表面能的差异会显著影响电压。同样，离子在[晶格](@entry_id:148274)中的[迁移势垒](@entry_id:187095) $E_m$ 对原子间的距离（即晶格常数）非常敏感。因此，PBE、PBEsol和SCAN因其对[晶格常数](@entry_id:158935)和表面能的不同预测，将导致对同一种材料的嵌锂电压和离子迁移势垒给出不同的定量结果。这凸显了在自动化材料筛选工作流程中，明智地选择或评估不同泛函的必要性 。

### [核心电子](@entry_id:141520)的挑战：赝势与[PAW方法](@entry_id:753811)

对于含有[重元素](@entry_id:272514)的[电极材料](@entry_id:199373)（如[过渡金属氧化物](@entry_id:1133348)），将所有电子（包括[深能级](@entry_id:1123476)的[核心电子](@entry_id:141520)和浅能级的价电子）都纳入计算是极其昂贵的。[核心电子](@entry_id:141520)紧密束缚在原子核周围，几乎不参与化学成键。因此，一个有效的简化是引入**[赝势](@entry_id:170389)（Pseudopotential）** 的概念，用一个平滑的有效势来替代原子核和[核心电子](@entry_id:141520)，这个[有效势](@entry_id:1124192)只作用于价电子，但在原子核区域之外精确地再现了真实势对价电子的散射性质。

在[平面波基组](@entry_id:178287)的计算中，主要有三种处理[核心电子](@entry_id:141520)的方法，它们在精度、[计算效率](@entry_id:270255)和“可移植性”（transferability）之间做出了不同的权衡。可移植性指的是一个赝势在不同化学环境（如不同配位数、[键长](@entry_id:144592)或[氧化态](@entry_id:151011)）下再现[全电子计算](@entry_id:170546)结果的准确程度。

1.  **模守恒[赝势](@entry_id:170389)（Norm-Conserving Pseudopotentials, NC-PPs）**：这类[赝势](@entry_id:170389)要求在核心半径内，赝[波函数](@entry_id:201714)的归一化积分（模）与全电子[波函数](@entry_id:201714)完全相同。这个严格的条件使得势函数比较“硬”，需要很高的[平面波截断能](@entry_id:753474) $E_{\text{cut}}$ 才能精确描述，计算成本较高。

2.  **[超软赝势](@entry_id:144509)（Ultrasoft Pseudopotentials, USPPs）**：为了降低计算成本，USPPs放宽了模守恒的约束。这使得势函数变得非常“软”，大大降低了所需的 $E_{\text{cut}}$。其代价是在核心区域内引入了“电荷亏损”，需要通过额外的增广电荷来补偿。这通常会牺牲一定的可移植性。

3.  **[投影缀加波方法](@entry_id:753811)（Projector Augmented-Wave, PAW）**：[PAW方法](@entry_id:753811)被认为是目前最精确和鲁棒的方法之一。它提供了一个精确的线性变换，可以从计算上更易于处理的平滑赝[波函数](@entry_id:201714) $\tilde{\psi}_n$ 重构出物理上正确的全电子[波函数](@entry_id:201714) $\psi_n$。

在计算[电极材料](@entry_id:199373)中（如[层状氧化物](@entry_id:1127114) $\text{LiMO}_2$）的锂[离子迁移](@entry_id:260704)势垒时，可移植性至关重要。因为在离子从一个格点跳到另一个格点的过程中，尤其是在能量最高的鞍点位置，其周围的化学环境（如过渡金属-氧的配位数和键长）会发生显著变化。[PAW方法](@entry_id:753811)由于其能够精确重构原子核附近的全电子信息，通常能最可靠地处理这种环境变化，提供最准确的势垒预测。相比之下，NC-PPs虽然也可以很精确，但通常需要极高的[截断能](@entry_id:177594)，而USPPs则可能对环境变化更敏感，存在引入误差的风险 。

[PAW方法](@entry_id:753811)的精度来源于其独特的[电荷密度](@entry_id:144672)重构机制。总的全电子电荷密度 $n(\mathbf{r})$ 是通过以下公式获得的：
$$ n(\mathbf{r}) = \tilde{n}(\mathbf{r}) + \sum_a \left( n_a(\mathbf{r}) - \tilde{n}_a(\mathbf{r}) \right) $$
这里的 $\tilde{n}(\mathbf{r})$ 是由平滑的赝[波函数](@entry_id:201714)在整个计算单元中计算得到的平滑赝密度。这个密度在原子间区域是准确的，但在原子核附近的缀加球（augmentation sphere）内则不准确。为了修正这一点，对每个原子 $a$，我们加上其正确的、根据全电子分[波函数](@entry_id:201714)计算出的“单中心”密度 $n_a(\mathbf{r})$，同时减去其不正确的、根据赝分[波函数](@entry_id:201714)计算出的“单中心”赝密度 $\tilde{n}_a(\mathbf{r})$。这个“加一减一”的操作确保了在缀加球内部，不准确的赝密度贡献被精确的全电子密度所取代，而在球外，密度仍然由平滑的赝密度描述。正是这种精巧的重构方案，使得[PAW方法](@entry_id:753811)在保持[计算效率](@entry_id:270255)的同时，达到了接近[全电子计算](@entry_id:170546)的精度 。

### 近似泛函的系统性误差及其修正

尽管DFT取得了巨大成功，但基于[LDA](@entry_id:138982)和GGA等近似泛函的计算会引入一些系统性误差，这在研究[过渡金属氧化物](@entry_id:1133348)等强关联[电极材料](@entry_id:199373)时尤为突出。

#### [自相互作用误差](@entry_id:260813) (Self-Interaction Error, SIE)

物理上，一个电子不应该感受到由它自身产生的[静电场](@entry_id:268546)（哈特里场）。在精确的DFT中，交换关联泛函 $E_{\text{xc}}$ 会完美地抵消掉这种虚假的**[自相互作用](@entry_id:201333)**。然而，[LDA](@entry_id:138982)和GGA等局域或半局域泛函无法实现这种精确抵消。这种残留的[自相互作用](@entry_id:201333)被称为**自相互作用误差（SIE）**。

SIE导致了严重的后果。首先，它会使得本应定域在特定原子（如过渡金属的 $d$ 轨道）上的电子趋向于在多个原子间过度地“离域”或“涂抹开”，这被称为**[离域误差](@entry_id:166117)**。其次，它破坏了总能量随电子数变化的正确[分段线性](@entry_id:201467)行为，导致能量对分数电子数呈现出错误的凸函数依赖关系。这使得DFT难以正确描述电荷转移和氧化还原过程，并通常会严重低估材料的[带隙](@entry_id:138445)。

我们可以设计一个基于密度的诊断工具来量化SIE的严重程度。考虑向体系中一个目标局域轨道（如一个过渡金属 $d$ 轨道）加入一个微小的分数电子电荷，其密度为 $n_L(\mathbf{r})$。该[电荷分布](@entry_id:144400)自身产生的虚假自相互作用能可以通过计算其自身的哈特里势 $v_{\text{H}}[n_L]$ 和交换关联势 $v_{\text{xc}}[n_L]$ 来评估。一个量化SIE的指标可以是：
$$ D_{\text{SIE}} = \int n_L(\mathbf{r})\left[v_{\text{H}}[n_L](\mathbf{r}) + v_{\text{xc}}[n_L](\mathbf{r})\right] d\mathbf{r} $$
对于近似泛函，这个值通常是正的，其大小反映了该局域电荷所经受的虚假排斥能的强度，从而量化了SIE的严重性 。

#### 修正SIE：[DFT+U](@entry_id:142114), 混合泛函与SIC

为了解决SIE问题，研究人员开发了多种修正方案。

*   **Perdew-Zunger自相互作用修正 (PZ-SIC)**：这是最直接的修正方法。它在总能量中明确地减去每个被占据轨道自身的哈特里能和近似交换关联能。这导致产生一个依赖于轨道的有效势：
    $$ v_i^{\text{SIC}}(\mathbf{r}) = v_{\text{eff}}(\mathbf{r}) - \left( v_{\text{H}}[n_i](\mathbf{r}) + v_{\text{xc}}[n_i](\mathbf{r}) \right) $$
    其中 $n_i$ 是轨道 $\phi_i$ 的密度。这个修正项倾向于将局域化轨道的能量向更深处（更负）移动。在计算嵌锂电压时，由于电压与接受电子的能级能量直接相关，这种能级的下移通常会导致预测的电压升高，从而更接近实验值 。

*   **[DFT+U](@entry_id:142114) 方法**：这是一种计算上高效且广泛应用的修正方法，尤其适用于[过渡金属氧化物](@entry_id:1133348)。它在标准的DFT能量上增加一个类似哈伯德模型的在位库仑相互作用项 $E_U$。在Dudarev等人提出的旋转不变形式中，该修正项为：
    $$ E_U = \frac{U_{\text{eff}}}{2} \sum_{\sigma} \mathrm{Tr}[n^{\sigma}(1-n^{\sigma})] $$
    其中 $n^{\sigma}$ 是特定原子上关联轨道（如 $d$ 轨道）的自旋占据数矩阵，$U_{\text{eff}}$ 是一个有效库仑参数。这个能量项惩罚了分数占据（当占据数在0和1之间时，$n(1-n)>0$），从而驱动电子占据趋向于整数（0或1），促进了电荷的局域化。在脱锂过程中，过渡金属被氧化，其 $d$ 轨道占据数变得更具分数特征。$+U$ 修正会不成比例地提高这个被[氧化态](@entry_id:151011)的能量，从而增大了脱锂[反应能](@entry_id:143747)，最终导致预测的脱锂电压升高 。

*   **混合泛函 (Hybrid Functionals)**：这是一种更为“第一性原理”的修正方法。它在交换关联泛函中“混合”了一定比例 $\alpha$ 的精确（但非局域的）[Hartree-Fock交换](@entry_id:275042)能：
    $$ E_{\text{xc}}^{\text{hybrid}} = \alpha E_{x}^{\text{HF}} + (1-\alpha) E_{x}^{\text{semilocal}} + E_{c}^{\text{semilocal}} $$
    通过引入精确交换，混合泛函可以显著减轻SIE，从而更准确地描述能带[带隙](@entry_id:138445)、电荷局域化和[极化子](@entry_id:191083)（polaron）的形成。对于具有窄 $d$ 带的过渡金属氧化物，电子-[晶格](@entry_id:148274)耦合效应强，载流子（电子或空穴）倾向于通过使周围晶格畸变来“[自陷](@entry_id:144773)”，形成**[小极化子](@entry_id:145105)**。标准的[GGA泛函](@entry_id:190164)由于其[离域误差](@entry_id:166117)，往往无法描述这种局域化现象。此时，使用混合泛函变得至关重要。相反，对于像石墨或硅这样具有宽能带和弱关联效应的共价材料，GGA通常已经能提供合理的描述，使用昂贵的混合泛函则非必要 。混合泛函中 $\alpha$ 的取值可以根据材料的介[电常数](@entry_id:272823) $\epsilon_{\infty}$（$\alpha \approx 1/\epsilon_{\infty}$）来物理地确定，这通常能改善对[带隙](@entry_id:138445)和极化子稳定性的预测。但过大的 $\alpha$ 值也可能导致过度局域化，高估极化子的结合能  。

#### [范德华相互作用](@entry_id:168429)的挑战

除了SIE，半局域泛函还忽略了另一类重要的关联效应：**长程范德华（van der Waals, vdW）力**或色散力。这种力来源于瞬时电荷涨落导致的[偶极相互作用](@entry_id:193339)，对于由[弱相互作用](@entry_id:157579)堆叠而成的层状材料（如[石墨负极](@entry_id:269569)）的层间结合至关重要。

目前有两种主流的vdW修正方案：
1.  **[DFT-D方法](@entry_id:1135698)**（如Grimme的D3修正）：这是一种后处理修正方法，它在[DFT计算](@entry_id:1123635)的总能量上直接添加一个基于原子对的、经验[参数化](@entry_id:265163)的[色散能](@entry_id:261481)项 $E_{\text{disp}}$。
2.  **非局域vd[W泛函](@entry_id:197753)（[vdW-DF](@entry_id:203596)）**：这是一种更符合第一性原理的方法，它直接将非局域的关联项 $E_c^{\text{nl}}[n]$ 整合到交换关联泛函的构造中。

这两种方法对层间[结合能](@entry_id:143405)的预测可能存在差异。例如，在研究石墨时，它们可能给出不同的层间解理能 $\gamma$。这个差异会直接影响嵌锂过程的能量计算。锂离子嵌入石墨时，需要撑开石墨烯层，其能量代价与解理能 $\gamma$ 成正比。因此，一个预测了较小 $\gamma$ 值的泛函（如[vdW-DF](@entry_id:203596)）会计算出较低的嵌锂“膨胀”惩罚能，从而使得嵌锂产物更稳定，预测的嵌锂电压也相应更高。这种效应会随着不同锂化阶段（如 $\text{LiC}_{12}$ vs. $\text{LiC}_6$）而变化，从而影响对整个充放电曲线的预测 。

#### 描述局域态：极化子与约束DFT

如前所述，[小极化子](@entry_id:145105)的形成是电荷局域化与[晶格畸变](@entry_id:1127106)耦合的结果，它对应于一个自洽的、**对称性破缺**的解。在DFT计算中，这意味着电子密度和原子坐标会自发地破坏[晶格](@entry_id:148274)的平移对称性，将电荷和畸变集中在某个特定的原子位点上 。

由于SIE，标准的[自洽场](@entry_id:136549)计算可能难以收敛到这个物理上正确的、能量更低的局域化（极化子）解，而错误地停留在能量更高、非物理的[离域](@entry_id:183327)解上。除了使用[DFT+U](@entry_id:142114)或混合泛函来从能量上偏袒局域解之外，还可以使用一种更直接的技术——**约束DFT（Constrained DFT, cDFT）**。

cDFT通过在能量泛函中引入一个额外的惩罚项或拉格朗日乘子项，来强制体系的电子占据数满足特定的局域约束。例如，为了将一个空穴稳定在某个特定的过渡金属位点 $I$ 上，我们可以增加一个二次惩罚项：
$$ E \rightarrow E + \frac{\alpha}{2} \left( N_I - N_I^{\text{target}} \right)^2 $$
其中 $N_I$ 是通过投影算符计算出的位点 $I$ 上 $d$ 轨道的实际电子占据数，$N_I^{\text{target}}$ 是我们想要的目标占据数（例如，比中性态少一个电子以代表空穴），$\alpha$ 是控制约束强度的参数。这个惩罚项会在KS[有效势](@entry_id:1124192)中引入一个额外的、依赖于占据数的项，从而在自洽迭代过程中引导电子密度向我们期望的局域化状态收敛。这是一个强大的工具，用于寻找和研究在标准计算中难以获得的亚稳态或对称性破缺的解，如[小极化子](@entry_id:145105)态 。