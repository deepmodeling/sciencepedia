{
    "hands_on_practices": [
        {
            "introduction": "电池包由许多单独的电芯组成，因此，理解单个电芯的参数变化如何汇集并影响整个电池包的性能至关重要。本练习从基本概率论出发，推导独立随机变量之和的方差公式，这是将分析从单个电芯扩展到整个电池包的第一步。通过解决这个问题，您将掌握一项基础统计技能，即如何根据已知制造差异的电芯来量化电池模组或电池包的整体性能离散度。",
            "id": "3899181",
            "problem": "一种自动化电池包设计算法在并联聚合锂离子电芯时，对电芯间的容量离散进行建模。设电芯 $i$ 的容量为一个随机变量 $C_{i}$，其均值 $\\mu_{i} = \\mathbb{E}[C_{i}]$ 和方差 $\\sigma_{i}^{2} = \\mathrm{Var}(C_{i})$ 均为有限值。电芯被组装成一个并联模块，其总容量为随机和 $C_{\\mathrm{tot}} = \\sum_{i=1}^{N} C_{i}$。假设由于不同批次间制造差异不相关，所有电芯都是相互独立的。仅从基本定义 $\\mathbb{E}[X]$、$\\mathrm{Var}(X) = \\mathbb{E}[X^{2}] - (\\mathbb{E}[X])^{2}$ 以及独立性定义（对于独立的 $X$ 和 $Y$，有 $\\mathbb{E}[XY] = \\mathbb{E}[X]\\mathbb{E}[Y]$）出发，推导出用 $\\{\\sigma_{i}^{2}\\}_{i=1}^{N}$ 表示 $\\mathrm{Var}\\!\\left(C_{\\mathrm{tot}}\\right)$ 的表达式。\n\n接着，考虑一个由三个制造批次的电芯组成的 $N$ 电芯并联模块，每个批次内的电芯都是独立的：\n- 批次 A：$n_{A} = 5$ 个电芯，每个电芯的平均容量为 $\\mu_{A} = 3.00$ A·h，标准差为 $\\sigma_{A} = 0.05$ A·h。\n- 批次 B：$n_{B} = 4$ 个电芯，每个电芯的平均容量为 $\\mu_{B} = 3.10$ A·h，标准差为 $\\sigma_{B} = 0.08$ A·h。\n- 批次 C：$n_{C} = 3$ 个电芯，每个电芯的平均容量为 $\\mu_{C} = 2.95$ A·h，标准差为 $\\sigma_{C} = 0.04$ A·h。\n\n假设所有 $n_{A} + n_{B} + n_{C}$ 个电芯在批次之间和批次内部都相互独立。使用你推导出的表达式，计算该聚合并联模块的变异系数 (CV)，其定义为 $\\mathrm{CV} = \\sigma_{\\mathrm{tot}}/\\mu_{\\mathrm{tot}}$，其中 $\\mu_{\\mathrm{tot}} = \\mathbb{E}[C_{\\mathrm{tot}}]$ 且 $\\sigma_{\\mathrm{tot}} = \\sqrt{\\mathrm{Var}(C_{\\mathrm{tot}})}$。\n\n将变异系数的最终数值结果四舍五入到四位有效数字，并以不带单位的纯小数形式表示。",
            "solution": "该问题是有效的。它在科学上基于应用于工程领域的概率论，问题提法明确，提供了所有必要信息，并且陈述客观。\n\n该问题包含两部分。首先，我们必须推导出一个相互独立随机变量之和的方差表达式。其次，我们必须将这个结果应用于一个涉及并联电池模块的具体数值示例。\n\n让我们从推导开始。给定一组 $N$ 个相互独立的随机变量 $\\{C_{i}\\}_{i=1}^{N}$，其中 $C_{i}$ 表示电芯 $i$ 的容量。每个随机变量的均值为 $\\mu_{i} = \\mathbb{E}[C_{i}]$，方差为 $\\sigma_{i}^{2} = \\mathrm{Var}(C_{i})$。并联模块的总容量是和 $C_{\\mathrm{tot}} = \\sum_{i=1}^{N} C_{i}$。我们需要求出 $\\mathrm{Var}(C_{\\mathrm{tot}})$。\n\n我们从题目给出的方差基本定义开始：\n$$\n\\mathrm{Var}(C_{\\mathrm{tot}}) = \\mathbb{E}[C_{\\mathrm{tot}}^{2}] - (\\mathbb{E}[C_{\\mathrm{tot}}])^{2}\n$$\n\n首先，我们计算总容量的期望值 $\\mathbb{E}[C_{\\mathrm{tot}}]$。根据期望算子的线性性质：\n$$\n\\mathbb{E}[C_{\\mathrm{tot}}] = \\mathbb{E}\\left[\\sum_{i=1}^{N} C_{i}\\right] = \\sum_{i=1}^{N} \\mathbb{E}[C_{i}] = \\sum_{i=1}^{N} \\mu_{i}\n$$\n\n接下来，我们计算总容量平方的期望值 $\\mathbb{E}[C_{\\mathrm{tot}}^{2}]$。我们展开这个和的平方：\n$$\nC_{\\mathrm{tot}}^{2} = \\left(\\sum_{i=1}^{N} C_{i}\\right)^{2} = \\left(\\sum_{i=1}^{N} C_{i}\\right)\\left(\\sum_{j=1}^{N} C_{j}\\right) = \\sum_{i=1}^{N} \\sum_{j=1}^{N} C_{i}C_{j}\n$$\n我们可以将此和式分为指数相等 ($i=j$) 的项和指数不相等 ($i \\neq j$) 的项：\n$$\nC_{\\mathrm{tot}}^{2} = \\sum_{i=1}^{N} C_{i}^{2} + \\sum_{i \\neq j} C_{i}C_{j}\n$$\n现在，我们对此表达式应用期望算子。利用其线性性质：\n$$\n\\mathbb{E}[C_{\\mathrm{tot}}^{2}] = \\mathbb{E}\\left[\\sum_{i=1}^{N} C_{i}^{2} + \\sum_{i \\neq j} C_{i}C_{j}\\right] = \\sum_{i=1}^{N} \\mathbb{E}[C_{i}^{2}] + \\sum_{i \\neq j} \\mathbb{E}[C_{i}C_{j}]\n$$\n问题陈述所有电芯是相互独立的。如问题中所给出的，其一个推论是，对于任意两个不同的独立随机变量 $C_{i}$ 和 $C_{j}$（其中 $i \\neq j$），我们有 $\\mathbb{E}[C_{i}C_{j}] = \\mathbb{E}[C_{i}]\\mathbb{E}[C_{j}] = \\mu_{i}\\mu_{j}$。将此代入我们关于 $\\mathbb{E}[C_{\\mathrm{tot}}^{2}]$ 的表达式中：\n$$\n\\mathbb{E}[C_{\\mathrm{tot}}^{2}] = \\sum_{i=1}^{N} \\mathbb{E}[C_{i}^{2}] + \\sum_{i \\neq j} \\mu_{i}\\mu_{j}\n$$\n现在我们将 $\\mathbb{E}[C_{\\mathrm{tot}}]$ 和 $\\mathbb{E}[C_{\\mathrm{tot}}^{2}]$ 的结果代回方差定义中。让我们先计算 $(\\mathbb{E}[C_{\\mathrm{tot}}])^{2}$：\n$$\n(\\mathbb{E}[C_{\\mathrm{tot}}])^{2} = \\left(\\sum_{i=1}^{N} \\mu_{i}\\right)^{2} = \\sum_{i=1}^{N} \\mu_{i}^{2} + \\sum_{i \\neq j} \\mu_{i}\\mu_{j}\n$$\n所以，方差为：\n$$\n\\mathrm{Var}(C_{\\mathrm{tot}}) = \\left(\\sum_{i=1}^{N} \\mathbb{E}[C_{i}^{2}] + \\sum_{i \\neq j} \\mu_{i}\\mu_{j}\\right) - \\left(\\sum_{i=1}^{N} \\mu_{i}^{2} + \\sum_{i \\neq j} \\mu_{i}\\mu_{j}\\right)\n$$\n交叉乘积项相互抵消：\n$$\n\\mathrm{Var}(C_{\\mathrm{tot}}) = \\sum_{i=1}^{N} \\mathbb{E}[C_{i}^{2}] - \\sum_{i=1}^{N} \\mu_{i}^{2} = \\sum_{i=1}^{N} \\left(\\mathbb{E}[C_{i}^{2}] - \\mu_{i}^{2}\\right)\n$$\n回顾 $\\mu_{i} = \\mathbb{E}[C_{i}]$，我们可以将其写为：\n$$\n\\mathrm{Var}(C_{\\mathrm{tot}}) = \\sum_{i=1}^{N} \\left(\\mathbb{E}[C_{i}^{2}] - (\\mathbb{E}[C_{i}])^{2}\\right)\n$$\n求和号内的项是 $C_{i}$ 的方差的定义，即 $\\mathrm{Var}(C_{i}) = \\sigma_{i}^{2}$。因此，我们得到了独立随机变量之和的方差的最终表达式：\n$$\n\\mathrm{Var}(C_{\\mathrm{tot}}) = \\sum_{i=1}^{N} \\sigma_{i}^{2}\n$$\n这就是著名的 Bienaymé 公式，我们已经按要求从第一性原理推导出来了。\n\n现在，我们进行问题的第二部分：为一个特定的并联模块计算变异系数 (CV)。该模块由来自三个批次的电芯组成：\n- 批次 A：$n_{A} = 5$ 个电芯，$\\mu_{A} = 3.00$，$\\sigma_{A} = 0.05$。方差为 $\\sigma_{A}^{2} = (0.05)^{2} = 0.0025$。\n- 批次 B：$n_{B} = 4$ 个电芯，$\\mu_{B} = 3.10$，$\\sigma_{B} = 0.08$。方差为 $\\sigma_{B}^{2} = (0.08)^{2} = 0.0064$。\n- 批次 C：$n_{C} = 3$ 个电芯，$\\mu_{C} = 2.95$，$\\sigma_{C} = 0.04$。方差为 $\\sigma_{C}^{2} = (0.04)^{2} = 0.0016$。\n\n电芯总数为 $N = n_{A} + n_{B} + n_{C} = 5 + 4 + 3 = 12$。所有 12 个电芯都相互独立。\n\n首先，我们计算总平均容量 $\\mu_{\\mathrm{tot}} = \\mathbb{E}[C_{\\mathrm{tot}}]$。利用期望的线性性质，总均值是个体均值的总和：\n$$\n\\mu_{\\mathrm{tot}} = n_{A}\\mu_{A} + n_{B}\\mu_{B} + n_{C}\\mu_{C}\n$$\n$$\n\\mu_{\\mathrm{tot}} = 5(3.00) + 4(3.10) + 3(2.95) = 15.00 + 12.40 + 8.85 = 36.25 \\text{ A·h}\n$$\n接下来，我们计算总方差 $\\mathrm{Var}(C_{\\mathrm{tot}})$。使用我们推导出的公式，总方差是个体方差的总和：\n$$\n\\mathrm{Var}(C_{\\mathrm{tot}}) = \\sum_{i=1}^{N} \\sigma_{i}^{2} = n_{A}\\sigma_{A}^{2} + n_{B}\\sigma_{B}^{2} + n_{C}\\sigma_{C}^{2}\n$$\n$$\n\\mathrm{Var}(C_{\\mathrm{tot}}) = 5(0.0025) + 4(0.0064) + 3(0.0016)\n$$\n$$\n\\mathrm{Var}(C_{\\mathrm{tot}}) = 0.0125 + 0.0256 + 0.0048 = 0.0429 \\text{ (A·h)}^{2}\n$$\n总标准差是总方差的平方根：\n$$\n\\sigma_{\\mathrm{tot}} = \\sqrt{\\mathrm{Var}(C_{\\mathrm{tot}})} = \\sqrt{0.0429} \\text{ A·h}\n$$\n变异系数 (CV) 定义为总标准差与总均值的比率：\n$$\n\\mathrm{CV} = \\frac{\\sigma_{\\mathrm{tot}}}{\\mu_{\\mathrm{tot}}} = \\frac{\\sqrt{0.0429}}{36.25}\n$$\n现在，我们计算其数值：\n$$\n\\mathrm{CV} \\approx \\frac{0.20712315}{36.25} \\approx 0.005713742\n$$\n问题要求将结果四舍五入到四位有效数字。第一位有效数字是 $5$，第四位是 $3$。后一位数字是 $7$，所以我们向上取整。\n$$\n\\mathrm{CV} \\approx 0.005714\n$$\n这是一个无量纲量，符合要求。",
            "answer": "$$\n\\boxed{0.005714}\n$$"
        },
        {
            "introduction": "在掌握了参数聚合的基础知识后，我们将注意力转向一个更具体的电化学模型：电化学阻抗谱（EIS）。本练习探讨了电芯内部物理参数（如电荷转移电阻 $R_{ct}$ 和双电层电容 $C_{dl}$）的离散性如何影响可观测的阻抗特征（例如奈奎斯特图上半圆的顶点频率 $f^{\\ast}$）。通过运用泰勒级数展开进行不确定性传播分析，您将学会分析模型输出对参数变化的敏感性，这对于确定哪些制造公差对确保性能一致性最为关键至关重要。",
            "id": "3899235",
            "problem": "在锂离子电池的自动化设计和仿真工作流程中，电化学阻抗谱（EIS）的高频部分通过一个Randles电路近似进行建模。该电路由一个串联的欧姆电阻 $R_{s}$ 与一个并联支路串联而成，该并联支路包含电荷转移电阻 $R_{ct}$ 和双电层电容 $C_{dl}$。在所关注的频率窗口内，扩散的贡献可以忽略不计。将我们感兴趣的阻抗特征定义为频率 $f^{\\ast}$（单位为赫兹），在该频率下，总阻抗虚部的模达到其最大值（即高频奈奎斯特半圆的顶点）。\n\n电池间的参数离散被建模为 $R_{ct}$ 和 $C_{dl}$ 中独立的、小的、零均值的相对变化：\n$$\nR_{ct} = \\mu_{R}\\left(1+\\delta_{R}\\right), \\qquad C_{dl} = \\mu_{C}\\left(1+\\delta_{C}\\right),\n$$\n其中 $\\mathbb{E}[\\delta_{R}] = 0$, $\\mathbb{E}[\\delta_{C}] = 0$, $\\mathrm{Var}(\\delta_{R}) = v_{R}^{2}$, $\\mathrm{Var}(\\delta_{C}) = v_{C}^{2}$ 且 $\\mathrm{Cov}(\\delta_{R},\\delta_{C})=0$。假设 $|\\delta_{R}| \\ll 1$ 和 $|\\delta_{C}| \\ll 1$，因此关于 $\\delta_{R}$ 和 $\\delta_{C}$ 的二阶展开是有效的。\n\n仅从电阻和电容的基本阻抗定义以及串并联组合规则出发，通过找出总阻抗虚部的模相对于角频率 $\\omega$ 的最大值位置，推导出 $f^{\\ast}$ 关于 $R_{ct}$ 和 $C_{dl}$ 的表达式。然后，使用二阶小扰动展开和上述随机模型，计算期望值 $\\mathbb{E}[f^{\\ast}]$，结果精确到 $v_{R}$ 和 $v_{C}$ 的二阶。\n\n使用参数值 $\\mu_{R} = 0.5$ 欧姆，$\\mu_{C} = 5.0 \\times 10^{-3}$ 法拉， $v_{R} = 0.10$ 以及 $v_{C} = 0.20$。将最终结果 $\\mathbb{E}[f^{\\ast}]$ 以赫兹为单位表示。角频率和频率之间的关系为 $\\omega = 2\\pi f$。将最终数值答案四舍五入至四位有效数字。",
            "solution": "该问题是有效的。它在科学上基于用于模拟电化学界面的标准Randles电路模型，并结合了不确定性传播的标准分析方法。问题定义明确，客观陈述，并提供了所有必要的信息。\n\n### 特征频率 $f^{\\ast}$ 的推导\n电阻 $R$ 的阻抗为 $Z_R = R$，电容 $C$ 在角频率 $\\omega$ 下的阻抗为 $Z_C = \\frac{1}{j\\omega C}$，其中 $j$ 是虚数单位。\n\n并联支路包含电荷转移电阻 $R_{ct}$ 和双电层电容 $C_{dl}$。其阻抗 $Z_p$ 由并联元件的规则给出：\n$$ \\frac{1}{Z_p} = \\frac{1}{Z_{R_{ct}}} + \\frac{1}{Z_{C_{dl}}} = \\frac{1}{R_{ct}} + \\frac{1}{1/(j\\omega C_{dl})} = \\frac{1}{R_{ct}} + j\\omega C_{dl} $$\n求解 $Z_p$：\n$$ Z_p = \\frac{1}{\\frac{1}{R_{ct}} + j\\omega C_{dl}} = \\frac{R_{ct}}{1 + j\\omega R_{ct} C_{dl}} $$\n为了分离实部和虚部，我们将分子和分母乘以分母的复共轭：\n$$ Z_p = \\frac{R_{ct}}{1 + j\\omega R_{ct} C_{dl}} \\cdot \\frac{1 - j\\omega R_{ct} C_{dl}}{1 - j\\omega R_{ct} C_{dl}} = \\frac{R_{ct}(1 - j\\omega R_{ct} C_{dl})}{1 - (j\\omega R_{ct} C_{dl})^2} = \\frac{R_{ct} - j\\omega R_{ct}^2 C_{dl}}{1 + \\omega^2 R_{ct}^2 C_{dl}^2} $$\n电路的总阻抗为 $Z_{total} = R_s + Z_p$：\n$$ Z_{total} = R_s + \\frac{R_{ct}}{1 + \\omega^2 R_{ct}^2 C_{dl}^2} - j \\frac{\\omega R_{ct}^2 C_{dl}}{1 + \\omega^2 R_{ct}^2 C_{dl}^2} $$\n总阻抗的虚部是：\n$$ \\mathrm{Im}(Z_{total}) = - \\frac{\\omega R_{ct}^2 C_{dl}}{1 + \\omega^2 R_{ct}^2 C_{dl}^2} $$\n问题将 $f^{\\ast}$ 定义为虚部的模（我们记为 $Y(\\omega)=|\\mathrm{Im}(Z_{total})|$）达到其最大值时的频率。\n$$ Y(\\omega) = \\frac{\\omega R_{ct}^2 C_{dl}}{1 + \\omega^2 R_{ct}^2 C_{dl}^2} $$\n为了找到最大值，我们计算 $Y(\\omega)$ 对 $\\omega$ 的导数并将其设为零。使用商法则 $\\frac{d}{dx}(\\frac{u}{v}) = \\frac{u'v - uv'}{v^2}$：\n$$ \\frac{dY}{d\\omega} = \\frac{(R_{ct}^2 C_{dl})(1 + \\omega^2 R_{ct}^2 C_{dl}^2) - (\\omega R_{ct}^2 C_{dl})(2\\omega R_{ct}^2 C_{dl}^2)}{(1 + \\omega^2 R_{ct}^2 C_{dl}^2)^2} = 0 $$\n要使导数为零，分子必须为零（假设分母不为零）：\n$$ R_{ct}^2 C_{dl} (1 + \\omega^2 R_{ct}^2 C_{dl}^2) - 2\\omega^2 R_{ct}^4 C_{dl}^3 = 0 $$\n因为 $R_{ct} > 0$ 和 $C_{dl} > 0$，我们可以用 $R_{ct}^2 C_{dl}$ 来除：\n$$ 1 + \\omega^2 R_{ct}^2 C_{dl}^2 - 2\\omega^2 R_{ct}^2 C_{dl}^2 = 0 $$\n$$ 1 - \\omega^2 R_{ct}^2 C_{dl}^2 = 0 $$\n这给出了最大值处的角频率 $\\omega^{\\ast}$：\n$$ \\omega^{\\ast} = \\frac{1}{R_{ct} C_{dl}} $$\n使用关系式 $\\omega = 2\\pi f$，特征频率 $f^{\\ast}$ 为：\n$$ f^{\\ast} = \\frac{\\omega^{\\ast}}{2\\pi} = \\frac{1}{2\\pi R_{ct} C_{dl}} $$\n这就完成了任务的第一部分。\n\n### 期望值 $\\mathbb{E}[f^{\\ast}]$ 的推导\n我们现在引入 $R_{ct}$ 和 $C_{dl}$ 的随机模型：\n$$ f^{\\ast} = \\frac{1}{2\\pi [\\mu_{R}(1+\\delta_{R})][\\mu_{C}(1+\\delta_{C})]} $$\n我们定义标称频率 $f_0 = \\frac{1}{2\\pi \\mu_{R} \\mu_{C}}$。$f^{\\ast}$ 的表达式变为：\n$$ f^{\\ast} = f_0 \\frac{1}{(1+\\delta_{R})(1+\\delta_{C})} = f_0 (1+\\delta_{R})^{-1} (1+\\delta_{C})^{-1} $$\n鉴于 $|\\delta_{R}| \\ll 1$ 和 $|\\delta_{C}| \\ll 1$，我们可以使用泰勒级数展开 $(1+x)^{-1} \\approx 1 - x + x^2 - \\dots$。我们展开到二阶项：\n$$ (1+\\delta_{R})^{-1} \\approx 1 - \\delta_{R} + \\delta_{R}^2 $$\n$$ (1+\\delta_{C})^{-1} \\approx 1 - \\delta_{C} + \\delta_{C}^2 $$\n将这两个展开式相乘，并保留关于 $\\delta_{R}$ 和 $\\delta_{C}$ 的二阶及以下的项：\n$$ (1+\\delta_{R})^{-1} (1+\\delta_{C})^{-1} \\approx (1 - \\delta_{R} + \\delta_{R}^2)(1 - \\delta_{C} + \\delta_{C}^2) $$\n$$ \\approx 1 - \\delta_{C} + \\delta_{C}^2 - \\delta_{R} + \\delta_{R}\\delta_{C} - \\delta_{R}\\delta_{C}^2 + \\delta_{R}^2 - \\delta_{R}^2\\delta_{C} + \\delta_{R}^2\\delta_{C}^2 $$\n高于二阶的项（$\\delta_{R}\\delta_{C}^2$、$\\delta_{R}^2\\delta_{C}$、$\\delta_{R}^2\\delta_{C}^2$）被忽略。\n$$ (1+\\delta_{R})^{-1} (1+\\delta_{C})^{-1} \\approx 1 - \\delta_{R} - \\delta_{C} + \\delta_{R}^2 + \\delta_{C}^2 + \\delta_{R}\\delta_{C} $$\n因此，$f^{\\ast}$ 的二阶展开式为：\n$$ f^{\\ast} \\approx f_0 (1 - \\delta_{R} - \\delta_{C} + \\delta_{R}^2 + \\delta_{C}^2 + \\delta_{R}\\delta_{C}) $$\n现在我们取期望值，利用期望算子 $\\mathbb{E}$ 的线性性质：\n$$ \\mathbb{E}[f^{\\ast}] \\approx f_0 \\mathbb{E}[1 - \\delta_{R} - \\delta_{C} + \\delta_{R}^2 + \\delta_{C}^2 + \\delta_{R}\\delta_{C}] $$\n$$ \\mathbb{E}[f^{\\ast}] \\approx f_0 (1 - \\mathbb{E}[\\delta_{R}] - \\mathbb{E}[\\delta_{C}] + \\mathbb{E}[\\delta_{R}^2] + \\mathbb{E}[\\delta_{C}^2] + \\mathbb{E}[\\delta_{R}\\delta_{C}]) $$\n我们使用已知的统计特性。对于一个零均值变量 $X$，$\\mathrm{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = \\mathbb{E}[X^2]$。\n- $\\mathbb{E}[\\delta_{R}] = 0$\n- $\\mathbb{E}[\\delta_{C}] = 0$\n- $\\mathbb{E}[\\delta_{R}^2] = \\mathrm{Var}(\\delta_{R}) = v_{R}^2$\n- $\\mathbb{E}[\\delta_{C}^2] = \\mathrm{Var}(\\delta_{C}) = v_{C}^2$\n对于两个不相关的变量 $X$ 和 $Y$，$\\mathrm{Cov}(X,Y) = \\mathbb{E}[XY] - \\mathbb{E}[X]\\mathbb{E}[Y] = 0$。由于 $\\mathbb{E}[\\delta_{R}] = 0$ 和 $\\mathbb{E}[\\delta_{C}] = 0$：\n- $\\mathbb{E}[\\delta_{R}\\delta_{C}] = \\mathrm{Cov}(\\delta_{R},\\delta_{C}) + \\mathbb{E}[\\delta_{R}]\\mathbb{E}[\\delta_{C}] = 0 + (0)(0) = 0$\n将这些代入 $\\mathbb{E}[f^{\\ast}]$ 的表达式中：\n$$ \\mathbb{E}[f^{\\ast}] \\approx f_0 (1 - 0 - 0 + v_{R}^2 + v_{C}^2 + 0) $$\n$$ \\mathbb{E}[f^{\\ast}] \\approx f_0(1 + v_{R}^2 + v_{C}^2) = \\frac{1}{2\\pi \\mu_{R} \\mu_{C}}(1 + v_{R}^2 + v_{C}^2) $$\n\n### 数值计算\n我们现在代入给定的数值：\n$\\mu_{R} = 0.5$ 欧姆, $\\mu_{C} = 5.0 \\times 10^{-3}$ 法拉, $v_{R} = 0.10$, 和 $v_{C} = 0.20$。\n首先，计算乘积 $\\mu_{R} \\mu_{C}$：\n$$ \\mu_{R} \\mu_{C} = (0.5)(5.0 \\times 10^{-3}) = 2.5 \\times 10^{-3} $$\n接着，计算项 $(1 + v_{R}^2 + v_{C}^2)$：\n$$ v_{R}^2 = (0.10)^2 = 0.01 $$\n$$ v_{C}^2 = (0.20)^2 = 0.04 $$\n$$ 1 + v_{R}^2 + v_{C}^2 = 1 + 0.01 + 0.04 = 1.05 $$\n现在，结合这些结果来求 $\\mathbb{E}[f^{\\ast}]$：\n$$ \\mathbb{E}[f^{\\ast}] \\approx \\frac{1}{2\\pi (2.5 \\times 10^{-3})} (1.05) = \\frac{1.05}{5.0 \\pi \\times 10^{-3}} = \\frac{1050}{5.0 \\pi} = \\frac{210}{\\pi} $$\n计算数值：\n$$ \\mathbb{E}[f^{\\ast}] \\approx \\frac{210}{3.14159265...} \\approx 66.845076... $$\n题目要求答案四舍五入到四位有效数字。\n$$ \\mathbb{E}[f^{\\ast}] \\approx 66.85 $$",
            "answer": "$$\n\\boxed{66.85}\n$$"
        },
        {
            "introduction": "最后，我们将理论应用到电池管理系统（BMS）的核心功能——状态估计中。本练习探讨了当扩展卡尔曼滤波器（EKF）使用的模型参数与电芯的真实参数因制造差异而不匹配时所产生的后果。这个问题通过二阶泰勒展开，揭示了电芯间差异一个不那么直观的后果：在荷电状态（SOC）估计中引入系统性偏差。理解并量化这种偏差对于设计稳健、精确的BMS算法至关重要。",
            "id": "3899242",
            "problem": "考虑一个锂离子电池，其荷电状态（SOC）由 $x \\in (0,1)$ 表示，并根据库仑计数关系 $x_{k+1} = x_k - \\eta I_k \\Delta t / Q$ 演变，其中充电效率 $\\eta$、电流 $I_k$、时间步长 $\\Delta t$ 和容量 $Q$ 均为已知。在给定的采样时刻 $k$，假设使用扩展卡尔曼滤波器（EKF）根据端电压测量值来估计SOC，该测量值建模为 $V_k = f(x_k, \\boldsymbol{\\theta}) + R I_k + v_k$，其中 $f(x,\\boldsymbol{\\theta})$ 是由 $\\boldsymbol{\\theta}$ 参数化的开路电压（OCV）函数，$R$ 是内阻，$v_k$ 是测量噪声。设开路电压（OCV）参数 $\\boldsymbol{\\theta}$ 由于制造差异而围绕一个标称值 $\\bar{\\boldsymbol{\\theta}}$ 表现出电池间的离散性，因此真实的电池参数满足 $\\boldsymbol{\\theta} = \\bar{\\boldsymbol{\\theta}} + \\Delta \\boldsymbol{\\theta}$，其中 $\\Delta \\boldsymbol{\\theta}$ 是一个零均值随机向量，其协方差为 $\\boldsymbol{\\Sigma}_{\\theta}$。EKF在设计和运行时使用标称参数 $\\bar{\\boldsymbol{\\theta}}$ 和已知的电阻 $R$。假设 $I_k$ 已知， $R I_k$ 项在滤波器内部被完全补偿，并且在所考虑的时刻测量噪声可以忽略不计（即 $v_k \\approx 0$）。设测量更新后的SOC估计值为 $\\hat{x}_k$，真实SOC为 $x_k$，并定义估计误差 $e \\triangleq \\hat{x}_k - x_k$。\n\n请从EKF在更新步骤中使用的测量一致性条件出发，并利用二阶泰勒展开，解释OCV参数的离散性 $\\Delta \\boldsymbol{\\theta}$ 如何对SOC估计产生偏差，并推导期望估计误差 $\\mathbb{E}[e]$ 作为由 $\\boldsymbol{\\Sigma}_{\\theta}$ 编码的OCV可变性的函数。将您的推导具体化到科学上符合实际的多项式OCV参数化\n$$\nf(x,\\boldsymbol{\\theta}) = \\theta_0 + \\theta_1 x + \\theta_2 x^2,\n$$\n其标称参数为 $\\bar{\\boldsymbol{\\theta}} = (\\bar{\\theta}_0,\\bar{\\theta}_1,\\bar{\\theta}_2)^{\\top}$。假设分析是在一个固定的真实SOC $x_k$ 下进行的，并且EKF更新具有足够高的增益，使得更新后的估计值 $\\hat{x}_k$ 强制实现测量一致性 $f(\\hat{x}_k,\\bar{\\boldsymbol{\\theta}}) \\approx f(x_k,\\boldsymbol{\\theta})$。请提供关于 $\\Delta \\boldsymbol{\\theta}$ 的二阶期望误差 $\\mathbb{E}[e]$ 的最终解析表达式，该表达式应使用 $x_k$、$\\bar{\\boldsymbol{\\theta}}$ 和 $\\boldsymbol{\\Sigma}_{\\theta}$ 来表示。请将最终答案表示为单个闭式表达式。无需进行数值四舍五入。SOC是无量纲的；请以无单位的形式表达最终答案。",
            "solution": "该问题是有效的。它牢固地植根于电池建模和状态估计的既定原则，例如扩展卡尔曼滤波器和基于OCV的电压模型。问题设定是理想化的，但对于分析由参数离散引起的估计偏差这一核心工程问题是适定和自洽的。\n\n### 解题推导\n\n分析从测量一致性条件开始，根据问题的高增益假设，该条件将估计电压（使用估计状态 $\\hat{x}_k$ 和标称参数 $\\bar{\\boldsymbol{\\theta}}$）与真实电压（使用真实状态 $x_k$ 和真实参数 $\\boldsymbol{\\theta}$）等同起来。问题陈述表明 $R I_k$ 项被补偿且噪声 $v_k$ 可忽略，因此电压仅由OCV函数给出。于是，我们有：\n$$\nf(\\hat{x}_k, \\bar{\\boldsymbol{\\theta}}) = f(x_k, \\boldsymbol{\\theta})\n$$\n我们引入估计误差 $e \\triangleq \\hat{x}_k - x_k$，这意味着 $\\hat{x}_k = x_k + e$。我们还使用给定的参数关系 $\\boldsymbol{\\theta} = \\bar{\\boldsymbol{\\theta}} + \\Delta \\boldsymbol{\\theta}$。将这些代入一致性条件，得到：\n$$\nf(x_k + e, \\bar{\\boldsymbol{\\theta}}) = f(x_k, \\bar{\\boldsymbol{\\theta}} + \\Delta \\boldsymbol{\\theta})\n$$\n为了分析误差 $e$ 和参数偏差 $\\Delta \\boldsymbol{\\theta}$ 之间的关系，我们对该方程两边进行二阶泰勒展开。\n\n左侧（LHS）围绕点 $(x_k, \\bar{\\boldsymbol{\\theta}})$ 对状态 $x_k$ 进行展开：\n$$\nf(x_k + e, \\bar{\\boldsymbol{\\theta}}) \\approx f(x_k, \\bar{\\boldsymbol{\\theta}}) + \\frac{\\partial f}{\\partial x} e + \\frac{1}{2} \\frac{\\partial^2 f}{\\partial x^2} e^2\n$$\n其中偏导数在 $(x_k, \\bar{\\boldsymbol{\\theta}})$ 处求值。\n\n右侧（RHS）围绕点 $(x_k, \\bar{\\boldsymbol{\\theta}})$ 对参数 $\\boldsymbol{\\theta}$ 进行展开：\n$$\nf(x_k, \\bar{\\boldsymbol{\\theta}} + \\Delta \\boldsymbol{\\theta}) \\approx f(x_k, \\bar{\\boldsymbol{\\theta}}) + (\\nabla_{\\theta} f)^{\\top} \\Delta \\boldsymbol{\\theta} + \\frac{1}{2} (\\Delta \\boldsymbol{\\theta})^{\\top} (\\mathbf{H}_{\\theta} f) (\\Delta \\boldsymbol{\\theta})\n$$\n其中 $\\nabla_{\\theta} f$ 是 $f$ 关于 $\\boldsymbol{\\theta}$ 的梯度向量，$\\mathbf{H}_{\\theta} f$ 是 $f$ 关于 $\\boldsymbol{\\theta}$ 的海森矩阵，两者均在 $(x_k, \\bar{\\boldsymbol{\\theta}})$ 处求值。\n\n令两个展开式相等并消去公因子 $f(x_k, \\bar{\\boldsymbol{\\theta}})$，得到：\n$$\n\\frac{\\partial f}{\\partial x} e + \\frac{1}{2} \\frac{\\partial^2 f}{\\partial x^2} e^2 \\approx (\\nabla_{\\theta} f)^{\\top} \\Delta \\boldsymbol{\\theta} + \\frac{1}{2} (\\Delta \\boldsymbol{\\theta})^{\\top} (\\mathbf{H}_{\\theta} f) (\\Delta \\boldsymbol{\\theta})\n$$\n误差 $e$是由参数扰动 $\\Delta \\boldsymbol{\\theta}$ 引起的。在一阶近似下，$e$ 与 $\\Delta \\boldsymbol{\\theta}$ 呈线性关系。因此，我们可以为 $e$ 建立一个微扰解。\n从一阶项中，我们有：\n$$\n\\frac{\\partial f}{\\partial x} e \\approx (\\nabla_{\\theta} f)^{\\top} \\Delta \\boldsymbol{\\theta} \\implies e \\approx \\left(\\frac{\\partial f}{\\partial x}\\right)^{-1} (\\nabla_{\\theta} f)^{\\top} \\Delta \\boldsymbol{\\theta}\n$$\n这表明 $e$ 是 $\\mathcal{O}(\\|\\Delta \\boldsymbol{\\theta}\\|)$ 阶的。因此，$e^2$ 项是 $\\mathcal{O}(\\|\\Delta \\boldsymbol{\\theta}\\|^2)$ 阶的。\n为了求期望误差 $\\mathbb{E}[e]$，我们对完整的二阶方程取期望：\n$$\n\\mathbb{E}\\left[\\frac{\\partial f}{\\partial x} e + \\frac{1}{2} \\frac{\\partial^2 f}{\\partial x^2} e^2\\right] \\approx \\mathbb{E}\\left[(\\nabla_{\\theta} f)^{\\top} \\Delta \\boldsymbol{\\theta} + \\frac{1}{2} (\\Delta \\boldsymbol{\\theta})^{\\top} (\\mathbf{H}_{\\theta} f) (\\Delta \\boldsymbol{\\theta})\\right]\n$$\n这些导数是在已知点 $(x_k, \\bar{\\boldsymbol{\\theta}})$ 处求值的确定性量。利用期望的线性性质：\n$$\n\\frac{\\partial f}{\\partial x} \\mathbb{E}[e] + \\frac{1}{2} \\frac{\\partial^2 f}{\\partial x^2} \\mathbb{E}[e^2] \\approx (\\nabla_{\\theta} f)^{\\top} \\mathbb{E}[\\Delta \\boldsymbol{\\theta}] + \\frac{1}{2} \\mathbb{E}[(\\Delta \\boldsymbol{\\theta})^{\\top} (\\mathbf{H}_{\\theta} f) (\\Delta \\boldsymbol{\\theta})]\n$$\n已知 $\\mathbb{E}[\\Delta \\boldsymbol{\\theta}] = \\mathbf{0}$。期望误差 $\\mathbb{E}[e]$ 是一个偏差，我们预计它是二阶的。为了计算 $\\mathbb{E}[e^2]$ 的最低非零阶，我们使用 $e$ 的一阶近似：\n$$\n\\mathbb{E}[e^2] \\approx \\mathbb{E}\\left[ \\left( \\left(\\frac{\\partial f}{\\partial x}\\right)^{-1} (\\nabla_{\\theta} f)^{\\top} \\Delta \\boldsymbol{\\theta} \\right)^2 \\right] = \\left(\\frac{\\partial f}{\\partial x}\\right)^{-2} \\mathbb{E}\\left[ ((\\nabla_{\\theta} f)^{\\top} \\Delta \\boldsymbol{\\theta}) ((\\nabla_{\\theta} f)^{\\top} \\Delta \\boldsymbol{\\theta})^{\\top} \\right] \\\\\n= \\left(\\frac{\\partial f}{\\partial x}\\right)^{-2} \\mathbb{E}\\left[ (\\nabla_{\\theta} f)^{\\top} \\Delta \\boldsymbol{\\theta} (\\Delta \\boldsymbol{\\theta})^{\\top} \\nabla_{\\theta} f \\right] = \\left(\\frac{\\partial f}{\\partial x}\\right)^{-2} (\\nabla_{\\theta} f)^{\\top} \\mathbb{E}[\\Delta \\boldsymbol{\\theta} (\\Delta \\boldsymbol{\\theta})^{\\top}] \\nabla_{\\theta} f \\\\\n= \\left(\\frac{\\partial f}{\\partial x}\\right)^{-2} (\\nabla_{\\theta} f)^{\\top} \\boldsymbol{\\Sigma}_{\\theta} \\nabla_{\\theta} f\n$$\n对于右侧的二次型，我们使用一般性质 $\\mathbb{E}[\\mathbf{z}^{\\top}\\mathbf{A}\\mathbf{z}] = \\text{tr}(\\mathbf{A}\\boldsymbol{\\Sigma}_{\\mathbf{z}}) + \\boldsymbol{\\mu}_{\\mathbf{z}}^{\\top}\\mathbf{A}\\boldsymbol{\\mu}_{\\mathbf{z}}$。对于 $\\mathbf{z}=\\Delta\\boldsymbol{\\theta}$，均值 $\\boldsymbol{\\mu}_{\\mathbf{z}}=\\mathbf{0}$，协方差为 $\\boldsymbol{\\Sigma}_{\\theta}$。因此，$\\mathbb{E}[(\\Delta \\boldsymbol{\\theta})^{\\top} (\\mathbf{H}_{\\theta} f) (\\Delta \\boldsymbol{\\theta})] = \\text{tr}((\\mathbf{H}_{\\theta} f) \\boldsymbol{\\Sigma}_{\\theta})$。\n将这些结果代回期望方程：\n$$\n\\frac{\\partial f}{\\partial x} \\mathbb{E}[e] + \\frac{1}{2} \\frac{\\partial^2 f}{\\partial x^2} \\left( \\left(\\frac{\\partial f}{\\partial x}\\right)^{-2} (\\nabla_{\\theta} f)^{\\top} \\boldsymbol{\\Sigma}_{\\theta} \\nabla_{\\theta} f \\right) \\approx \\mathbf{0} + \\frac{1}{2} \\text{tr}((\\mathbf{H}_{\\theta} f) \\boldsymbol{\\Sigma}_{\\theta})\n$$\n求解 $\\mathbb{E}[e]$：\n$$\n\\mathbb{E}[e] \\approx \\left(\\frac{\\partial f}{\\partial x}\\right)^{-1} \\left[ \\frac{1}{2} \\text{tr}((\\mathbf{H}_{\\theta} f) \\boldsymbol{\\Sigma}_{\\theta}) - \\frac{1}{2} \\frac{\\partial^2 f}{\\partial x^2} \\left(\\frac{\\partial f}{\\partial x}\\right)^{-2} (\\nabla_{\\theta} f)^{\\top} \\boldsymbol{\\Sigma}_{\\theta} \\nabla_{\\theta} f \\right]\n$$\n$$\n\\mathbb{E}[e] \\approx \\frac{\\text{tr}((\\mathbf{H}_{\\theta} f) \\boldsymbol{\\Sigma}_{\\theta})}{2 \\frac{\\partial f}{\\partial x}} - \\frac{\\frac{\\partial^2 f}{\\partial x^2}}{2 \\left(\\frac{\\partial f}{\\partial x}\\right)^3} (\\nabla_{\\theta} f)^{\\top} \\boldsymbol{\\Sigma}_{\\theta} (\\nabla_{\\theta} f)\n$$\n这是一般情况下期望估计误差（偏差）的二阶表达式。\n\n现在，我们将此结果具体化到给定的多项式OCV模型：\n$$\nf(x_k, \\boldsymbol{\\theta}) = \\theta_0 + \\theta_1 x_k + \\theta_2 x_k^2\n$$\n我们计算所需的导数，这些导数在 $(x_k, \\bar{\\boldsymbol{\\theta}})$ 处求值：\n1. 关于 $x$ 的一阶导数：\n$$\n\\frac{\\partial f}{\\partial x} = \\bar{\\theta}_1 + 2 \\bar{\\theta}_2 x_k\n$$\n2. 关于 $x$ 的二阶导数：\n$$\n\\frac{\\partial^2 f}{\\partial x^2} = 2 \\bar{\\theta}_2\n$$\n3. 关于 $\\boldsymbol{\\theta} = (\\theta_0, \\theta_1, \\theta_2)^{\\top}$ 的梯度：\n$$\n\\nabla_{\\theta} f = \\begin{pmatrix} \\frac{\\partial f}{\\partial \\theta_0} \\\\ \\frac{\\partial f}{\\partial \\theta_1} \\\\ \\frac{\\partial f}{\\partial \\theta_2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ x_k \\\\ x_k^2 \\end{pmatrix}\n$$\n4. 关于 $\\boldsymbol{\\theta}$ 的海森矩阵：由于 $f$ 在 $\\boldsymbol{\\theta}$ 的每个分量中都是线性的，所有关于 $\\boldsymbol{\\theta}$ 的二阶偏导数都为零。\n$$\n\\mathbf{H}_{\\theta} f = \\frac{\\partial}{\\partial \\boldsymbol{\\theta}^{\\top}} (\\nabla_{\\theta} f) = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\mathbf{0}\n$$\n$\\mathbf{H}_{\\theta} f = \\mathbf{0}$ 这一事实显著简化了 $\\mathbb{E}[e]$ 的一般表达式。涉及迹的第一项变为零：\n$$\n\\frac{\\text{tr}(\\mathbf{0} \\cdot \\boldsymbol{\\Sigma}_{\\theta})}{2 \\frac{\\partial f}{\\partial x}} = 0\n$$\n因此，期望误差仅由第二项给出：\n$$\n\\mathbb{E}[e] \\approx - \\frac{\\frac{\\partial^2 f}{\\partial x^2}}{2 \\left(\\frac{\\partial f}{\\partial x}\\right)^3} (\\nabla_{\\theta} f)^{\\top} \\boldsymbol{\\Sigma}_{\\theta} (\\nabla_{\\theta} f)\n$$\n将计算出的多项式模型的导数代入：\n$$\n\\mathbb{E}[e] \\approx - \\frac{2 \\bar{\\theta}_2}{2 (\\bar{\\theta}_1 + 2 \\bar{\\theta}_2 x_k)^3} \\begin{pmatrix} 1  x_k  x_k^2 \\end{pmatrix} \\boldsymbol{\\Sigma}_{\\theta} \\begin{pmatrix} 1 \\\\ x_k \\\\ x_k^2 \\end{pmatrix}\n$$\n简化此表达式，即可得到SOC估计中期望估计误差（或偏差）的最终结果：\n$$\n\\mathbb{E}[e] = - \\frac{\\bar{\\theta}_2}{(\\bar{\\theta}_1 + 2 \\bar{\\theta}_2 x_k)^3} \\begin{pmatrix} 1  x_k  x_k^2 \\end{pmatrix} \\boldsymbol{\\Sigma}_{\\theta} \\begin{pmatrix} 1 \\\\ x_k \\\\ x_k^2 \\end{pmatrix}\n$$\n该表达式揭示了偏差是由OCV-SOC关系的曲率（由 $\\bar{\\theta}_2$ 表示）以及OCV对参数的敏感度（$\\nabla_{\\theta} f$）与参数协方差 $\\boldsymbol{\\Sigma}_{\\theta}$ 之间的相互作用驱动的。如果OCV与SOC呈线性关系（$\\bar{\\theta}_2=0$），这种二阶偏差效应将会消失。分母表明，偏差对OCV曲线的斜率 $\\frac{\\partial f}{\\partial x}$ 也高度敏感，在OCV曲线斜率接近于零的平坦区域，偏差会变得非常大。",
            "answer": "$$\n\\boxed{- \\frac{\\bar{\\theta}_2}{(\\bar{\\theta}_1 + 2 \\bar{\\theta}_2 x_k)^3} \\begin{pmatrix} 1  x_k  x_k^2 \\end{pmatrix} \\boldsymbol{\\Sigma}_{\\theta} \\begin{pmatrix} 1 \\\\ x_k \\\\ x_k^2 \\end{pmatrix}}\n$$"
        }
    ]
}