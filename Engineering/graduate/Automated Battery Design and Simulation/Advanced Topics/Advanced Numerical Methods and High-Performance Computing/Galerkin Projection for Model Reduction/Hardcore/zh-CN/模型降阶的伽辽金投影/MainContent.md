## 引言
在现代科学与工程，尤其是在[自动化电池设计](@entry_id:1121262)等前沿领域，高保真物理仿真扮演着至关重要的角色。然而，这些基于[偏微分](@entry_id:194612)方程的复杂模型往往伴随着巨大的计算成本，严重制约了设计迭代、优化和实时控制的效率。如何在计算保真度与效率之间找到平衡，是当前面临的一个核心挑战。基于加辽金投影的[模型降阶](@entry_id:171175)（Model Order Reduction, MOR）技术为此提供了强有力的解决方案。

本文旨在系统性地介绍加辽金投影的核心思想及其在构建高效、可靠的降阶模型（Reduced-Order Models, ROMs）中的应用。通过阅读本文，您将学习到如何从复杂的[全阶模型](@entry_id:171001)中提炼出关键的动态特性，构建出维度极低但预测精度足够高的替代模型。

文章将分为三个核心部分展开。在“原则与机理”一章中，我们将深入剖析加辽金投影的数学基础，从线性系统到非线性系统，并介绍如何通过[本征正交分解](@entry_id:165074)（POD）从数据中构造最优的降阶基。接着，在“应用与跨学科关联”一章，我们将展示这些理论在电池仿真与设计中的具体应用，探讨如何构建[参数化](@entry_id:265163)ROM以加速设计探索，并讨论如何通过结构保持方法确保模型的物理一致性。最后，“动手实践”部分将提供实践机会，以巩固您对核心概念的理解。

让我们首先进入第一章，探索加辽金投影的基本原则与核心机理。

## 原则与机理

### 核心思想：加辽金投影

[模型降阶](@entry_id:171175)的核心目标是在保留系统关键特性的前提下，大幅降低其数学模型的维度和计算复杂度。加辽金（Galerkin）投影是实现这一目标的主流方法之一，其基础是**[加权残差法](@entry_id:140285)**（Method of Weighted Residuals）。

考虑一个由算子方程描述的物理系统，其形式为 $L(u) = f$，其中 $L$ 是一个（线性或[非线性](@entry_id:637147)）[微分](@entry_id:158422)或代数算子，$u$ 是待求的解（例如，一个物理场），$f$ 是源项。我们通常无法求得高维空间中 $u$ 的精确解，因此我们试图在一个精心选择的低维**试探子空间**（trial subspace）$V$ 中寻找一个近似解 $u_r$。由于 $u_r$ 只是一个近似，将其代入原方程会产生一个非零的**残差**（residual），即 $R(u_r) = L(u_r) - f \neq 0$。

[加权残差法](@entry_id:140285)的思想是，虽然我们不能让残差在整个定义域上处处为零，但我们可以要求它在某种加权平均意义下为零。具体而言，我们选择另一个**检验子空间**（test subspace）$W$，并要求残差 $R(u_r)$ 与 $W$ 中的所有函数 $w$ 正交。这里的“正交”是根据一个预先定义的**[内积](@entry_id:750660)** $(\cdot, \cdot)$ 来衡量的。这样，我们就得到了[加权残差法](@entry_id:140285)的基本形式：
$$
(R(u_r), w) = (L(u_r) - f, w) = 0, \quad \forall w \in W
$$
通过选择不同的检验子空间 $W$，我们可以得到不同的[加权残差](@entry_id:1134032)方法。

#### 加辽金方法与彼得罗夫-加辽金方法

加辽金投影方法的分类主要取决于试探子空间 $V$ 和检验子空间 $W$ 之间的关系 。

- **标准加辽金方法 (Bubnov-Galerkin Method)**：这是最常用的一种形式，其核心特征是选择**检验子空间与试探子空间相同**，即 $W = V$。因此，其[正交性条件](@entry_id:168905)为：要求残差与近似解所在空间中的所有函数都正交。
  $$
  (L(u_r) - f, v) = 0, \quad \forall v \in V
  $$
  这种选择具有深刻的数学内涵。对于自伴（对称）正定算子，标准加辽金方法能够保证所得到的降阶系统是稳定的，并且其解是在[能量范数](@entry_id:274966)意义下的最优近似，我们将在后文详细探讨。

- **彼得罗夫-加辽金方法 (Petrov-Galerkin Method)**：这是一个更广泛的框架，它允许**检验子空间与试探子空间不同**，即 $W \neq V$。
  $$
  (L(u_r) - f, w) = 0, \quad \forall w \in W
  $$
  尽管标准加辽金方法在许多情况下表现优异，但对于某些特定问题，例如包含对流项的非[自伴算子](@entry_id:152188)问题，标准加辽金方法可能会产生不稳定的数值振荡。在这种情况下，通过精心设计一个不同于 $V$ 的检验子空间 $W$（例如，在迎风格式中引入不对称的权函数），彼得罗夫-加辽金方法可以有效地增强降阶模型的稳定性。

在本章的后续讨论中，如无特别说明，“加辽金投影”均指代更为常用的标准（即Bubnov-Galerkin）加辽金方法。

### 线性系统的加辽金降阶

我们首先将加辽金投影应用于[线性系统](@entry_id:147850)，这是理解其机理最清晰的起点。

#### [稳态](@entry_id:139253)问题

考虑一个由[线性算子](@entry_id:149003)方程描述的[稳态](@entry_id:139253)物理问题，其抽象形式为 $Au = b$。这里的 $u$ 是我们要求解的状态变量，它属于一个希尔伯特空间 $H$（例如 $H^1(\Omega)$）；$A$ 是一个线性算子。在[电池模型](@entry_id:1121428)中，这可能代表一个稳定[工作点](@entry_id:173374)下的浓度或电势分布 。

我们选择一个由 $r$ 个[线性无关](@entry_id:148207)的基函数 $\{\phi_i\}_{i=1}^r$ 张成的低维试探子空间 $V = \mathrm{span}\{\phi_i\}_{i=1}^r \subset H$。近似解 $u_r$ 在这个子空间中，可以表示为基函数的[线性组合](@entry_id:154743)：
$$
u_r = \sum_{j=1}^r \hat{u}_j \phi_j
$$
其中，$\hat{u} = [\hat{u}_1, \dots, \hat{u}_r]^\top$ 是待求的降阶[坐标向量](@entry_id:153319)。

根据加辽金原理，我们要求残差 $Au_r - b$ 与试探子空间 $V$ 中的所有函数正交。正交性通过[内积](@entry_id:750660) $(\cdot, \cdot)$ 定义。这个[内积](@entry_id:750660)可以是标准的 $L^2$ [内积](@entry_id:750660)，也可以是根据物理问题定义的[加权内积](@entry_id:163877)，例如 $(u,v)_\rho = \int_\Omega \rho(x) u(x) v(x) \, dx$。加辽金条件是：
$$
(A u_r - b, v)_\rho = 0, \quad \forall v \in V
$$
由于该条件对 $V$ 中所有函数都成立，我们只需对 $V$ 的所有基函数 $\{\phi_i\}_{i=1}^r$ 进行检验即可。将 $u_r$ 的表达式代入，并利用[内积](@entry_id:750660)的线性性质，对每一个基函数 $\phi_i$，我们有：
$$
\left( A \left( \sum_{j=1}^r \hat{u}_j \phi_j \right) - b, \phi_i \right)_\rho = 0 \quad \implies \quad \sum_{j=1}^r (A \phi_j, \phi_i)_\rho \hat{u}_j = (b, \phi_i)_\rho
$$
这是一个关于未知坐标 $\hat{u}_j$ 的 $r \times r$ [线性方程组](@entry_id:148943)。若我们将基函数 $\phi_i$ 表示为列向量，并组合成矩阵 $V_{\text{mat}} \in \mathbb{R}^{N \times r}$（$N$ 是[全阶模型](@entry_id:171001)自由度），将算子 $A$ 表示为矩阵 $A_{\text{mat}} \in \mathbb{R}^{N \times N}$，将源项 $b$ 表示为向量 $b_{\text{vec}} \in \mathbb{R}^{N}$，并将[加权内积](@entry_id:163877)表示为质量矩阵 $M \in \mathbb{R}^{N \times N}$（即 $(u,v)_\rho = u^\top M v$），那么上述方程组的矩阵形式为：
$$
A_r \hat{u} = b_r
$$
其中，降阶算子矩阵 $A_r \in \mathbb{R}^{r \times r}$ 和降阶源项向量 $b_r \in \mathbb{R}^{r}$ 分别为：
$$
A_r = V_{\text{mat}}^\top A_{\text{mat}} V_{\text{mat}} \quad (\text{如果使用标准欧几里得内积})
$$
$$
A_r = V_{\text{mat}}^\top M A_{\text{mat}} V_{\text{mat}} \quad (\text{如果使用由 } M \text{ 定义的加权内积})
$$
$$
b_r = V_{\text{mat}}^\top M b_{\text{vec}} \quad (\text{同样，使用由 } M \text{ 定义的加权内积})
$$
这个过程通常被称为**“三明治”乘积**（sandwich product），它将高维算子 $A_{\text{mat}}$ 压缩成了一个小得多的算子 $A_r$。

一个至关重要的性质是，如果原算子 $A$ 是自伴且正定的（在所选的[内积](@entry_id:750660)意义下），那么加辽金解 $u_r$ 是原问题精确解 $u$ 在子空间 $V$ 中的**最佳近似**，这种最优性是在由算子 $A$ 诱导的**[能量范数](@entry_id:274966)** $\|e\|_A^2 \equiv (Ae, e)_\rho$ 意义下定义的 。也就是说：
$$
\|u - u_r\|_A = \min_{w \in V} \|u - w\|_A
$$
这一性质为加辽金方法提供了强有力的理论保障，确保了降阶解在能量意义上是“最接近”真实解的。

#### 动态问题

对于动态系统，例如由有限元法[半离散化](@entry_id:163562)得到的常微分方程组（ODEs）$M \dot{x}(t) + K x(t) = f(t)$，加辽金投影的原理是完全相同的 。其中 $M$ 是[质量矩阵](@entry_id:177093)，$K$ 是[刚度矩阵](@entry_id:178659)，$x(t)$ 是随时间变化的[状态向量](@entry_id:154607)。

我们同样假设近似解 $x(t)$ 位于由基矩阵 $V$ 的列[向量张成](@entry_id:152883)的子空间中，即 $x(t) \approx V x_r(t)$，其中 $x_r(t)$ 是 $r$ 维的降阶[状态向量](@entry_id:154607)。将其代入原方程，得到残差：
$$
R(t) = M (V \dot{x}_r(t)) + K (V x_r(t)) - f(t)
$$
根据加辽金原理，我们要求残差与试探子空间（由 $V$ 的列[向量张成](@entry_id:152883)）正交。在离散向量空间中，使用标准欧几里得[内积](@entry_id:750660)，这意味着 $V^\top R(t) = 0$。
$$
V^\top (M V \dot{x}_r(t) + K V x_r(t) - f(t)) = 0
$$
整理后得到降阶动态系统：
$$
M_r \dot{x}_r(t) + K_r x_r(t) = f_r(t)
$$
其中，降阶矩阵和向量为：
$$
M_r = V^\top M V, \quad K_r = V^\top K V, \quad f_r(t) = V^\top f(t)
$$
我们再次看到了同样的三明治结构。这个 $r \times r$ 维的[常微分方程组](@entry_id:907499)可以比原 $N \times N$ 维系统快得多地求解，从而实现了动态仿真的加速。

### [非线性系统](@entry_id:168347)的加辽金降阶

在电池模型等实际应用中，许多关键物理过程（如电[化学反应动力学](@entry_id:274455)）都是[非线性](@entry_id:637147)的。经过空间离散化后，我们得到的可能是一个[非线性](@entry_id:637147)[代数方程](@entry_id:272665)组 $F(u)=0$（对于[稳态](@entry_id:139253)问题）或[非线性微分方程](@entry_id:175929)组。

对于[非线性](@entry_id:637147)问题，加辽金投影的原理保持不变：我们依然要求残差在检验子空间上正交 。考虑一个[稳态](@entry_id:139253)[非线性](@entry_id:637147)问题 $F(u)=0$，其中 $u \in \mathbb{R}^N$，$F: \mathbb{R}^N \to \mathbb{R}^N$。我们寻找一个形式为 $u_r = u_{\text{ref}} + \Phi a$ 的近似解，其中 $u_{\text{ref}}$ 是一个参考状态，$\Phi \in \mathbb{R}^{N \times r}$ 是基矩阵，$a \in \mathbb{R}^r$ 是降阶坐标。

加辽金条件（在由[质量矩阵](@entry_id:177093) $M$ 定义的[内积](@entry_id:750660)下）是：
$$
(F(u_r), v)_M = v^\top M F(u_r) = 0, \quad \forall v \in \mathrm{span}(\Phi)
$$
同样，我们只需对基矩阵 $\Phi$ 的每一列 $\phi_i$ 进行检验，即可得到 $r$ 个方程：
$$
\phi_i^\top M F(u_{\text{ref}} + \Phi a) = 0, \quad i=1, \dots, r
$$
将这 $r$ 个标量方程组合起来，我们得到一个关于降阶坐标 $a$ 的 $r$ 维[非线性方程组](@entry_id:178110)：
$$
R(a) := \Phi^\top M F(u_{\text{ref}} + \Phi a) = \mathbf{0}
$$
这个降阶[非线性系统](@entry_id:168347) $R(a)=\mathbf{0}$ 的维度远小于原始系统，但它保留了原问题的[非线性](@entry_id:637147)结构。因此，我们必须使用[非线性求解器](@entry_id:177708)（例如牛顿-拉夫逊方法）来求解 $a$。一旦求得 $a$，我们就可以通过 $u_r = u_{\text{ref}} + \Phi a$ 重构出全维度的近似解。

### 降阶基的构造：[本征正交分解](@entry_id:165074) (POD)

到目前为止，我们都假设已经有了一个“好”的低维子空间 $V$。但如何构造这个子空间呢？**[本征正交分解](@entry_id:165074)**（Proper Orthogonal Decomposition, POD），在许多领域也被称为**[主成分分析](@entry_id:145395)**（Principal Component Analysis, PCA），是一种从数据中提取最优子空间的强大工具。

其基本思想是，一个复杂系统的动态行为虽然发生在极高维的[状态空间](@entry_id:160914)中，但其轨迹通常只占据了空间中一个很小的低维流形。POD的目标就是找到最能“代表”这个流形的子空间。

#### POD 工作流程与[误差界](@entry_id:139888)

POD是一个数据驱动的方法。其标准流程如下  ：

1.  **快照收集 (Snapshot Collection)**：通过运行高保真模型进行一次或多次仿真，在不同的时间点 $t_j$ 采集系统的[状态向量](@entry_id:154607) $x(t_j)$。将这些向量作为列，组成一个**[快照矩阵](@entry_id:1131792)** $X = [x(t_1), x(t_2), \dots, x(t_m)] \in \mathbb{R}^{N \times m}$。

2.  **最优子空间问题**：POD要寻找一个 $r$ 维子空间 $V_r$，使得所有快照投影到这个子空间上的平均投影误差最小。若用 $P_{V_r}$ 表示到 $V_r$ 的[正交投影](@entry_id:144168)算子，则目标是：
    $$
    \min_{V_r, \dim(V_r)=r} \sum_{j=1}^m \|x(t_j) - P_{V_r} x(t_j)\|^2
    $$
    这里的范数 $\| \cdot \|$ 可以是标准的[欧几里得范数](@entry_id:172687)，或者是由[质量矩阵](@entry_id:177093) $M$ 诱导的加权范数 $\|x\|_M = \sqrt{x^\top M x}$。对于后者，我们需要求解[奇异值分解](@entry_id:138057)（SVD）的是加权[快照矩阵](@entry_id:1131792) $\tilde{X} = M^{1/2}X$ 。

3.  **[奇异值分解 (SVD)](@entry_id:172448) 求解**：上述优化问题的解可以通过对[快照矩阵](@entry_id:1131792)（或加权[快照矩阵](@entry_id:1131792)）进行奇异值分解得到。设 $X = U \Sigma W^\top$，其中 $U \in \mathbb{R}^{N \times N}$ 和 $W \in \mathbb{R}^{m \times m}$ 是[正交矩阵](@entry_id:169220)，$\Sigma \in \mathbb{R}^{N \times m}$ 是对角矩阵，其对角线上的元素 $\sigma_1 \ge \sigma_2 \ge \dots \ge 0$ 称为**奇异值**。
    
    最优的 $r$ 维子空间 $V_r$ 正是由 $U$ 的前 $r$ 个列向量（称为**[左奇异向量](@entry_id:751233)**）张成的空间。这 $r$ 个[左奇异向量](@entry_id:751233)就构成了我们的降阶基矩阵 $V$。

4.  **维度 $r$ 的选择**：我们应该选择多大的 $r$ 呢？[奇异值](@entry_id:152907)的大小直接反映了对应基向量的重要性。快照数据所包含的“总能量”可以用奇异值的平方和来衡量，即 $\|X\|_F^2 = \sum_i \sigma_i^2$（其中 $\| \cdot \|_F$ 是 Frobenius 范数）。由前 $r$ 个基向量捕获的能量为 $\sum_{i=1}^r \sigma_i^2$。一个常用的启发式准则是，选择最小的 $r$，使得捕获的能量比例超过一个阈值 $\alpha$（例如 $0.9999$）：
    $$
    \frac{\sum_{i=1}^r \sigma_i^2}{\sum_{i=1}^{\text{rank}(X)} \sigma_i^2} \ge \alpha
    $$

[奇异值](@entry_id:152907)还为我们提供了严格的**[误差界](@entry_id:139888)** 。由POD[基截断](@entry_id:746694)所造成的近似误差可以被量化：

-   **Frobenius 范数误差**：低秩近似矩阵 $X_r = U_r \Sigma_r W_r^\top$ 与原始[快照矩阵](@entry_id:1131792)的总体误差为 $\sum_{i=r+1}^p \sigma_i^2$，其中 $p$ 是 $X$ 的秩。
    $$
    \|X - X_r\|_F^2 = \sum_{i=r+1}^{p} \sigma_i^2
    $$
-   **算子 [2-范数](@entry_id:636114)误差**：该误差衡量了最坏情况下的单[向量投影](@entry_id:147046)误差，其大小等于第一个被截断的奇异值 $\sigma_{r+1}$。
    $$
    \|X - X_r\|_2 = \sigma_{r+1}
    $$
    这意味着对于任何一个快照 $x_j$，其投影误差的[上界](@entry_id:274738)为 $\|x_j - P_{V_r} x_j\|_2 \le \sigma_{r+1}$。

在实际应用中，还需注意一些重要细节。例如，如果[状态向量](@entry_id:154607)的不同分量具有不同的物理单位和数量级，直接进行POD可能会被数量级大的分量主导。此时，需要对[快照矩阵](@entry_id:1131792)的行进行适当的**缩放**，这等价于在加权范数下进行POD 。此外，如果数据围绕一个非零均值波动，先减去均值再进行POD，可以构造出最优的**仿射子空间**，从而用更少的基函数达到同样的精度 。

### 复杂物理系统的降阶挑战

将加辽金投影应用于真实的、[多物理场耦合](@entry_id:171389)的系统时，会遇到一些更深层次的挑战。成功的模型降阶不仅需要数学上的精确，还需要保持原模型的物理一致性。

#### 微分代数方程 (DAEs)

许多物理系统，特别是那些包含瞬时约束的系统，在[半离散化](@entry_id:163562)后自然地呈现出**微分代数方程**（Differential-Algebraic Equation, DAE）的形式，而不是纯粹的常微分方程（ODE）。电池的 Newman 模型就是一个典型例子 。

在忽略[双电层电容](@entry_id:264658)的典型假设下，固相和液相中的锂离子浓度（$c_s, c_e$）由包含时间导数项的[抛物型偏微分方程](@entry_id:168935)（[扩散方程](@entry_id:170713)）描述，因此是**[微分](@entry_id:158422)变量**。然而，固相和液相的电势（$\phi_s, \phi_e$）由不含时间导数的椭圆型[偏微分](@entry_id:194612)方程（电荷守恒/欧姆定律）约束，这些变量在每个时刻都必须瞬时满足代数约束，因此是**代数变量**。

[半离散化](@entry_id:163562)后，系统呈现出如下的 DAE 结构：
$$
E \dot{x} = A x + B u
$$
其中，状态向量 $x$ 可分为[微分](@entry_id:158422)部分 $x_d$ 和代数部分 $x_a$，而质量矩阵 $E$ 具有奇异性，其典型形式为 $E = \begin{bmatrix} M   0 \\ 0   0 \end{bmatrix}$。这种系统被称为**指数为1**的DAE。

对 DAE 系统直接应用标准的加辽金投影可能会破坏其代数约束，导致模型不稳定或不准确。一个结构保持的策略是分别处理[微分](@entry_id:158422)变量和代数变量。例如，如果我们希望精确地保留代数约束，同时只对[微分](@entry_id:158422)变量进行降阶，那么[投影矩阵](@entry_id:154479) $V$ 必须具有特定的块结构 ：
$$
V = \begin{pmatrix} V_{d}  0 \\ 0  I_{n_{a}} \end{pmatrix}
$$
其中 $V_d$ 是对[微分](@entry_id:158422)状态进行降阶的基矩阵，而 $I_{n_a}$ 是一个[单位矩阵](@entry_id:156724)，保证了代数状态不被改变。这种特殊构造的投影能够确保[降阶模型](@entry_id:754172)保持原 DAE 的指数-1 结构，并精确满足代数约束。更一般地，处理 DAE 需要采用**[混合有限元](@entry_id:178533)**的思想，确保试探和检验空间满足所谓的**inf-sup**或LBB（Ladyzhenskaya-Babuška-Brezzi）条件，以保证代数部分的稳定性。

#### 守恒律的保持

物理模型通常蕴含着重要的**守恒律**，例如[质量守恒](@entry_id:204015)、能量守恒或电荷守恒。一个理想的[降阶模型](@entry_id:754172)应该能严格保持这些守恒律，否则其长期仿真结果可能会产生非物理的漂移。

以[电池模型](@entry_id:1121428)中的总锂量守恒为例 。在没有外部通量的[封闭系统](@entry_id:139565)中，总的锂离子数量应保持不变。在[连续模](@entry_id:158807)型中，这意味着总锂量对时间的导数为零：$\frac{d}{dt} N_{\text{tot}}(t) = 0$。在半离散模型 $M\dot{y} = Ky + f(y)$ 中，这对应于一个线性不变量 $J(y) = \mathbf{m}^\top y$，其中 $\mathbf{m}$ 是一个表示离散积分的常向量。守恒性表现为 $\frac{dJ}{dt} = \mathbf{m}^\top \dot{y} = 0$。

为了让降阶模型 $\mathbf{y} \approx \mathbf{V}\mathbf{z}$ 也保持这个守恒律，即 $(\mathbf{m}^\top \mathbf{V})\dot{\mathbf{z}} = 0$，我们需要对投影过程施加一个条件。可以证明，一个充分条件是，代表[守恒量](@entry_id:161475)的“对偶”向量 $\mathbf{c} = M^{-1}\mathbf{m}$ 必须包含在**检验子空间** $\mathrm{span}(\mathbf{W})$ 中。
$$
\mathbf{c} = M^{-1}\mathbf{m} \in \mathrm{span}(\mathbf{W})
$$
当满足这个条件时，降阶系统的方程组中将自动包含守恒律本身，从而保证了[降阶模型](@entry_id:754172)在任何时候都严格遵守该物理不变量。这对于确保[降阶模型](@entry_id:754172)的物理一致性和[长期稳定性](@entry_id:146123)至关重要。

#### 连续与离散投影的等价性

在理论推导中，我们常在无限维的[函数空间](@entry_id:143478)中讨论投影（“先投影，后离散”）；而在实际计算中，我们总是先将模型离散化（如用[有限元法](@entry_id:749389)）得到一个高维离散系统，然后再对其进行投影（“先离散，后投影”）。这两个过程得到的结果是否相同？

答案是，只有在特定条件下它们才是等价的。一个充分条件是：**[降阶模型](@entry_id:754172)的试探子空间 $W$ 必须是[全阶模型](@entry_id:171001)离散化所用的有限元空间 $V_h$ 的一个子空间**，即 $W \subset V_h$。

这意味着降阶基函数本身可以用[有限元基函数](@entry_id:749279)精确表示。当这个条件满足，并且所有积分都通过足够精确的[数值求积](@entry_id:136578)方法计算时，“先离散，后投影”得到的降阶矩阵将与“先投影，后离散”得到的矩阵完全相同。这个结论为我们通常采用的“先离散，后投影”的实用工作流程提供了理论依据。

### [参数化降阶模型](@entry_id:1129329)的离线-在线计算框架

在自动化设计和优化等应用中，我们不仅需要对一个固定的模型进行快速仿真，还需要能高效地探索不同设计参数或操作条件（例如，电极孔隙度、温度、倍率等参数 $\mu$）对系统行为的影响。这就要求我们构建**[参数化](@entry_id:265163)的[降阶模型](@entry_id:754172)**（Parametric ROM, pROM）。

为了实现对参数变化的快速响应，pROM的计算被分解为**离线（offline）**和**在线（online）**两个阶段 。

- **离线阶段**：这是一个计算量巨大、耗时很长但只需执行一次的预计算阶段。
    1.  **参数采样与快照收集**：在参数空间 $\mathcal{P}$ 中选取一组有代表性的训练参数点 $\mu_j$。对每一个 $\mu_j$，运行高保真[全阶模型](@entry_id:171001)（FOM），并收集状态快照。
    2.  **全局基构造**：将所有参数点下的所有快照汇集起来，使用POD方法构造一个能够有效表示整个[参数空间](@entry_id:178581)动力学行为的**全局降阶基** $V$。
    3.  **算子投影与仿射分解**：对于模型中依赖参数的[线性算子](@entry_id:149003)，如 $K(\mu)$，如果它们可以表示为参数的**仿射形式** $K(\mu) = \sum_{q=1}^{Q_K} \theta_{K,q}(\mu) K_q$（其中 $\theta$ 是标量函数，$K_q$ 是常数矩阵），我们就可以在离线阶段预先计算并存储所有常数部分的降阶版本，例如 $K_{r,q} = V^\top K_q V$。
    4.  **[非线性](@entry_id:637147)项的超降阶**：对于[非线性](@entry_id:637147)项 $g(x; \mu)$，简单的投影 $V^\top g(Vx_r; \mu)$ 在线计算时仍需评估 $N$ 维的 $g$，其成本与 $N$ 相关，这会成为瓶颈。为了克服这一点，需要使用**超降阶**（hyper-reduction）技术，如**[离散经验插值法](@entry_id:748503)**（Discrete Empirical Interpolation Method, DEIM）。DEIM为[非线性](@entry_id:637147)项本身也构造一个降阶基，并找到少量的“魔法点”（插值点），使得在线阶段只需在这些点上评估[非线性](@entry_id:637147)函数，从而使其计算成本也与 $N$ 无关。

- **在线阶段**：这是一个计算量极小、可以实时执行的阶段。
    1.  **模型组装**：对于用户给定的一个新参数 $\mu_{\text{new}}$，我们只需计算几个标量函数 $\theta_{K,q}(\mu_{\text{new}})$ 的值。
    2.  **快速仿真**：通过对预计算好的小矩阵进行[线性组合](@entry_id:154743)，快速组装出该参数下的降阶模型 $M_r, K_r(\mu_{\text{new}})$ 等，并结合DEIM计算的[非线性](@entry_id:637147)项，求解一个维度仅为 $r$ 的小系统。

通过这种[离线-在线分解](@entry_id:177117)，我们将高昂的计算成本完全转移到了离线阶段，而在线阶段的计算复杂度只与降阶维度 $r$（通常很小）有关，而与原始模型的巨大维度 $N$ 无关。这使得在设计优化、控制和[不确定性量化](@entry_id:138597)等需要大量重复仿真的场景中，降阶模型能够发挥出巨大的威力。