{
    "hands_on_practices": [
        {
            "introduction": "This first practice grounds our study in the fundamental principles of chemical kinetics. We will use the Arrhenius equation to quantify how temperature accelerates battery degradation, a critical concept for designing accelerated aging tests and extrapolating lifetime data. This calculation of a thermal acceleration factor is a cornerstone skill for any battery modeler. ",
            "id": "3897779",
            "problem": "An automated battery design and simulation workflow for calendar-life prediction models the growth of the Solid Electrolyte Interphase (SEI) as a thermally activated process. Assume the SEI growth rate constant $k(T)$ exhibits Arrhenius-type behavior characterized by an activation energy $E_a$ and the Universal Gas Constant $R$. Consider a storage scenario where a lithium-ion cell is aged at two temperatures, $T_1=298\\,\\text{K}$ and $T_2=318\\,\\text{K}$, with a known SEI activation energy $E_a=45\\,\\text{kJ}\\,\\text{mol}^{-1}$. The acceleration factor is defined as the dimensionless ratio $AF=\\frac{k(T_2)}{k(T_1)}$, which is used to extrapolate calendar aging rates between temperatures in the simulation.\n\nUsing the Universal Gas Constant $R=8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$, calculate $AF$ for the given temperatures and activation energy. Report your final result as a dimensionless number and round your answer to four significant figures.",
            "solution": "The SEI growth rate constant $k(T)$ for a thermally activated process is described by Arrhenius behavior, which is a well-tested empirical law for reaction rates in chemistry and materials physics. The Arrhenius form is given by\n$$\nk(T)=k_0\\,\\exp\\!\\left(-\\frac{E_a}{R\\,T}\\right),\n$$\nwhere $k_0$ is a pre-exponential factor, $E_a$ is the activation energy, $R$ is the Universal Gas Constant, and $T$ is the absolute temperature. The acceleration factor, defined as $AF=\\frac{k(T_2)}{k(T_1)}$, follows directly from the ratio of the rate constants at $T_2$ and $T_1$:\n$$\nAF=\\frac{k(T_2)}{k(T_1)}=\\frac{k_0\\,\\exp\\!\\left(-\\frac{E_a}{R\\,T_2}\\right)}{k_0\\,\\exp\\!\\left(-\\frac{E_a}{R\\,T_1}\\right)}=\\exp\\!\\left(\\frac{E_a}{R}\\left(\\frac{1}{T_1}-\\frac{1}{T_2}\\right)\\right).\n$$\nThis expression shows that $AF$ is dimensionless and depends only on $E_a$, $R$, and the temperatures $T_1$ and $T_2$. Because $T_2>T_1$, the term $\\frac{1}{T_1}-\\frac{1}{T_2}$ is positive, so $AF>1$, which is physically consistent with faster kinetics at higher temperature.\n\nWe now substitute the given values, keeping quantities symbolic until the final numerical evaluation:\n- $E_a=45\\,\\text{kJ}\\,\\text{mol}^{-1}=45{,}000\\,\\text{J}\\,\\text{mol}^{-1}$,\n- $R=8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$,\n- $T_1=298\\,\\text{K}$,\n- $T_2=318\\,\\text{K}$.\n\nFirst compute the temperature reciprocal difference:\n$$\n\\frac{1}{T_1}-\\frac{1}{T_2}=\\frac{T_2-T_1}{T_1\\,T_2}=\\frac{318-298}{298\\cdot 318}=\\frac{20}{94{,}764}.\n$$\nThus the exponent becomes\n$$\n\\frac{E_a}{R}\\left(\\frac{1}{T_1}-\\frac{1}{T_2}\\right)=\\frac{45{,}000}{8.314462618}\\cdot \\frac{20}{94{,}764}.\n$$\nTo evaluate this numerically:\n$$\n\\frac{E_a}{R}\\approx \\frac{45{,}000}{8.314462618}\\approx 5{,}412.26,\n$$\nand\n$$\n\\frac{1}{T_1}-\\frac{1}{T_2}=\\frac{20}{94{,}764}\\approx 2.1105\\times 10^{-4}.\n$$\nTherefore,\n$$\n\\frac{E_a}{R}\\left(\\frac{1}{T_1}-\\frac{1}{T_2}\\right)\\approx 5{,}412.26\\times 2.1105\\times 10^{-4}\\approx 1.14226.\n$$\nFinally, compute the acceleration factor:\n$$\nAF=\\exp\\!\\left(1.14226\\right)\\approx 3.1338.\n$$\nRounded to four significant figures and reported as a dimensionless number, this yields\n$$\nAF\\approx 3.134.\n$$\nThis magnitude indicates that the SEI-driven calendar-aging rate at $T_2=318\\,\\text{K}$ is approximately $3.134$ times the rate at $T_1=298\\,\\text{K}$ under the Arrhenius assumption, which is consistent with expected thermal acceleration of degradation processes.",
            "answer": "$$\\boxed{3.134}$$"
        },
        {
            "introduction": "Building upon the concept of thermal activation, this exercise moves from a simple rate law to a physics-based model of capacity fade. You will derive and implement a model that computes capacity loss by integrating a parasitic side-reaction current density over time, a process central to understanding Solid Electrolyte Interphase (SEI) growth. This practice bridges the gap between microscopic electrochemical processes and macroscopic battery degradation. ",
            "id": "3897761",
            "problem": "You are tasked with designing and implementing a program that computes lithium-ion battery calendar fade as capacity loss due to a parasitic side reaction on the negative electrode. Your program must compute the capacity fade, denoted by $Q(t)$, by integrating the side-reaction current density over the true electrode surface area and time, then convert the resulting lost charge to milliampere-hours. The capacity fade must be expressed in $\\mathrm{mAh}$.\n\nUse the following scientifically grounded base:\n- The side-reaction current density $j_{\\text{side}}(t; T, \\mathrm{SoC})$ is defined on the true active surface. The total parasitic current is the surface integral of $j_{\\text{side}}$ over the true surface area.\n- The lost charge equals the time integral of current. The lost capacity in ampere-hours is the lost charge in coulombs divided by $3600$, and in milliampere-hours is multiplied by $1000$.\n- The total true surface area is modeled as $S = a_{s} A_{\\mathrm{geom}} L$, where $a_{s}$ is the specific surface area, $A_{\\mathrm{geom}}$ is the geometric area, and $L$ is the electrode thickness.\n- The side-reaction current density exhibits diffusion-limited growth and is modeled as\n$$\nj_{\\text{side}}(t; T, \\mathrm{SoC}) = k_{\\mathrm{ref}} \\exp\\left(-\\frac{E_{a}}{R}\\left(\\frac{1}{T} - \\frac{1}{T_{\\mathrm{ref}}}\\right)\\right) \\exp\\left(\\beta\\left(\\mathrm{SoC}-\\mathrm{SoC}_{\\mathrm{ref}}\\right)\\right) \\left(t + t_{0}\\right)^{-1/2},\n$$\nwhere $k_{\\mathrm{ref}}$ has units $\\mathrm{A\\,m^{-2}\\,s^{1/2}}$, $E_{a}$ is activation energy in $\\mathrm{J\\,mol^{-1}}$, $R$ is the universal gas constant in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, $T$ and $T_{\\mathrm{ref}}$ are in $\\mathrm{K}$, $\\beta$ and $\\mathrm{SoC}_{\\mathrm{ref}}$ are dimensionless, and $t$ and $t_{0}$ are in $\\mathrm{s}$. State of Charge (SoC) is dimensionless. The universal gas constant is $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n\nFrom these bases and definitions alone, derive and implement the capacity fade $Q(t)$ in $\\mathrm{mAh}$ as a function of the parameters $\\{t, T, \\mathrm{SoC}, A_{\\mathrm{geom}}, L, a_{s}, k_{\\mathrm{ref}}, E_{a}, T_{\\mathrm{ref}}, \\beta, \\mathrm{SoC}_{\\mathrm{ref}}, t_{0}\\}$ by integrating the lithium loss associated with $j_{\\text{side}}$ over the electrode surface and time.\n\nPhysical units:\n- Time $t$ and $t_{0}$ are in $\\mathrm{s}$.\n- Temperatures $T$ and $T_{\\mathrm{ref}}$ are in $\\mathrm{K}$.\n- Capacity output $Q(t)$ must be expressed in $\\mathrm{mAh}$, rounded to six decimal places.\n\nAngle units are not applicable. No percentages are involved.\n\nTest suite:\nUse the following parameter sets, each yielding a single floating-point result (the capacity fade in $\\mathrm{mAh}$). All unspecified constants must be taken exactly as given, and all numbers below are exact values for this problem.\n\nCommon parameters for all tests:\n- $A_{\\mathrm{geom}} = 0.08\\,\\mathrm{m^{2}}$\n- $L = 70\\times 10^{-6}\\,\\mathrm{m}$\n- $a_{s} = 2.0\\times 10^{5}\\,\\mathrm{m^{2}\\,m^{-3}}$\n- $k_{\\mathrm{ref}} = 0.08\\,\\mathrm{A\\,m^{-2}\\,s^{1/2}}$\n- $E_{a} = 35000\\,\\mathrm{J\\,mol^{-1}}$\n- $T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$\n- $\\beta = 2.0$ (dimensionless)\n- $\\mathrm{SoC}_{\\mathrm{ref}} = 0.5$ (dimensionless)\n- $t_{0} = 100000\\,\\mathrm{s}$\n\nIndividual test cases:\n- Case $1$ (happy path, baseline calendar year at moderate conditions): $t = 31536000\\,\\mathrm{s}$, $T = 298\\,\\mathrm{K}$, $\\mathrm{SoC} = 0.5$.\n- Case $2$ (boundary condition at zero elapsed time): $t = 0\\,\\mathrm{s}$, $T = 298\\,\\mathrm{K}$, $\\mathrm{SoC} = 0.5$.\n- Case $3$ (elevated temperature and high state of charge): $t = 31536000\\,\\mathrm{s}$, $T = 323\\,\\mathrm{K}$, $\\mathrm{SoC} = 0.8$.\n- Case $4$ (low state of charge at baseline temperature): $t = 31536000\\,\\mathrm{s}$, $T = 298\\,\\mathrm{K}$, $\\mathrm{SoC} = 0.1$.\n\nProgram requirements:\n- Implement the computation for $Q(t)$ in $\\mathrm{mAh}$ for each case using only the provided bases and definitions.\n- Use the universal gas constant $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- Round each result to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\") with each result printed as a decimal with exactly six digits after the decimal point, in the order of the cases above.",
            "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded in established battery aging models, mathematically well-posed, objective, and contains all necessary information for a unique solution. The derivation and implementation of the capacity fade formula can proceed.\n\nThe primary task is to derive an analytical expression for the capacity fade, $Q(t)$, in milliampere-hours ($\\mathrm{mAh}$) and then implement this expression numerically for a given set of parameters.\n\nThe capacity fade is due to a parasitic side reaction. The total parasitic current, $I_{\\text{side}}(t)$, is the side-reaction current density, $j_{\\text{side}}(t)$, integrated over the total true electrode surface area, $S$. Assuming the current density is uniform across the surface, this integral simplifies to a multiplication:\n$$\nI_{\\text{side}}(t) = j_{\\text{side}}(t) \\cdot S\n$$\nThe total true surface area, $S$, is given by the product of the specific surface area, $a_s$, the electrode geometric area, $A_{\\text{geom}}$, and the electrode thickness, $L$:\n$$\nS = a_{s} A_{\\mathrm{geom}} L\n$$\nThe side-reaction current density, $j_{\\text{side}}(t)$, is modeled by the function:\n$$\nj_{\\text{side}}(t; T, \\mathrm{SoC}) = k_{\\mathrm{ref}} \\exp\\left(-\\frac{E_{a}}{R}\\left(\\frac{1}{T} - \\frac{1}{T_{\\mathrm{ref}}}\\right)\\right) \\exp\\left(\\beta\\left(\\mathrm{SoC}-\\mathrm{SoC}_{\\mathrm{ref}}\\right)\\right) \\left(t + t_{0}\\right)^{-1/2}\n$$\nwhere the parameters are functions of temperature ($T$), State of Charge ($\\mathrm{SoC}$), and time ($t$). Thus, the total parasitic current at any time $t$ is:\n$$\nI_{\\text{side}}(t) = (a_{s} A_{\\mathrm{geom}} L) \\cdot \\left[ k_{\\mathrm{ref}} \\exp\\left(-\\frac{E_{a}}{R}\\left(\\frac{1}{T} - \\frac{1}{T_{\\mathrm{ref}}}\\right)\\right) \\exp\\left(\\beta\\left(\\mathrm{SoC}-\\mathrm{SoC}_{\\mathrm{ref}}\\right)\\right) \\left(t + t_{0}\\right)^{-1/2} \\right]\n$$\nThe total charge lost, $\\Delta C(t)$, over a time interval from $0$ to $t$ is the time integral of the parasitic current $I_{\\text{side}}(t)$. For this calculation, we integrate with respect to a dummy variable $\\tau$ from $0$ to $t$.\n$$\n\\Delta C(t) = \\int_{0}^{t} I_{\\text{side}}(\\tau) \\,d\\tau\n$$\nThe parameters $T$ and $\\mathrm{SoC}$ are assumed to be constant during the calendar aging period. Therefore, all terms in the expression for $I_{\\text{side}}(\\tau)$ are constant with respect to the integration variable $\\tau$, except for the term $(\\tau + t_{0})^{-1/2}$. We can factor the constant terms out of the integral. Let's define a collective constant factor $K'$ for brevity:\n$$\nK' = (a_{s} A_{\\mathrm{geom}} L) \\cdot k_{\\mathrm{ref}} \\exp\\left(-\\frac{E_{a}}{R}\\left(\\frac{1}{T} - \\frac{1}{T_{\\mathrm{ref}}}\\right)\\right) \\exp\\left(\\beta\\left(\\mathrm{SoC}-\\mathrm{SoC}_{\\mathrm{ref}}\\right)\\right)\n$$\nThe units of $K'$ are $\\mathrm{m^{-1}} \\cdot \\mathrm{m^2} \\cdot \\mathrm{m} \\cdot \\mathrm{A\\,m^{-2}\\,s^{1/2}} = \\mathrm{A \\cdot s^{1/2}}$. The integral for the lost charge becomes:\n$$\n\\Delta C(t) = K' \\int_{0}^{t} (\\tau + t_{0})^{-1/2} \\,d\\tau\n$$\nThe integral evaluates as follows:\n$$\n\\int_{0}^{t} (\\tau + t_{0})^{-1/2} \\,d\\tau = \\left[ \\frac{(\\tau + t_{0})^{1/2}}{1/2} \\right]_{0}^{t} = \\left[ 2\\sqrt{\\tau + t_{0}} \\right]_{0}^{t} = 2\\sqrt{t + t_{0}} - 2\\sqrt{0 + t_{0}} = 2\\left(\\sqrt{t + t_{0}} - \\sqrt{t_{0}}\\right)\n$$\nThe units of this result are $\\mathrm{s^{1/2}}$, so the units of $\\Delta C(t)$ are $(\\mathrm{A \\cdot s^{1/2}}) \\cdot \\mathrm{s^{1/2}} = \\mathrm{A \\cdot s}$, which is Coulombs. This is dimensionally consistent.\n\nSubstituting this result back, we obtain the total lost charge in Coulombs:\n$$\n\\Delta C(t) = 2 K' \\left(\\sqrt{t + t_{0}} - \\sqrt{t_{0}}\\right)\n$$\nThe final step is to convert this lost charge, $\\Delta C(t)$, from Coulombs ($\\mathrm{A \\cdot s}$) to milliampere-hours ($\\mathrm{mAh}$). There are $3600$ seconds in an hour.\n$$\nQ(t) \\text{ in Ah} = \\frac{\\Delta C(t) \\text{ in A}\\cdot\\text{s}}{3600 \\text{ s/h}}\n$$\nTo convert from Ampere-hours ($\\mathrm{Ah}$) to milliampere-hours ($\\mathrm{mAh}$), we multiply by $1000$:\n$$\nQ(t) \\text{ in mAh} = Q(t) \\text{ in Ah} \\times 1000 \\text{ mA/A} = \\frac{\\Delta C(t)}{3600} \\times 1000 = \\frac{\\Delta C(t)}{3.6}\n$$\nCombining all the pieces gives the final expression for the capacity fade $Q(t)$ in $\\mathrm{mAh}$:\n$$\nQ(t) = \\frac{1000}{3600} \\cdot 2 \\cdot (a_{s} A_{\\mathrm{geom}} L) \\cdot k_{\\mathrm{ref}} \\exp\\left(-\\frac{E_{a}}{R}\\left(\\frac{1}{T} - \\frac{1}{T_{\\mathrm{ref}}}\\right)\\right) \\exp\\left(\\beta\\left(\\mathrm{SoC}-\\mathrm{SoC}_{\\mathrm{ref}}\\right)\\right) \\left(\\sqrt{t + t_{0}} - \\sqrt{t_{0}}\\right)\n$$\nThis is the equation to be implemented. The program will calculate $Q(t)$ for each of the four test cases using the provided parameters.\n\nThe parameters are:\n- $A_{\\mathrm{geom}} = 0.08\\,\\mathrm{m^{2}}$\n- $L = 70 \\times 10^{-6}\\,\\mathrm{m}$\n- $a_{s} = 2.0 \\times 10^{5}\\,\\mathrm{m^{-1}}$\n- $k_{\\mathrm{ref}} = 0.08\\,\\mathrm{A\\,m^{-2}\\,s^{1/2}}$\n- $E_{a} = 35000\\,\\mathrm{J\\,mol^{-1}}$\n- $T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$\n- $\\beta = 2.0$\n- $\\mathrm{SoC}_{\\mathrm{ref}} = 0.5$\n- $t_{0} = 100000\\,\\mathrm{s}$\n- $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\nThe implementation will substitute these constants and the specific values for $t$, $T$, and $\\mathrm{SoC}$ from each test case into the final derived equation for $Q(t)$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes lithium-ion battery calendar fade based on a parasitic side reaction model.\n    The capacity fade Q(t) is derived by integrating the side-reaction current density\n    over the electrode surface and time.\n    \"\"\"\n\n    # Common physical and model parameters\n    A_geom = 0.08  # Geometric area in m^2\n    L = 70e-6  # Electrode thickness in m\n    a_s = 2.0e5  # Specific surface area in m^2/m^3 (or m^-1)\n    k_ref = 0.08  # Reference reaction rate constant in A m^-2 s^(1/2)\n    E_a = 35000.0  # Activation energy in J mol^-1\n    T_ref = 298.0  # Reference temperature in K\n    beta = 2.0  # SoC dependence factor (dimensionless)\n    SoC_ref = 0.5  # Reference State of Charge (dimensionless)\n    t0 = 100000.0  # Initial time offset for film growth in s\n    R = 8.314462618  # Universal gas constant in J mol^-1 K^-1\n\n    # Individual test cases: (t in s, T in K, SoC)\n    test_cases = [\n        (31536000.0, 298.0, 0.5),  # Case 1: Baseline\n        (0.0, 298.0, 0.5),         # Case 2: Zero elapsed time\n        (31536000.0, 323.0, 0.8),  # Case 3: Elevated T and SoC\n        (31536000.0, 298.0, 0.1),  # Case 4: Low SoC\n    ]\n\n    results = []\n    \n    # Pre-calculate surface area\n    S = a_s * A_geom * L  # Total true surface area in m^2\n\n    for case in test_cases:\n        t, T, SoC = case\n\n        # Derived formula for capacity fade Q(t) in mAh\n        \n        # 1. Temperature-dependent term (Arrhenius)\n        temp_term = np.exp((-E_a / R) * (1.0 / T - 1.0 / T_ref))\n        \n        # 2. SoC-dependent term\n        soc_term = np.exp(beta * (SoC - SoC_ref))\n        \n        # 3. Time-dependent term from integration\n        # Integral of (tau + t0)^(-1/2) from 0 to t is 2*(sqrt(t + t0) - sqrt(t0))\n        if t + t0  0: # Physicality check\n             time_integral_term = 0.0\n        else:\n             time_integral_term = 2.0 * (np.sqrt(t + t0) - np.sqrt(t0))\n\n        # 4. Combine terms to get total lost charge in Coulombs (A*s).\n        # From the derivation: Lost Charge = (Constant Factors) * (Time-Integrated Part).\n        K_prime = S * k_ref * temp_term * soc_term\n        lost_charge_coulombs = K_prime * time_integral_term\n        \n        # 5. Convert lost charge from Coulombs (A.s) to mAh\n        # 1 mAh = 1e-3 A * 3600 s = 3.6 Coulombs\n        capacity_fade_mAh = lost_charge_coulombs / 3.6\n        \n        results.append(capacity_fade_mAh)\n\n    # Format results to six decimal places for the final output string\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Capacity fade is only one manifestation of aging; another is impedance growth, which impacts power capability and efficiency. This final practice challenges you to simulate how a growing resistive film affects a battery's terminal voltage under a dynamic current profile. By combining models for equilibrium potential, kinetics, and degradation, you will gain insight into how internal state changes are reflected in externally measurable performance. ",
            "id": "3897799",
            "problem": "You are tasked with deriving, implementing, and evaluating how resistive film growth at the electrode–electrolyte interface introduces a time-varying interfacial resistance $R_{\\text{film}}(t)$ that modifies the interfacial overpotential $\\eta$ and, consequently, the terminal voltage under a standard current profile. You must begin from foundational electrochemical and transport principles and produce a complete, runnable program that computes the terminal voltage at the end of specified current profiles for a small test suite.\n\nStart from the following fundamental bases:\n\n- Ohm’s law: the voltage drop across any resistive element is $I R$, where $I$ is current and $R$ is resistance.\n- Charge conservation for state of charge: the state of charge $z(t)$ evolves under a constant current $I$ through $z(t+\\Delta t) = z(t) - \\frac{I \\Delta t}{C}$, where $C$ is the total cell capacity in coulombs.\n- Butler–Volmer equation for symmetric charge transfer (with equal anodic and cathodic transfer coefficients), which relates the interfacial overpotential $\\eta$ to the current density $j$ and the exchange current density $i_0$; this relationship can be inverted to express $\\eta$ in terms of $j$ and $i_0$.\n- The Nernst equation for open-circuit potential, relating the equilibrium potential to the ratio of oxidized and reduced species activities, which for a simplified single-site intercalation can be expressed as a function of $z$.\n- Diffusion-limited film growth: the interphase thickness grows approximately as the square root of time due to semi-infinite diffusion, and the resistance is proportional to thickness. Temperature affects the diffusivity via an Arrhenius-type dependence.\n\nDefinitions and models to be used:\n\n1. Let the open-circuit potential be modeled as\n$$\nU(z,T) = U_0 + \\frac{R T}{F}\\,\\ln\\!\\left(\\frac{1 - z}{z}\\right),\n$$\nwhere $U_0$ is a constant baseline potential, $R$ is the universal gas constant, $T$ is temperature in kelvins, $F$ is Faraday’s constant, and $z \\in (0,1)$ is the state of charge.\n\n2. The exchange current density is modeled as\n$$\ni_0(z,T) = i_{0,\\text{ref}}\\,\\sqrt{z(1-z)},\n$$\nwith $i_{0,\\text{ref}}$ a reference exchange current density constant.\n\n3. For symmetric Butler–Volmer kinetics, the interfacial overpotential under a current density $j = I/A$ (with $A$ the geometric area) is\n$$\n\\eta_{\\text{ct}}(I,T,z) = \\frac{2 R T}{F}\\,\\operatorname{arcsinh}\\!\\left(\\frac{I/A}{2\\,i_0(z,T)}\\right).\n$$\n\n4. The film resistance grows with an effective time that captures both calendar time and accelerated cycle contributions. Define the effective time\n$$\nt_{\\text{eff}} = \\sum_k \\Delta t_k + c\\,\\sum_k |I_k|\\,\\Delta t_k,\n$$\nwhere $(I_k,\\Delta t_k)$ are the segments of a piecewise-constant current profile, and $c$ has units of seconds per coulomb. The film resistance is\n$$\nR_{\\text{film}}(t_{\\text{end}},T) = R_{\\text{film},0} + K(T)\\,\\sqrt{t_{\\text{eff}}},\n$$\nwith\n$$\nK(T) = K_0\\,\\exp\\!\\left(-\\frac{E_a}{R T}\\right),\n$$\nwhere $R_{\\text{film},0}$ is the initial film resistance, $K_0$ is a prefactor (units of ohm per square-root second), and $E_a$ is an activation energy.\n\n5. The terminal voltage at the end of the profile is then\n$$\nV_{\\text{end}} = U\\!\\big(z_{\\text{end}},T\\big) - I_{\\text{last}}\\left(R_{\\text{ohm}} + R_{\\text{film}}(t_{\\text{end}},T)\\right) - \\eta_{\\text{ct}}\\!\\left(I_{\\text{last}},T,z_{\\text{end}}\\right),\n$$\nwhere $I_{\\text{last}}$ is the current during the last segment, $R_{\\text{ohm}}$ is the bulk ohmic resistance, and $z_{\\text{end}}$ is the final state of charge after applying the full current profile.\n\nAssumptions:\n\n- Use $n=1$ electron per reaction event (absorbed into the capacity representation).\n- Clamp $z$ to $(\\varepsilon, 1-\\varepsilon)$ with a small $\\varepsilon$ to avoid singularities in the logarithm.\n- Treat temperature $T$ as constant over each test case.\n- The current profile is piecewise constant; $I0$ denotes discharge and $I0$ denotes charge.\n\nTask:\n\n- Implement a program that computes $V_{\\text{end}}$ for each test case defined below using the models and definitions above. Express the terminal voltage in volts (V), rounded to six decimal places.\n- For each test case, apply the current segments sequentially to update $z$, accumulate $t_{\\text{eff}}$, compute $R_{\\text{film}}(t_{\\text{end}},T)$, and then compute $V_{\\text{end}}$ using the last segment’s current.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$).\n\nConstants common to all test cases:\n\n- Faraday constant $F = 96485$ C/mol.\n- Gas constant $R = 8.314$ J/(mol K).\n- Geometric area $A = 0.020$ m$^2$.\n- Total capacity $C = 7200$ C.\n- Baseline potential $U_0 = 3.5$ V.\n- Reference exchange current density $i_{0,\\text{ref}} = 2.0$ A/m$^2$.\n- Bulk ohmic resistance $R_{\\text{ohm}} = 0.05$ $\\Omega$.\n- Initial film resistance $R_{\\text{film},0} = 0.01$ $\\Omega$.\n- Film growth prefactor $K_0 = 1.0 \\times 10^{-3}$ $\\Omega \\cdot \\text{s}^{-1/2}$.\n- Activation energy $E_a = 10000$ J/mol.\n- Cycle acceleration factor $c = 0.05$ s/C.\n- Initial state of charge $z_0 = 0.60$.\n- State-of-charge clamp $\\varepsilon = 10^{-6}$.\n\nTest suite:\n\n- Case 1 (general case, mixed discharge/rest/charge at moderate temperature): $T = 298$ K, current profile segments $(I_k,\\Delta t_k)$ are $\\left[(1.0, 1800), (0.0, 600), (-0.8, 1200)\\right]$ in amperes and seconds. Report $V_{\\text{end}}$ in volts (V), rounded to six decimal places.\n\n- Case 2 (higher temperature to test Arrhenius acceleration): $T = 323$ K, current profile segments identical to Case 1: $\\left[(1.0, 1800), (0.0, 600), (-0.8, 1200)\\right]$. Report $V_{\\text{end}}$ in volts (V), rounded to six decimal places.\n\n- Case 3 (boundary condition: pure rest, no current): $T = 298$ K, current profile segments $\\left[(0.0, 3600)\\right]$. Report $V_{\\text{end}}$ in volts (V), rounded to six decimal places.\n\n- Case 4 (edge case: short, relatively high discharge without subsequent rest): $T = 298$ K, current profile segments $\\left[(3.0, 600)\\right]$. Report $V_{\\text{end}}$ in volts (V), rounded to six decimal places.\n\nFinal output format:\n\n- Your program should produce exactly one line: a single list of four floating-point numbers corresponding to $V_{\\text{end}}$ for Cases 1 through 4, rounded to six decimal places, and formatted as $\\left[\\text{v}_1,\\text{v}_2,\\text{v}_3,\\text{v}_4\\right]$.",
            "solution": "The problem is valid as it presents a self-contained, scientifically-grounded battery modeling task based on established electrochemical principles. It is well-posed, with all necessary constants, models, and initial conditions provided to compute a unique solution. The models for open-circuit potential, electrode kinetics, and degradation are standard, simplified representations used in the field of battery simulation.\n\nThe solution is derived by systematically applying the provided models to simulate the battery's state over a piecewise-constant current profile and then calculating the terminal voltage at the end of the profile. The derivation and algorithmic implementation proceed as follows.\n\n### 1. State Evolution and Degradation\n\nThe state of the battery is characterized by its state of charge (SOC), denoted by $z$, and the accumulated interfacial film resistance, $R_{\\text{film}}$. These quantities evolve over the duration of the current profile.\n\n- **State of Charge ($z$)**: The SOC is a normalized measure of the remaining charge. For a piecewise-constant current profile consisting of segments $(I_k, \\Delta t_k)$, where $I_k$ is the current during the time interval $\\Delta t_k$, the SOC is updated sequentially. Starting from an initial state $z_0$, the SOC after segment $k$ is given by the principle of charge conservation:\n$$\nz_k = z_{k-1} - \\frac{I_k \\Delta t_k}{C}\n$$\nHere, $C$ is the total capacity in coulombs. A positive current $I_k  0$ corresponds to discharge, decreasing $z$, while a negative current $I_k  0$ corresponds to charge, increasing $z$. To prevent numerical singularities at the boundaries $z=0$ and $z=1$ in subsequent calculations, the value of $z$ is clamped to the interval $[\\varepsilon, 1-\\varepsilon]$ after each update, where $\\varepsilon = 10^{-6}$ is a small positive constant.\n\n- **Film Resistance ($R_{\\text{film}}$)**: The growth of a resistive film on the electrode surface contributes to battery degradation. The problem defines a model where this resistance increases with an \"effective time,\" $t_{\\text{eff}}$, which accounts for both calendar time (time at rest) and cycle-induced stress. The effective time after a series of $N$ segments is:\n$$\nt_{\\text{eff}} = \\sum_{k=1}^{N} \\left(\\Delta t_k + c\\,|I_k|\\,\\Delta t_k\\right)\n$$\nThe term $c\\,|I_k|\\,\\Delta t_k$ models the acceleration of degradation due to charge throughput, with $c$ being the cycle acceleration factor. The film resistance grows as the square root of this effective time, consistent with a diffusion-limited growth process:\n$$\nR_{\\text{film}}(t_{\\text{end}}, T) = R_{\\text{film},0} + K(T)\\,\\sqrt{t_{\\text{eff}}}\n$$\nwhere $R_{\\text{film},0}$ is the initial resistance. The growth rate constant, $K(T)$, is temperature-dependent, following an Arrhenius relationship:\n$$\nK(T) = K_0\\,\\exp\\!\\left(-\\frac{E_a}{R T}\\right)\n$$\nwhere $K_0$ is a pre-exponential factor, $E_a$ is the activation energy, $R$ is the gas constant, and $T$ is the absolute temperature.\n\n### 2. Terminal Voltage Calculation\n\nAt the end of the entire current profile, the terminal voltage $V_{\\text{end}}$ is calculated. It is the sum of the equilibrium potential and all overpotentials (voltage losses or gains). The final state of charge is $z_{\\text{end}}$ and the current during the last segment is $I_{\\text{last}}$.\n\n- **Open-Circuit Potential ($U$)**: This is the equilibrium potential of the cell at a given SOC and temperature, when no current is flowing. It is modeled by the Nernst equation for a single-site intercalation reaction:\n$$\nU(z_{\\text{end}}, T) = U_0 + \\frac{R T}{F}\\,\\ln\\!\\left(\\frac{1 - z_{\\text{end}}}{z_{\\text{end}}}\\right)\n$$\nwhere $U_0$ is a baseline potential and $F$ is Faraday's constant.\n\n- **Ohmic Overpotential ($\\eta_{\\text{ohm}}$)**: This is the voltage drop due to the total internal resistance of the cell, which comprises a constant bulk ohmic resistance, $R_{\\text{ohm}}$, and the time-evolved film resistance, $R_{\\text{film}}$. According to Ohm's law, this voltage drop is $I_{\\text{last}}(R_{\\text{ohm}} + R_{\\text{film}})$.\n\n- **Charge Transfer Overpotential ($\\eta_{\\text{ct}}$)**: This overpotential arises from the kinetic barrier to the electrochemical reaction at the electrode-electrolyte interface. For a symmetric reaction, its dependence on current density ($j=I/A$), SOC, and temperature is given by the inverted Butler-Volmer equation:\n$$\n\\eta_{\\text{ct}}(I_{\\text{last}}, T, z_{\\text{end}}) = \\frac{2 R T}{F}\\,\\operatorname{arcsinh}\\!\\left(\\frac{I_{\\text{last}}/A}{2\\,i_0(z_{\\text{end}}, T)}\\right)\n$$\nThe exchange current density, $i_0$, represents the rate of reaction at equilibrium and is itself dependent on SOC:\n$$\ni_0(z_{\\text{end}}, T) = i_{0,\\text{ref}}\\,\\sqrt{z_{\\text{end}}(1-z_{\\text{end}})}\n$$\nwhere $i_{0,\\text{ref}}$ is a reference constant and $A$ is the electrode geometric area.\n\n- **Total Terminal Voltage ($V_{\\text{end}}$)**: The final terminal voltage is the sum of the open-circuit potential and the overpotentials. By convention, overpotentials that impede the desired process (e.g., reduce voltage on discharge, increase it on charge) are subtracted from the OCP if defined as positive quantities. The given formula correctly assembles these terms:\n$$\nV_{\\text{end}} = U(z_{\\text{end}}, T) - I_{\\text{last}}\\left(R_{\\text{ohm}} + R_{\\text{film}}(t_{\\text{end}}, T)\\right) - \\eta_{\\text{ct}}(I_{\\text{last}}, T, z_{\\text{end}})\n$$\nFor discharge ($I_{\\text{last}}0$), both the ohmic drop and $\\eta_{\\text{ct}}$ are positive, reducing $V_{\\text{end}}$ below $U$. For charge ($I_{\\text{last}}0$), the ohmic term becomes positive ($-I_{\\text{last}}R  0$) and $\\eta_{\\text{ct}}$ becomes negative (due to $\\operatorname{arcsinh}$ being an odd function), so both terms increase $V_{\\text{end}}$ above $U$, as required to drive the charging current. If $I_{\\text{last}}=0$, both overpotential terms are zero, and $V_{\\text{end}} = U(z_{\\text{end}}, T)$.\n\n### 3. Algorithmic Procedure\n\nThe computation for each test case proceeds as follows:\n1.  Initialize $z \\leftarrow z_0 = 0.60$ and $t_{\\text{eff}} \\leftarrow 0$.\n2.  For each segment $(I_k, \\Delta t_k)$ in the provided current profile:\n    a.  Update effective time: $t_{\\text{eff}} \\leftarrow t_{\\text{eff}} + \\Delta t_k + c\\,|I_k|\\,\\Delta t_k$.\n    b.  Update state of charge: $z \\leftarrow z - (I_k \\Delta t_k) / C$.\n    c.  Clamp the new SOC: $z \\leftarrow \\max(\\varepsilon, \\min(z, 1-\\varepsilon))$.\n3.  After iterating through all segments, retain the final values $z_{\\text{end}} = z$ and $t_{\\text{eff}}$, and identify the last current $I_{\\text{last}}$.\n4.  Calculate $U(z_{\\text{end}}, T)$ using the Nernst model.\n5.  Calculate $K(T)$ using the Arrhenius model.\n6.  Calculate $R_{\\text{film}}$ using the final $t_{\\text{eff}}$ and $K(T)$.\n7.  Calculate $i_0(z_{\\text{end}}, T)$ for the charge transfer kinetics.\n8.  Calculate $\\eta_{\\text{ct}}(I_{\\text{last}}, T, z_{\\text{end}})$ using the Butler-Volmer model.\n9.  Combine all components to compute the final terminal voltage $V_{\\text{end}}$.\n10. Round the result to six decimal places.\n\nThis procedure is applied to each of the four test cases to generate the final list of results.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the terminal voltage of a battery cell at the end of specified current profiles,\n    considering state-dependent potentials and degradation from film growth.\n    \"\"\"\n\n    # --- Constants common to all test cases ---\n    F = 96485.0  # Faraday constant in C/mol\n    R = 8.314  # Gas constant in J/(mol K)\n    A = 0.020  # Geometric area in m^2\n    C = 7200.0  # Total capacity in C\n    U0 = 3.5  # Baseline potential in V\n    i0_ref = 2.0  # Reference exchange current density in A/m^2\n    R_ohm = 0.05  # Bulk ohmic resistance in Ohm\n    R_film0 = 0.01  # Initial film resistance in Ohm\n    K0 = 1.0e-3  # Film growth prefactor in Ohm*s^(-1/2)\n    Ea = 10000.0  # Activation energy in J/mol\n    c_accel = 0.05  # Cycle acceleration factor in s/C\n    z0 = 0.60  # Initial state of charge (dimensionless)\n    eps = 1.0e-6  # State-of-charge clamp\n\n    test_cases = [\n        # Case 1: General case, mixed discharge/rest/charge at moderate temperature\n        {'T': 298.0, 'profile': [(1.0, 1800.0), (0.0, 600.0), (-0.8, 1200.0)]},\n        # Case 2: Higher temperature to test Arrhenius acceleration\n        {'T': 323.0, 'profile': [(1.0, 1800.0), (0.0, 600.0), (-0.8, 1200.0)]},\n        # Case 3: Boundary condition: pure rest, no current\n        {'T': 298.0, 'profile': [(0.0, 3600.0)]},\n        # Case 4: Edge case: short, high discharge\n        {'T': 298.0, 'profile': [(3.0, 600.0)]},\n    ]\n\n    # --- Model Functions ---\n\n    def calculate_U(z, T):\n        \"\"\"Calculates open-circuit potential U(z, T).\"\"\"\n        return U0 + (R * T / F) * np.log((1 - z) / z)\n\n    def calculate_K(T):\n        \"\"\"Calculates temperature-dependent film growth factor K(T).\"\"\"\n        return K0 * np.exp(-Ea / (R * T))\n\n    def calculate_i0(z):\n        \"\"\"Calculates exchange current density i0(z).\"\"\"\n        return i0_ref * np.sqrt(z * (1 - z))\n\n    def calculate_eta_ct(I, T, z):\n        \"\"\"Calculates charge transfer overpotential eta_ct(I, T, z).\"\"\"\n        if I == 0:\n            return 0.0\n        \n        i_0 = calculate_i0(z)\n        # Prevent division by zero if z is exactly 0 or 1, though clamping should prevent this.\n        if i_0 == 0:\n            # An infinite overpotential would be physically correct, but we return a large number\n            # for numerical stability if clamping fails. Realistically will not be triggered.\n            return np.sign(I) * np.inf\n\n        j = I / A\n        arg = j / (2 * i_0)\n        return (2 * R * T / F) * np.arcsinh(arg)\n\n    results = []\n    for case in test_cases:\n        T = case['T']\n        profile = case['profile']\n        \n        # Initialize state for the current test case\n        z = z0\n        t_eff = 0.0\n\n        # Sequentially apply current profile segments\n        for I_k, dt_k in profile:\n            # Update effective time\n            t_eff += dt_k + c_accel * abs(I_k) * dt_k\n            \n            # Update state of charge\n            z -= (I_k * dt_k) / C\n            \n            # Clamp state of charge\n            z = np.clip(z, eps, 1 - eps)\n\n        z_end = z\n        I_last = profile[-1][0] if profile else 0.0\n\n        # --- Calculate final voltage components ---\n        \n        # 1. Open-circuit potential\n        U_end = calculate_U(z_end, T)\n        \n        # 2. Film resistance\n        K_T = calculate_K(T)\n        R_film_end = R_film0 + K_T * np.sqrt(t_eff)\n        \n        # 3. Total ohmic resistance drop\n        ohmic_drop = I_last * (R_ohm + R_film_end)\n        \n        # 4. Charge transfer overpotential\n        eta_ct_end = calculate_eta_ct(I_last, T, z_end)\n        \n        # 5. Final terminal voltage\n        V_end = U_end - ohmic_drop - eta_ct_end\n        \n        results.append(round(V_end, 6))\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}