{
    "hands_on_practices": [
        {
            "introduction": "The physical dynamics of a battery are inherently continuous, but a digital Battery Management System (BMS) operates in discrete time steps. This exercise provides hands-on practice in bridging this gap by deriving the exact discrete-time representation of a fundamental equivalent circuit model component. Mastering this conversion is a cornerstone for implementing any high-fidelity model-based algorithm on a microprocessor. ",
            "id": "3896581",
            "problem": "Consider a single polarization branch of an Equivalent Circuit Model (ECM) used in a Battery Management System (BMS) for State of Charge (SOC) and State of Health (SOH) estimation. The polarization voltage state is denoted by $v_{p}(t)$, the branch resistance and capacitance are $R_{p} > 0$ and $C_{p} > 0$, respectively, and the applied current is $i(t)$, with the sign convention that positive $i(t)$ corresponds to discharge. The continuous-time dynamics of the polarization voltage are given by the linear time-invariant ordinary differential equation\n$$\n\\frac{d}{dt} v_{p}(t) = -\\frac{1}{R_{p} C_{p}}\\, v_{p}(t) + \\frac{1}{C_{p}}\\, i(t).\n$$\nLet the sampling period be $T_{s} > 0$, and define sampling instants $t_{k} = k T_{s}$ for integer $k \\ge 0$. Assume a zero-order hold (ZOH) on the input current over each sampling interval, i.e., $i(t) = i_{k}$ for all $t \\in [t_{k}, t_{k+1})$. Using only fundamental properties of linear time-invariant systems and the matrix exponential, derive the exact discrete-time state transition that maps $v_{p,k} \\triangleq v_{p}(t_{k})$ and $i_{k}$ to $v_{p,k+1} \\triangleq v_{p}(t_{k+1})$ under the ZOH assumption. Express your final result as a single closed-form analytic expression in terms of $v_{p,k}$, $i_{k}$, $R_{p}$, $C_{p}$, and $T_{s}$. No numerical evaluation is required. Do not include physical units in your final expression. The final answer must be a single expression.",
            "solution": "The problem of deriving the exact discrete-time state transition for the given continuous-time system is determined to be valid. The problem is scientifically grounded in the principles of circuit theory and linear time-invariant (LTI) systems, is well-posed with sufficient information for a unique solution, and is expressed in objective, formal language. We may, therefore, proceed with the derivation.\n\nThe continuous-time dynamics of the polarization voltage $v_{p}(t)$ are given by the linear ordinary differential equation (ODE):\n$$\n\\frac{d}{dt} v_{p}(t) = -\\frac{1}{R_{p} C_{p}}\\, v_{p}(t) + \\frac{1}{C_{p}}\\, i(t)\n$$\nThis is a scalar LTI state-space model of the form $\\frac{d}{dt}x(t) = Ax(t) + Bu(t)$, where the state is $x(t) = v_{p}(t)$, the input is $u(t) = i(t)$, and the system matrices are the scalars:\n$$\nA = -\\frac{1}{R_{p} C_{p}}\n$$\n$$\nB = \\frac{1}{C_{p}}\n$$\nThe problem requires finding the relationship between the state at time $t_{k+1}$ and the state at time $t_k$, where $t_{k+1} = t_k + T_s$. The general solution to an LTI system over a time interval $[t_k, t_{k+1}]$ is given by the variation of parameters formula, which utilizes the matrix exponential (in this case, the scalar exponential):\n$$\nx(t_{k+1}) = e^{A(t_{k+1} - t_k)} x(t_k) + \\int_{t_k}^{t_{k+1}} e^{A(t_{k+1} - \\tau)} B u(\\tau) \\,d\\tau\n$$\nSubstituting the problem-specific variables and definitions $x(t_k) = v_{p,k}$, $u(\\tau) = i(\\tau)$, and $t_{k+1} - t_k = T_s$, we get:\n$$\nv_{p,k+1} = e^{A T_s} v_{p,k} + \\int_{t_k}^{t_{k+1}} e^{A(t_{k+1} - \\tau)} B i(\\tau) \\,d\\tau\n$$\nThe problem specifies a zero-order hold (ZOH) on the input current, meaning the current $i(t)$ is constant over the sampling interval, i.e., $i(t) = i_k$ for all $t \\in [t_{k}, t_{k+1})$. Since $B$ and $i_k$ are constant over the integration interval, they can be moved outside the integral:\n$$\nv_{p,k+1} = e^{A T_s} v_{p,k} + \\left( \\int_{t_k}^{t_{k+1}} e^{A(t_{k+1} - \\tau)} \\,d\\tau \\right) B i_k\n$$\nTo evaluate the integral, we perform a change of variables. Let $s = t_{k+1} - \\tau$. Then, $ds = -d\\tau$. The limits of integration change from $\\tau = t_k$ to $s = t_{k+1} - t_k = T_s$, and from $\\tau = t_{k+1}$ to $s = t_{k+1} - t_{k+1} = 0$. The integral becomes:\n$$\n\\int_{t_k}^{t_{k+1}} e^{A(t_{k+1} - \\tau)} \\,d\\tau = \\int_{T_s}^{0} e^{As} (-ds) = \\int_{0}^{T_s} e^{As} \\,ds\n$$\nThe integral of the exponential function is given by $\\int e^{As} ds = A^{-1}e^{As}$ for an invertible scalar or matrix $A$. Since $R_p > 0$ and $C_p > 0$, our scalar $A = -1/(R_p C_p)$ is non-zero and therefore invertible. Thus, we can evaluate the definite integral:\n$$\n\\int_{0}^{T_s} e^{As} \\,ds = \\left[ A^{-1} e^{As} \\right]_{0}^{T_s} = A^{-1} (e^{A T_s} - e^{A \\cdot 0}) = A^{-1} (e^{A T_s} - 1)\n$$\nSubstituting this result back into the expression for $v_{p,k+1}$:\n$$\nv_{p,k+1} = e^{A T_s} v_{p,k} + A^{-1} (e^{A T_s} - 1) B i_k\n$$\nThis is the general form for the exact discretization of a single-input LTI system under a ZOH. We now substitute the specific expressions for $A$, $B$, and $A^{-1}$:\n$$\nA = -\\frac{1}{R_{p} C_{p}}\n$$\n$$\nB = \\frac{1}{C_{p}}\n$$\n$$\nA^{-1} = -R_{p} C_{p}\n$$\nThe term multiplying $v_{p,k}$ is:\n$$\ne^{A T_s} = \\exp\\left(-\\frac{T_s}{R_p C_p}\\right)\n$$\nThe term multiplying $i_k$ is:\n$$\nA^{-1} (e^{A T_s} - 1) B = (-R_p C_p) \\left( \\exp\\left(-\\frac{T_s}{R_p C_p}\\right) - 1 \\right) \\left( \\frac{1}{C_p} \\right)\n$$\nSimplifying this coefficient gives:\n$$\n-R_p \\left( \\exp\\left(-\\frac{T_s}{R_p C_p}\\right) - 1 \\right) = R_p \\left( 1 - \\exp\\left(-\\frac{T_s}{R_p C_p}\\right) \\right)\n$$\nCombining these results, we obtain the final closed-form analytic expression for the discrete-time state transition:\n$$\nv_{p,k+1} = \\exp\\left(-\\frac{T_s}{R_p C_p}\\right) v_{p,k} + R_p \\left( 1 - \\exp\\left(-\\frac{T_s}{R_p C_p}\\right) \\right) i_k\n$$\nThis expression exactly maps the state $v_{p,k}$ and input $i_k$ at time step $k$ to the state $v_{p,k+1}$ at time step $k+1$.",
            "answer": "$$\n\\boxed{\\exp\\left(-\\frac{T_{s}}{R_{p} C_{p}}\\right) v_{p,k} + R_{p} \\left( 1 - \\exp\\left(-\\frac{T_{s}}{R_{p} C_{p}}\\right) \\right) i_{k}}\n$$"
        },
        {
            "introduction": "Building on the concept of discrete-time models, this practice challenges you to construct the core of a sophisticated estimation algorithm, the Extended Kalman Filter (EKF). You will formulate the measurement Jacobian for a comprehensive electro-thermal model that fuses data from multiple sensors. This task is central to developing robust state estimators that can account for complex interactions between a battery's electrical and thermal states. ",
            "id": "3896602",
            "problem": "Consider a lithium-ion cell in a Battery Management System (BMS) employing an Extended Kalman Filter (EKF) for model-based State of Charge (SOC) and State of Health (SOH) estimation. The cell is described by a first-order Thevenin equivalent-circuit model coupled to a lumped thermal model. The state vector is defined as $$\\mathbf{x} = \\begin{pmatrix} z & v_{p} & T_{c} & T_{s} & R_{0} & b_{i} \\end{pmatrix}^{\\top},$$ where $z$ is the SOC ($0 \\le z \\le 1$), $v_{p}$ is the polarization voltage across the resistor-capacitor (RC) network, $T_{c}$ is the core temperature, $T_{s}$ is the surface temperature, $R_{0}$ is the ohmic resistance representing an SOH-dependent parameter, and $b_{i}$ is the current sensor bias. The EKF input is the measured current $u = i_{m},$ where the true current is related to the measured current by $i = i_{m} - b_{i}.$ The terminal voltage is given by $V = \\mathrm{OCV}(z, T_{c}) - R_{0}\\,i - v_{p},$ where $\\mathrm{OCV}(z, T_{c})$ denotes the Open Circuit Voltage (OCV) as a function of $z$ and $T_{c}$, assumed differentiable in each argument. The multi-sensor measurement vector combines voltage, current-derived SOC, and two temperatures as $$\\mathbf{y} = \\begin{pmatrix} V_{m} \\\\ T_{c,m} \\\\ T_{s,m} \\\\ z_{cc,m} \\end{pmatrix},$$ with the following measurement relations: \n- Terminal voltage sensor: $V_{m} = \\mathrm{OCV}(z, T_{c}) - R_{0}\\,(u - b_{i}) - v_{p} + n_{v},$ \n- Core temperature sensor: $T_{c,m} = T_{c} + n_{Tc},$ \n- Surface temperature sensor: $T_{s,m} = T_{s} + n_{Ts},$ \n- Coulomb-counted SOC sensor: $z_{cc,m} = z + n_{z},$ where $n_{v}$, $n_{Tc}$, $n_{Ts}$, and $n_{z}$ are zero-mean measurement noises. The nominal capacity $Q_{n}$ and Coulombic efficiency $\\eta$ are known constants used in the separate Coulomb counting process that generates $z_{cc,m}$ from $i_{m}$, but do not explicitly enter the measurement function other than through $z_{cc,m}$.\n\nStarting from the above physically grounded model and definitions, formulate the EKF measurement function $$\\mathbf{h}(\\mathbf{x}, u) = \\begin{pmatrix} h_{1}(\\mathbf{x},u) \\\\ h_{2}(\\mathbf{x},u) \\\\ h_{3}(\\mathbf{x},u) \\\\ h_{4}(\\mathbf{x},u) \\end{pmatrix}$$ that maps the state to the expected measurements, and derive the measurement Jacobian matrix $$\\mathbf{H}(\\mathbf{x},u) = \\frac{\\partial \\mathbf{h}}{\\partial \\mathbf{x}}.$$ Express your final answer as a single closed-form analytic matrix in terms of $z$, $T_{c}$, $v_{p}$, $R_{0}$, $b_{i}$, $u$, and symbolic partial derivatives of $\\mathrm{OCV}$ with respect to its arguments. Do not assume any specific parametric form for $\\mathrm{OCV}(z,T_{c})$. The final answer must be a single analytic expression. No rounding is required. Units are not required for the final expression.",
            "solution": "The Extended Kalman Filter (EKF) measurement model relates the state vector to the expected values of the measurements through a function $\\mathbf{h}(\\mathbf{x},u)$, with the measurement Jacobian $\\mathbf{H}(\\mathbf{x},u)$ defined as the matrix of partial derivatives of $\\mathbf{h}$ with respect to the state $\\mathbf{x}$. We begin from the fundamental definitions given.\n\nThe system employs a Thevenin equivalent-circuit model for the electrical domain. The terminal voltage $V$ satisfies \n$$V = \\mathrm{OCV}(z,T_{c}) - R_{0}\\,i - v_{p},$$ \nbased on Kirchhoff's Voltage Law applied to the series connection of the OCV source, the ohmic resistance $R_{0}$, and the RC polarization branch represented by the polarization voltage $v_{p}$. The true current $i$ is related to the measured current $i_{m}$ via the sensor bias state $b_{i}$:\n$$i = i_{m} - b_{i} = u - b_{i},$$\nwhere $u$ is chosen as the measured current input.\n\nThe thermal domain is represented by lumped temperatures $T_{c}$ and $T_{s}$, measured directly by their respective sensors. The multi-sensor fusion also leverages an auxiliary SOC measurement produced by Coulomb counting. Coulomb counting integrates the measured current to estimate SOC via the fundamental definition of SOC as normalized charge:\n$$\\frac{d z}{d t} = -\\frac{\\eta}{Q_{n}}\\, i,$$\nwhere $Q_{n}$ is the nominal capacity and $\\eta$ is the Coulombic efficiency. An external process (outside the EKF measurement function) integrates this to produce $z_{cc,m}$, which we treat as a direct measurement of $z$ corrupted by noise. Thus, in the EKF measurement equation, $z_{cc,m}$ maps to $z$.\n\nTherefore, the measurement function components are:\n- Terminal voltage measurement model (excluding explicit noise for the deterministic mapping):\n$$h_{1}(\\mathbf{x},u) = \\mathrm{OCV}(z, T_{c}) - R_{0}\\,(u - b_{i}) - v_{p}.$$\n- Core temperature measurement model:\n$$h_{2}(\\mathbf{x},u) = T_{c}.$$\n- Surface temperature measurement model:\n$$h_{3}(\\mathbf{x},u) = T_{s}.$$\n- Coulomb-counted SOC measurement model:\n$$h_{4}(\\mathbf{x},u) = z.$$\n\nWe now derive the measurement Jacobian $\\mathbf{H}(\\mathbf{x},u) = \\frac{\\partial \\mathbf{h}}{\\partial \\mathbf{x}}$. The state vector is $\\mathbf{x} = \\begin{pmatrix} z & v_{p} & T_{c} & T_{s} & R_{0} & b_{i} \\end{pmatrix}^{\\top}$, so we compute the partial derivatives of each $h_{i}$ with respect to each state component.\n\nFor $h_{1}(\\mathbf{x},u)$:\n- $\\frac{\\partial h_{1}}{\\partial z} = \\frac{\\partial\\, \\mathrm{OCV}(z,T_{c})}{\\partial z}$ by the chain rule applied to $\\mathrm{OCV}$.\n- $\\frac{\\partial h_{1}}{\\partial v_{p}} = -1$ because $h_{1}$ contains $-v_{p}$ linearly.\n- $\\frac{\\partial h_{1}}{\\partial T_{c}} = \\frac{\\partial\\, \\mathrm{OCV}(z,T_{c})}{\\partial T_{c}}$ by the chain rule.\n- $\\frac{\\partial h_{1}}{\\partial T_{s}} = 0$ since $h_{1}$ does not depend on $T_{s}$.\n- $\\frac{\\partial h_{1}}{\\partial R_{0}} = -(u - b_{i})$ because $h_{1}$ contains $-R_{0}(u - b_{i})$ linearly.\n- $\\frac{\\partial h_{1}}{\\partial b_{i}} = R_{0}$ because $\\frac{\\partial}{\\partial b_{i}}[-R_{0}(u - b_{i})] = R_{0}$.\n\nFor $h_{2}(\\mathbf{x},u) = T_{c}$:\n- $\\frac{\\partial h_{2}}{\\partial z} = 0$, $\\frac{\\partial h_{2}}{\\partial v_{p}} = 0$, $\\frac{\\partial h_{2}}{\\partial T_{c}} = 1$, $\\frac{\\partial h_{2}}{\\partial T_{s}} = 0$, $\\frac{\\partial h_{2}}{\\partial R_{0}} = 0$, $\\frac{\\partial h_{2}}{\\partial b_{i}} = 0$.\n\nFor $h_{3}(\\mathbf{x},u) = T_{s}$:\n- $\\frac{\\partial h_{3}}{\\partial z} = 0$, $\\frac{\\partial h_{3}}{\\partial v_{p}} = 0$, $\\frac{\\partial h_{3}}{\\partial T_{c}} = 0$, $\\frac{\\partial h_{3}}{\\partial T_{s}} = 1$, $\\frac{\\partial h_{3}}{\\partial R_{0}} = 0$, $\\frac{\\partial h_{3}}{\\partial b_{i}} = 0$.\n\nFor $h_{4}(\\mathbf{x},u) = z$:\n- $\\frac{\\partial h_{4}}{\\partial z} = 1$, $\\frac{\\partial h_{4}}{\\partial v_{p}} = 0$, $\\frac{\\partial h_{4}}{\\partial T_{c}} = 0$, $\\frac{\\partial h_{4}}{\\partial T_{s}} = 0$, $\\frac{\\partial h_{4}}{\\partial R_{0}} = 0$, $\\frac{\\partial h_{4}}{\\partial b_{i}} = 0$.\n\nCollecting these into the Jacobian matrix, with the measurement ordering $(V_{m}, T_{c,m}, T_{s,m}, z_{cc,m})$ and the state ordering $(z, v_{p}, T_{c}, T_{s}, R_{0}, b_{i})$, we obtain:\n$$\n\\mathbf{H}(\\mathbf{x},u) \n= \n\\begin{pmatrix}\n\\frac{\\partial\\, \\mathrm{OCV}(z,T_{c})}{\\partial z} & -1 & \\frac{\\partial\\, \\mathrm{OCV}(z,T_{c})}{\\partial T_{c}} & 0 & -(u - b_{i}) & R_{0} \\\\\n0 & 0 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 0 & 0 \\\\\n1 & 0 & 0 & 0 & 0 & 0\n\\end{pmatrix}.\n$$\n\nThis $\\mathbf{H}(\\mathbf{x},u)$ is the required EKF measurement Jacobian for the multi-sensor fusion of voltage, current-derived SOC, and temperature measurements under the given model assumptions. It is expressed in closed form with symbolic partial derivatives of $\\mathrm{OCV}$, does not assume any particular parameterization of $\\mathrm{OCV}$, and is consistent with the physically grounded measurement definitions.",
            "answer": "$$\\boxed{\n\\begin{pmatrix}\n\\frac{\\partial\\, \\mathrm{OCV}(z,T_{c})}{\\partial z} & -1 & \\frac{\\partial\\, \\mathrm{OCV}(z,T_{c})}{\\partial T_{c}} & 0 & -(u - b_{i}) & R_{0} \\\\\n0 & 0 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 0 & 0 \\\\\n1 & 0 & 0 & 0 & 0 & 0\n\\end{pmatrix}\n}$$"
        },
        {
            "introduction": "Even a perfectly implemented estimator can fail if the system's state is not observable from the available measurements, a common issue in battery SOC estimation where the OCV-SOC curve is flat. This practice guides you through a theoretical analysis of observability, pushing you to identify the root cause of this problem and evaluate innovative solutions using multi-physics principles. Understanding these fundamental limitations is crucial for designing reliable BMS algorithms that work across all operating conditions. ",
            "id": "3896618",
            "problem": "A Battery Management System (BMS) uses a model-based estimator to infer State of Charge (SOC) for a lithium-ion cell near full charge. Consider a validated Equivalent Circuit Model (ECM) with one polarization branch and thermal coupling. The states are SOC $z$, polarization voltage $v$, and temperature $T$. The input is current $I$ (positive for discharge), and the measured output is terminal voltage $y$. The governing equations are, for a small neighborhood of a full-charge operating point $(z_0 \\approx 1, T_0)$:\n$$\n\\dot z = -\\frac{1}{Q} I,\n$$\n$$\n\\dot v = -\\frac{1}{\\tau} v + \\alpha I,\n$$\n$$\n\\dot T = -\\gamma \\,(T - T_0) + u_T,\n$$\n$$\ny = U(z, T) - v - R I,\n$$\nwhere $Q$, $\\tau$, $\\alpha$, $R$, and $\\gamma$ are positive constants identifiable from prior characterization and assumed independent of $z$ and $T$ in the stated neighborhood, and $u_T$ is a known, externally applied thermal actuation representing a small, controllable heating/cooling input. The open-circuit voltage $U(z, T)$ is smooth and has a region near full charge where its partial derivative with respect to SOC satisfies $\\frac{\\partial U}{\\partial z}(z_0, T_0) \\approx 0$. The entropic coefficient is $\\beta(z) := \\frac{\\partial U}{\\partial T}(z, T_0)$, and it is known from prior physics-informed characterization as a function of $z$.\n\nUsing fundamental definitions of local observability for linearized systems and the output sensitivity to states, analyze the effect of $\\frac{\\partial U}{\\partial z}(z_0, T_0) \\approx 0$ on SOC observability under purely electrical excitation and propose an alternative excitation strategy that restores local weak observability of $z$ in the stated neighborhood.\n\nWhich option is correct?\n\nA. With $\\frac{\\partial U}{\\partial z}(z_0, T_0) \\approx 0$ and $u_T = 0$, the SOC $z$ is unobservable from voltage measurements regardless of the electrical excitation because the output sensitivity to $z$ vanishes in the linearization. However, if a small, known thermal ramp $u_T$ is applied while keeping $I$ sufficiently small, the voltage response gains a $z$-dependent entropic sensitivity through $\\beta(z)$; if $\\frac{\\mathrm{d}\\beta}{\\mathrm{d}z}(z_0) \\neq 0$, then $z$ becomes locally weakly observable in the neighborhood of $(z_0, T_0)$.\n\nB. Increasing the amplitude of current pulses restores observability of $z$ because larger $\\dot z = -\\frac{1}{Q} I$ produces measurable changes in $y$ even when $\\frac{\\partial U}{\\partial z}(z_0, T_0) \\approx 0$, so strong electrical excitation alone is sufficient.\n\nC. Applying high-frequency sinusoidal current to identify the polarization time constant $\\tau$ restores observability of $z$ because $\\tau$ varies with SOC, making $z$ identifiable from the dynamic voltage response even without thermal excitation.\n\nD. Using the ohmic drop $R I$ at high currents and known $R$–SOC dependence allows direct inference of $z$ from voltage steps, so electrical excitation alone suffices even when $\\frac{\\partial U}{\\partial z}(z_0, T_0) \\approx 0$.\n\nAssume that in the stated neighborhood, $R$, $\\tau$, and $\\alpha$ are independent of SOC and temperature, and that the function $\\beta(z)$ is known, smooth, and non-constant with respect to $z$ near $z_0$.",
            "solution": "The problem statement poses a question regarding the local observability of the State of Charge (SOC) in a lithium-ion cell model, particularly in a region where the Open-Circuit Voltage (OCV) is insensitive to SOC. The provided model and conditions are scientifically grounded, internally consistent, and well-posed for analysis. The model is a standard first-order Equivalent Circuit Model (ECM) with thermal coupling, and the condition $\\frac{\\partial U}{\\partial z} \\approx 0$ represents a known challenge in battery state estimation. The problem is valid.\n\nWe begin by formalizing the analysis of local observability using the provided state-space model. The state vector is $\\mathbf{x} = [z, v, T]^T$ and the input vector is $\\mathbf{u} = [I, u_T]^T$. The system equations are:\n$$\n\\dot{\\mathbf{x}} = \\mathbf{f}(\\mathbf{x}, \\mathbf{u}) = \\begin{bmatrix}\n-\\frac{1}{Q} I \\\\\n-\\frac{1}{\\tau} v + \\alpha I \\\\\n-\\gamma (T - T_0) + u_T\n\\end{bmatrix}\n$$\n$$\ny = h(\\mathbf{x}, \\mathbf{u}) = U(z, T) - v - R I\n$$\n\nTo analyze local observability around the operating point $(z_0, v_0=0, T_0)$ with inputs $(I_0=0, u_{T0}=0)$, we linearize the system. Let $\\delta\\mathbf{x} = \\mathbf{x} - \\mathbf{x}_0$ and $\\delta y = y - y_0$. The linearized system is $\\delta\\dot{\\mathbf{x}} = A \\delta\\mathbf{x} + B \\delta\\mathbf{u}$ and $\\delta y = C \\delta\\mathbf{x} + D \\delta\\mathbf{u}$.\n\nThe state matrix $A$ is the Jacobian of $\\mathbf{f}$ with respect to $\\mathbf{x}$:\n$$\nA = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{x}} \\bigg|_{\\mathbf{x}_0, \\mathbf{u}_0} = \\begin{bmatrix}\n\\frac{\\partial \\dot z}{\\partial z} & \\frac{\\partial \\dot z}{\\partial v} & \\frac{\\partial \\dot z}{\\partial T} \\\\\n\\frac{\\partial \\dot v}{\\partial z} & \\frac{\\partial \\dot v}{\\partial v} & \\frac{\\partial \\dot v}{\\partial T} \\\\\n\\frac{\\partial \\dot T}{\\partial z} & \\frac{\\partial \\dot T}{\\partial v} & \\frac{\\partial \\dot T}{\\partial T}\n\\end{bmatrix} = \\begin{bmatrix}\n0 & 0 & 0 \\\\\n0 & -\\frac{1}{\\tau} & 0 \\\\\n0 & 0 & -\\gamma\n\\end{bmatrix}\n$$\nThe output matrix $C$ is the Jacobian of $h$ with respect to $\\mathbf{x}$. Since the input $I$ is the source of excitation for observability analysis from the output voltage $y$, we consider the system with input $I$ and output $y$.\n$$\nC = \\frac{\\partial h}{\\partial \\mathbf{x}} \\bigg|_{\\mathbf{x}_0, \\mathbf{u}_0} = \\begin{bmatrix}\n\\frac{\\partial U}{\\partial z}(z_0, T_0) & -1 & \\frac{\\partial U}{\\partial T}(z_0, T_0)\n\\end{bmatrix}\n$$\nUsing the definition $\\beta(z) := \\frac{\\partial U}{\\partial T}(z, T_0)$, the output matrix is:\n$$\nC = \\begin{bmatrix}\n\\frac{\\partial U}{\\partial z}(z_0, T_0) & -1 & \\beta(z_0)\n\\end{bmatrix}\n$$\nThe observability of the linear system $(A, C)$ is determined by the rank of the observability matrix $\\mathcal{O}$:\n$$\n\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\\\ CA^2 \\end{bmatrix}\n$$\nWe compute the rows:\n$CA = \\begin{bmatrix} \\frac{\\partial U}{\\partial z} & -1 & \\beta(z_0) \\end{bmatrix} \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & -1/\\tau & 0 \\\\ 0 & 0 & -\\gamma \\end{bmatrix} = \\begin{bmatrix} 0 & \\frac{1}{\\tau} & -\\gamma \\beta(z_0) \\end{bmatrix}$\n$CA^2 = (CA)A = \\begin{bmatrix} 0 & \\frac{1}{\\tau} & -\\gamma \\beta(z_0) \\end{bmatrix} \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & -1/\\tau & 0 \\\\ 0 & 0 & -\\gamma \\end{bmatrix} = \\begin{bmatrix} 0 & -\\frac{1}{\\tau^2} & \\gamma^2 \\beta(z_0) \\end{bmatrix}$\n\nThus, the observability matrix is:\n$$\n\\mathcal{O} = \\begin{bmatrix}\n\\frac{\\partial U}{\\partial z}(z_0, T_0) & -1 & \\beta(z_0) \\\\\n0 & \\frac{1}{\\tau} & -\\gamma \\beta(z_0) \\\\\n0 & -\\frac{1}{\\tau^2} & \\gamma^2 \\beta(z_0)\n\\end{bmatrix}\n$$\nThe system is locally observable if $\\mathcal{O}$ has full column rank, which for a square matrix means its determinant is non-zero.\n$$\n\\det(\\mathcal{O}) = \\frac{\\partial U}{\\partial z}(z_0, T_0) \\left( (\\frac{1}{\\tau})(\\gamma^2 \\beta(z_0)) - (-\\gamma \\beta(z_0))(-\\frac{1}{\\tau^2}) \\right) = \\frac{\\partial U}{\\partial z}(z_0, T_0) \\left( \\frac{\\gamma^2 \\beta(z_0)}{\\tau} - \\frac{\\gamma \\beta(z_0)}{\\tau^2} \\right)\n$$\n$$\n\\det(\\mathcal{O}) = \\frac{\\partial U}{\\partial z}(z_0, T_0) \\frac{\\gamma \\beta(z_0)}{\\tau^2} (\\gamma\\tau - 1)\n$$\nThe core condition of the problem is $\\frac{\\partial U}{\\partial z}(z_0, T_0) \\approx 0$. If we set this derivative to zero, then $\\det(\\mathcal{O}) = 0$. The first column of $\\mathcal{O}$ becomes a zero vector, indicating that the matrix is rank-deficient. This demonstrates that the state $z$ is not linearly observable from measurements of the output $y$ when relying on electrical excitation $I$ alone. The output sensitivity to the state $z$, given by the first element of the $C$ matrix, vanishes.\n\nNow, we evaluate the options.\n\n**Option A:** With $\\frac{\\partial U}{\\partial z}(z_0, T_0) \\approx 0$ and $u_T = 0$, the SOC $z$ is unobservable from voltage measurements regardless of the electrical excitation because the output sensitivity to $z$ vanishes in the linearization. However, if a small, known thermal ramp $u_T$ is applied while keeping $I$ sufficiently small, the voltage response gains a $z$-dependent entropic sensitivity through $\\beta(z)$; if $\\frac{\\mathrm{d}\\beta}{\\mathrm{d}z}(z_0) \\neq 0$, then $z$ becomes locally weakly observable in the neighborhood of $(z_0, T_0)$.\n\nThis option presents a two-part claim.\n1.  **Unobservability with electrical excitation**: As proven above, when $\\frac{\\partial U}{\\partial z}(z_0, T_0) = 0$, the first column of the observability matrix is zero, so $z$ is unobservable. This part is correct.\n2.  **Restoring observability via thermal excitation**: The proposal is to set $I \\approx 0$ and apply a known thermal input $u_T(t)$.\n    With $I \\approx 0$, we have $\\dot z \\approx 0$ and $v(t) \\to 0$. The output equation simplifies to $y(t) \\approx U(z, T(t))$. Since $\\dot z \\approx 0$, the SOC $z$ is approximately constant, say $z \\approx z_0$.\n    The thermal dynamics are $\\dot T = -\\gamma (T - T_0) + u_T$. Applying a known $u_T(t)$ generates a predictable temperature trajectory $T(t)$.\n    The measured voltage is $y(t) \\approx U(z_0, T(t))$. The change in voltage with respect to temperature is given by the entropic coefficient:\n    $$\n    \\frac{\\partial y}{\\partial T} \\approx \\frac{\\partial U}{\\partial T}(z_0, T(t))\n    $$\n    For small temperature deviations around $T_0$, this sensitivity is approximately $\\frac{\\partial U}{\\partial T}(z_0, T_0) = \\beta(z_0)$. By measuring the output voltage response $\\Delta y$ to a known, induced temperature change $\\Delta T$, one can estimate the value of the entropic coefficient at the current SOC: $\\beta_{est} \\approx \\frac{\\Delta y}{\\Delta T} \\approx \\beta(z_0)$.\n    The problem states that $\\beta(z)$ is a known, non-constant function. The condition $\\frac{\\mathrm{d}\\beta}{\\mathrm{d}z}(z_0) \\neq 0$ ensures that the function $z \\mapsto \\beta(z)$ is locally invertible around $z_0$. Therefore, by obtaining an estimate $\\beta_{est}$, one can solve for the SOC: $z_0 = \\beta^{-1}(\\beta_{est})$. This procedure makes the SOC inferable, which aligns with the concept of restoring local (weak) observability. The term \"weak\" is appropriate as this is not observability in the standard LTI sense but rather a parameter identification approach where the quasi-static state $z$ is treated as a parameter.\n    This analysis confirms that the entire statement in option A is correct.\n\n**Option B:** Increasing the amplitude of current pulses restores observability of $z$ because larger $\\dot z = -\\frac{1}{Q} I$ produces measurable changes in $y$ even when $\\frac{\\partial U}{\\partial z}(z_0, T_0) \\approx 0$, so strong electrical excitation alone is sufficient.\n\nThis is incorrect. The fundamental issue is the lack of sensitivity of the output $y$ to the state $z$ via the term $U(z, T)$. The output equation is $y = U(z, T) - v - R I$. Even if a large current $I$ forces $z$ to change rapidly (via $\\dot z = -I/Q$), if the function $U(z,T)$ is flat with respect to $z$ in the operating region, the term $U(z(t), T(t))$ will not reflect this change in $z$. The change in $y$ will be dominated by the $v$ and $RI$ terms, which do not provide a path to observe $z$ under the problem's assumptions. Strong electrical excitation does not create a new sensitivity path for $z$ to affect $y$.\n\n**Option C:** Applying high-frequency sinusoidal current to identify the polarization time constant $\\tau$ restores observability of $z$ because $\\tau$ varies with SOC, making $z$ identifiable from the dynamic voltage response even without thermal excitation.\n\nThis is incorrect. The problem explicitly states as an assumption: \"in the stated neighborhood, $R$, $\\tau$, and $\\alpha$ are independent of SOC and temperature\". This option introduces a dependency ($\\tau$ on SOC) that is directly contradicted by the problem's premises. One must solve the problem as it is stated.\n\n**Option D:** Using the ohmic drop $R I$ at high currents and known $R$–SOC dependence allows direct inference of $z$ from voltage steps, so electrical excitation alone suffices even when $\\frac{\\partial U}{\\partial z}(z_0, T_0) \\approx 0$.\n\nThis is incorrect for the same reason as option C. It relies on a premise ($R$–SOC dependence) that is explicitly ruled out by the problem's assumption: \"in the stated neighborhood, $R$, $\\tau$, and $\\alpha$ are independent of SOC and temperature\".\n\n**Conclusion:**\nThe analysis confirms that with a flat OCV-SOC curve, SOC becomes unobservable through purely electrical measurements within the confines of the model. Option A correctly identifies this issue and proposes a valid alternative strategy using thermal excitation to probe the SOC-dependent entropic coefficient $\\beta(z)$, thereby restoring a means of inferring SOC. Options B, C, and D are incorrect; B misunderstands the nature of observability loss, while C and D contradict the explicit assumptions of the problem.\n\nTherefore, option A is the correct statement.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}