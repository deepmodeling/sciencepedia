{
    "hands_on_practices": [
        {
            "introduction": "要理解电流均衡，我们首先必须分析导致不均衡现象的根本原因。该练习  将指导您推导当两个具有不同开路电压（即不同荷电状态）的电芯并联时产生的初始再分配电流。通过将基尔霍夫电压定律应用于一个简单的戴维南等效电路模型，您将对电流不均衡背后的驱动力（电压差）和限制因素（回路总电阻）建立起基础性的理解。",
            "id": "3902675",
            "problem": "两个电化学电池（以下称为电池 $1$ 和电池 $2$），初始时相互隔离，在时间 $t=0$ 时通过一个理想的零电阻开关闭合，以并联方式连接。每个电池由一个戴维南模型表示，该模型包含一个等于其开路电压 (OCV) 的理想电压源和一个串联欧姆电阻。电池 $i$ 在其荷电状态 (SOC) 下的开路电压 (OCV) 表示为 $OCV(SOC_i)=V_i$（其中 $i \\in \\{1,2\\}$），其串联电阻为 $R_i>0$。假设如下：\n- 与 $R_1$ 和 $R_2$ 相比，互连电阻和开关电阻可以忽略不计。\n- 寄生电感和电容（包括双电层电容）可以忽略不计，因此在连接后的瞬间，荷电状态 (SOC) 保持不变，$V_1$ 和 $V_2$ 保持恒定。\n- 电池以同名端子相连（正极接正极，负极接负极），因此在连接瞬间，仅因 $V_1$ 和 $V_2$ 的差异，通过 $R_1$ 和 $R_2$ 产生重新分布电流。\n\n定义在 $t=0^{+}$ 时的初始重新分布电流 $I_{red}$，当电流通过正极端子互连线从电池 $1$ 流向电池 $2$ 时，其值为正。仅从基尔霍夫电流定律、基尔霍夫电压定律和欧姆定律出发，推导出一个关于 $V_1$、$V_2$、$R_1$ 和 $R_2$ 的 $I_{red}$ 的闭式符号表达式。将您的最终答案以安培为单位，表示为单个解析表达式（无中间等式）。",
            "solution": "对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 两个电化学电池，电池 $1$ 和电池 $2$。\n- 在时间 $t=0$ 时并联连接。\n- 每个电池均为戴维南模型：理想电压源 $V_i = OCV(SOC_i)$ 及串联电阻 $R_i>0$，其中 $i \\in \\{1,2\\}$。\n- 互连电阻和开关电阻可忽略不计。\n- 寄生电感和电容可忽略不计。\n- 在 $t=0^{+}$ 时，SOC 保持不变，$V_1$ 和 $V_2$ 恒定。\n- 连接方式为同名端子相连（正极接正极，负极接负极）。\n- 在 $t=0^{+}$ 时的初始重新分布电流 $I_{red}$，当其通过正极端子互连线从电池 $1$ 流向电池 $2$ 时为正。\n- 推导必须仅从基尔霍夫电流定律、基尔霍夫电压定律和欧姆定律出发。\n- 要求的输出是 $I_{red}$ 关于 $V_1$、$V_2$、$R_1$ 和 $R_2$ 的闭式符号表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于戴维南等效电路模型，这是电路分析中对电池等电压源的基本和标准表示。基尔霍夫定律和欧姆定律的使用是恰当的，构成了经典电路理论的基础。该情景是电气工程和电池管理系统中的一个标准问题。该问题具有科学合理性。\n- **问题适定性：** 问题提供了一套完整的参数（$V_1$、$V_2$、$R_1$、$R_2$）和清晰的电路配置。它要求一个特定的量 $I_{red}$，该量可以从给定的信息和物理定律中唯一确定。\n- **客观性：** 问题以精确、技术性的语言陈述，没有歧义或主观内容。电流 $I_{red}$ 的符号约定已明确定义。\n\n### 步骤 3：结论与行动\n该问题是有效的，因为它具有科学依据、适定性、客观性且自洽。可以根据所提供的信息和基本原理推导出严谨的解。\n\n### 求解推导\n该问题描述了两个并联的戴维南等效电路。电池 $1$ 被建模为一个理想电压源 $V_1$ 与一个电阻 $R_1$ 串联。电池 $2$ 被建模为一个理想电压源 $V_2$ 与一个电阻 $R_2$ 串联。两个电池的正极端子相连，负极端子也相连。这种配置形成了一个包含两个电池的单一闭合电路回路。重新分布电流 $I_{red}$ 在此回路中流动。\n\n我们将对该回路应用基尔霍夫电压定律 (KVL)。KVL 指出，沿任何闭合回路的电位差（电压）的代数和为零。\n\n我们来定义回路中电流 $I_{red}$ 的方向。问题陈述中指出，当电流从电池 $1$ 流向电池 $2$ 时，$I_{red}$ 为正。这意味着电流从电池 $1$ 的正极端子流出，通过互连线，流入电池 $2$ 的正极端子。我们将假设 $I_{red}$ 沿此方向流动，如果我们将电池 $1$ 画在左侧，电池 $2$ 画在右侧，这对应于顺时针方向。\n\n让我们从电源 $V_1$ 的负极端子开始，并沿着 $I_{red}$ 的方向（顺时针）绕行回路：\n\n$1$. 穿过电压源 $V_1$：我们从负极移动到正极，这构成了一个 $+V_1$ 的电压升高。\n$2$. 穿过串联电阻 $R_1$：根据欧姆定律，电流 $I_{red}$ 流过电阻 $R_1$ 会产生一个电压降。电位在电流方向上降低，因此电压变化为 $-I_{red}R_1$。\n$3$. 穿过电压源 $V_2$：由于电池 $1$ 的正极与电池 $2$ 的正极相连，电流 $I_{red}$ 从 $V_2$ 的正极进入，负极流出。沿电流方向穿过电源 $V_2$ 意味着从其正极移动到负极，这是一个 $-V_2$ 的电压降。\n$4$. 穿过串联电阻 $R_2$：电流 $I_{red}$ 继续流过电阻 $R_2$，回到 $V_1$ 的负极。这与电流方向相同，因此会产生另一个 $-I_{red}R_2$ 的电压降。\n\n根据 KVL，这些电压变化的总和必须为零：\n$$+V_1 - I_{red}R_1 - V_2 - I_{red}R_2 = 0$$\n\n现在，我们必须求解这个方程以得到 $I_{red}$。我们可以将包含 $I_{red}$ 的项组合在一起：\n$$V_1 - V_2 = I_{red}R_1 + I_{red}R_2$$\n\n在等式右侧提取公因式 $I_{red}$，得到：\n$$V_1 - V_2 = I_{red}(R_1 + R_2)$$\n\n最后，除以回路的总串联电阻 $(R_1 + R_2)$，得到重新分布电流 $I_{red}$ 的表达式：\n$$I_{red} = \\frac{V_1 - V_2}{R_1 + R_2}$$\n\n该表达式如要求所示，是关于给定物理量 $V_1$、$V_2$、$R_1$ 和 $R_2$ 的。$I_{red}$ 的符号由 $V_1$ 和 $V_2$ 的相对大小正确确定。如果 $V_1 > V_2$，$I_{red}$ 为正，表示电流从电池 $1$ 流向电池 $2$。如果 $V_2 > V_1$，$I_{red}$ 为负，表示电流从电池 $2$ 流向电池 $1$，这与所提供的定义一致。",
            "answer": "$$\\boxed{\\frac{V_1 - V_2}{R_1 + R_2}}$$"
        },
        {
            "introduction": "在双电芯案例的基础上，真实的电池模组由许多电芯组成，这些电芯不仅在串联电阻 $R_i$ 上存在固有差异，在漏电通路（以并联电导 $G_i$ 为模型）方面也各不相同。该练习  要求您分析一个多支路模组中的稳态电流分布，其中每个支路都具有独特的阻抗特性。掌握这种计算对于预测和量化整个电池包在直流工况下的电流不均衡度至关重要。",
            "id": "3902715",
            "problem": "在一个自动化的电池设计和仿真工作流程中，考虑一个直流模块，该模块由$N$个并联支路组成，连接在一个共用的正母线和一个共用的负母线之间。每个支路 $i$ 的模型为一个串联电阻 $R_{i}$ 与一个并联的旁路漏电导 $G_{i}$ 并联，两者都参考相同的两个母线节点。该模块被驱动，使得从正母线流向外部负载的净电流为固定值 $I$，母线电压根据网络的需要进行调整。\n\n仅从欧姆定律和基尔霍夫电流定律（KCL；Kirchhoff’s Current Law）出发，推导单个支路电流 $I_{i}$ 关于 $I$、$\\{R_{i}\\}$ 和 $\\{G_{i}\\}$ 的通用表达式。然后，对于 $N=3$ 的特定情况，参数如下：\n- $R_{1} = 4\\,\\Omega$，$R_{2} = 5\\,\\Omega$，$R_{3} = 8\\,\\Omega$，\n- $G_{1} = 0.05\\,\\mathrm{S}$，$G_{2} = 0.15\\,\\mathrm{S}$，$G_{3} = 0.05\\,\\mathrm{S}$，\n- 总负载电流 $I = 20\\,\\mathrm{A}$，\n\n计算 $I_{1}$、$I_{2}$ 和 $I_{3}$ 的数值，并通过比率 $\\max_{i} I_{i} \\big/ \\min_{i} I_{i}$ 来量化各支路间的电流不平衡。将最终比率四舍五入至四位有效数字。将最终比率表示为一个无单位的纯数。",
            "solution": "首先验证问题陈述的科学合理性、清晰度和完整性。该问题描述了一个由并联支路组成的直流（DC）电路。每个支路被建模为一个电阻与一个漏电导并联。这是非理想电阻元件的标准且具有物理意义的表示方法。该问题是适定的，提供了所有必要的参数（$N$、$\\{R_i\\}$、$\\{G_i\\}$、$I$），并指定了要使用的基本定律（欧姆定律和基尔霍夫电流定律）。因此，该问题被认为是有效的，可以构建一个解决方案。\n\n主要任务是推导任意支路 $i$ 中电流 $I_i$ 的通用表达式，然后将此表达式应用于一个具体的数值案例。\n\n设 $V$ 为共用正负母线之间的电压电位差。由于所有 $N$ 个支路都在这两个母线之间并联，所以每个支路两端的电压 $V$ 是相同的。\n\n对于每个支路 $i$，模型由一个电阻 $R_i$ 与一个电导 $G_i$ 并联组成。流过该支路的电流 $I_i$ 将是流过电阻的电流和流过电导体的电流之和。\n电阻的电导是其电阻的倒数，$1/R_i$。\n支路 $i$ 的总有效电导，记为 $Y_i$，是并联电导之和：\n$$Y_i = \\frac{1}{R_i} + G_i$$\n根据欧姆定律，流过支路 $i$ 的电流 $I_i$ 是其总电导 $Y_i$ 和公共电压 $V$ 的乘积：\n$$I_i = V \\cdot Y_i$$\n在正母线上应用基尔霍夫电流定律（KCL），该定律指出，进入并联支路组合的总电流 $I$ 必须等于流入每个支路的各个电流之和：\n$$I = \\sum_{k=1}^{N} I_k$$\n将欧姆定律中 $I_k$ 的表达式代入 KCL 方程，得到：\n$$I = \\sum_{k=1}^{N} (V \\cdot Y_k)$$\n由于电压 $V$ 对所有支路都是公共的，因此可以将其从求和中提出来：\n$$I = V \\left(\\sum_{k=1}^{N} Y_k\\right)$$\n项 $\\sum_{k=1}^{N} Y_k$ 表示整个模块的总等效电导，我们将其记为 $Y_{\\text{total}}$。\n$$Y_{\\text{total}} = \\sum_{k=1}^{N} Y_k = \\sum_{k=1}^{N} \\left(\\frac{1}{R_k} + G_k\\right)$$\n从关系式 $I = V \\cdot Y_{\\text{total}}$，我们可以用总电流 $I$ 和总电导 $Y_{\\text{total}}$ 来表示母线电压 $V$：\n$$V = \\frac{I}{Y_{\\text{total}}} = \\frac{I}{\\sum_{k=1}^{N} \\left(\\frac{1}{R_k} + G_k\\right)}$$\n为了得到支路 $i$ 中电流 $I_i$ 的通用表达式，我们将 $V$ 的这个表达式代回方程 $I_i = V \\cdot Y_i$：\n$$I_i = \\left(\\frac{I}{\\sum_{k=1}^{N} Y_k}\\right) Y_i = I \\frac{Y_i}{\\sum_{k=1}^{N} Y_k}$$\n展开项 $Y_i$ 和 $Y_k$ 得到最终的通用表达式：\n$$I_i = I \\frac{\\frac{1}{R_i} + G_i}{\\sum_{k=1}^{N} \\left(\\frac{1}{R_k} + G_k\\right)}$$\n这是针对通用导纳并联电路的电流分配法则。\n\n现在，我们将此框架应用于给定的具体案例：\n支路数 $N=3$。\n总电流 $I = 20\\,\\mathrm{A}$。\n电阻：$R_1 = 4\\,\\Omega$，$R_2 = 5\\,\\Omega$，$R_3 = 8\\,\\Omega$。\n电导：$G_1 = 0.05\\,\\mathrm{S}$，$G_2 = 0.15\\,\\mathrm{S}$，$G_3 = 0.05\\,\\mathrm{S}$。\n\n首先，我们计算三个支路中每个支路的有效电导 $Y_i$：\n$Y_1 = \\frac{1}{R_1} + G_1 = \\frac{1}{4}\\,\\mathrm{S} + 0.05\\,\\mathrm{S} = 0.25\\,\\mathrm{S} + 0.05\\,\\mathrm{S} = 0.300\\,\\mathrm{S}$。\n$Y_2 = \\frac{1}{R_2} + G_2 = \\frac{1}{5}\\,\\mathrm{S} + 0.15\\,\\mathrm{S} = 0.20\\,\\mathrm{S} + 0.15\\,\\mathrm{S} = 0.350\\,\\mathrm{S}$。\n$Y_3 = \\frac{1}{R_3} + G_3 = \\frac{1}{8}\\,\\mathrm{S} + 0.05\\,\\mathrm{S} = 0.125\\,\\mathrm{S} + 0.05\\,\\mathrm{S} = 0.175\\,\\mathrm{S}$。\n\n接下来，我们计算模块的总等效电导 $Y_{\\text{total}}$：\n$Y_{\\text{total}} = Y_1 + Y_2 + Y_3 = 0.300\\,\\mathrm{S} + 0.350\\,\\mathrm{S} + 0.175\\,\\mathrm{S} = 0.825\\,\\mathrm{S}$。\n\n现在，我们计算单个支路电流 $I_1$、$I_2$ 和 $I_3$：\n$I_1 = I \\frac{Y_1}{Y_{\\text{total}}} = (20\\,\\mathrm{A}) \\frac{0.300\\,\\mathrm{S}}{0.825\\,\\mathrm{S}} = 20 \\cdot \\frac{300}{825} = 20 \\cdot \\frac{12}{33} = \\frac{240}{33}\\,\\mathrm{A} = \\frac{80}{11}\\,\\mathrm{A}$。\n$I_2 = I \\frac{Y_2}{Y_{\\text{total}}} = (20\\,\\mathrm{A}) \\frac{0.350\\,\\mathrm{S}}{0.825\\,\\mathrm{S}} = 20 \\cdot \\frac{350}{825} = 20 \\cdot \\frac{14}{33} = \\frac{280}{33}\\,\\mathrm{A}$。\n$I_3 = I \\frac{Y_3}{Y_{\\text{total}}} = (20\\,\\mathrm{A}) \\frac{0.175\\,\\mathrm{S}}{0.825\\,\\mathrm{S}} = 20 \\cdot \\frac{175}{825} = 20 \\cdot \\frac{7}{33} = \\frac{140}{33}\\,\\mathrm{A}$。\n\n最后，我们将电流不平衡量化为最大支路电流与最小支路电流之比。通过检查分子，我们发现：\n$\\max_{i} I_{i} = I_2 = \\frac{280}{33}\\,\\mathrm{A}$。\n$\\min_{i} I_{i} = I_3 = \\frac{140}{33}\\,\\mathrm{A}$。\n\n电流不平衡比计算如下：\n$$\\text{Ratio} = \\frac{\\max_{i} I_{i}}{\\min_{i} I_{i}} = \\frac{I_2}{I_3} = \\frac{280/33}{140/33} = \\frac{280}{140} = 2$$\n问题要求答案四舍五入到四位有效数字。比率的精确值为 $2$。为了用四位有效数字表示，我们写为 $2.000$。",
            "answer": "$$\\boxed{2.000}$$"
        },
        {
            "introduction": "分析电流不均衡是第一步，而设计能够主动管理不均衡的系统是电池工程的最终目标。这项高级练习  引入了一个使用鲁棒优化的实际设计问题，这是自动化工程设计中的一项关键技术。您将学习如何构建一个优化模型，以确定最佳的均衡电流 $i_{b,i}$，从而在电芯电阻 $R_i$ 存在不确定性的情况下，最小化最坏情况下的支路电流，为确保模组的安全性和寿命提供一个可靠的设计方案。",
            "id": "3902721",
            "problem": "考虑一个由 $n$ 个并行支路组成的电池模块，每个支路被建模为一个戴维南源，其开路电压 $U_i$（单位：伏特 V）已知，串联电阻 $R_i$（单位：欧姆 $\\Omega$）不确定。该模块连接到一个电压为 $V_{\\text{bus}}$（单位：伏特 V）的电压控制总线。每个支路 $i$ 都配备了一个均衡执行器，可以注入或吸收均衡电流 $i_{b,i}$（单位：安培 A），并受到硬件限制。目标是，从基本原理出发，推导出一个鲁棒优化公式，该公式在电阻 $R_i$ 的不确定性集合下，最小化支路总线电流的最坏情况下的最大幅值，然后为一组给定的参数计算实现此目标的均衡电流 $i_{b,i}$。\n\n从以下基本原理开始：\n- 欧姆定律：对于电导为 $G_i$（单位：西门子 S）的支路 $i$，由电势差引起的电流由 $I = G \\cdot \\Delta V$ 给出。\n- 电阻与电导的关系：$G_i = \\frac{1}{R_i}$。\n- 基尔霍夫电流定律：在一个闭合的再分配网络中，注入的净均衡电流之和为零。\n\n采用以下物理上一致的符号约定：支路 $i$ 贡献的总线电流为 $I_i = G_i \\cdot (U_i - V_{\\text{bus}}) - i_{b,i}$，其中 $i_{b,i} > 0$ 表示一个旁路均衡电流，它减少了该支路对总线的贡献。不确定性集合是区间 $R_i \\in [R_i^{-}, R_i^{+}]$，等效地，$G_i \\in [G_i^{-}, G_i^{+}]$，其中 $G_i^{-} = \\frac{1}{R_i^{+}}$ 且 $G_i^{+} = \\frac{1}{R_i^{-}}$。均衡硬件施加了边界条件 $| i_{b,i} | \\leq I_{b,i}^{\\max}$，而守恒定律要求 $\\sum_{i=1}^{n} i_{b,i} = 0$。\n\n您必须：\n- 建立一个鲁棒优化问题，以最小化最坏情况下的最大支路电流幅值，表示为 $\\min_{i_{b,1},\\dots,i_{b,n}} \\max_{i \\in \\{1,\\dots,n\\}} \\sup_{G_i \\in [G_i^{-}, G_i^{+}]} | G_i \\cdot (U_i - V_{\\text{bus}}) - i_{b,i} |$，约束条件为 $\\sum_{i=1}^{n} i_{b,i} = 0$ 且对所有 $i$ 都有 $| i_{b,i} | \\leq I_{b,i}^{\\max}$。\n- 推导出一个适用于现代编程语言计算的可解公式。\n\n您的程序必须实现推导出的公式，并为每个测试用例计算均衡电流 $i_{b,i}$ 和最小化的最坏情况边界 $t^{\\star}$（单位：安培 A）。所有计算出的电流和 $t^{\\star}$ 都必须以安培 (A) 为单位表示。所有输出四舍五入到 $6$ 位小数。\n\n测试套件：\n- 案例 $1$ (一般情况): $n = 3$, $U = [3.71, 3.69, 3.73]$ V, $R^{-} = [0.0025, 0.0028, 0.0030]$ $\\Omega$, $R^{+} = [0.0035, 0.0032, 0.0040]$ $\\Omega$, $V_{\\text{bus}} = 3.70$ V, $I_{b}^{\\max} = [2.0, 2.0, 2.0]$ A。\n- 案例 $2$ (宽不确定性与紧凑执行器): $n = 4$, $U = [3.68, 3.72, 3.70, 3.75]$ V, $R^{-} = [0.0015, 0.0020, 0.0018, 0.0022]$ $\\Omega$, $R^{+} = [0.0050, 0.0040, 0.0045, 0.0042]$ $\\Omega$, $V_{\\text{bus}} = 3.71$ V, $I_{b}^{\\max} = [1.0, 1.0, 1.0, 1.0]$ A。\n- 案例 $3$ (平衡电压): $n = 3$, $U = [3.70, 3.70, 3.70]$ V, $R^{-} = [0.0020, 0.0020, 0.0020]$ $\\Omega$, $R^{+} = [0.0030, 0.0030, 0.0030]$ $\\Omega$, $V_{\\text{bus}} = 3.70$ V, $I_{b}^{\\max} = [5.0, 5.0, 5.0]$ A。\n- 案例 $4$ (无均衡能力): $n = 2$, $U = [3.74, 3.66]$ V, $R^{-} = [0.0025, 0.0025]$ $\\Omega$, $R^{+} = [0.0035, 0.0035]$ $\\Omega$, $V_{\\text{bus}} = 3.70$ V, $I_{b}^{\\max} = [0.0, 0.0]$ A。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个子列表，格式为 $[t^{\\star}, i_{b,1}^{\\star}, i_{b,2}^{\\star}, \\dots, i_{b,n}^{\\star}]$，所有值都四舍五入到 $6$ 位小数。例如，$[[t^{\\star}_{(1)}, i_{b,1}^{\\star}, \\dots], [t^{\\star}_{(2)}, \\dots], \\dots]$。",
            "solution": "首先根据指定标准对用户提供的问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n- **系统模型**：一个具有 $n$ 个并行支路的电池模块。\n- **支路模型**：每个支路 $i$ 是一个戴维南源，具有开路电压 $U_i$ 和串联电阻 $R_i$。\n- **连接**：模块连接到一个电压为 $V_{\\text{bus}}$ 的总线。\n- **均衡**：每个支路都有一个均衡执行器注入电流 $i_{b,i}$。\n- **总线电流方程**：从支路 $i$ 到总线的电流为 $I_i = G_i \\cdot (U_i - V_{\\text{bus}}) - i_{b,i}$，其中 $G_i = 1/R_i$。\n- **符号约定**：$i_{b,i} > 0$ 是一个旁路电流，减少了支路对总线的贡献。\n- **不确定性**：电阻不确定，$R_i \\in [R_i^{-}, R_i^{+}]$。这意味着电导不确定性为 $G_i \\in [G_i^{-}, G_i^{+}]$，其中 $G_i^{-} = 1/R_i^{+}$ 且 $G_i^{+} = 1/R_i^{-}$。\n- **约束条件**：\n    1.  均衡电流守恒：$\\sum_{i=1}^{n} i_{b,i} = 0$。\n    2.  均衡电流限制：对于所有 $i$，$| i_{b,i} | \\leq I_{b,i}^{\\max}$。\n- **目标**：建立并求解鲁棒优化问题：\n    $\\min_{i_{b,1},\\dots,i_{b,n}} \\max_{i \\in \\{1,\\dots,n\\}} \\sup_{G_i \\in [G_i^{-}, G_i^{+}]} | G_i \\cdot (U_i - V_{\\text{bus}}) - i_{b,i} |$。\n- **测试数据**：提供了四个测试用例，包含 $n, U_i, R_i^{-}, R_i^{+}, V_{\\text{bus}}$ 和 $I_{b,i}^{\\max}$ 的数值。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n- **科学依据**：该问题基于基本的电气工程原理，即戴维南定理、欧姆定律和基尔霍夫电流定律。将电池支路建模为带串联电阻的电压源是一种标准且被广泛接受的简化模型。使用鲁棒优化来处理参数不确定性的概念是工程和应用数学中一个成熟的领域。该问题在科学上是合理的。\n- **适定性**：该问题要求建立并求解一个特定的优化问题。正如在推导中将要显示的，这个鲁棒优化问题可以转化为一个标准的线性规划 (LP) 问题，众所周知，线性规划问题是适定的，并且存在高效的求解器。所提供的测试数据是完整和充分的，可以为每个案例实例化并解决问题。\n- **客观性**：该问题使用精确的数学符号和正式的定义来陈述。所有术语都已明确定义，没有主观或模糊的语言。\n\n**步骤 3：结论与行动**\n该问题具有科学依据、适定、客观、自洽且一致。它没有违反任何无效性标准。因此，该问题是**有效的**。现在开始求解过程。\n\n### 可解公式的推导\n\n目标是解决以下鲁棒优化问题：\n$$\n\\min_{\\mathbf{i_b}} \\max_{i=1, \\dots, n} \\left( \\sup_{G_i \\in [G_i^-, G_i^+]} |G_i(U_i - V_{\\text{bus}}) - i_{b,i}| \\right)\n$$\n约束条件为：\n$$\n\\sum_{i=1}^n i_{b,i} = 0\n$$\n$$\n|i_{b,i}| \\le I_{b,i}^{\\max} \\quad \\text{for } i=1, \\dots, n\n$$\n其中 $\\mathbf{i_b} = [i_{b,1}, \\dots, i_{b,n}]^T$。\n\n让我们首先分析对于一个固定的支路 $i$ 和固定的均衡电流 $i_{b,i}$ 的内部上确界项：\n$$\n\\sup_{G_i \\in [G_i^-, G_i^+]} |G_i(U_i - V_{\\text{bus}}) - i_{b,i}|\n$$\n让我们将支路 $i$ 的电势差定义为 $v_i = U_i - V_{\\text{bus}}$。该表达式变为 $\\sup_{G_i \\in [G_i^-, G_i^+]} |G_i v_i - i_{b,i}|$。绝对值内的函数 $f(G_i) = G_i v_i - i_{b,i}$ 是 $G_i$ 的线性函数。一个线性函数在一个闭区间 $[G_i^-, G_i^+]$ 上的绝对值的上确界必然出现在区间的某个端点。\n因此，该上确界等价于在端点处取值的最大值：\n$$\n\\sup_{G_i \\in [G_i^-, G_i^+]} |G_i v_i - i_{b,i}| = \\max \\left( |G_i^- v_i - i_{b,i}|, |G_i^+ v_i - i_{b,i}| \\right)\n$$\n让我们将在电导区间端点处的未补偿电流定义为 $I_i^- = G_i^- v_i$ 和 $I_i^+ = G_i^+ v_i$。那么支路 $i$ 的最坏情况绝对电流为 $\\max(|I_i^- - i_{b,i}|, |I_i^+ - i_{b,i}|)$。\n\n原始问题现在可以重写为：\n$$\n\\min_{\\mathbf{i_b}} \\max_{i=1, \\dots, n} \\max(|I_i^- - i_{b,i}|, |I_i^+ - i_{b,i}|)\n$$\n这是一个标准的“最小最大”问题结构。我们可以引入一个辅助标量变量 $t$，它将代表所有支路的最坏情况电流幅值。该问题可以等价地表述为：\n$$\n\\min_{t, \\mathbf{i_b}} t\n$$\n约束条件为：\n$$\n\\max_{i=1, \\dots, n} \\max(|I_i^- - i_{b,i}|, |I_i^+ - i_{b,i}|) \\le t\n$$\n以及对 $\\mathbf{i_b}$ 的原始约束。\n\n主要的不等式约束可以分解为一组更简单的不等式。该条件成立当且仅当对于每个支路 $i \\in \\{1, \\dots, n\\}$：\n$$\n\\max(|I_i^- - i_{b,i}|, |I_i^+ - i_{b,i}|) \\le t\n$$\n这等价于以下不等式对：\n$$\n|I_i^- - i_{b,i}| \\le t \\quad \\text{和} \\quad |I_i^+ - i_{b,i}| \\le t\n$$\n每个绝对值不等式 $|x| \\le t$ 等价于 $-t \\le x \\le t$。应用此规则，我们得到对于每个支路 $i$：\n1.  $-t \\le I_i^- - i_{b,i} \\le t$\n2.  $-t \\le I_i^+ - i_{b,i} \\le t$\n\n这些可以重新整理以分离优化变量：\n1.  $i_{b,i} - t \\le I_i^-$ 和 $i_{b,i} + t \\ge I_i^-$\n2.  $i_{b,i} - t \\le I_i^+$ 和 $i_{b,i} + t \\ge I_i^+$\n\n将它们结合起来，我们得到：\n$$\ni_{b,i} - t \\le \\min(I_i^-, I_i^+)\n$$\n$$\ni_{b,i} + t \\ge \\max(I_i^-, I_i^+)\n$$\n\n这已将原始的鲁棒问题转化为一个标准的线性规划 (LP) 问题。完整的 LP 公式为：\n$$\n\\min_{t, i_{b,1}, \\dots, i_{b,n}} t\n$$\n约束条件为，对所有 $i \\in \\{1, \\dots, n\\}$：\n$$\n-t + i_{b,i} \\le \\min(I_i^-, I_i^+)\n$$\n$$\n-t - i_{b,i} \\le -\\max(I_i^-, I_i^+)\n$$\n$$\n\\sum_{i=1}^n i_{b,i} = 0\n$$\n$$\n-I_{b,i}^{\\max} \\le i_{b,i} \\le I_{b,i}^{\\max}\n$$\n$$\nt \\ge 0\n$$\n\n这个 LP 可以使用标准的数值求解器来解决。优化变量为 $x = [t, i_{b,1}, \\dots, i_{b,n}]^T$。目标函数为 $c^T x$，其中 $c=[1, 0, \\dots, 0]^T$。约束以矩阵形式表示为 $A_{ub}x \\le b_{ub}$，$A_{eq}x = b_{eq}$，以及变量的边界。实现时将构建这些矩阵和向量，并将它们传递给求解器。最优值 $t^{\\star}$ 将是最小化的最坏情况电流边界，而 $i_{b,1}^{\\star}, \\dots, i_{b,n}^{\\star}$ 将是最优的均衡电流。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves the robust battery balancing problem for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        {'n': 3, 'U': [3.71, 3.69, 3.73], 'R_minus': [0.0025, 0.0028, 0.0030], 'R_plus': [0.0035, 0.0032, 0.0040], 'V_bus': 3.70, 'Ib_max': [2.0, 2.0, 2.0]},\n        {'n': 4, 'U': [3.68, 3.72, 3.70, 3.75], 'R_minus': [0.0015, 0.0020, 0.0018, 0.0022], 'R_plus': [0.0050, 0.0040, 0.0045, 0.0042], 'V_bus': 3.71, 'Ib_max': [1.0, 1.0, 1.0, 1.0]},\n        {'n': 3, 'U': [3.70, 3.70, 3.70], 'R_minus': [0.0020, 0.0020, 0.0020], 'R_plus': [0.0030, 0.0030, 0.0030], 'V_bus': 3.70, 'Ib_max': [5.0, 5.0, 5.0]},\n        {'n': 2, 'U': [3.74, 3.66], 'R_minus': [0.0025, 0.0025], 'R_plus': [0.0035, 0.0035], 'V_bus': 3.70, 'Ib_max': [0.0, 0.0]}\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        n = case['n']\n        U = np.array(case['U'])\n        R_minus = np.array(case['R_minus'])\n        R_plus = np.array(case['R_plus'])\n        V_bus = case['V_bus']\n        Ib_max = np.array(case['Ib_max'])\n\n        # Calculate derived parameters based on the problem statement\n        G_minus = 1.0 / R_plus\n        G_plus = 1.0 / R_minus\n        \n        v = U - V_bus\n        \n        I_minus = G_minus * v\n        I_plus = G_plus * v\n        \n        I_min_vals = np.minimum(I_minus, I_plus)\n        I_max_vals = np.maximum(I_minus, I_plus)\n        \n        # Formulate the Linear Program (LP)\n        # Optimization variables: x = [t, i_b,1, ..., i_b,n]\n        num_vars = n + 1\n        \n        # Objective function: minimize t\n        c = np.zeros(num_vars)\n        c[0] = 1.0\n        \n        # Inequality constraints: A_ub * x = b_ub\n        # For each branch i:\n        # -t + i_b,i = min(I_i^-, I_i^+)\n        # -t - i_b,i = -max(I_i^-, I_i^+)\n        A_ub = np.zeros((2 * n, num_vars))\n        b_ub = np.zeros(2 * n)\n        \n        for i in range(n):\n            # Constraint: -t + i_b,i = I_min_i\n            A_ub[i, 0] = -1.0\n            A_ub[i, i + 1] = 1.0\n            b_ub[i] = I_min_vals[i]\n            \n            # Constraint: -t - i_b,i = -I_max_i\n            A_ub[n + i, 0] = -1.0\n            A_ub[n + i, i + 1] = -1.0\n            b_ub[n + i] = -I_max_vals[i]\n\n        # Equality constraint: A_eq * x == b_eq\n        # sum(i_b,i) = 0\n        A_eq = np.zeros((1, num_vars))\n        A_eq[0, 1:] = 1.0\n        b_eq = np.array([0.0])\n\n        # Bounds for variables\n        # t >= 0\n        # -I_b,i^max = i_b,i = I_b,i^max\n        bounds = [(0, None)] + [(-Ib_max[i], Ib_max[i]) for i in range(n)]\n\n        # Solve the LP using the 'highs' solver\n        res = linprog(c, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n\n        if res.success:\n            t_star = res.x[0]\n            ib_star = res.x[1:]\n            \n            case_result = [t_star] + list(ib_star)\n            all_results.append(case_result)\n        else:\n            # This path should not be taken for the given well-posed problems.\n            # Including for robustness, though output format won't match.\n            all_results.append([float('nan')] * (n + 1))\n\n    # Format the final output string exactly as specified.\n    formatted_results = []\n    for r in all_results:\n        # Use f-string formatting to ensure 6 decimal places, including trailing zeros.\n        formatted_r = [f\"{val:.6f}\" for val in r]\n        formatted_results.append(f\"[{','.join(formatted_r)}]\")\n    \n    print(f\"[[{','.join(formatted_results)}]]\")\n\nsolve()\n```"
        }
    ]
}