{
    "hands_on_practices": [
        {
            "introduction": "我们首先来解决多目标优化中的一个根本性挑战：如何引导搜索算法朝帕累托前沿（Pareto front）前进。本练习将介绍加权切比雪夫（weighted Tchebycheff）方法，这是一种强大的标量化技术。通过完成这个练习，你将理解为什么像线性加权这样更简单的方法会失效，以及切比雪夫标量化如何能够成功识别出最优解，即使是在电池设计中常见的复杂非凸权衡曲面上。",
            "id": "3905756",
            "problem": "在自动化电池设计和仿真中，多目标优化 (MOO) 被用来探索相互竞争的性能指标之间的权衡。考虑一个简化的电池设计向量 $x = (\\ell_{s}, \\epsilon_{p})$，其中 $\\ell_{s}$ 是隔膜厚度，$\\epsilon_{p}$ 是电极孔隙率。假设以下两个无量纲的归一化目标需要在可行集 $X = \\{ (\\ell_{s}, \\epsilon_{p}) \\,|\\, \\ell_{s} \\in [0.2, 1.0], \\epsilon_{p} \\in [0.3, 0.7] \\}$ 上最小化：\n$$\nf_{1}(x) = 0.5\\,\\ell_{s} + \\frac{0.1}{\\epsilon_{p}},\n\\qquad\nf_{2}(x) = \\frac{0.3}{\\ell_{s}} + 0.4\\,\\epsilon_{p}^{2}.\n$$\n这些代理指标分别捕捉了固定高倍率脉冲下的归一化欧姆热倾向和参考循环下的归一化衰减趋势；数值越低表示设计越好。令乌托邦点按分量定义为 $z_{i}^{*} = \\inf_{x \\in X} f_{i}(x)$，其中 $i \\in \\{1,2\\}$。令设计师的优先级向量为 $w = (w_{1}, w_{2})$，其中 $w_{1} > 0$，$w_{2} > 0$ 且 $w_{1} + w_{2} = 1$。\n\n从帕累托支配和乌托邦点的定义出发，推导一个聚合标量目标，该目标用于表示 $f(x)$ 相对于乌托邦点在所有目标上的最坏情况加权偏差，并以闭式形式表达。使用您推导出的标量化方法，在候选设计点 $x = (\\ell_{s}, \\epsilon_{p}) = (0.6, 0.5)$ 处，对权重 $w_{1} = 0.6$，$w_{2} = 0.4$ 进行求值。将您的最终数值结果四舍五入到四位有效数字，并以无量纲数的形式表示。\n\n最后，在电池设计权衡的背景下，提供一个简洁且基于原理的解释，说明为什么这种最坏情况加权偏差标量化方法能够捕捉到线性加权和聚合法无法捕捉到的非凸权衡前沿上的帕累托最优点。您的解释必须基于目标空间水平集的几何形状和帕累托最优性的定义，不得依赖于经验性论断。",
            "solution": "用户希望我解决一个多目标优化问题。\n\n## 问题验证\n\n### 第1步：提取已知条件\n- **设计向量**：$x = (\\ell_{s}, \\epsilon_{p})$，其中 $\\ell_{s}$ 是隔膜厚度，$\\epsilon_{p}$ 是电极孔隙率。\n- **可行集**：$X = \\{ (\\ell_{s}, \\epsilon_{p}) \\,|\\, \\ell_{s} \\in [0.2, 1.0], \\epsilon_{p} \\in [0.3, 0.7] \\}$。\n- **待最小化的目标函数**：\n  - $f_{1}(x) = 0.5\\,\\ell_{s} + \\frac{0.1}{\\epsilon_{p}}$\n  - $f_{2}(x) = \\frac{0.3}{\\ell_{s}} + 0.4\\,\\epsilon_{p}^{2}$\n- **乌托邦点定义**：$z_{i}^{*} = \\inf_{x \\in X} f_{i}(x)$，其中 $i \\in \\{1,2\\}$。\n- **优先级向量**：$w = (w_{1}, w_{2})$，其中 $w_{1} > 0$，$w_{2} > 0$ 且 $w_{1} + w_{2} = 1$。\n- **具体评估案例**：\n  - 权重：$w_{1} = 0.6$，$w_{2} = 0.4$。\n  - 候选设计：$x = (0.6, 0.5)$。\n- **任务**：\n  1. 推导一个表示与乌托邦点最坏情况加权偏差的聚合标量目标。\n  2. 对给定的权重和设计点评估此标量目标，并四舍五入至四位有效数字。\n  3. 提供一个基于原理的解释，说明为什么这种标量化方法可以捕捉非凸帕累托前沿。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题是在电池设计背景下设定的数学优化问题。目标函数是简化的代理模型，但其形式代表了合理的权衡（例如，欧姆热与衰减），并且不违反任何科学原理。所使用的方法（多目标优化、切比雪夫标量化）是工程和运筹学中的标准方法。\n- **良定性**：可行集 $X$ 是 $\\mathbb{R}^{2}$ 的一个紧集（闭合且有界）。目标函数 $f_{1}$ 和 $f_{2}$ 在 $X$ 上是连续的。根据极值定理，这两个函数都在 $X$ 上达到其最小值，确保了乌托邦点 $z^{*}$ 是良定义的。任务具体，并能得出唯一的数值和理论答案。\n- **客观性**：该问题以精确的数学语言陈述，没有主观或模糊的术语。\n- **完整性**：为完成任务，提供了所有必需的函数、定义域、常数和值。\n- **一致性与可行性**：约束和定义在内部是一致的。设计变量的数值范围对于归一化参数是物理上合理的。\n\n### 第3步：结论与行动\n该问题是有效的，因为它具有科学依据、是良定的、客观的且自洽的。我将继续进行求解。\n\n***\n\n解答过程按照问题陈述的要求分为三个部分。\n\n首先，我们推导聚合标量目标函数。问题要求一个标量化方法，用于编码“$f(x)$ 相对于乌托邦点在所有目标上的最坏情况加权偏差”。目标 $i$ 的偏差是 $f_{i}(x) - z_{i}^{*}$，其中 $z_{i}^{*}$ 是该目标的理想最小值。加权偏差是 $w_{i}(f_{i}(x) - z_{i}^{*})$。这些加权偏差中的“最坏情况”是它们的最大值。因此，我们记为 $S(x)$ 的聚合标量目标函数由加权切比雪夫 (Tchebycheff) 度量给出：\n$$\nS(x) = \\max_{i \\in \\{1,2\\}} \\{ w_{i} (f_{i}(x) - z_{i}^{*}) \\}\n$$\n这就是所要求的标量目标的闭式表达式。\n\n其次，我们对给定参数评估此目标。这需要计算乌托邦点 $z^{*} = (z_{1}^{*}, z_{2}^{*})$。乌托邦点的分量是各目标在可行集 $X$ 上的下确界。\n对于 $z_{1}^{*}$，我们最小化 $f_{1}(x)$：\n$$\nz_{1}^{*} = \\inf_{(\\ell_{s}, \\epsilon_{p}) \\in X} \\left( 0.5\\,\\ell_{s} + \\frac{0.1}{\\epsilon_{p}} \\right)\n$$\n函数 $f_{1}$ 是两项之和，每项仅依赖于一个独立变量。为了最小化总和，我们在各自的定义域上独立地最小化每一项。项 $0.5\\,\\ell_{s}$ 在 $\\ell_{s}$ 取最小值 $\\ell_{s} = 0.2$ 时最小化。项 $\\frac{0.1}{\\epsilon_{p}}$ 在 $\\epsilon_{p}$ 取最大值 $\\epsilon_{p} = 0.7$ 时最小化。因此：\n$$\nz_{1}^{*} = 0.5(0.2) + \\frac{0.1}{0.7} = 0.1 + \\frac{1}{7} = \\frac{1}{10} + \\frac{1}{7} = \\frac{7+10}{70} = \\frac{17}{70}\n$$\n对于 $z_{2}^{*}$，我们最小化 $f_{2}(x)$：\n$$\nz_{2}^{*} = \\inf_{(\\ell_{s}, \\epsilon_{p}) \\in X} \\left( \\frac{0.3}{\\ell_{s}} + 0.4\\,\\epsilon_{p}^{2} \\right)\n$$\n类似地，我们独立地最小化各项。项 $\\frac{0.3}{\\ell_{s}}$ 在 $\\ell_{s}$ 取最大值 $\\ell_{s} = 1.0$ 时最小化。项 $0.4\\,\\epsilon_{p}^{2}$ 在 $\\epsilon_{p}$ 取最小值 $\\epsilon_{p} = 0.3$ 时最小化。因此：\n$$\nz_{2}^{*} = \\frac{0.3}{1.0} + 0.4(0.3)^{2} = 0.3 + 0.4(0.09) = 0.3 + 0.036 = 0.336\n$$\n乌托邦点是 $z^{*} = (\\frac{17}{70}, 0.336)$。\n\n现在，我们在候选设计点 $x = (0.6, 0.5)$ 处评估目标函数：\n$$\nf_{1}(0.6, 0.5) = 0.5(0.6) + \\frac{0.1}{0.5} = 0.3 + 0.2 = 0.5\n$$\n$$\nf_{2}(0.6, 0.5) = \\frac{0.3}{0.6} + 0.4(0.5)^{2} = 0.5 + 0.4(0.25) = 0.5 + 0.1 = 0.6\n$$\n我们使用给定的权重 $w_{1} = 0.6$ 和 $w_{2} = 0.4$ 来计算加权偏差：\n$$\nw_{1} (f_{1}(x) - z_{1}^{*}) = 0.6 \\left( 0.5 - \\frac{17}{70} \\right) = 0.6 \\left( \\frac{35}{70} - \\frac{17}{70} \\right) = 0.6 \\left( \\frac{18}{70} \\right) = \\frac{10.8}{70} = \\frac{108}{700} = \\frac{27}{175}\n$$\n$$\nw_{2} (f_{2}(x) - z_{2}^{*}) = 0.4 (0.6 - 0.336) = 0.4 (0.264) = 0.1056\n$$\n现在我们求这两个值的最大值以得到 $S(x)$：\n$$\nS(0.6, 0.5) = \\max \\left( \\frac{27}{175}, 0.1056 \\right)\n$$\n为了比较它们，我们将分数转换为小数：$\\frac{27}{175} \\approx 0.1542857$。\n由于 $0.1542857... > 0.1056$，标量目标的值是 $\\frac{27}{175}$。\n四舍五入到四位有效数字，我们得到 $0.1543$。\n\n第三，我们提供基于原理的解释。在多目标优化中，目标空间中所有非支配可行点的集合构成了帕累托最优前沿。设计空间探索的一个共同目标是识别该前沿上的点。标量化方法水平集的几何形状决定了其找到所有这些点的能力。\n\n如果不存在另一个可行点 $x'$ 使得对于所有 $i$ 都有 $f_{i}(x') \\le f_{i}(x^{*})$ 并且至少存在一个索引 $j$ 使得 $f_{j}(x')  f_{j}(x^{*})$，则点 $x^{*}$ 是帕累托最优的。\n\n线性加权和聚合法使用标量目标 $S_{sum}(x) = \\sum_{i} w_{i}f_{i}(x)$。在二维目标空间 $(f_{1}, f_{2})$ 中，此函数的水平集（$S_{sum}(x) = \\text{常数}$）是斜率为 $-w_{1}/w_{2}$ 的直线。最小化 $S_{sum}$ 在几何上等同于移动这条直线，直到它与可行目标区域相切。如果帕累托前沿是非凸的（即，从原点看它有凹陷区域），则前沿上存在一些无法通过这种相切条件找到的点。这些点被称为不受支持的帕累托最优点。\n\n最坏情况加权偏差标量化（加权切比雪夫法）使用 $S_{Cheby}(x) = \\max_{i} \\{w_{i}(f_{i}(x) - z_{i}^{*})\\}$。一个水平集 $S_{Cheby}(x) = \\alpha$（其中 $\\alpha  0$ 是一个常数）对应于由 $w_{i}(f_{i}(x) - z_{i}^{*}) \\le \\alpha$（对所有 $i$）或 $f_{i}(x) \\le z_{i}^{*} + \\alpha/w_{i}$ 定义的区域的边界。在 $(f_{1}, f_{2})$ 目标空间中，这个区域是一个以乌托邦点 $z^{*}=(z_1^*, z_2^*)$ 为锚点，延伸到 $(z_1^* + \\alpha/w_1, z_2^* + \\alpha/w_2)$ 的矩形。最小化 $S_{Cheby}(x)$ 等效于找到与可行目标区域相交的最小的此类矩形（即最小的 $\\alpha$）。这个不断扩展的矩形水平集与可行区域的第一个接触点就是解。由于矩形的锐角直角，它可以“探入”并接触到帕累托前沿非凸“凹痕”内的点。通过改变权重向量 $w$，矩形的纵横比会发生变化，使其角点能够接触到帕累托前沿上的任何一点，无论该点是凸的还是非凸的。因此，加权切比雪夫法保证能够找到任何帕累托最优点，使其成为探索设计权衡的一种更稳健的方法，尤其是在帕累托前沿形状未知的情况下，这在自动化电池设计中很典型。",
            "answer": "$$\n\\boxed{0.1543}\n$$"
        },
        {
            "introduction": "在找到一组非支配解后，我们需要一种方法来量化这组解的“好坏程度”。本练习聚焦于超体积指标（hypervolume indicator），这是评估帕累托前沿近似集质量的一个关键指标。你将推导其对关键参数——参考点——的敏感度，这将使你深入理解该指标的行为方式，以及为何在比较和指导优化算法时正确使用它至关重要。",
            "id": "3905771",
            "problem": "一个自动化电池设计平台正在针对三个性能指标进行多目标设计空间探索：能量密度 $E$（最大化，单位为 $\\mathrm{Wh/kg}$）、循环寿命 $L$（最大化，单位为循环次数）以及单位能量成本 $C$（最小化，单位为 $\\$/\\mathrm{kWh}$）。为将其转换为标准的最大化问题，定义第三个目标为 $f_{3} = -C$，因此更大的 $f_{3}$ 值对应更低的成本。\n\n给定三个非支配候选设计，其目标向量为\n$$\n\\mathbf{y}^{A} = (E^{A}, L^{A}, f_{3}^{A}) = (250, 1500, -90),\\quad \\mathbf{y}^{B} = (220, 2000, -110),\\quad \\mathbf{y}^{C} = (280, 1200, -100),\n$$\n以及一个严格被支配的参考点\n$$\n\\mathbf{R} = (R_{1}, R_{2}, R_{3}) = (200, 1000, -150).\n$$\n\n仅从以下定义出发：\n- 最大化问题的帕累托支配定义（如果对于所有 $i$ 都有 $y_{i} \\ge x_{i}$，且至少存在一个 $j$ 使得 $y_{j}  x_{j}$，则点 $\\mathbf{y}$ 支配点 $\\mathbf{x}$），\n- 以及 $\\mathbb{R}^{n}$ 中的勒贝格测度定义，\n\n(1) 针对此三目标最大化问题，正式定义关于参考点 $\\mathbf{R}$ 的超体积（HV）指标，即由非支配集 $\\{\\mathbf{y}^{A}, \\mathbf{y}^{B}, \\mathbf{y}^{C}\\}$ 弱支配且以 $\\mathbf{R}$ 为界的区域的三维勒贝格测度。\n\n(2) 从第一性原理出发，通过几何推理和测度论微分，推导超体积关于参考点坐标的灵敏度，即在给定 $\\mathbf{R}$ 处计算的梯度 $\\nabla_{\\mathbf{R}}\\mathrm{HV}(\\mathbf{R}) = \\left( \\frac{\\partial \\mathrm{HV}}{\\partial R_{1}}, \\frac{\\partial \\mathrm{HV}}{\\partial R_{2}}, \\frac{\\partial \\mathrm{HV}}{\\partial R_{3}} \\right)$。\n\n将灵敏度的每个分量表示为相应坐标轴单位变化所引起的超体积变化量，单位如下：\n- $\\frac{\\partial \\mathrm{HV}}{\\partial R_{1}}$ 的单位为 $(\\mathrm{cycles}) \\cdot (\\$/\\mathrm{kWh})$，\n- $\\frac{\\partial \\mathrm{HV}}{\\partial R_{2}}$ 的单位为 $(\\mathrm{Wh/kg}) \\cdot (\\$/\\mathrm{kWh})$，\n- $\\frac{\\partial \\mathrm{HV}}{\\partial R_{3}}$ 的单位为 $(\\mathrm{Wh/kg}) \\cdot (\\mathrm{cycles})$。\n\n以数值形式报告最终的灵敏度向量。最终的方框答案中不要包含单位。无需四舍五入；如果推导中自然产生整数，请给出精确整数。",
            "solution": "该问题被评估为有效。它在科学上基于多目标优化和实分析的既定理论，问题定义良好，具有唯一且可推导的解，陈述客观，并提供了解决该问题所需的所有信息。\n\n该问题要求完成两项任务：（$1$）正式定义超体积（HV）指标；（$2$）推导其关于参考点坐标的灵敏度。\n\n### 第 (1) 部分：超体积（HV）指标的正式定义\n\n令 $S = \\{\\mathbf{y}^{A}, \\mathbf{y}^{B}, \\mathbf{y}^{C}\\} \\subset \\mathbb{R}^3$ 为给定的三个非支配目标向量集。令 $\\mathbf{R} \\in \\mathbb{R}^3$ 为给定的参考点，它被 $S$ 中所有的点支配。目标是最大化的。\n\n如果对于所有 $i \\in \\{1, 2, 3\\}$ 都有 $y_i \\ge p_i$，则称点 $\\mathbf{p} \\in \\mathbb{R}^3$ 被点 $\\mathbf{y} \\in S$ 弱支配。被集合 $S$ 弱支配的区域是所有被 $S$ 中每个点弱支配的区域的并集。\n\n超体积指标 $\\mathrm{HV}(S, \\mathbf{R})$ 定义为目标空间中被 $S$ 中至少一个点弱支配且支配参考点 $\\mathbf{R}$ 的点集的勒贝格测度。记该区域为 $H(S, \\mathbf{R})$。形式上，该集合定义为：\n$$\nH(S, \\mathbf{R}) = \\left\\{ \\mathbf{p} \\in \\mathbb{R}^3 \\mid \\exists \\mathbf{y} \\in S \\text{ such that } y_i \\ge p_i \\ge R_i \\text{ for } i = 1, 2, 3 \\right\\}\n$$\n这可以表示为三个超矩形（长方体）的并集，每个超矩形对应 $S$ 中的一个点：\n$$\nH(S, \\mathbf{R}) = \\bigcup_{\\mathbf{y} \\in S} [\\![ \\mathbf{R}, \\mathbf{y} ]\\!]\n$$\n其中 $[\\![ \\mathbf{R}, \\mathbf{y} ]\\!] = [R_1, y_1] \\times [R_2, y_2] \\times [R_3, y_3]$ 是以 $\\mathbf{R}$ 和 $\\mathbf{y}$ 为对角的超矩形。\n\n超体积是该集合的三维勒贝格测度 $\\lambda_3$：\n$$\n\\mathrm{HV}(S, \\mathbf{R}) = \\lambda_3(H(S, \\mathbf{R})) = \\int_{\\mathbb{R}^3} \\mathbf{1}_{H(S, \\mathbf{R})}(\\mathbf{p}) \\, d\\mathbf{p}\n$$\n其中 $\\mathbf{1}_{H(S, \\mathbf{R})}$ 是集合 $H(S, \\mathbf{R})$ 的指示函数。\n\n### 第 (2) 部分：灵敏度 $\\nabla_{\\mathbf{R}}\\mathrm{HV}(\\mathbf{R})$ 的推导\n\n超体积关于参考点的灵敏度是梯度向量 $\\nabla_{\\mathbf{R}}\\mathrm{HV}(\\mathbf{R}) = \\left( \\frac{\\partial \\mathrm{HV}}{\\partial R_{1}}, \\frac{\\partial \\mathrm{HV}}{\\partial R_{2}}, \\frac{\\partial \\mathrm{HV}}{\\partial R_{3}} \\right)$。一个直接的表示是：\n$$\n\\mathrm{HV}(S, \\mathbf{R}) = \\int_{R_1}^{\\infty} \\int_{R_2}^{\\infty} \\int_{R_3}^{\\infty} \\mathbf{1}_{\\mathcal{U}(S)}(\\mathbf{p}) \\, dp_3 \\, dp_2 \\, dp_1\n$$\n其中 $\\mathcal{U}(S)$ 是被集合 $S$ 弱支配的区域。\n\n使用积分符号下的微分的莱布尼茨积分法则（微积分基本定理的一个推论），关于积分下限的偏导数是在该下限处被积函数值的负数。对于第一个分量 $R_1$：\n$$\n\\frac{\\partial \\mathrm{HV}}{\\partial R_1} = \\frac{\\partial}{\\partial R_1} \\int_{R_1}^{\\infty} \\left( \\int_{R_2}^{\\infty} \\int_{R_3}^{\\infty} \\mathbf{1}_{\\mathcal{U}(S)}(p_1, p_2, p_3) \\, dp_3 \\, dp_2 \\right) \\, dp_1 = - \\int_{R_2}^{\\infty} \\int_{R_3}^{\\infty} \\mathbf{1}_{\\mathcal{U}(S)}(R_1, p_2, p_3) \\, dp_3 \\, dp_2\n$$\n这个积分表示在平面 $p_1 = R_1$ 上超体积区域切片的二维勒贝格测度（面积）。我们将这个面积记为 $A_1$。因此，$\\frac{\\partial \\mathrm{HV}}{\\partial R_1} = -A_1$。类似地，$\\frac{\\partial \\mathrm{HV}}{\\partial R_2} = -A_2$ 和 $\\frac{\\partial \\mathrm{HV}}{\\partial R_3} = -A_3$，其中 $A_2$ 和 $A_3$ 是在 $p_2=R_2$ 和 $p_3=R_3$ 处相应切片的面积。\n\n给定的数据是：\n$\\mathbf{y}^{A} = (250, 1500, -90)$，$\\mathbf{y}^{B} = (220, 2000, -110)$，$\\mathbf{y}^{C} = (280, 1200, -100)$，以及 $\\mathbf{R} = (200, 1000, -150)$。\n$S$ 中所有点的坐标都大于或等于 $\\mathbf{R}$ 的相应坐标，因此对于每次计算，来自 $S$ 的相关点集就是整个集合 $S$。\n\n**$\\frac{\\partial \\mathrm{HV}}{\\partial R_1}$ 的计算：**\n我们需要计算面积 $A_1$，即 $(p_2, p_3)$ 平面中矩形并集的面积。这些矩形由 $[R_2, y_i] \\times [R_3, y_i]$ 定义，对应每个点 $\\mathbf{y}^i$ 在 $(p_2, p_3)$ 平面上的投影。投影点为 $(y_2, y_3)$：$P_A = (1500, -90)$，$P_B = (2000, -110)$，$P_C = (1200, -100)$。参考角点为 $(R_2, R_3) = (1000, -150)$。我们按 $p_2$ 坐标对区域进行切片：$1000, 1200, 1500, 2000$。\n- 对于 $p_2 \\in [1000, 1200]$（宽度 $200$），$p_3$ 的上界是 $\\max(-90, -110, -100) = -90$。高度是 $-90 - (-150) = 60$。面积 = $200 \\times 60 = 12000$。\n- 对于 $p_2 \\in (1200, 1500]$（宽度 $300$），经过了点 $C$。上界是 $\\max(-90, -110) = -90$。高度是 $-90 - (-150) = 60$。面积 = $300 \\times 60 = 18000$。\n- 对于 $p_2 \\in (1500, 2000]$（宽度 $500$），经过了点 $A$。上界是 $-110$。高度是 $-110 - (-150) = 40$。面积 = $500 \\times 40 = 20000$。\n$A_1 = 12000 + 18000 + 20000 = 50000$。\n因此，$\\frac{\\partial \\mathrm{HV}}{\\partial R_1} = -50000$。\n\n**$\\frac{\\partial \\mathrm{HV}}{\\partial R_2}$ 的计算：**\n我们计算面积 $A_2$，其来自于在 $(p_1, p_3)$ 平面上的投影：$P_A = (250, -90)$，$P_B = (220, -110)$，$P_C = (280, -100)$，参考角点为 $(R_1, R_3) = (200, -150)$。我们按 $p_1$ 坐标进行切片：$200, 220, 250, 280$。\n- 对于 $p_1 \\in [200, 220]$（宽度 $20$），$p_3$ 的上界是 $\\max(-90, -110, -100) = -90$。高度是 $-90 - (-150) = 60$。面积 = $20 \\times 60 = 1200$。\n- 对于 $p_1 \\in (220, 250]$（宽度 $30$），经过了点 $B$。上界是 $\\max(-90, -100) = -90$。高度是 $-90 - (-150) = 60$。面积 = $30 \\times 60 = 1800$。\n- 对于 $p_1 \\in (250, 280]$（宽度 $30$），经过了点 $A$。上界是 $-100$。高度是 $-100 - (-150) = 50$。面积 = $30 \\times 50 = 1500$。\n$A_2 = 1200 + 1800 + 1500 = 4500$。\n因此，$\\frac{\\partial \\mathrm{HV}}{\\partial R_2} = -4500$。\n\n**$\\frac{\\partial \\mathrm{HV}}{\\partial R_3}$ 的计算：**\n我们计算面积 $A_3$，其来自于在 $(p_1, p_2)$ 平面上的投影：$P_A = (250, 1500)$，$P_B = (220, 2000)$，$P_C = (280, 1200)$，参考角点为 $(R_1, R_2) = (200, 1000)$。我们按 $p_1$ 坐标进行切片：$200, 220, 250, 280$。\n- 对于 $p_1 \\in [200, 220]$（宽度 $20$），$p_2$ 的上界是 $\\max(1500, 2000, 1200) = 2000$。高度是 $2000 - 1000 = 1000$。面积 = $20 \\times 1000 = 20000$。\n- 对于 $p_1 \\in (220, 250]$（宽度 $30$），经过了点 $B$。上界是 $\\max(1500, 1200) = 1500$。高度是 $1500 - 1000 = 500$。面积 = $30 \\times 500 = 15000$。\n- 对于 $p_1 \\in (250, 280]$（宽度 $30$），经过了点 $A$。上界是 $1200$。高度是 $1200 - 1000 = 200$。面积 = $30 \\times 200 = 6000$。\n$A_3 = 20000 + 15000 + 6000 = 41000$。\n因此，$\\frac{\\partial \\mathrm{HV}}{\\partial R_3} = -41000$。\n\n最终的灵敏度向量是梯度：\n$$\n\\nabla_{\\mathbf{R}}\\mathrm{HV}(\\mathbf{R}) = \\left( -50000, -4500, -41000 \\right).\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -50000  -4500  -41000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "现实世界中的设计模拟通常计算成本高昂，使得详尽搜索变得不切实际。这最后一个练习将探讨高斯过程（Gaussian Process, GP）代理模型如何利用稀疏数据构建设计空间的映射。你将推导留一法误差（leave-one-out error）——一种评估模型精度的重要诊断方法，并了解它如何直接为自适应采样策略提供信息，从而智能地选择新的模拟点，在最需要的区域完善模型。",
            "id": "3905833",
            "problem": "在先进锂离子电池的自动化设计与仿真中，一个常见的设计变量是电极厚度（记为 $t$），一个关键的目标量是在指定快速充电协议结束时的析锂风险指标（记为 $r(t)$）。假设使用高斯过程 (GP) 代理模型，基于 $n$ 个仿真数据对 $\\mathcal{D} = \\{(t_i, y_i)\\}_{i=1}^n$，在厚度 $t \\in \\mathbb{R}$ 的一维设计空间上对 $r(t)$ 进行建模。其中，$y_i$ 是 $r(t_i)$ 的一个含噪实现，带有方差为 $\\sigma_n^2$ 的附加独立高斯噪声。假设一个零均值高斯过程先验，其协方差函数 $k_{\\boldsymbol{\\theta}}(t,t')$ 是严格正定的。令 $K \\in \\mathbb{R}^{n \\times n}$ 表示协方差矩阵，其元素为 $K_{ij} = k_{\\boldsymbol{\\theta}}(t_i, t_j)$。定义 $A = K + \\sigma_n^2 I$，其中 $I$ 是单位矩阵，并令 $\\mathbf{y} = [y_1,\\dots,y_n]^{\\top}$。假设 GP 超参数 $\\boldsymbol{\\theta}$ 和观测噪声方差 $\\sigma_n^2$ 是固定且已知的。\n\n仅从以下基本原理出发：\n- GP 值的任意有限集合都服从联合高斯分布的性质；\n- 标准的多元正态条件恒等式；以及\n- 通过舒尔补进行的基本分块矩阵求逆，\n\n完成以下任务。\n\n1) 当模型在移除了第 $i$ 个数据对的数据集上进行训练时，推导第 $i$ 个训练输入的留一法预测均值 $\\mu_{-i}(t_i)$ 和预测方差 $\\sigma_{-i}^2(t_i)$，并用 $A^{-1}$ 和 $\\mathbf{y}$ 表示。除了正定性外，不对 $k_{\\boldsymbol{\\theta}}(\\cdot,\\cdot)$ 的具体形式做任何假设。\n\n2) 根据您的推导，获得在 $t_i$ 处的留一法残差（定义为 $e^{\\mathrm{loo}}_i = y_i - \\mu_{-i}(t_i)$）的简洁表达式，该表达式完全使用向量 $\\boldsymbol{\\alpha} = A^{-1} \\mathbf{y}$ 和 $A^{-1}$ 的对角线元素表示。\n\n3) 将 $n$ 个训练输入上的留一法均方根误差定义为 $\\mathrm{RMSE}_{\\mathrm{loo}} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^n \\left(e^{\\mathrm{loo}}_i\\right)^2}$。提供一个 $\\mathrm{RMSE}_{\\mathrm{loo}}$ 的单一闭式解析表达式，该表达式纯粹用 $A^{-1}$ 和 $\\mathbf{y}$ 表示，并消去 $\\mu_{-i}(t_i)$ 和 $\\sigma_{-i}^2(t_i)$。\n\n4) 使用贝叶斯不确定性量化和设计空间探索的基本原理，简要论证如何利用 $e^{\\mathrm{loo}}_i$ 和 $\\sigma_{-i}(t_i)$ 的大小，在 $r(t)$ 随 $t$ 快速变化的厚度区域附近自适应地优化采样。您的论证应将梯度大小 $|\\partial \\mu(t)/\\partial t|$ 和局部预测不确定性与在何处添加新仿真点的决策联系起来，而不援引任何超出所述基本原理可推导出的采集函数。\n\n您的最终答案必须是第 $3)$ 项所要求的单一闭式解析表达式。不需要进行数值计算，也不需要单位。如果您选择简化符号，请明确定义。最终答案必须是单一的解析表达式，而不是不等式或带有自由文字限定词的方程。",
            "solution": "该问题陈述已经过严格验证，被认为是具有科学依据、良定、客观且内部一致的。它在高斯过程 (GP) 的统计理论方面提供了一个标准而严谨的练习，并直接且恰当地应用于自动化工程设计。所有必要的定义和约束均已提供，问题可使用指定的基本原理解决。因此，我们可以进行完整推导。\n\n按照要求，问题分四个部分解决。我们的分析将依赖于多元正态分布的性质和分块矩阵求逆。令 $A = K + \\sigma_n^2 I$，其中 $K$ 是 $n \\times n$ 的协方差矩阵，其元素为 $K_{ij} = k_{\\boldsymbol{\\theta}}(t_i, t_j)$。由于核函数 $k_{\\boldsymbol{\\theta}}(\\cdot, \\cdot)$ 是严格正定的，所以 $K$ 是一个正定矩阵。鉴于噪声方差 $\\sigma_n^2$ 必须为非负（并且在一个真实的含噪系统中，它被隐含为正），矩阵 $A$ 是一个正定矩阵与一个半正定矩阵（$\\sigma_n^2 I$）之和，这使得 $A$ 本身也是严格正定且因此可逆的。\n\n**1) 留一法 (LOO) 预测均值与方差的推导**\n\n目标是使用移除了第 $i$ 个点的训练数据 $\\mathcal{D}_{-i} = \\mathcal{D} \\setminus \\{(t_i, y_i)\\}$，来求出潜函数值 $r(t_i)$ 的预测分布。移除了 $t_i$ 的训练输入向量为 $\\mathbf{t}_{-i}$，相应的输出为 $\\mathbf{y}_{-i}$。\n\n根据高斯过程的定义，任何函数值的有限集合都服从联合高斯分布。考虑含噪观测值 $\\mathbf{y}$，它们的联合分布由 $p(\\mathbf{y}) = \\mathcal{N}(\\mathbf{y}|\\mathbf{0}, A)$ 给出。我们可以将此分布相对于第 $i$ 个元素 $y_i$ 和其余元素 $\\mathbf{y}_{-i}$ 进行分块。为清晰起见，我们对元素进行置换（尽管这并非严格必要）。$(y_i, \\mathbf{y}_{-i}^\\top)^\\top$ 的联合分布为：\n$$\n\\begin{pmatrix} y_i \\\\ \\mathbf{y}_{-i} \\end{pmatrix} \\sim \\mathcal{N} \\left( \\begin{pmatrix} 0 \\\\ \\mathbf{0} \\end{pmatrix}, \\begin{pmatrix} a_{ii}  \\mathbf{a}_{i,-i} \\\\ \\mathbf{a}_{-i,i}  A_{-i,-i} \\end{pmatrix} \\right)\n$$\n其中 $a_{ii} = K_{ii} + \\sigma_n^2$，$\\mathbf{a}_{i,-i} = [K_{i1}, \\dots, K_{i,i-1}, K_{i,i+1}, \\dots, K_{in}]$，而 $A_{-i,-i}$ 是从矩阵 $A$ 中移除第 $i$ 行和第 $i$ 列后得到的矩阵。注意 $\\mathbf{a}_{-i,i} = \\mathbf{a}_{i,-i}^\\top$。矩阵 $A_{-i,-i}$ 等价于 $K_{-i,-i} + \\sigma_n^2 I_{n-1}$，其中 $K_{-i,-i}$ 是输入 $\\mathbf{t}_{-i}$ 的协方差矩阵。\n\n使用多元正态分布的标准条件化规则，条件分布 $p(y_i|\\mathbf{y}_{-i})$ 是一个高斯分布，其均值和方差为：\n$$\n\\mathbb{E}[y_i|\\mathbf{y}_{-i}] = \\mathbf{a}_{i,-i} (A_{-i,-i})^{-1} \\mathbf{y}_{-i}\n$$\n$$\n\\mathrm{Var}[y_i|\\mathbf{y}_{-i}] = a_{ii} - \\mathbf{a}_{i,-i} (A_{-i,-i})^{-1} \\mathbf{a}_{-i,i}\n$$\n潜函数值 $r(t_i)$ 的留一法预测均值 $\\mu_{-i}(t_i)$ 是通过以含噪数据 $\\mathbf{y}_{-i}$ 为条件计算得出的。$(r(t_i), \\mathbf{y}_{-i}^\\top)^\\top$ 的联合分布为：\n$$\n\\begin{pmatrix} r(t_i) \\\\ \\mathbf{y}_{-i} \\end{pmatrix} \\sim \\mathcal{N} \\left( \\begin{pmatrix} 0 \\\\ \\mathbf{0} \\end{pmatrix}, \\begin{pmatrix} K_{ii}  \\mathbf{k}_{i,-i} \\\\ \\mathbf{k}_{-i,i}  K_{-i,-i} + \\sigma_n^2 I_{n-1} \\end{pmatrix} \\right)\n$$\n其中 $\\mathbf{k}_{i,-i}$ 是协方差的行向量 $[k(t_i, t_j)]_{j \\neq i}$，它与 $\\mathbf{a}_{i,-i}$ 相同。以 $\\mathbf{y}_{-i}$ 为条件对 $r(t_i)$ 进行条件化，得到 LOO 预测均值：\n$$\n\\mu_{-i}(t_i) = \\mathbb{E}[r(t_i)|\\mathbf{y}_{-i}] = \\mathbf{k}_{i,-i} (K_{-i,-i} + \\sigma_n^2 I_{n-1})^{-1} \\mathbf{y}_{-i} = \\mathbf{a}_{i,-i} (A_{-i,-i})^{-1} \\mathbf{y}_{-i}\n$$\n因此我们发现 $\\mu_{-i}(t_i) = \\mathbb{E}[y_i|\\mathbf{y}_{-i}]$。潜函数的 LOO 预测方差为：\n$$\n\\sigma_{-i}^2(t_i) = \\mathrm{Var}[r(t_i)|\\mathbf{y}_{-i}] = K_{ii} - \\mathbf{k}_{i,-i} (K_{-i,-i} + \\sigma_n^2 I_{n-1})^{-1} \\mathbf{k}_{-i,i}\n$$\n任务是用完整的逆矩阵 $A^{-1}$ 来表示这些量。我们使用分块矩阵求逆公式，该公式依赖于舒尔补。矩阵 $A$ 中分块 $A_{-i,-i}$ 的舒尔补是 $S_i = a_{ii} - \\mathbf{a}_{i,-i} (A_{-i,-i})^{-1} \\mathbf{a}_{-i,i}$。逆矩阵 $A^{-1}$ 的第 $(i,i)$ 个元素是这个舒尔补的逆：\n$$\n(A^{-1})_{ii} = S_i^{-1} = (a_{ii} - \\mathbf{a}_{i,-i} (A_{-i,-i})^{-1} \\mathbf{a}_{-i,i})^{-1}\n$$\n这正是条件方差 $\\mathrm{Var}[y_i|\\mathbf{y}_{-i}]$ 的倒数。\n$$\n\\mathrm{Var}[y_i|\\mathbf{y}_{-i}] = \\frac{1}{(A^{-1})_{ii}}\n$$\n代入定义 $a_{ii} = K_{ii} + \\sigma_n^2$ 和 $\\mathbf{a}_{i,-i} = \\mathbf{k}_{i,-i}$，我们得到：\n$$\n\\frac{1}{(A^{-1})_{ii}} = (K_{ii} + \\sigma_n^2) - \\mathbf{k}_{i,-i} (K_{-i,-i} + \\sigma_n^2 I_{n-1})^{-1} \\mathbf{k}_{-i,i}\n$$\n通过重新整理并与 $\\sigma_{-i}^2(t_i)$ 的表达式进行比较，我们发现：\n$$\n\\sigma_{-i}^2(t_i) = K_{ii} - \\mathbf{k}_{i,-i} (K_{-i,-i} + \\sigma_n^2 I_{n-1})^{-1} \\mathbf{k}_{-i,i} = \\frac{1}{(A^{-1})_{ii}} - \\sigma_n^2\n$$\n这就给出了 LOO 预测方差。\n\n对于 LOO 预测均值，我们使用另一个来自块矩阵和高斯条件化的恒等式。考虑精度矩阵 $\\Lambda = A^{-1}$。在给定 $\\mathbf{y}_{-i}$ 的情况下，$y_i$ 的条件均值（对于零均值过程）由 $\\mathbb{E}[y_i|\\mathbf{y}_{-i}] = -(\\Lambda_{ii})^{-1} \\sum_{j \\neq i} \\Lambda_{ij} y_j$ 给出。由于我们已经证明 $\\mu_{-i}(t_i) = \\mathbb{E}[y_i|\\mathbf{y}_{-i}]$，我们有：\n$$\n\\mu_{-i}(t_i) = -\\frac{1}{(A^{-1})_{ii}} \\sum_{j \\neq i} (A^{-1})_{ij} y_j\n$$\n该表达式用 $A^{-1}$ 和 $\\mathbf{y}$ 表示。通过将其与向量 $\\boldsymbol{\\alpha} = A^{-1} \\mathbf{y}$ 关联，可以找到另一种更简洁的形式。根据定义，$\\boldsymbol{\\alpha}_i = \\sum_{j=1}^n (A^{-1})_{ij} y_j = (A^{-1})_{ii} y_i + \\sum_{j \\neq i} (A^{-1})_{ij} y_j$。\n重新整理得到 $\\sum_{j \\neq i} (A^{-1})_{ij} y_j = \\boldsymbol{\\alpha}_i - (A^{-1})_{ii} y_i$。将此代入 $\\mu_{-i}(t_i)$ 的表达式中：\n$$\n\\mu_{-i}(t_i) = -\\frac{1}{(A^{-1})_{ii}} (\\boldsymbol{\\alpha}_i - (A^{-1})_{ii} y_i) = y_i - \\frac{\\boldsymbol{\\alpha}_i}{(A^{-1})_{ii}}\n$$\n\n**2) 留一法残差的表达式**\n\n留一法残差定义为 $e^{\\mathrm{loo}}_i = y_i - \\mu_{-i}(t_i)$。使用上面推导出的 $\\mu_{-i}(t_i)$ 的简洁表达式：\n$$\ne^{\\mathrm{loo}}_i = y_i - \\left( y_i - \\frac{\\boldsymbol{\\alpha}_i}{(A^{-1})_{ii}} \\right) = \\frac{\\boldsymbol{\\alpha}_i}{(A^{-1})_{ii}}\n$$\n其中 $\\boldsymbol{\\alpha} = A^{-1} \\mathbf{y}$。如要求所示，这完全用向量 $\\boldsymbol{\\alpha}$ 和 $A^{-1}$ 的对角线元素表示了残差。\n\n**3) $\\mathrm{RMSE}_{\\mathrm{loo}}$ 的闭式表达式**\n\n留一法均方根误差定义为 $\\mathrm{RMSE}_{\\mathrm{loo}} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^n (e^{\\mathrm{loo}}_i)^2}$。我们将第 2 部分中 $e^{\\mathrm{loo}}_i$ 的表达式代入此定义：\n$$\n\\mathrm{RMSE}_{\\mathrm{loo}} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^n \\left( \\frac{\\boldsymbol{\\alpha}_i}{(A^{-1})_{ii}} \\right)^2}\n$$\n为了使对 $A^{-1}$ 和 $\\mathbf{y}$ 的依赖性完全显式，我们代入 $\\boldsymbol{\\alpha}_i = (A^{-1} \\mathbf{y})_i = \\sum_{j=1}^n (A^{-1})_{ij} y_j$。这得出了最终的闭式表达式：\n$$\n\\mathrm{RMSE}_{\\mathrm{loo}} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^n \\left( \\frac{\\sum_{j=1}^n (A^{-1})_{ij} y_j}{(A^{-1})_{ii}} \\right)^2}\n$$\n此表达式仅依赖于预先计算的矩阵 $A^{-1}$ 和观测向量 $\\mathbf{y}$，并提供了一种计算上高效的方法来估计 LOO 交叉验证误差，而无需重新训练 GP 模型 $n$ 次。\n\n**4) 自适应采样的论证**\n\n在设计空间探索中，自适应采样的目标是在能最有效地提高模型准确性并减少其不确定性的区域添加新的仿真点。LOO 指标为识别此类区域提供了有价值的启发式方法。\n\nLOO 残差的大小 $|e^{\\mathrm{loo}}_i| = |\\frac{\\boldsymbol{\\alpha}_i}{(A^{-1})_{ii}}|$，量化了数据点 $(t_i, y_i)$ 相对于数据集其余部分的“意外程度”。一个大的 $|e^{\\mathrm{loo}}_i|$ 意味着在 $\\mathcal{D}_{-i}$ 上训练的模型在 $t_i$ 处做出了糟糕的预测。在 GP 框架内，这意味着函数 $r(t)$ 的行为不易于从邻近点插值得到，可能在 $t_i$ 附近表现出快速变化或高曲率。为了捕捉这种快速变化，后验均值 $\\mu(t)$ 必须在 $t_i$ 附近具有较大的梯度大小 $|\\partial \\mu(t)/\\partial t|$。因此，具有高 LOO 残差的区域是添加新样本以更好地解析函数局部行为的主要候选区域。\n\nLOO 预测不确定性，由标准差 $\\sigma_{-i}(t_i) = \\sqrt{(A^{-1})_{ii}^{-1} - \\sigma_n^2}$ 表示，衡量了当该点被排除在训练之外时，模型在位置 $t_i$ 处的认知不确定性（或可约减不确定性）。一个大的 $\\sigma_{-i}(t_i)$ 表明点 $t_i$ 受到其他数据点的约束不佳。在一维空间中，这通常发生在 $t_i$ 位于一个采样稀疏的区域，即它到其邻居的距离很大。相关函数 $k(t,t')$ 随距离衰减，因此远处的点提供的信息很少，导致后验方差很高。在高 $\\sigma_{-i}(t_i)$ 的区域进行采样直接针对模型不确定性高的区域，减少了代理模型的整体预测方差，使其更加可靠。\n\n总之，通过检查整个训练集上的 LOO 指标，可以设计出一种有原则的自适应采样策略。可以为所有 $i=1, \\dots, n$ 计算 $|e^{\\mathrm{loo}}_i|$ 和 $\\sigma_{-i}(t_i)$。下一次仿真应在一个新点 $t_{\\text{new}}$ 处进行，该点位于表现出最大误差或不确定性的现有数据点 $t_k$ 的邻域中（例如，最大化 $|e^{\\mathrm{loo}}_k|$）。这通过在最需要的地方添加数据来迭代地优化模型，无论是为了纠正预测误差（由 $|e^{\\mathrm{loo}}_i|$ 指示）还是为了减少模型的不确定性（由 $\\sigma_{-i}(t_i)$ 指示）。这种方法利用了 GP 贝叶斯公式内蕴的信息来高效地指导探索过程。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} \\left( \\frac{\\sum_{j=1}^{n} (A^{-1})_{ij} y_j}{(A^{-1})_{ii}} \\right)^{2}}}\n$$"
        }
    ]
}