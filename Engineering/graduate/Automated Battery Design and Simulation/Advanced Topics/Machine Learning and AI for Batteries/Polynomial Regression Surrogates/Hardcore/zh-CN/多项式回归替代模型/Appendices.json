{
    "hands_on_practices": [
        {
            "introduction": "在构建可靠的代理模型之前，一个基本前提是确保模型参数的可辨识性。这意味着我们必须首先确认，我们拥有的数据是否足以唯一地确定模型中的所有参数。本练习  提出了一个在设计初期经常遇到的场景：由于模拟成本高昂，可用的数据点稀少。这迫使我们直面“特征多于样本”的挑战，并思考解决这一根本问题的策略，如正则化或特征选择。",
            "id": "3941886",
            "problem": "在自动化电池设计与仿真中，假设需要寻找一个代理模型，该模型将电极设计变量向量 $\\mathbf{x} \\in \\mathbb{R}^{p}$（例如，厚度、孔隙率、颗粒尺寸、粘合剂分数）映射到诸如放电容量 $C$ 的响应。该代理模型被指定为总次数为 $3$ 的多项式回归，构建于一个具有 $m=35$ 个基函数（包括交互项和三次项）的多项式特征映射 $\\phi(\\mathbf{x}) \\in \\mathbb{R}^{m}$ 之上，从而得到一个参数线性模型 $C \\approx \\phi(\\mathbf{x})^{\\top}\\boldsymbol{\\beta}$，其参数向量为 $\\boldsymbol{\\beta} \\in \\mathbb{R}^{m}$。通过自动化仿真收集了一个包含 $n=30$ 个电池设计的合成数据集，得到了设计矩阵 $X \\in \\mathbb{R}^{n \\times m}$（其中 $n=30$，$m=35$）和响应 $\\mathbf{y} \\in \\mathbb{R}^{n}$。\n\n根据线性模型的可辨识性定义和最小二乘估计的性质，判断在此设置中参数向量 $\\boldsymbol{\\beta}$ 是否可以从 $(X,\\mathbf{y})$ 中辨识出来，并选择最合适的补救措施，以在自动化电池设计与仿真的约束下获得一个唯一的、具有物理意义的代理模型。\n\n选择唯一最佳选项：\n\nA. 模型不可辨识，因为 $m>n$ 意味着 $\\operatorname{rank}(X) \\leq n  m$，所以 $\\boldsymbol{\\beta}$ 不能被 $(X,\\mathbf{y})$ 唯一确定。一种补救措施是施加正则化（例如，惩罚参数 $\\lambda>0$ 的岭回归），或通过基于物理知识的特征选择来减少 $m$，和/或通过实验设计增加 $n$ 以达到 $\\operatorname{rank}(X)=m$。\n\nB. 通过包含截距项，模型变得可辨识，因为增加一个常数列可以稳定回归；因此，仅用 $1$ 增广 $\\phi(\\mathbf{x})$ 就可以在不改变 $n$ 的情况下解决问题。\n\nC. 模型是可辨识的，因为一个3次多项式足够灵活以捕捉电池的物理特性，所以可以无需修改直接进行普通最小二乘法。\n\nD. 如果测量噪声是高斯噪声，则模型是可辨识的，因为高斯噪声意味着最大似然与最小二乘一致，所以可以无需正则化进行拟合。\n\nE. 模型不可辨识仅仅是因为多项式特征之间存在多重共线性；即使在 $m>n$ 的情况下，仅对基进行正交化（例如，通过格拉姆-施密特方法）就能确保可辨识性。",
            "solution": "问题陈述描述了一个为自动化电池设计过程学习代理模型的场景。该模型是基于一组多项式特征的线性回归。我们必须首先分析模型参数唯一可辨识性的条件。\n\n线性模型由方程 $\\mathbf{y} = X\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}$ 给出，其中 $\\mathbf{y} \\in \\mathbb{R}^{n}$ 是观测响应向量，$X \\in \\mathbb{R}^{n \\times m}$ 是设计矩阵（其行是特征向量 $\\phi(\\mathbf{x}_i)^\\top$），$\\boldsymbol{\\beta} \\in \\mathbb{R}^{m}$ 是待估计的参数向量，$\\boldsymbol{\\epsilon} \\in \\mathbb{R}^{n}$ 是未观测到的误差向量。\n\n如果参数向量 $\\boldsymbol{\\beta}$ 可以从数据 $(X, \\mathbf{y})$ 中唯一确定，则它被认为是可辨识的。在普通最小二乘法 (OLS) 的背景下，估计值 $\\hat{\\boldsymbol{\\beta}}$ 是使残差平方和 $||\\mathbf{y} - X\\boldsymbol{\\beta}||_2^2$ 最小化的向量。该最小化问题的解由正规方程给出：\n$$X^{\\top}X\\boldsymbol{\\beta} = X^{\\top}\\mathbf{y}$$\n为了使 $\\boldsymbol{\\beta}$ 的解唯一存在，矩阵 $X^{\\top}X$ 必须是可逆的。矩阵 $X^{\\top}X$ 是一个 $m \\times m$ 的方阵。一个方阵可逆当且仅当它具有满秩，即 $\\operatorname{rank}(X^{\\top}X) = m$。这个条件满足当且仅当设计矩阵 $X$ 具有满列秩，即 $\\operatorname{rank}(X) = m$。\n\n任何矩阵的秩都不能超过其行数和列数的最小值。对于设计矩阵 $X \\in \\mathbb{R}^{n \\times m}$，我们有：\n$$\\operatorname{rank}(X) \\leq \\min(n, m)$$\n在问题中，我们已知：\n- 观测数量（电池设计）：$n=30$\n- 模型参数数量（基函数）：$m=35$\n\n由于 $n  m$，设计矩阵 $X$ 的最大可能秩受行数限制：\n$$\\operatorname{rank}(X) \\leq \\min(30, 35) = 30$$\n这意味着 $\\operatorname{rank}(X) \\leq 30$，严格小于参数数量 $m=35$。因此，$X$ 不具有满列秩。所以，矩阵 $X^{\\top}X$ 是奇异的（不可逆的），正规方程 $X^{\\top}X\\boldsymbol{\\beta} = X^{\\top}\\mathbf{y}$ 没有唯一解。存在无穷多个向量 $\\boldsymbol{\\beta}$ 满足该方程，这意味着使用普通最小二乘法无法从数据中辨识出参数向量。这是一个经典的“欠定”或“高维”问题，即特征数量多于观测数量。\n\n在这种情况下，要获得唯一且稳定的解，必须对问题进行修改。标准方法包括：\n1.  **正则化：** 在最小二乘目标函数中加入一个惩罚项。例如，岭回归（吉洪诺夫正则化）最小化 $||\\mathbf{y} - X\\boldsymbol{\\beta}||_2^2 + \\lambda ||\\boldsymbol{\\beta}||_2^2$，其中惩罚参数 $\\lambda > 0$。其解为 $\\hat{\\boldsymbol{\\beta}} = (X^{\\top}X + \\lambda I)^{-1}X^{\\top}\\mathbf{y}$。对于任何 $\\lambda > 0$，矩阵 $(X^{\\top}X + \\lambda I)$ 都是可逆的，从而保证了唯一解。其他方法如 Lasso（L1 正则化）也能产生唯一解，并可以执行特征选择。\n2.  **特征降维：** 减少参数数量 $m$，使得 $m \\leq n$。这可以通过基于先验知识（例如，基于物理知识的特征选择）或自动化技术从最初的35个特征中选择一个子集来完成。\n3.  **数据增广：** 增加观测数量 $n$，使得 $n \\geq m$。这涉及到运行更多的仿真，通常在实验设计（DoE）方法的指导下进行，以确保新的数据点具有最大的信息量，并帮助确保最终的设计矩阵 $X$ 具有满列秩。\n\n现在我们来评估每个选项：\n\n**A. 模型不可辨识，因为 $m>n$ 意味着 $\\operatorname{rank}(X) \\leq n  m$，所以 $\\boldsymbol{\\beta}$ 不能被 $(X,\\mathbf{y})$ 唯一确定。一种补救措施是施加正则化（例如，惩罚参数 $\\lambda>0$ 的岭回归），或通过基于物理知识的特征选择来减少 $m$，和/或通过实验设计增加 $n$ 以达到 $\\operatorname{rank}(X)=m$。**\n该陈述准确地诊断了基于 $n=30$ 和 $m=35$ 之间关系的问题。它正确地得出结论：$m>n$ 导致 $\\operatorname{rank}(X)  m$，从而导致不可辨识性。然后，它正确地列出了针对这种情况的三种标准且合适的补救措施：正则化、减少特征数量 $m$ 和增加观测数量 $n$。所提出的补救措施在数学上是合理的，并且在自动化设计问题的背景下也是合适的。\n**结论：**正确。\n\n**B. 通过包含截距项，模型变得可辨识，因为增加一个常数列可以稳定回归；因此，仅用 $1$ 增广 $\\phi(\\mathbf{x})$ 就可以在不改变 $n$ 的情况下解决问题。**\n问题陈述中有 $m=35$ 个基函数，这通常包括截距项（0次多项式）。如果未包含，添加截距项将使参数数量增加到 $m=36$。这将使问题更加欠定（$n=30, m=36$），从而加剧而非解决可辨识性问题。添加一列不能使矩阵的秩超过 $n=30$。\n**结论：**不正确。\n\n**C. 模型是可辨识的，因为一个3次多项式足够灵活以捕捉电池的物理特性，所以可以无需修改直接进行普通最小二乘法。**\n所选函数形式（3次多项式）的物理相关性或灵活性与参数可辨识性的数学问题无关。可辨识性是由设计矩阵 $X$ 的性质以及 $n$ 和 $m$ 之间的关系决定的。无论模型从物理学角度看多么合适，其 $m=35$ 个参数都无法仅从 $n=30$ 个观测中使用 OLS 进行唯一估计。\n**结论：**不正确。\n\n**D. 如果测量噪声是高斯噪声，则模型是可辨识的，因为高斯噪声意味着最大似然与最小二乘一致，所以可以无需正则化进行拟合。**\n关于误差呈高斯噪声的假设为使用最小二乘成本函数提供了统计学上的理由，因为它等同于最大化数据的似然。然而，这个假设并不能改变底层的线性代数。如果因为 $m>n$ 导致矩阵 $X^{\\top}X$ 是奇异的，似然函数将不会有唯一的最大值。相反，会存在一个参数向量 $\\boldsymbol{\\beta}$ 的子空间，其中所有向量都能达到相同的最大似然，因此估计量仍然不是唯一的。\n**结论：**不正确。\n\n**E. 模型不可辨识仅仅是因为多项式特征之间存在多重共线性；即使在 $m>n$ 的情况下，仅对基进行正交化（例如，通过格拉姆-施密特方法）就能确保可辨识性。**\n当 $m>n$ 时，$X$ 的 $m$ 个列向量位于一个 $n$ 维空间（或其子空间）中，因此它们保证是线性相关的。这是多重共线性的一种极端形式。通过像格拉姆-施密特这样的过程进行正交化，可以为 $X$ 的列空间生成一组正交基，但这个空间的维度至多为 $n=30$。在一个30维空间中找到35个正交向量在数学上是不可能的。正交化不能解决参数数量超过观测数量这个根本问题。\n**结论：**不正确。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "解决了基本的可辨识性问题后，我们还需应对更微妙的数值稳定性挑战。即使数据量充足 ($n \\gg p$)，模型拟合过程仍可能失败或产生不可靠的结果。本练习  提供了一组真实的诊断数据，让你化身“模型侦探”，学习使用条件数、方差膨胀因子等工具，来区分导致多项式回归不稳定的两个常见元凶：不良缩放和多重共线性。",
            "id": "3942011",
            "problem": "在一个自动化的电池设计和仿真工作流中，您正在构建一个关于锂离子电池放电电阻的多元多项式回归代理模型，该模型是设计和材料变量的函数。该代理模型是参数线性的，其基函数包括一个截距项以及输入变量 $x_1, x_2, x_3, x_4$ 中总次数最高为 $2$ 的所有单项式，其中 $x_1$ 是集流体厚度（单位：微米），$x_2$ 是电极孔隙率（无量纲），$x_3$ 是电解质离子电导率（单位：西门子/米），$x_4$ 是比表面积（单位：米的倒数）。您有 $n$ 次仿真实验，其中 $n \\gg p$，$p$ 是设计矩阵 $X \\in \\mathbb{R}^{n \\times p}$ 的列数。从您的拟合流程中报告了以下观测结果：\n\n- $X^{\\top}X$ 的 2-范数条件数约为 $1.2 \\times 10^{16}$。\n- 在对列进行零均值中心化并将每列缩放至单位样本标准差（z-score标准化）后，新格拉姆矩阵的 2-范数条件数降至约 $1.8 \\times 10^{3}$。\n- z-score标准化后各列的经验相关矩阵显示 $|\\rho(x_1, x_1^2)| \\approx 0.98$, $|\\rho(x_1, x_1 x_4)| \\approx 0.97$ 和 $|\\rho(x_4, x_4^2)| \\approx 0.99$。\n- 通过将 z-score 标准化后的设计矩阵中的 $x_1$ 列对所有其他列进行回归计算，其方差膨胀因子约为 $220$；截距项的方差膨胀因子约为 $1$。\n- 重复某些设计点以获得重复实验（不改变唯一设计点的集合）会使 $X^{\\top}X$ 按一个整数因子缩放，但不会实质性地改变其条件数。\n\n假设数据是由从输入到真实响应的一个物理上平滑的映射生成的，并且数值精度为标准双精度。根据线性回归和数值线性代数的基本原理，判断 $X^{\\top}X$ 的近奇异性主要是由多重共线性、不良缩放、两者兼有还是两者皆非引起的，并选择最合适的诊断和修复方法组合。\n\n哪个选项最合适？\n\nA) 问题仅仅是不良缩放。诊断应侧重于比较原始和 z-score 标准化后的条件数，修复方法是重新缩放输入至可比较的量级。不需要其他更改。\n\nB) 同时存在不良缩放和多重共线性。诊断应包括比较 z-score 标准化前后的条件数，检查标准化后各列的相关矩阵或奇异值谱，以及计算方差膨胀因子。修复方法应包括将输入映射到一个公共域（如 $[-1,1]$），进行中心化以减少多项式项之间的相关性，在标准化域上切换到正交多项式基，重新设计实验以减少列之间的对齐（例如，通过空间填充设计或带有轴向点的响应面设计），以及在需要时，在求解正规方程组时应用正则化或截断奇异值分解。\n\nC) 问题仅仅是在构造 $X^{\\top}X$ 时的数值舍入误差。诊断应强调用更高精度重新计算 $X^{\\top}X$。修复方法是使用扩展精度算术或对 $X^{\\top}X$ 进行 Cholesky 分解，而不改变设计或基。\n\nD) 问题是由于截距项列造成了共线性。修复方法是从基中移除截距项；不需要重新缩放或重新设计。\n\nE) 问题是样本量不足。修复方法是在现有设计点增加大量重复运行以降低条件数，而不修改基或输入缩放。",
            "solution": "首先验证问题陈述，以确保其科学上合理、良定且客观。\n\n**步骤 1：提取已知条件**\n- **模型：** 多元多项式回归代理模型。\n- **响应：** 锂离子电池的放电电阻。\n- **输入：** $x_1$ (集流体厚度, $\\mu m$), $x_2$ (电极孔隙率, 无量纲), $x_3$ (电解质离子电导率, S/m), $x_4$ (比表面积, $m^{-1}$)。\n- **基：** 截距项加上 $x_1, x_2, x_3, x_4$ 中总次数最高为 $2$ 的所有单项式。这会产生 $p = 1 + 4 + \\binom{4+2-1}{2} = 1+4+10 = 15$ 个基函数（设计矩阵 $X$ 的列）。基函数为 $1$，$x_i$，$x_i^2$ 和 $x_i x_j$，其中 $i,j \\in \\{1,2,3,4\\}$ 且 $i \\leq j$。\n- **数据：** $n$ 次仿真实验，其中 $n \\gg p$。设计矩阵为 $X \\in \\mathbb{R}^{n \\times p}$。\n- **观测 1：** 格拉姆矩阵的 2-范数条件数 $\\kappa_2(X^{\\top}X)$ 约为 $1.2 \\times 10^{16}$。\n- **观测 2：** 对 $X$ 的列进行 z-score 标准化后，新格拉姆矩阵的条件数降至约 $1.8 \\times 10^3$。\n- **观测 3：** 对于 z-score 标准化后的列，经验相关性很高：$|\\rho(x_1, x_1^2)| \\approx 0.98$, $|\\rho(x_1, x_1 x_4)| \\approx 0.97$ 和 $|\\rho(x_4, x_4^2)| \\approx 0.99$。\n- **观测 4：** z-score 标准化设计矩阵中 $x_1$ 列的方差膨胀因子 (VIF) 约为 $220$。截距项的 VIF 约为 $1$。\n- **观测 5：** 重复设计点会使 $X^{\\top}X$ 按一个整数因子缩放，但不会实质性地改变其条件数。\n- **假设：** 数据由一个平滑的物理映射生成；使用标准双精度算术。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了工程建模中的一项常见任务。它是一个良定问题，提供了能够进行明确诊断的定量数据。语言客观而精确。所有提供的观测结果都与数值线性代数和回归诊断的既定原则相符。\n- 初始条件数 $\\kappa_2(X^{\\top}X) \\approx 1.2 \\times 10^{16}$ 与双精度下的 $1/\\epsilon_m$（$\\epsilon_m \\approx 2.22 \\times 10^{-16}$）在同一数量级，表明存在数值奇异性。这与 $\\kappa_2(X^{\\top}X) = [\\kappa_2(X)]^2$ 一致。\n- 缩放后条件数的大幅下降是 $X$ 各列之间存在不良缩放的典型症状。\n- 缩放后剩余条件数为 $1.8 \\times 10^3$、预测变量之间的高度相关性以及 $220$ 的 VIF 是严重多重共线性的典型症状。$220$ 的 VIF 意味着当该预测变量对所有其他预测变量进行回归时，其 $R^2$ 值为 $1 - 1/220 \\approx 0.995$。\n- 关于重复实验的观测在数学上是正确的：如果通过将 $X$ 堆叠 $k$ 次来形成 $X_{new}$，那么 $X_{new}^{\\top}X_{new} = k X^{\\top}X$。条件数对于标量乘法是不变的，即 $\\kappa(cA) = \\kappa(A)$。\n因此，该问题是有效的。\n\n**推导与评估**\n目标是诊断 $X^{\\top}X$ 近奇异性的原因。我们分析所提供的证据。\n\n1.  **不良缩放：** 格拉姆矩阵的初始条件数为 $\\kappa_2(X^{\\top}X) \\approx 1.2 \\times 10^{16}$。在对设计矩阵 $X$ 的列进行 z-score 标准化（将其均值标准化为 $0$，标准差标准化为 $1$）后，条件数急剧下降至 $\\approx 1.8 \\times 10^3$。这种超过 $13$ 个数量级的显著改善是**不良缩放**是病态问题主要原因的明确证据。$X$ 的原始列（包括像 $x_1$ 和 $x_1^2$ 这样的项）很可能具有截然不同的量级和方差，导致了格拉姆矩阵的缩放不良。\n\n2.  **多重共线性：** 尽管通过缩放得到了显著改善，但新的条件数仍然是 $1.8 \\times 10^3$。虽然鲁棒的求解器可以处理这个值，但它远非理想值 $\\approx 1$，表明缩放后矩阵的列仍然不接近正交。这指向一个遗留问题：**多重共线性**。\n    - 这一诊断由观测 3 直接证实：标准化矩阵中某些列之间的相关系数极高，例如 $|\\rho(x_1, x_1^2)| \\approx 0.98$ 和 $|\\rho(x_4, x_4^2)| \\approx 0.99$。这表明这些预测变量之间存在近乎完美的线性关系。如此高的相关性是多重共线性的一个标志，在多项式回归中很常见，尤其是在对输入变量进行幂运算之前未将其中心化到零附近时。\n    - 观测 4 提供了进一步的证实。预测变量 $x_1$ 的方差膨胀因子 (VIF) 约为 $220$。第 $j$ 个预测变量的 VIF 为 $VIF_j = 1/(1-R_j^2)$，其中 $R_j^2$ 是将第 $j$ 个预测变量对所有其他预测变量进行回归得到的决定系数。$220$ 的 VIF 异常高（通常的经验法则是 VIF 高于 $5$ 或 $10$ 就有问题），这表明设计矩阵中的 $x_1$ 向量非常接近由其他列向量张成的子空间。\n    - 观测 5 正确地排除了仅通过重复实验增加数据点数量就能解决问题的可能性，因为这不会改变 $X$ 的列向量之间的几何关系。\n\n**结论：** 证据明确地表明同时存在严重的**不良缩放**和严重的**多重共线性**。一个恰当的应对措施必须承认并针对这两个问题提出解决方案。\n\n**逐项分析选项**\n\n**A) 问题仅仅是不良缩放。诊断应侧重于比较原始和 z-score 标准化后的条件数，修复方法是重新缩放输入至可比较的量级。不需要其他更改。**\n这个选项正确地识别了不良缩放，但错误地指出这是*唯一*的问题。缩放后 $1.8 \\times 10^3$ 的剩余条件数、$220$ 的 VIF 以及高度相关性都为多重共线性提供了强有力的证据。提议不做进一步更改是错误的。\n**结论：不正确。**\n\n**B) 同时存在不良缩放和多重共线性。诊断应包括比较 z-score 标准化前后的条件数，检查标准化后各列的相关矩阵或奇异值谱，以及计算方差膨胀因子。修复方法应包括将输入映射到一个公共域（如 $[-1,1]$），进行中心化以减少多项式项之间的相关性，在标准化域上切换到正交多项式基，重新设计实验以减少列之间的对齐（例如，通过空间填充设计或带有轴向点的响应面设计），以及在需要时，在求解正规方程组时应用正则化或截断奇异值分解。**\n这个选项正确地识别了不良缩放和多重共线性都是问题所在。它列出了一套全面且正确的诊断方法（条件数、相关性、VIF），与问题数据相符。它还提出了一整套最先进的修复方案，从根本上解决这两个问题：为了缩放和初始中心化，将输入映射到标准化域（如 $[-1,1]$）；使用正交多项式基（例如 Legendre 多项式）来直接对抗多项式项的相关性；改进实验设计以打破预测变量的依赖性；以及在无法更改设计时，使用数值/统计补救措施，如正则化（Ridge/Lasso）或 TSVD。这是一个完整而正确的评估和行动计划。\n**结论：正确。**\n\n**C) 问题仅仅是在构造 $X^{\\top}X$ 时的数值舍入误差。诊断应强调用更高精度重新计算 $X^{\\top}X$。修复方法是使用扩展精度算术或对 $X^{\\top}X$ 进行 Cholesky 分解，而不改变设计或基。**\n极端的病态确实会导致数值舍入误差在标准精度计算中占主导地位。然而，舍入误差是症状，而不是根本原因。根本原因是缩放不良和多重共线性。使用更高精度只会更准确地计算出一个不稳定的解；它无法解决由多重共线性引起的估计系数高方差的统计问题。Cholesky 分解是一种标准的数值方法，但在标准精度下，对于这样一个病态矩阵，它会失败或不准确。这个选项将症状误认为是病因。\n**结论：不正确。**\n\n**D) 问题是由于截距项列造成了共线性。修复方法是从基中移除截距项；不需要重新缩放或重新设计。**\n这在事实上是错误的。观测 4 指出截距项的 VIF 约为 $1$，表明它与其他（中心化后的）预测变量正交。共线性存在于非截距项的多项式项之间。移除截距项通常是错误的，并且可能会引入偏差。\n**结论：不正确。**\n\n**E) 问题是样本量不足。修复方法是在现有设计点增加大量重复运行以降低条件数，而不修改基或输入缩放。**\n这与观测 5 明确矛盾，观测 5 正确地指出增加重复实验不会实质性地改变条件数。问题在于设计点的选择（它们在输入空间中的位置），而不是它们的数量。$n \\gg p$ 的陈述也表明样本量不是限制因素。\n**结论：不正确。**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "在学会诊断模型的不稳定性之后，下一步自然是应用有效的修正方法。多项式回归中多重共线性的一个主要来源是变量与其高次幂（例如 $x$ 和 $x^2$）之间的内在相关性。本练习  将演示一种标准且强大的解决方案：通过基变换，将模型从简单的幂基转换为正交多项式基（如勒让德多项式）。这一技巧能显著改善模型的数值稳定性，从而构建出更稳健、更可靠的代理模型。",
            "id": "3941928",
            "problem": "在自动化电池设计与仿真中，应用代理建模以易于处理的近似方法替代昂贵的多物理场计算。考虑一个用于多孔隔膜中液体电解质有效离子电导率的多项式回归代理模型，记为 $\\kappa_{\\mathrm{eff}}(\\varepsilon)$，其中 $\\varepsilon$ 是隔膜的孔隙率。假设在等温操作和固定盐成分条件下，在物理上允许的孔隙率范围 $\\varepsilon \\in [0.35, 0.55]$ 内，该代理模型由一个3次多项式给出\n$$\n\\kappa_{\\mathrm{eff}}(\\varepsilon) = a_0 + a_1 \\varepsilon + a_2 \\varepsilon^2 + a_3 \\varepsilon^3,\n$$\n其系数已知为 $a_0 = 0.1$，$a_1 = 2.0$，$a_2 = -1.0$ 和 $a_3 = 0.5$。为了便于进行正交基回归和鲁棒的系数解释，标准做法是将物理变量映射到一个标准化域，并用该域上的正交多项式重写代理模型。\n\n将 $\\varepsilon \\in [0.35, 0.55]$ 仿射映射到一个标准化变量 $s \\in [-1, 1]$，并将 $\\kappa_{\\mathrm{eff}}$ 表示为在 $[-1,1]$ 上、以单位权重定义的Legendre多项式 $\\{P_0(s), P_1(s), P_2(s), P_3(s)\\}$ 的3次展开式。即，求出系数 $c_0, c_1, c_2, c_3$，使得\n$$\n\\kappa_{\\mathrm{eff}}(\\varepsilon(s)) = c_0 P_0(s) + c_1 P_1(s) + c_2 P_2(s) + c_3 P_3(s).\n$$\n以 $[c_0 \\; c_1 \\; c_2 \\; c_3]$ 的顺序列出最终系数，四舍五入到六位有效数字，并以西门子/米 (S/m) 为单位表示。最终答案必须是使用指定的 $\\mathrm{pmatrix}$ 环境表示的单行矩阵。",
            "solution": "本题的任务是求出多项式代理模型 $\\kappa_{\\mathrm{eff}}(\\varepsilon)$ 在Legendre多项式 $P_k(s)$ 上的展开系数 $c_0, c_1, c_2, c_3$。原始模型是关于物理变量 $\\varepsilon \\in [0.35, 0.55]$ 的一个3次多项式，必须首先将其映射到标准化变量 $s \\in [-1, 1]$。\n\n首先，我们确定连接 $\\varepsilon$ 和 $s$ 的仿射变换。设此变换为 $\\varepsilon(s) = ms + b$。边界条件为 $\\varepsilon(-1) = 0.35$ 和 $\\varepsilon(1) = 0.55$。这导出了关于参数 $m$ 和 $b$ 的以下线性方程组：\n$$\n\\begin{cases}\n0.35 = -m + b \\\\\n0.55 = m + b\n\\end{cases}\n$$\n两方程相加得到 $0.35 + 0.55 = 2b$，化简为 $0.90 = 2b$，得出 $b = 0.45$。将 $b$ 代入第二个方程得到 $0.55 = m + 0.45$，解得 $m = 0.10$。\n因此，从标准化域到物理域的仿射映射为：\n$$\n\\varepsilon(s) = 0.1s + 0.45\n$$\n\n接下来，我们将 $\\varepsilon$ 的这个表达式代入给定的有效离子电导率多项式 $\\kappa_{\\mathrm{eff}}(\\varepsilon)$。该多项式为：\n$$\n\\kappa_{\\mathrm{eff}}(\\varepsilon) = a_0 + a_1 \\varepsilon + a_2 \\varepsilon^2 + a_3 \\varepsilon^3\n$$\n其系数为 $a_0 = 0.1$，$a_1 = 2.0$，$a_2 = -1.0$ 和 $a_3 = 0.5$。我们将 $\\kappa_{\\mathrm{eff}}$ 表示为 $s$ 的多项式，记作 $K(s) = \\kappa_{\\mathrm{eff}}(\\varepsilon(s))$：\n$$\nK(s) = 0.5(0.1s + 0.45)^3 - 1.0(0.1s + 0.45)^2 + 2.0(0.1s + 0.45) + 0.1\n$$\n为了求出 $K(s)$ 在标准幂基 $\\{1, s, s^2, s^3\\}$ 下的系数，我们展开各项：\n$$\n(0.1s + 0.45)^2 = (0.1)^2s^2 + 2(0.1)(0.45)s + (0.45)^2 = 0.01s^2 + 0.09s + 0.2025\n$$\n$$\n(0.1s + 0.45)^3 = (0.1)^3s^3 + 3(0.1)^2(0.45)s^2 + 3(0.1)(0.45)^2s + (0.45)^3 = 0.001s^3 + 0.0135s^2 + 0.06075s + 0.091125\n$$\n将这些展开式代入 $K(s)$ 的表达式，并按 $s$ 的幂次合并同类项：\n$K(s) = d_3s^3 + d_2s^2 + d_1s + d_0$\n系数 $d_k$ 为：\n$d_3 = 0.5(0.001) = 0.0005$\n$d_2 = 0.5(0.0135) - 1.0(0.01) = 0.00675 - 0.01 = -0.00325$\n$d_1 = 0.5(0.06075) - 1.0(0.09) + 2.0(0.1) = 0.030375 - 0.09 + 0.2 = 0.140375$\n$d_0 = 0.5(0.091125) - 1.0(0.2025) + 2.0(0.45) + 0.1 = 0.0455625 - 0.2025 + 0.9 + 0.1 = 0.8430625$\n所以，关于标准化变量 $s$ 的多项式是：\n$$\nK(s) = 0.0005s^3 - 0.00325s^2 + 0.140375s + 0.8430625\n$$\n\n最后一步是将此多项式从幂基转换到Legendre多项式基。我们希望找到系数 $c_k$ 使得：\n$$\nK(s) = c_0 P_0(s) + c_1 P_1(s) + c_2 P_2(s) + c_3 P_3(s)\n$$\n相关的Legendre多项式是：\n$P_0(s) = 1$\n$P_1(s) = s$\n$P_2(s) = \\frac{1}{2}(3s^2 - 1)$\n$P_3(s) = \\frac{1}{2}(5s^3 - 3s)$\n我们反转这些关系，用Legendre基表示幂基：\n$1 = P_0(s)$\n$s = P_1(s)$\n$s^2 = \\frac{2}{3}P_2(s) + \\frac{1}{3}P_0(s)$\n$s^3 = \\frac{2}{5}P_3(s) + \\frac{3}{5}P_1(s)$\n将这些代入 $K(s)$ 的表达式：\n$$\nK(s) = d_3\\left(\\frac{2}{5}P_3(s) + \\frac{3}{5}P_1(s)\\right) + d_2\\left(\\frac{2}{3}P_2(s) + \\frac{1}{3}P_0(s)\\right) + d_1P_1(s) + d_0P_0(s)\n$$\n合并每个 $P_k(s)$ 的系数，得到所需的系数 $c_k$：\n$c_0 = d_0 + \\frac{1}{3}d_2 = 0.8430625 + \\frac{1}{3}(-0.00325) = 0.8430625 - 0.00108333... = 0.8419791666...$\n$c_1 = d_1 + \\frac{3}{5}d_3 = 0.140375 + \\frac{3}{5}(0.0005) = 0.140375 + 0.0003 = 0.140675$\n$c_2 = \\frac{2}{3}d_2 = \\frac{2}{3}(-0.00325) = -0.00216666...$\n$c_3 = \\frac{2}{5}d_3 = \\frac{2}{5}(0.0005) = 0.0002$\n\n最后，我们按要求将这些值四舍五入到六位有效数字：\n$c_0 \\approx 0.841979$\n$c_1 = 0.140675$\n$c_2 \\approx -0.00216667$\n$c_3 = 0.000200000$\n\n这些系数以上述指定的行矩阵格式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.841979  0.140675  -0.00216667  0.000200000 \\end{pmatrix}}\n$$"
        }
    ]
}