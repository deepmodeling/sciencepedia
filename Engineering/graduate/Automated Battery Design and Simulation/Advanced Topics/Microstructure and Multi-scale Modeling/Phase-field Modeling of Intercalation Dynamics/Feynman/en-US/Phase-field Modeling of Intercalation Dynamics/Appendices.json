{
    "hands_on_practices": [
        {
            "introduction": "This practice delves into the fundamental mechanism driving phase separation in many battery electrode materials: spinodal decomposition. To model these complex dynamics, we must first understand why a uniform concentration can become unstable. By performing a linear stability analysis on the Cahn-Hilliard equation, you will derive the conditions under which small, random fluctuations in concentration will spontaneously grow, leading to the formation of distinct, coexisting phases. This foundational exercise reveals the characteristic length and time scales that govern the emergent patterns of intercalation.",
            "id": "3939955",
            "problem": "Consider a homogeneous intercalation electrode operating under isothermal, open-circuit conditions, modeled with a scalar lithium concentration field $c(\\mathbf{x}, t)$ governed by mass conservation and diffusive transport. Assume constant atomic mobility $M>0$, and approximate the free-energy of mixing with a nonconvex local free-energy density $f(c)$ plus an interfacial gradient penalty with coefficient $\\kappa>0$. The total free energy functional is\n$$\n\\mathcal{F}[c] \\;=\\; \\int_{\\Omega} \\left( f(c) \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla c|^{2} \\right)\\, \\mathrm{d}V,\n$$\nwith the chemical potential given by the variational derivative $\\mu \\equiv \\delta \\mathcal{F}/\\delta c$. The diffusive flux obeys $\\mathbf{J} = - M \\nabla \\mu$, and mass conservation is $\\partial c / \\partial t + \\nabla \\cdot \\mathbf{J} = 0$. Neglect elastic, electrostatic, and finite-size effects, and take $M$ and $\\kappa$ to be spatially uniform constants.\n\nLet $c(\\mathbf{x}, t) = c_{0} + \\delta c(\\mathbf{x}, t)$, where $c_{0}$ is a spatially uniform base state in the spinodal region satisfying $f''(c_{0}) < 0$, and $\\delta c$ is a small perturbation. Perform a Linear Stability Analysis (LSA) about $c_{0}$ using a plane-wave perturbation of the form $\\delta c(\\mathbf{x}, t) = \\epsilon \\exp\\!\\left( \\sigma t + i \\mathbf{k} \\cdot \\mathbf{x} \\right)$ with $0<\\epsilon \\ll 1$ and wavenumber magnitude $k = |\\mathbf{k}|$. Starting only from the stated conservation law, constitutive relations, and free-energy definition, derive the dispersion relation $\\sigma(k)$ and determine the most unstable wavenumber $k_{\\text{max}}$ and corresponding growth rate $\\sigma_{\\text{max}}$ in terms of $M$, $f''(c_{0})$, and $\\kappa$.\n\nExpress the final wavenumber in $\\mathrm{m}^{-1}$ and the final growth rate in $\\mathrm{s}^{-1}$. Provide your final answer as closed-form analytic expressions for $k_{\\text{max}}$ and $\\sigma_{\\text{max}}$ only.",
            "solution": "The fundamental starting point is mass conservation,\n$$\n\\frac{\\partial c}{\\partial t} \\;+\\; \\nabla \\cdot \\mathbf{J} \\;=\\; 0,\n$$\nand the constitutive relation for diffusive transport,\n$$\n\\mathbf{J} \\;=\\; - M \\nabla \\mu,\n$$\nwith a chemical potential $\\mu$ obtained from the free energy functional\n$$\n\\mathcal{F}[c] \\;=\\; \\int_{\\Omega} \\left( f(c) \\;+\\; \\frac{\\kappa}{2} |\\nabla c|^{2} \\right)\\, \\mathrm{d}V.\n$$\nThe variational derivative gives\n$$\n\\mu \\;=\\; \\frac{\\delta \\mathcal{F}}{\\delta c} \\;=\\; f'(c) \\;-\\; \\kappa \\nabla^{2} c,\n$$\nwhere $f'(c)$ denotes the derivative of $f$ with respect to $c$.\n\nCombining mass conservation and the flux law,\n$$\n\\frac{\\partial c}{\\partial t} \\;=\\; - \\nabla \\cdot \\mathbf{J} \\;=\\; \\nabla \\cdot \\left( M \\nabla \\mu \\right) \\;=\\; M \\nabla^{2} \\mu,\n$$\nand substituting the chemical potential,\n$$\n\\frac{\\partial c}{\\partial t} \\;=\\; M \\nabla^{2} \\left( f'(c) \\;-\\; \\kappa \\nabla^{2} c \\right).\n$$\nWe now linearize about the homogeneous base state $c_{0}$ in the spinodal region, writing $c(\\mathbf{x}, t) = c_{0} + \\delta c(\\mathbf{x}, t)$ with $|\\delta c| \\ll 1$. Expanding $f'(c)$ to first order,\n$$\nf'(c) \\;\\approx\\; f'(c_{0}) \\;+\\; f''(c_{0})\\, \\delta c.\n$$\nSince $f'(c_{0})$ is constant, its Laplacian vanishes. The linearized evolution equation for the perturbation becomes\n$$\n\\frac{\\partial\\, \\delta c}{\\partial t} \\;=\\; M \\nabla^{2} \\left( f''(c_{0}) \\, \\delta c \\;-\\; \\kappa \\nabla^{2} \\delta c \\right).\n$$\nAssume a plane-wave form $\\delta c(\\mathbf{x}, t) = \\epsilon \\exp\\!\\left( \\sigma t + i \\mathbf{k} \\cdot \\mathbf{x} \\right)$ with magnitude $k = |\\mathbf{k}|$. Acting with the Laplacian on the plane wave gives $\\nabla^{2} \\delta c = - k^{2} \\delta c$ and $\\nabla^{4} \\delta c = k^{4} \\delta c$. Substituting into the linearized equation yields\n$$\n\\sigma \\, \\delta c \\;=\\; M \\left[ f''(c_{0}) \\, \\nabla^{2} \\delta c \\;-\\; \\kappa \\, \\nabla^{4} \\delta c \\right]\n\\;=\\; M \\left[ f''(c_{0}) \\,(-k^{2}) \\;-\\; \\kappa \\, k^{4} \\right] \\delta c.\n$$\nDividing by $\\delta c \\neq 0$ gives the dispersion relation\n$$\n\\sigma(k) \\;=\\; - M \\left[ f''(c_{0})\\, k^{2} \\;+\\; \\kappa\\, k^{4} \\right] \\;=\\; - M k^{2} \\left[ f''(c_{0}) \\;+\\; \\kappa\\, k^{2} \\right].\n$$\nIn the spinodal region, $f''(c_{0}) < 0$. Define $a \\equiv - f''(c_{0}) > 0$ for convenience. Then\n$$\n\\sigma(k) \\;=\\; M k^{2} \\left[ a \\;-\\; \\kappa\\, k^{2} \\right].\n$$\nThis is positive for $0 < k^{2} < a / \\kappa$ and has a single maximum as a function of $k$. To find the most unstable wavenumber, differentiate $\\sigma(k)$ with respect to $k$ and set the derivative to zero:\n$$\n\\frac{\\mathrm{d} \\sigma}{\\mathrm{d} k} \\;=\\; - M \\left( 2 f''(c_{0})\\, k \\;+\\; 4 \\kappa\\, k^{3} \\right)\n\\;=\\; - 2 M k \\left( f''(c_{0}) \\;+\\; 2 \\kappa\\, k^{2} \\right) \\;=\\; 0.\n$$\nThe nontrivial extremum occurs at\n$$\nf''(c_{0}) \\;+\\; 2 \\kappa\\, k^{2} \\;=\\; 0\n\\quad \\Rightarrow \\quad\nk^{2} \\;=\\; - \\frac{f''(c_{0})}{2 \\kappa}\n\\quad \\Rightarrow \\quad\nk_{\\text{max}} \\;=\\; \\sqrt{ \\frac{ - f''(c_{0}) }{ 2 \\kappa } }.\n$$\nEvaluating the maximal growth rate at this $k_{\\text{max}}$ using the dispersion relation,\n$$\n\\sigma_{\\text{max}} \\;=\\; - M \\left[ f''(c_{0})\\, k_{\\text{max}}^{2} \\;+\\; \\kappa\\, k_{\\text{max}}^{4} \\right]\n\\;=\\; - M \\left[ f''(c_{0}) \\left( - \\frac{ f''(c_{0}) }{ 2 \\kappa } \\right)\n\\;+\\; \\kappa \\left( \\frac{ f''(c_{0})^{2} }{ 4 \\kappa^{2} } \\right) \\right].\n$$\nSimplifying,\n$$\nf''(c_{0}) \\left( - \\frac{ f''(c_{0}) }{ 2 \\kappa } \\right) \\;=\\; - \\frac{ f''(c_{0})^{2} }{ 2 \\kappa },\n\\qquad\n\\kappa \\left( \\frac{ f''(c_{0})^{2} }{ 4 \\kappa^{2} } \\right) \\;=\\; \\frac{ f''(c_{0})^{2} }{ 4 \\kappa },\n$$\nso their sum is $- f''(c_{0})^{2} / (4 \\kappa)$, and therefore\n$$\n\\sigma_{\\text{max}} \\;=\\; M \\, \\frac{ f''(c_{0})^{2} }{ 4 \\kappa }.\n$$\nThus, the most unstable wavenumber and growth rate in the spinodal region are\n$$\nk_{\\text{max}} \\;=\\; \\sqrt{ \\frac{ - f''(c_{0}) }{ 2 \\kappa } },\n\\qquad\n\\sigma_{\\text{max}} \\;=\\; \\frac{ M \\left( f''(c_{0}) \\right)^{2} }{ 4 \\kappa }.\n$$\nBy construction, $k_{\\text{max}}$ carries units of $\\mathrm{m}^{-1}$ and $\\sigma_{\\text{max}}$ carries units of $\\mathrm{s}^{-1}$ when $M$ is the mobility in $\\mathrm{m}^{2} \\mathrm{s}^{-1} \\, \\mathrm{J}^{-1}$, $f''(c_{0})$ has units of $\\mathrm{J}$ per $(\\text{concentration})^{2}$, and $\\kappa$ has units of $\\mathrm{J}\\,\\mathrm{m}^{2}$ per $(\\text{concentration})^{2}$, consistent with the phase-field formulation for intercalation dynamics used in automated battery design and simulation.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\sqrt{\\frac{-\\,f''(c_{0})}{2\\,\\kappa}} & \\frac{M\\,\\left(f''(c_{0})\\right)^{2}}{4\\,\\kappa}\\end{pmatrix}}$$"
        },
        {
            "introduction": "Building upon the analysis of an infinite system, this practice explores the profound impact of physical confinement on phase stability, a critical factor in modern nanoscale battery materials. You will investigate how the finite size of a particle restricts the available modes of instability, which can lead to the complete suppression of phase separation under conditions where a bulk material would readily decompose. This hands-on coding exercise demonstrates how geometric constraints can induce \"pseudo-solid-solution\" behavior, bridging the gap between abstract stability theory and the practical simulation of nanostructured electrodes.",
            "id": "3939983",
            "problem": "You are tasked with formalizing and implementing a linear stability analysis for phase-field modeling of intercalation dynamics in nanoscale battery particles, with the goal of quantifying how finite-size effects truncate spinodal decomposition and thereby induce pseudo-solid-solution behavior. The analysis must be derived from first principles and coded as a complete, runnable program.\n\nAssume a one-dimensional nanoparticle of length $L$ with zero-flux (Neumann) boundary conditions representing a conserved intercalant species. The governing dynamics is the Phase-Field model, specifically the Cahnâ€“Hilliard (CH) equation, with a free-energy functional that combines a homogeneous free energy density for a regular solution and a gradient penalty. The conserved order parameter is the site-fraction $c$ of intercalated species. Use nondimensionalization to express all quantities in dimensionless units. Your derivation and algorithm must start from:\n\n- The CH equation formalism for conserved dynamics and chemical potential derived from the variational derivative of the free-energy functional.\n- A regular-solution model for homogeneous free energy density with entropic mixing and a symmetric interaction parameter.\n- A gradient penalty term that penalizes spatial variations in $c$.\n- Zero-flux boundary conditions appropriate for a closed nanoparticle to determine admissible eigenmodes.\n\nStarting from these bases, derive a linear stability criterion for infinitesimal perturbations around a homogeneous state with site-fraction $c_0$. Use the admissible eigenmodes under Neumann boundary conditions to obtain the discrete set of perturbation wave numbers implied by the finite domain. Explain how the discrete nature of wave numbers in a finite domain truncates the spinodal instability band and can fully suppress phase separation when the smallest admissible mode is stabilized. Define pseudo-solid-solution behavior as the condition where no discrete mode grows exponentially.\n\nYou must implement a program that, for each provided test case, determines whether the finite-size nanoparticle exhibits pseudo-solid-solution behavior (no growing mode) or not (at least one growing mode). Express the final results as a list of boolean values, where $\\text{True}$ indicates pseudo-solid-solution behavior and $\\text{False}$ indicates the presence of at least one growing mode. All quantities are nondimensional and must be treated as such; do not introduce physical units.\n\nTest Suite:\nUse the following parameter sets, each provided as $(L, c_0, \\kappa, \\Omega)$:\n- Case A: $(10.0, 0.5, 0.5, 3.0)$\n- Case B: $(\\pi/2, 0.5, 0.5, 3.0)$\n- Case C: $(1.2, 0.5, 0.5, 3.0)$\n- Case D: $(2.0, 0.2, 0.2, 1.7)$\n- Case E: $(100.0, 0.5, 0.1, 2.0)$\n- Case F: $(100.0, 0.5, 5000.0, 3.0)$\n\nYour algorithm should:\n- Compute the second derivative of the homogeneous free energy density at $c_0$ for the regular solution model.\n- Determine the discrete admissible wave numbers under Neumann boundary conditions for the finite domain of length $L$.\n- Identify whether any admissible mode has a strictly positive growth rate, signaling spinodal decomposition; otherwise, declare pseudo-solid-solution behavior.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, such as $\\text{[True,False,True,False,True,True]}$. The list entries must be boolean values corresponding to the test suite order above, where $\\text{True}$ means pseudo-solid-solution behavior. No other output is permitted. All quantities are nondimensional, so no physical units are required in the output.",
            "solution": "The problem requires a linear stability analysis of the Cahn-Hilliard (CH) model for intercalation in a one-dimensional nanoparticle of length $L$ to determine the conditions for \"pseudo-solid-solution\" behavior. This behavior is defined as the suppression of spinodal decomposition due to finite-size effects. The analysis begins with the fundamental equations of the phase-field model.\n\nThe total free energy, $F$, of the system is described by the Ginzburg-Landau functional, which includes a homogeneous free energy density, $f_{hom}(c)$, and a penalty for concentration gradients:\n$$\nF[c] = \\int_{0}^{L} \\left[ f_{hom}(c) + \\frac{\\kappa}{2} \\left(\\frac{\\partial c}{\\partial x}\\right)^2 \\right] dx\n$$\nHere, $c(x, t)$ is the dimensionless site-fraction of the intercalated species, and $\\kappa$ is the dimensionless gradient energy coefficient. The homogeneous free energy density, $f_{hom}(c)$, for a regular solution is given by:\n$$\nf_{hom}(c) = \\Omega c(1-c) + c \\ln c + (1-c) \\ln(1-c)\n$$\nwhere $\\Omega$ is the dimensionless symmetric interaction parameter, and the logarithmic terms represent the entropy of mixing.\n\nThe dynamics of the conserved order parameter $c$ are governed by the Cahn-Hilliard equation:\n$$\n\\frac{\\partial c}{\\partial t} = \\nabla \\cdot (M \\nabla \\mu)\n$$\nwhere $M$ is mobility (which we set to $M=1$ in our dimensionless system) and $\\mu$ is the chemical potential. The chemical potential is the variational derivative of the free energy functional:\n$$\n\\mu = \\frac{\\delta F}{\\delta c} = \\frac{\\partial f_{hom}}{\\partial c} - \\kappa \\frac{\\partial^2 c}{\\partial x^2}\n$$\nSubstituting $\\mu$ into the CH equation yields the governing partial differential equation in one dimension:\n$$\n\\frac{\\partial c}{\\partial t} = \\frac{\\partial^2}{\\partial x^2} \\left( \\frac{\\partial f_{hom}}{\\partial c} - \\kappa \\frac{\\partial^2 c}{\\partial x^2} \\right)\n$$\nTo analyze stability, we consider an infinitesimal perturbation, $\\delta c(x, t)$, around a homogeneous steady state, $c(x, t) = c_0$:\n$$\nc(x, t) = c_0 + \\delta c(x, t)\n$$\nWe linearize the term $\\frac{\\partial f_{hom}}{\\partial c}$ around $c_0$ using a Taylor expansion:\n$$\n\\frac{\\partial f_{hom}}{\\partial c}(c) \\approx \\frac{\\partial f_{hom}}{\\partial c}\\bigg|_{c_0} + \\frac{\\partial^2 f_{hom}}{\\partial c^2}\\bigg|_{c_0} (c - c_0) = f'_{hom}(c_0) + f''_{hom}(c_0) \\delta c\n$$\nSubstituting this into the CH equation and retaining only terms linear in $\\delta c$, we note that $\\frac{\\partial^2}{\\partial x^2}(f'_{hom}(c_0)) = 0$ as $f'_{hom}(c_0)$ is a constant. The linearized CH equation becomes:\n$$\n\\frac{\\partial (\\delta c)}{\\partial t} = \\frac{\\partial^2}{\\partial x^2} \\left( f''_{hom}(c_0) \\delta c - \\kappa \\frac{\\partial^2 (\\delta c)}{\\partial x^2} \\right)\n$$\nWe seek solutions of the form $\\delta c(x, t) = A_k e^{\\omega(k) t} \\phi_k(x)$, where $\\phi_k(x)$ are the spatial eigenmodes, $k$ is the wave number, and $\\omega(k)$ is the growth rate. Assuming a harmonic form for the eigenmodes, $\\phi_k(x) \\propto e^{ikx}$, such that $\\frac{d^2 \\phi_k}{dx^2} = -k^2 \\phi_k$, the equation simplifies to an expression for the growth rate, known as the dispersion relation:\n$$\n\\omega(k) \\phi_k = (-k^2 f''_{hom}(c_0) - \\kappa k^4) \\phi_k \\implies \\omega(k) = -k^2 \\left( f''_{hom}(c_0) + \\kappa k^2 \\right)\n$$\nA perturbation with wave number $k$ will grow exponentially if its growth rate is positive, $\\omega(k) > 0$. Since $k^2 \\ge 0$, this condition for instability simplifies to:\n$$\nf''_{hom}(c_0) + \\kappa k^2 < 0\n$$\nThe problem specifies a closed particle with zero-flux (Neumann) boundary conditions at $x=0$ and $x=L$. The appropriate eigenfunctions for the Laplacian operator satisfying these boundary conditions are cosines:\n$$\n\\phi_n(x) = \\cos(k_n x), \\quad \\text{with} \\quad k_n = \\frac{n\\pi}{L}, \\quad n = 0, 1, 2, \\dots\n$$\nThe wave numbers are thus quantized. The mode $n=0$ corresponds to $k_0=0$, a spatially uniform perturbation. This mode has $\\omega(0)=0$ and is related to conservation of mass, not phase separation. It is therefore excluded from the stability analysis. The physically relevant modes for instability are those with $n \\ge 1$.\n\nPseudo-solid-solution behavior occurs if and only if all admissible modes are stable, meaning $\\omega(k_n) \\le 0$ for all $n \\ge 1$. This is equivalent to requiring $f''_{hom}(c_0) + \\kappa k_n^2 \\ge 0$ for all $n \\ge 1$. The term $\\kappa k_n^2 = \\kappa (\\frac{n\\pi}{L})^2$ is a monotonically increasing function of $n$. Therefore, the stability of the entire system is determined by the most susceptible mode, which is the one with the smallest non-zero wave number, $k_1 = \\pi/L$. If this mode is stable, all other modes with larger $n$ (and thus larger $k_n$) will also be stable.\n\nThe criterion for pseudo-solid-solution behavior is thus:\n$$\nf''_{hom}(c_0) + \\kappa k_1^2 \\ge 0 \\quad \\implies \\quad f''_{hom}(c_0) + \\kappa \\left(\\frac{\\pi}{L}\\right)^2 \\ge 0\n$$\nTo evaluate this, we compute the second derivative of the homogeneous free energy density:\n$$\nf'_{hom}(c) = \\frac{d}{dc} \\left( \\Omega c(1-c) + c \\ln c + (1-c) \\ln(1-c) \\right) = \\Omega(1-2c) + \\ln c - \\ln(1-c)\n$$\n$$\nf''_{hom}(c) = \\frac{d^2}{dc^2} f_{hom}(c) = -2\\Omega + \\frac{1}{c} + \\frac{1}{1-c} = \\frac{1}{c(1-c)} - 2\\Omega\n$$\nThe final condition to be algorithmically tested for each parameter set $(L, c_0, \\kappa, \\Omega)$ is whether the following inequality holds:\n$$\n\\left( \\frac{1}{c_0(1-c_0)} - 2\\Omega \\right) + \\kappa \\left( \\frac{\\pi}{L} \\right)^2 \\ge 0\n$$\nIf the inequality is true, the system exhibits pseudo-solid-solution behavior; otherwise, it is unstable to spinodal decomposition.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a linear stability analysis for phase-field modeling of intercalation \n    dynamics in a finite-size 1D domain to determine pseudo-solid-solution behavior.\n\n    The analysis is based on the Cahn-Hilliard equation with a regular solution\n    free energy model. Pseudo-solid-solution behavior occurs when finite-size\n    effects stabilize the system against spinodal decomposition, meaning all\n    admissible perturbation modes have a non-positive growth rate.\n\n    The stability criterion for a system of length L is:\n    f_hom''(c0) + kappa * (pi / L)^2 >= 0\n    where f_hom''(c0) is the second derivative of the homogeneous free energy\n    density evaluated at the average concentration c0, and kappa is the\n    gradient energy coefficient.\n    \n    For a regular solution model, f_hom''(c0) = 1/(c0*(1-c0)) - 2*Omega.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L, c0, kappa, Omega)\n    test_cases = [\n        (10.0, 0.5, 0.5, 3.0),   # Case A\n        (np.pi / 2, 0.5, 0.5, 3.0), # Case B\n        (1.2, 0.5, 0.5, 3.0),    # Case C\n        (2.0, 0.2, 0.2, 1.7),    # Case D\n        (100.0, 0.5, 0.1, 2.0),  # Case E\n        (100.0, 0.5, 5000.0, 3.0) # Case F\n    ]\n\n    results = []\n    for case in test_cases:\n        L, c0, kappa, Omega = case\n\n        # Calculate the second derivative of the homogeneous free energy density.\n        # This term represents the bulk driving force for phase separation.\n        # A negative value indicates the bulk material is unstable.\n        # We must handle the case c0=0 or c0=1, though not present in test cases.\n        if c0 <= 0 or c0 >= 1:\n            # The free energy model is not defined at these concentrations.\n            # In a physical context, this means the system is unconditionally stable\n            # as phase separation is impossible. For the purpose of this problem,\n            # we can assume this scenario is not tested.\n            # For robustness, we could treat it as stable.\n            # However, we will assume 0 < c0 < 1 as per the model.\n            pass\n        \n        f_hom_double_prime = 1.0 / (c0 * (1.0 - c0)) - 2.0 * Omega\n\n        # Calculate the square of the smallest non-zero wave number (k_1)^2.\n        # This represents the longest wavelength perturbation possible in the\n        # finite domain of length L with zero-flux boundary conditions.\n        k1_squared = (np.pi / L)**2\n\n        # Evaluate the stability criterion for the n=1 mode.\n        # The system is stable if this term is non-negative, as all higher modes\n        # (n > 1) will be even more stable.\n        stability_value = f_hom_double_prime + kappa * k1_squared\n\n        # If stability_value >= 0, the system exhibits pseudo-solid-solution\n        # behavior (True). Otherwise, at least one mode is unstable (False).\n        is_stable = stability_value >= 0.0\n        results.append(is_stable)\n\n    # Final print statement in the exact required format.\n    # The format is a comma-separated list of booleans enclosed in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond bulk thermodynamics and geometric confinement, the physics of the particle surface plays a crucial role in determining overall behavior. This practice introduces surface wetting energy into the grand potential functional, demonstrating how interfacial physics can break the inherent symmetry of the system and create a preference for one phase to form at the boundary. By deriving the natural boundary conditions from first principles, you will quantify how this surface effect modifies the local equilibrium and shifts the chemical potential required for phase coexistence, a key concept in understanding nucleation and surface-driven phenomena.",
            "id": "3939986",
            "problem": "Consider a one-dimensional domain of length $L$ with coordinate $x \\in [0,L]$ representing an intercalation host material where a normalized concentration field $c(x)$ ($0 \\leq c \\leq 1$) describes the fraction of intercalated species. In a phase-field model based on the Cahn-Hilliard (CH) framework, the nondimensional grand potential functional is\n$$\n\\Omega[c] = \\int_{0}^{L} \\left( f(c) + \\frac{\\kappa}{2} \\left(\\frac{dc}{dx}\\right)^2 - \\mu\\,c \\right) dx \\;+\\; \\gamma\\!\\left(c(0)\\right) \\;+\\; \\gamma\\!\\left(c(L)\\right),\n$$\nwhere $f(c)$ is a symmetric double-well bulk free-energy density, $\\kappa$ is a positive gradient-energy coefficient, and $\\mu$ is a spatially uniform nondimensional chemical potential representing an imposed reservoir. Let $f(c)$ be given by\n$$\nf(c) = W\\,c^2 (1-c)^2,\n$$\nwith $W>0$ a nondimensional barrier height. Let the surface wetting energy be quadratic in the surface composition:\n$$\n\\gamma(c) = h\\,\\left(c - c_{\\mathrm{pref}}\\right)^2,\n$$\nwith $h \\ge 0$ a nondimensional wetting strength and $c_{\\mathrm{pref}} \\in [0,1]$ the surface-preferred composition. All quantities are nondimensional.\n\nTask A (derivation): Starting from the grand potential functional and the calculus of variations, derive the Euler-Lagrange condition governing stationary profiles $c(x)$ and the natural boundary conditions at $x=0$ and $x=L$ that arise due to the presence of the surface term $\\gamma(c)$. Explain from first principles how the wetting energy term can break the $c \\leftrightarrow 1-c$ symmetry at the boundaries and thereby favor one phase locally.\n\nTask B (coexistence shift): Consider uniform pure-phase states $c(x) \\equiv 0$ and $c(x) \\equiv 1$ on $[0,L]$. Using only the definitions and laws in the context above, determine the coexistence chemical potential shift $\\mu_\\star$ at which the total grand potentials of these two uniform states are equal. Your derivation must express $\\mu_\\star$ as a function of $L$, $h$, and $c_{\\mathrm{pref}}$ only. Briefly justify why, in the limit of large $L$ and small boundary layers, the gradient term does not alter the leading-order dependence of $\\mu_\\star$ on $L$, $h$, and $c_{\\mathrm{pref}}$.\n\nProgramming Task: Write a program that, for a given set of test cases, computes the coexistence chemical potential shift $\\mu_\\star$ and, for the special case $\\mu=0$, outputs which uniform phase minimizes $\\Omega$ (choose $c\\equiv 1$ if its total grand potential is strictly lower than $c\\equiv 0$, otherwise choose $c\\equiv 0$). The program should use the nondimensional formulations above, and for each test case output a list containing $[\\mu_\\star, \\text{phase}]$ where phase is $1$ for $c\\equiv 1$ and $0$ for $c\\equiv 0$.\n\nTest Suite:\n- Case $1$: $L = 1$, $h = 0.2$, $c_{\\mathrm{pref}} = 1$.\n- Case $2$: $L = 10$, $h = 0.2$, $c_{\\mathrm{pref}} = 1$.\n- Case $3$: $L = 1$, $h = 0$, $c_{\\mathrm{pref}} = 1$.\n- Case $4$: $L = 1$, $h = 0.2$, $c_{\\mathrm{pref}} = 0.5$.\n\nAnswer specification:\n- For each test case, compute the nondimensional $\\mu_\\star$ and the minimizing phase at $\\mu=0$ following Task B.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a two-element list in the form $[\\mu_\\star,\\text{phase}]$. Example format: $[[a,b],[c,d],[e,f],[g,h]]$.",
            "solution": "The solution is presented in three parts, corresponding to the tasks outlined in the problem.\n\n**Task A: Derivation of Governing Equations**\n\nThe analysis begins with the nondimensional grand potential functional $\\Omega[c]$ for a one-dimensional concentration field $c(x)$ on the domain $x \\in [0,L]$:\n$$\n\\Omega[c] = \\int_{0}^{L} \\left( f(c) + \\frac{\\kappa}{2} \\left(\\frac{dc}{dx}\\right)^2 - \\mu\\,c \\right) dx \\;+\\; \\gamma\\!\\left(c(0)\\right) \\;+\\; \\gamma\\!\\left(c(L)\\right)\n$$\nTo find the stationary profiles $c(x)$ that minimize this functional, we employ the calculus of variations. We consider an arbitrary, infinitesimal variation $\\delta c(x)$ around a stationary profile $c(x)$. The first variation of the functional, $\\delta \\Omega$, must be zero. Let the integrand be denoted as $\\mathcal{L}(c, c')$, where $c' = \\frac{dc}{dx}$.\n$$\n\\mathcal{L}\\left(c, \\frac{dc}{dx}\\right) = f(c) + \\frac{\\kappa}{2} \\left(\\frac{dc}{dx}\\right)^2 - \\mu\\,c\n$$\nThe first variation $\\delta\\Omega$ is calculated as:\n$$\n\\delta \\Omega = \\int_{0}^{L} \\left( \\frac{\\partial \\mathcal{L}}{\\partial c}\\delta c + \\frac{\\partial \\mathcal{L}}{\\partial c'}\\delta c' \\right) dx + \\frac{d\\gamma}{dc}(c(0)) \\delta c(0) + \\frac{d\\gamma}{dc}(c(L)) \\delta c(L) = 0\n$$\nThe partial derivatives of $\\mathcal{L}$ are:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial c} = \\frac{df}{dc} - \\mu\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial c'} = \\kappa \\frac{dc}{dx}\n$$\nSubstituting these into the variation and noting that $\\delta c' = \\frac{d}{dx}(\\delta c)$:\n$$\n\\delta \\Omega = \\int_{0}^{L} \\left( \\left(\\frac{df}{dc} - \\mu\\right)\\delta c + \\left(\\kappa \\frac{dc}{dx}\\right) \\frac{d}{dx}(\\delta c) \\right) dx + \\gamma'(c(0)) \\delta c(0) + \\gamma'(c(L)) \\delta c(L)\n$$\nWe apply integration by parts to the term involving $\\frac{d}{dx}(\\delta c)$:\n$$\n\\int_{0}^{L} \\left(\\kappa \\frac{dc}{dx}\\right) \\frac{d}{dx}(\\delta c) dx = \\left[\\kappa \\frac{dc}{dx} \\delta c\\right]_{0}^{L} - \\int_{0}^{L} \\frac{d}{dx}\\left(\\kappa \\frac{dc}{dx}\\right) \\delta c \\, dx\n$$\nSubstituting this back into the expression for $\\delta \\Omega$:\n$$\n\\delta \\Omega = \\int_{0}^{L} \\left(\\frac{df}{dc} - \\mu - \\kappa \\frac{d^2c}{dx^2}\\right) \\delta c \\, dx + \\left[\\kappa \\frac{dc}{dx} \\delta c\\right]_{0}^{L} + \\gamma'(c(0)) \\delta c(0) + \\gamma'(c(L)) \\delta c(L)\n$$\nExpanding the boundary terms and collecting them:\n$$\n\\delta \\Omega = \\int_{0}^{L} \\left(\\frac{df}{dc} - \\mu - \\kappa \\frac{d^2c}{dx^2}\\right) \\delta c \\, dx + \\left(\\kappa \\frac{dc}{dx}(L) + \\gamma'(c(L))\\right) \\delta c(L) + \\left(-\\kappa \\frac{dc}{dx}(0) + \\gamma'(c(0))\\right) \\delta c(0)\n$$\nFor $\\delta \\Omega$ to be zero for any arbitrary variation $\\delta c(x)$, the coefficient of $\\delta c$ in the integral (the bulk) and the coefficients of the independent variations at the boundaries ($\\delta c(0)$ and $\\delta c(L)$) must all be zero.\n\nThis yields the Euler-Lagrange equation for the domain $x \\in (0, L)$:\n$$\n\\kappa \\frac{d^2c}{dx^2} = \\frac{df}{dc} - \\mu\n$$\nAnd it yields the natural boundary conditions at $x=0$ and $x=L$:\n$$\n\\text{At } x=0: \\quad \\kappa \\frac{dc}{dx}(0) = \\gamma'(c(0))\n$$\n$$\n\\text{At } x=L: \\quad -\\kappa \\frac{dc}{dx}(L) = \\gamma'(c(L))\n$$\nUsing the specific form $\\gamma(c) = h(c-c_{\\mathrm{pref}})^2$, we have $\\gamma'(c) = 2h(c-c_{\\mathrm{pref}})$. The boundary conditions become:\n$$\n\\kappa \\frac{dc}{dx}(0) = 2h(c(0) - c_{\\mathrm{pref}})\n$$\n$$\n\\kappa \\frac{dc}{dx}(L) = -2h(c(L) - c_{\\mathrm{pref}})\n$$\nThese equations govern the stationary profiles of the concentration field.\n\nThe bulk free-energy density $f(c) = Wc^2(1-c)^2$ is symmetric under the transformation $c \\leftrightarrow 1-c$, as $f(1-c) = W(1-c)^2(1-(1-c))^2 = W(1-c)^2c^2 = f(c)$. This symmetry implies that the two phases, $c=0$ and $c=1$, are energetically equivalent in the bulk at a chemical potential of $\\mu=0$. However, the surface energy term $\\gamma(c)=h(c-c_{\\mathrm{pref}})^2$ breaks this symmetry unless $c_{\\mathrm{pref}}=0.5$. To see this, compare $\\gamma(c)$ and $\\gamma(1-c)$:\n$$\n\\gamma(1-c) = h(1-c-c_{\\mathrm{pref}})^2\n$$\nFor symmetry, we require $\\gamma(c) = \\gamma(1-c)$, which means $(c-c_{\\mathrm{pref}})^2 = (1-c-c_{\\mathrm{pref}})^2$. Taking the square root gives $|c-c_{\\mathrm{pref}}| = |1-c-c_{\\mathrm{pref}}|$. For this to hold for all $c \\in [0,1]$, the arguments must be equal in magnitude. If $c-c_{\\mathrm{pref}} = -(1-c-c_{\\mathrm{pref}})$, this leads to $c-c_{\\mathrm{pref}} = -1+c+c_{\\mathrm{pref}}$, which implies $2c_{\\mathrm{pref}}=1$, or $c_{\\mathrm{pref}}=0.5$. If $c_{\\mathrm{pref}} \\neq 0.5$, the symmetry is broken. For example, if $c_{\\mathrm{pref}}=1$, then $\\gamma(c) = h(c-1)^2$. The surface energy is minimized at $c=1$ (value is $0$) and maximized at $c=0$ (value is $h$). This energetic preference for the $c=1$ phase at the boundary will favor that phase locally, potentially nucleating it even when the bulk might favor the $c=0$ phase.\n\n**Task B: Coexistence Chemical Potential Shift**\n\nWe are asked to find the chemical potential $\\mu_\\star$ at which the total grand potentials of the uniform pure-phase states, $c(x) \\equiv 0$ and $c(x) \\equiv 1$, are equal. For a uniform state $c(x) \\equiv c_0$, the gradient term $\\frac{dc}{dx}$ is zero everywhere. The grand potential functional simplifies to:\n$$\n\\Omega[c_0] = \\int_{0}^{L} (f(c_0) - \\mu c_0) \\, dx + 2\\gamma(c_0) = L(f(c_0) - \\mu c_0) + 2\\gamma(c_0)\n$$\nWe evaluate this for the two states of interest. The bulk free energy at the pure phases is $f(0) = W(0)^2(1-0)^2 = 0$ and $f(1) = W(1)^2(1-1)^2 = 0$.\n\nFor state $1$ ($c(x) \\equiv 0$):\n$$\n\\Omega[0] = L(f(0) - \\mu \\cdot 0) + 2\\gamma(0) = 0 + 2h(0 - c_{\\mathrm{pref}})^2 = 2h c_{\\mathrm{pref}}^2\n$$\nFor state $2$ ($c(x) \\equiv 1$):\n$$\n\\Omega[1] = L(f(1) - \\mu \\cdot 1) + 2\\gamma(1) = L(0 - \\mu) + 2h(1 - c_{\\mathrm{pref}})^2 = -L\\mu + 2h(1-c_{\\mathrm{pref}})^2\n$$\nCoexistence occurs when $\\Omega[0] = \\Omega[1]$ at a specific chemical potential $\\mu=\\mu_\\star$:\n$$\n2h c_{\\mathrm{pref}}^2 = -L\\mu_\\star + 2h(1-c_{\\mathrm{pref}})^2\n$$\nSolving for $\\mu_\\star$:\n$$\nL\\mu_\\star = 2h(1-c_{\\mathrm{pref}})^2 - 2h c_{\\mathrm{pref}}^2 = 2h \\left((1-2c_{\\mathrm{pref}}+c_{\\mathrm{pref}}^2) - c_{\\mathrm{pref}}^2\\right) = 2h(1-2c_{\\mathrm{pref}})\n$$\n$$\n\\mu_\\star = \\frac{2h}{L}(1 - 2c_{\\mathrm{pref}})\n$$\nThis expression depends only on $L$, $h$, and $c_{\\mathrm{pref}}$, as required.\n\nThe gradient term is justifiably excluded because, in comparing two perfectly uniform states, the gradient $dc/dx$ is identically zero for both, making the gradient energy contribution zero by definition. In a more realistic scenario where states have boundary layers, the gradient energy is confined to these layers of a characteristic width independent of $L$. The resulting energy contribution is thus an $O(1)$ term with respect to $L$. The dominant balance for large $L$ is between the bulk term $-L\\mu c$ (order $O(L)$) and the surface energy terms $2\\gamma(c)$ (order $O(1)$). Our calculation captures this leading-order balance, revealing that the shift in chemical potential $\\mu_\\star$ required to offset the surface energy preference scales as $1/L$.\n\n**Programming Task: Algorithmic Logic**\n\nThe program must compute two quantities for each test case: the coexistence chemical potential shift $\\mu_\\star$ and the preferred uniform phase at $\\mu=0$.\n\n1.  **Calculation of $\\mu_\\star$**: This is directly computed using the derived formula:\n    $$\n    \\mu_\\star = \\frac{2h}{L}(1 - 2c_{\\mathrm{pref}})\n    $$\n\n2.  **Determination of Preferred Phase at $\\mu=0$**: We need to determine which uniform phase, $c \\equiv 0$ or $c \\equiv 1$, has a lower total grand potential when $\\mu=0$. The condition given is to choose phase $1$ if $\\Omega[1]$ is strictly lower than $\\Omega[0]$, otherwise choose phase $0$.\n    At $\\mu=0$:\n    $$\n    \\Omega[0]_{\\mu=0} = 2h c_{\\mathrm{pref}}^2\n    $$\n    $$\n    \\Omega[1]_{\\mu=0} = 2h(1 - c_{\\mathrm{pref}})^2\n    $$\n    The condition for choosing phase $1$ is $\\Omega[1]_{\\mu=0} < \\Omega[0]_{\\mu=0}$:\n    $$\n    2h(1 - c_{\\mathrm{pref}})^2 < 2h c_{\\mathrm{pref}}^2\n    $$\n    If $h > 0$, we can divide by $2h$:\n    $$\n    (1 - c_{\\mathrm{pref}})^2 < c_{\\mathrm{pref}}^2\n    $$\n    Since $c_{\\mathrm{pref}} \\in [0,1]$, both $1-c_{\\mathrm{pref}}$ and $c_{\\mathrm{pref}}$ are non-negative, so we can take the square root of both sides:\n    $$\n    1 - c_{\\mathrm{pref}} < c_{\\mathrm{pref}} \\implies 1 < 2c_{\\mathrm{pref}} \\implies c_{\\mathrm{pref}} > 0.5\n    $$\n    If $h=0$ or if $c_{\\mathrm{pref}} \\le 0.5$, the condition is not met (including the case of equality where the choice is specified to be phase $0$). Therefore, the logic is:\n    - The preferred phase is $1$ if $h>0$ AND $c_{\\mathrm{pref}} > 0.5$.\n    - The preferred phase is $0$ in all other cases.\nThe program will implement this logic for each test case provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the coexistence chemical potential shift and the preferred uniform phase\n    at mu=0 for a set of test cases based on a 1D phase-field model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L, h, c_pref)\n    test_cases = [\n        (1.0, 0.2, 1.0),   # Case 1: L=1, h=0.2, c_pref=1\n        (10.0, 0.2, 1.0),  # Case 2: L=10, h=0.2, c_pref=1\n        (1.0, 0.0, 1.0),   # Case 3: L=1, h=0, c_pref=1\n        (1.0, 0.2, 0.5),   # Case 4: L=1, h=0.2, c_pref=0.5\n    ]\n\n    results = []\n    for L, h, c_pref in test_cases:\n        # Task B: Compute the coexistence chemical potential shift mu_star.\n        # mu_star = (2*h/L) * (1 - 2*c_pref)\n        mu_star = (2.0 * h / L) * (1.0 - 2.0 * c_pref)\n\n        # Determine the minimizing uniform phase (0 or 1) when mu = 0.\n        # The preferred phase is c=1 if its grand potential Omega[1] is strictly\n        # lower than Omega[0]. Otherwise, the preferred phase is c=0.\n        # Omega[1] < Omega[0] at mu=0 implies:\n        # 2*h*(1-c_pref)**2 < 2*h*c_pref**2\n        # If h > 0, this simplifies to (1-c_pref)**2 < c_pref**2.\n        # Since c_pref is in [0,1], 1-c_pref >= 0, so we can take the square root:\n        # 1 - c_pref < c_pref  =>  1 < 2*c_pref  =>  c_pref > 0.5\n        # If h=0 or c_pref <= 0.5, the condition is not met, so phase is 0.\n        if h > 0 and c_pref > 0.5:\n            phase = 1\n        else:\n            phase = 0\n        \n        results.append([mu_star, phase])\n\n    # Format the final output string exactly as specified.\n    # Example: [[a,b],[c,d],[e,f],[g,h]]\n    sub_results_str = [f\"[{res[0]},{res[1]}]\" for res in results]\n    final_output = f\"[{','.join(sub_results_str)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}