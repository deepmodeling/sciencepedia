{
    "hands_on_practices": [
        {
            "introduction": "地热系统建模始于对岩石-流体基质中热量储存和传输基本物理过程的理解。本练习将引导您从微观属性出发，推导出宏观的热扩散方程，并引入有效体积热容和有效导热系数这两个关键概念。这个练习是建立任何地热储层预测模型的基础，它将物理原理与宏观参数联系起来，这些参数是所有后续模拟的基石 。",
            "id": "4093781",
            "problem": "一个厚度为 $L$ 的横向广阔地热储层被模拟为一个由岩石基质和单相含水盐水组成的均匀、各向同性、完全饱和的多孔介质。假设没有整体流体运动（无平流），且热传输以传导为主。考虑一个处于局部热平衡 (LTE) 状态下的代表性单元体积 (REV)，这意味着岩石和流体共享一个共同的温度 $T(\\mathbf{x},t)$。从该REV的能量守恒定律和傅里叶热传导定律出发，推导以有效体积热容和有效导热系数表示的控制性热方程。由此，求出热扩散系数 $\\alpha$ 以及穿过储层厚度的传导时间尺度。\n\n对该饱和多孔介质使用以下物理上一致的性质：\n- 孔隙度: $\\phi = 0.15$。\n- 岩石密度和比热容: $\\rho_{r} = 2650\\ \\mathrm{kg/m^{3}}$, $c_{p,r} = 900\\ \\mathrm{J/(kg\\cdot K)}$。\n- 岩石导热系数: $k_{r} = 2.5\\ \\mathrm{W/(m\\cdot K)}$。\n- 流体密度和比热容（储层条件下的盐水）: $\\rho_{f} = 950\\ \\mathrm{kg/m^{3}}$, $c_{p,f} = 4200\\ \\mathrm{J/(kg\\cdot K)}$。\n- 流体导热系数: $k_{f} = 0.65\\ \\mathrm{W/(m\\cdot K)}$。\n- 储层厚度: $L = 20\\ \\mathrm{m}$。\n\n将REV中的传导热通量建模为通过岩石骨架和孔隙流体的两个平行路径，它们分别占据横截面积的 $(1-\\phi)$ 和 $\\phi$ 部分。在这些假设下，通过首先推导有效体积热容和有效导热系数，然后是热扩散系数 $\\alpha$，最后是时间尺度 $t_{d}$，来估算穿过厚度 $L$ 的热扩散时间尺度 $t_{d}$。将最终的时间尺度四舍五入到四位有效数字，并以秒为单位表示。",
            "solution": "合适的出发点是在局部热平衡 (LTE) 条件下、无平流且无内部热源的饱和多孔介质在代表性单元体积 (REV) 尺度上的能量守恒。将共同的温度场表示为 $T(\\mathbf{x},t)$。REV中每单位体积储存的总显热是来自岩石和流体的贡献之和。该储存热的变化率等于传导热通量的净散度。\n\n每单位体积的储存项为\n$$\n(1-\\phi)\\,\\rho_{r}\\,c_{p,r}\\,\\frac{\\partial T}{\\partial t} \\;+\\; \\phi\\,\\rho_{f}\\,c_{p,f}\\,\\frac{\\partial T}{\\partial t}.\n$$\n这启发我们将有效体积热容（多孔介质单位体积的热容）定义为\n$$\nC_{\\mathrm{eff}} \\equiv (1-\\phi)\\,\\rho_{r}\\,c_{p,r} + \\phi\\,\\rho_{f}\\,c_{p,f}.\n$$\nREV内的传导热通量是通过岩石骨架和孔隙流体的通量之和，每个通量都遵循傅里叶定律。如果我们将两相理想化为占据横截面积 $(1-\\phi)$ 和 $\\phi$ 部分的平行传导路径，则总通量为\n$$\n\\mathbf{q} = (1-\\phi)\\,\\mathbf{q}_{r} + \\phi\\,\\mathbf{q}_{f}\n= -(1-\\phi)\\,k_{r}\\,\\nabla T \\;-\\; \\phi\\,k_{f}\\,\\nabla T\n= -\\big[(1-\\phi)\\,k_{r} + \\phi\\,k_{f}\\big]\\,\\nabla T.\n$$\n这启发我们将有效导热系数定义为\n$$\nk_{\\mathrm{eff}} \\equiv (1-\\phi)\\,k_{r} + \\phi\\,k_{f}.\n$$\n于是，能量守恒（无源）方程为\n$$\nC_{\\mathrm{eff}}\\,\\frac{\\partial T}{\\partial t} = \\nabla \\cdot \\left(k_{\\mathrm{eff}}\\,\\nabla T\\right).\n$$\n假设 $C_{\\mathrm{eff}}$ 和 $k_{\\mathrm{eff}}$ 在空间上是均匀的，方程右侧简化为 $k_{\\mathrm{eff}}\\,\\nabla^{2}T$，得到经典的扩散方程\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha\\,\\nabla^{2}T,\\qquad \\alpha \\equiv \\frac{k_{\\mathrm{eff}}}{C_{\\mathrm{eff}}}.\n$$\n穿过长度 $L$ 的特征传导时间尺度的一个标准估算为\n$$\nt_{d} \\sim \\frac{L^{2}}{\\alpha} = \\frac{L^{2}\\,C_{\\mathrm{eff}}}{k_{\\mathrm{eff}}}.\n$$\n\n我们现在根据所提供的数据计算所需的量。首先，有效体积热容：\n$$\nC_{\\mathrm{eff}} = (1-\\phi)\\,\\rho_{r}\\,c_{p,r} + \\phi\\,\\rho_{f}\\,c_{p,f}\n= (1-0.15)\\times 2650\\times 900 + 0.15\\times 950\\times 4200.\n$$\n分别计算各项：\n- 岩石贡献： $(1-0.15)\\times 2650\\times 900 = 0.85\\times 2{,}385{,}000 = 2{,}027{,}250$。\n- 流体贡献： $0.15\\times 950\\times 4200 = 0.15\\times 3{,}990{,}000 = 598{,}500$。\n总和：\n$$\nC_{\\mathrm{eff}} = 2{,}027{,}250 + 598{,}500 = 2{,}625{,}750\\ \\mathrm{J/(m^{3}\\cdot K)}.\n$$\n\n接下来，有效导热系数：\n$$\nk_{\\mathrm{eff}} = (1-\\phi)\\,k_{r} + \\phi\\,k_{f}\n= 0.85\\times 2.5 + 0.15\\times 0.65\n= 2.125 + 0.0975 = 2.2225\\ \\mathrm{W/(m\\cdot K)}.\n$$\n\n热扩散系数为\n$$\n\\alpha = \\frac{k_{\\mathrm{eff}}}{C_{\\mathrm{eff}}}\n= \\frac{2.2225}{2{,}625{,}750}\\ \\mathrm{m^{2}/s}\n\\approx 8.46486\\times 10^{-7}\\ \\mathrm{m^{2}/s}.\n$$\n\n最后，穿过储层厚度 $L=20\\ \\mathrm{m}$ 的传导时间尺度为\n$$\nt_{d} = \\frac{L^{2}}{\\alpha} = \\frac{(20)^{2}}{8.46486\\times 10^{-7}}\\ \\mathrm{s}\n= \\frac{400}{8.46486\\times 10^{-7}}\\ \\mathrm{s}\n= \\frac{400\\times 2{,}625{,}750}{2.2225}\\ \\mathrm{s}\n= \\frac{1{,}050{,}300{,}000}{2.2225}\\ \\mathrm{s}\n\\approx 4.72576\\times 10^{8}\\ \\mathrm{s}.\n$$\n四舍五入到四位有效数字并以秒为单位表示，传导时间尺度为\n$$\nt_{d} \\approx 4.726\\times 10^{8}\\ \\mathrm{s}.\n$$",
            "answer": "$$\\boxed{4.726 \\times 10^{8}}$$"
        },
        {
            "introduction": "在建立控制物理方程之后，下一步便是进行数值求解。本练习通过分析对流-扩散方程常用显式有限差分格式的稳定性，探讨了数值模拟所面临的挑战。掌握这一概念对于开发可靠、高效的模拟器以及正确解读模拟结果至关重要，因为它揭示了计算时间步长、空间网格和物理参数之间存在的内在联系 。",
            "id": "4093819",
            "problem": "一个一维地热储层段由温度 $T(x,t)$ 的线性能量输运方程建模，该方程结合了流体运动引起的平流和饱和岩石中的热扩散，\n$$\\frac{\\partial T}{\\partial t} + U\\,\\frac{\\partial T}{\\partial x} = \\alpha\\,\\frac{\\partial^{2}T}{\\partial x^{2}},$$\n其中 $\\alpha$ 是岩石-流体复合物的热扩散系数，$U$ 是流体的渗流（孔隙）速度。考虑一个显式有限差分格式，该格式在时间上使用前向欧拉法，平流项在空间上使用一阶迎风格式，扩散项在空间上使用二阶中心差分格式，网格为间距为 $\\Delta x$ 的均匀网格。\n\n从该偏微分方程和所述的离散化选择出发，通过第一性原理（例如，通过 Von Neumann 稳定性分析和 Courant–Friedrichs–Lewy (CFL) 条件）推导时间步长 $\\Delta t$ 在 $\\Delta x$、$\\alpha$ 和 $U$ 方面的稳定性限制。然后，使用推导出的限制，评估在以下科学上符合实际的地热参数下确保均方稳定性的最大允许时间步长：\n- 饱和裂隙花岗岩的热扩散系数：$\\alpha = 1.2 \\times 10^{-6}\\ \\mathrm{m^{2}\\,s^{-1}}$。\n- 代表储层尺度分辨率的网格间距：$\\Delta x = 10\\ \\mathrm{m}$。\n- 远场渗流速度：$U_{\\mathrm{f}} = 1.0 \\times 10^{-3}\\ \\mathrm{m\\,s^{-1}}$。\n- 注入条件下的近井渗流速度：$U_{\\mathrm{n}} = 5.0 \\times 10^{-2}\\ \\mathrm{m\\,s^{-1}}$。\n\n计算每种速度情况下的最大稳定 $\\Delta t$，并报告最严格的单个 $\\Delta t$ 作为最终答案。将最终时间步长以秒表示，并四舍五入到四位有效数字。此外，在您的推导和论证中，评估在这些典型地热参数下使用此显式格式的可行性。",
            "solution": "该问题要求推导应用于一维平流-扩散方程的特定有限差分格式的稳定性条件，然后使用给定的参数进行数值计算。\n\n温度 $T(x,t)$ 的控制偏微分方程(PDE)为：\n$$\n\\frac{\\partial T}{\\partial t} + U\\,\\frac{\\partial T}{\\partial x} = \\alpha\\,\\frac{\\partial^{2}T}{\\partial x^{2}}\n$$\n其中 $U$ 是流体速度，$\\alpha$ 是热扩散系数。\n\n问题指定了在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上使用以下显式有限差分格式。设 $T_j^n \\approx T(j\\Delta x, n\\Delta t)$。\n\n时间导数使用前向欧拉格式（时间上一阶精度）进行离散化：\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{j}^{n} \\approx \\frac{T_j^{n+1} - T_j^n}{\\Delta t}\n$$\n\n平流项使用一阶迎风格式进行离散化。对于正速度 $U0$，此格式使用来自“迎风”节点（即位置 $j-1$）的数据：\n$$\n\\frac{\\partial T}{\\partial x} \\bigg|_{j}^{n} \\approx \\frac{T_j^n - T_{j-1}^n}{\\Delta x}\n$$\n\n扩散项使用二阶中心差分格式进行离散化：\n$$\n\\frac{\\partial^{2}T}{\\partial x^{2}} \\bigg|_{j}^{n} \\approx \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{(\\Delta x)^2}\n$$\n\n将这些近似代入PDE，得到完全离散化的方程：\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} + U \\left( \\frac{T_j^n - T_{j-1}^n}{\\Delta x} \\right) = \\alpha \\left( \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{(\\Delta x)^2} \\right)\n$$\n\n为了推导稳定性条件，我们首先重排方程以求解新时间步长的温度 $T_j^{n+1}$：\n$$\nT_j^{n+1} = T_j^n - \\frac{U \\Delta t}{\\Delta x} (T_j^n - T_{j-1}^n) + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n\n我们引入两个无量纲数：库朗数 $C$ 和扩散数 $d$：\n$$\nC = \\frac{U \\Delta t}{\\Delta x} \\quad \\text{和} \\quad d = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}\n$$\n\n将这些代入方程中得到：\n$$\nT_j^{n+1} = T_j^n - C(T_j^n - T_{j-1}^n) + d(T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n\n按空间索引（$j+1, j, j-1$）对各项进行分组：\n$$\nT_j^{n+1} = (1 - C - 2d) T_j^n + d T_{j+1}^n + (C+d) T_{j-1}^n\n$$\n\n现在，我们进行 Von Neumann 稳定性分析。我们考虑温度场解的一个傅里叶模：\n$$\nT_j^n = G^n e^{i k x_j} = G^n e^{i k j \\Delta x}\n$$\n其中 $G$ 是放大因子，$k$ 是波数，$i = \\sqrt{-1}$。为使格式稳定，对于所有可能的波数，放大因子的模长不能超过1，即 $|G| \\le 1$。\n\n将傅里叶模代入离散方程：\n$$\nG^{n+1} e^{i k j \\Delta x} = (1 - C - 2d) G^n e^{i k j \\Delta x} + d G^n e^{i k (j+1) \\Delta x} + (C+d) G^n e^{i k (j-1) \\Delta x}\n$$\n\n等式两边同除以 $G^n e^{i k j \\Delta x}$，得到放大因子 $G$ 的表达式：\n$$\nG = (1 - C - 2d) + d e^{i k \\Delta x} + (C+d) e^{-i k \\Delta x}\n$$\n\n令 $\\theta = k \\Delta x$。使用欧拉公式 $e^{i\\phi} = \\cos\\phi + i\\sin\\phi$：\n$$\nG = (1 - C - 2d) + d(\\cos\\theta + i\\sin\\theta) + (C+d)(\\cos\\theta - i\\sin\\theta)\n$$\n\n分离 $G$ 的实部和虚部：\n$$\n\\text{Re}(G) = 1 - C - 2d + d\\cos\\theta + (C+d)\\cos\\theta = 1 - (C+2d) + (C+2d)\\cos\\theta = 1 - (C+2d)(1-\\cos\\theta)\n$$\n$$\n\\text{Im}(G) = d\\sin\\theta - (C+d)\\sin\\theta = -C\\sin\\theta\n$$\n\n稳定性条件为 $|G|^2 \\le 1$：\n$$\n|G|^2 = (\\text{Re}(G))^2 + (\\text{Im}(G))^2 = [1 - (C+2d)(1-\\cos\\theta)]^2 + (-C\\sin\\theta)^2 \\le 1\n$$\n$$\n1 - 2(C+2d)(1-\\cos\\theta) + (C+2d)^2(1-\\cos\\theta)^2 + C^2\\sin^2\\theta \\le 1\n$$\n$$\n(C+2d)^2(1-\\cos\\theta)^2 + C^2\\sin^2\\theta \\le 2(C+2d)(1-\\cos\\theta)\n$$\n\n使用半角恒等式 $1-\\cos\\theta = 2\\sin^2(\\theta/2)$ 和 $\\sin\\theta = 2\\sin(\\theta/2)\\cos(\\theta/2)$：\n$$\n(C+2d)^2 [4\\sin^4(\\theta/2)] + C^2 [4\\sin^2(\\theta/2)\\cos^2(\\theta/2)] \\le 2(C+2d)[2\\sin^2(\\theta/2)]\n$$\n\n对于 $\\sin(\\theta/2) \\ne 0$ 的非平凡模，我们可以两边同除以 $4\\sin^2(\\theta/2)$：\n$$\n(C+2d)^2 \\sin^2(\\theta/2) + C^2 \\cos^2(\\theta/2) \\le C+2d\n$$\n\n该不等式必须对所有 $\\theta \\in [-\\pi, \\pi]$ 成立。令 $s^2 = \\sin^2(\\theta/2)$，因此 $s^2 \\in [0, 1]$。不等式变为关于 $s^2$ 的线性函数：\n$$\n(C+2d)^2 s^2 + C^2 (1-s^2) = C^2 + [(C+2d)^2 - C^2]s^2 \\le C+2d\n$$\n这个线性函数在 $[0,1]$ 上的最大值出现在端点处。\n情况 1：$s^2 = 0$（对应于 $\\theta=0$，最长波长）。\n$$\nC^2 \\le C+2d\n$$\n情况 2：$s^2 = 1$（对应于 $\\theta=\\pi$，最短波长）。\n$$\n(C+2d)^2 \\le C+2d \\implies C+2d \\le 1\n$$\n（因为 $C, d \\ge 0$，我们知道 $C+2d \\ge 0$）。\n\n条件 $C+2d \\le 1$ 意味着 $C \\le 1$。如果 $0 \\le C \\le 1$，那么 $C(C-1) \\le 0$。情况1的条件可以写成 $C^2 - C \\le 2d$，或 $C(C-1) \\le 2d$。由于 $2d \\ge 0$，如果 $C \\le 1$，这个条件总是满足的。因此，主要的稳定性约束来自情况2：\n$$\nC + 2d \\le 1\n$$\n\n代回 $C$ 和 $d$ 的定义：\n$$\n\\frac{U \\Delta t}{\\Delta x} + \\frac{2\\alpha \\Delta t}{(\\Delta x)^2} \\le 1\n$$\n解出时间步长 $\\Delta t$：\n$$\n\\Delta t \\left( \\frac{U}{\\Delta x} + \\frac{2\\alpha}{(\\Delta x)^2} \\right) \\le 1\n$$\n时间步长的稳定性限制是：\n$$\n\\Delta t \\le \\frac{1}{\\frac{U}{\\Delta x} + \\frac{2\\alpha}{(\\Delta x)^2}} = \\frac{(\\Delta x)^2}{U \\Delta x + 2\\alpha}\n$$\n\n可行性评估：这个推导出的条件表明，最大允许时间步长 $\\Delta t$ 与 $(\\Delta x)^2$ 成正比，这是由扩散项引起的。这是抛物线型问题显式方法的一个标志。对于给定的储层尺度分辨率 $\\Delta x = 10\\ \\mathrm{m}$，时间步长可能是合理的。然而，如果为了更高的精度（例如，在注入/生产井附近）而需要加密网格，$\\Delta x$ 的减小将迫使 $\\Delta t$ 更加急剧地减小。例如，将 $\\Delta x$ 减半将需要将 $\\Delta t$ 减小大约四倍，这可能使长期模拟的计算成本过高。这种严格的时间步长限制是该显式格式的主要缺点，通常导致在实际的储层模拟中使用隐式格式，因为它们无条件稳定，但需要在每个时间步求解一个线性方程组。\n\n现在，我们计算给定参数下的最大允许时间步长 $\\Delta t_{\\mathrm{max}}$：\n- $\\alpha = 1.2 \\times 10^{-6}\\ \\mathrm{m^2\\,s^{-1}}$\n- $\\Delta x = 10\\ \\mathrm{m}$\n- $U_{\\mathrm{f}} = 1.0 \\times 10^{-3}\\ \\mathrm{m\\,s^{-1}}$ (远场)\n- $U_{\\mathrm{n}} = 5.0 \\times 10^{-2}\\ \\mathrm{m\\,s^{-1}}$ (近井)\n\n$\\Delta t_{\\mathrm{max}}$ 的公式为：\n$$\n\\Delta t_{\\mathrm{max}} = \\frac{(\\Delta x)^2}{U \\Delta x + 2\\alpha}\n$$\n\n情况 A：远场速度 ($U = U_{\\mathrm{f}}$)\n$$\n\\Delta t_{\\mathrm{max}, f} = \\frac{(10)^2}{(1.0 \\times 10^{-3})(10) + 2(1.2 \\times 10^{-6})} = \\frac{100}{0.01 + 0.0000024} = \\frac{100}{0.0100024} \\approx 9997.6\\ \\mathrm{s}\n$$\n\n情况 B：近井速度 ($U = U_{\\mathrm{n}}$)\n$$\n\\Delta t_{\\mathrm{max}, n} = \\frac{(10)^2}{(5.0 \\times 10^{-2})(10) + 2(1.2 \\times 10^{-6})} = \\frac{100}{0.5 + 0.0000024} = \\frac{100}{0.5000024} \\approx 199.99904\\ \\mathrm{s}\n$$\n\n问题要求报告最严格的单个 $\\Delta t$，即计算出的最大时间步长中的最小值。\n$$\n\\Delta t_{\\mathrm{restrictive}} = \\min(\\Delta t_{\\mathrm{max}, f}, \\Delta t_{\\mathrm{max}, n}) = \\min(9997.6, 199.99904) = 199.99904\\ \\mathrm{s}\n$$\n近井区域的较高速度对时间步长施加了更严格的约束。\n\n最后，将结果四舍五入到四位有效数字：\n$$\n199.99904\\ \\mathrm{s} \\approx 200.0\\ \\mathrm{s}\n$$",
            "answer": "$$\\boxed{200.0}$$"
        },
        {
            "introduction": "模型的预测能力取决于其参数的准确性，而这些参数通常具有不确定性。这个高级练习模拟了一项真实的工程任务：利用反演建模技术，根据压力瞬态数据估算储层渗透率。通过解决这个综合问题 ，您将学会如何将物理模型线性化，应用最小二乘估计器，并量化估计结果的不确定性，从而架起理论模型与实际数据分析之间的桥梁。",
            "id": "4093814",
            "problem": "您的任务是构建并解决一个合成逆问题，利用压力瞬态测量值来估算地热注入井的储层渗透率。目标有两方面：首先，从物理第一性原理出发，推导一个线性化最小二乘估计量；其次，利用费雪信息矩阵 (FIM) 和克拉美-罗下界 (CRLB) 来量化该估计量的不确定性。所有计算和最终报告的量都必须以一致的物理单位表示，所有涉及物理单位的答案都必须遵守下文要求的单位规范。\n\n从均质、各向同性的多孔介质中单相流的质量守恒和 Darcy 定律开始。对于不可压缩流体，径向质量守恒与 Darcy 定律相结合，可得到压力的径向扩散方程。对于无限大作用储层和恒定注入速率的线源井，后期的井筒压力响应存在一个广泛使用的渐近形式，其中井筒处的压力变化（记为 $\\Delta p(t)$）与时间成对数关系，与渗透率成反比。这种渐近行为源于 Theis 解的后期展开。在以下假设下：\n- 均质、各向同性的储层，\n- 无限大作用边界，\n- 恒定速率注入，\n- 后期井筒储集和表皮效应可忽略不计，\n- 单相微可压缩流体，\n后期的井筒压力变化可以用以下形式的函数来建模\n$$\n\\Delta p(t; k) = \\frac{A}{k}\\,\\ln\\!\\big(C\\,k\\,t\\big),\n$$\n其中 $k$ 是渗透率，$t$ 是时间，常数 $A$ 和 $C$ 由基本参数决定，\n$$\nA = \\frac{q\\,\\mu}{4\\pi\\,h},\\quad C = \\frac{4}{\\mu\\,c_t\\,r_w^2},\n$$\n其中 $q$ 是体积注入速率，$\\mu$ 是动力粘度，$h$ 是储层厚度，$c_t$ 是总压缩系数，$r_w$ 是井筒半径。所有参数均为正数，且 $t0$。该模型适用于后期分析，是地热试井解释中一个标准且经过充分检验的近似方法。\n\n设含噪声的测量值定义为\n$$\nd_i = \\Delta p(t_i; k_{\\text{true}}) + \\epsilon_i,\n$$\n对于测量时间 $t_i$，其中噪声 $\\epsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$ 是独立的的高斯噪声。考虑正演模型在初始猜测值 $k_0$ 附近的线性化，\n$$\n\\Delta p(t_i; k) \\approx \\Delta p(t_i; k_0) + g_i\\,(k - k_0),\n$$\n其中 $g_i = \\left.\\frac{\\partial}{\\partial k}\\Delta p(t_i; k)\\right|_{k=k_0}$ 是压力对渗透率的灵敏度。对于上述模型，其导数为\n$$\ng_i = \\frac{A}{k_0^2}\\left(1 - \\ln\\!\\big(C\\,k_0\\,t_i\\big)\\right).\n$$\n假设噪声是方差为 $\\sigma^2$ 的独立同分布高斯噪声，则 $k$ 的线性化加权最小二乘估计为\n$$\n\\hat{k} = k_0 + \\frac{\\sum_{i} \\frac{1}{\\sigma^2}\\,g_i\\left(d_i - \\Delta p(t_i; k_0)\\right)}{\\sum_{i} \\frac{1}{\\sigma^2}\\,g_i^2}.\n$$\n对于单参数情况，费雪信息矩阵简化为标量费雪信息\n$$\n\\mathcal{I}(k_0) = \\sum_{i} \\frac{1}{\\sigma^2}\\,g_i^2,\n$$\n并且，对于 $k$ 的任何无偏估计量，其方差的克拉美-罗下界 (CRLB) 为\n$$\n\\operatorname{Var}(\\hat{k}) \\ge \\frac{1}{\\mathcal{I}(k_0)}.\n$$\n在本问题中，您必须计算 CRLB 的平方根 $\\sqrt{1/\\mathcal{I}(k_0)}$，作为在给定模型和噪声假设下 $\\hat{k}$ 的最佳情况标准差界。\n\n您的程序必须为每个测试用例实现以下步骤：\n1. 根据所提供的物理参数计算 $A$ 和 $C$。\n2. 在指定时间 $\\{t_i\\}$ 使用给定的 $k_{\\text{true}}$ 生成合成压力数据 $\\{d_i\\}$，然后添加具有指定标准差 $\\sigma$ 的高斯噪声（为保证可复现性，使用固定的种子）。\n3. 对所有 $t_i$ 计算 $\\Delta p(t_i; k_0)$ 和 $g_i$。\n4. 使用上述线性化最小二乘更新公式计算 $\\hat{k}$。\n5. 计算费雪信息 $\\mathcal{I}(k_0)$，然后计算 CRLB 标准差界 $\\sqrt{1/\\mathcal{I}(k_0)}$。\n\n单位：\n- 以 $\\text{m}^2$ 为单位报告渗透率 $\\hat{k}$。\n- 以 $\\text{m}^2$ 为单位报告 CRLB 标准差界。\n- 所有内部计算必须统一使用国际单位制（SI）：时间单位为 $\\text{s}$，压力单位为 $\\text{Pa}$，粘度单位为 $\\text{Pa}\\cdot\\text{s}$，压缩系数单位为 $\\text{Pa}^{-1}$，速率单位为 $\\text{m}^3/\\text{s}$，厚度单位为 $\\text{m}$，半径单位为 $\\text{m}$。\n- 本问题不使用角度。\n- 在您的中间或最终计算中出现的任何比率或分数都应表示为小数，而不是百分比符号。\n\n测试套件：\n请为以下三个测试用例提供结果。每个测试用例都指定了 $(q,\\mu,h,c_t,r_w,\\{t_i\\},k_{\\text{true}},k_0,\\sigma)$。\n\n- 案例 1（基准“理想情况”）：\n  - $q = 0.005\\,\\text{m}^3/\\text{s}$，\n  - $\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$，\n  - $h = 100\\,\\text{m}$，\n  - $c_t = 1.0\\times 10^{-9}\\,\\text{Pa}^{-1}$，\n  - $r_w = 0.1\\,\\text{m}$，\n  - 时间 $\\{t_i\\}$：从 $t_{\\min}=100\\,\\text{s}$ 到 $t_{\\max}=100000\\,\\text{s}$ 的 20 个对数间隔点，\n  - $k_{\\text{true}} = 1.0\\times 10^{-13}\\,\\text{m}^2$，\n  - $k_0 = 5.0\\times 10^{-14}\\,\\text{m}^2$，\n  - $\\sigma = 5.0\\times 10^{3}\\,\\text{Pa}$。\n\n- 案例 2（低噪声，密集采样）：\n  - $q = 0.005\\,\\text{m}^3/\\text{s}$，\n  - $\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$，\n  - $h = 100\\,\\text{m}$，\n  - $c_t = 1.2\\times 10^{-9}\\,\\text{Pa}^{-1}$，\n  - $r_w = 0.1\\,\\text{m}$，\n  - 时间 $\\{t_i\\}$：从 $t_{\\min}=200\\,\\text{s}$ 到 $t_{\\max}=200000\\,\\text{s}$ 的 50 个对数间隔点，\n  - $k_{\\text{true}} = 1.5\\times 10^{-13}\\,\\text{m}^2$，\n  - $k_0 = 1.4\\times 10^{-13}\\,\\text{m}^2$，\n  - $\\sigma = 5.0\\times 10^{2}\\,\\text{Pa}$。\n\n- 案例 3（较高噪声，较差的初始猜测，数据点较少）：\n  - $q = 0.003\\,\\text{m}^3/\\text{s}$，\n  - $\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$，\n  - $h = 80\\,\\text{m}$，\n  - $c_t = 8.0\\times 10^{-10}\\,\\text{Pa}^{-1}$，\n  - $r_w = 0.12\\,\\text{m}$，\n  - 时间 $\\{t_i\\}$：从 $t_{\\min}=300\\,\\text{s}$ 到 $t_{\\max}=50000\\,\\text{s}$ 的 10 个对数间隔点，\n  - $k_{\\text{true}} = 8.0\\times 10^{-14}\\,\\text{m}^2$，\n  - $k_0 = 3.0\\times 10^{-14}\\,\\text{m}^2$，\n  - $\\sigma = 2.0\\times 10^{4}\\,\\text{Pa}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表。每个测试用例的结果本身必须是一个包含 $[\\hat{k}, \\sqrt{1/\\mathcal{I}(k_0)}]$（单位为 $\\text{m}^2$）的双元素列表。例如，输出应类似于 $[[x_1,y_1],[x_2,y_2],[x_3,y_3]]$，其中 $x_j$ 是案例 $j$ 的估计渗透率，$y_j$ 是其 CRLB 标准差界。",
            "solution": "问题陈述已经过严格验证，被认为是合理的。它基于多孔介质中流体流动的科学原理，特别是从 Darcy 定律和质量守恒推导出的径向扩散方程。所提出的后期压力响应模型是试井分析中的一个标准近似。其数学框架，包括正演模型的线性化、线性化最小二乘估计量的构建，以及利用费雪信息矩阵通过克拉美-罗下界进行不确定性量化，都是一致且正确的。所有必要的参数和条件都已提供，使得该问题是适定的且自洽的。数值对于地热环境而言是物理上现实的。\n\n解决方案通过执行问题陈述中概述的步骤来进行。任务的核心是从合成的、含噪声的压力数据中估计单个参数——储层渗透率 $k$。这是一个经典的逆问题。我们将构建一个 Python 程序来为三个不同的测试用例执行所需的计算。\n\n首先，我们建立数学模型。在时间 $t$，对于给定的渗透率 $k$，井筒压力变化 $\\Delta p$ 由以下正演模型给出：\n$$\n\\Delta p(t; k) = \\frac{A}{k}\\,\\ln\\!\\big(C\\,k\\,t\\big)\n$$\n常数 $A$ 和 $C$ 取决于储层和流体的物理性质，以及井的操作参数：\n$$\nA = \\frac{q\\,\\mu}{4\\pi\\,h} \\quad \\text{和} \\quad C = \\frac{4}{\\mu\\,c_t\\,r_w^2}\n$$\n这里，$q$ 是注入速率，$\\mu$ 是流体粘度，$h$ 是储层厚度，$c_t$ 是总压缩系数，$r_w$ 是井筒半径。所有计算都必须使用一致的国际单位制（SI）单位：压力单位为帕斯卡（$Pa$），时间单位为秒（$s$），长度单位为米（$m$），质量单位为千克（$kg$）。\n\n在测量时间 $t_i$ 的合成数据 $d_i$ 是通过在真实渗透率 $k_{\\text{true}}$ 处评估正演模型，并添加独立同分布 (i.i.d.) 的高斯噪声 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$ 生成的：\n$$\nd_i = \\Delta p(t_i; k_{\\text{true}}) + \\epsilon_i\n$$\n\n为了解决这个逆问题，我们采用线性化方法。正演模型通过其在初始猜测值 $k_0$ 附近的一阶泰勒展开来近似：\n$$\n\\Delta p(t_i; k) \\approx \\Delta p(t_i; k_0) + g_i\\,(k - k_0)\n$$\n项 $g_i$ 是灵敏度，即压力响应对渗透率的偏导数，在 $k_0$ 处求值：\n$$\ng_i = \\left.\\frac{\\partial \\Delta p(t_i; k)}{\\partial k}\\right|_{k=k_0} = \\frac{A}{k_0^2}\\left(1 - \\ln\\!\\big(C\\,k_0\\,t_i\\big)\\right)\n$$\n通过这种线性化，可以通过最小化加权残差平方和来找到估计的渗透率 $\\hat{k}$。对于独立同分布的高斯噪声，这产生了线性化最小二乘估计量：\n$$\n\\hat{k} = k_0 + \\frac{\\sum_{i} g_i\\left(d_i - \\Delta p(t_i; k_0)\\right)}{\\sum_{i} g_i^2}\n$$\n请注意，在这个单参数高斯-牛顿更新步骤中，权重因子 $1/\\sigma^2$ 从分子和分母中抵消了。\n\n该估计的不确定性使用克拉美-罗下界 (CRLB) 进行量化，它为任何无偏估计量的方差提供了一个下界。CRLB 是费雪信息 $\\mathcal{I}(k_0)$ 的倒数。对于单个参数和独立同分布的高斯噪声，费雪信息为：\n$$\n\\mathcal{I}(k_0) = \\sum_{i} \\left(\\frac{1}{\\sigma} \\frac{\\partial \\Delta p(t_i; k_0)}{\\partial k}\\right)^2 = \\frac{1}{\\sigma^2} \\sum_{i} g_i^2\n$$\n方差的 CRLB 为 $\\operatorname{Var}(\\hat{k}) \\ge 1/\\mathcal{I}(k_0)$。我们的任务是计算标准差界，即该值的平方根：\n$$\n\\text{CRLB 标准差界} = \\sqrt{\\frac{1}{\\mathcal{I}(k_0)}} = \\sqrt{\\frac{\\sigma^2}{\\sum_{i} g_i^2}} = \\frac{\\sigma}{\\sqrt{\\sum_{i} g_i^2}}\n$$\n\n每个测试用例的算法如下：\n1.  给定物理参数（$q, \\mu, h, c_t, r_w$），计算常数 $A$ 和 $C$。\n2.  使用对数刻度为指定的点数和时间间隔生成测量时间数组 $\\{t_i\\}$。\n3.  计算“真实”压力响应 $\\Delta p(t_i; k_{\\text{true}})$。\n4.  从 $\\mathcal{N}(0, \\sigma^2)$ 生成一个随机噪声向量 $\\epsilon_i$，使用固定的随机种子以保证可复现性，并将其加到真实压力上以获得合成数据向量 $\\{d_i\\}$。\n5.  计算在初始猜测值处的模型压力响应 $\\Delta p(t_i; k_0)$。\n6.  计算灵敏度向量 $\\{g_i\\}$。\n7.  使用推导出的公式计算估计的渗透率 $\\hat{k}$ 和 CRLB 标准差界。\n8.  按规定格式收集并格式化结果。\n\n此过程将使用 `numpy` 库在 Python 脚本中实现，以进行高效的数值计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a synthetic inverse problem to estimate geothermal reservoir permeability.\n    For each test case, it computes a linearized least squares estimate of permeability\n    and the corresponding Cramér–Rao Lower Bound on the estimation standard deviation.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case 1\",\n            \"q\": 0.005,      # m^3/s\n            \"mu\": 1.0e-3,    # Pa.s\n            \"h\": 100.0,      # m\n            \"ct\": 1.0e-9,    # Pa^-1\n            \"rw\": 0.1,       # m\n            \"t_min\": 100.0,  # s\n            \"t_max\": 100000.0, # s\n            \"num_t\": 20,\n            \"k_true\": 1.0e-13, # m^2\n            \"k0\": 5.0e-14,   # m^2\n            \"sigma\": 5.0e3,  # Pa\n        },\n        {\n            \"name\": \"Case 2\",\n            \"q\": 0.005,      # m^3/s\n            \"mu\": 1.0e-3,    # Pa.s\n            \"h\": 100.0,      # m\n            \"ct\": 1.2e-9,    # Pa^-1\n            \"rw\": 0.1,       # m\n            \"t_min\": 200.0,  # s\n            \"t_max\": 200000.0, # s\n            \"num_t\": 50,\n            \"k_true\": 1.5e-13, # m^2\n            \"k0\": 1.4e-13,   # m^2\n            \"sigma\": 5.0e2,  # Pa\n        },\n        {\n            \"name\": \"Case 3\",\n            \"q\": 0.003,      # m^3/s\n            \"mu\": 1.0e-3,    # Pa.s\n            \"h\": 80.0,       # m\n            \"ct\": 8.0e-10,   # Pa^-1\n            \"rw\": 0.12,      # m\n            \"t_min\": 300.0,  # s\n            \"t_max\": 50000.0, # s\n            \"num_t\": 10,\n            \"k_true\": 8.0e-14, # m^2\n            \"k0\": 3.0e-14,   # m^2\n            \"sigma\": 2.0e4,  # Pa\n        }\n    ]\n\n    results = []\n    \n    # Set a fixed seed for reproducibility of the synthetic noise.\n    np.random.seed(42)\n\n    for case in test_cases:\n        # Unpack parameters for the current case\n        q, mu, h, ct, rw = case[\"q\"], case[\"mu\"], case[\"h\"], case[\"ct\"], case[\"rw\"]\n        t_min, t_max, num_t = case[\"t_min\"], case[\"t_max\"], case[\"num_t\"]\n        k_true, k0, sigma = case[\"k_true\"], case[\"k0\"], case[\"sigma\"]\n\n        # Step 1: Compute A and C from physical parameters\n        A = (q * mu) / (4.0 * np.pi * h)\n        C = 4.0 / (mu * ct * rw**2)\n\n        # Define the forward model for pressure change\n        def delta_p(t, k, A_const, C_const):\n            arg = C_const * k * t\n            # The model is valid for late times where the argument of log is > 1\n            if np.any(arg = 0):\n                raise ValueError(\"Argument of logarithm must be positive.\")\n            return (A_const / k) * np.log(arg)\n\n        # Step 2: Generate synthetic pressure data {d_i}\n        times = np.logspace(np.log10(t_min), np.log10(t_max), num_t)\n        p_true = delta_p(times, k_true, A, C)\n        noise = np.random.normal(0, sigma, size=num_t)\n        data = p_true + noise\n\n        # Step 3: Compute delta_p(t_i; k0) and sensitivities {g_i}\n        p_k0 = delta_p(times, k0, A, C)\n        \n        # Sensitivity g_i = (A/k0^2) * (1 - ln(C*k0*t_i))\n        g = (A / k0**2) * (1.0 - np.log(C * k0 * times))\n\n        # Step 4: Compute the linearized least squares estimate for k\n        residuals = data - p_k0\n        sum_g_sq = np.sum(g**2)\n        \n        # This is the single Gauss-Newton update step\n        k_hat = k0 + np.sum(g * residuals) / sum_g_sq\n\n        # Step 5: Compute the Fisher Information and CRLB standard deviation bound\n        # Fisher Information: I(k0) = sum(g_i^2) / sigma^2\n        # We need sqrt(1/I) = sigma / sqrt(sum(g_i^2))\n        crlb_std_dev = sigma / np.sqrt(sum_g_sq)\n        \n        results.append([k_hat, crlb_std_dev])\n\n    # Final print statement in the exact required format.\n    # Format each result pair as \"[k_hat,crlb_std]\" and join them.\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}