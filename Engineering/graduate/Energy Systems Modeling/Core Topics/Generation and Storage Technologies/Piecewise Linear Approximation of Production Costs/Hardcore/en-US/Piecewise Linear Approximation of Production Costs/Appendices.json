{
    "hands_on_practices": [
        {
            "introduction": "The most direct way to approximate a nonlinear cost curve is to connect a series of points on the curve with straight line segments. This exercise grounds this intuitive idea in a formal mathematical framework by using convex combinations. By working through this problem, you will learn to express the interpolated cost at any point as a weighted average of the costs at the segment's endpoints, a fundamental technique in linear modeling. ",
            "id": "4111598",
            "problem": "Consider a single thermal generating unit whose production cost as a function of electrical output power is modeled by a convex and increasing function $C(p)$, where $p$ denotes power in megawatt (MW). In planning models, a common practice is to construct a piecewise linear approximation of $C(p)$ by selecting a finite set of breakpoints $\\{p_i\\}$ and using the straight line segments that connect the points $\\{(p_i,C(p_i))\\}$.\n\nSuppose the available breakpoints are $p_i \\in \\{50,75,100\\}$ MW, with corresponding exact costs $C(50)=5000$, $C(75)=7000$, and $C(100)=9500$ in monetary units. For an intermediate power $p$ lying between two adjacent breakpoints, the piecewise linear approximation prescribes evaluating the cost on the straight line segment connecting the adjacent breakpoint values.\n\nStarting from the definition of convexity of a real-valued function and the fact that any $p$ in an interval $[p_a,p_b]$ can be written as a convex combination of $p_a$ and $p_b$, derive the expression for the piecewise linear approximation to $C(p)$ on $[p_a,p_b]$ solely in terms of convex combination weights and the values $C(p_a)$ and $C(p_b)$. Then apply your derivation to compute the approximate cost $c$ for $p=80$ MW using the adjacent breakpoints $p_a=75$ MW and $p_b=100$ MW and the corresponding costs above.\n\nExpress the final cost in monetary units. No rounding is required.",
            "solution": "The user wants me to solve a problem about the piecewise linear approximation of a production cost function.\n\n### Problem Validation\n\nFirst, I must validate the problem statement.\n\n**Step 1: Extract Givens**\n- The production cost function is $C(p)$, which is convex and increasing.\n- $p$ is the electrical output power in megawatts (MW).\n- The approximation of $C(p)$ is a piecewise linear function constructed from a set of breakpoints $\\{p_i\\}$ connecting points $(p_i, C(p_i))$.\n- Available breakpoints are $p_i \\in \\{50, 75, 100\\}$ MW.\n- Corresponding costs are $C(50)=5000$, $C(75)=7000$, and $C(100)=9500$ monetary units.\n- For an intermediate power $p \\in [p_a, p_b]$, the approximate cost is evaluated on the straight line segment between $(p_a, C(p_a))$ and $(p_b, C(p_b))$.\n- The first task is to derive the expression for the piecewise linear approximation on $[p_a, p_b]$ in terms of convex combination weights.\n- The second task is to compute the approximate cost, $c$, for $p=80$ MW using the adjacent breakpoints $p_a=75$ MW and $p_b=100$ MW.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem formulation is standard in the field of energy systems engineering and optimization. Convex cost functions and their piecewise linear approximations are fundamental tools for modeling thermal generator dispatch.\n- **Well-Posed:** The problem is well-defined. It provides all necessary information and asks for a specific derivation and a calculation. The given data is consistent; the cost is an increasing function of power ($5000  7000  9500$ for $50  75  100$). The discrete points also exhibit convexity, as the slope of the segment from $p=50$ to $p=75$ is $\\frac{7000-5000}{75-50} = \\frac{2000}{25} = 80$, and the slope of the segment from $p=75$ to $p=100$ is $\\frac{9500-7000}{100-75} = \\frac{2500}{25} = 100$. Since $80  100$, the slopes are increasing, which is consistent with a convex function.\n- **Objective:** The problem is stated using precise mathematical and technical language, with no subjectivity or ambiguity.\n\nThe problem is free from any of the invalidity flaws listed in the instructions. It is scientifically sound, complete, and well-posed.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with the solution.\n\n###\nThe solution consists of two parts: a derivation of the general formula and its application to a specific case.\n\n**Part 1: Derivation of the Piecewise Linear Approximation**\n\nLet $\\tilde{C}(p)$ be the piecewise linear approximation to the cost function $C(p)$ on the interval $[p_a, p_b]$. By definition, $\\tilde{C}(p)$ is the value on the straight line segment connecting the points $(p_a, C(p_a))$ and $(p_b, C(p_b))$.\n\nThe equation of this line can be expressed using the two-point form. For any power level $p \\in [p_a, p_b]$, the approximated cost $\\tilde{C}(p)$ lies on this line, so it must satisfy:\n$$\n\\frac{\\tilde{C}(p) - C(p_a)}{p - p_a} = \\frac{C(p_b) - C(p_a)}{p_b - p_a}\n$$\nSolving for $\\tilde{C}(p)$, we get:\n$$\n\\tilde{C}(p) = C(p_a) + \\left( \\frac{C(p_b) - C(p_a)}{p_b - p_a} \\right) (p - p_a)\n$$\nThe problem requires this expression to be formulated in terms of convex combination weights. Any point $p \\in [p_a, p_b]$ can be uniquely expressed as a convex combination of the endpoints $p_a$ and $p_b$:\n$$\np = (1-\\lambda) p_a + \\lambda p_b \\quad \\text{for some } \\lambda \\in [0, 1]\n$$\nWe can find an expression for the weight $\\lambda$ by rearranging the equation:\n$$\np - p_a = (1-\\lambda) p_a + \\lambda p_b - p_a = \\lambda p_b - \\lambda p_a = \\lambda (p_b - p_a)\n$$\nAssuming $p_a \\neq p_b$, we can solve for $\\lambda$:\n$$\n\\lambda = \\frac{p - p_a}{p_b - p_a}\n$$\nThe term $(1-\\lambda)$ is the other weight:\n$$\n1 - \\lambda = 1 - \\frac{p - p_a}{p_b - p_a} = \\frac{(p_b - p_a) - (p - p_a)}{p_b - p_a} = \\frac{p_b - p}{p_b - p_a}\n$$\nNow, we substitute $\\lambda$ into our expression for $\\tilde{C}(p)$:\n$$\n\\tilde{C}(p) = C(p_a) + (C(p_b) - C(p_a)) \\lambda\n$$\nDistributing the terms gives:\n$$\n\\tilde{C}(p) = C(p_a) - \\lambda C(p_a) + \\lambda C(p_b)\n$$\nFactoring yields the final expression in terms of the convex combination weights $(1-\\lambda)$ and $\\lambda$:\n$$\n\\tilde{C}(p) = (1-\\lambda) C(p_a) + \\lambda C(p_b)\n$$\nThis is the required derivation. It demonstrates that the value of the linear approximation at $p$ is the same convex combination of the costs $C(p_a)$ and $C(p_b)$ as $p$ is of the power levels $p_a$ and $p_b$. Since the original function $C(p)$ is convex, it holds that $C(p) = C((1-\\lambda)p_a + \\lambda p_b) \\le (1-\\lambda)C(p_a)+\\lambda C(p_b) = \\tilde{C}(p)$, meaning the piecewise linear approximation provides an upper bound on the true cost between breakpoints.\n\n**Part 2: Calculation of the Approximate Cost**\n\nWe are asked to compute the approximate cost $c$ for a power output of $p = 80$ MW. The specified adjacent breakpoints are $p_a = 75$ MW and $p_b = 100$ MW. The corresponding costs are given as $C(p_a) = C(75) = 7000$ and $C(p_b) = C(100) = 9500$.\n\nFirst, we calculate the value of the convex combination weight $\\lambda$:\n$$\n\\lambda = \\frac{p - p_a}{p_b - p_a} = \\frac{80 - 75}{100 - 75} = \\frac{5}{25} = \\frac{1}{5}\n$$\nThe other weight is therefore $1-\\lambda = 1 - \\frac{1}{5} = \\frac{4}{5}$.\n\nNow, we use the derived formula to find the approximate cost $c = \\tilde{C}(80)$:\n$$\nc = (1-\\lambda) C(75) + \\lambda C(100)\n$$\nSubstituting the values:\n$$\nc = \\left(\\frac{4}{5}\\right) (7000) + \\left(\\frac{1}{5}\\right) (9500)\n$$\n$$\nc = (0.8)(7000) + (0.2)(9500)\n$$\n$$\nc = 5600 + 1900\n$$\n$$\nc = 7500\n$$\nThe approximate cost for producing $80$ MW of power is $7500$ monetary units.",
            "answer": "$$\n\\boxed{7500}\n$$"
        },
        {
            "introduction": "While piecewise linear models simplify complex cost functions, they inherently introduce approximation errors. This practice provides a hands-on opportunity to quantify this error by comparing the linear approximation against the true quadratic cost function at specific points. Calculating this discrepancy is crucial for understanding the trade-off between computational tractability and model fidelity in energy system optimization. ",
            "id": "4111564",
            "problem": "Consider a single thermal generating unit whose hourly production cost is modeled by a convex quadratic function of real power output $p$ (in $\\text{MW}$) of the form $C(p)=a+bp+cp^{2}$, where $a$ is the no-load cost in $\\$ / \\text{h}$, $b$ has units $\\$ / (\\text{MWh})$, and $c$ has units $\\$ / (\\text{MW}^{2}\\,\\text{h})$. In many operations planning formulations using Mixed-Integer Linear Programming (MILP), this convex cost is approximated by a piecewise linear function constructed by connecting the points $\\{(p_{i},C(p_{i}))\\}$ at a set of breakpoints $\\{p_{i}\\}$.\n\nLet $a=100$, $b=15$, and $c=0.05$. Consider breakpoints every $25\\,\\text{MW}$ from $0\\,\\text{MW}$ to $100\\,\\text{MW}$, i.e., $p_{i}\\in\\{0,25,50,75,100\\}$. Define the piecewise linear interpolant $C_{\\mathrm{PL}}(p)$ that equals the line segment between adjacent points $(p_{i},C(p_{i}))$ and $(p_{i+1},C(p_{i+1}))$ for $p\\in[p_{i},p_{i+1}]$. Using only the definitions of convexity of $C(p)$, linear interpolation, and the fact that the chord of a convex function’s graph lies on or above the graph, do the following:\n\n- Compute $C_{\\mathrm{PL}}(p)$ and $C(p)$ at $p=37.5$ and at $p=87.5$.\n- From these, compute the absolute approximation errors $|C_{\\mathrm{PL}}(37.5)-C(37.5)|$ and $|C_{\\mathrm{PL}}(87.5)-C(87.5)|$.\n- Report the maximum of these two absolute errors as a single scalar.\n\nExpress your final answer in $\\$ / \\text{h}$ and round your answer to five significant figures.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard exercise in the piecewise linear approximation of nonlinear functions, a common technique in energy systems optimization. All necessary data and definitions are provided, and there are no contradictions or ambiguities.\n\nThe hourly production cost function is given by:\n$$C(p) = a+bp+cp^{2}$$\nwith the coefficients $a=100\\,\\$/\\text{h}$, $b=15\\,\\$/(\\text{MWh})$, and $c=0.05\\,\\$/(\\text{MW}^{2}\\,\\text{h})$. The power output $p$ is in $\\text{MW}$.\nSubstituting the coefficients, the cost function is:\n$$C(p) = 100 + 15p + 0.05p^{2}$$\nThe function's second derivative is $C''(p) = 2c = 2(0.05) = 0.1$, which is positive. This confirms that $C(p)$ is a strictly convex function. For a convex function, any chord connecting two points on its graph lies on or above the graph. Consequently, the piecewise linear approximation $C_{\\mathrm{PL}}(p)$ will always be greater than or equal to the true cost $C(p)$, i.e., $C_{\\mathrm{PL}}(p) \\ge C(p)$. The approximation error is thus $C_{\\mathrm{PL}}(p) - C(p)$, and the absolute error is $|C_{\\mathrm{PL}}(p) - C(p)| = C_{\\mathrm{PL}}(p) - C(p)$.\n\nThe breakpoints for the piecewise linear approximation are given as $p_{i} \\in \\{0, 25, 50, 75, 100\\}$. We first compute the true costs at these breakpoints.\n$$C(0) = 100 + 15(0) + 0.05(0)^{2} = 100$$\n$$C(25) = 100 + 15(25) + 0.05(25)^{2} = 100 + 375 + 0.05(625) = 475 + 31.25 = 506.25$$\n$$C(50) = 100 + 15(50) + 0.05(50)^{2} = 100 + 750 + 0.05(2500) = 850 + 125 = 975$$\n$$C(75) = 100 + 15(75) + 0.05(75)^{2} = 100 + 1125 + 0.05(5625) = 1225 + 281.25 = 1506.25$$\n$$C(100) = 100 + 15(100) + 0.05(100)^{2} = 100 + 1500 + 0.05(10000) = 1600 + 500 = 2100$$\nThe units for all cost values are $\\$ / \\text{h}$.\n\nThe task is to compute the approximation error at two points: $p = 37.5$ and $p = 87.5$.\n\nFirst, consider $p = 37.5\\,\\text{MW}$.\nThis point lies in the interval $[25, 50]$. The piecewise linear approximation $C_{\\mathrm{PL}}(37.5)$ is found by linear interpolation between the points $(25, C(25))$ and $(50, C(50))$. The points are $(25, 506.25)$ and $(50, 975)$.\nThe general formula for linear interpolation for a point $p$ in an interval $[p_i, p_{i+1}]$ is:\n$$C_{\\mathrm{PL}}(p) = C(p_i) + \\frac{C(p_{i+1}) - C(p_i)}{p_{i+1} - p_i}(p - p_i)$$\nFor $p=37.5$, $p_i=25$, and $p_{i+1}=50$:\n$$C_{\\mathrm{PL}}(37.5) = C(25) + \\frac{C(50) - C(25)}{50 - 25}(37.5 - 25)$$\n$$C_{\\mathrm{PL}}(37.5) = 506.25 + \\frac{975 - 506.25}{25}(12.5) = 506.25 + \\frac{468.75}{25}(12.5) = 506.25 + 18.75 \\times 12.5$$\n$$C_{\\mathrm{PL}}(37.5) = 506.25 + 234.375 = 740.625$$\nNow, we compute the true cost $C(37.5)$:\n$$C(37.5) = 100 + 15(37.5) + 0.05(37.5)^{2} = 100 + 562.5 + 0.05(1406.25)$$\n$$C(37.5) = 662.5 + 70.3125 = 732.8125$$\nThe absolute approximation error at $p = 37.5$ is:\n$$|C_{\\mathrm{PL}}(37.5) - C(37.5)| = |740.625 - 732.8125| = 7.8125$$\n\nNext, consider $p=87.5\\,\\text{MW}$.\nThis point lies in the interval $[75, 100]$. The piecewise linear approximation $C_{\\mathrm{PL}}(87.5)$ is found by linear interpolation between the points $(75, C(75))$ and $(100, C(100))$. The points are $(75, 1506.25)$ and $(100, 2100)$.\nFor $p=87.5$, $p_i=75$, and $p_{i+1}=100$:\n$$C_{\\mathrm{PL}}(87.5) = C(75) + \\frac{C(100) - C(75)}{100 - 75}(87.5 - 75)$$\n$$C_{\\mathrm{PL}}(87.5) = 1506.25 + \\frac{2100 - 1506.25}{25}(12.5) = 1506.25 + \\frac{593.75}{25}(12.5) = 1506.25 + 23.75 \\times 12.5$$\n$$C_{\\mathrm{PL}}(87.5) = 1506.25 + 296.875 = 1803.125$$\nNow, we compute the true cost $C(87.5)$:\n$$C(87.5) = 100 + 15(87.5) + 0.05(87.5)^{2} = 100 + 1312.5 + 0.05(7656.25)$$\n$$C(87.5) = 1412.5 + 382.8125 = 1795.3125$$\nThe absolute approximation error at $p = 87.5$ is:\n$$|C_{\\mathrm{PL}}(87.5) - C(87.5)| = |1803.125 - 1795.3125| = 7.8125$$\n\nFinally, we find the maximum of these two absolute errors.\n$$\\text{Max Error} = \\max(|C_{\\mathrm{PL}}(37.5) - C(37.5)|, |C_{\\mathrm{PL}}(87.5) - C(87.5)|)$$\n$$\\text{Max Error} = \\max(7.8125, 7.8125) = 7.8125$$\nThe maximum error is $7.8125\\,\\$/\\text{h}$. The problem requires the answer to be rounded to five significant figures. The number $7.8125$ already has five significant figures ($7, 8, 1, 2, 5$), so no rounding is necessary.\nThe maximum error occurs at the midpoint of any interval of a given width for a quadratic function, and its value, $\\frac{c}{4}(\\Delta p)^2$, depends only on the quadratic coefficient $c$ and the interval width $\\Delta p$. Since both evaluation points are midpoints of intervals with the same width $\\Delta p = 25$, the errors are identical.\n$\\frac{0.05}{4}(25)^2 = 0.0125 \\times 625 = 7.8125$, which confirms the detailed calculation.",
            "answer": "$$\n\\boxed{7.8125}\n$$"
        },
        {
            "introduction": "An alternative to interpolating total cost points is the incremental cost formulation, which is especially powerful in large-scale optimization models. This exercise demonstrates how to construct the total variable cost by summing the costs of sequential \"blocks\" of energy, each with its own constant marginal cost. This approach directly models the economic principle of dispatching generation from the lowest to the highest marginal cost, providing a clear link between the approximation and market operations. ",
            "id": "4111589",
            "problem": "A single thermal generating unit is modeled for a short time period using a convex, piecewise-linear approximation of its variable production cost. The unit’s feasible production range is defined by a minimum power $P_{\\min}$ and a maximum power $P_{\\max}$, with breakpoints at $p=[50,80,100]$ megawatts (MW), so $P_{\\min}=50$ MW and $P_{\\max}=100$ MW. The piecewise-linear approximation is constructed from the fundamental definition that the total variable cost $c(p)$ at power $p$ equals the integral of the marginal cost function $m(\\tilde{p})$ from $P_{\\min}$ to $p$, where $m(\\tilde{p})$ is approximated as constant within each segment between consecutive breakpoints. Specifically, the marginal cost slopes for the two segments $[50,80]$ MW and $[80,100]$ MW are $\\alpha=[20,30]$ dollars per megawatt, respectively, and the incremental formulation is “anchored” at $P_{\\min}$, meaning $c(P_{\\min})=0$.\n\nStarting from these base definitions (total cost as the integral of marginal cost, and segmentwise-constant marginal cost), the incremental formulation allocates any output above $P_{\\min}$ sequentially into contiguous segments, never exceeding a segment’s length before moving to the next. Using this formulation, compute the total variable production cost $c$ at $p=90$ MW. Express the final cost in dollars, and provide the exact value (no rounding required).",
            "solution": "We begin from the foundational definition of variable production cost in power systems: the total cost $c(p)$ is the integral of the marginal cost $m(\\tilde{p})$ from the chosen anchor point to the operating point. With the piecewise-constant marginal cost approximation, we have a partition of the production range into segments with constant slopes, which are the marginal costs within those segments. When the formulation is anchored at $P_{\\min}$, the baseline is $c(P_{\\min})=0$, and any production above $P_{\\min}$ incurs cost according to the marginal cost slope of the segment that the additional output occupies.\n\nLet the breakpoints be $p=[50,80,100]$ MW. Thus, the segments are:\n- Segment $1$: $[50,80]$ MW, length $80-50=30$ MW, slope $\\alpha_{1}=20$ dollars per megawatt.\n- Segment $2$: $[80,100]$ MW, length $100-80=20$ MW, slope $\\alpha_{2}=30$ dollars per megawatt.\n\nThe incremental formulation dictates that any power above $P_{\\min}=50$ MW is first allocated to Segment $1$ up to its capacity, and only then to Segment $2$. For a target production $p=90$ MW, the additional output above $P_{\\min}$ is\n$$\n\\Delta p = p - P_{\\min} = 90 - 50 = 40 \\text{ MW}.\n$$\nWe allocate this $\\Delta p$ across the segments:\n- Segment $1$ can take at most $30$ MW. Therefore, we allocate\n$$\nz_{1} = \\min\\{30,\\Delta p\\} = \\min\\{30,40\\} = 30 \\text{ MW}.\n$$\n- The remaining increment goes to Segment $2$:\n$$\nz_{2} = \\Delta p - z_{1} = 40 - 30 = 10 \\text{ MW}.\n$$\n\nBecause the marginal cost is constant within each segment, the total variable cost is the sum over segments of (segment slope) times (allocated increment in that segment). Therefore,\n$$\nc(90) = \\alpha_{1} z_{1} + \\alpha_{2} z_{2} = 20 \\times 30 + 30 \\times 10 = 600 + 300 = 900 \\text{ dollars}.\n$$\nThis follows directly from integrating the piecewise-constant marginal cost over the allocated increments; it is equivalent to summing rectangular areas under the marginal cost curve between $P_{\\min}$ and $p$.\n\nHence, the exact total variable production cost at $p=90$ MW under the incremental formulation anchored at $P_{\\min}=50$ MW is $900$ dollars.",
            "answer": "$$\\boxed{900}$$"
        }
    ]
}