{
    "hands_on_practices": [
        {
            "introduction": "The availability profiles of some renewable resources, like tidal streams, can be predicted with remarkable accuracy from fundamental physical principles. This exercise  provides hands-on practice in constructing such a profile from the ground up by superimposing the principal harmonic constituents of tidal currents. You will translate the predictable nature of celestial mechanics into a high-resolution velocity time series $v(t)$ and then compute the corresponding power flux $P(t)$, linking foundational physics directly to a practical energy systems output.",
            "id": "4115872",
            "problem": "You are tasked with constructing a tidal current availability time series using harmonic analysis and computing the corresponding kinetic power flux time series. The construction must rely on the standard representation of tidal constituents and the kinetic power flux of a moving fluid. From first principles, use the following scientifically established starting points:\n- Any stationary tidal current signal can be approximated as a sum of a finite set of harmonics. For constituents indexed by $j$, each harmonic component is characterized by an amplitude $A_j$ (in $\\mathrm{m/s}$), a phase $\\phi_j$ (in radians), and an angular frequency $\\omega_j$ (in radians per hour). The velocity along a fixed axis is modeled as\n$$\nv(t) \\;=\\; \\sum_{j} A_j \\cos\\!\\big(\\omega_j t + \\phi_j\\big),\n$$\nwhere $t$ is time in hours.\n- The kinetic power flux per unit area of a fluid stream of density $\\rho$ moving at speed $|v|$ is\n$$\nP(t) \\;=\\; \\tfrac{1}{2}\\,\\rho\\,|v(t)|^3,\n$$\nwith $\\rho$ in $\\mathrm{kg/m^3}$ and $P(t)$ in $\\mathrm{W/m^2}$. Use $\\rho = 1025$ in $\\mathrm{kg/m^3}$ (seawater, International System of Units (SI)).\n\nThe harmonic constituents to be used are the principal lunar semidiurnal ($\\mathrm{M2}$), principal solar semidiurnal ($\\mathrm{S2}$), luni-solar diurnal ($\\mathrm{K1}$), and principal lunar diurnal ($\\mathrm{O1}$) components. Their astronomical periods in hours are:\n- $\\mathrm{M2}$: $T_{\\mathrm{M2}} = 12.4206012$,\n- $\\mathrm{S2}$: $T_{\\mathrm{S2}} = 12.0$,\n- $\\mathrm{K1}$: $T_{\\mathrm{K1}} = 23.93447213$,\n- $\\mathrm{O1}$: $T_{\\mathrm{O1}} = 25.81934166$.\n\nFor each constituent, compute the angular frequency as\n$$\n\\omega_j \\;=\\; \\frac{2\\pi}{T_j}\n\\quad\\text{(radians per hour)}.\n$$\n\nDiscretize time uniformly as\n$$\nt_k \\;=\\; k\\,\\Delta t,\\quad k \\in \\{0,1,2,\\dots,N-1\\},\n$$\nwhere $\\Delta t$ is the time step in hours and $N \\;=\\; \\left\\lfloor \\dfrac{T}{\\Delta t} \\right\\rfloor$ is the number of samples for the horizon $T$ in hours. Use the discrete-time arithmetic mean as the estimator of the time-average power flux:\n$$\n\\overline{P} \\;=\\; \\frac{1}{N} \\sum_{k=0}^{N-1} P(t_k).\n$$\n\nAngle units: all phases and angular frequencies are in radians, and $t$ is in hours. Velocities must be in $\\mathrm{m/s}$, and power flux must be expressed in $\\mathrm{W/m^2}$. Your program must compute $\\overline{P}$ for each test case below and express each result in $\\mathrm{W/m^2}$, rounded to exactly $6$ decimal places.\n\nImplement the above using the following test suite of four cases, each specified by the horizon $T$, time step $\\Delta t$, amplitude vector $[A_{\\mathrm{M2}}, A_{\\mathrm{S2}}, A_{\\mathrm{K1}}, A_{\\mathrm{O1}}]$ in $\\mathrm{m/s}$, and phase vector $[\\phi_{\\mathrm{M2}}, \\phi_{\\mathrm{S2}}, \\phi_{\\mathrm{K1}}, \\phi_{\\mathrm{O1}}]$ in radians:\n- Case A (general multiharmonic over two spring-neap cycles):\n  - $T = 336.0$, $\\Delta t = 0.25$,\n  - $[A_{\\mathrm{M2}}, A_{\\mathrm{S2}}, A_{\\mathrm{K1}}, A_{\\mathrm{O1}}] = [1.0, 0.35, 0.25, 0.15]$,\n  - $[\\phi_{\\mathrm{M2}}, \\phi_{\\mathrm{S2}}, \\phi_{\\mathrm{K1}}, \\phi_{\\mathrm{O1}}] = [0.4, -1.1, 1.6, -0.3]$.\n- Case B (single-constituent boundary with integer multiples of the period):\n  - $T = 10 \\times 12.4206012$, $\\Delta t = 0.05$,\n  - $[A_{\\mathrm{M2}}, A_{\\mathrm{S2}}, A_{\\mathrm{K1}}, A_{\\mathrm{O1}}] = [1.5, 0.0, 0.0, 0.0]$,\n  - $[\\phi_{\\mathrm{M2}}, \\phi_{\\mathrm{S2}}, \\phi_{\\mathrm{K1}}, \\phi_{\\mathrm{O1}}] = [0.0, 0.0, 0.0, 0.0]$.\n- Case C (diurnal-dominated with phase offsets):\n  - $T = 168.0$, $\\Delta t = 0.2$,\n  - $[A_{\\mathrm{M2}}, A_{\\mathrm{S2}}, A_{\\mathrm{K1}}, A_{\\mathrm{O1}}] = [0.6, 0.3, 1.2, 0.8]$,\n  - $[\\phi_{\\mathrm{M2}}, \\phi_{\\mathrm{S2}}, \\phi_{\\mathrm{K1}}, \\phi_{\\mathrm{O1}}] = [\\pi/3, -\\pi/4, \\pi/2, -\\pi/6]$.\n- Case D (near-zero amplitudes to probe numerical stability):\n  - $T = 48.0$, $\\Delta t = 0.5$,\n  - $[A_{\\mathrm{M2}}, A_{\\mathrm{S2}}, A_{\\mathrm{K1}}, A_{\\mathrm{O1}}] = [0.01, 0.01, 0.01, 0.01]$,\n  - $[\\phi_{\\mathrm{M2}}, \\phi_{\\mathrm{S2}}, \\phi_{\\mathrm{K1}}, \\phi_{\\mathrm{O1}}] = [0.0, 0.0, 0.0, 0.0]$.\n\nYour program should:\n- Use the specified $\\mathrm{M2}$, $\\mathrm{S2}$, $\\mathrm{K1}$, $\\mathrm{O1}$ periods to construct $\\omega_j$,\n- Construct $v(t_k)$ on the uniform grid for each case,\n- Compute $P(t_k) = \\tfrac{1}{2}\\rho |v(t_k)|^3$ with $\\rho = 1025$ in $\\mathrm{kg/m^3}$,\n- Compute $\\overline{P}$ for each case and round to exactly $6$ decimal places.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $\\big[\\overline{P}_{\\mathrm{A}}, \\overline{P}_{\\mathrm{B}}, \\overline{P}_{\\mathrm{C}}, \\overline{P}_{\\mathrm{D}}\\big]$. For example, the format must be exactly like $\\big[1.234000,5.678900,2.500000,0.000001\\big]$ with each entry in $\\mathrm{W/m^2}$.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and provides a complete, consistent set of specifications for a direct computational task. The solution requires the construction of a tidal current velocity time series and the subsequent calculation of the average kinetic power flux. The process follows established principles of harmonic analysis and fluid dynamics.\n\nThe fundamental principle is that a stationary tidal current signal can be represented as a superposition of a finite number of harmonic constituents. The velocity $v(t)$ along a fixed axis at time $t$ (in hours) is given by the sum:\n$$\nv(t) = \\sum_{j} A_j \\cos(\\omega_j t + \\phi_j)\n$$\nHere, $j$ indexes the tidal constituents ($\\mathrm{M2}$, $\\mathrm{S2}$, $\\mathrm{K1}$, $\\mathrm{O1}$). For each constituent $j$, $A_j$ is the velocity amplitude (in $\\mathrm{m/s}$), $\\phi_j$ is the phase offset (in radians), and $\\omega_j$ is the angular frequency (in radians per hour).\n\nThe angular frequencies $\\omega_j$ are derived from the astronomical periods $T_j$ of each constituent using the relationship:\n$$\n\\omega_j = \\frac{2\\pi}{T_j}\n$$\nThe periods for the four specified constituents are given as constants:\n- $T_{\\mathrm{M2}} = 12.4206012$ hours\n- $T_{\\mathrm{S2}} = 12.0$ hours\n- $T_{\\mathrm{K1}} = 23.93447213$ hours\n- $T_{\\mathrm{O1}} = 25.81934166$ hours\n\nThe kinetic power flux, $P(t)$, which represents the kinetic energy flowing per unit time per unit area perpendicular to the flow, is given by the formula for a fluid of density $\\rho$ moving at speed $|v(t)|$:\n$$\nP(t) = \\tfrac{1}{2}\\,\\rho\\,|v(t)|^3\n$$\nThe problem specifies the density of seawater as $\\rho = 1025$ $\\mathrm{kg/m^3}$. With velocity in $\\mathrm{m/s}$, the resulting power flux $P(t)$ is in units of Watts per square meter ($\\mathrm{W/m^2}$).\n\nThe objective is to compute the time-average power flux, $\\overline{P}$, over a given time horizon $T$. Since an analytical solution for the average of $|\\sum_j \\dots|^3$ is intractable, a numerical approach based on discrete time-averaging is employed. Time is discretized into a uniform grid:\n$$\nt_k = k\\,\\Delta t, \\quad \\text{for } k \\in \\{0, 1, 2, \\dots, N-1\\}\n$$\nwhere $\\Delta t$ is the time step in hours, and $N$ is the total number of samples, defined as:\n$$\nN = \\left\\lfloor \\frac{T}{\\Delta t} \\right\\rfloor\n$$\nThe average power flux $\\overline{P}$ is then estimated using the discrete-time arithmetic mean over the $N$ samples:\n$$\n\\overline{P} = \\frac{1}{N} \\sum_{k=0}^{N-1} P(t_k) = \\frac{1}{N} \\sum_{k=0}^{N-1} \\left( \\tfrac{1}{2}\\,\\rho\\,|v(t_k)|^3 \\right)\n$$\n\nThe computational algorithm for each test case is as follows:\n1.  **Initialization**: The angular frequencies $\\omega_j$ for the $\\mathrm{M2}$, $\\mathrm{S2}$, $\\mathrm{K1}$, and $\\mathrm{O1}$ constituents are pre-calculated from their respective periods $T_j$.\n2.  **Time Discretization**: For a given test case with horizon $T$ and time step $\\Delta t$, the number of samples $N$ is calculated. A time vector $t$ of length $N$ is generated, representing the discrete time points $t_k$.\n3.  **Velocity Time Series Construction**: An empty velocity vector $v$ of length $N$ is initialized. For each of the four constituents, its contribution to the velocity, $A_j \\cos(\\omega_j t_k + \\phi_j)$, is calculated for all time steps $t_k$ and added to the total velocity vector $v$.\n4.  **Power Flux Calculation**: The instantaneous speed is found by taking the absolute value of the velocity vector, $|v(t_k)|$. The power flux time series $P(t_k)$ is then computed element-wise using the power flux formula $P(t_k) = \\frac{1}{2} \\rho |v(t_k)|^3$.\n5.  **Averaging**: The average power flux $\\overline{P}$ is computed by taking the arithmetic mean of the power flux time series vector $P(t_k)$.\n6.  **Output Formatting**: The process is repeated for all four test cases. The final results are rounded to exactly $6$ decimal places and formatted into the specified output string.\n\nThis procedure, implemented with high-precision floating-point arithmetic, yields a deterministic and verifiable result for each set of input parameters.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the average tidal current power flux for specified harmonic constituents.\n    \"\"\"\n    # Define physical and numerical constants\n    RHO = 1025.0  # Density of seawater in kg/m^3\n\n    # Astronomical periods of the four principal tidal constituents in hours\n    # Order: M2, S2, K1, O1\n    PERIODS = np.array([\n        12.4206012,      # M2: Principal lunar semidiurnal\n        12.0,            # S2: Principal solar semidiurnal\n        23.93447213,     # K1: Luni-solar diurnal\n        25.81934166      # O1: Principal lunar diurnal\n    ], dtype=np.float64)\n    \n    # Calculate angular frequencies in radians per hour\n    OMEGAS = 2 * np.pi / PERIODS\n    \n    # Define the test suite as a list of tuples.\n    # Each tuple contains: (T, dt, Amplitudes, Phases)\n    test_cases = [\n        # Case A: General multiharmonic over two spring-neap cycles\n        (336.0, 0.25, [1.0, 0.35, 0.25, 0.15], [0.4, -1.1, 1.6, -0.3]),\n        \n        # Case B: Single-constituent boundary with integer multiples of the period\n        (10 * 12.4206012, 0.05, [1.5, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0]),\n        \n        # Case C: Diurnal-dominated with phase offsets\n        (168.0, 0.2, [0.6, 0.3, 1.2, 0.8], [np.pi/3, -np.pi/4, np.pi/2, -np.pi/6]),\n        \n        # Case D: Near-zero amplitudes to probe numerical stability\n        (48.0, 0.5, [0.01, 0.01, 0.01, 0.01], [0.0, 0.0, 0.0, 0.0])\n    ]\n\n    results = []\n    \n    for T_horizon, dt, amps_list, phases_list in test_cases:\n        amps = np.array(amps_list, dtype=np.float64)\n        phases = np.array(phases_list, dtype=np.float64)\n        \n        # 1. Discretize time\n        # N is the number of samples for the given horizon T and time step dt.\n        N = int(np.floor(T_horizon / dt))\n        # t is the time vector from t=0 to t=(N-1)*dt.\n        t = np.arange(N, dtype=np.float64) * dt\n        \n        # 2. Calculate velocity time series v(t)\n        # Initialize velocity vector with zeros. Use float64 for precision.\n        v = np.zeros(N, dtype=np.float64)\n        \n        # Sum the contributions of each harmonic constituent\n        for j in range(len(OMEGAS)):\n            # Add component v_j(t) = A_j * cos(omega_j * t + phi_j)\n            v += amps[j] * np.cos(OMEGAS[j] * t + phases[j])\n            \n        # 3. Calculate power flux time series P(t)\n        # P(t) = 1/2 * rho * |v(t)|^3\n        # np.abs() calculates the speed |v(t)| from the 1D velocity v(t).\n        P = 0.5 * RHO * np.power(np.abs(v), 3)\n        \n        # 4. Compute average power flux\n        # Use the discrete arithmetic mean as the estimator for the time-average.\n        P_avg = np.mean(P)\n        results.append(P_avg)\n\n    # Format the final results to exactly 6 decimal places and print\n    # in the required format: [result_A,result_B,result_C,result_D]\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Raw time series from numerical weather models often contain systematic biases that must be corrected before they can be used in energy system analysis. This practice  delves into quantile mapping, a powerful statistical method for calibrating a modeled wind speed distribution $F_{\\text{mod}}$ against a more accurate observed distribution $F_{\\text{obs}}$. By deriving and applying the transformation $v_{\\text{corr}} = F_{\\text{obs}}^{-1}(F_{\\text{mod}}(v_{\\text{mod}}))$, you will learn how to create a bias-corrected availability series and compute its expected value, a crucial skill for realistic resource assessment.",
            "id": "4115842",
            "problem": "A wind energy analyst aims to construct an availability time series for a wind farm by correcting a modeled wind speed time series using a distribution-preserving mapping and then applying a turbine power curve. Let the modeled wind speed be a continuous random variable $v_{\\text{mod}}$ with cumulative distribution function (CDF) $F_{\\text{mod}}(v)$ and probability density function (PDF) $f_{\\text{mod}}(v)$, and let the observationally calibrated wind speed distribution at the site be described by a CDF $F_{\\text{obs}}(v)$ and a PDF $f_{\\text{obs}}(v)$. Assume all CDFs are strictly increasing on their support and continuously differentiable. The corrected wind speed $v_{\\text{corr}}$ is defined to be a monotone transformation of $v_{\\text{mod}}$ that preserves cumulative probabilities so that the corrected variable follows the observed distribution.\n\nThe wind turbine is characterized by a standard idealized power curve with cut-in speed $v_{ci} > 0$, rated speed $v_{r} > v_{ci}$, and cut-out speed $v_{co} > v_{r}$. The electrical power $P(v)$ produced at wind speed $v$ and the rated power $P_{r}$ satisfy $P(v) = 0$ for $v < v_{ci}$, $P(v) = P_{r} \\left( \\frac{v}{v_{r}} \\right)^{3}$ for $v \\in [v_{ci}, v_{r}]$, $P(v) = P_{r}$ for $v \\in [v_{r}, v_{co}]$, and $P(v) = 0$ for $v > v_{co}$. The availability at time $t$ is defined as the fraction of rated output $A(t) = \\frac{P(v(t))}{P_{r}}$.\n\nAssume the modeled and observed wind speed distributions are each Weibull with strictly positive shape and scale parameters: $F_{\\text{mod}}(v) = 1 - \\exp\\!\\left( - \\left( \\frac{v}{c_{m}} \\right)^{k_{m}} \\right)$ and $F_{\\text{obs}}(v) = 1 - \\exp\\!\\left( - \\left( \\frac{v}{c_{o}} \\right)^{k_{o}} \\right)$, with $k_{m} > 0$, $c_{m} > 0$, $k_{o} > 0$, and $c_{o} > 0$.\n\nTasks:\n1. Using fundamental definitions from probability theory, derive the unique monotone mapping $v_{\\text{corr}}$ that sends realizations of $v_{\\text{mod}}$ to realizations that follow $F_{\\text{obs}}$, by requiring equality of cumulative probabilities under the mapping. Express $v_{\\text{corr}}$ explicitly in terms of $F_{\\text{mod}}$, $F_{\\text{obs}}$, and $v_{\\text{mod}}$ without introducing any additional assumptions beyond continuity and strict monotonicity of the CDFs.\n2. Specialize your result to the case of Weibull distributions given above and obtain a closed-form expression for $v_{\\text{corr}}$ as a function of $v_{\\text{mod}}$, $k_{m}$, $c_{m}$, $k_{o}$, and $c_{o}$.\n3. Define the corrected availability function $A_{\\text{corr}}(v_{\\text{mod}})$ by composing the power curve with your mapping from part 2. Identify the thresholds in $v_{\\text{mod}}$ corresponding to $v_{ci}$, $v_{r}$, and $v_{co}$ under this mapping.\n4. Compute the expected corrected availability (i.e., the corrected capacity factor) $\\mathbb{E}[A_{\\text{corr}}(V_{\\text{mod}})]$, where $V_{\\text{mod}} \\sim \\text{Weibull}(k_{m}, c_{m})$. Express your final result as a single closed-form analytic expression in terms of $v_{ci}$, $v_{r}$, $v_{co}$, $k_{o}$, and $c_{o}$, and standard special functions if needed. Express the final answer as a dimensionless fraction (do not use a percentage sign). No numerical substitution or rounding is required.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- Modeled wind speed: random variable $v_{\\text{mod}}$, CDF $F_{\\text{mod}}(v)$, PDF $f_{\\text{mod}}(v)$.\n- Observed wind speed: random variable with CDF $F_{\\text{obs}}(v)$, PDF $f_{\\text{obs}}(v)$.\n- Assumption: CDFs are strictly increasing and continuously differentiable.\n- Corrected wind speed $v_{\\text{corr}}$ is a monotone transformation of $v_{\\text{mod}}$ such that the distribution of $v_{\\text{corr}}$ is described by $F_{\\text{obs}}(v)$.\n- Power curve $P(v)$ with rated power $P_r$:\n  - $v_{ci}$: cut-in speed, $v_{ci} > 0$.\n  - $v_{r}$: rated speed, $v_{r} > v_{ci}$.\n  - $v_{co}$: cut-out speed, $v_{co} > v_r$.\n  - $P(v) = 0$ for $v < v_{ci}$ or $v > v_{co}$.\n  - $P(v) = P_{r} \\left( \\frac{v}{v_{r}} \\right)^{3}$ for $v \\in [v_{ci}, v_{r}]$.\n  - $P(v) = P_{r}$ for $v \\in [v_{r}, v_{co}]$.\n- Availability: $A(t) = \\frac{P(v(t))}{P_{r}}$.\n- Modeled CDF: $F_{\\text{mod}}(v) = 1 - \\exp\\left( - \\left( \\frac{v}{c_{m}} \\right)^{k_{m}} \\right)$ with shape $k_{m} > 0$ and scale $c_{m} > 0$.\n- Observed CDF: $F_{\\text{obs}}(v) = 1 - \\exp\\left( - \\left( \\frac{v}{c_{o}} \\right)^{k_{o}} \\right)$ with shape $k_{o} > 0$ and scale $c_{o} > 0$.\n- Tasks:\n  1. Derive the general mapping $v_{\\text{corr}}(v_{\\text{mod}})$.\n  2. Specialize the mapping for the given Weibull distributions.\n  3. Define the corrected availability $A_{\\text{corr}}(v_{\\text{mod}})$ and find thresholds in $v_{\\text{mod}}$.\n  4. Compute the expected corrected availability $\\mathbb{E}[A_{\\text{corr}}(V_{\\text{mod}})]$ in terms of $v_{ci}, v_{r}, v_{co}, k_{o}, c_{o}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n- **Scientifically Grounded:** The problem uses established statistical methods (quantile mapping, also known as distribution mapping or statistical calibration) commonly applied in climate science and energy systems modeling to correct biases in model outputs. The use of Weibull distributions for wind speed and an idealized power curve are standard practices in wind energy analysis. The problem is fundamentally sound.\n- **Well-Posed:** All necessary functions and parameters are defined. The condition that CDFs are strictly increasing ensures that their inverses (quantile functions) are well-defined, which is critical for the derivation. The tasks are specified clearly and lead to a unique mathematical solution.\n- **Objective:** The problem is stated using formal, objective mathematical language, free from subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is self-contained, scientifically grounded, and well-posed. The solution process may proceed.\n\n---\n\nThe solution is developed by addressing each task sequentially.\n\n**Task 1: Derive the general monotone mapping**\nThe requirement is that the corrected variable $v_{\\text{corr}}$ follows the observed distribution $F_{\\text{obs}}$, and that the mapping from $v_{\\text{mod}}$ to $v_{\\text{corr}}$ preserves cumulative probabilities. This means that for any realization $v_{\\text{mod}}$ and its corresponding transformed value $v_{\\text{corr}}$, the probability of a random value from the modeled distribution being less than or equal to $v_{\\text{mod}}$ must equal the probability of a random value from the observed distribution being less than or equal to $v_{\\text{corr}}$.\n\nLet $V_{\\text{mod}}$ be the random variable for modeled speed and $V_{\\text{corr}}$ be for the corrected speed. The condition is:\n$$P(V_{\\text{mod}} \\le v_{\\text{mod}}) = P(V_{\\text{corr}} \\le v_{\\text{corr}})$$\nBy definition of the CDF, and the fact that $V_{\\text{corr}}$ follows the observed distribution, this becomes:\n$$F_{\\text{mod}}(v_{\\text{mod}}) = F_{\\text{obs}}(v_{\\text{corr}})$$\nTo solve for $v_{\\text{corr}}$ as a function of $v_{\\text{mod}}$, we must apply the inverse of the function $F_{\\text{obs}}$. Since $F_{\\text{obs}}$ is given as strictly increasing and continuous, its inverse function, the quantile function $F_{\\text{obs}}^{-1}$, is well-defined. Applying it to both sides of the equation yields the unique monotone mapping:\n$$v_{\\text{corr}}(v_{\\text{mod}}) = F_{\\text{obs}}^{-1}\\left( F_{\\text{mod}}(v_{\\text{mod}}) \\right)$$\nThis technique is known as quantile mapping.\n\n**Task 2: Specialize for Weibull distributions**\nFirst, we find the inverse CDF $F_{\\text{obs}}^{-1}(u)$ for the observed Weibull distribution. Let $u = F_{\\text{obs}}(v)$.\n$$u = 1 - \\exp\\left( - \\left( \\frac{v}{c_{o}} \\right)^{k_{o}} \\right)$$\nSolving for $v$:\n$$1 - u = \\exp\\left( - \\left( \\frac{v}{c_{o}} \\right)^{k_{o}} \\right)$$\n$$\\ln(1 - u) = - \\left( \\frac{v}{c_{o}} \\right)^{k_{o}}$$\n$$-\\ln(1 - u) = \\left( \\frac{v}{c_{o}} \\right)^{k_{o}}$$\n$$v = c_{o} \\left( -\\ln(1 - u) \\right)^{\\frac{1}{k_{o}}}$$\nThus, the quantile function is $F_{\\text{obs}}^{-1}(u) = c_{o} \\left( -\\ln(1 - u) \\right)^{1/k_{o}}$.\n\nNow, we substitute $u = F_{\\text{mod}}(v_{\\text{mod}})$ into this expression.\n$$u = F_{\\text{mod}}(v_{\\text{mod}}) = 1 - \\exp\\left( - \\left( \\frac{v_{\\text{mod}}}{c_{m}} \\right)^{k_{m}} \\right)$$\nThis gives $1 - u = \\exp\\left( - \\left( \\frac{v_{\\text{mod}}}{c_{m}} \\right)^{k_{m}} \\right)$.\nSubstituting this into the expression for $v_{\\text{corr}}$:\n$$v_{\\text{corr}} = c_{o} \\left( -\\ln\\left( \\exp\\left( - \\left( \\frac{v_{\\text{mod}}}{c_{m}} \\right)^{k_{m}} \\right) \\right) \\right)^{\\frac{1}{k_{o}}}$$\n$$v_{\\text{corr}} = c_{o} \\left( \\left( \\frac{v_{\\text{mod}}}{c_{m}} \\right)^{k_{m}} \\right)^{\\frac{1}{k_{o}}}$$\nThe closed-form expression for the mapping is:\n$$v_{\\text{corr}}(v_{\\text{mod}}) = c_{o} \\left( \\frac{v_{\\text{mod}}}{c_{m}} \\right)^{\\frac{k_{m}}{k_{o}}}$$\n\n**Task 3: Corrected availability and thresholds**\nThe availability function is $A(v) = P(v)/P_r$. The corrected availability $A_{\\text{corr}}(v_{\\text{mod}})$ is found by composing $A(v)$ with the mapping $v_{\\text{corr}}(v_{\\text{mod}})$.\n$$A_{\\text{corr}}(v_{\\text{mod}}) = \\frac{P(v_{\\text{corr}}(v_{\\text{mod}}))}{P_r} =\n\\begin{cases}\n0 & v_{\\text{corr}} < v_{ci} \\\\\n\\left( \\frac{v_{\\text{corr}}}{v_{r}} \\right)^{3} & v_{ci} \\le v_{\\text{corr}} < v_{r} \\\\\n1 & v_{r} \\le v_{\\text{corr}} < v_{co} \\\\\n0 & v_{\\text{corr}} \\ge v_{co}\n\\end{cases}\n$$\nThe thresholds in $v_{\\text{mod}}$ are found by inverting the mapping from Task 2 to express $v_{\\text{mod}}$ in terms of $v_{\\text{corr}}$.\nFrom $v_{\\text{corr}} = c_{o} \\left( \\frac{v_{\\text{mod}}}{c_{m}} \\right)^{k_{m}/k_{o}}$, we solve for $v_{\\text{mod}}$:\n$$\\frac{v_{\\text{corr}}}{c_{o}} = \\left( \\frac{v_{\\text{mod}}}{c_{m}} \\right)^{\\frac{k_{m}}{k_{o}}}$$\n$$\\left( \\frac{v_{\\text{corr}}}{c_{o}} \\right)^{\\frac{k_{o}}{k_{m}}} = \\frac{v_{\\text{mod}}}{c_{m}}$$\n$$v_{\\text{mod}}(v_{\\text{corr}}) = c_{m} \\left( \\frac{v_{\\text{corr}}}{c_{o}} \\right)^{\\frac{k_{o}}{k_{m}}}$$\nThe thresholds in $v_{\\text{mod}}$ are:\n- $v_{\\text{mod},ci} = c_{m} \\left( \\frac{v_{ci}}{c_{o}} \\right)^{k_{o}/k_{m}}$\n- $v_{\\text{mod},r} = c_{m} \\left( \\frac{v_{r}}{c_{o}} \\right)^{k_{o}/k_{m}}$\n- $v_{\\text{mod},co} = c_{m} \\left( \\frac{v_{co}}{c_{o}} \\right)^{k_{o}/k_{m}}$\n\n**Task 4: Expected corrected availability**\nWe need to compute $\\mathbb{E}[A_{\\text{corr}}(V_{\\text{mod}})]$, where $V_{\\text{mod}} \\sim \\text{Weibull}(k_{m}, c_{m})$. A fundamental property of this transformation is that the expectation of a function of the corrected variable can be computed over the target distribution. That is, if $g(v)$ is any function, then $\\mathbb{E}[g(V_{\\text{corr}})] = \\int g(v) f_{\\text{obs}}(v) dv$.\nBy construction, $V_{\\text{corr}}$ is a random variable following the observed distribution, $F_{\\text{obs}}$. Therefore,\n$$\\mathbb{E}[A_{\\text{corr}}(V_{\\text{mod}})] = \\mathbb{E}[A(V_{\\text{corr}})]$$\nwhere the expectation is taken over the distribution of $V_{\\text{corr}}$, which is the observed Weibull distribution with parameters $k_{o}$ and $c_{o}$. This insight simplifies the problem greatly, as the parameters $k_m$ and $c_m$ are no longer needed for this calculation, as requested by the problem statement.\nThe expected availability is given by the integral:\n$$\\mathbb{E}[A] = \\int_{0}^{\\infty} A(v) f_{\\text{obs}}(v) dv$$\nUsing the piecewise definition of $A(v)$:\n$$\\mathbb{E}[A] = \\int_{v_{ci}}^{v_{r}} \\left(\\frac{v}{v_{r}}\\right)^3 f_{\\text{obs}}(v) dv + \\int_{v_{r}}^{v_{co}} 1 \\cdot f_{\\text{obs}}(v) dv$$\nThe second integral is straightforward:\n$$\\int_{v_{r}}^{v_{co}} f_{\\text{obs}}(v) dv = F_{\\text{obs}}(v_{co}) - F_{\\text{obs}}(v_{r}) = \\left(1 - \\exp\\left(-\\left(\\frac{v_{co}}{c_{o}}\\right)^{k_{o}}\\right)\\right) - \\left(1 - \\exp\\left(-\\left(\\frac{v_{r}}{c_{o}}\\right)^{k_{o}}\\right)\\right)$$\n$$= \\exp\\left(-\\left(\\frac{v_{r}}{c_{o}}\\right)^{k_{o}}\\right) - \\exp\\left(-\\left(\\frac{v_{co}}{c_{o}}\\right)^{k_{o}}\\right)$$\nFor the first integral, let's substitute the Weibull PDF $f_{\\text{obs}}(v) = \\frac{k_{o}}{c_{o}} \\left( \\frac{v}{c_{o}} \\right)^{k_{o}-1} \\exp\\left( - \\left( \\frac{v}{c_{o}} \\right)^{k_{o}} \\right)$.\nThe integral is $\\frac{1}{v_r^3}\\int_{v_{ci}}^{v_{r}} v^3 f_{\\text{obs}}(v) dv$. We perform a change of variables. Let $x = (v/c_{o})^{k_{o}}$. Then $v = c_o x^{1/k_o}$. The differential is $dv = c_o \\frac{1}{k_o} x^{\\frac{1}{k_o}-1} dx$.\nAlternatively, and more simply, notice that $dx = \\frac{k_o}{c_o} (\\frac{v}{c_o})^{k_o-1} dv$. This means $f_{\\text{obs}}(v) dv = \\exp(-x) dx$.\nWe express $v^3$ in terms of $x$: $v^3 = (c_o x^{1/k_o})^3 = c_o^3 x^{3/k_o}$.\nThe limits of integration change from $v \\in [v_{ci}, v_{r}]$ to $x \\in [x_{ci}, x_{r}]$, where $x_{ci} = (v_{ci}/c_{o})^{k_{o}}$ and $x_{r} = (v_{r}/c_{o})^{k_{o}}$.\nThe integral becomes:\n$$\\frac{1}{v_r^3} \\int_{x_{ci}}^{x_{r}} \\left(c_o^3 x^{3/k_o}\\right) \\exp(-x) dx = \\frac{c_o^3}{v_r^3} \\int_{x_{ci}}^{x_{r}} x^{3/k_o} \\exp(-x) dx$$\nThis integral is defined in terms of the lower incomplete gamma function, $\\gamma(s, z) = \\int_0^z t^{s-1} e^{-t} dt$.\nOur integral has the form $\\int x^{a} e^{-x} dx$, where $a = 3/k_o$. We match this to the definition of $\\gamma(s,z)$ by setting $s-1 = a$, so $s = 1+a = 1 + 3/k_o$.\n$$\\int_{x_{ci}}^{x_{r}} x^{3/k_o} \\exp(-x) dx = \\gamma\\left(1+\\frac{3}{k_o}, x_r\\right) - \\gamma\\left(1+\\frac{3}{k_o}, x_{ci}\\right)$$\nSubstituting the expressions for $x_{ci}$ and $x_{r}$:\n$$\\frac{c_o^3}{v_r^3} \\left[ \\gamma\\left(1+\\frac{3}{k_o}, \\left(\\frac{v_r}{c_o}\\right)^{k_o}\\right) - \\gamma\\left(1+\\frac{3}{k_o}, \\left(\\frac{v_{ci}}{c_o}\\right)^{k_o}\\right) \\right]$$\nCombining the two parts gives the final expression for the expected availability:\n$$\\mathbb{E}[A] = \\frac{c_o^3}{v_r^3} \\left[ \\gamma\\left(1+\\frac{3}{k_o}, \\left(\\frac{v_r}{c_o}\\right)^{k_o}\\right) - \\gamma\\left(1+\\frac{3}{k_o}, \\left(\\frac{v_{ci}}{c_o}\\right)^{k_o}\\right) \\right] + \\exp\\left(-\\left(\\frac{v_{r}}{c_{o}}\\right)^{k_{o}}\\right) - \\exp\\left(-\\left(\\frac{v_{co}}{c_{o}}\\right)^{k_{o}}\\right)$$\nThis expression is the corrected capacity factor, expressed solely in terms of the observed distribution parameters and the turbine characteristics, as required.",
            "answer": "$$\n\\boxed{\n\\frac{c_o^3}{v_r^3} \\left[ \\gamma\\left(1+\\frac{3}{k_o}, \\left(\\frac{v_r}{c_o}\\right)^{k_o}\\right) - \\gamma\\left(1+\\frac{3}{k_o}, \\left(\\frac{v_{ci}}{c_o}\\right)^{k_o}\\right) \\right] + \\exp\\left(-\\left(\\frac{v_{r}}{c_{o}}\\right)^{k_{o}}\\right) - \\exp\\left(-\\left(\\frac{v_{co}}{c_{o}}\\right)^{k_{o}}\\right)\n}\n$$"
        },
        {
            "introduction": "Energy system models often require input data at specific temporal resolutions, making the resampling of time series a common and critical task. This exercise  focuses on performing this task while upholding a crucial physical constraint: the conservation of energy. You will design and implement both downsampling (e.g., 15-minute to hourly) and upsampling schemes, ensuring that the total energy, calculated as the integral of power $\\int P(t) dt$, remains invariant across different time resolutions.",
            "id": "4115891",
            "problem": "You are tasked with designing and implementing an energy-preserving resampling and interpolation scheme between quarter-hour availability profiles and hourly availability profiles in the context of energy systems modeling. Consider a power time series represented as a function $P(t)$ measured in kilowatts (kW), where $t$ is time measured in hours. The energy over an interval $[a,b]$ is defined as $E_{[a,b]} = \\int_a^b P(t)\\, dt$ in kilowatt-hours (kWh). In discrete time, with a uniform sampling interval $\\Delta t$, a common modeling assumption is that $P(t)$ is piecewise constant on each sampling interval. Under this assumption, the energy over a collection of intervals is given by the Riemann sum $E = \\sum_i P_i \\Delta t$, where $P_i$ is the constant power over interval $i$.\n\nYour program must construct a scheme that preserves energy (i.e., the time integral of power) when converting:\n- from quarter-hour ($\\Delta t = 0.25$ hours) to hourly ($\\Delta t = 1$ hour), and\n- from hourly to quarter-hour.\n\nYou must adhere to the following scientific constraints:\n- Downsampling from quarter-hour to hourly must produce an hourly time series $\\{\\hat{P}_h\\}$ where each $\\hat{P}_h$ is the hourly average power such that the hourly energy equals the sum of the quarter-hour energies within that hour.\n- Upsampling from hourly to quarter-hour must produce a quarter-hour time series $\\{p_{h,j}\\}$ ($j=1,\\dots,4$ per hour) that preserves the hourly energy for each hour.\n\nDefinitions and requirements:\n- Let $P_k$ denote the quarter-hour power samples (in kW), with $k$ indexing quarter-hours over a day ($96$ samples).\n- Let $\\hat{P}_h$ denote the hourly power samples (in kW), with $h$ indexing hours over a day ($24$ samples).\n- Quarter-hour energy is $E_{\\text{15min}} = \\sum_{k=0}^{95} P_k \\cdot 0.25$ in kWh.\n- Hourly energy is $E_{\\text{hour}} = \\sum_{h=0}^{23} \\hat{P}_h \\cdot 1$ in kWh.\n- Angles used in any trigonometric function must be in radians.\n\nYour program must implement:\n1. A function that takes a quarter-hour series $\\{P_k\\}$ and returns the hourly series $\\{\\hat{P}_h\\}$ such that energy is preserved when aggregating from $15$ minutes to $1$ hour.\n2. A function that takes an hourly series $\\{\\hat{P}_h\\}$ and returns a quarter-hour series $\\{p_{h,j}\\}$ such that energy is preserved when disaggregating from $1$ hour to $15$ minutes.\n\nTest suite:\nImplement the following test cases to verify energy preservation. For each case, compute the absolute difference in total energy (in kWh) between the original series and the series obtained after a round-trip conversion that should preserve energy. Each test case should yield a single float (in kWh). Your final output must be a single line containing all results as a comma-separated list enclosed in square brackets.\n\nQuarter-hour to hourly to quarter-hour (15→60→15):\n- Test $1$ (solar-like quarter-hour profile): Let $P_{\\max} = 100$ (kW). For $t_k = k \\cdot 0.25$ with $k \\in \\{0,1,\\dots,95\\}$, define $P_k = \\max\\{0, P_{\\max} \\cdot \\sin\\left(\\pi \\cdot \\frac{t_k - 6}{12}\\right)\\}$ for $t_k \\in [0,24)$, with angles in radians.\n- Test $2$ (single-hour linear ramp quarter-hour profile): Define a linear ramp during hour $8$ to $9$ from $0$ (kW) to $80$ (kW). Represent $P_k$ as the average power over each quarter-hour subinterval using the midpoint of each subinterval in $[8,9)$ hours, yielding quarter-hour values of $10$, $30$, $50$, and $70$ (kW) only within $[8,9)$; elsewhere $P_k = 0$ (kW).\n- Test $3$ (constant quarter-hour profile): $P_k = 50$ (kW) for all $k$.\n- Test $4$ (deterministic pseudo-random quarter-hour profile): Use a fixed seed to generate $96$ deterministic samples uniformly in $[0,100]$ (kW).\n\nHourly to quarter-hour to hourly (60→15→60):\n- Test $5$ (triangular hourly profile): For $h \\in \\{0,1,\\dots,23\\}$, define $\\hat{P}_h = \\max\\{0, 100 \\cdot (1 - |h - 12|/6)\\}$ (kW).\n- Test $6$ (spiky hourly profile): For $h \\in \\{0,1,\\dots,23\\}$, define $\\hat{P}_h = 100$ (kW) if $h$ is even, and $\\hat{P}_h = 0$ (kW) if $h$ is odd.\n\nUnit requirements:\n- All power values must be interpreted in kilowatts (kW).\n- All energy values must be computed and reported in kilowatt-hours (kWh).\n- All angles for trigonometric functions must be in radians.\n- The program must compute the absolute total energy differences for the round-trip conversions and report them in kWh.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for the $6$ tests in order $1$ through $6$. For example, the format must be $[r_1,r_2,r_3,r_4,r_5,r_6]$, where each $r_i$ is a float (in kWh).",
            "solution": "The problem requires the design and implementation of an energy-preserving resampling scheme for power time series between quarter-hour and hourly resolutions. The core principle is the conservation of energy, defined as the time integral of power, $E = \\int P(t) dt$. For discrete time series with a piecewise constant power assumption over sampling intervals of duration $\\Delta t$, this integral becomes a sum: $E = \\sum_i P_i \\Delta t$.\n\nFirst, we establish the mathematical formalisms for the two required conversion functions.\n\n**1. Downsampling: Quarter-Hour to Hourly (15-min → 60-min)**\n\nLet $\\{P_k\\}_{k=0}^{95}$ be the quarter-hour power series with a time step of $\\Delta t_{15} = 0.25$ hours. Let $\\{\\hat{P}_h\\}_{h=0}^{23}$ be the corresponding hourly power series with a time step of $\\Delta t_{60} = 1.0$ hour.\n\nThe energy preservation constraint requires that the energy calculated over any given hour is the same, regardless of the resolution used. For an arbitrary hour $h$ (where $h \\in \\{0, 1, \\dots, 23\\}$), the energy calculated from the hourly series is:\n$$E_{h, \\text{hourly}} = \\hat{P}_h \\cdot \\Delta t_{60} = \\hat{P}_h \\cdot 1$$\n\nThe same hour $h$ corresponds to four quarter-hour intervals, with indices $k = 4h, 4h+1, 4h+2,$ and $4h+3$. The total energy over this hour, calculated from the quarter-hour series, is the sum of the energies of these four intervals:\n$$E_{h, \\text{15min}} = \\sum_{j=0}^{3} P_{4h+j} \\cdot \\Delta t_{15} = \\left( P_{4h} + P_{4h+1} + P_{4h+2} + P_{4h+3} \\right) \\cdot 0.25$$\n\nEquating the two expressions for energy ($E_{h, \\text{hourly}} = E_{h, \\text{15min}}$) yields the rule for determining the hourly power value $\\hat{P}_h$:\n$$\\hat{P}_h \\cdot 1 = \\left( P_{4h} + P_{4h+1} + P_{4h+2} + P_{4h+3} \\right) \\cdot 0.25$$\n$$\\hat{P}_h = \\frac{P_{4h} + P_{4h+1} + P_{4h+2} + P_{4h+3}}{4}$$\n\nThis shows that the energy-preserving downsampling operation is equivalent to taking the arithmetic mean of the four quarter-hour power values within each hour.\n\n**2. Upsampling: Hourly to Quarter-Hour (60-min → 15-min)**\n\nLet $\\{\\hat{P}_h\\}_{h=0}^{23}$ be the hourly power series. We need to determine a quarter-hour series $\\{P_k\\}_{k=0}^{95}$ that preserves the energy for each hour. The energy preservation equation for hour $h$ is the same as before:\n$$\\hat{P}_h = \\frac{1}{4} \\sum_{j=0}^{3} P_{4h+j}$$\n\nFor each hour $h$, this is a single linear equation with four unknowns: $\\{P_{4h}, P_{4h+1}, P_{4h+2}, P_{4h+3}\\}$. This is an underdetermined system, admitting infinitely many solutions. To select a unique solution, an additional assumption is necessary. The problem states from the outset that power $P(t)$ is modeled as being piecewise constant on each sampling interval. The simplest and most consistent choice for upsampling is to extend this assumption, postulating that the hourly power value $\\hat{P}_h$ represents a constant power level throughout that entire hour. This leads to the following rule:\n$$P_k = \\hat{P}_{\\lfloor k/4 \\rfloor}$$\nIn other words, all four quarter-hour power values within a given hour are set equal to the power value of that hour:\n$$P_{4h} = P_{4h+1} = P_{4h+2} = P_{4h+3} = \\hat{P}_h$$\nThis choice satisfies the energy conservation constraint, as $\\frac{1}{4}(\\hat{P}_h + \\hat{P}_h + \\hat{P}_h + \\hat{P}_h) = \\hat{P}_h$. This method, also known as zeroth-order hold or nearest-neighbor interpolation, is the chosen upsampling scheme.\n\n**3. Round-Trip Energy Conservation Analysis**\n\nThe problem asks to compute the absolute difference in total energy after a round-trip conversion.\n\n**Case A: 15-min → 60-min → 15-min**\n- An initial quarter-hour series $\\{P_k\\}$ is downsampled to an hourly series $\\{\\hat{P}_h\\}$, where $\\hat{P}_h = \\frac{1}{4}\\sum_{j=0}^{3} P_{4h+j}$.\n- This hourly series is then upsampled to a new quarter-hour series $\\{P'_k\\}$, where $P'_k = \\hat{P}_{\\lfloor k/4 \\rfloor}$.\n- The total energy of the original series is $E_{\\text{orig}} = \\Delta t_{15} \\sum_{k=0}^{95} P_k = 0.25 \\sum_{k=0}^{95} P_k$.\n- The total energy of the reconstructed series is $E_{\\text{recon}} = \\Delta t_{15} \\sum_{k=0}^{95} P'_k$.\nSubstituting the definitions:\n$$E_{\\text{recon}} = 0.25 \\sum_{h=0}^{23} \\sum_{j=0}^{3} P'_{4h+j} = 0.25 \\sum_{h=0}^{23} \\sum_{j=0}^{3} \\hat{P}_h = 0.25 \\sum_{h=0}^{23} 4\\hat{P}_h = \\sum_{h=0}^{23} \\hat{P}_h$$\nNow, substituting the formula for $\\hat{P}_h$:\n$$E_{\\text{recon}} = \\sum_{h=0}^{23} \\left( \\frac{1}{4}\\sum_{j=0}^{3} P_{4h+j} \\right) = 0.25 \\sum_{h=0}^{23} \\sum_{j=0}^{3} P_{4h+j} = 0.25 \\sum_{k=0}^{95} P_k = E_{\\text{orig}}$$\nThus, the total energy is analytically preserved for this round trip, and the absolute difference $|E_{\\text{orig}} - E_{\\text{recon}}|$ is $0$.\n\n**Case B: 60-min → 15-min → 60-min**\n- An initial hourly series $\\{\\hat{P}_h\\}$ is upsampled to a quarter-hour series $\\{P_k\\}$, where $P_k = \\hat{P}_{\\lfloor k/4 \\rfloor}$.\n- This quarter-hour series is then downsampled to a new hourly series $\\{\\hat{P}'_h\\}$.\n$$\\hat{P}'_h = \\frac{1}{4}\\sum_{j=0}^{3} P_{4h+j} = \\frac{1}{4}\\left(\\hat{P}_h + \\hat{P}_h + \\hat{P}_h + \\hat{P}_h\\right) = \\hat{P}_h$$\nThe reconstructed hourly series $\\{\\hat{P}'_h\\}$ is identical to the original series $\\{\\hat{P}_h\\}$. Consequently, their total energies, $E_{\\text{recon}} = \\sum \\hat{P}'_h \\cdot 1$ and $E_{\\text{orig}} = \\sum \\hat{P}_h \\cdot 1$, are identical. The absolute difference $|E_{\\text{orig}} - E_{\\text{recon}}|$ is also $0$.\n\nThe implementation will compute these differences for various test profiles. Any non-zero results will be attributable to floating-point arithmetic inaccuracies.",
            "answer": "```python\nimport numpy as np\n\ndef downsample_15_to_60(p_15min: np.ndarray) -> np.ndarray:\n    \"\"\"\n    Downsamples a quarter-hour power series to an hourly series by averaging.\n    This preserves energy as per the derivation.\n    \"\"\"\n    if p_15min.shape != (96,):\n        raise ValueError(\"Input must be a numpy array of shape (96,).\")\n    # Reshape the 96-sample series into 24 hours of 4 quarter-hour samples\n    # and compute the mean for each hour.\n    return p_15min.reshape(24, 4).mean(axis=1)\n\ndef upsample_60_to_15(p_60min: np.ndarray) -> np.ndarray:\n    \"\"\"\n    Upsamples an hourly power series to a quarter-hour series by repetition.\n    This preserves energy under the piecewise-constant power assumption.\n    \"\"\"\n    if p_60min.shape != (24,):\n        raise ValueError(\"Input must be a numpy array of shape (24,).\")\n    # Repeat each hourly value 4 times to create the quarter-hour series.\n    return p_60min.repeat(4)\n\ndef calculate_energy(power_series: np.ndarray, dt: float) -> float:\n    \"\"\"\n    Calculates the total energy for a time series with a given time step.\n    \"\"\"\n    return np.sum(power_series) * dt\n\ndef solve():\n    \"\"\"\n    Runs the test suite and computes the energy differences for round-trip conversions.\n    \"\"\"\n    results = []\n    \n    # --- Test Cases 1-4: 15-min -> 60-min -> 15-min ---\n\n    # Test 1: Solar-like quarter-hour profile\n    k = np.arange(96)\n    t_k = k * 0.25\n    p15_orig_1 = np.maximum(0, 100.0 * np.sin(np.pi * (t_k - 6.0) / 12.0))\n    \n    # Test 2: Single-hour linear ramp quarter-hour profile\n    p15_orig_2 = np.zeros(96)\n    p15_orig_2[32:36] = [10.0, 30.0, 50.0, 70.0]\n\n    # Test 3: Constant quarter-hour profile\n    p15_orig_3 = np.full(96, 50.0)\n\n    # Test 4: Deterministic pseudo-random quarter-hour profile\n    np.random.seed(42)\n    p15_orig_4 = np.random.uniform(0.0, 100.0, 96)\n\n    test_cases_15min = [p15_orig_1, p15_orig_2, p15_orig_3, p15_orig_4]\n\n    for p15_orig in test_cases_15min:\n        E_orig = calculate_energy(p15_orig, 0.25)\n        p60_resampled = downsample_15_to_60(p15_orig)\n        p15_recon = upsample_60_to_15(p60_resampled)\n        E_recon = calculate_energy(p15_recon, 0.25)\n        diff = np.abs(E_orig - E_recon)\n        results.append(diff)\n        \n    # --- Test Cases 5-6: 60-min -> 15-min -> 60-min ---\n\n    # Test 5: Triangular hourly profile\n    h = np.arange(24)\n    p60_orig_5 = np.maximum(0, 100.0 * (1.0 - np.abs(h - 12.0) / 6.0))\n\n    # Test 6: Spiky hourly profile\n    p60_orig_6 = 100.0 * (h % 2 == 0)\n\n    test_cases_60min = [p60_orig_5, p60_orig_6]\n\n    for p60_orig in test_cases_60min:\n        E_orig = calculate_energy(p60_orig, 1.0)\n        p15_resampled = upsample_60_to_15(p60_orig)\n        p60_recon = downsample_15_to_60(p15_resampled)\n        E_recon = calculate_energy(p60_recon, 1.0)\n        diff = np.abs(E_orig - E_recon)\n        results.append(diff)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}