{
    "hands_on_practices": [
        {
            "introduction": "The lumped capacitance model is the cornerstone of dynamic thermal system analysis, forming the basis for many first-order system models. This exercise guides you through its derivation from the first law of thermodynamics, reinforcing the connection between fundamental physical principles and the ordinary differential equations used in engineering. By solving for the step response of a thermal energy storage element, you will gain hands-on experience with the analytical solution that describes how it charges, providing essential intuition into concepts like thermal time constants and steady-state behavior. ",
            "id": "4130052",
            "problem": "A well-mixed thermal energy storage element (for example, a small, well-stirred tank or a homogenized phase change material control volume) is modeled as a single lumped node with constant thermal capacitance $C_{\\text{th}}$ (in $\\mathrm{J/K}$). The node is exposed to an ambient environment at fixed temperature $T_{\\infty}$ and loses heat by external convection, which obeys Newton’s law of cooling with an overall heat transfer coefficient $U$ (in $\\mathrm{W/(m^2\\,K)}$) over area $A$ (in $\\mathrm{m^2}$). The product $UA$ therefore has units of $\\mathrm{W/K}$. The node receives a controllable heat input rate $\\dot{Q}_{\\text{in}}(t)$ (in $\\mathrm{W}$). Assume negligible internal temperature gradients (small Biot number), constant properties, and no work or mass transfer across the boundary.\n\nUsing the first law of thermodynamics for a fixed-mass control volume and the definition of internal energy for a lumped capacity, begin from fundamental statements only (energy balance and Newton’s law of cooling) to: \n- derive the ordinary differential equation (ODE) governing the node temperature $T(t)$, and \n- solve this ODE for the step response when the input heat rate changes from $\\dot{Q}_{\\text{in}}(t)=0$ for $t0$ to $\\dot{Q}_{\\text{in}}(t)=Q_{0}$ for $t \\ge 0$, with the initial condition $T(0)=T_{\\infty}$.\n\nExpress your final answer as a single closed-form analytic expression for $T(t)$, valid for $t \\ge 0$. Express temperature in Kelvin. No numerical evaluation is required, and no rounding is needed.",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, and objective. It is based on fundamental principles of thermodynamics and heat transfer—specifically, the first law of thermodynamics and Newton's law of cooling, applied to a standard lumped capacitance model. The problem is self-contained, providing all necessary symbolic constants, a well-defined forcing function, and a clear initial condition. The assumptions, such as a small Biot number, are explicitly stated and appropriate for the model. Consequently, a unique and meaningful solution exists. We may proceed with the derivation and solution.\n\nThe problem requires two parts: first, the derivation of the governing ordinary differential equation (ODE) for the temperature $T(t)$ of the lumped node, and second, the solution of this ODE for a specific step-function heat input.\n\n**Part 1: Derivation of the Governing Ordinary Differential Equation**\n\nWe begin from the first law of thermodynamics for a closed, fixed-mass control volume undergoing a process with negligible changes in kinetic and potential energy, and no work interactions. The energy balance is stated as:\n$$\n\\frac{dE}{dt} = \\dot{Q}_{\\text{net}}\n$$\nwhere $E$ is the internal energy of the system and $\\dot{Q}_{\\text{net}}$ is the net rate of heat transfer into the system.\n\nFor a lumped capacitance system, the internal energy is a function of its temperature $T$ and thermal capacitance $C_{\\text{th}}$. The rate of change of internal energy is given by:\n$$\n\\frac{dE}{dt} = C_{\\text{th}} \\frac{dT}{dt}\n$$\nThe net rate of heat transfer, $\\dot{Q}_{\\text{net}}$, is the sum of all heat transfer rates across the control volume boundary. In this problem, there are two such terms:\n1.  A controllable heat input rate, $\\dot{Q}_{\\text{in}}(t)$.\n2.  A convective heat loss rate to the ambient environment. According to Newton's law of cooling, this heat loss is proportional to the temperature difference between the node and the ambient environment, $T(t) - T_{\\infty}$. The rate of heat loss is $\\dot{Q}_{\\text{loss}} = UA(T(t) - T_{\\infty})$.\n\nThe net heat rate is therefore the heat input minus the heat loss:\n$$\n\\dot{Q}_{\\text{net}} = \\dot{Q}_{\\text{in}}(t) - UA(T(t) - T_{\\infty})\n$$\nSubstituting the expressions for $\\frac{dE}{dt}$ and $\\dot{Q}_{\\text{net}}$ into the first law energy balance yields the governing ODE:\n$$\nC_{\\text{th}} \\frac{dT}{dt} = \\dot{Q}_{\\text{in}}(t) - UA(T(t) - T_{\\infty})\n$$\nThis is the general ODE for the temperature of the lumped node. It is a first-order, linear, non-homogeneous ordinary differential equation.\n\n**Part 2: Solution of the ODE for a Step Response**\n\nThe problem specifies the conditions for the step response for time $t \\ge 0$:\n-   The heat input rate is a constant: $\\dot{Q}_{\\text{in}}(t) = Q_0$.\n-   The initial condition is: $T(0) = T_{\\infty}$.\n\nSubstituting $\\dot{Q}_{\\text{in}}(t) = Q_0$ into the general ODE, we have:\n$$\nC_{\\text{th}} \\frac{dT}{dt} = Q_0 - UA(T - T_{\\infty})\n$$\nTo solve this ODE, we first rearrange it into the standard form $\\frac{dy}{dt} + P(t)y = Q(t)$:\n$$\nC_{\\text{th}} \\frac{dT}{dt} + UAT = Q_0 + UAT_{\\infty}\n$$\nDividing by $C_{\\text{th}}$ gives:\n$$\n\\frac{dT}{dt} + \\frac{UA}{C_{\\text{th}}}T = \\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}}\n$$\nThis is a first-order linear ODE with constant coefficients. We can solve it using an integrating factor, $I(t)$. The integrating factor is defined as $I(t) = \\exp\\left(\\int \\frac{UA}{C_{\\text{th}}} dt\\right)$, which evaluates to:\n$$\nI(t) = \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)\n$$\nMultiplying the entire ODE by $I(t)$:\n$$\n\\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) \\frac{dT}{dt} + \\frac{UA}{C_{\\text{th}}} \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) T = \\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}} \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)\n$$\nThe left-hand side is now the exact derivative of the product $T(t)I(t)$:\n$$\n\\frac{d}{dt}\\left(T \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)\\right) = \\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}} \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)\n$$\nWe integrate both sides with respect to time from $0$ to $t$:\n$$\n\\int_{0}^{t} \\frac{d}{d\\tau}\\left(T(\\tau) \\exp\\left(\\frac{UA}{C_{\\text{th}}}\\tau\\right)\\right) d\\tau = \\int_{0}^{t} \\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}} \\exp\\left(\\frac{UA}{C_{\\text{th}}}\\tau\\right) d\\tau\n$$\nEvaluating the left-hand side using the fundamental theorem of calculus:\n$$\n\\left[ T(\\tau) \\exp\\left(\\frac{UA}{C_{\\text{th}}}\\tau\\right) \\right]_{0}^{t} = T(t) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - T(0) \\exp(0)\n$$\nEvaluating the right-hand side integral:\n$$\n\\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}} \\left[ \\frac{C_{\\text{th}}}{UA} \\exp\\left(\\frac{UA}{C_{\\text{th}}}\\tau\\right) \\right]_{0}^{t} = \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) \\left[ \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - \\exp(0) \\right]\n$$\nEquating the two sides and substituting the initial condition $T(0) = T_{\\infty}$:\n$$\nT(t) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - T_{\\infty} = \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) \\left( \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - 1 \\right)\n$$\nNow, we solve for $T(t)$:\n$$\nT(t) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) = T_{\\infty} + \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right)\n$$\n$$\nT(t) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) = \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - \\frac{Q_0}{UA}\n$$\nFinally, divide by the exponential term $\\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)$ to isolate $T(t)$:\n$$\nT(t) = \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) - \\frac{Q_0}{UA} \\exp\\left(-\\frac{UA}{C_{\\text{th}}}t\\right)\n$$\nRearranging the terms yields the final expression for the temperature as a function of time for $t \\ge 0$:\n$$\nT(t) = T_{\\infty} + \\frac{Q_0}{UA} \\left( 1 - \\exp\\left(-\\frac{UA}{C_{\\text{th}}}t\\right) \\right)\n$$\nThis expression describes the temperature of the node starting from the ambient temperature $T_{\\infty}$ and exponentially approaching a new steady-state temperature of $T_{\\infty} + Q_0/(UA)$ with a characteristic thermal time constant of $\\tau = C_{\\text{th}}/(UA)$.",
            "answer": "$$\n\\boxed{T_{\\infty} + \\frac{Q_{0}}{UA} \\left( 1 - \\exp\\left(-\\frac{UA}{C_{\\text{th}}}t\\right) \\right)}\n$$"
        },
        {
            "introduction": "While lumped models are powerful, many thermal energy storage systems, such as stratified tanks or large solid media, exhibit significant internal temperature gradients. This practice moves beyond ordinary differential equations to the realm of partial differential equations by tackling the classic problem of one-dimensional heat diffusion in a semi-infinite solid. By deriving the similarity solution using the error function, you will learn a key analytical technique for distributed-parameter systems and develop a deeper understanding of how thermal energy diffuses into a storage medium over time. ",
            "id": "4130022",
            "problem": "A large stratified Thermal Energy Storage (TES) tank is approximated, over the short timescale immediately following the onset of charging, as a one-dimensional semi-infinite homogeneous solid occupying $x \\in [0,\\infty)$ with constant thermal conductivity $k$ and thermal diffusivity $\\alpha$. The solid is initially at a uniform temperature $T_i$ for $t = 0$. At $t > 0$, a Heat Transfer Fluid (HTF) instantaneously imposes a constant new temperature $T_s$ at the surface $x = 0$ through a high-conductance interface such that the boundary condition is $T(0,t) = T_s$ for all $t > 0$ and the far-field remains at the initial temperature, $\\lim_{x \\to \\infty} T(x,t) = T_i$. Assume the governing energy balance is one-dimensional heat diffusion with no internal heat generation, and take heat flux to be given by Fourier’s law with the sign convention that positive heat flux is directed into the solid.\n\nStarting from the heat diffusion equation and the stated initial and boundary conditions, derive the similarity solution consistent with a sudden surface temperature change. Use this solution to obtain an explicit closed-form analytic expression for the surface heat flux $q(0,t)$ as a function of time $t$. Express your final answer in terms of $k$, $\\alpha$, $T_s$, $T_i$, and $t$. Do not substitute numerical values. The final expression must be a single closed-form analytic expression. No rounding is required.",
            "solution": "The physical problem is the one-dimensional transient heat conduction in a semi-infinite solid, which is governed by the heat diffusion equation.\n\nThe governing partial differential equation (PDE) for the temperature $T(x,t)$ in a homogeneous medium with no internal heat generation is:\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\nwhere $\\alpha$ is the thermal diffusivity.\n\nThe problem is defined for the domain $x \\in [0, \\infty)$ and $t \\ge 0$. The initial and boundary conditions are given as:\nInitial Condition (IC): $T(x, 0) = T_i$ for $x \\ge 0$.\nBoundary Conditions (BCs):\n1. $T(0, t) = T_s$ for $t > 0$.\n2. $\\lim_{x \\to \\infty} T(x,t) = T_i$ for $t > 0$.\n\nTo simplify the problem, we introduce a non-dimensional temperature, $\\theta(x,t)$, defined as:\n$$\n\\theta(x,t) = \\frac{T(x,t) - T_i}{T_s - T_i}\n$$\nThe governing equation and conditions in terms of $\\theta$ become:\nPDE: $\\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2}$\nIC: $\\theta(x,0) = \\frac{T_i - T_i}{T_s - T_i} = 0$\nBCs:\n1. $\\theta(0, t) = \\frac{T_s - T_i}{T_s - T_i} = 1$\n2. $\\lim_{x \\to \\infty} \\theta(x,t) = \\frac{T_i - T_i}{T_s - T_i} = 0$\n\nThis problem lacks a characteristic length or time scale, which suggests a similarity solution. We combine the independent variables $x$ and $t$ into a single similarity variable $\\eta$. Based on dimensional analysis of the heat equation, a suitable form for $\\eta$ is:\n$$\n\\eta = \\frac{x}{2\\sqrt{\\alpha t}}\n$$\nWe assume the solution $\\theta(x,t)$ can be expressed as a function of $\\eta$ alone, $\\theta(x,t) = f(\\eta)$. We now transform the partial derivatives of $\\theta$ into ordinary derivatives of $f$ with respect to $\\eta$ using the chain rule:\n$$\n\\frac{\\partial \\theta}{\\partial t} = \\frac{df}{d\\eta} \\frac{\\partial \\eta}{\\partial t} = \\frac{df}{d\\eta} \\left( -\\frac{x}{4\\sqrt{\\alpha} t^{3/2}} \\right) = -\\frac{\\eta}{2t} \\frac{df}{d\\eta}\n$$\n$$\n\\frac{\\partial \\theta}{\\partial x} = \\frac{df}{d\\eta} \\frac{\\partial \\eta}{\\partial x} = \\frac{df}{d\\eta} \\left( \\frac{1}{2\\sqrt{\\alpha t}} \\right)\n$$\n$$\n\\frac{\\partial^2 \\theta}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left( \\frac{1}{2\\sqrt{\\alpha t}} \\frac{df}{d\\eta} \\right) = \\frac{1}{2\\sqrt{\\alpha t}} \\frac{d^2 f}{d\\eta^2} \\frac{\\partial \\eta}{\\partial x} = \\frac{1}{4\\alpha t} \\frac{d^2 f}{d\\eta^2}\n$$\nSubstituting these into the heat equation for $\\theta$:\n$$\n-\\frac{\\eta}{2t} \\frac{df}{d\\eta} = \\alpha \\left( \\frac{1}{4\\alpha t} \\frac{d^2 f}{d\\eta^2} \\right)\n$$\nSimplifying this expression yields a second-order ordinary differential equation (ODE) for $f(\\eta)$:\n$$\n\\frac{d^2 f}{d\\eta^2} + 2\\eta \\frac{df}{d\\eta} = 0\n$$\nThe boundary conditions for $\\theta$ transform into boundary conditions for $f(\\eta)$.\nAt $x=0$, $\\eta=0$, so $\\theta(0,t)=1$ becomes $f(0)=1$.\nAs $x \\to \\infty$, $\\eta \\to \\infty$, so $\\lim_{x \\to \\infty} \\theta(x,t)=0$ becomes $\\lim_{\\eta \\to \\infty} f(\\eta) = 0$.\n\nTo solve the ODE, let $g(\\eta) = \\frac{df}{d\\eta}$. The equation becomes a first-order separable ODE:\n$$\n\\frac{dg}{d\\eta} = -2\\eta g \\implies \\frac{dg}{g} = -2\\eta d\\eta\n$$\nIntegrating both sides gives $\\ln(g) = -\\eta^2 + C_1$, which means $g(\\eta) = C_2 \\exp(-\\eta^2)$, where $C_2 = \\exp(C_1)$.\nSubstituting back $g(\\eta) = \\frac{df}{d\\eta}$:\n$$\n\\frac{df}{d\\eta} = C_2 \\exp(-\\eta^2)\n$$\nIntegrating with respect to $\\eta$ from $0$ to $\\eta$:\n$$\nf(\\eta) - f(0) = C_2 \\int_0^\\eta \\exp(-\\xi^2) d\\xi\n$$\nThe integral is related to the error function, $\\text{erf}(\\eta) = \\frac{2}{\\sqrt{\\pi}} \\int_0^\\eta \\exp(-\\xi^2) d\\xi$.\nThus, $f(\\eta) - f(0) = C_2 \\frac{\\sqrt{\\pi}}{2} \\text{erf}(\\eta)$.\nRearranging and letting $A = C_2 \\frac{\\sqrt{\\pi}}{2}$ and $B = f(0)$, we have the general solution form: $f(\\eta) = A \\cdot \\text{erf}(\\eta) + B$.\n\nWe apply the transformed boundary conditions to find the constants $A$ and $B$.\nFrom $f(0)=1$:\n$f(0) = A \\cdot \\text{erf}(0) + B = A \\cdot 0 + B = 1 \\implies B=1$.\nFrom $\\lim_{\\eta \\to \\infty} f(\\eta) = 0$:\n$\\lim_{\\eta \\to \\infty} (A \\cdot \\text{erf}(\\eta) + 1) = A \\cdot 1 + 1 = 0 \\implies A=-1$.\nThe solution for $f(\\eta)$ is:\n$$\nf(\\eta) = 1 - \\text{erf}(\\eta) = \\text{erfc}(\\eta)\n$$\nwhere $\\text{erfc}(\\eta)$ is the complementary error function.\n\nThe solution for the non-dimensional temperature $\\theta(x,t)$ is:\n$$\n\\theta(x,t) = \\text{erfc}\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right)\n$$\nConverting back to the dimensional temperature $T(x,t)$:\n$$\n\\frac{T(x,t) - T_i}{T_s - T_i} = \\text{erfc}\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right)\n$$\n$$\nT(x,t) = T_i + (T_s - T_i) \\text{erfc}\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right)\n$$\nThe problem asks for the surface heat flux, $q(0,t)$. Heat flux is given by Fourier's law. With the sign convention that positive flux is directed into the solid (positive $x$-direction), the formula is $q(x,t) = -k \\frac{\\partial T}{\\partial x}$.\nFirst, we find the temperature gradient, $\\frac{\\partial T}{\\partial x}$:\n$$\n\\frac{\\partial T}{\\partial x} = (T_s - T_i) \\frac{\\partial}{\\partial x} \\left[ \\text{erfc}\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right) \\right]\n$$\nUsing the chain rule and the derivative of the complementary error function, $\\frac{d}{du}(\\text{erfc}(u)) = -\\frac{2}{\\sqrt{\\pi}} \\exp(-u^2)$:\n$$\n\\frac{\\partial T}{\\partial x} = (T_s - T_i) \\left[ -\\frac{2}{\\sqrt{\\pi}} \\exp\\left(-\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right)^2\\right) \\right] \\cdot \\frac{\\partial}{\\partial x}\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right)\n$$\n$$\n\\frac{\\partial T}{\\partial x} = (T_s - T_i) \\left[ -\\frac{2}{\\sqrt{\\pi}} \\exp\\left(-\\frac{x^2}{4\\alpha t}\\right) \\right] \\left( \\frac{1}{2\\sqrt{\\alpha t}} \\right)\n$$\n$$\n\\frac{\\partial T}{\\partial x} = -(T_s - T_i) \\frac{1}{\\sqrt{\\pi \\alpha t}} \\exp\\left(-\\frac{x^2}{4\\alpha t}\\right)\n$$\nNow, we evaluate this gradient at the surface, $x=0$:\n$$\n\\left. \\frac{\\partial T}{\\partial x} \\right|_{x=0} = -(T_s - T_i) \\frac{1}{\\sqrt{\\pi \\alpha t}} \\exp(0) = -\\frac{T_s - T_i}{\\sqrt{\\pi \\alpha t}}\n$$\nFinally, we substitute this into Fourier's law to find the surface heat flux $q(0,t)$:\n$$\nq(0,t) = -k \\left. \\frac{\\partial T}{\\partial x} \\right|_{x=0} = -k \\left( -\\frac{T_s - T_i}{\\sqrt{\\pi \\alpha t}} \\right)\n$$\n$$\nq(0,t) = \\frac{k(T_s - T_i)}{\\sqrt{\\pi \\alpha t}}\n$$\nThis is the final closed-form analytic expression for the surface heat flux as a function of time.",
            "answer": "$$\n\\boxed{\\frac{k(T_s - T_i)}{\\sqrt{\\pi \\alpha t}}}\n$$"
        },
        {
            "introduction": "A model's predictive power hinges on the accuracy of its parameters, such as thermal conductivity $k$ and convective coefficient $h$, which are often inferred from experimental data. This exercise addresses a critical question in practical modeling: can we uniquely determine these parameters from a given set of measurements? You will implement a computational workflow using sensitivity analysis and the Fisher Information Matrix to assess the local identifiability of parameters in a multi-node thermal model, exploring how physical conditions affect the information content of temperature data. This practice provides essential skills for designing effective experiments and building robust, data-driven thermal models. ",
            "id": "4130016",
            "problem": "Consider a Thermal Energy Storage (TES) element modeled as a one-dimensional slab of thickness $L$ and cross-sectional area $A$, with material properties density $\\rho$, specific heat capacity $c$, and thermal conductivity $k$. The slab exchanges heat with an ambient fluid at temperature $T_{\\infty}(t)$ via a convective heat transfer coefficient $h$ at the exposed surface. Internal temperature gradients are present due to finite conduction, so a spatially lumped yet gradient-capturing reduced-order model is required. Adopt a half-slab representation by symmetry and discretize the half-thickness $L/2$ into $2$ equal control volumes of thickness $\\Delta x = L/4$, with temperatures $T_1(t)$ (near the exposed surface) and $T_2(t)$ (near the symmetry plane). The ambient temperature $T_{\\infty}(t)$ is a step from $T_0$ to a new constant value (given as `T1_amb` in the test suite) at time $t=0$, and the initial condition is uniform $T_1(0)=T_2(0)=T_0$. The measured output is the surface temperature $y(t)=T_1(t)$.\n\nStarting from energy conservation and Fourier’s law, write the reduced-order ordinary differential equation (ODE) model:\n- The thermal capacitance of each control volume is $m = \\rho c A \\Delta x$.\n- The internal conduction conductance is $G = \\dfrac{k A}{\\Delta x}$.\n- The external convective conductance is $H = h A$.\n\nThe state dynamics are given by\n$$\n\\frac{dT_1}{dt} = \\frac{-H \\left(T_1 - T_{\\infty}(t)\\right) - G \\left(T_1 - T_2\\right)}{m}, \\quad\n\\frac{dT_2}{dt} = \\frac{+G \\left(T_1 - T_2\\right)}{m}.\n$$\nAssume the noise in the measurement $y(t)$ is additive, zero-mean Gaussian with constant standard deviation $\\sigma$ (in kelvin). The parameters of interest are the convective heat transfer coefficient $h$ and the thermal conductivity $k$. Define the sensitivity functions $S_h(t) = \\dfrac{\\partial \\mathbf{T}}{\\partial h}(t)$ and $S_k(t) = \\dfrac{\\partial \\mathbf{T}}{\\partial k}(t)$, where $\\mathbf{T}(t) = [T_1(t), T_2(t)]^{\\top}$, which satisfy the sensitivity ODEs\n$$\n\\frac{dS_{\\theta}}{dt} = J(\\mathbf{T}, h, k)\\, S_{\\theta} + b_{\\theta}(\\mathbf{T}, h, k), \\quad \\theta \\in \\{h,k\\},\n$$\nwith Jacobian\n$$\nJ(\\mathbf{T}, h, k) =\n\\begin{bmatrix}\n\\dfrac{-H - G}{m}  \\dfrac{G}{m} \\\\\n\\dfrac{G}{m}  \\dfrac{-G}{m}\n\\end{bmatrix},\n$$\nand parameter-source terms\n$$\nb_h(\\mathbf{T}, h, k) =\n\\begin{bmatrix}\n\\dfrac{-A \\left(T_1 - T_{\\infty}(t)\\right)}{m} \\\\\n0\n\\end{bmatrix},\n\\qquad\nb_k(\\mathbf{T}, h, k) =\n\\begin{bmatrix}\n\\dfrac{-\\left(\\dfrac{A}{\\Delta x}\\right) \\left(T_1 - T_2\\right)}{m} \\\\\n\\dfrac{+\\left(\\dfrac{A}{\\Delta x}\\right) \\left(T_1 - T_2\\right)}{m}\n\\end{bmatrix}.\n$$\nAssume $S_h(0) = \\mathbf{0}$ and $S_k(0) = \\mathbf{0}$. The measured sensitivity vector with respect to $h$ and $k$ at time $t$ is $s_y(t) = \\left[ \\dfrac{\\partial y}{\\partial h}(t), \\dfrac{\\partial y}{\\partial k}(t) \\right]^{\\top} = \\left[ \\dfrac{\\partial T_1}{\\partial h}(t), \\dfrac{\\partial T_1}{\\partial k}(t) \\right]^{\\top}$. To mitigate the dimensionality of the sensitivities, use the normalized sensitivity vector\n$$\n\\tilde{s}_y(t) = \\begin{bmatrix} h \\dfrac{\\partial T_1}{\\partial h}(t) \\\\ k \\dfrac{\\partial T_1}{\\partial k}(t) \\end{bmatrix}.\n$$\nDefine the Fisher Information Matrix (FIM) in its discrete-time approximation over sampling times $\\{t_i\\}_{i=1}^N$ as\n$$\nF = \\sum_{i=1}^{N} \\frac{1}{\\sigma^2} \\, \\tilde{s}_y(t_i) \\, \\tilde{s}_y(t_i)^{\\top}.\n$$\nA local identifiability decision for the parameter pair $(h,k)$ is made by evaluating the minimum eigenvalue $\\lambda_{\\min}$ of $F$: if $\\lambda_{\\min} \\ge \\varepsilon$ for a given threshold $\\varepsilon$, declare the pair locally identifiable from $y(t)$; otherwise, declare it not identifiable.\n\nYour task is to implement a program that integrates the augmented system consisting of the state and sensitivity ODEs for the given test suite, constructs $F$, and decides identifiability. Use the following test suite, which explores different Biot number regimes and internal gradient magnitudes:\n\n- Test case $1$ (moderate internal gradients, expected identifiability): $L = 0.1 \\, \\mathrm{m}$, $A = 0.5 \\, \\mathrm{m}^2$, $\\rho = 800 \\, \\mathrm{kg/m^3}$, $c = 2000 \\, \\mathrm{J/(kg \\cdot K)}$, $k = 0.2 \\, \\mathrm{W/(m \\cdot K)}$, $h = 40 \\, \\mathrm{W/(m^2 \\cdot K)}$, $T_0 = 293.15 \\, \\mathrm{K}$, $T1_amb = 333.15 \\, \\mathrm{K}$, $\\sigma = 0.05 \\, \\mathrm{K}$, final time $T_{\\mathrm{end}} = 7200 \\, \\mathrm{s}$, with $N = 200$ uniformly spaced samples.\n- Test case $2$ (very small internal gradients, expected non-identifiability of $k$): $L = 0.005 \\, \\mathrm{m}$, $A = 0.5 \\, \\mathrm{m}^2$, $\\rho = 800 \\, \\mathrm{kg/m^3}$, $c = 2000 \\, \\mathrm{J/(kg \\cdot K)}$, $k = 20.0 \\, \\mathrm{W/(m \\cdot K)}$, $h = 5.0 \\, \\mathrm{W/(m^2 \\cdot K)}$, $T_0 = 293.15 \\, \\mathrm{K}$, $T1_amb = 333.15 \\, \\mathrm{K}$, $\\sigma = 0.05 \\, \\mathrm{K}$, final time $T_{\\mathrm{end}} = 7200 \\, \\mathrm{s}$, with $N = 200$ uniformly spaced samples.\n- Test case $3$ (very large internal gradients, strong conduction limitation): $L = 0.2 \\, \\mathrm{m}$, $A = 0.5 \\, \\mathrm{m}^2$, $\\rho = 800 \\, \\mathrm{kg/m^3}$, $c = 2000 \\, \\mathrm{J/(kg \\cdot K)}$, $k = 0.1 \\, \\mathrm{W/(m \\cdot K)}$, $h = 300.0 \\, \\mathrm{W/(m^2 \\cdot K)}$, $T_0 = 293.15 \\, \\mathrm{K}$, $T1_amb = 333.15 \\, \\mathrm{K}$, $\\sigma = 0.05 \\, \\mathrm{K}$, final time $T_{\\mathrm{end}} = 7200 \\, \\mathrm{s}$, with $N = 200$ uniformly spaced samples.\n\nUse the identifiability threshold $\\varepsilon = 10^{-6}$ (dimensionless, due to normalization). Angles do not appear in this problem. Ensure all computations involving physical quantities use the units specified. Your program should produce a single line of output containing a comma-separated list of integers with one entry per test case, where $1$ denotes locally identifiable and $0$ denotes not locally identifiable, enclosed in square brackets. For example, if the first two cases are identifiable and the third is not, the output must be exactly $[1,1,0]$.",
            "solution": "The problem statement has been meticulously validated and is determined to be scientifically grounded, well-posed, and objective. It presents a standard problem in system identification applied to a heat transfer model. The physical principles, mathematical formulation, and numerical tasks are clearly and correctly defined. There are no contradictions, ambiguities, or unsound premises that would invalidate the problem. The problem is therefore valid, and a solution will be provided.\n\nThe objective is to determine the local parameter identifiability of the convective heat transfer coefficient $h$ and the thermal conductivity $k$ for a simplified one-dimensional thermal energy storage model. The decision is based on the Fisher Information Matrix (FIM), which quantifies the information content of the measured surface temperature $T_1(t)$ with respect to the parameters of interest.\n\nThe core of the problem lies in solving an augmented system of Ordinary Differential Equations (ODEs). This system comprises the state equations for the temperatures of the two control volumes, $T_1(t)$ and $T_2(t)$, and the sensitivity equations for the partial derivatives of these temperatures with respect to $h$ and $k$.\n\nLet the augmented state vector be denoted by $\\mathbf{Z}(t)$, a column vector of size $6 \\times 1$:\n$$\n\\mathbf{Z}(t) = \\begin{bmatrix} T_1(t) \\\\ T_2(t) \\\\ \\partial T_1 / \\partial h \\\\ \\partial T_2 / \\partial h \\\\ \\partial T_1 / \\partial k \\\\ \\partial T_2 / \\partial k \\end{bmatrix} = \\begin{bmatrix} Z_1 \\\\ Z_2 \\\\ Z_3 \\\\ Z_4 \\\\ Z_5 \\\\ Z_6 \\end{bmatrix}\n$$\nThe dynamics of this augmented system, $\\dfrac{d\\mathbf{Z}}{dt}$, are derived from the principles of energy conservation and sensitivity analysis. The constants required for the model are computed first: the control volume thickness $\\Delta x = L/4$, the thermal capacity of a control volume $m = \\rho c A \\Delta x$, the external convective conductance $H = h A$, and the internal conductive conductance $G = k A / \\Delta x$. Note that the problem text uses the symbol $m$ for thermal capacity ($[\\mathrm{J/K}]$), not mass. The ambient temperature is a step function, $T_{\\infty}(t) = T_{amb,final}$ for $t \\ge 0$.\n\nThe six ODEs forming the system $\\dfrac{d\\mathbf{Z}}{dt} = f(t, \\mathbf{Z})$ are:\n\n1.  **State Equation for $T_1$**: This is an energy balance on the first control volume, accounting for convection with the ambient fluid and conduction to the second control volume.\n    $$\n    \\frac{dZ_1}{dt} = \\frac{dT_1}{dt} = \\frac{-H (T_1 - T_{\\infty}) - G (T_1 - T_2)}{m}\n    $$\n\n2.  **State Equation for $T_2$**: This is an energy balance on the second control volume, which exchanges heat by conduction with the first volume and has an adiabatic boundary at the symmetry plane.\n    $$\n    \\frac{dZ_2}{dt} = \\frac{dT_2}{dt} = \\frac{G (T_1 - T_2)}{m}\n    $$\n\n3.  **Sensitivity Equations for $S_h = [\\partial T_1/\\partial h, \\partial T_2/\\partial h]^\\top$**: These equations describe how the state sensitivities evolve. They are linear ODEs forced by the states themselves.\n    $$\n    \\begin{bmatrix} \\dfrac{dZ_3}{dt} \\\\ \\dfrac{dZ_4}{dt} \\end{bmatrix} =\n    J \\begin{bmatrix} Z_3 \\\\ Z_4 \\end{bmatrix} + b_h =\n    \\begin{bmatrix} \\dfrac{-H - G}{m}  \\dfrac{G}{m} \\\\ \\dfrac{G}{m}  \\dfrac{-G}{m} \\end{bmatrix} \\begin{bmatrix} Z_3 \\\\ Z_4 \\end{bmatrix} + \\begin{bmatrix} \\dfrac{-A (T_1 - T_{\\infty})}{m} \\\\ 0 \\end{bmatrix}\n    $$\n\n4.  **Sensitivity Equations for $S_k = [\\partial T_1/\\partial k, \\partial T_2/\\partial k]^\\top$**: Similar to the $h$-sensitivities, these are forced linear ODEs.\n    $$\n    \\begin{bmatrix} \\dfrac{dZ_5}{dt} \\\\ \\dfrac{dZ_6}{dt} \\end{bmatrix} =\n    J \\begin{bmatrix} Z_5 \\\\ Z_6 \\end{bmatrix} + b_k =\n    \\begin{bmatrix} \\dfrac{-H - G}{m}  \\dfrac{G}{m} \\\\ \\dfrac{G}{m}  \\dfrac{-G}{m} \\end{bmatrix} \\begin{bmatrix} Z_5 \\\\ Z_6 \\end{bmatrix} + \\begin{bmatrix} \\dfrac{-(A/\\Delta x) (T_1 - T_2)}{m} \\\\ \\dfrac{+(A/\\Delta x) (T_1 - T_2)}{m} \\end{bmatrix}\n    $$\n\nThe initial conditions for this initial value problem are given by the uniform temperature distribution and the fact that the initial states do not depend on the parameters $h$ and $k$:\n$$\n\\mathbf{Z}(0) = [T_0, T_0, 0, 0, 0, 0]^\\top\n$$\n\nThe solution procedure is as follows:\n1.  For each test case, the augmented system of six ODEs is integrated numerically from $t=0$ to $t=T_{\\mathrm{end}}$. A standard numerical solver such as a Runge-Kutta method is suitable. The `scipy.integrate.solve_ivp` function is used for this purpose.\n2.  The integration yields the time evolution of all six components of $\\mathbf{Z}(t)$. The solution is evaluated at $N=200$ uniformly spaced time points $\\{t_i\\}_{i=1}^N$.\n3.  The Fisher Information Matrix $F$ is constructed. The FIM is a $2 \\times 2$ matrix for the two parameters $(h,k)$. It is calculated by summing contributions from each measurement time point:\n    $$\n    F = \\sum_{i=1}^{N} \\frac{1}{\\sigma^2} \\, \\tilde{s}_y(t_i) \\, \\tilde{s}_y(t_i)^{\\top}\n    $$\n    where $\\tilde{s}_y(t_i)$ is the normalized measured sensitivity vector. This vector is constructed using the numerically-obtained sensitivities $\\partial T_1 / \\partial h$ (which is $Z_3(t_i)$) and $\\partial T_1 / \\partial k$ (which is $Z_5(t_i)$):\n    $$\n    \\tilde{s}_y(t_i) = \\begin{bmatrix} h \\cdot Z_3(t_i) \\\\ k \\cdot Z_5(t_i) \\end{bmatrix}\n    $$\n4.  The local identifiability of the parameter pair $(h,k)$ is assessed by examining the eigenvalues of the FIM. Since the FIM is symmetric and positive semi-definite by construction, its eigenvalues are real and non-negative. A small minimum eigenvalue, $\\lambda_{\\min}$, indicates that the measurement data provides little information to distinguish parameters along the direction of the corresponding eigenvector. If $\\lambda_{\\min}$ is below a specified threshold $\\varepsilon = 10^{-6}$, the parameters are considered not locally identifiable. Otherwise, they are identifiable.\n5.  This process is repeated for each of the three test cases, and the binary results ($1$ for identifiable, $0$ for not) are collected. The program then outputs these results in the specified format. The use of normalized sensitivities makes the FIM and the threshold $\\varepsilon$ dimensionless, providing a scale-invariant criterion.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case 1: Moderate internal gradients\n        {'L': 0.1, 'A': 0.5, 'rho': 800, 'c': 2000, 'k': 0.2, 'h': 40,\n         'T0': 293.15, 'T1_amb': 333.15, 'sigma': 0.05, 'Tend': 7200, 'N': 200},\n        # Case 2: Very small internal gradients\n        {'L': 0.005, 'A': 0.5, 'rho': 800, 'c': 2000, 'k': 20.0, 'h': 5.0,\n         'T0': 293.15, 'T1_amb': 333.15, 'sigma': 0.05, 'Tend': 7200, 'N': 200},\n        # Case 3: Very large internal gradients\n        {'L': 0.2, 'A': 0.5, 'rho': 800, 'c': 2000, 'k': 0.1, 'h': 300.0,\n         'T0': 293.15, 'T1_amb': 333.15, 'sigma': 0.05, 'Tend': 7200, 'N': 200},\n    ]\n\n    epsilon = 1e-6\n    results = []\n\n    for case in test_cases:\n        result = analyze_identifiability(case, epsilon)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef analyze_identifiability(params, epsilon):\n    \"\"\"\n    Analyzes a single test case for parameter identifiability.\n\n    Args:\n        params (dict): A dictionary containing all parameters for the test case.\n        epsilon (float): The identifiability threshold.\n\n    Returns:\n        int: 1 if identifiable, 0 otherwise.\n    \"\"\"\n    L, A, rho, c, k, h = params['L'], params['A'], params['rho'], params['c'], params['k'], params['h']\n    T0, T_amb_final = params['T0'], params['T1_amb']\n    sigma, Tend, N = params['sigma'], params['Tend'], params['N']\n\n    # 1. Calculate derived parameters\n    delta_x = L / 4.0\n    # The term 'm' is used for thermal capacity (J/K) in the problem statement.\n    m_cap = rho * c * A * delta_x\n    H = h * A\n    G = k * A / delta_x\n\n    # 2. Define the augmented ODE system\n    def ode_system(t, Z):\n        # Unpack the augmented state vector:\n        # Z = [T1, T2, Sh1, Sh2, Sk1, Sk2]\n        T1, T2, Sh1, Sh2, Sk1, Sk2 = Z\n\n        # State equations for temperatures\n        dT1_dt = (-H * (T1 - T_amb_final) - G * (T1 - T2)) / m_cap\n        dT2_dt = (G * (T1 - T2)) / m_cap\n\n        # Jacobian components\n        J11 = (-H - G) / m_cap\n        J12 = G / m_cap\n        J21 = G / m_cap\n        J22 = -G / m_cap\n\n        # Source term for h-sensitivity\n        bh1 = -A * (T1 - T_amb_final) / m_cap\n        # bh2 = 0\n\n        # Source term for k-sensitivity\n        bk_common = (A / delta_x) * (T1 - T2) / m_cap\n        bk1 = -bk_common\n        bk2 = bk_common\n\n        # Sensitivity equations for h\n        dSh1_dt = J11 * Sh1 + J12 * Sh2 + bh1\n        dSh2_dt = J21 * Sh1 + J22 * Sh2  # + bh2 (which is 0)\n\n        # Sensitivity equations for k\n        dSk1_dt = J11 * Sk1 + J12 * Sk2 + bk1\n        dSk2_dt = J21 * Sk1 + J22 * Sk2 + bk2\n\n        return [dT1_dt, dT2_dt, dSh1_dt, dSh2_dt, dSk1_dt, dSk2_dt]\n\n    # 3. Set initial conditions and time grid for integration\n    Z0 = [T0, T0, 0.0, 0.0, 0.0, 0.0]\n    t_span = [0.0, Tend]\n    t_eval = np.linspace(0.0, Tend, N)\n\n    # 4. Integrate the ODE system\n    sol = solve_ivp(ode_system, t_span, Z0, t_eval=t_eval, method='RK45')\n\n    # 5. Extract sensitivities of the measured output y(t) = T1(t)\n    Sh1_t = sol.y[2, :]  # d(T1)/dh\n    Sk1_t = sol.y[4, :]  # d(T1)/dk\n\n    # 6. Construct the Fisher Information Matrix (FIM)\n    FIM = np.zeros((2, 2))\n    for i in range(N):\n        # Normalized sensitivity vector for parameters (h, k)\n        s_tilde_y = np.array([\n            h * Sh1_t[i],\n            k * Sk1_t[i]\n        ]).reshape(2, 1)\n        \n        # Accumulate the outer product into the FIM\n        FIM += (1 / sigma**2) * (s_tilde_y @ s_tilde_y.T)\n\n    # 7. Compute eigenvalues and decide identifiability\n    # Use eigvalsh as FIM is symmetric\n    eigenvalues = np.linalg.eigvalsh(FIM)\n    lambda_min = np.min(eigenvalues)\n\n    return 1 if lambda_min >= epsilon else 0\n\nsolve()\n```"
        }
    ]
}