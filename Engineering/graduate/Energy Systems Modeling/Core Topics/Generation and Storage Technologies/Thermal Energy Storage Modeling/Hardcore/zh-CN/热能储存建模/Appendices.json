{
    "hands_on_practices": [
        {
            "introduction": "掌握热储能建模的第一步是建立最基础的动态模型。本练习将引导你从第一性原理（能量守恒和牛顿冷却定律）出发，推导集总参数热容模型的控制微分方程。通过求解系统对一个标准输入（阶跃变化）的响应，你将掌握一阶热系统建模和解析求解的基本技能 。",
            "id": "4130052",
            "problem": "一个混合均匀的热能储存元件（例如，一个小的、充分搅拌的储罐或一个均质化的相变材料控制体）被建模为一个具有恒定热容 $C_{\\text{th}}$ (单位 $\\mathrm{J/K}$) 的单个集总节点。该节点暴露在温度恒定为 $T_{\\infty}$ 的周围环境中，并通过外部对流散热。该过程遵循 Newton 冷却定律，其总传热系数为 $U$ (单位 $\\mathrm{W/(m^2\\,K)}$)，作用面积为 $A$ (单位 $\\mathrm{m^2}$)。因此，乘积 $UA$ 的单位为 $\\mathrm{W/K}$。该节点接收一个可控的热输入率 $\\dot{Q}_{\\text{in}}(t)$ (单位 $\\mathrm{W}$)。假设内部温度梯度可忽略不计（Biot 数很小）、物性恒定，且边界上没有功或质量传递。\n\n使用固定质量控制体的热力学第一定律和集总热容的内能定义，仅从基本陈述（能量平衡和 Newton 冷却定律）出发：\n- 推导控制节点温度 $T(t)$ 的常微分方程（ODE），以及\n- 当输入热率从 $t<0$ 时的 $\\dot{Q}_{\\text{in}}(t)=0$ 变为 $t \\ge 0$ 时的 $\\dot{Q}_{\\text{in}}(t)=Q_{0}$，并在初始条件为 $T(0)=T_{\\infty}$ 的情况下，求解此 ODE 的阶跃响应。\n\n将您的最终答案表示为关于 $T(t)$ 的单一闭式解析表达式，该表达式在 $t \\ge 0$ 时有效。温度以开尔文表示。不需要进行数值计算，也不需要四舍五入。",
            "solution": "该问题陈述已经过严格验证，被认为是具有科学依据、适定且客观的。它基于热力学和传热学的基本原理——具体来说，是应用于标准集总热容模型的热力学第一定律和 Newton 冷却定律。该问题是自洽的，提供了所有必要的符号常数、一个定义明确的强迫函数和一个清晰的初始条件。诸如 Biot 数很小之类的假设都得到了明确说明，并且适用于该模型。因此，存在唯一且有意义的解。我们可以继续进行推导和求解。\n\n该问题要求分为两部分：首先，推导集总节点温度 $T(t)$ 的控制常微分方程（ODE）；其次，求解该 ODE 在特定阶跃函数热输入下的解。\n\n**第1部分：控制常微分方程的推导**\n\n我们从一个封闭、固定质量控制体的热力学第一定律开始，该控制体经历的过程动能和势能变化可忽略不计，且没有功的相互作用。能量平衡表示为：\n$$\n\\frac{dE}{dt} = \\dot{Q}_{\\text{net}}\n$$\n其中 $E$ 是系统的内能，$\\dot{Q}_{\\text{net}}$ 是进入系统的净传热率。\n\n对于集总热容系统，内能是其温度 $T$ 和热容 $C_{\\text{th}}$ 的函数。内能的变化率由下式给出：\n$$\n\\frac{dE}{dt} = C_{\\text{th}} \\frac{dT}{dt}\n$$\n净传热率 $\\dot{Q}_{\\text{net}}$ 是穿过控制体边界的所有传热率的总和。在本问题中，有两项：\n1.  一个可控的热输入率 $\\dot{Q}_{\\text{in}}(t)$。\n2.  向周围环境的对流热损失率。根据 Newton 冷却定律，该热损失与节点和周围环境之间的温差 $T(t) - T_{\\infty}$ 成正比。热损失率为 $\\dot{Q}_{\\text{loss}} = UA(T(t) - T_{\\infty})$。\n\n因此，净热率是热输入减去热损失：\n$$\n\\dot{Q}_{\\text{net}} = \\dot{Q}_{\\text{in}}(t) - UA(T(t) - T_{\\infty})\n$$\n将 $\\frac{dE}{dt}$ 和 $\\dot{Q}_{\\text{net}}$ 的表达式代入热力学第一定律能量平衡，得到控制 ODE：\n$$\nC_{\\text{th}} \\frac{dT}{dt} = \\dot{Q}_{\\text{in}}(t) - UA(T(t) - T_{\\infty})\n$$\n这是集总节点温度的通用 ODE。它是一个一阶线性非齐次常微分方程。\n\n**第2部分：ODE 阶跃响应的求解**\n\n该问题指定了时间 $t \\ge 0$ 时阶跃响应的条件：\n-   热输入率为常数：$\\dot{Q}_{\\text{in}}(t) = Q_0$。\n-   初始条件为：$T(0) = T_{\\infty}$。\n\n将 $\\dot{Q}_{\\text{in}}(t) = Q_0$ 代入通用 ODE，我们得到：\n$$\nC_{\\text{th}} \\frac{dT}{dt} = Q_0 - UA(T - T_{\\infty})\n$$\n为了求解这个 ODE，我们首先将其重新排列成标准形式 $\\frac{dy}{dt} + P(t)y = Q(t)$：\n$$\nC_{\\text{th}} \\frac{dT}{dt} + UAT = Q_0 + UAT_{\\infty}\n$$\n两边除以 $C_{\\text{th}}$ 得到：\n$$\n\\frac{dT}{dt} + \\frac{UA}{C_{\\text{th}}}T = \\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}}\n$$\n这是一个一阶常系数线性 ODE。我们可以使用积分因子 $I(t)$ 来求解它。积分因子定义为 $I(t) = \\exp\\left(\\int \\frac{UA}{C_{\\text{th}}} dt\\right)$，计算结果为：\n$$\nI(t) = \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)\n$$\n将整个 ODE 乘以 $I(t)$：\n$$\n\\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) \\frac{dT}{dt} + \\frac{UA}{C_{\\text{th}}} \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) T = \\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}} \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)\n$$\n左侧现在是乘积 $T(t)I(t)$ 的精确导数：\n$$\n\\frac{d}{dt}\\left(T \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)\\right) = \\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}} \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)\n$$\n我们将两边从 $0$ 到 $t$ 对时间进行积分：\n$$\n\\int_{0}^{t} \\frac{d}{d\\tau}\\left(T(\\tau) \\exp\\left(\\frac{UA}{C_{\\text{th}}}\\tau\\right)\\right) d\\tau = \\int_{0}^{t} \\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}} \\exp\\left(\\frac{UA}{C_{\\text{th}}}\\tau\\right) d\\tau\n$$\n使用微积分基本定理计算左侧：\n$$\n\\left[ T(\\tau) \\exp\\left(\\frac{UA}{C_{\\text{th}}}\\tau\\right) \\right]_{0}^{t} = T(t) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - T(0) \\exp(0)\n$$\n计算右侧积分：\n$$\n\\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}} \\left[ \\frac{C_{\\text{th}}}{UA} \\exp\\left(\\frac{UA}{C_{\\text{th}}}\\tau\\right) \\right]_{0}^{t} = \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) \\left[ \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - \\exp(0) \\right]\n$$\n令两边相等并代入初始条件 $T(0) = T_{\\infty}$：\n$$\nT(t) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - T_{\\infty} = \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) \\left( \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - 1 \\right)\n$$\n现在，我们求解 $T(t)$：\n$$\nT(t) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) = T_{\\infty} + \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right)\n$$\n$$\nT(t) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) = \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - \\frac{Q_0}{UA}\n$$\n最后，除以指数项 $\\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)$ 以分离出 $T(t)$：\n$$\nT(t) = \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) - \\frac{Q_0}{UA} \\exp\\left(-\\frac{UA}{C_{\\text{th}}}t\\right)\n$$\n重新整理各项，得到 $t \\ge 0$ 时温度随时间变化的最终表达式：\n$$\nT(t) = T_{\\infty} + \\frac{Q_0}{UA} \\left( 1 - \\exp\\left(-\\frac{UA}{C_{\\text{th}}}t\\right) \\right)\n$$\n该表达式描述了节点的温度从环境温度 $T_{\\infty}$ 开始，以特征热时间常数 $\\tau = C_{\\text{th}}/(UA)$ 指数级趋近于新的稳态温度 $T_{\\infty} + Q_0/(UA)$。",
            "answer": "$$\n\\boxed{T(t) = T_{\\infty} + \\frac{Q_{0}}{UA} \\left( 1 - \\exp\\left(-\\frac{UA}{C_{\\text{th}}}t\\right) \\right)}\n$$"
        },
        {
            "introduction": "在集总参数模型的基础上，本练习将探讨一个关键的实际问题：模型简化如何影响参数估计。你将分析一种常见的“准稳态”假设，并推导其在估算总传热系数时引入的偏差的解析表达式。这项练习连接了抽象模型与实验数据分析的实际应用，强调了理解模型底层假设的重要性 。",
            "id": "4130000",
            "problem": "一个热分层系统被一个混合均匀的集总热容所替代，以模拟一个正在进行受控加热测试的热能储存 (TES) 模块。TES 内部的特征是均匀的固体温度 $T_{s}(t)$、质量 $m$ 和比热容 $c$。该模块通过一个总传热系数 (OHTC) $U$ 与恒定环境温度为 $T_{a}$ 的周围环境在有效外部面积 $A$ 上进行热交换，该系数 $U$ 集合了壁面导热和外部对流效应。一个电加热器向 TES 内部提供已知的输入热率 $Q_{\\text{in}}(t)$。\n\n一种常见的用于估算 $U$ 的准稳态程序忽略了内能动态，并将测得的输入热率等同于从 TES 到环境的传热。当 TES 处于瞬态（非稳态）运行时，该程序会产生一个有偏估计。从集总热容的热力学第一定律和物理上一致的边界传热模型出发，推导准稳态估计值 $U_{\\text{qs}}$ 与真实值 $U$ 之间的偏差 $b \\equiv U_{\\text{qs}} - U$ 的解析表达式，该表达式应以 TES 参数和瞬态项表示。然后使用以下测量值和参数计算在特定时间 $t_{0}$ 的偏差 $b$：\n- $m = 1500\\ \\text{kg}$，\n- $c = 790\\ \\text{J}\\ \\text{kg}^{-1}\\ \\text{K}^{-1}$，\n- $A = 30\\ \\text{m}^{2}$，\n- $T_{a} = 293.15\\ \\text{K}$，\n- $T_{s}(t_{0}) = 333.15\\ \\text{K}$，\n- $\\frac{dT_{s}}{dt}(t_{0}) = 0.020\\ \\text{K}\\ \\text{s}^{-1}$，\n- $Q_{\\text{in}}(t_{0}) = 45000\\ \\text{W}$。\n\n您的最终答案必须是在 $t_{0}$ 时 $b$ 的标量数值。将您的答案四舍五入到四位有效数字，并以瓦特每平方米开尔文 (W m$^{-2}$ K$^{-1}$) 为单位表示。",
            "solution": "该问题要求推导总传热系数 (OHTC) 估计值中的偏差，并随后进行数值计算。推导始于将热力学第一定律应用于被建模为集总热容的热能储存 (TES) 模块。\n\n集总系统的能量平衡表明，内能的变化率 $\\frac{dE}{dt}$ 等于进入系统的净传热率。净传热是电加热器提供的热量 $Q_{\\text{in}}(t)$ 与散失到环境中的热量 $Q_{\\text{loss}}(t)$ 之和。按照惯例，传入系统的热量为正。\n\n$$\n\\frac{dE}{dt} = Q_{\\text{in}}(t) - Q_{\\text{loss}}(t)\n$$\n\n对于质量为 $m$、比热容为 $c$、温度均匀为 $T_s(t)$ 的集总热容，其内能变化率由下式给出：\n$$\n\\frac{dE}{dt} = m c \\frac{dT_s}{dt}\n$$\n向温度为 $T_a$ 的环境散热发生在一个面积为 $A$ 的区域上，总传热系数为 $U$。这可以使用 Newton 冷却定律进行建模：\n$$\nQ_{\\text{loss}}(t) = U A (T_s(t) - T_a)\n$$\n将这些表达式代入能量平衡方程，得到系统温度的控制微分方程：\n$$\nm c \\frac{dT_s}{dt} = Q_{\\text{in}}(t) - U A (T_s(t) - T_a)\n$$\n该方程代表了在给定假设下系统的真实物理模型。通过重新整理该方程的各项，我们可以表示出真实的总传热系数 $U$：\n$$\nU A (T_s(t) - T_a) = Q_{\\text{in}}(t) - m c \\frac{dT_s}{dt}\n$$\n$$\nU = \\frac{Q_{\\text{in}}(t) - m c \\frac{dT_s}{dt}}{A (T_s(t) - T_a)}\n$$\n接下来，我们考虑准稳态估算程序。问题指出，该程序“忽略了内能动态”。这等同于假设内能变化率为零，即 $\\frac{dE}{dt} = m c \\frac{dT_s}{dt} = 0$。在此假设下，能量平衡简化为：\n$$\n0 = Q_{\\text{in}}(t) - Q_{\\text{loss,qs}}(t)\n$$\n其中 $Q_{\\text{loss,qs}}(t)$ 是在此假设下估算的热损失。然后，该程序将“测得的输入热率等同于从 TES 到环境的传热”，以找到 OHTC 的估计值，记为 $U_{\\text{qs}}$。\n$$\nQ_{\\text{in}}(t) = Q_{\\text{loss,qs}}(t) = U_{\\text{qs}} A (T_s(t) - T_a)\n$$\n求解准稳态估计值 $U_{\\text{qs}}$ 可得：\n$$\nU_{\\text{qs}} = \\frac{Q_{\\text{in}}(t)}{A (T_s(t) - T_a)}\n$$\n偏差 $b$ 定义为准稳态估计值与真实值之差：$b \\equiv U_{\\text{qs}} - U$。代入 $U_{\\text{qs}}$ 和 $U$ 的表达式：\n$$\nb = \\frac{Q_{\\text{in}}(t)}{A (T_s(t) - T_a)} - \\left( \\frac{Q_{\\text{in}}(t) - m c \\frac{dT_s}{dt}}{A (T_s(t) - T_a)} \\right)\n$$\n将各项合并到共同的分母上：\n$$\nb = \\frac{Q_{\\text{in}}(t) - (Q_{\\text{in}}(t) - m c \\frac{dT_s}{dt})}{A (T_s(t) - T_a)}\n$$\n$$\nb = \\frac{Q_{\\text{in}}(t) - Q_{\\text{in}}(t) + m c \\frac{dT_s}{dt}}{A (T_s(t) - T_a)}\n$$\n这可以简化为偏差的最终解析表达式：\n$$\nb = \\frac{m c \\frac{dT_s}{dt}}{A (T_s(t) - T_a)}\n$$\n这个表达式揭示了偏差与温度变化率 $\\frac{dT_s}{dt}$ 和热容 $m c$ 成正比，与传热面积和温差成反比。值得注意的是，偏差与热输入 $Q_{\\text{in}}(t)$ 无关。因此，计算中不需要给定的 $Q_{\\text{in}}(t_0)$ 值。\n\n现在，我们使用给定的数据计算在特定时间 $t_0$ 的偏差 $b$：\n- 质量, $m = 1500\\ \\text{kg}$\n- 比热容, $c = 790\\ \\text{J}\\ \\text{kg}^{-1}\\ \\text{K}^{-1}$\n- 有效外部面积, $A = 30\\ \\text{m}^{2}$\n- 环境温度, $T_a = 293.15\\ \\text{K}$\n- $t_0$ 时的固体温度, $T_s(t_0) = 333.15\\ \\text{K}$\n- $t_0$ 时的温度变化率, $\\frac{dT_s}{dt}(t_0) = 0.020\\ \\text{K}\\ \\text{s}^{-1}$\n\n首先，计算温差：\n$$\nT_s(t_0) - T_a = 333.15\\ \\text{K} - 293.15\\ \\text{K} = 40.00\\ \\text{K}\n$$\n将所有值代入 $b$ 的表达式中：\n$$\nb(t_0) = \\frac{(1500\\ \\text{kg}) \\times (790\\ \\text{J}\\ \\text{kg}^{-1}\\ \\text{K}^{-1}) \\times (0.020\\ \\text{K}\\ \\text{s}^{-1})}{(30\\ \\text{m}^{2}) \\times (40.00\\ \\text{K})}\n$$\n计算分子：\n$$\n\\text{Numerator} = 1500 \\times 790 \\times 0.020\\ \\text{J}\\ \\text{s}^{-1} = 23700\\ \\text{W}\n$$\n计算分母：\n$$\n\\text{Denominator} = 30 \\times 40.00\\ \\text{m}^{2}\\ \\text{K} = 1200\\ \\text{m}^{2}\\ \\text{K}\n$$\n现在，计算偏差的值：\n$$\nb(t_0) = \\frac{23700\\ \\text{W}}{1200\\ \\text{m}^{2}\\ \\text{K}} = 19.75\\ \\text{W}\\ \\text{m}^{-2}\\ \\text{K}^{-1}\n$$\n问题要求答案四舍五入到四位有效数字。计算出的值 $19.75$ 已经恰好有四位有效数字，因此无需进一步四舍五入。偏差的正号表明，在加热过程中（$\\frac{dT_s}{dt} > 0$），准稳态方法高估了真实的 OHTC，这在物理上是合理的，因为它错误地将储存在 TES 质量中的能量归因于热损失。",
            "answer": "$$\n\\boxed{19.75}\n$$"
        },
        {
            "introduction": "最后的练习将超越简单的集总模型，转向一个包含内部温度梯度的更复杂场景，并引入一种先进的计算技术。你将通过费雪信息矩阵（FIM）实施灵敏度分析，以确定模型参数是否可以从实验数据中被可靠地辨识。这项练习提供了现代系统辨识方法的实践经验，这对于开发和验证稳健的能源系统模型至关重要 。",
            "id": "4130016",
            "problem": "考虑一个蓄热（TES）元件，其模型为一个厚度为 $L$、横截面积为 $A$ 的一维板，材料属性包括密度 $\\rho$、比热容 $c$ 和导热系数 $k$。该板通过暴露表面与温度为 $T_{\\infty}(t)$ 的环境流体进行热交换，对流换热系数为 $h$。由于传导有限，存在内部温度梯度，因此需要一个既能空间集总又能捕捉梯度的降阶模型。根据对称性采用半板表示，并将半厚度 $L/2$ 离散为2个厚度为 $\\Delta x = L/4$ 的相等控制体积，其温度分别为 $T_1(t)$（靠近暴露表面）和 $T_2(t)$（靠近对称面）。环境温度在时间 $t=0$ 时从 $T_0$ 阶跃至 $T_1$，初始条件为均匀温度 $T_1(0)=T_2(0)=T_0$。测量输出为表面温度 $y(t)=T_1(t)$。\n\n从能量守恒和傅里叶定律出发，写出降阶常微分方程（ODE）模型：\n- 每个控制体积的热容为 $m = \\rho c A \\Delta x$。\n- 内部导热热导为 $G = \\frac{k A}{\\Delta x}$。\n- 外部对流热导为 $H = h A$。\n\n状态动力学由下式给出\n$$\n\\frac{dT_1}{dt} = \\frac{-H \\left(T_1 - T_{\\infty}(t)\\right) - G \\left(T_1 - T_2\\right)}{m}, \\quad\n\\frac{dT_2}{dt} = \\frac{+G \\left(T_1 - T_2\\right)}{m}.\n$$\n假设测量 $y(t)$ 中的噪声是加性的、零均值的高斯噪声，其标准差 $\\sigma$（单位为开尔文）为常数。感兴趣的参数是对流换热系数 $h$ 和导热系数 $k$。定义灵敏度函数 $S_h(t) = \\frac{\\partial \\mathbf{T}}{\\partial h}(t)$ 和 $S_k(t) = \\frac{\\partial \\mathbf{T}}{\\partial k}(t)$，其中 $\\mathbf{T}(t) = [T_1(t), T_2(t)]^{\\top}$，它们满足灵敏度ODE\n$$\n\\frac{dS_{\\theta}}{dt} = J(\\mathbf{T}, h, k)\\, S_{\\theta} + b_{\\theta}(\\mathbf{T}, h, k), \\quad \\theta \\in \\{h,k\\},\n$$\n雅可比矩阵为\n$$\nJ(\\mathbf{T}, h, k) =\n\\begin{bmatrix}\n\\frac{-H - G}{m}  \\frac{G}{m} \\\\\n\\frac{G}{m}  \\frac{-G}{m}\n\\end{bmatrix},\n$$\n和参数源项为\n$$\nb_h(\\mathbf{T}, h, k) =\n\\begin{bmatrix}\n\\frac{-A \\left(T_1 - T_{\\infty}(t)\\right)}{m} \\\\\n0\n\\end{bmatrix},\n\\qquad\nb_k(\\mathbf{T}, h, k) =\n\\begin{bmatrix}\n\\frac{-\\left(\\frac{A}{\\Delta x}\\right) \\left(T_1 - T_2\\right)}{m} \\\\\n\\frac{+\\left(\\frac{A}{\\Delta x}\\right) \\left(T_1 - T_2\\right)}{m}\n\\end{bmatrix}.\n$$\n假设 $S_h(0) = \\mathbf{0}$ 和 $S_k(0) = \\mathbf{0}$。在时间 $t$ 时，关于 $h$ 和 $k$ 的测量灵敏度向量为 $s_y(t) = \\left[ \\frac{\\partial y}{\\partial h}(t), \\frac{\\partial y}{\\partial k}(t) \\right]^{\\top} = \\left[ \\frac{\\partial T_1}{\\partial h}(t), \\frac{\\partial T_1}{\\partial k}(t) \\right]^{\\top}$。为减轻灵敏度的量纲影响，使用归一化灵敏度向量\n$$\n\\tilde{s}_y(t) = \\begin{bmatrix} h \\frac{\\partial T_1}{\\partial h}(t) \\\\ k \\frac{\\partial T_1}{\\partial k}(t) \\end{bmatrix}.\n$$\n将费雪信息矩阵（FIM）在其采样时间 $\\{t_i\\}_{i=1}^N$ 上的离散时间近似定义为\n$$\nF = \\sum_{i=1}^{N} \\frac{1}{\\sigma^2} \\, \\tilde{s}_y(t_i) \\, \\tilde{s}_y(t_i)^{\\top}.\n$$\n对于参数对 $(h,k)$ 的局部可辨识性决策，通过计算 $F$ 的最小特征值 $\\lambda_{\\min}$ 来做出：如果对于给定的阈值 $\\varepsilon$，有 $\\lambda_{\\min} \\ge \\varepsilon$，则宣布该参数对可从 $y(t)$ 中局部辨识；否则，宣布其不可辨识。\n\n您的任务是实现一个程序，为给定的测试套件积分由状态和灵敏度ODE组成的增广系统，构建 $F$，并判定可辨识性。使用以下测试套件，它探索了不同的毕渥数范围和内部梯度大小：\n\n- 测试用例1（中等内部梯度，预期可辨识）：$L = 0.1 \\, \\mathrm{m}$，$A = 0.5 \\, \\mathrm{m}^2$，$\\rho = 800 \\, \\mathrm{kg/m^3}$，$c = 2000 \\, \\mathrm{J/(kg \\cdot K)}$，$k = 0.2 \\, \\mathrm{W/(m \\cdot K)}$，$h = 40 \\, \\mathrm{W/(m^2 \\cdot K)}$，$T_0 = 293.15 \\, \\mathrm{K}$，$T_1 = 333.15 \\, \\mathrm{K}$，$\\sigma = 0.05 \\, \\mathrm{K}$，最终时间 $T_{\\mathrm{end}} = 7200 \\, \\mathrm{s}$，包含 $N = 200$ 个均匀间隔的样本。\n- 测试用例2（极小内部梯度，预期 $k$ 不可辨识）：$L = 0.005 \\, \\mathrm{m}$，$A = 0.5 \\, \\mathrm{m}^2$，$\\rho = 800 \\, \\mathrm{kg/m^3}$，$c = 2000 \\, \\mathrm{J/(kg \\cdot K)}$，$k = 20.0 \\, \\mathrm{W/(m \\cdot K)}$，$h = 5.0 \\, \\mathrm{W/(m^2 \\cdot K)}$，$T_0 = 293.15 \\, \\mathrm{K}$，$T_1 = 333.15 \\, \\mathrm{K}$，$\\sigma = 0.05 \\, \\mathrm{K}$，最终时间 $T_{\\mathrm{end}} = 7200 \\, \\mathrm{s}$，包含 $N = 200$ 个均匀间隔的样本。\n- 测试用例3（极大内部梯度，强传导限制）：$L = 0.2 \\, \\mathrm{m}$，$A = 0.5 \\, \\mathrm{m}^2$，$\\rho = 800 \\, \\mathrm{kg/m^3}$，$c = 2000 \\, \\mathrm{J/(kg \\cdot K)}$，$k = 0.1 \\, \\mathrm{W/(m \\cdot K)}$，$h = 300.0 \\, \\mathrm{W/(m^2 \\cdot K)}$，$T_0 = 293.15 \\, \\mathrm{K}$，$T_1 = 333.15 \\, \\mathrm{K}$，$\\sigma = 0.05 \\, \\mathrm{K}$，最终时间 $T_{\\mathrm{end}} = 7200 \\, \\mathrm{s}$，包含 $N = 200$ 个均匀间隔的样本。\n\n使用可辨识性阈值 $\\varepsilon = 10^{-6}$（由于归一化而无量纲）。本问题不涉及角度。确保所有涉及物理量的计算都使用指定的单位。您的程序应产生单行输出，其中包含一个逗号分隔的整数列表，每个测试用例对应一个条目，其中 $1$ 表示局部可辨识，$0$ 表示局部不可辨识，并用方括号括起来。例如，如果前两个用例可辨识而第三个不可辨识，则输出必须是 `[1,1,0]`。",
            "solution": "问题陈述已经过仔细验证，被确定为有科学依据、适定且客观。它提出了一个应用于传热模型的标准系统辨识问题。其物理原理、数学公式和数值任务都得到了清晰且正确的定义。不存在会使问题无效的矛盾、模糊之处或不成立的前提。一个微小的符号不一致问题，即符号 $T_1$ 同时用于状态变量 $T_1(t)$ 和一个恒定的环境温度，可以通过测试用例数据中的上下文来解决。因此，该问题是有效的，并将提供解决方案。\n\n目标是为一个简化的一维蓄热模型确定对流换热系数 $h$ 和导热系数 $k$ 的局部参数可辨识性。该决策基于费雪信息矩阵（FIM），该矩阵量化了测量的表面温度 $T_1(t)$ 中关于目标参数的信息含量。\n\n问题的核心在于求解一个常微分方程（ODE）的增广系统。该系统包括两个控制体积温度 $T_1(t)$ 和 $T_2(t)$ 的状态方程，以及这些温度对 $h$ 和 $k$ 的偏导数的灵敏度方程。\n\n设增广状态向量表示为 $\\mathbf{Z}(t)$，一个大小为 $6 \\times 1$ 的列向量：\n$$\n\\mathbf{Z}(t) = \\begin{bmatrix} T_1(t) \\\\ T_2(t) \\\\ \\partial T_1 / \\partial h \\\\ \\partial T_2 / \\partial h \\\\ \\partial T_1 / \\partial k \\\\ \\partial T_2 / \\partial k \\end{bmatrix} = \\begin{bmatrix} Z_1 \\\\ Z_2 \\\\ Z_3 \\\\ Z_4 \\\\ Z_5 \\\\ Z_6 \\end{bmatrix}\n$$\n该增广系统的动力学 $\\frac{d\\mathbf{Z}}{dt}$ 源于能量守恒和灵敏度分析的原理。首先计算模型所需的常数：控制体积厚度 $\\Delta x = L/4$，一个控制体积的热容 $m = \\rho c A \\Delta x$（注意，问题文本中使用符号 $m$ 表示热容 $[\\mathrm{J/K}]$，而不是质量），外部对流热导 $H = h A$，以及内部导热热导 $G = k A / \\Delta x$。环境温度是一个阶跃函数，$t \\ge 0$ 时，$T_{\\infty}(t) = T_{amb,final}$。\n\n构成系统 $\\frac{d\\mathbf{Z}}{dt} = f(t, \\mathbf{Z})$ 的六个ODE是：\n\n1.  **$T_1$ 的状态方程**：这是第一个控制体积的能量平衡，考虑了与环境流体的对流以及与第二个控制体积的传导。\n    $$\n    \\frac{dZ_1}{dt} = \\frac{dT_1}{dt} = \\frac{-H (T_1 - T_{\\infty}) - G (T_1 - T_2)}{m}\n    $$\n\n2.  **$T_2$ 的状态方程**：这是第二个控制体积的能量平衡，它通过传导与第一个控制体积交换热量，并在对称面上有一个绝热边界。\n    $$\n    \\frac{dZ_2}{dt} = \\frac{dT_2}{dt} = \\frac{G (T_1 - T_2)}{m}\n    $$\n\n3.  **$S_h = [\\partial T_1/\\partial h, \\partial T_2/\\partial h]^\\top$ 的灵敏度方程**：这些方程描述了状态灵敏度如何演化。它们是由状态自身驱动的线性ODE。\n    $$\n    \\begin{bmatrix} \\frac{dZ_3}{dt} \\\\ \\frac{dZ_4}{dt} \\end{bmatrix} =\n    J \\begin{bmatrix} Z_3 \\\\ Z_4 \\end{bmatrix} + b_h =\n    \\begin{bmatrix} \\frac{-H - G}{m}  \\frac{G}{m} \\\\ \\frac{G}{m}  \\frac{-G}{m} \\end{bmatrix} \\begin{bmatrix} Z_3 \\\\ Z_4 \\end{bmatrix} + \\begin{bmatrix} \\frac{-A (T_1 - T_{\\infty})}{m} \\\\ 0 \\end{bmatrix}\n    $$\n\n4.  **$S_k = [\\partial T_1/\\partial k, \\partial T_2/\\partial k]^\\top$ 的灵敏度方程**：与 $h$-灵敏度类似，这些也是驱动的线性ODE。\n    $$\n    \\begin{bmatrix} \\frac{dZ_5}{dt} \\\\ \\frac{dZ_6}{dt} \\end{bmatrix} =\n    J \\begin{bmatrix} Z_5 \\\\ Z_6 \\end{bmatrix} + b_k =\n    \\begin{bmatrix} \\frac{-H - G}{m}  \\frac{G}{m} \\\\ \\frac{G}{m}  \\frac{-G}{m} \\end{bmatrix} \\begin{bmatrix} Z_5 \\\\ Z_6 \\end{bmatrix} + \\begin{bmatrix} \\frac{-(A/\\Delta x) (T_1 - T_2)}{m} \\\\ \\frac{+(A/\\Delta x) (T_1 - T_2)}{m} \\end{bmatrix}\n    $$\n\n该初值问题的初始条件由均匀温度分布以及初始状态不依赖于参数 $h$ 和 $k$ 这一事实给出：\n$$\n\\mathbf{Z}(0) = [T_0, T_0, 0, 0, 0, 0]^\\top\n$$\n\n求解过程如下：\n1.  对每个测试用例，从 $t=0$ 到 $t=T_{\\mathrm{end}}$ 对六个ODE的增广系统进行数值积分。一个标准的数值求解器，如龙格-库塔方法是合适的。为此目的，使用 `scipy.integrate.solve_ivp` 函数。\n2.  积分产生 $\\mathbf{Z}(t)$ 所有六个分量的时间演化。在 $N=200$ 个均匀间隔的时间点 $\\{t_i\\}_{i=1}^N$ 上对解进行求值。\n3.  构建费雪信息矩阵 $F$。对于两个参数 $(h,k)$，FIM 是一个 $2 \\times 2$ 的矩阵。它通过对每个测量时间点的贡献求和来计算：\n    $$\n    F = \\sum_{i=1}^{N} \\frac{1}{\\sigma^2} \\, \\tilde{s}_y(t_i) \\, \\tilde{s}_y(t_i)^{\\top}\n    $$\n    其中 $\\tilde{s}_y(t_i)$ 是归一化的测量灵敏度向量。该向量使用数值方法获得的灵敏度 $\\partial T_1 / \\partial h$（即 $Z_3(t_i)$）和 $\\partial T_1 / \\partial k$（即 $Z_5(t_i)$）来构建：\n    $$\n    \\tilde{s}_y(t_i) = \\begin{bmatrix} h \\cdot Z_3(t_i) \\\\ k \\cdot Z_5(t_i) \\end{bmatrix}\n    $$\n4.  通过检查FIM的特征值来评估参数对 $(h,k)$ 的局部可辨识性。由于FIM根据其构造是对称和半正定的，其特征值是实数且非负的。一个小的最小特征值 $\\lambda_{\\min}$ 表明，测量数据在区分沿相应特征向量方向的参数方面提供的信息很少。如果 $\\lambda_{\\min}$ 低于指定的阈值 $\\varepsilon = 10^{-6}$，则认为参数不是局部可辨识的。否则，它们是可辨识的。\n5.  对三个测试用例中的每一个重复此过程，并收集二进制结果（$1$ 表示可辨识，$0$ 表示不可辨识）。然后程序以指定格式输出这些结果。使用归一化灵敏度使得FIM和阈值 $\\varepsilon$ 无量纲，提供了一个尺度不变的准则。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case 1: Moderate internal gradients\n        {'L': 0.1, 'A': 0.5, 'rho': 800, 'c': 2000, 'k': 0.2, 'h': 40,\n         'T0': 293.15, 'T1_amb': 333.15, 'sigma': 0.05, 'Tend': 7200, 'N': 200},\n        # Case 2: Very small internal gradients\n        {'L': 0.005, 'A': 0.5, 'rho': 800, 'c': 2000, 'k': 20.0, 'h': 5.0,\n         'T0': 293.15, 'T1_amb': 333.15, 'sigma': 0.05, 'Tend': 7200, 'N': 200},\n        # Case 3: Very large internal gradients\n        {'L': 0.2, 'A': 0.5, 'rho': 800, 'c': 2000, 'k': 0.1, 'h': 300.0,\n         'T0': 293.15, 'T1_amb': 333.15, 'sigma': 0.05, 'Tend': 7200, 'N': 200},\n    ]\n\n    epsilon = 1e-6\n    results = []\n\n    for case in test_cases:\n        result = analyze_identifiability(case, epsilon)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef analyze_identifiability(params, epsilon):\n    \"\"\"\n    Analyzes a single test case for parameter identifiability.\n\n    Args:\n        params (dict): A dictionary containing all parameters for the test case.\n        epsilon (float): The identifiability threshold.\n\n    Returns:\n        int: 1 if identifiable, 0 otherwise.\n    \"\"\"\n    L, A, rho, c, k, h = params['L'], params['A'], params['rho'], params['c'], params['k'], params['h']\n    T0, T_amb_final = params['T0'], params['T1_amb']\n    sigma, Tend, N = params['sigma'], params['Tend'], params['N']\n\n    # 1. Calculate derived parameters\n    delta_x = L / 4.0\n    # The term 'm' is used for thermal capacity (J/K) in the problem statement.\n    m_cap = rho * c * A * delta_x\n    H = h * A\n    G = k * A / delta_x\n\n    # 2. Define the augmented ODE system\n    def ode_system(t, Z):\n        # Unpack the augmented state vector:\n        # Z = [T1, T2, Sh1, Sh2, Sk1, Sk2]\n        T1, T2, Sh1, Sh2, Sk1, Sk2 = Z\n\n        # State equations for temperatures\n        dT1_dt = (-H * (T1 - T_amb_final) - G * (T1 - T2)) / m_cap\n        dT2_dt = (G * (T1 - T2)) / m_cap\n\n        # Jacobian components\n        J11 = (-H - G) / m_cap\n        J12 = G / m_cap\n        J21 = G / m_cap\n        J22 = -G / m_cap\n\n        # Source term for h-sensitivity\n        bh1 = -A * (T1 - T_amb_final) / m_cap\n        # bh2 = 0\n\n        # Source term for k-sensitivity\n        bk_common = (A / delta_x) * (T1 - T2) / m_cap\n        bk1 = -bk_common\n        bk2 = bk_common\n\n        # Sensitivity equations for h\n        dSh1_dt = J11 * Sh1 + J12 * Sh2 + bh1\n        dSh2_dt = J21 * Sh1 + J22 * Sh2  # + bh2 (which is 0)\n\n        # Sensitivity equations for k\n        dSk1_dt = J11 * Sk1 + J12 * Sk2 + bk1\n        dSk2_dt = J21 * Sk1 + J22 * Sk2 + bk2\n\n        return [dT1_dt, dT2_dt, dSh1_dt, dSh2_dt, dSk1_dt, dSk2_dt]\n\n    # 3. Set initial conditions and time grid for integration\n    Z0 = [T0, T0, 0.0, 0.0, 0.0, 0.0]\n    t_span = [0.0, Tend]\n    t_eval = np.linspace(0.0, Tend, N)\n\n    # 4. Integrate the ODE system\n    sol = solve_ivp(ode_system, t_span, Z0, t_eval=t_eval, method='RK45')\n\n    # 5. Extract sensitivities of the measured output y(t) = T1(t)\n    Sh1_t = sol.y[2, :]  # d(T1)/dh\n    Sk1_t = sol.y[4, :]  # d(T1)/dk\n\n    # 6. Construct the Fisher Information Matrix (FIM)\n    FIM = np.zeros((2, 2))\n    for i in range(N):\n        # Normalized sensitivity vector for parameters (h, k)\n        s_tilde_y = np.array([\n            h * Sh1_t[i],\n            k * Sk1_t[i]\n        ]).reshape(2, 1)\n        \n        # Accumulate the outer product into the FIM\n        FIM += (1 / sigma**2) * (s_tilde_y @ s_tilde_y.T)\n\n    # 7. Compute eigenvalues and decide identifiability\n    # Use eigvalsh as FIM is symmetric\n    eigenvalues = np.linalg.eigvalsh(FIM)\n    lambda_min = np.min(eigenvalues)\n\n    return 1 if lambda_min = epsilon else 0\n\nsolve()\n```"
        }
    ]
}