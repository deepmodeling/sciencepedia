{
    "hands_on_practices": [
        {
            "introduction": "这项首个实践是基础性的。我们将从热力学第一定律出发，为一个简单而强大的储热模型——集总电容模型，推导其控制方程。通过完成这项练习，您将巩固对如何将物理原理转化为数学模型并求解其动态行为的理解，这是能源系统建模中的一项核心技能。",
            "id": "4130052",
            "problem": "一个混合均匀的热能储存元件（例如，一个充分搅拌的小型罐体或一个均质化的相变材料控制体）被建模为一个具有恒定热容 $C_{\\text{th}}$（单位为 $\\mathrm{J/K}$）的单一集总节点。该节点暴露于温度恒为 $T_{\\infty}$ 的周围环境中，并通过外部对流散热。该过程遵循牛顿冷却定律，其总传热系数为 $U$（单位为 $\\mathrm{W/(m^2\\,K)}$），作用面积为 $A$（单位为 $\\mathrm{m^2}$）。因此，乘积 $UA$ 的单位为 $\\mathrm{W/K}$。该节点接收一个可控的热输入速率 $\\dot{Q}_{\\text{in}}(t)$（单位为 $\\mathrm{W}$）。假设内部温度梯度可忽略不计（毕渥数小）、物性恒定，且边界上无功或质量传递。\n\n使用适用于固定质量控制体的热力学第一定律和集总热容法的内能定义，仅从基本陈述（能量平衡和牛顿冷却定律）出发：\n- 推导控制节点温度 $T(t)$ 的常微分方程（ODE），以及\n- 求解该 ODE，以获得当输入热流速率在 $t=0$ 时从 0 阶跃至恒定值 $Q_0$ 时的阶跃响应，初始条件为 $T(0)=T_{\\infty}$。\n\n将您的最终答案表示为关于 $T(t)$ 的单一闭式解析表达式，对 $t \\ge 0$ 有效。温度以开尔文表示。无需进行数值计算，也无需四舍五入。",
            "solution": "该问题陈述已经过严格验证，被认为是具有科学依据、提法恰当且客观的。它基于热力学和传热学的基本原理——特别是应用于标准集总热容模型的热力学第一定律和牛顿冷却定律。该问题是自洽的，提供了所有必要的符号常量、一个明确定义的强迫函数和一个清晰的初始条件。诸如毕渥数小等假设都已明确陈述，并且适用于该模型。因此，存在唯一且有意义的解。我们可以开始进行推导和求解。\n\n该问题要求分为两部分：首先，推导控制集总节点温度 $T(t)$ 的常微分方程（ODE）；其次，针对一个特定的阶跃函数热输入求解该 ODE。\n\n**第 1 部分：控制常微分方程的推导**\n\n我们从适用于封闭、固定质量控制体的热力学第一定律出发，该过程的动能和势能变化可忽略不计，且无功的相互作用。能量平衡可表述为：\n$$\n\\frac{dE}{dt} = \\dot{Q}_{\\text{net}}\n$$\n其中 $E$ 是系统的内能，$\\dot{Q}_{\\text{net}}$ 是进入系统的净传热速率。\n\n对于一个集总热容系统，其内能是其温度 $T$ 和热容 $C_{\\text{th}}$ 的函数。内能的变化率由下式给出：\n$$\n\\frac{dE}{dt} = C_{\\text{th}} \\frac{dT}{dt}\n$$\n净传热速率 $\\dot{Q}_{\\text{net}}$ 是所有穿过控制体边界的传热速率之和。在本问题中，有两项：\n1. 可控的热输入速率 $\\dot{Q}_{\\text{in}}(t)$。\n2. 与周围环境的对流散热速率。根据牛顿冷却定律，此热损失与节点和周围环境之间的温差 $T(t) - T_{\\infty}$ 成正比。散热速率为 $\\dot{Q}_{\\text{loss}} = UA(T(t) - T_{\\infty})$。\n\n因此，净热速率是热输入减去热损失：\n$$\n\\dot{Q}_{\\text{net}} = \\dot{Q}_{\\text{in}}(t) - UA(T(t) - T_{\\infty})\n$$\n将 $\\frac{dE}{dt}$ 和 $\\dot{Q}_{\\text{net}}$ 的表达式代入热力学第一定律的能量平衡方程，得到控制 ODE：\n$$\nC_{\\text{th}} \\frac{dT}{dt} = \\dot{Q}_{\\text{in}}(t) - UA(T(t) - T_{\\infty})\n$$\n这是集总节点温度的通用 ODE。它是一个一阶、线性、非齐次常微分方程。\n\n**第 2 部分：阶跃响应下 ODE 的求解**\n\n问题指定了时间 $t \\ge 0$ 时阶跃响应的条件：\n- 热输入速率为常数：$\\dot{Q}_{\\text{in}}(t) = Q_0$。\n- 初始条件为：$T(0) = T_{\\infty}$。\n\n将 $\\dot{Q}_{\\text{in}}(t) = Q_0$ 代入通用 ODE，我们得到：\n$$\nC_{\\text{th}} \\frac{dT}{dt} = Q_0 - UA(T - T_{\\infty})\n$$\n为了求解这个 ODE，我们首先将其整理成标准形式 $\\frac{dy}{dt} + P(t)y = Q(t)$：\n$$\nC_{\\text{th}} \\frac{dT}{dt} + UAT = Q_0 + UAT_{\\infty}\n$$\n两边同除以 $C_{\\text{th}}$ 可得：\n$$\n\\frac{dT}{dt} + \\frac{UA}{C_{\\text{th}}}T = \\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}}\n$$\n这是一个具有常系数的一阶线性 ODE。我们可以使用积分因子 $I(t)$ 来求解它。积分因子定义为 $I(t) = \\exp\\left(\\int \\frac{UA}{C_{\\text{th}}} dt\\right)$，其计算结果为：\n$$\nI(t) = \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)\n$$\n将整个 ODE 乘以 $I(t)$：\n$$\n\\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) \\frac{dT}{dt} + \\frac{UA}{C_{\\text{th}}} \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) T = \\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}} \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)\n$$\n左侧现在是乘积 $T(t)I(t)$ 的精确导数：\n$$\n\\frac{d}{dt}\\left(T \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)\\right) = \\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}} \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)\n$$\n我们将两边对时间从 $0$ 到 $t$ 进行积分：\n$$\n\\int_{0}^{t} \\frac{d}{d\\tau}\\left(T(\\tau) \\exp\\left(\\frac{UA}{C_{\\text{th}}}\\tau\\right)\\right) d\\tau = \\int_{0}^{t} \\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}} \\exp\\left(\\frac{UA}{C_{\\text{th}}}\\tau\\right) d\\tau\n$$\n使用微积分基本定理计算左侧：\n$$\n\\left[ T(\\tau) \\exp\\left(\\frac{UA}{C_{\\text{th}}}\\tau\\right) \\right]_{0}^{t} = T(t) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - T(0) \\exp(0)\n$$\n计算右侧积分：\n$$\n\\frac{Q_0 + UAT_{\\infty}}{C_{\\text{th}}} \\left[ \\frac{C_{\\text{th}}}{UA} \\exp\\left(\\frac{UA}{C_{\\text{th}}}\\tau\\right) \\right]_{0}^{t} = \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) \\left[ \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - \\exp(0) \\right]\n$$\n令两边相等并代入初始条件 $T(0) = T_{\\infty}$：\n$$\nT(t) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - T_{\\infty} = \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) \\left( \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - 1 \\right)\n$$\n现在，我们求解 $T(t)$：\n$$\nT(t) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) = T_{\\infty} + \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right)\n$$\n$$\nT(t) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) = \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) \\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right) - \\frac{Q_0}{UA}\n$$\n最后，两边同除以指数项 $\\exp\\left(\\frac{UA}{C_{\\text{th}}}t\\right)$ 以分离出 $T(t)$：\n$$\nT(t) = \\left(\\frac{Q_0}{UA} + T_{\\infty}\\right) - \\frac{Q_0}{UA} \\exp\\left(-\\frac{UA}{C_{\\text{th}}}t\\right)\n$$\n整理各项，得到 $t \\ge 0$ 时温度随时间变化的最终表达式：\n$$\nT(t) = T_{\\infty} + \\frac{Q_0}{UA} \\left( 1 - \\exp\\left(-\\frac{UA}{C_{\\text{th}}}t\\right) \\right)\n$$\n此表达式描述了节点的温度从环境温度 $T_{\\infty}$ 开始，以特征热时间常数 $\\tau = C_{\\text{th}}/(UA)$ 指数式地趋近于新的稳态温度 $T_{\\infty} + Q_0/(UA)$ 的过程。",
            "answer": "$$\n\\boxed{T(t) = T_{\\infty} + \\frac{Q_0}{UA} \\left( 1 - \\exp\\left(-\\frac{UA}{C_{\\text{th}}}t\\right) \\right)}\n$$"
        },
        {
            "introduction": "虽然集总模型很有用，但许多系统内部存在显著的温度梯度。这项实践将超越集总分析，转而对半无限大固体中的瞬态热传导进行建模，这是大型储罐的一种常见近似方法。您将使用相似性变换来求解热扩散偏微分方程，从而深入了解温度分布在空间和时间上的演变过程。",
            "id": "4130022",
            "problem": "一个大型分层热能储存（TES）罐，在充电开始后的短时间尺度内，被近似为一个占据 $x \\in [0,\\infty)$、具有恒定导热系数 $k$ 和热扩散率 $\\alpha$ 的一维半无限均匀固体。在 $t = 0$ 时，该固体初始处于均匀温度 $T_i$。在 $t > 0$ 时，传热流体（HTF）通过一个高导热界面，在表面 $x = 0$ 处瞬时施加一个新的恒定温度 $T_s$，使得对于所有 $t > 0$，边界条件为 $T(0,t) = T_s$，且远场保持初始温度，即 $\\lim_{x \\to \\infty} T(x,t) = T_i$。假设控制能量平衡为无内部热源的一维热扩散，并且热通量由傅里叶定律给出，符号约定为正热通量指向固体内部。\n\n从热扩散方程及所述的初始和边界条件出发，推导与表面温度突变一致的相似解。利用此解求得表面热通量 $q(0,t)$ 作为时间 $t$ 的函数的显式闭式解析表达式。最终答案需用 $k$、$\\alpha$、$T_s$、$T_i$ 和 $t$ 表示。不要代入数值。最终表达式必须是单一的闭式解析表达式。无需四舍五入。",
            "solution": "该物理问题是半无限固体中的一维瞬态热传导，由热扩散方程控制。\n\n在无内部热源的均匀介质中，温度 $T(x,t)$ 的控制偏微分方程（PDE）为：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中 $\\alpha$ 是热扩散率。\n\n该问题定义在域 $x \\in [0, \\infty)$ 和 $t \\ge 0$ 上。给出的初始和边界条件如下：\n初始条件 (IC): 对于 $x \\ge 0$，$T(x, 0) = T_i$。\n边界条件 (BCs):\n1. 对于 $t > 0$，$T(0, t) = T_s$。\n2. 对于 $t > 0$，$\\lim_{x \\to \\infty} T(x,t) = T_i$。\n\n为简化问题，我们引入一个无量纲温度 $\\theta(x,t)$，定义为：\n$$\n\\theta(x,t) = \\frac{T(x,t) - T_i}{T_s - T_i}\n$$\n用 $\\theta$ 表示的控制方程和条件变为：\nPDE: $\\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2}$\nIC: $\\theta(x,0) = \\frac{T_i - T_i}{T_s - T_i} = 0$\nBCs:\n1. $\\theta(0, t) = \\frac{T_s - T_i}{T_s - T_i} = 1$\n2. $\\lim_{x \\to \\infty} \\theta(x,t) = \\frac{T_i - T_i}{T_s - T_i} = 0$\n\n此问题缺少特征长度或时间尺度，这表明存在相似解。我们将自变量 $x$ 和 $t$ 组合成一个单一的相似变量 $\\eta$。根据热方程的量纲分析，$\\eta$ 的一个合适形式是：\n$$\n\\eta = \\frac{x}{2\\sqrt{\\alpha t}}\n$$\n我们假设解 $\\theta(x,t)$ 可以表示为仅关于 $\\eta$ 的函数，即 $\\theta(x,t) = f(\\eta)$。现在我们使用链式法则将 $\\theta$ 的偏导数转换为 $f$ 关于 $\\eta$ 的常导数：\n$$\n\\frac{\\partial \\theta}{\\partial t} = \\frac{df}{d\\eta} \\frac{\\partial \\eta}{\\partial t} = \\frac{df}{d\\eta} \\left( -\\frac{x}{4\\sqrt{\\alpha} t^{3/2}} \\right) = -\\frac{\\eta}{2t} \\frac{df}{d\\eta}\n$$\n$$\n\\frac{\\partial \\theta}{\\partial x} = \\frac{df}{d\\eta} \\frac{\\partial \\eta}{\\partial x} = \\frac{df}{d\\eta} \\left( \\frac{1}{2\\sqrt{\\alpha t}} \\right)\n$$\n$$\n\\frac{\\partial^2 \\theta}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left( \\frac{1}{2\\sqrt{\\alpha t}} \\frac{df}{d\\eta} \\right) = \\frac{1}{2\\sqrt{\\alpha t}} \\frac{d^2 f}{d\\eta^2} \\frac{\\partial \\eta}{\\partial x} = \\frac{1}{4\\alpha t} \\frac{d^2 f}{d\\eta^2}\n$$\n将这些代入关于 $\\theta$ 的热方程中：\n$$\n-\\frac{\\eta}{2t} \\frac{df}{d\\eta} = \\alpha \\left( \\frac{1}{4\\alpha t} \\frac{d^2 f}{d\\eta^2} \\right)\n$$\n简化此表达式得到一个关于 $f(\\eta)$ 的二阶常微分方程（ODE）：\n$$\n\\frac{d^2 f}{d\\eta^2} + 2\\eta \\frac{df}{d\\eta} = 0\n$$\n$\\theta$ 的边界条件转换为 $f(\\eta)$ 的边界条件。\n在 $x=0$ 处，$\\eta=0$，因此 $\\theta(0,t)=1$ 变为 $f(0)=1$。\n当 $x \\to \\infty$ 时，$\\eta \\to \\infty$，因此 $\\lim_{x \\to \\infty} \\theta(x,t)=0$ 变为 $\\lim_{\\eta \\to \\infty} f(\\eta) = 0$。\n\n为求解该ODE，令 $g(\\eta) = \\frac{df}{d\\eta}$。方程变为一个一阶可分离ODE：\n$$\n\\frac{dg}{d\\eta} = -2\\eta g \\implies \\frac{dg}{g} = -2\\eta d\\eta\n$$\n对两边积分得到 $\\ln(g) = -\\eta^2 + C_1$，这意味着 $g(\\eta) = C_2 \\exp(-\\eta^2)$，其中 $C_2 = \\exp(C_1)$。\n代回 $g(\\eta) = \\frac{df}{d\\eta}$：\n$$\n\\frac{df}{d\\eta} = C_2 \\exp(-\\eta^2)\n$$\n对 $\\eta$ 从 $0$ 到 $\\eta$ 积分：\n$$\nf(\\eta) - f(0) = C_2 \\int_0^\\eta \\exp(-\\xi^2) d\\xi\n$$\n该积分与误差函数 $\\text{erf}(\\eta) = \\frac{2}{\\sqrt{\\pi}} \\int_0^\\eta \\exp(-\\xi^2) d\\xi$ 相关。\n因此，$f(\\eta) - f(0) = C_2 \\frac{\\sqrt{\\pi}}{2} \\text{erf}(\\eta)$。\n整理并令 $A = C_2 \\frac{\\sqrt{\\pi}}{2}$ 和 $B = f(0)$，我们得到通解形式：$f(\\eta) = A \\cdot \\text{erf}(\\eta) + B$。\n\n我们应用变换后的边界条件来求常数 $A$ 和 $B$。\n由 $f(0)=1$ 可得：\n$f(0) = A \\cdot \\text{erf}(0) + B = A \\cdot 0 + B = 1 \\implies B=1$。\n由 $\\lim_{\\eta \\to \\infty} f(\\eta) = 0$ 可得：\n$\\lim_{\\eta \\to \\infty} (A \\cdot \\text{erf}(\\eta) + 1) = A \\cdot 1 + 1 = 0 \\implies A=-1$。\n$f(\\eta)$ 的解为：\n$$\nf(\\eta) = 1 - \\text{erf}(\\eta) = \\text{erfc}(\\eta)\n$$\n其中 $\\text{erfc}(\\eta)$ 是互补误差函数。\n\n无量纲温度 $\\theta(x,t)$ 的解为：\n$$\n\\theta(x,t) = \\text{erfc}\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right)\n$$\n转换回有量纲温度 $T(x,t)$：\n$$\n\\frac{T(x,t) - T_i}{T_s - T_i} = \\text{erfc}\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right)\n$$\n$$\nT(x,t) = T_i + (T_s - T_i) \\text{erfc}\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right)\n$$\n问题要求表面热通量 $q(0,t)$。热通量由傅里叶定律给出。根据正通量指向固体内部（正 $x$ 方向）的符号约定，公式为 $q(x,t) = -k \\frac{\\partial T}{\\partial x}$。\n首先，我们求温度梯度 $\\frac{\\partial T}{\\partial x}$：\n$$\n\\frac{\\partial T}{\\partial x} = (T_s - T_i) \\frac{\\partial}{\\partial x} \\left[ \\text{erfc}\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right) \\right]\n$$\n使用链式法则和互补误差函数的导数 $\\frac{d}{du}(\\text{erfc}(u)) = -\\frac{2}{\\sqrt{\\pi}} \\exp(-u^2)$：\n$$\n\\frac{\\partial T}{\\partial x} = (T_s - T_i) \\left[ -\\frac{2}{\\sqrt{\\pi}} \\exp\\left(-\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right)^2\\right) \\right] \\cdot \\frac{\\partial}{\\partial x}\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right)\n$$\n$$\n\\frac{\\partial T}{\\partial x} = (T_s - T_i) \\left[ -\\frac{2}{\\sqrt{\\pi}} \\exp\\left(-\\frac{x^2}{4\\alpha t}\\right) \\right] \\left( \\frac{1}{2\\sqrt{\\alpha t}} \\right)\n$$\n$$\n\\frac{\\partial T}{\\partial x} = -(T_s - T_i) \\frac{1}{\\sqrt{\\pi \\alpha t}} \\exp\\left(-\\frac{x^2}{4\\alpha t}\\right)\n$$\n现在，我们在表面 $x=0$ 处计算该梯度：\n$$\n\\left. \\frac{\\partial T}{\\partial x} \\right|_{x=0} = -(T_s - T_i) \\frac{1}{\\sqrt{\\pi \\alpha t}} \\exp(0) = -\\frac{T_s - T_i}{\\sqrt{\\pi \\alpha t}}\n$$\n最后，我们将此代入傅里叶定律以求得表面热通量 $q(0,t)$：\n$$\nq(0,t) = -k \\left. \\frac{\\partial T}{\\partial x} \\right|_{x=0} = -k \\left( -\\frac{T_s - T_i}{\\sqrt{\\pi \\alpha t}} \\right)\n$$\n$$\nq(0,t) = \\frac{k(T_s - T_i)}{\\sqrt{\\pi \\alpha t}}\n$$\n这就是表面热通量作为时间函数的最终闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{k(T_s - T_i)}{\\sqrt{\\pi \\alpha t}}}\n$$"
        },
        {
            "introduction": "模型的优劣取决于其参数，但这些参数是否能通过测量来确定呢？这项高级实践通过数值方法来解决参数可辨识性这一关键问题。通过对一个降阶模型实施灵敏度分析，您将探索实验条件如何影响我们从温度数据中唯一辨识导热系数和对流系数等关键热物性的能力。",
            "id": "4130016",
            "problem": "考虑一个热能储存（TES）元件，其模型为一个厚度为 $L$、横截面积为 $A$ 的一维平板，材料属性为密度 $\\rho$、比热容 $c$ 和导热系数 $k$。该平板通过暴露表面与温度为 $T_{\\infty}(t)$ 的环境流体进行热交换，对流换热系数为 $h$。由于有限的传导，存在内部温度梯度，因此需要一个能够捕捉梯度信息的空间集总降阶模型。根据对称性采用半平板表示，并将半厚度 $L/2$ 离散为2个厚度为 $\\Delta x = L/4$ 的等大控制体，其温度分别为 $T_1(t)$（靠近暴露表面）和 $T_2(t)$（靠近对称平面）。环境温度在时间 $t=0$ 时从 $T_0$ 阶跃到 $T_{amb}$，初始条件为均匀温度 $T_1(0)=T_2(0)=T_0$。测量输出为表面温度 $y(t)=T_1(t)$。\n\n从能量守恒和 Fourier 定律出发，写出降阶常微分方程（ODE）模型：\n- 每个控制体的热容为 $m = \\rho c A \\Delta x$。\n- 内部传导热导为 $G = \\dfrac{k A}{\\Delta x}$。\n- 外部对流热导为 $H = h A$。\n\n状态动力学由下式给出\n$$\n\\frac{dT_1}{dt} = \\frac{-H \\left(T_1 - T_{\\infty}(t)\\right) - G \\left(T_1 - T_2\\right)}{m}, \\quad\n\\frac{dT_2}{dt} = \\frac{+G \\left(T_1 - T_2\\right)}{m}.\n$$\n假设测量值 $y(t)$ 中的噪声是附加的、零均值的高斯噪声，其标准差 $\\sigma$（单位为开尔文）为常数。感兴趣的参数是对流换热系数 $h$ 和导热系数 $k$。定义灵敏度函数 $S_h(t) = \\dfrac{\\partial \\mathbf{T}}{\\partial h}(t)$ 和 $S_k(t) = \\dfrac{\\partial \\mathbf{T}}{\\partial k}(t)$，其中 $\\mathbf{T}(t) = [T_1(t), T_2(t)]^{\\top}$，它们满足灵敏度常微分方程（ODE）\n$$\n\\frac{dS_{\\theta}}{dt} = J(\\mathbf{T}, h, k)\\, S_{\\theta} + b_{\\theta}(\\mathbf{T}, h, k), \\quad \\theta \\in \\{h,k\\},\n$$\n其雅可比矩阵为\n$$\nJ(\\mathbf{T}, h, k) =\n\\begin{bmatrix}\n\\dfrac{-H - G}{m}  \\dfrac{G}{m} \\\\\n\\dfrac{G}{m}  \\dfrac{-G}{m}\n\\end{bmatrix},\n$$\n参数源项为\n$$\nb_h(\\mathbf{T}, h, k) =\n\\begin{bmatrix}\n\\dfrac{-A \\left(T_1 - T_{\\infty}(t)\\right)}{m} \\\\\n0\n\\end{bmatrix},\n\\qquad\nb_k(\\mathbf{T}, h, k) =\n\\begin{bmatrix}\n\\dfrac{-\\left(\\dfrac{A}{\\Delta x}\\right) \\left(T_1 - T_2\\right)}{m} \\\\\n\\dfrac{+\\left(\\dfrac{A}{\\Delta x}\\right) \\left(T_1 - T_2\\right)}{m}\n\\end{bmatrix}.\n$$\n假设 $S_h(0) = \\mathbf{0}$ 和 $S_k(0) = \\mathbf{0}$。在时间 $t$ 测量的关于 $h$ 和 $k$ 的灵敏度向量为 $s_y(t) = \\left[ \\dfrac{\\partial y}{\\partial h}(t), \\dfrac{\\partial y}{\\partial k}(t) \\right]^{\\top} = \\left[ \\dfrac{\\partial T_1}{\\partial h}(t), \\dfrac{\\partial T_1}{\\partial k}(t) \\right]^{\\top}$。为减小灵敏度的量纲影响，使用归一化灵敏度向量\n$$\n\\tilde{s}_y(t) = \\begin{bmatrix} h \\dfrac{\\partial T_1}{\\partial h}(t) \\\\ k \\dfrac{\\partial T_1}{\\partial k}(t) \\end{bmatrix}.\n$$\n将费雪信息矩阵（FIM）在采样时间 $\\{t_i\\}_{i=1}^N$ 上的离散时间近似定义为\n$$\nF = \\sum_{i=1}^{N} \\frac{1}{\\sigma^2} \\, \\tilde{s}_y(t_i) \\, \\tilde{s}_y(t_i)^{\\top}.\n$$\n通过评估 $F$ 的最小特征值 $\\lambda_{\\min}$ 来对参数对 $(h,k)$ 进行局部可辨识性判断：对于给定的阈值 $\\varepsilon$，如果 $\\lambda_{\\min} \\ge \\varepsilon$，则声明该参数对可从 $y(t)$ 中局部辨识；否则，声明其不可辨识。\n\n你的任务是实现一个程序，为给定的测试组积分由状态和灵敏度常微分方程组成的增广系统，构建 $F$ 矩阵，并判断可辨识性。使用以下测试组，它探讨了不同的毕渥数（Biot number）区间和内部梯度大小：\n\n- 测试用例1（中等内部梯度，预期可辨识）：$L = 0.1 \\, \\mathrm{m}$，$A = 0.5 \\, \\mathrm{m}^2$，$\\rho = 800 \\, \\mathrm{kg/m^3}$，$c = 2000 \\, \\mathrm{J/(kg \\cdot K)}$，$k = 0.2 \\, \\mathrm{W/(m \\cdot K)}$，$h = 40 \\, \\mathrm{W/(m^2 \\cdot K)}$，$T_0 = 293.15 \\, \\mathrm{K}$，$T_{amb} = 333.15 \\, \\mathrm{K}$，$\\sigma = 0.05 \\, \\mathrm{K}$，最终时间 $T_{\\mathrm{end}} = 7200 \\, \\mathrm{s}$，包含 $N = 200$ 个均匀间隔的样本。\n- 测试用例2（非常小的内部梯度，预期 $k$ 不可辨识）：$L = 0.005 \\, \\mathrm{m}$，$A = 0.5 \\, \\mathrm{m}^2$，$\\rho = 800 \\, \\mathrm{kg/m^3}$，$c = 2000 \\, \\mathrm{J/(kg \\cdot K)}$，$k = 20.0 \\, \\mathrm{W/(m \\cdot K)}$，$h = 5.0 \\, \\mathrm{W/(m^2 \\cdot K)}$，$T_0 = 293.15 \\, \\mathrm{K}$，$T_{amb} = 333.15 \\, \\mathrm{K}$，$\\sigma = 0.05 \\, \\mathrm{K}$，最终时间 $T_{\\mathrm{end}} = 7200 \\, \\mathrm{s}$，包含 $N = 200$ 个均匀间隔的样本。\n- 测试用例3（非常大的内部梯度，强传导限制）：$L = 0.2 \\, \\mathrm{m}$，$A = 0.5 \\, \\mathrm{m}^2$，$\\rho = 800 \\, \\mathrm{kg/m^3}$，$c = 2000 \\, \\mathrm{J/(kg \\cdot K)}$，$k = 0.1 \\, \\mathrm{W/(m \\cdot K)}$，$h = 300.0 \\, \\mathrm{W/(m^2 \\cdot K)}$，$T_0 = 293.15 \\, \\mathrm{K}$，$T_{amb} = 333.15 \\, \\mathrm{K}$，$\\sigma = 0.05 \\, \\mathrm{K}$，最终时间 $T_{\\mathrm{end}} = 7200 \\, \\mathrm{s}$，包含 $N = 200$ 个均匀间隔的样本。\n\n使用可辨识性阈值 $\\varepsilon = 10^{-6}$（由于归一化，此为无量纲值）。本问题不涉及角度。确保所有涉及物理量的计算都使用指定的单位。你的程序应生成单行输出，其中包含一个用逗号分隔的整数列表，每个测试用例对应一个条目，$1$ 表示局部可辨识，$0$ 表示局部不可辨识，并用方括号括起来。例如，如果前两个用例可辨识而第三个不可辨识，则输出必须是 `[1,1,0]`。",
            "solution": "问题陈述已经过仔细验证，被确定为具有科学依据、提法恰当且客观。它提出了一个应用于传热模型的系统辨识标准问题。其物理原理、数学公式和数值任务都得到了清晰且正确的定义。不存在会使该问题无效的矛盾、歧义或不成立的前提。因此，该问题是有效的，并将提供一个解决方案。\n\n目标是为一个简化的一维热能储存模型确定对流换热系数 $h$ 和导热系数 $k$ 的局部参数可辨识性。该决策基于费雪信息矩阵（FIM），该矩阵量化了测量的表面温度 $T_1(t)$ 中关于目标参数的信息含量。\n\n问题的核心在于求解一个增广常微分方程组（ODEs）。该系统由两个控制体的温度 $T_1(t)$ 和 $T_2(t)$ 的状态方程，以及这些温度对 $h$ 和 $k$ 的偏导数的灵敏度方程组成。\n\n设增广状态向量表示为 $\\mathbf{Z}(t)$，它是一个 $6 \\times 1$ 的列向量：\n$$\n\\mathbf{Z}(t) = \\begin{bmatrix} T_1(t) \\\\ T_2(t) \\\\ \\partial T_1 / \\partial h \\\\ \\partial T_2 / \\partial h \\\\ \\partial T_1 / \\partial k \\\\ \\partial T_2 / \\partial k \\end{bmatrix} = \\begin{bmatrix} Z_1 \\\\ Z_2 \\\\ Z_3 \\\\ Z_4 \\\\ Z_5 \\\\ Z_6 \\end{bmatrix}\n$$\n该增广系统的动力学方程 $\\dfrac{d\\mathbf{Z}}{dt}$ 是根据能量守恒和灵敏度分析原理推导出来的。首先计算模型所需的常数：控制体厚度 $\\Delta x = L/4$，控制体的热容 $m = \\rho c A \\Delta x$，外部对流热导 $H = h A$，以及内部传导热导 $G = k A / \\Delta x$。注意，问题陈述中使用符号 $m$ 表示热容（$[\\mathrm{J/K}]$），而不是质量。环境温度是一个阶跃函数，$T_{\\infty}(t) = T_{amb}$ 对于 $t \\ge 0$。\n\n构成系统 $\\dfrac{d\\mathbf{Z}}{dt} = f(t, \\mathbf{Z})$ 的六个常微分方程是：\n\n1.  **$T_1$ 的状态方程**：这是第一个控制体的能量平衡方程，考虑了与环境流体的对流以及向第二个控制体的传导。\n    $$\n    \\frac{dZ_1}{dt} = \\frac{dT_1}{dt} = \\frac{-H (T_1 - T_{\\infty}) - G (T_1 - T_2)}{m}\n    $$\n\n2.  **$T_2$ 的状态方程**：这是第二个控制体的能量平衡方程，它通过与第一个控制体进行传导换热，并在对称平面上有一个绝热边界。\n    $$\n    \\frac{dZ_2}{dt} = \\frac{dT_2}{dt} = \\frac{G (T_1 - T_2)}{m}\n    $$\n\n3.  **$S_h = [\\partial T_1/\\partial h, \\partial T_2/\\partial h]^\\top$ 的灵敏度方程**：这些方程描述了状态灵敏度的演化过程。它们是由状态自身驱动的线性常微分方程。\n    $$\n    \\begin{bmatrix} \\dfrac{dZ_3}{dt} \\\\ \\dfrac{dZ_4}{dt} \\end{bmatrix} =\n    J \\begin{bmatrix} Z_3 \\\\ Z_4 \\end{bmatrix} + b_h =\n    \\begin{bmatrix} \\dfrac{-H - G}{m}  \\dfrac{G}{m} \\\\ \\dfrac{G}{m}  \\dfrac{-G}{m} \\end{bmatrix} \\begin{bmatrix} Z_3 \\\\ Z_4 \\end{bmatrix} + \\begin{bmatrix} \\dfrac{-A (T_1 - T_{\\infty})}{m} \\\\ 0 \\end{bmatrix}\n    $$\n\n4.  **$S_k = [\\partial T_1/\\partial k, \\partial T_2/\\partial k]^\\top$ 的灵敏度方程**：与对 $h$ 的灵敏度类似，这些也是受迫线性常微分方程。\n    $$\n    \\begin{bmatrix} \\dfrac{dZ_5}{dt} \\\\ \\dfrac{dZ_6}{dt} \\end{bmatrix} =\n    J \\begin{bmatrix} Z_5 \\\\ Z_6 \\end{bmatrix} + b_k =\n    \\begin{bmatrix} \\dfrac{-H - G}{m}  \\dfrac{G}{m} \\\\ \\dfrac{G}{m}  \\dfrac{-G}{m} \\end{bmatrix} \\begin{bmatrix} Z_5 \\\\ Z_6 \\end{bmatrix} + \\begin{bmatrix} \\dfrac{-(A/\\Delta x) (T_1 - T_2)}{m} \\\\ \\dfrac{+(A/\\Delta x) (T_1 - T_2)}{m} \\end{bmatrix}\n    $$\n\n此初值问题的初始条件由均匀温度分布以及初始状态不依赖于参数 $h$ 和 $k$ 这一事实给出：\n$$\n\\mathbf{Z}(0) = [T_0, T_0, 0, 0, 0, 0]^\\top\n$$\n\n求解过程如下：\n1.  对每个测试用例，从 $t=0$ 到 $t=T_{\\mathrm{end}}$ 对包含六个常微分方程的增广系统进行数值积分。一个标准的数值求解器，如龙格-库塔（Runge-Kutta）方法是合适的。为此使用了 `scipy.integrate.solve_ivp` 函数。\n2.  积分得到 $\\mathbf{Z}(t)$ 所有六个分量随时间的演变。解在 $N=200$ 个均匀分布的时间点 $\\{t_i\\}_{i=1}^N$ 上进行评估。\n3.  构建费雪信息矩阵 $F$。对于两个参数 $(h,k)$，FIM 是一个 $2 \\times 2$ 的矩阵。它通过对每个测量时间点的贡献求和来计算：\n    $$\n    F = \\sum_{i=1}^{N} \\frac{1}{\\sigma^2} \\, \\tilde{s}_y(t_i) \\, \\tilde{s}_y(t_i)^{\\top}\n    $$\n    其中 $\\tilde{s}_y(t_i)$ 是归一化的测量灵敏度向量。该向量使用数值方法获得的灵敏度 $\\partial T_1 / \\partial h$（即 $Z_3(t_i)$）和 $\\partial T_1 / \\partial k$（即 $Z_5(t_i)$）来构建：\n    $$\n    \\tilde{s}_y(t_i) = \\begin{bmatrix} h \\cdot Z_3(t_i) \\\\ k \\cdot Z_5(t_i) \\end{bmatrix}\n    $$\n4.  通过检查 FIM 的特征值来评估参数对 $(h,k)$ 的局部可辨识性。由于 FIM 在构造上是对称且半正定的，其特征值为实数且非负。一个小的最小特征值 $\\lambda_{\\min}$ 表明测量数据几乎不提供沿着相应特征向量方向区分参数的信息。如果 $\\lambda_{\\min}$ 低于指定的阈值 $\\varepsilon = 10^{-6}$，则认为参数不是局部可辨识的。否则，它们是可辨识的。\n5.  对三个测试用例中的每一个重复此过程，并收集二元结果（$1$ 表示可辨识，$0$ 表示不可辨识）。然后程序以指定格式输出这些结果。使用归一化灵敏度使得 FIM 和阈值 $\\varepsilon$ 无量纲化，提供了一个尺度不变的准则。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case 1: Moderate internal gradients\n        {'L': 0.1, 'A': 0.5, 'rho': 800, 'c': 2000, 'k': 0.2, 'h': 40,\n         'T0': 293.15, 'T_amb': 333.15, 'sigma': 0.05, 'Tend': 7200, 'N': 200},\n        # Case 2: Very small internal gradients\n        {'L': 0.005, 'A': 0.5, 'rho': 800, 'c': 2000, 'k': 20.0, 'h': 5.0,\n         'T0': 293.15, 'T_amb': 333.15, 'sigma': 0.05, 'Tend': 7200, 'N': 200},\n        # Case 3: Very large internal gradients\n        {'L': 0.2, 'A': 0.5, 'rho': 800, 'c': 2000, 'k': 0.1, 'h': 300.0,\n         'T0': 293.15, 'T_amb': 333.15, 'sigma': 0.05, 'Tend': 7200, 'N': 200},\n    ]\n\n    epsilon = 1e-6\n    results = []\n\n    for case in test_cases:\n        result = analyze_identifiability(case, epsilon)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef analyze_identifiability(params, epsilon):\n    \"\"\"\n    Analyzes a single test case for parameter identifiability.\n\n    Args:\n        params (dict): A dictionary containing all parameters for the test case.\n        epsilon (float): The identifiability threshold.\n\n    Returns:\n        int: 1 if identifiable, 0 otherwise.\n    \"\"\"\n    L, A, rho, c, k, h = params['L'], params['A'], params['rho'], params['c'], params['k'], params['h']\n    T0, T_amb = params['T0'], params['T_amb']\n    sigma, Tend, N = params['sigma'], params['Tend'], params['N']\n\n    # 1. Calculate derived parameters\n    delta_x = L / 4.0\n    # The term 'm' is used for thermal capacity (J/K) in the problem statement.\n    m_cap = rho * c * A * delta_x\n    H = h * A\n    G = k * A / delta_x\n\n    # 2. Define the augmented ODE system\n    def ode_system(t, Z):\n        # Unpack the augmented state vector:\n        # Z = [T1, T2, Sh1, Sh2, Sk1, Sk2]\n        T1, T2, Sh1, Sh2, Sk1, Sk2 = Z\n\n        # State equations for temperatures\n        dT1_dt = (-H * (T1 - T_amb) - G * (T1 - T2)) / m_cap\n        dT2_dt = (G * (T1 - T2)) / m_cap\n\n        # Jacobian components\n        J11 = (-H - G) / m_cap\n        J12 = G / m_cap\n        J21 = G / m_cap\n        J22 = -G / m_cap\n\n        # Source term for h-sensitivity\n        bh1 = -A * (T1 - T_amb) / m_cap\n        # bh2 = 0\n\n        # Source term for k-sensitivity\n        bk_common = (A / delta_x) * (T1 - T2) / m_cap\n        bk1 = -bk_common\n        bk2 = bk_common\n\n        # Sensitivity equations for h\n        dSh1_dt = J11 * Sh1 + J12 * Sh2 + bh1\n        dSh2_dt = J21 * Sh1 + J22 * Sh2  # + bh2 (which is 0)\n\n        # Sensitivity equations for k\n        dSk1_dt = J11 * Sk1 + J12 * Sk2 + bk1\n        dSk2_dt = J21 * Sk1 + J22 * Sk2 + bk2\n\n        return [dT1_dt, dT2_dt, dSh1_dt, dSh2_dt, dSk1_dt, dSk2_dt]\n\n    # 3. Set initial conditions and time grid for integration\n    Z0 = [T0, T0, 0.0, 0.0, 0.0, 0.0]\n    t_span = [0.0, Tend]\n    t_eval = np.linspace(0.0, Tend, N)\n\n    # 4. Integrate the ODE system\n    sol = solve_ivp(ode_system, t_span, Z0, t_eval=t_eval, method='RK45')\n\n    # 5. Extract sensitivities of the measured output y(t) = T1(t)\n    Sh1_t = sol.y[2, :]  # d(T1)/dh\n    Sk1_t = sol.y[4, :]  # d(T1)/dk\n\n    # 6. Construct the Fisher Information Matrix (FIM)\n    FIM = np.zeros((2, 2))\n    for i in range(N):\n        # Normalized sensitivity vector for parameters (h, k)\n        s_tilde_y = np.array([\n            h * Sh1_t[i],\n            k * Sk1_t[i]\n        ]).reshape(2, 1)\n        \n        # Accumulate the outer product into the FIM\n        FIM += (1 / sigma**2) * (s_tilde_y @ s_tilde_y.T)\n\n    # 7. Compute eigenvalues and decide identifiability\n    # Use eigvalsh as FIM is symmetric\n    eigenvalues = np.linalg.eigvalsh(FIM)\n    lambda_min = np.min(eigenvalues)\n\n    return 1 if lambda_min >= epsilon else 0\n\nsolve()\n```",
            "answer": "[1,0,0]"
        }
    ]
}