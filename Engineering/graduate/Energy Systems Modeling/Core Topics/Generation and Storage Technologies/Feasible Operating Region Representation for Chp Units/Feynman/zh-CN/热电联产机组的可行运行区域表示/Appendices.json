{
    "hands_on_practices": [
        {
            "introduction": "构建热电联产（CHP）机组的可行运行域是能源系统优化的基础。本练习将指导您为燃气轮机热电联产机组建立一个线性模型，该模型捕捉了其发电量和供热量之间的基本权衡关系。通过计算特定功率下的最大热力输出，并考虑增补燃烧等辅助技术的影响，您将掌握如何将物理约束转化为优化模型中可用的数学不等式。",
            "id": "4091088",
            "problem": "燃气轮机热电联产（CHP）机组将一部分燃料化学能转化为电能，并在余热回收锅炉（HRSG）中回收废热以产生有用的热能。在能源系统建模中，CHP机组的可行运行区域可以表示为电-热平面上的一个凸集，由设备约束和能量平衡导出的线性不等式定义。考虑CHP机组的可行运行区域，它由所有满足 $H \\leq 0.9\\,P + 50$ 和 $P \\in [30,150]$ 的点对 $\\left(P,H\\right)$ 组成，其中 $P$ 表示电功率，单位为兆瓦电功率（MW$_{\\mathrm{e}}$），$H$ 表示回收的热量，单位为兆瓦热功率（MW$_{\\mathrm{th}}$）。假设在HRSG中有一个辅助燃烧器可用于补燃（DF），它可以独立于 $P$ 额外增加一个固定的热输出，最高可达 $\\bar{H}_{\\mathrm{df}}=30$，这实际上是将可行区域的热量上边界向上平移了这个常数值。\n\n从可行运行区域的定义出发，且不使用任何未引入的简化公式，确定在固定电功率 $P=120$ 时，在不使用补燃和使用所述补燃两种情况下的最大可行热输出。请用兆瓦热功率（MW$_{\\mathrm{th}}$）表示您的最终数值答案。无需四舍五入。",
            "solution": "热电联产（CHP）机组的可行运行区域定义为集合\n$$\n\\mathcal{F} \\;=\\; \\left\\{(P,H)\\;:\\; H \\leq 0.9\\,P + 50,\\; P \\in [30,150]\\right\\}。\n$$\n该表示法编码了热输出作为电功率函数的线性上限，反映了涡轮机排气能量与发电量之间的耦合关系。区间约束 $P \\in [30,150]$ 指定了与设备限制一致的允许电功率输出。\n\n我们寻求在固定电功率 $P=120$ 时的最大可行热量。根据定义，在固定的 $P$ 值下，最大可行热量是在所有具有该 $P$ 值的 $\\left(P,H\\right) \\in \\mathcal{F}$ 中 $H$ 的上确界。约束 $H \\leq 0.9\\,P + 50$ 直接给出，对于允许区间内的任何固定 $P$：\n$$\nH_{\\max}(P) \\;=\\; 0.9\\,P + 50,\n$$\n因为该不等式约束 $H$ 位于仿射函数下方，并且当没有其他约束在相同 $P$ 值下进一步限制 $H$ 时，可行最大值在等式成立时出现。固定电功率 $P=120$ 在允许区间 $[30,150]$ 内，因此我们可以计算\n$$\nH_{\\max}(120) \\;=\\; 0.9 \\times 120 + 50 \\;=\\; 108 + 50 \\;=\\; 158。\n$$\n\n现在考虑补燃（DF），其模型是在不改变 $P$ 的情况下，在任何电功率下向可回收热量中增加一个固定的热量 $\\bar{H}_{\\mathrm{df}}$。这在物理上对应于在HRSG中引入额外的燃料以提高排气温度，从而增加蒸汽产量。在这个线性可行区域表示法中，DF将热量上边界向上平移了 $\\bar{H}_{\\mathrm{df}}$，因此经过DF调整的可行区域的热量约束为\n$$\nH \\leq 0.9\\,P + 50 + \\bar{H}_{\\mathrm{df}}。\n$$\n当 $\\bar{H}_{\\mathrm{df}} = 30$ 时，固定 $P$ 时的最大可行热量变为\n$$\nH_{\\max}^{\\mathrm{df}}(P) \\;=\\; 0.9\\,P + 50 + 30 \\;=\\; 0.9\\,P + 80。\n$$\n在 $P=120$ 处进行计算，\n$$\nH_{\\max}^{\\mathrm{df}}(120) \\;=\\; 0.9 \\times 120 + 80 \\;=\\; 108 + 80 \\;=\\; 188。\n$$\n\n因此，在 $P=120$ 时，不使用补燃的最大可行热量为 $158$ MW$_{\\mathrm{th}}$，使用补燃时为 $188$ MW$_{\\mathrm{th}}$。",
            "answer": "$$\\boxed{\\begin{pmatrix}158 & 188\\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然线性模型易于处理，但许多热电联产机组的物理特性表现为非线性关系，尤其是在效率边界上。本练习探讨了一种核心建模技术：使用分段线性函数来近似一个平滑的、凹形的运行边界。通过构建一个由多条切线组成的上包络线，您将学会如何将复杂的非线性问题转化为线性规划框架内可解的形式，并能量化由此产生的近似误差。",
            "id": "4090952",
            "problem": "一个热电联产（CHP）机组的可行运行区域由电输出 $P$（单位：兆瓦电功率，MWe）和热输出 $H$（单位：兆瓦热功率，MWth）来表征。其上边界的下境图由光滑凹约束 $H \\leq \\phi(P)$ 给出，其中 $P \\in [0, P_{\\max}]$，边界函数为\n$$\n\\phi(P) = H_{0} - c P^{2},\n$$\n其中 $H_{0} > 0$ 且 $c > 0$。考虑 $H_{0} = 50$ MWth，$c = 0.015$ MWth/(MW)$^{2}$，以及 $P_{\\max} = 40$ MW。\n\n为获得一个混合整数线性规划兼容的表示，使用在 $[0, P_{\\max}]$ 区间上 $K+1$ 个等距点 $P_{i}$ 处的支撑线（切线）来构建 $\\phi(P)$ 的一个 $K$ 段分段线性上包络 $\\hat{\\phi}_{K}(P)$。设间距是均匀的，即 $P_{i} = i \\Delta$，其中 $i = 0, 1, \\dots, K$ 且 $\\Delta = P_{\\max}/K$。将近似误差定义为\n$$\n\\epsilon_{K} = \\sup_{P \\in [0, P_{\\max}]} \\left( \\hat{\\phi}_{K}(P) - \\phi(P) \\right).\n$$\n\n从凹函数的下境图是凸集以及支撑超平面为凹函数提供有效上界这些基本事实出发，推导 $\\epsilon_{K}$ 关于 $c$、$P_{\\max}$ 和 $K$ 的解析表达式。然后，使用给定参数计算当 $K=8$ 时 $\\epsilon_{K}$ 的数值。\n\n以 MWth 为单位表示你的最终数值答案 $\\epsilon_{K}$，并将其四舍五入到四位有效数字。",
            "solution": "由 $H \\leq \\phi(P)$ 定义的可行运行区域是 $\\phi(P)$ 的下境图。一个基本性质是凹函数的下境图是一个凸集。对于一个二阶连续可微的凹函数 $\\phi$，由切线给出的支撑超平面为该函数提供了全局上界。具体来说，在任意点 $P_{0}$ 处，\n$$\n\\phi(P) \\leq \\phi(P_{0}) + \\phi'(P_{0})(P - P_{0}),\n$$\n当 $P = P_{0}$ 时等号成立。\n\n为构建一个分段线性上包络，选择 $K+1$ 个等距点 $P_{i} = i \\Delta$，$i = 0, \\dots, K$，其中 $\\Delta = P_{\\max}/K$。定义支撑线（切线）\n$$\n\\ell_{i}(P) = \\phi(P_{i}) + \\phi'(P_{i})(P - P_{i}).\n$$\n由于 $\\phi$ 是凹函数，对于所有的 $P$，每个 $\\ell_{i}(P)$ 都是 $\\phi(P)$ 的一个上界。由这些切线形成的最紧上包络是它们的逐点最小值，\n$$\n\\hat{\\phi}_{K}(P) = \\min_{i \\in \\{0,1,\\dots,K\\}} \\ell_{i}(P),\n$$\n它是一个具有 $K$ 段的凹分段线性函数。\n\n我们寻求近似误差的上界\n$$\n\\epsilon_{K} = \\sup_{P \\in [0, P_{\\max}]} \\left( \\hat{\\phi}_{K}(P) - \\phi(P) \\right).\n$$\n\n来自泰勒定理的一般界：对于二阶连续可微的凹函数 $\\phi$，带有拉格朗日余项的泰勒定理意味着\n$$\n\\phi(P) = \\phi(P_{0}) + \\phi'(P_{0})(P - P_{0}) + \\frac{1}{2}\\phi''(\\xi)(P - P_{0})^{2}\n$$\n对于某个介于 $P$ 和 $P_{0}$ 之间的 $\\xi$。由于 $\\phi$ 是凹函数，所以 $\\phi''(\\xi) \\leq 0$。因此，在点 $P$ 相对于点 $P_{0}$ 的切线误差为\n$$\n\\ell_{0}(P) - \\phi(P) = -\\frac{1}{2}\\phi''(\\xi)(P - P_{0})^{2} \\leq \\frac{1}{2}\\Lambda (P - P_{0})^{2},\n$$\n其中 $\\Lambda = \\sup_{x \\in [0, P_{\\max}]} \\left( -\\phi''(x) \\right) \\geq 0$ 是一个曲率界。对于由在点 $P_{i}$ 处的切线构建的包络，在任意点 $P$ 的误差由最近切线的误差作为上界。到最近的 $P_{i}$ 的最大距离至多为 $\\Delta/2$。因此，\n$$\n\\epsilon_{K} \\leq \\frac{1}{2}\\Lambda \\left( \\frac{\\Delta}{2} \\right)^{2} = \\frac{\\Lambda \\Delta^{2}}{8}.\n$$\n\n现在，将问题具体化到二次的 CHP 边界 $\\phi(P) = H_{0} - cP^{2}$。那么\n$$\n\\phi'(P) = -2cP, \\quad \\phi''(P) = -2c,\n$$\n因此对于所有的 $P$，$\\Lambda = -\\phi''(P) = 2c$。一般界简化为\n$$\n\\epsilon_{K} \\leq \\frac{2c \\Delta^{2}}{8} = \\frac{c \\Delta^{2}}{4}.\n$$\n\n此外，对于二次函数的情况，使用在 $P_{i}$ 处的单一切线的误差可以被精确计算：\n\\begin{align*}\n\\ell_{i}(P) = \\phi(P_{i}) + \\phi'(P_{i})(P - P_{i}) \\\\\n= (H_{0} - cP_{i}^{2}) + (-2cP_{i})(P - P_{i}) \\\\\n= H_{0} + cP_{i}^{2} - 2cP_{i}P,\n\\end{align*}\n误差为\n$$\n\\ell_{i}(P) - \\phi(P) = H_{0} + cP_{i}^{2} - 2cP_{i}P - (H_{0} - cP^{2}) = c(P - P_{i})^{2}.\n$$\n在两个相邻的切点 $P_{i}$ 和 $P_{i+1}$ 之间，包络是 $\\ell_{i}$ 和 $\\ell_{i+1}$ 的最小值。这两条线相交于 $P^{*} = \\frac{P_{i} + P_{i+1}}{2}$（中点），在这一点上，相对于任一切线的误差为\n$$\nc\\left(P^{*} - P_{i}\\right)^{2} = c\\left(\\frac{\\Delta}{2}\\right)^{2} = \\frac{c \\Delta^{2}}{4}.\n$$\n这是在区间 $[P_{i}, P_{i+1}]$ 上的最大误差；因此，对于整个定义域，\n$$\n\\epsilon_{K} = \\frac{c \\Delta^{2}}{4} = \\frac{c}{4}\\left( \\frac{P_{\\max}}{K} \\right)^{2}.\n$$\n\n计算当 $K=8$，$P_{\\max} = 40$ MW，以及 $c = 0.015$ MWth/(MW)$^{2}$ 时的数值。首先，$\\Delta = P_{\\max}/K = 40/8 = 5$ MW。然后\n\\begin{align*}\n\\epsilon_{K} = \\frac{c \\Delta^{2}}{4} = \\frac{0.015 \\times 5^{2}}{4} = \\frac{0.015 \\times 25}{4} = \\frac{0.375}{4} = 0.09375 \\text{ MWth}.\n\\end{align*}\n四舍五入到四位有效数字，该值为 $0.09375$ MWth（等价于 $9.375 \\times 10^{-2}$ MWth）。要求的最终答案是这个以 MWth 为单位的数值界。",
            "answer": "$$\\boxed{9.375 \\times 10^{-2}}$$"
        },
        {
            "introduction": "在实际应用中，热电联产机组可能具有多个离散的运行模式，例如“燃烧”和“非燃烧”模式，每个模式都有其自身的可行域。这些模式的并集形成了一个非凸的整体运行区域，对标准线性规划构成了挑战。本练习将引导您使用混合整数线性规划（MILP）中的二元变量和“大M法”来精确地对这种非凸选择进行建模，并在此基础上求解一个以燃料成本最低为目标的优化问题。",
            "id": "4090999",
            "problem": "一个热电联产（CHP）单元可以在两种不同的模式下运行：非燃模式和燃烧模式。每种模式都对应于电-热平面上的一个凸可行运行区域。令 $P$ 表示以兆瓦（MW）为单位的电力输出， $H$ 表示以兆瓦热（MW）为单位的有用热输出。这两个凸区域的并集定义了 CHP 单元的总体可行运行区域。目标是使用一个二元变量 $y \\in \\{0,1\\}$ 通过大M约束来构建一个混合整数线性模型，以编码这两个区域的并集，然后计算满足给定需求水平的最小燃料消耗。\n\n基本原理：使用凸集、线性不等式和带指示变量的析取规划的定义。非燃模式和燃烧模式由线性不等式组表示。集合的并集通过一个二元变量表示，该变量一次选择一种模式，并使用大M常数来松弛非活动模式的约束。燃料消耗被建模为每种模式下关于 $P$ 和 $H$ 的线性函数。\n\n模式定义（所有参数单位为 MW）：\n- 非燃模式（模式 $0$， $y=0$），可行集 $\\mathcal{S}_0$：\n  1. $0 \\leq P \\leq 50$，\n  2. $0 \\leq H \\leq 120$，\n  3. $H \\geq 1.8P + 20$，\n  4. $H \\leq 2.5P + 40$。\n- 燃烧模式（模式 $1$， $y=1$），可行集 $\\mathcal{S}_1$：\n  1. $0 \\leq P \\leq 60$，\n  2. $30 \\leq H \\leq 180$，\n  3. $H \\geq 1.2P + 50$，\n  4. $H \\leq 3.0P + 60$。\n\n各模式的燃料消耗（所有系数单位为 MW 燃料 / MW 输出）：\n- 非燃模式燃料：$F_0 = 0.25P + 0.15H$，\n- 燃烧模式燃料：$F_1 = 0.22P + 0.20H + 10$。\n\n待满足的需求：\n- 电力需求 $P^{\\mathrm{d}}$ 和热力需求 $H^{\\mathrm{d}}$ 必须通过输出 $P \\geq P^{\\mathrm{d}}$ 和 $H \\geq H^{\\mathrm{d}}$ 来满足，同时保持在所选模式的可行集内。\n\n使用大M方法对并集进行混合整数编码：\n- 引入一个二元变量 $y \\in \\{0,1\\}$，当 $y=1$ 时表示燃烧模式，当 $y=0$ 时表示非燃模式。\n- 令 $z = (P,H)^\\top$ 表示决策向量，并将每种模式的约束表示为 $A_m z \\leq b_m$ 的形式，其中模式 $m \\in \\{0,1\\}$。\n- 对于模式 $0$ 的约束，编码为 $A_0 z \\leq b_0 + M_0 y$；对于模式 $1$ 的约束，编码为 $A_1 z \\leq b_1 + M_1(1-y)$，其中 $M_0$ 和 $M_1$ 是从变量边界导出的足够大的常数向量，以确保当一个模式处于非活动状态时，其约束变为非约束性。\n- 包含变量边界 $0 \\leq P \\leq 60$ 和 $0 \\leq H \\leq 180$，以及每种模式所需的额外显式边界。\n- 目标是在满足需求 $P \\geq P^{\\mathrm{d}}$ 和 $H \\geq H^{\\mathrm{d}}$ 的同时，最小化特定模式的燃料 $F = (1-y)F_0 + y F_1$。\n\n出于计算目的并避免目标函数中的双线性项，可以为每个固定的 $y \\in \\{0,1\\}$ 值求解两个线性规划（LP），然后选择更优的可行解。这等价于混合整数规划模型，因为只有两个析取项。\n\n任务：\n1. 使用所提供的不等式以及需求 $P^{\\mathrm{d}}$ 和 $H^{\\mathrm{d}}$ 作为 $P$ 和 $H$ 的下界，构建与两种模式相对应的线性规划（LP）。\n2. 对每个测试用例，求解两个 LP，并选择燃料消耗最小的可行解。如果两个 LP 都不可行，则返回不可行。\n3. 所有输出必须以兆瓦（MW）为单位表示，并四舍五入到三位小数。\n\n测试集（每个测试用例是一对以 MW 为单位的 $(P^{\\mathrm{d}}, H^{\\mathrm{d}})$）：\n- 用例 1：$(40, 110)$，\n- 用例 2：$(30, 170)$，\n- 用例 3：$(55, 80)$，\n- 用例 4：$(70, 200)$，\n- 用例 5：$(50, 165)$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果必须格式化为 $[\\,\\text{feasible}, y, P, H, F\\,]$ 形式的逗号分隔列表，不含空格，其中 $\\text{feasible}$ 是一个表示可行性的布尔值，$y$ 是所选模式（$0$ 代表非燃模式，$1$ 代表燃烧模式），$P$、$H$、$F$ 是以 MW 为单位且四舍五入到三位小数的浮点数。例如：$[[\\text{True},0,40.000,110.000,26.500],[\\text{False},0,0.000,0.000,0.000],\\dots]$。",
            "solution": "该问题要求找到一个热电联产（CHP）单元为满足指定的电力和热力需求 $(P^{\\mathrm{d}}, H^{\\mathrm{d}})$ 所需的最低燃料消耗。该 CHP 单元的运行范围是非燃模式（$\\mathcal{S}_0$）和燃烧模式（$\\mathcal{S}_1$）对应的两个凸集的并集。这个并集 $\\mathcal{S} = \\mathcal{S}_0 \\cup \\mathcal{S}_1$通常是非凸的。\n\n该问题可以建模为一个混合整数线性规划（MILP），其中一个二元变量 $y \\in \\{0, 1\\}$ 用来选择活动模式。然而，如问题陈述中所指出的，对于仅有两个集合之间的析取，一种计算上等效且更直接的方法是求解两个独立的线性规划（LP）（每种模式一个），然后选择目标值较低的可行解。\n\n设决策变量为电力输出 $P$ 和热力输出 $H$。对于每个测试用例 $(P^{\\mathrm{d}}, H^{\\mathrm{d}})$，优化问题被分解为两个子问题。\n\n**子问题 1：非燃模式（模式 0）**\n\n对于此模式，我们设置二元变量 $y=0$。目标是最小化燃料消耗 $F_0$。该问题被公式化为以下 LP：\n\n最小化：\n$$ F_0 = 0.25P + 0.15H $$\n\n约束条件为非燃模式的运行约束和给定的需求：\n1.  电力输出边界：$0 \\leq P \\leq 50$ MW。\n2.  热力输出边界：$0 \\leq H \\leq 120$ MW。\n3.  运行线 1：$H \\geq 1.8P + 20$。这可以写成 $-1.8P + H \\geq 20$。\n4.  运行线 2：$H \\leq 2.5P + 40$。这可以写成 $-2.5P + H \\leq 40$。\n5.  需求满足：$P \\geq P^{\\mathrm{d}}$ 和 $H \\geq H^{\\mathrm{d}}$。\n\n综合这些，该 LP 的可行域由以下条件定义：\n$$ \\max(0, P^{\\mathrm{d}}) \\leq P \\leq 50 $$\n$$ \\max(0, H^{\\mathrm{d}}) \\leq H \\leq 120 $$\n$$ -1.8P + H \\geq 20 $$\n$$ -2.5P + H \\leq 40 $$\n\n如果这个 LP 有可行解，设最优点为 $(P_0^*, H_0^*)$，最小燃料消耗为 $F_0^*$。如果不可行，则此模式下不存在解。\n\n**子问题 2：燃烧模式（模式 1）**\n\n对于此模式，我们设置二元变量 $y=1$。目标是最小化燃料消耗 $F_1$。该问题被公式化为以下 LP：\n\n最小化：\n$$ F_1 = 0.22P + 0.20H + 10 $$\n由于常数项 $10$ 不影响 $P$ 和 $H$ 的最优值，我们可以最小化 $F_1' = 0.22P + 0.20H$，然后将 $10$ 加到得到的最优值上。\n\n约束条件为燃烧模式的运行约束和给定的需求：\n1.  电力输出边界：$0 \\leq P \\leq 60$ MW。\n2.  热力输出边界：$30 \\leq H \\leq 180$ MW。\n3.  运行线 1：$H \\geq 1.2P + 50$。这可以写成 $-1.2P + H \\geq 50$。\n4.  运行线 2：$H \\leq 3.0P + 60$。这可以写成 $-3.0P + H \\leq 60$。\n5.  需求满足：$P \\geq P^{\\mathrm{d}}$ 和 $H \\geq H^{\\mathrm{d}}$。\n\n综合这些，该 LP 的可行域由以下条件定义：\n$$ \\max(0, P^{\\mathrm{d}}) \\leq P \\leq 60 $$\n$$ \\max(30, H^{\\mathrm{d}}) \\leq H \\leq 180 $$\n$$ -1.2P + H \\geq 50 $$\n$$ -3.0P + H \\leq 60 $$\n\n如果这个 LP 有可行解，设最优点为 $(P_1^*, H_1^*)$，最小燃料消耗为 $F_1^*$。如果不可行，则此模式下不存在解。\n\n**决策逻辑**\n\n对每个测试用例 $(P^{\\mathrm{d}}, H^{\\mathrm{d}})$，应用以下逻辑：\n1.  求解模式 0 的 LP。设结果为 $(\\text{feasible}_0, P_0^*, H_0^*, F_0^*)$。\n2.  求解模式 1 的 LP。设结果为 $(\\text{feasible}_1, P_1^*, H_1^*, F_1^*)$。\n3.  比较结果：\n    -   如果两种模式都不可行（$\\text{feasible}_0 = \\text{False}$ 且 $\\text{feasible}_1 = \\text{False}$），则整个问题不可行。\n    -   如果只有模式 0 可行，则最优解为 $(P, H, F) = (P_0^*, H_0^*, F_0^*)$，其中 $y=0$。\n    -   如果只有模式 1 可行，则最优解为 $(P, H, F) = (P_1^*, H_1^*, F_1^*)$，其中 $y=1$。\n    -   如果两种模式都可行，我们比较最小燃料消耗。如果 $F_0^* \\leq F_1^*$，则最优解来自模式 0。否则，来自模式 1。\n\n`scipy.optimize.linprog` 函数用于求解每个 LP。约束以求解器所需的标准形式提供，不等式约束表示为 $A_{ub}x \\leq b_{ub}$，并附有变量边界。对于形如 $H \\geq f(P)$ 的不等式，它们被重写为 $-H \\leq -f(P)$ 以符合标准形式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves a series of optimization problems for a Combined Heat and Power (CHP) unit.\n    For each demand case, it finds the minimum fuel operating point by solving\n    two linear programs, one for each operating mode (unfired and fired), and\n    selecting the optimal feasible solution.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple (P_demand, H_demand) in MW.\n    test_cases = [\n        (40, 110),\n        (30, 170),\n        (55, 80),\n        (70, 200),\n        (50, 165),\n    ]\n\n    results = []\n    for p_demand, h_demand in test_cases:\n        # Solve for Mode 0 (unfired)\n        c0 = np.array([0.25, 0.15]) # P, H coefficients in F_0\n        # H >= 1.8P + 20  =>  -1.8P + H >= 20 => 1.8P - H = -20\n        # H = 2.5P + 40  => -2.5P + H = 40\n        A_ub0 = np.array([[1.8, -1.0], [-2.5, 1.0]])\n        b_ub0 = np.array([-20.0, 40.0])\n        p_bounds0 = (max(0, p_demand), 50.0)\n        h_bounds0 = (max(0, h_demand), 120.0)\n\n        res0 = linprog(c=c0, A_ub=A_ub0, b_ub=b_ub0, bounds=[p_bounds0, h_bounds0], method='highs')\n        \n        sol0 = None\n        if res0.success:\n            p_opt, h_opt = res0.x\n            f_opt = res0.fun\n            sol0 = (True, 0, p_opt, h_opt, f_opt)\n\n        # Solve for Mode 1 (fired)\n        c1 = np.array([0.22, 0.20]) # P, H coefficients in F_1 (constant 10 is added later)\n        # H >= 1.2P + 50  =>  -1.2P + H >= 50 => 1.2P - H = -50\n        # H = 3.0P + 60  => -3.0P + H = 60\n        A_ub1 = np.array([[1.2, -1.0], [-3.0, 1.0]])\n        b_ub1 = np.array([-50.0, 60.0])\n        p_bounds1 = (max(0, p_demand), 60.0)\n        h_bounds1 = (max(30.0, h_demand), 180.0)\n\n        res1 = linprog(c=c1, A_ub=A_ub1, b_ub=b_ub1, bounds=[p_bounds1, h_bounds1], method='highs')\n\n        sol1 = None\n        if res1.success:\n            p_opt, h_opt = res1.x\n            f_opt = res1.fun + 10.0 # Add the constant part of F_1\n            sol1 = (True, 1, p_opt, h_opt, f_opt)\n\n        # Compare results and select the best one\n        final_sol = None\n        if sol0 and sol1:\n            if sol0[4] = sol1[4]:\n                final_sol = sol0\n            else:\n                final_sol = sol1\n        elif sol0:\n            final_sol = sol0\n        elif sol1:\n            final_sol = sol1\n        else:\n            final_sol = (False, 0, 0.0, 0.0, 0.0)\n            \n        # Format the result string as per requirements\n        feasible, y, p, h, f = final_sol\n        result_str = f\"[{str(feasible)},{y},{p:.3f},{h:.3f},{f:.3f}]\"\n        results.append(result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}