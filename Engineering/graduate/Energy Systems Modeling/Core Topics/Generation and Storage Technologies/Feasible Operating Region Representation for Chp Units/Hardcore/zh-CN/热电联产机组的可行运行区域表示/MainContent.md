## 引言
[热电联产](@entry_id:1122671)（CHP）机组是现代能源系统的关键组成部分，通过同时生产电能和热能，它们实现了远超传统独立发电和供热的能源利用效率。然而，要充分发挥其潜力，尤其是在与波动性可再生能源日益融合的电网中，关键在于能够精确地描述和优化其复杂的运行特性。对机组可行运行域——即其所有物理上可行的热、电输出组合——的不当建模，可能导致次优的[经济调度](@entry_id:143387)、不可靠的系统运行，甚至错失能源整合的良机。本文旨在填补理论与实践之间的鸿沟，为读者提供一个关于CHP可行运行域建模的全面指南。

为实现这一目标，本文将分三步深入展开。在第一章“原理与机制”中，我们将从[热力学第一定律](@entry_id:146485)出发，构建描述机组运行边界的数学模型，并探讨从简化的[凸多边形](@entry_id:165008)近似到包含最小负荷等非凸特性的高级模型的演进。随后，在第二章“应用与跨学科联系”中，我们将展示这些模型如何在[经济调度](@entry_id:143387)、[机组组合](@entry_id:1133606)、[电网辅助服务](@entry_id:1125779)以及更广泛的综合能源系统中发挥关键作用。最后，通过第三章“动手实践”，读者将有机会通过具体的编程练习，将理论知识转化为解决实际问题的能力。通过这一结构化的学习路径，本文旨在帮助读者掌握精确表示CHP机组运行灵活性的核心方法，并将其应用于解决现实世界中的能源系统挑战。

## 原理与机制

本章旨在深入阐述描述[热电联产](@entry_id:1122671)（CHP）机组可行运行域的物理原理与数学模型。我们将从最基本的热力学第一定律出发，逐步构建起一个精确且实用的模型框架，该框架不仅能反映能量转换的基本约束，还能体现不同技术路线（如[背压](@entry_id:746637)式和抽汽冷凝式）的特定运行特性。最后，我们将探讨在何种情况下，以及为何需要引入非凸性来更真实地刻画机组的运行特性，并介绍相应的建模方法。

### 基本约束：能量守恒

任何[能量转换](@entry_id:165656)设备都必须遵循[热力学第一定律](@entry_id:146485)，即能量守恒。对于一个在[稳态](@entry_id:139253)下运行的热电联产机组，输入的能量速率必须等于所有输出的能量速率之和。设燃料的化学能输入速率为 $F$（单位为兆瓦燃料，$\mathrm{MW_{fuel}}$），有效的电功率输出为 $P$（单位为兆瓦电，$\mathrm{MW_{e}}$），有效的热功率输出为 $H$（单位为兆瓦热，$\mathrm{MW_{th}}$），而所有形式的能量损失（如排烟损失、散热损失等）的总速率为 $L_{\text{loss}}$。[稳态](@entry_id:139253)能量平衡方程可以写作：

$F = P + H + L_{\text{loss}}$

根据[热力学](@entry_id:172368)第二定律，任何真实的能量转换过程都必然伴随着不可避免的损失，因此 $L_{\text{loss}} > 0$。在理论极限情况下，$L_{\text{loss}}$可以趋近于零。所以，对于任何可行的运行点，我们必然有 $L_{\text{loss}} \ge 0$，这直接导出了一个根本性的[不等式约束](@entry_id:176084)：

$P + H \le F$

这个不等式表明，一个[热电联产](@entry_id:1122671)机组的总[有效能](@entry_id:139794)量输出（电和热）绝不可能超过其燃料输入。这意味着[电功率](@entry_id:273774) $P$ 和热功率 $H$ 之间存在一个基本的权衡关系：在燃料输入固定的情况下，提高一种形式的输出必然以牺牲另一种形式的输出为代价。因此，那种将 $P$ 和 $H$ 视为相互独立，并将可行域描述为一个简单矩形的模型，从物理基础上就是错误的。

为了更精确地量化这一关系，我们引入效率的概念。**发电效率** $\eta_e$ 和**供热效率** $\eta_h$ 分别定义为：

$\eta_e = \frac{P}{F}$
$\eta_h = \frac{H}{F}$

这些效率值通常不是恒定的，而是随着运行点 $(P, H)$ 的变化而变化。**总效率** $\eta_{\text{tot}}$ 定义为总有效输出与燃料输入之比：

$\eta_{\text{tot}} = \frac{P + H}{F} = \eta_e + \eta_h$

由能量守恒定律可知，任何真实设备的总效率都必须小于或等于1，即 $\eta_{\text{tot}} \le 1$。

在实际建模中，机组的燃料输入速率本身也受到物理限制（如燃烧器容量、燃料供应系统能力等），存在一个最大值 $F^{\max}$。结合总效率的上限（设为特定技术能达到的最大总效率 $\eta_{\text{tot}}^{\max} \le 1$），我们可以得到可行运行域的一个外部边界：

$P + H \le \eta_{\text{tot}}^{\max} F^{\max}$

在 $(P, H)$ 平面坐标系中，这个不等式定义了一个闭合的半平面。其边界是一条直线 $P + H = \text{常数}$，该[直线的斜率](@entry_id:165209)为-1。若以 $P$ 轴为基准，逆时针测量角度，这条边界线的[方向角](@entry_id:167868)为 $135^{\circ}$ 或 $\frac{3\pi}{4}$ [弧度](@entry_id:171693)。如果我们将这条线视为一个沿 $P$ 增加方向的有向线，其与正 $P$ 轴的夹角则为 $-\frac{\pi}{4}$ 弧度。这个简单的线性边界是所有热电联产机组可行运行域模型的基础。

### 特定技术的运行区域

虽然能量守恒定律给出了一个普适的外部边界，但可行运行域的具体形状和内部结构则由[热电联产](@entry_id:1122671)机组采用的具体技术路线决定。

#### [背压式汽轮机](@entry_id:1121306)

**[背压式汽轮机](@entry_id:1121306)**是一种结构相对简单的热电联产技术。高温高压蒸汽通过汽轮机做功发电，乏汽在某个预设的[背压](@entry_id:746637)下排出，其剩余的热焓全部用于对外供热。在这种模式下，发电量和供热量之间存在严格的耦合关系。

从热力学第一定律可知，对于稳态流动的汽轮机和[换热器](@entry_id:154905)，[电功率](@entry_id:273774) $P$ 和热功率 $H$ 分别与流经系统的工质（蒸汽）[质量流](@entry_id:143424)量 $\dot{m}$ 成正比：

$P \propto \dot{m} \cdot \Delta h_{\text{turbine}}$
$H \propto \dot{m} \cdot \Delta h_{\text{heater}}$

其中 $\Delta h_{\text{turbine}}$ 是蒸汽在汽轮机中做功的焓降，$\Delta h_{\text{heater}}$ 是乏汽在换热器中放热的焓降。在一个理想化的模型中，我们假设汽轮机效率和各处的焓降在主要运行区间内保持不变。这样，热功率和电功率之间就呈现出完美的线[性比](@entry_id:172643)例关系：

$H = \rho P$

这里的常数 $\rho$ 被称为**热电比**，它由机组的[热力学](@entry_id:172368)设计参数唯一确定。因此，一个理想[背压](@entry_id:746637)机组的可行运行域在 $(P, H)$ 平面上是一条从原点（或最小运行点）出发的线段，其范围由最小发[电功率](@entry_id:273774) $P^{\min}$ 和最大发[电功率](@entry_id:273774) $P^{\max}$ 限定。

在实际操作中，由于效率随负荷变化等因素，热电比并非严格恒定。为了在保持模型线性的同时捕捉这种有限的灵活性，一种常见的做法是用一个狭窄的锥形区域来近似这条线段。例如，可以允许热电比在理想值 $\rho$ 周围有一个小的容差 $\alpha$：

$H \in [(1-\alpha)\rho P, (1+\alpha)\rho P]$

这个模型由两条穿过原点的直线构成边界，它将理想化的线段扩展为一个更贴近实际的二维多边形区域，从而提高了模型的灵活性和现实性。

#### 抽汽冷凝式汽轮机

与[背压](@entry_id:746637)式机组不同，**抽汽冷凝式汽轮机**提供了更高的运行灵活性。在这种设计中，一部分蒸汽可以在汽轮机的中间级被抽出（extraction）用于供热，而剩余的蒸汽则继续在低压级中膨胀做功，最后排入冷凝器（condenser）。通过调节抽汽量，机组可以在很大范围内独立地改变其电、热输出。

这种灵活性的代价是电与热之间更为复杂的权衡关系。当增加抽汽量以提供更多的热输出 $H$ 时，进入汽轮机低压级的蒸汽量就会减少，从而导致电功率 $P$ 的下降。这个权衡关系是理解抽汽机组可行域的关键。

我们可以精确地量化这种权衡。定义一个边际[耦合系数](@entry_id:273384) $\gamma$，它表示每增加一单位的热输出所导致的电输出损失量。假设从汽轮机中多抽取一小部分[质量流](@entry_id:143424)量为 $d\dot{m}_{\text{ex}}$ 的蒸汽用于供热，这部分蒸汽在换热器中释放的热量为 $dQ_h = (h_{\text{ex}} - h_{\text{ret}}) d\dot{m}_{\text{ex}}$，其中 $h_{\text{ex}}$ 和 $h_{\text{ret}}$ 分别是抽取点蒸汽和返回的凝结水的比焓。与此同时，这部分蒸汽本来可以在低压级中继续做功，产生的电能为 $dP_e = \eta_{\text{me}} w_{\text{LP,s}} d\dot{m}_{\text{ex}}$，其中 $w_{\text{LP,s}}$ 是这部分蒸汽在低压级的比轴功，$\eta_{\text{me}}$ 是机械-电气转换效率。因此，这个边际权衡系数 $\gamma$ 可以通过以下方式从[热力学](@entry_id:172368)参数中导出：

$\gamma = -\frac{dP_e}{dQ_h} = \frac{\eta_{\text{me}} w_{\text{LP,s}}}{h_{\text{ex}} - h_{\text{ret}}}$

这个系数 $\gamma$ 通常被称为“电[损失系数](@entry_id:276929)”。它构成了可行运行域的一条重要边界，其线性近似形式为 $P \le P_0 - \gamma H$，其中 $P_0$ 是纯凝汽发电（不抽汽供热）时的[最大功](@entry_id:143924)率。

除了这种由能量权衡决定的边界外，还存在其他由设备物理特性决定的约束。例如，为了避免汽轮机末级叶片因蒸汽湿度过高而发生水滴侵蚀，制造商通常会规定一个最小的低压缸通流比例。这意味着抽汽量不能无限增加。这个约束可以表示为热功率和[电功率](@entry_id:273774)之间的另一种线性关系，例如 $H \le \chi P$。这个系数 $\chi$ 取决于最小通流份额、低压缸做功能力和抽汽的放热能力等参数。

### 构建可行运行域：[凸多边形](@entry_id:165008)近似

在[能源系统规划](@entry_id:1124498)和调度模型中，为了保证问题的计算易解性（tractability），通常将热电联产机组的复杂可行运行域近似为一个**[凸多边形](@entry_id:165008)**（convex polygon）。这个多边形是通过联立所有相关的[线性不等式](@entry_id:174297)约束而形成的。一个典型的抽汽冷凝机组的[线性模型](@entry_id:178302)会包含以下几类约束：

1.  **容量限制**：$P^{\min} \le P \le P^{\max}$ 和 $H^{\min} \le H \le H^{\max}$。这定义了一个基本的矩形运行框架。
2.  **能量守恒/燃料上限**：$aP + bH \le c$。这是对[热力学第一定律](@entry_id:146485)的线性化近似，反映了总能量输出的上限。
3.  **技术权衡**：如上文讨论的抽汽限制 $P \le P_0 - \gamma H$ 或[背压](@entry_id:746637)特性线 $P \ge \alpha H + \beta$ 等。

这些不等式中的每一个都在 $(P, H)$ 平面上定义了一个闭合半平面。所有这些半平面的交集就构成了一个[凸多边形](@entry_id:165008)。从数学上讲，**多个[凸集](@entry_id:155617)的交集必然是[凸集](@entry_id:155617)**，这就是为什么线性化模型总能产生一个凸的可行运行域。

在构建模型时，区分**技术依赖约束**和**系统层面约束**至关重要。上述所有约束都属于技术依赖约束，因为它们描述的是机组自身的、固有的物理和工程属性。它们共同定义了机组“能够”做什么。而像满足系统总负荷需求、遵守区域排放总量限制等约束，则属于系统层面约束。这些约束是在优化模型中施加于机组之上的，用来决定机组在特定时刻“必须”做什么，即从其可行运行域内选择一个最优的运行点。良好的建模实践要求将这两个层面清晰地分离开来。

### 超越[凸多边形](@entry_id:165008)：非凸性与最小负荷

尽管[凸多边形](@entry_id:165008)近似在许多应用中非常有效，但真实的[热电联产](@entry_id:1122671)机组的可行运行域往往存在**非[凸性](@entry_id:138568)**（non-convexity）。忽略这些非凸特性可能会导致模型不准确或得到次优甚至不可行的调度方案。

#### 最小负荷约束

许多热力设备，包括[热电联产](@entry_id:1122671)机组，都无法在任意低的负荷下稳定运行。它们存在一个**最小稳定负荷**。当机组启动并网后，其[电功率](@entry_id:273774)和热功率必须维持在某个最小阈值之上，即 $P \ge P^{\min}$ 和 $H \ge H^{\min}$。

这个最小负荷限制源于深刻的物理原因。例如，最小[电功率](@entry_id:273774) $P^{\min}$ 通常与[燃烧稳定性](@entry_id:1122680)有关。在燃气轮机等连续流燃烧室中，为了维持火焰的稳定燃烧，必须保证燃料-空气混合物的流速、温度和浓度在特定范围内，以避免火焰熄灭（blow-off）。这要求一个最小的燃料输入速率，从而对应一个最小的功率输出。这一现象可以通过无量纲的**丹柯勒数（Damköhler number）**来描述，它代表了流体[停留时间](@entry_id:263953)与化学反应时间的比率，必须维持在临界值之上。

类似地，最小热功率 $H^{\min}$ 可能与热回收系统的设计有关。例如，在依赖自然循环（[浮力](@entry_id:154088)驱动）的热回收锅炉中，必须有足够的热输入来产生足够的密度差，以驱动工质循环并克服流动阻力。低于这个阈值，循环就会停滞，导致传热失效和设备损坏。

这些最小负荷要求使得可行运行域变得非凸。具体来说，[可行域](@entry_id:136622)是两个不相连部分的并集：一个点是原点 $(0, 0)$（代表机组停机），另一个是满足所有运行约束（包括 $P \ge P^{\min}$ 和 $H \ge H^{\min}$）的[凸多边形](@entry_id:165008)区域。这种不连通的集合是典型的非[凸集](@entry_id:155617)。在[混合整数线性规划](@entry_id:1127955)（MILP）模型中，这通常通过引入一个二进制变量 $u \in \{0, 1\}$ 来表示：

$P \ge P^{\min} u$
$H \ge H^{\min} u$

当机组运行时 ($u=1$)，这些约束生效；当机组停机时 ($u=0$)，它们则松弛为 $P \ge 0$ 和 $H \ge 0$。

#### 非凸性的其他来源

除了最小负荷，还有其他物理现象会导致可行运行域出现非凸的“[凹痕](@entry_id:159131)”或“[禁区](@entry_id:175956)”。

-   **阀点效应（Valve-Point Effects）**：大型蒸汽轮机通常通过顺序开启多个调节阀来增加蒸汽进气量以提升负荷。在每个新阀门刚刚开启的瞬间，蒸汽会经历一个[节流过程](@entry_id:146484)，导致效率短暂下降，直到该阀门完全打开。这使得机组的燃料-功率曲线呈现出非凹的波浪形态，反映在 $(P, H)$ 平面上，就可能导致可行域边界出现[凹痕](@entry_id:159131)。

-   **离散运行模式**：复杂的机组可能具有多种离散的运行模式，例如，[联合循环](@entry_id:185995)机组的补燃系统可以开启或关闭。每种模式都有其自身的、通常是凸的可行运行域。整个机组的总[可行域](@entry_id:136622)是这些独立区域的**并集**。而多个[凸集](@entry_id:155617)的并集通常是一个非[凸集](@entry_id:155617)。

在[数学建模](@entry_id:262517)中，这些非凸性可以通过引入额外的二进制变量和[逻辑约束](@entry_id:635151)来精确描述。例如，一个由操作不稳定性导致的“禁止运行楔形区”可以被模型化为一个析取（disjunction）：运行点 $(p, h)$ 必须位于楔形区的一侧“或”另一侧。这种逻辑“或”关系可以使用**大M（big-M）方法**转化为一组标准的混合整数[线性约束](@entry_id:636966)。通过这种方式，即使是复杂的非凸可行域也能够被精确地纳入到优化模型中进行求解。

综上所述，热电联产机组的可行运行域是一个由[热力学定律](@entry_id:202285)和具体技术细节共同决定的复杂几何区域。虽然[凸多边形](@entry_id:165008)是其在许[多能源系统](@entry_id:1128259)模型中的标准简化表示，但深刻理解最小负荷、阀点效应和离散模式等导致非[凸性](@entry_id:138568)的物理机制，对于构建更精确、更可靠的高级模型至关重要。