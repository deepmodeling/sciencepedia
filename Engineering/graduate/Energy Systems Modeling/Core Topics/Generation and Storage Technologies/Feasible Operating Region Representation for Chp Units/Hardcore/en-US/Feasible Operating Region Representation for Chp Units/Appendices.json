{
    "hands_on_practices": [
        {
            "introduction": "Many real-world engineering systems, including CHP units, exhibit non-linear relationships between inputs and outputs. While these non-linear models offer high fidelity, they can be computationally prohibitive for large-scale energy system optimization. This practice  introduces a cornerstone technique: approximating a smooth, non-linear operating boundary with a piecewise-linear envelope. You will learn how to construct this approximation using supporting tangent lines and, critically, how to derive an analytical expression for the resulting error, bridging the gap between physical accuracy and computational tractability.",
            "id": "4090952",
            "problem": "A Combined Heat and Power (CHP) unit has a feasible operating region characterized by electrical output $P$ (in megawatts electric, MW$_\\text{e}$) and heat output $H$ (in megawatts thermal, MW$_\\text{th}$). The hypograph of the upper boundary is given by the smooth concave constraint $H \\leq \\phi(P)$ over $P \\in [0, P_{\\max}]$, where the boundary function is\n$$\n\\phi(P) = H_{0} - c P^{2},\n$$\nwith $H_{0} > 0$ and $c > 0$. Consider $H_{0} = 50$ MW$_\\text{th}$, $c = 0.015$ MW$_\\text{th}$/(MW$_\\text{e}$)$^{2}$, and $P_{\\max} = 40$ MW$_\\text{e}$.\n\nTo obtain a mixed-integer linear programming compatible representation, construct a $K$-segment piecewise-linear upper envelope $\\hat{\\phi}_{K}(P)$ of $\\phi(P)$ using supporting lines (tangents) at $K+1$ equally spaced points $P_{i}$ across $[0, P_{\\max}]$. Let the spacing be uniform with $P_{i} = i \\Delta$ for $i = 0, 1, \\dots, K$ and $\\Delta = P_{\\max}/K$. Define the approximation error as\n$$\n\\epsilon_{K} = \\sup_{P \\in [0, P_{\\max}]} \\left( \\hat{\\phi}_{K}(P) - \\phi(P) \\right).\n$$\n\nStarting from the foundational facts that the hypograph of a concave function is convex and that supporting hyperplanes provide valid upper bounds for concave functions, derive an analytic expression for $\\epsilon_{K}$ in terms of $c$, $P_{\\max}$, and $K$. Then, compute the numerical value of $\\epsilon_{K}$ for $K = 8$ using the given parameters.\n\nExpress your final numerical answer for the bound $\\epsilon_{K}$ in MW$_\\text{th}$ and round your answer to four significant figures.",
            "solution": "The feasible operating region defined by $H \\leq \\phi(P)$ is the hypograph of $\\phi(P)$. A fundamental property is that the hypograph of a concave function is a convex set. For a twice continuously differentiable concave function $\\phi$, supporting hyperplanes given by tangents provide global upper bounds on the function. Specifically, at any $P_{0}$,\n$$\n\\phi(P) \\leq \\phi(P_{0}) + \\phi'(P_{0})(P - P_{0}),\n$$\nwith equality at $P = P_{0}$.\n\nTo construct a piecewise-linear upper envelope, select $K+1$ equally spaced points $P_{i} = i \\Delta$, $i = 0, \\dots, K$, with $\\Delta = P_{\\max}/K$. Define the supporting lines (tangents)\n$$\n\\ell_{i}(P) = \\phi(P_{i}) + \\phi'(P_{i})(P - P_{i}).\n$$\nBecause $\\phi$ is concave, each $\\ell_{i}(P)$ is an upper bound on $\\phi(P)$ for all $P$. The tightest upper envelope formed by these tangents is their pointwise minimum,\n$$\n\\hat{\\phi}_{K}(P) = \\min_{i \\in \\{0,1,\\dots,K\\}} \\ell_{i}(P),\n$$\nwhich is a concave piecewise-linear function with $K$ segments.\n\nWe seek an upper bound on the approximation error\n$$\n\\epsilon_{K} = \\sup_{P \\in [0, P_{\\max}]} \\left( \\hat{\\phi}_{K}(P) - \\phi(P) \\right).\n$$\n\nGeneral bound from Taylor’s theorem: For twice continuously differentiable concave $\\phi$, Taylor’s theorem with Lagrange remainder implies\n$$\n\\phi(P) = \\phi(P_{0}) + \\phi'(P_{0})(P - P_{0}) + \\frac{1}{2}\\phi''(\\xi)(P - P_{0})^{2}\n$$\nfor some $\\xi$ between $P$ and $P_{0}$. Since $\\phi$ is concave, $\\phi''(\\xi) \\leq 0$. Therefore, the tangent error at $P$ with respect to $P_{0}$ is\n$$\n\\ell_{0}(P) - \\phi(P) = -\\frac{1}{2}\\phi''(\\xi)(P - P_{0})^{2} \\leq \\frac{1}{2}\\Lambda (P - P_{0})^{2},\n$$\nwhere $\\Lambda = \\sup_{x \\in [0, P_{\\max}]} \\left( -\\phi''(x) \\right) \\geq 0$ is a curvature bound. For the envelope constructed from tangents at points $P_{i}$, the error at any $P$ is upper bounded by the error of the nearest tangent. The maximum distance to the nearest $P_{i}$ is at most $\\Delta/2$. Hence,\n$$\n\\epsilon_{K} \\leq \\frac{1}{2}\\Lambda \\left( \\frac{\\Delta}{2} \\right)^{2} = \\frac{\\Lambda \\Delta^{2}}{8}.\n$$\n\nNow specialize to the quadratic CHP boundary $\\phi(P) = H_{0} - cP^{2}$. Then\n$$\n\\phi'(P) = -2cP, \\quad \\phi''(P) = -2c,\n$$\nso $\\Lambda = -\\phi''(P) = 2c$ for all $P$. The general bound simplifies to\n$$\n\\epsilon_{K} \\leq \\frac{2c \\Delta^{2}}{8} = \\frac{c \\Delta^{2}}{4}.\n$$\n\nMoreover, for the quadratic case, the error with a single tangent at $P_{i}$ can be computed exactly:\n\\begin{align*}\n\\ell_{i}(P) &= \\phi(P_{i}) + \\phi'(P_{i})(P - P_{i}) \\\\\n&= (H_{0} - cP_{i}^{2}) + (-2cP_{i})(P - P_{i}) \\\\\n&= H_{0} + cP_{i}^{2} - 2cP_{i}P,\n\\end{align*}\nand the error is\n$$\n\\ell_{i}(P) - \\phi(P) = H_{0} + cP_{i}^{2} - 2cP_{i}P - (H_{0} - cP^{2}) = c(P - P_{i})^{2}.\n$$\nBetween two adjacent tangency points $P_{i}$ and $P_{i+1}$, the envelope is the minimum of $\\ell_{i}$ and $\\ell_{i+1}$. These two lines intersect at $P^{*} = \\frac{P_{i} + P_{i+1}}{2}$ (the midpoint), and at this point the error relative to either tangent is\n$$\nc\\left(P^{*} - P_{i}\\right)^{2} = c\\left(\\frac{\\Delta}{2}\\right)^{2} = \\frac{c \\Delta^{2}}{4}.\n$$\nThis is the maximum error on the segment $[P_{i}, P_{i+1}]$; therefore, for the entire domain,\n$$\n\\epsilon_{K} = \\frac{c \\Delta^{2}}{4} = \\frac{c}{4}\\left( \\frac{P_{\\max}}{K} \\right)^{2}.\n$$\n\nCompute the numerical value for $K = 8$, $P_{\\max} = 40$ MW$_\\text{e}$, and $c = 0.015$ MW$_\\text{th}$/(MW$_\\text{e}$)$^{2}$. First, $\\Delta = P_{\\max}/K = 40/8 = 5$ MW$_\\text{e}$. Then\n\\begin{align*}\n\\epsilon_{K} &= \\frac{c \\Delta^{2}}{4} = \\frac{0.015 \\times 5^{2}}{4} = \\frac{0.015 \\times 25}{4} = \\frac{0.375}{4} = 0.09375 \\text{ MW}_\\text{th}.\n\\end{align*}\nRounded to four significant figures, the value is $0.09375$ MW$_\\text{th}$ (equivalently, $9.375 \\times 10^{-2}$ MW$_\\text{th}$). The required final answer is this numerical bound in MW$_\\text{th}$.",
            "answer": "$$\\boxed{9.375 \\times 10^{-2}}$$"
        },
        {
            "introduction": "Beyond defining the static capabilities of a CHP unit, a realistic model must account for its dynamic limitations. A unit cannot instantaneously jump between any two feasible points; its rate of change in power and heat output is constrained by physical and material stress limits. This exercise  challenges you to incorporate these dynamic ramp-rate limits. You will determine the \"reachable set\" for the next time step, which is the intersection of the static feasible operating region and the dynamic constraints imposed by the current operating point, a crucial concept in sequential economic dispatch and unit commitment problems.",
            "id": "4090988",
            "problem": "A Combined Heat and Power (CHP) unit with an extraction-condensing steam turbine is modeled in the electricity-heat production plane by a convex, piecewise-linear feasible operating region. Let electricity be denoted by $P$ (in MW$_\\text{e}$) and useful heat by $H$ (in MW$_\\text{th}$). The operating region is constructed from mass and energy balances grounded in the First Law of Thermodynamics and turbine flow allocation: increasing extraction steam to district heating reduces the mass flow through low-pressure stages and thus the electrical output. A widely used linearized frontier captures this trade-off as a negative slope linking $P$ and $H$, and internal valve and minimum extraction requirements impose a lower bound linking $H$ to $P$.\n\nConsider the following scientifically consistent approximation of the feasible operating polygon $\\mathcal{F}$:\n- Condensing frontier: $P \\leq P^{\\max} - \\alpha H$, with $P^{\\max} = 120$ and $\\alpha = 0.4$.\n- Minimum extraction requirement due to valve and steam-balance constraints: $H \\geq \\beta P + H_{0}$, with $\\beta = 0.5$ and $H_{0} = 60$.\n- Physical bounds: $0 \\leq P \\leq 120$ and $0 \\leq H \\leq 220$.\n\nThe unit is subject to symmetric ramp limits between time steps: $|P_{t} - P_{t-1}| \\leq R_{P}$ and $|H_{t} - H_{t-1}| \\leq R_{H}$, with $R_{P} = 10$ and $R_{H} = 8$. At the previous time, the unit operated at $(P_{t-1}, H_{t-1}) = (60, 90)$, which lies on the lower extraction constraint and strictly within the condensing frontier.\n\nDefine the reachable set at the next time as the intersection $\\mathcal{R} = \\mathcal{F} \\cap \\{(P,H): P \\in [P_{t-1} - R_{P}, P_{t-1} + R_{P}],\\ H \\in [H_{t-1} - R_{H}, H_{t-1} + R_{H}]\\}$. Starting from the foundational description above and using first-principles reasoning about convex set intersections, parameterize the ramp constraints and derive an analytic expression for the area of $\\mathcal{R}$ in terms of the model parameters. Then, substitute the given numerical values and compute the area of $\\mathcal{R}$. Express the final area in MW$_\\text{e} \\cdot$ MW$_\\text{th}$. If your final numerical value is exact, do not round; if an approximation is required, round to four significant figures.",
            "solution": "The First Law of Thermodynamics implies that, for a fixed boiler firing rate and steam conditions, the allocation of steam between extraction (for district heating) and expansion through the low-pressure stages determines the split between useful heat $H$ and electrical output $P$. A linearized extraction-condensing trade-off is commonly represented by a frontier $P \\leq P^{\\max} - \\alpha H$, where $\\alpha > 0$ is the incremental electrical loss per unit of heat extracted. Internal valve and minimum extraction requirements can be represented as $H \\geq \\beta P + H_{0}$, with $\\beta \\geq 0$ and $H_{0} \\geq 0$, reflecting a minimum extraction fraction and baseline heat demand.\n\nGiven these, the feasible operating set is\n$$\n\\mathcal{F} = \\left\\{(P,H): P \\leq P^{\\max} - \\alpha H,\\ H \\geq \\beta P + H_{0},\\ 0 \\leq P \\leq P^{\\max},\\ 0 \\leq H \\leq H^{\\max}\\right\\}.\n$$\nRamp limits define a rectangle centered at $(P_{t-1}, H_{t-1})$:\n$$\n\\mathcal{B} = \\left\\{(P,H): P \\in [P_{t-1} - R_{P}, P_{t-1} + R_{P}],\\ H \\in [H_{t-1} - R_{H}, H_{t-1} + R_{H}]\\right\\}.\n$$\nThe reachable set is the intersection\n$$\n\\mathcal{R} = \\mathcal{F} \\cap \\mathcal{B}.\n$$\n\nWe are asked to derive an expression for the area of $\\mathcal{R}$ and then compute it for the given parameters. The area can be obtained by integrating the vertical thickness over the permissible horizontal span, provided the set remains a simple $x$-monotone region. Let us denote the ramp bounds explicitly:\n$$\nP_{\\min}^{\\mathrm{r}} = P_{t-1} - R_{P},\\quad P_{\\max}^{\\mathrm{r}} = P_{t-1} + R_{P},\\quad H_{\\min}^{\\mathrm{r}} = H_{t-1} - R_{H},\\quad H_{\\max}^{\\mathrm{r}} = H_{t-1} + R_{H}.\n$$\nWithin $\\mathcal{B}$, the vertical thickness at a given $P$ is constrained below by both the ramp lower bound $H_{\\min}^{\\mathrm{r}}$ and the minimum extraction line $\\beta P + H_{0}$, and above by both the ramp upper bound $H_{\\max}^{\\mathrm{r}}$ and the condensing frontier translated into a bound on $H$ via $P \\leq P^{\\max} - \\alpha H \\iff H \\leq \\frac{P^{\\max} - P}{\\alpha}$. Therefore, the vertical thickness function is\n$$\nT(P) = \\left[\\min\\left(H_{\\max}^{\\mathrm{r}}, \\frac{P^{\\max} - P}{\\alpha}, H^{\\max}\\right) - \\max\\left(H_{\\min}^{\\mathrm{r}}, \\beta P + H_{0}, 0\\right)\\right]_{+},\n$$\nwhere $[x]_{+} = \\max\\{x, 0\\}$ ensures nonnegativity. The area is then\n$$\nA = \\int_{P_{\\min}^{\\mathrm{r}}}^{P_{\\max}^{\\mathrm{r}}} T(P)\\, dP.\n$$\n\nWe now substitute the given numerical values and check which bounds are active over the ramp span. The parameters are\n$$\nP^{\\max} = 120,\\quad \\alpha = 0.4,\\quad \\beta = 0.5,\\quad H_{0} = 60,\\quad H^{\\max} = 220,\n$$\n$$\nP_{t-1} = 60,\\quad H_{t-1} = 90,\\quad R_{P} = 10,\\quad R_{H} = 8.\n$$\nThus,\n$$\nP_{\\min}^{\\mathrm{r}} = 60 - 10 = 50,\\quad P_{\\max}^{\\mathrm{r}} = 60 + 10 = 70,\n$$\n$$\nH_{\\min}^{\\mathrm{r}} = 90 - 8 = 82,\\quad H_{\\max}^{\\mathrm{r}} = 90 + 8 = 98.\n$$\nWe examine the upper bound from the condensing frontier:\n$$\nH \\leq \\frac{P^{\\max} - P}{\\alpha} = \\frac{120 - P}{0.4}.\n$$\nAt $P = 70$, this yields $\\frac{120 - 70}{0.4} = \\frac{50}{0.4} = 125$. At $P = 50$, it yields $\\frac{120 - 50}{0.4} = \\frac{70}{0.4} = 175$. Over $P \\in [50, 70]$, the condensing-derived upper bound ranges from $175$ down to $125$, which strictly exceeds $H_{\\max}^{\\mathrm{r}} = 98$. Therefore, the active upper bound within the ramp rectangle is $H_{\\max}^{\\mathrm{r}}$ (the ramp upper bound), not the condensing frontier or $H^{\\max}$.\n\nWe examine the lower bound from the minimum extraction constraint:\n$$\nH \\geq \\beta P + H_{0} = 0.5 P + 60.\n$$\nAt $P = 50$, this gives $H \\geq 0.5 \\cdot 50 + 60 = 85$, and at $P = 70$, it gives $H \\geq 0.5 \\cdot 70 + 60 = 95$. Compare with the ramp lower bound $H_{\\min}^{\\mathrm{r}} = 82$. Over $P \\in [50, 70]$, $0.5 P + 60 \\in [85, 95]$, which is strictly greater than $82$. Therefore, the active lower bound within the ramp rectangle is $H \\geq 0.5 P + 60$ (the minimum extraction line), not the ramp lower bound or $0$.\n\nWith these activity determinations, the vertical thickness over $P \\in [50, 70]$ is\n$$\nT(P) = H_{\\max}^{\\mathrm{r}} - (\\beta P + H_{0}) = 98 - (0.5 P + 60) = 38 - 0.5 P.\n$$\nWe must also ensure that $T(P) \\geq 0$ over the span. Over $P \\in [50, 70]$, $T(P)$ ranges from $38 - 0.5 \\cdot 50 = 13$ down to $38 - 0.5 \\cdot 70 = 3$, which is nonnegative throughout. Therefore, the area is\n$$\nA = \\int_{50}^{70} \\left(38 - 0.5 P\\right)\\, dP = \\left[38 P - \\frac{1}{4} P^{2}\\right]_{50}^{70}.\n$$\nCompute the definite integral:\n$$\nA = \\left(38 \\cdot 70 - \\frac{1}{4} \\cdot 70^{2}\\right) - \\left(38 \\cdot 50 - \\frac{1}{4} \\cdot 50^{2}\\right) = \\left(2660 - 1225\\right) - \\left(1900 - 625\\right).\n$$\nSimplifying,\n$$\nA = 1435 - 1275 = 160.\n$$\n\nThus, the area of the reachable set $\\mathcal{R}$, expressed in MW$_\\text{e} \\cdot$ MW$_\\text{th}$, is exactly $160$.",
            "answer": "$$\\boxed{160}$$"
        },
        {
            "introduction": "Complex CHP plants often feature distinct operational modes, such as operating with or without supplemental duct firing. Each mode has its own feasible operating region and cost function, and the overall capability of the plant is the union of these regions, which is typically a non-convex set. This final practice  guides you through one of the most powerful techniques in energy systems modeling: using mixed-integer linear programming to handle such discrete choices. You will construct a model that can decide which operating mode is most economical to satisfy a given load, a fundamental task in real-world operational planning.",
            "id": "4090999",
            "problem": "A Combined Heat and Power (CHP) unit can operate in two distinct modes: unfired and fired. Each mode corresponds to a convex feasible operating region in the electricity–heat plane. Let $P$ denote the electrical power output in megawatts electric (MW$_\\text{e}$) and $H$ denote the useful heat output in megawatts thermal (MW$_\\text{th}$). The union of the two convex regions defines the overall feasible operating region of the CHP. The goal is to construct a mixed-integer linear model using a binary variable $y \\in \\{0,1\\}$ to encode the union of these two regions via big-$M$ constraints, and then to compute the minimum fuel consumption to satisfy given demand levels.\n\nFundamental base: Use the definitions of convex sets, linear inequalities, and disjunctive programming with indicator variables. The unfired and fired modes are represented by linear inequality sets. The union of sets is represented by a binary variable selecting one mode at a time, with big-$M$ constants relaxing constraints of the inactive mode. The fuel consumption is modeled as a linear function of $P$ and $H$ per mode.\n\nMode definitions (all parameters in MW):\n- Unfired mode (mode $0$, $y=0$), feasible set $\\mathcal{S}_0$:\n  1. $0 \\leq P \\leq 50$,\n  2. $0 \\leq H \\leq 120$,\n  3. $H \\geq 1.8P + 20$,\n  4. $H \\leq 2.5P + 40$.\n- Fired mode (mode $1$, $y=1$), feasible set $\\mathcal{S}_1$:\n  1. $0 \\leq P \\leq 60$,\n  2. $30 \\leq H \\leq 180$,\n  3. $H \\geq 1.2P + 50$,\n  4. $H \\leq 3.0P + 60$.\n\nFuel consumption per mode (all coefficients are in MW fuel per MW output):\n- Unfired mode fuel: $F_0 = 0.25P + 0.15H$,\n- Fired mode fuel: $F_1 = 0.22P + 0.20H + 10$.\n\nDemands to be met:\n- Electrical demand $P^{\\mathrm{d}}$ and heat demand $H^{\\mathrm{d}}$ must be satisfied by outputs $P \\geq P^{\\mathrm{d}}$ and $H \\geq H^{\\mathrm{d}}$ while remaining within the selected mode’s feasible set.\n\nMixed-integer encoding of the union using big-$M$:\n- Introduce a binary variable $y \\in \\{0,1\\}$ indicating the fired mode when $y=1$ and the unfired mode when $y=0$.\n- Let $z = (P,H)^\\top$ denote the decision vector, and represent each mode’s constraints in the form $A_m z \\leq b_m$ for mode $m \\in \\{0,1\\}$.\n- For mode $0$ constraints, encode $A_0 z \\leq b_0 + M_0 y$, and for mode $1$ constraints, encode $A_1 z \\leq b_1 + M_1(1-y)$, where $M_0$ and $M_1$ are vectors of sufficiently large constants derived from variable bounds so that when a mode is inactive its constraints become nonbinding.\n- Include variable bounds $0 \\leq P \\leq 60$ and $0 \\leq H \\leq 180$, and additional explicit bounds as required per mode.\n- The objective is to minimize the mode-specific fuel $F = (1-y)F_0 + y F_1$ while meeting demands $P \\geq P^{\\mathrm{d}}$, $H \\geq H^{\\mathrm{d}}$.\n\nFor computational purposes and to avoid bilinear terms in the objective, it is valid to solve two linear programs (LPs), one for each fixed value of $y \\in \\{0,1\\}$, and select the better feasible solution. This is equivalent to the mixed-integer formulation because there are only two disjuncts.\n\nTasks:\n1. Construct the LPs corresponding to the two modes using the inequalities provided and the demands $P^{\\mathrm{d}}$ and $H^{\\mathrm{d}}$ as lower bounds on $P$ and $H$.\n2. For each test case, solve both LPs and select the feasible solution with the smallest fuel consumption. If neither LP is feasible, return infeasible.\n3. All outputs must be expressed in megawatts (MW) and rounded to three decimal places.\n\nTest suite (each test case is a pair $(P^{\\mathrm{d}}, H^{\\mathrm{d}})$ in MW):\n- Case $1$: $(40, 110)$,\n- Case $2$: $(30, 170)$,\n- Case $3$: $(55, 80)$,\n- Case $4$: $(70, 200)$,\n- Case $5$: $(50, 165)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be formatted as a comma-separated list of the form $[\\,\\text{feasible}, y, P, H, F\\,]$ with no spaces, where $\\text{feasible}$ is a boolean indicating feasibility, $y$ is the selected mode ($0$ for unfired, $1$ for fired), and $P$, $H$, $F$ are floats rounded to three decimal places in MW. For example: $[[\\text{True},0,40.000,110.000,26.500],[\\text{False},0,0.000,0.000,0.000],\\dots]$.",
            "solution": "The problem requires finding the minimum fuel consumption for a Combined Heat and Power (CHP) unit to meet specified electricity and heat demands, $(P^{\\mathrm{d}}, H^{\\mathrm{d}})$. The CHP unit's operational envelope is the union of two convex sets, corresponding to an unfired mode ($\\mathcal{S}_0$) and a fired mode ($\\mathcal{S}_1$). This union, $\\mathcal{S} = \\mathcal{S}_0 \\cup \\mathcal{S}_1$, is generally non-convex.\n\nThe problem can be modeled as a Mixed-Integer Linear Program (MILP), where a binary variable $y \\in \\{0, 1\\}$ selects the active mode. However, as the problem statement notes, a computationally equivalent and more direct approach for a disjunction between only two sets is to solve two separate Linear Programs (LPs), one for each mode, and then select the feasible solution with the lower objective value.\n\nLet the decision variables be the electrical power $P$ and the heat output $H$. The optimization problem for each test case $(P^{\\mathrm{d}}, H^{\\mathrm{d}})$ is decomposed into two subproblems.\n\n**Subproblem 1: Unfired Mode (Mode 0)**\n\nFor this mode, we set the binary variable $y=0$. The objective is to minimize the fuel consumption $F_0$. The problem is formulated as the following LP:\n\nMinimize:\n$$ F_0 = 0.25P + 0.15H $$\n\nSubject to the constraints for unfired mode operation and the given demands:\n1.  Electrical power bounds: $0 \\leq P \\leq 50$ MW.\n2.  Heat output bounds: $0 \\leq H \\leq 120$ MW.\n3.  Operating line 1: $H \\geq 1.8P + 20$. This can be written as $-1.8P + H \\geq 20$.\n4.  Operating line 2: $H \\leq 2.5P + 40$. This can be written as $-2.5P + H \\leq 40$.\n5.  Demand satisfaction: $P \\geq P^{\\mathrm{d}}$ and $H \\geq H^{\\mathrm{d}}$.\n\nCombining these, the feasible region for the LP is defined by:\n$$ \\max(0, P^{\\mathrm{d}}) \\leq P \\leq 50 $$\n$$ \\max(0, H^{\\mathrm{d}}) \\leq H \\leq 120 $$\n$$ -1.8P + H \\geq 20 $$\n$$ -2.5P + H \\leq 40 $$\n\nIf this LP has a feasible solution, let the optimal point be $(P_0^*, H_0^*)$ and the minimum fuel consumption be $F_0^*$. If it is infeasible, no solution exists for this mode.\n\n**Subproblem 2: Fired Mode (Mode 1)**\n\nFor this mode, we set the binary variable $y=1$. The objective is to minimize the fuel consumption $F_1$. The problem is formulated as the following LP:\n\nMinimize:\n$$ F_1 = 0.22P + 0.20H + 10 $$\nSince the constant term $10$ does not affect the optimal values of $P$ and $H$, we can minimize $F_1' = 0.22P + 0.20H$ and add $10$ to the resulting optimal value.\n\nSubject to the constraints for fired mode operation and the given demands:\n1.  Electrical power bounds: $0 \\leq P \\leq 60$ MW.\n2.  Heat output bounds: $30 \\leq H \\leq 180$ MW.\n3.  Operating line 1: $H \\geq 1.2P + 50$. This can be written as $-1.2P + H \\geq 50$.\n4.  Operating line 2: $H \\leq 3.0P + 60$. This can be written as $-3.0P + H \\leq 60$.\n5.  Demand satisfaction: $P \\geq P^{\\mathrm{d}}$ and $H \\geq H^{\\mathrm{d}}$.\n\nCombining these, the feasible region for the LP is defined by:\n$$ \\max(0, P^{\\mathrm{d}}) \\leq P \\leq 60 $$\n$$ \\max(30, H^{\\mathrm{d}}) \\leq H \\leq 180 $$\n$$ -1.2P + H \\geq 50 $$\n$$ -3.0P + H \\leq 60 $$\n\nIf this LP has a feasible solution, let the optimal point be $(P_1^*, H_1^*)$ and the minimum fuel consumption be $F_1^*$. If it is infeasible, no solution exists for this mode.\n\n**Decision Logic**\n\nFor each test case $(P^{\\mathrm{d}}, H^{\\mathrm{d}})$, the following logic is applied:\n1.  Solve the LP for Mode 0. Let the result be $(\\text{feasible}_0, P_0^*, H_0^*, F_0^*)$.\n2.  Solve the LP for Mode 1. Let the result be $(\\text{feasible}_1, P_1^*, H_1^*, F_1^*)$.\n3.  Compare the outcomes:\n    -   If both modes are infeasible ($\\text{feasible}_0 = \\text{False}$ and $\\text{feasible}_1 = \\text{False}$), the overall problem is infeasible.\n    -   If only Mode 0 is feasible, the optimal solution is $(P, H, F) = (P_0^*, H_0^*, F_0^*)$ with $y=0$.\n    -   If only Mode 1 is feasible, the optimal solution is $(P, H, F) = (P_1^*, H_1^*, F_1^*)$ with $y=1$.\n    -   If both modes are feasible, we compare the minimum fuel consumptions. If $F_0^* \\leq F_1^*$, the optimal solution is from Mode 0. Otherwise, it is from Mode 1.\n\nThe `scipy.optimize.linprog` function is used to solve each LP. The constraints are provided in the standard form required by the solver, with inequality constraints represented as $A_{ub}x \\leq b_{ub}$ and variable bounds. For inequalities like $H \\geq f(P)$, they are rewritten as $-H \\leq -f(P)$ to fit the standard form.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves a series of optimization problems for a Combined Heat and Power (CHP) unit.\n    For each demand case, it finds the minimum fuel operating point by solving\n    two linear programs, one for each operating mode (unfired and fired), and\n    selecting the optimal feasible solution.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple (P_demand, H_demand) in MW.\n    test_cases = [\n        (40, 110),\n        (30, 170),\n        (55, 80),\n        (70, 200),\n        (50, 165),\n    ]\n\n    results = []\n    for p_demand, h_demand in test_cases:\n        # Solve for Mode 0 (unfired)\n        c0 = np.array([0.25, 0.15]) # P, H coefficients in F_0\n        # H >= 1.8P + 20  =>  1.8P - H <= -20\n        # H <= 2.5P + 40  => -2.5P + H <= 40\n        A_ub0 = np.array([[1.8, -1.0], [-2.5, 1.0]])\n        b_ub0 = np.array([-20.0, 40.0])\n        p_bounds0 = (max(0, p_demand), 50.0)\n        h_bounds0 = (max(0, h_demand), 120.0)\n\n        res0 = linprog(c=c0, A_ub=A_ub0, b_ub=b_ub0, bounds=[p_bounds0, h_bounds0], method='highs')\n        \n        sol0 = None\n        if res0.success:\n            p_opt, h_opt = res0.x\n            f_opt = res0.fun\n            sol0 = (True, 0, p_opt, h_opt, f_opt)\n\n        # Solve for Mode 1 (fired)\n        c1 = np.array([0.22, 0.20]) # P, H coefficients in F_1 (constant 10 is added later)\n        # H >= 1.2P + 50  =>  1.2P - H <= -50\n        # H <= 3.0P + 60  => -3.0P + H <= 60\n        A_ub1 = np.array([[1.2, -1.0], [-3.0, 1.0]])\n        b_ub1 = np.array([-50.0, 60.0])\n        p_bounds1 = (max(0, p_demand), 60.0)\n        h_bounds1 = (max(30.0, h_demand), 180.0)\n\n        res1 = linprog(c=c1, A_ub=A_ub1, b_ub=b_ub1, bounds=[p_bounds1, h_bounds1], method='highs')\n\n        sol1 = None\n        if res1.success:\n            p_opt, h_opt = res1.x\n            f_opt = res1.fun + 10.0 # Add the constant part of F_1\n            sol1 = (True, 1, p_opt, h_opt, f_opt)\n\n        # Compare results and select the best one\n        final_sol = None\n        if sol0 and sol1:\n            if sol0[4] <= sol1[4]:\n                final_sol = sol0\n            else:\n                final_sol = sol1\n        elif sol0:\n            final_sol = sol0\n        elif sol1:\n            final_sol = sol1\n        else:\n            final_sol = (False, 0, 0.0, 0.0, 0.0)\n            \n        # Format the result string as per requirements\n        feasible, y, p, h, f = final_sol\n        result_str = f\"[{str(feasible)},{y},{p:.3f},{h:.3f},{f:.3f}]\"\n        results.append(result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}