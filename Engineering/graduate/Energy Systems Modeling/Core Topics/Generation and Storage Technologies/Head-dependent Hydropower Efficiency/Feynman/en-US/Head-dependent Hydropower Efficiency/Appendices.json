{
    "hands_on_practices": [
        {
            "introduction": "Before modeling complex efficiency curves, we must first master the fundamental physical quantity they depend on: the net head. This exercise grounds our understanding in the steady mechanical energy balance, demonstrating how the gross head, determined by reservoir elevations, is reduced by hydraulic losses to yield the net head actually available to the turbine. Mastering this foundational calculation  is the essential first step in accurately modeling the performance of any hydropower facility.",
            "id": "4094779",
            "problem": "A high-head hydropower facility draws water from a large reservoir and discharges into a tailrace channel. The free surface elevation of the reservoir is $250$ meters above a common datum, while the tailwater free surface elevation is $200$ meters above the datum. The conveyance system consists of a single penstock in which steady viscous friction losses amount to a head loss of $h_{f}=6$ meters and additional localized minor losses of $h_{m}=2$ meters. Assume single-phase, incompressible, steady flow of water. The reservoir and tailrace cross sections are sufficiently large that mean velocities at the free surfaces are negligible, and pressures at the free surfaces are both atmospheric. \n\nStarting from the steady mechanical energy balance for incompressible flow between the reservoir free surface and the tailwater free surface, with head extraction by a turbine and the total hydraulic losses accounted for, derive an expression for the net head available to the turbine, $H_{\\text{net}}$, in terms of the gross head and the hydraulic losses. Then evaluate $H_{\\text{net}}$ numerically for the given data. Additionally, compute the fraction of the gross head that is dissipated in the hydraulic losses of the conveyance system, expressed as a unitless decimal. \n\nExpress $H_{\\text{net}}$ in meters. Express the fraction as a decimal (not a percentage). Round both quantities to four significant figures.",
            "solution": "The appropriate starting point is the steady mechanical energy equation for an incompressible fluid flowing between two locations, incorporating turbine head removal and distributed plus minor losses. Consider the streamline from the reservoir free surface (location $1$) to the tailwater free surface (location $2$). The steady energy equation with head terms reads\n$$\nz_{1} + \\frac{p_{1}}{\\rho g} + \\frac{v_{1}^{2}}{2 g} \\;+\\; H_{\\text{pump}} \\;-\\; H_{\\text{turbine}} \\;-\\; h_{L} \\;=\\; z_{2} + \\frac{p_{2}}{\\rho g} + \\frac{v_{2}^{2}}{2 g},\n$$\nwhere $z$ is elevation head, $p$ is pressure, $\\rho$ is density, $g$ is gravitational acceleration, $v$ is mean velocity, $H_{\\text{pump}}$ is head added by a pump (zero here), $H_{\\text{turbine}}$ is head removed by the turbine, and $h_{L}$ is the total hydraulic loss (sum of frictional and minor losses) between locations $1$ and $2$. \n\nGiven the reservoir and tailwater free surfaces are both exposed to the atmosphere, we have $p_{1} = p_{2}$ equal to atmospheric pressure, so $\\frac{p_{1}}{\\rho g} = \\frac{p_{2}}{\\rho g}$. The cross sections at the free surfaces are large, so the velocities $v_{1}$ and $v_{2}$ are negligible, implying $\\frac{v_{1}^{2}}{2 g} \\approx 0$ and $\\frac{v_{2}^{2}}{2 g} \\approx 0$. There is no pump, so $H_{\\text{pump}} = 0$. Under these conditions the energy equation simplifies to\n$$\nz_{1} \\;-\\; H_{\\text{turbine}} \\;-\\; h_{L} \\;=\\; z_{2}.\n$$\nRearranging for the turbine head removal gives\n$$\nH_{\\text{turbine}} \\;=\\; z_{1} - z_{2} \\;-\\; h_{L}.\n$$\nThe term $z_{1} - z_{2}$ is the gross head, which we denote by $H_{\\text{gross}}$. Therefore,\n$$\nH_{\\text{turbine}} \\;=\\; H_{\\text{gross}} \\;-\\; h_{L}.\n$$\nThe hydropower convention defines the net head available to the turbine, $H_{\\text{net}}$, as the head actually delivered across the turbine runner, which equals the turbine head removal derived above. Consequently,\n$$\nH_{\\text{net}} \\;=\\; H_{\\text{gross}} \\;-\\; h_{L}.\n$$\n\nWe now evaluate $H_{\\text{gross}}$ and $h_{L}$ from the provided data. The gross head is the difference in free surface elevations,\n$$\nH_{\\text{gross}} \\;=\\; z_{1} - z_{2} \\;=\\; 250 - 200 \\;=\\; 50.\n$$\nThe total hydraulic loss is the sum of the friction loss and minor losses,\n$$\nh_{L} \\;=\\; h_{f} + h_{m} \\;=\\; 6 + 2 \\;=\\; 8.\n$$\nTherefore, the net head is\n$$\nH_{\\text{net}} \\;=\\; 50 - 8 \\;=\\; 42.\n$$\n\nThe fraction of the gross head dissipated in hydraulics is the ratio\n$$\n\\text{fraction lost} \\;=\\; \\frac{h_{L}}{H_{\\text{gross}}} \\;=\\; \\frac{8}{50} \\;=\\; 0.16.\n$$\n\nApplying the rounding instruction to four significant figures, we express $H_{\\text{net}}$ in meters and the fraction as a decimal:\n$$\nH_{\\text{net}} \\;=\\; 42.00 \\quad \\text{meters},\n$$\n$$\n\\text{fraction lost} \\;=\\; 0.1600.\n$$\nThese values satisfy the requested significant figures and unit specifications.",
            "answer": "$$\\boxed{\\begin{pmatrix} 42.00  0.1600 \\end{pmatrix}}$$"
        },
        {
            "introduction": "With a solid understanding of net head, we can now model its impact on plant performance and economic value, as efficiency is not constant but varies with operating conditions. This exercise  is a hands-on computational task to translate a mathematical model of head-dependent efficiency, $\\eta(H)$, into a concrete financial outcome by calculating revenue under varying head and electricity prices. This practice develops crucial skills in scenario analysis and techno-economic assessment, enabling you to quantify the benefits of potential efficiency upgrades.",
            "id": "4094790",
            "problem": "A hydropower plant converts gravitational potential energy of water into electrical energy. Let the instantaneous net head be denoted by $H$, the volumetric flow rate be denoted by $Q$, water density be denoted by $\\rho$, and gravitational acceleration be denoted by $g$. Electrical conversion efficiency depends on head via a head-dependent function $\\,\\eta(H)\\,$. A day-ahead price curve provides the value of electricity as a function of time. Starting from the physical base that the mechanical power available from a hydraulic flow is given by the product of mass flow rate, gravitational acceleration, and net head, derive a method to compute revenue over a discrete forecast horizon with known head values and prices, using $\\,\\eta(H)\\,$ to map mechanical power to electrical power. Implement this method to compare scenarios with different efficiency upgrade functions.\n\nUse the following scientifically consistent constants and conventions:\n- Density $\\,\\rho = \\,1000\\,\\mathrm{kg/m^3}\\,$.\n- Gravitational acceleration $\\,g = \\,9.81\\,\\mathrm{m/s^2}\\,$.\n- Rated discharge $\\,Q = \\,80\\,\\mathrm{m^3/s}\\,$ is constant over the horizon.\n- Timestep length $\\,\\Delta t = \\,1\\,\\mathrm{hour}\\,$.\n- Price unit is United States Dollar (USD) per Megawatt-hour (MWh), written as $\\,\\mathrm{USD}/\\mathrm{MWh}\\,$.\n- Report total revenue in United States Dollar (USD) as a float rounded to two decimal places.\n- If the net head is below a scenario-specific cut-in threshold, generation is zero for that timestep.\n\nDefine the following three head-to-efficiency scenarios. For all, enforce $\\,\\eta(H)\\in[\\,\\eta_{\\min},\\,\\eta_{\\max}\\,]\\,$ via clamping after evaluating the expression shown, and enforce zero generation for $\\,HH_{\\mathrm{cut}}\\,$.\n1. Baseline: $\\,\\eta_{\\max} = \\,0.90\\,$, $\\,\\eta_{\\min} = \\,0.70\\,$, $\\,k = \\,5.0\\,$, $\\,h_0 = \\,10.0\\,$, $\\,H_{\\mathrm{cut}} = \\,8.0\\,\\mathrm{m}\\,$, with\n   $$\\eta(H) = \\eta_{\\max} - \\frac{k}{H + h_0}.$$\n2. Upgrade Low-Head: $\\,\\eta_{\\max} = \\,0.90\\,$, $\\,\\eta_{\\min} = \\,0.70\\,$, $\\,k = \\,3.0\\,$, $\\,h_0 = \\,10.0\\,$, $\\,H_{\\mathrm{cut}} = \\,6.0\\,\\mathrm{m}\\,$, with\n   $$\\eta(H) = \\eta_{\\max} - \\frac{k}{H + h_0}.$$\n3. Upgrade High-Head: $\\,\\eta_{\\max} = \\,0.93\\,$, $\\,\\eta_{\\min} = \\,0.70\\,$, $\\,k = \\,5.0\\,$, $\\,h_0 = \\,10.0\\,$, $\\,H_{\\mathrm{cut}} = \\,8.0\\,\\mathrm{m}\\,$, with\n   $$\\eta(H) = \\eta_{\\max} - \\frac{k}{H + h_0}.$$\n\nUse a discrete forecast with $\\,\\Delta t = \\,1\\,\\mathrm{hour}\\,$. At each hour $\\,t\\,$, compute electrical energy $\\,E_t\\,$ and revenue $\\,R_t\\,$ from first principles. Convert units consistently so that the price multiplies energy measured in Megawatt-hour. Sum revenues over the horizon to get the total revenue for a scenario.\n\nTest suite. Evaluate total revenues for the three scenarios on each of the following three cases; all arrays are ordered over $\\,6\\,$ consecutive hours:\n- Case $\\,1\\,$ (moderate head variability, peaky prices):\n  - Head series $\\,\\{\\,15,\\,18,\\,20,\\,22,\\,19,\\,16\\,\\}\\,$ meters.\n  - Price series $\\,\\{\\,40,\\,45,\\,50,\\,55,\\,50,\\,45\\,\\}\\,$ $\\mathrm{USD}/\\mathrm{MWh}$.\n- Case $\\,2\\,$ (near cut-in conditions, modest prices):\n  - Head series $\\,\\{\\,6,\\,7,\\,8,\\,7,\\,6,\\,5\\,\\}\\,$ meters.\n  - Price series $\\,\\{\\,30,\\,32,\\,35,\\,33,\\,31,\\,30\\,\\}\\,$ $\\mathrm{USD}/\\mathrm{MWh}$.\n- Case $\\,3\\,$ (high heads, flat prices):\n  - Head series $\\,\\{\\,50,\\,55,\\,60,\\,65,\\,60,\\,55\\,\\}\\,$ meters.\n  - Price series $\\,\\{\\,35,\\,35,\\,35,\\,35,\\,35,\\,35\\,\\}\\,$ $\\mathrm{USD}/\\mathrm{MWh}$.\n\nFinal output format. Your program should produce a single line of output containing $\\,9\\,$ float results (rounded to two decimals) as a comma-separated list enclosed in square brackets, ordered as:\n$$[\\,\\text{Case 1 Baseline},\\,\\text{Case 1 Upgrade Low-Head},\\,\\text{Case 1 Upgrade High-Head},\\,\\text{Case 2 Baseline},\\,\\text{Case 2 Upgrade Low-Head},\\,\\text{Case 2 Upgrade High-Head},\\,\\text{Case 3 Baseline},\\,\\text{Case 3 Upgrade High-Head}\\,].$$",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of energy conversion, well-posed with all necessary data and constraints provided, and objective in its language and formulation. It represents a standard, albeit simplified, energy systems modeling task. We can therefore proceed with a solution.\n\nThe solution is derived from first principles of physics and engineering. The objective is to calculate the total revenue generated by a hydropower plant over a discrete time horizon, considering head-dependent efficiency and a time-varying electricity price.\n\n**1. Mechanical Power**\n\nThe fundamental principle of hydropower is the conversion of gravitational potential energy of water into mechanical energy, and subsequently into electrical energy. The available mechanical power, $P_{mech}$, from a hydraulic flow is given by the product of the mass flow rate, $\\dot{m}$, the gravitational acceleration, $g$, and the net head, $H$.\n\nThe mass flow rate, $\\dot{m}$, is the product of the water density, $\\rho$, and the volumetric flow rate, $Q$:\n$$ \\dot{m} = \\rho Q $$\nGiven $\\rho = 1000\\,\\mathrm{kg/m^3}$ and $Q = 80\\,\\mathrm{m^3/s}$, the mass flow rate is:\n$$ \\dot{m} = 1000\\,\\mathrm{kg/m^3} \\times 80\\,\\mathrm{m^3/s} = 80000\\,\\mathrm{kg/s} $$\n\nThe mechanical power is therefore:\n$$ P_{mech}(H) = \\dot{m} g H = \\rho Q g H $$\nThe units of this expression are $(\\mathrm{kg/m^3}) \\cdot (\\mathrm{m^3/s}) \\cdot (\\mathrm{m/s^2}) \\cdot (\\mathrm{m}) = \\mathrm{kg \\cdot m^2/s^3}$, which corresponds to Watts ($\\mathrm{W}$), the standard unit of power. Using the provided constants:\n$$ P_{mech}(H) = (1000\\,\\mathrm{kg/m^3}) \\cdot (80\\,\\mathrm{m^3/s}) \\cdot (9.81\\,\\mathrm{m/s^2}) \\cdot H = 784800 \\cdot H\\,\\mathrm{W} $$\n\n**2. Electrical Power and Efficiency**\n\nThe conversion from mechanical power to electrical power, $P_{elec}$, is not perfectly efficient. This is quantified by the electrical conversion efficiency, $\\eta$, which is given as a function of the net head, $\\eta(H)$.\n$$ P_{elec}(H) = \\eta(H) \\cdot P_{mech}(H) = \\eta(H) \\rho Q g H $$\n\nThe problem defines three scenarios, each with a specific function for $\\eta(H)$. The general form is:\n$$ \\eta_{calc}(H) = \\eta_{\\max} - \\frac{k}{H + h_0} $$\nThis calculated value is then subjected to two constraints:\n1.  **Clamping**: The efficiency must lie within a specified range $[\\eta_{\\min}, \\eta_{\\max}]$. Therefore, the effective efficiency is $\\eta(H) = \\max(\\eta_{\\min}, \\min(\\eta_{\\max}, \\eta_{calc}(H)))$.\n2.  **Cut-in Head**: No power is generated if the head $H$ is below a scenario-specific cut-in threshold, $H_{cut}$. This is equivalent to setting $\\eta(H) = 0$ if $H  H_{cut}$.\n\nCombining these, the complete expression for the efficiency at a given head $H$ is:\n$$\n\\eta(H) =\n\\begin{cases}\n    0  \\text{if } H  H_{cut} \\\\\n    \\max(\\eta_{\\min}, \\min(\\eta_{\\max}, \\eta_{\\max} - \\frac{k}{H + h_0}))  \\text{if } H \\ge H_{cut}\n\\end{cases}\n$$\n\n**3. Energy and Revenue Calculation over a Discrete Horizon**\n\nThe problem provides a discrete forecast horizon with a constant timestep length $\\Delta t = 1\\,\\mathrm{hour}$. For each timestep $i$, we are given a net head $H_i$ and an electricity price $p_i$ (in $\\mathrm{USD/MWh}$).\n\nFirst, we calculate the electrical power $P_{elec, i}$ for each timestep $i$ using the head $H_i$ for that step.\n$$ P_{elec, i} = \\eta(H_i) \\rho Q g H_i \\quad [\\mathrm{W}] $$\n\nThe energy generated during timestep $i$, $E_i$, is the power multiplied by the duration of the timestep, $\\Delta t$. It is crucial to ensure consistent units. The price is given in $\\mathrm{USD/MWh}$, so we must express the energy $E_i$ in Megawatt-hours ($\\mathrm{MWh}$).\n\nWe convert power from Watts ($\\mathrm{W}$) to Megawatts ($\\mathrm{MW}$) by dividing by $10^6$:\n$$ P_{elec, i, \\mathrm{MW}} = \\frac{P_{elec, i, \\mathrm{W}}}{10^6} $$\n\nEnergy in $\\mathrm{MWh}$ is then calculated by multiplying the power in $\\mathrm{MW}$ by the time duration in hours:\n$$ E_{i, \\mathrm{MWh}} = P_{elec, i, \\mathrm{MW}} \\cdot \\Delta t_{\\mathrm{hours}} $$\nSince $\\Delta t = 1\\,\\mathrm{hour}$, the energy in $\\mathrm{MWh}$ is numerically equal to the power in $\\mathrm{MW}$:\n$$ E_{i, \\mathrm{MWh}} = P_{elec, i, \\mathrm{MW}} \\cdot 1\\,\\mathrm{h} = \\frac{\\eta(H_i) \\rho Q g H_i}{10^6} $$\n\nThe revenue for timestep $i$, $R_i$, is the product of the energy generated (in $\\mathrm{MWh}$) and the price for that timestep (in $\\mathrm{USD/MWh}$):\n$$ R_i = E_{i, \\mathrm{MWh}} \\cdot p_i = \\left( \\frac{\\eta(H_i) \\rho Q g H_i}{10^6} \\right) \\cdot p_i $$\n\n**4. Total Revenue**\n\nThe total revenue for a given scenario is the sum of the revenues from all timesteps in the forecast horizon. For a horizon of $N$ timesteps:\n$$ R_{total} = \\sum_{i=1}^{N} R_i = \\sum_{i=1}^{N} \\left( \\frac{\\eta(H_i) \\rho Q g H_i}{10^6} \\cdot p_i \\right) $$\n\n**Algorithm Summary**\n\nThe implementation will proceed by iterating through each of the three test cases. For each case, it will iterate through the three scenarios (Baseline, Upgrade Low-Head, Upgrade High-Head).\n\nFor each (Case, Scenario) pair:\n1.  Initialize total revenue, $R_{total}$, to $0$.\n2.  Retrieve the scenario parameters $(\\eta_{\\max}, \\eta_{\\min}, k, h_0, H_{cut})$ and the case data (head series $\\{H_i\\}$ and price series $\\{p_i\\}$).\n3.  For each timestep $i$ in the $6$-hour horizon:\n    a. Check if $H_i \\ge H_{cut}$. If not, the revenue for this step is $0$.\n    b. If yes, compute $\\eta_{calc}(H_i) = \\eta_{\\max} - k/(H_i + h_0)$.\n    c. Clamp the value to get the effective efficiency $\\eta(H_i) = \\max(\\eta_{\\min}, \\min(\\eta_{\\max}, \\eta_{calc}(H_i)))$.\n    d. Compute the energy in MWh: $E_{i, \\mathrm{MWh}} = (\\eta(H_i) \\cdot 1000 \\cdot 80 \\cdot 9.81 \\cdot H_i) / 10^6$.\n    e. Compute the revenue for the timestep: $R_i = E_{i, \\mathrm{MWh}} \\cdot p_i$.\n    f. Add this to the total: $R_{total} = R_{total} + R_i$.\n4.  After iterating through all timesteps, round the final $R_{total}$ to two decimal places.\n5.  Store the result.\n\nThis procedure is systematically applied to generate the $9$ required output values.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates total hydropower revenue for multiple scenarios and test cases.\n    \"\"\"\n    # Define physical constants and plant parameters\n    rho = 1000.0  # Water density in kg/m^3\n    g = 9.81      # Gravitational acceleration in m/s^2\n    Q = 80.0      # Volumetric flow rate in m^3/s\n    delta_t = 1.0 # Timestep length in hours\n\n    # Define the three head-to-efficiency scenarios\n    # Format: { 'name': (eta_max, eta_min, k, h_0, H_cut) }\n    scenarios = {\n        \"Baseline\":          (0.90, 0.70, 5.0, 10.0, 8.0),\n        \"Upgrade Low-Head\":  (0.90, 0.70, 3.0, 10.0, 6.0),\n        \"Upgrade High-Head\": (0.93, 0.70, 5.0, 10.0, 8.0)\n    }\n    # Enforce the specified output order\n    scenario_order = [\"Baseline\", \"Upgrade Low-Head\", \"Upgrade High-Head\"]\n\n    # Define the test cases with head and price series\n    # Format: [ (head_series, price_series) ]\n    test_cases = [\n        # Case 1 (moderate head variability, peaky prices)\n        (np.array([15.0, 18.0, 20.0, 22.0, 19.0, 16.0]), np.array([40.0, 45.0, 50.0, 55.0, 50.0, 45.0])),\n        # Case 2 (near cut-in conditions, modest prices)\n        (np.array([6.0, 7.0, 8.0, 7.0, 6.0, 5.0]), np.array([30.0, 32.0, 35.0, 33.0, 31.0, 30.0])),\n        # Case 3 (high heads, flat prices)\n        (np.array([50.0, 55.0, 60.0, 65.0, 60.0, 55.0]), np.array([35.0, 35.0, 35.0, 35.0, 35.0, 35.0]))\n    ]\n\n    results = []\n\n    # Iterate through each test case\n    for H_series, p_series in test_cases:\n        # Iterate through each scenario in the specified order\n        for scenario_name in scenario_order:\n            eta_max, eta_min, k, h_0, H_cut = scenarios[scenario_name]\n            \n            # Create a boolean mask to identify active hours where head >= cut_in_head\n            active_mask = H_series >= H_cut\n            \n            # Calculate the raw efficiency based on the formula, avoiding division by non-positive numbers\n            # Note: H_series + h_0 is always positive for the given inputs\n            eta_raw = eta_max - k / (H_series + h_0)\n            \n            # Clamp the efficiency to the [eta_min, eta_max] range\n            eta_clamped = np.clip(eta_raw, eta_min, eta_max)\n            \n            # Apply the cut-in condition: efficiency is zero for inactive hours\n            eta_final = eta_clamped * active_mask\n            \n            # Calculate electrical power in Watts for each timestep\n            # P_elec(W) = eta * rho * Q * g * H\n            P_elec_W = eta_final * rho * Q * g * H_series\n            \n            # Convert power from Watts to Megawatts\n            P_elec_MW = P_elec_W / 1e6\n            \n            # Calculate energy generated in MWh for each timestep\n            # E(MWh) = P(MW) * delta_t(h)\n            E_MWh = P_elec_MW * delta_t\n            \n            # Calculate revenue for each timestep\n            # R(USD) = E(MWh) * Price(USD/MWh)\n            R_series = E_MWh * p_series\n            \n            # Sum the revenues over the horizon to get total revenue\n            total_revenue = np.sum(R_series)\n            \n            # Append the rounded result to the list\n            results.append(round(total_revenue, 2))\n\n    # Print the final result in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the main function\nsolve()\n```"
        },
        {
            "introduction": "The relationship between a hydropower plant's inputs (head, flow) and its power output is inherently nonlinear and complex, creating significant challenges for optimization. This final practice  delves into the advanced optimization techniques used in energy systems modeling to handle the nonconvex nature of the hydropower production function, introducing concepts like convex relaxations and cutting planes. By working through the logic of establishing primal and dual bounds, you will gain insight into the methods that underpin large-scale energy dispatch models and learn to critically assess the quality of their solutions.",
            "id": "4094793",
            "problem": "Consider a single-period hydropower dispatch problem for one turbine-generator unit where the mechanical power available to the turbine is modeled from first principles as $$P = \\rho g H Q \\,\\eta(H,Q),$$ with water density $\\rho$, gravitational acceleration $g$, turbine head $H$, discharge $Q$, and a head-flow-dependent turbine-generator efficiency $\\eta(H,Q)$. Assume $\\rho = 1000$ kilograms per cubic meter, $g = 9.81$ meters per second squared, head bounds $H \\in [40,60]$ meters, and flow bounds $Q \\in [20,50]$ cubic meters per second. The efficiency surface $\\eta(H,Q)$ is nonconvex and known only through measurements at a sparse set of operating points:\n- At $(H,Q) = (40,20)$, $\\eta = 0.85$.\n- At $(H,Q) = (40,50)$, $\\eta = 0.88$.\n- At $(H,Q) = (60,20)$, $\\eta = 0.92$.\n- At $(H,Q) = (60,50)$, $\\eta = 0.90$.\n- At $(H,Q) = (50,35)$, $\\eta = 0.95$.\n\nBecause the product $H Q$ is bilinear and $\\eta(H,Q)$ is nonconvex, a direct optimization of $P$ is nonconvex. A common energy systems modeling practice is to introduce an auxiliary variable $$W = H Q,$$ apply convex relaxations to $W$ (e.g., McCormick envelopes on the bilinear term over the box $[H_{\\min},H_{\\max}] \\times [Q_{\\min},Q_{\\max}]$), and approximate $\\eta(H,Q)$ via piecewise linear surrogates with Special Ordered Sets of type $2$ (SOS2) combined with cutting planes that iteratively tighten the relaxation using secants or tangents to the epigraph of $\\eta$ over local sub-rectangles formed by breakpoints.\n\nYour task is to select the option that both correctly explains how to construct primal and dual bounds for this nonconvex maximization using piecewise linearization and cutting planes, and correctly assesses the solution quality in this specific instance. In particular, reason from the fundamental definition of mechanical power and the properties of convex relaxations to determine a valid lower bound (from a feasible operating point) and an outer-approximation upper bound (from relaxations of $W$ and an efficiency overestimator), then compute the implied relative optimality gap. Express any computed power values in megawatts by recalling that $1$ megawatt $= 10^6$ watts.\n\nWhich option is correct?\n\nA. Use a piecewise linear inner approximation of $\\eta(H,Q)$ constructed from the given points with SOS2, maximize the relaxed model, and treat the resulting objective value as a dual (upper) bound. Because inner approximations lie below the true surface, this yields conservative upper bounds. With this approach, the relative gap is guaranteed to be below $10\\%$ without any cutting planes.\n\nB. Use SOS2 across a triangulation of the $(H,Q)$ grid to exactly represent the nonconvex $\\eta(H,Q)$ by convex combinations. Then, because $\\eta$ is exactly represented, McCormick envelopes are unnecessary for $W$, and the global optimum can be found by a linear program. The gap is zero under this construction.\n\nC. Form a primal feasible lower bound by evaluating $P$ at the measured high-efficiency point $(H,Q) = (50,35)$, obtaining $$W = 50 \\times 35 = 1750,$$ and $$P_{\\text{LB}} = \\rho g \\, W \\, \\eta = 1000 \\times 9.81 \\times 1750 \\times 0.95 \\approx 16.309125 \\text{ megawatts}.$$ For a dual upper bound, use the McCormick relaxation for $W$ over $H \\in [40,60]$, $Q \\in [20,50]$ (whose maximum occurs at the corner $H = 60$, $Q = 50$, hence $W_{\\max} = 3000$) and a uniform efficiency overestimator $\\bar{\\eta}(H,Q) \\equiv \\max \\eta = 0.95$, yielding $$P_{\\text{UB}} \\approx 1000 \\times 9.81 \\times 3000 \\times 0.95 \\approx 27.9585 \\text{ megawatts}.$$ The relative optimality gap computed as $(P_{\\text{UB}} - P_{\\text{LB}})/P_{\\text{UB}}$ is approximately $$\\frac{27.9585 - 16.309125}{27.9585} \\approx 0.4167 \\text{ (about }41.7\\%\\text{)}.$$ Cutting planes generated from additional sampled $(H,Q)$ points can tighten $\\bar{\\eta}$ and the relaxation of $W$, monotonically reducing $P_{\\text{UB}}$ until the gap is acceptably small.\n\nD. Generate cutting planes as tangents to the nonconvex product $P = \\rho g H Q \\eta(H,Q)$ in $(H,Q)$ space and add them directly to the model as $P \\ge \\alpha + \\beta_H H + \\beta_Q Q$. This produces an outer approximation that lowers the dual bound while preserving feasibility. The relative gap cannot be computed until all tangents are added, because primal feasibility is not needed for gap assessment in maximization problems.",
            "solution": "The problem statement has been critically validated and is deemed sound. It presents a well-posed, scientifically grounded optimization problem common in energy systems engineering. The data provided are physically realistic and mathematically consistent. The task is to analyze methods for bounding the solution to this nonconvex maximization problem.\n\nThe core problem is to maximize the mechanical power $P$ given by\n$$P(H,Q) = \\rho g H Q \\eta(H,Q)$$\nsubject to the box constraints $H \\in [40, 60]$ meters and $Q \\in [20, 50]$ cubic meters per second. The constants are $\\rho = 1000 \\text{ kg/m}^3$ and $g = 9.81 \\text{ m/s}^2$. The function is nonconvex due to the bilinear term $HQ$ and the generally nonconvex efficiency surface $\\eta(H,Q)$. Let the true, unknown maximum power be $P^*$.\n\nIn optimization, we bound $P^*$ using:\n1.  **Primal Feasible Solutions (Lower Bounds):** Any point $(H_f, Q_f)$ within the feasible domain provides a lower bound (LB) on the maximum value, $P_{\\text{LB}} = P(H_f, Q_f) \\le P^*$. A tighter lower bound can be found by evaluating $P$ at several feasible points and taking the maximum.\n2.  **Convex Relaxations (Upper Bounds):** A relaxation of the problem is formed by enlarging the feasible set and/or replacing the objective function with an overestimating function. The solution to this relaxed (and typically convex) problem, $P_{\\text{UB}}$, provides an upper bound (UB) on the true maximum, $P^* \\le P_{\\text{UB}}$. The goal of techniques like cutting planes is to iteratively tighten this relaxation to reduce $P_{\\text{UB}}$ and thus close the optimality gap, which is typically defined as $(P_{\\text{UB}} - P_{\\text{LB}})/P_{\\text{UB}}$ or a similar ratio.\n\nWe will now evaluate each option based on these principles.\n\n**Option A Evaluation**\nThis option suggests using a piecewise linear **inner approximation** of $\\eta(H,Q)$ and treating the result as a **dual (upper) bound**. An inner approximation, or underestimator, $\\eta_{\\text{inner}}(H,Q)$, is a function such that $\\eta_{\\text{inner}}(H,Q) \\le \\eta(H,Q)$ for all $(H,Q)$. When maximizing a positive function, using an underestimator for one of its factors results in an underestimator for the entire function: $P_{\\text{approx}} = \\rho g H Q \\eta_{\\text{inner}}(H,Q) \\le P(H,Q)$. The maximum of this approximate problem would therefore yield a **lower bound** on the true maximum $P^*$, not an upper bound. The statement that \"inner approximations lie below the true surface\" is correct, but the conclusion that this \"yields conservative upper bounds\" is fundamentally incorrect for a maximization problem. It yields a lower bound.\n**Verdict: Incorrect**\n\n**Option B Evaluation**\nThis option claims that using Special Ordered Sets of type 2 (SOS2) across a triangulation of the $(H,Q)$ grid can **exactly represent** the nonconvex function $\\eta(H,Q)$. This is false. A piecewise linear representation on a triangulation is an **approximation** of the true, continuously varying efficiency surface $\\eta(H,Q)$. The approximation is exact only at the given data points (the vertices of the triangles), but not across the entire surface. Consequently, the claim that McCormick envelopes for the bilinear term $W = HQ$ become unnecessary is also flawed. The standard approach involves applying SOS2 to variables that are part of a linear objective function. In this problem, substituting the piecewise representation $H = \\sum_i \\lambda_i H_i$, $Q = \\sum_i \\lambda_i Q_i$, and $\\eta = \\sum_i \\lambda_i \\eta_i$ into the power equation $P = \\rho g H Q \\eta$ would result in a cubic expression in the weighting variables $\\lambda_i$, which is highly nonconvexâ€”far more complex than the original problem. The assertion that the problem becomes a linear program and the gap is zero is incorrect.\n**Verdict: Incorrect**\n\n**Option C Evaluation**\nThis option proposes a concrete construction for a lower and an upper bound and calculates the resulting optimality gap.\n\n1.  **Primal Lower Bound ($P_{\\text{LB}}$):** It suggests evaluating $P$ at the feasible point $(H,Q) = (50,35)$, where $\\eta=0.95$. This is a valid method for generating a primal feasible solution and thus a lower bound.\n    The water power component is $W = H \\times Q = 50 \\text{ m} \\times 35 \\text{ m}^3/\\text{s} = 1750 \\text{ m}^4/\\text{s}$.\n    The power is $P_{\\text{LB}} = \\rho g W \\eta = 1000 \\times 9.81 \\times 1750 \\times 0.95 = 16,309,125 \\text{ Watts}$.\n    Converting to megawatts ($1 \\text{ MW} = 10^6 \\text{ W}$), we get $P_{\\text{LB}} = 16.309125 \\text{ MW}$. The calculation is correct.\n\n2.  **Dual Upper Bound ($P_{\\text{UB}}$):** It suggests creating a relaxation by:\n    a) Replacing the equality $W = HQ$ with its convex relaxation over the domain. When maximizing a positive term multiplied by $W$, this amounts to letting $W$ take its maximum possible value, which is $W_{\\max} = H_{\\max} \\times Q_{\\max} = 60 \\text{ m} \\times 50 \\text{ m}^3/\\text{s} = 3000 \\text{ m}^4/\\text{s}$. This conceptual step is correct.\n    b) Replacing $\\eta(H,Q)$ with a uniform overestimator, $\\bar{\\eta}$. Based on the provided data, the maximum measured efficiency is $\\max\\{0.85, 0.88, 0.92, 0.90, 0.95\\} = 0.95$. Using $\\bar{\\eta} = 0.95$ is a valid overestimator.\n    The upper bound is then $P_{\\text{UB}} = \\rho g W_{\\max} \\bar{\\eta} = 1000 \\times 9.81 \\times 3000 \\times 0.95 = 27,958,500 \\text{ Watts}$.\n    Converting to megawatts, $P_{\\text{UB}} = 27.9585 \\text{ MW}$. The calculation is correct.\n\n3.  **Relative Optimality Gap:** The gap is computed as $(P_{\\text{UB}} - P_{\\text{LB}})/P_{\\text{UB}}$.\n    $$\\text{Gap} = \\frac{27.9585 - 16.309125}{27.9585} = \\frac{11.649375}{27.9585} \\approx 0.41666...$$\n    This is approximately $41.7\\%$. The calculation is correct.\n\n4.  **Cutting Planes:** The final sentence correctly states that cutting planes can be used to tighten the relaxations of both $W$ and $\\eta$, which monotonically decreases the upper bound $P_{\\text{UB}}$ and helps close the optimality gap. This is an accurate description of the branch-and-cut or cutting-plane solution methodology.\n\nEvery part of this option is consistent with established principles of global optimization for nonconvex problems.\n**Verdict: Correct**\n\n**Option D Evaluation**\nThis option proposes generating cutting planes of the form $P \\ge \\alpha + \\beta_H H + \\beta_Q Q$. This inequality bounds the objective function $P$ from **below**. In a maximization problem, an effective cutting plane must constrain the objective from **above** (i.e., of the form $P \\le ...$) in order to reduce the upper bound $P_{\\text{UB}}$ obtained from the relaxation. The proposed cuts would define an inner approximation (a lower bound on the function), which does not tighten the dual bound. Furthermore, the claim that this produces an \"outer approximation that lowers the dual bound\" is a contradiction. The final sentence is also incorrect on two counts. First, the relative gap can be computed at any stage of an algorithm, provided one has a valid primal-dual pair $(P_{\\text{LB}}, P_{\\text{UB}})$. Second, it claims \"primal feasibility is not needed for gap assessment,\" which is false. A primal feasible solution is precisely what provides the lower bound $P_{\\text{LB}}$, without which no meaningful optimality gap can be computed.\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}