{
    "hands_on_practices": [
        {
            "introduction": "Understanding the performance of electrolyzers and fuel cells requires modeling not just their steady-state operation, but also their transient response to changes in load. This first practice explores the fundamental dynamics at the electrode-electrolyte interface immediately following a current step. By modeling the interface as a parallel combination of a charge-transfer resistance ($R_{ct}$) and a double-layer capacitance ($C$), you will derive the time-dependent partitioning of current between the desired faradaic reaction and non-faradaic capacitive charging, quantifying the instantaneous faradaic efficiency $\\eta_F(t)$ . This exercise is crucial for grasping how interfacial properties govern the device's response time and efficiency during dynamic operation.",
            "id": "4087788",
            "problem": "A planar electrode in an electrochemical energy conversion device (an electrolyzer or a fuel cell) is subjected to a step change in applied current. The interfacial dynamics include charging of the electrochemical double layer and charge-transfer kinetics. The objective is to derive, from first principles appropriate to energy systems modeling, the transient fraction of the applied current that is faradaic at the interface and to quantify the time-dependent faradaic efficiency. You must then implement the resulting expression in a complete, runnable program to evaluate specified test cases.\n\nStart from the following valid bases:\n- Kirchhoff’s Current Law (KCL): The sum of currents into the interfacial node is equal to the externally applied current. Denote the applied current by $I(t)$, the faradaic current by $i_F(t)$, and the capacitive current by $i_C(t)$, giving $I(t) = i_F(t) + i_C(t)$.\n- Capacitive current relation for the electrochemical double layer: $i_C(t) = C \\, \\dfrac{d\\eta(t)}{dt}$ where $C$ is the double-layer capacitance and $\\eta(t)$ is the interfacial overpotential.\n- Linearized charge-transfer kinetics near an operating point: $i_F(t) \\approx \\dfrac{\\eta(t)}{R_{ct}}$, where $R_{ct}$ is the charge-transfer resistance defined from the slope of the current–overpotential relation for the electrochemical reaction at the operating point. This approximation is valid for small $|\\eta(t)|$ over the transient of interest.\n\nConsider a constant-current step $I(t) = I_0 \\, u(t)$, where $I_0$ is a positive constant and $u(t)$ is the unit step function. Assume an initially uncharged interface with $ \\eta(0^-) = 0$ and no prior reaction current. Derive the governing equation for $\\eta(t)$ from the bases above, and from that, derive the instantaneous faradaic efficiency defined as the fraction of applied current that is faradaic at time $t$,\n$$\\eta_F(t) \\equiv \\dfrac{i_F(t)}{I(t)}.$$\nExpress $\\eta_F(t)$ in terms of $t$, $C$, and $R_{ct}$ under the stated assumptions. You must clearly state any limiting behavior needed to handle degenerate cases such as $C = 0$.\n\nAfter completing the derivation, implement a program that computes $\\eta_F(t)$ for the test suite below. Use the units $I_0$ in amperes, $R_{ct}$ in ohms, $C$ in farads, and $t$ in seconds. The faradaic efficiency is dimensionless and must be reported as a decimal number. Your program must produce all results rounded to $6$ decimal digits.\n\nTest suite parameter sets $(I_0, R_{ct}, C, t)$:\n- Case $1$: $(10, 0.2, 0.5, 0.1)$\n- Case $2$: $(5, 0.2, 0.5, 0)$\n- Case $3$: $(50, 0.2, 0.5, 1)$\n- Case $4$: $(10, 0.2, 10^{-6}, 10^{-3})$\n- Case $5$: $(10, 0.2, 0, 10^{-2})$\n- Case $6$: $(10, 10, 0.5, 0.5)$\n- Case $7$: $(10, 0.2, 5, 0.2)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,\\dots,r_7]$), where each $r_k$ is the computed and rounded value of $\\eta_F(t)$ for case $k$ in the order given above.",
            "solution": "The problem statement is evaluated to be valid as it is scientifically grounded, well-posed, and objective. It provides a complete and consistent set of definitions and constraints to derive a unique, meaningful solution based on fundamental principles of electrochemistry and circuit theory.\n\nThe derivation of the faradaic efficiency, $\\eta_F(t)$, proceeds from the provided first principles.\n\nFirst, we establish the governing ordinary differential equation (ODE) for the interfacial overpotential, $\\eta(t)$. We begin with Kirchhoff's Current Law (KCL) applied to the electrode interface:\n$$I(t) = i_F(t) + i_C(t)$$\nwhere $I(t)$ is the total applied current, $i_F(t)$ is the faradaic current due to charge-transfer reaction, and $i_C(t)$ is the non-faradaic capacitive current due to the charging of the electrochemical double layer.\n\nThe problem provides the constitutive relations for the faradaic and capacitive currents:\n1.  Linearized charge-transfer kinetics (Ohm's law for the interface):\n    $$i_F(t) = \\frac{\\eta(t)}{R_{ct}}$$\n    where $R_{ct}$ is the charge-transfer resistance.\n2.  Capacitive current for the double layer:\n    $$i_C(t) = C \\frac{d\\eta(t)}{dt}$$\n    where $C$ is the double-layer capacitance.\n\nSubstituting these relations into the KCL equation yields:\n$$I(t) = \\frac{\\eta(t)}{R_{ct}} + C \\frac{d\\eta(t)}{dt}$$\n\nThe applied current is a step function, $I(t) = I_0 u(t)$, where $u(t)$ is the Heaviside step function. For time $t  0$, $I(t) = I_0$. The ODE thus becomes:\n$$I_0 = \\frac{\\eta(t)}{R_{ct}} + C \\frac{d\\eta(t)}{dt}$$\n\nThis is a first-order linear non-homogeneous ODE. We can rearrange it into the standard form:\n$$\\frac{d\\eta(t)}{dt} + \\frac{1}{R_{ct}C} \\eta(t) = \\frac{I_0}{C}$$\n\nWe define the characteristic time constant of the interface, $\\tau$, as $\\tau = R_{ct}C$. The equation simplifies to:\n$$\\frac{d\\eta(t)}{dt} + \\frac{1}{\\tau} \\eta(t) = \\frac{I_0}{C}$$\n\nThe general solution to this ODE is the sum of the homogeneous solution, $\\eta_h(t)$, and a particular solution, $\\eta_p(t)$.\nThe homogeneous equation is $\\frac{d\\eta_h}{dt} + \\frac{1}{\\tau}\\eta_h = 0$, which has the solution $\\eta_h(t) = A e^{-t/\\tau}$ for some constant $A$.\nFor the particular solution, since the forcing term $\\frac{I_0}{C}$ is constant, we assume a constant solution $\\eta_p(t) = K$. Substituting this into the ODE gives $0 + \\frac{K}{\\tau} = \\frac{I_0}{C}$, which yields $K = \\frac{I_0 \\tau}{C} = \\frac{I_0 (R_{ct}C)}{C} = I_0 R_{ct}$.\nSo, the particular solution is $\\eta_p(t) = I_0 R_{ct}$.\n\nThe general solution for the overpotential is:\n$$\\eta(t) = \\eta_h(t) + \\eta_p(t) = A e^{-t/\\tau} + I_0 R_{ct}$$\n\nTo find the constant $A$, we apply the initial condition $\\eta(0^-) = 0$. The overpotential across a capacitor cannot change instantaneously given a finite current, so $\\eta(0^+) = \\eta(0^-) = 0$. Evaluating the general solution at $t = 0^+$:\n$$\\eta(0^+) = A e^0 + I_0 R_{ct} = A + I_0 R_{ct} = 0$$\nThis implies $A = -I_0 R_{ct}$.\n\nSubstituting $A$ back into the general solution gives the specific solution for the overpotential transient:\n$$\\eta(t) = I_0 R_{ct} (1 - e^{-t/\\tau}) = I_0 R_{ct} \\left(1 - e^{-t/(R_{ct}C)}\\right)$$\nThis expression is valid for $t \\ge 0$.\n\nNext, we derive the instantaneous faradaic efficiency, $\\eta_F(t)$, defined as $\\eta_F(t) = \\frac{i_F(t)}{I(t)}$.\nFirst, we find the faradaic current, $i_F(t)$, using its definition:\n$$i_F(t) = \\frac{\\eta(t)}{R_{ct}} = \\frac{I_0 R_{ct} \\left(1 - e^{-t/(R_{ct}C)}\\right)}{R_{ct}} = I_0 \\left(1 - e^{-t/(R_{ct}C)}\\right)$$\n\nFor $t  0$, the applied current is $I(t) = I_0$. Therefore, the faradaic efficiency is:\n$$\\eta_F(t) = \\frac{i_F(t)}{I(t)} = \\frac{I_0 \\left(1 - e^{-t/(R_{ct}C)}\\right)}{I_0} = 1 - e^{-t/(R_{ct}C)}$$\nThis is the desired expression for the faradaic efficiency. Note that its value is independent of the applied current magnitude, $I_0$.\n\nWe must also consider the degenerate case where the capacitance $C = 0$.\nIf $C = 0$, the capacitive current $i_C(t)$ is identically zero for any finite change in overpotential. The KCL equation becomes $I(t) = i_F(t)$. In this scenario, the interface is purely resistive, and all applied current is instantaneously faradaic.\nThus, for $C=0$ and $t0$, the efficiency is $\\eta_F(t) = \\frac{i_F(t)}{I(t)} = \\frac{I(t)}{I(t)} = 1$.\nOur derived formula $\\eta_F(t) = 1 - e^{-t/(R_{ct}C)}$ is consistent with this physical limit. As $C \\to 0^+$, for any $t  0$ and $R_{ct}  0$, the argument of the exponential, $-t/(R_{ct}C)$, approaches $-\\infty$. Consequently, $e^{-t/(R_{ct}C)} \\to 0$ and $\\eta_F(t) \\to 1$.\nFor computational implementation, if $C=0$, we must directly set $\\eta_F(t) = 1$ to avoid division by zero.\n\nFinally, we analyze the behavior at $t=0$. For any $C0$, as $t \\to 0^+$, the term $-t/(R_{ct}C) \\to 0$. Thus, $e^{-t/(R_{ct}C)} \\to 1$, and $\\eta_F(t) \\to 1-1 = 0$. This is physically correct: at the instant the current is applied, the uncharged double layer acts as a short circuit, and all current goes into charging it ($i_C(0^+) = I_0, i_F(0^+) = 0$).\n\nThe model used is an equivalent circuit model often referred to as a simplified Randles circuit. The derived transient response is a classic RC circuit charging curve, demonstrating the interplay between capacitive and resistive current pathways at an electrochemical interface.\n\nSummary of the function to be implemented:\n$$ \\eta_F(t, R_{ct}, C) = \\begin{cases} 1  \\text{if } C=0 \\\\ 1 - e^{-t/(R_{ct}C)}  \\text{if } C0 \\end{cases} $$\nThis single expression correctly handles all test cases, including those with $t=0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and calculates the transient faradaic efficiency at a planar electrode interface.\n    \"\"\"\n\n    # Test suite parameter sets (I_0, R_ct, C, t)\n    # I_0 is in Amperes, R_ct in Ohms, C in Farads, t in seconds.\n    test_cases = [\n        # Case 1: (10, 0.2, 0.5, 0.1)\n        (10, 0.2, 0.5, 0.1),\n        # Case 2: (5, 0.2, 0.5, 0)\n        (5, 0.2, 0.5, 0),\n        # Case 3: (50, 0.2, 0.5, 1)\n        (50, 0.2, 0.5, 1),\n        # Case 4: (10, 0.2, 1e-6, 1e-3)\n        (10, 0.2, 1e-6, 1e-3),\n        # Case 5: (10, 0.2, 0, 1e-2)\n        (10, 0.2, 0, 1e-2),\n        # Case 6: (10, 10, 0.5, 0.5)\n        (10, 10, 0.5, 0.5),\n        # Case 7: (10, 0.2, 5, 0.2)\n        (10, 0.2, 5, 0.2),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        I0, R_ct, C, t = case\n\n        # The derived faradaic efficiency eta_F is given by:\n        # eta_F(t) = 1 - exp(-t / (R_ct * C))\n        # This expression is independent of the applied current I0.\n\n        # Handle the degenerate case where C = 0.\n        # In this case, the interface is purely resistive, and the entire\n        # current is faradaic instantaneously. Thus, eta_F = 1.\n        if C == 0:\n            eta_F = 1.0\n        else:\n            # Handle the case where R_ct is zero (though not in test cases).\n            # If R_ct is zero, the time constant is zero and the model changes,\n            # but we assume R_ct  0 as per the physical definition.\n            # If t is zero, the exponent is zero, exp(0) = 1, so eta_F = 0.\n            # This is physically correct as all initial current charges the capacitor.\n            time_constant = R_ct * C\n            if time_constant == 0:\n                # This case is physically equivalent to C=0 or R_ct=0.\n                # If R_ct=0, model is ill-defined. If C=0, handled above.\n                # For t0, this implies instantaneous response, so eta_F=1.\n                eta_F = 1.0 if t  0 else 0.0\n            else:\n                eta_F = 1.0 - np.exp(-t / time_constant)\n        \n        # Round the result to 6 decimal digits.\n        rounded_result = round(eta_F, 6)\n        results.append(str(rounded_result))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While interfacial kinetics determine the maximum possible reaction rate, the actual performance of a real-world device is often limited by the transport of reactants to the active sites. This practice shifts our focus from a zero-dimensional interface to a one-dimensional flow channel, where you will model the interplay between convective flow, mass transfer, and electrochemical reaction . By deriving and solving a species conservation equation for the bulk reactant concentration $c_b(x)$, you will learn to predict the axial current density distribution $j(x)$ and understand how reactant depletion affects local and total device performance.",
            "id": "4087830",
            "problem": "Consider a steady, isothermal, incompressible flow of a single reacting species in a straight channel above a planar reactive electrode. The flow is along the axial coordinate $x \\in [0,L]$ with constant volumetric flow rate $Q$ and uniform cross section of width $W$. Let $c(x,y)$ denote the molar concentration of the reactant species in the channel, where $y$ is the transverse coordinate measured from the reactive wall at $y=0$ upwards into the channel. Assume the following physically standard and widely accepted bases and approximations from mass conservation and transport phenomena:\n- Species conservation: at steady state, convection balances diffusion and reaction, with negligible axial diffusion compared to axial convection, and transverse diffusion dominant across a thin hydrodynamic and concentration boundary layer.\n- Fick’s law of diffusion: the diffusive molar flux is $-D \\, \\partial c/\\partial y$ in the transverse direction, where $D$ is the molecular diffusivity (assumed constant).\n- A linear mass-transfer description near the wall: the molar flux from the bulk to the wall is $J(x) = k_m \\left(c_b(x) - c_s(x)\\right)$, where $k_m$ is a mass-transfer coefficient, $c_b(x)$ is a representative bulk concentration near the edge of the diffusion film, and $c_s(x)$ is the interfacial concentration at the reactive wall.\n- First-order surface reaction kinetics on the electrode: the molar reaction rate per unit area is $R_s(x) = k_r \\, c_s(x)$, where $k_r$ is a kinetic rate coefficient. The corresponding local current density is linked to the molar reaction rate by Faraday’s law as $j(x) = n F R_s(x)$, where $n$ is the number of electrons transferred per mole of reactant and $F$ is the Faraday constant.\n\nTask A (derivation): Starting from species conservation and Fick’s law in the channel, use a cross-sectional averaging or thin-film argument to derive a one-dimensional axial balance for $c_b(x)$ that closes the problem by coupling the mass-transfer flux $J(x)$ and the surface reaction rate $R_s(x)$ through an interfacial balance at the reactive wall. Determine an explicit expression for the effective first-order consumption of $c_b(x)$ along $x$ in terms of $k_m$ and $k_r$, and obtain the resulting closed-form expressions for the axial bulk concentration $c_b(x)$ and the current density distribution $j(x)$.\n\nTask B (evaluation): Using your derived expressions, compute the following five outputs for each specified test case:\n- The outlet bulk concentration $c_b(L)$ in $\\mathrm{mol/m^3}$.\n- The local current density at the channel inlet $j(0)$ in $\\mathrm{A/m^2}$.\n- The local current density at the mid-channel $j(L/2)$ in $\\mathrm{A/m^2}$.\n- The local current density at the channel outlet $j(L)$ in $\\mathrm{A/m^2}$.\n- The total current $I_{\\mathrm{tot}} = \\int_0^L j(x) \\, W \\, dx$ in $\\mathrm{A}$.\n\nAll answers must be expressed in SI units as indicated above and rounded to six decimal places. Angles do not appear in this problem. Do not use percentages.\n\nYour program must implement your derived formulas and evaluate the following test suite. In each case, assume hydrogen as the reactant with $n = 2$ and $F = 96485 \\ \\mathrm{C/mol}$.\n\nTest cases (each line lists $Q$ in $\\mathrm{m^3/s}$, $W$ in $\\mathrm{m}$, $L$ in $\\mathrm{m}$, $k_m$ in $\\mathrm{m/s}$, $k_r$ in $\\mathrm{m/s}$, $c_{\\mathrm{in}}$ in $\\mathrm{mol/m^3}$):\n1. $Q = 1.0 \\times 10^{-6}$, $W = 1.0 \\times 10^{-3}$, $L = 0.10$, $k_m = 2.0 \\times 10^{-3}$, $k_r = 5.0 \\times 10^{-3}$, $c_{\\mathrm{in}} = 15.0$.\n2. $Q = 1.0 \\times 10^{-6}$, $W = 1.0 \\times 10^{-3}$, $L = 0.10$, $k_m = 1.0 \\times 10^{-2}$, $k_r = 1.0 \\times 10^{-4}$, $c_{\\mathrm{in}} = 34.0$.\n3. $Q = 1.0 \\times 10^{-6}$, $W = 1.0 \\times 10^{-3}$, $L = 0.10$, $k_m = 5.0 \\times 10^{-5}$, $k_r = 1.0 \\times 10^{-1}$, $c_{\\mathrm{in}} = 34.0$.\n4. $Q = 1.0 \\times 10^{-4}$, $W = 1.0 \\times 10^{-3}$, $L = 0.10$, $k_m = 2.0 \\times 10^{-3}$, $k_r = 5.0 \\times 10^{-3}$, $c_{\\mathrm{in}} = 15.0$.\n5. $Q = 1.0 \\times 10^{-6}$, $W = 1.0 \\times 10^{-3}$, $L = 0.10$, $k_m = 2.0 \\times 10^{-3}$, $k_r = 0.0$, $c_{\\mathrm{in}} = 15.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, append the five outputs in the order $[c_b(L), j(0), j(L/2), j(L), I_{\\mathrm{tot}}]$, so that the final output for the five cases is a flattened list of $25$ numbers: $[c^{(1)}_L, j^{(1)}_0, j^{(1)}_{L/2}, j^{(1)}_L, I^{(1)}_{\\mathrm{tot}}, \\ldots, c^{(5)}_L, j^{(5)}_0, j^{(5)}_{L/2}, j^{(5)}_L, I^{(5)}_{\\mathrm{tot}}]$, with each value rounded to six decimal places.",
            "solution": "The problem is assessed for validity before proceeding to a solution.\n\n### Step 1: Extract Givens\n- **Flow Geometry**: Steady, isothermal, incompressible flow in a straight channel of length $L$ and width $W$. Axial coordinate $x \\in [0,L]$, transverse coordinate $y$ from the reactive wall at $y=0$.\n- **Flow Rate**: Constant volumetric flow rate $Q$.\n- **Species**: Single reacting species with molar concentration $c(x,y)$.\n- **Governing Principles  Approximations**:\n    1.  **Species Conservation**: Steady state, negligible axial diffusion, dominant transverse diffusion.\n    2.  **Fick's Law**: Transverse diffusive molar flux is $-D \\, \\partial c/\\partial y$, with constant molecular diffusivity $D$.\n    3.  **Mass Transfer**: Molar flux to the wall is $J(x) = k_m (c_b(x) - c_s(x))$, where $k_m$ is the mass-transfer coefficient, $c_b(x)$ is the bulk concentration, and $c_s(x)$ is the surface concentration.\n    4.  **Reaction Kinetics**: First-order surface reaction rate per unit area is $R_s(x) = k_r c_s(x)$, where $k_r$ is the kinetic rate coefficient.\n    5.  **Faraday's Law**: Local current density is $j(x) = n F R_s(x)$, where $n$ is the number of electrons transferred and $F$ is the Faraday constant.\n- **Tasks**:\n    - **Task A (Derivation)**: Derive closed-form expressions for the axial bulk concentration $c_b(x)$ and current density distribution $j(x)$.\n    - **Task B (Evaluation)**: Compute five specific outputs for each test case: $c_b(L)$, $j(0)$, $j(L/2)$, $j(L)$, and $I_{\\mathrm{tot}} = \\int_0^L j(x) \\, W \\, dx$.\n- **Constants**: For hydrogen reactant, $n = 2$. Faraday constant, $F = 96485 \\ \\mathrm{C/mol}$.\n- **Input Parameters for Test Cases**:\n    - Case 1: $Q = 1.0 \\times 10^{-6} \\ \\mathrm{m^3/s}$, $W = 1.0 \\times 10^{-3} \\ \\mathrm{m}$, $L = 0.10 \\ \\mathrm{m}$, $k_m = 2.0 \\times 10^{-3} \\ \\mathrm{m/s}$, $k_r = 5.0 \\times 10^{-3} \\ \\mathrm{m/s}$, $c_{\\mathrm{in}} = 15.0 \\ \\mathrm{mol/m^3}$.\n    - Case 2: $Q = 1.0 \\times 10^{-6} \\ \\mathrm{m^3/s}$, $W = 1.0 \\times 10^{-3} \\ \\mathrm{m}$, $L = 0.10 \\ \\mathrm{m}$, $k_m = 1.0 \\times 10^{-2} \\ \\mathrm{m/s}$, $k_r = 1.0 \\times 10^{-4} \\ \\mathrm{m/s}$, $c_{\\mathrm{in}} = 34.0 \\ \\mathrm{mol/m^3}$.\n    - Case 3: $Q = 1.0 \\times 10^{-6} \\ \\mathrm{m^3/s}$, $W = 1.0 \\times 10^{-3} \\ \\mathrm{m}$, $L = 0.10 \\ \\mathrm{m}$, $k_m = 5.0 \\times 10^{-5} \\ \\mathrm{m/s}$, $k_r = 1.0 \\times 10^{-1} \\ \\mathrm{m/s}$, $c_{\\mathrm{in}} = 34.0 \\ \\mathrm{mol/m^3}$.\n    - Case 4: $Q = 1.0 \\times 10^{-4} \\ \\mathrm{m^3/s}$, $W = 1.0 \\times 10^{-3} \\ \\mathrm{m}$, $L = 0.10 \\ \\mathrm{m}$, $k_m = 2.0 \\times 10^{-3} \\ \\mathrm{m/s}$, $k_r = 5.0 \\times 10^{-3} \\ \\mathrm{m/s}$, $c_{\\mathrm{in}} = 15.0 \\ \\mathrm{mol/m^3}$.\n    - Case 5: $Q = 1.0 \\times 10^{-6} \\ \\mathrm{m^3/s}$, $W = 1.0 \\times 10^{-3} \\ \\mathrm{m}$, $L = 0.10 \\ \\mathrm{m}$, $k_m = 2.0 \\times 10^{-3} \\ \\mathrm{m/s}$, $k_r = 0.0 \\ \\mathrm{m/s}$, $c_{\\mathrm{in}} = 15.0 \\ \\mathrm{mol/m^3}$.\n- **Boundary Condition**: Implicitly, the bulk concentration at the channel inlet is $c_b(0) = c_{\\mathrm{in}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective.\n- **Scientific Grounding**: The problem is built on fundamental principles of chemical engineering and electrochemistry, including mass conservation (convection-diffusion-reaction), Fick's law, linear mass-transfer correlations, and first-order reaction kinetics. These form the standard basis for modeling such systems.\n- **Well-Posedness**: The request to derive a one-dimensional model from a two-dimensional description using a thin-film or cross-sectional averaging argument is a standard and valid engineering simplification (specifically, a plug-flow reactor model with wall reaction). The problem provides all necessary parameters ($Q, W, L, k_m, k_r, c_{\\mathrm{in}}, n, F$) and a clear inlet boundary condition ($c_b(0) = c_{\\mathrm{in}}$) to derive and solve the model, leading to a unique solution for the specified quantities.\n- **Objectivity**: The problem is stated using precise, technical language, free from any subjective or ambiguous terminology.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\n### Task A: Derivation of Governing Equations\n\nWe begin by performing a molar species balance on a differential control volume of the channel, extending from axial position $x$ to $x+dx$. The cross-sectional area of the channel is $A_c$, and the volumetric flow rate is $Q$. The rate of change of moles of the reactant species within the control volume is zero at steady state. The balance is:\n$$\n(\\text{Molar flow in at } x) - (\\text{Molar flow out at } x+dx) - (\\text{Rate of consumption at the wall}) = 0\n$$\nIn mathematical terms, this is expressed using the bulk concentration $c_b(x)$:\n$$\nQ c_b(x) - Q c_b(x+dx) - R_s(x) (W dx) = 0\n$$\nwhere $R_s(x)$ is the molar reaction rate per unit area of the reactive wall, and $W dx$ is the differential area of the wall. Dividing by $dx$ and taking the limit as $dx \\to 0$, we obtain the ordinary differential equation:\n$$\n-Q \\frac{dc_b}{dx} - W R_s(x) = 0 \\quad \\implies \\quad Q \\frac{dc_b}{dx} = -W R_s(x)\n$$\nTo solve this, we must express the reaction rate $R_s(x)$ in terms of the bulk concentration $c_b(x)$. At the reactive surface, the molar flux of reactant from the bulk, $J(x)$, must equal the rate of consumption by the surface reaction, $R_s(x)$. The problem provides expressions for both:\n$$\nJ(x) = k_m (c_b(x) - c_s(x))\n$$\n$$\nR_s(x) = k_r c_s(x)\n$$\nEquating these two rates, $J(x) = R_s(x)$:\n$$\nk_m (c_b(x) - c_s(x)) = k_r c_s(x)\n$$\nWe solve for the unknown surface concentration $c_s(x)$:\n$$\nk_m c_b(x) = k_m c_s(x) + k_r c_s(x) = (k_m + k_r) c_s(x)\n$$\n$$\nc_s(x) = \\left( \\frac{k_m}{k_m + k_r} \\right) c_b(x)\n$$\nSubstituting this back into the expression for $R_s(x)$:\n$$\nR_s(x) = k_r \\left( \\frac{k_m}{k_m + k_r} \\right) c_b(x)\n$$\nThis defines an effective first-order rate coefficient, $k_{eff}$, which combines the resistances of mass transfer ($1/k_m$) and reaction kinetics ($1/k_r$) in series:\n$$\nk_{eff} = \\frac{k_m k_r}{k_m + k_r} = \\left(\\frac{1}{k_m} + \\frac{1}{k_r}\\right)^{-1}\n$$\nThe reaction rate is now expressed in terms of the bulk concentration: $R_s(x) = k_{eff} c_b(x)$.\nWe substitute this into the differential species balance:\n$$\nQ \\frac{dc_b}{dx} = -W (k_{eff} c_b(x))\n$$\nThis is a separable first-order ODE:\n$$\n\\frac{dc_b}{c_b} = -\\frac{W k_{eff}}{Q} dx\n$$\nWe integrate from the channel inlet ($x=0$, where $c_b(0) = c_{in}$) to an arbitrary position $x$:\n$$\n\\int_{c_{in}}^{c_b(x)} \\frac{dc'_b}{c'_b} = -\\frac{W k_{eff}}{Q} \\int_0^x dx'\n$$\n$$\n\\ln\\left(\\frac{c_b(x)}{c_{in}}\\right) = -\\frac{W k_{eff}}{Q} x\n$$\nSolving for $c_b(x)$, we get the axial bulk concentration profile:\n$$\nc_b(x) = c_{in} \\exp\\left(-\\frac{W k_{eff}}{Q} x\\right)\n$$\nNext, we derive the expression for the local current density, $j(x)$. Using Faraday's law, $j(x) = n F R_s(x)$, and our expression for $R_s(x)$:\n$$\nj(x) = n F k_{eff} c_b(x) = n F k_{eff} c_{in} \\exp\\left(-\\frac{W k_{eff}}{Q} x\\right)\n$$\nThis completes the derivation part (Task A).\n\n### Task B: Evaluation Formulas\nThe following formulas are used for the numerical evaluation. We define the decay constant $\\alpha = \\frac{W k_{eff}}{Q}$.\n\n1.  **Outlet bulk concentration $c_b(L)$**:\n    $$\n    c_b(L) = c_{in} \\exp(-\\alpha L)\n    $$\n2.  **Local current density at the channel inlet $j(0)$**:\n    $$\n    j(0) = n F k_{eff} c_{in} \\exp(-\\alpha \\cdot 0) = n F k_{eff} c_{in}\n    $$\n3.  **Local current density at the mid-channel $j(L/2)$**:\n    $$\n    j(L/2) = n F k_{eff} c_{in} \\exp\\left(-\\frac{\\alpha L}{2}\\right)\n    $$\n4.  **Local current density at the channel outlet $j(L)$**:\n    $$\n    j(L) = n F k_{eff} c_{in} \\exp(-\\alpha L)\n    $$\n5.  **Total current $I_{\\mathrm{tot}}$**:\n    The total current is the integral of the local current density over the entire electrode area, $A_{electrode} = W L$.\n    $$\n    I_{\\mathrm{tot}} = \\int_0^L j(x) W dx = \\int_0^L n F k_{eff} c_{in} W \\exp(-\\alpha x) dx\n    $$\n    $$\n    I_{\\mathrm{tot}} = n F k_{eff} c_{in} W \\int_0^L \\exp(-\\alpha x) dx = n F k_{eff} c_{in} W \\left[ -\\frac{1}{\\alpha} \\exp(-\\alpha x) \\right]_0^L\n    $$\n    $$\n    I_{\\mathrm{tot}} = n F k_{eff} c_{in} W \\left( \\frac{1 - \\exp(-\\alpha L)}{\\alpha} \\right)\n    $$\n    Substituting $\\alpha = W k_{eff}/Q$, we can simplify this expression:\n    $$\n    I_{\\mathrm{tot}} = n F k_{eff} c_{in} W \\left( \\frac{1 - \\exp(-\\alpha L)}{W k_{eff}/Q} \\right) = n F Q c_{in} (1 - \\exp(-\\alpha L))\n    $$\n    This final form for $I_{\\mathrm{tot}}$ is computationally more stable, especially for cases where $k_{eff}$ (and thus $\\alpha$) approaches zero. It also shows physically that the total current is proportional to the total amount of reactant consumed in the channel, which is $Q(c_{in} - c_b(L))$.\n\nThese formulas will be implemented for each test case. For edge cases where $k_m + k_r = 0$, it implies $k_{eff}=0$ (since rates are non-negative). Consequently, $\\alpha=0$, all current densities are zero, $I_{tot}=0$, and $c_b(L) = c_{in}$. The formulas are robust to this limit.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the electrochemical channel problem by deriving and applying formulas for concentration and current density.\n    \"\"\"\n    \n    # Define constants\n    n = 2  # Number of electrons for H2 oxidation\n    F = 96485  # Faraday constant in C/mol\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: Q, W, L, k_m, k_r, c_in\n    test_cases = [\n        (1.0e-6, 1.0e-3, 0.10, 2.0e-3, 5.0e-3, 15.0),\n        (1.0e-6, 1.0e-3, 0.10, 1.0e-2, 1.0e-4, 34.0),\n        (1.0e-6, 1.0e-3, 0.10, 5.0e-5, 1.0e-1, 34.0),\n        (1.0e-4, 1.0e-3, 0.10, 2.0e-3, 5.0e-3, 15.0),\n        (1.0e-6, 1.0e-3, 0.10, 2.0e-3, 0.0, 15.0),\n    ]\n\n    # List to store all results flattened\n    all_results = []\n\n    for case in test_cases:\n        Q, W, L, k_m, k_r, c_in = case\n\n        # 1. Calculate the effective rate coefficient, k_eff\n        # This combines mass transfer and reaction kinetics resistances in series.\n        if k_m + k_r == 0:\n            k_eff = 0.0\n        else:\n            k_eff = (k_m * k_r) / (k_m + k_r)\n\n        # 2. Calculate the exponential decay constant, alpha\n        # This governs how rapidly concentration decays along the channel.\n        # A check for Q=0 is not needed based on test cases, but would be good practice.\n        alpha = (W * k_eff) / Q\n        \n        # 3. Calculate the five required outputs using derived formulas\n        \n        # Outlet bulk concentration c_b(L) in mol/m^3\n        cb_L = c_in * np.exp(-alpha * L)\n        \n        # Local current density at the channel inlet j(0) in A/m^2\n        j_0 = n * F * k_eff * c_in\n        \n        # Local current density at the mid-channel j(L/2) in A/m^2\n        j_L_half = j_0 * np.exp(-alpha * L / 2.0)\n        \n        # Local current density at the channel outlet j(L) in A/m^2\n        j_L = j_0 * np.exp(-alpha * L)\n        \n        # Total current I_tot in A\n        # Use np.expm1 for better numerical precision for small arguments.\n        # 1 - exp(-x) is equivalent to -expm1(-x)\n        I_tot = - (n * F * Q * c_in * np.expm1(-alpha * L))\n        \n        # Append the five formatted results for the current case\n        all_results.extend([\n            f\"{cb_L:.6f}\",\n            f\"{j_0:.6f}\",\n            f\"{j_L_half:.6f}\",\n            f\"{j_L:.6f}\",\n            f\"{I_tot:.6f}\"\n        ])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A powerful model is one that can accurately predict device behavior under varied operating conditions. This final practice bridges the gap between theory and experiment by guiding you through the process of calibrating a comprehensive fuel cell polarization model using experimental data . You will use least-squares fitting to extract temperature-dependent parameters, such as the exchange current density $j_0(T)$ and membrane conductivity $\\sigma(T)$, and then apply the Arrhenius equation to create a predictive tool. This exercise demonstrates a critical engineering workflow: transforming raw data into a robust model capable of forecasting performance and optimizing system operation.",
            "id": "4087828",
            "problem": "Consider a Proton Exchange Membrane (PEM) fuel cell described by a standard polarization model that combines reversible thermodynamics, activation losses, and ohmic losses. Let $V$ denote the cell voltage at current density $j$ and temperature $T$. The reversible voltage is $E_{\\mathrm{rev}}(T)$, the activation overpotential is modeled by the Tafel approximation of the Butler–Volmer equation, and the ohmic drop is modeled by a uniform ionic conductivity in the membrane. Specifically, assume the following physically motivated relationships:\n- Reversible voltage: $$E_{\\mathrm{rev}}(T) = E_0 - \\gamma \\left(T - T_0\\right),$$ where $E_0 = 1.229$ (volts), $\\gamma = 8.5 \\times 10^{-4}$ (volts per kelvin), and $T_0 = 298.15$ (kelvin).\n- Activation overpotential (Tafel form for a single dominant electrode process): $$\\eta_{\\mathrm{act}}(j,T) = \\frac{R T}{\\alpha F} \\ln\\!\\left(\\frac{j}{j_0(T)}\\right),$$ where $R$ is the universal gas constant, $\\alpha$ is the effective charge-transfer coefficient, $F$ is the Faraday constant, and $j_0(T)$ is the exchange current density.\n- Ohmic drop across the membrane: $$\\eta_{\\mathrm{ohm}}(j,T) = j \\frac{L_{\\mathrm{mem}}}{\\sigma(T)},$$ where $L_{\\mathrm{mem}}$ is the membrane thickness and $\\sigma(T)$ is the ionic conductivity of the membrane.\n\nThe overall voltage model is $$V(j,T) = E_{\\mathrm{rev}}(T) - \\eta_{\\mathrm{act}}(j,T) - \\eta_{\\mathrm{ohm}}(j,T).$$\n\nAssume the exchange current density $j_0(T)$ and membrane conductivity $\\sigma(T)$ each follow an Arrhenius form:\n- $$j_0(T) = A_{j_0}\\,\\exp\\!\\left(-\\frac{E_{a,\\mathrm{act}}}{R\\,T}\\right),$$\n- $$\\sigma(T) = A_{\\sigma}\\,\\exp\\!\\left(-\\frac{E_{a,\\mathrm{ohm}}}{R\\,T}\\right),$$\nwhere $A_{j_0}$, $A_{\\sigma}$ are pre-exponential factors and $E_{a,\\mathrm{act}}$, $E_{a,\\mathrm{ohm}}$ are activation energies.\n\nConstants to be used are:\n- Universal gas constant $R = 8.314462618$ (joules per mole per kelvin).\n- Faraday constant $F = 96485.33212$ (coulombs per mole).\n- Effective charge-transfer coefficient $\\alpha = 0.5$ (dimensionless).\n- Membrane thickness $L_{\\mathrm{mem}} = 2.0 \\times 10^{-5}$ (meters).\n\nYou are given polarization data at two temperatures, reported as triplets $(j,V)$ of current density and measured voltage. All current densities must be treated in $A/\\mathrm{m}^2$, all temperatures in kelvin, and all voltages in volts. The two datasets are:\n\n- At $T_1 = 333.15$ (kelvin) corresponding to $60^\\circ$C:\n  - $(j,V) = (500,\\,0.7890)$,\n  - $(j,V) = (2000,\\,0.7056)$,\n  - $(j,V) = (5000,\\,0.6455)$.\n\n- At $T_2 = 343.15$ (kelvin) corresponding to $70^\\circ$C:\n  - $(j,V) = (500,\\,0.8011)$,\n  - $(j,V) = (2000,\\,0.7173)$,\n  - $(j,V) = (5000,\\,0.6563)$.\n\nTasks:\n1. Starting from the given fundamental relationships, infer $j_0(T_1)$, $\\sigma(T_1)$ from the first dataset and $j_0(T_2)$, $\\sigma(T_2)$ from the second dataset by solving a well-posed least-squares parameter estimation problem based on $$V(j,T) = E_{\\mathrm{rev}}(T) - \\frac{R T}{\\alpha F}\\ln\\!\\left(\\frac{j}{j_0(T)}\\right) - j \\frac{L_{\\mathrm{mem}}}{\\sigma(T)}.$$\n   You must enforce $j_0(T)  0$ and $\\sigma(T)  0$.\n\n2. Using the two temperature-specific estimates of $j_0(T)$ and $\\sigma(T)$, derive the Arrhenius parameters $(A_{j_0}, E_{a,\\mathrm{act}})$ and $(A_{\\sigma}, E_{a,\\mathrm{ohm}})$ by fitting the two-point Arrhenius forms:\n   - $$\\ln j_0(T) = \\ln A_{j_0} - \\frac{E_{a,\\mathrm{act}}}{R}\\frac{1}{T},$$\n   - $$\\ln \\sigma(T) = \\ln A_{\\sigma} - \\frac{E_{a,\\mathrm{ohm}}}{R}\\frac{1}{T}.$$\n\n3. With these Arrhenius parameters, predict the voltage $V(j)$ at $T_3 = 353.15$ (kelvin) corresponding to $80^\\circ$C for the following test suite of current densities (all in $A/\\mathrm{m}^2$): $[50,\\,500,\\,2000,\\,5000,\\,10000]$. Use the same voltage model $$V(j,T_3) = E_{\\mathrm{rev}}(T_3) - \\frac{R T_3}{\\alpha F}\\ln\\!\\left(\\frac{j}{j_0(T_3)}\\right) - j \\frac{L_{\\mathrm{mem}}}{\\sigma(T_3)},$$ with $j_0(T_3)$ and $\\sigma(T_3)$ computed from the Arrhenius relationships you derived.\n\nRequirements:\n- Express all voltages in volts. The final outputs must be numerical values rounded to four decimal places.\n- Angles do not appear; no angle units are required.\n- No percentages appear; no percentage notation is required.\n- Your program must produce a single line of output containing the predicted voltages for the specified test suite at $T_3$ as a comma-separated list enclosed in square brackets, for example, $$[v_1,v_2,v_3,v_4,v_5].$$\n\nTest suite coverage mandate:\n- Include the given \"happy path\" values $j = 500$, $j = 2000$, and $j = 5000$.\n- Include the boundary-like low-current case $j = 50$ where activation dominates.\n- Include the higher-current case $j = 10000$ to probe ohmic contributions.\n\nYour task is to implement a complete, runnable program that performs all steps deterministically and outputs the required single-line format.",
            "solution": "The problem requires the development of a predictive model for a Proton Exchange Membrane (PEM) fuel cell's performance, based on a set of experimental data at two distinct temperatures. The solution involves a multi-step process: (1) estimating temperature-specific model parameters from polarization data using a least-squares method, (2) determining the temperature dependency of these parameters by fitting them to Arrhenius equations, and (3) using the complete model to predict cell voltage at a new temperature.\n\nThe fundamental equation governing the cell voltage $V$ as a function of current density $j$ and temperature $T$ is given by:\n$$V(j,T) = E_{\\mathrm{rev}}(T) - \\eta_{\\mathrm{act}}(j,T) - \\eta_{\\mathrm{ohm}}(j,T)$$\nwhere the components are:\n- Reversible voltage: $E_{\\mathrm{rev}}(T) = E_0 - \\gamma \\left(T - T_0\\right)$\n- Activation overpotential: $\\eta_{\\mathrm{act}}(j,T) = \\frac{R T}{\\alpha F} \\ln\\left(\\frac{j}{j_0(T)}\\right)$\n- Ohmic overpotential: $\\eta_{\\mathrm{ohm}}(j,T) = j \\frac{L_{\\mathrm{mem}}}{\\sigma(T)}$\n\nThe parameters to be determined are the exchange current density $j_0(T)$ and the membrane conductivity $\\sigma(T)$.\n\n**Step 1: Parameter Estimation via Linearization and Least Squares**\n\nFor a fixed temperature $T$, the parameters $j_0(T)$ and $\\sigma(T)$ are constant. The voltage equation can be rearranged to isolate the known and unknown terms, facilitating a linear regression.\nStarting with the voltage equation:\n$$V(j,T) = E_{\\mathrm{rev}}(T) - \\frac{R T}{\\alpha F} \\ln\\left(\\frac{j}{j_0(T)}\\right) - j \\frac{L_{\\mathrm{mem}}}{\\sigma(T)}$$\nWe can expand the logarithmic term:\n$$V(j,T) = E_{\\mathrm{rev}}(T) - \\frac{R T}{\\alpha F} \\ln(j) + \\frac{R T}{\\alpha F} \\ln(j_0(T)) - j \\frac{L_{\\mathrm{mem}}}{\\sigma(T)}$$\nRearranging the terms to group known quantities on one side yields a linear relationship:\n$$E_{\\mathrm{rev}}(T) - V(j,T) - \\frac{R T}{\\alpha F}\\ln(j) = \\left[-\\frac{R T}{\\alpha F}\\ln(j_0(T))\\right] \\cdot 1 + \\left[\\frac{L_{\\mathrm{mem}}}{\\sigma(T)}\\right] \\cdot j$$\nThis equation is in the form of a simple linear model, $Y = \\beta_1 + \\beta_2 x$, where:\n- The dependent variable is $Y(j,T) = E_{\\mathrm{rev}}(T) - V(j,T) - \\frac{R T}{\\alpha F}\\ln(j)$.\n- The independent variable is $x = j$.\n- The coefficients to be determined are $\\beta_1(T) = -\\frac{R T}{\\alpha F}\\ln(j_0(T))$ and $\\beta_2(T) = \\frac{L_{\\mathrm{mem}}}{\\sigma(T)}$.\n\nFor each temperature, $T_1 = 333.15\\,\\mathrm{K}$ and $T_2 = 343.15\\,\\mathrm{K}$, we are given three data points $(j_i, V_i)$. This forms an overdetermined system of linear equations for the two unknown coefficients $(\\beta_1, \\beta_2)$. We can write this system in matrix form as $\\mathbf{Y} = \\mathbf{X}\\boldsymbol{\\beta}$, where:\n$$\\mathbf{Y} = \\begin{pmatrix} Y(j_1, T) \\\\ Y(j_2, T) \\\\ Y(j_3, T) \\end{pmatrix}, \\quad \\mathbf{X} = \\begin{pmatrix} 1  j_1 \\\\ 1  j_2 \\\\ 1  j_3 \\end{pmatrix}, \\quad \\boldsymbol{\\beta} = \\begin{pmatrix} \\beta_1 \\\\ \\beta_2 \\end{pmatrix}$$\nThe solution that minimizes the sum of squared errors, $\\|\\mathbf{Y} - \\mathbf{X}\\boldsymbol{\\beta}\\|^2$, is found using the method of least squares. The resulting coefficients $\\hat{\\beta}_1$ and $\\hat{\\beta}_2$ are then used to recover the physical parameters $j_0(T)$ and $\\sigma(T)$:\nFrom $\\hat{\\beta}_1 = -\\frac{R T}{\\alpha F}\\ln(j_0(T))$, we solve for $j_0(T)$:\n$$j_0(T) = \\exp\\left(-\\frac{\\hat{\\beta}_1 \\alpha F}{R T}\\right)$$\nFrom $\\hat{\\beta}_2 = \\frac{L_{\\mathrm{mem}}}{\\sigma(T)}$, we solve for $\\sigma(T)$:\n$$\\sigma(T) = \\frac{L_{\\mathrm{mem}}}{\\hat{\\beta}_2}$$\nThis procedure is applied to the datasets for $T_1$ and $T_2$ to find $(j_0(T_1), \\sigma(T_1))$ and $(j_0(T_2), \\sigma(T_2))$.\n\n**Step 2: Determination of Arrhenius Parameters**\n\nThe temperature dependence of $j_0(T)$ and $\\sigma(T)$ is described by the Arrhenius equation. For a generic parameter $P(T)$, the relationship is:\n$$P(T) = A \\exp\\left(-\\frac{E_a}{R T}\\right)$$\nTaking the natural logarithm of both sides linearizes the equation with respect to $1/T$:\n$$\\ln P(T) = \\ln A - \\frac{E_a}{R}\\frac{1}{T}$$\nHaving determined $P(T)$ at two distinct temperatures, $T_1$ and $T_2$, we have a system of two linear equations with two unknowns, $\\ln A$ and $E_a/R$:\n\\begin{align*} \\ln P(T_1) = \\ln A - \\frac{E_a}{R}\\frac{1}{T_1} \\\\ \\ln P(T_2) = \\ln A - \\frac{E_a}{R}\\frac{1}{T_2} \\end{align*}\nSubtracting the second equation from the first yields an expression for the activation energy, $E_a$:\n$$\\ln P(T_1) - \\ln P(T_2) = \\frac{E_a}{R}\\left(\\frac{1}{T_2} - \\frac{1}{T_1}\\right) \\implies E_a = R \\frac{\\ln(P(T_1)/P(T_2))}{1/T_2 - 1/T_1}$$\nOnce $E_a$ is determined, the pre-exponential factor $A$ can be found by substituting $E_a$ back into one of the equations:\n$$\\ln A = \\ln P(T_1) + \\frac{E_a}{R T_1} \\implies A = P(T_1) \\exp\\left(\\frac{E_a}{R T_1}\\right)$$\nThis procedure is applied to the pairs $(T_1, j_0(T_1))$ and $(T_2, j_0(T_2))$ to find $(A_{j_0}, E_{a,\\mathrm{act}})$, and to the pairs $(T_1, \\sigma(T_1))$ and $(T_2, \\sigma(T_2))$ to find $(A_{\\sigma}, E_{a,\\mathrm{ohm}})$.\n\n**Step 3: Predictive Calculation**\n\nWith the four Arrhenius parameters $(A_{j_0}, E_{a,\\mathrm{act}}, A_{\\sigma}, E_{a,\\mathrm{ohm}})$ fully determined, the model is complete. We can now predict the voltage for any current density $j$ and temperature $T$ within the model's validity range.\nThe task is to predict the voltage at $T_3 = 353.15\\,\\mathrm{K}$ for a given set of current densities.\nFirst, we calculate the values of $j_0$ and $\\sigma$ at $T_3$:\n$$j_0(T_3) = A_{j_0} \\exp\\left(-\\frac{E_{a,\\mathrm{act}}}{R T_3}\\right)$$\n$$\\sigma(T_3) = A_{\\sigma} \\exp\\left(-\\frac{E_{a,\\mathrm{ohm}}}{R T_3}\\right)$$\nWe also compute the reversible potential at this temperature:\n$$E_{\\mathrm{rev}}(T_3) = E_0 - \\gamma (T_3 - T_0)$$\nFinally, for each specified current density $j$ in the test suite, the voltage $V(j, T_3)$ is calculated using the full model equation:\n$$V(j,T_3) = E_{\\mathrm{rev}}(T_3) - \\frac{R T_3}{\\alpha F}\\ln\\left(\\frac{j}{j_0(T_3)}\\right) - j \\frac{L_{\\mathrm{mem}}}{\\sigma(T_3)}$$\nThe resulting voltages are then rounded to four decimal places as required for the final output. This systematic approach ensures that the model parameters are rigorously derived from the provided data and then used consistently for prediction.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the PEM fuel cell modeling problem by performing a three-step\n    parameter estimation and prediction process.\n    \"\"\"\n    \n    # --- Constants ---\n    E0 = 1.229  # V\n    GAMMA = 8.5e-4  # V/K\n    T0 = 298.15  # K\n    R = 8.314462618  # J/(mol*K)\n    F = 96485.33212  # C/mol\n    ALPHA = 0.5\n    L_MEM = 2.0e-5  # m\n\n    # --- Experimental Data ---\n    # T1 = 60 C = 333.15 K\n    T1 = 333.15\n    data1 = {\n        'j': np.array([500.0, 2000.0, 5000.0]),  # A/m^2\n        'V': np.array([0.7890, 0.7056, 0.6455])  # V\n    }\n\n    # T2 = 70 C = 343.15 K\n    T2 = 343.15\n    data2 = {\n        'j': np.array([500.0, 2000.0, 5000.0]),\n        'V': np.array([0.8011, 0.7173, 0.6563])\n    }\n\n    def get_params_at_temp(T, j_data, v_data):\n        \"\"\"\n        Step 1: Perform least-squares fitting to find j0(T) and sigma(T).\n        Linear model: Y = beta1 + beta2 * j\n        \"\"\"\n        E_rev = E0 - GAMMA * (T - T0)\n        \n        # Construct the dependent variable vector Y\n        Y = E_rev - v_data - (R * T / (ALPHA * F)) * np.log(j_data)\n        \n        # Construct the design matrix X\n        X = np.vstack([np.ones_like(j_data), j_data]).T\n        \n        # Perform linear least-squares regression\n        beta, _, _, _ = np.linalg.lstsq(X, Y, rcond=None)\n        beta1, beta2 = beta[0], beta[1]\n        \n        # Recover physical parameters j0 and sigma from beta coefficients\n        # beta1 = -(R*T / (ALPHA*F)) * ln(j0)\n        j0 = np.exp(-beta1 * ALPHA * F / (R * T))\n        \n        # beta2 = L_mem / sigma\n        sigma = L_MEM / beta2\n        \n        return j0, sigma\n\n    def get_arrhenius_params(T1, p1, T2, p2):\n        \"\"\"\n        Step 2: Calculate Arrhenius parameters (A, Ea) from two data points.\n        Model: ln(P) = ln(A) - (Ea/R) * (1/T)\n        \"\"\"\n        log_p1 = np.log(p1)\n        log_p2 = np.log(p2)\n        \n        # Solve the 2x2 system for Ea and A\n        # Ea/R = (ln(p1) - ln(p2)) / (1/T2 - 1/T1)\n        Ea_over_R = (log_p1 - log_p2) / (1/T2 - 1/T1)\n        Ea = Ea_over_R * R\n        \n        # ln(A) = ln(p1) + (Ea/R) * (1/T1)\n        log_A = log_p1 + Ea_over_R * (1/T1)\n        A = np.exp(log_A)\n        \n        return A, Ea\n\n    # --- Step 1 Executions ---\n    j0_T1, sigma_T1 = get_params_at_temp(T1, data1['j'], data1['V'])\n    j0_T2, sigma_T2 = get_params_at_temp(T2, data2['j'], data2['V'])\n\n    # --- Step 2 Executions ---\n    A_j0, E_a_act = get_arrhenius_params(T1, j0_T1, T2, j0_T2)\n    A_sigma, E_a_ohm = get_arrhenius_params(T1, sigma_T1, T2, sigma_T2)\n\n    # --- Step 3: Prediction ---\n    T3 = 353.15  # 80 C\n    j_test_suite = np.array([50.0, 500.0, 2000.0, 5000.0, 10000.0])\n    \n    # Calculate parameters at T3 using Arrhenius model\n    j0_T3 = A_j0 * np.exp(-E_a_act / (R * T3))\n    sigma_T3 = A_sigma * np.exp(-E_a_ohm / (R * T3))\n    E_rev_T3 = E0 - GAMMA * (T3 - T0)\n    \n    # Calculate voltages for the test suite\n    eta_act_T3 = (R * T3 / (ALPHA * F)) * np.log(j_test_suite / j0_T3)\n    eta_ohm_T3 = j_test_suite * L_MEM / sigma_T3\n    \n    V_predicted = E_rev_T3 - eta_act_T3 - eta_ohm_T3\n    \n    # Format results for output\n    formatted_results = [f\"{v:.4f}\" for v in V_predicted]\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}