{
    "hands_on_practices": [
        {
            "introduction": "确定资产经济性的盈亏平衡点是退役决策中最基本的步骤。本练习模拟了当一项资产的运营成本超过其收入时的“盈亏平衡”年龄。通过结合利润下降、与年龄相关的运维成本增加以及灾难性故障风险，您将学习到为资产的运营可行性建立模型的 foundational 技能。这个练习的核心是量化运营利润与老化成本之间的权衡 。",
            "id": "4069721",
            "problem": "考虑一个单机组热力发电机，其铭牌功率为 $P$（单位：兆瓦），以恒定的容量因子 $\\mathrm{CF}$（无量纲）进行调度，其生产的电力以恒定价格 $p$（单位：美元/兆瓦时）出售。设不包括与役龄相关的运营和维护（O&M）成本的可变成本为 $c_{\\mathrm{var}}$（单位：美元/兆瓦时）。将计入与役龄相关的成本之前的单位能源毛运营利润定义为 $m_{0} \\equiv p - c_{\\mathrm{var}}$（单位：美元/兆瓦时）。假设资产役龄为 $a$（单位：年）时，单位能源的与役龄相关的O&M成本为 $c_{\\mathrm{O}}(a) = c_{0} + \\alpha a$（单位：美元/兆瓦时），其中 $c_{0} \\ge 0$ 和 $\\alpha \\ge 0$ 是常数。该资产会发生灾难性故障，其风险由一个Weibull风险函数建模，形状参数为 $\\beta > 0$，尺度参数为 $\\eta > 0$，因此在役龄为 $a$ 时的瞬时风险为 $h(a) = \\frac{\\beta}{\\eta^{\\beta}} a^{\\beta - 1}$（单位：年$^{-1}$）。每次灾难性故障都会带来一次性总经济后果 $C_{f}$（单位：美元），其中包括维修和短缺成本。假设故障足够罕见，以至于在役龄为 $a$ 时的预期故障成本率可以近似为 $C_{f} h(a)$（单位：美元/年）。在长度为 $T$（单位：小时）的时间间隔内，预期发电量为 $E = P \\cdot \\mathrm{CF} \\cdot T$（单位：兆瓦时）。将盈亏平衡退役役龄 $a^{\\star}$ 视为单位能源的瞬时预期净运营盈余（计入与役龄相关的成本之前的毛利润减去单位能源的预期与役龄相关的成本）为非正时的最小役龄。\n\n仅使用这些定义以及风险函数和容量因子的标准属性，为以下参数值确定 $a^{\\star}$：\n- $P = 500$ 兆瓦，\n- $\\mathrm{CF} = 0.70$，\n- $p = 55$ 美元/兆瓦时，\n- $c_{\\mathrm{var}} = 32$ 美元/兆瓦时，因此 $m_{0} = p - c_{\\mathrm{var}}$，\n- $c_{0} = 3.5$ 美元/兆瓦时，\n- $\\alpha = 0.40$ 美元/兆瓦时/年，\n- $\\beta = 2$ 且 $\\eta = 30$ 年（因此 $h(a) = \\frac{\\beta}{\\eta^{\\beta}} a^{\\beta - 1}$），\n- $C_{f} = 5.0 \\times 10^{7}$ 美元。\n\n将您的最终答案表示为盈亏平衡役龄 $a^{\\star}$（单位：年），四舍五入到四位有效数字。在最终答案中仅陈述数值。",
            "solution": "该问题要求计算热力发电机的盈亏平衡退役役龄 $a^{\\star}$。该役龄被定义为单位能源的瞬时预期净运营盈余为非正时的最小役龄。我们必须首先为这个盈余建立一个表达式。\n\n在役龄为 $a$ 时，单位能源的瞬时预期净运营盈余（记为 $S(a)$）是单位能源的毛运营利润减去所有单位能源的预期与役龄相关的成本。\n\n单位能源的毛运营利润 $m_0$ 由电价 $p$ 和可变成本 $c_{\\mathrm{var}}$ 之差给出：\n$$m_0 = p - c_{\\mathrm{var}}$$\n\n与役龄相关的成本由两部分组成：与役龄相关的运营和维护（O&M）成本 $c_{\\mathrm{O}}(a)$，以及灾难性故障的预期成本，我们将其记为 $c_{\\mathrm{fail}}(a)$。两者都必须以美元/兆瓦时表示。\n\n单位能源的与役龄相关的O&M成本直接由以下线性函数给出：\n$$c_{\\mathrm{O}}(a) = c_{0} + \\alpha a$$\n其中 $a$ 是以年为单位的役龄，$c_0$ 是基础成本，$\\alpha$ 是成本增长率。\n\n单位能源的灾难性故障预期成本 $c_{\\mathrm{fail}}(a)$ 必须推导得出。问题陈述，役龄为 $a$ 时的预期故障成本率为 $C_f h(a)$，其中 $C_f$ 是单次故障的一次性总成本，而 $h(a)$ 是瞬时风险率。该率的单位是美元/年。要将其转换为单位能源成本（美元/兆瓦时），我们必须用它除以年发电量。\n\n年发电量 $E_{\\mathrm{yr}}$ 是铭牌功率 $P$、容量因子 $\\mathrm{CF}$ 和一年中的小时数 $H_{\\mathrm{yr}}$ 的乘积。我们使用 $H_{\\mathrm{yr}} = 24 \\frac{\\text{小时}}{\\text{天}} \\times 365.25 \\frac{\\text{天}}{\\text{年}} = 8766 \\frac{\\text{小时}}{\\text{年}}$。\n$$E_{\\mathrm{yr}} = P \\cdot \\mathrm{CF} \\cdot H_{\\mathrm{yr}}$$\n$E_{\\mathrm{yr}}$ 的单位是兆瓦时/年。\n\n因此，单位能源的预期故障成本为：\n$$c_{\\mathrm{fail}}(a) = \\frac{C_f h(a)}{E_{\\mathrm{yr}}} = \\frac{C_f h(a)}{P \\cdot \\mathrm{CF} \\cdot H_{\\mathrm{yr}}}$$\n风险函数由Weibull分布给出：\n$$h(a) = \\frac{\\beta}{\\eta^{\\beta}} a^{\\beta - 1}$$\n将此代入 $c_{\\mathrm{fail}}(a)$ 的表达式中：\n$$c_{\\mathrm{fail}}(a) = \\frac{C_f}{P \\cdot \\mathrm{CF} \\cdot H_{\\mathrm{yr}}} \\left( \\frac{\\beta}{\\eta^{\\beta}} a^{\\beta - 1} \\right)$$\n\n现在，我们可以写出单位能源净运营盈余 $S(a)$ 的完整表达式：\n$$S(a) = m_0 - \\left( c_{\\mathrm{O}}(a) + c_{\\mathrm{fail}}(a) \\right)$$\n$$S(a) = (p - c_{\\mathrm{var}}) - \\left( (c_0 + \\alpha a) + \\frac{C_f \\beta}{P \\cdot \\mathrm{CF} \\cdot H_{\\mathrm{yr}} \\cdot \\eta^{\\beta}} a^{\\beta - 1} \\right)$$\n\n盈亏平衡退役役龄 $a^{\\star}$ 是使 $S(a) \\le 0$ 成立的最小役龄 $a$。我们通过求解 $S(a^{\\star}) = 0$ 来找到该值。\n$$(p - c_{\\mathrm{var}}) - c_0 - \\alpha a^{\\star} - \\frac{C_f \\beta}{P \\cdot \\mathrm{CF} \\cdot H_{\\mathrm{yr}} \\cdot \\eta^{\\beta}} (a^{\\star})^{\\beta - 1} = 0$$\n让我们代入给定的参数值：\n- $P = 500$ 兆瓦\n- $\\mathrm{CF} = 0.70$\n- $p = 55$ 美元/兆瓦时\n- $c_{\\mathrm{var}} = 32$ 美元/兆瓦时\n- $m_0 = p - c_{\\mathrm{var}} = 55 - 32 = 23$ 美元/兆瓦时\n- $c_{0} = 3.5$ 美元/兆瓦时\n- $\\alpha = 0.40$ 美元/兆瓦时/年\n- $\\beta = 2$\n- $\\eta = 30$ 年\n- $C_{f} = 5.0 \\times 10^{7}$ 美元\n- $H_{\\mathrm{yr}} = 8766$ 小时/年\n\n当 $\\beta=2$ 时，方程大大简化。项 $(a^{\\star})^{\\beta-1}$ 变为 $(a^{\\star})^{2-1} = a^{\\star}$。\n方程变为关于 $a^{\\star}$ 的线性方程：\n$$m_0 - c_0 - \\alpha a^{\\star} - \\frac{2 C_f}{P \\cdot \\mathrm{CF} \\cdot H_{\\mathrm{yr}} \\cdot \\eta^2} a^{\\star} = 0$$\n我们可以重新整理此方程以求解 $a^{\\star}$：\n$$m_0 - c_0 = \\alpha a^{\\star} + \\frac{2 C_f}{P \\cdot \\mathrm{CF} \\cdot H_{\\mathrm{yr}} \\cdot \\eta^2} a^{\\star}$$\n$$m_0 - c_0 = \\left( \\alpha + \\frac{2 C_f}{P \\cdot \\mathrm{CF} \\cdot H_{\\mathrm{yr}} \\cdot \\eta^2} \\right) a^{\\star}$$\n$$a^{\\star} = \\frac{m_0 - c_0}{\\alpha + \\frac{2 C_f}{P \\cdot \\mathrm{CF} \\cdot H_{\\mathrm{yr}} \\cdot \\eta^2}}$$\n\n现在，我们将数值代入此表达式。\n分子是：\n$m_0 - c_0 = 23 - 3.5 = 19.5$\n\n分母有两部分。第一部分是 $\\alpha = 0.40$。第二部分是故障成本项：\n$$\\frac{2 C_f}{P \\cdot \\mathrm{CF} \\cdot H_{\\mathrm{yr}} \\cdot \\eta^2} = \\frac{2 \\cdot (5.0 \\times 10^7)}{500 \\cdot 0.70 \\cdot 8766 \\cdot 30^2}$$\n$$ = \\frac{1.0 \\times 10^8}{350 \\cdot 8766 \\cdot 900}$$\n$$ = \\frac{1.0 \\times 10^8}{3068100 \\cdot 900}$$\n$$ = \\frac{1.0 \\times 10^8}{2761290000} \\approx 0.036215305$$\n分母是：\n$$0.40 + 0.036215305 = 0.436215305$$\n\n最后，我们计算 $a^{\\star}$：\n$$a^{\\star} = \\frac{19.5}{0.436215305} \\approx 44.70275$$\n问题要求答案四舍五入到四位有效数字。\n$$a^{\\star} \\approx 44.70$$\n退役役龄 $a^{\\star}$ 约为 $44.70$ 年。对于给定的参数，盈余函数 $S(a)$ 在 $a=0$ 时为正，并且对于 $a \\ge 0$ 是一个严格递减的函数，因此该解是唯一的。",
            "answer": "$$\\boxed{44.70}$$"
        },
        {
            "introduction": "现实世界中的退役决策很少是在完全了解未来的情况下做出的。本练习通过量化在做出不可逆决策（如关闭发电厂）之前等待更多信息的价值，介绍了“实物期权”的概念。您将学习在政策不确定性（例如碳税）下应用决策分析和贴现现金流技术，这是在当今不断变化的能源格局中一项至关重要的技能 。",
            "id": "4069732",
            "problem": "一家电力公司拥有一座燃煤发电厂，其剩余技术寿命为 $T = 20$ 年。如果在没有任何碳定价的情况下运营，该电厂每年产生恒定的年末净运营现金流，为 $C = 120$ 百万美元（USD）。该电厂每年排放 $e = 5$ 百万公吨的二氧化碳（tCO$_2$）。存在政策风险：在第一年年底（$t=1$），监管机构将宣布是否从第 $t=2$ 年开始及其后实施税率为每吨二氧化碳 $\\tau = 30$ 美元的碳税。该公告宣布征收碳税的概率为 $p = 0.4$，如果届时未宣布征收，则以后任何时候都不会再征收。该电厂可以在今年年底（$t=0$）立即退役，以获得 $S_0 = 400$ 百万美元的残值。如果现在不退役，该电厂可以在明年年底（$t=1$），即公告发布后退役，以获得 $S_1 = 380$ 百万美元的残值。所有残值和现金流均为年末金额。适用于该项目的风险调整后贴现率为每年 $r = 0.08$，且为常数。\n\n假设该公司是风险中性的，并以最大化期望净现值（NPV）为目标。如果征收碳税，税后的净运营现金流为 $C_{\\text{tax}} = C - e \\tau$。如果从 $t=2$ 年起继续运营将产生负的期望净现值，则公司将在 $t=1$ 时立即将电厂退役。如果不征收碳税，该电厂将继续运营直至其技术寿命结束（即运营至第 $t=T$ 年）。\n\n仅使用折现现金流、条件期望和不可逆退役下的最优停止等基本定义，推导并计算等待退役的价值（期权价值），该价值定义为：等待一年以了解税收结果的最优时机退役决策的期望净现值，与在 $t=0$ 时立即退役的净现值之间的差额。将您的最终答案四舍五入到四位有效数字，并以百万美元（USD million）为单位表示。",
            "solution": "该问题要求计算等待退役的价值，即“等待”策略的期望净现值（$E[\\text{NPV}_{\\text{wait}}]$）与“立即退役”策略的净现值（$\\text{NPV}_{\\text{now}}$）之间的差额。\n\n**1. 立即退役的净现值**\n\n如果公司在 $t=0$ 时立即退役，它将获得残值 $S_0$。此决策的净现值为：\n$$\\text{NPV}_{\\text{now}} = S_0 = 400 \\text{ 百万美元}$$\n\n**2. “等待”策略的期望净现值**\n\n如果公司选择等待，它将运营电厂一年，在 $t=1$ 时获得运营现金流 $C$。在 $t=1$ 时，关于碳税的不确定性得到解决，公司将根据结果做出新的最优决策。在 $t=0$ 计算的该策略的期望净现值，是 $t=1$ 时所有未来期望现金流的折现值。\n\n$$E[\\text{NPV}_{\\text{wait}}] = \\frac{C + E[V_1]}{1+r}$$\n其中 $E[V_1]$ 是在 $t=1$ 时电厂的期望价值。该期望值取决于两种可能的状态：征收碳税（概率 $p$）和不征收碳税（概率 $1-p$）。\n$$E[V_1] = p \\cdot V_{1, \\text{tax}} + (1-p) \\cdot V_{1, \\text{no tax}}$$\n\n**情况 A：征收碳税（概率 $p=0.4$）**\n如果征收碳税，从 $t=2$ 开始的年度净现金流为：\n$$C_{\\text{tax}} = C - e \\tau = 120 - (5 \\times 30) = -30 \\text{ 百万美元}$$\n由于未来现金流为负，继续运营的净现值为负。因此，在 $t=1$ 时，公司的最优决策是退役并获得残值 $S_1$。\n$$V_{1, \\text{tax}} = S_1 = 380 \\text{ 百万美元}$$\n\n**情况 B：不征收碳税（概率 $1-p=0.6$）**\n如果不征收碳税，公司将从 $t=2$ 到 $t=20$（共19年）继续运营，每年获得现金流 $C=120$。在 $t=1$ 时，继续运营的价值是这些现金流的净现值：\n$$\\text{NPV}(\\text{operate}|\\text{no tax})_{t=1} = \\sum_{k=2}^{20} \\frac{C}{(1+r)^{k-1}} = \\frac{C}{r} \\left[ 1 - \\frac{1}{(1+r)^{19}} \\right]$$\n$$\\text{NPV}(\\text{operate}|\\text{no tax})_{t=1} = \\frac{120}{0.08} \\left[ 1 - \\frac{1}{(1.08)^{19}} \\right] \\approx 1500 \\times (1 - 0.23171) \\approx 1152.43 \\text{ 百万美元}$$\n在 $t=1$ 时，公司在继续运营（价值 1152.43 百万美元）和退役（价值 $S_1 = 380$ 百万美元）之间进行选择。最优选择是继续运营。\n$$V_{1, \\text{no tax}} = 1152.43 \\text{ 百万美元}$$\n\n**计算 $E[\\text{NPV}_{\\text{wait}}]$**\n现在我们可以计算在 $t=1$ 时的期望价值 $E[V_1]$：\n$$E[V_1] = (0.4 \\times 380) + (0.6 \\times 1152.43) = 152 + 691.46 = 843.46 \\text{ 百万美元}$$\n将此值代入 $E[\\text{NPV}_{\\text{wait}}]$ 的公式中：\n$$E[\\text{NPV}_{\\text{wait}}] = \\frac{120 + 843.46}{1.08} = \\frac{963.46}{1.08} \\approx 892.09 \\text{ 百万美元}$$\n\n**3. 计算等待的价值（期权价值）**\n最后，等待的价值是两种策略的净现值之差：\n$$\\text{等待的价值} = E[\\text{NPV}_{\\text{wait}}] - \\text{NPV}_{\\text{now}}$$\n$$\\text{等待的价值} = 892.09 - 400 = 492.09 \\text{ 百万美元}$$\n四舍五入到四位有效数字，结果为 492.1 百万美元。",
            "answer": "$$\\boxed{492.1}$$"
        },
        {
            "introduction": "在掌握了单个资产的决策逻辑后，我们将视角提升到整个系统的整体规划。本练习要求您构建并求解一个线性规划模型，以协同优化新技术投资和旧技术退役，从而以最低成本满足未来需求。它将所有关键概念——资本成本、运营成本、退役决策和政策限制——整合到一个用于制定长期能源战略的综合框架中 。",
            "id": "4069793",
            "problem": "考虑一个电力系统的多周期容量扩张与退役规划问题，该系统拥有多种发电技术。规划者必须决定投资和退役计划，以满足外生给定的需求，同时最小化总贴现系统成本。系统规划期有 $T$ 个离散时期，索引为 $t \\in \\{1,2,\\dots,T\\}$，技术索引为 $k \\in \\{1,2,\\dots,K\\}$。必须使用以下基本建模基础：\n\n- 能源平衡：对于每个时期 $t$，总发电量必须等于需求，即 $\\sum_{k} G_{t,k} = D_t$，其中 $G_{t,k}$ 是时期 $t$ 技术 $k$ 的发电量，$D_t$ 是时期 $t$ 的需求。\n- 物理容量限制：发电量受可用容量和容量因子的限制，即 $G_{t,k} \\leq H \\cdot \\text{CF}_k \\cdot \\left(R_{t,k}^{\\text{old}} + N_{t,k}^{\\text{new}}\\right)$，其中 $H$ 是每个时期的小时数，$\\text{CF}_k$ 是技术 $k$ 的容量因子，$R_{t,k}^{\\text{old}}$ 是时期 $t$ 技术 $k$ 的在役剩余旧容量，$N_{t,k}^{\\text{new}}$ 是时期 $t$ 技术 $k$ 的在役新容量。\n- 资本存量演变与退役：旧容量演变遵循 $R_{t,k}^{\\text{old}} + V_{t,k}^{\\text{ret}} = R_{t-1,k}^{\\text{old}} - M_{t,k}$（对于 $t \\geq 2$）和 $R_{1,k}^{\\text{old}} + V_{1,k}^{\\text{ret}} = R_{0,k}^{\\text{old}} - M_{1,k}$（对于 $t=1$），其中 $V_{t,k}^{\\text{ret}} \\geq 0$ 是时期 $t$ 旧容量的自愿退役量，$M_{t,k} \\geq 0$ 是时期 $t$ 旧容量的外生强制退役量。初始旧容量 $R_{0,k}^{\\text{old}}$ 是给定的。在役新容量是先前投资的累计和，有一期的建设延迟，即 $N_{t,k}^{\\text{new}} = \\sum_{s=1}^{t-1} I_{s,k}$（对于 $t \\geq 2$）和 $N_{1,k}^{\\text{new}} = 0$（对于 $t=1$），其中 $I_{t,k} \\geq 0$ 是时期 $t$ 对技术 $k$ 新容量的投资。\n- 成本核算与贴现：目标是最小化总净现值（NPV），定义为所有时期所有成本的现值。各时期成本包括：燃料成本、每兆瓦时的可变运维（O&M）成本、每兆瓦时的碳成本（通过排放强度和碳价计算）、每兆瓦在役容量的固定运维（O&M）成本以及新容量的资本成本。贴现因子 $d_t = \\frac{1}{(1+r)^t}$（贴现率为 $r$）适用于时期 $t$ 的支出。\n\n决策变量为 $G_{t,k} \\geq 0$、$I_{t,k} \\geq 0$、$V_{t,k}^{\\text{ret}} \\geq 0$、$R_{t,k}^{\\text{old}} \\geq 0$ 和 $N_{t,k}^{\\text{new}} \\geq 0$。参数包括 $D_t$（单位：兆瓦时）、$H$（单位：小时）、$\\text{CF}_k$、燃料成本 $c_k^{\\text{fuel}}$（单位：美元/兆瓦时）、可变运维成本 $c_k^{\\text{vom}}$（单位：美元/兆瓦时）、排放强度 $e_k$（单位：公吨二氧化碳/兆瓦时）、碳价 $p_t^{\\text{CO2}}$（单位：美元/公吨二氧化碳）、固定运维成本 $c_k^{\\text{fom}}$（单位：美元/兆瓦/时期）、资本成本 $C_k^{\\text{capex}}$（单位：美元/兆瓦）、强制退役量 $M_{t,k}$（单位：兆瓦）、初始旧容量 $R_{0,k}^{\\text{old}}$（单位：兆瓦）和贴现率 $r$（小数）。所有物理变量必须以其指定单位表示。目标函数是：\n$$\n\\min \\sum_{t=1}^{T} d_t \\left[ \\sum_{k=1}^{K} \\left( \\left(c_k^{\\text{fuel}} + c_k^{\\text{vom}} + p_t^{\\text{CO2}} \\cdot e_k \\right) G_{t,k} + c_k^{\\text{fom}} \\left(R_{t,k}^{\\text{old}} + N_{t,k}^{\\text{new}}\\right) \\right) \\right] + \\sum_{t=1}^{T} d_t \\sum_{k=1}^{K} C_k^{\\text{capex}} I_{t,k}.\n$$\n\n您的任务是使用任何现代编程语言实现一个程序，根据下面提供的约束和参数构建并求解这个线性优化模型。程序必须计算最优总贴现成本（单位：美元，USD），并为每个测试用例输出以百万美元为单位的结果，四舍五入到两位小数。不涉及角度，因此不需要角度单位。\n\n测试套件：\n- 测试用例1（均衡增长，中等碳价）：\n    - $T = 4$，$K = 2$，技术：煤电（$k=1$）、风电（$k=2$）。\n    - $H = 8760$ 小时。\n    - 需求 $D_t$（兆瓦时）：$[6{,}000{,}000, 6{,}400{,}000, 6{,}800{,}000, 7{,}200{,}000]$。\n    - 容量因子 $\\text{CF}_k$：煤电 $0.85$，风电 $0.35$。\n    - 初始旧容量 $R_{0,k}^{\\text{old}}$（兆瓦）：煤电 $1000$，风电 $200$。\n    - 强制退役量 $M_{t,k}$（兆瓦）：煤电 $[0, 100, 200, 0]$，风电 $[0, 0, 0, 0]$。\n    - 燃料成本 $c_k^{\\text{fuel}}$（美元/兆瓦时）：煤电 $20$，风电 $0$。\n    - 可变运维成本 $c_k^{\\text{vom}}$（美元/兆瓦时）：煤电 $3$，风电 $8$。\n    - 排放强度 $e_k$（公吨二氧化碳/兆瓦时）：煤电 $0.9$，风电 $0.0$。\n    - 碳价 $p_t^{\\text{CO2}}$（美元/公吨二氧化碳）：$[30, 40, 50, 60]$。\n    - 固定运维成本 $c_k^{\\text{fom}}$（美元/兆瓦/时期）：煤电 $40{,}000$，风电 $30{,}000$。\n    - 资本成本 $C_k^{\\text{capex}}$（美元/兆瓦）：煤电 $1{,}300{,}000$，风电 $1{,}600{,}000$。\n    - 贴现率 $r = 0.07$。\n- 测试用例2（高碳价，急剧退役）：\n    - $T = 4$，$K = 2$，技术：煤电（$k=1$）、风电（$k=2$）。\n    - $H = 8760$ 小时。\n    - 需求 $D_t$（兆瓦时）：$[5{,}000{,}000, 5{,}200{,}000, 5{,}400{,}000, 5{,}600{,}000]$。\n    - 容量因子 $\\text{CF}_k$：煤电 $0.85$，风电 $0.35$。\n    - 初始旧容量 $R_{0,k}^{\\text{old}}$（兆瓦）：煤电 $800$，风电 $0$。\n    - 强制退役量 $M_{t,k}$（兆瓦）：煤电 $[0, 400, 400, 0]$，风电 $[0, 0, 0, 0]$。\n    - 燃料成本 $c_k^{\\text{fuel}}$（美元/兆瓦时）：煤电 $20$，风电 $0$。\n    - 可变运维成本 $c_k^{\\text{vom}}$（美元/兆瓦时）：煤电 $3$，风电 $8$。\n    - 排放强度 $e_k$（公吨二氧化碳/兆瓦时）：煤电 $0.9$，风电 $0.0$。\n    - 碳价 $p_t^{\\text{CO2}}$（美元/公吨二氧化碳）：$[100, 120, 140, 160]$。\n    - 固定运维成本 $c_k^{\\text{fom}}$（美元/兆瓦/时期）：煤电 $40{,}000$，风电 $30{,}000$。\n    - 资本成本 $C_k^{\\text{capex}}$（美元/兆瓦）：煤电 $1{,}300{,}000$，风电 $1{,}600{,}000$。\n    - 贴现率 $r = 0.07$。\n- 测试用例3（需求下降，低碳价）：\n    - $T = 4$，$K = 2$，技术：煤电（$k=1$）、风电（$k=2$）。\n    - $H = 8760$ 小时。\n    - 需求 $D_t$（兆瓦时）：$[3{,}000{,}000, 2{,}900{,}000, 2{,}800{,}000, 2{,}700{,}000]$。\n    - 容量因子 $\\text{CF}_k$：煤电 $0.85$，风电 $0.35$。\n    - 初始旧容量 $R_{0,k}^{\\text{old}}$（兆瓦）：煤电 $500$，风电 $0$。\n    - 强制退役量 $M_{t,k}$（兆瓦）：煤电 $[0, 0, 0, 0]$，风电 $[0, 0, 0, 0]$。\n    - 燃料成本 $c_k^{\\text{fuel}}$（美元/兆瓦时）：煤电 $20$，风电 $0$。\n    - 可变运维成本 $c_k^{\\text{vom}}$（美元/兆瓦时）：煤电 $3$，风电 $8$。\n    - 排放强度 $e_k$（公吨二氧化碳/兆瓦时）：煤电 $0.9$，风电 $0.0$。\n    - 碳价 $p_t^{\\text{CO2}}$（美元/公吨二氧化碳）：$[10, 10, 10, 10]$。\n    - 固定运维成本 $c_k^{\\text{fom}}$（美元/兆瓦/时期）：煤电 $40{,}000$，风电 $30{,}000$。\n    - 资本成本 $C_k^{\\text{capex}}$（美元/兆瓦）：煤电 $1{,}300{,}000$，风电 $1{,}600{,}000$。\n    - 贴现率 $r = 0.07$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如，$\\texttt{[result1,result2,result3]}$）。每个结果必须是对应上述测试用例的最优总贴现成本，单位为百万美元（USD），四舍五入到两位小数。",
            "solution": "以下Python代码使用`scipy.optimize.linprog`库来构建和求解问题中描述的线性规划模型。代码首先定义了一个函数`solve_model`，该函数接收一个包含所有模型参数的字典，然后系统地构建成本向量`c`、等式约束矩阵`A_eq`和`b_eq`，以及不等式约束矩阵`A_ub`和`b_ub`。最后，它调用`linprog`求解器来找到最优成本。主执行部分为每个提供的测试用例运行此函数，并按要求格式化输出。\n```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve_model(params):\n    \"\"\"\n    Constructs and solves the linear programming model for capacity expansion.\n    \"\"\"\n    T = params['T']\n    K = params['K']\n    H = params['H']\n    D = params['D']\n    CF = params['CF']\n    R0_old = params['R0_old']\n    M = params['M']\n    c_fuel = params['c_fuel']\n    c_vom = params['c_vom']\n    e = params['e']\n    p_co2 = params['p_co2']\n    c_fom = params['c_fom']\n    C_capex = params['C_capex']\n    r = params['r']\n\n    # --- Variable Indexing ---\n    # Variables are ordered as [G, I, V, R, N]\n    # Within each block, variables are ordered by t, then k.\n    num_vars = 5 * T * K\n    \n    _T_K = T * K\n    offsets = {\n        'G': 0 * _T_K,\n        'I': 1 * _T_K,\n        'V': 2 * _T_K,\n        'R': 3 * _T_K,\n        'N': 4 * _T_K,\n    }\n\n    def get_var_idx(var_type, t_idx, k_idx):\n        return offsets[var_type] + t_idx * K + k_idx\n\n    # --- Objective Function (Cost Vector c) ---\n    c = np.zeros(num_vars)\n    for t_idx in range(T):\n        t = t_idx + 1\n        d_t = 1 / ((1 + r) ** t)\n        for k_idx in range(K):\n            # Variable cost component\n            var_cost_per_mwh = c_fuel[k_idx] + c_vom[k_idx] + p_co2[t_idx] * e[k_idx]\n            c[get_var_idx('G', t_idx, k_idx)] = d_t * var_cost_per_mwh\n            # Fixed O cost component\n            c[get_var_idx('R', t_idx, k_idx)] = d_t * c_fom[k_idx]\n            c[get_var_idx('N', t_idx, k_idx)] = d_t * c_fom[k_idx]\n            # Capital expenditure component\n            c[get_var_idx('I', t_idx, k_idx)] = d_t * C_capex[k_idx]\n\n    # --- Constraints ---\n    num_eq_constraints = T + T * K + T * K\n    num_ub_constraints = T * K\n    A_eq = np.zeros((num_eq_constraints, num_vars))\n    b_eq = np.zeros(num_eq_constraints)\n    A_ub = np.zeros((num_ub_constraints, num_vars))\n    b_ub = np.zeros(num_ub_constraints)\n    \n    eq_row_idx = 0\n    ub_row_idx = 0\n\n    for t_idx in range(T):\n        # 1. Energy Balance: sum(k, G_tk) = D_t\n        for k_idx in range(K):\n            A_eq[eq_row_idx, get_var_idx('G', t_idx, k_idx)] = 1\n        b_eq[eq_row_idx] = D[t_idx]\n        eq_row_idx += 1\n\n        for k_idx in range(K):\n            # 2. Capacity Limit: G_tk = H * CF_k * (R_tk + N_tk)\n            # G_tk - (H*CF_k)*R_tk - (H*CF_k)*N_tk = 0\n            A_ub[ub_row_idx, get_var_idx('G', t_idx, k_idx)] = 1\n            A_ub[ub_row_idx, get_var_idx('R', t_idx, k_idx)] = -H * CF[k_idx]\n            A_ub[ub_row_idx, get_var_idx('N', t_idx, k_idx)] = -H * CF[k_idx]\n            b_ub[ub_row_idx] = 0\n            ub_row_idx += 1\n\n            # 3. Old Capacity Evolution: R_tk + V_tk = R_{t-1,k} - M_tk\n            # R_tk + V_tk - R_{t-1,k} = -M_tk\n            A_eq[eq_row_idx, get_var_idx('R', t_idx, k_idx)] = 1\n            A_eq[eq_row_idx, get_var_idx('V', t_idx, k_idx)] = 1\n            if t_idx == 0:\n                b_eq[eq_row_idx] = R0_old[k_idx] - M[k_idx, t_idx]\n            else:\n                A_eq[eq_row_idx, get_var_idx('R', t_idx - 1, k_idx)] = -1\n                b_eq[eq_row_idx] = -M[k_idx, t_idx]\n            eq_row_idx += 1\n            \n            # 4. New Capacity Evolution: N_tk = N_{t-1,k} + I_{t-1,k}\n            # N_tk - N_{t-1,k} - I_{t-1,k} = 0\n            A_eq[eq_row_idx, get_var_idx('N', t_idx, k_idx)] = 1\n            if t_idx == 0:\n                # N_1k = 0\n                b_eq[eq_row_idx] = 0\n            else:\n                A_eq[eq_row_idx, get_var_idx('N', t_idx - 1, k_idx)] = -1\n                A_eq[eq_row_idx, get_var_idx('I', t_idx - 1, k_idx)] = -1\n                b_eq[eq_row_idx] = 0\n            eq_row_idx += 1\n\n    # --- Solve ---\n    bounds = (0, None)  # All variables are non-negative\n    res = linprog(c=c, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n\n    if not res.success:\n        raise RuntimeError(f\"Optimization failed: {res.message}\")\n\n    total_cost_millions = res.fun / 1_000_000\n    return round(total_cost_millions, 2)\n\n\ndef solve():\n    test_cases = [\n        # Test Case 1\n        {\n            \"T\": 4, \"K\": 2, \"H\": 8760,\n            \"D\": np.array([6_000_000, 6_400_000, 6_800_000, 7_200_000]),\n            \"CF\": np.array([0.85, 0.35]),\n            \"R0_old\": np.array([1000, 200]),\n            \"M\": np.array([[0, 100, 200, 0], [0, 0, 0, 0]]), # M[k_idx, t_idx]\n            \"c_fuel\": np.array([20, 0]),\n            \"c_vom\": np.array([3, 8]),\n            \"e\": np.array([0.9, 0.0]),\n            \"p_co2\": np.array([30, 40, 50, 60]),\n            \"c_fom\": np.array([40_000, 30_000]),\n            \"C_capex\": np.array([1_300_000, 1_600_000]),\n            \"r\": 0.07,\n        },\n        # Test Case 2\n        {\n            \"T\": 4, \"K\": 2, \"H\": 8760,\n            \"D\": np.array([5_000_000, 5_200_000, 5_400_000, 5_600_000]),\n            \"CF\": np.array([0.85, 0.35]),\n            \"R0_old\": np.array([800, 0]),\n            \"M\": np.array([[0, 400, 400, 0], [0, 0, 0, 0]]),\n            \"c_fuel\": np.array([20, 0]),\n            \"c_vom\": np.array([3, 8]),\n            \"e\": np.array([0.9, 0.0]),\n            \"p_co2\": np.array([100, 120, 140, 160]),\n            \"c_fom\": np.array([40_000, 30_000]),\n            \"C_capex\": np.array([1_300_000, 1_600_000]),\n            \"r\": 0.07,\n        },\n        # Test Case 3\n        {\n            \"T\": 4, \"K\": 2, \"H\": 8760,\n            \"D\": np.array([3_000_000, 2_900_000, 2_800_000, 2_700_000]),\n            \"CF\": np.array([0.85, 0.35]),\n            \"R0_old\": np.array([500, 0]),\n            \"M\": np.array([[0, 0, 0, 0], [0, 0, 0, 0]]),\n            \"c_fuel\": np.array([20, 0]),\n            \"c_vom\": np.array([3, 8]),\n            \"e\": np.array([0.9, 0.0]),\n            \"p_co2\": np.array([10, 10, 10, 10]),\n            \"c_fom\": np.array([40_000, 30_000]),\n            \"C_capex\": np.array([1_300_000, 1_600_000]),\n            \"r\": 0.07,\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_model(case)\n        results.append(result)\n\n    # This function would typically print the result. \n    # The value is returned for the answer tag.\n    return f\"[{','.join(f'{r:.2f}' for r in results)}]\"\n\n# The final answer is generated by running the code.\n# print(solve())\n```",
            "answer": "[1050.59,1016.94,260.67]"
        }
    ]
}