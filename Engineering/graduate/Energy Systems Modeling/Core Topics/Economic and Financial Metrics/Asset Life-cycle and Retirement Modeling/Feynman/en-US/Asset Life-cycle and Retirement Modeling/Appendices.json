{
    "hands_on_practices": [
        {
            "introduction": "When a large energy asset is retired before the end of its planned financial life, regulators and investors need a clear method to calculate the financial impact. This exercise focuses on the concept of \"stranded cost,\" a critical metric in regulated industries. By working through this problem, you will apply the fundamental accounting and economic principles—such as straight-line depreciation, book value, and net present value—that underpin asset valuation and retirement decisions .",
            "id": "4069753",
            "problem": "An investor-owned electric utility places a baseload generating plant into service at year $0$ with an initial capitalized cost $C_0$ dollars. The plant is placed into the regulated rate base and depreciated using straight-line depreciation over a regulatory life of $n$ years, with no terminal salvage included in the depreciation schedule. At year $t$, with $0  t  n$, the utility retires the plant early due to market and policy changes, triggering a stranded cost calculation. Assume the following for scientific realism and to avoid ambiguity: $C_0  0$, $n \\in \\mathbb{N}$, $t \\in (0,n)$, $\\sigma \\in [0,1)$, $\\lambda  0$, $\\delta \\ge 0$, and $r  -1$.\n\nAt retirement, the plant yields a market salvage value that decays exponentially with calendar time: $S(t) = \\sigma C_0 \\exp(-\\lambda t)$, where $\\sigma$ is the fraction of $C_0$ salvageable at $t = 0$ and $\\lambda$ is a non-negative obsolescence parameter. Decommissioning and removal at retirement incur cash costs proportional to the initial cost, equal to $\\delta C_0$ at $t$. The utility evaluates the stranded book value as the unrecovered book value at $t$ net of salvage and net of removal costs, and then computes the Net Present Value (NPV) at year $0$ using a constant real discount rate $r$.\n\nStarting from the core definitions of straight-line depreciation and book value, and using the specified salvage and removal model, derive a closed-form analytic expression for the year-$0$ present value of the stranded book value incurred by the early retirement at year $t$. Express your final answer in dollars (USD) as a single symbolic expression in terms of $C_0$, $n$, $t$, $\\sigma$, $\\lambda$, $\\delta$, and $r$. Do not plug in numbers. No rounding is required.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- Initial capitalized cost: $C_0$\n- Service start year: $0$\n- Depreciation method: straight-line\n- Regulatory life for depreciation: $n$ years\n- Terminal salvage value for depreciation schedule: $0$\n- Early retirement year: $t$, where $0  t  n$\n- Market salvage value at year $t$: $S(t) = \\sigma C_0 \\exp(-\\lambda t)$\n- Decommissioning and removal cost at year $t$: $\\delta C_0$\n- Definition of stranded book value: unrecovered book value at $t$ net of salvage and net of removal costs.\n- Discount rate for Net Present Value (NPV) calculation at year $0$: $r$\n- Parameter constraints: $C_0  0$, $n \\in \\mathbb{N}$, $t \\in (0,n)$, $\\sigma \\in [0,1)$, $\\lambda  0$, $\\delta \\ge 0$, and $r  -1$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It is based on standard, well-established principles of engineering economics and financial accounting, specifically as applied to capital-intensive assets in the energy sector. All terms are clearly defined, and sufficient information is provided to derive a unique analytical solution. The constraints on the parameters are physically and economically sensible. The phrasing \"net of salvage and net of removal costs\" requires interpretation, but the only economically sound interpretation is that salvage value reduces the stranded amount (a cash inflow) while removal costs increase it (a cash outflow). Any other interpretation would be nonsensical. Thus, the problem is deemed valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\nThe derivation proceeds in three steps:\n1.  Calculate the book value of the asset at the time of retirement, $t$.\n2.  Calculate the total stranded cost incurred at time $t$.\n3.  Discount the stranded cost back to year $0$ to find its Net Present Value (NPV).\n\n**1. Book Value at Year $t$**\n\nThe asset is depreciated using the straight-line method over a regulatory life of $n$ years. The initial cost is $C_0$, and the problem specifies that the terminal salvage value for the depreciation schedule is zero.\n\nThe annual depreciation expense, $D$, is the depreciable base divided by the asset life:\n$$D = \\frac{C_0 - 0}{n} = \\frac{C_0}{n}$$\nAt year $t$, the total accumulated depreciation, $A(t)$, is the annual depreciation multiplied by the number of years the plant has been in service:\n$$A(t) = D \\times t = \\frac{C_0 t}{n}$$\nThe book value, $B(t)$, at any time $t$ is the initial cost minus the accumulated depreciation:\n$$B(t) = C_0 - A(t) = C_0 - \\frac{C_0 t}{n}$$\nFactoring out $C_0$, we get the expression for the book value at the time of retirement:\n$$B(t) = C_0 \\left(1 - \\frac{t}{n}\\right)$$\n\n**2. Stranded Cost at Year $t$**\n\nThe problem defines the stranded book value as the unrecovered book value at $t$ net of salvage and net of removal costs. This represents the total financial loss or cost incurred at the moment of retirement, year $t$. Let us denote this value as $SC(t)$.\n\n- The unrecovered book value is $B(t)$.\n- The market salvage value, $S(t) = \\sigma C_0 \\exp(-\\lambda t)$, is a cash inflow that reduces the loss.\n- The decommissioning and removal cost, $\\delta C_0$, is a cash outflow that increases the loss.\n\nTherefore, the stranded cost at time $t$ is calculated as:\n$$SC(t) = B(t) - S(t) + \\delta C_0$$\nSubstituting the expressions for $B(t)$ and $S(t)$:\n$$SC(t) = C_0 \\left(1 - \\frac{t}{n}\\right) - \\sigma C_0 \\exp(-\\lambda t) + \\delta C_0$$\nWe can factor out the initial cost $C_0$ to simplify the expression for the total stranded cost incurred at year $t$:\n$$SC(t) = C_0 \\left[ \\left(1 - \\frac{t}{n}\\right) - \\sigma \\exp(-\\lambda t) + \\delta \\right]$$\n\n**3. Net Present Value at Year $0$**\n\nThe stranded cost, $SC(t)$, is a single lump-sum cash flow that occurs at year $t$. The problem asks for the Net Present Value (NPV) of this cost at year $0$, using a constant real discount rate $r$. The present value, which we will call $V_0$, is found by discounting the future cash flow $SC(t)$ back by $t$ years.\n\nThe discount factor for a single payment at time $t$ is $(1+r)^{-t}$. The constraint $r  -1$ ensures that the base of the exponent, $1+r$, is positive.\nThe NPV at year $0$ is therefore:\n$$V_0 = SC(t) \\cdot (1+r)^{-t}$$\nSubstituting the expression for $SC(t)$:\n$$V_0 = \\left( C_0 \\left[ \\left(1 - \\frac{t}{n}\\right) - \\sigma \\exp(-\\lambda t) + \\delta \\right] \\right) (1+r)^{-t}$$\nRearranging the terms gives the final closed-form analytic expression for the year-$0$ present value of the stranded book value:\n$$V_0 = C_0 (1+r)^{-t} \\left(1 - \\frac{t}{n} - \\sigma \\exp(-\\lambda t) + \\delta \\right)$$\nThis expression is in terms of the given parameters $C_0$, $n$, $t$, $\\sigma$, $\\lambda$, $\\delta$, and $r$, as required.",
            "answer": "$$\\boxed{C_0 (1+r)^{-t} \\left(1 - \\frac{t}{n} - \\sigma \\exp(-\\lambda t) + \\delta \\right)}$$"
        },
        {
            "introduction": "To accurately model the economics of asset retirement, we must first quantify the physical risk of failure, which often increases with age. This practice delves into the statistical heart of reliability engineering, using the Weibull distribution and the method of maximum likelihood estimation (MLE) to build predictive models from operational data. This exercise will equip you with the skills to handle right-censored data, a common feature of reliability datasets, and derive the essential parameters for any sophisticated life-cycle model .",
            "id": "4069746",
            "problem": "An asset reliability analyst models component lifetimes in an energy system using the two-parameter Weibull distribution to capture age-dependent failure and right-censoring due to scheduled inspection intervals. Let the lifetime of each asset be modeled by a Weibull distribution with shape parameter $k$ and scale parameter $\\lambda$, with probability density function $f(t)$ and survival function $S(t)$ given by\n$$\nf(t) = \\frac{k}{\\lambda}\\left(\\frac{t}{\\lambda}\\right)^{k-1} \\exp\\left[-\\left(\\frac{t}{\\lambda}\\right)^k\\right], \\quad S(t) = \\exp\\left[-\\left(\\frac{t}{\\lambda}\\right)^k\\right], \\quad t \\ge 0.\n$$\nYou observe a sample $\\{(t_i, \\delta_i)\\}_{i=1}^n$, where $t_i$ is the observed time in years and $\\delta_i$ is an event indicator equal to $1$ if a failure is observed at $t_i$ and equal to $0$ if the observation is right-censored at $t_i$. Using the fundamental likelihood construction for independent observations under right-censoring, the likelihood is\n$$\nL(k,\\lambda) = \\prod_{i=1}^n \\left[ f(t_i) \\right]^{\\delta_i} \\left[ S(t_i) \\right]^{1-\\delta_i}.\n$$\nFrom first principles, derive the maximum likelihood estimator (MLE) for the parameters $(k,\\lambda)$ by:\n- writing the log-likelihood $\\ell(k,\\lambda) = \\log L(k,\\lambda)$ and its score equations,\n- analytically eliminating $\\lambda$ conditional on $k$ to reduce the problem to a single nonlinear equation in $k$,\n- justifying a computational procedure to obtain $(\\hat{k},\\hat{\\lambda})$.\n\nThen, implement a program that computes $(\\hat{k},\\hat{\\lambda})$ for each of the following three datasets. All times $t_i$ are in years; report $\\hat{\\lambda}$ in years. Your program must use a numerically stable method that respects the positivity constraints $k  0$ and $\\lambda  0$. Round each reported parameter to four decimal places.\n\nTest suite datasets:\n1. Happy path with moderate right-censoring: $t = [3.2, 4.5, 5.1, 6.8, 7.4, 9.0, 12.5, 14.2, 15.0, 16.1, 18.0, 20.0]$, $\\delta = [1,1,1,1,1,1,1,1,0,0,0,0]$.\n2. Boundary case with no censoring: $t = [2.1, 3.0, 3.5, 4.2, 4.9, 5.7, 6.3, 7.8, 8.4, 9.9]$, $\\delta = [1,1,1,1,1,1,1,1,1,1]$.\n3. Edge case with heavy right-censoring: $t = [5.0, 8.0, 10.0, 12.0, 15.0, 18.0, 20.0, 22.0, 25.0, 30.0]$, $\\delta = [0,0,1,0,0,1,0,0,1,0]$.\n\nFinal output format specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order $[\\hat{k}_1,\\hat{\\lambda}_1,\\hat{k}_2,\\hat{\\lambda}_2,\\hat{k}_3,\\hat{\\lambda}_3]$, where $(\\hat{k}_j,\\hat{\\lambda}_j)$ are the rounded estimates for dataset $j = 1,2,3$. For example, your output must look like $[x_1,y_1,x_2,y_2,x_3,y_3]$ with no additional text.",
            "solution": "The problem requires the derivation and implementation of the maximum likelihood estimator (MLE) for the parameters $(k, \\lambda)$ of a two-parameter Weibull distribution given a set of right-censored lifetime data. The process will follow the specified steps: derivation of the score equations, reduction to a single-variable problem, and justification of a computational procedure.\n\n### Step 1: Log-Likelihood and Score Equations\n\nThe lifetime of an asset is governed by a Weibull distribution with shape parameter $k>0$ and scale parameter $\\lambda>0$. The probability density function (PDF) $f(t)$ and survival function $S(t)$ are given as:\n$$\nf(t; k, \\lambda) = \\frac{k}{\\lambda}\\left(\\frac{t}{\\lambda}\\right)^{k-1} \\exp\\left[-\\left(\\frac{t}{\\lambda}\\right)^k\\right], \\quad t \\ge 0\n$$\n$$\nS(t; k, \\lambda) = \\exp\\left[-\\left(\\frac{t}{\\lambda}\\right)^k\\right], \\quad t \\ge 0\n$$\nThe data consists of $n$ independent observations $\\{(t_i, \\delta_i)\\}_{i=1}^n$, where $t_i$ is the time of failure or censoring, and $\\delta_i$ is the event indicator: $\\delta_i=1$ for a failure and $\\delta_i=0$ for a right-censored observation.\n\nThe likelihood function $L(k, \\lambda)$ for this dataset is the product of the contributions from each observation:\n$$\nL(k, \\lambda) = \\prod_{i=1}^n \\left[ f(t_i; k, \\lambda) \\right]^{\\delta_i} \\left[ S(t_i; k, \\lambda) \\right]^{1-\\delta_i}\n$$\nTo facilitate maximization, we work with the log-likelihood function, $\\ell(k, \\lambda) = \\log L(k, \\lambda)$:\n$$\n\\ell(k, \\lambda) = \\sum_{i=1}^n \\left[ \\delta_i \\log f(t_i; k, \\lambda) + (1-\\delta_i) \\log S(t_i; k, \\lambda) \\right]\n$$\nLet's find the expressions for $\\log f(t)$ and $\\log S(t)$:\n$$\n\\log S(t; k, \\lambda) = -\\left(\\frac{t}{\\lambda}\\right)^k\n$$\n$$\n\\log f(t; k, \\lambda) = \\log(k) - \\log(\\lambda) + (k-1)(\\log(t) - \\log(\\lambda)) - \\left(\\frac{t}{\\lambda}\\right)^k = \\log(k) - k\\log(\\lambda) + (k-1)\\log(t) - \\left(\\frac{t}{\\lambda}\\right)^k\n$$\nSubstituting these into the log-likelihood expression:\n$$\n\\ell(k, \\lambda) = \\sum_{i=1}^n \\left( \\delta_i \\left[ \\log(k) - k\\log(\\lambda) + (k-1)\\log(t_i) - \\left(\\frac{t_i}{\\lambda}\\right)^k \\right] + (1-\\delta_i) \\left[ -\\left(\\frac{t_i}{\\lambda}\\right)^k \\right] \\right)\n$$\nWe can combine the terms involving $-(t_i/\\lambda)^k$:\n$$\n\\ell(k, \\lambda) = \\sum_{i=1}^n \\delta_i \\left[ \\log(k) - k\\log(\\lambda) + (k-1)\\log(t_i) \\right] - \\sum_{i=1}^n \\left(\\frac{t_i}{\\lambda}\\right)^k\n$$\nLet $D = \\sum_{i=1}^n \\delta_i$ be the total number of observed failures. The expression simplifies to:\n$$\n\\ell(k, \\lambda) = D \\log(k) - D k \\log(\\lambda) + (k-1) \\sum_{i=1}^n \\delta_i \\log(t_i) - \\lambda^{-k} \\sum_{i=1}^n t_i^k\n$$\nThe maximum likelihood estimates $(\\hat{k}, \\hat{\\lambda})$ are found by solving the score equations, which are obtained by setting the partial derivatives of $\\ell(k, \\lambda)$ with respect to $k$ and $\\lambda$ to zero.\n\nThe partial derivative with respect to $\\lambda$ is:\n$$\n\\frac{\\partial \\ell}{\\partial \\lambda} = -\\frac{D k}{\\lambda} - (-k \\lambda^{-k-1}) \\sum_{i=1}^n t_i^k = -\\frac{D k}{\\lambda} + \\frac{k}{\\lambda^{k+1}} \\sum_{i=1}^n t_i^k\n$$\nSetting $\\frac{\\partial \\ell}{\\partial \\lambda} = 0$ yields the first score equation:\n$$\n-\\frac{D k}{\\lambda} + \\frac{k}{\\lambda^{k+1}} \\sum_{i=1}^n t_i^k = 0 \\quad \\implies \\quad D = \\frac{1}{\\lambda^k} \\sum_{i=1}^n t_i^k\n$$\n\nThe partial derivative with respect to $k$ is:\n$$\n\\frac{\\partial \\ell}{\\partial k} = \\frac{D}{k} - D \\log(\\lambda) + \\sum_{i=1}^n \\delta_i \\log(t_i) - \\frac{\\partial}{\\partial k} \\left( \\lambda^{-k} \\sum_{i=1}^n t_i^k \\right)\n$$\nThe derivative of the last term is:\n$$\n\\frac{\\partial}{\\partial k} \\left( \\sum_{i=1}^n \\left(\\frac{t_i}{\\lambda}\\right)^k \\right) = \\sum_{i=1}^n \\left(\\frac{t_i}{\\lambda}\\right)^k \\log\\left(\\frac{t_i}{\\lambda}\\right) = \\lambda^{-k} \\sum_{i=1}^n t_i^k (\\log(t_i) - \\log(\\lambda))\n$$\nSo, the second score equation is:\n$$\n\\frac{\\partial \\ell}{\\partial k} = \\frac{D}{k} - D \\log(\\lambda) + \\sum_{i=1}^n \\delta_i \\log(t_i) - \\lambda^{-k} \\left( \\sum_{i=1}^n t_i^k \\log(t_i) - \\log(\\lambda) \\sum_{i=1}^n t_i^k \\right) = 0\n$$\n\n### Step 2: Analytical Elimination of $\\lambda$\n\nFrom the first score equation, we can express $\\lambda$ as a function of $k$ and the data. Assuming $D  0$:\n$$\n\\lambda^k = \\frac{1}{D} \\sum_{i=1}^n t_i^k \\quad \\implies \\quad \\hat{\\lambda}(k) = \\left( \\frac{1}{D} \\sum_{i=1}^n t_i^k \\right)^{1/k}\n$$\nThis expression provides the MLE for $\\lambda$ conditional on a given $k$, denoted $\\hat{\\lambda}(k)$.\n\nNow we substitute this result into the second score equation. First, we substitute $\\sum_{i=1}^n t_i^k = D \\lambda^k$ into the equation for $\\frac{\\partial \\ell}{\\partial k}$:\n$$\n\\frac{D}{k} - D \\log(\\lambda) + \\sum_{i=1}^n \\delta_i \\log(t_i) - \\lambda^{-k} \\left( \\sum_{i=1}^n t_i^k \\log(t_i) - \\log(\\lambda) (D \\lambda^k) \\right) = 0\n$$\n$$\n\\frac{D}{k} - D \\log(\\lambda) + \\sum_{i=1}^n \\delta_i \\log(t_i) - \\lambda^{-k} \\sum_{i=1}^n t_i^k \\log(t_i) + D \\log(\\lambda) = 0\n$$\nThe terms involving $\\log(\\lambda)$ cancel, yielding a simplified equation that does not explicitly contain $\\lambda$:\n$$\n\\frac{D}{k} + \\sum_{i=1}^n \\delta_i \\log(t_i) - \\lambda^{-k} \\sum_{i=1}^n t_i^k \\log(t_i) = 0\n$$\nFinally, we substitute the expression for $\\lambda^k$:\n$$\n\\frac{D}{k} + \\sum_{i=1}^n \\delta_i \\log(t_i) - \\frac{\\sum_{i=1}^n t_i^k \\log(t_i)}{\\frac{1}{D} \\sum_{j=1}^n t_j^k} = 0\n$$\nDividing by $D$ (assuming $D0$), we obtain the final nonlinear equation for the estimate $\\hat{k}$:\n$$\n\\frac{1}{k} + \\frac{1}{D} \\sum_{i=1}^n \\delta_i \\log(t_i) - \\frac{\\sum_{i=1}^n t_i^k \\log(t_i)}{\\sum_{j=1}^n t_j^k} = 0\n$$\n\n### Step 3: Justification of a Computational Procedure\n\nThe problem of finding $(\\hat{k}, \\hat{\\lambda})$ has been reduced to finding the root $\\hat{k}$ of the single-variable function:\n$$\ng(k) = \\frac{1}{k} + C - H(k), \\quad \\text{where } C = \\frac{1}{D} \\sum_{i=1}^n \\delta_i \\log(t_i) \\text{ and } H(k) = \\frac{\\sum_{i=1}^n t_i^k \\log(t_i)}{\\sum_{j=1}^n t_j^k}\n$$\nWe need to solve $g(k)=0$ for $k>0$. We analyze the behavior of $g(k)$ on its domain $(0, \\infty)$:\n1.  As $k \\to 0^+$, the term $1/k$ dominates, so $g(k) \\to +\\infty$.\n2.  As $k \\to \\infty$, let $t_{max} = \\max\\{t_1, \\dots, t_n\\}$. The terms in the sums of $H(k)$ are dominated by the term(s) corresponding to $t_{max}$. The ratio $H(k)$ converges to $\\log(t_{max})$. Thus, $g(k) \\to C - \\log(t_{max})$. The constant $C$ is the average of the log-failure times. Since all failure times $t_i$ (for $\\delta_i=1$) must be less than or equal to $t_{max}$, their log-average $C$ must be less than or equal to $\\log(t_{max})$. Therefore, $g(k \\to \\infty) \\le 0$.\n\nSince $g(k)$ is continuous for $k>0$, and it transitions from positive to non-positive, the Intermediate Value Theorem guarantees the existence of at least one root $\\hat{k} \\in (0, \\infty)$. The function can be shown to be monotonic, ensuring a unique root.\n\nA robust numerical algorithm for one-dimensional root-finding is required. Brent's method, implemented in `scipy.optimize.brentq`, is an excellent choice as it combines the speed of interpolation-based methods with the reliability of the bisection method. It requires a search interval $[a, b]$ where $g(a)$ and $g(b)$ have opposite signs. Our analysis confirms that such an interval always exists (e.g., for a small $\\epsilon  0$ and a sufficiently large $M$, we have $g(\\epsilon)0$ and $g(M)0$).\n\nFor numerical stability, especially for large values of $k$, the terms $t_i^k$ can cause overflow. We can reformulate $H(k)$ and the calculation of $\\hat{\\lambda}$ by scaling with $t_{max}$:\n$$\nH(k) = \\frac{\\sum_{i=1}^n (t_i/t_{max})^k \\log(t_i)}{\\sum_{j=1}^n (t_j/t_{max})^k}\n$$\nThis prevents overflow as $t_i/t_{max} \\le 1$. Similarly, $\\hat{\\lambda}$ is computed as:\n$$\n\\hat{\\lambda} = \\left( \\frac{1}{D} \\sum_{i=1}^n t_i^{\\hat{k}} \\right)^{1/\\hat{k}} = t_{max} \\left( \\frac{1}{D} \\sum_{i=1}^n \\left(\\frac{t_i}{t_{max}}\\right)^{\\hat{k}} \\right)^{1/\\hat{k}}\n$$\nThe power can be computed stably using logarithms: $\\hat{\\lambda} = t_{max} \\exp\\left(\\frac{1}{\\hat{k}} \\log\\left(\\frac{1}{D} \\sum \\left(\\frac{t_i}{t_{max}}\\right)^{\\hat{k}}\\right)\\right)$.\n\nThe computational procedure is:\n1.  Given data $(t_i, \\delta_i)$, compute $D = \\sum \\delta_i$. If $D=0$, the MLE is not well-defined.\n2.  Define the function $g(k)$ using the numerically stable formulation.\n3.  Use `scipy.optimize.brentq` to find the root $\\hat{k}$ of $g(k)=0$ over a suitable interval (e.g., $[10^{-6}, 100]$).\n4.  Substitute $\\hat{k}$ into the stabilized formula to calculate $\\hat{\\lambda}$.\n\nThis procedure is well-defined, respects the positivity constraints on the parameters, and is numerically robust.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef mle_weibull(times, deltas):\n    \"\"\"\n    Computes the Maximum Likelihood Estimates (MLE) for the 2-parameter Weibull\n    distribution with right-censored data.\n\n    Args:\n        times (list or np.ndarray): Observed times (failure or censoring).\n        deltas (list or np.ndarray): Event indicators (1=failure, 0=censored).\n\n    Returns:\n        tuple: A tuple (k_hat, lambda_hat) containing the estimated shape\n               and scale parameters. Returns (nan, nan) if estimation fails.\n    \"\"\"\n    t = np.asanyarray(times, dtype=np.float64)\n    delta = np.asanyarray(deltas, dtype=np.float64)\n\n    D = np.sum(delta) # Total number of failures\n\n    if D == 0:\n        # MLE is not well-defined if there are no failure events.\n        # This case is not present in the problem's test suite.\n        return (np.nan, np.nan)\n\n    # Pre-calculate the constant C from the derived equation g(k) = 0\n    # C = (1/D) * sum(delta_i * log(t_i))\n    log_t_failures = np.log(t[delta == 1])\n    C = np.sum(log_t_failures) / D\n    \n    # Pre-calculate log(t) for all observations for use in H(k)\n    log_t = np.log(t)\n    \n    # Scale times by t_max for numerical stability\n    t_max = np.max(t)\n    t_norm = t / t_max\n\n    def g(k):\n        \"\"\"\n        The function g(k) for which we need to find the root.\n        g(k) = 1/k + C - H(k) = 0\n        H(k) is the ratio sum(t_i^k * log(t_i)) / sum(t_j^k)\n        \"\"\"\n        if k = 0:\n            return np.inf\n\n        # Numerically stable calculation of H(k)\n        tk_norm = t_norm ** k\n        \n        numerator = np.sum(tk_norm * log_t)\n        denominator = np.sum(tk_norm)\n\n        # Handle potential division by zero, though unlikely with t_max scaling\n        if denominator == 0:\n            return np.nan\n        \n        H_k = numerator / denominator\n        \n        return 1.0 / k + C - H_k\n\n    try:\n        # Use Brent's method to find the root k_hat. The interval [1e-6, 100]\n        # is sufficiently large for most practical reliability problems.\n        k_hat = brentq(g, a=1e-6, b=100.0)\n    except ValueError:\n        # This can happen if g(a) and g(b) have the same sign, indicating\n        # the root is outside the bracket or does not exist.\n        return (np.nan, np.nan)\n\n    # Once k_hat is found, calculate lambda_hat using the stable derived formula:\n    # lambda = t_max * ( (1/D) * sum( (t_i/t_max)^k ) )^(1/k)\n    \n    # Calculate the sum term\n    sum_term = np.sum((t_norm) ** k_hat) / D\n\n    # Use exp-log trick for stable power calculation\n    lambda_hat = t_max * np.exp(np.log(sum_term) / k_hat)\n        \n    return (k_hat, lambda_hat)\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    \"\"\"\n    test_cases = [\n        {\n            \"t\": [3.2, 4.5, 5.1, 6.8, 7.4, 9.0, 12.5, 14.2, 15.0, 16.1, 18.0, 20.0],\n            \"delta\": [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0]\n        },\n        {\n            \"t\": [2.1, 3.0, 3.5, 4.2, 4.9, 5.7, 6.3, 7.8, 8.4, 9.9],\n            \"delta\": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]\n        },\n        {\n            \"t\": [5.0, 8.0, 10.0, 12.0, 15.0, 18.0, 20.0, 22.0, 25.0, 30.0],\n            \"delta\": [0, 0, 1, 0, 0, 1, 0, 0, 1, 0]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        k_hat, lambda_hat = mle_weibull(case[\"t\"], case[\"delta\"])\n        \n        # Round to four decimal places as required\n        k_rounded = round(k_hat, 4)\n        lambda_rounded = round(lambda_hat, 4)\n        \n        results.extend([k_rounded, lambda_rounded])\n\n    # Format the final output string exactly as specified\n    formatted_results = \",\".join(map(str, results))\n    print(f\"[{formatted_results}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Asset retirement is not merely a technical or accounting calculation; it is a strategic choice often made under significant uncertainty. Waiting to gather more information before making an irreversible decision, like decommissioning a power plant, can have significant economic value. This exercise introduces the concept of \"real options,\" applying financial option theory to tangible assets to quantify the value of strategic flexibility in the face of policy and market risks .",
            "id": "4069732",
            "problem": "An electric utility owns a coal-fired power plant with remaining technical lifetime of $T = 20$ years. If operated without any carbon pricing, the plant yields a constant end-of-year net operating cash flow of $C = 120$ million United States Dollars (USD) per year. The plant emits $e = 5$ million metric tonnes of carbon dioxide ($\\text{tCO}_2$) per year. There is a policy risk: at the end of the current year ($t=0$), regulators will announce whether a carbon tax at a rate of $\\tau = 30$ USD per $\\text{tCO}_2$ will be implemented starting in year $t=2$ and thereafter. The probability that the announcement introduces the carbon tax is $p = 0.4$, and if the tax is not introduced at that announcement, it will not be introduced at any later date. The plant can be retired immediately at the end of this year ($t=0$) to receive a salvage value of $S_0 = 400$ million USD. If the plant is not retired now, it can be retired at the end of next year ($t=1$), after the announcement, to receive a salvage value of $S_1 = 380$ million USD. All salvage values and cash flows are end-of-year amounts. The risk-adjusted discount rate applicable to this project is $r = 0.08$ per year, constant.\n\nAssume the firm is risk-neutral and maximizes expected net present value (NPV). If the carbon tax is introduced, the net operating cash flow under the tax is $C_{\\text{tax}} = C - e \\tau$, and the firm will retire the plant immediately at $t=1$ if continued operation from $t=2$ onward would yield negative expected NPV. If the tax is not introduced, the plant will continue operating until the end of its technical life (i.e., through year $t=T$).\n\nUsing only the foundational definitions of discounted cash flow, conditional expectation, and optimal stopping under irreversible retirement, derive and compute the value of waiting to retire (the option value), defined as the difference between the expected NPV of the optimally timed retirement decision when waiting one year to learn the tax outcome versus retiring immediately at $t=0$. Round your final answer to four significant figures and express it in million United States Dollars (USD million).",
            "solution": "The objective is to compute the value of the option to wait, which is the difference between the expected Net Present Value (NPV) of the \"wait\" strategy and the NPV of the \"retire now\" strategy.\n\nValue of Waiting = $E[\\text{NPV}(\\text{wait})] - \\text{NPV}(\\text{retire now})$\n\nAll values are in millions of USD.\n\n### NPV of Retiring Immediately\n\nIf the firm chooses to retire at $t=0$, it receives the salvage value $S_0$. The problem states \"retire immediately ... at $t=0$\", and that all cash flows are end-of-year. This is interpreted as the cash flow being received at time $t=0$, so its NPV is simply its present value.\n\n$\\text{NPV}(\\text{retire now}) = S_0 = 400$\n\n### Expected NPV of Waiting\n\nIf the firm chooses to wait, it operates the plant for one year. At the end of that year ($t=1$), it receives the operating cash flow $C$, and the uncertainty about the carbon tax is resolved. Based on the outcome, the firm makes a new, optimal retirement decision.\n\nThe expected NPV of this strategy, calculated at $t=0$, is the discounted value of the expected cash flows at $t=1$. The total expected value at $t=1$ is the sum of the certain cash flow $C$ and the expected value of the plant from $t=1$ onwards, $E[V_1]$.\n\n$E[\\text{NPV}(\\text{wait})] = \\frac{C + E[V_1]}{1+r}$\n\nThe expected value of the plant at $t=1$, $E[V_1]$, depends on the two possible states of the world:\n$E[V_1] = p \\cdot V_{1, \\text{tax}} + (1-p) \\cdot V_{1, \\text{no tax}}$\n\nwhere $V_{1, \\text{tax}}$ and $V_{1, \\text{no tax}}$ are the values of the plant at $t=1$ contingent on the tax being introduced or not, respectively.\n\n#### Value at $t=1$ if Tax is Introduced (Probability $p=0.4$)\n\nIf the tax is introduced, the annual net operating cash flow from year $t=2$ onwards becomes:\n$C_{\\text{tax}} = C - e \\tau = 120 - (5 \\times 30) = 120 - 150 = -30$ million USD.\n\nAt $t=1$, the firm must decide whether to retire and receive the salvage value $S_1 = 380$, or to continue operating. The value of continuing to operate is the NPV at $t=1$ of receiving $C_{\\text{tax}}$ annually from $t=2$ to $t=T=20$.\n$\\text{NPV}(\\text{operate}|\\text{tax})_{t=1} = \\sum_{k=2}^{20} \\frac{C_{\\text tax}}{(1+r)^{k-1}}$\n\nSince $C_{\\text{tax}} = -30  0$, the NPV of continued operation is negative. According to the problem's stopping rule, the firm will retire. The value of this choice is the maximum of the two options:\n$V_{1, \\text{tax}} = \\max(S_1, \\text{NPV}(\\text{operate}|\\text{tax})_{t=1}) = \\max(380, \\text{negative value}) = 380$\n\n#### Value at $t=1$ if No Tax is Introduced (Probability $1-p=0.6$)\n\nIf no tax is introduced, the firm will receive the cash flow $C=120$ annually from $t=2$ to $t=T=20$. The problem states the firm will operate until the end of its life. We must still confirm this is a maximizing choice compared to retiring for $S_1$. The value of continued operation is the NPV at $t=1$ of this cash flow stream. This is an annuity of $C$ for $T-1 = 19$ years.\n\n$\\text{NPV}(\\text{operate}|\\text{no tax})_{t=1} = \\sum_{k=2}^{20} \\frac{C}{(1+r)^{k-1}} = \\frac{C}{r} \\left[ 1 - \\frac{1}{(1+r)^{T-1}} \\right]$\n\nSubstituting the given values:\n$C = 120$, $r = 0.08$, $T = 20$.\n$\\text{NPV}(\\text{operate}|\\text{no tax})_{t=1} = \\frac{120}{0.08} \\left[ 1 - \\frac{1}{(1+0.08)^{19}} \\right]$\n$= 1500 \\left[ 1 - (1.08)^{-19} \\right]$\n$\\approx 1500 \\left[ 1 - 0.2317104 \\right] = 1500 \\times 0.7682896 \\approx 1152.43$\n\nThe firm chooses the action with the higher value:\n$V_{1, \\text{no tax}} = \\max(S_1, \\text{NPV}(\\text{operate}|\\text{no tax})_{t=1}) = \\max(380, 1152.43) = 1152.43$\n\n#### Calculating E[NPV(wait)]\n\nNow we can calculate the expected value of the plant at $t=1$:\n$E[V_1] = p \\cdot V_{1, \\text{tax}} + (1-p) \\cdot V_{1, \\text{no tax}}$\n$E[V_1] = (0.4 \\times 380) + (0.6 \\times 1152.4344) = 152 + 691.4606 = 843.4606$\n\nThe total expected value at $t=0$ for the \"wait\" strategy is the discounted value of the cash flow $C$ at $t=1$ and the expected value of the asset $E[V_1]$ at $t=1$:\n$E[\\text{NPV}(\\text{wait})] = \\frac{C + E[V_1]}{1+r} = \\frac{120 + 843.4606}{1.08} = \\frac{963.4606}{1.08} \\approx 892.0932$\n\n### Calculate the Value of Waiting\n\nFinally, the value of waiting (the option value) is the difference between the expected NPV of waiting and the NPV of retiring now.\n\nValue of Waiting = $E[\\text{NPV}(\\text{wait})] - \\text{NPV}(\\text{retire now})$\nValue of Waiting = $892.0932 - 400 = 492.0932$\n\nThe problem asks for the answer to be rounded to four significant figures.\n$492.0932 \\approx 492.1$ million United States Dollars.",
            "answer": "$$\\boxed{492.1}$$"
        }
    ]
}