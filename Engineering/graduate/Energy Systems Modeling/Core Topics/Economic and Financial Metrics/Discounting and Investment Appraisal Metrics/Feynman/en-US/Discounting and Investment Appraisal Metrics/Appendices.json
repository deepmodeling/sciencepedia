{
    "hands_on_practices": [
        {
            "introduction": "Our first practice addresses a foundational concept that is a common source of error in long-term analysis: the distinction between real and nominal values. In energy systems modeling, where investment horizons can span decades, failing to properly account for the eroding effect of inflation on currency can lead to profoundly flawed conclusions. This exercise  will guide you through deriving the precise relationship between the nominal discount rate $i$, the real discount rate $r$, and the inflation rate $\\pi$ from first principles, solidifying your understanding of why you must discount real cash flows with a real rate and nominal cash flows with a nominal rate.",
            "id": "4085265",
            "problem": "A regulated electric utility is planning a multi-decade asset with fixed real Operations and Maintenance (O&M) costs of $C$ per year over $T$ years. The firm reports a nominal annual discount rate of $i=0.08$ and anticipates a constant general inflation rate of $\\pi=0.03$ per year over the planning horizon. Starting only from the fundamental definition that nominal growth multiplies currency units while real growth multiplies purchasing power units defined relative to a general price index, derive the expression for the constant real discount rate $r$ that is internally consistent with $i$ and $\\pi$. Then, using the given values of $i$ and $\\pi$, compute the numerical value of $r$. Finally, using first principles of present value and internal consistency of units of account, explain whether discounting the fixed real O&M stream $\\{C,C,\\dots,C\\}$ by the real rate $r$ yields the same present value as discounting the corresponding nominal O&M stream $\\{C(1+\\pi),C(1+\\pi)^{2},\\dots\\}$ by the nominal rate $i$, and clarify the direction of bias if a modeler inadvertently discounts real cash flows at $i$ instead of $r$. You should not compute a present value numerically; set up expressions only. Report your final numeric answer as the value of $r$ expressed as a decimal, rounded to five significant figures.",
            "solution": "The problem requires a derivation of the real discount rate, a numerical calculation, an explanation of present value equivalence, and an analysis of bias from incorrect discounting. The validation confirms the problem is well-posed, scientifically grounded, and objective.\n\n**Part 1: Derivation of the Real Discount Rate, $r$**\n\nWe begin from the fundamental definitions of nominal and real values. Let a principal amount of currency at time $t=0$ be $A_0$.\n\nA nominal interest rate, $i$, describes the growth of currency units. After one period (one year), the nominal amount, $A_{1,nom}$, will be:\n$$A_{1,nom} = A_0(1+i)$$\nThis expression represents the quantity of currency units at $t=1$.\n\nA real interest rate, $r$, describes the growth of purchasing power. To define purchasing power, we must introduce a general price index, $P$. Let the price index at $t=0$ be $P_0$. The real value, or purchasing power, of the initial amount $A_0$ is:\n$$PV_0 = \\frac{A_0}{P_0}$$\nInflation, $\\pi$, describes the growth rate of the general price index. After one period, the price index will be:\n$$P_1 = P_0(1+\\pi)$$\nThe purchasing power of the new nominal amount $A_{1,nom}$ at time $t=1$ is found by deflating it with the new price index $P_1$:\n$$PV_1 = \\frac{A_{1,nom}}{P_1} = \\frac{A_0(1+i)}{P_0(1+\\pi)}$$\nAlternatively, we can find $PV_1$ by applying the real growth factor, $(1+r)$, to the initial real value $PV_0$:\n$$PV_1 = PV_0(1+r) = \\frac{A_0}{P_0}(1+r)$$\nFor these two perspectives to be consistent, the two expressions for $PV_1$ must be equal:\n$$\\frac{A_0}{P_0}(1+r) = \\frac{A_0(1+i)}{P_0(1+\\pi)}$$\nThe terms $A_0$ and $P_0$ are non-zero and cancel, yielding the fundamental relationship known as the Fisher equation:\n$$(1+r) = \\frac{1+i}{1+\\pi}$$\nSolving for the real discount rate $r$ gives the desired expression:\n$$r = \\frac{1+i}{1+\\pi} - 1$$\n\n**Part 2: Numerical Calculation of $r$**\n\nThe problem provides the nominal annual discount rate $i=0.08$ and the constant general inflation rate $\\pi=0.03$. Substituting these values into the derived expression for $r$:\n$$r = \\frac{1+0.08}{1+0.03} - 1$$\n$$r = \\frac{1.08}{1.03} - 1$$\n$$r \\approx 1.048543689 - 1$$\n$$r \\approx 0.048543689$$\nRounding to five significant figures as required by the problem statement, we get:\n$$r \\approx 0.048544$$\n\n**Part 3: Present Value Equivalence**\n\nThe problem asks whether discounting a stream of fixed real O&M costs, $\\{C, C, \\dots, C\\}$, by the real rate $r$ is equivalent to discounting the corresponding nominal stream by the nominal rate $i$.\n\nFirst, let's define the nominal O&M cost in year $t$, denoted $C_{nom,t}$. A fixed real cost $C$ in year $t$ means its value is $C$ in year-$t$ purchasing power. To convert this to nominal currency units of year $t$, we must inflate it from the base year ($t=0$). The nominal cost in year $t$ is:\n$$C_{nom,t} = C(1+\\pi)^t$$\nThe nominal cash flow stream is thus $\\{C(1+\\pi), C(1+\\pi)^2, \\dots, C(1+\\pi)^T\\}$.\n\nThe present value ($PV$) of this nominal stream, when discounted at the nominal rate $i$, is:\n$$PV_{nominal \\ stream} = \\sum_{t=1}^{T} \\frac{C_{nom,t}}{(1+i)^t} = \\sum_{t=1}^{T} \\frac{C(1+\\pi)^t}{(1+i)^t}$$\nThis can be rewritten as:\n$$PV_{nominal \\ stream} = \\sum_{t=1}^{T} C \\left( \\frac{1+\\pi}{1+i} \\right)^t$$\nFrom our derivation in Part 1, we know that $(1+r) = \\frac{1+i}{1+\\pi}$. Therefore, $\\frac{1}{1+r} = \\frac{1+\\pi}{1+i}$. Substituting this into the expression for the present value:\n$$PV_{nominal \\ stream} = \\sum_{t=1}^{T} C \\left( \\frac{1}{1+r} \\right)^t = \\sum_{t=1}^{T} \\frac{C}{(1+r)^t}$$\nNow, consider the present value of the real cash flow stream. The stream consists of fixed real costs $\\{C, C, \\dots, C\\}$ over $T$ years. To find its present value, these real cash flows must be discounted at the real discount rate $r$:\n$$PV_{real \\ stream} = \\sum_{t=1}^{T} \\frac{C}{(1+r)^t}$$\nBy direct comparison, we see that $PV_{nominal \\ stream} = PV_{real \\ stream}$. Thus, the two methods are entirely equivalent and will yield the exact same present value. This demonstrates the internal consistency of using real rates for real cash flows and nominal rates for nominal cash flows.\n\n**Part 4: Direction of Bias from Incorrect Discounting**\n\nA common modeling error is to discount real cash flows at the nominal discount rate. We need to determine the direction of the resulting bias.\n\nThe correct present value is obtained by discounting the real stream $\\{C, C, \\dots, C\\}$ at the real rate $r$:\n$$PV_{correct} = \\sum_{t=1}^{T} \\frac{C}{(1+r)^t}$$\nThe incorrect present value is obtained by discounting the same real stream at the nominal rate $i$:\n$$PV_{incorrect} = \\sum_{t=1}^{T} \\frac{C}{(1+i)^t}$$\nTo determine the bias, we must compare the rates $r$ and $i$. From the formula $r = \\frac{1+i}{1+\\pi} - 1$, and given that inflation $\\pi=0.03$ is positive, the denominator $(1+\\pi)$ is greater than $1$. Therefore:\n$$\\frac{1}{1+\\pi} < 1$$\n$$(1+i)\\left(\\frac{1}{1+\\pi}\\right) < 1+i$$\n$$\\frac{1+i}{1+\\pi} - 1 < (1+i) - 1$$\n$$r < i$$\nIn our specific case, $r \\approx 0.048544$ and $i=0.08$, confirming that $r < i$.\n\nSince the discount rate $i$ is greater than the correct discount rate $r$, the discount factor $(1+i)$ will be greater than $(1+r)$. Consequently, for any time $t > 0$:\n$$\\frac{1}{1+i} < \\frac{1}{1+r}$$\n$$\\left(\\frac{1}{1+i}\\right)^t < \\left(\\frac{1}{1+r}\\right)^t$$\nSince the O&M costs $C$ are positive, each term in the summation for $PV_{incorrect}$ is smaller than the corresponding term in the summation for $PV_{correct}$:\n$$\\frac{C}{(1+i)^t} < \\frac{C}{(1+r)^t}$$\nTherefore, the sum will also be smaller:\n$$\\sum_{t=1}^{T} \\frac{C}{(1+i)^t} < \\sum_{t=1}^{T} \\frac{C}{(1+r)^t}$$\n$$PV_{incorrect} < PV_{correct}$$\nThe bias is that discounting real cash flows at the higher nominal rate will understate the present value of the costs. This error would make the project appear more financially attractive (i.e., less costly) than it truly is, potentially leading to incorrect investment decisions.",
            "answer": "$$\\boxed{0.048544}$$"
        },
        {
            "introduction": "Building on the correct choice of rate, we next explore the nuances of how that rate is applied over time. Mathematical models often favor continuous compounding for its analytical elegance and tractability, while corporate finance and accounting typically use discrete annual compounding. This practice  challenges you to rigorously compare these two conventions, quantify their divergence, and reflect on the modeling implications. You will discover that for long-horizon projects like grid infrastructure or power plants, this seemingly minor technical choice is not trivial and can significantly alter a project's valuation and perceived viability.",
            "id": "4085313",
            "problem": "An energy system planner is evaluating a single, deterministic decommissioning cash flow at time $t=25$ years arising from a grid-scale battery replacement program. The planner needs to compare the present value under two discounting conventions applied to the same nominal annual discount rate $r=0.07$: discrete annual compounding and continuous compounding. Using the fundamental definition of present value as the unique amount that, under the specified compounding convention, grows to exactly equal the future cash flow at the stated time, derive from first principles expressions for the present value under each convention for a single cash flow $C$ occurring at time $t=25$. Then, compute the relative difference\n$$\\delta \\equiv \\frac{\\text{PV}_{\\text{disc}} - \\text{PV}_{\\text{cont}}}{\\text{PV}_{\\text{disc}}},$$\nwhere $\\text{PV}_{\\text{disc}}$ denotes the present value under discrete annual compounding at rate $r$ and $\\text{PV}_{\\text{cont}}$ denotes the present value under continuous compounding at rate $r$. Express the final answer for $\\delta$ as a pure number (no units) and round your answer to four significant figures. Finally, explain the modeling implications of choosing discrete versus continuous compounding in long-horizon energy systems modeling when the same nominal rate $r$ is used across conventions.",
            "solution": "The problem has been validated and is determined to be a valid, well-posed problem in financial mathematics as applied to energy systems analysis. It is scientifically grounded, self-contained, and objective. We will now proceed with the solution.\n\nThe problem asks for three distinct tasks:\n1.  Derive from first principles the expressions for present value under discrete annual compounding ($\\text{PV}_{\\text{disc}}$) and continuous compounding ($\\text{PV}_{\\text{cont}}$).\n2.  Compute the relative difference $\\delta \\equiv \\frac{\\text{PV}_{\\text{disc}} - \\text{PV}_{\\text{cont}}}{\\text{PV}_{\\text{disc}}}$ for the given parameters.\n3.  Explain the modeling implications of the choice between these two conventions.\n\n**1. Derivation of Present Value Expressions**\n\nThe fundamental definition of present value ($\\text{PV}$) is the amount of capital that, if invested today at a given rate of return, will grow to equal a specific future cash flow ($C$) at a specific time ($t$) in the future.\n\n**a. Discrete Annual Compounding**\n\nUnder discrete annual compounding at a nominal annual rate $r$, an initial amount $\\text{PV}$ grows over one year to a future value ($\\text{FV}$) of:\n$$ \\text{FV}_1 = \\text{PV} \\cdot (1+r) $$\nIf this amount is reinvested for a second year, it grows to:\n$$ \\text{FV}_2 = \\text{FV}_1 \\cdot (1+r) = \\text{PV} \\cdot (1+r)^2 $$\nFollowing this pattern, after $t$ years, the future value is given by:\n$$ \\text{FV}_t = \\text{PV} \\cdot (1+r)^t $$\nAccording to the problem's definition, we set this future value equal to the cash flow $C$ and the present value to $\\text{PV}_{\\text{disc}}$.\n$$ C = \\text{PV}_{\\text{disc}} \\cdot (1+r)^t $$\nSolving for $\\text{PV}_{\\text{disc}}$ yields the expression for the present value under discrete annual compounding:\n$$ \\text{PV}_{\\text{disc}} = \\frac{C}{(1+r)^t} = C(1+r)^{-t} $$\n\n**b. Continuous Compounding**\n\nContinuous compounding is the mathematical limit of compounding over an infinitesimally small time interval. We begin with the formula for compounding $n$ times per year. The rate per compounding period is $\\frac{r}{n}$, and the total number of periods over $t$ years is $n \\cdot t$. The future value is:\n$$ \\text{FV}_{t,n} = \\text{PV} \\left(1 + \\frac{r}{n}\\right)^{nt} $$\nContinuous compounding corresponds to the limit as $n \\to \\infty$:\n$$ \\text{FV}_t = \\lim_{n \\to \\infty} \\text{PV} \\left(1 + \\frac{r}{n}\\right)^{nt} = \\text{PV} \\left[ \\lim_{n \\to \\infty} \\left(1 + \\frac{r}{n}\\right)^n \\right]^t $$\nWe use the fundamental definition of the exponential function, $e^x = \\lim_{k \\to \\infty} \\left(1 + \\frac{x}{k}\\right)^k$. By setting $x=r$ and $k=n$, the term in the brackets becomes $e^r$.\nThus, the future value under continuous compounding is:\n$$ \\text{FV}_t = \\text{PV} \\cdot (e^r)^t = \\text{PV} \\cdot e^{rt} $$\nSetting this future value equal to the cash flow $C$ and the present value to $\\text{PV}_{\\text{cont}}$:\n$$ C = \\text{PV}_{\\text{cont}} \\cdot e^{rt} $$\nSolving for $\\text{PV}_{\\text{cont}}$ yields the expression for the present value under continuous compounding:\n$$ \\text{PV}_{\\text{cont}} = \\frac{C}{e^{rt}} = Ce^{-rt} $$\n\n**2. Calculation of the Relative Difference $\\delta$**\n\nThe relative difference $\\delta$ is defined as:\n$$ \\delta = \\frac{\\text{PV}_{\\text{disc}} - \\text{PV}_{\\text{cont}}}{\\text{PV}_{\\text{disc}}} $$\nSubstituting the derived expressions for $\\text{PV}_{\\text{disc}}$ and $\\text{PV}_{\\text{cont}}$:\n$$ \\delta = \\frac{C(1+r)^{-t} - Ce^{-rt}}{C(1+r)^{-t}} $$\nThe cash flow amount $C$ is a common factor and cancels out, which is expected as $\\delta$ is a relative measure:\n$$ \\delta = \\frac{(1+r)^{-t} - e^{-rt}}{(1+r)^{-t}} = 1 - \\frac{e^{-rt}}{(1+r)^{-t}} = 1 - \\left(\\frac{e^r}{1+r}\\right)^{-t} $$\nThis simplifies to:\n$$ \\delta = 1 - \\left(\\frac{1+r}{e^r}\\right)^t $$\nNow, we substitute the numerical values provided: the nominal annual discount rate $r=0.07$ and the time horizon $t=25$ years.\n$$ \\delta = 1 - \\left(\\frac{1+0.07}{\\exp(0.07)}\\right)^{25} = 1 - \\left(\\frac{1.07}{\\exp(0.07)}\\right)^{25} $$\nLet's compute the values:\n$\\exp(0.07) \\approx 1.072508181$\nThe base of the exponent is $\\frac{1.07}{1.072508181} \\approx 0.997661410$\nRaising this to the power of $25$:\n$(0.997661410)^{25} \\approx 0.943152504$\nFinally, calculating $\\delta$:\n$$ \\delta = 1 - 0.943152504 = 0.056847496 $$\nRounding to four significant figures as required by the problem statement gives:\n$$ \\delta \\approx 0.05685 $$\n\n**3. Modeling Implications**\n\nThe calculation shows that for a nominal rate $r=0.07$, $\\delta \\approx 5.685\\%$. This means that the present value calculated using discrete annual compounding is approximately $5.685\\%$ larger than the present value calculated using continuous compounding. This result is general for any $r > 0$. From the Taylor series expansion of the exponential function, $e^r = 1 + r + \\frac{r^2}{2!} + \\frac{r^3}{3!} + \\dots$, it is evident that for $r > 0$, $e^r > 1+r$. Consequently, $e^{rt} > (1+r)^t$ for $t>1$, which implies $e^{-rt}  (1+r)^{-t}$. Therefore, $\\text{PV}_{\\text{cont}}  \\text{PV}_{\\text{disc}}$ always holds for the same positive nominal rate $r$.\n\nThe key modeling implications for long-horizon energy systems are:\n\n*   **Discounting Power**: For the same nominal rate $r$, continuous compounding is a more \"aggressive\" form of discounting. It assigns a lower present value to any future cash flow compared to discrete annual compounding. This effect is magnified over longer time horizons, as the difference between the two discount factors, $(1+r)^{-t}$ and $e^{-rt}$, grows with $t$. For projects with very long lifetimes (e.g., nuclear power plants, hydroelectric dams, or policies concerning climate change mitigation), the choice of compounding convention is not a minor technicality but a significant driver of the outcome.\n\n*   **Bias in Project Selection**: The choice of convention can systematically bias project appraisal. For an investment with high upfront costs but long-term benefits (e.g., a wind farm), using continuous compounding will discount the future revenues more heavily, making the project appear less financially viable than it would under discrete compounding. Conversely, for a project with large future liabilities, such as the decommissioning cost of the battery system in this problem, using continuous compounding makes the project look more attractive by diminishing the present value of that future cost more significantly.\n\n*   **Consistency and Transparency**: The most critical implication is the need for absolute clarity and consistency in methodological choices. An analyst could, intentionally or not, favor or disfavor a project by selecting a particular compounding convention. Therefore, in any robust energy systems analysis or investment appraisal, the discount rate must be specified along with its compounding convention (e.g., \"$7\\%$ per annum, compounded annually\" vs. \"$7\\%$ per annum, compounded continuously\"). Comparing results from studies that use different implicit conventions without proper rate conversion is invalid. While continuous compounding offers mathematical convenience for theoretical modeling and calculus-based optimization, discrete compounding often better reflects industrial and financial accounting practices. The choice must be explicit, justified, and consistently applied.",
            "answer": "$$\\boxed{0.05685}$$"
        },
        {
            "introduction": "Finally, we integrate these core concepts into a dynamic decision-making context, which lies at the heart of energy systems planning. The ultimate purpose of discounting is not just to value an asset, but to guide optimal choices over time. This exercise  moves beyond static valuation by asking you to determine the optimal timing for a new energy asset by comparing the total discounted system costs of different investment pathways. This practice serves as a direct bridge from fundamental discounting principles to the logic of investment optimization models, demonstrating how discounting provides the mechanism for making trade-offs between immediate capital costs and future operational benefits.",
            "id": "4085292",
            "problem": "Consider a discrete-time, three-period energy supply planning model with periods indexed by $t \\in \\{0,1,2\\}$. There is a single potential asset that, if built once in some period $p \\in \\{0,1,2\\}$, immediately becomes operational in period $p$ and supplies the entire energy demand in all subsequent periods $t \\ge p$. If the asset is not yet built in a period $t$, the demand in that period is met by purchasing energy on a spot market. You may also choose to never build the asset, which is denoted by $p=-1$.\n\nFundamental quantities:\n- Energy demand in each period $t$ is $D_t$ in megawatt-hours (MWh).\n- If built in period $p \\ge 0$, the asset incurs a one-time capital expenditure of $C$ dollars in period $p$.\n- When the asset is operating in period $t$, it incurs operating costs equal to the sum of Operations and Maintenance (OM) costs and fuel costs per unit energy, denoted $c_{\\text{om}}$ dollars per MWh and $c_{\\text{fuel}}$ dollars per MWh, respectively. Define $c_{\\text{var}} = c_{\\text{om}} + c_{\\text{fuel}}$ dollars per MWh for brevity.\n- If the asset is not yet built in a period $t$, the demand is met at the spot market unit price $s_t$ dollars per MWh.\n- The model uses a real discount rate $r$, which must be expressed as a decimal (for example, $0.05$ for five percent). The present value is the unique amount at period $0$ such that, if compounded at the real discount rate $r$ to the relevant future period, it equals the future cash flow.\n\nTask:\n- Derive, from the above compounding definition and without invoking any shortcut formulas, an expression for the total discounted system cost at period $0$ as a function of the build timing decision $p \\in \\{-1,0,1,2\\}$, the capital expenditure $C$, the real discount rate $r$, the demands $D_t$, the spot prices $s_t$, and the variable cost $c_{\\text{var}}$.\n- Implement a program that computes, for each candidate build timing $p$, the total discounted system cost in dollars of period $0$ and selects the $p$ that minimizes this cost. If multiple $p$ yield identical minimal discounted costs (up to numerical rounding), break ties by choosing the smallest $p$.\n- Your program must produce a single line containing the results for the provided test suite, with each result reported as a two-element list $[p^\\star, \\text{cost}^\\star]$ where $p^\\star$ is the optimal build timing and $\\text{cost}^\\star$ is the minimized discounted system cost in dollars of period 0. Express the discounted costs in dollars of period 0, rounded to two decimal places. The final output must be a comma-separated list enclosed in square brackets, for example $[[0,12345.67],[-1,890.12],[2,3456.78]]$.\n\nTest suite specifications:\n- Test case $1$ (happy path with rising spot prices and moderate discounting):\n  - $D_0 = 100$ MWh, $D_1 = 100$ MWh, $D_2 = 100$ MWh.\n  - $c_{\\text{om}} = 5$ dollars per MWh, $c_{\\text{fuel}} = 25$ dollars per MWh, hence $c_{\\text{var}} = 30$ dollars per MWh.\n  - $s_0 = 80$ dollars per MWh, $s_1 = 90$ dollars per MWh, $s_2 = 110$ dollars per MWh.\n  - $C = 8000$ dollars.\n  - $r = 0.05$.\n- Test case $2$ (boundary neutrality where the discount rate exactly offsets the benefit of earlier build):\n  - $D_0 = 100$ MWh, $D_1 = 100$ MWh, $D_2 = 100$ MWh.\n  - $c_{\\text{om}} = 5$ dollars per MWh, $c_{\\text{fuel}} = 25$ dollars per MWh, hence $c_{\\text{var}} = 30$ dollars per MWh.\n  - $s_0 = 80$ dollars per MWh, $s_1 = 80$ dollars per MWh, $s_2 = 80$ dollars per MWh.\n  - $C = 25000$ dollars.\n  - $r = 0.25$.\n- Test case $3$ (edge case with zero discounting and an asset that is uneconomic to operate relative to the spot market):\n  - $D_0 = 100$ MWh, $D_1 = 100$ MWh, $D_2 = 100$ MWh.\n  - $c_{\\text{om}} = 20$ dollars per MWh, $c_{\\text{fuel}} = 50$ dollars per MWh, hence $c_{\\text{var}} = 70$ dollars per MWh.\n  - $s_0 = 50$ dollars per MWh, $s_1 = 50$ dollars per MWh, $s_2 = 50$ dollars per MWh.\n  - $C = 1000$ dollars.\n  - $r = 0.00$.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test caseâ€™s result should be a two-element list $[p^\\star, \\text{cost}^\\star]$ as defined above. For example, the output must look like $[[p_1,\\text{cost}_1],[p_2,\\text{cost}_2],[p_3,\\text{cost}_3]]$ with no additional text.",
            "solution": "The problem requires the derivation of the total discounted system cost for an energy asset investment decision and the implementation of a program to find the optimal decision that minimizes this cost. The solution must be derived from first principles as specified.\n\nThe core principle for evaluating investments over time is Discounted Cash Flow (DCF) analysis. The economic value of cash flows occurring at different points in time can be compared by converting them to their equivalent value at a single point in time, typically the present ($t=0$). This equivalent value is known as the Present Value ($PV$). The problem defines the relationship between a future cash flow $F_t$ occurring in period $t$ and its present value $PV$ through the compounding formula: $PV \\times (1+r)^t = F_t$, where $r$ is the real discount rate per period. From this definition, the $PV$ of a cash flow $F_t$ is derived by discounting:\n\n$$ PV(F_t) = \\frac{F_t}{(1+r)^t} $$\n\nThe total discounted system cost, which we aim to minimize, is the sum of the present values of all costs incurred over the planning horizon $t \\in \\{0, 1, 2\\}$. Let us denote this total cost as a function of the build decision $p$ by $J(p)$.\n\n$$ J(p) = \\sum_{t=0}^{2} PV(\\text{Cost in period } t \\text{ given decision } p) $$\n\nThe costs in any given period depend on whether the asset has been built. The decision variable is the build period $p \\in \\{-1, 0, 1, 2\\}$. For each possible value of $p$, we can determine the stream of cash flows and calculate the total discounted cost.\n\nLet's analyze the costs for each possible decision $p$:\n\n**Case 1: Never build the asset ($p=-1$)**\nIf the asset is never built, the energy demand $D_t$ in each period $t \\in \\{0, 1, 2\\}$ must be met by purchasing energy from the spot market at the unit price $s_t$.\nThe cost incurred in period $t$ is $F_t = s_t D_t$.\nThe total discounted cost $J(-1)$ is the sum of the present values of these costs:\n$$ J(-1) = \\frac{s_0 D_0}{(1+r)^0} + \\frac{s_1 D_1}{(1+r)^1} + \\frac{s_2 D_2}{(1+r)^2} = s_0 D_0 + \\frac{s_1 D_1}{1+r} + \\frac{s_2 D_2}{(1+r)^2} $$\n\n**Case 2: Build the asset in period $p=0$**\nThe asset is built and becomes operational in period $t=0$.\n- In period $t=0$: A one-time capital expenditure $C$ is incurred. The demand $D_0$ is met by the new asset, incurring an operating cost of $c_{\\text{var}} D_0$. The total cash outflow in period $0$ is $F_0 = C + c_{\\text{var}} D_0$.\n- In periods $t=1$ and $t=2$: The asset continues to operate, meeting demands $D_1$ and $D_2$ at costs $F_1 = c_{\\text{var}} D_1$ and $F_2 = c_{\\text{var}} D_2$, respectively.\nThe total discounted cost $J(0)$ is:\n$$ J(0) = \\frac{C + c_{\\text{var}} D_0}{(1+r)^0} + \\frac{c_{\\text{var}} D_1}{(1+r)^1} + \\frac{c_{\\text{var}} D_2}{(1+r)^2} = C + c_{\\text{var}} D_0 + \\frac{c_{\\text{var}} D_1}{1+r} + \\frac{c_{\\text{var}} D_2}{(1+r)^2} $$\n\n**Case 3: Build the asset in period $p=1$**\n- In period $t=0$: The asset is not yet built. Demand $D_0$ is met from the spot market at cost $F_0 = s_0 D_0$.\n- In period $t=1$: The asset is built, incurring capital cost $C$, and becomes operational. The total cost in period $1$ is $F_1 = C + c_{\\text{var}} D_1$.\n- In period $t=2$: The asset operates, incurring cost $F_2 = c_{\\text{var}} D_2$.\nThe total discounted cost $J(1)$ is:\n$$ J(1) = \\frac{s_0 D_0}{(1+r)^0} + \\frac{C + c_{\\text{var}} D_1}{(1+r)^1} + \\frac{c_{\\text{var}} D_2}{(1+r)^2} = s_0 D_0 + \\frac{C + c_{\\text{var}} D_1}{1+r} + \\frac{c_{\\text{var}} D_2}{(1+r)^2} $$\n\n**Case 4: Build the asset in period $p=2$**\n- In periods $t=0$ and $t=1$: The asset is not yet built. Demands $D_0$ and $D_1$ are met from the spot market at costs $F_0 = s_0 D_0$ and $F_1 = s_1 D_1$.\n- In period $t=2$: The asset is built and operates, incurring a total cost of $F_2 = C + c_{\\text{var}} D_2$.\nThe total discounted cost $J(2)$ is:\n$$ J(2) = \\frac{s_0 D_0}{(1+r)^0} + \\frac{s_1 D_1}{(1+r)^1} + \\frac{C + c_{\\text{var}} D_2}{(1+r)^2} = s_0 D_0 + \\frac{s_1 D_1}{1+r} + \\frac{C + c_{\\text{var}} D_2}{(1+r)^2} $$\n\n**General Cost Function and Optimization**\nThese cases can be summarized into a single framework. For any build decision $p \\in \\{0, 1, 2\\}$, the total discounted cost is the sum of the discounted capital expenditure and the discounted operational costs. The operational cost in a period $t$ is $s_t D_t$ if the asset is not yet built ($t  p$) and $c_{\\text{var}} D_t$ if it is operational ($t \\ge p$).\n\n$J(p) = \\frac{C}{(1+r)^p} + \\sum_{t=0}^{p-1} \\frac{s_t D_t}{(1+r)^t} + \\sum_{t=p}^{2} \\frac{c_{\\text{var}} D_t}{(1+r)^t}$ for $p \\in \\{0, 1, 2\\}$.\nThe case $p=-1$ is handled separately as $J(-1) = \\sum_{t=0}^{2} \\frac{s_t D_t}{(1+r)^t}$.\n\nThe optimization task is to find the build decision $p^\\star$ that minimizes the total discounted cost:\n$$ p^\\star = \\arg\\min_{p \\in \\{-1, 0, 1, 2\\}} J(p) $$\nIn case of a tie where multiple values of $p$ yield the same minimum cost, the problem specifies that the smallest value of $p$ should be chosen.\n\nThe program will implement these derived formulas. For each test case, it will calculate $J(p)$ for all four candidate values of $p$, identify the minimum cost, and select the corresponding $p^\\star$ according to the tie-breaking rule. The final minimized cost is then rounded to two decimal places for reporting.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the energy asset investment problem for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (happy path)\n        {\n            'demands': [100.0, 100.0, 100.0],\n            'spot_prices': [80.0, 90.0, 110.0],\n            'c_om': 5.0,\n            'c_fuel': 25.0,\n            'capital_expenditure': 8000.0,\n            'discount_rate': 0.05\n        },\n        # Test case 2 (boundary neutrality)\n        {\n            'demands': [100.0, 100.0, 100.0],\n            'spot_prices': [80.0, 80.0, 80.0],\n            'c_om': 5.0,\n            'c_fuel': 25.0,\n            'capital_expenditure': 25000.0,\n            'discount_rate': 0.25\n        },\n        # Test case 3 (edge case with uneconomic asset)\n        {\n            'demands': [100.0, 100.0, 100.0],\n            'spot_prices': [50.0, 50.0, 50.0],\n            'c_om': 20.0,\n            'c_fuel': 50.0,\n            'capital_expenditure': 1000.0,\n            'discount_rate': 0.00\n        }\n    ]\n\n    final_results = []\n    for params in test_cases:\n        D = params['demands']\n        s = params['spot_prices']\n        c_var = params['c_om'] + params['c_fuel']\n        C = params['capital_expenditure']\n        r = params['discount_rate']\n\n        p_candidates = [-1, 0, 1, 2]\n        costs_by_p = {}\n\n        for p in p_candidates:\n            costs_by_p[p] = calculate_discounted_cost(p, D, s, c_var, C, r)\n\n        # Find the minimum cost from all candidate decisions.\n        if costs_by_p:\n            min_cost_val = min(costs_by_p.values())\n            \n            # Find all p that yield this minimum cost (with a tolerance for floating point comparisons)\n            tied_p = [p for p, cost in costs_by_p.items() if np.isclose(cost, min_cost_val)]\n            \n            # Apply tie-breaking rule: choose the smallest p.\n            p_star = min(tied_p)\n            \n            # The corresponding cost, rounded to two decimal places for the output.\n            cost_star = round(costs_by_p[p_star], 2)\n            \n            final_results.append([p_star, cost_star])\n\n    # Final print statement in the exact required format.\n    # Convert each [p, cost] list to its string representation and join with commas.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\n\ndef calculate_discounted_cost(p, D, s, c_var, C, r):\n    \"\"\"\n    Calculates the total discounted system cost for a given build decision p.\n\n    Args:\n        p (int): The build period decision, p in {-1, 0, 1, 2}.\n        D (list): List of energy demands [D_0, D_1, D_2].\n        s (list): List of spot market prices [s_0, s_1, s_2].\n        c_var (float): The variable cost of the asset per MWh.\n        C (float): The one-time capital expenditure.\n        r (float): The real discount rate.\n\n    Returns:\n        float: The total discounted cost at period 0.\n    \"\"\"\n    num_periods = 3\n    discount_term = 1.0 + r\n    \n    total_cost = 0.0\n\n    if p == -1:\n        # Asset is never built. All demand is met by the spot market.\n        for t in range(num_periods):\n            cost_t = s[t] * D[t]\n            total_cost += cost_t / (discount_term ** t)\n    else:\n        # Asset is built in period p = 0.\n        # Add discounted capital expenditure.\n        total_cost += C / (discount_term ** p)\n        \n        # Add discounted operational costs for all periods.\n        for t in range(num_periods):\n            if t  p:\n                # Before build: use spot market.\n                cost_t = s[t] * D[t]\n            else:\n                # After build (t = p): use own asset.\n                cost_t = c_var * D[t]\n            \n            total_cost += cost_t / (discount_term ** t)\n            \n    return total_cost\n\n\nsolve()\n```"
        }
    ]
}