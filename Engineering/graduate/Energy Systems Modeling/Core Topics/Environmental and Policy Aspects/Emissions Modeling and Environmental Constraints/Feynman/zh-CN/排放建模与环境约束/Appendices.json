{
    "hands_on_practices": [
        {
            "introduction": "排放建模的首要步骤是准确核算。本练习将引导你探讨如何使用全球变暖潜能值 ($GWP$) 这一关键指标，将甲烷等非二氧化碳温室气体换算为通用的二氧化碳当量 ($CO_2e$)。你将通过计算发现，时间尺度的选择会显著改变计算结果，理解这一点至关重要，因为它直接影响气候政策的制定和不同减排技术路径的评估 。",
            "id": "4088592",
            "problem": "一座天然气联合循环发电厂向电网供电，年发电量为 $G = 3.00 \\times 10^{6}$ 兆瓦时。在其上游的生产、处理和输配链中，甲烷泄漏的平均特定速率为每兆瓦时发电量泄漏 $l = 1.5$ 千克甲烷。在气候影响核算中，甲烷排放的二氧化碳当量（CO2e）通常使用全球变暖潜能值（GWP）来计算。政府间气候变化专门委员会（IPCC）将其定义为：在指定的时间范围 $H$ 内，一次脉冲排放的非二氧化碳气体的单位质量时间积分辐射强迫与一次等质量脉冲排放的二氧化碳的单位质量时间积分辐射强迫之比。标准的 IPCC 第五次评估报告（不含气候-碳反馈）提供了甲烷的 $ \\text{GWP}_{20} = 84$ 和 $ \\text{GWP}_{100} = 28$。\n\n从 $ \\text{GWP}_{H}$ 的定义以及活动水平与泄漏量之间的质量平衡关系出发，推导该发电厂在 $H = 20$ 和 $H = 100$ 两种时间范围下一年甲烷泄漏的 CO2e。将两个最终答案以公吨 CO2e 为单位表示，并各自四舍五入到三位有效数字。",
            "solution": "在尝试解答之前，对问题陈述进行验证。\n\n### 第 1 步：提取已知条件\n-   年发电量：$G = 3.00 \\times 10^{6}$ 兆瓦时/年。\n-   特定甲烷泄漏率：$l = 1.5$ 千克甲烷/兆瓦时。\n-   甲烷在 $20$ 年时间范围内的全球变暖潜能值：$\\text{GWP}_{20} = 84$。\n-   甲烷在 $100$ 年时间范围内的全球变暖潜能值：$\\text{GWP}_{100} = 28$。\n-   二氧化碳当量（$\\text{CO2e}$）的定义：由气体质量及其全球变暖潜能值（$\\text{GWP}$）导出。\n-   要求输出：该发电厂在 $H = 20$ 和 $H = 100$ 两种时间范围下一年甲烷泄漏的 $\\text{CO2e}$，以公吨为单位表示，并四舍五入到三位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题具有科学依据。它采用了能源系统分析和气候科学中的标准概念、定义和数据。术语 $\\text{GWP}$ 和 $\\text{CO2e}$ 是排放核算的核心，所提供的 $\\text{GWP}_{20}$ 和 $\\text{GWP}_{100}$ 值与 IPCC 第五次评估报告一致。发电量和泄漏数据对于天然气发电厂是合理的。\n2.  **适定性**：该问题是适定的。它提供了所有必要的数据和明确的目标。发电量、泄漏率、总质量和 $\\text{CO2e}$ 之间的关系在数学上是明确的。可以确定唯一的解。\n3.  **客观性**：该问题以客观、定量的语言陈述，没有主观论断或偏见。\n4.  **完整性与一致性**：该问题是自洽且内部一致的。单位是兼容的，需要从千克到公吨的标准转换。\n5.  **可行性**：物理参数是现实的。年发电量 $3.00 \\times 10^{6}$ MWh/年 对应一个大型联合循环燃气轮机（CCGT）发电厂，而 $1.5$ kg/MWh 的泄漏率虽然处于估算值的偏高一侧，但在有记录的天然气供应链范围内。\n\n### 第 3 步：结论与行动\n该问题被判定为**有效**。它是排放核算中既定原则的直接应用。将推导解答。\n\n### 解答推导\n\n主要任务是计算发电厂上游供应链每年甲烷（$\\text{CH}_4$）泄漏的总二氧化碳当量（$\\text{CO2e}$）。这需要一个三步过程：\n1.  计算每年泄漏的甲烷总质量。\n2.  将此质量转换为所需单位，即公吨。\n3.  应用相应的全球变暖潜能值（$\\text{GWP}$）因子，求出指定时间范围的 $\\text{CO2e}$。\n\n设 $M_{\\text{CH}_4}$ 为每年泄漏的甲烷总质量。该质量是年发电量 $G$ 与特定泄漏率 $l$ 的乘积。\n\n$$\nM_{\\text{CH}_4} = G \\times l\n$$\n\n代入给定值：\n$G = 3.00 \\times 10^{6} \\, \\text{MWh/year}$\n$l = 1.5 \\, \\text{kg CH}_4/\\text{MWh}$\n\n$$\nM_{\\text{CH}_4} = (3.00 \\times 10^{6} \\, \\text{MWh/year}) \\times (1.5 \\, \\text{kg}/\\text{MWh}) = 4.5 \\times 10^{6} \\, \\text{kg/year}\n$$\n\n结果是每年泄漏的甲烷总质量，单位为千克。问题要求最终答案以公吨 $\\text{CO2e}$ 为单位。因此，我们必须将甲烷的质量从千克转换为公吨。换算因子为 $1$ 公吨 $= 1000$ 千克。\n\n$$\nM_{\\text{CH}_4, \\text{tonnes}} = \\frac{M_{\\text{CH}_4, \\text{kg}}}{1000 \\, \\text{kg/tonne}} = \\frac{4.5 \\times 10^{6} \\, \\text{kg}}{1000 \\, \\text{kg/tonne}} = 4500 \\, \\text{tonnes}\n$$\n\n接下来，我们计算二氧化碳当量（$\\text{CO2e}$）。对于给定的非-$\\text{CO}_2$气体质量，其 $\\text{CO2e}$ 是通过将其质量乘以其在给定时间范围 $H$ 内的特定 $\\text{GWP}$ 来计算的。\n\n$$\n\\text{CO2e}_{H} = M_{\\text{CH}_4, \\text{tonnes}} \\times \\text{GWP}_{H}\n$$\n\n我们将对两个指定的时间范围 $H=20$ 年和 $H=100$ 年进行此计算。\n\n对于 $20$ 年的时间范围（$H=20$）：\n给定的甲烷的 $\\text{GWP}_{20}$ 是 $84$。这意味着在一吨甲烷在 $20$ 年期间的增温效应与 $84$ 吨二氧化碳相同。\n\n$$\n\\text{CO2e}_{20} = 4500 \\, \\text{tonnes CH}_4 \\times 84 \\, \\frac{\\text{tonnes CO2e}}{\\text{tonne CH}_4} = 378000 \\, \\text{tonnes CO2e}\n$$\n\n对于 $100$ 年的时间范围（$H=100$）：\n给定的甲烷的 $\\text{GWP}_{100}$ 是 $28$。这是在监管和长期气候政策背景下更常引用的数值。\n\n$$\n\\text{CO2e}_{100} = 4500 \\, \\text{tonnes CH}_4 \\times 28 \\, \\frac{\\text{tonnes CO2e}}{\\text{tonne CH}_4} = 126000 \\, \\text{tonnes CO2e}\n$$\n\n最后一步是按要求将两个结果四舍五入到三位有效数字。\n\n对于 $\\text{CO2e}_{20}$：\n$378000$ 变为 $3.78 \\times 10^{5}$。\n\n对于 $\\text{CO2e}_{100}$：\n$126000$ 变为 $1.26 \\times 10^{5}$。\n\n这两个最终答案分别是该发电厂在 $20$ 年和 $100$ 年时间范围内年度甲烷泄漏的 $\\text{CO2e}$（单位为公吨）。",
            "answer": "$$\\boxed{\\begin{pmatrix} 3.78 \\times 10^{5} & 1.26 \\times 10^{5} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在掌握了排放核算方法后，本练习将深入探讨环境约束所带来的经济影响。我们将通过一个简化的电力系统调度问题，亲手计算当施加总排放上限时，系统为了满足该约束而不得不放弃成本最低的发电组合 。这个过程将清晰地揭示碳的“影子价格”（shadow price）是如何从优化问题中产生的，这个价格即为系统的边际减排成本，是理解碳税和总量控制与交易制度的核心。",
            "id": "4088528",
            "problem": "一个区域系统运营商寻求在满足需求、容量和有约束力的累积排放上限的条件下，最小化两个时期的总发电成本。有两个火力发电机组，索引为 $i \\in \\{1,2\\}$，以及两个时期，索引为 $t \\in \\{1,2\\}$。令 $x_{i,t}$ 表示机组 $i$ 在时期 $t$ 输送的能量，单位为兆瓦时。运营商的目标是在满足时期需求、遵守各时期容量限制且不超过二氧化碳（CO2）累积排放上限的前提下，最小化总可变发电成本。\n\n基本建模假设：\n- 机组 $i$ 的单位能量可变成本为 $c_i$，单位为美元/兆瓦时。\n- 机组 $i$ 的排放强度为 $e_i$，单位为吨二氧化碳/兆瓦时。\n- 机组 $i$ 的各时期容量为 $K_i$，单位为兆瓦时。\n- 时期需求为 $D_1$ 和 $D_2$，单位为兆瓦时。\n- 两个时期的累积排放上限为 $E^{\\max}$，单位为吨二氧化碳。\n- 无启动成本、爬坡限制或输电约束；损耗可忽略不计；系统是完全竞争的。\n\n数据：\n- 成本：$c_1 = 20$, $c_2 = 35$。\n- 排放强度：$e_1 = 0.9$, $e_2 = 0.1$。\n- 各时期容量：$K_1 = 60$, $K_2 = 60$。\n- 需求：$D_1 = 80$, $D_2 = 60$。\n- 排放上限：$E^{\\max} = 90$。\n\n使用标准线性规划成本最小化方法建立运营商问题的模型，决策变量为 $x_{i,t}$，需求平衡约束为 $\\sum_{i} x_{i,t} = D_t$，容量约束为 $0 \\le x_{i,t} \\le K_i$，累积排放约束为 $\\sum_{t} \\sum_{i} e_i x_{i,t} \\le E^{\\max}$。将排放上限的影子价格 $\\lambda^{\\star}$ 定义为最优解下与累积排放约束相关的拉格朗日乘子。从此模型和约束优化的基本原理出发，计算 $\\lambda^{\\star}$，并确定当排放上限起约束作用时，相对于无约束的最低成本调度，哪个机组被置换。对于被置换的机组，如果机组1被置换，则报告索引1；如果机组2被置换，则报告索引2。\n\n将您的最终数值答案以包含两个条目的行矩阵形式 $\\begin{pmatrix} \\lambda^{\\star} & i_{\\text{displaced}} \\end{pmatrix}$ 给出。将 $\\lambda^{\\star}$ 四舍五入到四位有效数字。影子价格的单位为美元/吨二氧化碳。第二个条目必须是1或2，且没有单位。",
            "solution": "用户要求我解决一个能源系统的经济调度问题。\n\n我的计划如下：\n1.  **验证问题：**\n    *   提取所有给定数据和约束。\n    *   检查其科学合理性、适定性和客观性。这看起来是能源系统建模中的一个标准线性规划问题，这是一个成熟的领域。假设陈述清晰。数据看起来是一致的。问题要求从模型中推导出具体的输出。问题看起来是有效的。\n\n2.  **建立线性规划模型：**\n    *   **目标函数：** 最小化总成本。$C = c_1 x_{1,1} + c_2 x_{2,1} + c_1 x_{1,2} + c_2 x_{2,2}$。\n    *   **决策变量：** $x_{1,1}, x_{2,1}, x_{1,2}, x_{2,2}$。\n    *   **约束条件：**\n        *   时期1需求：$x_{1,1} + x_{2,1} = D_1$\n        *   时期2需求：$x_{1,2} + x_{2,2} = D_2$\n        *   机组1，时期1容量：$0 \\le x_{1,1} \\le K_1$\n        *   机组1，时期2容量：$0 \\le x_{1,2} \\le K_1$\n        *   机组2，时期1容量：$0 \\le x_{2,1} \\le K_2$\n        *   机组2，时期2容量：$0 \\le x_{2,2} \\le K_2$\n        *   累积排放：$e_1 x_{1,1} + e_2 x_{2,1} + e_1 x_{1,2} + e_2 x_{2,2} \\le E^{\\max}$\n\n3.  **求解无（排放）约束的调度：**\n    *   首先，我需要看看在*没有*排放上限的情况下的调度会是怎样。这就是“最低成本调度”。\n    *   在每个时期，系统会首先使用最便宜的发电机。机组1的成本 $c_1 = 20$，机组2的成本 $c_2 = 35$。所以，机组1更便宜。\n    *   **时期1（需求 $D_1 = 80$）：**\n        *   调度机组1直至其容量上限：$x_{1,1} = K_1 = 60$。\n        *   剩余需求为 $80 - 60 = 20$。\n        *   调度机组2以满足剩余部分：$x_{2,1} = 20$。这在其容量 $K_2 = 60$ 范围内。\n        *   所以，$x_{1,1} = 60$，$x_{2,1} = 20$。\n    *   **时期2（需求 $D_2 = 60$）：**\n        *   调度机组1以满足需求：$x_{1,2} = D_2 = 60$。这在其容量 $K_1 = 60$ 范围内。\n        *   不需要机组2：$x_{2,2} = 0$。\n        *   所以，$x_{1,2} = 60$，$x_{2,2} = 0$。\n    *   **最低成本调度的总排放量：**\n        *   $E_{\\text{unconstrained}} = e_1 x_{1,1} + e_2 x_{2,1} + e_1 x_{1,2} + e_2 x_{2,2}$\n        *   $E_{\\text{unconstrained}} = 0.9 \\times 60 + 0.1 \\times 20 + 0.9 \\times 60 + 0.1 \\times 0$\n        *   $E_{\\text{unconstrained}} = 54 + 2 + 54 + 0 = 110$ 吨。\n    *   **与上限核对：** 排放上限为 $E^{\\max} = 90$。由于 $110 > 90$，排放约束是起作用的。\n\n4.  **求解有约束的调度：**\n    *   现在的问题是在满足所有约束（包括起作用的排放上限）的情况下最小化成本。\n    *   为满足排放上限而进行重新调度的核心思想，是用低排放机组的发电替代高排放机组的发电。这会增加总成本。排放上限的影子价格 $\\lambda$ 代表了这种边际成本的增加。\n    *   机组1（较便宜）排放高（$e_1 = 0.9$）。机组2（较昂贵）排放低（$e_2 = 0.1$）。为了减少排放，我们必须减少机组1的发电量，并增加机组2的发电量。\n    *   我们来分析这种替代的成本。为了将排放量减少 $\\Delta E$，我们需要交换发电量。假设我们将 $\\Delta x$ MWh的发电量从机组1转移到机组2。\n    *   成本的变化是 $\\Delta C = (c_2 - c_1) \\cdot \\Delta x = (35 - 20) \\cdot \\Delta x = 15 \\cdot \\Delta x$。\n    *   排放量的变化是 $\\Delta E = (e_2 - e_1) \\cdot \\Delta x = (0.1 - 0.9) \\cdot \\Delta x = -0.8 \\cdot \\Delta x$。\n    *   影子价格 $\\lambda$ 是边际减排成本，即 $dC/|dE|$。\n    *   $\\frac{dC}{|dE|} \\approx \\frac{\\Delta C}{|\\Delta E|} = \\frac{15 \\cdot \\Delta x}{0.8 \\cdot \\Delta x} = \\frac{15}{0.8} = 18.75$。\n    *   等等，让我们更正式一些。影子价格 $\\lambda$ 是约束每收紧一单位所带来的成本增加。如果约束是 $E \\le E^{\\max}$，收紧它意味着减小 $E^{\\max}$。问题将 $\\lambda^\\star$ 定义为约束的拉格朗日乘子。对于一个最小化问题，拉格朗日函数可以写成 $L = f(x) + \\lambda (g(x) - b)$。对于一个起作用的约束 $g(x) \\le b$，KKT条件是 $\\lambda \\ge 0$。$\\lambda$ 的值是 $\\frac{\\partial f^\\star}{\\partial b}$，其中 $f^\\star$ 是最优目标值。放宽约束（增加 $b=E^{\\max}$）会降低最小成本，所以 $\\frac{\\partial f^\\star}{\\partial b}$ 将为负。影子价格的标准经济学定义是正的，代表放宽约束的边际价值。这里，$\\lambda^{\\star}$ 被定义为拉格朗日乘子，其符号取决于拉格朗日函数的构造。然而，单位（美元/吨）意味着它是一个经济价格。我们来计算它的大小，也就是边际减排成本。这个值总是正的。\n    *   $\\lambda = \\frac{c_2 - c_1}{e_1 - e_2} = \\frac{35 - 20}{0.9 - 0.1} = \\frac{15}{0.8} = 18.75$。\n    *   单位是 $(\\text{美元}/\\text{兆瓦时}) / (\\text{吨}/\\text{兆瓦时}) = \\text{美元}/\\text{吨}$。这是正确的。\n    *   所以，$\\lambda = 18.75$。\n\n5.  **确定被置换的机组和最优的有约束调度**\n    *   最低成本调度导致了 $110$ 吨的排放。我们需要将其减少到 $90$ 吨，即减少 $20$ 吨。\n    *   这种替代涉及减少机组1（$x_1$）的发电量，并增加机组2（$x_2$）的发电量。\n    *   令 $\\Delta x$ 为在两个时期内从机组1转移到机组2的总能量。\n    *   排放减少量为 $\\Delta E_{\\text{total}} = 20$。\n    *   $\\Delta E_{\\text{total}} = (e_1 - e_2) \\cdot \\Delta x$。\n    *   $20 = (0.9 - 0.1) \\cdot \\Delta x = 0.8 \\cdot \\Delta x$。\n    *   $\\Delta x = 20 / 0.8 = 25$ MWh。\n    *   我们需要从机组1向机组2总共转移 $25$ MWh。\n    *   我们在哪里进行这种转移？我们应该在‘最容易’的时期进行，或者说，在对碳进行定价后仍能维持最低成本原则的时期进行。\n    *   我们来定义碳调整后的成本：$c'_i = c_i + \\lambda \\cdot e_i$。\n    *   $c'_1 = 20 + 18.75 \\cdot 0.9 = 20 + 16.875 = 36.875$。\n    *   $c'_2 = 35 + 18.75 \\cdot 0.1 = 35 + 1.875 = 36.875$。\n    *   碳调整后的成本是相同的！这是一个合理性检查，表明 $\\lambda$ 的值是正确的。在这个碳价下，调度员对两个机组的选择是无差异的。碳价的任何进一步上涨都将使机组2在碳调整后的意义上更便宜。\n    *   所以，我们需要将机组1的发电量减少 $25$ MWh，并将机组2的发电量增加 $25$ MWh。\n    *   让我们再次审视无约束调度：\n        *   时期1：$x_{1,1} = 60$, $x_{2,1} = 20$。\n        *   时期2：$x_{1,2} = 60$, $x_{2,2} = 0$。\n    *   我们不能增加 $x_{2,1}$，因为 $x_{1,1}+x_{2,1}=D_1$。交换必须在同一时期内发生。\n    *   让我们检查约束条件。\n        *   机组1的发电量为 $x_{1,1}=60, x_{1,2}=60$。\n        *   机组2的发电量为 $x_{2,1}=20, x_{2,2}=0$。\n    *   要将发电量从机组1转移到机组2，我们必须在遵守 $x_{i,t} \\le K_i$ 和 $x_{1,t} + x_{2,t} = D_t$ 的前提下进行。\n    *   **时期1：** $x_{1,1}=60, x_{2,1}=20$。需求 $D_1=80$。机组2有备用容量（$60 - 20 = 40$）。我们可以减少 $x_{1,1}$ 并以相同数量增加 $x_{2,1}$。\n    *   **时期2：** $x_{1,2}=60, x_{2,2}=0$。需求 $D_2=60$。机组2有备用容量（$60 - 0 = 60$）。我们可以减少 $x_{1,2}$ 并以相同数量增加 $x_{2,2}$。\n    *   由于成本 $c_1$ 和 $c_2$ 在不同时期是恒定的，我们在哪个时期进行交换并不重要。总成本影响将是相同的。\n    *   我们需要将 $x_{1,\\text{total}} = x_{1,1} + x_{1,2}$ 减少 $25$ MWh。并增加 $x_{2,\\text{total}} = x_{2,1} + x_{2,2}$ $25$ MWh。\n    *   让我们进行更改。我们从机组1获得的总发电量为 $120$ MWh。我们需要削减 $25$ MWh。\n    *   让我们从时期2削减 $\\Delta x_{1,2}$，从时期1削减 $\\Delta x_{1,1}$，其中 $\\Delta x_{1,1} + \\Delta x_{1,2} = 25$。\n    *   相应的增加量是 $\\Delta x_{2,2} = \\Delta x_{1,2}$ 和 $\\Delta x_{2,1} = \\Delta x_{1,1}$。\n    *   原始调度：\n        $x_{1,1}^{\\text{unc}} = 60$, $x_{2,1}^{\\text{unc}} = 20$\n        $x_{1,2}^{\\text{unc}} = 60$, $x_{2,2}^{\\text{unc}} = 0$\n    *   新调度：\n        $x_{1,1}^{\\text{con}} = 60 - \\Delta x_{1,1}$, $x_{2,1}^{\\text{con}} = 20 + \\Delta x_{1,1}$\n        $x_{1,2}^{\\text{con}} = 60 - \\Delta x_{1,2}$, $x_{2,2}^{\\text{con}} = 0 + \\Delta x_{1,2}$\n    *   我们需要遵守容量约束：\n        $x_{1,1}^{\\text{con}} \\le 60$ (成立)\n        $x_{2,1}^{\\text{con}} \\le 60 \\implies 20 + \\Delta x_{1,1} \\le 60 \\implies \\Delta x_{1,1} \\le 40$\n        $x_{1,2}^{\\text{con}} \\le 60$ (成立)\n        $x_{2,2}^{\\text{con}} \\le 60 \\implies \\Delta x_{1,2} \\le 60$\n    *   由于 $\\Delta x_{1,1} + \\Delta x_{1,2} = 25$，只要 $\\Delta x_{1,1} \\ge 0$ 和 $\\Delta x_{1,2} \\ge 0$，任何满足此条件的组合都将有效。这个问题是简并的。对于 $x_{i,t}$ 变量，存在无限个最优解。例如：\n        *   方案 A：在时期2转移全部 $25$ MWh。$\\Delta x_{1,2} = 25$, $\\Delta x_{1,1} = 0$。\n            *   $x_{1,1} = 60$, $x_{2,1} = 20$。\n            *   $x_{1,2} = 35$, $x_{2,2} = 25$。\n        *   方案 B：在时期1转移全部 $25$ MWh。$\\Delta x_{1,1} = 25$, $\\Delta x_{1,2} = 0$。\n            *   $x_{1,1} = 35$, $x_{2,1} = 45$。\n            *   $x_{1,2} = 60$, $x_{2,2} = 0$。\n        *   方案 C：在每个时期都转移一部分。例如，$\\Delta x_{1,1} = 10$, $\\Delta x_{1,2} = 15$。\n            *   $x_{1,1} = 50$, $x_{2,1} = 30$。\n            *   $x_{1,2} = 45$, $x_{2,2} = 15$。\n\n    *   所有这些方案都得出相同的总成本和总排放量。\n    *   让我们验证方案 A 的总排放量：\n        $E = 0.9 x_{1,1} + 0.1 x_{2,1} + 0.9 x_{1,2} + 0.1 x_{2,2}$\n        $E = 0.9 \\cdot 60 + 0.1 \\cdot 20 + 0.9 \\cdot 35 + 0.1 \\cdot 25$\n        $E = 54 + 2 + 31.5 + 2.5 = 90$。正确。\n    *   让我们验证方案 A 的总成本：\n        $C = 20 \\cdot 60 + 35 \\cdot 20 + 20 \\cdot 35 + 35 \\cdot 25$\n        $C = 1200 + 700 + 700 + 875 = 3475$。\n    *   无约束成本是多少？\n        $C_{\\text{unc}} = 20 \\cdot 60 + 35 \\cdot 20 + 20 \\cdot 60 + 35 \\cdot 0 = 1200 + 700 + 1200 + 0 = 3100$。\n    *   成本增加是 $3475 - 3100 = 375$。\n    *   让我们用影子价格来核对一下。排放上限的变化是 $110 - 90 = 20$。成本增加应为 $\\lambda \\cdot \\Delta E = 18.75 \\cdot 20 = 375$。这匹配了。所以我对 $\\lambda$ 的计算很可能是正确的。\n\n6.  **回答问题的第二部分：哪个机组被置换？**\n    *   问题问“当排放上限起约束作用时，相对于无约束的最低成本调度，确定哪个机组被置换。”\n    *   在无约束调度中，我们尽可能多地使用最便宜的机组（机组1）。$x_{1,\\text{total}}^{\\text{unc}} = 60 + 60 = 120$。$x_{2,\\text{total}}^{\\text{unc}} = 20 + 0 = 20$。\n    *   在有约束的调度中，我们必须减少高排放机组（机组1）的出力，并增加低排放机组（机组2）的出力。\n    *   机组1的总发电量减少了：$x_{1,\\text{total}}^{\\text{con}} = x_{1,1}^{\\text{con}} + x_{1,2}^{\\text{con}} = (60 - \\Delta x_{1,1}) + (60 - \\Delta x_{1,2}) = 120 - (\\Delta x_{1,1} + \\Delta x_{1,2}) = 120 - 25 = 95$。\n    *   机组2的总发电量增加了：$x_{2,\\text{total}}^{\\text{con}} = x_{2,1}^{\\text{con}} + x_{2,2}^{\\text{con}} = (20 + \\Delta x_{1,1}) + (0 + \\Delta x_{1,2}) = 20 + (\\Delta x_{1,1} + \\Delta x_{1,2}) = 20 + 25 = 45$。\n    *   所以，机组1的发电量为了满足排放约束而从其最低成本水平被减少（置换）。机组2的发电量增加了。\n    *   因此，被置换的机组是机组1。索引为 $1$。\n\n7.  **对步骤和逻辑的最终审查。**\n    *   **问题建模：** 线性规划模型是标准的、正确的。\n    *   **无约束解：** 正确地确定了经济次序（机组1优先于机组2）并计算了调度结果和相应的排放量（$110$ 吨）。\n    *   **约束检查：** 正确地识别出排放约束（$E^{\\max} = 90$）是起作用的。\n    *   **影子价格 (`$\\lambda$`) 计算：**\n        *   影子价格是边际减排成本。它是为实现一吨减排量而增加的成本。\n        *   减排是通过将发电从便宜/高污染的机组（1）替换为昂贵/清洁的机组（2）来实现的。\n        *   替换1 MWh的成本是 $\\Delta C = c_2 - c_1 = 15$。\n        *   替换1 MWh带来的减排量是 $\\Delta E = e_1 - e_2 = 0.8$。\n        *   每吨减排成本为 $\\lambda = \\Delta C / \\Delta E = 15 / 0.8 = 18.75 美元/吨$。这个逻辑看起来很可靠。重新计算出的调整后成本 $c'_i$ 相等是一个强有力的确认。\n    *   **被置换机组的确定：**\n        *   解释无约束调度最大化了最便宜机组（机组1）的使用。\n        *   解释施加排放上限迫使发电量从高排放机组（机组1）减少，并从低排放机组（机组2）增加。\n        *   结论是机组1是被置换的机组，所以 $i_{\\text{displaced}} = 1$。\n    *   **最终答案的构建**：\n        *   将结果组合成要求的矩阵格式 $(\\lambda^\\star, i_{\\text{displaced}})$。\n        *   应用四舍五入规则：$18.75$ 有四位有效数字。非零数字总是有效的。$18.75$ 的有效数字位数为4。不需要四舍五入。\n    *   一切正常。\n\n该问题是能源系统建模中一个标准的、适定的线性规划问题。所有数据和定义都清晰一致。该问题具有科学依据和客观性。它是有效的。\n\n运营商的问题是在两个时期 $t \\in \\{1,2\\}$ 内，从两个发电机组 $i \\in \\{1,2\\}$ 中，最小化总发电成本 $Z$。决策变量是 $x_{i,t}$，即机组 $i$ 在时期 $t$ 的发电量。\n\n目标函数是：\n$$ \\min_{x_{i,t}} Z = \\sum_{t=1}^{2} \\sum_{i=1}^{2} c_i x_{i,t} = c_1 x_{1,1} + c_2 x_{2,1} + c_1 x_{1,2} + c_2 x_{2,2} $$\n\n这需要满足以下约束条件：\n1.  时期1的需求平衡：$x_{1,1} + x_{2,1} = D_1$\n2.  时期2的需求平衡：$x_{1,2} + x_{2,2} = D_2$\n3.  机组1的容量限制：$0 \\le x_{1,1} \\le K_1$ 和 $0 \\le x_{1,2} \\le K_1$\n4.  机组2的容量限制：$0 \\le x_{2,1} \\le K_2$ 和 $0 \\le x_{2,2} \\le K_2$\n5.  累积排放上限：$\\sum_{t=1}^{2} \\sum_{i=1}^{2} e_i x_{i,t} \\le E^{\\max}$\n\n首先，我们通过忽略排放约束来确定无约束的最低成本调度。在每个时期，发电量按可变成本的经济次序（从最便宜到最昂贵）进行调度。这里，$c_1 = 20\\ \\$/\\text{MWh}$ 和 $c_2 = 35\\ \\$/\\text{MWh}$，所以机组1总是在机组2之前被调度。\n\n对于时期1，需求 $D_1 = 80$ MWh：\n机组1被调度至其容量上限 $K_1 = 60$ MWh。所以，$x_{1,1}^{\\text{unc}} = 60$。\n剩余需求为 $D_1 - K_1 = 80 - 60 = 20$ MWh。\n机组2被调度以满足剩余需求。$x_{2,1}^{\\text{unc}} = 20$。这在其容量 $K_2 = 60$ 范围内。\n\n对于时期2，需求 $D_2 = 60$ MWh：\n机组1被调度以满足全部需求，因为 $D_2 \\le K_1$。所以，$x_{1,2}^{\\text{unc}} = 60$。\n不需要机组2。所以，$x_{2,2}^{\\text{unc}} = 0$。\n\n此无约束调度的总排放量为：\n$$ E^{\\text{unc}} = e_1 x_{1,1}^{\\text{unc}} + e_2 x_{2,1}^{\\text{unc}} + e_1 x_{1,2}^{\\text{unc}} + e_2 x_{2,2}^{\\text{unc}} $$\n$$ E^{\\text{unc}} = (0.9)(60) + (0.1)(20) + (0.9)(60) + (0.1)(0) = 54 + 2 + 54 = 110 \\text{ 吨} $$\n排放上限为 $E^{\\max} = 90$ 吨。由于 $E^{\\text{unc}} > E^{\\max}$，排放约束是起作用的。\n\n为了满足上限，系统必须减少排放。这是通过将发电量从高排放机组重新调度到低排放机组来实现的。机组1的排放强度为 $e_1=0.9$，机组2为 $e_2=0.1$。因此，必须减少机组1的发电量，并由机组2的发电量来替代。这种替代会增加总成本。\n\n排放上限的影子价格 $\\lambda^{\\star}$ 是边际减排成本。它是为实现一吨的减排量而增加的总成本。当我们用机组2的发电量替代机组1的 $\\Delta x$ MWh发电量时，成本的变化是 $\\Delta C = (c_2 - c_1) \\Delta x$，排放量的变化是 $\\Delta E = (e_2 - e_1) \\Delta x$。\n边际减排成本是边际成本增加与边际减排量的比率：\n$$ \\lambda^{\\star} = \\frac{\\Delta C}{-\\Delta E} = \\frac{(c_2 - c_1)\\Delta x}{-(e_2 - e_1)\\Delta x} = \\frac{c_2 - c_1}{e_1 - e_2} $$\n代入给定值：\n$$ \\lambda^{\\star} = \\frac{35 - 20}{0.9 - 0.1} = \\frac{15}{0.8} = 18.75 $$\n单位是 $(\\$/\\text{MWh}) / (\\text{吨}/\\text{MWh}) = \\$/\\text{吨}$。影子价格为 $\\lambda^{\\star} = 18.75$ 美元/吨二氧化碳。问题要求四舍五入到四位有效数字。数字 $18.75$ 有四位有效数字（$1, 8, 7, 5$），因此无需四舍五入。\n\n问题的第二部分询问哪个机组被置换。无约束的最低成本调度最大化了最便宜发电机（即机组1）的使用。当施加有约束力的排放上限时，必须将发电量从高排放机组（1）转移到低排放机组（2）以减少总排放。这意味着机组1的发电量 $x_{1,1} + x_{1,2}$ 相对于其最低成本调度水平有所下降，而机组2的发电量 $x_{2,1} + x_{2,2}$ 则有所增加。因此，机组1是“被置换”的机组。被置换机组的索引为 $i_{\\text{displaced}}=1$。\n\n为了验证，所需的减排量是 $110 - 90 = 20$ 吨。从机组1转移到机组2的发电量 $\\Delta x_{\\text{shift}}$ 为：\n$$ \\Delta x_{\\text{shift}} = \\frac{\\text{Total emission reduction}}{e_1 - e_2} = \\frac{20}{0.8} = 25 \\text{ MWh} $$\n在有约束的情况下，机组1的总发电量为 $x_{1}^{\\text{con}} = (x_{1,1}^{\\text{unc}} + x_{1,2}^{\\text{unc}}) - 25 = 120 - 25 = 95$ MWh。机组2的总发电量为 $x_{2}^{\\text{con}} = (x_{2,1}^{\\text{unc}} + x_{2,2}^{\\text{unc}}) + 25 = 20 + 25 = 45$ MWh。\n显然，机组1的出力从无约束最优值被减少（置换）了。\n\n最终答案由影子价格 $\\lambda^{\\star}$ 和被置换机组的索引 $i_{\\text{displaced}}$ 组成。\n$\\lambda^{\\star} = 18.75$\n$i_{\\text{displaced}} = 1$",
            "answer": "$$ \\boxed{\\begin{pmatrix} 18.75 & 1 \\end{pmatrix}} $$"
        },
        {
            "introduction": "现实世界的气候政策通常以长期的累积“碳预算”形式存在，而非简单的年度排放上限。这项高级实践要求你构建一个跨越多个时期的动态规划模型，以在满足累积碳预算的前提下最小化系统总成本 。通过求解该模型并分析其对偶变量，你将能够推导出碳影子价格随时间变化的路径，这体现了著名的 Hotelling 法则在资源约束下的应用，并让你深刻理解贴现率如何影响今天的减排决策与未来的减排成本。",
            "id": "4088532",
            "problem": "考虑一个电力系统的跨期调度计划问题，该系统包含两种发电技术，涵盖 $T$ 个离散时间段 $t \\in \\{0,1,\\dots,T-1\\}$。技术 $F$（化石燃料）具有恒定的可变发电成本 $c_F$（单位：美元/兆瓦时，即 $\\$/\\text{MWh}$）和恒定的排放强度 $e_F$（单位：吨二氧化碳/兆瓦时，即 $\\text{tCO}_2/\\text{MWh}$）。技术 $R$（可再生能源）具有恒定的可变发电成本 $c_R$（单位：美元/兆瓦时，即 $\\$/\\text{MWh}$）和零排放强度。可再生能源技术在每个时期有容量限制 $C^R_t$（单位：兆瓦时，即 $\\text{MWh}$）。假设化石燃料技术除了非负性外，没有具约束性的容量限制。时期 $t$ 的电力需求为 $D_t$（单位：兆瓦时，即 $\\text{MWh}$）。令 $g_{F,t}$ 和 $g_{R,t}$ 分别表示时期 $t$ 化石燃料和可再生能源技术的发电量（单位：兆瓦时，即 $\\text{MWh}$）。\n\n一个社会规划者使用每个时期的时间折扣因子 $\\delta \\in (0,1]$ 来最小化总发电成本的现值，同时需满足每个时期的需求、遵守可再生能源容量限制、发电量的非负性，以及在整个规划期内不超过一个硬性累积碳预算 $B$（单位：吨二氧化碳，即 $\\text{tCO}_2$）。形式上，该规划者求解以下线性规划问题：\n最小化现值成本\n$$\n\\min_{\\{g_{F,t}, g_{R,t}\\}_{t=0}^{T-1}} \\sum_{t=0}^{T-1} \\delta^t \\left( c_F \\, g_{F,t} + c_R \\, g_{R,t} \\right)\n$$\n并满足以下约束条件\n$$\ng_{F,t} + g_{R,t} = D_t \\quad \\text{for all } t \\in \\{0,1,\\dots,T-1\\},\n$$\n$$\ng_{R,t} \\leq C^R_t \\quad \\text{for all } t \\in \\{0,1,\\dots,T-1\\},\n$$\n$$\n\\sum_{t=0}^{T-1} e_F \\, g_{F,t} \\leq B,\n$$\n$$\ng_{F,t} \\geq 0, \\quad g_{R,t} \\geq 0 \\quad \\text{for all } t \\in \\{0,1,\\dots,T-1\\}.\n$$\n\n根据凸优化和拉格朗日对偶性的基本原理，与累积碳预算约束相关的拉格朗日乘子量化了将该预算边际放宽所产生的影子价值。鉴于目标函数使用了时间折扣成本 $\\delta^t$，以时期-$t$ 货币单位计量的特定时期隐含碳影子价格（单位：美元/吨二氧化碳，即 $\\$/\\text{tCO}_2$），即为预算乘子经折扣因子归一化后的值。本问题的目标是计算最优计划并分析隐含碳影子价格的时间序列 $\\{\\pi_t\\}_{t=0}^{T-1}$，其中每个 $\\pi_t$ 定义为与最优解一致的时期-$t$ 的碳价格。\n\n您的程序必须：\n- 使用可靠的线性规划求解器，为给定参数构建并求解该线性规划问题。\n- 提取与累积碳预算约束相关的对偶变量（拉格朗日乘子）$\\,\\mu\\,$。\n- 计算隐含的特定时期碳影子价格路径 $\\pi_t = \\mu / \\delta^t$，对每个 $t \\in \\{0,1,\\dots,T-1\\}$，单位为美元/吨二氧化碳（$\\$/\\text{tCO}_2$）。\n- 将每个 $\\pi_t$ 四舍五入到 $3$ 位小数。\n\n在所有测试用例中使用以下固定的参数值：\n- 时期数：$T = 4$。\n- 需求：$D_0 = 100\\,\\text{MWh}$，$D_1 = 110\\,\\text{MWh}$，$D_2 = 120\\,\\text{MWh}$，$D_3 = 130\\,\\text{MWh}$。\n- 可再生能源容量限制：$C^R_0 = 50\\,\\text{MWh}$，$C^R_1 = 60\\,\\text{MWh}$，$C^R_2 = 70\\,\\text{MWh}$，$C^R_3 = 80\\,\\text{MWh}$。\n- 成本：$c_F = 30\\,\\$/\\text{MWh}$，$c_R = 60\\,\\$/\\text{MWh}$。\n- 排放强度：$e_F = 0.9\\,\\text{tCO}_2/\\text{MWh}$。\n\n通过改变折扣因子 $\\delta$ 和碳预算 $B$ 来构建测试套件，以探究不同的情况：\n- 测试用例 1（在有折扣的情况下，预算约束在最小可行排放量上）：$\\delta = 0.95$，$B = e_F \\sum_{t=0}^{T-1} \\left( D_t - C^R_t \\right)$。这是在尽可能多地使用可再生能源发电以满足所有需求的情况下，最小的可行 $B$ 值。\n- 测试用例 2（在无折扣的情况下，使用中间预算）：$\\delta = 1.0$，$B = e_F \\left( \\sum_{t=0}^{T-1} \\left( D_t - C^R_t \\right) + 0.5 \\sum_{t=0}^{T-1} C^R_t \\right)$。该预算严格介于最小可行排放量和无约束排放水平之间，并且在无折扣的情况下，如果预算具有约束性，则隐含的影子价格预计将随时间保持不变。\n- 测试用例 3（宽松的碳预算）：$\\delta = 0.90$，$B = e_F \\sum_{t=0}^{T-1} D_t + 100$。该预算足够大，使得碳约束是松弛的，隐含的影子价格在所有时期都应为零。\n\n物理单位：\n- 以美元/吨二氧化碳（$\\$/\\text{tCO}_2$）为单位报告碳价格路径 $\\{\\pi_t\\}$，四舍五入到 $3$ 位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素本身都是一个包含 $4$ 个浮点数的方括号逗号分隔列表，按顺序对应每个测试用例的 $\\left[ \\pi_0, \\pi_1, \\pi_2, \\pi_3 \\right]$。例如，输出应类似于 $\\left[ [\\pi_0^{(1)},\\pi_1^{(1)},\\pi_2^{(1)},\\pi_3^{(1)}],[\\pi_0^{(2)},\\pi_1^{(2)},\\pi_2^{(2)},\\pi_3^{(2)}],[\\pi_0^{(3)},\\pi_1^{(3)},\\pi_2^{(3)},\\pi_3^{(3)}] \\right]$。",
            "solution": "我们从社会规划者问题的定义开始，该问题是一个关于 $T$ 个时期的线性规划，决策变量为 $\\{ g_{F,t}, g_{R,t} \\}_{t=0}^{T-1}$（单位：兆瓦时）。规划者最小化成本的现值，表示为\n$$\n\\min \\sum_{t=0}^{T-1} \\delta^t \\left( c_F \\, g_{F,t} + c_R \\, g_{R,t} \\right),\n$$\n并满足以下约束\n$$\ng_{F,t} + g_{R,t} = D_t \\quad \\forall t,\n$$\n$$\ng_{R,t} \\le C^R_t \\quad \\forall t,\n$$\n$$\n\\sum_{t=0}^{T-1} e_F \\, g_{F,t} \\le B,\n$$\n$$\ng_{F,t} \\ge 0, \\quad g_{R,t} \\ge 0 \\quad \\forall t.\n$$\n这些约束是线性的，且目标函数相对于决策变量也是线性的，因此该问题是一个线性规划。令 $\\lambda_t$ 为与需求约束 $g_{F,t} + g_{R,t} = D_t$ 相关的拉格朗日乘子，令 $\\eta_t \\ge 0$ 为可再生能源容量约束 $g_{R,t} \\le C^R_t$ 的乘子，令 $\\mu \\le 0$ 为累积碳预算约束 $\\sum_t e_F g_{F,t} \\le B$ 的乘子（在最小化问题的标准不等式约定下，“小于等于”约束具有非正乘子），并令 $\\phi_{F,t} \\ge 0$ 和 $\\phi_{R,t} \\ge 0$ 分别为 $g_{F,t}$ 和 $g_{R,t}$ 的非负性乘子。\n\n拉格朗日函数为\n$$\n\\mathcal{L} = \\sum_{t=0}^{T-1} \\delta^t (c_F g_{F,t} + c_R g_{R,t})\n+ \\sum_{t=0}^{T-1} \\lambda_t \\left( D_t - g_{F,t} - g_{R,t} \\right)\n+ \\sum_{t=0}^{T-1} \\eta_t \\left( g_{R,t} - C^R_t \\right)\n+ \\mu \\left( \\sum_{t=0}^{T-1} e_F g_{F,t} - B \\right)\n- \\sum_{t=0}^{T-1} \\phi_{F,t} g_{F,t}\n- \\sum_{t=0}^{T-1} \\phi_{R,t} g_{R,t}.\n$$\n关于 $g_{F,t}$ 和 $g_{R,t}$ 的平稳性条件对每个 $t$ 得出\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial g_{F,t}} = \\delta^t c_F - \\lambda_t + \\mu e_F - \\phi_{F,t} = 0,\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial g_{R,t}} = \\delta^t c_R - \\lambda_t + \\eta_t - \\phi_{R,t} = 0.\n$$\n互补松弛条件包括，对每个 $t$：\n$$\n\\eta_t \\ge 0,\\quad g_{R,t} \\le C^R_t,\\quad \\eta_t \\left( g_{R,t} - C^R_t \\right) = 0,\n$$\n$$\n\\mu \\le 0,\\quad \\sum_{t=0}^{T-1} e_F g_{F,t} \\le B,\\quad \\mu \\left( \\sum_{t=0}^{T-1} e_F g_{F,t} - B \\right) = 0,\n$$\n$$\n\\phi_{F,t} \\ge 0,\\quad g_{F,t} \\ge 0,\\quad \\phi_{F,t} g_{F,t} = 0,\n$$\n$$\n\\phi_{R,t} \\ge 0,\\quad g_{R,t} \\ge 0,\\quad \\phi_{R,t} g_{R,t} = 0.\n$$\n乘子 $\\mu$ 衡量了碳预算 $B$ 每放松一个单位时，现值最优目标值的边际变化。因为预算约束 $\\sum_t e_F g_{F,t} \\le B$ 未经折扣，其相关的拉格朗日乘子 $\\mu$ 的单位是现值美元/吨二氧化碳（$\\$/\\text{tCO}_2$），但它在平稳性条件中与折扣后的边际成本 $\\delta^t c_F$ 相加。要解释时期-$t$ 货币单位下的隐含碳影子价格，注意到在时期 $t$ 的边际权衡中，$g_{F,t}$ 的一个单位变化（使排放增加 $e_F$）等同于折扣成本 $\\delta^t c_F$ 的变化。通过折扣因子进行归一化，与最优性条件一致的特定时期碳价格是\n$$\n\\pi_t = -\\frac{\\mu}{\\delta^t},\n$$\n其中负号将标准不等式乘子约定（$\\mu \\le 0$）转换成一个正的影子价格，单位为美元/吨二氧化碳。如果碳预算约束是松弛的，则 $\\mu = 0$ 且对所有 $t$ 都有 $\\pi_t = 0$。\n\n算法步骤：\n1.  将线性规划编码，变量排序为 $\\left( g_{F,0}, \\dots, g_{F,T-1}, g_{R,0}, \\dots, g_{R,T-1} \\right)$。目标系数向量在适当位置放置化石燃料变量的 $\\delta^t c_F$ 和可再生能源变量的 $\\delta^t c_R$。\n2.  为每个 $t$ 实现等式约束 $g_{F,t} + g_{R,t} = D_t$。为每个 $t$ 实现不等式约束 $g_{R,t} \\le C^R_t$，以及单个累积碳预算约束 $\\sum_t e_F g_{F,t} \\le B$。\n3.  使用一种能返回等式和不等式约束对偶信息的稳健方法求解线性规划。对于每个测试用例，通过选择与可再生能源容量限制和需求相符的 $B$ 来确保可行性。\n4.  提取碳预算不等式的拉格朗日乘子（对偶）。在最小化问题的标准“小于等于”形式下，求解器对有约束力的约束返回一个非正乘子，对松弛约束返回零。将此乘子记为 $\\mu$。\n5.  计算隐含的特定时期碳影子价格路径为 $\\pi_t = -\\mu / \\delta^t$，单位为美元/吨二氧化碳，并将每个 $\\pi_t$ 四舍五入到 $3$ 位小数。\n6.  将测试套件的结果汇总成指定的单行输出格式。\n\n在设计的测试中的解释：\n- 在测试用例 1 中，预算等于最小可行排放量，迫使可再生能源的使用最大化。当 $\\delta \\in (0,1)$ 时，现值权重使得未来成本的权重较小，因此隐含的碳价格路径 $\\pi_t$ 根据 $1/\\delta^t$ 归一化而随时间上升。\n- 在测试用例 2 中，当 $\\delta = 1$ 时，如果预算有约束力，则隐含的碳价格在时间上是恒定的，因为没有折扣，现值与时期成本一致。\n- 在测试用例 3 中，预算宽松，约束松弛，这意味着 $\\mu = 0$，因此对所有 $t$ 都有 $\\pi_t = 0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef compute_shadow_price_path(delta, B, D, cap_R, c_F, c_R, e_F):\n    \"\"\"\n    Solve the LP for given parameters and return the implied period-specific carbon price path.\n    Prices are in $/tCO2 for periods t=0..T-1.\n    \"\"\"\n    T = len(D)\n    # Variable ordering: [gF_0, ..., gF_{T-1}, gR_0, ..., gR_{T-1}]\n    n_vars = 2 * T\n\n    # Objective coefficients: discounted costs\n    c = np.zeros(n_vars, dtype=float)\n    for t in range(T):\n        c[t] = (delta ** t) * c_F\n        c[T + t] = (delta ** t) * c_R\n\n    # Equality constraints: gF_t + gR_t = D_t\n    A_eq = np.zeros((T, n_vars), dtype=float)\n    b_eq = np.array(D, dtype=float)\n    for t in range(T):\n        A_eq[t, t] = 1.0          # gF_t\n        A_eq[t, T + t] = 1.0      # gR_t\n\n    # Inequality constraints:\n    # 1) Renewable capacity: gR_t = cap_R[t]\n    # 2) Carbon budget: sum_t e_F * gF_t = B\n    A_ub = np.zeros((T + 1, n_vars), dtype=float)\n    b_ub = np.zeros(T + 1, dtype=float)\n\n    # Renewable capacity constraints\n    for t in range(T):\n        A_ub[t, T + t] = 1.0\n        b_ub[t] = cap_R[t]\n\n    # Carbon budget constraint (last inequality)\n    for t in range(T):\n        A_ub[T, t] = e_F\n    b_ub[T] = B\n\n    # Bounds: gF_t >= 0, gR_t >= 0 (no explicit upper bounds on fossil)\n    bounds = [(0, None)] * n_vars\n\n    # Solve LP using HiGHS\n    res = linprog(c, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq,\n                  bounds=bounds, method='highs')\n\n    if not res.success:\n        # In case of numerical issues or infeasibility, return NaNs\n        return [float('nan')] * T\n\n    # Extract the dual (Lagrange multiplier) for the carbon budget inequality.\n    # SciPy (HiGHS) returns inequality multipliers in res.ineqlin.marginals for A_ub @ x = b_ub,\n    # with the convention that binding constraints in a minimization have nonpositive multipliers.\n    try:\n        duals_ub = res.ineqlin.marginals\n        mu = duals_ub[-1]  # Carbon budget is the last inequality\n    except Exception:\n        # Fallback: if the structure isn't present (shouldn't happen), set mu=0\n        mu = 0.0\n\n    # Implied carbon price path in period-t currency: pi_t = -mu / delta^t\n    # Ensure that tiny numerical noise does not produce negative zeros, clamp near-zero to zero.\n    prices = []\n    for t in range(T):\n        denom = (delta ** t)\n        # Avoid division by zero if delta=0 (not allowed by problem specification), but safeguard.\n        if denom == 0.0:\n            pi_t = float('inf')\n        else:\n            pi_t = -mu / denom\n        # Clean small numerical artifacts\n        if abs(pi_t)  1e-9:\n            pi_t = 0.0\n        # Round to 3 decimals\n        pi_t = float(f\"{pi_t:.3f}\")\n        prices.append(pi_t)\n\n    return prices\n\ndef solve():\n    # Fixed parameters across all tests\n    T = 4\n    D = [100.0, 110.0, 120.0, 130.0]          # MWh\n    cap_R = [50.0, 60.0, 70.0, 80.0]          # MWh\n    c_F = 30.0                                # $/MWh\n    c_R = 60.0                                # $/MWh\n    e_F = 0.9                                 # tCO2/MWh\n\n    # Helper quantities for budgets\n    sum_D = sum(D)\n    sum_cap_R = sum(cap_R)\n    min_emissions_budget = e_F * sum((D[t] - cap_R[t]) for t in range(T))  # minimum feasible B\n\n    # Test suite:\n    # 1) Binding at minimum feasible emissions with discounting\n    delta1 = 0.95\n    B1 = min_emissions_budget\n\n    # 2) Intermediate budget without discounting (between min and max emissions)\n    delta2 = 1.0\n    B2 = e_F * (sum((D[t] - cap_R[t]) for t in range(T)) + 0.5 * sum_cap_R)\n\n    # 3) Loose carbon budget (constraint slack)\n    delta3 = 0.90\n    B3 = e_F * sum_D + 100.0\n\n    test_cases = [\n        (delta1, B1),\n        (delta2, B2),\n        (delta3, B3),\n    ]\n\n    results = []\n    for (delta, B) in test_cases:\n        prices = compute_shadow_price_path(delta, B, D, cap_R, c_F, c_R, e_F)\n        results.append(prices)\n\n    # Format as specified: a single line, list of lists with 4 floats each\n    # Convert inner lists to string with bracketed comma-separated floats\n    inner_strs = []\n    for lst in results:\n        inner_strs.append(f\"[{','.join(map(lambda x: f'{x:.3f}', lst))}]\")\n    print(f\"[{','.join(inner_strs)}]\")\n\nsolve()\n```"
        }
    ]
}