{
    "hands_on_practices": [
        {
            "introduction": "储能是实现电网脱碳的关键技术，但其环境效益并非一成不变，而是高度依赖其充放电行为。本练习将通过计算电池在特定电网情景下的净二氧化碳影响，来深入探讨这一问题。通过完成此练习 ，您将掌握基于边际排放进行系统级评估的关键技能，超越对技术“清洁”或“肮脏”的简单化标签，理解技术在系统中的实际环境价值。",
            "id": "4088600",
            "problem": "考虑一个连接到交流电网的电化学电池。在非高峰时段，边际发电机组是亚临界燃煤机组；在高峰时段，边际发电机组是天然气简单循环燃气轮机。该电池在非高峰时段充电，在高峰时段放电。假设以下数据和约定，均基于高热值：燃煤机组的发电效率为 $\\eta_{c} = 0.38$，燃气轮机的发电效率为 $\\eta_{g} = 0.40$，煤炭的二氧化碳排放因子为 $EF_{c} = 94.6$ kg CO$_2$/GJ 燃料，天然气的二氧化碳排放因子为 $EF_{g} = 56.1$ kg CO$_2$/GJ 燃料，电池的交流-交流往返效率为 $\\eta_{rt} = 0.90$。忽略非二氧化碳的温室气体、启动瞬态过程、上游排放，以及除发电机效率中已隐含的之外的任何输配电损失。使用能量转换恒等式 $1$ MWh $= 3.6$ GJ。\n\n从能量守恒的第一性原理和排放强度（定义为燃料二氧化碳排放因子乘以热耗率）出发，计算电池每输送 $1$ MWh 高峰电力所产生的净运行二氧化碳影响。将净运行二氧化碳影响定义为：为供应充电能量而排放的煤炭二氧化碳，减去在放电期间被替代的燃气轮机发电本应排放的二氧化碳。以 kg CO$_2$/MWh 为单位表示最终结果，并四舍五入到三位有效数字。",
            "solution": "该问题是有效的，因为它在科学上基于能量转换和热力学原理，问题陈述清晰，数据充分且一致，并以客观、正式的语言表达。因此，我们可以着手求解。\n\n目标是计算电池每输送 $1$ MWh 高峰电力所产生的净运行二氧化碳影响。该影响定义为：为供应充电能量而排放的 CO$_2$，减去被替代的高峰发电机组本应排放的 CO$_2$。\n\n设 $E_{\\text{out}}$ 为电池在高峰时段输送的电能。我们需要计算当 $E_{\\text{out}} = 1$ MWh 时的净 CO$_2$ 影响。\n\n首先，我们根据第一性原理确定必要的物理量及其关系。给出的能量转换恒等式为 $1$ MWh $= 3.6$ GJ。我们用 $C = 3.6$ GJ/MWh 表示这个转换因子。因此，电池输送的能量（以吉焦为单位）为：\n$$E_{\\text{out,GJ}} = E_{\\text{out}} \\times C = (1 \\text{ MWh}) \\times (3.6 \\frac{\\text{GJ}}{\\text{MWh}}) = 3.6 \\text{ GJ}$$\n\n该过程包括两个主要部分：电池充电产生的排放和放电避免的排放。\n\n1.  **充电产生的 CO$_2$ 排放：**\n    电池在非高峰时段使用来自燃煤机组的电力充电。为了输送 $E_{\\text{out}}$ 的电能，由于损耗，电池必须充入更多的能量 $E_{\\text{in}}$。该关系由交流-交流往返效率 $\\eta_{rt} = 0.90$ 决定。\n    $$E_{\\text{in}} = \\frac{E_{\\text{out,GJ}}}{\\eta_{rt}}$$\n    代入数值：\n    $$E_{\\text{in}} = \\frac{3.6 \\text{ GJ}}{0.90} = 4.0 \\text{ GJ}$$\n    这些电能 $E_{\\text{in}}$ 由边际燃煤机组产生，其发电效率为 $\\eta_{c} = 0.38$。生产 $E_{\\text{in}}$ 所需的煤炭燃料能量 $F_{c}$ 为：\n    $$F_{c} = \\frac{E_{\\text{in}}}{\\eta_{c}} = \\frac{4.0 \\text{ GJ}}{0.38}$$\n    充电产生的 CO$_2$ 排放量 $M_{c}$ 通过将消耗的燃料能量 $F_{c}$ 乘以煤炭的二氧化碳排放因子 $EF_{c} = 94.6$ kg CO$_2$/GJ 计算得出。\n    $$M_{c} = F_{c} \\times EF_{c} = \\left(\\frac{4.0}{0.38}\\right) \\text{ GJ} \\times 94.6 \\frac{\\text{kg CO}_2}{\\text{GJ}}$$\n    $$M_{c} = \\frac{4.0 \\times 94.6}{0.38} \\text{ kg CO}_2 \\approx 995.789 \\text{ kg CO}_2$$\n\n2.  **放电避免的 CO$_2$ 排放：**\n    在高峰时段，电池放电 $E_{\\text{out,GJ}} = 3.6$ GJ，替代了天然气简单循环燃气轮机的发电。我们计算如果由燃气轮机生产这些能量本应产生的 CO$_2$ 排放。\n    燃气轮机的发电效率为 $\\eta_{g} = 0.40$。生产 $E_{\\text{out,GJ}}$ 本应需要的天然气燃料能量 $F_{g}$ 为：\n    $$F_{g} = \\frac{E_{\\text{out,GJ}}}{\\eta_{g}} = \\frac{3.6 \\text{ GJ}}{0.40} = 9.0 \\text{ GJ}$$\n    避免的 CO$_2$ 排放量 $M_{g}$ 通过将该燃料能量 $F_{g}$ 乘以天然气的二氧化碳排放因子 $EF_{g} = 56.1$ kg CO$_2$/GJ 计算得出。\n    $$M_{g} = F_{g} \\times EF_{g} = 9.0 \\text{ GJ} \\times 56.1 \\frac{\\text{kg CO}_2}{\\text{GJ}}$$\n    $$M_{g} = 504.9 \\text{ kg CO}_2$$\n\n3.  **净运行 CO$_2$ 影响：**\n    净影响 $\\Delta M_{\\text{CO}_2}$ 是充电产生的排放与避免的排放之差。\n    $$\\Delta M_{\\text{CO}_2} = M_{c} - M_{g}$$\n    $$\\Delta M_{\\text{CO}_2} \\approx 995.789 \\text{ kg CO}_2 - 504.9 \\text{ kg CO}_2 \\approx 490.889 \\text{ kg CO}_2$$\n    这是输送 $1$ MWh 电力的净影响。要求的单位是 kg CO$_2$/MWh。我们的结果已经是这个形式。\n\n    将所有步骤合并为每个 MWh 净影响的单个解析表达式：\n    $$\\Delta M_{\\text{CO}_2} = C \\left( \\frac{EF_c}{\\eta_{rt} \\eta_c} - \\frac{EF_g}{\\eta_g} \\right)$$\n    $$\\Delta M_{\\text{CO}_2} = 3.6 \\left( \\frac{94.6}{0.90 \\times 0.38} - \\frac{56.1}{0.40} \\right) \\frac{\\text{kg CO}_2}{\\text{MWh}}$$\n    $$\\Delta M_{\\text{CO}_2} = 3.6 \\left( \\frac{94.6}{0.342} - 140.25 \\right) \\frac{\\text{kg CO}_2}{\\text{MWh}}$$\n    $$\\Delta M_{\\text{CO}_2} \\approx 3.6 \\left( 276.608 - 140.25 \\right) \\frac{\\text{kg CO}_2}{\\text{MWh}}$$\n    $$\\Delta M_{\\text{CO}_2} \\approx 3.6 \\left( 136.358 \\right) \\frac{\\text{kg CO}_2}{\\text{MWh}} \\approx 490.889 \\frac{\\text{kg CO}_2}{\\text{MWh}}$$\n\n最后，我们根据题目要求将结果四舍五入到三位有效数字。\n$$\\Delta M_{\\text{CO}_2} \\approx 491 \\frac{\\text{kg CO}_2}{\\text{MWh}}$$",
            "answer": "$$\\boxed{491}$$"
        },
        {
            "introduction": "监管机构通常采用排放总量上限来限制电力行业的污染。本练习将展示一个排放上限如何迫使系统运营商偏离简单的最低成本调度方案，从而为排放行为赋予一个隐含的经济成本。通过解决这个经典的经济调度问题 ，您将学会计算碳的影子价格，这是代表为满足环境约束而产生的边际减排成本的一个基本概念。",
            "id": "4088528",
            "problem": "一个区域系统运营商寻求在满足需求、容量和有约束力的累积排放上限的条件下，最小化两个时期的总发电成本。有两个火力发电机组，索引为 $i \\in \\{1,2\\}$，以及两个时期，索引为 $t \\in \\{1,2\\}$。设 $x_{i,t}$ 表示机组 $i$ 在时期 $t$ 提供的能量，单位为兆瓦时。运营商的目标是最小化总可变发电成本，同时需满足各时期的需求，遵守各时期的容量限制，并且不超过二氧化碳（CO2）的累积排放上限。\n\n基本建模假设：\n- 机组 $i$ 的单位能量可变成本为 $c_i$ 美元/兆瓦时。\n- 机组 $i$ 的排放强度为 $e_i$ 吨二氧化碳/兆瓦时。\n- 机组 $i$ 的各时期容量为 $K_i$ 兆瓦时。\n- 各时期需求为 $D_1$ 和 $D_2$ 兆瓦时。\n- 两个时期的累积排放上限为 $E^{\\max}$ 吨二氧化碳。\n- 无启动成本、爬坡限制或输电约束；损耗可忽略不计；系统是完全竞争的。\n\n数据：\n- 成本：$c_1 = 20$, $c_2 = 35$。\n- 排放强度：$e_1 = 0.9$, $e_2 = 0.1$。\n- 各时期容量：$K_1 = 60$, $K_2 = 60$。\n- 需求：$D_1 = 80$, $D_2 = 60$。\n- 排放上限：$E^{\\max} = 90$。\n\n使用标准线性规划成本最小化方法建立运营商问题的模型，决策变量为 $x_{i,t}$，需求平衡约束为 $\\sum_{i} x_{i,t} = D_t$，容量约束为 $0 \\le x_{i,t} \\le K_i$，累积排放约束为 $\\sum_{t} \\sum_{i} e_i x_{i,t} \\le E^{\\max}$。将排放上限的影子价格 $\\lambda^{\\star}$ 定义为最优解下与累积排放约束相关的 Lagrange 乘子。从这个模型和约束优化的第一性原理出发，计算 $\\lambda^{\\star}$，并确定当排放上限具有约束力时，相对于无约束的最低成本调度，哪个机组被替代。对于被替代的机组，如果机组1被替代，则报告索引1；如果机组2被替代，则报告索引2。\n\n以包含两个条目的行矩阵形式提供您的最终数值答案 $\\begin{pmatrix} \\lambda^{\\star}  i_{\\text{displaced}} \\end{pmatrix}$。将 $\\lambda^{\\star}$ 四舍五入到四位有效数字。以美元/吨二氧化碳为单位表示影子价格。第二个条目必须是1或2，且没有单位。",
            "solution": "该问题是能源系统建模中一个标准的、适定的线性规划问题。所有数据和定义都清晰一致。该问题具有科学依据和客观性。它是有效的。\n\n运营商的问题是最小化两个发电机组 $i \\in \\{1,2\\}$ 在两个时期 $t \\in \\{1,2\\}$ 的总发电成本 $Z$。决策变量是 $x_{i,t}$，即机组 $i$ 在时期 $t$ 的发电量。\n\n目标函数是：\n$$ \\min_{x_{i,t}} Z = \\sum_{t=1}^{2} \\sum_{i=1}^{2} c_i x_{i,t} = c_1 x_{1,1} + c_2 x_{2,1} + c_1 x_{1,2} + c_2 x_{2,2} $$\n\n这受以下约束条件的限制：\n1.  时期1的需求平衡：$x_{1,1} + x_{2,1} = D_1$\n2.  时期2的需求平衡：$x_{1,2} + x_{2,2} = D_2$\n3.  机组1的容量限制：$0 \\le x_{1,1} \\le K_1$ 和 $0 \\le x_{1,2} \\le K_1$\n4.  机组2的容量限制：$0 \\le x_{2,1} \\le K_2$ 和 $0 \\le x_{2,2} \\le K_2$\n5.  累积排放上限：$\\sum_{t=1}^{2} \\sum_{i=1}^{2} e_i x_{i,t} \\le E^{\\max}$\n\n首先，我们通过忽略排放约束来确定无约束的最低成本调度。在每个时期，发电量按可变成本的优先顺序（merit order）进行调度，从最便宜到最昂贵。这里，$c_1 = 20\\ \\$/\\text{MWh}$ 且 $c_2 = 35\\ \\$/\\text{MWh}$，所以机组1总是在机组2之前被调度。\n\n对于时期1，需求 $D_1 = 80$ MWh：\n机组1被调度至其容量 $K_1 = 60$ MWh。所以，$x_{1,1}^{\\text{unc}} = 60$。\n剩余需求为 $D_1 - K_1 = 80 - 60 = 20$ MWh。\n机组2被调度以满足剩余需求。$x_{2,1}^{\\text{unc}} = 20$。这在其容量 $K_2 = 60$ 范围内。\n\n对于时期2，需求 $D_2 = 60$ MWh：\n机组1被调度以满足全部需求，因为 $D_2 \\le K_1$。所以，$x_{1,2}^{\\text{unc}} = 60$。\n不需要机组2。所以，$x_{2,2}^{\\text{unc}} = 0$。\n\n该无约束调度的总排放为：\n$$ E^{\\text{unc}} = e_1 x_{1,1}^{\\text{unc}} + e_2 x_{2,1}^{\\text{unc}} + e_1 x_{1,2}^{\\text{unc}} + e_2 x_{2,2}^{\\text{unc}} $$\n$$ E^{\\text{unc}} = (0.9)(60) + (0.1)(20) + (0.9)(60) + (0.1)(0) = 54 + 2 + 54 = 110 \\text{ 吨} $$\n排放上限为 $E^{\\max} = 90$ 吨。由于 $E^{\\text{unc}} > E^{\\max}$，排放约束具有约束力。\n\n为了满足上限，系统必须减少排放。这是通过将发电从高排放机组重新调度到低排放机组来实现的。机组1的排放强度为 $e_1=0.9$，机组2为 $e_2=0.1$。因此，必须减少机组1的发电量，并用机组2的发电量来替代。这种替代会增加总成本。\n\n排放上限的影子价格 $\\lambda^{\\star}$ 是边际减排成本。它是一吨减排所带来的总成本增加量。当我们用机组2的发电量替代机组1的 $\\Delta x$ MWh 发电量时，成本变化为 $\\Delta C = (c_2 - c_1) \\Delta x$，排放变化为 $\\Delta E = (e_2 - e_1) \\Delta x$。\n边际减排成本是边际成本增加与边际减排量的比率：\n$$ \\lambda^{\\star} = \\frac{\\Delta C}{-\\Delta E} = \\frac{(c_2 - c_1)\\Delta x}{-(e_2 - e_1)\\Delta x} = \\frac{c_2 - c_1}{e_1 - e_2} $$\n代入给定值：\n$$ \\lambda^{\\star} = \\frac{35 - 20}{0.9 - 0.1} = \\frac{15}{0.8} = 18.75 $$\n单位是 $(\\$/\\text{MWh}) / (\\text{吨}/\\text{MWh}) = \\$/\\text{吨}$。影子价格是 $\\lambda^{\\star} = 18.75$ 美元/吨二氧化碳。问题要求四舍五入到四位有效数字。数字 $18.75$ 有四位有效数字（$1, 8, 7, 5$），因此无需四舍五入。\n\n问题的第二部分询问哪个机组被替代。无约束的最低成本调度最大化了最便宜发电机组（机组1）的使用。当施加具有约束力的排放上限时，必须将发电量从高排放机组（1）转移到低排放机组（2）以减少总排放。这意味着机组1的发电量 $x_{1,1} + x_{1,2}$ 相对于其最低成本调度水平减少，而机组2的发电量 $x_{2,1} + x_{2,2}$ 增加。因此，机组1是“被替代”的机组。被替代机组的索引是 $i_{\\text{displaced}}=1$。\n\n为了验证，所需的减排量为 $110 - 90 = 20$ 吨。从机组1转移到机组2的发电量 $\\Delta x_{\\text{shift}}$ 为：\n$$ \\Delta x_{\\text{shift}} = \\frac{\\text{总减排量}}{e_1 - e_2} = \\frac{20}{0.8} = 25 \\text{ MWh} $$\n在有约束的情况下，机组1的总发电量为 $x_{1}^{\\text{con}} = (x_{1,1}^{\\text{unc}} + x_{1,2}^{\\text{unc}}) - 25 = 120 - 25 = 95$ MWh。机组2的总发电量为 $x_{2}^{\\text{con}} = (x_{2,1}^{\\text{unc}} + x_{2,2}^{\\text{unc}}) + 25 = 20 + 25 = 45$ MWh。\n显然，机组1的输出量从无约束最优值减少了（被替代）。\n\n最终答案由影子价格 $\\lambda^{\\star}$ 和被替代机组的索引 $i_{\\text{displaced}}$ 组成。\n$\\lambda^{\\star} = 18.75$\n$i_{\\text{displaced}} = 1$",
            "answer": "$$\\boxed{\\begin{pmatrix} 18.75  1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "长期的气候目标通常被设定为一个累积的“碳预算”。本练习将静态优化问题扩展到一个动态的多周期规划模型中，揭示了在一个有预算约束的世界里，排放许可的价值应如何随时间演变。这项计算练习  将为您提供构建和解释正式能源系统优化模型的实践经验，并推导出动态有效的碳价格路径 $\\pi_t$，这是气候政策分析的基石。",
            "id": "4088532",
            "problem": "考虑一个电力系统的跨期调度规划问题，该系统包含两种发电技术，时间跨度为 $T$ 个离散时间周期 $t \\in \\{0,1,\\dots,T-1\\}$。技术 $F$ (化石燃料) 具有恒定的可变发电成本 $c_F$，单位为美元/兆瓦时 ($\\$/\\text{MWh}$)，以及恒定的排放强度 $e_F$，单位为吨二氧化碳/兆瓦时 ($\\text{tCO}_2/\\text{MWh}$)。技术 $R$ (可再生能源) 具有恒定的可变发电成本 $c_R$，单位为美元/兆瓦时 ($\\$/\\text{MWh}$)，并且排放强度为零。可再生能源技术在每个周期有容量上限 $C^R_t$，单位为兆瓦时 ($\\text{MWh}$)。假设化石燃料技术除了非负性约束外，没有约束性的容量上限。周期 $t$ 的电力需求为 $D_t$，单位为兆瓦时 ($\\text{MWh}$)。令 $g_{F,t}$ 和 $g_{R,t}$ 分别表示在周期 $t$ 化石燃料和可再生能源技术的发电量，单位为兆瓦时 ($\\text{MWh}$)。\n\n一位社会规划者使用每个周期的时间折扣因子 $\\delta \\in (0,1]$ 来最小化总发电成本的现值，其约束条件为：在每个周期都满足电力需求、遵守可再生能源的容量上限、发电量非负，以及在整个规划期内遵守一个硬性的累积碳预算 $B$，单位为吨二氧化碳 ($\\text{tCO}_2$) 。形式上，该规划者求解以下线性规划问题：\n最小化现值成本\n$$\n\\min_{\\{g_{F,t}, g_{R,t}\\}_{t=0}^{T-1}} \\sum_{t=0}^{T-1} \\delta^t \\left( c_F \\, g_{F,t} + c_R \\, g_{R,t} \\right)\n$$\n受以下约束\n$$\ng_{F,t} + g_{R,t} = D_t \\quad \\text{for all } t \\in \\{0,1,\\dots,T-1\\},\n$$\n$$\ng_{R,t} \\leq C^R_t \\quad \\text{for all } t \\in \\{0,1,\\dots,T-1\\},\n$$\n$$\n\\sum_{t=0}^{T-1} e_F \\, g_{F,t} \\leq B,\n$$\n$$\ng_{F,t} \\geq 0, \\quad g_{R,t} \\geq 0 \\quad \\text{for all } t \\in \\{0,1,\\dots,T-1\\}.\n$$\n\n根据凸优化和拉格朗日对偶的基本原理，与累积碳预算约束相关的拉格朗日乘子量化了将预算边际放松所带来的影子价值。鉴于目标函数使用了时间贴现成本 $\\delta^t$，以周期 $t$ 的货币单位计量的、隐含的特定周期碳影子价格（单位为美元/吨二氧化碳，$\\$/\\text{tCO}_2$）是预算乘子除以折扣因子进行归一化后的值。本问题的目标是计算最优计划，并分析隐含的碳影子价格 $\\{\\pi_t\\}_{t=0}^{T-1}$ 的时间剖面，其中每个 $\\pi_t$ 定义为与最优解一致的周期 $t$ 的碳价格。\n\n你的程序必须：\n- 使用可靠的线性规划求解器，为给定参数建立并求解该线性规划问题。\n- 提取与累积碳预算约束相关的对偶变量（拉格朗日乘子）$\\,\\mu\\,$。\n- 对每个 $t \\in \\{0,1,\\dots,T-1\\}$，计算隐含的特定周期碳影子价格路径 $\\pi_t = -\\mu / \\delta^t$，单位为美元/吨二氧化碳 ($\\$/\\text{tCO}_2$)。\n- 将每个 $\\pi_t$ 四舍五入到 $3$ 位小数。\n\n在所有测试用例中使用以下固定参数值：\n- 周期数: $T = 4$。\n- 需求: $D_0 = 100\\,\\text{MWh}$, $D_1 = 110\\,\\text{MWh}$, $D_2 = 120\\,\\text{MWh}$, $D_3 = 130\\,\\text{MWh}$。\n- 可再生能源容量上限: $C^R_0 = 50\\,\\text{MWh}$, $C^R_1 = 60\\,\\text{MWh}$, $C^R_2 = 70\\,\\text{MWh}$, $C^R_3 = 80\\,\\text{MWh}$。\n- 成本: $c_F = 30\\,\\$/\\text{MWh}$, $c_R = 60\\,\\$/\\text{MWh}$。\n- 排放强度: $e_F = 0.9\\,\\text{tCO}_2/\\text{MWh}$。\n\n通过改变折扣因子 $\\delta$ 和碳预算 $B$ 来构建一个测试套件，以探究不同的情景：\n- 测试用例 1 (在有贴现的情况下，约束在最小可行排放量上是紧的)：$\\delta = 0.95$, $B = e_F \\sum_{t=0}^{T-1} \\left( D_t - C^R_t \\right)$。这是在尽可能多地使用可再生能源发电来满足所有需求的情况下，最小的可行 $B$ 值。\n- 测试用例 2 (无贴现情况下的中间预算)：$\\delta = 1.0$, $B = e_F \\left( \\sum_{t=0}^{T-1} \\left( D_t - C^R_t \\right) + 0.5 \\sum_{t=0}^{T-1} C^R_t \\right)$。该预算严格介于最小可行排放水平和无约束排放水平之间，在没有贴现的情况下，如果预算是紧约束，则隐含的影子价格预计会随时间保持不变。\n- 测试用例 3 (宽松的碳预算)：$\\delta = 0.90$, $B = e_F \\sum_{t=0}^{T-1} D_t + 100$。该预算足够大，使得碳约束是松弛的，因此所有周期内的隐含影子价格都应为零。\n\n物理单位：\n- 报告碳价格路径 $\\{\\pi_t\\}$，单位为美元/吨二氧化碳 ($\\$/\\text{tCO}_2$)，并四舍五入到 3 位小数。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。列表中的每个元素本身也是一个由方括号括起来的逗号分隔列表，包含 4 个浮点数，按顺序对应每个测试用例的 $\\left[ \\pi_0, \\pi_1, \\pi_2, \\pi_3 \\right]$。例如，输出应类似于 $\\left[ [\\pi_0^{(1)},\\pi_1^{(1)},\\pi_2^{(1)},\\pi_3^{(1)}],[\\pi_0^{(2)},\\pi_1^{(2)},\\pi_2^{(2)},\\pi_3^{(2)}],[\\pi_0^{(3)},\\pi_1^{(3)},\\pi_2^{(3)},\\pi_3^{(3)}] \\right]$。",
            "solution": "我们从社会规划者问题的定义开始，这是一个跨越 $T$ 个周期的线性规划问题，其决策变量为兆瓦时单位的 $\\{ g_{F,t}, g_{R,t} \\}_{t=0}^{T-1}$。规划者最小化成本的现值，表示为\n$$\n\\min \\sum_{t=0}^{T-1} \\delta^t \\left( c_F \\, g_{F,t} + c_R \\, g_{R,t} \\right),\n$$\n受以下约束\n$$\ng_{F,t} + g_{R,t} = D_t \\quad \\forall t,\n$$\n$$\ng_{R,t} \\leq C^R_t \\quad \\forall t,\n$$\n$$\n\\sum_{t=0}^{T-1} e_F \\, g_{F,t} \\leq B,\n$$\n$$\ng_{F,t} \\geq 0, \\quad g_{R,t} \\geq 0 \\quad \\forall t.\n$$\n这些约束是线性的，目标函数对于决策变量也是线性的，因此该问题是一个线性规划问题。令 $\\lambda_t$ 为与需求约束 $g_{F,t} + g_{R,t} = D_t$ 相关联的拉格朗日乘子，令 $\\eta_t \\geq 0$ 为可再生能源容量约束 $g_{R,t} \\leq C^R_t$ 的乘子，令 $\\mu \\leq 0$ 为累积碳预算约束 $\\sum_t e_F g_{F,t} \\leq B$ 的乘子（根据最小化问题的标准不等式约定，“小于等于”约束具有非正乘子），并令 $\\phi_{F,t} \\geq 0$ 和 $\\phi_{R,t} \\geq 0$ 分别为 $g_{F,t}$ 和 $g_{R,t}$ 的非负性乘子。\n\n拉格朗日函数为\n$$\n\\mathcal{L} = \\sum_{t=0}^{T-1} \\delta^t (c_F g_{F,t} + c_R g_{R,t})\n+ \\sum_{t=0}^{T-1} \\lambda_t \\left( D_t - g_{F,t} - g_{R,t} \\right)\n+ \\sum_{t=0}^{T-1} \\eta_t \\left( g_{R,t} - C^R_t \\right)\n+ \\mu \\left( \\sum_{t=0}^{T-1} e_F g_{F,t} - B \\right)\n- \\sum_{t=0}^{T-1} \\phi_{F,t} g_{F,t}\n- \\sum_{t=0}^{T-1} \\phi_{R,t} g_{R,t}.\n$$\n对于每个 $t$，关于 $g_{F,t}$ 和 $g_{R,t}$ 的定常性条件得出：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial g_{F,t}} = \\delta^t c_F - \\lambda_t + \\mu e_F - \\phi_{F,t} = 0,\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial g_{R,t}} = \\delta^t c_R - \\lambda_t + \\eta_t - \\phi_{R,t} = 0.\n$$\n互补松弛条件包括，对于每个 $t$：\n$$\n\\eta_t \\geq 0,\\quad g_{R,t} \\leq C^R_t,\\quad \\eta_t \\left( g_{R,t} - C^R_t \\right) = 0,\n$$\n$$\n\\mu \\leq 0,\\quad \\sum_{t=0}^{T-1} e_F g_{F,t} \\leq B,\\quad \\mu \\left( \\sum_{t=0}^{T-1} e_F g_{F,t} - B \\right) = 0,\n$$\n$$\n\\phi_{F,t} \\geq 0,\\quad g_{F,t} \\geq 0,\\quad \\phi_{F,t} g_{F,t} = 0,\n$$\n$$\n\\phi_{R,t} \\geq 0,\\quad g_{R,t} \\geq 0,\\quad \\phi_{R,t} g_{R,t} = 0.\n$$\n乘子 $\\mu$ 度量了碳预算 $B$ 每放松一个单位时，现值最优目标函数的边际变化。由于预算约束 $\\sum_t e_F g_{F,t} \\leq B$ 中没有贴现，其相关的拉格朗日乘子 $\\mu$ 的单位是现值美元/吨二氧化碳 ($\\$/\\text{tCO}_2$)，但在定常性条件中，它与贴现后的边际成本 $\\delta^t c_F$ 是加性关系。为了以周期 $t$ 的货币单位来解释隐含的碳影子价格，请注意，在周期 $t$ 的边际权衡中，$g_{F,t}$ 一个单位的变化（这将使排放增加 $e_F$）等同于贴现成本 $\\delta^t c_F$ 的变化。通过折扣因子进行归一化，与最优性条件一致的特定周期碳价格为\n$$\n\\pi_t = -\\frac{\\mu}{\\delta^t},\n$$\n其中负号将标准的不等式乘子约定（$\\mu \\leq 0$）转换为了一个正的影子价格，单位为美元/吨二氧化碳。如果碳预算约束是松弛的，那么 $\\mu = 0$ 且对所有 $t$ 都有 $\\pi_t = 0$。\n\n算法步骤：\n1. 将线性规划问题编码，变量排序为 $\\left( g_{F,0}, \\dots, g_{F,T-1}, g_{R,0}, \\dots, g_{R,T-1} \\right)$。目标系数向量将化石燃料变量的 $\\delta^t c_F$ 和可再生能源变量的 $\\delta^t c_R$ 放置在相应位置。\n2. 实现等式约束 $g_{F,t} + g_{R,t} = D_t$（对每个 $t$），不等式约束 $g_{R,t} \\leq C^R_t$（对每个 $t$），以及单一的累积碳预算约束 $\\sum_t e_F g_{F,t} \\leq B$。\n3. 使用一种能返回等式和不等式约束对偶信息的鲁棒方法来求解线性规划。对于每个测试用例，通过选择与可再生能源容量上限和需求一致的 $B$ 来确保可行性。\n4. 提取碳预算不等式的拉格朗日乘子（对偶变量）。在最小化问题的标准“小于等于”表述下，求解器对于紧约束返回一个非正乘子，对于松弛约束返回零。将此乘子表示为 $\\mu$。\n5. 计算隐含的特定周期碳影子价格路径 $\\pi_t = -\\mu / \\delta^t$，单位为美元/吨二氧化碳，并将每个 $\\pi_t$ 四舍五入到 3 位小数。\n6. 将测试套件的结果汇总成指定的单行输出格式。\n\n设计测试的解释：\n- 在测试用例 1 中，预算等于最小可行排放量，强制最大限度地使用可再生能源。由于 $\\delta \\in (0,1)$，现值加权使得未来成本的权重降低，因此隐含的碳价格路径 $\\pi_t$ 会根据 $1/\\delta^t$ 的归一化而随时间上升。\n- 在测试用例 2 中，当 $\\delta = 1$ 时，如果预算是紧约束，则隐含的碳价格在时间上是恒定的，因为在没有贴现的情况下，现值成本和周期成本是一致的。\n- 在测试用例 3 中，预算是宽松的，约束是松弛的，这意味着 $\\mu = 0$，因此对所有 $t$ 都有 $\\pi_t = 0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef compute_shadow_price_path(delta, B, D, cap_R, c_F, c_R, e_F):\n    \"\"\"\n    Solve the LP for given parameters and return the implied period-specific carbon price path.\n    Prices are in $/tCO2 for periods t=0..T-1.\n    \"\"\"\n    T = len(D)\n    # Variable ordering: [gF_0, ..., gF_{T-1}, gR_0, ..., gR_{T-1}]\n    n_vars = 2 * T\n\n    # Objective coefficients: discounted costs\n    c = np.zeros(n_vars, dtype=float)\n    for t in range(T):\n        c[t] = (delta ** t) * c_F\n        c[T + t] = (delta ** t) * c_R\n\n    # Equality constraints: gF_t + gR_t = D_t\n    A_eq = np.zeros((T, n_vars), dtype=float)\n    b_eq = np.array(D, dtype=float)\n    for t in range(T):\n        A_eq[t, t] = 1.0          # gF_t\n        A_eq[t, T + t] = 1.0      # gR_t\n\n    # Inequality constraints:\n    # 1) Renewable capacity: gR_t = cap_R[t]\n    # 2) Carbon budget: sum_t e_F * gF_t = B\n    A_ub = np.zeros((T + 1, n_vars), dtype=float)\n    b_ub = np.zeros(T + 1, dtype=float)\n\n    # Renewable capacity constraints\n    for t in range(T):\n        A_ub[t, T + t] = 1.0\n        b_ub[t] = cap_R[t]\n\n    # Carbon budget constraint (last inequality)\n    for t in range(T):\n        A_ub[T, t] = e_F\n    b_ub[T] = B\n\n    # Bounds: gF_t >= 0, gR_t >= 0 (no explicit upper bounds on fossil)\n    bounds = [(0, None)] * n_vars\n\n    # Solve LP using HiGHS\n    res = linprog(c, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq,\n                  bounds=bounds, method='highs')\n\n    if not res.success:\n        # In case of numerical issues or infeasibility, return NaNs\n        return [float('nan')] * T\n\n    # Extract the dual (Lagrange multiplier) for the carbon budget inequality.\n    # SciPy (HiGHS) returns inequality multipliers in res.ineqlin.marginals for A_ub @ x = b_ub,\n    # with the convention that binding constraints in a minimization have nonpositive multipliers.\n    try:\n        duals_ub = res.ineqlin.marginals\n        mu = duals_ub[-1]  # Carbon budget is the last inequality\n    except Exception:\n        # Fallback: if the structure isn't present (shouldn't happen), set mu=0\n        mu = 0.0\n\n    # Implied carbon price path in period-t currency: pi_t = -mu / delta^t\n    # Ensure that tiny numerical noise does not produce negative zeros, clamp near-zero to zero.\n    prices = []\n    for t in range(T):\n        denom = (delta ** t)\n        # Avoid division by zero if delta=0 (not allowed by problem specification), but safeguard.\n        if denom == 0.0:\n            pi_t = float('inf')\n        else:\n            pi_t = -mu / denom\n        # Clean small numerical artifacts\n        if abs(pi_t)  1e-9:\n            pi_t = 0.0\n        # Round to 3 decimals\n        pi_t = float(f\"{pi_t:.3f}\")\n        prices.append(pi_t)\n\n    return prices\n\ndef solve():\n    # Fixed parameters across all tests\n    T = 4\n    D = [100.0, 110.0, 120.0, 130.0]          # MWh\n    cap_R = [50.0, 60.0, 70.0, 80.0]          # MWh\n    c_F = 30.0                                # $/MWh\n    c_R = 60.0                                # $/MWh\n    e_F = 0.9                                 # tCO2/MWh\n\n    # Helper quantities for budgets\n    sum_D = sum(D)\n    sum_cap_R = sum(cap_R)\n    min_emissions_budget = e_F * sum((D[t] - cap_R[t]) for t in range(T))  # minimum feasible B\n\n    # Test suite:\n    # 1) Binding at minimum feasible emissions with discounting\n    delta1 = 0.95\n    B1 = min_emissions_budget\n\n    # 2) Intermediate budget without discounting (between min and max emissions)\n    delta2 = 1.0\n    B2 = e_F * (sum((D[t] - cap_R[t]) for t in range(T)) + 0.5 * sum_cap_R)\n\n    # 3) Loose carbon budget (constraint slack)\n    delta3 = 0.90\n    B3 = e_F * sum_D + 100.0\n\n    test_cases = [\n        (delta1, B1),\n        (delta2, B2),\n        (delta3, B3),\n    ]\n\n    results = []\n    for (delta, B) in test_cases:\n        prices = compute_shadow_price_path(delta, B, D, cap_R, c_F, c_R, e_F)\n        results.append(prices)\n\n    # Format as specified: a single line, list of lists with 4 floats each\n    # Convert inner lists to string with bracketed comma-separated floats\n    inner_strs = []\n    for lst in results:\n        inner_strs.append(f\"[{','.join(map(lambda x: f'{x:.3f}', lst))}]\")\n    print(f\"[{','.join(inner_strs)}]\")\n\nsolve()\n```"
        }
    ]
}