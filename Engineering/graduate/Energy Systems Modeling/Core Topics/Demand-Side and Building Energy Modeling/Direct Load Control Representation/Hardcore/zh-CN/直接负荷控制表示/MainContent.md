## 引言
随着可再生能源渗透率的不断提高，[电力](@entry_id:264587)系统对灵活性的需求日益迫切。直接负荷控制（Direct Load Control, DLC）作为一种关键的需求侧资源，通过聚合和协调成千上万的分布式用电设备（如空调、热水器），为电网提供宝贵的调节能力。然而，如何将这些复杂、异构的负荷群体的动态行为和物理约束，精确且高效地表示于大规模[能源系统优化](@entry_id:1124497)模型中，是学术界和工业界面临的一大挑战。本文旨在系统性地解决这一问题，为读者构建一个从微观物理到宏观聚合的完整知识框架。

在接下来的内容中，我们将分三步深入探索直接负荷控制的表示方法。第一章**“原理与机制”**将从单个设备的[热力学](@entry_id:172368)模型和硬件约束出发，奠定物理基础，并介绍描述群体行为的聚合理论，如[虚拟电池](@entry_id:1133819)模型和同步振荡现象。第二章**“应用与交叉学科联系”**将展示这些模型如何在优化调度、[电力市场](@entry_id:1124241)参与以及与配电网物理约束集成等实际场景中发挥作用，凸显其与控制理论、统计物理和[能源经济学](@entry_id:1124463)的深刻联系。最后，在**“动手实践”**部分，读者将通过具体计算问题，亲手应用所学理论，加深对关键概念的理解。

## 原理与机制

本章旨在深入探讨直接负荷控制 (Direct Load Control, DLC) 的核心原理与关键机制。我们将从单个设备的基础物理模型出发，逐步构建起对大规模设备群体进行有效调控所需的复杂模型。内容将涵盖[热力学](@entry_id:172368)动态、设备约束、聚合理论以及群体行为中出现的复杂现象。通过本章的学习，读者将能够理解并将直接负荷控制资源精确地表达于[能源系统优化](@entry_id:1124497)模型中。

### 直接负荷控制的基本概念

在探讨具体的数学模型之前，我们必须首先明确直接负荷控制的本质，并将其与[需求响应](@entry_id:1123537)领域的其他方法区分开来。

**直接负荷控制 (DLC)** 是一种集中式控制策略，其中电网运营商或[负荷聚合](@entry_id:1127376)商拥有直接、实时的权限来改变终端用户的用电设备的运行状态。在典型的DLC项目中，聚合商通过通信网络向参与项目的设备（如空调、热水器、泳池水泵等）发送明确的开关指令。这种控制通常是通过一个二进制的**致动指令 (actuation command)** $u(t) \in \{0, 1\}$ 来实现的，其中 $u(t)=1$ 代表“开启”或“允许运行”，$u(t)=0$ 代表“关闭”或“强制中断”。在理想情况下，设备的物理开关状态 $s(t)$ 会直接跟随该指令，即 $s(t) = u(t)$。因此，如果一个设备开启时的额定功率为 $P^{\mathrm{rated}}$，其瞬时功耗可以被简洁地建模为 $P(t) = u(t) P^{\mathrm{rated}}$ 。

与之相对的是**基于价格的需求响应 (price-based Demand Response, DR)**，这是一种分散式、间接的控制策略。在这种模式下，电网运营商并不直接控制设备，而是发布一个随时间变化的价格信号 $\pi(t)$。终端用户根据这个价格信号，结合自身的舒适度偏好和经济考量，自主决定其设备的运行策略。因此，决策的主体是消费者，而非电网。电网通过价格杠杆来“引导”而非“命令”负荷的调整。

总结而言，两种范式的主要区别在于**决策权的归属**和**控制信号的性质**。在DLC中，聚合商是决策者，其决策变量是作用于成千上万个设备的控制向量 $\mathbf{u}(t) = (u_1(t), \dots, u_N(t))$。聚合商的优化目标通常是在满足电网服务需求的同时，最小化能源成本和对用户造成的不适。这需要在满足所有设备物理和用户舒适度约束的前提下，求解一个大规模的优化问题。而在间接控制中，聚合商的决策变量是激励信号（如价格 $s(t)$），它需要建立一个模型来预测用户对该信号的反应，即 $u_i^\star(t) = g_i(s(t), \theta_i(t))$，其中 $\theta_i(t)$ 是设备的状态。聚合商通过优化激励信号 $s(t)$ 来间接实现系统目标 。本章的重点将聚焦于直接负荷控制的建模表示。

### 单个设备建模：物理与动态

直接负荷控制的基础是理解并精确描述单个可控设备的行为。其中，**温控负荷 (Thermostatically Controlled Loads, TCLs)**，如空调和电热水器，是最典型也是最具代表性的研究对象。

#### [热力学](@entry_id:172368)RC模型

对TCL进行建[模的基](@entry_id:156416)石是能量守恒定律，通常被简化为一个一阶的**电阻-电容 (Resistor-Capacitor, RC) 模型**。该模型将建筑或水箱的内部空间及其中的物体抽象为一个具有集总**热容 (thermal capacitance)** $C$（单位：$\mathrm{J/K}$）的单一[热质量](@entry_id:188101)，其温度为 $T(t)$。该热质量通过一个等效的**热阻 (thermal resistance)** $R$（单位：$\mathrm{K/W}$）与温度为 $T_a(t)$ 的外部环境进行热交换 。

根据能量守恒，[热质量](@entry_id:188101)内部能量的变化率等于流入的净热功率。净热功率包括两部分：通过围护结构的热交换，以及由设备（如加热器或空调）注入或移出的热量。
$$
C \frac{dT(t)}{dt} = \dot{Q}_{\text{net}} = \dot{Q}_{\text{env}} + \dot{Q}_{\text{hvac}}
$$
通过围护结构的热流 $\dot{Q}_{\text{env}}$ 通常被建模为与内外温差成正比，即 $\dot{Q}_{\text{env}} = \frac{T_a(t) - T(t)}{R}$。设备的致热/致冷功率 $\dot{Q}_{\text{hvac}}$ 则由[控制信号](@entry_id:747841) $u(t)$ 决定。综合起来，我们得到TCL的一阶动态方程：
$$
C \frac{dT(t)}{dt} = \frac{T_a(t) - T(t)}{R} + \eta P_r u(t)
$$
其中 $P_r$ 是设备的额定[电功率](@entry_id:273774)，$\eta$ 是其将电能转化为热能的效率。为了简化，我们通常将致动项合并为一个参数 $\gamma$，写成[标准形式](@entry_id:153058) ：
$$
\frac{dT(t)}{dt} = -\frac{1}{\tau} \big(T(t) - T_a(t)\big) + \gamma u(t)
$$
这里的 $\tau = RC$ 是系统的**[热力学](@entry_id:172368)时间常数**，表征了温度对外界变化响应的快慢，通常为几分钟到几小时。$\gamma$ 是**致动增益 (actuator gain)**，其单位为 $\mathrm{K/s}$，代表在没有[热损失](@entry_id:165814)的情况下，设备以单位功率运行时引起温度变化的速率。它的表达式为 $\gamma = \frac{\eta P_r}{C}$ 。

$\gamma$ 的符号和数值取决于设备的类型 。
- 对于**电阻式加热器**，它将电能直接转化为热能，效率 $\eta_h$ 接近1。热量被注入到区域内，因此 $\gamma = \frac{\eta_h P_r}{C} > 0$。
- 对于**蒸汽压缩式空调**（一种[热泵](@entry_id:143719)），它将热量从区域内移出。其性能由**能效比 (Coefficient of Performance, COP)** 定义，即移出的热量与消耗的电能之比。移出热量的速率为 $\dot{Q}_{\text{removed}} = \eta_c \cdot \mathrm{COP} \cdot (P_r u(t))$，其中 $\eta_c$ 是效率因子。由于这是从系统中移出热量，其对能量平衡的贡献为负。因此，对于空调，$\gamma = -\frac{\eta_c \cdot \mathrm{COP} \cdot P_r}{C}  0$。

#### 动态响应分析

TCL模型的动态特性是其作为电网灵活性资源的关键。我们可以通过求解上述常微分方程来分析其对控制指令的响应。考虑一个简单的场景：环境温度 $T_a$ 恒定，在 $t=0$ 时，控制指令从 $u_0$ 阶跃至 $u_1$。假设在 $t0$ 时系统已处于由 $u_0$ 决定的[稳态](@entry_id:139253)，其温度为 $T(0) = T_a + RC\gamma u_0$。对于 $t \ge 0$，方程的解为 ：
$$
T(t) = \underbrace{RC\gamma(u_0 - u_1)\exp\left(-\frac{t}{RC}\right)}_{\text{暂态响应}} + \underbrace{T_a + RC\gamma u_1}_{\text{新的稳态}}
$$
这个解清晰地表明，当控制指令改变时，系统温度会以指数形式从旧的[稳态](@entry_id:139253)渐近地趋向于新的[稳态](@entry_id:139253)，其衰减速率由时间常数 $\tau=RC$ 决定。这种固有的“惯性”或“延迟”是TCL能够提供短期功率[调节服务](@entry_id:200654)的基础：我们可以暂时关闭一个空调，其室内温度不会立即变得无法忍受，而是会缓慢上升。

### 设备级约束与高保真建模

虽然上述RC模型抓住了核心物理，但真实的设备运行还受到一系列重要的非理想因素和[硬件保护](@entry_id:750157)约束的限制。在精确的DLC建模中，必须考虑这些因素。

#### [恒温器](@entry_id:143395)与迟滞控制

TCL的自主运行依赖于[恒温器](@entry_id:143395)，它通过在预设的温度[死区](@entry_id:183758)（deadband）$[T^{\min}, T^{\max}]$ 内开关设备来维持舒适度。一个简单的、基于单一阈值 $T^{\mathrm{set}}$ 的控制器（例如，当 $T(t) \ge T^{\mathrm{set}}$ 时开启空调）在实际中是不可行的。由于[测量噪声](@entry_id:275238)和微小[温度波](@entry_id:193534)动，温度会在 $T^{\mathrm{set}}$ 附近频繁穿越，导致设备频繁启停，即所谓的**“抖振” (chattering)**。

为避免抖振，所有商用[恒温器](@entry_id:143395)都采用**迟滞 (hysteresis)** 控制逻辑 。迟滞控制使用两个不同的阈值：一个用于开启，一个用于关闭。对于一个制冷设备（空调），其逻辑为：
- 当温度上升并达到上阈值 $T^{\max}$ 时，设备**开启** ($s=1$)。
- 设备将持续运行，直到温度下降并达到下阈值 $T^{\min}$ 时，设备才**关闭** ($s=0$)。
- 当温度在 $(T^{\min}, T^{\max})$ 区间内时，设备保持其当前状态不变。

这种策略的优点在于，一旦设备开启，温度必须从 $T^{\max}$ 显著下降到 $T^{\min}$ 才会关闭，反之亦然。这个穿越整个死区所需的时间为设备提供了天然的最小运行和停机时间，从而有效防止了抖振。在没有噪声的理想情况下，最小开启时间 $\tau_{\mathrm{on}}^{\min}$ 和最小关闭时间 $\tau_{\mathrm{off}}^{\min}$ 可以通过求解RC模型方程得到，它们是系统参数 $R, C, \gamma$ 和[死区](@entry_id:183758)宽度 $\Delta T^{\mathrm{db}} = T^{\max} - T^{\min}$ 的函数，并且是严格为正的 。迟滞的引入确保了即使存在有界的测量噪声（例如，噪声幅度小于[死区](@entry_id:183758)宽度的一半），也不会引发瞬时的开关循环。

#### 最小运行/停机时间约束

除了[恒温器](@entry_id:143395)逻辑带来的隐式约束外，许多设备（尤其是带有压缩机的空调）还有由制造商规定的、必须严格遵守的**最小运行时间 (minimum on-time)** $m^{\mathrm{on}}$ 和**最小停机时间 (minimum off-time)** $m^{\mathrm{off}}$。这些约束是为了保护设备（如压缩机）免受因频繁启停造成的机械应力和热应力，确保其使用寿命。

在构建用于调度或优化的离散时间模型时，这些连续时间的约束必须被转化为离散的[逻辑约束](@entry_id:635151) 。假设时间被划分为长度为 $\Delta$ 的时段 $t \in \{1, 2, \dots, T\}$。首先，我们需要将分钟或秒为单位的 $m^{\mathrm{on}}$ 和 $m^{\mathrm{off}}$ 转换为时段数。为了确保约束不被违反，必须使用**向上取整 (ceiling function)**：
$$
M^{\mathrm{on}} = \left\lceil \frac{m^{\mathrm{on}}}{\Delta} \right\rceil, \quad M^{\mathrm{off}} = \left\lceil \frac{m^{\mathrm{off}}}{\Delta} \right\rceil
$$
例如，如果 $\Delta = 5$ 分钟，而 $m^{\mathrm{on}} = 12$ 分钟，那么 $M^{\mathrm{on}} = \lceil 12/5 \rceil = 3$ 个时段。

接下来，在混合整数线性规划 (MILP) 模型中，这些约束可以通过引入启动 ($s_t$) 和停止 ($r_t$) 变量来强制执行。一个标准的表述方式是 ：
- **最小开启时间约束**: 如果在时段 $t$ 发生了一次启动 ($s_t = 1$)，则设备必须在从 $t$ 开始的连续 $M^{\mathrm{on}}$ 个时段内保持开启状态 ($u_{\tau}=1$)。
$$
\sum_{\tau = t}^{t + M^{\mathrm{on}} - 1} u_{\tau} \ge M^{\mathrm{on}} \cdot s_t
$$
- **最小停机时间约束**: 如果在时段 $t$ 发生了一次停止 ($r_t = 1$)，则设备必须在从 $t$ 开始的连续 $M^{\mathrm{off}}$ 个时段内保持关闭状态 ($u_{\tau}=0$)。
$$
\sum_{\tau = t}^{t + M^{\mathrm{off}} - 1} (1 - u_{\tau}) \ge M^{\mathrm{off}} \cdot r_t
$$
这些约束是构建高保真度DLC调度模型的关键组成部分。

#### 二元控制 vs. 连续松弛

在建模单个设备时，一个重要问题是：我们是否可以用一个连续变量 $u_i(t) \in [0, 1]$ 来近似替代物理上只能取 $\{0, 1\}$ 值的开关动作？对于**单个设备**而言，答案通常是否定的 。一个连续的 $u_i(t)$ 值（如0.5）并没有直接的物理对应，它可能被解释为在某个时间窗口内进行快速开关（即[占空比](@entry_id:199172)控制）。然而，这种快速开关恰恰是最小运行/停机时间约束所禁止的。这些硬件约束在控制轨迹集合上引入了非[凸性](@entry_id:138568)，使得简单的[凸松弛](@entry_id:636024)（即将 $u_i(t) \in \{0, 1\}$ 放宽到 $u_i(t) \in [0, 1]$）是不精确的，甚至可能导致物理上不可行的解。因此，对于需要精确考虑单个设备硬件约束的模型，必须使用[二元变量](@entry_id:162761)。

### 聚合[种群建模](@entry_id:267037)

直接负荷控制的真正威力在于同时协调成百上千个设备。对每个设备都进行单独的精细建模在计算上是不可行的。因此，开发能够描述设备**群体**行为的**聚合模型 (aggregate model)** 至关重要。

#### 虚拟电池模型

当设备数量足够大（$N \to \infty$）且具有一定程度的[同质性](@entry_id:636502)时，一个庞大的TCL群体可以被令人惊讶地抽象为一个等效的**虚拟储能系统 (Virtual Energy Storage System)**，通常被称为**“虚拟电池” (virtual battery)** 。这个模型将整个群体的[热力学](@entry_id:172368)灵活性封装在一个单一的状态变量和几个参数中。

让我们定义一个聚合[状态变量](@entry_id:138790) $E(t)$，它代表整个群体相对于共同设定点 $T^{\mathrm{set}}$ 的总“热能”偏差：
$$
E(t) = \sum_{i=1}^N k (T_i(t) - T^{\mathrm{set}})
$$
其中 $k$ 是一个正常数。通过对所有单个设备的RC模型求和并进行数学推导，可以证明 $E(t)$ 的动态演化遵循一个类似于单个RC模型的一阶线性方程 ：
$$
\dot{E}(t) = -a E(t) - \beta \Delta P(t)
$$
其中：
- $a = \frac{1}{RC}$ 是能量的“泄漏”或耗散率，对应于群体向环境的平均[热损失](@entry_id:165814)。
- $\Delta P(t) = P^{\mathrm{agg}}(t) - P^{\mathrm{base}}(t)$ 是聚合商施加的控制功率，即实际总功率与无控制时的基线功率之差。
- $\beta = -\frac{kb}{P^{\mathrm{rated}}}$ 是一个正常数，它将控制功率与能量状态的变化联系起来。对于制冷负荷 ($b0$)，符号为负是正确的，因为增加用[电功率](@entry_id:273774) ($\Delta P > 0$) 会降低群体温度，从而减少 $E(t)$。

这个虚拟电池模型还受到两个关键约束：
1.  **能量容量 (Energy Capacity)**: 由于每个设备的温度都必须保持在舒适区间 $[T^{\min}, T^{\max}]$ 内，聚合的能量状态 $E(t)$ 也必须在一个固定的范围[内波](@entry_id:261048)动：$[E^{\min}, E^{\max}]$。其中 $E^{\min} = -N k \frac{\Delta T^{\mathrm{db}}}{2}$ 和 $E^{\max} = N k \frac{\Delta T^{\mathrm{db}}}{2}$，分别对应所有设备同时处于温度下限和上限的极端情况。
2.  **功率容量 (Power Capacity)**: 任何时刻，可调度的功率 $\Delta P(t)$ 也受限于物理极限。其范围大致在 $[-P^{\mathrm{base}}(t), N P^{\mathrm{rated}} - P^{\mathrm{base}}(t)]$ 之间，通常可以用一个对称的外部包络 $| \Delta P(t) | \le N P^{\mathrm{rated}}$ 来近似。

这个[虚拟电池](@entry_id:1133819)模型是一个极其强大的工具。它将一个高维、复杂的混合整数动态系统（$N$个TCL）简化为一个低维、线性的[连续系统](@entry_id:178397)，极大地简化了控制设计和电网调度优化。

#### 同步与振荡

尽管聚合模型非常有用，但它也可能掩盖一种重要的、潜在的破坏性群体现象：**同步 (synchronization)** 。当聚合商向大量设备发送一个相同的广播控制信号时（例如，在下午2点同时关闭所有空调），这些设备的状态就被“同步”了。

想象一下，在[控制信号](@entry_id:747841)发出后，这些设备都从相似的初始状态（例如，温度都在死区下限附近）开始它们的自然循环。由于它们的物理参数和[设定点](@entry_id:154422)相似，它们会倾向于在差不多相同的时间后再次达到需要开启的温度上限。当它们集体开启时，会造成总用电功率的突然飙升。同样，在运行一段时间后，它们又会倾向于集体关闭，导致总功率的骤降。这种由控制引发的同步，会导致总负荷在控制事件后出现持续的、大幅度的**振荡 (oscillations)**。

这种现象可以通过更高级的均场理论 (mean-field theory) 进行建模，例如使用福克-普朗克方程 (Fokker-Planck equation) 来描述设备在[状态空间](@entry_id:160914)中的密度分布 $f(\theta, t)$。一个同步的广播指令会在[状态空间](@entry_id:160914)中产生一个高度集中的“设备密度包”。这个密度包随着时间的推移，在设备自然循环的驱动下（漂移项 $\omega \partial_\theta f$）整体移动。当这个密度包周期性地进入和离开代表“开启”状态的区域时，就会在总功率 $P(t) \propto \int_{\text{ON}} f(\theta, t) d\theta$ 中产生振荡。

系统中的内在随机性（如设备参数的[异质性](@entry_id:275678)、随机的用户行为），在模型中表现为扩散项 ($D \partial_{\theta\theta} f$)，它会使这个集中的密度包逐渐散开，从而使振荡的幅度随时间衰减。主动缓解同步振荡的策略包括在控制指令中引入**随机化延迟 (randomized delays)**，即不是让所有设备同时响应，而是在一个小的随机时间窗口内响应。这种方法可以有效地“去同步化”设备群体，平滑总功率响应 。