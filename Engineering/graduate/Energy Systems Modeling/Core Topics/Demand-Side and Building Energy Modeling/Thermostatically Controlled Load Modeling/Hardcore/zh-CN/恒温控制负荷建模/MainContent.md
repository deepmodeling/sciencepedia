## 引言
恒温控制负荷（Thermostatically Controlled Loads, TCLs），如空调、冰箱和电热水器，是现代[电力](@entry_id:264587)系统中数量最庞大、占比最高的负荷类型之一。它们本质上是热能存储设备，蕴含着巨大的、尚未被充分开发的灵活性。如何将这些分散、微小的灵活性资源聚合起来，使其成为可供电网调度和利用的“虚拟电厂”，是构建未来高比例可再生能源[电力](@entry_id:264587)系统所面临的关键挑战。本文旨在系统性地解决这一问题，为读者构建一个从微观物理原理到宏观系统应用的完整知识框架。

本文将带领读者深入探索TCL建模与控制的核心理论和方法。我们将从第一章“原理与机制”开始，详细推导单个TCL的等效热[参数模型](@entry_id:170911)，理解其内在动态特性和滞环控制逻辑。随后，在第二章“应用与交叉学科联系”中，我们将视野扩展到TCL群体，介绍如何通过聚合模型构建“虚拟电池”，并探讨其在频率调节、参与[电力市场](@entry_id:1124241)等方面的具体应用，同时揭示其背后涉及的多学科知识。最后，在第三章“动手实践”中，读者将有机会通过一系列精心设计的问题，亲手实现[模型参数估计](@entry_id:752080)、动态仿真和鲁棒性分析，将理论知识转化为实践技能。

## 原理与机制

本章旨在从基本物理原理出发，系统地阐述单个恒温控制负荷（Thermostatically Controlled Load, TCL）的[热力学](@entry_id:172368)行为建模方法。我们将首先构建一个基础的等效热参数（Equivalent Thermal Parameter, ETP）模型，进而分析其动态特性与控制逻辑，并最终探讨模型的扩展与简化，为后续章节中TCL聚合建模与电网服务应用奠定坚实的理论基础。

### 等效热参数（ETP）模型

对TCL进行建模的第一步，是将其所控制的建筑区域（如单个房间或冷库）抽象为一个简化的[热力学系统](@entry_id:188734)。最常用且行之有效的方法是**等效热参数（ETP）模型**，也常被称为RC模型。该模型基于一个核心假设：区域内的空气和内部物体充分混合，具有均匀的、随时间变化的温度 $T(t)$。

#### 能量守恒与基本方程

根据[热力学第一定律](@entry_id:146485)，区域内部储能的变化率等于流入该区域的净热量功率。区域的储能可以表示为 $C T(t)$，其中 **$C$** 是区域的**总等效热容**（单位：J/K），它代表了将该区域温度升高一单位开尔文所需吸收的能量。因此，储能的变化率为 $C \frac{dT(t)}{dt}$ 或 $C \dot{T}(t)$。

净热流包括两个主要部分：通过建筑围护结构的被动热交换，以及由TCL设备（如空调）产生的主动热交换。

1.  **被动热交换**：室内与室外环境之间存在温差，导致热量通过墙壁、窗户等围护结构传递。该过程类似于电路中的电流通过电阻，其热流率可以通过一个**等效热阻** **$R$**（单位：K/W）来描述。如果室外温度为 $T_{out}(t)$，则流入室内的热流率为：
    $$ \dot{q}_{env}(t) = \frac{T_{out}(t) - T(t)}{R} $$
    当室外比室内热时（$T_{out}(t) > T(t)$），该值为正，表示热量增益；反之则为负，表示热量损失。

2.  **主动热交换**：TCL设备根据其运行状态从区域[内移](@entry_id:265618)出或注入热量。对于一个制冷设备（如空调），当其开启时，会以额定功率 $Q$（单位：W）从室内移出热量。我们可以用一个二进制控制变量 $u(t) \in \{0, 1\}$ 来表示设备的状态，其中 $u(t)=1$ 表示开启，$u(t)=0$ 表示关闭。因此，制冷设备引起的热流可以表示为：
    $$ \dot{q}_{cool}(t) = -u(t) Q $$
    这里的负号至关重要，因为它表示热量被“移出”区域，是能量平衡方程中的一个汇项。

将以上各项整合，我们便得到了TCL的[一阶常微分方程](@entry_id:264241)（ODE）模型 ：
$$ C \dot{T}(t) = \frac{T_{out}(t) - T(t)}{R} - u(t) Q $$
这个方程是TCL建[模的基](@entry_id:156416)石。它简洁地描述了室内温度 $T(t)$ 如何响应外部温度 $T_{out}(t)$ 和设备控制 $u(t)$ 的变化。

#### 热阻的物理基础

上述模型中的线性热阻项 $\frac{T_{out} - T}{R}$ 是一个高度集成的简化。从物理层面看，热量从室外传递到室内是一个包含对流和传导的串联过程。我们可以通过分析一个简化的平面墙体来更深入地理解等效热阻 $R$ 的构成 。

考虑一堵面积为 $A$、厚度为 $L$、导热系数为 $k$ 的墙体。热传递经过三个串联的步骤：
1.  室外空气（温度 $T_{out}$）通过对流将热量传递给墙体外表面（温度 $T_{w,out}$），其热阻为 $R_{out} = \frac{1}{h_{out} A}$，其中 $h_{out}$ 是室外[对流换热系数](@entry_id:151029)。
2.  热量通过墙体材料从外表面传导至内表面（温度 $T_{w,in}$），其热阻为 $R_{cond} = \frac{L}{k A}$。
3.  墙体内表面通过对流将热量传递给室内空气（温度 $T$），其热阻为 $R_{in} = \frac{1}{h_{in} A}$，其中 $h_{in}$ 是室内对流换热系数。

假设墙体的热容与其所连接的室内空气热容相比可以忽略不计，或者墙体内的热动态比室内温度变化快得多（即**[准稳态假设](@entry_id:273480)**），那么在任何时刻流过这三层的热流率 $\dot{Q}$ 都是相等的。总的温差等于各层温差之和：
$$ T_{out} - T = \dot{Q} R_{out} + \dot{Q} R_{cond} + \dot{Q} R_{in} $$
因此，总的等效热阻 $R$ 是这三个串联热阻之和：
$$ R = R_{out} + R_{cond} + R_{in} = \frac{1}{h_{out} A} + \frac{L}{k A} + \frac{1}{h_{in} A} $$
这个推导清晰地表明，ETP模型中的 $R$ 是对建筑围护结构复杂的传热过程的一个集总近似。该近似模型的有效性依赖于一系列假设，包括：室内空气混合均匀（即集总热容假设，适用于内部毕渥数 $Bi \ll 1$ 的情况）、墙体处于准[稳态](@entry_id:139253)、材料属性（$k, h_{in}, h_{out}$）在工作温度范围内近似恒定，以及辐射换热可忽略或已被线性化处理。

### 系统的内在动态特性

在引入控制器之前，分析TCL系统自身的固有响应特性是至关重要的。这可以通过考察设备关闭（$u=0$）和持续开启（$u=1$）两种极端情况下的温度演化来实现。

#### [热时间常数](@entry_id:151841)

当设备关闭（$u(t)=0$）且外部温度 $T_{out}$ 恒定时，系统的控制方程简化为一个描述被动热交换的齐次线性ODE：
$$ C \dot{T}(t) = \frac{T_{out} - T(t)}{R} $$
可以重写为：
$$ \frac{dT(t)}{dt} + \frac{1}{RC} T(t) = \frac{1}{RC} T_{out} $$
该方程的解为指数衰减形式：
$$ T(t) = T_{out} + (T_0 - T_{out}) \exp\left(-\frac{t}{RC}\right) $$
其中 $T_0$ 是初始温度。这个解表明，当不受[主动控制](@entry_id:924699)时，室内温度 $T(t)$ 会以指数形式逐渐趋向于室外温度 $T_{out}$。

控制这个松弛过程速率的关键参数是指数项中的乘积 $RC$。这个乘积的量纲是时间（$(\text{J/K}) \times (\text{K/W}) = \text{J/W} = \text{s}$），被称为系统的**[热时间常数](@entry_id:151841)**，记为 $\tau$ 。
$$ \tau = RC $$
**[热时间常数](@entry_id:151841)** $\tau$ 是系统[热惯性](@entry_id:147003)的度量。一个大的 $\tau$ 值（由大热容 $C$ 或大热阻 $R$ 引起）意味着建筑对温度变化的响应缓慢，即“保温”性能好。在时间 $t=\tau$ 时，温度与环境的初始偏差 $(T_0 - T_{out})$ 会衰减为其初始值的 $\exp(-1) \approx 0.37$ 倍。

#### [稳态温度](@entry_id:136775)

当制冷设备持续开启（$u(t)=1$）且外部温度 $T_{out}$ 恒定时，系统最终会达到一个新的平衡状态。在这个状态下，温度不再变化，即 $\dot{T}(t) = 0$。我们将这个温度称为**[稳态温度](@entry_id:136775)** $T^{ss}$。将其代入基本方程中 ：
$$ 0 = \frac{T_{out} - T^{ss}}{R} - Q $$
求解 $T^{ss}$ 可得：
$$ T^{ss} = T_{out} - R Q $$
这个结果具有明确的物理意义。$T^{ss}$ 代表了在给定室外温度下，如果制冷设备无限期运行，室内能够达到的理论最低温度。这个温度取决于三个因素：
-   **室外温度 $T_{out}$**：基准温度。
-   **制冷功率 $Q$**：$Q$ 越大（设备越强劲），$T^{ss}$ 越低。
-   **热阻 $R$**：$R$ 越大（建筑绝缘性越好），从外部渗入的热量越少，设备维持的温差 $(T_{out} - T^{ss})$ 就越大，因此 $T^{ss}$ 也越低。

在物理上，$T^{ss}$ 是这样一个平衡点：设备从室[内移](@entry_id:265618)出热量的速率 $Q$ 恰好等于通过围护结构从室外渗入热量的速率 $\frac{T_{out} - T^{ss}}{R}$。在实际应用中，[恒温器](@entry_id:143395)的设定温度通常远高于 $T^{ss}$，因此设备会通过循环启停来维持一个舒适的温度范围。

### 滞环控制机制

现实中的TCL并不会持续开启或关闭，而是由一个恒温控制器根据预设的逻辑进行切换。这种逻辑通常采用**滞环控制**（Hysteresis Control）。

#### 温差带与开关逻辑

一个典型的恒温控制器围绕一个**设定温度** $T_s$ 工作，并设有一个宽度为 $\Delta$ 的**温差带**（deadband）。这定义了两个阈值：
-   **上限阈值 $T_{max} = T_s + \Delta/2$**
-   **下限阈值 $T_{min} = T_s - \Delta/2$**

对于制冷应用，滞环控制的逻辑如下 ：
-   当设备处于关闭状态（$u=0$）时，如果室内温度 $T(t)$ 上升并达到上限阈值 $T_{max}$，设备开启（$u$ 切换为 $1$）。
-   当设备处于开启状态（$u=1$）时，如果室内温度 $T(t)$ 下降并达到下限阈值 $T_{min}$，设备关闭（$u$ 切换为 $0$）。
-   当温度在 $[T_{min}, T_{max}]$ 区间内时，设备[状态保持](@entry_id:1132308)不变。

这种“记忆”效应——即开关行为不仅取决于当前温度，还取决于之前的状态——是滞环的本质特征。它避免了在单一阈值点附[近因](@entry_id:149158)微小波动引起的频繁开关，即**抖振**（chattering）。特别是在存在[测量噪声](@entry_id:275238) $\tilde{T}(t) = T(t) + n(t)$ 的情况下，如果噪声的峰峰值 $2\varepsilon$（其中 $|n(t)| \le \varepsilon$）小于温差带宽度 $\Delta$，滞环就能确保噪声本身不会触发开关，从而保证了系统的稳定运行和设备的寿命。

#### [混合自动机](@entry_id:1126226)表示

TCL的完整行为是一个典型的**[混合系统](@entry_id:271183)**（Hybrid System），它包含了连续的温度动态和离散的开关事件。我们可以使用**混合自动机**（Hybrid Automaton）的框架来精确地描述这个系统 。

一个TCL的[混合自动机](@entry_id:1126226)包含以下要素：
-   **离散状态（模式）**: $u \in \{0 (\text{OFF}), 1 (\text{ON})\}$。
-   **连续状态**: $T \in \mathbb{R}$。
-   **流（Flow）**: 每个离散模式下的连续动态方程。
    -   模式 $u=0$: $C\dot{T} = \frac{T_{out}-T}{R}$。
    -   模式 $u=1$: $C\dot{T} = \frac{T_{out}-T}{R} - Q$。
-   **不变集（Invariant）**: 系统维持在某个模式必须满足的条件。
    -   模式 $u=0$: $T \le T_{max}$。
    -   模式 $u=1$: $T \ge T_{min}$。
-   **守卫（Guard）**: 触发模式切换的条件。
    -   切换 $0 \to 1$: $T = T_{max}$。
    -   切换 $1 \to 0$: $T = T_{min}$。
-   **重置映射（Reset Map）**: 切换发生时状态变量的更新规则。
    -   $0 \to 1$: $u^+ = 1$, $T^+ = T$。
    -   $1 \to 0$: $u^+ = 0$, $T^+ = T$。

这个系统被称为**[分段线性](@entry_id:201467)**（Piecewise Linear）系统，因为在每个固定的离散模式 $u$ 下，温度的导数 $\dot{T}$ 是关于 $T$ 的[仿射函数](@entry_id:635019)。同时，由于在切换瞬间，控制输入 $u$ 发生跳变，导致 $\dot{T}$ 的表达式也发生不连续的变化（从 $\frac{1}{C}(\frac{T_{out}-T}{R})$ 跳变为 $\frac{1}{C}(\frac{T_{out}-T}{R} - Q)$），因此该系统的向量场是**不连续的**。

### 循环行为分析

将ETP模型与滞环控制器相结合，系统会在上下限阈值之间呈现稳定的**极限环**（limit cycle）行为。我们可以精确地计算出这个[循环过程](@entry_id:146195)的周期。

假设外部温度 $T_{out}$ 恒定，且满足 $T_{out} > T_{max}$ 和 $T^{ss} = T_{out} - RQ  T_{min}$，以保证系统能够稳定循环。循环周期由一个升温（OFF）阶段和一个降温（ON）阶段组成 。

1.  **升温阶段 (OFF, $u=0$)**: 温度从 $T_{min}$ 开始，根据指数规律向 $T_{out}$ 趋近。达到 $T_{max}$ 所需的时间 $t_{off}$ 可通过求解以下方程得到：
    $$ T_{max} = T_{out} + (T_{min} - T_{out}) \exp\left(-\frac{t_{off}}{RC}\right) $$
    解得：
    $$ t_{off} = RC \ln\left(\frac{T_{out} - T_{min}}{T_{out} - T_{max}}\right) = RC \ln\left(\frac{T_{out} - T_s + \Delta/2}{T_{out} - T_s - \Delta/2}\right) $$

2.  **降温阶段 (ON, $u=1$)**: 温度从 $T_{max}$ 开始，根据指数规律向[稳态温度](@entry_id:136775) $T^{ss} = T_{out} - RQ$ 趋近。达到 $T_{min}$ 所需的时间 $t_{on}$ 可通过求解以下方程得到：
    $$ T_{min} = T^{ss} + (T_{max} - T^{ss}) \exp\left(-\frac{t_{on}}{RC}\right) $$
    解得：
    $$ t_{on} = RC \ln\left(\frac{T_{max} - T^{ss}}{T_{min} - T^{ss}}\right) = RC \ln\left(\frac{T_s + \Delta/2 - (T_{out} - RQ)}{T_s - \Delta/2 - (T_{out} - RQ)}\right) $$

总的**循环周期** $P$ 是这两个阶段持续时间之和： $P = t_{on} + t_{off}$。这个表达式明确显示了循环周期是如何由建筑的[热力学](@entry_id:172368)参数（$R, C$）、设备的性能（$Q$）、环境条件（$T_{out}$）以及控制设定（$T_s, \Delta$）共同决定的。

### 模型精化与现实考量

基础的ETP模型虽然强大，但在应用于实际问题时，仍需考虑更多现实因素以提高其准确性。

#### 制冷功率与能效系数

模型中的制冷功率 $Q$ 是一个[热力学](@entry_id:172368)量，而我们通常更容易测量的是设备的电功率 $P$。两者通过**能效系数**（Coefficient of Performance, COP）相关联，通常用 $\eta$ 表示 ：
$$ Q = \eta P $$
对于一个理想的可逆[制冷循环](@entry_id:147498)（[卡诺循环](@entry_id:145876)），其COP取决于制冷剂在[蒸发器](@entry_id:189229)和冷凝器的工作温度 $T_c$ 和 $T_h$：
$$ \eta_{\text{Carnot,cool}} = \frac{T_c}{T_h - T_c} $$
这个关系表明，COP会随着**温差（temperature lift）** $(T_h - T_c)$ 的增大而降低。在实际的[蒸气压](@entry_id:136384)缩式制冷设备中，由于压缩机非理想（[等熵效率](@entry_id:146923)低于1）以及其他不可逆损失，实际的COP会低于卡诺极限，并且同样会随着温差的增大而下降。这意味着 $Q$ 并非一个恒定值，而是会随室内外工况变化。对于更精细的模型，需要考虑 $\eta$ 对温度的依赖性。

#### 内部热源与渗透

除了通过围护结构的热交换，建筑内还存在其他热源，统称为**内部热源**。同时，由于风压和烟囱效应，室外空气会通过门窗缝隙渗入室内，这一过程称为**空气渗透**。为了使模型更完整，我们可以引入一个总的附加增益项 $G(t)$ 。
$$ C \dot{T}(t) = \frac{T_{out}(t) - T(t)}{R} - u(t) Q + G(t) $$
这个增益项 $G(t)$ 通常包括：
-   **内部热源**: 来自人员的显热 $Q_{occ}(t)$、照明和电器的散热 $Q_{app}(t)$，以及通过窗户透入的太阳辐射得热 $Q_{sol}(t)$。
-   **空气渗透**: 设空气渗透的质量流率为 $\dot{m}(t)$，空气比热为 $c_p$。进入的室外空气和排出的室内空气之间的焓差造成了净热增益，其速率为 $\dot{m}(t) c_p (T_{out}(t) - T(t))$。

因此，一个更全面的增益项表达式为：
$$ G(t) = \dot{m}(t) c_p (T_{out}(t) - T(t)) + Q_{occ}(t) + Q_{app}(t) + Q_{sol}(t) $$
将这些因素纳入模型，可以显著提高其在真实建筑能耗分析和预测中的准确性。

### 模型保真度与简化

我们一直使用的单节点（一阶）ETP模型是TCL建模的有力工具，但它隐含了将整个建筑区域视为单一热容的假设。在某些情况下，这种简化可能不足以捕捉系统的全部动态。

#### 二阶模型与时间尺度分离

为了提高模型的保真度，我们可以采用一个**二阶（双节点）模型**，将建筑热容分解为两个主要部分：室内空气热容 $C_a$ 和建筑围护结构（墙体）热容 $C_w$。这样，系统就有两个[状态变量](@entry_id:138790)：空气温度 $T_a(t)$ 和墙体温度 $T_w(t)$。它们之间的能量交换由一个内部热阻 $R_{aw}$ 描述，而墙体与室外环境的交换由外部热阻 $R_o$ 描述。

该[二阶系统](@entry_id:276555)的[动力学方程组](@entry_id:202106)为 ：
$$ C_a \dot{T}_a = \frac{T_w - T_a}{R_{aw}} - u(t)Q $$
$$ C_w \dot{T}_w = \frac{T_a - T_w}{R_{aw}} + \frac{T_{out} - T_w}{R_o} $$
这个线性系统有两个特征值，对应两个不同的**自然时间尺度**：一个“快”时间尺度和一个“慢”时间尺度。

-   **快时间尺度** $\tau_{fast}$ 通常与室内空气和墙体之间的快速热交换相关，近似为 $\tau_{fast} \approx R_{aw}C_a$。它描述了室内空气温度如何迅速响应设备启停或与墙体的热交换。
-   **慢时间尺度** $\tau_{slow}$ 通常与厚重的墙体和外部环境之间的缓慢热交换相关，近似为 $\tau_{slow} \approx (R_{aw}+R_o)C_w$ 或在特定条件下简化为 $R_o C_w$。它描述了整个建筑的长期储热和释热行为。

#### 模型简化的合理性

何时可以将一个二阶[模型简化](@entry_id:171175)为我们之前使用的一阶模型呢？答案在于**时间尺度分离**。

当快时间尺度 $\tau_{fast}$ 远小于慢时间尺度 $\tau_{slow}$，并且我们关心的现象（如TCL的聚合响应或以30-60分钟为间隔的电网调度）发生在比 $\tau_{fast}$ 长得多的时间尺度上时，我们就可以进行[模型降阶](@entry_id:171175)。在这种情况下，快速动态（空气温度的波动）可以被视为瞬时达到平衡，而系统的整体行为由慢速动态主导。

例如，对于一个轻质结构内部和重质围护结构的建筑（$C_a \ll C_w$），其 $\tau_{fast}$ 可能只有几分钟，而 $\tau_{slow}$ 可能长达数小时。对于15分钟以上的应用场景，空气温度 $T_a$ 可以认为总是紧密跟随墙体温度 $T_w$ 的变化。因此，可以将这两个节点合并，保留较慢的、能量存储量更大的墙体温度 $T_w$ 作为唯一的等效[状态变量](@entry_id:138790)。这为使用一阶ETP模型提供了理论依据，并指明了模型中的状态变量 $T$ 在物理上更接近于哪个部分的温度。反之，如果两个时间尺度相当，或者我们关心的现象与快速动态的频率相近，那么保留二阶模型就至关重要了。