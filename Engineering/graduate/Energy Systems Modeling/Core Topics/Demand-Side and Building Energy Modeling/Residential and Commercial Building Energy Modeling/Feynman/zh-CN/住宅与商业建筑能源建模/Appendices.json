{
    "hands_on_practices": [
        {
            "introduction": "建筑能源模型通常由更小的组件构建而成。墙体是分隔室内与室外的基本构件，其热工性能是模型的基础。本练习侧重于使用集总参数热网络模型（例如2R1C模型）来简化和分析墙体复杂的传热过程。通过这个实践，您将掌握在简单的稳态环境下热阻和能量守恒的核心概念，为构建更复杂的动态模型打下坚实的基础。",
            "id": "4118238",
            "problem": "一个有空调的商业空间的单面墙被建模为一个二阻一容（$2\\mathrm{R}1\\mathrm{C}$）集总参数网络。室外空气温度恒定为 $T_{o}=0~^{\\circ}\\mathrm{C}$，区域空气温度由供暖、通风和空调系统调节在恒定设定点 $T_{z}=21~^{\\circ}\\mathrm{C}$。该墙体由一个内部集总热容节点表示，其温度为 $T_{w}$，该节点通过热阻 $R_{1}=0.5~\\mathrm{K/W}$ 与室外空气相连，通过热阻 $R_{2}=0.8~\\mathrm{K/W}$ 与区域空气相连。该节点的集总热容为 $C=40~\\mathrm{kJ/K}$。假设热传递为一维，并且在工作范围内，热阻是有效的、线性的和时不变的。\n\n从应用于集总墙体节点的能量守恒（热力学第一定律）和通过热阻的传导热流定义为温差除以热阻出发，确定通过墙体的稳态热流 $q$（定义为从区域空气流向室外空气时为正）和稳态墙体节点温度 $T_{w}$。请以 $\\mathrm{W}$ 为单位表示 $q$，以 $^{\\circ}\\mathrm{C}$ 为单位表示 $T_{w}$。将每个结果四舍五入至四位有效数字。",
            "solution": "该问题是适定的，有科学依据，并包含了获得唯一解所需的所有信息。所描述的模型是一个标准的集总参数热网络，问题涉及其稳态行为，这是传热学和建筑能耗分析中的一个基本概念。\n\n分析从应用于集总墙体节点的热力学第一定律开始，该节点的温度为 $T_w$，热容为 $C$。节点的内能变化率等于进入节点的净热传递速率。热量通过热阻 $R_2$ 从温度为 $T_z$ 的区域空气进入节点。热量通过热阻 $R_1$ 从节点传递到温度为 $T_o$ 的室外空气。\n\n该节点的能量平衡方程为：\n$$ C \\frac{dT_w}{dt} = \\dot{Q}_{\\text{in}} - \\dot{Q}_{\\text{out}} $$\n\n热流率由温差和热阻定义：\n从区域到墙体节点的热流为 $\\dot{Q}_{z \\to w} = \\frac{T_z - T_w}{R_2}$。\n从墙体节点到室外的热流为 $\\dot{Q}_{w \\to o} = \\frac{T_w - T_o}{R_1}$。\n\n将这些表达式代入能量平衡方程，得到：\n$$ C \\frac{dT_w}{dt} = \\frac{T_z - T_w}{R_2} - \\frac{T_w - T_o}{R_1} $$\n\n问题要求的是稳态条件。在稳态下，墙体节点的温度不随时间变化，即 $\\frac{dT_w}{dt} = 0$。因此，墙体的热容 $C$（给定值为 $C=40~\\mathrm{kJ/K}$）与稳态计算无关。将时间导数设为零，可将能量平衡简化为：\n$$ 0 = \\frac{T_z - T_w}{R_2} - \\frac{T_w - T_o}{R_1} $$\n\n该方程表示，在稳态下，流入节点的热流等于流出节点的热流：\n$$ \\frac{T_z - T_w}{R_2} = \\frac{T_w - T_o}{R_1} $$\n\n现在我们可以求解未知的稳态墙体温度 $T_w$。重新整理方程：\n$$ R_1 (T_z - T_w) = R_2 (T_w - T_o) $$\n$$ R_1 T_z - R_1 T_w = R_2 T_w - R_2 T_o $$\n$$ R_1 T_z + R_2 T_o = (R_1 + R_2) T_w $$\n$$ T_w = \\frac{R_1 T_z + R_2 T_o}{R_1 + R_2} $$\n\n现在，我们代入给定的数值：$T_z = 21~^{\\circ}\\mathrm{C}$，$T_o = 0~^{\\circ}\\mathrm{C}$，$R_1 = 0.5~\\mathrm{K/W}$，以及 $R_2 = 0.8~\\mathrm{K/W}$。由于温度计算是加权平均，其中热阻单位会抵消，因此我们可以直接使用摄氏度。\n$$ T_w = \\frac{(0.5~\\mathrm{K/W})(21~^{\\circ}\\mathrm{C}) + (0.8~\\mathrm{K/W})(0~^{\\circ}\\mathrm{C})}{0.5~\\mathrm{K/W} + 0.8~\\mathrm{K/W}} $$\n$$ T_w = \\frac{10.5}{1.3}~^{\\circ}\\mathrm{C} \\approx 8.076923...~^{\\circ}\\mathrm{C} $$\n四舍五入到四位有效数字，墙体节点温度为 $T_w = 8.077~^{\\circ}\\mathrm{C}$。\n\n接下来，我们确定稳态热流 $q$。问题定义 $q$ 从区域空气流向室外空气时为正。在稳态下，热流在整个热网络中是恒定的。它可以计算为总温差除以总热阻。热阻 $R_1$ 和 $R_2$ 是串联的，因此总热阻 $R_{total}$ 是它们的和：\n$$ R_{total} = R_1 + R_2 $$\n稳态热流 $q$ 则是：\n$$ q = \\frac{T_z - T_o}{R_{total}} = \\frac{T_z - T_o}{R_1 + R_2} $$\n\n代入数值：\n$$ q = \\frac{21~^{\\circ}\\mathrm{C} - 0~^{\\circ}\\mathrm{C}}{0.5~\\mathrm{K/W} + 0.8~\\mathrm{K/W}} $$\n摄氏度的温差等于开尔文的温差（$\\Delta T[^\\circ\\mathrm{C}] = \\Delta T[\\mathrm{K}]$）。\n$$ q = \\frac{21~\\mathrm{K}}{1.3~\\mathrm{K/W}} = \\frac{21}{1.3}~\\mathrm{W} \\approx 16.153846...~\\mathrm{W} $$\n四舍五入到四位有效数字，热流为 $q = 16.15~\\mathrm{W}$。\n\n作为验证，可以使用计算出的墙体温度 $T_w$ 来计算热流：\n$$ q = \\frac{T_w - T_o}{R_1} = \\frac{8.077~^{\\circ}\\mathrm{C} - 0~^{\\circ}\\mathrm{C}}{0.5~\\mathrm{K/W}} \\approx \\frac{8.077~\\mathrm{K}}{0.5~\\mathrm{K/W}} \\approx 16.154~\\mathrm{W} $$\n$$ q = \\frac{T_z - T_w}{R_2} = \\frac{21~^{\\circ}\\mathrm{C} - 8.077~^{\\circ}\\mathrm{C}}{0.8~\\mathrm{K/W}} \\approx \\frac{12.923~\\mathrm{K}}{0.8~\\mathrm{K/W}} \\approx 16.154~\\mathrm{W} $$\n微小的差异是由于在验证计算前对 $T_w$ 进行了舍入。使用未经舍入的 $T_w$ 值可以得到完全匹配的结果，这证实了结果的一致性。最终答案是按要求给出的舍入值。",
            "answer": "$$\\boxed{\\begin{pmatrix} 16.15  8.077 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在理解了单个构件后，我们可以对整个建筑区域进行建模，这涉及到将通过围护结构的传热与内部热源、太阳辐射和通风系统整合在一起。本练习将热力学第一定律应用于一个充分混合的空气区域，以推导出控制该区域温度的一阶常微分方程。通过解决这个问题，您将学习如何建立和分析一个完整的区域能量平衡模型——这是建筑模拟的基石，并能深入了解决定建筑热响应时间的因素。",
            "id": "4118294",
            "problem": "一个单一充分混合区域模型用于一个机械制冷的开放式办公室。建筑面积为 $200$ m$^2$，对室外的总传热系数为 $U A = 150$ W/K。该区域由供暖、通风和空调 (HVAC) 系统供气，质量流率为 $\\dot{m}_{sa} = 0.6$ kg/s，送风温度恒定为 $T_{sa} = 16^\\circ$C。室外空气温度为 $T_{o} = 30^\\circ$C。内部热增益恒定为 $Q_{int} = 3$ kW，太阳辐射增益初始恒定为 $Q_{sol} = 2$ kW。区域空气和轻质物体的有效热容为 $C_{z} = 300$ kJ/K。假设空气的定压比热为 $c_{p} = 1005$ J/(kg K)。忽略渗透和湿度效应。考虑一个充分混合区域空气节点的标准第一性原理能量平衡。\n\n- 首先，根据基本原理推导并计算与给定恒定输入相对应的稳态区域空气温度 $T_{z,ss}$。\n- 接着，假设在时间 $t=0$ 时，太阳辐射增益 $Q_{sol}$ 发生阶跃变化到一个新的恒定值。使用相同的第一性原理模型，确定控制区域空气温度对此阶跃的一阶瞬态响应的时间常数 $\\tau$。\n\n将您的答案四舍五入至四位有效数字。$T_{z,ss}$ 以摄氏度表示，$\\tau$ 以分钟表示。最终答案必须在一行中以两个值的形式报告。",
            "solution": "该问题被认为是有效的，因为它在科学上基于热力学和传热原理，问题设定良好，提供了足够的信息以获得唯一解，并且以客观、正式的语言表述。我们可以继续进行求解。\n\n第一步是为这个单一充分混合区域建立主导的第一性原理能量平衡方程。区域热质量内能的变化率等于所有热增益之和减去所有热损失之和。区域的热能由 $C_z T_z$ 给出。其变化率为 $C_z \\frac{dT_z}{dt}$。\n\n区域的热增益和热损失包括：\n1.  恒定的内部热增益，$Q_{int}$。\n2.  太阳辐射热增益，$Q_{sol}$。\n3.  通过建筑围护结构（总传热系数 $UA$）与温度为 $T_o$ 的室外进行的热传递。如果 $T_o > T_z$，这是热增益；如果 $T_z > T_o$，这是热损失。热流率为 $UA (T_o - T_z)$。\n4.  来自HVAC系统的净传热，该系统以质量流率 $\\dot{m}_{sa}$ 和温度 $T_{sa}$ 供应空气。由于区域是充分混合的，离开区域的空气温度为区域温度 $T_z$。平流进入区域的净能量率为 $\\dot{m}_{sa} c_p (T_{sa} - T_z)$。\n\n将这些项合并，得到区域空气温度 $T_z$ 的主导常微分方程 (ODE)：\n$$\nC_z \\frac{dT_z}{dt} = Q_{int} + Q_{sol} + UA (T_o - T_z) + \\dot{m}_{sa} c_p (T_{sa} - T_z)\n$$\n这个方程是解决问题两个部分的基础。\n\n首先，我们将求稳态区域空气温度 $T_{z,ss}$。在稳态下，区域的温度是恒定的，这意味着时间导数为零：$\\frac{dT_z}{dt} = 0$。将ODE的左侧设为零，我们得到：\n$$\n0 = Q_{int} + Q_{sol} + UA (T_o - T_{z,ss}) + \\dot{m}_{sa} c_p (T_{sa} - T_{z,ss})\n$$\n我们现在可以通过重新排列各项来求解 $T_{z,ss}$。首先，展开包含 $T_{z,ss}$ 的项：\n$$\n0 = Q_{int} + Q_{sol} + UA T_o - UA T_{z,ss} + \\dot{m}_{sa} c_p T_{sa} - \\dot{m}_{sa} c_p T_{z,ss}\n$$\n将所有涉及 $T_{z,ss}$ 的项收集到一边：\n$$\nUA T_{z,ss} + \\dot{m}_{sa} c_p T_{z,ss} = Q_{int} + Q_{sol} + UA T_o + \\dot{m}_{sa} c_p T_{sa}\n$$\n提取公因式 $T_{z,ss}$：\n$$\nT_{z,ss} (UA + \\dot{m}_{sa} c_p) = Q_{int} + Q_{sol} + UA T_o + \\dot{m}_{sa} c_p T_{sa}\n$$\n最后，稳态温度的表达式为：\n$$\nT_{z,ss} = \\frac{Q_{int} + Q_{sol} + UA T_o + \\dot{m}_{sa} c_p T_{sa}}{UA + \\dot{m}_{sa} c_p}\n$$\n现在，我们代入给定的数值。所有温度都可以用摄氏度表示，因为方程结构是一个加权平均，这使得选择摄氏温标或开尔文温标对结果是等效的。我们必须确保所有其他单位是一致的（国际单位制：W, J, s, kg, K）。\n\n给定值：\n$Q_{int} = 3 \\text{ kW} = 3000 \\text{ W}$\n$Q_{sol} = 2 \\text{ kW} = 2000 \\text{ W}$\n$UA = 150 \\text{ W/K}$\n$T_o = 30^\\circ\\text{C}$\n$\\dot{m}_{sa} = 0.6 \\text{ kg/s}$\n$c_p = 1005 \\text{ J/(kg K)}$\n$T_{sa} = 16^\\circ\\text{C}$\n\n首先，计算平流传热系数：\n$\\dot{m}_{sa} c_p = 0.6 \\text{ kg/s} \\times 1005 \\text{ J/(kg K)} = 603 \\text{ W/K}$\n\n现在，将所有值代入 $T_{z,ss}$ 的表达式中：\n$$\nT_{z,ss} = \\frac{3000 + 2000 + (150 \\times 30) + (603 \\times 16)}{150 + 603}\n$$\n$$\nT_{z,ss} = \\frac{5000 + 4500 + 9648}{753} = \\frac{19148}{753} \\approx 25.42895... \\text{ }^\\circ\\text{C}\n$$\n四舍五入到四位有效数字，稳态温度为 $T_{z,ss} = 25.43^\\circ\\text{C}$。\n\n接下来，我们确定系统的时间常数 $\\tau$。时间常数表征了一阶系统对其输入变化的响应速率。为了找到它，我们将原始ODE重新整理成一阶线性系统的标准形式：$\\tau \\frac{dy}{dt} + y = K \\cdot f(t)$。\n\n从完整的ODE开始：\n$$\nC_z \\frac{dT_z}{dt} = Q_{int} + Q_{sol} + UA T_o - UA T_z + \\dot{m}_{sa} c_p T_{sa} - \\dot{m}_{sa} c_p T_z\n$$\n将所有包含状态变量 $T_z$ 的项组合到等式左侧：\n$$\nC_z \\frac{dT_z}{dt} + UA T_z + \\dot{m}_{sa} c_p T_z = Q_{int} + Q_{sol} + UA T_o + \\dot{m}_{sa} c_p T_{sa}\n$$\n提取公因式 $T_z$：\n$$\nC_z \\frac{dT_z}{dt} + (UA + \\dot{m}_{sa} c_p) T_z = Q_{int} + Q_{sol} + UA T_o + \\dot{m}_{sa} c_p T_{sa}\n$$\n为了匹配标准形式 $\\tau \\frac{dT_z}{dt} + T_z = ...$，我们将整个方程除以 $T_z$ 的系数，即 $(UA + \\dot{m}_{sa} c_p)$：\n$$\n\\frac{C_z}{UA + \\dot{m}_{sa} c_p} \\frac{dT_z}{dt} + T_z = \\frac{Q_{int} + Q_{sol} + UA T_o + \\dot{m}_{sa} c_p T_{sa}}{UA + \\dot{m}_{sa} c_p}\n$$\n通过将此方程与标准形式进行比较，我们可以将时间常数 $\\tau$ 识别为导数项的系数：\n$$\n\\tau = \\frac{C_z}{UA + \\dot{m}_{sa} c_p}\n$$\n请注意，时间常数仅取决于系统的内在属性（热容 $C_z$ 和热损失系数 $UA$ 和 $\\dot{m}_{sa} c_p$），并且独立于外部强迫函数，如热增益和温度。\n\n我们代入给定的数值，确保单位一致：\n$C_z = 300 \\text{ kJ/K} = 300 \\times 10^3 \\text{ J/K} = 300000 \\text{ J/K}$\n$UA + \\dot{m}_{sa} c_p = 150 \\text{ W/K} + 603 \\text{ W/K} = 753 \\text{ W/K} = 753 \\text{ J/(s K)}$\n\n现在，我们计算 $\\tau$：\n$$\n\\tau = \\frac{300000 \\text{ J/K}}{753 \\text{ J/(s K)}} \\approx 398.40637... \\text{ s}\n$$\n问题要求时间常数以分钟为单位。我们通过除以 $60$ 将秒转换为分钟：\n$$\n\\tau_{\\text{min}} = \\frac{398.40637...}{60} \\approx 6.640106... \\text{ min}\n$$\n四舍五入到四位有效数字，时间常数为 $\\tau = 6.640$ 分钟。\n\n两个要求的值是 $T_{z,ss} = 25.43^\\circ\\text{C}$ 和 $\\tau = 6.640 \\text{ min}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 25.43  6.640 \\end{pmatrix}}$$"
        },
        {
            "introduction": "我们之前讨论的理论模型需要准确的参数（如 $R$ 和 $C$）才能发挥作用，而一个有效的方法便是从测量的性能数据中估计它们。本练习将指导您完成系统辨识的过程，您将使用非线性最小二乘法，将一阶RC模型的响应与温度时间序列数据进行拟合，从而估算等效热阻和热容。这个编程实践提供了现代建筑性能分析中一项关键技能的动手经验：将简单的、具有物理意义的模型与真实世界的数据进行校准，以用于诊断、控制和预测。",
            "id": "4118274",
            "problem": "考虑一个由一阶电阻-电容 (RC) 模型理想化的单区域建筑。该区域的热能平衡遵循能量守恒定律，即内能的变化率等于流入该区域的净热流。设 $T(t)$ 表示区域空气温度，$T_{\\mathrm{out}}$ 为恒定的室外温度，$P(t)$ 为施加的供暖输入功率，$R$ 为区域与室外之间的有效热阻，$C$ 为区域空气和内部构件的有效热容。假设空气混合均匀，除了施加的阶跃输入外，其他内部得热可忽略不计，并且只有一个由 $R$ 表征的散热路径。其控制常微分方程为\n$$\nC \\frac{dT(t)}{dt} = -\\frac{T(t) - T_{\\mathrm{out}}}{R} + P(t).\n$$\n在 $t \\ge 0$ 时阶跃输入为 $P(t) = P_{\\mathrm{step}}$ 且初始条件为 $T(0) = T_0$ 的情况下，其响应是趋向新稳态的典型一阶指数过程。稳态增益 $K$ 定义为温升与输入功率的渐近比值，时间常数 $\\tau$ 定义为在阶跃输入下，响应达到其最终变化量的 $1 - e^{-1}$ 分数所需的时间。从第一性原理出发，将物理模型参数 $R$ 和 $C$ 与阶跃响应描述符 $K$ 和 $\\tau$ 联系起来，并利用此关系通过拟合 $K$ 和 $\\tau$ 从测量的阶跃响应中估算 $R$ 和 $C$。\n\n您的任务是编写一个完整的、可运行的程序，对于每个提供的测试用例，通过非线性最小二乘法估算阶跃响应参数 $K$ 和 $\\tau$，将一阶 RC 阶跃响应拟合到测量到的温度时间序列数据，然后使用物理上一致的 RC 解释将它们映射到 $R$ 和 $C$。拟合应考虑相对于 $T_{\\mathrm{out}}$ 可能存在的非零初始温度偏移。\n\n您必须使用以下模型来拟合测量温度 $T_{\\mathrm{meas}}(t)$：\n$$\nT_{\\mathrm{model}}(t; K, \\tau, \\Delta T_0) = T_{\\mathrm{out}} + \\Delta T_0 \\, e^{-t/\\tau} + K \\, P_{\\mathrm{step}} \\left(1 - e^{-t/\\tau}\\right),\n$$\n其中 $\\Delta T_0 = T_0 - T_{\\mathrm{out}}$ 是一个未知的初始偏移量，将与 $K$ 和 $\\tau$ 联合估算。在估算出 $K$ 和 $\\tau$ 之后，计算与 RC 模型一致的 $R$ 和 $C$。将 $R$ 以 $\\mathrm{K}\\cdot\\mathrm{kW}^{-1}$ 为单位表示，$C$ 以 $\\mathrm{kWh}\\cdot\\mathrm{K}^{-1}$ 为单位表示，并将每个值四舍五入到四位小数。\n\n测试套件。对于以下每个案例，测量数据都是根据模型生成的，并添加了确定性测量扰动 $\\epsilon(t)$ 以模拟真实测量。所有时间单位为小时，温度单位为摄氏度，功率单位为千瓦。对于每个案例，测量序列由以下公式给出\n$$\nT_{\\mathrm{meas}}(t) = T_{\\mathrm{out}} + \\Delta T_0 \\, e^{-t/\\tau_{\\mathrm{true}}} + K_{\\mathrm{true}} \\, P_{\\mathrm{step}} \\left(1 - e^{-t/\\tau_{\\mathrm{true}}}\\right) + \\epsilon(t),\n$$\n其中 $(\\tau_{\\mathrm{true}}, K_{\\mathrm{true}}, P_{\\mathrm{step}}, T_{\\mathrm{out}}, \\Delta T_0)$ 已知，并指定了采样时间 $t$ 和扰动 $\\epsilon(t)$：\n\n- 案例 A（理想情况，中等动态特性）：\n  - $\\tau_{\\mathrm{true}} = 3$ 小时, $K_{\\mathrm{true}} = 1$ $\\mathrm{K}\\cdot\\mathrm{kW}^{-1}$, $P_{\\mathrm{step}} = 2$ $\\mathrm{kW}$, $T_{\\mathrm{out}} = 10$ $\\mathrm{^{\\circ}C}$, $\\Delta T_0 = 0$ $\\mathrm{K}$。\n  - 采样时间 $t = \\{0, 0.5, 1, 1.5, 2, 3, 6\\}$ 小时。\n  - 扰动 $\\epsilon(t) = 0.05 \\sin\\left(\\pi t / \\tau_{\\mathrm{true}}\\right)$ $\\mathrm{K}$。\n\n- 案例 B（边界情况，快速动态特性）：\n  - $\\tau_{\\mathrm{true}} = 0.25$ 小时, $K_{\\mathrm{true}} = 0.8$ $\\mathrm{K}\\cdot\\mathrm{kW}^{-1}$, $P_{\\mathrm{step}} = 1.5$ $\\mathrm{kW}$, $T_{\\mathrm{out}} = 15$ $\\mathrm{^{\\circ}C}$, $\\Delta T_0 = 0$ $\\mathrm{K}$。\n  - 采样时间 $t = \\{0, 0.1, 0.2, 0.3, 0.5, 1.0, 2.0\\}$ 小时。\n  - 扰动 $\\epsilon(t) = 0.02 \\cos\\left(3 t\\right)$ $\\mathrm{K}$。\n\n- 案例 C（极端情况，采样粗糙的极慢动态特性）：\n  - $\\tau_{\\mathrm{true}} = 12$ 小时, $K_{\\mathrm{true}} = 1.2$ $\\mathrm{K}\\cdot\\mathrm{kW}^{-1}$, $P_{\\mathrm{step}} = 3$ $\\mathrm{kW}$, $T_{\\mathrm{out}} = 5$ $\\mathrm{^{\\circ}C}$, $\\Delta T_0 = 0$ $\\mathrm{K}$。\n  - 采样时间 $t = \\{0, 2, 4, 8, 12, 24\\}$ 小时。\n  - 扰动 $\\epsilon(t) = 0.01 \\, t / 24$ $\\mathrm{K}$。\n\n- 案例 D（极端情况，非零初始偏移）：\n  - $\\tau_{\\mathrm{true}} = 3$ 小时, $K_{\\mathrm{true}} = 1$ $\\mathrm{K}\\cdot\\mathrm{kW}^{-1}$, $P_{\\mathrm{step}} = 1.5$ $\\mathrm{kW}$, $T_{\\mathrm{out}} = 10$ $\\mathrm{^{\\circ}C}$, $\\Delta T_0 = 2$ $\\mathrm{K}$。\n  - 采样时间 $t = \\{0, 0.5, 1, 2, 3, 4, 6\\}$ 小时。\n  - 扰动 $\\epsilon(t) = -0.03 \\sin\\left(2 \\pi t / 6\\right)$ $\\mathrm{K}$。\n\n所需输出。对于每个案例，通过将 $T_{\\mathrm{model}}(t; K, \\tau, \\Delta T_0)$ 拟合到 $T_{\\mathrm{meas}}(t)$ 来估算 $K$ 和 $\\tau$，然后使用物理上一致的 RC 解释计算 $R$ 和 $C$，并返回四舍五入到四位小数的数对 $[R, C]$。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，列表中的条目是每个案例的双元素列表，顺序为 A, B, C, D。例如，输出格式必须类似于“[[resA],[resB],[resC],[resD]]”，其中每个“resX”的形式为“[R,C]”。",
            "solution": "其基本原理是将能量守恒应用于集总参数的单区域建筑模型。设 $T(t)$ 为区域空气温度，$T_{\\mathrm{out}}$ 为恒定的室外温度，$P(t)$ 为供暖输入功率，$R$ 为对环境的有效热阻，$C$ 为捕捉空气和建筑内表面储热的有效热容。在标准假设下（区域空气混合均匀，单一主导散热路径由 $R$ 表示，无其他动态热源），能量平衡方程为\n$$\nC \\frac{dT(t)}{dt} = \\dot{Q}_{\\mathrm{in}}(t) + \\dot{Q}_{\\mathrm{loss}}(t),\n$$\n其中 $\\dot{Q}_{\\mathrm{in}}(t) = P(t)$ 且 $\\dot{Q}_{\\mathrm{loss}}(t) = -\\frac{T(t) - T_{\\mathrm{out}}}{R}$。这得到一阶线性常微分方程\n$$\nC \\frac{dT(t)}{dt} + \\frac{1}{R} \\left(T(t) - T_{\\mathrm{out}}\\right) = P(t).\n$$\n定义温差 $\\Delta T(t) = T(t) - T_{\\mathrm{out}}$。则\n$$\nC \\frac{d \\Delta T(t)}{dt} + \\frac{1}{R} \\Delta T(t) = P(t).\n$$\n对于 $t \\ge 0$ 的阶跃输入 $P(t) = P_{\\mathrm{step}}$ 和初始温差 $\\Delta T(0) = \\Delta T_0$，这个线性时不变系统的解可以通过求解一阶线性微分方程的标准方法（积分因子法或齐次解加特解法）得到。齐次解为\n$$\n\\Delta T_{\\mathrm{hom}}(t) = \\Delta T_0 \\, e^{-t/\\tau},\n$$\n其中时间常数为\n$$\n\\tau = R C.\n$$\n对于恒定输入的特解是满足以下条件的恒定稳态温差 $\\Delta T_{\\mathrm{ss}}$\n$$\n\\frac{1}{R} \\Delta T_{\\mathrm{ss}} = P_{\\mathrm{step}} \\quad \\Rightarrow \\quad \\Delta T_{\\mathrm{ss}} = R \\, P_{\\mathrm{step}}.\n$$\n因此，完整的阶跃响应为\n$$\n\\Delta T(t) = \\Delta T_0 \\, e^{-t/\\tau} + R \\, P_{\\mathrm{step}} \\left(1 - e^{-t/\\tau}\\right).\n$$\n根据定义，稳态增益 $K$ 是单位阶跃下温升与输入功率的渐近比值，即，\n$$\nK = \\lim_{t \\to \\infty} \\frac{\\Delta T(t)}{P_{\\mathrm{step}}} = R.\n$$\n因此，阶跃响应描述符与 RC 参数之间的物理一致性映射关系为\n$$\nK = R, \\qquad \\tau = R C \\quad \\Rightarrow \\quad C = \\frac{\\tau}{R} = \\frac{\\tau}{K}.\n$$\n这些关系不依赖于任何“捷径”，而是直接从求解控制方程中得出的。\n\n拟合的算法设计。给定在时间点 $\\{t_i\\}$ 测得的温度 $\\{T_{\\mathrm{meas}}(t_i)\\}$，以及已知的阶跃输入 $P_{\\mathrm{step}}$ 和已知的 $T_{\\mathrm{out}}$，我们拟合参数模型\n$$\nT_{\\mathrm{model}}(t; K, \\tau, \\Delta T_0) = T_{\\mathrm{out}} + \\Delta T_0 \\, e^{-t/\\tau} + K \\, P_{\\mathrm{step}} \\left(1 - e^{-t/\\tau}\\right)\n$$\n到数据上，使用非线性最小二乘法估算参数 $(K, \\tau, \\Delta T_0)$。这种选择既捕捉了初始偏移，也捕捉了向新稳态的指数过渡过程。为确保物理真实性，我们约束 $K > 0$ 和 $\\tau > 0$，同时允许 $\\Delta T_0$ 为任意实数值。实用的初始猜测值为\n$$\nK_0 \\approx \\frac{T_{\\mathrm{meas}}(t_{\\max}) - T_{\\mathrm{out}}}{P_{\\mathrm{step}}}, \\quad \\tau_0 \\approx \\alpha \\, t_{\\max}, \\quad \\Delta T_{0,0} \\approx T_{\\mathrm{meas}}(0) - T_{\\mathrm{out}},\n$$\n其中 $\\alpha$ 是一个适中的分数，例如 $\\alpha = 0.3$，且 $t_{\\max} = \\max_i t_i$。然后我们求解最小化问题\n$$\n\\min_{K > 0, \\,\\tau > 0, \\,\\Delta T_0 \\in \\mathbb{R}} \\sum_i \\left[T_{\\mathrm{meas}}(t_i) - T_{\\mathrm{model}}(t_i; K, \\tau, \\Delta T_0)\\right]^2,\n$$\n使用适用于有界约束非线性最小二乘问题的信赖域反射算法。一旦估算出 $(K, \\tau)$，我们便计算\n$$\nR = K, \\qquad C = \\frac{\\tau}{K}.\n$$\n\n测试套件综合。每个案例中的测量数据都是由相同的物理模型加上一个指定的扰动项 $\\epsilon(t)$ 确定性地生成的：\n$$\nT_{\\mathrm{meas}}(t) = T_{\\mathrm{out}} + \\Delta T_0 \\, e^{-t/\\tau_{\\mathrm{true}}} + K_{\\mathrm{true}} \\, P_{\\mathrm{step}} \\left(1 - e^{-t/\\tau_{\\mathrm{true}}}\\right) + \\epsilon(t).\n$$\n- 案例 A 使用 $\\tau_{\\mathrm{true}} = 3$, $K_{\\mathrm{true}} = 1$, $P_{\\mathrm{step}} = 2$, $T_{\\mathrm{out}} = 10$, $\\Delta T_0 = 0$, 采样时间 $\\{0, 0.5, 1, 1.5, 2, 3, 6\\}$, 以及 $\\epsilon(t) = 0.05 \\sin\\left(\\pi t / 3\\right)$。\n- 案例 B 使用 $\\tau_{\\mathrm{true}} = 0.25$, $K_{\\mathrm{true}} = 0.8$, $P_{\\mathrm{step}} = 1.5$, $T_{\\mathrm{out}} = 15$, $\\Delta T_0 = 0$, 采样时间 $\\{0, 0.1, 0.2, 0.3, 0.5, 1.0, 2.0\\}$, 以及 $\\epsilon(t) = 0.02 \\cos(3 t)$。\n- 案例 C 使用 $\\tau_{\\mathrm{true}} = 12$, $K_{\\mathrm{true}} = 1.2$, $P_{\\mathrm{step}} = 3$, $T_{\\mathrm{out}} = 5$, $\\Delta T_0 = 0$, 采样时间 $\\{0, 2, 4, 8, 12, 24\\}$, 以及 $\\epsilon(t) = 0.01 \\, t / 24$。\n- 案例 D 使用 $\\tau_{\\mathrm{true}} = 3$, $K_{\\mathrm{true}} = 1$, $P_{\\mathrm{step}} = 1.5$, $T_{\\mathrm{out}} = 10$, $\\Delta T_0 = 2$, 采样时间 $\\{0, 0.5, 1, 2, 3, 4, 6\\}$, 以及 $\\epsilon(t) = -0.03 \\sin\\left(2 \\pi t / 6\\right)$。\n\n预期结果。由于扰动幅度很小且模型指定正确，拟合的 $(K, \\tau)$ 应接近真实值，因此计算出的 $(R, C)$ 在案例 A 中应接近 $(1, 3)$，在案例 B 中应接近 $(0.8, 0.3125)$，在案例 C 中应接近 $(1.2, 10)$，在案例 D 中应接近 $(1, 3)$，所有单位均与各自的单位一致。最终的程序将为每个案例实现此拟合，并以精确要求的格式打印一行包含 $[R, C]$ 对列表的结果，四舍五入到四位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef model_temperature(t, K, tau, dT0, P_step, T_out):\n    \"\"\"\n    First-order RC step response model for zone temperature.\n    T(t) = T_out + dT0 * exp(-t/tau) + K * P_step * (1 - exp(-t/tau))\n    \"\"\"\n    return T_out + dT0 * np.exp(-t / tau) + K * P_step * (1.0 - np.exp(-t / tau))\n\ndef generate_measured_data(t, K_true, tau_true, dT0, P_step, T_out, noise_fn):\n    \"\"\"\n    Generate deterministic 'measured' temperature time series.\n    \"\"\"\n    clean = T_out + dT0 * np.exp(-t / tau_true) + K_true * P_step * (1.0 - np.exp(-t / tau_true))\n    noise = noise_fn(t)\n    return clean + noise\n\ndef fit_K_tau_dT0(t, T_meas, P_step, T_out):\n    \"\"\"\n    Fit the model T_model(t; K, tau, dT0) to measured data via nonlinear least squares.\n    Constrain K > 0 and tau > 0; dT0 is unconstrained.\n    \"\"\"\n    t = np.asarray(t, dtype=float)\n    T_meas = np.asarray(T_meas, dtype=float)\n    t_max = float(np.max(t)) if np.max(t) > 0 else 1.0\n\n    # Initial guesses\n    K0 = max(1e-6, (T_meas[-1] - T_out) / P_step)  # approximate steady gain\n    tau0 = max(1e-6, 0.3 * t_max)                  # moderate fraction of span\n    dT0_0 = T_meas[0] - T_out                      # initial offset\n\n    # Bounds: K > 0, tau > 0, dT0 free\n    lower_bounds = [1e-6, 1e-6, -np.inf]\n    upper_bounds = [np.inf, np.inf, np.inf]\n\n    # Define wrapper for curve_fit with fixed P_step and T_out\n    def f(t, K, tau, dT0):\n        return model_temperature(t, K, tau, dT0, P_step, T_out)\n\n    try:\n        popt, _ = curve_fit(\n            f, t, T_meas, p0=[K0, tau0, dT0_0],\n            bounds=(lower_bounds, upper_bounds),\n            method='trf', max_nfev=10000\n        )\n        K_est, tau_est, dT0_est = popt\n    except Exception:\n        # Fallback: use initial guesses if fitting fails\n        K_est, tau_est, dT0_est = K0, tau0, dT0_0\n\n    return float(K_est), float(tau_est), float(dT0_est)\n\ndef solve():\n    # Define deterministic noise functions for each case.\n    def noise_A(t):\n        tau_true = 3.0\n        return 0.05 * np.sin(np.pi * t / tau_true)\n\n    def noise_B(t):\n        return 0.02 * np.cos(3.0 * t)\n\n    def noise_C(t):\n        return 0.01 * (t / 24.0)\n\n    def noise_D(t):\n        return -0.03 * np.sin(2.0 * np.pi * t / 6.0)\n\n    # Test cases: list of dicts with parameters and time grid.\n    test_cases = [\n        # Case A\n        {\n            \"t\": np.array([0.0, 0.5, 1.0, 1.5, 2.0, 3.0, 6.0], dtype=float),\n            \"K_true\": 1.0,\n            \"tau_true\": 3.0,\n            \"dT0\": 0.0,\n            \"P_step\": 2.0,\n            \"T_out\": 10.0,\n            \"noise_fn\": noise_A\n        },\n        # Case B\n        {\n            \"t\": np.array([0.0, 0.1, 0.2, 0.3, 0.5, 1.0, 2.0], dtype=float),\n            \"K_true\": 0.8,\n            \"tau_true\": 0.25,\n            \"dT0\": 0.0,\n            \"P_step\": 1.5,\n            \"T_out\": 15.0,\n            \"noise_fn\": noise_B\n        },\n        # Case C\n        {\n            \"t\": np.array([0.0, 2.0, 4.0, 8.0, 12.0, 24.0], dtype=float),\n            \"K_true\": 1.2,\n            \"tau_true\": 12.0,\n            \"dT0\": 0.0,\n            \"P_step\": 3.0,\n            \"T_out\": 5.0,\n            \"noise_fn\": noise_C\n        },\n        # Case D\n        {\n            \"t\": np.array([0.0, 0.5, 1.0, 2.0, 3.0, 4.0, 6.0], dtype=float),\n            \"K_true\": 1.0,\n            \"tau_true\": 3.0,\n            \"dT0\": 2.0,\n            \"P_step\": 1.5,\n            \"T_out\": 10.0,\n            \"noise_fn\": noise_D\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        t = case[\"t\"]\n        K_true = case[\"K_true\"]\n        tau_true = case[\"tau_true\"]\n        dT0 = case[\"dT0\"]\n        P_step = case[\"P_step\"]\n        T_out = case[\"T_out\"]\n        noise_fn = case[\"noise_fn\"]\n\n        # Generate measured data\n        T_meas = generate_measured_data(t, K_true, tau_true, dT0, P_step, T_out, noise_fn)\n\n        # Fit parameters\n        K_est, tau_est, dT0_est = fit_K_tau_dT0(t, T_meas, P_step, T_out)\n\n        # Map to RC parameters\n        R_est = K_est                            # K = R\n        C_est = tau_est / R_est if R_est != 0 else np.nan  # tau = R*C\n\n        # Round to four decimals\n        R_out = round(R_est, 4)\n        C_out = round(C_est, 4)\n\n        results.append([R_out, C_out])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}