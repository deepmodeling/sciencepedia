{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在帮助您掌握直流（DC）潮流模型的核心计算方法。通过从零开始为一个简单的三节点网络构建模型，您将练习如何建立降阶后的节点导纳矩阵、求解电压相角，并最终计算功率转移分布因子（PTDF）。这项实践是进行任何更高级电网分析（如拥塞管理或市场模拟）所必需的基础计算技能。",
            "id": "4131826",
            "problem": "考虑一个无损的三母线输电网络，其中母线 $\\{1,2,3\\}$ 通过三条线路 $(1,2)$、$(2,3)$ 和 $(1,3)$ 连接成一个三角形。采用直流(DC)潮流近似法，电压幅值固定为 $1$ 标幺值，相角差很小，因此线路 $(i,j)$ 上的有功潮流为 $f_{ij} = b_{ij}\\,(\\theta_i - \\theta_j)$，其中 $b_{ij} > 0$ 是串联电纳，$\\theta_i$ 是母线 $i$ 处的电压相角（以弧度为单位）。Kirchhoff 电流定律 (KCL) 在每个非平衡母线处成立：净有功注入 $P_i$ 等于所有出入该母线线路的潮流之和。设母线 $2$ 为平衡母线，其相角 $\\theta_2 = 0$。给定的电纳为 $b_{12} = 8$ 标幺值，$b_{23} = 4$ 标幺值，以及 $b_{13} = 6$ 标幺值，所有值都基于系统基准 $S_{\\text{base}} = 100$ MW。\n\n计划进行一次双边传输：在母线 $1$ 注入大小为 $T$ 的功率，并在母线 $3$ 取出等量的功率 $-T$，使得系统总净注入为零。将功率传输分布因子 (PTDF) 定义为从母线 $1$ 到母线 $3$ 的 $1$ MW 交易中，出现在给定线路上的潮流部分，其中每条线路的潮流正方向取为从编号较小的母线到编号较大的母线。\n\n仅从 KCL 和直流潮流关系式 $f_{ij} = b_{ij}(\\theta_i - \\theta_j)$ 出发，推导移除平衡母线 $2$ 后的降阶节点电纳矩阵，求解作为交易大小 $T$ 的函数的母线相角，并由此获得对于从母线 $1$ 到母线 $3$ 的 $1$ MW 交易，线路 $(1,2)$、$(2,3)$ 和 $(1,3)$ 上的 PTDF。然后，对于 $T = 195$ MW，计算线路 $(1,2)$ 上产生的潮流（答案以 MW 表示），并判断是否超过了热极限 $\\bar{f}_{12} = 55$ MW。最终报告的答案必须是线路 $(1,2)$ 上潮流的单一数值（以 MW 为单位）。相角必须以弧度为单位。",
            "solution": "该问题具有科学依据，提法得当且客观。它使用直流潮流近似法对输电网络进行标准分析，这是电力系统工程中的一个基本工具。所有必要的参数和条件都已提供，不存在矛盾或含糊之处。因此，该问题是有效的，并将推导出解答。\n\n分析将在标幺值 (p.u.) 系统中进行。基准功率给定为 $S_{\\text{base}} = 100$ MW。大小为 $T$ MW 的功率传输对应的标幺值功率为 $P_{\\text{p.u.}} = T / S_{\\text{base}}$。\n\n首先，我们为两个非平衡母线（母线 $1$ 和母线 $3$）写出关于有功注入的 Kirchhoff 电流定律 (KCL)。母线 $2$ 是平衡母线，因此其电压相角为参考角，$\\theta_2 = 0$ 弧度。\n\n母线 $i$ 处的净有功注入记为 $P_i$，是离开该母线的所有有功潮流之和。线路 $(i,j)$ 上的潮流由 $f_{ij} = b_{ij}(\\theta_i - \\theta_j)$ 给出，其中 $b_{ij}$ 是线路电纳，$\\theta_i$ 是母线电压相角。\n\n对于母线 1：\n$$P_1 = f_{12} + f_{13} = b_{12}(\\theta_1 - \\theta_2) + b_{13}(\\theta_1 - \\theta_3)$$\n代入给定值 $b_{12} = 8$ p.u.，$b_{13} = 6$ p.u.，以及平衡母线条件 $\\theta_2 = 0$：\n$$P_1 = 8(\\theta_1 - 0) + 6(\\theta_1 - \\theta_3) = (8+6)\\theta_1 - 6\\theta_3 = 14\\theta_1 - 6\\theta_3$$\n\n对于母线 3：\n$$P_3 = f_{31} + f_{32} = b_{13}(\\theta_3 - \\theta_1) + b_{23}(\\theta_3 - \\theta_2)$$\n代入给定值 $b_{13} = 6$ p.u.，$b_{23} = 4$ p.u.，以及平衡母线条件 $\\theta_2 = 0$：\n$$P_3 = 6(\\theta_3 - \\theta_1) + 4(\\theta_3 - 0) = -6\\theta_1 + (6+4)\\theta_3 = -6\\theta_1 + 10\\theta_3$$\n\n这两个线性方程可以写成矩阵形式 $\\mathbf{P'} = \\mathbf{B'} \\boldsymbol{\\theta'}$，其中撇号表示已移除平衡母线。\n$$\\begin{pmatrix} P_1 \\\\ P_3 \\end{pmatrix} = \\begin{pmatrix} 14  -6 \\\\ -6  10 \\end{pmatrix} \\begin{pmatrix} \\theta_1 \\\\ \\theta_3 \\end{pmatrix}$$\n矩阵 $\\mathbf{B'}$ 是降阶节点电纳矩阵：\n$$\\mathbf{B'} = \\begin{pmatrix} 14  -6 \\\\ -6  10 \\end{pmatrix}$$\n这是第一个要求的推导结果。\n\n接下来，我们求解作为交易大小 $T$ 的函数的母线相角。该交易包含在母线 $1$ 的注入 $P_1 = T/S_{\\text{base}}$ 和在母线 $3$ 的取出 $P_3 = -T/S_{\\text{base}}$。未知相角向量为 $\\boldsymbol{\\theta'} = (\\mathbf{B'})^{-1} \\mathbf{P'}$。\n首先，我们求 $\\mathbf{B'}$ 的逆矩阵。其行列式为 $\\det(\\mathbf{B'}) = (14)(10) - (-6)(-6) = 140 - 36 = 104$。\n逆矩阵，也称为降阶节点电抗矩阵 $\\mathbf{X'}$，是：\n$$(\\mathbf{B'})^{-1} = \\frac{1}{104} \\begin{pmatrix} 10  6 \\\\ 6  14 \\end{pmatrix}$$\n现在，我们求解相角：\n$$\\begin{pmatrix} \\theta_1 \\\\ \\theta_3 \\end{pmatrix} = \\frac{1}{104} \\begin{pmatrix} 10  6 \\\\ 6  14 \\end{pmatrix} \\begin{pmatrix} P_1 \\\\ P_3 \\end{pmatrix} = \\frac{1}{104} \\begin{pmatrix} 10  6 \\\\ 6  14 \\end{pmatrix} \\begin{pmatrix} T/S_{\\text{base}} \\\\ -T/S_{\\text{base}} \\end{pmatrix}$$\n$$\\begin{pmatrix} \\theta_1 \\\\ \\theta_3 \\end{pmatrix} = \\frac{T}{104 \\cdot S_{\\text{base}}} \\begin{pmatrix} 10 \\cdot 1 + 6 \\cdot (-1) \\\\ 6 \\cdot 1 + 14 \\cdot (-1) \\end{pmatrix} = \\frac{T}{104 \\cdot S_{\\text{base}}} \\begin{pmatrix} 4 \\\\ -8 \\end{pmatrix}$$\n代入 $S_{\\text{base}} = 100$：\n$$\\theta_1 = \\frac{4T}{10400} = \\frac{T}{2600} \\quad \\text{rad}$$\n$$\\theta_3 = \\frac{-8T}{10400} = \\frac{-T}{1300} \\quad \\text{rad}$$\n这些是作为交易大小 T (MW) 的函数的母线相角，这是第二个要求的推导结果。\n\n对于从母线 $k$ 到母线 $l$ 在线路 $(i,j)$ 上的功率传输分布因子 (PTDF)，记为 $\\text{PTDF}_{ij,k-l}$，是指从 $k$ 到 $l$ 每单位传输功率在线路 $(i,j)$ 上的潮流变化。对于线性系统，这是一个常数。我们为一个从母线 $1$ 到母线 $3$ 的 $1$ 标幺值交易计算它。此交易的标幺值注入向量是 $\\Delta \\mathbf{P'} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n对应的相角变化为：\n$$\\Delta \\boldsymbol{\\theta'} = \\begin{pmatrix} \\Delta\\theta_1 \\\\ \\Delta\\theta_3 \\end{pmatrix} = (\\mathbf{B'})^{-1} \\Delta \\mathbf{P'} = \\frac{1}{104} \\begin{pmatrix} 10  6 \\\\ 6  14 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\frac{1}{104} \\begin{pmatrix} 4 \\\\ -8 \\end{pmatrix} = \\begin{pmatrix} 1/26 \\\\ -1/13 \\end{pmatrix}$$\n线路 $(i,j)$ 的 PTDF 则是 $\\text{PTDF}_{ij,1-3} = b_{ij}(\\Delta\\theta_i - \\Delta\\theta_j)$，遵循指定的从编号较小的母线到编号较大的母线的潮流方向。\n- 对于线路 $(1,2)$: $\\text{PTDF}_{12,1-3} = b_{12}(\\Delta\\theta_1 - \\Delta\\theta_2) = 8(\\frac{1}{26} - 0) = \\frac{8}{26} = \\frac{4}{13}$。\n- 对于线路 $(2,3)$: $\\text{PTDF}_{23,1-3} = b_{23}(\\Delta\\theta_2 - \\Delta\\theta_3) = 4(0 - (-\\frac{1}{13})) = \\frac{4}{13}$。\n- 对于线路 $(1,3)$: $\\text{PTDF}_{13,1-3} = b_{13}(\\Delta\\theta_1 - \\Delta\\theta_3) = 6(\\frac{1}{26} - (-\\frac{1}{13})) = 6(\\frac{1}{26} + \\frac{2}{26}) = 6(\\frac{3}{26}) = \\frac{18}{26} = \\frac{9}{13}$。\n线路 $(1,2)$、$(2,3)$ 和 $(1,3)$ 的 PTDF 分别为 $\\frac{4}{13}$、$\\frac{4}{13}$ 和 $\\frac{9}{13}$。这是推导的第三部分。\n\n最后，我们计算 $T = 195$ MW 交易在线路 $(1,2)$ 上的潮流。以 MW 为单位的潮流是无量纲的 PTDF 与以 MW 为单位的交易大小的乘积。\n$$f_{12, \\text{MW}} = \\text{PTDF}_{12,1-3} \\times T$$\n$$f_{12, \\text{MW}} = \\frac{4}{13} \\times 195$$\n因为 $195 = 13 \\times 15$，我们有：\n$$f_{12, \\text{MW}} = 4 \\times 15 = 60$$\n线路 $(1,2)$ 上产生的潮流为 $60$ MW。\n\n问题还要求将此潮流与热极限 $\\bar{f}_{12} = 55$ MW 进行比较。由于 $60 \\text{ MW} > 55 \\text{ MW}$，线路 $(1,2)$ 的热极限因此次交易而被超过。最终要求的答案是潮流本身的数值。\n线路 $(1,2)$ 上的潮流为 $60$ MW。",
            "answer": "$$\\boxed{60}$$"
        },
        {
            "introduction": "虽然在直流潮流计算中选择一个参考（松弛）节点是必要的数学步骤，但电网中的物理潮流不应依赖于这个任意的选择。本练习将通过对同一个问题使用两个不同的松弛节点进行求解，来明确证明潮流结果的不变性。这有助于加深对模型数学构造与物理现实之间关系的理解。",
            "id": "4131793",
            "problem": "考虑一个在直流潮流 (DC) 近似下建模的无损高压输电网络。在此近似下，电压幅值固定，串联电阻被忽略，有功功率潮流与电压相角差成线性关系。设母线标号为 $1$、$2$ 和 $3$。线路 $\\ell_{12}$ 连接母线 $1$ 和 $2$，线路 $\\ell_{23}$ 连接母线 $2$ 和 $3$，线路 $\\ell_{13}$ 连接母线 $1$ 和 $3$。定义线路方向，使得潮流在 $1 \\rightarrow 2$、$2 \\rightarrow 3$ 和 $1 \\rightarrow 3$ 方向为正。在 $100$ 兆伏安 (MVA) 的系统基准下，标幺值串联电抗分别为 $x_{12} = 0.2$、$x_{23} = 0.25$ 和 $x_{13} = 0.5$，因此电纳为 $b_{12} = 1/x_{12}$、$b_{23} = 1/x_{23}$ 和 $b_{13} = 1/x_{13}$。以兆瓦 (MW) 为单位的净有功注入功率向量（发电功率减去负荷功率）由 $p = \\begin{pmatrix} 50 \\\\ -30 \\\\ -20 \\end{pmatrix}$ 给出，该向量满足网络功率平衡 $\\sum_{i} p_i = 0$。输电容量约束作为线路潮流的绝对值限制：$|f_{12}| \\leq 36$ 兆瓦 (MW)，$|f_{23}| \\leq 25$ MW，以及 $|f_{13}| \\leq 16$ MW。\n\n从基尔霍夫电流定律（每个母线上所有相连线路的潮流之和等于该母线的净注入功率）和直流潮流本构关系 $f_{ij} = b_{ij}(\\theta_i - \\theta_j)$ 出发，其中 $\\theta_i$ 是母线 $i$ 的电压相角，执行以下操作：\n\n1. 使用网络关联结构和线路电纳，推导母线注入功率向量 $p$ 和母线相角向量 $\\theta$ 之间的代数关系。解释为什么得到的节点电纳矩阵是奇异的，以及选择一个平衡（参考）母线如何通过固定一个相角并对系统进行降阶来消除这种奇异性。\n\n2. 使用上述基本定义，在两种不同的平衡母线选择下，显式地构建从 $p$ 到有向线路潮流 $f = \\begin{pmatrix} f_{12} \\\\ f_{23} \\\\ f_{13} \\end{pmatrix}$ 的功率转移分布因子 (PTDF) 映射：首先以母线 $1$ 为平衡母线，然后以母线 $3$ 为平衡母线。在不使用任何快捷公式的情况下，计算相应的 PTDF 矩阵。\n\n3. 使用两个 PTDF 矩阵，计算给定 $p$ 值时线路 $\\ell_{13}$ 上的潮流，并证明即使 PTDF 矩阵的元素不同，物理潮流 $f_{13}$ 对于平衡母线的选择也是不变的。\n\n用兆瓦 (MW) 表示不变的线路潮流 $f_{13}$ 的最终数值。提供精确值（不要四舍五入）。在推导过程中，清楚地说明在适当的情况下如何使用 $100$ MVA 基准值在标幺值和兆瓦之间进行转换。此外，根据你计算出的潮流，评论线路 $\\ell_{13}$ 上的输电容量约束是否会起作用（binding）；你的评论不会影响所要求的最终数值答案。",
            "solution": "首先验证该问题，以确保其具有科学依据、提法恰当且客观。\n\n### 第 1 步：提取已知条件\n- **网络模型**：无损、高压、直流潮流近似。\n- **母线**：$i \\in \\{1, 2, 3\\}$。\n- **线路与方向**：$\\ell_{12}$ ($1 \\rightarrow 2$)、$\\ell_{23}$ ($2 \\rightarrow 3$)、$\\ell_{13}$ ($1 \\rightarrow 3$)。\n- **基准功率**：$S_{base} = 100$ 兆伏安 (MVA)。\n- **标幺值电抗**：$x_{12} = 0.2$, $x_{23} = 0.25$, $x_{13} = 0.5$。\n- **标幺值电纳**：$b_{12} = 1/x_{12}$, $b_{23} = 1/x_{23}$, $b_{13} = 1/x_{13}$。\n- **净有功注入功率向量**：$p = \\begin{pmatrix} 50 \\\\ -30 \\\\ -20 \\end{pmatrix}$ 兆瓦 (MW)。\n- **功率平衡**：$\\sum_{i} p_i = 50 - 30 - 20 = 0$。\n- **输电容量约束**：$|f_{12}| \\leq 36$ MW, $|f_{23}| \\leq 25$ MW, $|f_{13}| \\leq 16$ MW。\n- **本构关系**：$f_{ij} = b_{ij}(\\theta_i - \\theta_j)$，其中 $f_{ij}$ 是线路 $\\ell_{ij}$ 上的有功功率潮流，$\\theta_i$ 是母线 $i$ 上的电压相角。\n- **基尔霍夫电流定律 (KCL)**：在每个母线，净注入功率等于流出该母线的功率潮流之和。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于直流潮流模型，这是电力系统分析中一个标准且基础的工具。所引用的所有原则（KCL、线性潮流-相角关系）在这一公认的近似模型中都是正确的。给定值对于输电网络是符合实际的。\n- **提法恰当性**：该问题提供了一套完整的数据（拓扑结构、阻抗、注入功率）和一个明确的目标。条件 $\\sum p_i = 0$ 得到满足，这是稳态解存在的必要条件。电压相角的不唯一性问题被明确地作为问题的一部分，通过设置平衡母线来解决该问题，从而得到唯一的功率潮流解。\n- **客观性**：问题陈述使用了精确、正式且无偏见的技术语言。\n\n### 第 3 步：结论与行动\n该问题是**有效的**，因为它科学合理、信息完备且提法恰当。我们继续进行求解。\n\n### 第 1 部分：节点电纳矩阵及其奇异性\n\n我们首先对每个母线应用基尔霍夫电流定律。母线 $i$ 的净注入功率 $p_i$ 必须等于从该母线流向所有相连线路的功率潮流之和。\n\n对于母线 1：\n$p_1 = f_{12} + f_{13}$\n使用本构关系 $f_{ij} = b_{ij}(\\theta_i - \\theta_j)$：\n$p_1 = b_{12}(\\theta_1 - \\theta_2) + b_{13}(\\theta_1 - \\theta_3) = (b_{12} + b_{13})\\theta_1 - b_{12}\\theta_2 - b_{13}\\theta_3$\n\n对于母线 2：\n$p_2 = f_{21} + f_{23} = -f_{12} + f_{23}$\n$p_2 = -b_{12}(\\theta_1 - \\theta_2) + b_{23}(\\theta_2 - \\theta_3) = -b_{12}\\theta_1 + (b_{12} + b_{23})\\theta_2 - b_{23}\\theta_3$\n\n对于母线 3：\n$p_3 = f_{31} + f_{32} = -f_{13} - f_{23}$\n$p_3 = -b_{13}(\\theta_1 - \\theta_3) - b_{23}(\\theta_2 - \\theta_3) = -b_{13}\\theta_1 - b_{23}\\theta_2 + (b_{13} + b_{23})\\theta_3$\n\n这三个线性方程可以写成矩阵形式 $p = B_{bus}\\theta$：\n$$\n\\begin{pmatrix} p_1 \\\\ p_2 \\\\ p_3 \\end{pmatrix} = \n\\begin{pmatrix}\nb_{12} + b_{13}  -b_{12}  -b_{13} \\\\\n-b_{12}  b_{12} + b_{23}  -b_{23} \\\\\n-b_{13}  -b_{23}  b_{13} + b_{23}\n\\end{pmatrix}\n\\begin{pmatrix} \\theta_1 \\\\ \\theta_2 \\\\ \\theta_3 \\end{pmatrix}\n$$\n矩阵 $B_{bus}$ 是节点电纳矩阵。这个矩阵是奇异的。我们可以通过对任一行的元素求和来证明这一点。对于第 1 行，和为 $(b_{12} + b_{13}) - b_{12} - b_{13} = 0$。同样，第 2 行和第 3 行的和也为零。一个每行元素之和都为零的矩阵，其行向量是线性相关的（所有行向量之和为零向量）。这意味着其列向量之和也为零向量，即 $B_{bus}\\mathbf{1} = \\mathbf{0}$，其中 $\\mathbf{1}$ 是全为一的向量。这意味着向量 $\\mathbf{1}$ 位于 $B_{bus}$ 的零空间中，因此该矩阵是奇异的，其行列式为零。\n\n从物理上讲，这种奇异性是因为功率潮流 $f_{ij}$ 仅取决于电压相角*差* $(\\theta_i - \\theta_j)$。如果我们有一个有效的相角向量解 $\\theta$，那么 $\\theta' = \\theta + c\\mathbf{1}$（其中 $c$ 是任意常数）也是一个有效的解，因为它产生完全相同的相角差，从而产生相同的功率潮流。该系统没有绝对的相角参考。\n\n为了获得唯一的相角解，我们必须建立一个参考。这通过指定一个母线为“平衡”或“参考”母线并将其相角固定（通常设为 $\\theta_{slack} = 0$）来实现。这为相角计算提供了必要的锚点。通过将一个 $\\theta_i$ 设为 $0$，我们移除了对应的第 $i$ 个方程（由于功率平衡，该方程变得冗余）和第 $i$ 个变量。这将系统降阶为一个 $(N-1) \\times (N-1)$ 的系统，其中 $N=3$ 是母线数量。对于一个连通网络，得到的降阶节点电纳矩阵是可逆的，从而可以唯一地求解剩余的 $N-1$ 个相角。\n\n### 第 2 部分：功率转移分布因子 (PTDF) 矩阵的构建\n\n首先，我们根据给定的电抗计算标幺值电纳：\n$b_{12} = \\frac{1}{x_{12}} = \\frac{1}{0.2} = 5$ pu\n$b_{23} = \\frac{1}{x_{23}} = \\frac{1}{0.25} = 4$ pu\n$b_{13} = \\frac{1}{x_{13}} = \\frac{1}{0.5} = 2$ pu\n\n节点电纳矩阵为：\n$$\nB_{bus} = \n\\begin{pmatrix}\n5 + 2  -5  -2 \\\\\n-5  5 + 4  -4 \\\\\n-2  -4  2 + 4\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n7  -5  -2 \\\\\n-5  9  -4 \\\\\n-2  -4  6\n\\end{pmatrix}\n$$\nPTDF 将线路潮流与母线注入功率联系起来。推导过程使用标幺值进行。一个关键特性是，得到的 PTDF 矩阵可以直接应用于以 MW 为单位的注入功率，以获得以 MW 为单位的线路潮流，因为基准功率 $S_{base}$ 会被抵消：$f_{MW} = f_{pu} S_{base} = (\\Psi p_{pu}) S_{base} = \\Psi (p_{MW}/S_{base}) S_{base} = \\Psi p_{MW}$。\n\n**情况 A：母线 1 为平衡母线 ($\\theta_1 = 0$)**\n我们设 $\\theta_1 = 0$，并使用母线 $2$ 和 $3$ 的方程求解 $\\theta_2$ 和 $\\theta_3$。\n$$\n\\begin{pmatrix} p_2 \\\\ p_3 \\end{pmatrix} = \n\\begin{pmatrix}\nb_{12} + b_{23}  -b_{23} \\\\\n-b_{23}  b_{13} + b_{23}\n\\end{pmatrix}\n\\begin{pmatrix} \\theta_2 \\\\ \\theta_3 \\end{pmatrix}\n=\n\\begin{pmatrix}\n9  -4 \\\\\n-4  6\n\\end{pmatrix}\n\\begin{pmatrix} \\theta_2 \\\\ \\theta_3 \\end{pmatrix}\n$$\n降阶矩阵为 $B_{red_1} = \\begin{pmatrix} 9  -4 \\\\ -4  6 \\end{pmatrix}$。其逆矩阵为：\n$(B_{red_1})^{-1} = \\frac{1}{9(6) - (-4)(-4)} \\begin{pmatrix} 6  4 \\\\ 4  9 \\end{pmatrix} = \\frac{1}{38} \\begin{pmatrix} 6  4 \\\\ 4  9 \\end{pmatrix}$。\n因此，非平衡母线的相角为：\n$$ \\begin{pmatrix} \\theta_2 \\\\ \\theta_3 \\end{pmatrix} = \\frac{1}{38} \\begin{pmatrix} 6  4 \\\\ 4  9 \\end{pmatrix} \\begin{pmatrix} p_2 \\\\ p_3 \\end{pmatrix} $$\n现在我们用这些相角（以及 $\\theta_1=0$）来表示线路潮流：\n$f_{12} = b_{12}(\\theta_1 - \\theta_2) = -5\\theta_2 = -5 \\left( \\frac{6}{38}p_2 + \\frac{4}{38}p_3 \\right) = -\\frac{15}{19}p_2 - \\frac{10}{19}p_3$\n$f_{23} = b_{23}(\\theta_2 - \\theta_3) = 4(\\theta_2 - \\theta_3) = 4 \\left( (\\frac{6}{38}p_2 + \\frac{4}{38}p_3) - (\\frac{4}{38}p_2 + \\frac{9}{38}p_3) \\right) = \\frac{4}{38}(2p_2 - 5p_3) = \\frac{4}{19}p_2 - \\frac{10}{19}p_3$\n$f_{13} = b_{13}(\\theta_1 - \\theta_3) = -2\\theta_3 = -2 \\left( \\frac{4}{38}p_2 + \\frac{9}{38}p_3 \\right) = -\\frac{4}{19}p_2 - \\frac{9}{19}p_3$\nPTDF 矩阵 $\\Psi^{(1)}$ 将潮流向量 $f = (f_{12}, f_{23}, f_{13})^T$ 与非平衡母线注入功率向量 $(p_2, p_3)^T$ 联系起来：\n$$ \\Psi^{(1)} = \\frac{1}{19} \\begin{pmatrix} -15  -10 \\\\ 4  -10 \\\\ -4  -9 \\end{pmatrix} $$\n\n**情况 B：母线 3 为平衡母线 ($\\theta_3 = 0$)**\n我们设 $\\theta_3 = 0$，并使用母线 $1$ 和 $2$ 的方程求解 $\\theta_1$ 和 $\\theta_2$。\n$$\n\\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix} = \n\\begin{pmatrix}\nb_{12} + b_{13}  -b_{12} \\\\\n-b_{12}  b_{12} + b_{23}\n\\end{pmatrix}\n\\begin{pmatrix} \\theta_1 \\\\ \\theta_2 \\end{pmatrix}\n=\n\\begin{pmatrix}\n7  -5 \\\\\n-5  9\n\\end{pmatrix}\n\\begin{pmatrix} \\theta_1 \\\\ \\theta_2 \\end{pmatrix}\n$$\n降阶矩阵为 $B_{red_3} = \\begin{pmatrix} 7  -5 \\\\ -5  9 \\end{pmatrix}$。其逆矩阵为：\n$(B_{red_3})^{-1} = \\frac{1}{7(9) - (-5)(-5)} \\begin{pmatrix} 9  5 \\\\ 5  7 \\end{pmatrix} = \\frac{1}{38} \\begin{pmatrix} 9  5 \\\\ 5  7 \\end{pmatrix}$。\n因此，非平衡母线的相角为：\n$$ \\begin{pmatrix} \\theta_1 \\\\ \\theta_2 \\end{pmatrix} = \\frac{1}{38} \\begin{pmatrix} 9  5 \\\\ 5  7 \\end{pmatrix} \\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix} $$\n现在我们用这些相角（以及 $\\theta_3=0$）来表示线路潮流：\n$f_{12} = b_{12}(\\theta_1 - \\theta_2) = 5(\\theta_1 - \\theta_2) = 5 \\left( (\\frac{9}{38}p_1 + \\frac{5}{38}p_2) - (\\frac{5}{38}p_1 + \\frac{7}{38}p_2) \\right) = \\frac{5}{38}(4p_1 - 2p_2) = \\frac{10}{19}p_1 - \\frac{5}{19}p_2$\n$f_{23} = b_{23}(\\theta_2 - \\theta_3) = 4\\theta_2 = 4 \\left( \\frac{5}{38}p_1 + \\frac{7}{38}p_2 \\right) = \\frac{10}{19}p_1 + \\frac{14}{19}p_2$\n$f_{13} = b_{13}(\\theta_1 - \\theta_3) = 2\\theta_1 = 2 \\left( \\frac{9}{38}p_1 + \\frac{5}{38}p_2 \\right) = \\frac{9}{19}p_1 + \\frac{5}{19}p_2$\nPTDF 矩阵 $\\Psi^{(3)}$ 将潮流向量 $f$ 与非平衡母线注入功率向量 $(p_1, p_2)^T$ 联系起来：\n$$ \\Psi^{(3)} = \\frac{1}{19} \\begin{pmatrix} 10  -5 \\\\ 10  14 \\\\ 9  5 \\end{pmatrix} $$\n\n### 第 3 部分：潮流计算与不变性\n\n现在我们使用两个 PTDF 矩阵，为给定的注入功率向量 $p = (50, -30, -20)^T$ MW 计算以 MW 为单位的潮流。\n\n**使用平衡母线 1 进行计算**：\n非平衡母线注入功率为 $p_2 = -30$ MW 和 $p_3 = -20$ MW。\n$$\n\\begin{pmatrix} f_{12} \\\\ f_{23} \\\\ f_{13} \\end{pmatrix} = \n\\Psi^{(1)} \\begin{pmatrix} p_2 \\\\ p_3 \\end{pmatrix} = \n\\frac{1}{19} \\begin{pmatrix} -15  -10 \\\\ 4  -10 \\\\ -4  -9 \\end{pmatrix}\n\\begin{pmatrix} -30 \\\\ -20 \\end{pmatrix}\n= \\frac{1}{19}\n\\begin{pmatrix}\n(-15)(-30) + (-10)(-20) \\\\\n(4)(-30) + (-10)(-20) \\\\\n(-4)(-30) + (-9)(-20)\n\\end{pmatrix}\n= \\frac{1}{19}\n\\begin{pmatrix}\n450 + 200 \\\\\n-120 + 200 \\\\\n120 + 180\n\\end{pmatrix}\n= \\begin{pmatrix}\n650/19 \\\\\n80/19 \\\\\n300/19\n\\end{pmatrix}\n$$\n\n**使用平衡母线 3 进行计算**：\n非平衡母线注入功率为 $p_1 = 50$ MW 和 $p_2 = -30$ MW。\n$$\n\\begin{pmatrix} f_{12} \\\\ f_{23} \\\\ f_{13} \\end{pmatrix} = \n\\Psi^{(3)} \\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix} = \n\\frac{1}{19} \\begin{pmatrix} 10  -5 \\\\ 10  14 \\\\ 9  5 \\end{pmatrix}\n\\begin{pmatrix} 50 \\\\ -30 \\end{pmatrix}\n= \\frac{1}{19}\n\\begin{pmatrix}\n(10)(50) + (-5)(-30) \\\\\n(10)(50) + (14)(-30) \\\\\n(9)(50) + (5)(-30)\n\\end{pmatrix}\n= \\frac{1}{19}\n\\begin{pmatrix}\n500 + 150 \\\\\n500 - 420 \\\\\n450 - 150\n\\end{pmatrix}\n= \\begin{pmatrix}\n650/19 \\\\\n80/19 \\\\\n300/19\n\\end{pmatrix}\n$$\n\n计算结果证实，物理线路潮流对于平衡母线（一个数学构造）的选择是不变的。线路上 $\\ell_{13}$ 的最终潮流为 $f_{13} = 300/19$ MW。\n\n**关于输电约束的评论**：\n问题陈述了线路 $\\ell_{13}$ 上的容量约束为 $|f_{13}| \\leq 16$ MW。计算出的潮流为 $f_{13} = 300/19 \\approx 15.789$ MW。由于 $|15.789|  16$，该线路上的输电容量约束未被违反，在优化背景下不会成为起作用的约束（bind）。然而，该潮流非常接近极限值（达到容量的 $98.7\\%$）。\n\n所要求的最终数值答案是线路 $\\ell_{13}$ 上的潮流。",
            "answer": "$$\n\\boxed{\\frac{300}{19}}\n$$"
        },
        {
            "introduction": "为何不能简单地使用网络科学中的最大流算法来确定输电容量？本练习通过将基于物理的直流潮流模型与纯粹的图论方法进行对比，来回答这个问题。您将通过一个具体的反例，揭示基尔霍夫电压定律（KVL）如何引入不可分的全局约束，并理解为何简单的本地容量和节点平衡约束不足以描述电力系统的真实行为。",
            "id": "4131844",
            "problem": "考虑输电网络的直流(DC)潮流近似，其中相角以弧度为单位。基尔霍夫电流定律(KCL)指出，流入一个节点的电流（此处为功率流）的代数和等于该节点的净注入功率。基尔霍夫电压定律(KVL)规定，沿任何回路的电压降（此处为按线路电纳缩放的相角差）之和为零。在直流模型中，线路 $\\{i,j\\}$ 上的有功功率流由 $f_{ij} = b_{ij}(\\theta_{i} - \\theta_{j})$ 给出，其中 $b_{ij}  0$ 是串联电纳，$\\theta_{k}$ 是母线 $k$ 处的电压相角。与仅施加边容量和节点守恒的最大流模型不同，直流模型通过相角将所有潮流全局耦合起来，嵌入了不可分的约束。\n\n构建并分析以下三母线网络，以使这一区别更加精确并量化线路约束的影响：\n\n- 母线标记为 $1$、$2$ 和 $3$。所有线路都存在：$\\{1,2\\}$、$\\{2,3\\}$ 和 $\\{1,3\\}$。\n- 电纳为 $b_{12} = b_{23} = b_{13} = 1$（基于一致基准的标幺值）。\n- 热容量为 $C_{12} = C_{23} = C_{13} = 100$ 兆瓦 (MW)。\n- 选择母线 $3$ 作为相角参考（平衡节点），$\\theta_{3} = 0$。\n- 净注入功率为 $p_{1} = P$，$p_{2} = 0$，$p_{3} = -P$，因此总注入功率平衡为零。\n\n任务：\n1. 使用基尔霍夫电流定律(KCL)和基尔霍夫电压定律(KVL)的定义，解释为什么直流模型通过存在一个必须使所有流量 $f_{ij}$ 能够成立的单一相角向量 $\\theta$ 来对线路潮流施加不可分的约束。\n2. 基于此网络提供一个反例，表明一个值为 $200$ MW 且路径为 $f_{12} = 100$、$f_{23} = 100$ 和 $f_{13} = 100$ 的最大流解违反了直流潮流约束。请通过证明不存在可以产生这些潮流的相角向量 $\\theta$ 来进行说明。\n3. 推导直流可行线路潮流作为 $P$ 的函数，并确定最大可传输功率 $P_{\\max}$，使得所有线路潮流对每条线路 $\\{i,j\\} \\in \\{\\{1,2\\}, \\{2,3\\}, \\{1,3\\}\\}$ 均满足 $|f_{ij}| \\leq C_{ij}$。\n\n以兆瓦(MW)为单位表示最终的最大可传输功率。将您的答案四舍五入到四位有效数字。",
            "solution": "问题陈述经评估有效。它在科学上基于应用于电力系统（特别是直流潮流近似）的电路理论原理，问题设定良好，数据完整且一致，并以客观、正式的语言表达。它提出了一个电力系统分析中的标准且不平凡的问题。\n\n解答过程按顺序处理三个任务。\n\n### 任务1：不可分约束的解释\n\n直流(DC)潮流模型的核心是连接母线 $i$ 和母线 $j$ 的线路上的功率流 $f_{ij}$、线路的串联电纳 $b_{ij}$ 以及母线上的电压相角 $\\theta_i$ 和 $\\theta_j$ 之间的关系：\n$$f_{ij} = b_{ij}(\\theta_i - \\theta_j)$$\n基尔霍夫电流定律(KCL)必须在每个母线 $k$ 处得到满足。它指出，母线处的净注入功率 $p_k$ 必须等于离开该母线的所有功率流之和：\n$$p_k = \\sum_{j \\sim k} f_{kj} = \\sum_{j \\sim k} b_{kj}(\\theta_k - \\theta_j)$$\n其中求和是对所有与母线 $k$ 相邻的母线 $j$ 进行的。\n\n在这个问题中，我们有一个包含 $N=3$ 个母线的网络。通过指定一个母线作为参考（平衡节点），本例中为母线 $3$ 且 $\\theta_3 = 0$，我们有 $N-1=2$ 个未知相角 $\\theta_1$ 和 $\\theta_2$。非平衡母线（母线 $1$ 和母线 $2$）的KCL方程构成一个线性方程组，用于确定这些相角：\n$$p_1 = b_{12}(\\theta_1 - \\theta_2) + b_{13}(\\theta_1 - \\theta_3)$$\n$$p_2 = b_{21}(\\theta_2 - \\theta_1) + b_{23}(\\theta_2 - \\theta_3)$$\n一旦该系统求解出相角向量 $\\theta = (\\theta_1, \\theta_2, ..., \\theta_N)$，网络中*每条*线路上的潮流就被唯一确定了。\n\n这些约束是“不可分的”，因为任何单条线路上的潮流（例如 $f_{ab}$）不能独立于另一条线路上的潮流（$f_{cd}$）进行选择或约束。两个潮流都是同一全局状态变量，即相角向量 $\\theta$ 的函数。网络中任何地方影响 $\\theta_i$ 的变化，原则上都可以改变整个网络中的相角差 $(\\theta_k - \\theta_l)$，从而改变潮流 $f_{kl}$。这种全局耦合是基尔霍夫电压定律(KVL)的直接结果，通过一个势函数（相角）来定义潮流，就隐式地满足了KVL。任何回路的KVL要求该回路上相角差之和为零，例如 $(\\theta_i - \\theta_j) + (\\theta_j - \\theta_k) + (\\theta_k - \\theta_i) = 0$。存在一个能使所有潮流成立的单一向量 $\\theta$ 保证了此条件对所有回路都成立。这与简单的最大流模型形成鲜明对比，在最大流模型中，潮流仅受边容量和节点守恒（KCL）的局部约束，允许任何满足这些局部规则的潮流集合。\n\n### 任务2：最大流解的反例\n\n问题提出了一组与从母线 $1$ 到母线 $3$ 的 $200$ MW 最大流传输相一致的潮流：$f_{12} = 100$ MW，$f_{23} = 100$ MW，以及 $f_{13} = 100$ MW。这些潮流满足容量约束（$|f_{ij}| \\leq 100$）和注入模式 $p_1 = f_{12} + f_{13} = 100 + 100 = 200$ MW，$p_2 = f_{21} + f_{23} = -f_{12} + f_{23} = -100 + 100 = 0$ MW，以及 $p_3 = f_{31} + f_{32} = -f_{13} - f_{23} = -100 - 100 = -200$ MW 的KCL。这对应于问题设定中 $P = 200$ 的情况。\n\n我们现在必须检验是否存在一个相角向量 $\\theta = (\\theta_1, \\theta_2, \\theta_3)$ 可以产生这些潮流。给定 $b_{12}=b_{23}=b_{13}=1$ 和参考相角 $\\theta_3=0$。根据定义 $f_{ij} = b_{ij}(\\theta_i - \\theta_j)$，我们尝试求解 $\\theta_1$ 和 $\\theta_2$：\n1. $f_{13} = b_{13}(\\theta_1 - \\theta_3) \\implies 100 = 1(\\theta_1 - 0) \\implies \\theta_1 = 100$。\n2. $f_{23} = b_{23}(\\theta_2 - \\theta_3) \\implies 100 = 1(\\theta_2 - 0) \\implies \\theta_2 = 100$。\n\n现在，我们使用这些推导出的相角值来检查与第三个潮流 $f_{12}$ 的一致性：\n3. $f_{12} = b_{12}(\\theta_1 - \\theta_2) = 1(100 - 100) = 0$。\n\n然而，所提出的潮流方案要求 $f_{12} = 100$。从直流潮流方程得到的结果（$f_{12}=0$）与所需潮流（$f_{12}=100$）相矛盾。这一矛盾证明，不存在单一、一致的相角向量 $\\theta$ 可以产生所提出的潮流集合。所提出的潮流集合违反了网络的物理约束（特别是KVL）。沿回路 $1 \\to 2 \\to 3 \\to 1$ 的隐含相角降之和为 $f_{12}/b_{12} + f_{23}/b_{23} + f_{31}/b_{31} = 100/1 + 100/1 + (-100)/1 = 100$，这不等于KVL所要求的零。\n\n### 任务3：直流可行潮流和最大功率传输的推导\n\n首先，我们为给定网络建立注入功率和相角之间的关系。非平衡母线（$1$ 和 $2$）的KCL方程为：\n在母线 $1$：$p_1 = P = b_{12}(\\theta_1 - \\theta_2) + b_{13}(\\theta_1 - \\theta_3)$\n在母线 $2$：$p_2 = 0 = b_{21}(\\theta_2 - \\theta_1) + b_{23}(\\theta_2 - \\theta_3)$\n\n代入给定值 $b_{12} = b_{23} = b_{13} = 1$ 和 $\\theta_3 = 0$：\n1. $P = 1(\\theta_1 - \\theta_2) + 1(\\theta_1 - 0) \\implies P = 2\\theta_1 - \\theta_2$\n2. $0 = 1(\\theta_2 - \\theta_1) + 1(\\theta_2 - 0) \\implies 0 = -\\theta_1 + 2\\theta_2$\n\n这是一个关于 $\\theta_1$ 和 $\\theta_2$ 的二元线性方程组。从第二个方程，我们得到 $\\theta_1 = 2\\theta_2$。将此代入第一个方程：\n$P = 2(2\\theta_2) - \\theta_2 = 4\\theta_2 - \\theta_2 = 3\\theta_2$\n这得到 $\\theta_2 = \\frac{P}{3}$。\n因此，$\\theta_1 = 2\\theta_2 = 2\\left(\\frac{P}{3}\\right) = \\frac{2P}{3}$。\n\n相角向量为 $\\theta = (\\frac{2P}{3}, \\frac{P}{3}, 0)$。现在我们可以将线路潮流表示为 $P$ 的函数：\n$f_{12} = b_{12}(\\theta_1 - \\theta_2) = 1\\left(\\frac{2P}{3} - \\frac{P}{3}\\right) = \\frac{P}{3}$\n$f_{23} = b_{23}(\\theta_2 - \\theta_3) = 1\\left(\\frac{P}{3} - 0\\right) = \\frac{P}{3}$\n$f_{13} = b_{13}(\\theta_1 - \\theta_3) = 1\\left(\\frac{2P}{3} - 0\\right) = \\frac{2P}{3}$\n\n最后，我们通过施加热容量约束 $|f_{ij}| \\leq C_{ij}$ 来求最大可传输功率 $P_{\\max}$，其中 $C_{12} = C_{23} = C_{13} = 100$ MW。假设 $P  0$，所有潮流均为正，因此绝对值是多余的。\n1. $|f_{12}| \\leq C_{12} \\implies \\frac{P}{3} \\leq 100 \\implies P \\leq 300$\n2. $|f_{23}| \\leq C_{23} \\implies \\frac{P}{3} \\leq 100 \\implies P \\leq 300$\n3. $|f_{13}| \\leq C_{13} \\implies \\frac{2P}{3} \\leq 100 \\implies P \\leq \\frac{3 \\times 100}{2} \\implies P \\leq 150$\n\n为同时满足所有三个约束，$P$ 必须小于或等于三个上界中的最小值：\n$P_{\\max} = \\min(300, 300, 150) = 150$\n\n最大可传输功率为 $150$ MW，受限于线路 $\\{1,3\\}$ 的容量。\n四舍五入到四位有效数字得到 $150.0$。",
            "answer": "$$\\boxed{150.0}$$"
        }
    ]
}