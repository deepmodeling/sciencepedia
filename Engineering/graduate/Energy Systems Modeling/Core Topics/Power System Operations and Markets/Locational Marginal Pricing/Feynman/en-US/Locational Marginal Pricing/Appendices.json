{
    "hands_on_practices": [
        {
            "introduction": "To build a robust understanding of Locational Marginal Pricing (LMP), we begin with the ideal case: a transmission network without congestion or losses. In this foundational scenario, economic theory suggests a single, uniform price should emerge, reflecting the system's marginal cost of energy. This exercise  challenges you to derive this result from the first principles of optimal power flow, solidifying the connection between the physical grid model and fundamental market economics.",
            "id": "4102233",
            "problem": "Consider a connected transmission network modeled under the standard direct-current optimal power flow (DCOPF) approximation: voltage magnitudes are fixed, reactive power is ignored, and active power flows obey linear relationships with bus voltage phase angles. Let there be $n$ buses and $m$ transmission lines. Define the line-to-bus incidence matrix as $K \\in \\mathbb{R}^{m \\times n}$ with an arbitrary orientation, and let the diagonal matrix of line susceptances be $B_{\\ell} \\in \\mathbb{R}^{m \\times m}$ with strictly positive diagonal entries. Then the vector of line flows satisfies $f = B_{\\ell} K \\theta$, where $\\theta \\in \\mathbb{R}^{n}$ is the vector of bus voltage phase angles. Nodal power balance is represented by\n$$\nd - p - K^{\\top} f = 0,\n$$\nwhere $d \\in \\mathbb{R}^{n}_{\\ge 0}$ is the demand vector and $p \\in \\mathbb{R}^{n}_{\\ge 0}$ is the vector of net generation injections. Suppose each generator $i \\in \\{1,\\dots,n\\}$ has a convex, continuously differentiable cost function $C_{i}(p_{i})$ and a finite capacity $\\overline{p}_{i} > 0$. Assume zero losses (i.e., total generation equals total demand) and that all transmission constraints are non-binding (thermal limits are large enough that no line reaches its limit at the optimum). The DCOPF problem minimizes total generation cost subject to these constraints.\n\nTask 1: Starting only from the DCOPF formulation described above and first principles of constrained convex optimization, derive the conditions under which the Locational Marginal Prices (LMPs)—defined as the shadow prices associated with the nodal power balance constraints—are identical across all buses in a connected network and equal to a single scalar $\\lambda$. Your derivation must proceed from the Karush–Kuhn–Tucker (KKT) conditions of the lossless, uncongested DCOPF.\n\nTask 2: Construct and solve the following small numerical example to compute the value of the uniform LMP. Consider a $3$-bus network labeled buses $1$, $2$, and $3$, connected in a triangle by lines $(1,2)$, $(2,3)$, and $(1,3)$, with susceptances $b_{12} = 5$, $b_{23} = 4$, and $b_{13} = 6$, and thermal limits set so high that no line constraint binds. Demand is located only at bus $2$ with $d_{2} = 100$ and $d_{1} = d_{3} = 0$. There are generators at buses $1$ and $3$ with cost functions\n$$\nC_{1}(p_{1}) = 15\\,p_{1} + \\frac{1}{2}\\cdot 0.2\\,p_{1}^{2}, \\quad C_{3}(p_{3}) = 10\\,p_{3} + \\frac{1}{2}\\cdot 0.1\\,p_{3}^{2},\n$$\nand capacities $\\overline{p}_{1} = 120$ and $\\overline{p}_{3} = 120$. Assume zero losses and no congestion. Solve for the optimal dispatch $(p_{1}^{\\star}, p_{3}^{\\star})$ and the corresponding uniform LMP $\\lambda$. Round your final numerical value of the LMP to four significant figures, and express it in dollars per megawatt-hour ($\\$/\\text{MWh}$).",
            "solution": "The analysis proceeds in two parts as requested. First, we derive the general conditions for uniform Locational Marginal Prices (LMPs) from first principles. Second, we apply this understanding to solve the specific numerical example.\n\n### Part 1: Derivation of the Condition for Uniform LMPs\n\nThe Direct-Current Optimal Power Flow (DCOPF) problem aims to minimize the total cost of generation subject to physical and operational constraints. As per the problem statement, we consider a lossless and uncongested network.\n\nThe decision variables are the vector of generation injections, $p \\in \\mathbb{R}^n$, and the vector of bus voltage phase angles, $\\theta \\in \\mathbb{R}^n$. The objective is to minimize the total generation cost, which is the sum of individual generator cost functions:\n$$\n\\min_{p, \\theta} \\sum_{i=1}^{n} C_{i}(p_{i})\n$$\nThis minimization is subject to several constraints:\n\n1.  **Nodal Power Balance:** At each bus $i$, the power injected must equal the power withdrawn. The problem provides this as $d - p - K^{\\top} f = 0$. Substituting the line flow equation $f = B_{\\ell} K \\theta$, we get:\n    $$\n    d - p - K^{\\top} B_{\\ell} K \\theta = 0\n    $$\n    Let's define the bus admittance matrix $B_{bus} = K^{\\top} B_{\\ell} K$. The nodal power balance constraint for each bus $i$ is then:\n    $$\n    p_i - d_i + (B_{bus}\\theta)_i = 0 \\quad \\text{for } i \\in \\{1, \\dots, n\\}\n    $$\n    We associate a Lagrange multiplier, $\\lambda_i$, with each of these $n$ equality constraints. The vector of these multipliers, $\\lambda = [\\lambda_1, \\dots, \\lambda_n]^{\\top}$, represents the Locational Marginal Prices.\n\n2.  **Generation Capacity Limits:** Each generator has a finite capacity:\n    $$\n    0 \\le p_i \\le \\overline{p}_{i}\n    $$\n    We associate Lagrange multipliers $\\mu_i^{min} \\ge 0$ with the constraint $p_i \\ge 0$ (or $-p_i \\le 0$) and $\\mu_i^{max} \\ge 0$ with the constraint $p_i \\le \\overline{p}_{i}$.\n\n3.  **Phase Angle Reference:** To ensure a unique solution for the phase angles, one bus is chosen as the reference (or slack) bus, and its angle is set to zero. Let bus $k_{ref}$ be the reference bus:\n    $$\n    \\theta_{k_{ref}} = 0\n    $$\n\nThe problem is a convex optimization problem, so we can analyze its Karush–Kuhn–Tucker (KKT) conditions to find the properties of the optimal solution. The Lagrangian function $\\mathcal{L}$ is:\n$$\n\\mathcal{L}(p, \\theta, \\lambda, \\mu^{min}, \\mu^{max}) = \\sum_{i=1}^{n} C_{i}(p_{i}) - \\sum_{i=1}^{n} \\lambda_{i} \\left( p_{i} - d_{i} + (B_{bus}\\theta)_i \\right) - \\sum_{i=1}^{n} \\mu_{i}^{min} p_{i} + \\sum_{i=1}^{n} \\mu_{i}^{max} (p_{i} - \\overline{p}_{i})\n$$\nThe first-order KKT stationarity conditions require the gradient of the Lagrangian with respect to the primal variables ($p_i$ and $\\theta_i$) to be zero.\n\n**Stationarity with respect to generation $p_i$:**\nFor each generator $i$ with a non-zero cost function:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p_{i}} = \\frac{dC_{i}}{dp_{i}} - \\lambda_{i} - \\mu_{i}^{min} + \\mu_{i}^{max} = 0\n$$\nThis yields the fundamental relationship for the LMP at bus $i$:\n$$\n\\lambda_{i} = \\frac{dC_{i}}{dp_{i}} - \\mu_{i}^{min} + \\mu_{i}^{max}\n$$\nThis equation shows that the LMP at a bus equals the marginal cost of the generator at that bus, adjusted by the shadow prices of its capacity limits. If the generator is operating strictly between its limits ($0 < p_i < \\overline{p}_{i}$), then by complementary slackness, $\\mu_{i}^{min} = 0$ and $\\mu_{i}^{max} = 0$, so $\\lambda_{i} = \\frac{dC_{i}}{dp_{i}}$.\n\n**Stationarity with respect to phase angle $\\theta_k$:**\nFor each bus $k$ that is not the reference bus ($k \\ne k_{ref}$), we have:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\theta_{k}} = - \\sum_{i=1}^{n} \\lambda_{i} \\frac{\\partial}{\\partial \\theta_{k}} (B_{bus}\\theta)_i = 0\n$$\nThe term $(B_{bus}\\theta)_i$ is $\\sum_{j=1}^{n} (B_{bus})_{ij} \\theta_j$. Therefore, its partial derivative with respect to $\\theta_k$ is $(B_{bus})_{ik}$. The stationarity condition becomes:\n$$\n- \\sum_{i=1}^{n} \\lambda_{i} (B_{bus})_{ik} = 0 \\quad \\text{for all } k \\ne k_{ref}\n$$\nIn matrix form, this is the $k$-th component of the vector product $-B_{bus}^{\\top} \\lambda$. Since $B_{bus}$ is symmetric ($B_{bus}^{\\top} = B_{bus}$), this is equivalent to $(B_{bus}\\lambda)_k = 0$ for all non-reference buses.\n\nFor the reference bus $k_{ref}$, the sum of all rows of $B_{bus}$ is zero (i.e., $\\sum_i (B_{bus})_{ik} = 0$), which means that if $(B_{bus}\\lambda)_k = 0$ holds for all $k \\ne k_{ref}$, it automatically holds for $k=k_{ref}$ as well. Therefore, the condition holds for all buses:\n$$\nB_{bus} \\lambda = 0\n$$\nThe bus admittance matrix $B_{bus}$ for a connected network is a graph Laplacian. Its null space is one-dimensional and is spanned by the vector of all ones, $\\mathbf{1} = [1, 1, \\dots, 1]^{\\top}$. The condition $B_{bus} \\lambda = 0$ thus implies that the vector $\\lambda$ must be an element of this null space. Consequently, $\\lambda$ must be a scalar multiple of the vector $\\mathbf{1}$:\n$$\n\\lambda = c \\cdot \\mathbf{1}\n$$\nfor some scalar $c$. This is equivalent to stating that all components of the vector $\\lambda$ are identical:\n$$\n\\lambda_1 = \\lambda_2 = \\dots = \\lambda_n = c\n$$\nThis completes the derivation. The crucial step relies on the stationarity condition with respect to the phase angles. This condition takes the form $B_{bus}\\lambda=0$ precisely because we have assumed an uncongested network. If any transmission line were at its limit, additional terms involving the Lagrange multipliers of the line flow constraints would appear in the stationarity equation for $\\theta$, breaking the simple $B_{bus}\\lambda=0$ relationship and leading to different LMPs across the network.\n\nTherefore, the condition under which LMPs are identical across all buses in a connected network is the absence of binding transmission constraints (i.e., no congestion).\n\n### Part 2: Numerical Example\n\nThe problem describes a $3$-bus system with no transmission congestion. Based on the derivation in Part 1, we expect a single, uniform LMP, which we will denote by $\\lambda$. The network topology and line susceptances are not needed to find the optimal generation dispatch and the system-wide LMP in an uncongested case; the network's role is simply to connect the buses into a single price region.\n\nThe problem is to minimize the total cost:\n$$\nC(p_1, p_3) = C_{1}(p_{1}) + C_{3}(p_{3}) = \\left(15p_{1} + 0.1p_{1}^{2}\\right) + \\left(10p_{3} + 0.05p_{3}^{2}\\right)\n$$\nsubject to meeting the total demand. The total demand is $D_{total} = d_1 + d_2 + d_3 = 0 + 100 + 0 = 100$. With zero losses, the total generation must equal the total demand:\n$$\np_1 + p_3 = 100\n$$\nThe generation limits are $0 \\le p_1 \\le 120$ and $0 \\le p_3 \\le 120$.\n\nIn an optimal, uncongested dispatch, the marginal costs of all online generators are equal to the system LMP, provided they are operating within their capacity limits. Let's compute the marginal cost functions:\n$$\n\\frac{dC_1}{dp_1} = 15 + 0.2p_1\n$$\n$$\n\\frac{dC_3}{dp_3} = 10 + 0.1p_3\n$$\nWe set the marginal costs equal to the uniform LMP $\\lambda$:\n$$\n15 + 0.2p_1 = \\lambda \\quad (1)\n$$\n$$\n10 + 0.1p_3 = \\lambda \\quad (2)\n$$\nWe can express $p_1$ and $p_3$ in terms of $\\lambda$:\n$$\np_1 = \\frac{\\lambda - 15}{0.2} = 5(\\lambda - 15)\n$$\n$$\np_3 = \\frac{\\lambda - 10}{0.1} = 10(\\lambda - 10)\n$$\nNow, we use the power balance equation $p_1 + p_3 = 100$:\n$$\n5(\\lambda - 15) + 10(\\lambda - 10) = 100\n$$\n$$\n5\\lambda - 75 + 10\\lambda - 100 = 100\n$$\n$$\n15\\lambda - 175 = 100\n$$\n$$\n15\\lambda = 275\n$$\n$$\n\\lambda = \\frac{275}{15} = \\frac{55}{3}\n$$\nThe uniform LMP is $\\lambda = \\frac{55}{3} \\approx 18.333\\dots$ $\\$ /\\text{MWh}$.\n\nWe can now find the optimal dispatch $(p_1^\\star, p_3^\\star)$:\n$$\np_1^\\star = 5\\left(\\frac{55}{3} - 15\\right) = 5\\left(\\frac{55 - 45}{3}\\right) = 5\\left(\\frac{10}{3}\\right) = \\frac{50}{3}\n$$\n$$\np_3^\\star = 10\\left(\\frac{55}{3} - 10\\right) = 10\\left(\\frac{55 - 30}{3}\\right) = 10\\left(\\frac{25}{3}\\right) = \\frac{250}{3}\n$$\nThe optimal dispatch is $p_1^\\star \\approx 16.67$ MW and $p_3^\\star \\approx 83.33$ MW.\nWe check if these values are within the generator capacity limits:\n$0 < \\frac{50}{3} < 120$ and $0 < \\frac{250}{3} < 120$. Both conditions are satisfied. Thus, our assumption that the generators are not at their limits is correct, and the marginal costs are indeed equal.\n\nThe final step is to round the value of the LMP to four significant figures.\n$$\n\\lambda = \\frac{55}{3} \\approx 18.3333\\dots\n$$\nRounding to four significant figures gives $18.33$.\nThe uniform LMP is $18.33$ $\\$/\\text{MWh}$.",
            "answer": "$$\\boxed{18.33}$$"
        },
        {
            "introduction": "The primary purpose of LMPs is to manage transmission congestion efficiently, a concept best understood by comparing it to alternative models. This practice  presents a scenario where a simplified zonal pricing scheme fails to send the correct economic signals, leading to inefficient dispatch and a quantifiable loss of social welfare. By working through this counterexample, you will gain a practical appreciation for how nodal prices guide the market toward a more economically optimal outcome.",
            "id": "4102191",
            "problem": "Consider a two-node network operated under the Direct Current (DC) approximation of power flow. Bus $1$ and bus $2$ are connected by a single transmission line with an export flow $f$ from bus $1$ to bus $2$ subject to an upper capacity limit $0 \\leq f \\leq F^{\\max}$, where $F^{\\max} = 100$ megawatts (MW). There is a single generator at each bus. Generator $1$ at bus $1$ has a constant marginal cost $c_1 = 40$ dollars per megawatt-hour ($\\$/\\mathrm{MWh}$) and no capacity limit. Generator $2$ at bus $2$ has a constant marginal cost $c_2 = 100$ $\\$/\\mathrm{MWh}$ and no capacity limit. Demand at each bus is price-responsive with inverse demand functions $\\pi_1(q_1) = 120 - 0.2 q_1$ at bus $1$ and $\\pi_2(q_2) = 160 - 0.4 q_2$ at bus $2$, where $q_i$ is the consumption at bus $i$ in MW and $\\pi_i(q_i)$ is the corresponding willingness-to-pay in $\\$/\\mathrm{MWh}$. Assume one hour so that MW and megawatt-hours coincide.\n\nThe system operator first considers the Locational Marginal Pricing (LMP) design: maximize total social surplus (the sum of consumer surpluses minus generation costs) subject to power balance at each bus and the transmission constraint. The resulting nodal prices are the Lagrange multipliers on the bus balance constraints. Then the operator considers a single-zone pricing design: a uniform zonal price $\\pi^{Z}$ equal to the energy-only marginal cost ignoring transmission constraints (that is, $\\pi^{Z} = c_1$). Under zonal pricing, consumers form their schedules by equating inverse demand to $\\pi^{Z}$, and the operator subsequently re-dispatches generators to honor the transmission constraint and meet the scheduled demands, collecting any shortfall between total generation costs and total market payments as an uplift.\n\nTasks:\n1. Under Locational Marginal Pricing, derive the efficient dispatch $\\{q_1^{*}, q_2^{*}, g_1^{*}, g_2^{*}, f^{*}\\}$ and the nodal prices at bus $1$ and bus $2$ by solving the social welfare maximization problem under the DC approximation and appropriate constraints.\n2. Under the single-zone pricing design with $\\pi^{Z} = c_1$, determine the scheduled demands $\\{q_1^{Z}, q_2^{Z}\\}$. Then compute the operator’s re-dispatch $\\{g_1^{Z}, g_2^{Z}, f^{Z}\\}$ that respects the transmission constraint and serves the scheduled demands. Compute the uplift as the difference between total generation costs and total market payments at the zonal price.\n3. Using the inverse demand functions and the realized dispatches, compute the total social welfare under each design (consumer surplus minus generation costs). Quantify the welfare loss due to uplift and re-dispatch by taking the difference between social welfare under Locational Marginal Pricing and under zonal pricing with re-dispatch.\n\nExpress the final welfare loss as a single number in dollars per hour. Use exact arithmetic; do not round unless necessary. Your final numerical answer must be a single real number.",
            "solution": "### Part 1: Locational Marginal Pricing (LMP)\n\nThe objective is to maximize social surplus, which is the total consumer benefit minus the total generation cost. The consumer benefit for a demand $q$ with inverse demand function $\\pi(q)$ is given by the integral $\\int_0^q \\pi(x) dx$.\n\nThe social welfare $SW$ to be maximized is:\n$$ SW = \\int_0^{q_1} \\pi_1(x) dx + \\int_0^{q_2} \\pi_2(x) dx - (c_1 g_1 + c_2 g_2) $$\nSubstituting the given inverse demand functions $\\pi_1(q_1) = 120 - 0.2 q_1$ and $\\pi_2(q_2) = 160 - 0.4 q_2$, and the marginal costs $c_1 = 40$ and $c_2 = 100$:\n$$ SW(q_1, q_2, g_1, g_2) = (120 q_1 - 0.1 q_1^2) + (160 q_2 - 0.2 q_2^2) - (40 g_1 + 100 g_2) $$\n\nThis maximization is subject to the following constraints:\n1. Power balance at bus 1: $g_1 = q_1 + f$ ($\\lambda_1$)\n2. Power balance at bus 2: $g_2 + f = q_2$ ($\\lambda_2$)\n3. Transmission capacity: $0 \\leq f \\leq F^{\\max}$, where $F^{\\max} = 100$.\n\nWe substitute the power balance constraints into the social welfare function to express it in terms of the independent variables $q_1$, $q_2$, and $f$:\n$$ SW(q_1, q_2, f) = (120 q_1 - 0.1 q_1^2) + (160 q_2 - 0.2 q_2^2) - 40(q_1 + f) - 100(q_2 - f) $$\n$$ SW(q_1, q_2, f) = (80 q_1 - 0.1 q_1^2) + (60 q_2 - 0.2 q_2^2) + 60 f $$\nThis objective function is separable in $q_1$, $q_2$, and $f$. To maximize $SW$, we can maximize each term independently subject to the constraints.\n\nThe partial derivative with respect to $f$ is $\\frac{\\partial SW}{\\partial f} = 60$. Since this is positive, welfare is maximized by making the flow $f$ from bus $1$ to bus $2$ as large as possible. Given the constraint $0 \\leq f \\leq 100$, the optimal flow is $f^* = 100$ MW.\n\nFor $q_1$, we set the derivative to zero to find the maximum:\n$$ \\frac{\\partial SW}{\\partial q_1} = 80 - 0.2 q_1 = 0 \\implies q_1^* = \\frac{80}{0.2} = 400 \\text{ MW} $$\nFor $q_2$, we do the same:\n$$ \\frac{\\partial SW}{\\partial q_2} = 60 - 0.4 q_2 = 0 \\implies q_2^* = \\frac{60}{0.4} = 150 \\text{ MW} $$\nThe generation levels are then determined by the power balance equations with $f^*=100$:\n$$ g_1^* = q_1^* + f^* = 400 + 100 = 500 \\text{ MW} $$\n$$ g_2^* = q_2^* - f^* = 150 - 100 = 50 \\text{ MW} $$\nThe locational marginal prices (LMPs), $\\lambda_1$ and $\\lambda_2$, are the prices consumers see at each bus in an efficient market. They are equal to the marginal benefit of consumption at the optimal quantities:\n$$ \\lambda_1 = \\pi_1(q_1^*) = 120 - 0.2(400) = 120 - 80 = 40 \\text{ \\$/MWh} $$\n$$ \\lambda_2 = \\pi_2(q_2^*) = 160 - 0.4(150) = 160 - 60 = 100 \\text{ \\$/MWh} $$\nThese prices are consistent with the marginal costs of generation available to each bus. At bus 1, the price is the marginal cost of Generator 1 ($c_1=40$). At bus 2, the local generator (Generator 2, $c_2=100$) must be dispatched to meet demand, as the cheaper power from bus 1 is limited by transmission congestion. Thus, the price at bus 2 reflects the marginal cost of Generator 2.\n\nThe efficient dispatch is $\\{q_1^{*}, q_2^{*}, g_1^{*}, g_2^{*}, f^{*}\\} = \\{400, 150, 500, 50, 100\\}$ in units of MW. The nodal prices are $\\lambda_1=40$ \\$/MWh and $\\lambda_2=100$ \\$/MWh.\n\n### Part 2: Single-Zone Pricing\n\nUnder this design, a single zonal price $\\pi^Z$ is announced to all consumers, and it is set to the marginal cost of the cheapest generator, $\\pi^Z = c_1 = 40$ \\$/MWh. Consumers schedule their demand by equating their marginal benefit to this price.\n\nScheduled demand at bus 1:\n$$ \\pi_1(q_1^Z) = \\pi^Z \\implies 120 - 0.2 q_1^Z = 40 \\implies 0.2 q_1^Z = 80 \\implies q_1^Z = 400 \\text{ MW} $$\nScheduled demand at bus 2:\n$$ \\pi_2(q_2^Z) = \\pi^Z \\implies 160 - 0.4 q_2^Z = 40 \\implies 0.4 q_2^Z = 120 \\implies q_2^Z = 300 \\text{ MW} $$\nThe operator must now re-dispatch generation to meet these scheduled demands $\\{q_1^Z, q_2^Z\\} = \\{400, 300\\}$ at minimum cost, respecting the transmission constraint $0 \\leq f^Z \\leq 100$. The cost to be minimized is $C = 40 g_1^Z + 100 g_2^Z$.\nUsing the power balance equations $g_1^Z = 400 + f^Z$ and $g_2^Z = 300 - f^Z$, we express the cost as a function of flow $f^Z$:\n$$ C(f^Z) = 40(400 + f^Z) + 100(300 - f^Z) = 16000 + 40 f^Z + 30000 - 100 f^Z = 46000 - 60 f^Z $$\nTo minimize cost, $f^Z$ must be maximized. Thus, $f^Z = 100$ MW.\nThe re-dispatch generation levels are:\n$$ g_1^Z = 400 + 100 = 500 \\text{ MW} $$\n$$ g_2^Z = 300 - 100 = 200 \\text{ MW} $$\nThe total generation cost is:\n$$ TC^Z = 40 g_1^Z + 100 g_2^Z = 40(500) + 100(200) = 20000 + 20000 = \\$40000 $$\nThe total revenue from selling energy at the zonal price is:\n$$ TR^Z = \\pi^Z (q_1^Z + q_2^Z) = 40 (400 + 300) = 40(700) = \\$28000 $$\nThe uplift is the shortfall between costs and revenues:\n$$ \\text{Uplift} = TC^Z - TR^Z = \\$40000 - \\$28000 = \\$12000 $$\n\n### Part 3: Welfare Loss\n\nWe compute the total social welfare for each design and find the difference.\n\nSocial Welfare under LMP ($SW^*$):\n$$ SW^* = \\left( \\int_0^{q_1^*} \\pi_1(q) dq + \\int_0^{q_2^*} \\pi_2(q) dq \\right) - (c_1 g_1^* + c_2 g_2^*) $$\nBenefit at bus 1: $\\int_0^{400} (120 - 0.2q) dq = [120q - 0.1q^2]_0^{400} = 120(400) - 0.1(400^2) = 48000 - 16000 = \\$32000$.\nBenefit at bus 2: $\\int_0^{150} (160 - 0.4q) dq = [160q - 0.2q^2]_0^{150} = 160(150) - 0.2(150^2) = 24000 - 4500 = \\$19500$.\nTotal Benefit: $\\$32000 + \\$19500 = \\$51500$.\nTotal Generation Cost: $c_1 g_1^* + c_2 g_2^* = 40(500) + 100(50) = 20000 + 5000 = \\$25000$.\n$$ SW^* = \\$51500 - \\$25000 = \\$26500 $$\n\nSocial Welfare under Zonal Pricing ($SW^Z$):\nThe realized dispatch is $\\{q_1^Z, q_2^Z, g_1^Z, g_2^Z\\} = \\{400, 300, 500, 200\\}$.\n$$ SW^Z = \\left( \\int_0^{q_1^Z} \\pi_1(q) dq + \\int_0^{q_2^Z} \\pi_2(q) dq \\right) - (c_1 g_1^Z + c_2 g_2^Z) $$\nBenefit at bus 1: (same as above) $\\$32000$.\nBenefit at bus 2: $\\int_0^{300} (160 - 0.4q) dq = [160q - 0.2q^2]_0^{300} = 160(300) - 0.2(300^2) = 48000 - 18000 = \\$30000$.\nTotal Benefit: $\\$32000 + \\$30000 = \\$62000$.\nTotal Generation Cost: (calculated in Part 2) $\\$40000$.\n$$ SW^Z = \\$62000 - \\$40000 = \\$22000 $$\n\nThe welfare loss due to the zonal pricing scheme is the difference between the optimal welfare under LMP and the welfare under zonal pricing.\n$$ \\text{Welfare Loss} = SW^* - SW^Z = \\$26500 - \\$22000 = \\$4500 $$\nThis loss arises because consumers at bus 2 face a price (\\$40) that does not reflect the true marginal cost of serving them (\\$100), leading to over-consumption. The cost to produce the extra demand at bus 2 ($150$ MW) is $150 \\times 100 = \\$15000$, while the consumer benefit from this extra consumption is $\\int_{150}^{300} \\pi_2(q)dq = \\$10500$, resulting in a net loss of $\\$15000 - \\$10500 = \\$4500$.",
            "answer": "$$\\boxed{4500}$$"
        },
        {
            "introduction": "In modern power systems with high penetrations of subsidized renewable energy, LMPs can sometimes take on negative values, a counter-intuitive but powerful economic signal. This exercise  delves into such a scenario, where transmission congestion traps subsidized wind generation, forcing its curtailment and creating a negative price. Calculating the dispatch and resulting LMPs provides direct insight into how the market signals that it is costly to dispose of excess local generation.",
            "id": "4102273",
            "problem": "Consider a two-bus Direct-Current (DC) power flow network operated under a single-period Security-Constrained Economic Dispatch (SCED). Bus $1$ hosts a wind generator with zero physical marginal cost and a production subsidy of $s$ dollars per megawatt-hour, and Bus $2$ hosts a thermal generator with constant marginal cost $c_t$ dollars per megawatt-hour. There is fixed demand $d_1$ at Bus $1$ and $d_2$ at Bus $2$. A single transmission line connects Bus $1$ to Bus $2$ with a symmetric thermal limit $F_{\\max}$ on the absolute value of the flow. The wind generator is curtailable with an availability upper bound $G_{\\max}$, and the thermal generator has no upper bound for the purposes of this dispatch. Assume negligible losses and no reactive power. Let the wind subsidy be implemented in the dispatch objective as a negative cost term for wind production.\n\nUse the following numerically specified and scientifically realistic parameters:\n- Bus $1$ demand $d_1 = 0$ megawatts.\n- Bus $2$ demand $d_2 = 100$ megawatts.\n- Wind availability $G_{\\max} = 120$ megawatts.\n- Line limit $F_{\\max} = 60$ megawatts.\n- Thermal marginal cost $c_t = 30$ dollars per megawatt-hour.\n- Wind production subsidy $s = 50$ dollars per megawatt-hour.\n\nFormulate the SCED with decision variables for wind generation $g_w$, thermal generation $g_t$, and line flow $f$, using bus power balance equalities constructed from first principles of DC nodal power balance, generator capability limits, and line thermal limits. Starting from this optimization formulation as the fundamental base, derive the Karush-Kuhn-Tucker (KKT) optimality conditions, identify the dual variables associated with the bus power balance equalities, and interpret these dual variables as the Locational Marginal Prices (LMPs). Solve for the optimal dispatch and the corresponding LMPs under congestion that arises due to the binding transmission constraint and the wind subsidy that economically favors wind production, thereby creating a potential for local overgeneration at Bus $1$ absent curtailment.\n\nCompute the numerical value of the Locational Marginal Price (LMP) at Bus $1$ in dollars per megawatt-hour. Express the final price in dollars per megawatt-hour without rounding.",
            "solution": "The Security-Constrained Economic Dispatch (SCED) problem is formulated to minimize the total operational cost, where the wind subsidy is treated as a negative cost.\n\n**Optimization Formulation**\n\nThe decision variables are the wind generation $g_w$, thermal generation $g_t$, and the power flow $f$ from Bus 1 to Bus 2.\n\nThe objective function to minimize is the total system cost $Z$:\n$$ \\min_{g_w, g_t, f} Z = c_t g_t - s g_w $$\n\nThis is subject to the following constraints, with their associated dual variables (Lagrange multipliers) shown in parentheses:\n1.  **Power Balance at Bus 1:** $g_w - f - d_1 = 0 \\quad (\\lambda_1)$\n2.  **Power Balance at Bus 2:** $g_t + f - d_2 = 0 \\quad (\\lambda_2)$\n3.  **Wind Generation Limits:** $0 \\le g_w \\le G_{\\max}$\n4.  **Thermal Generation Limit:** $g_t \\ge 0$\n5.  **Transmission Line Limit:** $|f| \\le F_{\\max}$\n\nThe dual variables on the power balance constraints, $\\lambda_1$ and $\\lambda_2$, are the Locational Marginal Prices (LMPs) at Bus 1 and Bus 2, respectively.\n\n**Karush-Kuhn-Tucker (KKT) Conditions**\n\nFrom the Lagrangian of this problem, the stationarity condition with respect to the wind generation $g_w$ is:\n$$ -s - \\lambda_1 + \\mu_{w,\\max} - \\mu_{w,\\min} = 0 $$\nwhere $\\mu_{w,\\max} \\ge 0$ and $\\mu_{w,\\min} \\ge 0$ are the dual variables for the upper and lower generation limits of the wind unit. This equation can be rearranged to express the LMP at Bus 1:\n$$ \\lambda_1 = -s + \\mu_{w,\\max} - \\mu_{w,\\min} $$\n\n**Optimal Dispatch Calculation**\n\nWe substitute the given parameters: $d_1=0$, $d_2=100$, $G_{\\max}=120$, $F_{\\max}=60$, $c_t=30$, and $s=50$.\n\nThe economic cost of wind power is its marginal cost (0) minus the subsidy, resulting in an effective cost of $-s = -50$ $\\$/\\text{MWh}$. The thermal power costs $c_t = 30$ $\\$/\\text{MWh}$. The system will prioritize using the cheapest resource (wind) to serve the 100 MW load at Bus 2.\n\nHowever, the power must flow from Bus 1 to Bus 2, and the transmission line is limited to $F_{\\max} = 60$ MW. Since the demand (100 MW) exceeds the line capacity, the line will be congested. The system will send as much of the cheap wind power as possible.\n-   Optimal flow: $f = F_{\\max} = 60$ MW.\n\nThe remaining 40 MW of demand at Bus 2 must be supplied by the local, more expensive thermal generator.\n-   Optimal thermal generation: $g_t = d_2 - f = 100 - 60 = 40$ MW.\n\nThe amount of wind generation needed to support the 60 MW flow is determined by the power balance at Bus 1:\n-   $g_w - f - d_1 = 0 \\implies g_w - 60 - 0 = 0 \\implies g_w = 60$ MW.\n\nThe optimal dispatch is $(g_w, g_t, f) = (60, 40, 60)$ MW.\n\n**LMP Calculation**\n\nWe can now find the LMP at Bus 1, $\\lambda_1$. The optimal wind dispatch is $g_w = 60$ MW. This is within the generator's limits ($0  60  120$). Because the wind generator is operating strictly between its lower and upper bounds, its corresponding inequality constraints are not binding. By the principle of complementary slackness, their dual variables must be zero: $\\mu_{w,\\min} = 0$ and $\\mu_{w,\\max} = 0$.\n\nSubstituting these into the KKT stationarity condition for $\\lambda_1$:\n$$ \\lambda_1 = -s + 0 - 0 = -s $$\nGiven the subsidy $s = 50$ $\\$/\\text{MWh}$:\n$$ \\lambda_1 = -50 $$\nThe Locational Marginal Price at Bus 1 is $-50$ $\\$/\\text{MWh}$. This negative price signals that there is a surplus of cheap, subsidized generation at Bus 1 that is \"trapped\" by transmission congestion, and the system would effectively save money (by collecting more subsidy) if more load were to be served at that location.",
            "answer": "$$\\boxed{-50}$$"
        }
    ]
}