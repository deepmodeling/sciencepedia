{
    "hands_on_practices": [
        {
            "introduction": "要深刻理解位置边际电价（LMP），最有效的方法是从理想情况入手。本练习将指导您从基本原理出发，在无阻塞的输电网络中推导出电价在所有节点上保持一致的条件。通过解决这个直流最优潮流（DCOPF）问题，您将为后续更复杂的阻塞场景分析奠定坚实的理论基础。",
            "id": "4102233",
            "problem": "考虑一个在标准直流最优潮流 (DCOPF) 近似下建模的连通输电网络：电压幅值固定，忽略无功功率，有功功率潮流与母线电压相角呈线性关系。设网络有 $n$ 个母线和 $m$ 条输电线路。定义线路-母线关联矩阵为 $K \\in \\mathbb{R}^{m \\times n}$，其方向任意，并设线路电纳对角矩阵为 $B_{\\ell} \\in \\mathbb{R}^{m \\times m}$，其对角线元素严格为正。那么，线路潮流向量满足 $f = B_{\\ell} K \\theta$，其中 $\\theta \\in \\mathbb{R}^{n}$ 是母线电压相角向量。节点功率平衡表示为\n$$\nd - p - K^{\\top} f = 0,\n$$\n其中 $d \\in \\mathbb{R}^{n}_{\\ge 0}$ 是负荷向量，$p \\in \\mathbb{R}^{n}_{\\ge 0}$ 是净发电注入向量。假设每个发电机 $i \\in \\{1,\\dots,n\\}$ 都有一个凸的、连续可微的成本函数 $C_{i}(p_{i})$ 和一个有限容量 $\\overline{p}_{i} > 0$。假设零损耗（即总发电量等于总负荷），并且所有输电约束都是非紧的（热极限足够大，以至于在最优点没有任何线路达到其极限）。DCOPF 问题在这些约束条件下最小化总发电成本。\n\n任务1：仅从上述 DCOPF 公式和约束凸优化的第一性原理出发，推导在何种条件下，节点边际电价 (LMP)——定义为与节点功率平衡约束相关的影子价格——在连通网络中的所有母线上都相同，并等于一个单一标量 $\\lambda$。您的推导必须从无损耗、无阻塞 DCOPF 的 Karush–Kuhn–Tucker (KKT) 条件出发。\n\n任务2：构建并求解以下小型数值算例，以计算统一 LMP 的值。考虑一个由母线 $1$、$2$ 和 $3$ 构成的 $3$ 母线网络，通过线路 $(1,2)$、$(2,3)$ 和 $(1,3)$ 连接成一个三角形，其电纳分别为 $b_{12} = 5$、$b_{23} = 4$ 和 $b_{13} = 6$，且热极限设置得足够高，以至于没有线路约束是紧的。负荷仅位于母线 $2$，为 $d_{2} = 100$，而 $d_{1} = d_{3} = 0$。母线 $1$ 和 $3$ 处有发电机，其成本函数为\n$$\nC_{1}(p_{1}) = 15\\,p_{1} + \\frac{1}{2}\\cdot 0.2\\,p_{1}^{2}, \\quad C_{3}(p_{3}) = 10\\,p_{3} + \\frac{1}{2}\\cdot 0.1\\,p_{3}^{2},\n$$\n容量分别为 $\\overline{p}_{1} = 120$ 和 $\\overline{p}_{3} = 120$。假设零损耗且无阻塞。求解最优调度 $(p_{1}^{\\star}, p_{3}^{\\star})$ 和相应的统一 LMP $\\lambda$。将 LMP 的最终数值四舍五入到四位有效数字，并以美元/兆瓦时 ($\\$/\\text{MWh}$) 表示。",
            "solution": "按要求，分析分两部分进行。首先，我们从第一性原理推导统一节点边际电价 (LMP) 的一般条件。其次，我们应用这一理解来解决具体的数值算例。\n\n### 第 1 部分：统一LMP条件的推导\n\n直流最优潮流 (DCOPF) 问题旨在在满足物理和运行约束的前提下，最小化总发电成本。根据问题陈述，我们考虑一个无损耗和无阻塞的网络。\n\n决策变量是发电注入向量 $p \\in \\mathbb{R}^n$ 和母线电压相角向量 $\\theta \\in \\mathbb{R}^n$。目标是最小化总发电成本，即各个发电机成本函数之和：\n$$\n\\min_{p, \\theta} \\sum_{i=1}^{n} C_{i}(p_{i})\n$$\n该最小化问题受以下几个约束条件限制：\n\n1.  **节点功率平衡：** 在每个母线 $i$，注入的功率必须等于流出的功率。问题中给出该约束为 $d - p - K^{\\top} f = 0$。代入线路潮流方程 $f = B_{\\ell} K \\theta$，我们得到：\n    $$\n    d - p - K^{\\top} B_{\\ell} K \\theta = 0\n    $$\n    我们定义母线导纳矩阵 $B_{bus} = K^{\\top} B_{\\ell} K$。于是，每个母线 $i$ 的节点功率平衡约束为：\n    $$\n    p_i - d_i + (B_{bus}\\theta)_i = 0 \\quad \\text{for } i \\in \\{1, \\dots, n\\}\n    $$\n    我们为这 $n$ 个等式约束中的每一个都关联一个拉格朗日乘子 $\\lambda_i$。这些乘子的向量 $\\lambda = [\\lambda_1, \\dots, \\lambda_n]^{\\top}$ 代表了节点边际电价。\n\n2.  **发电容量限制：** 每个发电机的容量都是有限的：\n    $$\n    0 \\le p_i \\le \\overline{p}_{i}\n    $$\n    我们为约束 $p_i \\ge 0$ (或 $-p_i \\le 0$) 关联拉格朗日乘子 $\\mu_i^{min} \\ge 0$，为约束 $p_i \\le \\overline{p}_{i}$ 关联拉格朗日乘子 $\\mu_i^{max} \\ge 0$。\n\n3.  **相角参考：** 为确保相角有唯一解，选择一个母线作为参考（或平衡）母线，并将其角度设置为零。设母线 $k_{ref}$ 为参考母线：\n    $$\n    \\theta_{k_{ref}} = 0\n    $$\n\n该问题是一个凸优化问题，因此我们可以分析其 Karush–Kuhn–Tucker (KKT) 条件来找到最优解的性质。拉格朗日函数 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L}(p, \\theta, \\lambda, \\mu^{min}, \\mu^{max}) = \\sum_{i=1}^{n} C_{i}(p_{i}) - \\sum_{i=1}^{n} \\lambda_{i} \\left( p_{i} - d_{i} + (B_{bus}\\theta)_i \\right) - \\sum_{i=1}^{n} \\mu_{i}^{min} p_{i} + \\sum_{i=1}^{n} \\mu_{i}^{max} (p_{i} - \\overline{p}_{i})\n$$\n一阶KKT平稳性条件要求拉格朗日函数相对于原始变量（$p_i$ 和 $\\theta_i$）的梯度为零。\n\n**关于发电量 $p_i$ 的平稳性：**\n对于每个具有非零成本函数的发电机 $i$：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p_{i}} = \\frac{dC_{i}}{dp_{i}} - \\lambda_{i} - \\mu_{i}^{min} + \\mu_{i}^{max} = 0\n$$\n这得出了母线 $i$ 处 LMP 的基本关系：\n$$\n\\lambda_{i} = \\frac{dC_{i}}{dp_{i}} - \\mu_{i}^{min} + \\mu_{i}^{max}\n$$\n该方程表明，一个母线的 LMP 等于该母线上发电机的边际成本，并由其容量限制的影子价格进行调整。如果发电机在其容量限制之间运行（$0  p_i  \\overline{p}_{i}$），那么根据互补松弛性，$\\mu_{i}^{min} = 0$ 和 $\\mu_{i}^{max} = 0$，因此 $\\lambda_{i} = \\frac{dC_{i}}{dp_{i}}$。\n\n**关于相角 $\\theta_k$ 的平稳性：**\n对于每个非参考母线 $k$（$k \\ne k_{ref}$），我们有：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\theta_{k}} = - \\sum_{i=1}^{n} \\lambda_{i} \\frac{\\partial}{\\partial \\theta_{k}} (B_{bus}\\theta)_i = 0\n$$\n项 $(B_{bus}\\theta)_i$ 是 $\\sum_{j=1}^{n} (B_{bus})_{ij} \\theta_j$。因此，它对 $\\theta_k$ 的偏导数是 $(B_{bus})_{ik}$。平稳性条件变为：\n$$\n- \\sum_{i=1}^{n} \\lambda_{i} (B_{bus})_{ik} = 0 \\quad \\text{for all } k \\ne k_{ref}\n$$\n用矩阵形式表示，这是向量积 $-B_{bus}^{\\top} \\lambda$ 的第 $k$ 个分量。由于 $B_{bus}$ 是对称的（$B_{bus}^{\\top} = B_{bus}$），这等价于对所有非参考母线都有 $(B_{bus}\\lambda)_k = 0$。\n\n对于参考母线 $k_{ref}$，$B_{bus}$ 的所有行之和为零（即 $\\sum_i (B_{bus})_{ik} = 0$），这意味着如果 $(B_{bus}\\lambda)_k = 0$ 对所有 $k \\ne k_{ref}$ 成立，那么它对 $k=k_{ref}$ 也自动成立。因此，该条件对所有母线都成立：\n$$\nB_{bus} \\lambda = 0\n$$\n对于一个连通网络，母线导纳矩阵 $B_{bus}$ 是一个图拉普拉斯矩阵。其零空间是一维的，由全一向量 $\\mathbf{1} = [1, 1, \\dots, 1]^{\\top}$ 张成。因此，条件 $B_{bus} \\lambda = 0$ 意味着向量 $\\lambda$ 必须是这个零空间的元素。所以，$\\lambda$ 必须是向量 $\\mathbf{1}$ 的一个标量倍数：\n$$\n\\lambda = c \\cdot \\mathbf{1}\n$$\n其中 $c$ 是某个标量。这等价于说向量 $\\lambda$ 的所有分量都相同：\n$$\n\\lambda_1 = \\lambda_2 = \\dots = \\lambda_n = c\n$$\n推导至此完成。关键步骤依赖于关于相角的平稳性条件。该条件之所以呈现 $B_{bus}\\lambda=0$ 的形式，正是因为我们假设了一个无阻塞的网络。如果任何输电线路达到其极限，涉及线路潮流约束的拉格朗日乘子的附加项将出现在关于 $\\theta$ 的平稳性方程中，从而打破简单的 $B_{bus}\\lambda=0$ 关系，并导致网络中各处的 LMP 不同。\n\n因此，在连通网络中所有母线的 LMP 都相同的条件是不存在紧的输电约束（即无阻塞）。\n\n### 第 2 部分：数值算例\n\n该问题描述了一个没有输电阻塞的 $3$ 母线系统。根据第 1 部分的推导，我们预期会有一个单一的、统一的 LMP，我们将其表示为 $\\lambda$。在无阻塞的情况下，网络拓扑和线路电纳对于求解最优发电调度和全系统 LMP 并非必需；网络的作用仅仅是将母线连接成一个单一价格区。\n\n问题是最小化总成本：\n$$\nC(p_1, p_3) = C_{1}(p_{1}) + C_{3}(p_{3}) = \\left(15p_{1} + 0.1p_{1}^{2}\\right) + \\left(10p_{3} + 0.05p_{3}^{2}\\right)\n$$\n同时要满足总负荷需求。总负荷为 $D_{total} = d_1 + d_2 + d_3 = 0 + 100 + 0 = 100$。在零损耗的情况下，总发电量必须等于总负荷：\n$$\np_1 + p_3 = 100\n$$\n发电量限制为 $0 \\le p_1 \\le 120$ 和 $0 \\le p_3 \\le 120$。\n\n在最优的、无阻塞的调度中，所有在线运行的发电机，只要它们在其容量限制内运行，其边际成本都等于系统 LMP。让我们计算边际成本函数：\n$$\n\\frac{dC_1}{dp_1} = 15 + 0.2p_1\n$$\n$$\n\\frac{dC_3}{dp_3} = 10 + 0.1p_3\n$$\n我们将边际成本设为等于统一的 LMP $\\lambda$：\n$$\n15 + 0.2p_1 = \\lambda \\quad (1)\n$$\n$$\n10 + 0.1p_3 = \\lambda \\quad (2)\n$$\n我们可以用 $\\lambda$ 来表示 $p_1$ 和 $p_3$：\n$$\np_1 = \\frac{\\lambda - 15}{0.2} = 5(\\lambda - 15)\n$$\n$$\np_3 = \\frac{\\lambda - 10}{0.1} = 10(\\lambda - 10)\n$$\n现在，我们使用功率平衡方程 $p_1 + p_3 = 100$：\n$$\n5(\\lambda - 15) + 10(\\lambda - 10) = 100\n$$\n$$\n5\\lambda - 75 + 10\\lambda - 100 = 100\n$$\n$$\n15\\lambda - 175 = 100\n$$\n$$\n15\\lambda = 275\n$$\n$$\n\\lambda = \\frac{275}{15} = \\frac{55}{3}\n$$\n统一的 LMP 是 $\\lambda = \\frac{55}{3} \\approx 18.333\\dots \\, \\$/\\text{MWh}$。\n\n我们现在可以找到最优调度 $(p_1^\\star, p_3^\\star)$：\n$$\np_1^\\star = 5\\left(\\frac{55}{3} - 15\\right) = 5\\left(\\frac{55 - 45}{3}\\right) = 5\\left(\\frac{10}{3}\\right) = \\frac{50}{3}\n$$\n$$\np_3^\\star = 10\\left(\\frac{55}{3} - 10\\right) = 10\\left(\\frac{55 - 30}{3}\\right) = 10\\left(\\frac{25}{3}\\right) = \\frac{250}{3}\n$$\n最优调度为 $p_1^\\star \\approx 16.67$ MW 和 $p_3^\\star \\approx 83.33$ MW。\n我们检查这些值是否在发电机容量限制内：\n$0  \\frac{50}{3}  120$ 且 $0  \\frac{250}{3}  120$。两个条件都满足。因此，我们关于发电机未达到其容量极限的假设是正确的，并且边际成本确实相等。\n\n最后一步是将 LMP 的值四舍五入到四位有效数字。\n$$\n\\lambda = \\frac{55}{3} \\approx 18.3333\\dots\n$$\n四舍五入到四位有效数字得到 $18.33$。\n统一的 LMP 是 $18.33 \\, \\$/\\text{MWh}$。",
            "answer": "$$\\boxed{18.33}$$"
        },
        {
            "introduction": "在掌握了无阻塞情况下的统一定价后，我们来探讨输电阻塞这一更为现实的场景。本练习通过对比节点定价（LMP）与分区定价（zonal pricing）的经济效率，揭示了位置信号在电力市场中的关键作用。通过亲手计算不同定价机制下的调度方案、社会总成本以及福利损失，您将具体地理解为何精确的位置价格信号对于实现电力系统的经济最优至关重要。",
            "id": "4102191",
            "problem": "考虑一个在直流（DC）潮流近似下运行的双节点网络。母线$1$和母线$2$通过一条输电线路相连，从母线$1$到母线$2$的输出潮流为$f$，受容量上限$0 \\leq f \\leq F^{\\max}$约束，其中$F^{\\max} = 100$兆瓦（MW）。每个母线上都有一台发电机。母线$1$上的发电机$1$的恒定边际成本为$c_1 = 40 \\, \\$/\\mathrm{MWh}$，且没有容量限制。母线$2$上的发电机$2$的恒定边际成本为$c_2 = 100 \\, \\$/\\mathrm{MWh}$，且没有容量限制。每个母线的需求都是价格响应型的，其反需求函数在母线$1$为$\\pi_1(q_1) = 120 - 0.2 q_1$，在母线$2$为$\\pi_2(q_2) = 160 - 0.4 q_2$，其中$q_i$是母线$i$的消耗量（单位：MW），$\\pi_i(q_i)$是相应的支付意愿（单位：$\\$/\\mathrm{MWh}$）。假设时间为一小时，因此兆瓦（MW）和兆瓦时（MWh）的数值相同。\n\n系统运营商首先考虑节点边际电价（LMP）设计：在满足各母线功率平衡和输电约束的前提下，最大化总社会盈余（消费者盈余之和减去发电成本）。由此产生的节点电价是母线平衡约束的拉格朗日乘子。然后，运营商考虑单一区域定价设计：一个统一的区域价格$\\pi^{Z}$，等于忽略输电约束的纯能源边际成本（即$\\pi^{Z} = c_1$）。在区域定价下，消费者通过使其反需求函数值等于$\\pi^{Z}$来制定其用电计划，随后运营商重新调度发电机以遵守输电约束并满足计划需求，并将总发电成本与总市场支付之间的任何差额作为增收费用进行收取。\n\n任务：\n1. 在节点边际电价下，通过求解直流近似和适当约束下的社会福利最大化问题，推导出有效调度$\\{q_1^{*}, q_2^{*}, g_1^{*}, g_2^{*}, f^{*}\\}$以及母线$1$和母线$2$的节点电价。\n2. 在$\\pi^{Z} = c_1$的单一区域定价设计下，确定计划需求$\\{q_1^{Z}, q_2^{Z}\\}$。然后计算运营商在遵守输电约束并服务于计划需求下的重新调度$\\{g_1^{Z}, g_2^{Z}, f^{Z}\\}$。计算增收费用，即总发电成本与按区域价格计算的总市场支付之间的差额。\n3. 使用反需求函数和实际调度，计算每种设计下的总社会福利（消费者盈余减去发电成本）。通过计算节点边际电价下的社会福利与带重新调度的区域定价下的社会福利之差，来量化因增收费用和重新调度而产生的福利损失。\n\n将最终福利损失表示为以美元/小时（$）为单位的单个数字。使用精确计算；除非必要，否则不要四舍五入。您的最终数值答案必须是单个实数。",
            "solution": "根据问题陈述的要求，解答分为三个部分。\n\n### 第1部分：节点边际电价（LMP）\n\n目标是最大化社会盈余，即总消费者效益减去总发电成本。对于需求$q$和反需求函数$\\pi(q)$，消费者效益由积分$\\int_0^q \\pi(x) dx$给出。\n\n需要最大化的社会福利$SW$为：\n$$ SW = \\int_0^{q_1} \\pi_1(x) dx + \\int_0^{q_2} \\pi_2(x) dx - (c_1 g_1 + c_2 g_2) $$\n代入给定的反需求函数$\\pi_1(q_1) = 120 - 0.2 q_1$和$\\pi_2(q_2) = 160 - 0.4 q_2$，以及边际成本$c_1 = 40$和$c_2 = 100$：\n$$ SW(q_1, q_2, g_1, g_2) = (120 q_1 - 0.1 q_1^2) + (160 q_2 - 0.2 q_2^2) - (40 g_1 + 100 g_2) $$\n\n此最大化问题受以下约束条件的制约：\n1. 母线1的功率平衡：$g_1 = q_1 + f$ ($\\lambda_1$)\n2. 母线2的功率平衡：$g_2 + f = q_2$ ($\\lambda_2$)\n3. 输电容量：$0 \\leq f \\leq F^{\\max}$，其中 $F^{\\max} = 100$。\n\n我们将功率平衡约束代入社会福利函数，以自变量$q_1$、$q_2$和$f$来表示它：\n$$ SW(q_1, q_2, f) = (120 q_1 - 0.1 q_1^2) + (160 q_2 - 0.2 q_2^2) - 40(q_1 + f) - 100(q_2 - f) $$\n$$ SW(q_1, q_2, f) = (80 q_1 - 0.1 q_1^2) + (60 q_2 - 0.2 q_2^2) + 60 f $$\n该目标函数在$q_1$、$q_2$和$f$上是可分的。为了最大化$SW$，我们可以在约束条件下独立地最大化每一项。\n\n关于$f$的偏导数为$\\frac{\\partial SW}{\\partial f} = 60$。由于该值为正，通过使从母线$1$到母线$2$的潮流$f$尽可能大来最大化福利。给定约束$0 \\leq f \\leq 100$，最优潮流为$f^* = 100$ MW。\n\n对于$q_1$，我们将导数设为零以求最大值：\n$$ \\frac{\\partial SW}{\\partial q_1} = 80 - 0.2 q_1 = 0 \\implies q_1^* = \\frac{80}{0.2} = 400 \\text{ MW} $$\n对于$q_2$，我们做同样的操作：\n$$ \\frac{\\partial SW}{\\partial q_2} = 60 - 0.4 q_2 = 0 \\implies q_2^* = \\frac{60}{0.4} = 150 \\text{ MW} $$\n然后，通过$f^*=100$时的功率平衡方程确定发电机出力水平：\n$$ g_1^* = q_1^* + f^* = 400 + 100 = 500 \\text{ MW} $$\n$$ g_2^* = q_2^* - f^* = 150 - 100 = 50 \\text{ MW} $$\n节点边际电价（LMP）$\\lambda_1$和$\\lambda_2$是消费者在高效市场中在每个母线上看到的价格。它们等于最优消费量下的边际效益：\n$$ \\lambda_1 = \\pi_1(q_1^*) = 120 - 0.2(400) = 120 - 80 = 40 \\, \\text{\\$/MWh} $$\n$$ \\lambda_2 = \\pi_2(q_2^*) = 160 - 0.4(150) = 160 - 60 = 100 \\, \\text{\\$/MWh} $$\n这些价格与各母线可用的发电边际成本一致。在母线1，价格是发电机1的边际成本（$c_1=40$）。在母线2，由于来自母线1的更便宜的电力受到输电拥堵的限制，必须调度本地的发电机（发电机2，$c_2=100$）来满足需求。因此，母线2的价格反映了发电机2的边际成本。\n\n有效调度为$\\{q_1^{*}, q_2^{*}, g_1^{*}, g_2^{*}, f^{*}\\} = \\{400, 150, 500, 50, 100\\}$，单位为MW。节点电价为$\\lambda_1=40 \\, \\$/\\mathrm{MWh}$ 和 $\\lambda_2=100 \\, \\$/\\mathrm{MWh}$。\n\n### 第2部分：单一区域定价\n\n在此设计下，向所有消费者公布一个单一的区域价格$\\pi^Z$，该价格设定为最便宜发电机的边际成本，即$\\pi^Z = c_1 = 40 \\, \\$/\\mathrm{MWh}$。消费者通过使其边际效益等于此价格来计划其需求。\n\n母线1的计划需求：\n$$ \\pi_1(q_1^Z) = \\pi^Z \\implies 120 - 0.2 q_1^Z = 40 \\implies 0.2 q_1^Z = 80 \\implies q_1^Z = 400 \\text{ MW} $$\n母线2的计划需求：\n$$ \\pi_2(q_2^Z) = \\pi^Z \\implies 160 - 0.4 q_2^Z = 40 \\implies 0.4 q_2^Z = 120 \\implies q_2^Z = 300 \\text{ MW} $$\n现在，运营商必须以最低成本重新调度发电，以满足这些计划需求$\\{q_1^Z, q_2^Z\\} = \\{400, 300\\}$，同时遵守输电约束$0 \\leq f^Z \\leq 100$。需要最小化的成本是$C = 40 g_1^Z + 100 g_2^Z$。\n使用功率平衡方程$g_1^Z = 400 + f^Z$和$g_2^Z = 300 - f^Z$，我们将成本表示为潮流$f^Z$的函数：\n$$ C(f^Z) = 40(400 + f^Z) + 100(300 - f^Z) = 16000 + 40 f^Z + 30000 - 100 f^Z = 46000 - 60 f^Z $$\n为了最小化成本，$f^Z$必须最大化。因此，$f^Z = 100$ MW。\n重新调度的发电机出力水平为：\n$$ g_1^Z = 400 + 100 = 500 \\text{ MW} $$\n$$ g_2^Z = 300 - 100 = 200 \\text{ MW} $$\n总发电成本为：\n$$ TC^Z = 40 g_1^Z + 100 g_2^Z = 40(500) + 100(200) = 20000 + 20000 = 40000 \\, \\text{美元} $$\n以区域价格销售能源的总收入为：\n$$ TR^Z = \\pi^Z (q_1^Z + q_2^Z) = 40 (400 + 300) = 40(700) = 28000 \\, \\text{美元} $$\n增收费用是成本与收入之间的差额：\n$$ \\text{Uplift} = TC^Z - TR^Z = 40000 - 28000 = 12000 \\, \\text{美元} $$\n\n### 第3部分：福利损失\n\n我们计算每种设计下的总社会福利，并求其差值。\n\nLMP下的社会福利（$SW^*$）：\n$$ SW^* = \\left( \\int_0^{q_1^*} \\pi_1(q) dq + \\int_0^{q_2^*} \\pi_2(q) dq \\right) - (c_1 g_1^* + c_2 g_2^*) $$\n母线1的效益：$\\int_0^{400} (120 - 0.2q) dq = [120q - 0.1q^2]_0^{400} = 120(400) - 0.1(400^2) = 48000 - 16000 = 32000$ 美元。\n母线2的效益：$\\int_0^{150} (160 - 0.4q) dq = [160q - 0.2q^2]_0^{150} = 160(150) - 0.2(150^2) = 24000 - 4500 = 19500$ 美元。\n总效益：$32000 + 19500 = 51500$ 美元。\n总发电成本：$c_1 g_1^* + c_2 g_2^* = 40(500) + 100(50) = 20000 + 5000 = 25000$ 美元。\n$$ SW^* = 51500 - 25000 = 26500 \\, \\text{美元} $$\n\n区域定价下的社会福利（$SW^Z$）：\n实际调度为$\\{q_1^Z, q_2^Z, g_1^Z, g_2^Z\\} = \\{400, 300, 500, 200\\}$。\n$$ SW^Z = \\left( \\int_0^{q_1^Z} \\pi_1(q) dq + \\int_0^{q_2^Z} \\pi_2(q) dq \\right) - (c_1 g_1^Z + c_2 g_2^Z) $$\n母线1的效益：（同上）$32000$ 美元。\n母线2的效益：$\\int_0^{300} (160 - 0.4q) dq = [160q - 0.2q^2]_0^{300} = 160(300) - 0.2(300^2) = 48000 - 18000 = 30000$ 美元。\n总效益：$32000 + 30000 = 62000$ 美元。\n总发电成本：（在第2部分中计算）$40000$ 美元。\n$$ SW^Z = 62000 - 40000 = 22000 \\, \\text{美元} $$\n\n由区域定价方案导致的福利损失是LMP下的最优福利与区域定价下的福利之差。\n$$ \\text{Welfare Loss} = SW^* - SW^Z = 26500 - 22000 = 4500 \\, \\text{美元} $$\n这种损失的产生是因为母线2的消费者面临的价格（$40$）不能反映服务他们的真实边际成本（$100$），从而导致过度消费。在母线2产生额外需求（$150$ MW）的成本为$150 \\times 100 = 15000$ 美元，而这次额外消费带来的消费者效益为$\\int_{150}^{300} \\pi_2(q)dq = 10500$ 美元，导致的净损失为$15000 - 10500 = 4500$ 美元。",
            "answer": "$$\\boxed{4500}$$"
        },
        {
            "introduction": "现在，让我们挑战一个前沿且复杂的议题：负电价的形成。这个练习模拟了现代电力系统中常见的场景，即可再生能源补贴与输电阻塞并存。通过求解该系统中的安全约束经济调度（SCED）问题，您将发现经济激励（补贴）和物理约束（阻塞）如何相互作用，从而在局部地区产生负的LMP。这有助于您理解在管理局部发电过剩时，边际成本是如何体现为负值的。",
            "id": "4102273",
            "problem": "考虑一个在单周期安全约束经济调度（SCED）下运行的双母线直流（DC）潮流网络。母线$1$上设有一台风力发电机，其物理边际成本为零，发电补贴为每兆瓦时$s$美元。母线$2$上设有一台火力发电机，其恒定边际成本为每兆瓦时$c_t$美元。母线$1$上有固定负荷$d_1$，母线$2$上有固定负荷$d_2$。一条输电线路连接母线$1$和母线$2$，其潮流绝对值具有对称的热极限$F_{\\max}$。风力发电机是可削减的，其可用功率上限为$G_{\\max}$。出于本次调度的目的，火力发电机没有上限。假设损耗可忽略不计，且无功功率为零。设风电补贴在调度目标中作为风力发电的负成本项实施。\n\n使用以下数值指定且科学上现实的参数：\n- 母线$1$负荷 $d_1 = 0$ 兆瓦。\n- 母线$2$负荷 $d_2 = 100$ 兆瓦。\n- 风电可用功率 $G_{\\max} = 120$ 兆瓦。\n- 线路极限 $F_{\\max} = 60$ 兆瓦。\n- 火电边际成本 $c_t = 30$ 美元/兆瓦时。\n- 风电发电补贴 $s = 50$ 美元/兆瓦时。\n\n以风力发电量$g_w$、火力发电量$g_t$和线路潮流$f$为决策变量，根据直流节点功率平衡、发电机能力限制和线路热极限的第一性原理，建立母线功率平衡等式，从而构建SCED模型。以此优化模型为基础，推导其Karush-Kuhn-Tucker（KKT）最优性条件，识别与母线功率平衡等式相关的对偶变量，并将这些对偶变量解释为节点边际电价（LMP）。求解在输电约束生效和风电补贴经济上偏好风力发电（从而在不进行削减的情况下可能导致母线$1$出现局部过发电）所引起的拥塞情况下的最优调度和相应的LMP。\n\n计算母线$1$的节点边际电价（LMP）的数值，单位为美元/兆瓦时。以美元/兆瓦时表示最终价格，不进行四舍五入。",
            "solution": "安全约束经济调度（SCED）的目标是在满足物理和运行约束的条件下，最小化系统的总运行成本。\n\n**数学模型**\n\n**决策变量：**\n- $g_w$：母线$1$上风力机组的发电量（MW）。\n- $g_t$：母线$2$上火力机组的发电量（MW）。\n- $f$：从母线$1$到母线$2$的线路潮流（MW）。\n\n**目标函数：**\n目标是最小化总成本。风力发电的补贴被建模为负成本。\n$$\n\\min_{g_w, g_t, f} Z = c_t g_t - s g_w\n$$\n\n**约束条件：**\n1.  **母线功率平衡：** \n    - 母线$1$：$g_w - f - d_1 = 0 \\quad (\\lambda_1)$\n    - 母线$2$：$g_t + f - d_2 = 0 \\quad (\\lambda_2)$\n    其中 $\\lambda_1$ 和 $\\lambda_2$ 是与这些约束相关的对偶变量，代表节点边际电价 (LMP)。\n\n2.  **发电机能力限制：**\n    - 风电：$0 \\le g_w \\le G_{\\max}$\n    - 火电：$g_t \\ge 0$\n\n3.  **输电线路极限：**\n    - $-F_{\\max} \\le f \\le F_{\\max}$\n\n**Karush-Kuhn-Tucker（KKT）条件**\n\n拉格朗日函数 $L$ 为：\n$$\nL = (c_t g_t - s g_w) + \\lambda_1(d_1 + f - g_w) + \\lambda_2(d_2 - f - g_t) + \\mu_{w,\\max}(g_w - G_{\\max}) + \\mu_{w,\\min}(-g_w) + \\mu_{t,\\min}(-g_t) + \\mu_{f,\\max}(f - F_{\\max}) + \\mu_{f,\\text{rev}}(-f - F_{\\max})\n$$\n最优性的KKT条件包括：\n\n1. **平稳性（Stationarity）：**\n- $\\frac{\\partial L}{\\partial g_w} = -s - \\lambda_1 + \\mu_{w,\\max} - \\mu_{w,\\min} = 0 \\implies \\lambda_1 = -s + \\mu_{w,\\max} - \\mu_{w,\\min}$\n- $\\frac{\\partial L}{\\partial g_t} = c_t - \\lambda_2 - \\mu_{t,\\min} = 0 \\implies \\lambda_2 = c_t - \\mu_{t,\\min}$\n- $\\frac{\\partial L}{\\partial f} = \\lambda_1 - \\lambda_2 + \\mu_{f,\\max} - \\mu_{f,\\text{rev}} = 0$\n\n2. **原始可行性（Primal Feasibility）：** 所有约束必须被满足。\n\n3. **对偶可行性（Dual Feasibility）：** 所有不等式约束的乘子必须为非负。\n\n4. **互补松弛性（Complementary Slackness）：**\n- $\\mu_{w,\\max}(g_w - G_{\\max}) = 0$\n- $\\mu_{t,\\min}(-g_t) = 0$\n- $\\mu_{f,\\max}(f - F_{\\max}) = 0$\n- $\\mu_{f,\\text{rev}}(-f - F_{\\max}) = 0$\n\n**求解最优调度和LMP**\n\n代入数值：$d_1=0$, $d_2=100$, $G_{\\max}=120$, $F_{\\max}=60$, $c_t=30$, $s=50$。\n\n- 风力发电的经济成本为$-s = -50 \\, \\$/\\mathrm{MWh}$。\n- 火力发电的经济成本为$c_t = 30 \\, \\$/\\mathrm{MWh}$。\n\n系统将优先使用最便宜的资源，即风电。总负荷为$100$ MW，位于母线$2$。虽然有足够的可用风电（$120$ MW）来满足所有负荷，但电力必须通过输电线路传输，其容量为$F_{\\max} = 60$ MW。因此，线路将会发生拥塞。\n\n- 从母线$1$到母线$2$的潮流达到最大值：$f = F_{\\max} = 60$ MW。\n\n现在我们使用功率平衡方程来计算所需发电量：\n- 母线$1$：$g_w - f - d_1 = 0 \\implies g_w - 60 - 0 = 0 \\implies g_w = 60$ MW。\n- 母线$2$：$g_t + f - d_2 = 0 \\implies g_t + 60 - 100 = 0 \\implies g_t = 40$ MW。\n\n此调度是可行的：$0  g_w=60  G_{\\max}=120$；$g_t=40 > 0$；$f=60 = F_{\\max}$。\n\n现在我们利用这个最优调度，通过KKT条件来求解LMP。\n- 由于$0  g_w  G_{\\max}$，风电机的容量约束不是紧约束。根据互补松弛性，$\\mu_{w,\\min} = 0$ 且 $\\mu_{w,\\max} = 0$。\n- 由于$g_t > 0$，火电机组的最小出力约束不是紧约束。根据互补松弛性，$\\mu_{t,\\min} = 0$。\n\n现在我们可以使用平稳性条件来求解LMP。\n\n**母线1的LMP ($LMP_1 = \\lambda_1$)：**\n根据$g_w$的平稳性条件：\n$$\n\\lambda_1 = -s + \\mu_{w,\\max} - \\mu_{w,\\min}\n$$\n代入$\\mu_{w,\\max}=0$和$\\mu_{w,\\min}=0$：\n$$\n\\lambda_1 = -s = -50\n$$\n母线$1$的节点边际电价是$-50 \\, \\$/\\mathrm{MWh}$。这个结果在经济学上是直观的。在母线$1$，由于下游拥塞，存在过剩的、有补贴的可用风电正在被削减。为了在母线$1$供应额外1 MW的负荷，系统只需将风力发电增加1 MW（减少削减量）。这将使获得的总补贴增加$s = 50$美元，从而使系统总成本减少50美元。因此，在母线$1$供应负荷的边际成本是$-50 \\, \\$/\\mathrm{MWh}$。\n\n**母线2的LMP ($LMP_2 = \\lambda_2$)：**\n为了完整起见，我们来求母线$2$的LMP。根据$g_t$的平稳性条件：\n$$\n\\lambda_2 = c_t - \\mu_{t,\\min}\n$$\n由于$g_t = 40 > 0$，我们有$\\mu_{t,\\min}=0$。\n$$\n\\lambda_2 = c_t = 30\n$$\n母线$2$的LMP是$30 \\, \\$/\\mathrm{MWh}$。这是火力发电机的边际成本，由于输电线路已达到其极限，必须调度该发电机来满足母线$2$的任何增量负荷。价格差异$\\lambda_2 - \\lambda_1 = 30 - (-50) = 80 \\, \\$/\\mathrm{MWh}$是线路上的拥塞租金。\n\n问题明确要求计算母线$1$的LMP。\n最终值为$-50$。",
            "answer": "$$\\boxed{-50}$$"
        }
    ]
}