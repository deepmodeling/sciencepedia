{
    "hands_on_practices": [
        {
            "introduction": "在一个没有任何输电阻塞或损耗的理想电力网络中，经济效率原则决定了市场中只会存在一个统一的市场价格。本练习 () 将指导您从第一性原理出发，利用优化理论证明这一基本原则，然后将其应用于一个简单的数值算例。通过这个实践，您将巩固对无阻塞情况下位置边际电价（LMP）核心含义的理解。",
            "id": "4102233",
            "problem": "考虑一个在标准直流最优潮流 (DCOPF) 近似下建模的连通输电网络：电压幅值固定，忽略无功功率，有功功率潮流与母线电压相角呈线性关系。设网络中有 $n$ 个母线和 $m$ 条输电线路。定义支路-母线关联矩阵为 $K \\in \\mathbb{R}^{m \\times n}$，其方向任意；线路电纳对角矩阵为 $B_{\\ell} \\in \\mathbb{R}^{m \\times m}$，其对角线元素严格为正。那么，线路潮流向量满足 $f = B_{\\ell} K \\theta$，其中 $\\theta \\in \\mathbb{R}^{n}$ 是母线电压相角向量。节点功率平衡表示为\n$$\nd - p - K^{\\top} f = 0,\n$$\n其中 $d \\in \\mathbb{R}^{n}_{\\ge 0}$ 是负荷向量，$p \\in \\mathbb{R}^{n}_{\\ge 0}$ 是净注入功率向量。假设每个发电机 $i \\in \\{1,\\dots,n\\}$ 都有一个凸的、连续可微的成本函数 $C_{i}(p_{i})$ 和一个有限容量 $\\overline{p}_{i} > 0$。假设零损耗（即总发电量等于总负荷），并且所有输电约束都是非紧的（即热极限足够大，以至于在最优点没有线路达到其极限）。DCOPF 问题是在这些约束条件下最小化总发电成本。\n\n任务1：仅从上述 DCOPF 公式和约束凸优化的第一性原理出发，推导在何种条件下，节点边际电价 (LMPs)——定义为与节点功率平衡约束相关的影子价格——在连通网络中的所有母线上都相同，并等于一个单一标量 $\\lambda$。您的推导必须从无损耗、无拥塞的 DCOPF 的 Karush–Kuhn–Tucker (KKT) 条件出发。\n\n任务2：构建并求解以下小型数值示例，以计算统一 LMP 的值。考虑一个标记为母线 $1$、$2$ 和 $3$ 的3母线网络，通过线路 $(1,2)$、$(2,3)$ 和 $(1,3)$ 连接成三角形，其电纳分别为 $b_{12} = 5$、$b_{23} = 4$ 和 $b_{13} = 6$，且热极限设置得非常高，以至于没有线路约束是紧的。负荷仅位于母线 $2$，为 $d_{2} = 100$，而 $d_{1} = d_{3} = 0$。在母线 $1$ 和 $3$ 上有发电机，其成本函数为\n$$\nC_{1}(p_{1}) = 15\\,p_{1} + \\frac{1}{2}\\cdot 0.2\\,p_{1}^{2}, \\quad C_{3}(p_{3}) = 10\\,p_{3} + \\frac{1}{2}\\cdot 0.1\\,p_{3}^{2},\n$$\n容量为 $\\overline{p}_{1} = 120$ 和 $\\overline{p}_{3} = 120$。假设零损耗且无拥塞。求解最优调度 $(p_{1}^{\\star}, p_{3}^{\\star})$ 和相应的统一 LMP $\\lambda$。将您的最终 LMP 数值四舍五入到四位有效数字，并以美元/兆瓦时 ($\\$/\\text{MWh}$) 表示。",
            "solution": "按要求，分析分两部分进行。首先，我们从第一性原理推导统一节点边际电价 (LMP) 的一般条件。其次，我们应用这一理解来解决具体的数值示例。\n\n### 第1部分：统一LMP条件的推导\n\n直流最优潮流 (DCOPF) 问题旨在在物理和运行约束下最小化总发电成本。根据问题陈述，我们考虑一个无损耗和无拥塞的网络。\n\n决策变量是注入功率向量 $p \\in \\mathbb{R}^n$ 和母线电压相角向量 $\\theta \\in \\mathbb{R}^n$。目标是最小化总发电成本，即各个发电机成本函数的总和：\n$$\n\\min_{p, \\theta} \\sum_{i=1}^{n} C_{i}(p_{i})\n$$\n此最小化受以下几个约束条件的限制：\n\n1.  **节点功率平衡：** 在每个母线 $i$，注入的功率必须等于取出的功率。问题中给出此关系为 $d - p - K^{\\top} f = 0$。代入线路潮流方程 $f = B_{\\ell} K \\theta$，我们得到：\n    $$\n    d - p - K^{\\top} B_{\\ell} K \\theta = 0\n    $$\n    让我们定义母线导纳矩阵 $B_{bus} = K^{\\top} B_{\\ell} K$。则每个母线 $i$ 的节点功率平衡约束为：\n    $$\n    p_i - d_i + (B_{bus}\\theta)_i = 0 \\quad \\text{for } i \\in \\{1, \\dots, n\\}\n    $$\n    我们为这 $n$ 个等式约束中的每一个关联一个拉格朗日乘子 $\\lambda_i$。这些乘子的向量 $\\lambda = [\\lambda_1, \\dots, \\lambda_n]^{\\top}$ 代表节点边际电价。\n\n2.  **发电容量限制：** 每个发电机都有一个有限容量：\n    $$\n    0 \\le p_i \\le \\overline{p}_{i}\n    $$\n    我们为约束 $p_i \\ge 0$ (或 $-p_i \\le 0$) 关联拉格朗日乘子 $\\mu_i^{min} \\ge 0$，为约束 $p_i \\le \\overline{p}_{i}$ 关联拉格朗日乘子 $\\mu_i^{max} \\ge 0$。\n\n3.  **相角参考：** 为确保相角有唯一解，选择一个母线作为参考（或平衡）母线，并将其相角设为零。设母线 $k_{ref}$ 为参考母线：\n    $$\n    \\theta_{k_{ref}} = 0\n    $$\n\n该问题是一个凸优化问题，因此我们可以分析其 Karush–Kuhn–Tucker (KKT) 条件来找到最优解的性质。拉格朗日函数 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L}(p, \\theta, \\lambda, \\mu^{min}, \\mu^{max}) = \\sum_{i=1}^{n} C_{i}(p_{i}) - \\sum_{i=1}^{n} \\lambda_{i} \\left( p_{i} - d_{i} + (B_{bus}\\theta)_i \\right) - \\sum_{i=1}^{n} \\mu_{i}^{min} p_{i} + \\sum_{i=1}^{n} \\mu_{i}^{max} (p_{i} - \\overline{p}_{i})\n$$\n一阶 KKT 平稳性条件要求拉格朗日函数相对于原始变量（$p_i$ 和 $\\theta_i$）的梯度为零。\n\n**关于发电量 $p_i$ 的平稳性：**\n对于每个具有非零成本函数的发电机 $i$：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p_{i}} = \\frac{dC_{i}}{dp_{i}} - \\lambda_{i} - \\mu_{i}^{min} + \\mu_{i}^{max} = 0\n$$\n这得出了母线 $i$ 处 LMP 的基本关系：\n$$\n\\lambda_{i} = \\frac{dC_{i}}{dp_{i}} - \\mu_{i}^{min} + \\mu_{i}^{max}\n$$\n该方程表明，一个母线上的 LMP 等于该母线上发电机的边际成本，并由其容量限制的影子价格进行调整。如果发电机在其限制之间严格运行（$0  p_i  \\overline{p}_{i}$），那么根据互补松弛性，$\\mu_{i}^{min} = 0$ 和 $\\mu_{i}^{max} = 0$，因此 $\\lambda_{i} = \\frac{dC_{i}}{dp_{i}}$。\n\n**关于相角 $\\theta_k$ 的平稳性：**\n对于每个不是参考母线的母线 $k$ ($k \\ne k_{ref}$)，我们有：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\theta_{k}} = - \\sum_{i=1}^{n} \\lambda_{i} \\frac{\\partial}{\\partial \\theta_{k}} (B_{bus}\\theta)_i = 0\n$$\n项 $(B_{bus}\\theta)_i$ 是 $\\sum_{j=1}^{n} (B_{bus})_{ij} \\theta_j$。因此，它对 $\\theta_k$ 的偏导数是 $(B_{bus})_{ik}$。平稳性条件变为：\n$$\n- \\sum_{i=1}^{n} \\lambda_{i} (B_{bus})_{ik} = 0 \\quad \\text{for all } k \\ne k_{ref}\n$$\n用矩阵形式表示，这是向量积 $-B_{bus}^{\\top} \\lambda$ 的第 $k$ 个分量。由于 $B_{bus}$ 是对称的 ($B_{bus}^{\\top} = B_{bus}$)，这等价于对所有非参考母线有 $(B_{bus}\\lambda)_k = 0$。\n\n对于参考母线 $k_{ref}$，$B_{bus}$ 的所有行之和为零（即 $\\sum_i (B_{bus})_{ik} = 0$），这意味着如果 $(B_{bus}\\lambda)_k = 0$ 对所有 $k \\ne k_{ref}$ 成立，那么它对 $k=k_{ref}$ 也自动成立。因此，该条件对所有母线都成立：\n$$\nB_{bus} \\lambda = 0\n$$\n对于一个连通网络，母线导纳矩阵 $B_{bus}$ 是一个图拉普拉斯矩阵。其零空间是一维的，由全1向量 $\\mathbf{1} = [1, 1, \\dots, 1]^{\\top}$ 张成。因此，条件 $B_{bus} \\lambda = 0$ 意味着向量 $\\lambda$ 必须是这个零空间的元素。因此，$\\lambda$ 必须是向量 $\\mathbf{1}$ 的标量倍数：\n$$\n\\lambda = c \\cdot \\mathbf{1}\n$$\n对于某个标量 $c$。这等价于声明向量 $\\lambda$ 的所有分量都相同：\n$$\n\\lambda_1 = \\lambda_2 = \\dots = \\lambda_n = c\n$$\n推导至此完成。关键步骤依赖于关于相角的平稳性条件。该条件之所以呈现 $B_{bus}\\lambda=0$ 的形式，正是因为我们假设了一个无拥塞的网络。如果任何输电线路达到其极限，涉及线路潮流约束的拉格朗日乘子的额外项将出现在关于 $\\theta$ 的平稳性方程中，从而破坏简单的 $B_{bus}\\lambda=0$ 关系，并导致网络中出现不同的LMP。\n\n因此，在连通网络中所有母线的LMP都相同的条件是，不存在紧的输电约束（即无拥塞）。\n\n### 第2部分：数值示例\n\n该问题描述了一个无输电拥塞的3母线系统。根据第1部分的推导，我们预期会有一个单一、统一的LMP，我们将其记为 $\\lambda$。在无拥塞的情况下，要找到最优发电调度和全系统LMP，并不需要网络拓扑和线路电纳；网络的作用仅仅是将母线连接成一个单一价格区域。\n\n问题是最小化总成本：\n$$\nC(p_1, p_3) = C_{1}(p_{1}) + C_{3}(p_{3}) = \\left(15p_{1} + 0.1p_{1}^{2}\\right) + \\left(10p_{3} + 0.05p_{3}^{2}\\right)\n$$\n约束条件是满足总需求。总需求为 $D_{total} = d_1 + d_2 + d_3 = 0 + 100 + 0 = 100$。在零损耗的情况下，总发电量必须等于总需求：\n$$\np_1 + p_3 = 100\n$$\n发电限制为 $0 \\le p_1 \\le 120$ 和 $0 \\le p_3 \\le 120$。\n\n在最优、无拥塞的调度中，所有在线发电机的边际成本都等于系统LMP，前提是它们在各自的容量限制内运行。让我们计算边际成本函数：\n$$\n\\frac{dC_1}{dp_1} = 15 + 0.2p_1\n$$\n$$\n\\frac{dC_3}{dp_3} = 10 + 0.1p_3\n$$\n我们将边际成本设为等于统一的LMP $\\lambda$：\n$$\n15 + 0.2p_1 = \\lambda \\quad (1)\n$$\n$$\n10 + 0.1p_3 = \\lambda \\quad (2)\n$$\n我们可以用 $\\lambda$ 来表示 $p_1$ 和 $p_3$：\n$$\np_1 = \\frac{\\lambda - 15}{0.2} = 5(\\lambda - 15)\n$$\n$$\np_3 = \\frac{\\lambda - 10}{0.1} = 10(\\lambda - 10)\n$$\n现在，我们使用功率平衡方程 $p_1 + p_3 = 100$：\n$$\n5(\\lambda - 15) + 10(\\lambda - 10) = 100\n$$\n$$\n5\\lambda - 75 + 10\\lambda - 100 = 100\n$$\n$$\n15\\lambda - 175 = 100\n$$\n$$\n15\\lambda = 275\n$$\n$$\n\\lambda = \\frac{275}{15} = \\frac{55}{3}\n$$\n统一LMP为 $\\lambda = \\frac{55}{3} \\approx 18.333\\dots$ $\\$ /\\text{MWh}$。\n\n我们现在可以找到最优调度 $(p_1^\\star, p_3^\\star)$：\n$$\np_1^\\star = 5\\left(\\frac{55}{3} - 15\\right) = 5\\left(\\frac{55 - 45}{3}\\right) = 5\\left(\\frac{10}{3}\\right) = \\frac{50}{3}\n$$\n$$\np_3^\\star = 10\\left(\\frac{55}{3} - 10\\right) = 10\\left(\\frac{55 - 30}{3}\\right) = 10\\left(\\frac{25}{3}\\right) = \\frac{250}{3}\n$$\n最优调度为 $p_1^\\star \\approx 16.67$ MW 和 $p_3^\\star \\approx 83.33$ MW。\n我们检查这些值是否在发电机容量限制内：\n$0  \\frac{50}{3}  120$ 并且 $0  \\frac{250}{3}  120$。两个条件都满足。因此，我们关于发电机未达到其极限的假设是正确的，并且边际成本确实相等。\n\n最后一步是将LMP的值四舍五入到四位有效数字。\n$$\n\\lambda = \\frac{55}{3} \\approx 18.3333\\dots\n$$\n四舍五入到四位有效数字得到 $18.33$。\n统一LMP为 $18.33$ $\\$/\\text{MWh}$。",
            "answer": "$$\\boxed{18.33}$$"
        },
        {
            "introduction": "接下来，让我们探讨当理想条件不满足时会发生什么。本练习 () 引入了输电阻塞和生产补贴等经济激励因素，这些在当今富含可再生能源的电网中十分常见。您将计算这些因素如何导致不同地点之间的价格分离，甚至产生反直觉的负电价，从而展示LMP作为一种强大的信号，如何揭示局部供应过剩的情况。",
            "id": "4102273",
            "problem": "考虑一个在单周期安全约束经济调度（SCED）下运行的双母线直流（DC）潮流网络。母线 $1$ 设有一台物理边际成本为零、发电补贴为每兆瓦时 $s$ 美元的风力发电机，母线 $2$ 设有一台恒定边际成本为每兆瓦时 $c_t$ 美元的热力发电机。母线 $1$ 有固定需求 $d_1$，母线 $2$ 有固定需求 $d_2$。一条输电线路连接母线 $1$ 和母线 $2$，其潮流绝对值具有对称的热限制 $F_{\\max}$。风力发电机是可弃的，其可用功率上限为 $G_{\\max}$，而就本次调度而言，热力发电机没有上限。假设损耗可忽略不计，且无无功功率。设风电补贴在调度目标中作为风力发电的负成本项实施。\n\n使用以下数值指定且科学上现实的参数：\n- 母线 $1$ 需求 $d_1 = 0$ 兆瓦。\n- 母线 $2$ 需求 $d_2 = 100$ 兆瓦。\n- 风电可用功率 $G_{\\max} = 120$ 兆瓦。\n- 线路限制 $F_{\\max} = 60$ 兆瓦。\n- 热电边际成本 $c_t = 30$ 美元/兆瓦时。\n- 风电发电补贴 $s = 50$ 美元/兆瓦时。\n\n使用风力发电量 $g_w$、热力发电量 $g_t$ 和线路潮流 $f$ 作为决策变量，根据直流节点功率平衡、发电机能力限制和线路热限制的第一性原理，构建母线功率平衡等式，从而建立SCED模型。以此优化模型为基础，推导Karush-Kuhn-Tucker (KKT) 最优性条件，识别与母线功率平衡等式相关的对偶变量，并将这些对偶变量解释为节点边际电价 (LMPs)。求解在阻塞情况下的最优调度和相应的LMP。阻塞的产生是由于输电约束成为紧约束，并且风电补贴在经济上有利于风力发电，从而在不进行弃风的情况下，在母线 $1$ 产生了局部过发电的可能。\n\n计算母线 $1$ 的节点边际电价 (LMP) 的数值，单位为美元/兆瓦时。以美元/兆瓦时为单位表示最终价格，不进行四舍五入。",
            "solution": "用户希望求解给定双母线电力系统中母线 $1$ 的节点边际电价 (LMP)。\n\n### 步骤 1：问题验证\n\n**1. 提取给定条件：**\n- 网络：双母线直流 (DC) 潮流网络。\n- 母线 $1$：设有一台可弃风力发电机和固定需求 $d_1$。\n- 母线 $2$：设有一台热力发电机和固定需求 $d_2$。\n- 风力发电机：物理边际成本为 $0$，发电补贴为 $s$，可用功率为 $G_{\\max}$。\n- 热力发电机：恒定边际成本为 $c_t$，无发电上限。\n- 输电：一条线路连接母线 $1$ 和母线 $2$，具有对称的热限制 $F_{\\max}$。\n\n- 数值参数：\n  - 母线 $1$ 需求：$d_1 = 0$ 兆瓦 (MW)。\n  - 母线 $2$ 需求：$d_2 = 100$ MW。\n  - 风电可用功率：$G_{\\max} = 120$ MW。\n  - 线路限制：$F_{\\max} = 60$ MW。\n  - 热电边际成本：$c_t = 30$ 美元/兆瓦时 ($\\$/MWh$)。\n  - 风电发电补贴：$s = 50 \\$/MWh$。\n\n**2. 使用提取的给定条件进行验证：**\n- **科学依据：**该问题描述了一个安全约束经济调度 (SCED)，这是电力系统工程和电力市场设计中的一个基本且标准的优化问题。直流潮流模型是输电网络分析中广泛使用的有效简化方法。\n- **良态问题：**该问题是一个具有凸可行集和线性目标函数的线性规划问题。它具有所有必要的数据，定义明确，其结构保证了唯一、稳定且有意义的解。\n- **目标：**问题陈述使用了电力系统经济学领域的精确、标准术语，没有主观或含糊不清的语言。\n\n**3. 结论与行动：**\n该问题被判定为**有效**。这是电力市场出清和价格形成方面的一个标准教科书练习。我将继续进行求解。\n\n### 步骤 2：数学建模\n\nSCED 的目标是在满足物理和运行约束的前提下，最小化系统的总运行成本。\n\n**决策变量：**\n- $g_w$：母线 $1$ 处风力机组的发电量 (MW)。\n- $g_t$：母线 $2$ 处火力机组的发电量 (MW)。\n- $f$：从母线 $1$ 到母线 $2$ 的线路上潮流 (MW)。\n\n**目标函数：**\n目标是最小化总成本。风力发电的补贴被建模为负成本。\n$$\n\\min_{g_w, g_t, f} Z = c_t g_t - s g_w\n$$\n\n**约束条件：**\n1.  **母线功率平衡：**每个母线注入的净功率必须为零。设 $\\lambda_1$ 和 $\\lambda_2$ 是与这些约束相关的对偶变量（拉格朗日乘子）。这些对偶变量代表LMP。\n    - 母线 $1$：$g_w - f - d_1 = 0 \\quad (\\lambda_1)$\n    - 母线 $2$：$g_t + f - d_2 = 0 \\quad (\\lambda_2)$\n\n2.  **发电机能力限制：**发电量必须在其物理限制范围内。\n    - 风电（可弃）：$0 \\le g_w \\le G_{\\max}$\n    - 火电：$g_t \\ge 0$\n\n3.  **输电线路限制：**潮流的绝对值不得超过热限制。\n    - $-F_{\\max} \\le f \\le F_{\\max}$\n\n### 步骤 3：Karush-Kuhn-Tucker (KKT) 条件\n\n为了解决这个问题并找到LMP，我们构建拉格朗日函数 $L$。我们将不等式约束表述为小于等于零的形式。\n\n$L(g_w, g_t, f, \\lambda, \\mu) = (c_t g_t - s g_w) + \\lambda_1(g_w - f - d_1) + \\lambda_2(g_t + f - d_2) + \\mu_{w,\\max}(g_w - G_{\\max}) + \\mu_{w,\\min}(-g_w) + \\mu_{t,\\min}(-g_t) + \\mu_{f,\\max}(f - F_{\\max}) + \\mu_{f,\\neg\\max}(-f - F_{\\max})$\n\n最优性的 KKT 条件是：\n\n**1. 驻点条件 (Stationarity)：**\n- $\\frac{\\partial L}{\\partial g_w} = -s + \\lambda_1 + \\mu_{w,\\max} - \\mu_{w,\\min} = 0 \\implies \\lambda_1 = s - \\mu_{w,\\max} + \\mu_{w,\\min}$\n- $\\frac{\\partial L}{\\partial g_t} = c_t + \\lambda_2 - \\mu_{t,\\min} = 0 \\implies \\lambda_2 = -c_t + \\mu_{t,\\min}$\n- $\\frac{\\partial L}{\\partial f} = -\\lambda_1 + \\lambda_2 + \\mu_{f,\\max} - \\mu_{f,\\neg\\max} = 0 \\implies \\lambda_1 - \\lambda_2 = \\mu_{f,\\max} - \\mu_{f,\\neg\\max}$\n\n在这个标准模型中，一个母线的LMP是其功率平衡方程的对偶变量的值。因此，$LMP_1 = \\lambda_1$ 且 $LMP_2 = \\lambda_2$。\n\n**2. 原始可行性 (Primal Feasibility)：**所有约束都必须满足。\n\n**3. 对偶可行性 (Dual Feasibility)：**不等式约束的乘子必须为非负值 ($\\mu \\ge 0$)。\n\n**4. 互补松弛性 (Complementary Slackness)：**不等式约束的乘子与其松弛量的乘积必须为零。\n- $\\mu_{w,\\max}(g_w - G_{\\max}) = 0$\n- $\\mu_{w,\\min}(-g_w) = 0$\n- $\\mu_{t,\\min}(-g_t) = 0$\n- $\\mu_{f,\\max}(f - F_{\\max}) = 0$\n- $\\mu_{f,\\neg\\max}(-f - F_{\\max}) = 0$\n\n### 步骤 4：求解最优调度和LMP\n\n让我们代入给定的数值：$d_1=0$, $d_2=100$, $G_{\\max}=120$, $F_{\\max}=60$, $c_t=30$, $s=50$。\n\n- 风力发电的经济成本实际上是 $-s = -50 \\$/MWh$。\n- 热力发电的经济成本是 $c_t = 30 \\$/MWh$。\n\n系统将优先使用最便宜的资源，即风电。总需求为 $d_1 + d_2 = 0 + 100 = 100$ MW。虽然有足够的风电可用（$G_{\\max} = 120$ MW）来满足所有需求，但风电位于母线 $1$，而需求位于母线 $2$。电力必须通过输电线路传输，其容量为 $F_{\\max} = 60$ MW。\n\n因此，系统将调度尽可能多的风电来服务母线 $2$ 的负荷，直到达到输电上限。线路将会发生阻塞。\n- 从母线 $1$ 到母线 $2$ 的潮流达到最大值：$f = F_{\\max} = 60$ MW。\n\n现在我们使用功率平衡方程来求解所需的发电量：\n- 母线 $1$：$g_w - f - d_1 = 0 \\implies g_w - 60 - 0 = 0 \\implies g_w = 60$ MW。\n- 母线 $2$：$g_t + f - d_2 = 0 \\implies g_t + 60 - 100 = 0 \\implies g_t = 40$ MW。\n\n此调度是可行的：\n- 风力发电：$0 \\le g_w=60 \\le G_{\\max}=120$。风电机组被弃风。\n- 热力发电：$g_t=40 \\ge 0$。\n- 线路潮流：$f=60$，满足限制 $|f| \\le F_{\\max}=60$。\n\n现在我们使用这个最优调度通过 KKT 条件来求解LMP。\n\n- 由于 $0  g_w  G_{\\max}$，约束 $g_w \\ge 0$ 和 $g_w \\le G_{\\max}$ 不是紧约束。根据互补松弛性，它们的对偶变量为零：$\\mu_{w,\\min} = 0$ 且 $\\mu_{w,\\max} = 0$。\n- 由于 $g_t > 0$，约束 $g_t \\ge 0$ 不是紧约束。根据互补松弛性，$\\mu_{t,\\min} = 0$。\n\n我们现在可以使用驻点条件来求解LMP。\n\n**母线 1 的 LMP ($LMP_1$)：**\n使用一种标准的KKT公式约定，即(边际成本) - (LMP) + ... = 0。\n$g_w$ 的边际成本是 $-s$。其驻点条件为：\n$$\n-s - \\lambda_1 + \\mu_{w,\\max} - \\mu_{w,\\min} = 0\n$$\n求解 $\\lambda_1$：\n$$\n\\lambda_1 = -s + \\mu_{w,\\max} - \\mu_{w,\\min}\n$$\n在最优调度 $g_w=60$ 下，我们发现 $\\mu_{w,\\max}=0$ 且 $\\mu_{w,\\min}=0$。\n$$\n\\lambda_1 = -s + 0 - 0 = -s\n$$\n代入值 $s = 50$：\n$$\n\\lambda_1 = -50\n$$\n母线 $1$ 的节点边际电价是 $-50 \\$/MWh$。\n\n这个结果在经济上是直观的。在母线 $1$，由于下游阻塞，存在过剩的、有补贴的可用风电正在被弃用。为了在母线 $1$ 供应额外 1 MW 的负荷，系统只需将风力发电量增加 1 MW（减少弃风量）。这将使收到的总补贴增加 $s = 50$，从而使系统总成本降低 $50$。因此，在母线 $1$ 供应负荷的边际成本是 $-50 \\$/MWh$。\n\n为了完整起见，让我们求解母线 $2$ 的LMP。\n$g_t$ 的驻点条件：(成本) - (LMP) + ... = 0\n$$\nc_t - \\lambda_2 - \\mu_{t,\\min} = 0\n$$\n由于 $g_t = 40 > 0$，我们有 $\\mu_{t,\\min}=0$。\n$$\n\\lambda_2 = c_t = 30\n$$\n母线 $2$ 的LMP是 $30 \\$/MWh$。这是热力发电机的边际成本，由于输电线路已达到其极限，必须调度该发电机以满足母线 $2$ 的任何增量负荷。价格差异 $\\lambda_2 - \\lambda_1 = 30 - (-50) = 80 \\$/MWh$ 是线路上的阻塞租金。\n\n问题具体要求的是母线 $1$ 的LMP。\n最终值为 $-50$。",
            "answer": "$$\\boxed{-50}$$"
        },
        {
            "introduction": "从电价形成转向市场结算，最后一个练习 () 将探讨一个关键的现实世界挑战：如何确保发电机能够收回其全部成本。真实的发电机除了边际燃料成本外，还有显著的非凸成本，如启动成本和空载成本。在本练习中，您将计算当一个发电机基于LMP的能量销售收入不足以覆盖其总成本时，所需的“增补”支付（uplift payment），从而揭示在纯LMP框架之外，补充性的市场机制是如何运作的。",
            "id": "4102238",
            "problem": "一台火力发电机在一个由独立系统运营商 (ISO) 管理的日前纯能量市场中进行调度。价格由节点边际电价 (LMP) 决定，LMP 定义为 ISO 集中式机组组合和经济调度中节点能量平衡约束的影子价格。由于启动成本和空载成本，该发电机的生产成本呈现非凸性。ISO 仅按 LMP 结算能量；任何未收回的成本必须通过增补支付（一种补偿支付）来弥补。\n\n该发电机的物理限制为最小出力 $P_{\\min} = 50~\\mathrm{MW}$ 和最大出力 $P_{\\max} = 200~\\mathrm{MW}$。发电机的报价曲线是关于出力 $p$（单位为 $\\mathrm{MW}$）的分段常数边际成本，以美元/兆瓦时 (USD/MWh) 表示：\n- 对于 $0 \\leq p \\leq 80$：边际成本 $= 18~\\mathrm{USD/MWh}$。\n- 对于 $80  p \\leq 140$：边际成本 $= 25~\\mathrm{USD/MWh}$。\n- 对于 $140  p \\leq 200$：边际成本 $= 40~\\mathrm{USD/MWh}$。\n\n发电机每次启动时产生 $C_{\\mathrm{SU}} = 12{,}000~\\mathrm{USD}$ 的启动成本，并在其投入运行（开机）的每个小时产生 $C_{\\mathrm{NL}} = 2{,}000~\\mathrm{USD}$ 的空载成本。每个小时是一个一小时的时间间隔。\n\n在一个 $8$ 小时的日前调度周期内，发电机的启停和调度计划如下：\n- 小时 $h = 1, 2, 3$：停机，$p_h = 0$。\n- 小时 $h = 4$：开机，$p_4 = 60~\\mathrm{MW}$。\n- 小时 $h = 5$：开机，$p_5 = 120~\\mathrm{MW}$。\n- 小时 $h = 6$：开机，$p_6 = 160~\\mathrm{MW}$。\n- 小时 $h = 7$：开机，$p_7 = 100~\\mathrm{MW}$。\n- 小时 $h = 8$：开机，$p_8 = 70~\\mathrm{MW}$。\n\n在小时 $h=4$ 机组启动时，有一次启动事件。没有停机成本。\n\n该发电机节点的节点边际电价 (LMP) 以 USD/MWh 计为：\n- $\\lambda_4 = 15$, $\\lambda_5 = 24$, $\\lambda_6 = 33$, $\\lambda_7 = 28$, $\\lambda_8 = 21$。\n\n假设结算仅支付基于 LMP 的能量收益，增补支付被定义为：当根据其报价的生产成本（包括启动和空载成本）评估时，能够使发电机在给定调度计划上恰好达到盈亏平衡的非负支付。计算 $8$ 小时调度周期内的总增补支付。以美元 (USD) 表示最终的增补支付。无需四舍五入；给出精确值。",
            "solution": "目标是计算在 $8$ 小时调度周期内，为使火力发电机达到盈亏平衡所需的总增补支付。增补支付是弥补发电机因参与市场而产生的任何净亏损的非负支付。发电机的利润 $\\Pi$（不含增补支付）是总收入减去总成本。增补支付 $U$ 定义为：\n$$ U = \\max(0, C_{\\text{total}} - R_{\\text{total}}) $$\n其中 $R_{\\text{total}}$ 是来自能量市场的总收入，$C_{\\text{total}}$ 是按报价的总生产成本。\n\n我们将分别计算这 $8$ 小时期间的总收入和总成本。每个小时是一个一小时的时间间隔，因此每步的时间长度为 $\\Delta t = 1~\\mathrm{h}$。\n\n**1. 总收入 ($R_{\\text{total}}$) 的计算**\n\n发电机仅在被调度的时段获得收入，即小时 $h=4, 5, 6, 7, 8$。每个小时的收入是该小时的调度电量与该小时的节点边际电价 (LMP) 的乘积。\n总收入是每小时收入的总和：\n$$ R_{\\text{total}} = \\sum_{h=4}^{8} \\lambda_h \\cdot p_h \\cdot \\Delta t $$\n由于 $\\Delta t = 1~\\mathrm{h}$，公式简化为 $R_{\\text{total}} = \\sum_{h=4}^{8} \\lambda_h p_h$。\n\n我们来计算每个小时的收入：\n- 小时 $h=4$：$R_4 = \\lambda_4 \\cdot p_4 = 15~\\mathrm{USD/MWh} \\cdot 60~\\mathrm{MW} \\cdot 1~\\mathrm{h} = 900~\\mathrm{USD}$。\n- 小时 $h=5$：$R_5 = \\lambda_5 \\cdot p_5 = 24~\\mathrm{USD/MWh} \\cdot 120~\\mathrm{MW} \\cdot 1~\\mathrm{h} = 2880~\\mathrm{USD}$。\n- 小时 $h=6$：$R_6 = \\lambda_6 \\cdot p_6 = 33~\\mathrm{USD/MWh} \\cdot 160~\\mathrm{MW} \\cdot 1~\\mathrm{h} = 5280~\\mathrm{USD}$。\n- 小时 $h=7$：$R_7 = \\lambda_7 \\cdot p_7 = 28~\\mathrm{USD/MWh} \\cdot 100~\\mathrm{MW} \\cdot 1~\\mathrm{h} = 2800~\\mathrm{USD}$。\n- 小时 $h=8$：$R_8 = \\lambda_8 \\cdot p_8 = 21~\\mathrm{USD/MWh} \\cdot 70~\\mathrm{MW} \\cdot 1~\\mathrm{h} = 1470~\\mathrm{USD}$。\n\n总收入是这些小时收入的总和：\n$$ R_{\\text{total}} = 900 + 2880 + 5280 + 2800 + 1470 = 13330~\\mathrm{USD} $$\n\n**2. 总成本 ($C_{\\text{total}}$) 的计算**\n\n总生产成本是整个调度周期内的启动成本、空载成本和可变能量成本的总和。\n$$ C_{\\text{total}} = C_{\\text{SU, total}} + C_{\\text{NL, total}} + C_{\\text{Var, total}} $$\n\n**a. 总启动成本 ($C_{\\text{SU, total}}$)**\n发电机在小时 $h=4$ 启动，构成一次启动事件。给定的启动成本为 $C_{\\mathrm{SU}} = 12000~\\mathrm{USD}$。\n$$ C_{\\text{SU, total}} = 1 \\cdot C_{\\mathrm{SU}} = 12000~\\mathrm{USD} $$\n\n**b. 总空载成本 ($C_{\\text{NL, total}}$)**\n空载成本在发电机投入运行（开机）的每个小时都会产生。发电机开机 $5$ 个小时（从 $h=4$ 到 $h=8$）。空载成本为每小时 $C_{\\mathrm{NL}} = 2000~\\mathrm{USD}$。\n$$ C_{\\text{NL, total}} = 5~\\text{hours} \\cdot C_{\\mathrm{NL}} = 5 \\cdot 2000 = 10000~\\mathrm{USD} $$\n\n**c. 总可变成本 ($C_{\\text{Var, total}}$)**\n可变成本根据分段常数边际成本报价曲线计算。设 $C^{\\text{Var}}(p)$ 为出力水平 $p$（单位为 MW）的可变成本率（单位为 USD/h）。这是边际成本曲线的积分。\n边际成本分段如下：\n- 第一段：从 $0$ 到 $80~\\mathrm{MW}$，成本为 $18~\\mathrm{USD/MWh}$。\n- 第二段：从 $80$ 到 $140~\\mathrm{MW}$，成本为 $25~\\mathrm{USD/MWh}$。\n- 第三段：从 $140$ 到 $200~\\mathrm{MW}$，成本为 $40~\\mathrm{USD/MWh}$。\n\n我们计算发电机开机期间每个小时的可变成本：\n- 小时 $h=4$，$p_4 = 60~\\mathrm{MW}$：\n  出力完全在第一段内。\n  $C^{\\text{Var}}_4 = 60~\\mathrm{MW} \\cdot 18~\\mathrm{USD/MWh} = 1080~\\mathrm{USD/h}$。\n- 小时 $h=5$，$p_5 = 120~\\mathrm{MW}$：\n  出力填满第一段并进入第二段。\n  $C^{\\text{Var}}_5 = (80~\\mathrm{MW} \\cdot 18~\\mathrm{USD/MWh}) + ((120 - 80)~\\mathrm{MW} \\cdot 25~\\mathrm{USD/MWh}) = 1440 + (40 \\cdot 25) = 1440 + 1000 = 2440~\\mathrm{USD/h}$。\n- 小时 $h=6$，$p_6 = 160~\\mathrm{MW}$：\n  出力填满第一段和第二段，并进入第三段。\n  $C^{\\text{Var}}_6 = (80~\\mathrm{MW} \\cdot 18~\\mathrm{USD/MWh}) + ((140 - 80)~\\mathrm{MW} \\cdot 25~\\mathrm{USD/MWh}) + ((160 - 140)~\\mathrm{MW} \\cdot 40~\\mathrm{USD/MWh})$\n  $C^{\\text{Var}}_6 = 1440 + (60 \\cdot 25) + (20 \\cdot 40) = 1440 + 1500 + 800 = 3740~\\mathrm{USD/h}$。\n- 小时 $h=7$，$p_7 = 100~\\mathrm{MW}$：\n  出力填满第一段并进入第二段。\n  $C^{\\text{Var}}_7 = (80~\\mathrm{MW} \\cdot 18~\\mathrm{USD/MWh}) + ((100 - 80)~\\mathrm{MW} \\cdot 25~\\mathrm{USD/MWh}) = 1440 + (20 \\cdot 25) = 1440 + 500 = 1940~\\mathrm{USD/h}$。\n- 小时 $h=8$，$p_8 = 70~\\mathrm{MW}$：\n  出力完全在第一段内。\n  $C^{\\text{Var}}_8 = 70~\\mathrm{MW} \\cdot 18~\\mathrm{USD/MWh} = 1260~\\mathrm{USD/h}$。\n\n由于 $\\Delta t = 1~\\mathrm{h}$，总可变成本是这些小时成本的总和：\n$$ C_{\\text{Var, total}} = 1080 + 2440 + 3740 + 1940 + 1260 = 10460~\\mathrm{USD} $$\n\n现在，对总成本进行最终求和：\n$$ C_{\\text{total}} = C_{\\text{SU, total}} + C_{\\text{NL, total}} + C_{\\text{Var, total}} = 12000 + 10000 + 10460 = 32460~\\mathrm{USD} $$\n\n**3. 增补支付 ($U$) 的计算**\n\n仅来自能量市场的利润为：\n$$ \\Pi_{\\text{market}} = R_{\\text{total}} - C_{\\text{total}} = 13330 - 32460 = -19130~\\mathrm{USD} $$\n由于发电机产生亏损，需要一笔增补支付来使其收支平衡。增补支付即为该亏损的数额。\n$$ U = C_{\\text{total}} - R_{\\text{total}} = 32460 - 13330 = 19130~\\mathrm{USD} $$\n该值为正，因此 $U = \\max(0, 19130) = 19130$。\n\n在 $8$ 小时调度周期内的总增补支付为 $19130~\\mathrm{USD}$。",
            "answer": "$$\\boxed{19130}$$"
        }
    ]
}