{
    "hands_on_practices": [
        {
            "introduction": "All power system analysis begins with a mathematical representation of the physical network. This exercise grounds your understanding in first principles by using Kirchhoff's Current Law (KCL) to systematically construct the nodal admittance matrix, or Y-bus. Mastering the assembly of the Y-bus from individual component data is a foundational skill, as this matrix is the cornerstone of power flow, fault analysis, and stability studies. ",
            "id": "4107717",
            "problem": "Consider a $3$-bus Alternating Current (AC) transmission network in steady state, where each line is represented by a $\\pi$-equivalent. Starting directly from Kirchhoff's Current Law (KCL), assemble the nodal admittance matrix (Y-bus) by enforcing nodal current balance at each bus. Each transmission line between buses $m$ and $n$ has a series admittance $y_{mn}$ placed in the series branch and a total shunt susceptance $B^{\\mathrm{sh}}_{mn}$ split equally so that a shunt admittance of $\\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{mn}}{2}$ is connected to ground at each terminal bus of the line. In addition, each bus $m$ may have a grounded shunt admittance $y^{\\mathrm{bus}}_{m}$ connected directly to it. All admittances are given in per unit (pu) on a common base.\n\nThe network data are:\n- Line $\\{1,2\\}$: series admittance $y_{12} = 0.10 - \\mathrm{j}\\,0.50$, total shunt susceptance $B^{\\mathrm{sh}}_{12} = 0.20$.\n- Line $\\{2,3\\}$: series admittance $y_{23} = 0.08 - \\mathrm{j}\\,0.40$, total shunt susceptance $B^{\\mathrm{sh}}_{23} = 0.16$.\n- Line $\\{1,3\\}$: series admittance $y_{13} = 0.06 - \\mathrm{j}\\,0.30$, total shunt susceptance $B^{\\mathrm{sh}}_{13} = 0.12$.\n- Bus shunts: $y^{\\mathrm{bus}}_{1} = \\mathrm{j}\\,0.02$, $y^{\\mathrm{bus}}_{2} = \\mathrm{j}\\,0.01$, $y^{\\mathrm{bus}}_{3} = \\mathrm{j}\\,0.00$.\n\nUnder these assumptions, construct the complete Y-bus matrix by deriving the off-diagonal and diagonal entries from KCL and the $\\pi$-equivalent model. Then, to provide a single scalar quantity, report the magnitude $|Y_{12}|$ of the off-diagonal admittance between buses $1$ and $2$.\n\nRound your final reported magnitude to four significant figures and express it in per unit (pu).",
            "solution": "The foundational starting point is Kirchhoff's Current Law (KCL), which states that the algebraic sum of currents leaving any node equals zero. In AC steady state, with sinusoidal phasors, KCL at bus $m$ can be written in terms of bus voltages and admittances as a linear relationship\n$$\nI_{m} = \\sum_{n \\in \\mathcal{N}} Y_{mn} V_{n},\n$$\nwhere $I_{m}$ is the net current injection at bus $m$, $V_{n}$ is the voltage at bus $n$, and $Y_{mn}$ are the entries of the nodal admittance matrix (Y-bus). Our task is to assemble $Y_{mn}$ from the network elements.\n\nFor a line between buses $m$ and $n$ modeled by a $\\pi$-equivalent, the series branch admittance is $y_{mn}$, and the shunt branch at each end is $\\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{mn}}{2}$. The current on the series branch from bus $m$ to bus $n$ is $y_{mn}\\,(V_{m} - V_{n})$. The shunt current from bus $m$ to ground contributed by this line is $\\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{mn}}{2}\\,V_{m}$. If additional grounded shunt admittance $y^{\\mathrm{bus}}_{m}$ exists at bus $m$, its current is $y^{\\mathrm{bus}}_{m}\\,V_{m}$.\n\nApplying KCL at bus $m$, summing all currents leaving the node through series branches and shunts, and equating to the net injection gives\n$$\nI_{m} = \\sum_{n \\in \\mathcal{N}_{m}} y_{mn}\\,(V_{m} - V_{n}) \\;+\\; \\sum_{n \\in \\mathcal{N}_{m}} \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{mn}}{2}\\,V_{m} \\;+\\; y^{\\mathrm{bus}}_{m} V_{m},\n$$\nwhere $\\mathcal{N}_{m}$ is the set of buses connected to $m$. Regrouping terms by bus voltages yields the Y-bus structure:\n- Off-diagonal entries for $m \\neq n$: \n$$\nY_{mn} = -y_{mn}.\n$$\n- Diagonal entries:\n$$\nY_{mm} = \\sum_{n \\in \\mathcal{N}_{m}} y_{mn} \\;+\\; \\sum_{n \\in \\mathcal{N}_{m}} \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{mn}}{2} \\;+\\; y^{\\mathrm{bus}}_{m}.\n$$\n\nWe now compute each entry using the provided data. First, compute the half-shunt admittances at each line end:\n- For line $\\{1,2\\}$: each end has $\\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{12}}{2} = \\mathrm{j}\\,\\frac{0.20}{2} = \\mathrm{j}\\,0.10$.\n- For line $\\{2,3\\}$: each end has $\\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{23}}{2} = \\mathrm{j}\\,\\frac{0.16}{2} = \\mathrm{j}\\,0.08$.\n- For line $\\{1,3\\}$: each end has $\\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{13}}{2} = \\mathrm{j}\\,\\frac{0.12}{2} = \\mathrm{j}\\,0.06$.\n\nUsing $Y_{mn} = -y_{mn}$ for off-diagonals:\n- $Y_{12} = -y_{12} = -(0.10 - \\mathrm{j}\\,0.50) = -0.10 + \\mathrm{j}\\,0.50$.\n- $Y_{23} = -y_{23} = -(0.08 - \\mathrm{j}\\,0.40) = -0.08 + \\mathrm{j}\\,0.40$.\n- $Y_{13} = -y_{13} = -(0.06 - \\mathrm{j}\\,0.30) = -0.06 + \\mathrm{j}\\,0.30$.\n\nFor diagonals, sum series admittances incident on the bus, plus all local half-shunt admittances from connected lines, plus the grounded bus shunt:\n- Bus $1$ is connected to buses $2$ and $3$, so\n$$\nY_{11} = y_{12} + y_{13} + \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{12}}{2} + \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{13}}{2} + y^{\\mathrm{bus}}_{1}.\n$$\nSubstitute values:\n$$\nY_{11} = (0.10 - \\mathrm{j}\\,0.50) + (0.06 - \\mathrm{j}\\,0.30) + \\mathrm{j}\\,0.10 + \\mathrm{j}\\,0.06 + \\mathrm{j}\\,0.02 = 0.16 - \\mathrm{j}\\,0.62.\n$$\n\n- Bus $2$ is connected to buses $1$ and $3$, so\n$$\nY_{22} = y_{12} + y_{23} + \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{12}}{2} + \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{23}}{2} + y^{\\mathrm{bus}}_{2}.\n$$\nSubstitute values:\n$$\nY_{22} = (0.10 - \\mathrm{j}\\,0.50) + (0.08 - \\mathrm{j}\\,0.40) + \\mathrm{j}\\,0.10 + \\mathrm{j}\\,0.08 + \\mathrm{j}\\,0.01 = 0.18 - \\mathrm{j}\\,0.71.\n$$\n\n- Bus $3$ is connected to buses $1$ and $2$, so\n$$\nY_{33} = y_{13} + y_{23} + \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{13}}{2} + \\mathrm{j}\\,\\frac{B^{\\mathrm{sh}}_{23}}{2} + y^{\\mathrm{bus}}_{3}.\n$$\nSubstitute values:\n$$\nY_{33} = (0.06 - \\mathrm{j}\\,0.30) + (0.08 - \\mathrm{j}\\,0.40) + \\mathrm{j}\\,0.06 + \\mathrm{j}\\,0.08 + \\mathrm{j}\\,0.00 = 0.14 - \\mathrm{j}\\,0.56.\n$$\n\nThus, the assembled Y-bus entries are:\n$$\nY_{11} = 0.16 - \\mathrm{j}\\,0.62,\\quad Y_{22} = 0.18 - \\mathrm{j}\\,0.71,\\quad Y_{33} = 0.14 - \\mathrm{j}\\,0.56,\n$$\n$$\nY_{12} = -0.10 + \\mathrm{j}\\,0.50,\\quad Y_{13} = -0.06 + \\mathrm{j}\\,0.30,\\quad Y_{23} = -0.08 + \\mathrm{j}\\,0.40,\n$$\nwith symmetry $Y_{mn} = Y_{nm}$.\n\nFinally, compute the requested scalar magnitude $|Y_{12}|$. For a complex number $a + \\mathrm{j}\\,b$, the magnitude is $\\sqrt{a^{2} + b^{2}}$. Here, $Y_{12} = -0.10 + \\mathrm{j}\\,0.50$, so\n$$\n|Y_{12}| = \\sqrt{(-0.10)^{2} + (0.50)^{2}} = \\sqrt{0.01 + 0.25} = \\sqrt{0.26}.\n$$\nEvaluate the square root:\n$$\n\\sqrt{0.26} \\approx 0.509901951.\n$$\nRounded to four significant figures, the magnitude is $0.5099$ in per unit (pu).",
            "answer": "$$\\boxed{0.5099}$$"
        },
        {
            "introduction": "The nodal power balance equations derived from KCL are inherently nonlinear, meaning we must turn to iterative numerical methods for their solution. This practice guides you through one full iteration of the Newton-Raphson method, the industry-standard algorithm for solving power flow problems. By explicitly deriving the Jacobian matrix from the KCL-based mismatch equations and solving for the state update, you will gain a concrete understanding of this pivotal solution technique. ",
            "id": "4107692",
            "problem": "You are given a three-bus alternating current power network modeled with nodal equations based on Kirchhoff's Current Law (KCL), formulated in rectangular voltage coordinates and per-unit values. Bus $1$ is the slack bus with fixed complex voltage $V_1 = 1 + j0$ (per unit). Buses $2$ and $3$ are constant power (PQ) buses with specified complex net power injections $S_k = P_k + jQ_k$ (generation minus load). The unknown state vector is the real and imaginary parts of the voltages at the PQ buses, $x = [V_{2r}, V_{2i}, V_{3r}, V_{3i}]^\\top$, where $V_k = V_{kr} + jV_{ki}$.\n\nFundamental base:\n- Kirchhoff's Current Law (KCL): At each node, the algebraic sum of currents leaving the node equals the net current injection, expressed compactly with the bus admittance matrix as $\\sum_{j} Y_{kj} V_j = I_k$, where $Y$ is the complex-valued bus admittance matrix, $V$ is the vector of complex bus voltages, and $I_k$ is the complex current injection at node $k$.\n- Relationship between complex power and current at a bus: $S_k = V_k I_k^\\ast$, so for a fixed specified complex power injection $S_k$, the corresponding current injection is $I_k = \\frac{S_k^\\ast}{V_k^\\ast}$.\n\nNonlinear nodal current mismatch at a PQ bus $k \\in \\{2,3\\}$ is defined as\n$$\ng_k(V) = \\sum_{j=1}^{3} Y_{kj} V_j - \\frac{S_k^\\ast}{V_k^\\ast},\n$$\nand the real-valued residual vector is\n$$\nF(x) = \\big[\\operatorname{Re}(g_2),\\ \\operatorname{Im}(g_2),\\ \\operatorname{Re}(g_3),\\ \\operatorname{Im}(g_3)\\big]^\\top.\n$$\nA single Newton-Raphson iteration computes the state update $\\Delta x$ by assembling the Jacobian $J(x) = \\frac{\\partial F}{\\partial x}$ from the KCL-based derivatives and solving\n$$\nJ(x)\\,\\Delta x = -F(x),\n$$\nto obtain $\\Delta x = [\\Delta V_{2r}, \\Delta V_{2i}, \\Delta V_{3r}, \\Delta V_{3i}]^\\top$.\n\nNetwork data (shared across all tests): The network has series branches with impedances (per unit) $z_{12} = 0.02 + j\\,0.06$, $z_{13} = 0.08 + j\\,0.24$, $z_{23} = 0.06 + j\\,0.18$, and no shunt elements. The line admittances are $y_{12} = 1/z_{12}$, $y_{13} = 1/z_{13}$, $y_{23} = 1/z_{23}$. The bus admittance matrix $Y$ is constructed by the well-tested rule: for each branch $(m,n)$ with admittance $y_{mn}$, add $y_{mn}$ to $Y_{mm}$ and $Y_{nn}$, and add $-y_{mn}$ to $Y_{mn}$ and $Y_{nm}$. All quantities are in per unit (dimensionless).\n\nYour program must:\n- Construct the bus admittance matrix $Y$ from the given branch impedances.\n- For each test case, assemble $F(x)$ and the Jacobian $J(x)$ using the definitions above, treating $V_1$ as known and constant, and only differentiating with respect to $V_{2r}, V_{2i}, V_{3r}, V_{3i}$.\n- Solve the linear system $J(x)\\,\\Delta x = -F(x)$ to obtain the Newton-Raphson state update vector for a single iteration.\n- Report the update vector components as floats rounded to $8$ decimal places.\n\nTest suite:\n- Case $1$ (general load): $S_2 = -0.9 - j\\,0.3$, $S_3 = -0.5 - j\\,0.2$, initial guess $V_2^{(0)} = 1.0 + j\\,0.0$, $V_3^{(0)} = 1.0 + j\\,0.0$.\n- Case $2$ (mixed load/generation and nontrivial initial guess): $S_2 = -1.2 - j\\,0.5$, $S_3 = 0.3 - j\\,0.1$, initial guess $V_2^{(0)} = 0.95 - j\\,0.05$, $V_3^{(0)} = 0.97 + j\\,0.02$.\n- Case $3$ (lightly loaded edge case): $S_2 = 0.0 + j\\,0.0$, $S_3 = -0.1 - j\\,0.05$, initial guess $V_2^{(0)} = 1.02 + j\\,0.01$, $V_3^{(0)} = 0.98 - j\\,0.02$.\n\nRequired final output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case's result is itself a comma-separated list of the four floating-point components $[\\Delta V_{2r}, \\Delta V_{2i}, \\Delta V_{3r}, \\Delta V_{3i}]$. For example, the output must look like\n$$\n\\big[[\\Delta V_{2r}^{(1)},\\Delta V_{2i}^{(1)},\\Delta V_{3r}^{(1)},\\Delta V_{3i}^{(1)}],[\\Delta V_{2r}^{(2)},\\Delta V_{2i}^{(2)},\\Delta V_{3r}^{(2)},\\Delta V_{3i}^{(2)}],[\\Delta V_{2r}^{(3)},\\Delta V_{2i}^{(3)},\\Delta V_{3r}^{(3)},\\Delta V_{3i}^{(3)}]\\big],\n$$\nwith no spaces anywhere inside the brackets, and each floating-point number rounded to $8$ decimal places.",
            "solution": "The problem is valid as it is well-posed, scientifically grounded in the principles of electrical circuit theory and numerical methods, and provides a complete and consistent set of data for its resolution. The task is to compute the state update vector for a single Newton-Raphson iteration for a power flow problem.\n\nThe solution proceeds in three stages:\n1. Construction of the bus admittance matrix $Y$.\n2. Formulation of the residual vector $F(x)$ and the Jacobian matrix $J(x)$.\n3. Assembly and solution of the linear system $J(x)\\,\\Delta x = -F(x)$ for each test case.\n\n**1. Bus Admittance Matrix ($Y$) Construction**\n\nThe network consists of three buses connected by three transmission lines. The slack bus is bus $1$, and the PQ (load) buses are $2$ and $3$. The state vector of unknowns is $x = [V_{2r}, V_{2i}, V_{3r}, V_{3i}]^\\top$, where $V_k = V_{kr} + jV_{ki}$. The slack voltage is fixed at $V_1 = 1.0 + j\\,0.0$.\n\nThe line impedances (in per unit) are given as:\n- $z_{12} = 0.02 + j\\,0.06$\n- $z_{13} = 0.08 + j\\,0.24$\n- $z_{23} = 0.06 + j\\,0.18$\n\nThe corresponding line admittances are the reciprocals of the impedances:\n- $y_{12} = 1/z_{12} = 1/(0.02 + j\\,0.06) = 5.0 - j\\,15.0$\n- $y_{13} = 1/z_{13} = 1/(0.08 + j\\,0.24) = 1.25 - j\\,3.75$\n- $y_{23} = 1/z_{23} = 1/(0.06 + j\\,0.18) \\approx 1.6667 - j\\,5.0$\n\nThe $3 \\times 3$ bus admittance matrix $Y$ is constructed as follows:\n- The diagonal elements $Y_{kk}$ are the sum of all admittances connected to bus $k$.\n- The off-diagonal elements $Y_{kj}$ are the negative of the admittance connecting bus $k$ to bus $j$.\n\n$$\nY =\n\\begin{bmatrix}\ny_{12} + y_{13} & -y_{12} & -y_{13} \\\\\n-y_{12} & y_{12} + y_{23} & -y_{23} \\\\\n-y_{13} & -y_{23} & y_{13} + y_{23}\n\\end{bmatrix}\n$$\n\nSubstituting the numerical values:\n$$\nY_{11} = (5.0 - j\\,15.0) + (1.25 - j\\,3.75) = 6.25 - j\\,18.75 \\\\\nY_{22} = (5.0 - j\\,15.0) + (1.6667 - j\\,5.0) = 6.6667 - j\\,20.0 \\\\\nY_{33} = (1.25 - j\\,3.75) + (1.6667 - j\\,5.0) = 2.9167 - j\\,8.75 \\\\\nY_{12} = Y_{21} = -(5.0 - j\\,15.0) = -5.0 + j\\,15.0 \\\\\nY_{13} = Y_{31} = -(1.25 - j\\,3.75) = -1.25 + j\\,3.75 \\\\\nY_{23} = Y_{32} = -(1.6667 - j\\,5.0) = -1.6667 + j\\,5.0\n$$\nWe denote the real and imaginary parts of $Y_{kj}$ as $G_{kj}$ and $B_{kj}$ respectively, so $Y_{kj} = G_{kj} + jB_{kj}$.\n\n**2. Residual and Jacobian Formulation**\n\nThe nodal current mismatch equation at a PQ bus $k \\in \\{2,3\\}$ is:\n$$\ng_k(V) = \\sum_{j=1}^{3} Y_{kj} V_j - \\frac{S_k^\\ast}{V_k^\\ast} = 0\n$$\nwhere $V_1$ is known, $V_2$ and $V_3$ are variables. The residual vector $F(x)$ is formed by the real and imaginary parts of these two complex equations:\n$$\nF(x) = \\begin{bmatrix} \\operatorname{Re}(g_2) \\\\ \\operatorname{Im}(g_2) \\\\ \\operatorname{Re}(g_3) \\\\ \\operatorname{Im}(g_3) \\end{bmatrix}\n$$\nThe Newton-Raphson update step is found by solving the linear system $J(x) \\Delta x = -F(x)$. The Jacobian matrix $J(x)$ is a $4 \\times 4$ real-valued matrix defined as $J(x) = \\frac{\\partial F}{\\partial x}$, where $x = [V_{2r}, V_{2i}, V_{3r}, V_{3i}]^\\top$. The Jacobian can be partitioned into $2 \\times 2$ blocks:\n$$\nJ = \\begin{bmatrix} J_{22} & J_{23} \\\\ J_{32} & J_{33} \\end{bmatrix}, \\quad \\text{where} \\quad J_{km} = \\begin{bmatrix} \\frac{\\partial \\operatorname{Re}(g_k)}{\\partial V_{mr}} & \\frac{\\partial \\operatorname{Re}(g_k)}{\\partial V_{mi}} \\\\ \\frac{\\partial \\operatorname{Im}(g_k)}{\\partial V_{mr}} & \\frac{\\partial \\operatorname{Im}(g_k)}{\\partial V_{mi}} \\end{bmatrix}\n$$\n\nThe derivatives are derived as follows.\nFor the off-diagonal blocks ($k \\neq m$, e.g., $k=2, m=3$):\nThe function $g_k$ is only affected by $V_m$ through the linear term $Y_{km}V_m$.\n$$\n\\frac{\\partial g_k}{\\partial V_{mr}} = Y_{km}, \\quad \\frac{\\partial g_k}{\\partial V_{mi}} = jY_{km}\n$$\nTaking real and imaginary parts gives the block structure:\n$$\nJ_{km} = \\begin{bmatrix} G_{km} & -B_{km} \\\\ B_{km} & G_{km} \\end{bmatrix}\n$$\n\nFor the diagonal blocks ($k = m$, e.g., $k=2, m=2$):\nThe dependency includes the nonlinear power term.\n$$\n\\frac{\\partial g_k}{\\partial V_{kr}} = Y_{kk} - \\frac{\\partial}{\\partial V_{kr}}\\left(\\frac{S_k^\\ast}{V_k^\\ast}\\right) = Y_{kk} + \\frac{S_k^\\ast}{(V_k^\\ast)^2} \\\\\n\\frac{\\partial g_k}{\\partial V_{ki}} = jY_{kk} - \\frac{\\partial}{\\partial V_{ki}}\\left(\\frac{S_k^\\ast}{V_k^\\ast}\\right) = jY_{kk} - j\\frac{S_k^\\ast}{(V_k^\\ast)^2}\n$$\nLet's define a temporary complex variable $D_k = A_k + jC_k = \\frac{S_k^\\ast}{(V_k^\\ast)^2}$. Then the partial derivatives are:\n$$\n\\frac{\\partial g_k}{\\partial V_{kr}} = (G_{kk} + jB_{kk}) + (A_k + jC_k) = (G_{kk}+A_k) + j(B_{kk}+C_k) \\\\\n\\frac{\\partial g_k}{\\partial V_{ki}} = j(G_{kk} + jB_{kk}) - j(A_k + jC_k) = (-B_{kk}+C_k) + j(G_{kk}-A_k)\n$$\nTaking the real and imaginary parts of these expressions yields the diagonal block:\n$$\nJ_{kk} = \\begin{bmatrix} G_{kk} + A_k & -B_{kk} + C_k \\\\ B_{kk} + C_k & G_{kk} - A_k \\end{bmatrix}\n$$\n\n**3. Computation for Test Cases**\n\nFor each test case, we are given an initial guess for the state vector $x^{(0)} = [V_{2r}^{(0)}, V_{2i}^{(0)}, V_{3r}^{(0)}, V_{3i}^{(0)}]^\\top$ and specified powers $S_2$ and $S_3$.\n\nThe algorithm is as follows:\n1.  Use the given constant values to construct the bus admittance matrix $Y$.\n2.  For each test case:\n    a. Unpack the initial voltages $V_2^{(0)}$, $V_3^{(0)}$ and specified powers $S_2$, $S_3$. The slack voltage is always $V_1 = 1.0 + j\\,0.0$.\n    b. Calculate the residual vector $F(x^{(0)})$:\n        - Compute $g_2 = Y_{21}V_1 + Y_{22}V_2^{(0)} + Y_{23}V_3^{(0)} - S_2^\\ast / (V_2^{(0)})^\\ast$.\n        - Compute $g_3 = Y_{31}V_1 + Y_{32}V_2^{(0)} + Y_{33}V_3^{(0)} - S_3^\\ast / (V_3^{(0)})^\\ast$.\n        - Assemble $F = [\\operatorname{Re}(g_2), \\operatorname{Im}(g_2), \\operatorname{Re}(g_3), \\operatorname{Im}(g_3)]^\\top$.\n    c. Calculate the Jacobian matrix $J(x^{(0)})$:\n        - Compute $D_2 = S_2^\\ast / ((V_2^{(0)})^\\ast)^2$ and $D_3 = S_3^\\ast / ((V_3^{(0)})^\\ast)^2$.\n        - Assemble the four blocks $J_{22}, J_{23}, J_{32}, J_{33}$ using the formulas derived above, evaluated at the initial guess.\n    d. Solve the $4 \\times 4$ linear system $J \\Delta x = -F$ for the update vector $\\Delta x = [\\Delta V_{2r}, \\Delta V_{2i}, \\Delta V_{3r}, \\Delta V_{3i}]^\\top$.\n3.  The final result is a collection of the computed $\\Delta x$ vectors for each test case, formatted as specified.\n\nThis procedure is implemented in the provided Python code, utilizing `numpy` for complex arithmetic and linear algebra operations.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Newton-Raphson update vector for a three-bus power system.\n    \"\"\"\n    # Network data (per unit)\n    z12 = 0.02 + 0.06j\n    z13 = 0.08 + 0.24j\n    z23 = 0.06 + 0.18j\n    v1_ref = 1.0 + 0.0j\n\n    # Line admittances\n    y12 = 1.0 / z12\n    y13 = 1.0 / z13\n    y23 = 1.0 / z23\n\n    # Construct Bus Admittance Matrix Y (using 0-based indexing)\n    # Bus 1 -> 0, Bus 2 -> 1, Bus 3 -> 2\n    Y = np.zeros((3, 3), dtype=np.complex128)\n    Y[0, 0] = y12 + y13\n    Y[1, 1] = y12 + y23\n    Y[2, 2] = y13 + y23\n    Y[0, 1] = Y[1, 0] = -y12\n    Y[0, 2] = Y[2, 0] = -y13\n    Y[1, 2] = Y[2, 1] = -y23\n    \n    G = Y.real\n    B = Y.imag\n\n    # Test suite\n    test_cases = [\n        # Case 1\n        {'S2': -0.9 - 0.3j, 'S3': -0.5 - 0.2j, 'V2_init': 1.0 + 0.0j, 'V3_init': 1.0 + 0.0j},\n        # Case 2\n        {'S2': -1.2 - 0.5j, 'S3': 0.3 - 0.1j, 'V2_init': 0.95 - 0.05j, 'V3_init': 0.97 + 0.02j},\n        # Case 3\n        {'S2': 0.0 + 0.0j, 'S3': -0.1 - 0.05j, 'V2_init': 1.02 + 0.01j, 'V3_init': 0.98 - 0.02j},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        S2 = case['S2']\n        S3 = case['S3']\n        V2 = case['V2_init']\n        V3 = case['V3_init']\n        V1 = v1_ref\n\n        # Calculate Residual Vector F(x)\n        g2 = Y[1, 0] * V1 + Y[1, 1] * V2 + Y[1, 2] * V3 - np.conj(S2) / np.conj(V2)\n        g3 = Y[2, 0] * V1 + Y[2, 1] * V2 + Y[2, 2] * V3 - np.conj(S3) / np.conj(V3)\n        F = np.array([g2.real, g2.imag, g3.real, g3.imag])\n\n        # Calculate Jacobian Matrix J(x)\n        J = np.zeros((4, 4), dtype=np.float64)\n\n        # Off-diagonal blocks\n        # J23 (top-right)\n        J[0, 2] = G[1, 2]; J[0, 3] = -B[1, 2]\n        J[1, 2] = B[1, 2]; J[1, 3] = G[1, 2]\n        # J32 (bottom-left)\n        J[2, 0] = G[2, 1]; J[2, 1] = -B[2, 1]\n        J[3, 0] = B[2, 1]; J[3, 1] = G[2, 1]\n\n        # Diagonal blocks\n        # J22 (top-left)\n        D2 = np.conj(S2) / (np.conj(V2)**2)\n        A2, C2 = D2.real, D2.imag\n        J[0, 0] = G[1, 1] + A2; J[0, 1] = -B[1, 1] + C2\n        J[1, 0] = B[1, 1] + C2; J[1, 1] = G[1, 1] - A2\n        \n        # J33 (bottom-right)\n        D3 = np.conj(S3) / (np.conj(V3)**2)\n        A3, C3 = D3.real, D3.imag\n        J[2, 2] = G[2, 2] + A3; J[2, 3] = -B[2, 2] + C3\n        J[3, 2] = B[2, 2] + C3; J[3, 3] = G[2, 2] - A3\n        \n        # Solve for the update vector delta_x\n        delta_x = np.linalg.solve(J, -F)\n        \n        # Format the result for the current case\n        case_result_str = f\"[{','.join([f'{val:.8f}' for val in delta_x])}]\"\n        results.append(case_result_str)\n\n    # Final print statement in the exact required format\n    final_output = f\"[{','.join(results)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "While the full AC power flow model is precise, its computational cost can be prohibitive for large-scale planning and market operations, leading to the widespread use of simplified models. This exercise is crucial for developing a modeler's intuition by quantitatively comparing the full AC model against the popular DC power flow approximation. By implementing both and analyzing the results under various conditions, you will learn to identify when the simplified model is reliable and when it can produce significant, misleading errors. ",
            "id": "4107781",
            "problem": "Consider a connected network with $3$ buses indexed by $i \\in \\{1,2,3\\}$ and lines connecting bus pairs $(1,2)$, $(2,3)$, and $(1,3)$. The objective is to quantify the error introduced by the Direct-Current (DC) power flow approximation when compared to full Alternating-Current (AC) nodal active power balances computed from Kirchhoff's Current Law (KCL) under nonzero resistance-to-reactance ratios. Work strictly from first principles: Kirchhoff's Current Law for complex currents and Ohm's law on complex voltages and admittances.\n\nFundamental base:\n- Kirchhoff's Current Law (KCL): the algebraic sum of currents at a node is zero. In bus-admittance form, the nodal currents satisfy $I = Y_{\\text{bus}} V$, where $I$ is the complex current injection vector, $V$ is the complex voltage vector, and $Y_{\\text{bus}}$ is the bus admittance matrix formed from line admittances.\n- Complex power definition: at each bus $i$, the complex power injection is $S_i = V_i \\overline{I_i}$, and the active power injection is $P_i = \\Re(S_i)$.\n- Ohm's law on each branch: the current from bus $i$ to bus $j$ along line $(i,j)$ is $I_{ij} = (V_i - V_j) y_{ij}$ with series admittance $y_{ij} = \\frac{1}{R_{ij} + j X_{ij}}$.\n- DC power flow approximation assumptions: bus voltage magnitudes are approximately $1$ per unit, angle differences are small so that $\\sin(\\theta_i - \\theta_j) \\approx \\theta_i - \\theta_j$, line resistances are neglected so that only reactances affect active power flows. Under these assumptions, the DC nodal active power injection at bus $i$ is approximated by $P^{\\text{DC}}_i = \\sum_{j \\in \\mathcal{N}(i)} \\frac{\\theta_i - \\theta_j}{X_{ij}}$, and the branch active power flow from $i$ to $j$ is $P^{\\text{DC}}_{ij} = \\frac{\\theta_i - \\theta_j}{X_{ij}}$, both expressed in per unit and convertible to megawatts (MW) by multiplying by the system base power $S_{\\text{base}}$.\n\nTask:\n- For each provided test case, construct the bus admittance matrix $Y_{\\text{bus}}$ for the $3$-bus system using the series admittances $y_{ij} = \\frac{1}{R_{ij} + j X_{ij}}$ with no shunt elements. Use complex bus voltages $V_i = |V_i| e^{j \\theta_i}$ with voltage magnitudes $|V_i|$ and phase angles $\\theta_i$ (angles are specified in radians).\n- Compute the full AC nodal active power injections $P^{\\text{AC}}_i = \\Re\\left(V_i \\overline{I_i}\\right)$ in per unit using KCL with $I = Y_{\\text{bus}} V$, and convert to megawatts by multiplying by $S_{\\text{base}}$ in MW.\n- Compute the AC branch active power flows $P^{\\text{AC}}_{ij} = \\Re\\left(V_i \\overline{I_{ij}}\\right)$ in per unit with $I_{ij} = (V_i - V_j) y_{ij}$, oriented from the lower index bus to the higher index bus for pairs $(1,2)$, $(1,3)$, and $(2,3)$, and convert to megawatts.\n- Compute the DC approximation nodal active power injections $P^{\\text{DC}}_i$ and branch flows $P^{\\text{DC}}_{ij}$ in per unit using only the reactances $X_{ij}$ and angles $\\theta_i$, then convert both to megawatts.\n- Quantify the error of the DC approximation by calculating two metrics per test case:\n  $$\n  E_{\\text{nodes}} = \\max_{i \\in \\{1,2,3\\}} \\left| P^{\\text{AC}}_i - P^{\\text{DC}}_i \\right| \\quad \\text{(in MW)},\n  $$\n  $$\n  E_{\\text{branches}} = \\max_{(i,j) \\in \\{(1,2),(1,3),(2,3)\\}} \\left| P^{\\text{AC}}_{ij} - P^{\\text{DC}}_{ij} \\right| \\quad \\text{(in MW)}.\n  $$\n- Use the following test suite. For each case, angles are in radians, line parameters are in per unit on the given base, and all outputs must be in megawatts (MW).\n\nTest Suite:\n- Case $1$ (boundary with zero resistance):\n  - $S_{\\text{base}} = 100$ MW.\n  - Lines: $(1,2): (R,X) = (0.0, 0.20)$; $(2,3): (R,X) = (0.0, 0.25)$; $(1,3): (R,X) = (0.0, 0.22)$.\n  - Voltage magnitudes: $|V| = [1.00, 1.00, 1.00]$.\n  - Angles: $\\theta = [0.00, 0.05, -0.03]$.\n- Case $2$ (moderate resistance with $R/X \\approx 0.2$):\n  - $S_{\\text{base}} = 100$ MW.\n  - Lines: $(1,2): (R,X) = (0.04, 0.20)$; $(2,3): (R,X) = (0.05, 0.25)$; $(1,3): (R,X) = (0.044, 0.22)$.\n  - Voltage magnitudes: $|V| = [1.00, 1.00, 1.00]$.\n  - Angles: $\\theta = [0.00, 0.10, -0.06]$.\n- Case $3$ (heterogeneous $R/X$ with one high resistance line):\n  - $S_{\\text{base}} = 100$ MW.\n  - Lines: $(1,2): (R,X) = (0.10, 0.20)$; $(2,3): (R,X) = (0.01, 0.25)$; $(1,3): (R,X) = (0.02, 0.22)$.\n  - Voltage magnitudes: $|V| = [1.00, 1.00, 1.00]$.\n  - Angles: $\\theta = [0.00, 0.20, -0.15]$.\n- Case $4$ (voltage magnitude deviations with moderate resistance):\n  - $S_{\\text{base}} = 100$ MW.\n  - Lines: $(1,2): (R,X) = (0.02, 0.20)$; $(2,3): (R,X) = (0.02, 0.25)$; $(1,3): (R,X) = (0.02, 0.22)$.\n  - Voltage magnitudes: $|V| = [1.00, 0.97, 1.04]$.\n  - Angles: $\\theta = [0.00, 0.12, -0.07]$.\n\nRequirements:\n- Angles must be interpreted in radians.\n- Construct $Y_{\\text{bus}}$ directly from the line series admittances without shunt elements.\n- All outputs must be expressed in megawatts (MW).\n- Final output format: Your program should produce a single line of output containing, for each test case, a two-element list $[E_{\\text{nodes}}, E_{\\text{branches}}]$ in MW, aggregated as a comma-separated list enclosed in square brackets. For example, an output over $4$ cases should look like $[[e_{1n},e_{1b}],[e_{2n},e_{2b}],[e_{3n},e_{3b}],[e_{4n},e_{4b}]]$, where each $e_{\\cdot}$ is a floating-point number.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of electrical circuit theory, well-posed with all necessary data provided, and objective in its formulation. It represents a standard, verifiable exercise in power systems analysis.\n\nThe objective is to quantify the error of the Direct-Current (DC) power flow approximation against the full Alternating-Current (AC) power flow model. This will be accomplished by calculating nodal and branch power flows for a $3$-bus system using both methods and then computing the maximum absolute differences for a series of test cases. All calculations are performed in per unit (pu) and converted to megawatts (MW) for the final error metrics.\n\n### Step 1: AC Power Flow Calculation (Exact Model)\n\nThe AC power flow model is derived from first principles: Kirchhoff's Current Law (KCL) and the definitions of complex voltage, current, and power.\n\nThe complex voltage at each bus $i$ is given in polar form as $V_i = |V_i| e^{j \\theta_i}$, where $|V_i|$ is the voltage magnitude and $\\theta_i$ is the phase angle in radians.\n\nThe transmission lines are modeled by their series impedance $Z_{ij} = R_{ij} + j X_{ij}$. The corresponding series admittance is the reciprocal, $y_{ij} = \\frac{1}{Z_{ij}} = \\frac{1}{R_{ij} + j X_{ij}}$. This can be rationalized to separate the conductance ($g_{ij}$) and susceptance ($b_{ij}$):\n$$\ny_{ij} = \\frac{1}{R_{ij} + j X_{ij}} \\times \\frac{R_{ij} - j X_{ij}}{R_{ij} - j X_{ij}} = \\frac{R_{ij}}{R_{ij}^2 + X_{ij}^2} + j \\frac{-X_{ij}}{R_{ij}^2 + X_{ij}^2} = g_{ij} + j b_{ij}\n$$\nThe network is described by the bus admittance matrix, $Y_{\\text{bus}}$, which relates the vector of nodal complex current injections, $I$, to the vector of nodal complex voltages, $V$, via $I = Y_{\\text{bus}} V$. For a network with no shunt elements, the elements of $Y_{\\text{bus}}$ are constructed as follows:\n- Diagonal elements: $Y_{ii} = \\sum_{j \\neq i} y_{ij}$\n- Off-diagonal elements: $Y_{ij} = -y_{ij}$ for $i \\neq j$\n\nFor the given $3$-bus system, the $3 \\times 3$ bus admittance matrix is:\n$$\nY_{\\text{bus}} = \\begin{pmatrix}\ny_{12} + y_{13} & -y_{12} & -y_{13} \\\\\n-y_{12} & y_{12} + y_{23} & -y_{23} \\\\\n-y_{13} & -y_{23} & y_{13} + y_{23}\n\\end{pmatrix}\n$$\nThe vector of complex current injections at the buses, $I = [I_1, I_2, I_3]^T$, is found by the matrix-vector product $I = Y_{\\text{bus}} V$.\n\nThe complex power injection at bus $i$, $S_i$, is given by $S_i = P_i + j Q_i = V_i \\overline{I_i}$, where $\\overline{I_i}$ is the complex conjugate of the current injection $I_i$. The AC active power injection, $P^{\\text{AC}}_i$, is the real part of this complex power:\n$$\nP^{\\text{AC}}_i = \\Re(S_i) = \\Re(V_i \\overline{I_i})\n$$\nThe AC active power flow on a branch from bus $i$ to bus $j$, $P^{\\text{AC}}_{ij}$, is the real part of the complex power leaving bus $i$. The current flowing from bus $i$ to bus $j$ is $I_{ij} = (V_i - V_j)y_{ij}$. The corresponding power flow is:\n$$\nP^{\\text{AC}}_{ij} = \\Re(V_i \\overline{I_{ij}}) = \\Re(V_i \\overline{((V_i - V_j)y_{ij})})\n$$\nThese power values are in per unit. To convert to megawatts, they are multiplied by the system base power, $S_{\\text{base}}$.\n\n### Step 2: DC Power Flow Calculation (Approximation)\n\nThe DC power flow model simplifies the AC equations based on three primary assumptions:\n1. Voltage magnitudes are unity ($|V_i| \\approx 1$ pu for all $i$).\n2. Line resistances are negligible compared to reactances ($R_{ij} \\ll X_{ij}$, so they are assumed to be $0$).\n3. Voltage angle differences across lines are small ($\\theta_i - \\theta_j \\approx 0$), allowing for the approximation $\\sin(\\theta_i - \\theta_j) \\approx \\theta_i - \\theta_j$ and $\\cos(\\theta_i - \\theta_j) \\approx 1$.\n\nUnder these assumptions, the active power injection at bus $i$ is approximated as a linear function of the voltage phase angles:\n$$\nP^{\\text{DC}}_i = \\sum_{j \\in \\mathcal{N}(i)} \\frac{\\theta_i - \\theta_j}{X_{ij}}\n$$\nwhere $\\mathcal{N}(i)$ is the set of buses adjacent to bus $i$.\nSimilarly, the active power flow on a branch from bus $i$ to bus $j$ is approximated by:\n$$\nP^{\\text{DC}}_{ij} = \\frac{\\theta_i - \\theta_j}{X_{ij}}\n$$\nAs with the AC model, these per-unit values are scaled by $S_{\\text{base}}$ to obtain power in MW.\n\n### Step 3: Error Quantification\n\nThe error introduced by the DC approximation is quantified using two metrics, calculated after all power values are converted to megawatts:\n1.  **Nodal Injection Error**: The maximum absolute difference between AC and DC nodal power injections over all buses.\n    $$\n    E_{\\text{nodes}} = \\max_{i \\in \\{1,2,3\\}} |P^{\\text{AC}}_i - P^{\\text{DC}}_i|\n    $$\n2.  **Branch Flow Error**: The maximum absolute difference between AC and DC branch power flows over the specified branches $(1,2)$, $(1,3)$, and $(2,3)$.\n    $$\n    E_{\\text{branches}} = \\max_{(i,j) \\in \\{(1,2),(1,3),(2,3)\\}} |P^{\\text{AC}}_{ij} - P^{\\text{DC}}_{ij}|\n    $$\n\n### Algorithmic Procedure\n\nFor each test case provided in the problem statement, the following computational steps are executed:\n1.  Define the system parameters: $S_{\\text{base}}$, line impedances $Z_{ij} = R_{ij} + j X_{ij}$ for lines $(1,2)$, $(2,3)$, and $(1,3)$, and complex bus voltages $V_i = |V_i| e^{j \\theta_i}$.\n2.  Calculate the series admittances $y_{ij} = 1/Z_{ij}$.\n3.  Construct the $3 \\times 3$ complex matrix $Y_{\\text{bus}}$.\n4.  **AC Calculations**:\n    a. Compute the vector of nodal current injections: $I = Y_{\\text{bus}}V$.\n    b. Compute the vector of nodal active power injections: $P^{\\text{AC}}_i = \\Re(V_i \\overline{I_i}) \\times S_{\\text{base}}$.\n    c. For branches $(1,2)$, $(1,3)$, and $(2,3)$, compute the branch currents $I_{ij} = (V_i - V_j)y_{ij}$.\n    d. Compute the branch active power flows: $P^{\\text{AC}}_{ij} = \\Re(V_i \\overline{I_{ij}}) \\times S_{\\text{base}}$.\n5.  **DC Calculations**:\n    a. Compute the nodal active power injections using the angles $\\theta_i$ and reactances $X_{ij}$: $P^{\\text{DC}}_i = \\left(\\sum_{j \\in \\mathcal{N}(i)} \\frac{\\theta_i - \\theta_j}{X_{ij}}\\right) \\times S_{\\text{base}}$.\n    b. Compute the branch active power flows: $P^{\\text{DC}}_{ij} = \\left(\\frac{\\theta_i - \\theta_j}{X_{ij}}\\right) \\times S_{\\text{base}}$.\n6.  **Error Calculation**:\n    a. Compute the nodal error $E_{\\text{nodes}}$ by finding the maximum absolute difference between the $P^{\\text{AC}}_i$ and $P^{\\text{DC}}_i$ vectors.\n    b. Compute the branch error $E_{\\text{branches}}$ by finding the maximum absolute difference between the $P^{\\text{AC}}_{ij}$ and $P^{\\text{DC}}_{ij}$ values.\n7.  Store the resulting pair $[E_{\\text{nodes}}, E_{\\text{branches}}]$. After processing all cases, the results are aggregated into the specified list format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the error of the DC power flow approximation compared to the full AC power flow model\n    for a 3-bus system across several test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (boundary with zero resistance)\n        {\n            \"S_base\": 100.0,\n            \"lines\": {\n                (1, 2): {\"R\": 0.0, \"X\": 0.20},\n                (2, 3): {\"R\": 0.0, \"X\": 0.25},\n                (1, 3): {\"R\": 0.0, \"X\": 0.22},\n            },\n            \"V_mag\": np.array([1.00, 1.00, 1.00]),\n            \"V_ang_rad\": np.array([0.00, 0.05, -0.03]),\n        },\n        # Case 2 (moderate resistance with R/X ~ 0.2)\n        {\n            \"S_base\": 100.0,\n            \"lines\": {\n                (1, 2): {\"R\": 0.04, \"X\": 0.20},\n                (2, 3): {\"R\": 0.05, \"X\": 0.25},\n                (1, 3): {\"R\": 0.044, \"X\": 0.22},\n            },\n            \"V_mag\": np.array([1.00, 1.00, 1.00]),\n            \"V_ang_rad\": np.array([0.00, 0.10, -0.06]),\n        },\n        # Case 3 (heterogeneous R/X with one high resistance line)\n        {\n            \"S_base\": 100.0,\n            \"lines\": {\n                (1, 2): {\"R\": 0.10, \"X\": 0.20},\n                (2, 3): {\"R\": 0.01, \"X\": 0.25},\n                (1, 3): {\"R\": 0.02, \"X\": 0.22},\n            },\n            \"V_mag\": np.array([1.00, 1.00, 1.00]),\n            \"V_ang_rad\": np.array([0.00, 0.20, -0.15]),\n        },\n        # Case 4 (voltage magnitude deviations with moderate resistance)\n        {\n            \"S_base\": 100.0,\n            \"lines\": {\n                (1, 2): {\"R\": 0.02, \"X\": 0.20},\n                (2, 3): {\"R\": 0.02, \"X\": 0.25},\n                (1, 3): {\"R\": 0.02, \"X\": 0.22},\n            },\n            \"V_mag\": np.array([1.00, 0.97, 1.04]),\n            \"V_ang_rad\": np.array([0.00, 0.12, -0.07]),\n        },\n    ]\n\n    results = []\n    \n    # Define bus indices for array access (0-indexed)\n    bus_map = {1: 0, 2: 1, 3: 2}\n    \n    for case in test_cases:\n        S_base = case[\"S_base\"]\n        lines = case[\"lines\"]\n        V_mag = case[\"V_mag\"]\n        V_ang_rad = case[\"V_ang_rad\"]\n        \n        # --- AC Model ---\n        \n        # 1. Complex voltages\n        V = V_mag * np.exp(1j * V_ang_rad)\n\n        # 2. Line admittances\n        y = {}\n        for (i, j), params in lines.items():\n            Z = params[\"R\"] + 1j * params[\"X\"]\n            y[(i, j)] = 1.0 / Z\n        \n        y12 = y[(1, 2)]\n        y23 = y[(2, 3)]\n        y13 = y[(1, 3)]\n\n        # 3. Y_bus matrix\n        Y_bus = np.zeros((3, 3), dtype=complex)\n        Y_bus[0, 0] = y12 + y13\n        Y_bus[0, 1] = -y12\n        Y_bus[0, 2] = -y13\n        Y_bus[1, 0] = -y12\n        Y_bus[1, 1] = y12 + y23\n        Y_bus[1, 2] = -y23\n        Y_bus[2, 0] = -y13\n        Y_bus[2, 1] = -y23\n        Y_bus[2, 2] = y13 + y23\n\n        # 4. AC Nodal Power Injections\n        I_inj = Y_bus @ V\n        S_inj = V * np.conj(I_inj)\n        P_ac_nodes = S_inj.real * S_base\n\n        # 5. AC Branch Power Flows (oriented from lower to higher index bus)\n        i1, i2, i3 = bus_map[1], bus_map[2], bus_map[3]\n        I_12 = (V[i1] - V[i2]) * y12\n        I_13 = (V[i1] - V[i3]) * y13\n        I_23 = (V[i2] - V[i3]) * y23\n        \n        P_ac_12 = (V[i1] * np.conj(I_12)).real * S_base\n        P_ac_13 = (V[i1] * np.conj(I_13)).real * S_base\n        P_ac_23 = (V[i2] * np.conj(I_23)).real * S_base\n        P_ac_branches = np.array([P_ac_12, P_ac_13, P_ac_23])\n\n        # --- DC Model ---\n        \n        th1, th2, th3 = V_ang_rad[i1], V_ang_rad[i2], V_ang_rad[i3]\n        X12 = lines[(1, 2)][\"X\"]\n        X23 = lines[(2, 3)][\"X\"]\n        X13 = lines[(1, 3)][\"X\"]\n\n        # 1. DC Nodal Power Injections\n        P_dc_node1 = ((th1 - th2) / X12 + (th1 - th3) / X13) * S_base\n        P_dc_node2 = ((th2 - th1) / X12 + (th2 - th3) / X23) * S_base\n        P_dc_node3 = ((th3 - th1) / X13 + (th3 - th2) / X23) * S_base\n        P_dc_nodes = np.array([P_dc_node1, P_dc_node2, P_dc_node3])\n        \n        # 2. DC Branch Power Flows\n        P_dc_12 = ((th1 - th2) / X12) * S_base\n        P_dc_13 = ((th1 - th3) / X13) * S_base\n        P_dc_23 = ((th2 - th3) / X23) * S_base\n        P_dc_branches = np.array([P_dc_12, P_dc_13, P_dc_23])\n\n        # --- Error Calculation ---\n        \n        E_nodes = np.max(np.abs(P_ac_nodes - P_dc_nodes))\n        E_branches = np.max(np.abs(P_ac_branches - P_dc_branches))\n        \n        results.append([E_nodes, E_branches])\n\n    # Final print statement in the exact required format.\n    # The format [[...],[...]] requires str() of a list of lists.\n    # Joining with map(str,...) ensures correct formatting for each inner list.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}