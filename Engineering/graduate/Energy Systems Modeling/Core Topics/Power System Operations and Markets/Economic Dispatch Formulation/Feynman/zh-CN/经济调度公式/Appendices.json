{
    "hands_on_practices": [
        {
            "introduction": "本章节的第一个实践练习将从一个基础问题开始，该问题采用了简化的线性成本函数。这个设定使我们能够直观地掌握“优先顺序调度”（merit order dispatch）的核心经济原则，即优先使用成本最低的发电机组。通过求解这个问题，您将学习如何运用卡罗需-库恩-塔克（Karush-Kuhn-Tucker, KKT）条件来严谨地验证这一直观的调度策略，为更复杂的优化问题打下坚实的理论基础。",
            "id": "4086783",
            "problem": "考虑一个单母线经济调度问题，其中有$3$台火力发电机组在一个爬坡可忽略不计的短时间段内，为一个$D=100$ $\\text{MW}$的固定无弹性需求供电。假设没有输电约束、没有损耗、也没有备用要求。发电机 $i \\in \\{1,2,3\\}$ 产生功率 $P_i$，其线性可变运行成本为 $C_i(P_i)=c_i P_i$，成本系数为 $c=(20, 25, 30)$ 美元/兆瓦时。运行限制为 $P^{\\min}=(0,0,0)$ $\\text{MW}$ 和 $P^{\\max}=(50,60,40)$ $\\text{MW}$。\n\n从约束优化和凸分析的基本原理出发，构建最小化总可变成本的原始优化问题，该问题需服从功率平衡约束和箱式约束。构建拉格朗日函数，推导卡罗需-库恩-塔克（KKT）条件，并利用这些条件确定在最优点时哪些发电机处于其边界，哪些（若有）严格在其边界内运行。然后计算唯一的能最小化总成本、同时满足需求并遵守限制的最优调度 $(P_1^{\\star},P_2^{\\star},P_3^{\\star})$。\n\n将最终调度表示为有序三元组 $(P_1^{\\star},P_2^{\\star},P_3^{\\star})$，单位为 $\\text{MW}$。由于数据是精确的，请报告精确值（不要四舍五入）。",
            "solution": "用户希望解决一个单母线经济调度问题。\n\n### 第1步：提取已知条件\n- 发电机数量：$3$\n- 总需求：$D = 100$ MW\n- 发电机成本函数：$C_i(P_i) = c_i P_i$\n- 成本系数：$c = (c_1, c_2, c_3) = (20, 25, 30)$ 美元/兆瓦时\n- 最小功率输出：$P^{\\min} = (P_1^{\\min}, P_2^{\\min}, P_3^{\\min}) = (0, 0, 0)$ MW\n- 最大功率输出：$P^{\\max} = (P_1^{\\max}, P_2^{\\max}, P_3^{\\max}) = (50, 60, 40)$ MW\n- 假设：无输电约束，无损耗，无备用要求。\n\n### 第2步：使用提取的已知条件进行验证\n该问题是经典的经济调度模型，是电力系统分析的基石。\n- **科学依据**：该问题基于已成熟的约束优化理论，并应用于发电商经济学。使用线性成本函数是一种标准的简化方法，该模型在其定义的范围内是科学合理的。它不基于任何伪科学或有争议的主张。\n- **适定性**：该问题是一个凸优化问题，因为它涉及在线性等式和不等式约束条件下最小化一个线性目标函数。可行域是一个非空、闭合且有界的集合（一个凸多胞体）。因此，保证存在唯一的最优解。\n- **客观性**：该问题使用精确的数学和工程术语进行陈述。它没有歧义和主观内容。\n- **完整性**：所有必要的数据（需求、成本系数、发电机限制）都已提供。该问题是自包含的，不包含矛盾的约束。例如，最大发电容量之和 $\\sum P_i^{\\max} = 50 + 60 + 40 = 150$ MW，大于需求 $D = 100$ MW，这证实了可行解的存在。\n\n### 第3步：结论与行动\n该问题是有效的。它是一个适定、有科学依据且客观的优化问题。我现在将着手解决。\n\n目标是为每台发电机 $i \\in \\{1, 2, 3\\}$ 找到功率输出 $P_i$，以在满足系统需求和各发电机运行限制的同时，最小化总发电成本。\n\n首先，我们构建原始优化问题。目标是最小化总成本，即各发电机成本之和：\n$$ \\min_{P_1, P_2, P_3} \\quad C_{total} = \\sum_{i=1}^{3} C_i(P_i) = 20 P_1 + 25 P_2 + 30 P_3 $$\n该最小化问题受两种约束条件的制约：\n1.  功率平衡约束：总发电功率必须等于总需求。\n    $$ \\sum_{i=1}^{3} P_i = P_1 + P_2 + P_3 = 100 $$\n2.  发电机运行限制（箱式约束）：每台发电机的输出必须在其最小和最大边界之间。\n    $$ P_i^{\\min} \\le P_i \\le P_i^{\\max}, \\quad \\forall i \\in \\{1, 2, 3\\} $$\n    具体而言：\n    $$ 0 \\le P_1 \\le 50 $$\n    $$ 0 \\le P_2 \\le 60 $$\n    $$ 0 \\le P_3 \\le 40 $$\n\n这是一个凸优化问题，因此卡罗需-库恩-塔克（KKT）条件是最优性的充要条件。为了推导这些条件，我们构造拉格朗日函数 $\\mathcal{L}$。我们将拉格朗日乘子 $\\lambda$ 与等式约束相关联，并将非负乘子 $\\underline{\\mu}_i$ 和 $\\overline{\\mu}_i$ 分别与下界和上界不等式约束相关联。不等式约束写作 $P_i^{\\min} - P_i \\le 0$ 和 $P_i - P_i^{\\max} \\le 0$。\n\n拉格朗日函数为：\n$$ \\mathcal{L}(P_i, \\lambda, \\underline{\\mu}_i, \\overline{\\mu}_i) = \\sum_{i=1}^{3} c_i P_i - \\lambda \\left(\\sum_{i=1}^{3} P_i - D\\right) + \\sum_{i=1}^{3} \\underline{\\mu}_i (P_i^{\\min} - P_i) + \\sum_{i=1}^{3} \\overline{\\mu}_i (P_i - P_i^{\\max}) $$\n\n最优解 $(P_1^{\\star}, P_2^{\\star}, P_3^{\\star})$ 的KKT条件是：\n\n1.  **平稳性**：拉格朗日函数对每个决策变量 $P_i$ 的梯度必须为零。\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial P_i} = c_i - \\lambda - \\underline{\\mu}_i + \\overline{\\mu}_i = 0 \\quad \\forall i \\in \\{1, 2, 3\\} $$\n    这可以重写为 $c_i - \\lambda = \\underline{\\mu}_i - \\overline{\\mu}_i$。\n\n2.  **原始可行性**：最优解必须满足所有原始约束。\n    $$ \\sum_{i=1}^{3} P_i^{\\star} = D $$\n    $$ P_i^{\\min} \\le P_i^{\\star} \\le P_i^{\\max} $$\n\n3.  **对偶可行性**：不等式约束的乘子必须为非负。\n    $$ \\underline{\\mu}_i \\ge 0 $$\n    $$ \\overline{\\mu}_i \\ge 0 $$\n\n4.  **互补松弛性**：不等式约束乘子与其对应约束的乘积必须为零。这意味着只有当相应的约束是活动的（即，等式成立）时，乘子才能为正。\n    $$ \\underline{\\mu}_i (P_i^{\\min} - P_i^{\\star}) = 0 $$\n    $$ \\overline{\\mu}_i (P_i^{\\star} - P_i^{\\max}) = 0 $$\n\n根据KKT条件，我们可以分析在最优点时每台发电机的状态：\n- 如果一台发电机严格在其边界内运行（$P_i^{\\min}  P_i^{\\star}  P_i^{\\max}$），那么根据互补松弛性，$\\underline{\\mu}_i = 0$ 和 $\\overline{\\mu}_i = 0$。平稳性条件简化为 $c_i - \\lambda = 0$，即 $\\lambda = c_i$。这样的发电机被称为“边际机组”，其边际成本设定了系统边际价格 $\\lambda$。\n- 如果一台发电机处于其下边界（$P_i^{\\star} = P_i^{\\min}$），那么 $\\overline{\\mu}_i$ 必须为 $0$。平稳性条件变为 $c_i - \\lambda = \\underline{\\mu}_i$。因为 $\\underline{\\mu}_i \\ge 0$，这意味着 $c_i \\ge \\lambda$。如果一台发电机的边际成本大于或等于系统边际价格，则其处于最小出力状态。\n- 如果一台发电机处于其上边界（$P_i^{\\star} = P_i^{\\max}$），那么 $\\underline{\\mu}_i$ 必须为 $0$。平稳性条件变为 $c_i - \\lambda = - \\overline{\\mu}_i$。因为 $\\overline{\\mu}_i \\ge 0$，这意味着 $c_i \\le \\lambda$。如果一台发电机的边际成本小于或等于系统边际价格，则其处于最大出力状态。\n\n这种分析引出了“优先顺序”调度策略：按照边际成本递增的顺序加载发电机，直到满足需求。\n成本系数为 $c_1 = 20$，$c_2 = 25$ 和 $c_3 = 30$ 美元/兆瓦时。优先顺序是发电机1，然后是发电机2，最后是发电机3。需求为 $D=100$ MW。\n\n1.  加载最便宜的发电机，即发电机1（$c_1=20$），直至其最大容量。\n    $P_1 = P_1^{\\max} = 50$ MW。\n    剩余需求为 $D_{rem} = 100 - 50 = 50$ MW。\n\n2.  加载次便宜的发电机，即发电机2（$c_2=25$），以满足剩余需求。\n    剩余需求为 $50$ MW，小于发电机2的最大容量 $P_2^{\\max}=60$ MW。\n    $P_2 = 50$ MW。\n    现在剩余需求为 $50 - 50 = 0$ MW。\n\n3.  需求已完全满足。最昂贵的发电机，即发电机3（$c_3=30$），不需要运行。\n    $P_3 = 0$ MW。这与其最小限制 $P_3^{\\min}=0$ 一致。\n\n我们的候选最优解是 $(P_1^{\\star}, P_2^{\\star}, P_3^{\\star}) = (50, 50, 0)$。我们现在必须根据KKT条件验证此解。\n\n- **原始可行性检查**：\n  - 功率平衡：$50 + 50 + 0 = 100$ MW。这与需求 $D=100$ 相符。（满足）\n  - 发电机限制：\n    - $P_1^{\\star} = 50$，即 $P_1^{\\max}$。（$0 \\le 50 \\le 50$）（满足）\n    - $P_2^{\\star} = 50$，严格介于 $P_2^{\\min}=0$ 和 $P_2^{\\max}=60$ 之间。（$0  50  60$）（满足）\n    - $P_3^{\\star} = 0$，即 $P_3^{\\min}$。（$0 \\le 0 \\le 40$）（满足）\n\n- **基于调度的KKT分析**：\n  - 发电机2是边际机组（$0  P_2^{\\star}  60$），所以其成本设定了系统边际价格：$\\lambda = c_2 = 25$ 美元/兆瓦时。对于发电机2，互补松弛性要求 $\\underline{\\mu}_2 = 0$ 和 $\\overline{\\mu}_2 = 0$。平稳性条件 $c_2 - \\lambda - \\underline{\\mu}_2 + \\overline{\\mu}_2 = 25 - 25 - 0 + 0 = 0$ 得到满足。\n\n  - 发电机1处于其上边界（$P_1^{\\star} = P_1^{\\max} = 50$）。我们的KKT分析要求 $c_1 \\le \\lambda$。此处，$20 \\le 25$，成立。互补松弛性要求 $\\underline{\\mu}_1 = 0$。平稳性条件是 $c_1 - \\lambda - \\underline{\\mu}_1 + \\overline{\\mu}_1 = 0$，得出 $20 - 25 - 0 + \\overline{\\mu}_1 = 0$，所以 $\\overline{\\mu}_1 = 5$。由于 $\\overline{\\mu}_1 = 5 \\ge 0$，对偶可行性得到满足。\n\n  - 发电机3处于其下边界（$P_3^{\\star} = P_3^{\\min} = 0$）。我们的KKT分析要求 $c_3 \\ge \\lambda$。此处，$30 \\ge 25$，成立。互补松弛性要求 $\\overline{\\mu}_3 = 0$。平稳性条件是 $c_3 - \\lambda - \\underline{\\mu}_3 + \\overline{\\mu}_3 = 0$，得出 $30 - 25 - \\underline{\\mu}_3 + 0 = 0$，所以 $\\underline{\\mu}_3 = 5$。由于 $\\underline{\\mu}_3 = 5 \\ge 0$，对偶可行性得到满足。\n\n对于调度 $(P_1^{\\star}, P_2^{\\star}, P_3^{\\star}) = (50, 50, 0)$ 以及乘子 $\\lambda = 25$，$\\underline{\\mu} = (0, 0, 5)$ 和 $\\overline{\\mu} = (5, 0, 0)$，所有KKT条件都得到满足。由于该问题是凸的，此解是唯一的全局最优解。\n\n最优调度为：\n- 发电机1：$P_1^{\\star} = 50$ MW（处于其最大限制）\n- 发电机2：$P_2^{\\star} = 50$ MW（在其限制范围内运行，为边际机组）\n- 发电机3：$P_3^{\\star} = 0$ MW（处于其最小限制）\n\n最终答案是有序三元组 $(P_1^{\\star}, P_2^{\\star}, P_3^{\\star})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n50  50  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在了解了线性成本模型后，我们通过引入更贴近现实的二次成本函数来增加问题的复杂性。在这种情况下，发电机组的边际成本不再是常数，而是随其出力增加而增加，这引出了所有运行中机组需满足“等增量成本”原则。这项练习将挑战您应用KKT条件，以确定哪些发电机组应被调度，哪些应保持关闭，从而揭示边际成本在决定机组经济可行性中的关键作用。",
            "id": "4086799",
            "problem": "考虑一个单母线电力系统，其中有三个火力发电机组参与经济调度 (ED)。每个机组的燃料成本函数 $C_{i}(P_{i})=a_{i}+b_{i}P_{i}+c_{i}P_{i}^{2}$（$i\\in\\{1,2,3\\}$）是严格凸的二次可微函数，其中 $P_{i}$ 是机组 $i$ 的有功功率输出。系统必须在不考虑输电损耗的情况下满足一个固定的负荷需求 $D$。假设数据如下：$(a_{1},b_{1},c_{1})=(0,10,0.02)$，$(a_{2},b_{2},c_{2})=(0,12,0.015)$，$(a_{3},b_{3},c_{3})=(0,15,0.01)$，以及 $D=150$。每个发电机都受非负性约束 $P_{i}\\geq 0$ 的限制，并且没有明确的输出上限。优化目标是在满足功率平衡约束 $\\sum_{i=1}^{3}P_{i}=D$ 和可行性约束 $P_{i}\\geq 0$ 的条件下，最小化总成本 $\\sum_{i=1}^{3}C_{i}(P_{i})$。\n\n从凸优化和拉格朗日对偶性的第一性原理出发，推导该问题的充要最优性条件，并用它们来计算最优调度 $(P_{1},P_{2},P_{3})$ 和系统边际成本（与功率平衡相关的拉格朗日乘子），记为 $\\lambda$。你必须内生地确定在最优点处是否有任何非负性约束是紧的。\n\n将 $P_{i}$ 的最终值以 $\\text{MW}$ 表示，$\\lambda$ 的最终值以 美元/兆瓦时 表示。请提供精确值，无需四舍五入。",
            "solution": "该问题陈述是电力系统工程中一个定义明确的经济调度 (ED) 问题。这是一个凸优化问题，因为待最小化的目标函数 $C(P_1, P_2, P_3) = \\sum_{i=1}^{3} C_{i}(P_{i})$ 是严格凸二次函数的和（因为所有 $c_i  0$），因此其本身也是严格凸的。由仿射等式约束（$\\sum P_i = D$）和线性不等式约束（$P_i \\geq 0$）定义的可行域是一个凸集。在一个非空凸集上最小化的严格凸函数有唯一的最小值。所有必要的数据（成本系数、需求）都已提供，并且没有内部矛盾。因此，该问题是有效的。\n\n该优化问题可以表述如下：\n$$\n\\begin{aligned}\n \\underset{P_1, P_2, P_3}{\\text{minimize}}\n  \\sum_{i=1}^{3} C_{i}(P_{i}) = \\sum_{i=1}^{3} (a_i + b_i P_i + c_i P_i^2) \\\\\n \\text{subject to}\n  \\sum_{i=1}^{3} P_i = D \\\\\n   P_i \\geq 0, \\quad \\text{for } i \\in \\{1, 2, 3\\}\n\\end{aligned}\n$$\n这是一个凸优化问题，因此卡罗需-库恩-塔克 (KKT) 条件是其最优性的充要条件。为了推导这些条件，我们首先构造拉格朗日函数 $\\mathcal{L}$。设 $\\lambda$ 为功率平衡等式约束的拉格朗日乘子，设 $\\mu_i \\geq 0$ 为非负性不等式约束 $P_i \\geq 0$ 的拉格朗日乘子。我们将不等式写为 $g_i(P_i) = -P_i \\leq 0$，这是一个常见的约定，但为了在经济调度中解释的清晰性，我们将乘子 $\\mu_i$ 与约束 $P_i \\ge 0$ 相关联。拉格朗日函数是：\n$$\n\\mathcal{L}(P_1, P_2, P_3, \\lambda, \\mu_1, \\mu_2, \\mu_3) = \\sum_{i=1}^{3} C_i(P_i) - \\lambda \\left( \\sum_{i=1}^{3} P_i - D \\right) - \\sum_{i=1}^{3} \\mu_i P_i\n$$\n对于最优解 $(P_1^*, P_2^*, P_3^*)$ 及其对应的乘子 $(\\lambda^*, \\mu_1^*, \\mu_2^*, \\mu_3^*)$，KKT 条件如下：\n\n1.  **平稳性 (Stationarity):** 拉格朗日函数关于每个 $P_i$ 的梯度必须为零。\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial P_i} = \\frac{dC_i}{dP_i}(P_i^*) - \\lambda^* - \\mu_i^* = 0 \\implies b_i + 2c_i P_i^* = \\lambda^* + \\mu_i^* \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n2.  **原始可行性 (Primal Feasibility):** 解必须满足所有原始约束。\n    $$ \\sum_{i=1}^{3} P_i^* = D $$\n    $$ P_i^* \\geq 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n3.  **对偶可行性 (Dual Feasibility):** 不等式约束的乘子必须为非负。\n    $$ \\mu_i^* \\geq 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n4.  **互补松弛性 (Complementary Slackness):** 不等式约束乘子与约束值的乘积必须为零。\n    $$ \\mu_i^* P_i^* = 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\n根据互补松弛性条件，对于每个发电机 $i$，要么 $P_i^* = 0$，要么 $\\mu_i^* = 0$。这导致每个发电机有两种情况：\n-   如果 $P_i^*  0$（发电机投入运行），则 $\\mu_i^* = 0$。平稳性条件简化为 $b_i + 2c_i P_i^* = \\lambda^*$。这就是“等增量成本”原则，即所有运行中发电机的边际成本等于系统边际成本 $\\lambda^*$。\n-   如果 $P_i^* = 0$（发电机未投入运行），则 $\\mu_i^* \\geq 0$。平稳性条件为 $b_i = \\lambda^* + \\mu_i^*$，这意味着 $b_i \\geq \\lambda^*$。这表示如果一个发电机在零输出时的边际成本（$b_i$）大于或等于系统边际成本，则该发电机将关闭。\n\n我们可以通过检验关于哪些发电机在运行的假设来求解最优调度。\n\n**假设 1：所有三个发电机都投入运行 ($P_10, P_20, P_30$)。**\n这个假设意味着 $\\mu_1^*=\\mu_2^*=\\mu_3^*=0$。KKT 条件简化为：\n$$\nb_1 + 2c_1 P_1 = \\lambda \\\\\nb_2 + 2c_2 P_2 = \\lambda \\\\\nb_3 + 2c_3 P_3 = \\lambda \\\\\nP_1 + P_2 + P_3 = D\n$$\n代入给定的系数：\n$10 + 0.04 P_1 = \\lambda \\implies P_1 = \\frac{\\lambda - 10}{0.04} = 25(\\lambda - 10)$\n$12 + 0.03 P_2 = \\lambda \\implies P_2 = \\frac{\\lambda - 12}{0.03} = \\frac{100}{3}(\\lambda - 12)$\n$15 + 0.02 P_3 = \\lambda \\implies P_3 = \\frac{\\lambda - 15}{0.02} = 50(\\lambda - 15)$\n\n将这些代入功率平衡方程 $\\sum P_i = 150$：\n$$ 25(\\lambda - 10) + \\frac{100}{3}(\\lambda - 12) + 50(\\lambda - 15) = 150 $$\n$$ 25\\lambda - 250 + \\frac{100}{3}\\lambda - 400 + 50\\lambda - 750 = 150 $$\n$$ \\left(75 + \\frac{100}{3}\\right)\\lambda - 1400 = 150 $$\n$$ \\frac{325}{3}\\lambda = 1550 $$\n$$ \\lambda = \\frac{1550 \\times 3}{325} = \\frac{4650}{325} = \\frac{186}{13} $$\n现在我们检查这个 $\\lambda$ 值是否能得到一个可行解（即 $P_i  0$）。\n要使 $P_3  0$，我们需要 $\\lambda  15$。我们来检查一下：\n$$ \\frac{186}{13} \\approx 14.31 $$\n由于 $\\frac{186}{13}  15$（因为 $186  13 \\times 15 = 195$），计算出的发电机 3 的输出将为负值：\n$$ P_3 = 50\\left(\\frac{186}{13} - 15\\right) = 50\\left(\\frac{186 - 195}{13}\\right) = -\\frac{450}{13}  0 $$\n这违反了原始可行性条件 $P_3 \\geq 0$。因此，假设 1 是不正确的。发电机 3 的非负性约束必须是紧约束。\n\n**假设 2：发电机 3 未投入运行 ($P_3=0$)，而发电机 1 和 2 投入运行 ($P_10, P_20$)。**\n这意味着 $P_3^*=0$，$\\mu_1^*=0$，且 $\\mu_2^*=0$。我们还必须验证在解处 $\\mu_3^* \\geq 0$。起作用的 KKT 条件是：\n$$\nb_1 + 2c_1 P_1 = \\lambda \\\\\nb_2 + 2c_2 P_2 = \\lambda \\\\\nP_1 + P_2 = D - P_3 = 150\n$$\n根据发电机 3 的平稳性条件，$b_3 + 2c_3 P_3^* = \\lambda^* + \\mu_3^*$，变为 $15 = \\lambda^* + \\mu_3^*$。对偶可行性条件 $\\mu_3^* \\geq 0$ 要求 $\\lambda^* \\leq 15$。\n\n我们来求解关于 $P_1, P_2, \\lambda$ 的方程组：\n$P_1 = 25(\\lambda - 10)$\n$P_2 = \\frac{100}{3}(\\lambda - 12)$\n代入修改后的功率平衡方程 $P_1 + P_2 = 150$：\n$$ 25(\\lambda - 10) + \\frac{100}{3}(\\lambda - 12) = 150 $$\n$$ 25\\lambda - 250 + \\frac{100}{3}\\lambda - 400 = 150 $$\n$$ \\left(25 + \\frac{100}{3}\\right)\\lambda - 650 = 150 $$\n$$ \\frac{175}{3}\\lambda = 800 $$\n$$ \\lambda = \\frac{800 \\times 3}{175} = \\frac{2400}{175} = \\frac{96}{7} $$\n现在，我们必须验证这个解是否与所有 KKT 条件一致。\n1.  **检查 $\\lambda$ 的可行性**: $\\lambda^* = \\frac{96}{7} \\approx 13.71$。这满足所要求的 $\\lambda^* \\leq 15$。\n2.  **计算 $\\mu_3^*$**: $\\mu_3^* = 15 - \\lambda^* = 15 - \\frac{96}{7} = \\frac{105 - 96}{7} = \\frac{9}{7}$。这满足对偶可行性条件 $\\mu_3^* \\geq 0$。\n3.  **计算 $P_1^*$ 和 $P_2^*$**:\n    $$ P_1^* = 25(\\lambda^* - 10) = 25\\left(\\frac{96}{7} - 10\\right) = 25\\left(\\frac{96 - 70}{7}\\right) = \\frac{25 \\times 26}{7} = \\frac{650}{7} $$\n    $$ P_2^* = \\frac{100}{3}(\\lambda^* - 12) = \\frac{100}{3}\\left(\\frac{96}{7} - 12\\right) = \\frac{100}{3}\\left(\\frac{96 - 84}{7}\\right) = \\frac{100 \\times 12}{21} = \\frac{400 \\times 3}{7 \\times 3} = \\frac{400}{7} $$\n    由于 $\\lambda^* = \\frac{96}{7}  12$ 且 $\\lambda^*  10$，所以 $P_1^*$ 和 $P_2^*$ 都是正数，与假设相符。$P_1^* = \\frac{650}{7} \\approx 92.86  0$ 且 $P_2^* = \\frac{400}{7} \\approx 57.14  0$。原始可行性得到满足。\n\n汇总的解是：\n-   最优调度: $P_1^* = \\frac{650}{7}$, $P_2^* = \\frac{400}{7}$, $P_3^* = 0$。\n-   系统边际成本: $\\lambda^* = \\frac{96}{7}$。\n-   非负性约束的拉格朗日乘子: $\\mu_1^*=0$, $\\mu_2^*=0$, $\\mu_3^*=\\frac{9}{7}$。\n\n我们来验证功率平衡：$P_1^* + P_2^* + P_3^* = \\frac{650}{7} + \\frac{400}{7} + 0 = \\frac{1050}{7} = 150 = D$。\n所有 KKT 条件都已满足。由于问题是严格凸的，该解是唯一的全局最优解。\n最优调度为 $(P_1, P_2, P_3) = (\\frac{650}{7}, \\frac{400}{7}, 0)$，单位为 $\\text{MW}$；系统边际成本为 $\\lambda = \\frac{96}{7}$，单位为 美元/兆瓦时。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{650}{7}  \\frac{400}{7}  0  \\frac{96}{7}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后的这项实践练习将前面所有概念整合到一个完整且贴近实际的经济调度问题中。它不仅包含了二次成本函数，还引入了发电机组的最小和最大出力限制，这些是现实世界中常见的物理约束。通过解决这个问题，您将探索物理运行约束如何与经济目标相互作用，并观察当一台低成本发电机达到其容量上限时，系统如何调整其他机组的出力来满足需求，从而全面地应用KKT条件解决一个有界约束的优化问题。",
            "id": "4086798",
            "problem": "一个火力发电系统拥有三台可调度机组，其生产成本为严格凸的二次函数。对于机组 $i \\in \\{1,2,3\\}$，其成本为 $C_i(P_i) = \\alpha_i P_i^2 + \\beta_i P_i + \\gamma_i$（单位：美元/小时），其中 $P_i$ 是功率输出（单位：兆瓦）。系统需求为 $D = 120$，每台机组的功率限制为 $0 \\leq P_i \\leq \\overline{P}_i$。数据如下：\n- 机组 1：$\\alpha_1 = 0.05$，$\\beta_1 = 14$，$\\gamma_1 = 100$，$\\overline{P}_1 = 50$。\n- 机组 2：$\\alpha_2 = 0.10$，$\\beta_2 = 10$，$\\gamma_2 = 120$，$\\overline{P}_2 = 35$。\n- 机组 3：$\\alpha_3 = 0.08$，$\\beta_3 = 12$，$\\gamma_3 = 60$，$\\overline{P}_3 = 70$。\n\n使用凸优化和拉格朗日对偶性的基本原理，将经济调度问题构建为一个凸规划问题。从该模型中推导出 Karush–Kuhn–Tucker (KKT) 最优性条件，并计算唯一的原始-对偶最优解对 $\\{P_1^\\star, P_2^\\star, P_3^\\star, \\lambda^\\star\\}$，其中 $\\lambda^\\star$ 是与功率平衡约束相关的最优拉格朗日乘子。确定在最优解处哪个不等式约束是激活的，并通过显式计算激活边界对应的拉格朗日乘子来验证互补松弛性。\n\n在适当时，将最终数值结果表示为精确的最简分数。将拉格朗日乘子的值以美元/兆瓦时 (USD/MWh) 表示，各机组的调度功率以兆瓦 (MW) 表示。将您的最终答案以单行矩阵的形式按 $\\left(\\lambda^\\star, P_1^\\star, P_2^\\star, P_3^\\star\\right)$ 的顺序提供。最终答案框中不包含单位。无需四舍五入。",
            "solution": "经济调度的目标是在满足需求和遵守机组容量限制的条件下，最小化总生产成本。该问题基于以下原理：\n- 由于对所有 $i$ 都有 $\\alpha_i  0$，总成本在每个 $P_i$ 上是可分的且严格凸的。\n- 由线性等式和不等式约束定义的可行集是凸的。\n- 对于具有仿射约束和严格可行点（Slater 条件）的严格凸规划问题，强对偶性成立，这保证了 Karush–Kuhn–Tucker (KKT) 条件是最优性的充分必要条件。\n\n模型构建：\n最小化 $\\sum_{i=1}^{3} C_i(P_i)$，约束条件为\n- $\\sum_{i=1}^{3} P_i = D$，\n- 对于 $i \\in \\{1,2,3\\}$，有 $0 \\leq P_i \\leq \\overline{P}_i$。\n\n根据给定数据，问题为：\n最小化\n$$\nC_1(P_1) + C_2(P_2) + C_3(P_3) = 0.05 P_1^2 + 14 P_1 + 100 + 0.10 P_2^2 + 10 P_2 + 120 + 0.08 P_3^2 + 12 P_3 + 60\n$$\n约束条件为\n$$\nP_1 + P_2 + P_3 = 120, \\quad 0 \\leq P_1 \\leq 50, \\quad 0 \\leq P_2 \\leq 35, \\quad 0 \\leq P_3 \\leq 70.\n$$\n\n拉格朗日函数和 KKT 条件：\n为等式约束引入拉格朗日乘子 $\\lambda$，并为下界和上界分别引入非负乘子 $\\mu_i^{-}$ 和 $\\mu_i^{+}$。拉格朗日函数为\n$$\n\\mathcal{L}(P_1,P_2,P_3,\\lambda,\\mu^{-},\\mu^{+}) = \\sum_{i=1}^{3} C_i(P_i) + \\lambda \\left(D - \\sum_{i=1}^{3} P_i \\right) + \\sum_{i=1}^{3} \\mu_i^{-} (0 - P_i) + \\sum_{i=1}^{3} \\mu_i^{+} (P_i - \\overline{P}_i).\n$$\nKarush–Kuhn–Tucker (KKT) 条件是：\n1. 原始可行性：$P_1 + P_2 + P_3 = 120$，且 $0 \\leq P_i \\leq \\overline{P}_i$。\n2. 对偶可行性：$\\mu_i^{-} \\geq 0$，$\\mu_i^{+} \\geq 0$。\n3. 平稳性条件：\n$$\n\\frac{\\partial C_i}{\\partial P_i}(P_i) - \\lambda - \\mu_i^{-} + \\mu_i^{+} = 0, \\quad i \\in \\{1,2,3\\}.\n$$\n给定 $C_i(P_i) = \\alpha_i P_i^2 + \\beta_i P_i + \\gamma_i$，边际成本为\n$$\n\\frac{\\partial C_1}{\\partial P_1} = 2 \\cdot 0.05 P_1 + 14 = 0.10 P_1 + 14, \\quad \\frac{\\partial C_2}{\\partial P_2} = 2 \\cdot 0.10 P_2 + 10 = 0.20 P_2 + 10, \\quad \\frac{\\partial C_3}{\\partial P_3} = 2 \\cdot 0.08 P_3 + 12 = 0.16 P_3 + 12.\n$$\n4. 互补松弛性：\n$$\n\\mu_i^{-} P_i = 0, \\quad \\mu_i^{+} (P_i - \\overline{P}_i) = 0, \\quad i \\in \\{1,2,3\\}.\n$$\n\n确定激活集：\n首先，忽略不等式边界并使边际成本相等：\n假设对所有 $i$ 都有 $\\mu_i^{-}=\\mu_i^{+}=0$。那么平稳性条件给出 $0.10 P_1 + 14 = \\lambda$，$0.20 P_2 + 10 = \\lambda$，$0.16 P_3 + 12 = \\lambda$，即，\n$$\nP_1 = 10 \\lambda - 140, \\quad P_2 = 5 \\lambda - 50, \\quad P_3 = 6.25 \\lambda - 75.\n$$\n求和至总需求：\n$$\n(10 + 5 + 6.25) \\lambda - (140 + 50 + 75) = 120 \\;\\Rightarrow\\; 21.25 \\lambda - 265 = 120 \\;\\Rightarrow\\; \\lambda = \\frac{385}{21.25} = \\frac{308}{17}.\n$$\n对应的 $P_2$ 是\n$$\nP_2 = 5 \\cdot \\frac{308}{17} - 50 = \\frac{1540}{17} - 50 = \\frac{690}{17} \\approx 40.588,\n$$\n这违反了边界 $P_2 \\leq 35$。因此，在最优解处，机组2的上界是激活的：$P_2^\\star = \\overline{P}_2 = 35$，且 $\\mu_2^{+}  0$。\n\n使用激活约束 $P_2 = 35$ 求解：\n对于 $i \\in \\{1,3\\}$，如果它们的边界未激活，则 $\\mu_i^{-}=\\mu_i^{+}=0$ 且平稳性条件得出\n$$\n0.10 P_1 + 14 = \\lambda, \\quad 0.16 P_3 + 12 = \\lambda.\n$$\n因此\n$$\nP_1 = 10 \\lambda - 140, \\quad P_3 = 6.25 \\lambda - 75.\n$$\n在 $P_2 = 35$ 的条件下强制功率平衡：\n$$\nP_1 + P_3 + 35 = 120 \\;\\Rightarrow\\; (10 \\lambda - 140) + (6.25 \\lambda - 75) + 35 = 120.\n$$\n这可以简化为\n$$\n16.25 \\lambda - 180 = 120 \\;\\Rightarrow\\; 16.25 \\lambda = 300 \\;\\Rightarrow\\; \\lambda^\\star = \\frac{300}{16.25} = \\frac{1200}{65} = \\frac{240}{13}.\n$$\n那么\n$$\nP_1^\\star = 10 \\lambda^\\star - 140 = 10 \\cdot \\frac{240}{13} - 140 = \\frac{2400}{13} - \\frac{1820}{13} = \\frac{580}{13},\n$$\n$$\nP_3^\\star = 6.25 \\lambda^\\star - 75 = \\frac{25}{4} \\cdot \\frac{240}{13} - 75 = \\frac{1500}{13} - \\frac{975}{13} = \\frac{525}{13}.\n$$\n检查边界：$P_1^\\star = \\frac{580}{13} \\approx 44.615 \\in (0,50)$，$P_3^\\star = \\frac{525}{13} \\approx 40.385 \\in (0,70)$；因此它们的边界是非激活的，这与 $\\mu_1^{-}=\\mu_1^{+}=\\mu_3^{-}=\\mu_3^{+}=0$ 一致。\n\n激活边界的互补松弛性验证：\n对于机组2，在 $P_2^\\star = \\overline{P}_2 = 35$ 处，平稳性条件为\n$$\n(0.20 P_2^\\star + 10) - \\lambda^\\star - \\mu_2^{-} + \\mu_2^{+} = 0.\n$$\n由于在 $P_2^\\star=350$ 时下界未激活，我们有 $\\mu_2^{-}=0$。因此，\n$$\n\\mu_2^{+} = \\lambda^\\star - (0.20 P_2^\\star + 10) = \\frac{240}{13} - (0.20 \\cdot 35 + 10) = \\frac{240}{13} - 17 = \\frac{19}{13} \\geq 0.\n$$\n互补松弛性成立：$\\mu_2^{+} (P_2^\\star - \\overline{P}_2) = \\frac{19}{13} \\cdot 0 = 0$；对于机组1和3，$\\mu_i^{\\pm}=0$ 且 $P_i^\\star$ 严格在边界内，所以 $\\mu_i^{-} P_i^\\star = 0$ 和 $\\mu_i^{+} (P_i^\\star - \\overline{P}_i) = 0$ 得到满足。\n\n非约束机组的边际成本相等：\n检查 $0.10 P_1^\\star + 14 = \\frac{0.10 \\cdot 580}{13} + 14 = \\frac{58}{13} + \\frac{182}{13} = \\frac{240}{13} = \\lambda^\\star$，以及 $0.16 P_3^\\star + 12 = \\frac{0.16 \\cdot 525}{13} + 12 = \\frac{84}{13} + \\frac{156}{13} = \\frac{240}{13} = \\lambda^\\star$，这符合边界未激活时的平稳性条件要求。\n\n唯一性：\n因为目标函数是严格凸的，且可行集是非空凸集，所以 KKT 解是唯一的。\n\n因此，唯一的原始-对偶最优解对是\n$$\n\\lambda^\\star = \\frac{240}{13}, \\quad P_1^\\star = \\frac{580}{13}, \\quad P_2^\\star = 35, \\quad P_3^\\star = \\frac{525}{13},\n$$\n其中机组2的上界被激活，且相关的乘子为 $\\mu_2^{+} = \\frac{19}{13}$。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{240}{13}  \\frac{580}{13}  35  \\frac{525}{13}\\end{pmatrix}}$$"
        }
    ]
}