## 引言
机组组合（Unit Commitment, UC）问题是[电力系统运行](@entry_id:1130078)与规划中的核心优化任务，它决定了哪些[发电机](@entry_id:268282)组应在何时启动、停机以及各自的发电量，以最低的成本满足系统负荷并保证运行安全。由于其决策中包含离散的启停选择和连续的功率输出，UC问题本质上是一个大规模的[混合整数线性规划](@entry_id:1127955)（MILP）问题，其[计算复杂性](@entry_id:204275)随着系统规模的扩大而急剧增加。

解决这一计算挑战的关键，并不仅仅在于更快的计算机或更先进的求解算法，更深层次地依赖于数学模型的“质量”——即其公式的“紧致性”（tightness）。一个“弱”的公式可能在理论上正确，但在实践中其[线性规划松弛](@entry_id:267116)的解离真实整数解过远，导致求解器陷入巨大的搜索空间，耗时巨大甚至无法求解。本文旨在填补理论与实践之间的这一鸿沟，系统性地阐述构建“强”UC公式和[有效不等式](@entry_id:170492)的原理、应用与实践。

在接下来的章节中，您将踏上一段从基础到前沿的旅程。在“原理与机制”一章，我们将解构强公式的基石，学习如何为机组状态、启停转换、最小开[停时](@entry_id:261799)间及爬坡率等关键物理特性构建紧致的[线性约束](@entry_id:636966)。随后，在“应用与跨学科联系”一章，我们将视野拓宽至系统层面，探索这些原理如何应用于解决含网络约束的复杂问题，并揭示其与[运筹学](@entry_id:145535)、控制理论等领域的深刻联系。最后，通过“动手实践”部分，您将有机会亲手应用所学知识，巩固对这些强大建模技术的理解。让我们从构建这些高效模型的第一个砖块开始。

## 原理与机制

在机组组合 (Unit Commitment, UC) 问题的混合整数线性规划 (Mixed-Integer Linear Programming, MILP) 模型中，其计算性能在很大程度上取决于数学公式的“紧致性”(tightness)。一个紧致或“强”的公式，其[线性规划松弛](@entry_id:267116)（即将整数变量松弛为连续变量）的解能够非常接近原始整数问题的可行域。这可以显著减少分支定界算法的搜索空间，从而加快求解速度。本章将深入探讨构建强[机组组合公式](@entry_id:1133607)的核心原理和机制，从基本的状态与生产约束开始，逐步扩展到复杂的[时序约束](@entry_id:168640)和高级[有效不等式](@entry_id:170492)。

### 基[本构建模](@entry_id:183370)块：机组状态与生产的建模

构建任何[机组组合模型](@entry_id:1133608)的第一步是精确地描述[发电机](@entry_id:268282)组在每个时间段内的基本运行状态及其与功率输出之间的关系。

#### 核心离散选择：开机与关机

对于每个[发电机](@entry_id:268282)组，其在任意时刻 $t$ 的运行状态可以用一个二进制变量 $u_t \in \{0, 1\}$ 来描述。该变量称为**启停状态变量** (commitment status variable)，其中 $u_t=1$ 表示机组在该时段处于开机（在线）状态，而 $u_t=0$ 表示机组处于关机（离线）状态。

这一二[进制](@entry_id:634389)决策直接决定了机组的发电能力。物理现实是，一个离线的机组不能产生任何功率；而一个在线的机组，其功率输出 $p_t$ 必须维持在物理允许的[最小稳定出力](@entry_id:1127943) $P^{\min}$ 和最大技术出力 $P^{\max}$ 之间。我们可以将这种关系描述为一个离散选择：

- 若 $u_t = 0$，则 $p_t = 0$。
- 若 $u_t = 1$，则 $P^{\min} \le p_t \le P^{\max}$。

在 MILP 框架中，我们必须将这种“if-then”逻辑转化为一组[线性不等式](@entry_id:174297)。

#### [凸包](@entry_id:262864)与标准生产约束

一个看似简单的、用于连接 $p_t$ 和 $u_t$ 的方法是使用所谓的“[大M法](@entry_id:1121559)”(big-M method)。通过引入足够大的常数，我们可以将上述离散关系写成如下形式的[线性约束](@entry_id:636966)：

$P^{\min} u_t \le p_t \le P^{\max} u_t$

让我们验证这组不等式如何实现所需的逻辑 。

- 当机组关机时 ($u_t=0$)，不等式变为 $P^{\min} \cdot 0 \le p_t \le P^{\max} \cdot 0$，即 $0 \le p_t \le 0$。这精确地迫使功率输出 $p_t$ 为零。
- 当机组开机时 ($u_t=1$)，不等式变为 $P^{\min} \cdot 1 \le p_t \le P^{\max} \cdot 1$，即 $P^{\min} \le p_t \le P^{\max}$。这同样精确地施加了在线运行时的功率输出上下限。

这组不等式不仅在逻辑上是正确的，而且在数学上具有更深层的意义。在单个时间段内，可行点集 $(u_t, p_t)$ 由两部分组成：原点 $(0, 0)$ 和线段 $\{(1, p) \mid P^{\min} \le p \le P^{\max}\}$。这是一个非[凸集](@entry_id:155617)。在 MILP 的[线性规划松弛](@entry_id:267116)中，求解器探索的是该非[凸集](@entry_id:155617)所有可行点的**[凸包](@entry_id:262864)** (convex hull)。对于这个问题，凸包是由三个顶点 $(0,0)$, $(1, P^{\min})$, 和 $(1, P^{\max})$ 构成的三角形区域。上述不等式 $p_t \ge P^{\min} u_t$ 和 $p_t \le P^{\max} u_t$ 恰好精确地描述了这个三角形的边界。因此，这组约束是描述该单周期可行域的最紧致的线性松弛，是构建强公式的基石。

理解这一点对于深入认识“强公式”至关重要。例如，在一个简化的模型中，假设机组没有最小出力限制（即 $P^{\min}=0$），且需要满足一个给定的负荷需求 $L_t$，即 $p_t=L_t$。在包含正的开机成本的目标函数驱动下，优化器会寻求最小化 $u_t$。此时，约束 $p_t \le P^{\max} u_t$ 意味着 $u_t \ge p_t / P^{\max}$。优化器将选择 $u_t = p_t / P^{\max} = L_t / P^{\max}$。当负荷 $L_t$ 严格介于 $0$ 和 $P^{\max}$ 之间时， $u_t$ 将取一个分数，并且约束 $p_t = P^{\max} u_t$ 处于“紧束”状态（即等式成立）。这揭示了在松弛问题中，状态变量 $u_t$ 如何被“部分”开启以满足需求，以及强约束如何在这些分数解上依然有效。

### 状态转换的建模：启动与停机

机组的运行状态不仅在单个时间段内受到约束，其在不同时间段之间的转换也必须遵循逻辑规则，并常常伴随着成本。这就需要引入额外的变量来显式地表示**启动** (start-up) 和**停机** (shut-down) 事件。

#### 定义转换事件

我们引入两个新的[二进制变量](@entry_id:162761)：
- **启动[指示变量](@entry_id:266428)** $v_t \in \{0,1\}$：当机组在时段 $t$ 启动时（即从 $t-1$ 的关机状态转换到 $t$ 的开机状态），$v_t=1$，否则为 $0$。
- **停机[指示变量](@entry_id:266428)** $w_t \in \{0,1\}$：当机组在时段 $t$ 停机时（即从 $t-1$ 的开机状态转换到 $t$ 的关机状态），$w_t=1$，否则为 $0$。
（注：在某些文献中，启动变量可能表示为 $y_t$，停机变量表示为 $z_t$。为保持一致性，本章统一使用 $v_t$ 和 $w_t$）

这些事件与状态变量 $u_t$ 之间的关系可以通过分析 $u_t$ 的变化来确定：
- **启动**：$u_{t-1}=0$ 且 $u_t=1$。此时 $u_t - u_{t-1} = 1$。我们期望 $v_t=1, w_t=0$。
- **停机**：$u_{t-1}=1$ 且 $u_t=0$。此时 $u_t - u_{t-1} = -1$。我们期望 $v_t=0, w_t=1$。
- **状态不变**：$u_t = u_{t-1}$。此时 $u_t - u_{t-1} = 0$。我们期望 $v_t=0, w_t=0$。

#### 状态转换的强公式

一种常见的、但相对较弱的建模方式是使用不等式，例如 $v_t \ge u_t - u_{t-1}$ 和 $w_t \ge u_{t-1} - u_t$。这种方式虽然在有相应成本时能确保优化器做出正确选择，但其线性松弛较弱。

一个更强的公式使用单个等式来捕捉状态变化与事件[指示变量](@entry_id:266428)之间的关系 ：

$u_t - u_{t-1} = v_t - w_t$

这个简洁的等式几乎完美地描述了所有情况。然而，仅有这个等式是不够的。当机组状态不变时 ($u_t - u_{t-1} = 0$)，该等式简化为 $v_t = w_t$。由于 $v_t$ 和 $w_t$ 是[二进制变量](@entry_id:162761)，这允许多个解：$(v_t, w_t)=(0,0)$ 和 $(v_t, w_t)=(1,1)$。后者意味着机组在同一时段内既启动又停机，这在物理上是无意义的，并且违反了变量的定义。

为了排除这种不合逻辑的解，并进一步加强公式，我们必须引入一个**[互斥](@entry_id:752349)约束** (mutual exclusivity constraint) ：

$v_t + w_t \le 1$

这个不等式明确指出，一个机组在任何单个离散时间段内，最多只能发生一个转换事件：要么是启动，要么是停机，但绝不能两者都是。当 $u_t = u_{t-1}$ 时，等式 $v_t = w_t$ 和不等式 $v_t+w_t \le 1$ 结合起来，唯一允许的整数解就是 $(v_t, w_t) = (0,0)$。这套约束组合 ($u_t - u_{t-1} = v_t - w_t$ 和 $v_t + w_t \le 1$) 提供了一个关于状态转换的逻辑完备且紧致的线性描述。

### [时序约束](@entry_id:168640)：强制执行物理限制

除了静态的生产限制和逻辑转换，[发电机](@entry_id:268282)组的运行还受到一系列动态的、跨时间的物理限制。强公式对于精确和高效地建模这些[时序约束](@entry_id:168640)至关重要。

#### 最小开[停时](@entry_id:261799)间

火电机组等设备由于[热应力](@entry_id:180613)和机械损耗，启动后必须连续运行一段时间，停机后也必须保持离线状态一段时间。这些限制分别被称为**最小开机时间** ($T^{\mathrm{up}}$) 和**最小停机时间** ($T^{\mathrm{down}}$)。

- **最小开机时间 ($T^{\mathrm{up}}$)**：如果机组在时段 $t$ 启动 ($v_t=1$)，它必须在接下来的 $T^{\mathrm{up}}$ 个连续时段（包括 $t$）内保持开机状态。

一个强大且被广泛应用的建模方法是使用一个聚合不等式来表达这一逻辑 ：

$\sum_{\tau=t}^{t+T^{\mathrm{up}}-1} u_{\tau} \ge T^{\mathrm{up}} v_t$

这个不等式对于 $t \in \{1, \dots, T - T^{\mathrm{up}} + 1\}$ 成立。其逻辑如下：如果 $v_t=1$，不等式右侧为 $T^{\mathrm{up}}$，左侧是对未来 $T^{\mathrm{up}}$ 个时段内开机状态变量 $u_{\tau}$ 的求和。由于每个 $u_{\tau}$ 最大为 $1$，要使这个和达到或超过 $T^{\mathrm{up}}$，唯一的可能是所有这些 $u_{\tau}$ 都等于 $1$。这恰好强制了机组在启动后的 $T^{\mathrm{up}}$ 个时段内连续运行。如果 $v_t=0$，不等式变为 $\sum u_{\tau} \ge 0$，这是一个平凡的、非限制性的条件。

- **最小停机时间 ($T^{\mathrm{down}}$)**：对称地，如果机组在时段 $t$ 停机 ($w_t=1$)，它必须在接下来的 $T^{\mathrm{down}}$ 个连续时段内保持关机状态。

我们可以用类似的方式推导出其强公式 。注意到关机状态 $u_{\tau}=0$ 等价于 $(1 - u_{\tau}) = 1$。因此，强约束为：

$\sum_{\tau=t}^{t+T^{\mathrm{down}}-1} (1 - u_{\tau}) \ge T^{\mathrm{down}} w_t$

这个不等式对于 $t \in \{1, \dots, T - T^{\mathrm{down}} + 1\}$ 成立。其解释与最小开机时间约束完全对称。

#### [爬坡约束](@entry_id:1130532)

机组的功率输出不能瞬间改变，而是受到物理的**爬坡速率** (ramping rate) 限制。我们需要区分正常运行时的爬坡和启停过程中的特殊爬坡能力。相关参数包括：
- $R^u$: 正常运行时（连续在线）的最大向上爬坡速率。
- $R^d$: 正常运行时（连续在线）的最大向下爬坡速率。
- $SU$: 启动时，机组能达到的最大出力（可视为从 $0$ 开始的“爬坡”）。
- $SD$: 停机前，机-组必须降至的最低出力（可视为降至 $0$ 的“爬坡”）。

一个强健的[爬坡约束](@entry_id:1130532)公式必须能精确处理所有四种状态转换情况：连续在线、启动、停机和连续离线。通过仔细分析，我们可以推导出以下这对强有效的[爬坡约束](@entry_id:1130532) ：

1.  **向上爬坡与启动**：$p_t - p_{t-1} \le R^u u_{t-1} + SU v_t$
2.  **向下爬坡与停机**：$p_{t-1} - p_t \le R^d u_t + SD w_t$

让我们分析第一个不等式。
- **连续在线** ($u_{t-1}=1, u_t=1, v_t=0$)：不等式变为 $p_t - p_{t-1} \le R^u \cdot 1 + SU \cdot 0 = R^u$，正确施加了正常[爬坡限制](@entry_id:1130533)。
- **启动** ($u_{t-1}=0, u_t=1, v_t=1$)：由于 $p_{t-1}=0$，不等式变为 $p_t \le R^u \cdot 0 + SU \cdot 1 = SU$，正确施加了启动出力限制。
- **停机** ($u_{t-1}=1, u_t=0, v_t=0, w_t=1$)：由于 $p_t=0$，不等式变为 $-p_{t-1} \le R^u \cdot 1 + SU \cdot 0 = R^u$，即 $p_{t-1} \ge -R^u$，这是一个非限制性条件。
- **连续离线** ($u_{t-1}=0, u_t=0, v_t=0$)：$p_t=0, p_{t-1}=0$，不等式变为 $0 \le 0$，也是一个非限制性条件。

第二个不等式也可以通过类似的对称分析得到验证。这对不等式通过状态和转换变量的巧妙组合，为每种情况激活了正确的物理限制，从而形成了一个紧致而完备的爬坡模型。

### 用于加强公式的高级技术

除了上述基本和时序约束的标准强公式外，研究人员还开发了许多更高级的技术来进一步收紧[线性规划松弛](@entry_id:267116)，这些技术通常以“[有效不等式](@entry_id:170492)”(valid inequalities) 或“[割平面](@entry_id:177960)”(cutting planes) 的形式出现。

#### 加强成本公式：视角重构

机组的发电成本通常是其功率输出 $p_t$ 的一个[非线性](@entry_id:637147)（通常是凸的）函数。在 MILP 中，这通常被近似为[分段线性函数](@entry_id:273766)。假设成本函数 $\hat{C}(p_t)$ 是一个凸[分段线性函数](@entry_id:273766)，一个简单的建模方法是使用[大M法](@entry_id:1121559)来关联成本变量 $y_t$：

$y_t \ge \hat{C}(p_t) - M(1-u_t)$

当 $u_t=1$ 时，它正确地强制 $y_t \ge \hat{C}(p_t)$；当 $u_t=0$ 时，它变为 $y_t \ge \hat{C}(p_t) - M$，这在 $M$ 足够大时是一个非限制性条件。然而，这种建模方式的线性松弛非常弱。

一个更强大的技术是**视角重构** (perspective reformulation)。对于一个凸函数 $\hat{C}(x)$，其视角函数是 $u \hat{C}(x/u)$。我们可以证明，如果 $\hat{C}$ 是凸的，其视角函数也是凸的。我们可以用以下不等式来描述视角函数的上镜图 (epigraph)：

$y_t \ge u_t \hat{C}(p_t/u_t)$

如果 $\hat{C}(p_t)$ 是一个由多个线性段 $\alpha_k + d_k p_t$ 的最大值定义的[分段线性函数](@entry_id:273766)，那么视角重构可以转化为一组[线性不等式](@entry_id:174297) ：

$y_t \ge d_k p_t + \alpha_k u_t \quad \forall k$

其中 $k$ 遍历所有线性分段。这个公式的线性松弛比[大M法](@entry_id:1121559)紧得多。例如，对于一个具有两段成本曲线的机组，在松弛解 $(u_t, p_t) = (0.5, 50)$ 处，[大M法](@entry_id:1121559)可能给出一个非常弱（甚至为负）的成本下界，而视角重构法则能给出一个严格的正下界（例如 $1500$），这个下界等于在机组半开状态下，以两倍的功率水平 ($p_t/u_t = 100$) 运行并分摊成本的结果。这大大提高了模型求解的效率。

#### 从整数性中生成[割平面](@entry_id:177960)：混合整数取整 (MIR)

**混合整数取整** (Mixed Integer Rounding, MIR) 是一类强大的通用技术，它利用变量的整数性从现有约束中推导出新的、更强的[有效不等式](@entry_id:170492)。

考虑一个简单的例子：一个机组除了提供能量 $p_t$ 外，还提供备用 $s_t$，两者共享机组容量 $\overline{P}$。这可以表示为一个背包型约束：$p_t + s_t \le \overline{P} u_t$。同时，机组有最小的能量和备用义务：$p_t \ge D$ 和 $s_t \ge S$。

将这三个约束结合起来，我们得到 $D+S \le p_t+s_t \le \overline{P}u_t$，这在松弛问题中意味着 $u_t \ge (D+S)/\overline{P}$。例如，如果 $\overline{P}=5, D=3.2, S=1.1$，那么 $u_t \ge 4.3/5 = 0.86$。这个分数解在松弛问题中是可行的。

然而，我们知道 $u_t$ 必须是一个整数（$0$ 或 $1$）。如果一个整数变量必须大于等于一个数，那么它也必须大于等于这个数的向上取整。利用这个简单的原理，我们可以生成一个MIR[割平面](@entry_id:177960) ：

$u_t \ge \left\lceil \frac{D+S}{\overline{P}} \right\rceil$

在我们的例子中，这变成了 $u_t \ge \lceil 0.86 \rceil = 1$。这个新的不等式 $u_t \ge 1$ 切掉了原先可行的分数解 $u_t=0.86$，从而收紧了可行域，帮助求解器更快地找到整数解。

#### [多面体](@entry_id:637910)视角：二[进制](@entry_id:634389)序列[多胞体](@entry_id:635589)

最后，我们可以从一个更理论化的视角来统一理解这些强约束，即**[多面体](@entry_id:637910)理论**。对于单个机组，所有满足状态转换和最小开[停时](@entry_id:261799)间约束的二[进制](@entry_id:634389)序列 $(u, v, w)$ 的集合，其凸包形成一个几何对象，称为**二[进制](@entry_id:634389)序列[多胞体](@entry_id:635589)** (binary sequence polytope)。

一个深刻的理论结果是，这个多胞体可以由一组特定的线性不等式精确描述。除了基本的状态转换等式和变量边界外，其关键构件是两组“窗口求和”不等式 ：

$\sum_{k=\max(1,\,t-L+1)}^{t} v_k \le u_t$

$\sum_{k=\max(1,\,t-\ell+1)}^{t} w_k \le 1 - u_t$

（注：此处变量定义与问题  略有调整以与本章保持一致，$v_t$ 为启动，$w_t$ 为停机，$u_t$ 为状态）

第一个不等式的含义是：如果一个机组在时段 $t$ 处于开机状态 ($u_t=1$)，那么在过去 $L$ 个时段内，它最多只能启动一次。第二个不等式的含义是：如果一个机组在时段 $t$ 处于关机状态 ($u_t=0$)，那么在过去 $\ell$ 个时段内，它最多只能停机一次。这些看似简单的约束，与基础的状态转换约束相结合，被证明足以描述整个复杂组合问题的[凸包](@entry_id:262864)。这为我们之前推导的针对最小开[停时](@entry_id:261799)间的强公式提供了坚实的理论基础，并展示了强公式的终极目标：找到描述整数[可行解](@entry_id:634783)集的凸包的精确[线性表示](@entry_id:139970)。