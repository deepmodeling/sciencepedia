{
    "hands_on_practices": [
        {
            "introduction": "这个练习将安全约束机组组合 (SCUC) 问题分解为其核心组成部分。通过给定一个固定的机组启停计划，您将专注于求解经济调度子问题：在满足系统需求和备用要求的前提下，如何以最低的成本分配各运行机组的出力。这个练习旨在帮助您掌握 SCUC 的基本成本核算与优化逻辑，这是理解更复杂算法的基石 ()。",
            "id": "4123128",
            "problem": "考虑一个包含三个火力发电机组、跨越四个小时周期的安全约束机组组合（SCUC）实例。安全性由固定的旋转备用需求来表示。其基础是标准的SCUC目标和约束：在满足电量平衡、容量限制和备用充足性的前提下，最小化总运行成本，其中包含二进制的启停状态和启动/关停指标。令 $i \\in \\{1,2,3\\}$ 为机组索引，$t \\in \\{1,2,3,4\\}$ 为时间周期索引。定义二进制启停变量 $u_{i,t} \\in \\{0,1\\}$，启动指标 $v_{i,t} \\in \\{0,1\\}$，关停指标 $w_{i,t} \\in \\{0,1\\}$，以及实时出力 $p_{i,t} \\ge 0$。经典的SCUC动态关系成立：对于所有的 $i,t$，有 $u_{i,t} - u_{i,t-1} = v_{i,t} - w_{i,t}$，其中初始启停状态 $u_{i,0}$ 是给定的。每台机组有最小和最大出力 $P^{\\min}_{i}$ 和 $P^{\\max}_{i}$，当 $u_{i,t}=1$ 时的空载成本 $F_{i}$（美元/小时），当 $v_{i,t}=1$ 时的启动成本 $S_{i}$（美元），以及线性边际电能成本 $c_{i}$（美元/兆瓦时，MWh）。周期 $t$ 的系统需求为 $D_{t}$，旋转备用需求为 $R_{t}$，其解释为可用裕度，满足 $\\sum_{i} \\left(u_{i,t} P^{\\max}_{i} - p_{i,t}\\right) \\ge R_{t}$。\n\n数据：\n- 机组 $1$：$P^{\\min}_{1} = 80$, $P^{\\max}_{1} = 200$, $F_{1} = 2000$, $S_{1} = 6000$, $c_{1} = 15$。\n- 机组 $2$：$P^{\\min}_{2} = 50$, $P^{\\max}_{2} = 150$, $F_{2} = 1500$, $S_{2} = 4000$, $c_{2} = 20$。\n- 机组 $3$：$P^{\\min}_{3} = 30$, $P^{\\max}_{3} = 100$, $F_{3} = 1000$, $S_{3} = 3000$, $c_{3} = 40$。\n- $t=0$ 时的初始启停状态：$u_{1,0} = 1$, $u_{2,0} = 0$, $u_{3,0} = 0$。\n- 需求：$D_{1} = 280$, $D_{2} = 380$, $D_{3} = 240$, $D_{4} = 350$。\n- 旋转备用需求：$R_{t} = 50$ 对所有 $t$。\n\n给出了一个启停计划以及启动/关停指标：\n- 启停状态 $u_{i,t}$：\n  - $t=1$：$u_{1,1} = 1$, $u_{2,1} = 1$, $u_{3,1} = 0$。\n  - $t=2$：$u_{1,2} = 1$, $u_{2,2} = 1$, $u_{3,2} = 1$。\n  - $t=3$：$u_{1,3} = 1$, $u_{2,3} = 0$, $u_{3,3} = 1$。\n  - $t=4$：$u_{1,4} = 1$, $u_{2,4} = 1$, $u_{3,4} = 1$。\n- 启动 $v_{i,t}$ 和关停 $w_{i,t}$：\n  - $t=1$：$v_{2,1} = 1$，所有其他 $v_{i,1} = 0$，所有 $w_{i,1} = 0$。\n  - $t=2$：$v_{3,2} = 1$，所有其他 $v_{i,2} = 0$，所有 $w_{i,2} = 0$。\n  - $t=3$：$w_{2,3} = 1$，所有其他 $w_{i,3} = 0$，所有 $v_{i,3} = 0$。\n  - $t=4$：$v_{2,4} = 1$，所有其他 $v_{i,4} = 0$，所有 $w_{i,4} = 0$。\n\n给出了一个初始出力计划 $p_{i,t}$（所有量纲均为兆瓦，MW）：\n- $t=1$：$p_{1,1} = 150$, $p_{2,1} = 130$, $p_{3,1} = 0$。\n- $t=2$：$p_{1,2} = 170$, $p_{2,2} = 150$, $p_{3,2} = 60$。\n- $t=3$：$p_{1,3} = 160$, $p_{2,3} = 0$, $p_{3,3} = 80$。\n- $t=4$：$p_{1,4} = 180$, $p_{2,4} = 130$, $p_{3,4} = 40$。\n\n任务：\n1. 使用基本的SCUC目标定义，计算给定初始出力在四个周期内的总运行成本，包括空载和启动部分，但不包括任何关停成本。周期 $t$ 的成本为 $\\sum_{i} \\left(F_{i} u_{i,t} + S_{i} v_{i,t} + c_{i} p_{i,t}\\right)$，总成本是 $t=1,2,3,4$ 的总和。\n2. 对每个周期，找出成本最小化的出力 $p^{\\star}_{i,t}$，需满足约束：当 $u_{i,t} = 1$ 时 $P^{\\min}_{i} \\le p_{i,t} \\le P^{\\max}_{i}$，当 $u_{i,t} = 0$ 时 $p_{i,t} = 0$，$ \\sum_{i} p_{i,t} = D_{t}$，以及旋转备用裕度约束 $\\sum_{i} \\left(u_{i,t} P^{\\max}_{i} - p_{i,t}\\right) \\ge R_{t}$。不适用爬坡或最小启停时间约束。仅使用给定的启停状态 $u_{i,t}$ 和指标 $v_{i,t}, w_{i,t}$；不要更改启停计划。计算使用此成本最小化出力在四个周期内的最小总运行成本，包括空载和启动部分，但不包括关停成本。\n\n将所有四个周期的最小总运行成本作为最终答案。将您的答案四舍五入到四位有效数字。以美元（USD）表示最终成本。",
            "solution": "用户希望针对一个固定的启停计划求解一个安全约束经济调度问题，并计算最小总运行成本。首先对问题的内部一致性和科学合理性进行验证。\n\n### 问题验证\n\n**第1步：提取给定条件**\n- **机组数据**:\n  - 机组 1: $P^{\\min}_{1} = 80$ MW, $P^{\\max}_{1} = 200$ MW, $F_{1} = \\$2000$/h, $S_{1} = \\$6000$, $c_{1} = \\$15$/MWh。\n  - 机组 2: $P^{\\min}_{2} = 50$ MW, $P^{\\max}_{2} = 150$ MW, $F_{2} = \\$1500$/h, $S_{2} = \\$4000$, $c_{2} = \\$20$/MWh。\n  - 机组 3: $P^{\\min}_{3} = 30$ MW, $P^{\\max}_{3} = 100$ MW, $F_{3} = \\$1000$/h, $S_{3} = \\$3000$, $c_{3} = \\$40$/MWh。\n- **初始状态 ($t=0$)**: $u_{1,0} = 1$, $u_{2,0} = 0$, $u_{3,0} = 0$。\n- **需求 ($D_t$)**: $D_{1} = 280$ MW, $D_{2} = 380$ MW, $D_{3} = 240$ MW, $D_{4} = 350$ MW。\n- **备用 ($R_t$)**: $R_{t} = 50$ MW 对于 $t \\in \\{1,2,3,4\\}$。\n- **给定启停状态 ($u_{i,t}$)**:\n  - $t=1$: $\\{u_{1,1}, u_{2,1}, u_{3,1}\\} = \\{1, 1, 0\\}$\n  - $t=2$: $\\{u_{1,2}, u_{2,2}, u_{3,2}\\} = \\{1, 1, 1\\}$\n  - $t=3$: $\\{u_{1,3}, u_{2,3}, u_{3,3}\\} = \\{1, 0, 1\\}$\n  - $t=4$: $\\{u_{1,4}, u_{2,4}, u_{3,4}\\} = \\{1, 1, 1\\}$\n- **给定指标 ($v_{i,t}, w_{i,t}$)**:\n  - $t=1$: $v_{2,1} = 1$。其他为 $0$。\n  - $t=2$: $v_{3,2} = 1$。其他为 $0$。\n  - $t=3$: $w_{2,3} = 1$。其他为 $0$。\n  - $t=4$: $v_{2,4} = 1$。其他为 $0$。\n- **给定出力 ($p_{i,t}$)**: (这用于上下文和验证，不用于最终计算)。\n- **成本函数**: $t=1...4$ 的总成本为 $\\sum_{t=1}^4 \\sum_{i=1}^3 \\left(F_{i} u_{i,t} + S_{i} v_{i,t} + c_{i} p_{i,t}\\right)$。\n- **动态规则**: $u_{i,t} - u_{i,t-1} = v_{i,t} - w_{i,t}$。\n\n**第2步：使用提取的给定条件进行验证**\n对问题的一致性进行验证。\n1.  **动态一致性**: 对所有机组和时间周期检查关系 $u_{i,t} - u_{i,t-1} = v_{i,t} - w_{i,t}$。例如，对于机组 $2$ 在 $t=1$ 时，$u_{2,1} - u_{2,0} = 1 - 0 = 1$。这与 $v_{2,1} - w_{2,1} = 1 - 0 = 1$ 相符。在 $t=3$ 时对于机组 $2$，$u_{2,3} - u_{2,2} = 0 - 1 = -1$，这与 $v_{2,3} - w_{2,3} = 0 - 1 = -1$ 相符。所有其他转换均已验证并发现一致。\n2.  **科学依据**: 该问题是一个标准的安全约束经济调度（SCED）问题，这是电力系统工程中一个基础且成熟的课题。\n3.  **适定性**: 该问题是适定的，有明确的目标函数和一组线性约束。给定的条件足以找到一个唯一且有意义的解。\n4.  **给定计划的可行性**: 对照所有约束（发电限制、需求平衡、备用需求）检查所提供的初始出力计划，发现是可行的，这证实了数据的自洽性。例如，在 $t=1$ 时，需求 $D_1=280$ MW 由 $p_{1,1}+p_{2,1}=150+130=280$ MW 满足。备用为 $(P^{\\max}_1-p_{1,1}) + (P^{\\max}_2-p_{2,1}) = (200-150)+(150-130)=70$ MW，大于所需的 $R_1=50$ MW。所有周期同样可行。\n\n**第3步：结论与行动**\n问题陈述是有效的。它科学合理、自洽且适定。将计算一个解。\n\n### 求解\n\n目标是计算给定启停计划下四个小时的最小总运行成本。总成本 $C_{\\text{total}}$ 是每个小时 $t$ 的成本之和：\n$$C_{\\text{total}} = \\sum_{t=1}^{4} \\left( \\sum_{i=1}^{3} (F_{i} u_{i,t} + S_{i} v_{i,t}) + \\sum_{i=1}^{3} c_{i} p_{i,t} \\right)$$\n由于启停计划 ($u_{i,t}$) 和启动决策 ($v_{i,t}$) 是给定的，空载 ($F_i$) 和启动 ($S_i$) 成本是固定的。为了最小化 $C_{\\text{total}}$，我们必须最小化可变电能成本部分，即 $\\sum_{t=1}^4 \\sum_{i=1}^3 c_i p_{i,t}$。由于没有跨时段的调度约束（如爬坡），我们可以独立地最小化每个小时的电能成本。这是每个小时的一个经典经济调度问题（EDP）。\n\n对于每个小时 $t$，我们求解：\n$$ \\min_{p_{i,t}} \\sum_{i=1}^{3} c_i p_{i,t} $$\n约束条件为：\n1.  电量平衡: $\\sum_{i=1}^{3} p_{i,t} = D_t$\n2.  发电限制: $u_{i,t} P^{\\min}_i \\le p_{i,t} \\le u_{i,t} P^{\\max}_i$ 对于 $i \\in \\{1,2,3\\}$\n3.  旋转备用: $\\sum_{i=1}^{3} (u_{i,t} P^{\\max}_i - p_{i,t}) \\ge R_t$\n\n旋转备用约束可以利用电量平衡约束重写为：$\\sum_{i=1}^{3} u_{i,t} P^{\\max}_i - D_t \\ge R_t$。这是对总承诺容量的检查，必须在调度前执行。\n\n边际成本为 $c_{1} = 15$, $c_{2} = 20$, and $c_{3} = 40$。调度的优先顺序（merit order）是机组1、机组2，然后是机组3。\n\n**最优调度计算**\n\n**周期 $t=1$**:\n- 启停机组: $\\{1, 2\\}$。需求 $D_1=280$。备用 $R_1=50$。\n- 容量检查: $P^{\\max}_1+P^{\\max}_2 = 200+150=350$ MW。需求: $D_1+R_1 = 280+50=330$ MW。$350 \\ge 330$，可行。\n- 调度: 将机组加载到最小出力: $p_{1,1}=80$, $p_{2,1}=50$。总计: $130$ MW。剩余需求: $280-130=150$ MW。\n- 从80加载最便宜的机组（机组1）到200: 增加 $120$ MW。剩余需求: $150-120=30$ MW。\n- 从50加载机组2: 增加 $30$ MW。\n- 最优调度: $p^{\\star}_{1,1}=200$, $p^{\\star}_{2,1}=80$。\n- 电能成本: $15 \\times 200 + 20 \\times 80 = 3000 + 1600 = \\$4600$。\n\n**周期 $t=2$**:\n- 启停机组: $\\{1, 2, 3\\}$。需求 $D_2=380$。备用 $R_2=50$。\n- 容量检查: $P^{\\max}_1+P^{\\max}_2+P^{\\max}_3=200+150+100=450$ MW。需求: $D_2+R_2 = 380+50=430$ MW。$450 \\ge 430$，可行。\n- 调度: 加载到最小出力: $p_{1,2}=80$, $p_{2,2}=50$, $p_{3,2}=30$。总计: $160$ MW。剩余需求: $380-160=220$ MW。\n- 从80加载机组1到200: 增加 $120$ MW。剩余需求: $220-120=100$ MW。\n- 从50加载机组2到150: 增加 $100$ MW。剩余需求: $100-100=0$ MW。\n- 机组3保持在最小出力。\n- 最优调度: $p^{\\star}_{1,2}=200$, $p^{\\star}_{2,2}=150$, $p^{\\star}_{3,2}=30$。\n- 电能成本: $15 \\times 200 + 20 \\times 150 + 40 \\times 30 = 3000 + 3000 + 1200 = \\$7200$。\n\n**周期 $t=3$**:\n- 启停机组: $\\{1, 3\\}$。需求 $D_3=240$。备用 $R_3=50$。\n- 容量检查: $P^{\\max}_1+P^{\\max}_3 = 200+100=300$ MW。需求: $D_3+R_3=240+50=290$ MW。$300 \\ge 290$，可行。\n- 调度: 加载到最小出力: $p_{1,3}=80$, $p_{3,3}=30$。总计: $110$ MW。剩余需求: $240-110=130$ MW。\n- 从80加载机组1到200: 增加 $120$ MW。剩余需求: $130-120=10$ MW。\n- 从30加载机组3: 增加 $10$ MW。\n- 最优调度: $p^{\\star}_{1,3}=200$, $p^{\\star}_{3,3}=40$。\n- 电能成本: $15 \\times 200 + 40 \\times 40 = 3000 + 1600 = \\$4600$。\n\n**周期 $t=4$**:\n- 启停机组: $\\{1, 2, 3\\}$。需求 $D_4=350$。备用 $R_4=50$。\n- 容量检查: $P^{\\max}_1+P^{\\max}_2+P^{\\max}_3=450$ MW。需求: $D_4+R_4=350+50=400$ MW。$450 \\ge 400$，可行。\n- 调度: 加载到最小出力: $p_{1,4}=80$, $p_{2,4}=50$, $p_{3,4}=30$。总计: $160$ MW。剩余需求: $350-160=190$ MW。\n- 从80加载机组1到200: 增加 $120$ MW。剩余需求: $190-120=70$ MW。\n- 从50加载机组2: 增加 $70$ MW。\n- 最优调度: $p^{\\star}_{1,4}=200$, $p^{\\star}_{2,4}=120$, $p^{\\star}_{3,4}=30$。\n- 电能成本: $15 \\times 200 + 20 \\times 120 + 40 \\times 30 = 3000 + 2400 + 1200 = \\$6600$。\n\n**总成本计算**\n\n最小总电能成本 = $\\$4600 + \\$7200 + \\$4600 + \\$6600 = \\$23000$。\n\n现在，我们计算固定成本（空载和启动）：\n- $t=1$: $F_1 u_{1,1} + F_2 u_{2,1} + S_2 v_{2,1} = 2000 + 1500 + 4000 = \\$7500$。\n- $t=2$: $F_1 u_{1,2} + F_2 u_{2,2} + F_3 u_{3,2} + S_3 v_{3,2} = 2000 + 1500 + 1000 + 3000 = \\$7500$。\n- $t=3$: $F_1 u_{1,3} + F_3 u_{3,3} = 2000 + 1000 = \\$3000$。\n- $t=4$: $F_1 u_{1,4} + F_2 u_{2,4} + F_3 u_{3,4} + S_2 v_{2,4} = 2000 + 1500 + 1000 + 4000 = \\$8500$。\n\n总固定成本 = $\\$7500 + \\$7500 + \\$3000 + \\$8500 = \\$26500$。\n\n最小总运行成本 = 总固定成本 + 最小总电能成本\n$$C^{\\star}_{\\text{total}} = \\$26500 + \\$23000 = \\$49500$$\n\n问题要求将答案四舍五入到四位有效数字。精确答案是 49500。表示为四位有效数字即为 $4.950 \\times 10^4$。",
            "answer": "$$\\boxed{4.950 \\times 10^{4}}$$"
        },
        {
            "introduction": "在掌握了基本的经济调度后，本练习将引入 SCUC 中的关键元素——“安全约束” ()。您将使用直流 (DC) 潮流模型中的功率传输分布因子 (PTDF) 来分析输电网络对发电机组出力的影响。通过这个练习，您将亲手计算潮流并确定系统因网络热极限而产生的运行边界，从而深入理解安全约束的物理意义。",
            "id": "4123136",
            "problem": "考虑在直流 (DC) 潮流近似下的一个基本安全约束机组组合 (SCUC) 情景。一个三母线系统的母线索引为 $1,2,3$，其中母线 $3$ 被指定为平衡母线。设关于平衡母线 $3$ 的功率传输分布因子 (PTDF) 矩阵表示为 $H \\in \\mathbb{R}^{3 \\times 3}$，它通过 $f = H p$ 将节点净注入功率 $p \\in \\mathbb{R}^{3}$ 映射到线路潮流 $f \\in \\mathbb{R}^{3}$。$H$ 的三行按顺序分别对应有向线路 $\\ell \\in \\{(1,2),(2,3),(1,3)\\}$，其中正向潮流定义为从第一个母线流向第二个母线。列对应于母线 $\\{1,2,3\\}$，并且 $H$ 满足标准的平衡母线 PTDF 属性，即每行之和为零。PTDF 矩阵为\n$$\nH \\;=\\;\n\\begin{pmatrix}\n0.6  -0.3  -0.3 \\\\\n0.2  \\phantom{-}0.7  -0.9 \\\\\n-0.8  -0.4  \\phantom{-}1.2\n\\end{pmatrix}.\n$$\n母线 $(1,2,3)$ 上的基本发电机出力为 $g = (100,\\,50,\\,20)$（单位 $\\mathrm{MW}$），固定母线负荷为 $d=(80,\\,60,\\,30)$（单位 $\\mathrm{MW}$）。三条有向线路 $\\{(1,2),(2,3),(1,3)\\}$ 的热稳定极限（单位 $\\mathrm{MW}$）由 $F^{\\max} = (50,\\,40,\\,60)$ 给出。假设所有发电机出力通过一个非负标量 $\\alpha \\ge 0$ 进行均匀缩放，因此计划发电量变为 $\\alpha g$。净注入功率为 $p(\\alpha) = \\alpha g - d + s(\\alpha)e_3$，其中 $e_3$ 是母线 $3$ 处的单位向量，$s(\\alpha)$ 是母线 $3$ 处的平衡母线平衡注入功率，以满足 $\\sum_{n=1}^{3} p_n(\\alpha)=0$。\n\n仅使用直流潮流和 PTDF 定义作为基本出发点，执行以下操作：\n- 对于 $\\ell \\in \\{(1,2),(2,3),(1,3)\\}$，推导出线路潮流 $f_{\\ell}(\\alpha)$ 作为 $\\alpha$ 的显式线性函数。\n- 对所有三条线路施加基本情况下的热稳定约束 $|f_{\\ell}(\\alpha)| \\le F^{\\max}_{\\ell}$，以确定上确界可行均匀缩放因子 $\\alpha^{\\star} \\ge 0$，使得所有三条线路的热稳定极限同时得到满足。\n\n以最简分数形式给出 $\\alpha^{\\star}$ 的精确值作为最终答案。最终答案是无量纲的（没有单位）。不要四舍五入；不要包含单位。",
            "solution": "问题的目标是找到最大可行缩放因子 $\\alpha^\\star$。这是一个上确界值。我们将通过从三个线路潮流限制中分别找出对 $\\alpha$ 的约束，然后确定满足所有约束的最大的 $\\alpha \\ge 0$ 来求解。\n\n**第 1 步：计算平衡母线注入功率 $s(\\alpha)$**\n根据系统功率平衡（即所有节点净注入功率之和为零 $\\sum_n p_n(\\alpha) = 0$）来计算平衡母线注入功率 $s(\\alpha)$。\n节点 $n$ 的净注入功率为 $p_n(\\alpha) = \\alpha g_n - d_n$（对于 $n=1,2$）和 $p_3(\\alpha) = \\alpha g_3 - d_3 + s(\\alpha)$。\n它们的和为 $\\sum_{n=1}^{3} p_n(\\alpha) = \\sum_{n=1}^{3} (\\alpha g_n - d_n) + s(\\alpha) = 0$。\n因此，$\\alpha \\sum g_n - \\sum d_n + s(\\alpha) = 0$。\n给定发电机出力 $g = (100, 50, 20)$，总出力 $\\sum g_n = 100+50+20 = 170$ MW。\n给定负荷 $d = (80, 60, 30)$，总负荷 $\\sum d_n = 80+60+30 = 170$ MW。\n代入这些值，得到 $\\alpha (170) - 170 + s(\\alpha) = 0$，解得 $s(\\alpha) = 170 - 170\\alpha = 170(1-\\alpha)$。\n\n**第 2 步：推导线路潮流作为 $\\alpha$ 的函数**\n首先，确定净注入功率向量 $p(\\alpha) = \\alpha g - d + s(\\alpha)e_3$：\n$p_1(\\alpha) = 100\\alpha - 80$\n$p_2(\\alpha) = 50\\alpha - 60$\n$p_3(\\alpha) = 20\\alpha - 30 + s(\\alpha) = 20\\alpha - 30 + 170(1-\\alpha) = 140 - 150\\alpha$\n验证总和：$(100\\alpha - 80) + (50\\alpha - 60) + (140 - 150\\alpha) = 0$。\n所以，净注入功率向量为 $p(\\alpha) = \\begin{pmatrix} 100\\alpha - 80 \\\\ 50\\alpha - 60 \\\\ 140 - 150\\alpha \\end{pmatrix}$。\n\n接下来，利用 $f(\\alpha) = H p(\\alpha)$ 计算线路潮流：\n$f(\\alpha) = \\begin{pmatrix} 0.6  -0.3  -0.3 \\\\ 0.2  0.7  -0.9 \\\\ -0.8  -0.4  1.2 \\end{pmatrix} \\begin{pmatrix} 100\\alpha - 80 \\\\ 50\\alpha - 60 \\\\ 140 - 150\\alpha \\end{pmatrix}$。\n各条线路的潮流 $f_\\ell(\\alpha)$ 计算如下：\n$f_{(1,2)}(\\alpha) = 0.6(100\\alpha - 80) - 0.3(50\\alpha - 60) - 0.3(140 - 150\\alpha) = 90\\alpha - 72$。\n$f_{(2,3)}(\\alpha) = 0.2(100\\alpha - 80) + 0.7(50\\alpha - 60) - 0.9(140 - 150\\alpha) = 190\\alpha - 184$。\n$f_{(1,3)}(\\alpha) = -0.8(100\\alpha - 80) - 0.4(50\\alpha - 60) + 1.2(140 - 150\\alpha) = -280\\alpha + 256$。\n这完成了第一项任务。\n\n**第 3 步：施加热稳定约束并求解 $\\alpha^{\\star}$**\n对三条线路施加约束 $|f_\\ell(\\alpha)| \\le F^{\\max}_\\ell$，其中 $F^{\\max} = (50, 40, 60)$。\n\n1. 线路 $(1,2)$: $|90\\alpha - 72| \\le 50$\n$\\implies -50 \\le 90\\alpha - 72 \\le 50$\n$\\implies 22 \\le 90\\alpha \\le 122$\n$\\implies 11/45 \\le \\alpha \\le 61/45$。\n\n2. 线路 $(2,3)$: $|190\\alpha - 184| \\le 40$\n$\\implies -40 \\le 190\\alpha - 184 \\le 40$\n$\\implies 144 \\le 190\\alpha \\le 224$\n$\\implies 72/95 \\le \\alpha \\le 112/95$。\n\n3. 线路 $(1,3)$: $|-280\\alpha + 256| \\le 60$\n$\\implies -60 \\le -280\\alpha + 256 \\le 60$\n$\\implies -316 \\le -280\\alpha \\le -196$\n$\\implies 196/280 \\le \\alpha \\le 316/280$\n$\\implies 7/10 \\le \\alpha \\le 79/70$。\n\n为使所有三个约束同时满足，$\\alpha$ 必须位于这三个区间的交集内。同时，$\\alpha \\ge 0$。\n可行区间为：\n$[\\max(11/45, 72/95, 7/10), \\min(61/45, 112/95, 79/70)]$。\n下界为 $\\max(11/45, 72/95, 7/10) = 72/95$（约为 $0.758$）。\n上界为 $\\min(61/45, 112/95, 79/70) = 79/70$（约为 $1.129$）。\n因此，$\\alpha$ 的可行范围是 $[72/95, 79/70]$。\n所求的上确界可行缩放因子 $\\alpha^{\\star}$ 是此可行范围的最大值。\n$\\alpha^{\\star} = 79/70$。\n该分数为最简形式。",
            "answer": "$$\\boxed{\\frac{79}{70}}$$"
        },
        {
            "introduction": "这个综合性练习将物理约束与经济结果联系起来，揭示了安全约束在电力市场中的核心作用 ()。当输电网络发生拥堵时，电价会在不同位置产生差异，形成节点边际电价 (LMP)。您将从基本原理出发，推导并计算LMP和相关的拥堵租金，从而理解SCUC优化结果背后深刻的经济内涵。",
            "id": "4123071",
            "problem": "考虑一个用于安全约束机组组合（SCUC）和安全约束经济调度（SCED）的三节点输电网络的直流（DC）近似模型。节点标记为$1$、$2$和$3$，其中节点$1$被指定为平衡（参考）节点，即其相角固定为$0$。网络拓扑是辐射状的：节点$1$连接到节点$2$，节点$2$连接到节点$3$。串联电抗相同且为正，直流模型假设潮流是线性的，相角差很小，且线路是无损的。\n\n存在一个被监测的输电约束：线路 $(2 \\rightarrow 3)$ 上的有功功率潮流必须满足 $F_{23} \\leq F_{23}^{\\max}$，方向为从节点$2$到节点$3$的正方向。该限制为 $F_{23}^{\\max} = 60$ MW。在此场景中，线路 $(1 \\rightarrow 2)$ 没有紧约束。\n\n在每个节点 $i \\in \\{1,2,3\\}$ 处，都有一台具有线性边际成本 $c_i$ 和充足容量（没有发电限制是紧约束）的常规发电机。边际成本按 $c_1  c_2  c_3$ 的顺序排列，具体数值为 $c_1 = 10 \\text{ \\$/MWh}$，$c_2 = 20 \\text{ \\$/MWh}$，$c_3 = 40 \\text{ \\$/MWh}$。存在单周期需求：$d_1 = 0$ MW，$d_2 = 0$ MW，$d_3 = 100$ MW。在此单周期案例中，爬坡和机组组合二进制变量不是紧约束。\n\n使用直流潮流基础知识和功率转移分布因子（PTDF）的定义，推导出每个节点的节点边际电价（LMP）。线路 $(2 \\rightarrow 3)$ 的PTDF定义为：当节点 $i$ 处有增量注入，同时由平衡节点$1$处等量取出以达到平衡时，$F_{23}$ 的灵敏度。令 $\\mu_{23} \\geq 0$ 表示与上限 $F_{23} \\leq F_{23}^{\\max}$ 相关的拉格朗日乘子（对偶变量）。假设 $F_{23}$ 的下限不是紧约束。\n\n从基本原理出发，建立直流模型下的SCED问题，推导Karush–Kuhn–Tucker（KKT）条件，识别紧约束，并使用PTDF和线路约束的对偶变量计算节点LMP $\\text{LMP}_1$、$\\text{LMP}_2$和$\\text{LMP}_3$。然后将节点电价差异解释为拥塞引起的价格分离，并计算在线路 $(2 \\rightarrow 3)$ 上收取的总拥塞租金。\n\n将每个LMP四舍五入到四位有效数字，并以 $\\text{\\$/MWh}$ 为单位表示。将拥塞租金四舍五入到四位有效数字，并以 $\\text{\\$/h}$ 为单位表示。按顺序 $\\left(\\text{LMP}_1, \\text{LMP}_2, \\text{LMP}_3, R\\right)$ 报告您的最终数值结果，其中 $R$ 是线路 $(2 \\rightarrow 3)$ 上的拥塞租金。",
            "solution": "该问题要求在一个安全约束经济调度（SCED）框架下，计算三个节点的节点边际电价（LMP）和一条输电线路上的拥塞租金。分析过程将首先建立优化问题模型，然后使用给定的直流近似推导潮流约束，接着使用Karush-Kuhn-Tucker（KKT）条件求解该问题，最后根据求解结果计算LMP和拥塞租金。\n\n首先，我们验证问题陈述。\n\n### 第1步：提取已知条件\n- **网络**：三节点直流网络，节点标记为$1$、$2$、$3$。\n- **平衡节点**：节点$1$是参考节点，其相角 $\\theta_1 = 0$。\n- **拓扑**：辐射状连接：线路 $(1,2)$ 和线路 $(2,3)$。\n- **线路参数**：串联电抗相同且为正，我们用 $x  0$ 表示电抗。电纳为 $b = 1/x$。\n- **约束**：线路 $(2 \\rightarrow 3)$ 上的功率潮流受限于 $F_{23} \\leq F_{23}^{\\max}$。\n- **潮流限制**：$F_{23}^{\\max} = 60$ MW。\n- **发电机成本**：边际成本为 $c_1 = 10 \\text{ \\$/MWh}$，$c_2 = 20 \\text{ \\$/MWh}$，$c_3 = 40 \\text{ \\$/MWh}$。\n- **需求**：单周期需求为 $d_1 = 0$ MW，$d_2 = 0$ MW，$d_3 = 100$ MW。\n- **对偶变量**：$\\mu_{23} \\geq 0$ 是线路约束的拉格朗日乘子。\n\n### 第2步：使用提取的已知条件进行验证\n这是一个经典且定义明确的SCED问题。\n- **科学依据**：该问题使用了直流潮流模型，这是电力系统分析中用于运行规划的一个标准和基础工具。LMP、PTDF和KKT条件的概念是电力市场理论和实践的核心。\n- **适定性**：该问题是一个具有凸目标函数和线性约束的线性规划问题。所有必要数据均已提供，且设定确保了唯一且有意义的解的存在。假设电抗相同简化了计算，但具体数值并非必需，因为它将在这种特定拓扑的PTDF计算中被约掉。\n- **目标**：语言精确，使用了标准的行业术语。\n\n### 第3步：结论与行动\n问题有效。现在开始求解过程。\n\nSCED问题是在满足全系统功率平衡和网络安全约束的条件下，最小化总发电成本。\n目标函数是总发电成本：\n$$\n\\min_{p_1, p_2, p_3} C = c_1 p_1 + c_2 p_2 + c_3 p_3 = 10 p_1 + 20 p_2 + 40 p_3\n$$\n发电量变量 $p_i$（对于 $i \\in \\{1, 2, 3\\}$）假定为非负，即 $p_i \\geq 0$。\n\n约束条件是：\n1.  **功率平衡**：总发电量必须等于总需求。\n    $$\n    \\sum_{i=1}^{3} p_i = \\sum_{i=1}^{3} d_i \\implies p_1 + p_2 + p_3 = 0 + 0 + 100 = 100\n    $$\n2.  **输电安全**：线路 $(2,3)$ 上的潮流不得超过其限制。\n    $$\n    F_{23} \\leq F_{23}^{\\max} = 60\n    $$\n\n为了用发电量变量表示 $F_{23}$，我们使用直流潮流模型。线路 $(i,j)$ 上的潮流为 $F_{ij} = \\frac{1}{x_{ij}}(\\theta_i - \\theta_j) = b_{ij}(\\theta_i - \\theta_j)$。在辐射状网络中，末端线路段 $(2,3)$ 上的潮流仅由末端节点$3$处的净功率注入决定。从节点$2$流向节点$3$的功率必须等于节点$3$的需求减去节点$3$的发电量。\n$$\nF_{23} = d_3 - p_3 = 100 - p_3\n$$\n这可以通过功率转移分布因子（PTDF）正式推导。PTDF，即 $\\text{PTDF}_{l,k}$，表示在节点$k$处注入1 MW功率并由平衡节点取出时，线路$l$上潮流的变化。对于平衡节点为$1$的辐射状线路 $(2,3)$，其PTDF如下：\n- $\\text{PTDF}_{23,2} = 0$：在节点$2$处注入、在节点$1$处平衡的功率仅在线路 $(1,2)$ 上流动，不影响线路 $(2,3)$。\n- $\\text{PTDF}_{23,3} = -1$：在节点$3$处注入、在节点$1$处平衡的功率必须由节点$1$提供。该功率从 $1 \\to 2 \\to 3$ 流动。要在节点$3$注入1 MW，必须“反向推动”来自节点$2$的潮流，从而使潮流 $F_{23}$ 减少1 MW。\n线路 $(2,3)$ 上的潮流由以下公式给出：\n$$\nF_{23} = \\sum_{k \\neq \\text{slack}} \\text{PTDF}_{23,k} (p_k - d_k) = \\text{PTDF}_{23,2}(p_2 - d_2) + \\text{PTDF}_{23,3}(p_3 - d_3)\n$$\n代入已知值：\n$$\nF_{23} = (0)(p_2 - 0) + (-1)(p_3 - 100) = 100 - p_3\n$$\n因此，线路约束变为 $100 - p_3 \\leq 60$，简化为 $p_3 \\geq 40$。\n\n首先，我们考察无约束的经济调度。为了最小化成本，我们将使用最便宜的发电机$G_1$来满足全部100 MW的负荷。调度方案将是 $p_1 = 100$ MW，$p_2 = 0$ MW，$p_3 = 0$ MW。在这种情况下，线路 $(2,3)$ 上的潮流将是 $F_{23} = 100 - p_3 = 100 - 0 = 100$ MW。由于 $100 \\text{ MW} > 60 \\text{ MW}$，该调度方案违反了输电约束。系统发生了拥塞。\n\n我们必须解决完整的SCED问题。该优化问题是：\n$$\n\\min_{p_1, p_2, p_3} (10 p_1 + 20 p_2 + 40 p_3)\n$$\n约束条件为：\n$$\np_1 + p_2 + p_3 = 100 \\quad (\\text{对偶变量 } \\lambda)\n$$\n$$\n40 - p_3 \\leq 0 \\quad (\\text{对偶变量 } \\mu_{23})\n$$\n$$\np_1 \\geq 0, \\quad p_2 \\geq 0, \\quad p_3 \\geq 0\n$$\n由于无约束解是不可行的，因此线路约束在最优解处必定是紧约束，即 $40 - p_3 = 0 \\implies p_3 = 40$ MW。\n系统总共需要100 MW。在 $p_3 = 40$ MW的情况下，剩余的 $100 - 40 = 60$ MW必须由发电机$G_1$和$G_2$提供。由于 $c_1  c_2$，剩余的需求应完全由较便宜的发电机$G_1$满足。\n因此，最优调度方案为：\n$$\np_1 = 60 \\text{ MW}, \\quad p_2 = 0 \\text{ MW}, \\quad p_3 = 40 \\text{ MW}\n$$\n该解满足所有约束条件：$p_i \\ge 0$，总发电量为 $60+0+40=100$ MW，线路潮流为 $F_{23} = 100 - p_3 = 100 - 40 = 60$ MW，正好达到限制。\n\n现在我们通过构建拉格朗日函数并使用KKT条件来求解拉格朗日乘子。\n拉格朗日函数为：\n$$\n\\mathcal{L}(p_1, p_2, p_3, \\lambda, \\mu_{23}) = (10 p_1 + 20 p_2 + 40 p_3) + \\lambda(100 - p_1 - p_2 - p_3) + \\mu_{23}(40 - p_3)\n$$\nKKT最优性条件是：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p_1} = 10 - \\lambda = 0 \\implies \\lambda = 10 \\quad (\\text{因为 } p_1=60>0)\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p_2} = 20 - \\lambda \\ge 0 \\implies 20-10=10 \\ge 0 \\quad (\\text{因为 } p_2=0)\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p_3} = 40 - \\lambda - \\mu_{23} = 0 \\implies 40 - 10 - \\mu_{23} = 0 \\implies \\mu_{23} = 30 \\quad (\\text{因为 } p_3=40>0)\n$$\n我们必须有 $\\mu_{23} \\ge 0$，这个条件得到了满足。这种形式是一致的。$\\lambda$ 是系统边际能量价格，$\\mu_{23}$ 是拥塞价格。\n\n参考节点（节点1）的节点边际电价（LMP）就是 $\\lambda$。\n$$\n\\text{LMP}_1 = \\lambda = 10 \\text{ \\$/MWh}\n$$\n其他节点的LMP通过用参考节点的LMP减去该节点注入功率引起的边际拥塞成本来计算。公式为：\n$$\n\\text{LMP}_k = \\lambda - \\sum_{l} \\mu_l \\text{PTDF}_{l,k}\n$$\n在我们的案例中，只有一条拥塞线路 $(2,3)$。所以对于节点$k$：\n$$\n\\text{LMP}_k = \\lambda - \\mu_{23} \\text{PTDF}_{23,k}\n$$\n使用 $\\lambda=10$，$\\mu_{23}=30$，以及先前确定的PTDF：\n$$\n\\text{LMP}_1 = \\lambda - \\mu_{23} \\text{PTDF}_{23,1} = 10 - (30)(0) = 10\n$$\n$$\n\\text{LMP}_2 = \\lambda - \\mu_{23} \\text{PTDF}_{23,2} = 10 - (30)(0) = 10\n$$\n$$\n\\text{LMP}_3 = \\lambda - \\mu_{23} \\text{PTDF}_{23,3} = 10 - (30)(-1) = 10 + 30 = 40\n$$\n所以LMP为 $\\text{LMP}_1 = 10.00 \\text{ \\$/MWh}$，$\\text{LMP}_2 = 10.00 \\text{ \\$/MWh}$，以及 $\\text{LMP}_3 = 40.00 \\text{ \\$/MWh}$。\n节点3的价格由当地昂贵的发电机$G_3$决定，因为输入更便宜的电力受到拥塞的限制。节点1和2的价格由便宜的发电机$G_1$决定，因为它们之间没有拥塞。\n\n在线路 $(2,3)$ 上收取的拥塞租金 $R$ 是潮流与线路两端LMP差值的乘积。\n$$\nR_{23} = F_{23} \\times (\\text{LMP}_3 - \\text{LMP}_2)\n$$\n代入数值：\n$$\nR_{23} = 60 \\text{ MW} \\times (40 \\text{ \\$/MWh} - 10 \\text{ \\$/MWh}) = 60 \\times 30 \\text{ \\$/h} = 1800 \\text{ \\$/h}\n$$\n这可以通过计算负荷总支付与发电机总支付之间的差额来验证。\n负荷总支付 = $\\sum_k \\text{LMP}_k d_k = \\text{LMP}_3 \\times d_3 = 40 \\times 100 = 4000 \\text{ \\$/h}$。\n发电总成本 = $\\sum_i c_i p_i = (10)(60) + (20)(0) + (40)(40) = 600 + 1600 = 2200 \\text{ \\$/h}$。\n拥塞租金 = 负荷支付 - 发电成本 = $4000 - 2200 = 1800 \\text{ \\$/h}$，结果一致。\n\n四舍五入到四位有效数字的最终数值结果是：\n- $\\text{LMP}_1 = 10.00 \\text{ \\$/MWh}$\n- $\\text{LMP}_2 = 10.00 \\text{ \\$/MWh}$\n- $\\text{LMP}_3 = 40.00 \\text{ \\$/MWh}$\n- $R = 1800 \\text{ \\$/h}$。可写为 $1.800 \\times 10^3$。\n\n最终答案以所需的矩阵格式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n10.00  10.00  40.00  1800\n\\end{pmatrix}\n}\n$$"
        }
    ]
}