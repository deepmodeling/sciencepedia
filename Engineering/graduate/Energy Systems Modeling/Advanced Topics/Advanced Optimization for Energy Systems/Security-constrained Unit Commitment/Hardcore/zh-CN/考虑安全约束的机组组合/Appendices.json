{
    "hands_on_practices": [
        {
            "introduction": "安全约束机组组合（SCUC）是一个复杂的混合整数优化问题。为了更好地理解它，我们首先将其中的连续部分——经济调度子问题——分离开来。本练习的核心是在一个*预先给定*的机组启停计划 ($u_{i,t}$) 下，计算总运行成本并确定最优的发电调度 ($p_{i,t}$)。通过这个练习，你将巩固对按成本排序（merit-order）调度、空载成本、启动成本以及满足备用要求等核心概念的理解。",
            "id": "4123128",
            "problem": "考虑一个包含三个火力发电机组在四个小时周期内的安全约束机组组合（SCUC）实例。安全性由固定的旋转备用需求表示。其基本框架是标准的SCUC目标和约束：在满足电量平衡、容量限制和备用充足性的前提下，最小化总运行成本，其中包含二进制的机组启停状态和启停机指示变量。令 $i \\in \\{1,2,3\\}$ 为机组索引，$t \\in \\{1,2,3,4\\}$ 为时段索引。定义二进制启停变量 $u_{i,t} \\in \\{0,1\\}$，启动指示变量 $v_{i,t} \\in \\{0,1\\}$，停机指示变量 $w_{i,t} \\in \\{0,1\\}$，以及实际出力 $p_{i,t} \\ge 0$。满足典型的SCUC状态转换关系：对于所有 $i,t$，$u_{i,t} - u_{i,t-1} = v_{i,t} - w_{i,t}$，其中初始启停状态 $u_{i,0}$ 已知。每台机组具有最小和最大出力 $P^{\\min}_{i}$ 和 $P^{\\max}_{i}$，当 $u_{i,t}=1$ 时的空载成本 $F_{i}$（单位：美元/小时），当 $v_{i,t}=1$ 时的启动成本 $S_{i}$（单位：美元），以及线性边际能量成本 $c_{i}$（单位：美元/兆瓦时 (MWh)）。时段 $t$ 的系统需求为 $D_{t}$，旋转备用需求为 $R_{t}$，解释为可用的裕度，满足 $\\sum_{i} \\left(u_{i,t} P^{\\max}_{i} - p_{i,t}\\right) \\ge R_{t}$。\n\n数据：\n- 机组 $1$：$P^{\\min}_{1} = 80$, $P^{\\max}_{1} = 200$, $F_{1} = 2000$, $S_{1} = 6000$, $c_{1} = 15$。\n- 机组 $2$：$P^{\\min}_{2} = 50$, $P^{\\max}_{2} = 150$, $F_{2} = 1500$, $S_{2} = 4000$, $c_{2} = 20$。\n- 机组 $3$：$P^{\\min}_{3} = 30$, $P^{\\max}_{3} = 100$, $F_{3} = 1000$, $S_{3} = 3000$, $c_{3} = 40$。\n- $t=0$ 时的初始启停状态：$u_{1,0} = 1$, $u_{2,0} = 0$, $u_{3,0} = 0$。\n- 需求：$D_{1} = 280$, $D_{2} = 380$, $D_{3} = 240$, $D_{4} = 350$。\n- 旋转备用需求：对于所有 $t$，$R_{t} = 50$。\n\n给定的机组启停计划以及启停机指示变量如下：\n- 启停状态 $u_{i,t}$：\n  - $t=1$: $u_{1,1} = 1$, $u_{2,1} = 1$, $u_{3,1} = 0$。\n  - $t=2$: $u_{1,2} = 1$, $u_{2,2} = 1$, $u_{3,2} = 1$。\n  - $t=3$: $u_{1,3} = 1$, $u_{2,3} = 0$, $u_{3,3} = 1$。\n  - $t=4$: $u_{1,4} = 1$, $u_{2,4} = 1$, $u_{3,4} = 1$。\n- 启动 $v_{i,t}$ 和停机 $w_{i,t}$ 指示变量：\n  - $t=1$: $v_{2,1} = 1$，所有其他 $v_{i,1} = 0$，所有 $w_{i,1} = 0$。\n  - $t=2$: $v_{3,2} = 1$，所有其他 $v_{i,2} = 0$，所有 $w_{i,2} = 0$。\n  - $t=3$: $w_{2,3} = 1$，所有其他 $w_{i,3} = 0$，所有 $v_{i,3} = 0$。\n  - $t=4$: $v_{2,4} = 1$，所有其他 $v_{i,4} = 0$，所有 $w_{i,4} = 0$。\n\n给定的初始出力计划 $p_{i,t}$ 如下（所有单位均为兆瓦，MW）：\n- $t=1$: $p_{1,1} = 150$, $p_{2,1} = 130$, $p_{3,1} = 0$。\n- $t=2$: $p_{1,2} = 170$, $p_{2,2} = 150$, $p_{3,2} = 60$。\n- $t=3$: $p_{1,3} = 160$, $p_{2,3} = 0$, $p_{3,3} = 80$。\n- $t=4$: $p_{1,4} = 180$, $p_{2,4} = 130$, $p_{3,4} = 40$。\n\n任务：\n1. 使用基本的SCUC目标函数定义，计算给定初始出力计划在四个时段内的总运行成本，包括空载和启动部分，但不包括任何停机成本。时段 $t$ 的成本为 $\\sum_{i} \\left(F_{i} u_{i,t} + S_{i} v_{i,t} + c_{i} p_{i,t}\\right)$，总成本是 $t=1,2,3,4$ 的加和。\n2. 对每个时段，找出成本最小化的出力方案 $p^{\\star}_{i,t}$，需满足约束条件：当 $u_{i,t}=1$ 时，$P^{\\min}_{i} \\le p_{i,t} \\le P^{\\max}_{i}$；当 $u_{i,t}=0$ 时，$p_{i,t} = 0$；电量平衡约束 $\\sum_{i} p_{i,t} = D_{t}$；以及旋转备用裕度约束 $\\sum_{i} \\left(u_{i,t} P^{\\max}_{i} - p_{i,t}\\right) \\ge R_{t}$。不考虑爬坡或最小启停时间约束。仅使用给定的启停状态 $u_{i,t}$ 和指示变量 $v_{i,t}, w_{i,t}$；不要更改启停计划。计算采用此成本最小化出力方案时，四个时段内的最小总运行成本，包括空载和启动部分，但不包括停机成本。\n\n提供所有四个时段的最小总运行成本作为最终答案。将您的答案四舍五入到四位有效数字。最终成本以美元（USD）表示。",
            "solution": "用户希望解决一个在固定机组启停计划下的安全约束经济调度问题，并计算最小总运行成本。首先对问题的内部一致性和科学合理性进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **机组数据**：\n  - 机组 1: $P^{\\min}_{1} = 80$ MW, $P^{\\max}_{1} = 200$ MW, $F_{1} = \\$2000$/h, $S_{1} = \\$6000$, $c_{1} = \\$15$/MWh。\n  - 机组 2: $P^{\\min}_{2} = 50$ MW, $P^{\\max}_{2} = 150$ MW, $F_{2} = \\$1500$/h, $S_{2} = \\$4000$, $c_{2} = \\$20$/MWh。\n  - 机组 3: $P^{\\min}_{3} = 30$ MW, $P^{\\max}_{3} = 100$ MW, $F_{3} = \\$1000$/h, $S_{3} = \\$3000$, $c_{3} = \\$40$/MWh。\n- **初始状态 ($t=0$)**：$u_{1,0} = 1$, $u_{2,0} = 0$, $u_{3,0} = 0$。\n- **需求 ($D_t$)**：$D_{1} = 280$ MW, $D_{2} = 380$ MW, $D_{3} = 240$ MW, $D_{4} = 350$ MW。\n- **备用 ($R_t$)**：对于 $t \\in \\{1,2,3,4\\}$，$R_{t} = 50$ MW。\n- **给定启停状态 ($u_{i,t}$)**：\n  - $t=1$: $\\{u_{1,1}, u_{2,1}, u_{3,1}\\} = \\{1, 1, 0\\}$\n  - $t=2$: $\\{u_{1,2}, u_{2,2}, u_{3,2}\\} = \\{1, 1, 1\\}$\n  - $t=3$: $\\{u_{1,3}, u_{2,3}, u_{3,3}\\} = \\{1, 0, 1\\}$\n  - $t=4$: $\\{u_{1,4}, u_{2,4}, u_{3,4}\\} = \\{1, 1, 1\\}$\n- **给定指示变量 ($v_{i,t}, w_{i,t}$)**：\n  - $t=1$: $v_{2,1} = 1$。其他为 $0$。\n  - $t=2$: $v_{3,2} = 1$。其他为 $0$。\n  - $t=3$: $w_{2,3} = 1$。其他为 $0$。\n  - $t=4$: $v_{2,4} = 1$。其他为 $0$。\n- **给定出力 ($p_{i,t}$)** （这部分仅用于理解背景和验证，不用于最终计算）。\n- **成本函数**：$t=1...4$ 的总成本为 $\\sum_{t=1}^4 \\sum_{i=1}^3 \\left(F_{i} u_{i,t} + S_{i} v_{i,t} + c_{i} p_{i,t}\\right)$。\n- **状态转换规则**：$u_{i,t} - u_{i,t-1} = v_{i,t} - w_{i,t}$。\n\n**步骤2：使用提取的已知条件进行验证**\n对问题的一致性进行验证。\n1.  **状态转换一致性**：检查所有机组和时段是否满足关系 $u_{i,t} - u_{i,t-1} = v_{i,t} - w_{i,t}$。例如，对于机组2在$t=1$时，$u_{2,1} - u_{2,0} = 1 - 0 = 1$。这与 $v_{2,1} - w_{2,1} = 1 - 0 = 1$ 相符。在$t=3$时对于机组2，$u_{2,3} - u_{2,2} = 0 - 1 = -1$，这与 $v_{2,3} - w_{2,3} = 0 - 1 = -1$ 相符。所有其他转换均已验证并发现是一致的。\n2.  **科学依据**：该问题是一个标准的安全约束经济调度（SCED）问题，这是电力系统工程中一个基础且成熟的课题。\n3.  **适定性**：该问题是适定的，具有明确的目标函数和一组线性约束。给定的条件足以找到一个唯一的、有意义的解。\n4.  **给定计划的可行性**：检查了所提供的初始出力计划是否满足所有约束（发电限制、需求平衡、备用需求），发现是可行的，这证实了数据的自洽性。例如，在$t=1$时，需求 $D_1=280$ MW 由 $p_{1,1}+p_{2,1}=150+130=280$ MW 满足。备用为 $(P^{\\max}_1-p_{1,1}) + (P^{\\max}_2-p_{2,1}) = (200-150)+(150-130)=70$ MW，大于所需的 $R_1=50$ MW。所有时段都类似地是可行的。\n\n**步骤3：结论与行动**\n问题陈述是有效的。它在科学上是合理的、自洽的并且是适定的。将计算解答。\n\n### 解题过程\n\n目标是计算在给定的机组启停计划下，四个小时内的最小总运行成本。总成本 $C_{\\text{total}}$ 是每个小时 $t$ 成本的总和：\n$$C_{\\text{total}} = \\sum_{t=1}^{4} \\left( \\sum_{i=1}^{3} (F_{i} u_{i,t} + S_{i} v_{i,t}) + \\sum_{i=1}^{3} c_{i} p_{i,t} \\right)$$\n由于机组启停计划 ($u_{i,t}$) 和启动决策 ($v_{i,t}$) 是给定的，空载成本 ($F_i$) 和启动成本 ($S_i$) 是固定的。为了最小化 $C_{\\text{total}}$，我们必须最小化可变能量成本部分，即 $\\sum_{t=1}^4 \\sum_{i=1}^3 c_i p_{i,t}$。由于没有跨时段的调度约束（如爬坡率），我们可以独立地最小化每个小时的能量成本。这是每个小时的一个经典经济调度问题（EDP）。\n\n对于每个小时 $t$，我们求解：\n$$ \\min_{p_{i,t}} \\sum_{i=1}^{3} c_i p_{i,t} $$\n约束条件：\n1.  电量平衡：$\\sum_{i=1}^{3} p_{i,t} = D_t$\n2.  发电限制：对于 $i \\in \\{1,2,3\\}$，$u_{i,t} P^{\\min}_i \\le p_{i,t} \\le u_{i,t} P^{\\max}_i$\n3.  旋转备用：$\\sum_{i=1}^{3} (u_{i,t} P^{\\max}_i - p_{i,t}) \\ge R_t$\n\n旋转备用约束可以利用电量平衡约束改写为：$\\sum_{i=1}^{3} u_{i,t} P^{\\max}_i - D_t \\ge R_t$。这是对总投入容量的检查，必须在调度之前进行。\n\n边际成本分别为 $c_{1} = 15$，$c_{2} = 20$ 和 $c_{3} = 40$。调度的优先顺序是机组1，然后是机组2，最后是机组3。\n\n**最优调度计算**\n\n**时段 $t=1$**：\n- 已投入机组：$\\{1, 2\\}$。需求 $D_1=280$。备用 $R_1=50$。\n- 容量检查：$P^{\\max}_1+P^{\\max}_2 = 200+150=350$ MW。需要：$D_1+R_1 = 280+50=330$ MW。$350 \\ge 330$，满足。\n- 调度：将机组加载到最小出力：$p_{1,1}=80$, $p_{2,1}=50$。总计：$130$ MW。剩余需求：$280-130=150$ MW。\n- 从 $80$ 加载最便宜的机组（机组1）到 $200$：增加 $120$ MW。剩余需求：$150-120=30$ MW。\n- 从 $50$ 加载机组2：增加 $30$ MW。\n- 最优调度：$p^{\\star}_{1,1}=200$, $p^{\\star}_{2,1}=80$。\n- 能量成本：$15 \\times 200 + 20 \\times 80 = 3000 + 1600 = \\$4600$。\n\n**时段 $t=2$**：\n- 已投入机组：$\\{1, 2, 3\\}$。需求 $D_2=380$。备用 $R_2=50$。\n- 容量检查：$P^{\\max}_1+P^{\\max}_2+P^{\\max}_3=200+150+100=450$ MW。需要：$D_2+R_2 = 380+50=430$ MW。$450 \\ge 430$，满足。\n- 调度：将机组加载到最小出力：$p_{1,2}=80$, $p_{2,2}=50$, $p_{3,2}=30$。总计：$160$ MW。剩余需求：$380-160=220$ MW。\n- 从 $80$ 加载机组1到 $200$：增加 $120$ MW。剩余需求：$220-120=100$ MW。\n- 从 $50$ 加载机组2到 $150$：增加 $100$ MW。剩余需求：$100-100=0$ MW。\n- 机组3保持在最小出力。\n- 最优调度：$p^{\\star}_{1,2}=200$, $p^{\\star}_{2,2}=150$, $p^{\\star}_{3,2}=30$。\n- 能量成本：$15 \\times 200 + 20 \\times 150 + 40 \\times 30 = 3000 + 3000 + 1200 = \\$7200$。\n\n**时段 $t=3$**：\n- 已投入机组：$\\{1, 3\\}$。需求 $D_3=240$。备用 $R_3=50$。\n- 容量检查：$P^{\\max}_1+P^{\\max}_3 = 200+100=300$ MW。需要：$D_3+R_3=240+50=290$ MW。$300 \\ge 290$，满足。\n- 调度：将机组加载到最小出力：$p_{1,3}=80$, $p_{3,3}=30$。总计：$110$ MW。剩余需求：$240-110=130$ MW。\n- 从 $80$ 加载机组1到 $200$：增加 $120$ MW。剩余需求：$130-120=10$ MW。\n- 从 $30$ 加载机组3：增加 $10$ MW。\n- 最优调度：$p^{\\star}_{1,3}=200$, $p^{\\star}_{3,3}=40$。\n- 能量成本：$15 \\times 200 + 40 \\times 40 = 3000 + 1600 = \\$4600$。\n\n**时段 $t=4$**：\n- 已投入机组：$\\{1, 2, 3\\}$。需求 $D_4=350$。备用 $R_4=50$。\n- 容量检查：$P^{\\max}_1+P^{\\max}_2+P^{\\max}_3=450$ MW。需要：$D_4+R_4=350+50=400$ MW。$450 \\ge 400$，满足。\n- 调度：将机组加载到最小出力：$p_{1,4}=80$, $p_{2,4}=50$, $p_{3,4}=30$。总计：$160$ MW。剩余需求：$350-160=190$ MW。\n- 从 $80$ 加载机组1到 $200$：增加 $120$ MW。剩余需求：$190-120=70$ MW。\n- 从 $50$ 加载机组2：增加 $70$ MW。\n- 最优调度：$p^{\\star}_{1,4}=200$, $p^{\\star}_{2,4}=120$, $p^{\\star}_{3,4}=30$。\n- 能量成本：$15 \\times 200 + 20 \\times 120 + 40 \\times 30 = 3000 + 2400 + 1200 = \\$6600$。\n\n**总成本计算**\n\n最小总能量成本 = $\\$4600 + \\$7200 + \\$4600 + \\$6600 = \\$23000$。\n\n现在，我们计算固定成本（空载和启动）：\n- $t=1$: $F_1 u_{1,1} + F_2 u_{2,1} + S_2 v_{2,1} = 2000 + 1500 + 4000 = \\$7500$。\n- $t=2$: $F_1 u_{1,2} + F_2 u_{2,2} + F_3 u_{3,2} + S_3 v_{3,2} = 2000 + 1500 + 1000 + 3000 = \\$7500$。\n- $t=3$: $F_1 u_{1,3} + F_3 u_{3,3} = 2000 + 1000 = \\$3000$。\n- $t=4$: $F_1 u_{1,4} + F_2 u_{2,4} + F_3 u_{3,4} + S_2 v_{2,4} = 2000 + 1500 + 1000 + 4000 = \\$8500$。\n\n总固定成本 = $\\$7500 + \\$7500 + \\$3000 + \\$8500 = \\$26500$。\n\n最小总运行成本 = 总固定成本 + 最小总能量成本\n$$C^{\\star}_{\\text{total}} = \\$26500 + \\$23000 = \\$49500$$\n\n问题要求将答案四舍五入到四位有效数字。确切答案是 $49500$。表示为四位有效数字是 $4.950 \\times 10^4$。",
            "answer": "$$\\boxed{4.950 \\times 10^{4}}$$"
        },
        {
            "introduction": "掌握了在固定启停计划下的调度方法后，我们自然会问：这个计划本身是如何确定的？本练习揭示了机组组合决策中的一个关键挑战：远见（foresight）的必要性。通过一个精心设计的反例，你将看到短视的（myopic）调度策略，由于忽略了机组的启动时间和爬坡速率等物理约束，如何导致未来某个时刻的系统不可行性。这个练习突显了在 SCUC 模型中设置足够长的预测窗口（look-ahead horizon）的至关重要性。",
            "id": "4123140",
            "problem": "考虑一个在离散小时时间段内采用滚动视界实施的单母线安全约束机组组合（SCUC）问题。滚动视界使用一个 $H$ 小时的前瞻窗口，在每个决策时刻 $t$，它会安排发电机组以确保在区间 $\\{t+1,\\dots,t+H\\}$ 内的可行性，并受发电机运行约束的限制。假设视界内预测完美，并且除了启动成本外没有其他跨期成本。系统必须在每小时满足确定性的功率平衡约束，设计上不允许切负荷；如果已安排的机组由于物理约束无法满足需求，则该调度是不可行的，未满足的需求即为短缺量。\n\n基本依据是：\n- 功率平衡：对于每个时间 $t$，$\\sum_{g} P_{g,t} = D_{t}$，其中 $P_{g,t}$ 是发电机 $g$ 的有功功率输出，$D_{t}$ 是需求。\n- 运行限制：对于每个发电机 $g$ 和时间 $t$，$P^{\\min}_{g} u_{g,t} \\le P_{g,t} \\le P^{\\max}_{g} u_{g,t}$，其中 $u_{g,t} \\in \\{0,1\\}$ 是机组投运状态。\n- 爬坡率限制：对于每个发电机 $g$ 和连续时间 $t-1$ 和 $t$，$P_{g,t} - P_{g,t-1} \\le RU_{g}$ 和 $P_{g,t-1} - P_{g,t} \\le RD_{g}$。\n- 启动准备时间：如果发电机 $g$ 在时间 $t$ 启动（二进制启动变量 $y_{g,t} = 1$），那么它最早在 $\\tau = t + ST_{g}$ 时刻才能开始发电（即可以设置 $u_{g,\\tau} = 1$）。在 $\\tau$ 之前，对于所有 $\\tau'  t + ST_{g}$，都有 $u_{g,\\tau'} = 0$。\n\n有两个火电机组，索引为 $g \\in \\{1,2\\}$，参数如下：\n- 发电机 1：$P^{\\min}_{1} = 100$ MW，$P^{\\max}_{1} = 300$ MW，$RU_{1} = 100$ MW/h，$RD_{1} = 100$ MW/h，启动准备时间 $ST_{1} = 0$ 小时，在 $t=0$ 时已投运，输出功率为 $P_{1,0} = 100$ MW。\n- 发电机 2：$P^{\\min}_{2} = 200$ MW，$P^{\\max}_{2} = 600$ MW，$RU_{2} = 200$ MW/h，$RD_{2} = 200$ MW/h，启动准备时间 $ST_{2} = 2$ 小时，在 $t=0$ 时处于离线状态。\n\n每小时需求预测如下：\n- $D_{1} = 200$ MW,\n- $D_{2} = 250$ MW,\n- $D_{3} = 600$ MW.\n\n发电机 2 的启动成本为正且数值较大，因此只考虑当前视界的短视调度会避免启动发电机 2，除非在该视界内为了满足可行性而必须启动。\n\n执行一个前瞻窗口 $H = 1$ 小时的滚动视界 SCUC。在每小时 $t \\in \\{0,1,2\\}$，SCUC 仅确保下一小时的可行性。通过一个数值反例证明，由于延迟启动发电机 2 导致其无法及时爬坡以应对急剧的负荷增长，$H=1$ 的短视调度会在 $t=3$ 时导致不可行。计算在这种 $H=1$ 调度下 $t=3$ 时未满足的需求（短缺量）的大小，以兆瓦（MW）为单位。最终答案以 MW 表示。无需四舍五入。",
            "solution": "该问题要求在安全约束机组组合（SCUC）背景下，展示由短视滚动视界调度策略引起的不可行性。我们将跟踪在前瞻视界为 $H=1$ 小时的条件下，系统在每个离散时间步 $t$ 的状态和做出的机组组合决策。该调度的短视特性体现在，在每个决策时刻 $t$，系统操作员仅考虑下一小时 $t+1$ 的可行性，并且如果对于该单一小时来说不是绝对必要，就会避免采取成本高昂的行动（如启动发电机 2）。\n\n在 $t=0$ 时的初始状态给定如下：\n- 发电机 1：已投运，$u_{1,0} = 1$，输出功率 $P_{1,0} = 100$ MW。\n- 发电机 2：离线，$u_{2,0} = 0$，输出功率 $P_{2,0} = 0$ MW。\n\n我们通过分析每个时间步的决策来继续。\n\n**在 $t=0$ 时的决策（针对小时 $t=1$）**\n\n在决策时刻 $t=0$，调度器为小时 $t=1$ 进行规划。前瞻窗口只包含需求 $D_{1} = 200$ MW。\n我们必须检查当前已投运的发电机 1 是否能满足此需求。\n发电机 1 在 $t=1$ 时的最大可用功率输出，记为 $P_{1,1}^{\\text{max\\_avail}}$，受其最大功率限制 $P_{1}^{\\max}$ 和从其在 $t=0$ 状态开始的爬坡率限制 $RU_{1}$ 的约束。\n$$P_{1,1}^{\\text{max\\_avail}} = \\min(P_{1}^{\\max}, P_{1,0} + RU_{1})$$\n代入给定值：\n$$P_{1,1}^{\\text{max\\_avail}} = \\min(300 \\text{ MW}, 100 \\text{ MW} + 100 \\text{ MW/h} \\times 1 \\text{ h}) = \\min(300, 200) \\text{ MW} = 200 \\text{ MW}$$\n最小功率输出为 $P_{1}^{\\min} = 100$ MW。由于需求 $D_{1} = 200$ MW 落在发电机 1 的可实现范围内（即 $100 \\text{ MW} \\le 200 \\text{ MW} \\le 200 \\text{ MW}$），发电机 1 可以单独满足需求。\n短视调度器为了避免发电机 2 的高昂启动成本，不会发出启动指令。机组组合决策是保持发电机 2 离线。\n在 $t=1$ 时的最终状态是：\n- $u_{1,1}=1$, $P_{1,1} = D_1 = 200$ MW.\n- $u_{2,1}=0$, $P_{2,1} = 0$ MW.\n- 没有为发电机 2 发出启动指令，因此其启动变量 $y_{2,0}=0$。\n\n**在 $t=1$ 时的决策（针对小时 $t=2$）**\n\n在决策时刻 $t=1$，调度器为小时 $t=2$ 进行规划。前瞻窗口只包含需求 $D_{2} = 250$ MW。在 $t=1$ 时的状态由上一步可知。\n我们检查发电机 1 在 $t=2$ 时的容量。\n$$P_{1,2}^{\\text{max\\_avail}} = \\min(P_{1}^{\\max}, P_{1,1} + RU_{1})$$\n$$P_{1,2}^{\\text{max\\_avail}} = \\min(300 \\text{ MW}, 200 \\text{ MW} + 100 \\text{ MW/h} \\times 1 \\text{ h}) = \\min(300, 300) \\text{ MW} = 300 \\text{ MW}$$\n需求 $D_{2} = 250$ MW 在发电机 1 的运行范围内（$100 \\text{ MW} \\le 250 \\text{ MW} \\le 300 \\text{ MW}$）。\n同样，短视调度器发现发电机 1 足以满足需求，并避免启动发电机 2。\n在 $t=2$ 时的最终状态是：\n- $u_{1,2}=1$, $P_{1,2} = D_2 = 250$ MW.\n- $u_{2,2}=0$, $P_{2,2} = 0$ MW.\n- 没有为发电机 2 发出启动指令，因此 $y_{2,1}=0$。这是关键的失败点。为了让发电机 2 在 $t=3$ 时可用，本应在 $t=1$ 或之前发出启动指令，因为其启动准备时间是 $ST_{2} = 2$ 小时（$1+2=3$）。\n\n**在 $t=3$ 时的可行性分析**\n\n在决策时刻 $t=2$，调度器为小时 $t=3$ 进行规划。需求为 $D_{3} = 600$ MW。在 $t=2$ 时的状态是 $P_{1,2}=250$ MW 和 $P_{2,2}=0$ MW，发电机 2 处于离线状态。\n发电机 1 在 $t=3$ 时可能的最大发电量是：\n$$P_{1,3}^{\\text{max\\_possible}} = \\min(P_{1}^{\\max}, P_{1,2} + RU_{1})$$\n$$P_{1,3}^{\\text{max\\_possible}} = \\min(300 \\text{ MW}, 250 \\text{ MW} + 100 \\text{ MW/h} \\times 1 \\text{ h}) = \\min(300, 350) \\text{ MW} = 300 \\text{ MW}$$\n显然，仅靠发电机 1 不足以满足 600 MW 的需求。在 $t=2$ 时的调度器认识到这一点，并会为发电机 2 发出启动指令，即 $y_{2,2}=1$。\n但是，我们必须检查发电机 2 何时变为可用。根据问题陈述，在时间 $t$ 启动的发电机在时间 $\\tau \\ge t + ST_{g}$ 时才可用。\n对于发电机 2，其 $ST_{2} = 2$ 小时，在 $t=2$ 时发出启动指令意味着它最早在 $\\tau = 2 + 2 = 4$ 时才能开始发电。\n因此，在 $t=3$ 时，发电机 2 不可用于调度，即其投运状态必须是 $u_{2,3}=0$，其功率输出为 $P_{2,3}=0$ MW。\n\n在 $t=3$ 时的总可用发电容量是所有发电机最大可能输出的总和。\n$$P_{\\text{total},3}^{\\text{max}} = P_{1,3}^{\\text{max\\_possible}} + P_{2,3}^{\\text{max\\_possible}} = 300 \\text{ MW} + 0 \\text{ MW} = 300 \\text{ MW}$$\n该小时的需求是 $D_{3} = 600$ MW。\n系统面临短缺，因为可用发电量小于需求。未满足需求的大小是：\n$$\\text{Shortfall} = D_{3} - P_{\\text{total},3}^{\\text{max}}$$\n$$\\text{Shortfall} = 600 \\text{ MW} - 300 \\text{ MW} = 300 \\text{ MW}$$\n这表明，短视的 $H=1$ 调度策略由于未能预见到 $t=3$ 时需求的大幅爬升和发电机 2 的长启动时间，导致了 300 MW 的供应短缺。一个具有更长前瞻视界（例如 $H=3$）的调度器会预见到在 $t=3$ 时需要发电机 2，并在 $t=1$ 时发出启动指令。",
            "answer": "$$\n\\boxed{300}\n$$"
        },
        {
            "introduction": "SCUC 难题的最后一块拼图是“安全约束”（Security-Constrained），这主要涉及输电网络。本练习深入探讨了网络限制所带来的经济后果。通过从基本原理出发分析一个简单的拥塞系统，你将推导出节点边际电价（LMP），并理解它们是如何在发电机成本和输电约束的相互作用下产生的——这是现代电力市场的一个基本概念。",
            "id": "4123071",
            "problem": "考虑一个用于安全约束机组组合 (SCUC) 和安全约束经济调度 (SCED) 的三母线输电网络的直流 (DC) 近似模型。母线标记为 $1$、$2$ 和 $3$，其中母线 $1$ 被指定为平衡（参考）母线，即其相角固定为 $0$。网络拓扑为辐射状：母线 $1$ 连接到母线 $2$，母线 $2$ 连接到母线 $3$。串联电抗相同且为正值，直流模型假设潮流线性化、相角差小且线路无损。\n\n有一个受监控的输电约束：线路 $(2 \\rightarrow 3)$ 上的有功潮流在从母线 $2$ 到母线 $3$ 的正方向上必须满足 $F_{23} \\leq F_{23}^{\\max}$。该限值为 $F_{23}^{\\max} = 60$ MW。在此场景中，线路 $(1 \\rightarrow 2)$ 没有紧约束。\n\n在每个母线 $i \\in \\{1,2,3\\}$ 上都有一台常规发电机，其边际成本 $c_i$ 是线性的，并且容量充足（没有发电上限是紧约束）。边际成本排序为 $c_1  c_2  c_3$，其数值为 $c_1 = 10$ 美元/MWh，$c_2 = 20$ 美元/MWh，$c_3 = 40$ 美元/MWh。存在单周期负荷：$d_1 = 0$ MW，$d_2 = 0$ MW，$d_3 = 100$ MW。在此单周期案例中，爬坡和机组启停二进制变量不是紧约束。\n\n利用直流潮流基础知识和功率转移分布因子 (PTDF) 的定义，推导每个母线的节点边际电价 (LMP)。线路 $(2 \\rightarrow 3)$ 的 PTDF 定义为：在母线 $i$ 进行增量注入，并在平衡母线 $1$ 进行等量取出时，$F_{23}$ 的灵敏度。设 $\\mu_{23} \\geq 0$ 表示与上限 $F_{23} \\leq F_{23}^{\\max}$ 相关的拉格朗日乘子（对偶变量）。假设 $F_{23}$ 的下限不是紧约束。\n\n从第一性原理出发，在直流模型下建立 SCED 问题，推导 Karush–Kuhn–Tucker (KKT) 条件，识别紧约束，并使用 PTDF 和线路约束的对偶变量计算节点 LMP $\\text{LMP}_1$、$\\text{LMP}_2$ 和 $\\text{LMP}_3$。然后将节点价格差异解释为拥塞引起的价格分离，并计算线路 $(2 \\rightarrow 3)$ 上产生的总拥塞租金。\n\n将每个 LMP 四舍五入到四位有效数字，并以美元/MWh为单位表示。将拥塞租金四舍五入到四位有效数字，并以美元/小时为单位表示。按顺序 $\\left(\\text{LMP}_1, \\text{LMP}_2, \\text{LMP}_3, R\\right)$ 报告您的最终数值结果，其中 $R$ 是线路 $(2 \\rightarrow 3)$ 上的拥塞租金。",
            "solution": "该问题要求在安全约束经济调度 (SCED) 框架下，计算三个母线的节点边际电价 (LMP) 和一条输电线路上的拥塞租金。分析过程将首先建立优化问题，然后使用给定的直流近似推导潮流约束，接着使用 Karush-Kuhn-Tucker (KKT) 条件求解该问题，最后从解中计算 LMP 和拥塞租金。\n\n首先，我们验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **网络**：三母线直流网络，母线标记为 $1$、$2$、$3$。\n- **平衡母线**：母线 $1$ 是参考母线，相角 $\\theta_1 = 0$。\n- **拓扑**：辐射状连接：线路 $(1,2)$ 和线路 $(2,3)$。\n- **线路参数**：串联电抗相同且为正，我们用 $x > 0$ 表示电抗。电纳为 $b = 1/x$。\n- **约束**：线路 $(2 \\rightarrow 3)$ 上的潮流受 $F_{23} \\leq F_{23}^{\\max}$ 限制。\n- **潮流限值**：$F_{23}^{\\max} = 60$ MW。\n- **发电机成本**：边际成本为 $c_1 = 10$ 美元/MWh，$c_2 = 20$ 美元/MWh，$c_3 = 40$ 美元/MWh。\n- **负荷**：单周期负荷为 $d_1 = 0$ MW，$d_2 = 0$ MW，$d_3 = 100$ MW。\n- **对偶变量**：$\\mu_{23} \\geq 0$ 是线路约束的拉格朗日乘子。\n\n### 步骤 2：使用提取的已知条件进行验证\n这是一个经典且定义明确的 SCED 问题。\n- **科学依据**：该问题使用直流潮流模型，这是电力系统分析中用于运行规划的标准和基本工具。LMP、PTDF 和 KKT 条件等概念是电力市场理论与实践的核心。\n- **适定性**：该问题是一个线性规划问题，具有凸目标函数和线性约束。所有必要数据均已提供，且问题设置确保存在唯一且有意义的解。假设电抗相同简化了计算，但其确切值并非必需，因为对于这种特定拓扑，它将在 PTDF 计算中被抵消。\n- **目标**：语言精确，并使用了标准的行业术语。\n\n### 步骤 3：结论与行动\n问题有效。现在开始求解过程。\n\nSCED 问题是在满足全系统功率平衡和网络安全约束的前提下，最小化总发电成本。\n目标函数是总发电成本：\n$$\n\\min_{p_1, p_2, p_3} C = c_1 p_1 + c_2 p_2 + c_3 p_3 = 10 p_1 + 20 p_2 + 40 p_3\n$$\n假设发电变量 $p_i$ ($i \\in \\{1, 2, 3\\}$) 为非负值，$p_i \\geq 0$。\n\n约束条件是：\n1.  **功率平衡**：总发电量必须等于总负荷。\n    $$\n    \\sum_{i=1}^{3} p_i = \\sum_{i=1}^{3} d_i \\implies p_1 + p_2 + p_3 = 0 + 0 + 100 = 100\n    $$\n2.  **输电安全**：线路 $(2,3)$ 上的潮流不得超过其限值。\n    $$\n    F_{23} \\leq F_{23}^{\\max} = 60\n    $$\n\n为了用发电变量表示 $F_{23}$，我们使用直流潮流模型。线路 $(i,j)$ 上的潮流为 $F_{ij} = \\frac{1}{x_{ij}}(\\theta_i - \\theta_j) = b_{ij}(\\theta_i - \\theta_j)$。在辐射状网络中，末端线路段 $(2,3)$ 上的潮流仅由末端母线 $3$ 的净注入功率决定。从母线 $2$ 流向母线 $3$ 的功率必须等于母线 $3$ 的负荷减去母线 $3$ 的发电量。\n$$\nF_{23} = d_3 - p_3 = 100 - p_3\n$$\n这可以通过功率转移分布因子 (PTDF) 进行形式化推导。PTDF, $\\text{PTDF}_{l,k}$, 表示在母线 $k$ 注入 $1$ MW 并在平衡母线取出时，线路 $l$ 上潮流的变化。对于平衡母线在 $1$ 的辐射状线路 $(2,3)$，其 PTDF 如下：\n- $\\text{PTDF}_{23,2} = 0$：在母线 $2$ 注入、在母线 $1$ 平衡的功率仅在线路 $(1,2)$ 上流动，不影响线路 $(2,3)$。\n- $\\text{PTDF}_{23,3} = -1$：在母线 $3$ 注入、在母线 $1$ 平衡的功率必须来自母线 $1$。该功率从 $1 \\to 2 \\to 3$ 流动。要在母线 $3$ 注入 $1$ MW，必须“反向推动”来自母线 $2$ 的潮流，从而使潮流 $F_{23}$ 减少 $1$ MW。所以 PTDF 是 -1。\n线路 $(2,3)$ 上的潮流由下式给出：\n$$\nF_{23} = \\sum_{k \\neq \\text{slack}} \\text{PTDF}_{23,k} (p_k - d_k) = \\text{PTDF}_{23,2}(p_2 - d_2) + \\text{PTDF}_{23,3}(p_3 - d_3)\n$$\n代入已知值：\n$$\nF_{23} = (0)(p_2 - 0) + (-1)(p_3 - 100) = 100 - p_3\n$$\n因此线路约束变为 $100 - p_3 \\leq 60$，简化后为 $p_3 \\geq 40$。\n\n首先，我们考察无约束经济调度。为最小化成本，我们将使用最便宜的发电机 $G_1$ 来满足全部 $100$ MW 负荷。调度方案将是 $p_1 = 100$ MW，$p_2 = 0$ MW，$p_3 = 0$ MW。在这种情况下，线路 $(2,3)$ 上的潮流将是 $F_{23} = 100 - p_3 = 100 - 0 = 100$ MW。由于 $100 \\text{ MW} > 60 \\text{ MW}$，该调度方案违反了输电约束。系统存在拥塞。\n\n我们必须求解完整的 SCED 问题。该优化问题是：\n$$\n\\min_{p_1, p_2, p_3} (10 p_1 + 20 p_2 + 40 p_3)\n$$\n约束条件为：\n$$\np_1 + p_2 + p_3 = 100 \\quad (\\text{对偶变量 } \\lambda)\n$$\n$$\n40 - p_3 \\leq 0 \\quad (\\text{对偶变量 } \\mu_{23})\n$$\n$$\np_1 \\geq 0, \\quad p_2 \\geq 0, \\quad p_3 \\geq 0\n$$\n由于无约束解是不可行的，因此在最优点线路约束必须是紧约束，即 $40 - p_3 = 0 \\implies p_3 = 40$ MW。\n系统总共需要 $100$ MW。当 $p_3 = 40$ MW 时，剩余的 $100 - 40 = 60$ MW 必须由发电机 $G_1$ 和 $G_2$ 提供。由于 $c_1  c_2$，剩余负荷应全部由较便宜的发电机 $G_1$ 满足。\n因此，最优调度方案是：\n$$\np_1 = 60 \\text{ MW}, \\quad p_2 = 0 \\text{ MW}, \\quad p_3 = 40 \\text{ MW}\n$$\n该解满足所有约束条件：$p_i \\ge 0$，总发电量为 $60+0+40=100$ MW，线路潮流为 $F_{23} = 100 - p_3 = 100 - 40 = 60$ MW，正好达到限值。\n\n现在我们通过构造拉格朗日函数并使用 KKT 条件来求解拉格朗日乘子。\n我们使用标准形式 $\\mathcal{L} = f(x) + \\lambda h(x) + \\mu g(x)$，其中约束为 $h(x)=0, g(x) \\le 0$ 且 $\\mu \\ge 0$。\n拉格朗日函数是：\n$$\n\\mathcal{L} = (10 p_1 + 20 p_2 + 40 p_3) + \\lambda(100 - p_1 - p_2 - p_3) + \\mu_{23}(40 - p_3)\n$$\nKKT 最优性条件是：\n$\\frac{\\partial \\mathcal{L}}{\\partial p_1} = 10 - \\lambda = 0 \\implies \\lambda = 10$ (因为 $p_1=60>0$)\n$\\frac{\\partial \\mathcal{L}}{\\partial p_2} = 20 - \\lambda \\ge 0 \\implies 20-10=10 \\ge 0$ (因为 $p_2=0$)\n$\\frac{\\partial \\mathcal{L}}{\\partial p_3} = 40 - \\lambda - \\mu_{23} = 0 \\implies 40 - 10 - \\mu_{23} = 0 \\implies \\mu_{23} = 30$ (因为 $p_3=40>0$)\n我们必须有 $\\mu_{23} \\ge 0$，这个条件得到了满足。这个公式是一致的。$\\lambda$ 是系统边际能源价格，而 $\\mu_{23}$ 是拥塞价格。\n\n参考母线（母线 1）的节点边际电价 (LMP) 就是 $\\lambda$。\n$$\n\\text{LMP}_1 = \\lambda = 10 \\text{ 美元/MWh}\n$$\n其他母线的 LMP 是通过用该母线注入引起的边际拥塞成本来调整参考母线的 LMP 计算得出的。公式为：\n$$\n\\text{LMP}_k = \\lambda - \\sum_{l} \\mu_l \\text{PTDF}_{l,k}\n$$\n在我们的案例中，只有一条拥塞线路 $(2,3)$。因此对于母线 $k$：\n$$\n\\text{LMP}_k = \\lambda - \\mu_{23} \\text{PTDF}_{23,k}\n$$\n使用 $\\lambda=10$，$\\mu_{23}=30$ 和先前确定的 PTDF：\n$$\n\\text{LMP}_1 = \\lambda - \\mu_{23} \\text{PTDF}_{23,1} = 10 - (30)(0) = 10\n$$\n$$\n\\text{LMP}_2 = \\lambda - \\mu_{23} \\text{PTDF}_{23,2} = 10 - (30)(0) = 10\n$$\n$$\n\\text{LMP}_3 = \\lambda - \\mu_{23} \\text{PTDF}_{23,3} = 10 - (30)(-1) = 10 + 30 = 40\n$$\n因此，LMP 分别为 $\\text{LMP}_1 = 10.00$ 美元/MWh，$\\text{LMP}_2 = 10.00$ 美元/MWh，以及 $\\text{LMP}_3 = 40.00$ 美元/MWh。\n母线 $3$ 的电价由本地昂贵的发电机 $G_3$ 决定，因为输入更便宜电力的能力受到拥塞的限制。母线 $1$ 和 $2$ 的电价由便宜的发电机 $G_1$ 决定，因为它们之间没有拥塞。\n\n线路 $(2,3)$ 上收取的拥塞租金 $R$ 是线路上潮流与线路两端 LMP 差值的乘积。\n$$\nR_{23} = F_{23} \\times (\\text{LMP}_3 - \\text{LMP}_2)\n$$\n代入数值：\n$$\nR_{23} = 60 \\text{ MW} \\times (40 \\text{ 美元/MWh} - 10 \\text{ 美元/MWh}) = 60 \\times 30 \\text{ 美元/小时} = 1800 \\text{ 美元/小时}\n$$\n这可以通过计算总负荷支付与总发电机收入之间的差额来验证。\n总负荷支付 = $\\sum_k \\text{LMP}_k d_k = \\text{LMP}_3 \\times d_3 = 40 \\times 100 = 4000$ 美元/小时。\n总发电成本 = $\\sum_i c_i p_i = (10)(60) + (20)(0) + (40)(40) = 600 + 1600 = 2200$ 美元/小时。\n拥塞租金 = 负荷支付 - 发电成本 = $4000 - 2200 = 1800$ 美元/小时，结果一致。\n\n最终数值结果四舍五入到四位有效数字是：\n- $\\text{LMP}_1 = 10.00$ 美元/MWh\n- $\\text{LMP}_2 = 10.00$ 美元/MWh\n- $\\text{LMP}_3 = 40.00$ 美元/MWh\n- $R = 1800$ 美元/小时。可写作 $1.800 \\times 10^3$。\n\n最终答案以所要求的矩阵格式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n10.00  10.00  40.00  1800\n\\end{pmatrix}\n}\n$$"
        }
    ]
}