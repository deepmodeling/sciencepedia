{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握 Benders 分解法，没有什么比亲自动手计算更能加深理解了。本练习将通过一个简化的微电网容量扩展模型，引导你逐步完成其核心迭代过程 。你将通过显式地计算主问题和子问题的解，并推导经典的 Benders 最优性割，亲眼见证该算法如何系统地逼近并最终收敛到全局最优解。",
            "id": "4071612",
            "problem": "一个孤岛微电网的单周期容量扩张模型考虑了两种技术，其容量决策向量为 $x \\in \\mathbb{R}^2$，其中 $x_1$ 是技术 1 的装机容量，$x_2$ 是技术 2 的装机容量。投资成本分别为 $c_1 = 3$ 和 $c_2 = 0.5$，周期需求为 $d = 5$。调度（运营）变量为 $y_1$、$y_2$ 和 $s$，其中 $y_1$ 和 $y_2$ 分别是技术 1 和技术 2 的发电量，$s$ 是切负荷。可变运营成本分别为 $v_1 = 2$ 和 $v_2 = 6$，切负荷惩罚为 $p = 100$。所有变量都被约束为非负。\n\n联合决定投资和运营的确定性线性规划为：\n最小化总成本 $c_1 x_1 + c_2 x_2 + v_1 y_1 + v_2 y_2 + p s$，受限于运营可行性约束\n- $y_1 \\le x_1$，\n- $y_2 \\le x_2$，\n- $y_1 + y_2 + s \\ge d$，\n- $x_1 \\ge 0$， $x_2 \\ge 0$， $y_1 \\ge 0$， $y_2 \\ge 0$， $s \\ge 0$。\n\n使用基于线性规划 (LP) 对偶和分解原理的班德斯分解法 (Benders Decomposition, BD)，将问题分解为一个关于 $x_1$、$x_2$ 和一个近似最优运营成本的辅助变量 $\\theta$ 的主问题，以及一个对于任意固定的 $(x_1,x_2)$ 关于 $(y_1,y_2,s)$ 的单一运营子问题。用平凡的初始割 $\\theta \\ge 0$ 启动 BD。然后：\n\n1. 求解第一个主问题，得到 $(x_1^{(1)}, x_2^{(1)}, \\theta^{(1)})$。\n2. 对于 $(x_1^{(1)}, x_2^{(1)})$，求解运营子问题，并利用 LP 的强对偶性，计算一个最优对偶解以推导出第一个班德斯最优性割。将此割添加到主问题中。\n3. 求解第二个主问题，得到 $(x_1^{(2)}, x_2^{(2)}, \\theta^{(2)})$。\n4. 对于 $(x_1^{(2)}, x_2^{(2)})$，求解运营子问题并计算一个最优对偶解以推导出第二个班德斯最优性割。将此割添加到主问题中。\n5. 求解第三个主问题，并验证其解 $(\\hat{x}_1, \\hat{x}_2, \\hat{\\theta})$ 满足 $\\hat{\\theta}$ 等于在 $(\\hat{x}_1, \\hat{x}_2)$ 处的真实运营成本，从而证明收敛到 LP 最优解。\n\n您必须明确计算前两个班德斯割、中间主问题解，并通过匹配主问题的下界和原始可行上界来证明收敛。\n\n原始 LP 的确切最优总成本（投资加运营）是多少？仅报告数值（无单位，不四舍五入）。",
            "solution": "### 问题验证\n**步骤 1：提取给定条件**\n- 决策变量：投资容量 $x_1 \\in \\mathbb{R}, x_2 \\in \\mathbb{R}$。运营变量：发电量 $y_1 \\in \\mathbb{R}, y_2 \\in \\mathbb{R}$，以及切负荷 $s \\in \\mathbb{R}$。\n- 成本系数：投资成本 $c_1 = 3, c_2 = 0.5$。可变运营成本 $v_1 = 2, v_2 = 6$。切负荷惩罚 $p = 100$。\n- 需求：$d = 5$。\n- 完整问题表述 (原始 LP)：\n$$ \\min_{x,y,s} \\quad 3x_1 + 0.5x_2 + 2y_1 + 6y_2 + 100s $$\n受限于：\n$$ y_1 \\le x_1 $$\n$$ y_2 \\le x_2 $$\n$$ y_1 + y_2 + s \\ge 5 $$\n$$ x_1 \\ge 0, x_2 \\ge 0, y_1 \\ge 0, y_2 \\ge 0, s \\ge 0 $$\n- 分解要求：使用班德斯分解法 (BD)，从割平面 $\\theta \\ge 0$ 开始。执行三次主问题迭代。\n\n**步骤 2：使用提取的给定条件进行验证**\n该问题是容量扩张问题的标准线性规划表述，这是运筹学和能源系统建模中一个成熟的课题。\n- **科学依据**：是。该问题基于线性规划和班德斯分解原理，这两者都是数学优化的基本概念。\n- **适定性**：是。这是一个具有非空可行域（例如，$x_1=x_2=y_1=y_2=0, s=5$）且成本函数在可行集上有下界的线性规划问题。因此，存在最优解。\n- **目标**：是。问题使用精确的数学符号和客观语言陈述。\n- 设置完整且内部一致。未发现缺陷。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整解答。\n\n### 班德斯分解法流程\n\n该问题的结构适合进行班德斯分解。投资变量 $(x_1, x_2)$ 是第一阶段（主问题）变量，运营变量 $(y_1, y_2, s)$ 是第二阶段（子问题）变量。\n\n问题可以写成：\n$$ \\min_{x_1, x_2 \\ge 0} \\left( 3x_1 + 0.5x_2 + Q(x_1, x_2) \\right) $$\n其中 $Q(x_1, x_2)$ 是对于一个固定的 $(x_1, x_2)$，运营子问题的最优值。\n\n**运营子问题 (SP):**\n对于一个固定的容量向量 $x = (x_1, x_2)$，子问题为：\n$$ Q(x) = \\min_{y_1, y_2, s \\ge 0} \\quad 2y_1 + 6y_2 + 100s $$\n受限于：\n$$ y_1 + y_2 + s \\ge 5 $$\n$$ y_1 \\le x_1 $$\n$$ y_2 \\le x_2 $$\n\n**运营子问题的对偶问题 (DSP):**\n设与三个约束相关的对偶变量分别为 $\\pi_1 \\ge 0$，$\\pi_2 \\ge 0$ 和 $\\pi_3 \\ge 0$。对偶的标准形式为 $\\min c^T y$ s.t. $Ay \\ge b$。这里，我们有 $y_1 \\le x_1 \\implies -y_1 \\ge -x_1$ 和 $y_2 \\le x_2 \\implies -y_2 \\ge -x_2$。\n对偶问题是：\n$$ \\max_{\\pi_1, \\pi_2, \\pi_3 \\ge 0} \\quad 5\\pi_1 - x_1\\pi_2 - x_2\\pi_3 $$\n受限于：\n$$ \\pi_1 - \\pi_2 \\le 2 $$\n$$ \\pi_1 - \\pi_3 \\le 6 $$\n$$ \\pi_1 \\le 100 $$\n班德斯最优性割由 $\\theta \\ge 5\\pi_1^* - x_1\\pi_2^* - x_2\\pi_3^*$ 给出，其中 $(\\pi_1^*, \\pi_2^*, \\pi_3^*)$ 是对于主问题给出的某个容量向量，DSP 的一个最优解。\n\n**迭代 1**\n1.  **求解第一个主问题 (MP1):**\n    初始主问题是：\n    $$ \\min_{x_1, x_2, \\theta \\ge 0} \\quad 3x_1 + 0.5x_2 + \\theta $$\n    受限于：\n    $$ \\theta \\ge 0 $$\n    最小值为 $0$，在 $(x_1^{(1)}, x_2^{(1)}, \\theta^{(1)}) = (0, 0, 0)$ 处取得。\n    当前总成本的下界 (LB) 是 $0$。\n\n2.  **针对 $x^{(1)}=(0, 0)$ 求解 SP1 并生成第一个割：**\n    当 $x_1=0$ 和 $x_2=0$ 时，子问题变为：\n    $$ \\min_{y_1, y_2, s \\ge 0} \\quad 2y_1 + 6y_2 + 100s $$\n    s.t. $y_1+y_2+s \\ge 5$, $y_1 \\le 0$, $y_2 \\le 0$。\n    非负性意味着 $y_1=0, y_2=0$。需求约束变为 $s \\ge 5$。为最小化成本，我们设置 $s=5$。\n    子问题的解是 $(y_1, y_2, s) = (0, 0, 5)$，运营成本为 $Q(x^{(1)}) = 100 \\times 5 = 500$。\n    这提供了一个总成本的初始上界 (UB)：$c^T x^{(1)} + Q(x^{(1)}) = 0 + 500 = 500$。\n\n    为了生成割，我们用 $x_1=0, x_2=0$ 求解 DSP：\n    $$ \\max \\quad 5\\pi_1 $$\n    s.t. $\\pi_1 - \\pi_2 \\le 2$, $\\pi_1 - \\pi_3 \\le 6$, $\\pi_1 \\le 100$, 且 $\\pi_1, \\pi_2, \\pi_3 \\ge 0$。\n    为了最大化 $5\\pi_1$，我们让 $\\pi_1$ 尽可能大。从 $\\pi_1 \\le 100$，我们设置 $\\pi_1=100$。如果能找到有效的 $\\pi_2, \\pi_3$，这是可行的。\n    $100 - \\pi_2 \\le 2 \\implies \\pi_2 \\ge 98$。选择 $\\pi_2=98$。\n    $100 - \\pi_3 \\le 6 \\implies \\pi_3 \\ge 94$。选择 $\\pi_3=94$。\n    一个最优对偶解是 $(\\pi_1^{(1)}, \\pi_2^{(1)}, \\pi_3^{(1)}) = (100, 98, 94)$。DSP 目标函数值为 $5(100) = 500$，与 SP 成本相匹配。\n    第一个班德斯最优性割是 $\\theta \\ge 5(100) - x_1(98) - x_2(94)$，即 $\\theta \\ge 500 - 98x_1 - 94x_2$。\n\n**迭代 2**\n3.  **求解第二个主问题 (MP2):**\n    $$ \\min_{x_1, x_2, \\theta \\ge 0} \\quad 3x_1 + 0.5x_2 + \\theta $$\n    受限于：\n    $$ \\theta \\ge 0 $$\n    $$ \\theta \\ge 500 - 98x_1 - 94x_2 $$\n    目标可以表述为 $\\min \\quad 3x_1 + 0.5x_2 + \\max(0, 500 - 98x_1 - 94x_2)$。\n    线性函数在一个区域上的最小值出现在其边界上。两种情况都将解推向直线 $98x_1 + 94x_2 = 500$。\n    所以我们在 $x_1, x_2 \\ge 0$ 的条件下，在直线段 $98x_1 + 94x_2 = 500$ 上最小化 $3x_1 + 0.5x_2$。\n    满足约束 $98x_1 + 94x_2 = 500$ 一单位的成本，使用 $x_1$ 是 $\\frac{3}{98} \\approx 0.0306$，使用 $x_2$ 是 $\\frac{0.5}{94} \\approx 0.0053$。使用 $x_2$ 更便宜。\n    解位于 $x_1=0$ 的角点。\n    $94x_2 = 500 \\implies x_2 = \\frac{500}{94} = \\frac{250}{47}$。\n    解是 $(x_1^{(2)}, x_2^{(2)}, \\theta^{(2)}) = (0, \\frac{250}{47}, 0)$。\n    MP2 的目标函数值为 $3(0) + 0.5(\\frac{250}{47}) + 0 = \\frac{125}{47}$。\n    新的下界是 $LB = \\frac{125}{47} \\approx 2.66$。\n\n4.  **针对 $x^{(2)}=(0, \\frac{250}{47})$ 求解 SP2 并生成第二个割：**\n    子问题是：\n    $$ \\min \\quad 2y_1 + 6y_2 + 100s $$\n    s.t. $y_1+y_2+s \\ge 5$, $y_1 \\le 0 \\implies y_1=0$, 且 $y_2 \\le \\frac{250}{47}$。\n    问题简化为最小化 $6y_2 + 100s$，受限于 $y_2+s \\ge 5$ 和 $y_2 \\le \\frac{250}{47} \\approx 5.32$。\n    由于发电 $y_2$ 的成本（6/单位）远低于切负荷 $s$ 的成本（100/单位），我们应该使用 $y_2$ 来满足 5 的需求。由于容量 $\\frac{250}{47}$ 超过需求 5，我们可以设置 $y_2=5$ 和 $s=0$。\n    子问题的解是 $(y_1, y_2, s) = (0, 5, 0)$，运营成本为 $Q(x^{(2)}) = 6 \\times 5 = 30$。\n    新的上界是 $c^T x^{(2)} + Q(x^{(2)}) = \\frac{125}{47} + 30 = \\frac{125+1410}{47} = \\frac{1535}{47} \\approx 32.66$。\n\n    我们用 $x^{(2)}=(0, \\frac{250}{47})$ 求解 DSP。根据 SP 解的互补松弛性：\n    - $y_20 \\implies$ $y_2$ 的对偶约束是紧的：$\\pi_1-\\pi_3 = 6$。\n    - $y_2  \\frac{250}{47}$ (容量未达上限) $\\implies \\pi_3=0$。\n    - 因此, $\\pi_1=6$。\n    - $y_1=0, s=0$ (非基) $\\implies$ 它们的对偶约束可能是松弛的。\n    最优对偶值必须满足所有对偶约束。我们有 $\\pi_1=6, \\pi_3=0$。剩下的约束是 $\\pi_1-\\pi_2 \\le 2 \\implies 6-\\pi_2 \\le 2 \\implies \\pi_2 \\ge 4$。我们可以选择 $\\pi_2=4$。\n    一个最优对偶解是 $(\\pi_1^{(2)}, \\pi_2^{(2)}, \\pi_3^{(2)}) = (6, 4, 0)$。\n    第二个班德斯割是 $\\theta \\ge 5(6) - x_1(4) - x_2(0)$，即 $\\theta \\ge 30 - 4x_1$。\n\n**迭代 3**\n5.  **求解第三个主问题 (MP3) 并验证收敛性：**\n    $$ \\min_{x_1, x_2, \\theta \\ge 0} \\quad 3x_1 + 0.5x_2 + \\theta $$\n    受限于：\n    $$ \\theta \\ge 500 - 98x_1 - 94x_2 $$\n    $$ \\theta \\ge 30 - 4x_1 $$\n    目标是 $\\min \\quad 3x_1 + 0.5x_2 + \\max(0, 500 - 98x_1 - 94x_2, 30 - 4x_1)$。\n    最小值将位于割函数的上包络上。我们分析两个割相交的地方：\n    $500 - 98x_1 - 94x_2 = 30 - 4x_1 \\implies 470 = 94x_1 + 94x_2 \\implies x_1 + x_2 = 5$。\n    在这条线上，可以通过用其中一个割表达式替换 $\\theta$ 来找到目标函数：\n    $z = 3x_1 + 0.5x_2 + (30 - 4x_1) = -x_1 + 0.5x_2 + 30$。\n    现在代入 $x_2=5-x_1$：\n    $z = -x_1 + 0.5(5-x_1) + 30 = -x_1 + 2.5 - 0.5x_1 + 30 = -1.5x_1 + 32.5$。\n    为了最小化 $z$，我们必须在 $x_1, x_2 \\ge 0$ 的线段 $x_1+x_2=5$ 上最大化 $x_1$。这意味着 $x_1 \\in [0, 5]$。\n    最大的 $x_1$ 是 $5$，这意味着 $x_2=0$。\n    MP3 的解是 $(\\hat{x}_1, \\hat{x}_2) = (5, 0)$。\n    在这一点上，$\\hat{\\theta} = 30 - 4(5) = 10$。这也与第一个割一致：$500 - 98(5) - 94(0) = 500 - 490 = 10$。\n    MP3 的解是 $(\\hat{x}_1, \\hat{x}_2, \\hat{\\theta}) = (5, 0, 10)$。\n    新的下界是 $LB = 3(5) + 0.5(0) + 10 = 25$。\n\n    **收敛性检查：** 我们为 $\\hat{x}=(5, 0)$ 求解 SP。\n    $$ \\min \\quad 2y_1 + 6y_2 + 100s $$\n    s.t. $y_1+y_2+s \\ge 5$, $y_1 \\le 5$, $y_2 \\le 0 \\implies y_2=0$。\n    问题简化为最小化 $2y_1 + 100s$，受限于 $y_1+s \\ge 5$ 和 $y_1 \\le 5$。\n    经济的选择是使用成本为 2 的 $y_1$ 而不是成本为 100 的 $s$。我们设置 $y_1=5, s=0$。\n    运营成本是 $Q(\\hat{x}) = 2(5) = 10$。\n    我们观察到主问题中的 $\\hat{\\theta} = 10$ 等于子问题成本 $Q(\\hat{x}) = 10$。班德斯算法已收敛。\n\n    最优总成本是 MP3 的最终下界（此时等于上界）：\n    总成本 = $c^T\\hat{x} + \\hat{\\theta} = 3(5) + 0.5(0) + 10 = 25$。\n    或者，总成本 = $c^T\\hat{x} + Q(\\hat{x}) = 15 + 10 = 25$。\n\n确切的最优总成本是 25。",
            "answer": "$$ \\boxed{25} $$"
        },
        {
            "introduction": "Benders 分解法在实际应用中，常常会遇到主问题的决策导致子问题无解的情况。本练习旨在解决这一关键场景，让你超越理想化的最优性割 。你将学习如何从原理上区分最优性割与可行性割，并为一个能源规划问题推导出一个可行性割，运用线性规划对偶的基本原理来“切掉”不可行的主问题解。",
            "id": "4071643",
            "problem": "考虑一个两阶段线性储能规划模型，其中第一阶段决定装机容量，第二阶段调度发电以满足需求。第一阶段（主问题）变量是两种技术 A 和 B 的装机容量 $x_{A}$ 和 $x_{B}$（单位：兆瓦，MW）。对于给定的 $(x_{A}, x_{B})$，第二阶段（运营）子问题选择分时段调度 $y_{A,1}$、$y_{B,1}$、$y_{A,2}$、$y_{B,2}$（单位：MW），以在无弃负荷的情况下，满足需求和容量可用性约束的条件下，最小化运营成本。\n\n运营子问题为\n$$\n\\begin{aligned}\n\\min_{y_{A,1},y_{B,1},y_{A,2},y_{B,2}} \\quad  c_{A,1}\\,y_{A,1} + c_{B,1}\\,y_{B,1} + c_{A,2}\\,y_{A,2} + c_{B,2}\\,y_{B,2} \\\\\n\\text{s.t.} \\quad  y_{A,1} + y_{B,1} \\ge d_{1}, \\\\\n y_{A,2} + y_{B,2} \\ge d_{2}, \\\\\n y_{A,1} \\le a_{A,1}\\,x_{A}, \\\\\n y_{B,1} \\le a_{B,1}\\,x_{B}, \\\\\n y_{A,2} \\le a_{A,2}\\,x_{A}, \\\\\n y_{B,2} \\le a_{B,2}\\,x_{B}, \\\\\n y_{A,1},y_{B,1},y_{A,2},y_{B,2} \\ge 0,\n\\end{aligned}\n$$\n其中 $d_{1}$ 和 $d_{2}$ 是时段需求，$a_{g,t}$ 是将装机容量映射到每个时段可用容量的可用率因子（无量纲）。假设 $d_{1} = 95$，$d_{2} = 60$，$a_{A,1} = 0.40$，$a_{B,1} = 0.50$，$a_{A,2} = 0.90$，$a_{B,2} = 0.60$，并且当前主阶段的迭代值为 $\\hat{x}_{A} = 120$ 和 $\\hat{x}_{B} = 50$。运营成本系数 $c_{g,t}$ 是任意有限非负数，分析可行性时无需指定。\n\n在 Benders 分解（也称 L 型方法）的背景下，从第一性原理出发，在线性规划对偶性、极射线与极点的层面上，解释可行性割和最优性割之间的区别。然后，针对上述具体数据，识别运营子问题中的不可行性来源，并推导一个与不可行时段相关的 Benders 可行性割。你的推导必须从线性规划对偶性和通过极射线表征不可行性的有效基础出发，并且必须生成一个关于主变量的线性割，该割能排除不可行的 $(\\hat{x}_{A}, \\hat{x}_{B})$ 并为有问题的时段强制子问题可行。\n\n将可行性割计算为单一线性表达式 $\\phi(x_{A}, x_{B})$，对于任何 $(x_{A}, x_{B})$，该表达式的非正性保证了运营子问题时段 1 的可行性。用兆瓦（MW）表示你的最终表达式。无需四舍五入。",
            "solution": "本题要求对 Benders 可行性割和最优性割进行原理性解释，然后对给定的两阶段储能规划模型推导一个具体的可行性割。\n\n首先，对问题进行验证。\n\n**步骤 1：提取已知条件**\n- 主变量（装机容量，MW）：$x_{A}$, $x_{B}$\n- 第二阶段变量（调度量，MW）：$y_{A,1}$, $y_{B,1}$, $y_{A,2}$, $y_{B,2}$\n- 运营子问题目标函数：$\\min_{y} \\sum_{g,t} c_{g,t} y_{g,t}$，其中 $c_{g,t} \\ge 0$ 是有限成本。\n- 运营子问题约束：\n  - $y_{A,1} + y_{B,1} \\ge d_{1}$\n  - $y_{A,2} + y_{B,2} \\ge d_{2}$\n  - $y_{A,1} \\le a_{A,1}\\,x_{A}$\n  - $y_{B,1} \\le a_{B,1}\\,x_{B}$\n  - $y_{A,2} \\le a_{A,2}\\,x_{A}$\n  - $y_{B,2} \\le a_{B,2}\\,x_{B}$\n  - $y_{A,1}, y_{B,1}, y_{A,2}, y_{B,2} \\ge 0$\n- 数据：\n  - 需求时段 1：$d_{1} = 95$ MW\n  - 需求时段 2：$d_{2} = 60$ MW\n  - 可用率因子：$a_{A,1} = 0.40$, $a_{B,1} = 0.50$, $a_{A,2} = 0.90$, $a_{B,2} = 0.60$\n- 当前主阶段迭代值：$\\hat{x}_{A} = 120$ MW, $\\hat{x}_{B} = 50$ MW\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是 Benders 分解在两阶段随机线性规划中的一个标准应用，这是运筹学和能源系统建模中的一个经典课题。该问题具有科学依据且客观。为了检查一致性，我们在给定的迭代点 $(\\hat{x}_{A}, \\hat{x}_{B}) = (120, 50)$ 处评估运营子问题的可行性。运营子问题按时间段解耦。\n\n对于时段 1，发电的约束为：\n- $y_{A,1} \\le a_{A,1}\\,\\hat{x}_{A} = 0.40 \\times 120 = 48$ MW\n- $y_{B,1} \\le a_{B,1}\\,\\hat{x}_{B} = 0.50 \\times 50 = 25$ MW\n时段 1 的最大可能发电量为 $y_{A,1} + y_{B,1} \\le 48 + 25 = 73$ MW。\n需求为 $d_{1} = 95$ MW。\n由于最大可能发电量（73 MW）小于需求量（95 MW），需求约束 $y_{A,1} + y_{B,1} \\ge 95$ 无法满足。因此，时段 1 的运营子问题是不可行的。\n\n对于时段 2，最大发电量为 $a_{A,2}\\,\\hat{x}_{A} + a_{B,2}\\,\\hat{x}_{B} = 0.90 \\times 120 + 0.60 \\times 50 = 108 + 30 = 138$ MW。需求为 $d_{2} = 60$ MW。由于 $138  60$，时段 2 的子问题是可行的。\n\n由于时段 1 的不可行性，整个运营子问题是不可行的。问题设定是一致且适定的。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整解答。\n\n**第一部分：最优性割与可行性割的区别**\n\nBenders 分解解决以下形式的问题：\n$$\n\\min_{x, \\theta} \\quad z^T x + \\theta \\\\\n\\text{s.t.} \\quad x \\in X \\\\\n\\theta \\ge Q(x)\n$$\n其中 $Q(x)$ 是由第一阶段决策 $x$ 参数化的第二阶段线性规划（子问题）的最优值：\n$$\nQ(x) = \\min_{y} \\quad q^T y \\\\\n\\text{s.t.} \\quad Ty + Wy \\ge h\n$$\n这里，为简化符号，我们假设对 $x$ 的依赖关系由矩阵 $T$ 和右端向量 $h$ 捕获，使得约束为 $Wy \\ge h - Tx$。在我们的问题中，$x = (x_A, x_B)^T$，$y$ 是调度变量的向量。该算法通过向主问题添加线性约束（割）来迭代地逼近函数 $Q(x)$。\n\n当子问题对于给定的主问题解 $\\hat{x}$ 是可行且有界时，生成一个**最优性割**。根据线性规划对偶性，子问题的对偶问题是：\n$$\n\\max_{\\pi} \\quad (h - T\\hat{x})^T \\pi \\\\\n\\text{s.t.} \\quad W^T \\pi \\le q, \\quad \\pi \\ge 0\n$$\n设 $\\hat{\\pi}$ 是此对偶问题的最优解。$\\hat{\\pi}$ 是对偶可行域的一个极点。根据强对偶性，$Q(\\hat{x}) = (h - T\\hat{x})^T \\hat{\\pi}$。由于 $Q(x)$ 是一个凸函数，这为其上镜图提供了一个支撑超平面。由此产生的约束，称为最优性割，被添加到主问题中：\n$$\n\\theta \\ge (h - Tx)^T \\hat{\\pi}\n$$\n这个割对所有 $x$ 施加了一个关于 $\\theta$ 的下界，确保 $\\theta$ 最终会收敛到最优 $x$ 的真实子问题成本。\n\n当子问题对于给定的主问题解 $\\hat{x}$ 不可行时，生成一个**可行性割**。一个不可行的原线性规划问题意味着其对偶问题是无界的或不可行的。在 Benders 分解的背景下，对偶子问题被构造成总是可行的（例如，$\\pi=0$ 通常是一个可行解），所以它必须是无界的。\n\n对偶问题的无界性意味着其对偶可行域的衰退锥存在一条极射线。该衰退锥定义为 $\\{ \\bar{\\pi} \\mid W^T \\bar{\\pi} \\le 0, \\bar{\\pi} \\ge 0 \\}$。由向量 $\\bar{\\pi}$ 表示的极射线，如果对偶目标沿其增加，即 $(h - T\\hat{x})^T \\bar{\\pi}  0$，则它是一个无界方向。这个条件是原问题不可行性的一个凭证，这一结果由 Farkas 引理概括。\n\n为使原子问题对任何给定的 $x$ 可行，其对偶问题必须不是无界的。这要求对于对偶锥的每一条极射线 $\\bar{\\pi}$，沿该射线的目标变化必须是非正的：\n$$\n(h - Tx)^T \\bar{\\pi} \\le 0\n$$\n这个不等式就是一个 Benders 可行性割。它是对主变量 $x$ 本身的约束，而不是对 $\\theta$ 的约束，它将不可行的主问题解 $\\hat{x}$ 从主问题的可行集中“切除”。\n\n**第二部分：可行性割的推导**\n\n整个子问题是不可行的，因为时段 1 的约束无法满足。我们关注这个有问题的时段。时段 1 的子问题是：\n$$\n\\begin{aligned}\n\\min_{y_{A,1}, y_{B,1}} \\quad  c_{A,1}\\,y_{A,1} + c_{B,1}\\,y_{B,1} \\\\\n\\text{s.t.} \\quad  y_{A,1} + y_{B,1} \\ge d_{1} \\\\\n y_{A,1} \\le a_{A,1}\\,x_{A} \\\\\n y_{B,1} \\le a_{B,1}\\,x_{B} \\\\\n y_{A,1}, y_{B,1} \\ge 0\n\\end{aligned}\n$$\n为应用对偶理论，我们将约束重写为标准形式 $Ay \\ge b$：\n$$\n\\begin{aligned}\ny_{A,1} + y_{B,1} \\ge d_{1} \\quad (\\text{对偶变量 } \\pi_1 \\ge 0) \\\\\n-y_{A,1} \\ge -a_{A,1}\\,x_{A} \\quad (\\text{对偶变量 } \\pi_2 \\ge 0) \\\\\n-y_{B,1} \\ge -a_{B,1}\\,x_{B} \\quad (\\text{对偶变量 } \\pi_3 \\ge 0)\n\\end{aligned}\n$$\n对偶问题是：\n$$\n\\begin{aligned}\n\\max_{\\pi_1, \\pi_2, \\pi_3} \\quad  d_1 \\pi_1 - a_{A,1}x_A \\pi_2 - a_{B,1}x_B \\pi_3 \\\\\n\\text{s.t.} \\quad  \\pi_1 - \\pi_2 \\le c_{A,1} \\\\\n \\pi_1 - \\pi_3 \\le c_{B,1} \\\\\n \\pi_1, \\pi_2, \\pi_3 \\ge 0\n\\end{aligned}\n$$\n对于 $(\\hat{x}_{A}, \\hat{x}_{B}) = (120, 50)$，原问题是不可行的，因此对偶问题必须是无界的。我们需要找到对偶问题衰退锥的一条极射线。该锥由齐次对偶约束定义：\n$$\n\\begin{aligned}\n \\bar{\\pi}_1 - \\bar{\\pi}_2 \\le 0 \\\\\n \\bar{\\pi}_1 - \\bar{\\pi}_3 \\le 0 \\\\\n \\bar{\\pi}_1, \\bar{\\pi}_2, \\bar{\\pi}_3 \\ge 0\n\\end{aligned}\n$$\n通过将 $n-1 = 3-1 = 2$ 个约束设为紧约束可以找到一条极射线。我们设 $\\bar{\\pi}_1 - \\bar{\\pi}_2 = 0$ 和 $\\bar{\\pi}_1 - \\bar{\\pi}_3 = 0$。这意味着 $\\bar{\\pi}_1 = \\bar{\\pi}_2 = \\bar{\\pi}_3$。我们可以通过设置 $\\bar{\\pi}_1 = 1$ 来选择此射线的一个代表向量，得到射线方向 $\\bar{\\pi} = (1, 1, 1)^T$。\n\n我们必须验证对于迭代值 $(\\hat{x}_{A}, \\hat{x}_{B})$，这条射线会导致目标函数无界。沿该射线的目标函数变化为：\n$$\nd_1 \\bar{\\pi}_1 - a_{A,1}\\hat{x}_A \\bar{\\pi}_2 - a_{B,1}\\hat{x}_B \\bar{\\pi}_3 = d_1(1) - a_{A,1}\\hat{x}_A(1) - a_{B,1}\\hat{x}_B(1)\n$$\n代入给定值：\n$$\n95 - (0.40)(120) - (0.50)(50) = 95 - 48 - 25 = 22\n$$\n由于 $22  0$，目标函数沿该射线增加，证实了对偶问题是无界的，并且 $\\bar{\\pi}=(1,1,1)^T$ 是一条有效的上升射线。\n\nBenders 可行性割源于这样一个条件：对于任何可行的主问题解 $(x_{A}, x_{B})$，对偶目标函数沿此射线必须不是无界的。这意味着目标函数的变化必须是非正的：\n$$\nd_1 \\bar{\\pi}_1 - a_{A,1}x_A \\bar{\\pi}_2 - a_{B,1}x_B \\bar{\\pi}_3 \\le 0\n$$\n代入射线分量 $\\bar{\\pi}=(1,1,1)^T$：\n$$\nd_1(1) - a_{A,1}x_A (1) - a_{B,1}x_B (1) \\le 0\n$$\n代入常数值：\n$$\n95 - 0.40 x_A - 0.50 x_B \\le 0\n$$\n这个割正确地排除了不可行点 $(\\hat{x}_{A}, \\hat{x}_{B}) = (120, 50)$，因为 $95 - 0.40(120) - 0.50(50) = 22 \\not\\le 0$。该割要求时段 1 的总可用容量必须至少等于需求，即 $a_{A,1}x_A + a_{B,1}x_B \\ge d_1$。\n\n题目要求找到表达式 $\\phi(x_{A}, x_{B})$，使得割为 $\\phi(x_{A}, x_{B}) \\le 0$。因此，该表达式为：\n$$\n\\phi(x_{A}, x_{B}) = 95 - 0.40 x_A - 0.50 x_B\n$$\n该表达式的单位是 MW，因为 $95$ 的单位是 MW，而项 $0.40 x_A$ 和 $0.50 x_B$ 的单位也是 MW（无量纲因子乘以 MW）。",
            "answer": "$$\\boxed{95 - 0.40 x_{A} - 0.50 x_{B}}$$"
        },
        {
            "introduction": "现在我们将目光转向 Benders 分解法的强大对偶方法——Dantzig-Wolfe 分解法，它通过一种称为“列生成”的技术被广泛应用于大规模调度问题。在本练习中，你将处理一个能源调度问题，其中每一个“列”都代表一个发电机组的可行运行计划 。你的核心任务是构建并求解“定价子问题”，即利用主问题的对偶信息来生成能降低总成本的新列。",
            "id": "4071641",
            "problem": "考虑一个基于 Dantzig–Wolfe 分解的能源系统调度模型，其中限制主问题 (RMP) 在多个列之间进行选择，每个列代表单个火力发电机组在有限时间范围内的可行小时调度方案。RMP 的目标是在通过列的凸组合精确满足需求的同时，最小化系统总成本。该分解建立在线性规划对偶和可行集凸化等经过充分检验的理论基础之上。设时间范围为 $T = 4$ 小时，索引为 $t \\in \\{1,2,3,4\\}$。在 RMP 中，耦合约束强制执行每小时的供需平衡，并具有相关的对偶乘子。\n\n您的任务是为一个火力发电机组推导定价问题（即列生成子问题），该机组的可行集由二进制启停决策和受逻辑与爬坡约束的连续功率输出定义。请使用以下经过充分检验的混合整数线性规划 (MILP) 机组模型假设：\n- 对于每小时 $t$，机组具有启停状态 $u_t \\in \\{0,1\\}$ 和启动指示变量 $y_t \\in \\{0,1\\}$。\n- 对于每小时 $t$，机组的功率输出为 $p_t \\ge 0$。\n- 逻辑和发电能力约束成立：$p_t \\le P^{\\max} u_t$，$p_t \\ge P^{\\min} u_t$ 和 $y_t \\ge u_t - u_{t-1}$，给定 $u_0 = 0$ 和 $p_0 = 0$。\n- 对称的每小时爬坡限制成立：对于所有 $t \\in \\{1,2,3,4\\}$，$p_t - p_{t-1} \\le R$ 和 $p_{t-1} - p_t \\le R$。\n\nRMP 是一个带有等式耦合约束的最小化问题，其小时 $t=1,2,3,4$ 的对偶乘子由 $\\pi_1$, $\\pi_2$, $\\pi_3$, $\\pi_4$ 给出，单位均为 $\\text{USD}/\\text{MWh}$。设一个列中机组的成本是每次启动成本和可变能源成本之和：每次启动的启动成本为 $c_s$（单位为 $\\text{USD}$），应用于 $p_t$ 的可变成本为 $c_v$（单位为 $\\text{USD}/\\text{MWh}$）。\n\n从线性规划中判别数的基础定义和标准的 Dantzig–Wolfe 分解设置出发，推导出为该单个机组计算要添加到 RMP 中的最小判别数列的定价问题。然后，使用以下数值数据：\n- $P^{\\min} = 50$ $\\text{MW}$，$P^{\\max} = 200$ $\\text{MW}$，\n- $R = 80$ $\\text{MW}/\\text{h}$，\n- $c_s = 500$ $\\text{USD}$，$c_v = 30$ $\\text{USD}/\\text{MWh}$，\n- $\\pi_1 = 45$ $\\text{USD}/\\text{MWh}$，$\\pi_2 = 60$ $\\text{USD}/\\text{MWh}$，$\\pi_3 = 40$ $\\text{USD}/\\text{MWh}$，$\\pi_4 = 50$ $\\text{USD}/\\text{MWh}$，\n\n计算该机组定价问题的最优值（即最小判别数）。请以美元 (USD) 为单位表达您的最终答案。无需四舍五入；报告精确值。",
            "solution": "我们从 Dantzig–Wolfe 分解中限制主问题 (RMP) 的基础设置开始。令每个列 $j$ 代表机组在时间范围 $t \\in \\{1,2,3,4\\}$ 内的一个可行调度方案，其关联成本为 $c_j$，每小时能量贡献向量为 $(a_{1j}, a_{2j}, a_{3j}, a_{4j})$。RMP 是一个线性规划问题，其目标是最小化 $\\sum_{j} c_j x_j$，并受制于耦合约束\n$$\n\\sum_{j} a_{tj} x_j = D_t \\quad \\text{for all } t \\in \\{1,2,3,4\\},\n$$\n以及 $x_j \\ge 0$，其中 $D_t$ 是每小时的需求量，$x_j$ 是列权重。根据线性规划对偶理论，等式约束为每个小时 $t$ 产生一个对偶变量 $\\pi_t$（符号自由）。\n\n列 $j$ 的判别数由以下经过充分检验的规则定义：\n$$\nr_j = c_j - \\sum_{t=1}^{4} \\pi_t a_{tj}.\n$$\n在为最小化 RMP 进行列生成时，我们寻找具有负判别数的列以改进目标函数。对于一个特定的机组，定价问题是在该机组的可行集 $\\mathcal{S}$ 上最小化判别数：\n$$\n\\min_{s \\in \\mathcal{S}} \\left( c(s) - \\sum_{t=1}^{4} \\pi_t a_t(s) \\right),\n$$\n其中 $s$ 编码了机组的启停和输出轨迹，$c(s)$ 是机组在时间范围内的成本，$a_t(s)$ 是调度方案 $s$ 在小时 $t$ 供应的能量。\n\n我们现在使用 MILP 机组模型来实例化 $c(s)$ 和 $a_t(s)$。令 $u_t \\in \\{0,1\\}$ 表示启停状态，$y_t \\in \\{0,1\\}$ 表示启动指示变量，$p_t \\ge 0$ 表示功率输出。可行集 $\\mathcal{S}$ 由以下条件刻画：\n- 发电能力约束：对于所有 $t$，$p_t \\le P^{\\max} u_t$ 且 $p_t \\ge P^{\\min} u_t$。\n- 启动逻辑：$y_t \\ge u_t - u_{t-1}$，其中 $u_0 = 0$ 和 $p_0 = 0$。\n- 爬坡约束：对于所有 $t$，$p_t - p_{t-1} \\le R$ 且 $p_{t-1} - p_t \\le R$。\n\n成本函数为\n$$\nc(s) = c_s \\sum_{t=1}^{4} y_t + c_v \\sum_{t=1}^{4} p_t,\n$$\n能量贡献则简化为 $a_t(s) = p_t$。\n\n因此，定价问题是一个混合整数线性规划 (MILP) 问题：\n$$\n\\min_{u_t, y_t, p_t} \\left[ c_s \\sum_{t=1}^{4} y_t + \\sum_{t=1}^{4} \\left( c_v - \\pi_t \\right) p_t \\right]\n$$\n受制于\n\\begin{align*}\n p_t \\le P^{\\max} u_t \\quad \\text{for } t=1,2,3,4, \\\\\n p_t \\ge P^{\\min} u_t \\quad \\text{for } t=1,2,3,4, \\\\\n y_t \\ge u_t - u_{t-1} \\quad \\text{for } t=1,2,3,4, \\\\\n p_t - p_{t-1} \\le R \\quad \\text{for } t=1,2,3,4, \\\\\n p_{t-1} - p_t \\le R \\quad \\text{for } t=1,2,3,4, \\\\\n u_t \\in \\{0,1\\}, \\; y_t \\in \\{0,1\\}, \\; p_t \\ge 0, \\\\\n u_0 = 0, \\; p_0 = 0.\n\\end{align*}\n\n使用给定的数值参数：\n- $P^{\\min} = 50$, $P^{\\max} = 200$, $R = 80$,\n- $c_s = 500$, $c_v = 30$,\n- $\\pi_1 = 45$, $\\pi_2 = 60$, $\\pi_3 = 40$, $\\pi_4 = 50$,\n\n$p_t$ 的目标函数系数变为\n\\begin{align*}\n c_v - \\pi_1 = 30 - 45 = -15, \\\\\n c_v - \\pi_2 = 30 - 60 = -30, \\\\\n c_v - \\pi_3 = 30 - 40 = -10, \\\\\n c_v - \\pi_4 = 30 - 50 = -20.\n\\end{align*}\n因此，定价问题的目标函数是\n$$\n\\min \\left[ 500 \\sum_{t=1}^{4} y_t + (-15) p_1 + (-30) p_2 + (-10) p_3 + (-20) p_4 \\right].\n$$\n\n因为所有的 $c_v - \\pi_t$ 均为负值，增加 $p_t$ 会降低目标函数值（对最小化有利），但这受到发电能力和爬坡约束的限制，并且在从关机到开机时会产生启动成本。最优策略是产生一次启动成本，并尽可能早地开始发电，以利用所有负系数，并在满足 $P^{\\max}$ 和 $R$ 的前提下尽可能多地发电。\n\n从 $u_0 = 0$ 和 $p_0 = 0$ 开始，如果我们从 $t=1$ 启动（$u_1=1$, $y_1=1$），爬坡和发电能力约束得出：\n- 在 $t=1$ 时：$p_1 \\in [50, \\min(200, 0 + 80)] = [50, 80]$，因此选择 $p_1 = 80$。\n- 在 $t=2$ 时：$p_2 \\in [50, \\min(200, 80 + 80)] = [50, 160]$，因此选择 $p_2 = 160$。\n- 在 $t=3$ 时：$p_3 \\in [50, \\min(200, 160 + 80)] = [50, 200]$，因此选择 $p_3 = 200$。\n- 在 $t=4$ 时：$p_4 \\in [50, \\min(200, 200 + 80)] = [50, 200]$，因此选择 $p_4 = 200$。\n\n在整个时段保持机组运行可以避免额外的启动，因此 $\\sum_{t=1}^{4} y_t = 1$。在此调度方案下，目标函数值为\n\\begin{align*}\n 500 \\cdot 1 + (-15) \\cdot 80 + (-30) \\cdot 160 + (-10) \\cdot 200 + (-20) \\cdot 200 \\\\\n= 500 - 1200 - 4800 - 2000 - 4000 \\\\\n= 500 - 12000 \\\\\n= -11500.\n\\end{align*}\n\n我们简要检查其他方案以确保最优性：\n- 保持关机状态的目标函数值为 $0$，高于 $-11500$（对于最小化问题而言更差）。\n- 稍后启动（例如，在 $t=2$ 时）会减少可利用的负系数，并受到爬坡约束，导致一个较差的目标函数值（例如，$-7500$）。\n- 多次启动会增加 $\\sum y_t$ 并产生额外的启动成本；鉴于 $c_v - \\pi_t$ 系数均为负，单个连续运行周期并采用最大可行输出是更优的。\n\n因此，该定价问题的最优判别数为 $-11500$ $\\text{USD}$。",
            "answer": "$$\\boxed{-11500}$$"
        }
    ]
}