{
    "hands_on_practices": [
        {
            "introduction": "Mastering Benders decomposition begins with a hands-on walk-through of its core mechanics. This first practice exercise provides just that, using a small-scale capacity expansion problem to illustrate the iterative dialogue between the master problem and the operational subproblem. By manually calculating the solutions and deriving the optimality cuts, you will build a concrete understanding of how the algorithm converges to the optimal solution by progressively building a more accurate approximation of the subproblem's cost function .",
            "id": "4071612",
            "problem": "A single-period capacity expansion model for an islanded microgrid considers two technologies with capacity decision vector $x \\in \\mathbb{R}^2$, where $x_1$ is the installed capacity of Technology $1$ and $x_2$ is the installed capacity of Technology $2$. Investment costs are $c_1 = 3$ and $c_2 = 0.5$, and the period demand is $d = 5$. The dispatch (operational) variables are $y_1$, $y_2$, and $s$, where $y_1$ and $y_2$ are generation from Technologies $1$ and $2$, respectively, and $s$ is load shedding. Variable operating costs are $v_1 = 2$ and $v_2 = 6$, and the load shedding penalty is $p = 100$. All variables are constrained to be nonnegative.\n\nThe deterministic linear program that jointly decides investments and operations is:\nMinimize the total cost $c_1 x_1 + c_2 x_2 + v_1 y_1 + v_2 y_2 + p s$ subject to the operational feasibility constraints\n- $y_1 \\le x_1$,\n- $y_2 \\le x_2$,\n- $y_1 + y_2 + s \\ge d$,\n- $x_1 \\ge 0$, $x_2 \\ge 0$, $y_1 \\ge 0$, $y_2 \\ge 0$, $s \\ge 0$.\n\nUsing Benders Decomposition (BD) grounded in Linear Programming (LP) duality and the decomposition principle, decompose the problem into a master problem over $x_1$, $x_2$, and an auxiliary variable $\\theta$ that approximates the optimal operational cost, and a single operational subproblem over $(y_1,y_2,s)$ for any fixed $(x_1,x_2)$. Start the BD with the trivial initial cut $\\theta \\ge 0$. Then:\n\n1. Solve the first master problem to obtain $(x_1^{(1)}, x_2^{(1)}, \\theta^{(1)})$.\n2. For $(x_1^{(1)}, x_2^{(1)})$, solve the operational subproblem and, using strong duality of LPs, compute an optimal dual solution to derive the first Benders optimality cut. Add this cut to the master.\n3. Solve the second master problem to obtain $(x_1^{(2)}, x_2^{(2)}, \\theta^{(2)})$.\n4. For $(x_1^{(2)}, x_2^{(2)})$, solve the operational subproblem and compute an optimal dual solution to derive the second Benders optimality cut. Add this cut to the master.\n5. Solve the third master problem and verify that its solution $(\\hat{x}_1, \\hat{x}_2, \\hat{\\theta})$ satisfies $\\hat{\\theta}$ equal to the true operational cost at $(\\hat{x}_1, \\hat{x}_2)$, thereby showing convergence to the LP optimum.\n\nYou must explicitly compute the first two Benders cuts, the intermediate master solutions, and demonstrate convergence by matching the master’s lower bound and the primal feasible upper bound.\n\nWhat is the exact optimal total cost (investment plus operation) of the original LP? Report only the numerical value (no units, no rounding).",
            "solution": "### Problem Validation\n**Step 1: Extract Givens**\n- Decision variables: Investment capacities $x_1 \\in \\mathbb{R}, x_2 \\in \\mathbb{R}$. Operational variables: generation $y_1 \\in \\mathbb{R}, y_2 \\in \\mathbb{R}$, and load shedding $s \\in \\mathbb{R}$.\n- Cost coefficients: Investment costs $c_1 = 3, c_2 = 0.5$. Variable operating costs $v_1 = 2, v_2 = 6$. Load shedding penalty $p = 100$.\n- Demand: $d = 5$.\n- Full problem formulation (Primal LP):\n$$ \\min_{x,y,s} \\quad 3x_1 + 0.5x_2 + 2y_1 + 6y_2 + 100s $$\nSubject to:\n$$ y_1 \\le x_1 $$\n$$ y_2 \\le x_2 $$\n$$ y_1 + y_2 + s \\ge 5 $$\n$$ x_1 \\ge 0, x_2 \\ge 0, y_1 \\ge 0, y_2 \\ge 0, s \\ge 0 $$\n- Decomposition requirements: Use Benders Decomposition (BD) starting with cut $\\theta \\ge 0$. Perform three master problem iterations.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard linear programming formulation for a capacity expansion problem, a well-established topic in operations research and energy systems modeling.\n- **Scientifically Grounded**: Yes. The problem is based on linear programming and the Benders decomposition principle, both of which are fundamental concepts in mathematical optimization.\n- **Well-Posed**: Yes. It is a linear program with a non-empty feasible region (e.g., $x_1=x_2=y_1=y_2=0, s=5$) and a cost function that is bounded below on the feasible set. Thus, an optimal solution exists.\n- **Objective**: Yes. The problem is stated using precise mathematical notation and objective language.\n- The setup is complete and internally consistent. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n### Benders Decomposition Procedure\n\nThe problem is structured for Benders decomposition. The investment variables $(x_1, x_2)$ are the first-stage (master) variables, and the operational variables $(y_1, y_2, s)$ are the second-stage (subproblem) variables.\n\nThe problem can be written as:\n$$ \\min_{x_1, x_2 \\ge 0} \\left( 3x_1 + 0.5x_2 + Q(x_1, x_2) \\right) $$\nwhere $Q(x_1, x_2)$ is the optimal value of the operational subproblem for a fixed $(x_1, x_2)$.\n\n**Operational Subproblem (SP):**\nFor a fixed capacity vector $x = (x_1, x_2)$, the subproblem is:\n$$ Q(x) = \\min_{y_1, y_2, s \\ge 0} \\quad 2y_1 + 6y_2 + 100s $$\nSubject to:\n$$ y_1 + y_2 + s \\ge 5 $$\n$$ y_1 \\le x_1 $$\n$$ y_2 \\le x_2 $$\n\n**Dual of the Operational Subproblem (DSP):**\nLet the dual variables associated with the three constraints be $\\pi_1 \\ge 0$, $\\pi_2 \\ge 0$, and $\\pi_3 \\ge 0$, respectively. The standard form for duality is $\\min c^T y$ s.t. $Ay \\ge b$. Here, we have $y_1 \\le x_1 \\implies -y_1 \\ge -x_1$ and $y_2 \\le x_2 \\implies -y_2 \\ge -x_2$.\nThe dual problem is:\n$$ \\max_{\\pi_1, \\pi_2, \\pi_3 \\ge 0} \\quad 5\\pi_1 - x_1\\pi_2 - x_2\\pi_3 $$\nSubject to:\n$$ \\pi_1 - \\pi_2 \\le 2 $$\n$$ \\pi_1 - \\pi_3 \\le 6 $$\n$$ \\pi_1 \\le 100 $$\nA Benders optimality cut is given by $\\theta \\ge 5\\pi_1^* - x_1\\pi_2^* - x_2\\pi_3^*$, where $(\\pi_1^*, \\pi_2^*, \\pi_3^*)$ is an optimal solution to the DSP for a given capacity vector from the master problem.\n\n**Iteration 1**\n1.  **Solve the first Master Problem (MP1):**\n    The initial master problem is:\n    $$ \\min_{x_1, x_2, \\theta \\ge 0} \\quad 3x_1 + 0.5x_2 + \\theta $$\n    Subject to:\n    $$ \\theta \\ge 0 $$\n    The minimum value is $0$, achieved at $(x_1^{(1)}, x_2^{(1)}, \\theta^{(1)}) = (0, 0, 0)$.\n    The current lower bound (LB) on the total cost is $0$.\n\n2.  **Solve SP1 for $x^{(1)}=(0, 0)$ and generate the first cut:**\n    With $x_1=0$ and $x_2=0$, the subproblem becomes:\n    $$ \\min_{y_1, y_2, s \\ge 0} \\quad 2y_1 + 6y_2 + 100s $$\n    s.t. $y_1+y_2+s \\ge 5$, $y_1 \\le 0$, $y_2 \\le 0$.\n    Non-negativity implies $y_1=0, y_2=0$. The demand constraint becomes $s \\ge 5$. To minimize cost, we set $s=5$.\n    The subproblem solution is $(y_1, y_2, s) = (0, 0, 5)$, with an operational cost of $Q(x^{(1)}) = 100 \\times 5 = 500$.\n    This provides an initial upper bound (UB) on the total cost: $c^T x^{(1)} + Q(x^{(1)}) = 0 + 500 = 500$.\n\n    To generate the cut, we solve the DSP with $x_1=0, x_2=0$:\n    $$ \\max \\quad 5\\pi_1 $$\n    s.t. $\\pi_1 - \\pi_2 \\le 2$, $\\pi_1 - \\pi_3 \\le 6$, $\\pi_1 \\le 100$, and $\\pi_1, \\pi_2, \\pi_3 \\ge 0$.\n    To maximize $5\\pi_1$, we make $\\pi_1$ as large as possible. From $\\pi_1 \\le 100$, we set $\\pi_1=100$. This is feasible if we can find valid $\\pi_2, \\pi_3$.\n    $100 - \\pi_2 \\le 2 \\implies \\pi_2 \\ge 98$. Choose $\\pi_2=98$.\n    $100 - \\pi_3 \\le 6 \\implies \\pi_3 \\ge 94$. Choose $\\pi_3=94$.\n    An optimal dual solution is $(\\pi_1^{(1)}, \\pi_2^{(1)}, \\pi_3^{(1)}) = (100, 98, 94)$. The DSP objective is $5(100) = 500$, matching the SP cost.\n    The first Benders optimality cut is $\\theta \\ge 5(100) - x_1(98) - x_2(94)$, which is $\\theta \\ge 500 - 98x_1 - 94x_2$.\n\n**Iteration 2**\n3.  **Solve the second Master Problem (MP2):**\n    $$ \\min_{x_1, x_2, \\theta \\ge 0} \\quad 3x_1 + 0.5x_2 + \\theta $$\n    Subject to:\n    $$ \\theta \\ge 0 $$\n    $$ \\theta \\ge 500 - 98x_1 - 94x_2 $$\n    The objective can be stated as $\\min \\quad 3x_1 + 0.5x_2 + \\max(0, 500 - 98x_1 - 94x_2)$.\n    If $500 - 98x_1 - 94x_2 \\le 0$, we minimize $3x_1 + 0.5x_2$.\n    If $500 - 98x_1 - 94x_2 > 0$, we minimize $3x_1 + 0.5x_2 + 500 - 98x_1 - 94x_2 = -95x_1 - 93.5x_2 + 500$.\n    The minimum of a linear function over a region occurs on its boundary. Both cases drive the solution towards the line $98x_1 + 94x_2 = 500$.\n    So we minimize $3x_1 + 0.5x_2$ on the line segment defined by $98x_1 + 94x_2 = 500$ for $x_1, x_2 \\ge 0$.\n    The cost to satisfy one unit of the constraint $98x_1 + 94x_2 = 500$ is $\\frac{3}{98} \\approx 0.0306$ using $x_1$ and $\\frac{0.5}{94} \\approx 0.0053$ using $x_2$. It is cheaper to use $x_2$.\n    The solution is at the corner point where $x_1=0$.\n    $94x_2 = 500 \\implies x_2 = \\frac{500}{94} = \\frac{250}{47}$.\n    The solution is $(x_1^{(2)}, x_2^{(2)}, \\theta^{(2)}) = (0, \\frac{250}{47}, 0)$.\n    The MP2 objective value is $3(0) + 0.5(\\frac{250}{47}) + 0 = \\frac{125}{47}$.\n    The new lower bound is $LB = \\frac{125}{47} \\approx 2.66$.\n\n4.  **Solve SP2 for $x^{(2)}=(0, \\frac{250}{47})$ and generate the second cut:**\n    The subproblem is:\n    $$ \\min \\quad 2y_1 + 6y_2 + 100s $$\n    s.t. $y_1+y_2+s \\ge 5$, $y_1 \\le 0 \\implies y_1=0$, and $y_2 \\le \\frac{250}{47}$.\n    The problem reduces to minimizing $6y_2 + 100s$ subject to $y_2+s \\ge 5$ and $y_2 \\le \\frac{250}{47} \\approx 5.32$.\n    Since the cost of generation $y_2$ ($6$/unit) is much less than load shedding $s$ ($100$/unit), we should use $y_2$ to meet the demand of $5$. As the capacity $\\frac{250}{47}$ exceeds the demand $5$, we can set $y_2=5$ and $s=0$.\n    The subproblem solution is $(y_1, y_2, s) = (0, 5, 0)$, with operational cost $Q(x^{(2)}) = 6 \\times 5 = 30$.\n    The new upper bound is $c^T x^{(2)} + Q(x^{(2)}) = \\frac{125}{47} + 30 = \\frac{125+1410}{47} = \\frac{1535}{47} \\approx 32.66$.\n\n    We solve the DSP with $x^{(2)}=(0, \\frac{250}{47})$. By complementary slackness on the SP solution:\n    - $y_2>0 \\implies$ dual constraint for $y_2$ is active: $\\pi_1-\\pi_3 = 6$.\n    - $y_2  \\frac{250}{47}$ (capacity not binding) $\\implies \\pi_3=0$.\n    - Thus, $\\pi_1=6$.\n    - $y_1=0, s=0$ (non-basic) $\\implies$ their dual constraints may be slack.\n    The optimal dual values must satisfy all dual constraints. We have $\\pi_1=6, \\pi_3=0$. The remaining constraint is $\\pi_1-\\pi_2 \\le 2 \\implies 6-\\pi_2 \\le 2 \\implies \\pi_2 \\ge 4$. We can choose $\\pi_2=4$.\n    An optimal dual solution is $(\\pi_1^{(2)}, \\pi_2^{(2)}, \\pi_3^{(2)}) = (6, 4, 0)$.\n    The second Benders cut is $\\theta \\ge 5(6) - x_1(4) - x_2(0)$, which is $\\theta \\ge 30 - 4x_1$.\n\n**Iteration 3**\n5.  **Solve the third Master Problem (MP3) and verify convergence:**\n    $$ \\min_{x_1, x_2, \\theta \\ge 0} \\quad 3x_1 + 0.5x_2 + \\theta $$\n    Subject to:\n    $$ \\theta \\ge 500 - 98x_1 - 94x_2 $$\n    $$ \\theta \\ge 30 - 4x_1 $$\n    The objective is $\\min \\quad 3x_1 + 0.5x_2 + \\max(0, 500 - 98x_1 - 94x_2, 30 - 4x_1)$.\n    The minimum will lie on the upper envelope of the cut functions. We analyze where the two cuts intersect:\n    $500 - 98x_1 - 94x_2 = 30 - 4x_1 \\implies 470 = 94x_1 + 94x_2 \\implies x_1 + x_2 = 5$.\n    On this line, the objective can be found by substituting one of the cut expressions for $\\theta$:\n    $z = 3x_1 + 0.5x_2 + (30 - 4x_1) = -x_1 + 0.5x_2 + 30$.\n    Now substitute $x_2=5-x_1$:\n    $z = -x_1 + 0.5(5-x_1) + 30 = -x_1 + 2.5 - 0.5x_1 + 30 = -1.5x_1 + 32.5$.\n    To minimize $z$, we must maximize $x_1$ along the segment $x_1+x_2=5$ where $x_1, x_2 \\ge 0$. This means $x_1 \\in [0, 5]$.\n    The maximum $x_1$ is $5$, which implies $x_2=0$.\n    The solution to MP3 is $(\\hat{x}_1, \\hat{x}_2) = (5, 0)$.\n    At this point, $\\hat{\\theta} = 30 - 4(5) = 10$. This is also consistent with the first cut: $500 - 98(5) - 94(0) = 500 - 490 = 10$.\n    The MP3 solution is $(\\hat{x}_1, \\hat{x}_2, \\hat{\\theta}) = (5, 0, 10)$.\n    The new lower bound is $LB = 3(5) + 0.5(0) + 10 = 25$.\n\n    **Convergence Check:** We solve the SP for $\\hat{x}=(5, 0)$.\n    $$ \\min \\quad 2y_1 + 6y_2 + 100s $$\n    s.t. $y_1+y_2+s \\ge 5$, $y_1 \\le 5$, $y_2 \\le 0 \\implies y_2=0$.\n    The problem reduces to minimizing $2y_1 + 100s$ subject to $y_1+s \\ge 5$ and $y_1 \\le 5$.\n    The economic choice is to use $y_1$ at cost $2$ instead of $s$ at cost $100$. We set $y_1=5, s=0$.\n    The operational cost is $Q(\\hat{x}) = 2(5) = 10$.\n    We observe that $\\hat{\\theta} = 10$ from the master problem is equal to the subproblem cost $Q(\\hat{x}) = 10$. The Benders algorithm has converged.\n\n    The optimal total cost is the final lower bound from MP3 (which now equals the upper bound):\n    Total Cost = $c^T\\hat{x} + \\hat{\\theta} = 3(5) + 0.5(0) + 10 = 25$.\n    Alternatively, Total Cost = $c^T\\hat{x} + Q(\\hat{x}) = 15 + 10 = 25$.\n\nThe exact optimal total cost is $25$.",
            "answer": "$$ \\boxed{25} $$"
        },
        {
            "introduction": "A robust Benders decomposition algorithm must not only find optimal solutions but also gracefully handle situations where a master decision leads to an infeasible subproblem. This practice focuses on that crucial aspect, moving beyond optimality cuts to the generation of feasibility cuts. You will explore how linear programming duality, specifically through the lens of Farkas' Lemma and extreme rays of the dual cone, provides a mechanism to identify and cut off infeasible regions of the master problem's decision space .",
            "id": "4071643",
            "problem": "Consider a two-stage linear energy planning model in which the first stage decides installed capacities and the second stage dispatches generation to meet demand. The first-stage (master) variables are installed capacities $x_{A}$ and $x_{B}$ (in megawatts, MW) for two technologies $A$ and $B$. The second-stage (operational) subproblem, for a given $(x_{A}, x_{B})$, chooses period-wise dispatch $y_{A,1}$, $y_{B,1}$, $y_{A,2}$, $y_{B,2}$ (in MW) to minimize operating costs subject to demand satisfaction and capacity availability constraints without load shedding.\n\nThe operational subproblem is\n$$\n\\begin{aligned}\n\\min_{y_{A,1},y_{B,1},y_{A,2},y_{B,2}} \\quad  c_{A,1}\\,y_{A,1} + c_{B,1}\\,y_{B,1} + c_{A,2}\\,y_{A,2} + c_{B,2}\\,y_{B,2} \\\\\n\\text{s.t.} \\quad  y_{A,1} + y_{B,1} \\ge d_{1}, \\\\\n y_{A,2} + y_{B,2} \\ge d_{2}, \\\\\n y_{A,1} \\le a_{A,1}\\,x_{A}, \\\\\n y_{B,1} \\le a_{B,1}\\,x_{B}, \\\\\n y_{A,2} \\le a_{A,2}\\,x_{A}, \\\\\n y_{B,2} \\le a_{B,2}\\,x_{B}, \\\\\n y_{A,1},y_{B,1},y_{A,2},y_{B,2} \\ge 0,\n\\end{aligned}\n$$\nwhere $d_{1}$ and $d_{2}$ are period demands and $a_{g,t}$ are availability factors (dimensionless) mapping installed capacity to available capacity in each period. Suppose $d_{1} = 95$, $d_{2} = 60$, $a_{A,1} = 0.40$, $a_{B,1} = 0.50$, $a_{A,2} = 0.90$, $a_{B,2} = 0.60$, and current master-stage iterate values are $\\hat{x}_{A} = 120$ and $\\hat{x}_{B} = 50$. The operating cost coefficients $c_{g,t}$ are arbitrary finite nonnegative numbers and need not be specified to analyze feasibility.\n\nIn the context of Benders decomposition (also called the L-shaped method), explain from first principles the distinction between feasibility cuts and optimality cuts in terms of linear programming duality and extreme rays versus extreme points. Then, for the specific data above, identify the source of infeasibility in the operational subproblem and derive a Benders feasibility cut associated with the infeasible period. Your derivation must start from a valid base in linear programming duality and the characterization of infeasibility via extreme rays, and it must produce a linear cut in the master variables that excludes the infeasible $(\\hat{x}_{A}, \\hat{x}_{B})$ and enforces subproblem feasibility for the problematic period.\n\nCompute the feasibility cut as a single linear expression $\\phi(x_{A}, x_{B})$ whose nonpositivity guarantees feasibility of the operational subproblem’s period $1$ for any $(x_{A}, x_{B})$. Express your final expression in megawatts (MW). No rounding is required.",
            "solution": "The problem requires a principled explanation of Benders feasibility and optimality cuts, followed by the derivation of a specific feasibility cut for a given two-stage energy planning model.\n\nFirst, the problem is validated.\n\n**Step 1: Extract Givens**\n- Master variables (installed capacities, MW): $x_{A}$, $x_{B}$\n- Second-stage variables (dispatch, MW): $y_{A,1}$, $y_{B,1}$, $y_{A,2}$, $y_{B,2}$\n- Operational subproblem objective function: $\\min_{y} \\sum_{g,t} c_{g,t} y_{g,t}$, where $c_{g,t} \\ge 0$ are finite costs.\n- Operational subproblem constraints:\n  - $y_{A,1} + y_{B,1} \\ge d_{1}$\n  - $y_{A,2} + y_{B,2} \\ge d_{2}$\n  - $y_{A,1} \\le a_{A,1}\\,x_{A}$\n  - $y_{B,1} \\le a_{B,1}\\,x_{B}$\n  - $y_{A,2} \\le a_{A,2}\\,x_{A}$\n  - $y_{B,2} \\le a_{B,2}\\,x_{B}$\n  - $y_{A,1}, y_{B,1}, y_{A,2}, y_{B,2} \\ge 0$\n- Data:\n  - Demand period $1$: $d_{1} = 95$ MW\n  - Demand period $2$: $d_{2} = 60$ MW\n  - Availability factors: $a_{A,1} = 0.40$, $a_{B,1} = 0.50$, $a_{A,2} = 0.90$, $a_{B,2} = 0.60$\n- Current master-stage iterate: $\\hat{x}_{A} = 120$ MW, $\\hat{x}_{B} = 50$ MW\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard application of Benders decomposition to a two-stage stochastic linear program, a canonical topic in operations research and energy systems modeling. It is scientifically grounded and objective. To check for consistency, we evaluate the feasibility of the operational subproblem at the given iterate $(\\hat{x}_{A}, \\hat{x}_{B}) = (120, 50)$. The operational subproblem decouples by time period.\n\nFor period $1$, the constraints on generation are:\n- $y_{A,1} \\le a_{A,1}\\,\\hat{x}_{A} = 0.40 \\times 120 = 48$ MW\n- $y_{B,1} \\le a_{B,1}\\,\\hat{x}_{B} = 0.50 \\times 50 = 25$ MW\nThe maximum possible generation in period $1$ is $y_{A,1} + y_{B,1} \\le 48 + 25 = 73$ MW.\nThe demand is $d_{1} = 95$ MW.\nSince the maximum possible generation ($73$ MW) is less than the demand ($95$ MW), the demand constraint $y_{A,1} + y_{B,1} \\ge 95$ cannot be satisfied. Thus, the operational subproblem for period $1$ is infeasible.\n\nFor period $2$, the maximum generation is $a_{A,2}\\,\\hat{x}_{A} + a_{B,2}\\,\\hat{x}_{B} = 0.90 \\times 120 + 0.60 \\times 50 = 108 + 30 = 138$ MW. The demand is $d_{2} = 60$ MW. Since $138  60$, the subproblem for period $2$ is feasible.\n\nThe overall operational subproblem is infeasible due to the infeasibility in period $1$. The problem setup is consistent and well-posed.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n**Part 1: Distinction between Optimality and Feasibility Cuts**\n\nBenders decomposition solves problems of the form:\n$$\n\\min_{x, \\theta} \\quad z^T x + \\theta \\\\\n\\text{s.t.} \\quad x \\in X \\\\\n\\theta \\ge Q(x)\n$$\nwhere $Q(x)$ is the optimal value of a second-stage linear program (the subproblem) parameterized by the first-stage decisions $x$:\n$$\nQ(x) = \\min_{y} \\quad q^T y \\\\\n\\text{s.t.} \\quad Wy \\ge h - Tx\n$$\nIn our problem, $x = (x_A, x_B)^T$ and $y$ is the vector of dispatch variables. The algorithm iteratively approximates the function $Q(x)$ by adding linear constraints (cuts) to the master problem.\n\nAn **optimality cut** is generated when the subproblem is feasible and bounded for a given master-problem solution $\\hat{x}$. By linear programming duality, the dual of the subproblem is:\n$$\n\\max_{\\pi} \\quad (h - T\\hat{x})^T \\pi \\\\\n\\text{s.t.} \\quad W^T \\pi \\le q, \\quad \\pi \\ge 0\n$$\nLet $\\hat{\\pi}$ be an optimal solution to this dual problem. $\\hat{\\pi}$ is an extreme point of the dual feasible region. By strong duality, $Q(\\hat{x}) = (h - T\\hat{x})^T \\hat{\\pi}$. Since $Q(x)$ is a convex function, this provides a supporting hyperplane to its epigraph. The resulting constraint, known as an optimality cut, is added to the master problem:\n$$\n\\theta \\ge (h - Tx)^T \\hat{\\pi}\n$$\nThis cut enforces a lower bound on $\\theta$ for all $x$, ensuring that $\\theta$ will eventually converge to the true subproblem cost for the optimal $x$.\n\nA **feasibility cut** is generated when the subproblem is infeasible for a given master-problem solution $\\hat{x}$. An infeasible primal LP implies that its dual is either unbounded or infeasible. In the context of Benders decomposition, the dual subproblem is constructed to be always feasible (e.g., $\\pi=0$ is often a feasible solution), so it must be unbounded.\n\nThe unboundedness of the dual implies the existence of an extreme ray of the dual feasible region's recession cone. This recession cone is defined by $\\{ \\bar{\\pi} \\mid W^T \\bar{\\pi} \\le 0, \\bar{\\pi} \\ge 0 \\}$. An extreme ray, represented by a vector $\\bar{\\pi}$, is a direction of unboundedness if the dual objective increases along it, i.e., $(h - T\\hat{x})^T \\bar{\\pi}  0$. This condition is a certificate of the primal's infeasibility, a result encapsulated by Farkas' Lemma.\n\nFor the primal subproblem to be feasible for any a given $x$, its dual must not be unbounded. This requires that for every extreme ray $\\bar{\\pi}$ of the dual cone, the objective change along that ray must be non-positive:\n$$\n(h - Tx)^T \\bar{\\pi} \\le 0\n$$\nThis inequality is a Benders feasibility cut. It is a constraint on the master variables $x$ themselves, not on $\\theta$, and it \"cuts off\" the infeasible master solution $\\hat{x}$ from the feasible set of the master problem.\n\n**Part 2: Derivation of the Feasibility Cut**\n\nThe overall subproblem is infeasible because the constraints for period $1$ cannot be met. We focus on this problematic period. The subproblem for period $1$ is:\n$$\n\\begin{aligned}\n\\min_{y_{A,1}, y_{B,1}} \\quad  c_{A,1}\\,y_{A,1} + c_{B,1}\\,y_{B,1} \\\\\n\\text{s.t.} \\quad  y_{A,1} + y_{B,1} \\ge d_{1} \\\\\n y_{A,1} \\le a_{A,1}\\,x_{A} \\\\\n y_{B,1} \\le a_{B,1}\\,x_{B} \\\\\n y_{A,1}, y_{B,1} \\ge 0\n\\end{aligned}\n$$\nTo apply duality theory, we rewrite the constraints in standard form $Ay \\ge b$:\n$$\n\\begin{aligned}\ny_{A,1} + y_{B,1} \\ge d_{1} \\quad (\\text{dual variable } \\pi_1 \\ge 0) \\\\\n-y_{A,1} \\ge -a_{A,1}\\,x_{A} \\quad (\\text{dual variable } \\pi_2 \\ge 0) \\\\\n-y_{B,1} \\ge -a_{B,1}\\,x_{B} \\quad (\\text{dual variable } \\pi_3 \\ge 0)\n\\end{aligned}\n$$\nThe dual problem is:\n$$\n\\begin{aligned}\n\\max_{\\pi_1, \\pi_2, \\pi_3} \\quad  d_1 \\pi_1 - a_{A,1}x_A \\pi_2 - a_{B,1}x_B \\pi_3 \\\\\n\\text{s.t.} \\quad  \\pi_1 - \\pi_2 \\le c_{A,1} \\\\\n \\pi_1 - \\pi_3 \\le c_{B,1} \\\\\n \\pi_1, \\pi_2, \\pi_3 \\ge 0\n\\end{aligned}\n$$\nThe primal is infeasible for $(\\hat{x}_{A}, \\hat{x}_{B}) = (120, 50)$, so the dual must be unbounded. We need to find an extreme ray of the dual's recession cone. The cone is defined by the homogeneous dual constraints:\n$$\n\\begin{aligned}\n \\bar{\\pi}_1 - \\bar{\\pi}_2 \\le 0 \\\\\n \\bar{\\pi}_1 - \\bar{\\pi}_3 \\le 0 \\\\\n \\bar{\\pi}_1, \\bar{\\pi}_2, \\bar{\\pi}_3 \\ge 0\n\\end{aligned}\n$$\nAn extreme ray is found by setting $n-1 = 3-1 = 2$ constraints to be binding. Let's set $\\bar{\\pi}_1 - \\bar{\\pi}_2 = 0$ and $\\bar{\\pi}_1 - \\bar{\\pi}_3 = 0$. This implies $\\bar{\\pi}_1 = \\bar{\\pi}_2 = \\bar{\\pi}_3$. We can choose a representative vector for this ray by setting $\\bar{\\pi}_1 = 1$, giving the ray direction $\\bar{\\pi} = (1, 1, 1)^T$.\n\nWe must verify that this ray leads to an unbounded objective for the iterate $(\\hat{x}_{A}, \\hat{x}_{B})$. The change in objective along this ray is:\n$$\nd_1 \\bar{\\pi}_1 - a_{A,1}\\hat{x}_A \\bar{\\pi}_2 - a_{B,1}\\hat{x}_B \\bar{\\pi}_3 = d_1(1) - a_{A,1}\\hat{x}_A(1) - a_{B,1}\\hat{x}_B(1)\n$$\nSubstituting the given values:\n$$\n95 - (0.40)(120) - (0.50)(50) = 95 - 48 - 25 = 22\n$$\nSince $22  0$, the objective increases along this ray, confirming the dual is unbounded and $\\bar{\\pi}=(1,1,1)^T$ is a valid ray of ascent.\n\nThe Benders feasibility cut is derived from the condition that for any feasible master solution $(x_{A}, x_{B})$, the dual objective must not be unbounded along this ray. This means the change in objective must be non-positive:\n$$\nd_1 \\bar{\\pi}_1 - a_{A,1}x_A \\bar{\\pi}_2 - a_{B,1}x_B \\bar{\\pi}_3 \\le 0\n$$\nSubstituting the ray components $\\bar{\\pi}=(1,1,1)^T$:\n$$\nd_1(1) - a_{A,1}x_A (1) - a_{B,1}x_B (1) \\le 0\n$$\nPlugging in the constant values:\n$$\n95 - 0.40 x_A - 0.50 x_B \\le 0\n$$\nThis cut correctly excludes the infeasible point $(\\hat{x}_{A}, \\hat{x}_{B}) = (120, 50)$, as $95 - 0.40(120) - 0.50(50) = 22 \\not\\le 0$. The cut mandates that the total available capacity in period $1$ must be at least equal to the demand, i.e., $a_{A,1}x_A + a_{B,1}x_B \\ge d_1$.\n\nThe problem asks for the expression $\\phi(x_{A}, x_{B})$ such that the cut is $\\phi(x_{A}, x_{B}) \\le 0$. Therefore, the expression is:\n$$\n\\phi(x_{A}, x_{B}) = 95 - 0.40 x_A - 0.50 x_B\n$$\nThe units of this expression are MW, as $95$ is in MW, and the terms $0.40 x_A$ and $0.50 x_B$ are also in MW (dimensionless factor times MW).",
            "answer": "$$\\boxed{95 - 0.40 x_{A} - 0.50 x_{B}}$$"
        },
        {
            "introduction": "We now turn our attention to Dantzig-Wolfe decomposition, the dual counterpart to Benders decomposition, which is often applied to problems with a block-angular structure. The engine of this method is the pricing subproblem, which seeks to find new columns (or proposals) that can improve the master problem's solution. This exercise challenges you to derive and solve the pricing subproblem for a single generating unit, demonstrating how dual variables from the master problem's constraints create economic signals that guide the search for profitable operational schedules .",
            "id": "4071641",
            "problem": "Consider an energy systems dispatch formulation under Dantzig–Wolfe decomposition, where the Restricted Master Problem (RMP) selects among columns, and each column represents a feasible hourly schedule for a single thermal generating unit over a finite horizon. The objective of the RMP is to minimize total system cost while exactly meeting demand through a convex combination of columns. The decomposition builds on the well-tested foundations of linear programming duality and convexification of feasible sets. Let the time horizon be $T = 4$ hours, indexed by $t \\in \\{1,2,3,4\\}$. In the RMP, the coupling constraints enforce hourly supply–demand balance and have associated dual multipliers.\n\nYou are tasked to derive the pricing problem (the column-generation subproblem) for a single thermal unit whose feasible set is defined by binary on/off decisions and continuous power outputs subject to logical and ramping constraints. Use the following well-tested modeling assumptions for a Mixed-Integer Linear Programming (MILP) unit model:\n- The unit has on/off status $u_t \\in \\{0,1\\}$ and startup indicator $y_t \\in \\{0,1\\}$ for each hour $t$.\n- The unit’s power output is $p_t \\ge 0$ for each hour $t$.\n- Logical and capability constraints hold: $p_t \\le P^{\\max} u_t$, $p_t \\ge P^{\\min} u_t$, and $y_t \\ge u_t - u_{t-1}$ with $u_0 = 0$ and $p_0 = 0$ given.\n- Symmetric hourly ramping limits hold: $p_t - p_{t-1} \\le R$ and $p_{t-1} - p_t \\le R$ for all $t \\in \\{1,2,3,4\\}$.\n\nThe RMP is a minimization problem with equality coupling constraints whose dual multipliers for hours $t=1,2,3,4$ are given by $\\pi_1$, $\\pi_2$, $\\pi_3$, $\\pi_4$, all in $\\text{USD}/\\text{MWh}$. Let the unit’s cost in a column be the sum of a per-start cost and a variable energy cost: a startup cost $c_s$ (in $\\text{USD}$) for each startup, and a variable cost $c_v$ (in $\\text{USD}/\\text{MWh}$) applied to $p_t$.\n\nStarting from the foundational definition of reduced costs in linear programming and the standard Dantzig–Wolfe decomposition setup, derive the pricing problem that, for this single unit, computes the minimum reduced cost column to be added to the RMP. Then, using the following numerical data:\n- $P^{\\min} = 50$ $\\text{MW}$, $P^{\\max} = 200$ $\\text{MW}$,\n- $R = 80$ $\\text{MW}/\\text{h}$,\n- $c_s = 500$ $\\text{USD}$, $c_v = 30$ $\\text{USD}/\\text{MWh}$,\n- $\\pi_1 = 45$ $\\text{USD}/\\text{MWh}$, $\\pi_2 = 60$ $\\text{USD}/\\text{MWh}$, $\\pi_3 = 40$ $\\text{USD}/\\text{MWh}$, $\\pi_4 = 50$ $\\text{USD}/\\text{MWh}$,\n\ncompute the optimal value of the unit’s pricing problem (i.e., the minimum reduced cost). Express your final answer in United States dollars (USD). No rounding is required; report the exact value.",
            "solution": "We begin from the foundational setup of Dantzig–Wolfe decomposition for the Restricted Master Problem (RMP). Let each column $j$ represent a feasible schedule of the unit over the horizon $t \\in \\{1,2,3,4\\}$, with an associated cost $c_j$ and an hourly energy contribution vector $(a_{1j}, a_{2j}, a_{3j}, a_{4j})$. The RMP is a linear program that minimizes $\\sum_{j} c_j x_j$ subject to the coupling constraints\n$$\n\\sum_{j} a_{tj} x_j = D_t \\quad \\text{for all } t \\in \\{1,2,3,4\\},\n$$\nand $x_j \\ge 0$, where $D_t$ is the hourly demand and $x_j$ the column weight. By linear programming duality, the equality constraints yield dual variables $\\pi_t$ (free in sign), one for each hour $t$.\n\nThe reduced cost of a column $j$ is defined by the well-tested rule\n$$\nr_j = c_j - \\sum_{t=1}^{4} \\pi_t a_{tj}.\n$$\nIn column generation for a minimization RMP, we seek columns with negative reduced cost to improve the objective. For a specific unit, the pricing problem minimizes the reduced cost over the unit’s feasible set $\\mathcal{S}$:\n$$\n\\min_{s \\in \\mathcal{S}} \\left( c(s) - \\sum_{t=1}^{4} \\pi_t a_t(s) \\right),\n$$\nwhere $s$ encodes the unit’s on/off and output trajectory, $c(s)$ is the unit’s cost over the horizon, and $a_t(s)$ is the energy supplied in hour $t$ by schedule $s$.\n\nWe now instantiate $c(s)$ and $a_t(s)$ using the MILP unit model. Let $u_t \\in \\{0,1\\}$ denote on/off status, $y_t \\in \\{0,1\\}$ startup indicator, and $p_t \\ge 0$ power output. The feasible set $\\mathcal{S}$ is characterized by:\n- Capability constraints: $p_t \\le P^{\\max} u_t$ and $p_t \\ge P^{\\min} u_t$ for all $t$.\n- Startup logic: $y_t \\ge u_t - u_{t-1}$ with $u_0 = 0$ and $p_0 = 0$.\n- Ramping constraints: $p_t - p_{t-1} \\le R$ and $p_{t-1} - p_t \\le R$ for all $t$.\n\nThe cost function is\n$$\nc(s) = c_s \\sum_{t=1}^{4} y_t + c_v \\sum_{t=1}^{4} p_t,\n$$\nand the energy contribution is simply $a_t(s) = p_t$.\n\nTherefore, the pricing problem is the Mixed-Integer Linear Programming (MILP) problem:\n$$\n\\min_{u_t, y_t, p_t} \\left[ c_s \\sum_{t=1}^{4} y_t + \\sum_{t=1}^{4} \\left( c_v - \\pi_t \\right) p_t \\right]\n$$\nsubject to\n\\begin{align*}\n p_t \\le P^{\\max} u_t \\quad \\text{for } t=1,2,3,4, \\\\\n p_t \\ge P^{\\min} u_t \\quad \\text{for } t=1,2,3,4, \\\\\n y_t \\ge u_t - u_{t-1} \\quad \\text{for } t=1,2,3,4, \\\\\n p_t - p_{t-1} \\le R \\quad \\text{for } t=1,2,3,4, \\\\\n p_{t-1} - p_t \\le R \\quad \\text{for } t=1,2,3,4, \\\\\n u_t \\in \\{0,1\\}, \\; y_t \\in \\{0,1\\}, \\; p_t \\ge 0, \\\\\n u_0 = 0, \\; p_0 = 0.\n\\end{align*}\n\nWith the given numerical parameters:\n- $P^{\\min} = 50$, $P^{\\max} = 200$, $R = 80$,\n- $c_s = 500$, $c_v = 30$,\n- $\\pi_1 = 45$, $\\pi_2 = 60$, $\\pi_3 = 40$, $\\pi_4 = 50$,\n\nthe objective coefficients on $p_t$ become\n\\begin{align*}\n c_v - \\pi_1 = 30 - 45 = -15, \\\\\n c_v - \\pi_2 = 30 - 60 = -30, \\\\\n c_v - \\pi_3 = 30 - 40 = -10, \\\\\n c_v - \\pi_4 = 30 - 50 = -20.\n\\end{align*}\nThus the pricing objective is\n$$\n\\min \\left[ 500 \\sum_{t=1}^{4} y_t + (-15) p_1 + (-30) p_2 + (-10) p_3 + (-20) p_4 \\right].\n$$\n\nBecause all $c_v - \\pi_t$ are negative, increasing $p_t$ lowers the objective (beneficial in minimization), but is limited by capability and ramping constraints, and incurs startup costs when transitioning from off to on. It is optimal to incur a single startup and produce as much as possible subject to $P^{\\max}$ and $R$, starting as early as possible to exploit all negative coefficients.\n\nFrom $u_0 = 0$ and $p_0 = 0$, if we start at $t=1$ ($u_1=1$, $y_1=1$), the ramp and capability constraints yield:\n- At $t=1$: $p_1 \\in [50, \\min(200, 0 + 80)] = [50, 80]$, so choose $p_1 = 80$.\n- At $t=2$: $p_2 \\in [50, \\min(200, 80 + 80)] = [50, 160]$, so choose $p_2 = 160$.\n- At $t=3$: $p_3 \\in [50, \\min(200, 160 + 80)] = [50, 200]$, so choose $p_3 = 200$.\n- At $t=4$: $p_4 \\in [50, \\min(200, 200 + 80)] = [50, 200]$, so choose $p_4 = 200$.\n\nKeeping the unit on throughout avoids additional startups, so $\\sum_{t=1}^{4} y_t = 1$. The objective value under this schedule is\n\\begin{align*}\n 500 \\cdot 1 + (-15) \\cdot 80 + (-30) \\cdot 160 + (-10) \\cdot 200 + (-20) \\cdot 200 \\\\\n= 500 - 1200 - 4800 - 2000 - 4000 \\\\\n= 500 - 12000 \\\\\n= -11500.\n\\end{align*}\n\nWe briefly check alternatives to ensure optimality:\n- Staying off yields objective $0$, which is higher than $-11500$ (worse for minimization).\n- Starting later (e.g., at $t=2$) reduces exploitable negative coefficients and is constrained by ramping, yielding a less favorable objective (e.g., $-7500$).\n- Multiple startups increase $\\sum y_t$ and incur additional startup costs; given negative $c_v - \\pi_t$ coefficients, a single continuous on-period with maximal feasible outputs is superior.\n\nTherefore, the optimal reduced cost of the pricing problem is $-11500$ $\\text{USD}$.",
            "answer": "$$\\boxed{-11500}$$"
        }
    ]
}