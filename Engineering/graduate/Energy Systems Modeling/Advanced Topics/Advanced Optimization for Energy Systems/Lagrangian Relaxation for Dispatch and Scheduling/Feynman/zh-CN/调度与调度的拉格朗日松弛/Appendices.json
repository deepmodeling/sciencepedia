{
    "hands_on_practices": [
        {
            "introduction": "这第一个练习  为我们奠定了基础。我们将使用卡罗需-库恩-塔克（Karush-Kuhn-Tucker, KKT）条件来解决一个经典的单周期经济调度问题。这个练习将阐明功率平衡约束上的拉格朗日乘子如何成为系统的边际电价，以及发电机的运行限制如何在优化框架中得到处理。",
            "id": "4100508",
            "problem": "考虑一个包含三台机组的火电厂的单母线经济调度问题。每台发电机 $i \\in \\{1,2,3\\}$ 产生的功率为 $p_i$，单位为兆瓦 (MW)，其小时成本由二次函数 $C_i(p_i) = a_i p_i^2 + b_i p_i$ 给出，其中 $a_i > 0$ 且 $b_i \\ge 0$。系统必须满足一个固定的需求 $D$，单位为兆瓦 (MW)，且无输电约束。每台发电机都受到物理的上下限约束 $P_i^{\\min} \\le p_i \\le P_i^{\\max}$。假设启动成本和空载成本为零，并且成本函数仅包含增量燃料成本以及可变运行和维护成本。调度员的目标是在满足功率平衡和机组运行限制的条件下，最小化总的小时发电成本。\n\n采用以下数据：\n- 发电机 $1$：$a_1 = 0.2$，$b_1 = 10$，$P_1^{\\min} = 20$，$P_1^{\\max} = 120$。\n- 发电机 $2$：$a_2 = 0.1$，$b_2 = 12$，$P_2^{\\min} = 10$，$P_2^{\\max} = 100$。\n- 发电机 $3$：$a_3 = 0.3$，$b_3 = 9$，$P_3^{\\min} = 0$，$P_3^{\\max} = 80$。\n- 需求：$D = 200$。\n\n从凸优化的定义和耦合平衡约束的拉格朗日松弛出发，构建以决策变量 $p_1$、$p_2$ 和 $p_3$ 表示的原始问题，以及包含等式和不等式约束乘子的相应拉格朗日函数。使用包括平稳性、原始可行性、对偶可行性和互补松弛性在内的卡罗需-库恩-塔克 (KKT) 条件，推导出最优性的必要条件。计算最优调度 $\\{p_1^{\\star}, p_2^{\\star}, p_3^{\\star}\\}$ 和相关的价格 $\\lambda^{\\star}$ (平衡约束的最优乘子)，仔细确定在最优点哪些机组限制是激活的，并验证互补松弛性的一致性。无需四舍五入；请提供精确值。\n\n以行矩阵的形式报告你的最终答案，顺序为 $\\left[p_1^{\\star}\\; p_2^{\\star}\\; p_3^{\\star}\\; \\lambda^{\\star}\\right]$。$p_i^{\\star}$ 以兆瓦 (MW) 为单位，$\\lambda^{\\star}$ 以美元/兆瓦时 ($/\\mathrm{MWh}$) 为单位。",
            "solution": "这是一个经典的经济调度问题，属于凸优化问题。我们首先验证问题陈述。\n\n### 第 1 步：提取已知条件\n- **成本函数**：$C_i(p_i) = a_i p_i^2 + b_i p_i$ for $i \\in \\{1,2,3\\}$。\n- **发电机 1 数据**：$a_1 = 0.2$，$b_1 = 10$，$P_1^{\\min} = 20$ MW，$P_1^{\\max} = 120$ MW。\n- **发电机 2 数据**：$a_2 = 0.1$，$b_2 = 12$，$P_2^{\\min} = 10$ MW，$P_2^{\\max} = 100$ MW。\n- **发电机 3 数据**：$a_3 = 0.3$，$b_3 = 9$，$P_3^{\\min} = 0$ MW，$P_3^{\\max} = 80$ MW。\n- **总需求**：$D = 200$ MW。\n- **约束**：\n    - 功率平衡：$\\sum_{i=1}^3 p_i = D$。\n    - 发电机限制：$P_i^{\\min} \\le p_i \\le P_i^{\\max}$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题为火电机组的经济调度建模，这是电力系统工程中一个基本且成熟的问题。二次成本函数是对燃料成本的标准、现实的近似。参数具有物理合理性。使用拉格朗日松弛和 KKT 条件的优化方法是解决此类问题的标准且严谨的数学技术。该问题在科学上是合理的。\n- **适定性**：目标函数是具有正主导系数 ($a_i > 0$) 的二次函数的总和，因此是严格凸的。由线性等式和不等式约束定义的可行域是一个凸集（一个多胞体）。在一个非空、闭合的凸集上最小化一个严格凸函数有唯一解。因此，该问题是适定的。\n- **目标**：问题使用了精确的数学术语和数值数据进行陈述，目标清晰明确。它不含主观性语言。\n\n### 第 3 步：结论和行动\n问题有效。我们着手解决它。\n\n### 原始问题公式化\n目标是在满足需求并遵守各发电机限制的条件下，最小化总发电成本 $C_{total}$。决策变量是功率输出 $p_1, p_2, p_3$。\n\n优化问题为：\n$$\n\\begin{aligned}\n \\underset{p_1, p_2, p_3}{\\text{minimize}}\n  {total} = \\sum_{i=1}^{3} C_i(p_i) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i) \\\\\n \\text{subject to}\n  \\sum_{i=1}^{3} p_i = D \\quad (\\text{乘子 } \\lambda) \\\\\n   ^{\\min} \\le p_i \\le P_i^{\\max} \\quad \\forall i \\in \\{1,2,3\\}\n\\end{aligned}\n$$\n下限和上限不等式可以写为 $P_i^{\\min} - p_i \\le 0$ (乘子 $\\mu_i^{\\min}$) 和 $p_i - P_i^{\\max} \\le 0$ (乘子 $\\mu_i^{\\max}$)。\n\n### 拉格朗日公式化\n拉格朗日函数 $L$ 包含了所有约束：\n$$\nL(p, \\lambda, \\mu^{\\min}, \\mu^{\\max}) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i) + \\lambda \\left( D - \\sum_{i=1}^{3} p_i \\right) + \\sum_{i=1}^{3} \\mu_i^{\\min} (P_i^{\\min} - p_i) + \\sum_{i=1}^{3} \\mu_i^{\\max} (p_i - P_i^{\\max})\n$$\n其中 $p = (p_1, p_2, p_3)$，$\\mu^{\\min} = (\\mu_1^{\\min}, \\mu_2^{\\min}, \\mu_3^{\\min})$，且 $\\mu^{\\max} = (\\mu_1^{\\max}, \\mu_2^{\\max}, \\mu_3^{\\max})$。\n\n### 卡罗需-库恩-塔克 (KKT) 条件\n要使点 $(p_1^{\\star}, p_2^{\\star}, p_3^{\\star})$ 成为最优点，必须存在乘子 $\\lambda^{\\star}, \\mu_i^{\\min, \\star}, \\mu_i^{\\max, \\star}$，使得以下 KKT 条件得到满足：\n1.  **平稳性**：对 $i=1, 2, 3$ 有 $\\frac{\\partial L}{\\partial p_i} = 0$。\n    $$ 2a_i p_i^{\\star} + b_i - \\lambda^{\\star} - \\mu_i^{\\min, \\star} + \\mu_i^{\\max, \\star} = 0 $$\n2.  **原始可行性**：\n    $$ \\sum_{i=1}^{3} p_i^{\\star} = D $$\n    $$ P_i^{\\min} \\le p_i^{\\star} \\le P_i^{\\max} $$\n3.  **对偶可行性**：\n    $$ \\mu_i^{\\min, \\star} \\ge 0, \\quad \\mu_i^{\\max, \\star} \\ge 0 $$\n4.  **互补松弛性**：\n    $$ \\mu_i^{\\min, \\star} (P_i^{\\min} - p_i^{\\star}) = 0 $$\n    $$ \\mu_i^{\\max, \\star} (p_i^{\\star} - P_i^{\\max}) = 0 $$\n\n项 $2a_i p_i + b_i$ 是发电机 $i$ 的增量成本，记为 $IC_i(p_i)$。平稳性条件可以改写为 $IC_i(p_i^{\\star}) = \\lambda^{\\star} + \\mu_i^{\\min, \\star} - \\mu_i^{\\max, \\star}$。结合互补松弛性进行分析，每台发电机有三种情况：\n- 如果 $P_i^{\\min}  p_i^{\\star}  P_i^{\\max}$，那么 $\\mu_i^{\\min, \\star} = 0$ 且 $\\mu_i^{\\max, \\star} = 0$。条件变为 $IC_i(p_i^{\\star}) = \\lambda^{\\star}$。\n- 如果 $p_i^{\\star} = P_i^{\\min}$，那么 $\\mu_i^{\\max, \\star} = 0$ 且 $\\mu_i^{\\min, \\star} \\ge 0$。条件意味着 $IC_i(P_i^{\\min}) = \\lambda^{\\star} + \\mu_i^{\\min, \\star}$，所以 $IC_i(P_i^{\\min}) \\ge \\lambda^{\\star}$。\n- 如果 $p_i^{\\star} = P_i^{\\max}$，那么 $\\mu_i^{\\min, \\star} = 0$ 且 $\\mu_i^{\\max, \\star} \\ge 0$。条件意味着 $IC_i(P_i^{\\max}) = \\lambda^{\\star} - \\mu_i^{\\max, \\star}$，所以 $IC_i(P_i^{\\max}) \\le \\lambda^{\\star}$。\n\n### 迭代求解\n我们使用迭代方法来找到激活约束的集合。\n\n**迭代 1：假设没有发电机限制被激活。**\n在这种情况下，对所有 $i$ 都有 $IC_i(p_i) = \\lambda$。这得到 $p_i = (\\lambda - b_i) / (2a_i)$。\n功率平衡方程为 $\\sum_{i=1}^{3} p_i = D = 200$。\n$$\n\\frac{\\lambda - 10}{2(0.2)} + \\frac{\\lambda - 12}{2(0.1)} + \\frac{\\lambda - 9}{2(0.3)} = 200\n$$\n$$\n\\frac{\\lambda - 10}{0.4} + \\frac{\\lambda - 12}{0.2} + \\frac{\\lambda - 9}{0.6} = 200\n$$\n为了求解 $\\lambda$，我们可以将其写为：\n$$\n(\\lambda - 10) \\left(\\frac{1}{0.4}\\right) + (\\lambda - 12) \\left(\\frac{1}{0.2}\\right) + (\\lambda - 9) \\left(\\frac{1}{0.6}\\right) = 200\n$$\n$$\n2.5(\\lambda - 10) + 5(\\lambda - 12) + \\frac{5}{3}(\\lambda - 9) = 200\n$$\n乘以 $6$ 以消除所有小数和分数：\n$$\n15(\\lambda - 10) + 30(\\lambda - 12) + 10(\\lambda - 9) = 1200\n$$\n$$\n15\\lambda - 150 + 30\\lambda - 360 + 10\\lambda - 90 = 1200\n$$\n$$\n55\\lambda - 600 = 1200 \\implies 55\\lambda = 1800 \\implies \\lambda = \\frac{1800}{55} = \\frac{360}{11}\n$$\n现在我们用 $\\lambda = 360/11 \\approx 32.727$ 来计算调度值：\n$p_1 = \\frac{360/11 - 10}{0.4} = \\frac{(360-110)/11}{0.4} = \\frac{250/11}{0.4} = \\frac{625}{11} \\approx 56.82$ MW。\n这在发电机 $1$ 的限制范围 $[20, 120]$ 内。\n$p_2 = \\frac{360/11 - 12}{0.2} = \\frac{(360-132)/11}{0.2} = \\frac{228/11}{0.2} = \\frac{1140}{11} \\approx 103.64$ MW。\n该值超过了发电机 $2$ 的上限 $P_2^{\\max} = 100$ MW。假设不成立。\n\n**迭代 2：将发电机 2 设置为其被违反的限制并重新调度。**\n我们将发电机 $2$ 的调度固定在其最大限制上：$p_2^{\\star} = P_2^{\\max} = 100$ MW。\n需要由发电机 $1$ 和 $3$ 满足的剩余需求是 $D' = D - p_2^{\\star} = 200 - 100 = 100$ MW。\n我们现在对发电机 $1$ 和 $3$ 应用等增量成本原则，以满足需求 $D' = 100$。\n$$\n\\frac{\\lambda - 10}{0.4} + \\frac{\\lambda - 9}{0.6} = 100\n$$\n$$\n2.5(\\lambda - 10) + \\frac{5}{3}(\\lambda - 9) = 100\n$$\n乘以 $6$：\n$$\n15(\\lambda - 10) + 10(\\lambda - 9) = 600\n$$\n$$\n15\\lambda - 150 + 10\\lambda - 90 = 600\n$$\n$$\n25\\lambda - 240 = 600 \\implies 25\\lambda = 840 \\implies \\lambda = \\frac{840}{25} = \\frac{168}{5} = 33.6\n$$\n使用这个新的系统价格 $\\lambda^{\\star} = 33.6 \\, \\$/\\mathrm{MWh}$，我们计算发电机 $1$ 和 $3$ 的调度：\n$p_1^{\\star} = \\frac{33.6 - 10}{0.4} = \\frac{23.6}{0.4} = 59$ MW。\n这在限制范围 $[20, 120]$ 内。\n$p_3^{\\star} = \\frac{33.6 - 9}{0.6} = \\frac{24.6}{0.6} = 41$ MW。\n这在限制范围 $[0, 80]$ 内。\n\n### 解的验证\n提出的最优解是 $\\{p_1^{\\star}, p_2^{\\star}, p_3^{\\star}\\} = \\{59, 100, 41\\}$ 和 $\\lambda^{\\star} = 33.6$。\n1.  **原始可行性**：\n    - 功率平衡：$p_1^{\\star} + p_2^{\\star} + p_3^{\\star} = 59 + 100 + 41 = 200$ MW。这与需求 $D$ 相匹配。\n    - 发电机限制：\n        - $20 \\le p_1^{\\star} = 59 \\le 120$ (满足)\n        - $10 \\le p_2^{\\star} = 100 \\le 100$ (满足, 处于最大限制)\n        - $0 \\le p_3^{\\star} = 41 \\le 80$ (满足)\n    所有原始可行性条件均得到满足。\n\n2.  **KKT 条件 (增量成本)**：\n    - **发电机 1**：未达到限制。我们必须验证 $IC_1(p_1^{\\star}) = \\lambda^{\\star}$。\n      $IC_1(59) = 2(0.2)(59) + 10 = 0.4(59) + 10 = 23.6 + 10 = 33.6$。这等于 $\\lambda^{\\star}$。\n    - **发电机 2**：处于上限。我们必须验证 $IC_2(p_2^{\\star}) \\le \\lambda^{\\star}$。\n      $IC_2(100) = 2(0.1)(100) + 12 = 20 + 12 = 32$。\n      条件是 $32 \\le 33.6$，成立。（互补松弛性给出 $\\mu_2^{\\max, \\star} = \\lambda^{\\star} - IC_2(100) = 33.6 - 32 = 1.6 \\ge 0$）。\n    - **发电机 3**：未达到限制。我们必须验证 $IC_3(p_3^{\\star}) = \\lambda^{\\star}$。\n      $IC_3(41) = 2(0.3)(41) + 9 = 0.6(41) + 9 = 24.6 + 9 = 33.6$。这等于 $\\lambda^{\\star}$。\n\n所有 KKT 条件都得到满足，确认该解是唯一的最优解。\n\n最终的最优调度为 $p_1^{\\star} = 59$ MW，$p_2^{\\star} = 100$ MW，$p_3^{\\star} = 41$ MW，最优系统价格为 $\\lambda^{\\star} = 33.6$ $/MWh。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n59  100  41  33.6\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了基础知识之后，这个练习  将问题扩展到多周期情景，并引入了优化对偶问题的核心概念。您将为一组给定的拉格朗日乘子求解分解后的子问题，以计算对偶函数的值，并且最关键的是，计算相关的次梯度。次梯度为我们迭代改进乘子、收紧对偶下界提供了必要信息。",
            "id": "4100512",
            "problem": "考虑一个包含三个时间段 $t \\in \\{1,2,3\\}$ 和两个火力发电机组 $i \\in \\{1,2\\}$ 的多周期经济调度问题。每个机组 $i$ 在时间段 $t$ 内产生功率 $p_{i,t}$（单位：兆瓦，MW），受限于 $0 \\leq p_{i,t} \\leq P_{i}^{\\max}$，并产生一个可微的凸函数运行成本 $C_{i}(p_{i,t}) = a_{i} p_{i,t}^{2} + b_{i} p_{i,t}$。每个时间段的系统需求为 $D_{t}$，原始问题是在满足各周期需求平衡和容量限制的条件下，最小化总运行成本。通过使用乘子 $\\lambda_{t}$ 对各周期的需求平衡约束进行对偶化，构建拉格朗日松弛。\n\n数据：\n- 机组 $1$：$a_{1} = 0.5$, $b_{1} = 10$, $P_{1}^{\\max} = 50$。\n- 机组 $2$：$a_{2} = 0.2$, $b_{2} = 5$, $P_{2}^{\\max} = 30$。\n- 需求：$D_{1} = 25$, $D_{2} = 30$, $D_{3} = 35$ (MW)。\n- 乘子：$\\lambda_{1} = 12$, $\\lambda_{2} = 14$, $\\lambda_{3} = 16$。\n\n从凸优化和拉格朗日对偶性的基本原理出发，通过求解分解后的机组子问题并跨机组和时间段进行汇总，计算对偶函数值 $L(\\lambda)$，并计算由给定乘子下最小化原始决策的对偶化约束的残差定义的关联次梯度分量 $s_{t}$。将您的最终答案以单行矩阵的形式给出，其中包含 $L(\\lambda)$，后跟 $s_{1}$、$s_{2}$ 和 $s_{3}$。无需四舍五入。功率单位为兆瓦（MW）；最终矩阵应只包含数值。",
            "solution": "用户要求我解决一个多周期经济调度的拉格朗日松弛问题。\n\n以下是我的思考过程：\n\n1.  **验证问题陈述**：我将首先逐字提取所有给定的数据和定义。然后，我将检查问题是否科学合理、适定和客观。这个问题是拉格朗日松弛在凸优化问题（经济调度）中的一个标准应用，这是能源系统工程中一个成熟的方法。所有必要的数据都已提供，成本函数是凸的，约束是线性的，确保了这是一个适定的问题。语言是精确的。因此，问题是有效的。\n\n2.  **构建原始问题**：我将写下原始优化问题的数学公式。目标是最小化总发电成本，即所有机组在所有时间段的成本之和。约束是每个时间段的需求平衡（总发电量必须满足需求）和每个机组的发电容量限制。\n    *   目标：$\\min \\sum_{t=1}^{3} \\sum_{i=1}^{2} C_{i}(p_{i,t})$\n    *   约束：\n        *   $\\sum_{i=1}^{2} p_{i,t} = D_{t}$ for $t \\in \\{1, 2, 3\\}$\n        *   $0 \\le p_{i,t} \\le P_{i}^{\\max}$ for $i \\in \\{1, 2\\}, t \\in \\{1, 2, 3\\}$\n\n3.  **构建拉格朗日函数和对偶函数**：我将通过使用给定的拉格朗日乘子 $\\lambda_{t}$ 松弛（对偶化）需求平衡约束来形成拉格朗日函数。通过重新排列项，我将证明该函数按机组和时间段是可分的。这是拉格朗日松弛在此背景下的关键洞见。对偶函数 $L(\\lambda)$ 是拉格朗日函数相对于原始变量 $p_{i,t}$ 在剩余（未松弛）约束下的最小值。\n    *   $L(p, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} C_{i}(p_{i,t}) + \\sum_{t=1}^{3} \\lambda_{t} (D_{t} - \\sum_{i=1}^{2} p_{i,t})$\n    *   通过重新排列，我将得到：\n    *   $L(p, \\lambda) = \\sum_{i=1}^{2} \\sum_{t=1}^{3} [C_{i}(p_{i,t}) - \\lambda_{t} p_{i,t}] + \\sum_{t=1}^{3} \\lambda_{t} D_{t}$\n    *   对偶函数 $L(\\lambda)$ 是拉格朗日函数关于原始变量 $p_{i,t}$ 在剩余（非松弛）约束下的最小值。\n    *   $L(\\lambda) = \\min_{0 \\le p_{i,t} \\le P_{i}^{\\max}} L(p, \\lambda) = \\sum_{i=1}^{2} \\sum_{t=1}^{3} \\left( \\min_{0 \\le p_{i,t} \\le P_{i}^{\\max}} \\{ a_{i}p_{i,t}^2 + b_{i}p_{i,t} - \\lambda_{t}p_{i,t} \\} \\right) + \\sum_{t=1}^{3} \\lambda_{t} D_{t}$\n\n4.  **求解子问题**：对于每个机组 $i$ 和时间段 $t$，我需要解决一个简单的单变量二次最小化问题。通过将一阶导数设为零来找到无约束最小值：$2a_{i}p_{i,t} + b_{i} - \\lambda_{t} = 0$，得到 $p_{i,t}^{*} = \\frac{\\lambda_{t} - b_{i}}{2a_{i}}$。解 $p_{i,t}^{\\text{opt}}$ 必须遵守容量限制。因此，$p_{i,t}^{\\text{opt}} = \\max(0, \\min(P_{i}^{\\max}, p_{i,t}^{*}))$。我将使用提供的数据系统地计算两个机组（$i=1, 2$）和所有三个时间段（$t=1, 2, 3$）的 $p_{i,t}^{\\text{opt}}$。\n\n5.  **计算对偶函数值 $L(\\lambda)$**：一旦我得到给定 $\\lambda$ 下的最优原始决策 $p_{i,t}^{\\text{opt}}$，我将把它们代入拉格朗日函数表达式中以求得对偶函数值 $L(\\lambda)$。我将分别计算总成本部分和惩罚项，然后将它们相加。我还会使用涉及最小化子问题目标值的替代公式来复核此计算。\n\n6.  **计算次梯度分量 $s_{t}$**：拉格朗日对偶理论指出，对偶函数 $L(\\lambda)$ 在点 $\\lambda$ 的一个次梯度是相应松弛约束的残差向量，该残差在最小化拉格朗日函数的原始解处计算。对于每个时间段 $t$，次梯度分量 $s_{t}$ 由 $s_{t} = D_{t} - \\sum_{i=1}^{2} p_{i,t}^{\\text{opt}}$ 给出。我将计算 $t=1, 2, 3$ 的这些值。\n\n7.  **最终答案组合**：我将按照要求将计算出的 $L(\\lambda)$、$s_1$、$s_2$ 和 $s_3$ 的值组合成一个单行矩阵。我将密切注意格式规则，确保所有数学公式都使用 LaTeX，并且最终答案在 `pmatrix` 中。我将仔细检查所有算术以确保准确性。由于所有计算结果都是有限小数，因此不需要四舍五入。\n\n这种系统的方法确保了问题的所有部分都从第一性原理出发得到了正确处理，并最终得出了数值结果。该问题是有效的。它描述了拉格朗日松弛在经济调度问题中的一个标准应用，这是电力系统工程中一个成熟的凸优化问题。该问题具有科学依据，是适定的、客观的、自洽的，并提供了所有必要的数据和定义。\n\n原始经济调度问题是在满足需求平衡和发电机容量限制的条件下，最小化总运行成本。\n目标函数是所有机组在所有时间段内的成本之和：\n$$ \\min_{p_{i,t}} \\sum_{t=1}^{3} \\sum_{i=1}^{2} C_{i}(p_{i,t}) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} (a_{i} p_{i,t}^{2} + b_{i} p_{i,t}) $$\n这受以下约束条件限制：\n1. 每个时间段 $t$ 的需求平衡：$\\sum_{i=1}^{2} p_{i,t} = D_{t}$ for $t \\in \\{1, 2, 3\\}$。\n2. 每个机组 $i$ 和时间段 $t$ 的发电量限制：$0 \\leq p_{i,t} \\leq P_{i}^{\\max}$ for $i \\in \\{1, 2\\}$, $t \\in \\{1, 2, 3\\}$。\n\n为了构建拉格朗日松弛，我们使用拉格朗日乘子 $\\lambda_{t}$ 对需求平衡约束进行对偶化。拉格朗日函数 $L(p, \\lambda)$ 为：\n$$ L(p, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} C_{i}(p_{i,t}) + \\sum_{t=1}^{3} \\lambda_{t} \\left( D_{t} - \\sum_{i=1}^{2} p_{i,t} \\right) $$\n通过重新排列各项，我们可以看到拉格朗日函数按机组 $i$ 和时间段 $t$ 是可分的：\n$$ L(p, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} (a_{i} p_{i,t}^{2} + b_{i} p_{i,t} - \\lambda_{t} p_{i,t}) + \\sum_{t=1}^{3} \\lambda_{t} D_{t} $$\n对偶函数 $L(\\lambda)$ 是通过最小化关于原始变量 $p_{i,t}$ 的拉格朗日函数 $L(p, \\lambda)$ 求得的，并受限于剩余的非对偶化约束（$0 \\leq p_{i,t} \\leq P_{i}^{\\max}$）：\n$$ L(\\lambda) = \\min_{0 \\leq p_{i,t} \\leq P_{i}^{\\max}} L(p, \\lambda) $$\n由于可分性，这个最小化问题可以分解为针对每个机组 $i$ 和时间段 $t$ 的独立子问题：\n$$ L(\\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left( \\min_{0 \\leq p_{i,t} \\leq P_{i}^{\\max}} \\{ a_{i} p_{i,t}^{2} + (b_{i} - \\lambda_{t}) p_{i,t} \\} \\right) + \\sum_{t=1}^{3} \\lambda_{t} D_{t} $$\n每个子问题都是一个简单的二次最小化问题。为了找到括号内项的无约束最小值，我们对其关于 $p_{i,t}$ 求导并令其为零：\n$$ \\frac{d}{dp_{i,t}} [a_{i} p_{i,t}^{2} + (b_{i} - \\lambda_{t}) p_{i,t}] = 2 a_{i} p_{i,t} + b_{i} - \\lambda_{t} = 0 $$\n求解 $p_{i,t}$ 得到每个子问题的最优无约束调度，记为 $p_{i,t}^{*}$：\n$$ p_{i,t}^{*} = \\frac{\\lambda_{t} - b_{i}}{2 a_{i}} $$\n子问题的解 $p_{i,t}^{\\text{opt}}$ 必须满足容量约束，因此我们将 $p_{i,t}^{*}$ 投影到区间 $[0, P_{i}^{\\max}]$ 上：\n$$ p_{i,t}^{\\text{opt}} = \\max(0, \\min(P_{i}^{\\max}, p_{i,t}^{*})) $$\n我们现在根据给定的数据计算 $p_{i,t}^{\\text{opt}}$：\n- 机组 $1$：$a_{1}=0.5$, $b_{1}=10$, $P_{1}^{\\max}=50$。\n- 机组 $2$：$a_{2}=0.2$, $b_{2}=5$, $P_{2}^{\\max}=30$。\n- 乘子：$\\lambda_{1}=12$, $\\lambda_{2}=14$, $\\lambda_{3}=16$。\n\n对于 $t=1$ ($\\lambda_{1}=12$)：\n- 机组 $1$：$p_{1,1}^{*} = \\frac{12 - 10}{2 \\times 0.5} = \\frac{2}{1} = 2$。因为 $0 \\le 2 \\le 50$，所以 $p_{1,1}^{\\text{opt}} = 2$。\n- 机组 $2$：$p_{2,1}^{*} = \\frac{12 - 5}{2 \\times 0.2} = \\frac{7}{0.4} = 17.5$。因为 $0 \\le 17.5 \\le 30$，所以 $p_{2,1}^{\\text{opt}} = 17.5$。\n\n对于 $t=2$ ($\\lambda_{2}=14$)：\n- 机组 $1$：$p_{1,2}^{*} = \\frac{14 - 10}{2 \\times 0.5} = \\frac{4}{1} = 4$。因为 $0 \\le 4 \\le 50$，所以 $p_{1,2}^{\\text{opt}} = 4$。\n- 机组 $2$：$p_{2,2}^{*} = \\frac{14 - 5}{2 \\times 0.2} = \\frac{9}{0.4} = 22.5$。因为 $0 \\le 22.5 \\le 30$，所以 $p_{2,2}^{\\text{opt}} = 22.5$。\n\n对于 $t=3$ ($\\lambda_{3}=16$)：\n- 机组 $1$：$p_{1,3}^{*} = \\frac{16 - 10}{2 \\times 0.5} = \\frac{6}{1} = 6$。因为 $0 \\le 6 \\le 50$，所以 $p_{1,3}^{\\text{opt}} = 6$。\n- 机组 $2$：$p_{2,3}^{*} = \\frac{16 - 5}{2 \\times 0.2} = \\frac{11}{0.4} = 27.5$。因为 $0 \\le 27.5 \\le 30$，所以 $p_{2,3}^{\\text{opt}} = 27.5$。\n\n现在我们将这些最优值代回拉格朗日表达式中，以计算对偶函数值 $L(\\lambda)$：\n$$ L(\\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} (a_{i} (p_{i,t}^{\\text{opt}})^{2} + b_{i} p_{i,t}^{\\text{opt}}) + \\sum_{t=1}^{3} \\lambda_{t} \\left( D_{t} - \\sum_{i=1}^{2} p_{i,t}^{\\text{opt}} \\right) $$\n首先，我们计算总运行成本项：\n$C(p^{\\text{opt}}) = (0.5 \\cdot 2^2 + 10 \\cdot 2) + (0.2 \\cdot 17.5^2 + 5 \\cdot 17.5) + (0.5 \\cdot 4^2 + 10 \\cdot 4) + (0.2 \\cdot 22.5^2 + 5 \\cdot 22.5) + (0.5 \\cdot 6^2 + 10 \\cdot 6) + (0.2 \\cdot 27.5^2 + 5 \\cdot 27.5)$\n$C(p^{\\text{opt}}) = (2 + 20) + (61.25 + 87.5) + (8 + 40) + (101.25 + 112.5) + (18 + 60) + (151.25 + 137.5)$\n$C(p^{\\text{opt}}) = 22 + 148.75 + 48 + 213.75 + 78 + 288.75 = 799.25$。\n\n接下来，我们使用需求 $D_{1}=25, D_{2}=30, D_{3}=35$ 计算惩罚项 $\\sum \\lambda_t (D_t - \\sum p_{i,t}^{\\text{opt}})$：\n- 对于 $t=1$：$\\lambda_1 (D_1 - (p_{1,1}^{\\text{opt}} + p_{2,1}^{\\text{opt}})) = 12 (25 - (2 + 17.5)) = 12 (5.5) = 66$。\n- 对于 $t=2$：$\\lambda_2 (D_2 - (p_{1,2}^{\\text{opt}} + p_{2,2}^{\\text{opt}})) = 14 (30 - (4 + 22.5)) = 14 (3.5) = 49$。\n- 对于 $t=3$：$\\lambda_3 (D_3 - (p_{1,3}^{\\text{opt}} + p_{2,3}^{\\text{opt}})) = 16 (35 - (6 + 27.5)) = 16 (1.5) = 24$。\n总惩罚项为 $66 + 49 + 24 = 139$。\n\n对偶函数值是这两部分之和：\n$$ L(\\lambda) = 799.25 + 139 = 938.25 $$\n\n次梯度分量 $s_t$ 是对偶化约束的残差，在给定乘子下的最优原始解处计算：\n$$ s_{t} = D_{t} - \\sum_{i=1}^{2} p_{i,t}^{\\text{opt}} $$\n- 对于 $t=1$：$s_1 = 25 - (2 + 17.5) = 25 - 19.5 = 5.5$。\n- 对于 $t=2$：$s_2 = 30 - (4 + 22.5) = 30 - 26.5 = 3.5$。\n- 对于 $t=3$：$s_3 = 35 - (6 + 27.5) = 35 - 33.5 = 1.5$。\n\n最终答案是一个包含 $L(\\lambda)$、$s_1$、$s_2$ 和 $s_3$ 的行矩阵。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 938.25  5.5  3.5  1.5 \\end{pmatrix} } $$"
        },
        {
            "introduction": "这最后一个练习  将所有知识点融会贯通，带领您完整地体验一次次梯度上升算法的迭代，该算法是求解拉格朗日对偶问题的主力方法。从一个初始的乘子猜测开始，您将计算对偶值和次梯度，利用这些信息更新乘子，然后计算出新的、更优的对偶下界。这个实践展示了迭代求解过程的完整循环，以及它如何系统地逼近最优解。",
            "id": "4100502",
            "problem": "考虑一个包含两个发电机组（索引为 $i \\in \\{1,2\\}$）和三个时间周期（索引为 $t \\in \\{1,2,3\\}$）的火电经济调度问题。在每个周期 $t$，系统需求为 $D_{t}$，且系统必须满足需求平衡等式约束。每个机组有一个二元启停决策 $u_{i,t} \\in \\{0,1\\}$ 和一个出力 $P_{i,t} \\in \\mathbb{R}_{+}$，当机组开启时，其出力受到最小和最大限制的约束。机组 $i$ 的每个周期的成本模型是空载成本和凸二次可变发电成本之和。除了每个周期的空载成本外，没有诸如最小启停时间、爬坡限制或启停成本等跨时段约束。\n\n原始问题是在满足需求平衡和各机组可行性约束的条件下，最小化总运行成本：\n最小化 $\\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + b_{i} P_{i,t}\\right)$\n对于每个 $t$，约束为：\n$\\sum_{i=1}^{2} P_{i,t} = D_{t}$，\n并且，对于每个 $i,t$：\n$u_{i,t} \\in \\{0,1\\}$，\n$P_{i,t} \\in [P^{\\min}_{i} u_{i,t}, P^{\\max}_{i} u_{i,t}]$。\n\n数据：\n- 机组 1：$a_{1} = 0.02~\\mathrm{USD}/\\mathrm{MW}^{2}$, $b_{1} = 12~\\mathrm{USD}/\\mathrm{MW}$, $c_{1} = 15~\\mathrm{USD}$, $P^{\\min}_{1} = 10~\\mathrm{MW}$, $P^{\\max}_{1} = 50~\\mathrm{MW}$。\n- 机组 2：$a_{2} = 0.01~\\mathrm{USD}/\\mathrm{MW}^{2}$, $b_{2} = 20~\\mathrm{USD}/\\mathrm{MW}$, $c_{2} = 10~\\mathrm{USD}$, $P^{\\min}_{2} = 5~\\mathrm{MW}$, $P^{\\max}_{2} = 30~\\mathrm{MW}$。\n- 需求：$D_{1} = 40~\\mathrm{MW}$, $D_{2} = 45~\\mathrm{MW}$, $D_{3} = 35~\\mathrm{MW}$。\n\n对三个需求平衡等式约束应用拉格朗日松弛，乘子为 $\\lambda_{t} \\in \\mathbb{R}$，从而形成在机组和周期上可分离的拉格朗日函数。设初始乘子为 $\\lambda^{(0)} = [\\lambda^{(0)}_{1}, \\lambda^{(0)}_{2}, \\lambda^{(0)}_{3}] = [18, 22, 16]~\\mathrm{USD}/\\mathrm{MW}$。使用次梯度上升步长 $\\alpha = 0.1~\\mathrm{USD}/\\mathrm{MW}^{2}$，执行以下操作：\n\n1. 通过在松弛下精确求解每个机组-周期的子问题，并将每个机组-周期的最优值与 $\\sum_{t=1}^{3} \\lambda^{(0)}_{t} D_{t}$ 相加，计算对偶函数值 $g(\\lambda^{(0)})$。\n2. 计算对偶函数相对于松弛约束的次梯度向量 $s(\\lambda^{(0)})$，其各分量由每个周期的需求残差表示。\n3. 执行一次次梯度上升迭代，得到更新后的乘子 $\\lambda^{(1)} = \\lambda^{(0)} + \\alpha \\, s(\\lambda^{(0)})$。\n4. 计算改进的对偶下界 $g(\\lambda^{(1)})$。\n\n将最终改进的对偶下界 $g(\\lambda^{(1)})$报告为单个实数值。以美元（USD）表示最终下界。将您的答案四舍五入到四位有效数字。",
            "solution": "用户提供了一个有效的问题陈述。该问题是一个标准的经济调度模型，适合使用拉格朗日松弛进行分析。它具有科学依据、适定、客观，并包含进行求解所需的所有必要信息。\n\n原始问题是最小化总成本：\n$$ \\text{Minimize } Z = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + b_{i} P_{i,t}\\right) $$\n约束条件如下：\n$$ \\sum_{i=1}^{2} P_{i,t} = D_{t} \\quad \\forall t \\in \\{1,2,3\\} $$\n$$ u_{i,t} \\in \\{0,1\\} \\quad \\forall i,t $$\n$$ P^{\\min}_{i} u_{i,t} \\le P_{i,t} \\le P^{\\max}_{i} u_{i,t} \\quad \\forall i,t $$\n\n我们对需求平衡等式约束 $\\sum_{i=1}^{2} P_{i,t} - D_{t} = 0$ 应用拉格朗日松弛，乘子为 $\\lambda_{t}$。拉格朗日函数 $L(P, u, \\lambda)$ 为：\n$$ L(P, u, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + b_{i} P_{i,t}\\right) + \\sum_{t=1}^{3} \\lambda_{t} \\left(D_{t} - \\sum_{i=1}^{2} P_{i,t}\\right) $$\n重排各项以利用其可分离性：\n$$ L(P, u, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + (b_{i} - \\lambda_{t}) P_{i,t}\\right) + \\sum_{t=1}^{3} \\lambda_{t} D_{t} $$\n对偶函数 $g(\\lambda)$ 是拉格朗日函数关于原始变量 $P$ 和 $u$ 的最小值：\n$$ g(\\lambda) = \\min_{P,u} L(P, u, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left[ \\min_{u_{i,t}, P_{i,t}} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + (b_{i} - \\lambda_{t}) P_{i,t}\\right) \\right] + \\sum_{t=1}^{3} \\lambda_{t} D_{t} $$\n最小化过程受约束 $u_{i,t} \\in \\{0,1\\}$ 和 $P^{\\min}_{i} u_{i,t} \\le P_{i,t} \\le P^{\\max}_{i} u_{i,t}$ 的限制。\n\n对于每个机组 $i$ 和时间 $t$ 的子问题，通过考虑 $u_{i,t}$ 的两种情况来求解：\n1.  如果 $u_{i,t}=0$，则 $P_{i,t}=0$，成本为 $0$。\n2.  如果 $u_{i,t}=1$，我们必须通过在区间 $[P^{\\min}_{i}, P^{\\max}_{i}]$ 上最小化二次函数 $f(P_{i,t}) = a_{i} P_{i,t}^{2} + (b_{i} - \\lambda_{t}) P_{i,t}$ 来找到最优功率输出 $P_{i,t}^{\\text{opt}}$。无约束最小值点为 $P_{i,t}^{*} = \\frac{\\lambda_{t} - b_{i}}{2a_{i}}$。有约束最优解为 $P_{i,t}^{\\text{opt}} = \\max(P^{\\min}_{i}, \\min(P_{i,t}^{*}, P^{\\max}_{i}))$。此情况下的成本为 $C_{i,t}^{\\text{on}} = c_{i} + a_{i} (P_{i,t}^{\\text{opt}})^{2} + (b_{i} - \\lambda_{t}) P_{i,t}^{\\text{opt}}$。\n子问题的解是 $\\min(0, C_{i,t}^{\\text{on}})$。\n\n给定数据如下：\n- 机组 1：$a_{1} = 0.02$, $b_{1} = 12$, $c_{1} = 15$, $P^{\\min}_{1} = 10$, $P^{\\max}_{1} = 50$。\n- 机组 2：$a_{2} = 0.01$, $b_{2} = 20$, $c_{2} = 10$, $P^{\\min}_{2} = 5$, $P^{\\max}_{2} = 30$。\n- 需求：$D_{1} = 40$, $D_{2} = 45$, $D_{3} = 35$。\n- 初始乘子：$\\lambda^{(0)} = [\\lambda^{(0)}_{1}, \\lambda^{(0)}_{2}, \\lambda^{(0)}_{3}] = [18, 22, 16]$。\n- 步长：$\\alpha = 0.1$。\n\n**1. 计算对偶函数值 $g(\\lambda^{(0)})$。**\n我们使用 $\\lambda^{(0)} = [18, 22, 16]$ 求解每个机组和时间周期的子问题。\n\n- 对于 $(i,t)=(1,1)$，$\\lambda_1=18$：$P_{1,1}^{*} = \\frac{18-12}{2(0.02)} = 150$。由于 $150 > P^{\\max}_1=50$，因此 $P_{1,1}^{\\text{opt}}=50$。\n$C_{1,1}^{\\text{on}} = 15 + 0.02(50)^2 + (12-18)(50) = 15+50-300 = -235$。子问题值为 $-235$。\n- 对于 $(i,t)=(2,1)$，$\\lambda_1=18$：$P_{2,1}^{*} = \\frac{18-20}{2(0.01)} = -100$。由于 $-100  P^{\\min}_2=5$，因此 $P_{2,1}^{\\text{opt}}=5$。\n$C_{2,1}^{\\text{on}} = 10 + 0.01(5)^2 + (20-18)(5) = 10+0.25+10 = 20.25$。子问题值为 $\\min(0, 20.25) = 0$。\n- 对于 $(i,t)=(1,2)$，$\\lambda_2=22$：$P_{1,2}^{*} = \\frac{22-12}{2(0.02)} = 250$。由于 $250 > P^{\\max}_1=50$，因此 $P_{1,2}^{\\text{opt}}=50$。\n$C_{1,2}^{\\text{on}} = 15 + 0.02(50)^2 + (12-22)(50) = 15+50-500 = -435$。子问题值为 $-435$。\n- 对于 $(i,t)=(2,2)$，$\\lambda_2=22$：$P_{2,2}^{*} = \\frac{22-20}{2(0.01)} = 100$。由于 $100 > P^{\\max}_2=30$，因此 $P_{2,2}^{\\text{opt}}=30$。\n$C_{2,2}^{\\text{on}} = 10 + 0.01(30)^2 + (20-22)(30) = 10+9-60 = -41$。子问题值为 $-41$。\n- 对于 $(i,t)=(1,3)$，$\\lambda_3=16$：$P_{1,3}^{*} = \\frac{16-12}{2(0.02)} = 100$。由于 $100 > P^{\\max}_1=50$，因此 $P_{1,3}^{\\text{opt}}=50$。\n$C_{1,3}^{\\text{on}} = 15 + 0.02(50)^2 + (12-16)(50) = 15+50-200 = -135$。子问题值为 $-135$。\n- 对于 $(i,t)=(2,3)$，$\\lambda_3=16$：$P_{2,3}^{*} = \\frac{16-20}{2(0.01)} = -200$。由于 $-200  P^{\\min}_2=5$，因此 $P_{2,3}^{\\text{opt}}=5$。\n$C_{2,3}^{\\text{on}} = 10 + 0.01(5)^2 + (20-16)(5) = 10+0.25+20 = 30.25$。子问题值为 $\\min(0, 30.25) = 0$。\n\n子问题最小值之和为 $-235+0-435-41-135+0 = -846$。\n$\\lambda_t D_t$ 项之和为 $18(40) + 22(45) + 16(35) = 720 + 990 + 560 = 2270$。\n$g(\\lambda^{(0)}) = -846 + 2270 = 1424$。\n\n**2. 计算次梯度向量 $s(\\lambda^{(0)})$。**\n次梯度分量为 $s_t = D_t - \\sum_i P_{i,t}^{\\text{opt}}$。\n- $s_1 = D_1 - (P_{1,1}^{\\text{opt}} + P_{2,1}^{\\text{opt}}) = 40 - (50 + 0) = -10$。\n- $s_2 = D_2 - (P_{1,2}^{\\text{opt}} + P_{2,2}^{\\text{opt}}) = 45 - (50 + 30) = -35$。\n- $s_3 = D_3 - (P_{1,3}^{\\text{opt}} + P_{2,3}^{\\text{opt}}) = 35 - (50 + 0) = -15$。\n次梯度向量为 $s(\\lambda^{(0)}) = [-10, -35, -15]$。\n\n**3. 执行一次次梯度上升迭代。**\n更新规则为 $\\lambda^{(1)} = \\lambda^{(0)} + \\alpha s(\\lambda^{(0)})$。当 $\\alpha=0.1$ 时：\n- $\\lambda_1^{(1)} = 18 + 0.1(-10) = 17$。\n- $\\lambda_2^{(1)} = 22 + 0.1(-35) = 18.5$。\n- $\\lambda_3^{(1)} = 16 + 0.1(-15) = 14.5$。\n更新后的乘子为 $\\lambda^{(1)} = [17, 18.5, 14.5]$。\n\n**4. 计算改进的对偶下界 $g(\\lambda^{(1)})$。**\n我们使用新的乘子 $\\lambda^{(1)}$ 求解子问题。\n\n- 对于 $(i,t)=(1,1)$，$\\lambda_1=17$：$P_{1,1}^{*} = \\frac{17-12}{2(0.02)} = 125$。由于 $125 > P^{\\max}_1=50$，因此 $P_{1,1}^{\\text{opt}}=50$。\n$C_{1,1}^{\\text{on}} = 15 + 0.02(50)^2 + (12-17)(50) = 15+50-250 = -185$。子问题值为 $-185$。\n- 对于 $(i,t)=(2,1)$，$\\lambda_1=17$：$P_{2,1}^{*} = \\frac{17-20}{2(0.01)} = -150$。由于 $-150  P^{\\min}_2=5$，因此 $P_{2,1}^{\\text{opt}}=5$。\n$C_{2,1}^{\\text{on}} = 10 + 0.01(5)^2 + (20-17)(5) = 10+0.25+15 = 25.25$。子问题值为 $\\min(0, 25.25) = 0$。\n- 对于 $(i,t)=(1,2)$，$\\lambda_2=18.5$：$P_{1,2}^{*} = \\frac{18.5-12}{2(0.02)} = 162.5$。由于 $162.5 > P^{\\max}_1=50$，因此 $P_{1,2}^{\\text{opt}}=50$。\n$C_{1,2}^{\\text{on}} = 15 + 0.02(50)^2 + (12-18.5)(50) = 15+50-325 = -260$。子问题值为 $-260$。\n- 对于 $(i,t)=(2,2)$，$\\lambda_2=18.5$：$P_{2,2}^{*} = \\frac{18.5-20}{2(0.01)} = -75$。由于 $-75  P^{\\min}_2=5$，因此 $P_{2,2}^{\\text{opt}}=5$。\n$C_{2,2}^{\\text{on}} = 10 + 0.01(5)^2 + (20-18.5)(5) = 10+0.25+7.5 = 17.75$。子问题值为 $\\min(0, 17.75) = 0$。\n- 对于 $(i,t)=(1,3)$，$\\lambda_3=14.5$：$P_{1,3}^{*} = \\frac{14.5-12}{2(0.02)} = 62.5$。由于 $62.5 > P^{\\max}_1=50$，因此 $P_{1,3}^{\\text{opt}}=50$。\n$C_{1,3}^{\\text{on}} = 15 + 0.02(50)^2 + (12-14.5)(50) = 15+50-125 = -60$。子问题值为 $-60$。\n- 对于 $(i,t)=(2,3)$，$\\lambda_3=14.5$：$P_{2,3}^{*} = \\frac{14.5-20}{2(0.01)} = -275$。由于 $-275  P^{\\min}_2=5$，因此 $P_{2,3}^{\\text{opt}}=5$。\n$C_{2,3}^{\\text{on}} = 10 + 0.01(5)^2 + (20-14.5)(5) = 10+0.25+27.5 = 37.75$。子问题值为 $\\min(0, 37.75) = 0$。\n\n使用 $\\lambda^{(1)}$ 时，子问题最小值之和为 $-185+0-260+0-60+0 = -505$。\n$\\lambda_t D_t$ 项之和为 $17(40) + 18.5(45) + 14.5(35) = 680 + 832.5 + 507.5 = 2020$。\n$g(\\lambda^{(1)}) = -505 + 2020 = 1515$。\n\n改进的对偶下界 $g(\\lambda^{(1)})$ 为 $1515$ $\\mathrm{USD}$。问题要求将结果四舍五入到四位有效数字。数字 $1515$ 本身已有四位有效数字。",
            "answer": "$$\n\\boxed{1515}\n$$"
        }
    ]
}