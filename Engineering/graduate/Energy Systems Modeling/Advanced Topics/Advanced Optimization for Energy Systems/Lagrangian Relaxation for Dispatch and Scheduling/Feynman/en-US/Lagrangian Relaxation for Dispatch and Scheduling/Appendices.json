{
    "hands_on_practices": [
        {
            "introduction": "Before tackling complex scheduling problems with Lagrangian Relaxation, it's crucial to master the fundamentals of economic dispatch. This exercise grounds you in solving a classic, single-period dispatch problem using the Karush-Kuhn-Tucker (KKT) conditions. By working through this problem, you will develop a concrete understanding of how the optimal Lagrange multiplier, $\\lambda$, represents the system's marginal price of energy and how this price is influenced by generator operating limits .",
            "id": "4100508",
            "problem": "Consider a single-bus economic dispatch problem for a thermal generation fleet with three units. Each generator $i \\in \\{1,2,3\\}$ produces power $p_i$ measured in megawatts (MW) and incurs an hourly cost given by the quadratic function $C_i(p_i) = a_i p_i^2 + b_i p_i$, where $a_i > 0$ and $b_i \\ge 0$. The system must meet a fixed demand $D$ measured in megawatts (MW), with no transmission constraints. Each generator is subject to physical box limits $P_i^{\\min} \\le p_i \\le P_i^{\\max}$. Assume that startup costs and no-load costs are zero and that the cost functions capture the incremental fuel and variable operations and maintenance costs only. The dispatcher is to minimize the total hourly generation cost subject to the power balance and unit operating limits.\n\nTake the following data:\n- Generator $1$: $a_1 = 0.2$, $b_1 = 10$, $P_1^{\\min} = 20$, $P_1^{\\max} = 120$.\n- Generator $2$: $a_2 = 0.1$, $b_2 = 12$, $P_2^{\\min} = 10$, $P_2^{\\max} = 100$.\n- Generator $3$: $a_3 = 0.3$, $b_3 = 9$, $P_3^{\\min} = 0$, $P_3^{\\max} = 80$.\n- Demand: $D = 200$.\n\nStarting from the definition of convex optimization and the Lagrangian relaxation of the coupling balance constraint, formulate the primal problem with decision variables $p_1$, $p_2$, and $p_3$, and the associated Lagrangian with multipliers for the equality and inequality constraints. Using the Karush-Kuhn-Tucker (KKT) conditions, including stationarity, primal feasibility, dual feasibility, and complementary slackness, derive the necessary conditions for optimality. Compute the optimal dispatch $\\{p_1^{\\star}, p_2^{\\star}, p_3^{\\star}\\}$ and the associated price $\\lambda^{\\star}$ (the optimal multiplier of the balance constraint), carefully determining which unit limits are active at optimum and verifying consistency of complementary slackness. No rounding is required; provide exact values.\n\nReport your final answer as a row matrix in the order $\\left[p_1^{\\star}\\; p_2^{\\star}\\; p_3^{\\star}\\; \\lambda^{\\star}\\right]$. Express $p_i^{\\star}$ in megawatts (MW) and $\\lambda^{\\star}$ in dollars per megawatt-hour ($\\$/\\mathrm{MWh}$).",
            "solution": "The problem is a classic economic dispatch problem, which is a convex optimization problem. We first validate the problem statement.\n\n### Step 1: Extract Givens\n- **Cost Functions**: $C_i(p_i) = a_i p_i^2 + b_i p_i$ for $i \\in \\{1,2,3\\}$.\n- **Generator 1 Data**: $a_1 = 0.2$, $b_1 = 10$, $P_1^{\\min} = 20$ MW, $P_1^{\\max} = 120$ MW.\n- **Generator 2 Data**: $a_2 = 0.1$, $b_2 = 12$, $P_2^{\\min} = 10$ MW, $P_2^{\\max} = 100$ MW.\n- **Generator 3 Data**: $a_3 = 0.3$, $b_3 = 9$, $P_3^{\\min} = 0$ MW, $P_3^{\\max} = 80$ MW.\n- **Total Demand**: $D = 200$ MW.\n- **Constraints**:\n    - Power balance: $\\sum_{i=1}^3 p_i = D$.\n    - Generator limits: $P_i^{\\min} \\le p_i \\le P_i^{\\max}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem models the economic dispatch of thermal generators, a fundamental and well-established problem in power systems engineering. The quadratic cost functions are a standard, realistic approximation for fuel costs. The parameters are physically plausible. The optimization approach using Lagrangian relaxation and KKT conditions is a standard and rigorous mathematical technique for this class of problems. The problem is scientifically sound.\n- **Well-Posed**: The objective function, being a sum of quadratic functions with positive leading coefficients ($a_i > 0$), is strictly convex. The feasible region, defined by linear equality and inequality constraints, is a convex set (a polytope). The minimization of a strictly convex function over a non-empty, closed, convex set has a unique solution. Therefore, the problem is well-posed.\n- **Objective**: The problem is stated using precise mathematical terms and numerical data, with a clear and unambiguous objective. It is free of subjective language.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed to solve it.\n\n### Primal Problem Formulation\nThe goal is to minimize the total generation cost, $C_{total}$, subject to the demand being met and respecting individual generator limits. The decision variables are the power outputs $p_1, p_2, p_3$.\n\nThe optimization problem is:\n$$\n\\begin{aligned}\n& \\underset{p_1, p_2, p_3}{\\text{minimize}}\n& & C_{total} = \\sum_{i=1}^{3} C_i(p_i) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i) \\\\\n& \\text{subject to}\n& & \\sum_{i=1}^{3} p_i = D \\quad (\\text{multiplier } \\lambda) \\\\\n& & & P_i^{\\min} \\le p_i \\le P_i^{\\max} \\quad \\forall i \\in \\{1,2,3\\}\n\\end{aligned}\n$$\nThe lower and upper bound inequalities can be written as $P_i^{\\min} - p_i \\le 0$ (multiplier $\\mu_i^{\\min}$) and $p_i - P_i^{\\max} \\le 0$ (multiplier $\\mu_i^{\\max}$).\n\n### Lagrangian Formulation\nThe Lagrangian function $L$ incorporates all constraints:\n$$\nL(p, \\lambda, \\mu^{\\min}, \\mu^{\\max}) = \\sum_{i=1}^{3} (a_i p_i^2 + b_i p_i) + \\lambda \\left( D - \\sum_{i=1}^{3} p_i \\right) + \\sum_{i=1}^{3} \\mu_i^{\\min} (P_i^{\\min} - p_i) + \\sum_{i=1}^{3} \\mu_i^{\\max} (p_i - P_i^{\\max})\n$$\nwhere $p = (p_1, p_2, p_3)$, $\\mu^{\\min} = (\\mu_1^{\\min}, \\mu_2^{\\min}, \\mu_3^{\\min})$, and $\\mu^{\\max} = (\\mu_1^{\\max}, \\mu_2^{\\max}, \\mu_3^{\\max})$.\n\n### Karush-Kuhn-Tucker (KKT) Conditions\nFor a point $(p_1^{\\star}, p_2^{\\star}, p_3^{\\star})$ to be optimal, there must exist multipliers $\\lambda^{\\star}, \\mu_i^{\\min, \\star}, \\mu_i^{\\max, \\star}$ such that the following KKT conditions are met:\n1.  **Stationarity**: $\\frac{\\partial L}{\\partial p_i} = 0$ for $i=1, 2, 3$.\n    $$ 2a_i p_i^{\\star} + b_i - \\lambda^{\\star} - \\mu_i^{\\min, \\star} + \\mu_i^{\\max, \\star} = 0 $$\n2.  **Primal Feasibility**:\n    $$ \\sum_{i=1}^{3} p_i^{\\star} = D $$\n    $$ P_i^{\\min} \\le p_i^{\\star} \\le P_i^{\\max} $$\n3.  **Dual Feasibility**:\n    $$ \\mu_i^{\\min, \\star} \\ge 0, \\quad \\mu_i^{\\max, \\star} \\ge 0 $$\n4.  **Complementary Slackness**:\n    $$ \\mu_i^{\\min, \\star} (P_i^{\\min} - p_i^{\\star}) = 0 $$\n    $$ \\mu_i^{\\max, \\star} (p_i^{\\star} - P_i^{\\max}) = 0 $$\n\nThe term $2a_i p_i + b_i$ is the incremental cost of generator $i$, denoted $IC_i(p_i)$. The stationarity condition can be rewritten as $IC_i(p_i^{\\star}) = \\lambda^{\\star} + \\mu_i^{\\min, \\star} - \\mu_i^{\\max, \\star}$. Analyzing with complementary slackness gives three cases for each generator:\n- If $P_i^{\\min} < p_i^{\\star} < P_i^{\\max}$, then $\\mu_i^{\\min, \\star} = 0$ and $\\mu_i^{\\max, \\star} = 0$. The condition becomes $IC_i(p_i^{\\star}) = \\lambda^{\\star}$.\n- If $p_i^{\\star} = P_i^{\\min}$, then $\\mu_i^{\\max, \\star} = 0$ and $\\mu_i^{\\min, \\star} \\ge 0$. The condition implies $IC_i(P_i^{\\min}) = \\lambda^{\\star} + \\mu_i^{\\min, \\star}$, so $IC_i(P_i^{\\min}) \\ge \\lambda^{\\star}$.\n- If $p_i^{\\star} = P_i^{\\max}$, then $\\mu_i^{\\min, \\star} = 0$ and $\\mu_i^{\\max, \\star} \\ge 0$. The condition implies $IC_i(P_i^{\\max}) = \\lambda^{\\star} - \\mu_i^{\\max, \\star}$, so $IC_i(P_i^{\\max}) \\le \\lambda^{\\star}$.\n\n### Iterative Solution\nWe use an iterative approach to find the set of active constraints.\n\n**Iteration 1: Assume no generator limits are active.**\nIn this case, $IC_i(p_i) = \\lambda$ for all $i$. This gives $p_i = (\\lambda - b_i) / (2a_i)$.\nThe power balance equation is $\\sum_{i=1}^{3} p_i = D = 200$.\n$$\n\\frac{\\lambda - 10}{2(0.2)} + \\frac{\\lambda - 12}{2(0.1)} + \\frac{\\lambda - 9}{2(0.3)} = 200\n$$\n$$\n\\frac{\\lambda - 10}{0.4} + \\frac{\\lambda - 12}{0.2} + \\frac{\\lambda - 9}{0.6} = 200\n$$\nTo solve for $\\lambda$, we can write this as:\n$$\n(\\lambda - 10) \\left(\\frac{1}{0.4}\\right) + (\\lambda - 12) \\left(\\frac{1}{0.2}\\right) + (\\lambda - 9) \\left(\\frac{1}{0.6}\\right) = 200\n$$\n$$\n2.5(\\lambda - 10) + 5(\\lambda - 12) + \\frac{5}{3}(\\lambda - 9) = 200\n$$\nMultiplying by $6$ to clear all decimals and fractions:\n$$\n15(\\lambda - 10) + 30(\\lambda - 12) + 10(\\lambda - 9) = 1200\n$$\n$$\n15\\lambda - 150 + 30\\lambda - 360 + 10\\lambda - 90 = 1200\n$$\n$$\n55\\lambda - 600 = 1200 \\implies 55\\lambda = 1800 \\implies \\lambda = \\frac{1800}{55} = \\frac{360}{11}\n$$\nNow we compute the dispatch values with $\\lambda = 360/11 \\approx 32.727$:\n$p_1 = \\frac{360/11 - 10}{0.4} = \\frac{(360-110)/11}{0.4} = \\frac{250/11}{0.4} = \\frac{625}{11} \\approx 56.82$ MW.\nThis is within the limits $[20, 120]$ for generator $1$.\n$p_2 = \\frac{360/11 - 12}{0.2} = \\frac{(360-132)/11}{0.2} = \\frac{228/11}{0.2} = \\frac{1140}{11} \\approx 103.64$ MW.\nThis value exceeds the upper limit $P_2^{\\max} = 100$ MW for generator $2$. The assumption is false.\n\n**Iteration 2: Set generator 2 to its violated limit and re-dispatch.**\nWe fix the dispatch of generator $2$ at its maximum limit: $p_2^{\\star} = P_2^{\\max} = 100$ MW.\nThe remaining demand to be met by generators $1$ and $3$ is $D' = D - p_2^{\\star} = 200 - 100 = 100$ MW.\nWe now apply the equal incremental cost principle to generators $1$ and $3$ to meet the demand $D' = 100$.\n$$\n\\frac{\\lambda - 10}{0.4} + \\frac{\\lambda - 9}{0.6} = 100\n$$\n$$\n2.5(\\lambda - 10) + \\frac{5}{3}(\\lambda - 9) = 100\n$$\nMultiplying by $6$:\n$$\n15(\\lambda - 10) + 10(\\lambda - 9) = 600\n$$\n$$\n15\\lambda - 150 + 10\\lambda - 90 = 600\n$$\n$$\n25\\lambda - 240 = 600 \\implies 25\\lambda = 840 \\implies \\lambda = \\frac{840}{25} = \\frac{168}{5} = 33.6\n$$\nWith this new system price, $\\lambda^{\\star} = 33.6 \\, \\$/\\mathrm{MWh}$, we compute the dispatch for generators $1$ and $3$:\n$p_1^{\\star} = \\frac{33.6 - 10}{0.4} = \\frac{23.6}{0.4} = 59$ MW.\nThis is within the limits $[20, 120]$.\n$p_3^{\\star} = \\frac{33.6 - 9}{0.6} = \\frac{24.6}{0.6} = 41$ MW.\nThis is within the limits $[0, 80]$.\n\n### Verification of the Solution\nThe proposed optimal solution is $\\{p_1^{\\star}, p_2^{\\star}, p_3^{\\star}\\} = \\{59, 100, 41\\}$ and $\\lambda^{\\star} = 33.6$.\n1.  **Primal Feasibility**:\n    - Power balance: $p_1^{\\star} + p_2^{\\star} + p_3^{\\star} = 59 + 100 + 41 = 200$ MW. This matches the demand $D$.\n    - Generator limits:\n        - $20 \\le p_1^{\\star} = 59 \\le 120$ (OK)\n        - $10 \\le p_2^{\\star} = 100 \\le 100$ (OK, at max limit)\n        - $0 \\le p_3^{\\star} = 41 \\le 80$ (OK)\n    All primal feasibility conditions are satisfied.\n\n2.  **KKT Conditions (Incremental Costs)**:\n    - **Generator 1**: Not at limits. We must verify $IC_1(p_1^{\\star}) = \\lambda^{\\star}$.\n      $IC_1(59) = 2(0.2)(59) + 10 = 0.4(59) + 10 = 23.6 + 10 = 33.6$. This equals $\\lambda^{\\star}$.\n    - **Generator 2**: At upper limit. We must verify $IC_2(p_2^{\\star}) \\le \\lambda^{\\star}$.\n      $IC_2(100) = 2(0.1)(100) + 12 = 20 + 12 = 32$.\n      The condition is $32 \\le 33.6$, which is true. (Complementary slackness gives $\\mu_2^{\\max, \\star} = \\lambda^{\\star} - IC_2(100) = 33.6 - 32 = 1.6 \\ge 0$).\n    - **Generator 3**: Not at limits. We must verify $IC_3(p_3^{\\star}) = \\lambda^{\\star}$.\n      $IC_3(41) = 2(0.3)(41) + 9 = 0.6(41) + 9 = 24.6 + 9 = 33.6$. This equals $\\lambda^{\\star}$.\n\nAll KKT conditions are satisfied, confirming that the solution is the unique optimum.\n\nThe final optimal dispatch is $p_1^{\\star} = 59$ MW, $p_2^{\\star} = 100$ MW, $p_3^{\\star} = 41$ MW, with an optimal system price of $\\lambda^{\\star} = 33.6$ $\\$/\\mathrm{MWh}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n59 & 100 & 41 & 33.6\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having established the fundamentals of economic dispatch, we now apply Lagrangian Relaxation to a more complex multi-period problem. This practice guides you through the core mechanics of the decomposition technique, where relaxing the system-wide demand constraints allows the problem to be broken into simpler, independent subproblems for each generating unit . Your task is to solve these subproblems for a given set of multipliers and then compute the dual function value and, most importantly, the subgradient, which provides the essential information needed to iteratively solve the dual problem.",
            "id": "4100512",
            "problem": "Consider a multi-period economic dispatch problem over three time periods $t \\in \\{1,2,3\\}$ with two thermal generating units $i \\in \\{1,2\\}$. Each unit $i$ produces power $p_{i,t}$ in megawatts (MW) in period $t$, subject to $0 \\leq p_{i,t} \\leq P_{i}^{\\max}$, and incurs a convex differentiable operating cost $C_{i}(p_{i,t}) = a_{i} p_{i,t}^{2} + b_{i} p_{i,t}$. The system demand in each period is $D_{t}$, and the primal problem is to minimize total operating cost subject to per-period demand balance and capacity limits. A Lagrangian relaxation is formed by dualizing the per-period demand balance constraints with multipliers $\\lambda_{t}$.\n\nData:\n- Unit $1$: $a_{1} = 0.5$, $b_{1} = 10$, $P_{1}^{\\max} = 50$.\n- Unit $2$: $a_{2} = 0.2$, $b_{2} = 5$, $P_{2}^{\\max} = 30$.\n- Demands: $D_{1} = 25$, $D_{2} = 30$, $D_{3} = 35$ (MW).\n- Multipliers: $\\lambda_{1} = 12$, $\\lambda_{2} = 14$, $\\lambda_{3} = 16$.\n\nStarting from first principles of convex optimization and Lagrangian duality, compute the dual function value $L(\\lambda)$ obtained by solving the decomposed unit subproblems and aggregating across units and periods, and compute the associated subgradient components $s_{t}$ defined by the residuals of the dualized constraints at the minimizing primal decisions for the given multipliers. Provide your final answer as a single row matrix containing $L(\\lambda)$ followed by $s_{1}$, $s_{2}$, and $s_{3}$. No rounding is required. The power quantities are in megawatts (MW); the final matrix should contain only numerical values.",
            "solution": "The problem is valid. It describes a standard application of Lagrangian relaxation to an economic dispatch problem, which is a well-established convex optimization problem in power systems engineering. The problem is scientifically grounded, well-posed, objective, and self-contained, with all necessary data and definitions provided.\n\nThe primal economic dispatch problem is to minimize the total operating cost subject to demand balance and generator capacity limits.\nThe objective function is the sum of costs for all units over all periods:\n$$ \\min_{p_{i,t}} \\sum_{t=1}^{3} \\sum_{i=1}^{2} C_{i}(p_{i,t}) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} (a_{i} p_{i,t}^{2} + b_{i} p_{i,t}) $$\nThis is subject to the constraints:\n1. Demand balance for each period $t$: $\\sum_{i=1}^{2} p_{i,t} = D_{t}$ for $t \\in \\{1, 2, 3\\}$.\n2. Generation limits for each unit $i$ and period $t$: $0 \\leq p_{i,t} \\leq P_{i}^{\\max}$ for $i \\in \\{1, 2\\}$, $t \\in \\{1, 2, 3\\}$.\n\nTo form the Lagrangian relaxation, we dualize the demand balance constraints using the Lagrange multipliers $\\lambda_{t}$. The Lagrangian function $L(p, \\lambda)$ is:\n$$ L(p, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} C_{i}(p_{i,t}) + \\sum_{t=1}^{3} \\lambda_{t} \\left( D_{t} - \\sum_{i=1}^{2} p_{i,t} \\right) $$\nBy rearranging terms, we can see that the Lagrangian is separable by unit $i$ and time period $t$:\n$$ L(p, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} (a_{i} p_{i,t}^{2} + b_{i} p_{i,t} - \\lambda_{t} p_{i,t}) + \\sum_{t=1}^{3} \\lambda_{t} D_{t} $$\nThe dual function $L(\\lambda)$ is found by minimizing the Lagrangian $L(p, \\lambda)$ with respect to the primal variables $p_{i,t}$, subject to the remaining non-dualized constraints ($0 \\leq p_{i,t} \\leq P_{i}^{\\max}$):\n$$ L(\\lambda) = \\min_{0 \\leq p_{i,t} \\leq P_{i}^{\\max}} L(p, \\lambda) $$\nDue to separability, this minimization can be decomposed into independent subproblems for each unit $i$ and time period $t$:\n$$ L(\\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left( \\min_{0 \\leq p_{i,t} \\leq P_{i}^{\\max}} \\{ a_{i} p_{i,t}^{2} + (b_{i} - \\lambda_{t}) p_{i,t} \\} \\right) + \\sum_{t=1}^{3} \\lambda_{t} D_{t} $$\nEach subproblem is a simple quadratic minimization. To find the unconstrained minimum of the term inside the brackets, we take the derivative with respect to $p_{i,t}$ and set it to zero:\n$$ \\frac{d}{dp_{i,t}} [a_{i} p_{i,t}^{2} + (b_{i} - \\lambda_{t}) p_{i,t}] = 2 a_{i} p_{i,t} + b_{i} - \\lambda_{t} = 0 $$\nSolving for $p_{i,t}$ gives the optimal unconstrained dispatch for each subproblem, denoted as $p_{i,t}^{*}$:\n$$ p_{i,t}^{*} = \\frac{\\lambda_{t} - b_{i}}{2 a_{i}} $$\nThe solution to the subproblem, $p_{i,t}^{\\text{opt}}$, must satisfy the capacity constraints, so we project $p_{i,t}^{*}$ onto the interval $[0, P_{i}^{\\max}]$:\n$$ p_{i,t}^{\\text{opt}} = \\max(0, \\min(P_{i}^{\\max}, p_{i,t}^{*})) $$\nWe now compute $p_{i,t}^{\\text{opt}}$ for the given data:\n- Unit $1$: $a_{1}=0.5$, $b_{1}=10$, $P_{1}^{\\max}=50$.\n- Unit $2$: $a_{2}=0.2$, $b_{2}=5$, $P_{2}^{\\max}=30$.\n- Multipliers: $\\lambda_{1}=12$, $\\lambda_{2}=14$, $\\lambda_{3}=16$.\n\nFor $t=1$ ($\\lambda_{1}=12$):\n- Unit $1$: $p_{1,1}^{*} = \\frac{12 - 10}{2 \\times 0.5} = \\frac{2}{1} = 2$. Since $0 \\le 2 \\le 50$, $p_{1,1}^{\\text{opt}} = 2$.\n- Unit $2$: $p_{2,1}^{*} = \\frac{12 - 5}{2 \\times 0.2} = \\frac{7}{0.4} = 17.5$. Since $0 \\le 17.5 \\le 30$, $p_{2,1}^{\\text{opt}} = 17.5$.\n\nFor $t=2$ ($\\lambda_{2}=14$):\n- Unit $1$: $p_{1,2}^{*} = \\frac{14 - 10}{2 \\times 0.5} = \\frac{4}{1} = 4$. Since $0 \\le 4 \\le 50$, $p_{1,2}^{\\text{opt}} = 4$.\n- Unit $2$: $p_{2,2}^{*} = \\frac{14 - 5}{2 \\times 0.2} = \\frac{9}{0.4} = 22.5$. Since $0 \\le 22.5 \\le 30$, $p_{2,2}^{\\text{opt}} = 22.5$.\n\nFor $t=3$ ($\\lambda_{3}=16$):\n- Unit $1$: $p_{1,3}^{*} = \\frac{16 - 10}{2 \\times 0.5} = \\frac{6}{1} = 6$. Since $0 \\le 6 \\le 50$, $p_{1,3}^{\\text{opt}} = 6$.\n- Unit $2$: $p_{2,3}^{*} = \\frac{16 - 5}{2 \\times 0.2} = \\frac{11}{0.4} = 27.5$. Since $0 \\le 27.5 \\le 30$, $p_{2,3}^{\\text{opt}} = 27.5$.\n\nNow we calculate the dual function value $L(\\lambda)$ by substituting these optimal values back into the Lagrangian expression:\n$$ L(\\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} (a_{i} (p_{i,t}^{\\text{opt}})^{2} + b_{i} p_{i,t}^{\\text{opt}}) + \\sum_{t=1}^{3} \\lambda_{t} \\left( D_{t} - \\sum_{i=1}^{2} p_{i,t}^{\\text{opt}} \\right) $$\nFirst, we compute the total operating cost term:\n$C(p^{\\text{opt}}) = (0.5 \\cdot 2^2 + 10 \\cdot 2) + (0.2 \\cdot 17.5^2 + 5 \\cdot 17.5) + (0.5 \\cdot 4^2 + 10 \\cdot 4) + (0.2 \\cdot 22.5^2 + 5 \\cdot 22.5) + (0.5 \\cdot 6^2 + 10 \\cdot 6) + (0.2 \\cdot 27.5^2 + 5 \\cdot 27.5)$\n$C(p^{\\text{opt}}) = (2 + 20) + (61.25 + 87.5) + (8 + 40) + (101.25 + 112.5) + (18 + 60) + (151.25 + 137.5)$\n$C(p^{\\text{opt}}) = 22 + 148.75 + 48 + 213.75 + 78 + 288.75 = 799.25$.\n\nNext, we compute the penalty term $\\sum \\lambda_t (D_t - \\sum p_{i,t}^{\\text{opt}})$ using demands $D_{1}=25, D_{2}=30, D_{3}=35$:\n- For $t=1$: $\\lambda_1 (D_1 - (p_{1,1}^{\\text{opt}} + p_{2,1}^{\\text{opt}})) = 12 (25 - (2 + 17.5)) = 12 (5.5) = 66$.\n- For $t=2$: $\\lambda_2 (D_2 - (p_{1,2}^{\\text{opt}} + p_{2,2}^{\\text{opt}})) = 14 (30 - (4 + 22.5)) = 14 (3.5) = 49$.\n- For $t=3$: $\\lambda_3 (D_3 - (p_{1,3}^{\\text{opt}} + p_{2,3}^{\\text{opt}})) = 16 (35 - (6 + 27.5)) = 16 (1.5) = 24$.\nThe total penalty term is $66 + 49 + 24 = 139$.\n\nThe dual function value is the sum of these two parts:\n$$ L(\\lambda) = 799.25 + 139 = 938.25 $$\n\nThe subgradient components, $s_t$, are the residuals of the dualized constraints, evaluated at the optimal primal solutions for the given multipliers:\n$$ s_{t} = D_{t} - \\sum_{i=1}^{2} p_{i,t}^{\\text{opt}} $$\n- For $t=1$: $s_1 = 25 - (2 + 17.5) = 25 - 19.5 = 5.5$.\n- For $t=2$: $s_2 = 30 - (4 + 22.5) = 30 - 26.5 = 3.5$.\n- For $t=3$: $s_3 = 35 - (6 + 27.5) = 35 - 33.5 = 1.5$.\n\nThe final answer is a row matrix containing $L(\\lambda)$, $s_1$, $s_2$, and $s_3$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 938.25 & 5.5 & 3.5 & 1.5 \\end{pmatrix} } $$"
        },
        {
            "introduction": "This final practice brings all the concepts together by walking you through one complete iteration of the subgradient ascent method, the workhorse algorithm for solving the Lagrangian dual problem. Building on the previous exercises, you will calculate the dual value and subgradient for a scheduling problem that includes commitment decisions, and then use the subgradient to update the Lagrange multipliers . By re-evaluating the dual function with the new multipliers, you will directly observe how this iterative process works to improve the dual bound, providing a practical, hands-on demonstration of the entire solution framework.",
            "id": "4100502",
            "problem": "Consider a three-period thermal economic dispatch and scheduling problem with two generating units, indexed by $i \\in \\{1,2\\}$ and time periods $t \\in \\{1,2,3\\}$. In each period $t$, the system demand is $D_{t}$ and the system must satisfy the demand balance equality constraint. Each unit has a binary on/off decision $u_{i,t} \\in \\{0,1\\}$ and an output $P_{i,t} \\in \\mathbb{R}_{+}$ constrained by minimum and maximum limits when on. The per-period cost model for unit $i$ is the sum of a no-load cost and a convex quadratic variable generation cost. There are no inter-temporal constraints such as minimum up/down times, ramping limits, or startup/shutdown costs beyond the per-period no-load cost.\n\nThe primal problem is to minimize the total operating cost subject to demand balance and per-unit feasibility:\nMinimize $\\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + b_{i} P_{i,t}\\right)$\nsubject to, for each $t$,\n$\\sum_{i=1}^{2} P_{i,t} = D_{t}$,\nand, for each $i,t$,\n$u_{i,t} \\in \\{0,1\\}$,\n$P_{i,t} \\in [P^{\\min}_{i} u_{i,t}, P^{\\max}_{i} u_{i,t}]$.\n\nData:\n- Unit $1$: $a_{1} = 0.02$ $\\mathrm{USD}/\\mathrm{MW}^{2}$, $b_{1} = 12$ $\\mathrm{USD}/\\mathrm{MW}$, $c_{1} = 15$ $\\mathrm{USD}$, $P^{\\min}_{1} = 10$ $\\mathrm{MW}$, $P^{\\max}_{1} = 50$ $\\mathrm{MW}$.\n- Unit $2$: $a_{2} = 0.01$ $\\mathrm{USD}/\\mathrm{MW}^{2}$, $b_{2} = 20$ $\\mathrm{USD}/\\mathrm{MW}$, $c_{2} = 10$ $\\mathrm{USD}$, $P^{\\min}_{2} = 5$ $\\mathrm{MW}$, $P^{\\max}_{2} = 30$ $\\mathrm{MW}$.\n- Demands: $D_{1} = 40$ $\\mathrm{MW}$, $D_{2} = 45$ $\\mathrm{MW}$, $D_{3} = 35$ $\\mathrm{MW}$.\n\nApply Lagrangian relaxation to the three demand balance equality constraints with multipliers $\\lambda_{t} \\in \\mathbb{R}$, forming the separable Lagrangian across units and periods. Let the initial multipliers be $\\lambda^{(0)} = [\\lambda^{(0)}_{1}, \\lambda^{(0)}_{2}, \\lambda^{(0)}_{3}] = [18, 22, 16]$ $\\mathrm{USD}/\\mathrm{MW}$. Using a subgradient ascent step size $\\alpha = 0.1$ $\\mathrm{USD}/\\mathrm{MW}^{2}$, perform the following:\n\n1. Compute the dual function value $g(\\lambda^{(0)})$ by solving each unit-period subproblem exactly under the relaxation and summing the optimal per-unit-period values plus $\\sum_{t=1}^{3} \\lambda^{(0)}_{t} D_{t}$.\n2. Compute the subgradient vector $s(\\lambda^{(0)})$ of the dual function with respect to the relaxed constraints, expressed component-wise by the demand residuals in each period.\n3. Perform one subgradient ascent iteration to obtain updated multipliers $\\lambda^{(1)} = \\lambda^{(0)} + \\alpha \\, s(\\lambda^{(0)})$.\n4. Compute the improved dual bound $g(\\lambda^{(1)})$.\n\nReport the final improved dual bound $g(\\lambda^{(1)})$ as a single real-valued number. Express the final bound in United States Dollars (USD). Round your answer to four significant figures.",
            "solution": "The user has provided a valid problem statement. The problem is a standard economic dispatch formulation suitable for analysis using Lagrangian relaxation. It is scientifically grounded, well-posed, objective, and contains all necessary information to proceed with a solution.\n\nThe primal problem is to minimize the total cost:\n$$ \\text{Minimize } Z = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + b_{i} P_{i,t}\\right) $$\nsubject to the constraints:\n$$ \\sum_{i=1}^{2} P_{i,t} = D_{t} \\quad \\forall t \\in \\{1,2,3\\} $$\n$$ u_{i,t} \\in \\{0,1\\} \\quad \\forall i,t $$\n$$ P^{\\min}_{i} u_{i,t} \\le P_{i,t} \\le P^{\\max}_{i} u_{i,t} \\quad \\forall i,t $$\n\nWe apply Lagrangian relaxation to the demand balance equality constraints, $\\sum_{i=1}^{2} P_{i,t} - D_{t} = 0$, with multipliers $\\lambda_{t}$. The Lagrangian function $L(P, u, \\lambda)$ is:\n$$ L(P, u, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + b_{i} P_{i,t}\\right) + \\sum_{t=1}^{3} \\lambda_{t} \\left(D_{t} - \\sum_{i=1}^{2} P_{i,t}\\right) $$\nRearranging terms to exploit separability:\n$$ L(P, u, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + (b_{i} - \\lambda_{t}) P_{i,t}\\right) + \\sum_{t=1}^{3} \\lambda_{t} D_{t} $$\nThe dual function $g(\\lambda)$ is the minimum of the Lagrangian over the primal variables $P$ and $u$:\n$$ g(\\lambda) = \\min_{P,u} L(P, u, \\lambda) = \\sum_{t=1}^{3} \\sum_{i=1}^{2} \\left[ \\min_{u_{i,t}, P_{i,t}} \\left(c_{i} u_{i,t} + a_{i} P_{i,t}^{2} + (b_{i} - \\lambda_{t}) P_{i,t}\\right) \\right] + \\sum_{t=1}^{3} \\lambda_{t} D_{t} $$\nThe minimization is subject to $u_{i,t} \\in \\{0,1\\}$ and $P^{\\min}_{i} u_{i,t} \\le P_{i,t} \\le P^{\\max}_{i} u_{i,t}$.\n\nEach subproblem for a unit $i$ and time $t$ is solved by considering two cases for $u_{i,t}$:\n1.  If $u_{i,t}=0$, then $P_{i,t}=0$ and the cost is $0$.\n2.  If $u_{i,t}=1$, we must find the optimal power output $P_{i,t}^{\\text{opt}}$ by minimizing the quadratic function $f(P_{i,t}) = a_{i} P_{i,t}^{2} + (b_{i} - \\lambda_{t}) P_{i,t}$ over the interval $[P^{\\min}_{i}, P^{\\max}_{i}]$. The unconstrained minimum is at $P_{i,t}^{*} = \\frac{\\lambda_{t} - b_{i}}{2a_{i}}$. The constrained optimum is $P_{i,t}^{\\text{opt}} = \\max(P^{\\min}_{i}, \\min(P_{i,t}^{*}, P^{\\max}_{i}))$. The cost for this case is $C_{i,t}^{\\text{on}} = c_{i} + a_{i} (P_{i,t}^{\\text{opt}})^{2} + (b_{i} - \\lambda_{t}) P_{i,t}^{\\text{opt}}$.\nThe subproblem solution is $\\min(0, C_{i,t}^{\\text{on}})$.\n\nThe given data are:\n- Unit $1$: $a_{1} = 0.02$, $b_{1} = 12$, $c_{1} = 15$, $P^{\\min}_{1} = 10$, $P^{\\max}_{1} = 50$.\n- Unit $2$: $a_{2} = 0.01$, $b_{2} = 20$, $c_{2} = 10$, $P^{\\min}_{2} = 5$, $P^{\\max}_{2} = 30$.\n- Demands: $D_{1} = 40$, $D_{2} = 45$, $D_{3} = 35$.\n- Initial multipliers: $\\lambda^{(0)} = [\\lambda^{(0)}_{1}, \\lambda^{(0)}_{2}, \\lambda^{(0)}_{3}] = [18, 22, 16]$.\n- Step size: $\\alpha = 0.1$.\n\n**1. Compute the dual function value $g(\\lambda^{(0)})$.**\nWe solve the subproblems for each unit and time period with $\\lambda^{(0)} = [18, 22, 16]$.\n\n- For $(i,t)=(1,1)$ with $\\lambda_1=18$: $P_{1,1}^{*} = \\frac{18-12}{2(0.02)} = 150$. Since $150 > P^{\\max}_1=50$, $P_{1,1}^{\\text{opt}}=50$.\n$C_{1,1}^{\\text{on}} = 15 + 0.02(50)^2 + (12-18)(50) = 15+50-300 = -235$. Subproblem value is $-235$.\n- For $(i,t)=(2,1)$ with $\\lambda_1=18$: $P_{2,1}^{*} = \\frac{18-20}{2(0.01)} = -100$. Since $-100 < P^{\\min}_2=5$, $P_{2,1}^{\\text{opt}}=5$.\n$C_{2,1}^{\\text{on}} = 10 + 0.01(5)^2 + (20-18)(5) = 10+0.25+10 = 20.25$. Subproblem value is $\\min(0, 20.25) = 0$.\n- For $(i,t)=(1,2)$ with $\\lambda_2=22$: $P_{1,2}^{*} = \\frac{22-12}{2(0.02)} = 250$. Since $250 > P^{\\max}_1=50$, $P_{1,2}^{\\text{opt}}=50$.\n$C_{1,2}^{\\text{on}} = 15 + 0.02(50)^2 + (12-22)(50) = 15+50-500 = -435$. Subproblem value is $-435$.\n- For $(i,t)=(2,2)$ with $\\lambda_2=22$: $P_{2,2}^{*} = \\frac{22-20}{2(0.01)} = 100$. Since $100 > P^{\\max}_2=30$, $P_{2,2}^{\\text{opt}}=30$.\n$C_{2,2}^{\\text{on}} = 10 + 0.01(30)^2 + (20-22)(30) = 10+9-60 = -41$. Subproblem value is $-41$.\n- For $(i,t)=(1,3)$ with $\\lambda_3=16$: $P_{1,3}^{*} = \\frac{16-12}{2(0.02)} = 100$. Since $100 > P^{\\max}_1=50$, $P_{1,3}^{\\text{opt}}=50$.\n$C_{1,3}^{\\text{on}} = 15 + 0.02(50)^2 + (12-16)(50) = 15+50-200 = -135$. Subproblem value is $-135$.\n- For $(i,t)=(2,3)$ with $\\lambda_3=16$: $P_{2,3}^{*} = \\frac{16-20}{2(0.01)} = -200$. Since $-200 < P^{\\min}_2=5$, $P_{2,3}^{\\text{opt}}=5$.\n$C_{2,3}^{\\text{on}} = 10 + 0.01(5)^2 + (20-16)(5) = 10+0.25+20 = 30.25$. Subproblem value is $\\min(0, 30.25) = 0$.\n\nThe sum of subproblem minimums is $-235+0-435-41-135+0 = -846$.\nThe sum of $\\lambda_t D_t$ terms is $18(40) + 22(45) + 16(35) = 720 + 990 + 560 = 2270$.\n$g(\\lambda^{(0)}) = -846 + 2270 = 1424$.\n\n**2. Compute the subgradient vector $s(\\lambda^{(0)})$.**\nThe subgradient components are $s_t = D_t - \\sum_i P_{i,t}^{\\text{opt}}$.\n- $s_1 = D_1 - (P_{1,1}^{\\text{opt}} + P_{2,1}^{\\text{opt}}) = 40 - (50 + 0) = -10$.\n- $s_2 = D_2 - (P_{1,2}^{\\text{opt}} + P_{2,2}^{\\text{opt}}) = 45 - (50 + 30) = -35$.\n- $s_3 = D_3 - (P_{1,3}^{\\text{opt}} + P_{2,3}^{\\text{opt}}) = 35 - (50 + 0) = -15$.\nThe subgradient vector is $s(\\lambda^{(0)}) = [-10, -35, -15]$.\n\n**3. Perform one subgradient ascent iteration.**\nThe update rule is $\\lambda^{(1)} = \\lambda^{(0)} + \\alpha s(\\lambda^{(0)})$. With $\\alpha=0.1$:\n- $\\lambda_1^{(1)} = 18 + 0.1(-10) = 17$.\n- $\\lambda_2^{(1)} = 22 + 0.1(-35) = 18.5$.\n- $\\lambda_3^{(1)} = 16 + 0.1(-15) = 14.5$.\nThe updated multipliers are $\\lambda^{(1)} = [17, 18.5, 14.5]$.\n\n**4. Compute the improved dual bound $g(\\lambda^{(1)})$.**\nWe solve the subproblems with the new multipliers $\\lambda^{(1)}$.\n\n- For $(i,t)=(1,1)$ with $\\lambda_1=17$: $P_{1,1}^{*} = \\frac{17-12}{2(0.02)} = 125$. Since $125 > P^{\\max}_1=50$, $P_{1,1}^{\\text{opt}}=50$.\n$C_{1,1}^{\\text{on}} = 15 + 0.02(50)^2 + (12-17)(50) = 15+50-250 = -185$. Subproblem value is $-185$.\n- For $(i,t)=(2,1)$ with $\\lambda_1=17$: $P_{2,1}^{*} = \\frac{17-20}{2(0.01)} = -150$. Since $-150 < P^{\\min}_2=5$, $P_{2,1}^{\\text{opt}}=5$.\n$C_{2,1}^{\\text{on}} = 10 + 0.01(5)^2 + (20-17)(5) = 10+0.25+15 = 25.25$. Subproblem value is $\\min(0, 25.25) = 0$.\n- For $(i,t)=(1,2)$ with $\\lambda_2=18.5$: $P_{1,2}^{*} = \\frac{18.5-12}{2(0.02)} = 162.5$. Since $162.5 > P^{\\max}_1=50$, $P_{1,2}^{\\text{opt}}=50$.\n$C_{1,2}^{\\text{on}} = 15 + 0.02(50)^2 + (12-18.5)(50) = 15+50-325 = -260$. Subproblem value is $-260$.\n- For $(i,t)=(2,2)$ with $\\lambda_2=18.5$: $P_{2,2}^{*} = \\frac{18.5-20}{2(0.01)} = -75$. Since $-75 < P^{\\min}_2=5$, $P_{2,2}^{\\text{opt}}=5$.\n$C_{2,2}^{\\text{on}} = 10 + 0.01(5)^2 + (20-18.5)(5) = 10+0.25+7.5 = 17.75$. Subproblem value is $\\min(0, 17.75) = 0$.\n- For $(i,t)=(1,3)$ with $\\lambda_3=14.5$: $P_{1,3}^{*} = \\frac{14.5-12}{2(0.02)} = 62.5$. Since $62.5 > P^{\\max}_1=50$, $P_{1,3}^{\\text{opt}}=50$.\n$C_{1,3}^{\\text{on}} = 15 + 0.02(50)^2 + (12-14.5)(50) = 15+50-125 = -60$. Subproblem value is $-60$.\n- For $(i,t)=(2,3)$ with $\\lambda_3=14.5$: $P_{2,3}^{*} = \\frac{14.5-20}{2(0.01)} = -275$. Since $-275 < P^{\\min}_2=5$, $P_{2,3}^{\\text{opt}}=5$.\n$C_{2,3}^{\\text{on}} = 10 + 0.01(5)^2 + (20-14.5)(5) = 10+0.25+27.5 = 37.75$. Subproblem value is $\\min(0, 37.75) = 0$.\n\nThe sum of subproblem minimums for $\\lambda^{(1)}$ is $-185+0-260+0-60+0 = -505$.\nThe sum of $\\lambda_t D_t$ terms is $17(40) + 18.5(45) + 14.5(35) = 680 + 832.5 + 507.5 = 2020$.\n$g(\\lambda^{(1)}) = -505 + 2020 = 1515$.\n\nThe improved dual bound $g(\\lambda^{(1)})$ is $1515$ $\\mathrm{USD}$. The question requires rounding to four significant figures. The number $1515$ already has four significant figures.",
            "answer": "$$\n\\boxed{1515}\n$$"
        }
    ]
}