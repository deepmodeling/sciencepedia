{
    "hands_on_practices": [
        {
            "introduction": "Before we can assess the reliability of a power system, we must first build a probabilistic model of our total available generation. This practice guides you through the derivation and implementation of the fundamental recursive algorithm used to combine the outage probabilities of individual generators into a single system-wide capacity distribution, often called a Capacity Outage Probability Table (COPT) . Mastering this technique is essential as it forms the computational backbone of modern resource adequacy studies.",
            "id": "4102912",
            "problem": "You are given a stochastic capacity aggregation problem in energy systems modeling. Consider $n$ independent two-state generation units. For each unit $i \\in \\{1,\\dots,n\\}$, its available capacity random variable $X_i$ takes the value $s_i$ (in $\\mathrm{MW}$) with probability $a_i = 1 - q_i$ and the value $0$ with probability $q_i$, where $q_i$ is the forced outage rate. Assume all $X_i$ are mutually independent. Define the total available capacity random variable as $C = \\sum_{i=1}^n X_i$.\n\nYour tasks are as follows:\n\n- Starting only from the probability axioms (e.g., the law of total probability and independence) and the stated setup, derive a recursive algorithm that computes the probability mass function of $C$, denoted $p(c) = \\mathbb{P}(C = c)$, for all integer $c \\in \\{0,1,\\dots,S\\}$ where $S = \\sum_{i=1}^n s_i$. The units $s_i$ and the total capacity $S$ are $\\mathrm{MW}$ and are restricted to integer values.\n\n- Analyze the computational complexity of your recursive algorithm in terms of $n$ and $S$. Provide both an exact operation-count expression based on the number of elementary probability updates your recursion performs and a big-$\\mathcal{O}$ bound. Define clearly what constitutes a single elementary update.\n\n- Using the derived probability mass function $p(c)$, compute two standard adequacy metrics:\n  - Loss of Load Probability (LOLP): the expected fraction of time the available capacity is insufficient to meet the load. Given a discrete load model with load levels $L_j$ (in $\\mathrm{MW}$) and associated durations $h_j$ (in $\\mathrm{hours}$), define $w_j = h_j / H$ with $H = \\sum_j h_j$ (in $\\mathrm{hours}$) and compute $\\mathrm{LOLP} = \\sum_j w_j \\cdot \\mathbb{P}(C  L_j)$ as a decimal.\n  - Expected Unserved Energy (EUE): the expected energy shortfall over the horizon, computed as $\\mathrm{EUE} = \\sum_j h_j \\cdot \\mathbb{E}[(L_j - C)_+]$ in $\\mathrm{MWh}$, where $(x)_+ = \\max\\{x,0\\}$ and the expectation is taken with respect to the probability mass function $p(c)$.\n\nAll loads $L_j$ must be integers in $\\mathrm{MW}$ to be compatible with the discretized capacity states, and durations $h_j$ must be integers in $\\mathrm{hours}$. Express $\\mathrm{LOLP}$ as a decimal number and $\\mathrm{EUE}$ in $\\mathrm{MWh}$. When describing your complexity, use $n$ and $S$ and provide exact arithmetic update counts in integers and asymptotic bounds using big-$\\mathcal{O}$ notation.\n\nYour program must implement the derived recursive algorithm and compute, for each test case, the triplet $[\\mathrm{LOLP}, \\mathrm{EUE}, U]$, where $U$ is the exact integer count of elementary updates performed by your recursion (where a single update consists of adding a mass contribution to a probability entry). Round each floating-point metric to $6$ decimal places, and output each triplet in the order specified.\n\nTest suite:\n- Test case $1$ (general case):\n  - Units: $n = 3$, capacities $\\{s_1, s_2, s_3\\} = \\{50, 50, 30\\}$ $\\mathrm{MW}$, forced outage rates $\\{q_1, q_2, q_3\\} = \\{0.1, 0.2, 0.05\\}$, hence availabilities $\\{a_1, a_2, a_3\\} = \\{0.9, 0.8, 0.95\\}$.\n  - Load levels: $\\{L_1, L_2, L_3\\} = \\{60, 90, 120\\}$ $\\mathrm{MW}$.\n  - Durations: $\\{h_1, h_2, h_3\\} = \\{3000, 4000, 1760\\}$ $\\mathrm{hours}$, so $H = 8760$ $\\mathrm{hours}$.\n\n- Test case $2$ (boundary: always available):\n  - Units: $n = 2$, capacities $\\{s_1, s_2\\} = \\{10, 20\\}$ $\\mathrm{MW}$, forced outage rates $\\{q_1, q_2\\} = \\{0, 0\\}$, hence availabilities $\\{a_1, a_2\\} = \\{1, 1\\}$.\n  - Load levels: $\\{L_1\\} = \\{40\\}$ $\\mathrm{MW}$.\n  - Durations: $\\{h_1\\} = \\{8760\\}$ $\\mathrm{hours}$, so $H = 8760$ $\\mathrm{hours}$.\n\n- Test case $3$ (boundary: never available):\n  - Units: $n = 3$, capacities $\\{s_1, s_2, s_3\\} = \\{10, 15, 25\\}$ $\\mathrm{MW}$, forced outage rates $\\{q_1, q_2, q_3\\} = \\{1, 1, 1\\}$, hence availabilities $\\{a_1, a_2, a_3\\} = \\{0, 0, 0\\}$.\n  - Load levels: $\\{L_1, L_2, L_3\\} = \\{5, 20, 30\\}$ $\\mathrm{MW}$.\n  - Durations: $\\{h_1, h_2, h_3\\} = \\{2000, 3000, 3760\\}$ $\\mathrm{hours}$, so $H = 8760$ $\\mathrm{hours}$.\n\n- Test case $4$ (identical unit capacities and symmetric availability):\n  - Units: $n = 4$, capacities $\\{s_1, s_2, s_3, s_4\\} = \\{25, 25, 25, 25\\}$ $\\mathrm{MW}$, forced outage rates $\\{q_1, q_2, q_3, q_4\\} = \\{0.5, 0.5, 0.5, 0.5\\}$, hence availabilities $\\{a_1, a_2, a_3, a_4\\} = \\{0.5, 0.5, 0.5, 0.5\\}$.\n  - Load levels: $\\{L_1, L_2, L_3\\} = \\{30, 70, 80\\}$ $\\mathrm{MW}$.\n  - Durations: $\\{h_1, h_2, h_3\\} = \\{1000, 3000, 4760\\}$ $\\mathrm{hours}$, so $H = 8760$ $\\mathrm{hours}$.\n\nFinal output format:\n- Your program should produce a single line of output containing a comma-separated list of triplets, one per test case, enclosed in square brackets. Each triplet must itself be a comma-separated list enclosed in square brackets in the order $[\\mathrm{LOLP}, \\mathrm{EUE}, U]$. For example, an output with two test cases should look like $[[x_1,y_1,z_1],[x_2,y_2,z_2]]$, where $x_k$ and $y_k$ are floating-point numbers rounded to $6$ decimal places and $z_k$ is an integer.",
            "solution": "The problem statement poses a valid and well-defined task in the field of energy systems modeling, specifically concerning the reliability assessment of generation capacity. It is scientifically grounded in probability theory, mathematically consistent, and all necessary parameters and definitions for a unique solution are provided. It represents a standard problem of calculating a capacity outage probability table (COPT) and associated reliability metrics. I will proceed with a full solution.\n\n**1. Derivation of the Recursive Algorithm for the Probability Mass Function (PMF)**\n\nLet there be $n$ independent two-state generation units. For unit $i \\in \\{1, \\dots, n\\}$, the available capacity is a random variable $X_i$ with the following probability mass function (PMF):\n$$\n\\mathbb{P}(X_i = s_i) = a_i = 1 - q_i\n$$\n$$\n\\mathbb{P}(X_i = 0) = q_i\n$$\nwhere $s_i$ is the capacity (an integer in $\\mathrm{MW}$), $q_i$ is the forced outage rate, and $a_i$ is the availability. The total available capacity is the random variable $C = \\sum_{i=1}^n X_i$. We are asked to find the PMF of $C$, which we denote as $p(c) = \\mathbb{P}(C=c)$.\n\nWe will derive a recursive algorithm. Let $C_k = \\sum_{i=1}^k X_i$ be the cumulative capacity of the first $k$ units, and let $p_k(c) = \\mathbb{P}(C_k=c)$ be its PMF. The final PMF we seek is $p_n(c)$.\n\nThe base case for the recursion is a system with zero units. The total capacity is $C_0=0$ with probability $1$. Thus, the initial PMF is:\n$$\np_0(0) = 1, \\quad \\text{and} \\quad p_0(c) = 0 \\text{ for } c \\neq 0\n$$\n\nFor the recursive step, we want to find the PMF for $k$ units, $p_k(c)$, given the PMF for $k-1$ units, $p_{k-1}(c)$. The capacity of the first $k$ units is $C_k = C_{k-1} + X_k$. Since all units are independent, the random variable $X_k$ is independent of $C_{k-1}$. The PMF of a sum of two independent discrete random variables is the convolution of their individual PMFs.\n\nLet's apply the law of total probability, conditioning on the state of unit $k$:\n$$\np_k(c) = \\mathbb{P}(C_k = c) = \\mathbb{P}(C_{k-1} + X_k = c)\n$$\n$$\np_k(c) = \\mathbb{P}(C_{k-1} + X_k = c | X_k = 0)\\mathbb{P}(X_k=0) + \\mathbb{P}(C_{k-1} + X_k = c | X_k = s_k)\\mathbb{P}(X_k=s_k)\n$$\nSubstituting the probabilities for $X_k$:\n$$\np_k(c) = \\mathbb{P}(C_{k-1} + 0 = c) \\cdot q_k + \\mathbb{P}(C_{k-1} + s_k = c) \\cdot a_k\n$$\nThis simplifies to the core recurrence relation:\n$$\np_k(c) = \\mathbb{P}(C_{k-1} = c) \\cdot q_k + \\mathbb{P}(C_{k-1} = c - s_k) \\cdot a_k\n$$\n$$\np_k(c) = p_{k-1}(c) \\cdot q_k + p_{k-1}(c - s_k) \\cdot a_k\n$$\nIn this relation, $p_{k-1}(c-s_k)$ is taken to be $0$ if $c  s_k$ or if $c-s_k$ is not a possible capacity state for $C_{k-1}$.\n\nThis recurrence suggests an iterative algorithm. We start with the PMF for $k=0$, which is a probability mass of $1$ at capacity $0$. Then, for each unit $k=1, \\dots, n$, we construct the new PMF, $p_k$, from the previous one, $p_{k-1}$. For each existing capacity state $c'$ in the domain of $C_{k-1}$ with probability $p_{k-1}(c')$, adding unit $k$ results in two possibilities:\n1.  Unit $k$ is on outage (probability $q_k$): The new capacity is $c'$, and the probability of this path is $p_{k-1}(c') \\cdot q_k$. This mass is added to the new PMF at state $c'$.\n2.  Unit $k$ is available (probability $a_k$): The new capacity is $c' + s_k$, and the probability of this path is $p_{k-1}(c') \\cdot a_k$. This mass is added to the new PMF at state $c' + s_k$.\n\nAlgorithmically, this can be implemented by maintaining an array representing the current PMF. When adding a new unit, a temporary array is used to build the new PMF to avoid corrupting the current one during calculation.\n\n**2. Computational Complexity Analysis**\n\nLet $S = \\sum_{i=1}^n s_i$ be the total installed capacity. The PMF will be stored in an array of size $S+1$.\n\nAn elementary update is defined as \"adding a mass contribution to a probability entry.\" In our recursive algorithm, for each non-zero probability state $p_{k-1}(c')0$, we perform two such updates to construct $p_k$: one for the outage case and one for the available case.\n\nLet $\\mathcal{C}_{k-1}$ be the set of all capacity values $c'$ for which $p_{k-1}(c')  0$. The number of elementary updates required to compute $p_k$ from $p_{k-1}$ is precisely $2 \\cdot |\\mathcal{C}_{k-1}|$, where $|\\cdot|$ denotes the cardinality of the set.\n\nThe total number of elementary updates, $U$, for computing the final PMF $p_n$ is the sum over all steps $k=1, \\dots, n$:\n$$\nU = \\sum_{k=1}^{n} 2 \\cdot |\\mathcal{C}_{k-1}|\n$$\nwhere $\\mathcal{C}_0 = \\{0\\}$, so $|\\mathcal{C}_0| = 1$. This is the exact operation-count expression.\n\nFor the asymptotic big-$\\mathcal{O}$ bound, let $S_k = \\sum_{i=1}^k s_i$. The number of possible capacity states after adding $k$ units, $|\\mathcal{C}_k|$, is at most $S_k+1$. Since $S_k \\le S$ for all $k$, we have $|\\mathcal{C}_{k-1}| \\le S_{k-1}+1 \\le S+1$.\n\nThe total number of operations is bounded by the complexity of the loops in the implementation. A standard implementation iterates through $n$ units. For each unit $k$, it iterates through all possible capacity levels of $C_{k-1}$, which is at most $S_{k-1}+1$ states. The maximum possible capacity is $S$. Therefore, the inner loop runs at most $S+1$ times. The outer loop runs $n$ times. The complexity is thus:\n$$\n\\mathcal{O}(n \\cdot S)\n$$\n\n**3. Adequacy Metrics**\n\nGiven the final PMF, $p(c) = p_n(c)$, for $c \\in \\{0, 1, \\dots, S\\}$, we compute the reliability metrics.\n\n**Loss of Load Probability (LOLP):**\nLOLP is the expected fraction of time that capacity is less than load. With a discrete load model ($L_j, h_j$), the formula is $\\mathrm{LOLP} = \\sum_j w_j \\cdot \\mathbb{P}(C  L_j)$, where $w_j = h_j / H$ and $H = \\sum_j h_j$.\n\nThe probability term $\\mathbb{P}(C  L_j)$ can be computed from the PMF $p(c)$:\n$$\n\\mathbb{P}(C  L_j) = \\sum_{c=0}^{L_j - 1} p(c)\n$$\nThis is the value of the cumulative distribution function (CDF) at $L_j-1$. Let $F_C(x) = \\mathbb{P}(C \\le x)$. Then $\\mathbb{P}(C  L_j) = F_C(L_j - 1)$.\n\n**Expected Unserved Energy (EUE):**\nEUE is the expected total energy not supplied over the period. The formula is $\\mathrm{EUE} = \\sum_j h_j \\cdot \\mathbb{E}[(L_j - C)_+]$. The term $(x)_+ = \\max\\{x,0\\}$ represents the energy shortfall.\n\nThe expectation $\\mathbb{E}[(L_j - C)_+]$ is calculated over the distribution of $C$:\n$$\n\\mathbb{E}[(L_j - C)_+] = \\sum_{c=0}^{S} (L_j - c)_+ \\cdot p(c) = \\sum_{c=0}^{L_j-1} (L_j - c) \\cdot p(c)\n$$\nThe sum stops at $L_j-1$ because for $c \\ge L_j$, the shortfall $(L_j - c)_+$ is zero.\n\nThe total EUE is then the sum of these expected shortfalls, each weighted by its duration $h_j$:\n$$\n\\mathrm{EUE} = \\sum_j h_j \\left( \\sum_{c=0}^{L_j-1} (L_j - c) \\cdot p(c) \\right)\n$$\nBoth metrics can be computed directly once the PMF $p(c)$ is known.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the energy system reliability problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Test case 1 (general case)\n        {\n            \"units\": {\"s\": [50, 50, 30], \"q\": [0.1, 0.2, 0.05]},\n            \"load\": {\"L\": [60, 90, 120], \"h\": [3000, 4000, 1760]},\n        },\n        # Test case 2 (boundary: always available)\n        {\n            \"units\": {\"s\": [10, 20], \"q\": [0.0, 0.0]},\n            \"load\": {\"L\": [40], \"h\": [8760]},\n        },\n        # Test case 3 (boundary: never available)\n        {\n            \"units\": {\"s\": [10, 15, 25], \"q\": [1.0, 1.0, 1.0]},\n            \"load\": {\"L\": [5, 20, 30], \"h\": [2000, 3000, 3760]},\n        },\n        # Test case 4 (identical unit capacities and symmetric availability)\n        {\n            \"units\": {\"s\": [25, 25, 25, 25], \"q\": [0.5, 0.5, 0.5, 0.5]},\n            \"load\": {\"L\": [30, 70, 80], \"h\": [1000, 3000, 4760]},\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        s_values = case[\"units\"][\"s\"]\n        q_values = case[\"units\"][\"q\"]\n        units = list(zip(s_values, q_values))\n        \n        load_levels = case[\"load\"][\"L\"]\n        durations = case[\"load\"][\"h\"]\n        \n        # 1. Compute PMF and update count\n        pmf, update_count = calculate_pmf_and_updates(units)\n        \n        # 2. Compute LOLP and EUE\n        lolp, eue = calculate_metrics(pmf, load_levels, durations)\n        \n        # 3. Store results\n        result_triplet = [\n            round(lolp, 6),\n            round(eue, 6),\n            update_count\n        ]\n        all_results.append(result_triplet)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, all_results))}]\".replace(\" \", \"\"))\n\ndef calculate_pmf_and_updates(units):\n    \"\"\"\n    Calculates the Probability Mass Function (PMF) of total available capacity\n    using a recursive algorithm and counts the elementary updates.\n\n    An elementary update is one addition of a probability mass contribution.\n    \"\"\"\n    total_capacity = sum(u[0] for u in units)\n    pmf = np.zeros(total_capacity + 1, dtype=np.float64)\n    pmf[0] = 1.0\n    \n    update_count = 0\n    current_max_cap = 0\n\n    for s, q in units:\n        a = 1.0 - q\n        \n        # Store the previous PMF to build the new one\n        pmf_prev = pmf.copy()\n        \n        # To count updates precisely, we iterate over non-zero states\n        # in the previous PMF.\n        non_zero_indices = np.where(pmf_prev[:current_max_cap + 1] > 0)[0]\n        \n        # Count updates for all non-zero source states\n        # Each source state generates two contributions to the new PMF.\n        update_count += 2 * len(non_zero_indices)\n        \n        # This implementation uses a backward iteration to update in place\n        # It's more memory efficient than using a temporary array.\n        # The logic for counting updates remains based on the conceptual model.\n        for c in range(current_max_cap, -1, -1):\n            if pmf[c] > 0:\n                prob_at_c = pmf[c]\n                # Contribution to state c + s (unit available)\n                pmf[c + s] += prob_at_c * a\n                # Update state c (unit on outage)\n                pmf[c] = prob_at_c * q\n        \n        current_max_cap += s\n\n    return pmf, update_count\n\ndef calculate_metrics(pmf, load_levels, durations):\n    \"\"\"\n    Computes LOLP and EUE using the final capacity PMF.\n    \"\"\"\n    S_total = len(pmf) - 1\n    total_hours = sum(durations)\n    \n    # Calculate Cumulative Distribution Function (CDF)\n    cdf = np.cumsum(pmf)\n    \n    # --- LOLP Calculation ---\n    lolp = 0.0\n    for L, h in zip(load_levels, durations):\n        w = h / total_hours\n        prob_shortfall = 0.0\n        if L > 0:\n            index = L - 1\n            if index  len(cdf):\n                prob_shortfall = cdf[index]\n            else: # Load is greater than max possible capacity\n                prob_shortfall = 1.0\n        lolp += w * prob_shortfall\n        \n    # --- EUE Calculation ---\n    eue = 0.0\n    capacities = np.arange(S_total + 1)\n    for L, h in zip(load_levels, durations):\n        # Calculate expected energy shortfall for this load level\n        # E[(L-C)+] = sum_{c=0}^{L-1} (L-c) * P(C=c)\n        limit = min(L, S_total + 1)\n        indices = np.arange(limit)\n        \n        shortfalls = L - capacities[indices]\n        probs = pmf[indices]\n        \n        expected_shortfall = np.sum(shortfalls * probs)\n        eue += h * expected_shortfall\n        \n    return lolp, eue\n\nsolve()\n```"
        },
        {
            "introduction": "Once a probabilistic model of available capacity is established, the next step is to evaluate its performance against the system's anticipated demand. This exercise provides a concrete scenario with a load duration curve and a capacity probability distribution, challenging you to calculate the two primary adequacy metrics: Loss of Load Expectation ($LOLE$) and Expected Unserved Energy ($EUE$) . This practice will solidify your understanding of how these metrics are computed from their formal definitions and how they relate system supply to demand.",
            "id": "4119469",
            "problem": "A vertically integrated utility evaluates adequacy over a one-year horizon of $T=8760$ hours. The system load is represented by a stepwise load duration curve: the highest $h_{1}=100$ hours have load $L_{1}=1300$ megawatts, the next $h_{2}=600$ hours have load $L_{2}=1200$ megawatts, the next $h_{3}=1500$ hours have load $L_{3}=1000$ megawatts, the next $h_{4}=3000$ hours have load $L_{4}=800$ megawatts, and the remaining $h_{5}=3560$ hours have load $L_{5}=600$ megawatts. Available capacity is modeled as a discrete random variable $C$ (in megawatts) with the following probability mass function, assumed stationary across the year and independent of the load-rank: $\\mathbb{P}\\{C=1400\\}=0.88$, $\\mathbb{P}\\{C=1200\\}=0.08$, $\\mathbb{P}\\{C=1000\\}=0.03$, $\\mathbb{P}\\{C=800\\}=0.008$, $\\mathbb{P}\\{C=600\\}=0.002$. Assume that meeting load exactly, that is $C=L$, incurs no shortfall.\n\nStarting only from the formal definitions of Loss of Load Expectation (LOLE) as the expected number of hours in which load exceeds available capacity over the horizon, and Expected Unserved Energy (EUE) as the expected total energy not served over the horizon, compute both metrics for this system under the given assumptions. Express LOLE in hours and EUE in megawatt-hours (MWh). Round both quantities to four significant figures. Then, based on your computed values, articulate the planning implications if the two metrics convey different emphases about the nature of risk.",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary data for a complete analysis. The total duration of the load blocks sums to $100+600+1500+3000+3560=8760$ hours, which matches the yearly horizon $T$. The probabilities of the available capacity states sum to $0.88+0.08+0.03+0.008+0.002=1.00$, forming a valid probability mass function. We may therefore proceed with the solution.\n\nThe problem requires the computation of two fundamental resource adequacy metrics: Loss of Load Expectation (LOLE) and Expected Unserved Energy (EUE).\n\nLet $L$ be the system load and $C$ be the available capacity, both measured in megawatts (MW). A shortfall event occurs if $L > C$. The problem states that if $C=L$, no shortfall is incurred.\n\nThe load is not constant but varies over time. The problem provides a load duration curve (LDC), which gives the number of hours, $h_i$, for which the load is at a certain level, $L_i$. The total time horizon is $T = \\sum_i h_i$. The available capacity $C$ is a random variable, independent of the load level, with a given probability mass function $\\mathbb{P}\\{C=c_k\\}$.\n\n**1. Calculation of Loss of Load Expectation (LOLE)**\n\nLOLE is formally defined as the expected number of hours within the time horizon $T$ during which the load $L$ exceeds the available capacity $C$.\nLet $I(L(t) > C)$ be an indicator function that is $1$ if $L(t) > C$ at hour $t$ and $0$ otherwise. Then,\n$$\n\\text{LOLE} = \\mathbb{E}\\left[\\int_{0}^{T} I(L(t) > C) \\,dt\\right]\n$$\nGiven the stepwise LDC, we can discretize this integral. For each load block $i$ with duration $h_i$ and load level $L_i$, the expected number of hours of shortfall is the duration of that block multiplied by the probability of a shortfall during that block. The probability of a shortfall at load level $L_i$ is the Loss of Load Probability, $LOLP(L_i) = \\mathbb{P}\\{C  L_i\\}$. Since the capacity state is independent for each hour, the total LOLE is the sum of the expected loss of load hours over all load blocks.\n$$\n\\text{LOLE} = \\sum_{i=1}^{5} h_i \\cdot \\mathbb{P}\\{C  L_i\\}\n$$\nWe first compute the probability of shortfall for each load level $L_i$:\nThe available capacity states are $c \\in \\{1400, 1200, 1000, 800, 600\\}$.\n\nFor load block 1: $L_1 = 1300$ MW. A shortfall occurs if $C  1300$ MW.\n$$\n\\mathbb{P}\\{C  1300\\} = \\mathbb{P}\\{C=1200\\} + \\mathbb{P}\\{C=1000\\} + \\mathbb{P}\\{C=800\\} + \\mathbb{P}\\{C=600\\}\n$$\n$$\n\\mathbb{P}\\{C  1300\\} = 0.08 + 0.03 + 0.008 + 0.002 = 0.12\n$$\nFor load block 2: $L_2 = 1200$ MW. A shortfall occurs if $C  1200$ MW.\n$$\n\\mathbb{P}\\{C  1200\\} = \\mathbb{P}\\{C=1000\\} + \\mathbb{P}\\{C=800\\} + \\mathbb{P}\\{C=600\\}\n$$\n$$\n\\mathbb{P}\\{C  1200\\} = 0.03 + 0.008 + 0.002 = 0.04\n$$\nFor load block 3: $L_3 = 1000$ MW. A shortfall occurs if $C  1000$ MW.\n$$\n\\mathbb{P}\\{C  1000\\} = \\mathbb{P}\\{C=800\\} + \\mathbb{P}\\{C=600\\}\n$$\n$$\n\\mathbb{P}\\{C  1000\\} = 0.008 + 0.002 = 0.01\n$$\nFor load block 4: $L_4 = 800$ MW. A shortfall occurs if $C  800$ MW.\n$$\n\\mathbb{P}\\{C  800\\} = \\mathbb{P}\\{C=600\\} = 0.002\n$$\nFor load block 5: $L_5 = 600$ MW. A shortfall occurs if $C  600$ MW. There are no capacity states below $600$ MW.\n$$\n\\mathbb{P}\\{C  600\\} = 0\n$$\nNow we can compute the total LOLE:\n$$\n\\text{LOLE} = (h_1 \\cdot \\mathbb{P}\\{C  L_1\\}) + (h_2 \\cdot \\mathbb{P}\\{C  L_2\\}) + (h_3 \\cdot \\mathbb{P}\\{C  L_3\\}) + (h_4 \\cdot \\mathbb{P}\\{C  L_4\\}) + (h_5 \\cdot \\mathbb{P}\\{C  L_5\\})\n$$\n$$\n\\text{LOLE} = (100 \\, \\text{hr} \\cdot 0.12) + (600 \\, \\text{hr} \\cdot 0.04) + (1500 \\, \\text{hr} \\cdot 0.01) + (3000 \\, \\text{hr} \\cdot 0.002) + (3560 \\, \\text{hr} \\cdot 0)\n$$\n$$\n\\text{LOLE} = 12 \\, \\text{hr} + 24 \\, \\text{hr} + 15 \\, \\text{hr} + 6 \\, \\text{hr} + 0 \\, \\text{hr} = 57 \\, \\text{hr}\n$$\nRounding to four significant figures, LOLE is $57.00$ hours.\n\n**2. Calculation of Expected Unserved Energy (EUE)**\n\nEUE is the expected total energy not served over the horizon $T$. The unserved power at any moment is given by the random variable $\\max(0, L - C)$.\n$$\n\\text{EUE} = \\mathbb{E}\\left[\\int_{0}^{T} \\max(0, L(t) - C) \\,dt\\right]\n$$\nUsing the stepwise LDC, this becomes the sum of the expected unserved energy for each load block. For a given block $i$, the expected unserved power is $\\mathbb{E}[\\max(0, L_i - C)]$. The expected unserved energy for this block is $h_i \\cdot \\mathbb{E}[\\max(0, L_i - C)]$.\n$$\n\\text{EUE} = \\sum_{i=1}^{5} h_i \\cdot \\mathbb{E}[\\max(0, L_i - C)]\n$$\nThe expectation $\\mathbb{E}[\\max(0, L_i - C)]$ is computed by summing over the discrete capacity states $c_k$:\n$$\n\\mathbb{E}[\\max(0, L_i - C)] = \\sum_{k} \\max(0, L_i - c_k) \\cdot \\mathbb{P}\\{C=c_k\\} = \\sum_{k: c_k  L_i} (L_i - c_k) \\cdot \\mathbb{P}\\{C=c_k\\}\n$$\nWe compute this for each load block:\n\nFor load block 1 ($L_1 = 1300$ MW):\n$$\n\\mathbb{E}[\\max(0, 1300-C)] = (1300-1200)(0.08) + (1300-1000)(0.03) + (1300-800)(0.008) + (1300-600)(0.002)\n$$\n$$\n= (100)(0.08) + (300)(0.03) + (500)(0.008) + (700)(0.002) = 8 + 9 + 4 + 1.4 = 22.4 \\, \\text{MW}\n$$\nFor load block 2 ($L_2 = 1200$ MW):\n$$\n\\mathbb{E}[\\max(0, 1200-C)] = (1200-1000)(0.03) + (1200-800)(0.008) + (1200-600)(0.002)\n$$\n$$\n= (200)(0.03) + (400)(0.008) + (600)(0.002) = 6 + 3.2 + 1.2 = 10.4 \\, \\text{MW}\n$$\nFor load block 3 ($L_3 = 1000$ MW):\n$$\n\\mathbb{E}[\\max(0, 1000-C)] = (1000-800)(0.008) + (1000-600)(0.002)\n$$\n$$\n= (200)(0.008) + (400)(0.002) = 1.6 + 0.8 = 2.4 \\, \\text{MW}\n$$\nFor load block 4 ($L_4 = 800$ MW):\n$$\n\\mathbb{E}[\\max(0, 800-C)] = (800-600)(0.002) = (200)(0.002) = 0.4 \\, \\text{MW}\n$$\nFor load block 5 ($L_5 = 600$ MW): The shortfall is always zero since no capacity state is below $600$ MW.\n$$\n\\mathbb{E}[\\max(0, 600-C)] = 0 \\, \\text{MW}\n$$\nNow we can compute the total EUE:\n$$\n\\text{EUE} = (100 \\, \\text{hr} \\cdot 22.4 \\, \\text{MW}) + (600 \\, \\text{hr} \\cdot 10.4 \\, \\text{MW}) + (1500 \\, \\text{hr} \\cdot 2.4 \\, \\text{MW}) + (3000 \\, \\text{hr} \\cdot 0.4 \\, \\text{MW}) + (3560 \\, \\text{hr} \\cdot 0)\n$$\n$$\n\\text{EUE} = 2240 \\, \\text{MWh} + 6240 \\, \\text{MWh} + 3600 \\, \\text{MWh} + 1200 \\, \\text{MWh} + 0 \\, \\text{MWh}\n$$\n$$\n\\text{EUE} = 13280 \\, \\text{MWh}\n$$\nThis value has four significant figures.\n\n**3. Articulation of Planning Implications**\n\nThe computed metrics are $\\text{LOLE} \\approx 57.00$ hours/year and $\\text{EUE} = 13280$ MWh/year. These two metrics, while related, emphasize different aspects of system reliability risk.\n\nLOLE measures the *frequency* of reliability events. A value of $57$ hours per year is extremely high compared to typical industry targets (e.g., $0.1$ days/year, or $2.4$ hours/year). This indicates that the system is expected to experience capacity shortfalls frequently. A planner focusing solely on LOLE would conclude that the system is chronically unreliable and would prioritize investments that reduce the number of shortfall hours, regardless of their magnitude. This might include improving generator availability or adding small but highly reliable peaking units.\n\nEUE measures the expected *volume* of energy not served, which combines the frequency, duration, and magnitude of shortfalls. It is a measure of the total impact of unreliability. A high EUE indicates that the sum of all shortfalls, large and small, is significant. In this problem, the largest contribution to LOLE comes from the second-highest load block ($24$ hours), not the peak load block ($12$ hours). Similarly, the largest contribution to EUE also comes from this second block ($6240$ MWh), which is more than double the contribution from the peak block ($2240$ MWh).\n\nThe different emphases are clear:\n- The high LOLE signals that shortfalls are a common occurrence. The system frequently lacks a sufficient capacity margin.\n- The EUE analysis reveals that the most significant risk, in terms of unserved energy, is not from the very few peak load hours but from the more numerous hours of high, sustained load ($L_2=1200$ MW for $h_2=600$ hours). During these periods, the conditional expected shortfall size is larger than during peak hours, and these events occur for a longer total duration.\n\n**Planning Implications:**\nIf a planner were to focus only on LOLE, they might misdiagnose the primary driver of risk. For instance, they might focus on adding a small amount of capacity a `\"peaker plant\"` dedicated to serving the absolute peak load $L_1$. This would reduce LOLE but might have a smaller impact on EUE.\n\nThe EUE result, however, suggests a more systemic capacity shortage. The largest risk contributor is a load level that persists for $600$ hours. This implies that the solution should not be narrowly targeted at just the top a few peak hours. Instead, a more robust solution is needed, such as adding a larger block of reliable capacity (a baseload or mid-merit plant) or implementing demand response programs that can be activated for extended durations to lower the load plateau represented by $L_2$. Thus, EUE provides a more nuanced view of risk that accounts for the severity of outages, guiding planners toward investments that more effectively mitigate the overall impact of unserved energy, not just the frequency of its occurrence. In this case, both metrics indicate poor reliability, but EUE better characterizes the nature and source of the risk, pointing to a need for more substantial, rather than merely peak-shaving, resource additions.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n57.00  13280\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Adequacy metrics are not just abstract numbers; they tell a story about the nature of a system's risk profile. This exercise explores a crucial concept through a thought experiment involving two systems with identical total expected unserved energy ($EUE$) but vastly different failure frequencies ($LOLE$) . By analyzing this hypothetical case, you will gain a deeper appreciation for how these metrics capture different dimensions of reliability—frequency versus magnitude—and understand why considering both is critical for making informed and robust planning decisions.",
            "id": "4102894",
            "problem": "An electric power system planner evaluates resource adequacy over a horizon of one calendar year with $8760$ hours. For each hour $t \\in \\{1,\\dots,8760\\}$, define the random variable $\\Delta_t \\ge 0$ as the unserved energy in that hour, measured in megawatt-hours (MWh). Assume $\\{\\Delta_t\\}_{t=1}^{8760}$ are independent and identically distributed across hours for a given system.\n\nTwo candidate systems, System A and System B, differ only in the probabilistic distribution of hourly unserved energy. In both systems, the hourly unserved energy is a two-part mixture: with some probability there is a shortfall whose magnitude is a continuous random variable, and with the complementary probability there is no shortfall. Specifically:\n\n- System A: In any hour, with probability $q_A = 0.02$ there is a shortfall and the conditional shortfall magnitude is distributed exponentially with mean $s_A = 10$ MWh; otherwise, with probability $1 - q_A$, $\\Delta_t = 0$ MWh.\n- System B: In any hour, with probability $q_B = 0.005$ there is a shortfall and the conditional shortfall magnitude is distributed exponentially with mean $s_B = 40$ MWh; otherwise, with probability $1 - q_B$, $\\Delta_t = 0$ MWh.\n\nStarting from the foundational definitions that (i) Loss of Load Expectation (LOLE) is the expected number of hours in the year in which $\\Delta_t > 0$, and (ii) Expected Unserved Energy (EUE) is the expected total unserved energy over the year, derive expressions for the LOLE and EUE of each system. Show explicitly whether the two systems can have identical EUE while having different LOLE, and explain in words how the shapes of the hourly deficit distributions lead to this outcome.\n\nCompute the annual LOLE (in hours/year) for each system and the common EUE (in MWh/year) if it exists. Report only the common EUE as your final numeric answer. Round your final answer to four significant figures. Express the final energy in MWh/year.",
            "solution": "The problem statement is evaluated and found to be valid. It is scientifically grounded in the principles of probability theory and power system reliability analysis, is well-posed with all necessary information provided, and is expressed in objective, unambiguous language. We may therefore proceed with the solution.\n\nLet the time horizon be $T = 8760$ hours. For each hour $t \\in \\{1,\\dots,T\\}$, the unserved energy is a random variable $\\Delta_t$. The set of random variables $\\{\\Delta_t\\}_{t=1}^{T}$ is assumed to be independent and identically distributed (i.i.d.).\n\nFor any given hour, let us define an indicator random variable, $I_t$, such that $I_t = 1$ if a shortfall occurs ($\\Delta_t > 0$) and $I_t = 0$ if no shortfall occurs ($\\Delta_t = 0$). From the problem statement, $I_t$ follows a Bernoulli distribution. The probability of a shortfall is $P(I_t=1) = q$, and the probability of no shortfall is $P(I_t=0) = 1-q$.\n\nThe magnitude of the unserved energy, $\\Delta_t$, is described by a mixture model. If $I_t=0$, then $\\Delta_t=0$. If $I_t=1$, the conditional magnitude of the shortfall follows an exponential distribution with a mean of $s$.\n\nFirst, we derive the general expression for Loss of Load Expectation (LOLE). LOLE is defined as the expected number of hours in the year with a shortfall. Let $N$ be the total number of hours with a shortfall over the year. Then $N = \\sum_{t=1}^{T} I_t$.\nThe LOLE is the expectation of $N$:\n$$ \\text{LOLE} = E[N] = E\\left[\\sum_{t=1}^{T} I_t\\right] $$\nBy the linearity of expectation,\n$$ \\text{LOLE} = \\sum_{t=1}^{T} E[I_t] $$\nFor a Bernoulli random variable $I_t$, the expectation is $E[I_t] = 1 \\cdot P(I_t=1) + 0 \\cdot P(I_t=0) = q$. Since the hours are i.i.d., $q$ is constant for all $t$.\n$$ \\text{LOLE} = \\sum_{t=1}^{T} q = T \\cdot q $$\n\nNext, we derive the general expression for Expected Unserved Energy (EUE). EUE is the expected total unserved energy over the year. Let $U$ be the total unserved energy. Then $U = \\sum_{t=1}^{T} \\Delta_t$.\nThe EUE is the expectation of $U$:\n$$ \\text{EUE} = E[U] = E\\left[\\sum_{t=1}^{T} \\Delta_t\\right] $$\nBy the linearity of expectation, and since the distributions are identical for all $t$,\n$$ \\text{EUE} = \\sum_{t=1}^{T} E[\\Delta_t] = T \\cdot E[\\Delta_1] $$\nWe compute the expectation of the hourly unserved energy, $E[\\Delta_t]$, using the law of total expectation, conditioned on the indicator variable $I_t$:\n$$ E[\\Delta_t] = E[\\Delta_t | I_t=1] P(I_t=1) + E[\\Delta_t | I_t=0] P(I_t=0) $$\nFrom the problem statement, we have:\n- $P(I_t=1) = q$.\n- $P(I_t=0) = 1-q$.\n- $E[\\Delta_t | I_t=1] = s$, the mean of the conditional exponential distribution.\n- $E[\\Delta_t | I_t=0] = 0$, as there is no unserved energy when there is no shortfall.\nSubstituting these into the equation for $E[\\Delta_t]$:\n$$ E[\\Delta_t] = s \\cdot q + 0 \\cdot (1-q) = s \\cdot q $$\nTherefore, the general expression for EUE is:\n$$ \\text{EUE} = T \\cdot s \\cdot q $$\n\nNow, we apply these derived formulas to System A and System B.\nFor System A:\n- Probability of shortfall: $q_A = 0.02$.\n- Mean conditional shortfall: $s_A = 10$ MWh.\nThe LOLE for System A is:\n$$ \\text{LOLE}_A = T \\cdot q_A = 8760 \\cdot 0.02 = 175.2 \\text{ hours/year} $$\nThe EUE for System A is:\n$$ \\text{EUE}_A = T \\cdot s_A \\cdot q_A = 8760 \\cdot 10 \\cdot 0.02 = 8760 \\cdot 0.2 = 1752 \\text{ MWh/year} $$\n\nFor System B:\n- Probability of shortfall: $q_B = 0.005$.\n- Mean conditional shortfall: $s_B = 40$ MWh.\nThe LOLE for System B is:\n$$ \\text{LOLE}_B = T \\cdot q_B = 8760 \\cdot 0.005 = 43.8 \\text{ hours/year} $$\nThe EUE for System B is:\n$$ \\text{EUE}_B = T \\cdot s_B \\cdot q_B = 8760 \\cdot 40 \\cdot 0.005 = 8760 \\cdot 0.2 = 1752 \\text{ MWh/year} $$\n\nWe can now explicitly show whether the two systems can have identical EUE while having different LOLE.\nComparing the EUE values:\n$$ \\text{EUE}_A = 1752 \\text{ MWh/year} $$\n$$ \\text{EUE}_B = 1752 \\text{ MWh/year} $$\nThus, $\\text{EUE}_A = \\text{EUE}_B$. The two systems do have identical EUE.\n\nComparing the LOLE values:\n$$ \\text{LOLE}_A = 175.2 \\text{ hours/year} $$\n$$ \\text{LOLE}_B = 43.8 \\text{ hours/year} $$\nThus, $\\text{LOLE}_A \\neq \\text{LOLE}_B$. The two systems have different LOLE.\n\nThe reason for this outcome lies in the definitions of LOLE and EUE and the parameters of the hourly deficit distributions.\n- LOLE is a measure of the frequency of service interruptions. Its formula, $\\text{LOLE} = T \\cdot q$, shows it is directly proportional to the probability of a shortfall, $q$, and is completely insensitive to the magnitude, $s$, of that shortfall.\n- EUE is a measure of the total volume of unserved energy. Its formula, $\\text{EUE} = T \\cdot q \\cdot s$, shows it depends on the product of the shortfall probability, $q$, and the mean shortfall magnitude, $s$.\n\nSystem A is characterized by relatively frequent but small shortfalls ($q_A = 0.02$, $s_A = 10$ MWh).\nSystem B is characterized by relatively infrequent but large shortfalls ($q_B = 0.005$, $s_B = 40$ MWh).\n\nThe problem is structured such that the product of frequency and magnitude is identical for both systems:\n$$ q_A s_A = 0.02 \\cdot 10 = 0.2 $$\n$$ q_B s_B = 0.005 \\cdot 40 = 0.2 $$\nSince $\\text{EUE} \\propto q \\cdot s$, and this product is the same for both systems, their annual EUE values are identical.\nHowever, since $\\text{LOLE} \\propto q$, and $q_A = 4 \\cdot q_B$, System A has an LOLE that is four times larger than that of System B, reflecting its higher frequency of shortfall events.\n\nIn essence, the shape of the hourly deficit distribution for System A involves a higher probability mass on smaller, non-zero deficit values, while System B's distribution has a lower probability mass concentrated on larger deficit values. This trade-off between frequency and magnitude allows for the EUE to be held constant while the LOLE varies. This illustrates a fundamental concept in reliability planning: systems with the same total expected energy shortfall can present very different risk profiles in terms of how often customers experience outages.\n\nThe problem asks for the common EUE, which we have calculated as $1752$ MWh/year. The problem also asks to round this value to four significant figures. The number $1752$ already has exactly four significant figures ($1, 7, 5, 2$), so no rounding is necessary.\nThe common EUE is $1752$ MWh/year.",
            "answer": "$$\\boxed{1752}$$"
        }
    ]
}