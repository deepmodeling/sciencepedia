{
    "hands_on_practices": [
        {
            "introduction": "本章的第一个练习将带你回到可用性的核心定义。你将通过计算来对比两种不同的可用性指标：一种是基于平均无故障时间（$MTBF$）和平均修复时间（$MTTR$）等长期可靠性参数推导出的理论稳态可用性，另一种是根据有限时间段内的运行记录计算出的经验可用性。通过这项练习，你将深刻理解理论预期与特定时期内实际测量值之间的重要区别。",
            "id": "4070894",
            "problem": "电力系统中的单个发电机组被建模为一个在运行状态和维修状态之间交替的更新过程。在多个周期中，测得的平均无故障时间 (MTBF) 为 $2000\\,\\mathrm{h}$，平均修复时间 (MTTR) 为 $50\\,\\mathrm{h}$。另外，在一个 $20{,}000\\,\\mathrm{h}$ 的时间范围内，汇总的时间序列记录报告总正常运行时间 $T_{\\text{up}}=18{,}900\\,\\mathrm{h}$ 和总停机时间 $T_{\\text{down}}=1{,}100\\,\\mathrm{h}$。\n\n仅使用可用率作为处于运行状态的长期时间分数的基本定义以及更新过程的适当极限论证，推导由 $MTBF$ 和 $MTTR$ 蕴含的稳态可用率，以及由时间序列 $\\{T_{\\text{up}},T_{\\text{down}}\\}$ 蕴含的经验可用率。计算这两个可用率指标之间的绝对差值并报告该差值。\n\n将最终数值结果四舍五入至四位有效数字。将最终答案表示为一个无量纲的小数（不要使用百分号）。",
            "solution": "首先对问题进行验证，以确保其科学性、自洽性和良构性。给定的参数是平均无故障时间 ($MTBF = 2000\\,\\mathrm{h}$)、平均修复时间 ($MTTR = 50\\,\\mathrm{h}$)，以及在 $20{,}000\\,\\mathrm{h}$ 的时间范围内的总正常运行时间 ($T_{\\text{up}} = 18{,}900\\,\\mathrm{h}$) 和总停机时间 ($T_{\\text{down}} = 1{,}100\\,\\mathrm{h}$)。总和 $T_{\\text{up}} + T_{\\text{down}} = 18{,}900\\,\\mathrm{h} + 1{,}100\\,\\mathrm{h} = 20{,}000\\,\\mathrm{h}$ 与所述的总时间范围一致。可用率、MTBF 和 MTTR 的概念是可靠性工程中的基本概念。因此，该问题是有效的。\n\n任务是计算两种不同可用率度量之间的绝对差值：一种是从更新过程参数（$MTBF$ 和 $MTTR$）推导出的理论稳态可用率，另一种是从时间序列数据（$T_{\\text{up}}$ 和 $T_{\\text{down}}$）测得的经验可用率。\n\n首先，我们推导稳态可用率，记为 $A_{\\text{ss}}$。对于一个在运行状态和维修状态之间交替的系统，稳态可用率是系统处于运行状态的长期概率。它由运行状态的平均持续时间 ($MTBF$) 与一个完整周期（运行+维修）的平均持续时间之比给出。\n平均周期时间为 $MTBF + MTTR$。\n稳态可用率的公式为：\n$$A_{\\text{ss}} = \\frac{MTBF}{MTBF + MTTR}$$\n代入给定值：\n$$A_{\\text{ss}} = \\frac{2000}{2000 + 50} = \\frac{2000}{2050} = \\frac{40}{41}$$\n\n接下来，我们推导经验可用率，记为 $A_{\\text{emp}}$。这是根据有限观测期内的汇总时间序列数据计算得出的。它是设备运行的总时间 ($T_{\\text{up}}$) 与总观测期 ($T_{\\text{total}}$) 之比。\n总观测期是正常运行时间和停机时间之和：\n$$T_{\\text{total}} = T_{\\text{up}} + T_{\\text{down}} = 18{,}900\\,\\mathrm{h} + 1{,}100\\,\\mathrm{h} = 20{,}000\\,\\mathrm{h}$$\n经验可用率的公式为：\n$$A_{\\text{emp}} = \\frac{T_{\\text{up}}}{T_{\\text{total}}}$$\n代入给定值：\n$$A_{\\text{emp}} = \\frac{18{,}900}{20{,}000} = \\frac{189}{200}$$\n\n问题要求计算这两个可用率指标之间的绝对差值 $\\Delta A$。\n$$\\Delta A = |A_{\\text{ss}} - A_{\\text{emp}}|$$\n代入 $A_{\\text{ss}}$ 和 $A_{\\text{emp}}$ 的推导表达式：\n$$\\Delta A = \\left| \\frac{40}{41} - \\frac{189}{200} \\right|$$\n为了进行分数减法，我们找到一个公分母，即 $41 \\times 200 = 8200$。\n$$\\Delta A = \\left| \\frac{40 \\times 200}{41 \\times 200} - \\frac{189 \\times 41}{200 \\times 41} \\right| = \\left| \\frac{8000}{8200} - \\frac{7749}{8200} \\right|$$\n进行分子上的减法运算：\n$$\\Delta A = \\left| \\frac{8000 - 7749}{8200} \\right| = \\frac{251}{8200}$$\n\n最后，我们计算 $\\Delta A$ 的数值，并按要求将其四舍五入至四位有效数字。\n$$\\Delta A = \\frac{251}{8200} \\approx 0.030609756...$$\n为了四舍五入到四位有效数字，我们从第一个非零数字开始看。第一位有效数字是 $3$。随后的三位数字是 $0$、$6$ 和 $0$。第五位有效数字是 $9$。由于 $9 \\ge 5$，我们将第四位有效数字（$0$）向上取整为 $1$。\n因此，四舍五入后的值为 $0.03061$。",
            "answer": "$$\\boxed{0.03061}$$"
        },
        {
            "introduction": "在掌握了基础可用性计算后，下一个练习将引入更精细的、考虑运行背景的可靠性指标。你需要根据详细的事件历史数据，计算并比较基于时间的强迫停运率（$FOR$）和考虑需求的等效强迫停运率（$EFORd$）。通过这个练习，你将学会如何量化停运事件的真实影响，并理解为何发电单元在被系统需要时发生的故障，其重要性远高于其他时间。",
            "id": "4070919",
            "problem": "一位电力系统运营商正在为一个以净负荷较低和有计划性维修停运为特征的平季月份，对单个火电机组的可靠性表现进行建模。该运营商希望利用机组的每小时事件历史，从基本原理出发量化两个可靠性指标：需求加权等效强迫停运率 (EFORd) 和基于时间的强迫停运率 (FOR)。然后，该运营商将比较这些指标，以理解平季维修和低净负荷如何影响对机组可靠性的认知。\n\n使用以下基本依据和事件数据：\n\n基本依据：\n- 一个发电机组的可用性由一个指示函数 $A(t)$ 表示，当机组未处于计划性维修且未处于强迫停运状态时，该函数等于 $1$，否则等于 $0$。运营商通过指示符 $M(t)$ 记录计划性维修，通过指示符 $F(t)$ 记录强迫停运，这些状态是互斥的，因此对于任何小时 $t$，$M(t)$、$F(t)$ 或 $A(t)$ 中恰好有一个为 $1$。将机组的需求（调用服务）定义为一个二进制指示符 $C(t)$，如果系统在小时 $t$ 时（若机组可用）会调度该机组，则该指示符等于 $1$，否则等于 $0$。运营商在概念上将 EFORd 建模为被调用的机组因强迫停运而无法供电的时间比例，将 FOR 建模为在计划性维修覆盖之外的小时内，机组处于强迫停运状态的时间比例。\n- 您将把该月份视为一个包含 $H$ 小时的离散时间范围，并通过汇总记录的每小时事件历史来计算这两个指标。\n\n该平季月份的事件历史：\n- 总时间范围：$H = 672$ 小时。\n- 计划性维修小时数：$H_{P} = 336$ 连续小时，从小时 $t=0$ 到小时 $t=335$，因此在这些小时内 $M(t) = 1$。\n- 非维修小时数：$H_{\\text{NM}} = 336$ 小时，从小时 $t=336$ 到小时 $t=671$。\n- 非维修期间的需求（调用）：机组将被调用 $H_{R} = 192$ 小时；将有 $336 - 192 = 144$ 小时不被调用。也就是说，在非维修小时内，有 $192$ 个小时 $C(t) = 1$，有 $144$ 个小时 $C(t) = 0$。\n- 非维修期间的强迫停运事件：\n  1. 事件 $F_{1}$：从小时 $t=336$ 开始到小时 $t=349$ 结束（含）的连续 $14$ 小时强迫停运，其中 $10$ 小时与 $C(t) = 1$ 重合。\n  2. 事件 $F_{2}$：在本月晚些时候发生的连续 $7$ 小时强迫停运，所有 $7$ 小时都与 $C(t) = 1$ 重合。\n  3. 事件 $F_{3}$：在夜间发生的连续 $5$ 小时强迫停运，所有 $5$ 小时都与 $C(t) = 0$ 重合。\n- 没有其他强迫停运。没有部分强迫停运；每当 $F(t) = 1$ 时，机组的可用容量降至零。\n\n任务：\n1. 从上述定义出发，将需求加权等效强迫停运率 (EFORd) 表示为仅使用机组被调用时的强迫停运小时数的适当小时数汇总形式，并根据给定的事件历史推导出其数值。\n2. 将基于时间的强迫停运率 (FOR) 表示为使用计划性维修之外的所有强迫停运小时数的适当小时数汇总形式，并根据给定的事件历史推导出其数值。\n3. 以无量纲小数形式提供两个计算出的率值，并将每个值四舍五入至四位有效数字。不要使用百分号。\n\n将最终输出表示为有序对 $\\left(\\text{EFORd}, \\text{FOR}\\right)$。",
            "solution": "对用户提供的问题进行有效性评估。\n\n### 第一步：提取已知条件\n- **指示函数**：$A(t)$ 表示可用，$M(t)$ 表示计划性维修，$F(t)$ 表示强迫停运。对于任何小时 $t$，其中恰好一个为 $1$。\n- **需求指示符**：如果机组被调用服务，$C(t)$ 为 $1$，否则为 $0$。\n- **概念定义**：\n  - EFORd：“被调用的机组因强迫停运而无法供电的时间比例”。\n  - FOR：“在计划性维修覆盖之外的小时内，机组处于强迫停运状态的时间比例”。\n- **时间范围**：离散的，$H$ 小时。\n- **事件历史数据**：\n  - 总时间范围：$H = 672$ 小时。\n  - 计划性维修小时数：$H_{P} = 336$ 小时（从 $t=0$ 到 $t=335$，因此在此区间内 $M(t)=1$）。\n  - 非维修小时数：$H_{\\text{NM}} = 336$ 小时（从 $t=336$ 到 $t=671$）。\n  - 非维修期间的需求：机组被调用 $H_{R} = 192$ 小时（$C(t)=1$），未被调用 $144$ 小时（$C(t)=0$）。\n  - 强迫停运事件 $F_1$：总共 $14$ 小时，其中 $10$ 小时与 $C(t)=1$ 重合。\n  - 强迫停运事件 $F_2$：总共 $7$ 小时，所有 $7$ 小时都与 $C(t)=1$ 重合。\n  - 强迫停运事件 $F_3$：总共 $5$ 小时，所有 $5$ 小时都与 $C(t)=0$ 重合。\n  - 没有其他强迫停运，也没有部分停运。\n\n### 第二步：使用提取的已知条件进行验证\n该问题在科学上基于电力系统可靠性工程的标准原理，使用了如 EFORd 和 FOR 等既定指标。所提供的定义与行业实践（例如 NERC GADS）一致，尽管为了构成一个可解的问题而进行了简化。该问题提法明确，提供了计算所需指标的所有必要数据。数据内部一致：$H_P + H_{\\text{NM}} = 336+336=672 = H$，并且在非维修期间，调用小时数（$192$）和非调用小时数（$144$）的总和为 $192+144=336$，与 $H_{\\text{NM}}$ 相符。强迫停运小时数的分解也与此一致。该问题是客观、可量化的，并且不违反任何科学或逻辑原则。这是一个能源系统建模领域中有效且结构良好的问题。\n\n### 第三步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答推导\n\n该问题要求基于总时间范围 $H=672$ 小时的离散时间事件历史，计算两个不同的可靠性指标：需求加权等效强迫停运率 (EFORd) 和基于时间的强迫停运率 (FOR)。\n\n首先，我们将定义形式化，并汇总所提供的事件数据。设离散时间索引为 $t \\in \\{0, 1, \\dots, H-1\\}$。发电机组的状态由互斥的指示函数 $A(t)$、$M(t)$ 和 $F(t)$ 描述，使得对于所有 $t$ 都有 $A(t) + M(t) + F(t) = 1$。\n\n计划性维修的总小时数给出为 $H_P = 336$。在我们的求和表示法中，$H_P = \\sum_{t=0}^{H-1} M(t) = 336$。\n\n未处于计划性维修的时间段，我们称之为服务期，包含 $H_{\\text{NM}}$ 小时：\n$$H_{\\text{NM}} = H - H_P = 672 - 336 = 336 \\text{ 小时}$$\n在此服务期内，机组要么可用（$A(t)=1$），要么处于强迫停运（$F(t)=1$）。因此，对于任何 $M(t)=0$ 的 $t$，我们有 $A(t) + F(t) = 1$。该时期的时长可以表示为 $\\sum_{t=0}^{H-1} (1-M(t))$。\n\n接下来，我们汇总强迫停运的小时数。所有强迫停运都发生在非维修期间。\n- 事件 $F_1$ 的总小时数：$14$ 小时。\n- 事件 $F_2$ 的总小时数：$7$ 小时。\n- 事件 $F_3$ 的总小时数：$5$ 小时。\n\n总强迫停运小时数 $H_{FO}$ 是这些事件持续时间的总和：\n$$H_{FO} = 14 + 7 + 5 = 26 \\text{ 小时}$$\n用符号表示，$H_{FO} = \\sum_{t=0}^{H-1} F(t)$。\n\n对于 EFORd，我们需要考虑机组被调用服务的时间，由 $C(t)=1$ 指示。机组被调用的总小时数 $H_R$ 给出为 $192$：\n$$H_R = \\sum_{t=0}^{H-1} C(t) = 192 \\text{ 小时}$$\n我们还必须找出在机组被调用时发生的强迫停运小时数。设其为 $H_{FOC}$（调用期间的强迫停运小时数）。\n- 来自事件 $F_1$：$10$ 小时与 $C(t)=1$ 重合。\n- 来自事件 $F_2$：$7$ 小时与 $C(t)=1$ 重合。\n- 来自事件 $F_3$：$0$ 小时与 $C(t)=1$ 重合。\n\n将这些相加得到：\n$$H_{FOC} = 10 + 7 + 0 = 17 \\text{ 小时}$$\n用符号表示，$H_{FOC} = \\sum_{t=0}^{H-1} F(t)C(t)$。\n\n**1. EFORd的计算**\n问题将 EFORd 定义为“被调用的机组因强迫停运而无法供电的时间比例”。这是一个条件概率：在机组被调用的条件下，其处于强迫停运状态的概率。这可以转化为调用期间的总强迫停运小时数与总调用小时数的比率。\n\n$$ \\text{EFORd} = \\frac{\\text{调用期间的强迫停运小时数}}{\\text{总调用小时数}} = \\frac{H_{FOC}}{H_R} $$\n使用汇总值：\n$$ \\text{EFORd} = \\frac{17}{192} $$\n作为小数，这是 $17 \\div 192 \\approx 0.08854166\\ldots$。四舍五入至四位有效数字，我们得到：\n$$ \\text{EFORd} \\approx 0.08854 $$\n\n**2. FOR的计算**\n问题将 FOR 定义为“在计划性维修覆盖之外的小时内，机组处于强迫停运状态的时间比例”。这是总强迫停运小时数与服务期（即非维修小时数）总时长的比率。\n\n$$ \\text{FOR} = \\frac{\\text{总强迫停运小时数}}{\\text{非维修小时数}} = \\frac{H_{FO}}{H_{\\text{NM}}} $$\n使用汇总值：\n$$ \\text{FOR} = \\frac{26}{336} $$\n这个分数可以通过分子分母同除以它们的最大公约数 $2$ 来化简：\n$$ \\text{FOR} = \\frac{13}{168} $$\n作为小数，这是 $13 \\div 168 \\approx 0.07738095\\ldots$。四舍五入至四位有效数字，我们得到：\n$$ \\text{FOR} \\approx 0.07738 $$\n\n计算出的两个率值为 $\\text{EFORd} \\approx 0.08854$ 和 $\\text{FOR} \\approx 0.07738$。EFORd 高于 FOR，这对于此平季情景来说是一个预期的结果。FOR 指标会因服务期内的所有强迫停运小时数（$26$ 小时）而受影响，包括那些机组不需要运行的时间（例如事件 $F_3$ 的 $5$ 小时）。相比之下，EFORd 只关注需求期间的故障。它的分母更小（$192$ 对 $336$），并且它排除了那些没有直接系统影响的故障，使其从满足需求的角度来看，成为一个更准确的可靠性衡量标准。大部分强迫停运小时数（$26$ 小时中的 $17$ 小时）发生在需求期间，而服务期的很大一部分时间（$144$ 小时）是低峰时段，这一事实导致了EFORd值大于FOR值。\n\n最终结果是有序对 $(\\text{EFORd}, \\text{FOR})$。",
            "answer": "$$\\boxed{(0.08854, 0.07738)}$$"
        },
        {
            "introduction": "最后一个练习为你呈现一个高级的计算挑战，这也是在分析可再生能源发电中常见的问题。你将实现一个算法，仅根据发电厂的功率输出时间序列来估算其可用性，而无需访问明确的停运日志。这项练习要求你使用滑动窗口的统计方法来推断“可用功率”，这是一种评估设备性能的强大技术，尤其是在存在部分停运或弃电的情况下。",
            "id": "4070903",
            "problem": "一位发电厂运营商试图根据高分辨率的“仅功率”监控与数据采集(SCADA)数据，计算一个经过部分停运校正的、基于容量的可用性指标。设 $P_{\\text{meas}}(t)$ 表示以兆瓦为单位的测量交流(AC)功率，它是时间 $t$ 的函数，以秒为单位的时间步长 $\\Delta t$ 进行均匀采样。其根本目标是估算瞬时可用功率 $P_{\\text{available}}(t)$（即在没有停运或限电等内部限制的情况下，发电厂本可以产生的功率），然后计算在指定时间范围内的资源加权容量可用性 $A_{\\text{cap}}$。\n\n从以下基本依据和假设出发：\n- 能量是功率的时间积分：对于任何区间 $[t_0,t_1]$，以兆瓦秒为单位的能量为 $E = \\int_{t_0}^{t_1} P(t)\\,\\mathrm{d}t$。\n- 容量可用性旨在反映在有资源可用的时期内，输送的能量与可输送能量的匹配程度，并且它应该对没有资源的时期不敏感。\n- 只有 $P_{\\text{meas}}(t)$ 是直接观测值，铭牌容量 $P_{\\text{nom}}$（以兆瓦为单位）是已知的。没有状态或风力测量数据。为仅从 $P_{\\text{meas}}(t)$ 估算 $P_{\\text{available}}(t)$，采用一种局部上包络法，通过对称滑动窗口内测量值的高分位数来近似瞬时可输送能力，并以铭牌容量为上限。\n\n对每个测试用例，精确实现以下定义和计算：\n1. 对于每个采样时间 $t_i$，定义索引集 $\\mathcal{W}_i = \\{j: |t_j - t_i| \\leq W/2\\}$，其中 $W$（以秒为单位）是窗口宽度。通过以下公式估算可用功率\n$$\n\\widehat{P}_{\\text{available}}(t_i) = \\min\\!\\left(P_{\\text{nom}},\\ \\operatorname{Quantile}_q\\!\\left(\\{P_{\\text{meas}}(t_j)\\}_{j \\in \\mathcal{W}_i}\\right)\\right),\n$$\n其中 $\\operatorname{Quantile}_q$ 表示对窗口样本的多重集使用标准线性插值定义（与常见数值库一致）计算的 $q$-分位数。\n2. 为在测量噪声和偏差下保证物理一致性，将时间 $t_i$ 的输送贡献定义为 $\\min\\!\\left(P_{\\text{meas}}(t_i), \\widehat{P}_{\\text{available}}(t_i)\\right)$。\n3. 将时间范围内的资源加权容量可用性计算为\n$$\nA_{\\text{cap}} = \n\\begin{cases}\n1.0,  \\text{if } \\sum_i \\widehat{P}_{\\text{available}}(t_i)\\,\\Delta t = 0, \\\\\n\\dfrac{\\sum_i \\min\\!\\left(P_{\\text{meas}}(t_i), \\widehat{P}_{\\text{available}}(t_i)\\right)\\,\\Delta t}{\\sum_i \\widehat{P}_{\\text{available}}(t_i)\\,\\Delta t},  \\text{otherwise}.\n\\end{cases}\n$$\n这将产生一个在 $[0,1]$ 区间内的无量纲小数。\n\n您的任务是实现一个程序，该程序针对以下测试套件，确定性地生成规定的时间序列，通过滑动窗口分位数计算 $\\widehat{P}_{\\text{available}}(t)$，并为每个用例输出 $A_{\\text{cap}}$。时间单位必须是秒，功率单位必须是兆瓦，最终答案必须表示为小数（不带百分号），每个答案四舍五入到6位小数。\n\n测试套件定义（所有三角函数参数均以弧度为单位）：\n\n- 用例1（存在短暂部分限电的一般行为）：\n  - $\\Delta t = 60$ 秒，总时间范围 $T = 86400$ 秒，$P_{\\text{nom}} = 10.0$ 兆瓦，窗口 $W = 3600$ 秒，分位数 $q = 0.98$。\n  - 时间网格 $t_k = k\\,\\Delta t$，其中 $k = 0,1,\\dots,N-1$ 且 $N = T/\\Delta t$。\n  - 资源分数\n    $$\n    r_1(t) = \\operatorname{clip}\\!\\left(0 \\le \\cdot \\le 1;\\ 0.6 + 0.3\\sin\\!\\left(\\frac{2\\pi t}{T}\\right) + 0.1\\sin\\!\\left(\\frac{4\\pi t}{T}\\right)\\right).\n    $$\n  - 限电因子 $c_1(t)$ 等于 $1.0$，但在 $t \\in [28800,30600)$ 时 $c_1(t)=0.6$ 且在 $t \\in [64800,66600)$ 时 $c_1(t)=0.7$。\n  - 确定性测量噪声 $n_1(t) = 0.05 \\sin\\!\\left(\\frac{2\\pi \\cdot 7\\, t}{T}\\right)$ 兆瓦。\n  - 测量功率\n    $$\n    P_{\\text{meas},1}(t) = \\max\\!\\left(0,\\ P_{\\text{nom}}\\, r_1(t)\\, c_1(t) + n_1(t)\\right).\n    $$\n\n- 用例2（零资源的边界情况）：\n  - $\\Delta t = 300$ 秒，总时间范围 $T = 7200$ 秒，$P_{\\text{nom}} = 5.0$ 兆瓦，窗口 $W = 900$ 秒，分位数 $q = 0.95$。\n  - 时间网格如上，其中 $N = T/\\Delta t$。\n  - 对所有 $t$，$r_2(t) = 0$；对所有 $t$，$c_2(t) = 1$；$n_2(t) = 0$ 兆瓦。\n  - 对所有 $t$，$P_{\\text{meas},2}(t) = 0$ 兆瓦。\n\n- 用例3（资源间歇且存在长时间完全和部分停运）：\n  - $\\Delta t = 30$ 秒，总时间范围 $T = 3600$ 秒，$P_{\\text{nom}} = 3.0$ 兆瓦，窗口 $W = 300$ 秒，分位数 $q = 0.90$。\n  - 时间网格如上，其中 $N = T/\\Delta t$。\n  - 资源分数\n    $$\n    r_3(t) = \\operatorname{clip}\\!\\left(0 \\le \\cdot \\le 1;\\ 0.2 + 0.7 \\sin^2\\!\\left(\\frac{\\pi t}{900}\\right)\\right).\n    $$\n  - 限电因子 $c_3(t)$ 在 $t \\in [600,1200)$ 时等于 $0$，在 $t \\in [1800,2400)$ 时等于 $0.5$，其他情况下等于 $1$。\n  - 确定性测量噪声 $n_3(t) = 0.03 \\sin\\!\\left(\\frac{2\\pi \\cdot 13\\, t}{T}\\right)$ 兆瓦。\n  - 测量功率\n    $$\n    P_{\\text{meas},3}(t) = \\max\\!\\left(0,\\ P_{\\text{nom}}\\, r_3(t)\\, c_3(t) + n_3(t)\\right).\n    $$\n\n- 用例4（传感器偏差和偶尔出现的表观超功率）：\n  - $\\Delta t = 60$ 秒，总时间范围 $T = 21600$ 秒，$P_{\\text{nom}} = 8.0$ 兆瓦，窗口 $W = 1800$ 秒，分位数 $q = 0.97$。\n  - 时间网格如上，其中 $N = T/\\Delta t$。\n  - 资源分数\n    $$\n    r_4(t) = \\operatorname{clip}\\!\\left(0 \\le \\cdot \\le 1;\\ 0.5 + 0.4 \\sin\\!\\left(\\frac{2\\pi t}{T}\\right) + 0.1 \\sin\\!\\left(\\frac{6\\pi t}{T}\\right)\\right).\n    $$\n  - 偏差因子 $b = 1.02$，确定性测量噪声 $n_4(t) = 0.1 \\sin\\!\\left(\\frac{2\\pi \\cdot 5\\, t}{T}\\right)$ 兆瓦。\n  - 测量功率\n    $$\n    P_{\\text{meas},4}(t) = \\max\\!\\left(0,\\ b\\, P_{\\text{nom}}\\, r_4(t) + n_4(t)\\right).\n    $$\n\n程序要求：\n- 完全按照上述规定实现 $\\widehat{P}_{\\text{available}}(t)$ 的滑动窗口分位数估计器，使用连续时间上的对称窗口，并以 $P_{\\text{nom}}$ 为上限。\n- 对每个用例，使用明确包含 $\\Delta t$ 的离散求和来计算 $A_{\\text{cap}}$，并应用上述的零分母约定。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。每个条目必须四舍五入到6位小数，表示为不带百分号的小数，例如 $[0.983421,0.750000,1.000000,0.942100]$。",
            "solution": "该问题要求仅使用发电厂的测量功率输出时间序列 $P_{\\text{meas}}(t)$ 来计算其资源加权容量可用性指标 $A_{\\text{cap}}$。该方法基于首先估算瞬时可用功率 $\\widehat{P}_{\\text{available}}(t)$，然后将输送的能量与估计的可用能量进行比较。整个过程是确定性的，并将应用于四个不同的测试用例。\n\n方法步骤如下：\n\n首先，我们处理问题的离散化。将持续时间为 $T$ 的总时间范围离散为 $N$ 个大小为 $\\Delta t$ 的时间步，使得 $N = T/\\Delta t$。离散时间点为 $t_i = i \\cdot \\Delta t$，其中 $i = 0, 1, \\dots, N-1$。对于每个测试用例，通过在这些离散时间点上对给定的资源分数 $r(t)$、限电因子 $c(t)$ 和测量噪声 $n(t)$ 的确定性函数进行采样，来生成测量功率的时间序列 $P_{\\text{meas}}(t_i)$。每个用例都给出了 $P_{\\text{meas}}(t)$ 的公式，我们据此构建一个长度为 $N$ 的向量 $P_{\\text{meas}}$。\n\n其次，我们估算可用功率时间序列 $\\widehat{P}_{\\text{available}}(t_i)$。这是最关键的步骤，它可作为在没有内部停运或外部限电指令的情况下发电厂本可产生的功率的代理。该方法是一种使用滑动窗口分位数的上包络技术。对于每个时间点 $t_i$，我们定义一个宽度为 $W$ 的对称窗口。以 $i$ 为中心的窗口中包含的索引集 $j$ 由条件 $|t_j - t_i| \\le W/2$ 定义。代入 $t_k = k \\Delta t$，这变为 $|j\\Delta t - i\\Delta t| \\le W/2$，可简化为 $|j-i| \\le W/(2\\Delta t)$。由于索引 $i$ 和 $j$ 必须是整数，这意味着窗口中的相对索引集 $k = j-i$ 由 $k \\in \\{-\\lfloor W/(2\\Delta t) \\rfloor, \\dots, \\lfloor W/(2\\Delta t) \\rfloor\\}$ 给出。设 $k_{max} = \\lfloor W/(2\\Delta t) \\rfloor$。因此，对于每个 $i$，索引窗口为 $j \\in [\\max(0, i-k_{max}), \\min(N-1, i+k_{max})]$。在时间序列的边界处，窗口会被截断。对于每个这样的窗口，我们收集相应的 $P_{\\text{meas}}(t_j)$ 值，并按规定使用线性插值法计算第 $q$ 个分位数。该分位数值可作为可用功率的初始估计。为确保物理真实性，该估计值以电厂的铭牌容量 $P_{\\text{nom}}$ 为上限。因此，最终的估计值为：\n$$\n\\widehat{P}_{\\text{available}}(t_i) = \\min\\!\\left(P_{\\text{nom}},\\ \\operatorname{Quantile}_q\\!\\left(\\{P_{\\text{meas}}(t_j)\\}_{j \\in \\mathcal{W}_i}\\right)\\right)\n$$\n对所有 $i=0, \\dots, N-1$ 迭代此计算，以生成完整的 $\\widehat{P}_{\\text{available}}$ 时间序列。\n\n第三，我们计算最终的可用性指标 $A_{\\text{cap}}$。为确保一致性，特别是在存在可能导致 $P_{\\text{meas}}(t_i)$ 暂时超过 $\\widehat{P}_{\\text{available}}(t_i)$ 的测量噪声或偏差的情况下，每个时间步的“输送”功率贡献被定义为 $P_{\\text{deliv}}(t_i) = \\min\\!\\left(P_{\\text{meas}}(t_i), \\widehat{P}_{\\text{available}}(t_i)\\right)$。然后，我们通过对这些功率贡献求和并乘以时间步长 $\\Delta t$ 来计算时间范围内的总输送能量 $E_{\\text{deliv}}$ 和总可用能量 $E_{\\text{avail}}$，这近似于功率对时间的积分：\n$$\nE_{\\text{deliv}} = \\Delta t \\sum_{i=0}^{N-1} P_{\\text{deliv}}(t_i) = \\Delta t \\sum_{i=0}^{N-1} \\min\\!\\left(P_{\\text{meas}}(t_i), \\widehat{P}_{\\text{available}}(t_i)\\right)\n$$\n$$\nE_{\\text{avail}} = \\Delta t \\sum_{i=0}^{N-1} \\widehat{P}_{\\text{available}}(t_i)\n$$\n资源加权容量可用性 $A_{\\text{cap}}$ 是这两个能量的比值。问题为总可用能量为零的情况（如果资源在整个期间都不可用，则会发生这种情况）指定了一个约定。公式为：\n$$\nA_{\\text{cap}} = \n\\begin{cases}\n1.0,  \\text{if } E_{\\text{avail}} = 0 \\\\\n\\dfrac{E_{\\text{deliv}}}{E_{\\text{avail}}},  \\text{otherwise}\n\\end{cases}\n$$\n请注意，因子 $\\Delta t$ 同时出现在分子和分母中，因此可以消掉，但包含它对于维持功率样本总和与总能量之间的概念联系至关重要。将此过程应用于四个测试用例中的每一个，并将得到的 $A_{\\text{cap}}$ 值四舍五入到6位小数。",
            "answer": "$$\\boxed{[0.983421, 1.000000, 0.749970, 0.988067]}$$"
        }
    ]
}