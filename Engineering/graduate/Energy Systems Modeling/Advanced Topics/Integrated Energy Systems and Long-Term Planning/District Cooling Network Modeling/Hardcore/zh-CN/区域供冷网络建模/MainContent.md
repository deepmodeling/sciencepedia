## 引言
区域供冷系统（DCN）作为现代城市可持续能源基础设施的核心组成部分，通过集中制冷和规模化输配，极大地提升了建筑制冷的能源效率。然而，这些庞大而复杂的网络系统的设计、运行和维护面临着巨大挑战。为了确保其经济、高效和可靠地运行，工程师和研究人员迫切需要一种能够精确预测其动态行为的工具。填补这一需求的正是严谨的[数学建模](@entry_id:262517)与仿真技术，它为理解和优化复杂的流体[动力学与热力学](@entry_id:138039)过程提供了理论基础。

本文旨在为读者提供一个关于区域供冷管网建模的系统性框架，从第一性原理到高级应用。文章将分为三个核心部分，引导读者逐步深入。在**“原理与机制”**一章中，我们将从基本的守恒定律出发，详细推导描述管网水力与热力特性的核心方程，并揭示其特有的[微分](@entry_id:158422)-代数方程（DAE）结构。随后，在**“应用与跨学科连接”**一章中，我们将展示这些模型如何应用于解决实际工程问题，如系统设计、运行控制和[可靠性分析](@entry_id:192790)，并探讨其与数据科学、控制理论等领域的交叉前沿。最后，**“动手实践”**部分将提供一系列精心设计的计算练习，帮助读者将理论知识转化为实践技能。

通过这一结构化的学习路径，读者不仅将掌握区域供冷管网建模的“如何做”，更将深刻理解其背后的“为什么”，为未来从事相关领域的研究与工程实践打下坚实的基础。让我们首先进入第一章，探索构建这些模型的物理原理与数学机制。

## 原理与机制

本章旨在阐述区域供冷管网建模的核心物理原理与数学机制。继引言之后，我们将深入探讨控制管网行为的基本守恒定律，以及如何将这些定律转化为一个一致且可解的数学模型。本章内容将从基本概念出发，逐步构建起一个完整的动态仿真框架，并讨论其结构特性与数值求解的考量。

### 区域供冷管网的概念框架

一个**区域供冷管网 (District Cooling Network, DCN)** 是一个集中的能源分配系统，其核心功能是通过循环冷冻水将制冷量从中央制冷站输送至多个用户建筑。为了构建一个精确的数学模型，我们必须首先建立一个清晰的概念框架，将物理实体映射到模型元素，并明确系统运行的基本热力学原理。

从拓扑结构上看，典型的区域供冷管网是一个**双管系统**，由两条主要管道组成：**供水干管 (supply header)** 和 **回水干管 (return header)**。供水干管将中央制冷站生产的低温冷冻水输送至各个用户，而回水干管则将吸收了建筑热量后温度升高的水送回制冷站。在基于图论的建模方法中，管道（包括干管和支管）自然地被表示为**边 (edges)**，而水流[汇合](@entry_id:148680)或分流的点，如管道连接处或用户换热站，则被表示为**节点 (nodes)**。

区域供冷的核心热力学过程与区域供热恰好相反。在供冷系统中，建筑物的空调系统将室内热量通过[换热器](@entry_id:154905)转移给区域管网中的冷冻水。这意味着热量是*从建筑传递到水中*的。根据能量守恒定律，流经用户[换热器](@entry_id:154905)的水温将会升高。因此，用户侧的**回水温度 $T_{\text{ret}}$ 必然高于其供水温度 $T_{\text{sup}}$**。对于流体而言，其获得的净热量 $\dot{Q}_{\text{to fluid}}$ 为正值 ($\dot{Q}_{\text{to fluid}} > 0$)。与之相对，中央制冷站的作用是从回水中移出热量，将其温度降至设定的供水温度，因此制冷站对于循环水系统来说是一个**热沉 (thermal sink)**。而区域供热系统则是将热量从热水传递给建筑，导致水温下降（$T_{\text{sup}} > T_{\text{ret}}$），制冷站的角色也相应地变成了热源。

这种清晰的物理图像与标准的建模约定相对应：中央制冷站是耦合供水与回水节点的设备，它为系统提供[压头](@entry_id:141368)（通过水泵）并移除热量；用户换热站则作为末端边界，向系统施加热负荷（即 $\dot{Q}_{\text{to fluid}} > 0$），但通常不与建筑内的水系统发生质量交换。这个框架将复杂的物理系统简化为一个可分析的、由节点和边构成的水力-热力网络。

### 控制方程：模型的物理基础

所有区域供冷管网模型都建立在流体动力学与[热力学](@entry_id:172368)的基本守恒定律之上。这些定律——质量守恒、[动量守恒](@entry_id:149964)和能量守恒——构成了描述管网中流量、压力和温度分布的数学方程组。

#### 质量守恒：水力基础

对于被建模为[不可压缩流体](@entry_id:181066)的冷冻水，[质量守恒](@entry_id:204015)原理在管网的每个节点上都必须得到满足。在一个稳定或准[稳态模型](@entry_id:157508)中，这意味着在任何一个节点（如管道交汇处），流入该节点的总[质量流](@entry_id:143424)量必须精确等于流出该节点的总[质量流](@entry_id:143424)量。

**节点[质量守恒](@entry_id:204015)**：对于任意节点 $i$，其[质量守恒](@entry_id:204015)方程可写作：

$$
\sum_{j} \dot{m}_{j \to i} - \sum_{k} \dot{m}_{i \to k} = 0
$$

其中，$\dot{m}_{j \to i}$ 表示从上游节点 $j$ 流入节点 $i$ 的[质量流](@entry_id:143424)量，而 $\dot{m}_{i \to k}$ 表示从节点 $i$ 流向下游节点 $k$ 的质量流量。这个简单的[代数方程](@entry_id:272665)构成了整个管网水力计算的基础，它将所有管道的流量耦合在一起，形成一个网络范围内的[约束系统](@entry_id:164587)。

#### 动量守恒：压力与流量的支配关系

流体在管道中流动时，由于与管壁的摩擦以及流经阀门、弯头等管件时的局部扰动，会损失[机械能](@entry_id:162989)，这在宏观上表现为压力的下降（或水头的损失）。动量守恒的宏观体现，即能量平衡，将管道两端的压力差与流量和管道特性联系起来。

对于管段中的[摩擦损失](@entry_id:272644)，最核心的[本构关系](@entry_id:186508)是**[达西-魏斯巴赫方程](@entry_id:272444) (Darcy-Weisbach equation)**。 该方程给出了在长度为 $L$、内径为 $D$ 的[直管](@entry_id:151308)中，当流体以[平均速度](@entry_id:267649) $v$ 流动时产生的[压降](@entry_id:199916) $\Delta p$：

$$
\Delta p = f \left(\frac{L}{D}\right) \left(\frac{\rho v^{2}}{2}\right)
$$

其中，$\rho$ 是流体密度，而 $f$ 是一个无量纲的**达西摩擦因子 (Darcy friction factor)**。这个因子并非一个常数，它综合反映了流动状态和管道表面的物理特性。对于区域供冷管网中常见的[湍流](@entry_id:151300)区，摩擦因子 $f$ 是流体**雷诺数 (Reynolds number)** $\operatorname{Re}$ 和管道**[相对粗糙度](@entry_id:264325) (relative roughness)** $\varepsilon/D$ 的函数。雷诺数定义为 $\operatorname{Re} = \frac{\rho v D}{\mu}$，其中 $\mu$ 是流体的[动力粘度](@entry_id:268228)，它表征了[惯性力](@entry_id:169104)与粘性力的相对大小。

在工程实践中，达西摩擦因子 $f$ 通常由经典的**[科尔布鲁克-怀特方程](@entry_id:271265) (Colebrook-White equation)** 隐式确定：

$$
\frac{1}{\sqrt{f}} = -2 \log_{10}\left( \frac{\varepsilon/D}{3.7} + \frac{2.51}{\operatorname{Re} \sqrt{f}} \right)
$$

这个方程需要迭代求解，但它精确地描述了从水力光滑区到完全粗糙区的过渡行为，是现代管网水力分析的标准。 [动量方程](@entry_id:197225)将网络中的压力（节点变量）和流量（边变量）紧密地联系在一起，形成一组[非线性](@entry_id:637147)代数方程。

#### 能量守恒：温度的演化与混合

能量守恒定律决定了管网中流体温度的分布和变化。我们需要在两个尺度上考虑能量守恒：沿管道的[输运过程](@entry_id:177992)和在节点的混合过程。

**管道中的[能量输运](@entry_id:183081)**：当冷冻水在管道中流动时，它通过对流（即平流）[输运热](@entry_id:136679)能。同时，由于管道绝热并非完美，水会与环境发生热交换。对于一段被温暖环境包围的供冷管道，热量会从外界渗入。考虑一个长度为 $dx$ 的[微分控制](@entry_id:270911)体，在稳态流动下，进入控制体的平流能量与穿过管壁传入的热量之和，等于离开控制体的平流能量。这导出了描述温度沿管道轴向坐标 $x$ 分布的**轴向能量方程**。

假设[质量流](@entry_id:143424)量 $\dot{m}$ 和比热容 $c_p$ 恒定，忽略轴向[热传导](@entry_id:143509)，该方程可表示为：

$$
\frac{d(\dot{m} c_p T)}{dx} = U A_\ell (T_a - T)
$$

其中，$T(x)$ 是位置 $x$ 处的流体温度，$T_a$ 是环境温度，$U$ 是[总传热系数](@entry_id:151629)，$A_\ell$ 是单位长度的传热面积（即管道外[周长](@entry_id:263239)）。该方程是一个[一阶常微分方程](@entry_id:264241)（对于[稳态](@entry_id:139253)）或[偏微分](@entry_id:194612)方程（对于动态），它表明流体温度沿程的变化率取决于本地温差和流量。等式右侧也可以写为 $-U A_\ell (T - T_a)$。由于在供冷管网中，$T  T_a$，该项为正，表示水温会沿程升高。

**节点处的能量混合**：当来自不同支路、温度不同的水流在节点处汇合时，它们会发生混合。根据能量守恒定律，在绝热且无功输出的混合节点，流出混合物的总焓流率等于所有流入流体的[总焓](@entry_id:197863)流率之和。

$$
\sum_{j} (\dot{m} h)_{j \to i} = \sum_{k} (\dot{m} h)_{i \to k}
$$

其中 $h$ 是比焓。对于不可[压缩液体](@entry_id:141123)，在忽略压力影响且比热容 $c_p$ 恒定的情况下，$h$ 的变化只与温度有关 ($dh = c_p dT$)。此时，混合节点的能量守恒方程可以简化为：

$$
T_{\text{mix}} = \frac{\sum_{j} \dot{m}_{j \to i} T_j}{\sum_{j} \dot{m}_{j \to i}}
$$

这个公式表明，混合后的温度 $T_{\text{mix}}$ 是所有流入水流温度的**质量流量加权平均值**。例如，若有两股流量分别为 $\dot{m}_1 = 25 \, \mathrm{kg/s}$（温度 $T_1 = 281 \, \mathrm{K}$）和 $\dot{m}_2 = 15 \, \mathrm{kg/s}$（温度 $T_2 = 285 \, \mathrm{K}$）的水流[汇合](@entry_id:148680)，其混合温度为：

$$
T_{\text{mix}} = \frac{(25)(281) + (15)(285)}{25 + 15} = \frac{7025 + 4275}{40} = 282.5 \, \mathrm{K}
$$

这清晰地表明，节点处的能量平衡通过平流焓（$\dot{m}h$ 或近似为 $\dot{m}c_pT$）项，将温度与质量流量耦合起来。

### 部件模型：描述物理设备

除了管道本身，管网模型还必须包含泵、阀门等关键设备的数学描述。

**水泵**：中央制冷站的水泵是驱动整个管网循环的动力源。[离心泵](@entry_id:264566)的性能由其**[泵特性曲线](@entry_id:261367) (pump curve)** 描述，该曲线给出了在特定转速下，泵提供的扬程 $H$（等效于压力增益）与通过它的流量 $Q$ 之间的关系。对于采用变频驱动 (VFD) 的变速泵，其性能可以通过**相似定律 (Affinity Laws)** 从一个已知的参考转速 $N_0$ 下的[特性曲线](@entry_id:918058) $H_0(Q)$ 进行缩放。

对于固定的叶轮直径，相似定律表明：
- 流量与转速成正比：$Q \propto N$
- 扬程与转速的平方成正比：$H \propto N^2$

利用这些关系，可以在任意转速 $N$ 下，从参考曲线推算出完整的扬程-流量关系：

$$
H(Q,N) = \left(\frac{N}{N_0}\right)^2 H_0\left(Q \frac{N_0}{N}\right)
$$

此外，水泵的输入功率 $P$ 不仅取决于其提供的水力功率 $\rho g Q H$（其中 $g$ 是重力加速度），还取决于其效率 $\eta$。效率通常是流量的[非线性](@entry_id:637147)函数，也遵循相似定律。输入功率的计算公式为：

$$
P = \frac{\rho g Q H}{\eta}
$$

这个代数模型准确地捕捉了变速泵在不同工况下的水力与能耗特性。

**阀门与管件**：控制阀门和其他管件（如弯头、三通）在模型中被表示为集中的**[水力阻力](@entry_id:266793)**。它们产生的[压降](@entry_id:199916)是流量的[代数函数](@entry_id:187534)，对于阀门，该函数还依赖于其开度 $u(t)$。这些部件的[压降](@entry_id:199916)与管道的摩擦[压降](@entry_id:199916)一同构成了管网的总阻力。

### 系统级结构：[微分](@entry_id:158422)-代数方程模型

将上述所有守恒定律和部件模型组合在一起，我们便得到了一个完整的管网系统模型。这个模型的数学结构具有一个非常重要的特性：它是一个**[微分](@entry_id:158422)-代数方程 (Differential-Algebraic Equation, DAE)** 系统。 

这种结构的产生源于系统中不同物理量的动态响应速度的巨大差异：

- **代数变量 (Algebraic Variables)**：在许多工程应用中，水力动态（[压力波的传播](@entry_id:275978)）非常快，其时间尺度远小于我们关心的热力动态或控制[响应时间](@entry_id:271485)。因此，可以采用**准[稳态](@entry_id:139253) (quasi-steady)** 假设，即忽略流体的惯性和管道的柔性。在此假设下，质量守恒（对于不可压缩流）和[动量守恒](@entry_id:149964)方程在任何时刻都表现为一组**[代数方程](@entry_id:272665)**。这意味着管网中的**压力**和**流量**是代数变量，它们的值在任何瞬间都由当时的边界条件（如泵速、阀位）唯一确定。

- **[微分](@entry_id:158422)变量 (Differential Variables)**：与水力动态不同，热力动态通常很慢。流体本身具有**有限的热容 (thermal capacitance)**，这意味着能量的存储和释放需要时间。因此，描述能量守恒的方程是**[微分](@entry_id:158422)方程**，其中时间导数项 $\frac{dT}{dt}$ 不可忽略。管段中（经过空间离散化后）和用户侧热交换设备中的**温度**是典型的[微分](@entry_id:158422)变量（或称[状态变量](@entry_id:138790)）。

因此，整个管网模型可以被抽象为以下半显式DAE形式：

$$
\dot{z} = f(z, y, t) \quad (\text{微分方程})
$$
$$
0 = g(z, y, t) \quad (\text{代数方程})
$$

其中，$z$ 是由所有温度组成的[微分](@entry_id:158422)状态向量，$y$ 是由所有压力和流量组成的代数变量向量。

这种DAE结构具有深刻的物理含义和实际影响。例如，当一个控制输入（如阀门开度 $u(t)$）发生阶跃变化时，它会瞬间改变[代数方程](@entry_id:272665)组 $g=0$ 的形式。为了维持代数约束，代数变量（流量和压力）必须也发生**瞬时跳变**。然而，代表着储能状态的[微分](@entry_id:158422)变量（温度）由于物理惯性必须保持**连续**，但它们的时间导数 $\dot{z}$ 会因为 $y$ 的跳变而发生不连续变化。

对于上述标准的准[稳态](@entry_id:139253)水力模型，其代数[约束方程](@entry_id:138140)组的[雅可比矩阵](@entry_id:178326) $\frac{\partial g}{\partial y}$ 通常是可逆的。这意味着我们只需对[代数方程](@entry_id:272665)[微分](@entry_id:158422)一次就可以求解出代数变量的时间导数，因此该系统被称为**指数为1 (index-1)** 的[DAE系统](@entry_id:1123360)。这个特性对于选择合适的数值求解器至关重要。 

### 网络拓扑与数值考量

最后，我们讨论[网络拓扑](@entry_id:141407)设计对性能的影响以及求解模型时遇到的数值挑战。

#### 拓扑结构的影响

区域管网的拓扑结构主要有三类：**放射状 (radial)**、**环状 (looped)** 和 **网状 (meshed)**。
- **放射状网络** 结构简单，像一棵树，从源头到任何用户只有唯一路径。其优点是设计和分析简单，流量可以唯一确定。缺点是缺乏**冗余性 (redundancy)**，任何一处管道发生故障，其下游的所有用户都将中断服务。
- **环状和网状网络** 包含一个或多个闭合回路。这提供了多条供水路径，极大地提高了系统的可靠性。在某段管道发生故障时，水流可以被重新路由，保证对用户的持续服务。此外，多路径分流通常可以降低远端用户的[压降](@entry_id:199916)，使其更容易满足最小压力要求。然而，环状和网状网络的分析更为复杂。仅靠节点质量守恒不足以确定[流量分布](@entry_id:261008)，还必须引入基于能量守恒的**环路方程**（即沿任何闭合环路的[压降](@entry_id:199916)和为零），才能获得唯一解。

#### 数值刚度与求解器选择

动态管网模型的一个显著特征是**数值刚度 (numerical stiffness)**。 这种现象源于系统中存在的时间尺度差异巨大的动态过程。水力动态的特征时间（如动量松弛时间 $\tau_h$）可能在亚秒级（例如 $\tau_h = 0.1 \, \mathrm{s}$），而热力动态的特征时间（如建筑热容时间常数 $\tau_T$）则可能在数百甚至数千秒（例如 $\tau_T = 600 \, \mathrm{s}$）。

这种时间尺度的巨大差异（[刚度比](@entry_id:142692) $S = \tau_T / \tau_h \gg 1$）给数值积分带来了巨大挑战。标准的**显式积分方法**（如[龙格-库塔法](@entry_id:140014)）为了保证[数值稳定性](@entry_id:175146)，其时间步长 $\Delta t$ 必须受到最快动态（即水力动态）的严格限制（例如 $\Delta t  2/\lambda_{\max}$，其中 $\lambda_{\max}$ 是系统最快的特征值）。这意味着即使我们只关心缓慢变化的热力过程，也必须使用极小的时间步长进行模拟，导致计算成本过高。

解决刚性问题的关键是采用**[隐式积分](@entry_id:1126415)方法**（如[后向欧拉法](@entry_id:139674)）。这些方法具有更好的稳定性，特别是**A-稳定**的方法，其时间步长不受稳定性条件的限制。这允许我们根据慢动态的精度要求来选择一个大得多的时间步长（例如 $\Delta t = 30 \, \mathrm{s}$），从而在保证稳定性的前提下，极大地提高仿真效率。因此，对于包含快、慢动态耦合的区域供冷管网模型，选择合适的隐式求解器是成功进行动态仿真的关键。