{
    "hands_on_practices": [
        {
            "introduction": "Accurately quantifying the mass of hydrogen stored in a high-pressure tank is fundamental to designing and operating fuel cell vehicles. This exercise moves beyond the ideal gas law to incorporate two critical real-world effects: the non-ideal behavior of hydrogen at high pressures, captured by the compressibility factor $Z$, and the slight expansion of the physical tank under pressure, known as volumetric compliance. By deriving an expression for the fillable mass, you will develop a more precise state-of-charge model essential for system design and control. ",
            "id": "4096338",
            "problem": "A hydrogen fuel cell vehicle uses a composite Type IV on-board storage tank whose internal free volume at zero gauge pressure is $V_{0}$ and whose volumetric compliance is approximately linear with pressure, so that the internal volume under pressure $P$ is $V(P) = V_{0}\\left(1 + \\kappa P\\right)$, where $\\kappa$ is a small positive constant with units of $\\mathrm{Pa}^{-1}$. The tank is filled according to a widely used industry fueling protocol, such as the Society of Automotive Engineers (SAE) standard J2601, which targets a settled state after fueling such that the tank pressure equals the nominal working pressure (NWP) $P_{\\mathrm{nwp}}$ when the hydrogen temperature has equilibrated to the ambient temperature $T_{\\mathrm{amb}}$.\n\nAssume the following physically grounded modeling framework:\n- Hydrogen behaves as a real gas described by the compressibility factor $Z(P,T)$, defined by the real-gas equation of state $P V = Z(P,T)\\, n R T$, where $n$ is the number of moles, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n- The hydrogen mass is $m = n M$, where $M$ is the molar mass of hydrogen. The tank composition does not change during fueling.\n- The fueling protocol stops the dispenser when the predicted settled pressure (after thermal equilibration) will equal $P_{\\mathrm{nwp}}$ at $T_{\\mathrm{amb}}$. Transient temperature excursions during fueling do not change the settled target; leakage and blowdown are negligible.\n\nInitially, the tank contains hydrogen at pressure $P_{0}$ and temperature $T_{0}$, occupying the internal volume $V(P_{0})$. After fueling and subsequent thermal equilibration, the settled final state is at pressure $P_{\\mathrm{nwp}}$ and temperature $T_{\\mathrm{amb}}$, occupying the internal volume $V(P_{\\mathrm{nwp}})$.\n\nStarting from the real-gas definition of the compressibility factor, the ideal-gas law, and the stated volumeâ€“pressure relation, derive a closed-form analytic expression for the maximum additional hydrogen mass $\\Delta m$ that can be added during the fueling event as a function of the initial pressure $P_{0}$ and temperature $T_{0}$, the ambient temperature $T_{\\mathrm{amb}}$, the nominal working pressure $P_{\\mathrm{nwp}}$, the zero-pressure tank volume $V_{0}$, the volumetric compliance coefficient $\\kappa$, the universal gas constant $R$, the molar mass $M$, and the compressibility factor evaluated at the initial and final settled states.\n\nUse SI units: express pressure in $\\mathrm{Pa}$, temperature in $\\mathrm{K}$, volume in $\\mathrm{m}^{3}$, the universal gas constant in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, and the molar mass in $\\mathrm{kg\\,mol^{-1}}$. Express the final mass in kilograms. Your final answer must be a single closed-form expression; no numerical evaluation is required.",
            "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded, well-posed, objective, and contains all necessary information to derive a closed-form solution. The problem is a standard exercise in applied thermodynamics and fluid mechanics, relevant to energy systems modeling.\n\nThe objective is to derive an expression for the additional hydrogen mass, $\\Delta m$, that can be added to the tank. This quantity is the difference between the final mass of hydrogen, $m_{\\mathrm{f}}$, and the initial mass, $m_{0}$.\n$$\n\\Delta m = m_{\\mathrm{f}} - m_{0}\n$$\nTo find expressions for $m_{\\mathrm{f}}$ and $m_{0}$, we begin with the real-gas equation of state provided, which relates pressure $P$, volume $V$, temperature $T$, and the number of moles $n$:\n$$\nP V = Z(P,T)\\, n R T\n$$\nHere, $Z(P,T)$ is the compressibility factor, a function of pressure and temperature, and $R$ is the universal gas constant. The mass of the gas, $m$, is related to the number of moles $n$ through the molar mass $M$:\n$$\nm = n M\n$$\nBy substituting $n = \\frac{m}{M}$ into the real-gas equation, we can solve for the mass $m$:\n$$\nP V = Z(P,T) \\left(\\frac{m}{M}\\right) R T\n$$\n$$\nm = \\frac{P V M}{Z(P,T) R T}\n$$\nThis general expression allows us to calculate the mass of gas in the tank for any given state $(P, T, V)$.\n\nNext, we apply this general expression to the initial and final states of the system.\n\nThe initial state is characterized by pressure $P_{0}$ and temperature $T_{0}$. According to the problem statement, the internal volume of the tank, $V$, is a function of the internal pressure, given by the linear compliance relation $V(P) = V_{0}\\left(1 + \\kappa P\\right)$. Therefore, the initial volume is:\n$$\nV(P_{0}) = V_{0}\\left(1 + \\kappa P_{0}\\right)\n$$\nThe compressibility factor at the initial state is $Z(P_0, T_0)$. Substituting these into the general mass equation gives the initial mass, $m_{0}$:\n$$\nm_{0} = \\frac{P_{0} V(P_{0}) M}{Z(P_{0}, T_{0}) R T_{0}} = \\frac{P_{0} \\left[V_{0}\\left(1 + \\kappa P_{0}\\right)\\right] M}{Z(P_{0}, T_{0}) R T_{0}}\n$$\n\nThe final settled state is characterized by the nominal working pressure $P_{\\mathrm{nwp}}$ and the ambient temperature $T_{\\mathrm{amb}}$. The volume of the tank at this final pressure is:\n$$\nV(P_{\\mathrm{nwp}}) = V_{0}\\left(1 + \\kappa P_{\\mathrm{nwp}}\\right)\n$$\nThe compressibility factor at the final state is $Z(P_{\\mathrm{nwp}}, T_{\\mathrm{amb}})$. Substituting these values into the general mass equation gives the final mass, $m_{\\mathrm{f}}$:\n$$\nm_{\\mathrm{f}} = \\frac{P_{\\mathrm{nwp}} V(P_{\\mathrm{nwp}}) M}{Z(P_{\\mathrm{nwp}}, T_{\\mathrm{amb}}) R T_{\\mathrm{amb}}} = \\frac{P_{\\mathrm{nwp}} \\left[V_{0}\\left(1 + \\kappa P_{\\mathrm{nwp}}\\right)\\right] M}{Z(P_{\\mathrm{nwp}}, T_{\\mathrm{amb}}) R T_{\\mathrm{amb}}}\n$$\n\nFinally, we calculate the added mass $\\Delta m$ by subtracting the initial mass from the final mass:\n$$\n\\Delta m = m_{\\mathrm{f}} - m_{0}\n$$\n$$\n\\Delta m = \\frac{P_{\\mathrm{nwp}} V_{0}\\left(1 + \\kappa P_{\\mathrm{nwp}}\\right) M}{Z(P_{\\mathrm{nwp}}, T_{\\mathrm{amb}}) R T_{\\mathrm{amb}}} - \\frac{P_{0} V_{0}\\left(1 + \\kappa P_{0}\\right) M}{Z(P_{0}, T_{0}) R T_{0}}\n$$\nTo present this in a more compact closed form, we can factor out the common terms $\\frac{V_{0}M}{R}$:\n$$\n\\Delta m = \\frac{V_{0} M}{R} \\left[ \\frac{P_{\\mathrm{nwp}}\\left(1 + \\kappa P_{\\mathrm{nwp}}\\right)}{Z(P_{\\mathrm{nwp}}, T_{\\mathrm{amb}}) T_{\\mathrm{amb}}} - \\frac{P_{0}\\left(1 + \\kappa P_{0}\\right)}{Z(P_{0}, T_{0}) T_{0}} \\right]\n$$\nThis expression represents the maximum additional hydrogen mass that can be added to the tank, derived from the fundamental principles and definitions provided in the problem statement.",
            "answer": "$$\\boxed{\\frac{V_{0} M}{R} \\left[ \\frac{P_{\\mathrm{nwp}}\\left(1 + \\kappa P_{\\mathrm{nwp}}\\right)}{Z(P_{\\mathrm{nwp}}, T_{\\mathrm{amb}}) T_{\\mathrm{amb}}} - \\frac{P_{0}\\left(1 + \\kappa P_{0}\\right)}{Z(P_{0}, T_{0}) T_{0}} \\right]}$$"
        },
        {
            "introduction": "Storing hydrogen as a cryogenic liquid introduces unique thermodynamic challenges, one of the most significant being the management of 'boil-off'. This practice delves into a fascinating quantum-level phenomenon: the slow, exothermic conversion of ortho-hydrogen to its more stable para-hydrogen state, which occurs even in a perfectly insulated tank. By modeling this conversion as a first-order kinetic process, you will calculate the resulting internal heat generation and its direct impact on the boil-off rate, a crucial factor in the design of long-term LH2 storage systems. ",
            "id": "4096224",
            "problem": "A spherical cryogenic storage vessel is charged with liquid hydrogen (LH2) at saturation. During liquefaction, the ortho-to-para spin isomer conversion of hydrogen ($\\text{H}_2$) was only partially catalyzed. As a result, the liquid at tank fill has an initial ortho-hydrogen mole fraction $x_{o,0} = 0.08$, while the thermodynamic equilibrium ortho fraction at $20\\ \\mathrm{K}$ is $x_{o}^{\\mathrm{eq}} = 0.002$. Assume that in the liquid phase, the ongoing ortho-to-para conversion follows a first-order relaxation process toward equilibrium characterized by a constant rate $k = 5.0 \\times 10^{-8}\\ \\mathrm{s}^{-1}$. The liquid is well-mixed so that composition is spatially uniform, and the only pathway for removing the conversion heat is vaporization at the free surface; neglect conductive losses to the tank walls and any external heat leaks. The vessel contains a total liquid mass $m_{\\text{LH}_2} = 5.0 \\times 10^{3}\\ \\mathrm{kg}$. The molar mass of hydrogen is $M_{\\text{H}_2} = 2.016\\ \\mathrm{g/mol}$, the latent heat of vaporization of LH2 at saturation is $\\ell_{v} = 4.46 \\times 10^{5}\\ \\mathrm{J/kg}$, and the enthalpy released per mole of hydrogen converted from ortho to para at $20\\ \\mathrm{K}$ is $\\Delta h_{op} = 702\\ \\mathrm{J/mol}$. Using a lumped energy balance consistent with these assumptions and a first-order kinetic model, derive an expression for the instantaneous additional heat generation rate in the liquid at $t = 0^{+}$ due to ongoing conversion. Then compute the corresponding initial additional boil-off mass flow rate in kilograms per second due solely to this conversion heat. Express your final mass flow rate in $\\mathrm{kg/s}$ and round your answer to three significant figures.",
            "solution": "The problem is evaluated to be valid as it is scientifically grounded, self-contained, and well-posed. The provided data are physically realistic for the phenomenon of ortho-para hydrogen conversion in cryogenic liquid hydrogen (LH2). The problem requires combining principles of chemical kinetics and thermodynamics to arrive at a solution, which is a standard procedure in energy systems modeling.\n\nThe primary task is to determine the initial boil-off mass flow rate, $\\dot{m}_{boil-off}(0)$, caused by the heat released from the spontaneous ortho-to-para hydrogen conversion.\n\nFirst, we model the kinetics of the conversion. The problem states that the mole fraction of ortho-hydrogen, $x_o$, relaxes toward its equilibrium value, $x_o^{\\mathrm{eq}}$, following a first-order process. The rate of change of the ortho mole fraction is given by:\n$$\n\\frac{dx_o}{dt} = -k (x_o(t) - x_o^{\\mathrm{eq}})\n$$\nwhere $k$ is the rate constant. The negative sign indicates that the ortho fraction decreases over time, as $x_o(t) > x_o^{\\mathrm{eq}}$.\n\nThe total number of moles of hydrogen in the tank, $N_{total}$, is constant (ignoring the small amount that boils off for this calculation of the total molar amount). It can be calculated from the total mass of LH2, $m_{\\text{LH}_2}$, and the molar mass of hydrogen, $M_{\\text{H}_2}$:\n$$\nN_{total} = \\frac{m_{\\text{LH}_2}}{M_{\\text{H}_2}}\n$$\nWe must be careful with units. The mass is given in $\\mathrm{kg}$ and the molar mass in $\\mathrm{g/mol}$. We convert the molar mass to $\\mathrm{kg/mol}$:\n$M_{\\text{H}_2} = 2.016\\ \\mathrm{g/mol} = 2.016 \\times 10^{-3}\\ \\mathrm{kg/mol}$.\n$$\nN_{total} = \\frac{5.0 \\times 10^{3}\\ \\mathrm{kg}}{2.016 \\times 10^{-3}\\ \\mathrm{kg/mol}} \\approx 2.4801587 \\times 10^{6}\\ \\mathrm{mol}\n$$\n\nThe number of moles of ortho-hydrogen is $N_o(t) = x_o(t) \\cdot N_{total}$. The rate of conversion of ortho-hydrogen (in moles per second), which we denote as $R(t)$, is the rate at which moles of ortho-hydrogen decrease:\n$$\nR(t) = -\\frac{dN_o}{dt} = -N_{total} \\frac{dx_o}{dt}\n$$\nSubstituting the first-order rate law:\n$$\nR(t) = -N_{total} [-k (x_o(t) - x_o^{\\mathrm{eq}})] = k N_{total} (x_o(t) - x_o^{\\mathrm{eq}})\n$$\nWe are interested in the initial rate at $t = 0^{+}$. At this time, the ortho mole fraction is its initial value, $x_o(0) = x_{o,0} = 0.08$. The initial rate of conversion is:\n$$\nR(0) = k N_{total} (x_{o,0} - x_o^{\\mathrm{eq}})\n$$\nSubstituting the given values:\n$k = 5.0 \\times 10^{-8}\\ \\mathrm{s}^{-1}$, $x_{o,0} = 0.08$, and $x_o^{\\mathrm{eq}} = 0.002$.\n$$\nR(0) = (5.0 \\times 10^{-8}\\ \\mathrm{s}^{-1}) \\times (2.4801587 \\times 10^{6}\\ \\mathrm{mol}) \\times (0.08 - 0.002)\n$$\n$$\nR(0) = (5.0 \\times 10^{-8}\\ \\mathrm{s}^{-1}) \\times (2.4801587 \\times 10^{6}\\ \\mathrm{mol}) \\times (0.078) \\approx 0.0096726\\ \\mathrm{mol/s}\n$$\n\nThe heat generation rate, $\\dot{Q}_{gen}$, is the product of the molar conversion rate and the enthalpy released per mole of conversion, $\\Delta h_{op}$.\n$$\n\\dot{Q}_{gen}(t) = R(t) \\cdot \\Delta h_{op}\n$$\nThe problem requests an expression for the instantaneous additional heat generation rate at $t=0^{+}$. This is $\\dot{Q}_{gen}(0)$:\n$$\n\\dot{Q}_{gen}(0) = R(0) \\cdot \\Delta h_{op} = k N_{total} (x_{o,0} - x_o^{\\mathrm{eq}}) \\Delta h_{op}\n$$\nSubstituting the total moles expression, the full expression is:\n$$\n\\dot{Q}_{gen}(0) = k \\frac{m_{\\text{LH}_2}}{M_{\\text{H}_2}} (x_{o,0} - x_o^{\\mathrm{eq}}) \\Delta h_{op}\n$$\nUsing the calculated value for $R(0)$ and the given $\\Delta h_{op} = 702\\ \\mathrm{J/mol}$:\n$$\n\\dot{Q}_{gen}(0) \\approx (0.0096726\\ \\mathrm{mol/s}) \\times (702\\ \\mathrm{J/mol}) \\approx 6.79017\\ \\mathrm{J/s}\n$$\n\nAccording to the problem's assumptions, this generated heat is entirely removed by vaporization (boil-off) of the liquid hydrogen. The energy balance is:\n$$\n\\dot{Q}_{gen}(t) = \\dot{m}_{boil-off}(t) \\cdot \\ell_v\n$$\nwhere $\\ell_v$ is the latent heat of vaporization. We need to find the initial boil-off mass flow rate, $\\dot{m}_{boil-off}(0)$.\n$$\n\\dot{m}_{boil-off}(0) = \\frac{\\dot{Q}_{gen}(0)}{\\ell_v}\n$$\nSubstituting the full symbolic expression for $\\dot{Q}_{gen}(0)$:\n$$\n\\dot{m}_{boil-off}(0) = \\frac{k \\cdot m_{\\text{LH}_2} \\cdot (x_{o,0} - x_o^{\\mathrm{eq}}) \\cdot \\Delta h_{op}}{M_{\\text{H}_2} \\cdot \\ell_v}\n$$\nNow we compute the numerical value using $\\dot{Q}_{gen}(0) \\approx 6.79017\\ \\mathrm{J/s}$ and the given $\\ell_v = 4.46 \\times 10^{5}\\ \\mathrm{J/kg}$:\n$$\n\\dot{m}_{boil-off}(0) = \\frac{6.79017\\ \\mathrm{J/s}}{4.46 \\times 10^{5}\\ \\mathrm{J/kg}} \\approx 1.522459 \\times 10^{-5}\\ \\mathrm{kg/s}\n$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\n\\dot{m}_{boil-off}(0) \\approx 1.52 \\times 10^{-5}\\ \\mathrm{kg/s}\n$$",
            "answer": "$$\\boxed{1.52 \\times 10^{-5}}$$"
        },
        {
            "introduction": "Effective energy systems modeling often involves scaling up from individual components to optimize the operation of an entire network. This practice abstracts the complexity of pipeline fluid dynamics into a network model, allowing you to analyze a simple hydrogen transmission system consisting of pipelines and a compressor. You will apply principles of nodal analysis and optimization to determine the hourly compressor settings that meet a variable daily demand while minimizing total energy consumption, a core task in the planning and operation of energy infrastructure. ",
            "id": "4096343",
            "problem": "Consider a serial hydrogen transmission network over a twenty-four ($24$) hour horizon with nodes $\\{n_0,n_1,n_2,n_3\\}$ and edges $\\{e_1,e_2,e_3\\}$ oriented $n_0\\to n_1\\to n_2\\to n_3$. Edge $e_1$ is a pipeline from $n_0$ to $n_1$, edge $e_2$ is a compressor from $n_1$ to $n_2$, and edge $e_3$ is a pipeline from $n_2$ to $n_3$. The source node $n_0$ has fixed pressure $p_0$, the demand node $n_3$ must maintain a pressure not below $p_{\\min}$, and intermediate node pressures $p_1(t)$ and $p_2(t)$ are determined by flows and compressor set points. The hydrogen mass flow on edge $e$ at time $t$ is denoted $\\dot{m}_e(t)$, and the end-use demand at node $n_3$ is denoted $\\dot{m}_{\\mathrm{dem}}(t)$.\n\nFundamental laws and modeling assumptions:\n- Nodal continuity is enforced via the incidence matrix $A\\in\\mathbb{R}^{4\\times 3}$ so that $A\\,\\dot{m}(t)=d(t)$ for each hour $t$, where $\\dot{m}(t)=\\begin{bmatrix}\\dot{m}_{e_1}(t)&\\dot{m}_{e_2}(t)&\\dot{m}_{e_3}(t)\\end{bmatrix}^{\\top}$ and $d(t)=\\begin{bmatrix}-\\dot{m}_{\\mathrm{dem}}(t)&0&0&+\\dot{m}_{\\mathrm{dem}}(t)\\end{bmatrix}^{\\top}$. The oriented incidence matrix for the chain is\n$$\nA=\\begin{bmatrix}\n-1 & 0 & 0\\\\\n+1 & -1 & 0\\\\\n0 & +1 & -1\\\\\n0 & 0 & +1\n\\end{bmatrix}.\n$$\n- Linearized steady-state pipeline flow laws (a first-order approximation of the momentum balance under turbulent but quasi-steady conditions) give\n$$\n\\dot{m}_{e}(t)=K_e\\left(p_{\\mathrm{in},e}(t)-p_{\\mathrm{out},e}(t)\\right),\n$$\nfor edges $e\\in\\{e_1,e_3\\}$ with conductances $K_e$ in $\\mathrm{kg}/(\\mathrm{s}\\cdot\\mathrm{Pa})$ and pressures in $\\mathrm{Pa}$.\n- The compressor on $e_2$ enforces\n$$\np_2(t)=r(t)\\,p_1(t),\\quad r(t)\\geq 1,\n$$\nwith mass conservation across the compressor $\\dot{m}_{e_2}(t)=\\dot{m}_{e_1}(t)=\\dot{m}_{e_3}(t)$.\n- Isentropic compression power for hydrogen with ideal-gas behavior is modeled as\n$$\nP(t)=\\frac{\\dot{m}(t)\\,c_p\\,T_{\\mathrm{in}}}{\\eta}\\left(r(t)^{\\frac{\\gamma-1}{\\gamma}}-1\\right),\n$$\nwhere $\\gamma$ is the ratio of specific heats, $c_p$ is the specific heat at constant pressure, $T_{\\mathrm{in}}$ is inlet temperature, and $\\eta$ is compressor isentropic efficiency.\n\nFrom the nodal continuity and edge orientation, the chain incidence implies $\\dot{m}_{e_1}(t)=\\dot{m}_{e_2}(t)=\\dot{m}_{e_3}(t)=\\dot{m}(t)=\\dot{m}_{\\mathrm{dem}}(t)$ for all $t$. The upstream pipeline relation gives\n$$\np_1(t)=p_0-\\frac{\\dot{m}(t)}{K_1}.\n$$\nThe downstream pipeline relation and pressure requirement at $n_3$ lead to\n$$\n\\dot{m}(t)=K_2\\big(p_2(t)-p_3(t)\\big)=K_2\\big(r(t)\\,p_1(t)-p_3(t)\\big),\\quad p_3(t)\\geq p_{\\min}.\n$$\nBecause the compressor power $P(t)$ is strictly increasing in $r(t)$ for $r(t)\\geq 1$, the energy-minimizing set point $r(t)$ that still meets the demand chooses the smallest $r(t)$ consistent with the downstream pipeline and pressure constraint. If the minimum pressure is binding, this yields the required ratio\n$$\nr_{\\mathrm{req}}(t)=\\frac{\\frac{\\dot{m}(t)}{K_2}+p_{\\min}}{p_1(t)}.\n$$\nTherefore, the optimal compressor set point at hour $t$ is\n$$\nr^{\\star}(t)=\\max\\left(1,\\,\\min\\left(r_{\\max},\\,r_{\\mathrm{req}}(t)\\right)\\right),\n$$\nprovided feasibility holds, which requires $p_1(t)>0$ and $r_{\\mathrm{req}}(t)\\leq r_{\\max}$. If $r_{\\mathrm{req}}(t)\\leq 1$, then $r^{\\star}(t)=1$ and the downstream pressure adjusts to $p_3(t)=r^{\\star}(t)p_1(t)-\\dot{m}(t)/K_2\\geq p_{\\min}$; if $r_{\\mathrm{req}}(t)>r_{\\max}$ or $p_1(t)\\leq 0$, the hour is infeasible under the given limits.\n\nTask: Implement a program that, for each hour $t\\in\\{1,\\dots,24\\}$ and each test case, computes $r^{\\star}(t)$, the compressor power $P(t)$, and the total compressor energy over $24$ hours in megawatt-hour ($\\mathrm{MWh}$). The total energy in $\\mathrm{MWh}$ for a case is\n$$\nE_{\\mathrm{MWh}}=\\sum_{t=1}^{24}\\frac{P(t)}{10^{6}}.\n$$\nIf any hour in a test case is infeasible, the program must return $-1.0$ for that case.\n\nPhysical constants and parameters (common to all test cases):\n- $\\gamma=1.41$,\n- $c_p=14300\\,\\mathrm{J}/(\\mathrm{kg}\\cdot\\mathrm{K})$,\n- $T_{\\mathrm{in}}=300\\,\\mathrm{K}$,\n- $\\eta=0.70$,\n- $p_0=7.0\\times 10^{6}\\,\\mathrm{Pa}$,\n- $p_{\\min}=2.0\\times 10^{6}\\,\\mathrm{Pa}$,\n- $K_1=5.0\\times 10^{-8}\\,\\mathrm{kg}/(\\mathrm{s}\\cdot\\mathrm{Pa})$,\n- $K_2=4.0\\times 10^{-8}\\,\\mathrm{kg}/(\\mathrm{s}\\cdot\\mathrm{Pa})$,\n- $r_{\\max}=2.5$.\n\nTest suite:\n- Test case $1$ (general case): hourly demands $\\dot{m}_{\\mathrm{dem}}(t)$ in $\\mathrm{kg}/\\mathrm{s}$ are\n$$\n\\big[\\,0.08,\\,0.08,\\,0.09,\\,0.09,\\,0.10,\\,0.12,\\,0.15,\\,0.18,\\,0.20,\\,0.18,\\,0.15,\\,0.12,\\,0.10,\\,0.09,\\,0.08,\\,0.08,\\,0.09,\\,0.12,\\,0.15,\\,0.18,\\,0.20,\\,0.18,\\,0.12,\\,0.10\\,\\big].\n$$\n- Test case $2$ (boundary low flow): hourly demands in $\\mathrm{kg}/\\mathrm{s}$ are\n$$\n\\big[\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02,\\,0.02\\,\\big].\n$$\n- Test case $3$ (infeasible high flow): hourly demands in $\\mathrm{kg}/\\mathrm{s}$ are\n$$\n\\big[\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25,\\,0.25\\,\\big].\n$$\n\nRequired final output format: Your program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets, for example $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$. Each entry must be a floating-point number representing total energy in $\\mathrm{MWh}$ for the corresponding test case, with the convention that infeasible cases are reported as $-1.0$.",
            "solution": "The problem is deemed valid as it is scientifically grounded in established principles of fluid dynamics and thermodynamics, well-posed with a clear computational path, and specified with all necessary objective data and constants.\n\nThe objective is to compute the total energy consumed by a hydrogen compressor in a serial transmission network over a $24$-hour period for three distinct hourly demand scenarios. The calculation proceeds by analyzing the system's state at each hour, checking for operational feasibility, and then determining the energy-optimal compressor setting.\n\nThe methodology for each test case involves a sequential, hour-by-hour analysis. For each hour $t \\in \\{1, \\dots, 24\\}$, given the mass demand $\\dot{m}_{\\mathrm{dem}}(t)$:\n\n1.  **Mass Flow Uniformity**: The problem describes a serial network ($n_0 \\to n_1 \\to n_2 \\to n_3$) with no intermediate storage or injections/withdrawals at nodes $n_1$ and $n_2$. The principle of mass conservation, formalized by the given incidence matrix $A$, dictates that the mass flow rate must be constant along all edges of the chain. Therefore, the flow through each component is equal to the end-use demand:\n    $$\n    \\dot{m}(t) = \\dot{m}_{e_1}(t) = \\dot{m}_{e_2}(t) = \\dot{m}_{e_3}(t) = \\dot{m}_{\\mathrm{dem}}(t).\n    $$\n\n2.  **Compressor Inlet Pressure**: The pressure at the compressor inlet, $p_1(t)$, is determined by the pressure drop across the upstream pipeline ($e_1$). Applying the provided linearized steady-state flow law, we can express $p_1(t)$ in terms of the fixed source pressure $p_0$ and the mass flow rate $\\dot{m}(t)$:\n    $$\n    \\dot{m}(t) = K_1 \\left( p_0 - p_1(t) \\right) \\implies p_1(t) = p_0 - \\frac{\\dot{m}(t)}{K_1}.\n    $$\n    A fundamental feasibility condition is that the pressure must remain positive, thus $p_1(t) > 0$. If the calculated $p_1(t)$ is non-positive, the demanded flow rate is physically impossible to achieve with the given source pressure and pipeline conductance, rendering the scenario infeasible for that hour.\n\n3.  **Required Compression Ratio**: To minimize energy consumption, the compressor should operate at the lowest possible compression ratio $r(t)$ that satisfies all downstream constraints. The critical constraint is maintaining the pressure at the final node $n_3$ at or above a minimum threshold, $p_3(t) \\geq p_{\\min}$. The energy-optimal strategy sets $p_3(t) = p_{\\min}$. Using the flow law for the downstream pipeline ($e_3$) and the compressor pressure relation $p_2(t) = r(t)p_1(t)$, we derive the required ratio, $r_{\\mathrm{req}}(t)$:\n    $$\n    \\dot{m}(t) = K_2 \\left( p_2(t) - p_3(t) \\right) = K_2 \\left( r(t)p_1(t) - p_{\\min} \\right).\n    $$\n    Solving for $r(t)$ gives the required ratio for this binding condition:\n    $$\n    r_{\\mathrm{req}}(t) = \\frac{\\frac{\\dot{m}(t)}{K_2} + p_{\\min}}{p_1(t)}.\n    $$\n\n4.  **Operational Feasibility**: The compressor has a maximum mechanical limit on its compression ratio, $r_{\\max}$. If the required ratio $r_{\\mathrm{req}}(t)$ exceeds this limit, the system cannot meet the demand and pressure requirements simultaneously. Therefore, a second feasibility condition is $r_{\\mathrm{req}}(t) \\leq r_{\\max}$. If either this condition or the $p_1(t)>0$ condition fails for any hour, the entire $24$-hour scenario is considered infeasible.\n\n5.  **Optimal Compressor Set Point**: The actual operating compression ratio, $r^{\\star}(t)$, must be at least $1$ (as compressors do not expand gas), must meet the system requirement (i.e., be at least $r_{\\mathrm{req}}(t)$ if $r_{\\mathrm{req}}(t)>1$), and cannot exceed $r_{\\max}$. The problem provides the complete logic for selecting the optimal ratio:\n    $$\n    r^{\\star}(t) = \\max\\left(1, \\min\\left(r_{\\max}, r_{\\mathrm{req}}(t)\\right)\\right).\n    $$\n    For a feasible hour, where $r_{\\mathrm{req}}(t) \\le r_{\\max}$, this simplifies to $r^{\\star}(t) = \\max(1, r_{\\mathrm{req}}(t))$. If $r_{\\mathrm{req}}(t) \\leq 1$, no compression is needed, so $r^{\\star}(t)=1$ and the compressor is effectively bypassed.\n\n6.  **Hourly Power Consumption**: The power $P(t)$ needed to drive the compressor at the set point $r^{\\star}(t)$ is calculated using the given formula for isentropic compression, which accounts for the gas properties ($\\gamma$, $c_p$), inlet conditions ($T_{\\mathrm{in}}$), and compressor efficiency ($\\eta$):\n    $$\n    P(t) = \\frac{\\dot{m}(t) c_p T_{\\mathrm{in}}}{\\eta} \\left( (r^{\\star}(t))^{\\frac{\\gamma-1}{\\gamma}} - 1 \\right).\n    $$\n    The power $P(t)$ is in Watts. Note that if $r^{\\star}(t)=1$, the term in the parentheses becomes zero, and thus $P(t)=0$, which is physically correct.\n\n7.  **Total Energy Calculation**: The problem defines discrete one-hour time steps. The energy consumed in hour $t$ is $E(t) = P(t) \\times (1\\,\\mathrm{hour})$. The total energy in Watt-hours over the $24$-hour period is the sum of the hourly power values: $E_{\\mathrm{Wh}} = \\sum_{t=1}^{24} P(t)$. To express this in Megawatt-hours (MWh), we divide by $10^6$:\n    $$\n    E_{\\mathrm{MWh}} = \\frac{E_{\\mathrm{Wh}}}{10^6} = \\frac{\\sum_{t=1}^{24} P(t)}{10^6},\n    $$\n    which aligns with the formula provided. If any hour is found to be infeasible, the calculation for that test case terminates, and the total energy is reported as $-1.0$.\n\nThis structured, step-by-step procedure is implemented for each test case to arrive at the final results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the total compressor energy for hydrogen transmission\n    over a 24-hour horizon for multiple test cases.\n    \"\"\"\n    # Define physical constants and system parameters\n    gamma = 1.41  # Ratio of specific heats for H2\n    c_p = 14300.0  # Specific heat at constant pressure [J/(kg*K)]\n    T_in = 300.0  # Compressor inlet temperature [K]\n    eta = 0.70  # Compressor isentropic efficiency\n    p_0 = 7.0e6  # Source pressure [Pa]\n    p_min = 2.0e6  # Minimum delivery pressure [Pa]\n    K1 = 5.0e-8  # Conductance of pipeline e1 [kg/(s*Pa)]\n    K2 = 4.0e-8  # Conductance of pipeline e2 [kg/(s*Pa)]\n    r_max = 2.5  # Maximum compression ratio\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Test case 1 (general case)\n        np.array([\n            0.08, 0.08, 0.09, 0.09, 0.10, 0.12, 0.15, 0.18, 0.20, 0.18,\n            0.15, 0.12, 0.10, 0.09, 0.08, 0.08, 0.09, 0.12, 0.15, 0.18,\n            0.20, 0.18, 0.12, 0.10\n        ]),\n        # Test case 2 (boundary low flow)\n        np.array([0.02] * 24),\n        # Test case 3 (infeasible high flow)\n        np.array([0.25] * 24),\n    ]\n\n    results = []\n    \n    # Pre-calculate terms for power calculation\n    power_exponent = (gamma - 1) / gamma\n    power_coeff = (c_p * T_in) / eta\n\n    for m_dem_profile in test_cases:\n        total_power_Wh = 0.0\n        is_infeasible = False\n        \n        for t in range(24):\n            m_dot = m_dem_profile[t]  # Mass flow rate for the current hour [kg/s]\n\n            # Step 1: Calculate compressor inlet pressure\n            p1 = p_0 - (m_dot / K1)\n\n            # Step 2: Feasibility Check 1 (inlet pressure)\n            if p1 = 0:\n                is_infeasible = True\n                break\n\n            # Step 3: Calculate required compression ratio\n            r_req = ((m_dot / K2) + p_min) / p1\n\n            # Step 4: Feasibility Check 2 (maximum ratio)\n            if r_req > r_max:\n                is_infeasible = True\n                break\n\n            # Step 5: Determine optimal compressor set point\n            # Per problem: r_star = max(1, min(r_max, r_req))\n            # Since feasibility check r_req = r_max has passed, this simplifies.\n            r_star = max(1.0, r_req)\n            \n            # Step 6: Calculate hourly power consumption in Watts\n            # P(t) = (m_dot * c_p * T_in / eta) * (r_star^((gamma-1)/gamma) - 1)\n            if r_star > 1.0:\n                power_W = m_dot * power_coeff * (r_star**power_exponent - 1.0)\n            else:\n                power_W = 0.0\n            \n            # The sum of powers in Watts gives total energy in Watt-hours\n            # for 1-hour time intervals.\n            total_power_Wh += power_W\n\n        if is_infeasible:\n            results.append(-1.0)\n        else:\n            # Step 7: Convert total energy from Watt-hours to Megawatt-hours\n            total_energy_MWh = total_power_Wh / 1e6\n            results.append(total_energy_MWh)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}