{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的可计算一般均衡（CGE）模型之前，理解经济体各部门之间相互关联的结构至关重要。本练习将引导您应用核心的投入产出（I-O）框架，通过计算列昂惕夫逆矩阵 $(I-A)^{-1}$ 来量化最终需求的变动如何传导至整个经济体。通过这个实践 ，您将掌握总需求乘数的概念，这是评估政策对经济总体产出影响的基础。",
            "id": "4079489",
            "problem": "考虑一个用于能源系统政策分析的可计算一般均衡 (CGE) 模型中的两部门混合能源-经济投入产出 (IO) 核心。这两个部门是一个能源部门和一个综合非能源部门。设总产出向量为 $x \\in \\mathbb{R}^{2}$，最终需求向量为 $y \\in \\mathbb{R}^{2}$，技术系数矩阵为 $A \\in \\mathbb{R}^{2 \\times 2}$。技术系数 $a_{ij}$ 表示部门 $j$ 每单位总产出所需来自部门 $i$ 的投入。该模型由基本 IO 核算恒等式给出，即总产出等于中间需求加最终需求。\n\n假设经济由以下技术系数表征：\n$$\nA \\;=\\; \\begin{pmatrix}\n0.25   0.10\\\\\n0.20   0.30\n\\end{pmatrix},\n$$\n其中第一行/列代表能源部门，第二行/列代表非能源部门。考虑一个仅提高非能源部门最终需求的政策冲击，最终需求向量为\n$$\ny \\;=\\; \\begin{pmatrix} 0 \\\\ 101 \\end{pmatrix},\n$$\n单位为十亿2015年美元。\n\n任务：\n1. 仅从 IO 核算恒等式出发，推导用 $A$ 和 $y$ 表示 $x$ 的闭式表达式，并陈述该表达式良定义的一个充分条件。\n2. 显式计算矩阵 $(I - A)^{-1}$，并用它来求得由给定 $A$ 和 $y$ 所蕴含的总产出向量 $x$。\n3. 将 $(I - A)^{-1}$ 的元素解释为总需求乘数，说明在响应每个部门一单位最终需求时，每个元素对能源和非能源部门意味着什么。\n4. 在此政策冲击下，能源部门的总产出 $x_{\\text{energy}}$ 是多少？报告一个四舍五入到四位有效数字的单一数值。以十亿2015年美元为单位表示你的答案。",
            "solution": "该问题提出了一个用于两部门经济的标准列昂惕夫投入产出 (IO) 模型。将按顺序完成这些任务。\n\n基本 IO 核算恒等式表明，一个经济体的总产出等于中间需求与最终需求之和。这可以用矩阵形式表示为：\n$$\nx = Ax + y\n$$\n其中 $x$ 是总产出向量，$A$ 是技术系数矩阵，$y$ 是最终需求向量。\n\n**任务1：推导 $x$ 的闭式表达式及其存在条件。**\n\n我们从 IO 核算恒等式开始：\n$$\nx = Ax + y\n$$\n为了求解总产出向量 $x$，我们重新整理方程，将所有包含 $x$ 的项移到一边：\n$$\nx - Ax = y\n$$\n使用矩阵代数的性质，提出向量 $x$，其中 $I$ 是与 $A$ 维度相同的单位矩阵：\n$$\nIx - Ax = y\n$$\n$$\n(I - A)x = y\n$$\n矩阵 $(I - A)$ 被称为列昂惕夫矩阵。为了分离出 $x$，我们可以在方程两边左乘列昂惕夫矩阵的逆矩阵 $(I - A)^{-1}$，前提是该逆矩阵存在。\n$$\n(I - A)^{-1}(I - A)x = (I - A)^{-1}y\n$$\n这可以化简为总产出向量的闭式表达式：\n$$\nx = (I - A)^{-1}y\n$$\n该表达式良定义且 $x$ 存在唯一解的一个充分条件是列昂惕夫矩阵 $(I - A)$ 必须是非奇异的，即它必须是可逆的。这等价于其行列式不为零的条件：\n$$\n\\det(I - A) \\neq 0\n$$\n在投入产出分析的背景下，为了使解具有经济意义（即对于任何非负的最终需求，产出都为非负），必须满足霍金斯-西蒙条件。该条件要求矩阵 $(I-A)$ 的所有主子式都为正。对于一个 $2 \\times 2$ 矩阵，这意味着 $(I-A)$ 的对角元素必须为正，且其行列式必须为正。\n\n**任务2：计算 $(I - A)^{-1}$ 和总产出向量 $x$。**\n\n给定技术系数矩阵：\n$$\nA = \\begin{pmatrix} 0.25   0.10 \\\\ 0.20   0.30 \\end{pmatrix}\n$$\n首先，我们计算列昂惕夫矩阵 $(I - A)$：\n$$\nI - A = \\begin{pmatrix} 1   0 \\\\ 0   1 \\end{pmatrix} - \\begin{pmatrix} 0.25   0.10 \\\\ 0.20   0.30 \\end{pmatrix} = \\begin{pmatrix} 1-0.25   -0.10 \\\\ -0.20   1-0.30 \\end{pmatrix} = \\begin{pmatrix} 0.75   -0.10 \\\\ -0.20   0.70 \\end{pmatrix}\n$$\n接下来，我们计算 $(I - A)$ 的行列式：\n$$\n\\det(I - A) = (0.75)(0.70) - (-0.10)(-0.20) = 0.525 - 0.02 = 0.505\n$$\n由于 $\\det(I - A) = 0.505 \\neq 0$，该矩阵是可逆的。一个通用的 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a   b \\\\ c   d \\end{pmatrix}$ 的逆是 $\\frac{1}{ad-bc} \\begin{pmatrix} d   -b \\\\ -c   a \\end{pmatrix}$。应用此公式：\n$$\n(I - A)^{-1} = \\frac{1}{0.505} \\begin{pmatrix} 0.70   0.10 \\\\ 0.20   0.75 \\end{pmatrix}\n$$\n为了用精确分数表示，我们注意到 $0.505 = \\frac{505}{1000} = \\frac{101}{200}$。因此，$\\frac{1}{0.505} = \\frac{200}{101}$。\n$$\n(I - A)^{-1} = \\frac{200}{101} \\begin{pmatrix} 0.70   0.10 \\\\ 0.20   0.75 \\end{pmatrix} = \\begin{pmatrix} \\frac{200 \\times 0.70}{101}   \\frac{200 \\times 0.10}{101} \\\\ \\frac{200 \\times 0.20}{101}   \\frac{200 \\times 0.75}{101} \\end{pmatrix} = \\begin{pmatrix} \\frac{140}{101}   \\frac{20}{101} \\\\ \\frac{40}{101}   \\frac{150}{101} \\end{pmatrix}\n$$\n现在，我们使用给定的最终需求向量 $y = \\begin{pmatrix} 0 \\\\ 101 \\end{pmatrix}$ 来计算总产出向量 $x$：\n$$\nx = (I - A)^{-1}y = \\begin{pmatrix} \\frac{140}{101}   \\frac{20}{101} \\\\ \\frac{40}{101}   \\frac{150}{101} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 101 \\end{pmatrix}\n$$\n$$\nx = \\begin{pmatrix} (\\frac{140}{101})(0) + (\\frac{20}{101})(101) \\\\ (\\frac{40}{101})(0) + (\\frac{150}{101})(101) \\end{pmatrix} = \\begin{pmatrix} 0 + 20 \\\\ 0 + 150 \\end{pmatrix} = \\begin{pmatrix} 20 \\\\ 150 \\end{pmatrix}\n$$\n因此，总产出向量为 $x = \\begin{pmatrix} 20 \\\\ 150 \\end{pmatrix}$。\n\n**任务3：解释 $(I - A)^{-1}$ 的元素。**\n\n矩阵 $(I - A)^{-1}$，被称为列昂惕夫逆矩阵或总需求矩阵，它量化了为向最终需求交付一单位产出，每个部门所需的总产出。设 $L^{-1} = (I - A)^{-1}$。元素 $L^{-1}_{ij}$ 表示为满足对部门 $j$ 产品的一单位最终需求，部门 $i$ 需要直接和间接提供的总产出。\n\n计算出的总需求矩阵为：\n$$\n(I - A)^{-1} = \\begin{pmatrix} \\frac{140}{101}   \\frac{20}{101} \\\\ \\frac{40}{101}   \\frac{150}{101} \\end{pmatrix} \\approx \\begin{pmatrix} 1.3861   0.1980 \\\\ 0.3960   1.4851 \\end{pmatrix}\n$$\n每个元素的解释如下：\n- $L^{-1}_{11} \\approx 1.3861$：为向最终需求交付一单位（例如10亿美元）的能源部门产出，能源部门本身需要提供总计约 $1.3861$ 单位的总产出。这包括用于最终需求的一单位，以及在整个生产链中作为中间投入所需的 $0.3861$ 单位。\n- $L^{-1}_{12} \\approx 0.1980$：为向最终需求交付一单位的非能源部门产出，需要能源部门提供总计约 $0.1980$ 单位的总产出作为间接投入。这反映了非能源部门的能源强度。\n- $L^{-1}_{21} \\approx 0.3960$：为向最终需求交付一单位的能源部门产出，需要非能源部门提供总计约 $0.3960$ 单位的总产出作为间接投入。\n- $L^{-1}_{22} \\approx 1.4851$：为向最终需求交付一单位的非能源部门产出，非能源部门本身需要提供总计约 $1.4851$ 单位的总产出。\n\n这些是捕捉最终需求变化在整个经济中产生的完全连锁反应的乘数。\n\n**任务4：能源部门的总产出 $x_{\\text{energy}}$。**\n\n能源部门被指定为第一部门。因此，其总产出是向量 $x$ 的第一个分量，记为 $x_{\\text{energy}}$ 或 $x_1$。根据任务2的计算：\n$$\nx = \\begin{pmatrix} x_{\\text{energy}} \\\\ x_{\\text{non-energy}} \\end{pmatrix} = \\begin{pmatrix} 20 \\\\ 150 \\end{pmatrix}\n$$\n所以，能源部门的总产出恰好是 $20$。\n单位被指定为十亿2015年美元。因此，$x_{\\text{energy}} = 20$ 十亿2015年美元。\n问题要求将答案报告为一个四舍五入到四位有效数字的单一数值。精确值是 $20$。为了用四位有效数字表示，我们将其写为 $20.00$。",
            "answer": "$$\\boxed{20.00}$$"
        },
        {
            "introduction": "在掌握了经济的生产结构后，我们的焦点转向需求侧以及价格如何引导市场达到均衡。此练习将经济环境简化为一个“纯交换”模型，旨在揭示一般均衡理论的核心机制：价格如何自发调整，以确保在所有参与者（此处为家庭）最大化自身效用的同时，所有商品市场都能出清。通过求解瓦尔拉斯均衡价格与配置 ，您将深入理解价格在资源配置中的关键作用。",
            "id": "4079484",
            "problem": "考虑一个纯交换经济体，它代表了能源系统可计算一般均衡 (CGE) 模型中的一个程式化需求模块。存在两种商品：能源聚合商品 $E$ 和非能源复合商品 $M$。价格分别用 $p_E$ 和 $p_M$ 表示。将 $p_M \\equiv 1$ 标准化，并定义价格比 $p \\equiv p_E/p_M$。有两个家庭，A 和 B，它们对 $(E,M)$ 具有柯布-道格拉斯偏好，这些偏好捕捉了异质性的能源强度：\n- 家庭 A 的效用函数为 $U_A(E_A,M_A) = E_A^{\\frac{2}{5}} M_A^{\\frac{3}{5}}$，禀赋为 $(\\bar{E}_A,\\bar{M}_A) = (8,2)$。\n- 家庭 B 的效用函数为 $U_B(E_B,M_B) = E_B^{\\frac{7}{10}} M_B^{\\frac{3}{10}}$，禀赋为 $(\\bar{E}_B,\\bar{M}_B) = (2,8)$。\n\n家庭是价格接受者，他们在预算约束下最大化其效用，其中收入等于其禀赋在现行价格下的价值。该经济体中的瓦尔拉斯均衡包括分配 $(E_A^{\\ast},M_A^{\\ast},E_B^{\\ast},M_B^{\\ast})$ 和价格比 $p^{\\ast}$，使得：\n- 每个家庭的分配在给定价格和收入的情况下解决了其效用最大化问题。\n- 市场出清：$E_A^{\\ast} + E_B^{\\ast} = \\bar{E}_A + \\bar{E}_B$ 且 $M_A^{\\ast} + M_B^{\\ast} = \\bar{M}_A + \\bar{M}_B$。\n- 每个家庭的预算一致性成立：$p E_h^{\\ast} + 1 \\cdot M_h^{\\ast} = p \\bar{E}_h + 1 \\cdot \\bar{M}_h$ 对于 $h \\in \\{A,B\\}$。\n\n从消费者选择的第一性原理（线性预算下的效用最大化）以及市场出清和预算可行性的定义出发，计算瓦尔拉斯均衡价格比 $p^{\\ast}$ 和均衡分配 $(E_A^{\\ast},M_A^{\\ast},E_B^{\\ast},M_B^{\\ast})$。\n\n答案格式要求：\n- 以单行矩阵的形式提供最终答案，顺序为 $(p^{\\ast}, E_A^{\\ast}, M_A^{\\ast}, E_B^{\\ast}, M_B^{\\ast})$。\n- 给出化简分数形式的精确值。不允许四舍五入。\n- 将所有量报告为纯数（无量纲）。根据定义，价格比是无量纲的。",
            "solution": "### 求解推导\n求解过程首先推导每个家庭的马歇尔需求函数，然后使用市场出清条件求解均衡价格比 $p^{\\ast}$，最后计算均衡分配。\n\n一个具有柯布-道格拉斯效用函数 $U(x_1, x_2) = x_1^{\\alpha} x_2^{1-\\alpha}$、面临价格 $p_1, p_2$ 且收入为 $I$ 的家庭，将具有以下马歇尔需求函数：\n$$\nx_1(p_1, p_2, I) = \\frac{\\alpha I}{p_1}\n$$\n$$\nx_2(p_1, p_2, I) = \\frac{(1-\\alpha) I}{p_2}\n$$\n我们将此一般结果应用于家庭 A 和 B。\n\n**1. 家庭 A 的需求**\n效用函数为 $U_A(E_A,M_A) = E_A^{\\frac{2}{5}} M_A^{\\frac{3}{5}}$，因此能源的指数为 $\\alpha_A = \\frac{2}{5}$。\n价格为 $p_E = p$ 和 $p_M = 1$。\n家庭 A 的收入 $I_A$ 是其禀赋的价值：\n$$\nI_A = p \\bar{E}_A + p_M \\bar{M}_A = p(8) + (1)(2) = 8p+2\n$$\n家庭 A 的马歇尔需求函数为：\n$$\nE_A(p, I_A) = \\frac{\\alpha_A I_A}{p} = \\frac{\\frac{2}{5}(8p+2)}{p} = \\frac{16p+4}{5p}\n$$\n$$\nM_A(p, I_A) = \\frac{(1-\\alpha_A) I_A}{1} = \\frac{\\frac{3}{5}(8p+2)}{1} = \\frac{24p+6}{5}\n$$\n\n**2. 家庭 B 的需求**\n效用函数为 $U_B(E_B,M_B) = E_B^{\\frac{7}{10}} M_B^{\\frac{3}{10}}$，因此能源的指数为 $\\alpha_B = \\frac{7}{10}$。\n家庭 B 的收入 $I_B$ 是其禀赋的价值：\n$$\nI_B = p \\bar{E}_B + p_M \\bar{M}_B = p(2) + (1)(8) = 2p+8\n$$\n家庭 B 的马歇尔需求函数为：\n$$\nE_B(p, I_B) = \\frac{\\alpha_B I_B}{p} = \\frac{\\frac{7}{10}(2p+8)}{p} = \\frac{14p+56}{10p} = \\frac{7p+28}{5p}\n$$\n$$\nM_B(p, I_B) = \\frac{(1-\\alpha_B) I_B}{1} = \\frac{\\frac{3}{10}(2p+8)}{1} = \\frac{6p+24}{10} = \\frac{3p+12}{5}\n$$\n\n**3. 市场出清与均衡价格**\n在均衡状态下，一种商品的总禀赋必须等于该商品的需求总和。根据瓦尔拉斯定律，如果一个市场出清，另一个市场也必须出清。我们使用能源市场 $E$ 来找到均衡价格比 $p^{\\ast}$。\n能源的总禀赋为 $\\bar{E}_{\\text{total}} = \\bar{E}_A + \\bar{E}_B = 8+2 = 10$。\n市场出清条件是 $E_A(p^{\\ast}) + E_B(p^{\\ast}) = \\bar{E}_{\\text{total}}$：\n$$\n\\frac{16p^{\\ast}+4}{5p^{\\ast}} + \\frac{7p^{\\ast}+28}{5p^{\\ast}} = 10\n$$\n合并左侧的项：\n$$\n\\frac{(16p^{\\ast}+4) + (7p^{\\ast}+28)}{5p^{\\ast}} = 10\n$$\n$$\n\\frac{23p^{\\ast}+32}{5p^{\\ast}} = 10\n$$\n现在，求解 $p^{\\ast}$：\n$$\n23p^{\\ast}+32 = 10(5p^{\\ast}) = 50p^{\\ast}\n$$\n$$\n32 = 50p^{\\ast} - 23p^{\\ast}\n$$\n$$\n32 = 27p^{\\ast}\n$$\n$$\np^{\\ast} = \\frac{32}{27}\n$$\n\n**4. 均衡分配**\n现在我们将均衡价格比 $p^{\\ast} = \\frac{32}{27}$ 代入需求函数，以找到均衡分配 $(E_A^{\\ast},M_A^{\\ast},E_B^{\\ast},M_B^{\\ast})$。\n\n对于家庭 A：\n$$\nE_A^{\\ast} = \\frac{16p^{\\ast}+4}{5p^{\\ast}} = \\frac{16(\\frac{32}{27})+4}{5(\\frac{32}{27})} = \\frac{\\frac{512}{27}+\\frac{108}{27}}{\\frac{160}{27}} = \\frac{\\frac{620}{27}}{\\frac{160}{27}} = \\frac{620}{160} = \\frac{62}{16} = \\frac{31}{8}\n$$\n$$\nM_A^{\\ast} = \\frac{24p^{\\ast}+6}{5} = \\frac{24(\\frac{32}{27})+6}{5} = \\frac{\\frac{8 \\times 32}{9}+6}{5} = \\frac{\\frac{256}{9}+\\frac{54}{9}}{5} = \\frac{\\frac{310}{9}}{5} = \\frac{310}{45} = \\frac{62}{9}\n$$\n\n对于家庭 B：\n$$\nE_B^{\\ast} = \\frac{7p^{\\ast}+28}{5p^{\\ast}} = \\frac{7(\\frac{32}{27})+28}{5(\\frac{32}{27})} = \\frac{\\frac{224}{27}+\\frac{756}{27}}{\\frac{160}{27}} = \\frac{\\frac{980}{27}}{\\frac{160}{27}} = \\frac{980}{160} = \\frac{98}{16} = \\frac{49}{8}\n$$\n$$\nM_B^{\\ast} = \\frac{3p^{\\ast}+12}{5} = \\frac{3(\\frac{32}{27})+12}{5} = \\frac{\\frac{32}{9}+12}{5} = \\frac{\\frac{32}{9}+\\frac{108}{9}}{5} = \\frac{\\frac{140}{9}}{5} = \\frac{140}{45} = \\frac{28}{9}\n$$\n\n均衡价格比为 $p^{\\ast} = \\frac{32}{27}$，分配为 $(E_A^{\\ast}, M_A^{\\ast}, E_B^{\\ast}, M_B^{\\ast}) = (\\frac{31}{8}, \\frac{62}{9}, \\frac{49}{8}, \\frac{28}{9})$。\n我们可以验证市场出清条件：\n$E_A^{\\ast} + E_B^{\\ast} = \\frac{31}{8} + \\frac{49}{8} = \\frac{80}{8} = 10 = \\bar{E}_{\\text{total}}$。\n$M_A^{\\ast} + M_B^{\\ast} = \\frac{62}{9} + \\frac{28}{9} = \\frac{90}{9} = 10 = \\bar{M}_{\\text{total}}$。\n条件得到满足。\n\n最终答案是行矩阵 $(p^{\\ast}, E_A^{\\ast}, M_A^{\\ast}, E_B^{\\ast}, M_B^{\\ast})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{32}{27}   \\frac{31}{8}   \\frac{62}{9}   \\frac{49}{8}   \\frac{28}{9}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "现在，我们将前两个练习中的生产结构和需求均衡概念结合起来，构建并求解一个完整的、尽管是简化的CGE模型。本练习涉及一个包含两种生产部门（采用CES生产函数）和一个代表性家庭的经济体，并引入了税收政策。您需要通过编写数值求解算法来找到能够同时出清商品市场和要素市场的均衡价格，这真实地模拟了政策分析师在评估能源或环境税影响时所采用的计算方法 。",
            "id": "4079532",
            "problem": "考虑一个封闭的、静态的双部门能源经济体，其中包含一个代表性家庭、两种主要生产要素以及从价税。$\\mathsf{E}$ 部门生产能源产品，$\\mathsf{M}$ 部门生产制造业产品。存在两种主要生产要素：劳动 $\\mathsf{L}$ 和资本 $\\mathsf{K}$，其总禀赋固定为 $\\bar{L}$ 和 $\\bar{K}$。代表性家庭非弹性地供给 $\\bar{L}$ 和 $\\bar{K}$，以一次性总额转移支付的形式获得所有税收收入，并对最终消费拥有 Cobb–Douglas 偏好。\n\n技术是规模报酬不变的，并由恒定替代弹性 (CES) 增加值生产函数描述。对于每个部门 $i \\in \\{\\mathsf{E}, \\mathsf{M}\\}$，其生产函数为\n$$\ny_i = A_i \\left[a_i L_i^{\\frac{\\sigma_i - 1}{\\sigma_i}} + (1 - a_i) K_i^{\\frac{\\sigma_i - 1}{\\sigma_i}}\\right]^{\\frac{\\sigma_i}{\\sigma_i - 1}},\n$$\n其中 $A_i  0$ 是生产率参数，$a_i \\in (0,1)$ 是劳动份额参数，$\\sigma_i  0$ 是替代弹性。在竞争性要素定价下，工资为 $w$，租金率为 $r$ 时，对于 $\\sigma_i \\neq 1$ 的情况，其对偶单位成本函数为，\n$$\nc_i(w,r) = \\frac{1}{A_i}\\left[a_i w^{1 - \\sigma_i} + (1 - a_i) r^{1 - \\sigma_i}\\right]^{\\frac{1}{1 - \\sigma_i}}.\n$$\n在 Cobb–Douglas 极限情况 $\\sigma_i = 1$ 下，单位成本函数为\n$$\nc_i(w,r) = \\frac{1}{A_i} w^{a_i} r^{1 - a_i}.\n$$\n\n税收为从价税。能源消费税率为 $\\tau_{\\mathsf{cE}} \\ge 0$，制造业产出税率为 $\\tau_{\\mathsf{oM}} \\ge 0$。所有税率必须以小数形式表示（例如，10% 的税输入为 0.10）。\n\n令 $p_{\\mathsf{E}}$ 表示能源的消费者价格，$p_{\\mathsf{M}}$ 表示制造业产品的消费者价格。将 $p_{\\mathsf{M}}$ 归一化为 1。能源生产者收到扣除消费税后的价格 $p_{\\mathsf{E}}^{p} = \\frac{p_{\\mathsf{E}}}{1 + \\tau_{\\mathsf{cE}}}$，制造业生产者收到扣除产出税后的价格 $p_{\\mathsf{M}}^{p} = \\frac{1}{1 + \\tau_{\\mathsf{oM}}}$。在完全竞争和规模报酬不变的条件下，零利润条件要求\n$$\nc_{\\mathsf{E}}(w,r) = \\frac{p_{\\mathsf{E}}}{1 + \\tau_{\\mathsf{cE}}}, \\quad c_{\\mathsf{M}}(w,r) = \\frac{1}{1 + \\tau_{\\mathsf{oM}}}.\n$$\n\n根据 Shephard 引理，部门 $i$ 的单位产出要素需求由 $L_{i}^{\\text{unit}} = \\frac{\\partial c_i}{\\partial w}$ 和 $K_{i}^{\\text{unit}} = \\frac{\\partial c_i}{\\partial r}$ 给出。对于 $\\sigma_i \\neq 1$ 的情况，它们是\n$$\nL_{i}^{\\text{unit}}(w,r) = \\frac{1}{A_i} a_i \\left[a_i w^{1 - \\sigma_i} + (1 - a_i) r^{1 - \\sigma_i}\\right]^{\\frac{\\sigma_i}{1 - \\sigma_i}} w^{-\\sigma_i},\n$$\n$$\nK_{i}^{\\text{unit}}(w,r) = \\frac{1}{A_i} (1 - a_i) \\left[a_i w^{1 - \\sigma_i} + (1 - a_i) r^{1 - \\sigma_i}\\right]^{\\frac{\\sigma_i}{1 - \\sigma_i}} r^{-\\sigma_i}.\n$$\n在 Cobb–Douglas 极限情况 $\\sigma_i = 1$ 下，单位要素需求为\n$$\nL_{i}^{\\text{unit}}(w,r) = \\frac{a_i}{A_i} \\frac{w^{a_i} r^{1 - a_i}}{w}, \\quad K_{i}^{\\text{unit}}(w,r) = \\frac{1 - a_i}{A_i} \\frac{w^{a_i} r^{1 - a_i}}{r}.\n$$\n\n代表性家庭拥有 Cobb–Douglas 效用 $U(c_{\\mathsf{E}}, c_{\\mathsf{M}}) = c_{\\mathsf{E}}^{\\beta} c_{\\mathsf{M}}^{1 - \\beta}$（其中 $\\beta \\in (0,1)$），面临消费者价格 $p_{\\mathsf{E}}$ 和 $p_{\\mathsf{M}} = 1$，其选择的支出是收入 $Y$ 的固定份额：\n$$\np_{\\mathsf{E}} c_{\\mathsf{E}} = \\beta Y, \\quad c_{\\mathsf{M}} = (1 - \\beta) Y.\n$$\n总收入是要素收入加上以一次性总额形式返还的税收收入：\n$$\nY = w \\bar{L} + r \\bar{K} + \\underbrace{\\frac{\\tau_{\\mathsf{cE}}}{1 + \\tau_{\\mathsf{cE}}} p_{\\mathsf{E}} c_{\\mathsf{E}}}_{\\text{能源消费税收入}} + \\underbrace{\\frac{\\tau_{\\mathsf{oM}}}{1 + \\tau_{\\mathsf{oM}}} \\cdot 1 \\cdot q_{\\mathsf{M}}}_{\\text{制造业产出税收入}},\n$$\n其中 $q_{\\mathsf{M}}$ 是制造业产出。商品市场出清要求 $q_{\\mathsf{E}} = c_{\\mathsf{E}}$ 和 $q_{\\mathsf{M}} = c_{\\mathsf{M}}$。要素市场出清要求 $L_{\\mathsf{E}} + L_{\\mathsf{M}} = \\bar{L}$ 和 $K_{\\mathsf{E}} + K_{\\mathsf{M}} = \\bar{K}$，其中 $L_i = q_i L_{i}^{\\text{unit}}(w,r)$ 且 $K_i = q_i K_{i}^{\\text{unit}}(w,r)$。\n\n您的程序必须计算一个竞争性一般均衡，该均衡同时满足：\n- 两个部门的零利润条件，\n- 两种商品和两种要素的市场出清，\n- 代表性家庭的收入平衡（在消费者价格下，总支出等于总收入）。\n\n为计算均衡，将 $p_{\\mathsf{E}}$ 视为未知数。对于 $p_{\\mathsf{E}}$ 的任何猜测值，求解两个零利润条件以得出 $(w,r)$，然后求解由要素市场出清所隐含的 $2 \\times 2$ 线性系统以获得 $(q_{\\mathsf{E}}, q_{\\mathsf{M}})$。利用家庭的支出规则，计算出隐含的 $p_{\\mathsf{E}}^{*} = \\frac{\\beta Y}{q_{\\mathsf{E}}}$。在均衡状态下，一致性要求 $p_{\\mathsf{E}} = p_{\\mathsf{E}}^{*}$。使用不动点迭代或求根算法来强制实现 $p_{\\mathsf{E}} = p_{\\mathsf{E}}^{*}$。\n\n按如下方式实现数值容差：如果一个条件的残差绝对值小于 $\\varepsilon = 10^{-8}$，则认为该条件已满足。\n\n设计您的解决方案，使其能为每个测试案例的三个条件生成布尔验证结果：商品和要素市场出清、零利润以及收入平衡。对于每个测试案例，输出一个列表 $[b_{\\text{mc}}, b_{\\text{zp}}, b_{\\text{ib}}]$，其中每个条目根据条件是否在容差范围内满足而取 $\\mathsf{True}$ 或 $\\mathsf{False}$。\n\n测试套件：\n- 案例 1 (基准)：\n  - $\\mathsf{E}$ 部门：$A_{\\mathsf{E}} = 1.0$, $a_{\\mathsf{E}} = 0.6$, $\\sigma_{\\mathsf{E}} = 0.8$, $\\tau_{\\mathsf{cE}} = 0.2$。\n  - $\\mathsf{M}$ 部门：$A_{\\mathsf{M}} = 1.0$, $a_{\\mathsf{M}} = 0.5$, $\\sigma_{\\mathsf{M}} = 0.7$, $\\tau_{\\mathsf{oM}} = 0.1$。\n  - 禀赋：$\\bar{L} = 100.0$, $\\bar{K} = 80.0$。\n  - 偏好：$\\beta = 0.4$。\n- 案例 2 (高能源税边界)：\n  - $\\mathsf{E}$ 部门：$A_{\\mathsf{E}} = 0.9$, $a_{\\mathsf{E}} = 0.5$, $\\sigma_{\\mathsf{E}} = 0.6$, $\\tau_{\\mathsf{cE}} = 1.0$。\n  - $\\mathsf{M}$ 部门：$A_{\\mathsf{M}} = 1.1$, $a_{\\mathsf{M}} = 0.4$, $\\sigma_{\\mathsf{M}} = 0.5$, $\\tau_{\\mathsf{oM}} = 0.0$。\n  - 禀赋：$\\bar{L} = 90.0$, $\\bar{K} = 90.0$。\n  - 偏好：$\\beta = 0.5$。\n- 案例 3 (制造业中的 Cobb–Douglas 极限情况)：\n  - $\\mathsf{E}$ 部门：$A_{\\mathsf{E}} = 1.2$, $a_{\\mathsf{E}} = 0.7$, $\\sigma_{\\mathsf{E}} = 0.3$, $\\tau_{\\mathsf{cE}} = 0.0$。\n  - $\\mathsf{M}$ 部门：$A_{\\mathsf{M}} = 0.95$, $a_{\\mathsf{M}} = 0.5$, $\\sigma_{\\mathsf{M}} = 1.0$, $\\tau_{\\mathsf{oM}} = 0.25$。\n  - 禀赋：$\\bar{L} = 110.0$, $\\bar{K} = 70.0$。\n  - 偏好：$\\beta = 0.6$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，每个元素对应一个测试案例的结果列表。例如，输出必须如下所示：\n$$\n\\texttt{[[True,True,True],[True,True,True],[True,True,True]]}.\n$$",
            "solution": "问题的核心是找到一个价格向量 $(p_{\\mathsf{E}}, w, r)$ 和数量向量 $(q_{\\mathsf{E}}, q_{\\mathsf{M}})$，使之同时满足所有均衡条件。根据问题的指引，我们选择制造业产品的价格作为计价物，$p_{\\mathsf{M}}=1$。根据瓦尔拉斯定律，如果除了一个市场之外的所有市场都处于均衡状态，那么最后一个市场也必然处于均衡状态。这使我们能够通过找到使经济达到均衡的单一相对价格 $p_{\\mathsf{E}}$ 来求解该系统。\n\n解决方案通过一个求根算法找到。我们定义一个残差函数 $f(p_{\\mathsf{E}}) = p_{\\mathsf{E}}^{\\text{guess}} - p_{\\mathsf{E}}^{\\text{implied}}$，其中均衡是一个根 $p_{\\mathsf{E}}^{eq}$，使得 $f(p_{\\mathsf{E}}^{eq})=0$。对于一个给定的 $p_{\\mathsf{E}}^{\\text{guess}}$，计算 $p_{\\mathsf{E}}^{\\text{implied}}$ 的过程如下：\n\n1.  **求解要素价格 $(w,r)$**：给定一个对 $p_{\\mathsf{E}}$ 的猜测值，生产者价格 $p_{\\mathsf{E}}^{p} = p_{\\mathsf{E}}/(1+\\tau_{\\mathsf{cE}})$ 和 $p_{\\mathsf{M}}^{p} = 1/(1+\\tau_{\\mathsf{oM}})$ 就确定了。两个零利润条件 $c_{\\mathsf{E}}(w,r)=p_{\\mathsf{E}}^p$ 和 $c_{\\mathsf{M}}(w,r)=p_{\\mathsf{M}}^p$ 构成了要素价格 $(w,r)$ 的一个非线性方程组。我们可以通过取它们的比值来简化这个系统：\n    $$\n    \\frac{c_{\\mathsf{E}}(w,r)}{c_{\\mathsf{M}}(w,r)} = \\frac{p_{\\mathsf{E}}^{p}}{p_{\\mathsf{M}}^{p}}\n    $$\n    由于成本函数是价格的一次齐次函数，这个比率仅取决于工资-租金比率 $\\omega = w/r$。\n    $$\n    \\frac{c_{\\mathsf{E}}(\\omega,1)}{c_{\\mathsf{M}}(\\omega,1)} = \\frac{p_{\\mathsf{E}}^{p}}{p_{\\mathsf{M}}^{p}} \\implies \\frac{c_{\\mathsf{E}}(\\omega,1)}{c_{\\mathsf{M}}(\\omega,1)} - \\frac{p_{\\mathsf{E}} (1+\\tau_{\\mathsf{oM}})}{(1+\\tau_{\\mathsf{cE}})} = 0\n    $$\n    这是一个关于 $\\omega$ 的单变量非线性方程，可以使用数值求根器高效求解。一旦求得 $\\omega$，我们可以使用第二个零利润条件求解 $r$：$c_{\\mathsf{M}}(w,r) = r \\cdot c_{\\mathsf{M}}(\\omega,1) = p_{\\mathsf{M}}^{p}$，得出 $r = p_{\\mathsf{M}}^{p} / c_{\\mathsf{M}}(\\omega,1)$。最后，$w = \\omega r$。\n\n2.  **计算单位要素需求**：在确定了均衡要素价格 $(w,r)$ 后，我们可以使用提供的公式计算每个部门 $i \\in \\{\\mathsf{E}, \\mathsf{M}\\}$ 的单位要素需求 $L_i^{\\text{unit}}$ 和 $K_i^{\\text{unit}}$，并小心处理 $\\sigma_i = 1$ 的特殊情况。\n\n3.  **求解部门产出 $(q_{\\mathsf{E}}, q_{\\mathsf{M}})$**：要素市场出清条件 $L_{\\mathsf{E}}^{\\text{unit}} q_{\\mathsf{E}} + L_{\\mathsf{M}}^{\\text{unit}} q_{\\mathsf{M}} = \\bar{L}$ 和 $K_{\\mathsf{E}}^{\\text{unit}} q_{\\mathsf{E}} + K_{\\mathsf{M}}^{\\text{unit}} q_{\\mathsf{M}} = \\bar{K}$ 构成了关于部门产出 $(q_{\\mathsf{E}}, q_{\\mathsf{M}})$ 的一个 $2 \\times 2$ 线性方程组。该系统可使用标准线性代数方法求解。\n\n4.  **计算隐含的能源价格 $p_{\\mathsf{E}}^*$**：我们计算家庭总收入 $Y$，即要素收入和返还的税收之和。\n    $$\n    Y = w \\bar{L} + r \\bar{K} + \\tau_{\\mathsf{cE}} p_{\\mathsf{E}}^{p} q_{\\mathsf{E}} + \\tau_{\\mathsf{oM}} p_{\\mathsf{M}}^{p} q_{\\mathsf{M}}\n    $$\n    家庭的 Cobb-Douglas 偏好意味着它将其收入的固定比例 $\\beta$ 用于能源产品上：$p_{\\mathsf{E}} c_{\\mathsf{E}} = \\beta Y$。假设商品市场出清 ($q_{\\mathsf{E}} = c_{\\mathsf{E}}$)，这个支出规则隐含了一个使市场出清的能源价格：\n    $$\n    p_{\\mathsf{E}}^{*} = \\frac{\\beta Y}{q_{\\mathsf{E}}}\n    $$\n    这是与猜测价格 $p_{\\mathsf{E}}^{\\text{guess}}$ 一致的隐含价格。\n\n5.  **寻找均衡**：残差函数为 $f(p_{\\mathsf{E}}) = p_{\\mathsf{E}}^{\\text{guess}} - p_{\\mathsf{E}}^*$。我们使用一个求根算法（来自 `scipy.optimize`）来找到均衡价格 $p_{\\mathsf{E}}^{eq}$，在该价格下 $f(p_{\\mathsf{E}}^{eq}) = 0$。\n\n6.  **验证**：一旦找到均衡价格 $p_{\\mathsf{E}}^{eq}$，所有其他的均衡量都会被重新计算。然后我们验证均衡的定义条件是否在指定的容差 $\\varepsilon = 10^{-8}$ 内得到满足：\n    - **市场出清 ($b_{\\text{mc}}$)**：检查两个要素市场的残差。\n    - **零利润 ($b_{\\text{zp}}$)**：检查两个零利润条件的残差。\n    - **收入平衡 ($b_{\\text{ib}}$)**：检查家庭收入等于家庭支出 ($Y = p_{\\mathsf{E}}q_{\\mathsf{E}} + p_{\\mathsf{M}}q_{\\mathsf{M}}$) 的残差。这是瓦尔拉斯定律的一个推论，也是对计算出的解决方案整体一致性的检验。\n\n以下是实现此算法的Python代码：\n```python\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve_all_cases():\n    test_cases = [\n        { # Case 1\n            'E': {'A': 1.0, 'a': 0.6, 'sigma': 0.8, 'tau_cE': 0.2},\n            'M': {'A': 1.0, 'a': 0.5, 'sigma': 0.7, 'tau_oM': 0.1},\n            'endow': {'L_bar': 100.0, 'K_bar': 80.0},\n            'prefs': {'beta': 0.4}\n        },\n        { # Case 2\n            'E': {'A': 0.9, 'a': 0.5, 'sigma': 0.6, 'tau_cE': 1.0},\n            'M': {'A': 1.1, 'a': 0.4, 'sigma': 0.5, 'tau_oM': 0.0},\n            'endow': {'L_bar': 90.0, 'K_bar': 90.0},\n            'prefs': {'beta': 0.5}\n        },\n        { # Case 3\n            'E': {'A': 1.2, 'a': 0.7, 'sigma': 0.3, 'tau_cE': 0.0},\n            'M': {'A': 0.95, 'a': 0.5, 'sigma': 1.0, 'tau_oM': 0.25},\n            'endow': {'L_bar': 110.0, 'K_bar': 70.0},\n            'prefs': {'beta': 0.6}\n        }\n    ]\n\n    all_results = []\n    for params in test_cases:\n        result = compute_and_verify_equilibrium(params)\n        all_results.append(result)\n    \n    # This print statement is for generating the final answer string.\n    # print(str(all_results).replace(\" \", \"\"))\n\ndef compute_and_verify_equilibrium(params):\n    tol = 1e-8\n\n    def c_func(w, r, A, a, sigma):\n        if sigma == 1.0:\n            if w == 0 or r == 0: return np.inf\n            return (1/A) * (w**a) * (r**(1-a))\n        else:\n            term = a * w**(1-sigma) + (1-a) * r**(1-sigma)\n            if term = 0: return np.inf\n            return (1/A) * term**(1/(1-sigma))\n\n    def unit_input_demands_func(w, r, A, a, sigma):\n        if sigma == 1.0:\n            if w == 0 or r == 0: return np.inf, np.inf\n            c_val = c_func(w, r, A, a, sigma)\n            L_unit = a * c_val / w\n            K_unit = (1-a) * c_val / r\n        else:\n            common_term = a * w**(1-sigma) + (1-a) * r**(1-sigma)\n            if common_term = 0: return np.inf, np.inf\n            exp_term = common_term**(sigma / (1 - sigma))\n            L_unit = (1/A) * a * exp_term * w**(-sigma)\n            K_unit = (1/A) * (1-a) * exp_term * r**(-sigma)\n        return L_unit, K_unit\n\n    def get_all_vars(p_E, params):\n        p_E_p = p_E / (1 + params['E']['tau_cE'])\n        p_M_p = 1.0 / (1 + params['M']['tau_oM'])\n\n        def omega_residual(omega):\n            c_E_ratio = c_func(omega, 1, params['E']['A'], params['E']['a'], params['E']['sigma'])\n            c_M_ratio = c_func(omega, 1, params['M']['A'], params['M']['a'], params['M']['sigma'])\n            if np.isinf(c_E_ratio) or np.isinf(c_M_ratio) or c_M_ratio == 0: return 1e12\n            target_ratio = p_E_p / p_M_p\n            return c_E_ratio / c_M_ratio - target_ratio\n\n        try:\n            sol_omega = root_scalar(omega_residual, bracket=[1e-6, 1e6], method='brentq')\n            if not sol_omega.converged: return None\n            omega = sol_omega.root\n        except (ValueError, RuntimeError): return None\n        \n        c_M_ratio = c_func(omega, 1, params['M']['A'], params['M']['a'], params['M']['sigma'])\n        if c_M_ratio == 0 or np.isinf(c_M_ratio): return None\n        r = p_M_p / c_M_ratio\n        w = omega * r\n        \n        L_E_unit, K_E_unit = unit_input_demands_func(w, r, params['E']['A'], params['E']['a'], params['E']['sigma'])\n        L_M_unit, K_M_unit = unit_input_demands_func(w, r, params['M']['A'], params['M']['a'], params['M']['sigma'])\n        if any(np.isinf([L_E_unit, K_E_unit, L_M_unit, K_M_unit])): return None\n        \n        A_matrix = np.array([[L_E_unit, L_M_unit], [K_E_unit, K_M_unit]])\n        b_vector = np.array([params['endow']['L_bar'], params['endow']['K_bar']])\n        try:\n            q_vector = np.linalg.solve(A_matrix, b_vector)\n            q_E, q_M = q_vector[0], q_vector[1]\n        except np.linalg.LinAlgError: return None\n        \n        if q_E = 0 or q_M = 0: return None\n        \n        tax_rev_E = params['E']['tau_cE'] * p_E_p * q_E\n        tax_rev_M = params['M']['tau_oM'] * p_M_p * q_M\n        Y = w * params['endow']['L_bar'] + r * params['endow']['K_bar'] + tax_rev_E + tax_rev_M\n        if q_E == 0: return None\n        p_E_star = params['prefs']['beta'] * Y / q_E\n        \n        return locals()\n\n    def p_E_residual(p_E):\n        res = get_all_vars(p_E, params)\n        return p_E - res['p_E_star'] if res else 1e12\n\n    try:\n        sol_p_E = root_scalar(p_E_residual, bracket=[0.1, 10.0], method='brentq')\n        if not sol_p_E.converged: return [False, False, False]\n        p_E_eq = sol_p_E.root\n    except (ValueError, RuntimeError): return [False, False, False]\n    \n    eq_vars = get_all_vars(p_E_eq, params)\n    if eq_vars is None: return [False, False, False]\n    \n    L_demand = eq_vars['L_E_unit'] * eq_vars['q_E'] + eq_vars['L_M_unit'] * eq_vars['q_M']\n    K_demand = eq_vars['K_E_unit'] * eq_vars['q_E'] + eq_vars['K_M_unit'] * eq_vars['q_M']\n    b_mc = abs(L_demand - params['endow']['L_bar'])  tol and abs(K_demand - params['endow']['K_bar'])  tol\n    \n    c_E_val = c_func(eq_vars['w'], eq_vars['r'], params['E']['A'], params['E']['a'], params['E']['sigma'])\n    c_M_val = c_func(eq_vars['w'], eq_vars['r'], params['M']['A'], params['M']['a'], params['M']['sigma'])\n    b_zp = abs(c_E_val - eq_vars['p_E_p'])  tol and abs(c_M_val - eq_vars['p_M_p'])  tol\n    \n    expenditure = eq_vars['p_E'] * eq_vars['q_E'] + 1.0 * eq_vars['q_M']\n    b_ib = abs(expenditure - eq_vars['Y'])  tol\n\n    return [b_mc, b_zp, b_ib]\n\n# The function call solve_all_cases() is omitted here as it's meant to be run, not part of the library code.\n# Running this code would produce the expected answer.\n```",
            "answer": "$$\n\\texttt{[[True,True,True],[True,True,True],[True,True,True]]}\n$$"
        }
    ]
}