{
    "hands_on_practices": [
        {
            "introduction": "本练习是理解全经济模型中生产环节的绝佳起点。它将引导您应用经典的里昂惕夫投入产出（Input-Output）模型，该模型描述了经济中不同部门如何通过供应链相互关联。通过计算满足新增最终需求所需的总产出，您将学会使用里昂惕夫逆矩阵，并将其条目解释为总需求乘数——这是进行影响分析的基本工具。",
            "id": "4079489",
            "problem": "考虑一个用于能源系统政策分析的可计算一般均衡 (CGE) 模型中的两部门混合能源-经济投入产出 (IO) 核心。这两个部门是一个能源部门和一个综合非能源部门。设总产出向量为 $x \\in \\mathbb{R}^{2}$，最终需求向量为 $y \\in \\mathbb{R}^{2}$，技术系数矩阵为 $A \\in \\mathbb{R}^{2 \\times 2}$。技术系数 $a_{ij}$ 表示部门 $j$ 每单位总产出所需来自部门 $i$ 的投入。该模型由基本投入产出核算恒等式给出，即总产出等于中间需求加最终需求。\n\n假设经济由以下技术系数表征：\n$$\nA \\;=\\; \\begin{pmatrix}\n0.25  0.10\\\\\n0.20  0.30\n\\end{pmatrix},\n$$\n其中第一行/列代表能源部门，第二行/列代表非能源部门。考虑一个仅提高非能源部门最终需求的政策冲击，最终需求向量为\n$$\ny \\;=\\; \\begin{pmatrix} 0 \\\\ 101 \\end{pmatrix},\n$$\n以十亿2015年美元为单位。\n\n任务：\n1. 仅从投入产出核算恒等式出发，推导用 $A$ 和 $y$ 表示 $x$ 的闭式表达式，并陈述使该表达式良定义 (well-defined) 的一个充分条件。\n2. 明确计算矩阵 $(I - A)^{-1}$，并用它来求出由给定 $A$ 和 $y$ 所隐含的总产出向量 $x$。\n3. 将 $(I - A)^{-1}$ 的元素解释为总需求乘数，说明在响应每个部门一单位最终需求时，每个元素对于能源和非能源部门意味着什么。\n4. 在此政策冲击下，能源部门的总产出 $x_{\\text{energy}}$ 是多少？报告一个四舍五入到四位有效数字的单一数值。答案以十亿2015年美元表示。",
            "solution": "该问题提出了一个标准的里昂惕夫投入产出 (IO) 模型，用于一个两部门经济。各项任务将按顺序解决。\n\n基本投入产出核算恒等式指出，一个经济体的总产出等于中间需求和最终需求之和。这可以用矩阵形式表示为：\n$$\nx = Ax + y\n$$\n其中 $x$ 是总产出向量，$A$ 是技术系数矩阵，$y$ 是最终需求向量。\n\n**任务1：推导 $x$ 的闭式表达式及其存在条件。**\n\n我们从投入产出核算恒等式开始：\n$$\nx = Ax + y\n$$\n为了求解总产出向量 $x$，我们通过将所有包含 $x$ 的项移到一边来整理方程：\n$$\nx - Ax = y\n$$\n使用矩阵代数的性质提出向量 $x$，其中 $I$ 是与 $A$ 相同维度的单位矩阵：\n$$\nIx - Ax = y\n$$\n$$\n(I - A)x = y\n$$\n矩阵 $(I - A)$ 被称为里昂惕夫矩阵。为了分离出 $x$，我们可以在方程两边同时左乘里昂惕夫矩阵的逆矩阵 $(I - A)^{-1}$，前提是该逆矩阵存在。\n$$\n(I - A)^{-1}(I - A)x = (I - A)^{-1}y\n$$\n这可以简化为总产出向量的闭式表达式：\n$$\nx = (I - A)^{-1}y\n$$\n该表达式良定义且 $x$ 存在唯一解的一个充分条件是里昂惕夫矩阵 $(I - A)$ 必须是非奇异的，即它必须是可逆的。这等价于其行列式不为零的条件：\n$$\n\\det(I - A) \\neq 0\n$$\n在投入产出分析的背景下，为使解具有经济意义（即对于任何非负的最终需求，产出都为非负），必须满足 Hawkins-Simon 条件。该条件要求矩阵 $(I-A)$ 的所有主子式都为正。对于一个 $2 \\times 2$ 矩阵，这意味着 $(I-A)$ 的对角元素必须为正，且其行列式必须为正。\n\n**任务2：计算 $(I - A)^{-1}$ 和总产出向量 $x$。**\n\n给定技术系数矩阵：\n$$\nA = \\begin{pmatrix} 0.25  0.10 \\\\ 0.20  0.30 \\end{pmatrix}\n$$\n首先，我们计算里昂惕夫矩阵 $(I - A)$：\n$$\nI - A = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 0.25  0.10 \\\\ 0.20  0.30 \\end{pmatrix} = \\begin{pmatrix} 1-0.25  -0.10 \\\\ -0.20  1-0.30 \\end{pmatrix} = \\begin{pmatrix} 0.75  -0.10 \\\\ -0.20  0.70 \\end{pmatrix}\n$$\n接下来，我们计算 $(I - A)$ 的行列式：\n$$\n\\det(I - A) = (0.75)(0.70) - (-0.10)(-0.20) = 0.525 - 0.02 = 0.505\n$$\n由于 $\\det(I - A) = 0.505 \\neq 0$，该矩阵是可逆的。一个通用的 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$ 的逆是 $\\frac{1}{ad-bc} \\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$。应用此公式：\n$$\n(I - A)^{-1} = \\frac{1}{0.505} \\begin{pmatrix} 0.70  0.10 \\\\ 0.20  0.75 \\end{pmatrix}\n$$\n为了用精确分数表示，我们注意到 $0.505 = \\frac{505}{1000} = \\frac{101}{200}$。因此，$\\frac{1}{0.505} = \\frac{200}{101}$。\n$$\n(I - A)^{-1} = \\frac{200}{101} \\begin{pmatrix} 0.70  0.10 \\\\ 0.20  0.75 \\end{pmatrix} = \\begin{pmatrix} \\frac{200 \\times 0.70}{101}  \\frac{200 \\times 0.10}{101} \\\\ \\frac{200 \\times 0.20}{101}  \\frac{200 \\times 0.75}{101} \\end{pmatrix} = \\begin{pmatrix} \\frac{140}{101}  \\frac{20}{101} \\\\ \\frac{40}{101}  \\frac{150}{101} \\end{pmatrix}\n$$\n现在，我们使用给定的最终需求向量 $y = \\begin{pmatrix} 0 \\\\ 101 \\end{pmatrix}$ 来计算总产出向量 $x$：\n$$\nx = (I - A)^{-1}y = \\begin{pmatrix} \\frac{140}{101}  \\frac{20}{101} \\\\ \\frac{40}{101}  \\frac{150}{101} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 101 \\end{pmatrix}\n$$\n$$\nx = \\begin{pmatrix} (\\frac{140}{101})(0) + (\\frac{20}{101})(101) \\\\ (\\frac{40}{101})(0) + (\\frac{150}{101})(101) \\end{pmatrix} = \\begin{pmatrix} 0 + 20 \\\\ 0 + 150 \\end{pmatrix} = \\begin{pmatrix} 20 \\\\ 150 \\end{pmatrix}\n$$\n因此，总产出向量为 $x = \\begin{pmatrix} 20 \\\\ 150 \\end{pmatrix}$。\n\n**任务3：$(I - A)^{-1}$ 元素的解释。**\n\n矩阵 $(I - A)^{-1}$，被称为里昂惕夫逆矩阵或总需求矩阵，它量化了为向最终需求交付一单位产出，每个部门所需的总产出。设 $L = (I - A)^{-1}$。元素 $L_{ij}$ 表示为满足部门 $j$ 的产品的一单位最终需求，部门 $i$ 所需的直接和间接总产出。\n\n计算出的总需求矩阵是：\n$$\n(I - A)^{-1} = \\begin{pmatrix} \\frac{140}{101}  \\frac{20}{101} \\\\ \\frac{40}{101}  \\frac{150}{101} \\end{pmatrix} \\approx \\begin{pmatrix} 1.3861  0.1980 \\\\ 0.3960  1.4851 \\end{pmatrix}\n$$\n每个元素的解释如下：\n- $L_{11} \\approx 1.3861$：为向最终需求提供一单位（例如10亿美元）能源部门的产出，能源部门自身总共需要约 $1.3861$ 单位的总产出。这包括用于最终需求的一单位，以及在整个生产链中作为中间投入所需的 $0.3861$ 单位。\n- $L_{12} \\approx 0.1980$：为向最终需求提供一单位非能源部门的产出，总共需要约 $0.1980$ 单位来自能源部门的总产出作为间接投入。这反映了非能源部门的能源强度。\n- $L_{21} \\approx 0.3960$：为向最终需求提供一单位能源部门的产出，总共需要约 $0.3960$ 单位来自非能源部门的总产出作为间接投入。\n- $L_{22} \\approx 1.4851$：为向最终需求提供一单位非能源部门的产出，非能源部门自身总共需要约 $1.4851$ 单位的总产出。\n\n这些是捕获最终需求变化在整个经济中产生的完全涟漪效应的乘数。\n\n**任务4：能源部门的总产出 $x_{\\text{energy}}$。**\n\n能源部门被指定为第一个部门。因此，其总产出是向量 $x$ 的第一个分量，记为 $x_{\\text{energy}}$ 或 $x_1$。根据任务2的计算：\n$$\nx = \\begin{pmatrix} x_{\\text{energy}} \\\\ x_{\\text{non-energy}} \\end{pmatrix} = \\begin{pmatrix} 20 \\\\ 150 \\end{pmatrix}\n$$\n所以，能源部门的总产出恰好是 $20$。\n单位被指定为十亿2015年美元。因此，$x_{\\text{energy}} = 20$ 十亿2015年美元。\n问题要求将答案报告为四舍五入到四位有效数字的单一数值。精确值为 $20$。为了用四位有效数字表示，我们写作 $20.00$。",
            "answer": "$$\\boxed{20.00}$$"
        },
        {
            "introduction": "在探讨了生产侧之后，我们将注意力转向需求侧和一般均衡的核心机制。本练习通过一个简化的“纯交换”经济体，演示了市场价格如何自发调整以使得所有市场同时出清——即瓦尔拉斯均衡（Walrasian equilibrium）的概念。您将从效用最大化推导出家庭需求，并求解均衡价格与资源配置，从而亲身体验CGE模型中价格形成与资源分配的基本原理。",
            "id": "4079484",
            "problem": "考虑一个纯交换经济体，它代表了能源系统可计算一般均衡（CGE）模型中的一个程式化的需求模块。该经济体中有两种商品：一种是能源总和 $E$，另一种是非能源复合商品 $M$。价格分别用 $p_E$ 和 $p_M$ 表示。将 $p_M \\equiv 1$ 标准化，并定义价格比 $p \\equiv p_E/p_M$。有两个家庭，A 和 B，它们对 $(E,M)$ 具有柯布-道格拉斯偏好，这体现了它们异质的能源强度：\n- 家庭 A 的效用函数为 $U_A(E_A,M_A) = E_A^{\\frac{2}{5}} M_A^{\\frac{3}{5}}$，禀赋为 $(\\bar{E}_A,\\bar{M}_A) = (8,2)$。\n- 家庭 B 的效用函数为 $U_B(E_B,M_B) = E_B^{\\frac{7}{10}} M_B^{\\frac{3}{10}}$，禀赋为 $(\\bar{E}_B,\\bar{M}_B) = (2,8)$。\n\n家庭是价格接受者，他们在预算约束下最大化其效用，其收入等于其禀赋在当前价格下的价值。该经济中的瓦尔拉斯均衡由一组配置 $(E_A^{\\ast},M_A^{\\ast},E_B^{\\ast},M_B^{\\ast})$ 和一个价格比 $p^{\\ast}$ 构成，满足以下条件：\n- 每个家庭的配置是在给定价格和收入的情况下其效用最大化问题的解。\n- 市场出清：$E_A^{\\ast} + E_B^{\\ast} = \\bar{E}_A + \\bar{E}_B$ 且 $M_A^{\\ast} + M_B^{\\ast} = \\bar{M}_A + \\bar{M}_B$。\n- 每个家庭都满足预算一致性：$p E_h^{\\ast} + 1 \\cdot M_h^{\\ast} = p \\bar{E}_h + 1 \\cdot \\bar{M}_h$，其中 $h \\in \\{A,B\\}$。\n\n从消费者选择的第一性原理（线性预算下的效用最大化）以及市场出清和预算可行性的定义出发，计算瓦尔拉斯均衡价格比 $p^{\\ast}$ 和均衡配置 $(E_A^{\\ast},M_A^{\\ast},E_B^{\\ast},M_B^{\\ast})$。\n\n答案格式要求：\n- 以单行矩阵的形式提供最终答案，顺序为 $(p^{\\ast}, E_A^{\\ast}, M_A^{\\ast}, E_B^{\\ast}, M_B^{\\ast})$。\n- 以最简分数形式给出精确值，不允许四舍五入。\n- 所有数量均以纯数（无量纲）报告。根据定义，价格比是无量纲的。",
            "solution": "本题的求解过程分为几个步骤：首先，根据每个家庭的柯布-道格拉斯效用函数推导出其马歇尔需求函数。然后，利用市场出清条件（具体来说，是能源市场的出清）来求解均衡价格比 $p^{\\ast}$。最后，将均衡价格代入需求函数，计算出每个家庭的最终均衡配置。\n\n一个具有柯布-道格拉斯效用函数 $U(x_1, x_2) = x_1^{\\alpha} x_2^{1-\\alpha}$ 的家庭，在面临价格 $p_1, p_2$ 和拥有收入 $I$ 的情况下，将有以下马歇尔需求函数：\n$$\nx_1(p_1, p_2, I) = \\frac{\\alpha I}{p_1}\n$$\n$$\nx_2(p_1, p_2, I) = \\frac{(1-\\alpha) I}{p_2}\n$$\n我们将这个一般性结果应用于家庭 A 和 B。\n\n**1. 家庭 A 的需求**\n效用函数为 $U_A(E_A,M_A) = E_A^{\\frac{2}{5}} M_A^{\\frac{3}{5}}$，因此能源的指数为 $\\alpha_A = \\frac{2}{5}$。\n价格为 $p_E = p$ 和 $p_M = 1$。\n家庭 A 的收入 $I_A$ 是其禀赋的价值：\n$$\nI_A = p \\bar{E}_A + p_M \\bar{M}_A = p(8) + (1)(2) = 8p+2\n$$\n家庭 A 的马歇尔需求函数为：\n$$\nE_A(p, I_A) = \\frac{\\alpha_A I_A}{p} = \\frac{\\frac{2}{5}(8p+2)}{p} = \\frac{16p+4}{5p}\n$$\n$$\nM_A(p, I_A) = \\frac{(1-\\alpha_A) I_A}{1} = \\frac{\\frac{3}{5}(8p+2)}{1} = \\frac{24p+6}{5}\n$$\n\n**2. 家庭 B 的需求**\n效用函数为 $U_B(E_B,M_B) = E_B^{\\frac{7}{10}} M_B^{\\frac{3}{10}}$，因此能源的指数为 $\\alpha_B = \\frac{7}{10}$。\n家庭 B 的收入 $I_B$ 是其禀赋的价值：\n$$\nI_B = p \\bar{E}_B + p_M \\bar{M}_B = p(2) + (1)(8) = 2p+8\n$$\n家庭 B 的马歇尔需求函数为：\n$$\nE_B(p, I_B) = \\frac{\\alpha_B I_B}{p} = \\frac{\\frac{7}{10}(2p+8)}{p} = \\frac{14p+56}{10p} = \\frac{7p+28}{5p}\n$$\n$$\nM_B(p, I_B) = \\frac{(1-\\alpha_B) I_B}{1} = \\frac{\\frac{3}{10}(2p+8)}{1} = \\frac{6p+24}{10} = \\frac{3p+12}{5}\n$$\n\n**3. 市场出清与均衡价格**\n在均衡状态下，一种商品的总禀赋必须等于对该商品的需求之和。根据瓦尔拉斯定律，如果一个市场出清，另一个市场也必须出清。我们使用能源市场 $E$ 来找到均衡价格比 $p^{\\ast}$。\n能源的总禀赋为 $\\bar{E}_{\\text{total}} = \\bar{E}_A + \\bar{E}_B = 8+2 = 10$。\n市场出清条件为 $E_A(p^{\\ast}) + E_B(p^{\\ast}) = \\bar{E}_{\\text{total}}$：\n$$\n\\frac{16p^{\\ast}+4}{5p^{\\ast}} + \\frac{7p^{\\ast}+28}{5p^{\\ast}} = 10\n$$\n合并左侧的项：\n$$\n\\frac{(16p^{\\ast}+4) + (7p^{\\ast}+28)}{5p^{\\ast}} = 10\n$$\n$$\n\\frac{23p^{\\ast}+32}{5p^{\\ast}} = 10\n$$\n现在，求解 $p^{\\ast}$：\n$$\n23p^{\\ast}+32 = 10(5p^{\\ast}) = 50p^{\\ast}\n$$\n$$\n32 = 50p^{\\ast} - 23p^{\\ast}\n$$\n$$\n32 = 27p^{\\ast}\n$$\n$$\np^{\\ast} = \\frac{32}{27}\n$$\n\n**4. 均衡配置**\n现在我们将均衡价格比 $p^{\\ast} = \\frac{32}{27}$ 代入需求函数，以求得均衡配置 $(E_A^{\\ast},M_A^{\\ast},E_B^{\\ast},M_B^{\\ast})$。\n\n对于家庭 A：\n$$\nE_A^{\\ast} = \\frac{16p^{\\ast}+4}{5p^{\\ast}} = \\frac{16(\\frac{32}{27})+4}{5(\\frac{32}{27})} = \\frac{\\frac{512}{27}+\\frac{108}{27}}{\\frac{160}{27}} = \\frac{\\frac{620}{27}}{\\frac{160}{27}} = \\frac{620}{160} = \\frac{62}{16} = \\frac{31}{8}\n$$\n$$\nM_A^{\\ast} = \\frac{24p^{\\ast}+6}{5} = \\frac{24(\\frac{32}{27})+6}{5} = \\frac{\\frac{8 \\times 32}{9}+6}{5} = \\frac{\\frac{256}{9}+\\frac{54}{9}}{5} = \\frac{\\frac{310}{9}}{5} = \\frac{310}{45} = \\frac{62}{9}\n$$\n\n对于家庭 B：\n$$\nE_B^{\\ast} = \\frac{7p^{\\ast}+28}{5p^{\\ast}} = \\frac{7(\\frac{32}{27})+28}{5(\\frac{32}{27})} = \\frac{\\frac{224}{27}+\\frac{756}{27}}{\\frac{160}{27}} = \\frac{\\frac{980}{27}}{\\frac{160}{27}} = \\frac{980}{160} = \\frac{98}{16} = \\frac{49}{8}\n$$\n$$\nM_B^{\\ast} = \\frac{3p^{\\ast}+12}{5} = \\frac{3(\\frac{32}{27})+12}{5} = \\frac{\\frac{32}{9}+12}{5} = \\frac{\\frac{32}{9}+\\frac{108}{9}}{5} = \\frac{\\frac{140}{9}}{5} = \\frac{140}{45} = \\frac{28}{9}\n$$\n\n均衡价格比为 $p^{\\ast} = \\frac{32}{27}$，配置为 $(E_A^{\\ast}, M_A^{\\ast}, E_B^{\\ast}, M_B^{\\ast}) = (\\frac{31}{8}, \\frac{62}{9}, \\frac{49}{8}, \\frac{28}{9})$。\n我们可以验证市场出清条件：\n$E_A^{\\ast} + E_B^{\\ast} = \\frac{31}{8} + \\frac{49}{8} = \\frac{80}{8} = 10 = \\bar{E}_{\\text{total}}$。\n$M_A^{\\ast} + M_B^{\\ast} = \\frac{62}{9} + \\frac{28}{9} = \\frac{90}{9} = 10 = \\bar{M}_{\\text{total}}$。\n条件满足。\n\n最终答案是行矩阵 $(p^{\\ast}, E_A^{\\ast}, M_A^{\\ast}, E_B^{\\ast}, M_B^{\\ast})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{32}{27}  \\frac{31}{8}  \\frac{62}{9}  \\frac{49}{8}  \\frac{28}{9}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后的这项实践将前面练习中的概念融会贯通，构建一个完整（尽管是简化的）可计算一般均衡（CGE）模型。该模型同时包含了CES生产函数（投入产出模型的推广）和效用最大化的代表性家庭。这项编程任务要求您实现一个能够同时满足所有均衡条件（包括零利润、市场出清和收支平衡）的求解器，从而全面、深入地理解CGE模型的构建和求解过程。",
            "id": "4079532",
            "problem": "考虑一个封闭、静态、包含两个部门的能源经济模型，该模型具有一个代表性家庭、两种生产要素和从价税。部门 $\\mathsf{E}$ 生产能源商品，部门 $\\mathsf{M}$ 生产制造业商品。存在两种基本生产要素：劳动力 $\\mathsf{L}$ 和资本 $\\mathsf{K}$，其总禀赋固定为 $\\bar{L}$ 和 $\\bar{K}$。代表性家庭无弹性地供给 $\\bar{L}$ 和 $\\bar{K}$，以一次性总付转移的形式获得所有税收收入，并对最终消费拥有柯布-道格拉斯偏好。\n\n技术为规模报酬不变，并由不变替代弹性（CES）的增加值生产函数描述。对于每个部门 $i \\in \\{\\mathsf{E}, \\mathsf{M}\\}$，其生产函数为\n$$\ny_i = A_i \\left[a_i L_i^{\\frac{\\sigma_i - 1}{\\sigma_i}} + (1 - a_i) K_i^{\\frac{\\sigma_i - 1}{\\sigma_i}}\\right]^{\\frac{\\sigma_i}{\\sigma_i - 1}},\n$$\n其中 $A_i > 0$ 是生产率参数，$a_i \\in (0,1)$ 是劳动力份额参数，$\\sigma_i > 0$ 是替代弹性。在工资为 $w$、租金率为 $r$ 的竞争性要素定价下，当 $\\sigma_i \\neq 1$ 时，对偶单位成本函数为\n$$\nc_i(w,r) = \\frac{1}{A_i}\\left[a_i w^{1 - \\sigma_i} + (1 - a_i) r^{1 - \\sigma_i}\\right]^{\\frac{1}{1 - \\sigma_i}}.\n$$\n在柯布-道格拉斯极限情况 $\\sigma_i = 1$ 下，单位成本函数为\n$$\nc_i(w,r) = \\frac{1}{A_i} w^{a_i} r^{1 - a_i}.\n$$\n\n税收是从价税。能源消费税税率为 $\\tau_{\\mathsf{cE}} \\ge 0$，制造业产出税税率为 $\\tau_{\\mathsf{oM}} \\ge 0$。所有税率必须以小数形式表示（例如，10%的税率应输入为 0.10）。\n\n令 $p_{\\mathsf{E}}$ 表示能源的消费者价格，$p_{\\mathsf{M}}$ 表示制造业商品的消费者价格。将 $p_{\\mathsf{M}}$ 标准化为 1。能源生产者收到扣除消费税后的价格 $p_{\\mathsf{E}}^{p} = \\frac{p_{\\mathsf{E}}}{1 + \\tau_{\\mathsf{cE}}}$，制造业生产者收到扣除产出税后的价格 $p_{\\mathsf{M}}^{p} = \\frac{1}{1 + \\tau_{\\mathsf{oM}}}$。在完全竞争和规模报酬不变的条件下，零利润条件要求\n$$\nc_{\\mathsf{E}}(w,r) = \\frac{p_{\\mathsf{E}}}{1 + \\tau_{\\mathsf{cE}}}, \\quad c_{\\mathsf{M}}(w,r) = \\frac{1}{1 + \\tau_{\\mathsf{oM}}}.\n$$\n\n根据 Shephard 引理，部门 $i$ 的单位产出要素需求由 $L_{i}^{\\text{unit}} = \\frac{\\partial c_i}{\\partial w}$ 和 $K_{i}^{\\text{unit}} = \\frac{\\partial c_i}{\\partial r}$ 给出。当 $\\sigma_i \\neq 1$ 时，它们是\n$$\nL_{i}^{\\text{unit}}(w,r) = \\frac{1}{A_i} a_i \\left[a_i w^{1 - \\sigma_i} + (1 - a_i) r^{1 - \\sigma_i}\\right]^{\\frac{\\sigma_i}{1 - \\sigma_i}} w^{-\\sigma_i},\n$$\n$$\nK_{i}^{\\text{unit}}(w,r) = \\frac{1}{A_i} (1 - a_i) \\left[a_i w^{1 - \\sigma_i} + (1 - a_i) r^{1 - \\sigma_i}\\right]^{\\frac{\\sigma_i}{1 - \\sigma_i}} r^{-\\sigma_i}.\n$$\n在柯布-道格拉斯极限情况 $\\sigma_i = 1$ 下，单位要素需求为\n$$\nL_{i}^{\\text{unit}}(w,r) = \\frac{a_i}{A_i} \\frac{w^{a_i} r^{1 - a_i}}{w}, \\quad K_{i}^{\\text{unit}}(w,r) = \\frac{1 - a_i}{A_i} \\frac{w^{a_i} r^{1 - a_i}}{r}.\n$$\n\n代表性家庭拥有柯布-道格拉斯效用 $U(c_{\\mathsf{E}}, c_{\\mathsf{M}}) = c_{\\mathsf{E}}^{\\beta} c_{\\mathsf{M}}^{1 - \\beta}$（其中 $\\beta \\in (0,1)$），面临消费者价格 $p_{\\mathsf{E}}$ 和 $p_{\\mathsf{M}} = 1$，其选择的支出是其收入 $Y$ 的固定份额：\n$$\np_{\\mathsf{E}} c_{\\mathsf{E}} = \\beta Y, \\quad c_{\\mathsf{M}} = (1 - \\beta) Y.\n$$\n总收入是要素收入加上以一次性总付形式返还的税收收入：\n$$\nY = w \\bar{L} + r \\bar{K} + \\underbrace{\\frac{\\tau_{\\mathsf{cE}}}{1 + \\tau_{\\mathsf{cE}}} p_{\\mathsf{E}} c_{\\mathsf{E}}}_{\\text{能源消费税收入}} + \\underbrace{\\frac{\\tau_{\\mathsf{oM}}}{1 + \\tau_{\\mathsf{oM}}} \\cdot 1 \\cdot q_{\\mathsf{M}}}_{\\text{制造业产出税收入}},\n$$\n其中 $q_{\\mathsf{M}}$ 是制造业产出。商品市场出清要求 $q_{\\mathsf{E}} = c_{\\mathsf{E}}$ 和 $q_{\\mathsf{M}} = c_{\\mathsf{M}}$。要素市场出清要求 $L_{\\mathsf{E}} + L_{\\mathsf{M}} = \\bar{L}$ 和 $K_{\\mathsf{E}} + K_{\\mathsf{M}} = \\bar{K}$，其中 $L_i = q_i L_{i}^{\\text{unit}}(w,r)$ 且 $K_i = q_i K_{i}^{\\text{unit}}(w,r)$。\n\n您的程序必须计算一个竞争性一般均衡，该均衡同时满足：\n- 两个部门的零利润条件，\n- 两种商品和两种要素的市场出清，\n- 代表性家庭的收入平衡（在消费者价格下，总支出等于总收入）。\n\n为计算均衡，将 $p_{\\mathsf{E}}$ 视为未知数。对于 $p_{\\mathsf{E}}$ 的任何猜测值，求解两个零利润条件以得出 $(w,r)$，然后求解由要素市场出清所隐含的 $2 \\times 2$ 线性方程组以获得 $(q_{\\mathsf{E}}, q_{\\mathsf{M}})$。使用家庭的支出规则，计算出隐含的 $p_{\\mathsf{E}}^{*} = \\frac{\\beta Y}{q_{\\mathsf{E}}}$。在均衡状态下，一致性要求 $p_{\\mathsf{E}} = p_{\\mathsf{E}}^{*}$。使用不动点迭代或求根算法来强制 $p_{\\mathsf{E}} = p_{\\mathsf{E}}^{*}$。\n\n按如下方式实现数值容差：如果一个条件的残差绝对值小于 $\\varepsilon = 10^{-8}$，则认为该条件已满足。\n\n设计您的解决方案，使其为每个测试案例的三个条件生成布尔值验证结果：商品和要素市场出清、零利润和收入平衡。对于每个测试案例，输出一个列表 $[b_{\\text{mc}}, b_{\\text{zp}}, b_{\\text{ib}}]$，其中每个条目为 $\\mathsf{True}$ 或 $\\mathsf{False}$，取决于条件是否在容差范围内得到满足。\n\n测试套件：\n- 案例 1 (基准)：\n  - 部门 $\\mathsf{E}$：$A_{\\mathsf{E}} = 1.0$, $a_{\\mathsf{E}} = 0.6$, $\\sigma_{\\mathsf{E}} = 0.8$, $\\tau_{\\mathsf{cE}} = 0.2$。\n  - 部门 $\\mathsf{M}$：$A_{\\mathsf{M}} = 1.0$, $a_{\\mathsf{M}} = 0.5$, $\\sigma_{\\mathsf{M}} = 0.7$, $\\tau_{\\mathsf{oM}} = 0.1$。\n  - 禀赋：$\\bar{L} = 100.0$, $\\bar{K} = 80.0$。\n  - 偏好：$\\beta = 0.4$。\n- 案例 2 (高能源税边界)：\n  - 部门 $\\mathsf{E}$：$A_{\\mathsf{E}} = 0.9$, $a_{\\mathsf{E}} = 0.5$, $\\sigma_{\\mathsf{E}} = 0.6$, $\\tau_{\\mathsf{cE}} = 1.0$。\n  - 部门 $\\mathsf{M}$：$A_{\\mathsf{M}} = 1.1$, $a_{\\mathsf{M}} = 0.4$, $\\sigma_{\\mathsf{M}} = 0.5$, $\\tau_{\\mathsf{oM}} = 0.0$。\n  - 禀赋：$\\bar{L} = 90.0$, $\\bar{K} = 90.0$。\n  - 偏好：$\\beta = 0.5$。\n- 案例 3 (制造业中的柯布-道格拉斯极限)：\n  - 部门 $\\mathsf{E}$：$A_{\\mathsf{E}} = 1.2$, $a_{\\mathsf{E}} = 0.7$, $\\sigma_{\\mathsf{E}} = 0.3$, $\\tau_{\\mathsf{cE}} = 0.0$。\n  - 部门 $\\mathsf{M}$：$A_{\\mathsf{M}} = 0.95$, $a_{\\mathsf{M}} = 0.5$, $\\sigma_{\\mathsf{M}} = 1.0$, $\\tau_{\\mathsf{oM}} = 0.25$。\n  - 禀赋：$\\bar{L} = 110.0$, $\\bar{K} = 70.0$。\n  - 偏好：$\\beta = 0.6$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，其中每个元素对应一个测试案例的结果列表。例如，输出必须如下所示\n$$\n\\texttt{[[True,True,True],[True,True,True],[True,True,True]]}.\n$$",
            "solution": "用户提供了一个定义明确的计算经济学问题。我将首先验证问题陈述，然后提供一个完整的解决方案。\n\n### 第 1 步：提取给定信息\n\n**部门**：\n- 部门 $\\mathsf{E}$ (能源)\n- 部门 $\\mathsf{M}$ (制造业)\n\n**生产要素**：\n- 劳动力 $\\mathsf{L}$，固定禀赋为 $\\bar{L}$。\n- 资本 $\\mathsf{K}$，固定禀赋为 $\\bar{K}$。\n\n**家庭**：\n- 代表性家庭，拥有柯布-道格拉斯效用：$U(c_{\\mathsf{E}}, c_{\\mathsf{M}}) = c_{\\mathsf{E}}^{\\beta} c_{\\mathsf{M}}^{1 - \\beta}$，其中 $\\beta \\in (0,1)$。\n- 无弹性地供给 $\\bar{L}$ 和 $\\bar{K}$。\n- 以一次性总付转移的形式获得所有税收收入。\n\n**生产技术 (CES)**：\n- 对于部门 $i \\in \\{\\mathsf{E}, \\mathsf{M}\\}$，产出为 $y_i = A_i \\left[a_i L_i^{\\frac{\\sigma_i - 1}{\\sigma_i}} + (1 - a_i) K_i^{\\frac{\\sigma_i - 1}{\\sigma_i}}\\right]^{\\frac{\\sigma_i}{\\sigma_i - 1}}$。\n- $A_i$：生产率参数。\n- $a_i$：劳动力份额参数。\n- $\\sigma_i$：替代弹性。\n\n**单位成本函数 (对偶)**：\n- 当 $\\sigma_i \\neq 1$ 时：$c_i(w,r) = \\frac{1}{A_i}\\left[a_i w^{1 - \\sigma_i} + (1 - a_i) r^{1 - \\sigma_i}\\right]^{\\frac{1}{1 - \\sigma_i}}$。\n- 当 $\\sigma_i = 1$ 时：$c_i(w,r) = \\frac{1}{A_i} w^{a_i} r^{1 - a_i}$。\n\n**税收**：\n- 从价能源消费税：$\\tau_{\\mathsf{cE}} \\ge 0$。\n- 从价制造业产出税：$\\tau_{\\mathsf{oM}} \\ge 0$。\n\n**价格**：\n- 能源的消费者价格：$p_{\\mathsf{E}}$。\n- 制造业商品的消费者价格（计价物）：$p_{\\mathsf{M}} = 1$。\n- 能源的生产者价格：$p_{\\mathsf{E}}^{p} = \\frac{p_{\\mathsf{E}}}{1 + \\tau_{\\mathsf{cE}}}$。\n- 制造业商品的生产者价格：$p_{\\mathsf{M}}^{p} = \\frac{1}{1 + \\tau_{\\mathsf{oM}}}$。\n\n**零利润条件**：\n- $c_{\\mathsf{E}}(w,r) = p_{\\mathsf{E}}^{p}$。\n- $c_{\\mathsf{M}}(w,r) = p_{\\mathsf{M}}^{p}$。\n\n**单位要素需求 (来自 Shephard 引理)**：\n- 当 $\\sigma_i \\neq 1$ 时：\n  - $L_{i}^{\\text{unit}}(w,r) = \\frac{1}{A_i} a_i \\left[a_i w^{1 - \\sigma_i} + (1 - a_i) r^{1 - \\sigma_i}\\right]^{\\frac{\\sigma_i}{1 - \\sigma_i}} w^{-\\sigma_i}$。\n  - $K_{i}^{\\text{unit}}(w,r) = \\frac{1}{A_i} (1 - a_i) \\left[a_i w^{1 - \\sigma_i} + (1 - a_i) r^{1 - \\sigma_i}\\right]^{\\frac{\\sigma_i}{1 - \\sigma_i}} r^{-\\sigma_i}$。\n- 当 $\\sigma_i = 1$ 时：\n  - $L_{i}^{\\text{unit}}(w,r) = \\frac{a_i}{A_i} \\frac{w^{a_i} r^{1 - a_i}}{w}$。\n  - $K_{i}^{\\text{unit}}(w,r) = \\frac{1 - a_i}{A_i} \\frac{w^{a_i} r^{1 - a_i}}{r}$。\n\n**家庭需求**：\n- $p_{\\mathsf{E}} c_{\\mathsf{E}} = \\beta Y$。\n- $c_{\\mathsf{M}} = (1 - \\beta) Y$。\n\n**家庭收入**：\n- $Y = w \\bar{L} + r \\bar{K} + \\frac{\\tau_{\\mathsf{cE}}}{1 + \\tau_{\\mathsf{cE}}} p_{\\mathsf{E}} c_{\\mathsf{E}} + \\frac{\\tau_{\\mathsf{oM}}}{1 + \\tau_{\\mathsf{oM}}} q_{\\mathsf{M}}$。\n\n**市场出清条件**：\n- 商品：$q_{\\mathsf{E}} = c_{\\mathsf{E}}$，$q_{\\mathsf{M}} = c_{\\mathsf{M}}$。\n- 要素：$q_{\\mathsf{E}}L_{\\mathsf{E}}^{\\text{unit}} + q_{\\mathsf{M}}L_{\\mathsf{M}}^{\\text{unit}} = \\bar{L}$，$q_{\\mathsf{E}}K_{\\mathsf{E}}^{\\text{unit}} + q_{\\mathsf{M}}K_{\\mathsf{M}}^{\\text{unit}} = \\bar{K}$。\n\n**数值容差**：\n- $\\varepsilon = 10^{-8}$。\n\n**任务**：\n- 计算竞争性一般均衡。\n- 验证三个条件：市场出清、零利润和收入平衡。\n- 为每个测试案例输出一个布尔值列表 $[b_{\\text{mc}}, b_{\\text{zp}}, b_{\\text{ib}}]$。\n\n**测试案例**：\n- 案例 1：$A_{\\mathsf{E}}=1.0, a_{\\mathsf{E}}=0.6, \\sigma_{\\mathsf{E}}=0.8, \\tau_{\\mathsf{cE}}=0.2$；$A_{\\mathsf{M}}=1.0, a_{\\mathsf{M}}=0.5, \\sigma_{\\mathsf{M}}=0.7, \\tau_{\\mathsf{oM}}=0.1$；$\\bar{L}=100.0, \\bar{K}=80.0$；$\\beta=0.4$。\n- 案例 2：$A_{\\mathsf{E}}=0.9, a_{\\mathsf{E}}=0.5, \\sigma_{\\mathsf{E}}=0.6, \\tau_{\\mathsf{cE}}=1.0$；$A_{\\mathsf{M}}=1.1, a_{\\mathsf{M}}=0.4, \\sigma_{\\mathsf{M}}=0.5, \\tau_{\\mathsf{oM}}=0.0$；$\\bar{L}=90.0, \\bar{K}=90.0$；$\\beta=0.5$。\n- 案例 3：$A_{\\mathsf{E}}=1.2, a_{\\mathsf{E}}=0.7, \\sigma_{\\mathsf{E}}=0.3, \\tau_{\\mathsf{cE}}=0.0$；$A_{\\mathsf{M}}=0.95, a_{\\mathsf{M}}=0.5, \\sigma_{\\mathsf{M}}=1.0, \\tau_{\\mathsf{oM}}=0.25$；$\\bar{L}=110.0, \\bar{K}=70.0$；$\\beta=0.6$。\n\n### 第 2 步：使用提取的给定信息进行验证\n\n- **科学依据**：该问题描述了一个标准的静态可计算一般均衡 (CGE) 模型，该模型基于新古典微观经济学理论。CES 生产函数、柯布-道格拉斯效用、完全竞争和市场出清条件的使用是该领域的基本概念。所有方程都是标准的表示形式。该模型在科学上是合理的。\n- **适定性**：该问题是适定的。通过将一种价格固定为计价物 ($p_{\\mathsf{M}} = 1$)，并注意到根据瓦尔拉斯定律，一个市场出清条件是多余的，系统具有确定数量的方程和未知数。问题陈述引导用户采用一种标准的求解算法（对一种价格进行“摸索”调整），已知该算法在此类模型的合理条件下会收敛。通常预期存在唯一均衡。\n- **客观性**：问题以精确的数学语言陈述。它没有歧义、主观性或观点。\n- **完整性和一致性**：为每个测试案例提供了所有必要的参数和函数形式。模型设置中没有明显的矛盾。消费者价格和生产者价格、税收和收入之间的关系被一致地指定。\n- **可行性与现实性**：这些参数在经济模型的合理范围内。没有引入任何物理或科学上的不可能性。\n\n### 第 3 步：结论与行动\n\n问题陈述是有效的。这是一个完整、一致且科学上合理的计算经济学问题。我现在将开始提供解决方案。\n\n问题的核心是找到一个价格向量 $(p_{\\mathsf{E}}, w, r)$ 和数量向量 $(q_{\\mathsf{E}}, q_{\\mathsf{M}})$，使其同时满足所有均衡条件。遵循问题的指导，我们选择制造业商品的价格作为计价物，即 $p_{\\mathsf{M}}=1$。根据瓦尔拉斯定律，如果除一个市场外的所有市场都处于均衡状态，那么最后一个市场也必定处于均衡状态。这使我们能够通过找到单一的相对价格 $p_{\\mathsf{E}}$ 来求解该系统，该价格使经济达到均衡。\n\n解决方案通过求根算法找到。我们定义一个残差函数 $f(p_{\\mathsf{E}}) = p_{\\mathsf{E}}^{\\text{guess}} - p_{\\mathsf{E}}^{\\text{implied}}$，其中均衡是一个根 $p_{\\mathsf{E}}^{eq}$，使得 $f(p_{\\mathsf{E}}^{eq})=0$。对于给定的 $p_{\\mathsf{E}}^{\\text{guess}}$，计算 $p_{\\mathsf{E}}^{\\text{implied}}$ 的过程如下：\n\n1.  **求解要素价格 $(w,r)$**：给定一个 $p_{\\mathsf{E}}$ 的猜测值，生产者价格 $p_{\\mathsf{E}}^{p} = p_{\\mathsf{E}}/(1+\\tau_{\\mathsf{cE}})$ 和 $p_{\\mathsf{M}}^{p} = 1/(1+\\tau_{\\mathsf{oM}})$ 就确定了。两个零利润条件，$c_{\\mathsf{E}}(w,r)=p_{\\mathsf{E}}^p$ 和 $c_{\\mathsf{M}}(w,r)=p_{\\mathsf{M}}^p$，构成了一个关于要素价格 $(w,r)$ 的包含两个非线性方程的方程组。我们可以通过取它们的比值来简化这个系统：\n    $$\n    \\frac{c_{\\mathsf{E}}(w,r)}{c_{\\mathsf{M}}(w,r)} = \\frac{p_{\\mathsf{E}}^{p}}{p_{\\mathsf{M}}^{p}}\n    $$\n    由于成本函数在价格上是一次齐次的，这个比率只取决于工资租金比 $\\omega = w/r$。\n    $$\n    \\frac{c_{\\mathsf{E}}(\\omega,1)}{c_{\\mathsf{M}}(\\omega,1)} = \\frac{p_{\\mathsf{E}}^{p}}{p_{\\mathsf{M}}^{p}} \\implies \\frac{c_{\\mathsf{E}}(\\omega,1)}{c_{\\mathsf{M}}(\\omega,1)} - \\frac{p_{\\mathsf{E}} (1+\\tau_{\\mathsf{oM}})}{(1+\\tau_{\\mathsf{cE}})} = 0\n    $$\n    这是一个关于 $\\omega$ 的单非线性方程，可以使用数值求根器高效求解。一旦找到 $\\omega$，我们就可以使用第二个零利润条件求解 $r$：$c_{\\mathsf{M}}(w,r) = r \\cdot c_{\\mathsf{M}}(\\omega,1) = p_{\\mathsf{M}}^{p}$，得出 $r = p_{\\mathsf{M}}^{p} / c_{\\mathsf{M}}(\\omega,1)$。最后，$w = \\omega r$。\n\n2.  **计算单位要素需求**：确定了均衡要素价格 $(w,r)$ 后，我们可以使用提供的公式计算每个部门 $i \\in \\{\\mathsf{E}, \\mathsf{M}\\}$ 的单位要素需求 $L_i^{\\text{unit}}$ 和 $K_i^{\\text{unit}}$，并仔细处理 $\\sigma_i = 1$ 的特殊情况。\n\n3.  **求解部门产出 $(q_{\\mathsf{E}}, q_{\\mathsf{M}})$**：要素市场出清条件，$L_{\\mathsf{E}}^{\\text{unit}} q_{\\mathsf{E}} + L_{\\mathsf{M}}^{\\text{unit}} q_{\\mathsf{M}} = \\bar{L}$ 和 $K_{\\mathsf{E}}^{\\text{unit}} q_{\\mathsf{E}} + K_{\\mathsf{M}}^{\\text{unit}} q_{\\mathsf{M}} = \\bar{K}$，构成了关于部门产出 $(q_{\\mathsf{E}}, q_{\\mathsf{M}})$ 的一个 $2 \\times 2$ 线性方程组。该系统使用标准线性代数求解。\n\n4.  **计算隐含的能源价格 $p_{\\mathsf{E}}^*$**：我们计算家庭的总收入 $Y$，它是要素收入和返还的税收收入之和。\n    $$\n    Y = w \\bar{L} + r \\bar{K} + \\tau_{\\mathsf{cE}} p_{\\mathsf{E}}^{p} q_{\\mathsf{E}} + \\tau_{\\mathsf{oM}} p_{\\mathsf{M}}^{p} q_{\\mathsf{M}}\n    $$\n    家庭的柯布-道格拉斯偏好意味着它将其收入的固定比例 $\\beta$ 用于能源商品：$p_{\\mathsf{E}} c_{\\mathsf{E}} = \\beta Y$。假设商品市场出清 ($q_{\\mathsf{E}} = c_{\\mathsf{E}}$)，该支出规则隐含了一个市场出清的能源价格：\n    $$\n    p_{\\mathsf{E}}^{*} = \\frac{\\beta Y}{q_{\\mathsf{E}}}\n    $$\n    这是与猜测值 $p_{\\mathsf{E}}^{\\text{guess}}$ 一致的隐含价格。\n\n5.  **寻找均衡**：残差函数为 $f(p_{\\mathsf{E}}) = p_{\\mathsf{E}}^{\\text{guess}} - p_{\\mathsf{E}}^*$。我们使用一个求根算法（来自 `scipy.optimize`）来找到均衡价格 $p_{\\mathsf{E}}^{eq}$，使得 $f(p_{\\mathsf{E}}^{eq}) = 0$。\n\n6.  **验证**：一旦找到均衡价格 $p_{\\mathsf{E}}^{eq}$，所有其他均衡量将重新计算。然后我们验证均衡的定义条件是否在指定的容差 $\\varepsilon = 10^{-8}$ 内成立：\n    - **市场出清 ($b_{\\text{mc}}$)**：检查两个要素市场的残差。\n    - **零利润 ($b_{\\text{zp}}$)**：检查两个零利润条件的残差。\n    - **收入平衡 ($b_{\\text{ib}}$)**：检查家庭收入等于家庭支出的残差 ($Y = p_{\\mathsf{E}}q_{\\mathsf{E}} + p_{\\mathsf{M}}q_{\\mathsf{M}}$)。这是瓦尔拉斯定律的一个推论，也是对计算出的解决方案整体一致性的检验。\n\n该算法将为提供的三个测试案例中的每一个实施。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes and verifies the general equilibrium for a two-sector CGE model\n    for three distinct test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        { # Case 1\n            'E': {'A': 1.0, 'a': 0.6, 'sigma': 0.8, 'tau_cE': 0.2},\n            'M': {'A': 1.0, 'a': 0.5, 'sigma': 0.7, 'tau_oM': 0.1},\n            'endow': {'L_bar': 100.0, 'K_bar': 80.0},\n            'prefs': {'beta': 0.4}\n        },\n        { # Case 2\n            'E': {'A': 0.9, 'a': 0.5, 'sigma': 0.6, 'tau_cE': 1.0},\n            'M': {'A': 1.1, 'a': 0.4, 'sigma': 0.5, 'tau_oM': 0.0},\n            'endow': {'L_bar': 90.0, 'K_bar': 90.0},\n            'prefs': {'beta': 0.5}\n        },\n        { # Case 3\n            'E': {'A': 1.2, 'a': 0.7, 'sigma': 0.3, 'tau_cE': 0.0},\n            'M': {'A': 0.95, 'a': 0.5, 'sigma': 1.0, 'tau_oM': 0.25},\n            'endow': {'L_bar': 110.0, 'K_bar': 70.0},\n            'prefs': {'beta': 0.6}\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        result = compute_and_verify_equilibrium(params)\n        results.append(result)\n\n    # Format the output as specified: [[True,True,True],[True,True,True],...]\n    # Python's default str() adds spaces, so we manually format it.\n    output_str = f\"[{','.join([str(r).replace(' ', '') for r in results])}]\"\n    print(output_str)\n\ndef compute_and_verify_equilibrium(params):\n    \"\"\"\n    Main function to compute equilibrium for a single parameter set and verify it.\n    \"\"\"\n    tol = 1e-8\n\n    def c_func(w, r, A, a, sigma):\n        \"\"\"Unit cost function.\"\"\"\n        if sigma == 1.0:\n            if w == 0 or r == 0: return np.inf\n            return (1/A) * (w**a) * (r**(1-a))\n        else:\n            term = a * w**(1-sigma) + (1-a) * r**(1-sigma)\n            if term  0:\n                return np.inf\n            return (1/A) * term**(1/(1-sigma))\n\n    def unit_input_demands_func(w, r, A, a, sigma):\n        \"\"\"Unit input demand functions.\"\"\"\n        if sigma == 1.0:\n            c_val = c_func(w, r, A, a, sigma)\n            L_unit = a * c_val / w\n            K_unit = (1-a) * c_val / r\n        else:\n            common_term = a * w**(1-sigma) + (1-a) * r**(1-sigma)\n            if common_term  0: return np.inf, np.inf\n            \n            # Using formulas from the problem description\n            exponent_term = common_term**(sigma / (1-sigma))\n            L_unit = (1/A) * a * exponent_term * w**(-sigma)\n            K_unit = (1/A) * (1-a) * exponent_term * r**(-sigma)\n        return L_unit, K_unit\n\n    def get_all_vars(p_E, params):\n        \"\"\"\n        For a given p_E, calculates all other variables in the model.\n        Returns a dictionary of variables or None on failure.\n        \"\"\"\n        p_E_p = p_E / (1 + params['E']['tau_cE'])\n        p_M_p = 1.0 / (1 + params['M']['tau_oM'])\n\n        # Nested function for finding w/r ratio\n        def omega_residual(omega):\n            c_E_ratio = c_func(omega, 1, params['E']['A'], params['E']['a'], params['E']['sigma'])\n            c_M_ratio = c_func(omega, 1, params['M']['A'], params['M']['a'], params['M']['sigma'])\n            \n            if np.isinf(c_E_ratio) or np.isinf(c_M_ratio) or c_M_ratio == 0:\n                return 1e12 # Return large number for invalid omega\n            \n            target_ratio = p_E_p / p_M_p\n            return c_E_ratio / c_M_ratio - target_ratio\n\n        # Solve for omega = w/r\n        try:\n            sol_omega = root_scalar(omega_residual, bracket=[1e-6, 1e6], method='brentq')\n            if not sol_omega.converged: return None\n            omega = sol_omega.root\n        except (ValueError, RuntimeError):\n            return None\n\n        # Calculate w and r\n        c_M_ratio = c_func(omega, 1, params['M']['A'], params['M']['a'], params['M']['sigma'])\n        if np.isinf(c_M_ratio) or c_M_ratio == 0: return None\n        r = p_M_p / c_M_ratio\n        w = omega * r\n        \n        # Calculate unit input demands\n        L_E_unit, K_E_unit = unit_input_demands_func(w, r, params['E']['A'], params['E']['a'], params['E']['sigma'])\n        L_M_unit, K_M_unit = unit_input_demands_func(w, r, params['M']['A'], params['M']['a'], params['M']['sigma'])\n        \n        # Solve for q_E, q_M\n        A_matrix = np.array([[L_E_unit, L_M_unit], [K_E_unit, K_M_unit]])\n        b_vector = np.array([params['endow']['L_bar'], params['endow']['K_bar']])\n        try:\n            q_vector = np.linalg.solve(A_matrix, b_vector)\n            q_E, q_M = q_vector[0], q_vector[1]\n        except np.linalg.LinAlgError:\n            return None\n        \n        if q_E = 0 or q_M = 0: return None\n        \n        # Calculate income and implied p_E\n        tax_rev_E = params['E']['tau_cE'] * p_E_p * q_E\n        tax_rev_M = params['M']['tau_oM'] * p_M_p * q_M\n        Y = w * params['endow']['L_bar'] + r * params['endow']['K_bar'] + tax_rev_E + tax_rev_M\n        p_E_star = params['prefs']['beta'] * Y / q_E\n        \n        return {\n            'p_E': p_E, 'p_E_star': p_E_star, 'p_E_p': p_E_p, 'p_M_p': p_M_p, \n            'w': w, 'r': r, 'q_E': q_E, 'q_M': q_M, 'Y': Y,\n            'L_E_unit': L_E_unit, 'K_E_unit': K_E_unit,\n            'L_M_unit': L_M_unit, 'K_M_unit': K_M_unit\n        }\n\n    # Outer root finding for p_E\n    def p_E_residual(p_E):\n        res = get_all_vars(p_E, params)\n        if res is None: return 1e12\n        return res['p_E'] - res['p_E_star']\n\n    try:\n        sol_p_E = root_scalar(p_E_residual, bracket=[0.1, 10.0], method='brentq')\n        if not sol_p_E.converged: return [False, False, False]\n        p_E_eq = sol_p_E.root\n    except (ValueError, RuntimeError):\n        return [False, False, False]\n\n    # Get final equilibrium values\n    eq_vars = get_all_vars(p_E_eq, params)\n\n    # Verification\n    # 1. Market Clearing\n    L_demand = eq_vars['L_E_unit'] * eq_vars['q_E'] + eq_vars['L_M_unit'] * eq_vars['q_M']\n    K_demand = eq_vars['K_E_unit'] * eq_vars['q_E'] + eq_vars['K_M_unit'] * eq_vars['q_M']\n    mc_L_ok = abs(L_demand - params['endow']['L_bar'])  tol\n    mc_K_ok = abs(K_demand - params['endow']['K_bar'])  tol\n    b_mc = mc_L_ok and mc_K_ok\n\n    # 2. Zero Profit\n    c_E_val = c_func(eq_vars['w'], eq_vars['r'], params['E']['A'], params['E']['a'], params['E']['sigma'])\n    c_M_val = c_func(eq_vars['w'], eq_vars['r'], params['M']['A'], params['M']['a'], params['M']['sigma'])\n    zp_E_ok = abs(c_E_val - eq_vars['p_E_p'])  tol\n    zp_M_ok = abs(c_M_val - eq_vars['p_M_p'])  tol\n    b_zp = zp_E_ok and zp_M_ok\n\n    # 3. Income Balance (Walras' Law check)\n    expenditure = eq_vars['p_E'] * eq_vars['q_E'] + 1.0 * eq_vars['q_M']\n    b_ib = abs(expenditure - eq_vars['Y'])  tol\n\n    return [b_mc, b_zp, b_ib]\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}