{
    "hands_on_practices": [
        {
            "introduction": "这项练习将引导你从流体动力学的基本原理出发，推导出天然气管道流动的基本代数方程。通过简化稳态动量平衡方程，我们将得到广泛使用的魏茅斯方程（Weymouth equation），它是稳态管网分析的基石。这项实践旨在锻炼你将物理原理与工程实用模型联系起来，并应用它们来确定运行边界的能力。",
            "id": "4107328",
            "problem": "在天然气输送管网中，一条单一的水平直管道将节点 $i$ 连接到节点 $j$。气体被建模为具有恒定压缩因子（Z）的理想气体，流动是稳定、一维和等温的。管道沿其长度具有恒定的直径和粗糙度，摩擦由恒定的 Darcy–Weisbach 摩擦系数表示。设质量流量为 $q$（从节点 $i$ 到节点 $j$ 定义为正），上游压力为 $p_i$，下游压力为 $p_j$。管道的综合阻力系数 $\\,\\alpha_e\\,$ 已通过先前的校准得知，它在所述假设下整合了几何形状和气体属性。\n\n从可压缩流体带壁面摩擦的稳态动量平衡和等温条件下的理想气体关系式出发，推导连接该管道 $(p_i,p_j,q)$ 的稳态代数关系式，并识别系数 $\\,\\alpha_e\\,$ 是如何出现的。然后，利用此关系式，施加操作约束，即当上游压力为 $p_i=60$ bar 时，下游压力必须满足 $p_j \\ge 40$ bar，并计算正向质量流量 $q$（即 $q \\ge 0$）的允许范围。\n\n使用以下数值数据：\n- $p_i = 60$ bar，\n- $p_j \\ge 40$ bar，\n- $\\alpha_e = 8.0 \\times 10^{11}$ $\\text{Pa}^2 \\text{s}^2 \\text{kg}^{-2}$，\n- $1$ bar $= 10^{5}$ $\\text{Pa}$。\n\n报告 $q$ 的允许范围的数值下界和上界，并将质量流量以千克/秒表示。将最终的数值边界四舍五入到四位有效数字。",
            "solution": "首先通过提取所有给定信息并根据形式标准对其进行评估来验证问题。\n\n**第 1 步：提取已知条件**\n-   一条单一的水平直管道连接节点 $i$ 到节点 $j$。\n-   气体模型：具有恒定压缩因子 $Z$ 的理想气体。\n-   流动条件：稳定、一维和等温。\n-   管道几何形状：恒定的直径 $D$ 和粗糙度，导致恒定的 Darcy-Weisbach 摩擦系数 $f$。\n-   变量：质量流量 $q$（从 $i$ 到 $j$ 为正），上游压力 $p_i$，下游压力 $p_j$。\n-   参数：管道阻力系数 $\\alpha_e = 8.0 \\times 10^{11}$ $\\text{Pa}^2 \\text{s}^2 \\text{kg}^{-2}$。\n-   目标 1：从稳态动量平衡出发，推导连接 $(p_i, p_j, q)$ 的稳态代数关系式，并识别 $\\alpha_e$ 如何出现。\n-   目标 2：当上游压力为 $p_i=60$ bar 时，施加操作约束 $p_j \\ge 40$ bar。\n-   目标 3：计算正向质量流量 $q$（其中 $q \\ge 0$）的允许范围。\n-   数值数据：\n    -   $p_i = 60$ bar\n    -   $p_j \\ge 40$ bar\n    -   $1$ bar $= 10^{5}$ Pa\n-   最终输出要求：报告 $q$ 的数值下界和上界，单位为千克/秒，四舍五入到四位有效数字。\n\n**第 2 步：使用提取的已知条件进行验证**\n-   **科学性**：该问题在流体力学中有充分的依据，特别是在管道中可压缩流动的动量方程应用方面。所做的假设（等温流动、恒定摩擦系数、恒定压缩因子）是天然气输送建模中用于获得易于处理的代数方程以进行管网分析的标准且合理的简化。\n-   **适定性**：问题定义清晰。它提供了所有必要的物理假设、一个已知参数（$\\alpha_e$）和足够的边界条件（$p_i$ 和对 $p_j$ 的约束），以确定质量流量 $q$ 的一个唯一、稳定且有意义的范围。\n-   **客观性**：问题以精确、定量和无偏见的语言陈述。没有主观或模棱两可的术语。\n-   **结论**：该问题没有违反任何无效性标准。这是一个工程流体动力学中的标准、适定的问题。\n\n**第 3 步：评定与行动**\n该问题有效。将提供完整的解决方案。\n\n在长度为 $L$、直径为 $D$ 的水平管道中，稳态一维流动的动量平衡由下式给出：\n$$\n\\frac{d p}{d x} + \\rho v \\frac{d v}{d x} + \\frac{f}{D} \\frac{\\rho v^2}{2} = 0\n$$\n其中 $p$ 是压力，$x$ 是沿管道的空间坐标，$\\rho$ 是气体密度，$v$ 是流体速度，$f$ 是 Darcy-Weisbach 摩擦系数。第一项代表压力梯度，第二项是惯性项（或对流加速度项），第三项是摩擦压降。\n\n对于天然气输送管道，其长度通常很长，摩擦损失远大于动能的变化。因此，忽略惯性项 $\\rho v \\frac{dv}{dx}$ 是一个标准且有效的工程简化。问题要求一个“代数关系式”并提供一个单一的阻力系数 $\\alpha_e$，这强烈支持这种简化，因为保留惯性项会导致一个涉及对数的超越方程。\n\n忽略惯性项，动量方程简化为：\n$$\n\\frac{d p}{d x} = -\\frac{f}{2D} \\rho v^2\n$$\n由于是稳态流动，质量流量 $q$ 沿管道是恒定的：$q = \\rho A v$，其中 $A = \\frac{\\pi D^2}{4}$ 是恒定的横截面积。因此，$v = \\frac{q}{\\rho A}$。将此代入动量方程得：\n$$\n\\frac{d p}{d x} = -\\frac{f}{2D} \\rho \\left(\\frac{q}{\\rho A}\\right)^2 = -\\frac{f q^2}{2 D A^2 \\rho}\n$$\n气体使用恒定压缩因子 $Z$ 的实际气体状态方程建模：$p = \\rho Z R T$，其中 $R$ 是比气体常数，$T$ 是恒定温度（等温流动）。密度可以表示为 $\\rho = \\frac{p}{ZRT}$。将此代入 $\\rho$：\n$$\n\\frac{d p}{d x} = -\\frac{f q^2}{2 D A^2 \\left(\\frac{p}{ZRT}\\right)} = -\\left(\\frac{f Z R T}{2 D A^2}\\right) \\frac{q^2}{p}\n$$\n这是一个一阶常微分方程。我们可以分离变量 $p$ 和 $x$，并沿管道从入口（节点 $i$，其中 $x=0$ 和 $p=p_i$）到出口（节点 $j$，其中 $x=L$ 和 $p=p_j$）进行积分：\n$$\n\\int_{p_i}^{p_j} p \\, dp = -\\int_{0}^{L} \\left(\\frac{f Z R T}{2 D A^2}\\right) q^2 \\, dx\n$$\n由于右侧括号中的所有项都是常数，积分得到：\n$$\n\\left[ \\frac{p^2}{2} \\right]_{p_i}^{p_j} = -\\left(\\frac{f L Z R T}{2 D A^2}\\right) q^2\n$$\n$$\n\\frac{p_j^2 - p_i^2}{2} = -\\left(\\frac{f L Z R T}{2 D A^2}\\right) q^2\n$$\n乘以 $-2$ 得到最终的代数关系式：\n$$\np_i^2 - p_j^2 = \\left(\\frac{f L Z R T}{D A^2}\\right) q^2\n$$\n问题指出综合阻力系数为 $\\alpha_e$。通过将我们推导的方程与形式 $p_i^2 - p_j^2 = \\alpha_e q^2$ 进行比较，我们可以识别出 $\\alpha_e$ 为：\n$$\n\\alpha_e = \\frac{f L Z R T}{D A^2}\n$$\n该系数将管道段的所有恒定物理和几何属性集中到一个参数中。$\\alpha_e$ 的单位是 $[\\text{pressure}]^2 / [\\text{mass flow rate}]^2$，即 $\\text{Pa}^2/(\\text{kg/s})^2 = \\text{Pa}^2 \\text{s}^2 \\text{kg}^{-2}$，与给定的单位相符。\n\n现在，我们使用这个关系式来计算正向质量流量 $q \\ge 0$ 的允许范围。控制方程是：\n$$\np_i^2 - p_j^2 = \\alpha_e q^2\n$$\n给定的数值数据是：\n-   $p_i = 60$ bar $= 60 \\times 10^5 \\text{ Pa} = 6.0 \\times 10^6$ Pa\n-   $p_j \\ge 40$ bar，这意味着 $p_j \\ge 40 \\times 10^5 \\text{ Pa} = 4.0 \\times 10^6$ Pa\n-   $\\alpha_e = 8.0 \\times 10^{11}$ $\\text{Pa}^2 \\text{s}^2 \\text{kg}^{-2}$\n-   $q \\ge 0$\n\n对于正向流动（$q  0$），必须有 $p_i  p_j$。对于边界情况 $q=0$，我们有 $p_i = p_j$。因此，条件 $q \\ge 0$ 意味着 $p_i \\ge p_j$。结合给定信息，下游压力的允许范围是 $40 \\text{ bar} \\le p_j \\le 60 \\text{ bar}$，或者用国际单位制表示：\n$$\n4.0 \\times 10^6 \\text{ Pa} \\le p_j \\le 6.0 \\times 10^6 \\text{ Pa}\n$$\n我们可以将 $q$ 表示为 $p_j$ 的函数：\n$$\nq(p_j) = \\sqrt{\\frac{p_i^2 - p_j^2}{\\alpha_e}}\n$$\n在允许的范围内，该函数随 $p_j$ 的增加而单调递减。因此，$q$ 的最小值出现在 $p_j$ 的最大值处，$q$ 的最大值出现在 $p_j$ 的最小值处。\n\n最小质量流量 $q_{\\text{min}}$ 发生在 $p_j$ 最大化时，即 $p_j = 60 \\text{ bar} = 6.0 \\times 10^6$ Pa。\n$$\nq_{\\text{min}} = \\sqrt{\\frac{(6.0 \\times 10^6)^2 - (6.0 \\times 10^6)^2}{8.0 \\times 10^{11}}} = \\sqrt{0} = 0 \\text{ kg/s}\n$$\n最大质量流量 $q_{\\text{max}}$ 发生在 $p_j$ 最小化时，即 $p_j = 40 \\text{ bar} = 4.0 \\times 10^6$ Pa。\n$$\np_i^2 = (6.0 \\times 10^6 \\text{ Pa})^2 = 36.0 \\times 10^{12} \\text{ Pa}^2\n$$\n$$\np_j^2 = (4.0 \\times 10^6 \\text{ Pa})^2 = 16.0 \\times 10^{12} \\text{ Pa}^2\n$$\n$$\nq_{\\text{max}} = \\sqrt{\\frac{36.0 \\times 10^{12} - 16.0 \\times 10^{12}}{8.0 \\times 10^{11}}} = \\sqrt{\\frac{20.0 \\times 10^{12}}{8.0 \\times 10^{11}}} = \\sqrt{\\frac{200}{8.0}} = \\sqrt{25} = 5.0 \\text{ kg/s}\n$$\n正向质量流量 $q$ 的允许范围是 $0 \\le q \\le 5.0$ kg/s。问题要求将边界四舍五入到四位有效数字。\n- 下界：$0$ 变为 $0.000$。\n- 上界：$5.0$ 变为 $5.000$。\n\n下界是 $0.000$ kg/s，上界是 $5.000$ kg/s。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.000  5.000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在流动方程的基础上，我们现在将探讨一种强大的建模技巧：压力平方公式。这种变换可以将某些非线性元件（如压缩机模型）线性化，这在优化问题中极具优势。这项练习要求你批判性地分析这种变量变换的利弊，评估其对凸性、约束条件和模型整体可解性的影响。",
            "id": "4107292",
            "problem": "考虑一个稳态、等温、水平的天然气输送网络，该网络在一个有向图上建模，节点集为 $\\mathcal{N}$，边集为 $\\mathcal{E}$。对于每条管道 $(i,j) \\in \\mathcal{E}$，假设流动是一维的，高程变化可忽略不计，横截面积 $A_{ij}$、直径 $D_{ij}$、达西-魏斯巴赫摩擦系数 (DWF) $f_{ij}$ 均为常数，并且气体为理想气体，其压缩因子 $Z$ 和绝对温度 $T$ 沿管道均匀且恒定。设边 $(i,j)$ 上的质量流量变量为 $q_{ij}$，在 $(i \\to j)$ 方向上为正，否则为负。节点压力表示为 $p_i  0$，适用于所有 $i \\in \\mathcal{N}$。节点质量平衡强制满足 $\\sum_{j:(i,j)\\in\\mathcal{E}} q_{ij} - \\sum_{k:(k,i)\\in\\mathcal{E}} q_{ki} = d_i$，其中 $d_i$ 是节点 $i$ 的净提取量（当气体被提取时为正）。\n\n从稳态内流的动量平衡方程（包含达西-魏斯巴赫壁面剪切）以及理想气体定律 (IGL) $\\rho = p/(Z R T)$（其中 $\\rho$ 为气体密度，$R$ 为比气体常数）出发，推导连接节点压力和边流量的代数管道关系式。然后定义压力平方变量 $P_i = p_i^2$（适用于所有 $i \\in \\mathcal{N}$），并用 $(P_i, P_j, q_{ij})$ 表示该管道关系式。基于此建模转换，评估以下关于在 $P$ 坐标系下工作的优缺点陈述。\n\n下列哪些陈述是正确的？\n\nA. 引入 $P_i = p_i^2$ 使每个管道定律在节点变量 $(P_i, P_j)$ 中变为仿射的，但约束 $P_i - P_j = k_{ij} q_{ij}^2$ 在 $(P, q)$ 中定义了一个非凸可行集。\n\nB. 一个固定压缩比 $r_{ij}  1$ 的压缩机边，其模型为 $p_j = r_{ij} p_i$，在压力平方变量替换下变为 $P_j = r_{ij}^2 P_i$，这是一个线性等式，对混合整数线性规划公式可能有利。\n\nC. 压力边界 $p_i^{\\min} \\le p_i \\le p_i^{\\max}$ 转换为关于 $P_i$ 的凸二次不等式，这些不等式是非线性的，并且倾向于破坏原本线性规划的凸性。\n\nD. 如果达西-魏斯巴赫摩擦系数取决于雷诺数，从而取决于流量，那么连接 $P_i - P_j$ 和 $q_{ij}^2$ 的系数将变得与流量相关，这会削弱或消除在恒定属性假设下成立的 $P$ 坐标系中的线性关系。\n\nE. 重新参数化为 $P_i = p_i^2$ 会自动改善数值条件，因为对于 $p_i, p_j  0$，总是有 $|P_i - P_j|  |p_i - p_j|$ 成立。\n\nF. 在压力平方公式中，$P_i - P_j$ 的符号唯一地决定了每条管道上 $q_{ij}$ 的符号，因此在所有网络优化情境中，用于表示流动方向的二进制变量都是不必要的。",
            "solution": "问题要求评估关于稳态、等温、水平天然气管道流动的压力平方公式的几个陈述。首先，我们必须推导节点压力和质量流量之间的基本代数关系，然后用压力平方变量来表示它。\n\n### 管道流动方程的推导\n\n分析始于恒定横截面管道中稳态内流的一维动量平衡，管道沿 $x$ 轴从节点 $i$（位于 $x=0$）指向节点 $j$（位于 $x=L_{ij}$）：\n$$\n\\frac{dp}{dx} + \\rho v \\frac{dv}{dx} + \\frac{f}{2D}\\rho v^2 = 0\n$$\n其中 $p$ 是压力，$\\rho$ 是气体密度，$v$ 是流体速度，$D$ 是管道直径，$f$ 是达西-魏斯巴赫摩擦系数。问题说明要忽略高程变化，因此没有重力项。\n\n对于稳态流，质量流率 $q = \\rho v A$ 沿管道是恒定的，其中 $A$ 是恒定的横截面积。\n$\\rho v \\frac{dv}{dx}$ 项代表动量通量（或动能梯度）的变化。在许多高压天然气输送管道的实际分析中，流速与声速相比很低，压降主要由摩擦主导。因此，与摩擦项相比，这个动能项通常被认为是可忽略的。为了按要求获得一个简单的代数关系，我们采用这种标准简化。动量平衡简化为：\n$$\n\\frac{dp}{dx} + \\frac{f}{2D}\\rho v^2 = 0\n$$\n根据质量流率的定义，我们有 $v = q / (\\rho A)$。将其代入方程得到：\n$$\n\\frac{dp}{dx} + \\frac{f}{2D}\\rho \\left(\\frac{q}{\\rho A}\\right)^2 = 0 \\implies \\frac{dp}{dx} + \\frac{f q^2}{2DA^2} \\frac{1}{\\rho} = 0\n$$\n问题以 $\\rho = p/(ZRT)$ 的形式给出了理想气体定律，其中比气体常数 $R$、压缩因子 $Z$ 和绝对温度 $T$ 都是常数。代入 $\\rho$：\n$$\n\\frac{dp}{dx} + \\frac{f q^2}{2DA^2} \\frac{ZRT}{p} = 0\n$$\n为了找到管道两端压力之间的关系，我们分离变量并积分。\n$$\np \\, dp = - \\frac{f q^2 ZRT}{2DA^2} dx\n$$\n我们从 $x=0$（节点 $i$，压力 $p_i$）积分到 $x=L_{ij}$（节点 $j$，压力 $p_j$）。流量变量 $q_{ij}$ 定义为从 $i$ 到 $j$ 的流动为正。属性 $f_{ij}$, $D_{ij}$, $A_{ij}$, $Z$, $R$, $T$ 对于管道 $(i,j)$ 是常数。\n$$\n\\int_{p_i}^{p_j} p \\, dp = - \\int_0^{L_{ij}} \\frac{f_{ij} q_{ij}^2 ZRT}{2D_{ij}A_{ij}^2} dx\n$$\n$$\n\\left[ \\frac{p^2}{2} \\right]_{p_i}^{p_j} = - \\frac{f_{ij} L_{ij} ZRT}{2D_{ij}A_{ij}^2} q_{ij}^2\n$$\n$$\n\\frac{p_j^2 - p_i^2}{2} = - \\frac{f_{ij} L_{ij} ZRT}{2D_{ij}A_{ij}^2} q_{ij}^2\n$$\n乘以 $-2$ 并重新整理，得到从 $i$ 到 $j$ 的流动关系（其中 $p_i  p_j$ 且 $q_{ij}  0$）：\n$$\np_i^2 - p_j^2 = \\frac{f_{ij} L_{ij} ZRT}{D_{ij}A_{ij}^2} q_{ij}^2\n$$\n这是魏茅斯方程 (Weymouth equation)。为了考虑双向流动，其中 $q_{ij}$ 可以为负（表示从 $j$ 到 $i$ 的流动），我们必须确保压降 $p_i^2 - p_j^2$ 与流动的符号相同。这可以通过将方程写成以下形式来实现：\n$$\np_i^2 - p_j^2 = k_{ij} q_{ij} |q_{ij}|\n$$\n其中管道常数 $k_{ij} = \\frac{f_{ij} L_{ij} ZRT}{D_{ij}A_{ij}^2}  0$。如果 $p_i  p_j$，左侧为正，这迫使 $q_{ij}  0$。如果 $p_j  p_i$，左侧为负，迫使 $q_{ij}  0$。\n\n### 转换为压力平方坐标\n\n问题定义了新变量 $P_i = p_i^2$。将其代入推导出的管道关系式得到：\n$$\nP_i - P_j = k_{ij} q_{ij} |q_{ij}|\n$$\n我们现在基于这个转换后的方程来评估每个陈述。\n\n### 选项评估\n\n**A. 引入 $P_i = p_i^2$ 使每个管道定律在节点变量 $(P_i, P_j)$ 中变为仿射的，但约束 $P_i - P_j = k_{ij} q_{ij}^2$ 在 $(P, q)$ 中定义了一个非凸可行集。**\n\n第一句话指出管道定律在 $(P_i, P_j)$ 中变为仿射的。方程为 $P_i - P_j = k_{ij} q_{ij} |q_{ij}|$。如果将流量 $q_{ij}$视为固定参数，则方程为 $P_i - P_j = \\text{常数}$，这是关于 $P_i$ 和 $P_j$ 的一个线性约束，因此是仿射的。这部分是正确的。\n\n第二句话考察了约束 $g(P_i, P_j, q_{ij}) = P_i - P_j - k_{ij} q_{ij}^2 = 0$。这种形式用于单向流模型，其中 $q_{ij} \\ge 0$ 是单独施加的。一个等式约束 $g(x)=0$ 定义了一个凸集，当且仅当函数 $g(x)$ 是仿射的。在这里，函数 $g$ 包含项 $-k_{ij} q_{ij}^2$，它是关于 $q_{ij}$ 的二次项。因此，$g$ 不是变量 $(P_i, P_j, q_{ij})$ 的仿射函数，它定义的可行集是非凸的。为了证明这一点，考虑两个可行点：$x_1 = (P^{(1)}, q^{(1)}) = (k_{ij}, 0, 1)$ 和 $x_2 = (P^{(2)}, q^{(2)}) = (k_{ij}, 0, -1)$。两者都满足 $P_i - P_j = k_{ij} q_{ij}^2$。它们的中点是 $x_m = 0.5(x_1+x_2) = (k_{ij}, 0, 0)$。对于这一点，$P_i - P_j = k_{ij}$ 但 $k_{ij}q_{ij}^2 = 0$。由于 $k_{ij} \\neq 0$，中点不满足该约束。同样的结论也适用于更一般的双向形式 $P_i - P_j = k_{ij} q_{ij} |q_{ij}|$。因此，该陈述是正确的。\n\n**结论：正确**\n\n**B. 一个固定压缩比 $r_{ij}  1$ 的压缩机边，其模型为 $p_j = r_{ij} p_i$，在压力平方变量替换下变为 $P_j = r_{ij}^2 P_i$，这是一个线性等式，对混合整数线性规划公式可能有利。**\n\n给定压缩机模型 $p_j = r_{ij} p_i$。变量替换为 $P_i=p_i^2$ 和 $P_j=p_j^2$。由于节点压力 $p_k$ 必须为正，我们可以写成 $p_i = \\sqrt{P_i}$ 和 $p_j = \\sqrt{P_j}$。将这些代入压缩机关系式得到：\n$$\n\\sqrt{P_j} = r_{ij} \\sqrt{P_i}\n$$\n对等式两边平方得到：\n$$\nP_j = (r_{ij})^2 P_i \\implies P_j = r_{ij}^2 P_i\n$$\n这是关于变量 $P_i$ 和 $P_j$ 的齐次线性等式。线性约束是线性规划 (LP) 和混合整数线性规划 (MILP) 的基本组成部分，这些是易于处理的优化问题类别之一。将非线性压缩机模型转换为线性模型是压力平方公式的一个显著实际优势。\n\n**结论：正确**\n\n**C. 压力边界 $p_i^{\\min} \\le p_i \\le p_i^{\\max}$ 转换为关于 $P_i$ 的凸二次不等式，这些不等式是非线性的，并且倾向于破坏原本线性规划的凸性。**\n\n压力边界为 $p_i^{\\min} \\le p_i \\le p_i^{\\max}$。使用 $p_i = \\sqrt{P_i}$（对 $p_i  0$ 有效），并假设 $0  p_i^{\\min}$，我们可以对不等式两边平方：\n$$\n(p_i^{\\min})^2 \\le P_i \\le (p_i^{\\max})^2\n$$\n这些是对变量 $P_i$ 的简单箱式约束。它们是关于 $P_i$ 的*线性不等式*。它们不是二次的，也不是非线性的。由 $c_1 \\le P_i \\le c_2$ 定义的可行域是一个区间，它是一个凸集。向线性或凸规划中添加线性约束（如这些边界）会保持其凸性。该陈述在所有方面都是不正确的。\n\n**结论：不正确**\n\n**D. 如果达西-魏斯巴赫摩擦系数取决于雷诺数，从而取决于流量，那么连接 $P_i - P_j$ 和 $q_{ij}^2$ 的系数将变得与流量相关，这会削弱或消除在恒定属性假设下成立的 $P$ 坐标系中的线性关系。**\n\n达西-魏斯巴赫摩擦系数 $f_{ij}$ 通常是雷诺数 $Re$ 和管道相对粗糙度的函数。雷诺数为 $Re = \\rho v D / \\mu = |q|D/(A\\mu)$，其中 $\\mu$ 是动力粘度。因此，$f_{ij}$ 是质量流率 $|q_{ij}|$ 的函数。管道系数 $k_{ij}$ 定义为 $k_{ij} = \\frac{f_{ij} L_{ij} ZRT}{D_{ij}A_{ij}^2}$。如果 $f_{ij}$ 取决于 $|q_{ij}|$，那么 $k_{ij}$ 也同样，即 $k_{ij}(|q_{ij}|)$。管道流动方程变为：\n$$\nP_i - P_j = k_{ij}(|q_{ij}|) q_{ij} |q_{ij}|\n$$\n该方程在变量 $P_i$ 和 $P_j$ 中保持线性（即形式为 $1 \\cdot P_i - 1 \\cdot P_j = F(q_{ij})$）。然而，整个关系在右侧不再是 $q_{ij}$ 的简单二次函数。恒定 $f_{ij}$ 模型的关键优势在于它将压力和流量变量分离为 $P_i - P_j = \\text{常数} \\times (q_{ij} \\text{的函数})$ 的形式。当这个“常数”本身依赖于 $q_{ij}$ 时，这种清晰的分离就消失了，使得方程在优化模型中变得更加非线性且难以处理。“消除 P 坐标系中的线性关系”这种说法虽然不精确，但其意图——即从 $P_i$ 和 $P_j$ 的线性形式中获得的实际好处被大大削弱，因为右侧变成了 $q_{ij}$ 的一个更复杂的非多项式函数——是管道建模中一个有效且关键的观点。这种复杂性削弱了该变换的效用。\n\n**结论：正确**\n\n**E. 重新参数化为 $P_i = p_i^2$ 会自动改善数值条件，因为对于 $p_i, p_j  0$，总是有 $|P_i - P_j|  |p_i - p_j|$ 成立。**\n\n核心主张是对于所有 $p_i, p_j  0$，都有 $|p_i^2 - p_j^2|  |p_i - p_j|$。我们可以对左侧进行因式分解：$|(p_i-p_j)(p_i+p_j)|  |p_i-p_j|$，即 $|p_i-p_j| |p_i+p_j|  |p_i-p_j|$。如果 $p_i \\neq p_j$，我们可以除以 $|p_i-p_j|$（一个正数），得到 $|p_i+p_j|  1$。由于 $p_i, p_j  0$，这简化为 $p_i+p_j  1$。\n这个不等式并不总是成立。其有效性取决于压力的大小，而压力的大小又取决于所使用的单位。例如，如果压力以大气压 (atm) 为单位，且我们有 $p_i = 0.5$ atm 和 $p_j = 0.4$ atm，那么 $p_i+p_j = 0.9$，不大于 $1$。在这种情况下， $|P_i - P_j| = |0.25 - 0.16| = 0.09$ 且 $|p_i - p_j| = 0.1$，所以 $|P_i - P_j|  |p_i - p_j|$。该陈述的前提是错误的。因此，其“自动改善数值条件”的结论是毫无根据的。\n\n**结论：不正确**\n\n**F. 在压力平方公式中，$P_i - P_j$ 的符号唯一地决定了每条管道上 $q_{ij}$ 的符号，因此在所有网络优化情境中，用于表示流动方向的二进制变量都是不必要的。**\n\n陈述的第一部分是正确的。从关系式 $P_i - P_j = k_{ij} q_{ij} |q_{ij}|$ 可知，由于 $k_{ij}  0$，$P_i - P_j$ 的符号必须与 $q_{ij} |q_{ij}|$ 的符号相匹配，而后者由 $q_{ij}$ 的符号决定。因此，$\\text{sign}(P_i - P_j) = \\text{sign}(q_{ij})$。\n然而，“在所有网络优化情境中，用于表示流动方向的二进制变量都是不必要的”这一结论是错误的。在优化中，需要二进制变量往往是为了处理非凸性以找到全局最优解。约束 $P_i - P_j = k_{ij} q_{ij} |q_{ij}|$ 是非凸的。当为一个需要凸表示的求解器（例如，混合整数二阶锥规划，MISOCP）构建问题时，一种标准技术是引入一个二进制变量 $y_{ij}$，用于在两个不同的凸松弛之间进行选择，每个方向一个。例如，可以使用“大M”公式或析取规划来对此关系建模，这两种方法通常都需要二进制变量来捕捉与流动方向相对应的“如果-那么”逻辑。因此，尽管存在物理上的确定性，但二进制变量通常是为求得非凸优化问题的最优解而必需的建模工具。\n\n**结论：不正确**",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "在建立并构建了模型方程之后，最后一步是求解它们。由于控制天然气管网的方程组是非线性的，我们依赖于数值方法求解。这项实践通过为一个简单管网计算单次牛顿迭代，提供了一个手动演练牛顿-拉夫逊方法（Newton-Raphson method）的机会，让你清晰地了解驱动行业标准模拟软件的算法内核。",
            "id": "4107337",
            "problem": "考虑一个稳态天然气管网，该管网由两个节点（节点 $1$ 和节点 $2$）组成，通过一根从节点 $1$ 指向节点 $2$ 的单管道连接。供应节点 $1$ 是压力控制的，具有固定压力 $p_1 = 50$ bar。需求节点 $2$ 有一个固定的提取量 $d_2 = 5$ 标准立方米/秒 (Sm$^3$/s)，其中“标准立方米/秒 (Sm$^3$/s)”表示标准条件下的体积流量。管道的稳态压力-流量关系由 Weymouth 方程给出\n$$\nq_{12} |q_{12}| = \\alpha \\left(p_1^2 - p_2^2\\right),\n$$\n其中已知摩擦系数为 $\\alpha = 0.02$ Sm$^6$/s$^2$·bar$^{-2}$。假设流动为等温流，气体性质恒定，且流量从节点 $1$ 到节点 $2$ 的方向为正。在节点 $2$，稳态质量守恒要求净流入量与固定提取量相平衡。\n\n你将使用牛顿步法求解非线性残差方程，状态向量为 $x = (p_2, q_{12})$，其中 $p_2$ 是节点 $2$ 的压力，$q_{12}$ 是从节点 $1$ 到节点 $2$ 的流量。残差向量由 (i) 节点 $2$ 的质量平衡和 (ii) 管道的压力-流量关系构成。从当前迭代值 $p_2^{(k)} = 49$ bar 和 $q_{12}^{(k)} = 3$ Sm$^3$/s 开始：\n\n- 基于上述物理定律，从第一性原理推导残差和雅可比矩阵。\n- 通过求解由当前迭代点的雅可比矩阵和残差值定义的线性系统，计算一个完整的牛顿步 $\\Delta x$。\n- 更新状态以获得 $(p_2^{(k+1)}, q_{12}^{(k+1)})$。\n- 从物理上解释更新方向，即管道中的压降和流量调整。\n\n报告 $(p_2^{(k+1)}, q_{12}^{(k+1)})$ 的数值，保留四位有效数字。将 $p_2$ 以 bar 为单位，将 $q_{12}$ 以 Sm$^3$/s 为单位表示。按 $(p_2^{(k+1)}, q_{12}^{(k+1)})$ 的顺序提供最终的数值对。",
            "solution": "根据既定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **网络结构**：两个节点（1 和 2）由一根从节点 $1$ 到节点 $2$ 的单管道连接。\n- **节点 1 (供应)**：固定压力，$p_1 = 50$ bar。\n- **节点 2 (需求)**：固定提取量，$d_2 = 5$ Sm$^3$/s。\n- **管道流方程 (Weymouth)**：$q_{12} |q_{12}| = \\alpha (p_1^2 - p_2^2)$。\n- **管道摩擦系数**：$\\alpha = 0.02$ Sm$^6$/s$^2$·bar$^{-2}$。\n- **状态向量**：$x = (p_2, q_{12})$，其中 $p_2$ 是节点 $2$ 的压力，$q_{12}$ 是管道中的流量。\n- **初始迭代值**：$x^{(k)} = (p_2^{(k)}, q_{12}^{(k)}) = (49 \\text{ bar}, 3 \\text{ Sm}^3/\\text{s})$。\n- **假设**：稳态、等温流、恒定的气体性质，流量 $q_{12}$ 从节点 $1$到节点 $2$ 为正。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题具有科学依据。它采用了 Weymouth 方程（一个用于高压天然气流动的标准且经过经验验证的模型）和一个节点的质量守恒原理。使用 Newton-Raphson 方法是求解由此产生的非线性方程组的标准数值技术。\n- **适定性**：该问题是适定的。它定义了两个未知变量（$p_2$，$q_{12}$），并提供了两个独立的方程：一个用于节点 $2$ 的质量平衡，另一个用于管道的压力-流量关系。方程的数量与未知数的数量相匹配。\n- **客观性**：该问题以客观、定量的术语陈述。所有参数都明确定义，没有主观或模糊的语言。\n- **一致性**：单位是一致的。对于 Weymouth 方程，左侧 $q_{12} |q_{12}|$ 的单位是 $(\\text{Sm}^3/\\text{s})^2 = \\text{Sm}^6/\\text{s}^2$。右侧 $\\alpha (p_1^2 - p_2^2)$ 的单位是 $(\\text{Sm}^6/\\text{s}^2\\cdot\\text{bar}^{-2}) \\cdot (\\text{bar}^2) = \\text{Sm}^6/\\text{s}^2$。单位匹配。所提供的数据对于输气管网是物理上合理的。\n\n### 步骤 3：结论与行动\n该问题在科学上有效、适定、客观且内部一致。我们可以继续进行求解。\n\n### 求解推导\n该问题要求使用 Newton-Raphson 方法的一步来求解非线性方程组。设状态向量为 $x = \\begin{pmatrix} p_2 \\\\ q_{12} \\end{pmatrix}$。该方法的核心是求解线性系统 $J(x^{(k)}) \\Delta x^{(k)} = -F(x^{(k)})$，其中 $F(x)$ 是残差向量，$J(x)$ 是雅可比矩阵，$x^{(k)}$ 是当前迭代值，$\\Delta x^{(k)}$ 是更新步长。\n\n**1. 建立残差方程**\n我们定义一个残差向量 $F(x)$，使得在解处 $F(x) = 0$。该向量由两个方程组成：\n\n(i) **节点 2 的质量平衡**：在稳态下，流入一个节点的总流量必须等于流出该节点的总流量。流入量为 $q_{12}$，提取量（需求）为 $d_2$。\n$$ q_{12} = d_2 $$\n第一个残差方程 $F_1$ 是：\n$$ F_1(p_2, q_{12}) = q_{12} - d_2 = 0 $$\n\n(ii) **管道压力-流量关系**：Weymouth 方程关联了流量和压降。鉴于流量为正 ($q_{12}  0$) 的假设，我们有 $|q_{12}| = q_{12}$。方程简化为：\n$$ q_{12}^2 = \\alpha (p_1^2 - p_2^2) $$\n第二个残差方程 $F_2$ 是：\n$$ F_2(p_2, q_{12}) = q_{12}^2 - \\alpha (p_1^2 - p_2^2) = 0 $$\n综合这些，残差向量为：\n$$ F(x) = \\begin{pmatrix} F_1(p_2, q_{12}) \\\\ F_2(p_2, q_{12}) \\end{pmatrix} = \\begin{pmatrix} q_{12} - d_2 \\\\ q_{12}^2 + \\alpha p_2^2 - \\alpha p_1^2 \\end{pmatrix} $$\n\n**2. 推导雅可比矩阵**\n雅可比矩阵 $J(x)$ 是 $F(x)$ 关于状态变量的一阶偏导数矩阵：\n$$ J(x) = \\frac{\\partial F}{\\partial x} = \\begin{pmatrix} \\frac{\\partial F_1}{\\partial p_2}  \\frac{\\partial F_1}{\\partial q_{12}} \\\\ \\frac{\\partial F_2}{\\partial p_2}  \\frac{\\partial F_2}{\\partial q_{12}} \\end{pmatrix} $$\n计算每个偏导数：\n- $\\frac{\\partial F_1}{\\partial p_2} = \\frac{\\partial}{\\partial p_2}(q_{12} - d_2) = 0$\n- $\\frac{\\partial F_1}{\\partial q_{12}} = \\frac{\\partial}{\\partial q_{12}}(q_{12} - d_2) = 1$\n- $\\frac{\\partial F_2}{\\partial p_2} = \\frac{\\partial}{\\partial p_2}(q_{12}^2 + \\alpha p_2^2 - \\alpha p_1^2) = 2 \\alpha p_2$\n- $\\frac{\\partial F_2}{\\partial q_{12}} = \\frac{\\partial}{\\partial q_{12}}(q_{12}^2 + \\alpha p_2^2 - \\alpha p_1^2) = 2 q_{12}$\n\n雅可比矩阵是：\n$$ J(p_2, q_{12}) = \\begin{pmatrix} 0  1 \\\\ 2 \\alpha p_2  2 q_{12} \\end{pmatrix} $$\n\n**3. 计算牛顿步**\n我们现在在给定的迭代点 $x^{(k)} = (p_2^{(k)}, q_{12}^{(k)}) = (49, 3)$ 处计算残差向量 $F$ 和雅可比矩阵 $J$。常数为 $p_1 = 50$，$d_2 = 5$ 和 $\\alpha = 0.02$。\n\n- **计算残差向量 $F^{(k)} = F(x^{(k)})$**：\n$$ F_1^{(k)} = q_{12}^{(k)} - d_2 = 3 - 5 = -2 $$\n$$ F_2^{(k)} = (q_{12}^{(k)})^2 - \\alpha((p_1)^2 - (p_2^{(k)})^2) = 3^2 - 0.02(50^2 - 49^2) = 9 - 0.02(2500 - 2401) = 9 - 0.02(99) = 9 - 1.98 = 7.02 $$\n因此，残差向量为 $F^{(k)} = \\begin{pmatrix} -2 \\\\ 7.02 \\end{pmatrix}$。\n\n- **计算雅可比矩阵 $J^{(k)} = J(x^{(k)})$**：\n$$ J_{11} = 0 $$\n$$ J_{12} = 1 $$\n$$ J_{21} = 2 \\alpha p_2^{(k)} = 2(0.02)(49) = 1.96 $$\n$$ J_{22} = 2 q_{12}^{(k)} = 2(3) = 6 $$\n因此，雅可比矩阵为 $J^{(k)} = \\begin{pmatrix} 0  1 \\\\ 1.96  6 \\end{pmatrix}$。\n\n- **求解线性系统 $J^{(k)} \\Delta x^{(k)} = -F^{(k)}$**：\n设牛顿步为 $\\Delta x^{(k)} = \\begin{pmatrix} \\Delta p_2 \\\\ \\Delta q_{12} \\end{pmatrix}$。该系统为：\n$$ \\begin{pmatrix} 0  1 \\\\ 1.96  6 \\end{pmatrix} \\begin{pmatrix} \\Delta p_2 \\\\ \\Delta q_{12} \\end{pmatrix} = - \\begin{pmatrix} -2 \\\\ 7.02 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -7.02 \\end{pmatrix} $$\n这展开为两个线性方程组：\n1) $0 \\cdot \\Delta p_2 + 1 \\cdot \\Delta q_{12} = 2$\n2) $1.96 \\cdot \\Delta p_2 + 6 \\cdot \\Delta q_{12} = -7.02$\n\n从方程 (1) 中，我们立即得到：\n$$ \\Delta q_{12} = 2 $$\n将此代入方程 (2)：\n$$ 1.96 \\cdot \\Delta p_2 + 6(2) = -7.02 $$\n$$ 1.96 \\cdot \\Delta p_2 + 12 = -7.02 $$\n$$ 1.96 \\cdot \\Delta p_2 = -19.02 $$\n$$ \\Delta p_2 = \\frac{-19.02}{1.96} \\approx -9.7040816 $$\n\n**4. 更新状态**\n新状态 $x^{(k+1)}$ 通过将步长 $\\Delta x^{(k)}$ 加到前一个状态 $x^{(k)}$ 上得到：\n$$ x^{(k+1)} = x^{(k)} + \\Delta x^{(k)} $$\n$$ p_2^{(k+1)} = p_2^{(k)} + \\Delta p_2 = 49 + (-9.7040816) = 39.2959184 \\text{ bar} $$\n$$ q_{12}^{(k+1)} = q_{12}^{(k)} + \\Delta q_{12} = 3 + 2 = 5 \\text{ Sm}^3/\\text{s} $$\n\n将结果四舍五入到四位有效数字：\n$$ p_2^{(k+1)} = 39.30 \\text{ bar} $$\n$$ q_{12}^{(k+1)} = 5.000 \\text{ Sm}^3/\\text{s} $$\n\n**5. 更新的物理解释**\n- **流量更新 ($\\Delta q_{12} = +2$ Sm$^3$/s)**：初始流量为 $q_{12}^{(k)} = 3$ Sm$^3$/s，而节点 $2$ 的需求为 $d_2 = 5$ Sm$^3$/s。这在质量平衡方程中产生了 $-2$ Sm$^3$/s 的残差（不足）。流量的牛顿步 $\\Delta q_{12} = +2$ Sm$^3$/s 直接修正了这个不足。更新后的流量 $q_{12}^{(k+1)} = 5$ Sm$^3$/s 现在完全满足需求。流量变量的这种单步收敛是因为质量平衡方程是线性的。\n\n- **压力更新 ($\\Delta p_2 \\approx -9.70$ bar)**：初始状态（$p_2=49$ bar, $q_{12}=3$ Sm$^3$/s）违反了 Weymouth 方程。正残差 $F_2^{(k)} = 7.02$ 表明，对于初始压降（$p_1=50$, $p_2=49$），$3$ Sm$^3$/s 的流量过高（或者反过来说，对于该流量，压降过低）。牛顿步必须调整状态以同时满足两个方程。由于流量必须增加到 $5$ Sm$^3$/s 以满足需求，因此需要管道两端有更大的压降来驱动这个更高的流量。由于 $p_1$ 是固定的，这个增加的压降必须通过降低 $p_2$ 来实现。大的负更新量 $\\Delta p_2 \\approx -9.70$ bar 反映了这一物理要求。新压力 $p_2^{(k+1)} \\approx 39.30$ bar 产生了更大的压差（$50$ bar 对比 $39.30$ bar），这与流量需要增加到 $5$ Sm$^3$/s 是一致的。",
            "answer": "$$ \\boxed{\\begin{pmatrix} 39.30  5.000 \\end{pmatrix}} $$"
        }
    ]
}