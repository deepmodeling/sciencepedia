## 引言
天然气作为现代能源体系的支柱，其安全、高效的输送依赖于庞大而复杂的管网系统。对这一关键基础设施进行精确的数学建模，是实现优化调度、保障供应安全和进行战略规划的基石。然而，将气体在高压下复杂的物理行为转化为一个可计算、可分析的整个[网络模型](@entry_id:136956)，构成了一个核心的科学与工程挑战。本文旨在系统性地解决这一问题，为读者提供一个从理论基础到实际应用的完整知识框架。

在接下来的内容中，您将踏上一段从基础到前沿的旅程。第一章“原理与机制”将深入剖析构成[稳态模型](@entry_id:157508)的物理定律和数学方程，从气体[状态方程](@entry_id:274378)到管道和压缩机的建模，最终构建起完整的网络方程组。第二章“应用与跨学科连接”将展示这些模型如何应用于日常运营、容量规划、N-1安全分析，并进一步探讨其在气体质量追踪以及与[电力](@entry_id:264587)系统等关键领域耦合中的作用。最后，第三章“动手实践”将提供具体问题，让您亲手应用所学知识，巩固对核心概念的理解。通过本次学习，您将能够掌握天然[气管](@entry_id:274814)网[稳态](@entry_id:139253)建模的核心技能。

## 原理与机制

对天然气管网进行[稳态](@entry_id:139253)建模，其核心在于精确描述气体在压力、温度和流动状态下的物理行为，并将这些行为整合到一个由节点和边构成的网络数学框架中。本章将系统性地阐述构成这些模型的关键物理原理和数学机制，从气体的基本热力学性质出发，逐步构建管道和压缩机的数学表达，最终形成一个完整且自洽的管网方程组。

### 气体性质与[状态方程](@entry_id:274378)

[稳态模型](@entry_id:157508)的基础是对天然气物理性质的准确描述。尽管理想气体定律（$p = \rho R_s T$）为气体行为提供了一个初步近似，但它忽略了在高压下变得显著的[分子间作用力](@entry_id:203760)。为了修正这一偏差，我们引入了**[压缩因子](@entry_id:145979) (compressibility factor)** $Z$，它是一个无量纲量，用于量化[真实气体](@entry_id:136821)相对于[理想气体](@entry_id:200096)的行为偏差。[真实气体状态方程](@entry_id:154572)通常写作：

$p = Z \rho R_s T$

其中，$p$ 是[绝对压力](@entry_id:144445)，$\rho$ 是密度，$R_s$ 是特定气体常数，$T$ 是绝对温度。根据定义，$Z$ 是真实气体在给定压力和温度下所占的[摩尔体积](@entry_id:145604) $V_m$ 与其在同等条件下作为[理想气体](@entry_id:200096)时所占的[摩尔体积](@entry_id:145604) $V_{m, \text{ideal}}$ 之比，即 $Z = V_m / V_{m, \text{ideal}}$。对于理想气体，$Z$ 恒等于1。

在天然气输送系统常见的高压（如 $3-10 \, \text{MPa}$）和常温条件下，分子间的吸[引力](@entry_id:189550)占主导地位，使得气体分子比理想气体情况下靠得更近。这导致其体积被“压缩”，因此压缩因子 $Z$ 通常小于1。例如，一个典型的甲烷含量为 $0.95$ 的天然气混合物，在 $30 \, \text{bar}$ 和 $300 \, \text{K}$ 的条件下，其[压缩因子](@entry_id:145979) $Z$ 的值约在 $0.88$ 左右 。这意味着，在相同压力和温度下，该[真实气体](@entry_id:136821)的密度比[理想气体](@entry_id:200096)高出约 $1/0.88 \approx 1.14$ 倍。忽略 $Z$ 的影响将导致对管道中气体质量和能量含量的严重低估。

在天然气工业中，流量通常以**[标准状况](@entry_id:138214) (standard conditions)** 下的体积来计量，例如“标准立方米 (standard cubic meters)”。[标准状况](@entry_id:138214)定义了一组参考压力 $p_s$ 和参考温度 $T_s$（例如，$101.325 \, \text{kPa}$ 和 $288.15 \, \text{K}$）。然而，管道内的实际测量是在**实际运行状况 (actual operating conditions)**（$p_a, T_a$）下进行的。因此，将实际体积流量 $Q_a$ 转换为标准体积流量 $Q_s$ 是至关重要的。

这一转换基于[质量守恒](@entry_id:204015)原理，即摩尔流量 $\dot{n}$ 在不同状况下是不变的。利用[真实气体状态方程](@entry_id:154572) $p V = \dot{n} Z R_u T$（其中 $R_u$ 是[通用气体常数](@entry_id:136843)），我们可以分别写出在实际和[标准状况](@entry_id:138214)下的摩尔流量：

$\dot{n} = \dfrac{p_a Q_a}{Z_a T_a R_u} = \dfrac{p_s Q_s}{Z_s T_s R_u}$

其中，$Z_a$ 和 $Z_s$ 分别是实际和[标准状况](@entry_id:138214)下的[压缩因子](@entry_id:145979)。求解 $Q_s$ 可得转换公式 ：

$Q_s = Q_a \left(\dfrac{p_a}{p_s}\right) \left(\dfrac{T_s}{T_a}\right) \left(\dfrac{Z_s}{Z_a}\right)$

这个公式是气体计量和交易的基础。由于标准压力 $p_s$ 很低，标准[压缩因子](@entry_id:145979) $Z_s$ 非常接近于1。然而，实际运行压力 $p_a$ 很高，使得 $Z_a$ 显著小于1。因此，[压缩因子](@entry_id:145979)比率 $(Z_s/Z_a)$ 是一个大于1的修正项，对于精确计算至关重要。

### [管道流动](@entry_id:270234)建模：压力-流量关系

管道是天然气网络中最基本的元件。描述管道中压力与流量关系的数学模型源于[流体动力](@entry_id:750449)学基本原理。对于水平管道中的[稳态](@entry_id:139253)、等温、[湍流](@entry_id:151300)，其一维动量守恒方程可以简化为压力梯度与壁面摩擦力的平衡 ：

$\dfrac{dp}{dx} = - \dfrac{f}{2D} \rho v^2$

其中，$x$ 是沿管道的轴向坐标，$f$ 是达西-魏斯巴赫摩擦因子，$D$ 是管道内径，$\rho$ 是气体密度，$v$ 是流速。为了得到一个只包含端点压力和总流量的关系，我们需要利用质量守恒方程（[稳态](@entry_id:139253)下质量流量 $w$ 为常数，$w = \rho A v$）和[真实气体状态方程](@entry_id:154572)（$\rho = p / (Z R_s T)$）来消去局部变量 $\rho$ 和 $v$。

经过代换和沿管道长度 $L$ 从上游节点 $i$ 到下游节点 $j$ 积分，我们得到以下关系式（假设 $Z$ 和 $f$ 为常数）：

$p_i^2 - p_j^2 = \left(\dfrac{f L R_s T Z}{D A^2}\right) w^2$

这个方程通常被称为**魏斯茅斯方程 (Weymouth equation)**。它揭示了管道两端的**压力平方差**与**质量流量的平方**成正比。

在[网络建模](@entry_id:262656)中，我们通常为每条边 $e$ 分配一个任意的**参考方向**（例如，从节点 $i$ 指向 $j$），并定义一个**有符号流量 (signed flow)** $q_e$，当实际流向与参考方向一致时为正，相反时为负。然而，上述方程中的 $w^2$ 项总是非负的，无法区分流动方向。为了解决这个问题，并确保模型在物理上一致（即压力总是沿流动方向下降），必须将压力-流量关系表达为一个奇次的、单调递增的函数。一个既满足物理直觉又在数学上稳健的形式是  ：

$p_i^2 - p_j^2 = \alpha_e q_e |q_e|$

其中，$\alpha_e$ 是一个恒为正的[管道阻力](@entry_id:265000)系数，它综合了管道的几何形状（$L, D$）、摩擦特性（$f$）和气体性质（$R_s, T, Z$）。表达式 $q_e|q_e|$ （等价于 $\text{sgn}(q_e)q_e^2$）完美地实现了我们的目标：当 $q_e > 0$ 时（从 $i$ 流向 $j$），$p_i^2 - p_j^2 > 0$，即 $p_i > p_j$；当 $q_e < 0$ 时（从 $j$ 流向 $i$），$p_i^2 - p_j^2 < 0$，即 $p_i < p_j$。这种表述确保了无论选择哪个参考方向，模型的物理意义都是一致的。如果我们将边的参考方向从 $(i \to j)$ 翻转为 $(j \to i)$，新的有符号流量 $q'_{e}$ 将等于 $-q_e$，而新的压力平方差将是 $p_j^2 - p_i^2$，也恰好是原压力平方差的负值。这样，方程两边同时变号，物理定律保持不变 。

值得注意的是，不同的[管道流动](@entry_id:270234)方程（如 **Panhandle A/B 方程**）本质上是对摩擦因子 $f$ 的不同处理方式。魏斯茅斯方程假设流动处于**完全粗糙[湍流](@entry_id:151300)区 (fully rough turbulent flow)**，此时摩擦因子 $f$ 仅依赖于管道的[相对粗糙度](@entry_id:264325)，而与雷诺数（即流量）无关。相比之下，Panhandle A/B 方程是基于大量实际管道数据得到的半经验公式，它们隐式地假设摩擦因子 $f$ 仍然是雷诺数的函数（$f \propto Re^{-a}$），这更适用于**过渡粗糙区 (transitionally rough regime)** 的流动 。

### 主动元件建模：压缩机

与被动消耗能量的管道不同，压缩机是向[气体注入](@entry_id:749726)能量以提高其压力的主动元件。在[稳态模型](@entry_id:157508)中，一个理想的压缩机 $c$（位于从节点 $i$ 到 $j$ 的边上）的作用可以简单地用一个**[压缩比](@entry_id:136279) (compression ratio)** $r_c$ 来描述，即出口压力 $p_j$ 是进口压力 $p_i$ 的倍数：

$p_j = r_c p_i$

由于管道模型通常使用压力平方 $w_i = p_i^2$ 作为变量，压缩机模型也相应地转换为 ：

$w_j = r_c^2 w_i$

其中 $r_c \ge 1$。

实际运行中，压缩机不能无限制地工作，其性能受到一系列**运行约束 (operational constraints)** 的限制。一个完整的模型必须包含这些[不等式约束](@entry_id:176084)，它们共同定义了压缩机的可行操作范围 。主要约束包括：

1.  **最低[吸气](@entry_id:186124)压力 (Minimum Suction Pressure)**: $p_i \ge p_i^{\min}$。为保护上游管道和压缩机自身免受过低压力损害。
2.  **最高排气压力 (Maximum Discharge Pressure)**: $p_j \le p_j^{\max}$。由下游管道的材料强度和安全标准决定。
3.  **最高压缩比 (Maximum Compression Ratio)**: $p_j / p_i \le r_c^{\max}$。由压缩机的设计和避免过高排气温度的需要决定。
4.  **[最大功](@entry_id:143924)率 (Maximum Power)**: $P_{ij} \le P_{ij}^{\max}$。由驱动压缩机的发动机或电动机的额定功率决定。

压缩机消耗的功率 $P_{ij}$ 是一个关键的运行参数。对于[绝热压缩](@entry_id:142708)过程，基于[热力学第一定律](@entry_id:146485)，并考虑**[等熵效率](@entry_id:146923) (isentropic efficiency)** $\eta_c$，功率可以表示为：

$P_{ij} = \dfrac{\dot{m}_{ij} c_p T_i}{\eta_c} \left[ \left( \dfrac{p_j}{p_i} \right)^{(k-1)/k} - 1 \right]$

其中，$\dot{m}_{ij}$ 是流经压缩机的[质量流](@entry_id:143424)量，$c_p$ 是气体的定[压比](@entry_id:137698)热容，$T_i$ 是[吸气](@entry_id:186124)温度，$k$ 是比热比。这个公式将热力学性质与运行变量（压力、流量）联系起来，是优化管网运行成本的核心。

### 构建[网络模型](@entry_id:136956)

一个完整的天然[气管](@entry_id:274814)网[稳态模型](@entry_id:157508)由一组[代数方程](@entry_id:272665)构成，这些方程描述了网络中所有节点和边的物理定律 。

**1. 变量 (Variables):**
*   **节点变量**: 每个节点的压力平方 $w_i$。
*   **边变量**: 每条边（管道或压缩机）的有符号[质量流](@entry_id:143424)量 $q_e$。
*   对于可控压缩机，压缩比 $r_c$ 也可以是决策变量。

**2. 方程 (Equations):**
*   **节点质量平衡方程 (Nodal Mass Balance)**: 在每个非[参考节点](@entry_id:272245) $i$，流入该节点的[质量流](@entry_id:143424)量总和必须等于流出该节点的质量流量总和加上该节点的净消耗（需求）。这可以利用**[关联矩阵](@entry_id:263683) (incidence matrix)** $\tilde{A}$ 紧凑地表示为：

    $\tilde{A} q = d$

    其中，$q$ 是所有边流量组成的向量，$d$ 是所有非[参考节点](@entry_id:272245)的净消耗（或注入）组成的向量。

*   **边[本构方程](@entry_id:138559) (Edge Constitutive Laws)**: 为网络中的每一条边 $e$ 提供一个压力-流量关系。
    *   对于管道：$w_i - w_j = \alpha_e q_e |q_e|$
    *   对于压缩机：$w_j = r_c^2 w_i$

**平衡节点 (Slack Node) 的选择**

在上述方程组中，存在一个固有的自由度。观察管道方程可知，流量仅取决于**压力平方的差值**（$w_i - w_j$），而不取决于其绝对值。这意味着，如果我们将所有节点的压力平方值都增加一个相同的常数 $c$（即 $\phi' = \phi + c\mathbf{1}$，其中 $\phi$ 是压力平方向量），管道两端的压力平[方差保持](@entry_id:634352)不变，因此流量 $q$ 也将保持不变。这导致了方程组有无穷多组解。

为了得到唯一解，我们必须移除这个自由度。最直接的方法是指定网络中一个节点的压力值。这个被指定压力的节点被称为**平衡节点**或**[参考节点](@entry_id:272245) (slack/reference node)** 。通常，选择一个压力受严格调控的大型气源点或城市门站作为平衡节点，并将其压力平方 $\phi_r$ 固定为一个已知值。这相当于在电路中设定一个“接地”电位，为所有其他节点的压力提供了一个参考基准，从而使得整个网络的[压力分布](@entry_id:275409)得以唯一确定。需要强调的是，选择平衡节点并固定其压力，与满足全网质量守恒（即总注入等于总需求，$\mathbf{1}^T s = 0$）是两个独立的要求。

### 高级考量与模型精化

虽然上述模型构成了天然气管网[稳态分析](@entry_id:271474)的核心，但在实际应用中，我们还需要考虑一些更复杂的物理效应。

**非等温流动**

“等温”假设在许多情况下是合理的，但其有效性取决于管道的[热力学](@entry_id:172368)环境。管道内气体的温度实际上由多种效应共同决定：与周围环境（如土壤）的**热交换**、[气体膨胀](@entry_id:171760)引起的**[焦耳](@entry_id:147687)-汤姆逊效应 ([Joule-Thomson effect](@entry_id:136803))**（对于天然气通常是冷却效应），以及摩擦产生的热量。

我们可以通过一个**[热平衡](@entry_id:157986)长度 (thermal equilibration length)** $L_T$ 来评估等温假设的合理性 ：

$L_T \sim \dfrac{\dot{m} c_p}{U P}$

其中 $U$ 是[总传热系数](@entry_id:151629)，$P$ 是管道内壁[周长](@entry_id:263239)。$L_T$ 表征了气体温度趋近于环境温度所需的距离。如果管道长度 $L$ 远大于 $L_T$（$L \gg L_T$），意味着热交换效应占主导地位。在这种情况下，如果环境温度恒定，气体温度将在大部分管道长度上被“钉”在环境温度附近，等温假设是相当准确的。例如，对于一条埋地长输管道，其 $L$ 可能为 $100 \, \text{km}$，而计算出的 $L_T$ 可能约为 $44 \, \text{km}$。这表明热交换是主导因素，加之[焦耳](@entry_id:147687)-汤姆逊效应引起的总温降可能只有 $0.5 \, \text{K}$ 左右，因此采用等温模型是完全可信的。反之，对于短的、绝热良好的管道，或流经剧烈压力变化的设备时，温度变化可能非常显著，必须采用更复杂的非等温模型。

**压力相关的压缩因子与[解的唯一性](@entry_id:143619)**

在前面的推导中，我们假设压缩因子 $Z$ 是一个常数。然而，在更精确的模型中，$Z$ 是压力和温度的函数。在等温假设下，$Z$ 仍然依赖于压力，即 $Z(p)$。这使得压力-流量关系变得更加复杂。重新进行积分推导，我们得到：

$\int_{p_j}^{p_i} \dfrac{p'}{Z(p')} dp' = \dfrac{R_s T f L}{2 D A^2} w^2$

问题的关键在于，左侧的积分结果不再是简单的 $p_i^2 - p_j^2$。这是否会破坏压力-流量关系的单调性，从而影响网络[解的唯一性](@entry_id:143619)？

为了解决这个问题，我们可以引入一个**势[函数变换](@entry_id:141095) (potential transformation)** 。定义一个新的势函数 $\pi(p)$：

$\pi(p) \equiv \int_{p_0}^{p} \dfrac{p'}{Z(p')} dp'$

其中 $p_0$ 是一个任意的参考压力。由于对于天然气，$p>0$ 且 $Z(p)>0$，被积函数 $p/Z(p)$ 始终为正。因此，$\pi(p)$ 是关于 $p$ 的一个严格单调递增函数。利用这个新的[势函数](@entry_id:176105)，管道方程可以被重写为一个简洁且保持了[单调性](@entry_id:143760)的形式：

$\pi(p_i) - \pi(p_j) = C_e w^2$

（为简化，此处忽略了流量方向）。通过将网络模型建立在势函数 $\pi$ 而非压力平方 $w$ 之上，我们保证了每条管道的“势差-流量”关系是单调的。这种单调性是保证整个[非线性](@entry_id:637147)网络方程组存在唯一解的关键性质。因此，只要 $Z(p)$ 是一个正值函数，即使它随压力有复杂变化，我们依然可以通过势[函数变换](@entry_id:141095)来构建一个数学上良态（well-posed）的[稳态模型](@entry_id:157508)。