{
    "hands_on_practices": [
        {
            "introduction": "The most fundamental link between gas and electric systems is the conversion of fuel into electricity at a power plant. This exercise models this conversion using the heat rate, a key performance metric that describes a generator's efficiency. Mastering this foundational calculation  is the first step toward building any integrated gas-electric model, as it allows you to quantify the precise gas demand imposed by a specific level of power generation.",
            "id": "4092855",
            "problem": "A combined-cycle gas turbine (CCGT) unit is embedded at node $i$ of a coupled natural gas–electric network. The unit’s steady operating point over a one-hour dispatch interval is an electrical power output of $P=400$ MW. The CCGT’s gross heat rate is modeled over the valid operating range by a linear load-dependent function $HR(P)=a+bP$, where $HR(P)$ is the fuel energy input per unit electrical energy output. The Higher Heating Value (HHV) of the pipeline natural gas, measured at the pipeline’s standard conditions, is $\\mathrm{HHV}=38 \\, \\mathrm{MJ}/\\mathrm{m}^3$. The parameters of the heat rate function over this operating interval are $a=7.5\\times 10^{3} \\, \\mathrm{MJ/MWh}$ and $b=-0.8 \\, \\mathrm{MJ}/(\\mathrm{MWh}\\cdot\\mathrm{MW})$. Using energy conservation and the definition of heat rate, compute the CCGT’s volumetric natural gas consumption rate that must appear as a withdrawal term in the nodal gas balance at node $i$, expressed in pipeline flow units of $\\mathrm{m}^3/\\mathrm{h}$. Round your answer to four significant figures and express the final number in $\\mathrm{m}^3/\\mathrm{h}$.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. It provides a complete and consistent set of data and definitions from the field of energy systems engineering, allowing for a unique and meaningful solution. The provided parameters for the combined-cycle gas turbine (CCGT) are realistic. Therefore, a full solution is warranted.\n\nThe core of the problem is to relate the electrical power output of the CCGT to its volumetric rate of natural gas consumption. This is achieved by applying the definitions of heat rate and the energy content of the fuel.\n\nThe heat rate, $HR(P)$, is defined as the fuel energy input per unit of electrical energy output. For a steady operating point, this can be expressed as the ratio of the fuel energy input rate, $\\dot{E}_{\\text{fuel}}$, to the electrical power output, $P$.\n$$HR(P) = \\frac{\\dot{E}_{\\text{fuel}}}{P}$$\nThe units given for the variables are consistent with this definition. The electrical power output $P$ is in megawatts (MW), the heat rate $HR(P)$ is in megajoules per megawatt-hour (MJ/MWh), and the fuel energy rate $\\dot{E}_{\\text{fuel}}$ can thus be expressed in megajoules per hour (MJ/h), since $1 \\, \\mathrm{MW} = 1 \\, \\mathrm{MWh/h}$.\nTherefore, the fuel energy consumption rate can be calculated as:\n$$\\dot{E}_{\\text{fuel}} = HR(P) \\cdot P$$\nThe problem states that the heat rate is a linear function of the power output:\n$$HR(P) = a + bP$$\nSubstituting this into the expression for the fuel energy rate gives:\n$$\\dot{E}_{\\text{fuel}} = (a + bP) \\cdot P$$\nThe next step is to relate this energy consumption rate to the volumetric gas consumption rate, $\\dot{V}_{\\text{gas}}$. The Higher Heating Value, $\\mathrm{HHV}$, of the natural gas provides the link. It is defined as the energy released per unit volume of fuel.\n$$\\mathrm{HHV} = \\frac{\\text{Energy}}{\\text{Volume}}$$\nIn terms of rates, this becomes:\n$$\\mathrm{HHV} = \\frac{\\dot{E}_{\\text{fuel}}}{\\dot{V}_{\\text{gas}}}$$\nThe units are consistent: $\\mathrm{HHV}$ is in $\\mathrm{MJ}/\\mathrm{m}^3$, $\\dot{E}_{\\text{fuel}}$ is in MJ/h, and $\\dot{V}_{\\text{gas}}$ would be in $\\mathrm{m}^3/\\mathrm{h}$.\nRearranging this equation to solve for the volumetric gas consumption rate yields:\n$$\\dot{V}_{\\text{gas}} = \\frac{\\dot{E}_{\\text{fuel}}}{\\mathrm{HHV}}$$\nSubstituting the expression for $\\dot{E}_{\\text{fuel}}$, we obtain the final formula for the gas consumption rate in terms of the given parameters:\n$$\\dot{V}_{\\text{gas}} = \\frac{(a + bP) \\cdot P}{\\mathrm{HHV}}$$\nThe problem provides the following values:\n-   Electrical power output: $P = 400 \\, \\mathrm{MW}$\n-   Heat rate parameter $a$: $a = 7.5 \\times 10^{3} \\, \\mathrm{MJ/MWh}$\n-   Heat rate parameter $b$: $b = -0.8 \\, \\mathrm{MJ}/(\\mathrm{MWh}\\cdot\\mathrm{MW})$\n-   Higher Heating Value: $\\mathrm{HHV} = 38 \\, \\mathrm{MJ}/\\mathrm{m}^3$\n\nFirst, we calculate the specific heat rate at the operating point $P=400$ MW:\n$$HR(400 \\, \\mathrm{MW}) = (7.5 \\times 10^{3}) + (-0.8) \\cdot 400$$\n$$HR(400 \\, \\mathrm{MW}) = 7500 - 320 = 7180 \\, \\mathrm{MJ/MWh}$$\nNext, we calculate the total fuel energy consumption rate, $\\dot{E}_{\\text{fuel}}$:\n$$\\dot{E}_{\\text{fuel}} = HR(400 \\, \\mathrm{MW}) \\cdot P = 7180 \\, \\frac{\\mathrm{MJ}}{\\mathrm{MWh}} \\cdot 400 \\, \\mathrm{MW} = 2,872,000 \\, \\frac{\\mathrm{MJ}}{\\mathrm{h}}$$\nFinally, we compute the volumetric natural gas consumption rate, $\\dot{V}_{\\text{gas}}$, by dividing the fuel energy rate by the Higher Heating Value:\n$$\\dot{V}_{\\text{gas}} = \\frac{2,872,000 \\, \\mathrm{MJ/h}}{38 \\, \\mathrm{MJ}/\\mathrm{m}^3}$$\n$$\\dot{V}_{\\text{gas}} \\approx 75578.947368... \\, \\mathrm{m}^3/\\mathrm{h}$$\nThe problem requires the answer to be rounded to four significant figures. The first four significant digits are $7$, $5$, $5$, and $7$. The fifth digit is $8$, so we round up the fourth digit.\n$$\\dot{V}_{\\text{gas}} \\approx 75580 \\, \\mathrm{m}^3/\\mathrm{h}$$\nThis value represents the volumetric withdrawal rate from the natural gas network at node $i$ required to sustain the CCGT's operation.",
            "answer": "$$\\boxed{75580}$$"
        },
        {
            "introduction": "While a power plant may be highly efficient, its output can be limited by the physical ability of the gas network to deliver sufficient fuel. This practice explores the fluid dynamics of gas pipelines, using a foundational pressure-flow relationship to determine the maximum fuel that can be supplied under given pressure constraints. By connecting pipeline hydraulics directly to generator output , this problem reveals how gas infrastructure can impose a hard cap on electricity production, a critical concept in security-constrained analysis.",
            "id": "4092794",
            "problem": "A single gas-fired generator is supplied directly by a horizontal transmission pipeline connecting an upstream gas node to the generator’s inlet. Assume one-dimensional, steady, isothermal flow of a real gas obeying the ideal gas law corrected by the compressibility factor, and neglect elevation changes. Frictional losses are described by the Darcy–Weisbach formulation. The pipeline has length $L$, inner diameter $D$, cross-sectional area $A$, and Darcy friction factor $f$. The gas has specific gas constant $R_{s}$, average gas temperature $T$, and compressibility factor $Z$ over the pipe. The upstream nodal pressure $p_{u}$ is bounded above, and the generator’s inlet pressure $p_{g}$ must not fall below a minimum to satisfy burner/regulator constraints. The generator converts chemical energy of the fuel into electricity with electrical efficiency $\\eta$, consuming mass flow $\\dot{m}$ of fuel with Lower Heating Value (LHV).\n\nStarting from the steady one-dimensional momentum balance with Darcy–Weisbach friction and the ideal gas law with compressibility factor, derive the steady-state pressure–flow coupling relation linking $\\dot{m}$ to $p_{u}$ and $p_{g}$ for the pipeline. Then, using that relation together with the fuel–power conversion, determine the maximum feasible electric power output $P_{e}^{\\max}$ subject to the bounds\n- $p_{u} \\leq p_{u}^{\\max}$,\n- $p_{g} \\geq p_{g}^{\\min}$,\nand the pipeline and fuel–power coupling constraints. Use the parameter values\n- $L = 60{,}000\\,\\mathrm{m}$, $D = 0.30\\,\\mathrm{m}$, $f = 0.02$, $T = 288\\,\\mathrm{K}$, $Z = 0.90$, $R_{s} = 518\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$,\n- $p_{u}^{\\max} = 5.5 \\times 10^{6}\\,\\mathrm{Pa}$, $p_{g}^{\\min} = 4.8 \\times 10^{6}\\,\\mathrm{Pa}$,\n- $\\eta = 0.58$, $\\mathrm{LHV} = 49 \\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$.\n\nClearly identify which coupling constraint is binding at the maximum and justify it from first principles. Express the final power in $\\mathrm{MW}$ and round your answer to three significant figures.",
            "solution": "The problem will be addressed by first validating its statement and then proceeding to a complete solution if it is deemed valid.\n\n### Step 1: Extract Givens\n-   **Pipeline Geometry:** Length $L = 60{,}000\\,\\mathrm{m}$, inner diameter $D = 0.30\\,\\mathrm{m}$, cross-sectional area $A$.\n-   **Flow & Gas Properties:** Darcy friction factor $f = 0.02$, average gas temperature $T = 288\\,\\mathrm{K}$, specific gas constant $R_{s} = 518\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$, compressibility factor $Z = 0.90$.\n-   **Flow State:** One-dimensional, steady, isothermal flow of a real gas. Elevation changes are neglected.\n-   **Pressure Constraints:** Upstream nodal pressure $p_{u} \\leq p_{u}^{\\max} = 5.5 \\times 10^{6}\\,\\mathrm{Pa}$. Generator inlet pressure $p_{g} \\geq p_{g}^{\\min} = 4.8 \\times 10^{6}\\,\\mathrm{Pa}$.\n-   **Generator Properties:** Electrical efficiency $\\eta = 0.58$, Lower Heating Value of fuel $\\mathrm{LHV} = 49 \\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$.\n-   **Variables:** Mass flow rate $\\dot{m}$, electrical power output $P_{e}$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem is based on established principles of fluid dynamics (Darcy-Weisbach friction), thermodynamics (real gas law via compressibility factor), and energy conversion. The model described (isothermal flow in a long pipeline) is a standard and widely used simplification in gas transmission network analysis. All assumptions are explicitly stated.\n-   **Well-Posed:** The problem provides all necessary parameters and constraints to determine a unique maximum power output. The objective is clearly defined.\n-   **Objective:** The language is technical and precise, free from subjectivity or ambiguity.\n-   **Completeness and Consistency:** The data provided are self-contained and appear consistent. For instance, the units for the specific gas constant ($R_{s}$) correspond to its definition in the ideal gas law formulation $p = \\rho R_s T$. The pressure values are typical for transmission pipelines.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-posed, scientifically grounded problem in energy systems engineering. A full solution will be provided.\n\n### Solution Derivation\n\nThe derivation begins with the one-dimensional steady-state momentum balance for a differential element of the pipeline of length $dx$. Neglecting changes in momentum flux, which is a standard and accurate assumption for long pipelines with subsonic flow, the balance between pressure force and frictional force is:\n$$A dp + \\tau_w P dx = 0$$\nwhere $dp$ is the differential pressure change, $A$ is the cross-sectional area, $\\tau_w$ is the wall shear stress, and $P$ is the wetted perimeter.\n\nThe wall shear stress is related to the Darcy-Weisbach friction factor $f$ by:\n$$\\tau_w = \\frac{f}{8} \\rho v^2$$\nwhere $\\rho$ is the gas density and $v$ is the flow velocity. The pipeline geometry gives $A = \\frac{\\pi D^2}{4}$ and $P = \\pi D$, so the ratio $\\frac{P}{A} = \\frac{4}{D}$. Substituting these into the momentum balance yields:\n$$A dp + \\left(\\frac{f}{8} \\rho v^2\\right) (\\pi D) dx = 0$$\n$$dp = -\\frac{f}{8} \\rho v^2 \\frac{\\pi D}{A} dx = -\\frac{f}{2D} \\rho v^2 dx$$\nThe mass flow rate $\\dot{m}$ is constant in steady state: $\\dot{m} = \\rho A v$. Thus, the velocity is $v = \\frac{\\dot{m}}{\\rho A}$. Substituting for $v$:\n$$dp = -\\frac{f}{2D} \\rho \\left(\\frac{\\dot{m}}{\\rho A}\\right)^2 dx = -\\frac{f \\dot{m}^2}{2DA^2} \\frac{1}{\\rho} dx$$\nThe gas is described by the real gas law, $p = Z \\rho R_s T$. We can express the density term $\\frac{1}{\\rho}$ as:\n$$\\frac{1}{\\rho} = \\frac{Z R_s T}{p}$$\nSubstituting this into the differential equation for pressure gives:\n$$dp = -\\frac{f \\dot{m}^2}{2DA^2} \\frac{Z R_s T}{p} dx$$\nThis is a separable ordinary differential equation. We rearrange it to integrate over the length of the pipeline, from $x=0$ (where $p = p_u$) to $x=L$ (where $p = p_g$):\n$$p \\, dp = -\\frac{f Z R_s T \\dot{m}^2}{2DA^2} dx$$\n$$\\int_{p_u}^{p_g} p \\, dp = -\\frac{f Z R_s T \\dot{m}^2}{2DA^2} \\int_{0}^{L} dx$$\nThe parameters $f$, $Z$, $R_s$, $T$, $\\dot{m}$, $D$, and $A$ are assumed constant along the pipeline. Integrating both sides yields:\n$$\\frac{p_g^2}{2} - \\frac{p_u^2}{2} = -\\frac{f L Z R_s T \\dot{m}^2}{2DA^2}$$\nMultiplying by $-2$ gives the pressure-flow coupling relation for the pipeline:\n$$p_u^2 - p_g^2 = \\frac{f L Z R_s T \\dot{m}^2}{DA^2}$$\nSubstituting $A = \\frac{\\pi D^2}{4}$, so $A^2 = \\frac{\\pi^2 D^4}{16}$:\n$$p_u^2 - p_g^2 = \\frac{f L Z R_s T \\dot{m}^2}{D (\\frac{\\pi^2 D^4}{16})} = \\frac{16 f L Z R_s T}{\\pi^2 D^5} \\dot{m}^2$$\nThis is the required steady-state pipeline coupling constraint.\n\nNext, we relate the mass flow rate $\\dot{m}$ to the electrical power output $P_e$. The thermal power input from the fuel is $P_{th} = \\dot{m} \\cdot \\mathrm{LHV}$. The generator converts this to electricity with efficiency $\\eta$:\n$$P_e = \\eta P_{th} = \\eta \\dot{m} \\mathrm{LHV}$$\nFrom this, we can express the mass flow rate required for a given power output:\n$$\\dot{m} = \\frac{P_e}{\\eta \\mathrm{LHV}}$$\nSubstituting this expression for $\\dot{m}$ into the pipeline equation:\n$$p_u^2 - p_g^2 = \\frac{16 f L Z R_s T}{\\pi^2 D^5} \\left(\\frac{P_e}{\\eta \\mathrm{LHV}}\\right)^2$$\nWe are asked to find the maximum feasible electric power output, $P_e^{\\max}$. Solving for $P_e$:\n$$P_e = (\\eta \\mathrm{LHV}) \\sqrt{\\frac{\\pi^2 D^5}{16 f L Z R_s T} (p_u^2 - p_g^2)}$$\nTo maximize $P_e$, we must maximize the term under the square root, specifically the pressure difference term $(p_u^2 - p_g^2)$, subject to the constraints $p_u \\leq p_u^{\\max}$ and $p_g \\geq p_g^{\\min}$.\n\nThe function $F(p_u, p_g) = p_u^2 - p_g^2$ is monotonically increasing with $p_u$ (since $\\frac{\\partial F}{\\partial p_u} = 2p_u > 0$) and monotonically decreasing with $p_g$ (since $\\frac{\\partial F}{\\partial p_g} = -2p_g < 0$). Therefore, to maximize $F$, we must choose the highest possible value for $p_u$ and the lowest possible value for $p_g$. These are given by the bounds:\n$$p_u = p_u^{\\max}$$\n$$p_g = p_g^{\\min}$$\nThus, at maximum power output, both the upstream pressure limit and the downstream pressure limit are binding constraints.\n\nNow we calculate the numerical value for $P_e^{\\max}$. Let's define a constant for the pipeline characteristics:\n$$C_p = \\frac{16 f L Z R_s T}{\\pi^2 D^5}$$\nUsing the given values:\n- $f = 0.02$\n- $L = 60000\\,\\mathrm{m}$\n- $Z = 0.90$\n- $R_{s} = 518\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n- $T = 288\\,\\mathrm{K}$\n- $D = 0.30\\,\\mathrm{m}$\n$$C_p = \\frac{16(0.02)(60000)(0.90)(518)(288)}{\\pi^2 (0.30)^5} = \\frac{2,577,692,160}{9.8696 \\times 0.00243} \\approx \\frac{2.5777 \\times 10^9}{0.023983} \\approx 1.0748 \\times 10^{11}\\,\\mathrm{m}^{-2}\\mathrm{s}^{-2}$$\nThe maximum squared pressure difference is:\n$$(p_{u}^{\\max})^2 - (p_{g}^{\\min})^2 = (5.5 \\times 10^6)^2 - (4.8 \\times 10^6)^2 = (30.25 - 23.04) \\times 10^{12} = 7.21 \\times 10^{12}\\,\\mathrm{Pa}^2$$\nThe maximum squared mass flow is:\n$$\\dot{m}_{\\max}^2 = \\frac{(p_{u}^{\\max})^2 - (p_{g}^{\\min})^2}{C_p} = \\frac{7.21 \\times 10^{12}\\,\\mathrm{Pa}^2}{1.0748 \\times 10^{11}\\,\\mathrm{m}^{-2}\\mathrm{s}^{-2}} \\approx 67.085\\,\\mathrm{kg}^2\\mathrm{s}^{-2}$$\nThe maximum mass flow rate is:\n$$\\dot{m}_{\\max} = \\sqrt{67.085\\,\\mathrm{kg}^2\\mathrm{s}^{-2}} \\approx 8.1905\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$$\nFinally, the maximum electric power output is:\n$$P_e^{\\max} = \\eta \\dot{m}_{\\max} \\mathrm{LHV} = (0.58) (8.1905\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}) (49 \\times 10^6\\,\\mathrm{J}\\,\\mathrm{kg}^{-1})$$\n$$P_e^{\\max} \\approx 232,716,000\\,\\mathrm{W} = 232.716\\,\\mathrm{MW}$$\nRounding to three significant figures, the maximum power output is $233\\,\\mathrm{MW}$.",
            "answer": "$$\\boxed{233}$$"
        },
        {
            "introduction": "Real-world energy system operation involves not just meeting constraints at a single moment, but optimizing performance over time while respecting the dynamic limitations of both the electric grid and the gas network. This comprehensive exercise integrates electricity demand, generator ramp rates, and gas deliverability into a single day-ahead scheduling problem formulated as a linear program . By developing and solving this co-optimization model, you will gain hands-on experience in balancing economic efficiency with the coupled physical constraints that define modern energy system reliability.",
            "id": "4092793",
            "problem": "You must design and implement a complete, runnable program that computes a day-ahead schedule over twenty-four ($24$) hours for two gas-fired generation units subject to electric ramp-rate limits and gas network constraints. The program must minimize total fuel cost while satisfying electricity demand coverage and gas–electric coupling constraints, and it must verify that the downstream gas pressure remains above a specified minimum. The problem is framed in purely mathematical terms.\n\nFundamental base and core definitions:\n- Electricity balance: For each hour $t \\in \\{1,2,\\dots,24\\}$, let $P_{1,t}$ and $P_{2,t}$ denote the electrical outputs (in megawatts (MW)) of unit $1$ and unit $2$, respectively. Given an exogenous hourly demand $D_t$ (in MW), the net balance constraint is $P_{1,t} + P_{2,t} \\ge D_t$.\n- Gas–electric coupling: Let the fuel consumption of unit $i \\in \\{1,2\\}$ at hour $t$ be $g_{i,t}$ (in million British thermal units per hour (MMBtu/h)). Under a constant heat rate model, $g_{i,t} = \\alpha_i P_{i,t}$, where $\\alpha_i$ (in MMBtu/MWh) is the heat rate of unit $i$.\n- Aggregated gas flow: The total gas flow demanded by the two units in hour $t$ is $f_t = g_{1,t} + g_{2,t} = \\alpha_1 P_{1,t} + \\alpha_2 P_{2,t}$.\n- Electric ramp limits: Let $R_i$ (in MW per hour) be the ramp-rate limit for unit $i$. Given the initial output $P_{i,0}$ at hour $0$, for each hour $t \\in \\{1,2,\\dots,24\\}$, the ramp-rate constraints are $|P_{i,t} - P_{i,t-1}| \\le R_i$.\n- Unit capacity bounds: For each hour $t$, $0 \\le P_{i,t} \\le \\overline{P}_i$, where $\\overline{P}_i$ (in MW) is the maximum output of unit $i$.\n- Gas capacity constraints: The total gas flow is limited by a source capacity $\\overline{F}_{\\text{src}}$ (in MMBtu/h) and a pipeline capacity $\\overline{F}_{\\text{pipe}}$ (in MMBtu/h), so $f_t \\le \\overline{F}_{\\text{src}}$ and $f_t \\le \\overline{F}_{\\text{pipe}}$.\n- Pressure feasibility: Let $p_s$ (in bar) be the source pressure and $p_{\\min}$ (in bar) be the minimum allowable downstream pressure at the generator delivery node. Under steady-state compressible flow in pipelines, the squared-pressure drop obeys the well-tested Weymouth-like relation $f_t = C \\sqrt{p_s^2 - p_d(t)^2}$, where $C$ is a positive constant capturing pipe and gas properties, and $p_d(t)$ (in bar) is the downstream pressure. For small pressure drops relative to $p_s$, a first-order linearization around a nominal operating point yields an affine approximation $p_d(t) \\approx p_s - k f_t$, for an empirically calibrated constant $k > 0$ (in bar per MMBtu/h). Enforcing $p_d(t) \\ge p_{\\min}$ yields $f_t \\le (p_s - p_{\\min})/k$. Combining the capacities, the enforceable per-hour gas flow cap is $f_t \\le \\overline{F} \\equiv \\min\\{\\overline{F}_{\\text{src}}, \\overline{F}_{\\text{pipe}}, (p_s - p_{\\min})/k\\}$.\n- Cost: Let $c_{\\text{gas}}$ (in dollars per MMBtu) denote the gas price. The per-hour fuel cost for unit $i$ is $c_i P_{i,t}$ with $c_i = c_{\\text{gas}} \\alpha_i$ (in dollars per MWh). The total cost over the horizon is $\\sum_{t=1}^{24} \\left( c_1 P_{1,t} + c_2 P_{2,t} \\right)$.\n\nYour task is to set up and solve the following linear optimization problem:\n- Decision variables: $\\{P_{1,t}, P_{2,t}\\}_{t=1}^{24}$.\n- Objective: minimize $\\sum_{t=1}^{24} \\left( c_1 P_{1,t} + c_2 P_{2,t} \\right)$.\n- Subject to, for all $t \\in \\{1,\\dots,24\\}$:\n    1. $P_{1,t} + P_{2,t} \\ge D_t$,\n    2. $\\alpha_1 P_{1,t} + \\alpha_2 P_{2,t} \\le \\overline{F}$,\n    3. $0 \\le P_{1,t} \\le \\overline{P}_1$ and $0 \\le P_{2,t} \\le \\overline{P}_2$,\n    4. $|P_{1,t} - P_{1,t-1}| \\le R_1$ and $|P_{2,t} - P_{2,t-1}| \\le R_2$, with given $P_{1,0}$ and $P_{2,0}$.\nAfter computing the schedule, verify both $P_{1,t} + P_{2,t} \\ge D_t$ and $p_d(t) = p_s - k (\\alpha_1 P_{1,t} + \\alpha_2 P_{2,t}) \\ge p_{\\min}$ for all $t$. If any constraint is violated, the schedule is infeasible.\n\nPhysical units and output specification:\n- Express electrical outputs in megawatts (MW), gas flows in million British thermal units per hour (MMBtu/h), pressure in bar, and total cost in dollars, rounded to two decimals.\n- Angle units are not applicable.\n- Percentages are not applicable in this problem.\n\nTest suite and coverage:\nProvide a test suite of parameter sets to exercise different facets of feasibility and optimality:\n- Case A (happy path): moderate demand with feasible ramping and gas/pressure limits.\n    - $D_t$ for $t = 1,\\dots,24$: $[100, 110, 120, 130, 140, 150, 150, 140, 130, 120, 110, 100, 90, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140]$.\n    - $\\overline{P}_1 = 160$, $\\overline{P}_2 = 140$.\n    - $\\alpha_1 = 7.5$, $\\alpha_2 = 8.0$.\n    - $c_{\\text{gas}} = 6.0$ so $c_1 = 45.0$, $c_2 = 48.0$.\n    - $R_1 = 60$, $R_2 = 60$.\n    - $P_{1,0} = 50$, $P_{2,0} = 40$.\n    - $p_s = 50$, $p_{\\min} = 40$, $k = 0.008$ so $(p_s - p_{\\min})/k = 1250$.\n    - $\\overline{F}_{\\text{src}} = 1200$, $\\overline{F}_{\\text{pipe}} = 1200$.\n- Case B (boundary near pressure limit): lower demand with a tight pressure minimum dominating gas capacity.\n    - $D_t$: $[70, 75, 80, 80, 80, 80, 80, 78, 76, 74, 72, 70, 68, 68, 70, 72, 74, 76, 78, 80, 80, 80, 75, 70]$.\n    - $\\overline{P}_1 = 160$, $\\overline{P}_2 = 140$.\n    - $\\alpha_1 = 7.5$, $\\alpha_2 = 8.0$.\n    - $c_{\\text{gas}} = 6.0$ so $c_1 = 45.0$, $c_2 = 48.0$.\n    - $R_1 = 60$, $R_2 = 60$.\n    - $P_{1,0} = 50$, $P_{2,0} = 40$.\n    - $p_s = 50$, $p_{\\min} = 45$, $k = 0.008$ so $(p_s - p_{\\min})/k = 625$.\n    - $\\overline{F}_{\\text{src}} = 1200$, $\\overline{F}_{\\text{pipe}} = 1200$.\n- Case C (ramp infeasibility): high demand with insufficient ramp from zero initial output.\n    - $D_t$: $[180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180]$.\n    - $\\overline{P}_1 = 120$, $\\overline{P}_2 = 120$.\n    - $\\alpha_1 = 7.5$, $\\alpha_2 = 8.0$.\n    - $c_{\\text{gas}} = 6.0$ so $c_1 = 45.0$, $c_2 = 48.0$.\n    - $R_1 = 40$, $R_2 = 40$.\n    - $P_{1,0} = 0$, $P_{2,0} = 0$.\n    - $p_s = 55$, $p_{\\min} = 40$, $k = 0.006$ so $(p_s - p_{\\min})/k = 2500$.\n    - $\\overline{F}_{\\text{src}} = 2500$, $\\overline{F}_{\\text{pipe}} = 2500$.\n- Case D (gas capacity infeasibility): moderate demand exceeding available gas delivery even though electric capacities and ramps are generous.\n    - $D_t$: $[140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140, 140]$.\n    - $\\overline{P}_1 = 120$, $\\overline{P}_2 = 120$.\n    - $\\alpha_1 = 7.5$, $\\alpha_2 = 8.0$.\n    - $c_{\\text{gas}} = 6.0$ so $c_1 = 45.0$, $c_2 = 48.0$.\n    - $R_1 = 100$, $R_2 = 100$.\n    - $P_{1,0} = 120$, $P_{2,0} = 0$.\n    - $p_s = 50$, $p_{\\min} = 40$, $k = 0.008$ so $(p_s - p_{\\min})/k = 1250$.\n    - $\\overline{F}_{\\text{src}} = 900$, $\\overline{F}_{\\text{pipe}} = 2000$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element must be a two-element list $[\\text{feasible}, \\text{total\\_cost}]$, where $\\text{feasible}$ is a boolean indicating whether a feasible schedule exists for the case (true if and only if all constraints are satisfied across all hours), and $\\text{total\\_cost}$ is the minimized total cost in dollars (rounded to two decimals; return $0.0$ if infeasible). For example, the output should look like $[[\\text{True}, 1234.56],[\\text{False}, 0.0],\\dots]$.",
            "solution": "We construct the schedule by solving a linear optimization problem derived from first principles that couple electricity production and gas delivery within physical constraints.\n\nPrinciples and derivation:\n1. Electricity balance and unit outputs: For each hour $t \\in \\{1,\\dots,24\\}$, the outputs $P_{1,t}$ and $P_{2,t}$ are continuous decision variables bounded by $0 \\le P_{i,t} \\le \\overline{P}_i$. The net demand constraint $P_{1,t} + P_{2,t} \\ge D_t$ enforces adequacy. This is a direct application of conservation of energy at the power system level: aggregated generation must at least cover demand.\n\n2. Gas–electric coupling: Under the well-tested constant heat rate model for gas turbines, fuel consumption is proportional to electrical output: $g_{i,t} = \\alpha_i P_{i,t}$. Summing over units yields total gas flow $f_t = \\alpha_1 P_{1,t} + \\alpha_2 P_{2,t}$.\n\n3. Gas network limits: Physical deliverability is bounded by the source capacity $\\overline{F}_{\\text{src}}$ and the pipeline capacity $\\overline{F}_{\\text{pipe}}$, so $f_t \\le \\overline{F}_{\\text{src}}$ and $f_t \\le \\overline{F}_{\\text{pipe}}$. Pressure feasibility is derived from the steady-state momentum balance in pipelines, typically expressed by the Weymouth-type relation $f_t = C \\sqrt{p_s^2 - p_d(t)^2}$, which is a well-tested formula in gas engineering. For small drops, we linearize $p_d(t)$ around a nominal operation point: letting $\\Delta p_t = p_s - p_d(t)$, the Weymouth relation behaves as $f_t \\approx C \\sqrt{2 p_s \\Delta p_t}$ when $\\Delta p_t \\ll p_s$, which is concave and monotone. To embed pressure in a linear program, we adopt an affine approximation $p_d(t) \\approx p_s - k f_t$, where $k$ is obtained by local linearization (e.g., from the derivative $d\\Delta p_t / df_t = f_t / (C^2 p_s)$ evaluated at a nominal $f_t$ and encapsulated as a constant for scheduling). Enforcing $p_d(t) \\ge p_{\\min}$ yields $f_t \\le (p_s - p_{\\min})/k$. Therefore the enforceable per-hour cap is $f_t \\le \\overline{F} \\equiv \\min\\{\\overline{F}_{\\text{src}}, \\overline{F}_{\\text{pipe}}, (p_s - p_{\\min})/k\\}$.\n\n4. Ramping constraints: Machine dynamics impose $|P_{i,t} - P_{i,t-1}| \\le R_i$ for $t \\in \\{1,\\dots,24\\}$, given $P_{i,0}$. These are two linear inequalities per time step: $P_{i,t} - P_{i,t-1} \\le R_i$ and $-(P_{i,t} - P_{i,t-1}) \\le R_i$. For $t=1$, $P_{i,0}$ is treated as a constant.\n\n5. Objective: With gas price $c_{\\text{gas}}$ and heat rates $\\alpha_i$, the per-MWh fuel costs are $c_i = c_{\\text{gas}} \\alpha_i$. The total cost is $\\sum_{t=1}^{24} \\left( c_1 P_{1,t} + c_2 P_{2,t} \\right)$, which is linear in the decision variables. Since all $c_i$ are positive, the optimizer will not produce generation in excess of the minimum required by constraints (no incentive for curtailment or overproduction).\n\nAlgorithmic design:\n- Formulate a linear program (Linear Programming (LP)) with $48$ decision variables $x = [P_{1,1},\\dots,P_{1,24}, P_{2,1},\\dots,P_{2,24}]$.\n- Objective vector $c$ contains $c_1$ repeated $24$ times followed by $c_2$ repeated $24$ times. Minimize $c^\\top x$.\n- Inequality constraints:\n  - Demand adequacy for each hour $t$: $-(P_{1,t} + P_{2,t}) \\le -D_t$, i.e., $A_{\\text{dem}} x \\le b_{\\text{dem}}$ with coefficients $-1$ at the two positions for hour $t$.\n  - Gas cap for each hour $t$: $\\alpha_1 P_{1,t} + \\alpha_2 P_{2,t} \\le \\overline{F}$.\n  - Ramp up and down for units $1$ and $2$, including hour $t=1$ using $P_{i,0}$, all as linear inequalities.\n- Bounds: $0 \\le P_{i,t} \\le \\overline{P}_i$ for all $t$.\n- Solve using a robust LP solver. If the solver returns infeasible or unbounded status, mark the case infeasible.\n- If feasible, extract the schedule and verify ex post:\n  - Electricity: $P_{1,t} + P_{2,t} \\ge D_t$ for all $t$ (allowing a small numerical tolerance).\n  - Pressure: compute $p_d(t) = p_s - k(\\alpha_1 P_{1,t} + \\alpha_2 P_{2,t})$ and check $p_d(t) \\ge p_{\\min}$ for all $t$.\n- Compute total cost $\\sum_{t=1}^{24} \\left( c_1 P_{1,t} + c_2 P_{2,t} \\right)$ and round to two decimals for reporting.\n\nTest cases rationale:\n- Case A checks a typical feasible scheduling scenario with moderate demand and nonbinding gas caps.\n- Case B exercises the pressure linearization by constraining the maximum permissible flow via $p_{\\min}$, operating near the boundary yet feasible.\n- Case C demonstrates infeasibility caused by ramp-rate limits: starting from zero, demand is too high to reach in the first hour under $R_1$ and $R_2$.\n- Case D shows infeasibility due to insufficient gas deliverability even though electric capacities and ramp limits are generous.\n\nProgram output:\n- For each case, produce a two-element list $[\\text{feasible}, \\text{total\\_cost}]$, where $\\text{feasible}$ is a boolean and $\\text{total\\_cost}$ is the minimized cost in dollars (rounded to two decimals, or $0.0$ if infeasible).\n- Aggregate all case results into a single Python-style list printed on one line in the format $[[\\text{True}, 1234.56],[\\text{False}, 0.0],\\dots]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef build_lp_case(D, Pmax1, Pmax2, alpha1, alpha2, c_gas, R1, R2, P1_init, P2_init,\n                  p_source, p_min, k_lin, F_source, F_pipe):\n    \"\"\"\n    Build the LP (objective, bounds, and constraints) for a single case.\n    Returns (c, A_ub, b_ub, bounds, nT, F_cap).\n    \"\"\"\n    D = np.array(D, dtype=float)\n    nT = len(D)\n\n    # Cost coefficients per MW\n    c1 = c_gas * alpha1\n    c2 = c_gas * alpha2\n\n    # Decision variable order: [P1_1 ... P1_T, P2_1 ... P2_T]\n    c = np.concatenate([np.full(nT, c1), np.full(nT, c2)])\n\n    # Bounds for variables\n    bounds = [(0.0, Pmax1)] * nT + [(0.0, Pmax2)] * nT\n\n    # Gas cap from pressure linearization\n    F_press = (p_source - p_min) / k_lin\n    F_cap = min(F_source, F_pipe, F_press)\n\n    # Inequality constraints A_ub x <= b_ub\n    A_ub = []\n    b_ub = []\n\n    # Demand constraints: -(P1_t + P2_t) <= -D_t\n    for t in range(nT):\n        row = np.zeros(2 * nT)\n        row[t] = -1.0  # P1_t\n        row[nT + t] = -1.0  # P2_t\n        A_ub.append(row)\n        b_ub.append(-D[t])\n\n    # Gas cap constraints: alpha1*P1_t + alpha2*P2_t <= F_cap\n    for t in range(nT):\n        row = np.zeros(2 * nT)\n        row[t] = alpha1\n        row[nT + t] = alpha2\n        A_ub.append(row)\n        b_ub.append(F_cap)\n\n    # Ramp constraints for unit 1:\n    # For t=1: P1_1 - P1_init <= R1 and -(P1_1 - P1_init) <= R1\n    row_up = np.zeros(2 * nT)\n    row_up[0] = 1.0\n    A_ub.append(row_up)\n    b_ub.append(R1 + P1_init)  # P1_1 <= R1 + P1_init\n\n    row_down = np.zeros(2 * nT)\n    row_down[0] = -1.0\n    A_ub.append(row_down)\n    b_ub.append(R1 - P1_init)  # -P1_1 <= R1 - P1_init\n\n    # For t=2..T: P1_t - P1_{t-1} <= R1 and -(P1_t - P1_{t-1}) <= R1\n    for t in range(1, nT):\n        row_up = np.zeros(2 * nT)\n        row_up[t] = 1.0\n        row_up[t - 1] = -1.0\n        A_ub.append(row_up)\n        b_ub.append(R1)\n\n        row_down = np.zeros(2 * nT)\n        row_down[t] = -1.0\n        row_down[t - 1] = 1.0\n        A_ub.append(row_down)\n        b_ub.append(R1)\n\n    # Ramp constraints for unit 2:\n    # For t=1: P2_1 - P2_init <= R2 and -(P2_1 - P2_init) <= R2\n    row_up = np.zeros(2 * nT)\n    row_up[nT + 0] = 1.0\n    A_ub.append(row_up)\n    b_ub.append(R2 + P2_init)  # P2_1 <= R2 + P2_init\n\n    row_down = np.zeros(2 * nT)\n    row_down[nT + 0] = -1.0\n    A_ub.append(row_down)\n    b_ub.append(R2 - P2_init)  # -P2_1 <= R2 - P2_init\n\n    # For t=2..T: P2_t - P2_{t-1} <= R2 and -(P2_t - P2_{t-1}) <= R2\n    for t in range(1, nT):\n        row_up = np.zeros(2 * nT)\n        row_up[nT + t] = 1.0\n        row_up[nT + t - 1] = -1.0\n        A_ub.append(row_up)\n        b_ub.append(R2)\n\n        row_down = np.zeros(2 * nT)\n        row_down[nT + t] = -1.0\n        row_down[nT + t - 1] = 1.0\n        A_ub.append(row_down)\n        b_ub.append(R2)\n\n    A_ub = np.vstack(A_ub)\n    b_ub = np.array(b_ub, dtype=float)\n\n    return c, A_ub, b_ub, bounds, nT, F_cap\n\ndef solve_case(params, tol=1e-6):\n    \"\"\"\n    Solve one case. Returns (feasible: bool, total_cost: float).\n    \"\"\"\n    D = params[\"D\"]\n    Pmax1 = params[\"Pmax1\"]\n    Pmax2 = params[\"Pmax2\"]\n    alpha1 = params[\"alpha1\"]\n    alpha2 = params[\"alpha2\"]\n    c_gas = params[\"c_gas\"]\n    R1 = params[\"R1\"]\n    R2 = params[\"R2\"]\n    P1_init = params[\"P1_init\"]\n    P2_init = params[\"P2_init\"]\n    p_source = params[\"p_source\"]\n    p_min = params[\"p_min\"]\n    k_lin = params[\"k_lin\"]\n    F_source = params[\"F_source\"]\n    F_pipe = params[\"F_pipe\"]\n\n    c, A_ub, b_ub, bounds, nT, F_cap = build_lp_case(\n        D, Pmax1, Pmax2, alpha1, alpha2, c_gas, R1, R2, P1_init, P2_init,\n        p_source, p_min, k_lin, F_source, F_pipe\n    )\n\n    res = linprog(c=c, A_ub=A_ub, b_ub=b_ub, bounds=bounds, method=\"highs\")\n\n    if not res.success:\n        return False, 0.0\n\n    x = res.x\n    P1 = x[:nT]\n    P2 = x[nT:]\n\n    # Verify constraints with tolerance\n    feasible = True\n\n    # Demand\n    if np.any(P1 + P2 < np.array(D) - tol):\n        feasible = False\n\n    # Ramps\n    if abs(P1[0] - P1_init) > R1 + tol or abs(P2[0] - P2_init) > R2 + tol:\n        feasible = False\n    if np.any(np.abs(np.diff(P1)) > R1 + tol) or np.any(np.abs(np.diff(P2)) > R2 + tol):\n        feasible = False\n\n    # Bounds\n    if np.any(P1 < -tol) or np.any(P2 < -tol):\n        feasible = False\n    if np.any(P1 > Pmax1 + tol) or np.any(P2 > Pmax2 + tol):\n        feasible = False\n\n    # Gas cap\n    f = alpha1 * P1 + alpha2 * P2\n    if np.any(f > F_cap + tol):\n        feasible = False\n\n    # Pressure verification\n    p_d = p_source - k_lin * f\n    if np.any(p_d < p_min - tol):\n        feasible = False\n\n    # Total cost\n    c1 = c_gas * alpha1\n    c2 = c_gas * alpha2\n    total_cost = float(np.sum(c1 * P1 + c2 * P2))\n    total_cost = round(total_cost, 2) if feasible else 0.0\n\n    return feasible, total_cost\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"D\": [100, 110, 120, 130, 140, 150, 150, 140, 130, 120, 110, 100, 90, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140],\n            \"Pmax1\": 160.0,\n            \"Pmax2\": 140.0,\n            \"alpha1\": 7.5,\n            \"alpha2\": 8.0,\n            \"c_gas\": 6.0,\n            \"R1\": 60.0,\n            \"R2\": 60.0,\n            \"P1_init\": 50.0,\n            \"P2_init\": 40.0,\n            \"p_source\": 50.0,\n            \"p_min\": 40.0,\n            \"k_lin\": 0.008,\n            \"F_source\": 1200.0,\n            \"F_pipe\": 1200.0\n        },\n        {\n            \"name\": \"Case B\",\n            \"D\": [70, 75, 80, 80, 80, 80, 80, 78, 76, 74, 72, 70, 68, 68, 70, 72, 74, 76, 78, 80, 80, 80, 75, 70],\n            \"Pmax1\": 160.0,\n            \"Pmax2\": 140.0,\n            \"alpha1\": 7.5,\n            \"alpha2\": 8.0,\n            \"c_gas\": 6.0,\n            \"R1\": 60.0,\n            \"R2\": 60.0,\n            \"P1_init\": 50.0,\n            \"P2_init\": 40.0,\n            \"p_source\": 50.0,\n            \"p_min\": 45.0,\n            \"k_lin\": 0.008,\n            \"F_source\": 1200.0,\n            \"F_pipe\": 1200.0\n        },\n        {\n            \"name\": \"Case C\",\n            \"D\": [180] * 24,\n            \"Pmax1\": 120.0,\n            \"Pmax2\": 120.0,\n            \"alpha1\": 7.5,\n            \"alpha2\": 8.0,\n            \"c_gas\": 6.0,\n            \"R1\": 40.0,\n            \"R2\": 40.0,\n            \"P1_init\": 0.0,\n            \"P2_init\": 0.0,\n            \"p_source\": 55.0,\n            \"p_min\": 40.0,\n            \"k_lin\": 0.006,\n            \"F_source\": 2500.0,\n            \"F_pipe\": 2500.0\n        },\n        {\n            \"name\": \"Case D\",\n            \"D\": [140] * 24,\n            \"Pmax1\": 120.0,\n            \"Pmax2\": 120.0,\n            \"alpha1\": 7.5,\n            \"alpha2\": 8.0,\n            \"c_gas\": 6.0,\n            \"R1\": 100.0,\n            \"R2\": 100.0,\n            \"P1_init\": 120.0,\n            \"P2_init\": 0.0,\n            \"p_source\": 50.0,\n            \"p_min\": 40.0,\n            \"k_lin\": 0.008,\n            \"F_source\": 900.0,\n            \"F_pipe\": 2000.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        feasible, total_cost = solve_case(case)\n        results.append([bool(feasible), float(total_cost)])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}