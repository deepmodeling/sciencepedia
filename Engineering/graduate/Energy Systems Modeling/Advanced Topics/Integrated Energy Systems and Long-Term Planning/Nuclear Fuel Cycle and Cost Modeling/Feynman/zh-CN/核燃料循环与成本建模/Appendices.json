{
    "hands_on_practices": [
        {
            "introduction": "对核燃料循环的任何稳健分析都必须始于对实体物料流的坚实理解。本实践着重于后处理设施内质量守恒的基本原则。通过应用分离效率的概念，您将学习如何量化从乏核燃料中回收的有价材料（如铀和钚）以及由此产生的废物料流。这项技能至关重要，因为这些质量流是后续经济和废物管理模型的主要输入数据。",
            "id": "4109081",
            "problem": "一个后处理设施处理一批总质量为 $M_{\\mathrm{in}} = 1.0 \\times 10^{5}\\ \\mathrm{kg}$ 的乏核燃料。该乏燃料的质量组分如下：钚的质量分数为 $\\alpha_{\\mathrm{Pu}} = 0.01$，铀的质量分数为 $\\alpha_{\\mathrm{U}} = 0.94$，其余部分 $\\alpha_{\\mathrmR} = 0.05$ 代表未计划回收的裂变产物和次锕系元素。乏燃料中的铀含有铀-235的剩余铀浓缩度为 $y_{235} = 0.002$（即，在铀中，铀-235的质量分数为 $0.002$）。该工厂将铀和钚回收至不同的产品流中，分离效率分别为 $\\eta_{\\mathrm{U}} = 0.99$ 和 $\\eta_{\\mathrm{Pu}} = 0.98$，其中分离效率定义为原料中某元素的质量被收集到相应产品流中的比例。下游的混合氧化物（MOX）燃料制造过程直接使用回收的铀和钚，无需进一步的同位素调整，且分离过程中的同位素分馏可以忽略不计。\n\n从质量守恒和分离效率的定义出发，构建回收的铀和钚产品流的通用质量流方程，用 $M_{\\mathrm{in}}$、$\\alpha_{\\mathrm{U}}$、$\\alpha_{\\mathrm{Pu}}$、$\\eta_{\\mathrm{U}}$ 和 $\\eta_{\\mathrm{Pu}}$ 表示。同时，推导回收的铀流中所含铀-235质量的表达式，用 $y_{235}$ 和回收的铀质量表示。然后，对给定的批次，数值计算这些表达式。\n\n将你的数值结果四舍五入到四位有效数字。所有质量均以千克表示。以行矩阵的形式提供你的最终答案，顺序为 $[m_{\\mathrm{U,rec}},\\ m_{\\mathrm{Pu,rec}},\\ m_{235,\\mathrm{rec}}]$，其中 $m_{\\mathrm{U,rec}}$ 和 $m_{\\mathrm{Pu,rec}}$ 分别是回收的铀和钚的质量，$m_{235,\\mathrm{rec}}$ 是回收的铀流中铀-235的质量。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于质量守恒原理和标准的核燃料循环模型，问题提出得当，数据充分且一致，语言客观。我们可以开始求解。\n\n该问题要求推导回收铀和钚的通用质量流方程，以及回收铀流中铀-235质量的方程。然后将对这些表达式进行数值计算。\n\n已知条件如下：\n乏燃料总初始质量：$M_{\\mathrm{in}} = 1.0 \\times 10^{5}\\ \\mathrm{kg}$\n原料中铀的质量分数：$\\alpha_{\\mathrm{U}} = 0.94$\n原料中钚的质量分数：$\\alpha_{\\mathrm{Pu}} = 0.01$\n铀中铀-235的质量分数：$y_{235} = 0.002$\n铀的分离效率：$\\eta_{\\mathrm{U}} = 0.99$\n钚的分离效率：$\\eta_{\\mathrm{Pu}} = 0.98$\n\n首先，我们确定后处理前乏燃料批次中铀和钚的初始质量。\n原料中铀的质量 $m_{\\mathrm{U,in}}$ 是总质量 $M_{\\mathrm{in}}$ 与铀质量分数 $\\alpha_{\\mathrm{U}}$ 的乘积：\n$$m_{\\mathrm{U,in}} = \\alpha_{\\mathrm{U}} M_{\\mathrm{in}}$$\n原料中钚的质量 $m_{\\mathrm{Pu,in}}$ 是总质量 $M_{\\mathrm{in}}$ 与钚质量分数 $\\alpha_{\\mathrm{Pu}}$ 的乘积：\n$$m_{\\mathrm{Pu,in}} = \\alpha_{\\mathrm{Pu}} M_{\\mathrm{in}}$$\n\n接下来，我们根据分离效率的定义推导回收质量的通用表达式。分离效率 $\\eta$ 定义为原料中某元素的质量被收集到产品流中的比例。\n\n对于铀，回收铀的质量 $m_{\\mathrm{U,rec}}$ 由铀分离效率 $\\eta_{\\mathrm{U}}$ 与原料中初始铀质量 $m_{\\mathrm{U,in}}$ 的乘积给出。\n$$m_{\\mathrm{U,rec}} = \\eta_{\\mathrm{U}} m_{\\mathrm{U,in}}$$\n代入 $m_{\\mathrm{U,in}}$ 的表达式，我们得到回收铀的通用质量流方程：\n$$m_{\\mathrm{U,rec}} = \\eta_{\\mathrm{U}} \\alpha_{\\mathrm{U}} M_{\\mathrm{in}}$$\n\n类似地，对于钚，回收钚的质量 $m_{\\mathrm{Pu,rec}}$ 是钚分离效率 $\\eta_{\\mathrm{Pu}}$ 与原料中初始钚质量 $m_{\\mathrm{Pu,in}}$ 的乘积。\n$$m_{\\mathrm{Pu,rec}} = \\eta_{\\mathrm{Pu}} m_{\\mathrm{Pu,in}}$$\n代入 $m_{\\mathrm{Pu,in}}$ 的表达式，我们得到回收钚的通用质量流方程：\n$$m_{\\mathrm{Pu,rec}} = \\eta_{\\mathrm{Pu}} \\alpha_{\\mathrm{Pu}} M_{\\mathrm{in}}$$\n\n最后，我们推导回收铀流中铀-235质量的表达式，记为 $m_{235,\\mathrm{rec}}$。问题陈述中提到，分离过程中的同位素分馏可以忽略。这意味着铀的同位素组成在分离过程中保持不变。因此，回收铀中铀-235的质量分数与原料铀中的相同，即 $y_{235}$。回收流中铀-235的质量是回收铀总质量 $m_{\\mathrm{U,rec}}$ 与此质量分数 $y_{235}$ 的乘积。\n$$m_{235,\\mathrm{rec}} = y_{235} m_{\\mathrm{U,rec}}$$\n这是用回收铀质量表示的铀-235质量的通用表达式。我们也可以通过代入 $m_{\\mathrm{U,rec}}$ 的表达式，用初始原料参数来表示它：\n$$m_{235,\\mathrm{rec}} = y_{235} (\\eta_{\\mathrm{U}} \\alpha_{\\mathrm{U}} M_{\\mathrm{in}})$$\n\n现在我们使用给定的数值对这些表达式进行数值计算。\n\n回收铀的质量 $m_{\\mathrm{U,rec}}$ 为：\n$$m_{\\mathrm{U,rec}} = (0.99) \\times (0.94) \\times (1.0 \\times 10^{5}\\ \\mathrm{kg}) = 0.9306 \\times 10^{5}\\ \\mathrm{kg} = 93060\\ \\mathrm{kg}$$\n四舍五入到四位有效数字，结果是 $9.306 \\times 10^{4}\\ \\mathrm{kg}$。\n\n回收钚的质量 $m_{\\mathrm{Pu,rec}}$ 为：\n$$m_{\\mathrm{Pu,rec}} = (0.98) \\times (0.01) \\times (1.0 \\times 10^{5}\\ \\mathrm{kg}) = 0.0098 \\times 10^{5}\\ \\mathrm{kg} = 980\\ \\mathrm{kg}$$\n四舍五入到四位有效数字，结果是 $980.0\\ \\mathrm{kg}$。\n\n回收铀流中铀-235的质量 $m_{235,\\mathrm{rec}}$ 为：\n$$m_{235,\\mathrm{rec}} = y_{235} m_{\\mathrm{U,rec}} = (0.002) \\times (93060\\ \\mathrm{kg}) = 186.12\\ \\mathrm{kg}$$\n四舍五入到四位有效数字，结果是 $186.1\\ \\mathrm{kg}$。\n\n最终的数值结果，以千克表示并四舍五入到四位有效数字，是：$m_{\\mathrm{U,rec}} = 9.306 \\times 10^{4}$，$m_{\\mathrm{Pu,rec}} = 980.0$，以及 $m_{235,\\mathrm{rec}} = 186.1$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 9.306 \\times 10^{4}  980.0  186.1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "核燃料循环的经济学特点是其漫长的时间跨度，这使得现金流的时间节点变得至关重要。本练习引入了净现值（$NPV$）的概念，作为一种工具来恰当地评估和比较长期财务义务。您将把这一原则应用于一个常见场景：管理乏燃料的处置库费用，探索不同的支付方案如何对电力公司产生截然不同的经济影响。这种分析对于为长周期能源项目做出合理的财务决策至关重要。",
            "id": "4109095",
            "problem": "一家核电公司运营着一座压水反应堆，每年以 $10\\ \\mathrm{tHM}$ 的速率排放乏核燃料，其中重金属 (HM) 是指乏燃料中所含的铀和超铀元素的公制质量。监管机构征收的处置库费用按实际价值计算是恒定的，并按每单位排放的重金属评估，费率为每 $\\mathrm{kgHM}$ $\\$1{,}000$。假设排放在每个运营年度的年底进行，且核电站寿命为 $40$ 年。该公司使用实际贴现率 $r=0.04$（年利率，连续复利）来评估成本。\n\n考虑针对相同收费标准的两种付款时间策略：\n- 策略 A（随用随付）：该公司在每年的排放时支付当年的处置库费用，持续 $n=1,2,\\dots,40$ 年。\n- 策略 B（第 $30$ 年一次性总付）：该公司在第 $t=30$ 年进行一次性付款，金额等于所有 $40$ 年排放的未贴现处置库总费用。\n\n从连续复利下净现值 (NPV) 的基本原理定义出发，计算在策略 A 和策略 B 下 $t=0$ 时的现值，并报告定义为 $\\mathrm{PV}_{A}-\\mathrm{PV}_{B}$ 的差值。最终答案以百万美元（million $）表示，并四舍五入至四位有效数字。",
            "solution": "目标是计算在相同的基础处置库收费标准下，两种付款时间策略之间的现值差异。我们从连续复利下货币时间价值的基本原理定义开始。对于在时间 $t$ 发生的一笔现金流 $C(t)$，其在时间 $0$ 的现值由下式给出：\n$$\n\\mathrm{PV}=\\int_{0}^{\\infty} C(t)\\,\\exp(-r t)\\,dt,\n$$\n而对于在时间 $t=n$ 发生的一系列离散的年末现金流 $\\{C_{n}\\}$，其现值为：\n$$\n\\mathrm{PV}=\\sum_{n} C_{n}\\,\\exp(-r n).\n$$\n\n首先，计算策略 A 的年度处置库费用（以美元计）。排放速率为 $10\\ \\mathrm{tHM/yr}$。由于 $1\\ \\mathrm{t}=1{,}000\\ \\mathrm{kg}$，这相当于 $10{,}000\\ \\mathrm{kgHM/yr}$。以 $\\$1{,}000/\\mathrm{kgHM}$ 的费率计算，每年的年末付款额为：\n$$\nF=\\left(10{,}000\\ \\mathrm{kgHM/yr}\\right)\\times\\left(\\$1{,}000/\\mathrm{kgHM}\\right)=\\$10{,}000{,}000=\\$10^{7}.\n$$\n\n在策略 A 下，连续 $40$ 年每年年底支付 $F$ 的现值为：\n$$\n\\mathrm{PV}_{A}=\\sum_{n=1}^{40} F\\,\\exp(-r n)=F\\sum_{n=1}^{40} \\exp(-r n).\n$$\n识别出这是一个等比数列结构，公比为 $q=\\exp(-r)$，\n$$\n\\sum_{n=1}^{40} \\exp(-r n)=\\sum_{n=1}^{40} q^{n}=q\\,\\frac{1-q^{40}}{1-q}=\\exp(-r)\\,\\frac{1-\\exp(-40 r)}{1-\\exp(-r)}.\n$$\n因此，\n$$\n\\mathrm{PV}_{A}=F\\,\\exp(-r)\\,\\frac{1-\\exp(-40 r)}{1-\\exp(-r)}.\n$$\n\n在策略 B 下，第 $t=30$ 年的一次性总付款等于所有 $40$ 年排放的未贴现总费用。未贴现的总付款额为：\n$$\nL=\\sum_{n=1}^{40} F=40F.\n$$\n将这笔一次性付款以连续复利贴现回 $t=0$ 时的现值为：\n$$\n\\mathrm{PV}_{B}=L\\,\\exp(-r\\cdot 30)=40F\\,\\exp(-30 r).\n$$\n\n所求的差值为：\n$$\n\\Delta=\\mathrm{PV}_{A}-\\mathrm{PV}_{B}=F\\left[\\exp(-r)\\,\\frac{1-\\exp(-40 r)}{1-\\exp(-r)}-40\\,\\exp(-30 r)\\right].\n$$\n\n代入 $F=\\$10^{7}$ 和 $r=0.04$：\n- 计算 $\\exp(-r)=\\exp(-0.04)\\approx 0.960789439$。\n- 计算 $\\exp(-40 r)=\\exp(-1.6)\\approx 0.201896518$。\n- 计算 $\\exp(-30 r)=\\exp(-1.2)\\approx 0.301194212$。\n\n那么，\n$$\n\\sum_{n=1}^{40} \\exp(-0.04 n)=\\exp(-0.04)\\,\\frac{1-\\exp(-1.6)}{1-\\exp(-0.04)}\\approx 0.960789439\\,\\frac{1-0.201896518}{1-0.960789439}.\n$$\n计算括号中的项：\n$$\n1-0.201896518=0.798103482,\\quad 1-0.960789439=0.039210561,\n$$\n所以，\n$$\n\\sum_{n=1}^{40} \\exp(-0.04 n)\\approx 0.960789439\\times\\frac{0.798103482}{0.039210561}\\approx 19.556.\n$$\n因此，\n$$\n\\mathrm{PV}_{A}\\approx F\\times 19.556=\\$10^{7}\\times 19.556=\\$195.56\\times 10^{6}.\n$$\n对于策略 B，\n$$\n\\mathrm{PV}_{B}=40F\\,\\exp(-1.2)=\\$40\\times 10^{7}\\times 0.301194212=\\$120.4776848\\times 10^{6}.\n$$\n因此，差值为：\n$$\n\\Delta=\\mathrm{PV}_{A}-\\mathrm{PV}_{B}\\approx \\$195.56\\times 10^{6}-\\$120.4776848\\times 10^{6}=\\$75.0823152\\times 10^{6}.\n$$\n\n以百万美元表示，$\\Delta\\approx 75.0823152\\ \\mathrm{million}\\ \\$$。四舍五入到四位有效数字，得到：\n$$\n\\Delta\\approx 75.08\\ \\text{million}\\ \\$$$",
            "answer": "$$\\boxed{75.08}$$"
        },
        {
            "introduction": "真正的系统建模涉及将物理约束、经济目标和风险管理整合到一个统一的框架中，以指导决策。这项高级实践要求您为低浓铀（$LEU$）建立一个分时段的库存优化模型。通过构建并求解一个线性规划问题，您将学习如何平衡采购成本、持有成本和供应风险，以找到成本效益最高的库存策略。本练习概括了能源系统建模的核心：使用定量方法解决复杂的、现实世界中的后勤与经济问题。",
            "id": "4109130",
            "problem": "考虑核燃料循环中低浓缩铀 (LEU) 的单一商品分时段库存计划问题，其中浓缩产物的接收存在确定性提前期和随机延迟。目标是确定订购量和期末库存，以在满足由浓缩延迟风险驱动的需求和安全库存要求的同时，最小化总成本。该建模的基本基础是随时间变化的质量守恒和线性成本函数的使用。\n\n定义一个包含 $T$ 个离散时期的有限计划期，由 $t \\in \\{0, 1, \\dots, T-1\\}$ 索引。在每个时期 $t$，决策变量是在时期 $t$ 开始时下达的订购量 $q_t \\ge 0$（将在固定的确定性提前期 $L$ 后收到）和期末库存 $I_t \\ge 0$。设外生参数为：需求 $d_t \\ge 0$，采购价格 $p_t \\ge 0$（单位：美元 (USD) 每公斤），持有成本 $h \\ge 0$（单位：美元每公斤-时期），确定性提前期 $L \\in \\mathbb{Z}_{\\ge 0}$（单位：时期），以及初始库存 $I_{\\text{init}} \\ge 0$（单位：公斤）。时期 $t$ 的接收量在 $t \\ge L$ 时等于 $q_{t-L}$，否则为 $0$。分时段质量平衡方程为\n$$\nI_t \\;=\\; I_{t-1} \\;+\\; \\begin{cases} q_{t-L},  \\text{if } t \\ge L, \\\\ 0,  \\text{if } t  L, \\end{cases} \\;-\\; d_t,\n$$\n约定 $I_{-1} = I_{\\text{init}}$。待最小化的成本为\n$$\nC \\;=\\; \\sum_{t=0}^{T-1} \\left( p_t \\, q_t \\;+\\; h \\, I_t \\right).\n$$\n\n为了捕捉浓缩延迟风险，假设浓缩提前期围绕其确定性均值 $L$ 存在随机延迟，其标准差为 $\\sigma_L \\ge 0$（单位：时期），并采用一个目标服务因子 $z \\ge 0$（例如，标准正态分位数）。施加一个安全库存 $S_t \\ge 0$ 使得 $I_t \\ge S_t$，以缓冲延迟。对于此问题，$S_t$ 在整个计划期内为常数，并根据提前期不确定性和平均需求率导出；您必须基于所提供的 $z$、$\\sigma_L$ 和需求序列 $\\{d_t\\}$ 从第一性原理推导出 $S_t$，然后将 $I_t \\ge S_t$ 纳入优化中。\n\n将此优化问题构建为一个关于 $\\{q_t, I_t\\}$ 的线性规划，包含：\n- 对所有 $t \\in \\{0, \\dots, T-1\\}$ 的质量平衡约束。\n- 对所有 $t$ 的非负性约束 $q_t \\ge 0$。\n- 对所有 $t$ 的安全库存约束 $I_t \\ge S_t$，其中 $S_t$ 由提前期不确定性和需求导出。\n\n您的程序必须实现该模型，并计算以下每个测试用例的最小总成本 $C$（以美元计）。所有物理单位必须按规定处理：需求 $d_t$ 单位为公斤，价格 $p_t$ 单位为美元/公斤，持有成本 $h$ 单位为美元/公斤-时期，提前期 $L$ 和 $\\sigma_L$ 单位为时期，以及 $I_{\\text{init}}$ 单位为公斤。将每个计算出的总成本以美元表示，并四舍五入到小数点后两位。\n\n测试套件：\n- 案例 1（基准，无安全库存）：\n  - $T = 6$, $L = 2$, $d = [800, 800, 900, 900, 1000, 1100]$, $p = [1500, 1500, 1500, 1500, 1500, 1500]$, $h = 5$, $I_{\\text{init}} = 2000$, $z = 0.0$, $\\sigma_L = 0.5$。\n- 案例 2（中等安全库存）：\n  - $T = 6$, $L = 2$, $d = [800, 800, 900, 900, 1000, 1100]$, $p = [1500, 1500, 1500, 1500, 1500, 1500]$, $h = 5$, $I_{\\text{init}} = 2600$, $z = 1.0$, $\\sigma_L = 0.5$。\n- 案例 3（价格上涨，更长的提前期和更高的安全库存）：\n  - $T = 6$, $L = 3$, $d = [900, 900, 900, 900, 900, 900]$, $p = [1450, 1500, 1550, 1600, 1650, 1700]$, $h = 4$, $I_{\\text{init}} = 4500$, $z = 1.645$, $\\sigma_L = 1.0$。\n- 案例 4（零提前期，需求激增）：\n  - $T = 4$, $L = 0$, $d = [500, 1500, 500, 1500]$, $p = [1600, 1600, 1600, 1600]$, $h = 6$, $I_{\\text{init}} = 0$, $z = 0.5$, $\\sigma_L = 0.0$。\n- 案例 5（单次大幅需求激增，价格下降）：\n  - $T = 5$, $L = 1$, $d = [700, 700, 2000, 700, 700]$, $p = [1700, 1650, 1600, 1550, 1500]$, $h = 3$, $I_{\\text{init}} = 1200$, $z = 0.5$, $\\sigma_L = 0.2$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[c_1,c_2,c_3,c_4,c_5]$），其中每个 $c_i$ 是案例 $i$ 的最小总成本（以美元计），四舍五入到小数点后两位。",
            "solution": "## 问题验证\n\n### 第 1 步：提取已知信息\n\n- **计划期**：一个包含 $T$ 个离散时期的有限计划期，由 $t \\in \\{0, 1, \\dots, T-1\\}$ 索引。\n- **决策变量**：\n    - $q_t \\ge 0$：在时期 $t$ 开始时下达的订购量。\n    - $I_t \\ge 0$：时期 $t$ 的期末库存。\n- **外生参数**：\n    - $d_t \\ge 0$：时期 $t$ 的外生需求（公斤）。\n    - $p_t \\ge 0$：时期 $t$ 的采购价格（USD/公斤）。\n    - $h \\ge 0$：持有成本（USD/公斤-时期）。\n    - $L \\in \\mathbb{Z}_{\\ge 0}$：确定性提前期（时期）。\n    - $I_{\\text{init}} \\ge 0$：$t=-1$ 时的初始库存（公斤）。\n    - $\\sigma_L \\ge 0$：提前期延迟的标准差（时期）。\n    - $z \\ge 0$：目标服务因子（标准正态分位数）。\n- **约束和方程**：\n    1.  **质量平衡**：\n        $$\n        I_t \\;=\\; I_{t-1} \\;+\\; \\begin{cases} q_{t-L},  \\text{if } t \\ge L, \\\\ 0,  \\text{if } t  L, \\end{cases} \\;-\\; d_t\n        $$\n        约定 $I_{-1} = I_{\\text{init}}$。\n    2.  **订单非负性**：对所有 $t \\in \\{0, \\dots, T-1\\}$，$q_t \\ge 0$。\n    3.  **安全库存**：对所有 $t$，$I_t \\ge S_t$，其中 $S_t$ 是一个待推导的恒定安全库存。\n- **目标函数**：最小化总成本 $C$。\n    $$\n    C \\;=\\; \\sum_{t=0}^{T-1} \\left( p_t \\, q_t \\;+\\; h \\, I_t \\right)\n    $$\n- **安全库存推导**：$S_t$ 必须使用 $z$、$\\sigma_L$ 和需求序列 $\\{d_t\\}$ 从第一性原理推导得出，并且在整个计划期内为常数。\n- **测试用例**：提供了五组不同的参数集，包括 $T, L, d, p, h, I_{\\text{init}}, z, \\sigma_L$。\n\n### 第 2 步：使用提取的已知信息进行验证\n\n该问题是多时期库存控制问题的一个定义明确的实例。在运筹学和供应链管理领域内，它在数学和科学上都是合理的。\n\n- **科学依据**：该模型基于质量守恒的基本原理，通过一个标准的库存平衡方程来表达。成本结构是线性的，使用安全库存来缓冲提前期不确定性是库存理论中一种标准且成熟的做法。该问题是一个不确定性下动态批量决策的教科书式例子，被形式化为一个确定性线性规划，其中安全库存被用作随机元素的代理。\n- **适定性**：该问题定义了一个线性目标函数和一组线性等式及不等式约束。这种结构构成一个线性规划 (LP)。鉴于所提供的测试用例被设计为存在可行解（例如，初始库存足以在第一批订单到达前弥补初始需求缺口），可以使用标准线性规划求解器找到一个唯一、稳定且有意义的最优解。\n- **客观性和完整性**：问题陈述是精确、量化的，并且没有主观性语言。所有必要的参数和关系都已提供。唯一需要推导的元素是安全库存 $S_t$，其推导遵循“从第一性原理推导”并使用所提供参数的指示。对此的标准方法如下：\n    - 安全库存 $S$ 用于缓冲提前期内需求的不确定性。\n    - 在此，每个时期的需求率 $d_t$ 是确定性的，但提前期是随机的，均值为 $L$，标准差为 $\\sigma_L$。\n    - 补货提前期内的总需求是风险的来源。一个标准的近似方法是考虑不确定提前期内的平均需求率 $\\bar{d}$。\n    - 计划期内的平均需求率为 $\\bar{d} = \\frac{1}{T} \\sum_{t=0}^{T-1} d_t$。\n    - 提前期内需求的标准差 $\\sigma_{LTD}$ 是由提前期的方差驱动的：$\\sigma_{LTD} = \\bar{d} \\times \\sigma_L$。\n    - 安全库存即服务水平因子 $z$ 与此标准差的乘积：$S = z \\cdot \\sigma_{LTD} = z \\cdot \\sigma_L \\cdot \\bar{d}$。\n    - 根据要求，此安全库存 $S$ 对所有时期 $t$ 都是恒定的。约束 $I_t \\ge S_t$ 变为对所有 $t$ 的 $I_t \\ge S$。\n\n该问题没有表现出任何缺陷。它是一个有效、适定且可形式化的优化问题。\n\n### 第 3 步：结论与行动\n问题是有效的。将提供一个解决方案。\n\n## 解决方案\n\n该问题旨在为低浓缩铀 (LEU) 在有限计划期 $T$ 内找到成本最低的库存计划。这可以被构建并作为一个线性规划 (LP) 问题来解决。该解决方案将库存管理原则与数学优化相结合。\n\n### 基于原则的设计\n\n1.  **库存动态与质量守恒**：模型的核心是质量平衡方程，它强制了物料 (LEU) 随时间的守恒。对于每个时期 $t$，期末库存 $I_t$ 由上一时期的库存 $I_{t-1}$、任何新收到的物料 $R_t$ 以及为满足需求 $d_t$ 而消耗的物料决定。\n    $$I_t = I_{t-1} + R_t - d_t$$\n    时期 $t$ 的接收量 $R_t$ 对应于 $L$ 个时期前下的订单 $q_{t-L}$。这在订购决策与物料可用性之间建立了一个时滞关系。\n\n2.  **通过安全库存进行风险管理**：浓缩提前期的不确定性引入了缺货的风险。为缓解此风险，需要维持一个安全库存。安全库存的数量反映了持有额外库存的成本与缺货成本之间的权衡。该问题通过指定一个服务水平因子 $z$ 来将这种权衡操作化。安全库存 $S$ 是基于提前期内需求的变化性来计算的。如在验证步骤中所推导，恒定的安全库存由下式给出：\n    $$S = z \\cdot \\sigma_L \\cdot \\bar{d} = z \\cdot \\sigma_L \\cdot \\left( \\frac{1}{T} \\sum_{i=0}^{T-1} d_i \\right)$$\n    对所有时期施加约束 $I_t \\ge S$ 确保了计划库存水平永远不会低于这个保护性缓冲。\n\n3.  **经济优化**：目标是最小化总成本，它由采购成本和库存持有成本组成。\n    - 时期 $t$ 的采购成本为 $p_t q_t$。\n    - 时期 $t$ 的持有成本为 $h I_t$，代表将期末库存 $I_t$ 持有至下一时期的成本。\n    计划期 $T$ 内的总成本是所有时期这些成本的总和，构成了该线性规划的目标函数。\n\n### 线性规划构建\n该问题可以转化为线性规划 (LP) 的标准形式。\n\n- **决策变量**：待确定的变量集为 $\\{q_0, \\dots, q_{T-1}\\}$ 和 $\\{I_0, \\dots, I_{T-1}\\}$，它们构成一个向量 $x \\in \\mathbb{R}^{2T}$。我们将此向量构造为 $x = [q_0, \\dots, q_{T-1}, I_0, \\dots, I_{T-1}]^T$。\n\n- **目标函数**：最小化 $C = c^T x$，其中成本向量 $c \\in \\mathbb{R}^{2T}$ 由价格和持有成本构成：\n    $$c = [p_0, \\dots, p_{T-1}, h, \\dots, h]^T$$\n\n- **约束**：\n    1.  **质量平衡（等式约束：$A_{eq}x = b_{eq}$）**：质量平衡方程被重写为一个包含 $T$ 个线性方程的系统。对于每个时期 $t \\in \\{0, \\dots, T-1\\}$：\n        - 对于 $t=0$：$I_0 - R_0 = I_{\\text{init}} - d_0$。项 $R_0$ 是 $q_{0-L}$，仅当 $L=0$ 时非零。\n        - 对于 $t0$：$I_t - I_{t-1} - R_t = -d_t$。项 $R_t$ 是 $q_{t-L}$，仅当 $t \\ge L$ 时非零。\n        这 $T$ 个方程构成了矩阵 $A_{eq}$ 和向量 $b_{eq}$。\n\n    2.  **非负性和安全库存（边界）**：\n        - 订购量必须为非负：$q_t \\ge 0$。\n        - 期末库存必须达到安全库存水平：$I_t \\ge S$。由于 $S \\ge 0$，这也确保了 $I_t \\ge 0$。\n        这些约束通过决策变量的下界来处理最为高效：\n        - 对于 $t \\in \\{0, \\dots, T-1\\}$，$q_t$ 的下界是 $0$。\n        - 对于 $t \\in \\{0, \\dots, T-1\\}$，$I_t$ 的下界是 $S$。\n\n### 使用 `scipy.optimize.linprog` 实现\n\n该线性规划使用 `scipy.optimize.linprog` 求解。实现过程包括：\n1. 根据给定的案例参数计算安全库存 $S$。\n2. 构建成本向量 `c`。\n3. 通过遍历时期 $t=0, \\dots, T-1$ 并为 $I_t$、$I_{t-1}$ 和 $q_{t-L}$ 设置适当的系数，来构建等式约束矩阵 `A_eq` 和向量 `b_eq`。\n4. 为每个变量（$q_t$ 和 $I_t$）定义 `bounds`（边界）。\n5. 使用这些参数调用 `linprog` 函数。“highs” 求解器因其鲁棒性和性能而被选用。\n6. 最优总成本由求解器输出的 `result.fun` 给出。该值按要求四舍五入到小数点后两位。\n对问题陈述中提供的每个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Main function to solve the LEU inventory planning problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (baseline, no safety stock)\n        {\n            \"T\": 6, \"L\": 2, \"d\": [800, 800, 900, 900, 1000, 1100],\n            \"p\": [1500, 1500, 1500, 1500, 1500, 1500], \"h\": 5, \"I_init\": 2000,\n            \"z\": 0.0, \"sigma_L\": 0.5\n        },\n        # Case 2 (moderate safety stock)\n        {\n            \"T\": 6, \"L\": 2, \"d\": [800, 800, 900, 900, 1000, 1100],\n            \"p\": [1500, 1500, 1500, 1500, 1500, 1500], \"h\": 5, \"I_init\": 2600,\n            \"z\": 1.0, \"sigma_L\": 0.5\n        },\n        # Case 3 (rising prices, larger lead time and safety stock)\n        {\n            \"T\": 6, \"L\": 3, \"d\": [900, 900, 900, 900, 900, 900],\n            \"p\": [1450, 1500, 1550, 1600, 1650, 1700], \"h\": 4, \"I_init\": 4500,\n            \"z\": 1.645, \"sigma_L\": 1.0\n        },\n        # Case 4 (zero lead time, demand spikes)\n        {\n            \"T\": 4, \"L\": 0, \"d\": [500, 1500, 500, 1500],\n            \"p\": [1600, 1600, 1600, 1600], \"h\": 6, \"I_init\": 0,\n            \"z\": 0.5, \"sigma_L\": 0.0\n        },\n        # Case 5 (single large demand spike, decreasing prices)\n        {\n            \"T\": 5, \"L\": 1, \"d\": [700, 700, 2000, 700, 700],\n            \"p\": [1700, 1650, 1600, 1550, 1500], \"h\": 3, \"I_init\": 1200,\n            \"z\": 0.5, \"sigma_L\": 0.2\n        },\n    ]\n\n    results = []\n    for case_params in test_cases:\n        cost = run_single_case(**case_params)\n        results.append(cost)\n    \n    # Format results for the final print statement\n    formatted_results = [f\"{res:.2f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef run_single_case(T, L, d, p, h, I_init, z, sigma_L):\n    \"\"\"\n    Formulates and solves the LP for a single inventory planning case.\n\n    Args:\n        T (int): Planning horizon length.\n        L (int): Deterministic lead time.\n        d (list): Demand sequence.\n        p (list): Price sequence.\n        h (float): Holding cost.\n        I_init (float): Initial inventory.\n        z (float): Service factor.\n        sigma_L (float): Standard deviation of lead time delay.\n\n    Returns:\n        float: The minimum total cost.\n    \"\"\"\n    # 1. Calculate Constant Safety Stock (S)\n    if T > 0:\n        avg_d = np.mean(d)\n    else:\n        avg_d = 0.0\n    S = z * sigma_L * avg_d\n\n    # 2. Define the Linear Program\n    # Decision variables are [q_0, ..., q_{T-1}, I_0, ..., I_{T-1}]\n    num_vars = 2 * T\n\n    # Objective function: minimize sum(p_t * q_t) + sum(h * I_t)\n    c = np.array(p + [h] * T)\n\n    # Equality constraints (A_eq * x = b_eq) for mass balance\n    A_eq = np.zeros((T, num_vars))\n    b_eq = np.zeros(T)\n\n    for t in range(T):\n        # I_t coefficient\n        A_eq[t, T + t] = 1.0\n        \n        if t == 0:\n            # Equation for t=0: I_0 - R_0 = I_init - d_0\n            b_eq[t] = I_init - d[t]\n        else:\n            # Equation for t>0: I_t - I_{t-1} - R_t = -d_t\n            A_eq[t, T + t - 1] = -1.0\n            b_eq[t] = -d[t]\n        \n        # Receipt R_t = q_{t-L} is non-zero only for t >= L\n        if t >= L:\n            # Coefficient for q_{t-L}\n            q_idx = t - L\n            A_eq[t, q_idx] = -1.0\n\n    # Variable bounds\n    # q_t >= 0 for t in {0, ..., T-1}\n    q_bounds = [(0, None) for _ in range(T)]\n    # I_t >= S for t in {0, ..., T-1}\n    I_bounds = [(S, None) for _ in range(T)]\n    bounds = q_bounds + I_bounds\n\n    # 3. Solve the LP\n    res = linprog(c, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n    \n    if res.success:\n        return res.fun\n    else:\n        # This case should not be reached with the given test suite\n        # as they are designed to be feasible.\n        raise RuntimeError(f\"LP optimization failed for case. Status: {res.message}\")\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}