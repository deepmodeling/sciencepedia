{
    "hands_on_practices": [
        {
            "introduction": "To make long-term energy models computationally tractable, we often simplify continuous time into a smaller set of 'representative periods'. However, this simplification is not without consequence; the chosen time resolution must be fine enough to capture critical operational constraints, like the minimum up and down times of thermal power plants. This exercise  challenges you to determine the minimum temporal fidelity required, illustrating the fundamental trade-off between model accuracy and computational feasibility.",
            "id": "4102481",
            "problem": "A power system planning model uses a reduced chronological time representation based on representative periods to couple long-term investment decisions with short-term operational feasibility. Consider a single inflexible thermal unit subject to minimum up and minimum down time constraints, scheduled through a binary commitment variable that may only change state at the boundaries of fixed-length representative periods.\n\nAssume the following physically grounded data and modeling choices:\n- Each representative period has length $L$ hours, and periods are linked in sequence to enforce chronology. In this problem, take $L = 24$ hours.\n- The unit has minimum up time $U$ hours and minimum down time $D$ hours. In this problem, take $U = 72$ hours and $D = 36$ hours.\n- The typical weekly residual load pattern is such that, absent minimum time constraints, the unit would be economically committed for $H_{\\text{on}}$ consecutive hours and then decommitted for $H_{\\text{off}}$ consecutive hours within each repeating weekly cycle. In this problem, take $H_{\\text{on}} = 5 \\times 24$ hours and $H_{\\text{off}} = 2 \\times 24$ hours, reflecting five high-load weekdays followed by two low-load weekend days.\n\nStarting only from the core definitions of minimum up and minimum down times in unit commitment and the construction of representative periods as fixed-length chronological blocks, derive a necessary lower bound on the number $K$ of representative periods that must be linked in sequence so that the reduced model can represent at least one full on-off weekly cycle that is feasible with respect to the unit’s minimum time constraints and faithful to the stated weekly load regime. Then, compute the minimum $K$ under the given numerical values. Express the final answer as a single integer (unitless). No rounding is required.",
            "solution": "The problem will be validated before a solution is attempted.\n\n### Step 1: Extract Givens\n- Length of a representative period: $L = 24$ hours.\n- Minimum up time of the thermal unit: $U = 72$ hours.\n- Minimum down time of the thermal unit: $D = 36$ hours.\n- Economic commitment duration per cycle: $H_{\\text{on}} = 5 \\times 24$ hours.\n- Economic decommitment duration per cycle: $H_{\\text{off}} = 2 \\times 24$ hours.\n- The unit's commitment state (on/off) is represented by a binary variable.\n- State changes can only occur at the boundaries of representative periods.\n- The objective is to find the necessary lower bound on the number of linked representative periods, $K$, to represent one full, feasible on-off cycle.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded**: The problem is well-grounded in the field of power systems engineering and operations research. The concepts of unit commitment, minimum up/down times, and the use of representative periods (time-slicing) are standard techniques in long-term energy planning models (e.g., capacity expansion models) to manage computational complexity while retaining operational feasibility. The numerical values provided are realistic for a large baseload or mid-merit thermal power plant.\n- **Well-Posed**: The problem is well-posed. It provides a clear objective (find a minimum integer $K$) and a complete set of constraints and parameters ($L, U, D, H_{\\text{on}}, H_{\\text{off}}$). A unique and meaningful solution can be derived from the given information.\n- **Objective**: The problem is stated in precise, objective language common to engineering and mathematical modeling. There are no subjective or ambiguous terms.\n\nThe problem does not exhibit any of the invalidity flaws. It is not scientifically unsound, non-formalizable, incomplete, unrealistic, ill-posed, or trivial. It poses a genuine and relevant question in energy systems modeling.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be derived.\n\n### Solution Derivation\n\nThe problem requires determining the minimum number of sequentially linked representative periods, $K$, needed to model a single, feasible on-off cycle of a thermal unit. The model's time representation is discrete, consisting of periods of length $L$. However, the unit's physical constraints operate in continuous time.\n\nLet the number of consecutive periods the unit is committed (ON) be $N_{\\text{on}}$, and the number of consecutive periods it is decommitted (OFF) be $N_{\\text{off}}$. Since the commitment state can only change at period boundaries, $N_{\\text{on}}$ and $N_{\\text{off}}$ must be integers.\n\nThe total duration of the commitment phase in the model is $T_{\\text{on}} = N_{\\text{on}} L$. This duration must satisfy two conditions:\n1.  **Physical Feasibility**: The commitment duration must respect the unit's minimum up time, $U$. Therefore, $T_{\\text{on}} \\geq U$.\n2.  **Faithfulness to Load Regime**: The model must be capable of representing the economic imperative to be online for $H_{\\text{on}}$ hours. This means the scheduled ON duration must be at least as long as the desired economic ON duration. If $T_{\\text{on}} < H_{\\text{on}}$, the model could not satisfy the economic signal, violating the problem's premise. Therefore, $T_{\\text{on}} \\geq H_{\\text{on}}$.\n\nCombining these two conditions, the total ON time in the reduced model must be greater than or equal to the maximum of the physical and economic requirements:\n$$N_{\\text{on}} L \\geq \\max(U, H_{\\text{on}})$$\nSince $N_{\\text{on}}$ must be an integer, the minimum number of periods required for the ON phase is found by isolating $N_{\\text{on}}$ and taking the ceiling of the resulting expression, as any fractional part would require an additional full period.\n$$N_{\\text{on}} = \\left\\lceil \\frac{\\max(U, H_{\\text{on}})}{L} \\right\\rceil$$\n\nSimilarly, the total duration of the decommitment phase is $T_{\\text{off}} = N_{\\text{off}} L$. This duration must also satisfy two analogous conditions:\n1.  **Physical Feasibility**: The decommitment duration must respect the unit's minimum down time, $D$. Therefore, $T_{\\text{off}} \\geq D$.\n2.  **Faithfulness to Load Regime**: The model must be able to represent the economic imperative to be offline for $H_{\\text{off}}$ hours. Therefore, $T_{\\text{off}} \\geq H_{\\text{off}}$.\n\nCombining these, the total OFF time must satisfy:\n$$N_{\\text{off}} L \\geq \\max(D, H_{\\text{off}})$$\nThe minimum integer number of periods required for the OFF phase is:\n$$N_{\\text{off}} = \\left\\lceil \\frac{\\max(D, H_{\\text{off}})}{L} \\right\\rceil$$\n\nA \"full on-off weekly cycle\" requires a sequence of ON periods followed by a sequence of OFF periods. The total number of representative periods, $K$, needed to model this complete cycle is the sum of the minimum periods for the ON phase and the minimum periods for the OFF phase.\n$$K = N_{\\text{on}} + N_{\\text{off}} = \\left\\lceil \\frac{\\max(U, H_{\\text{on}})}{L} \\right\\rceil + \\left\\lceil \\frac{\\max(D, H_{\\text{off}})}{L} \\right\\rceil$$\n\nNow, we substitute the given numerical values:\n- $L = 24$\n- $U = 72$\n- $D = 36$\n- $H_{\\text{on}} = 5 \\times 24 = 120$\n- $H_{\\text{off}} = 2 \\times 24 = 48$\n\nFirst, calculate $N_{\\text{on}}$:\n$$\\max(U, H_{\\text{on}}) = \\max(72, 120) = 120$$\n$$N_{\\text{on}} = \\left\\lceil \\frac{120}{24} \\right\\rceil = \\lceil 5 \\rceil = 5$$\n\nNext, calculate $N_{\\text{off}}$:\n$$\\max(D, H_{\\text{off}}) = \\max(36, 48) = 48$$\n$$N_{\\text{off}} = \\left\\lceil \\frac{48}{24} \\right\\rceil = \\lceil 2 \\rceil = 2$$\n\nFinally, the total minimum number of linked periods, $K$, is:\n$$K = N_{\\text{on}} + N_{\\text{off}} = 5 + 2 = 7$$\n\nThus, a minimum of $7$ representative periods (each of length $24$ hours) must be linked chronologically to ensure that the model can represent a feasible on-off cycle that is consistent with both the unit's physical constraints and the specified weekly operating pattern.",
            "answer": "$$\\boxed{7}$$"
        },
        {
            "introduction": "Long-term investment models are frequently computationally intensive, compelling planners to adopt a truncated time horizon that is shorter than an asset's true operational life. Ignoring cash flows beyond this artificial boundary introduces a significant bias, potentially leading to flawed investment decisions. In this practice problem , you will derive the precise formula for a 'terminal value' that corrects this truncation bias, providing a powerful tool to ensure that finite-horizon models make economically sound long-term choices.",
            "id": "4102539",
            "problem": "A power system planner evaluates a capital-intensive asset intended to operate for $30$ years but uses a short-term planning model with a $10$-year horizon. The model represents post-horizon effects by adding a terminal (salvage) value at year $10$. Let the real discount rate be $r>0$. Assume the following conditions hold in real terms:\n- Annual operations and maintenance (O&M) cost is a constant $O>0$, incurred at the end of each operating year that the asset remains in service.\n- Under the full-horizon plan, the asset operates through year $30$ and has zero residual value at year $30$.\n- Under the truncated $10$-year plan, all cash flows after year $10$ are omitted and a terminal value $S$ is credited at year $10$.\n- All cash flows occur at the end of each year.\n\nDefine the truncation bias in net present value as the difference between the net present value computed under the truncated $10$-year model and the true net present value under the full $30$-year model, evaluated at time $0$:\n$$\\text{Bias} \\equiv \\text{NPV}_{10} - \\text{NPV}_{30}.$$\n\nStarting only from the definition of net present value as the discounted sum of cash flows and the geometric series identity, derive a closed-form expression for $\\text{Bias}$ in terms of $S$, $O$, and $r$, assuming the only difference between the two models is the representation of years $11$ through $30$ as described above. Also, state the expression for the terminal value at year $10$ that would eliminate truncation bias.\n\nExpress your final answer as a single closed-form analytic expression in terms of $S$, $O$, and $r$. Do not include units. No numerical rounding is required.",
            "solution": "The analysis of this problem begins with the formal definition of Net Present Value (NPV), which is the sum of all cash flows, each discounted to its present value at time $t=0$. For a series of cash flows $C_t$ occurring at the end of each year $t$, with a constant real discount rate $r$, the NPV is given by:\n$$\n\\text{NPV} = \\sum_{t=0}^{N} \\frac{C_t}{(1+r)^t}\n$$\nwhere $N$ is the total time horizon of the evaluation.\n\nFirst, we establish the NPV for the full $30$-year horizon, denoted as $\\text{NPV}_{30}$. The cash flows for this model are:\n-   An initial capital investment at $t=0$, which we can denote as $-I_0$. Since this cost is common to both models, it will cancel out in the bias calculation.\n-   A constant annual operations and maintenance (O&M) cost of $O$, occurring as an outflow ($-O$) at the end of each year from $t=1$ to $t=30$.\n-   A residual value of $0$ at year $30$, which does not contribute a cash flow term.\n\nThe expression for $\\text{NPV}_{30}$ is therefore:\n$$\n\\text{NPV}_{30} = -I_0 + \\sum_{t=1}^{30} \\frac{-O}{(1+r)^t} = -I_0 - O \\sum_{t=1}^{30} (1+r)^{-t}\n$$\n\nNext, we establish the NPV for the truncated $10$-year horizon, denoted as $\\text{NPV}_{10}$. The cash flows are:\n-   The same initial capital investment, $-I_0$, at $t=0$.\n-   The O&M cost, $-O$, at the end of each year from $t=1$ to $t=10$.\n-   A terminal (salvage) value, $S$, credited as an inflow at the end of year $t=10$.\n\nThe expression for $\\text{NPV}_{10}$ is:\n$$\n\\text{NPV}_{10} = -I_0 + \\left( \\sum_{t=1}^{10} \\frac{-O}{(1+r)^t} \\right) + \\frac{S}{(1+r)^{10}} = -I_0 - O \\sum_{t=1}^{10} (1+r)^{-t} + \\frac{S}{(1+r)^{10}}\n$$\n\nThe truncation bias is defined as the difference between these two NPVs:\n$$\n\\text{Bias} \\equiv \\text{NPV}_{10} - \\text{NPV}_{30}\n$$\nSubstituting the expressions for $\\text{NPV}_{10}$ and $\\text{NPV}_{30}$:\n$$\n\\text{Bias} = \\left( -I_0 - O \\sum_{t=1}^{10} (1+r)^{-t} + \\frac{S}{(1+r)^{10}} \\right) - \\left( -I_0 - O \\sum_{t=1}^{30} (1+r)^{-t} \\right)\n$$\nThe initial investment term, $-I_0$, cancels out. We can rearrange the summation terms:\n$$\n\\text{Bias} = \\frac{S}{(1+r)^{10}} - O \\sum_{t=1}^{10} (1+r)^{-t} + O \\sum_{t=1}^{30} (1+r)^{-t}\n$$\nThe sum from $t=1$ to $t=30$ can be split into two parts: a sum from $t=1$ to $t=10$ and a sum from $t=11$ to $t=30$.\n$$\n\\sum_{t=1}^{30} (1+r)^{-t} = \\sum_{t=1}^{10} (1+r)^{-t} + \\sum_{t=11}^{30} (1+r)^{-t}\n$$\nSubstituting this into the bias equation:\n$$\n\\text{Bias} = \\frac{S}{(1+r)^{10}} - O \\sum_{t=1}^{10} (1+r)^{-t} + O \\left( \\sum_{t=1}^{10} (1+r)^{-t} + \\sum_{t=11}^{30} (1+r)^{-t} \\right)\n$$\nThe terms involving the sum from $t=1$ to $t=10$ cancel, leaving:\n$$\n\\text{Bias} = \\frac{S}{(1+r)^{10}} + O \\sum_{t=11}^{30} (1+r)^{-t}\n$$\nThis expression shows that the bias is the sum of the present value of the terminal value $S$ and the present value of the O&M costs from year $11$ to $30$ that were omitted in the truncated model.\n\nTo derive a closed-form expression, we must evaluate the summation, which is a finite geometric series. The identity for a finite geometric series is $\\sum_{k=m}^{n} a^k = a^m \\frac{1-a^{n-m+1}}{1-a}$ for $a \\neq 1$.\nIn our case, the summation is $\\sum_{t=11}^{30} (1+r)^{-t}$. Let $v = (1+r)^{-1}$. The sum is $\\sum_{t=11}^{30} v^t$.\nHere, the first term is $v^{11}$, the common ratio is $v$, and the number of terms is $30 - 11 + 1 = 20$.\nThe sum is:\n$$\n\\sum_{t=11}^{30} v^t = v^{11} \\frac{1-v^{20}}{1-v}\n$$\nSubstituting $v = (1+r)^{-1}$ and $1-v = 1 - \\frac{1}{1+r} = \\frac{r}{1+r}$:\n$$\n\\sum_{t=11}^{30} (1+r)^{-t} = \\frac{1}{(1+r)^{11}} \\frac{1 - (1+r)^{-20}}{r/(1+r)} = \\frac{1}{(1+r)^{11}} \\frac{1+r}{r} (1 - (1+r)^{-20})\n$$\n$$\n= \\frac{1}{r(1+r)^{10}} (1 - (1+r)^{-20}) = \\frac{1}{r} \\left( \\frac{1}{(1+r)^{10}} - \\frac{1}{(1+r)^{30}} \\right)\n$$\nSubstituting this closed form for the sum back into the expression for bias:\n$$\n\\text{Bias} = \\frac{S}{(1+r)^{10}} + O \\left[ \\frac{1}{r} \\left( \\frac{1}{(1+r)^{10}} - \\frac{1}{(1+r)^{30}} \\right) \\right]\n$$\nThis can be rearranged into a more compact form:\n$$\n\\text{Bias} = \\frac{S}{(1+r)^{10}} + \\frac{O}{r(1+r)^{10}} - \\frac{O}{r(1+r)^{30}}\n$$\n$$\n\\text{Bias} = \\frac{Sr + O}{r(1+r)^{10}} - \\frac{O}{r(1+r)^{30}}\n$$\n\nThe second task is to find the terminal value $S$ that eliminates the truncation bias, i.e., makes $\\text{Bias} = 0$. Let's call this value $S^*$.\n$$\n0 = \\frac{S^*}{(1+r)^{10}} + O \\sum_{t=11}^{30} (1+r)^{-t}\n$$\nSolving for $S^*$:\n$$\nS^* = -(1+r)^{10} \\cdot O \\sum_{t=11}^{30} (1+r)^{-t}\n$$\nThis means $S^*$ is the negative of the future value at year $10$ of all O&M costs from year $11$ to $30$. Equivalently, $S^*$ is the present value at year $10$ of the truncated cash flows. Let's calculate this value. The index of summation can be shifted by defining $k = t-10$.\n$$\nS^* = -O (1+r)^{10} \\sum_{k=1}^{20} (1+r)^{-(k+10)} = -O (1+r)^{10} (1+r)^{-10} \\sum_{k=1}^{20} (1+r)^{-k}\n$$\n$$\nS^* = -O \\sum_{k=1}^{20} (1+r)^{-k}\n$$\nThis is the PV of a $20$-year annuity of $O$, which is a standard financial calculation:\n$$\n\\sum_{k=1}^{20} (1+r)^{-k} = \\frac{1}{r} \\left( 1 - \\frac{1}{(1+r)^{20}} \\right)\n$$\nThus, the terminal value that eliminates the bias is:\n$$\nS^* = -\\frac{O}{r} \\left( 1 - (1+r)^{-20} \\right)\n$$\nThe value is negative because it must compensate for a stream of future *costs* that are ignored by the truncated model.\n\nThe problem asks for a final answer expressing the bias in terms of $S$, $O$, and $r$. Combining the terms provides the final expression.\n$$\n\\text{Bias} = \\frac{S}{(1+r)^{10}} + \\frac{O}{r}\\left(\\frac{1}{(1+r)^{10}} - \\frac{1}{(1+r)^{30}}\\right)\n$$\nThis can also be written as:\n$$\n\\text{Bias} = \\frac{1}{(1+r)^{10}} \\left( S + \\frac{O}{r} \\right) - \\frac{O}{r(1+r)^{30}}\n$$",
            "answer": "$$\\boxed{\\frac{S}{(1+r)^{10}} + \\frac{O}{r} \\left( \\frac{1}{(1+r)^{10}} - \\frac{1}{(1+r)^{30}} \\right)}$$"
        },
        {
            "introduction": "Sophisticated energy system planning often involves linking a high-level, long-term investment model with detailed, short-term operational subproblems. Benders decomposition offers a rigorous mathematical framework for this connection, using duality theory to generate 'cuts' that communicate the operational cost implications of investment choices back to the main problem. This advanced exercise  guides you through the derivation of a Benders optimality cut, revealing how shadow prices from the operational model quantify the marginal value of capacity, thus forming the crucial feedback loop between short-term and long-term horizons.",
            "id": "4102493",
            "problem": "Consider a two-level planning model for an electricity system with a long-term investment master problem and a short-term operations subproblem. The investment vector is $y = (y_{E}, y_{P}, y_{G})$, where $y_{E}$ is the installed storage energy capacity in megawatt-hours (MWh), $y_{P}$ is the installed storage power capacity in megawatts (MW) (assumed to bound both charging and discharging rates), and $y_{G}$ is the installed dispatchable generation capacity in megawatts (MW). For a given investment $y$, the operations subproblem optimizes over $T$ hourly periods. The operational decision variables are, for each hour $t \\in \\{1,\\dots,T\\}$: dispatchable generation $g_{t} \\geq 0$, storage charge $c_{t} \\geq 0$, storage discharge $d_{t} \\geq 0$, and state of charge $s_{t} \\geq 0$. Let demand $D_{t} \\geq 0$ be given, let the initial state of charge be $s_{0} \\geq 0$, and let charging and discharging efficiencies be $\\eta_{c} \\in (0,1]$ and $\\eta_{d} \\in (0,1]$. Let nonnegative linear operating costs be $C_{G}$ (in dollars per megawatt-hour, denoted $\\$\\!/ \\mathrm{MWh}$) for generation, $C_{c}$ (in $\\$\\!/ \\mathrm{MWh}$) for charging, and $C_{d}$ (in $\\$\\!/ \\mathrm{MWh}$) for discharging. The operations subproblem is the following linear program:\n$$\n\\min_{g_{t},\\,c_{t},\\,d_{t},\\,s_{t} \\geq 0} \\;\\sum_{t=1}^{T} \\big( C_{G}\\, g_{t} + C_{c}\\, c_{t} + C_{d}\\, d_{t} \\big)\n$$\nsubject to, for all $t=1,\\dots,T$,\n$$\n\\text{(balance)}\\quad g_{t} + d_{t} - c_{t} = D_{t},\n$$\n$$\n\\text{(intertemporal)}\\quad s_{t} = s_{t-1} + \\eta_{c}\\, c_{t} - \\eta_{d}^{-1} d_{t},\n$$\n$$\n\\text{(gen cap)}\\quad g_{t} \\leq y_{G},\n$$\n$$\n\\text{(charge cap)}\\quad c_{t} \\leq y_{P},\n$$\n$$\n\\text{(discharge cap)}\\quad d_{t} \\leq y_{P},\n$$\n$$\n\\text{(energy cap)}\\quad s_{t} \\leq y_{E},\n$$\nand the terminal cycling condition\n$$\n\\text{(terminal)}\\quad s_{T} = s_{0}.\n$$\nYou may assume all data are feasible and that the operations subproblem has a finite optimal solution for any nonnegative $y$.\n\nStarting from the standard duality of linear programming, and using only fundamental linear optimization principles, proceed as follows:\n- Reformulate the operations subproblem in matrix form as a minimization with equality constraints and less-than-or-equal-to capacity constraints whose right-hand sides depend affinely on $y$.\n- Derive its dual, clearly identifying the dual variables associated with each class of constraints: let $\\lambda_{t}$ be the dual variable for the balance equality, $\\nu_{t}$ be the dual variable for the intertemporal equality, $\\tau$ be the dual variable for the terminal equality, and let $\\alpha_{t} \\geq 0$, $\\beta_{t} \\geq 0$, $\\gamma_{t} \\geq 0$, $\\sigma_{t} \\geq 0$ be the dual variables for the generation, charge, discharge, and energy capacity constraints, respectively.\n- Use strong duality to write the optimal operations cost as the value of the dual objective at an optimal dual solution. Identify the recourse value’s dependence on $y$ and express the Benders optimality cut’s coefficient vector with respect to $y$ as a function of the optimal dual variables.\n\nYour final output should be the coefficient vector of the Benders optimality cut with respect to $(y_{E}, y_{P}, y_{G})$, written compactly as a single row vector whose components are symbolic expressions in the dual variables $\\alpha_{t}$, $\\beta_{t}$, $\\gamma_{t}$, and $\\sigma_{t}$. Express this vector in monetary units per capacity unit, with the first component in dollars per megawatt-hour, and the second and third components in dollars per megawatt. Do not include units in your final boxed answer. No rounding is required; provide an exact symbolic expression.",
            "solution": "The user wants to derive the coefficient vector of a Benders optimality cut for a two-level energy system planning problem.\n\n### **Step 1: Problem Validation**\nThe problem statement describes a standard two-stage stochastic programming structure applied to energy system planning, where the first-stage (master problem) decisions are investments $y = (y_E, y_P, y_G)$ and the second-stage (subproblem) decisions are hourly operations. The subproblem is a linear program (LP) whose constraints depend on the investment vector $y$. The task is to reformulate this LP, derive its dual, and determine the coefficients of the Benders optimality cut corresponding to the investment variables.\n\n**Givens:**\n-   Investment vector: $y = (y_{E}, y_{P}, y_{G})$ for storage energy capacity (MWh), storage power capacity (MW), and generation capacity (MW).\n-   Operational variables for $t \\in \\{1,\\dots,T\\}$: $g_t, c_t, d_t, s_t \\ge 0$.\n-   Parameters: $D_t, s_0, \\eta_c, \\eta_d, C_G, C_c, C_d$.\n-   Primal Operations Subproblem $P(y)$:\n    $$\n    \\min_{g_{t},\\,c_{t},\\,d_{t},\\,s_{t} \\geq 0} \\;\\sum_{t=1}^{T} \\big( C_{G}\\, g_{t} + C_{c}\\, c_{t} + C_{d}\\, d_{t} \\big)\n    $$\n    subject to, for $t=1,\\dots,T$:\n    1.  $g_{t} + d_{t} - c_{t} = D_{t}$\n    2.  $s_{t} = s_{t-1} + \\eta_{c}\\, c_{t} - \\eta_{d}^{-1} d_{t}$\n    3.  $g_{t} \\leq y_{G}$\n    4.  $c_{t} \\leq y_{P}$\n    5.  $d_{t} \\leq y_{P}$\n    6.  $s_{t} \\leq y_{E}$\n    and $s_{T} = s_{0}$.\n-   Assumption: The subproblem is feasible and bounded for any $y \\ge 0$.\n-   Dual variable assignments: $\\lambda_t$ for balance, $\\nu_t$ for intertemporal, $\\tau$ for terminal, and $\\alpha_t, \\beta_t, \\gamma_t, \\sigma_t \\ge 0$ for capacity constraints.\n\n**Validation:**\n1.  **Scientifically Grounded:** The model is a standard, simplified representation of an electricity system with dispatchable generation and energy storage. The constraints represent fundamental principles such as energy balance and capacity limits. The formulation is scientifically sound.\n2.  **Well-Posed:** The problem is a well-defined linear program. The task of deriving a Benders cut from an LP subproblem is a standard procedure in optimization theory. The assumption of feasibility and boundedness ensures a solution exists.\n3.  **Objective:** The problem is stated with mathematical precision and without ambiguity.\n\nThe problem is deemed **valid**. We may proceed with the solution.\n\n### **Step 2: Reformulation and Dual Derivation**\n\nWe begin by formalizing the primal subproblem $P(y)$ and then derive its dual. The problem can be written in a standard form for which duality theory applies.\n\n**Primal Problem Reformulation:**\nThe operations subproblem can be stated as:\n$$\nQ(y) = \\min_{g,c,d,s} \\sum_{t=1}^{T} (C_{G} g_{t} + C_{c} c_{t} + C_{d} d_{t})\n$$\nsubject to:\n-   $g_{t} - c_{t} + d_{t} - D_{t} = 0 \\quad \\forall t \\in \\{1, \\dots, T\\}$ (associated dual variable: $\\lambda_t$)\n-   $s_{t} - s_{t-1} - \\eta_{c} c_{t} + \\eta_{d}^{-1} d_{t} = 0 \\quad \\forall t \\in \\{1, \\dots, T\\}$ (associated dual variable: $\\nu_t$)\n-   $s_{T} - s_{0} = 0$ (associated dual variable: $\\tau$)\n-   $g_{t} - y_{G} \\le 0 \\quad \\forall t \\in \\{1, \\dots, T\\}$ (associated dual variable: $\\alpha_t \\ge 0$)\n-   $c_{t} - y_{P} \\le 0 \\quad \\forall t \\in \\{1, \\dots, T\\}$ (associated dual variable: $\\beta_t \\ge 0$)\n-   $d_{t} - y_{P} \\le 0 \\quad \\forall t \\in \\{1, \\dots, T\\}$ (associated dual variable: $\\gamma_t \\ge 0$)\n-   $s_{t} - y_{E} \\le 0 \\quad \\forall t \\in \\{1, \\dots, T\\}$ (associated dual variable: $\\sigma_t \\ge 0$)\n-   $g_t, c_t, d_t, s_t \\ge 0 \\quad \\forall t \\in \\{1, \\dots, T\\}$\n\nNote that $s_0$ is a fixed parameter. In the intertemporal constraint for $t=1$, $s_{t-1}$ is $s_0$. This can be formally incorporated by rewriting the constraints as a linear system $Ax=b$, but forming the Lagrangian is more direct.\n\n**Lagrangian Formulation:**\nThe Lagrangian $\\mathcal{L}$ for this problem is:\n$$\n\\mathcal{L} = \\sum_{t=1}^{T} (C_{G} g_{t} + C_{c} c_{t} + C_{d} d_{t}) \\\\\n+ \\sum_{t=1}^{T} \\lambda_{t} (g_{t} - c_{t} + d_{t} - D_{t}) \\\\\n+ \\sum_{t=1}^{T} \\nu_{t} (s_{t} - s_{t-1} - \\eta_{c} c_{t} + \\eta_{d}^{-1} d_{t}) \\\\\n+ \\tau (s_{T} - s_{0}) \\\\\n+ \\sum_{t=1}^{T} \\alpha_{t} (g_{t} - y_{G}) \\\\\n+ \\sum_{t=1}^{T} \\beta_{t} (c_{t} - y_{P}) \\\\\n+ \\sum_{t=1}^{T} \\gamma_{t} (d_{t} - y_{P}) \\\\\n+ \\sum_{t=1}^{T} \\sigma_{t} (s_{t} - y_{E})\n$$\nwhere $\\alpha_t, \\beta_t, \\gamma_t, \\sigma_t \\ge 0$, and $\\lambda_t, \\nu_t, \\tau$ are unrestricted in sign. We have absorbed the constant $s_0$ into the structure: the term $\\sum_t \\nu_t (s_t - s_{t-1})$ expands to $\\sum_{t=1}^{T} s_t (\\nu_t - \\nu_{t+1}) + s_T \\nu_T - s_0 \\nu_1$ (with $\\nu_{T+1}=0$). A more careful summation by parts yields $\\sum_{t=1}^{T-1} s_t(\\nu_t - \\nu_{t+1}) + s_T \\nu_T - s_0\\nu_1$.\n\nWe group terms by the primal decision variables $g_t, c_t, d_t, s_t$:\n$$\n\\mathcal{L} = \\sum_{t=1}^{T} g_{t} (C_{G} + \\lambda_{t} + \\alpha_{t}) \\\\\n+ \\sum_{t=1}^{T} c_{t} (C_{c} - \\lambda_{t} - \\eta_{c} \\nu_{t} + \\beta_{t}) \\\\\n+ \\sum_{t=1}^{T} d_{t} (C_{d} + \\lambda_{t} + \\eta_{d}^{-1} \\nu_{t} + \\gamma_{t}) \\\\\n+ \\sum_{t=1}^{T-1} s_{t} (\\nu_{t} - \\nu_{t+1} + \\sigma_{t}) + s_{T}(\\nu_T + \\tau + \\sigma_T) \\\\\n+ \\text{terms not involving decision variables}\n$$\nThe dual problem is obtained by maximizing the dual function $q(\\lambda, \\dots, \\sigma) = \\inf_{g,c,d,s \\ge 0} \\mathcal{L}$. For this infimum to be bounded, the coefficients of the primal variables must be non-negative. This yields the dual constraints.\n\n**Dual Problem:**\nThe dual constraints are:\n1.  $C_{G} + \\lambda_{t} + \\alpha_{t} \\ge 0 \\quad \\forall t \\in \\{1, \\dots, T\\}$\n2.  $C_{c} - \\lambda_{t} - \\eta_{c} \\nu_{t} + \\beta_{t} \\ge 0 \\quad \\forall t \\in \\{1, \\dots, T\\}$\n3.  $C_{d} + \\lambda_{t} + \\eta_{d}^{-1} \\nu_{t} + \\gamma_{t} \\ge 0 \\quad \\forall t \\in \\{1, \\dots, T\\}$\n4.  $\\nu_{t} - \\nu_{t+1} + \\sigma_{t} \\ge 0 \\quad \\forall t \\in \\{1, \\dots, T-1\\}$\n5.  $\\nu_T + \\tau + \\sigma_T \\ge 0$\n6.  $\\alpha_t, \\beta_t, \\gamma_t, \\sigma_t \\ge 0 \\quad \\forall t \\in \\{1, \\dots, T\\}$\n\nThe dual objective is to maximize the remaining terms of $\\mathcal{L}$, which constitute the dual function $q$:\n$$\n\\max_{\\lambda, \\nu, \\tau, \\alpha, \\beta, \\gamma, \\sigma} \\left\\{ -\\sum_{t=1}^{T} \\lambda_{t} D_{t} - \\nu_{1}s_{0} - \\tau s_{0} - \\sum_{t=1}^{T} \\alpha_t y_G - \\sum_{t=1}^{T} \\beta_t y_P - \\sum_{t=1}^{T} \\gamma_t y_P - \\sum_{t=1}^{T} \\sigma_t y_E \\right\\}\n$$\nThis can be written as:\n$$\n\\max \\left\\{ -\\sum_{t=1}^{T} \\lambda_{t} D_{t} - (\\nu_{1} + \\tau)s_{0} - y_G \\sum_{t=1}^{T} \\alpha_t - y_P \\sum_{t=1}^{T} (\\beta_t + \\gamma_t) - y_E \\sum_{t=1}^{T} \\sigma_t \\right\\}\n$$\nsubject to the dual constraints derived above.\n\n### **Step 3: Benders Optimality Cut**\nBy strong duality for linear programming (since the primal is assumed to be feasible and bounded), the optimal value of the primal subproblem, $Q(y)$, is equal to the optimal value of its dual. Let an optimal solution to the dual problem be denoted by $(\\lambda^*, \\nu^*, \\tau^*, \\alpha^*, \\beta^*, \\gamma^*, \\sigma^*)$. Then:\n$$\nQ(y) = -\\sum_{t=1}^{T} \\lambda^*_{t} D_{t} - (\\nu^*_{1} + \\tau^*)s_{0} - y_G \\sum_{t=1}^{T} \\alpha^*_t - y_P \\sum_{t=1}^{T} (\\beta^*_t + \\gamma^*_t) - y_E \\sum_{t=1}^{T} \\sigma^*_t\n$$\nThe function $Q(y)$ is the value function of the subproblem. It is a convex function of $y$. In the context of Benders decomposition, the master problem minimizes investment costs plus an approximation of $Q(y)$. An optimality cut provides a linear lower bound on $Q(y)$. For a given investment point $\\bar{y}$, the cut is formed using the optimal dual variables from the subproblem solved at $\\bar{y}$.\n\nThe Benders optimality cut is a supporting hyperplane to the epigraph of $Q(y)$ at $\\bar{y}$. It is given by the inequality:\n$$\n\\theta \\ge Q(\\bar{y}) + (\\nabla_y Q(\\bar{y}))^T (y - \\bar{y})\n$$\nwhere $\\theta$ is the master problem variable representing the subproblem cost.\nThe gradient (or a subgradient if not unique) $\\nabla_y Q(y)$ can be found by applying sensitivity analysis (or Danskin's Theorem). The partial derivatives of the optimal value function $Q(y)$ with respect to the right-hand side parameters are given by the negative of the optimal dual variables of the corresponding constraints.\nIn our formulation, the constraints are of the form $g_t \\le y_G$. A more direct approach is to differentiate the dual objective value with respect to $y$, holding the optimal dual variables fixed at their values for $\\bar{y}$:\n$$\n\\frac{\\partial Q(y)}{\\partial y_E} = -\\sum_{t=1}^{T} \\sigma^*_t\n$$\n$$\n\\frac{\\partial Q(y)}{\\partial y_P} = -\\sum_{t=1}^{T} (\\beta^*_t + \\gamma^*_t)\n$$\n$$\n\\frac{\\partial Q(y)}{\\partial y_G} = -\\sum_{t=1}^{T} \\alpha^*_t\n$$\nThe Benders cut is typically written in the master problem as $\\theta + (\\text{coeffs})^T y \\ge \\text{const}$. The coefficient vector for $y = (y_E, y_P, y_G)$ in this form is $-\\nabla_y Q(\\bar{y})$.\nThe coefficient vector is therefore:\n$$\n\\begin{pmatrix} -\\frac{\\partial Q(\\bar{y})}{\\partial y_E} \\\\ -\\frac{\\partial Q(\\bar{y})}{\\partial y_P} \\\\ -\\frac{\\partial Q(\\bar{y})}{\\partial y_G} \\end{pmatrix} = \\begin{pmatrix} \\sum_{t=1}^{T} \\sigma^*_t \\\\ \\sum_{t=1}^{T} (\\beta^*_t + \\gamma^*_t) \\\\ \\sum_{t=1}^{T} \\alpha^*_t \\end{pmatrix}\n$$\nThe problem requests this coefficient vector with respect to $(y_E, y_P, y_G)$, written as a row vector. Omitting the asterisk superscript for notational simplicity as per convention in the final expression, the components are the sums of the optimal dual variables, representing the marginal value (shadow price) of each type of capacity.\n\n-   Coefficient for $y_E$ (in $\\$!/ \\mathrm{MWh}$): $\\sum_{t=1}^{T} \\sigma_t$\n-   Coefficient for $y_P$ (in $\\$!/ \\mathrm{MW}$): $\\sum_{t=1}^{T} (\\beta_t + \\gamma_t)$\n-   Coefficient for $y_G$ (in $\\$!/ \\mathrm{MW}$): $\\sum_{t=1}^{T} \\alpha_t$\n\nThe resulting coefficient row vector is $(\\sum_{t=1}^{T} \\sigma_t, \\sum_{t=1}^{T} (\\beta_t + \\gamma_t), \\sum_{t=1}^{T} \\alpha_t)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sum_{t=1}^{T} \\sigma_{t} & \\sum_{t=1}^{T} (\\beta_{t} + \\gamma_{t}) & \\sum_{t=1}^{T} \\alpha_{t}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}