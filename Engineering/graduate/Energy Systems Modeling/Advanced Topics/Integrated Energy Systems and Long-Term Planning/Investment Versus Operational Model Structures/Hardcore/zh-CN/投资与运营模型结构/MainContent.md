## 引言
能源系统的决策横跨从毫秒级的物理响应到数十年的基础设施规划，构成了一个巨大的建模挑战。为了应对这一挑战，分析师们发展出两种核心方法论：**投资模型**，用于回答“建设什么”的长期战略问题；以及**运行模型**，用于解决“如何调度”的短期战术问题。这种规划与运行的二分法是理解现代能源分析的基石，但其背后的理论权衡、简化偏差与实际应用往往错综复杂。本文旨在系统性地解构这一核心框架，填补理论与实践之间的认知鸿沟。

在接下来的章节中，我们将首先在**“原理与机制”**中深入剖析这两种模型的基本原理、数学结构和关键约束。随后，我们将在**“应用与跨学科连接”**中展示这些模型如何被用于评估技术价值、分析环境政策和量化系统可靠性。最后，通过**“动手实践”**中的一系列练习，您将有机会亲手构建和解决这些模型的核心部分，将理论知识转化为实践技能。让我们从这两种模型结构的根本分野开始。

## 原理与机制

在[能源系统建模](@entry_id:1124496)领域，决策问题横跨从瞬时物理响应到数十年基础设施规划的多个时间尺度。为了在计算上可行地应对这一挑战，建模实践中发展出了两种核心模型结构：**投资模型 (investment models)** 和 **运行模型 (operational models)**。这两种结构代表了能源系统分析中规划与运行的根本[二分法](@entry_id:140816)。本章旨在深入剖析这两种模型的内在原理、数学机制，以及它们之间复杂而关键的相互关系。

### 规划与运行的基本分野

能源系统决策的本质区别在于其时间范围和不可逆性。建设一座发电厂是持续数十年的资本投资，而决定其下一小时的发电量则是一个短期的、可逆的运行决策。这种时间尺度上的分离是区分投资模型和运行模型的根本原因。

#### 投资模型：容量扩张的艺术

**投资模型**，或称**长期规划模型 (long-term planning models)** 或**容量扩张模型 (capacity expansion models)**，其核心任务是回答“建设什么、在哪里建设、何时建设”的战略问题 。这类模型着眼于长达数十年的规划期，旨在确定一个能够以最低成本满足未来能源需求的最佳基础设施演进路径。

典型的投资模型具有以下特征：

*   **决策变量 (Decision Variables)**：核心决策变量是关于**资本存量 (capital stock)** 的。这包括每年或每个规划周期中，不同技术 $i$ 的新增装机容量 $I_{i,y}$ 或 $\text{build}_{i,y}$、退役容量 $R_{i,y}$，以及总可用容量 $K_{i,y}$。在一些高[空间分辨率](@entry_id:904633)的模型中，还可能包括二[进制](@entry_id:634389)的选址变量 。
*   **目标函数 (Objective Function)**：投资模型的经济目标是最小化整个规划期内系统总成本的**[净现值](@entry_id:140049) (Net Present Value, NPV)**。这个总成本包括了[前期](@entry_id:170157)**资本支出 (Capital Expenditure, CAPEX)** 和整个资产生命周期内预期的**运营支出 (Operating Expenditure, OPEX)**。一个典型的[目标函数](@entry_id:267263)形式如下 ：
    $$ \min \sum_{y \in Y} \frac{1}{(1+r)^{y}} \left( \sum_{i \in I} c^{\text{inv}}_{i,y} \cdot \text{build}_{i,y} + \mathbb{E}_{\omega}\left[\sum_{t \in T_{y}} \sum_{i \in I} c^{\text{var}}_{i,y,\omega} \cdot g_{i,t,y,\omega}\right] \right) $$
    其中，$y$ 是年份索引，$r$ 是[贴现率](@entry_id:145874)，$c^{\text{inv}}_{i,y}$ 是技术 $i$ 在年份 $y$ 的单位投资成本，$\mathbb{E}_{\omega}[\cdot]$ 表示对未来不确定性（如燃料价格、负荷，用 $\omega$ 表示）的期望，而 $c^{\text{var}}_{i,y,\omega}$ 和 $g_{i,t,y,\omega}$ 分别是运行成本和发电量。
*   **时间尺度与分辨率 (Time Horizon  Resolution)**：投资模型的时间尺度是数十年，以年为基本步长。由于在如此长的时间跨度内模拟每个小时的运行在计算上是不可行的，运行细节通常被高度简化。模型通常使用一组**代表性时段 (representative periods)**（例如，一个典型的冬季工作日、一个夏季周末）来近似全年的运行成本和可行性 。

#### 运行模型：[实时调度](@entry_id:754136)的科学

与投资模型相对，**运行模型**关注的是在给定现有基础设施的条件下，“如何最优地利用这些资产”来满足短期（从分钟到周）的能源需求 。这类模型是电网运营商日常工作的核心，主要包括**[机组组合](@entry_id:1133606) (Unit Commitment, UC)** 和**[经济调度](@entry_id:143387) (Economic Dispatch, ED)**。

典型的运行模型具有以下特征：

*   **决策变量**：核心决策变量是关于能源**流 (flow)** 的。这包括每个[发电机](@entry_id:268282)组 $g$ 在每个时刻 $t$ 的发电功率 $p_{g,t}$、机组的启停状态（一个二进制变量）$u_{g,t} \in \{0,1\}$、储能系统的充放电状态以及电网中的潮流。在运行模型中，装机容量 $K_g$ 是一个由先前投资决策决定的、固定的**外生参数 (exogenous parameter)**。
*   **[目标函数](@entry_id:267263)**：运行模型的目标是最小化短期内的总运行成本，主要包括燃料成本、变动运维成本以及机组启动和关停成本。由于时间范围很短（通常为一天或一周），[目标函数](@entry_id:267263)中通常不考虑[贴现](@entry_id:139170) 。一个简化的目标函数如下：
    $$ \min \sum_{t=1}^{T} \left( \sum_{g} c_{g}^{\text{var}} p_{g,t} + \sum_{g} c_{g}^{\text{start}} \Delta u_{g,t} \right) $$
    其中，$c_{g}^{\text{var}}$ 是可变成本，$c_{g}^{\text{start}}$ 是启动成本，$\Delta u_{g,t}$ 表示机组状态的变化。
*   **时间尺度与分辨率**：运行模型的时间尺度短，从一天到一周不等，但[时间分辨率](@entry_id:194281)非常高，通常是小时、半小时甚至分钟级别，以捕捉系统运行的动态变化和随机性。

### 核心约束与变量耦合

投资和运行模型并非孤立存在，它们通过一系列关键的物理和经济约束紧密耦合。理解这些耦合机制是理解整个[能源系统建模](@entry_id:1124496)框架的关键。

#### 容量与调度的核心链接

连接长期投资与短期运行的最基本、最核心的约束是[发电机](@entry_id:268282)组的出力限制。任何[发电机](@entry_id:268282)组的瞬时功率输出 $p_{i,t}$（单位：MW）都不能超过其可用的装机容量。这个看似简单的物理事实，在数学上表示为一个至关重要的不等式 ：
$$ p_{i,t} \le K_i \cdot a_{i,t} $$
这里，$K_i$ 是技术 $i$ 的**铭牌容量 (nameplate capacity)**，即其设计的[最大功](@entry_id:143924)率输出。$a_{i,t} \in [0,1]$ 是一个无量纲的**可用率因子 (availability factor)**，它代表在 $t$ 时刻由于外部（如风速、太阳辐照度）或内部（如计划内检修、强制停运）原因，铭牌容量中实际可用的部分。

这个约束的意义是双重的：
*   在**运行模型**中，$K_i$ 是一个已知的参数。该约束为决策变量 $p_{i,t}$ 设定了一个随时间变化的上限。
*   在**投资模型**中，$K_i$ 和 $p_{i,t}$（或其在代表性时段的代理变量）都是内生决策变量。这个约束建立起了投资决策（建设多少 $K_i$）和运行决策（如何使用它）之间的直接联系，确保了投资方案在物理上的可行性。

#### 运行非凸性：[机组组合问题](@entry_id:1133609)

[电力](@entry_id:264587)系统的运行充满了**非凸性 (non-convexities)**，这使得运行模型往往比投资模型更为复杂。最显著的非凸性来源于火电机组等传统[发电机](@entry_id:268282)不能像水龙头一样平滑地从零开始调节出力。它们具有[最小稳定出力](@entry_id:1127943)、启动成本以及最小运行/停机时间等物理限制。

为了在模型中捕捉这种离散的“开/关”特性，我们引入了二[进制](@entry_id:634389)**承诺变量 (commitment variable)** $u_{i,t} \in \{0,1\}$，其中 $u_{i,t}=1$ 表示机组 $i$ 在时段 $t$ 处于开启状态，而 $u_{i,t}=0$ 表示其处于关闭状态。这使得模型从一个[线性规划](@entry_id:138188) (LP) 问题转变为一个**[混合整数线性规划](@entry_id:1127955) (Mixed-Integer Linear Program, MILP)** 问题 。

引入 $u_{i,t}$ 后，一系列**[跨期约束](@entry_id:1126649) (inter-temporal constraints)** 变得至关重要，它们将不同时间点的决策联系起来。例如，**最小启[停时](@entry_id:261799)间 (minimum up/down times)** 约束确保了机组一旦开启（或关闭），就必须至少持续运行（或停运）一段特定的时间。一个有效的数学表达方式是 ：
$$ \sum_{\tau=t-M_i^{\mathrm{up}}+1}^{t} y_{i,\tau} \le u_{i,t} \quad \forall i,t $$
$$ \sum_{\tau=t-M_i^{\mathrm{down}}+1}^{t} z_{i,\tau} \le 1 - u_{i,t} \quad \forall i,t $$
其中，$y_{i,t}$ 和 $z_{i,t}$ 分别是表示机组在 $t$ 时刻启动和关闭的二进制变量，$M_i^{\mathrm{up}}$ 和 $M_i^{\mathrm{down}}$ 分别是最小运行和停机时间。第一个不等式表示，如果在过去的 $M_i^{\mathrm{up}}$ 时间内有过一次启动，那么当前时刻 $u_{i,t}$ 必须为1（即机组必须在线）。第二个不等式逻辑类似。这些约束是运行模型的核心特征，但在计算成本高昂的投资模型中常常被简化或忽略。

#### 综合模型：统一的视角

理论上，我们可以构建一个**综合模型 (integrated model)**，将投资和运行决策在一个统一的框架内共同优化。这样的模型在数学上结合了容量扩张和[机组组合](@entry_id:1133606)的特点，其决策变量同时包括了长期的 $K_i$ 和短期的 $u_{i,t}$、 $p_{i,t}$ 。

在这样的综合模型中，核心耦合约束变得更加明确。例如，发[电功率](@entry_id:273774)不仅受容量限制，还受启停状态的控制：
$$ p_{i,t} \le \alpha_{i,t} K_i u_{i,t} $$
此外，[最小稳定出力](@entry_id:1127943)约束可以表示为：
$$ p_{i,t} \ge \underline{\rho}_i K_i u_{i,t} $$
其中 $\underline{\rho}_i$ 是最小出力占铭牌容量的比例。这些约束清晰地展示了投资决策 ($K_i$) 如何通过与二进制运行变量 ($u_{i,t}$) 的乘积，直接影响和塑造了详细运行决策的[可行域](@entry_id:136622)。由于 $u_{i,t}$ 的存在，这类综合模型本质上是大型的MIL[P问题](@entry_id:267898)。

### 时间与不确定性的处理

投资模型与运行模型在结构上的根本差异，很大程度上源于它们[处理时间](@entry_id:196496)和不确定性的方式不同。

#### 时间尺度与聚合的必要性

一个跨越30年、具有小时分辨率的综合模型，其决策变量和约束的数量将达到天文数字。特别是，[二进制变量](@entry_id:162761)的数量将大致与机组数量 $U$ 和总小时数 $T$ 的乘积成正比，即 $\Theta(UT)$。由于求解MIL[P问题](@entry_id:267898)的计算复杂度在最坏情况下会随二进制变量的数量呈指数级增长，直接求解这样一个全景式模型在今天是不可行的 。

因此，投资模型必须对时间进行**聚合 (aggregation)**。然而，时间细节的丢失并非没有代价。[电力](@entry_id:264587)系统的经济性与可靠性高度依赖于负荷的瞬时变化。一个经典的例子是通过**负荷持续曲线 (Load Duration Curve, LDC)** 进行的技术筛选 。LDC将一年中所有小时的负荷从高到低排序，显示了不同负荷水平出现的时长。

考虑一个由高投资成本/低运行成本的**基荷 (baseload)** 技术（如核电）和低投资成本/高运行成本的**峰荷 (peaking)** 技术（如燃气轮机）组成的系统。哪种技术更经济，取决于它需要运行多长时间。存在一个盈亏平衡点，超过这个运行时长，基荷技术更优；低于这个时长，峰荷技术更优。LDC恰恰提供了这种运行模式的信息。如果一个模型仅使用年平均负荷，它将无法区分需要持续运行的基荷和仅在少数高峰时段运行的峰荷，从而导致错误的投资组合。更严重的是，如果系统容量仅按平均负荷来建设，将完全无法满足峰值负荷的需求，导致大规模停电 。

因此，投资模型中的[时间聚合](@entry_id:1132908)是一种在计算可行性与模型准确性之间的权衡。选择合适的代表性时段，既能捕捉到关键的运行模式（如季节性、日夜差异、极端事件），又能将计算负担控制在可接受范围内，是[能源系统建模](@entry_id:1124496)的一大核心挑战 [@problem_-id:4099416]。

#### 远见与不确定性的范式

未来是充满不确定性的，不同的模型结构体现了应对这种不确定性的不同哲学 。

*   **完全预见 (Perfect Foresight)**：这是许多经典容量扩张模型的标准假设。模型假设在决策之初（$t=0$）就已经完全、确定地知道了未来所有外生参数（如需求、燃料价格、技术成本）的演变路径 。在这种范式下，整个规划问题被表述为一个单一的、巨大的确定性优化问题，一次性求解出跨越整个规划期的最优投资和运行路径。

*   **带追索的[随机规划](@entry_id:168183) (Stochastic Programming with Recourse)**：这是一种更现实地处理不确定性的框架。它将决策过程分为多个阶段。以一个两阶段模型为例 ：
    1.  **第一阶段决策 (Here-and-Now)**：在不确定性揭晓之前做出的决策，如投资决策 $K$。这些决策必须是**非预期性的 (non-anticipative)**，即对于所有可能发生的未来场景 $\omega$，第一阶段决策必须是相同的。
    2.  **第二阶段决策 (Wait-and-See)**：在不确定性 $\omega$ 揭晓之后做出的**追索 (recourse)** 或适应性决策，如运行决策 $p_{i,t,\omega}$。这些决策是场景相关的，旨在以最低成本应对已知的具体情况。
    这种框架完美地映射了投资（第一阶段）与运行（第二阶段）的决策分离。规划者的目标是选择一个投资组合 $K$，使其资本成本加上所有未来场景下预期运行成本的总和最小。

*   **短视运行 (Myopic Operation)**：这代表一种完全不考虑未来的决策方式。在每个时间点，决策者仅基于当前信息，最小化当前时刻的成本，而忽略其决策对未来的影响。在存在[跨期约束](@entry_id:1126649)（如储能水位、[爬坡限制](@entry_id:1130533)）的系统中，短视决策通常是次优的，因为它忽略了未来状态的价值（即影子价格）。

### 模型分离的认知论：偏差与近似

既然出于计算可行性的考虑，我们必须将投资与运行模型分离或进行简化，那么这种分离和简化会对模型结果的可靠性产生什么影响？

#### 随机解的价值与[詹森不等式](@entry_id:144269)

在不确定性下，用平均值输入来替代[随机变量](@entry_id:195330)进行决策，通常会导致系统性的偏差。对于一个运行成本函数 $Q(K, \omega)$，如果它是关于不确定性 $\omega$（例如需求）的[凸函数](@entry_id:143075)，那么根据**[詹森不等式](@entry_id:144269) (Jensen's inequality)**，我们有：
$$ \mathbb{E}_{\omega}[Q(K, \omega)] \ge Q(K, \mathbb{E}_{\omega}[\omega]) $$
左边是真实期望运行成本，右边是基于平均需求计算出的运行成本。这个不等式意味着，使用平均值输入的确定性模型会系统性地**低估**真实的预期运行成本。这种低估会导致投资不足，因为它使得“推迟投资、依赖未来运行”看起来比实际上更便宜 。

#### [分离模型](@entry_id:201289)中的偏差来源

在实践中，投资模型中的简化会从多个方面引入偏差：

1.  **忽略运行细节**：当投资模型忽略或过度简化运行灵活性约束（如爬坡率、启[停时](@entry_id:261799)间）时，它会高估如核电、煤电等**不灵活资产 (inflexible assets)** 的价值，因为模型没有惩罚它们在应对负荷波动时的困难和成本。同时，它会低估如燃气轮机、电池储能等**灵活资产 (flexible assets)** 的价值，因为模型无法看到它们在提供快速响应和[辅助服务](@entry_id:1121004)时的关键作用。这最终会导致一个过于“僵化”和脆弱的投资组合 。

2.  **破坏时间连续性**：使用代表性时段的方法虽然必要，但它破坏了真实的时间序列。例如，一个代表性工作日的结束与下一个代表性周末的开始之间没有物理联系。这对于模拟具有跨天、跨周甚至跨季节能量转移能力的资产（如大规模储能、水电站）是一个巨大挑战。模型可能会因此低估对长周期灵活性的需求 。

3.  **忽略非[凸性](@entry_id:138568)**：将[机组组合问题](@entry_id:1133609)（一个MILP）松弛为一个[线性规划](@entry_id:138188)（LP）问题是投资模型中常见的简化手段。然而，这种**[凸松弛](@entry_id:636024) (convex relaxation)** 会导致模型可以在物理上不可能的区间内运行（例如，在[最小稳定出力](@entry_id:1127943)以下），从而得到一个过于乐观的成本估计。这同样会扭曲投资决策 。

综上所述，投资模型与运行模型的分离，是在追求运行真实性与保障计算可行性之间的一种必要妥协。对于模型使用者而言，关键在于深刻理解这些简化所带来的偏差，并根据具体的研究问题选择合适的模型结构和简化程度。从认知论的角度看，这意味着长期投资模型的输出不应被视为对未来的精确“预测”，而应被理解为在模型特定的结构性假设下，关于稳健能源转型路径的“洞见”。