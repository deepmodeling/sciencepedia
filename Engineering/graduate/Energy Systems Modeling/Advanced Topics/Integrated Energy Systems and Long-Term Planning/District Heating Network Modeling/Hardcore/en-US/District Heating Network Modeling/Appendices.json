{
    "hands_on_practices": [
        {
            "introduction": "Pumps are the prime movers in any district heating network, and their behavior is critical to system performance and control. To build predictive models, we must accurately represent how a pump's output head and flow rate respond to changes in operational speed. This practice delves into the fundamental scaling relationships, known as affinity laws, allowing you to derive them from first principles and apply them to scale a known pump performance curve, a core skill in hydraulic systems analysis .",
            "id": "4086272",
            "problem": "A centrifugal pump circulates water in the supply header of a district heating network. The pump impeller is geometrically similar across operating conditions, with fixed impeller diameter $D$. The fluid is water at approximately constant thermophysical properties, and the operating regime is fully turbulent such that viscous effects can be neglected in first approximation. Starting from first principles of turbomachinery and dimensional analysis (specifically the Euler turbomachinery equation and the Buckingham Pi theorem), derive and state the similarity (affinity) laws that relate the volumetric flow rate $Q$, the pump head $H$, and the shaft power $P$ to the rotational speed $n$ and the impeller diameter $D$ for geometrically similar pumps operating at dynamically similar points. Then, apply these laws to predict the head–flow characteristic at a new speed for the same impeller.\n\nAt an initial rotational speed $n_{1} = 1480$ revolutions per minute (denoted $\\mathrm{r/min}$), with constant impeller diameter $D = 0.30$ meters, the measured pump characteristic for water is \n$$\nH_{n_{1}}(q) = 32 - 8000\\,q^{2},\n$$\nwhere $H$ is the head in meters and $q$ is the volumetric flow rate in $\\mathrm{m^{3}\\!/s}$. Assuming the impeller diameter remains fixed and the flow condition remains dynamically similar across speeds, use the affinity laws you derived to obtain an explicit analytic expression for the head–flow characteristic $H_{n_{2}}(q)$ at a higher rotational speed $n_{2} = 1760$ $\\mathrm{r/min}$. Express the final head–flow function in meters as a function of $q$ in $\\mathrm{m^{3}\\!/s}$. No rounding is required; present the expression in exact form.",
            "solution": "The problem requires the derivation of the pump affinity laws from first principles and their subsequent application to determine a new head-flow characteristic curve for a centrifugal pump operating at a different rotational speed.\n\n### Derivation of the Affinity Laws\n\nThe affinity laws describe the relationships between pump performance variables ($Q, H, P$) and operating parameters ($n, D$) for dynamically similar conditions. Dynamic similarity implies that the flow patterns are geometrically similar, and thus dimensionless groups governing the flow are constant. We will use dimensional analysis via the Buckingham Pi theorem.\n\nThe relevant physical quantities are:\n- Volumetric flow rate $Q$ [Dimensions: $L^{3}T^{-1}$]\n- Head $H$ [Dimensions: $L$]. It is more fundamental to work with the energy supplied per unit mass, $gH$, where $g$ is the acceleration due to gravity. The dimensions of $gH$ are $(LT^{-2})(L) = L^{2}T^{-2}$.\n- Shaft power $P$ [Dimensions: $ML^{2}T^{-3}$]\n- Rotational speed $n$ [Dimensions: $T^{-1}$]\n- Impeller diameter $D$ [Dimensions: $L$]\n- Fluid density $\\rho$ [Dimensions: $ML^{-3}$]\n\nThe problem states to neglect viscous effects, so the fluid viscosity $\\mu$ is not included. We have $6$ variables and $3$ fundamental dimensions (Mass $M$, Length $L$, Time $T$). According to the Buckingham Pi theorem, there will be $6 - 3 = 3$ independent dimensionless groups (Pi groups).\n\nWe select $\\rho$, $n$, and $D$ as the repeating variables as they contain all fundamental dimensions.\n\n**Pi group for Flow Rate ($\\Pi_Q$):**\nWe seek a dimensionless group involving $Q$.\n$$ \\Pi_Q = Q^{1} \\rho^{a} n^{b} D^{c} $$\nIn terms of dimensions:\n$$ [\\Pi_Q] = (L^{3}T^{-1})^{1} (ML^{-3})^{a} (T^{-1})^{b} (L)^{c} = M^{0}L^{0}T^{0} $$\nEquating exponents for each dimension:\n- $M: a = 0$\n- $T: -1 - b = 0 \\implies b = -1$\n- $L: 3 - 3a + c = 0 \\implies 3 - 0 + c = 0 \\implies c = -3$\nThus, the flow coefficient is $\\Pi_Q = \\frac{Q}{n D^{3}}$.\n\n**Pi group for Head ($\\Pi_H$):**\nWe seek a dimensionless group involving $gH$.\n$$ \\Pi_H = (gH)^{1} \\rho^{a} n^{b} D^{c} $$\nIn terms of dimensions:\n$$ [\\Pi_H] = (L^{2}T^{-2})^{1} (ML^{-3})^{a} (T^{-1})^{b} (L)^{c} = M^{0}L^{0}T^{0} $$\nEquating exponents:\n- $M: a = 0$\n- $T: -2 - b = 0 \\implies b = -2$\n- $L: 2 - 3a + c = 0 \\implies 2 - 0 + c = 0 \\implies c = -2$\nThus, the head coefficient is $\\Pi_H = \\frac{gH}{n^{2}D^{2}}$. Since $g$ is constant, we can define a practical head coefficient as $\\frac{H}{n^{2}D^{2}}$.\n\n**Pi group for Power ($\\Pi_P$):**\nWe seek a dimensionless group involving $P$.\n$$ \\Pi_P = P^{1} \\rho^{a} n^{b} D^{c} $$\nIn terms of dimensions:\n$$ [\\Pi_P] = (ML^{2}T^{-3})^{1} (ML^{-3})^{a} (T^{-1})^{b} (L)^{c} = M^{0}L^{0}T^{0} $$\nEquating exponents:\n- $M: 1 + a = 0 \\implies a = -1$\n- $T: -3 - b = 0 \\implies b = -3$\n- $L: 2 - 3a + c = 0 \\implies 2 - 3(-1) + c = 0 \\implies 5 + c = 0 \\implies c = -5$\nThus, the power coefficient is $\\Pi_P = \\frac{P}{\\rho n^{3}D^{5}}$.\n\nFor two dynamically similar operating points, (1) and (2), these dimensionless groups must be equal.\n$$ \\frac{Q_1}{n_1 D_1^3} = \\frac{Q_2}{n_2 D_2^3} $$\n$$ \\frac{H_1}{n_1^2 D_1^2} = \\frac{H_2}{n_2^2 D_2^2} $$\n$$ \\frac{P_1}{\\rho_1 n_1^3 D_1^5} = \\frac{P_2}{\\rho_2 n_2^3 D_2^5} $$\nThese equalities yield the general affinity laws:\n1.  **Flow Rate:** $\\frac{Q_2}{Q_1} = \\left(\\frac{n_2}{n_1}\\right) \\left(\\frac{D_2}{D_1}\\right)^3$\n2.  **Head:** $\\frac{H_2}{H_1} = \\left(\\frac{n_2}{n_1}\\right)^2 \\left(\\frac{D_2}{D_1}\\right)^2$\n3.  **Power:** $\\frac{P_2}{P_1} = \\left(\\frac{\\rho_2}{\\rho_1}\\right) \\left(\\frac{n_2}{n_1}\\right)^3 \\left(\\frac{D_2}{D_1}\\right)^5$\n\nThese results can be confirmed from the Euler turbomachinery equation, which states that the ideal head is proportional to the square of the impeller tip speed ($U \\propto nD$). Thus, $H \\propto (nD)^2$. The flow rate is the product of a velocity component ($v \\propto nD$) and a flow area ($A \\propto D^2$), so $Q \\propto nD^3$. Power is proportional to $\\rho Q H$, so $P \\propto \\rho (nD^3)(nD)^2 = \\rho n^3 D^5$.\n\nIn this problem, the impeller diameter $D$ is fixed ($D_1=D_2$), and the fluid is water at constant properties ($\\rho_1 = \\rho_2$). The affinity laws simplify to:\n1.  $\\frac{Q_2}{Q_1} = \\frac{n_2}{n_1}$\n2.  $\\frac{H_2}{H_1} = \\left(\\frac{n_2}{n_1}\\right)^2$\n3.  $\\frac{P_2}{P_1} = \\left(\\frac{n_2}{n_1}\\right)^3$\n\n### Application to the Pump Characteristic\n\nWe are given the initial pump characteristic at speed $n_1$:\n$$ H_1 = H_{n_1}(q_1) = 32 - 8000 q_1^{2} $$\nHere, $(q_1, H_1)$ represents any point on the characteristic curve at speed $n_1$.\n\nWe want to find the new characteristic $H_2 = H_{n_2}(q_2)$ at speed $n_2$. For any point $(q_1, H_1)$ on the first curve, there is a corresponding dynamically similar point $(q_2, H_2)$ on the second curve, related by the affinity laws.\n\nFrom the affinity laws with constant diameter:\n$$ q_2 = q_1 \\left(\\frac{n_2}{n_1}\\right) \\implies q_1 = q_2 \\left(\\frac{n_1}{n_2}\\right) $$\n$$ H_2 = H_1 \\left(\\frac{n_2}{n_1}\\right)^2 $$\n\nWe can express $H_2$ as a function of $q_2$ by substitution. First, substitute the initial characteristic into the equation for $H_2$:\n$$ H_2 = \\left( 32 - 8000 q_1^{2} \\right) \\left(\\frac{n_2}{n_1}\\right)^2 $$\nNext, substitute the expression for $q_1$ in terms of $q_2$:\n$$ H_2 = \\left( 32 - 8000 \\left[q_2 \\left(\\frac{n_1}{n_2}\\right)\\right]^{2} \\right) \\left(\\frac{n_2}{n_1}\\right)^2 $$\nDistributing the factor $\\left(\\frac{n_2}{n_1}\\right)^2$ into the parentheses:\n$$ H_2 = 32 \\left(\\frac{n_2}{n_1}\\right)^2 - 8000 q_2^{2} \\left(\\frac{n_1}{n_2}\\right)^2 \\left(\\frac{n_2}{n_1}\\right)^2 $$\nThe speed ratios in the second term cancel out:\n$$ H_2 = 32 \\left(\\frac{n_2}{n_1}\\right)^2 - 8000 q_2^{2} $$\nThis expression gives the new head $H_2$ as a function of the new flow rate $q_2$. We can write this as the new characteristic function $H_{n_2}(q)$:\n$$ H_{n_2}(q) = 32 \\left(\\frac{n_2}{n_1}\\right)^2 - 8000 q^{2} $$\n\nNow, we substitute the given numerical values for the speeds:\n$n_1 = 1480 \\, \\mathrm{r/min}$\n$n_2 = 1760 \\, \\mathrm{r/min}$\n\nThe ratio of the speeds is:\n$$ \\frac{n_2}{n_1} = \\frac{1760}{1480} = \\frac{176}{148} = \\frac{44 \\times 4}{37 \\times 4} = \\frac{44}{37} $$\nThe square of this ratio is:\n$$ \\left(\\frac{n_2}{n_1}\\right)^2 = \\left(\\frac{44}{37}\\right)^2 = \\frac{44^2}{37^2} = \\frac{1936}{1369} $$\nNow we calculate the new shut-off head (the constant term):\n$$ 32 \\times \\frac{1936}{1369} = \\frac{61952}{1369} $$\nSubstituting this value back into the function for $H_{n_2}(q)$:\n$$ H_{n_2}(q) = \\frac{61952}{1369} - 8000 q^{2} $$\nThis is the explicit analytic expression for the head-flow characteristic at the new rotational speed $n_2 = 1760 \\, \\mathrm{r/min}$, with head $H$ in meters and flow rate $q$ in $\\mathrm{m^3/s}$.",
            "answer": "$$ \\boxed{\\frac{61952}{1369} - 8000 q^{2}} $$"
        },
        {
            "introduction": "Accurate energy accounting is the foundation of thermal network modeling. While often treated as constant for simplicity, the specific heat capacity of water, $c_{p}$, actually varies with temperature. This exercise challenges you to quantify the modeling error introduced by this common simplification, providing a practical lesson in assessing the trade-off between model fidelity and computational complexity .",
            "id": "4086240",
            "problem": "A District Heating Network (DHN) transports thermal energy using liquid water between a supply node at elevated temperature and a return node at a lower temperature. Consider a single pipe segment operating at steady state with negligible changes in kinetic energy and potential energy, and with sufficiently small pressure variations that the liquid water can be treated as incompressible. Let the water supply temperature be $T_{\\mathrm{s}} = 363.15\\,\\mathrm{K}$ and the return temperature be $T_{\\mathrm{r}} = 323.15\\,\\mathrm{K}$, so that the water cools by $40\\,\\mathrm{K}$ along the segment. In the temperature interval $[323.15\\,\\mathrm{K},\\,363.15\\,\\mathrm{K}]$, assume the temperature-dependent specific heat capacity at constant pressure is \n$$\nc_{p}(T) = 4182 + 0.85\\,(T - 323.15)\\quad\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1},\n$$\nwith $T$ expressed in $\\mathrm{K}$.\n\nStarting from first principles for steady-flow energy transport and the definition of specific enthalpy $h(T)$ for a liquid, derive the exact specific heat delivered per unit mass over the segment as the integral of $c_{p}(T)$ from $T_{\\mathrm{r}}$ to $T_{\\mathrm{s}}$. Then, assess the modeling impact of assuming a constant specific heat equal to its value at $T_{\\mathrm{ref}} = 333.15\\,\\mathrm{K}$, by computing the signed relative error defined as \n$$\n\\varepsilon = \\frac{q_{\\text{const}} - q_{\\text{exact}}}{q_{\\text{exact}}},\n$$\nwhere $q_{\\text{exact}}$ is the exact specific heat delivered per unit mass and $q_{\\text{const}}$ is the value obtained when $c_{p}$ is held constant at $c_{p}(T_{\\mathrm{ref}})$ over the entire $40\\,\\mathrm{K}$ interval.\n\nExpress the final answer for $\\varepsilon$ as a unitless decimal fraction. Round your final answer to four significant figures.",
            "solution": "The problem requires the calculation of the relative error incurred by approximating the temperature-dependent specific heat capacity of water with a constant value in the context of a district heating network pipe segment.\n\nFirst, we establish the thermodynamic framework. The first law of thermodynamics for a steady-flow open system, also known as the Steady-Flow Energy Equation (SFEE), states that the net energy transfer into a control volume is zero. Per unit mass flowing through the system, this is expressed as:\n$$\nq - w = \\Delta h + \\Delta e_k + \\Delta e_p\n$$\nwhere $q$ is the heat transferred into the system per unit mass, $w$ is the work done by the system per unit mass, $\\Delta h$ is the change in specific enthalpy, $\\Delta e_k$ is the change in specific kinetic energy, and $\\Delta e_p$ is the change in specific potential energy between the outlet and inlet.\n\nThe problem specifies the following assumptions for the pipe segment:\n- Steady state operation.\n- Negligible changes in kinetic energy ($\\Delta e_k \\approx 0$).\n- Negligible changes in potential energy ($\\Delta e_p \\approx 0$).\n- No work is done ($w=0$), as a pipe is a passive component.\n\nUnder these assumptions, the SFEE simplifies to $q = \\Delta h$. The heat transferred *from* the water to the surroundings, which we denote as the specific heat delivered $q_{\\text{delivered}}$, is the negative of the heat transferred *into* the water. Therefore,\n$$\nq_{\\text{delivered}} = -q = -\\Delta h = -(h_{\\text{out}} - h_{\\text{in}}) = h_{\\text{in}} - h_{\\text{out}}\n$$\nThe water enters at the supply temperature $T_{\\mathrm{s}}$ and leaves at the return temperature $T_{\\mathrm{r}}$. Thus, $h_{\\text{in}} = h(T_{\\mathrm{s}})$ and $h_{\\text{out}} = h(T_{\\mathrm{r}})$. The specific heat delivered is:\n$$\nq_{\\text{delivered}} = h(T_{\\mathrm{s}}) - h(T_{\\mathrm{r}})\n$$\nFor an incompressible liquid, the differential change in specific enthalpy $dh$ is given by $dh = c_p(T) dT$, where $c_p(T)$ is the specific heat capacity at constant pressure and $T$ is the absolute temperature. The total change in specific enthalpy from state $A$ to state $B$ is the integral of this expression:\n$$\nh(T_B) - h(T_A) = \\int_{T_A}^{T_B} c_p(T) dT\n$$\nCombining these principles, the exact specific heat delivered per unit mass, $q_{\\text{exact}}$, is found by integrating $c_p(T)$ from the return temperature $T_{\\mathrm{r}}$ to the supply temperature $T_{\\mathrm{s}}$:\n$$\nq_{\\text{exact}} = h(T_{\\mathrm{s}}) - h(T_{\\mathrm{r}}) = \\int_{T_{\\mathrm{r}}}^{T_{\\mathrm{s}}} c_p(T) dT\n$$\nThe problem provides the temperature-dependent specific heat capacity as:\n$$\nc_p(T) = 4182 + 0.85(T - 323.15) \\quad [\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}]\n$$\nwith $T_{\\mathrm{s}} = 363.15\\,\\mathrm{K}$ and $T_{\\mathrm{r}} = 323.15\\,\\mathrm{K}$. We can now compute the integral for $q_{\\text{exact}}$:\n$$\nq_{\\text{exact}} = \\int_{323.15}^{363.15} \\left[ 4182 + 0.85(T - 323.15) \\right] dT\n$$\nTo simplify the integration, let's perform a change of variables. Let $U = T - 323.15$. Then $dU = dT$. The integration limits become:\n- When $T = 323.15\\,\\mathrm{K}$, $U = 0\\,\\mathrm{K}$.\n- When $T = 363.15\\,\\mathrm{K}$, $U = 40\\,\\mathrm{K}$.\n\nThe integral becomes:\n$$\nq_{\\text{exact}} = \\int_{0}^{40} (4182 + 0.85 U) dU\n$$\n$$\nq_{\\text{exact}} = \\left[ 4182 U + 0.85 \\frac{U^2}{2} \\right]_{0}^{40}\n$$\n$$\nq_{\\text{exact}} = \\left( 4182 \\times 40 + \\frac{0.85}{2} \\times 40^2 \\right) - 0\n$$\n$$\nq_{\\text{exact}} = 167280 + 0.425 \\times 1600 = 167280 + 680 = 167960\\,\\text{J}\\,\\text{kg}^{-1}\n$$\nNext, we compute the approximate specific heat delivered, $q_{\\text{const}}$, by assuming a constant specific heat capacity $c_p$ evaluated at the reference temperature $T_{\\mathrm{ref}} = 333.15\\,\\mathrm{K}$.\nFirst, we find the value of this constant specific heat, $c_{p, \\text{const}}$:\n$$\nc_{p, \\text{const}} = c_p(333.15) = 4182 + 0.85(333.15 - 323.15)\n$$\n$$\nc_{p, \\text{const}} = 4182 + 0.85(10) = 4182 + 8.5 = 4190.5\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}\n$$\nWith a constant specific heat, the heat delivered is simply $q = c_p \\Delta T$:\n$$\nq_{\\text{const}} = c_{p, \\text{const}} \\times (T_{\\mathrm{s}} - T_{\\mathrm{r}})\n$$\n$$\nq_{\\text{const}} = 4190.5 \\times (363.15 - 323.15) = 4190.5 \\times 40 = 167620\\,\\text{J}\\,\\text{kg}^{-1}\n$$\nFinally, we compute the signed relative error, $\\varepsilon$, using the provided definition:\n$$\n\\varepsilon = \\frac{q_{\\text{const}} - q_{\\text{exact}}}{q_{\\text{exact}}}\n$$\n$$\n\\varepsilon = \\frac{167620 - 167960}{167960} = \\frac{-340}{167960}\n$$\nCalculating the numerical value:\n$$\n\\varepsilon \\approx -0.00202429149...\n$$\nThe problem asks for the answer to be rounded to four significant figures.\n$$\n\\varepsilon \\approx -0.002024\n$$\nThis negative error indicates that using a constant specific heat evaluated at $T_{\\mathrm{ref}} = 333.15\\,\\mathrm{K}$ results in an underestimation of the total heat delivered compared to the exact calculation that accounts for the temperature dependency.",
            "answer": "$$\n\\boxed{-0.002024}\n$$"
        },
        {
            "introduction": "Bringing together fluid motion and thermodynamics, the final step is to simulate the dynamic evolution of temperature within the pipe network. This practice introduces the finite volume method to solve the partial differential equation governing heat advection and loss. By constructing a discrete update law, you will create the core computational element for a dynamic simulation of a district heating pipe, a fundamental building block for any large-scale network model .",
            "id": "4086279",
            "problem": "Consider a single straight pipe segment in a district heating network with constant cross-sectional area and uniform, incompressible flow. Assume one-dimensional plug flow, constant fluid properties, and heat loss to the surroundings modeled by Newton’s law of cooling. Let $x \\in [0,L]$ denote position along the pipe, $t \\ge 0$ denote time, $T(x,t)$ the bulk fluid temperature in kelvin, $u$ the constant axial velocity in meters per second, $\\rho$ the fluid density in kilograms per cubic meter, $c$ the specific heat capacity in joules per kilogram-kelvin, $A$ the pipe cross-sectional area in square meters, $P$ the pipe wetted perimeter in meters, $h$ the convective heat transfer coefficient in watts per square meter-kelvin, and $T_g$ the ambient ground temperature in kelvin. The fundamental starting point is the conservation of energy for a differential control volume of length $\\mathrm{d}x$, combined with Newton’s law of cooling for the wall heat loss.\n\nUsing these bases, the governing equation can be written in a normalized form by dividing the energy balance by $\\rho c A$, to obtain\n$$\n\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = -\\alpha \\left(T - T_g\\right),\n$$\nwhere $\\alpha = \\frac{h P}{\\rho c A}$ has units of inverse seconds.\n\nYour tasks are:\n1. Starting from the conservation of energy and Newton’s law of cooling, derive a first-order upwind finite volume spatial discretization on a uniform grid with $N$ control volumes of width $\\Delta x = L/N$, with cell centers indexed by $i = 0,1,\\dots,N-1$ and cell faces indexed by $i+\\tfrac{1}{2}$. Use an explicit forward Euler time integration with time step $\\Delta t$. Carefully construct the advective face fluxes using an upwind choice consistent with the sign of $u$, and include the volumetric loss term.\n2. Write the resulting discrete update law for the cell-averaged temperature $T_i^n \\approx T(x_i, t^n)$ advancing from time level $n$ to $n+1$.\n3. Implement the one-step update (advance from $t^n$ to $t^{n+1}=t^n+\\Delta t$) for the following test suite. In each case, use the appropriate inflow Dirichlet boundary at the domain inflow (at $x=0$ if $u0$, or at $x=L$ if $u0$), and model the boundary face fluxes consistently with the upwind rule. All temperatures must be in kelvin. All velocities must be in meters per second. All lengths must be in meters. All times must be in seconds. The loss coefficient must be in inverse seconds. Report answers rounded to six decimal places.\n\nDefine the uniform grid with cell centers $x_i = \\left(i+\\tfrac{1}{2}\\right)\\Delta x$ for $i=0,\\dots,N-1$. For each case, initialize $T_i^n$ as specified, apply one time step, and return the updated temperature at the specified probe index (zero-based).\n\nTest suite:\n- Case A (happy path, positive velocity, moderate loss): $L = 100\\,\\mathrm{m}$, $N = 10$, $\\Delta t = 1\\,\\mathrm{s}$, $u = 0.5\\,\\mathrm{m/s}$, $\\alpha = 0.01\\,\\mathrm{s^{-1}}$, $T_g = 285\\,\\mathrm{K}$, inflow temperature at $x=0$: $T_{\\mathrm{in}} = 350\\,\\mathrm{K}$. Initial condition: $T_i^n = 330\\,\\mathrm{K}$ for all $i$. Probe index: $i=3$.\n- Case B (boundary condition with zero advection, pure loss): $L = 50\\,\\mathrm{m}$, $N = 5$, $\\Delta t = 10\\,\\mathrm{s}$, $u = 0.0\\,\\mathrm{m/s}$, $\\alpha = 0.05\\,\\mathrm{s^{-1}}$, $T_g = 280\\,\\mathrm{K}$. Inflow temperature is irrelevant because $u=0$. Initial condition: $T_i^n = 320\\,\\mathrm{K}$ for all $i$. Probe index: $i=2$.\n- Case C (edge case, negative velocity, inflow at right boundary): $L = 80\\,\\mathrm{m}$, $N = 8$, $\\Delta t = 2\\,\\mathrm{s}$, $u = -0.3\\,\\mathrm{m/s}$, $\\alpha = 0.02\\,\\mathrm{s^{-1}}$, $T_g = 285\\,\\mathrm{K}$, inflow temperature at $x=L$: $T_{\\mathrm{R}} = 340\\,\\mathrm{K}$. Initial condition: $T_i^n = 330\\,\\mathrm{K}$ for all $i$. Probe index: $i=7$.\n- Case D (pure advection, zero loss, nonuniform initial profile): $L = 100\\,\\mathrm{m}$, $N = 10$, $\\Delta t = 5\\,\\mathrm{s}$, $u = 1.0\\,\\mathrm{m/s}$, $\\alpha = 0.0\\,\\mathrm{s^{-1}}$, $T_g$ arbitrary (unused when $\\alpha=0$), inflow temperature at $x=0$: $T_{\\mathrm{in}} = 300\\,\\mathrm{K}$. Initial condition: $T_i^n = 300 + s x_i\\,\\mathrm{K}$ with slope $s = 0.2\\,\\mathrm{K/m}$. Probe index: $i=1$.\n- Case E (Courant–Friedrichs–Lewy (CFL) boundary case with $\\Delta t = \\Delta x/|u|$): $L = 80\\,\\mathrm{m}$, $N = 4$, $\\Delta t = 5\\,\\mathrm{s}$, $u = 4.0\\,\\mathrm{m/s}$, $\\alpha = 0.01\\,\\mathrm{s^{-1}}$, $T_g = 290\\,\\mathrm{K}$, inflow temperature at $x=0$: $T_{\\mathrm{in}} = 310\\,\\mathrm{K}$. Initial condition: $T_i^n = 305\\,\\mathrm{K}$ for all $i$. Probe index: $i=2$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_A,r_B,r_C,r_D,r_E]$), where each $r_\\cdot$ is the updated temperature at the specified probe index for the corresponding case, rounded to six decimal places.",
            "solution": "The problem asks for the derivation and application of a first-order upwind finite volume method with an explicit forward Euler time integration for the one-dimensional advection-reaction equation governing temperature in a pipe:\n$$\n\\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} = -\\alpha \\left(T - T_g\\right) \\quad \\text{for } x \\in [0,L], t \\ge 0\n$$\n\n### Finite Volume Discretization\n\nWe begin by applying the principle of conservation of energy to a finite control volume (CV). The domain $[0, L]$ is divided into $N$ uniform control volumes, $V_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$ for $i=0, \\dots, N-1$. Each CV has a width $\\Delta x = L/N$ and is centered at $x_i = (i+\\frac{1}{2})\\Delta x$.\n\nThe energy balance for the fluid within control volume $V_i$ states that the rate of change of thermal energy is equal to the net rate of energy advected into the volume minus the rate of heat loss to the surroundings.\n\n1.  **Rate of change of energy**: The thermal energy in the control volume is $E_i = (\\rho A \\Delta x) c T_i$, where $T_i$ is the average temperature in the volume. The rate of change is $\\frac{\\mathrm{d}E_i}{\\mathrm{d}t} = \\rho c A \\Delta x \\frac{\\mathrm{d}T_i}{\\mathrm{d}t}$.\n\n2.  **Net advected energy**: Energy is carried by the fluid flow. The rate of energy advection across a face is $\\dot{m} c T = (\\rho u A) c T$. The net rate of energy entering the CV is the flux in at face $i-\\frac{1}{2}$ minus the flux out at face $i+\\frac{1}{2}$:\n    $$ \\dot{E}_{\\text{adv, net}} = (\\rho u A c T)_{i-\\frac{1}{2}} - (\\rho u A c T)_{i+\\frac{1}{2}} $$\n\n3.  **Heat loss**: Heat is lost to the ambient ground via convection, governed by Newton's law of cooling. The heat loss rate from the surface area of the pipe segment corresponding to the CV ($P \\Delta x$) is:\n    $$ \\dot{Q}_{\\text{loss}} = h (P \\Delta x) (T_i - T_g) $$\n\nThe energy balance is:\n$$ \\rho c A \\Delta x \\frac{\\mathrm{d}T_i}{\\mathrm{d}t} = (\\rho u A c T)_{i-\\frac{1}{2}} - (\\rho u A c T)_{i+\\frac{1}{2}} - h P \\Delta x(T_i - T_g) $$\n\nDividing the entire equation by the constant term $\\rho c A \\Delta x$ yields the semi-discrete equation for the cell-averaged temperature $T_i$:\n$$ \\frac{\\mathrm{d}T_i}{\\mathrm{d}t} = \\frac{u}{\\Delta x}(T_{i-\\frac{1}{2}} - T_{i+\\frac{1}{2}}) - \\frac{h P}{\\rho c A}(T_i - T_g) $$\nLet's define the advective flux as $F(T) = uT$ and the heat loss coefficient $\\alpha = \\frac{hP}{\\rho c A}$. The equation becomes:\n$$ \\frac{\\mathrm{d}T_i}{\\mathrm{d}t} = -\\frac{1}{\\Delta x} \\left( F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}} \\right) - \\alpha(T_i - T_g) $$\nwhere $F_{i\\pm\\frac{1}{2}}$ are the fluxes at the cell faces.\n\nFor a first-order upwind scheme, the temperature at a cell face is taken from the cell center on the \"upwind\" side (the direction from which the flow is coming).\n\n-   If $u > 0$ (flow is from left to right):\n    -   $T_{i+\\frac{1}{2}} = T_i$\n    -   $T_{i-\\frac{1}{2}} = T_{i-1}$\n-   If $u  0$ (flow is from right to left):\n    -   $T_{i+\\frac{1}{2}} = T_{i+1}$\n    -   $T_{i-\\frac{1}{2}} = T_i$\n-   If $u = 0$, both fluxes are zero.\n\n### Explicit Euler Time Integration and Final Discrete Law\n\nWe use the explicit forward Euler method to discretize the time derivative, $\\frac{\\mathrm{d}T_i}{\\mathrm{d}t} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}$. All terms on the right-hand side are evaluated at the known time level $n$.\n$$ \\frac{T_i^{n+1} - T_i^n}{\\Delta t} = -\\frac{1}{\\Delta x} \\left( F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n \\right) - \\alpha(T_i^n - T_g) $$\nRearranging for $T_i^{n+1}$ gives the general update law:\n$$ T_i^{n+1} = T_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n \\right) - \\Delta t \\alpha(T_i^n - T_g) $$\n\nWe now write the specific forms based on the sign of $u$ and boundary conditions.\n\n**Case 1: $u > 0$** (Inflow at $x=0$ with temperature $T_{\\mathrm{in}}$)\n-   For an interior cell $i \\in \\{1, \\dots, N-1\\}$: $F_{i+\\frac{1}{2}}^n = u T_i^n$ and $F_{i-\\frac{1}{2}}^n = u T_{i-1}^n$.\n    $$ T_i^{n+1} = T_i^n - \\frac{u \\Delta t}{\\Delta x} (T_i^n - T_{i-1}^n) - \\Delta t \\alpha (T_i^n - T_g) $$\n-   For the first cell $i=0$: The left face is the domain boundary. The upwind value for $T_{-\\frac{1}{2}}$ is the inflow boundary condition, $T_{\\mathrm{in}}$. So, $F_{-\\frac{1}{2}}^n = u T_{\\mathrm{in}}$. The right flux is $F_{\\frac{1}{2}}^n = u T_0^n$.\n    $$ T_0^{n+1} = T_0^n - \\frac{u \\Delta t}{\\Delta x} (T_0^n - T_{\\mathrm{in}}) - \\Delta t \\alpha (T_0^n - T_g) $$\n\n**Case 2: $u  0$** (Inflow at $x=L$ with temperature $T_R$)\n-   For an interior cell $i \\in \\{0, \\dots, N-2\\}$: $F_{i+\\frac{1}{2}}^n = u T_{i+1}^n$ and $F_{i-\\frac{1}{2}}^n = u T_i^n$.\n    $$ T_i^{n+1} = T_i^n - \\frac{u \\Delta t}{\\Delta x} (T_{i+1}^n - T_i^n) - \\Delta t \\alpha (T_i^n - T_g) $$\n-   For the last cell $i=N-1$: The right face is the domain boundary. The upwind value for $T_{N-\\frac{1}{2}}$ is the inflow boundary condition, $T_R$. So, $F_{N-\\frac{1}{2}}^n = u T_R$. The left flux is $F_{N-\\frac{3}{2}}^n = u T_{N-1}^n$.\n    $$ T_{N-1}^{n+1} = T_{N-1}^n - \\frac{u \\Delta t}{\\Delta x} (T_R - T_{N-1}^n) - \\Delta t \\alpha (T_{N-1}^n - T_g) $$\n\n**Case 3: $u = 0$** (Pure heat loss)\n-   For all cells $i \\in \\{0, \\dots, N-1\\}$: The advective fluxes are zero.\n    $$ T_i^{n+1} = T_i^n - \\Delta t \\alpha (T_i^n - T_g) $$\n\n### Application to Test Suite\n\nThese discrete equations are now applied to each test case for a single time step.\n\n-   **Case A:** $u=0.5 > 0$, probe $i=3$. Initial $T_i^n$ is uniform.\n    $T_3^{n+1} = T_3^n - \\frac{0.5 \\cdot 1}{10}(T_3^n - T_2^n) - (1 \\cdot 0.01)(T_3^n - T_g) = 330 - 0.05(330-330) - 0.01(330-285) = 330 - 0.45 = 329.55$.\n\n-   **Case B:** $u=0.0$, probe $i=2$.\n    $T_2^{n+1} = T_2^n - (10 \\cdot 0.05)(T_2^n - T_g) = 320 - 0.5(320-280) = 320 - 20 = 300.0$.\n\n-   **Case C:** $u=-0.3  0$, probe $i=7=N-1$.\n    $T_7^{n+1} = T_7^n - \\frac{-0.3 \\cdot 2}{10}(T_R - T_7^n) - (2 \\cdot 0.02)(T_7^n - T_g) = 330 + 0.06(340-330) - 0.04(330-285) = 330 + 0.6 - 1.8 = 328.8$.\n\n-   **Case D:** $u=1.0 > 0$, $\\alpha=0.0$, probe $i=1$. $\\Delta x = 10$. Initial $T_i^n = 300 + 0.2 x_i = 300 + 0.2(i+0.5)10 = 301 + 2i$.\n    $T_0^n = 301, T_1^n = 303$.\n    $T_1^{n+1} = T_1^n - \\frac{1.0 \\cdot 5}{10}(T_1^n - T_0^n) - 0 = 303 - 0.5(303-301) = 303 - 1 = 302.0$.\n\n-   **Case E:** $u=4.0 > 0$, probe $i=2$. Initial $T_i^n$ is uniform. The Courant number $\\frac{|u|\\Delta t}{\\Delta x} = \\frac{4 \\cdot 5}{20}=1$.\n    $T_2^{n+1} = T_2^n - \\frac{4.0 \\cdot 5}{20}(T_2^n - T_1^n) - (5 \\cdot 0.01)(T_2^n - T_g) = 305 - 1(305-305) - 0.05(305-290) = 305 - 0.75 = 304.25$.",
            "answer": "[329.550000,300.000000,328.800000,302.000000,304.250000]"
        }
    ]
}