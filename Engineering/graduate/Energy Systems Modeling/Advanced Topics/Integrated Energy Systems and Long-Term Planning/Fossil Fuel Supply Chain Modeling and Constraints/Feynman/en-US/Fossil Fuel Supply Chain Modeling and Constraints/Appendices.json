{
    "hands_on_practices": [
        {
            "introduction": "Effective supply chain models are built upon a foundation of well-formulated constraints. This exercise takes you back to first principles, demonstrating how a fundamental physical law—conservation of mass—is translated into a linear inequality suitable for optimization models. By deriving the blending constraint for a product quality specification, you will practice a core skill in process modeling and gain a deeper understanding of how these common constraints function. ",
            "id": "4091811",
            "problem": "A pipeline blending terminal receives $n$ incoming fossil fuel streams (for example, crude oils) indexed by $i \\in \\{1, \\dots, n\\}$. Each stream $i$ is characterized by a mass $m_i \\ge 0$ (over a specified planning horizon) and a property mass fraction $q_i \\in [0,1]$ for a contaminant that mixes linearly by mass (for example, sulfur). The outgoing blended stream must satisfy a maximum property specification $Q^{\\mathrm{spec}} \\in [0,1]$ on the mass fraction of the contaminant.\n\nStarting only from the principles of conservation of mass and the fact that additive properties mix linearly by mass, derive a linear inequality in the decision variables $m_i$ that enforces the requirement that the blended outgoing mass fraction of the contaminant does not exceed $Q^{\\mathrm{spec}}$. Then, define the left-hand side function $L(m_1,\\dots,m_n)$ of this inequality so that the constraint can be written in the canonical linear form $L(m_1,\\dots,m_n) \\le 0$ for use in a linear program or mixed-integer linear program. Your final answer must be the closed-form analytic expression of $L(m_1,\\dots,m_n)$. No numerical evaluation is required, and no inequality or equality symbol should appear in your final answer. Assume that $q_i$ and $Q^{\\mathrm{spec}}$ are fixed parameters known a priori and that all $m_i$ are nonnegative decision variables. Treat $q_i$ and $Q^{\\mathrm{spec}}$ as dimensionless mass fractions.",
            "solution": "The problem statement will first be validated against the specified criteria.\n\n### Step 1: Extract Givens\n- Number of incoming streams: $n$.\n- Stream index: $i \\in \\{1, \\dots, n\\}$.\n- Mass of stream $i$ (decision variable): $m_i \\ge 0$.\n- Contaminant mass fraction of stream $i$ (parameter): $q_i \\in [0,1]$.\n- Maximum contaminant mass fraction for the outgoing blend (parameter): $Q^{\\mathrm{spec}} \\in [0,1]$.\n- The contaminant mixes linearly by mass.\n- The derivation must start from the principles of conservation of mass and linear mixing.\n- The final constraint must be a linear inequality of the form $L(m_1,\\dots,m_n) \\le 0$.\n- The final answer is the analytical expression for the function $L(m_1,\\dots,m_n)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n\n- **Scientifically Grounded:** The problem is based on the fundamental principle of conservation of mass and the definition of mass fraction, which are cornerstone concepts in chemistry, physics, and engineering. The assumption of linear mixing for properties like sulfur content by mass is a standard and valid model used in the refining and chemical industries.\n- **Well-Posed:** The problem is well-posed. It requests the derivation of a specific mathematical expression (a linear constraint) based on clearly stated physical principles and variables. The objective is unambiguous, and sufficient information is provided to arrive at a unique analytical function $L$.\n- **Objective:** The problem is stated in precise, objective, and quantitative terms. Terminology such as \"mass fraction\" and \"linear inequality\" is standard and free of ambiguity or subjective interpretation.\n\nThe problem does not exhibit any invalidating flaws. It is not scientifically unsound, non-formalizable, incomplete, unrealistic, ill-posed, trivial, or unverifiable.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived as requested.\n\nThe derivation proceeds from the two fundamental principles stated: conservation of mass and the linear mixing of the contaminant property.\n\n1.  **Conservation of Total Mass:** The total mass of the outgoing blended stream, denoted as $M_{\\text{total}}$, is the sum of the masses of the $n$ incoming streams.\n    $$M_{\\text{total}} = \\sum_{i=1}^{n} m_i$$\n    Since each $m_i \\ge 0$, it follows that $M_{\\text{total}} \\ge 0$. We will consider the non-trivial case where at least one $m_i > 0$, and thus $M_{\\text{total}} > 0$.\n\n2.  **Conservation of Contaminant Mass:** The mass of the contaminant in each incoming stream $i$ is the product of the stream's total mass $m_i$ and its contaminant mass fraction $q_i$. This quantity is $q_i m_i$. Since the contaminant property is additive and mixes linearly by mass, the total mass of the contaminant in the final blend, $M_{\\text{cont}}$, is the sum of the contaminant masses from each input stream.\n    $$M_{\\text{cont}} = \\sum_{i=1}^{n} q_i m_i$$\n\n3.  **Property of the Blended Stream:** The mass fraction of the contaminant in the final blended stream, which we denote as $Q_{\\text{blend}}$, is defined as the ratio of the total contaminant mass to the total mass of the blend.\n    $$Q_{\\text{blend}} = \\frac{M_{\\text{cont}}}{M_{\\text{total}}} = \\frac{\\sum_{i=1}^{n} q_i m_i}{\\sum_{i=1}^{n} m_i}$$\n\n4.  **Formulating the Inequality:** The problem requires that the mass fraction of the contaminant in the blend does not exceed the specification $Q^{\\mathrm{spec}}$. This is expressed as the inequality:\n    $$Q_{\\text{blend}} \\le Q^{\\mathrm{spec}}$$\n    Substituting the expression for $Q_{\\text{blend}}$ yields:\n    $$\\frac{\\sum_{i=1}^{n} q_i m_i}{\\sum_{i=1}^{n} m_i} \\le Q^{\\mathrm{spec}}$$\n\n5.  **Conversion to Canonical Linear Form:** To express this as a linear inequality in the decision variables $m_i$, we must eliminate the denominator. The denominator, $\\sum_{i=1}^{n} m_i$, represents the total mass and is non-negative. For any non-trivial blend, this sum is strictly positive. Multiplying both sides of the inequality by this positive quantity does not change the direction of the inequality sign.\n    $$\\sum_{i=1}^{n} q_i m_i \\le Q^{\\mathrm{spec}} \\left( \\sum_{j=1}^{n} m_j \\right)$$\n    (Using a different index $j$ for the sum on the right is notationally clear but not strictly necessary; we can revert to $i$.)\n    $$\\sum_{i=1}^{n} q_i m_i \\le Q^{\\mathrm{spec}} \\sum_{i=1}^{n} m_i$$\n    To achieve the canonical form $L(m_1,\\dots,m_n) \\le 0$, we move all terms to the left-hand side of the inequality.\n    $$\\sum_{i=1}^{n} q_i m_i - Q^{\\mathrm{spec}} \\sum_{i=1}^{n} m_i \\le 0$$\n    The two summations can be combined into a single sum, as they both iterate over the same index set from $i=1$ to $n$.\n    $$\\sum_{i=1}^{n} (q_i m_i - Q^{\\mathrm{spec}} m_i) \\le 0$$\n    Factoring out the decision variable $m_i$ from each term inside the summation gives the final linear form of the inequality:\n    $$\\sum_{i=1}^{n} (q_i - Q^{\\mathrm{spec}}) m_i \\le 0$$\n    This inequality is linear in the variables $m_i$, as the terms $(q_i - Q^{\\mathrm{spec}})$ are constant coefficients.\n\n6.  **Identifying the Function $L$:** The problem asks for the left-hand side function $L(m_1,\\dots,m_n)$ such that the constraint is $L(m_1,\\dots,m_n) \\le 0$. By inspection of the derived inequality, this function is:\n    $$L(m_1,\\dots,m_n) = \\sum_{i=1}^{n} (q_i - Q^{\\mathrm{spec}}) m_i$$\n    This is the required closed-form analytic expression.",
            "answer": "$$\\boxed{\\sum_{i=1}^{n} (q_i - Q^{\\mathrm{spec}}) m_i}$$"
        },
        {
            "introduction": "While some model constraints are abstract, others are dictated by the hard physics of the infrastructure. This practice moves from conceptual formulation to a concrete engineering calculation, focusing on a critical component of the fossil fuel supply chain: the pipeline. You will apply principles of fluid mechanics to determine the maximum volumetric flow rate of a crude oil pipeline, learning how hydraulic limitations, pipe characteristics, and fluid properties define the operational capacity constraints used in larger network models. ",
            "id": "4091834",
            "problem": "A crude oil trunk pipeline is a capacity-limiting element in a regional fossil fuel supply chain. The pipeline conveys single-phase oil at steady state from a coastal terminal to an inland hub with negligible elevation change and negligible minor losses. The length is $L = 60,000\\text{ m}$, the internal diameter is $D = 0.60\\text{ m}$, and the internal absolute roughness of the commercial steel pipe is $\\epsilon = 2.0 \\times 10^{-4}\\text{ m}$. The oil density is $\\rho = 870\\text{ kg m}^{-3}$ and the dynamic viscosity at operating temperature is $\\mu = 1.5 \\times 10^{-2}\\text{ Pa}\\cdot\\text{s}$. The available pressure drop across the segment, as limited by pump stations and maximum allowable operating pressure constraints, is $\\Delta p = 8.0 \\times 10^{5}\\text{ Pa}$.\n\nStarting from the steady incompressible mechanical energy balance and a physically appropriate representation of frictional losses for turbulent flow in rough pipes, derive the governing relationship linking the volumetric flow rate $Q$ to the available pressure drop $\\Delta p$, the pipe and fluid properties $(L, D, \\epsilon, \\rho, \\mu)$, and the friction factor. Then compute the maximum volumetric flow rate $Q$ that can be sustained by this pipeline segment under the given hydraulic limitation.\n\nAssume flow remains single-phase, the oil is effectively incompressible under these conditions, and minor losses are negligible compared to distributed frictional losses. Round your final answer for the maximum volumetric flow rate to three significant figures, and express it in cubic meters per second.",
            "solution": "The problem is first subjected to validation.\n\n**Step 1: Extract Givens**\n- Pipeline length: $L = 60,000\\text{ m}$\n- Internal diameter: $D = 0.60\\text{ m}$\n- Internal absolute roughness: $\\epsilon = 2.0 \\times 10^{-4}\\text{ m}$\n- Oil density: $\\rho = 870\\text{ kg m}^{-3}$\n- Dynamic viscosity: $\\mu = 1.5 \\times 10^{-2}\\text{ Pa}\\cdot\\text{s}$\n- Available pressure drop: $\\Delta p = 8.0 \\times 10^{5}\\text{ Pa}$\n- Assumptions: Steady-state, single-phase, incompressible flow, negligible elevation change, negligible minor losses.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, being a standard application of the principles of fluid mechanics (the Darcy-Weisbach and Colebrook-White equations) to a practical engineering scenario in energy systems. The provided data for the fluid (crude oil) and pipe (commercial steel) are physically realistic. The problem is well-posed; it provides all necessary information and constraints to determine a unique, stable solution for the flow rate. The language used is objective and precise. The problem is self-contained, consistent, and free of any scientific or logical flaws.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n**Solution Derivation**\nThe analysis begins with the steady-state mechanical energy balance for an incompressible fluid flowing between two points, designated $1$ (inlet) and $2$ (outlet). The equation, expressed in terms of head, is:\n$$ \\frac{p_1}{\\rho g} + \\frac{v_1^2}{2g} + z_1 = \\frac{p_2}{\\rho g} + \\frac{v_2^2}{2g} + z_2 + h_L $$\nHere, $p$ is the pressure, $v$ is the average fluid velocity, $z$ is the elevation, $\\rho$ is the fluid density, $g$ is the acceleration due to gravity, and $h_L$ is the total head loss.\n\nWe apply the conditions given in the problem:\n1.  The pipeline has a constant internal diameter $D$, so the cross-sectional area $A$ is constant. By continuity ($Q = A_1 v_1 = A_2 v_2$), the average velocities are equal: $v_1 = v_2$. The kinetic energy terms thus cancel.\n2.  The elevation change is negligible, so $z_1 = z_2$.\n3.  Minor losses are negligible, so the total head loss $h_L$ is equal to the major frictional head loss, $h_f$.\n\nThe energy balance simplifies to:\n$$ \\frac{p_1 - p_2}{\\rho g} = h_f $$\nThe pressure drop is given as $\\Delta p = p_1 - p_2 = 8.0 \\times 10^{5}\\,\\text{Pa}$. Thus:\n$$ \\frac{\\Delta p}{\\rho g} = h_f $$\nFrictional head loss is described by the Darcy-Weisbach equation:\n$$ h_f = f \\frac{L}{D} \\frac{v^2}{2g} $$\nwhere $f$ is the Darcy friction factor.\n\nSubstituting the Darcy-Weisbach expression into the simplified energy balance yields:\n$$ \\frac{\\Delta p}{\\rho g} = f \\frac{L}{D} \\frac{v^2}{2g} $$\nMultiplying by $\\rho g$ gives the governing relationship between pressure drop and velocity:\n$$ \\Delta p = f \\frac{L}{D} \\frac{\\rho v^2}{2} $$\nTo express this in terms of the volumetric flow rate $Q$, we use the relation $v = Q/A$, where the area is $A = \\frac{\\pi D^2}{4}$. Substituting for $v$:\n$$ \\Delta p = f \\frac{L}{D} \\frac{\\rho}{2} \\left( \\frac{Q}{\\frac{\\pi D^2}{4}} \\right)^2 = f \\frac{L}{D} \\frac{8 \\rho}{\\pi^2 D^4} Q^2 $$\nThis is the governing relationship linking $Q$ to $\\Delta p$ and the other parameters.\n\nTo compute $Q$, we must determine the friction factor $f$. For turbulent flow, which is expected in a large pipeline, $f$ is a function of the Reynolds number, $Re$, and the relative roughness, $\\epsilon/D$. The Colebrook-White equation provides this relationship:\n$$ \\frac{1}{\\sqrt{f}} = -2.0 \\log_{10} \\left( \\frac{\\epsilon/D}{3.7} + \\frac{2.51}{Re \\sqrt{f}} \\right) $$\nThe Reynolds number is defined as:\n$$ Re = \\frac{\\rho v D}{\\mu} = \\frac{4 \\rho Q}{\\pi D \\mu} $$\nThe system is implicit because $Q$ depends on $f$, which in turn depends on $Re$, which depends on $Q$. To solve this system, we can rearrange the equations. From the Darcy-Weisbach equation in terms of pressure:\n$$ v = \\sqrt{\\frac{2D\\Delta p}{f \\rho L}} $$\nSubstituting this into the Reynolds number definition:\n$$ Re = \\frac{\\rho D}{\\mu} \\sqrt{\\frac{2D\\Delta p}{f \\rho L}} $$\nA useful grouping of terms is $Re\\sqrt{f}$:\n$$ Re\\sqrt{f} = \\left( \\frac{\\rho D}{\\mu} \\sqrt{\\frac{2D\\Delta p}{f \\rho L}} \\right) \\sqrt{f} = \\frac{\\rho D}{\\mu} \\sqrt{\\frac{2D\\Delta p}{\\rho L}} $$\nThis quantity is independent of the unknowns $f$ and $v$ (or $Q$), and can be calculated directly from the given data.\n\nFirst, we compute the constant parameters:\nRelative roughness: $\\frac{\\epsilon}{D} = \\frac{2.0 \\times 10^{-4}\\,\\text{m}}{0.60\\,\\text{m}} = \\frac{1}{3000} \\approx 3.333 \\times 10^{-4}$.\n\nNext, we compute the value of $Re\\sqrt{f}$:\n$$ Re\\sqrt{f} = \\frac{(870\\text{ kg m}^{-3})(0.60\\text{ m})}{1.5 \\times 10^{-2}\\text{ Pa}\\cdot\\text{s}} \\sqrt{\\frac{2(0.60\\text{ m})(8.0 \\times 10^{5}\\text{ Pa})}{(870\\text{ kg m}^{-3})(60,000\\text{ m})}} $$\n$$ Re\\sqrt{f} = (34800) \\sqrt{\\frac{9.6 \\times 10^5}{5.22 \\times 10^7}} = (34800) \\sqrt{0.0183908...} = (34800)(0.135612...) \\approx 4719.3 $$\nNow, we substitute this value into the Colebrook-White equation to find $f$:\n$$ \\frac{1}{\\sqrt{f}} = -2.0 \\log_{10} \\left( \\frac{3.333 \\times 10^{-4}}{3.7} + \\frac{2.51}{4719.3} \\right) $$\n$$ \\frac{1}{\\sqrt{f}} = -2.0 \\log_{10} (9.009 \\times 10^{-5} + 5.3188 \\times 10^{-4}) $$\n$$ \\frac{1}{\\sqrt{f}} = -2.0 \\log_{10} (6.2197 \\times 10^{-4}) \\approx -2.0 (-3.2062) \\approx 6.4124 $$\nFrom this, we can solve for $f$:\n$$ f = \\left( \\frac{1}{6.4124} \\right)^2 \\approx 0.02432 $$\nWith the friction factor determined, we can now calculate the average velocity $v$:\n$$ v = \\sqrt{\\frac{2D\\Delta p}{f \\rho L}} = \\sqrt{\\frac{2(0.60\\text{ m})(8.0 \\times 10^{5}\\text{ Pa})}{(0.02432)(870\\text{ kg m}^{-3})(60,000\\text{ m})}} $$\n$$ v = \\sqrt{\\frac{9.6 \\times 10^5}{1.270 \\times 10^6}} \\approx \\sqrt{0.7557} \\approx 0.8693\\text{ m s}^{-1} $$\nAs a check, we calculate the Reynolds number to confirm the turbulent flow assumption:\n$$ Re = \\frac{\\rho v D}{\\mu} = \\frac{(870)(0.8693)(0.60)}{1.5 \\times 10^{-2}} \\approx 30250 $$\nSince $Re > 4000$, the flow is turbulent, and our use of the Colebrook-White equation is appropriate.\n\nFinally, we calculate the maximum volumetric flow rate $Q$:\n$$ Q = A v = \\left( \\frac{\\pi D^2}{4} \\right) v = \\left( \\frac{\\pi (0.60\\text{ m})^2}{4} \\right) (0.8693\\text{ m s}^{-1}) $$\n$$ Q = (0.28274\\text{ m}^2)(0.8693\\text{ m s}^{-1}) \\approx 0.2458\\text{ m}^3\\text{s}^{-1} $$\nRounding to three significant figures as requested, we obtain $Q = 0.246\\text{ m}^3\\text{s}^{-1}$.",
            "answer": "$$\n\\boxed{0.246}\n$$"
        },
        {
            "introduction": "The ultimate goal of supply chain modeling is often to guide economic decision-making under a complex set of constraints. This exercise integrates physical limits with economic trade-offs in a classic unit commitment problem, a cornerstone of operational planning in the energy sector. You will implement a model that decides when to turn a processing unit on or off by weighing variable costs, fixed setup costs, and expensive start-up events against penalties for not meeting demand, providing hands-on experience with the binary variables and logical constraints that drive real-world scheduling optimizations. ",
            "id": "4091824",
            "problem": "You are tasked with constructing and analyzing a simplified mixed-integer optimization model of a fossil fuel supply chain unit that converts a fossil input flow into an output flow to meet an exogenous demand over a discrete time horizon. The goal is to capture the setup and start-up cost effects on the operating schedule using binary decision variables and big-$M$ constraints, and to compute the cost-minimizing on/off schedule. Your program must implement the model and return the optimal operating schedules for a set of test cases.\n\nFundamental base and definitions:\n- The unit operates over a finite set of discrete time periods indexed by $t \\in \\{1,\\dots,T\\}$.\n- Let $d_t$ denote the exogenous output demand (e.g., gasoline) in barrels per hour, to be satisfied within period $t$, expressed in barrels per hour (bbl/h).\n- Let $S_t$ denote the fossil feedstock availability (e.g., crude oil supply) in barrels per hour, expressed in bbl/h.\n- Let $e$ denote the conversion factor of feedstock to output, measured in barrels of output per barrel of feedstock, expressed in bbl/bbl. For simplicity, assume $e = 1$ unless otherwise stated.\n- Let $M$ be the structural maximum output capacity of the unit in barrels per hour, expressed in bbl/h.\n- Let $x_t$ be the continuous decision variable for output in period $t$, measured in bbl/h.\n- Let $y_t \\in \\{0,1\\}$ be the binary on/off decision variable, where $y_t = 1$ indicates the unit is online in period $t$, and $y_t = 0$ indicates it is offline.\n- Let $z_t \\in \\{0,1\\}$ be the binary start-up indicator variable, where $z_t = 1$ if the unit transitions from offline to online between periods $t-1$ and $t$ (with $y_0 = 0$ given), and $z_t = 0$ otherwise.\n- Let $c^{var}$ be the variable production cost per barrel, expressed in dollars per barrel ($).\n- Let $c^{setup}$ be the fixed setup cost incurred in each period the unit is online, expressed in dollars ($).\n- Let $c^{start}$ be the start-up cost incurred each time the unit transitions from offline to online, expressed in dollars ($).\n- Let $c^{short}$ be the shortage penalty cost per barrel of unmet demand, expressed in dollars per barrel ($).\n\nModel formulation requirements:\n- Capacity linking via big-$M$ method: enforce the logical implication that output must be zero when the unit is offline and is bounded when online using the following constraints for each $t$:\n  $$x_t \\leq M \\cdot y_t,$$\n  $$x_t \\leq \\frac{S_t}{e},$$\n  $$x_t \\geq 0.$$\n  The first inequality is the big-$M$ constraint that links the continuous output variable $x_t$ to the binary on/off variable $y_t$. The second inequality enforces supply-chain feasibility given $S_t$ and $e$.\n- Start-up definition: for $t=1,\\dots,T$, define $z_t$ using the standard linearization consistent with binary variables and initial condition $y_0 = 0$:\n  $$z_t \\geq y_t - y_{t-1}, \\quad z_t \\geq 0, \\quad z_t \\leq y_t, \\quad z_t \\leq 1 - y_{t-1}.$$\n  In binary feasible schedules, this ensures $z_t = 1$ if and only if $y_{t-1} = 0$ and $y_t = 1$, and $z_t = 0$ otherwise.\n- Demand satisfaction with shortage: unmet demand $\\max(0, d_t - x_t)$ incurs a cost at rate $c^{short}$ per barrel. There is no inventory or backlogging across periods.\n\nObjective:\n- Minimize the total cost over the horizon, comprising variable production, per-period setup, start-up, and shortage penalty:\n  $$\\min \\sum_{t=1}^T \\left(c^{var} \\cdot x_t + c^{setup} \\cdot y_t + c^{start} \\cdot z_t + c^{short} \\cdot \\max(0, d_t - x_t) \\right).$$\n\nAlgorithmic requirement:\n- Because Mixed-Integer Linear Programming (MILP) solvers are not used here, derive a principled algorithm based on the model structure to evaluate the cost of any candidate binary schedule $\\{y_t\\}_{t=1}^T$, and then perform an exhaustive search over all binary schedules for small $T$. For a fixed schedule, compute the optimal $x_t$ in closed form, grounded in the above objective and constraints.\n\nOutput requirement:\n- For each test case, return the cost-minimizing schedule $\\{y_t\\}_{t=1}^T$ and the corresponding minimal total cost in dollars. Express costs in dollars ($) and operating decisions as integers $0$ or $1$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a list whose first entry is the total cost in dollars (as a float), followed by the operating schedule entries $y_1, \\dots, y_T$ (as integers). For example, the output format for two cases could be $$[[1000.0,1,0,1],[0.0,0,0]]$$ printed on a single line.\n\nTest suite:\nUse the following scientifically plausible parameter sets, with all rates in barrels per hour (bbl/h) and costs in dollars ($). Assume $y_0 = 0$ and $e = 1$ for all cases.\n\n- Case $1$ (baseline fossil supply-constrained operation):\n  - $T = 4$,\n  - $d = [50, 120, 80, 0]$ bbl/h,\n  - $S = [120, 80, 160, 0]$ bbl/h,\n  - $M = 100$ bbl/h,\n  - $c^{var} = 20$ \\$/bbl,\n  - $c^{setup} = 100$ \\$,\n  - $c^{start} = 500$ \\$,\n  - $c^{short} = 200$ \\$/bbl.\n\n- Case $2$ (higher start-up cost, same supply and demand):\n  - $T = 4$,\n  - $d = [50, 120, 80, 0]$ bbl/h,\n  - $S = [120, 80, 160, 0]$ bbl/h,\n  - $M = 100$ bbl/h,\n  - $c^{var} = 20$ \\$/bbl,\n  - $c^{setup} = 100$ \\$,\n  - $c^{start} = 2000$ \\$,\n  - $c^{short} = 200$ \\$/bbl.\n\n- Case $3$ (zero start-up cost, higher per-period setup cost):\n  - $T = 4$,\n  - $d = [50, 120, 80, 0]$ bbl/h,\n  - $S = [120, 80, 160, 0]$ bbl/h,\n  - $M = 100$ bbl/h,\n  - $c^{var} = 20$ \\$/bbl,\n  - $c^{setup} = 300$ \\$,\n  - $c^{start} = 0$ \\$,\n  - $c^{short} = 200$ \\$/bbl.\n\n- Case $4$ (single-period peak demand):\n  - $T = 1$,\n  - $d = [150]$ bbl/h,\n  - $S = [300]$ bbl/h,\n  - $M = 100$ bbl/h,\n  - $c^{var} = 30$ \\$/bbl,\n  - $c^{setup} = 200$ \\$,\n  - $c^{start} = 500$ \\$,\n  - $c^{short} = 300$ \\$/bbl.\n\n- Case $5$ (zero demand across all periods):\n  - $T = 3$,\n  - $d = [0, 0, 0]$ bbl/h,\n  - $S = [100, 100, 100]$ bbl/h,\n  - $M = 100$ bbl/h,\n  - $c^{var} = 25$ \\$/bbl,\n  - $c^{setup} = 100$ \\$,\n  - $c^{start} = 500$ \\$,\n  - $c^{short} = 200$ \\$/bbl.\n\n- Case $6$ (variable production cost exceeds shortage penalty):\n  - $T = 2$,\n  - $d = [60, 60]$ bbl/h,\n  - $S = [100, 100]$ bbl/h,\n  - $M = 100$ bbl/h,\n  - $c^{var} = 500$ \\$/bbl,\n  - $c^{setup} = 100$ \\$,\n  - $c^{start} = 200$ \\$,\n  - $c^{short} = 100$ \\$/bbl.\n\nYour program must compute the optimal schedule for each case and print a single line containing a comma-separated list of the case results, with each case result formatted as a list $[ \\text{total\\_cost}, y_1, \\dots, y_T ]$ exactly as described above.",
            "solution": "The user-provided problem has been analyzed according to the specified validation protocol.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Time Horizon**: Discrete periods indexed by $t \\in \\{1, \\dots, T\\}$.\n- **Exogenous Demand**: $d_t$ in barrels per hour (bbl/h).\n- **Feedstock Availability**: $S_t$ in barrels per hour (bbl/h).\n- **Conversion Factor**: $e$ in bbl/bbl, with $e=1$ for all cases.\n- **Maximum Capacity**: $M$ in barrels per hour (bbl/h).\n- **Decision Variables**:\n    - Continuous output: $x_t \\geq 0$ (bbl/h).\n    - Binary on/off status: $y_t \\in \\{0, 1\\}$.\n    - Binary start-up indicator: $z_t \\in \\{0, 1\\}$.\n- **Initial Condition**: $y_0 = 0$.\n- **Cost Parameters**:\n    - Variable cost: $c^{var}$ ($/bbl).\n    - Setup cost: $c^{setup}$ ($).\n    - Start-up cost: $c^{start}$ ($).\n    - Shortage penalty: $c^{short}$ ($/bbl).\n- **Constraints for each period $t$**:\n    1. $x_t \\leq M \\cdot y_t$\n    2. $x_t \\leq S_t / e$\n    3. $x_t \\geq 0$\n    4. $z_t \\geq y_t - y_{t-1}$\n    5. $z_t \\geq 0, z_t \\leq y_t, z_t \\leq 1 - y_{t-1}$\n- **Objective Function**: Minimize total cost over the horizon $T$.\n  $$ \\min \\sum_{t=1}^T \\left(c^{var} \\cdot x_t + c^{setup} \\cdot y_t + c^{start} \\cdot z_t + c^{short} \\cdot \\max(0, d_t - x_t) \\right) $$\n- **Algorithmic Requirement**: An exhaustive search over all binary schedules $\\{y_t\\}_{t=1}^T$, utilizing a closed-form solution for the optimal $x_t$ given a fixed schedule.\n- **Provided Test Cases**: Six distinct parameter sets are specified.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria:\n\n- **Scientifically Grounded**: The problem is a canonical representation of a unit commitment problem from operations research and energy systems engineering. The model elements (costs, capacities, binary decisions) are standard and fundamentally sound. It is scientifically valid.\n- **Well-Posed**: The task is to find a minimum cost over a finite set of $2^T$ schedules. For each schedule, the subproblem of determining optimal production is a convex optimization problem with a unique solution. A minimum cost and an associated optimal schedule are guaranteed to exist. The problem is well-posed.\n- **Objective**: The problem is stated using precise, unambiguous mathematical and economic terminology. It is free of subjective or opinion-based content.\n- **Completeness and Consistency**: The problem statement is self-contained. All necessary parameters, constraints, and objectives are clearly defined for each test case. There are no contradictions.\n- **Realism**: The parameters are stated to be scientifically plausible. The model, though simplified, captures realistic trade-offs in production planning, such as balancing start-up costs against operating costs and shortage penalties. The data are dimensionally consistent.\n- **Structure**: The problem is well-structured. The non-linear term $\\max(0, d_t - x_t)$ is a standard feature in such models, representing a convex penalty function. The required algorithmic approach (exhaustive search) is appropriate for the small values of $T$ given in the test cases.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. It is a well-defined exercise in optimization modeling and algorithmic implementation. A solution will be provided.\n\n### Solution Derivation\n\nThe problem requires finding an optimal operating schedule $\\{y_t\\}_{t=1}^T$ and the corresponding production levels $\\{x_t\\}_{t=1}^T$ that minimize total cost. The specified algorithm is an exhaustive search over all possible binary schedules $\\{y_t\\}_{t=1}^T$. This is computationally feasible because the time horizon $T$ is small in the provided test cases (maximum $T=4$, corresponding to $2^4=16$ schedules).\n\nThe core of the algorithm is to compute the total cost for any given binary schedule $\\{y_t\\}$. For a fixed schedule, the objective function allows for a period-by-period determination of the optimal production levels $\\{x_t\\}$. The total cost is the sum of costs from each period.\n\nFor a specific period $t$, given a fixed value of $y_t$ (and $y_{t-1}$ to determine start-up), the cost components $c^{setup}y_t$ and $c^{start}z_t$ are fixed. The decision on $x_t$ is made to minimize the remaining variable portion of the cost for that period:\n$$ J_t(x_t) = c^{var} \\cdot x_t + c^{short} \\cdot \\max(0, d_t - x_t) $$\nThis minimization is subject to the constraints on $x_t$: $x_t \\leq M \\cdot y_t$, $x_t \\leq S_t/e$, and $x_t \\geq 0$.\n\nWe analyze the determination of the optimal production $x_t^{opt}$ and the resulting period cost $C_t$:\n\n**1. Unit is Offline ($y_t = 0$)**\nThe constraint $x_t \\leq M \\cdot y_t$ becomes $x_t \\leq 0$. Combined with $x_t \\geq 0$, this forces the production to be $x_t^{opt} = 0$. The start-up variable $z_t$ must also be $0$ since $z_t \\leq y_t$. The cost for period $t$ is due entirely to the unmet demand:\n$$ C_t = c^{var} \\cdot 0 + c^{setup} \\cdot 0 + c^{start} \\cdot 0 + c^{short} \\cdot \\max(0, d_t - 0) = c^{short} \\cdot d_t $$\n\n**2. Unit is Online ($y_t = 1$)**\nThe constraints on $x_t$ become $0 \\leq x_t \\leq M$ and $x_t \\leq S_t/e$. Thus, $x_t$ must be within the range $[0, X_{max,t}]$, where the effective capacity is $X_{max,t} = \\min(M, S_t/e)$. We must find the $x_t$ in this range that minimizes $J_t(x_t)$.\n\nThe function $J_t(x_t)$ is convex and piecewise linear. Its derivative with respect to $x_t$ is:\n$$ \\frac{dJ_t}{dx_t} = \\begin{cases} c^{var} - c^{short} & \\text{if } x_t < d_t \\\\ c^{var} & \\text{if } x_t > d_t \\end{cases} $$\nThe optimal choice of $x_t$ depends on the sign of the slope $c^{var} - c^{short}$.\n\n- **Subcase 2a: $c^{var} < c^{short}$**\nThe slope is negative for $x_t < d_t$ and positive for $x_t > d_t$. The function $J_t(x_t)$ is minimized at $x_t = d_t$. To satisfy the capacity constraints, we should produce as close to the demand as possible. The optimal production is:\n$$ x_t^{opt} = \\min(d_t, X_{max,t}) = \\min(d_t, M, S_t/e) $$\nThis is the standard economic logic: if the cost of production is less than the penalty for not producing, then produce to meet demand up to physical limits.\n\n- **Subcase 2b: $c^{var} \\geq c^{short}$**\nThe slope is non-negative everywhere ($c^{var} - c^{short} \\ge 0$ and $c^{var} > 0$). $J_t(x_t)$ is a non-decreasing function of $x_t$. To minimize it, we must choose the smallest possible value for $x_t$, which is $x_t^{opt} = 0$. This implies that even if the unit is turned on, it is more cost-effective to produce nothing and pay the full shortage penalty than to incur the variable production cost. Comparing the total cost of being online ($y_t=1$) versus offline ($y_t=0$) shows that being online adds a strictly positive setup cost ($c^{setup} > 0$) for no benefit. Therefore, in this regime, the optimal decision would always be to keep the unit off, unless all costs and demands are zero. The general algorithm correctly finds this, so no special case is needed.\n\nThe cost for the period $t$ when $y_t=1$ is calculated based on the determined $x_t^{opt}$. The start-up variable $z_t$ is $1$ if the unit was previously off ($y_{t-1}=0$) and is now on ($y_t=1$), and $0$ otherwise. Given the initial condition $y_0 = 0$, this can be written as $z_t = y_t \\cdot (1 - y_{t-1})$ for $t \\geq 1$. The period cost is:\n$$ C_t = c^{var} \\cdot x_t^{opt} + c^{setup} \\cdot y_t + c^{start} \\cdot z_t + c^{short} \\cdot \\max(0, d_t - x_t^{opt}) $$\n\n**Algorithm Summary**\nFor each test case:\n1. Initialize `min_total_cost` to infinity and `best_schedule` to `None`.\n2. Iterate through each integer $i$ from $0$ to $2^T - 1$. Each integer's binary representation corresponds to a unique candidate schedule $\\{y_1, \\dots, y_T\\}$.\n3. For each schedule, calculate the total cost by summing the period costs $C_t$ from $t=1$ to $T$.\n    a. For each period $t$, determine $y_t$ from the schedule.\n    b. Based on $y_t$ (and $y_{t-1}$), calculate $x_t^{opt}$ and $z_t$ as derived above.\n    c. Compute the period cost $C_t$.\n4. If the calculated total cost for the current schedule is less than `min_total_cost`, update `min_total_cost` and `best_schedule`.\n5. After iterating through all $2^T$ schedules, the optimal schedule and its cost are found. Store this result.\n6. After processing all test cases, format the collected results into a single string as specified and print it.",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Computes the cost-minimizing on/off schedule for a fossil fuel unit\n    by performing an exhaustive search over all possible binary schedules.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (T, d, S, M, c_var, c_setup, c_start, c_short)\n    # e is assumed to be 1.0 for all cases.\n    test_cases = [\n        # Case 1\n        (4, [50, 120, 80, 0], [120, 80, 160, 0], 100, 20, 100, 500, 200),\n        # Case 2\n        (4, [50, 120, 80, 0], [120, 80, 160, 0], 100, 20, 100, 2000, 200),\n        # Case 3\n        (4, [50, 120, 80, 0], [120, 80, 160, 0], 100, 20, 300, 0, 200),\n        # Case 4\n        (1, [150], [300], 100, 30, 200, 500, 300),\n        # Case 5\n        (3, [0, 0, 0], [100, 100, 100], 100, 25, 100, 500, 200),\n        # Case 6\n        (2, [60, 60], [100, 100], 100, 500, 100, 200, 100),\n    ]\n\n    all_results = []\n    e = 1.0 # Conversion factor\n\n    for case in test_cases:\n        T, d, S, M, c_var, c_setup, c_start, c_short = case\n        \n        min_total_cost = np.inf\n        best_schedule = []\n\n        num_schedules = 2**T\n        for i in range(num_schedules):\n            # Generate a candidate schedule {y_1, ..., y_T}\n            # (i >> t) & 1 gives bits from right-to-left, which works for t=0..T-1\n            # corresponding to periods 1..T\n            y_schedule = [(i >> t) & 1 for t in range(T)]\n            \n            current_total_cost = 0.0\n            y_prev = 0  # y_0 is given as 0\n\n            for t_idx in range(T):\n                y_t = y_schedule[t_idx]\n                d_t = d[t_idx]\n                S_t = S[t_idx]\n                \n                period_cost = 0.0\n                \n                if y_t == 0:\n                    # Unit is offline. Production is 0. Cost is only from unmet demand.\n                    # z_t is 0 since z_t <= y_t. No setup or startup cost.\n                    period_cost = c_short * d_t\n                else: # y_t == 1\n                    # Unit is online.\n                    \n                    # Determine start-up: z_t = 1 if y_t=1 and y_{t-1}=0\n                    z_t = 1 if y_prev == 0 else 0\n                    \n                    # Determine optimal production x_t\n                    X_max_t = min(M, S_t / e)\n                    \n                    x_t = 0.0\n                    if c_var < c_short:\n                        # Produce to meet demand up to capacity if cheaper than shortage\n                        x_t = min(d_t, X_max_t)\n                    else:\n                        # Cheaper to not produce and incur shortage penalty\n                        x_t = 0.0\n\n                    shortage = max(0, d_t - x_t)\n                    \n                    period_cost = (c_var * x_t) + c_setup + (c_start * z_t) + (c_short * shortage)\n\n                current_total_cost += period_cost\n                y_prev = y_t\n\n            if current_total_cost < min_total_cost:\n                min_total_cost = current_total_cost\n                best_schedule = y_schedule\n\n        # Format the result for the current case\n        case_result = [float(min_total_cost)] + best_schedule\n        all_results.append(case_result)\n\n    # Print all results in the specified single-line format\n    # The format [[cost,y1,...],[cost,y1,...]] is Python's list-to-string without spaces.\n    print(str(all_results).replace(' ', ''))\n\nsolve()\n```"
        }
    ]
}