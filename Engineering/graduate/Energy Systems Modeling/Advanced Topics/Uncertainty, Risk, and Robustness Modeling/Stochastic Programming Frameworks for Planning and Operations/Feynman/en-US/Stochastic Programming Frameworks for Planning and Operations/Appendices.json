{
    "hands_on_practices": [
        {
            "introduction": "To bring the theory of stochastic programming to life, we begin with a foundational practice in scenario analysis. We will explore the direct consequences of uncertainty in a power system using a 'wait-and-see' approach, where operational decisions are made after the uncertain wind generation is known. This exercise  is fundamental for understanding how different future outcomes affect optimal generation dispatch and electricity prices, forming the basis for risk assessment in system operations.",
            "id": "4125974",
            "problem": "A power system planner considers a two-bus network under the Stochastic Economic Dispatch (SED) framework with three equiprobable wind scenarios. The planner must determine the expected thermal generation dispatch and expected nodal prices under a Direct Current (DC) lossless power flow approximation with transmission capacity limits and convex generation costs.\n\nThe network consists of bus $1$ and bus $2$ connected by a single transmission line. Bus $1$ has a thermal generator with constant marginal cost $c_{1}$ and no minimum generation constraint; bus $2$ has a thermal generator with constant marginal cost $c_{2}$ and no minimum generation constraint. Wind power is injected at bus $2$ and is uncertain. Let $f_{s}$ denote the line flow from bus $1$ to bus $2$ in scenario $s$ (positive $f_{s}$ indicates export from bus $1$ to bus $2$), and let $|f_{s}| \\leq F$ enforce the thermal capacity of the line. Demands are fixed and known. Wind power at bus $2$ is non-dispatchable up to its available scenario value and may be curtailed at zero cost if necessary to preserve feasibility, but there is no load shedding. All costs are in United States Dollars per Megawatt-hour ($\\$\\!/\\text{MWh}$), power in Megawatts ($\\text{MW}$), and energy in Megawatt-hours ($\\text{MWh}$). Locational Marginal Price (LMP) is defined as the Lagrange multiplier (dual variable) associated with the nodal power balance constraint at each bus in the Karush-Kuhn-Tucker (KKT) optimality conditions of the deterministic economic dispatch for each scenario.\n\nData:\n- Bus $1$ demand: $d_{1} = 100$ $\\text{MW}$.\n- Bus $2$ demand: $d_{2} = 150$ $\\text{MW}$.\n- Bus $1$ thermal generator: marginal cost $c_{1} = 20$ $\\$\\!/\\text{MWh}$, capacity $\\geq 300$ $\\text{MW}$.\n- Bus $2$ thermal generator: marginal cost $c_{2} = 60$ $\\$\\!/\\text{MWh}$, capacity $\\geq 300$ $\\text{MW}$.\n- Transmission line capacity: $F = 100$ $\\text{MW}$.\n- Wind injection at bus $2$ in the three equiprobable scenarios $s \\in \\{1,2,3\\}$: $w_{1} = 0$ $\\text{MW}$, $w_{2} = 80$ $\\text{MW}$, $w_{3} = 200$ $\\text{MW}$.\n- Scenario probabilities: $\\mathbb{P}(s) = \\frac{1}{3}$ for all $s \\in \\{1,2,3\\}$.\n\nFor each scenario $s$, the deterministic economic dispatch problem is:\nMinimize total generation cost $c_{1} g_{1,s} + c_{2} g_{2,s}$ subject to:\n- Nodal balances: $g_{1,s} - f_{s} = d_{1}$ and $g_{2,s} + w_{s} + f_{s} = d_{2}$,\n- Line capacity: $-F \\leq f_{s} \\leq F$,\n- Generator bounds: $g_{1,s} \\geq 0$, $g_{2,s} \\geq 0$.\n\nLet $\\pi_{1,s}$ and $\\pi_{2,s}$ denote the LMPs at bus $1$ and bus $2$, respectively, for scenario $s$. Compute the expected thermal generation dispatch $\\mathbb{E}[g_{1}]$ and $\\mathbb{E}[g_{2}]$, and the expected nodal prices $\\mathbb{E}[\\pi_{1}]$ and $\\mathbb{E}[\\pi_{2}]$. Provide exact values. Express thermal dispatch in $\\text{MW}$ and prices in $\\$\\!/\\text{MWh}$. Report the final answer as a single row matrix $\\left( \\mathbb{E}[g_{1}] \\;\\; \\mathbb{E}[g_{2}] \\;\\; \\mathbb{E}[\\pi_{1}] \\;\\; \\mathbb{E}[\\pi_{2}] \\right)$.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of power system economics and optimization, is well-posed with a unique solution for each scenario, and is presented objectively with all necessary data.\n\nThe task is to compute the expected thermal generation dispatch $(\\mathbb{E}[g_{1}], \\mathbb{E}[g_{2}])$ and the expected nodal prices, also known as Locational Marginal Prices (LMPs), $(\\mathbb{E}[\\pi_{1}], \\mathbb{E}[\\pi_{2}])$. The problem specifies a Stochastic Economic Dispatch (SED) framework, but since all operational decisions are made after the uncertainty in wind generation is resolved, this reduces to solving a separate, deterministic Economic Dispatch (ED) problem for each of the three wind scenarios and then computing the expectation of the results. The scenarios are equiprobable, with probability $\\mathbb{P}(s) = \\frac{1}{3}$ for each $s \\in \\{1, 2, 3\\}$.\n\nFor each scenario $s$, the optimization problem is to minimize the total generation cost:\n$$ \\text{Minimize} \\quad Z_s = c_{1} g_{1,s} + c_{2} g_{2,s} $$\nsubject to a set of constraints. The data provided are: $c_{1} = 20 \\$\\!/\\text{MWh}$, $c_{2} = 60 \\$\\!/\\text{MWh}$, $d_{1} = 100 \\text{ MW}$, $d_{2} = 150 \\text{ MW}$, $F = 100 \\text{ MW}$, and wind generation $w_s$ for $s \\in \\{1, 2, 3\\}$.\n\nThe nodal power balance equations are:\n1. Bus 1: $g_{1,s} - f_{s} = d_{1} = 100$\n2. Bus 2: $g_{2,s} + w_{s} + f_{s} = d_{2} = 150$\n\nSumming these two equations yields the system-wide power balance:\n$$ g_{1,s} + g_{2,s} + w_{s} = d_{1} + d_{2} = 250 $$\nThis allows us to express $g_{2,s}$ in terms of $g_{1,s}$ and $w_s$:\n$$ g_{2,s} = 250 - w_s - g_{1,s} $$\n\nThe transmission line flow $f_s$ can be expressed in terms of $g_{1,s}$ from the bus $1$ balance:\n$$ f_{s} = g_{1,s} - 100 $$\nThe line capacity constraint $|f_{s}| \\leq F$ translates to:\n$$ -100 \\leq g_{1,s} - 100 \\leq 100 \\implies 0 \\leq g_{1,s} \\leq 200 $$\n\nThe generator outputs must be non-negative: $g_{1,s} \\geq 0$ and $g_{2,s} \\geq 0$. The first condition, $g_{1,s} \\geq 0$, is already incorporated in the line capacity constraint. The second condition provides an upper bound on $g_{1,s}$:\n$$ g_{2,s} \\geq 0 \\implies 250 - w_s - g_{1,s} \\geq 0 \\implies g_{1,s} \\leq 250 - w_s $$\n\nSubstituting the expression for $g_{2,s}$ into the objective function, we obtain a function of a single variable, $g_{1,s}$:\n$$ Z_s(g_{1,s}) = 20 g_{1,s} + 60 (250 - w_s - g_{1,s}) = 15000 - 60 w_s - 40 g_{1,s} $$\nMinimizing $Z_s$ with respect to $g_{1,s}$ is equivalent to maximizing $g_{1,s}$. The optimal value for $g_{1,s}$ is the maximum value allowed by the constraints:\n$$ g_{1,s}^{\\text{opt}} = \\min(200, 250 - w_s) $$\n\nWe now solve for the primal (dispatch) and dual (prices) variables for each scenario.\n\n**Scenario 1: $w_{1} = 0 \\text{ MW}$**\n-   **Dispatch:**\n    $g_{1,1} = \\min(200, 250 - 0) = 200 \\text{ MW}$.\n    $g_{2,1} = 250 - 0 - 200 = 50 \\text{ MW}$.\n    $f_{1} = 200 - 100 = 100 \\text{ MW}$.\n-   **Prices (LMPs):**\n    The line flow $f_{1} = 100 \\text{ MW}$ is at its capacity limit $F$. The line is congested. This isolates the two buses from an economic perspective. The marginal cost of supplying an additional megawatt of load at each bus is determined by the local marginal generator.\n    At bus $1$, generator $1$ is dispatched ($g_{1,1} > 0$), so it sets the price: $\\pi_{1,1} = c_{1} = 20 \\$\\!/\\text{MWh}$.\n    At bus $2$, generator $2$ is dispatched ($g_{2,1} > 0$) to meet the portion of demand that cannot be met by cheaper imported power, so it sets the price: $\\pi_{2,1} = c_{2} = 60 \\$\\!/\\text{MWh}$.\n\n**Scenario 2: $w_{2} = 80 \\text{ MW}$**\n-   **Dispatch:**\n    $g_{1,2} = \\min(200, 250 - 80) = \\min(200, 170) = 170 \\text{ MW}$.\n    $g_{2,2} = 250 - 80 - 170 = 0 \\text{ MW}$.\n    $f_{2} = 170 - 100 = 70 \\text{ MW}$.\n-   **Prices (LMPs):**\n    The line flow $|f_{2}| = 70 \\text{ MW}$ is less than the capacity $F=100 \\text{ MW}$. The line is not congested. Therefore, there is a single system price, set by the cheapest generator that is currently operating.\n    Generator $1$ is dispatched ($g_{1,2} > 0$), while generator $2$ is not ($g_{2,2}=0$). Thus, generator $1$ is the system-wide marginal unit.\n    $\\pi_{1,2} = \\pi_{2,2} = c_{1} = 20 \\$\\!/\\text{MWh}$.\n\n**Scenario 3: $w_{3} = 200 \\text{ MW}$**\n-   **Dispatch:**\n    $g_{1,3} = \\min(200, 250 - 200) = \\min(200, 50) = 50 \\text{ MW}$.\n    $g_{2,3} = 250 - 200 - 50 = 0 \\text{ MW}$.\n    $f_{3} = 50 - 100 = -50 \\text{ MW}$.\n-   **Prices (LMPs):**\n    The line flow $|f_{3}| = 50 \\text{ MW}$ is less than the capacity $F$. The line is not congested.\n    Similar to scenario $2$, generator $1$ is dispatched ($g_{1,3} > 0$) and generator $2$ is not ($g_{2,3}=0$). Generator $1$ is the marginal unit for the system.\n    $\\pi_{1,3} = \\pi_{2,3} = c_{1} = 20 \\$\\!/\\text{MWh}$.\n\n**Calculation of Expected Values**\nThe expectation of a variable $X$ is given by $\\mathbb{E}[X] = \\sum_{s=1}^{3} \\mathbb{P}(s) X_s = \\frac{1}{3} (X_1 + X_2 + X_3)$.\n\n-   **Expected Thermal Generation:**\n    $\\mathbb{E}[g_{1}] = \\frac{1}{3} (g_{1,1} + g_{1,2} + g_{1,3}) = \\frac{1}{3} (200 + 170 + 50) = \\frac{420}{3} = 140 \\text{ MW}$.\n    $\\mathbb{E}[g_{2}] = \\frac{1}{3} (g_{2,1} + g_{2,2} + g_{2,3}) = \\frac{1}{3} (50 + 0 + 0) = \\frac{50}{3} \\text{ MW}$.\n\n-   **Expected Nodal Prices:**\n    $\\mathbb{E}[\\pi_{1}] = \\frac{1}{3} (\\pi_{1,1} + \\pi_{1,2} + \\pi_{1,3}) = \\frac{1}{3} (20 + 20 + 20) = \\frac{60}{3} = 20 \\$\\!/\\text{MWh}$.\n    $\\mathbb{E}[\\pi_{2}] = \\frac{1}{3} (\\pi_{2,1} + \\pi_{2,2} + \\pi_{2,3}) = \\frac{1}{3} (60 + 20 + 20) = \\frac{100}{3} \\$\\!/\\text{MWh}$.\n\nThe final results are $\\mathbb{E}[g_{1}] = 140$, $\\mathbb{E}[g_{2}] = \\frac{50}{3}$, $\\mathbb{E}[\\pi_{1}] = 20$, and $\\mathbb{E}[\\pi_{2}] = \\frac{100}{3}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n140 & \\frac{50}{3} & 20 & \\frac{100}{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on scenario analysis, we now shift from passive observation to active decision-making under uncertainty. This practice tackles a classic two-stage capacity expansion problem where a 'here-and-now' investment decision must be made before future demand is revealed. Through this exercise , you will gain essential experience in formulating the total expected cost and determining the optimal first-stage decision in a true stochastic programming context.",
            "id": "4125881",
            "problem": "Consider a capacity expansion planning problem for a single peak hour formulated as a Two-Stage Stochastic Program (TSSP). In the first stage, the planner chooses a firm capacity $x$ (in megawatts). The first-stage investment cost is $k x$ (in dollars per hour), where $k > 0$ is a given amortized capacity cost rate. In the second stage, after the uncertainty is revealed, the operator dispatches up to $x$ from the new capacity and can additionally procure energy from a spot market subject to a tranche limit. Any unmet demand results in load shedding penalized by a piecewise linear Value of Lost Load (VOLL) function. The second-stage for each scenario $s \\in \\{1,2,3\\}$ is modeled by a Linear Programming (LP) recourse problem with decision variables $g_s$ (dispatch from the new capacity), $p_s$ (spot market purchase), $u_{1,s}$ (first VOLL segment of shed load), and $u_{2,s}$ (second VOLL segment of shed load), and parameters described below. The energy balance constraint is $g_s + p_s + u_{1,s} + u_{2,s} = d_s$, and the operational limits are $0 \\leq g_s \\leq x$, $0 \\leq p_s \\leq b$, $0 \\leq u_{1,s} \\leq r$, and $u_{2,s} \\geq 0$. The second-stage cost in scenario $s$ is $c_m p_s + v_1 u_{1,s} + v_2 u_{2,s}$, where $c_m$, $v_1$, and $v_2$ are positive constants with $c_m  v_1  v_2$. The plannerâ€™s objective is to minimize the sum of the first-stage investment cost and the probability-weighted expected second-stage operating cost.\n\nThe parameters are:\n- Scenario demands are $d_1 = 50$, $d_2 = 80$, $d_3 = 110$ (in megawatts).\n- Scenario probabilities are $\\pi_1 = 0.4$, $\\pi_2 = 0.35$, $\\pi_3 = 0.25$.\n- Spot market tranche limit is $b = 30$ (in megawatts).\n- VOLL first-segment limit is $r = 10$ (in megawatts).\n- Spot market price is $c_m = 150$ (in dollars per megawatt-hour).\n- VOLL first-segment penalty is $v_1 = 2000$ (in dollars per megawatt-hour).\n- VOLL second-segment penalty is $v_2 = 10000$ (in dollars per megawatt-hour).\n- Amortized capacity cost rate is $k = 500$ (in dollars per megawatt per hour).\n\nAssume a single hour is considered, so megawatt and megawatt-hour units coincide for costs per hour. The dispatch $g_s$ has no variable operating cost in the second stage (its cost is fully captured by the first-stage term $k x$), and there are no other operational constraints.\n\nStarting from the formal definition of a TSSP and the LP recourse model described above, derive the expected recourse cost as a function of $x$ using first principles. Then, determine the optimal capacity $x$ that minimizes the total expected cost $k x + \\sum_{s=1}^{3} \\pi_s \\left(c_m p_s + v_1 u_{1,s} + v_2 u_{2,s}\\right)$ subject to the recourse feasibility constraints, and compute the associated expected total cost at this optimal $x$.\n\nProvide exact values. Express $x$ in megawatts (MW) and the expected total cost in dollars per hour.",
            "solution": "### Problem Validation\nThe problem is a standard and well-established formulation of a capacity expansion problem under uncertainty, a common topic in energy systems modeling and operations research. The problem is scientifically grounded, well-posed, and objective. The objective function is convex, guaranteeing that a global minimum exists. The problem is self-contained, with all necessary data and relationships provided. The problem is deemed valid and a detailed solution can be derived.\n\n### Solution Derivation\nThe problem is a two-stage stochastic linear program (TSSP) defined as:\n$$ \\min_{x \\geq 0} Z(x) = kx + \\mathbb{E}_{\\omega}[Q(x, \\omega)] $$\nwhere $x$ is the first-stage decision variable for the firm capacity, $k$ is the investment cost rate, and $Q(x, \\omega)$ is the optimal value of the second-stage (recourse) problem for a given realization of the uncertain parameter $\\omega$. Here, the uncertainty is in the demand $d$, which takes values $d_s$ with probabilities $\\pi_s$ for $s \\in \\{1, 2, 3\\}$. The total expected cost is:\n$$ Z(x) = kx + \\sum_{s=1}^{3} \\pi_s Q(x, d_s) $$\nFor each scenario $s$, the recourse problem $Q(x, d_s)$ is a linear program to find the minimum operating cost by dispatching resources in merit order (cheapest first). The marginal costs of the resources are: new capacity ($0$), spot market ($c_m = 150$), VOLL segment 1 ($v_1 = 2000$), and VOLL segment 2 ($v_2 = 10000$).\n\nThe recourse cost $Q(x, d_s)$ is a piecewise linear function of the energy deficit, $\\max(0, d_s - x)$:\n- If $x \\geq d_s$: The demand is fully met by the new capacity. Cost $Q(x, d_s) = 0$.\n- If $d_s - b \\leq x  d_s$: The deficit is met by spot purchases. Cost $Q(x, d_s) = c_m (d_s - x)$.\n- If $d_s - b - r \\leq x  d_s - b$: The deficit is met by spot and VOLL segment 1. Cost $Q(x, d_s) = c_m b + v_1(d_s - x - b)$.\n- If $x  d_s - b - r$: The deficit is met by all recourse options. Cost $Q(x, d_s) = c_m b + v_1 r + v_2(d_s - x - b - r)$.\n\nThe total cost function $Z(x)$ is convex. We find the minimum by finding where the derivative (or subgradient) of $Z(x)$ is zero.\n$$ \\frac{dZ}{dx} = k + \\sum_{s=1}^{3} \\pi_s \\frac{\\partial Q(x,d_s)}{\\partial x} $$\nThe derivative of the recourse function is piecewise constant:\n$$ \\frac{\\partial Q(x,d_s)}{\\partial x} = \\begin{cases} 0  \\text{if } x > d_s \\\\ -c_m  \\text{if } d_s - b  x  d_s \\\\ -v_1  \\text{if } d_s - b - r  x  d_s - b \\\\ -v_2  \\text{if } x  d_s - b - r \\end{cases} $$\nThe derivative $\\frac{dZ}{dx}$ changes value at the critical points $x = d_s$, $x=d_s-b$, and $x=d_s-b-r$ for each scenario. Using the given parameters ($k=500$, $b=30$, $r=10$), the sorted unique critical points are $\\{10, 20, 40, 50, 70, 80, 110\\}$. We seek $x^*$ where the derivative of $Z(x)$ changes from negative to positive.\n\nLet's evaluate $\\frac{dZ}{dx} = 500 + \\mathbb{E}[\\frac{\\partial Q}{\\partial x}]$ in the intervals around the expected solution.\n\n- For $x \\in (70, 80)$:\n  - $s=1 (d_1=50)$: $x > d_1 \\implies \\frac{\\partial Q}{\\partial x} = 0$.\n  - $s=2 (d_2=80)$: $d_2-b  x  d_2 \\implies \\frac{\\partial Q}{\\partial x} = -c_m = -150$.\n  - $s=3 (d_3=110)$: $d_3-b-r  x  d_3-b \\implies \\frac{\\partial Q}{\\partial x} = -v_1 = -2000$.\n  The expected derivative of the recourse cost is $\\mathbb{E}[\\frac{\\partial Q}{\\partial x}] = (0.4)(0) + (0.35)(-150) + (0.25)(-2000) = 0 - 52.5 - 500 = -552.5$.\n  So, $\\frac{dZ}{dx} = 500 - 552.5 = -52.5$. The cost is decreasing.\n\n- For $x \\in (80, 110)$:\n  - $s=1 (d_1=50)$: $x > d_1 \\implies \\frac{\\partial Q}{\\partial x} = 0$.\n  - $s=2 (d_2=80)$: $x > d_2 \\implies \\frac{\\partial Q}{\\partial x} = 0$.\n  - $s=3 (d_3=110)$: $d_3-b  x  d_3 \\implies \\frac{\\partial Q}{\\partial x} = -c_m = -150$.\n  The expected derivative of the recourse cost is $\\mathbb{E}[\\frac{\\partial Q}{\\partial x}] = (0.4)(0) + (0.35)(0) + (0.25)(-150) = -37.5$.\n  So, $\\frac{dZ}{dx} = 500 - 37.5 = 462.5$. The cost is increasing.\n\nThe derivative of the total cost function $Z(x)$ changes sign from negative to positive at $x=80$. This indicates that the convex function $Z(x)$ has its minimum at $x^*=80$ MW.\n\nNow, we compute the minimum expected total cost, $Z(x^*)$, at $x^*=80$.\nThe first-stage cost is $k \\cdot x^* = 500 \\times 80 = 40000$.\n\nNext, we compute the recourse cost $Q(80, d_s)$ for each scenario:\n- **Scenario 1 ($d_1=50$):** Since $x^* = 80 \\geq d_1$, demand is fully met. $Q(80, 50) = 0$.\n- **Scenario 2 ($d_2=80$):** Since $x^* = 80 = d_2$, demand is exactly met. $Q(80, 80) = 0$.\n- **Scenario 3 ($d_3=110$):** Since $x^* = 80  d_3$, there is a deficit of $110 - 80 = 30$ MW. This is met by the spot market ($b=30$ MW). The recourse cost is $Q(80, 110) = c_m \\times 30 = 150 \\times 30 = 4500$.\n\nThe expected second-stage cost is:\n$$ \\mathbb{E}[Q(80, d_s)] = \\pi_1 Q(80, 50) + \\pi_2 Q(80, 80) + \\pi_3 Q(80, 110) $$\n$$ \\mathbb{E}[Q(80, d_s)] = (0.4)(0) + (0.35)(0) + (0.25)(4500) = 1125 $$\nThe total expected cost is the sum of the first-stage and expected second-stage costs:\n$$ Z(80) = 40000 + 1125 = 41125 $$\nThe optimal capacity is $x^*=80$ MW, and the associated minimum expected total cost is $41125$ dollars per hour.",
            "answer": "$$ \\boxed{\\begin{pmatrix} 80  41125 \\end{pmatrix}} $$"
        },
        {
            "introduction": "After learning to find the optimal stochastic solution, a critical question arises: how much better is this approach than using simpler deterministic models? This final exercise introduces the Value of the Stochastic Solution (VSS), a key metric that quantifies the economic benefit of the stochastic framework. By calculating the VSS , you will learn to justify the adoption of these sophisticated models by demonstrating their tangible advantage over methods based on a single average forecast.",
            "id": "4125975",
            "problem": "Consider a two-stage capacity expansion and operation model for a single representative hour in an electric power system. In the first stage, a decision-maker chooses installed capacity $y \\ge 0$ (in $\\mathrm{MW}$) for a single thermal technology. The first-stage investment cost is $f y$, where $f$ is the investment cost per unit capacity. In the second stage, once uncertainty is revealed, the system is operated to meet scenario-dependent demand $d_s$ (in $\\mathrm{MW}$), incurring a variable operating cost $v$ per unit of energy produced (in $\\mathrm{MWh}$) and, if capacity is insufficient, a shortage penalty $L$ per unit of unmet demand (in $\\mathrm{MWh}$). The operation cost in scenario $s$ for a chosen capacity $y$ is modeled as $v \\cdot \\min\\{y, d_s\\} + L \\cdot \\max\\{0, d_s - y\\}$, which is a widely used convex recourse function capturing dispatch up to capacity and a linear penalty on unmet demand. The total cost in scenario $s$ is therefore $f y + v \\cdot \\min\\{y, d_s\\} + L \\cdot \\max\\{0, d_s - y\\}$.\n\nThere are three demand scenarios $s \\in \\{1,2,3\\}$ with probabilities $p_1 = 0.2$, $p_2 = 0.5$, and $p_3 = 0.3$. The demands are $d_1 = 90$ $\\mathrm{MW}$, $d_2 = 110$ $\\mathrm{MW}$, and $d_3 = 150$ $\\mathrm{MW}$. The cost parameters are $f = 100$ dollars per $\\mathrm{MW}$, $v = 20$ dollars per $\\mathrm{MWh}$, and $L = 200$ dollars per $\\mathrm{MWh}$. Assume the representative hour scaling so that $\\mathrm{MW}$ and $\\mathrm{MWh}$ coincide over the hour.\n\nThe Stochastic Programming (SP) solution is defined as the first-stage capacity $y^{\\mathrm{SP}}$ that minimizes the expected total cost under the given scenario distribution. The Expected Value (EV) solution is defined by first replacing the uncertain demand with its expectation $\\mathbb{E}[d]$, solving the resulting deterministic problem to obtain $y^{\\mathrm{EV}}$, and then evaluating the expected cost of implementing $y^{\\mathrm{EV}}$ under the original stochastic environment. The Value of the Stochastic Solution (VSS) is the difference between the expected cost of implementing $y^{\\mathrm{EV}}$ in the original stochastic environment and the optimal expected cost under the SP solution.\n\nUsing only the definitions of expected value, convex recourse evaluation through $v \\cdot \\min\\{y, d_s\\} + L \\cdot \\max\\{0, d_s - y\\}$, and the two-stage decision structure described above, determine $y^{\\mathrm{SP}}$ and $y^{\\mathrm{EV}}$, compute their expected total costs under the original scenario distribution, and then compute the Value of the Stochastic Solution (VSS) numerically. Express the final VSS in dollars. No rounding is required; provide the exact value.",
            "solution": "The problem presented is a classic two-stage stochastic programming model for capacity expansion under uncertainty. Before proceeding to the solution, a validation of the problem statement is required.\n\n### Step 1: Extract Givens\n- First-stage decision variable: Installed capacity $y \\ge 0$.\n- First-stage cost coefficient: $f = 100$ dollars per $\\mathrm{MW}$.\n- Second-stage variable operating cost: $v = 20$ dollars per $\\mathrm{MWh}$.\n- Second-stage shortage penalty: $L = 200$ dollars per $\\mathrm{MWh}$.\n- Second-stage cost (recourse function) for scenario $s$: $Q(y, d_s) = v \\cdot \\min\\{y, d_s\\} + L \\cdot \\max\\{0, d_s - y\\}$.\n- Total cost in scenario $s$: $C_s(y) = f y + Q(y, d_s)$.\n- Scenarios for demand $d$:\n  - $s=1$: probability $p_1 = 0.2$, demand $d_1 = 90$ $\\mathrm{MW}$.\n  - $s=2$: probability $p_2 = 0.5$, demand $d_2 = 110$ $\\mathrm{MW}$.\n  - $s=3$: probability $p_3 = 0.3$, demand $d_3 = 150$ $\\mathrm{MW}$.\n- The representative hour scaling implies that energy in $\\mathrm{MWh}$ is numerically equal to power in $\\mathrm{MW}$.\n- The Stochastic Programming (SP) solution, $y^{\\mathrm{SP}}$, minimizes the expected total cost.\n- The Expected Value (EV) solution, $y^{\\mathrm{EV}}$, is the solution to the deterministic problem where uncertain demand $d_s$ is replaced by its expectation $\\mathbb{E}[d]$.\n- The Value of the Stochastic Solution (VSS) is defined as the difference between the expected cost of implementing $y^{\\mathrm{EV}}$ in the stochastic environment and the minimum expected cost of the SP solution.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It represents a standard and fundamental model in the field of operations research and energy systems modeling, specifically two-stage stochastic linear programming. The objective function is convex, the constraints are linear, and all parameters are clearly defined and consistent. There are no scientific flaws, ambiguities, or contradictions. The problem is valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. A detailed solution follows.\n\nThe objective of the stochastic programming problem is to find the capacity $y^{\\mathrm{SP}}$ that minimizes the expected total cost, $C(y)$. The expected total cost is given by:\n$$C(y) = \\mathbb{E}[C_s(y)] = \\mathbb{E}[f y + v \\cdot \\min\\{y, d_s\\} + L \\cdot \\max\\{0, d_s - y\\}]$$\n$$C(y) = f y + \\sum_{s=1}^{3} p_s (v \\cdot \\min\\{y, d_s\\} + L \\cdot \\max\\{0, d_s - y\\})$$\nThis function is convex because it is a sum of a linear function ($f y$) and a weighted sum of convex recourse functions. To find the minimum, we can analyze the subgradient of $C(y)$. The subgradient, $\\partial C(y)$, is given by:\n$$\\partial C(y) = f + \\sum_{s=1}^{3} p_s \\cdot \\partial_y Q(y, d_s)$$\nwhere $\\partial_y Q(y, d_s)$ is the subgradient of the recourse function with respect to $y$. The recourse function $Q(y, d_s)$ is piecewise linear:\n- If $y  d_s$, $Q(y, d_s) = v y + L(d_s - y)$. The derivative is $\\frac{dQ}{dy} = v - L$.\n- If $y > d_s$, $Q(y, d_s) = v d_s$. The derivative is $\\frac{dQ}{dy} = 0$.\n- If $y = d_s$, the function is not differentiable, and the subgradient is the interval $[v-L, 0]$.\n\nThe optimal solution $y^{\\mathrm{SP}}$ must satisfy the optimality condition $0 \\in \\partial C(y^{\\mathrm{SP}})$. The function $C(y)$ is piecewise linear, with points of non-differentiability at the demand levels $d_1=90$, $d_2=110$, and $d_3=150$. The minimum must occur at one of these points. We examine the derivative (slope) of $C(y)$ in the intervals defined by these demand levels. The term $v-L = 20 - 200 = -180$.\n\n- For $y  90$: All $d_s > y$. The derivative is:\n$$C'(y) = f + \\sum_{s=1}^3 p_s(v-L) = 100 + (p_1+p_2+p_3)(v-L) = 100 + (1)(-180) = -80$$\n- For $90  y  110$: $d_1  y$, but $d_2 > y$ and $d_3 > y$. The derivative is:\n$$C'(y) = f + p_2(v-L) + p_3(v-L) = 100 + (0.5+0.3)(-180) = 100 + (0.8)(-180) = 100 - 144 = -44$$\n- For $110  y  150$: $d_1  y$, $d_2  y$, but $d_3 > y$. The derivative is:\n$$C'(y) = f + p_3(v-L) = 100 + (0.3)(-180) = 100 - 54 = 46$$\nThe derivative changes from negative ($-44$) to positive ($46$) as $y$ crosses the point $110$. This indicates that the minimum of the convex function $C(y)$ is at $y=110$.\nThus, the Stochastic Programming (SP) solution is $y^{\\mathrm{SP}} = 110$.\n\nNext, we compute the expected total cost for this solution, which is often denoted as the Recourse Problem (RP) value.\n$$C(y^{\\mathrm{SP}}) = C(110) = \\sum_{s=1}^{3} p_s [f \\cdot 110 + v \\cdot \\min\\{110, d_s\\} + L \\cdot \\max\\{0, d_s - 110\\}]$$\n- Scenario $s=1$ ($d_1=90$): $C_1(110) = 100(110) + 20 \\cdot \\min\\{110, 90\\} + 200 \\cdot \\max\\{0, 90-110\\} = 11000 + 20(90) + 0 = 12800$.\n- Scenario $s=2$ ($d_2=110$): $C_2(110) = 100(110) + 20 \\cdot \\min\\{110, 110\\} + 200 \\cdot \\max\\{0, 110-110\\} = 11000 + 20(110) + 0 = 13200$.\n- Scenario $s=3$ ($d_3=150$): $C_3(110) = 100(110) + 20 \\cdot \\min\\{110, 150\\} + 200 \\cdot \\max\\{0, 150-110\\} = 11000 + 20(110) + 200(40) = 11000 + 2200 + 8000 = 21200$.\nThe expected cost of the SP solution is:\n$$\\mathbb{E}[C(y^{\\mathrm{SP}})] = p_1 C_1(110) + p_2 C_2(110) + p_3 C_3(110) = (0.2)(12800) + (0.5)(13200) + (0.3)(21200)$$\n$$\\mathbb{E}[C(y^{\\mathrm{SP}})] = 2560 + 6600 + 6360 = 15520$$\n\nNow, we determine the Expected Value (EV) solution, $y^{\\mathrm{EV}}$. First, we compute the expected demand $\\mathbb{E}[d]$:\n$$\\mathbb{E}[d] = p_1 d_1 + p_2 d_2 + p_3 d_3 = (0.2)(90) + (0.5)(110) + (0.3)(150) = 18 + 55 + 45 = 118$$\nThe EV problem is the deterministic problem where demand is fixed at $\\mathbb{E}[d]=118$. The cost function is:\n$$C_{\\mathrm{EV}}(y) = f y + v \\cdot \\min\\{y, 118\\} + L \\cdot \\max\\{0, 118 - y\\}$$\nTo minimize this function, we note that if $y  118$, the derivative is $f+v-L = 100+20-200 = -80$, so we should increase $y$. If $y > 118$, the derivative is $f=100$, so we should decrease $y$. The minimum is achieved when capacity exactly meets demand.\nThus, the Expected Value (EV) solution is $y^{\\mathrm{EV}} = 118$.\n\nNext, we evaluate the expected cost of implementing the EV solution $y^{\\mathrm{EV}}=118$ in the original stochastic environment. This is often called the Expected value of the EV solution (EEV).\n$$C(y^{\\mathrm{EV}}) = C(118) = \\sum_{s=1}^{3} p_s [f \\cdot 118 + v \\cdot \\min\\{118, d_s\\} + L \\cdot \\max\\{0, d_s - 118\\}]$$\n- Scenario $s=1$ ($d_1=90$): $C_1(118) = 100(118) + 20 \\cdot \\min\\{118, 90\\} + 200 \\cdot \\max\\{0, 90-118\\} = 11800 + 20(90) + 0 = 13600$.\n- Scenario $s=2$ ($d_2=110$): $C_2(118) = 100(118) + 20 \\cdot \\min\\{118, 110\\} + 200 \\cdot \\max\\{0, 110-118\\} = 11800 + 20(110) + 0 = 14000$.\n- Scenario $s=3$ ($d_3=150$): $C_3(118) = 100(118) + 20 \\cdot \\min\\{118, 150\\} + 200 \\cdot \\max\\{0, 150-118\\} = 11800 + 20(118) + 200(32) = 11800 + 2360 + 6400 = 20560$.\nThe expected cost of the EV solution is:\n$$\\mathbb{E}[C(y^{\\mathrm{EV}})] = p_1 C_1(118) + p_2 C_2(118) + p_3 C_3(118) = (0.2)(13600) + (0.5)(14000) + (0.3)(20560)$$\n$$\\mathbb{E}[C(y^{\\mathrm{EV}})] = 2720 + 7000 + 6168 = 15888$$\n\nFinally, the Value of the Stochastic Solution (VSS) is the difference between the expected cost of the EV solution and the expected cost of the SP solution.\n$$\\text{VSS} = \\mathbb{E}[C(y^{\\mathrm{EV}})] - \\mathbb{E}[C(y^{\\mathrm{SP}})]$$\n$$\\text{VSS} = 15888 - 15520 = 368$$\nThe VSS is $368$ dollars, representing the economic benefit of considering the full uncertainty distribution when making the capacity investment decision, as opposed to using only the expected value of the demand.",
            "answer": "$$\\boxed{368}$$"
        }
    ]
}