{
    "hands_on_practices": [
        {
            "introduction": "The Progressive Hedging (PH) algorithm can seem abstract at first, with its iterative updates of scenario-specific decisions and multipliers. This first practice exercise is designed to make the core mechanics of PH concrete by walking you through a single, complete iteration. By manually solving the scenario subproblems for a small-scale energy system and computing the updated consensus variable, you will gain a tangible understanding of how the algorithm balances individual scenario costs with the need for consensus. ",
            "id": "4114574",
            "problem": "Consider a two-stage stochastic operations model for a small energy system with two thermal generators indexed by $j \\in \\{1,2\\}$ and two scenarios indexed by $s \\in \\{1,2\\}$ with probabilities $p_{1} = 0.7$ and $p_{2} = 0.3$. The first-stage decision is a scenario-independent day-ahead base generation vector $u = (u_{1}, u_{2})$ in megawatts (MW), enforced by nonanticipativity across scenarios. Under Progressive Hedging (PH), scenario-specific copies $u_{s} = (u_{1,s}, u_{2,s})$ are introduced for decomposition, and nonanticipativity is enforced via an augmented Lagrangian with penalty parameter $\\rho$.\n\nEach scenario has a quadratic operating cost for the base generation plan,\n$$\nf_{s}(u_{s}) \\;=\\; \\sum_{j=1}^{2} \\left( \\frac{1}{2}\\,\\alpha_{j,s}\\,u_{j,s}^{2} \\;+\\; \\beta_{j,s}\\,u_{j,s} \\right),\n$$\nsubject to generator capacity bounds $0 \\leq u_{j,s} \\leq U_{j}$. For physical plausibility, take $U_{1} = 100$ and $U_{2} = 80$ megawatts, and the scenario coefficients:\n$$\n\\alpha_{1,1} = 2,\\;\\; \\beta_{1,1} = 10;\\quad \\alpha_{2,1} = 4,\\;\\; \\beta_{2,1} = 8; \\\\\n\\alpha_{1,2} = 3,\\;\\; \\beta_{1,2} = 6;\\quad \\alpha_{2,2} = 1,\\;\\; \\beta_{2,2} = 5.\n$$\nAssume the PH penalty parameter is $\\rho = 2$, the initial multipliers are $\\lambda_{1}^{0} = (0,0)$ and $\\lambda_{2}^{0} = (0,0)$, and the initial averaged plan is $\\bar{u}^{0} = (20, 30)$ megawatts. Perform one iteration of Progressive Hedging from iteration $k=0$ to $k=1$: for each scenario $s$, solve the PH scenario subproblem that augments $f_{s}(u_{s})$ with the penalty term that pulls $u_{s}$ toward $\\bar{u}^{0}$ and with the current multipliers $\\lambda_{s}^{0}$, subject to the given bounds. Assume the unconstrained minimizers are interior (i.e., they satisfy the bounds without projection). Then, compute the new probability-weighted nonanticipativity average\n$$\n\\bar{u}^{1} \\;=\\; \\sum_{s=1}^{2} p_{s}\\,u_{s}^{1},\n$$\nwhere $u_{s}^{1}$ denotes the scenario solutions obtained in this iteration. Express the final answer as a two-entry row vector giving the components of $\\bar{u}^{1}$ in megawatts. Provide the components in exact simplified fractional form; do not round.",
            "solution": "The problem is first validated against the established criteria.\n\n### Problem Validation\n\n**Step 1: Extracted Givens**\n- **Model:** A two-stage stochastic operations model.\n- **Generators:** Indexed by $j \\in \\{1,2\\}$.\n- **Scenarios:** Indexed by $s \\in \\{1,2\\}$.\n- **Scenario Probabilities:** $p_{1} = 0.7$ and $p_{2} = 0.3$.\n- **First-Stage Decision:** Scenario-independent generation vector $u = (u_{1}, u_{2})$.\n- **Progressive Hedging (PH) Algorithm:**\n  - Scenario-specific decision copies: $u_{s} = (u_{1,s}, u_{2,s})$.\n  - Penalty parameter: $\\rho = 2$.\n- **Scenario Cost Function:** $f_{s}(u_{s}) = \\sum_{j=1}^{2} \\left( \\frac{1}{2}\\,\\alpha_{j,s}\\,u_{j,s}^{2} + \\beta_{j,s}\\,u_{j,s} \\right)$.\n- **Generator Capacity Bounds:** $0 \\leq u_{j,s} \\leq U_{j}$, with $U_{1} = 100$ MW and $U_{2} = 80$ MW.\n- **Cost Coefficients:**\n  - For $s=1$: $\\alpha_{1,1} = 2$, $\\beta_{1,1} = 10$; $\\alpha_{2,1} = 4$, $\\beta_{2,1} = 8$.\n  - For $s=2$: $\\alpha_{1,2} = 3$, $\\beta_{1,2} = 6$; $\\alpha_{2,2} = 1$, $\\beta_{2,2} = 5$.\n- **Initial Conditions (Iteration $k=0$):**\n  - Multipliers: $\\lambda_{1}^{0} = (0,0)$ and $\\lambda_{2}^{0} = (0,0)$.\n  - Averaged plan: $\\bar{u}^{0} = (20, 30)$.\n- **Task:** Perform one PH iteration to compute the subproblem solutions $u_{s}^{1}$ for $s=1,2$ and then calculate the new probability-weighted average $\\bar{u}^{1} = \\sum_{s=1}^{2} p_{s}\\,u_{s}^{1}$.\n- **Assumption:** The unconstrained minimizers of the subproblems are interior to the capacity bounds.\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is scientifically grounded, employing standard methods from stochastic optimization (Progressive Hedging) applied to energy systems modeling (quadratic generator costs). It is well-posed, with convex quadratic objective functions and linear constraints, guaranteeing unique solutions for the subproblems. All necessary data and conditions are provided, and there are no internal contradictions. The numerical values are physically plausible for the context. The problem is objective, formalizable, and verifiable.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be provided.\n\n### Solution\n\nThe Progressive Hedging (PH) algorithm decomposes a stochastic optimization problem by scenario. For each scenario $s$, a subproblem is solved. At iteration $k+1$, the subproblem for scenario $s$ is to find the decision vector $u_s^{k+1}$ that minimizes the augmented Lagrangian function:\n$$ u_{s}^{k+1} = \\arg\\min_{u_{s} \\in C_{s}} \\left\\{ f_{s}(u_{s}) + (\\lambda_{s}^{k})^{T} u_{s} + \\frac{\\rho}{2} \\| u_{s} - \\bar{u}^{k} \\|_{2}^{2} \\right\\} $$\nwhere $C_s$ represents the feasible set for scenario $s$, which in this case is defined by the generator capacity bounds $0 \\leq u_{j,s} \\leq U_{j}$.\n\nWe are asked to perform one iteration, starting from $k=0$ to find $\\bar{u}^1$. The objective function for scenario $s$ to be minimized is:\n$$ L_s(u_s) = f_{s}(u_{s}) + (\\lambda_{s}^{0})^{T} u_{s} + \\frac{\\rho}{2} \\| u_{s} - \\bar{u}^{0} \\|_{2}^{2} $$\nGiven that the initial multipliers are zero vectors, $\\lambda_s^0 = (0,0)$, the term $(\\lambda_{s}^{0})^{T} u_{s}$ is zero. The objective function simplifies to:\n$$ L_s(u_s) = \\sum_{j=1}^{2} \\left( \\frac{1}{2}\\,\\alpha_{j,s}\\,u_{j,s}^{2} + \\beta_{j,s}\\,u_{j,s} \\right) + \\frac{\\rho}{2} \\sum_{j=1}^{2} (u_{j,s} - \\bar{u}_{j}^{0})^{2} $$\nThis objective is separable with respect to the generator index $j$. Thus, for each scenario $s$ and each generator $j$, we can solve an independent one-dimensional optimization problem:\n$$ \\min_{u_{j,s}} \\left\\{ J_{j,s}(u_{j,s}) = \\frac{1}{2}\\,\\alpha_{j,s}\\,u_{j,s}^{2} + \\beta_{j,s}\\,u_{j,s} + \\frac{\\rho}{2} (u_{j,s} - \\bar{u}_{j}^{0})^{2} \\right\\} $$\nsubject to $0 \\leq u_{j,s} \\leq U_{j}$.\n\nThe objective function $J_{j,s}(u_{j,s})$ is a strictly convex quadratic function since $\\alpha_{j,s} > 0$ and $\\rho > 0$. Its unconstrained minimizer is found by setting its first derivative with respect to $u_{j,s}$ to zero:\n$$ \\frac{dJ_{j,s}}{du_{j,s}} = \\alpha_{j,s}\\,u_{j,s} + \\beta_{j,s} + \\rho(u_{j,s} - \\bar{u}_{j}^{0}) = 0 $$\nSolving for $u_{j,s}$ gives the solution for the scenario subproblem at this iteration, denoted $u_{j,s}^1$:\n$$ (\\alpha_{j,s} + \\rho)u_{j,s}^1 = \\rho\\,\\bar{u}_{j}^{0} - \\beta_{j,s} \\implies u_{j,s}^{1} = \\frac{\\rho\\,\\bar{u}_{j}^{0} - \\beta_{j,s}}{\\alpha_{j,s} + \\rho} $$\nThe problem states to assume this unconstrained solution is interior, i.e., it lies within the bounds $[0, U_j]$. We will verify this assumption after calculation. We use the given values: $\\rho = 2$ and $\\bar{u}^{0} = (20, 30)$.\n\n**Scenario $s=1$:**\n- For generator $j=1$: $\\alpha_{1,1}=2$, $\\beta_{1,1}=10$, $\\bar{u}_1^0=20$.\n  $$ u_{1,1}^{1} = \\frac{2 \\cdot 20 - 10}{2 + 2} = \\frac{40 - 10}{4} = \\frac{30}{4} = \\frac{15}{2} $$\n- For generator $j=2$: $\\alpha_{2,1}=4$, $\\beta_{2,1}=8$, $\\bar{u}_2^0=30$.\n  $$ u_{2,1}^{1} = \\frac{2 \\cdot 30 - 8}{4 + 2} = \\frac{60 - 8}{6} = \\frac{52}{6} = \\frac{26}{3} $$\nThe solution for scenario $1$ is $u_1^1 = (\\frac{15}{2}, \\frac{26}{3})$. Verification of bounds: $0 \\leq \\frac{15}{2} \\leq 100$ and $0 \\leq \\frac{26}{3} \\leq 80$. Both are true.\n\n**Scenario $s=2$:**\n- For generator $j=1$: $\\alpha_{1,2}=3$, $\\beta_{1,2}=6$, $\\bar{u}_1^0=20$.\n  $$ u_{1,2}^{1} = \\frac{2 \\cdot 20 - 6}{3 + 2} = \\frac{40 - 6}{5} = \\frac{34}{5} $$\n- For generator $j=2$: $\\alpha_{2,2}=1$, $\\beta_{2,2}=5$, $\\bar{u}_2^0=30$.\n  $$ u_{2,2}^{1} = \\frac{2 \\cdot 30 - 5}{1 + 2} = \\frac{60 - 5}{3} = \\frac{55}{3} $$\nThe solution for scenario $2$ is $u_2^1 = (\\frac{34}{5}, \\frac{55}{3})$. Verification of bounds: $0 \\leq \\frac{34}{5} \\leq 100$ and $0 \\leq \\frac{55}{3} \\leq 80$. Both are true. The assumption holds.\n\nThe final step is to compute the new probability-weighted average plan, $\\bar{u}^1$:\n$$ \\bar{u}^{1} = \\sum_{s=1}^{2} p_{s}\\,u_{s}^{1} = p_{1}\\,u_{1}^{1} + p_{2}\\,u_{2}^{1} $$\nUsing $p_1 = 0.7 = \\frac{7}{10}$ and $p_2 = 0.3 = \\frac{3}{10}$, we compute the components of $\\bar{u}^1 = (\\bar{u}_1^1, \\bar{u}_2^1)$ separately.\n\n- Component $\\bar{u}_1^1$:\n  $$ \\bar{u}_{1}^{1} = p_{1}\\,u_{1,1}^{1} + p_{2}\\,u_{1,2}^{1} = \\frac{7}{10} \\cdot \\frac{15}{2} + \\frac{3}{10} \\cdot \\frac{34}{5} $$\n  $$ \\bar{u}_{1}^{1} = \\frac{105}{20} + \\frac{102}{50} = \\frac{21}{4} + \\frac{51}{25} $$\n  $$ \\bar{u}_{1}^{1} = \\frac{21 \\cdot 25}{4 \\cdot 25} + \\frac{51 \\cdot 4}{25 \\cdot 4} = \\frac{525}{100} + \\frac{204}{100} = \\frac{729}{100} $$\n\n- Component $\\bar{u}_2^1$:\n  $$ \\bar{u}_{2}^{1} = p_{1}\\,u_{2,1}^{1} + p_{2}\\,u_{2,2}^{1} = \\frac{7}{10} \\cdot \\frac{26}{3} + \\frac{3}{10} \\cdot \\frac{55}{3} $$\n  $$ \\bar{u}_{2}^{1} = \\frac{182}{30} + \\frac{165}{30} = \\frac{182 + 165}{30} = \\frac{347}{30} $$\n\nThe updated average generation plan after one iteration is $\\bar{u}^1 = (\\frac{729}{100}, \\frac{347}{30})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{729}{100} & \\frac{347}{30}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having practiced the mechanics of a single Progressive Hedging iteration, we now turn to a critical aspect of its behavior: the role of the penalty parameter $\\rho$. This parameter is not just a numerical detail; it governs the entire dynamic of the algorithm. Through a thought experiment involving the limiting cases of $\\rho \\to 0$ and $\\rho \\to \\infty$, you will derive how $\\rho$ controls the balance between respecting individual scenario optima and enforcing nonanticipativity, revealing the theoretical underpinnings of the method. ",
            "id": "4114638",
            "problem": "Consider a two-scenario stochastic energy procurement model with a single first-stage decision variable $q \\in \\mathbb{R}$ that must be identical across scenarios by nonanticipativity. Scenario $s \\in \\{1,2\\}$ occurs with known probability $p_{s} \\in (0,1)$ and has a convex quadratic operational cost\n$$\nF_{s}(q) \\;=\\; \\frac{1}{2} a_{s} q^{2} + b_{s} q,\n$$\nwhere $a_{s} \\in \\mathbb{R}_{>0}$ and $b_{s} \\in \\mathbb{R}$ are given coefficients, and $p_{1}+p_{2}=1$. To enforce nonanticipativity via scenario decomposition, apply Progressive Hedging (PH), which duplicates $q$ as $(q_{1},q_{2})$ and couples the copies by a consensus variable $z \\in \\mathbb{R}$ and scenario multipliers $(u_{1},u_{2}) \\in \\mathbb{R}^{2}$ with a quadratic penalty parameter $\\rho \\in \\mathbb{R}_{>0}$. At iteration $k \\in \\mathbb{N}$, PH solves, for each $s \\in \\{1,2\\}$, the unconstrained subproblem\n$$\n\\min_{q_{s} \\in \\mathbb{R}} \\; F_{s}(q_{s}) \\;+\\; u_{s}^{k}\\left(q_{s}-z^{k}\\right) \\;+\\; \\frac{\\rho}{2}\\left(q_{s}-z^{k}\\right)^{2},\n$$\nthen sets the consensus update by probability-weighted averaging\n$$\nz^{k+1} \\;=\\; p_{1} q_{1}^{k+1} \\;+\\; p_{2} q_{2}^{k+1},\n$$\nand updates multipliers by\n$$\nu_{s}^{k+1} \\;=\\; u_{s}^{k} \\;+\\; \\rho \\left(q_{s}^{k+1} - z^{k+1}\\right).\n$$\nAssume the standard initialization $u_{1}^{0}=u_{2}^{0}=0$ and an arbitrary $z^{0} \\in \\mathbb{R}$, and consider the first PH iteration $(k=0 \\to 1)$. Starting from first principles of convex optimization optimality for the scenario subproblems and the stated PH update rules, derive a closed-form expression for $z^{1}$ as a function of $\\rho$, $a_{1}$, $a_{2}$, $b_{1}$, $b_{2}$, $p_{1}$, $p_{2}$, and $z^{0}$. Then, compute the two limiting values\n$$\n\\lim_{\\rho \\to 0} z^{1}\n\\quad \\text{and} \\quad\n\\lim_{\\rho \\to \\infty} z^{1},\n$$\nand interpret these limits in terms of independent scenario solutions versus projection onto the nonanticipativity consensus set.\n\nProvide your final answer as a single row containing the two closed-form limits in the order $\\left(\\lim_{\\rho \\to 0} z^{1}, \\; \\lim_{\\rho \\to \\infty} z^{1}\\right)$. No rounding is required, and no units are necessary. Your answer must be a single analytic expression.",
            "solution": "The problem asks for the derivation of the first-iteration consensus variable $z^{1}$ in a Progressive Hedging (PH) scheme for a two-scenario stochastic program, and the evaluation of its limits as the penalty parameter $\\rho$ approaches zero and infinity.\n\n### Step 1: Solving the Scenario Subproblems\nThe PH algorithm begins at iteration $k=0$ with an initial consensus variable $z^{0} \\in \\mathbb{R}$ and initial multipliers $u_{1}^{0}=0$ and $u_{2}^{0}=0$. For each scenario $s \\in \\{1,2\\}$, we solve an unconstrained subproblem to find $q_{s}^{1}$. The subproblem for scenario $s$ is:\n$$\n\\min_{q_{s} \\in \\mathbb{R}} \\; F_{s}(q_{s}) \\;+\\; u_{s}^{0}\\left(q_{s}-z^{0}\\right) \\;+\\; \\frac{\\rho}{2}\\left(q_{s}-z^{0}\\right)^{2}\n$$\nGiven the cost function $F_{s}(q_{s}) = \\frac{1}{2} a_{s} q_{s}^{2} + b_{s} q_{s}$ and the initialization $u_{s}^{0}=0$, the objective function for the subproblem, which we denote as $L_{s}(q_{s})$, simplifies to:\n$$\nL_{s}(q_{s}) = \\frac{1}{2} a_{s} q_{s}^{2} + b_{s} q_{s} + \\frac{\\rho}{2}\\left(q_{s}-z^{0}\\right)^{2}\n$$\nThis is an unconstrained convex optimization problem. The objective function $L_{s}(q_{s})$ is strictly convex in $q_{s}$ because the coefficients $a_{s}$ and $\\rho$ are given as strictly positive ($a_{s} \\in \\mathbb{R}_{>0}$, $\\rho \\in \\mathbb{R}_{>0}$). The unique minimum is found by applying the first-order optimality condition, i.e., setting the derivative of $L_{s}(q_{s})$ with respect to $q_{s}$ equal to zero.\n$$\n\\frac{d L_{s}}{d q_{s}} = \\frac{d}{d q_{s}} \\left( \\frac{1}{2} a_{s} q_{s}^{2} + b_{s} q_{s} + \\frac{\\rho}{2}(q_{s}^{2} - 2q_{s}z^{0} + (z^{0})^{2}) \\right) = 0\n$$\n$$\na_{s} q_{s} + b_{s} + \\rho(q_{s}-z^{0}) = 0\n$$\nLet $q_{s}^{1}$ be the solution to this equation. We rearrange the terms to solve for $q_{s}^{1}$:\n$$\n(a_{s} + \\rho) q_{s}^{1} + b_{s} - \\rho z^{0} = 0\n$$\n$$\n(a_{s} + \\rho) q_{s}^{1} = \\rho z^{0} - b_{s}\n$$\n$$\nq_{s}^{1} = \\frac{\\rho z^{0} - b_{s}}{a_{s} + \\rho}\n$$\nThis provides the optimal solution for each scenario-specific subproblem at the first iteration.\n\n### Step 2: Updating the Consensus Variable\nThe next step in the PH algorithm is to update the consensus variable $z$ by computing the probability-weighted average of the individual scenario solutions $q_{s}^{1}$. The update rule for $z^{1}$ is:\n$$\nz^{1} = p_{1} q_{1}^{1} + p_{2} q_{2}^{1}\n$$\nSubstituting the expressions for $q_{1}^{1}$ and $q_{2}^{1}$ derived in the previous step:\n$$\nz^{1} = p_{1} \\left( \\frac{\\rho z^{0} - b_{1}}{a_{1} + \\rho} \\right) + p_{2} \\left( \\frac{\\rho z^{0} - b_{2}}{a_{2} + \\rho} \\right)\n$$\nThis is the required closed-form expression for $z^{1}$.\n\n### Step 3: Computing the Limit as $\\rho \\to 0$\nWe first compute the limit of $z^{1}$ as $\\rho$ approaches $0$. Since $\\rho$ is defined as a positive parameter, we implicitly consider the limit from the right, $\\rho \\to 0^{+}$. The expression for $z^{1}$ is a rational function of $\\rho$. Since $a_{s} > 0$, the denominators $a_{s}+\\rho$ are non-zero at $\\rho=0$. Thus, the limit can be found by direct substitution of $\\rho=0$:\n$$\n\\lim_{\\rho \\to 0} z^{1} = \\lim_{\\rho \\to 0} \\left[ p_{1} \\left( \\frac{\\rho z^{0} - b_{1}}{a_{1} + \\rho} \\right) + p_{2} \\left( \\frac{\\rho z^{0} - b_{2}}{a_{2} + \\rho} \\right) \\right]\n$$\n$$\n\\lim_{\\rho \\to 0} z^{1} = p_{1} \\left( \\frac{0 \\cdot z^{0} - b_{1}}{a_{1} + 0} \\right) + p_{2} \\left( \\frac{0 \\cdot z^{0} - b_{2}}{a_{2} + 0} \\right) = p_{1} \\left( \\frac{-b_{1}}{a_{1}} \\right) + p_{2} \\left( \\frac{-b_{2}}{a_{2}} \\right)\n$$\n$$\n\\lim_{\\rho \\to 0} z^{1} = -\\left(\\frac{p_{1} b_{1}}{a_{1}} + \\frac{p_{2} b_{2}}{a_{2}}\\right)\n$$\nThis limit has a clear interpretation. The quantity $q_{s}^{*} = -b_{s}/a_{s}$ is the solution to $\\min_{q} F_{s}(q)$, i.e., the optimal decision if scenario $s$ were to occur with certainty. Thus, as the penalty for non-consensus vanishes ($\\rho \\to 0$), the subproblems become decoupled minimizations of the original scenario costs. The resulting consensus variable $z^{1}$ is the probability-weighted average of the independent, scenario-optimal solutions. This represents a projection of the vector of individual optima, $(q_{1}^{*}, q_{2}^{*})$, onto the nonanticipativity consensus set.\n\n### Step 4: Computing the Limit as $\\rho \\to \\infty$\nNext, we compute the limit of $z^{1}$ as $\\rho \\to \\infty$. To evaluate this limit, we can analyze the asymptotic behavior of each term in the expression for $z^{1}$. We divide the numerator and denominator of each fraction by $\\rho$:\n$$\nz^{1} = p_{1} \\left( \\frac{z^{0} - \\frac{b_{1}}{\\rho}}{\\frac{a_{1}}{\\rho} + 1} \\right) + p_{2} \\left( \\frac{z^{0} - \\frac{b_{2}}{\\rho}}{\\frac{a_{2}}{\\rho} + 1} \\right)\n$$\nNow, we take the limit as $\\rho \\to \\infty$. As $\\rho \\to \\infty$, the terms $\\frac{b_{s}}{\\rho}$ and $\\frac{a_{s}}{\\rho}$ both approach $0$.\n$$\n\\lim_{\\rho \\to \\infty} z^{1} = \\lim_{\\rho \\to \\infty} \\left[ p_{1} \\left( \\frac{z^{0} - \\frac{b_{1}}{\\rho}}{\\frac{a_{1}}{\\rho} + 1} \\right) + p_{2} \\left( \\frac{z^{0} - \\frac{b_{2}}{\\rho}}{\\frac{a_{2}}{\\rho} + 1} \\right) \\right]\n$$\n$$\n\\lim_{\\rho \\to \\infty} z^{1} = p_{1} \\left( \\frac{z^{0} - 0}{0 + 1} \\right) + p_{2} \\left( \\frac{z^{0} - 0}{0 + 1} \\right) = p_{1}z^{0} + p_{2}z^{0}\n$$\nUsing the fact that $p_{1} + p_{2} = 1$:\n$$\n\\lim_{\\rho \\to \\infty} z^{1} = (p_{1} + p_{2}) z^{0} = 1 \\cdot z^{0} = z^{0}\n$$\nThis result shows that as the penalty parameter $\\rho$ becomes infinitely large, the term $\\frac{\\rho}{2}(q_{s} - z^{0})^{2}$ dominates the subproblem objective. Minimizing this dominant term requires forcing $q_{s}^{1}$ to be equal to $z^{0}$. Consequently, the updated consensus variable $z^{1}$, being an average of values all equal to $z^{0}$, is simply $z^{0}$. In this regime, the algorithm fails to make progress from the initial consensus guess, as the penalty for deviating from it is overwhelming. The projection onto the consensus set is trivial, as the subproblem solutions are already forced to agree with the initial consensus value.\n\nThe two limiting values are thus $-\\left(\\frac{p_{1} b_{1}}{a_{1}} + \\frac{p_{2} b_{2}}{a_{2}}\\right)$ and $z^{0}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\left(\\frac{p_{1} b_{1}}{a_{1}} + \\frac{p_{2} b_{2}}{a_{2}}\\right) & z^{0}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Our exploration so far has been in the realm of convex problems, but many real-world energy decisions, such as unit commitment, are binary. This practice extends our analysis of the penalty parameter $\\rho$ into the non-convex domain of mixed-integer programming, where its effects can be dramatically different and sometimes counterintuitive. You will analyze a stochastic unit commitment problem to see how an overly large $\\rho$ can force the algorithm into a premature and suboptimal consensus, a critical pitfall to understand when applying Progressive Hedging in practice. ",
            "id": "4114608",
            "problem": "Consider a two-stage stochastic unit commitment model for a single thermal generator in an energy system. The stage-$0$ commitment decision is binary $x \\in \\{0,1\\}$, where $x=1$ means the generator is committed (available) and $x=0$ means it is not committed. In scenario $s \\in \\{1,2\\}$ with probability $p_s$, the stage-$1$ dispatch decision $q^s \\in [0,Q]$ incurs variable cost $c q^s$. If demand $D^s$ is not fully met, a shortage penalty of $U$ per megawatt-hour is paid on the unmet quantity. The generator has capacity $Q$ and a fixed cost $F$ when committed. Assume $Q \\ge \\max\\{D^1, D^2\\}$ and $c < U$. Under these conditions, if $x=1$ then the optimal dispatch sets $q^s = D^s$ and the scenario cost is $C_s(1) = F + c D^s$, while if $x=0$ then $q^s = 0$ and the scenario cost is $C_s(0) = U D^s$.\n\nNonanticipativity requires the stage-$0$ decision to be the same across scenarios. The Progressive Hedging (PH) algorithm enforces nonanticipativity by iterating over scenario subproblems with an augmented Lagrangian. At iteration $k$, with scenario multipliers $w_s^k$ and current probability-weighted average $\\bar x^k = \\sum_s p_s x_s^k$, the PH scenario subproblem for $s$ chooses $x_s^{k+1} \\in \\{0,1\\}$ by minimizing\n$$\nC_s(x_s) + w_s^k x_s + \\frac{\\rho}{2}\\left(x_s - \\bar x^k\\right)^2,\n$$\nand then updates $\\bar x^{k+1} = \\sum_s p_s x_s^{k+1}$ and $w_s^{k+1} = w_s^k + \\rho\\left(x_s^{k+1} - \\bar x^{k+1}\\right)$.\n\nTake numerical values $F = 3000$, $c = 50$, $U = 200$, $D^1 = 100$, $D^2 = 15$, $p_1 = 0.4$, $p_2 = 0.6$, and $Q \\ge 100$. Consider a PH iteration with $w_1^k = w_2^k = 0$ and $\\bar x^k = 0$. Using first principles and the definitions above:\n\n- Derive how the penalty parameter $\\rho$ interacts with the binary commitment decision via the quadratic proximal term, and express the proximal penalty difference between choosing $x_s=1$ versus $x_s=0$ as a function of $\\rho$ and $\\bar x^k$.\n- Determine the true nonanticipative optimal commitment $x$ and its expected cost.\n- Show under what threshold on $\\rho$ a scenario with $C_s(1) - C_s(0) < 0$ would nevertheless choose $x_s^{k+1}=0$ when $\\bar x^k=0$, and explain why overly large $\\rho$ can force premature consensus to a suboptimal integer pattern in PH for mixed-integer decisions.\n\nWhich of the following statements are correct?\n\nA. With $\\bar x^k = 0$, scenario $1$ chooses $x_1^{k+1} = 0$ if $\\rho > 12000$, forcing consensus at $x=0$ even though the expected optimal is $x=1$.\n\nB. For binary $x \\in \\{0,1\\}$, the difference in Progressive Hedging proximal penalties between choosing $x=1$ versus $x=0$ at a given $\\bar x$ equals $\\frac{\\rho}{2}\\left(1 - 2\\bar x\\right)$, which acts as a scenario-independent switching cost added to the scenario objective.\n\nC. With the given data, the expected nonanticipative optimum is $x=1$ with expected cost $5450$, but with $\\bar x^k = 0$ and $\\rho = 30000$, the PH scenario subproblems select $x_s^{k+1} = 0$ for both scenarios, yielding a premature consensus at a suboptimal integer pattern.\n\nD. The Progressive Hedging penalty term is $\\rho\\,\\lvert x_s - \\bar x^k\\rvert$, so for binary $x$ its effect is the same for $\\bar x^k=0$ and $\\bar x^k=1$.\n\nE. In Progressive Hedging with mixed-integer decisions, taking $\\rho \\to \\infty$ guarantees convergence to the globally optimal nonanticipative solution because the penalty neutralizes all bias.\n\nSelect all that apply.",
            "solution": "The user has provided a problem statement regarding the Progressive Hedging (PH) algorithm applied to a two-stage stochastic unit commitment problem. The task is to validate the problem, derive the solution from first principles, and evaluate the given options.\n\n### Problem Validation\n\nFirst, I will extract the givens and validate the problem statement.\n\n**Step 1: Extract Givens**\n- **Model:** Two-stage stochastic unit commitment for a single thermal generator.\n- **Stage-0 Decision:** Binary commitment $x \\in \\{0, 1\\}$.\n- **Scenarios:** $s \\in \\{1, 2\\}$ with probabilities $p_s$.\n- **Stage-1 Decision:** Dispatch quantity $q^s \\in [0, Q]$.\n- **Costs:** Variable cost $c q^s$, shortage penalty $U$ per MWh on unmet demand, fixed cost $F$ if $x=1$.\n- **Parameters:** Capacity $Q$, demand $D^s$.\n- **Assumptions:** $Q \\ge \\max\\{D^1, D^2\\}$, $c < U$.\n- **Derived Scenario Costs:**\n    - If $x=1$, cost is $C_s(1) = F + c D^s$.\n    - If $x=0$, cost is $C_s(0) = U D^s$.\n- **Progressive Hedging (PH) Algorithm:**\n    - **Subproblem for scenario $s$ at iteration $k+1$:** Choose $x_s^{k+1} \\in \\{0, 1\\}$ to minimize $C_s(x_s) + w_s^k x_s + \\frac{\\rho}{2}(x_s - \\bar{x}^k)^2$.\n    - **Variable Updates:**\n        - $\\bar{x}^{k+1} = \\sum_s p_s x_s^{k+1}$\n        - $w_s^{k+1} = w_s^k + \\rho(x_s^{k+1} - \\bar{x}^{k+1})$\n- **Numerical Data:**\n    - $F = 3000$\n    - $c = 50$\n    - $U = 200$\n    - $D^1 = 100$\n    - $D^2 = 15$\n    - $p_1 = 0.4$\n    - $p_2 = 0.6$\n    - $Q \\ge 100$\n- **Initial PH State:** $w_1^k = w_2^k = 0$, $\\bar{x}^k = 0$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, being a standard application of the Progressive Hedging algorithm to a well-known problem in energy systems modeling (stochastic unit commitment). The assumptions ($c < U$) are standard and ensure the dispatch logic is straightforward (it is always cheaper to produce than to incur a penalty). The provided cost functions $C_s(x)$ are correct derivations from these assumptions. The mathematical formulation of the PH algorithm is standard. The problem is well-posed, objective, and self-contained with no contradictions.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. I will proceed with the derivation and analysis.\n\n### Solution Derivation\n\nThe solution will be developed in three parts: first, determining the true optimal nonanticipative solution; second, analyzing the behavior of the PH algorithm for the given iteration; and third, evaluating each option.\n\n**Part 1: True Nonanticipative Optimum**\n\nThe true problem is to find $x \\in \\{0, 1\\}$ that minimizes the expected cost, $\\mathbb{E}[C(x)] = \\sum_s p_s C_s(x)$.\n\nFirst, calculate the scenario costs $C_s(x)$ for $x \\in \\{0, 1\\}$ and $s \\in \\{1, 2\\}$ using the given data:\n- $F = 3000$, $c = 50$, $U = 200$, $D^1 = 100$, $D^2 = 15$.\n\nFor scenario $s=1$:\n- Cost if committed ($x=1$): $C_1(1) = F + c D^1 = 3000 + 50 \\times 100 = 3000 + 5000 = 8000$.\n- Cost if not committed ($x=0$): $C_1(0) = U D^1 = 200 \\times 100 = 20000$.\n\nFor scenario $s=2$:\n- Cost if committed ($x=1$): $C_2(1) = F + c D^2 = 3000 + 50 \\times 15 = 3000 + 750 = 3750$.\n- Cost if not committed ($x=0$): $C_2(0) = U D^2 = 200 \\times 15 = 3000$.\n\nNext, calculate the expected cost for each nonanticipative decision $x \\in \\{0, 1\\}$ using probabilities $p_1 = 0.4$ and $p_2 = 0.6$:\n- Expected cost for $x=1$:\n$$ \\mathbb{E}[C(1)] = p_1 C_1(1) + p_2 C_2(1) = 0.4 \\times 8000 + 0.6 \\times 3750 = 3200 + 2250 = 5450 $$\n- Expected cost for $x=0$:\n$$ \\mathbb{E}[C(0)] = p_1 C_1(0) + p_2 C_2(0) = 0.4 \\times 20000 + 0.6 \\times 3000 = 8000 + 1800 = 9800 $$\n\nComparing the expected costs, $\\mathbb{E}[C(1)] = 5450 < \\mathbb{E}[C(0)] = 9800$. Therefore, the true nonanticipative optimal commitment decision is $x=1$, with an expected cost of $5450$.\n\n**Part 2: Analysis of the Progressive Hedging Iteration**\n\nThe PH scenario subproblem for scenario $s$ aims to find $x_s^{k+1} \\in \\{0, 1\\}$ that minimizes the augmented cost function:\n$$ J_s(x_s) = C_s(x_s) + w_s^k x_s + \\frac{\\rho}{2}(x_s - \\bar{x}^k)^2 $$\nWe are given the state at the start of the iteration: $w_1^k = 0$, $w_2^k = 0$, and $\\bar{x}^k = 0$. The objective function simplifies to:\n$$ J_s(x_s) = C_s(x_s) + (0) \\cdot x_s + \\frac{\\rho}{2}(x_s - 0)^2 = C_s(x_s) + \\frac{\\rho}{2}x_s^2 $$\nSince $x_s$ is a binary variable, $x_s \\in \\{0, 1\\}$, we have $x_s^2 = x_s$. The objective further simplifies to:\n$$ J_s(x_s) = C_s(x_s) + \\frac{\\rho}{2}x_s $$\nTo find the optimal $x_s^{k+1}$, we compare the objective value for $x_s=0$ and $x_s=1$:\n- Value for $x_s=0$: $J_s(0) = C_s(0) + \\frac{\\rho}{2}(0) = C_s(0)$.\n- Value for $x_s=1$: $J_s(1) = C_s(1) + \\frac{\\rho}{2}(1) = C_s(1) + \\frac{\\rho}{2}$.\n\nThe subproblem will choose $x_s^{k+1}=1$ if $J_s(1) < J_s(0)$, which means $C_s(1) + \\frac{\\rho}{2} < C_s(0)$. Rearranging, the condition for choosing $x_s^{k+1}=1$ is:\n$$ C_s(1) - C_s(0) < -\\frac{\\rho}{2} $$\nOtherwise, $x_s^{k+1}=0$ is chosen.\n\nNow, we apply this condition to each scenario:\n- **Scenario 1:** $C_1(1) - C_1(0) = 8000 - 20000 = -12000$.\n  The condition for choosing $x_1^{k+1}=1$ is $-12000 < -\\frac{\\rho}{2}$, which simplifies to $12000 > \\frac{\\rho}{2}$, or $\\rho < 24000$.\n  Therefore, for scenario $1$, $x_1^{k+1}=0$ will be chosen if $\\rho > 24000$.\n\n- **Scenario 2:** $C_2(1) - C_2(0) = 3750 - 3000 = 750$.\n  The condition for choosing $x_2^{k+1}=1$ is $750 < -\\frac{\\rho}{2}$. Since $\\rho > 0$, the right-hand side is negative. This inequality can never be satisfied.\n  Therefore, for scenario $2$, $x_2^{k+1}=0$ will always be chosen for any $\\rho > 0$ in this iteration.\n\nThis analysis shows that if $\\rho > 24000$, both scenarios will decide $x_1^{k+1}=0$ and $x_2^{k+1}=0$. This results in consensus ($\\bar{x}^{k+1}=0$), but at the suboptimal solution $x=0$. The algorithm will then be stuck, as the residuals $x_s^{k+1} - \\bar{x}^{k+1}$ will be zero, leading to no update in the multipliers $w_s$, and the next iteration will start from the same state.\n\n**Part 3: Option-by-Option Analysis**\n\n**A. With $\\bar x^k = 0$, scenario $1$ chooses $x_1^{k+1} = 0$ if $\\rho > 12000$, forcing consensus at $x=0$ even though the expected optimal is $x=1$.**\nAs derived in Part 2, scenario $1$ chooses $x_1^{k+1}=0$ if $\\rho > 24000$. The threshold $\\rho > 12000$ is incorrect. While the consequence described (forcing consensus at the suboptimal $x=0$) is correct for a sufficiently large $\\rho$, the specific condition is wrong.\n**Verdict: Incorrect**\n\n**B. For binary $x \\in \\{0,1\\}$, the difference in Progressive Hedging proximal penalties between choosing $x=1$ versus $x=0$ at a given $\\bar x$ equals $\\frac{\\rho}{2}\\left(1 - 2\\bar x\\right)$, which acts as a scenario-independent switching cost added to the scenario objective.**\nThe proximal penalty term is $P(x_s) = \\frac{\\rho}{2}(x_s - \\bar{x}^k)^2$. Let's calculate the difference for $x_s=1$ versus $x_s=0$:\n$$ P(1) - P(0) = \\frac{\\rho}{2}(1 - \\bar{x}^k)^2 - \\frac{\\rho}{2}(0 - \\bar{x}^k)^2 = \\frac{\\rho}{2}\\left[ (1 - 2\\bar{x}^k + (\\bar{x}^k)^2) - (\\bar{x}^k)^2 \\right] = \\frac{\\rho}{2}(1 - 2\\bar{x}^k) $$\nThe mathematical expression is correct. To understand its role, consider the full decision criterion: choose $x_s=1$ over $x_s=0$ if the total cost is lower. The difference in total cost is $\\Delta J_s = (C_s(1) - C_s(0)) + w_s^k + (P(1) - P(0))$. The term $\\frac{\\rho}{2}(1 - 2\\bar{x}^k)$ modifies the cost difference between choosing $x_s=1$ and $x_s=0$. This term is independent of the scenario $s$ and depends only on $\\rho$ and the current average $\\bar{x}^k$. It thus functions as a \"switching cost\" (or benefit) for choosing $x_s=1$ that is common to all scenarios, pushing them toward consensus. The interpretation is sound.\n**Verdict: Correct**\n\n**C. With the given data, the expected nonanticipative optimum is $x=1$ with expected cost $5450$, but with $\\bar x^k = 0$ and $\\rho = 30000$, the PH scenario subproblems select $x_s^{k+1} = 0$ for both scenarios, yielding a premature consensus at a suboptimal integer pattern.**\nThis statement is a composite of three claims.\n1. \"the expected nonanticipative optimum is $x=1$ with expected cost $5450$\". As shown in Part 1, this is correct.\n2. \"with $\\bar x^k = 0$ and $\\rho = 30000$, the PH scenario subproblems select $x_s^{k+1} = 0$ for both scenarios\". As shown in Part 2, for scenario $1$, $x_1^{k+1}=0$ is chosen if $\\rho > 24000$. Since $30000 > 24000$, this holds. For scenario $2$, $x_2^{k+1}=0$ is chosen for any $\\rho > 0$. Therefore, both scenarios select $x_s^{k+1}=0$. This is correct.\n3. \"yielding a premature consensus at a suboptimal integer pattern\". The consensus is at $x=0$, while the optimum is $x=1$. This is a suboptimal consensus, achieved in the first proper iteration. This claim is also correct.\nSince all parts of the statement are true, the statement as a whole is correct.\n**Verdict: Correct**\n\n**D. The Progressive Hedging penalty term is $\\rho\\,\\lvert x_s - \\bar x^k\\rvert$, so for binary $x$ its effect is the same for $\\bar x^k=0$ and $\\bar x^k=1$.**\nThe premise is false. The problem statement correctly defines the standard PH penalty term as the quadratic $\\frac{\\rho}{2}(x_s - \\bar{x}^k)^2$, not the L1-norm $\\rho|x_s - \\bar{x}^k|$. The statement begins with a factually incorrect formula relative to the problem's definition.\n**Verdict: Incorrect**\n\n**E. In Progressive Hedging with mixed-integer decisions, taking $\\rho \\to \\infty$ guarantees convergence to the globally optimal nonanticipative solution because the penalty neutralizes all bias.**\nThis is a general claim about PH for mixed-integer programming (MIP) problems. It is well-known that PH is a heuristic for non-convex problems like MIPs and does not guarantee convergence to the global optimum. A very large $\\rho$ heavily penalizes non-consensus, often forcing all integer variables to agree on a suboptimal pattern before the dual multipliers ($w_s$) can steer the search towards the true optimum. Our current problem provides a direct counterexample: for any $\\rho > 24000$, the algorithm converges to the suboptimal solution $x=0$. Therefore, taking $\\rho \\to \\infty$ does not guarantee optimality.\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{BC}$$"
        }
    ]
}