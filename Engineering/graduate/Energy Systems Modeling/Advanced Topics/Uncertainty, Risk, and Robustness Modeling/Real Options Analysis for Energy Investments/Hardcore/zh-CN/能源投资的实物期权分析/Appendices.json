{
    "hands_on_practices": [
        {
            "introduction": "二叉树模型是为美式期权（可在到期前任何时间执行的期权）定价的一种功能强大且直观的数值方法。本练习将指导您从第一性原理出发，通过将离散模型的矩与连续时间几何布朗运动(GBM)过程进行匹配，来构建一个二叉树模型。掌握这项技能是进行计算实物期权分析的基础。",
            "id": "4115364",
            "problem": "考虑一个能源投资问题，其中项目总价值 $X_t$（单位：百万美元）随连续时间随机演化，遵循几何布朗运动 (GBM)。假设市场无摩擦、无套利，并存在唯一的等价鞅测度（风险中性测度）。在风险中性测度下，$X_t$ 满足随机微分方程 $dX_t = (r - \\delta) X_t \\, dt + \\sigma X_t \\, dW_t$，其中参数为常数：无风险连续复利率 $r$、连续支付收益率 $\\delta$ 和波动率 $\\sigma$。决策者持有一份实物期权，可以在时间 $t \\in [0, T]$ 内的任何时刻通过支付一笔不可逆的投资成本 $I$（单位：百万美元）来进行投资。一旦投资，项目立即实现，其回报等于当时的净现值，建模为 $\\max(X_t - I, 0)$（单位：百万美元）。该期权为美式期权，意味着在到期前或到期日的任何时间都允许行权。\n\n您的任务是设计并实现一种重组二叉树格模型方法，以在时间 $t=0$ 对该美式实物期权进行估值。离散化过程必须从第一性原理构建：从风险中性测度下的 GBM 动态出发，施加无套利条件，通过匹配单步转移的前两阶矩（与时间步长 $\\Delta t$ 的主导阶一致）来推导上涨和下跌乘数以及风险中性转移概率。然后，执行带贴现的向后归纳法来计算美式期权价值。必须通过在每个节点比较继续持有价值与立即行权价值来处理提前行权。每个格点步骤的贴现必须使用因子 $e^{-r \\Delta t}$。\n\n程序还必须正确处理 $\\sigma = 0$ 的退化极限情况，此时随机过程在风险中性测度下变为确定性过程。在这种情况下，格子构造会退化，您必须实现一个逻辑上一致的估值方法，该方法要尊重美式期权在一组离散行权时间上的最优停止特性。当 $T = 0$ 时，其价值简化为在 $t=0$ 时的立即回报。\n\n所有输出必须以百万美元（million USD）为单位，表示为实值浮点数。不涉及角度。如果任何量要以百分比表示，则必须是小数形式；然而，本问题使用的连续复利率 $r$ 和 $\\delta$ 是以年为单位的小数。\n\n请实现一个程序，给定以下参数集测试套件 $(X_0, I, r, \\delta, \\sigma, T, N)$，使用具有 $N$ 个时间步长（步长大小为 $\\Delta t = T/N$）的重组二叉树格模型计算在 $t=0$ 时的期权价值：\n\n- 测试用例 1（一般情况，理想路径）：$(X_0, I, r, \\delta, \\sigma, T, N) = (100.0, 90.0, 0.06, 0.02, 0.20, 3.0, 150)$。\n- 测试用例 2（退化波动率，$\\sigma = 0$）：$(X_0, I, r, \\delta, \\sigma, T, N) = (120.0, 100.0, 0.06, 0.00, 0.00, 2.0, 50)$。\n- 测试用例 3（边界到期日，$T = 0$）：$(X_0, I, r, \\delta, \\sigma, T, N) = (80.0, 100.0, 0.05, 0.02, 0.25, 0.0, 1)$。\n- 测试用例 4（高支付收益率，负风险中性漂移）：$(X_0, I, r, \\delta, \\sigma, T, N) = (150.0, 140.0, 0.05, 0.25, 0.30, 2.0, 100)$。\n\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，结果顺序与测试套件相同，例如：\"[result1,result2,result3,result4]\"。每个结果必须是一个浮点数，代表在 $t=0$ 时的期权价值，单位为百万美元。\n\n推导和算法设计必须从连续时间（风险中性测度下的 GBM 和无套利）的核心概率和金融原理开始，进而构建一个有效的重组二叉树近似和通过向后归纳法进行的最优停止估值。在您的推导中，请勿在没有解释的情况下使用简便公式；相反，应从所述的基础出发，推导离散参数和估值递归。",
            "solution": "该问题要求对一个投资于能源项目的美式实物期权进行估值。该期权的价值将使用重组二叉树格模型进行计算。该问题定义清晰，科学上基于金融工程原理，并为得到唯一解提供了所有必要的数据。\n\n解决方案分三个阶段进行：\n1.  推导离散时间二叉树格参数（$u$、$d$、$p$），方法是确保其与风险中性测度下指定的连续时间几何布朗运动 (GBM) 模型保持一致。\n2.  构建用于美式期权估值的向后归纳算法，该算法涉及在格子的每个节点上比较继续持有价值与立即行权价值。\n3.  为波动率 $\\sigma=0$ 或到期时间 $T=0$ 的退化情况指定正确的逻辑程序。\n\n**1. 连续时间模型与二叉树离散化**\n\n规定项目总价值 $X_t$ 在风险中性测度 $Q$ 下遵循几何布朗运动。其随机微分方程 (SDE) 为：\n$$\ndX_t = (r - \\delta) X_t \\, dt + \\sigma X_t \\, dW_t\n$$\n其中 $r$ 是无风险利率，$\\delta$ 是连续支付收益率，$\\sigma$ 是波动率，$W_t$ 是在 $Q$ 下的标准维纳过程。\n\n我们的目标是用一个包含 $N$ 个时间步长（时长为 $\\Delta t = T/N$）的离散时间二叉树格模型来近似这个连续过程。在这个格子中，如果一个节点上的项目价值为 $X$，在下一个时间步长 $\\Delta t$ 后，它会上涨至 $X \\cdot u$ 或下跌至 $X \\cdot d$，其中 $u$ 和 $d$ 分别是上涨和下跌的乘法因子。格子必须构建为重组形式，即先上涨后下跌与先下跌后上涨得到的结果相同 ($ud=du$)。如果 $ud=1$，此条件即得到满足。\n\n**2. 格子参数的推导**\n\n离散模型的参数——上涨因子 $u$、下跌因子 $d$ 和风险中性上涨概率 $p$——是通过将离散过程的矩与连续过程的矩在 $\\Delta t$ 的主导阶上进行匹配来推导的。最常用且稳健的方法是由 Cox、Ross 和 Rubinstein (CRR) 提出的，如下所示。\n\n首先，我们设置上涨和下跌因子以匹配标的过程的波动率。在连续模型中，一个周期 $\\Delta t$ 内的对数回报率的方差为 $\\text{Var}[\\ln(X_{t+\\Delta t}/X_t)] = \\sigma^2 \\Delta t$。我们在单步二叉模型中强制实现这一点，其中对数回报率要么是 $\\ln u$，要么是 $\\ln d$。通过设置价格变动相对于零对称，即 $\\ln u = -\\ln d$，我们选择：\n$$\nu = e^{\\sigma \\sqrt{\\Delta t}} \\quad \\text{和} \\quad d = e^{-\\sigma \\sqrt{\\Delta t}}\n$$\n这一选择确保了 $ud=1$，从而使格子是重组的。它也匹配了过程对数回报率的方差。\n\n其次，我们通过匹配期望回报来确定风险中性概率 $p$。在风险中性的世界里，一个支付连续收益率 $\\delta$ 的资产的期望值必须以 $r-\\delta$ 的速率增长。因此，贴现后的资产价格 $e^{-(r-\\delta)t}X_t$ 必须是一个鞅。这意味着 $E_t^Q[X_{t+\\Delta t}] = X_t e^{(r-\\delta)\\Delta t}$。\n在我们的离散模型中，$X_{t+\\Delta t}$ 的期望值为 $p(X_t u) + (1-p)(X_t d)$。令两者相等：\n$$\np(X_t u) + (1-p)(X_t d) = X_t e^{(r-\\delta)\\Delta t}\n$$\n两边同除以 $X_t$ 并解出 $p$：\n$$\np(u-d) + d = e^{(r-\\delta)\\Delta t}\n$$\n$$\np = \\frac{e^{(r-\\delta)\\Delta t} - d}{u - d}\n$$\n这些对 $u$、$d$ 和 $p$ 的选择定义了我们的重组二叉树格模型，该模型近似于给定的 GBM。\n\n**3. 估值算法：向后归纳法**\n\n美式期权的价值是通过在格子上进行向后归纳法找到的。\n\n**步骤 3.1：终端条件**\n在到期时间 $T$（或第 $j=N$ 步），当且仅当项目价值 $X_{N,i}$ 超过投资成本 $I$ 时，期权才会被行权。因此，在 $N+1$ 个终端节点 $(N, i)$ 中每个节点上的期权价值是其内在价值：\n$$\nV_{N,i} = \\max(X_{N,i} - I, 0)\n$$\n其中 $i$ 是上涨次数（$i = 0, 1, \\dots, N$），且 $X_{N,i} = X_0 u^i d^{N-i}$。\n\n**步骤 3.2：递归步骤**\n然后我们从 $j=N-1$ 向后推至 $j=0$。在任何节点 $(j, i)$，美式期权的持有者有两个选择：立即行权或等待（继续持有）。\n\n立即行权的价值是该节点的内在价值：\n$$\nE_{j,i} = \\max(X_{j,i} - I, 0)\n$$\n其中 $X_{j,i} = X_0 u^i d^{j-i}$。\n\n继续持有（将期权再持有一个时期）的价值是下一时期期权价值的贴现期望值，在风险中性测度下计算：\n$$\nC_{j,i} = e^{-r \\Delta t} \\left[ p \\cdot V_{j+1, i+1} + (1-p) \\cdot V_{j+1, i} \\right]\n$$\n其中 $V_{j+1, i+1}$ 和 $V_{j+1, i}$ 分别是后续上涨和下跌节点的已知期权价值。\n\n由于该期权是美式的，持有者会选择价值最大化的行动。因此，节点 $(j,i)$ 的期权价值是：\n$$\nV_{j,i} = \\max(C_{j,i}, E_{j,i})\n$$\n这个递归过程重复进行，直到我们到达树的根节点 $j=0, i=0$。价值 $V_{0,0}$ 就是所求的在时间 $t=0$ 时的期权价值。\n\n**4. 特殊情况处理**\n\n通用算法必须针对测试套件中提供的两种特定退化情况进行调整。\n\n**情况 1：$T=0$ (零到期日)**\n如果到期时间为零，期权必须立即行权，否则将变得一文不值。没有时间价值。其价值就是 $t=0$ 时立即行权的回报：\n$$\nV_0 = \\max(X_0 - I, 0)\n$$\n\n**情况 2：$\\sigma=0$ (零波动率)**\n如果波动率为零，随机过程退化为确定性过程。随机微分方程变为常微分方程 $dX_t = (r - \\delta) X_t dt$，其解为：\n$$\nX_t = X_0 e^{(r-\\delta)t}\n$$\n项目价值的未来路径是完全确定的。标准的二叉树参数公式会失效，因为 $u=d=1$，导致计算 $p$ 时出现除零错误。取而代之的是，问题简化为从一组离散的可能行权日期 $\\{t_j = j \\Delta t \\mid j=0, 1, \\dots, N\\}$ 中找到最优行权时间 $t^*$。\n在 $t=0$ 时，于未来某个时间 $t_j$ 行权的价值是贴现后的回报：\n$$\n\\text{Value}(t_j) = e^{-r t_j} \\max(X_{t_j} - I, 0) = e^{-r t_j} \\max(X_0 e^{(r-\\delta)t_j} - I, 0)\n$$\n最优策略是选择使该价值最大化的时间 $t_j$。因此，期权价值为：\n$$\nV_0 = \\max_{j \\in \\{0, 1, \\dots, N\\}} \\left\\{ e^{-r (j \\Delta t)} \\max(X_0 e^{(r-\\delta)(j \\Delta t)} - I, 0) \\right\\}\n$$\n这是一个在 $N+1$ 个离散选择上的简单优化问题。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It computes the value of an American real option using a binomial lattice model.\n    \"\"\"\n\n    def compute_option_value(X0, I, r, delta, sigma, T, N):\n        \"\"\"\n        Computes the American real option value for a single set of parameters.\n\n        Args:\n            X0 (float): Initial project value.\n            I (float): Investment cost.\n            r (float): Risk-free rate.\n            delta (float): Continuous payout yield.\n            sigma (float): Volatility.\n            T (float): Time to maturity in years.\n            N (int): Number of time steps in the binomial lattice.\n\n        Returns:\n            float: The value of the American option at time t=0.\n        \"\"\"\n        # Handle the degenerate case where maturity T=0.\n        if T == 0:\n            return max(X0 - I, 0.0)\n\n        # Handle the degenerate case where volatility sigma=0.\n        # The process is deterministic.\n        if sigma == 0:\n            dt = T / N\n            # Create an array of discrete time points for possible exercise.\n            times = np.arange(N + 1) * dt\n            \n            # Calculate project values at each time point.\n            project_values = X0 * np.exp((r - delta) * times)\n            \n            # Calculate intrinsic payoffs at each time point.\n            payoffs = np.maximum(project_values - I, 0.0)\n            \n            # Discount payoffs back to t=0.\n            discount_factors = np.exp(-r * times)\n            discounted_payoffs = payoffs * discount_factors\n            \n            # The option value is the maximum of all possible discounted payoffs.\n            return np.max(discounted_payoffs)\n\n        # Standard binomial lattice model for sigma > 0.\n        dt = T / N\n        \n        # Calculate Cox-Ross-Rubinstein (CRR) parameters.\n        u = np.exp(sigma * np.sqrt(dt))\n        d = 1.0 / u\n        p = (np.exp((r - delta) * dt) - d) / (u - d)\n        \n        discount_factor = np.exp(-r * dt)\n\n        # Initialize a 1D array to store option values at each step.\n        # Start with terminal values at maturity T (step N).\n        # There are N+1 nodes at the final step.\n        # Prices at maturity: S_T = S_0 * u^i * d^(N-i) for i = 0 to N\n        # This can be computed efficiently.\n        prices_at_maturity = X0 * (d ** np.arange(N, -1, -1)) * (u ** np.arange(0, N + 1, 1))\n        V = np.maximum(prices_at_maturity - I, 0.0)\n\n        # Perform backward induction from step N-1 to 0.\n        for j in range(N - 1, -1, -1):\n            # The V array currently holds j+2 values from step j+1.\n            # We compute j+1 values for step j.\n            \n            # Continuation value: discounted expected value of the next step.\n            # V[:-1] corresponds to V_{j+1, i} states, V[1:] to V_{j+1, i+1} states.\n            continuation_values = discount_factor * (p * V[1:j+2] + (1 - p) * V[0:j+1])\n            \n            # Project prices at step j.\n            prices_at_j = X0 * (d ** np.arange(j, -1, -1)) * (u ** np.arange(0, j + 1, 1))\n            \n            # Exercise values at step j.\n            exercise_values = np.maximum(prices_at_j - I, 0.0)\n            \n            # For American option, the value at each node is the max of continuing and exercising.\n            V = np.maximum(continuation_values, exercise_values)\n\n        # The final result is the single value at the root of the tree.\n        return V[0]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (X0, I, r, delta, sigma, T, N)\n        (100.0, 90.0, 0.06, 0.02, 0.20, 3.0, 150),\n        (120.0, 100.0, 0.06, 0.00, 0.00, 2.0, 50),\n        (80.0, 100.0, 0.05, 0.02, 0.25, 0.0, 1),\n        (150.0, 140.0, 0.05, 0.25, 0.30, 2.0, 100),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_option_value(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "虽然数值方法用途广泛，但解析解能为特定问题提供更深刻的经济洞见。本练习将探讨经典的永久美式期权模型，并研究通货膨胀和合同结构（实际成本与名义成本）对最优投资时机决策的重大影响。通过这个练习，您将学会如何运用解析方法来确定最优投资阈值。",
            "id": "4115355",
            "problem": "一家独立发电商正在考虑一项永久投资期权，用于投资一个灵活的天然气调峰机组，该机组的净运营现金流与一个能源市场状态变量成正比。设单位容量的标的实际项目价值为 $X_t$，在风险中性测度下被建模为具有恒定波动率和派息率的几何布朗运动 (GBM)。具体来说，以实际单位计，$X_t$ 满足 $dX_t = X_t \\left( (r_r - \\delta) \\, dt + \\sigma \\, dW_t \\right)$，其中 $r_r$ 是连续复利的实际无风险利率，$\\delta$ 是实际的恒定现金流或股息收益率，$\\sigma$ 是波动率，$W_t$ 是标准布朗运动。\n\n通货膨胀被建模为连续复利率 $\\pi$，名义短期利率 $r_n$ 通过费雪关系 $r_n = r_r + \\pi$ 与实际短期利率 $r_r$ 相关。相应的名义价值过程是 $S_t = I_t X_t$，其中 $I_t$ 是价格水平。在风险中性测度下，这意味着 $dS_t = S_t \\left( (r_n - \\delta) \\, dt + \\sigma \\, dW_t \\right)$，因为派息率按比例适用于名义价值。\n\n公司有两种可供选择的投资成本合同结构：\n- 情况 R (指数化成本)：投资成本完全与通货膨胀挂钩，以实际价值计算是恒定的，等于 $K_{\\text{real}}$。\n- 情况 N (非指数化成本)：投资成本是一个固定的名义金额，等于 $K_{\\text{nom}}$，不随通货膨胀调整。\n\n假设在 $t=0$ 时 $K_{\\text{real}} = K_{\\text{nom}}$ 且初始价格水平满足 $I_0 = 1$，因此在 $t=0$ 时，当以名义价值表示时，两种成本是相同的。公司将每种情况下的投资期权都视为一种永久美式期权进行估值，通过支付成本并获得标的价值来获取资产。公司寻求在每种框架下的最优投资阈值：\n- 在情况 R 中，最优实际阈值 $X^{\\ast}_{R}$（以实际货币单位表示）。\n- 在情况 N 中，最优名义阈值 $S^{\\ast}_{N}$（以名义货币单位表示）。\n\n从费雪关系 $r_n = r_r + \\pi$ 和带有派息率的 GBM 的无套利风险中性估值出发，推导永久投资期权的控制方程和边界条件，求解每种情况下的最优投资阈值，并计算比率\n$$\nR \\equiv \\frac{S^{\\ast}_{N}}{S^{\\ast}_{R,\\text{nom}}},\n$$\n其中 $S^{\\ast}_{R,\\text{nom}}$ 表示情况 R 的阈值在 $t=0$ 时使用 $I_0=1$ 转换为名义单位。使用参数值 $r_n = 0.07$，$\\pi = 0.03$，$\\delta = 0.02$，$\\sigma = 0.25$ 和 $K_{\\text{real}} = K_{\\text{nom}} > 0$。将最终比率表示为一个无量纲数，并将你的答案四舍五入到四位有效数字。",
            "solution": "问题陈述被评估为有效。它在科学上植根于金融工程和实物期权分析的既定原则，特别是将 Black-Scholes-Merton 框架应用于永久美式期权。这是一个适定的问题，提供了所有必要的参数、定义和关系，以确定一个唯一且有意义的解。语言客观精确，参数值对于能源经济学中的程式化模型是现实的。没有矛盾、歧义或事实错误。因此，我们可以继续进行求解。\n\n问题要求在两种不同的成本结构下找到永久美式期权的最优投资阈值。期权的价值，我们称之为 $F$，作为标的资产价值 $V$ 的函数，在期权未被行使的区域内，由以下常微分方程控制：\n$$\n\\frac{1}{2} \\sigma^2 V^2 \\frac{d^2 F}{dV^2} + (r - q) V \\frac{dF}{dV} - r F = 0\n$$\n此处，$r$ 是适当的无风险利率，$q$ 是资产的连续派息率，$\\sigma$ 是资产价值的波动率。这个 Cauchy-Euler 方程的通解形式为 $F(V) = A_1 V^{\\beta_1} + A_2 V^{\\beta_2}$，其中 $\\beta_1$ 和 $\\beta_2$ 是指标方程的根：\n$$\n\\frac{1}{2} \\sigma^2 \\beta(\\beta-1) + (r - q) \\beta - r = 0\n$$\n一个根 $\\beta_1$ 为正且大于 1，而另一个根 $\\beta_2$ 为负。对于看涨期权，如果资产价值为零，期权价值必须为零，所以我们舍弃带有负指数的解，因为它在 $V \\to 0$ 时会趋于无穷大。因此，解为 $F(V) = A V^{\\beta_1}$。\n\n为了找到最优投资阈值 $V^{\\ast}$ 和常数 $A$，我们在阈值处应用价值匹配和平滑粘贴条件：\n1. 价值匹配：$F(V^{\\ast}) = V^{\\ast} - K$，其中 $K$ 是投资成本。\n2. 平滑粘贴：$\\frac{dF}{dV}(V^{\\ast}) = 1$。\n\n将这些条件应用于 $F(V) = A V^{\\beta_1}$：\n1. $A (V^{\\ast})^{\\beta_1} = V^{\\ast} - K$\n2. $A \\beta_1 (V^{\\ast})^{\\beta_1-1} = 1$\n\n从第二个条件，我们解出 $A = \\frac{(V^{\\ast})^{1-\\beta_1}}{\\beta_1}$。将此代入第一个条件得到：\n$$\n\\frac{(V^{\\ast})^{1-\\beta_1}}{\\beta_1} (V^{\\ast})^{\\beta_1} = V^{\\ast} - K \\implies \\frac{V^{\\ast}}{\\beta_1} = V^{\\ast} - K\n$$\n求解 $V^{\\ast}$ 得到最优阈值的通用公式：\n$$\nV^{\\ast} = \\left(\\frac{\\beta_1}{\\beta_1 - 1}\\right) K\n$$\n正根 $\\beta_1$ 由二次求根公式给出：\n$$\n\\beta_1 = \\frac{-\\left(r - q - \\frac{1}{2}\\sigma^2\\right) + \\sqrt{\\left(r - q - \\frac{1}{2}\\sigma^2\\right)^2 + 2r\\sigma^2}}{\\sigma^2}\n$$\n\n我们现在将这个通用框架应用于两个具体情况。\n\n**情况 R (指数化成本)：实际框架**\n分析以实际价值进行。状态变量是实际项目价值 $X_t$。\n- 状态变量: $V = X$\n- 投资成本: $K = K_{\\text{real}}$\n- 无风险利率: $r = r_r$ (实际无风险利率)\n- 派息率: $q = \\delta$\n- 波动率: $\\sigma$\n\n实际无风险利率 $r_r$ 从费雪关系推导得出：$r_r = r_n - \\pi$。\n以实际价值计算的最优投资阈值 $X^{\\ast}_{R}$ 是：\n$$\nX^{\\ast}_{R} = \\left(\\frac{\\beta_{1,R}}{\\beta_{1,R} - 1}\\right) K_{\\text{real}}\n$$\n其中 $\\beta_{1,R}$ 是使用实际利率 $r_r$ 的特征方程的正根：\n$$\n\\frac{1}{2} \\sigma^2 \\beta^2 + \\left(r_r - \\delta - \\frac{1}{2}\\sigma^2\\right) \\beta - r_r = 0\n$$\n\n**情况 N (非指数化成本)：名义框架**\n分析以名义价值进行。状态变量是名义项目价值 $S_t$。\n- 状态变量: $V = S$\n- 投资成本: $K = K_{\\text{nom}}$\n- 无风险利率: $r = r_n$ (名义无风险利率)\n- 派息率: $q = \\delta$\n- 波动率: $\\sigma$\n\n以名义价值计算的最优投资阈值 $S^{\\ast}_{N}$ 是：\n$$\nS^{\\ast}_{N} = \\left(\\frac{\\beta_{1,N}}{\\beta_{1,N} - 1}\\right) K_{\\text{nom}}\n$$\n其中 $\\beta_{1,N}$ 是使用名义利率 $r_n$ 的特征方程的正根：\n$$\n\\frac{1}{2} \\sigma^2 \\beta^2 + \\left(r_n - \\delta - \\frac{1}{2}\\sigma^2\\right) \\beta - r_n = 0\n$$\n\n**计算比率**\n问题要求计算比率 $R \\equiv \\frac{S^{\\ast}_{N}}{S^{\\ast}_{R,\\text{nom}}}$。\n$S^{\\ast}_{R,\\text{nom}}$ 是情况 R 的实际阈值 $X^{\\ast}_{R}$ 在 $t=0$ 时转换为名义单位。转换关系为 $S = I_t X$。在 $t=0$ 时，给定 $I_0=1$，所以 $S^{\\ast}_{R,\\text{nom}} = I_0 X^{\\ast}_{R} = 1 \\cdot X^{\\ast}_{R} = X^{\\ast}_{R}$。\n我们还给定 $K_{\\text{real}} = K_{\\text{nom}}$。因此，比率为：\n$$\nR = \\frac{S^{\\ast}_{N}}{X^{\\ast}_{R}} = \\frac{\\left(\\frac{\\beta_{1,N}}{\\beta_{1,N} - 1}\\right) K_{\\text{nom}}}{\\left(\\frac{\\beta_{1,R}}{\\beta_{1,R} - 1}\\right) K_{\\text{real}}} = \\frac{\\frac{\\beta_{1,N}}{\\beta_{1,N} - 1}}{\\frac{\\beta_{1,R}}{\\beta_{1,R} - 1}} = \\frac{\\beta_{1,N}(\\beta_{1,R} - 1)}{\\beta_{1,R}(\\beta_{1,N} - 1)}\n$$\n\n**数值计算**\n给定的参数值为：$r_n = 0.07$，$\\pi = 0.03$，$\\delta = 0.02$，$\\sigma = 0.25$。\n首先，我们计算实际无风险利率：\n$r_r = r_n - \\pi = 0.07 - 0.03 = 0.04$。\n我们还需要 $\\sigma^2 = (0.25)^2 = 0.0625$ 和 $\\frac{1}{2}\\sigma^2 = 0.03125$。\n\n计算 $\\beta_{1,R}$（使用 $r_r=0.04$）：\n二次求根公式的漂移项是 $r_r - \\delta - \\frac{1}{2}\\sigma^2 = 0.04 - 0.02 - 0.03125 = -0.01125$。\n平方根下的项是：\n$(-0.01125)^2 + 2(0.04)(0.0625) = 0.0001265625 + 0.005 = 0.0051265625$。\n所以，\n$$\n\\beta_{1,R} = \\frac{-(-0.01125) + \\sqrt{0.0051265625}}{0.0625} = \\frac{0.01125 + 0.071600017458}{0.0625} \\approx 1.325600\n$$\n\n计算 $\\beta_{1,N}$（使用 $r_n=0.07$）：\n二次求根公式的漂移项是 $r_n - \\delta - \\frac{1}{2}\\sigma^2 = 0.07 - 0.02 - 0.03125 = 0.01875$。\n平方根下的项是：\n$(0.01875)^2 + 2(0.07)(0.0625) = 0.0003515625 + 0.00875 = 0.0091015625$。\n所以，\n$$\n\\beta_{1,N} = \\frac{-(0.01875) + \\sqrt{0.0091015625}}{0.0625} = \\frac{-0.01875 + 0.09540210952}{0.0625} \\approx 1.226434\n$$\n\n现在，计算比率 $R$：\n$$\n\\beta_{1,R} - 1 \\approx 1.325600 - 1 = 0.325600\n$$\n$$\n\\beta_{1,N} - 1 \\approx 1.226434 - 1 = 0.226434\n$$\n$$\nR = \\frac{\\beta_{1,N}(\\beta_{1,R} - 1)}{\\beta_{1,R}(\\beta_{1,N} - 1)} \\approx \\frac{1.226434 \\times 0.325600}{1.325600 \\times 0.226434} \\approx \\frac{0.399259}{0.300221} \\approx 1.330369\n$$\n四舍五入到四位有效数字，比率为 $1.330$。\n$R > 1$ 这个事实在经济学上是直观的。在名义投资成本固定的情况下，通货膨胀会随着时间的推移侵蚀实际成本，使得投资期权更有价值。一个更有价值的期权会鼓励持有者等待更长时间，从而需要一个更高的投资触发点。因此，名义触发点 $S^{\\ast}_{N}$ 是其成本 $K_{\\text{nom}}$ 的倍数，要大于实际触发点 $X^{\\ast}_R$ 是其成本 $K_{\\text{real}}$ 的倍数，从而导致 $R > 1$。\n使用更高精度的最终计算：\n$$\n\\beta_{1,R} \\approx 1.3256002793\n$$\n$$\n\\beta_{1,N} \\approx 1.2264337523\n$$\n$$\nR = \\frac{1.2264337523 \\times (1.3256002793 - 1)}{1.3256002793 \\times (1.2264337523 - 1)} = \\frac{1.2264337523 \\times 0.3256002793}{1.3256002793 \\times 0.2264337523} \\approx 1.330369\n$$\n四舍五入到四位有效数字得到 $1.330$。",
            "answer": "$$\n\\boxed{1.330}\n$$"
        },
        {
            "introduction": "任何模型的准确性都取决于其输入的质量。本练习将前述的理论模型与现实世界联系起来，重点关注能源和商品期权中的一个关键参数：便利收益率 (convenience yield)。您将学习如何从可观测的远期曲线中推断其期限结构，这是进行实际估值的一项至关重要的技能。",
            "id": "4115370",
            "problem": "一家电力生产商正在评估推迟建设一座天然气储存设施的期权。该估值需要从可观测的市场数据中推断出瞬时便利收益率的期限结构。考虑一种可储存的能源商品，其当前现货价格为 $S_{0}$，在时间 $0$ 观测到的到期日为 $T \\geq 0$ 的远期曲线由下式给出\n$$F(0,T) = 55 \\exp(0.06 T)\\left(1 + 0.05 \\sin(2\\pi T)\\right).$$\n假设一个确定性的连续复利无风险利率期限结构为\n$$r(t) = 0.03 + 0.01 \\exp(-2 t),$$\n以及一个确定性的储存成本率（作为连续持有成本）为\n$$u(t) = 0.02 + 0.004 \\cos(2\\pi t).$$\n便利收益率定义为，在可储存商品的风险中性估值和无套利条件下，计入持有成本关系中的、持有库存单位时间的瞬时边际效益。利用这些基础，并将远期曲线 $F(0,T)$、利率 $r(t)$ 和储存成本率 $u(t)$ 作为原始输入，推导出瞬时便利收益率期限结构 $\\delta(0,T)$ 的表达式，并计算其在 $T^{\\ast} = 1.5$ 年时的值。将 $\\delta(0,T^{\\ast})$ 的最终值以年为单位表示，并将您的答案四舍五入到四位有效数字。在最终的方框答案中不要包含任何单位；评分员会将其解释为以年为单位。",
            "solution": "首先验证该问题，以确保其科学基础可靠、设定良好、客观且完整。\n\n**第 1 步：提取已知条件**\n-   时间 $t=0$ 时到期日为 $T$ 的观测远期曲线：$F(0,T) = 55 \\exp(0.06 T)\\left(1 + 0.05 \\sin(2\\pi T)\\right)$。\n-   无风险利率期限结构：$r(t) = 0.03 + 0.01 \\exp(-2 t)$。\n-   储存成本率期限结构：$u(t) = 0.02 + 0.004 \\cos(2\\pi t)$。\n-   当前现货价格：$S_{0}$。\n-   便利收益率，记为 $\\delta(t)$，是持有成本关系的一部分。\n-   任务是推导瞬时便利收益率期限结构 $\\delta(0,T)$ 并在 $T^{\\ast} = 1.5$ 处求值。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题基于可储存商品的标准无套利持有成本模型，这是量化金融和能源经济学中的一个基本概念。该关系为 $F(t,T) = S_t \\exp\\left(\\int_t^T (r(s) + u(s) - \\delta(s)) ds\\right)$，其中对于本问题，所有组成部分都假定是确定性的。为 $F(0,T)$、$r(t)$ 和 $u(t)$ 提供的函数形式在数学上是良定义的，并且对于建模是合理的。根据无套利条件，现货价格 $S_0$ 必须等于即期交割的远期价格 $F(0,0)$。从给定的远期曲线可知，$F(0,0) = 55 \\exp(0)(1+0) = 55$，这意味着 $S_0 = 55$。因此，该问题是自洽且一致的。它是良构的，因为可以从给定的输入中推导出瞬时便利收益率 $\\delta(0,T)$ 的唯一表达式。问题陈述是客观的，并使用了标准术语。该问题被认定为有效。\n\n**第 3 步：进行求解**\n\n对于一种可储存商品，其现货价格 $S_0$ 和远期价格 $F(0,T)$ 之间的无套利关系，在时变确定性无风险利率 $r(t)$、储存成本率 $u(t)$ 和便利收益率 $\\delta(t)$ 的情况下，由持有成本模型给出：\n$$F(0,T) = S_0 \\exp\\left(\\int_0^T (r(s) + u(s) - \\delta(s)) ds\\right)$$\n符号 $\\delta(0,T)$ 用于表示从时间 $0$ 的市场数据推断出的、到期日为 $T$ 的瞬时远期便利收益率。该关系可以求解出 $\\delta(s)$（在此符号体系下为 $\\delta(0,s)$）。\n\n首先，我们分离指数项，并对等式两边取自然对数：\n$$ \\ln\\left(\\frac{F(0,T)}{S_0}\\right) = \\int_0^T (r(s) + u(s) - \\delta(s)) ds $$\n为了求出瞬时利率 $\\delta(T)$，我们将其记为 $\\delta(0,T)$，我们对等式两边关于到期日 $T$ 求导，并对右侧应用微积分基本定理：\n$$ \\frac{d}{dT} \\ln\\left(\\frac{F(0,T)}{S_0}\\right) = r(T) + u(T) - \\delta(0,T) $$\n重新整理该方程，得到瞬时便利收益率期限结构的表达式：\n$$ \\delta(0,T) = r(T) + u(T) - \\frac{d}{dT} \\ln\\left(\\frac{F(0,T)}{S_0}\\right) $$\n如验证阶段所确立的，现货价格 $S_0$ 由 $F(0,0)$ 给出：\n$$ S_0 = F(0,0) = 55 \\exp(0.06 \\cdot 0) \\left(1 + 0.05 \\sin(2\\pi \\cdot 0)\\right) = 55 \\cdot 1 \\cdot (1+0) = 55 $$\n现在我们可以构造 $\\ln\\left(\\frac{F(0,T)}{S_0}\\right)$ 这一项：\n$$ \\frac{F(0,T)}{S_0} = \\frac{55 \\exp(0.06 T)\\left(1 + 0.05 \\sin(2\\pi T)\\right)}{55} = \\exp(0.06 T)\\left(1 + 0.05 \\sin(2\\pi T)\\right) $$\n$$ \\ln\\left(\\frac{F(0,T)}{S_0}\\right) = \\ln\\left[\\exp(0.06 T)\\left(1 + 0.05 \\sin(2\\pi T)\\right)\\right] = 0.06 T + \\ln\\left(1 + 0.05 \\sin(2\\pi T)\\right) $$\n接下来，我们计算该表达式关于 $T$ 的导数：\n$$ \\frac{d}{dT} \\ln\\left(\\frac{F(0,T)}{S_0}\\right) = \\frac{d}{dT} \\left[0.06 T + \\ln\\left(1 + 0.05 \\sin(2\\pi T)\\right)\\right] $$\n$$ = 0.06 + \\frac{1}{1 + 0.05 \\sin(2\\pi T)} \\cdot \\frac{d}{dT}\\left(0.05 \\sin(2\\pi T)\\right) $$\n$$ = 0.06 + \\frac{0.05 \\cos(2\\pi T) \\cdot 2\\pi}{1 + 0.05 \\sin(2\\pi T)} = 0.06 + \\frac{0.1 \\pi \\cos(2\\pi T)}{1 + 0.05 \\sin(2\\pi T)} $$\n现在我们将这个导数，以及 $r(T)$ 和 $u(T)$ 的给定表达式，代入 $\\delta(0,T)$ 的公式中：\n$$ \\delta(0,T) = (0.03 + 0.01 \\exp(-2 T)) + (0.02 + 0.004 \\cos(2\\pi T)) - \\left(0.06 + \\frac{0.1 \\pi \\cos(2\\pi T)}{1 + 0.05 \\sin(2\\pi T)}\\right) $$\n合并各项，我们得到瞬时便利收益率期限结构的一般表达式：\n$$ \\delta(0,T) = (0.03 + 0.02 - 0.06) + 0.01 \\exp(-2 T) + 0.004 \\cos(2\\pi T) - \\frac{0.1 \\pi \\cos(2\\pi T)}{1 + 0.05 \\sin(2\\pi T)} $$\n$$ \\delta(0,T) = -0.01 + 0.01 \\exp(-2 T) + \\left(0.004 - \\frac{0.1 \\pi}{1 + 0.05 \\sin(2\\pi T)}\\right) \\cos(2\\pi T) $$\n最后一步是在 $T = T^{\\ast} = 1.5$ 年时计算该表达式的值。我们首先计算在该值下的三角函数和指数部分：\n$$ \\sin(2\\pi T) = \\sin(2\\pi \\cdot 1.5) = \\sin(3\\pi) = 0 $$\n$$ \\cos(2\\pi T) = \\cos(2\\pi \\cdot 1.5) = \\cos(3\\pi) = -1 $$\n$$ \\exp(-2 T) = \\exp(-2 \\cdot 1.5) = \\exp(-3) $$\n将这些值代入 $\\delta(0,1.5)$ 的表达式中：\n$$ \\delta(0,1.5) = -0.01 + 0.01 \\exp(-3) + \\left(0.004 - \\frac{0.1 \\pi}{1 + 0.05 \\sin(3\\pi)}\\right) \\cos(3\\pi) $$\n$$ \\delta(0,1.5) = -0.01 + 0.01 \\exp(-3) + \\left(0.004 - \\frac{0.1 \\pi}{1 + 0}\\right) (-1) $$\n$$ \\delta(0,1.5) = -0.01 + 0.01 \\exp(-3) - (0.004 - 0.1 \\pi) $$\n$$ \\delta(0,1.5) = -0.01 + 0.01 \\exp(-3) - 0.004 + 0.1 \\pi $$\n$$ \\delta(0,1.5) = -0.014 + 0.01 \\exp(-3) + 0.1 \\pi $$\n现在我们计算数值：\n$$ \\exp(-3) \\approx 0.049787068 $$\n$$ \\pi \\approx 3.141592654 $$\n$$ \\delta(0,1.5) \\approx -0.014 + 0.01(0.049787068) + 0.1(3.141592654) $$\n$$ \\delta(0,1.5) \\approx -0.014 + 0.00049787068 + 0.3141592654 $$\n$$ \\delta(0,1.5) \\approx 0.300657136 $$\n将此结果四舍五入到四位有效数字，得到 $0.3007$。\n$T^* = 1.5$ 年时的瞬时便利收益率约为每年 $30.07\\%$。",
            "answer": "$$\\boxed{0.3007}$$"
        }
    ]
}