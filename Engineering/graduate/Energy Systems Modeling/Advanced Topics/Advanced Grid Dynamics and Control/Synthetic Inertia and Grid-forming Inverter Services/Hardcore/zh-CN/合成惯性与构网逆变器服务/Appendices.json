{
    "hands_on_practices": [
        {
            "introduction": "合成惯量的核心在于通过控制算法模拟同步发电机的经典摆动方程。本练习将引导您完成基本的设计过程：将期望的动态性能指标（如阻尼比 $\\zeta$ 和自然振荡频率 $\\omega_n$）转化为并网逆变器的核心控制参数，即合成惯量 $M$ 和阻尼系数 $D$。通过这个实践，您将把电力系统物理学与经典控制理论联系起来，掌握构网型逆变器频率控制的基础 。",
            "id": "4127863",
            "problem": "一个连接到强电网的构网型逆变器通过频率控制回路被控制，以提供合成惯量和阻尼。逆变器端电压幅值保持在 $1.0$ 标幺值（p.u.），电网母线电压幅值也是 $1.0$ p.u。逆变器通过一个等效电抗 $X_{\\mathrm{eq}}$ 连接到电网，其稳态功率传输遵循功率-功角关系，该关系在小角度下可以很好地用线性化的同步转矩（功率-功角灵敏度）来近似。逆变器的频率控制回路通过指令逆变器的有功功率来模拟二阶机电动态特性，使得角度 $\\delta(t)$（单位为弧度）和频率偏差 $\\omega(t) = \\dot{\\delta}(t)$ 由一个等效惯量参数 $M$ 和一个阻尼参数 $D$ 控制。\n\n从第一性原理和经过验证的公式出发，完成以下任务：\n\n1. 利用电抗后电源与电网之间的正弦潮流关系及其小角度线性化，将同步功率系数 $K_{s}$ 表示为 $V_{\\mathrm{inv}}$、$V_{\\mathrm{g}}$ 和 $X_{\\mathrm{eq}}$ 的函数。假设工作点满足 $\\delta_{0} \\approx 0$ 并使用弧度作为角度单位。\n2. 使用模拟类似摇摆动态的合成惯量和阻尼控制律，推导出关于 $\\delta(t)$ 的小信号齐次二阶微分方程，并确定相应的闭环特征多项式。\n3. 给定阻尼比 $\\zeta = 0.7$ 和自然频率 $\\omega_{n}$ 的设计目标，通过求解 $M$ 和 $D$（用 $K_{s}$、$\\zeta$ 和 $\\omega_{n}$ 表示）将闭环极点配置在期望的位置。\n4. 对于一个具体情况，$V_{\\mathrm{inv}} = 1.0$ p.u.，$V_{\\mathrm{g}} = 1.0$ p.u.，$X_{\\mathrm{eq}} = 0.3$ p.u.，以及期望的 $\\omega_{n} = 20$ 弧度/秒，计算与第3部分中的极点配置相对应的 $M$ 和 $D$ 的数值。\n\n最终数值应按如下格式表示：\n- 角度使用弧度。\n- 将您的数值四舍五入到四位有效数字。\n- $M$ 的单位表示为 p.u.$\\cdot$秒的平方 (p.u.$\\cdot$s$^{2}$)。\n- $D$ 的单位表示为 p.u.$\\cdot$秒 (p.u.$\\cdot$s)。\n\n您的最终答案必须是一个单行矩阵，包含按指定单位和四舍五入规则计算的 $M$ 和 $D$。",
            "solution": "### 问题验证\n#### 第1步：提取已知条件\n问题提供了以下信息：\n-   逆变器端电压幅值：$V_{\\mathrm{inv}} = 1.0$ 标幺值（p.u.）。\n-   电网母线电压幅值：$V_{\\mathrm{g}} = 1.0$ p.u。\n-   等效电抗：$X_{\\mathrm{eq}} = 0.3$ p.u。\n-   稳态工作点角度：$\\delta_{0} \\approx 0$ 弧度。\n-   系统动态由一个等效惯量参数 $M$ 和一个阻尼参数 $D$ 控制。\n-   角度用 $\\delta(t)$ 表示，单位为弧度。\n-   频率偏差定义为 $\\omega(t) = \\dot{\\delta}(t)$。\n-   控制系统模拟了一个二阶机电动态特性。\n-   设计目标阻尼比：$\\zeta = 0.7$。\n-   设计目标自然频率：$\\omega_{n} = 20$ 弧度/秒。\n-   最终答案所需单位：$M$ 单位为 p.u.$\\cdot$s$^{2}$，$D$ 单位为 p.u.$\\cdot$s。\n-   最终答案所需精度：四舍五入到四位有效数字。\n\n#### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确且客观。\n-   **科学依据：** 该问题基于电力系统分析的基本原理，包括交流潮流的功率-功角关系和用于稳定性分析的二阶摇摆方程模型。由构网型逆变器提供合成惯量的概念是现代电力系统研究和工程中的一个成熟课题。所有物理量及其关系都是合理的。\n-   **提法明确：** 该问题被构建为一个标准的控制设计任务。它提供了足够的信息（系统参数、控制目标）来确定控制参数（$M$ 和 $D$）的唯一解。步骤逻辑清晰，可以得出一个明确、可计算的结果。\n-   **客观性：** 语言精确且量化。所有术语，如“合成惯量”、“阻尼比”和“自然频率”，都是控制理论和电力工程中的标准术语。\n\n该问题没有任何无效性缺陷。这是一个为提供辅助服务的并网逆变器进行控制参数设计的教科书式例子。对 $M$ 和 $D$ 的单位要求澄清了该领域的通用惯例，即在状态空间公式中，以弧度为单位的角度被视为无量纲量，从而解决了潜在的歧义。\n\n#### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n问题要求对提供合成惯量的构网型逆变器的控制设计进行多部分推导和计算。\n\n#### 第1部分：同步功率系数 ($K_s$)\n从逆变器通过电抗 $X_{\\mathrm{eq}}$ 传输到电网的有功功率 $P$ 由潮流关系式给出：\n$$P(\\delta) = \\frac{V_{\\mathrm{inv}} V_{\\mathrm{g}}}{X_{\\mathrm{eq}}} \\sin(\\delta)$$\n其中 $\\delta$ 是逆变器电压相对于电网电压的角度。\n\n同步功率系数 $K_s$ 代表电气连接的刚度，定义为功率-功角曲线在工作点 $\\delta_0$ 处的斜率。它是功率对角度的一阶导数：\n$$K_s = \\frac{dP}{d\\delta} \\bigg|_{\\delta=\\delta_0} = \\frac{V_{\\mathrm{inv}} V_{\\mathrm{g}}}{X_{\\mathrm{eq}}} \\cos(\\delta_0)$$\n问题指定在工作点 $\\delta_0 \\approx 0$ 附近进行小角度线性化。在该点，$\\cos(\\delta_0) \\approx \\cos(0) = 1$。因此，同步功率系数为：\n$$K_s = \\frac{V_{\\mathrm{inv}} V_{\\mathrm{g}}}{X_{\\mathrm{eq}}}$$\n\n#### 第2部分：动态方程与特征多项式\n逆变器的控制回路模拟了机电摇摆方程，这是一个二阶系统。该方程的一般形式将惯性转矩（功率）和阻尼转矩（功率）与加速转矩（功率）联系起来，加速转矩是参考功率 $P_{\\mathrm{ref}}$（类似于机械功率）与电气输出功率 $P_e$ 之间的差值。\n$$M \\frac{d^2\\delta(t)}{dt^2} + D \\frac{d\\delta(t)}{dt} = P_{\\mathrm{ref}}(t) - P_e(t)$$\n对于小信号稳定性分析，我们分析系统在稳态工作点 $(\\delta_0, P_{e0})$（其中 $P_{e0} = P_{\\mathrm{ref}}$）附近对小扰动的响应。设 $\\delta(t) = \\delta_0 + \\Delta\\delta(t)$ 和 $P_e(t) = P_{e0} + \\Delta P_e(t)$。假设功率参考值恒定（$\\Delta P_{\\mathrm{ref}} = 0$），则扰动的线性化方程变为：\n$$M \\frac{d^2(\\Delta\\delta)}{dt^2} + D \\frac{d(\\Delta\\delta)}{dt} = -\\Delta P_e(t)$$\n电气功率的变化量 $\\Delta P_e$ 通过第1部分中的同步功率系数 $K_s$ 与角度变化量 $\\Delta\\delta$ 相关：\n$$\\Delta P_e(t) \\approx K_s \\Delta\\delta(t)$$\n将此代入动态方程，我们得到齐次二阶线性微分方程。为简化符号，我们用 $\\delta(t)$ 代表偏差 $\\Delta\\delta(t)$。\n$$M \\ddot{\\delta}(t) + D \\dot{\\delta}(t) = -K_s \\delta(t)$$\n$$M \\ddot{\\delta}(t) + D \\dot{\\delta}(t) + K_s \\delta(t) = 0$$\n为了求特征多项式，我们对该方程进行拉普拉斯变换，并假设初始条件为零：\n$$M s^2 \\Delta(s) + D s \\Delta(s) + K_s \\Delta(s) = 0$$\n两边同除以 $\\Delta(s)$，得到特征多项式 $C(s)$ 为：\n$$C(s) = M s^2 + D s + K_s = 0$$\n\n#### 第3部分：$M$ 和 $D$ 的极点配置\n目标是通过配置闭环极点来实现期望的阻尼比 $\\zeta$ 和自然频率 $\\omega_n$。二阶系统的标准特征多项式为：\n$$s^2 + 2\\zeta\\omega_n s + \\omega_n^2 = 0$$\n为了将我们推导的特征方程与此标准形式匹配，我们将其两边同除以 $M$：\n$$s^2 + \\frac{D}{M} s + \\frac{K_s}{M} = 0$$\n通过比较两种多项式形式的系数，我们得到两个代数方程：\n1.  $\\omega_n^2 = \\frac{K_s}{M}$\n2.  $2\\zeta\\omega_n = \\frac{D}{M}$\n\n现在我们可以用 $K_s$、$\\zeta$ 和 $\\omega_n$ 来求解 $M$ 和 $D$。由方程（1）得：\n$$M = \\frac{K_s}{\\omega_n^2}$$\n由方程（2），我们求解 $D$：\n$$D = 2\\zeta\\omega_n M$$\n将 $M$ 的表达式代入 $D$ 的方程中：\n$$D = 2\\zeta\\omega_n \\left( \\frac{K_s}{\\omega_n^2} \\right) = \\frac{2\\zeta K_s}{\\omega_n}$$\n这些就是合成惯量 $M$ 和阻尼 $D$ 所需的表达式。\n\n#### 第4部分：数值计算\n给定以下具体数值：\n-   $V_{\\mathrm{inv}} = 1.0$ p.u.\n-   $V_{\\mathrm{g}} = 1.0$ p.u.\n-   $X_{\\mathrm{eq}} = 0.3$ p.u.\n-   $\\zeta = 0.7$\n-   $\\omega_n = 20$ rad/s\n\n首先，我们计算第1部分中的同步功率系数 $K_s$。根据问题的单位规定，$K_s$ 的单位是 p.u。\n$$K_s = \\frac{V_{\\mathrm{inv}} V_{\\mathrm{g}}}{X_{\\mathrm{eq}}} = \\frac{1.0 \\times 1.0}{0.3} = \\frac{10}{3} \\text{ p.u.}$$\n接下来，我们使用第3部分的公式来计算 $M$ 和 $D$。\n\n对于惯量参数 $M$：\n$$M = \\frac{K_s}{\\omega_n^2} = \\frac{10/3}{(20)^2} = \\frac{10}{3 \\times 400} = \\frac{10}{1200} = \\frac{1}{120} \\text{ p.u.}\\cdot\\text{s}^2$$\n作为小数，$M = 0.0083333...$ p.u.$\\cdot$s$^2$。四舍五入到四位有效数字得到：\n$$M \\approx 0.008333 \\text{ p.u.}\\cdot\\text{s}^2$$\n对于阻尼参数 $D$：\n$$D = \\frac{2\\zeta K_s}{\\omega_n} = \\frac{2 \\times 0.7 \\times (10/3)}{20} = \\frac{1.4 \\times 10}{3 \\times 20} = \\frac{14}{60} = \\frac{7}{30} \\text{ p.u.}\\cdot\\text{s}$$\n作为小数，$D = 0.23333...$ p.u.$\\cdot$s。四舍五入到四位有效数字得到：\n$$D \\approx 0.2333 \\text{ p.u.}\\cdot\\text{s}$$\n计算出的 $M$ 和 $D$ 值将配置系统极点，以满足 $\\zeta=0.7$ 和 $\\omega_n=20$ rad/s 的指定性能要求。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.008333  0.2333\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在设计了基本控制器后，我们必须考虑实际应用中的挑战，尤其是测量噪声。本练习将探讨如何防止逆变器对微小的、无意义的频率波动做出不必要的响应。我们将为一个“死区”阈值进行设计，它作用于频率变化率（RoCoF）触发器，通过这个过程您将深入理解在抑制噪声和有效响应真实电网扰动之间的统计学权衡 。",
            "id": "4127885",
            "problem": "一个提供虚拟惯性的构网型逆变器 (GFI) 被设计为注入与测量的频率变化率 (RoCoF) 成比例的惯性功率，但这仅在测量的RoCoF绝对值超过一个死区阈值时发生，以避免小的波动和测量噪声引起伪触发。惯性响应死区是围绕零RoCoF的一个区间，在此区间内逆变器有意不作响应。其目的是抑制由噪声和良性微小波动引起的触发，同时仍然允许对真实扰动做出有力的响应。\n\n考虑以下建模假设，这些假设将用于为RoCoF触发器设计死区阈值：\n\n- 逆变器以周期 $T_s = 0.02\\,\\text{s}$ 对测量的RoCoF进行采样，并计算一个标量触发信号 $|\\dot{f}_m(k)|$，其中 $\\dot{f}_m(k) = \\dot{f}(k) + n(k)$ 是在离散时间索引 $k$ 处的测量RoCoF，$\\dot{f}(k)$ 是真实的RoCoF，而 $n(k)$ 是零均值测量噪声。\n- 测量噪声 $n(k)$ 被建模为独立同分布的高斯分布，其标准差为 $\\sigma = 0.02\\,\\text{Hz/s}$。\n- 在正常的、未受扰动的运行条件下，真实的RoCoF满足 $\\dot{f}(k) = 0$。\n- 对测量的RoCoF绝对值应用一个死区阈值 $\\theta$，当且仅当 $|\\dot{f}_m(k)|  \\theta$ 时，惯性响应才被启用。\n- 运营商要求，在假设独立样本的情况下，对于单个逆变器，纯粹由噪声引起的预期误触发次数每天不超过 $R_f = 1$ 次。误触发发生在未受扰动运行时 $|\\dot{f}_m(k)|  \\theta$ 的情况。\n- 为保持对真实扰动的有效性，运营商规定了一个最小可信扰动RoCoF幅值 $A_{\\min} = 0.30\\,\\text{Hz/s}$，并要求在单个样本内对幅值为 $|\\dot{f}(k)| = A_{\\min}$ 的事件的检测概率至少为 $P_d^{\\min} = 0.95$。\n\n根据这些假设和高斯概率的基本定义，从以下选项中选择同时满足误触发要求和扰动检测要求的最小死区阈值 $\\theta$。\n\nA. $\\theta = 0.104\\,\\text{Hz/s}$\n\nB. $\\theta = 0.020\\,\\text{Hz/s}$\n\nC. $\\theta = 0.300\\,\\text{Hz/s}$\n\nD. $\\theta = 0.150\\,\\text{Hz/s}$",
            "solution": "在进行求解之前，对问题陈述进行严格验证。\n\n### 步骤1：提取已知条件\n- 采样周期: $T_s = 0.02\\,\\text{s}$\n- 测量的频率变化率 (RoCoF): $\\dot{f}_m(k) = \\dot{f}(k) + n(k)$，其中 $k$ 是离散时间索引，$\\dot{f}(k)$ 是真实的RoCoF，而 $n(k)$ 是测量噪声。\n- 噪声模型: $n(k)$ 是均值为0、标准差为 $\\sigma = 0.02\\,\\text{Hz/s}$ 的独立同分布 (i.i.d.) 高斯噪声。\n- 未受扰动运行的条件: $\\dot{f}(k) = 0$。\n- 触发条件: 当且仅当 $|\\dot{f}_m(k)|  \\theta$ 时，惯性响应才被启用，其中 $\\theta$ 是死区阈值。\n- 误触发约束: 每天的预期误触发次数不得超过 $R_f = 1$ 次。误触发定义为在 $\\dot{f}(k) = 0$ 时发生触发。\n- 扰动检测约束: 对于幅值为 $|\\dot{f}(k)| = A_{\\min} = 0.30\\,\\text{Hz/s}$ 的最小可信扰动，单个样本内的检测概率必须至少为 $P_d^{\\min} = 0.95$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**: 该问题基于统计信号处理（检测理论、高斯噪声模型）和电力系统工程（频率控制、虚拟惯性）的标准原理。所有概念都是公认的。\n- **提法明确**: 该问题提法明确。它对单个变量 $\\theta$ 提供了两个不同的、可量化的约束，并要求根据这些约束从一组离散选项中选择最佳值。这种结构允许唯一的解。\n- **客观性**: 该问题以精确、客观的语言陈述，具有明确定义的量化要求。没有主观或含糊的术语。\n- **完整性和一致性**: 该问题提供了建立可解数学模型所需的所有数据（采样率、噪声统计、性能要求）。这些约束本身并不矛盾，但它们确实对 $\\theta$ 的选择构成了相反的压力，这正是设计权衡问题的本质。\n- **现实性**: 采样周期、噪声水平和RoCoF幅值的数值对于现代电力系统和逆变器控制应用是现实的。\n\n### 步骤3：结论与行动\n问题陈述有效。它在科学上是合理的、提法明确且完整的。将推导出一个解决方案。\n\n### 解题推导\n\n问题要求从给定选项中找到满足两个约束的最小阈值 $\\theta$：一个是对最大误触发率的约束，另一个是对检测到真实扰动的最小概率的约束。我们将通过分别分析每个约束来推导 $\\theta$ 的允许范围。\n\n**约束1：误触发率**\n\n当真实RoCoF为零（即 $\\dot{f}(k) = 0$）但测量噪声导致触发条件满足时，就会发生误触发。\n在此条件下，测量的RoCoF就是噪声：$\\dot{f}_m(k) = n(k)$。噪声是服从高斯分布的随机变量，$n(k) \\sim N(0, \\sigma^2)$，其中 $\\sigma = 0.02\\,\\text{Hz/s}$。\n\n单个样本中误触发的概率 $P_{fa}$ 是 $|\\dot{f}_m(k)|  \\theta$ 的概率：\n$$P_{fa} = P(|n(k)|  \\theta) = P(n(k)  \\theta) + P(n(k)  -\\theta)$$\n由于零均值高斯分布的对称性，这可以简化为：\n$$P_{fa} = 2 \\cdot P(n(k)  \\theta)$$\n令 $Z = n(k)/\\sigma$ 为一个标准正态变量，$Z \\sim N(0, 1)$。不等式变为：\n$$P_{fa} = 2 \\cdot P(Z  \\theta/\\sigma) = 2 \\cdot (1 - \\Phi(\\theta/\\sigma))$$\n其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数 (CDF)。\n\n每天的采样次数 $N_{samples}$ 为：\n$$N_{samples} = \\frac{1\\,\\text{day}}{T_s} = \\frac{24\\,\\text{hours/day} \\times 3600\\,\\text{s/hour}}{0.02\\,\\text{s/sample}} = 4,320,000\\,\\text{samples/day}$$\n每天的预期误触发次数 $E_{fa}$ 为 $N_{samples} \\times P_{fa}$。约束条件为 $E_{fa} \\le R_f = 1$。\n$$N_{samples} \\cdot P_{fa} \\le 1 \\implies P_{fa} \\le \\frac{1}{N_{samples}} = \\frac{1}{4,320,000} \\approx 2.3148 \\times 10^{-7}$$\n代入 $P_{fa}$ 的表达式：\n$$2 \\cdot (1 - \\Phi(\\theta/\\sigma)) \\le 2.3148 \\times 10^{-7}$$\n$$1 - \\Phi(\\theta/\\sigma) \\le 1.1574 \\times 10^{-7}$$\n$$\\Phi(\\theta/\\sigma) \\ge 1 - 1.1574 \\times 10^{-7} = 0.99999988426$$\n我们需要找到与此累积概率对应的分位数 $q = \\theta/\\sigma$。使用标准正态分布的反函数，我们发现 $q \\approx 5.144$。\n因此，我们要求：\n$$\\frac{\\theta}{\\sigma} \\ge 5.144$$\n$$\\theta \\ge 5.144 \\cdot \\sigma = 5.144 \\cdot (0.02\\,\\text{Hz/s}) = 0.10288\\,\\text{Hz/s}$$\n这设定了阈值 $\\theta$ 的下界。\n\n**约束2：扰动检测概率**\n\n对于幅值为 $|\\dot{f}(k)| = A_{\\min} = 0.30\\,\\text{Hz/s}$ 的真实扰动，检测概率 $P_d$ 必须至少为 $P_d^{\\min} = 0.95$。\n让我们考虑 $\\dot{f}(k) = A_{\\min} = 0.30\\,\\text{Hz/s}$ 的情况。测量的RoCoF为 $\\dot{f}_m(k) = A_{\\min} + n(k)$，它是一个高斯随机变量 $\\dot{f}_m(k) \\sim N(A_{\\min}, \\sigma^2)$。\n如果 $|\\dot{f}_m(k)|  \\theta$，即 $\\dot{f}_m(k)  \\theta$ 或 $\\dot{f}_m(k)  -\\theta$，则发生检测。\n检测概率为 $P_d = P(\\dot{f}_m(k)  \\theta) + P(\\dot{f}_m(k)  -\\theta)$。\n条件 $P_d \\ge 0.95$ 等价于未检测到的概率最多为 $1 - 0.95 = 0.05$。当 $-\\theta \\le \\dot{f}_m(k) \\le \\theta$ 时，发生未检测。\n$$P(-\\theta \\le \\dot{f}_m(k) \\le \\theta) \\le 0.05$$\n让我们对变量 $\\dot{f}_m(k)$ 进行标准化。令 $Z = (\\dot{f}_m(k) - A_{\\min})/\\sigma \\sim N(0, 1)$。\n未检测的不等式变为：\n$$P\\left( \\frac{-\\theta - A_{\\min}}{\\sigma} \\le Z \\le \\frac{\\theta - A_{\\min}}{\\sigma} \\right) \\le 0.05$$\n这可以用CDF $\\Phi(\\cdot)$ 写成：\n$$\\Phi\\left(\\frac{\\theta - A_{\\min}}{\\sigma}\\right) - \\Phi\\left(\\frac{-\\theta - A_{\\min}}{\\sigma}\\right) \\le 0.05$$\n项 $\\frac{-\\theta - A_{\\min}}{\\sigma}$ 将是一个很大的负数，因为 $\\theta  0$ 且 $A_{\\min} = 0.30$。例如，对于 $\\theta  0.1$，该参数小于 $\\frac{-0.1 - 0.3}{0.02} = -20$。对于 $z  -20$，$\\Phi(z)$ 的值极度接近0。因此，第二项可以忽略不计。不等式简化为：\n$$\\Phi\\left(\\frac{\\theta - A_{\\min}}{\\sigma}\\right) \\le 0.05$$\n为满足此条件，其参数必须小于或等于标准正态分布的第5百分位数，该值约为 $-1.645$。\n$$\\frac{\\theta - A_{\\min}}{\\sigma} \\le -1.645$$\n$$\\theta - A_{\\min} \\le -1.645 \\cdot \\sigma$$\n$$\\theta \\le A_{\\min} - 1.645 \\cdot \\sigma$$\n代入数值 $A_{\\min} = 0.30\\,\\text{Hz/s}$ 和 $\\sigma=0.02\\,\\text{Hz/s}$:\n$$\\theta \\le 0.30 - 1.645 \\cdot (0.02) = 0.30 - 0.0329 = 0.2671\\,\\text{Hz/s}$$\n这设定了阈值 $\\theta$ 的上界。\n(注意：对称情况 $\\dot{f}(k) = -A_{\\min}$ 会得到相同的上界)。\n\n**综合约束与选项评估**\n\n死区阈值 $\\theta$ 必须同时满足两个约束：\n$$0.10288\\,\\text{Hz/s} \\le \\theta \\le 0.2671\\,\\text{Hz/s}$$\n\n现在我们根据这个有效范围评估给定的选项。问题要求从选项中选择位于此范围内的最小阈值。\n\n*   **A. $\\theta = 0.104\\,\\text{Hz/s}$**:\n    该值满足两个不等式：$0.10288 \\le 0.104 \\le 0.2671$。因此，它是一个有效的阈值。\n\n*   **B. $\\theta = 0.020\\,\\text{Hz/s}$**:\n    该值违反了下界约束：$0.020 \\not\\ge 0.10288$。这么低的阈值会导致不可接受的高误触发率。不正确。\n\n*   **C. $\\theta = 0.300\\,\\text{Hz/s}$**:\n    该值违反了上界约束：$0.300 \\not\\le 0.2671$。这么高的阈值将无法满足对最小可信扰动的所需检测概率。不正确。\n\n*   **D. $\\theta = 0.150\\,\\text{Hz/s}$**:\n    该值满足两个不等式：$0.10288 \\le 0.150 \\le 0.2671$。因此，它也是一个有效的阈值。\n\n题目要求我们从选项中选择满足要求的*最小*阈值。我们有两个有效选项：A ($\\theta=0.104\\,\\text{Hz/s}$) 和 D ($\\theta=0.150\\,\\text{Hz/s}$)。比较这两个值，$0.104\\,\\text{Hz/s}$ 是较小的值。因此，选项A是所提问题的正确答案。选项D虽然是一个有效的阈值，但不是选项中最小的有效选择。\n\n**选项的最终结论：**\n- 选项A：满足两个约束，并且是满足条件的最小选项。**正确。**\n- 选项B：未能满足误触发约束。**不正确。**\n- 选项C：未能满足检测概率约束。**不正确。**\n- 选项D：满足两个约束，但不是最小的有效选项。**不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "构网型逆变器并非独立运行，它们在电网中的相互作用至关重要。本练习将我们的视角从单个逆变器扩展到一个由多个逆变器组成的微电网系统。通过引入图拉普拉斯算子来为网络交互建模，我们将分析系统的集体稳定性，特别是逆变器之间产生不良功率振荡的可能性，并探讨控制参数如何影响这些系统级的动态行为 。",
            "id": "4127833",
            "problem": "考虑一个三节点环形微电网，其节点为并网逆变器（Grid-Forming Inverters, GFI）。每个 GFI 实现一种虚拟同步电机（Virtual Synchronous Machine, VSM）式的有功功率-频率环路，经过小信号线性化后，其耦合动态特性由以下方程组建模。设 $i \\in \\{1,2,3\\}$ 为逆变器的索引。设 $\\delta_i$ 为逆变器 $i$ 的相角相对于同步参考坐标系的微小偏差（单位为弧度），$\\omega_i = \\dot{\\delta}_i$ 为逆变器 $i$ 的电频率的微小偏差（单位为弧度/秒）。假设所有逆变器相同，具有惯性系数 $M$（单位为秒）和阻尼系数 $D$（无量纲）。假设环形网络中的所有线路相同，使得每条边的线性化同步刚度为 $K_e$（单位为秒的倒数）。在标准的功角关系小角度线性化并忽略电阻效应的条件下，相连逆变器之间的线性化有功功率交换与它们的相角差成正比。由此得到的小信号模型为\n$$\n\\dot{\\delta}_i = \\omega_i,\n$$\n$$\nM \\dot{\\omega}_i = - D \\, \\omega_i - \\sum_{j \\in \\mathcal{N}(i)} K_e \\, (\\delta_i - \\delta_j),\n$$\n其中 $\\mathcal{N}(i)$ 表示环上节点 $i$ 的两个邻居节点。将状态量堆叠为 $x = [\\delta_1,\\delta_2,\\delta_3,\\omega_1,\\omega_2,\\omega_3]^\\top$，可得到一个线性时不变系统 $\\dot{x} = A x$，其分块结构由边权重为 $K_e$ 的三节点环形图的拉普拉斯矩阵 $L$ 决定。拉普拉斯矩阵 $L$ 的对角线元素等于 $2 K_e$，对于相连的节点，其非对角线元素等于 $-K_e$，其他情况为 $0$。相角单位为弧度，频率单位为弧度/秒，$M$ 的单位为秒，$D$ 无量纲，$K_e$ 的单位为秒的倒数。\n\n您的任务是分析该环形网络中由于环流功率引起的模态稳定性和振荡行为。从上述第一性原理出发，对每组参数 $(M, D, K_e)$ 执行以下操作：\n\n1. 使用分块形式构建状态矩阵 $A$\n$$\n\\dot{\\delta} = \\omega, \\quad \\dot{\\omega} = -\\frac{1}{M} L \\, \\delta - \\frac{D}{M} \\, \\omega,\n$$\n其中 $\\delta = [\\delta_1,\\delta_2,\\delta_3]^\\top$ 且 $\\omega = [\\omega_1,\\omega_2,\\omega_3]^\\top$。\n2. 计算 $A$ 的所有特征值，并判断系统在排除统一相角参考模式后是否渐近稳定。具体来说，如果除了一个恰好为零的特征值（对应于统一的相角偏移）外，所有其他特征值的实部都严格为负，则声明系统为“稳定”（stable）。使用 $10^{-9}$ 的实部数值容差和 $10^{-7}$ 的模值容差来识别并排除位于零点的单个参考模式特征值。\n3. 判断是否存在振荡模式。如果任何特征值的虚部绝对值大于 $10^{-9}$（无论其实部符号如何），则声明“振荡”（oscillatory）为真。\n4. 使用拉普拉斯矩阵的模态分解，将非零拉普拉斯模态中的最差情况阻尼比定义为\n$$\n\\zeta_{\\text{worst}} = \\frac{D}{2 \\sqrt{M \\, \\lambda_{\\max}}},\n$$\n其中 $\\lambda_{\\max}$ 是 $L$ 的最大正特征值（单位为秒的倒数）。阻尼比是无量纲的。计算 $\\zeta_{\\text{worst}}$。\n5. 提出一种调参方案，通过确保非振荡的实数模态来完全避免环流功率振荡。给出使所有非零模态变为非振荡（即临界阻尼或过阻尼）所需的最小阻尼 $D_{\\text{no\\_osc}}$，其计算公式为\n$$\nD_{\\text{no\\_osc}} = 2 \\sqrt{M \\, \\lambda_{\\max}},\n$$\n其中 $D_{\\text{no\\_osc}}$ 是无量纲的。\n\n所有角度必须以弧度处理，所有与时间相关的量必须以秒处理。对于每个测试用例，按以下顺序返回包含四个项目的列表：布尔稳定性标志、布尔振荡标志、浮点数 $\\zeta_{\\text{worst}}$（四舍五入到六位小数）和浮点数 $D_{\\text{no\\_osc}}$（四舍五入到六位小数）。\n\n测试套件（四个案例）：\n- 案例 1：$(M, D, K_e) = (0.5, 0.4, 10.0)$。\n- 案例 2：$(M, D, K_e) = (0.2, 6.0, 12.0)$。\n- 案例 3（边界，临界阻尼）：$(M, D, K_e) = (1.0, 2 \\sqrt{15}, 5.0)$，其中 $2 \\sqrt{15}$ 应进行数值计算。\n- 案例 4（无阻尼）：$(M, D, K_e) = (0.5, 0.0, 8.0)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个结果按顺序对应一个测试用例，并且本身是一个列表，格式如下\n$$\n[\\text{stable}, \\text{oscillatory}, \\zeta_{\\text{worst}}, D_{\\text{no\\_osc}}],\n$$\n其中布尔值不带引号，浮点数四舍五入到六位小数。例如，一个有效的输出格式是\n$$\n[[\\text{True}, \\text{False}, 0.123456, 7.890123],[\\dots],\\dots].\n$$",
            "solution": "该问题要求对一个由并网逆变器（GFI）构成的三节点环形微电网进行稳定性和振荡行为分析，这些逆变器被建模为虚拟同步电机（VSM）。分析将针对几组参数 $(M, D, K_e)$ 进行，其中 $M$ 是惯性系数，$D$ 是阻尼系数，$K_e$ 是每条线路的同步刚度。\n\n首先，有必要对问题陈述进行验证。问题以两种方式定义了系统动态：首先是通过每个逆变器 $i$ 的标量方程，其次是通过整个系统状态的分块矩阵方程。标量方程表述为 $M \\dot{\\omega}_i = - D \\, \\omega_i - \\sum_{j \\in \\mathcal{N}(i)} K_e \\, (\\delta_i - \\delta_j)$。对该方程进行量纲分析发现存在不一致性。在给定的单位中，$M$ 的单位是秒，$\\omega_i$ 的单位是弧度/秒，$D$ 无量纲，$K_e$ 的单位是秒的倒数。左侧 $M \\dot{\\omega}_i$ 的单位是 $\\text{s} \\cdot (\\text{rad}/\\text{s}^2)$，而右侧的项 $-D\\omega_i$ 和 $-K_e(\\delta_i - \\delta_j)$ 的单位都是弧度/秒。\n\n然而，问题立即指示使用分块形式构建状态矩阵 $A$：\n$$\n\\dot{\\delta} = \\omega, \\quad \\dot{\\omega} = -\\frac{1}{M} L \\, \\delta - \\frac{D}{M} \\, \\omega\n$$\n其中 $\\delta$ 和 $\\omega$ 是三维向量，$L$ 是图拉普拉斯矩阵。这个一阶微分方程组在量纲上是一致的。项 $-\\frac{1}{M} L \\delta$ 的单位是 $(\\text{s}^{-1}) \\cdot (\\text{s}^{-1}) \\cdot \\text{rad} = \\text{rad}/\\text{s}^2$，项 $-\\frac{D}{M} \\omega$ 的单位是 $(\\text{s}^{-1}) \\cdot (\\text{rad}/\\text{s}) = \\text{rad}/\\text{s}^2$。两者都与 $\\dot{\\omega}$ 的单位正确匹配。鉴于此分块形式是所有后续计算的基础，它被视为最终模型。最初的标量方程被认为是一个说明性的、尽管在量纲上不完美的陈述。因此，基于这个适定的分块矩阵公式，该问题被认为是有效且可解的。\n\n对于每组参数，解题过程系统地进行。\n\n**步骤 1：构建图拉普拉斯矩阵 $L$**\n该微电网是一个三节点环形网络。对于具有统一边权重 $K_e$ 的网络，图拉普拉斯矩阵 $L$ 是一个对称矩阵，其对角线元素 $L_{ii}$ 是连接到节点 $i$ 的边的权重之和，非对角线元素 $L_{ij}$ 是节点 $i$ 和 $j$ 之间边的权重的负值。对于三节点环形网络，每个节点有两个邻居。因此，拉普拉斯矩阵为：\n$$\nL = K_e\n\\begin{pmatrix}\n2  -1  -1 \\\\\n-1  2  -1 \\\\\n-1  -1  2\n\\end{pmatrix}\n$$\n这个 $3 \\times 3$ 循环矩阵的特征值已知为 $\\lambda_0 = 0$，$\\lambda_1 = 3K_e$ 和 $\\lambda_2 = 3K_e$。因此，最大正特征值为 $\\lambda_{\\max} = 3K_e$。\n\n**步骤 2：构建状态矩阵 $A$**\n状态向量为 $x = [\\delta^\\top, \\omega^\\top]^\\top$，其中 $\\delta = [\\delta_1, \\delta_2, \\delta_3]^\\top$ 且 $\\omega = [\\omega_1, \\omega_2, \\omega_3]^\\top$。状态空间表示 $\\dot{x} = Ax$ 由给定的分块方程导出。状态矩阵 $A$ 是一个 $6 \\times 6$ 的分块矩阵：\n$$\nA =\n\\begin{pmatrix}\n0_{3 \\times 3}  I_{3 \\times 3} \\\\\n-\\frac{1}{M} L  -\\frac{D}{M} I_{3 \\times 3}\n\\end{pmatrix}\n$$\n其中 $0_{3 \\times 3}$ 是 $3 \\times 3$ 零矩阵，$I_{3 \\times 3}$ 是 $3 \\times 3$ 单位矩阵。\n\n**步骤 3：模态分析和特征值计算**\n分块矩阵 $A$ 的特征值决定了系统的稳定性和振荡性质。这些特征值可以通过将它们与拉普拉斯矩阵的特征值 $\\lambda_k$ 相关联来找到。对于 $L$ 的每个特征值 $\\lambda_k$，都有一对相应的 $A$ 的特征值，它们是特征方程的根：\n$$\ns^2 + \\frac{D}{M} s + \\frac{\\lambda_k}{M} = 0\n$$\n- 对于拉普拉斯矩阵的零特征值 $\\lambda_0 = 0$，方程为 $s^2 + \\frac{D}{M}s = 0$，这为 $A$ 产生两个特征值：$s_1 = 0$ 和 $s_2 = -D/M$。$s_1=0$ 特征值对应于系统对所有转子角度的统一偏移的不变性，表示选择参考相角的自由度。\n- 对于重复的正特征值 $\\lambda_{1,2} = \\lambda_{\\max} = 3K_e$，我们有两个相同的特征方程：\n$$\ns^2 + \\frac{D}{M} s + \\frac{3K_e}{M} = 0\n$$\n这给出了两对相同的根。这些根的性质（实数或复数）决定了逆变器间模式的振荡行为。\n\n**步骤 4：对每个测试案例进行系统分析**\n对于每组给定的参数 $(M, D, K_e)$，计算以下量：\n1.  **稳定性 (`stable`)**：构建完整的矩阵 $A$ 并数值计算其六个特征值。如果恰好有一个特征值的模小于 $10^{-7}$（零模态），并且所有其他五个特征值的实部严格小于 $-10^{-9}$，则系统被声明为“稳定”（stable）。\n2.  **振荡行为 (`oscillatory`)**：如果 $A$ 的六个特征值中任何一个的虚部绝对值大于 $10^{-9}$，则系统为“振荡的”（oscillatory）。\n3.  **最差情况阻尼比 ($\\zeta_{\\text{worst}}$)**：这是为阻尼最小的振荡模式计算的，该模式对应于最大的拉普拉斯特征值 $\\lambda_{\\max}$。公式为：\n$$\n\\zeta_{\\text{worst}} = \\frac{D}{2 \\sqrt{M \\lambda_{\\max}}} = \\frac{D}{2 \\sqrt{3 M K_e}}\n$$\n4.  **非振荡模式的最小阻尼 ($D_{\\text{no\\_osc}}$)**：这是使最差情况阻尼比等于一（$\\zeta_{\\text{worst}} = 1$）的 $D$ 值，这是一条临界阻尼的边界。\n$$\nD_{\\text{no\\_osc}} = 2 \\sqrt{M \\lambda_{\\max}} = 2 \\sqrt{3 M K_e}\n$$\n\n对每个测试案例进行计算，并按规定汇编结果。\n- **案例 1**：$(M, D, K_e) = (0.5, 0.4, 10.0)$。系统是欠阻尼的（$\\zeta_{\\text{worst}}  1$），导致稳定的振荡。\n- **案例 2**：$(M, D, K_e) = (0.2, 6.0, 12.0)$。系统是过阻尼的（$\\zeta_{\\text{worst}} > 1$），导致扰动的稳定、非振荡衰减。\n- **案例 3**：$(M, D, K_e) = (1.0, 2\\sqrt{15}, 5.0)$。阻尼被精确地设置为临界阻尼值，$D = D_{\\text{no\\_osc}}$，得出 $\\zeta_{\\text{worst}} = 1$。系统是稳定且非振荡的。\n- **案例 4**：$(M, D, K_e) = (0.5, 0.0, 8.0)$。在零阻尼（$D=0$）情况下，系统仅为临界稳定。在零点有一个二重特征值，违反了渐近稳定的条件。其他模式是无阻尼的纯振荡。系统被标记为不稳定。\n\n通过在一个可运行的程序中实现这些步骤来生成最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the microgrid stability analysis problem for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.5, 0.4, 10.0),\n        (0.2, 6.0, 12.0),\n        (1.0, 2 * np.sqrt(15), 5.0),\n        (0.5, 0.0, 8.0),\n    ]\n\n    # Tolerances for numerical checks\n    ZERO_MAG_TOL = 1e-7\n    NEG_REAL_TOL = -1e-9\n    IMAG_TOL = 1e-9\n\n    results = []\n    \n    for M, D, Ke in test_cases:\n        # Step 1: Construct the Graph Laplacian L for a 3-node ring\n        L = Ke * np.array([\n            [2, -1, -1],\n            [-1, 2, -1],\n            [-1, -1, 2]\n        ])\n\n        # Step 2: Construct the State Matrix A\n        n_nodes = 3\n        Z = np.zeros((n_nodes, n_nodes))\n        I = np.eye(n_nodes)\n        \n        A_top = np.block([Z, I])\n        # Handle M=0 case to avoid division by zero, though not in test cases.\n        if M == 0:\n            # System dynamics are ill-defined if M=0. For robustness, treat as unstable.\n            results.append([False, False, float('inf'), float('inf')])\n            continue\n            \n        A_bottom = np.block([(-1 / M) * L, (-D / M) * I])\n        A = np.block([[A_top], [A_bottom]])\n\n        # Step 3: Compute eigenvalues of A\n        eigenvalues = np.linalg.eigvals(A)\n\n        # Step 4: Analyze eigenvalues for stability and oscillations\n\n        # Task 2: Stability check\n        # Identify eigenvalues that are numerically close to zero.\n        zero_eigs = [eig for eig in eigenvalues if np.abs(eig)  ZERO_MAG_TOL]\n        \n        # Identify non-zero eigenvalues.\n        non_zero_eigs = [eig for eig in eigenvalues if np.abs(eig) >= ZERO_MAG_TOL]\n        \n        # Stability requires a single zero eigenvalue and all others to have strictly negative real parts.\n        is_stable = False\n        if len(zero_eigs) == 1:\n            if all(eig.real  NEG_REAL_TOL for eig in non_zero_eigs):\n                is_stable = True\n        \n        # Task 3: Oscillation check\n        # Check if any eigenvalue has a significant imaginary part.\n        is_oscillatory = any(np.abs(eig.imag) > IMAG_TOL for eig in eigenvalues)\n\n        # Task 4: Compute worst-case damping ratio\n        # The largest positive eigenvalue of L for a 3-node ring is 3*Ke\n        lambda_max = 3 * Ke\n        \n        # Denominator for zeta_worst and D_no_osc\n        denominator_term = 2 * np.sqrt(M * lambda_max) if M * lambda_max > 0 else 0\n        \n        # Avoid division by zero if M or Ke is zero\n        if denominator_term > 0:\n            zeta_worst = D / denominator_term\n        else:\n            # If D > 0, damping is infinite. If D=0, it is undefined.\n            # Given problem constraints, this case is not critical.\n            zeta_worst = float('inf') if D > 0 else 0.0\n\n        # Task 5: Compute minimum damping for non-oscillatory behavior\n        D_no_osc = denominator_term\n\n        # Collect results for this case\n        results.append([is_stable, is_oscillatory, zeta_worst, D_no_osc])\n\n    # Format the final output string as specified\n    formatted_results = []\n    for res in results:\n        stable, oscillatory, zeta, d_no_osc = res\n        # Python's bool __str__ is 'True' or 'False'. Need to convert to lowercase 'true' or 'false'\n        stable_str = str(stable).lower()\n        oscillatory_str = str(oscillatory).lower()\n        s = f\"[{stable_str}, {oscillatory_str}, {zeta:.6f}, {d_no_osc:.6f}]\"\n        formatted_results.append(s)\n    \n    # Final print statement in the exact required format. The problem asks for non-quoted booleans like \"True\", \"False\".\n    # My python bool to str conversion `str(stable)` yields \"True\", not \"true\". The example output shows \"True\", \"False\".\n    # Let me re-read the example: `[True, False, 0.123456, 7.890123]`. The prompt says \"布尔值不带引号\" (booleans without quotes). Python's `str(bool)` does exactly that. So my original code was correct, except for the example output text, which used `true`/`false`. The prompt's *actual* example used `True`/`False`. This is confusing. Let's follow the prompt's final instruction \"例如，一个有效的输出格式是 [[True, False, 0.123456, 7.890123],[\\dots],\\dots].\" This uses capital `True/False`. Okay, so `str(bool)` is correct. I will remove my lowercase conversion.\n\n    final_formatted_results = []\n    for res in results:\n        stable, oscillatory, zeta, d_no_osc = res\n        s = f\"[{str(stable)}, {str(oscillatory)}, {zeta:.6f}, {d_no_osc:.6f}]\"\n        final_formatted_results.append(s)\n\n    print(f\"[{','.join(final_formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}