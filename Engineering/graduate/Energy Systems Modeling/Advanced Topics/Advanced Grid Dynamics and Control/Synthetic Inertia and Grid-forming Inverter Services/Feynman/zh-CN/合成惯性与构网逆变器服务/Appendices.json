{
    "hands_on_practices": [
        {
            "introduction": "并网逆变器提供合成惯量的基本任务是模拟同步发电机的动态行为。本练习  将指导您完成设计关键控制参数——合成惯量 $M$ 和阻尼 $D$——的全过程，以实现特定的动态性能目标。通过运用经典的极点配置技术，您将学习如何将期望的系统响应（如阻尼比和自然频率）转化为具体的控制器增益。",
            "id": "4127863",
            "problem": "一个连接到强电网的构网型逆变器通过频率控制环路来提供虚拟惯量和阻尼。逆变器端电压幅值保持在 $1.0$ 标幺值 (p.u.)，电网母线电压幅值为 $1.0$ 标幺值。逆变器通过等效电抗 $X_{\\mathrm{eq}}$ 连接到电网，其稳态功率传输遵循功角关系，在小角度下，该关系可以由线性化的同步转矩（功角灵敏度）很好地近似。逆变器的频率控制环路通过指令其有功功率来模拟二阶机电动态，使得角度 $\\delta(t)$（单位为弧度）和频率偏差 $\\omega(t) = \\dot{\\delta}(t)$ 由一个等效惯量参数 $M$ 和一个阻尼参数 $D$ 控制。\n\n从第一性原理和经过验证的公式出发，完成以下任务：\n\n1. 利用电抗后电源与电网之间的正弦潮流关系及其小角度线性化，用 $V_{\\mathrm{inv}}$、$V_{\\mathrm{g}}$ 和 $X_{\\mathrm{eq}}$ 表示同步功率系数 $K_{s}$。假设工作点满足 $\\delta_{0} \\approx 0$ 且角度单位为弧度。\n2. 利用模拟摇擺动态的虚拟惯量和阻尼控制律，推导关于 $\\delta(t)$ 的小信号齐次二阶微分方程，并确定相应的闭环特征多项式。\n3. 给定阻尼比 $\\zeta = 0.7$ 和自然频率 $\\omega_{n}$ 的设计目标，通过求解以 $K_{s}$、$\\zeta$ 和 $\\omega_{n}$ 表示的 $M$ 和 $D$，将闭环极点配置在期望的位置。\n4. 对于 $V_{\\mathrm{inv}} = 1.0$ p.u.、$V_{\\mathrm{g}} = 1.0$ p.u.、$X_{\\mathrm{eq}} = 0.3$ p.u. 以及期望的 $\\omega_{n} = 20$ 弧度/秒的特定情况，计算与第 3 部分中的极点配置相对应的 $M$ 和 $D$ 的数值。\n\n按以下格式表示最终数值：\n- 角度使用弧度。\n- 将数值四舍五入至四位有效数字。\n- $M$ 以 p.u.$\\cdot$秒平方 (p.u.$\\cdot$s$^2$) 为单位。\n- $D$ 以 p.u.$\\cdot$秒 (p.u.$\\cdot$s) 为单位。\n\n您的最终答案必须是一个包含 $M$ 和 $D$ 的单行矩阵，并使用指定的单位和舍入规则。",
            "solution": "### 问题验证\n#### 步骤 1：提取已知条件\n问题提供以下信息：\n-   逆变器端电压幅值：$V_{\\mathrm{inv}} = 1.0$ 标幺值 (p.u.)。\n-   电网母线电压幅值：$V_{\\mathrm{g}} = 1.0$ p.u.。\n-   等效电抗：$X_{\\mathrm{eq}} = 0.3$ p.u.。\n-   稳态工作点角度：$\\delta_{0} \\approx 0$ 弧度。\n-   系统动态由等效惯量参数 $M$ 和阻尼参数 $D$ 控制。\n-   角度用 $\\delta(t)$ 表示，单位为弧度。\n-   频率偏差定义为 $\\omega(t) = \\dot{\\delta}(t)$。\n-   该控制系统模拟一个二阶机电动态。\n-   阻尼比设计目标：$\\zeta = 0.7$。\n-   自然频率设计目标：$\\omega_{n} = 20$ 弧度/秒。\n-   最终答案所需单位：$M$ 的单位为 p.u.$\\cdot$s$^{2}$，$D$ 的单位为 p.u.$\\cdot$s。\n-   最终答案所需精度：四舍五入至四位有效数字。\n\n#### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确且客观。\n-   **科学依据：** 该问题基于电力系统分析的基本原理，包括交流潮流的功角关系和用于稳定性分析的二阶摇摆方程模型。由构网型逆变器提供虚拟惯量的概念是现代电力系统研究与工程领域一个成熟的课题。所有物理量及其关系均合理。\n-   **提法明确：** 该问题被构建为一个标准的控制设计任务。它提供了足够的信息（系统参数、控制目标）来确定控制参数（$M$ 和 $D$）的唯一解。其步骤逻辑清晰，可导出一个明确、可计算的结果。\n-   **客观性：** 其语言精确且定量。所有术语如“虚拟惯量”、“阻尼比”和“自然频率”均为控制理论和电力工程中的标准术语。\n\n该问题没有任何无效性缺陷。它是一个为提供辅助服务的跟网型逆变器进行控制参数设计的教科书式案例。对 $M$ 和 $D$ 特定单位的要求澄清了该领域的常见约定，即在状态空间表达式中，以弧度为单位的角度被视为无量纲量，从而解决了潜在的歧义。\n\n#### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n本题要求对提供虚拟惯量的构网型逆变器进行控制设计，包括多部分推导和计算。\n\n#### 第 1 部分：同步功率系数 ($K_s$)\n从逆变器经由电抗 $X_{\\mathrm{eq}}$ 传输到电网的有功功率 $P$ 由潮流关系式给出：\n$$P(\\delta) = \\frac{V_{\\mathrm{inv}} V_{\\mathrm{g}}}{X_{\\mathrm{eq}}} \\sin(\\delta)$$\n其中 $\\delta$ 是逆变器电压相对于电网电压的角度。\n\n同步功率系数 $K_s$ 表示电气连接的刚度，定义为功角曲线在工作点 $\\delta_0$ 处的斜率。它是功率对角度的一阶导数：\n$$K_s = \\frac{dP}{d\\delta} \\bigg|_{\\delta=\\delta_0} = \\frac{V_{\\mathrm{inv}} V_{\\mathrm{g}}}{X_{\\mathrm{eq}}} \\cos(\\delta_0)$$\n问题指定在工作点 $\\delta_0 \\approx 0$ 附近进行小角度线性化。在此点，$\\cos(\\delta_0) \\approx \\cos(0) = 1$。因此，同步功率系数为：\n$$K_s = \\frac{V_{\\mathrm{inv}} V_{\\mathrm{g}}}{X_{\\mathrm{eq}}}$$\n\n#### 第 2 部分：动态方程与特征多项式\n逆变器的控制环路模拟机电摇摆方程，这是一个二阶系统。该方程的一般形式将惯性力矩（功率）和阻尼力矩（功率）与加速力矩（功率）联系起来，后者是参考功率 $P_{\\mathrm{ref}}$（类似于机械功率）与电气功率输出 $P_e$ 之差。\n$$M \\frac{d^2\\delta(t)}{dt^2} + D \\frac{d\\delta(t)}{dt} = P_{\\mathrm{ref}}(t) - P_e(t)$$\n为进行小信号稳定性分析，我们分析系统在稳态工作点 $(\\delta_0, P_{e0})$（其中 $P_{e0} = P_{\\mathrm{ref}}$）附近对小扰动的响应。设 $\\delta(t) = \\delta_0 + \\Delta\\delta(t)$ 且 $P_e(t) = P_{e0} + \\Delta P_e(t)$。假设功率参考值恒定（$\\Delta P_{\\mathrm{ref}} = 0$），则扰动的线性化方程变为：\n$$M \\frac{d^2(\\Delta\\delta)}{dt^2} + D \\frac{d(\\Delta\\delta)}{dt} = -\\Delta P_e(t)$$\n电气功率的变化量 $\\Delta P_e$ 与角度变化量 $\\Delta\\delta$ 通过第 1 部分的同步功率系数 $K_s$ 相关联：\n$$\\Delta P_e(t) \\approx K_s \\Delta\\delta(t)$$\n将此代入动态方程，我们得到齐次二阶线性微分方程。为简化符号，我们用 $\\delta(t)$ 表示偏差 $\\Delta\\delta(t)$。\n$$M \\ddot{\\delta}(t) + D \\dot{\\delta}(t) = -K_s \\delta(t)$$\n$$M \\ddot{\\delta}(t) + D \\dot{\\delta}(t) + K_s \\delta(t) = 0$$\n为求特征多项式，我们对此方程进行拉普拉斯变换，并假设初始条件为零：\n$$M s^2 \\Delta(s) + D s \\Delta(s) + K_s \\Delta(s) = 0$$\n两边同除以 $\\Delta(s)$，得到特征多项式 $C(s)$ 为：\n$$C(s) = M s^2 + D s + K_s = 0$$\n\n#### 第 3 部分：$M$ 和 $D$ 的极点配置\n目标是配置闭环极点以达到期望的阻尼比 $\\zeta$ 和自然频率 $\\omega_n$。二阶系统的标准特征多项式为：\n$$s^2 + 2\\zeta\\omega_n s + \\omega_n^2 = 0$$\n为使我们推导的特征方程与此标准形式匹配，我们将方程两边同除以 $M$：\n$$s^2 + \\frac{D}{M} s + \\frac{K_s}{M} = 0$$\n通过比较两种多项式形式的系数，我们得到两个代数方程：\n1.  $\\omega_n^2 = \\frac{K_s}{M}$\n2.  $2\\zeta\\omega_n = \\frac{D}{M}$\n\n现在我们可以用 $K_s$、$\\zeta$ 和 $\\omega_n$ 来求解 $M$ 和 $D$。由方程 (1) 得：\n$$M = \\frac{K_s}{\\omega_n^2}$$\n由方程 (2)，我们求解 $D$：\n$$D = 2\\zeta\\omega_n M$$\n将 $M$ 的表达式代入 $D$ 的方程中：\n$$D = 2\\zeta\\omega_n \\left( \\frac{K_s}{\\omega_n^2} \\right) = \\frac{2\\zeta K_s}{\\omega_n}$$\n这些就是所需的虚拟惯量 $M$ 和阻尼 $D$ 的表达式。\n\n#### 第 4 部分：数值计算\n给定以下具体数值：\n-   $V_{\\mathrm{inv}} = 1.0$ 标幺值\n-   $V_{\\mathrm{g}} = 1.0$ 标幺值\n-   $X_{\\mathrm{eq}} = 0.3$ 标幺值\n-   $\\zeta = 0.7$\n-   $\\omega_n = 20$ 弧度/秒\n\n首先，我们根据第 1 部分计算同步功率系数 $K_s$。根据问题的单位说明，$K_s$ 以标幺值计。\n$$K_s = \\frac{V_{\\mathrm{inv}} V_{\\mathrm{g}}}{X_{\\mathrm{eq}}} = \\frac{1.0 \\times 1.0}{0.3} = \\frac{10}{3} \\text{ p.u.}$$\n接下来，我们使用第 3 部分的公式计算 $M$ 和 $D$。\n\n对于惯量参数 $M$：\n$$M = \\frac{K_s}{\\omega_n^2} = \\frac{10/3}{(20)^2} = \\frac{10}{3 \\times 400} = \\frac{10}{1200} = \\frac{1}{120} \\text{ p.u.}\\cdot\\text{s}^2$$\n以小数表示，$M = 0.0083333...$ p.u.$\\cdot$s$^2$。四舍五入到四位有效数字，得到：\n$$M \\approx 0.008333 \\text{ p.u.}\\cdot\\text{s}^2$$\n对于阻尼参数 $D$：\n$$D = \\frac{2\\zeta K_s}{\\omega_n} = \\frac{2 \\times 0.7 \\times (10/3)}{20} = \\frac{1.4 \\times 10}{3 \\times 20} = \\frac{14}{60} = \\frac{7}{30} \\text{ p.u.}\\cdot\\text{s}$$\n以小数表示，$D = 0.23333...$ p.u.$\\cdot$s。四舍五入到四位有效数字，得到：\n$$D \\approx 0.2333 \\text{ p.u.}\\cdot\\text{s}$$\n计算出的 $M$ 和 $D$ 值将使系统极点满足 $\\zeta=0.7$ 和 $\\omega_n=20$ rad/s 的指定性能要求。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.008333  0.2333\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一个鲁棒的控制系统依赖于准确可靠的输入信号。在合成惯量应用中，控制器的主要输入是频率变化率（ROCOF），而该值必须从可能带有噪声的频率测量中估算得出。本实践  深入探讨了一种常用的有限差分ROCOF估算器的统计分析，使您能够量化测量噪声如何影响估算器的方差，并理解其设计中的权衡。",
            "id": "4127896",
            "problem": "一个负责模拟合成惯量的构网型逆变器依赖于对频率变化率（ROCOF）的在线估计来调节其快速有功功率注入。考虑一个在时间点 $t$ 和 $t-\\Delta$ 采样的频率测量模型，由 $f(t)=f_{0}+\\alpha t+\\epsilon(t)$ 给出，其中 $f_{0}$ 和 $\\alpha$ 是确定性常数，$\\epsilon(t)$ 代表测量噪声。假设 $\\epsilon(t)$ 是零均值白噪声，具有宽平稳（WSS）特性，方差为 $\\sigma_{\\epsilon}^{2}$，并且在不同时间点上不相关（即，对于 $t\\neq s$，$\\operatorname{Cov}(\\epsilon(t),\\epsilon(s))=0$）。在时间 $t$，无噪声斜坡分量的ROCOF是 $r(t)=\\frac{d}{dt}\\left(f_{0}+\\alpha t\\right)=\\alpha$。\n\n逆变器使用有限差分估计器 $\\hat{r}(t)=\\frac{f(t)-f(t-\\Delta)}{\\Delta}$ 来估计ROCOF。从期望、方差的定义以及白噪声的性质出发，在给定的模型和假设下，推导 $\\hat{r}(t)$ 相对于真实ROCOF $r(t)$ 的偏差和方差。偏差以 $\\mathrm{Hz/s}$ 表示，方差以 $(\\mathrm{Hz/s})^2$ 表示。没有提供数值；你的最终答案必须是关于 $\\alpha$、$\\Delta$ 和 $\\sigma_{\\epsilon}^{2}$ 的闭式表达式。无需四舍五入。",
            "solution": "该问题要求推导频率变化率（ROCOF）的有限差分估计器的偏差和方差。验证过程确认了该问题具有科学依据、提法恰当且完整。因此，我们可以继续进行推导。\n\n给定的频率测量模型为：\n$$f(t) = f_{0} + \\alpha t + \\epsilon(t)$$\n其中 $f_{0}$ 和 $\\alpha$ 是确定性常数，$\\epsilon(t)$ 是一个零均值、宽平稳（WSS）的白噪声过程。噪声的性质如下：\n1.  期望：对于所有 $t$, $E[\\epsilon(t)] = 0$。\n2.  方差：由于宽平稳特性，对于所有 $t$, $\\operatorname{Var}(\\epsilon(t)) = E[\\epsilon(t)^2] - (E[\\epsilon(t)])^2 = E[\\epsilon(t)^2] = \\sigma_{\\epsilon}^{2}$。\n3.  不相关性：对于 $t \\neq s$, $\\operatorname{Cov}(\\epsilon(t), \\epsilon(s)) = 0$。由于均值为零，这意味着对于 $t \\neq s$, $E[\\epsilon(t)\\epsilon(s)] = E[\\epsilon(t)]E[\\epsilon(s)] = 0$。\n\n信号确定性部分的真实ROCOF定义为：\n$$r(t) = \\frac{d}{dt}\\left(f_{0} + \\alpha t\\right) = \\alpha$$\nROCOF的估计器 $\\hat{r}(t)$ 由后向有限差分公式给出：\n$$\\hat{r}(t) = \\frac{f(t) - f(t-\\Delta)}{\\Delta}$$\n\n首先，我们用模型的分量来表示估计器 $\\hat{r}(t)$。我们代入在时间点 $t$ 和 $t-\\Delta$ 的 $f(t)$ 表达式：\n$$f(t) = f_{0} + \\alpha t + \\epsilon(t)$$\n$$f(t-\\Delta) = f_{0} + \\alpha(t-\\Delta) + \\epsilon(t-\\Delta)$$\n将这些代入估计器方程：\n$$\\hat{r}(t) = \\frac{1}{\\Delta} \\left[ (f_{0} + \\alpha t + \\epsilon(t)) - (f_{0} + \\alpha(t-\\Delta) + \\epsilon(t-\\Delta)) \\right]$$\n我们通过合并项来简化表达式：\n$$\\hat{r}(t) = \\frac{1}{\\Delta} \\left[ (f_{0} - f_{0}) + (\\alpha t - \\alpha(t-\\Delta)) + (\\epsilon(t) - \\epsilon(t-\\Delta)) \\right]$$\n$$\\hat{r}(t) = \\frac{1}{\\Delta} \\left[ \\alpha \\Delta + \\epsilon(t) - \\epsilon(t-\\Delta) \\right]$$\n$$\\hat{r}(t) = \\alpha + \\frac{\\epsilon(t) - \\epsilon(t-\\Delta)}{\\Delta}$$\n这个表达式将估计器分解为真值 $\\alpha$ 和一个依赖于噪声的误差项。\n\n**偏差的推导**\n\n估计器 $\\hat{r}(t)$ 相对于真值 $r(t)=\\alpha$ 的偏差定义为：\n$$\\operatorname{Bias}(\\hat{r}(t)) = E[\\hat{r}(t)] - r(t) = E[\\hat{r}(t)] - \\alpha$$\n我们计算估计器 $E[\\hat{r}(t)]$ 的期望：\n$$E[\\hat{r}(t)] = E\\left[\\alpha + \\frac{\\epsilon(t) - \\epsilon(t-\\Delta)}{\\Delta}\\right]$$\n根据期望算子的线性性：\n$$E[\\hat{r}(t)] = E[\\alpha] + \\frac{1}{\\Delta} \\left( E[\\epsilon(t)] - E[\\epsilon(t-\\Delta)] \\right)$$\n由于 $\\alpha$ 是一个确定性常数，所以 $E[\\alpha] = \\alpha$。噪声是零均值的，所以 $E[\\epsilon(t)] = 0$ 且 $E[\\epsilon(t-\\Delta)] = 0$。\n$$E[\\hat{r}(t)] = \\alpha + \\frac{1}{\\Delta} (0 - 0) = \\alpha$$\n估计器的期望值等于真值。因此，偏差为：\n$$\\operatorname{Bias}(\\hat{r}(t)) = \\alpha - \\alpha = 0$$\n该估计器是无偏的。偏差为 $0 \\ \\mathrm{Hz/s}$。\n\n**方差的推导**\n\n估计器 $\\hat{r}(t)$ 的方差定义为：\n$$\\operatorname{Var}(\\hat{r}(t)) = E\\left[ (\\hat{r}(t) - E[\\hat{r}(t)])^2 \\right]$$\n从前面的步骤我们知道 $E[\\hat{r}(t)] = \\alpha$。代入 $\\hat{r}(t)$ 及其期望的表达式：\n$$\\operatorname{Var}(\\hat{r}(t)) = E\\left[ \\left( \\left(\\alpha + \\frac{\\epsilon(t) - \\epsilon(t-\\Delta)}{\\Delta}\\right) - \\alpha \\right)^2 \\right]$$\n$$\\operatorname{Var}(\\hat{r}(t)) = E\\left[ \\left( \\frac{\\epsilon(t) - \\epsilon(t-\\Delta)}{\\Delta} \\right)^2 \\right]$$\n我们可以将常数项 $\\frac{1}{\\Delta^2}$ 提出来：\n$$\\operatorname{Var}(\\hat{r}(t)) = \\frac{1}{\\Delta^2} E\\left[ (\\epsilon(t) - \\epsilon(t-\\Delta))^2 \\right]$$\n现在，我们展开期望内的平方项：\n$$(\\epsilon(t) - \\epsilon(t-\\Delta))^2 = \\epsilon(t)^2 - 2\\epsilon(t)\\epsilon(t-\\Delta) + \\epsilon(t-\\Delta)^2$$\n应用期望算子并利用其线性性：\n$$E\\left[ (\\epsilon(t) - \\epsilon(t-\\Delta))^2 \\right] = E[\\epsilon(t)^2] - 2E[\\epsilon(t)\\epsilon(t-\\Delta)] + E[\\epsilon(t-\\Delta)^2]$$\n我们使用噪声 $\\epsilon(t)$ 的给定性质来计算每一项：\n1.  噪声的方差为 $\\operatorname{Var}(\\epsilon(t)) = \\sigma_{\\epsilon}^{2}$。由于均值为 $0$，我们有 $E[\\epsilon(t)^2] = \\sigma_{\\epsilon}^{2}$。由于噪声是宽平稳的，方差是恒定的，所以 $E[\\epsilon(t-\\Delta)^2] = \\sigma_{\\epsilon}^{2}$。\n2.  噪声在不同时间点上是不相关的。对于任何采样间隔 $\\Delta  0$，时间点 $t$ 和 $t-\\Delta$ 是不同的。因此，协方差为零：$\\operatorname{Cov}(\\epsilon(t), \\epsilon(t-\\Delta)) = 0$。由于均值为零，这意味着 $E[\\epsilon(t)\\epsilon(t-\\Delta)] = 0$。\n\n将这些结果代回展开的期望中：\n$$E\\left[ (\\epsilon(t) - \\epsilon(t-\\Delta))^2 \\right] = \\sigma_{\\epsilon}^{2} - 2(0) + \\sigma_{\\epsilon}^{2} = 2\\sigma_{\\epsilon}^{2}$$\n最后，我们将此结果代回 $\\hat{r}(t)$ 的方差表达式中：\n$$\\operatorname{Var}(\\hat{r}(t)) = \\frac{1}{\\Delta^2} (2\\sigma_{\\epsilon}^{2}) = \\frac{2\\sigma_{\\epsilon}^{2}}{\\Delta^2}$$\n估计器的方差为 $\\frac{2\\sigma_{\\epsilon}^{2}}{\\Delta^2} \\ (\\mathrm{Hz/s})^2$。\n\n因此，偏差和方差分别确定为 $0$ 和 $\\frac{2\\sigma_{\\epsilon}^{2}}{\\Delta^{2}}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0  \\frac{2\\sigma_{\\epsilon}^{2}}{\\Delta^{2}} \\end{pmatrix}}$$"
        },
        {
            "introduction": "当多个构网型逆变器在微电网中协同工作时，它们的相互作用可能引发复杂的系统级动态行为，包括不希望出现的功率振荡。最后的这个实践  将分析从单个逆变器提升到多逆变器网络层面。您将为一个环形微电网构建状态空间模型，并利用特征值分析来评估其稳定性，从而深入了解控制参数如何影响整个系统的稳定性。",
            "id": "4127833",
            "problem": "考虑一个三节点环形微电网，其节点为构网型逆变器 (GFI)。每个 GFI 实现一个虚拟同步机 (VSM) 风格的有功功率-频率环路，经过小信号线性化后，其耦合动态特性由以下方程建模。设 $i \\in \\{1,2,3\\}$ 为逆变器的索引。设 $\\delta_i$ 为逆变器 $i$ 的相角相对于同步参考坐标系的微小偏差（单位为弧度），$\\omega_i = \\dot{\\delta}_i$ 为逆变器 $i$ 的电频率的微小偏差（单位为弧度/秒）。假设逆变器完全相同，具有类惯性系数 $M$（单位为秒）和类阻尼系数 $D$（无量纲）。假设环路周围的线路完全相同，使得每条边的线性化同步刚度为 $K_e$（单位为秒的倒数）。在标准的功率-相角关系小角度线性化并忽略电阻效应的情况下，连接的逆变器之间交换的线性化有功功率与其相角差成正比。得到的小信号模型为\n$$\n\\dot{\\delta}_i = \\omega_i,\n$$\n$$\n\\dot{\\omega}_i = - \\frac{D}{M} \\omega_i - \\frac{1}{M} \\sum_{j \\in \\mathcal{N}(i)} K_e (\\delta_i - \\delta_j),\n$$\n其中 $\\mathcal{N}(i)$ 表示节点 $i$ 在环上的两个邻居。将状态量堆叠为 $x = [\\delta_1,\\delta_2,\\delta_3,\\omega_1,\\omega_2,\\omega_3]^\\top$，可得到一个线性时不变系统 $\\dot{x} = A x$，其块结构由边权重为 $K_e$ 的三节点环形图的拉普拉斯矩阵 $L$ 决定。拉普拉斯矩阵 $L$ 的对角线元素等于 $2 K_e$，对于相连的节点，其非对角线元素等于 $-K_e$，否则为 $0$。相角单位为弧度，频率单位为弧度/秒，$M$ 的单位为秒，$D$ 为无量纲，$K_e$ 的单位为秒的倒数。\n\n您的任务是分析该环形网络中由环流功率引起的模态稳定性和振荡行为。从上述第一性原理出发，对每组参数 $(M, D, K_e)$ 执行以下操作：\n\n1. 使用以下分块形式构建状态矩阵 $A$\n$$\n\\dot{\\delta} = \\omega, \\quad \\dot{\\omega} = -\\frac{1}{M} L \\, \\delta - \\frac{D}{M} \\, \\omega,\n$$\n其中 $\\delta = [\\delta_1,\\delta_2,\\delta_3]^\\top$ 且 $\\omega = [\\omega_1,\\omega_2,\\omega_3]^\\top$。\n2. 计算 $A$ 的所有特征值，并确定系统是否渐近稳定（不包括统一相角参考模式）。具体来说，如果除了一个精确为零的特征值（对应于统一相角偏移）外，其他所有特征值的实部都严格为负，则声明系统为“稳定” (stable)。使用 $10^{-9}$ 的实部数值容差和 $10^{-7}$ 的模值容差来识别并排除那个位于零点的单一参考模式特征值。\n3. 确定是否存在任何振荡模式。如果任何特征值的虚部绝对值大于 $10^{-9}$（无论其实部符号如何），则声明“存在振荡” (oscillatory) 为真。\n4. 使用拉普拉斯矩阵的模态分解，将非零拉普拉斯模态中的最差情况阻尼比定义为\n$$\n\\zeta_{\\text{worst}} = \\frac{D}{2 \\sqrt{M \\, \\lambda_{\\max}}},\n$$\n其中 $\\lambda_{\\max}$ 是 $L$ 的最大正特征值（单位为秒的倒数）。阻尼比是无量纲的。计算 $\\zeta_{\\text{worst}}$。\n5. 提出一种调谐方案，通过确保非振荡的实数模态来完全避免环流功率振荡。提供使所有非零模态变为非振荡（即临界阻尼或过阻尼）所需的最小阻尼 $D_{\\text{no\\_osc}}$，由下式给出\n$$\nD_{\\text{no\\_osc}} = 2 \\sqrt{M \\, \\lambda_{\\max}},\n$$\n其中 $D_{\\text{no\\_osc}}$ 是无量纲的。\n\n所有相角必须以弧度处理，所有与时间相关的量必须以秒为单位。对于每个测试用例，按以下顺序返回包含四个项目的列表：布尔稳定性标志、布尔振荡标志、浮点数 $\\zeta_{\\text{worst}}$（四舍五入到六位小数）和浮点数 $D_{\\text{no\\_osc}}$（四舍五入到六位小数）。\n\n测试套件（四个案例）：\n- 情况 1：$(M, D, K_e) = (0.5, 0.4, 10.0)$。\n- 情况 2：$(M, D, K_e) = (0.2, 6.0, 12.0)$。\n- 情况 3（边界，临界阻尼）：$(M, D, K_e) = (1.0, 2 \\sqrt{15}, 5.0)$，其中 $2 \\sqrt{15}$ 应进行数值计算。\n- 情况 4（无阻尼）：$(M, D, K_e) = (0.5, 0.0, 8.0)$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个结果对应一个测试用例，并按顺序排列，其本身是一个列表，格式如下\n$$\n[\\text{stable}, \\text{oscillatory}, \\zeta_{\\text{worst}}, D_{\\text{no\\_osc}}],\n$$\n其中布尔值不带引号，浮点数四舍五入到六位小数。例如，一个有效的输出格式是\n$$\n[[\\text{True}, \\text{False}, 0.123456, 7.890123],[\\dots],\\dots].\n$$",
            "solution": "该问题要求对一个由构网型逆变器（GFI）组成的三节点环形微电网进行稳定性和振荡行为分析。这些逆变器被建模为虚拟同步机（VSM），其动态由给定的状态空间方程描述。该分析需要针对几组参数 $(M, D, K_e)$ 进行，其中 $M$ 是类惯性系数，$D$ 是类阻尼系数，$K_e$ 是每条线路的同步刚度。针对每个参数集，解题过程系统地进行。\n\n**步骤 1：构建图拉普拉斯矩阵 $L$**\n该微电网是一个三节点环。对于具有统一边权重 $K_e$ 的网络，其图拉普拉斯矩阵 $L$ 是一个对称矩阵，其中对角线元素 $L_{ii}$ 是连接到节点 $i$ 的所有边的权重之和，非对角线元素 $L_{ij}$ 是节点 $i$ 和 $j$ 之间边的权重的负值。对于一个三节点环，每个节点有两个邻居。因此，拉普拉斯矩阵为：\n$$\nL = K_e\n\\begin{pmatrix}\n2  -1  -1 \\\\\n-1  2  -1 \\\\\n-1  -1  2\n\\end{pmatrix}\n$$\n这个 $3 \\times 3$ 循环矩阵的特征值已知为 $\\lambda_0 = 0$，$\\lambda_1 = 3K_e$ 和 $\\lambda_2 = 3K_e$。因此，最大正特征值为 $\\lambda_{\\max} = 3K_e$。\n\n**步骤 2：构建状态矩阵 $A$**\n状态向量为 $x = [\\delta^\\top, \\omega^\\top]^\\top$，其中 $\\delta = [\\delta_1, \\delta_2, \\delta_3]^\\top$，$\\omega = [\\omega_1, \\omega_2, \\omega_3]^\\top$。状态空间表示 $\\dot{x} = Ax$ 由给定的分块方程导出。状态矩阵 $A$ 是一个 $6 \\times 6$ 的分块矩阵：\n$$\nA =\n\\begin{pmatrix}\n0_{3 \\times 3}  I_{3 \\times 3} \\\\\n-\\frac{1}{M} L  -\\frac{D}{M} I_{3 \\times 3}\n\\end{pmatrix}\n$$\n其中 $0_{3 \\times 3}$ 是 $3 \\times 3$ 的零矩阵，$I_{3 \\times 3}$ 是 $3 \\times 3$ 的单位矩阵。\n\n**步骤 3：模态分析与特征值计算**\n分块矩阵 $A$ 的特征值决定了系统的稳定性和振荡性质。这些特征值可以通过将它们与拉普拉斯矩阵的特征值 $\\lambda_k$ 相关联来找到。对于 $L$ 的每个特征值 $\\lambda_k$，都有一对相应的 $A$ 的特征值，它们是特征方程的根：\n$$\ns^2 + \\frac{D}{M} s + \\frac{\\lambda_k}{M} = 0\n$$\n- 对于拉普拉斯矩阵的零特征值 $\\lambda_0 = 0$，方程为 $s^2 + \\frac{D}{M}s = 0$，这产生两个 $A$ 的特征值：$s_1 = 0$ 和 $s_2 = -D/M$。$s_1=0$ 的特征值对应于系统对所有转子角度的统一平移的不变性，代表了选择参考角度的自由度。\n- 对于重复的正特征值 $\\lambda_{1,2} = \\lambda_{\\max} = 3K_e$，我们有两个相同的特征方程：\n$$\ns^2 + \\frac{D}{M} s + \\frac{3K_e}{M} = 0\n$$\n这给出了两对相同的根。这些根的性质（实数或复数）决定了逆变器间模式的振荡行为。\n\n**步骤 4：对每个测试用例进行系统分析**\n对于每个给定的参数集 $(M, D, K_e)$，计算以下量：\n1.  **稳定性 (`stable`)**: 构建完整的矩阵 $A$ 并数值计算其六个特征值。如果恰好有一个特征值的模小于 $10^{-7}$（零模式），并且所有其他五个特征值的实部都严格小于 $-10^{-9}$，则声明系统为“稳定”(stable)。\n2.  **振荡行为 (`oscillatory`)**: 如果 $A$ 的六个特征值中任何一个的虚部绝对值大于 $10^{-9}$，则为“存在振荡”(oscillatory)。\n3.  **最差情况阻尼比 ($\\zeta_{\\text{worst}}$)**: 这是为阻尼最小的振荡模式计算的，该模式对应于最大的拉普拉斯特征值 $\\lambda_{\\max}$。公式为：\n$$\n\\zeta_{\\text{worst}} = \\frac{D}{2 \\sqrt{M \\lambda_{\\max}}} = \\frac{D}{2 \\sqrt{3 M K_e}}\n$$\n4.  **实现非振荡模式的最小阻尼 ($D_{\\text{no\\_osc}}$)**: 这是使最差情况阻尼比等于一（$\\zeta_{\\text{worst}} = 1$）的 $D$ 值，这是一条临界阻尼的边界。\n$$\nD_{\\text{no\\_osc}} = 2 \\sqrt{M \\lambda_{\\max}} = 2 \\sqrt{3 M K_e}\n$$\n\n对每个测试用例执行计算，并按规定汇编结果。\n- **情况 1**：$(M, D, K_e) = (0.5, 0.4, 10.0)$。系统是欠阻尼的 ($\\zeta_{\\text{worst}}  1$)，导致稳定的振荡。\n- **情况 2**：$(M, D, K_e) = (0.2, 6.0, 12.0)$。系统是过阻尼的 ($\\zeta_{\\text{worst}}  1$)，导致扰动以稳定、非振荡的方式衰减。\n- **情况 3**：$(M, D, K_e) = (1.0, 2\\sqrt{15}, 5.0)$。阻尼被精确设置为临界阻尼值，$D = D_{\\text{no\\_osc}}$，得出 $\\zeta_{\\text{worst}} = 1$。系统是稳定且非振荡的。\n- **情况 4**：$(M, D, K_e) = (0.5, 0.0, 8.0)$。在零阻尼（$D=0$）的情况下，系统仅为临界稳定。在零点有一个双重特征值，违反了渐近稳定的条件。其他模式是无阻尼的纯振荡。系统被标记为不稳定。\n\n最终输出是通过在一个可运行的程序中实现这些步骤来生成的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the microgrid stability analysis problem for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.5, 0.4, 10.0),\n        (0.2, 6.0, 12.0),\n        (1.0, 2 * np.sqrt(15), 5.0),\n        (0.5, 0.0, 8.0),\n    ]\n\n    # Tolerances for numerical checks\n    ZERO_MAG_TOL = 1e-7\n    NEG_REAL_TOL = -1e-9\n    IMAG_TOL = 1e-9\n\n    results = []\n    \n    for M, D, Ke in test_cases:\n        # Step 1: Construct the Graph Laplacian L for a 3-node ring\n        L = Ke * np.array([\n            [2, -1, -1],\n            [-1, 2, -1],\n            [-1, -1, 2]\n        ])\n\n        # Step 2: Construct the State Matrix A\n        n_nodes = 3\n        Z = np.zeros((n_nodes, n_nodes))\n        I = np.eye(n_nodes)\n        \n        A_top = np.block([Z, I])\n        # Handle M=0 case to avoid division by zero, though not in test cases.\n        if M == 0:\n            # System dynamics are ill-defined if M=0. For robustness, treat as unstable.\n            results.append([False, False, float('inf'), float('inf')])\n            continue\n            \n        A_bottom = np.block([(-1 / M) * L, (-D / M) * I])\n        A = np.block([[A_top], [A_bottom]])\n\n        # Step 3: Compute eigenvalues of A\n        eigenvalues = np.linalg.eigvals(A)\n\n        # Step 4: Analyze eigenvalues for stability and oscillations\n\n        # Task 2: Stability check\n        # Identify eigenvalues that are numerically close to zero.\n        zero_eigs = [eig for eig in eigenvalues if np.abs(eig)  ZERO_MAG_TOL]\n        \n        # Identify non-zero eigenvalues.\n        non_zero_eigs = [eig for eig in eigenvalues if np.abs(eig) >= ZERO_MAG_TOL]\n        \n        # Stability requires a single zero eigenvalue and all others to have strictly negative real parts.\n        is_stable = False\n        if len(zero_eigs) == 1:\n            if all(eig.real  NEG_REAL_TOL for eig in non_zero_eigs):\n                is_stable = True\n        \n        # Task 3: Oscillation check\n        # Check if any eigenvalue has a significant imaginary part.\n        is_oscillatory = any(np.abs(eig.imag) > IMAG_TOL for eig in eigenvalues)\n\n        # Task 4: Compute worst-case damping ratio\n        # The largest positive eigenvalue of L for a 3-node ring is 3*Ke\n        lambda_max = 3 * Ke\n        \n        # Denominator for zeta_worst and D_no_osc\n        denominator_term = 2 * np.sqrt(M * lambda_max) if M * lambda_max > 0 else 0\n        \n        # Avoid division by zero if M or Ke is zero\n        if denominator_term > 0:\n            zeta_worst = D / denominator_term\n        else:\n            # If D > 0, damping is infinite. If D=0, it is undefined.\n            # Given problem constraints, this case is not critical.\n            zeta_worst = float('inf') if D > 0 else 0.0\n\n        # Task 5: Compute minimum damping for non-oscillatory behavior\n        D_no_osc = denominator_term\n\n        # Collect results for this case\n        results.append([is_stable, is_oscillatory, zeta_worst, D_no_osc])\n\n    # Format the final output string as specified\n    formatted_results = []\n    for res in results:\n        stable, oscillatory, zeta, d_no_osc = res\n        # Python's bool __str__ is 'True' or 'False'.\n        s = f\"[{stable}, {oscillatory}, {zeta:.6f}, {d_no_osc:.6f}]\"\n        formatted_results.append(s)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}