{
    "hands_on_practices": [
        {
            "introduction": "在设计任何基于模型的控制器时，首要且最关键的一步是建立一个能准确描述系统动态的数学模型。本练习将指导您从基本物理原理出发，为单区域建筑热系统推导出一个状态空间模型。通过这个实践，您将学习如何将能量守恒等物理定律转化为MPC控制器能够理解和使用的线性微分方程和离散时间方程，这对于建立物理直觉和深刻理解控制模型至关重要。",
            "id": "4105298",
            "problem": "一个单区域建筑将使用模型预测控制（MPC）进行控制。假设区域内的空气是充分混合的，并且可以建模为集总热容。从能量守恒定律出发，推导一个连续时间单状态模型，其中状态为区域温度，控制输入为输送至该区域的供暖、通风和空调（HVAC）功率，扰动包括环境温度和太阳辐射增益（如果需要，可以符号形式包含内部增益）。然后，在对输入和扰动进行零阶保持的假设下，推导一个适用于MPC的离散时间状态空间模型。明确指出状态、输入和扰动向量如何映射到物理量。\n\n假设以下物理参数是恒定的：\n- 区域热容：$C_{z}$ $\\left[\\mathrm{J/K}\\right]$。\n- 围护结构对环境的热阻（对传导和渗透有效）：$R_{za}$ $\\left[\\mathrm{K/W}\\right]$。\n- 有效太阳辐射增益系数（吸收面积和透射率）：$g_{s}$ $\\left[\\mathrm{m^{2}}\\right]$。\n- 从指令功率到输送给空气的热功率的HVAC输入-效率映射因子：$\\eta$（无量纲）。\n- 环境温度：$T_{a}(t)$ $\\left[\\mathrm{K}\\right]$。\n- 全球水平辐照度：$I_{s}(t)$ $\\left[\\mathrm{W/m^{2}}\\right]$。\n- 内部热增益（可选）：$q_{\\mathrm{int}}(t)$ $\\left[\\mathrm{W}\\right]$。\n\n令状态为 $x(t) = T_{z}(t)$，控制输入为 $u(t)$，扰动向量 $d(t)$ 由 $T_{a}(t)$、$I_{s}(t)$ 和（可选）$q_{\\mathrm{int}}(t)$ 构成。从第一性原理出发，推导一个形式为 $\\dot{x}(t) = a_{c} x(t) + b_{c} u(t) + e_{c} d(t)$ 的仿射连续时间状态方程，并用 $C_{z}$、$R_{za}$、$g_{s}$ 和 $\\eta$ 来表示系数 $a_{c}$、$b_{c}$ 和 $e_{c}$ 的分量。\n\n接下来，对于给定的均匀采样间隔 $h$ $\\left[\\mathrm{s}\\right]$，并假设在每个采样周期内对 $u(t)$ 和 $d(t)$ 进行零阶保持，推导相应的离散时间状态空间模型\n$$\nx_{k+1} = A_{d} x_{k} + B_{d} u_{k} + E_{d} d_{k},\n$$\n清晰地用 $a_{c}$、$b_{c}$、$e_{c}$ 和 $h$ 表示 $A_{d}$、$B_{d}$ 和 $E_{d}$。\n\n最后，对于具体参数值 $C_{z} = 1.2 \\times 10^{6}$、$R_{za} = 0.04$ 和 $h = 900$，数值计算标量状态转移系数 $A_{d}$。将答案四舍五入到四位有效数字。将最终值表示为无量纲数。",
            "solution": "该问题要求为单区域建筑的热力学推导连续时间和离散时间状态空间模型，然后对一个模型系数进行数值评估。推导从能量守恒的第一性原理出发。\n\n### 第1部分：连续时间状态空间模型\n\n支配建筑区域热力学的基本原理是能量守恒。对于集总热容模型，此原理可表示为一个能量平衡方程，其中区域热质中存储的内能变化率等于流入该区域的所有热流的净和。\n\n令 $T_z(t)$ 为区域空气的温度，这是我们系统的状态。区域热质的内能为 $C_z T_z(t)$，其中 $C_z$ 是热容。该能量的变化率为 $C_z \\frac{d T_z(t)}{dt}$。\n\n热流如下：\n1.  **HVAC热输入：** 控制输入 $u(t)$ 是指令功率，$\\eta$ 是效率因子。输送到区域的热功率为 $q_{\\mathrm{HVAC}}(t) = \\eta u(t)$。这是一个热增益。\n2.  **太阳辐射热增益：** 通过建筑围护结构的太阳辐射热增益与全球水平辐照度 $I_s(t)$ 成正比。有效太阳辐射增益系数 $g_s$ 考虑了窗户面积、朝向和太阳辐射热增益系数。太阳辐射热增益为 $q_{\\mathrm{solar}}(t) = g_s I_s(t)$。这是一个热增益。\n3.  **围护结构传热：** 通过建筑围护结构（墙壁、窗户、屋顶等）和渗透与温度为 $T_a(t)$ 的周围环境进行热交换。该过程使用有效热阻 $R_{za}$ 进行建模。热流量为 $q_{\\mathrm{env}}(t) = \\frac{T_z(t) - T_a(t)}{R_{za}}$。正值表示从区域到环境的热损失。\n4.  **内部热增益：** 由居住者、照明和设备产生的热量由 $q_{\\mathrm{int}}(t)$ 表示。这是一个热增益。\n\n因此，能量平衡方程为：\n$$\nC_z \\frac{d T_z(t)}{dt} = q_{\\mathrm{HVAC}}(t) + q_{\\mathrm{solar}}(t) + q_{\\mathrm{int}}(t) - q_{\\mathrm{env}}(t)\n$$\n代入热流的表达式：\n$$\nC_z \\frac{d T_z(t)}{dt} = \\eta u(t) + g_s I_s(t) + q_{\\mathrm{int}}(t) - \\frac{T_z(t) - T_a(t)}{R_{za}}\n$$\n为了得到标准形式 $\\dot{x}(t) = a_c x(t) + b_c u(t) + e_c d(t)$ 的状态方程，我们首先通过除以 $C_z$ 来分离导数项 $\\frac{d T_z(t)}{dt}$：\n$$\n\\frac{d T_z(t)}{dt} = \\frac{\\eta}{C_z} u(t) + \\frac{g_s}{C_z} I_s(t) + \\frac{1}{C_z} q_{\\mathrm{int}}(t) - \\frac{1}{R_{za} C_z} T_z(t) + \\frac{1}{R_{za} C_z} T_a(t)\n$$\n现在，我们根据状态、输入和扰动对各项进行分组。\n令状态为 $x(t) = T_z(t)$。\n控制输入为 $u(t)$。\n扰动是影响系统但不受控制的外生变量。我们将它们分组到一个扰动向量 $d(t)$ 中：\n$$\nd(t) = \\begin{pmatrix} T_a(t) \\\\ I_s(t) \\\\ q_{\\mathrm{int}}(t) \\end{pmatrix}\n$$\n重新整理方程：\n$$\n\\dot{x}(t) = \\left( -\\frac{1}{R_{za} C_z} \\right) x(t) + \\left( \\frac{\\eta}{C_z} \\right) u(t) + \\left( \\frac{1}{R_{za} C_z} \\right) T_a(t) + \\left( \\frac{g_s}{C_z} \\right) I_s(t) + \\left( \\frac{1}{C_z} \\right) q_{\\mathrm{int}}(t)\n$$\n这可以写成矩阵形式：\n$$\n\\dot{x}(t) = \\left( -\\frac{1}{R_{za} C_z} \\right) x(t) + \\left( \\frac{\\eta}{C_z} \\right) u(t) + \\begin{pmatrix} \\frac{1}{R_{za} C_z} & \\frac{g_s}{C_z} & \\frac{1}{C_z} \\end{pmatrix} \\begin{pmatrix} T_a(t) \\\\ I_s(t) \\\\ q_{\\mathrm{int}}(t) \\end{pmatrix}\n$$\n通过与目标形式 $\\dot{x}(t) = a_c x(t) + b_c u(t) + e_c d(t)$ 进行比较，我们可以确定这些系数：\n- $a_c = -\\frac{1}{R_{za} C_z}$\n- $b_c = \\frac{\\eta}{C_z}$\n- $e_c = \\begin{pmatrix} \\frac{1}{R_{za} C_z} & \\frac{g_s}{C_z} & \\frac{1}{C_z} \\end{pmatrix}$\n\n### 第2部分：离散时间状态空间模型\n\n要推导离散时间模型，我们必须在一个采样间隔内，即从时间 $t_k = k h$到 $t_{k+1} = (k+1)h$，求解连续时间线性微分方程。仿射状态方程的解由常数变易法公式给出：\n$$\nx(t) = \\exp(a_c (t - t_k)) x(t_k) + \\int_{t_k}^{t} \\exp(a_c (t - \\tau)) \\left[ b_c u(\\tau) + e_c d(\\tau) \\right] d\\tau\n$$\n设 $t = t_{k+1} = (k+1)h$ 并使用记号 $x_k = x(kh)$：\n$$\nx_{k+1} = \\exp(a_c h) x_k + \\int_{kh}^{(k+1)h} \\exp(a_c ((k+1)h - \\tau)) \\left[ b_c u(\\tau) + e_c d(\\tau) \\right] d\\tau\n$$\n问题陈述假设对输入 $u(t)$ 和扰动 $d(t)$ 采用零阶保持（ZOH）。这意味着它们在每个采样间隔内是恒定的：\n- $u(\\tau) = u_k$ 对于 $\\tau \\in [kh, (k+1)h)$\n- $d(\\tau) = d_k$ 对于 $\\tau \\in [kh, (k+1)h)$\n\n在ZOH假设下，$u_k$ 和 $d_k$ 可以移到积分之外：\n$$\nx_{k+1} = \\exp(a_c h) x_k + \\left( \\int_{kh}^{(k+1)h} \\exp(a_c ((k+1)h - \\tau)) d\\tau \\right) b_c u_k + \\left( \\int_{kh}^{(k+1)h} \\exp(a_c ((k+1)h - \\tau)) d\\tau \\right) e_c d_k\n$$\n我们来计算这个积分。我们使用换元法，令 $s = (k+1)h - \\tau$，这意味着 $ds = -d\\tau$。积分上下限变为 $\\tau = kh \\implies s = h$ 和 $\\tau = (k+1)h \\implies s = 0$。\n$$\n\\int_{kh}^{(k+1)h} \\exp(a_c ((k+1)h - \\tau)) d\\tau = \\int_{h}^{0} \\exp(a_c s) (-ds) = \\int_{0}^{h} \\exp(a_c s) ds\n$$\n由于 $a_c$ 是一个非零标量，积分为：\n$$\n\\int_{0}^{h} \\exp(a_c s) ds = \\left[ \\frac{1}{a_c} \\exp(a_c s) \\right]_{0}^{h} = \\frac{1}{a_c} (\\exp(a_c h) - \\exp(0)) = \\frac{\\exp(a_c h) - 1}{a_c}\n$$\n将此结果代回 $x_{k+1}$ 的方程中：\n$$\nx_{k+1} = \\exp(a_c h) x_k + \\left( \\frac{\\exp(a_c h) - 1}{a_c} \\right) b_c u_k + \\left( \\frac{\\exp(a_c h) - 1}{a_c} \\right) e_c d_k\n$$\n这就是离散时间状态空间模型 $x_{k+1} = A_d x_k + B_d u_k + E_d d_k$，其中：\n- 状态向量： $x_k = T_z(kh)$\n- 输入向量： $u_k = u(kh)$\n- 扰动向量： $d_k = \\begin{pmatrix} T_a(kh) \\\\ I_s(kh) \\\\ q_{\\mathrm{int}}(kh) \\end{pmatrix}$\n- 状态转移矩阵： $A_d = \\exp(a_c h)$\n- 输入矩阵： $B_d = \\left( \\frac{\\exp(a_c h) - 1}{a_c} \\right) b_c$\n- 扰动矩阵： $E_d = \\left( \\frac{\\exp(a_c h) - 1}{a_c} \\right) e_c$\n\n我们也可以用原始物理参数来表示 $B_d$ 和 $E_d$：\n$B_d = \\frac{\\exp(a_c h) - 1}{a_c} \\frac{\\eta}{C_z} = \\frac{\\exp(-\\frac{h}{R_{za}C_z}) - 1}{-\\frac{1}{R_{za}C_z}} \\frac{\\eta}{C_z} = \\eta R_{za} (1 - \\exp(-\\frac{h}{R_{za}C_z}))$\n$E_d = \\eta R_{za} (1 - \\exp(-\\frac{h}{R_{za}C_z})) \\frac{e_c}{\\eta R_{za} a_c} b_c^{-1}$，这更复杂。一个更直接的形式是：\n$E_d = (1 - \\exp(a_c h)) R_{za} C_z \\begin{pmatrix} \\frac{1}{R_{za} C_z} & \\frac{g_s}{C_z} & \\frac{1}{C_z} \\end{pmatrix} = \\begin{pmatrix} 1 - \\exp(a_c h) & g_s R_{za}(1 - \\exp(a_c h)) & R_{za}(1 - \\exp(a_c h)) \\end{pmatrix}$\n\n### 第3部分：$A_d$ 的数值计算\n\n问题提供了以下数值：\n- $C_z = 1.2 \\times 10^6 \\, \\mathrm{J/K}$\n- $R_{za} = 0.04 \\, \\mathrm{K/W}$\n- $h = 900 \\, \\mathrm{s}$\n\n首先，我们计算连续时间系数 $a_c$：\n$$\na_c = -\\frac{1}{R_{za} C_z} = -\\frac{1}{(0.04 \\, \\mathrm{K/W}) \\times (1.2 \\times 10^6 \\, \\mathrm{J/K})} = -\\frac{1}{48000 \\, \\mathrm{J/W}}\n$$\n由于 $1 \\, \\mathrm{W} = 1 \\, \\mathrm{J/s}$，单位变为 $\\mathrm{s}^{-1}$。\n$$\na_c = -\\frac{1}{4.8 \\times 10^4} \\, \\mathrm{s}^{-1} \\approx -2.0833 \\times 10^{-5} \\, \\mathrm{s}^{-1}\n$$\n接下来，我们计算离散时间状态转移系数 $A_d = \\exp(a_c h)$：\n指数是无量纲乘积 $a_c h$：\n$$\na_c h = \\left( -\\frac{1}{4.8 \\times 10^4} \\, \\mathrm{s}^{-1} \\right) \\times (900 \\, \\mathrm{s}) = -\\frac{900}{48000} = -\\frac{9}{480} = -\\frac{3}{160} = -0.01875\n$$\n现在，我们计算指数函数：\n$$\nA_d = \\exp(-0.01875) \\approx 0.98142605\n$$\n根据要求将结果四舍五入到四位有效数字：\n$$\nA_d \\approx 0.9814\n$$\n该值是无量纲的，符合状态转移矩阵元素的预期。",
            "answer": "$$\n\\boxed{0.9814}\n$$"
        },
        {
            "introduction": "建立了系统模型之后，下一步是设计控制器的优化目标，即告诉控制器“好”的行为什么。在能源系统中，这通常涉及在相互冲突的目标之间进行权衡，例如在用户舒适度和能源成本之间取得平衡。本练习通过一个加权和的标量化方法，让您构建并求解一个多目标MPC优化问题，并探索如何通过调整权重在帕累托前沿上选择期望的工作点。",
            "id": "4105335",
            "problem": "考虑一个在模型预测控制（MPC）中使用的单区域建筑，其具有离散时间线性热动力学特性。下一时间步的预测室内温度由仿射系统 $x_{k+1} = a x_{k} + b u_{k}$ 建模，其中 $x_{k}$ 是当前室内温度，$u_{k}$ 是加热功率输入，$a$ 和 $b$ 是已知常数。对于一个带有标量化多目标阶段成本的单步MPC（无约束），建筑运营商使用加权和来平衡热舒适度与能源成本\n$$\n\\ell(x_{k+1}, u_{k}) = \\alpha \\|x_{k+1} - r\\|_{Q}^{2} + (1 - \\alpha) c(u_{k}),\n$$\n其中 $0 \\leq \\alpha \\leq 1$ 是舒适度权重，$r$ 是舒适度设定点，$\\|z\\|_{Q}^{2} = z^{\\top} Q z$ 是一个加权欧几里得范数，$c(u_{k})$ 是能源成本的替代函数。假设区域为标量，因此 $x_{k}$、$x_{k+1}$、$r$ 和 $u_{k}$ 都是标量，并设 $Q = 1$。能源成本替代函数定义为严格凸函数 $c(u_{k}) = u_{k}^{2} + \\lambda u_{k}$，其中价格斜率 $\\lambda$ 为常数。这种标量化方法是追踪热舒适度偏差和能源成本之间帕累托权衡的经典方法；调整 $\\alpha$ 会使操作点沿帕累托前沿移动。\n\n给定参数值 $a = 0.9$，$b = 0.5$，$x_{k} = 20$，$r = 22$ 和 $\\lambda = 4$，并使用最小化 $\\ell(x_{k+1}, u_{k})$（其中 $u_{k} \\in \\mathbb{R}$）的无约束单步MPC，请按以下步骤操作：\n- 利用二次目标的凸优化基本原理和给定的动力学模型，推导出最优控制输入 $u^{\\star}(\\alpha)$ 作为 $\\alpha$ 的函数。\n- 采用帕累托权衡准则来调整 $\\alpha$：确定唯一的权重 $\\alpha \\in (0, 1)$，使得在最优解处，两个加权目标分量相等，即，\n$$\n\\alpha \\|x_{k+1} - r\\|_{Q}^{2} \\;=\\; (1 - \\alpha) c(u_{k})\n\\quad \\text{在} \\quad u_{k} = u^{\\star}(\\alpha) \\text{ 处取值}。\n$$\n\n提供最终得到的 $\\alpha$ 的精确解析值。无需四舍五入。最终答案必须是一个不带单位的实数值。",
            "solution": "问题要求在单步模型预测控制（MPC）框架下，为单区域建筑确定权重参数 $\\alpha$ 的一个特定值。该 $\\alpha$ 值必须使得在最优控制输入处，目标函数的两个加权分量相等。\n\n首先，我们建立需要最小化的目标函数。阶段成本由下式给出：\n$$\n\\ell(x_{k+1}, u_{k}) = \\alpha \\|x_{k+1} - r\\|_{Q}^{2} + (1 - \\alpha) c(u_{k})\n$$\n问题指明变量 $x_{k+1}$、$u_k$ 和 $r$ 是标量，且权重矩阵 $Q=1$。成本函数 $c(u_k)$ 定义为 $c(u_k) = u_{k}^{2} + \\lambda u_{k}$。系统动力学由线性模型 $x_{k+1} = a x_{k} + b u_{k}$ 给出。\n代入这些定义，我们记目标函数为 $J(u_k)$，则有：\n$$\nJ(u_k) = \\alpha (x_{k+1} - r)^{2} + (1 - \\alpha)(u_{k}^{2} + \\lambda u_{k})\n$$\n将系统动力学代入 $J(u_k)$：\n$$\nJ(u_k) = \\alpha (a x_{k} + b u_{k} - r)^{2} + (1 - \\alpha)(u_{k}^{2} + \\lambda u_{k})\n$$\n该目标函数是关于控制输入 $u_k$ 的二次函数。对于 $\\alpha \\in [0, 1]$，$u_k^2$ 项的系数是 $\\alpha b^2 + (1-\\alpha) = 1 - \\alpha(1-b^2)$。给定 $b=0.5$，该系数为 $1-0.75\\alpha$，对于 $\\alpha \\in [0,1]$，该系数严格为正。因此，$J(u_k)$ 是关于 $u_k$ 的严格凸函数，其唯一最小值可以通过将其关于 $u_k$ 的一阶导数设为零来找到。\n\n$J(u_k)$ 关于 $u_k$ 的导数是：\n$$\n\\frac{dJ}{du_k} = \\frac{d}{du_k} \\left[ \\alpha (a x_{k} + b u_{k} - r)^{2} + (1 - \\alpha)(u_{k}^{2} + \\lambda u_{k}) \\right]\n$$\n$$\n\\frac{dJ}{du_k} = 2 \\alpha (a x_{k} + b u_{k} - r) \\cdot b + (1 - \\alpha)(2u_k + \\lambda)\n$$\n将导数设为零，以找到最优控制输入，记为 $u^{\\star}(\\alpha)$：\n$$\n2 \\alpha b (a x_{k} + b u^{\\star}(\\alpha) - r) + (1 - \\alpha)(2u^{\\star}(\\alpha) + \\lambda) = 0\n$$\n我们可以求解 $u^{\\star}(\\alpha)$：\n$$\n2 \\alpha a b x_{k} + 2 \\alpha b^2 u^{\\star}(\\alpha) - 2 \\alpha b r + 2(1-\\alpha)u^{\\star}(\\alpha) + \\lambda(1-\\alpha) = 0\n$$\n$$\nu^{\\star}(\\alpha) (2 \\alpha b^2 + 2(1-\\alpha)) = 2 \\alpha b r - 2 \\alpha a b x_{k} - \\lambda(1-\\alpha)\n$$\n$$\nu^{\\star}(\\alpha) = \\frac{2 \\alpha b (r - a x_{k}) - \\lambda(1-\\alpha)}{2(\\alpha b^2 + 1 - \\alpha)}\n$$\n现在，我们代入给定的参数值：$a=0.9$，$b=0.5$，$x_{k}=20$，$r=22$ 和 $\\lambda=4$。\n项 $r - a x_{k}$ 变为 $22 - 0.9 \\times 20 = 22 - 18 = 4$。\n项 $b^2$ 是 $0.5^2 = 0.25$。\n将这些值代入 $u^{\\star}(\\alpha)$ 的表达式：\n$$\nu^{\\star}(\\alpha) = \\frac{2 \\alpha (0.5) (4) - 4(1-\\alpha)}{2(\\alpha (0.25) + 1 - \\alpha)} = \\frac{4\\alpha - 4 + 4\\alpha}{2(1 - 0.75\\alpha)} = \\frac{8\\alpha - 4}{2 - 1.5\\alpha}\n$$\n问题的第二部分要求找到 $\\alpha \\in (0, 1)$ 的值，使得当 $u_k = u^{\\star}(\\alpha)$ 时，两个加权目标分量相等。该条件为：\n$$\n\\alpha (x_{k+1} - r)^{2} = (1 - \\alpha) c(u_k)\n$$\n$$\n\\alpha (a x_k + b u_k - r)^2 = (1 - \\alpha)(u_k^2 + \\lambda u_k)\n$$\n为了简化对 $\\alpha$ 的求解，我们可以使用前面推导的一阶最优性条件：\n$$\n2 \\alpha b (a x_k + b u_k - r) = -(1 - \\alpha)(2u_k + \\lambda)\n$$\n其中 $u_k = u^{\\star}(\\alpha)$。我们求解项 $(a x_k + b u_k - r)$：\n$$\n(a x_k + b u_k - r) = -\\frac{(1-\\alpha)(2u_k + \\lambda)}{2\\alpha b}\n$$\n将此表达式代入权衡条件的左侧：\n$$\n\\alpha \\left( -\\frac{(1-\\alpha)(2u_k + \\lambda)}{2\\alpha b} \\right)^2 = (1-\\alpha)(u_k^2 + \\lambda u_k)\n$$\n$$\n\\alpha \\frac{(1-\\alpha)^2 (2u_k+\\lambda)^2}{4\\alpha^2 b^2} = (1-\\alpha)(u_k^2 + \\lambda u_k)\n$$\n因为我们在寻找 $\\alpha \\in (0,1)$，我们知道 $\\alpha \\neq 0$ 且 $1-\\alpha \\neq 0$。我们可以将等式两边同除以 $(1-\\alpha)$：\n$$\n\\frac{(1-\\alpha)(2u_k+\\lambda)^2}{4\\alpha b^2} = u_k^2 + \\lambda u_k\n$$\n代入数值 $b=0.5$ 和 $\\lambda=4$：\n$$\n\\frac{(1-\\alpha)(2u_k+4)^2}{4\\alpha (0.5)^2} = u_k^2 + 4u_k\n$$\n$$\n\\frac{(1-\\alpha) \\cdot 4(u_k+2)^2}{\\alpha} = u_k(u_k+4)\n$$\n现在，我们代入 $u^{\\star}(\\alpha)$ 的表达式：$u_k = \\frac{8\\alpha-4}{2-1.5\\alpha}$。我们计算 $(u_k+2)$ 和 $(u_k+4)$ 这两项：\n$$\nu_k+2 = \\frac{8\\alpha-4}{2-1.5\\alpha} + 2 = \\frac{8\\alpha-4 + 2(2-1.5\\alpha)}{2-1.5\\alpha} = \\frac{8\\alpha-4+4-3\\alpha}{2-1.5\\alpha} = \\frac{5\\alpha}{2-1.5\\alpha}\n$$\n$$\nu_k+4 = \\frac{8\\alpha-4}{2-1.5\\alpha} + 4 = \\frac{8\\alpha-4 + 4(2-1.5\\alpha)}{2-1.5\\alpha} = \\frac{8\\alpha-4+8-6\\alpha}{2-1.5\\alpha} = \\frac{2\\alpha+4}{2-1.5\\alpha}\n$$\n将这些代回方程中：\n$$\n\\frac{4(1-\\alpha)}{\\alpha} \\left( \\frac{5\\alpha}{2-1.5\\alpha} \\right)^2 = \\left( \\frac{8\\alpha-4}{2-1.5\\alpha} \\right) \\left( \\frac{2\\alpha+4}{2-1.5\\alpha} \\right)\n$$\n$$\n\\frac{4(1-\\alpha) \\cdot 25\\alpha^2}{\\alpha(2-1.5\\alpha)^2} = \\frac{(8\\alpha-4)(2\\alpha+4)}{(2-1.5\\alpha)^2}\n$$\n对于 $\\alpha \\in (0,1)$，分母相等且非零，所以我们令分子相等：\n$$\n100\\alpha(1-\\alpha) = (8\\alpha-4)(2\\alpha+4)\n$$\n$$\n100\\alpha - 100\\alpha^2 = 16\\alpha^2 + 32\\alpha - 8\\alpha - 16\n$$\n$$\n100\\alpha - 100\\alpha^2 = 16\\alpha^2 + 24\\alpha - 16\n$$\n整理各项得到一个关于 $\\alpha$ 的二次方程：\n$$\n(100+16)\\alpha^2 + (24-100)\\alpha - 16 = 0\n$$\n$$\n116\\alpha^2 - 76\\alpha - 16 = 0\n$$\n将整个方程除以 $4$ 进行简化：\n$$\n29\\alpha^2 - 19\\alpha - 4 = 0\n$$\n我们使用二次方程求根公式 $\\alpha = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 来解 $\\alpha$，其中 $A=29$，$B=-19$，以及 $C=-4$：\n$$\n\\alpha = \\frac{-(-19) \\pm \\sqrt{(-19)^2 - 4(29)(-4)}}{2(29)} = \\frac{19 \\pm \\sqrt{361 + 464}}{58} = \\frac{19 \\pm \\sqrt{825}}{58}\n$$\n为了化简平方根，我们对 $825$ 进行因式分解：$825 = 25 \\times 33 = 5^2 \\times 33$。因此，$\\sqrt{825} = 5\\sqrt{33}$。\n$\\alpha$ 的两个可能的解是：\n$$\n\\alpha = \\frac{19 + 5\\sqrt{33}}{58} \\quad \\text{和} \\quad \\alpha = \\frac{19 - 5\\sqrt{33}}{58}\n$$\n问题要求 $\\alpha \\in (0, 1)$。我们必须检查哪个解位于此区间内。\n对于第二个根，我们近似计算 $\\sqrt{33}$。因为 $5^2=25$ 和 $6^2=36$，所以 $5  \\sqrt{33}  6$。因此，$5\\sqrt{33} > 25$。这使得分子 $19 - 5\\sqrt{33}$ 为负，所以这个根小于 $0$。\n对于第一个根，$19 + 5\\sqrt{33}$ 显然为正。我们必须检查它是否小于 $58$。\n$$\n19 + 5\\sqrt{33}  58 \\implies 5\\sqrt{33}  39 \\implies (5\\sqrt{33})^2  39^2 \\implies 25 \\times 33  1521 \\implies 825  1521\n$$\n这个不等式成立，所以第一个根确实在 $0$ 和 $1$ 之间。\n满足条件的唯一 $\\alpha$ 值为：\n$$\n\\alpha = \\frac{19 + 5\\sqrt{33}}{58}\n$$",
            "answer": "$$\\boxed{\\frac{19 + 5\\sqrt{33}}{58}}$$"
        },
        {
            "introduction": "现实世界中的模型和预测总是存在不确定性，这给满足严格的运行约束（如电池的充电状态限制）带来了挑战。本练习介绍了一种先进而强大的技术——基于管的鲁棒MPC（Tube-based Robust MPC），以确保即使在存在有界扰动的情况下，系统也能保持安全和可行。您将通过推导“约束收紧”这一核心机制，学习如何为名义系统规划留出安全裕度，从而保证实际系统始终在安全范围内运行。",
            "id": "4105355",
            "problem": "考虑一个采用基于管的模型预测控制 (MPC) 运行的并网电池储能系统。实际状态 $x_k \\in \\mathbb{R}^2$ 在加性扰动下演化为 $x_{k+1} = A x_k + B u_k + w_k$，其中 $u_k \\in \\mathbb{R}$ 是控制输入，$w_k \\in \\mathbb{R}^2$ 是一个未知扰动，该扰动被限制在一个已知的紧凸集 $\\mathcal{W}$ 内。MPC 使用一个无扰动演化的标称状态 $z_k$、一个标称输入 $v_k$ 以及一个应用于偏差 $e_k = x_k - z_k$ 的线性预镇定反馈 $K \\in \\mathbb{R}^{1 \\times 2}$，因此 $u_k = v_k + K e_k$，且偏差动态满足 $e_{k+1} = (A + B K)e_k + w_k$。假设存在一个用于偏差动态的紧凸鲁棒正不变 (RPI) 集 $\\mathcal{S}$，即对于所有 $e_k \\in \\mathcal{S}$ 和 $w_k \\in \\mathcal{W}$，都有 $e_{k+1} \\in \\mathcal{S}$。\n\n该系统受到多胞体状态和输入约束 $x_k \\in \\mathcal{X}$ 和 $u_k \\in \\mathcal{U}$ 的限制，其中 $\\mathcal{X} = \\{ x \\in \\mathbb{R}^2 : H_x x \\le h_x \\}$ 且 $\\mathcal{U} = \\{ u \\in \\mathbb{R} : H_u u \\le h_u \\}$。集合 $\\mathcal{A}, \\mathcal{B}$ 的 Pontryagin (Minkowski) 集差定义为 $\\mathcal{A} \\ominus \\mathcal{B} = \\{ z : z + \\mathcal{B} \\subseteq \\mathcal{A} \\}$。Minkowski 和定义为 $\\mathcal{A} \\oplus \\mathcal{B} = \\{ a + b : a \\in \\mathcal{A}, b \\in \\mathcal{B} \\}$。\n\n任务 1 (推导)：仅从上述定义和鲁棒正不变性的定义出发，为标称变量推导收紧的约束集，\n$$\nz_k \\in \\mathcal{X} \\ominus \\mathcal{S}, \\quad v_k \\in \\mathcal{U} \\ominus K \\mathcal{S},\n$$\n该约束集保证对于所有的 $k$ 和所有的扰动 $w_k \\in \\mathcal{W}$，实际状态和输入都满足 $x_k \\in \\mathcal{X}$ 和 $u_k \\in \\mathcal{U}$。请用 $\\mathcal{S}$ 的支撑函数来表达您对一般多胞体 $\\mathcal{X}$ 和 $\\mathcal{U}$ 的推导，并用文字解释其可行性保证。\n\n任务 2 (特定能源系统上的评估)：考虑一个电池模型，其两个状态是荷电状态偏差和变流器功率偏差。硬约束是对称盒\n$$\n\\mathcal{X} = \\{ x \\in \\mathbb{R}^2 : |x_1| \\le 0.20,\\ |x_2| \\le 40 \\}, \\quad \\mathcal{U} = \\{ u \\in \\mathbb{R} : |u| \\le 30 \\}.\n$$\n控制器使用的反馈增益为\n$$\nK = \\begin{bmatrix} -0.5  -0.1 \\end{bmatrix},\n$$\n且偏差被限制在 RPI 集\n$$\n\\mathcal{S} = \\{ e \\in \\mathbb{R}^2 : |e_1| \\le 0.02,\\ |e_2| \\le 1.9 \\}.\n$$\n内。计算从 $\\mathcal{U} \\ominus K \\mathcal{S}$ 获得的收紧的输入上界的标量值。用 $\\mathrm{MW}$ 表示最终界限。不要对答案进行四舍五入；请提供精确的小数值。最终答案必须是一个实数。",
            "solution": "### 任务 1：收紧约束的推导\n\n目标是找到对标称状态 $z_k$ 和标称输入 $v_k$ 的约束，以保证在初始偏差 $e_0$ 位于 RPI 集 $\\mathcal{S}$ 内的假设下，对于所有可能的扰动实现 $w_j$（其中 $j  k$），物理约束 $x_k \\in \\mathcal{X}$ 和 $u_k \\in \\mathcal{U}$ 都得到满足。$\\mathcal{S}$ 的鲁棒正不变性确保了如果 $e_k \\in \\mathcal{S}$，那么对于任何 $w_k \\in \\mathcal{W}$，$e_{k+1} = (A+BK)e_k + w_k$ 也将在 $\\mathcal{S}$ 内。因此，我们可以假设对于所有 $k \\ge 0$，$e_k \\in \\mathcal{S}$。\n\n**状态约束收紧**\n我们必须确保对于所有的 $k$，$x_k \\in \\mathcal{X}$。根据定义，实际状态为 $x_k = z_k + e_k$。将此代入状态约束中得到：\n$$\nz_k + e_k \\in \\mathcal{X}\n$$\n这个条件必须对每个可能的偏差 $e_k \\in \\mathcal{S}$ 都成立。这意味着将标称状态 $z_k$ 与偏差集 $\\mathcal{S}$ 的每个元素相加所形成的集合必须完全包含在约束集 $\\mathcal{X}$ 内。用集合运算的术语来说，这可以写成：\n$$\n\\{z_k\\} \\oplus \\mathcal{S} \\subseteq \\mathcal{X}\n$$\n其中 $\\oplus$ 是 Minkowski 和。根据 Pontryagin 集差的定义 $\\mathcal{A} \\ominus \\mathcal{B} = \\{ z : z + \\mathcal{B} \\subseteq \\mathcal{A} \\}$，这等价于陈述标称状态 $z_k$ 必须属于收紧后的集合：\n$$\nz_k \\in \\mathcal{X} \\ominus \\mathcal{S}\n$$\n多胞体集 $\\mathcal{X}$ 由线性不等式 $H_x x \\le h_x$ 定义。设 $h_{x,i}^T$ 是 $H_x$ 的第 $i$ 行，$h_{x,i}$ 是 $h_x$ 的第 $i$ 个元素。条件 $z_k \\in \\mathcal{X} \\ominus \\mathcal{S}$ 意味着对于每一行 $i$，$h_{x,i}^T(z_k+e_k) \\le h_{x,i}$ 必须对所有 $e_k \\in \\mathcal{S}$ 成立。这可以改写为：\n$$\nh_{x,i}^T z_k + h_{x,i}^T e_k \\le h_{x,i}\n$$\n为了保证这对所有 $e_k \\in \\mathcal{S}$ 都成立，我们必须满足项 $h_{x,i}^T e_k$ 在最坏情况（最大值）下的不等式：\n$$\nh_{x,i}^T z_k \\le h_{x,i} - \\max_{e \\in \\mathcal{S}}(h_{x,i}^T e)\n$$\n项 $\\max_{e \\in \\mathcal{S}}(h_{x,i}^T e)$ 正是集合 $\\mathcal{S}$ 在向量 $h_{x,i}$ 处评估的支撑函数的定义，记为 $\\sigma_{\\mathcal{S}}(h_{x,i})$。因此，对 $z_k$ 的收紧的多胞体约束由下式给出：\n$$\nH_x z_k \\le h_x - \\begin{bmatrix} \\sigma_{\\mathcal{S}}(h_{x,1}) \\\\ \\vdots \\\\ \\sigma_{\\mathcal{S}}(h_{x,m}) \\end{bmatrix}\n$$\n\n**输入约束收紧**\n类似地，我们必须确保对于所有的 $k$，$u_k \\in \\mathcal{U}$。控制律是 $u_k = v_k + K e_k$。将此代入输入约束中得到：\n$$\nv_k + K e_k \\in \\mathcal{U}\n$$\n这必须对所有可能的偏差 $e_k \\in \\mathcal{S}$ 都成立。设 $K\\mathcal{S}$ 为集合 $\\{Ke : e \\in \\mathcal{S}\\}$。由于 $K$ 是一个线性变换且 $\\mathcal{S}$ 是紧凸集，所以 $K\\mathcal{S}$ 也是一个紧凸集。该条件变为：\n$$\n\\{v_k\\} \\oplus K\\mathcal{S} \\subseteq \\mathcal{U}\n$$\n再次使用 Pontryagin 差的定义，这等价于：\n$$\nv_k \\in \\mathcal{U} \\ominus K\\mathcal{S}\n$$\n对于由 $H_u u \\le h_u$ 定义的多胞体集 $\\mathcal{U}$，其第 $j$ 行为 $h_{u,j}^T u \\le h_{u,j}$，我们要求对所有 $e_k \\in \\mathcal{S}$，都有 $h_{u,j}^T(v_k+Ke_k) \\le h_{u,j}$。这导致：\n$$\nh_{u,j}^T v_k \\le h_{u,j} - \\max_{e \\in \\mathcal{S}}(h_{u,j}^T K e)\n$$\n最大化项是集合 $K\\mathcal{S}$ 的支撑函数，它可以与 $\\mathcal{S}$ 的支撑函数相关联：\n$$\n\\sigma_{K\\mathcal{S}}(h_{u,j}) = \\max_{e \\in \\mathcal{S}} (h_{u,j}^T K e) = \\max_{e \\in \\mathcal{S}} ((K^T h_{u,j})^T e) = \\sigma_{\\mathcal{S}}(K^T h_{u,j})\n$$\n因此，对标称输入 $v_k$ 的收紧的多胞体约束由不等式给出，每个不等式对应 $H_u$ 的一行：\n$$\nh_{u,j}^T v_k \\le h_{u,j} - \\sigma_{\\mathcal{S}}(K^T h_{u,j})\n$$\n\n**可行性保证**\n根据设计，RPI 集 $\\mathcal{S}$ 是一个容器，用于容纳系统状态偏离其标称轨迹的所有可能偏差，前提是初始偏差在 $\\mathcal{S}$ 内。MPC 优化问题的制定是为了确保这个条件成立。收紧的约束 $\\mathcal{X} \\ominus \\mathcal{S}$ 和 $\\mathcal{U} \\ominus K\\mathcal{S}$ 有效地缩小了可用于标称计划轨迹 $(z_k, v_k)$ 的可行域。在原始约束集的任何边界处的收缩量，恰好由偏差集 $\\mathcal{S}$ 在该边界法向量方向上的最大范围决定。通过强制标称计划位于这个更小、更保守的集合内，我们在其周围创建了一个缓冲“管”。这保证了当真实系统偏离计划的任何量（只要该偏差包含在 $\\mathcal{S}$ 中）时，实际状态 $x_k$ 和输入 $u_k$ 仍将遵守原始的物理约束 $\\mathcal{X}$ 和 $\\mathcal{U}$。这确保了鲁棒的约束满足。\n\n### 任务 2：特定能源系统上的评估\n\n我们被要求计算收紧的输入上界的标量值。原始输入约束为 $\\mathcal{U} = \\{ u \\in \\mathbb{R} : |u| \\le 30 \\}$。这可以表示为两个线性不等式：\n1. $u \\le 30$\n2. $-u \\le 30$ (或 $u \\ge -30$)\n\n我们感兴趣的是第一个不等式，即上界的收紧版本。这里，约束的形式为 $h_u u \\le \\bar{u}$，其中 $h_u = 1$ 且 $\\bar{u} = 30$。对标称输入 $v$ 的收紧约束由下式给出：\n$$\nh_u v \\le \\bar{u} - \\sigma_{\\mathcal{S}}(K^T h_u)\n$$\n代入 $h_u=1$，我们得到：\n$$\nv \\le 30 - \\sigma_{\\mathcal{S}}(K^T)\n$$\n我们需要计算支撑函数 $\\sigma_{\\mathcal{S}}(K^T)$。给定的数据是：\n- $K = \\begin{bmatrix} -0.5  -0.1 \\end{bmatrix}$，所以 $K^T = \\begin{bmatrix} -0.5 \\\\ -0.1 \\end{bmatrix}$。\n- $\\mathcal{S} = \\{ e \\in \\mathbb{R}^2 : |e_1| \\le 0.02, |e_2| \\le 1.9 \\}$。\n\n支撑函数的定义为：\n$$\n\\sigma_{\\mathcal{S}}(K^T) = \\sup_{e \\in \\mathcal{S}} (K^T)^T e = \\sup_{e \\in \\mathcal{S}} \\left( \\begin{bmatrix} -0.5  -0.1 \\end{bmatrix} \\begin{bmatrix} e_1 \\\\ e_2 \\end{bmatrix} \\right) = \\sup_{e \\in \\mathcal{S}} (-0.5 e_1 - 0.1 e_2)\n$$\n上确界的定义域是由 $-0.02 \\le e_1 \\le 0.02$ 和 $-1.9 \\le e_2 \\le 1.9$ 定义的盒子。为了最大化线性函数 $-0.5 e_1 - 0.1 e_2$，我们必须在其允许的区间边界选择 $e_1$ 和 $e_2$ 的值。由于两个系数（$-0.5$ 和 $-0.1$）都是负数，我们必须选择 $e_1$ 和 $e_2$ 的最小值来实现最大值。\n$e_1$ 的最小值为 $-0.02$。\n$e_2$ 的最小值为 $-1.9$。\n\n代入这些值：\n$$\n\\sigma_{\\mathcal{S}}(K^T) = (-0.5) \\times (-0.02) + (-0.1) \\times (-1.9)\n$$\n$$\n\\sigma_{\\mathcal{S}}(K^T) = 0.01 + 0.19 = 0.2\n$$\n这个值表示反馈项 $Ke_k$ 对标称输入 $v_k$ 可能的最大正贡献。为确保总输入 $u_k$ 不超过 $30$，我们必须将标称输入 $v_k$ 的上限减少这个量。\n\n标称输入 $v$ 的收紧上界为：\n$$\nv \\le 30 - 0.2 = 29.8\n$$\n收紧的输入上界的标量值为 $29.8$。",
            "answer": "$$\\boxed{29.8}$$"
        }
    ]
}