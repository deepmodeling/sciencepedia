## 引言
随着可再生能源的普及和对供电可靠性要求的提升，微电网已成为现代[电力](@entry_id:264587)系统不可或缺的组成部分。而微[电网优化](@entry_id:1130041)调度，作为其“大脑”，负责协调内部各类分布式能源、储能和负荷，以最低成本、最高效率地实现稳定运行。然而，如何将复杂的物理现实、多变的市场环境和固有的不确定性转化为一个可解的数学模型，并有效应用于多样化的场景，是研究人员和工程师面临的核心挑战。本文旨在系统性地弥合理论与实践之间的鸿沟。

在接下来的内容中，读者将踏上一段从基础到前沿的知识之旅。第一章“原理与机制”将为您奠定坚实的理论基础，详细解析优化调度问题的数学架构、关键设备的建模方法以及处理网络约束和不确定性的核心思想。随后，第二章“应用与跨学科联系”将视野拓宽至真实世界，展示优化调度如何在电力市场、综合能源系统、可靠性工程等领域发挥关键作用。最后，第三章“动手实践”将理论付诸行动，通过一系列精心设计的编程练习，引导您亲手构建和求解优化模型，将抽象概念转化为实际技能。让我们首先深入微[电网优化](@entry_id:1130041)调度的核心，探索其背后的原理与机制。

## 原理与机制

继前一章对微电网及其在现代[电力](@entry_id:264587)系统中角色的介绍之后，本章将深入探讨微[电网优化](@entry_id:1130041)调度的核心原理与数学建模机制。优化调度是微电网经济、可靠运行的基石，它通过协调内部资源来响应内部需求和外部信号。本章旨在为读者构建一个系统性的知识框架，从基本定义出发，逐步解析构成一个完整优化调度问题的各个要素，并探讨处理复杂物理现实与不确定性的高级建模技术。

### 为优化调度定义微电网

从控制与优化的角度看，微电网并非任意一段配电网络，而是一个具备明确边界和自主控制能力的[电力](@entry_id:264587)子系统。一个严谨的定义对于建立有效的数学模型至关重要。

首先，微电网拥有一个清晰的**控制边界 (control boundary)**。这个边界界定了一个由本地控制器管理的母线与线路集合。它通过一个或多个可控的开关设备与上游主电网相连，此连接点被称为**公共耦合点 (Point of Common Coupling, PCC)**。这种结构赋予了微电网最关键的特性之一：**孤岛运行能力 (islanding capability)**，即在主电网发生故障或出于经济考虑时，能够主动断开连接，独立为内部负荷供电。相比之下，传统的配电网馈线是无源的，其运行状态完全由上游电网决定，不具备自主控制或孤岛运行的授权 。

其次，微电网内部拥有一系列**分布式能源 (Distributed Energy Resources, DERs)**。根据其[可控性](@entry_id:148402)，这些资源可分为两类：

1.  **可调度资源 (Dispatchable Resources)**：这类资源的功率输出可以在特定技术限制（如功率上下限、爬坡速率）内，由优化调度模型作为**决策变量**来设定。典型的可调度资源包括柴油[发电机](@entry_id:268282)、燃气轮机和电化学储能系统。例如，储能系统的充放电行为可以通过其状态方程来描述，如 $x_{t+1}=x_{t}+\eta_{\mathrm{ch}}p^{\mathrm{ch}}_{t}\Delta t-\frac{1}{\eta_{\mathrm{dis}}}p^{\mathrm{dis}}_{t}\Delta t$，其中 $x_t$ 是储能状态，而充放电功率 $p^{\mathrm{ch}}_{t}$ 和 $p^{\mathrm{dis}}_{t}$ 是调度决策。

2.  **不可调度资源 (Nondispatchable Resources)**：这类资源的功率输出主要由外部自然条件决定，如光伏（PV）发电和风力发电。在调度模型中，它们的输出通常被视为一个已知的**外生预测序列** $w_t$。虽然我们不能指令其“按需发电”，但通常可以通过**弃电 (curtailment)** 的方式来调节其净注入功率，即通过一个决策变量 $c_t$（$0 \leq c_t \leq w_t$）来减少其上网电量 。

最后，微电网的运行以一个本地**优化调度目标**为导向。该目标通常是最小化一个综合成本函数，该函数可能包括从主电网购电的成本、本地[发电机](@entry_id:268282)燃料与启停成本、储能的退化成本、环境排放的惩罚，以及在紧急情况下切除负荷的可靠性代价。所有调度决策都必须在满足网络和设备约束的前提下，确保微电网内部的功率平衡。

### 优化调度问题的架构

一个典型的微[电网优化](@entry_id:1130041)调度问题可以被构建为一个数学优化模型。该模型由三个核心部分组成：决策变量、目标函数和约束集。

#### 决策变量

决策变量是调度模型中需要优化的量，它们代表了对微电网中可控设备在未来一段时间（调度时域）内的操作指令。一个完备且最小化的决策变量集合是构建有效模型的第一步。对于一个在离散时间步 $t \in \{1, \dots, T\}$ 上运行的交流（AC）微电网，标准的决策变量集合包括 ：

*   **对于每台[发电机](@entry_id:268282) $g \in \mathcal{G}$**：
    *   $p_{g}^{t}$：在 $t$ 时刻的有功功率输出。
    *   $q_{g}^{t}$：在 $t$ 时刻的无功功率输出（在交流模型中至关重要）。
    *   $u_{g}^{t} \in \{0,1\}$：在 $t$ 时刻的启停状态，这是一个**二进制变量**，$1$ 代表开机，$0$ 代表关机。

*   **对于每个储能单元 $s \in \mathcal{S}$**：
    *   $e_{s}^{t}$：在 $t$ 时刻末的荷电状态（State of Charge, SOC），单位为能量（如 MWh）。
    *   $p_{s}^{t,\mathrm{ch}} \ge 0$：在 $t$ 时刻的充电有功功率。
    *   $p_{s}^{t,\mathrm{dis}} \ge 0$：在 $t$ 时刻的放电有功功率。

*   **对于电网连接**：
    *   $p_{\mathrm{grid}}^{t}$：在 $t$ 时刻于 PCC 处的净交换有功功率。符号约定至关重要，一个常见的约定是 $p_{\mathrm{grid}}^{t} > 0$ 表示从主电网**输入**电能至微电网，而 $p_{\mathrm{grid}}^{t}  0$ 表示向主电网**输出**电能。

错误或不完备的变量定义会导致模型失效。例如，将储能的荷电状态定义为功率单位，或者忽略无功功率变量，或者使用不能同时表示输入和输出的单一非负电网交换变量，都会导致模型无法准确描述物理现实或无法实现优化目标 。

#### 目标函数

目标函数定义了“最优”的标准。在经济调度中，目标通常是最小化调度周期内的总运行成本。一个综合性的[目标函数](@entry_id:267263) $J$ 可以表示为 ：
$J = \sum_{t=1}^{T} \left( \lambda_{t}p^{\mathrm{grid}}_{t} + \sum_{g \in \mathcal{G}} C^{\mathrm{fuel}}(p_{g}^{t}) + \sum_{g \in \mathcal{G}} C^{\mathrm{su}}(y_{g,t}) + \sum_{s \in \mathcal{S}} C^{\mathrm{deg}}(p_{s}^{t,\mathrm{ch}}, p_{s}^{t,\mathrm{dis}}) + \pi^{\mathrm{shed}}s_{t} \right)$

这个函数的组成部分包括：
1.  **购售电成本**：$\lambda_{t}p^{\mathrm{grid}}_{t}$，其中 $\lambda_t$ 是时变的电价。当 $p^{\mathrm{grid}}_{t}>0$ 时表示购电成本，当 $p^{\mathrm{grid}}_{t}0$ 时（且 $\lambda_t>0$）则表示售电收入。
2.  **燃料成本**：$C^{\mathrm{fuel}}(p_{g}^{t})$，对于热力[发电机](@entry_id:268282)，这通常是一个关于其功率输出的二次或[分段线性](@entry_id:201467)[凸函数](@entry_id:143075)。
3.  **启停成本**：$C^{\mathrm{su}}(y_{g,t})$，其中 $y_{g,t}$ 是一个指示[发电机](@entry_id:268282)在 $t$ 时刻启动的[二进制变量](@entry_id:162761)。这部分成本反映了启动过程中的额外燃料消耗和设备损耗。
4.  **储能退化成本**：$C^{\mathrm{deg}}(\cdot)$，这是一个惩罚项，用于量化电池因充放电循环而造成的寿命损失。
5.  **可靠性成本**：$\pi^{\mathrm{shed}}s_{t}$，其中 $s_t$ 是紧急情况下必须削减的负荷量，$\pi^{\mathrm{shed}}$ 是极高的单位惩罚成本（即[失负荷价值](@entry_id:1133695)，Value of Lost Load），确保模型会尽一切可能避免这种情况。

#### 约束集

约束集定义了调度问题的“游戏规则”，它包含了所有物理定律、设备限制和运行要求。

*   **功率平衡约束**：这是最核心的约束，它要求在每个时刻 $t$ 和每个电气节点，总的功率注入等于总的功率流出。对于整个微电网，简化的有功功率[平衡方程](@entry_id:172166)为：
    $\sum_{g \in \mathcal{G}} p_{g}^{t} + p_{\mathrm{grid}}^{t} + \sum_{s \in \mathcal{S}} (p_{s}^{t,\mathrm{dis}} - p_{s}^{t,\mathrm{ch}}) + p_{\mathrm{nondisp},t} = d_t$
    其中 $p_{\mathrm{nondisp},t}$ 是不可调度资源（如光伏）的净注入， $d_t$ 是总负荷。

*   **设备运行约束**：每类设备都有其自身的技术限制，必须在模型中精确表达。

### 关键微电网组件的建模

下面我们深入探讨两种关键可调度资源——[发电机](@entry_id:268282)和储能系统——的约束建模。

#### 可调度[发电机](@entry_id:268282)的建模

对于具有显著启停成本和机械惯性的[发电机](@entry_id:268282)（如[柴油机](@entry_id:203896)），除了简单的功率上下限之外，还必须考虑其动态特性。这通常通过引入额外的[二进制变量](@entry_id:162761)和跨时间步的耦合约束来实现 。

1.  **启停状态逻辑**：我们需要将[发电机](@entry_id:268282)的开/关状态 $u_t \in \{0,1\}$ 与其在 $t$ 时刻的启动事件 $v_t \in \{0,1\}$ 和停机事件 $w_t \in \{0,1\}$ 关联起来。假设 $u_0$ 是调度开始前的状态，那么对于 $t=1, \dots, T$，状态转移的逻辑关系可以精确地表示为：
    $u_t - u_{t-1} = v_t - w_t$
    这个线性等式巧妙地捕捉了所有情况：状态不变时 ($u_t = u_{t-1}$)，等式右侧为零，意味着没有启动或停机；启动时 ($u_{t-1}=0, u_t=1$)，等式右侧为 $1$，强制 $v_t=1$；停机时 ($u_{t-1}=1, u_t=0$)，等式右侧为 $-1$，强制 $w_t=1$。由于 $v_t$ 和 $w_t$ 在目标函数中带有正成本，优化过程会自动避免它们同时为 $1$。

2.  **最小上/下线时间**：物理上，频繁启停会损害[发电机](@entry_id:268282)。因此，需要强制规定最小上线时间 ($\tau^{\mathrm{up}}$) 和最小下线时间 ($\tau^{\mathrm{down}}$)。
    *   **最小上线时间**：如果[发电机](@entry_id:268282)在 $t$ 时刻启动 ($v_t=1$)，它必须在接下来的 $\tau^{\mathrm{up}}$ 个时段内保持开启。这可以表示为：
        $\sum_{k=t}^{t+\tau^{\mathrm{up}}-1} u_k \ge \tau^{\mathrm{up}} v_t$
        这个约束只有在 $v_t=1$ 时才起作用，强制从 $u_t$ 到 $u_{t+\tau^{\mathrm{up}}-1}$ 的所有状态变量都为 $1$。
    *   **最小下线时间**：同理，如果[发电机](@entry_id:268282)在 $t$ 时刻停机 ($w_t=1$)，它必须在接下来的 $\tau^{\mathrm{down}}$ 个时段内保持关闭。这可以表示为：
        $\sum_{k=t}^{t+\tau^{\mathrm{down}}-1} (1-u_k) \ge \tau^{\mathrm{down}} w_t$

通过一个具体的例子可以更好地理解这些约束如何影响经济决策 。假设一台[发电机](@entry_id:268282)的启动成本为 $30$，停机成本为 $10$，最小上/下线时间均为 $2$ 小时。通过计算每个小时运行[发电机](@entry_id:268282)相对于从电网购电的“节省” $s_t = c_t^{\mathrm{grid}} - c_t^{\mathrm{gen}}$，调度问题就转变为选择一个满足最小上/下线时间约束的开机序列 $\{u_t\}$，使得总节省 $\sum_t u_t s_t$ 减去总的启停成本后最大化。即使在某些小时运行[发电机](@entry_id:268282)的成本略高于电价（即 $s_t  0$），为了避免因满足最小上线时间约束而导致的昂贵的停机和再次启动，保持[发电机](@entry_id:268282)运行可能仍然是全局最优的选择。

#### 储能系统的建模

储能系统，特别是电池，是微电网灵活性的关键来源。其模型必须捕捉能量守恒和物理限制。

1.  **[荷电状态 (SOC)](@entry_id:1132303) 动态**：如前所述，SOC 的演变是一个简单的积分过程：
    $e_{t+1} = e_t + (\eta^{\mathrm{ch}} p_t^{\mathrm{ch}} - \frac{1}{\eta^{\mathrm{dis}}} p_t^{\mathrm{dis}}) \Delta t$
    其中 $\eta^{\mathrm{ch}}$ 和 $\eta^{\mathrm{dis}}$ 分别是充电和放电效率，它们通常小于 $1$，代表了[能量转换](@entry_id:165656)过程中的损耗。SOC 本身也必须维持在安全范围内：$e_{\min} \le e_t \le e_{\max}$。

2.  **非同时充放电**：一个电池不能在同一时刻既充电又放电。在数学上，这表示为**互补约束**：$p_t^{\mathrm{ch}} \cdot p_t^{\mathrm{dis}} = 0$。这是一个非凸约束，给优化问题带来了挑战。处理该约束有几种主流方法 ：
    *   **[混合整数规划](@entry_id:1127956) (MIP)**：引入一个二进制变量 $\delta_t \in \{0,1\}$ 来表示充/放电模式。通过“大M”法，可以将约束线性化为：
        $0 \le p_t^{\mathrm{ch}} \le \delta_t P_{\max}^{\mathrm{ch}}$
        $0 \le p_t^{\mathrm{dis}} \le (1 - \delta_t) P_{\max}^{\mathrm{dis}}$
        这种方法能精确地执行非同时性，但代价是将问题变成了混合整数问题，计算复杂度更高。
    *   **[凸松弛](@entry_id:636024) (Convex Relaxation)**：在许多实际情况下，我们可以不显式地加入这个约束。如果电池的往返效率严格小于1（即 $\eta^{\mathrm{ch}}\eta^{\mathrm{dis}}  1$），并且边际电价严格为正，那么任何理性的调度方案都不会选择同时充放电。因为这样做会凭空产生损耗（即以一个较低的效率买入能量，再以一个更低的价格卖出），这在经济上是不划算的。因此，在一个纯凸模型中，最优解通常会自动满足非同时性。
    *   **惩[罚函数法](@entry_id:636090)**：在[目标函数](@entry_id:267263)中加入一个凸惩罚项，如 $\lambda \sum_t (p_t^{\mathrm{ch}} + p_t^{\mathrm{dis}})^2$。这个二次项会惩罚总功率通量，从而间接抑制同时充放电。这种方法保持了问题的[凸性](@entry_id:138568)，但不能绝对保证非同时性，其效果依赖于惩罚因子 $\lambda$ 的大小。

3.  **退化成本建模**：电池循环会造成其容量衰减，这是一种真实的经济成本。在优化模型中量化这一成本对于做出正确的长期决策至关重要。一个实用且能保持模型[凸性](@entry_id:138568)的方法是，将退化成本近似为与总放电能量成正比的线性成本 。
    这个线性成本系数 $\alpha$ (单位：$/MWh$) 可以从制造商提供的循环寿命数据中标定。通常，数据会给出在不同放电深度 ($d$)下电池能承受的循环次数 $N(d)$。对于深度为 $d$ 的一次循环，其单位能量的摊销成本为 $k(d) = \frac{C_{\mathrm{rep}}}{E_{\mathrm{cap}} \cdot d \cdot N(d)}$，其中 $C_{\mathrm{rep}}$ 是电池更换成本，$E_{\mathrm{cap}}$ 是电池容量。为了得到一个适用于任意调度策略的、保守的（即上界的）线性成本，我们应该选取所有可能放电深度中单位能量成本最高的那一个作为全局成本系数 $\alpha = \sup_d k(d)$。例如，若计算得出 $k(1.0)=25$/MWh, $k(0.8)\approx 17.86$/MWh, $k(0.5)\approx 13.33$/MWh，那么我们应选择 $\alpha=25$/MWh。这样，总退化成本就可以表示为 $C_{\mathrm{deg}} = \alpha \sum_t p_t^{\mathrm{dis}} \Delta t$，这是一个线性（因此是凸的）项，可以方便地加入到总[目标函数](@entry_id:267263)中。

### [网络建模](@entry_id:262656)与运行模式

微电网的运行状态和物理连接方式深刻地影响着调度模型的数学结构。

#### 并网与孤岛运行的对比

微电网的两种主要运行模式——并网和孤岛——在建模上有本质区别 。

*   **并网模式 (Grid-Connected)**：
    *   **功率平衡**：微电网可以通过PCC与主电网交换功率。功率[平衡方程](@entry_id:172166)中包含电网交换功率项 $p_{t}^{\mathrm{grid}}$，它充当了一个“松弛”变量，使得内部发电不必严格等于内部负荷。
    *   **频率**：频率由强大的主电网决定，可视为一个固定的外部参数 ($f_t \approx f^{\mathrm{nom}}$)。调度模型无需关心[频率控制](@entry_id:1125321)。
    *   **[可行域](@entry_id:136622)**：由于可以从电网获得支持，并网模式下的可行操作空间更大。例如，内部发电可以为零，所有负荷由电网承担。同样，微电网也无需为频率稳定而保留备用容量。

*   **孤岛模式 (Islanded)**：
    *   **功率平衡**：与主电网断开连接，因此 $p_{t}^{\mathrm{grid}} = 0$。内部发电必须在每一刻都严格等于内部负荷加损耗。这是一个硬约束。
    *   **频率**：频率不再是外部给定的，而是由微电网内部的[发电机](@entry_id:268282)（通常是同步[发电机](@entry_id:268282)或具备[虚拟同步机](@entry_id:1133830)功能的逆变器）动态决定的内生变量。调度模型必须确保有足够的旋转备用或等效的快速响应能力，以在发生扰动时将频率稳定在安全范围内。这引入了额外的备用容量约束，进一步缩小了可行域。
    *   **[可行域](@entry_id:136622)**：孤岛模式的可行域是并网模式[可行域](@entry_id:136622)的一个严格子集。任何一个孤岛可行的调度方案，通过设置 $p_{t}^{\mathrm{grid}} = 0$ 都可以成为一个并网可行的方案，但反之不成立。

因此，从并网切换到孤岛模式，在模型层面意味着：决策变量 $p_{t}^{\mathrm{grid}}$ 被移除，功率平衡约束变得更加严格，并且新增了关于频率稳定和备用容量的复杂约束。

#### [电力](@entry_id:264587)潮流模型

为了精细化管理微电网内的电压和线路拥塞，我们需要一个网络模型。根据精度和计算复杂度的不同，有几种选择 ：

1.  **[交流潮流](@entry_id:1120762) (AC Power Flow)**：这是最精确的模型，它使用完整的[非线性](@entry_id:637147)、非凸方程组来描述电压、相角、有功和无功功率之间的关系。虽然精确，但其非[凸性](@entry_id:138568)使得在优化问题中难以求解[全局最优解](@entry_id:175747)。当电压约束严格、线路 $R/X$ 比（电阻/电抗比）不可忽略时（这在配电网中很常见），精确的电压和损耗计算是必要的，此时AC潮流是基准模型。

2.  **[直流潮流](@entry_id:1123429) (DC Power Flow)**：这是AC潮流的线性化近似，广泛用于输电系统。它基于几个强假设：电压幅值恒为1 p.u.，相角差很小，且线路电阻远小于[电抗](@entry_id:275161) ($R \ll X$)。在典型的微电网（配电网）中，$R/X$ 比通常接近甚至大于1，这使得DC潮流的核心假设不成立。因此，DC潮流模型**不适用**于大多数微电网的优化调度，因为它完全忽略了无功功率和电压幅值，而这两者在[配电网](@entry_id:1130020)中至关重要。

3.  **线性化[配电网](@entry_id:1130020)潮流 (LinDistFlow)**：这是一系列专为辐射状[配电网](@entry_id:1130020)设计的线性化模型。它通过忽略[电压降](@entry_id:263648)方程中的二次损耗项，得到了有功/无功功率流与电压平方之间的一组[线性递推关系](@entry_id:273376)。例如，沿着一条线路 $(i,j)$，电压关系可以近似为 $|V_j|^2 \approx |V_i|^2 - 2 (R_{ij} P_{ij} + X_{ij} Q_{ij})$。与DC潮流不同，LinDistFlow保留了电阻和无功功率的影响，能够合理地近似[电压降](@entry_id:263648)和损耗，特别适合于 $R/X$ 比不小的辐射状微电网。它在[计算效率](@entry_id:270255)和模型精度之间取得了很好的平衡，是微[电网优化](@entry_id:1130041)调度中最常用的网络模型之一。

### 数学结构与求解方法

微[电网优化](@entry_id:1130041)调度问题的数学特性决定了其求解的难易程度和解的质量。

#### [凸性](@entry_id:138568)及其重要性

一个优化问题如果其[目标函数](@entry_id:267263)是**[凸函数](@entry_id:143075)**，且可行域是**[凸集](@entry_id:155617)**，则被称为**[凸优化](@entry_id:137441)问题**。[凸优化](@entry_id:137441)问题具有优美的性质：任何局部最优解都是[全局最优解](@entry_id:175747)。这保证了我们可以通过高效的算法（如[内点法](@entry_id:169727)）在[多项式时间](@entry_id:263297)内找到问题的唯一最优解 。

*   **凸模型的构成**：一个基础的微电网调度模型，如果发电成本是二次的，电池退化成本是线性的或凸的，并且所有约束都是线性的（如简化的功率平衡、设备上下限）或凸的（如LinDistFlow的[二阶锥](@entry_id:637114)形式），那么整个问题就是凸的。

*   **非凸性的来源**：在更精细的模型中，非凸性是常态。主要来源包括：
    *   **整数变量**：[发电机](@entry_id:268282)的启停决策 ($u_t \in \{0,1\}$) 引入了离散性，使得[可行域](@entry_id:136622)非凸。
    *   **非凸成本函数**：热力[发电机](@entry_id:268282)的“阀点效应”会在平滑的二次成本曲线上叠加一个非凸的波纹（如 $\sin(\cdot)$ 函数）。
    *   **非凸约束**：完整的AC潮流方程是高度非凸的。

当问题非凸时，求解变得异常困难。局部[优化算法](@entry_id:147840)（如梯度下降）可能会陷入次优解。要寻找并验证全局最优解，需要依赖混合整数[非线性规划](@entry_id:636219)（MINLP）求解器，这些求解器通常采用分支定界等方法，其最坏情况下的计算时间随整数变量数量呈指数级增长。

### 高级建模考量

最后，我们讨论两个在实际调度中至关重要的高级主题：时间和不确定性。

#### 调度中的时间尺度

微电网调度是一个多时间尺度的控制问题。在构建一个基于模型预测控制（MPC）的调度框架时，必须合理选择两个关键的时间参数 ：

1.  **采样时间 $T_s$** (或称调度步长)：这是调度优化问题被重新求解和更新设备设定点的频率。$T_s$ 的选择是一个权衡：
    *   它必须**足够快**，以捕捉对调度有意义的负荷和可再生能源波动的特征，避免“[混叠](@entry_id:146322)效应”（根据[奈奎斯特采样定理](@entry_id:268107)，$T_s$应小于能量相关波动主要周期的一半）。例如，如果负荷的特征变化时间约为120秒，那么$T_s$应显著小于60秒。
    *   它又必须**足够慢**，以符合“[时间尺度分离](@entry_id:149780)”原则。对于响应极快的设备，如[响应时间](@entry_id:271485)在亚秒到秒级的逆变器，调度层应视其为可以瞬时跟踪设定点，而无需在模型中包含其详细动态。一个10秒的 $T_s$ 远大于逆变器的0.1秒时间常数，因此是合理的。
    *   $T_s$ 也为慢速设备的离散化约束提供了分辨率。例如，对于[爬坡率](@entry_id:1130534)为 $0.3\,\mathrm{MW/min}$ 的[发电机](@entry_id:268282)，10秒的步长（$1/6$分钟）允许其每步调整 $0.05\,\mathrm{MW}$，提供了精细的控制粒度。

2.  **[预测时域](@entry_id:261473) $H$**：这是每次优化所考虑的未来时间范围。
    *   $H$ 必须**足够长**，以“预见”[并合](@entry_id:147963)理规划与慢[动态相关](@entry_id:171647)的决策。例如，如果[发电机](@entry_id:268282)的最小上线时间是10分钟，那么一个仅有2分钟的[预测时域](@entry_id:261473)将无法做出关于启停的明智决策。$H$ 应至少大于所有设备的最小上/下线时间。
    *   $H$ 还应覆盖多个预测更新周期，以便调度能够前瞻性地响应预报的变化。例如，若天气预报每5分钟更新一次，一个60分钟的 $H$ 可以看到12个未来的预报情景。

综合考虑，对于一个包含响应时间为秒级的逆变器、分钟级约束的热力[发电机](@entry_id:268282)和分钟级变化特性的负荷的微电网，一个合理的MPC参数选择可能是 $T_s = 10$ 秒和 $H = 60$ 分钟。

#### 可再生能源不确定性的建模

光伏和风能的[间歇性](@entry_id:275330)与不确定性是微电网调度面临的核心挑战。处理不确定性主要有两种范式 ：

1.  **[随机规划](@entry_id:168183) (Stochastic Programming)**：这种方法将不确定性描述为一个概率分布，并旨在优化某个统计意义上的目标，如期望成本。
    *   **适用场景**：适用于**数据丰富**且**风险态度温和**的场景。当拥有大量历史数据来准确估计不确定性的概率分布时（例如，通过数千天的历史数据训练出一个可靠的概率预测模型），我们可以生成大量场景来近似这个分布（即场景平均近似法，SAA）。
    *   **风险偏好**：除了优化期望成本（风险中性），随机规划还可以优化风险度量，如**[条件风险价值](@entry_id:163580) (Conditional Value-at-Risk, C[VaR](@entry_id:140792))**。例如，优化95%的C[VaR](@entry_id:140792)意味着最小化最坏5%场景下的平均成本，这直接满足了运营商控制尾部风险的需求。

2.  **鲁棒优化 (Robust Optimization)**：这种方法不假设概率分布，而是定义一个“[不确定集](@entry_id:634516)” $\mathcal{U}$，该集合包含了所有可能发生的不确定性实现。其目标是找到一个在**所有**这些实现下都可行的、且最坏情况成本最低的解。
    *   **适用场景**：适用于**数据匮乏**或**安全攸关**的场景。当历史数据很少（例如，刚安装了新的光伏板），或者数据分布不稳定（存在“模式漂移”），无法建立可靠的概率模型时，鲁棒优化提供了一种安全的选择。对于医院等关键负荷，其“绝不能出错”的性质要求调度方案能够抵御一切“合理”的最坏情况，即使这意味着更高的日常运行成本。
    *   **[不确定集](@entry_id:634516)**：[不确定集](@entry_id:634516)的构造是关键。它可以是简单的区间集（每个时段的不确定量都在其上下限内独立变化），也可以是更复杂的“预算[不确定集](@entry_id:634516)”，后者限制了不确定性偏离其预测值的总幅度，从而避免了过度保守的解。

总之，当拥有高质量的概率信息且允许一定风险时，[随机规划](@entry_id:168183)（特别是结合C[VaR](@entry_id:140792)）是更精细、经济的工具。当信息匮乏且[系统可靠性](@entry_id:274890)是首要目标时，[鲁棒优化](@entry_id:163807)是更审慎、可靠的選擇。