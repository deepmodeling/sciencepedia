{
    "hands_on_practices": [
        {
            "introduction": "要将内生性技术学习融入能源系统模型，我们首先需要一个精确的数学表达。本练习聚焦于“干中学”(learning-by-doing)最常用的模型——赖特学习曲线(Wright-type learning curve)，并要求您推导其关键属性。通过的实践，您将阐明成本与累积装机容量之间的弹性关系，从而深刻理解学习指数 $\\lambda$ 如何量化部署对成本下降的直接影响，这对于评估补贴等政策至关重要。",
            "id": "4088867",
            "problem": "考虑一种单一的能源转换技术，其在日历时间 $t$ 的单位生产成本 $c(t,Q)$ 是一个外生趋势和一个内生学习项的乘积，这与能源系统建模中广泛观察到的经验规律一致。设外生趋势是一个严格为正的可微函数 $a(t)  0$，它捕捉了所有不依赖于部署的时间相关成本驱动因素（例如，源自该行业外部的研发溢出效应、宏观经济状况），并设内生学习由累积装机容量 $Q$ 的函数 $b(Q)$ 表示，该函数也是严格为正且可微的。假设其形式为\n$$\nc(t,Q) = a(t)\\,b(Q),\n$$\n$b(Q)$ 服从赖特型学习曲线（一种在产业动态学中经过广泛检验的规律）：\n$$\nb(Q) = b_{0}\\left(\\frac{Q}{Q_{0}}\\right)^{-\\lambda},\n$$\n其中 $b_{0}  0$ 和 $Q_{0}  0$ 是常数，$\\lambda  0$ 是学习指数。假设 $a(t)$ 对决策者是外生的（它不依赖于 $Q$），而 $Q$ 是内生的，由部署决策决定。\n\n仅使用对数、弹性和基本微分学的定义，推导在固定时间 $t$ 下，成本相对于累积容量的弹性，其定义为\n$$\n\\epsilon_{c,Q} \\equiv \\frac{\\partial \\ln c(t,Q)}{\\partial \\ln Q}.\n$$\n请将您的最终答案表示为仅含 $\\lambda$ 的单一闭式解析表达式。不需要数值近似。\n\n然后，在不改变您的解析答案的情况下，简要解释为什么在“干中学”是内生技术假设时，所推导的弹性对于部署补贴的设计具有信息价值，并解释外生趋势 $a(t)$ 是否影响此弹性。\n\n请提供最终的弹性作为您的唯一最终答案。由于弹性是无量纲的，因此不需要单位。",
            "solution": "评估问题陈述的有效性。\n\n### 步骤1：提取已知条件\n- 单位生产成本函数：$c(t,Q) = a(t)\\,b(Q)$，其中 $t$ 是日历时间，$Q$ 是累积装机容量。\n- 外生趋势：$a(t)$ 是一个严格为正的可微函数，$a(t)  0$。它不依赖于 $Q$。\n- 内生学习项：$b(Q)$ 是一个严格为正的可微函数，$b(Q)  0$。\n- $b(Q)$ 的函数形式（赖特型学习曲线）：$b(Q) = b_{0}\\left(\\frac{Q}{Q_{0}}\\right)^{-\\lambda}$。\n- 常数：$b_{0}  0$，$Q_{0}  0$ 和 $\\lambda  0$（学习指数）。\n- 成本相对于累积容量的弹性定义：$\\epsilon_{c,Q} \\equiv \\frac{\\partial \\ln c(t,Q)}{\\partial \\ln Q}$。\n- 任务是推导 $\\epsilon_{c,Q}$ 的闭式表达式（用 $\\lambda$ 表示），并提供简要解释。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于一个标准的双因素学习曲线模型，该模型在能源系统分析和产业经济学中被广泛使用。将成本趋势分解为外生（$a(t)$）和内生（$b(Q)$）因素是该领域的基石。赖特型学习曲线是一个经验上稳健的“干中学”模型。所有定义在数学和经济学中都是标准的。该问题在科学上是合理的。\n- **适定性：** 所有必需的函数、常数和定义都已提供并且是自洽的。函数被指定为可微的，确保所需导数存在。问题要求推导一个特定的、明确定义的量，预期会有一个唯一解。\n- **客观性：** 问题使用精确、客观的数学语言陈述，没有主观或模糊的术语。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它在数学上是适定的，有既定经济理论的科学依据，并包含获得唯一解所需的所有信息。我们开始推导。\n\n单位生产成本由函数给出：\n$$\nc(t,Q) = a(t)\\,b(Q)\n$$\n成本 $c$ 相对于累积容量 $Q$ 的弹性定义为：\n$$\n\\epsilon_{c,Q} \\equiv \\frac{\\partial \\ln c(t,Q)}{\\partial \\ln Q}\n$$\n为了计算这个弹性，我们首先对成本函数 $c(t,Q)$ 取自然对数：\n$$\n\\ln c(t,Q) = \\ln(a(t)\\,b(Q))\n$$\n使用对数性质 $\\ln(xy) = \\ln(x) + \\ln(y)$，我们可以分离各项：\n$$\n\\ln c(t,Q) = \\ln(a(t)) + \\ln(b(Q))\n$$\n现在，我们可以将此表达式代入弹性定义中：\n$$\n\\epsilon_{c,Q} = \\frac{\\partial}{\\partial \\ln Q} \\left[ \\ln(a(t)) + \\ln(b(Q)) \\right]\n$$\n和的导数等于导数的和：\n$$\n\\epsilon_{c,Q} = \\frac{\\partial (\\ln a(t))}{\\partial \\ln Q} + \\frac{\\partial (\\ln b(Q))}{\\partial \\ln Q}\n$$\n第一项 $\\frac{\\partial (\\ln a(t))}{\\partial \\ln Q}$ 涉及一个 $t$ 的函数对一个与 $Q$ 相关的变量的偏导数。问题陈述中指出，导数是在固定时间 $t$ 下求的。此外，$a(t)$ 是外生的，不依赖于 $Q$。因此，在求此偏导数时，$\\ln(a(t))$ 被视为常数，其对 $\\ln Q$ 的导数为零。\n$$\n\\frac{\\partial (\\ln a(t))}{\\partial \\ln Q} = 0\n$$\n这可将弹性表达式简化为：\n$$\n\\epsilon_{c,Q} = \\frac{\\partial (\\ln b(Q))}{\\partial \\ln Q}\n$$\n接下来，我们代入已知的学习曲线形式 $b(Q) = b_{0}\\left(\\frac{Q}{Q_{0}}\\right)^{-\\lambda}$：\n$$\n\\ln b(Q) = \\ln \\left( b_{0}\\left(\\frac{Q}{Q_{0}}\\right)^{-\\lambda} \\right)\n$$\n使用对数性质 $\\ln(xy) = \\ln(x) + \\ln(y)$ 和 $\\ln(x^p) = p \\ln(x)$，我们展开此表达式：\n$$\n\\ln b(Q) = \\ln(b_{0}) + \\ln\\left(\\left(\\frac{Q}{Q_{0}}\\right)^{-\\lambda}\\right) = \\ln(b_{0}) - \\lambda \\ln\\left(\\frac{Q}{Q_{0}}\\right)\n$$\n使用性质 $\\ln(x/y) = \\ln(x) - \\ln(y)$，我们进一步展开：\n$$\n\\ln b(Q) = \\ln(b_{0}) - \\lambda (\\ln Q - \\ln Q_{0}) = \\ln(b_{0}) - \\lambda \\ln Q + \\lambda \\ln Q_{0}\n$$\n现在我们将 $\\ln b(Q)$ 的最终形式代回弹性表达式：\n$$\n\\epsilon_{c,Q} = \\frac{\\partial}{\\partial \\ln Q} \\left[ \\ln(b_{0}) - \\lambda \\ln Q + \\lambda \\ln Q_{0} \\right]\n$$\n项 $\\ln(b_{0})$ 和 $\\lambda \\ln Q_{0}$ 相对于 $Q$ 是常数。因此，它们对 $\\ln Q$ 的导数为零。\n$$\n\\epsilon_{c,Q} = \\frac{\\partial}{\\partial \\ln Q}(\\ln b_{0}) - \\frac{\\partial}{\\partial \\ln Q}(\\lambda \\ln Q) + \\frac{\\partial}{\\partial \\ln Q}(\\lambda \\ln Q_{0})\n$$\n$$\n\\epsilon_{c,Q} = 0 - \\lambda \\frac{\\partial (\\ln Q)}{\\partial \\ln Q} + 0\n$$\n由于 $\\frac{\\partial (\\ln Q)}{\\partial \\ln Q} = 1$，该表达式简化为：\n$$\n\\epsilon_{c,Q} = -\\lambda\n$$\n\n成本相对于累积容量的弹性等于学习指数 $\\lambda$ 的负值。这个结果是恒定的，不依赖于时间 $t$ 或累积容量 $Q$。\n\n对这个结果的一种解释是，累积装机容量 $Q$ 每增加 $1\\%$，单位生产成本 $c$ 大约下降 $\\lambda\\%$。这为“干中学”效应的影响提供了一个直接的量化度量。对于设计部署补贴的决策者来说，这个弹性是一个关键参数。更高的 $\\lambda$ 值意味着鼓励部署（从而增加 $Q$）的政策在降低成本方面将更有效，可能加速技术在没有支持的情况下达到成本竞争力的时间点。\n\n如推导所示，外生趋势 $a(t)$ 不影响此弹性。在对 $\\ln Q$ 求偏导的过程中，项 $\\ln(a(t))$ 消失了，因为假设 $a(t)$ 独立于 $Q$。这意味着，尽管研发溢出或大宗商品价格变化等外生因素确实会影响绝对成本水平 $c(t,Q)$，但它们不会改变*通过部署本身实现的成本降低率*。弹性 $\\epsilon_{c,Q}$ 隔离了内生“干中学”的纯粹效应。",
            "answer": "$$\n\\boxed{-\\lambda}\n$$"
        },
        {
            "introduction": "在掌握了学习曲线的理论模型后，一个自然而然的问题是：我们如何从真实数据中估计其参数，如学习指数 $b$？本练习揭示了这一过程中的一个核心挑战——当把部署量视为外生变量时产生的估计偏差。通过分析一个包含成本和市场需求反馈的简化系统，您将亲自量化这种“联立方程偏误”(simultaneous equations bias)，从而认识到为何在实证研究中必须谨慎处理内生性。",
            "id": "4088924",
            "problem": "考虑一个风格化的单一技术能源系统情景，其中单位成本根据赖特定律（Wright’s law）随累积部署量的增加而下降。令 $y \\equiv \\ln(c)$ 表示单位成本的自然对数，令 $x \\equiv \\ln(X)$ 表示累积部署量的自然对数。成本与累积部署量之间的结构关系由下式给出：\n$$\ny = \\alpha - b x + u,\n$$\n其中 $\\alpha$ 是一个常数，$b  0$ 是与赖特定律相关的学习指数，$u$ 是一个均值为零的冲击，代表未观测到的成本因素。市场表现出恒定需求弹性（Constant Elasticity of Demand, CED），因此实际部署量对成本的响应如下：\n$$\nx = \\delta - \\epsilon y + w,\n$$\n其中 $\\delta$ 是一个常数，$\\epsilon  0$ 是对数形式下需求对成本的弹性，$w$ 是一个均值为零的冲击，代表未观测到的需求侧影响。假设 $u$ 和 $w$ 相互独立，均值为零，并且在观测单元之间相互独立，且 $\\operatorname{Var}(u) = \\sigma_{u}^{2}$ 和 $\\operatorname{Var}(w) = \\sigma_{w}^{2}$。假设反馈是稳定的，因此 $1 - \\epsilon b  0$。一位分析师将部署量视为外生变量，对 $y$ 关于 $x$ 进行普通最小二乘法（OLS）回归，并将估计的斜率系数的负值解释为学习指数。\n\n从上述定义和内生性条件下 OLS 估计量的基本性质出发，推导出将部署量视为外生变量的 OLS 估计量对 $b$ 的渐近偏差，将其表示为 $\\epsilon$、$b$、$\\sigma_{u}^{2}$ 和 $\\sigma_{w}^{2}$ 的函数。然后，对于参数值 $\\epsilon = 0.7$、$b = 0.2$、$\\sigma_{u}^{2} = 0.02$ 和 $\\sigma_{w}^{2} = 0.08$，计算该渐近偏差的数值。将您的答案表示为一个四舍五入到 $4$ 位有效数字的无量纲数。",
            "solution": "用户希望我解决以下问题：\n考虑一个风格化的单一技术能源系统情景，其中单位成本根据赖特定律（Wright’s law）随累积部署量的增加而下降。令 $y \\equiv \\ln(c)$ 表示单位成本的自然对数，令 $x \\equiv \\ln(X)$ 表示累积部署量的自然对数。成本与累积部署量之间的结构关系由下式给出：\n$$\ny = \\alpha - b x + u,\n$$\n其中 $\\alpha$ 是一个常数，$b  0$ 是与赖特定律相关的学习指数，$u$ 是一个均值为零的冲击，代表未观测到的成本因素。市场表现出恒定需求弹性（Constant Elasticity of Demand, CED），因此实际部署量对成本的响应如下：\n$$\nx = \\delta - \\epsilon y + w,\n$$\n其中 $\\delta$ 是一个常数，$\\epsilon  0$ 是对数形式下需求对成本的弹性，$w$ 是一个均值为零的冲击，代表未观测到的需求侧影响。假设 $u$ 和 $w$ 相互独立，均值为零，并且在观测单元之间相互独立，且 $\\operatorname{Var}(u) = \\sigma_{u}^{2}$ 和 $\\operatorname{Var}(w) = \\sigma_{w}^{2}$。假设反馈是稳定的，因此 $1 - \\epsilon b  0$。一位分析师将部署量视为外生变量，对 $y$ 关于 $x$ 进行普通最小二乘法（OLS）回归，并将估计的斜率系数的负值解释为学习指数。\n\n从上述定义和内生性条件下 OLS 估计量的基本性质出发，推导出将部署量视为外生变量的 OLS 估计量对 $b$ 的渐近偏差，将其表示为 $\\epsilon$、$b$、$\\sigma_{u}^{2}$ 和 $\\sigma_{w}^{2}$ 的函数。然后，对于参数值 $\\epsilon = 0.7$、$b = 0.2$、$\\sigma_{u}^{2} = 0.02$ 和 $\\sigma_{w}^{2} = 0.08$，计算该渐近偏差的数值。将您的答案表示为一个四舍五入到 $4$ 位有效数字的无量纲数。\n\n### 步骤 1：提取已知条件\n-   成本的结构方程（对数-对数形式）：$y = \\alpha - b x + u$\n-   部署量的结构方程（对数-对数形式）：$x = \\delta - \\epsilon y + w$\n-   变量定义：$y = \\ln(c)$，$x = \\ln(X)$\n-   参数定义：$\\alpha$ 是常数，$b  0$ 是学习指数，$\\delta$ 是常数，$\\epsilon  0$ 是需求弹性。\n-   随机冲击的性质：$E[u] = 0$，$E[w] = 0$，$\\operatorname{Var}(u) = \\sigma_{u}^{2}$，$\\operatorname{Var}(w) = \\sigma_{w}^{2}$，$\\operatorname{Cov}(u, w) = 0$。冲击在各观测值之间是独立的。\n-   稳定性条件：$1 - \\epsilon b  0$。\n-   分析师的步骤：对 $y$ 关于 $x$ 进行 OLS 回归。斜率系数的估计量记为 $\\hat{\\beta}_{1}$。分析师对学习指数的估计量为 $\\hat{b}_{OLS} = -\\hat{\\beta}_{1}$。\n-   任务：推导 $\\hat{b}_{OLS}$ 的渐近偏差，即 $\\operatorname{plim}(\\hat{b}_{OLS}) - b$，并为给定参数计算其数值。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题是计量经济学理论（联立方程偏差）在能源经济学中广泛使用的模型（赖特定律学习曲线和恒定需求弹性需求）上的标准应用。其设定在科学和数学上是合理的。\n-   **适定性**：方程组对于内生变量 $x$ 和 $y$ 是线性的。稳定性条件 $1 - \\epsilon b  0$ 确保了 $x$ 和 $y$ 存在唯一的简约式解。问题要求一个具体可计算的量（渐近偏差）。\n-   **客观性**：问题以计量经济学和建模中常见的精确、正式的语言陈述，没有主观或含糊的术语。\n\n### 步骤 3：结论与行动\n问题是有效的。将提供完整的解答。\n\n### 解题推导\n\n问题描述了一个联立方程模型，其中变量 $y$ 和 $x$ 是共同决定的。分析师基于第一个结构方程 $y = \\alpha - b x + u$ 对 $y$ 关于 $x$ 运行 OLS 回归。真实的斜率系数是 $-b$。由于联立性，回归量 $x$ 与误差项 $u$ 相关，导致 OLS 估计量有偏。\n\n斜率系数的 OLS 估计量，我们称之为 $\\hat{\\beta}_1$，其概率极限由下式给出：\n$$\n\\operatorname{plim}(\\hat{\\beta}_1) = \\frac{\\operatorname{Cov}(x, y)}{\\operatorname{Var}(x)}\n$$\n分析师对学习指数的估计量是 $\\hat{b}_{OLS} = -\\hat{\\beta}_1$。我们需要找到这个估计量的渐近偏差：\n$$\n\\text{渐近偏差} = \\operatorname{plim}(\\hat{b}_{OLS}) - b = \\operatorname{plim}(-\\hat{\\beta}_1) - b = -\\operatorname{plim}(\\hat{\\beta}_1) - b\n$$\n为了计算这个偏差，我们首先需要找到 $x$ 和 $y$ 的简约式表达式，这些表达式仅用外生变量和冲击来表示它们。\n\n方程组为：\n$$\n\\begin{cases}\ny = \\alpha - b x + u  (1) \\\\\nx = \\delta - \\epsilon y + w  (2)\n\\end{cases}\n$$\n将方程 $(1)$ 代入方程 $(2)$：\n$$\nx = \\delta - \\epsilon (\\alpha - b x + u) + w\n$$\n$$\nx = \\delta - \\epsilon \\alpha + \\epsilon b x - \\epsilon u + w\n$$\n$$\nx(1 - \\epsilon b) = (\\delta - \\epsilon \\alpha) - \\epsilon u + w\n$$\n使用稳定性条件 $1 - \\epsilon b  0$，我们可以解出 $x$：\n$$\nx = \\frac{\\delta - \\epsilon \\alpha}{1 - \\epsilon b} - \\frac{\\epsilon}{1 - \\epsilon b} u + \\frac{1}{1 - \\epsilon b} w\n$$\n现在，将方程 $(2)$ 代入方程 $(1)$：\n$$\ny = \\alpha - b (\\delta - \\epsilon y + w) + u\n$$\n$$\ny = \\alpha - b \\delta + \\epsilon b y - b w + u\n$$\n$$\ny(1 - \\epsilon b) = (\\alpha - b \\delta) + u - b w\n$$\n解出 $y$：\n$$\ny = \\frac{\\alpha - b \\delta}{1 - \\epsilon b} + \\frac{1}{1 - \\epsilon b} u - \\frac{b}{1 - \\epsilon b} w\n$$\n有了 $x$ 和 $y$ 的简约式方程，我们现在可以计算 $\\operatorname{Var}(x)$ 和 $\\operatorname{Cov}(x, y)$。常数项不影响方差或协方差。我们使用性质 $\\operatorname{Var}(u) = \\sigma_{u}^{2}$、$\\operatorname{Var}(w) = \\sigma_{w}^{2}$ 和 $\\operatorname{Cov}(u, w) = 0$。\n\n为简化起见，令 $k = \\frac{1}{1 - \\epsilon b}$。随机部分为：\n$x_{stoch} = -k\\epsilon u + k w$\n$y_{stoch} = k u - k b w$\n\n$x$ 的方差是：\n$$\n\\operatorname{Var}(x) = \\operatorname{Var}(-k\\epsilon u + k w) = (-k\\epsilon)^2 \\operatorname{Var}(u) + k^2 \\operatorname{Var}(w) = k^2 (\\epsilon^2 \\sigma_{u}^{2} + \\sigma_{w}^{2})\n$$\n$$\n\\operatorname{Var}(x) = \\frac{\\epsilon^2 \\sigma_{u}^{2} + \\sigma_{w}^{2}}{(1 - \\epsilon b)^2}\n$$\n$x$ 和 $y$ 的协方差是：\n$$\n\\operatorname{Cov}(x, y) = \\operatorname{Cov}(-k\\epsilon u + k w, k u - k b w)\n$$\n$$\n\\operatorname{Cov}(x, y) = (-k\\epsilon)(k) \\operatorname{Var}(u) + (k)(-kb) \\operatorname{Var}(w) = -k^2\\epsilon \\sigma_{u}^{2} - k^2 b \\sigma_{w}^{2}\n$$\n$$\n\\operatorname{Cov}(x, y) = -k^2(\\epsilon \\sigma_{u}^{2} + b \\sigma_{w}^{2}) = -\\frac{\\epsilon \\sigma_{u}^{2} + b \\sigma_{w}^{2}}{(1 - \\epsilon b)^2}\n$$\n现在我们计算 OLS 斜率估计量的概率极限：\n$$\n\\operatorname{plim}(\\hat{\\beta}_1) = \\frac{\\operatorname{Cov}(x, y)}{\\operatorname{Var}(x)} = \\frac{-\\frac{\\epsilon \\sigma_{u}^{2} + b \\sigma_{w}^{2}}{(1 - \\epsilon b)^2}}{\\frac{\\epsilon^2 \\sigma_{u}^{2} + \\sigma_{w}^{2}}{(1 - \\epsilon b)^2}} = - \\frac{\\epsilon \\sigma_{u}^{2} + b \\sigma_{w}^{2}}{\\epsilon^2 \\sigma_{u}^{2} + \\sigma_{w}^{2}}\n$$\n分析师对 $b$ 的估计量的渐近偏差是：\n$$\n\\text{Asymptotic Bias}(\\hat{b}_{OLS}) = -\\operatorname{plim}(\\hat{\\beta}_1) - b\n$$\n$$\n\\text{Asymptotic Bias}(\\hat{b}_{OLS}) = \\left( \\frac{\\epsilon \\sigma_{u}^{2} + b \\sigma_{w}^{2}}{\\epsilon^2 \\sigma_{u}^{2} + \\sigma_{w}^{2}} \\right) - b\n$$\n为简化，通分：\n$$\n\\text{Asymptotic Bias} = \\frac{(\\epsilon \\sigma_{u}^{2} + b \\sigma_{w}^{2}) - b(\\epsilon^2 \\sigma_{u}^{2} + \\sigma_{w}^{2})}{\\epsilon^2 \\sigma_{u}^{2} + \\sigma_{w}^{2}}\n$$\n$$\n\\text{Asymptotic Bias} = \\frac{\\epsilon \\sigma_{u}^{2} + b \\sigma_{w}^{2} - b\\epsilon^2 \\sigma_{u}^{2} - b \\sigma_{w}^{2}}{\\epsilon^2 \\sigma_{u}^{2} + \\sigma_{w}^{2}}\n$$\n$$\n\\text{Asymptotic Bias} = \\frac{\\epsilon \\sigma_{u}^{2} - b\\epsilon^2 \\sigma_{u}^{2}}{\\epsilon^2 \\sigma_{u}^{2} + \\sigma_{w}^{2}}\n$$\n对分子中的公因式进行因式分解，得到渐近偏差的最终解析表达式：\n$$\n\\text{Asymptotic Bias} = \\frac{\\epsilon \\sigma_{u}^{2} (1 - \\epsilon b)}{\\epsilon^2 \\sigma_{u}^{2} + \\sigma_{w}^{2}}\n$$\n现在，我们代入给定的数值：$\\epsilon = 0.7$、$b = 0.2$、$\\sigma_{u}^{2} = 0.02$ 和 $\\sigma_{w}^{2} = 0.08$。\n\n首先，检查稳定性条件：$1 - \\epsilon b = 1 - (0.7)(0.2) = 1 - 0.14 = 0.86$，为正，符合要求。\n\n接下来，计算偏差表达式的分子和分母。\n分子：\n$$\n\\epsilon \\sigma_{u}^{2} (1 - \\epsilon b) = (0.7)(0.02)(0.86) = (0.014)(0.86) = 0.01204\n$$\n分母：\n$$\n\\epsilon^2 \\sigma_{u}^{2} + \\sigma_{w}^{2} = (0.7)^2 (0.02) + 0.08 = (0.49)(0.02) + 0.08 = 0.0098 + 0.08 = 0.0898\n$$\n最后，计算偏差：\n$$\n\\text{Asymptotic Bias} = \\frac{0.01204}{0.0898} \\approx 0.13407572...\n$$\n四舍五入到 $4$ 位有效数字，渐近偏差的数值为 $0.1341$。",
            "answer": "$$\n\\boxed{0.1341}\n$$"
        },
        {
            "introduction": "最后一个练习将理论与复杂的决策相结合，要求您扮演一位能源规划者。您需要在面临成本不确定性的情况下，利用包含内生学习效应的模型来制定最优的投资策略。此练习要求您将概率性的“机会约束”(chance constraint)转化为确定性等价形式，并以数值方式求解最优的产能分配。这个综合性问题旨在锻炼您将内生性假设与随机优化框架相结合的建模与计算能力，并直观比较内生与外生假设对最终决策的实质性影响。",
            "id": "4088870",
            "problem": "考虑一个能源系统规划问题，其中包含两种技术，索引为 $i \\in \\{1,2\\}$。决策变量为装机容量 $Q_1$ 和 $Q_2$，单位为兆瓦 (MW)，用以满足一个固定的需求 $M$（单位也为 MW）。由于确定性的技术特定成本上存在相关的乘性冲击，总实现成本具有不确定性。目标是在总成本满足特定机会约束的条件下，计算最优的投资分配。必须求解两种模型变体：一种是外生技术假设，单位成本为常数；另一种是内生技术假设，存在“边做边学”（learning-by-doing）效应，单位成本取决于部署规模。\n\n基本基础和定义：\n- 在外生假设下，技术 $i$ 的确定性成本函数为 $c_i(Q_i) = \\alpha_i Q_i$，其中常数单位成本参数 $\\alpha_i$ 的单位为百万美元 (USD)/兆瓦。\n- 在内生假设下，一个程式化的“边做边学”成本函数为 $c_i(Q_i) = Q_i \\left(\\alpha_i - \\beta_i \\ln(1 + Q_i)\\right)$，其中 $\\alpha_i$ 和 $\\beta_i$ 是参数，$\\alpha_i$ 的单位是百万美元 (USD)/兆瓦，$\\beta_i$ 是无量纲的。该设定体现了内生技术假设，因为单位成本通过对数项取决于所选的 $Q_i$。\n- 设乘性冲击由随机向量 $s = (s_1,s_2)$ 表示，其中 $s \\sim \\mathcal{N}(\\mu,\\Sigma)$，$\\mu = (\\mu_1,\\mu_2)$ 且 $\\Sigma$ 是由各技术的标准差 $\\sigma_1$、$\\sigma_2$ 和相关系数 $\\rho$ 构建的协方差矩阵，即 $\\Sigma = \\begin{pmatrix}\\sigma_1^2  \\rho \\sigma_1 \\sigma_2 \\\\ \\rho \\sigma_1 \\sigma_2  \\sigma_2^2 \\end{pmatrix}$。总实现成本为 $C(Q) = \\sum_{i=1}^2 c_i(Q_i) \\left(1 + s_i\\right)$，单位为百万美元 (USD)。\n- 机会约束要求总实现成本以概率 $p = 0.95$ 低于指定的预算 $B$，即 $\\mathbb{P}\\left(C(Q) \\le B\\right) \\ge p$。\n- 需求满足约束为 $\\sum_{i=1}^2 Q_i = M$，非负性要求 $Q_i \\ge 0$。\n\n您对每个测试用例的任务是：\n- 仅使用多元高斯随机变量和概率的已充分验证的性质（特别是高斯向量线性变换的性质和标准正态分布的分位数），推导机会约束 $\\mathbb{P}\\left(C(Q) \\le B\\right) \\ge p$（其中 $p = 0.95$）的确定性等价形式，该形式表示为一个包含 $Q_1$、$Q_2$、成本函数、均值向量和协方差矩阵的不等式。\n- 在外生假设下，计算在满足需求约束和机会约束的确定性等价形式的条件下，使确定性成本最小化的分配方案 $(Q_1,Q_2)$（单位 MW）。\n- 在内生假设下，计算在满足需求约束和机会约束的确定性等价形式的条件下，使确定性成本最小化的分配方案 $(Q_1,Q_2)$（单位 MW）。\n- 如果在某个给定的测试用例中，没有分配方案能满足机会约束，则该模型变体的两个决策变量均返回 $\\mathrm{nan}$。\n\n物理和数值单位：\n- 容量 $Q_1$ 和 $Q_2$ 必须以兆瓦 (MW) 为单位表示，在最终输出中为四舍五入到两位小数的实数。\n- 成本和预算以百万美元 (USD) 为单位表示。\n- 本问题不涉及角度。\n- 概率以小数形式表示（例如，$0.95$）。\n\n测试套件和参数：\n- 所有测试用例均使用 $p = 0.95$。\n- 对于所有测试用例，将搜索范围限制在分辨率步长 $\\Delta Q = 1$ MW 的离散网格上的分配方案 $Q_1$ 和 $Q_2$，并精确执行 $\\sum_{i=1}^2 Q_i = M$。\n- 测试用例 1（中等相关性的一般情况）：\n  - $\\alpha = (\\alpha_1,\\alpha_2) = (1.2, 1.0)$,\n  - $\\beta = (\\beta_1,\\beta_2) = (0.10, 0.08)$,\n  - $\\mu = (\\mu_1,\\mu_2) = (0.02, 0.03)$,\n  - $\\sigma = (\\sigma_1,\\sigma_2) = (0.10, 0.12)$,\n  - $\\rho = 0.30$,\n  - $M = 100.0$ MW,\n  - $B = 130.0$ 百万美元 (USD)。\n- 测试用例 2（高正相关性的边界类情况）：\n  - $\\alpha = (\\alpha_1,\\alpha_2) = (1.10, 1.05)$,\n  - $\\beta = (\\beta_1,\\beta_2) = (0.15, 0.05)$,\n  - $\\mu = (\\mu_1,\\mu_2) = (0.01, 0.01)$,\n  - $\\sigma = (\\sigma_1,\\sigma_2) = (0.20, 0.20)$,\n  - $\\rho = 0.90$,\n  - $M = 80.0$ MW,\n  - $B = 113.0$ 百万美元 (USD)。\n- 测试用例 3（负相关性和非对称均值的边缘情况）：\n  - $\\alpha = (\\alpha_1,\\alpha_2) = (1.30, 0.90)$,\n  - $\\beta = (\\beta_1,\\beta_2) = (0.12, 0.02)$,\n  - $\\mu = (\\mu_1,\\mu_2) = (0.00, -0.02)$,\n  - $\\sigma = (\\sigma_1,\\sigma_2) = (0.15, 0.15)$,\n  - $\\rho = -0.50$,\n  - $M = 20.0$ MW,\n  - $B = 22.5$ 百万美元 (USD)。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。此顶层列表的每个元素必须是一个包含四个浮点数的内部列表，单位为兆瓦 (MW)，按相应测试用例的 $[Q_1^{\\mathrm{exo}}, Q_2^{\\mathrm{exo}}, Q_1^{\\mathrm{endo}}, Q_2^{\\mathrm{endo}}]$ 顺序排列，并四舍五入到两位小数。例如，输出应类似于 $[[q_{11},q_{12},q_{13},q_{14}],[q_{21},q_{22},q_{23},q_{24}],\\ldots]$，其中每个 $q_{jk}$ 是一个以 MW 为单位的浮点数。",
            "solution": "### 问题验证\n\n#### 步骤 1：提取已知条件\n\n- **决策变量**：$Q_1, Q_2$ 是装机容量 (MW)。\n- **约束条件**：\n    - 需求满足：$\\sum_{i=1}^2 Q_i = M$。\n    - 非负性：$Q_i \\ge 0$。\n    - 机会约束：$\\mathbb{P}\\left(C(Q) \\le B\\right) \\ge p$，其中 $p=0.95$。\n- **成本函数**：\n    - 外生：$c_i(Q_i) = \\alpha_i Q_i$。\n    - 内生：$c_i(Q_i) = Q_i \\left(\\alpha_i - \\beta_i \\ln(1 + Q_i)\\right)$。\n- **总实现成本**：$C(Q) = \\sum_{i=1}^2 c_i(Q_i) \\left(1 + s_i\\right)$。\n- **随机冲击**：$s = (s_1,s_2) \\sim \\mathcal{N}(\\mu,\\Sigma)$，其中 $\\mu = (\\mu_1,\\mu_2)$ 且 $\\Sigma = \\begin{pmatrix}\\sigma_1^2  \\rho \\sigma_1 \\sigma_2 \\\\ \\rho \\sigma_1 \\sigma_2  \\sigma_2^2 \\end{pmatrix}$。\n- **目标**：最小化确定性成本，定义为 $\\sum_{i=1}^2 c_i(Q_i)$。\n- **数值方法**：在 $Q_1, Q_2$ 为整数、步长为 $\\Delta Q = 1$ MW 的离散网格上搜索最优分配 $(Q_1, Q_2)$。\n- **不可行性处理**：如果没有任何分配满足约束条件，则该模型变体的结果为 $(\\mathrm{nan}, \\mathrm{nan})$。\n- **测试用例 1**：$\\alpha = (1.2, 1.0)$, $\\beta = (0.10, 0.08)$, $\\mu = (0.02, 0.03)$, $\\sigma = (0.10, 0.12)$, $\\rho = 0.30$, $M = 100.0$ MW, $B = 130.0$ 百万美元。\n- **测试用例 2**：$\\alpha = (1.10, 1.05)$, $\\beta = (0.15, 0.05)$, $\\mu = (0.01, 0.01)$, $\\sigma = (0.20, 0.20)$, $\\rho = 0.90$, $M = 80.0$ MW, $B = 113.0$ 百万美元。\n- **测试用例 3**：$\\alpha = (1.30, 0.90)$, $\\beta = (0.12, 0.02)$, $\\mu = (0.00, -0.02)$, $\\sigma = (0.15, 0.15)$, $\\rho = -0.50$, $M = 20.0$ MW, $B = 22.5$ 百万美元。\n\n#### 步骤 2：使用提取的已知条件进行验证\n\n1.  **科学依据**：该问题在随机优化和能源系统建模方面有充分的理论基础。机会约束、学习曲线和正态分布冲击的使用是该领域的标准技术和假设。所有数学公式都是正确的。\n2.  **适定性**：该问题是适定的。目标函数和所有约束条件都已明确定义。为每个测试用例提供了所有必需的参数。离散网格搜索的规范确保了在可行集非空的情况下可以找到最优解。\n3.  **客观性**：问题使用精确、客观的数学语言陈述，没有任何主观或基于意见的断言。\n4.  **完整性和一致性**：该问题是自洽且内部一致的。没有缺失数据或矛盾的约束。目标是最小化“确定性成本” $\\sum_{i=1}^2 c_i(Q_i)$，这是模型中一个明确定义的部分。\n5.  **现实性和可行性**：参数值在经济和工程模型的合理范围内。内生成本函数的构造确保了在给定参数和容量范围内单位成本为非负。\n\n#### 步骤 3：结论与行动\n\n该问题是 **有效的**。它具有科学合理性、适定性和完整性。它代表了机会约束规划在一个程式化但相关的能源系统分析问题中的一个非平凡应用。\n\n### 求解推导与方法\n\n问题的核心是求解一个约束优化问题，其中一个约束是概率性的。第一步是将这个机会约束转换为其确定性等价形式。\n\n#### 机会约束的确定性等价形式\n\n机会约束由 $\\mathbb{P}\\left(C(Q) \\le B\\right) \\ge p$ 给出。总实现成本 $C(Q)$ 是一个随机变量，定义为：\n$$\nC(Q) = \\sum_{i=1}^2 c_i(Q_i) (1 + s_i) = \\sum_{i=1}^2 c_i(Q_i) + \\sum_{i=1}^2 c_i(Q_i) s_i\n$$\n其中 $s = (s_1, s_2)$ 是一个二元正态分布的随机向量，$s \\sim \\mathcal{N}(\\mu, \\Sigma)$。为简化符号，令 $c_i = c_i(Q_i)$。\n\n总成本 $C(Q)$ 是联合正态随机变量 $s_1$ 和 $s_2$ 的线性变换。多元正态分布的一个基本性质是其分量的任何线性组合也服从正态分布。因此，$C(Q)$ 服从正态分布，$C(Q) \\sim \\mathcal{N}(\\mu_C, \\sigma_C^2)$。\n\n$C(Q)$ 的均值为：\n$$\n\\mu_C = \\mathbb{E}[C(Q)] = \\mathbb{E}\\left[\\sum_{i=1}^2 c_i(1 + s_i)\\right] = \\sum_{i=1}^2 c_i(1 + \\mathbb{E}[s_i]) = \\sum_{i=1}^2 c_i(1 + \\mu_i)\n$$\n\n$C(Q)$ 的方差为：\n$$\n\\sigma_C^2 = \\mathrm{Var}[C(Q)] = \\mathrm{Var}\\left[\\sum_{i=1}^2 c_i + \\sum_{i=1}^2 c_i s_i\\right] = \\mathrm{Var}\\left[c_1 s_1 + c_2 s_2\\right]\n$$\n使用相关随机变量加权和的方差公式，$\\mathrm{Var}(aX+bY) = a^2\\mathrm{Var}(X) + b^2\\mathrm{Var}(Y) + 2ab\\mathrm{Cov}(X,Y)$：\n$$\n\\sigma_C^2 = c_1^2 \\mathrm{Var}(s_1) + c_2^2 \\mathrm{Var}(s_2) + 2c_1 c_2 \\mathrm{Cov}(s_1, s_2)\n$$\n给定 $\\mathrm{Var}(s_i) = \\sigma_i^2$ 和 $\\mathrm{Cov}(s_1, s_2) = \\rho \\sigma_1 \\sigma_2$，方差变为：\n$$\n\\sigma_C^2 = c_1^2 \\sigma_1^2 + c_2^2 \\sigma_2^2 + 2c_1 c_2 \\rho \\sigma_1 \\sigma_2\n$$\n这可以用矩阵形式紧凑地表示为 $\\sigma_C^2 = \\mathbf{c}^T \\Sigma \\mathbf{c}$，其中 $\\mathbf{c} = (c_1, c_2)^T$。\n\n当 $C(Q) \\sim \\mathcal{N}(\\mu_C, \\sigma_C^2)$ 时，我们对该变量进行标准化以转换机会约束。令 $Z = (C(Q) - \\mu_C) / \\sigma_C$，其中 $Z \\sim \\mathcal{N}(0,1)$。约束 $\\mathbb{P}(C(Q) \\le B) \\ge p$ 变为：\n$$\n\\mathbb{P}\\left(\\frac{C(Q) - \\mu_C}{\\sigma_C} \\le \\frac{B - \\mu_C}{\\sigma_C}\\right) \\ge p \\implies \\mathbb{P}\\left(Z \\le \\frac{B - \\mu_C}{\\sigma_C}\\right) \\ge p\n$$\n设 $\\Phi(\\cdot)$ 为标准正态分布的累积分布函数 (CDF)。该不等式等价于 $\\Phi\\left(\\frac{B - \\mu_C}{\\sigma_C}\\right) \\ge p$。对两边应用逆 CDF，即分位数函数 $\\Phi^{-1}(\\cdot)$，得到：\n$$\n\\frac{B - \\mu_C}{\\sigma_C} \\ge \\Phi^{-1}(p)\n$$\n整理后，我们得到机会约束的确定性等价形式：\n$$\n\\mu_C + \\Phi^{-1}(p) \\sigma_C \\le B\n$$\n代入 $\\mu_C$ 和 $\\sigma_C$ 的表达式：\n$$\n\\sum_{i=1}^2 c_i(Q_i)(1 + \\mu_i) + \\Phi^{-1}(p) \\sqrt{c_1(Q_1)^2 \\sigma_1^2 + c_2(Q_2)^2 \\sigma_2^2 + 2 c_1(Q_1) c_2(Q_2) \\rho \\sigma_1 \\sigma_2} \\le B\n$$\n对于 $p=0.95$，分位数为 $\\Phi^{-1}(0.95) \\approx 1.64485$。\n\n#### 优化问题构建\n\n任务是找到在问题约束条件下使确定性成本最小化的容量分配 $(Q_1, Q_2)$。这可以构建为两个独立的优化问题，每个成本假设对应一个。\n\n**目标函数**：最小化 $J(Q_1, Q_2) = c_1(Q_1) + c_2(Q_2)$。\n\n**约束条件**：\n1.  $Q_1 + Q_2 = M$\n2.  $Q_1 \\ge 0, Q_2 \\ge 0$\n3.  上面推导出的确定性等价约束。\n\n对于外生和内生情况，相应地代入成本函数 $c_i(Q_i)$。\n\n#### 求解算法\n\n给定约束 $Q_1+Q_2=M$ 以及 $\\Delta Q=1$ MW 离散网格搜索的要求，问题简化为对单个变量的搜索。我们可以表示为 $Q_2 = M - Q_1$，并在 $[0, M]$ 范围内搜索最优整数 $Q_1$。\n\n算法如下：\n1.  对每个测试用例和每种模型（外生和内生）：\n2.  将目前找到的最小成本初始化为无穷大，并将相应的最优分配 $(Q_1^*, Q_2^*)$ 初始化为 $(\\mathrm{nan}, \\mathrm{nan})$。\n3.  遍历从 $0$ 到 $M$ 的所有整数值 $Q_1$。对于每个 $Q_1$，设置 $Q_2 = M - Q_1$。\n4.  使用适当的成本函数（外生或内生）计算确定性成本 $c_1(Q_1)$ 和 $c_2(Q_2)$。\n5.  使用当前的 $c_1$ 和 $c_2$ 值评估确定性等价约束的左侧。\n6.  如果约束满足（即，值小于或等于 $B$），则分配 $(Q_1, Q_2)$ 是可行的。\n7.  对于此可行分配，计算总确定性成本 $J = c_1 + c_2$。\n8.  如果 $J$ 小于目前找到的最小成本，则将最小成本更新为 $J$，并将最优分配更新为 $(Q_1, Q_2)$。\n9.  遍历所有可能的 $Q_1$ 值后，存储的 $(Q_1^*, Q_2^*)$ 即为该模型的最优分配。如果没有找到可行分配，结果保持 $(\\mathrm{nan}, \\mathrm{nan})$。\n10. 对所有测试用例和两种模型重复此过程。收集并格式化最终结果。",
            "answer": "[[41.00,59.00,28.00,72.00],[nan,nan,48.00,32.00],[0.00,20.00,0.00,20.00]]"
        }
    ]
}