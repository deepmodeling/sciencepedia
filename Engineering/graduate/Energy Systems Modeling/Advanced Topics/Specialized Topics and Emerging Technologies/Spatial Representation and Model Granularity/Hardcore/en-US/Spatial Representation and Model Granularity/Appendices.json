{
    "hands_on_practices": [
        {
            "introduction": "Energy system models often face a trade-off between the high accuracy of nodal representations and the computational tractability of zonal aggregation. This exercise provides a concrete, hands-on demonstration of this trade-off within the context of a power transmission network. By implementing a DC power flow analysis, you will compute Power Transfer Distribution Factors (PTDFs) for both a detailed nodal model and an aggregated zonal model, allowing you to directly quantify the error that arises from reducing spatial granularity .",
            "id": "4124091",
            "problem": "You are given a connected direct-current (DC) approximation of a transmission network with $4$ buses and $5$ transmission lines. Under the DC approximation, bus voltage magnitudes are set to $1$ per unit, reactive power is neglected, and active power flows are linearly related to bus voltage angles through line susceptances. For each line $(i,j)$ with susceptance $b_{ij}$, the active power flow $f_{ij}$ is given by $f_{ij} = b_{ij} \\left( \\theta_i - \\theta_j \\right)$, where $\\theta_i$ is the voltage angle at bus $i$ in radians. Nodal power balance imposes $\\sum_j B_{ij} \\theta_j = P_i$, where $P_i$ is the net active power injection at bus $i$ in megawatts (MW) and $B$ is the bus susceptance matrix assembled from the line susceptances $b_{ij}$. Take bus $1$ as the slack (reference) bus with fixed angle $\\theta_1 = 0$ radians. All angles must be in radians and all active powers must be in megawatts (MW).\n\nNetwork specification:\n- Buses: $\\{1,2,3,4\\}$.\n- Lines (with fixed orientation and susceptance in $\\text{MW}/\\text{rad}$):\n  - Line $\\ell_1$: $(1 \\rightarrow 2)$, $b_{12} = 10$.\n  - Line $\\ell_2$: $(2 \\rightarrow 3)$, $b_{23} = 5$.\n  - Line $\\ell_3$: $(3 \\rightarrow 4)$, $b_{34} = 8$.\n  - Line $\\ell_4$: $(1 \\rightarrow 4)$, $b_{14} = 7$.\n  - Line $\\ell_5$: $(2 \\rightarrow 4)$, $b_{24} = 6$.\n\nZones and aggregation:\n- Define $2$ zones: Zone $\\mathcal{A} = \\{2,3\\}$ and Zone $\\mathcal{B} = \\{4\\}$. Bus $1$ is the slack and is not part of any zone.\n- The zonal aggregation uses fixed distribution keys within each zone: in Zone $\\mathcal{A}$, weights are $w_2 = 0.5$ and $w_3 = 0.5$; in Zone $\\mathcal{B}$, weight is $w_4 = 1.0$. These weights state that a net zonal injection $Z_{\\mathcal{A}}$ is internally distributed as $P_2 = 0.5 Z_{\\mathcal{A}}$ and $P_3 = 0.5 Z_{\\mathcal{A}}$, while a net zonal injection $Z_{\\mathcal{B}}$ is assigned entirely to bus $4$.\n\nTasks:\n1. Using only the DC approximation and network definitions above, construct the bus susceptance matrix $B$ and the reduced system for non-slack buses. Compute the nodal Power Transfer Distribution Factors (PTDFs) for lines $\\ell_1$ through $\\ell_5$ with respect to buses $\\{2,3,4\\}$ and slack $1$, defined as the sensitivity of line flows $f_{\\ell}$ in MW to a $+1$ MW injection at bus $n \\in \\{2,3,4\\}$ with a $-1$ MW withdrawal at the slack bus $1$.\n2. From the nodal PTDFs and the given zonal weights, compute the zonal PTDFs mapping net zonal injections $(Z_{\\mathcal{A}}, Z_{\\mathcal{B}})$ to line flows, under the aggregation rule described above.\n3. For each test case below, compute:\n   - The actual line flows (MW) using the nodal PTDFs and the specified bus-level injections at buses $\\{2,3,4\\}$, with the slack bus injection $P_1$ chosen to enforce $\\sum_{i=1}^4 P_i = 0$.\n   - The aggregated (approximate) line flows (MW) using the zonal PTDFs and the corresponding net zonal injections $Z_{\\mathcal{A}} = P_2 + P_3$ and $Z_{\\mathcal{B}} = P_4$.\n   - The maximum absolute aggregation error across the $5$ lines, defined as $\\max_{\\ell \\in \\{\\ell_1,\\dots,\\ell_5\\}} \\left| f_{\\ell}^{\\text{zonal}} - f_{\\ell}^{\\text{actual}} \\right|$, expressed in MW.\n\nTest suite (bus-level injections in MW at buses $\\{2,3,4\\}$; all angles in radians):\n- Case $1$: $(P_2, P_3, P_4) = (30, 30, -60)$.\n- Case $2$: $(P_2, P_3, P_4) = (60, 0, -60)$.\n- Case $3$: $(P_2, P_3, P_4) = (0, 0, 0)$.\n- Case $4$: $(P_2, P_3, P_4) = (100, -80, -20)$.\n\nYour program must:\n- Implement the required computations from first principles as described.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in MW, with one floating-point number per test case in the order above. For example, the output format must be exactly like $[r_1,r_2,r_3,r_4]$, where each $r_k$ is the maximum absolute aggregation error (MW) for Case $k$.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of a DC power flow analysis, a standard method in power systems engineering. It is well-posed, with sufficient information and clear objectives to lead to a unique, meaningful solution. The language is objective and the data are internally consistent.\n\nThe solution proceeds in three main steps as outlined in the problem:\n1.  Construction of the system matrices and computation of nodal Power Transfer Distribution Factors (PTDFs).\n2.  Computation of zonal PTDFs based on the specified aggregation scheme.\n3.  Calculation of actual and aggregated line flows for each test case to determine the maximum aggregation error.\n\n### Step 1: System Matrices and Nodal PTDF Computation\nThe DC power flow model relates net nodal power injections $P$ to bus voltage angles $\\theta$ via the bus susceptance matrix $B$:\n$$B \\theta = P$$\n\nFirst, we construct the $4 \\times 4$ bus susceptance matrix $B$ for the network. The diagonal elements $B_{ii}$ are the sum of susceptances of lines connected to bus $i$, and the off-diagonal elements $B_{ij}$ ($i \\neq j$) are the negative of the susceptance of the line between bus $i$ and bus $j$.\nGiven susceptances are $b_{12}=10$, $b_{23}=5$, $b_{34}=8$, $b_{14}=7$, and $b_{24}=6$.\n- $B_{11} = b_{12} + b_{14} = 10 + 7 = 17$\n- $B_{22} = b_{12} + b_{23} + b_{24} = 10 + 5 + 6 = 21$\n- $B_{33} = b_{23} + b_{34} = 5 + 8 = 13$\n- $B_{44} = b_{14} + b_{24} + b_{34} = 7 + 6 + 8 = 21$\n- $B_{12} = B_{21} = -b_{12} = -10$\n- $B_{23} = B_{32} = -b_{23} = -5$\n- $B_{34} = B_{43} = -b_{34} = -8$\n- $B_{14} = B_{41} = -b_{14} = -7$\n- $B_{24} = B_{42} = -b_{24} = -6$\n- $B_{13} = B_{31} = 0$\n\nThe full bus susceptance matrix is:\n$$B = \\begin{pmatrix} 17 & -10 & 0 & -7 \\\\ -10 & 21 & -5 & -6 \\\\ 0 & -5 & 13 & -8 \\\\ -7 & -6 & -8 & 21 \\end{pmatrix}$$\n\nBus $1$ is the slack bus, so its angle is fixed at $\\theta_1=0$. We can form a reduced system for the non-slack buses $\\{2, 3, 4\\}$. This involves removing the first row and column of $B$, giving the reduced matrix $B_{\\text{red}}$. The system for the unknown angles $\\theta_{\\text{red}} = [\\theta_2, \\theta_3, \\theta_4]^T$ is $B_{\\text{red}} \\theta_{\\text{red}} = P_{\\text{red}}$, where $P_{\\text{red}} = [P_2, P_3, P_4]^T$.\n$$B_{\\text{red}} = \\begin{pmatrix} 21 & -5 & -6 \\\\ -5 & 13 & -8 \\\\ -6 & -8 & 21 \\end{pmatrix}$$\nThe solution for the angles is $\\theta_{\\text{red}} = B_{\\text{red}}^{-1} P_{\\text{red}}$. Let $X = B_{\\text{red}}^{-1}$.\n\nThe active power flow $f_{ij}$ on a line $(i,j)$ is $f_{ij} = b_{ij}(\\theta_i - \\theta_j)$. We can express the vector of all $5$ line flows $f = [f_{12}, f_{23}, f_{34}, f_{14}, f_{24}]^T$ as a linear transformation of the non-slack angle vector $\\theta_{\\text{red}}$: $f = M \\theta_{\\text{red}}$.\n- $f_{12} = b_{12}(\\theta_1 - \\theta_2) = 10(0 - \\theta_2) = -10\\theta_2$\n- $f_{23} = b_{23}(\\theta_2 - \\theta_3) = 5\\theta_2 - 5\\theta_3$\n- $f_{34} = b_{34}(\\theta_3 - \\theta_4) = 8\\theta_3 - 8\\theta_4$\n- $f_{14} = b_{14}(\\theta_1 - \\theta_4) = 7(0 - \\theta_4) = -7\\theta_4$\n- $f_{24} = b_{24}(\\theta_2 - \\theta_4) = 6\\theta_2 - 6\\theta_4$\n\nThis defines the matrix $M$:\n$$M = \\begin{pmatrix} -10 & 0 & 0 \\\\ 5 & -5 & 0 \\\\ 0 & 8 & -8 \\\\ 0 & 0 & -7 \\\\ 6 & 0 & -6 \\end{pmatrix}$$\nSubstituting $\\theta_{\\text{red}} = X P_{\\text{red}}$, we find the relationship between line flows and nodal injections: $f = M X P_{\\text{red}}$. The nodal PTDF matrix is the matrix that multiplies $P_{\\text{red}}$ to give $f$.\n$$\\text{PTDF}_{\\text{nodal}} = M X = M B_{\\text{red}}^{-1}$$\n$\\text{PTDF}_{\\text{nodal}}$ is a $5 \\times 3$ matrix where the element $(\\ell, n)$ represents the change in flow on line $\\ell$ for a $1$ MW injection at non-slack bus $n$ (and a corresponding withdrawal at the slack bus).\n\n### Step 2: Zonal PTDF Computation\nThe problem defines two zones, $\\mathcal{A}=\\{2,3\\}$ and $\\mathcal{B}=\\{4\\}$, with net injections $Z_{\\mathcal{A}}$ and $Z_{\\mathcal{B}}$. The nodal injections are distributed from the zonal injections according to weights $w_2 = 0.5, w_3 = 0.5$ for Zone $\\mathcal{A}$ and $w_4=1.0$ for Zone $\\mathcal{B}$.\nThis defines a linear mapping from zonal injections $Z = [Z_{\\mathcal{A}}, Z_{\\mathcal{B}}]^T$ to nodal injections $P_{\\text{red}}$:\n$$P_{\\text{red}} = W Z \\quad \\text{where} \\quad W = \\begin{pmatrix} 0.5 & 0 \\\\ 0.5 & 0 \\\\ 0 & 1.0 \\end{pmatrix}$$\nThe line flows calculated using the zonal model, $f^{\\text{zonal}}$, are given by:\n$$f^{\\text{zonal}} = \\text{PTDF}_{\\text{nodal}} (W Z)$$\nThis can be rewritten as $f^{\\text{zonal}} = (\\text{PTDF}_{\\text{nodal}} W) Z$. The term in parentheses is the zonal PTDF matrix:\n$$\\text{PTDF}_{\\text{zonal}} = \\text{PTDF}_{\\text{nodal}} W$$\n$\\text{PTDF}_{\\text{zonal}}$ is a $5 \\times 2$ matrix mapping zonal injections to line flows.\n\n### Step 3: Aggregation Error Calculation\nFor each test case, we are given a set of nodal injections $(P_2, P_3, P_4)$.\nThe actual line flows, $f^{\\text{actual}}$, are calculated using the full nodal model:\n$$f^{\\text{actual}} = \\text{PTDF}_{\\text{nodal}} \\begin{pmatrix} P_2 \\\\ P_3 \\\\ P_4 \\end{pmatrix}$$\nThe aggregated (approximate) line flows, $f^{\\text{zonal}}$, are calculated using the zonal model. First, we find the net zonal injections: $Z_{\\mathcal{A}} = P_2 + P_3$ and $Z_{\\mathcal{B}} = P_4$.\n$$f^{\\text{zonal}} = \\text{PTDF}_{\\text{zonal}} \\begin{pmatrix} Z_{\\mathcal{A}} \\\\ Z_{\\mathcal{B}} \\end{pmatrix} = \\text{PTDF}_{\\text{zonal}} \\begin{pmatrix} P_2+P_3 \\\\ P_4 \\end{pmatrix}$$\nFinally, the aggregation error for each line is the difference $f_{\\ell}^{\\text{zonal}} - f_{\\ell}^{\\text{actual}}$. The problem asks for the maximum absolute aggregation error across all $5$ lines for each test case:\n$$\\text{Error} = \\max_{\\ell \\in \\{1,\\dots,5\\}} \\left| f_{\\ell}^{\\text{zonal}} - f_{\\ell}^{\\text{actual}} \\right|$$\nThis procedure is repeated for all four test cases. The error arises from the difference between the actual nodal injection pattern $[P_2, P_3]^T$ within Zone $\\mathcal{A}$ and the pattern assumed by the aggregation weights, $[0.5(P_2+P_3), 0.5(P_2+P_3)]^T$. The error is zero if the actual injections $P_2, P_3$ are equal, as they perfectly match the $50\\%$-$50\\%$ split.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the power system aggregation error problem.\n\n    The solution follows these steps:\n    1. Define the network parameters (susceptances).\n    2. Construct the reduced bus susceptance matrix (B_red) for non-slack buses.\n    3. Compute its inverse (X), which relates nodal injections to bus angles.\n    4. Construct the matrix M, which maps non-slack bus angles to line flows.\n    5. Compute the nodal PTDF matrix: PTDF_nodal = M @ X.\n    6. Define the zonal aggregation weight matrix W.\n    7. Compute the zonal PTDF matrix: PTDF_zonal = PTDF_nodal @ W.\n    8. For each test case:\n        a. Calculate actual line flows using nodal PTDFs and nodal injections.\n        b. Calculate aggregated line flows using zonal PTDFs and zonal injections.\n        c. Compute the maximum absolute difference between the two flow vectors.\n    9. Format and print the results.\n    \"\"\"\n\n    # --- Step 1  2: Construct system matrices ---\n    # Reduced bus susceptance matrix B_red for buses {2, 3, 4}\n    # B_22 = 10 + 5 + 6 = 21\n    # B_33 = 5 + 8 = 13\n    # B_44 = 7 + 8 + 6 = 21\n    # B_23 = -5, B_24 = -6, B_34 = -8\n    B_red = np.array([\n        [21., -5., -6.],\n        [-5., 13., -8.],\n        [-6., -8., 21.]\n    ])\n\n    # --- Step 3: Compute inverse of B_red ---\n    # X = B_red^{-1}\n    X = np.linalg.inv(B_red)\n\n    # --- Step 4: Construct line flow mapping matrix M ---\n    # f = M * [theta_2, theta_3, theta_4]^T\n    # Lines are l1:(1->2), l2:(2->3), l3:(3->4), l4:(1->4), l5:(2->4)\n    # Susceptances b12=10, b23=5, b34=8, b14=7, b24=6\n    # f12 = 10(t1 - t2) = -10*t2 since t1=0\n    # f23 = 5(t2 - t3)\n    # f34 = 8(t3 - t4)\n    # f14 = 7(t1 - t4) = -7*t4\n    # f24 = 6(t2 - t4)\n    M = np.array([\n        [-10.,  0.,  0.],\n        [  5., -5.,  0.],\n        [  0.,  8., -8.],\n        [  0.,  0., -7.],\n        [  6.,  0., -6.]\n    ])\n\n    # --- Step 5: Compute nodal PTDF matrix ---\n    PTDF_nodal = M @ X\n\n    # --- Step 6: Define zonal aggregation matrix W ---\n    # P_red = W * Z\n    # P2 = 0.5*ZA, P3 = 0.5*ZA, P4 = 1.0*ZB\n    W = np.array([\n        [0.5, 0.0],\n        [0.5, 0.0],\n        [0.0, 1.0]\n    ])\n\n    # --- Step 7: Compute zonal PTDF matrix ---\n    PTDF_zonal = PTDF_nodal @ W\n\n    # --- Step 8: Process test cases ---\n    test_cases = [\n        (30., 30., -60.),\n        (60., 0., -60.),\n        (0., 0., 0.),\n        (100., -80., -20.),\n    ]\n\n    results = []\n    for case in test_cases:\n        P2, P3, P4 = case\n        \n        # Nodal (actual) model\n        P_red = np.array([P2, P3, P4])\n        f_actual = PTDF_nodal @ P_red\n\n        # Zonal (aggregated) model\n        Z_A = P2 + P3\n        Z_B = P4\n        Z = np.array([Z_A, Z_B])\n        f_zonal = PTDF_zonal @ Z\n        \n        # Calculate maximum absolute aggregation error\n        max_error = np.max(np.abs(f_zonal - f_actual))\n        results.append(max_error)\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond discrete networks, energy models must often represent continuous spatial fields like solar irradiance or wind speed, raising the question of how to determine an adequate sampling density. This practice moves from engineering approximations to the realm of spatial statistics to provide a rigorous answer. You will model a spatially varying resource as a Gaussian Process and use its statistical properties, specifically its correlation length $L$, to calculate the minimum number of sensors required to keep interpolation error below a given threshold .",
            "id": "4124062",
            "problem": "Consider a straight coastal distribution feeder of length $D = 40\\,\\mathrm{km}$ hosting distributed photovoltaic inverters. To support spatially granular energy systems modeling, the operator seeks to instrument the feeder with a uniform array of fixed sensors that measure the deviation $X(x)$ of ground-level solar irradiance from its daily-mean profile along the one-dimensional coordinate $x \\in [0, D]$. Assume $X(x)$ is a zero-mean, wide-sense stationary Gaussian process (Gaussian Process (GP)) with isotropic covariance function\n$$\nC(h) = \\sigma^{2} \\exp\\!\\left(-\\frac{h^{2}}{2 L^{2}}\\right),\n$$\nwhere $h$ is separation distance, $\\sigma = 0.20\\,\\mathrm{kW\\,m^{-2}}$ is the standard deviation of irradiance deviations, and $L = 3.0\\,\\mathrm{km}$ is the correlation length. The operator uses optimal linear minimum mean square estimation (Linear Minimum Mean Square Error (LMMSE)) to interpolate $X(x)$ between sensors.\n\nAssume $N$ sensors are placed uniformly along $[0,D]$, boundary effects are negligible relative to $L$, and the interpolation error is maximized at midpoints between adjacent sensors. Starting from the properties of zero-mean stationary Gaussian processes and the definition of LMMSE interpolation from finitely many point sensors, derive the expression for the interpolation mean squared error at the midpoint between two adjacent sensors as a function of the uniform spacing $s$. Using this, evaluate the spatial sampling density (i.e., the maximal spacing $s_{\\max}$) that ensures the midpoint interpolation root-mean-squared error does not exceed a target bound $\\varepsilon = 0.050\\,\\mathrm{kW\\,m^{-2}}$. Finally, compute the minimal integer number of sensors $N$ required on $[0, D]$ to ensure $s \\leq s_{\\max}$ throughout.\n\nReport only the minimal integer $N$ as your final answer. If you perform any intermediate numerical calculations such as $s_{\\max}$, express them in $\\mathrm{km}$.",
            "solution": "The problem is to determine the minimum number of sensors, $N$, required to monitor a physical process $X(x)$ over a spatial domain $[0, D]$ such that the interpolation error remains below a specified threshold. The problem is scientifically grounded, well-posed, and contains all necessary information for a unique solution.\n\nThe process $X(x)$ is a zero-mean, wide-sense stationary Gaussian process with a given isotropic covariance function:\n$$\nC(h) = \\mathbb{E}[X(x)X(x+h)] = \\sigma^{2} \\exp\\left(-\\frac{h^{2}}{2 L^{2}}\\right)\n$$\nwhere $h$ is the separation distance, $\\sigma = 0.20\\,\\mathrm{kW\\,m^{-2}}$ is the standard deviation, and $L = 3.0\\,\\mathrm{km}$ is the correlation length. The total length of the feeder is $D = 40\\,\\mathrm{km}$.\n\nThe estimation method is optimal linear minimum mean square estimation (LMMSE). For a zero-mean Gaussian process, the LMMSE estimate of $X(x_0)$ given a set of measurements $\\mathbf{X}_s = [X(x_1), \\dots, X(x_k)]^T$ is the conditional mean $\\hat{X}(x_0) = \\mathbb{E}[X(x_0) | \\mathbf{X}_s]$. The corresponding mean squared error (MSE) is the conditional variance, $\\text{MSE} = \\text{Var}(X(x_0) | \\mathbf{X}_s)$.\n\nThe problem specifies uniform sensor spacing, $s$, and assumes negligible boundary effects and that the maximum interpolation error occurs at the midpoints between adjacent sensors. This allows us to analyze the error by considering only the two sensors bracketing the midpoint. Let the midpoint be at coordinate $0$, and the two adjacent sensors be at coordinates $-\\frac{s}{2}$ and $+\\frac{s}{2}$.\n\nLet $X_0 = X(0)$ be the random variable to be estimated. Let the measurements be from the two sensors, $\\mathbf{X}_s = [X(-s/2), X(s/2)]^T$. The MSE of the LMMSE estimate is given by the standard formula for the conditional variance of a multivariate Gaussian distribution:\n$$\n\\text{MSE}(s) = \\text{Var}(X_0) - \\mathbf{c}_s^T \\mathbf{C}_{ss}^{-1} \\mathbf{c}_s\n$$\nwhere:\n- $\\text{Var}(X_0) = C(0) = \\sigma^2$ is the prior variance of the process.\n- $\\mathbf{C}_{ss}$ is the covariance matrix of the measurements:\n$$\n\\mathbf{C}_{ss} = \\begin{pmatrix} \\text{Cov}(X(-\\frac{s}{2}), X(-\\frac{s}{2}))  \\text{Cov}(X(-\\frac{s}{2}), X(+\\frac{s}{2})) \\\\ \\text{Cov}(X(+\\frac{s}{2}), X(-\\frac{s}{2}))  \\text{Cov}(X(+\\frac{s}{2}), X(+\\frac{s}{2})) \\end{pmatrix} = \\begin{pmatrix} C(0)  C(s) \\\\ C(s)  C(0) \\end{pmatrix}\n$$\n- $\\mathbf{c}_s$ is the vector of covariances between the estimation point and the measurement points:\n$$\n\\mathbf{c}_s = \\begin{pmatrix} \\text{Cov}(X(0), X(-\\frac{s}{2})) \\\\ \\text{Cov}(X(0), X(+\\frac{s}{2})) \\end{pmatrix} = \\begin{pmatrix} C(\\frac{s}{2}) \\\\ C(\\frac{s}{2}) \\end{pmatrix}\n$$\nSubstituting the covariance function, we have:\n$C(0) = \\sigma^2$\n$C(s) = \\sigma^2 \\exp\\left(-\\frac{s^2}{2L^2}\\right)$\n$C(\\frac{s}{2}) = \\sigma^2 \\exp\\left(-\\frac{(s/2)^2}{2L^2}\\right) = \\sigma^2 \\exp\\left(-\\frac{s^2}{8L^2}\\right)$\n\nThe covariance matrix $\\mathbf{C}_{ss}$ is:\n$$\n\\mathbf{C}_{ss} = \\sigma^2 \\begin{pmatrix} 1  \\exp\\left(-\\frac{s^2}{2L^2}\\right) \\\\ \\exp\\left(-\\frac{s^2}{2L^2}\\right)  1 \\end{pmatrix}\n$$\nIts inverse is:\n$$\n\\mathbf{C}_{ss}^{-1} = \\frac{1}{\\sigma^2 \\left(1 - \\exp\\left(-\\frac{s^2}{L^2}\\right)\\right)} \\begin{pmatrix} 1  -\\exp\\left(-\\frac{s^2}{2L^2}\\right) \\\\ -\\exp\\left(-\\frac{s^2}{2L^2}\\right)  1 \\end{pmatrix}\n$$\nNow, we compute the term $\\mathbf{c}_s^T \\mathbf{C}_{ss}^{-1} \\mathbf{c}_s$:\n$$\n\\mathbf{c}_s^T \\mathbf{C}_{ss}^{-1} \\mathbf{c}_s = \\left(\\sigma^2 \\exp\\left(-\\frac{s^2}{8L^2}\\right) \\begin{pmatrix} 1  1 \\end{pmatrix}\\right) \\mathbf{C}_{ss}^{-1} \\left(\\sigma^2 \\exp\\left(-\\frac{s^2}{8L^2}\\right) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\\right)\n$$\n$$\n= \\frac{\\sigma^2 \\exp\\left(-\\frac{s^2}{4L^2}\\right)}{1 - \\exp\\left(-\\frac{s^2}{L^2}\\right)} \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1  -\\exp\\left(-\\frac{s^2}{2L^2}\\right) \\\\ -\\exp\\left(-\\fracs^2}{2L^2}\\right)  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n$$\n= \\frac{\\sigma^2 \\exp\\left(-\\frac{s^2}{4L^2}\\right)}{1 - \\exp\\left(-\\frac{s^2}{L^2}\\right)} \\begin{pmatrix} 1-\\exp\\left(-\\frac{s^2}{2L^2}\\right)  1-\\exp\\left(-\\frac{s^2}{2L^2}\\right) \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n$$\n= \\frac{\\sigma^2 \\exp\\left(-\\frac{s^2}{4L^2}\\right) \\left[2\\left(1-\\exp\\left(-\\frac{s^2}{2L^2}\\right)\\right)\\right]}{\\left(1-\\exp\\left(-\\frac{s^2}{2L^2}\\right)\\right)\\left(1+\\exp\\left(-\\frac{s^2}{2L^2}\\right)\\right)} = \\frac{2\\sigma^2 \\exp\\left(-\\frac{s^2}{4L^2}\\right)}{1+\\exp\\left(-\\frac{s^2}{2L^2}\\right)}\n$$\nThe MSE at the midpoint is therefore:\n$$\n\\text{MSE}(s) = \\sigma^2 - \\frac{2\\sigma^2 \\exp\\left(-\\frac{s^2}{4L^2}\\right)}{1+\\exp\\left(-\\frac{s^2}{2L^2}\\right)} = \\sigma^2 \\left(1 - \\frac{2 \\exp\\left(-\\frac{s^2}{4L^2}\\right)}{1+\\exp\\left(-\\frac{s^2}{2L^2}\\right)}\\right)\n$$\nThis expression gives the midpoint interpolation MSE as a function of sensor spacing $s$.\n\nNext, we must find the maximum spacing $s_{\\max}$ that ensures the root-mean-squared error (RMSE) does not exceed $\\varepsilon = 0.050\\,\\mathrm{kW\\,m^{-2}}$. The condition is $\\text{RMSE}(s) \\le \\varepsilon$, or $\\text{MSE}(s) \\le \\varepsilon^2$.\n$$\n\\sigma^2 \\left(1 - \\frac{2 \\exp\\left(-\\frac{s^2}{4L^2}\\right)}{1+\\exp\\left(-\\frac{s^2}{2L^2}\\right)}\\right) \\le \\varepsilon^2\n$$\n$$\n1 - \\frac{\\varepsilon^2}{\\sigma^2} \\le \\frac{2 \\exp\\left(-\\frac{s^2}{4L^2}\\right)}{1+\\exp\\left(-\\frac{s^2}{2L^2}\\right)}\n$$\nLet $y = \\exp\\left(-\\frac{s^2}{4L^2}\\right)$. Then $\\exp\\left(-\\frac{s^2}{2L^2}\\right) = y^2$. The inequality becomes:\n$$\n1 - \\frac{\\varepsilon^2}{\\sigma^2} \\le \\frac{2y}{1+y^2}\n$$\nGiven $\\sigma = 0.20$ and $\\varepsilon = 0.050$, we have $\\frac{\\varepsilon^2}{\\sigma^2} = (\\frac{0.050}{0.20})^2 = (\\frac{1}{4})^2 = \\frac{1}{16}$.\n$$\n1 - \\frac{1}{16} \\le \\frac{2y}{1+y^2} \\implies \\frac{15}{16} \\le \\frac{2y}{1+y^2}\n$$\n$$\n15(1+y^2) \\le 32y \\implies 15y^2 - 32y + 15 \\le 0\n$$\nTo find the region where this quadratic is non-positive, we find its roots:\n$$\ny = \\frac{32 \\pm \\sqrt{32^2 - 4(15)(15)}}{2(15)} = \\frac{32 \\pm \\sqrt{1024 - 900}}{30} = \\frac{32 \\pm \\sqrt{124}}{30} = \\frac{16 \\pm \\sqrt{31}}{15}\n$$\nThe quadratic is non-positive between its roots. Since $y = \\exp(-s^2/(4L^2))$, we know $0  y \\le 1$. The larger root is $\\frac{16+\\sqrt{31}}{15}  1$, so the only relevant part of the solution is:\n$$\n\\frac{16 - \\sqrt{31}}{15} \\le y \\le 1\n$$\nThe constraint on $s$ comes from the lower bound on $y$:\n$$\n\\exp\\left(-\\frac{s^2}{4L^2}\\right) \\ge \\frac{16 - \\sqrt{31}}{15}\n$$\nTaking the natural logarithm of both sides (and reversing the inequality sign because $\\ln$ is an increasing function and the argument of exp is negative):\n$$\n-\\frac{s^2}{4L^2} \\ge \\ln\\left(\\frac{16 - \\sqrt{31}}{15}\\right) \\implies s^2 \\le -4L^2 \\ln\\left(\\frac{16 - \\sqrt{31}}{15}\\right)\n$$\n$$\ns^2 \\le 4L^2 \\ln\\left(\\left(\\frac{16 - \\sqrt{31}}{15}\\right)^{-1}\\right) = 4L^2 \\ln\\left(\\frac{15}{16 - \\sqrt{31}}\\right)\n$$\nThe maximum allowed spacing $s_{\\max}$ is thus:\n$$\ns_{\\max} = 2L \\sqrt{\\ln\\left(\\frac{15}{16 - \\sqrt{31}}\\right)}\n$$\nSubstituting $L = 3.0\\,\\mathrm{km}$:\n$$\ns_{\\max} = 2(3.0) \\sqrt{\\ln\\left(\\frac{15}{16 - \\sqrt{31}}\\right)} \\approx 6 \\sqrt{\\ln\\left(\\frac{15}{16 - 5.56776}\\right)} \\approx 6 \\sqrt{\\ln(1.43783)} \\approx 6 \\sqrt{0.36316} \\approx 3.6158\\,\\mathrm{km}\n$$\nFinally, we compute the minimum number of sensors $N$. With $N$ sensors placed uniformly over a distance $D$, including sensors at the endpoints $x=0$ and $x=D$, there are $N-1$ intervals. The spacing is $s = \\frac{D}{N-1}$. To meet the error specification, we must have $s \\le s_{\\max}$.\n$$\n\\frac{D}{N-1} \\le s_{\\max} \\implies N-1 \\ge \\frac{D}{s_{\\max}} \\implies N \\ge \\frac{D}{s_{\\max}} + 1\n$$\nUsing the values $D = 40\\,\\mathrm{km}$ and $s_{\\max} \\approx 3.6158\\,\\mathrm{km}$:\n$$\nN \\ge \\frac{40}{3.6158} + 1 \\approx 11.0626 + 1 = 12.0626\n$$\nSince $N$ must be an integer, the minimal number of sensors required is the smallest integer greater than or equal to $12.0626$, which is $13$.",
            "answer": "$$\n\\boxed{13}\n$$"
        },
        {
            "introduction": "The act of aggregation is not neutral; the way in which spatial units are defined can profoundly influence model outcomes, a phenomenon known as the Modifiable Areal Unit Problem (MAUP). This exercise constructs a compelling scenario where this theoretical problem has major practical consequences for energy infrastructure planning. You will analyze two different, yet equally plausible, zoning schemes for the same underlying energy system and discover how the choice of boundaries alone can completely reverse a multi-million-dollar transmission investment decision .",
            "id": "4124078",
            "problem": "Consider a synthetic energy system with four nodes and a single interzonal transmission interface. Each node $i \\in \\{1,2,3,4\\}$ has a fixed demand $D_i$ in megawatts (MW), a single generator with maximum capacity $\\overline{G}_i$ in MW, and a constant marginal cost $c_i$ in dollars per megawatt-hour ($/MWh$). The system is operated under least-cost dispatch and a transmission planning rule that evaluates whether reinforcement of the interzonal interface is recommended. The system must satisfy energy balance, meaning total generation equals total demand.\n\nThe fundamental base is as follows:\n- Energy balance: $$\\sum_{i=1}^{4} g_i = \\sum_{i=1}^{4} D_i,$$ where $g_i$ is the dispatched generation at node $i$ in MW.\n- Operational feasibility: $$0 \\le g_i \\le \\overline{G}_i \\quad \\text{for all } i.$$\n- Cost minimization: The least-cost dispatch minimizes $$\\sum_{i=1}^{4} c_i g_i$$ subject to the constraints above, and assumes that interzonal transmission capacity does not bind for the purpose of computing the unconstrained least-cost dispatch.\n\nDefine two zoning schemes that partition the four nodes into two zones each, thereby inducing different interzonal interfaces:\n- Zoning scheme $\\mathcal{Z}_A$: West zone $W_A = \\{1,2\\}$ and East zone $E_A = \\{3,4\\}$.\n- Zoning scheme $\\mathcal{Z}_B$: West zone $W_B = \\{1,3\\}$ and East zone $E_B = \\{2,4\\}$.\n\nThe interzonal interface has a capacity $K$ in MW. Under a given zoning scheme $\\mathcal{Z}$, let $G_Z$ denote the total generation in the West zone and $D_Z$ the total demand in the West zone. The required interzonal transfer magnitude $T_{\\mathcal{Z}}$ in MW under unconstrained least-cost dispatch is:\n$$T_{\\mathcal{Z}} = \\left|D_Z - G_Z\\right|.$$\nThis quantity represents the absolute net import of the West zone (equivalently, the absolute net export if $G_Z  D_Z$), and because there are exactly two zones, it equals the magnitude of the corresponding import/export across the interzonal interface.\n\nPlanning rule: Transmission reinforcement is recommended under zoning scheme $\\mathcal{Z}$ if the unconstrained least-cost required interzonal transfer $T_{\\mathcal{Z}}$ strictly exceeds the existing capacity $K$, that is, if $$T_{\\mathcal{Z}}  K.$$\n\nModifiable Areal Unit Problem (MAUP) instability metric: For a pair of zoning schemes $(\\mathcal{Z}_A,\\mathcal{Z}_B)$ and a given capacity $K$, define the binary decision under each scheme as\n$$d_{\\mathcal{Z}} = \\begin{cases}\n1  \\text{if } T_{\\mathcal{Z}}  K,\\\\\n0  \\text{if } T_{\\mathcal{Z}} \\le K.\n\\end{cases}$$\nDefine the MAUP-induced decision instability indicator\n$$I = |d_{\\mathcal{Z}_A} - d_{\\mathcal{Z}_B}|,$$\nand the normalized transfer difference (a dimensionless decimal number)\n$$R = \\frac{\\left|T_{\\mathcal{Z}_A} - T_{\\mathcal{Z}_B}\\right|}{K},$$\nwhere $K  0$ is required. The quantity $I$ is $1$ if the two zoning schemes yield opposite conclusions about the need for reinforcement, and $0$ otherwise; $R$ captures the relative magnitude difference in required interzonal transfers normalized by capacity and must be expressed as a decimal number, not a percentage.\n\nSynthetic system data:\n- Demands: $D_1 = 10$ MW, $D_2 = 10$ MW, $D_3 = 30$ MW, $D_4 = 30$ MW.\n- Generator maximum capacities: $\\overline{G}_1 = 60$ MW, $\\overline{G}_2 = 20$ MW, $\\overline{G}_3 = 40$ MW, $\\overline{G}_4 = 40$ MW.\n- Marginal costs: $c_1 = 20$ $/MWh, $c_2 = 30$ $/MWh, $c_3 = 100$ $/MWh, $c_4 = 120$ $/MWh.\n\nYou must compute the unconstrained least-cost dispatch $g_i$ that satisfies the energy balance and capacity constraints, then compute $T_{\\mathcal{Z}_A}$ and $T_{\\mathcal{Z}_B}$, and finally compute $I$ and $R$ for each test case.\n\nTest suite:\n- Case $1$: $K = 50$ MW (a case designed to yield opposite conclusions).\n- Case $2$: $K = 60$ MW (a boundary case where required transfer equals capacity under one scheme).\n- Case $3$: $K = 10$ MW (a case where both schemes recommend reinforcement).\n- Case $4$: $K = 80$ MW (a case where neither scheme recommends reinforcement).\n\nPhysical units: All power quantities ($D_i$, $g_i$, $\\overline{G}_i$, $T_{\\mathcal{Z}}$, $K$) must be treated and computed in megawatts (MW). All costs are in dollars per megawatt-hour ($/MWh$). Angles are not used. Normalized transfer differences $R$ must be expressed as decimal numbers without a percentage sign.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a two-element list $[I,R]$. For example, the output format must be:\n$$\\left[ [I_1,R_1],[I_2,R_2],[I_3,R_3],[I_4,R_4] \\right]$$\nwith numeric values replacing the symbols.",
            "solution": "The problem statement has been evaluated and is determined to be **valid**. It is scientifically grounded in the principles of energy system economics (least-cost dispatch), well-posed with a unique and derivable solution, and is stated objectively with all necessary data provided. The problem is a formalizable exploration of the Modifiable Areal Unit Problem (MAUP) in the context of transmission planning.\n\nThe solution proceeds in three primary steps:\n1.  Determination of the unconstrained least-cost dispatch.\n2.  Calculation of the required interzonal transfers for each zoning scheme.\n3.  Evaluation of the instability metrics for each test case.\n\n### Step 1: Unconstrained Least-Cost Dispatch\n\nThe objective is to minimize the total generation cost, $\\sum_{i=1}^{4} c_i g_i$, subject to energy balance and generator capacity constraints. This is achieved by dispatching generators in ascending order of their marginal cost ($c_i$), a principle known as merit-order dispatch, until the total demand is met.\n\nThe system parameters are:\n- Demands: $D_1 = 10$ MW, $D_2 = 10$ MW, $D_3 = 30$ MW, $D_4 = 30$ MW.\n- Generator capacities: $\\overline{G}_1 = 60$ MW, $\\overline{G}_2 = 20$ MW, $\\overline{G}_3 = 40$ MW, $\\overline{G}_4 = 40$ MW.\n- Marginal costs: $c_1 = 20$ $/MWh, $c_2 = 30$ $/MWh, $c_3 = 100$ $/MWh, $c_4 = 120$ $/MWh.\n\nFirst, we calculate the total system demand:\n$$D_{\\text{total}} = \\sum_{i=1}^{4} D_i = 10 + 10 + 30 + 30 = 80 \\text{ MW}$$\n\nThe total available generation capacity is $\\sum \\overline{G}_i = 60+20+40+40 = 160$ MW, which exceeds the total demand, ensuring a feasible solution exists.\n\nThe merit order of the generators, from cheapest to most expensive, is:\n1.  Generator $1$ ($c_1 = 20$ $/MWh)\n2.  Generator $2$ ($c_2 = 30$ $/MWh)\n3.  Generator $3$ ($c_3 = 100$ $/MWh)\n4.  Generator $4$ ($c_4 = 120$ $/MWh)\n\nWe dispatch generators sequentially to meet the $80$ MW demand:\n- Dispatch Generator $1$: Its capacity is $\\overline{G}_1 = 60$ MW. We dispatch it fully.\n  - $g_1 = 60$ MW.\n  - Demand remaining: $80 - 60 = 20$ MW.\n- Dispatch Generator $2$: Its capacity is $\\overline{G}_2 = 20$ MW. We use its full capacity to meet the remaining demand.\n  - $g_2 = 20$ MW.\n  - Demand remaining: $20 - 20 = 0$ MW.\n- The total demand is now met. Generators $3$ and $4$ are not needed.\n  - $g_3 = 0$ MW.\n  - $g_4 = 0$ MW.\n\nThe unconstrained least-cost dispatch vector is $g = (g_1, g_2, g_3, g_4) = (60, 20, 0, 0)$ MW.\n\n### Step 2: Calculation of Interzonal Transfers\n\nUsing the dispatch results from Step 1, we calculate the required interzonal transfer $T_{\\mathcal{Z}} = |D_Z - G_Z|$ for each zoning scheme, where $Z$ represents the respective West zone.\n\n**Zoning Scheme $\\mathcal{Z}_A$**:\n- West zone $W_A = \\{1,2\\}$, East zone $E_A = \\{3,4\\}$.\n- Demand in West zone: $D_{W_A} = D_1 + D_2 = 10 + 10 = 20$ MW.\n- Generation in West zone: $G_{W_A} = g_1 + g_2 = 60 + 20 = 80$ MW.\n- Required transfer: $T_{\\mathcal{Z}_A} = |D_{W_A} - G_{W_A}| = |20 - 80| = 60$ MW.\n\n**Zoning Scheme $\\mathcal{Z}_B$**:\n- West zone $W_B = \\{1,3\\}$, East zone $E_B = \\{2,4\\}$.\n- Demand in West zone: $D_{W_B} = D_1 + D_3 = 10 + 30 = 40$ MW.\n- Generation in West zone: $G_{W_B} = g_1 + g_3 = 60 + 0 = 60$ MW.\n- Required transfer: $T_{\\mathcal{Z}_B} = |D_{W_B} - G_{W_B}| = |40 - 60| = 20$ MW.\n\n### Step 3: Evaluation of Test Cases\n\nWe now evaluate the instability indicator $I = |d_{\\mathcal{Z}_A} - d_{\\mathcal{Z}_B}|$ and the normalized transfer difference $R = \\frac{|T_{\\mathcal{Z}_A} - T_{\\mathcal{Z}_B}|}{K}$ for each provided capacity $K$. The decision variable $d_{\\mathcal{Z}}$ is $1$ if $T_{\\mathcal{Z}}  K$ and $0$ otherwise. The absolute difference in transfers is a constant for all cases: $|T_{\\mathcal{Z}_A} - T_{\\mathcal{Z}_B}| = |60 - 20| = 40$ MW.\n\n**Case 1: $K = 50$ MW**\n- $d_{\\mathcal{Z}_A}$: $T_{\\mathcal{Z}_A} = 60  50$, so $d_{\\mathcal{Z}_A} = 1$.\n- $d_{\\mathcal{Z}_B}$: $T_{\\mathcal{Z}_B} = 20 \\le 50$, so $d_{\\mathcal{Z}_B} = 0$.\n- $I_1 = |1 - 0| = 1$.\n- $R_1 = \\frac{40}{50} = 0.8$.\n- Result: $[1, 0.8]$.\n\n**Case 2: $K = 60$ MW**\n- $d_{\\mathcal{Z}_A}$: $T_{\\mathcal{Z}_A} = 60 \\ngtr 60$ (the condition is strict inequality), so $d_{\\mathcal{Z}_A} = 0$.\n- $d_{\\mathcal{Z}_B}$: $T_{\\mathcal{Z}_B} = 20 \\le 60$, so $d_{\\mathcal{Z}_B} = 0$.\n- $I_2 = |0 - 0| = 0$.\n- $R_2 = \\frac{40}{60} = \\frac{2}{3} \\approx 0.666...$.\n- Result: $[0, 0.666...]$.\n\n**Case 3: $K = 10$ MW**\n- $d_{\\mathcal{Z}_A}$: $T_{\\mathcal{Z}_A} = 60  10$, so $d_{\\mathcal{Z}_A} = 1$.\n- $d_{\\mathcal{Z}_B}$: $T_{\\mathcal{Z}_B} = 20  10$, so $d_{\\mathcal{Z}_B} = 1$.\n- $I_3 = |1 - 1| = 0$.\n- $R_3 = \\frac{40}{10} = 4.0$.\n- Result: $[0, 4.0]$.\n\n**Case 4: $K = 80$ MW**\n- $d_{\\mathcal{Z}_A}$: $T_{\\mathcal{Z}_A} = 60 \\le 80$, so $d_{\\mathcal{Z}_A} = 0$.\n- $d_{\\mathcal{Z}_B}$: $T_{\\mathcal{Z}_B} = 20 \\le 80$, so $d_{\\mathcal{Z}_B} = 0$.\n- $I_4 = |0 - 0| = 0$.\n- $R_4 = \\frac{40}{80} = 0.5$.\n- Result: $[0, 0.5]$.\n\nThe final compiled results for the four test cases are $[[1, 0.8], [0, 0.666...], [0, 4.0], [0, 0.5]]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the energy system modeling problem presented, calculating MAUP instability metrics.\n    \"\"\"\n    # Define the system data from the problem statement.\n    # Demands (MW)\n    demands = np.array([10.0, 10.0, 30.0, 30.0])\n    # Generator max capacities (MW)\n    gen_caps = np.array([60.0, 20.0, 40.0, 40.0])\n    # Marginal costs ($/MWh)\n    gen_costs = np.array([20.0, 30.0, 100.0, 120.0])\n    # Node indices\n    nodes = np.arange(len(demands))\n    \n    # Define the test cases for transmission capacity K (MW).\n    test_cases = [50.0, 60.0, 10.0, 80.0]\n\n    # Step 1: Calculate the unconstrained least-cost dispatch.\n    # This follows the principle of merit-order dispatch.\n    total_demand = np.sum(demands)\n    \n    # Combine generator properties and sort by cost in ascending order.\n    # Each element is (cost, capacity, original_index)\n    generators_sorted = sorted(zip(gen_costs, gen_caps, nodes), key=lambda x: x[0])\n    \n    # Initialize dispatched generation for each node to zero.\n    dispatched_generation = np.zeros(len(demands))\n    demand_to_meet = total_demand\n    \n    for cost, capacity, index in generators_sorted:\n        if demand_to_meet = 0:\n            break\n        # Dispatch the cheaper generator up to its capacity or until demand is met.\n        dispatch_amount = min(demand_to_meet, capacity)\n        dispatched_generation[index] = dispatch_amount\n        demand_to_meet -= dispatch_amount\n\n    # Step 2: Calculate the required interzonal transfers for each zoning scheme.\n    # Zoning scheme Z_A: West zone W_A = {1,2} (indices 0, 1)\n    D_WA = demands[0] + demands[1]\n    G_WA = dispatched_generation[0] + dispatched_generation[1]\n    T_zA = abs(D_WA - G_WA)\n\n    # Zoning scheme Z_B: West zone W_B = {1,3} (indices 0, 2)\n    D_WB = demands[0] + demands[2]\n    G_WB = dispatched_generation[0] + dispatched_generation[2]\n    T_zB = abs(D_WB - G_WB)\n\n    # Step 3: Evaluate MAUP metrics for each test case.\n    results = []\n    for k_capacity in test_cases:\n        # Determine the binary decision for each scheme. Reinforcement is\n        # recommended if the required transfer strictly exceeds capacity K.\n        d_zA = 1 if T_zA > k_capacity else 0\n        d_zB = 1 if T_zB > k_capacity else 0\n        \n        # Calculate MAUP-induced decision instability indicator I.\n        I = abs(d_zA - d_zB)\n        \n        # Calculate normalized transfer difference R.\n        # This is guaranteed to be safe as K > 0 in all test cases.\n        R = abs(T_zA - T_zB) / k_capacity\n        \n        results.append([I, R])\n\n    # Final print statement in the exact required format.\n    # The format is [[I1,R1],[I2,R2],...], created by joining string representations.\n    stringified_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(stringified_results)}]\")\n\nsolve()\n```"
        }
    ]
}