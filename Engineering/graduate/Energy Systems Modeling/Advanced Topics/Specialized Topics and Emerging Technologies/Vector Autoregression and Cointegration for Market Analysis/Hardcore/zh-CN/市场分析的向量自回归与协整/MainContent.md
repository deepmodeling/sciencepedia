## 引言
在现代市场分析中，我们面对的经济和金融变量，如商品价格、市场需求和政策指标，很少是孤立运动的。它们在一个复杂的动态系统中相互交织、彼此影响。传统的单变量[时间序列分析](@entry_id:178930)方法，虽然简单直观，却无法捕捉这种至关重要的相互依赖性，从而可能导致对市场动态的片面理解和不准确的预测。为了解决这一知识鸿沟，计量经济学发展出了一套强大的[多变量分析](@entry_id:168581)工具——向量自回归（VAR）与[协整](@entry_id:140284)分析。这些模型不仅能够同时刻画多个变量的动态演化，还能揭示它们之间是否存在稳定的[长期均衡](@entry_id:139043)关系。

本文旨在为读者提供一个关于VAR和[协整](@entry_id:140284)模型的全面指南，从核心理论到实际应用。在接下来的内容中，我们将分步探索这一强大的分析框架。第一章 **“原理与机制”** 将深入探讨[VAR模型](@entry_id:139665)的基础、[平稳性条件](@entry_id:191085)，并重点介绍如何通过[单位根检验](@entry_id:142963)和[协整](@entry_id:140284)分析来处理[非平稳数据](@entry_id:261489)，最终引出向量[误差修正模型](@entry_id:142932)（[VEC](@entry_id:192529)M）及其结构解释。第二章 **“应用与跨学科联系”** 将理论付诸实践，通过能源市场的案例展示完整的建模流程，并探讨模型在预测、格兰杰因果检验和结构冲击分析中的应用，同时还将触及其在[金融工程](@entry_id:136943)和生态学等领域的跨学科联系。最后，第三章 **“动手实践”** 将提供具体的编程练习，帮助您巩固所学知识，将理论转化为可操作的技能。让我们首先从理解这些模型的基本构建块开始。

## 原理与机制

### 向量自回归 (VAR) 框架

#### 从单变量到多变量时间序列

在市场分析中，我们关注的变量，如能源价格、需求和相关商品价格，很少是孤立运行的。它们通常在一个复杂的动态系统中相互影响。例如，天然气价格的波动会影响发电成本，从而影响电价；反过来，对[电力](@entry_id:264587)的需求变化也可能通过发电组合的调整反馈影响天然气价格。只对每个变量单独建立单变量时间序列模型，如[自回归 (AR) 模型](@entry_id:265459)，会忽略这些至关重要的跨变量动态关系。

为了捕捉这种相互依赖性，我们转向**向量自回归 (Vector Autoregressive, VAR)** 模型。一个 $k$ 维的 $p$ 阶[向量自回归模型](@entry_id:1133742)，记为 **VAR($p$)**，其形式如下：

$y_t = c + A_1 y_{t-1} + \cdots + A_p y_{t-p} + u_t$

其中：
- $y_t$ 是一个包含 $k$ 个时间序列变量的 $k \times 1$ 维向量，例如 $y_t = (P_t^{\mathrm{el}}, P_t^{\mathrm{gas}}, L_t)^{\prime}$，分别代表[电力](@entry_id:264587)价格、天然气价格和系统负荷。
- $c$ 是一个 $k \times 1$ 维的常数（截距）向量。
- $A_j$ ($j = 1, \ldots, p$) 是 $k \times k$ 维的系数矩阵，捕捉了滞后变量对当前变量的影响。
- $u_t$ 是一个 $k \times 1$ 维的向量[白噪声过程](@entry_id:146877)，满足 $\mathbb{E}[u_t] = 0$ 和 $\mathbb{E}[u_t u_s^{\prime}] = 0$ (对于 $s \neq t$)。其同期的协方差矩阵为 $\mathbb{E}[u_t u_t^{\prime}] = \Sigma_u$，通常是一个非对角矩阵。

VAR模型与 $k$ 个独立的单变量AR($p$)模型的根本区别在于[系数矩阵](@entry_id:151473) $A_j$ 和扰动项的[协方差矩阵](@entry_id:139155) $\Sigma_u$ 的结构 。在一个VAR模型中，$A_j$ 矩阵通常是**稠密 (dense)** 的，其非对角[线元](@entry_id:196833)素 $[A_j]_{im}$ ($i \neq m$) 捕捉了变量 $m$ 的第 $j$ 期滞后值对变量 $i$ 当前值的影响。这使得VAR模型能够明确地模拟所有变量之间的**动态反馈效应**或**格兰杰因果关系 (Granger causality)**。相比之下， $k$ 个独立的[AR模型](@entry_id:189434)等价于一个将所有 $A_j$ 矩阵都限制为[对角矩阵](@entry_id:637782)的[VAR模型](@entry_id:139665)，这从结构上排除了变量间的滞后影响。

此外，非对角的协方差矩阵 $\Sigma_u$ 允许模型捕捉那些同时冲击多个变量的未观测因素（例如，共同的宏观经济新闻或极端天气事件）。这种**同期相关性 (contemporaneous correlation)** 对于理解冲击的传导机制至关重要，而独立的[AR模型](@entry_id:189434)通常忽略了这一点。

#### VAR模型的[平稳性](@entry_id:143776)与稳定性

正如单变量时间序列一样，我们需要关心[VAR模型](@entry_id:139665)的**[平稳性](@entry_id:143776) (stationarity)**。一个向量[随机过程](@entry_id:268487) $\{y_t\}$ 被称为**协方差平稳 (covariance-stationary)**，如果它的前两阶矩不随时间变化：
1.  [均值向量](@entry_id:266544) $\mathbb{E}[y_t] = \mu$ 是一个与时间 $t$ 无关的常数向量。
2.  协方差矩阵 $\mathrm{Cov}(y_t) = \Gamma(0)$ 是一个与时间 $t$ 无关的常数矩阵。
3.  自协方差矩阵 $\mathrm{Cov}(y_t, y_{t-h}) = \Gamma(h)$ 仅依赖于滞后阶数 $h$，而与时间 $t$ 无关。

一个VAR($p$)过程的平稳性取决于其系数矩阵 $A_1, \ldots, A_p$。为了分析稳定性，通常将VAR($p$)模型改写为其**[伴随形式](@entry_id:747524) (companion form)**，这是一个等价的V[AR(1)模型](@entry_id:265801) ：

$z_t = a + A z_{t-1} + \varepsilon_t$

其中 $z_t = (y_t^{\top}, y_{t-1}^{\top}, \ldots, y_{t-p+1}^{\top})^{\top}$ 是一个 $kp \times 1$ 维的堆叠向量，而 $A$ 是一个 $kp \times kp$ 维的**[伴随矩阵](@entry_id:148203)**。

$A = \begin{pmatrix} A_1  A_2  \cdots  A_{p-1}  A_p \\ I_k  0  \cdots  0  0 \\ 0  I_k  \cdots  0  0 \\ \vdots  \vdots  \ddots  \vdots  \vdots \\ 0  0  \cdots  I_k  0 \end{pmatrix}$

VAR($p$)过程是协方差平稳的，当且仅当它所对应的这个动态系统是稳定的。稳定性的条件是：**[伴随矩阵](@entry_id:148203) $A$ 的所有特征值 $\lambda$ 的模 (modulus) 都严格小于1**，即 $|\lambda|  1$。如果存在模等于1的特征值（即[单位根](@entry_id:143302)），过程就是非平稳的。如果存在模大于1的特征值，过程则是爆炸性的。在实证分析中，确保模型的稳定性是进行脉冲响应分析和预测[方差分解](@entry_id:912477)等后续步骤的前提。

### 处理非平稳性：积分与[协整](@entry_id:140284)

#### [非平稳数据](@entry_id:261489)的挑战

许多经济和[金融时间序列](@entry_id:139141)，特别是价格序列，通常表现出非平稳性。它们没有固定的均值，而是呈现出随机游走或趋势行为。这类过程被称为**积分 (integrated)** 过程。一个序列被称为 **$d$ 阶积分 (integrated of order $d$)**，记为 **$I(d)$**，如果它需要经过 $d$ 次差分才能变为[平稳过程](@entry_id:196130)。在实践中，大多数非平稳的经济变量都是 **$I(1)$** 过程，这意味着它们本身是非平稳的，但其[一阶差分](@entry_id:275675) $\Delta y_t = y_t - y_{t-1}$ 是平稳的 ($I(0)$)。

直接在非平稳的 $I(1)$ 变量水平上进行[回归分析](@entry_id:165476)是极其危险的。即使两个完全独立的 $I(1)$ 序列之间不存在任何真实关系，对它们进行回归也常常会得到很高的 $R^2$ 和看似显著的 $t$ 统计量。这种现象被称为**[伪回归](@entry_id:139052) (spurious regression)** 。其根源在于，两个序列共有的随机趋势会错误地表现为统计上的相关性。

#### [单位根检验](@entry_id:142963)

因此，在进行多变量建模之前，一个关键的预备步骤是检验每个序列的积分阶数，即是否存在**[单位根](@entry_id:143302) (unit root)**。最常用的[单位根检验](@entry_id:142963)方法是**[增广迪基-福勒检验](@entry_id:141151) (Augmented Dickey-Fuller, ADF)** 和**菲利普斯-佩龙检验 (Phillips-Perron, PP)**。

进行这些检验时，至关重要的一步是正确设定检验回归中的**确定性成分 (deterministic components)** 。根据对序列的观察（例如，通过绘制时间[序列图](@entry_id:165947)），检验方程应包含：
- **截距 (intercept)**：如果序列围绕一个非零均值波动（或者其差分序列围绕非零均值波动）。
- **线性时间趋势 (linear time trend)**：如果序列围绕一个确定性的时间趋势波动。
- **季节性[虚拟变量](@entry_id:138900) (seasonal dummies)**：对于具有明显季节模式的月度或季度数据。
- **[结构突变](@entry_id:636506)[虚拟变量](@entry_id:138900) (structural break dummies)**：如果在样本期间发生了已知的重大政策变化或市场事件，可能导致序列的均值或趋势发生持久性改变。

忽略必要的确定性成分会导致[检验功效](@entry_id:175836)降低，甚至得出错误结论。AD[F检验](@entry_id:274297)通过在回归中加入足够多的被检验序列的差分滞后项来处理残差的序列相关性，而PP检验则使用[非参数方法](@entry_id:138925)进行修正。通常，我们会使用这两种检验方法相互验证，以确保结论的稳健性。

#### [协整](@entry_id:140284)的概念

如果直接对一组 $I(1)$ 变量进行差分以获得平稳性，然后建立一个关于差分序列的VAR模型，虽然在统计上是有效的，但会丢失变量之间可能存在的[长期均衡](@entry_id:139043)信息。**[协整](@entry_id:140284) (cointegration)** 概念的提出，完美地解决了这个问题。

假设一个向量 $y_t$ 的所有分量都是 $I(1)$ 过程。如果存在一个非零的常数向量 $\beta$，使得[线性组合](@entry_id:154743) $\beta^{\top}y_t$ 是一个平稳的 $I(0)$ 过程，那么我们就称 $y_t$ 的分量是**[协整](@entry_id:140284)的** 。

向量 $\beta$ 被称为**[协整](@entry_id:140284)向量 (cointegrating vector)**，它定义了一个稳定的**[长期均衡](@entry_id:139043)关系 (long-run equilibrium relationship)**。线性组合 $z_t = \beta^{\top}y_t$ 则被称为**均衡误差 (equilibrium error)**。虽然 $y_t$ 的每个分量自身是非平稳的，可以任意漂移，但它们被这个长期关系“捆绑”在一起。每当 $z_t$ 偏离其均值（通常为零）时，就会有一种力量将变量拉回到均衡状态。这种[均值回归](@entry_id:164380)的特性使得均衡误差是平稳的。

在能源市场中，[协整](@entry_id:140284)关系通常有深刻的经济含义。例如，在竞争性市场中，电价在长期内应由边际发电商的成本决定。因此，电价、天然气价格和碳价之间可能存在一个由热耗率和碳排放因子决定的长期成本平价关系。[协整](@entry_id:140284)向量 $\beta$ 就刻画了这个关系，而均衡误差 $\beta^{\top}y_t$ 则可以被解释为一个衡量短期偏离的、平稳的**“错误定价”价差**。市场的套利行为或发电商的运营调整构成了将价差拉回其长期均值的经济力量 。

### 向量[误差修正模型](@entry_id:142932) (VECM)

#### [格兰杰表示定理](@entry_id:138629)

[协整](@entry_id:140284)的存在意味着，纯粹的差分VAR模型是不完整的，因为它忽略了变量向[长期均衡](@entry_id:139043)的调整过程。**向量[误差修正模型](@entry_id:142932) (Vector Error Correction Model, VECM)** 是处理[协整](@entry_id:140284)变量的正确模型框架。[VEC](@entry_id:192529)M与VAR在水平上的关系由**[格兰杰表示定理](@entry_id:138629) (Granger Representation Theorem)** 精确阐明 。

该定理指出，如果一个 $I(1)$ 向量过程 $y_t$ 是[协整](@entry_id:140284)的，那么它一定可以表示为一个VECM形式。反之，一个具有特定结构的[VEC](@entry_id:192529)M也意味着其变量是[协整](@entry_id:140284)的。[VEC](@entry_id:192529)M是对水平VAR($p$)模型的一个等价重[参数化](@entry_id:265163)：

$\Delta y_t = \Pi y_{t-1} + \sum_{i=1}^{p-1} \Gamma_i \Delta y_{t-i} + u_t$

这里的关键是矩阵 $\Pi = (\sum_{i=1}^p A_i) - I_k$。[格兰杰表示定理](@entry_id:138629)说明，如果 $y_t$ 含有 $r$ 个[线性独立](@entry_id:153759)的[协整](@entry_id:140284)关系 ($0  r  k$)，那么矩阵 $\Pi$ 的秩将是 $r$。因此，$\Pi$ 可以被分解为两个 $k \times r$ 阶满秩矩阵的乘积：

$\Pi = \alpha \beta^{\top}$

- $\beta$ 的列向量是[协整](@entry_id:140284)向量，定义了 $r$ 个[长期均衡](@entry_id:139043)关系。
- $\alpha$ 的列向量是**调整系数 (adjustment coefficients)** 或载荷系数，它衡量了每个变量对偏离[长期均衡](@entry_id:139043)的反应速度和方向。

#### [VEC](@entry_id:192529)M的解释

将 $\Pi = \alpha \beta^{\top}$ 代入VECM方程，我们得到：

$\Delta y_t = \alpha (\beta^{\top} y_{t-1}) + \sum_{i=1}^{p-1} \Gamma_i \Delta y_{t-i} + u_t$

这个形式清晰地揭示了系统的动态结构：
- **短期动态**：由所有变量的滞后差分项 $\sum \Gamma_i \Delta y_{t-i}$ 捕捉。
- **长期调整**：由**误差修正项 (error-correction term)** $\alpha (\beta^{\top} y_{t-1})$ 捕捉。该项表明，当上一期存在偏离均衡的情况时（即 $\beta^{\top} y_{t-1} \neq 0$），$y_t$ 的当期变化 $\Delta y_t$ 会做出系统性的调整。

要解释[VEC](@entry_id:192529)M的结果，核心是理[解调](@entry_id:260584)整系数 $\alpha$ 。对于系统中的第 $j$ 个变量 $y_{jt}$，其[VEC](@entry_id:192529)M方程中的误差修正项的系数是 $\alpha_j$（$\alpha$ 向量的第 $j$ 个元素）。
- **$\alpha_j$ 的符号**：决定了调整的方向。为了使系统稳定，当均衡误差为正时（例如，价格高于其[长期均衡](@entry_id:139043)值），我们期望变量的变化能使误差减小。如果[协整](@entry_id:140284)关系被标准化为 $y_{1t} - \dots$，那么对于变量 $y_{1t}$，我们通常期望其调整系数 $\alpha_1  0$。
- **$\alpha_j$ 的大小**：$|\alpha_j|$ 衡量了调整的速度。例如，$\alpha_j = -0.2$ 意味着上一期均衡偏差的 $20\%$ 将在本期通过变量 $y_{j}$ 的变化得到修正。
- **$\alpha_j$ 的[统计显著性](@entry_id:147554)**：如果 $\alpha_j$ 在统计上不显著区别于零，则意味着变量 $y_{j}$ 不会对[长期均衡](@entry_id:139043)的偏离做出反应。这样的变量被称为**弱外生 (weakly exogenous)** 于[协整](@entry_id:140284)关系。它可能会影响[长期均衡](@entry_id:139043)的形成（即出现在 $\beta$ 中），但它自身不受该均衡的约束。

例如，在一个包含电价 ($p_t$) 和负荷 ($l_t$) 的VECM中，我们可能发现电价的调整系数 $\alpha_p = -0.28$ 且高度显著，而负荷的调整系数 $\alpha_l = -0.01$ 且不显著 。这表明，当电价高于其与负荷的[长期均衡](@entry_id:139043)水平时，主要是电价自身通过下降来进行调整，而负荷则表现为弱外生，不受该均衡偏差的影响。

#### [协整](@entry_id:140284)系统中的因果关系

在存在[协整](@entry_id:140284)的 $I(1)$ 变量系统中，使用标准的水平VAR模型进行格兰杰因果检验会产生误导性结果，因为[检验统计量](@entry_id:897871)不再服从标准的[F分布](@entry_id:261265)或[卡方分布](@entry_id:263145) 。正确的做法是在[VEC](@entry_id:192529)M框架内进行。

在[VEC](@entry_id:192529)M中，一个变量对另一个变量的预测能力（即[格兰杰因果关系](@entry_id:137286)）通过两个渠道传递：
1.  **短期因果关系**：通过滞后差分项的系数（$\Gamma_i$ 矩阵中的元素）传递。
2.  **长期因果关系**：通过误差修正项传递。如果一个变量的调整系数 $\alpha_j$ 不为零，那么整个系统的均衡偏差（包含了所有变量的水平信息）就会影响该变量的未来变化。

因此，检验从变量 $m$ 到变量 $j$ 不存在格兰杰因果关系，需要对一个**联合假设**进行检验：在VECM的第 $j$ 个方程中，所有滞后的 $\Delta y_{mt-i}$ 的系数以及调整系数 $\alpha_j$ **同时为零**。这个检验可以通过标准的沃尔德 (Wald) 检验完成，其统计量服从标准的[卡方分布](@entry_id:263145)。

### [结构分析](@entry_id:153861)：从简约形式到[经济冲击](@entry_id:140842)

#### 简约形式扰动与[结构性冲击](@entry_id:136585)

到目前为止，我们讨论的VAR或VECM模型都是**简约形式 (reduced-form)** 模型。模型中的扰动项 $u_t$ 是基于历史信息的一步[预测误差](@entry_id:753692)。这些扰动项通常是同期相关的，即它们的[协方差矩阵](@entry_id:139155) $\Sigma_u$ 是非对角的。这种相关性意味着，一个典型的扰动 $u_{it}$ 并非一个纯粹的、独立的经济事件，而是多个潜在的、更原始的[经济冲击](@entry_id:140842)的混合体 。

为了进行有意义的经济解释和政策分析，我们希望识别出这些潜在的、理论上被认为是相互独立的**[结构性冲击](@entry_id:136585) (structural shocks)**，记为 $\varepsilon_t$。例如，在能源市场中，我们可能希望区分**供给冲击**（如意外的电厂停机或输[气管](@entry_id:274814)道中断）和**需求冲击**（如超预期的热浪导致空调使用量激增）。根据定义，这些[结构性冲击](@entry_id:136585)是正交的，即 $\mathbb{E}[\varepsilon_t \varepsilon_t^{\prime}] = I$（假设已标准化方差为1）。

简约形式扰动 $u_t$ 与[结构性冲击](@entry_id:136585) $\varepsilon_t$ 之间的关系通常被建模为一个[线性变换](@entry_id:149133)：

$u_t = C \varepsilon_t$

其中 $C$ 是一个 $k \times k$ 维矩阵，称为**同期影响矩阵 (contemporaneous impact matrix)**。

#### 识别问题

从这个关系可以推导出协方差矩阵的关系：

$\Sigma_u = \mathbb{E}[u_t u_t^{\prime}] = \mathbb{E}[(C \varepsilon_t)(C \varepsilon_t)^{\prime}] = C \mathbb{E}[\varepsilon_t \varepsilon_t^{\prime}] C^{\prime} = C I C^{\prime} = C C^{\prime}$

**[结构识别](@entry_id:1132570) (structural identification)** 的核心问题就是从数据中估计得到的 $\Sigma_u$ 来确定矩阵 $C$。然而，仅凭这个方程是无法唯一确定 $C$ 的。对于任何一个满足条件的 $C$，任何一个 $C^* = CQ$（其中 $Q$ 是一个[正交矩阵](@entry_id:169220)，满足 $QQ^{\prime}=I$）同样是一个解。这意味着，要从数据中唯一地识别出[结构性冲击](@entry_id:136585)，我们必须施加额外的**识别约束 (identifying restrictions)**，而这些约束必须来自于经济理论或制度背景。

如果不进行[结构识别](@entry_id:1132570)，直接分析简约形式扰动 $u_t$ 的影响（即进行所谓的“天真”脉冲响应分析），可能会导致严重错误的结论。因为一个正的 $u_{it}$ 冲击可能是由一个正的需求冲击和一个负的供给冲击共同作用的结果，将其笼统地解释为“价格冲击”或“产出冲击”会混淆其背后的经济驱动力 。

#### 识别策略

为了解决识别问题，研究者发展了多种施加约束的策略，主要包括：
- **递归识别 (Recursive Identification)**：这是通过对 $\Sigma_u$ 进行**[乔列斯基分解](@entry_id:166031) (Cholesky decomposition)** 实现的。它假设变量之间存在一个递归的同期影响结构，即第一个变量的冲击可以同期影响所有变量，第二个变量的冲击只能同期影响除第一个之外的变量，以此类推。这种方法的合理性完全取决于变量的排序是否符合经济理论。

- **长期约束 (Long-Run Restrictions)**：这种方法利用经济理论对某些冲击的长期或永久性影响施加约束。例如，一个经典的假设是，名义需求冲击在长期内对实际产出没有影响。在[协整](@entry_id:140284)的[VEC](@entry_id:192529)M框架中，可以施加约束，认定某种类型的冲击（如需求冲击）对系统的共同随机趋势没有永久性影响，从而识别出供给冲击和需求冲击 。

- **符号约束 (Sign Restrictions)**：这种方法不对冲击影响的大小施加精确的零约束，而是根据经济理论，对某些变量在受到特定冲击后的短期响应方向（正或负）施加[不等式约束](@entry_id:176084)。

- **外部[工具变量](@entry_id:142324) (External Instruments)**：这是一种较新的方法，也称为**代理SVAR (Proxy SVAR)**。如果能找到一个“外部”的[工具变量](@entry_id:142324)，它与我们想要识别的某个[结构性冲击](@entry_id:136585)相关（例如，用意外的管道事故数据作为供给冲击的代理），但与其他所有[结构性冲击](@entry_id:136585)无关，那么就可以利用这个信息来识别该冲击的影响，而无需施加其他类型的约束 。

通过这些[结构识别](@entry_id:1132570)技术，我们可以从估计的VAR或VECM模型中提取出具有经济含义的冲击，并分析它们对市场变量的动态影响（即**结构[脉冲响应函数](@entry_id:1126431)**）和相对重要性（即**[结构预测](@entry_id:1132571)[方差分解](@entry_id:912477)**），从而为市场分析和政策评估提供更深刻的洞见。