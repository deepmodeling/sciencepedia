{
    "hands_on_practices": [
        {
            "introduction": "卡尔曼滤波器的核心在于其递归的“预测-校正”循环。本练习聚焦于“校正”步骤，也称为测量更新。通过一个微电网中母线电压相角估计的简化实例，我们将探索如何将新的测量数据与先验预测相结合，以获得更精确的后验估计，并量化不确定性的减小。这个标量问题的练习将帮助你直观地理解卡尔曼增益如何充当权重因子，在先验信念和新证据之间取得平衡。",
            "id": "4124641",
            "problem": "一个孤岛微电网具有一个单一的主导总线，其电压相角由于随机的功率平衡波动和逆变器下垂控制而近似地演变为随机游走。令标量状态 $x_{k}$ 表示在离散时间索引 $k$ 时总线电压相角（单位为弧度）。过程模型和测量模型由线性时不变状态空间系统指定：\n$$\nx_{k+1} = A x_{k} + w_{k}, \\quad z_{k} = C x_{k} + v_{k},\n$$\n其中 $w_{k}$ 和 $v_{k}$ 是相互独立的零均值高斯序列，其协方差分别为 $Q$ 和 $R$。一个相量测量单元（PMU）提供相角的直接测量。\n\n对于在时间 $k$ 的单次测量更新，给定以下数值指定的参数和先验量：\n- 状态转移系数 $A = 1$，\n- 测量系数 $C = 1$，\n- 过程噪声协方差 $Q = 2.5 \\times 10^{-4} \\text{ rad}^{2}$，\n- 测量噪声协方差 $R = 7.5 \\times 10^{-3} \\text{ rad}^{2}$，\n- 先验（预测）均值 $\\hat{x}_{k|k-1} = 0.12 \\text{ rad}$，\n- 先验（预测）协方差 $P_{k|k-1} = 0.0102 \\text{ rad}^{2}$，\n- PMU 测量值 $z_{k} = 0.155 \\text{ rad}$。\n\n从线性高斯状态估计的第一性原理出发，推导该标量情况下的测量更新，并计算该单次测量更新步骤的卡尔曼增益 $K_{k}$、后验（更新后）状态估计 $\\hat{x}_{k|k}$（单位为弧度）以及后验（更新后）协方差 $P_{k|k}$（单位为平方弧度）。将您的最终数值四舍五入到四位有效数字。状态估计以弧度表示，协方差以平方弧度表示。按 $K_{k}$、$\\hat{x}_{k|k}$、$P_{k|k}$ 的顺序提供您的最终三个值。",
            "solution": "用户提供了一个问题陈述以进行验证和求解。\n\n### 步骤 1：提取给定条件\n从问题陈述中逐字提取的给定条件如下：\n- 状态空间模型：$x_{k+1} = A x_{k} + w_{k}$, $z_{k} = C x_{k} + v_{k}$\n- 噪声特性：$w_{k}$ 和 $v_{k}$ 是相互独立的零均值高斯序列，其协方差分别为 $Q$ 和 $R$。\n- 状态转移系数：$A = 1$\n- 测量系数：$C = 1$\n- 过程噪声协方差：$Q = 2.5 \\times 10^{-4} \\text{ rad}^{2}$\n- 测量噪声协方差：$R = 7.5 \\times 10^{-3} \\text{ rad}^{2}$\n- 先验（预测）均值：$\\hat{x}_{k|k-1} = 0.12 \\text{ rad}$\n- 先验（预测）协方差：$P_{k|k-1} = 0.0102 \\text{ rad}^{2}$\n- PMU 测量值：$z_{k} = 0.155 \\text{ rad}$\n- 要求输出：卡尔曼增益 $K_{k}$，后验状态估计 $\\hat{x}_{k|k}$，后验协方差 $P_{k|k}$。\n- 舍入要求：最终数值四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的给定条件进行验证\n根据既定标准对问题进行验证。\n\n1.  **科学依据**：该问题描述了卡尔曼滤波器在微电网总线电压相角状态估计中的一个标准应用。随机游走过程模型 ($A=1$) 是对受随机漂移影响的系统的有效且常见的简化。使用相量测量单元（PMU）是实现此目的的标准技术。该问题在控制理论和电力系统工程中有坚实的理论基础。\n2.  **适定性**：该问题提供了执行卡尔曼滤波器单次测量更新步骤所需的所有必要数值和状态空间模型的完整描述。对于所请求的量（$K_{k}$、$\\hat{x}_{k|k}$、$P_{k|k}$）存在唯一且稳定的解。\n3.  **客观性**：该问题以精确的技术语言陈述，没有主观或模棱两可的术语。所有参数均已数值化定义。\n4.  **完整性与一致性**：该问题是自洽的。给定数据的量纲一致（角度以弧度为单位，协方差以平方弧度为单位）。没有矛盾之处。\n5.  **合理性**：协方差、状态和测量值的数值对于所描述的物理系统而言，其量级是现实的。\n\n问题陈述没有可识别的缺陷。这是一个有效、适定且科学上合理的问题。\n\n### 步骤 3：结论与行动\n问题**有效**。将提供解答。\n\n### 解答推导与计算\n我们旨在计算标量线性高斯系统的测量更新。状态 $x_k$ 是一个随机变量。在时刻 $k$，融合测量值 $z_k$ 之前，关于 $x_k$ 的先验知识由先验概率分布 $p(x_k | z_{1:k-1})$ 捕获。对于卡尔曼滤波器，这是一个均值为 $\\hat{x}_{k|k-1}$、方差为 $P_{k|k-1}$ 的高斯分布：\n$$x_k \\sim \\mathcal{N}(\\hat{x}_{k|k-1}, P_{k|k-1})$$\n测量值 $z_k$ 提供了新信息。关系 $z_k = C x_k + v_k$（其中 $v_k \\sim \\mathcal{N}(0, R)$）定义了在给定状态 $x_k$ 时观测到 $z_k$ 的似然。该似然函数 $p(z_k | x_k)$ 是一个以 $C x_k$ 为中心、方差为 $R$ 的高斯分布：\n$$p(z_k|x_k) \\sim \\mathcal{N}(C x_k, R)$$\n根据贝叶斯定理，后验分布 $p(x_k | z_k, z_{1:k-1}) \\equiv p(x_k|z_{1:k})$ 与似然和先验的乘积成正比：\n$$p(x_k|z_{1:k}) \\propto p(z_k|x_k) p(x_k|z_{1:k-1})$$\n由于两个高斯分布的乘积是另一个高斯分布，因此后验分布也是高斯的，由其均值 $\\hat{x}_{k|k}$ 和方差 $P_{k|k}$ 表征。后验均值和方差的表达式是标准的卡尔曼滤波器测量更新方程。对于标量情况，这些方程是：\n\n1.  **卡尔曼增益 ($K_k$):** 增益决定了给予新测量值的权重。\n    $$K_k = \\frac{P_{k|k-1} C}{C^2 P_{k|k-1} + R}$$\n2.  **后验状态估计 ($\\hat{x}_{k|k}$):** 更新后的状态估计是先验估计和测量新息的线性组合。\n    $$\\hat{x}_{k|k} = \\hat{x}_{k|k-1} + K_k (z_k - C \\hat{x}_{k|k-1})$$\n3.  **后验协方差 ($P_{k|k}$):** 更新后的协方差反映了测量后不确定性的减少。\n    $$P_{k|k} = (1 - K_k C) P_{k|k-1}$$\n\n我们现在代入给定的数值。问题指定 $C=1$，这简化了方程。\n\n**给定值：**\n- 先验均值：$\\hat{x}_{k|k-1} = 0.12$\n- 先验协方差：$P_{k|k-1} = 0.0102$\n- 测量值：$z_k = 0.155$\n- 测量噪声协方差：$R = 7.5 \\times 10^{-3} = 0.0075$\n- 测量系数：$C = 1$\n\n**卡尔曼增益 ($K_k$) 的计算：**\n使用 $C=1$ 的简化公式：\n$$K_k = \\frac{P_{k|k-1}}{P_{k|k-1} + R}$$\n$$K_k = \\frac{0.0102}{0.0102 + 0.0075} = \\frac{0.0102}{0.0177} \\approx 0.576271186$$\n四舍五入到四位有效数字，卡尔曼增益为 $K_k = 0.5763$。增益是一个无量纲的量。\n\n**后验状态估计 ($\\hat{x}_{k|k}$) 的计算：**\n首先，我们计算测量新息 $\\tilde{y}_k$，即实际测量值与预测测量值 ($C\\hat{x}_{k|k-1}$) 之间的差值：\n$$\\tilde{y}_k = z_k - C \\hat{x}_{k|k-1} = 0.155 - (1)(0.12) = 0.035 \\text{ rad}$$\n现在，我们更新状态估计：\n$$\\hat{x}_{k|k} = \\hat{x}_{k|k-1} + K_k \\tilde{y}_k$$\n$$\\hat{x}_{k|k} = 0.12 + (0.576271186)(0.035) = 0.12 + 0.0201694915 = 0.1401694915 \\text{ rad}$$\n四舍五入到四位有效数字，后验状态估计为 $\\hat{x}_{k|k} = 0.1402$ rad。\n\n**后验协方差 ($P_{k|k}$) 的计算：**\n使用 $C=1$ 的简化公式：\n$$P_{k|k} = (1 - K_k) P_{k|k-1}$$\n$$P_{k|k} = (1 - 0.576271186)(0.0102) = (0.423728814)(0.0102) = 0.0043220339 \\text{ rad}^2$$\n四舍五入到四位有效数字，后验协方差为 $P_{k|k} = 0.004322$ rad$^2$。该值相比于先验协方差 $0.0102$ rad$^2$ 有显著降低，表明该测量值提供了有效信息。\n\n所要求的三个量的最终数值结果，四舍五入到四位有效数字，如下所示：\n- $K_k = 0.5763$\n- $\\hat{x}_{k|k} = 0.1402$ rad\n- $P_{k|k} = 0.004322$ rad$^2$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5763 & 0.1402 & 0.004322\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在完成了测量更新之后，卡尔曼滤波循环的下一步是“预测”步骤，即时间更新。本练习将通过一个多状态的建筑热力网络模型，演示如何根据系统的动态模型将当前状态的估计值和其协方差向前传播到下一个时间步。通过这个实践，你将掌握不确定性如何通过系统动力学演化，并理解过程噪声（$Q$）在增大预测不确定性中所扮演的角色，为接收下一次测量做好准备。",
            "id": "4124639",
            "problem": "一个三态阻容（RC）热网络模型对一个单区域建筑进行建模，其状态分别代表室内空气温度、内部热容体温度和围护结构温度。在一个采样间隔内的离散时间线性状态演化定律为\n$$\nx_{k+1} = A x_{k} + B u_{k} + w_{k},\n$$\n其中 $x_{k} \\in \\mathbb{R}^{3}$ 是以开尔文为单位的绝对温度的状态向量，$u_{k} \\in \\mathbb{R}$ 是以千瓦为单位的供暖功率输入，$w_{k} \\in \\mathbb{R}^{3}$ 是零均值过程噪声。随机向量 $x_{k}$ 和 $w_{k}$ 是联合高斯且独立的，时刻 $k$ 的先验滤波分布为 $x_{k} \\sim \\mathcal{N}(\\hat{x}_{k|k}, P_{k|k})$。\n\n给定以下数值指定的模型和先验：\n- 状态转移矩阵\n$$\nA = \\begin{pmatrix}\n0.97 & 0.02 & 0.00 \\\\\n0.03 & 0.95 & 0.02 \\\\\n0.00 & 0.05 & 0.93\n\\end{pmatrix}.\n$$\n- 输入矩阵\n$$\nB = \\begin{pmatrix}\n0.15 \\\\\n0.10 \\\\\n0.02\n\\end{pmatrix}.\n$$\n- 过程噪声协方差\n$$\nQ = \\begin{pmatrix}\n0.04 & 0 & 0 \\\\\n0 & 0.05 & 0 \\\\\n0 & 0 & 0.03\n\\end{pmatrix}.\n$$\n- 先验均值和协方差\n$$\n\\hat{x}_{k|k} = \\begin{pmatrix} 296.0 \\\\ 294.5 \\\\ 293.0 \\end{pmatrix}, \\quad\nP_{k|k} = \\begin{pmatrix}\n0.25 & 0 & 0 \\\\\n0 & 0.36 & 0 \\\\\n0 & 0 & 0.16\n\\end{pmatrix}.\n$$\n- 供暖输入 $u_{k} = 6.0$。\n\n从离散时间线性状态演化定律以及随机向量的均值和协方差的定义出发，利用高斯随机向量的仿射变换与一个独立的零均值高斯噪声相加后仍为高斯分布这一性质。推导 $x_{k+1}$ 的一步预测分布，然后评估对应于中间状态的预测协方差元素（预测协方差的 $(2,2)$ 元素）。计算中间状态温度的预测方差，并以 $\\mathrm{K}^{2}$ 为单位表示结果。将最终数值答案四舍五入到四位有效数字。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n问题为离散时间线性状态演化模型的热网络提供了以下数据和定义：\n- 状态演化定律：$x_{k+1} = A x_{k} + B u_{k} + w_{k}$\n- 状态向量：$x_{k} \\in \\mathbb{R}^{3}$（以开尔文为单位的绝对温度）\n- 输入：$u_{k} \\in \\mathbb{R}$（以千瓦为单位的供暖功率）\n- 过程噪声：$w_{k} \\in \\mathbb{R}^{3}$，零均值，即 $\\mathbb{E}[w_{k}] = 0$\n- 统计特性：$x_{k}$ 和 $w_{k}$ 是联合高斯且独立的。\n- 时刻 $k$ 的先验滤波分布：$x_{k} \\sim \\mathcal{N}(\\hat{x}_{k|k}, P_{k|k})$\n- 状态转移矩阵：\n$$\nA = \\begin{pmatrix}\n0.97 & 0.02 & 0.00 \\\\\n0.03 & 0.95 & 0.02 \\\\\n0.00 & 0.05 & 0.93\n\\end{pmatrix}\n$$\n- 输入矩阵：\n$$\nB = \\begin{pmatrix}\n0.15 \\\\\n0.10 \\\\\n0.02\n\\end{pmatrix}\n$$\n- 过程噪声协方差矩阵：\n$$\nQ = \\begin{pmatrix}\n0.04 & 0 & 0 \\\\\n0 & 0.05 & 0 \\\\\n0 & 0 & 0.03\n\\end{pmatrix}\n$$\n- 先验均值向量：\n$$\n\\hat{x}_{k|k} = \\begin{pmatrix} 296.0 \\\\ 294.5 \\\\ 293.0 \\end{pmatrix}\n$$\n- 先验协方差矩阵：\n$$\nP_{k|k} = \\begin{pmatrix}\n0.25 & 0 & 0 \\\\\n0 & 0.36 & 0 \\\\\n0 & 0 & 0.16\n\\end{pmatrix}\n$$\n- 时刻 $k$ 的控制输入：$u_{k} = 6.0$\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了一个热系统的状态空间模型，这是能源系统建模和控制理论中一种标准且科学合理的方法。使用卡尔曼滤波器的预测步骤是状态估计中的一项基本技术。\n- **适定性**：该问题是适定的。它提供了所有必要的数值和一个明确的目标：推导一步预测分布并计算预测协方差矩阵的一个特定元素。存在唯一解。\n- **客观性**：该问题使用精确、客观的数学语言进行陈述。\n- 该问题是自洽且内部一致的。对于所描述的运算，矩阵具有兼容的维度。该设置是状态估计算理论的一个标准应用。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n## 解答\n问题要求推导状态向量 $x_{k+1}$ 的一步预测分布，并计算预测状态协方差矩阵 $P_{k+1|k}$ 的 $(2,2)$ 元素。\n\n状态演化由以下线性方程控制：\n$$x_{k+1} = A x_{k} + B u_{k} + w_{k}$$\n我们已知时刻 $k$ 的状态 $x_k$ 是一个高斯随机向量，其均值为 $\\hat{x}_{k|k}$，协方差为 $P_{k|k}$，即 $x_{k} \\sim \\mathcal{N}(\\hat{x}_{k|k}, P_{k|k})$。过程噪声 $w_k$ 是一个独立的、零均值的高斯随机向量，其协方差为 $Q$，即 $w_{k} \\sim \\mathcal{N}(0, Q)$。输入 $u_k$ 是一个确定性标量。\n\n一步预测状态，记为 $x_{k+1|k}$，是在截至时刻 $k$ 的可用信息条件下的随机变量 $x_{k+1}$。问题要求它的分布。由于 $x_{k+1}$ 是两个独立高斯向量（$x_k$ 和 $w_k$）之和的仿射变换，因此它也是一个高斯随机向量。其分布完全由其均值和协方差刻画。\n\n首先，我们推导预测均值 $\\hat{x}_{k+1|k}$，它是 $x_{k+1}$ 的期望值：\n$$\\hat{x}_{k+1|k} = \\mathbb{E}[x_{k+1}] = \\mathbb{E}[A x_{k} + B u_{k} + w_{k}]$$\n根据期望算子的线性性质：\n$$\\hat{x}_{k+1|k} = \\mathbb{E}[A x_{k}] + \\mathbb{E}[B u_{k}] + \\mathbb{E}[w_{k}]$$\n鉴于 $\\mathbb{E}[x_{k}] = \\hat{x}_{k|k}$，$u_k$ 是一个确定性常数，且 $\\mathbb{E}[w_{k}] = 0$：\n$$\\hat{x}_{k+1|k} = A \\mathbb{E}[x_{k}] + B u_{k} + 0 = A \\hat{x}_{k|k} + B u_{k}$$\n\n接下来，我们推导预测协方差 $P_{k+1|k}$。根据定义，协方差为：\n$$P_{k+1|k} = \\text{Cov}(x_{k+1}) = \\mathbb{E}[ (x_{k+1} - \\hat{x}_{k+1|k})(x_{k+1} - \\hat{x}_{k+1|k})^T ]$$\n代入 $x_{k+1}$ 和 $\\hat{x}_{k+1|k}$ 的表达式：\n$$x_{k+1} - \\hat{x}_{k+1|k} = (A x_{k} + B u_{k} + w_{k}) - (A \\hat{x}_{k|k} + B u_{k}) = A(x_{k} - \\hat{x}_{k|k}) + w_{k}$$\n协方差变为：\n$$P_{k+1|k} = \\mathbb{E}[ (A(x_{k} - \\hat{x}_{k|k}) + w_{k})(A(x_{k} - \\hat{x}_{k|k}) + w_{k})^T ]$$\n展开乘积得到四项。对每一项取期望：\n$$P_{k+1|k} = \\mathbb{E}[A(x_{k} - \\hat{x}_{k|k})(x_{k} - \\hat{x}_{k|k})^T A^T] + \\mathbb{E}[A(x_{k} - \\hat{x}_{k|k})w_{k}^T] + \\mathbb{E}[w_{k}(x_{k} - \\hat{x}_{k|k})^T A^T] + \\mathbb{E}[w_{k}w_{k}^T]$$\n- 第一项是 $A \\mathbb{E}[(x_{k} - \\hat{x}_{k|k})(x_{k} - \\hat{x}_{k|k})^T] A^T = A P_{k|k} A^T$。\n- 第二项和第三项为零，因为 $x_k$ 和 $w_k$ 是独立的，这意味着误差项 $(x_k - \\hat{x}_{k|k})$ 与 $w_k$ 独立。由于 $\\mathbb{E}[w_k] = 0$，交叉乘积项的期望为零。\n- 第四项是 $\\mathbb{E}[w_{k}w_{k}^T] = \\text{Cov}(w_k) = Q$，因为 $w_k$ 是零均值的。\n因此，预测协方差为：\n$$P_{k+1|k} = A P_{k|k} A^T + Q$$\n\n因此，$x_{k+1}$ 的一步预测分布是高斯分布：\n$$x_{k+1} \\sim \\mathcal{N}(A \\hat{x}_{k|k} + B u_{k}, A P_{k|k} A^T + Q)$$\n\n问题要求预测协方差矩阵 $P_{k+1|k}$ 的 $(2,2)$ 元素。这是第二个状态的预测方差，代表内部热容体温度。我们将此元素记为 $(P_{k+1|k})_{22}$。\n$$(P_{k+1|k})_{22} = (A P_{k|k} A^T)_{22} + Q_{22}$$\n矩阵 $P_{k|k}$ 是对角矩阵，这简化了计算。令 $A_{2,*}$ 表示矩阵 $A$ 的第二行。项 $(A P_{k|k} A^T)_{22}$ 可以计算为 $A_{2,*} P_{k|k} (A_{2,*})^T$。\n$$A_{2,*} = \\begin{pmatrix} 0.03 & 0.95 & 0.02 \\end{pmatrix}$$\n$$P_{k|k} = \\begin{pmatrix} 0.25 & 0 & 0 \\\\ 0 & 0.36 & 0 \\\\ 0 & 0 & 0.16 \\end{pmatrix}$$\n首先，我们计算乘积 $A_{2,*} P_{k|k}$：\n$$A_{2,*} P_{k|k} = \\begin{pmatrix} 0.03 & 0.95 & 0.02 \\end{pmatrix} \\begin{pmatrix} 0.25 & 0 & 0 \\\\ 0 & 0.36 & 0 \\\\ 0 & 0 & 0.16 \\end{pmatrix} = \\begin{pmatrix} 0.03 \\times 0.25 & 0.95 \\times 0.36 & 0.02 \\times 0.16 \\end{pmatrix}$$\n$$A_{2,*} P_{k|k} = \\begin{pmatrix} 0.0075 & 0.342 & 0.0032 \\end{pmatrix}$$\n接下来，我们计算其与 $(A_{2,*})^T$ 的乘积：\n$$(A P_{k|k} A^T)_{22} = \\begin{pmatrix} 0.0075 & 0.342 & 0.0032 \\end{pmatrix} \\begin{pmatrix} 0.03 \\\\ 0.95 \\\\ 0.02 \\end{pmatrix}$$\n$$(A P_{k|k} A^T)_{22} = (0.0075)(0.03) + (0.342)(0.95) + (0.0032)(0.02)$$\n$$(A P_{k|k} A^T)_{22} = 0.000225 + 0.3249 + 0.000064 = 0.325189$$\n现在，我们加上过程噪声协方差矩阵 $Q$ 的 $(2,2)$ 元素：\n$$Q = \\begin{pmatrix} 0.04 & 0 & 0 \\\\ 0 & 0.05 & 0 \\\\ 0 & 0 & 0.03 \\end{pmatrix} \\implies Q_{22} = 0.05$$\n所以，中间状态的预测方差为：\n$$(P_{k+1|k})_{22} = 0.325189 + 0.05 = 0.375189$$\n问题要求将结果四舍五入到四位有效数字。\n$$(P_{k+1|k})_{22} \\approx 0.3752 \\, \\mathrm{K}^2$$",
            "answer": "$$\n\\boxed{0.3752}\n$$"
        },
        {
            "introduction": "现实世界中的许多系统本质上是非线性的，这使得标准卡尔曼滤波器不再适用。本练习旨在揭示将线性卡尔曼滤波思想扩展到非线性领域时所面临的挑战，并对比了两种主流方法：扩展卡尔曼滤波器（EKF）和无迹卡尔曼滤波器（UKF）。通过分析一个具有显著曲率的非线性测量模型，你将亲身体会到EKF线性化近似所引入的偏差，并理解为何UKF通过无迹变换能够更精确地传递统计矩，从而在处理非线性问题时表现更优。",
            "id": "4124654",
            "problem": "需要根据具有显著曲率的非线性功率注入测量值来估计配电馈线母线电压幅值 $x$ (单位为pu)。在一个简化但科学上一致的恒定电导近似中，有功功率注入 $y$ 服从非线性测量模型 $y = h(x) + v$，其中 $h(x) = G x^{2}$，电导 $G$ 是已知的正数，加性测量噪声 $v$ 是均值为零、方差为 $R$ 的高斯噪声。先验状态被建模为高斯分布 $x \\sim \\mathcal{N}(m, P)$，表示在吸收测量值之前母线电压的不确定性。考虑 $G = 1$，$m = 1.0$，$P = 0.04$ 和 $R = 0.01$ 的情况。\n\n您将通过分析测量函数曲率引起的后验均值偏差，来比较扩展卡尔曼滤波器 (EKF) 和无迹卡尔曼滤波器 (UKF)。具体来说，将测量值定义为真实非线性模型下的先验期望值，$y := \\mathbb{E}[h(x)]$，这样，在信息论意义上，测量值以先验期望为中心。从高斯矩的核心定义以及 EKF 和 UKF 的标准更新结构（在测量更新中应用无迹变换）出发，从第一性原理推导测量曲率如何影响每个滤波器中的新息和后验均值。\n\n然后，计算给定数值下 EKF 和 UKF 产生的后验均值更新，并将偏差定义为在此中心化测量下后验均值偏离先验均值的幅度，即 $|m^{+} - m|$。报告 EKF 偏差的大小。将您的答案四舍五入到四位有效数字，并以标幺值 (pu) 表示。",
            "solution": "问题要求针对一个特定的非线性状态估计问题，分析扩展卡尔曼滤波器 (EKF) 和无迹卡尔曼滤波器 (UKF) 引起的偏差，并计算 EKF 的偏差大小。\n\n首先，我们确定给定的状态估计问题的各个组成部分。\n状态是母线电压幅值，一个标量 $x$。\n状态的先验知识由高斯分布建模：$x \\sim \\mathcal{N}(m, P)$，其中先验均值 $m=1.0$，先验方差 $P=0.04$。\n测量模型是 $y = h(x) + v$，其中测量函数是 $h(x) = Gx^2$。给定 $G=1$，所以 $h(x) = x^2$。\n测量噪声 $v$ 是一个均值为零、方差为 $R$ 的高斯随机变量，因此 $v \\sim \\mathcal{N}(0, R)$，其中 $R=0.01$。\n\n问题设置的一个关键部分是定义要使用的具体测量值。测量值 $y$ 被设置为真实非线性函数 $h(x)$ 的先验期望值。我们首先计算这个值。\n对于均值为 $m$、方差为 $P$ 的随机变量 $x$，$h(x) = x^2$ 的期望由性质 $\\mathbb{E}[x^2] = (\\mathbb{E}[x])^2 + \\text{Var}(x)$ 给出。\n因此，测量值为：\n$$y := \\mathbb{E}[h(x)] = \\mathbb{E}[x^2] = m^2 + P$$\n代入给定的数值 $m=1.0$ 和 $P=0.04$：\n$$y = (1.0)^2 + 0.04 = 1.0 + 0.04 = 1.04$$\n\n接下来，我们推导 EKF 的后验均值更新并分析其偏差。EKF 在先验均值 $m$ 附近对非线性测量函数 $h(x)$ 进行线性化。线性化后的函数是：\n$$h(x) \\approx h(m) + H(x-m)$$\n其中 $H$ 是 $h(x)$ 在 $x=m$ 处求得的雅可比矩阵。对于我们的标量情况，这就是导数：\n$$H = \\frac{dh}{dx}\\bigg|_{x=m} = \\frac{d(x^2)}{dx}\\bigg|_{x=m} = 2x\\bigg|_{x=m} = 2m$$\nEKF 使用这个线性化模型来预测测量值。预测的测量值，记为 $\\hat{y}_{EKF}$，是线性化函数的期望：\n$$\\hat{y}_{EKF} = \\mathbb{E}[h(m) + H(x-m)] = h(m) + H(\\mathbb{E}[x]-m) = h(m) + H(m-m) = h(m) = m^2$$\nEKF 的新息是实际测量值 $y$ 与滤波器预测的测量值 $\\hat{y}_{EKF}$ 之间的差值：\n$$\\nu_{EKF} = y - \\hat{y}_{EKF} = (m^2 + P) - m^2 = P$$\n这个非零新息完全源于 EKF 的近似误差。滤波器对期望测量值的一阶近似 $m^2$ 与真实期望测量值 $m^2+P$ 相差一个项 $P$，这与 $h(x)$ 的曲率有关。\n\n标准的卡尔曼滤波器更新方程基于此新息进行。新息协方差为：\n$$S_{EKF} = H P H^T + R$$\n代入 $H=2m$：\n$$S_{EKF} = (2m) P (2m) + R = 4m^2P + R$$\n卡尔曼增益为：\n$$K_{EKF} = P H^T S_{EKF}^{-1} = P(2m)(4m^2P + R)^{-1} = \\frac{2mP}{4m^2P+R}$$\n后验均值 $m_{EKF}^{+}$ 从先验均值 $m$ 更新如下：\n$$m_{EKF}^{+} = m + K_{EKF} \\nu_{EKF} = m + \\left(\\frac{2mP}{4m^2P+R}\\right) P = m + \\frac{2mP^2}{4m^2P+R}$$\n偏差，定义为后验均值相对于先验均值的偏移量，是修正项的大小：\n$$|m_{EKF}^{+} - m| = \\left|\\frac{2mP^2}{4m^2P+R}\\right|$$\n由于 $m>0$、$P>0$ 且 $R>0$，绝对值是多余的。\n\n为了比较，我们简要分析 UKF。UKF 使用的无迹变换 (UT) 通过将一组确定性选择的 sigma 点通过真实的非线性函数 $h(x)=x^2$ 传播，来估计输出分布的矩。\n对于二次函数和高斯输入，UT 能精确计算变换后变量的均值。因此，UKF 预测的测量值为：\n$$\\hat{y}_{UKF} = \\mathbb{E}[h(x)] = m^2+P$$\n那么 UKF 的新息是：\n$$\\nu_{UKF} = y - \\hat{y}_{UKF} = (m^2+P) - (m^2+P) = 0$$\n由于新息为零，修正项为零，后验均值不被更新：\n$$m_{UKF}^{+} = m + K_{UKF} \\nu_{UKF} = m + 0 = m$$\n因此，UKF 正确地识别出，相对于先验，该测量没有传递任何新信息，并且在这种特定情况下表现出零偏差，即 $|m_{UKF}^{+} - m| = 0$。\n\n问题要求计算 EKF 的偏差大小。我们将给定的数值代入推导出的表达式中：$m=1.0$，$P=0.04$ 和 $R=0.01$。\n$$|m_{EKF}^{+} - m| = \\frac{2(1.0)(0.04)^2}{4(1.0)^2(0.04) + 0.01}$$\n$$|m_{EKF}^{+} - m| = \\frac{2(0.0016)}{4(0.04) + 0.01} = \\frac{0.0032}{0.16 + 0.01} = \\frac{0.0032}{0.17}$$\n$$|m_{EKF}^{+} - m| \\approx 0.018823529...$$\n将结果四舍五入到四位有效数字得到 $0.01882$。单位是标幺值 (pu)。",
            "answer": "$$\n\\boxed{0.01882}\n$$"
        }
    ]
}