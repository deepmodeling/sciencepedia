## 引言
在现代能源系统的设计、控制与优化中，精确的动态模型扮演着至关重要的角色。无论是为了开发高效的控制算法，还是为了构建用于故障诊断与[预测性维护](@entry_id:167809)的[数字孪生](@entry_id:171650)体，我们都需要能够准确复现物理组件行为的数学描述。然而，从热泵、锅炉到[电力](@entry_id:264587)电子逆变器和燃料电池，绝大多数能源组件在其整个工作范围内都表现出显著的[非线性](@entry_id:637147)行为。传统的[线性模型](@entry_id:178302)往往仅在某个特定的工作点附近有效，无法捕捉系统在不同负载和环境条件下的动态特性变化，这构成了[能源系统建模](@entry_id:1124496)中的一个核心挑战与知识缺口。

本文旨在系统性地介绍用于应对这一挑战的[非线性系统辨识](@entry_id:191103)技术。通过阅读本文，您将掌握一套从理论到实践的完整方法论，用以构建高保真度的[非线性](@entry_id:637147)数据驱动模型。我们将首先在**“原理与机制”**一章中，深入探讨[非线性](@entry_id:637147)行为的本质、各类[非线性模型](@entry_id:276864)的数学结构（如灰箱、黑箱模型），以及确保模型参数可以从数据中被唯一估计的核心理论原则。接着，在**“应用与交叉学科联系”**一章中，我们将通过一系列贯穿[热力学](@entry_id:172368)、[电力](@entry_id:264587)电子和电化学等领域的真实案例，展示这些理论如何被应用于解决实际工程问题，例如辨识设备效率曲线、建模老化过程以及融入物理先验知识。最后，**“动手实践”**部分将提供具体的编程练习，帮助您将所学知识付诸实践。

本文将引导您深入[非线性系统辨识](@entry_id:191103)的世界，首先让我们从其最基本的原理与机制开始。

## 原理与机制

本章深入探讨了[非线性系统辨识](@entry_id:191103)的核心原理与机制，特别关注其在能源系统组件建模中的应用。与在固定工作点附近行为恒定的[线性时不变](@entry_id:276287)（LTI）系统不同，能源组件——如锅炉、热泵、逆变器和[燃料电池](@entry_id:147647)——本质上是[非线性](@entry_id:637147)的。它们的动态特性会随着负载、环境条件和内部状态的变化而显著改变。理解和量化这些[非线性](@entry_id:637147)行为对于设计高效、鲁棒的控制策略以及进行精确的系统级仿真至关重要。

本章将系统性地阐述[非线性](@entry_id:637147)行为的来源、描述[非线性系统](@entry_id:168347)的数学模型结构、确保模型参数可从数据中唯一确定的基本原则，以及在实践中估计这些参数所面临的挑战和策略。

### [非线性](@entry_id:637147)在能源组件中的本质

系统[非线性](@entry_id:637147)的一个核心特征是其对[工作点](@entry_id:173374)的依赖性。一个[LTI模型](@entry_id:1127521)，由固定的[状态空间](@entry_id:160914)矩阵（$A, B, C, D$）或传递函数所描述，在整个工作范围内具有恒定的动态特性，如时间常数和增益。然而，大多数物理系统的行为并非如此。

#### 工作点依赖性与平衡点线性化

许多能源组件的动态行为由其当前的工作状态（即工作点）决定。一个典型例子是发电厂中的锅炉。其核心功能是通过燃烧燃料将水转化为高压蒸汽。这个过程的动态响应，特别是温度响应，强烈依赖于当前的负载水平，即燃料流速、给水流速和蒸汽流速 。

我们可以通过一个简化的[集总参数模型](@entry_id:1127530)来分析这一现象。锅炉汽包的能量平衡遵循[热力学第一定律](@entry_id:146485)：
$$
\frac{dE}{dt} = \dot{Q}_{net} + \sum \dot{m}_{in} h_{in} - \sum \dot{m}_{out} h_{out}
$$
其中，$E$ 是汽包的总内能，$\dot{Q}_{net}$ 是净热传递速率，$\dot{m}$ 和 $h$ 分别是质量流率和比焓。对于锅炉，净热传递 $\dot{Q}_{ht}$ 来自于高温烟气，其本身是燃料流率 $u_f$ 的函数。热量传递给温度为 $T$ 的水-蒸汽混合物。因此，$\dot{Q}_{ht} = U(\cdot) A (T_g(u_f) - T)$，其中 $U(\cdot)$ 是[总传热系数](@entry_id:151629)，它并非一个常数，而是依赖于流体流速（与给水流率 $\dot{m}_{fw}$ 和蒸汽流率 $\dot{m}_{st}$ 相关）和相变状态。

汽包的总内能 $E$ 是温度 $T$ 和压力 $P$ 的函数，$E(T,P) = m_w(T,P) h_w(T,P) + m_s(T,P) h_s(T,P)$，其中 $m_w$ 和 $m_s$ 是水和蒸汽的质量。系统的动态方程可以写成[状态空间](@entry_id:160914)形式 $\dot{x} = f(x,u)$，其中状态 $x$ 可以包含 $T$ 和 $P$，输入 $u$ 包含 $u_f$, $\dot{m}_{fw}$ 和 $\dot{m}_{st}$。

为了分析系统在特定[稳态](@entry_id:139253)[工作点](@entry_id:173374) $\bar{\theta} = (\bar{T}, \bar{P}, \bar{u}_f, \bar{\dot{m}}_{fw}, \bar{\dot{m}}_{st})$ 附近的行为，我们采用**平衡点线性化**。该技术基于在工作点对[非线性](@entry_id:637147)函数 $f(x,u)$ 和输出函数 $g(x,u)$ 进行一阶[泰勒级数展开](@entry_id:138468)。设 $\delta x = x - x^{\star}$ 和 $\delta u = u - u^{\star}$ 为对平衡点 $(x^{\star}, u^{\star})$ 的小扰动，则系统的局部动态可以用一个[LTI模型](@entry_id:1127521)来近似：
$$
\delta \dot{x} = A \delta x + B \delta u
$$
$$
\delta y = C \delta x + D \delta u
$$
其中，[状态空间](@entry_id:160914)矩阵由在平衡点求值的[雅可比矩阵](@entry_id:178326)给出：
$$
A = \frac{\partial f}{\partial x}\bigg|_{(x^{\star},u^{\star})}, \quad B = \frac{\partial f}{\partial u}\bigg|_{(x^{\star},u^{\star})}, \quad C = \frac{\partial g}{\partial x}\bigg|_{(x^{\star},u^{\star})}, \quad D = \frac{\partial g}{\partial u}\bigg|_{(x^{\star},u^{\star})}
$$
这个[LTI模型](@entry_id:1127521)仅在工作点附近的一个小邻域内有效 。

回到锅炉的例子，如果我们关注温度动态，可以推导出局部一阶温度响应模型。其有效热容 $C_{th}(\bar{\theta}) = \frac{\partial E}{\partial T}\big|_{\bar{\theta}}$ 依赖于[工作点](@entry_id:173374)，因为汽包内的水和蒸汽质量以及它们的[热物理性质](@entry_id:1133078)（如比焓）都随温度和压力而变。同样，系统的反馈增益，如与温度相关的热传递项，也依赖于[工作点](@entry_id:173374)，因为[总传热系数](@entry_id:151629) $U$ 随流速变化。因此，[局部时](@entry_id:194383)间常数 $\tau(\bar{\theta})$ 是[工作点](@entry_id:173374)的函数。这意味着，在低负载下辨识出的[LTI模型](@entry_id:1127521)将与在高负载下辨识出的模型有显著不同的参数。

单一[LTI模型](@entry_id:1127521)无法捕捉这种跨越整个工作范围的变化。因此，需要更先进的模型结构，如**[增益调度](@entry_id:272589)（Gain-Scheduled）**或**线性参数变化（LPV）**系统，它们明确地将模型[参数表示](@entry_id:173803)为可测量的调度变量（如输入或状态）的函数。或者，可以使用能捕捉这种依赖性的[非线性](@entry_id:637147)黑箱模型，如**[非线性](@entry_id:637147)自回归外源输入（NARX）**模型 。

我们通过一个具体的计算案例来阐明线性化过程。考虑一个[电力](@entry_id:264587)电子模块的热模型，其温度 $T$ 是状态，电流 $I$ 是输入 。能量平衡方程为：
$$
C \frac{dT}{dt} = I^{2} R(T) - h(T)
$$
其中 $C$ 是热容，$R(T) = R_{0}(1 + \alpha (T - T_{a}))$ 是温度相关的电阻，$h(T) = k (T - T_{a})$ 是到环境的[热损失](@entry_id:165814)。在[稳态](@entry_id:139253)[工作点](@entry_id:173374) $(T^{\star}, I^{\star})$，我们有 $\frac{dT}{dt} = 0$，即 $I^{\star 2} R(T^{\star}) = h(T^{\star})$。通过求解这个[代数方程](@entry_id:272665)，我们可以确定平衡温度 $T^{\star}$。然后，通过计算在 $(T^{\star}, I^{\star})$ 处的[偏导数](@entry_id:146280)，可以得到线性化模型 $\delta \dot{T} = A \delta T + B \delta I$ 的标量参数 $A = \frac{1}{C}(I^{\star 2} R_0 \alpha - k)$ 和 $B = \frac{2I^{\star}R(T^{\star})}{C}$。如果输出是模块电压 $V = I R(T)$，则同样可以计算出 $C = I^{\star}R_0\alpha$ 和 $D = R(T^{\star})$。这个线性化模型对于[控制器设计](@entry_id:274982)是充分的，只要系统运行在 $(T^{\star}, I^{\star})$ 的小邻域内，使得被忽略的高阶项足够小，并且该线性化系统在工作点是局部可控和可观的（即 $B \neq 0$ 且 $C \neq 0$）。

### [非线性](@entry_id:637147)行为分类

为了系统地处理[非线性](@entry_id:637147)，对其进行分类是有益的。能源组件中的[非线性](@entry_id:637147)行为可以根据其是否具有记忆以及其函数的平滑性来进行区分。

#### 静态与动态[非线性](@entry_id:637147)

[非线性](@entry_id:637147)环节的核心区别在于**记忆**。

**静态[非线性](@entry_id:637147)**是无记忆的。其输出在任意时刻 $t$ 仅是同一时刻 $t$ 输入的函数，即 $y(t) = f(u(t))$。这种关系由一个[代数方程](@entry_id:272665)描述，不涉及状态变量或[微分](@entry_id:158422)方程。一个典型的例子是变速热泵中的压缩机饱和现象 。压缩机指令信号 $u(t)$ 提高时，产生的制冷剂质量流率 $\tilde{q}_c(t)$ 会随之增加，但会达到一个物理极限。超过这个极限后，即使 $u(t)$ 继续增加，$\tilde{q}_c(t)$ 也不再增长。这种饱和效应可以被建模为一个瞬时的[非线性](@entry_id:637147)函数 $\tilde{q}_c(t) = f_{sat}(u(t))$。因为它不引入新的时间常数或动态滞后，所以被称为静态[非线性](@entry_id:637147)。

**动态[非线性](@entry_id:637147)**则具有记忆。其输出不仅依赖于当前输入，还依赖于输入的历史。这种记忆通过随时间演化的内部[状态变量](@entry_id:138790)来体现，其行为由[微分](@entry_id:158422)方程（或[差分方程](@entry_id:262177)）支配，例如 $\dot{x}(t) = g(x(t), u(t))$。在热泵系统中，[蒸发器](@entry_id:189229)和冷凝器中的制冷剂存量就是一个例子。这些组件是质量和能量可以累积的控制体积，其行为由质量和能量守恒定律决定：
$$
\frac{d}{dt}m_{cv}(t) = \sum \dot{m}_{in}(t) - \sum \dot{m}_{out}(t)
$$
$$
\frac{d}{dt}U_{cv}(t) = \dot{Q}(t) - \dot{W}(t) + \sum (\dot{m}h)_{in}(t) - \sum (\dot{m}h)_{out}(t)
$$
这里的质量 $m_{cv}(t)$ 和内能 $U_{cv}(t)$ 都是状态变量。由于[状态变量](@entry_id:138790)的演化，系统表现出时间常数、延迟和与振[幅相](@entry_id:269870)关的响应行为。此外，[热物理性质](@entry_id:1133078)（如焓 $h$）本身是状态（如压力和温度）的[非线性](@entry_id:637147)函数，这使得动态本身也是[非线性](@entry_id:637147)的。因此，制冷剂回路的行为构成了动态[非线性](@entry_id:637147) 。

#### 平滑与非平滑[非线性](@entry_id:637147)

[非线性](@entry_id:637147)函数也可以根据其平滑性来分类。

**平滑[非线性](@entry_id:637147)**是指那些在整个工作区域内连续可微的函数。一个例子是[离心泵](@entry_id:264566)的效率曲线，它通常可以由一个关于转速 $s$ 和流量 $q$ 的多项式函数来平滑地近似，例如 $\eta(s,q;\theta) = \sum_{i,j} \theta_{ij} s^i q^j$ 。这类[非线性](@entry_id:637147)的参数可以通过标准的[非线性最小二乘法](@entry_id:167989)进行估计，只要输入信号能够充分激励模型中的所有多项式项。

**非平滑[非线性](@entry_id:637147)**则在其函数或其导数中存在不连续点。常见的例子包括：
*   **[死区](@entry_id:183758)（Deadzone）**：在输入信号超过某个阈值之前，系统没有输出。例如，在泵的模型中，效率在转速低于某个启动阈值 $s_d$ 时可能为零。
*   **饱和（Saturation）**：如前述压缩机例子，输出在达到某个极限后不再增加。
*   **迟滞（Hysteresis）**：输出不仅依赖于当前输入，还依赖于输入变化的方向。这是一种具有记忆的非平滑[非线性](@entry_id:637147)。例如，在泵的效率模型中，可能存在与转速变化历史相关的迟滞回线。

这些非平滑[非线性](@entry_id:637147)对[系统辨识](@entry_id:201290)提出了独特的挑战。例如，为了辨识[死区](@entry_id:183758)参数（如阈值 $s_d$），输入信号必须穿越该阈值。如果实验数据完全处于死区之内，则无法获得关于系统在[死区](@entry_id:183758)之外行为的任何信息，相关参数将无法辨识。类似地，为了辨识迟滞回线的宽度和形状，输入信号必须包含方向反转，以使系统能够遍历回线的两个分支。仅仅使用单调变化的输入是不足以唯一确定迟滞参数的 。

### [非线性系统](@entry_id:168347)建模：结构与表示

在理解了[非线性](@entry_id:637147)的不同类型之后，我们转向如何用数学模型来表示它们。模型选择位于一个谱系上，一端是完全基于物理定律的“白箱”模型，另一端是纯数据驱动的“黑箱”模型。在能源系统领域，通常采用介于两者之间的“灰箱”模型。

#### 灰箱（物理约束）建模

[灰箱建模](@entry_id:1125753)旨在将已知的物理知识融入模型结构中，同时允许从数据中估计未知的参数。这种方法的核心优势是能确保模型在物理上的一致性，例如能量守恒。

以一个通用的能量处理组件为例，其内部能量 $U$ 的变化率由[热力学第一定律](@entry_id:146485)（对于一个开放系统）给出 ：
$$
\frac{dU}{dt} = \dot{Q}(t) - \dot{W}(t) + \sum_{\text{in}} \dot{m}_{\text{in}}(t)\, h_{\text{in}}(t) - \sum_{\text{out}} \dot{m}_{\text{out}}(t)\, h_{\text{out}}(t)
$$
在进行灰箱辨识时，有多种方法可以将这一基本定律嵌入模型中。
1.  **硬约束**：在[参数估计](@entry_id:139349)的优化问题中，可以将能量平衡的离散时间形式作为一个[等式约束](@entry_id:175290)。例如，在每个采样间隔 $[t_k, t_{k+1}]$ 内，内能的变化 $U(x_{k+1};\theta) - U(x_k;\theta)$ 必须精确等于该时间段内测得的净流入能量的积分。这可以通过[拉格朗日乘子法](@entry_id:176596)等[约束优化](@entry_id:635027)技术来实现。
2.  **结构化建模**：另一种更强大的方法是在模型构建之初就保证能量守恒。**哈密顿端口（Port-Hamiltonian, PH）**框架就是一个例子。在该框架中，系统的[储能函数](@entry_id:197811)（[哈密顿量](@entry_id:144286)，此处为内能 $U(x;\theta)$）的时间导数被构造为等于通过“端口”流入和流出的功率之差，即 $\frac{dU}{dt} = p_{in}(t) - p_{out}(t)$。通过将热、功和焓流等物理能量流定义为端口功率，模型在结构上就保证了能量守恒。

这些方法确保了辨识出的模型不仅能拟合数据，而且其预测（尤其是在外推到新工况时）不会违反基本的物理定律。

#### [黑箱模型](@entry_id:1121697)结构

当第一原理模型过于复杂或难以获得时，黑箱模型提供了一种替代方案。这些模型根据其内部结构进行分类。

##### 模块化模型（Block-Oriented Models）

这类模型将系统表示为静态[非线性](@entry_id:637147)模块和[线性时不变](@entry_id:276287)（LTI）动态模块的互连。最常见的三种结构是：
*   **[Hammerstein模型](@entry_id:193919) (NL-LTI)**：一个静态[非线性](@entry_id:637147)模块后跟一个LTI动态模块。这种结构非常适合描述执行器[非线性](@entry_id:637147)。例如，在[并网逆变器](@entry_id:1125777)中，控制器发出的电流指令 $u(t)$ 首先会受到直流母线电压和PWM的限制（饱和），这是一个静态[非线性](@entry_id:637147) $g(\cdot)$。这个被“裁剪”过的[有效电压](@entry_id:267211) $v(t) = g(u(t))$ 然后才作用于L-C滤波器和电网阻抗，这是一个LTI动态系统 $h(t)$。因此，最终的电流输出是 $i(t) = (h * v)(t) + n(t)$ 。
*   **[Wiener模型](@entry_id:188978) (LTI-NL)**：一个LTI动态模块后跟一个静态[非线性](@entry_id:637147)模块。这种结构适合描述传感器[非线性](@entry_id:637147)。
*   **Hammerstein-[Wiener模型](@entry_id:188978) (NL-LTI-NL)**：一个LTI动态模块夹在两个静态[非线性](@entry_id:637147)模块之间。这可以同时描述执行器和传感器的[非线性](@entry_id:637147)。

这些模块化模型在物理上有很好的解释性。例如，[热泵](@entry_id:143719)中的压缩机饱和（静态[非线性](@entry_id:637147)）先于制冷剂在[换热器](@entry_id:154905)中的循环（动态[非线性](@entry_id:637147)），这天然地对应于一个Hammerstein结构 。

##### 一般回归模型 (NARX)

**[非线性](@entry_id:637147)自回归外源输入（NARX）**模型是一种更通用的黑箱结构。它将当前输出 $y(k)$ 表示为过去输出、过去输入和（可能）当前输入的一个静态[非线性](@entry_id:637147)函数 $f(\cdot)$：
$$
y(k) = f\big(y(k-1),\ldots,y(k-n_{y}), u(k), u(k-1),\ldots,u(k-n_{u})\big) + \varepsilon(k)
$$
其中 $n_y$ 和 $n_u$ 是模型的阶数，$\varepsilon(k)$ 是一个创新项或方程误差。N[ARX模型](@entry_id:269528)是“通用近似器”，意味着只要函数 $f(\cdot)$ 足够复杂且阶数足够高，它就可以近似任何[非线性](@entry_id:637147)动态系统。

与Hammerstein-Wiener等模块化模型相比，N[ARX模型](@entry_id:269528)的优势在于其通用性，但缺点是它将动态和[非线性混合](@entry_id:1128865)在单一的函数 $f(\cdot)$ 中，可能缺乏物理可解释性。例如，一个具有明确物理结构的[燃料电池](@entry_id:147647)，其动态行为（如[双电层](@entry_id:160711)充电）和静态[非线性](@entry_id:637147)（如活化和[浓差极化](@entry_id:266906)）可以被一个Hammerstein-[Wiener模型](@entry_id:188978)以一种节俭（parsimonious）的方式表示。而一个N[ARX模型](@entry_id:269528)虽然也能表示相同的行为，但其结构与底层物理过程的对应关系不明确 。

### [非线性模型辨识](@entry_id:752647)原理

定义了模型结构后，下一个关键问题是如何从实验数据中估计其参数。这引出了辨识理论的两个核心概念：[可辨识性](@entry_id:194150)和输入激励。

#### [可辨识性](@entry_id:194150)

[可辨识性](@entry_id:194150)研究的是模型参数能否从输入-输出数据中被唯一确定。

##### 结构可辨识性

**结构可辨识性**是一个理论概念，它假设我们拥有完美的、无噪声的数据和任意选择的输入信号。一个模型被称为结构可辨识的，如果从参数到输出的映射是[单射](@entry_id:183792)的（injective）。也就是说，两个不同的参数集 $\theta_1 \neq \theta_2$ 不会产生完全相同的输入-输出行为。

如果一个模型不是结构可辨识的，那么无论数据多么理想，都无法唯一确定所有参数。一个常见的[结构不可辨识性](@entry_id:1132558)的来源是参数在模型方程中以乘积或代数组合的形式出现。例如，考虑一个同时包含对流和辐射传热的物体的热模型 ：
$$
C(T)\,\dot{T} = q_{\mathrm{in}} - h\,A\,(T-T_a) - \epsilon\,\sigma\,A\,(T^4 - T_a^4)
$$
在这个模型中，未知的物理参数是对流换热系数 $h$、有效面积 $A$ 和表面发射率 $\epsilon$。然而，在决定系统动态的方程中，它们只以乘积形式 $hA$ 和 $\epsilon A$ 出现。这意味着，任何一组新的参数 $(h' = h/\alpha, A' = \alpha A, \epsilon' = \epsilon/\alpha)$ 只要 $\alpha \neq 0$，就会产生与原始参数组完全相同的动态行为，因为 $h'A' = hA$ 且 $\epsilon'A' = \epsilon A$。因此，我们只能辨识出复合参数 $hA$ 和 $\epsilon A$，而无法从输入-输出数据中分离出 $h$, $A$, 和 $\epsilon$ 各自的值。除非有额外的先验知识（例如，通过几何测量预先知道 $A$），否则这些参数是结构不可辨识的。

##### [持续激励](@entry_id:263834)

在实践中，我们处理的是有限且含噪声的数据。**实用可辨识性**关注的是在这种条件下参数估计的可靠性。一个关键的要求是输入信号必须具有足够的“丰富性”，这个概念被形式化为**[持续激励](@entry_id:263834)（Persistent Excitation, PE）**。

对于一个线性于参数的模型，如多项式N[ARX模型](@entry_id:269528) $y(k) \approx \phi^{\top}(k)\,\theta$，其参数可以通过最小二乘法估计。[最小二乘解](@entry_id:152054)的存在性和唯一性要求回归矩阵 $X$（其行是 $\phi^{\top}(k)$）是列满秩的，这等价于要求[格拉姆矩阵](@entry_id:203297) $X^{\top}X$ 是可逆的（或正定的）。

一个输入信号 $u(k)$ 被认为是**n阶[持续激励](@entry_id:263834)**，如果它能保证由其产生的任何一个包含 $n$ 个线性[无关回归量](@entry_id:1128955)的回归矩阵 $X$ 都是列满秩的。对于[线性系统](@entry_id:147850)，一个等价的频域条件是输入信号的[频谱](@entry_id:276824)必须在至少 $n/2$ 个频率点上不为零。对于非线性系统，如N[ARX模型](@entry_id:269528)，由于回归量本身是输入的[非线性](@entry_id:637147)函数，情况更为复杂。然而，基本原则依然适用：输入信号必须足够丰富，以确保所有 $n$ 个回归量的时间序列是[线性无关](@entry_id:148207)的。

设计一个具有良好激励特性的输入信号是系统辨识[实验设计](@entry_id:142447)的核心。对于[非线性系统](@entry_id:168347)，**多正弦波（multisine）**输入是一个优秀的选择。通过组合多个不同频率、振幅和相位的正弦波，可以产生一个具有可控[频谱](@entry_id:276824)和功率分布的[周期信号](@entry_id:266688)。为辨识一个包含 $n$ 个参数的N[ARX模型](@entry_id:269528)，一个可靠的策略是使用一个包含至少 $n$ 个（或与 $n$ 相当数量的）不同基频的多正弦波输入 。这可以确保通过[非线性](@entry_id:637147)环节产生的[谐波](@entry_id:181533)和互[调频](@entry_id:162932)率足够丰富，从而使得回归矩阵 $X^{\top}X$（以及与之相关的费雪信息矩阵）是良态和正定的，保证了参数的唯一估计。

### 参数估计实践

最后，我们讨论将这些原理付诸实践时遇到的具体方法和挑战。

#### 模块化模型的辨识

对于像Hammerstein这样的模块化模型，可以采用分步辨识策略。以逆变器模型为例 ，其辨识过程可以分为：
1.  **辨识线性部分 $h(t)$**：这可以通过在系统的线性区域（即不触发饱和）进行小信号实验来完成。或者，使用特定的输入（如随机相位多正弦波）计算系统的[最佳线性近似](@entry_id:164642)（BLA），该近似与 $h(t)$ 成正比。
2.  **估计中间信号 $v(t)$**：一旦获得了线性部分 $\hat{h}(t)$ 的估计，就可以通过解卷积（逆滤波）来估计未测量的中间信号：$\hat{v}(t) \approx (\hat{h}^{-1} * i)(t)$。这一步的可行性依赖于一个关键假设：[线性系统](@entry_id:147850) $h(t)$ 是**[最小相位](@entry_id:273619)**的，这意味着其[逆系统](@entry_id:271994) $\hat{h}^{-1}(t)$ 是稳定和因果的。
3.  **辨识静态[非线性](@entry_id:637147) $g(\cdot)$**：由于存在测量噪声，直接的逆滤波会放大高频噪声。因此，需要使用**正则化**技术来获得一个平滑的 $\hat{v}(t)$ 估计。有了输入 $u(t)$ 和估计的中间信号 $\hat{v}(t)$，辨识 $g(\cdot)$ 就简化为一个静态函数回归问题，可以通过绘制 $\hat{v}(t)$ 对 $u(t)$ 的[散点图](@entry_id:902466)并拟合一个合适的函数（如[参数化](@entry_id:265163)的饱和函数或非参数的[样条](@entry_id:143749)函数）来解决。

#### 估计中的挑战

##### 非[凸性](@entry_id:138568)与[局部极小值](@entry_id:143537)

与线性系统辨识（通常是[凸优化](@entry_id:137441)问题）不同，大多数[非线性模型](@entry_id:276864)的参数估计问题都是**非凸的**。这意味着目标函数（如[非线性](@entry_id:637147)最小二乘的[残差平方和](@entry_id:174395)）存在多个[局部极小值](@entry_id:143537)。标准的[梯度下降优化](@entry_id:634206)算法（如Gauss-Newton或Levenberg-Marquardt）只能保证收敛到一个[局部极小值](@entry_id:143537)，而这个解可能与真实的[全局最优解](@entry_id:175747)相去甚远。

以一个复杂的热泵物理模型为例 ，非凸性源于多种复杂的参数耦合：参数出现在分母中（如效率 $\eta_{comp}$），参数之间存在乘积关系（如压缩机排量 $D$ 和效率 $\eta_{comp}$），以及通过指数函数（如[Clausius-Clapeyron方程](@entry_id:147470)）引入的强[非线性](@entry_id:637147)。

为了应对非凸性带来的挑战，必须采用更复杂的策略：
*   **物理知识指导的初始化**：利用制造商数据、设计规格或在单一[工作点](@entry_id:173374)上的简化分析来获得参数的初始猜测值。一个好的初始点可以极大地增加收敛到全局最优解的概率。
*   **[多起点优化](@entry_id:637385)**：从[参数空间](@entry_id:178581)中多个随机选择的初始点开始运行局部[优化算法](@entry_id:147840)，然[后选择](@entry_id:154665)所有运行中得到的最佳结果。
*   **连续/[同伦](@entry_id:139266)方法**：从一个简化的、易于求解的问题开始，然后逐渐增加其复杂性，并将前一步的解作为后一步的初始值。例如，可以先用低速工况的数据辨识参数，然后逐步引入高速工况的数据，引导参数估计走向一个好的解。

##### 变量含误差问题

对于NARX这类包含过去输出作为回归量的模型，存在一个被称为**变量含误差（errors-in-variables）**的经典问题。在辨识时，我们使用的是带有[测量噪声](@entry_id:275238)的过去输出 $y_m(k-1)$，而不是真实的无噪声输出 $y(k-1)$。这意味着回归量本身是含噪声的，并且这个噪声与我们试图预测的当前测量值 $y_m(k)$ 中的[噪声相关](@entry_id:1128753)。当这种情况发生时，标准的[最小二乘估计](@entry_id:262764)会产生**有偏**的[参数估计](@entry_id:139349)。相比之下，像Hammerstein-Wiener这样的模型，如果其辨识和仿真是基于无噪声的输入 $u(k)$ 进行的，就可以避免这种噪声反馈和相关的偏差问题 。处理N[ARX模型](@entry_id:269528)中的这种偏差需要更先进的辨识技术，如[工具变量法](@entry_id:204495)或总[最小二乘法](@entry_id:137100)。