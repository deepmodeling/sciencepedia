{
    "hands_on_practices": [
        {
            "introduction": "电网中的电压测量值常常含有噪声，但物理上相邻母线的电压值是相关的。本练习将电网拓扑结构建模为一个图，并利用图拉普拉斯算子作为正则化项，以平滑并去噪电压信号。通过解决这个凸优化问题，您将掌握图信号处理的基本方法，并学会如何利用网络结构信息来提高数据质量。",
            "id": "4082630",
            "problem": "考虑一个具有三个母线的配电网络，这些母线以链式拓扑结构连接，其中根据历史数据推断出的电气耦合被建模为一个无向加权图。设对称权重矩阵 $W$ 的元素为 $w_{12} = 10$，$w_{23} = 5$ 和 $w_{13} = 0$，且 $w_{ij} = w_{ji}$，$w_{ii} = 0$。组合图拉普拉斯算子 $L$ 定义为 $L = D - W$，其中 $D$ 是对角度矩阵，其元素为 $D_{ii} = \\sum_{j} w_{ij}$。我们将母线电压幅值建模为与母线索引对齐的图信号 $x \\in \\mathbb{R}^{3}$。观测到一个母线电压幅值的带噪测量向量 $y \\in \\mathbb{R}^{3}$，其标幺值 (p.u.) 为 $y = [0.98, 1.03, 0.96]^\\top$。在智能电网的数据驱动去噪中，可以通过求解以下凸优化问题来获得一个估计量：\n$$\n\\min_{x \\in \\mathbb{R}^{3}} \\ \\|y - x\\|^{2} + \\lambda \\, x^{\\top} L x,\n$$\n其中 $\\lambda > 0$ 是一个通过交叉验证选择的正则化参数；取 $\\lambda = 0.2$。\n\n从图拉普拉斯算子的基本定义和凸二次优化的一阶最优性条件出发，推导上述目标的最小化子 $x^{\\star}$ 的闭式解。然后，使用给定的 $W$ 计算 $L$，构建由最优性条件所蕴含的矩阵方程，并为所提供的 $y$ 和 $\\lambda$ 计算去噪后的母线电压幅值 $x^{\\star}$。以标幺值 (p.u.) 表示最终的去噪后母线电压幅值。将您的答案四舍五入到四位有效数字。",
            "solution": "首先对该问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n-   **网络拓扑**：链式连接的三个母线。\n-   **权重矩阵 ($W$)**：一个对称矩阵，其元素为 $w_{12} = 10$，$w_{23} = 5$，$w_{13} = 0$，且 $w_{ij} = w_{ji}$，$w_{ii} = 0$。\n-   **图拉普拉斯算子 ($L$)**：定义为 $L = D - W$。\n-   **度矩阵 ($D$)**：一个对角矩阵，其元素为 $D_{ii} = \\sum_{j} w_{ij}$。\n-   **图信号 ($x$)**：$x \\in \\mathbb{R}^{3}$，表示母线电压幅值。\n-   **带噪测量 ($y$)**：$y = [0.98, 1.03, 0.96]^\\top$，单位为标幺值 (p.u.)。\n-   **优化问题**：$\\min_{x \\in \\mathbb{R}^{3}} \\ \\|y - x\\|^{2} + \\lambda \\, x^{\\top} L x$。\n-   **正则化参数 ($\\lambda$)**：$\\lambda = 0.2$。\n-   **要求输出**：去噪后的母线电压幅值 $x^{\\star}$，四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n对该问题的有效性进行评估。\n\n-   **科学依据**：该问题在图信号处理和凸优化领域有充分的依据。该公式是一个图上的标准吉洪诺夫正则化问题，是机器学习和数据科学中广泛使用的技术，包括在智能电网分析中的应用。使用图拉普拉斯算子对定义在图上的信号强制平滑是一个基本概念。\n-   **适定性**：目标函数 $J(x) = \\|y - x\\|^{2} + \\lambda x^{\\top} L x$ 是两个凸函数之和。项 $\\|y - x\\|^{2}$ 是严格凸的。项 $x^{\\top} L x$（图拉普拉斯二次型）是凸的，因为对于具有非负权重的图，组合图拉普拉斯算子 $L$ 总是半正定的。由于 $\\lambda > 0$，一个严格凸函数和一个凸函数之和是严格凸的。一个严格凸函数有唯一的最小化子。因此，存在唯一的解 $x^{\\star}$，该问题是适定的。\n-   **客观性**：该问题以精确、形式化的数学语言陈述，没有任何主观或模糊的术语。\n-   **完整性与一致性**：所有必要的数据（$W$, $y$, $\\lambda$）和定义（$L$, $D$）都已提供。设置中没有矛盾之处。\n-   **真实性**：$y$ 中的标幺电压值对于配电系统是符合实际的。$W$ 中的权重是抽象的耦合值，但它们的尺度不会引入任何物理上的不可能性。\n\n### 步骤 3：结论与行动\n该问题在科学上是合理的，在数学上是适定的、客观的且自洽的。因此，它被判定为**有效**。将提供完整的解答。\n\n目标是找到最小化代价函数的向量 $x^{\\star}$：\n$$\nJ(x) = \\|y - x\\|^{2} + \\lambda \\, x^{\\top} L x\n$$\n这是一个凸二次优化问题。可以通过将 $J(x)$ 对 $x$ 的梯度设为零来找到最小化子 $x^{\\star}$。\n\n首先，我们展开目标函数。欧几里得范数的平方是 $\\|y - x\\|^{2} = (y - x)^{\\top}(y-x)$。\n$$\nJ(x) = (y - x)^{\\top}(y - x) + \\lambda \\, x^{\\top} L x\n$$\n$$\nJ(x) = (y^{\\top} - x^{\\top})(y - x) + \\lambda \\, x^{\\top} L x\n$$\n$$\nJ(x) = y^{\\top}y - y^{\\top}x - x^{\\top}y + x^{\\top}x + \\lambda \\, x^{\\top} L x\n$$\n由于 $x^{\\top}y$ 是一个标量，它等于其转置 $(x^{\\top}y)^{\\top} = y^{\\top}x$。同时，$x^{\\top}x = x^{\\top}Ix$，其中 $I$ 是单位矩阵。\n$$\nJ(x) = x^{\\top}(I + \\lambda L)x - 2y^{\\top}x + y^{\\top}y\n$$\n这是 $x$ 的一个二次型。为了找到最小值，我们计算梯度 $\\nabla_x J(x)$ 并将其设为零。使用标准的矩阵微积分恒等式，$\\nabla_x(x^{\\top}Ax) = (A+A^{\\top})x$ 和 $\\nabla_x(b^{\\top}x) = b$。\n矩阵 $(I + \\lambda L)$ 是对称的，因为 $I$ 和 $L$ 都是对称的。因此，二次项的梯度是 $2(I+\\lambda L)x$。\n$$\n\\nabla_x J(x) = 2(I + \\lambda L)x - 2y\n$$\n将梯度设为零以求得最优解 $x^{\\star}$：\n$$\n2(I + \\lambda L)x^{\\star} - 2y = 0\n$$\n$$\n(I + \\lambda L)x^{\\star} = y\n$$\n矩阵 $(I + \\lambda L)$ 是正定的，因此是可逆的，因为 $I$ 是正定的，且对于 $\\lambda > 0$，$ \\lambda L$ 是半正定的。去噪信号 $x^{\\star}$ 的闭式解是：\n$$\nx^{\\star} = (I + \\lambda L)^{-1}y\n$$\n接下来，我们计算数值。首先，我们构建矩阵 $W$，$D$ 和 $L$。\n给定 $w_{12} = 10$，$w_{23} = 5$，$w_{13} = 0$，$w_{ij}=w_{ji}$，以及 $w_{ii}=0$：\n$$\nW = \\begin{pmatrix} 0  & 10 & 0 \\\\ 10 & 0 & 5 \\\\ 0 & 5 & 0 \\end{pmatrix}\n$$\n度矩阵 $D$ 的对角线元素为 $D_{ii} = \\sum_j w_{ij}$：\n$D_{11} = w_{12} + w_{13} = 10 + 0 = 10$\n$D_{22} = w_{21} + w_{23} = 10 + 5 = 15$\n$D_{33} = w_{31} + w_{32} = 0 + 5 = 5$\n所以，度矩阵是：\n$$\nD = \\begin{pmatrix} 10 & 0 & 0 \\\\ 0 & 15 & 0 \\\\ 0 & 0 & 5 \\end{pmatrix}\n$$\n组合图拉普拉斯算子 $L$ 是 $L = D - W$：\n$$\nL = \\begin{pmatrix} 10 & 0 & 0 \\\\ 0 & 15 & 0 \\\\ 0 & 0 & 5 \\end{pmatrix} - \\begin{pmatrix} 0 & 10 & 0 \\\\ 10 & 0 & 5 \\\\ 0 & 5 & 0 \\end{pmatrix} = \\begin{pmatrix} 10 & -10 & 0 \\\\ -10 & 15 & -5 \\\\ 0 & -5 & 5 \\end{pmatrix}\n$$\n现在，我们用 $\\lambda = 0.2$ 构建矩阵 $A = I + \\lambda L$：\n$$\n\\lambda L = 0.2 \\begin{pmatrix} 10 & -10 & 0 \\\\ -10 & 15 & -5 \\\\ 0 & -5 & 5 \\end{pmatrix} = \\begin{pmatrix} 2 & -2 & 0 \\\\ -2 & 3 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix}\n$$\n$$\nA = I + \\lambda L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} + \\begin{pmatrix} 2 & -2 & 0 \\\\ -2 & 3 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 3 & -2 & 0 \\\\ -2 & 4 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix}\n$$\n我们必须求解线性系统 $Ax^{\\star} = y$：\n$$\n\\begin{pmatrix} 3 & -2 & 0 \\\\ -2 & 4 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix} x^{\\star} = \\begin{pmatrix} 0.98 \\\\ 1.03 \\\\ 0.96 \\end{pmatrix}\n$$\n为了求解 $x^{\\star}$，我们可以求 $A$ 的逆矩阵。$A$ 的行列式是：\n$$\n\\det(A) = 3((4)(2) - (-1)(-1)) - (-2)((-2)(2) - (-1)(0)) = 3(7) + 2(-4) = 21 - 8 = 13\n$$\n$A$ 的伴随矩阵是其代数余子式矩阵的转置。由于 $A$ 是对称的，其伴随矩阵也是对称的。\n$$\n\\text{adj}(A) = \\begin{pmatrix} (4)(2)-(-1)(-1) & -((-2)(2)-0) & (-2)(-1)-0 \\\\ -((-2)(2)-(-1)(0)) & (3)(2)-0 & -((3)(-1)-0) \\\\ (-2)(-1)-(4)(0) & -((3)(-1)-(-2)(0)) & (3)(4)-(-2)(-2) \\end{pmatrix}^{\\top} = \\begin{pmatrix} 7 & 4 & 2 \\\\ 4 & 6 & 3 \\\\ 2 & 3 & 8 \\end{pmatrix}\n$$\n逆矩阵是 $A^{-1} = \\frac{1}{\\det(A)}\\text{adj}(A)$：\n$$\nA^{-1} = \\frac{1}{13} \\begin{pmatrix} 7 & 4 & 2 \\\\ 4 & 6 & 3 \\\\ 2 & 3 & 8 \\end{pmatrix}\n$$\n现在我们计算 $x^{\\star} = A^{-1}y$：\n$$\nx^{\\star} = \\frac{1}{13} \\begin{pmatrix} 7 & 4 & 2 \\\\ 4 & 6 & 3 \\\\ 2 & 3 & 8 \\end{pmatrix} \\begin{pmatrix} 0.98 \\\\ 1.03 \\\\ 0.96 \\end{pmatrix} = \\frac{1}{13} \\begin{pmatrix} 7(0.98) + 4(1.03) + 2(0.96) \\\\ 4(0.98) + 6(1.03) + 3(0.96) \\\\ 2(0.98) + 3(1.03) + 8(0.96) \\end{pmatrix}\n$$\n$$\nx^{\\star} = \\frac{1}{13} \\begin{pmatrix} 6.86 + 4.12 + 1.92 \\\\ 3.92 + 6.18 + 2.88 \\\\ 1.96 + 3.09 + 7.68 \\end{pmatrix} = \\frac{1}{13} \\begin{pmatrix} 12.90 \\\\ 12.98 \\\\ 12.73 \\end{pmatrix}\n$$\n$$\nx^{\\star} = \\begin{pmatrix} 12.90 / 13 \\\\ 12.98 / 13 \\\\ 12.73 / 13 \\end{pmatrix} = \\begin{pmatrix} 0.9923076... \\\\ 0.9984615... \\\\ 0.9792307... \\end{pmatrix}\n$$\n问题要求将最终答案四舍五入到四位有效数字。\n$x^{\\star}_1 = 0.9923076... \\approx 0.9923$\n$x^{\\star}_2 = 0.9984615... \\approx 0.9985$\n$x^{\\star}_3 = 0.9792307... \\approx 0.9792$\n去噪后的母线电压幅值为 $x^{\\star}_1 \\approx 0.9923$ p.u.，$x^{\\star}_2 \\approx 0.9985$ p.u. 和 $x^{\\star}_3 \\approx 0.9792$ p.u.。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9923 & 0.9985 & 0.9792\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "负荷预测是智能电网运行中的一项核心任务，指数加权移动平均（EWMA）是一种简单而常用的预测方法。本练习旨在揭示EWMA预测器与线性高斯状态空间模型下的最优估计器（卡尔曼滤波器）之间的深刻理论联系。通过从第一性原理出发推导最优的“遗忘因子”，您将不仅学会如何实现一个时序预测器，更将深入理解其背后的统计最优性原理。",
            "id": "4082672",
            "problem": "考虑智能电网中的一个单变量馈线净负荷过程，该过程被建模为一个带有简单确定性漂移的线性高斯状态空间模型。潜水平表示为 $x_t$，观测到的净负荷为 $y_t$，每个时间步的漂移是一个已知常数 $d$。系统演化如下：\n$$\nx_t = x_{t-1} + d + w_t,\\quad w_t \\sim \\mathcal{N}(0,q),\n$$\n以及\n$$\ny_t = x_t + v_t,\\quad v_t \\sim \\mathcal{N}(0,r),\n$$\n其中 $q \\ge 0$ 和 $r > 0$ 分别是过程噪声和测量噪声的方差，$\\mathcal{N}(0,\\sigma^2)$ 表示均值为零、方差为 $\\sigma^2$ 的高斯分布。所有噪声在时间和过程之间都是相互独立的。\n\n一个指数加权移动平均 (EWMA) 预测器使用遗忘因子 $\\alpha \\in [0,1]$ 生成一个滤波估计值 $\\hat{x}_t$ 和一个单步预测值 $\\hat{y}_{t+1|t}$：\n$$\n\\hat{x}_t = (1-\\alpha)\\left(\\hat{x}_{t-1} + d\\right) + \\alpha y_t,\\qquad \\hat{y}_{t+1|t} = \\hat{x}_t + d,\n$$\n并使用一个有限的 $\\hat{x}_0$ 进行初始化。\n\n您的任务：\n- 从第一性原理出发，推导在给定模型下，使稳态单步预测均方误差 $E\\left[(y_{t+1} - \\hat{y}_{t+1|t})^2\\right]$ 最小化的遗忘因子 $\\alpha^\\star$ 的值。您的推导应从线性高斯系统的最小均方误差原理和标量离散时间代数Riccati方程开始。不要假设任何预先给定的 $\\alpha^\\star$ 最终公式；相反，应将其作为模型假设的推论来导出。\n- 实现一个程序，该程序：\n  - 计算作为 $(q,r)$ 函数的 $\\alpha^\\star$，该函数与 $d$ 无关。\n  - 按照上述规定实现 EWMA 递归。\n  - 对于下面的每个测试用例，仅报告理论上最优的 $\\alpha^\\star$。\n\n科学真实性和建模说明：\n- 推导必须从线性高斯假设下最小均方误差估计的核心定义开始，并且必须明确地将 EWMA 递归与给定模型的最优线性估计器的稳态形式联系起来。\n- 常数漂移 $d$ 是已知的，并应在预测器中加性地纳入；它的存在不会改变相对于先验值加权 $y_t$ 的稳态最优增益。\n\n测试套件：\n使用以下参数集。每个测试用例是一个元组 $(q,r,d,T,\\text{seed})$，其中 $T$ 是模拟长度，$\\text{seed}$ 是您可能执行的任何内部模拟的伪随机种子。所需输出不依赖于模拟，但提供这些参数是为了完整性和覆盖性。\n- 用例 A（边界，几乎静态的水平）：$(q=\\;0,\\; r=\\;1,\\; d=\\;0.05,\\; T=\\;200,\\; \\text{seed}=\\;42)$。\n- 用例 B（测量主导）：$(q=\\;0.01,\\; r=\\;1.0,\\; d=\\;0.05,\\; T=\\;200,\\; \\text{seed}=\\;1)$。\n- 用例 C（过程主导）：$(q=\\;1.0,\\; r=\\;0.01,\\; d=\\;0.0,\\; T=\\;200,\\; \\text{seed}=\\;7)$。\n- 用例 D（平衡）：$(q=\\;0.2,\\; r=\\;0.2,\\; d=\\;0.1,\\; T=\\;500,\\; \\text{seed}=\\;2024)$。\n- 用例 E（噪声测量）：$(q=\\;0.5,\\; r=\\;5.0,\\; d=\\;-0.02,\\; T=\\;200,\\; \\text{seed}=\\;99)$。\n\n答案规范：\n- 对于每个测试用例，根据给定的 $(q,r)$ 计算您的推导所隐含的单个浮点数 $\\alpha^\\star$。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。顺序必须与上面的测试套件顺序匹配。例如，输出格式应与 $[\\alpha^\\star_A,\\alpha^\\star_B,\\alpha^\\star_C,\\alpha^\\star_D,\\alpha^\\star_E]$ 完全一样，没有多余的空格或文本。\n\n此问题中没有物理单位或角度；所有数字都报告为无量纲的实数值。所有最终答案必须是浮点数。",
            "solution": "该问题要求推导指数加权移动平均 (EWMA) 预测器的最优遗忘因子 $\\alpha^\\star$。最优性的标准是在稳态下最小化单步预测均方误差。推导必须源于线性高斯系统最优估计的第一性原理。\n\n该系统由一个线性高斯状态空间模型描述：\n状态方程：$x_t = x_{t-1} + d + w_t$，其中过程噪声 $w_t \\sim \\mathcal{N}(0,q)$。\n测量方程：$y_t = x_t + v_t$，其中测量噪声 $v_t \\sim \\mathcal{N}(0,r)$。\n\n在这里，$x_t$ 是潜状态，$y_t$ 是观测值，$d$ 是一个已知的确定性漂移，$q \\ge 0$ 和 $r > 0$ 分别是过程噪声和测量噪声的方差。\n\nEWMA 预测器提供一个滤波估计值 $\\hat{x}_t$ 和一个预测值 $\\hat{y}_{t+1|t}$：\n$\\hat{x}_t = (1-\\alpha)(\\hat{x}_{t-1} + d) + \\alpha y_t$\n$\\hat{y}_{t+1|t} = \\hat{x}_t + d$\n\n此问题的基本原理是，对于一个线性高斯系统，卡尔曼滤波器提供了潜状态的最小均方误差 (MMSE) 估计。因此，最优预测器必须等价于其稳态形式的卡尔曼预测器。我们将推导给定系统的稳态卡尔曼滤波器，并将其结构与 EWMA 滤波器等同起来，以找到最优参数 $\\alpha^\\star$。\n\n**步骤1：构建卡尔曼滤波器**\n\n状态空间模型可以写成标准形式 $x_t = Fx_{t-1} + Bu_{t-1} + w_t$ 和 $y_t = Hx_t + v_t$。对于这个特定的标量系统，矩阵和输入为：\n- 状态转移矩阵：$F = 1$\n- 观测矩阵：$H = 1$\n- 控制输入矩阵：$B = 1$\n- 控制输入：$u_{t-1} = d$\n- 过程噪声方差：$Q = q$\n- 测量噪声方差：$R = r$\n\n卡尔曼滤波器分两步操作：预测和更新。设 $\\hat{x}_{t|t-1}$ 为在给定截至 $t-1$ 的观测值时对时间 $t$ 状态的先验估计，$\\hat{x}_{t|t}$ 为在并入时间 $t$ 的测量值后的后验估计。设 $P_{t|t-1}$ 和 $P_{t|t}$ 为相应的误差方差，$P_{t|t-1} = E[(x_t - \\hat{x}_{t|t-1})^2]$ 和 $P_{t|t} = E[(x_t - \\hat{x}_{t|t})^2]$。\n\n卡尔曼滤波器方程为：\n\n预测步骤：\n1.  状态预测：$\\hat{x}_{t|t-1} = F\\hat{x}_{t-1|t-1} + Bu_{t-1} = \\hat{x}_{t-1|t-1} + d$\n2.  误差协方差预测：$P_{t|t-1} = FP_{t-1|t-1}F^T + Q = P_{t-1|t-1} + q$\n\n更新步骤：\n3.  卡尔曼增益：$K_t = P_{t|t-1}H^T(HP_{t|t-1}H^T + R)^{-1} = P_{t|t-1}(P_{t|t-1} + r)^{-1}$\n4.  状态更新：$\\hat{x}_{t|t} = \\hat{x}_{t|t-1} + K_t(y_t - H\\hat{x}_{t|t-1}) = \\hat{x}_{t|t-1} + K_t(y_t - \\hat{x}_{t|t-1})$\n5.  误差协方差更新：$P_{t|t} = (I - K_tH)P_{t|t-1} = (1 - K_t)P_{t|t-1}$\n\n注意，确定性漂移 $d$ 影响状态估计，但不影响误差协方差或卡尔曼增益，这对于线性系统是标准的。\n\n**步骤2：将卡尔曼滤波器与 EWMA 滤波器联系起来**\n\n为了将卡尔曼滤波器与给定的 EWMA 递归进行比较，我们将状态预测和更新方程组合成一个关于后验估计 $\\hat{x}_{t|t}$ 的单一表达式。\n将 $\\hat{x}_{t|t-1} = \\hat{x}_{t-1|t-1} + d$ 代入状态更新方程得到：\n$\\hat{x}_{t|t} = (\\hat{x}_{t-1|t-1} + d) + K_t(y_t - (\\hat{x}_{t-1|t-1} + d))$\n重新整理各项，我们得到：\n$\\hat{x}_{t|t} = (1 - K_t)(\\hat{x}_{t-1|t-1} + d) + K_t y_t$\n\n现在，将此与 EWMA 滤波器的更新规则进行比较：\n$\\hat{x}_t = (1-\\alpha)(\\hat{x}_{t-1} + d) + \\alpha y_t$\n\n通过直接观察，卡尔曼滤波器的后验更新与 EWMA 更新具有完全相同的功能形式。对应关系是：\n- EWMA 滤波状态 $\\hat{x}_t \\Leftrightarrow$ 卡尔曼后验状态估计 $\\hat{x}_{t|t}$\n- EWMA 遗忘因子 $\\alpha \\Leftrightarrow$ 卡尔曼增益 $K_t$\n\n在卡尔曼框架中，单步预测是 $\\hat{y}_{t+1|t} = H\\hat{x}_{t+1|t} = \\hat{x}_{t|t} + d$。这也与 EWMA 预测器的定义 $\\hat{y}_{t+1|t} = \\hat{x}_t + d$ 相匹配。目标是最小化稳态均方预测误差 $E[(y_{t+1}-\\hat{y}_{t+1|t})^2]$。这个误差是 $E[((x_{t+1}-\\hat{x}_{t+1|t})+v_{t+1})^2] = E[(x_{t+1}-\\hat{x}_{t+1|t})^2] + E[v_{t+1}^2] = P_{t+1|t} + r$。最小化这个量等价于最小化预测误差方差 $P_{t+1|t}$。\n\n**步骤3：推导最优稳态遗忘因子 $\\alpha^\\star$**\n\n最优遗忘因子 $\\alpha^\\star$ 是在稳态下最小化预测误差的因子。这对应于稳态卡尔曼增益，$K = \\lim_{t\\to\\infty} K_t$。在稳态下，误差协方差收敛到常数值，$P_{t|t-1} \\to P$ 和 $P_{t|t} \\to P_{\\text{post}}$，增益也变为常数，$K_t \\to K$。\n\n稳态下的误差协方差递归方程变为：\n(i) $P = P_{\\text{post}} + q$\n(ii) $P_{\\text{post}} = (1 - K)P$\n\n将 (ii) 代入 (i)：\n$P = (1 - K)P + q$\n$P - (1-K)P = q$\n$KP = q$\n\n稳态增益 $K$ 与稳态预测方差 $P$ 的关系为：\n$K = P / (P+r)$\n这可以重新排列以用 $K$ 表示 $P$：\n$K(P+r) = P \\implies KP + Kr = P \\implies Kr = P(1-K) \\implies P = \\frac{Kr}{1-K}$ (对于 $K \\neq 1$)\n\n现在，我们将这个 $P$ 的表达式代入方程 $KP = q$：\n$K \\left(\\frac{Kr}{1-K}\\right) = q$\n$K^2 r = q(1-K)$\n$rK^2 + qK - q = 0$\n\n这是一个关于稳态卡尔曼增益 $K$ 的二次方程，也就是我们期望的最优遗忘因子 $\\alpha^\\star$。我们使用二次公式求解 $K$：\n$K = \\frac{-q \\pm \\sqrt{q^2 - 4(r)(-q)}}{2r} = \\frac{-q \\pm \\sqrt{q^2 + 4qr}}{2r}$\n\n因为遗忘因子 $\\alpha$（以及卡尔曼增益 $K$）必须是非负的（因为 $r>0, P \\ge 0$），我们必须选择正根：\n$\\alpha^\\star = K = \\frac{-q + \\sqrt{q^2 + 4qr}}{2r}$\n\n这是最优遗忘因子的最终表达式。它只是过程噪声方差 $q$ 和测量噪声方差 $r$ 的函数，正如预期的那样。推导从卡尔曼滤波器中嵌入的 MMSE 原理开始，并明确地将最优滤波器结构与 EWMA 形式联系起来，符合要求。\n\n这可以对边界情况 $q=0$ 进行验证。如果没有过程噪声，状态将确定性地演化。该公式给出 $\\alpha^\\star = (-0 + \\sqrt{0})/(2r) = 0$。这是正确的：最优滤波器应该忽略新的测量值（$\\alpha=0$），并简单地遵循确定性模型 $\\hat{x}_t = \\hat{x}_{t-1} + d$。\n对于 $r \\to 0$ 的情况（$r>0$ 不允许，但为了直观理解），$\\alpha^\\star \\to 1$，这意味着我们应该完全信任无噪声的测量。",
            "answer": "$$\n\\boxed{[0.0,0.09512492197250392,0.9901951359278453,0.6180339887498949,0.27015621187164246]}\n$$"
        },
        {
            "introduction": "现代电网分析越来越依赖于概率性预测，它提供的是一个事件（例如负荷超过阈值）发生的概率，而非单一的确定性数值。评估这类预测的质量需要专门的度量标准，其中Brier分数是一个关键指标，可进一步分解为可靠性、分辨率和不确定性三个部分，从而深入洞察预测模型的性能优劣。本练习将指导您从基本定义出发，推导并计算Brier分数的分解，让您掌握严格评估和诊断概率预测模型的关键技能。",
            "id": "4082660",
            "problem": "一个配电系统运营商为一个中压馈线上的二元事件生成日前概率性预测：晚高峰净负荷是否超过一个固定阈值。对于每一天 $t \\in \\{1,\\dots,N\\}$，预测系统输出事件发生的概率 $p_t \\in [0,1]$，而实现的二元结果为 $y_t \\in \\{0,1\\}$。您获得了一个为期 $N = 200$ 天的评估样本。为了分析校准度并分解布里尔分数（Brier score），这些预测被分成了 $K=5$ 个不重叠的概率区间，其汇总统计数据如下，其中 $p_i$ 是区间 $i$ 的代表性预测概率，$N_i$ 是区间 $i$ 内的预测次数，$e_i$ 是区间 $i$ 内观测到的超阈值事件数：\n\n- 区间 1：$p_1 = 0.05$，$N_1 = 40$，$e_1 = 4$。\n- 区间 2：$p_2 = 0.20$，$N_2 = 60$，$e_2 = 15$。\n- 区间 3：$p_3 = 0.40$，$N_3 = 50$，$e_3 = 17$。\n- 区间 4：$p_4 = 0.70$，$N_4 = 30$，$e_4 = 18$。\n- 区间 5：$p_5 = 0.90$，$N_5 = 20$，$e_5 = 18$。\n\n从布里尔分数作为概率性预测与二元结果之间均方误差的定义出发，并且仅使用基本概率定律（例如，全期望定律和全方差定律），完成以下任务：\n\n1. 通过将每个区间 $i$ 的经验条件事件频率 $\\hat{o}_i$ 表示为预测概率 $p_i$ 和区间计数的函数，为此分箱数据集推导校准曲线（可靠性图）。解释该曲线与完美校准的关系。\n\n2. 从第一性原理出发，在不引用任何未经上述概率定律和布里尔分数定义证明的结果的情况下，将此分箱数据集的布里尔分数分解为可靠性、分辨率和不确定性分量，并用 $\\{p_i, N_i, e_i\\}_{i=1}^{K}$ 表示。从概念上识别每个分量。\n\n3. 对所提供的数据，数值计算每个分量及最终的布里尔分数。\n\n在最终答案中，仅报告布里尔分数，结果为四舍五入到四位有效数字的无单位小数。",
            "solution": "所述问题需经过验证。\n\n### 步骤 1：提取已知条件\n- 一个针对二元事件 $y_t \\in \\{0, 1\\}$ 的概率性预测系统为每一天 $t$ 生成一个概率 $p_t \\in [0, 1]$。\n- 评估样本中的总天数：$N=200$。\n- 数据被分入 $K=5$ 个不重叠的概率区间。\n- 对于每个区间 $i \\in \\{1, \\dots, 5\\}$，提供了以下统计数据：\n    - $p_i$：区间 $i$ 的代表性预测概率。\n    - $N_i$：区间 $i$ 内的预测次数。\n    - $e_i$：区间 $i$ 内观测到的事件数（其中 $y_t=1$）。\n- 区间数据：\n    - 区间 1：$p_1 = 0.05$，$N_1 = 40$，$e_1 = 4$。\n    - 区间 2：$p_2 = 0.20$，$N_2 = 60$，$e_2 = 15$。\n    - 区间 3：$p_3 = 0.40$，$N_3 = 50$，$e_3 = 17$。\n    - 区间 4：$p_4 = 0.70$，$N_4 = 30$，$e_4 = 18$。\n    - 区间 5：$p_5 = 0.90$，$N_5 = 20$，$e_5 = 18$。\n- 布里尔分数被定义为预测与结果之间的均方误差。\n- 推导必须从此定义开始，并仅使用基本概率定律。\n- 任务是：(1) 推导校准曲线，(2) 推导布里尔分数分解，(3) 计算各数值分量和总布里尔分数。\n- 最终报告的答案是四舍五入到四位有效数字的数值布里尔分数。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：**该问题基于概率性预测验证的既定统计理论。布里尔分数及其在可靠性、分辨率和不确定性方面的分解是评估二元事件预测的标准工具。智能电网分析的背景是恰当且科学合理的。\n- **良态问题：**所有必要的数据（$N_i$, $p_i$, $e_i$）都已提供，足以执行所需的推导和计算。任务陈述清晰，可以得出一个唯一的布里尔分数数值答案。\n- **客观性：**问题以精确、定量的语言陈述，没有歧义或主观论断。\n- **不完整或矛盾的设置：**问题是自洽的。一致性检查确认所有区间的预测总数等于总预测数：$\\sum_{i=1}^{5} N_i = 40 + 60 + 50 + 30 + 20 = 200 = N$。每个区间中的事件数 $e_i$ 小于或等于该区间中的预测数 $N_i$，符合要求。\n- **不切实际或不可行：**所提供的数据值对于一个真实世界的预测系统评估是合理的。\n- **其他缺陷：**该问题不是病态的、伪深刻的、琐碎的或不可验证的。它要求从第一性原理进行严谨的推导，展示对该主题的基本理解。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n\n解答按问题陈述要求分三部分进行。\n\n#### 1. 校准曲线（可靠性图）\n\n对于一个特定的区间 $i$，所有 $N_i$ 次预测都由单一的概率值 $p_i$ 代表。该区间事件的经验或观测频率是观测到的事件数 $e_i$ 与该区间内总预测数 $N_i$ 的比率。我们将此经验条件事件频率表示为 $\\hat{o}_i$。\n\n$$\n\\hat{o}_i = \\frac{e_i}{N_i}\n$$\n\n校准曲线，也称为可靠性图，是每个区间的观测频率 $\\hat{o}_i$ 相对于预测概率 $p_i$ 的图。一个完美校准或可靠的预测系统将对所有 $i$ 都表现出 $\\hat{o}_i = p_i$。这样的点将位于纵坐标等于横坐标的对角线上。偏离这条对角线表明存在校准偏差。\n\n对于给定的数据，我们计算每个区间的观测频率：\n- 区间 1：$\\hat{o}_1 = \\frac{e_1}{N_1} = \\frac{4}{40} = 0.10$\n- 区间 2：$\\hat{o}_2 = \\frac{e_2}{N_2} = \\frac{15}{60} = 0.25$\n- 区间 3：$\\hat{o}_3 = \\frac{e_3}{N_3} = \\frac{17}{50} = 0.34$\n- 区间 4：$\\hat{o}_4 = \\frac{e_4}{N_4} = \\frac{18}{30} = 0.60$\n- 区间 5：$\\hat{o}_5 = \\frac{e_5}{N_5} = \\frac{18}{20} = 0.90$\n\n校准曲线由点 $(p_i, \\hat{o}_i)$ 组成：$(0.05, 0.10)$、$(0.20, 0.25)$、$(0.40, 0.34)$、$(0.70, 0.60)$ 和 $(0.90, 0.90)$。预测者似乎在低概率时预测不足（例如，区间1中 $0.10 > 0.05$），而在中高概率时预测过度（例如，区间4中 $0.60 < 0.70$）。\n\n#### 2. 布里尔分数分解推导\n\n布里尔分数（$BS$）定义为概率性预测 $p_t$ 与二元结果 $y_t$ 之间的均方误差：\n\n$$\nBS = \\frac{1}{N} \\sum_{t=1}^{N} (p_t - y_t)^2\n$$\n\n由于预测被分组到 $K$ 个区间中，我们可以将总和划分到各个区间上。在每个区间 $i$ 内，所有预测都由 $p_i$ 代表。总和变为：\n\n$$\nBS = \\frac{1}{N} \\sum_{i=1}^{K} \\sum_{t \\in \\text{bin } i} (p_i - y_t)^2\n$$\n\n对于给定的区间 $i$，有 $e_i$ 个 $y_t=1$ 的实例和 $N_i - e_i$ 个 $y_t=0$ 的实例。因此，内部求和可以明确写为：\n\n$$\n\\sum_{t \\in \\text{bin } i} (p_i - y_t)^2 = e_i (p_i - 1)^2 + (N_i - e_i) p_i^2\n$$\n\n将此代回 $BS$ 表达式中：\n\n$$\nBS = \\frac{1}{N} \\sum_{i=1}^{K} \\left[ e_i (p_i - 1)^2 + (N_i - e_i) p_i^2 \\right]\n$$\n\n为了分解它，我们通过除以并乘以 $N_i$ 来重新排列求和内的项：\n\n$$\nBS = \\frac{1}{N} \\sum_{i=1}^{K} N_i \\left[ \\frac{e_i}{N_i} (p_i - 1)^2 + \\left(1 - \\frac{e_i}{N_i}\\right) p_i^2 \\right]\n$$\n\n使用定义 $\\hat{o}_i = e_i/N_i$：\n\n$$\nBS = \\frac{1}{N} \\sum_{i=1}^{K} N_i \\left[ \\hat{o}_i (p_i^2 - 2p_i + 1) + p_i^2 - \\hat{o}_i p_i^2 \\right]\n= \\frac{1}{N} \\sum_{i=1}^{K} N_i \\left[ p_i^2 - 2p_i\\hat{o}_i + \\hat{o}_i \\right]\n$$\n\n通过在括号内加减 $\\hat{o}_i^2$，我们可以配方：\n\n$$\nBS = \\frac{1}{N} \\sum_{i=1}^{K} N_i \\left[ (p_i^2 - 2p_i\\hat{o}_i + \\hat{o}_i^2) + \\hat{o}_i - \\hat{o}_i^2 \\right]\n= \\frac{1}{N} \\sum_{i=1}^{K} N_i \\left[ (p_i - \\hat{o}_i)^2 + \\hat{o}_i(1 - \\hat{o}_i) \\right]\n$$\n\n这将表达式分为两项：\n\n$$\nBS = \\frac{1}{N} \\sum_{i=1}^{K} N_i (p_i - \\hat{o}_i)^2 + \\frac{1}{N} \\sum_{i=1}^{K} N_i \\hat{o}_i(1 - \\hat{o}_i)\n$$\n\n第一项是**可靠性**（$REL$）分量。它是每个区间中预测概率与观测频率之间平方差的加权平均值。它衡量了预测的校准度；对于一个完全可靠的预测，$p_i = \\hat{o}_i$ 对所有 $i$ 成立，且 $REL = 0$。值越低越好。\n\n$$\nREL = \\frac{1}{N} \\sum_{i=1}^{K} N_i (p_i - \\hat{o}_i)^2\n$$\n\n第二项可以通过引入总体平均结果或气候学平均值 $\\bar{o} = \\frac{1}{N} \\sum_{t=1}^N y_t = \\frac{1}{N} \\sum_{i=1}^K e_i = \\frac{1}{N} \\sum_{i=1}^K N_i \\hat{o}_i$ 来进一步分解。我们对二元结果变量 $Y$ 使用全方差定律。$Y$ 的方差是 $Var(Y) = E[(Y - E[Y])^2]$。对于平均值为 $\\bar{o}$ 的二元变量，方差是 $\\bar{o}(1-\\bar{o})$。全方差定律表明：$Var(Y) = E[Var(Y|X)] + Var(E[Y|X])$，其中 $X$ 是一个条件变量（这里是分箱的预测概率）。\n\n- 结果的总方差是**不确定性**（$UNC$），它独立于预测，仅取决于事件的内在变率。\n  $$UNC = \\bar{o}(1 - \\bar{o})$$\n\n- 项 $Var(E[Y|X])$ 表示条件期望的方差。对于我们的分箱数据，这是条件观测频率 $\\hat{o}_i$ 围绕总体平均值 $\\bar{o}$ 的加权方差。这是**分辨率**（$RES$）分量。它衡量预测将样本分解为具有不同结果频率的子样本的能力。高分辨率（$\\hat{o}_i$ 和 $\\bar{o}$ 之间的差异大）是理想的。值越高越好。\n  $$RES = \\frac{1}{N} \\sum_{i=1}^{K} N_i (\\hat{o}_i - \\bar{o})^2$$\n\n- 项 $E[Var(Y|X)]$ 是条件方差的期望值。对于我们的分箱数据，区间 $i$ 内的方差是 $\\hat{o}_i(1-\\hat{o}_i)$。期望是所有区间的加权平均值。\n  $$E[Var(Y|X)] = \\frac{1}{N} \\sum_{i=1}^{K} N_i \\hat{o}_i(1 - \\hat{o}_i)$$\n\n根据全方差定律，$E[Var(Y|X)] = UNC - RES$。将其与我们推导的 $BS$ 表达式进行比较，我们看到第二项确实是 $UNC - RES$。因此，完整的分解是：\n\n$$\nBS = REL - RES + UNC\n$$\n\n#### 3. 数值计算\n\n首先，我们计算必要的汇总统计数据。\n- 总事件数：$E = \\sum e_i = 4 + 15 + 17 + 18 + 18 = 72$。\n- 总体平均结果（气候学平均值）：$\\bar{o} = \\frac{E}{N} = \\frac{72}{200} = 0.36$。\n- 观测频率 $\\hat{o}_i$ 已在第 1 部分计算：$\\{0.10, 0.25, 0.34, 0.60, 0.90\\}$。\n\n现在，我们计算每个分量：\n\n**可靠性（$REL$）：**\n$$\nREL = \\frac{1}{200} \\left[ 40(0.05-0.10)^2 + 60(0.20-0.25)^2 + 50(0.40-0.34)^2 + 30(0.70-0.60)^2 + 20(0.90-0.90)^2 \\right]\n$$\n$$\nREL = \\frac{1}{200} \\left[ 40(-0.05)^2 + 60(-0.05)^2 + 50(0.06)^2 + 30(0.10)^2 + 20(0)^2 \\right]\n$$\n$$\nREL = \\frac{1}{200} \\left[ 40(0.0025) + 60(0.0025) + 50(0.0036) + 30(0.01) + 0 \\right]\n$$\n$$\nREL = \\frac{1}{200} \\left[ 0.1 + 0.15 + 0.18 + 0.3 \\right] = \\frac{0.73}{200} = 0.00365\n$$\n\n**分辨率（$RES$）：**\n$$\nRES = \\frac{1}{200} \\sum_{i=1}^{5} N_i (\\hat{o}_i - 0.36)^2\n$$\n$$\nRES = \\frac{1}{200} \\left[ 40(0.10-0.36)^2 + 60(0.25-0.36)^2 + 50(0.34-0.36)^2 + 30(0.60-0.36)^2 + 20(0.90-0.36)^2 \\right]\n$$\n$$\nRES = \\frac{1}{200} \\left[ 40(-0.26)^2 + 60(-0.11)^2 + 50(-0.02)^2 + 30(0.24)^2 + 20(0.54)^2 \\right]\n$$\n$$\nRES = \\frac{1}{200} \\left[ 40(0.0676) + 60(0.0121) + 50(0.0004) + 30(0.0576) + 20(0.2916) \\right]\n$$\n$$\nRES = \\frac{1}{200} \\left[ 2.704 + 0.726 + 0.02 + 1.728 + 5.832 \\right] = \\frac{11.01}{200} = 0.05505\n$$\n\n**不确定性（$UNC$）：**\n$$\nUNC = \\bar{o}(1 - \\bar{o}) = 0.36(1 - 0.36) = 0.36(0.64) = 0.2304\n$$\n\n**布里尔分数（$BS$）：**\n最后，我们使用分解式计算布里尔分数：\n$$\nBS = REL - RES + UNC = 0.00365 - 0.05505 + 0.2304 = 0.179\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nBS \\approx 0.1790\n$$\n作为验证，布里尔分数可以直接计算：\n$BS = \\frac{1}{N} \\sum_{i=1}^{K} [e_i(p_i-1)^2 + (N_i-e_i)p_i^2]$\n$BS = \\frac{1}{200} [4(-0.95)^2+36(0.05)^2 + 15(-0.8)^2+45(0.2)^2 + 17(-0.6)^2+33(0.4)^2 + 18(-0.3)^2+12(0.7)^2 + 18(-0.1)^2+2(0.9)^2]$\n$BS = \\frac{1}{200} [3.61+0.09 + 9.6+1.8 + 6.12+5.28 + 1.62+5.88 + 0.18+1.62] = \\frac{35.8}{200} = 0.179$。\n直接计算证实了分解得到的结果。该预测系统在评估期内的布里尔分数为 $0.1790$。",
            "answer": "$$\n\\boxed{0.1790}\n$$"
        }
    ]
}