{
    "hands_on_practices": [
        {
            "introduction": "Understanding how prices are formed in electricity markets is the first step toward analyzing strategic behavior. This exercise grounds your understanding in the fundamentals of Locational Marginal Pricing (LMP), where you will derive prices from first principles in a network with transmission constraints . By solving the economic dispatch problem and interpreting the dual variables, or shadow prices $\\lambda$, you will see how congestion directly creates price separation between nodes.",
            "id": "4126837",
            "problem": "An Independent System Operator (ISO) clears a two-node energy-only market using the Direct-Current (DC) power flow approximation, with no losses, under Locational Marginal Pricing (LMP). The ISO maximizes social welfare by minimizing total generation cost subject to nodal power balance and transmission constraints. Assume perfectly competitive bidding (no market power), so that each generator truthfully bids its constant marginal cost, and ignore nonconvexities such as minimum output levels and commitment.\n\nConsider nodes A and B connected by a single transmission line oriented from A to B, with symmetric thermal capacity of $50$ megawatts (MW). Nodal demands are fixed at $200$ MW at node A and $100$ MW at node B. There is one generator at each node with constant marginal costs: node A has marginal cost $30$ dollars per megawatt-hour ($/\\text{MWh}$), node B has marginal cost $40/\\text{MWh}$. Both generators have sufficiently large capacities so that no generator capacity constraints bind.\n\nUnder the DC power flow approximation, let $g_A$ and $g_B$ denote the generation at nodes A and B, $d_A = 200$ and $d_B = 100$ the demands, and $f$ the line flow from A to B. The ISO solves the cost-minimization dispatch to determine the network-constrained equilibrium. From first principles and without invoking any shortcut formulas, derive the LMPs at nodes A and B by:\n- Formulating the optimization problem with decision variables $g_A$, $g_B$, and $f$, including nodal power balance and line capacity constraints.\n- Solving for the optimal dispatch and identifying which constraints bind.\n- Using the Karush–Kuhn–Tucker (KKT) conditions to identify the dual variables that correspond to the marginal values of injections at each node, and interpreting these dual variables as the LMPs under perfectly competitive, price-taking behavior.\n\nCompute the numerical values of the LMPs at nodes A and B. Provide your final answer as a row matrix $\\begin{pmatrix}\\text{LMP}_A & \\text{LMP}_B\\end{pmatrix}$, expressed in $/\\text{MWh}$. No rounding is required; report exact values.",
            "solution": "The user wants to find the Locational Marginal Prices (LMPs) for a two-node power system by formulating and solving a DC Optimal Power Flow (DC-OPF) problem. The solution must be derived from first principles using Karush–Kuhn–Tucker (KKT) conditions.\n\n### Step 1: Problem Validation\n\n**Extraction of Givens:**\n-   **System**: A two-node energy market (nodes A and B) cleared by an Independent System Operator (ISO).\n-   **Model**: Direct-Current (DC) power flow approximation, no losses.\n-   **Pricing**: Locational Marginal Pricing (LMP).\n-   **Objective**: Maximize social welfare, equivalent to minimizing total generation cost.\n-   **Market Assumption**: Perfectly competitive bidding (generators bid their constant marginal cost).\n-   **Transmission Line**: Single line from node A to node B with a symmetric capacity of $50$ MW.\n-   **Demands**: Fixed nodal demands are $d_A = 200$ MW at node A and $d_B = 100$ MW at node B.\n-   **Generators**:\n    -   At node A: Constant marginal cost $c_A = 30/\\text{MWh}$.\n    -   At node B: Constant marginal cost $c_B = 40/\\text{MWh}$.\n    -   Both generators have sufficiently large capacities (no binding capacity constraints).\n-   **Decision Variables**: Generation at node A ($g_A$), generation at node B ($g_B$), and power flow from A to B ($f$).\n-   **Task**:\n    1.  Formulate the cost-minimization optimization problem.\n    2.  Solve for the optimal dispatch ($g_A, g_B, f$) and identify binding constraints.\n    3.  Use KKT conditions to find the dual variables corresponding to LMPs.\n    4.  Compute the numerical values for LMPs at nodes A and B ($\\text{LMP}_A, \\text{LMP}_B$).\n\n**Validation Analysis:**\nThe problem is scientifically grounded, being a standard economic dispatch problem in power systems engineering. It is based on the well-established DC-OPF model and the theory of LMPs. The problem is well-posed; it is a linear program with a clear objective function and a set of linear constraints, which guarantees a unique, stable solution. The problem statement is objective, using precise, unambiguous technical language. All necessary data ($c_A, c_B, d_A, d_B$, line capacity) are provided, and there are no internal contradictions. The setup is a classic textbook example used to illustrate the principles of congestion management and LMP calculation. Therefore, the problem is valid.\n\n### Step 2: Solution\n\n**1. Formulation of the Optimization Problem**\n\nThe ISO's objective is to minimize the total cost of generation, which is the sum of the costs from each generator. The cost is the product of the marginal cost and the amount of generation.\nThe objective function is:\n$$ \\min_{g_A, g_B, f} C(g_A, g_B) = 30 g_A + 40 g_B $$\n\nThis minimization is subject to several constraints:\n\n-   **Generation Non-negativity**: Generation must be non-negative.\n    $$ g_A \\ge 0 $$\n    $$ g_B \\ge 0 $$\n\n-   **Nodal Power Balance**: At each node, the total power injected must equal the total power withdrawn. Power injections are from generators, and withdrawals are for demand and line flows out of the node.\n    -   At node A: $g_A = d_A + f$. With $d_A = 200$, this is $g_A - f - 200 = 0$.\n    -   At node B: $g_B + f = d_B$. With $d_B = 100$, this is $g_B + f - 100 = 0$.\n\n-   **Transmission Line Capacity**: The flow $f$ from node A to node B is limited by the line's thermal capacity.\n    $$ -50 \\le f \\le 50 $$\n    This is equivalent to two inequality constraints:\n    $$ f \\le 50 $$\n    $$ f \\ge -50 \\quad (\\text{or } -f \\le 50) $$\n\nThe complete optimization problem is:\n$$ \\min_{g_A, g_B, f} \\quad 30 g_A + 40 g_B $$\nsubject to:\n\\begin{align*}\n    & g_A - f - 200 = 0 & (\\text{dual variable } \\lambda_A) \\\\\n    & g_B + f - 100 = 0 & (\\text{dual variable } \\lambda_B) \\\\\n    & f - 50 \\le 0 & (\\text{dual variable } \\mu_{AB} \\ge 0) \\\\\n    & -f - 50 \\le 0 & (\\text{dual variable } \\mu_{BA} \\ge 0) \\\\\n    & -g_A \\le 0 & (\\text{dual variable } \\eta_A \\ge 0) \\\\\n    & -g_B \\le 0 & (\\text{dual variable } \\eta_B \\ge 0)\n\\end{align*}\n\n**2. Solving for the Optimal Dispatch**\n\nFirst, consider an unconstrained \"merit-order\" dispatch where transmission limits are ignored. The total system demand is $d_A + d_B = 200 + 100 = 300$ MW. To minimize cost, the ISO would dispatch the cheaper generator at node A ($c_A = 30/\\text{MWh}$) to serve the entire load.\nThis would imply $g_A = 300$ MW and $g_B = 0$ MW.\n\nLet's check if this dispatch is feasible by calculating the required power flow.\nFrom the power balance at node A: $g_A - f - 200 = 0 \\implies 300 - f - 200 = 0 \\implies f = 100$ MW.\nThis required flow of $100$ MW from A to B exceeds the transmission line capacity of $50$ MW. Therefore, the unconstrained solution is not feasible, and the transmission line is congested in the direction from A to B.\n\nIn the optimal constrained dispatch, the flow from A to B will be at its maximum possible value to access as much of the cheap generation from node A as possible.\nSo, the binding constraint is $f \\le 50$, which means $f = 50$ MW at the optimum.\n\nWith $f = 50$ MW, we can determine the optimal generation levels from the power balance equations:\n-   At node A: $g_A = 200 + f = 200 + 50 = 250$ MW.\n-   At node B: $g_B = 100 - f = 100 - 50 = 50$ MW.\n\nThe optimal dispatch is $g_A^* = 250$ MW, $g_B^* = 50$ MW, and $f^* = 50$ MW.\nBoth $g_A^*$ and $g_B^*$ are positive, so the non-negativity constraints on generation are not binding. The flow $f^* = 50$ MW means the constraint $f \\le 50$ is binding, while the constraint $f \\ge -50$ is not binding (since $50 > -50$).\n\n**3. Deriving LMPs using KKT Conditions**\n\nThe Locational Marginal Price (LMP) at a node is the dual variable associated with the power balance constraint at that node. We use the KKT conditions for the optimization problem to find these dual variables ($\\lambda_A$ and $\\lambda_B$).\n\nThe Lagrangian function $\\mathcal{L}$ for the problem is:\n$$ \\mathcal{L} = (30 g_A + 40 g_B) - \\lambda_A(g_A - f - 200) - \\lambda_B(g_B + f - 100) + \\mu_{AB}(f - 50) + \\mu_{BA}(-f - 50) + \\eta_A(-g_A) + \\eta_B(-g_B) $$\n\nThe KKT stationarity conditions require the partial derivatives of the Lagrangian with respect to the decision variables to be zero at the optimum:\n\\begin{align*}\n    \\frac{\\partial \\mathcal{L}}{\\partial g_A} &= 30 - \\lambda_A - \\eta_A = 0 \\\\\n    \\frac{\\partial \\mathcal{L}}{\\partial g_B} &= 40 - \\lambda_B - \\eta_B = 0 \\\\\n    \\frac{\\partial \\mathcal{L}}{\\partial f} &= \\lambda_A - \\lambda_B + \\mu_{AB} - \\mu_{BA} = 0\n\\end{align*}\n\nThe KKT complementary slackness conditions are:\n\\begin{align*}\n    \\mu_{AB}(f - 50) &= 0 \\\\\n    \\mu_{BA}(-f - 50) &= 0 \\\\\n    \\eta_A(-g_A) &= 0 \\implies \\eta_A g_A = 0 \\\\\n    \\eta_B(-g_B) &= 0 \\implies \\eta_B g_B = 0\n\\end{align*}\n\nNow we use our optimal dispatch solution ($g_A^* = 250$, $g_B^* = 50$, $f^* = 50$) to solve for the dual variables:\n\n-   Since $g_A^* = 250 > 0$, the complementary slackness condition $\\eta_A g_A = 0$ implies $\\eta_A = 0$.\n-   Since $g_B^* = 50 > 0$, the complementary slackness condition $\\eta_B g_B = 0$ implies $\\eta_B = 0$.\n-   Since $f^* = 50$, the constraint $-f - 50 \\le 0$ becomes $-50 - 50 = -100 < 0$, which is non-binding. Thus, its dual variable must be zero: $\\mu_{BA} = 0$.\n-   Since $f^* = 50$, the constraint $f - 50 \\le 0$ is binding. Its dual variable $\\mu_{AB}$ can be non-zero ($\\mu_{AB} \\ge 0$).\n\nSubstitute $\\eta_A=0$ into the first stationarity condition:\n$$ 30 - \\lambda_A - 0 = 0 \\implies \\lambda_A = 30 $$\nThus, the LMP at node A is $\\text{LMP}_A = \\lambda_A = 30/\\text{MWh}$.\n\nSubstitute $\\eta_B=0$ into the second stationarity condition:\n$$ 40 - \\lambda_B - 0 = 0 \\implies \\lambda_B = 40 $$\nThus, the LMP at node B is $\\text{LMP}_B = \\lambda_B = 40/\\text{MWh}$.\n\nWe can check for consistency using the third stationarity condition:\n$$ \\lambda_A - \\lambda_B + \\mu_{AB} - \\mu_{BA} = 0 $$\n$$ 30 - 40 + \\mu_{AB} - 0 = 0 \\implies \\mu_{AB} = 10 $$\nSince $\\mu_{AB} = 10 \\ge 0$, this is consistent with the KKT conditions. The value $\\mu_{AB}=10/\\text{MWh}$ represents the congestion rent of the transmission line.\n\nThe interpretation is that the price at each node is set by the marginal cost of supplying the next megawatt of energy to that node. At node A, an additional MW can be supplied by the local generator at a cost of $30/\\text{MWh}$. At node B, since the cheaper power from A is unavailable due to congestion, an additional MW must be supplied by the local, more expensive generator, setting the price at its marginal cost of $40/\\text{MWh}$.\n\nThe final numerical values are $\\text{LMP}_A = 30/\\text{MWh}$ and $\\text{LMP}_B = 40/\\text{MWh}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n30 & 40\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having established how prices are set in a competitive market, we now shift our focus to strategic interactions among firms. This practice introduces the Cournot model, a foundational game-theoretic framework where firms compete by choosing output quantities to maximize their individual profits, $\\pi_i$ . Deriving the Nash equilibrium will illustrate how oligopolistic competition leads to outcomes that differ significantly from the perfectly competitive ideal.",
            "id": "4126859",
            "problem": "A single-node electricity market clears one trading interval through non-cooperative quantity competition among identical thermal generators. The inverse market demand is linear, given by $P(Q) = a - b Q$, where $P$ is the market-clearing price in $/\\text{MWh}$ and $Q$ is the total supplied power in $\\mathrm{MW}$ during the interval. There are $N=3$ identical firms. Each firm $i \\in \\{1,2,3\\}$ chooses a quantity $q_i \\in [0,\\bar{q}]$ simultaneously to maximize profit $\\pi_i = \\left(P(Q) - c\\right) q_i$ subject to its capacity constraint, where $Q = \\sum_{j=1}^{3} q_j$. The cost structure has constant marginal cost $c$ and no fixed cost. The parameters are $a = 100 \\$/\\text{MWh}$, $b = 0.1 \\$/(\\text{MWh}\\cdot\\text{MW})$, $c = 20 \\$/\\text{MWh}$, and per-firm capacity $\\bar{q} = 300$ $\\mathrm{MW}$.\n\nTasks:\n1. Starting from the definition of profit maximization under Cournot competition and the linear inverse demand, derive the first-order condition for an interior best response for a representative firm and obtain the symmetric interior Cournot equilibrium candidate $(q_1^{\\ast},q_2^{\\ast},q_3^{\\ast})$ and $P^{\\ast}$.\n2. Verify whether the interior solution respects the capacity constraints for each firm. If any constraint binds, determine the capacity-constrained equilibrium consistent with the firms’ best responses and market clearing, and compute the corresponding $P^{\\ast}$.\n3. State the equilibrium quantities and price you find, and confirm whether capacities bind.\n\nReport only the final equilibrium price $P^{\\ast}$ as your final numeric answer, expressed in $/\\text{MWh}$ and rounded to four significant figures.",
            "solution": "The problem is first validated to ensure it is well-posed, scientifically grounded, and self-contained.\n\n**Step 1: Extract Givens**\n- Inverse market demand: $P(Q) = a - b Q$\n- Total supplied power: $Q = \\sum_{j=1}^{3} q_j$\n- Number of identical firms: $N=3$\n- Individual firm quantity: $q_i \\in [0, \\bar{q}]$\n- Profit function for firm $i$: $\\pi_i = \\left(P(Q) - c\\right) q_i$\n- Marginal cost: $c = 20/\\text{MWh}$ (constant)\n- Capacity per firm: $\\bar{q} = 300$ $\\mathrm{MW}$\n- Parameter $a$: $a = 100/\\text{MWh}$\n- Parameter $b$: $b = 0.1/(\\text{MWh}\\cdot\\text{MW})$\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes a Cournot competition model, a standard and fundamental concept in microeconomics and game theory, commonly applied to model strategic interactions in oligopolistic markets, including electricity markets. The assumptions of linear demand and constant marginal costs are standard for tractable analysis.\n- **Well-Posed**: The problem is well-posed. It asks for the Nash equilibrium of a game with concave profit functions and linear constraints. Such a problem structure generally ensures the existence and uniqueness of an equilibrium, and the problem explicitly requires handling capacity constraints.\n- **Objective**: The problem is stated using precise, objective mathematical and economic terminology.\n- **Completeness and Consistency**: The problem provides all necessary functions, parameters, and constraints to determine a unique solution. The units are consistent. For example, $bQ$ has units of $(\\$/(\\text{MWh}\\cdot\\text{MW})) \\cdot \\text{MW} = \\$/\\text{MWh}$, which matches the units of $P$ and $a$.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A solution will be derived.\n\nThe problem asks for the symmetric Cournot-Nash equilibrium for $N=3$ identical firms. Each firm $i$ chooses its production quantity $q_i$ to maximize its profit $\\pi_i$, taking the quantities of other firms, $Q_{-i} = \\sum_{j \\neq i} q_j$, as given.\n\nThe profit function for firm $i$ is:\n$$\n\\pi_i(q_i, Q_{-i}) = \\left( P(q_i + Q_{-i}) - c \\right) q_i\n$$\nSubstituting the linear inverse demand function $P(Q) = a - bQ$:\n$$\n\\pi_i(q_i, Q_{-i}) = \\left( a - b(q_i + Q_{-i}) - c \\right) q_i\n$$\nThis can be expanded to:\n$$\n\\pi_i(q_i, Q_{-i}) = (a - c)q_i - b Q_{-i} q_i - b q_i^2\n$$\nTo find the best response for firm $i$, we first assume an interior solution where $0 < q_i < \\bar{q}$ and take the first-order derivative of the profit function with respect to $q_i$. We then set this derivative to zero:\n$$\n\\frac{\\partial \\pi_i}{\\partial q_i} = a - c - b Q_{-i} - 2b q_i = 0\n$$\nThe second derivative is $\\frac{\\partial^2 \\pi_i}{\\partial q_i^2} = -2b$. Since $b = 0.1 > 0$, the second derivative is negative, confirming that the profit function is strictly concave in $q_i$ and the first-order condition yields a maximum.\n\nSolving the first-order condition for $q_i$ gives firm $i$'s best response (or reaction) function:\n$$\nq_i(Q_{-i}) = \\frac{a - c - b Q_{-i}}{2b}\n$$\nIn a symmetric Nash equilibrium, all firms produce the same quantity, so $q_i = q^{\\ast}$ for all $i \\in \\{1, 2, 3\\}$. For any given firm $i$, the total quantity produced by its competitors is $Q_{-i} = (N-1)q^{\\ast}$. Substituting this into the best response function:\n$$\nq^{\\ast} = \\frac{a - c - b (N-1)q^{\\ast}}{2b}\n$$\nNow, we solve for $q^{\\ast}$:\n$$\n2b q^{\\ast} = a - c - b(N-1)q^{\\ast}\n$$\n$$\n2b q^{\\ast} + b(N-1)q^{\\ast} = a - c\n$$\n$$\nb q^{\\ast} (2 + N - 1) = a - c\n$$\n$$\nb q^{\\ast} (N+1) = a - c\n$$\nThe symmetric interior Cournot equilibrium quantity is:\n$$\nq^{\\ast} = \\frac{a-c}{b(N+1)}\n$$\nThis is the candidate for the equilibrium quantity for each firm. We substitute the given parameter values: $a = 100$, $b = 0.1$, $c = 20$, and $N = 3$.\n$$\nq^{\\ast} = \\frac{100 - 20}{0.1(3+1)} = \\frac{80}{0.1 \\times 4} = \\frac{80}{0.4} = 200 \\; \\mathrm{MW}\n$$\nThe firm capacity limit is given as $\\bar{q} = 300 \\; \\mathrm{MW}$. We must verify if the calculated interior solution respects this constraint.\n$$\nq^{\\ast} = 200 \\; \\mathrm{MW}  300 \\; \\mathrm{MW} = \\bar{q}\n$$\nSince the optimal unconstrained quantity $q^{\\ast}$ is less than the capacity limit $\\bar{q}$, the capacity constraint is not binding for any firm. Therefore, the interior solution is the valid equilibrium.\n\nThe equilibrium quantities are $(q_1^{\\ast}, q_2^{\\ast}, q_3^{\\ast}) = (200, 200, 200)$ MW. The capacities do not bind.\n\nThe total equilibrium quantity supplied to the market is:\n$$\nQ^{\\ast} = \\sum_{j=1}^{3} q_j^{\\ast} = N q^{\\ast} = 3 \\times 200 = 600 \\; \\mathrm{MW}\n$$\nThe corresponding market-clearing price is found by substituting $Q^{\\ast}$ into the inverse demand function:\n$$\nP^{\\ast} = P(Q^{\\ast}) = a - b Q^{\\ast}\n$$\n$$\nP^{\\ast} = 100 - 0.1 \\times 600 = 100 - 60 = 40 \\; \\$/\\text{MWh}\n$$\nThe final equilibrium price is $40/\\text{MWh}$. The problem asks for the answer to be rounded to four significant figures.\n\nFinal equilibrium price: $P^{\\ast} = 40.00/\\text{MWh}$.",
            "answer": "$$\n\\boxed{40.00}\n$$"
        },
        {
            "introduction": "This final practice synthesizes the concepts of nodal pricing and strategic behavior to explore a classic form of exercising market power. You will model and quantify the impact of strategic capacity withholding, where a generator purposefully limits its available output to drive up market prices . By comparing the market outcomes with and without this strategic action, you will gain concrete insight into the incentives for withholding and its effect on generator profit.",
            "id": "4126869",
            "problem": "Consider a two-node electricity network modeled using the Direct Current Optimal Power Flow (DC-OPF) formulation, with one transmission line connecting node $1$ to node $2$. Let the net demand be $d_1 = 300$ megawatts (MW) at node $1$ and $d_2 = 200$ MW at node $2$. The transmission line has a symmetric thermal limit of $F = 100$ MW in magnitude; denote the directed flow variable from node $1$ to node $2$ by $f$, and impose $-F \\leq f \\leq F$. There are three generators:\n- Generator $1$ at node $1$ with constant marginal cost $c_1 = 25$ dollars per megawatt-hour ($/\\text{MWh}$), and no upper capacity limit.\n- Generator $2$ at node $2$ with constant marginal cost $c_2 = 35 \\$/\\text{MWh}$. Initially, assume a sufficiently large upper capacity so it does not bind. Under strategic withholding, generator $2$ reduces its available capacity by $50$ MW.\n- A peaking generator $3$ at node $2$ with constant marginal cost $c_3 = 100 \\$/\\text{MWh}$, representing the next available technology, with no upper capacity limit.\n\nAssume a single-period market clearing with no losses and no other constraints. The system operator clears the market by minimizing total variable generation cost subject to nodal power balance and transmission limits. Locational Marginal Prices (LMPs) at nodes are defined as the Lagrange multipliers on the nodal power balance constraints in the DC-OPF.\n\nTasks:\n1. Formulate the DC-OPF and, starting from first principles, derive the Karush–Kuhn–Tucker (KKT) conditions that characterize optimal dispatch and Locational Marginal Prices (LMPs).\n2. Compute the optimal dispatch and the LMPs $\\text{LMP}_1$ and $\\text{LMP}_2$ in the baseline (no withholding) case.\n3. Model the withholding by imposing an upper capacity constraint $g_2 \\leq 50$ MW on generator $2$, and recompute the optimal dispatch and LMPs $\\text{LMP}_1$ and $\\text{LMP}_2$.\n4. Compute the change in profit for generator $2$ between the baseline and the withholding case. Profit is defined as revenue minus variable cost, i.e., $\\pi_2 = \\text{LMP}_2 \\cdot g_2 - c_2 \\cdot g_2$.\n\nReport your final results as a single row vector in the following order: baseline $\\text{LMP}_1$, baseline $\\text{LMP}_2$, withholding-case $\\text{LMP}_1$, withholding-case $\\text{LMP}_2$, and the profit change for generator $2$. Express all LMPs in $/\\text{MWh}$ and express the profit change in $/\\text{h}$. Provide exact numerical values; no rounding is required.",
            "solution": "The problem is a well-defined exercise in electricity market analysis using the Direct Current Optimal Power Flow (DC-OPF) model. It is scientifically grounded, internally consistent, and contains all necessary information to find a unique solution. Therefore, the problem is deemed valid.\n\n### Step 1: DC-OPF Formulation and KKT Conditions\n\nThe objective of the system operator is to minimize the total cost of generation, which is a linear function of the generation outputs $g_1, g_2, g_3$. The optimization variables are the generation levels $g_1, g_2, g_3$ (in MW) and the power flow $f$ (in MW) from node $1$ to node $2$.\n\n**Objective Function:**\nMinimize the total generation cost $C$:\n$$ \\min_{g_1, g_2, g_3, f} C = c_1 g_1 + c_2 g_2 + c_3 g_3 $$\nwhere $c_1=25$, $c_2=35$, and $c_3=100$ are the marginal costs in $/\\text{MWh}$.\n\n**Constraints:**\n1.  **Nodal Power Balance at Node 1:** The power generated at node $1$ must supply the local demand $d_1$ and the power exported, $f$.\n    $$ g_1 - d_1 - f = 0 \\quad : \\quad \\text{LMP}_1 $$\n2.  **Nodal Power Balance at Node 2:** The power generated at node $2$ plus the power imported, $f$, must supply the local demand $d_2$.\n    $$ g_2 + g_3 - d_2 + f = 0 \\quad : \\quad \\text{LMP}_2 $$\n3.  **Transmission Line Limits:** The flow $f$ is bounded by the line capacity $F$.\n    $$ f - F \\leq 0 \\quad : \\quad \\mu_{\\text{max}} $$\n    $$ -f - F \\leq 0 \\quad : \\quad \\mu_{\\text{min}} $$\n4.  **Generation Non-negativity:** Generation levels cannot be negative.\n    $$ -g_1 \\leq 0 \\quad : \\quad \\nu_1 $$\n    $$ -g_2 \\leq 0 \\quad : \\quad \\nu_2 $$\n    $$ -g_3 \\leq 0 \\quad : \\quad \\nu_3 $$\n\nThe Lagrange multipliers for the nodal power balance constraints are the Locational Marginal Prices (LMPs). The multipliers $\\mu_{\\text{max}}$, $\\mu_{\\text{min}}$, $\\nu_1, \\nu_2, \\nu_3$ must be non-negative.\n\nThe Lagrangian function $\\mathcal{L}$ for this optimization problem is:\n$$ \\mathcal{L} = (c_1 g_1 + c_2 g_2 + c_3 g_3) - \\text{LMP}_1(g_1 - d_1 - f) - \\text{LMP}_2(g_2 + g_3 - d_2 + f) + \\mu_{\\text{max}}(f-F) + \\mu_{\\text{min}}(-f-F) - \\nu_1 g_1 - \\nu_2 g_2 - \\nu_3 g_3 $$\n\nThe Karush-Kuhn-Tucker (KKT) conditions for optimality are:\n\n**1. Stationarity (derivatives of $\\mathcal{L}$ w.r.t. primal variables are zero):**\n$$ \\frac{\\partial \\mathcal{L}}{\\partial g_1} = c_1 - \\text{LMP}_1 - \\nu_1 = 0 \\implies \\text{LMP}_1 = c_1 - \\nu_1 $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial g_2} = c_2 - \\text{LMP}_2 - \\nu_2 = 0 \\implies \\text{LMP}_2 = c_2 - \\nu_2 $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial g_3} = c_3 - \\text{LMP}_2 - \\nu_3 = 0 \\implies \\text{LMP}_2 = c_3 - \\nu_3 $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial f} = \\text{LMP}_1 - \\text{LMP}_2 + \\mu_{\\text{max}} - \\mu_{\\text{min}} = 0 \\implies \\text{LMP}_2 - \\text{LMP}_1 = \\mu_{\\text{max}} - \\mu_{\\text{min}} $$\n\n**2. Primal Feasibility:** All constraints must be satisfied.\n\n**3. Dual Feasibility:** All inequality multipliers must be non-negative.\n$$ \\mu_{\\text{max}} \\geq 0, \\quad \\mu_{\\text{min}} \\geq 0, \\quad \\nu_1 \\geq 0, \\quad \\nu_2 \\geq 0, \\quad \\nu_3 \\geq 0 $$\n\n**4. Complementary Slackness:**\n$$ \\mu_{\\text{max}}(f-F) = 0 $$\n$$ \\mu_{\\text{min}}(-f-F) = 0 $$\n$$ \\nu_1 g_1 = 0, \\quad \\nu_2 g_2 = 0, \\quad \\nu_3 g_3 = 0 $$\n\nFrom these conditions, if a generator $i$ is dispatched ($g_i  0$), then $\\nu_i=0$, and its marginal cost sets or is below the LMP at its node (e.g., $\\text{LMP}_1 = c_1$). If the LMP is greater than the generator's cost, the generator is \"inframarginal\". The marginal generator sets the LMP. If the line is not congested ($-F  f  F$), then $\\mu_{\\text{max}} = \\mu_{\\text{min}} = 0$, implying $\\text{LMP}_1 = \\text{LMP}_2$.\n\n### Step 2: Optimal Dispatch and LMPs (Baseline Case)\n\nGiven data: $d_1 = 300$ MW, $d_2 = 200$ MW, $F=100$ MW, $c_1=25/\\text{MWh}$, $c_2=35/\\text{MWh}$, $c_3=100/\\text{MWh}$. Total demand is $d_1+d_2=500$ MW.\n\nFirst, consider an unconstrained transmission scenario. The cheapest generator is G1 ($c_1=25$), which would serve all $500$ MW. This would require $g_1=500$, $g_2=0$, $g_3=0$. The power flow would be $f = g_1 - d_1 = 500 - 300 = 200$ MW. This flow $f=200$ MW exceeds the limit $F=100$ MW. Therefore, the transmission line is congested.\n\nWith a congested line, flow is limited to the maximum capacity in the direction of economic benefit (from low-cost G1 to the load at node 2). Thus, $f = F = 100$ MW.\n\nWe solve the nodal power balances with $f=100$:\n- **Node 1:** $g_1 - d_1 = f \\implies g_1 - 300 = 100 \\implies g_1 = 400$ MW.\n- **Node 2:** $g_2 + g_3 - d_2 = -f \\implies g_2 + g_3 - 200 = -100 \\implies g_2 + g_3 = 100$ MW.\n\nNow, we determine the generation and LMPs at each node:\n- At node 1, G1 must produce $400$ MW. Since $g_1  0$, G1 is dispatched and sets the price at node 1.\n  $$ \\text{LMP}_1 = c_1 = 25 \\text{ }/\\text{MWh} $$\n- At node 2, a total of $100$ MW must be generated. The available generators are G2 ($c_2=35$) and G3 ($c_3=100$). To minimize cost, the system dispatches the cheaper generator, G2.\n  $$ g_2 = 100 \\text{ MW}, \\quad g_3 = 0 \\text{ MW} $$\n  Since $g_2  0$ and it is the most expensive generator running at node 2, it is the marginal unit.\n  $$ \\text{LMP}_2 = c_2 = 35 \\text{ }/\\text{MWh} $$\n\nThe line is congested from node 1 to 2, so we expect $\\text{LMP}_2  \\text{LMP}_1$. Indeed, $35  25$. The congestion rent (shadow price of the constraint) is $\\mu_{\\text{max}} = \\text{LMP}_2 - \\text{LMP}_1 = 35 - 25 = 10/\\text{MWh}$.\n\n**Baseline results:**\n- Dispatch: $g_1=400$ MW, $g_2=100$ MW, $g_3=0$ MW.\n- LMPs: $\\text{LMP}_{1, \\text{base}} = 25/\\text{MWh}$, $\\text{LMP}_{2, \\text{base}} = 35/\\text{MWh}$.\n\n### Step 3: Optimal Dispatch and LMPs (Withholding Case)\n\nA new constraint is added: $g_2 \\leq 50$ MW.\n\nThe economic incentive is still to send maximum power from the cheap node 1 to node 2. We assume the line remains congested at its limit, $f = F = 100$ MW. This assumption will be verified by the resulting prices ($\\text{LMP}_2  \\text{LMP}_1$).\n\nThe nodal balances are unchanged:\n- **Node 1:** $g_1 = 400$ MW.\n- **Node 2:** $g_2 + g_3 = 100$ MW.\n\nDispatch and LMPs:\n- At node 1, generation and price remain the same. G1 is dispatched and is not capacity constrained.\n  $$ g_1 = 400 \\text{ MW}, \\quad \\text{LMP}_1 = c_1 = 25 \\text{ }/\\text{MWh} $$\n- At node 2, we need $100$ MW. G2 ($c_2=35$) is dispatched first, but only up to its new limit of $50$ MW.\n  $$ g_2 = 50 \\text{ MW} $$\n  The remaining $100 - 50 = 50$ MW must be supplied by the next cheapest generator, G3 ($c_3=100$).\n  $$ g_3 = 50 \\text{ MW} $$\n- At node 2, G3 is now the marginal unit setting the price, as it is the most expensive unit dispatched to meet demand.\n  $$ \\text{LMP}_2 = c_3 = 100 \\text{ }/\\text{MWh} $$\n\nOur assumption of congestion is valid, as $\\text{LMP}_2 = 100  \\text{LMP}_1 = 25$. The congestion rent is now $\\mu_{\\text{max}} = 100 - 25 = 75/\\text{MWh}$.\n\n**Withholding case results:**\n- Dispatch: $g_1=400$ MW, $g_2=50$ MW, $g_3=50$ MW.\n- LMPs: $\\text{LMP}_{1, \\text{withhold}} = 25/\\text{MWh}$, $\\text{LMP}_{2, \\text{withhold}} = 100/\\text{MWh}$.\n\n### Step 4: Change in Profit for Generator 2\n\nProfit for generator 2, $\\pi_2$, is defined as revenue minus variable cost: $\\pi_2 = (\\text{LMP}_2 - c_2) \\cdot g_2$.\n\n**Baseline Profit ($\\pi_{2, \\text{base}}$):**\n- In the baseline case, $g_{2, \\text{base}} = 100$ MW and $\\text{LMP}_{2, \\text{base}} = 35/\\text{MWh}$. The marginal cost is $c_2=35/\\text{MWh}$.\n- $\\pi_{2, \\text{base}} = (35 - 35) \\cdot 100 = 0/\\text{h}$.\n- This is expected, as G2 was the price-setting marginal unit and thus earns zero producer surplus.\n\n**Withholding Profit ($\\pi_{2, \\text{withhold}}$):**\n- In the withholding case, $g_{2, \\text{withhold}} = 50$ MW and $\\text{LMP}_{2, \\text{withhold}} = 100/\\text{MWh}$. The marginal cost is $c_2=35/\\text{MWh}$.\n- $\\pi_{2, \\text{withhold}} = (100 - 35) \\cdot 50 = 65 \\cdot 50 = 3250/\\text{h}$.\n- G2 is now an \"inframarginal\" unit, selling its power at a price set by a more expensive generator, leading to substantial profit.\n\n**Change in Profit ($\\Delta \\pi_2$):**\n- The change in profit is the difference between the withholding and baseline profits.\n- $\\Delta \\pi_2 = \\pi_{2, \\text{withhold}} - \\pi_{2, \\text{base}} = 3250 - 0 = 3250/\\text{h}$.\n\nFinal results to be reported are:\n- Baseline $\\text{LMP}_1 = 25$\n- Baseline $\\text{LMP}_2 = 35$\n- Withholding-case $\\text{LMP}_1 = 25$\n- Withholding-case $\\text{LMP}_2 = 100$\n- Profit change for G2 = $3250$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n25  35  25  100  3250\n\\end{pmatrix}\n}\n$$"
        }
    ]
}