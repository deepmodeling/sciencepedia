{
    "hands_on_practices": [
        {
            "introduction": "本练习将带您回到所有市场的核心基本原理：供需均衡。通过一个简化的、基于智能合约的微电网市场模型，您将练习如何聚合供给和需求曲线，以计算出交易能源市场的两个最关键的输出——统一的出清价格和总交易量。这个基础计算是理解任何交易能源平台运作方式的第一步。",
            "id": "4072829",
            "problem": "一个分布式能源（DER）微电网在一个持续时间为 $1$ 小时的单一结算周期内，运行一个基于区块链的交易能源平台。该平台使用部署在分布式账本技术（DLT）上的智能合约（SC）来结算产消者和消费者之间的连续双向拍卖。在单母线、无损网络的假设下，位置边际电价（LMP）对所有参与者都是统一的，并且基尔霍夫电流定律意味着一个功率平衡约束，即在结算价格下，总供给等于总需求。智能合约强制要求出价为单调的供给和需求计划，并执行一个以福利最大化为目标的统一价格结算，同时要求交易量为非负。\n\n有 $3$ 个产消者，其供给计划为 $S_1(p)=2p$、$S_2(p)=p+1$、$S_3(p)=3$，表示以 $\\text{MWh}$ 为单位的供给能量，是统一价格 $p$（单位为 $\\$/\\text{MWh}$）的函数。有 $2$ 个消费者，其需求计划为 $D_1(p)=5-2p$ 和 $D_2(p)=4-p$，表示以 $\\text{MWh}$ 为单位的需求能量，是相同统一价格 $p$ 的函数。\n\n假设：(i) 无网络损耗，(ii) 无交易或结算费用，(iii) $p \\ge 0$，以及 (iv) 智能合约以唯一价格 $p^{\\ast}$ 进行结算，在该价格下总供给等于总需求，且由 $p^{\\ast}$ 决定的所有个体交易量均为非负。\n\n从能量平衡原理和计划的单调性出发，以闭合形式推导出结算价格 $p^{\\ast}$ 和总交易量 $Q^{\\ast}$。提供精确值，不要四舍五入。结算价格以 $\\$/\\text{MWh}$ 表示，总交易量以 $\\text{MWh}$ 表示。",
            "solution": "首先对问题进行验证。\n\n**步骤 1：提取已知条件**\n- 结算周期时长：$1$ 小时。\n- 平台：基于区块链的交易能源平台，使用部署在分布式账本技术（DLT）上的智能合约（SC）。\n- 拍卖机制：连续双向拍卖，以统一价格结算。\n- 网络模型：单母线、无损。\n- 定价模型：统一的位置边际电价（LMP），用 $p$ 表示，单位为 $\\$/\\text{MWh}$。\n- 主导原则：功率平衡约束（来自基尔霍夫电流定律），总供给等于总需求。\n- 产消者供给计划（能量单位为 $\\text{MWh}$）：\n  - $S_1(p) = 2p$\n  - $S_2(p) = p+1$\n  - $S_3(p) = 3$\n- 消费者需求计划（能量单位为 $\\text{MWh}$）：\n  - $D_1(p) = 5-2p$\n  - $D_2(p) = 4-p$\n- 假设：\n  - (i) 无网络损耗。\n  - (ii) 无交易或结算费用。\n  - (iii) 价格为非负，$p \\ge 0$。\n  - (iv) 智能合约以唯一价格 $p^{\\ast}$ 进行结算，在该价格下总供给等于总需求，且所有个体交易量均为非负。\n- 目标：以闭合形式推导结算价格 $p^{\\ast}$ 和总交易量 $Q^{\\ast}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，借鉴了微观经济学（供需平衡、市场出清）和电气工程（电力系统建模）的既定原则。在区块链上实施的交易能源市场概念是能源系统当前的一个研究领域，所提出的模型虽然经过简化（例如，无损、单母线），却是从基础层面分析此类系统的标准方法。该问题是适定的；它提供了确定唯一解所需的所有数学函数和约束条件。给定的供给和需求计划是线性的，这通常会导向一个唯一的市场出清点。问题陈述客观，术语精确。它没有科学缺陷、矛盾或含糊之处。所有假设都已明确列出。结算价格下交易量的非负性是一个需要验证的条件，但它不会使问题变得不适定。\n\n**步骤 3：结论与行动**\n问题被判定为有效。将推导解答。\n\n市场出清的核心原则是市场均衡，即产消者供应的总能量等于消费者需求的总能量。这个均衡点决定了统一的结算价格 $p^{\\ast}$ 和总交易量 $Q^{\\ast}$。问题指出，这是由智能合约在功率平衡约束下强制执行的。\n\n首先，我们通过将 $3$ 个产消者的个体供给计划相加来确定总供给计划 $S_{agg}(p)$：\n$$S_{agg}(p) = S_1(p) + S_2(p) + S_3(p)$$\n代入给定的函数：\n$$S_{agg}(p) = (2p) + (p+1) + 3$$\n$$S_{agg}(p) = 3p + 4$$\n这个总供给函数对于 $p \\ge 0$ 是有效的。\n\n接下来，我们通过将 $2$ 个消费者的个体需求计划相加来确定总需求计划 $D_{agg}(p)$：\n$$D_{agg}(p) = D_1(p) + D_2(p)$$\n代入给定的函数：\n$$D_{agg}(p) = (5-2p) + (4-p)$$\n$$D_{agg}(p) = 9 - 3p$$\n这个总需求函数在个体需求为非负的价格区间内有效。$D_1(p) \\ge 0$ 意味着 $5-2p \\ge 0$，即 $p \\le 2.5$。$D_2(p) \\ge 0$ 意味着 $4-p \\ge 0$，即 $p \\le 4$。因此，为使两个需求都为非负，价格必须满足 $p \\le 2.5$。\n\n市场在总供给等于总需求的价格 $p^{\\ast}$ 处出清：\n$$S_{agg}(p^{\\ast}) = D_{agg}(p^{\\ast})$$\n代入推导出的总函数：\n$$3p^{\\ast} + 4 = 9 - 3p^{\\ast}$$\n为了解出 $p^{\\ast}$，我们重新排列方程：\n$$3p^{\\ast} + 3p^{\\ast} = 9 - 4$$\n$$6p^{\\ast} = 5$$\n$$p^{\\ast} = \\frac{5}{6}$$\n\n我们现在必须验证这个结算价格是否与问题的假设一致。\n1.  价格为非负：$p^{\\ast} = \\frac{5}{6} \\ge 0$。此条件满足。\n2.  所有个体交易量均为非负。我们在 $p^{\\ast} = \\frac{5}{6}$ 处对每个参与者进行检查：\n- $S_1(\\frac{5}{6}) = 2 \\left( \\frac{5}{6} \\right) = \\frac{10}{6} = \\frac{5}{3} \\ge 0$。\n- $S_2(\\frac{5}{6}) = \\frac{5}{6} + 1 = \\frac{11}{6} \\ge 0$。\n- $S_3(\\frac{5}{6}) = 3 \\ge 0$。\n- $D_1(\\frac{5}{6}) = 5 - 2 \\left( \\frac{5}{6} \\right) = 5 - \\frac{10}{6} = 5 - \\frac{5}{3} = \\frac{15-5}{3} = \\frac{10}{3} \\ge 0$。\n- $D_2(\\frac{5}{6}) = 4 - \\frac{5}{6} = \\frac{24-5}{6} = \\frac{19}{6} \\ge 0$。\n所有个体量均为非负，且价格在需求函数的有效域内（$p^{\\ast} = \\frac{5}{6} \\approx 0.833$，小于 $2.5$）。所有条件都满足。唯一的结算价格是 $p^{\\ast} = \\frac{5}{6} \\text{ \\$/MWh}$。\n\n最后，我们通过将 $p^{\\ast}$ 代入总供给或总需求函数来计算总交易量 $Q^{\\ast}$。\n使用总供给函数：\n$$Q^{\\ast} = S_{agg}(p^{\\ast}) = 3p^{\\ast} + 4 = 3 \\left( \\frac{5}{6} \\right) + 4 = \\frac{15}{6} + 4 = \\frac{5}{2} + 4 = \\frac{5}{2} + \\frac{8}{2} = \\frac{13}{2}$$\n为了验证，我们使用总需求函数：\n$$Q^{\\ast} = D_{agg}(p^{\\ast}) = 9 - 3p^{\\ast} = 9 - 3 \\left( \\frac{5}{6} \\right) = 9 - \\frac{15}{6} = 9 - \\frac{5}{2} = \\frac{18}{2} - \\frac{5}{2} = \\frac{13}{2}$$\n两种计算得出相同的结果。总结算量为 $Q^{\\ast} = \\frac{13}{2} \\text{ MWh}$。\n\n结算价格为 $p^{\\ast} = \\frac{5}{6}$，总交易量为 $Q^{\\ast} = \\frac{13}{2}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{5}{6} & \\frac{13}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在理解了基本的市场均衡后，本实践将引导您进入更深层次的理论，即现代市场设计背后的规范性优化框架。您将学习如何将市场出清问题构建为一个社会福利最大化问题，并利用Karush-Kuhn-Tucker (KKT) 条件来推导其解。这个过程不仅能找到最优的交易结果，更重要的是，它揭示了市场价格作为经济信号的深刻内涵，即它对应于系统能量平衡约束的拉格朗日乘数（或对偶变量）。",
            "id": "4072842",
            "problem": "一个单周期、单节点的交互式能源（TE）市场通过智能合约在一个基于区块链的结算层上实现。该平台为一个总买方和一个总卖方之间的交易进行清算。总买方的效用函数 $U(d)$ 对于已清算的需求 $d \\geq 0$ 是严格凹函数，而总卖方的成本函数 $C(s)$ 对于已清算的供应 $s \\geq 0$ 是严格凸函数。在区块链上进行结算需要为每单位交易的能源支付单位协议费 $\\phi \\geq 0$，该费用由结算层消耗（即不重新分配给市场参与者），因此会减少总社会福利。\n\n假设总效用和成本是二次的：\n$$U(d) = \\alpha d - \\frac{\\beta}{2} d^{2}, \\quad \\alpha > 0, \\ \\beta > 0,$$\n$$C(s) = \\gamma s + \\frac{\\delta}{2} s^{2}, \\quad \\gamma \\geq 0, \\ \\delta > 0.$$\n\n该平台通过最大化扣除区块链结算费用后的总社会福利来清算市场，同时受能量平衡和决策非负性的约束：\n$$\\max_{s,d} \\; \\left[ U(d) - C(s) - \\phi s \\right] \\quad \\text{subject to} \\quad s - d = 0, \\ s \\geq 0, \\ d \\geq 0.$$\n\n从凸性和凹性的定义、边际效用和边际成本的解释，以及约束优化的一阶最优性框架出发，推导此市场清算问题的 Karush–Kuhn–Tucker (KKT) 条件。将与能量平衡约束相关的拉格朗日乘子解释为由智能合约在链上实现的市场价格信号，并根据 KKT 的平稳性关系证明此解释的合理性。\n\n假设参数满足 $\\alpha - \\gamma - \\phi > 0$，因此社会最优解具有严格为正的交易量。在这种内部解的情况下，求解 KKT 系统，以获得区块链清算价格 $\\lambda^{\\star}$ 作为 $(\\alpha,\\beta,\\gamma,\\delta,\\phi)$ 函数的封闭形式表达式。请以 $\\lambda^{\\star}$ 的单一解析表达式形式提供最终答案，无需进行数值计算。$\\lambda^{\\star}$ 的经济单位是货币/千瓦时，但您只需提供符号表达式；无需四舍五入，最终表达式也不应附加任何单位。",
            "solution": "用户提供了一个来自能源系统建模和微观经济理论领域的适定问题。获得严谨数学解所需的所有组成部分都已具备，并且该问题在科学上和数学上都是合理的。\n\n问题是通过解决一个社会福利最大化问题，来找到单节点交互式能源市场中的市场出清价格。该优化问题表述为：\n$$\n\\max_{s,d} \\; W(s,d) = U(d) - C(s) - \\phi s\n$$\n受以下约束：\n$$\ns - d = 0 \\\\\ns \\geq 0 \\\\\nd \\geq 0\n$$\n其中效用函数和成本函数由下式给出：\n$$\nU(d) = \\alpha d - \\frac{\\beta}{2} d^{2}, \\quad \\alpha > 0, \\ \\beta > 0\n$$\n$$\nC(s) = \\gamma s + \\frac{\\delta}{2} s^{2}, \\quad \\gamma \\geq 0, \\ \\delta > 0\n$$\n项 $\\phi \\geq 0$ 是单位交易费用。目标函数 $W(s,d)$ 代表总社会福利，即买方的效用减去卖方的生产成本和结算费用。由于 $U(d)$ 是严格凹的（其二阶导数 $U''(d) = -\\beta  0$）并且 $-C(s)$ 是严格凹的（其二阶导数 $-C''(s) = -\\delta  0$），目标函数 $W(s,d)$ 在 $(s,d)$ 上是严格凹的。约束条件定义了一个凸集。这是一个凸优化问题，保证了唯一解的存在。\n\n为了推导 Karush–Kuhn–Tucker (KKT) 条件，我们首先构建拉格朗日函数。为了使拉格朗日乘子与价格的经济解释保持一致，我们将能量平衡约束写为 $d - s = 0$。我们将拉格朗日乘子 $\\lambda$ 与此等式约束相关联，并将乘子 $\\mu_s$ 和 $\\mu_d$ 分别与非负约束 $-s \\leq 0$ 和 $-d \\leq 0$ 相关联。\n\n拉格朗日函数 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L}(s, d, \\lambda, \\mu_s, \\mu_d) = U(d) - C(s) - \\phi s - \\lambda(d-s) - \\mu_s(-s) - \\mu_d(-d)\n$$\n代入给定的函数：\n$$\n\\mathcal{L}(s, d, \\lambda, \\mu_s, \\mu_d) = \\left(\\alpha d - \\frac{\\beta}{2} d^{2}\\right) - \\left(\\gamma s + \\frac{\\delta}{2} s^{2}\\right) - \\phi s - \\lambda(d-s) + \\mu_s s + \\mu_d d\n$$\n\nKKT 条件由平稳性、原始可行性、对偶可行性和互补松弛性组成。\n\n1.  **平稳性**：拉格朗日函数关于决策变量 $s$ 和 $d$ 的偏导数在最优点 $(s^{\\star}, d^{\\star})$ 处必须为零。\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial s} = - \\frac{dC(s^{\\star})}{ds} - \\phi + \\lambda + \\mu_s = -(\\gamma + \\delta s^{\\star}) - \\phi + \\lambda + \\mu_s = 0\n    $$\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial d} = \\frac{dU(d^{\\star})}{dd} - \\lambda + \\mu_d = (\\alpha - \\beta d^{\\star}) - \\lambda + \\mu_d = 0\n    $$\n\n2.  **原始可行性**：最优解必须满足所有约束条件。\n    $$\n    d^{\\star} - s^{\\star} = 0\n    $$\n    $$\n    s^{\\star} \\geq 0\n    $$\n    $$\n    d^{\\star} \\geq 0\n    $$\n\n3.  **对偶可行性**：不等式约束的拉格朗日乘子必须为非负。\n    $$\n    \\mu_s \\geq 0\n    $$\n    $$\n    \\mu_d \\geq 0\n    $$\n\n4.  **互补松弛性**：每个不等式约束乘子与其对应松弛量的乘积必须为零。\n    $$\n    \\mu_s s^{\\star} = 0\n    $$\n    $$\n    \\mu_d d^{\\star} = 0\n    $$\n\n现在，我们来解释拉格朗日乘子 $\\lambda$。项 $\\frac{dU}{dd} = U'(d)$ 是边际效用，代表买方为额外单位能源支付的意愿。项 $\\frac{dC}{ds} = C'(s)$ 是边际成本，代表卖方生产额外单位能源的最低可接受价格。\n\n平稳性条件可以改写为：\n$$\n\\lambda + \\mu_s = C'(s^{\\star}) + \\phi = \\gamma + \\delta s^{\\star} + \\phi\n$$\n$$\n\\lambda - \\mu_d = U'(d^{\\star}) = \\alpha - \\beta d^{\\star}\n$$\n问题指定我们在一个内部解机制下操作，其中交易量严格为正，即 $s^{\\star}  0$ 且 $d^{\\star}  0$。根据互补松弛性条件，如果 $s^{\\star}  0$，则 $\\mu_s$ 必须为 $0$。如果 $d^{\\star}  0$，则 $\\mu_d$ 必须为 $0$。假设 $\\alpha - \\gamma - \\phi  0$ 确保了这种机制，因为零交易解决方案将产生零福利，而任何接近零的正交易量 $q0$ 产生的福利约为 $(\\alpha - \\gamma - \\phi)q  0$。\n\n在这个内部解的假设下（$\\mu_s=0, \\mu_d=0$），平稳性关系简化为：\n$$\n\\lambda^{\\star} = C'(s^{\\star}) + \\phi\n$$\n$$\n\\lambda^{\\star} = U'(d^{\\star})\n$$\n这为 $\\lambda^{\\star}$ 提供了一个清晰的经济解释。它是一个价格，在该价格下，买方的边际效用等于卖方的边际成本（包括交易费）。智能合约通过解决此优化问题，确定一个统一的出清价格 $\\lambda^{\\star}$ 来平衡供需。买方会一直消费，直到其边际效益 $U'(d^{\\star})$ 下降到价格 $\\lambda^{\\star}$。卖方会一直生产，直到其有效边际成本 $C'(s^{\\star}) + \\phi$ 上升到价格 $\\lambda^{\\star}$。这证明了将 $\\lambda^{\\star}$ 解释为区块链出清价格的合理性。\n\n最后，我们使用这个简化的方程组求解 $\\lambda^{\\star}$。根据能量平衡约束，令出清量为 $q^{\\star} = s^{\\star} = d^{\\star}$。\n\n根据第一个简化的平稳性方程：\n$$\n\\lambda^{\\star} = \\alpha - \\beta d^{\\star} \\implies \\beta d^{\\star} = \\alpha - \\lambda^{\\star} \\implies d^{\\star} = \\frac{\\alpha - \\lambda^{\\star}}{\\beta}\n$$\n\n根据第二个简化的平稳性方程：\n$$\n\\lambda^{\\star} = \\gamma + \\delta s^{\\star} + \\phi \\implies \\delta s^{\\star} = \\lambda^{\\star} - \\gamma - \\phi \\implies s^{\\star} = \\frac{\\lambda^{\\star} - \\gamma - \\phi}{\\delta}\n$$\n\n由于 $d^{\\star} = s^{\\star}$，我们可以令它们的表达式相等：\n$$\n\\frac{\\alpha - \\lambda^{\\star}}{\\beta} = \\frac{\\lambda^{\\star} - \\gamma - \\phi}{\\delta}\n$$\n\n我们现在求解这个关于 $\\lambda^{\\star}$ 的线性方程：\n$$\n\\delta(\\alpha - \\lambda^{\\star}) = \\beta(\\lambda^{\\star} - \\gamma - \\phi)\n$$\n$$\n\\alpha\\delta - \\delta\\lambda^{\\star} = \\beta\\lambda^{\\star} - \\beta\\gamma - \\beta\\phi\n$$\n将所有包含 $\\lambda^{\\star}$ 的项收集到一边：\n$$\n\\alpha\\delta + \\beta\\gamma + \\beta\\phi = \\beta\\lambda^{\\star} + \\delta\\lambda^{\\star}\n$$\n$$\n\\alpha\\delta + \\beta(\\gamma + \\phi) = (\\beta + \\delta)\\lambda^{\\star}\n$$\n分离出 $\\lambda^{\\star}$ 得到出清价格的封闭形式表达式：\n$$\n\\lambda^{\\star} = \\frac{\\alpha\\delta + \\beta\\gamma + \\beta\\phi}{\\beta + \\delta}\n$$\n这个表达式是在给定的二次效用/成本结构和单位交易费用下，社会最优的出清价格。",
            "answer": "$$\n\\boxed{\\frac{\\alpha\\delta + \\beta\\gamma + \\beta\\phi}{\\beta + \\delta}}\n$$"
        },
        {
            "introduction": "将能源市场部署在区块链上会引入其底层共识机制带来的独特约束。本练习探讨了区块链安全参数（如区块时间 $T_b$ 和交易最终性要求）与实时能源市场运营可行性之间的关键关系。通过分析工作量证明（PoW）链中的链重组风险，您将量化评估为了确保结算安全，市场设计者必须在结算速度和网络安全之间做出的权衡。",
            "id": "4072815",
            "problem": "一个微电网规模的交易能源平台在区块链上每隔 $\\Delta t$ 秒的结算周期执行一次市场出清。该平台要求任何提交的交易在下一次出清前达到最终性，以避免结算逆转。考虑一个工作量证明（PoW）区块链，其中每个区块要么由诚实多数产生，要么由一个对手产生。设诚实部分的比例为 $p$，对手部分的比例为 $q$，满足 $p+q=1$ 和 $0qp1$。平台将最终性定义为一笔交易获得了 $z$ 个连续区块的确认。如果一笔交易有 $z$ 个确认，则对手成功进行双花攻击的唯一方法是创建一个比当前公共链更长的替代链。区块时间是 $T_b$ 秒。为了确保及时结算，平台选择满足 $z\\,T_b \\leq \\Delta t$ 的最小整数 $z$。\n\n可靠性要求是，在 $z$ 个确认之后，对手在任何未来时间成功重组链的概率不得大于 $\\varepsilon = 1.0 \\times 10^{-6}$。\n\n基于将对手与诚实网络之间的竞赛建模为有偏随机游走的第一性原理，分析此情景。特别地，考虑 $T_b \\leq \\Delta t/3$ 的情况，并为最坏情况下的边界条件 $T_b = \\Delta t/3$（因此 $z=3$）计算最大容许的对手算力比例 $q_{\\max}$。给出 $q_{\\max}$ 的十进制小数形式，四舍五入到四位有效数字。",
            "solution": "用户希望我避免使用 Markdown 标题。\n用户希望我遵循一个严格的问题验证流程：提取已知条件、验证并陈述结论。\n如果问题无效，我必须解释其缺陷并输出 `$$\\boxed{invalid problem}$$`。\n如果问题有效，我必须提供一个完整的、有理有据的解决方案，并以特定格式给出最终答案。\n\n### 步骤1：提取已知条件\n- 结算间隔：$\\Delta t$ 秒\n- 区块链是工作量证明（PoW）。\n- 诚实挖矿比例：$p$\n- 对手挖矿比例：$q$\n- 比例的条件：$p+q=1$ 和 $0  q  p  1$。\n- 最终性定义：一笔交易在获得 $z$ 个连续确认后即为最终确认。\n- 区块时间：$T_b$ 秒\n- 选择 $z$ 的条件：平台选择满足 $z\\,T_b \\leq \\Delta t$ 的最小整数 $z$。\n- 可靠性要求：在 $z$ 个确认后，对手重组链的概率不得大于 $\\varepsilon$。\n- 可靠性目标：$\\varepsilon = 1.0 \\times 10^{-6}$。\n- 分析模型：基于区块计数差异的有偏随机游走的第一性原理。\n- 特定情景：分析 $T_b \\le \\Delta t/3$ 的情况。\n- 最坏情况边界条件：$T_b = \\Delta t/3$，这意味着 $z=3$。\n- 目标：找出最大容许的对手比例 $q_{\\max}$，使得对于 $z=3$，对手追赶上的概率 $\\leq \\varepsilon$。\n- 最终答案格式：四舍五入到四位有效数字的十进制小数。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题陈述进行评估。\n\n1.  **科学依据**：该问题在科学上是合理的。它模拟了 PoW 区块链对抗“51%攻击”或更准确地说是链重组攻击的安全性。使用有偏随机游走来模拟攻击者与诚实网络之间的竞赛是区块链技术基础文献中确立的典型方法。将其应用于交易能源平台是区块链的一个现实用例。\n\n2.  **适定性与一致性**：问题大体上是适定的，但包含一个模糊点。它指出平台选择“满足 $z\\,T_b \\leq \\Delta t$ 的最小整数 $z$”。在任何 $T_b \\le \\Delta t$ 的非平凡情况下，最小的正整数将是 $z=1$，这提供的安全性极低。然而，题目稍后指定考虑边界情况 $T_b = \\Delta t/3$ 并明确说明“（因此 $z=3$）”。这一后续的澄清意味着平台实际上选择了在时间约束 $\\Delta t$ 内所能容纳的*最大*可能整数值 $z$。如果 $T_b = \\Delta t/3$，则 $z\\,T_b \\leq \\Delta t$ 变为 $z(\\Delta t/3) \\leq \\Delta t$，简化为 $z \\le 3$。满足此条件的最大整数 $z$ 是 $3$。这种解释使问题变得一致且可解。没有这种解释，问题将因矛盾而变得不适定。我将在此合理解释下继续。所有其他条件和数据都是一致的，足以找到唯一解。\n\n3.  **客观性**：问题以精确、客观和定量的术语陈述，没有任何主观或偏颇的语言。\n\n4.  **其他缺陷**：问题没有违反任何其他标准。它不过分隐喻，与指定主题直接相关，（在上述澄清后）不不完整，且并非微不足道。\n\n### 步骤3：结论与行动\n在逻辑上解释确认数 $z$ 是满足时间约束的最大整数后，该问题被判定为**有效**。可以进行求解过程。\n\n题目要求在确认数要求为 $z=3$ 和可靠性目标为 $\\varepsilon = 1.0 \\times 10^{-6}$ 的情况下，求出最大容许的对手部分 $q_{\\max}$。\n\n问题的核心在于分析拥有集体算力比例为 $p$ 的诚实矿工与拥有算力比例为 $q$ 的对手之间的竞赛。由于在 PoW 系统中发现区块是一个无记忆的泊松过程，因此下一个区块由对手发现的概率是 $q$，由诚实网络发现的概率是 $p = 1-q$。\n\n我们将此情景建模为有偏随机游走。设系统的状态为诚实链相对于对手私有链领先的区块数。在一笔交易获得 $z$ 个确认后，诚实链领先 $z$ 个区块。如果对手能够创建一条比诚实链更长的链，那么对手就成功了，这意味着他们必须首先追上（弥合 $z$ 个区块的差距），然后反超。\n\n一个拥有 $q$ 比例算力的对手，在面对拥有 $p$ 比例算力的诚实网络时，能够从 $z$ 个区块的落后状态追赶上的概率 $\\mathcal{P}$，由经典的赌徒破产公式给出。这种情况等同于一个拥有有限资金的赌徒与一个拥有无限资金的对手进行赌博。对手是赌徒，“追赶上”即为破产。然而，在这个特定的表述中，攻击者的成功是达到零差距的状态。\n\n设 $P_i$ 为攻击者最终弥合 $i$ 个区块差距的概率。该过程根据以下递推关系演化：\n$$P_i = q \\cdot P_{i-1} + p \\cdot P_{i+1}$$\n其中 $P_{i-1}$ 是从 $i-1$ 的差距成功追赶的概率（如果攻击者找到下一个区块），$P_{i+1}$ 是从 $i+1$ 的差距成功追赶的概率（如果诚实链找到下一个区块）。边界条件是 $P_0 = 1$（差距为零的攻击者已经“追上”）和 $\\lim_{i \\to \\infty} P_i = 0$（无限落后的攻击者无法追上，因为 $p > q$）。\n\n此递推关系的通解为 $P_i = A + B\\left(\\frac{q}{p}\\right)^i$。无穷远处的边界条件意味着 $A=0$。条件 $P_0=1$ 得出 $B=1$。因此，对手从 $i$ 个区块的差距追赶上的概率为：\n$$P_i = \\left(\\frac{q}{p}\\right)^i$$\n对于我们的问题，交易有 $z$ 个确认，所以初始差距是 $z$。一次成功的重组攻击的概率 $\\mathcal{P}_{\\text{attack}}$ 是：\n$$\\mathcal{P}_{\\text{attack}} = \\left(\\frac{q}{p}\\right)^z$$\n我们得到的可靠性约束是，这个概率必须不大于 $\\varepsilon$。\n$$\\left(\\frac{q}{p}\\right)^z \\leq \\varepsilon$$\n问题指定了 $z=3$ 和 $\\varepsilon = 1.0 \\times 10^{-6}$ 的情景。我们试图找到满足此条件的最大可能 $q$ 值，记为 $q_{\\max}$。最大值在不等式的边界处找到：\n$$\\left(\\frac{q_{\\max}}{p_{\\max}}\\right)^3 = \\varepsilon$$\n由于 $p+q=1$，我们有 $p_{\\max} = 1 - q_{\\max}$。将此代入方程：\n$$\\left(\\frac{q_{\\max}}{1-q_{\\max}}\\right)^3 = \\varepsilon$$\n为了解出 $q_{\\max}$，我们首先对两边取立方根：\n$$\\frac{q_{\\max}}{1-q_{\\max}} = \\varepsilon^{1/3}$$\n现在，我们进行代数运算以分离出 $q_{\\max}$：\n$$q_{\\max} = \\varepsilon^{1/3} (1 - q_{\\max})$$\n$$q_{\\max} = \\varepsilon^{1/3} - \\varepsilon^{1/3} q_{\\max}$$\n$$q_{\\max} + \\varepsilon^{1/3} q_{\\max} = \\varepsilon^{1/3}$$\n$$q_{\\max}(1 + \\varepsilon^{1/3}) = \\varepsilon^{1/3}$$\n$$q_{\\max} = \\frac{\\varepsilon^{1/3}}{1 + \\varepsilon^{1/3}}$$\n现在，我们代入数值 $\\varepsilon = 1.0 \\times 10^{-6}$：\n$$\\varepsilon^{1/3} = (1.0 \\times 10^{-6})^{1/3} = (10^{-6})^{1/3} = 10^{-2} = 0.01$$\n将此值代入 $q_{\\max}$ 的表达式中：\n$$q_{\\max} = \\frac{0.01}{1 + 0.01} = \\frac{0.01}{1.01}$$\n计算数值：\n$$q_{\\max} = \\frac{1}{101} \\approx 0.009900990099...$$\n题目要求答案四舍五入到四位有效数字。\n$$q_{\\max} \\approx 0.009901$$\n这个结果与初始条件 $0  q  p  1$ 一致，因为 $q_{\\max} \\approx 0.009901$ 远小于 $0.5$。",
            "answer": "$$\\boxed{0.009901}$$"
        }
    ]
}