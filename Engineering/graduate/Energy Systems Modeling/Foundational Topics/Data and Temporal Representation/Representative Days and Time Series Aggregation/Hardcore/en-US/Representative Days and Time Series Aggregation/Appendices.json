{
    "hands_on_practices": [
        {
            "introduction": "After running an energy system optimization on a reduced set of representative days, the first essential step is to reconstruct the full-period results. This foundational exercise guides you through the process of using frequency weights to scale up the outputs—such as daily costs and emissions—to estimate their annual totals. Mastering this reconstruction is fundamental to deriving meaningful, year-long insights from any temporally aggregated model .",
            "id": "4117300",
            "problem": "An electric power system model uses temporal clustering to aggregate a full year of $365$ daily time series into $4$ representative days to reduce the dimensionality of an operational and investment optimization. The $365$ original days are partitioned into $4$ disjoint clusters, each represented by a single typical day. The model assumes linear additivity of operating costs and emissions across time and linear scaling when a representative day stands in for multiple original days. The aggregation respects day-count conservation and uses frequency weights equal to the number of original days represented by each typical day. The aggregated optimization has produced the following outputs per representative day: daily operating cost in United States Dollar (USD) per day and daily emissions in metric tons of Carbon Dioxide (CO2) per day. Additionally, the optimization has produced an annual fixed cost from capacity investments.\n\nRepresentative day A:\n- Cluster size $n_{\\mathrm{A}} = 120$\n- Daily operating cost $C_{\\mathrm{A}} = 1.35 \\times 10^{6}$ USD/day\n- Daily emissions $E_{\\mathrm{A}} = 780$ metric tons CO2/day\n\nRepresentative day B:\n- Cluster size $n_{\\mathrm{B}} = 150$\n- Daily operating cost $C_{\\mathrm{B}} = 1.10 \\times 10^{6}$ USD/day\n- Daily emissions $E_{\\mathrm{B}} = 620$ metric tons CO2/day\n\nRepresentative day C:\n- Cluster size $n_{\\mathrm{C}} = 80$\n- Daily operating cost $C_{\\mathrm{C}} = 1.80 \\times 10^{6}$ USD/day\n- Daily emissions $E_{\\mathrm{C}} = 950$ metric tons CO2/day\n\nRepresentative day D:\n- Cluster size $n_{\\mathrm{D}} = 15$\n- Daily operating cost $C_{\\mathrm{D}} = 2.40 \\times 10^{6}$ USD/day\n- Daily emissions $E_{\\mathrm{D}} = 1{,}300$ metric tons CO2/day\n\nAnnual fixed cost from capacity investments:\n- $F = 2.50 \\times 10^{8}$ USD/year\n\nAssume that the valuation of emissions uses a carbon price of $\\lambda = 50$ USD per metric ton CO2 and that all costs and emissions scale linearly with the frequency weights of their representative days. Compute the frequency weights for each representative day and use them to reconstruct the annual operating cost and the annual emissions. Then compute the reconstructed annual total objective value defined as the sum of annual fixed cost, annual operating cost, and the carbon valuation of annual emissions. Express the final answer in million USD and round your answer to four significant figures.",
            "solution": "The problem statement has been validated and found to be self-contained, scientifically grounded in the principles of energy systems modeling, and mathematically well-posed. The data provided are consistent, as the sum of the cluster sizes $n_{\\mathrm{A}} + n_{\\mathrm{B}} + n_{\\mathrm{C}} + n_{\\mathrm{D}} = 120 + 150 + 80 + 15 = 365$, which correctly accounts for all days in a year. The problem requires the reconstruction of annual total costs and emissions from the outputs of an optimization model based on representative days.\n\nThe core principle for this reconstruction is the linear scaling of daily quantities (costs and emissions) by their corresponding frequency weights. The problem states that the frequency weights are equivalent to the cluster sizes, which represent the number of days in the original time series that each representative day stands for.\n\nLet the set of representative days be $\\mathcal{D} = \\{\\mathrm{A}, \\mathrm{B}, \\mathrm{C}, \\mathrm{D}\\}$. For each representative day $i \\in \\mathcal{D}$, we are given the cluster size $n_i$, the daily operating cost $C_i$, and the daily emissions $E_i$.\n\nFirst, we establish the frequency weights, $w_i$, for each representative day. As per the problem description, these are equal to the cluster sizes:\n- Frequency weight for day A: $w_{\\mathrm{A}} = n_{\\mathrm{A}} = 120$ days\n- Frequency weight for day B: $w_{\\mathrm{B}} = n_{\\mathrm{B}} = 150$ days\n- Frequency weight for day C: $w_{\\mathrm{C}} = n_{\\mathrm{C}} = 80$ days\n- Frequency weight for day D: $w_{\\mathrm{D}} = n_{\\mathrm{D}} = 15$ days\n\nNext, we calculate the reconstructed annual operating cost, $C_{\\text{annual}}$, by summing the daily operating costs of each representative day multiplied by its frequency weight.\n$$C_{\\text{annual}} = \\sum_{i \\in \\mathcal{D}} w_i C_i = n_{\\mathrm{A}}C_{\\mathrm{A}} + n_{\\mathrm{B}}C_{\\mathrm{B}} + n_{\\mathrm{C}}C_{\\mathrm{C}} + n_{\\mathrm{D}}C_{\\mathrm{D}}$$\nSubstituting the given values:\n$$C_{\\text{annual}} = (120 \\ \\text{days}) \\times (1.35 \\times 10^{6} \\ \\text{USD}/\\text{day}) + (150 \\ \\text{days}) \\times (1.10 \\times 10^{6} \\ \\text{USD}/\\text{day}) + (80 \\ \\text{days}) \\times (1.80 \\times 10^{6} \\ \\text{USD}/\\text{day}) + (15 \\ \\text{days}) \\times (2.40 \\times 10^{6} \\ \\text{USD}/\\text{day})$$\n$$C_{\\text{annual}} = (1.62 \\times 10^{8} \\ \\text{USD}) + (1.65 \\times 10^{8} \\ \\text{USD}) + (1.44 \\times 10^{8} \\ \\text{USD}) + (0.36 \\times 10^{8} \\ \\text{USD})$$\n$$C_{\\text{annual}} = (1.62 + 1.65 + 1.44 + 0.36) \\times 10^{8} \\ \\text{USD} = 5.07 \\times 10^{8} \\ \\text{USD}$$\n\nSimilarly, we calculate the reconstructed annual emissions, $E_{\\text{annual}}$, by summing the daily emissions of each representative day multiplied by its frequency weight.\n$$E_{\\text{annual}} = \\sum_{i \\in \\mathcal{D}} w_i E_i = n_{\\mathrm{A}}E_{\\mathrm{A}} + n_{\\mathrm{B}}E_{\\mathrm{B}} + n_{\\mathrm{C}}E_{\\mathrm{C}} + n_{\\mathrm{D}}E_{\\mathrm{D}}$$\nSubstituting the given values:\n$$E_{\\text{annual}} = (120 \\ \\text{days}) \\times (780 \\ \\text{tCO}_2/\\text{day}) + (150 \\ \\text{days}) \\times (620 \\ \\text{tCO}_2/\\text{day}) + (80 \\ \\text{days}) \\times (950 \\ \\text{tCO}_2/\\text{day}) + (15 \\ \\text{days}) \\times (1300 \\ \\text{tCO}_2/\\text{day})$$\n$$E_{\\text{annual}} = (93600 \\ \\text{tCO}_2) + (93000 \\ \\text{tCO}_2) + (76000 \\ \\text{tCO}_2) + (19500 \\ \\text{tCO}_2)$$\n$$E_{\\text{annual}} = 282100 \\ \\text{metric tons CO}_2$$\n\nThe annual cost of carbon emissions, $V_{\\text{carbon}}$, is the product of the annual emissions and the carbon price, $\\lambda = 50$ USD per metric ton CO2.\n$$V_{\\text{carbon}} = E_{\\text{annual}} \\times \\lambda$$\n$$V_{\\text{carbon}} = (282100 \\ \\text{tCO}_2) \\times (50 \\ \\text{USD}/\\text{tCO}_2) = 14,105,000 \\ \\text{USD}$$\n$$V_{\\text{carbon}} = 1.4105 \\times 10^{7} \\ \\text{USD}$$\n\nThe total annual objective value, $Z_{\\text{total}}$, is the sum of the annual fixed cost $F$, the annual operating cost $C_{\\text{annual}}$, and the annual carbon cost $V_{\\text{carbon}}$.\n$$Z_{\\text{total}} = F + C_{\\text{annual}} + V_{\\text{carbon}}$$\nThe given annual fixed cost is $F = 2.50 \\times 10^{8}$ USD.\n$$Z_{\\text{total}} = (2.50 \\times 10^{8} \\ \\text{USD}) + (5.07 \\times 10^{8} \\ \\text{USD}) + (1.4105 \\times 10^{7} \\ \\text{USD})$$\nTo sum these values, we express them with a common power of $10$:\n$$Z_{\\text{total}} = (2.50 \\times 10^{8}) + (5.07 \\times 10^{8}) + (0.14105 \\times 10^{8}) \\ \\text{USD}$$\n$$Z_{\\text{total}} = (2.50 + 5.07 + 0.14105) \\times 10^{8} \\ \\text{USD} = 7.71105 \\times 10^{8} \\ \\text{USD}$$\n\nThe problem requires the final answer to be expressed in million USD. We convert the total objective value:\n$$Z_{\\text{total}} = 7.71105 \\times 10^{8} \\ \\text{USD} = 771.105 \\times 10^{6} \\ \\text{USD} = 771.105 \\ \\text{million USD}$$\n\nFinally, this value must be rounded to four significant figures. The number is $771.105$. The first four significant digits are $7$, $7$, $1$, and $1$. The fifth digit is $0$, so we round down (truncate).\nThe rounded result is $771.1$ million USD.",
            "answer": "$$\\boxed{771.1}$$"
        },
        {
            "introduction": "The choice of aggregation method directly impacts how well the simplified model captures the characteristics of the original data. This practice delves into this crucial step by comparing two common techniques for selecting representative days: centroids (arithmetic means) and medoids (actual, most representative members). By calculating and comparing key metrics like peak load, ramp rates, and total energy for each method, you will develop a practical understanding of their inherent trade-offs and consequences .",
            "id": "4117366",
            "problem": "An electricity demand time series is observed over $4$ consecutive days, each day comprising $6$ hourly values measured in kilowatts. The hourly values for the $4$ days, in chronological order, are:\nDay $1$: $\\{10, 14, 12, 8, 9, 11\\}$, Day $2$: $\\{9, 13, 15, 10, 8, 12\\}$, Day $3$: $\\{7, 9, 12, 18, 14, 10\\}$, Day $4$: $\\{6, 8, 11, 17, 13, 9\\}$. The time step is $1$ hour. Days $1$ and $2$ form Cluster $A$, and Days $3$ and $4$ form Cluster $B$.\n\nRepresentative-day aggregation is performed in two variants:\n- Centroid-based: For each cluster, the representative day is the hour-wise arithmetic mean of the member days.\n- Medoid-based: For each cluster, the representative day is the actual member day whose Euclidean distance to the cluster centroid is minimal; in case of a tie, select the earlier day in chronological order.\n\nThe aggregated time series is formed by replacing each original day, in its original chronological position, by its cluster’s representative day. Consider the following performance metrics computed over the entire $4$-day aggregated sequence:\n- Peak metric: the maximum value across all hours.\n- Ramp metric: the maximum absolute difference between adjacent hourly values across the entire concatenated sequence, including transitions from the last hour of one day to the first hour of the next day.\n- Energy metric: the sum of all hourly values over the $4$ days, expressed in kilowatt-hours (kWh).\n\nStarting from the definitions of arithmetic mean, Euclidean distance in real vector space, and these metric definitions, construct both the centroid-based and medoid-based aggregated sequences, compute each of the three metrics for both variants, and then compute a single composite scalar defined as the Euclidean norm of the vector of relative differences between the centroid-based and medoid-based metrics, where each component is normalized by the corresponding metric computed on the original (unaggregated) $4$-day time series.\n\nProvide the final composite value as a pure decimal number. Round your answer to four significant figures. The composite is dimensionless; do not include units.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in standard time series analysis and energy systems modeling techniques. It is well-posed, providing all necessary data, clear definitions for clusters, aggregation methods (centroid and medoid), performance metrics (peak, ramp, energy), and the final composite scalar. The tie-breaking rule for the medoid selection ensures a unique solution. The problem is objective and free from ambiguity.\n\nLet the four daily time series be represented as vectors in $\\mathbb{R}^6$:\n$D_1 = \\langle 10, 14, 12, 8, 9, 11 \\rangle$\n$D_2 = \\langle 9, 13, 15, 10, 8, 12 \\rangle$\n$D_3 = \\langle 7, 9, 12, 18, 14, 10 \\rangle$\n$D_4 = \\langle 6, 8, 11, 17, 13, 9 \\rangle$\n\nThe clusters are Cluster $A = \\{D_1, D_2\\}$ and Cluster $B = \\{D_3, D_4\\}$.\n\n**1. Centroid-Based Representative Days**\nThe centroid of a cluster of vectors is their hour-wise arithmetic mean. For a cluster with $N$ days $\\{X_1, ..., X_N\\}$, the centroid $C$ is given by $C = \\frac{1}{N} \\sum_{i=1}^{N} X_i$.\n\nFor Cluster $A$ (with $N=2$):\n$R_A^C = \\frac{1}{2}(D_1 + D_2) = \\frac{1}{2}(\\langle 10+9, 14+13, 12+15, 8+10, 9+8, 11+12 \\rangle)$\n$R_A^C = \\frac{1}{2}(\\langle 19, 27, 27, 18, 17, 23 \\rangle) = \\langle 9.5, 13.5, 13.5, 9, 8.5, 11.5 \\rangle$\n\nFor Cluster $B$ (with $N=2$):\n$R_B^C = \\frac{1}{2}(D_3 + D_4) = \\frac{1}{2}(\\langle 7+6, 9+8, 12+11, 18+17, 14+13, 10+9 \\rangle)$\n$R_B^C = \\frac{1}{2}(\\langle 13, 17, 23, 35, 27, 19 \\rangle) = \\langle 6.5, 8.5, 11.5, 17.5, 13.5, 9.5 \\rangle$\n\n**2. Medoid-Based Representative Days**\nThe medoid is the actual member day that minimizes the Euclidean distance to the cluster centroid. The squared Euclidean distance between two vectors $p, q \\in \\mathbb{R}^k$ is $d(p,q)^2 = \\sum_{i=1}^k (p_i - q_i)^2$.\n\nFor Cluster $A$, we compare the distance of $D_1$ and $D_2$ from $R_A^C$:\n$d(D_1, R_A^C)^2 = (10-9.5)^2 + (14-13.5)^2 + (12-13.5)^2 + (8-9)^2 + (9-8.5)^2 + (11-11.5)^2$\n$d(D_1, R_A^C)^2 = 0.5^2 + 0.5^2 + (-1.5)^2 + (-1)^2 + 0.5^2 + (-0.5)^2 = 0.25 + 0.25 + 2.25 + 1 + 0.25 + 0.25 = 4.25$\n$d(D_2, R_A^C)^2 = (9-9.5)^2 + (13-13.5)^2 + (15-13.5)^2 + (10-9)^2 + (8-8.5)^2 + (12-11.5)^2$\n$d(D_2, R_A^C)^2 = (-0.5)^2 + (-0.5)^2 + 1.5^2 + 1^2 + (-0.5)^2 + 0.5^2 = 0.25 + 0.25 + 2.25 + 1 + 0.25 + 0.25 = 4.25$\nThe distances are equal. The tie-breaking rule selects the earlier day, $D_1$. Thus, $R_A^M = D_1$.\n\nFor Cluster $B$, we compare the distance of $D_3$ and $D_4$ from $R_B^C$:\n$d(D_3, R_B^C)^2 = (7-6.5)^2 + (9-8.5)^2 + (12-11.5)^2 + (18-17.5)^2 + (14-13.5)^2 + (10-9.5)^2$\n$d(D_3, R_B^C)^2 = 0.5^2 + 0.5^2 + 0.5^2 + 0.5^2 + 0.5^2 + 0.5^2 = 6 \\times 0.25 = 1.5$\n$d(D_4, R_B^C)^2 = (6-6.5)^2 + (8-8.5)^2 + (11-11.5)^2 + (17-17.5)^2 + (13-13.5)^2 + (9-9.5)^2$\n$d(D_4, R_B^C)^2 = (-0.5)^2 + (-0.5)^2 + (-0.5)^2 + (-0.5)^2 + (-0.5)^2 + (-0.5)^2 = 6 \\times 0.25 = 1.5$\nThe distances are equal. The tie-breaking rule selects the earlier day, $D_3$. Thus, $R_B^M = D_3$.\n\n**3. Calculation of Performance Metrics**\nThe full time series are constructed:\nOriginal: $S_{orig} = \\{D_1, D_2, D_3, D_4\\}$\nCentroid-based: $S_C = \\{R_A^C, R_A^C, R_B^C, R_B^C\\}$\nMedoid-based: $S_M = \\{R_A^M, R_A^M, R_B^M, R_B^M\\} = \\{D_1, D_1, D_3, D_3\\}$\n\nLet the full sequence of $24$ hourly values be denoted by $\\{s_i\\}_{i=1}^{24}$.\n- Peak metric: $P = \\max_{i} s_i$\n- Ramp metric: $R = \\max_{i=1}^{23} |s_{i+1} - s_i|$\n- Energy metric: $E = \\sum_{i=1}^{24} s_i \\cdot \\Delta t$. With $\\Delta t = 1 \\text{ hour}$, $E$ is the sum of the hourly kW values, yielding a result in kWh.\n\n**Metrics for Original Series ($S_{orig}$)**\n$P_{orig} = \\max(\\text{values in } D_1, D_2, D_3, D_4) = \\max(14, 15, 18, 17) = 18$\n$E_{orig} = \\sum D_1 + \\sum D_2 + \\sum D_3 + \\sum D_4 = 64 + 67 + 70 + 64 = 265$\n$R_{orig}$: The maximum hourly ramp within any day or between days. The largest difference is in $D_3$ ($|18_h-12_h| = 6$) and $D_4$ ($|17_h-11_h| = 6$). Thus, $R_{orig} = 6$.\n\n**Metrics for Centroid-based Series ($S_C$)**\n$P_C = \\max(\\text{values in } R_A^C, R_B^C) = \\max(13.5, 17.5) = 17.5$\n$E_C = 2 \\times \\sum R_A^C + 2 \\times \\sum R_B^C = 2 \\times 65.5 + 2 \\times 67 = 131 + 134 = 265$\n$R_C$: The maximum ramp is in $R_B^C$, between its 3rd and 4th hours: $|17.5 - 11.5| = 6$. Thus, $R_C = 6$.\n\n**Metrics for Medoid-based Series ($S_M$)**\n$P_M = \\max(\\text{values in } D_1, D_3) = \\max(14, 18) = 18$\n$E_M = 2 \\times \\sum D_1 + 2 \\times \\sum D_3 = 2 \\times 64 + 2 \\times 70 = 128 + 140 = 268$\n$R_M$: The maximum ramp is in $D_3$, between its 3rd and 4th hours: $|18 - 12| = 6$. Thus, $R_M = 6$.\n\n**4. Final Composite Scalar Calculation**\nThe vector of relative differences is $v = \\left( \\frac{P_C - P_M}{P_{orig}}, \\frac{R_C - R_M}{R_{orig}}, \\frac{E_C - E_M}{E_{orig}} \\right)$.\n$P_{orig}=18, P_C=17.5, P_M=18 \\implies v_P = \\frac{17.5 - 18}{18} = \\frac{-0.5}{18} = -\\frac{1}{36}$\n$R_{orig}=6, R_C=6, R_M=6 \\implies v_R = \\frac{6 - 6}{6} = 0$\n$E_{orig}=265, E_C=265, E_M=268 \\implies v_E = \\frac{265 - 268}{265} = -\\frac{3}{265}$\n\nThe composite scalar $C$ is the Euclidean norm of $v$:\n$C = \\|v\\| = \\sqrt{v_P^2 + v_R^2 + v_E^2}$\n$C = \\sqrt{\\left(-\\frac{1}{36}\\right)^2 + 0^2 + \\left(-\\frac{3}{265}\\right)^2}$\n$C = \\sqrt{\\frac{1}{1296} + \\frac{9}{70225}}$\n\nTo compute the numerical value:\n$\\frac{1}{1296} \\approx 0.0007716049$\n$\\frac{9}{70225} \\approx 0.0001281601$\n$C = \\sqrt{0.0007716049 + 0.0001281601} = \\sqrt{0.000899765}$\n$C \\approx 0.02999608...$\n\nRounding to four significant figures, we get $0.03000$.",
            "answer": "$$\n\\boxed{0.03000}\n$$"
        },
        {
            "introduction": "Time series aggregation can inadvertently smooth over critical system-stressing events, leading to flawed investment decisions and compromised reliability. This practice explores the high-stakes consequences of how outliers are treated, comparing a scenario where an extreme day is averaged out versus one where it is explicitly preserved as a representative. By optimizing firm capacity and evaluating reliability metrics like Loss of Load Expectation (LOLE), you will see firsthand how aggregation choices translate into tangible economic and operational outcomes .",
            "id": "4117398",
            "problem": "Consider a single-node capacity expansion and reliability assessment problem under time-series aggregation for energy systems modeling. A planner chooses a nonnegative firm capacity $K$ (in megawatts) to meet an exogenous hourly demand profile. Unserved demand incurs a penalty according to the Value of Lost Load (VOLL), while installed capacity incurs a fixed annualized investment cost. The full-year demand is approximated by representative days with associated integer day-weights. Two aggregation scenarios are compared to demonstrate the impact of explicitly including an outlier day as a fixed representative.\n\nFundamental base:\n- Define the hourly shortage in any hour as $\\max(L - K, 0)$, where $L$ is the realized demand (in megawatts) and $K$ is installed firm capacity (in megawatts).\n- Let $C_{\\text{inv}}$ be the investment cost in currency per megawatt per year and $v$ be the VOLL in currency per megawatt-hour.\n- Given representative-day profiles indexed by $d$ with integer weights $w_d$ (days) and hours indexed by $h$ from $1$ to $24$, the annual objective for a given $K$ is\n$$J(K) = C_{\\text{inv}} \\cdot K + v \\cdot \\sum_{d} w_d \\sum_{h=1}^{24} \\max\\left(L_{d,h} - K, 0\\right).$$\n- Reliability metrics are defined on the weighted horizon:\n  - Loss of Load Expectation (LOLE), measured in hours per year, equals $\\sum_d w_d \\sum_{h=1}^{24} \\mathbf{1}\\{L_{d,h} > K\\}$.\n  - Expected Unserved Energy (EUE), measured in megawatt-hours per year, equals $\\sum_d w_d \\sum_{h=1}^{24} \\max(L_{d,h} - K, 0)$.\n\nTime-series and aggregation definitions:\n- Construct a synthetic set of daily demand profiles with $24$ hours per day. There are $10$ “normal” days, indexed by $d$ in $\\{1,\\dots,10\\}$, and $1$ “outlier” day. For hour $h \\in \\{1,\\dots,24\\}$, define the normal-day demand as\n$$L^{\\text{norm}}_{d,h} = 50 + 10 \\cdot \\sin\\!\\left(2\\pi \\cdot \\frac{h - 8}{24}\\right) + 2 \\cdot \\sin\\!\\left(2\\pi \\cdot \\frac{d}{10}\\right).$$\n- Define the outlier-day profile $L^{\\text{out}}_{h}$ by taking the same base diurnal shape as for $d=1$ and adding a localized peak of $30$ megawatts during late afternoon/evening hours:\n$$L^{\\text{out}}_{h} = \\left(50 + 10 \\cdot \\sin\\!\\left(2\\pi \\cdot \\frac{h - 8}{24}\\right) + 2 \\cdot \\sin\\!\\left(2\\pi \\cdot \\frac{1}{10}\\right)\\right) + \\Delta_h,$$\nwhere $\\Delta_h = 30$ if $h \\in \\{17, 18, 19, 20\\}$ and $\\Delta_h = 0$ otherwise.\n- Aggregation Scenario A (excluding the outlier): use a single representative day equal to the arithmetic mean of the $10$ normal days, with weight $10$. Formally, $L^{A}_{h} = \\frac{1}{10} \\sum_{d=1}^{10} L^{\\text{norm}}_{d,h}$ with weight $w^{A} = 10$.\n- Aggregation Scenario B (including the outlier as a fixed representative): use two representatives, the mean normal day $L^{A}_{h}$ with weight $10$, and the outlier day $L^{\\text{out}}_{h}$ with weight $1$.\n\nDecision problem in both scenarios:\n- For given $C_{\\text{inv}}$ (currency per megawatt per year) and $v$ (currency per megawatt-hour), choose $K \\ge 0$ to minimize $J(K)$ as defined above using the scenario’s representative set and weights. Compute, at the optimal $K^\\star$, the LOLE (in hours per year) and the EUE (in megawatt-hours per year).\n\nAlgorithmic requirement:\n- Solve for $K^\\star$ by evaluating the objective $J(K)$ on the finite candidate set consisting of $K=0$ and all unique hourly demand values present in the scenario’s representative profiles. Select the $K$ that minimizes $J(K)$. If there are multiple minimizers, select the smallest $K$ among them.\n\nUnits and reporting:\n- Report capacity $K^\\star$ in megawatts, LOLE in hours per year, and EUE in megawatt-hours per year. All reported numbers must be rounded to three decimal places.\n\nTest suite:\n- Use the following three test cases, each specified by $(C_{\\text{inv}}, v)$:\n  - Test $1$: $(50{,}000, 10{,}000)$.\n  - Test $2$: $(3{,}000{,}000, 10{,}000)$.\n  - Test $3$: $(1{,}000, 10{,}000)$.\nThese span a typical trade-off, a high-investment-cost edge where zero capacity may be optimal, and a near “cover-the-peak” case.\n\nRequired final output format:\n- Your program should produce a single line of output containing a flat list of $18$ numbers in the following order, all rounded to three decimals: for each test $t \\in \\{1,2,3\\}$ in ascending order, list\n$[K^{A,\\star}_t,\\ \\text{LOLE}^{A}_t,\\ \\text{EUE}^{A}_t,\\ K^{B,\\star}_t,\\ \\text{LOLE}^{B}_t,\\ \\text{EUE}^{B}_t]$,\nand then concatenate these per-test lists into one flat list of length $18$. The output must be printed exactly as a single bracketed, comma-separated Python-style list (e.g., $[x_1,x_2,\\dots,x_{18}]$).",
            "solution": "We derive the solution from first principles using the definition of the objective and the piecewise linear loss-of-load penalty.\n\n1. Construct the time series.\n   - For each normal day $d \\in \\{1,\\dots,10\\}$ and hour $h \\in \\{1,\\dots,24\\}$, define the load\n   $$L^{\\text{norm}}_{d,h} = 50 + 10 \\cdot \\sin\\!\\left(2\\pi \\cdot \\frac{h - 8}{24}\\right) + 2 \\cdot \\sin\\!\\left(2\\pi \\cdot \\frac{d}{10}\\right).$$\n   This yields a diurnal pattern peaking near late afternoon with mild inter-day variation due to the term $2 \\cdot \\sin\\!\\left(2\\pi \\cdot d/10\\right)$.\n   - Define the outlier day by augmenting the base profile for $d=1$ with a late-day peak:\n   $$L^{\\text{out}}_{h} = \\left(50 + 10 \\cdot \\sin\\!\\left(2\\pi \\cdot \\frac{h - 8}{24}\\right) + 2 \\cdot \\sin\\!\\left(2\\pi \\cdot \\frac{1}{10}\\right)\\right) + \\Delta_h,$$\n   where $\\Delta_h = 30$ for $h \\in \\{17,18,19,20\\}$ and $\\Delta_h = 0$ otherwise. This constructs a plausible extreme peak over a short window.\n\n2. Build representative scenarios.\n   - Scenario A: the representative day is the arithmetic mean across the $10$ normal days for each hour $h$,\n   $$L^{A}_{h} = \\frac{1}{10} \\sum_{d=1}^{10} L^{\\text{norm}}_{d,h},$$\n   with weight $w^{A} = 10$ days. The total weighted hours are $24 \\cdot 10$.\n   - Scenario B: two representatives are used, the mean normal day $L^{A}_{h}$ with weight $10$ and the outlier day $L^{\\text{out}}_{h}$ with weight $1$. The total weighted hours are $24 \\cdot 11$.\n\n3. Define the objective and metrics for a given nonnegative capacity $K$.\n   - The annualized cost is\n   $$J(K) = C_{\\text{inv}} \\cdot K + v \\cdot \\sum_{d} w_d \\sum_{h=1}^{24} \\max(L_{d,h} - K, 0).$$\n   - Reliability metrics are\n   $$\\text{LOLE}(K) = \\sum_{d} w_d \\sum_{h=1}^{24} \\mathbf{1}\\{L_{d,h} > K\\}, \\quad \\text{EUE}(K) = \\sum_{d} w_d \\sum_{h=1}^{24} \\max(L_{d,h} - K, 0).$$\n\n4. Convexity and characterization of the optimum.\n   - For each hour, $f_h(K) = \\max(L_h - K, 0)$ is convex and piecewise linear in $K$ with a subgradient of $-1$ when $K < L_h$, any value in $[-1,0]$ when $K = L_h$, and $0$ when $K > L_h$.\n   - Because $J(K)$ is the sum of a linear term $C_{\\text{inv}} \\cdot K$ and nonnegative weighted sums of convex functions $f_h(K)$, $J(K)$ is convex and piecewise linear. Therefore, an optimal solution $K^\\star$ exists at one of the breakpoints of $J(K)$, which occur at $K$ equal to either $0$ or at hourly load values present in the aggregated representative set.\n   - A subgradient of $J$ at $K$ is\n   $$\\partial J(K) \\ni C_{\\text{inv}} - v \\cdot \\sum_{d} w_d \\sum_{h=1}^{24} g_{d,h}(K),$$\n   where $g_{d,h}(K) = 1$ if $K < L_{d,h}$, $g_{d,h}(K) \\in [0,1]$ if $K = L_{d,h}$, and $g_{d,h}(K) = 0$ if $K > L_{d,h}$. At any differentiable point (i.e., not at a breakpoint), $g_{d,h}(K) = \\mathbf{1}\\{L_{d,h} > K\\}$, so the derivative is\n   $$J'(K) = C_{\\text{inv}} - v \\cdot \\sum_{d} w_d \\sum_{h=1}^{24} \\mathbf{1}\\{L_{d,h} > K\\}.$$\n   The first-order optimality condition for a minimizer in the interior would be $J'(K^\\star) = 0$, which has the interpretation that the marginal investment cost balances the marginal reduction in expected shortage cost, with the latter term proportional to the number of weighted hours above $K^\\star$.\n   - In the discrete, piecewise-linear setting, the exact minimizer can be found by evaluating $J(K)$ on the finite set $\\{0\\} \\cup \\{L_{d,h}\\ \\text{for all representative hours}\\}$ and picking the smallest $K$ that minimizes $J(K)$. This satisfies the convex optimality conditions and avoids ambiguity in flat regions.\n\n5. Algorithm to compute the required outputs for any given $(C_{\\text{inv}}, v)$ and either aggregation scenario.\n   - Step $1$: Build the representative arrays $\\{L_{d,h}\\}$ and weights $\\{w_d\\}$ for the scenario.\n   - Step $2$: Construct the candidate set $\\mathcal{K} = \\{0\\} \\cup \\{L_{d,h}\\}$ of nonnegative breakpoints.\n   - Step $3$: For each $K \\in \\mathcal{K}$, compute $J(K)$, $\\text{LOLE}(K)$, and $\\text{EUE}(K)$ as defined above. Select $K^\\star$ that minimizes $J(K)$; if multiple minimizers exist, select the smallest $K$.\n   - Step $4$: Report $K^\\star$ (megawatts), $\\text{LOLE}(K^\\star)$ (hours per year), and $\\text{EUE}(K^\\star)$ (megawatt-hours per year), each rounded to three decimals.\n\n6. Interpreting the test suite and the impact of including the outlier.\n   - Test $1$ with $(C_{\\text{inv}}, v) = (50{,}000, 10{,}000)$ yields an “allowed” number of exceedance hours scale comparable to a handful of hours, so the presence of the outlier’s $4$-hour spike in Scenario B shifts the optimal $K^\\star$ upward relative to Scenario A, reducing $\\text{LOLE}$ and $\\text{EUE}$ in Scenario B at the cost of higher capacity.\n   - Test $2$ with $(C_{\\text{inv}}, v) = (3{,}000{,}000, 10{,}000)$ implies that the marginal investment cost dominates the shortage cost over the entire weighted horizon (since $C_{\\text{inv}}/v$ exceeds the total weighted hours), so $K^\\star = 0$ is optimal in both scenarios; reliability metrics will differ between scenarios due to different total weighted hours and peak magnitudes, illustrating reliability accounting even when investment is zero.\n   - Test $3$ with $(C_{\\text{inv}}, v) = (1{,}000, 10{,}000)$ makes shortage very expensive relative to capacity, driving $K^\\star$ to cover essentially the maximum hourly load in the scenario. Including the outlier as a fixed representative increases the scenario’s maximum load and thus increases $K^\\star$ in Scenario B, further reducing $\\text{LOLE}$ and $\\text{EUE}$ compared to Scenario A.\n\nThe program implements these steps exactly, computes the optimal capacities and reliability metrics for both aggregation scenarios across the specified test cases, and prints a single flat list of $18$ rounded numbers in the required order and units.",
            "answer": "[59.512, 50.000, 24.320, 89.512, 4.000, 1.944, 0.000, 240.000, 1440.000, 0.000, 264.000, 1694.000, 60.000, 0.000, 0.000, 90.000, 0.000, 0.000]"
        }
    ]
}