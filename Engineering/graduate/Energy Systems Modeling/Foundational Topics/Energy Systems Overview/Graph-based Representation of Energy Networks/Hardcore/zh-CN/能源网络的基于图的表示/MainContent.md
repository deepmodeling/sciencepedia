## 引言
随着能源系统日益复杂化和互联化，从洲际电网到区域供热管网，我们迫切需要一个统一而严谨的框架来描述、分析和优化这些庞大的网络。传统的分析方法往往是针对特定问题，缺乏一个能够贯穿不同能源载体和分析任务的通用语言。这种知识上的隔阂限制了我们对系统整体行为的深刻理解，尤其是在面对可再生能源的波动性、[多能源系统](@entry_id:1128259)的耦合以及智能化带来的新挑战时。

本文旨在填补这一空白，系统介绍如何运用图论——这一强大的数学分支——作为表示和分析能源网络的通用语言。通过将物理组件抽象为节点和边，并将物理定律转化为矩阵运算，我们能够以一种系统化、可计算的方式来处理复杂的网络问题。在本文中，您将学习到如何从第一性原理出发，构建能源网络的核心数学模型，并将其应用于解决现实世界中的关键工程问题。

文章将分为三个核心章节展开。在**“原理与机制”**中，我们将奠定理论基础，详细阐述如何构建[图拉普拉斯矩阵](@entry_id:275190)和[节点导纳矩阵](@entry_id:1134158)等基本模型，并介绍线性化、网络化简和状态估计等关键技术。接下来，在**“应用与交叉学科联系”**中，我们将展示这些模型在[电力](@entry_id:264587)潮流追踪、可靠性评估、机器学习以及[多能源系统](@entry_id:1128259)耦合等领域的强大应用能力。最后，**“动手实践”**部分将提供一系列精心设计的练习，帮助您将理论知识转化为实际的建模和编程技能。

现在，让我们从最基本的概念开始，深入探讨将能源[网络表示](@entry_id:752440)为数学图的核心原理与机制。

## 原理与机制

本章旨在阐述将能源[网络表示](@entry_id:752440)为数学图的核心原理与机制。我们将从基本物理定律出发，系统地构建描述网络行为的图论模型。随后，我们将探讨如何应用这些模型解决能源系统分析中的关键问题，包括交流与直流[网络分析](@entry_id:139553)、网络简化、状态估计，以及如何在耦合[多能源系统](@entry_id:1128259)和不确定性环境下进行建模。

### 基础表示法：从物理定律到图论模型

能源网络本质上是由节点（如变电站、枢纽）和边（如输电线路、管道）构成的系统，能量在其中流动并遵循基本的物理守恒定律。图论为描述此类系统的拓扑结构和物理过程提供了严谨而强大的数学语言。

**节点、边与[能量载体](@entry_id:1124453)**

在[图论](@entry_id:140799)模型中，我们将能源系统中的物理位置（如发电厂、变电站、城市门站）抽象为**节点 (nodes)**，将连接这些节点的输送基础设施（如输电线路、天然气管道）抽象为**边 (edges)**。当系统涉及多种能源形式时，例如[电力](@entry_id:264587)、天然气和热能，我们称之为**多[能量载体](@entry_id:1124453) (multi-carrier)** 系统。在这种情况下，通常需要为每种[能量载体](@entry_id:1124453)构建一个独立的图层，因为它们的物理网络拓扑可能完全不同 。

**[关联矩阵](@entry_id:263683)：编码守恒定律**

[网络分析](@entry_id:139553)的核心是守恒定律，例如电路中的**基尔霍夫电流定律 (Kirchhoff's Current Law, KCL)**。该定律指出，在任何节点上，流入电流的总和必须等于流出电流的总和。为了在图模型中系统地表达这一点，我们引入**[关联矩阵](@entry_id:263683) (incidence matrix)**，记为 $A$。

对于一个包含 $n$ 个节点和 $m$ 条边的[有向图](@entry_id:920596)，[关联矩阵](@entry_id:263683) $A$ 是一个 $n \times m$ 的矩阵。其元素 $A_{ie}$ 定义如下：如果边 $e$ 从节点 $i$ 指出，则 $A_{ie} = 1$；如果边 $e$ 指向节点 $i$，则 $A_{ie} = -1$；否则 $A_{ie} = 0$。这种“源为+1，汇为-1”的约定使得我们可以简洁地表达KCL。

令 $f \in \mathbb{R}^{m}$ 为一个向量，表示沿每条边的（有向）流量，令 $s \in \mathbb{R}^{n}$ 为一个向量，表示每个节点的外部注入量（正值为注入，负值为提取）。那么，整个网络的节点[平衡方程](@entry_id:172166)可以写成一个优雅的矩阵形式：
$$
A f = s
$$
这个方程的第 $i$ 行精确地描述了节点 $i$ 的[流量守恒](@entry_id:273629)：所有流入该节点的边流量（计为正）与流出该节点的边流量（计为负）的代数和，等于该节点的外部注入量。[关联矩阵](@entry_id:263683)是连接节点与边的基本算子，它将边上的物理量（流量）映射到节点上的物理量（净注入）。

需要注意的是，[关联矩阵](@entry_id:263683)与**邻接矩阵 (adjacency matrix)** 不同。邻接矩阵仅描述节点之间是否存在连接，而无法直接用于表示[流量守恒](@entry_id:273629)这种有向的代数求和关系 。

**图拉普拉斯矩阵：融合守恒与本构关系**

除了守恒定律，网络中的流动还遵循**本构关系 (constitutive relation)**，它描述了流量与驱动力（如电压差、压力差）之间的关系。在许[多能源系统](@entry_id:1128259)中，这种关系是线性的，类似于**欧姆定律 (Ohm's Law)**。

以一个直流电阻网络为例 ，节点代表母线，边代表电阻。边 $(i, j)$ 的电导为 $g_{ij}$，节点 $i$ 和 $j$ 的电压分别为 $v_i$ 和 $v_j$。根据[欧姆定律](@entry_id:276027)，从节点 $i$ 流向节点 $j$ 的电流为 $f_{ij} = g_{ij}(v_i - v_j)$。我们可以将所有边的本构关系写成矩阵形式。令 $v \in \mathbb{R}^{n}$ 为节点电压向量，则所有边的电压差向量可以表示为 $A^{\top}v$。于是，流量向量 $f$ 可以写成：
$$
f = G A^{\top} v
$$
其中，$G$ 是一个 $m \times m$ 的[对角矩阵](@entry_id:637782)，其对角线元素为各条边的电导 $g_e$。

现在，我们将本构关系代入KCL方程 $Af=s$：
$$
A (G A^{\top} v) = s
$$
这引出了一个在网络科学中至关重要的矩阵——**图拉普拉斯矩阵 (Graph Laplacian)**，记为 $L$：
$$
L = A G A^{\top}
$$
于是，整个网络的节点平衡方程简化为 $L v = i$，其中 $v$ 是电压向量，$i$ 是电流注入向量。拉普拉斯矩阵的元素具有明确的物理解释：
- 对角元素 $L_{ii} = \sum_{j \neq i} g_{ij}$，是连接到节点 $i$ 的所有边的电导之和。
- 非对角元素 $L_{ij} = -g_{ij}$（当 $i \neq j$ 且边 $(i, j)$ 存在时），是连接节点 $i$ 和 $j$ 的边的电导的[相反数](@entry_id:151709)。

对于一个[连通图](@entry_id:264785)，[拉普拉斯矩阵](@entry_id:152110)是奇异的（其行列式为零），因为它的行和与列和均为零。这对应一个物理事实：网络的电位（或电压）只有相对差值才有意义，绝对值可以任意平移。为了得到唯一解，我们必须指定一个**[参考节点](@entry_id:272245) (reference node)**，例如将其接地，即固定其电位为零 ($v_r = 0$)。

在数学上，这对应于从方程组 $Lv=i$ 中移除与[参考节点](@entry_id:272245)对应的行和列，形成一个**降阶[拉普拉斯矩阵](@entry_id:152110) (reduced Laplacian)** $L_{\text{red}}$。这个降阶矩阵是可逆的，从而可以求解所有非[参考节点](@entry_id:272245)的电位 。这个过程是分析所有类型网络（包括[电力](@entry_id:264587)、热力、流体网络）的基础。

### 交流[电力](@entry_id:264587)[网络建模](@entry_id:262656)

与直[流网络](@entry_id:262675)不同，交流 (AC) [电力](@entry_id:264587)系统中的电压、电流和功率均为复数。然而，其[图论](@entry_id:140799)表示的基本思想一脉相承，只是将实数运算推广到[复数域](@entry_id:153768)。

**[节点导纳矩阵](@entry_id:1134158) (Y-bus)**

在交[流网络](@entry_id:262675)中，与图拉普拉斯矩阵相对应的核心工具是**[节点导纳矩阵](@entry_id:1134158) (nodal admittance matrix)**，通常称为 **Y-bus** 矩阵。它描述了节点注入电流向量 $I$ 和节点电压相量向量 $V$ 之间的线性关系：
$$
I = Y_{\text{bus}} V
$$
Y-bus 矩阵的每个元素 $Y_{ij}$ 都是一个复数，代表导纳。与拉普拉斯矩阵一样，Y-bus 矩阵也可以通过“元件叠加法”构建，即逐个考虑网络中每个元件对其的贡献。

- **对角元素 (自导纳)** $Y_{ii}$ 等于连接到节点 $i$ 的所有支路导纳的总和。
- **非对角元素 ([互导](@entry_id:274251)纳)** $Y_{ij}$ ($i \neq j$) 等于连接节点 $i$ 和节点 $j$ 的所有支路导纳之和的[相反数](@entry_id:151709)。

**元件模型与Y-bus构建**

1.  **输电线路**：输电线路通常使用 **$\pi$ 等效模型**来表示 。一条连接节点 $k$ 和 $m$ 的线路，其串联阻抗为 $z_{km}$，总对地并联导纳为 $y^{\text{sh}}_{km}$。该模型包含一个串联导纳 $y'_{km} = 1/z_{km}$ 和两个并联导纳 $y^{\text{sh}}_{km}/2$（分别接在节点 $k$ 和 $m$）。因此，这条线路对 Y-bus 矩阵的贡献为：
    - 对自导纳 $Y_{kk}$ 和 $Y_{mm}$ 的贡献：增加 $y'_{km} + y^{\text{sh}}_{km}/2$。
    - 对[互导](@entry_id:274251)纳 $Y_{km}$ 和 $Y_{mk}$ 的贡献：减少 $y'_{km}$（即增加 $-y'_{km}$）。

2.  **移相与有载调压变压器**：变压器，尤其是在次级侧具有非标准变比（**off-nominal tap**）的变压器，是[电力](@entry_id:264587)系统中重要的控制元件。一个位于节点 $k$ 和 $m$ 之间的[理想变压器](@entry_id:262644)，如果其在节点 $k$ 侧的复数变比为 $t = a e^{j\theta}$，串联导纳为 $y_{km}$，它会对 Y-bus 矩阵产生非对称的贡献 。通过分析变压器两侧的电压和电流关系，可以推导出其贡献如下：
    $$
    \Delta Y = \begin{pmatrix} y_{km}/|t|^2  & -y_{km}/t^* \\ -y_{km}/t  & y_{km} \end{pmatrix}
    $$
    其中 $t^*$ 是 $t$ 的[复共轭](@entry_id:174690)。这种非对称性是由于变压器的[非互易性](@entry_id:168607)质造成的，它打破了简单网络的对称结构。

通过累加网络中所有元件的贡献，我们便可以系统地构建出整个网络的 Y-bus 矩阵。一旦 Y-bus 矩阵和节点注入电流（或功率）已知，就可以像直流情况一样，通过设置一个**摇摆节点 (slack bus)**（其电压幅值和相角固定），对矩阵进行降阶并求解网络中所有其他节点的电压。

### 线性化模型及其应用

完整的交流潮流方程是关于电压幅值和相角的[非线性](@entry_id:637147)[三角函数](@entry_id:178918)方程组，求解复杂。在许多实际应用中，我们采用**线性化模型**，其中最著名的是**[直流潮流](@entry_id:1123429) (DC Power Flow)** 模型。

**[直流潮流近似](@entry_id:1123430)**

[直流潮流](@entry_id:1123429)模型基于以下关键假设 ：
1.  所有节点的电压幅值约等于 $1.0$ p.u.（标幺值）。
2.  任意两相连节点的电压相角差很小，因此 $\sin(\theta_i - \theta_j) \approx \theta_i - \theta_j$ 且 $\cos(\theta_i - \theta_j) \approx 1$。
3.  线路电阻远小于电抗，因此线路被视为纯感性，线路导纳为纯虚数。

在这些假设下，节点 $i$ 的有功功率注入 $P_i$ 与节点电压相角 $\theta$ 之间的[非线性](@entry_id:637147)关系：
$$
P_{i} = \sum_{j} |V_{i}||V_{j}| |Y_{ij}| \sin(\theta_{i} - \theta_{j} - \angle Y_{ij})
$$
可以简化为一个[线性方程组](@entry_id:148943)：
$$
P_i \approx \sum_j b_{ij} (\theta_i - \theta_j)
$$
其中 $b_{ij} = 1/x_{ij}$ 是线路 $(i, j)$ 的电纳。这个方程组可以写成矩阵形式：
$$
P = B' \theta
$$
这里的 $B'$ 矩阵通常被称为**直流潮流矩阵**，它在数学上等价于一个以线路电纳为权重的[图拉普拉斯矩阵](@entry_id:275190)。与之前的模型一样，通过设定一个相角参考点（摇摆节点的 $\theta_r = 0$），我们可以求解所有节点的电压相角，进而计算出线路上的有功潮流。直流潮流模型因其计算速度快、鲁棒性好，在电力市场清算、输电系统规划和安全分析中得到了广泛应用 。

**[灵敏度分析](@entry_id:147555)**

线性模型的另一个强大用途是**[灵敏度分析](@entry_id:147555) (sensitivity analysis)**。[矩阵方程](@entry_id:203695) $P = B' \theta$ 反映了相角对功率注入的响应。通过求解该方程，我们得到 $\theta = (B')^{-1} P$。

这个[逆矩阵](@entry_id:140380) $(B')^{-1}$ 的元素具有重要的物理意义：元素 $((B')^{-1})_{ij}$ 正是**相角-功率灵敏度** $\frac{\partial \theta_i}{\partial P_j}$，它量化了节点 $j$ 处有功功率注入的微小变化对节点 $i$ 处电压相角的影响 。这些灵敏度因子在系统运行和控制中至关重要，例如，它们可用于评估[发电机](@entry_id:268282)出力的变化对全网潮流分布的影响，或识别网络中的拥塞瓶颈。

### 先进的图论建模技术

基于[关联矩阵](@entry_id:263683)和[拉普拉斯矩阵](@entry_id:152110)的基础框架，我们可以构建更复杂、更贴近现实的能源系统模型。

#### 网络化简与等效

大型能源[网络模型](@entry_id:136956)可能包含成千上万个节点，直接分析计算成本高昂。在许多情况下，我们只关心网络中一小部分**边界节点 (boundary nodes)**（或端口）的行为，而对**内部节点 (interior nodes)** 的详细状态不感兴趣。**网络化简 (network reduction)** 或**等效 (equivalencing)** 技术允许我们“隐藏”内部节点，得到一个只包含边界节点的简化等效网络。

**克朗削减 (Kron Reduction)** 是一种基于图拉普拉斯矩阵的系统化简方法 。其基本思想是将拉普拉斯矩阵 $L$ 按照边界节点 ($b$) 和内部节点 ($i$) 进行分块：
$$
\begin{pmatrix} P_b \\ P_i \end{pmatrix} = \begin{pmatrix} L_{bb}  & L_{bi} \\ L_{ib}  & L_{ii} \end{pmatrix} \begin{pmatrix} T_b \\ T_i \end{pmatrix}
$$
其中 $T$ 是节点势向量（如温度或电压），$P$ 是注入向量。假设内部节点没有外部注入（$P_i=0$），我们可以从第二个方程中解出 $T_i = -L_{ii}^{-1} L_{ib} T_b$。将其代入第一个方程，我们得到一个只涉及边界节点的等效系统：
$$
P_b = (L_{bb} - L_{bi} L_{ii}^{-1} L_{ib}) T_b
$$
等效的降阶电导矩阵 $L_{\text{red}} = L_{bb} - L_{bi} L_{ii}^{-1} L_{ib}$ 在数学上被称为 $L_{ii}$ 在 $L$ 中的**[舒尔补](@entry_id:142780) (Schur complement)**。这个降阶矩阵精确地描述了边界节点之间的等效连接关系，即使原始网络中这些节点之间并无直接连接。

#### 不确定性下的状态估计

在实际系统中，我们无法完美地测量所有状态变量。相反，我们只能通过一组带有噪声的测量值（如部分线路的流量和部分节点的注入功率）来推断整个网络的状态（如所有节点的电压或相角）。这就是**状态估计 (state estimation)** 问题。

**[加权最小二乘法](@entry_id:177517) (Weighted Least Squares, WLS)** 是解决此问题的标准方法 。首先，我们将所有可测量的物理量表示为待估计[状态向量](@entry_id:154607) $x$（如节点电位）的线性函数。这个关系可以统一写成：
$$
z_{\text{true}} = H x
$$
其中 $z_{\text{true}}$ 是真实测量值的向量，**测量矩阵 (measurement matrix)** $H$ 的每一行都来自我们已经建立的图论模型。例如：
- 如果测量的是边 $e$ 的流量，则 $H$ 的对应行是 $G A^{\top}$ 的第 $e$ 行。
- 如果测量的是节点 $i$ 的注入，则 $H$ 的对应行是[拉普拉斯矩阵](@entry_id:152110) $L = A G A^{\top}$ 的第 $i$ 行。

实际测量值 $z$ 包含噪声 $\epsilon$，即 $z = Hx + \epsilon$。WLS 的目标是找到一个状态估计值 $\hat{x}$，使得加权[残差平方和](@entry_id:174395)最小化。权重通常取为测量[误差方差](@entry_id:636041)的倒数，即对更精确的测量给予更高的权重。通过求解相应的**[正规方程](@entry_id:142238) (normal equations)**，我们可以得到最优的状态估计值 $\hat{x}$。状态估计是现代能源管理系统 (EMS) 的核心功能，为系统的安全监控和经济调度提供了基础数据。

#### 耦合[多层网络](@entry_id:261728)建模

现代能源系统日益呈现出多种能源载体深度耦合的特征，例如，电解槽利用[电力](@entry_id:264587)生产氢气，燃气轮机利用天然气发电。这种耦合可以通过**[多路复用](@entry_id:266234)图 (multiplex graphs)** 或**多层网络 (multilayer networks)** 来建模 。

在一个包含[电力](@entry_id:264587)层和氢气层的双层网络模型中，每一层都有其自身的拓扑结构和[拉普拉斯矩阵](@entry_id:152110) ($L^E, L^H$)。两层之间的能量转换发生在特定的**耦合节点 (coupling nodes)** 上。这种耦合可以通过一个能量泛函中的耦合项来表示。例如，一个二次惩罚项 $\frac{1}{2}(u^E - k u^H)^{\top} \Gamma (u^E - k u^H)$ 可以模拟电转氢过程，其中 $u^E, u^H$ 分别是[电力](@entry_id:264587)和氢气网络的势向量，$k$ 是转换效率，[对角矩阵](@entry_id:637782) $\Gamma$ 指定了耦合设备的位置和强度。

通过最小化包含各层自身耗散以及层间耦合惩罚的总能量泛函，我们可以推导出一个统一的、更大规模的[块矩阵](@entry_id:148435)[线性系统](@entry_id:147850)。该系统的解同时给出了两个耦合网络的平衡状态。这种方法提供了一个可扩展的框架，用于分析和优化包含电、气、热等多种能源形式的综合能源系统。

#### 随机与鲁棒[不确定性建模](@entry_id:268420)

可再生能源的间歇性和负荷的波动性给能源网络带来了显著的不确定性。在网络规划和运行中，必须考虑这些不确定性，以确保系统的可靠性。图论模型为处理不确定性提供了坚实的基础 。

首先，我们建立从不确定的输入（如非摇摆节点的功率注入 $w_{\text{red}}$）到我们关心的输出（如线路潮流 $f$）的线性灵敏度模型 $f = S w_{\text{red}}$。

1.  **随机方法 (Stochastic Approach)**：此方法将不确定输入建模为[随机变量](@entry_id:195330)，例如，假设 $w_{\text{red}}$ 服从均值为 $\mu$、协方差为 $\Sigma$ 的[多元正态分布](@entry_id:175229)。由于 $f$ 是 $w_{\text{red}}$ 的[线性变换](@entry_id:149133)，因此线路潮流 $f$ 也服从正态分布，其均值和方差可以很容易地通过[灵敏度矩阵](@entry_id:1131475) $S$ 计算出来。基于此，我们可以设置**概率约束 (chance constraints)**，例如，要求某条线路的潮流超载的概率不高于某个阈值（如 $1\%$)。通过求解这些概率约束，可以确定为保证系统在一定[置信水平](@entry_id:182309)下安全运行所需的裕度或容量扩展。

2.  **鲁棒方法 (Robust Approach)**：与依赖概率分布不同，鲁棒方法假设不确定输入属于一个确定的**[不确定集](@entry_id:634516) (uncertainty set)**，例如一个以均值为中心、由[协方差矩阵](@entry_id:139155)定义的椭球。我们的目标是确保系统对于该集合内**所有可能**的扰动都能保持安全。这意味着我们需要找到在[不确定集](@entry_id:634516)内导致最坏情况（如最大线路潮流）的扰动。利用范数理论和柯西-[施瓦茨不等式](@entry_id:202153)，我们可以解析地计算出在椭球[不确定集](@entry_id:634516)下的最坏情况潮流。基于这个最坏情况，我们可以确定确保系统“免疫”所有预设不确定性的容量要求。

这两种方法从不同角度应对不确定性，为设计和运行能够在复杂多变环境中可靠工作的未来能源系统提供了关键的分析工具。