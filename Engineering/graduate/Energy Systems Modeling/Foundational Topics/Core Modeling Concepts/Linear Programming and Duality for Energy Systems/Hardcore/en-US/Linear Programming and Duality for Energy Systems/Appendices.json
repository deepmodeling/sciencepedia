{
    "hands_on_practices": [
        {
            "introduction": "Understanding how electricity prices vary by location is fundamental to modern energy market design. This exercise explores the core concept of Locational Marginal Prices (LMPs) by modeling a simple two-node system with a transmission constraint. By solving this economic dispatch problem and analyzing its dual variables, you will directly derive the price differential caused by network congestion and see how shadow prices reveal the marginal cost of supplying energy at different points in the grid .",
            "id": "4101761",
            "problem": "Consider a single-line, two-node electricity system operated over a single time interval. Node A has a thermal generator with constant marginal cost $20/\\mathrm{MWh}$ and capacity $\\bar{g}_A = 200$ megawatts. Node B has a thermal generator with constant marginal cost $50/\\mathrm{MWh}$ and capacity $\\bar{g}_B = 100$ megawatts. The demand at node A is $d_A = 120$ megawatts and the demand at node B is $d_B = 60$ megawatts. Power can flow from node A to node B over a single transmission line with capacity $\\bar{f} = 30$ megawatts in either direction.\n\nFormulate the system dispatch as a linear program that minimizes total generation cost subject to nodal power balance, generator capacity limits, and transmission capacity limits. Using a rigorous derivation from linear programming duality and complementary slackness, determine the shadow price of the nodal balance constraint at node B, which equals the sensitivity (derivative) of the minimum total cost with respect to an infinitesimal increase in $d_B$.\n\nReport the final value in dollars per megawatt-hour ($/\\mathrm{MWh}$). The final answer must be a single real number with no units in the box.",
            "solution": "The problem is assessed to be valid. It is a well-posed, scientifically grounded, and objective problem in the field of energy systems modeling, specifically concerning economic dispatch and linear programming duality. All necessary data and constraints are provided, and they are internally consistent.\n\nThe problem asks for the shadow price of the nodal balance constraint at node B. This is equivalent to finding the value of the dual variable associated with this constraint in the context of a cost-minimization linear program (LP).\n\nFirst, we formulate the primal LP. Let the decision variables be:\n- $g_A$: The power generated at node A in megawatts (MW).\n- $g_B$: The power generated at node B in megawatts (MW).\n- $f_{AB}$: The power flow from node A to node B in megawatts (MW). A positive value indicates flow from A to B, and a negative value indicates flow from B to A.\n\nThe objective is to minimize the total generation cost, $Z$, which is a linear function of the generation levels:\n$$\n\\text{Minimize } Z = 20 g_A + 50 g_B\n$$\n\nThis minimization is subject to several constraints:\n\n1.  **Nodal Power Balance**: At each node, power generation plus inflow must equal power demand plus outflow.\n    -   Node A: $g_A = d_A + f_{AB}$. Given $d_A = 120$, this is $g_A - f_{AB} = 120$.\n    -   Node B: $g_B + f_{AB} = d_B$. Given $d_B = 60$, this is $g_B + f_{AB} = 60$.\n\n2.  **Generator Capacity Limits**: The output of each generator cannot exceed its capacity, and must be non-negative.\n    -   $0 \\le g_A \\le \\bar{g}_A$, where $\\bar{g}_A = 200$. So, $0 \\le g_A \\le 200$.\n    -   $0 \\le g_B \\le \\bar{g}_B$, where $\\bar{g}_B = 100$. So, $0 \\le g_B \\le 100$.\n\n3.  **Transmission Capacity Limits**: The power flow on the line between A and B cannot exceed its capacity in either direction.\n    -   $-\\bar{f} \\le f_{AB} \\le \\bar{f}$, where $\\bar{f} = 30$. So, $-30 \\le f_{AB} \\le 30$.\n\nTo find the optimal solution to this primal problem, we observe that generation at node A is cheaper ($20/\\mathrm{MWh}$) than at node B ($50/\\mathrm{MWh}$). The system will therefore attempt to maximize the use of generator A to serve the total demand of $d_A + d_B = 120 + 60 = 180$ MW. If transmission were unlimited, the optimal solution would be $g_A = 180$ MW and $g_B = 0$ MW. This would require a flow $f_{AB}$ to satisfy the nodal balances:\n- Node A: $180 = 120 + f_{AB} \\implies f_{AB} = 60$ MW.\n- Node B: $0 + f_{AB} = 60 \\implies f_{AB} = 60$ MW.\nHowever, this flow of $60$ MW violates the transmission capacity limit of $30$ MW. The transmission line is congested. Therefore, the flow from A to B will be at its maximum capacity, $f_{AB} = 30$ MW.\n\nWith the flow fixed by the congestion, $f_{AB} = 30$ MW, we can determine the optimal generation levels:\n- From the node A balance: $g_A = 120 + f_{AB} = 120 + 30 = 150$ MW. This is feasible as $0 \\le 150 \\le 200$.\n- From the node B balance: $g_B = 60 - f_{AB} = 60 - 30 = 30$ MW. This is feasible as $0 \\le 30 \\le 100$.\n\nSo, the optimal primal solution is $g_A^* = 150$, $g_B^* = 30$, and $f_{AB}^* = 30$.\n\nTo find the shadow price, we must use LP duality. Let's define the nodal balance constraints in a standard form suitable for interpreting the dual variables as prices. Let the dual variable $\\lambda_A$ be associated with the node A balance and $\\lambda_B$ with the node B balance.\n$$\n120 + f_{AB} - g_A = 0 \\quad (\\lambda_A)\n$$\n$$\n60 - f_{AB} - g_B = 0 \\quad (\\lambda_B)\n$$\nWith this formulation, the dual variable $\\lambda_B$ represents the sensitivity of the optimal cost to a change in the demand at node B, $\\frac{\\partial Z^*}{\\partial d_B}$, which is what the problem asks for.\n\nThe other constraints are inequalities:\n$$\ng_A - 200 \\le 0 \\quad (\\mu_{A,up} \\ge 0)\n$$\n$$\n-g_A \\le 0 \\quad (\\mu_{A,low} \\ge 0)\n$$\n$$\ng_B - 100 \\le 0 \\quad (\\mu_{B,up} \\ge 0)\n$$\n$$\n-g_B \\le 0 \\quad (\\mu_{B,low} \\ge 0)\n$$\n$$\nf_{AB} - 30 \\le 0 \\quad (\\gamma_{up} \\ge 0)\n$$\n$$\n-f_{AB} - 30 \\le 0 \\quad (\\gamma_{low} \\ge 0)\n$$\nThe Lagrangian for this problem is:\n$L = (20g_A + 50g_B) + \\lambda_A(120 + f_{AB} - g_A) + \\lambda_B(60 - f_{AB} - g_B) + \\mu_{A,up}(g_A - 200) + \\mu_{A,low}(-g_A) + \\mu_{B,up}(g_B - 100) + \\mu_{B,low}(-g_B) + \\gamma_{up}(f_{AB} - 30) + \\gamma_{low}(-f_{AB} - 30)$.\n\nThe Karush-Kuhn-Tucker (KKT) conditions for optimality require the partial derivatives of the Lagrangian with respect to the primal variables to be zero:\n$$\n\\frac{\\partial L}{\\partial g_A} = 20 - \\lambda_A + \\mu_{A,up} - \\mu_{A,low} = 0\n$$\n$$\n\\frac{\\partial L}{\\partial g_B} = 50 - \\lambda_B + \\mu_{B,up} - \\mu_{B,low} = 0\n$$\n$$\n\\frac{\\partial L}{\\partial f_{AB}} = \\lambda_A - \\lambda_B + \\gamma_{up} - \\gamma_{low} = 0\n$$\nThe complementary slackness conditions state that if an inequality constraint is not binding (i.e., the slack is non-zero), its corresponding dual variable must be zero. We evaluate this at the optimal primal solution $(g_A^* = 150, g_B^* = 30, f_{AB}^* = 30)$:\n- $0 < g_A^* < 200 \\implies$ both $g_A$ capacity constraints are not binding. Thus, $\\mu_{A,up} = 0$ and $\\mu_{A,low} = 0$.\n- $0 < g_B^* < 100 \\implies$ both $g_B$ capacity constraints are not binding. Thus, $\\mu_{B,up} = 0$ and $\\mu_{B,low} = 0$.\n- $f_{AB}^* = 30 \\implies$ the upper transmission limit $f_{AB} \\le 30$ is binding. Thus, $\\gamma_{up} \\ge 0$.\n- $f_{AB}^* = 30 > -30 \\implies$ the lower transmission limit $f_{AB} \\ge -30$ (or $-f_{AB} \\le 30$) is not binding. Thus, $\\gamma_{low} = 0$.\n\nSubstituting these values into the KKT conditions:\n1.  From the $\\frac{\\partial L}{\\partial g_A}$ equation: $20 - \\lambda_A + 0 - 0 = 0 \\implies \\lambda_A = 20$.\n2.  From the $\\frac{\\partial L}{\\partial g_B}$ equation: $50 - \\lambda_B + 0 - 0 = 0 \\implies \\lambda_B = 50$.\n\nThe value of the dual variable associated with the nodal balance constraint at node B is $\\lambda_B = 50$. This value represents the marginal cost of supplying an additional megawatt-hour of electricity at node B. Since the transmission line from the cheaper source (A) is congested, any additional demand at B must be met by the local, more expensive generator (B), which has a marginal cost of $50/\\mathrm{MWh}$.\n\nAs a consistency check, we can use the third KKT condition:\n$\\lambda_A - \\lambda_B + \\gamma_{up} - \\gamma_{low} = 0 \\implies 20 - 50 + \\gamma_{up} - 0 = 0 \\implies \\gamma_{up} = 30$.\nThe value $\\gamma_{up} = 30$ is non-negative, consistent with the KKT conditions. This dual variable represents the congestion rent on the transmission line, which is equal to the difference in the locational marginal prices between the two nodes.\n\nThe shadow price of the nodal balance constraint at node B is $\\lambda_B$.",
            "answer": "$$\\boxed{50}$$"
        },
        {
            "introduction": "Energy systems are inherently dynamic, with decisions in one hour impacting feasibility in the next. This practice builds upon the static dispatch model by introducing inter-temporal constraints, specifically a generator's ramping limits, over a multi-period horizon. You will formulate a dynamic dispatch problem and use duality theory to dissect the components of the energy price, isolating the scarcity value created when both capacity and ramping limits are binding simultaneously .",
            "id": "4101753",
            "problem": "Consider a single-node power system operated over $T=3$ discrete periods with one conventional generator. The system must respect energy balance, generator capacity, and inter-temporal ramping limits. Let the generatorâ€™s initial output be $x_0=20 \\text{ MW}$. For periods $t \\in \\{1,2,3\\}$, the net demand is $d_1=30 \\text{ MW}$, $d_2=80 \\text{ MW}$, and $d_3=60 \\text{ MW}$. The generator has a nameplate capacity $P^{\\max}=70 \\text{ MW}$, an upward ramp limit $R^{\\uparrow}=40 \\text{ MW}$ per period, and a downward ramp limit $R^{\\downarrow}=30 \\text{ MW}$ per period. The generator has a constant variable production cost of $c_t=30 \\text{ \\$/MWh}$ for all $t$. To ensure feasibility, involuntary load shedding $s_t \\ge 0$ (measured in MWh per period) is permitted, incurring a penalty equal to the Value of Lost Load (VoLL), with $v=1000 \\text{ \\$/MWh}$. \n\nFormulate the centralized dispatch as a Linear Programming (LP) problem that minimizes total variable production cost plus the cost of involuntary load shedding, subject to:\n- Energy balance in each period,\n- Generator capacity bounds,\n- Upward and downward ramping constraints between consecutive periods,\n- Nonnegativity constraints.\n\nThen, starting from core definitions of LP duality and complementary slackness, derive the dual conditions and use them to compute the unique aggregate scarcity value in period $t=2$ arising from the binding generator capacity upper bound and the binding upward ramp constraint. Specifically, compute the quantity $\\alpha_2 + \\rho_2^{\\uparrow}$, where $\\alpha_2$ is the shadow price for the period-$2$ capacity upper bound and $\\rho_2^{\\uparrow}$ is the shadow price for the period-$2$ upward ramp constraint, both evaluated at the primal optimum.\n\nExpress your final answer in $\\mathrm{\\$/MWh}$. No rounding is required. Your final answer must be a single real number.",
            "solution": "The user wants me to solve and analyze a single-node power system dispatch problem using linear programming (LP) and duality theory.\n\n### Step 1: Extract Givens\n-   Time periods: $T=3$ discrete periods.\n-   Decision variables: Generator output $x_t$ [MW] and involuntary load shedding $s_t$ [MWh per period] for $t \\in \\{1,2,3\\}$.\n-   Initial condition: Initial generator output $x_0 = 20$ MW.\n-   Demand: $d_1 = 30$ MW, $d_2 = 80$ MW, $d_3 = 60$ MW.\n-   Generator parameters:\n    -   Maximum capacity: $P^{\\max} = 70$ MW.\n    -   Upward ramp limit: $R^{\\uparrow} = 40$ MW per period.\n    -   Downward ramp limit: $R^{\\downarrow} = 30$ MW per period.\n    -   Variable production cost: $c_t = 30 \\text{ \\$/MWh}$ for all $t$.\n-   Load shedding parameters:\n    -   Value of Lost Load (VoLL): $v = 1000 \\text{ \\$/MWh}$.\n-   Non-negativity: $s_t \\ge 0$. The generator output $x_t$ is also implicitly non-negative.\n-   Objective: Compute the aggregate scarcity value $\\alpha_2 + \\rho_2^{\\uparrow}$ in period $t=2$.\n\nThe problem implicitly assumes a time step of $\\Delta t=1$ hour for each period, as variable costs are given in $\\$/MWh$ and load shedding in MWh per period. Therefore, power quantities in MW are numerically equivalent to energy quantities in MWh for each period. All constraints will be treated in terms of energy (MWh).\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is a standard, simplified economic dispatch model, a cornerstone of energy systems analysis. It is firmly based on the principles of linear programming and its application to power systems. It is scientifically sound.\n-   **Well-Posed**: The problem is a linear program with a convex feasible set and a linear objective function. An optimal solution is guaranteed to exist. The provided data appears to lead to a unique optimum.\n-   **Objective**: The problem is stated using precise, objective mathematical and economic terms (e.g., cost, capacity, ramp limits).\n-   **Completeness and Consistency**: The problem provides all necessary data and constraints to formulate and solve the LP. There are no contradictions in the provided data.\n-   **Conclusion**: The problem is valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with the solution.\n\n### Primal Problem Formulation\nThe objective is to minimize the total system cost, which is the sum of generation costs and load shedding costs.\nLet the decision variables be the generator output $x_t$ and load shedding $s_t$ for each period $t \\in \\{1, 2, 3\\}$.\n\nThe LP problem is:\n$$\n\\min_{x_t, s_t} \\sum_{t=1}^{3} (c_t x_t + v s_t)\n$$\nsubject to:\n\\begin{align*}\nx_t + s_t &= d_t & & \\forall t \\in \\{1,2,3\\} & & \\text{(Energy Balance)} \\\\\nx_t &\\le P^{\\max} & & \\forall t \\in \\{1,2,3\\} & & \\text{(Capacity Upper Bound)} \\\\\nx_t &\\ge 0 & & \\forall t \\in \\{1,2,3\\} & & \\text{(Capacity Lower Bound)} \\\\\nx_t - x_{t-1} &\\le R^{\\uparrow} & & \\forall t \\in \\{1,2,3\\} & & \\text{(Upward Ramp)} \\\\\nx_{t-1} - x_t &\\le R^{\\downarrow} & & \\forall t \\in \\{1,2,3\\} & & \\text{(Downward Ramp)} \\\\\ns_t &\\ge 0 & & \\forall t \\in \\{1,2,3\\} & & \\text{(Non-negative Shedding)}\n\\end{align*}\nwhere $x_0 = 20$ is a given parameter.\n\n### Primal Solution\nWe can solve this small problem by inspection, minimizing the use of the expensive load shedding ($s_t$) at each step while respecting the constraints.\n\n*   **Period $t=1$**:\n    *   Demand is $d_1 = 30$.\n    *   Ramping from $x_0=20$: $20 - R^{\\downarrow} \\le x_1 \\le 20 + R^{\\uparrow} \\implies 20 - 30 \\le x_1 \\le 20 + 40 \\implies -10 \\le x_1 \\le 60$.\n    *   Capacity limits: $0 \\le x_1 \\le P^{\\max} = 70$.\n    *   The feasible range for $x_1$ is thus $[0, 60]$. To meet the demand $d_1=30$ with minimal cost, we set $x_1^* = 30$, which is feasible. This allows for zero load shedding, $s_1^* = 0$.\n\n*   **Period $t=2$**:\n    *   Demand is $d_2 = 80$.\n    *   Ramping from $x_1^*=30$: $30 - R^{\\downarrow} \\le x_2 \\le 30 + R^{\\uparrow} \\implies 30 - 30 \\le x_2 \\le 30 + 40 \\implies 0 \\le x_2 \\le 70$.\n    *   Capacity limits: $0 \\le x_2 \\le P^{\\max} = 70$.\n    *   The feasible range for $x_2$ is thus $[0, 70]$. The demand is $d_2=80$. To minimize cost, we must maximize generation $x_2$. The maximum possible value is $x_2^* = 70$.\n    *   This output is insufficient to meet the full demand. The energy balance $x_2^* + s_2^* = d_2$ gives $70 + s_2^* = 80$, so we must have involuntary load shedding $s_2^* = 10$.\n\n*   **Period $t=3$**:\n    *   Demand is $d_3 = 60$.\n    *   Ramping from $x_2^*=70$: $70 - R^{\\downarrow} \\le x_3 \\le 70 + R^{\\uparrow} \\implies 70 - 30 \\le x_3 \\le 70 + 40 \\implies 40 \\le x_3 \\le 110$.\n    *   Capacity limits: $0 \\le x_3 \\le P^{\\max} = 70$.\n    *   The feasible range for $x_3$ is $[40, 70]$. To meet demand $d_3=60$ with minimal cost, we set $x_3^* = 60$, which is feasible. This results in zero load shedding, $s_3^* = 0$.\n\nThe optimal primal solution is:\n$x_1^* = 30$, $s_1^* = 0$\n$x_2^* = 70$, $s_2^* = 10$\n$x_3^* = 60$, $s_3^* = 0$\n\n### Dual Problem and KKT Conditions\nTo find the shadow prices, we formulate the dual problem. Let us assign dual variables to each constraint of the primal problem:\n\\begin{align*}\nx_t + s_t = d_t & \\quad : \\lambda_t \\quad (\\text{free}) \\\\\nx_t \\le P^{\\max} & \\quad : \\alpha_t \\ge 0 \\\\\n-x_t \\le 0 & \\quad : \\beta_t \\ge 0 \\\\\nx_t - x_{t-1} \\le R^{\\uparrow} & \\quad : \\rho_t^{\\uparrow} \\ge 0 \\\\\nx_{t-1} - x_t \\le R^{\\downarrow} & \\quad : \\rho_t^{\\downarrow} \\ge 0 \\\\\n-s_t \\le 0 & \\quad : \\sigma_t \\ge 0\n\\end{align*}\n\nThe Karush-Kuhn-Tucker (KKT) conditions for optimality include stationarity and complementary slackness. The stationarity conditions, derived from the Lagrangian, are:\n\\begin{itemize}\n    \\item For $s_t$: $v - \\lambda_t - \\sigma_t = 0 \\implies \\lambda_t + \\sigma_t = v$ for $t \\in \\{1,2,3\\}$.\n    \\item For $x_t$: The general form is $c_t - \\lambda_t + \\alpha_t - \\beta_t + (\\rho_t^{\\uparrow} - \\rho_t^{\\downarrow}) - (\\rho_{t+1}^{\\uparrow} - \\rho_{t+1}^{\\downarrow}) = 0$, where we define $\\rho_4^{\\uparrow} = \\rho_4^{\\downarrow} = 0$.\n\\end{itemize}\nComplementary slackness requires that for any inequality constraint, either the constraint is binding (holds with equality) or its corresponding dual variable is zero.\n\n### Computing the Scarcity Value $\\alpha_2 + \\rho_2^{\\uparrow}$\nWe need to compute $\\alpha_2 + \\rho_2^{\\uparrow}$. We focus on the KKT conditions for period $t=2$.\n\n1.  **Stationarity on $s_2$**: The condition is $\\lambda_2 + \\sigma_2 = v$.\n    At the optimum, $s_2^* = 10 > 0$. By complementary slackness for the constraint $-s_2 \\le 0$, the corresponding dual variable $\\sigma_2$ must be zero.\n    Therefore, $\\lambda_2 + 0 = v \\implies \\lambda_2 = v = 1000$. The shadow price of energy in period $2$, $\\lambda_2$, is equal to the Value of Lost Load, which is expected since load is being shed.\n\n2.  **Stationarity on $x_2$**: The condition for $t=2$ is:\n    $$c_2 - \\lambda_2 + \\alpha_2 - \\beta_2 + (\\rho_2^{\\uparrow} - \\rho_2^{\\downarrow}) - (\\rho_3^{\\uparrow} - \\rho_3^{\\downarrow}) = 0$$\n    We can solve for the quantity of a interest, $\\alpha_2 + \\rho_2^{\\uparrow}$, by determining the other dual variables using complementary slackness.\n\n3.  **Applying Complementary Slackness for Period 2**:\n    *   $x_2^* = 70 > 0$. The constraint $-x_2 \\le 0$ is not binding, so $\\beta_2 = 0$.\n    *   $x_2^* = 70 = P^{\\max}$. The capacity upper bound $x_2 \\le P^{\\max}$ is **binding**. Thus, $\\alpha_2 \\ge 0$.\n    *   $x_2^* - x_1^* = 70 - 30 = 40 = R^{\\uparrow}$. The upward ramp constraint $x_2 - x_1 \\le R^{\\uparrow}$ is **binding**. Thus, $\\rho_2^{\\uparrow} \\ge 0$.\n    *   $x_1^* - x_2^* = 30 - 70 = -40$. Since $-40 < R^{\\downarrow} = 30$, the downward ramp constraint is not binding. Thus, $\\rho_2^{\\downarrow} = 0$.\n\n4.  **Applying Complementary Slackness for Period 3 (to find future--related terms)**:\n    *   $x_3^* - x_2^* = 60 - 70 = -10$. Since $-10 < R^{\\uparrow} = 40$, the upward ramp constraint $x_3 - x_2 \\le R^{\\uparrow}$ is not binding. Thus, $\\rho_3^{\\uparrow} = 0$.\n    *   $x_2^* - x_3^* = 70 - 60 = 10$. Since $10 < R^{\\downarrow} = 30$, the downward ramp constraint $x_2 - x_3 \\le R^{\\downarrow}$ is not binding. Thus, $\\rho_3^{\\downarrow} = 0$.\n\n5.  **Final Calculation**: Substitute the known dual variable values into the stationarity equation for $x_2$:\n    $$c_2 - \\lambda_2 + \\alpha_2 - 0 + (\\rho_2^{\\uparrow} - 0) - (0 - 0) = 0$$\n    This simplifies to:\n    $$c_2 - \\lambda_2 + \\alpha_2 + \\rho_2^{\\uparrow} = 0$$\n    Rearranging to solve for the target expression:\n    $$\\alpha_2 + \\rho_2^{\\uparrow} = \\lambda_2 - c_2$$\n    We have $\\lambda_2 = 1000 \\text{ \\$/MWh}$ and are given $c_2 = 30 \\text{ \\$/MWh}$.\n    $$\\alpha_2 + \\rho_2^{\\uparrow} = 1000 - 30 = 970$$\nThe aggregate scarcity value $\\alpha_2 + \\rho_2^{\\uparrow}$ is $970 \\text{ \\$/MWh}$. This value represents the total marginal cost increase in period $2$ due to hitting the generator's physical capacity limit and its inter-temporal ramp-up limit simultaneously. It is the amount by which the marginal cost of energy, $\\lambda_2$, exceeds the generator's marginal production cost, $c_2$.",
            "answer": "$$\\boxed{970}$$"
        },
        {
            "introduction": "While linear programming provides a powerful framework for dispatch, real-world generator operations involve discrete on/off decisions and start-up costs, which introduce non-convexities. This requires Mixed-Integer Linear Programming (MILP), where the concept of a marginal price becomes complex. This problem challenges you to evaluate the theoretical breakdown of simple LP duality in MILP settings and to identify practical, widely-used methods for approximating scarcity prices in non-convex unit commitment problems .",
            "id": "4098493",
            "problem": "Consider a stylized single-node unit commitment and economic dispatch problem over a horizon of $T=3$ time periods with inelastic demand $d_1=50$, $d_2=10$, and $d_3=50$ (in $\\mathrm{MW}$). A single thermal unit has continuous dispatch $p_t \\in [0, P^{\\max}]$ with $P^{\\max}=100$ (in $\\mathrm{MW}$), a linear variable cost $c=20$ (in $\\$/\\mathrm{MWh}$), a binary on/off status $u_t \\in \\{0,1\\}$, a binary start indicator $y_t \\in \\{0,1\\}$, a start-up cost $S=1000$ (in $\\$$), a minimum up-time $L^{\\text{up}}=2$ (in periods), and a minimum down-time $L^{\\text{down}}=2$ (in periods). Standard linking constraints couple $p_t$ and $u_t$, enforce inter-temporal logic between $u_t$, $y_t$, and the shut-down indicator $z_t \\in \\{0,1\\}$, and implement the minimum up/down time requirements. System-wide power balance must hold each period: $p_t = d_t$.\n\nLet the problem be formulated as a mixed-integer linear program (MILP) that minimizes total cost over $t=1,2,3$ subject to these constraints. A researcher seeks to interpret dual variables to the power balance constraints as scarcity prices for energy and to understand how the minimum up/down time constraints affect that interpretation.\n\nWhich of the following statements are correct about the interpretation of dual variables in this setting and about practical ways to approximate scarcity signals?\n\nA. In the presence of minimum up/down time constraints, the dual variable of the power balance constraint in the MILP remains well-defined and equals the true marginal system cost of supplying an additional $\\mathrm{MWh}$ at each time $t$, with no caveats.\n\nB. Because integrality destroys convexity and strong duality, dual variables in an MILP do not generally have the usual marginal interpretation; a common workaround is to fix the binary variables $u_t$, $y_t$, and $z_t$ at their optimal MILP values and re-solve the resulting linear dispatch problem to obtain dual variables for the balance constraints as approximate scarcity prices.\n\nC. Using dual variables from the linear programming (LP) relaxation of the MILP necessarily overestimates scarcity whenever any integer constraint is binding in the MILP; thus LP relaxation duals cannot be used even qualitatively as scarcity signals.\n\nD. Lagrangian relaxation that dualizes the system-wide coupling constraints (such as the power balance) produces subgradients that can serve as prices; with appropriate decomposition and convex-hull pricing constructions, these prices approximate scarcity signals but may require uplift payments to ensure revenue adequacy for nonconvex units.\n\nE. Introducing large penalty coefficients via a big-$M$ formulation for minimum up/down constraints ensures that, as $M \\to \\infty$, the MILP dual variables to balance converge to the exact scarcity prices of the nonconvex problem.\n\nSelect all that apply. Do not assume any additional modeling features beyond those stated, and base your reasoning on fundamental properties of linear programming duality, convexity, and Lagrangian relaxation rather than on solver-specific artifacts.",
            "solution": "The problem statement describes a stylized unit commitment (UC) problem, which is a classic mixed-integer linear program (MILP) in power systems engineering. The core challenge is to interpret the economic meaning of dual variables associated with the power balance constraints in the presence of non-convexities introduced by integer variables (e.g., on/off status $u_t$, start-up indicators $y_t$) and the associated inter-temporal constraints like minimum up-time and minimum down-time.\n\nThe fundamental principle governing the interpretation of dual variables is strong duality, which holds for convex optimization problems like linear programs (LPs). For an LP, the dual variable of a constraint represents the marginal change in the optimal objective value for a unit relaxation of that constraint's right-hand side. In the context of economic dispatch, the dual of the power balance constraint is the system marginal price (SMP), i.e., the cost to supply one additional megawatt-hour ($\\mathrm{MWh}$) of energy.\n\nHowever, the UC problem as described is an MILP. The presence of integer variables $u_t \\in \\{0,1\\}$ makes the feasible region non-convex (it is a union of disjoint polyhedra). For non-convex problems, strong duality does not hold. There is generally a non-zero duality gap between the optimal value of the primal MILP and its Lagrangian dual (which is equivalent to the optimal value of its LP relaxation). Consequently, the \"dual variables\" of an MILP do not have the same clear, unambiguous marginal cost interpretation as they do in an LP. A small change in demand $d_t$ can cause a jump in the optimal integer solution (e.g., forcing a unit to start up, incurring a large cost $S=1000$), meaning the sensitivity of the total cost is not a continuous, well-defined marginal value.\n\nWe will now evaluate each statement based on these principles.\n\nA. In the presence of minimum up/down time constraints, the dual variable of the power balance constraint in the MILP remains well-defined and equals the true marginal system cost of supplying an additional $\\mathrm{MWh}$ at each time $t$, with no caveats.\nThis statement is fundamentally incorrect. The minimum up/down time constraints ($L^{\\text{up}}=2$, $L^{\\text{down}}=2$) necessitate the use of integer variables, making the problem a non-convex MILP. As explained above, the concept of a \"dual variable\" in an MILP is not well-defined in the same way as for an LP, and it certainly does not equal the \"true marginal system cost\" without caveats. The cost function is not continuously differentiable with respect to demand due to the discrete nature of commitment decisions. For instance, a marginal increase in demand might require a previously offline unit to be turned on, incurring a large, non-marginal start-up cost $S=1000$. Hence, the marginal cost is ill-defined or multi-valued.\n**Verdict: Incorrect.**\n\nB. Because integrality destroys convexity and strong duality, dual variables in an MILP do not generally have the usual marginal interpretation; a common workaround is to fix the binary variables $u_t$, $y_t$, and $z_t$ at their optimal MILP values and re-solve the resulting linear dispatch problem to obtain dual variables for the balance constraints as approximate scarcity prices.\nThis statement correctly identifies the core theoretical issue: \"integrality destroys convexity and strong duality\" and that MILP duals lack the standard marginal interpretation. It then describes a widely used and practical heuristic in electricity market operations. First, the unit commitment MILP is solved to determine the optimal commitment schedule ($u_t^*$, $y_t^*$, $z_t^*$) for the time horizon $T=3$. Then, for each time period $t$, with the commitment statuses fixed, the problem reduces to a simple economic dispatch LP:\n$$ \\min_{p_t} \\quad c \\cdot p_t $$\n$$ \\text{s.t.} \\quad p_t = d_t $$\n$$ \\quad\\quad 0 \\le p_t \\le P^{\\max} \\cdot u_t^* $$\nSince $u_t^*$ is a fixed parameter ($0$ or $1$), this is an LP. The dual variable of the balance constraint $p_t = d_t$ in this LP is well-defined and provides the marginal cost of energy for that period, *given the fixed commitment*. This is a standard method for calculating locational marginal prices (LMPs) or scarcity prices in day-ahead markets after the commitment is decided. The statement is a precise description of both the theory and practice.\n**Verdict: Correct.**\n\nC. Using dual variables from the linear programming (LP) relaxation of the MILP necessarily overestimates scarcity whenever any integer constraint is binding in the MILP; thus LP relaxation duals cannot be used even qualitatively as scarcity signals.\nThis statement contains two claims, both of which are incorrect. First, the duals of the LP relaxation do not \"necessarily overestimate\" scarcity. The LP relaxation allows fractional commitments (e.g., $u_t=0.5$). This can lead to an underestimation of the true marginal cost. For example, if meeting an extra $\\mathrm{MW}$ of demand truly requires starting a unit (high marginal cost), the LP relaxation might meet it by slightly increasing a fractional $u_t$, resulting in a very low, non-physical marginal cost. Therefore, LP relaxation duals can either overestimate or underestimate the \"true\" scarcity cost, which is itself ill-defined. Second, the claim that they \"cannot be used even qualitatively\" is too strong. While flawed, these duals can provide some indication of system tightness, and they form the basis for more advanced pricing schemes like Lagrangian relaxation. They are not entirely without value, though they must be used with extreme caution.\n**Verdict: Incorrect.**\n\nD. Lagrangian relaxation that dualizes the system-wide coupling constraints (such as the power balance) produces subgradients that can serve as prices; with appropriate decomposition and convex-hull pricing constructions, these prices approximate scarcity signals but may require uplift payments to ensure revenue adequacy for nonconvex units.\nThis statement accurately describes a theoretically robust method for pricing in non-convex markets. In Lagrangian relaxation, system-wide constraints like power balance are relaxed using Lagrange multipliers ($\\lambda_t$). The problem then decomposes into simpler subproblems for each unit. The master problem adjusts the multipliers $\\lambda_t$ to maximize the dual objective function, typically using a subgradient method. These multipliers $\\lambda_t$ act as system-wide prices. The value of the Lagrangian dual is equal to the optimal value of the LP relaxation. To obtain better prices that more accurately reflect the system's non-convexities, the formulation can be tightened by using the convex hull of each unit's feasible operating region. This approach, known as convex hull pricing, yields prices that are generally considered superior. However, due to non-convex costs (like start-up costs $S$), a unit's revenue from these energy prices (price $\\times$ quantity) may not be sufficient to cover its total operating costs. This \"missing money\" problem necessitates out-of-market \"uplift\" payments to ensure revenue adequacy and keep essential units financially viable. The statement correctly describes this entire process.\n**Verdict: Correct.**\n\nE. Introducing large penalty coefficients via a big-$M$ formulation for minimum up/down constraints ensures that, as $M \\to \\infty$, the MILP dual variables to balance converge to the exact scarcity prices of the nonconvex problem.\nThis statement is incorrect for several reasons. First, minimum up/down constraints are typically formulated using direct logical constraints on the binary variables (e.g., $u_t \\ge \\sum_{i=t-L^{\\text{up}}+1}^{t} y_i$), not with a penalty-based big-$M$ approach. Big-$M$ methods are used for other purposes, such as linking $p_t$ to $u_t$ via $p_t \\le P^{\\max} u_t$. Second, even if a big-$M$ method were used, letting $M \\to \\infty$ is numerically unsound and weakens the LP relaxation. Third and most critically, no reformulation of integer constraints can eliminate the fundamental non-convexity of the problem. Thus, the notion of \"MILP dual variables\" converging to \"exact scarcity prices\" is a fallacy. The pricing problem is inherent to the non-convex structure, not the specific formulation technique.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{BD}$$"
        }
    ]
}