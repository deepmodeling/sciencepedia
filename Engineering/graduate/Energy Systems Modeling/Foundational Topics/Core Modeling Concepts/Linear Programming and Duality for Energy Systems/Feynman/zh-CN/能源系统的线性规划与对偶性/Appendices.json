{
    "hands_on_practices": [
        {
            "introduction": "本次练习将深入探讨一个动态经济调度问题。通过分析一个具有跨时段爬坡约束的单一发电机组，你将练习应用卡罗需-库恩-塔克（KKT）条件，揭示物理限制如何随时间产生稀缺性并影响能源价格 。这项实践对于理解电力系统运行的时间耦合特性至关重要。",
            "id": "4101753",
            "problem": "考虑一个单节点电力系统，包含一台常规发电机，在 $T=3$ 个离散时间段内运行。该系统必须满足能量平衡、发电机容量和跨时段的爬坡限制。设发电机的初始出力为 $x_0=20$ $\\mathrm{MW}$。在时间段 $t \\in \\{1,2,3\\}$ 内，净需求分别为 $d_1=30$ $\\mathrm{MW}$、$d_2=80$ $\\mathrm{MW}$ 和 $d_3=60$ $\\mathrm{MW}$。发电机的铭牌容量为 $P^{\\max}=70$ $\\mathrm{MW}$，向上爬坡限制为每个时间段 $R^{\\uparrow}=40$ $\\mathrm{MW}$，向下爬坡限制为每个时间段 $R^{\\downarrow}=30$ $\\mathrm{MW}$。对于所有时间段 $t$，发电机的可变生产成本为常数 $c_t=30$ $\\mathrm{\\$/MWh}$。为确保可行性，允许非自愿切负荷 $s_t \\ge 0$（单位为 $\\mathrm{MWh}$/时间段），其产生的惩罚等于失负荷价值（VoLL），即 $v=1000$ $\\mathrm{\\$/MWh}$。\n\n将集中式调度问题构建为一个线性规划（LP）问题，该问题最小化总可变生产成本与非自愿切负荷成本之和，并满足以下约束：\n- 每个时间段的能量平衡，\n- 发电机容量边界，\n- 连续时间段之间的向上和向下爬坡约束，\n- 非负性约束。\n\n然后，从线性规划对偶和互补松弛的核心定义出发，推导对偶条件，并用它们计算在时间段 $t=2$ 时，由紧约束的发电机容量上限和紧约束的向上爬坡约束产生的唯一聚合稀缺性价值。具体来说，计算量 $\\alpha_2 + \\rho_2^{\\uparrow}$，其中 $\\alpha_2$ 是时间段 2 容量上限的影子价格，$\\rho_2^{\\uparrow}$ 是时间段 2 向上爬坡约束的影子价格，两者都在原问题最优解处取值。\n\n用 $\\mathrm{\\$/MWh}$ 表示你的最终答案。无需四舍五入。你的最终答案必须是一个实数。",
            "solution": "### 第1步：整理问题条件与模型参数\n首先，我们整理问题中给出的已知条件和参数：\n-   时间段：$T=3$ 个离散时间段。\n-   决策变量：发电机出力 $x_t$ [MW] 和非自愿切负荷 $s_t$ [MWh/时间段]，其中 $t \\in \\{1,2,3\\}$。\n-   初始条件：初始发电机出力 $x_0 = 20$ MW。\n-   需求：$d_1 = 30$ MW，$d_2 = 80$ MW，$d_3 = 60$ MW。\n-   发电机参数：\n    -   最大容量：$P^{\\max} = 70$ MW。\n    -   向上爬坡限制：每个时间段 $R^{\\uparrow} = 40$ MW。\n    -   向下爬坡限制：每个时间段 $R^{\\downarrow} = 30$ MW。\n    -   可变生产成本：对于所有 $t$，$c_t = 30 \\mathrm{\\$/MWh}$。\n-   切负荷参数：\n    -   失负荷价值（VoLL）：$v = 1000 \\mathrm{\\$/MWh}$。\n-   非负性：$s_t \\ge 0$。发电机出力 $x_t$ 也隐含为非负。\n-   目标：计算在时间段 $t=2$ 的聚合稀缺性价值 $\\alpha_2 + \\rho_2^{\\uparrow}$。\n\n该问题隐含地假设每个时间段的时间步长为 $\\Delta t=1$ 小时，因为可变成本和切负荷成本均以能量单位给出。因此，对于每个时间段，功率量（MW）在数值上等同于能量量（MWh）。所有约束都将以能量（MWh）的形式处理。\n\n### 第2步：原问题构建与求解\n目标是最小化系统总成本，即发电成本与切负荷成本之和。\n设决策变量为每个时间段 $t \\in \\{1, 2, 3\\}$ 的发电机出力 $x_t$ 和切负荷 $s_t$。\n\n线性规划问题为：\n$$\n\\min_{x_t, s_t} \\sum_{t=1}^{3} (c_t x_t + v s_t)\n$$\n满足约束：\n\\begin{align*}\nx_t + s_t = d_t   \\quad &\\forall t \\in \\{1,2,3\\}    \\text{（能量平衡）} \\\\\nx_t \\le P^{\\max}   \\quad \\forall t \\in \\{1,2,3\\}    \\text{（容量上限）} \\\\\nx_t \\ge 0   \\quad \\forall t \\in \\{1,2,3\\}    \\text{（容量下限）} \\\\\nx_t - x_{t-1} \\le R^{\\uparrow}   \\quad \\forall t \\in \\{1,2,3\\}    \\text{（向上爬坡）} \\\\\nx_{t-1} - x_t \\le R^{\\downarrow}   \\quad \\forall t \\in \\{1,2,3\\}    \\text{（向下爬坡）} \\\\\ns_t \\ge 0   \\quad \\forall t \\in \\{1,2,3\\}    \\text{（非负切负荷）}\n\\end{align*}\n其中 $x_0 = 20$ 是一个给定参数。\n\n我们可以通过观察法求解这个小问题，在满足约束的同时，每一步都尽量减少使用昂贵的切负荷（$s_t$）。\n\n*   **时间段 $t=1$**：\n    *   需求为 $d_1 = 30$。\n    *   从 $x_0=20$ 开始爬坡：$20 - R^{\\downarrow} \\le x_1 \\le 20 + R^{\\uparrow} \\implies 20 - 30 \\le x_1 \\le 20 + 40 \\implies -10 \\le x_1 \\le 60$。\n    *   容量限制：$0 \\le x_1 \\le P^{\\max} = 70$。\n    *   $x_1$ 的可行范围因此是 $[0, 60]$。为了以最小成本满足需求 $d_1=30$，我们设定 $x_1^* = 30$，这是可行的。这使得切负荷为零，$s_1^* = 0$。\n\n*   **时间段 $t=2$**：\n    *   需求为 $d_2 = 80$。\n    *   从 $x_1^*=30$ 开始爬坡：$30 - R^{\\downarrow} \\le x_2 \\le 30 + R^{\\uparrow} \\implies 30 - 30 \\le x_2 \\le 30 + 40 \\implies 0 \\le x_2 \\le 70$。\n    *   容量限制：$0 \\le x_2 \\le P^{\\max} = 70$。\n    *   $x_2$ 的可行范围因此是 $[0, 70]$。需求是 $d_2=80$。为了最小化成本，我们必须最大化发电量 $x_2$。最大可能值为 $x_2^* = 70$。\n    *   这个出力不足以满足全部需求。能量平衡 $x_2^* + s_2^* = d_2$ 给出 $70 + s_2^* = 80$，所以我们必须有非自愿切负荷 $s_2^* = 10$。\n\n*   **时间段 $t=3$**：\n    *   需求为 $d_3 = 60$。\n    *   从 $x_2^*=70$ 开始爬坡：$70 - R^{\\downarrow} \\le x_3 \\le 70 + R^{\\uparrow} \\implies 70 - 30 \\le x_3 \\le 70 + 40 \\implies 40 \\le x_3 \\le 110$。\n    *   容量限制：$0 \\le x_3 \\le P^{\\max} = 70$。\n    *   $x_3$ 的可行范围是 $[40, 70]$。为了以最小成本满足需求 $d_3=60$，我们设定 $x_3^* = 60$，这是可行的。这导致切负荷为零，$s_3^* = 0$。\n\n最优原问题解为：\n$x_1^* = 30$, $s_1^* = 0$\n$x_2^* = 70$, $s_2^* = 10$\n$x_3^* = 60$, $s_3^* = 0$\n\n### 第3步：对偶问题和KKT条件\n为了找到影子价格，我们构建对偶问题。我们为原问题的每个约束分配对偶变量：\n\\begin{align*}\nx_t + s_t = d_t  \\quad : \\lambda_t \\\\\nx_t \\le P^{\\max}  \\quad : \\alpha_t \\ge 0 \\\\\n-x_t \\le 0  \\quad : \\beta_t \\ge 0 \\\\\nx_t - x_{t-1} \\le R^{\\uparrow}  \\quad : \\rho_t^{\\uparrow} \\ge 0 \\\\\nx_{t-1} - x_t \\le R^{\\downarrow}  \\quad : \\rho_t^{\\downarrow} \\ge 0 \\\\\n-s_t \\le 0  \\quad : \\sigma_t \\ge 0\n\\end{align*}\n\n最优性的Karush-Kuhn-Tucker（KKT）条件包括平稳性和互补松弛性。从拉格朗日函数导出的平稳性条件是：\n\\begin{itemize}\n    \\item 对于 $s_t$：$v - \\lambda_t - \\sigma_t = 0 \\implies \\lambda_t + \\sigma_t = v$，对于 $t \\in \\{1,2,3\\}$。\n    \\item 对于 $x_t$：$c_t - \\lambda_t + \\alpha_t - \\beta_t + (\\rho_t^{\\uparrow} - \\rho_t^{\\downarrow}) - (\\rho_{t+1}^{\\uparrow} - \\rho_{t+1}^{\\downarrow}) = 0$，其中我们定义 $\\rho_4^{\\uparrow} = \\rho_4^{\\downarrow} = 0$。\n\\end{itemize}\n互补松弛性要求对于任何不等式约束，要么该约束是紧约束（以等式成立），要么其对应的对偶变量为零。\n\n### 第4步：计算稀缺性价值 $\\alpha_2 + \\rho_2^{\\uparrow}$\n我们需要计算 $\\alpha_2 + \\rho_2^{\\uparrow}$。我们关注时间段 $t=2$ 的KKT条件。\n\n1.  **关于 $s_2$ 的平稳性**：条件是 $\\lambda_2 + \\sigma_2 = v$。\n    在最优解处，$s_2^* = 10 > 0$。根据约束 $-s_2 \\le 0$ 的互补松弛性，其对应的对偶变量 $\\sigma_2$ 必须为零。\n    因此，$\\lambda_2 + 0 = v \\implies \\lambda_2 = v = 1000$。时间段 2 的能量影子价格 $\\lambda_2$ 等于失负荷价值，这是预期的，因为有负荷被切除。\n\n2.  **关于 $x_2$ 的平稳性**：时间段 $t=2$ 的条件是：\n    $$c_2 - \\lambda_2 + \\alpha_2 - \\beta_2 + (\\rho_2^{\\uparrow} - \\rho_2^{\\downarrow}) - (\\rho_3^{\\uparrow} - \\rho_3^{\\downarrow}) = 0$$\n    我们可以通过使用互补松弛性确定其他对偶变量，从而求解我们感兴趣的量 $\\alpha_2 + \\rho_2^{\\uparrow}$。\n\n3.  **应用时间段 2 的互补松弛性**：\n    *   $x_2^* = 70 > 0$。约束 $-x_2 \\le 0$ 不是紧约束，所以 $\\beta_2 = 0$。\n    *   $x_2^* = 70 = P^{\\max}$。容量上限 $x_2 \\le P^{\\max}$ 是**紧约束**。因此，$\\alpha_2 \\ge 0$。\n    *   $x_2^* - x_1^* = 70 - 30 = 40 = R^{\\uparrow}$。向上爬坡约束 $x_2 - x_1 \\le R^{\\uparrow}$ 是**紧约束**。因此，$\\rho_2^{\\uparrow} \\ge 0$。\n    *   $x_1^* - x_2^* = 30 - 70 = -40 \\le R^{\\downarrow} = 30$。向下爬坡约束不是紧约束。因此，$\\rho_2^{\\downarrow} = 0$。\n\n4.  **应用时间段 3 的互补松弛性（以找到与未来相关的项）**：\n    *   $x_3^* - x_2^* = 60 - 70 = -10 \\le R^{\\uparrow} = 40$。向上爬坡约束 $x_3 - x_2 \\le R^{\\uparrow}$ 不是紧约束。因此，$\\rho_3^{\\uparrow} = 0$。\n    *   $x_2^* - x_3^* = 70 - 60 = 10 \\le R^{\\downarrow} = 30$。向下爬坡约束 $x_2 - x_3 \\le R^{\\downarrow}$ 不是紧约束。因此，$\\rho_3^{\\downarrow} = 0$。\n\n5.  **最终计算**：将已知的对偶变量值代入 $x_2$ 的平稳性方程：\n    $$c_2 - \\lambda_2 + \\alpha_2 - 0 + (\\rho_2^{\\uparrow} - 0) - (0 - 0) = 0$$\n    这简化为：\n    $$c_2 - \\lambda_2 + \\alpha_2 + \\rho_2^{\\uparrow} = 0$$\n    重新整理以求解目标表达式：\n    $$\\alpha_2 + \\rho_2^{\\uparrow} = \\lambda_2 - c_2$$\n    我们有 $\\lambda_2 = 1000$ $\\mathrm{\\$/MWh}$ 并且已知 $c_2 = 30$ $\\mathrm{\\$/MWh}$。\n    $$\\alpha_2 + \\rho_2^{\\uparrow} = 1000 - 30 = 970$$\n聚合稀缺性价值 $\\alpha_2 + \\rho_2^{\\uparrow}$ 为 $970$ $\\mathrm{\\$/MWh}$。该值表示在时间段 2，由于同时达到发电机的物理容量极限及其跨时段的向上爬坡极限而导致的总边际成本增加量。它是能量的边际成本 $\\lambda_2$ 超出发电机边际生产成本 $c_2$ 的数额。",
            "answer": "$$\\boxed{970}$$"
        },
        {
            "introduction": "在单节点模型的基础上，本次练习引入了电力系统的空间维度。你将为一个包含输电约束的双节点系统建模，并运用线性规划对偶理论来确定节点边际电价（LMP）。这项练习是理解电网拥堵如何导致不同地区价格差异的关键，这也是现代电力市场设计中的一个核心概念。",
            "id": "4101761",
            "problem": "考虑一个单线路、双节点的电力系统，在单个时间间隔内运行。节点 A 有一个火电机组，其边际成本为每兆瓦时 $20$ 美元，容量为 $\\bar{g}_A = 200$ 兆瓦。节点 B 有一个火电机组，其边际成本为每兆瓦时 $50$ 美元，容量为 $\\bar{g}_B = 100$ 兆瓦。节点 A 的需求为 $d_A = 120$ 兆瓦，节点 B 的需求为 $d_B = 60$ 兆瓦。电力可以通过单条输电线路在节点 A 和节点 B 之间流动，该线路的双向容量均为 $\\bar{f} = 30$ 兆瓦。\n\n将系统调度问题构建为一个线性规划模型，其目标是最小化总发电成本，并满足节点功率平衡、发电机容量限制和输电容量限制等约束条件。利用线性规划对偶和互补松弛性进行严格推导，确定节点 B 处节点平衡约束的影子价格，该价格等于最小总成本相对于 $d_B$ 无穷小增量的灵敏度（导数）。\n\n以美元/兆瓦时 ($/\\mathrm{MWh}$) 为单位报告最终值。最终答案必须是方框中的一个实数，不带单位。",
            "solution": "该问题要求解节点 B 处节点平衡约束的影子价格，这等同于在成本最小化的线性规划 (LP) 背景下，求解与此约束相关的对偶变量的值。\n\n首先，我们构建原线性规划模型。设决策变量为：\n- $g_A$：节点 A 的发电量，单位为兆瓦 (MW)。\n- $g_B$：节点 B 的发电量，单位为兆瓦 (MW)。\n- $f_{AB}$：从节点 A 到节点 B 的潮流，单位为兆瓦 (MW)。正值表示从 A 到 B 的潮流，负值表示从 B 到 A 的潮流。\n\n目标是最小化总发电成本 $Z$，它是发电水平的线性函数：\n$$\n\\text{Minimize } Z = 20 g_A + 50 g_B\n$$\n\n该最小化问题受以下几个约束条件的限制：\n\n1.  **节点功率平衡**：在每个节点，发电量加流入功率必须等于电力需求加流出功率。\n    -   节点 A：$g_A = d_A + f_{AB}$。给定 $d_A = 120$，即 $g_A - f_{AB} = 120$。\n    -   节点 B：$g_B + f_{AB} = d_B$。给定 $d_B = 60$，即 $g_B + f_{AB} = 60$。\n\n2.  **发电机容量限制**：每个发电机的出力不能超过其容量，且必须为非负值。\n    -   $0 \\le g_A \\le \\bar{g}_A$，其中 $\\bar{g}_A = 200$。因此，$0 \\le g_A \\le 200$。\n    -   $0 \\le g_B \\le \\bar{g}_B$，其中 $\\bar{g}_B = 100$。因此，$0 \\le g_B \\le 100$。\n\n3.  **输电容量限制**：A 和 B 之间线路上的潮流在任一方向上都不能超过其容量。\n    -   $-\\bar{f} \\le f_{AB} \\le \\bar{f}$，其中 $\\bar{f} = 30$。因此，$-30 \\le f_{AB} \\le 30$。\n\n为了找到这个原问题的最优解，我们观察到节点 A 的发电成本（20 美元/兆瓦时）低于节点 B（50 美元/兆瓦时）。因此，系统将尝试最大化地使用发电机 A 来满足 $d_A + d_B = 120 + 60 = 180$ 兆瓦的总需求。如果输电没有限制，最优解将是 $g_A = 180$ 兆瓦和 $g_B = 0$ 兆瓦。这将需要潮流 $f_{AB}$ 满足节点平衡：\n- 节点 A：$180 = 120 + f_{AB} \\implies f_{AB} = 60$ 兆瓦。\n- 节点 B：$0 + f_{AB} = 60 \\implies f_{AB} = 60$ 兆瓦。\n然而，这 60 兆瓦的潮流违反了 30 兆瓦的输电容量限制。输电线路发生了拥塞。因此，从 A 到 B 的潮流将处于其最大容量，即 $f_{AB} = 30$ 兆瓦。\n\n在潮流因拥塞而固定为 $f_{AB} = 30$ 兆瓦的情况下，我们可以确定最优的发电水平：\n- 根据节点 A 的平衡：$g_A = 120 + f_{AB} = 120 + 30 = 150$ 兆瓦。这是可行的，因为 $0 \\le 150 \\le 200$。\n- 根据节点 B 的平衡：$g_B = 60 - f_{AB} = 60 - 30 = 30$ 兆瓦。这是可行的，因为 $0 \\le 30 \\le 100$。\n\n因此，最优原问题解为 $g_A^* = 150$，$g_B^* = 30$，$f_{AB}^* = 30$。\n\n为了求得影子价格，我们必须使用线性规划对偶。让我们将节点平衡约束定义为一种标准形式，以便将对偶变量解释为价格。设对偶变量 $\\lambda_A$ 与节点 A 的平衡相关联，$\\lambda_B$ 与节点 B 的平衡相关联。\n$$\n120 + f_{AB} - g_A = 0 \\quad (\\lambda_A)\n$$\n$$\n60 - f_{AB} - g_B = 0 \\quad (\\lambda_B)\n$$\n通过这种构建方式，对偶变量 $\\lambda_B$ 代表了最优成本对节点 B 需求变化的灵敏度，即 $\\frac{\\partial Z^*}{\\partial d_B}$，这正是问题所要求的。\n\n其他约束是不等式：\n$$\ng_A - 200 \\le 0 \\quad (\\mu_{A,up} \\ge 0)\n$$\n$$\n-g_A \\le 0 \\quad (\\mu_{A,low} \\ge 0)\n$$\n$$\ng_B - 100 \\le 0 \\quad (\\mu_{B,up} \\ge 0)\n$$\n$$\n-g_B \\le 0 \\quad (\\mu_{B,low} \\ge 0)\n$$\n$$\nf_{AB} - 30 \\le 0 \\quad (\\gamma_{up} \\ge 0)\n$$\n$$\n-f_{AB} - 30 \\le 0 \\quad (\\gamma_{low} \\ge 0)\n$$\n该问题的拉格朗日函数是：\n$L = (20g_A + 50g_B) + \\lambda_A(120 + f_{AB} - g_A) + \\lambda_B(60 - f_{AB} - g_B) + \\mu_{A,up}(g_A - 200) + \\mu_{A,low}(-g_A) + \\mu_{B,up}(g_B - 100) + \\mu_{B,low}(-g_B) + \\gamma_{up}(f_{AB} - 30) + \\gamma_{low}(-f_{AB} - 30)$。\n\n最优性的卡罗需-库恩-塔克 (KKT) 条件要求拉格朗日函数对原变量的偏导数为零：\n$$\n\\frac{\\partial L}{\\partial g_A} = 20 - \\lambda_A + \\mu_{A,up} - \\mu_{A,low} = 0\n$$\n$$\n\\frac{\\partial L}{\\partial g_B} = 50 - \\lambda_B + \\mu_{B,up} - \\mu_{B,low} = 0\n$$\n$$\n\\frac{\\partial L}{\\partial f_{AB}} = \\lambda_A - \\lambda_B + \\gamma_{up} - \\gamma_{low} = 0\n$$\n互补松弛条件指出，如果一个不等式约束不是紧的（即松弛量非零），其对应的对偶变量必须为零。我们在最优原问题解 $(g_A^* = 150, g_B^* = 30, f_{AB}^* = 30)$ 处评估这一点：\n- $0  g_A^*  200 \\implies$ $g_A$ 的两个容量约束都不是紧的。因此，$\\mu_{A,up} = 0$ 且 $\\mu_{A,low} = 0$。\n- $0  g_B^*  100 \\implies$ $g_B$ 的两个容量约束都不是紧的。因此，$\\mu_{B,up} = 0$ 且 $\\mu_{B,low} = 0$。\n- $f_{AB}^* = 30 \\implies$ 输电上限 $f_{AB} \\le 30$ 是紧的。因此，$\\gamma_{up} \\ge 0$。\n- $f_{AB}^* = 30 > -30 \\implies$ 输电下限 $f_{AB} \\ge -30$（或 $-f_{AB} \\le 30$）不是紧的。因此，$\\gamma_{low} = 0$。\n\n将这些值代入 KKT 条件：\n1.  从 $\\frac{\\partial L}{\\partial g_A}$ 方程：$20 - \\lambda_A + 0 - 0 = 0 \\implies \\lambda_A = 20$。\n2.  从 $\\frac{\\partial L}{\\partial g_B}$ 方程：$50 - \\lambda_B + 0 - 0 = 0 \\implies \\lambda_B = 50$。\n\n与节点 B 处节点平衡约束相关的对偶变量的值是 $\\lambda_B = 50$。该值代表了在节点 B 供应额外一兆瓦时电力的边际成本。由于从更便宜的电源（A）来的输电线路发生拥塞，节点 B 的任何额外需求都必须由本地更昂贵的发电机（B）来满足，其边际成本为 50 美元/兆瓦时。\n\n作为一致性检查，我们可以使用第三个 KKT 条件：$\\lambda_A - \\lambda_B + \\gamma_{up} - \\gamma_{low} = 0 \\implies 20 - 50 + \\gamma_{up} - 0 = 0 \\implies \\gamma_{up} = 30$。值 $\\gamma_{up} = 30$ 是非负的，与 KKT 条件一致。这个对偶变量代表输电线路上的拥塞租金，它等于两个节点之间位置边际电价的差值。\n\n节点 B 处节点平衡约束的影子价格是 $\\lambda_B$。",
            "answer": "$$\\boxed{50}$$"
        },
        {
            "introduction": "最后一项练习通过探索Dantzig-Wolfe分解法，进入了大规模优化的领域。你将专注于列生成子问题，这对于求解复杂的机组组合问题至关重要 。通过为一个发电机组推导并求解其定价问题，你将学习该机组如何根据全系统电价制定最优生产计划，从而深入了解算法效率和市场参与者行为。",
            "id": "4071641",
            "problem": "考虑一个基于Dantzig–Wolfe分解的能源系统调度方案，其中受限主问题 (RMP) 在列之间进行选择，每一列代表单个火力发电机组在有限时间范围内的可行小时调度计划。RMP的目标是通过列的凸组合，在精确满足需求的同时，最小化总系统成本。该分解建立在线性规划对偶性和可行集凸化等经过充分检验的基础上。设时间范围为 $T = 4$ 小时，索引为 $t \\in \\{1,2,3,4\\}$。在RMP中，耦合约束强制执行小时供需平衡，并具有相关的对偶乘子。\n\n您的任务是推导单个火力发电机组的定价问题（列生成子问题）。该机组的可行集由二元启停决策和受逻辑及爬坡约束的连续功率输出定义。对于混合整数线性规划（MILP）机组模型，请使用以下经过充分检验的建模假设：\n- 机组在每个小时 $t$ 具有启停状态 $u_t \\in \\{0,1\\}$ 和启动指示变量 $y_t \\in \\{0,1\\}$。\n- 机组在每个小时 $t$ 的功率输出为 $p_t \\ge 0$。\n- 逻辑和容量约束成立：$p_t \\le P^{\\max} u_t$，$p_t \\ge P^{\\min} u_t$，以及 $y_t \\ge u_t - u_{t-1}$，给定 $u_0 = 0$ 和 $p_0 = 0$。\n- 对称小时爬坡限制成立：对于所有 $t \\in \\{1,2,3,4\\}$，$p_t - p_{t-1} \\le R$ 和 $p_{t-1} - p_t \\le R$。\n\nRMP是一个带有等式耦合约束的最小化问题，其小时 $t=1,2,3,4$ 的对偶乘子由 $\\pi_1, \\pi_2, \\pi_3, \\pi_4$ 给出，单位均为 $\\text{USD}/\\text{MWh}$。设列中机组的成本为每次启动的成本和可变能源成本之和：每次启动的启动成本为 $c_s$（单位为 $\\text{USD}$），应用于 $p_t$ 的可变成本为 $c_v$（单位为 $\\text{USD}/\\text{MWh}$）。\n\n从线性规划中折算成本的基本定义和标准的Dantzig–Wolfe分解设置出发，推导该单个机组的定价问题，该问题计算要添加到RMP中的最小折算成本列。然后，使用以下数值数据：\n- $P^{\\min} = 50$ $\\text{MW}$，$P^{\\max} = 200$ $\\text{MW}$，\n- $R = 80$ $\\text{MW}/\\text{h}$，\n- $c_s = 500$ $\\text{USD}$，$c_v = 30$ $\\text{USD}/\\text{MWh}$，\n- $\\pi_1 = 45$ $\\text{USD}/\\text{MWh}$，$\\pi_2 = 60$ $\\text{USD}/\\text{MWh}$，$\\pi_3 = 40$ $\\text{USD}/\\text{MWh}$，$\\pi_4 = 50$ $\\text{USD}/\\text{MWh}$，\n\n计算该机组定价问题的最优值（即最小折算成本）。请以美元（USD）表示您的最终答案。无需四舍五入；报告精确值。",
            "solution": "我们从受限主问题（RMP）的Dantzig–Wolfe分解的基本设置开始。令每列 $j$ 代表机组在时间范围 $t \\in \\{1,2,3,4\\}$ 内的一个可行调度，其关联成本为 $c_j$，小时能源贡献向量为 $(a_{1j}, a_{2j}, a_{3j}, a_{4j})$。RMP是一个线性规划问题，其目标是最小化 $\\sum_{j} c_j x_j$，并服从耦合约束\n$$\n\\sum_{j} a_{tj} x_j = D_t \\quad \\text{for all } t \\in \\{1,2,3,4\\},\n$$\n以及 $x_j \\ge 0$，其中 $D_t$ 是小时需求，$x_j$ 是列权重。根据线性规划对偶性，等式约束产生对偶变量 $\\pi_t$（符号自由），每个小时 $t$ 对应一个。\n\n列 $j$ 的折算成本由经过充分检验的规则定义\n$$\nr_j = c_j - \\sum_{t=1}^{4} \\pi_t a_{tj}.\n$$\n在用于最小化RMP的列生成中，我们寻找具有负折算成本的列以改进目标函数。对于特定机组，定价问题在机组的可行集 $\\mathcal{S}$ 上最小化折算成本：\n$$\n\\min_{s \\in \\mathcal{S}} \\left( c(s) - \\sum_{t=1}^{4} \\pi_t a_t(s) \\right),\n$$\n其中 $s$ 编码了机组的启停和输出轨迹，$c(s)$ 是机组在时间范围内的成本，$a_t(s)$ 是调度 $s$ 在小时 $t$ 供应的能源。\n\n我们现在使用MILP机组模型来实例化 $c(s)$ 和 $a_t(s)$。令 $u_t \\in \\{0,1\\}$ 表示启停状态，$y_t \\in \\{0,1\\}$ 表示启动指示变量，$p_t \\ge 0$ 表示功率输出。可行集 $\\mathcal{S}$ 的特征如下：\n- 容量约束：对于所有 $t$，$p_t \\le P^{\\max} u_t$ 和 $p_t \\ge P^{\\min} u_t$。\n- 启动逻辑：$y_t \\ge u_t - u_{t-1}$，其中 $u_0 = 0$ 和 $p_0 = 0$。\n- 爬坡约束：对于所有 $t$，$p_t - p_{t-1} \\le R$ 和 $p_{t-1} - p_t \\le R$。\n\n成本函数为\n$$\nc(s) = c_s \\sum_{t=1}^{4} y_t + c_v \\sum_{t=1}^{4} p_t,\n$$\n能源贡献则简单地为 $a_t(s) = p_t$。\n\n因此，定价问题是一个混合整数线性规划（MILP）问题：\n$$\n\\min_{u_t, y_t, p_t} \\left[ c_s \\sum_{t=1}^{4} y_t + \\sum_{t=1}^{4} \\left( c_v - \\pi_t \\right) p_t \\right]\n$$\n服从于\n\\begin{align*}\n p_t \\le P^{\\max} u_t \\quad \\text{for } t=1,2,3,4, \\\\\n p_t \\ge P^{\\min} u_t \\quad \\text{for } t=1,2,3,4, \\\\\n y_t \\ge u_t - u_{t-1} \\quad \\text{for } t=1,2,3,4, \\\\\n p_t - p_{t-1} \\le R \\quad \\text{for } t=1,2,3,4, \\\\\n p_{t-1} - p_t \\le R \\quad \\text{for } t=1,2,3,4, \\\\\n u_t \\in \\{0,1\\}, \\; y_t \\in \\{0,1\\}, \\; p_t \\ge 0, \\\\\n u_0 = 0, \\; p_0 = 0.\n\\end{align*}\n\n使用给定的数值参数：\n- $P^{\\min} = 50$, $P^{\\max} = 200$, $R = 80$,\n- $c_s = 500$, $c_v = 30$,\n- $\\pi_1 = 45$, $\\pi_2 = 60$, $\\pi_3 = 40$, $\\pi_4 = 50$,\n\n$p_t$ 的目标函数系数变为\n\\begin{align*}\n c_v - \\pi_1 = 30 - 45 = -15, \\\\\n c_v - \\pi_2 = 30 - 60 = -30, \\\\\n c_v - \\pi_3 = 30 - 40 = -10, \\\\\n c_v - \\pi_4 = 30 - 50 = -20.\n\\end{align*}\n因此，定价目标函数为\n$$\n\\min \\left[ 500 \\sum_{t=1}^{4} y_t + (-15) p_1 + (-30) p_2 + (-10) p_3 + (-20) p_4 \\right].\n$$\n\n因为所有的 $c_v - \\pi_t$ 都是负数，增加 $p_t$ 会降低目标函数值（这在最小化问题中是有利的），但这受到容量和爬坡约束的限制，并且在从关机转换到开机时会产生启动成本。最优策略是只进行一次启动，并在 $P^{\\max}$ 和 $R$ 的约束下尽可能多地发电，同时尽早开始以利用所有负系数。\n\n从 $u_0 = 0$ 和 $p_0 = 0$ 开始，如果我们在 $t=1$ 时启动（$u_1=1, y_1=1$），爬坡和容量约束得出：\n- 在 $t=1$ 时：$p_1 \\in [50, \\min(200, 0 + 80)] = [50, 80]$，因此选择 $p_1 = 80$。\n- 在 $t=2$ 时：$p_2 \\in [50, \\min(200, 80 + 80)] = [50, 160]$，因此选择 $p_2 = 160$。\n- 在 $t=3$ 时：$p_3 \\in [50, \\min(200, 160 + 80)] = [50, 200]$，因此选择 $p_3 = 200$。\n- 在 $t=4$ 时：$p_4 \\in [50, \\min(200, 200 + 80)] = [50, 200]$，因此选择 $p_4 = 200$。\n\n在整个时间段内保持机组运行可以避免额外的启动，因此 $\\sum_{t=1}^{4} y_t = 1$。在此调度下的目标函数值为\n\\begin{align*}\n 500 \\cdot 1 + (-15) \\cdot 80 + (-30) \\cdot 160 + (-10) \\cdot 200 + (-20) \\cdot 200 \\\\\n= 500 - 1200 - 4800 - 2000 - 4000 \\\\\n= 500 - 12000 \\\\\n= -11500.\n\\end{align*}\n\n我们简要检查其他方案以确保最优性：\n- 保持关机状态得到的目标值为 $0$，高于 $-11500$（对于最小化问题而言更差）。\n- 稍后启动（例如，在 $t=2$ 时）会减少可利用的负系数，并受到爬坡约束，从而得到一个不太理想的目标值。\n- 多次启动会增加 $\\sum y_t$ 并产生额外的启动成本；考虑到负的 $c_v - \\pi_t$ 系数，单个连续运行周期并达到最大可行输出的方案更优。\n\n因此，定价问题的最优折算成本为 $-11500$ $\\text{USD}$。",
            "answer": "$$\\boxed{-11500}$$"
        }
    ]
}