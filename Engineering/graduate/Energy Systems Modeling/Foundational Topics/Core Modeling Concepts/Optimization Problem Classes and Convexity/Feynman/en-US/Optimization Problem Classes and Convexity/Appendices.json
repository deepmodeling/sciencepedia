{
    "hands_on_practices": [
        {
            "introduction": "This practice grounds the theory of convex optimization in the essential energy systems task of economic dispatch . By analytically solving a Quadratic Program (QP) using Karush-Kuhn-Tucker (KKT) conditions, you will solidify your understanding of how the mathematical properties of convexity guarantee a unique, efficient solution. This exercise builds a foundational skill for analyzing and solving cost-minimization problems in power systems.",
            "id": "4110217",
            "problem": "An electric power system operator must dispatch two thermal generators to meet a fixed demand using an economically efficient allocation. Each generator $i \\in \\{1,2\\}$ has a convex quadratic fuel cost function consistent with standard heat rate modeling in energy systems. Consider the following economic dispatch problem written in the canonical Quadratic Program (QP) form:\n$$\\min_{\\mathbf{p} \\in \\mathbb{R}^{2}} \\;\\; \\frac{1}{2}\\,\\mathbf{p}^{\\top}\\mathbf{H}\\,\\mathbf{p} + \\mathbf{f}^{\\top}\\mathbf{p} + c_{0} \\quad \\text{subject to} \\quad \\mathbf{A}\\,\\mathbf{p} = d, \\quad \\mathbf{0} \\le \\mathbf{p} \\le \\mathbf{p}^{\\max},$$\nwhere $\\mathbf{p} = \\begin{pmatrix} p_{1} \\\\ p_{2} \\end{pmatrix}$ is the generator output vector in megawatts (MW), $\\mathbf{H} = \\begin{pmatrix} 2  0 \\\\ 0  4 \\end{pmatrix}$ is a symmetric positive definite matrix encoding quadratic marginal costs, $\\mathbf{f} = \\begin{pmatrix} 10 \\\\ 6 \\end{pmatrix}$ encodes linear cost terms, $c_{0} \\in \\mathbb{R}$ is a constant term, $\\mathbf{A} = \\begin{pmatrix} 1  1 \\end{pmatrix}$ enforces power balance, $d = 50$ is the total demand in MW, and $\\mathbf{p}^{\\max} = \\begin{pmatrix} 100 \\\\ 100 \\end{pmatrix}$ are nameplate upper bounds. Lower bounds at zero reflect non-negativity of generation. All quantities are deterministic and reflect a single-period static dispatch without losses or ramping.\n\nStarting from core definitions of convexity of quadratic forms and optimality conditions in constrained optimization, analytically derive the optimal dispatch $\\mathbf{p}^{\\star}$ by constructing and solving the first-order optimality conditions of the Karush-Kuhn-Tucker (KKT) system using linear algebra. Your derivation must explicitly justify convexity and the sufficiency of the KKT conditions for optimality in this problem class. Verify whether any bound constraints are active at the solution.\n\nExpress the final optimal generator outputs $p_{1}^{\\star}$ and $p_{2}^{\\star}$ in megawatts (MW). Provide exact values and do not round. The final answer must be a single row vector containing $(p_{1}^{\\star}, p_{2}^{\\star})$ only.",
            "solution": "The problem provided is an economic dispatch problem for a two-generator system, formulated as a Quadratic Program (QP). Before proceeding to a solution, the problem statement is validated.\n\n### Step 1: Extract Givens\n- Optimization variable: $\\mathbf{p} = \\begin{pmatrix} p_{1} \\\\ p_{2} \\end{pmatrix} \\in \\mathbb{R}^{2}$\n- Objective function: $\\min_{\\mathbf{p}} \\;\\; \\frac{1}{2}\\,\\mathbf{p}^{\\top}\\mathbf{H}\\,\\mathbf{p} + \\mathbf{f}^{\\top}\\mathbf{p} + c_{0}$\n- Quadratic cost matrix: $\\mathbf{H} = \\begin{pmatrix} 2  0 \\\\ 0  4 \\end{pmatrix}$\n- Linear cost vector: $\\mathbf{f} = \\begin{pmatrix} 10 \\\\ 6 \\end{pmatrix}$\n- Constant cost term: $c_{0} \\in \\mathbb{R}$\n- Equality constraint matrix: $\\mathbf{A} = \\begin{pmatrix} 1  1 \\end{pmatrix}$\n- Equality constraint right-hand side (demand): $d = 50$\n- Lower bound constraints: $\\mathbf{p} \\ge \\mathbf{0}$, where $\\mathbf{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$\n- Upper bound constraints: $\\mathbf{p} \\le \\mathbf{p}^{\\max}$, where $\\mathbf{p}^{\\max} = \\begin{pmatrix} 100 \\\\ 100 \\end{pmatrix}$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem uses a standard convex quadratic cost function model for thermal generators and enforces a power balance equation and capacity limits. This is a fundamental and well-established formulation in power system economics. The setup is scientifically sound.\n- **Well-Posed**: The problem is a QP. The Hessian of the objective function is the given matrix $\\mathbf{H}$. The eigenvalues of the diagonal matrix $\\mathbf{H}$ are its diagonal entries, $\\lambda_1 = 2$ and $\\lambda_2 = 4$. Since both eigenvalues are strictly positive, $\\mathbf{H}$ is positive definite, and the objective function is strictly convex. The constraints are all linear, defining a convex and compact feasible set (a line segment). The minimization of a strictly convex function over a non-empty, closed, convex set has a unique solution. The problem is therefore well-posed.\n- **Objective**: The problem is stated using precise mathematical notation and unambiguous language. It is objective.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be derived by constructing and solving the Karush-Kuhn-Tucker (KKT) conditions.\n\n### Derivation of the Optimal Dispatch\n\nThe optimization problem is:\n$$ \\min_{p_1, p_2} \\;\\; f(\\mathbf{p}) = \\frac{1}{2}\\begin{pmatrix} p_1  p_2 \\end{pmatrix} \\begin{pmatrix} 2  0 \\\\ 0  4 \\end{pmatrix} \\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix} + \\begin{pmatrix} 10  6 \\end{pmatrix} \\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix} + c_0 $$\n$$ \\text{subject to:} $$\n$$ p_1 + p_2 = 50 $$\n$$ 0 \\le p_1 \\le 100 $$\n$$ 0 \\le p_2 \\le 100 $$\n\nThis expands to minimizing $f(p_1, p_2) = p_1^2 + 2p_2^2 + 10p_1 + 6p_2 + c_0$. As established, the objective function is strictly convex and the feasible region is convex. Therefore, the KKT conditions are both necessary and sufficient for global optimality.\n\nThe Lagrangian function $\\mathcal{L}$ for this problem is formulated by associating Lagrange multipliers with each constraint. Let $\\lambda$ be the multiplier for the equality constraint, $\\mu_{1,L}$ and $\\mu_{2,L}$ for the lower bound constraints ($p_1 \\ge 0, p_2 \\ge 0$), and $\\mu_{1,U}$ and $\\mu_{2,U}$ for the upper bound constraints ($p_1 \\le 100, p_2 \\le 100$). The constraints are written in the form $g(\\mathbf{p}) \\le 0$.\n\n$\\mathcal{L}(p_1, p_2, \\lambda, \\boldsymbol{\\mu}) = p_1^2 + 2p_2^2 + 10p_1 + 6p_2 + c_0 + \\lambda(p_1+p_2-50) - \\mu_{1,L}p_1 - \\mu_{2,L}p_2 + \\mu_{1,U}(p_1-100) + \\mu_{2,U}(p_2-100)$\n\nThe KKT conditions are:\n1.  **Stationarity**: The gradient of the Lagrangian with respect to the primal variables $(p_1, p_2)$ must be zero.\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial p_1} = 2p_1 + 10 + \\lambda - \\mu_{1,L} + \\mu_{1,U} = 0 $$\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial p_2} = 4p_2 + 6 + \\lambda - \\mu_{2,L} + \\mu_{2,U} = 0 $$\n2.  **Primal Feasibility**: The solution must satisfy all constraints.\n    $$ p_1 + p_2 = 50 $$\n    $$ 0 \\le p_1 \\le 100 $$\n    $$ 0 \\le p_2 \\le 100 $$\n3.  **Dual Feasibility**: The Lagrange multipliers for inequality constraints must be non-negative.\n    $$ \\mu_{1,L}, \\mu_{2,L}, \\mu_{1,U}, \\mu_{2,U} \\ge 0 $$\n4.  **Complementary Slackness**: The product of an inequality multiplier and its corresponding slack must be zero.\n    $$ \\mu_{1,L} p_1 = 0, \\quad \\mu_{2,L} p_2 = 0 $$\n    $$ \\mu_{1,U} (p_1 - 100) = 0, \\quad \\mu_{2,U} (p_2 - 100) = 0 $$\n\nTo solve this system, we begin with the simplifying assumption that no bound constraints are active, meaning $0  p_1  100$ and $0  p_2  100$. This is a reasonable starting hypothesis for a moderate demand level relative to generator capacities.\n\nIf no bounds are active, complementary slackness implies that their corresponding multipliers are zero: $\\mu_{1,L}=\\mu_{1,U}=0$ and $\\mu_{2,L}=\\mu_{2,U}=0$. The stationarity conditions simplify to:\n$$ 2p_1 + 10 + \\lambda = 0 \\quad \\implies \\quad 2p_1 + 10 = -\\lambda $$\n$$ 4p_2 + 6 + \\lambda = 0 \\quad \\implies \\quad 4p_2 + 6 = -\\lambda $$\nThe term $-\\lambda$ is the system's marginal price of energy. For optimal dispatch, the incremental costs of both generators must be equal to this price. Equating the two expressions gives:\n$$ 2p_1 + 10 = 4p_2 + 6 $$\n$$ 2p_1 - 4p_2 = -4 $$\n$$ p_1 - 2p_2 = -2 $$\nWe now have a system of two linear equations with two variables, this equation and the power balance equation:\n1. $p_1 - 2p_2 = -2$\n2. $p_1 + p_2 = 50$\n\nSubtracting equation (1) from equation (2) yields:\n$$ (p_1 + p_2) - (p_1 - 2p_2) = 50 - (-2) $$\n$$ 3p_2 = 52 $$\n$$ p_2^{\\star} = \\frac{52}{3} $$\nSubstitute this value back into the power balance equation to find $p_1$:\n$$ p_1^{\\star} = 50 - p_2^{\\star} = 50 - \\frac{52}{3} = \\frac{150 - 52}{3} = \\frac{98}{3} $$\nThe proposed optimal dispatch is $\\mathbf{p}^{\\star} = \\begin{pmatrix} 98/3 \\\\ 52/3 \\end{pmatrix}$.\n\nFinally, we must verify if this solution is consistent with our initial assumption that no bounds are active.\nFor generator 1: $p_1^{\\star} = \\frac{98}{3} \\approx 32.67$. This value satisfies $0  32.67  100$.\nFor generator 2: $p_2^{\\star} = \\frac{52}{3} \\approx 17.33$. This value satisfies $0  17.33  100$.\n\nBoth primal feasibility conditions for the bounds are strictly satisfied. This confirms that our initial assumption was correct, and the multipliers $\\mu_{1,L}, \\mu_{1,U}, \\mu_{2,L}, \\mu_{2,U}$ are indeed all zero. All KKT conditions are met. Since the KKT conditions are sufficient for this strictly convex problem, the unique global minimum is $\\mathbf{p}^{\\star} = \\begin{pmatrix} 98/3 \\\\ 52/3 \\end{pmatrix}$. No bound constraints are active at the solution.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{98}{3}  \\frac{52}{3} \\end{pmatrix}}$$"
        },
        {
            "introduction": "We now move from quadratic to linear objectives with the Direct Current Optimal Power Flow (DC-OPF), a cornerstone of electricity market modeling . This exercise demonstrates how to formulate and solve a Linear Program (LP), revealing a key insight: optimal solutions for LPs are found at the \"corners\" or extreme points of the feasible region. Analytically solving this small network problem provides a tangible understanding of the geometry of linear optimization and the impact of network constraints.",
            "id": "4110262",
            "problem": "Consider the Direct Current Optimal Power Flow (DC-OPF) model, where the linearized power flow approximation is used: the real power flow on a transmission line between buses $i$ and $j$ is $f_{ij} = b_{ij}(\\theta_i - \\theta_j)$, with bus voltage angles $\\theta_i$ expressed in radians and $b_{ij}$ the line susceptance (in megawatts per radian). In the DC-OPF, power balance at each bus, line flow-angle relationships, generator bounds, and line thermal limits define a polyhedral feasible region. The objective is a linear generation cost function.\n\nA three-bus system is specified as follows. All quantities are in megawatts (MW) and dollars per megawatt-hour ($\\$/\\text{MWh}$), and angles are in radians. Susceptances are normalized to $b_{12} = b_{13} = b_{23} = 1$ for simplicity. Bus $3$ is the slack, so $\\theta_3 = 0$.\n\n- Network topology: lines $(1,2)$, $(1,3)$, and $(2,3)$.\n- Line thermal limits: $|f_{12}| \\le 40$ MW, $|f_{13}| \\le 90$ MW, $|f_{23}| \\le 60$ MW.\n- Demand: $D_1 = 0$ MW, $D_2 = 0$ MW, $D_3 = 150$ MW.\n- Generators: at bus $1$ and bus $2$, with outputs $g_1$ and $g_2$, bounds $0 \\le g_1 \\le 200$ MW, $0 \\le g_2 \\le 200$ MW, and linear costs $c_1 = 10$ $\\$/\\text{MWh}$ and $c_2 = 25$ $\\$/\\text{MWh}$, respectively.\n\nFormulate the DC-OPF as a linear program in variables $g_1$, $g_2$, $\\theta_1$, $\\theta_2$, $\\theta_3$, $f_{12}$, $f_{13}$, $f_{23}$, using:\n- Power balance at each bus,\n- Flow-angle relationships $f_{ij} = \\theta_i - \\theta_j$ (since $b_{ij} = 1$),\n- Line limits,\n- Slack angle condition $\\theta_3 = 0$,\n- Generator bounds.\n\nSolve the problem analytically from first principles to illustrate that the optimal solution occurs at an extreme point of the feasible polyhedron by explicitly identifying the active constraints at optimality. Compute the optimal total generation cost $C^\\star$ in dollars per hour. Express the final cost in dollars per hour. No rounding is required; provide the exact value.",
            "solution": "The user has provided a Direct Current Optimal Power Flow (DC-OPF) problem to be solved analytically.\n\n### Step 1: Problem Validation\n\nFirst, I will extract the givens and validate the problem statement.\n\n**Givens:**\n- **Model:** Direct Current Optimal Power Flow (DC-OPF).\n- **Power Flow Law:** $f_{ij} = b_{ij}(\\theta_i - \\theta_j)$, where $f_{ij}$ is real power flow, $\\theta_i$ is bus voltage angle, and $b_{ij}$ is line susceptance.\n- **Topology:** A three-bus system with lines connecting $(1,2)$, $(1,3)$, and $(2,3)$.\n- **Susceptances:** $b_{12} = 1$, $b_{13} = 1$, $b_{23} = 1$. The units are implicitly MW/radian.\n- **Slack Bus:** Bus $3$ is the reference, so $\\theta_3 = 0$ radians.\n- **Line Thermal Limits:** $|f_{12}| \\le 40$ MW, $|f_{13}| \\le 90$ MW, $|f_{23}| \\le 60$ MW.\n- **Demands:** $D_1 = 0$ MW, $D_2 = 0$ MW, $D_3 = 150$ MW.\n- **Generators:**\n    - Bus $1$: Generation $g_1$, limits $0 \\le g_1 \\le 200$ MW, cost $c_1 = 10$ $\\$/\\text{MWh}$.\n    - Bus $2$: Generation $g_2$, limits $0 \\le g_2 \\le 200$ MW, cost $c_2 = 25$ $\\$/\\text{MWh}$.\n- **Variables for Formulation:** $g_1, g_2, \\theta_1, \\theta_2, \\theta_3, f_{12}, f_{13}, f_{23}$.\n\n**Validation:**\n1.  **Scientific Grounding:** The problem is based on the DC-OPF model, which is a fundamental and widely used tool in power system analysis and electricity market modeling. It represents a standard linearization of the full AC power flow equations. All terms and parameters are standard in electrical engineering. The problem is scientifically sound.\n2.  **Well-Posedness:** The problem describes a linear program (LP), characterized by a linear objective function and a set of linear constraints. The feasible region of an LP is a convex polyhedron. As long as the feasible region is non-empty, a solution exists. The analysis will show this to be the case. The problem is well-posed.\n3.  **Objectivity:** The problem is stated using precise, unambiguous mathematical and technical language, with no subjective elements.\n4.  **Completeness and Consistency:** All necessary data (costs, limits, demands, network parameters) are provided. There are no contradictions in the setup. The problem is self-contained.\n\n**Verdict:** The problem is valid. I will now proceed with the solution.\n\n### Step 2: Formulation and Solution\n\nThe goal is to minimize the total generation cost, $C$, subject to a set of linear constraints representing the physical and operational limits of the power system.\n\n**Objective Function:**\nThe total cost is the sum of the costs of generation at each bus.\n$$\n\\min C = c_1 g_1 + c_2 g_2 = 10 g_1 + 25 g_2\n$$\n\n**Constraints:**\n1.  **Power Balance Equations:** At each bus, generation minus demand must equal the net power flowing out of the bus.\n    -   Bus $1$: $g_1 - D_1 = f_{12} + f_{13} \\implies g_1 = f_{12} + f_{13}$\n    -   Bus $2$: $g_2 - D_2 = f_{21} + f_{23} \\implies g_2 = -f_{12} + f_{23}$ (using $f_{21} = -f_{12}$)\n    -   Bus $3$: $0 - D_3 = f_{31} + f_{32} \\implies -150 = -f_{13} - f_{23} \\implies f_{13} + f_{23} = 150$\n\n    Notably, summing the power balance equations for Bus $1$ and Bus $2$ yields $g_1 + g_2 = f_{13} + f_{23}$. Combined with the Bus $3$ equation, we get the system-wide power balance: $g_1 + g_2 = 150$. Total generation equals total demand.\n\n2.  **Flow-Angle Relationships:** With all susceptances $b_{ij}=1$ and $\\theta_3 = 0$:\n    -   $f_{12} = \\theta_1 - \\theta_2$\n    -   $f_{13} = \\theta_1 - \\theta_3 = \\theta_1$\n    -   $f_{23} = \\theta_2 - \\theta_3 = \\theta_2$\n\n3.  **Generator Output Limits:**\n    -   $0 \\le g_1 \\le 200$\n    -   $0 \\le g_2 \\le 200$\n\n4.  **Line Thermal Limits:**\n    -   $|f_{12}| \\le 40 \\implies -40 \\le f_{12} \\le 40$\n    -   $|f_{13}| \\le 90 \\implies -90 \\le f_{13} \\le 90$\n    -   $|f_{23}| \\le 60 \\implies -60 \\le f_{23} \\le 60$\n\n**Simplification of the Problem:**\nWe can reduce the problem to a single variable. Let's choose $\\theta_1$.\nFrom the flow-angle relationships, we have $f_{13} = \\theta_1$ and $f_{23} = \\theta_2$.\nSubstituting these into the power balance at Bus $3$:\n$f_{13} + f_{23} = 150 \\implies \\theta_1 + \\theta_2 = 150$.\nThis allows us to express $\\theta_2$ in terms of $\\theta_1$: $\\theta_2 = 150 - \\theta_1$.\n\nNow, we express all power flows and generation outputs in terms of $\\theta_1$:\n-   $f_{13} = \\theta_1$\n-   $f_{23} = \\theta_2 = 150 - \\theta_1$\n-   $f_{12} = \\theta_1 - \\theta_2 = \\theta_1 - (150 - \\theta_1) = 2\\theta_1 - 150$\n\n-   $g_1 = f_{12} + f_{13} = (2\\theta_1 - 150) + \\theta_1 = 3\\theta_1 - 150$\n-   $g_2 = -f_{12} + f_{23} = -(2\\theta_1 - 150) + (150 - \\theta_1) = -3\\theta_1 + 300$\n\nThe objective function becomes a function of $\\theta_1$:\n$C(\\theta_1) = 10 (3\\theta_1 - 150) + 25 (-3\\theta_1 + 300) = 30\\theta_1 - 1500 - 75\\theta_1 + 7500 = 6000 - 45\\theta_1$.\nTo minimize $C(\\theta_1)$, we must maximize $\\theta_1$.\n\n**Feasible Region for $\\theta_1$:**\nWe translate all constraints into constraints on $\\theta_1$.\n1.  **Generator $g_1$ limits:** $0 \\le 3\\theta_1 - 150 \\le 200$\n    -   $150 \\le 3\\theta_1 \\implies \\theta_1 \\ge 50$\n    -   $3\\theta_1 \\le 350 \\implies \\theta_1 \\le \\frac{350}{3} \\approx 116.67$\n    So, $\\theta_1 \\in [50, \\frac{350}{3}]$.\n\n2.  **Generator $g_2$ limits:** $0 \\le -3\\theta_1 + 300 \\le 200$\n    -   $3\\theta_1 \\le 300 \\implies \\theta_1 \\le 100$\n    -   $100 \\le 3\\theta_1 \\implies \\theta_1 \\ge \\frac{100}{3} \\approx 33.33$\n    So, $\\theta_1 \\in [\\frac{100}{3}, 100]$.\n\n3.  **Line flow $f_{12}$ limit:** $|2\\theta_1 - 150| \\le 40$\n    -   $-40 \\le 2\\theta_1 - 150 \\le 40$\n    -   $110 \\le 2\\theta_1 \\implies \\theta_1 \\ge 55$\n    -   $2\\theta_1 \\le 190 \\implies \\theta_1 \\le 95$\n    So, $\\theta_1 \\in [55, 95]$.\n\n4.  **Line flow $f_{13}$ limit:** $|\\theta_1| \\le 90$\n    -   So, $\\theta_1 \\in [-90, 90]$.\n\n5.  **Line flow $f_{23}$ limit:** $|150 - \\theta_1| \\le 60$\n    -   $-60 \\le 150 - \\theta_1 \\le 60$\n    -   $150 - \\theta_1 \\le 60 \\implies \\theta_1 \\ge 90$\n    -   $150 - \\theta_1 \\ge -60 \\implies \\theta_1 \\le 210$\n    So, $\\theta_1 \\in [90, 210]$.\n\nTo find the feasible region for $\\theta_1$, we must find the intersection of all these intervals:\n$$\n\\theta_1 \\in \\left[50, \\frac{350}{3}\\right] \\cap \\left[\\frac{100}{3}, 100\\right] \\cap [55, 95] \\cap [-90, 90] \\cap [90, 210]\n$$\nThe lower bound is the maximum of the individual lower bounds:\n$$\n\\max\\left(50, \\frac{100}{3}, 55, -90, 90\\right) = 90\n$$\nThe upper bound is the minimum of the individual upper bounds:\n$$\n\\min\\left(\\frac{350}{3}, 100, 95, 90, 210\\right) = 90\n$$\nThe feasible region for $\\theta_1$ is the single point $\\theta_1 = 90$.\n\n**Optimal Solution:**\nSince we need to maximize $\\theta_1$ over its feasible region, and the feasible region is just the point $\\{90\\}$, the optimal value is $\\theta_1^\\star = 90$.\n\nThis solution lies at an extreme point of the feasible polyhedron. The constraints that define this point are the ones that determined the lower and upper bounds of the feasible interval for $\\theta_1$.\n- The lower bound $\\theta_1 \\ge 90$ came from the limit on $f_{23}$, specifically $f_{23} \\le 60$ (since $f_{23} = 150 - \\theta_1$).\n- The upper bound $\\theta_1 \\le 90$ came from the limit on $f_{13}$, specifically $f_{13} \\le 90$.\n\nThus, the optimal solution is defined by the intersection of the equality constraint plane $\\theta_1+\\theta_2=150$ and the two active inequality constraints $f_{13} \\le 90$ and $f_{23} \\le 60$. In the full-dimensional space of the problem, this constitutes an extreme point (a vertex) of the feasible polyhedron. The active constraints at optimality are:\n- $f_{13} = 90$ MW (upper thermal limit on line 1-3)\n- $f_{23} = 60$ MW (upper thermal limit on line 2-3)\n\nNow we compute the optimal values for all variables:\n- **Angles:**\n    - $\\theta_1^\\star = 90$\n    - $\\theta_2^\\star = 150 - \\theta_1^\\star = 150 - 90 = 60$\n    - $\\theta_3^\\star = 0$\n- **Flows:**\n    - $f_{13}^\\star = \\theta_1^\\star = 90$ MW\n    - $f_{23}^\\star = \\theta_2^\\star = 60$ MW\n    - $f_{12}^\\star = 2\\theta_1^\\star - 150 = 2(90) - 150 = 30$ MW\n    All flows are within their limits ($|30| \\le 40$, $|90| \\le 90$, $|60| \\le 60$).\n- **Generations:**\n    - $g_1^\\star = 3\\theta_1^\\star - 150 = 3(90) - 150 = 270 - 150 = 120$ MW\n    - $g_2^\\star = -3\\theta_1^\\star + 300 = -3(90) + 300 = -270 + 300 = 30$ MW\n    Both generation values are within their limits ($0 \\le 120 \\le 200$ and $0 \\le 30 \\le 200$). The sum is $g_1^\\star + g_2^\\star = 120 + 30 = 150$ MW, which equals the total demand.\n\n**Optimal Cost Calculation:**\nFinally, we calculate the optimal total generation cost $C^\\star$:\n$$\nC^\\star = 10 g_1^\\star + 25 g_2^\\star = 10(120) + 25(30) = 1200 + 750 = 1950\n$$\nThe cost is in dollars per hour.",
            "answer": "$$\n\\boxed{1950}\n$$"
        },
        {
            "introduction": "Real-world energy problems often involve discrete on/off decisions, leading to non-convex optimization challenges. This advanced practice introduces a powerful technique to address this: the perspective reformulation, used to create tight convex relaxations for mixed-integer problems . By deriving the convex envelope for a generator's quadratic cost, you will learn a fundamental method for converting a non-convex problem into a solvable second-order cone program (SOCP), a key step in modern unit commitment modeling.",
            "id": "4110222",
            "problem": "Consider a single generator in an energy system model with a binary on/off commitment variable $u \\in \\{0,1\\}$ and a nonnegative power output $p \\geq 0$. When the generator is on (i.e., $u=1$), its instantaneous loss cost is modeled as the convex quadratic function $f(p) = p^2$. When the generator is off (i.e., $u=0$), it must produce no power, so $p=0$, and the loss cost is $f(0)=0$. The operational envelope imposes the standard coupling constraint $0 \\leq p \\leq \\overline{P}\\,u$, where $\\overline{P}  0$ is a known maximum output when the generator is on. To build a tractable convex relaxation suitable for Mixed-Integer Second-Order Cone Programming (MISOCP), introduce an auxiliary epigraph variable $t$ for the loss cost, and relax the binary variable to $u \\in [0,1]$.\n\nStarting from the definitions of convexity, epigraphs, and the perspective transformation of a convex function, derive the tightest convex lower envelope for the loss cost over the relaxed domain with the coupling constraint. In particular, characterize the minimal convex $t(p,u)$ that lower bounds the original on/off loss $p^2$ whenever $u \\in \\{0,1\\}$ and $p$ satisfies $0 \\leq p \\leq \\overline{P}\\,u$, and that extends to a convex function over $u \\in [0,1]$.\n\nProvide your final answer as a single closed-form analytical expression for $t(p,u)$ valid for $u \\in (0,1]$, expressed purely in terms of $p$ and $u$, without any piecewise cases, and do not include physical units in the expression. You may assume the closure at $(p,u)=(0,0)$ is well-defined by continuity. No numerical rounding is required.",
            "solution": "The problem asks for the derivation of the tightest convex lower envelope for the loss cost of a generator with a binary commitment status. We begin by formally stating the problem and then proceed with the derivation using the principles of convex analysis.\n\nFirst, we validate the problem statement.\n\n### Step 1: Extract Givens\n- A binary commitment variable $u \\in \\{0,1\\}$.\n- A nonnegative power output $p \\geq 0$.\n- The loss cost function is $f(p) = p^2$ when the generator is on ($u=1$). This function is convex.\n- When the generator is off ($u=0$), the power output must be zero ($p=0$), and the loss cost is $f(0)=0$.\n- A coupling constraint links power output to the commitment status: $0 \\leq p \\leq \\overline{P}\\,u$, where $\\overline{P}  0$ is a given constant representing the maximum power output.\n- The optimization problem is to be relaxed for use in a Mixed-Integer Second-Order Cone Program (MISOCP) by relaxing the binary variable to $u \\in [0,1]$ and introducing an auxiliary epigraph variable $t$ for the loss cost.\n- The objective is to derive the tightest convex lower envelope, denoted $t(p,u)$, for the loss cost over the relaxed domain. This envelope must be a convex function that lower bounds the original cost for $u \\in \\{0,1\\}$ and is defined over the continuous domain $\\{(p,u) \\mid u \\in [0,1], 0 \\leq p \\leq \\overline{P}\\,u\\}$.\n- The final answer should be a single closed-form expression for $t(p,u)$ for $u \\in (0,1]$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is well-grounded in the field of energy systems modeling and optimization. Modeling generator costs with quadratic functions and using binary variables for on/off status are standard practices. The use of convex relaxations, epigraphs, and MISOCP is a state-of-the-art technique for solving such mixed-integer nonlinear problems.\n- **Well-Posed**: The problem is well-posed. Finding the convex envelope of a function over a specified domain is a well-defined problem in mathematics with a unique solution.\n- **Objective**: The problem is stated using precise, objective mathematical language.\n- The problem is free of any scientific or factual unsoundness, is formalizable, complete, feasible, and well-structured. It represents a non-trivial application of convex analysis.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\nThe original cost structure is inherently non-convex due to the binary variable $u$. Let us define the effective cost function $C(p,u)$ over the non-convex domain specified by $u \\in \\{0,1\\}$ and $0 \\leq p \\leq \\overline{P}\\,u$.\nThis gives:\n$C(p,u) = \\begin{cases} p^2  \\text{if } u=1, 0 \\leq p \\leq \\overline{P} \\\\ 0  \\text{if } u=0, p=0 \\end{cases}$\nWe introduce an epigraph variable $t$ to represent the cost, such that $t \\geq C(p,u)$. The set of points $(p,u,t)$ corresponding to the original problem's cost function graph is the union of a point and a parabolic curve segment:\n$$S_{graph} = \\{(0,0,0)\\} \\cup \\{ (p, 1, p^2) \\mid p \\in [0, \\overline{P}] \\}$$\nThe task is to find the convex envelope of this function over the relaxed domain $D_{rel} = \\{(p,u) \\mid u \\in [0,1], 0 \\leq p \\leq \\overline{P}\\,u\\}$. The epigraph of the convex envelope is the convex hull of the epigraph of the original function. The convex envelope itself is the function whose graph is the lower boundary of this convex hull.\n\nA powerful tool for constructing convex envelopes of functions involving a scaling variable like $u$ is the perspective transformation. Given a convex function $g(x)$, its perspective function is defined as $h(x,\\lambda) = \\lambda g(x/\\lambda)$ for a scaling variable $\\lambda > 0$. The function $h(x,\\lambda)$ is jointly convex in $(x,\\lambda)$.\n\nIn our problem, the base cost function for the \"on\" state ($u=1$) is $f(p)=p^2$. This is a convex function of $p$. We can identify the power output $p$ with the generic variable $x$ and the commitment variable $u$ with the scaling variable $\\lambda$.\n\nWe apply the perspective transformation to $f(p)=p^2$ with the scaling variable $u$. This gives the function for the lower envelope, which we denote $t(p,u)$:\n$$t(p,u) = u \\cdot f(p/u) = u \\left( \\frac{p}{u} \\right)^2 = \\frac{p^2}{u}$$\nThis expression is defined for $u0$. Let's analyze its properties.\n\n$1$. **Convexity**: Since $f(p)=p^2$ is a convex function, its perspective $t(p,u)=p^2/u$ is a jointly convex function of $(p,u)$ on its domain of definition, which is for $u0$.\n\n$2$. **Agreement with integer points**: We must check if this function correctly represents the cost at the integer values of $u$.\n- For $u=1$: The formula gives $t(p,1) = p^2/1 = p^2$. This exactly matches the original cost function $f(p)=p^2$ for the \"on\" state.\n- For $u=0$: The expression $p^2/u$ is undefined. However, the problem statement allows us to consider the closure of the function at $(p,u)=(0,0)$, which is well-defined by continuity. The relaxed domain requires that $0 \\leq p \\leq \\overline{P}\\,u$. As $u \\to 0^+$, this forces $p \\to 0$. We evaluate the limit of $t(p,u)$ as $(p,u)$ approaches $(0,0)$ within this domain:\n$$ \\lim_{(p,u) \\to (0,0), u0, 0 \\leq p \\leq \\overline{P}u} \\frac{p^2}{u} $$\nFrom the constraint $p \\leq \\overline{P}u$, we have $p^2 \\leq \\overline{P}^2 u^2$. Dividing by $u$ (since $u>0$), we get:\n$$ 0 \\leq \\frac{p^2}{u} \\leq \\overline{P}^2 u $$\nAs $u \\to 0^+$, the term $\\overline{P}^2 u$ approaches $0$. By the Squeeze Theorem, we have:\n$$ \\lim_{(p,u) \\to (0,0), (p,u) \\in D_{rel}} t(p,u) = 0 $$\nThis limit matches the cost of the \"off\" state, $C(0,0)=0$. Therefore, the function $t(p,u)$ defined as $p^2/u$ for $u0$ and $0$ at $(p,u)=(0,0)$ is continuous on the entire relaxed domain $D_{rel}$. The function formed by this closure is convex on the convex set $D_{rel}$.\n\n$3$. **Tightest Lower Bound**: To confirm that $t(p,u) = p^2/u$ is the convex envelope (i.e., the tightest possible convex lower bound), we consider an arbitrary point $(p,u)$ in the relaxed domain $D_{rel}$ with $u \\in (0,1)$. This point can be expressed as a convex combination of two points from the original integer domain:\n$$ (p,u) = (1-u)(0,0) + u\\left(\\frac{p}{u}, 1\\right) $$\nNote that the point $(p/u, 1)$ is in the \"on\" domain, since $0 \\leq p \\leq \\overline{P}u$ implies $0 \\leq p/u \\leq \\overline{P}$ for $u0$.\nLet $\\phi(p,u)$ be any convex function that is a lower bound to the original cost function $C(p,u)$. By Jensen's inequality for convex functions, we must have:\n$$ \\phi(p,u) = \\phi\\left((1-u)(0,0) + u\\left(\\frac{p}{u}, 1\\right)\\right) \\leq (1-u)\\phi(0,0) + u\\,\\phi\\left(\\frac{p}{u}, 1\\right) $$\nSince $\\phi$ is a lower bound, $\\phi(0,0) \\leq C(0,0) = 0$ and $\\phi(p/u, 1) \\leq C(p/u, 1) = (p/u)^2$. To obtain the tightest bound, we must have equality at the integer points where the function is defined, so we consider $\\phi(0,0)=0$ and $\\phi(p/u, 1) = (p/u)^2$.\nSubstituting these into the inequality gives:\n$$ \\phi(p,u) \\leq (1-u)(0) + u\\left(\\frac{p}{u}\\right)^2 = u \\frac{p^2}{u^2} = \\frac{p^2}{u} $$\nThis shows that any convex underestimator $\\phi(p,u)$ must be less than or equal to $p^2/u$. Since our candidate function $t(p,u)=p^2/u$ is itself convex and satisfies this upper bound with equality, it must be the greatest convex lower bound, which is the definition of the convex envelope.\n\nThe resulting constraint is $t \\geq p^2/u$, which is valid for $u0$. In the context of MISOCP, this is typically rewritten as the second-order cone constraint $p^2 \\leq tu$ for $t \\geq 0, u \\geq 0$, which is equivalent to $\\|(2p, t-u)\\|_2 \\leq t+u$. This demonstrates the utility of the derived form.\n\nThe required final answer is the single closed-form expression for $t(p,u)$ valid for $u \\in (0,1]$. This is the expression derived from the perspective function.",
            "answer": "$$\\boxed{\\frac{p^2}{u}}$$"
        }
    ]
}