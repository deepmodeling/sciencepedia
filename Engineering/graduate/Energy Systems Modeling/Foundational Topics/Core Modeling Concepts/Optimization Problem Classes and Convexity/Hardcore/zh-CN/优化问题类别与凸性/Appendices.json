{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂模型之前，我们从能源系统中最基本的问题之一——经济调度（Economic Dispatch）——开始。这个练习将指导你通过解析方法求解一个简化的双发电机系统调度问题。通过构建并求解其 Karush-Kuhn-Tucker (KKT) 条件，你将亲身体验对于凸优化问题，一阶条件如何足以确定全局最优解，并理解与功率平衡约束相关的拉格朗日乘子 $\\lambda$ 如何代表系统的边际电价。",
            "id": "4110217",
            "problem": "电力系统运营商必须调度两台火力发电机组，以经济有效的方式来满足固定的需求。每台发电机 $i \\in \\{1,2\\}$ 都有一个凸二次燃料成本函数，这与能源系统中的标准热耗率模型一致。考虑以下以标准二次规划 (QP) 形式写出的经济调度问题：\n$$\\min_{\\mathbf{p} \\in \\mathbb{R}^{2}} \\;\\; \\frac{1}{2}\\,\\mathbf{p}^{\\top}\\mathbf{H}\\,\\mathbf{p} + \\mathbf{f}^{\\top}\\mathbf{p} + c_{0} \\quad \\text{subject to} \\quad \\mathbf{A}\\,\\mathbf{p} = d, \\quad \\mathbf{0} \\le \\mathbf{p} \\le \\mathbf{p}^{\\max},$$\n其中 $\\mathbf{p} = \\begin{pmatrix} p_{1} \\\\ p_{2} \\end{pmatrix}$ 是以兆瓦 (MW) 为单位的发电机出力向量，$\\mathbf{H} = \\begin{pmatrix} 2  0 \\\\ 0  4 \\end{pmatrix}$ 是一个编码二次边际成本的对称正定矩阵，$\\mathbf{f} = \\begin{pmatrix} 10 \\\\ 6 \\end{pmatrix}$ 编码了线性成本项，$c_{0} \\in \\mathbb{R}$ 是一个常数项，$\\mathbf{A} = \\begin{pmatrix} 1  1 \\end{pmatrix}$ 强制功率平衡，$d = 50$ 是以兆瓦 (MW) 为单位的总需求，以及 $\\mathbf{p}^{\\max} = \\begin{pmatrix} 100 \\\\ 100 \\end{pmatrix}$ 是铭牌上限。零下界反映了发电量的非负性。所有量都是确定性的，反映了没有损耗或爬坡约束的单周期静态调度。\n\n从二次型的凸性和约束优化中的最优性条件的核心定义出发，通过构建和求解 Karush-Kuhn-Tucker (KKT) 系统的一阶最优性条件，使用线性代数解析推导出最优调度 $\\mathbf{p}^{\\star}$。您的推导必须明确证明凸性以及 KKT 条件对此类问题最优性的充分性。验证在解处是否有任何边界约束被激活。\n\n以兆瓦 (MW) 表示最终的最优发电机出力 $p_{1}^{\\star}$ 和 $p_{2}^{\\star}$。提供精确值，不要四舍五入。最终答案必须是仅包含 $(p_{1}^{\\star}, p_{2}^{\\star})$ 的单个行向量。",
            "solution": "所给问题是一个双发电机系统的经济调度问题，被表述为一个二次规划 (QP) 问题。在进行求解之前，先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 优化变量：$\\mathbf{p} = \\begin{pmatrix} p_{1} \\\\ p_{2} \\end{pmatrix} \\in \\mathbb{R}^{2}$\n- 目标函数：$\\min_{\\mathbf{p}} \\;\\; \\frac{1}{2}\\,\\mathbf{p}^{\\top}\\mathbf{H}\\,\\mathbf{p} + \\mathbf{f}^{\\top}\\mathbf{p} + c_{0}$\n- 二次成本矩阵：$\\mathbf{H} = \\begin{pmatrix} 2  0 \\\\ 0  4 \\end{pmatrix}$\n- 线性成本向量：$\\mathbf{f} = \\begin{pmatrix} 10 \\\\ 6 \\end{pmatrix}$\n- 成本常数项：$c_{0} \\in \\mathbb{R}$\n- 等式约束矩阵：$\\mathbf{A} = \\begin{pmatrix} 1  1 \\end{pmatrix}$\n- 等式约束右侧 (需求)：$d = 50$\n- 下界约束：$\\mathbf{p} \\ge \\mathbf{0}$，其中 $\\mathbf{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$\n- 上界约束：$\\mathbf{p} \\le \\mathbf{p}^{\\max}$，其中 $\\mathbf{p}^{\\max} = \\begin{pmatrix} 100 \\\\ 100 \\end{pmatrix}$\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题使用了火力发电机的标准凸二次成本函数模型，并强制执行功率平衡方程和容量限制。这是电力系统经济学中一个基本且成熟的公式。该设置在科学上是合理的。\n- **适定性**：该问题是一个QP。目标函数的Hessian矩阵是给定的矩阵 $\\mathbf{H}$。对角矩阵 $\\mathbf{H}$ 的特征值是其对角线元素，即 $\\lambda_1 = 2$ 和 $\\lambda_2 = 4$。由于两个特征值都严格为正，$\\mathbf{H}$ 是正定的，目标函数是严格凸的。所有约束都是线性的，定义了一个凸且紧的可行集（一条线段）。在非空、闭合、凸集上对一个严格凸函数进行最小化，会得到一个唯一的解。因此，该问题是适定的。\n- **客观性**：该问题使用精确的数学符号和无歧义的语言陈述。它是客观的。\n\n### 步骤3：结论与行动\n该问题有效。将通过构建和求解 Karush-Kuhn-Tucker (KKT) 条件来推导求解。\n\n### 最优调度的推导\n\n该优化问题是：\n$$ \\min_{p_1, p_2} \\;\\; f(\\mathbf{p}) = \\frac{1}{2}\\begin{pmatrix} p_1  p_2 \\end{pmatrix} \\begin{pmatrix} 2  0 \\\\ 0  4 \\end{pmatrix} \\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix} + \\begin{pmatrix} 10  6 \\end{pmatrix} \\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix} + c_0 $$\n$$ \\text{subject to:} $$\n$$ p_1 + p_2 = 50 $$\n$$ 0 \\le p_1 \\le 100 $$\n$$ 0 \\le p_2 \\le 100 $$\n\n这展开为最小化 $f(p_1, p_2) = p_1^2 + 2p_2^2 + 10p_1 + 6p_2 + c_0$。如前所述，目标函数是严格凸的，可行域是凸的。因此，KKT 条件是全局最优性的充分必要条件。\n\n该问题的拉格朗日函数 $\\mathcal{L}$ 是通过将拉格朗日乘子与每个约束相关联来构建的。设 $\\lambda$ 为等式约束的乘子，$\\mu_{1,L}$ 和 $\\mu_{2,L}$ 为下界约束 ($p_1 \\ge 0, p_2 \\ge 0$) 的乘子，$\\mu_{1,U}$ 和 $\\mu_{2,U}$ 为上界约束 ($p_1 \\le 100, p_2 \\le 100$) 的乘子。约束以 $g(\\mathbf{p}) \\le 0$ 的形式写出。\n\n$\\mathcal{L}(p_1, p_2, \\lambda, \\boldsymbol{\\mu}) = p_1^2 + 2p_2^2 + 10p_1 + 6p_2 + c_0 + \\lambda(p_1+p_2-50) - \\mu_{1,L}p_1 - \\mu_{2,L}p_2 + \\mu_{1,U}(p_1-100) + \\mu_{2,U}(p_2-100)$\n\nKKT 条件如下：\n1.  **驻点性**：拉格朗日函数关于主变量 $(p_1, p_2)$ 的梯度必须为零。\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial p_1} = 2p_1 + 10 + \\lambda - \\mu_{1,L} + \\mu_{1,U} = 0 $$\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial p_2} = 4p_2 + 6 + \\lambda - \\mu_{2,L} + \\mu_{2,U} = 0 $$\n2.  **原始可行性**：解必须满足所有约束。\n    $$ p_1 + p_2 = 50 $$\n    $$ 0 \\le p_1 \\le 100 $$\n    $$ 0 \\le p_2 \\le 100 $$\n3.  **对偶可行性**：不等式约束的拉格朗日乘子必须为非负。\n    $$ \\mu_{1,L}, \\mu_{2,L}, \\mu_{1,U}, \\mu_{2,U} \\ge 0 $$\n4.  **互补松弛性**：不等式乘子与其对应松弛量的乘积必须为零。\n    $$ \\mu_{1,L} p_1 = 0, \\quad \\mu_{2,L} p_2 = 0 $$\n    $$ \\mu_{1,U} (p_1 - 100) = 0, \\quad \\mu_{2,U} (p_2 - 100) = 0 $$\n\n为了求解这个系统，我们首先做一个简化假设，即没有边界约束被激活，也即 $0  p_1  100$ 和 $0  p_2  100$。对于一个相对于发电机容量而言适中的需求水平，这是一个合理的初始假设。\n\n如果没有边界被激活，互补松弛性意味着它们对应的乘子为零：$\\mu_{1,L}=\\mu_{1,U}=0$ 和 $\\mu_{2,L}=\\mu_{2,U}=0$。驻点性条件简化为：\n$$ 2p_1 + 10 + \\lambda = 0 \\quad \\implies \\quad 2p_1 + 10 = -\\lambda $$\n$$ 4p_2 + 6 + \\lambda = 0 \\quad \\implies \\quad 4p_2 + 6 = -\\lambda $$\n项 $-\\lambda$ 是系统的能源边际价格。对于最优调度，两台发电机的增量成本必须等于这个价格。令两个表达式相等，得到：\n$$ 2p_1 + 10 = 4p_2 + 6 $$\n$$ 2p_1 - 4p_2 = -4 $$\n$$ p_1 - 2p_2 = -2 $$\n现在我们得到了一个包含两个变量的二元线性方程组，即此方程和功率平衡方程：\n1. $p_1 - 2p_2 = -2$\n2. $p_1 + p_2 = 50$\n\n用方程(2)减去方程(1)得到：\n$$ (p_1 + p_2) - (p_1 - 2p_2) = 50 - (-2) $$\n$$ 3p_2 = 52 $$\n$$ p_2^{\\star} = \\frac{52}{3} $$\n将此值代回功率平衡方程以求得 $p_1$：\n$$ p_1^{\\star} = 50 - p_2^{\\star} = 50 - \\frac{52}{3} = \\frac{150 - 52}{3} = \\frac{98}{3} $$\n提出的最优调度为 $\\mathbf{p}^{\\star} = \\begin{pmatrix} 98/3 \\\\ 52/3 \\end{pmatrix}$。\n\n最后，我们必须验证这个解是否与我们最初的“没有边界被激活”的假设一致。\n对于发电机1：$p_1^{\\star} = \\frac{98}{3} \\approx 32.67$。该值满足 $0  32.67  100$。\n对于发电机2：$p_2^{\\star} = \\frac{52}{3} \\approx 17.33$。该值满足 $0  17.33  100$。\n\n边界的两个原始可行性条件都被严格满足。这证实了我们最初的假设是正确的，并且乘子 $\\mu_{1,L}, \\mu_{1,U}, \\mu_{2,L}, \\mu_{2,U}$ 确实都为零。所有 KKT 条件均已满足。由于 KKT 条件对于这个严格凸问题是充分的，唯一的全局最小值是 $\\mathbf{p}^{\\star} = \\begin{pmatrix} 98/3 \\\\ 52/3 \\end{pmatrix}$。在解处没有边界约束被激活。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{98}{3}  \\frac{52}{3} \\end{pmatrix}}$$"
        },
        {
            "introduction": "现实世界的电力系统受制于输电网络的物理限制。直流最优潮流 (DC-OPF) 模型是分析这些限制如何影响经济调度的行业标准方法，它将复杂物理问题简化为一个线性规划 (LP) 问题。通过解析求解一个三节点系统实例，你将观察到线性规划的最优解为何总是出现在可行域多面体的顶点上，并揭示输电阻塞是如何影响发电机组的最优出力的。",
            "id": "4110262",
            "problem": "考虑直流最优潮流 (DC-OPF) 模型，其中使用线性化潮流近似：节点 $i$ 和 $j$ 之间的输电线路上有功功率潮流为 $f_{ij} = b_{ij}(\\theta_i - \\theta_j)$，其中节点电压相角 $\\theta_i$ 以弧度表示，$b_{ij}$ 是线路电纳（单位为兆瓦/弧度）。在 DC-OPF 中，每个节点的功率平衡、线路潮流-相角关系、发电机出力边界和线路热极限共同定义了一个多面体可行域。目标是一个线性的发电成本函数。\n\n一个三节点系统的具体说明如下。所有量纲的单位为兆瓦 (MW) 和美元/兆瓦时 ($\\$/\\text{MWh}$)，相角单位为弧度。为简便起见，电纳被归一化为 $b_{12} = b_{13} = b_{23} = 1$。节点 $3$ 是平衡节点，因此 $\\theta_3 = 0$。\n\n- 网络拓扑：线路 $(1,2)$、$(1,3)$ 和 $(2,3)$。\n- 线路热极限：$|f_{12}| \\le 40$ MW, $|f_{13}| \\le 90$ MW, $|f_{23}| \\le 60$ MW。\n- 负荷：$D_1 = 0$ MW, $D_2 = 0$ MW, $D_3 = 150$ MW。\n- 发电机：位于节点 $1$ 和节点 $2$，其出力分别为 $g_1$ 和 $g_2$，边界为 $0 \\le g_1 \\le 200$ MW, $0 \\le g_2 \\le 200$ MW，线性成本分别为 $c_1 = 10$ $\\$/\\text{MWh}$ 和 $c_2 = 25$ $\\$/\\text{MWh}$。\n\n使用以下条件，将 DC-OPF 构建为一个关于变量 $g_1$, $g_2$, $\\theta_1$, $\\theta_2$, $\\theta_3$, $f_{12}$, $f_{13}$, $f_{23}$ 的线性规划：\n- 每个节点的功率平衡，\n- 潮流-相角关系 $f_{ij} = \\theta_i - \\theta_j$ (因为 $b_{ij} = 1$)，\n- 线路极限，\n- 平衡相角条件 $\\theta_3 = 0$，\n- 发电机出力边界。\n\n从第一性原理出发对问题进行解析求解，通过明确指出最优解处的有效约束，来说明最优解位于可行多面体的一个极点上。计算最优总发电成本 $C^\\star$，单位为美元/小时。最终成本以美元/小时表示。无需四舍五入；请提供精确值。",
            "solution": "用户提供了一个需要解析求解的直流最优潮流 (DC-OPF) 问题。\n\n### 步骤 1：问题验证\n\n首先，我将提取已知条件并验证问题陈述。\n\n**已知条件：**\n- **模型：**直流最优潮流 (DC-OPF)。\n- **潮流定律：**$f_{ij} = b_{ij}(\\theta_i - \\theta_j)$，其中 $f_{ij}$ 是有功功率潮流，$\\theta_i$ 是节点电压相角，$b_{ij}$ 是线路电纳。\n- **拓扑结构：**一个三节点系统，线路连接 $(1,2)$、$(1,3)$ 和 $(2,3)$。\n- **电纳：**$b_{12} = 1$, $b_{13} = 1$, $b_{23} = 1$。单位默认为兆瓦/弧度。\n- **平衡节点：**节点 $3$ 是参考节点，因此 $\\theta_3 = 0$ 弧度。\n- **线路热极限：**$|f_{12}| \\le 40$ MW, $|f_{13}| \\le 90$ MW, $|f_{23}| \\le 60$ MW。\n- **负荷：**$D_1 = 0$ MW, $D_2 = 0$ MW, $D_3 = 150$ MW。\n- **发电机：**\n    - 节点 $1$：发电量 $g_1$，限值 $0 \\le g_1 \\le 200$ MW，成本 $c_1 = 10$ $\\$/\\text{MWh}$。\n    - 节点 $2$：发电量 $g_2$，限值 $0 \\le g_2 \\le 200$ MW，成本 $c_2 = 25$ $\\$/\\text{MWh}$。\n- **建模变量：**$g_1, g_2, \\theta_1, \\theta_2, \\theta_3, f_{12}, f_{13}, f_{23}$。\n\n**验证：**\n1.  **科学依据：**该问题基于 DC-OPF 模型，这是电力系统分析和电力市场建模中的一个基础且广泛使用的工具。它代表了对完整交流潮流方程的标准线性化。所有术语和参数都是电气工程领域的标准术语。该问题在科学上是合理的。\n2.  **适定性：**该问题描述了一个线性规划 (LP)，其特点是线性的目标函数和一组线性约束。LP 的可行域是一个凸多面体。只要可行域非空，解就存在。分析将表明情况确实如此。该问题是适定的。\n3.  **客观性：**该问题使用精确、无歧义的数学和技术语言陈述，不含主观因素。\n4.  **完整性与一致性：**所有必要数据（成本、限值、负荷、网络参数）均已提供。设置中没有矛盾之处。该问题是自洽的。\n\n**结论：**该问题是有效的。我现在将继续进行求解。\n\n### 步骤 2：建模与求解\n\n目标是在一组代表电力系统物理和运行限制的线性约束条件下，最小化总发电成本 $C$。\n\n**目标函数：**\n总成本是各节点发电成本之和。\n$$\n\\min C = c_1 g_1 + c_2 g_2 = 10 g_1 + 25 g_2\n$$\n\n**约束条件：**\n1.  **功率平衡方程：**在每个节点，发电量减去负荷必须等于流出该节点的净功率。\n    -   节点 $1$：$g_1 - D_1 = f_{12} + f_{13} \\implies g_1 = f_{12} + f_{13}$\n    -   节点 $2$：$g_2 - D_2 = f_{21} + f_{23} \\implies g_2 = -f_{12} + f_{23}$ (使用 $f_{21} = -f_{12}$)\n    -   节点 $3$：$0 - D_3 = f_{31} + f_{32} \\implies -150 = -f_{13} - f_{23} \\implies f_{13} + f_{23} = 150$\n\n    值得注意的是，将节点 $1$ 和节点 $2$ 的功率平衡方程相加，可得 $g_1 + g_2 = f_{13} + f_{23}$。结合节点 $3$ 的方程，我们得到全系统的功率平衡：$g_1 + g_2 = 150$。总发电量等于总负荷。\n\n2.  **潮流-相角关系：**由于所有电纳 $b_{ij}=1$ 且 $\\theta_3 = 0$：\n    -   $f_{12} = \\theta_1 - \\theta_2$\n    -   $f_{13} = \\theta_1 - \\theta_3 = \\theta_1$\n    -   $f_{23} = \\theta_2 - \\theta_3 = \\theta_2$\n\n3.  **发电机出力限值：**\n    -   $0 \\le g_1 \\le 200$\n    -   $0 \\le g_2 \\le 200$\n\n4.  **线路热极限：**\n    -   $|f_{12}| \\le 40 \\implies -40 \\le f_{12} \\le 40$\n    -   $|f_{13}| \\le 90 \\implies -90 \\le f_{13} \\le 90$\n    -   $|f_{23}| \\le 60 \\implies -60 \\le f_{23} \\le 60$\n\n**问题简化：**\n我们可以将问题简化为单一变量。我们选择 $\\theta_1$。\n根据潮流-相角关系，我们有 $f_{13} = \\theta_1$ 和 $f_{23} = \\theta_2$。\n将这些代入节点 3 的功率平衡方程：\n$f_{13} + f_{23} = 150 \\implies \\theta_1 + \\theta_2 = 150$。\n这使我们能够用 $\\theta_1$ 表示 $\\theta_2$：$\\theta_2 = 150 - \\theta_1$。\n\n现在，我们用 $\\theta_1$ 表示所有的功率潮流和发电出力：\n-   $f_{13} = \\theta_1$\n-   $f_{23} = \\theta_2 = 150 - \\theta_1$\n-   $f_{12} = \\theta_1 - \\theta_2 = \\theta_1 - (150 - \\theta_1) = 2\\theta_1 - 150$\n\n-   $g_1 = f_{12} + f_{13} = (2\\theta_1 - 150) + \\theta_1 = 3\\theta_1 - 150$\n-   $g_2 = -f_{12} + f_{23} = -(2\\theta_1 - 150) + (150 - \\theta_1) = -3\\theta_1 + 300$\n\n目标函数变为 $\\theta_1$ 的函数：\n$C(\\theta_1) = 10 (3\\theta_1 - 150) + 25 (-3\\theta_1 + 300) = 30\\theta_1 - 1500 - 75\\theta_1 + 7500 = 6000 - 45\\theta_1$。\n要最小化 $C(\\theta_1)$，我们必须最大化 $\\theta_1$。\n\n**$\\theta_1$ 的可行域：**\n我们将所有约束都转换为关于 $\\theta_1$ 的约束。\n1.  **发电机 $g_1$ 限值：** $0 \\le 3\\theta_1 - 150 \\le 200$\n    -   $150 \\le 3\\theta_1 \\implies \\theta_1 \\ge 50$\n    -   $3\\theta_1 \\le 350 \\implies \\theta_1 \\le \\frac{350}{3} \\approx 116.67$\n    因此，$\\theta_1 \\in [50, \\frac{350}{3}]$。\n\n2.  **发电机 $g_2$ 限值：** $0 \\le -3\\theta_1 + 300 \\le 200$\n    -   $3\\theta_1 \\le 300 \\implies \\theta_1 \\le 100$\n    -   $100 \\le 3\\theta_1 \\implies \\theta_1 \\ge \\frac{100}{3} \\approx 33.33$\n    因此，$\\theta_1 \\in [\\frac{100}{3}, 100]$。\n\n3.  **线路潮流 $f_{12}$ 限值：** $|2\\theta_1 - 150| \\le 40$\n    -   $-40 \\le 2\\theta_1 - 150 \\le 40$\n    -   $110 \\le 2\\theta_1 \\implies \\theta_1 \\ge 55$\n    -   $2\\theta_1 \\le 190 \\implies \\theta_1 \\le 95$\n    因此，$\\theta_1 \\in [55, 95]$。\n\n4.  **线路潮流 $f_{13}$ 限值：** $|\\theta_1| \\le 90$\n    -   因此，$\\theta_1 \\in [-90, 90]$。\n\n5.  **线路潮流 $f_{23}$ 限值：** $|150 - \\theta_1| \\le 60$\n    -   $-60 \\le 150 - \\theta_1 \\le 60$\n    -   $150 - \\theta_1 \\le 60 \\implies \\theta_1 \\ge 90$\n    -   $150 - \\theta_1 \\ge -60 \\implies \\theta_1 \\le 210$\n    因此，$\\theta_1 \\in [90, 210]$。\n\n为了找到 $\\theta_1$ 的可行域，我们必须求所有这些区间的交集：\n$$\n\\theta_1 \\in \\left[50, \\frac{350}{3}\\right] \\cap \\left[\\frac{100}{3}, 100\\right] \\cap [55, 95] \\cap [-90, 90] \\cap [90, 210]\n$$\n下界是各个下界中的最大值：\n$$\n\\max\\left(50, \\frac{100}{3}, 55, -90, 90\\right) = 90\n$$\n上界是各个上界中的最小值：\n$$\n\\min\\left(\\frac{350}{3}, 100, 95, 90, 210\\right) = 90\n$$\n$\\theta_1$ 的可行域是单点 $\\theta_1 = 90$。\n\n**最优解：**\n由于我们需要在 $\\theta_1$ 的可行域上将其最大化，而可行域只是点 $\\{90\\}$，因此最优值为 $\\theta_1^\\star = 90$。\n\n该解位于可行多面体的一个极点上。定义该点的约束就是确定 $\\theta_1$ 可行区间上下界的那些约束。\n- 下界 $\\theta_1 \\ge 90$ 来自于对 $f_{23}$ 的限制，具体是 $f_{23} \\le 60$ (因为 $f_{23} = 150 - \\theta_1$)。\n- 上界 $\\theta_1 \\le 90$ 来自于对 $f_{13}$ 的限制，具体是 $f_{13} \\le 90$。\n\n因此，最优解由等式约束平面 $\\theta_1+\\theta_2=150$ 与两个有效不等式约束 $f_{13} \\le 90$ 和 $f_{23} \\le 60$ 的交点定义。在问题的全维空间中，这构成可行多面体的一个极点（一个顶点）。最优解处的有效约束是：\n- $f_{13} = 90$ MW (线路 1-3 的热极限上限)\n- $f_{23} = 60$ MW (线路 2-3 的热极限上限)\n\n现在我们计算所有变量的最优值：\n- **相角：**\n    - $\\theta_1^\\star = 90$\n    - $\\theta_2^\\star = 150 - \\theta_1^\\star = 150 - 90 = 60$\n    - $\\theta_3^\\star = 0$\n- **潮流：**\n    - $f_{13}^\\star = \\theta_1^\\star = 90$ MW\n    - $f_{23}^\\star = \\theta_2^\\star = 60$ MW\n    - $f_{12}^\\star = 2\\theta_1^\\star - 150 = 2(90) - 150 = 30$ MW\n    所有潮流都在其限值内 ($|30| \\le 40$, $|90| \\le 90$, $|60| \\le 60$)。\n- **发电量：**\n    - $g_1^\\star = 3\\theta_1^\\star - 150 = 3(90) - 150 = 270 - 150 = 120$ MW\n    - $g_2^\\star = -3\\theta_1^\\star + 300 = -3(90) + 300 = -270 + 300 = 30$ MW\n    两个发电量值都在其限值内 ($0 \\le 120 \\le 200$ 且 $0 \\le 30 \\le 200$)。总和为 $g_1^\\star + g_2^\\star = 120 + 30 = 150$ MW，等于总负荷。\n\n**最优成本计算：**\n最后，我们计算最优总发电成本 $C^\\star$：\n$$\nC^\\star = 10 g_1^\\star + 25 g_2^\\star = 10(120) + 25(30) = 1200 + 750 = 1950\n$$\n成本单位为美元/小时。",
            "answer": "$$\n\\boxed{1950}\n$$"
        },
        {
            "introduction": "能源系统优化中的一个核心挑战来自于发电机组启停决策所引入的非凸性。这个问题将引导你处理一个典型的非凸结构：一个二次成本函数，其仅在机组开启时（由一个二元变量 $u \\in \\{0,1\\}$ 表示）才产生。你将学习如何运用视角函数（perspective function）这一强大工具，为这个非凸成本函数推导出其最紧的凸包络（convex envelope），这是将混合整数非线性问题转化为可求解的混合整数二阶锥规划 (MISOCP) 问题的关键一步。",
            "id": "4110222",
            "problem": "考虑一个能源系统模型中的单台发电机，其具有一个二元启停决策变量 $u \\in \\{0,1\\}$ 和一个非负功率输出 $p \\geq 0$。当发电机开启时（即 $u=1$），其瞬时损耗成本被建模为凸二次函数 $f(p) = p^{2}$。当发电机关闭时（即 $u=0$），它必须不产生功率，因此 $p=0$，且损耗成本为 $f(0)=0$。运行范围施加了标准耦合约束 $0 \\leq p \\leq \\overline{P}\\,u$，其中 $\\overline{P}  0$ 是发电机开启时的已知最大输出功率。为了构建一个适用于混合整数二阶锥规划（MISOCP）的易于处理的凸松弛，为损耗成本引入一个辅助上镜图变量 $t$，并将二元变量松弛至 $u \\in [0,1]$。\n\n从凸性、上镜图以及凸函数的透视变换的定义出发，推导在耦合约束下的松弛域上该损耗成本的最紧凸下包络。具体来说，刻画出最小的凸函数 $t(p,u)$，它在 $u \\in \\{0,1\\}$ 且 $p$ 满足 $0 \\leq p \\leq \\overline{P}\\,u$ 时，作为原始启停损耗 $p^{2}$ 的下界，并且可以延拓为定义在 $u \\in [0,1]$ 上的凸函数。\n\n请以单一闭式解析表达式的形式给出在 $u \\in (0,1]$ 上有效的 $t(p,u)$，该表达式纯粹用 $p$ 和 $u$ 表示，不包含任何分段情况，且表达式中不包含物理单位。你可以假设在 $(p,u)=(0,0)$ 处的闭包由连续性良定义。无需进行数值舍入。",
            "solution": "该问题要求推导具有二元启停状态的发电机损耗成本的最紧凸下包络。我们首先形式化地陈述问题，然后利用凸分析的原理进行推导。\n\n首先，我们验证问题陈述的有效性。\n\n### 步骤1：提取已知条件\n- 一个二元启停决策变量 $u \\in \\{0,1\\}$。\n- 一个非负功率输出 $p \\geq 0$。\n- 当发电机开启时（$u=1$），损耗成本函数为 $f(p) = p^{2}$。该函数是凸函数。\n- 当发电机关闭时（$u=0$），功率输出必须为零（$p=0$），且损耗成本为 $f(0)=0$。\n- 一个耦合约束将功率输出与启停状态联系起来：$0 \\leq p \\leq \\overline{P}\\,u$，其中 $\\overline{P}  0$ 是一个给定的常数，代表最大功率输出。\n- 为了在混合整数二阶锥规划（MISOCP）中使用，该优化问题将被松弛，方法是将二元变量松弛至 $u \\in [0,1]$ 并为损耗成本引入一个辅助上镜图变量 $t$。\n- 目标是推导在松弛域上损耗成本的最紧凸下包络，记为 $t(p,u)$。该包络必须是一个凸函数，它为 $u \\in \\{0,1\\}$ 时的原始成本提供下界，并且定义在连续域 $\\{(p,u) \\mid u \\in [0,1], 0 \\leq p \\leq \\overline{P}\\,u\\}$ 上。\n- 最终答案应为在 $u \\in (0,1]$ 上有效的 $t(p,u)$ 的单一闭式表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题在能源系统建模与优化领域有坚实的理论基础。使用二次函数建模发电机成本和使用二元变量表示启停状态是标准做法。使用凸松弛、上镜图和MISOCP是解决此类混合整数非线性问题的先进技术。\n- **适定性**：该问题是适定的。在指定域上寻找一个函数的凸包络在数学上是一个具有唯一解的明确定义的问题。\n- **客观性**：问题使用了精确、客观的数学语言进行陈述。\n- 该问题没有任何科学或事实上的不健全之处，是可形式化的、完整的、可行的且结构良好。它代表了凸分析的一个非平凡应用。\n\n### 步骤3：结论与行动\n问题有效。我们继续进行求解。\n\n由于存在二元变量 $u$，原始成本结构在本质上是非凸的。我们定义在由 $u \\in \\{0,1\\}$ 和 $0 \\leq p \\leq \\overline{P}\\,u$ 指定的非凸域上的有效成本函数 $C(p,u)$。\n这给出：\n$C(p,u) = \\begin{cases} p^2  \\text{if } u=1, 0 \\leq p \\leq \\overline{P} \\\\ 0  \\text{if } u=0, p=0 \\end{cases}$\n我们引入一个上镜图变量 $t$ 来表示成本，使得 $t \\geq C(p,u)$。对应于原始问题成本函数图像的点集 $(p,u,t)$ 是一个点和一个抛物线段的并集：\n$S_{graph} = \\{(0,0,0)\\} \\cup \\{ (p, 1, p^2) \\mid p \\in [0, \\overline{P}] \\}$\n任务是找到此函数在松弛域 $D_{rel} = \\{(p,u) \\mid u \\in [0,1], 0 \\leq p \\leq \\overline{P}\\,u\\}$ 上的凸包络。凸包络的上镜图是原始函数上镜图的凸包。凸包络本身是其图像为此凸包下边界的函数。\n\n一个构建涉及像 $u$ 这样的尺度变量的函数的凸包络的强大工具是透视变换。给定一个凸函数 $g(x)$，其透视函数定义为 $h(x,\\lambda) = \\lambda \\, g(x/\\lambda)$，其中尺度变量 $\\lambda > 0$。函数 $h(x,\\lambda)$ 在 $(x,\\lambda)$ 上是联合凸的。\n\n在我们的问题中，“开启”状态（$u=1$）的基础成本函数是 $f(p)=p^2$。这是一个关于 $p$ 的凸函数。我们可以将功率输出 $p$ 视为一般变量 $x$，将决策变量 $u$ 视为尺度变量 $\\lambda$。\n\n我们将透视变换应用于 $f(p)=p^2$，以 $u$ 为尺度变量。这给出了下包络的函数，我们将其表示为 $t(p,u)$：\n$$t(p,u) = u \\cdot f(p/u) = u \\left( \\frac{p}{u} \\right)^2 = \\frac{p^2}{u}$$\n该表达式在 $u>0$ 时有定义。我们来分析其性质。\n\n1. **凸性**：由于 $f(p)=p^2$ 是一个凸函数，其透视函数 $t(p,u)=p^2/u$ 在其定义域（即 $u>0$）上是 $(p,u)$ 的联合凸函数。\n\n2. **与整点的一致性**：我们必须检查此函数是否在 $u$ 的整数值上正确表示成本。\n- 对于 $u=1$：公式给出 $t(p,1) = p^2/1 = p^2$。这与“开启”状态的原始成本函数 $f(p)=p^2$ 完全匹配。\n- 对于 $u=0$：表达式 $p^2/u$ 未定义。然而，问题陈述允许我们考虑函数在 $(p,u)=(0,0)$ 处的闭包，该闭包由连续性良定义。松弛域要求 $0 \\leq p \\leq \\overline{P}\\,u$。当 $u \\to 0^+$ 时，这迫使 $p \\to 0$。我们计算当 $(p,u)$ 在此域内趋近于 $(0,0)$ 时 $t(p,u)$ 的极限：\n$$ \\lim_{(p,u) \\to (0,0), u>0, 0 \\leq p \\leq \\overline{P}u} \\frac{p^2}{u} $$\n根据约束 $p \\leq \\overline{P}u$，我们有 $p^2 \\leq \\overline{P}^2 u^2$。两边同除以 $u$（因为 $u>0$），得到：\n$$ 0 \\leq \\frac{p^2}{u} \\leq \\overline{P}^2 u $$\n当 $u \\to 0^+$ 时，$\\overline{P}^2 u$ 项趋近于 $0$。根据夹逼定理，我们有：\n$$ \\lim_{(p,u) \\to (0,0), (p,u) \\in D_{rel}} t(p,u) = 0 $$\n该极限与“关闭”状态的成本 $C(0,0)=0$ 相匹配。因此，定义为当 $u>0$ 时为 $p^2/u$、在 $(p,u)=(0,0)$ 处为 $0$ 的函数 $t(p,u)$ 在整个松弛域 $D_{rel}$ 上是连续的。由该闭包形成的函数在凸集 $D_{rel}$ 上是凸的。\n\n3. **最紧下界**：为确认 $t(p,u) = p^2/u$ 是凸包络（即可能的最紧凸下界），我们考虑松弛域 $D_{rel}$ 中 $u \\in (0,1)$ 的任意点 $(p,u)$。该点可以表示为原始整数域中两点的凸组合：\n$$ (p,u) = (1-u)(0,0) + u\\left(\\frac{p}{u}, 1\\right) $$\n请注意，点 $(p/u, 1)$ 位于“开启”域内，因为对于 $u>0$，$0 \\leq p \\leq \\overline{P}u$ 意味着 $0 \\leq p/u \\leq \\overline{P}$。\n设 $\\phi(p,u)$ 是原始成本函数 $C(p,u)$ 的任意凸下界函数。根据凸函数的 Jensen 不等式，我们必须有：\n$$ \\phi(p,u) = \\phi\\left((1-u)(0,0) + u\\left(\\frac{p}{u}, 1\\right)\\right) \\leq (1-u)\\phi(0,0) + u\\,\\phi\\left(\\frac{p}{u}, 1\\right) $$\n由于 $\\phi$ 是一个下界，$\\phi(0,0) \\leq C(0,0) = 0$ 且 $\\phi(p/u, 1) \\leq C(p/u, 1) = (p/u)^2$。为了获得最紧的界，我们必须在函数有定义的整点处取等号，因此我们考虑 $\\phi(0,0)=0$ 和 $\\phi(p/u, 1) = (p/u)^2$。\n将这些代入不等式，得到：\n$$ \\phi(p,u) \\leq (1-u)(0) + u\\left(\\frac{p}{u}\\right)^2 = u \\frac{p^2}{u^2} = \\frac{p^2}{u} $$\n这表明任何凸下估计函数 $\\phi(p,u)$ 必须小于或等于 $p^2/u$。由于我们的候选函数 $t(p,u)=p^2/u$ 本身是凸的，并且以等号满足此上界，因此它必须是最大凸下界，这正是凸包络的定义。\n\n得到的约束是 $t \\geq p^2/u$，它在 $u>0$ 时有效。在MISOCP的背景下，这通常被重写为二阶锥约束 $p^2 \\leq tu$（对于 $t \\geq 0, u \\geq 0$），这等价于 $\\|(2p, t-u)\\|_2 \\leq t+u$。这证明了所推导形式的实用性。\n\n要求的最终答案是对于 $u \\in (0,1]$ 有效的 $t(p,u)$ 的单一闭式表达式。这就是从透视函数推导出的表达式。",
            "answer": "$$\\boxed{\\frac{p^2}{u}}$$"
        }
    ]
}