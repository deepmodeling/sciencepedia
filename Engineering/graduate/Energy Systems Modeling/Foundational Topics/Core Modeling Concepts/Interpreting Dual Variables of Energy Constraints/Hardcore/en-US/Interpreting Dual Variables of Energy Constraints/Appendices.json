{
    "hands_on_practices": [
        {
            "introduction": "We begin our hands-on exploration with the foundational concept of economic dispatch, the cornerstone of wholesale electricity market clearing. This exercise grounds the abstract definition of a dual variable in the tangible process of setting a market price for energy. By applying the Karush–Kuhn–Tucker (KKT) conditions to a simple linear program, you will derive from first principles how the cost of the marginal generator—the last unit dispatched to satisfy demand—determines the system-wide price of energy, a value identical to the dual variable on the energy balance constraint .",
            "id": "4098522",
            "problem": "Consider a static, single-period economic dispatch problem for three thermal generators in an energy-only market with linear variable operating costs, subject to a system-wide energy-balance requirement. The planning objective is to minimize total variable generation cost while meeting an inelastic demand. The mathematical program is\nminimize over $g_1, g_2, g_3$ the objective $c_1 g_1 + c_2 g_2 + c_3 g_3$\nsubject to the constraints $g_1 + g_2 + g_3 \\ge D$, $0 \\le g_i \\le \\bar g_i$ for each $i \\in \\{1,2,3\\}$,\nwhere $g_i$ denotes the dispatch of generator $i$, $c_i$ is its variable cost in dollars per megawatt-hour, $\\bar g_i$ is its capacity in megawatts, and $D$ is the total system demand in megawatts. Let $\\lambda \\ge 0$ be the dual variable (Lagrange multiplier) for the energy-balance constraint $g_1 + g_2 + g_3 \\ge D$.\n\nStarting from the definition of the Lagrangian and the Karush–Kuhn–Tucker conditions, derive the stationarity and complementary slackness conditions that characterize an optimal solution. Use these conditions to compute the numerical value of the optimal dual variable $\\lambda$ when the data are $c = (10, 20, 50)$ dollars per megawatt-hour, $\\bar g = (50, 30, 10)$ megawatts, and $D = 60$ megawatts. Then, interpret the computed $\\lambda$ as a marginal value of energy in this dispatch problem.\n\nExpress the numerical value of $\\lambda$ in dollars per megawatt-hour. No rounding is required.",
            "solution": "The problem stated is a linear program for economic dispatch. Let us first formalize the problem and its dual. The primal problem is to minimize the total generation cost, given by the objective function $C = c_1 g_1 + c_2 g_2 + c_3 g_3$, subject to constraints on generation capacity and system demand. Let us write the problem in a standard form for applying the Karush-Kuhn-Tucker (KKT) conditions. The decision variables are the generation levels $g_1, g_2, g_3$.\n\nThe optimization problem is:\n$$ \\text{minimize} \\quad \\sum_{i=1}^{3} c_i g_i $$\nsubject to:\n$$ D - \\sum_{i=1}^{3} g_i \\le 0 $$\n$$ -g_i \\le 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n$$ g_i - \\bar g_i \\le 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\nWe associate non-negative dual variables (Lagrange multipliers) with each constraint:\n- $\\lambda \\ge 0$ for the energy balance constraint $D - \\sum_{i=1}^{3} g_i \\le 0$.\n- $\\mu_i \\ge 0$ for the lower-bound constraint $-g_i \\le 0$.\n- $\\nu_i \\ge 0$ for the upper-bound (capacity) constraint $g_i - \\bar g_i \\le 0$.\n\nThe Lagrangian function $\\mathcal{L}$ for this problem is defined as the objective function plus the sum of the products of the dual variables and their corresponding constraint functions:\n$$ \\mathcal{L}(g, \\lambda, \\mu, \\nu) = \\sum_{i=1}^{3} c_i g_i + \\lambda \\left( D - \\sum_{i=1}^{3} g_i \\right) + \\sum_{i=1}^{3} \\mu_i (-g_i) + \\sum_{i=1}^{3} \\nu_i (g_i - \\bar g_i) $$\nRearranging by the primal variables $g_i$:\n$$ \\mathcal{L}(g, \\lambda, \\mu, \\nu) = \\sum_{i=1}^{3} (c_i - \\lambda - \\mu_i + \\nu_i) g_i + \\lambda D - \\sum_{i=1}^{3} \\nu_i \\bar g_i $$\n\nThe KKT conditions for an optimal solution $(g^*, \\lambda^*, \\mu^*, \\nu^*)$ are:\n$1$. **Stationarity**: The gradient of the Lagrangian with respect to the primal variables $g_i$ must be zero. For each $i \\in \\{1, 2, 3\\}$:\n$$ \\frac{\\partial \\mathcal{L}}{\\partial g_i} = c_i - \\lambda^* - \\mu_i^* + \\nu_i^* = 0 $$\n\n$2$. **Complementary Slackness**: The product of each dual variable and its corresponding inequality constraint's slack must be zero.\n$$ \\lambda^* \\left( D - \\sum_{i=1}^{3} g_i^* \\right) = 0 $$\n$$ \\mu_i^* (-g_i^*) = 0 \\quad \\implies \\quad \\mu_i^* g_i^* = 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n$$ \\nu_i^* (g_i^* - \\bar g_i) = 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\n$3$. **Primal Feasibility**: The solution $g^*$ must satisfy the original constraints.\n$$ \\sum_{i=1}^{3} g_i^* \\ge D $$\n$$ 0 \\le g_i^* \\le \\bar g_i \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\n$4$. **Dual Feasibility**: The dual variables for inequality constraints must be non-negative.\n$$ \\lambda^* \\ge 0, \\quad \\mu_i^* \\ge 0, \\quad \\nu_i^* \\ge 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\nFrom the stationarity and complementary slackness conditions, we can derive the economic dispatch logic for each generator $i$:\n- If a generator is dispatched strictly between its bounds ($0  g_i^*  \\bar g_i$), then from complementary slackness, $g_i^*  0$ implies $\\mu_i^* = 0$ and $g_i^*  \\bar g_i$ implies $\\nu_i^* = 0$. The stationarity condition simplifies to $c_i - \\lambda^* = 0$, so $c_i = \\lambda^*$. This generator is the \"marginal\" unit setting the price.\n- If a generator is at its maximum capacity ($g_i^* = \\bar g_i$), then $g_i^*  0$ implies $\\mu_i^* = 0$. The stationarity condition is $c_i - \\lambda^* + \\nu_i^* = 0$, or $\\lambda^* = c_i + \\nu_i^*$. Since $\\nu_i^* \\ge 0$, this implies $\\lambda^* \\ge c_i$. This generator is \"inframarginal\".\n- If a generator is not dispatched ($g_i^* = 0$), then $g_i^*  \\bar g_i$ (assuming $\\bar g_i  0$) implies $\\nu_i^* = 0$. The stationarity condition is $c_i - \\lambda^* - \\mu_i^* = 0$, or $\\lambda^* = c_i - \\mu_i^*$. Since $\\mu_i^* \\ge 0$, this implies $\\lambda^* \\le c_i$. This generator is \"extramarginal\".\n\nNow we apply this logic to the provided data:\n- Costs: $c = (10, 20, 50)$ dollars per megawatt-hour.\n- Capacities: $\\bar g = (50, 30, 10)$ megawatts.\n- Demand: $D = 60$ megawatts.\n\nThe optimal dispatch follows a merit order, using the cheapest generators first.\n$1$. The cheapest generator is unit $1$ with cost $c_1 = \\$10/\\text{MWh}$ and capacity $\\bar g_1 = 50$ MW. Since the demand $D=60$ MW is greater than its capacity, we dispatch it at its maximum.\n$g_1^* = \\bar g_1 = 50$ MW.\nThe remaining demand is $D_{rem} = D - g_1^* = 60 - 50 = 10$ MW.\n\n$2$. The next cheapest generator is unit $2$ with cost $c_2 = \\$20/\\text{MWh}$ and capacity $\\bar g_2 = 30$ MW. The remaining demand is $10$ MW, which is less than its capacity. Thus, we dispatch unit $2$ to meet the remaining demand.\n$g_2^* = 10$ MW.\nThe remaining demand is now $D_{rem} - g_2^* = 10 - 10 = 0$ MW.\n\n$3$. The most expensive generator is unit $3$ with cost $c_3 = \\$50/\\text{MWh}$. Since the demand has been met, it is not dispatched.\n$g_3^* = 0$ MW.\n\nThe optimal dispatch is $g^* = (g_1^*, g_2^*, g_3^*) = (50, 10, 0)$.\nLet's check the constraints: $g_1^* + g_2^* + g_3^* = 50 + 10 + 0 = 60 = D$. The energy balance constraint is active.\n\nAccording to our derived KKT logic, the dual variable $\\lambda$ is set by the marginal unit, which is the last unit dispatched that is not operating at a limit. In this case, generator $2$ is dispatched at $g_2^*=10$ MW, which is within its bounds $0  10  30$. Therefore, generator $2$ is the marginal unit, and its cost must be equal to $\\lambda$.\n$$ \\lambda^* = c_2 = 20 $$\nThe units for $\\lambda$ are the same as for cost, dollars per megawatt-hour.\n\nLet's check for consistency:\n- For generator $1$: $g_1^* = \\bar g_1$. The condition is $c_1 \\le \\lambda^*$. We have $10 \\le 20$, which is true.\n- For generator $2$: $0  g_2^*  \\bar g_2$. The condition is $c_2 = \\lambda^*$. We have $20 = 20$, which is true.\n- For generator $3$: $g_3^* = 0$. The condition is $c_3 \\ge \\lambda^*$. We have $50 \\ge 20$, which is true.\nThe KKT conditions are all satisfied with $\\lambda^* = 20$.\n\nThe economic interpretation of the dual variable $\\lambda$ associated with a constraint is the marginal value of relaxing that constraint. In this context, $\\lambda$ represents the sensitivity of the minimum total cost to a small change in the total demand $D$. That is, $\\lambda^* = \\frac{dC^*(D)}{dD}$.\nA value of $\\lambda^*=20$ dollars per megawatt-hour signifies that to meet one additional megawatt of demand (i.e., increasing $D$ from $60$ to $61$ MW), the system would need to increase the output of the marginal generator, unit $2$. The cost of this additional energy would be $c_2 = 20$ dollars per megawatt-hour. Thus, the total system cost would increase by $20$ dollars for that hour. This value is also known as the system marginal price (SMP) or market clearing price for energy.",
            "answer": "$$\\boxed{20}$$"
        },
        {
            "introduction": "Building on the previous exercise, we now broaden our perspective to see how dual variables provide economic insights for any binding constraint, not just the system-wide energy balance. This practice focuses on generator capacity limits, illustrating how the dual variable on a binding limit quantifies its economic value as a \"scarcity rent\" . By calculating the dual variables for generator capacity constraints, you will determine the marginal value of that capacity—that is, how much the total system cost would decrease if the constrained generator could produce one more megawatt-hour.",
            "id": "4098486",
            "problem": "Consider a single-period economic dispatch problem over a duration of $1$ hour with two thermal generators. Let $g_1$ and $g_2$ denote the energy produced in the period by each unit, measured in $\\text{MWh}$. The total demand is $D$ $\\text{MWh}$, and each unit has an energy upper bound $\\bar g_i$ $\\text{MWh}$ arising from its power capacity multiplied by the period length. The marginal operating costs are constant and given by $c_1$ and $c_2$ in $\\$/\\text{MWh}$. The system operator minimizes total operating cost subject to meeting demand and respecting unit bounds. Use the following data: $c_1 = \\$20/\\text{MWh}$, $c_2 = \\$30/\\text{MWh}$, $\\bar g_1 = 40$ $\\text{MWh}$, $\\bar g_2 = 40$ $\\text{MWh}$, and $D = 70$ $\\text{MWh}$.\n\nStarting from the fundamentals of convex optimization and the Karush–Kuhn–Tucker (KKT) conditions, write the primal problem and derive the stationarity and complementary slackness conditions for the Lagrangian with dual variables $\\lambda$ for the demand-balance equality, $\\alpha_1$ and $\\alpha_2$ for the nonnegativity constraints $g_i \\ge 0$, and $\\mu_1$ and $\\mu_2$ for the capacity constraints $g_i \\le \\bar g_i$. Then, using these conditions, compute the numerical values of the dual variables $\\mu_1$ and $\\mu_2$ associated with the capacity constraints $g_1 \\le \\bar g_1$ and $g_2 \\le \\bar g_2$, respectively, and determine which capacity is scarce. Report the numerical values of $\\mu_1$ and $\\mu_2$ in $\\$/\\text{MWh}$.\n\nProvide exact values; no rounding is required. For the final answer, present the pair $\\mu_1$ and $\\mu_2$ as a single row matrix.",
            "solution": "The user has provided a valid problem statement. The problem is a standard economic dispatch formulation, which is a convex optimization problem (specifically, a linear program) and is therefore well-posed and scientifically grounded. All necessary data are provided, and there are no internal contradictions.\n\nThe problem is to minimize the total operating cost of two generators subject to meeting a specified demand and respecting the operational limits of the generators.\n\nFirst, we formulate the primal optimization problem. The decision variables are the energy generation levels $g_1$ and $g_2$ in $\\text{MWh}$. The objective function is the total cost, which we seek to minimize.\n$$\n\\min_{g_1, g_2} \\quad c_1 g_1 + c_2 g_2\n$$\nThe constraints are as follows:\n\\begin{enumerate}\n    \\item Demand-balance constraint (equality): The total generation must equal the total demand $D$.\n    $$g_1 + g_2 = D \\quad [\\lambda]$$\n    \\item Capacity constraints (inequality): Each generator's output cannot exceed its maximum capacity $\\bar g_i$.\n    $$g_1 \\le \\bar g_1 \\quad [\\mu_1]$$\n    $$g_2 \\le \\bar g_2 \\quad [\\mu_2]$$\n    \\item Non-negativity constraints (inequality): Generation cannot be negative.\n    $$g_1 \\ge 0 \\quad [\\alpha_1]$$\n    $$g_2 \\ge 0 \\quad [\\alpha_2]$$\n\\end{enumerate}\nHere, the symbols in brackets denote the Lagrange multipliers (dual variables) associated with each constraint.\n\nTo apply the Karush–Kuhn–Tucker (KKT) conditions, we first write the constraints in a standard form, $h(x) = 0$ and $g(x) \\le 0$:\n$$g_1 + g_2 - D = 0$$\n$$g_1 - \\bar g_1 \\le 0$$\n$$g_2 - \\bar g_2 \\le 0$$\n$$-g_1 \\le 0$$\n$$-g_2 \\le 0$$\n\nThe Lagrangian function $\\mathcal{L}$ for this problem is constructed by adding the constraints to the objective function, each multiplied by its respective dual variable:\n$$\n\\mathcal{L}(g_1, g_2, \\lambda, \\mu_1, \\mu_2, \\alpha_1, \\alpha_2) = c_1 g_1 + c_2 g_2 + \\lambda(g_1 + g_2 - D) + \\mu_1(g_1 - \\bar g_1) + \\mu_2(g_2 - \\bar g_2) + \\alpha_1(-g_1) + \\alpha_2(-g_2)\n$$\nThe KKT conditions for optimality are:\n\\begin{enumerate}\n    \\item **Stationarity**: The gradient of the Lagrangian with respect to the primal variables must be zero.\n    $$\\frac{\\partial \\mathcal{L}}{\\partial g_1} = c_1 + \\lambda + \\mu_1 - \\alpha_1 = 0$$\n    $$\\frac{\\partial \\mathcal{L}}{\\partial g_2} = c_2 + \\lambda + \\mu_2 - \\alpha_2 = 0$$\n    \\item **Primal Feasibility**: The primal variables must satisfy all original constraints.\n    $$g_1 + g_2 = D$$\n    $$g_1 \\le \\bar g_1, \\quad g_2 \\le \\bar g_2$$\n    $$g_1 \\ge 0, \\quad g_2 \\ge 0$$\n    \\item **Dual Feasibility**: The dual variables for inequality constraints must be non-negative.\n    $$\\mu_1 \\ge 0, \\quad \\mu_2 \\ge 0$$\n    $$\\alpha_1 \\ge 0, \\quad \\alpha_2 \\ge 0$$\n    The dual variable $\\lambda$ for the equality constraint is unrestricted in sign.\n    \\item **Complementary Slackness**: The product of an inequality-constraint dual variable and its corresponding slack must be zero.\n    $$\\mu_1(g_1 - \\bar g_1) = 0$$\n    $$\\mu_2(g_2 - \\bar g_2) = 0$$\n    $$\\alpha_1(-g_1) = 0 \\implies \\alpha_1 g_1 = 0$$\n    $$\\alpha_2(-g_2) = 0 \\implies \\alpha_2 g_2 = 0$$\n\\end{enumerate}\nWe now solve this system of equations using the given data: $c_1 = 20$, $c_2 = 30$, $\\bar g_1 = 40$, $\\bar g_2 = 40$, and $D = 70$.\n\nA rational operator would prioritize the generator with the lower marginal cost. Since $c_1  c_2$, generator $1$ is dispatched first. Its maximum output is $\\bar g_1 = 40$ $\\text{MWh}$. Let's assume we dispatch it at its maximum capacity.\nSo, we set $g_1 = 40$ $\\text{MWh}$.\n\nFrom the demand-balance constraint, we determine the required output from generator $2$:\n$$g_2 = D - g_1 = 70 - 40 = 30 \\text{ MWh}$$\n\nWe now check if this solution is primally feasible.\n\\begin{itemize}\n    \\item $g_1 = 40 \\le \\bar g_1 = 40$. This is satisfied and the constraint is active (binding).\n    \\item $g_2 = 30 \\le \\bar g_2 = 40$. This is satisfied and the constraint is inactive (non-binding).\n    \\item $g_1 = 40 \\ge 0$. This is satisfied and the constraint is inactive.\n    \\item $g_2 = 30 \\ge 0$. This is satisfied and the constraint is inactive.\n\\end{itemize}\nThe proposed solution, $g_1^*=40$ and $g_2^*=30$, is primally feasible. We now use the KKT conditions to find the dual variables and verify optimality.\n\nFrom complementary slackness:\n\\begin{itemize}\n    \\item Since $g_2^*  \\bar g_2$ ($30  40$), the slack is non-zero, thus its dual variable must be zero: $\\mu_2 = 0$.\n    \\item Since $g_1^*  0$ ($40  0$), the slack is non-zero, thus its dual variable must be zero: $\\alpha_1 = 0$.\n    \\item Since $g_2^*  0$ ($30  0$), the slack is non-zero, thus its dual variable must be zero: $\\alpha_2 = 0$.\n    \\item Since $g_1^* = \\bar g_1$ ($40 = 40$), the slack is zero, so $\\mu_1$ can be non-negative: $\\mu_1 \\ge 0$.\n\\end{itemize}\nSo far, we have $\\alpha_1=0$, $\\alpha_2=0$, and $\\mu_2=0$. We can now use the stationarity conditions to find $\\lambda$ and $\\mu_1$.\n\nThe stationarity condition for $g_2$ is:\n$$c_2 + \\lambda + \\mu_2 - \\alpha_2 = 0$$\nSubstituting the known values ($c_2 = 30$, $\\mu_2 = 0$, $\\alpha_2 = 0$):\n$$30 + \\lambda + 0 - 0 = 0 \\implies \\lambda = -30$$\nThe dual variable $\\lambda$ has units of $\\$/\\text{MWh}$. The system marginal price is $-\\lambda = \\$30/\\text{MWh}$, which is equal to the cost of the marginal generator, $c_2$.\n\nNow, we use the stationarity condition for $g_1$:\n$$c_1 + \\lambda + \\mu_1 - \\alpha_1 = 0$$\nSubstituting the known values ($c_1 = 20$, $\\lambda = -30$, $\\alpha_1 = 0$):\n$$20 + (-30) + \\mu_1 - 0 = 0$$\n$$-10 + \\mu_1 = 0 \\implies \\mu_1 = 10$$\nThis value satisfies the dual feasibility condition $\\mu_1 \\ge 0$. All KKT conditions are met.\n\nThe numerical values of the dual variables associated with the capacity constraints are therefore $\\mu_1 = \\$10/\\text{MWh}$ and $\\mu_2 = \\$0/\\text{MWh}$.\n\nThe non-zero value of $\\mu_1$ signifies that the capacity of generator $1$ is a scarce resource. It is a binding constraint on the optimization. The value $\\mu_1=\\$10/\\text{MWh}$ represents the shadow price of this capacity; if the capacity $\\bar g_1$ were increased by $1 \\ \\text{MWh}$, the total system cost would decrease by $\\$10$. This is because $1 \\ \\text{MWh}$ of generation could be shifted from generator $2$ (costing $\\$30/\\text{MWh}$) to generator $1$ (costing $\\$20/\\text{MWh}$), for a net saving of $c_2 - c_1 = 30 - 20 = \\$10$.\n\nThe value $\\mu_2=\\$0/\\text{MWh}$ indicates that the capacity of generator $2$ is not scarce. It is a non-binding constraint, and increasing its capacity would not change the optimal dispatch or reduce the total cost.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n10  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Our final practice delves into a more advanced scenario that demonstrates the power of dual variables to explain complex, and often counter-intuitive, market outcomes. We will investigate a system with inflexible \"must-run\" generation that forces an oversupply of energy, which must be curtailed at a cost. This exercise rigorously demonstrates how such operational constraints can logically lead to a negative Locational Marginal Price (LMP), reinforcing the universal interpretation of the dual variable as the marginal system cost to serve an additional increment of load .",
            "id": "4098509",
            "problem": "Consider a single-bus economic dispatch problem in steady state that is representative of a nodal pricing calculation. The bus has a fixed inelastic demand of $D = 90$ megawatts. There are two generators and one disposal option:\n- A must-run generator $M$ with output $g_{M}$ subject to a binding lower bound $g_{M} \\geq \\underline{g}_{M}$, where $\\underline{g}_{M} = 110$ megawatts. Its marginal production cost is $c_{M} = 0$ currency units per megawatt-hour (CU/MWh).\n- A flexible generator $F$ with output $g_{F} \\geq 0$ and marginal production cost $c_{F} = 40$ CU/MWh. Capacity upper bounds are sufficiently large to be nonbinding.\n- A nonphysical dissipation option, modeled as a decision variable $w \\geq 0$, that represents dumping or forced curtailment at a marginal penalty cost $c_{w} = 9.7$ CU/MWh whenever supply exceeds demand.\n\nFormulate the primal optimization as minimizing total operating cost subject to energy balance and bounds, where the single-bus energy balance is written as\n$$\nD - g_{M} - g_{F} + w = 0,\n$$\nand let $\\lambda$ denote the Lagrange multiplier associated with this equality. The Locational Marginal Price (LMP) at the bus is defined as the shadow value of energy at the bus, equal to the optimal multiplier $\\lambda$ under this sign convention. Use first principles from convex optimization (Karush–Kuhn–Tucker optimality conditions) to argue the sign restrictions on the dual variables and show rigorously how a negative LMP can arise from a binding lower bound and the presence of $w$ with positive marginal penalty.\n\nCompute the numerical value of the LMP at the bus for the given data. Round your answer to $4$ significant figures. Express the final price in CU/MWh.",
            "solution": "The problem asks for the Locational Marginal Price (LMP) at a single bus, defined as the optimal Lagrange multiplier $\\lambda$ associated with the energy balance constraint. We will first validate the problem, then formulate it as a convex optimization problem, and finally solve it using the Karush-Kuhn-Tucker (KKT) conditions.\n\nThe problem is valid. It describes a standard economic dispatch scenario, a well-posed linear programming problem in energy systems engineering. The data provided ($D=90$ MW, $\\underline{g}_M = 110$ MW, $c_M=0$ CU/MWh, $c_F=40$ CU/MWh, $c_w=9.7$ CU/MWh) are self-consistent and realistic for illustrating the economic phenomenon of negative prices due to inflexible generation. The problem is scientifically grounded, objective, and contains sufficient information for a unique solution.\n\nThe primal optimization problem is to minimize the total system operating cost, which is the sum of production and penalty costs.\nThe objective function to minimize is:\n$$\nC(g_M, g_F, w) = c_M g_M + c_F g_F + c_w w\n$$\nThe decision variables are the generator outputs $g_M$ and $g_F$, and the disposal amount $w$. The optimization is subject to several constraints:\n\n1.  Energy balance: $D - g_M - g_F + w = 0$\n2.  Generator $M$ lower bound: $g_M \\geq \\underline{g}_M$\n3.  Generator $F$ lower bound: $g_F \\geq 0$\n4.  Disposal lower bound: $w \\geq 0$\n\nTo apply the KKT conditions, we write the inequality constraints in the standard form $h(x) \\leq 0$:\n1. Energy balance: $D - g_M - g_F + w = 0 \\quad (\\lambda)$\n2. Generator $M$ bound: $\\underline{g}_M - g_M \\leq 0 \\quad (\\mu_M)$\n3. Generator $F$ bound: $-g_F \\leq 0 \\quad (\\mu_F)$\n4. Disposal bound: $-w \\leq 0 \\quad (\\mu_w)$\n\nHere, $\\lambda$ is the Lagrange multiplier for the equality constraint, and $\\mu_M, \\mu_F, \\mu_w$ are the KKT multipliers for the inequality constraints.\n\nThe Lagrangian function $\\mathcal{L}$ for this problem is:\n$$\n\\mathcal{L}(g_M, g_F, w, \\lambda, \\mu_M, \\mu_F, \\mu_w) = (c_M g_M + c_F g_F + c_w w) + \\lambda(D - g_M - g_F + w) + \\mu_M(\\underline{g}_M - g_M) + \\mu_F(-g_F) + \\mu_w(-w)\n$$\n\nThe first-order KKT conditions for optimality are:\n\n(a) **Stationarity** (gradient of $\\mathcal{L}$ with respect to primal variables is zero at the optimum):\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial g_M} = c_M - \\lambda - \\mu_M = 0 \\implies c_M - \\lambda = \\mu_M\n$$\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial g_F} = c_F - \\lambda - \\mu_F = 0 \\implies c_F - \\lambda = \\mu_F\n$$\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial w} = c_w + \\lambda - \\mu_w = 0 \\implies c_w + \\lambda = \\mu_w\n$$\n\n(b) **Primal Feasibility**: The optimal solution $(g_M^*, g_F^*, w^*)$ must satisfy the original constraints.\n\n(c) **Dual Feasibility**: The KKT multipliers for inequality constraints must be non-negative: $\\mu_M \\geq 0$, $\\mu_F \\geq 0$, $\\mu_w \\geq 0$.\n\n(d) **Complementary Slackness**: For each inequality constraint, the product of the multiplier and the constraint function must be zero at the optimum:\n$$\n\\mu_M(\\underline{g}_M - g_M^*) = 0\n$$\n$$\n\\mu_F(-g_F^*) = 0 \\implies \\mu_F g_F^* = 0\n$$\n$$\n\\mu_w(-w^*) = 0 \\implies \\mu_w w^* = 0\n$$\n\nWe now solve this system using the provided data: $D=90$, $\\underline{g}_M=110$, $c_M=0$, $c_F=40$, $c_w=9.7$.\n\nThe problem states that the lower bound on generator $M$ is binding. This implies $g_M^* = \\underline{g}_M = 110$.\nWith $g_M^* = 110$, the energy balance requires $90 - 110 - g_F^* + w^* = 0$, which simplifies to $w^* = g_F^* + 20$.\n\nTo minimize cost, the system should avoid dispatching the expensive flexible generator $F$ (cost $c_F = 40$) if possible. The must-run generator $M$ already produces a surplus of $110 - 90 = 20$ MW. This surplus must be either consumed by generator $F$ (which is nonsensical) or disposed of via $w$. There is no economic reason to produce additional power from generator $F$ at a cost of $40$ CU/MWh just to dispose of it at a further cost of $9.7$ CU/MWh. Thus, the optimal output for the flexible generator must be zero: $g_F^* = 0$.\n\nLet's rigorously confirm $g_F^*=0$. Assume for contradiction that $g_F^*0$. By complementary slackness ($\\mu_F g_F^* = 0$), we must have $\\mu_F=0$. The stationarity condition for $g_F$ then implies $c_F - \\lambda = 0$, so $\\lambda = c_F = 40$. The stationarity condition for $w$ is $c_w + \\lambda = \\mu_w$, which gives $\\mu_w = 9.7 + 40 = 49.7$. Since $\\mu_w0$, complementary slackness ($\\mu_w w^*=0$) requires $w^*=0$. Substituting $g_F^*0$ and $w^*=0$ into the energy balance relation $w^* = g_F^* + 20$ yields $0 = g_F^* + 20$, or $g_F^* = -20$. This contradicts the primal feasibility constraint $g_F \\geq 0$. Therefore, the assumption $g_F^*0$ is false, and it must be that $g_F^*=0$.\n\nWith $g_F^*=0$, the energy balance $w^* = g_F^* + 20$ yields $w^* = 20$.\nThe optimal primal variables are: $g_M^*=110$, $g_F^*=0$, $w^*=20$. This solution is primally feasible as $g_M^* \\ge 110$, $g_F^* \\ge 0$, and $w^* \\ge 0$.\n\nNow we determine the LMP, $\\lambda$. Since $w^* = 20  0$, the constraint $-w \\leq 0$ is not binding. Complementary slackness ($\\mu_w w^* = 0$) implies that its multiplier must be zero: $\\mu_w = 0$.\nUsing the stationarity condition for $w$:\n$$\nc_w + \\lambda = \\mu_w\n$$\n$$\n9.7 + \\lambda = 0\n$$\n$$\n\\lambda = -9.7\n$$\nThe LMP at the bus is therefore $-9.7$ CU/MWh.\n\nThe negative price arises because the binding lower operational limit of the must-run generator forces an oversupply of energy ($110$ MW of supply versus $90$ MW of demand). To maintain balance, this surplus of $20$ MW must be disposed of at a cost of $c_w = 9.7$ CU/MWh. An incremental increase in demand would reduce the amount of energy that needs to be disposed, thus saving the system money. The value of an additional megawatt-hour of demand is therefore the negative of this disposal cost, leading to $\\lambda = -c_w$.\n\nWe can verify the remaining KKT conditions for completeness.\nFor $g_F$, with $\\lambda = -9.7$:\n$\\mu_F = c_F - \\lambda = 40 - (-9.7) = 49.7$. Since $\\mu_F0$ and $g_F^*=0$, dual feasibility and complementary slackness hold.\n\nFor $g_M$, with $\\lambda = -9.7$:\n$\\mu_M = c_M - \\lambda = 0 - (-9.7) = 9.7$. Since $\\mu_M0$ and $g_M^* = \\underline{g}_M$, dual feasibility and complementary slackness hold.\n\nAll KKT conditions are satisfied, confirming the optimality of the solution. The problem requires the answer to be rounded to $4$ significant figures.",
            "answer": "$$\\boxed{-9.700}$$"
        }
    ]
}