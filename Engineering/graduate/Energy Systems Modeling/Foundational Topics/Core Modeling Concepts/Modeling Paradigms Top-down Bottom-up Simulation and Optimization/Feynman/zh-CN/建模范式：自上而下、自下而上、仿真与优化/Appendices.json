{
    "hands_on_practices": [
        {
            "introduction": "要构建宏观经济模型，我们首先需要一个全面且一致的经济快照。社会核算矩阵（SAM）正是这样一个关键工具，它为自上而下的可计算一般均衡（CGE）模型提供了基础数据。这个练习将带你亲手实践如何从投入产出表和国民账户等零散数据中，通过遵循基础会计恒等式，构建一个逻辑严谨的社会核算矩阵。完成这项任务能让你深刻理解，确保模型基准年均衡与真实世界数据保持一致所需遵循的基本原则。",
            "id": "4106006",
            "problem": "一个以能源为导向的社会核算矩阵 (SAM) 是一个记录账户之间所有交易的方阵，对于每个账户，总流入等于总流出。在自上而下的可计算一般均衡 (CGE) 模型中，SAM 提供了模拟和优化包含能源部门的政策情景所需的、与均衡状态一致的宏观经济数据图景。其关键的会计恒等式是：对于每个账户，收入总和等于支出总和，任何差额都记录为流入或流出资本账户的储蓄或赤字。\n\n考虑一个经济体，有五个生产活动：电力 ($E$)、制造业 ($M$)、服务业 ($S$)、运输业 ($T$) 和农业 ($A$)；以及四个机构账户：家庭 ($H$)、政府 ($G$)、世界其他地区 ($R$) 和资本 ($K$)。所有流量均以十亿本国货币单位报告。根据投入产出 (IO) 表和国民账户，您将获得以下数据：\n\n- 产业间交易 $T_{ij}$，其中 $i$ 是销售活动，$j$ 是购买活动：\n  - 来自 $E$：$T_{EE}=5$， $T_{EM}=10$， $T_{ES}=2$， $T_{ET}=4$， $T_{EA}=1$。\n  - 来自 $M$：$T_{ME}=3$， $T_{MM}=8$， $T_{MS}=5$， $T_{MT}=6$， $T_{MA}=4$。\n  - 来自 $S$：$T_{SE}=2$， $T_{SM}=7$， $T_{SS}=9$， $T_{ST}=5$， $T_{SA}=3$。\n  - 来自 $T$：$T_{TE}=1$， $T_{TM}=4$， $T_{TS}=3$， $T_{TT}=6$， $T_{TA}=2$。\n  - 来自 $A$：$T_{AE}=0.5$， $T_{AM}=3$， $T_{AS}=2$， $T_{AT}=1$， $T_{AA}=7$。\n- 按活动划分的家庭最终消费 $c_{i}$：$c_{E}=12$，$c_{M}=25$，$c_{S}=40$，$c_{T}=18$，$c_{A}=15$。\n- 按活动划分的政府最终消费 $g_{i}$ (以基本价格计量，即不包括产品税)：$g_{E}=5$，$g_{M}=7$，$g_{S}=12$，$g_{T}=10$，$g_{A}=6$。\n- 按活动划分的出口 $x_{i}$：$x_{E}=8$，$x_{M}=20$，$x_{S}=10$，$x_{T}=6$，$x_{A}=12$。\n- 按商品划分的进口 $m_{i}$：$m_{E}=5$，$m_{M}=18$，$m_{S}=12$，$m_{T}=9$，$m_{A}=7$。\n- 对总产出的从价产品税率 $\\tau^{p}_{i}$：$\\tau^{p}_{E}=0.05$，$\\tau^{p}_{M}=0.10$，$\\tau^{p}_{S}=0.08$，$\\tau^{p}_{T}=0.06$，$\\tau^{p}_{A}=0.04$。\n- 对家庭消费的从价消费税率 $\\tau^{c}_{i}$：$\\tau^{c}_{E}=0.02$，$\\tau^{c}_{M}=0.04$，$\\tau^{c}_{S}=0.03$，$\\tau^{c}_{T}=0.05$，$\\tau^{c}_{A}=0.01$。\n- 对进口的从价关税税率 $\\tau^{m}_{i}$：$\\tau^{m}_{E}=0.03$，$\\tau^{m}_{M}=0.05$，$\\tau^{m}_{S}=0.02$，$\\tau^{m}_{T}=0.04$，$\\tau^{m}_{A}=0.03$。\n- 各活动向家庭支付的工资 $w_{i}$：$w_{E}=18$，$w_{M}=35$，$w_{S}=38$，$w_{T}=21$，$w_{A}=18$。\n- 对工资收入的家庭所得税率 $\\tau^{y}=0.15$。\n- 政府对家庭的转移支付 $tr^{G\\to H}=8$。\n- 政府利息支付 $r^{G}=2$。\n\n通过将投入产出数据映射到社会核算矩阵的组成部分，从第一性原理构建与社会核算矩阵一致的政府账户，具体如下：\n\n1. 使用活动 $i$ 的总销售额等于产业间销售额加家庭消费加政府消费加出口这一恒等式，从投入产出流量和最终需求中推断出每个活动的总国内产出 $Y_{i}$。\n2. 使用社会核算矩阵的恒等式，即税收流被记录为从相应税基到政府账户的支付，计算政府从总产出产品税、家庭消费消费税、进口关税以及工资的家庭所得税中获得的税收收入。\n3. 使用社会核算矩阵的恒等式，即政府支出被记录为从政府账户到其他账户的支付，计算政府总支出，即政府最终消费（以基本价格计）、对家庭的转移支付和利息支付的总和。\n4. 对政府账户强制执行复式记账恒等式，即残余流量，政府储蓄 $S_{G}$（如果为正，则为从 $G$ 到 $K$ 的支付；如果为负，则为从 $K$ 到 $G$ 的流入），使账户平衡，从而总流入等于总流出。\n\n计算上述数据和恒等式所隐含的 $S_{G}$ 的唯一标量值。最终答案以十亿本国货币单位表示。无需四舍五入；报告精确值。",
            "solution": "该问题是有效的，因为它科学地基于社会核算矩阵 (SAM) 的原理，问题设定清晰，数据和恒等式完整，并以客观、正式的语言表述。任务是通过所提供的投入产出和国民账户数据构建政府账户，从而计算政府储蓄 $S_G$。这涉及到问题陈述中概述的四个步骤。\n\n政府账户与 SAM 中的所有账户一样，必须平衡。这意味着总流入（收入）必须等于总流出（支付）。政府账户的平衡项是政府储蓄 $S_G$。基本恒等式是：\n$$\n\\text{Total Government Revenue} = \\text{Total Government Expenditures} + S_G\n$$\n因此，政府储蓄是差额：\n$$\nS_G = \\text{Total Government Revenue} - \\text{Total Government Expenditures}\n$$\n$S_G$ 的正值代表政府盈余（从政府账户 $G$ 到资本账户 $K$ 的支付），而负值代表赤字（从 $K$ 到 $G$ 的流入）。\n\n我们将根据所提供的数据计算政府总收入和政府总支出。\n\n**步骤 1：计算每个活动的总国内产出 ($Y_i$)**\n\n一个活动 $i$ 的总国内产出，记为 $Y_i$，是其销售的总价值。这是其对其他产业的销售额（中间消耗）、对家庭的销售额（最终消费）、对政府的销售额（最终消费）以及对世界其他地区的销售额（出口）的总和。公式如下：\n$$\nY_i = \\sum_{j \\in \\{E,M,S,T,A\\}} T_{ij} + c_i + g_i + x_i\n$$\n其中 $T_{ij}$ 代表从活动 $i$ 到活动 $j$ 的销售额，$c_i$ 是家庭对产品 $i$ 的消费，$g_i$ 是政府对产品 $i$ 的消费，$x_i$ 是产品 $i$ 的出口。\n\n对于电力 ($E$)：\n$Y_E = T_{EE} + T_{EM} + T_{ES} + T_{ET} + T_{EA} + c_E + g_E + x_E = 5 + 10 + 2 + 4 + 1 + 12 + 5 + 8 = 47$\n\n对于制造业 ($M$)：\n$Y_M = T_{ME} + T_{MM} + T_{MS} + T_{MT} + T_{MA} + c_M + g_M + x_M = 3 + 8 + 5 + 6 + 4 + 25 + 7 + 20 = 78$\n\n对于服务业 ($S$)：\n$Y_S = T_{SE} + T_{SM} + T_{SS} + T_{ST} + T_{SA} + c_S + g_S + x_S = 2 + 7 + 9 + 5 + 3 + 40 + 12 + 10 = 88$\n\n对于运输业 ($T$)：\n$Y_T = T_{TE} + T_{TM} + T_{TS} + T_{TT} + T_{TA} + c_T + g_T + x_T = 1 + 4 + 3 + 6 + 2 + 18 + 10 + 6 = 50$\n\n对于农业 ($A$)：\n$Y_A = T_{AE} + T_{AM} + T_{AS} + T_{AT} + T_{AA} + c_A + g_A + x_A = 0.5 + 3 + 2 + 1 + 7 + 15 + 6 + 12 = 46.5$\n\n总产出为：$Y_E=47$，$Y_M=78$，$Y_S=88$，$Y_T=50$ 和 $Y_A=46.5$。\n\n**步骤 2：计算政府总收入 ($R_G$)**\n\n政府收入由四种税收组成：\n1.  **产品税收入 ($R_p$)**: 这是对每个活动的总产出征收的税款总和。\n    $$R_p = \\sum_{i} \\tau^{p}_{i} Y_i$$\n    $R_p = (0.05)(47) + (0.10)(78) + (0.08)(88) + (0.06)(50) + (0.04)(46.5)$\n    $R_p = 2.35 + 7.8 + 7.04 + 3.0 + 1.86 = 22.05$\n\n2.  **消费税收入 ($R_c$)**: 这是对家庭消费征收的税款总和。\n    $$R_c = \\sum_{i} \\tau^{c}_{i} c_i$$\n    $R_c = (0.02)(12) + (0.04)(25) + (0.03)(40) + (0.05)(18) + (0.01)(15)$\n    $R_c = 0.24 + 1.0 + 1.2 + 0.9 + 0.15 = 3.49$\n\n3.  **关税收入 ($R_m$)**: 这是对进口征收的税款总和。\n    $$R_m = \\sum_{i} \\tau^{m}_{i} m_i$$\n    $R_m = (0.03)(5) + (0.05)(18) + (0.02)(12) + (0.04)(9) + (0.03)(7)$\n    $R_m = 0.15 + 0.9 + 0.24 + 0.36 + 0.21 = 1.86$\n\n4.  **家庭所得税收入 ($R_y$)**: 这是对各活动支付给家庭的总工资收入征收的税款。\n    首先，我们计算总工资收入 $W$：\n    $W = \\sum_{i} w_i = 18 + 35 + 38 + 21 + 18 = 130$\n    然后，我们应用所得税率 $\\tau^y$：\n    $R_y = \\tau^y \\times W = 0.15 \\times 130 = 19.5$\n\n政府总收入 $R_G$ 是这些组成部分的总和：\n$$R_G = R_p + R_c + R_m + R_y$$\n$$R_G = 22.05 + 3.49 + 1.86 + 19.5 = 46.9$$\n\n**步骤 3：计算政府总支出 ($E_G$)**\n\n政府支出包括政府最终消费、对家庭的转移支付和利息支付。\n1.  **政府最终消费 ($G_c$)**: 这是政府从所有活动中购买的总和。\n    $$G_c = \\sum_i g_i$$\n    $G_c = 5 + 7 + 12 + 10 + 6 = 40$\n\n2.  **对家庭的转移支付 ($Tr_{GH}$)**：\n    $Tr_{GH} = tr^{G\\to H} = 8$\n\n3.  **利息支付 ($Int_G$)**：\n    $Int_G = r^G = 2$\n\n政府总支出 $E_G$ 是这些支出的总和：\n$$E_G = G_c + Tr_{GH} + Int_G$$\n$$E_G = 40 + 8 + 2 = 50$$\n\n**步骤 4：计算政府储蓄 ($S_G$)**\n\n最后，我们通过从总收入中减去总支出，来计算政府储蓄：\n$$S_G = R_G - E_G$$\n$$S_G = 46.9 - 50 = -3.1$$\n\n政府储蓄 $S_G$ 的最终结果是 -3.1 十亿本国货币单位。负号表示政府赤字，在 SAM 中记录为从资本账户到政府账户的支付。",
            "answer": "$$\\boxed{-3.1}$$"
        },
        {
            "introduction": "与宏观的自上而下视角不同，自下而上模型通常聚焦于具体技术。准确预测能源技术的成本演变是能源系统规划的核心。这个练习将视角转向技术层面，指导你如何使用历史部署数据来校准一个经验曲线模型——这是一种用于预测未来技术成本的常用仿真工具。通过这个实践，你不仅能掌握如何通过对数线性回归来估计学习率，还能学会如何量化这些预测中的不确定性，这对于做出稳健的决策至关重要。",
            "id": "4105975",
            "problem": "考虑一种能源技术，其单位成本通过基于经验规律的幂律经验曲线依赖于累积部署量。假设以下基础模型：对于以吉瓦 (GW) 为单位的累积部署量 $Q$ 和以美元/千瓦 ($/kW$) 为单位的单位成本 $C(Q)$，成本遵循 $C(Q) = C_0 Q^{-\\beta}$，其中 $C_0 \\gt 0$ 为常数，$\\beta \\gt 0$ 为学习指数。假设对数以自然为底，且对数残差是独立同分布的高斯随机变量，该模型可表示为 $\\ln C = \\alpha - \\beta \\ln Q + \\varepsilon$，其中 $\\alpha = \\ln C_0$ 且 $\\varepsilon \\sim \\mathcal{N}(0,\\sigma^2)$。\n\n为您提供了以有序对 $(Q_t, C_t)$ 形式出现的历史上观察到的自下而上数据，$Q_t$ 的单位是吉瓦 (GW)，$C_t$ 的单位是美元/千瓦 ($/kW$)：\n$(5,2200)$, $(10,2000)$, $(20,1800)$, $(35,1600)$, $(55,1400)$, $(80,1250)$, $(105,1150)$, $(130,1075)$。\n\n您的任务是：\n- 在所述高斯误差假设下，通过对数线性回归校准学习指数 $\\beta$ 和截距 $\\alpha$。\n- 使用校准后的模型和基于统计学原理的不确定性量化方法，为源自不同建模范式的三个累积部署情景生成未来成本的预测分布：\n    1. 自上而下的宏观经济预测，$Q_{\\mathrm{TD}} = 200$ GW。\n    2. 自下而上的优化计划输出，$Q_{\\mathrm{OPT}} = 130$ GW。\n    3. 基于模拟的采纳轨迹，$Q_{\\mathrm{SIM}} = 600$ GW。\n- 对于每个情景 $Q_\\star \\in \\{Q_{\\mathrm{TD}}, Q_{\\mathrm{OPT}}, Q_{\\mathrm{SIM}}\\}$，输出预测的单位成本中位数和一个双侧 $(1-\\alpha)$ 预测区间（其中 $\\alpha = 0.05$），均在原始成本尺度上以 $/kW$ 为单位。假设预测区间是在对数空间中为新观测值（而不仅仅是平均响应）计算的，然后映射回原始成本空间。\n\n将三个情景的结果表示为包含三个浮点数的列表 $[m_\\star, \\ell_\\star, u_\\star]$，其中 $m_\\star$ 是预测的成本中位数，$\\ell_\\star$ 是双侧 $(1-\\alpha)$ 预测区间的下界， $u_\\star$ 是上界，所有单位均为 $/kW$。最终的程序输出应为单行，包含由方括号括起来的这三个列表的逗号分隔列表，无空格，格式完全如下：\n$[[m_{\\mathrm{TD}},\\ell_{\\mathrm{TD}},u_{\\mathrm{TD}}],[m_{\\mathrm{OPT}},\\ell_{\\mathrm{OPT}},u_{\\mathrm{OPT}}],[m_{\\mathrm{SIM}},\\ell_{\\mathrm{SIM}},u_{\\mathrm{SIM}}]]$。\n\n测试套件和覆盖要求：\n- 使用指定的历史数据集和三个情景的累积部署量 $Q_{\\mathrm{TD}} = 200$ GW，$Q_{\\mathrm{OPT}} = 130$ GW，和 $Q_{\\mathrm{SIM}} = 600$ GW。\n- 这些情景共同测试了一个一般情况 ($Q_{\\mathrm{TD}}$)，一个位于最新观测部署量的边界情况 ($Q_{\\mathrm{OPT}}$)，以及一个远距离外推的边缘情况 ($Q_{\\mathrm{SIM}}$)。\n- 您的程序必须按规定生成单行输出，其中包含三个浮点数列表（每个列表对应一个情景），单位为 $/kW$。",
            "solution": "该问题是有效的，因为它在科学上基于成熟的技术经验曲线理论，在数学上是良态的且有足够的数据，并且其表述是客观的。它需要对对数线性回归和统计预测进行标准而严谨的应用。我现在开始进行解答。\n\n该问题要求我们对某能源技术的累积部署量 $Q$ 与单位成本 $C$ 之间的关系进行建模。所提出的模型是一个幂律：\n$$C(Q) = C_0 Q^{-\\beta}$$\n其中 $C_0$ 是初始成本，$\\beta$ 是学习指数。\n\n为了从所提供的数据中估计参数 $C_0$ 和 $\\beta$，我们通过对等式两边取自然对数来线性化模型：\n$$\\ln(C) = \\ln(C_0 Q^{-\\beta}) = \\ln(C_0) + \\ln(Q^{-\\beta}) = \\ln(C_0) - \\beta \\ln(Q)$$\n问题陈述以 $\\ln C = \\alpha - \\beta \\ln Q + \\varepsilon$ 的形式给出了这一点，其中 $\\alpha = \\ln C_0$ 且 $\\varepsilon$ 是一个均值为 $0$、方差为 $\\sigma^2$ 的正态分布误差项，即 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n通过设定以下变量，该方程可变为简单线性回归模型 $y = \\beta_0 + \\beta_1 x + \\varepsilon$ 的形式：\n$y = \\ln C$\n$x = \\ln Q$\n$\\beta_0 = \\alpha$\n$\\beta_1 = -\\beta$\n\n我们的第一步是将给定的历史数据 $(Q_t, C_t)$ 转换为对数坐标 $(x_t, y_t) = (\\ln Q_t, \\ln C_t)$，然后执行普通最小二乘法 (OLS) 回归，以找到最佳拟合估计值 $\\hat{\\beta}_0$ 和 $\\hat{\\beta}_1$。由此，我们可以得到原始模型参数的估计值：$\\hat{\\alpha} = \\hat{\\beta}_0$ 和 $\\hat{\\beta} = -\\hat{\\beta}_1$。\n\n提供的历史数据包含 $n=8$ 个数据对：\n$Q = [5, 10, 20, 35, 55, 80, 105, 130]$ GW\n$C = [2200, 2000, 1800, 1600, 1400, 1250, 1150, 1075]$ $/kW\n\n第二步是使用校准后的模型对三个未来的部署情景进行预测：$Q_\\star \\in \\{200, 130, 600\\}$ GW。对于每个 $Q_\\star$，我们必须计算：\n1.  预测的成本中位数，$m_\\star$。\n2.  一个双侧 $95\\%$ 预测区间，$[\\ell_\\star, u_\\star]$。\n\n预测首先在对数空间中进行。对于一个新的部署量 $Q_\\star$，我们计算其对数 $x_\\star = \\ln Q_\\star$。对数成本的预测值为：\n$$\\hat{y}_\\star = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_\\star$$\n由于误差 $\\varepsilon$ 是正态分布的，对数成本 $y = \\ln C$ 也是正态分布的。这意味着成本 $C = \\exp(y)$ 服从对数正态分布。该对数正态分布的中位数是 $\\exp(\\mathbb{E}[y])$。我们在 $x_\\star$ 处对 $\\mathbb{E}[y]$ 的最佳估计是 $\\hat{y}_\\star$。因此，预测的成本中位数为：\n$$m_\\star = \\exp(\\hat{y}_\\star)$$\n\n为了计算预测区间，我们必须考虑模型参数的不确定性和新观测值的内在变异性。在点 $x_\\star$ 处，一个新观测值 $y_{\\text{new}}$ 的 $(1-\\alpha)$ 预测区间由以下公式给出：\n$$\\hat{y}_\\star \\pm t_{n-2, \\alpha/2} \\cdot s_e \\sqrt{1 + \\frac{1}{n} + \\frac{(x_\\star - \\bar{x})^2}{\\sum_{i=1}^n (x_i - \\bar{x})^2}}$$\n其中：\n-   $n=8$ 是数据点的数量。\n-   $t_{n-2, \\alpha/2}$ 是自由度为 $n-2=6$ 的t分布的临界值。对于 $95\\%$ 的区间，$\\alpha=0.05$，因此我们需要 $1 - 0.05/2 = 0.975$ 百分位数处的值。\n-   $s_e$ 是回归的标准误差（也称为残差标准误），计算公式为 $s_e = \\sqrt{\\frac{\\sum(y_i - \\hat{y}_i)^2}{n-2}}$。\n-   $\\bar{x}$ 是观测到的对数部署量 $x_i$ 的均值。\n-   $\\sum(x_i - \\bar{x})^2$ 是观测值 $x_i$ 的离差平方和。\n\n令误差幅度（上述公式中的第二项）表示为 $ME$。对数空间中的预测区间为 $[\\hat{y}_\\star - ME, \\hat{y}_\\star + ME]$。\n为了获得原始成本尺度上的区间，我们对边界进行指数化：\n$$\\ell_\\star = \\exp(\\hat{y}_\\star - ME)$$\n$$u_\\star = \\exp(\\hat{y}_\\star + ME)$$\n\n将对三个情景 $Q_{\\mathrm{TD}} = 200$、$Q_{\\mathrm{OPT}} = 130$ 和 $Q_{\\mathrm{SIM}} = 600$ 中的每一个执行这些计算，并按要求格式化结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress, t\n\ndef solve():\n    \"\"\"\n    Calibrates a power-law experience curve model using log-linear regression\n    and computes prediction intervals for future costs based on three deployment scenarios.\n    \"\"\"\n    # Step 1: Define historical data and scenario parameters\n    # Historical data: (Cumulative Deployment in GW, Unit Cost in $/kW)\n    data = np.array([\n        (5, 2200),\n        (10, 2000),\n        (20, 1800),\n        (35, 1600),\n        (55, 1400),\n        (80, 1250),\n        (105, 1150),\n        (130, 1075)\n    ])\n    \n    # Scenarios for prediction (Cumulative Deployment in GW)\n    q_scenarios = [200.0, 130.0, 600.0]  # TD, OPT, SIM\n\n    # Model: C = C_0 * Q^-beta\n    # Log-linear form: ln(C) = ln(C_0) - beta * ln(Q) => y = beta_0 + beta_1 * x\n    # where y = ln(C), x = ln(Q), beta_0 = ln(C_0), beta_1 = -beta\n\n    q_obs = data[:, 0]\n    c_obs = data[:, 1]\n    \n    # Transform data to log-space\n    x_obs = np.log(q_obs) # ln(Q)\n    y_obs = np.log(c_obs) # ln(C)\n    \n    # Step 2: Perform log-linear regression\n    # The `linregress` function from scipy provides all necessary OLS results.\n    # slope = beta_1, intercept = beta_0\n    slope, intercept, _, _, std_err_slope = linregress(x_obs, y_obs)\n    \n    # Step 3: Calculate parameters for prediction interval\n    n = len(x_obs)\n    df = n - 2  # Degrees of freedom for t-distribution\n    alpha_ci = 0.05 # Significance level for a 95% prediction interval\n    \n    # Critical t-value for a two-sided interval\n    t_crit = t.ppf(1 - alpha_ci / 2, df)\n    \n    # Mean and sum of squared deviations of the predictor variable\n    x_mean = np.mean(x_obs)\n    s_xx = np.sum((x_obs - x_mean)**2)\n    \n    # Standard error of the regression estimate (s_e)\n    # This can be derived from the standard error of the slope:\n    # std_err_slope = s_e / sqrt(S_xx) => s_e = std_err_slope * sqrt(S_xx)\n    s_e = std_err_slope * np.sqrt(s_xx)\n    \n    # Step 4: Calculate predictions and intervals for each scenario\n    results = []\n    for q_star in q_scenarios:\n        # Transform scenario deployment to log-space\n        x_star = np.log(q_star)\n        \n        # Predict the log-cost\n        y_hat_star = intercept + slope * x_star\n        \n        # Calculate the median cost by transforming back to original scale\n        # For a log-normal distribution, median = exp(mean of log-distribution)\n        median_cost = np.exp(y_hat_star)\n        \n        # Calculate the margin of error for the prediction interval in log-space\n        # The term under the square root accounts for uncertainty in the mean response\n        # plus the variability of a single future observation.\n        pred_err_term = np.sqrt(1 + (1 / n) + ((x_star - x_mean)**2 / s_xx))\n        margin_of_error_log = t_crit * s_e * pred_err_term\n        \n        # Determine the prediction interval bounds in log-space\n        log_lower_bound = y_hat_star - margin_of_error_log\n        log_upper_bound = y_hat_star + margin_of_error_log\n        \n        # Transform bounds back to the original cost scale\n        lower_bound = np.exp(log_lower_bound)\n        upper_bound = np.exp(log_upper_bound)\n        \n        results.append([median_cost, lower_bound, upper_bound])\n\n    # Step 5: Format the final output string\n    # E.g., [[m1,l1,u1],[m2,l2,u2],[m3,l3,u3]]\n    result_str_parts = []\n    for res in results:\n        # Format each scenario's result list\n        part = f\"[{res[0]},{res[1]},{res[2]}]\"\n        result_str_parts.append(part)\n        \n    final_output = f\"[{','.join(result_str_parts)}]\"\n\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "自下而上的优化模型是做出具体运营决策的强大工具，但其有效性高度依赖于模型构建的精确性。本练习深入探讨了混合整数线性规划（MILP）中一个常见且关键的建模技巧——“大M方法”（big-M method）。通过一个简化的机组组合（Unit Commitment）问题，你将分析为何选择一个过于宽松的 $M$ 值会削弱模型的求解效率，并亲手推导出一个“紧凑”的 $M$ 值。这个过程将揭示模型构建的艺术：如何在保证物理现实准确性的同时，构建一个计算上易于处理的优化模型。",
            "id": "4105995",
            "problem": "一个独立的热电机组在离散的小时时间步长上，使用混合整数线性规划 (MILP) 的机组组合 (UC) 公式进行建模。令 $t \\in \\{1,2,3\\}$ 表示时间段，机组的开/关状态为 $y_t \\in \\{0,1\\}$，发电量为 $P_t \\ge 0$，线性规划 (LP) 松弛允许 $y_t \\in [0,1]$。该发电机有最小和最大出力界限以及对称的发电爬坡限制。在简化的 大M 松弛框架中，以下约束强制执行出力界限、爬坡限制和开/关联动：\n- 出力界限：对所有 $t$，有 $P_t \\le P^{\\max} y_t$ 和 $P_t \\ge P^{\\min} y_t$。\n- 向上爬坡：对所有 $t \\ge 2$，有 $P_t - P_{t-1} \\le R^{\\mathrm{U}} + M^{\\mathrm{up}} (1 - y_{t-1})$。\n- 向下爬坡：对所有 $t \\ge 2$，有 $P_{t-1} - P_t \\le R^{\\mathrm{D}} + M^{\\mathrm{down}} (1 - y_t)$。\n\n这里 $P^{\\min}$ 表示在线时的最小稳定出力，$P^{\\max}$ 表示最大出力，$R^{\\mathrm{U}}$ 表示保持在线时每小时的向上爬坡限制，$R^{\\mathrm{D}}$ 表示保持在线时每小时的向下爬坡限制。大M常数 $M^{\\mathrm{up}}$ 和 $M^{\\mathrm{down}}$ 旨在使机组分别从关机状态转换到开机状态或从开机状态转换到关机状态时，爬坡约束变得冗余。考虑一个具体实例，其中 $P^{\\min} = 120$ 兆瓦，$P^{\\max} = 275$ 兆瓦，$R^{\\mathrm{U}} = 73$ 兆瓦/小时，$R^{\\mathrm{D}} = 91$ 兆瓦/小时，采用小时离散化（$1$ 小时），初始条件为 $y_1$ 和 $P_1$ 在上述界限内自由取值。\n\n从 MILP 和 LP 松弛的基本原理出发，解释为什么在上述爬坡约束中过大的大M常数以及任何用于强制执行最小发电量的大M方法，都会产生弱的LP松弛，从而允许出现不符合物理实际的分数解 $y_t$，并伴有人为放宽的爬坡和出力水平。然后，推导 $M^{\\mathrm{up}}$ 和 $M^{\\mathrm{down}}$ 的最紧凑值，以确保每个大M项在其对应的 $y$ 等于 $0$ 时恰好使其各自的爬坡约束冗余，并且这样做不会限制由出力界限所暗示的物理上可行的状态转换。计算给定实例的这些最小值。\n\n将您的最终答案以单行矩阵的形式给出，其中包含 $M^{\\mathrm{up}}$ 和 $M^{\\mathrm{down}}$，四舍五入到三位有效数字。数值单位为兆瓦 (MW)。",
            "solution": "该问题要求解释过大的大M常数对混合整数线性规划 (MILP) 模型的线性规划 (LP) 松弛产生的有害影响，并要求在给定的机组组合 (UC) 公式中推导此类常数的最紧凑可能值。\n\n首先，我们讨论问题的概念部分。一个 MILP 求解器通常使用分支定界算法，该算法依赖于在搜索树的各个节点上求解问题的 LP 松弛。在 LP 松弛中，诸如 $y_t \\in \\{0, 1\\}$ 的整数约束被松弛为连续约束，这里是 $y_t \\in [0, 1]$。这个 LP 松弛的解为最优整数解提供了一个界限。这种松弛的‘紧凑性’至关重要：一个更紧凑的松弛，其可行域更接近真实整数可行解的凸包，能提供一个更好的界限。这使得求解器能够更有效地对搜索树进行剪枝，从而显著加快求解速度。\n\n过大的大M常数会削弱这种 LP 松弛。让我们分析一下向上爬坡约束：\n$$P_t - P_{t-1} \\le R^{\\mathrm{U}} + M^{\\mathrm{up}} (1 - y_{t-1})$$\n在整数模型中，如果机组处于开启状态 ($y_{t-1} = 1$)，该约束正确地变为 $P_t - P_{t-1} \\le R^{\\mathrm{U}}$。如果机组处于关闭状态 ($y_{t-1} = 0$)，该约束为 $P_t - P_{t-1} \\le R^{\\mathrm{U}} + M^{\\mathrm{up}}$。选择的 $M^{\\mathrm{up}}$ 项足够大，以使该不等式对于任何可行的启动都变得冗余。\n然而，在 LP 松弛中，$y_{t-1}$ 可以取 $0$ 和 $1$ 之间的分数值。例如，如果 $y_{t-1}$ 是 $0.1$，约束变为 $P_t - P_{t-1} \\le R^{\\mathrm{U}} + 0.9 M^{\\mathrm{up}}$。如果 $M^{\\mathrm{up}}$ 被任意选择得很大（例如，$10^6$），则右侧的值会变得巨大。这使得 LP 解即使在非常小的承诺状态 $y_{t-1}$ 下，也允许 $P_t$ 和 $P_{t-1}$ 之间存在巨大的、不符合物理实际的差异。LP 求解器可能会利用这一弱点找到一个目标值更优的分数解，但这个解远离任何物理上可实现的整数解，从而为 MILP 搜索提供了一个很差的界限。\n\n同样，问题提到了“任何用于强制执行最小发电量的大M方法”。所提供的公式 $P_t \\ge P^{\\min} y_t$ 实际上是一个不使用大M常数的紧凑公式。然而，一个假设的较弱公式可能是 $P_t \\ge P^{\\min} - M(1 - y_t)$。如果 $y_t=1$，这能正确地强制 $P_t \\ge P^{\\min}$。如果 $y_t=0$，它变为 $P_t \\ge P^{\\min} - M$；为了使这个约束不起作用（因为 $P_t$ 必须为 $0$），$M$ 必须至少为 $P^{\\min}$。在 LP 松弛中，如果 $y_t = 0.1$ 并且我们选择一个过大的 $M$，比如 $M=P^{\\max}$，约束就变成 $P_t \\ge P^{\\min} - 0.9 P^{\\max}$。由于 $P^{\\max} > P^{\\min}$，这个下界是负的，约束简化为 $P_t \\ge 0$。相比之下，紧凑公式 $P_t \\ge P^{\\min} y_t$ 会强制 $P_t \\ge 0.1 P^{\\min}$，这是一个更强、信息量更大的界限。这说明了选择不当的大M值如何产生弱的 LP 松弛。\n\n接下来，我们推导 $M^{\\mathrm{up}}$ 和 $M^{\\mathrm{down}}$ 的最紧凑（即，尽可能小）的有效值。如果一个大M值的大小恰好能使其所要覆盖的所有有效整数情景下的约束失效，而又不过分大，那么它就被认为是紧凑的。\n\n$M^{\\mathrm{up}}$ 的推导：\n向上爬坡约束为 $P_t - P_{t-1} \\le R^{\\mathrm{U}} + M^{\\mathrm{up}} (1 - y_{t-1})$。\n大M项在 $y_{t-1}=0$ 时激活。这对应于机组在时间 $t-1$ 处于离线状态。在此状态下，发电出力必须为零，因此 $P_{t-1}=0$。约束简化为：\n$$P_t \\le R^{\\mathrm{U}} + M^{\\mathrm{up}}$$\n在机组于 $t-1$ 时刻关闭的条件下，这个不等式必须对 $t$ 时刻的任何有效功率出力 $P_t$ 都成立。机组可能保持关闭（$y_t=0, P_t=0$），也可能启动（$y_t=1$）。在启动的情况下，功率出力 $P_t$ 的范围是 $P^{\\min} \\le P_t \\le P^{\\max}$。为确保约束永远不被违反，它必须对 $P_t$ 的最大可能值成立。在这个没有明确启动限制的简化模型中，机组理论上可以启动到其最大容量。因此，$P_t$ 的最大值为 $P^{\\max}$。\n为了使约束冗余，我们必须有：\n$$P^{\\max} \\le R^{\\mathrm{U}} + M^{\\mathrm{up}}$$\n为了找到 $M^{\\mathrm{up}}$ 的最紧凑（最小）值，我们将其设置为满足此条件的最小值：\n$$M^{\\mathrm{up}} = P^{\\max} - R^{\\mathrm{U}}$$\n\n$M^{\\mathrm{down}}$ 的推导：\n向下爬坡约束为 $P_{t-1} - P_t \\le R^{\\mathrm{D}} + M^{\\mathrm{down}} (1 - y_t)$。\n大M项在 $y_t=0$ 时激活。这对应于机组在时间 $t$ 处于离线状态。在此状态下，其发电出力必须为零，因此 $P_t=0$。约束简化为：\n$$P_{t-1} \\le R^{\\mathrm{D}} + M^{\\mathrm{down}}$$\n在机组于 $t$ 时刻关停的条件下，这个不等式必须对 $t-1$ 时刻的任何有效功率出力 $P_{t-1}$ 都成立。机组之前可能已关闭（$y_{t-1}=0, P_{t-1}=0$），也可能已开启（$y_{t-1}=1$）。在开启的情况下，其功率出力 $P_{t-1}$ 的范围是 $P^{\\min} \\le P_{t-1} \\le P^{\\max}$。为确保约束永远不被违反，它必须对 $P_{t-1}$ 的最大可能值成立。这个值是 $P^{\\max}$。\n为了使约束冗余，我们必须有：\n$$P^{\\max} \\le R^{\\mathrm{D}} + M^{\\mathrm{down}}$$\n因此，$M^{\\mathrm{down}}$ 的最紧凑（最小）值为：\n$$M^{\\mathrm{down}} = P^{\\max} - R^{\\mathrm{D}}$$\n\n最后，我们计算给定实例的数值：\n$P^{\\min} = 120$ 兆瓦\n$P^{\\max} = 275$ 兆瓦\n$R^{\\mathrm{U}} = 73$ 兆瓦/小时\n$R^{\\mathrm{D}} = 91$ 兆瓦/小时\n\n使用推导出的公式：\n$$M^{\\mathrm{up}} = P^{\\max} - R^{\\mathrm{U}} = 275 - 73 = 202 \\, \\text{MW}$$\n$$M^{\\mathrm{down}} = P^{\\max} - R^{\\mathrm{D}} = 275 - 91 = 184 \\, \\text{MW}$$\n\n这些值已经表示为三位有效数字。\n最终答案是包含这两个值的行矩阵。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 202  184 \\end{pmatrix}}\n$$"
        }
    ]
}