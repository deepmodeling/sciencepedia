{
    "hands_on_practices": [
        {
            "introduction": "缺陷的形成能取决于其组成元素的化学势，而这些化学势的取值范围受到材料热力学稳定性的制约。在计算任何具体缺陷的形成能之前，我们必须首先确定宿主材料相对于其可能的竞争相（例如其他化学计量比的化合物或纯元素相）保持稳定的化学势区域。这个练习将指导你如何基于形成焓数据，为一种二元化合物构建化学势稳定性图，这是后续所有点缺陷计算的必要前提 ()。",
            "id": "3800266",
            "problem": "考虑一个二元化合物AB，在适用于第一性原理超胞缺陷计算的零温零压热力学框架下进行处理。设元素A和B的化学势分别表示为 $\\mu_{A}$ 和 $\\mu_{B}$，元素参考态的化学势分别表示为 $\\mu_{A}^{\\text{ref}}$ 和 $\\mu_{B}^{\\text{ref}}$。定义化学势偏差为 $\\Delta \\mu_{i} \\equiv \\mu_{i} - \\mu_{i}^{\\text{ref}}$（其中 $i \\in \\{A,B\\}$），并定义化合物 $A_{x}B_{y}$ 在零温下每个化学式的生成焓为 $\\Delta H_{f}(A_{x}B_{y}) \\equiv \\mu(A_{x}B_{y}) - x\\,\\mu_{A}^{\\text{ref}} - y\\,\\mu_{B}^{\\text{ref}}$。假设对于化学计量比为 AB、$A_{2}B$ 和 $AB_{2}$ 的化合物，其生成焓 $\\Delta H_{f}$ 是已知的，并且化合物 AB 是稳定的，不会分解。\n\n从这些定义以及热力学要求出发——即在与 AB 平衡时，没有其他相（包括纯元素）可以降低吉布斯自由能——推导出在 $(\\Delta \\mu_{A}, \\Delta \\mu_{B})$ 平面中与 AB 的稳定性以及竞争相不析出相一致的允许区域。使用以下数据，单位为电子伏特/化学式：$\\Delta H_{f}(\\text{AB}) = -0.70$，$\\Delta H_{f}(A_{2}B) = -1.10$ 和 $\\Delta H_{f}(AB_{2}) = -0.90$。然后，确定沿着与 AB 平衡的线上 $\\Delta \\mu_{A}$ 的允许区间的数值宽度。用电子伏特表示你的答案，并将结果四舍五入至三位有效数字。",
            "solution": "该问题要求确定，为了使二元化合物 AB 在零温零压下保持稳定，元素 A 的化学势 $\\mu_A$ 的热力学允许范围。这个范围通常被称为化学势稳定窗口。我们已知主体化合物 AB 以及两个潜在竞争相 $A_2B$ 和 $AB_2$ 的生成焓。\n\n分析是在相对于其参考态的化学势偏差空间中进行的，定义为 $\\Delta \\mu_{i} \\equiv \\mu_{i} - \\mu_{i}^{\\text{ref}}$，其中 $i \\in \\{A,B\\}$。\n\n首先，我们建立组分元素与化合物 AB 之间的热力学平衡条件。在零温下，一个固体化合物的化学势是其每个化学式的总能量。对于 A、B 和化合物 AB 之间的两相平衡，化学势必须满足：\n$$ \\mu_A + \\mu_B = \\mu(AB) $$\n化合物 $A_x B_y$ 的生成焓定义为 $\\Delta H_{f}(A_{x}B_{y}) \\equiv \\mu(A_{x}B_{y}) - x\\,\\mu_{A}^{\\text{ref}} - y\\,\\mu_{B}^{\\text{ref}}$。对于 AB，这便是 $\\Delta H_f(AB) = \\mu(AB) - \\mu_A^{\\text{ref}} - \\mu_B^{\\text{ref}}$。\n将这些定义代入平衡条件：\n$$ (\\Delta \\mu_A + \\mu_A^{\\text{ref}}) + (\\Delta \\mu_B + \\mu_B^{\\text{ref}}) = \\Delta H_f(AB) + \\mu_A^{\\text{ref}} + \\mu_B^{\\text{ref}} $$\n这可以简化为化学势偏差之间的线性关系：\n$$ \\Delta \\mu_A + \\Delta \\mu_B = \\Delta H_f(AB) $$\n使用给定值 $\\Delta H_f(AB) = -0.70$ eV，我们得到：\n$$ \\Delta \\mu_A + \\Delta \\mu_B = -0.70 \\quad (1) $$\n该方程定义了在 $(\\Delta \\mu_A, \\Delta \\mu_B)$ 平面中的一条直线，沿着这条直线，体系与化合物 AB 处于平衡状态。\n\n接下来，我们施加稳定性条件。要使化合物 AB 稳定，它必须比任何竞争相都更稳定。这意味着在其形成之前，不能有纯元素 A 或 B，或任何其他竞争化合物析出。\n\n1.  **防止纯元素析出的稳定性：** 元素的化学势不能超过其在稳定元素参考相中的值。否则，纯元素将会析出。\n    $$ \\mu_A \\le \\mu_A^{\\text{ref}} \\implies \\Delta \\mu_A \\le 0 $$\n    $$ \\mu_B \\le \\mu_B^{\\text{ref}} \\implies \\Delta \\mu_B \\le 0 $$\n    这些条件定义了富A（$\\Delta \\mu_A = 0$）和富B（$\\Delta \\mu_B = 0$）的极限。\n\n2.  **防止竞争化合物析出的稳定性：** 任何其他化合物 $A_x B_y$ 的形成在热力学上必须是不利的。这意味着其组分化学势的加权和必须小于或等于该化合物的化学势：\n    $$ x \\mu_A + y \\mu_B \\le \\mu(A_x B_y) $$\n    我们可以用 $\\Delta \\mu$ 和 $\\Delta H_f$ 来重写这个不等式：\n    $$ x (\\Delta \\mu_A + \\mu_A^{\\text{ref}}) + y (\\Delta \\mu_B + \\mu_B^{\\text{ref}}) \\le \\Delta H_f(A_x B_y) + x \\mu_A^{\\text{ref}} + y \\mu_B^{\\text{ref}} $$\n    $$ x \\Delta \\mu_A + y \\Delta \\mu_B \\le \\Delta H_f(A_x B_y) $$\n\n    将此应用于竞争相 $A_2 B$ 和 $AB_2$：\n    对于 $A_2 B$（$x=2, y=1$）：\n    $$ 2 \\Delta \\mu_A + \\Delta \\mu_B \\le \\Delta H_f(A_2 B) $$\n    使用给定数据 $\\Delta H_f(A_2 B) = -1.10$ eV：\n    $$ 2 \\Delta \\mu_A + \\Delta \\mu_B \\le -1.10 \\quad (2) $$\n    对于 $AB_2$（$x=1, y=2$）：\n    $$ \\Delta \\mu_A + 2 \\Delta \\mu_B \\le \\Delta H_f(AB_2) $$\n    使用给定数据 $\\Delta H_f(AB_2) = -0.90$ eV：\n    $$ \\Delta \\mu_A + 2 \\Delta \\mu_B \\le -0.90 \\quad (3) $$\n\n化学势的允许范围是平衡线(1)上满足所有稳定性不等式的一个线段。我们可以通过将平衡条件代入这些不等式来找到这个范围。从方程(1)中，我们有 $\\Delta \\mu_B = -0.70 - \\Delta \\mu_A$。\n\n将此代入不等式(2)：\n$$ 2 \\Delta \\mu_A + (-0.70 - \\Delta \\mu_A) \\le -1.10 $$\n$$ \\Delta \\mu_A - 0.70 \\le -1.10 $$\n$$ \\Delta \\mu_A \\le -0.40 $$\n这给出了 $\\Delta \\mu_A$ 的上界。这个边界对应于 AB 和 $A_2B$ 之间的平衡。\n\n将 $\\Delta \\mu_B = -0.70 - \\Delta \\mu_A$ 代入不等式(3)：\n$$ \\Delta \\mu_A + 2 (-0.70 - \\Delta \\mu_A) \\le -0.90 $$\n$$ \\Delta \\mu_A - 1.40 - 2 \\Delta \\mu_A \\le -0.90 $$\n$$ - \\Delta \\mu_A \\le 0.50 $$\n$$ \\Delta \\mu_A \\ge -0.50 $$\n这给出了 $\\Delta \\mu_A$ 的下界。这个边界对应于 AB 和 $AB_2$ 之间的平衡。\n\n来自纯元素的稳定性条件 $\\Delta \\mu_A \\le 0$ 和 $\\Delta \\mu_B \\le 0$ 也必须被检验。\n推导出的 $\\Delta \\mu_A$ 范围是 $[-0.50, -0.40]$。由于此范围内的所有值都小于或等于0，因此条件 $\\Delta \\mu_A \\le 0$ 是满足的。\n对于 $\\Delta \\mu_B \\le 0$，我们有 $-0.70 - \\Delta \\mu_A \\le 0$，这意味着 $\\Delta \\mu_A \\ge -0.70$。由于推导出的范围 $[-0.50, -0.40]$ 完全在 $[-0.70, \\infty)$ 之内，这个条件也得到满足。\n因此，竞争化合物 $A_2B$ 和 $AB_2$ 提供了比纯元素更严格的约束。\n\n沿着与 AB 平衡的线上，$\\Delta \\mu_A$ 的完整允许区间是：\n$$ -0.50 \\le \\Delta \\mu_A \\le -0.40 $$\n这个允许区间的宽度代表了化合物 AB 的稳定范围，它是 $\\Delta \\mu_A$ 的最大值和最小值之差：\n$$ \\text{Width} = (\\text{max } \\Delta \\mu_A) - (\\text{min } \\Delta \\mu_A) = (-0.40) - (-0.50) = 0.10 \\, \\text{eV} $$\n题目要求将答案四舍五入至三位有效数字。\n$$ \\text{Width} = 0.100 \\, \\text{eV} $$",
            "answer": "$$ \\boxed{0.100} $$"
        },
        {
            "introduction": "从第一性原理计算中获得不同电荷态 $q$ 下的缺陷形成能 $E_f(D^q)$ 后，下一步是理解缺陷在半导体带隙中的电学行为。通过绘制 $E_f$ 作为费米能级 $E_F$ 函数的“缺陷图”，我们可以确定在不同费米能级下哪种电荷态最为稳定，并计算出电荷转变能级 $\\epsilon(q/q')$。本练习将引导你分析一组给定的形成能数据，以构建缺陷图，并识别是否存在“负U”行为，即某个中间电荷态在任何费米能级下都不是最稳定的 ()。",
            "id": "3800308",
            "problem": "在原子和电子的巨正则系综框架下，使用第一性原理总能计算研究了宽禁带半导体中的一个点缺陷 $D$。价带顶 $E_v$ 被设为电子库的能量零点。主体材料的带隙为 $E_{\\mathrm{g}} = 2.4 \\text{ eV}$，因此费米能级 $E_F$ 相对于 $E_v$ 在 $0 \\leq E_F \\leq E_{\\mathrm{g}}$ 的范围内变化。计算了缺陷 $D$ 的五种电荷态 $q \\in \\{+2, +1, 0, -1, -2\\}$，其在三个费米能级位置上的形成能 $E_f(D^q)$ 报告如下（所有能量单位均为 $\\text{eV}$）：\n\n在 $E_F = 0.0 \\text{ eV}$ 时：$E_f(D^{+2}) = 1.0 \\text{ eV}$，$E_f(D^{+1}) = 1.5 \\text{ eV}$，$E_f(D^{0}) = 1.4 \\text{ eV}$，$E_f(D^{-1}) = 3.0 \\text{ eV}$，$E_f(D^{-2}) = 5.0 \\text{ eV}$。\n\n在 $E_F = 1.2 \\text{ eV}$ 时：$E_f(D^{+2}) = 3.4 \\text{ eV}$，$E_f(D^{+1}) = 2.7 \\text{ eV}$，$E_f(D^{0}) = 1.4 \\text{ eV}$，$E_f(D^{-1}) = 1.8 \\text{ eV}$，$E_f(D^{-2}) = 2.6 \\text{ eV}$。\n\n在 $E_F = 2.4 \\text{ eV}$ 时：$E_f(D^{+2}) = 5.8 \\text{ eV}$，$E_f(D^{+1}) = 3.9 \\text{ eV}$，$E_f(D^{0}) = 1.4 \\text{ eV}$，$E_f(D^{-1}) = 0.6 \\text{ eV}$，$E_f(D^{-2}) = 0.2 \\text{ eV}$。\n\n从带电荷态缺陷形成能的基本定义以及电子库的作用出发，推导 $E_f(D^q)$ 对 $E_F$ 的依赖关系。利用所给数据，通过寻找 $E_f(D^q)$ 与 $E_f(D^{q'})$ 相等且能量较低的分支发生改变的费米能级位置，来确定 $0 \\leq E_F \\leq E_{\\mathrm{g}}$ 范围内的所有热力学电荷态转变能级 $\\epsilon(q/q')$。根据这些转变能级，计算整个带隙内的稳定电荷态集合，并评估该缺陷是否表现出负U行为。负U行为的定义是，在整个带隙内，两个电荷数 $q$ 相差为2的稳定电荷态之间，不存在稳定的中间电荷态。如果存在负U行为，通过价带顶处的形成能的二阶差分来计算被跳过的中间态的有效相关能。\n\n将所有报告的能量四舍五入到四位有效数字。能量以 $\\text{eV}$ 为单位表示。在最终答案中，按顺序报告三个转变能（从低到高的 $E_F$）和被跳过的中间态的有效相关能（如果存在）。",
            "solution": "我们从点缺陷 $D$ 在电荷态 $q$ 下与原子库和电子库交换原子和电子的形成能的标准巨正则表述开始。在费米能级 $E_F$（以价带顶 $E_v$ 为参考）下的形成能表示为\n$$\nE_f(D^q; E_F) = E_{\\mathrm{tot}}(D^q) - E_{\\mathrm{tot}}(\\mathrm{bulk}) - \\sum_i n_i \\mu_i + q\\,(E_F + E_v) + E_{\\mathrm{corr}}(q),\n$$\n其中 $E_{\\mathrm{tot}}(D^q)$ 和 $E_{\\mathrm{tot}}(\\mathrm{bulk})$ 分别是含缺陷和纯净超胞的总能量，$n_i$ 和 $\\mu_i$ 分别是组分 $i$ 的化学计量偏差和化学势，$q$ 是整数缺陷电荷（以基本电荷为单位），$E_{\\mathrm{corr}}(q)$ 是有限尺寸和静电修正项。将 $E_v$ 设为能量参考零点，对 $E_F$ 的显式依赖关系简化为\n$$\n\\frac{\\partial E_f(D^q; E_F)}{\\partial E_F} = q,\n$$\n因此 $E_f(D^q; E_F)$ 是 $E_F$ 的线性函数，斜率为 $q$。所以，对于每个 $q$，我们可以写出\n$$\nE_f(D^q; E_F) = A_q + q\\,E_F,\n$$\n其中 $A_q \\equiv E_f(D^q; E_F=0)$ 是在价带顶处的截距。所给的 $E_F = 0.0 \\text{ eV}$ 处的数据直接给出了截距：\n$$\nA_{+2} = 1.0,\\quad A_{+1} = 1.5,\\quad A_0 = 1.4,\\quad A_{-1} = 3.0,\\quad A_{-2} = 5.0,\n$$\n所有单位均为 $\\text{eV}$。在 $E_F = 1.2 \\text{ eV}$ 和 $E_F = 2.4 \\text{ eV}$ 处的额外数据点与线性形式和斜率 $q$ 是一致的：\n- 对于 $q=+2$：$A_{+2} + 2\\times 1.2 = 1.0 + 2.4 = 3.4$ 以及 $A_{+2} + 2\\times 2.4 = 1.0 + 4.8 = 5.8$。\n- 对于 $q=+1$：$A_{+1} + 1\\times 1.2 = 1.5 + 1.2 = 2.7$ 以及 $A_{+1} + 1\\times 2.4 = 1.5 + 2.4 = 3.9$。\n- 对于 $q=0$：对于所有 $E_F$，$A_0 + 0\\times E_F = 1.4$。\n- 对于 $q=-1$：$A_{-1} - 1\\times 1.2 = 3.0 - 1.2 = 1.8$ 以及 $A_{-1} - 1\\times 2.4 = 3.0 - 2.4 = 0.6$。\n- 对于 $q=-2$：$A_{-2} - 2\\times 1.2 = 5.0 - 2.4 = 2.6$ 以及 $A_{-2} - 2\\times 2.4 = 5.0 - 4.8 = 0.2$。\n\n热力学转变能级 $\\epsilon(q/q')$（相对于 $E_v$）由 $E_f(D^q; E_F)$ 等于 $E_f(D^{q'}; E_F)$ 且能量最低的分支发生改变的费米能级位置给出。求解 $A_q + q E_F = A_{q'} + q' E_F$ 可得\n$$\n\\epsilon(q/q') = \\frac{A_{q'} - A_q}{q - q'}.\n$$\n我们计算带隙 $0 \\leq E_F \\leq 2.4$ 内的相关交点：\n\n1. 在 $q=+2$ 和 $q=0$ 之间：\n$$\n\\epsilon(+2/0) = \\frac{A_0 - A_{+2}}{2 - 0} = \\frac{1.4 - 1.0}{2} = 0.2 \\text{ eV}.\n$$\n与 $q=+1$ 比较，我们注意到 $\\epsilon(+2/+1) = \\frac{A_{+1} - A_{+2}}{2 - 1} = 0.5 \\text{ eV}$，但对于 $E_F  0.2 \\text{ eV}$，$q=0$ 分支的能量已经低于 $q=+1$ 分支，因为 $E_f(D^0; E_F) = 1.4$ 而 $E_f(D^{+1}; E_F) = 1.5 + E_F$。交点 $\\epsilon(+1/0) = A_0 - A_{+1} = -0.1 \\text{ eV}$ 位于带隙之外。因此，第一个转变是在 $E_F = 0.2 \\text{ eV}$ 处直接从 $+2 \\to 0$，并且 $q=+1$ 在带隙内从未热力学稳定。\n\n2. 在 $q=0$ 和 $q=-1$ 之间：\n$$\n\\epsilon(0/-1) = \\frac{A_{-1} - A_0}{0 - (-1)} = 3.0 - 1.4 = 1.6 \\text{ eV}.\n$$\n\n3. 在 $q=-1$ 和 $q=-2$ 之间：\n$$\n\\epsilon(-1/-2) = \\frac{A_{-2} - A_{-1}}{-1 - (-2)} = 5.0 - 3.0 = 2.0 \\text{ eV}.\n$$\n\n这些是 $0 \\leq E_F \\leq 2.4 \\text{ eV}$ 范围内的唯有交点。因此，整个带隙内的稳定电荷态序列是：\n- 对于 $0 \\leq E_F   0.2 \\text{ eV}$：$q=+2$ 能量最低。\n- 对于 $0.2 \\text{ eV} \\leq E_F   1.6 \\text{ eV}$：$q=0$ 能量最低。\n- 对于 $1.6 \\text{ eV} \\leq E_F   2.0 \\text{ eV}$：$q=-1$ 能量最低。\n- 对于 $2.0 \\text{ eV} \\leq E_F \\leq 2.4 \\text{ eV}$：$q=-2$ 能量最低。\n\n从 $+2$ 直接转变到 $0$ 而没有 $+1$ 的稳定区域，表明存在以中间电荷 $q=+1$ 为中心的负U行为。一个量化对 $q=+1$ 跳过的有效相关能可以定义为在价带顶处的二阶差分，\n$$\nU_{\\mathrm{eff}}(q=+1) = A_{+2} + A_0 - 2 A_{+1}.\n$$\n使用截距，\n$$\nU_{\\mathrm{eff}}(+1) = 1.0 + 1.4 - 2\\times 1.5 = 2.4 - 3.0 = -0.6 \\text{ eV}.\n$$\n负值证实了 $+1$ 中间态的负U特性。在负电荷侧没有发生跳过现象，因为 $q=-1$ 和 $q=-2$ 都在有限的 $E_F$ 区间内是稳定的。\n\n将每个报告的能量四舍五入到四位有效数字，我们得到的三个转变能和有效相关能分别为 $0.2000 \\text{ eV}$、$1.600 \\text{ eV}$、$2.000 \\text{ eV}$ 和 $-0.6000 \\text{ eV}$。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.2000  1.600  2.000  -0.6000\\end{pmatrix}}$$"
        },
        {
            "introduction": "在周期性超胞中模拟带电缺陷时，缺陷电荷与其周期性镜像以及为了保持电中性而引入的补偿背景电荷之间的虚假静电相互作用，会导致形成能计算出现显著的有限尺寸误差。为了获得物理上准确的结果，必须对这种误差进行校正。这个动手编程练习将指导你实现一种广泛应用的校正方法——Freysoldt, Neugebauer和Van de Walle (FNV) 方案，它通过将静电势分解为长程和短程部分来精确地扣除这些人为的相互作用能 ()。",
            "id": "3800267",
            "problem": "您的任务是实现 Freysoldt、Neugebauer 和 Van de Walle (FNV) 校正，该校正用于带电缺陷。您需要使用一种基于原理的方法，将缺陷诱导的静电势分解为长程和短程分量，并从平面平均势计算校正能量。Freysoldt、Neugebauer 和 Van de Walle (FNV) 方法需要从基本静电学计算模型长程势，分离出短程贡献，在远场区域执行势对齐，并将此对齐与镜像电荷能量相结合以获得校正值。所有能量必须以电子伏特 (eV) 表示。\n\n基本假设和定义：\n- 从物质中的静电泊松方程开始，其形式为 $$\\nabla^2 V(\\mathbf{r}) = - \\frac{\\rho(\\mathbf{r})}{\\varepsilon_0 \\epsilon},$$ 其中 $V(\\mathbf{r})$ 是静电势，$\\rho(\\mathbf{r})$ 是电荷密度，$\\varepsilon_0$ 是真空介电常数，$\\epsilon$ 是标量相对介电常数（介电常数）。\n- 考虑一个三维周期性超胞，其尺寸为 $L_x$、$L_y$ 和 $L_z$，总体积为 $V_{\\text{cell}} = L_x L_y L_z$，在 $z$ 方向的 $z_0$ 位置包含一个电荷量为 $q$（以基本电荷为单位）的局域缺陷。为在周期性计算中强制电荷中性，假定存在一个均匀的补偿背景电荷密度。\n- 通过对垂直于 $z$ 轴的平面进行平均，平面平均将问题简化为一维。定义平面平均电荷密度为 $$\\bar{\\rho}(z) = \\frac{q}{A} \\delta(z - z_0) - \\frac{q}{A L_z},$$ 其中 $A = L_x L_y$ 且 $\\delta$ 是狄拉克$\\delta$函数。这确保了电荷中性，因为 $$\\int_0^{L_z} \\bar{\\rho}(z)\\, \\mathrm{d}z = 0.$$\n- 平面平均静电势 $V(z)$ 在周期性边界条件和零平均规范下服从一维泊松方程， $$ - \\varepsilon_0 \\epsilon \\frac{\\mathrm{d}^2 V(z)}{\\mathrm{d}z^2} = \\bar{\\rho}(z), \\quad V(0)=V(L_z), \\quad \\int_0^{L_z} V(z)\\, \\mathrm{d}z = 0. $$\n- 一维周期性格林函数 $G(z,z_0)$ 求解 $$ - \\frac{\\mathrm{d}^2 G(z,z_0)}{\\mathrm{d}z^2} = \\delta(z-z_0) - \\frac{1}{L_z}, $$ 满足周期性边界条件和零均值。使用环上的最短弧长距离 $s(z) = \\min(|z - z_0|, L_z - |z - z_0|)$，格林函数具有闭合形式 $$G(z,z_0) = \\frac{s(z)\\,(L_z - s(z))}{2 L_z} - \\frac{L_z}{12}.$$\n- 模型长程平面平均势则为 $$V_{\\text{lr}}(z) = \\frac{q}{\\varepsilon_0 \\epsilon A} G(z,z_0).$$ 为了进行数值计算并以电子伏特 (eV) 表示能量，请使用电子伏特-埃单位制下的库仑前因子 $$k_e = \\frac{e^2}{4 \\pi \\varepsilon_0} \\approx 14.399645\\ \\mathrm{eV}\\, \\mathrm{\\AA},$$ 并写为 $$V_{\\text{lr}}(z) = \\frac{k_e}{\\epsilon}\\, \\frac{q}{A}\\, \\left( \\frac{s(z)\\,(L_z - s(z))}{2 L_z} - \\frac{L_z}{12} \\right),$$ 确保 $L_x$、$L_y$、$L_z$ 和 $s(z)$ 以埃为单位提供，从而使 $V_{\\text{lr}}(z)$ 的单位为电子伏特 (eV)。\n- 由第一性原理计算得出的缺陷引起的势由平面平均势差 $$\\Delta V(z) = V_{\\text{defect}}(z) - V_{\\text{bulk}}(z),$$ 表示，它可以分解为长程和短程分量 $$\\Delta V(z) = V_{\\text{lr}}(z) + V_{\\text{sr}}(z).$$ 短程分量 $V_{\\text{sr}}(z)$ 局限在缺陷周围，并在足够远的地方消失。\n- 远场势对齐常数通过在远离缺陷的区域（不包括 $z_0$ 周围半径为 $r_{\\text{cut}}$ 的邻域）对 $V_{\\text{sr}}(z)$ 进行平均获得。将对齐常数记为 $$C_{\\text{align}} = \\langle V_{\\text{sr}}(z) \\rangle_{\\text{far}},$$ 其中平均值是对所有满足 $s(z) \\ge r_{\\text{cut}}$ 的 $z$ 进行计算的。\n- 在此一维平面平均模型中，镜像电荷能量由 $$E_{\\text{img}} = \\frac{1}{2} q\\, V_{\\text{lr}}(z_0) = \\frac{1}{2} q\\, \\frac{k_e}{\\epsilon}\\, \\frac{q}{A}\\, \\left( - \\frac{L_z}{12} \\right),$$ 给出，使用上述规范选择。\n- 那么，Freysoldt、Neugebauer 和 Van de Walle (FNV) 校正能量为 $$E_{\\text{corr}} = q\\, C_{\\text{align}} + E_{\\text{img}},$$ 以电子伏特 (eV) 表示。\n\n您的程序必须：\n1. 实现长程模型 $V_{\\text{lr}}(z)$，使用上述一维周期性格林函数和电子伏特-埃单位制下的库仑前因子 $k_e$，严格使用以埃为单位的长度输入，并返回以电子伏特 (eV) 为单位的势和能量。\n2. 构建用于验证的合成测试平面平均势差 $\\Delta V(z)$，方法是在 $z_0$ 周围添加一个局域的短程高斯函数和一个恒定偏移（代表任意的参考不匹配），即 $$\\Delta V(z_i) = V_{\\text{lr}}(z_i) + A_{\\text{sr}} \\exp\\!\\left( - \\frac{s(z_i)^2}{2 \\sigma^2} \\right) + \\Delta V_0,$$ 其中 $z_i$ 是离散采样点，$A_{\\text{sr}}$ 是以电子伏特 (eV) 为单位的短程振幅，$\\sigma$ 是以埃为单位的宽度，$\\Delta V_0$ 是以电子伏特 (eV) 为单位的恒定偏移。\n3. 按 $$V_{\\text{sr}}(z_i) = \\Delta V(z_i) - V_{\\text{lr}}(z_i),$$ 计算短程分量，并通过对所有满足 $s(z_i) \\ge r_{\\text{cut}}$ 的点上的 $V_{\\text{sr}}(z_i)$ 进行平均来获得对齐常数 $C_{\\text{align}}$。\n4. 计算镜像电荷能量 $E_{\\text{img}}$ 从 $V_{\\text{lr}}(z_0)$，然后计算 $$E_{\\text{corr}} = q C_{\\text{align}} + E_{\\text{img}}.$$\n\n测试套件：\n使用以下四个测试用例来验证覆盖范围，包括一个通用情况、一个中性缺陷边界条件 ($q=0$)，以及高介电屏蔽和缺陷靠近边界的边缘情况。在所有情况下，使用 $N_z = 1000$ 个点对区间 $[0, L_z]$ 进行均匀采样。所有长度必须以埃为单位输入，所有能量（势）必须以电子伏特 (eV) 为单位。对于每个案例，指定 $(L_x, L_y, L_z, \\epsilon, q, z_0, r_{\\text{cut}}, A_{\\text{sr}}, \\sigma, \\Delta V_0)$:\n\n- 案例1（通用情况）：$(10.0, 10.0, 20.0, 12.0, +1.0, 7.4, 5.0, 0.6, 1.0, 0.25)$.\n- 案例2（中性缺陷边界）：$(12.0, 12.0, 24.0, 10.0, 0.0, 5.0, 6.0, 0.8, 0.8, -0.20)$.\n- 案例3（高介电常数，负电荷）：$(8.0, 16.0, 16.0, 30.0, -2.0, 2.3, 4.0, 0.5, 1.5, 0.10)$.\n- 案例4（低介电常数，缺陷靠近边界）：$(20.0, 10.0, 10.0, 3.0, +1.0, 9.8, 3.0, 0.4, 1.2, 0.00)$.\n\n答案规范：\n- 对于每个测试用例，计算一个以电子伏特 (eV) 为单位的浮点数 $E_{\\text{corr}}$。\n- 您的程序应生成单行输出，其中包含四个结果，格式为方括号括起来的逗号分隔列表，例如 $[E_{\\text{corr,1}}, E_{\\text{corr,2}}, E_{\\text{corr,3}}, E_{\\text{corr,4}}]$。\n\n本问题陈述中的所有数学实体（符号、变量、函数、算符和数字）都必须以LaTeX格式书写。使用电子伏特 (eV) 作为能量单位。不使用角度。",
            "solution": "该问题已经过验证，被认为是可靠、适定且自洽的。所提供的 Freysoldt、Neugebauer 和 Van de Walle (FNV) 校正方法的物理和数学框架与计算材料科学领域的既有文献一致。测试用例定义明确，适合用于验证实现。\n\n解决方案通过系统地实现 FNV 形式主义中概述的步骤来进行。其核心原理是将含缺陷超胞与原始超胞之间的静电势差 $\\Delta V(z) = V_{\\text{defect}}(z) - V_{\\text{bulk}}(z)$ 分解为一个已知的长程分量 $V_{\\text{lr}}(z)$ 和一个剩余的短程分量 $V_{\\text{sr}}(z)$。然后，校正能量 $E_{\\text{corr}}$ 由从该分解中派生的两个关键项组合而成：一个势对齐校正和一个镜像电荷相互作用能。\n\n算法流程如下：\n\n1.  **离散化与几何设置：** 对于每个测试用例，我们考虑沿超胞 $z$ 轴的一个一维网格，其长度为 $L_z$，采样点数为 $N_z = 1000$。平面平均公式取决于垂直于该轴的胞体面积 $A = L_x L_y$。一个关键的几何量是网格上一点 $z$ 与缺陷位置 $z_0$ 之间的周期性距离 $s(z)$。它被定义为周长为 $L_z$ 的圆上的最短弧长距离：$s(z) = \\min(|z - z_0|, L_z - |z - z_0|)$。该函数正确处理了超胞的周期性。\n\n2.  **长程模型势, $V_{\\text{lr}}(z)$：** 由平面点电荷 $q$ 和均匀中和背景产生的长程静电势，使用一维周期性泊松方程进行建模。解 $V_{\\text{lr}}(z)$ 通过相应的周期性格林函数 $G(z, z_0)$ 获得。问题在特定规范（零平均势）下，并使用实用单位（电子伏特和埃）给出了 $V_{\\text{lr}}(z)$ 的闭合形式表达式：\n    $$V_{\\text{lr}}(z) = \\frac{k_e}{\\epsilon}\\, \\frac{q}{A}\\, \\left( \\frac{s(z)\\,(L_z - s(z))}{2 L_z} - \\frac{L_z}{12} \\right)$$\n    其中 $k_e = \\frac{e^2}{4 \\pi \\varepsilon_0} \\approx 14.399645\\ \\mathrm{eV}\\, \\mathrm{\\AA}$ 是库仑前因子，$\\epsilon$ 是相对介电常数，$q$ 是以基本电荷 $e$ 为单位的缺陷电荷。对网格上的所有点 $z_i$ 计算该模型势。\n\n3.  **合成测试势, $\\Delta V(z)$：** 为验证校正方案，我们构建一个模拟第一性原理计算输出的合成势差 $\\Delta V(z)$。它通过对三个分量求和构建而成：(i) 上面计算的精确长程模型势 $V_{\\text{lr}}(z)$；(ii) 一个以缺陷为中心的局域短程高斯函数 $A_{\\text{sr}} \\exp\\!\\left( - s(z)^2 / (2 \\sigma^2) \\right)$，代表缺陷诱导的电子和离子弛豫；以及 (iii) 一个恒定偏移 $\\Delta V_0$，它代表缺陷计算和块体计算之间任意的势对齐差异。\n    $$\\Delta V(z_i) = V_{\\text{lr}}(z_i) + A_{\\text{sr}} \\exp\\!\\left( - \\frac{s(z_i)^2}{2 \\sigma^2} \\right) + \\Delta V_0$$\n\n4.  **势对齐常数, $C_{\\text{align}}$：** 通过从总势差中减去已知的长程模型来分离短程势：$V_{\\text{sr}}(z_i) = \\Delta V(z_i) - V_{\\text{lr}}(z_i)$。对于我们的合成势，这会得到：\n    $$V_{\\text{sr}}(z_i) = A_{\\text{sr}} \\exp\\!\\left( - \\frac{s(z_i)^2}{2 \\sigma^2} \\right) + \\Delta V_0$$\n    FNV 方法的关键洞见在于，远离缺陷时，短程物理势会消失。因此，在这个“远场”区域中 $V_{\\text{sr}}(z)$ 的剩余非零值必须对应于未知的偏移量 $\\Delta V_0$。我们通过对周期性距离 $s(z_i)$ 大于或等于指定截断半径 $r_{\\text{cut}}$ 的所有网格点 $z_i$ 上的 $V_{\\text{sr}}(z_i)$ 进行平均，来计算对齐常数 $C_{\\text{align}}$。\n    $$C_{\\text{align}} = \\langle V_{\\text{sr}}(z) \\rangle_{s(z) \\ge r_{\\text{cut}}}$$\n    如果 $r_{\\text{cut}}$ 相对于短程宽度 $\\sigma$ 足够大，高斯项将变得可以忽略不计，该过程能准确地恢复偏移量，即 $C_{\\text{align}} \\approx \\Delta V_0$。\n\n5.  **镜像电荷能量, $E_{\\text{img}}$：** 周期性边界条件的使用引入了缺陷电荷与其周期性镜像之间由中和背景介导的虚假静电相互作用。这个人为的能量贡献必须被减去。在平面平均模型中，该能量由电荷 $q$ 与其自身产生的长程势在其自身位置 $z_0$ 处相互作用能的一半给出：\n    $$E_{\\text{img}} = \\frac{1}{2} q\\, V_{\\text{lr}}(z_0)$$\n    代入 $V_{\\text{lr}}(z)$ 的表达式并注意到 $s(z_0) = 0$，我们得到计算公式：\n    $$E_{\\text{img}} = \\frac{1}{2} q\\, \\left( \\frac{k_e}{\\epsilon}\\, \\frac{q}{A}\\, \\left( - \\frac{L_z}{12} \\right) \\right) = - \\frac{k_e q^2 L_z}{24 \\epsilon A}$$\n\n6.  **总 FNV 校正, $E_{\\text{corr}}$：** 最终的校正能量是两项之和。第一项 $q C_{\\text{align}}$ 对系统的总能量进行了势对齐误差的校正。第二项是加上 $E_{\\text{img}}$，考虑到其负号，这实际上是减去了虚假的镜像电荷相互作用能。\n    $$E_{\\text{corr}} = q\\, C_{\\text{align}} + E_{\\text{img}}$$\n    此过程应用于每个测试用例。对于中性缺陷 ($q=0$) 的特殊情况， $E_{\\text{img}}$ 和项 $q C_{\\text{align}}$ 均为零，导致总校正 $E_{\\text{corr}} = 0$，这与预期相符。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Freysoldt, Neugebauer, and Van de Walle (FNV) correction\n    energy for charged defects based on a 1D planar-averaged model.\n    \"\"\"\n\n    # Define the Coulomb prefactor in eV*Angstrom units.\n    K_E = 14.399645  # e^2 / (4 * pi * epsilon_0)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Lx, Ly, Lz, epsilon, q, z0, r_cut, A_sr, sigma, dV0)\n        # Case 1 (general)\n        (10.0, 10.0, 20.0, 12.0, +1.0, 7.4, 5.0, 0.6, 1.0, 0.25),\n        # Case 2 (neutral defect boundary)\n        (12.0, 12.0, 24.0, 10.0, 0.0, 5.0, 6.0, 0.8, 0.8, -0.20),\n        # Case 3 (high dielectric, negative charge)\n        (8.0, 16.0, 16.0, 30.0, -2.0, 2.3, 4.0, 0.5, 1.5, 0.10),\n        # Case 4 (low dielectric, defect near boundary)\n        (20.0, 10.0, 10.0, 3.0, +1.0, 9.8, 3.0, 0.4, 1.2, 0.00),\n    ]\n\n    results = []\n    \n    # Number of sampling points along the z-axis.\n    N_Z = 1000\n\n    for case in test_cases:\n        Lx, Ly, Lz, epsilon, q, z0, r_cut, A_sr, sigma, dV0 = case\n        \n        # Area of the cell in the xy-plane.\n        A = Lx * Ly\n\n        # For a neutral defect (q=0), the correction is zero.\n        if q == 0.0:\n            results.append(0.0)\n            continue\n            \n        # 1. Create a uniform grid along z and compute the periodic distance s(z).\n        # We use a grid representing the periodic interval [0, Lz).\n        z_grid = np.linspace(0.0, Lz, N_Z, endpoint=False)\n        \n        # Calculate the shortest periodic distance s(z) from each grid point to z0.\n        s_dist_raw = np.abs(z_grid - z0)\n        s_dist = np.minimum(s_dist_raw, Lz - s_dist_raw)\n\n        # 2. Compute the model long-range potential V_lr(z).\n        # This is based on the 1D periodic Green's function.\n        G_part = (s_dist * (Lz - s_dist)) / (2.0 * Lz) - Lz / 12.0\n        V_lr = (K_E * q) / (epsilon * A) * G_part\n\n        # 3. Construct the synthetic total potential difference dV(z).\n        # This simulates the output of a first-principles calculation.\n        V_sr_gauss = A_sr * np.exp(-s_dist**2 / (2.0 * sigma**2))\n        dV = V_lr + V_sr_gauss + dV0\n\n        # 4. Isolate the short-range potential V_sr(z) and compute the alignment constant C_align.\n        V_sr = dV - V_lr\n        \n        # C_align is the average of V_sr in the far-field region.\n        far_field_mask = s_dist = r_cut\n        C_align = np.mean(V_sr[far_field_mask])\n\n        # 5. Compute the image-charge interaction energy E_img.\n        # This is the electrostatic self-interaction in the periodic cell.\n        E_img = - (K_E * q**2 * Lz) / (24.0 * epsilon * A)\n\n        # 6. Compute the total FNV correction energy E_corr.\n        E_corr = q * C_align + E_img\n        results.append(E_corr)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}