{
    "hands_on_practices": [
        {
            "introduction": "在计算点缺陷的形成能之前，必须首先确定其所处的宏观热力学环境。这关键的一步涉及到定义材料组分元素的化学势，因为缺陷的形成能直接依赖于这些化学势。本练习  将指导您如何通过考虑主相化合物的稳定性和避免竞争相（如其他化学计量比的化合物或纯元素）的析出，来构建一个二元化合物中元素化学势的允许范围或“稳定窗口”。掌握这一技能对于确保缺陷形成能计算的物理意义至关重要。",
            "id": "3800266",
            "problem": "考虑一个在零温零压热力学框架下处理的二元化合物AB，该框架适用于第一性原理超胞缺陷计算。设元素的化学势用$\\mu_{A}$和$\\mu_{B}$表示，元素参考态分别为$\\mu_{A}^{\\text{ref}}$和$\\mu_{B}^{\\text{ref}}$。对于$i \\in \\{A,B\\}$，定义化学势偏差为$\\Delta \\mu_{i} \\equiv \\mu_{i} - \\mu_{i}^{\\text{ref}}$，并将零温下化合物$A_{x}B_{y}$每个化学式的生成焓定义为$\\Delta H_{f}(A_{x}B_{y}) \\equiv \\mu(A_{x}B_{y}) - x\\,\\mu_{A}^{\\text{ref}} - y\\,\\mu_{B}^{\\text{ref}}$。假设对于化学计量AB、$A_{2}B$和$AB_{2}$，$\\Delta H_{f}$是已知的，并且化合物AB是稳定不会分解的。\n\n从这些定义以及热力学要求（即与AB平衡时，没有其他相（包括纯元素）可以降低吉布斯自由能）出发，推导在$(\\Delta \\mu_{A}, \\Delta \\mu_{B})$平面中与AB的稳定性及竞争相不析出相符的允许区域。使用以下以电子伏特/化学式为单位给出的数据：$\\Delta H_{f}(\\text{AB}) = -0.70$、$\\Delta H_{f}(A_{2}B) = -1.10$ 以及 $\\Delta H_{f}(AB_{2}) = -0.90$。然后，确定沿着与AB平衡的线上$\\Delta \\mu_{A}$的允许区间的数值宽度。答案以电子伏特表示，并四舍五入到三位有效数字。",
            "solution": "问题要求确定在零温零压下，为使二元化合物AB保持稳定，元素A的化学势$\\mu_A$的热力学允许范围。这个范围通常被称为化学势稳定窗口。我们已知主体化合物AB和两个潜在竞争相$A_2B$与$AB_2$的生成焓。\n\n分析在相对于其参考态的化学势偏差空间中进行，定义为$\\Delta \\mu_{i} \\equiv \\mu_{i} - \\mu_{i}^{\\text{ref}}$，其中$i \\in \\{A,B\\}$。\n\n首先，我们建立元素组分与化合物AB之间的热力学平衡条件。在零温下，固体化合物的化学势是其每个化学式的总能量。对于A、B和化合物AB之间的两相平衡，化学势必须满足：\n$$ \\mu_A + \\mu_B = \\mu(AB) $$\n化合物$A_x B_y$的生成焓定义为$\\Delta H_{f}(A_{x}B_{y}) \\equiv \\mu(A_{x}B_{y}) - x\\,\\mu_{A}^{\\text{ref}} - y\\,\\mu_{B}^{\\text{ref}}$。对于AB，其生成焓为$\\Delta H_f(AB) = \\mu(AB) - \\mu_A^{\\text{ref}} - \\mu_B^{\\text{ref}}$。\n将定义代入平衡条件中：\n$$ (\\Delta \\mu_A + \\mu_A^{\\text{ref}}) + (\\Delta \\mu_B + \\mu_B^{\\text{ref}}) = \\Delta H_f(AB) + \\mu_A^{\\text{ref}} + \\mu_B^{\\text{ref}} $$\n这可以简化为化学势偏差之间的一个线性关系：\n$$ \\Delta \\mu_A + \\Delta \\mu_B = \\Delta H_f(AB) $$\n使用给定值$\\Delta H_f(AB) = -0.70$ eV，我们得到：\n$$ \\Delta \\mu_A + \\Delta \\mu_B = -0.70 \\quad (1) $$\n这个方程在$(\\Delta \\mu_A, \\Delta \\mu_B)$平面上定义了一条直线，在该直线上系统与AB化合物处于平衡状态。\n\n接下来，我们施加稳定性条件。为使化合物AB稳定，它必须比任何竞争相都更稳定。这意味着在其形成之前，不能有纯元素A或B或任何其他竞争化合物的析出。\n\n1.  **防止纯元素析出的稳定性：** 元素的化学势不能超过其在稳定元素参考相中的值。如果超过了，纯元素就会析出。\n    $$ \\mu_A \\le \\mu_A^{\\text{ref}} \\implies \\Delta \\mu_A \\le 0 $$\n    $$ \\mu_B \\le \\mu_B^{\\text{ref}} \\implies \\Delta \\mu_B \\le 0 $$\n    这些条件定义了富A ($\\Delta \\mu_A = 0$) 和富B ($\\Delta \\mu_B = 0$) 的极限。\n\n2.  **防止竞争化合物析出的稳定性：** 任何其他化合物 $A_x B_y$ 的形成在热力学上必须是不利的。这意味着其组分化学势的加权和必须小于或等于该化合物的化学势：\n    $$ x \\mu_A + y \\mu_B \\le \\mu(A_x B_y) $$\n    我们可以用 $\\Delta \\mu$ 和 $\\Delta H_f$ 来重写这个不等式：\n    $$ x (\\Delta \\mu_A + \\mu_A^{\\text{ref}}) + y (\\Delta \\mu_B + \\mu_B^{\\text{ref}}) \\le \\Delta H_f(A_x B_y) + x \\mu_A^{\\text{ref}} + y \\mu_B^{\\text{ref}} $$\n    $$ x \\Delta \\mu_A + y \\Delta \\mu_B \\le \\Delta H_f(A_x B_y) $$\n\n    将此应用于竞争相 $A_2 B$ 和 $AB_2$：\n    对于 $A_2 B$ ($x=2, y=1$)：\n    $$ 2 \\Delta \\mu_A + \\Delta \\mu_B \\le \\Delta H_f(A_2 B) $$\n    使用给定数据 $\\Delta H_f(A_2 B) = -1.10$ eV：\n    $$ 2 \\Delta \\mu_A + \\Delta \\mu_B \\le -1.10 \\quad (2) $$\n    对于 $AB_2$ ($x=1, y=2$)：\n    $$ \\Delta \\mu_A + 2 \\Delta \\mu_B \\le \\Delta H_f(AB_2) $$\n    使用给定数据 $\\Delta H_f(AB_2) = -0.90$ eV：\n    $$ \\Delta \\mu_A + 2 \\Delta \\mu_B \\le -0.90 \\quad (3) $$\n\n化学势的允许范围是平衡线(1)上满足所有稳定性不等式的线段。我们可以通过将平衡条件代入不等式中来找到这个范围。从方程(1)我们得到 $\\Delta \\mu_B = -0.70 - \\Delta \\mu_A$。\n\n将此代入不等式(2)：\n$$ 2 \\Delta \\mu_A + (-0.70 - \\Delta \\mu_A) \\le -1.10 $$\n$$ \\Delta \\mu_A - 0.70 \\le -1.10 $$\n$$ \\Delta \\mu_A \\le -0.40 $$\n这给出了 $\\Delta \\mu_A$ 的上限。这个边界对应于AB和$A_2B$之间的平衡。\n\n将 $\\Delta \\mu_B = -0.70 - \\Delta \\mu_A$ 代入不等式(3)：\n$$ \\Delta \\mu_A + 2 (-0.70 - \\Delta \\mu_A) \\le -0.90 $$\n$$ \\Delta \\mu_A - 1.40 - 2 \\Delta \\mu_A \\le -0.90 $$\n$$ - \\Delta \\mu_A \\le 0.50 $$\n$$ \\Delta \\mu_A \\ge -0.50 $$\n这给出了 $\\Delta \\mu_A$ 的下限。这个边界对应于AB和$AB_2$之间的平衡。\n\n来自纯元素的稳定性条件 $\\Delta \\mu_A \\le 0$ 和 $\\Delta \\mu_B \\le 0$ 也必须被检验。\n推导出的 $\\Delta \\mu_A$ 范围是 $[-0.50, -0.40]$。由于此范围内的所有值都小于或等于0，条件 $\\Delta \\mu_A \\le 0$ 得到满足。\n对于 $\\Delta \\mu_B \\le 0$，我们有 $-0.70 - \\Delta \\mu_A \\le 0$，这意味着 $\\Delta \\mu_A \\ge -0.70$。由于推导出的范围 $[-0.50, -0.40]$ 完全在 $[-0.70, \\infty)$ 之内，这个条件也得到满足。\n因此，竞争化合物$A_2B$和$AB_2$提供了比纯元素更严格的约束。\n\n沿着与AB平衡的线上$\\Delta \\mu_A$的完整允许区间是：\n$$ -0.50 \\le \\Delta \\mu_A \\le -0.40 $$\n这个允许区间的宽度代表了化合物AB的稳定范围，它是$\\Delta \\mu_A$的最大值与最小值之差：\n$$ \\text{宽度} = (\\text{max } \\Delta \\mu_A) - (\\text{min } \\Delta \\mu_A) = (-0.40) - (-0.50) = 0.10 \\, \\text{eV} $$\n问题要求将答案四舍五入到三位有效数字。\n$$ \\text{宽度} = 0.100 \\, \\text{eV} $$",
            "answer": "$$ \\boxed{0.100} $$"
        },
        {
            "introduction": "当获得了不同电荷态下缺陷的形成能后，下一步是分析这些能量如何随电子化学势（即费米能级 $E_F$）的变化而变化，从而揭示缺陷的电学行为。本练习  模拟了这一核心分析过程，您将学习如何确定不同电荷态之间的热力学转变能级，并识别出诸如“负U”行为等重要的物理现象。理解电荷转变能级对于预测半导体中缺陷的施主/受主特性以及它们如何影响材料的电学性质至关重要。",
            "id": "3800308",
            "problem": "在原子和电子的巨正则系综框架下，通过第一性原理总能计算研究了宽带隙半导体中的一个点缺陷 $D$。价带顶 $E_v$ 被设为电子库的能量零点。主体带隙为 $E_{\\mathrm{g}} = 2.4 \\text{ eV}$，因此费米能级 $E_F$ 相对于 $E_v$ 在 $0 \\leq E_F \\leq E_{\\mathrm{g}}$ 的范围内变化。计算了缺陷 $D$ 在五种电荷态 $q \\in \\{+2, +1, 0, -1, -2\\}$ 下的情况，其在三个费米能级位置处的形成能 $E_f(D^q)$ 报告如下（所有能量单位均为 $\\text{eV}$）：\n\n在 $E_F = 0.0 \\text{ eV}$ 处：$E_f(D^{+2}) = 1.0 \\text{ eV}$，$E_f(D^{+1}) = 1.5 \\text{ eV}$，$E_f(D^{0}) = 1.4 \\text{ eV}$，$E_f(D^{-1}) = 3.0 \\text{ eV}$，$E_f(D^{-2}) = 5.0 \\text{ eV}$。\n\n在 $E_F = 1.2 \\text{ eV}$ 处：$E_f(D^{+2}) = 3.4 \\text{ eV}$，$E_f(D^{+1}) = 2.7 \\text{ eV}$，$E_f(D^{0}) = 1.4 \\text{ eV}$，$E_f(D^{-1}) = 1.8 \\text{ eV}$，$E_f(D^{-2}) = 2.6 \\text{ eV}$。\n\n在 $E_F = 2.4 \\text{ eV}$ 处：$E_f(D^{+2}) = 5.8 \\text{ eV}$，$E_f(D^{+1}) = 3.9 \\text{ eV}$，$E_f(D^{0}) = 1.4 \\text{ eV}$，$E_f(D^{-1}) = 0.6 \\text{ eV}$，$E_f(D^{-2}) = 0.2 \\text{ eV}$。\n\n从带电荷态缺陷形成能的基本定义以及电子库的作用出发，推导出 $E_f(D^q)$ 对 $E_F$ 的依赖关系。利用所提供的数据，通过寻找使 $E_f(D^q)$ 和 $E_f(D^{q'})$ 相等且能量较低分支的电荷态发生改变的费米能级位置，确定在 $0 \\leq E_F \\leq E_{\\mathrm{g}}$ 范围内的所有热力学电荷态转变能级 $\\epsilon(q/q')$。根据这些转变能级，计算出在整个带隙范围内的稳定电荷态集合，并评估该缺陷是否表现出负U行为。负U行为定义为：在整个带隙范围内，两个q值相差为2的稳定电荷态之间，不存在一个稳定的中间电荷态。如果存在负U行为，通过计算在价带顶处形成能的二阶差分，求出被跳过的中间态的有效关联能。\n\n将所有报告的能量四舍五入至四位有效数字。能量以 $\\text{eV}$ 为单位表示。在最终答案中，按顺序报告三个转变能级（从低到高 $E_F$）和被跳过的中间态的有效关联能（如果存在）。",
            "solution": "我们从点缺陷 $D$ 在电荷态 $q$ 下与原子库和电子库交换原子和电子的形成能的标准巨正则表述开始。在费米能级 $E_F$（以价带顶 $E_v$ 为参考）处的形成能为\n$$\nE_f(D^q; E_F) = E_{\\mathrm{tot}}(D^q) - E_{\\mathrm{tot}}(\\mathrm{bulk}) + \\sum_i n_i \\mu_i + q\\,(E_F + E_v) + E_{\\mathrm{corr}}(q),\n$$\n其中 $E_{\\mathrm{tot}}(D^q)$ 和 $E_{\\mathrm{tot}}(\\mathrm{bulk})$ 分别是含缺陷超胞和完美超胞的总能量，$n_i$ 和 $\\mu_i$ 分别是组分 $i$ 的化学计量偏差和化学势，$q$ 是整数表示的缺陷电荷（以基本电荷为单位），$E_{\\mathrm{corr}}(q)$ 是有限尺寸和静电修正项。将 $E_v$ 设为能量参考零点，对 $E_F$ 的显式依赖关系简化为\n$$\n\\frac{\\partial E_f(D^q; E_F)}{\\partial E_F} = q,\n$$\n因此 $E_f(D^q; E_F)$ 是 $E_F$ 的线性函数，斜率为 $q$。因此，对于每个 $q$，我们可以写出\n$$\nE_f(D^q; E_F) = A_q + q\\,E_F,\n$$\n其中 $A_q \\equiv E_f(D^q; E_F=0)$ 是在价带顶处的截距。所提供的在 $E_F = 0.0 \\text{ eV}$ 处的数据直接给出了这些截距：\n$$\nA_{+2} = 1.0,\\quad A_{+1} = 1.5,\\quad A_0 = 1.4,\\quad A_{-1} = 3.0,\\quad A_{-2} = 5.0,\n$$\n单位均为 $\\text{eV}$。在 $E_F = 1.2 \\text{ eV}$ 和 $E_F = 2.4 \\text{ eV}$ 处的额外数据点与该线性形式及斜率 $q$ 一致：\n- 对于 $q=+2$：$A_{+2} + 2\\times 1.2 = 1.0 + 2.4 = 3.4$ 以及 $A_{+2} + 2\\times 2.4 = 1.0 + 4.8 = 5.8$。\n- 对于 $q=+1$：$A_{+1} + 1\\times 1.2 = 1.5 + 1.2 = 2.7$ 以及 $A_{+1} + 1\\times 2.4 = 1.5 + 2.4 = 3.9$。\n- 对于 $q=0$：$A_0 + 0\\times E_F = 1.4$ 对所有 $E_F$ 成立。\n- 对于 $q=-1$：$A_{-1} - 1\\times 1.2 = 3.0 - 1.2 = 1.8$ 以及 $A_{-1} - 1\\times 2.4 = 3.0 - 2.4 = 0.6$。\n- 对于 $q=-2$：$A_{-2} - 2\\times 1.2 = 5.0 - 2.4 = 2.6$ 以及 $A_{-2} - 2\\times 2.4 = 5.0 - 4.8 = 0.2$。\n\n热力学转变能级 $\\epsilon(q/q')$（相对于 $E_v$）由 $E_f(D^q; E_F)$ 等于 $E_f(D^{q'}; E_F)$ 且能量最低分支的电荷态发生改变的费米能级位置给出。求解 $A_q + q E_F = A_{q'} + q' E_F$ 可得\n$$\n\\epsilon(q/q') = \\frac{A_{q'} - A_q}{q - q'}.\n$$\n我们计算带隙 $0 \\leq E_F \\leq 2.4$ 内的相关交点：\n\n1. 在 $q=+2$ 和 $q=0$ 之间：\n$$\n\\epsilon(+2/0) = \\frac{A_0 - A_{+2}}{2 - 0} = \\frac{1.4 - 1.0}{2} = 0.2 \\text{ eV}.\n$$\n与 $q=+1$ 比较，我们注意到 $\\epsilon(+2/+1) = \\frac{A_{+1} - A_{+2}}{2 - 1} = 0.5 \\text{ eV}$，但对于 $E_F > 0.2 \\text{ eV}$，$q=0$ 分支的能量已经低于 $q=+1$ 分支，因为 $E_f(D^0; E_F) = 1.4$ 而 $E_f(D^{+1}; E_F) = 1.5 + E_F$。交点 $\\epsilon(+1/0) = A_0 - A_{+1} = -0.1 \\text{ eV}$ 位于带隙之外。因此，第一个转变是在 $E_F = 0.2 \\text{ eV}$ 处直接从 $+2 \\to 0$，而 $q=+1$ 在带隙内从未是热力学稳定的。\n\n2. 在 $q=0$ 和 $q=-1$ 之间：\n$$\n\\epsilon(0/-1) = \\frac{A_{-1} - A_0}{0 - (-1)} = 3.0 - 1.4 = 1.6 \\text{ eV}.\n$$\n\n3. 在 $q=-1$ 和 $q=-2$ 之间：\n$$\n\\epsilon(-1/-2) = \\frac{A_{-2} - A_{-1}}{-1 - (-2)} = 5.0 - 3.0 = 2.0 \\text{ eV}.\n$$\n\n这些是 $0 \\leq E_F \\leq 2.4 \\text{ eV}$ 范围内的仅有的交点。因此，在带隙范围内的稳定电荷态序列为：\n- 对于 $0 \\leq E_F  0.2 \\text{ eV}$：$q=+2$ 能量最低。\n- 对于 $0.2 \\text{ eV} \\leq E_F  1.6 \\text{ eV}$：$q=0$ 能量最低。\n- 对于 $1.6 \\text{ eV} \\leq E_F  2.0 \\text{ eV}$：$q=-1$ 能量最低。\n- 对于 $2.0 \\text{ eV} \\leq E_F \\leq 2.4 \\text{ eV}$：$q=-2$ 能量最低。\n\n从 $+2$ 直接转变为 $0$ 而 $+1$ 态不稳定，这表明存在以中间电荷 $q=+1$ 为中心的负U行为。量化跳过 $q=+1$ 态的有效关联能可以定义为在价带顶处的二阶差分，\n$$\nU_{\\mathrm{eff}}(q=+1) = A_{+2} + A_0 - 2 A_{+1}.\n$$\n使用截距值，\n$$\nU_{\\mathrm{eff}}(+1) = 1.0 + 1.4 - 2\\times 1.5 = 2.4 - 3.0 = -0.6 \\text{ eV}.\n$$\n负值证实了 $+1$ 中间态具有负U特性。在负电荷一侧没有发生跳过现象，因为 $q=-1$ 和 $q=-2$ 都在有限的 $E_F$ 区间内是稳定的。\n\n将每个报告的能量四舍五入至四位有效数字，我们得到三个转变能级和有效关联能分别为 $0.2000 \\text{ eV}$、$1.600 \\text{ eV}$、$2.000 \\text{ eV}$ 和 $-0.6000 \\text{ eV}$。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.2000  1.600  2.000  -0.6000\\end{pmatrix}}$$"
        },
        {
            "introduction": "在周期性超胞中进行的缺陷计算，尤其是带电缺陷，会不可避免地引入因系统尺寸有限而产生的系统误差。验证和消除这些误差是获得可靠结果的关键。本练习  介绍了一种重要的验证技术——有限尺寸标度分析。通过系统地研究计算得到的形成能如何随超胞尺寸 $L$ 变化，您可以将结果外推到无限大尺寸的极限（即物理上准确的值），并评估所采用的修正方案的有效性。",
            "id": "3800237",
            "problem": "在多尺度材料模拟中，为了验证对周期性超胞计算应用修正方案后缺陷形成能中的残余误差，需要进行有限尺寸标度分析。考虑一个在周期性边界条件和中和背景电荷下模拟的带电或中性点缺陷，其周期性镜像之间的伪相互作用会给计算出的形成能带来一个与尺寸相关的误差。这个误差可以通过经典静电学的泊松方程和多极展开来合理解释，从而得出与线性超胞尺寸相关的特征性幂律依赖关系。任务是实现一个程序，在给定多个超胞尺寸的情况下，将修正后的形成能拟合到一组候选的幂律标度关系上，以确定残余标度指数和无限尺寸外推的形成能。\n\n基本原理：\n- 在均匀介电介质中，静电势遵循泊松方程 $-\\nabla \\cdot \\left( \\varepsilon \\nabla \\phi(\\mathbf{r}) \\right) = \\rho(\\mathbf{r})$。\n- 电荷分布 $ \\rho(\\mathbf{r}) $ 与其周期性镜像相互作用的能量可以通过 Ewald 求和与多极展开来理解，这意味着伪能量项与线性超胞维度 $L$ 的逆幂成标度关系，其中领头项取决于净电荷，而更高阶项取决于偶极矩和四极矩。\n- 在应用了消除某些主要贡献项的修正后，残余误差通常遵循一个关于 $L$ 的更高次幂的逆幂律。\n\n你的任务是：\n1. 对每个提供的测试用例，使用指定的逆幂贡献系数和固定的确定性偏移，合成在多个超胞尺寸 $L$ 下的修正或未修正的形成能。每个合成的能量 $E(L)$ 必须按如下公式计算\n   $$ E(L) = E_{\\infty} + \\sum_{k \\in \\{1,3,5\\}} c_k L^{-k} + \\delta(L), $$\n   其中 $E_{\\infty}$ 是无限尺寸形成能，单位为电子伏特 (eV)；$c_k$ 是具有相应单位 (eV$\\cdot$Å$^k$) 的系数；$L$ 的单位为埃 (Å)；$\\delta(L)$ 是确定性偏移，单位为电子伏特 (eV)。\n2. 对每个测试用例，通过比较 $E(L)$ 与 $L^{-p}$ 对候选指数 $p \\in \\{1,3,5\\}$ 的普通最小二乘拟合来确定残余标度指数，使用以下形式的模型\n   $$ E(L) \\approx a + b \\, L^{-p}. $$\n   选择使给定超胞尺寸范围内的均方根残差最小化的指数 $p$。将最佳拟合的截距 $a$ 作为无限尺寸形成能的估计值。\n3. 验证所选修正方案的预期残余指数是否与最佳拟合指数匹配。\n4. 对每个测试用例，报告估计的无限尺寸形成能（单位为电子伏特(eV)，四舍五入到六位小数）、最佳拟合指数（整数）以及一个布尔值，该布尔值指示最佳拟合指数是否与预期指数匹配。\n\n物理和数值单位：\n- 所有超胞尺寸 $L$ 必须以埃 (Å) 为单位。\n- 所有能量 $E(L)$、$E_{\\infty}$ 和偏移量 $\\delta(L)$ 必须以电子伏特 (eV) 为单位。\n- 最终报告的能量必须四舍五入到六位小数。\n\n角度单位不适用。\n\n测试套件：\n- 使用固定的超胞尺寸 $L = [10.0, 12.0, 16.0, 20.0, 24.0, 30.0]$ (Å)。\n- 对于相应的 $L$，使用固定的确定性偏移 $\\delta(L)$（单位 eV）：$[0.0008, -0.0005, 0.0004, -0.0003, 0.0006, -0.0004]$。\n\n定义五个测试用例，每个用例指定一个修正方案标签、预期的残余指数 $p_{\\mathrm{exp}}$、无限尺寸能量 $E_{\\infty}$ 以及系数 $c_1$、$c_3$、$c_5$（单位为 eV$\\cdot$Å$^k$）：\n- 用例1：未应用修正（带电缺陷）。\n  - 方案标签：\"none\"\n  - $p_{\\mathrm{exp}} = 1$\n  - $E_{\\infty} = 2.000$ (eV)\n  - $c_1 = 0.40$, $c_3 = 1.20$, $c_5 = 0.00$\n- 用例2：应用了领头单极修正。\n  - 方案标签：\"MP1\"\n  - $p_{\\mathrm{exp}} = 3$\n  - $E_{\\infty} = 3.150$ (eV)\n  - $c_1 = 0.00$, $c_3 = 2.00$, $c_5 = 50.00$\n- 用例3：应用了领头单极和次阶四极修正。\n  - 方案标签：\"MP1+MP3\"\n  - $p_{\\mathrm{exp}} = 5$\n  - $E_{\\infty} = 1.125$ (eV)\n  - $c_1 = 0.00$, $c_3 = 0.00$, $c_5 = 40.00$\n- 用例4：中性缺陷（无净电荷，无修正）。\n  - 方案标签：\"none\"\n  - $p_{\\mathrm{exp}} = 3$\n  - $E_{\\infty} = 0.750$ (eV)\n  - $c_1 = 0.00$, $c_3 = 0.80$, $c_5 = 0.00$\n- 用例5：在高屏蔽介质中应用单极修正（残余项很小）。\n  - 方案标签：\"MP1\"\n  - $p_{\\mathrm{exp}} = 3$\n  - $E_{\\infty} = 2.500$ (eV)\n  - $c_1 = 0.00$, $c_3 = 1.60$, $c_5 = 6.00$\n\n算法要求：\n- 对每个候选指数 $p \\in \\{1,3,5\\}$，使用普通最小二乘法将 $E(L)$ 拟合到 $a + b L^{-p}$。\n- 计算每次拟合的均方根残差，并选择具有最小值的 $p$。\n- 无限尺寸能量的估计值是所选拟合的截距 $a$。\n- 将最终的 $a$ 四舍五入到六位小数。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素都是一个形式为 $[E_{\\infty}^{\\mathrm{est}}, p_{\\mathrm{best}}, \\mathrm{match}]$ 的列表。例如，输出应类似于 $[[e_1,p_1,m_1],[e_2,p_2,m_2],\\dots]$，其中 $e_i$ 是一个四舍五入到六位小数的浮点数（单位 eV），$p_i$ 是一个整数，$m_i$ 是一个布尔值。",
            "solution": "该问题要求执行有限尺寸标度分析，以确定在周期性超胞中模拟的点缺陷的外推无限尺寸形成能和残余标度指数。这是计算材料科学中的一个标准验证程序，用于评估针对缺陷与其周期性镜像之间伪静电相互作用的修正方案的准确性。\n\n基本原理是，使用周期性边界条件计算的含带电缺陷系统的总能量包含一个与尺寸相关的人为能量项。该项源于缺陷电荷分布与其自身周期性镜像之间的静电相互作用。基于泊松方程 $-\\nabla \\cdot \\left( \\varepsilon \\nabla \\phi(\\mathbf{r}) \\right) = \\rho(\\mathbf{r})$ 和电荷相互作用的多极展开，这个伪能量可以表示为线性超胞维度 $L$ 逆幂的级数。对于带电缺陷（非零单极矩），领头误差项的标度关系为 $L^{-1}$。对于中性缺陷，或 $L^{-1}$ 项已被修正的带电缺陷，领头误差项通常的标度关系为 $L^{-3}$（源于单极-四极或偶极-偶极相互作用）。进一步的修正可以消除此项，留下标度关系为 $L^{-5}$ 或更高次的残余误差。因此，在有限尺寸 $L$ 下计算的形成能 $E(L)$ 与真实的无限尺寸能量 $E_{\\infty}$ 通过以下形式的表达式相关联：\n$$ E(L) \\approx E_{\\infty} + c_1 L^{-1} + c_3 L^{-3} + c_5 L^{-5} + \\dots $$\n其中系数 $c_k$ 取决于缺陷的电荷、偶极矩和四极矩，以及主体材料的介电性质。\n\n解决此问题的算法对每个提供的测试用例都遵循一个四步过程。\n\n首先，我们为一组固定的超胞尺寸 $L = [10.0, 12.0, 16.0, 20.0, 24.0, 30.0]$ Å 合成一组“原始”形成能 $E(L)$。此步骤模拟了运行数个计算成本高昂的模拟的过程。每个尺寸 $L$ 的能量使用提供的模型计算：\n$$ E(L) = E_{\\infty} + \\sum_{k \\in \\{1,3,5\\}} c_k L^{-k} + \\delta(L) $$\n其中 $E_{\\infty}$、系数 $c_1$、$c_3$、$c_5$ 以及预期的残余指数 $p_{\\mathrm{exp}}$ 对每个测试用例都是特定的。项 $\\delta(L)$ 代表预定义的确定性偏移，用以模拟简化的幂律模型中未捕捉到的数值噪声或更高阶的物理效应。\n\n其次，我们分析合成的 $E(L)$ 数据，以确定哪种幂律最能描述其对 $L$ 的依赖关系。我们提出三种候选线性模型：\n$$ E(L) \\approx a + b \\, L^{-p} $$\n针对候选指数 $p \\in \\{1, 3, 5\\}$。对每个 $p$，我们执行一次普通最小二乘（OLS）回归，以找到最佳截距 $a$ 和斜率 $b$。在此线性模型中，因变量为 $y = E(L)$，自变量为 $x = L^{-p}$。此次拟合的截距 $a$ 提供了无限尺寸形成能的估计值 $E_{\\infty}^{\\mathrm{est}}$。\n\n第三，为选择最合适的模型，我们通过计算均方根残差（RMSE）来量化每个候选指数 $p$ 的拟合优度：\n$$ \\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (E(L_i) - (a + b L_i^{-p}))^2} $$\n其中 $N$ 是数据点（超胞尺寸）的数量。产生最小 RMSE 的指数 $p$ 被选为最佳拟合指数 $p_{\\mathrm{best}}$。这标志着合成数据中存在的主导幂律行为。\n\n第四，我们最终确定该测试用例的结果。估计的无限尺寸能量是来自最佳拟合模型的截距 $a$，然后四舍五入到六位小数。我们还通过比较经验确定的最佳拟合指数 $p_{\\mathrm{best}}$ 与模拟的修正方案的理论预期指数 $p_{\\mathrm{exp}}$ 来判断分析是否成功。此比较得出一个布尔值。每个用例的最终输出是一个列表，包含估计能量 $E_{\\infty}^{\\mathrm{est}}$、最佳拟合指数 $p_{\\mathrm{best}}$ 和布尔匹配标志。\n\n整个过程用 Python 实现。我们使用 `numpy` 库进行高效的基于数组的计算，并使用 `scipy.stats.linregress` 函数执行 OLS 回归，因为它为此任务提供了直接且数值稳定的实现。代码会遍历所有指定的测试用例，并按要求将结果汇总到单个格式化的输出字符串中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Solves the finite-size scaling problem for defect formation energies.\n    \"\"\"\n    \n    # Fixed supercell sizes L in ångström (Å).\n    L = np.array([10.0, 12.0, 16.0, 20.0, 24.0, 30.0])\n    \n    # Fixed deterministic offsets delta(L) in electronvolts (eV).\n    delta_L = np.array([0.0008, -0.0005, 0.0004, -0.0003, 0.0006, -0.0004])\n    \n    # Candidate exponents for the power-law fit.\n    p_candidates = [1, 3, 5]\n\n    # Test suite definition. Each tuple contains:\n    # (p_exp, E_inf, c1, c3, c5)\n    test_cases = [\n        # Case 1: No correction applied (charged defect).\n        (1, 2.000, 0.40, 1.20, 0.00),\n        # Case 2: Leading monopole correction applied.\n        (3, 3.150, 0.00, 2.00, 50.00),\n        # Case 3: Leading monopole and next-order quadrupole corrections applied.\n        (5, 1.125, 0.00, 0.00, 40.00),\n        # Case 4: Neutral defect (no net charge, no correction).\n        (3, 0.750, 0.00, 0.80, 0.00),\n        # Case 5: Monopole correction applied in a highly screening medium.\n        (3, 2.500, 0.00, 1.60, 6.00),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        p_exp, E_inf, c1, c3, c5 = case\n\n        # Step 1: Synthesize formation energies E(L).\n        E_L = E_inf + c1 * L**-1 + c3 * L**-3 + c5 * L**-5 + delta_L\n\n        best_p = -1\n        min_rmse = float('inf')\n        best_intercept = 0.0\n\n        # Step 2: Fit E(L) to a + b * L^-p for each candidate p.\n        for p in p_candidates:\n            # Independent variable for linear regression.\n            x_data = L**(-p)\n            y_data = E_L\n            \n            # Perform ordinary least squares regression using scipy.stats.\n            # model: y = intercept + slope * x\n            slope, intercept, r_value, p_value, std_err = stats.linregress(x_data, y_data)\n            \n            # Step 3: Compute the root-mean-square residual (RMSE).\n            y_pred = intercept + slope * x_data\n            residuals = y_data - y_pred\n            rmse = np.sqrt(np.mean(residuals**2))\n            \n            # Check if this fit is better than the previous best.\n            if rmse  min_rmse:\n                min_rmse = rmse\n                best_p = p\n                best_intercept = intercept\n        \n        # Step 4: Record results for the current case.\n        E_inf_est = round(best_intercept, 6)\n        p_best = best_p\n        is_match = (p_best == p_exp)\n        \n        results.append([E_inf_est, p_best, is_match])\n\n    # Final print statement in the exact required format.\n    # The default str() representation of a list containing lists and booleans\n    # matches the required output format.\n    final_output_string = \"[\" + \",\".join(map(str, results)) + \"]\"\n    print(final_output_string.replace(\" \", \"\").replace(\"True\", \"true\").replace(\"False\", \"false\"))\n\nsolve()\n```"
        }
    ]
}