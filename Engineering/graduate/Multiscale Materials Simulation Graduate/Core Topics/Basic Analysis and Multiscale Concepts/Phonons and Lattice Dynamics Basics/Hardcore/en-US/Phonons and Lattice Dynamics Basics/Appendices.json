{
    "hands_on_practices": [
        {
            "introduction": "The one-dimensional diatomic chain is the canonical model for understanding the vibrational modes in crystals with a basis. This practice will guide you through deriving the phonon dispersion relation $\\omega(q)$ from first principles, revealing the existence of two distinct types of collective motion: acoustic and optical branches. By analyzing the atomic displacements in the long-wavelength limit , you will gain a fundamental physical intuition for in-phase and out-of-phase vibrations, which is crucial for interpreting phonon spectra.",
            "id": "3832848",
            "problem": "Consider an infinite one-dimensional crystal composed of a repeated basis of two atoms per primitive cell, with masses $m_1$ and $m_2$, separated by a lattice constant $a$. Neighboring atoms interact via identical harmonic springs of force constant $K$, and only nearest-neighbor interactions are present. Let the displacements of the two sublattices from equilibrium in cell index $n$ be $u_n$ for the $m_1$ mass and $v_n$ for the $m_2$ mass. Assume small-amplitude vibrations so that Hooke's law applies and linear superposition is valid. Using Newton's second law and a plane-wave ansatz consistent with discrete translational symmetry, derive the lattice dynamical equations, obtain the dispersion relation $\\omega(q)$ for the two branches, and determine the $q \\to 0$ limits of the acoustic and optical branch frequencies.\n\nIn addition, identify the corresponding eigenvectors in the $q \\to 0$ limit and explain, from first principles, the physical interpretation of in-phase versus out-of-phase motions of the two sublattices, including how total momentum and center-of-mass motion enter for the acoustic branch, and how internal relative motion enters for the optical branch.\n\nYour final output must be the exact closed-form analytic expressions for $\\lim_{q \\to 0} \\omega_{\\text{ac}}(q)$ and $\\lim_{q \\to 0} \\omega_{\\text{op}}(q)$, expressed in terms of $m_1$, $m_2$, and $K$. Express the final result as a row matrix with entries $\\lim_{q \\to 0} \\omega_{\\text{ac}}(q)$ and $\\lim_{q \\to 0} \\omega_{\\text{op}}(q)$, respectively. Provide exact expressions; do not include units in your final expressions.",
            "solution": "The problem statement has been critically validated and is deemed valid. It is a well-posed, scientifically grounded problem central to the study of lattice dynamics, free of any ambiguities, contradictions, or factual unsoundness.\n\nWe consider an infinite one-dimensional crystal with a two-atom basis. Let the masses be $m_1$ and $m_2$. The primitive cell has length $a$. The simplest arrangement is a linear chain of alternating masses. Let the equilibrium position of the atom with mass $m_1$ in the $n$-th primitive cell be $x_{n,1}^{(0)} = na$, and the atom with mass $m_2$ in the $n$-th cell be $x_{n,2}^{(0)} = na + a/2$. The distance between any two adjacent atoms is $a/2$. The atoms interact with their nearest neighbors via a harmonic potential characterized by a spring constant $K$. Let $u_n$ and $v_n$ be the longitudinal displacements from equilibrium for masses $m_1$ and $m_2$ in the $n$-th cell, respectively.\n\nWe apply Newton's second law to each mass in the $n$-th cell.\nThe atom of mass $m_1$ at position $na+u_n$ is coupled to the atom of mass $m_2$ in the same cell at position $na+a/2+v_n$ and the atom of mass $m_2$ in the previous cell, $(n-1)$, at position $(n-1)a+a/2+v_{n-1}$. The equation of motion for mass $m_1$ is:\n$$m_1 \\frac{d^2 u_n}{dt^2} = F_{n,1} = K[(v_n-u_n)] + K[(v_{n-1}-u_n)]$$\n$$m_1 \\ddot{u}_n = K(v_n + v_{n-1} - 2u_n)$$\n\nThe atom of mass $m_2$ at position $na+a/2+v_n$ is coupled to the atom of mass $m_1$ in the next cell, $(n+1)$, at position $(n+1)a+u_{n+1}$ and the atom of mass $m_1$ in the same cell at position $na+u_n$. The equation of motion for mass $m_2$ is:\n$$m_2 \\frac{d^2 v_n}{dt^2} = F_{n,2} = K[(u_{n+1}-v_n)] + K[(u_n-v_n)]$$\n$$m_2 \\ddot{v}_n = K(u_{n+1} + u_n - 2v_n)$$\n\nWe seek plane-wave solutions consistent with the discrete translational symmetry of the lattice. For a wave with wavevector $q$ and angular frequency $\\omega$, the displacements can be written as:\n$$u_n(t) = u \\exp[i(qna - \\omega t)]$$\n$$v_n(t) = v \\exp[i(qna - \\omega t)]$$\nHere, $u$ and $v$ are the complex amplitudes for the two atoms in the basis. Substituting these into the equations of motion:\nFor $m_1$:\n$$-m_1 \\omega^2 u \\exp[i(qna - \\omega t)] = K(v \\exp[i(qna - \\omega t)] + v \\exp[i(q(n-1)a - \\omega t)] - 2u \\exp[i(qna - \\omega t)])$$\nDividing by $\\exp[i(qna - \\omega t)]$:\n$$-m_1 \\omega^2 u = K(v + v e^{-iqa} - 2u)$$\n$$(2K - m_1 \\omega^2)u - K(1 + e^{-iqa})v = 0$$\n\nFor $m_2$:\n$$-m_2 \\omega^2 v \\exp[i(qna - \\omega t)] = K(u \\exp[i(q(n+1)a - \\omega t)] + u \\exp[i(qna - \\omega t)] - 2v \\exp[i(qna - \\omega t)])$$\nDividing by $\\exp[i(qna - \\omega t)]$:\n$$-m_2 \\omega^2 v = K(u e^{iqa} + u - 2v)$$\n$$-K(1 + e^{iqa})u + (2K - m_2 \\omega^2)v = 0$$\n\nThese two homogeneous linear equations for the amplitudes $u$ and $v$ can be written in matrix form:\n$$\n\\begin{pmatrix}\n2K - m_1 \\omega^2  -K(1 + e^{-iqa}) \\\\\n-K(1 + e^{iqa})  2K - m_2 \\omega^2\n\\end{pmatrix}\n\\begin{pmatrix}\nu \\\\\nv\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\nFor a non-trivial solution to exist, the determinant of the coefficient matrix (the dynamical matrix) must be zero. This gives the secular equation for the dispersion relation $\\omega(q)$:\n$$(2K - m_1 \\omega^2)(2K - m_2 \\omega^2) - K^2(1 + e^{-iqa})(1 + e^{iqa}) = 0$$\nThe product $(1 + e^{-iqa})(1 + e^{iqa}) = |1+e^{iqa}|^2 = (1+\\cos(qa))^2 + \\sin^2(qa) = 2+2\\cos(qa) = 4\\cos^2(qa/2)$.\nThe secular equation becomes:\n$$(2K - m_1 \\omega^2)(2K - m_2 \\omega^2) - 4K^2\\cos^2(qa/2) = 0$$\n$$m_1 m_2 \\omega^4 - 2K(m_1+m_2)\\omega^2 + 4K^2 - 4K^2\\cos^2(qa/2) = 0$$\nUsing the identity $1 - \\cos^2(\\theta) = \\sin^2(\\theta)$:\n$$m_1 m_2 \\omega^4 - 2K(m_1+m_2)\\omega^2 + 4K^2\\sin^2(qa/2) = 0$$\nThis is a quadratic equation for $\\omega^2$. Solving for $\\omega^2$:\n$$\\omega^2(q) = \\frac{2K(m_1+m_2) \\pm \\sqrt{4K^2(m_1+m_2)^2 - 16K^2m_1m_2\\sin^2(qa/2)}}{2m_1m_2}$$\n$$\\omega^2(q) = K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right) \\pm K\\sqrt{\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right)^2 - \\frac{4\\sin^2(qa/2)}{m_1m_2}}$$\nThis yields two solutions for $\\omega^2$ for each $q$, corresponding to two phonon branches. The upper branch (with the $+$ sign) is the optical branch, and the lower branch (with the $-$ sign) is the acoustic branch.\n\nTo find the limits as $q \\to 0$, we set $q=0$ in the dispersion relation. In this limit, $\\sin(qa/2) = 0$.\n$$\\lim_{q\\to 0} \\omega^2(q) = K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right) \\pm K\\sqrt{\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right)^2} = K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right) \\pm K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right)$$\nFor the acoustic branch (lower sign):\n$$\\lim_{q\\to 0} \\omega_{\\text{ac}}^2(q) = K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right) - K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right) = 0$$\n$$\\lim_{q\\to 0} \\omega_{\\text{ac}}(q) = 0$$\nFor the optical branch (upper sign):\n$$\\lim_{q\\to 0} \\omega_{\\text{op}}^2(q) = K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right) + K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right) = 2K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right)$$\n$$\\lim_{q\\to 0} \\omega_{\\text{op}}(q) = \\sqrt{2K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right)}$$\n\nNext, we analyze the eigenvectors, which describe the relative motion of the atoms. The ratio of the amplitudes $u/v$ is found from the first equation of motion:\n$$\\frac{u}{v} = \\frac{K(1 + e^{-iqa})}{2K - m_1 \\omega^2}$$\nIn the limit $q \\to 0$, $e^{-iqa} \\to 1$.\n\nFor the acoustic branch, as $q \\to 0$, we have $\\omega^2 \\to \\omega_{\\text{ac}}^2(0) = 0$. The amplitude ratio is:\n$$\\lim_{q \\to 0} \\left(\\frac{u}{v}\\right)_{\\text{ac}} = \\frac{K(1+1)}{2K - m_1(0)} = \\frac{2K}{2K} = 1$$\nThus, $u=v$. This signifies that the two atoms in the primitive cell move in phase and with the same amplitude. The entire unit cell moves as a rigid body. This corresponds to a long-wavelength sound wave where adjacent planes of atoms slide past each other. The center of mass of the unit cell, whose displacement is $\\delta R_{CM} = (m_1 u_n + m_2 v_n)/(m_1+m_2)$, is clearly displaced since $u_n=v_n \\neq 0$. This motion carries momentum, which is a key characteristic of acoustic waves.\n\nFor the optical branch, as $q \\to 0$, we have $\\omega^2 \\to \\omega_{\\text{op}}^2(0) = 2K(1/m_1+1/m_2)$. The amplitude ratio is:\n$$\\lim_{q \\to 0} \\left(\\frac{u}{v}\\right)_{\\text{op}} = \\frac{K(1+1)}{2K - m_1 \\left[2K(\\frac{1}{m_1}+\\frac{1}{m_2})\\right]} = \\frac{2K}{2K - 2K - 2K\\frac{m_1}{m_2}} = \\frac{2K}{-2K\\frac{m_1}{m_2}} = -\\frac{m_2}{m_1}$$\nThus, $m_1 u = -m_2 v$. This means the atoms move out of phase, in opposite directions. The momentum of the unit cell is $P_{\\text{cell}} = m_1 \\dot{u}_n + m_2 \\dot{v}_n$. Since $m_1 u_n = -m_2 v_n$, it follows that $m_1 \\dot{u}_n + m_2 \\dot{v}_n = 0$. The center of mass of the unit cell remains stationary. This is an internal vibration mode where the atoms oscillate against each other. If the atoms carry opposite charges (as in an ionic crystal), this oscillating dipole can be excited by an external electromagnetic field (light), hence the name \"optical\" branch. It represents an internal, relative motion within the cell, not a translation of the cell as a whole.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0  \\sqrt{2K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right)} \\end{pmatrix}}$$"
        },
        {
            "introduction": "While discrete lattice models are fundamental, many macroscopic properties are described by continuum theories. This practice bridges that gap by exploring the long-wavelength limit of lattice vibrations, where they manifest as sound waves. By starting from the equations of linear elastodynamics , you will derive the speeds of longitudinal and transverse waves in a cubic crystal, connecting microscopic phonon behavior directly to macroscopic elastic constants.",
            "id": "3832828",
            "problem": "Consider a homogeneous cubic crystalline solid in the long-wavelength (continuum) limit, modeled by linear elasticity. Let the mass density be $\\rho$ (in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$), and the elastic stiffness tensor $C_{ijkl}$ possess cubic symmetry characterized by the independent constants $C_{11}$, $C_{12}$, and $C_{44}$ (in $\\mathrm{Pa}$). A small-amplitude mechanical disturbance propagates along the crystallographic direction $\\left[100\\right]$.\n\nStarting only from the fundamental linear elastodynamic equations for an anisotropic homogeneous medium,\n$$\\rho\\,\\ddot{u}_{i}=\\partial_{j}\\sigma_{ij},\\quad \\sigma_{ij}=C_{ijkl}\\,\\varepsilon_{kl},\\quad \\varepsilon_{kl}=\\tfrac{1}{2}\\left(\\partial_{k}u_{l}+\\partial_{l}u_{k}\\right),$$\nand the cubic-symmetry specialization of $C_{ijkl}$, determine the longitudinal and the (degenerate) transverse sound speeds for propagation along $\\left[100\\right]$.\n\nReport the final speeds as closed-form analytic expressions in terms of $C_{11}$, $C_{44}$, and $\\rho$. Use International System of Units (SI) so that the speeds are in $\\mathrm{m}\\,\\mathrm{s}^{-1}$. No numerical substitution or rounding is required. Provide the two speeds as a row, with the longitudinal speed first, followed by the transverse speed.",
            "solution": "The problem requires the derivation of the longitudinal and transverse sound speeds for a mechanical wave propagating along the $\\left[100\\right]$ crystallographic direction in a homogeneous cubic solid, starting from the fundamental equations of linear elastodynamics.\n\nThe governing equations provided are:\nThe equation of motion:\n$$\n\\rho\\,\\ddot{u}_{i}=\\partial_{j}\\sigma_{ij}\n$$\nThe linear constitutive relation (Hooke's Law):\n$$\n\\sigma_{ij}=C_{ijkl}\\,\\varepsilon_{kl}\n$$\nThe infinitesimal strain-displacement relation:\n$$\n\\varepsilon_{kl}=\\tfrac{1}{2}\\left(\\partial_{k}u_{l}+\\partial_{l}u_{k}\\right)\n$$\nHere, $\\rho$ is the mass density, $u_i$ is the $i$-th component of the displacement vector $\\mathbf{u}$, $\\sigma_{ij}$ is the Cauchy stress tensor, $\\varepsilon_{kl}$ is the infinitesimal strain tensor, and $C_{ijkl}$ is the rank-$4$ elastic stiffness tensor. The notation $\\ddot{u}_i$ denotes the second partial derivative with respect to time, $\\frac{\\partial^2 u_i}{\\partial t^2}$, and $\\partial_j$ denotes the partial derivative with respect to the spatial coordinate $x_j$, $\\frac{\\partial}{\\partial x_j}$.\n\nFirst, we combine these equations into a single wave equation for the displacement field $u_i$. Substituting the strain-displacement relation into Hooke's Law gives:\n$$\n\\sigma_{ij} = C_{ijkl} \\left( \\tfrac{1}{2}\\left(\\partial_{k}u_{l}+\\partial_{l}u_{k}\\right) \\right) = \\tfrac{1}{2} C_{ijkl} \\partial_k u_l + \\tfrac{1}{2} C_{ijkl} \\partial_l u_k\n$$\nBy swapping the dummy indices $k$ and $l$ in the second term, we get $\\tfrac{1}{2} C_{ijlk} \\partial_k u_l$. The elastic stiffness tensor possesses the minor symmetry $C_{ijlk} = C_{ijkl}$. Therefore, the expression for stress simplifies to:\n$$\n\\sigma_{ij} = \\tfrac{1}{2} C_{ijkl} \\partial_k u_l + \\tfrac{1}{2} C_{ijkl} \\partial_k u_l = C_{ijkl} \\partial_k u_l\n$$\nNow, substitute this expression for stress into the equation of motion:\n$$\n\\rho\\,\\ddot{u}_{i} = \\partial_{j}\\left(C_{ijkl} \\partial_k u_l\\right)\n$$\nFor a homogeneous medium, the components of the stiffness tensor $C_{ijkl}$ are constant with respect to position, so they can be moved outside the spatial derivative:\n$$\n\\rho\\,\\frac{\\partial^2 u_i}{\\partial t^2} = C_{ijkl} \\frac{\\partial^2 u_l}{\\partial x_j \\partial x_k}\n$$\nThis is the general form of the elastodynamic wave equation in an anisotropic medium.\n\nWe seek a plane monochromatic wave solution of the form:\n$$\nu_i(\\mathbf{x}, t) = U_i \\exp\\left[i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t)\\right]\n$$\nwhere $U_i$ are the components of the constant polarization vector $\\mathbf{U}$, $\\mathbf{k}$ is the wavevector, and $\\omega$ is the angular frequency. The derivatives are:\n$$\n\\frac{\\partial^2 u_i}{\\partial t^2} = (-\\omega^2) u_i\n$$\n$$\n\\frac{\\partial^2 u_l}{\\partial x_j \\partial x_k} = (i k_j)(i k_k) u_l = -k_j k_k u_l\n$$\nSubstituting these into the wave equation yields:\n$$\n\\rho(-\\omega^2 U_i) = C_{ijkl} (-k_j k_k U_l)\n$$\n$$\n\\rho \\omega^2 U_i = C_{ijkl} k_j k_k U_l\n$$\nLet $\\mathbf{n}$ be the unit vector in the direction of propagation, so $\\mathbf{k} = k \\mathbf{n}$, where $k=|\\mathbf{k}|$ is the wavenumber. The phase speed is $v = \\omega/k$. Substituting these relations:\n$$\n\\rho (v^2 k^2) U_i = C_{ijkl} (k n_j) (k n_k) U_l\n$$\nDividing by $k^2$ (assuming $k \\neq 0$) gives the Christoffel equation:\n$$\n\\left( C_{ijkl} n_j n_k \\right) U_l = \\rho v^2 U_i\n$$\nThis is an eigenvalue problem, which can be written as $\\Gamma_{il} U_l = \\rho v^2 U_i$. The matrix $\\Gamma$ with components $\\Gamma_{il} = C_{ijkl} n_j n_k$ is known as the Christoffel tensor. The eigenvalues of this tensor are $\\lambda = \\rho v^2$, which determine the three possible wave speeds for a given propagation direction $\\mathbf{n}$. The corresponding eigenvectors $\\mathbf{U}$ represent the polarization of these waves.\n\nFor a cubic crystal, the elastic stiffness tensor has only three independent non-zero components in Voigt notation: $C_{11}$, $C_{12}$, and $C_{44}$. In the full tensor notation, the relevant non-zero components are:\n$C_{1111}=C_{2222}=C_{3333} = C_{11}$\n$C_{1122}=C_{2211}=C_{1133}=C_{3311}=C_{2233}=C_{3322} = C_{12}$\n$C_{2323}=C_{3232}=C_{1313}=C_{3131}=C_{1212}=C_{2121} = C_{44}$ (and others by symmetry, e.g., $C_{1221}=C_{44}$).\n\nThe problem specifies propagation along the $\\left[100\\right]$ direction. This corresponds to the unit vector $\\mathbf{n} = (1, 0, 0)$, so $n_1=1$, $n_2=0$, and $n_3=0$.\nWe now compute the components of the Christoffel tensor $\\Gamma_{il} = C_{ijkl} n_j n_k$. Due to the form of $\\mathbf{n}$, the only non-zero contribution to the sums over $j$ and $k$ occurs when $j=1$ and $k=1$. Thus, the expression simplifies to:\n$$\n\\Gamma_{il} = C_{i11l}\n$$\nLet's compute the components of the $3 \\times 3$ matrix $\\Gamma$:\n$\\Gamma_{11} = C_{1111} = C_{11}$\n$\\Gamma_{12} = C_{1112} = 0$ (for cubic symmetry)\n$\\Gamma_{13} = C_{1113} = 0$ (for cubic symmetry)\n$\\Gamma_{21} = C_{2111} = 0$ (for cubic symmetry)\n$\\Gamma_{22} = C_{2112} = C_{44}$ (by symmetry $C_{2112}=C_{1212}=C_{44}$)\n$\\Gamma_{23} = C_{2113} = 0$ (for cubic symmetry)\n$\\Gamma_{31} = C_{3111} = 0$ (for cubic symmetry)\n$\\Gamma_{32} = C_{3112} = 0$ (for cubic symmetry)\n$\\Gamma_{33} = C_{3113} = C_{44}$ (by symmetry $C_{3113}=C_{1313}=C_{44}$)\n\nThe Christoffel tensor for propagation along $\\left[100\\right]$ is a diagonal matrix:\n$$\n\\Gamma = \\begin{pmatrix} C_{11}  0  0 \\\\ 0  C_{44}  0 \\\\ 0  0  C_{44} \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of $\\Gamma$ are simply its diagonal elements: $\\lambda_1 = C_{11}$, $\\lambda_2 = C_{44}$, and $\\lambda_3 = C_{44}$.\nThe corresponding squared phase speeds are found from $\\rho v^2 = \\lambda$:\n$v_1^2 = \\frac{C_{11}}{\\rho}$\n$v_2^2 = \\frac{C_{44}}{\\rho}$\n$v_3^2 = \\frac{C_{44}}{\\rho}$\n\nTo identify the modes, we examine the eigenvectors.\nFor the eigenvalue $\\lambda_1 = C_{11}$, the eigenvector is $\\mathbf{U}_1 = (1, 0, 0)$. This polarization vector is parallel to the propagation direction $\\mathbf{n} = (1, 0, 0)$, so this mode is longitudinal. The longitudinal speed is:\n$$\nv_L = \\sqrt{\\frac{C_{11}}{\\rho}}\n$$\nFor the degenerate eigenvalues $\\lambda_2 = \\lambda_3 = C_{44}$, the eigenvectors can be chosen as $\\mathbf{U}_2 = (0, 1, 0)$ and $\\mathbf{U}_3 = (0, 0, 1)$. Both polarization vectors are orthogonal to the propagation direction $\\mathbf{n}$. These modes are transverse. Since their speeds are identical, they are referred to as degenerate transverse modes. The transverse speed is:\n$$\nv_T = \\sqrt{\\frac{C_{44}}{\\rho}}\n$$\nThe problem asks for the longitudinal speed first, followed by the transverse speed.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{\\frac{C_{11}}{\\rho}}  \\sqrt{\\frac{C_{44}}{\\rho}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "In real-world simulations, numerically computed force constants can suffer from small inaccuracies that violate the fundamental translational invariance of the crystal. This practice delves into this practical challenge by introducing the Acoustic Sum Rule (ASR), a direct consequence of this invariance. You will develop and apply a procedure  to minimally correct a force constant matrix, ensuring it is physically consistent and yields a correct phonon spectrum.",
            "id": "3832843",
            "problem": "You are given a real square matrix of force constants $\\Phi \\in \\mathbb{R}^{m \\times m}$ for a crystal with $m = 3N$ degrees of freedom, where $N$ is the number of atoms and the factor $3$ corresponds to three Cartesian directions per atom. In lattice dynamics, translational invariance of the crystal implies the Acoustic Sum Rule (ASR): for each degree of freedom $i\\alpha$, the row sum $\\sum_{j\\beta} \\Phi_{i\\alpha,j\\beta}$ must be zero. Equivalently, in vector form with the all-ones vector $\\mathbf{1} \\in \\mathbb{R}^{m}$, the ASR requires $\\Phi \\mathbf{1} = \\mathbf{0}$. A computed $\\Phi$ may violate the ASR due to numerical or modeling errors.\n\nStarting from the foundational principles that (i) Newtonâ€™s laws imply that rigid translation should not induce net forces and (ii) the force constant matrix obeys the pair symmetry $\\Phi_{i\\alpha,j\\beta} = \\Phi_{j\\beta,i\\alpha}$ for a conservative interatomic potential, construct a correction procedure that modifies $\\Phi$ minimally in the Frobenius norm while enforcing the ASR and preserving the pair symmetry $\\Phi = \\Phi^{\\top}$. Concretely, design an algorithm that produces a corrected matrix $\\Phi' \\in \\mathbb{R}^{m \\times m}$ satisfying:\n- $\\Phi'$ is symmetric, i.e., $\\Phi' = \\Phi'^{\\top}$,\n- $\\Phi' \\mathbf{1} = \\mathbf{0}$,\n- Among all symmetric matrices satisfying the ASR, the change $\\Delta = \\Phi' - \\widehat{\\Phi}$ has minimal Frobenius norm, where $\\widehat{\\Phi} = (\\Phi + \\Phi^{\\top})/2$ is the symmetrized input, and the Frobenius norm is $\\|\\Delta\\|_F = \\sqrt{\\sum_{i,j} \\Delta_{ij}^2}$.\n\nYour program must implement this correction for a given set of test matrices and output, for each test case, three quantities that make the result testable:\n- The maximum absolute ASR residual after correction, defined as $\\max_{i} |(\\Phi' \\mathbf{1})_i|$,\n- The Frobenius norm of the applied correction, defined as $\\|\\Delta\\|_F$,\n- The maximum absolute asymmetry in the corrected matrix, defined as $\\max_{i,j} |\\Phi'_{ij} - \\Phi'_{ji}|$.\n\nAll quantities are dimensionless real numbers for this problem, and should be output without units.\n\nTest Suite:\nUse the following three scientifically plausible matrices as test cases. Each matrix is real and dimensionless.\n\n1. Case A ($m = 6$): Two atoms coupled isotropically with spring constant $k = 10$ across all Cartesian directions, perturbed by a symmetric rank-one violation. Let $I_3$ be the $3 \\times 3$ identity. Define\n$$\n\\Phi_{\\text{ideal}} = \n\\begin{pmatrix}\nk I_3  -k I_3 \\\\\n-k I_3  k I_3\n\\end{pmatrix},\n\\quad\n\\mathbf{v} = \\begin{pmatrix} 2 \\\\ -1 \\\\ 0.5 \\\\ 3 \\\\ -2 \\\\ 1 \\end{pmatrix},\n\\quad\n\\Phi^{(A)} = \\Phi_{\\text{ideal}} + 0.3\\, \\mathbf{v}\\mathbf{v}^{\\top}.\n$$\n\n2. Case B ($m = 3$): Single-atom $3 \\times 3$ matrix with mixed diagonal entries mimicking numerical inconsistency in self-terms:\n$$\n\\Phi^{(B)} = \\mathrm{diag}(1, -1, 0).\n$$\n\n3. Case C ($m = 9$): Three atoms in a linear chain with isotropic couplings $k_{12} = 5$ and $k_{23} = 8$, perturbed by a symmetric structured violation. With $I_3$ as above, construct the $9 \\times 9$ matrix\n$$\n\\Phi_{\\text{ideal}} = \n\\begin{pmatrix}\nk_{12} I_3  -k_{12} I_3  0 \\\\\n-k_{12} I_3  (k_{12}+k_{23}) I_3  -k_{23} I_3 \\\\\n0  -k_{23} I_3  k_{23} I_3\n\\end{pmatrix},\n$$\nand let\n$$\n\\mathbf{a} =\n\\begin{pmatrix}\n0 \\\\ 1 \\\\ -1 \\\\ 2 \\\\ 0 \\\\ -2 \\\\ 1 \\\\ 0.5 \\\\ -1.5\n\\end{pmatrix},\n\\quad\n\\Phi^{(C)} = \\Phi_{\\text{ideal}} + 0.4 \\left( \\mathbf{a}\\mathbf{1}^{\\top} + \\mathbf{1}\\mathbf{a}^{\\top} \\right).\n$$\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list of case results, each case result itself being a comma-separated triple enclosed in square brackets, and the whole list enclosed in square brackets. For example, the output must look like\n$$\n[[r_{\\max}^{(A)},\\|\\Delta^{(A)}\\|_F,a_{\\max}^{(A)}],[r_{\\max}^{(B)},\\|\\Delta^{(B)}\\|_F,a_{\\max}^{(B)}],[r_{\\max}^{(C)},\\|\\Delta^{(C)}\\|_F,a_{\\max}^{(C)}]],\n$$\nwhere $r_{\\max}$ is the maximum absolute ASR residual after correction, $\\|\\Delta\\|_F$ is the Frobenius norm of the correction, and $a_{\\max}$ is the maximum absolute asymmetry of the corrected matrix. The program must not print any other text.",
            "solution": "The problem asks for an algorithm to correct a given real square force constant matrix $\\Phi \\in \\mathbb{R}^{m \\times m}$ so that it simultaneously satisfies two fundamental physical constraints: pair symmetry ($\\Phi' = \\Phi'^{\\top}$) and the Acoustic Sum Rule (ASR, $\\Phi' \\mathbf{1} = \\mathbf{0}$). The correction must be minimal in the sense that it minimizes the Frobenius norm of the change relative to the symmetrized input matrix.\n\nThis problem can be formulated as a constrained optimization problem. Let the given, potentially non-symmetric and ASR-violating matrix be $\\Phi$. The first step is to enforce symmetry. The closest symmetric matrix to $\\Phi$ in the Frobenius norm is its symmetric part, $\\widehat{\\Phi} = (\\Phi + \\Phi^{\\top}) / 2$. The problem statement correctly identifies $\\widehat{\\Phi}$ as the reference matrix. We seek a corrected matrix $\\Phi'$ that minimizes $\\|\\Phi' - \\widehat{\\Phi}\\|_F$ subject to the constraints.\n\nLet $\\Delta = \\Phi' - \\widehat{\\Phi}$ be the correction matrix. The problem is equivalent to finding the matrix $\\Delta$ that minimizes $\\|\\Delta\\|_F^2 = \\sum_{i,j} \\Delta_{ij}^2$ subject to:\n$1$. $\\Phi'$ is symmetric: $(\\widehat{\\Phi} + \\Delta) = (\\widehat{\\Phi} + \\Delta)^{\\top}$. Since $\\widehat{\\Phi}$ is symmetric by definition, this simplifies to $\\Delta = \\Delta^{\\top}$.\n$2$. $\\Phi'$ satisfies the ASR: $(\\widehat{\\Phi} + \\Delta)\\mathbf{1} = \\mathbf{0}$, which means $\\Delta\\mathbf{1} = -\\widehat{\\Phi}\\mathbf{1}$.\n\nLet $\\mathbf{r} = \\widehat{\\Phi}\\mathbf{1}$ be the vector of ASR residuals for the symmetrized matrix $\\widehat{\\Phi}$. The optimization problem is:\n$$\n\\underset{\\Delta \\in \\mathbb{R}^{m \\times m}}{\\text{minimize}} \\quad \\frac{1}{2} \\|\\Delta\\|_F^2\n$$\n$$\n\\text{subject to} \\quad \\Delta = \\Delta^{\\top} \\quad \\text{and} \\quad \\Delta \\mathbf{1} = -\\mathbf{r}\n$$\n\nThis is a convex optimization problem (quadratic objective with linear constraints), which guarantees a unique solution. The solution $\\Delta$ is the orthogonal projection of the zero matrix onto the affine subspace defined by the constraints. A standard method to solve this is to propose a form for the solution and determine its parameters. We seek a symmetric correction matrix $\\Delta$ that satisfies a sum rule. A natural ansatz for such a matrix is:\n$$\n\\Delta = \\mathbf{x} \\mathbf{1}^{\\top} + \\mathbf{1} \\mathbf{x}^{\\top}\n$$\nfor some vector $\\mathbf{x} \\in \\mathbb{R}^m$. This form is manifestly symmetric, as $(\\mathbf{x} \\mathbf{1}^{\\top} + \\mathbf{1} \\mathbf{x}^{\\top})^{\\top} = (\\mathbf{1} \\mathbf{x}^{\\top}) + (\\mathbf{x} \\mathbf{1}^{\\top}) = \\Delta$.\n\nWe now enforce the ASR constraint, $\\Delta\\mathbf{1} = -\\mathbf{r}$:\n$$\n(\\mathbf{x} \\mathbf{1}^{\\top} + \\mathbf{1} \\mathbf{x}^{\\top})\\mathbf{1} = -\\mathbf{r}\n$$\nUsing the associativity of matrix multiplication:\n$$\n\\mathbf{x}(\\mathbf{1}^{\\top}\\mathbf{1}) + \\mathbf{1}(\\mathbf{x}^{\\top}\\mathbf{1}) = -\\mathbf{r}\n$$\nThe term $\\mathbf{1}^{\\top}\\mathbf{1}$ is the dot product of the all-ones vector with itself, which equals the dimension of the space, $m$. The term $\\mathbf{x}^{\\top}\\mathbf{1}$ is a scalar, which we denote as $s = \\sum_{i=1}^m x_i$. The equation becomes:\n$$\nm\\mathbf{x} + s\\mathbf{1} = -\\mathbf{r}\n$$\nThis equation gives an expression for the vector $\\mathbf{x}$ in terms of the yet-unknown scalar $s$:\n$$\n\\mathbf{x} = -\\frac{1}{m}(\\mathbf{r} + s\\mathbf{1})\n$$\nTo find $s$, we use its definition, $s = \\mathbf{1}^{\\top}\\mathbf{x}$. We multiply the expression for $\\mathbf{x}$ by $\\mathbf{1}^{\\top}$:\n$$\n\\mathbf{1}^{\\top}\\mathbf{x} = -\\frac{1}{m}\\mathbf{1}^{\\top}(\\mathbf{r} + s\\mathbf{1})\n$$\n$$\ns = -\\frac{1}{m}(\\mathbf{1}^{\\top}\\mathbf{r} + s\\mathbf{1}^{\\top}\\mathbf{1})\n$$\nLet $S_r = \\mathbf{1}^{\\top}\\mathbf{r} = \\sum_{i=1}^m r_i$ be the sum of all residuals. Substituting $S_r$ and $\\mathbf{1}^{\\top}\\mathbf{1}=m$:\n$$\ns = -\\frac{1}{m}(S_r + sm) = -\\frac{S_r}{m} - s\n$$\n$$\n2s = -\\frac{S_r}{m} \\implies s = -\\frac{S_r}{2m}\n$$\nWith $s$ determined, the vector $\\mathbf{x}$ is fully specified, and thereby the correction matrix $\\Delta$. This procedure gives the unique solution that minimizes the Frobenius norm.\n\nThe computational algorithm is as follows:\n$1$. Given the input matrix $\\Phi \\in \\mathbb{R}^{m \\times m}$.\n$2$. Construct the symmetrized matrix $\\widehat{\\Phi} = (\\Phi + \\Phi^{\\top}) / 2$.\n$3$. Compute the ASR residual vector $\\mathbf{r} = \\widehat{\\Phi}\\mathbf{1}$.\n$4$. Compute the sum of the residuals, $S_r = \\sum_{i=1}^m r_i$.\n$5$. Calculate the scalar $s = -S_r / (2m)$.\n$6$. Determine the correction vector $\\mathbf{x} = -(\\mathbf{r} + s\\mathbf{1}) / m$.\n$7$. Construct the correction matrix $\\Delta$, where $\\Delta_{ij} = x_i + x_j$. In matrix form, this is $\\Delta = \\mathbf{x} \\mathbf{1}^{\\top} + \\mathbf{1} \\mathbf{x}^{\\top}$.\n$8$. Compute the final corrected matrix $\\Phi' = \\widehat{\\Phi} + \\Delta$.\n$9$. Finally, calculate the required testable quantities:\n    - The maximum absolute ASR residual after correction: $r_{\\max} = \\max_{i} |(\\Phi' \\mathbf{1})_i|$. Algebraically, this is $0$.\n    - The Frobenius norm of the applied correction: $\\|\\Delta\\|_F = \\|\\Phi' - \\widehat{\\Phi}\\|_F$. A convenient formula for this is $\\|\\Delta\\|_F^2 = 2m\\|\\mathbf{x}\\|_2^2 + 2s^2$.\n    - The maximum absolute asymmetry in the corrected matrix: $a_{\\max} = \\max_{i,j} |\\Phi'_{ij} - \\Phi'_{ji}|$. Algebraically, this is also $0$.\nThe non-zero values for $r_{\\max}$ and $a_{\\max}$ in a numerical implementation will be due to floating-point arithmetic precision limits.",
            "answer": "```python\nimport numpy as np\n\ndef construct_test_cases():\n    \"\"\"\n    Constructs the matrices for the three test cases specified in the problem.\n    \"\"\"\n    cases = []\n\n    # Case A: m = 6\n    m_A = 6\n    k_A = 10.0\n    I3 = np.identity(3)\n    phi_ideal_A = np.block([\n        [k_A * I3, -k_A * I3],\n        [-k_A * I3, k_A * I3]\n    ])\n    v_A = np.array([2.0, -1.0, 0.5, 3.0, -2.0, 1.0])\n    phi_A = phi_ideal_A + 0.3 * np.outer(v_A, v_A)\n    cases.append(phi_A)\n\n    # Case B: m = 3\n    phi_B = np.diag([1.0, -1.0, 0.0])\n    cases.append(phi_B)\n\n    # Case C: m = 9\n    m_C = 9\n    k12 = 5.0\n    k23 = 8.0\n    I3 = np.identity(3)\n    Z3 = np.zeros((3, 3))\n    phi_ideal_C = np.block([\n        [k12 * I3, -k12 * I3, Z3],\n        [-k12 * I3, (k12 + k23) * I3, -k23 * I3],\n        [Z3, -k23 * I3, k23 * I3]\n    ])\n    a_C = np.array([0.0, 1.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.5, -1.5])\n    ones_C = np.ones(m_C)\n    phi_C = phi_ideal_C + 0.4 * (np.outer(a_C, ones_C) + np.outer(ones_C, a_C))\n    cases.append(phi_C)\n\n    return cases\n\ndef apply_asr_correction(phi):\n    \"\"\"\n    Applies the minimal Frobenius norm correction to enforce symmetry and ASR.\n\n    Args:\n        phi (np.ndarray): The input m x m force constant matrix.\n\n    Returns:\n        tuple: A tuple containing:\n            - r_max (float): Maximum absolute ASR residual after correction.\n            - delta_norm_F (float): Frobenius norm of the correction.\n            - a_max (float): Maximum absolute asymmetry of the corrected matrix.\n    \"\"\"\n    m = phi.shape[0]\n    \n    # 1. Symmetrize the matrix\n    phi_hat = 0.5 * (phi + phi.T)\n    \n    # 2. Compute the ASR residual vector\n    ones_vec = np.ones(m)\n    r = np.dot(phi_hat, ones_vec)\n    \n    # 3. Compute the sum of residuals\n    S_r = np.sum(r)\n    \n    # 4. Calculate the scalar s\n    s = -S_r / (2.0 * m)\n    \n    # 5. Determine the correction vector x\n    x = -(r + s * ones_vec) / m\n    \n    # 6. Construct the correction matrix Delta\n    delta = np.outer(x, ones_vec) + np.outer(ones_vec, x)\n    \n    # 7. Compute the final corrected matrix Phi'\n    phi_prime = phi_hat + delta\n    \n    # 8. Calculate the required testable quantities\n    \n    # Maximum absolute ASR residual\n    r_max = np.max(np.abs(np.dot(phi_prime, ones_vec)))\n    \n    # Frobenius norm of the correction Delta = Phi' - Phi_hat\n    delta_norm_F = np.linalg.norm(delta, 'fro')\n    \n    # Maximum absolute asymmetry\n    a_max = np.max(np.abs(phi_prime - phi_prime.T))\n    \n    return r_max, delta_norm_F, a_max\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = construct_test_cases()\n    \n    case_results = []\n    for phi in test_cases:\n        r_max, delta_norm_F, a_max = apply_asr_correction(phi)\n        case_results.append(f\"[{r_max},{delta_norm_F},{a_max}]\")\n        \n    # Format the final output string exactly as specified.\n    print(f\"[[{','.join(case_results)}]]\")\n\nsolve()\n```"
        }
    ]
}