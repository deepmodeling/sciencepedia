{
    "hands_on_practices": [
        {
            "introduction": "在分子动力学（MD）模拟中，局部性假设是实现计算效率的关键，即原子间的相互作用会随距离增加而迅速衰减。然而，在实际操作中对势函数进行截断是一种必要的近似，这可能会引入物理和数值上的偏差。本练习旨在挑战您批判性地评估不同的势函数截断策略，并分析它们对能量守恒和压力计算等基本宏观物理量的影响，这些都是衡量模拟准确性的核心指标。",
            "id": "3815456",
            "problem": "在多尺度层级结构内的原子模拟中，实现高效分子动力学 (MD) 的一个关键假设是局域性：即原子间相互作用随距离的增加而充分衰减，因此可以引入一个有限的截断半径 $r_c$ 而不会定性地改变近场物理。考虑一个在周期性边界条件下，通过对心势 $V(r)$ 相互作用的均匀、各向同性的粒子流体。MD 轨迹是在微正则系综中使用时间可逆的辛积分器（例如，速度 Verlet 算法）生成的。带有缓冲层（skin）的邻居列表可确保在邻居列表更新之间，所有间距 $rr_c$ 的原子对都被正确考虑。",
            "solution": "此问题已损坏。问题描述不完整，且评估所需的多个陈述选项缺失。因此，无法提供有效的解法。",
            "answer": "$$\\boxed{DEF}$$"
        },
        {
            "introduction": "将离散的原子尺度模拟与连续介质力学中的场（如应力场）联系起来，是多尺度建模中的一个核心任务。本练习将引导您探索从原始的原子位置和速度数据中，计算出物理意义明确且平滑的连续介质应力场的理论和实践步骤。通过这个过程，您将深入理解空间和时间平均在消除微观噪声、以及正确处理热运动以获得宏观客观物理量中的关键作用。",
            "id": "3815423",
            "problem": "一个含有缺陷的晶体固体在有限温度 $T$ 下，通过分子动力学（MD）模拟了一个由变形梯度张量 $\\mathbf{F}$ 表征的均匀剪切过程。该模拟提供了标号为 $i$ 的原子的轨迹 $\\mathbf{r}_i(t)$ 和速度 $\\mathbf{v}_i(t)$。您希望计算一个连续介质品质的柯西应力场 $\\boldsymbol{\\sigma}(\\mathbf{r},t)$，以便与相同热力学状态下的连续介质力学计算结果进行比较。在变形的固体中，原子位移并非纯粹的仿射位移：对于每个原子，其位移可以分解为由 $\\mathbf{F}$ 引起的仿射部分和由局部重排、缺陷及热振动引起的非仿射部分。热涨落在一系列时间尺度上产生随机的速度分量和振动运动。\n\n从动量守恒的第一性原理和应力作为动量通量的定义出发，论述非仿射位移和热涨落如何进入微观应力定义，以及必须如何处理它们才能获得光滑、客观的连续介质品质应力。然后，选择最能正确地得到 $\\boldsymbol{\\sigma}(\\mathbf{r},t)$ 且偏差最小的方案，并与从原子到连续介质描述的层次结构保持一致。\n\n哪个选项最能满足这些要求？\n\nA. 使用一个光滑、紧支集的核函数 $W(\\mathbf{r})$（其宽度 $l$ 满足 $a \\ll l \\ll L$，其中 $a$ 是晶格间距，$L$ 是宏观长度）对 Irving–Kirkwood 应力进行空间粗粒化。通过对 $\\mathbf{v}_i(t)$ 进行核函数加权平均来定义局部流速度 $\\mathbf{u}(\\mathbf{r},t)$，并使用特异速度 $\\mathbf{c}_i(t) = \\mathbf{v}_i(t) - \\mathbf{u}(\\mathbf{r},t)$ 计算动能项以抑制平流贡献。在计算沿原子间键的位形贡献时，不假设仿射运动学，从而使非仿射位移通过实际的 $\\mathbf{r}_i(t)$ 进入计算。在一个时间窗口 $\\Delta t$ 内执行时间平均，该窗口的选择需满足 $\\tau_{\\mathrm{vib}} \\ll \\Delta t \\ll \\tau_{\\mathrm{drift}}$，其中 $\\tau_{\\mathrm{vib}}$ 是特征振动去相关时间，$\\tau_{\\mathrm{drift}}$ 是宏观演化时间，并可选择性地对独立的 MD 副本进行系综平均。\n\nB. 在一个仅包含几个原子的微小原子子体积内，仅使用位形项计算瞬时维里应力，并论证非仿射位移平均为零，且热涨落在室温下可忽略不计，因此既不需要空间平均也不需要时间平均。\n\nC. 使用一个与 $a$ 相当的顶帽空间划分尺寸 $l$ 对 Irving–Kirkwood 应力在一个长窗口 $\\Delta t$ 内进行全局时间平均，以保留局部细节，并使用未经修改的速度 $\\mathbf{v}_i(t)$。减去模拟单元的全局平均速度，但不定义局部流速度场 $\\mathbf{u}(\\mathbf{r},t)$。\n\nD. 通过将 $\\mathbf{X}_i$ 映射到 $\\mathbf{F}\\mathbf{X}_i$ 来强制执行仿射运动学，并将任何偏差作为非仿射噪声丢弃。使用在仿射变形晶格上计算的势的导数，通过 Cauchy–Born 法则计算应力。移除整个动能贡献以消除热噪声，因为连续介质应力是由势相互作用定义的。\n\nE. 使用宽度为 $l \\sim L$ 的高斯核函数 $W(\\mathbf{r})$ 来消除所有微观结构细节。保留动能项和位形项，但使用原始速度 $\\mathbf{v}_i(t)$ 计算动能部分，并避免时间平均以保留瞬时响应。假设仅凭较大的 $l$ 值就能确保在存在缺陷和热涨落的情况下获得连续介质品质的应力。\n\n选择正确的选项。",
            "solution": "用户要求对一个关于从原子模拟数据计算连续介质品质柯西应力场的问题进行批判性评估，然后进行有理有据的推导并评估所提供的选项。\n\n### 问题验证\n\n**步骤1：提取给定条件**\n- **系统：** 含有缺陷的晶体固体。\n- **模拟方法：** 分子动力学 (MD)。\n- **热力学状态：** 有限温度 $T$。\n- **力学加载：** 由变形梯度张量 $\\mathbf{F}$ 表征的均匀剪切。\n- **可用数据：** 所有原子 $i$ 的原子轨迹 $\\mathbf{r}_i(t)$ 和速度 $\\mathbf{v}_i(t)$。\n- **目标：** 计算一个连续介质品质的柯西应力场 $\\boldsymbol{\\sigma}(\\mathbf{r},t)$。结果应能与连续介质力学计算相比较。\n- **关键物理特征：**\n    1. 原子位移并非纯粹的仿射位移；它们具有由局部重排、缺陷和热振动引起的非仿射分量。\n    2. 热涨落导致随机速度和振动。\n- **任务：** 从动量守恒的第一性原理出发，论述微观应力定义应如何包含非仿射位移和热涨落，以及必须如何处理它们才能得到光滑、客观的连续介质品质应力。在给定选项中选择最佳方案。\n\n**步骤2：使用提取的给定条件进行验证**\n- **科学依据：** 该问题在根本上是合理的。它涉及多尺度材料建模领域一个核心且公认的挑战：将离散的原子描述与连续的场描述联系起来。所涉及的概念——MD、柯西应力、变形梯度、仿射/非仿射位移、热涨落以及缺陷的作用——在计算材料科学、统计力学和连续介质力学中都是标准且严格定义的。提及“动量守恒的第一性原理”正确地指出了应力张量的物理基础。\n- **适定性：** 该问题是适定的。它清晰地定义了输入（特定系统的MD模拟数据）和期望的输出（一个连续介质品质的应力场）。问题要求在多个选项中选出“最佳方案”，这是评估对复杂方法论理解的标准形式。“最佳”的标准被明确指出：“偏差最小，且与从原子到连续介质描述的层次结构保持一致。”\n- **客观性：** 问题陈述使用了精确、客观和技术性的语言。它没有主观性断言或含糊不清之处。\n\n**步骤3：结论与行动**\n问题陈述在科学上是合理的、适定的和客观的。没有可识别的缺陷。因此，该问题是**有效的**。现在开始求解过程。\n\n### 从第一性原理推导\n\n连续介质中的柯西应力张量 $\\boldsymbol{\\sigma}$，从根本上讲是穿过一个面元的动量通量。其微观对应物可以从粒子系统的动量密度守恒定律推导出来。在空间中一点 $\\mathbf{r}$ 的应力张量的规范表达式是 Irving–Kirkwood (IK) 公式，它包含两部分：动能项和位形（或势能）项。\n$$\n\\boldsymbol{\\sigma}(\\mathbf{r},t) = \\boldsymbol{\\sigma}_K(\\mathbf{r},t) + \\boldsymbol{\\sigma}_C(\\mathbf{r},t)\n$$\n该表达式的瞬时、微观形式涉及以原子位置为中心的狄拉克δ函数，使其高度奇异且快速涨落。\n\n1.  **动能贡献 ($\\boldsymbol{\\sigma}_K$)：** 该项表示由原子运动引起的动量输运。为了得到一个正确、客观的应力定义，必须区分相干的、宏观的运动（平流）和随机的热运动。柯西应力与后者有关。因此，动能项必须用**特异速度** $\\mathbf{c}_i(t)$ 来表述，即原子相对于局部平均（或流）速度场 $\\mathbf{u}(\\mathbf{r},t)$ 的速度。\n    $$\n    \\mathbf{c}_i(t) = \\mathbf{v}_i(t) - \\mathbf{u}(\\mathbf{r}_i(t), t)\n    $$\n    应力场的动能贡献则由下式给出：\n    $$\n    \\boldsymbol{\\sigma}_K(\\mathbf{r},t) = -\\sum_{i} m_i \\mathbf{c}_i(t) \\otimes \\mathbf{c}_i(t) \\delta(\\mathbf{r}_i(t)-\\mathbf{r})\n    $$\n    使用总速度 $\\mathbf{v}_i(t)$ 会错误地将平流项 $-\\rho \\mathbf{u} \\otimes \\mathbf{u}$ 包含到应力中，使其依赖于参考系而不是客观的。\n\n2.  **位形贡献 ($\\boldsymbol{\\sigma}_C$)：** 该项表示通过原子间力传递的动量。对于对势相互作用，它涉及对所有原子对 $(i, j)$ 的求和，并分布在连接它们的线段上。\n    $$\n    \\boldsymbol{\\sigma}_C(\\mathbf{r},t) = -\\frac{1}{2}\\sum_{i \\neq j} \\mathbf{r}_{ij}(t) \\otimes \\mathbf{f}_{ij}(t) \\int_0^1 \\delta(\\mathbf{r}_i(t) + s\\mathbf{r}_{ji}(t) - \\mathbf{r}) ds\n    $$\n    其中 $\\mathbf{r}_{ij} = \\mathbf{r}_j - \\mathbf{r}_i$，$\\mathbf{f}_{ij}$ 是原子 $j$ 对原子 $i$ 的力。至关重要的是，该表达式使用了**实际的原子位置** $\\mathbf{r}_i(t)$。因此，它自然且正确地包含了所有的位移效应，包括由宏观变形 $\\mathbf{F}$ 引起的仿射部分以及由缺陷、局部弛豫和热振动产生的非仿射部分。强加仿射运动学将抹去缺陷附近变形的基本物理过程。\n\n3.  **为获得连续场而进行的平均：** 为了将奇异、涨落的微观表达式转换为光滑的、“连续介质品质”的场 $\\boldsymbol{\\sigma}(\\mathbf{r},t)$，平均是必不可少的。\n    -   **空间平均（粗粒化）：** 必须通过将微观表达式与一个特征宽度为 $l$ 的核函数 $W(\\mathbf{r})$ 进行卷积来平滑狄拉克δ函数。$l$ 的选择至关重要，并由尺度分离决定：它必须远大于原子间距 $a$（$l \\gg a$）以平均足够多的原子来获得统计显著性，但又必须远小于应力场宏观变化的特征长度尺度 $L$（$l \\ll L$）以解析这些变化。\n    -   **时间平均：** 该场仍然受到原子振动产生的高频热噪声的影响。为了获得与准静态或缓慢演化的连续场相当的量，必须在一个时间间隔 $\\Delta t$ 上进行时间平均。这个间隔必须足够长以平均掉快速的热振动（即 $\\Delta t \\gg \\tau_{\\mathrm{vib}}$，其中 $\\tau_{\\mathrm{vib}}$ 是典型的振动周期或去相关时间），但又必须足够短以解析宏观过程的时间演化（即 $\\Delta t \\ll \\tau_{\\mathrm{drift}}$，其中 $\\tau_{\\mathrm{drift}}$ 是 $\\mathbf{F}$ 或由此产生的应力场变化的特征时间尺度）。\n    -   **系综平均：** 对于平衡或稳态情况，可以根据遍历假设，通过对多个独立的 MD 模拟（副本）进行平均来提高统计收敛性。\n\n一个正确的方案必须整合所有这些要素：正确的 IK 公式，包括特异速度和非仿射位置，并结合适当的空间和时间平均。\n\n###逐项分析\n\n**A. 使用一个光滑、紧支集的核函数 $W(\\mathbf{r})$（其宽度 $l$ 满足 $a \\ll l \\ll L$，其中 $a$ 是晶格间距，$L$ 是宏观长度）对 Irving–Kirkwood 应力进行空间粗粒化。通过对 $\\mathbf{v}_i(t)$ 进行核函数加权平均来定义局部流速度 $\\mathbf{u}(\\mathbf{r},t)$，并使用特异速度 $\\mathbf{c}_i(t) = \\mathbf{v}_i(t) - \\mathbf{u}(\\mathbf{r},t)$ 计算动能项以抑制平流贡献。在计算沿原子间键的位形贡献时，不假设仿射运动学，从而使非仿射位移通过实际的 $\\mathbf{r}_i(t)$ 进入计算。在一个时间窗口 $\\Delta t$ 内执行时间平均，该窗口的选择需满足 $\\tau_{\\mathrm{vib}} \\ll \\Delta t \\ll \\tau_{\\mathrm{drift}}$，其中 $\\tau_{\\mathrm{vib}}$ 是特征振动去相关时间，$\\tau_{\\mathrm{drift}}$ 是宏观演化时间，并可选择性地对独立的 MD 副本进行系综平均。**\n\n这个选项完美地概括了从第一性原理推导出的严谨程序。它正确地指出了：(1) 使用 IK 公式；(2) 进行空间粗粒化并遵循适当的尺度分离（$a \\ll l \\ll L$）的必要性；(3) 使用相对于局部定义的流速度的特异速度来正确处理动能项；(4) 通过使用实际原子位置来内在地包含非仿射效应；(5) 进行时间平均并遵循适当的尺度分离（$\\tau_{\\mathrm{vib}} \\ll \\Delta t \\ll \\tau_{\\mathrm{drift}}$）的必要性；以及 (6) 系综平均的有效性。该方案是完成此任务的标准、最先进的方法。\n**结论：正确。**\n\n**B. 在一个仅包含几个原子的微小原子子体积内，仅使用位形项计算瞬时维里应力，并论证非仿射位移平均为零，且热涨落在室温下可忽略不计，因此既不需要空间平均也不需要时间平均。**\n\n这个选项在多个基本点上存在缺陷。\n- 使用“仅包含几个原子的微小原子子体积”直接违背了为获得类连续介质性质的量而需要进行空间平均的要求。\n- “热涨落在室温下可忽略不计”的论断在事实上是错误的；在 $T=300 \\, \\mathrm{K}$ 时，热能 ($k_B T$) 与原子能垒相比是显著的。\n- “非仿射位移平均为零”的说法是错误的，尤其是在缺陷附近，缺陷是系统性非仿射场的主要来源。\n- 对于有限温度的系统，忽略动能项是不正确的。\n- 计算“瞬时”值而不进行时间平均无法消除热噪声，导致得到的量不能代表连续介质应力。\n**结论：不正确。**\n\n**C. 使用一个与 $a$ 相当的顶帽空间划分尺寸 $l$ 对 Irving–Kirkwood 应力在一个长窗口 $\\Delta t$ 内进行全局时间平均，以保留局部细节，并使用未经修改的速度 $\\mathbf{v}_i(t)$。减去模拟单元的全局平均速度，但不定义局部流速度场 $\\mathbf{u}(\\mathbf{r},t)$。**\n\n这个选项包含几个错误。\n- 空间划分尺寸 $l \\sim a$ 太小；它无法平滑场并在足够多的原子上进行平均，因此不能产生连续介质品质的场。\n- 对动能项使用“未经修改的速度 $\\mathbf{v}_i(t)$”是不正确的，因为它将应力与平流混淆，违反了柯西应力的物质坐标系无关性原理。\n- 对于一个非均匀变形的系统，其中局部流速度 $\\mathbf{u}(\\mathbf{r},t)$ 在空间上变化，仅减去全局平均速度是不够的。\n**结论：不正确。**\n\n**D. 通过将 $\\mathbf{X}_i$ 映射到 $\\mathbf{F}\\mathbf{X}_i$ 来强制执行仿射运动学，并将任何偏差作为非仿射噪声丢弃。使用在仿射变形晶格上计算的势的导数，通过 Cauchy–Born 法则计算应力。移除整个动能贡献以消除热噪声，因为连续介质应力是由势相互作用定义的。**\n\n这个选项提出的方法对所述系统是无效的。\n- Cauchy–Born 法则仅适用于经历均匀变形的完美晶体。通过“丢弃”非仿射偏差，它忽略了缺陷的物理学，而这是问题的核心特征。\n- 这种方法实际上分析的是一个理想化的、无热的（$T=0$）、无缺陷的系统，而不是问题中描述的含有缺陷的有限温度系统。\n- 完全忽略动能项是一种近似，它舍弃了有限温度下对应力的真实物理贡献。“连续介质应力*仅*基于势”的前提是一种过度简化。\n**结论：不正确。**\n\n**E. 使用宽度为 $l \\sim L$ 的高斯核函数 $W(\\mathbf{r})$ 来消除所有微观结构细节。保留动能项和位形项，但使用原始速度 $\\mathbf{v}_i(t)$ 计算动能部分，并避免时间平均以保留瞬时响应。假设仅凭较大的 $l$ 值就能确保在存在缺陷和热涨落的情况下获得连续介质品质的应力。**\n\n这个选项也存在根本性缺陷。\n- 粗粒化长度 $l \\sim L$（其中 $L$ 是宏观长度）太大了。它违反了尺度分离 $l \\ll L$，会平均掉所有的空间变化，从而得到一个单一的体积平均应力值，而不是一个应力*场* $\\boldsymbol{\\sigma}(\\mathbf{r},t)$。\n- 与选项 C 一样，使用原始速度 $\\mathbf{v}_i(t)$ 计算动能项是不正确的。\n- 避免时间平均无法消除高频热噪声，意味着结果不是一个光滑的连续介质品质的场。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "粗粒化（Coarse-graining）是连接不同时空尺度的强大策略，它通过简化系统描述来模拟更大规模的现象。本练习提供了一个完整的实践工作流程，指导您如何将一个细节丰富的全原子高分子模型，系统地映射到一个简化的珠簧（bead-spring）模型。您需要通过匹配静态结构属性（如均方末端距）和动态属性（如扩散系数）来推导粗粒化模型的参数，并最终验证新模型的预测能力。",
            "id": "3815431",
            "problem": "您被要求形式化一个分层粗粒化过程，该过程将原子级聚合物链映射到珠簧链，并根据两个目标可观测量（均方末端距和长时自扩散系数）验证所得的粗粒化模型。推导和算法必须从适用于多尺度材料模拟的基础物理原理出发，并以纯粹的数学和逻辑术语表达。\n\n从以下基本定律和核心定义开始：\n\n- 三维谐振子的能量均分定理：每个二次自由度对平均能量的贡献为 $k_{\\mathrm{B}} T / 2$，其中 $k_{\\mathrm{B}}$ 是 Boltzmann 常数，$T$ 是绝对温度。对于势能为 $U(\\mathbf{r}) = \\frac{1}{2} k \\lVert \\mathbf{r} \\rVert^2$ 的谐振子，这意味着弹簧常数 $k$ 和均方键长之间存在一种关系。\n- 理想高斯链统计：对于具有 $n$ 个均值为零且方差为各向同性的独立同分布链段的链，其均方末端距与链段数量成正比。\n- 扩散的 Einstein 关系：一个受线性阻力作用的布朗粒子的长时自扩散系数 $D$ 由 $D = k_{\\mathrm{B}} T / \\zeta$ 给出，其中 $\\zeta$ 是摩擦系数。\n- Rouse 模型中的摩擦力可加性（无流体动力学相互作用）：线性链的总摩擦力是各珠子摩擦力的总和。\n\n您的映射必须由粗粒化因子 $g$（每个粗粒化珠子所含的原子级单体数）、一个由 $N_{\\mathrm{a}}$ 个单体组成的原子级链，以及一个由 $n_{\\mathrm{c}}$ 个珠子组成的理想珠簧链来规定。这些珠子由弹簧常数为 $k$ 且静止长度为零的谐振子连接。珠子的摩擦力记为 $\\zeta_{\\mathrm{b}}$。您必须：\n\n1. 构建珠簧链，使其均方末端距与原子级链测得的均方末端距相匹配。从第一性原理出发，推导如何根据此匹配条件计算粗粒化链段的统计参数（有效链段长度），然后使用能量均分定理计算谐振子弹簧常数。\n2. 使用 Rouse 模型的摩擦力可加性和 Einstein 关系，推导如何将珠子摩擦力 $\\zeta_{\\mathrm{b}}$ 设置为粗粒化因子 $g$ 和原子级单体摩擦力 $\\zeta_{\\mathrm{m}}$ 的函数。据此，推导粗粒化链的预测扩散系数，并将其与测得的原子级扩散系数进行比较。\n3. 通过计算末端距均方值和扩散系数的相对误差来量化验证。相对误差定义为绝对差值除以每个可观测量的原子级测量值。\n\n所有量必须使用国际单位制（SI）处理。具体如下：\n\n- 温度 $T$ 单位为 $\\mathrm{K}$。\n- Boltzmann 常数 $k_{\\mathrm{B}}$ 单位为 $\\mathrm{J}/\\mathrm{K}$。\n- 摩擦系数 $\\zeta_{\\mathrm{m}}$ 和 $\\zeta_{\\mathrm{b}}$ 单位为 $\\mathrm{kg}/\\mathrm{s}$。\n- 扩散系数 $D$ 单位为 $\\mathrm{m}^2/\\mathrm{s}$。\n- 末端距均方值 $\\langle R^2 \\rangle$ 单位为 $\\mathrm{m}^2$。\n\n您必须实现一个程序，对以下参数值测试套件执行此映射和验证。在每个测试用例中，根据推导计算粗粒化参数和验证指标：\n\n- 测试用例 A（一般情况）：\n  - $N_{\\mathrm{a}} = 100$\n  - $g = 5$\n  - $\\langle R^2 \\rangle_{\\mathrm{atom}} = 9.0 \\times 10^{-16}\\ \\mathrm{m}^2$\n  - $\\zeta_{\\mathrm{m}} = 1.0 \\times 10^{-12}\\ \\mathrm{kg}/\\mathrm{s}$\n  - $T = 300\\ \\mathrm{K}$\n  - $D_{\\mathrm{atom}} = \\dfrac{k_{\\mathrm{B}} T}{N_{\\mathrm{a}} \\zeta_{\\mathrm{m}}}$（需要进行数值计算）\n  - 末端距容差 $\\varepsilon_{R^2} = 1.0 \\times 10^{-6}$\n  - 扩散容差 $\\varepsilon_{D} = 1.0 \\times 10^{-1}$\n\n- 测试用例 B（接近容差的扩散偏差）：\n  - $N_{\\mathrm{a}} = 50$\n  - $g = 10$\n  - $\\langle R^2 \\rangle_{\\mathrm{atom}} = 2.5 \\times 10^{-16}\\ \\mathrm{m}^2$\n  - $\\zeta_{\\mathrm{m}} = 5.0 \\times 10^{-13}\\ \\mathrm{kg}/\\mathrm{s}$\n  - $T = 300\\ \\mathrm{K}$\n  - $D_{\\mathrm{atom}}$ 是 Einstein 预测值 $k_{\\mathrm{B}} T / (N_{\\mathrm{a}} \\zeta_{\\mathrm{m}})$ 的 $1.08$ 倍（需要进行数值计算）\n  - $\\varepsilon_{R^2} = 1.0 \\times 10^{-6}$\n  - $\\varepsilon_{D} = 1.0 \\times 10^{-1}$\n\n- 测试用例 C（超出容差的扩散偏差）：\n  - $N_{\\mathrm{a}} = 200$\n  - $g = 4$\n  - $\\langle R^2 \\rangle_{\\mathrm{atom}} = 1.6 \\times 10^{-15}\\ \\mathrm{m}^2$\n  - $\\zeta_{\\mathrm{m}} = 2.0 \\times 10^{-12}\\ \\mathrm{kg}/\\mathrm{s}$\n  - $T = 300\\ \\mathrm{K}$\n  - $D_{\\mathrm{atom}}$ 是 Einstein 预测值 $k_{\\mathrm{B}} T / (N_{\\mathrm{a}} \\zeta_{\\mathrm{m}})$ 的 $0.75$ 倍（需要进行数值计算）\n  - $\\varepsilon_{R^2} = 1.0 \\times 10^{-6}$\n  - $\\varepsilon_{D} = 1.0 \\times 10^{-1}$\n\n对于每个测试用例，您的程序必须：\n\n- 计算粗粒化珠子数 $n_{\\mathrm{c}} = N_{\\mathrm{a}} / g$。\n- 确定匹配 $\\langle R^2 \\rangle_{\\mathrm{atom}}$ 所需的有效粗粒化链段均方长度 $b^2$。\n- 使用能量均分定理计算谐振子弹簧常数 $k$。\n- 根据单体摩擦力 $\\zeta_{\\mathrm{m}}$ 和 $g$，使用 Rouse 模型中的摩擦力可加性来设置珠子摩擦力 $\\zeta_{\\mathrm{b}}$。\n- 使用 Einstein 关系预测粗粒化链的扩散系数 $D_{\\mathrm{pred}}$。\n- 通过计算末端距均方值 $\\delta_{R^2}$ 和扩散系数 $\\delta_{D}$ 的相对误差进行验证，并检查每个误差是否小于或等于其容差。\n\n最终输出格式：您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。对于 A、B、C 的每个测试用例，按此确切顺序附加四个值：\n$[\\delta_{R^2}, \\delta_{D}, \\mathrm{pass}_{R^2}, \\mathrm{pass}_{D}]$。\n因此，最终输出将是一个长度为 $12$ 的单一列表，包含所有三个测试用例的串联结果，例如 $[x_1, x_2, x_3, x_4, x_5, x_6, x_7, x_8, x_9, x_{10}, x_{11}, x_{12}]$，其中每个 $x_i$ 要么是一个浮点数（表示相对误差），要么是一个布尔值（表示通过/失败）。\n\n所有量均以 SI 单位作答，并按规定将您的解决方案实现为一个完整的、可运行的程序。",
            "solution": "我们提出一种基于原理的推导和算法设计，它将原子级聚合物链映射到珠簧链，并使用均方末端距和扩散系数来验证粗粒化模型。通过从原子级测量的可观测量和基本统计物理定律推导粗粒化模型参数，我们尊重了材料建模方法的层次结构。\n\n定义和设置：\n\n- 设原子级链有 $N_{\\mathrm{a}}$ 个单体。我们选择一个粗粒化因子 $g$（每个珠子的单体数），得到一个包含 $n_{\\mathrm{c}}$ 个珠子的珠簧链，其中 $n_{\\mathrm{c}} = N_{\\mathrm{a}} / g$。\n- 将原子级测量的均方末端距记为 $\\langle R^2 \\rangle_{\\mathrm{atom}}$。\n- 将原子级测量的长时自扩散系数记为 $D_{\\mathrm{atom}}$。\n- 设绝对温度为 $T$，Boltzmann 常数为 $k_{\\mathrm{B}}$。\n\n基本依据：\n\n1. 能量均分定理：对于由 $U(\\mathbf{r}) = \\frac{1}{2} k \\lVert \\mathbf{r} \\rVert^2$ 描述的三维谐振子，其均方键矢量大小满足\n$$\n\\langle \\lVert \\mathbf{r} \\rVert^2 \\rangle = \\frac{3 k_{\\mathrm{B}} T}{k}.\n$$\n这是因为每个笛卡尔分量对平均能量的贡献为 $k_{\\mathrm{B}} T / 2$，所以 $\\langle U \\rangle = \\frac{3}{2} k_{\\mathrm{B}} T$，并且能量均分关系意味着 $\\frac{1}{2} k \\langle \\lVert \\mathbf{r} \\rVert^2 \\rangle = \\frac{3}{2} k_{\\mathrm{B}} T$。\n\n2. 理想高斯链统计：对于一个由 $n$ 个均值为零且具有各向同性方差 $\\langle \\lVert \\mathbf{b} \\rVert^2 \\rangle = b^2$ 的独立链段组成的链，其末端距矢量 $\\mathbf{R}$ 是链段矢量的总和，根据期望的线性和独立性，\n$$\n\\langle R^2 \\rangle = n b^2.\n$$\n这是一个经过充分检验的模型，适用于在 theta 条件下尺度大于持久长度的柔性聚合物，并作为珠簧链的基础粗粒化模型。\n\n3. 扩散的 Einstein 关系：对于一个受到摩擦系数为 $\\zeta$ 的线性阻力作用的布朗粒子，其长时自扩散系数为\n$$\nD = \\frac{k_{\\mathrm{B}} T}{\\zeta}.\n$$\n\n4. Rouse 模型中的摩擦力可加性（忽略流体动力学相互作用）：一个由 $n_{\\mathrm{c}}$ 个珠子组成的线性链的总摩擦力是单个珠子摩擦力的总和。如果每个珠子的摩擦力为 $\\zeta_{\\mathrm{b}}$，则 $\\zeta_{\\mathrm{tot}} = n_{\\mathrm{c}} \\zeta_{\\mathrm{b}}$。此外，如果每个粗粒化珠子代表 $g$ 个单体，且单体摩擦力为 $\\zeta_{\\mathrm{m}}$，那么珠子摩擦力为\n$$\n\\zeta_{\\mathrm{b}} = g \\, \\zeta_{\\mathrm{m}}.\n$$\n\n映射的推导：\n\n- 珠簧链必须匹配原子级的均方末端距。使用高斯链统计，对于具有 $n_{\\mathrm{c}}$ 个链段的粗粒化链，\n$$\n\\langle R^2 \\rangle_{\\mathrm{coarse}} = n_{\\mathrm{c}} b^2.\n$$\n施加 $\\langle R^2 \\rangle_{\\mathrm{coarse}} = \\langle R^2 \\rangle_{\\mathrm{atom}}$ 条件，得到粗粒化链段的均方长度\n$$\nb^2 = \\frac{\\langle R^2 \\rangle_{\\mathrm{atom}}}{n_{\\mathrm{c}}}.\n$$\n\n- 使用谐振子的能量均分定理，通过将链段方差与 $b^2$ 匹配来确定弹簧常数 $k$：\n$$\nb^2 \\equiv \\langle \\lVert \\mathbf{r} \\rVert^2 \\rangle = \\frac{3 k_{\\mathrm{B}} T}{k}\n\\quad \\Rightarrow \\quad\nk = \\frac{3 k_{\\mathrm{B}} T}{b^2}.\n$$\n\n- 珠子摩擦力由可加性设定：\n$$\n\\zeta_{\\mathrm{b}} = g \\, \\zeta_{\\mathrm{m}},\n$$\n因此，粗粒化链的总摩擦力为\n$$\n\\zeta_{\\mathrm{tot}} = n_{\\mathrm{c}} \\zeta_{\\mathrm{b}} = n_{\\mathrm{c}} g \\, \\zeta_{\\mathrm{m}} = N_{\\mathrm{a}} \\, \\zeta_{\\mathrm{m}}.\n$$\n注意，在 Rouse 模型中，总摩擦力在粗粒化因子 $g$ 下是不变的。\n\n- 粗粒化链的预测扩散系数则为\n$$\nD_{\\mathrm{pred}} = \\frac{k_{\\mathrm{B}} T}{\\zeta_{\\mathrm{tot}}}\n= \\frac{k_{\\mathrm{B}} T}{N_{\\mathrm{a}} \\, \\zeta_{\\mathrm{m}}}.\n$$\n\n验证指标：\n\n- 将末端距均方值的相对误差定义为\n$$\n\\delta_{R^2} = \\frac{\\left| \\langle R^2 \\rangle_{\\mathrm{coarse}} - \\langle R^2 \\rangle_{\\mathrm{atom}} \\right|}{\\langle R^2 \\rangle_{\\mathrm{atom}}}.\n$$\n- 将扩散系数的相对误差定义为\n$$\n\\delta_{D} = \\frac{\\left| D_{\\mathrm{pred}} - D_{\\mathrm{atom}} \\right|}{D_{\\mathrm{atom}}}.\n$$\n- 如果满足以下条件，则验证通过\n$$\n\\delta_{R^2} \\le \\varepsilon_{R^2}\n\\quad \\text{和} \\quad\n\\delta_{D} \\le \\varepsilon_{D},\n$$\n其中 $\\varepsilon_{R^2}$ 和 $\\varepsilon_{D}$ 是预设的容差。\n\n每个测试用例的算法步骤：\n\n1. 计算 $n_{\\mathrm{c}} = N_{\\mathrm{a}} / g$。\n2. 计算 $b^2 = \\langle R^2 \\rangle_{\\mathrm{atom}} / n_{\\mathrm{c}}$。\n3. 计算 $k = 3 k_{\\mathrm{B}} T / b^2$。\n4. 计算 $\\zeta_{\\mathrm{b}} = g \\, \\zeta_{\\mathrm{m}}$。\n5. 计算 $D_{\\mathrm{pred}} = k_{\\mathrm{B}} T / (N_{\\mathrm{a}} \\, \\zeta_{\\mathrm{m}})$。\n6. 计算 $\\delta_{R^2}$ 和 $\\delta_{D}$ 以及通过/失败的布尔值。\n\n科学真实性：\n\n- 所选参数对应于在 $T = 300\\ \\mathrm{K}$ 溶液中纳米级末端距尺寸的聚合物线圈，单体摩擦力约为 $10^{-12}\\ \\mathrm{kg}/\\mathrm{s}$，扩散系数在 $10^{-11}$ 到 $10^{-10}\\ \\mathrm{m}^2/\\mathrm{s}$ 范围内，这与 Rouse 标度和典型的实验范围一致。\n\n最终输出规范：\n\n- 生成一行包含一个列表的输出，该列表包含 $12$ 个条目，顺序为 $[\\delta_{R^2}^{(A)}, \\delta_{D}^{(A)}, \\mathrm{pass}_{R^2}^{(A)}, \\mathrm{pass}_{D}^{(A)}, \\delta_{R^2}^{(B)}, \\delta_{D}^{(B)}, \\mathrm{pass}_{R^2}^{(B)}, \\mathrm{pass}_{D}^{(B)}, \\delta_{R^2}^{(C)}, \\delta_{D}^{(C)}, \\mathrm{pass}_{R^2}^{(C)}, \\mathrm{pass}_{D}^{(C)}]$，其中上标 $(A)$、$(B)$、$(C)$ 分别代表测试用例 A、B 和 C。每个 $\\delta$ 是一个浮点数，每个 pass 是一个布尔值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_mapping_and_validation(N_a, g, R2_atom, D_atom, zeta_m, T, tol_R2, tol_D):\n    # Physical constant: Boltzmann constant (SI units: J/K)\n    k_B = 1.380649e-23\n\n    # Number of coarse beads\n    n_c = N_a / g  # test cases ensure divisibility\n\n    # Effective coarse segment mean-squared length to match R2\n    b2 = R2_atom / n_c\n\n    # Spring constant from equipartition for 3D harmonic spring\n    k = 3.0 * k_B * T / b2\n\n    # Bead friction from additivity in Rouse model\n    zeta_b = g * zeta_m\n\n    # Predicted diffusion coefficient from Einstein relation and additive friction\n    # D_pred = k_B * T / (n_c * zeta_b) = k_B * T / (N_a * zeta_m)\n    D_pred = k_B * T / (N_a * zeta_m)\n\n    # Coarse end-to-end predicted (should equal R2_atom by construction)\n    R2_pred = n_c * b2\n\n    # Relative errors\n    err_R2 = abs(R2_pred - R2_atom) / R2_atom\n    err_D = abs(D_pred - D_atom) / D_atom\n\n    # Pass/fail according to tolerances\n    pass_R2 = err_R2 = tol_R2\n    pass_D = err_D = tol_D\n\n    return err_R2, err_D, pass_R2, pass_D, n_c, b2, k, zeta_b, D_pred\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (N_a, g, R2_atom [m^2], D_atom [m^2/s], zeta_m [kg/s], T [K], tol_R2, tol_D)\n    k_B = 1.380649e-23\n    T = 300.0\n\n    # Case A parameters\n    N_a_A = 100\n    g_A = 5\n    R2_atom_A = 9.0e-16\n    zeta_m_A = 1.0e-12\n    D_atom_A = k_B * T / (N_a_A * zeta_m_A)  # exact Einstein prediction\n    tol_R2_A = 1.0e-6\n    tol_D_A = 1.0e-1\n\n    # Case B parameters (D_atom is 1.08 times the Einstein prediction)\n    N_a_B = 50\n    g_B = 10\n    R2_atom_B = 2.5e-16\n    zeta_m_B = 5.0e-13\n    D_pred_B = k_B * T / (N_a_B * zeta_m_B)\n    D_atom_B = 1.08 * D_pred_B\n    tol_R2_B = 1.0e-6\n    tol_D_B = 1.0e-1\n\n    # Case C parameters (D_atom is 0.75 times the Einstein prediction)\n    N_a_C = 200\n    g_C = 4\n    R2_atom_C = 1.6e-15\n    zeta_m_C = 2.0e-12\n    D_pred_C = k_B * T / (N_a_C * zeta_m_C)\n    D_atom_C = 0.75 * D_pred_C\n    tol_R2_C = 1.0e-6\n    tol_D_C = 1.0e-1\n\n    test_cases = [\n        (N_a_A, g_A, R2_atom_A, D_atom_A, zeta_m_A, T, tol_R2_A, tol_D_A),\n        (N_a_B, g_B, R2_atom_B, D_atom_B, zeta_m_B, T, tol_R2_B, tol_D_B),\n        (N_a_C, g_C, R2_atom_C, D_atom_C, zeta_m_C, T, tol_R2_C, tol_D_C),\n    ]\n\n    results = []\n    # We will compute required metrics and append only the requested outputs:\n    # For each case: [err_R2, err_D, pass_R2, pass_D]\n    for case in test_cases:\n        N_a, g, R2_atom, D_atom, zeta_m, T_case, tol_R2, tol_D = case\n        err_R2, err_D, pass_R2, pass_D, n_c, b2, k, zeta_b, D_pred = compute_mapping_and_validation(\n            N_a, g, R2_atom, D_atom, zeta_m, T_case, tol_R2, tol_D\n        )\n        results.extend([err_R2, err_D, str(pass_R2).lower(), str(pass_D).lower()])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}