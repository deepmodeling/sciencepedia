{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握团簇算法，通过一个简单的例子亲手推演其过程是至关重要的。这项练习将Swendsen-Wang算法应用于一个最小的$2 \\times 2$格点系统，旨在揭开其神秘面纱。通过追踪键的激活概率和团簇的翻转过程，您将具体地理解算法如何从一个自旋构型演化到另一个，为后续更复杂的应用打下坚实的基础。",
            "id": "3796429",
            "problem": "考虑一个在具有周期性边界条件的 $2\\times 2$ 方格晶格上的铁磁伊辛模型，该模型在多尺度材料模拟中用作粗粒化自旋模型。伊辛哈密顿量为 $H = -J \\sum_{\\langle i j \\rangle} s_i s_j$，其中 $J0$，$s_i \\in \\{+1,-1\\}$，求和遍及所有最近邻对 $\\langle i j \\rangle$。周期性的 $2\\times 2$ 晶格恰好有 $4$ 条无向最近邻边：两条水平边 $\\{(0,0),(1,0)\\}$ 和 $\\{(0,1),(1,1)\\}$，以及两条垂直边 $\\{(0,0),(0,1)\\}$ 和 $\\{(1,0),(1,1)\\}$，其中坐标 $(x,y)$ 满足 $x\\in\\{0,1\\}$ 和 $y\\in\\{0,1\\}$。\n\n用于伊辛模型的 Swendsen–Wang (SW) 团簇算法的步骤如下：在每条满足的最近邻边（即 $s_i s_j=+1$）上以激活概率 $p = 1 - \\exp(-2 \\beta J)$ 独立地放置键，其中 $\\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数；在不满足的边（即 $s_i s_j=-1$）上绝不放置键。由此产生的键合图将晶格划分为多个团簇（在激活的键连接下的连通分量）。然后，每个团簇以 $1/2$ 的概率独立翻转（等价地，每个团簇被独立于其他团簇地以相同概率分配一个新的共同自旋值 $+1$ 或 $-1$），从而产生一个新的自旋构型。\n\n从初始自旋构型\n$$\ns_{0,0}=+1,\\quad s_{1,0}=+1,\\quad s_{0,1}=-1,\\quad s_{1,1}=-1,\n$$\n开始，该构型的顶行自旋为+1，底行自旋为-1。仅使用基本原理（伊辛哈密顿量、玻尔兹曼权重，以及导出 SW 键规则 $p = 1 - \\exp(-2 \\beta J)$ 的 Fortuin–Kasteleyn 随机团簇表示），完成以下任务：\n\n- 枚举出此初始自旋构型的满足边可能产生的所有不同 SW 键构型，并对每种构型，识别出其产生的团簇。\n- 对于每种键构型，计算在独立团簇翻转后达到每种可能自旋构型的概率。\n\n最后，以闭式形式计算并报告从给定的初始构型到全朝上构型 $s'_{x,y}=+1$（对于所有 $(x,y)$）的总 SW 转移概率，该概率表示为键激活概率 $p$ 的解析函数。你最终报告的答案必须是单个闭式表达式；不需要进行数值舍入。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **模型**：具有周期性边界条件的 $2\\times 2$ 方格晶格上的铁磁伊辛模型。\n- **哈密顿量**：$H = -J \\sum_{\\langle i,j \\rangle} s_i s_j$，其中 $J0$。\n- **自旋**：$s_i \\in \\{+1, -1\\}$。\n- **晶格和边**：该晶格有 $4$ 个格点，由坐标 $(x,y)$ 标识，$x,y \\in \\{0,1\\}$，以及 $4$ 条无向最近邻边：$\\{(0,0),(1,0)\\}$、$\\{(0,1),(1,1)\\}$、$\\{(0,0),(0,1)\\}$ 和 $\\{(1,0),(1,1)\\}$。\n- **Swendsen-Wang (SW) 算法**：\n    - 在满足的边（$s_i s_j = +1$）上以概率 $p = 1 - \\exp(-2 \\beta J)$ 放置键。\n    - 不在不满足的边（$s_i s_j = -1$）上放置键。\n    - 团簇（连通分量）以 $1/2$ 的概率独立翻转。\n- **初始自旋构型**：$s_{0,0}=+1$，$s_{1,0}=+1$，$s_{0,1}=-1$，$s_{1,1}=-1$。\n- **任务**：计算从初始构型到全朝上构型（所有 $(x,y)$ 的 $s'_{x,y}=+1$）的总转移概率，表示为 $p$ 的解析函数。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础**：该问题基于标准的伊辛模型和 Swendsen-Wang 算法，这些是统计力学和计算物理学中的基本概念。关系式 $p = 1 - \\exp(-2\\beta J)$ 是支撑 SW 算法的 Fortuin-Kasteleyn 表示的基石。\n- **良构性**：该问题提供了一个特定的初始状态、一个明确定义的随机过程（SW 算法的一步）以及一个特定的目标最终状态。这使得可以计算出唯一且有意义的转移概率。\n- **客观性**：该问题以精确、无歧义的数学和物理术语陈述。\n- **完整性与一致性**：对于这种拓扑结构，关于具有4条边的周期性边界条件的 $2 \\times 2$ 晶格的描述是正确的。所有必需的参数和规则都已指定。没有矛盾之处。\n- **现实性**：该设置是一个标准的、尽管很小的系统，用于阐释计算统计力学中的概念。在此理论背景下，它是完全现实的。\n\n**步骤3：结论与行动**\n该问题是有效的。它在科学上是合理的、良构的，并且提供了所有必要的信息。我现在将开始解答。\n\n### 解答\n\n解答过程是应用 Swendsen-Wang (SW) 算法的规则进行单次更新步骤。总转移概率是所有可能的中间键构型的概率之和。\n\n**1. 识别满足和不满足的边**\n初始自旋构型由 $s_{0,0}=+1$，$s_{1,0}=+1$，$s_{0,1}=-1$ 和 $s_{1,1}=-1$ 给出。我们检查四个最近邻边的状态：\n- 边 $e_1 = \\langle(0,0), (1,0)\\rangle$：自旋为 $s_{0,0}=+1$ 和 $s_{1,0}=+1$。乘积为 $s_{0,0}s_{1,0} = (+1)(+1) = +1$。这条边是**满足的**。\n- 边 $e_2 = \\langle(0,1), (1,1)\\rangle$：自旋为 $s_{0,1}=-1$ 和 $s_{1,1}=-1$。乘积为 $s_{0,1}s_{1,1} = (-1)(-1) = +1$。这条边是**满足的**。\n- 边 $e_3 = \\langle(0,0), (0,1)\\rangle$：自旋为 $s_{0,0}=+1$ 和 $s_{0,1}=-1$。乘积为 $s_{0,0}s_{0,1} = (+1)(-1) = -1$。这条边是**不满足的**。\n- 边 $e_4 = \\langle(1,0), (1,1)\\rangle$：自旋为 $s_{1,0}=+1$ 和 $s_{1,1}=-1$。乘积为 $s_{1,0}s_{1,1} = (+1)(-1) = -1$。这条边是**不满足的**。\n\n根据 SW 算法，键只放置在满足的边上。因此，我们只需要考虑在边 $e_1$ 和 $e_2$ 上放置键。这两条边中的每一条都有一个键以概率 $p$ 独立地放置在其上。这给出了 $2^2=4$ 种可能的键构型。\n\n**2. 枚举键构型并计算转移概率**\n对于每种键构型，我们确定其产生的团簇，对其进行计数 ($k$)，并计算达到全朝上构型（所有格点的 $s'_{x,y}=+1$）的条件概率。这要求每个团簇都被赋予 $+1$ 的新自旋，其发生概率为 $(1/2)^k$。\n\n- **构型1：没有键被激活。**\n  - 此构型的概率：$(1-p)(1-p) = (1-p)^2$。\n  - 团簇：$4$ 个格点中的每一个都是一个独立的团簇：$\\{(0,0)\\}$, $\\{(1,0)\\}$, $\\{(0,1)\\}$, $\\{(1,1)\\}$。\n  - 团簇数量：$k=4$。\n  - 达到全朝上状态的概率：$(1/2)^4 = 1/16$。\n  - 对总概率的贡献：$\\frac{1}{16}(1-p)^2$。\n\n- **构型2：仅在边 $e_1$ 上有键。**\n  - 此构型的概率：$p(1-p)$。\n  - 团簇：格点 $(0,0)$ 和 $(1,0)$ 相连，形成一个团簇。另外两个格点是孤立的。团簇为：$\\{(0,0), (1,0)\\}$, $\\{(0,1)\\}$, $\\{(1,1)\\}$。\n  - 团簇数量：$k=3$。\n  - 达到全朝上状态的概率：$(1/2)^3 = 1/8$。\n  - 对总概率的贡献：$\\frac{1}{8}p(1-p)$。\n\n- **构型3：仅在边 $e_2$ 上有键。**\n  - 此构型的概率：$(1-p)p$。\n  - 团簇：格点 $(0,1)$ 和 $(1,1)$ 相连。团簇为：$\\{(0,0)\\}$, $\\{(1,0)\\}$, $\\{(0,1), (1,1)\\}$。\n  - 团簇数量：$k=3$。\n  - 达到全朝上状态的概率：$(1/2)^3 = 1/8$。\n  - 对总概率的贡献：$\\frac{1}{8}p(1-p)$。\n\n- **构型4：边 $e_1$ 和 $e_2$ 上都有键。**\n  - 此构型的概率：$p \\cdot p = p^2$。\n  - 团簇：顶部的两个格点形成一个团簇，底部的两个格点形成另一个团簇。团簇为：$\\{(0,0), (1,0)\\}$, $\\{(0,1), (1,1)\\}$。\n  - 团簇数量：$k=2$。\n  - 达到全朝上状态的概率：$(1/2)^2 = 1/4$。\n  - 对总概率的贡献：$\\frac{1}{4}p^2$。\n\n**3. 计算总转移概率**\n从给定的初始构型转换到全朝上构型的总概率 $P_{total}$ 是所有四种可能的键构型贡献的总和。\n\n$$P_{total} = \\frac{1}{16}(1-p)^2 + \\frac{1}{8}p(1-p) + \\frac{1}{8}p(1-p) + \\frac{1}{4}p^2$$\n\n我们简化这个表达式：\n$$P_{total} = \\frac{1}{16}(1-p)^2 + \\frac{2}{8}p(1-p) + \\frac{1}{4}p^2$$\n$$P_{total} = \\frac{1}{16}(1-p)^2 + \\frac{1}{4}p(1-p) + \\frac{1}{4}p^2$$\n将所有项通分，公分母为 $16$：\n$$P_{total} = \\frac{1(1-2p+p^2)}{16} + \\frac{4(p-p^2)}{16} + \\frac{4p^2}{16}$$\n$$P_{total} = \\frac{1-2p+p^2 + 4p-4p^2 + 4p^2}{16}$$\n合并分子中的同类项：\n$$P_{total} = \\frac{1 + (-2p+4p) + (p^2-4p^2+4p^2)}{16}$$\n$$P_{total} = \\frac{1 + 2p + p^2}{16}$$\n这个分子是一个完全平方 $(1+p)^2$。因此，总转移概率是：\n$$P_{total} = \\frac{(1+p)^2}{16}$$\n\n这是作为键激活概率 $p$ 的函数的转移概率的最终闭式表达式。",
            "answer": "$$\\boxed{\\frac{(1+p)^2}{16}}$$"
        },
        {
            "introduction": "真实的材料模型往往比简单的铁磁相互作用更为复杂，而团簇算法的威力在于其强大的适应性。本练习旨在展示如何将团簇方法应用于一个含交错场的反铁磁模型——这是材料科学中的一个常见场景。通过解决这个问题，您将学会如何运用交错变换和“幽灵自旋”等技巧，将复杂问题映射回可解的铁磁形式，从而掌握推广团簇算法的核心思想。",
            "id": "3796401",
            "problem": "考虑一个线性尺寸为 $L$ 的二维方格晶格，其具有周期性边界条件。晶格是二分的，其格点由整数坐标 $(x_i,y_i)$ 索引，并通过宇称划分为两个子晶格，因此有 $\\varepsilon_i = (-1)^{x_i+y_i} \\in \\{-1,+1\\}$。设伊辛自旋 $s_i \\in \\{-1,+1\\}$ 位于这些格点上。在交错场中，反铁磁最近邻哈密顿量为\n$$\nH(s) \\;=\\; J \\sum_{\\langle i j \\rangle} s_i s_j \\;-\\; \\sum_{i} h_i s_i,\n$$\n其中 $J0$，逆温度为 $\\beta$，交错场为 $h_i = \\varepsilon_i h$，其中均匀振幅 $h \\ge 0$。玻尔兹曼权重由 $P(s) \\propto \\exp(-\\beta H(s))$ 给出。在多尺度材料模拟中，采样必须保持由 $\\varepsilon_i$ 编码的交错对称性，同时能够通过团簇算法实现高效的大规模集体更新。\n\n从玻尔兹曼分布和二分结构出发，构造一个团簇嵌入，通过将变量变换到一个表示，使得团簇可由铁磁耦合和均匀场形成，从而保持交错对称性。引入所需的最小附加自由度，以将均匀场嵌入到团簇构造中，同时不违反细致平衡。然后，从随机团簇 (Fortuin–Kasteleyn) 表示的第一性原理出发，推导出最近邻格点之间以及晶格格点与辅助自由度之间的键激活概率的闭合形式表达式，该表达式应以 $\\beta$、$J$ 和 $h$ 表示。\n\n将最终答案表示为一个单一的解析行向量，包含两个激活概率：一个用于最近邻键，另一个用于与辅助自由度相连的键。无需进行数值计算。",
            "solution": "该问题要求推导应用于二分晶格上处于交错磁场中的二维反铁磁伊辛模型的团簇算法的键激活概率。推导必须在将上述问题变换到一个合适的表示之后，从第一性原理出发进行。\n\n### 步骤 1：问题验证\n\n**1.1. 提取给定条件：**\n-   **系统：** 一个线性尺寸为 $L$ 的二分二维方格晶格。\n-   **格点索引：** $(x_i, y_i)$。\n-   **子晶格划分：** $\\varepsilon_i = (-1)^{x_i+y_i} \\in \\{-1,+1\\}$。\n-   **自旋变量：** 每个格点 $i$ 上的 $s_i \\in \\{-1,+1\\}$。\n-   **哈密顿量：** $H(s) = J \\sum_{\\langle i j \\rangle} s_i s_j - \\sum_{i} h_i s_i$。\n-   **参数：**\n    -   反铁磁耦合：$J  0$。\n    -   逆温度：$\\beta$。\n    -   交错场：$h_i = \\varepsilon_i h$，其中均匀振幅 $h \\ge 0$。\n-   **统计权重：** 玻尔兹曼权重 $P(s) \\propto \\exp(-\\beta H(s))$。\n-   **任务：**\n    1.  通过变换到一个具有均匀场的铁磁表示，构造一个保持交错对称性的团簇嵌入。\n    2.  引入最小的辅助自由度来处理均匀场。\n    3.  从随机团簇表示的第一性原理出发，推导 (a) 最近邻格点之间和 (b) 格点与辅助自由度之间的键激活概率的闭合形式表达式。\n\n**1.2. 使用提取的给定条件进行验证：**\n-   **科学基础：** 该问题描述了方格晶格上带有交错场的反铁磁伊辛模型。这是统计物理学中用于研究反铁磁性和量子临界点的经典模型。使用团簇算法（如 Swendsen-Wang 或 Wolff 算法）和随机团簇 (Fortuin-Kasteleyn, FK) 表示是计算统计力学中用于克服临界慢化的标准且强大的技术。所提议的变换和嵌入是成熟的方法。该问题在科学上是合理的，在事实上是正确的。\n-   **适定性：** 目标是基于一个明确定义的物理模型和一个标准的理论框架，推导出特定的解析表达式（键概率）。必要的信息（$H$，晶格结构，参数）均已提供。存在一个唯一的、有意义的解，并且可以通过系统的方法推导出来。\n-   **客观性：** 该问题以精确、客观的数学和物理语言陈述。它不包含任何主观论断、歧义或模糊之处。\n\n**1.3. 结论与行动：**\n该问题有效。它是一个计算统计物理学中适定的、有科学依据的问题。可以开始求解过程。\n\n### 步骤 2：键概率的推导\n\n**2.1. 变换到铁磁表示**\n哈密顿量包含一个反铁磁相互作用项 $J \\sum s_i s_j$，其中 $J0$。标准形式的团簇算法是为铁磁相互作用制定的。方格晶格的二分性质允许进行一种变换，将反铁磁模型映射到铁磁模型。对于任意一对最近邻格点 $\\langle i, j \\rangle$，这两个格点属于不同的子晶格，这意味着 $\\varepsilon_i \\varepsilon_j = -1$。\n\n我们引入一组由交错变换定义的新自旋变量 $\\sigma_i$：\n$$ \\sigma_i = \\varepsilon_i s_i $$\n逆变换为 $s_i = \\varepsilon_i \\sigma_i$，因为 $\\varepsilon_i^2 = (-1)^{2(x_i+y_i)} = 1$。现在我们用 $\\sigma_i$ 变量重写哈密顿量。\n\n相互作用项变为：\n$$ J \\sum_{\\langle i j \\rangle} s_i s_j = J \\sum_{\\langle i j \\rangle} (\\varepsilon_i \\sigma_i)(\\varepsilon_j \\sigma_j) = J \\sum_{\\langle i j \\rangle} (\\varepsilon_i \\varepsilon_j) \\sigma_i \\sigma_j $$\n由于对于最近邻，$\\varepsilon_j = -\\varepsilon_i$，我们有 $\\varepsilon_i \\varepsilon_j = -1$。因此，相互作用项为：\n$$ J \\sum_{\\langle i j \\rangle} s_i s_j = -J \\sum_{\\langle i j \\rangle} \\sigma_i \\sigma_j $$\n这是一个耦合强度为 $J$ 的铁磁相互作用。\n\n磁场项变为：\n$$ -\\sum_i h_i s_i = -\\sum_i (\\varepsilon_i h) s_i = -h \\sum_i \\varepsilon_i (\\varepsilon_i \\sigma_i) = -h \\sum_i \\varepsilon_i^2 \\sigma_i $$\n由于 $\\varepsilon_i^2=1$，磁场项简化为：\n$$ -\\sum_i h_i s_i = -h \\sum_i \\sigma_i $$\n这是一个作用在 $\\sigma_i$ 自旋上、强度为 $h$ 的均匀磁场。\n\n变换后的哈密顿量，记为 $H'(\\sigma)$，是：\n$$ H'(\\sigma) = -J \\sum_{\\langle i j \\rangle} \\sigma_i \\sigma_j - h \\sum_i \\sigma_i $$\n玻尔兹曼权重现在是 $P(\\sigma) \\propto \\exp(-\\beta H'(\\sigma))$。这描述了一个处于均匀外场中的铁磁伊辛模型。\n\n**2.2. 嵌入均匀场**\n均匀磁场项 $-h \\sum_i \\sigma_i$ 的存在破坏了模型的全局自旋翻转对称性 ($\\sigma \\to -\\sigma$)。标准的团簇算法依赖于这种对称性。为了恢复一种适用于团簇方法的表述，我们通过引入一个单一的辅助自由度，将磁场项嵌入到相互作用结构中。这个“幽灵自旋”，记为 $\\sigma_0$，被永久固定为 $\\sigma_0=+1$。\n\n均匀磁场项可以重写为与这个幽灵自旋的相互作用：\n$$ -h \\sum_i \\sigma_i = -h \\sum_i \\sigma_i \\sigma_0 $$\n哈密顿量于是可以在一个包含原始 $N$ 个晶格格点和附加格点 $0$ 的扩展图上表示：\n$$ H''(\\sigma) = -J \\sum_{\\langle i j \\rangle} \\sigma_i \\sigma_j - h \\sum_{i} \\sigma_i \\sigma_0 $$\n这个哈密顿量描述了一个在具有两种键的图上的纯铁磁伊辛模型（没有外场）：\n1.  晶格上最近邻格点 $i$ 和 $j$ 之间的键，耦合强度为 $J$。\n2.  每个晶格格点 $i$ 和幽灵格点 $0$ 之间的键，耦合强度为 $h$。\n\n**2.3. 从 Fortuin-Kasteleyn 表示推导**\n随机团簇 (FK) 表示为团簇算法提供了理论基础。铁磁伊辛模型的配分函数 $Z$ 可以表示为对自旋构型 $\\{\\sigma\\}$ 和键图构型 $\\{G\\}$ 的求和。关键的恒等式将一对相互作用自旋的玻尔兹曼权重与一个概率性的键联系起来。\n\n对于哈密顿量中通过 $-K_{ab} \\sigma_a \\sigma_b$ 项相互作用的任意一对自旋 $\\sigma_a, \\sigma_b$，其对应的玻尔兹曼因子是 $\\exp(\\beta K_{ab} \\sigma_a \\sigma_b)$。这个因子可以分解为：\n$$ \\exp(\\beta K_{ab} \\sigma_a \\sigma_b) = \\exp(-\\beta K_{ab}) + \\left[ \\exp(\\beta K_{ab}) - \\exp(-\\beta K_{ab}) \\right] \\delta_{\\sigma_a, \\sigma_b} $$\n其中 $\\delta_{\\sigma_a, \\sigma_b}$ 是克罗内克 delta 函数。这可以重写为：\n$$ \\exp(\\beta K_{ab} \\sigma_a \\sigma_b) = \\exp(-\\beta K_{ab}) \\left[ 1 + \\left( \\exp(2\\beta K_{ab}) - 1 \\right) \\delta_{\\sigma_a, \\sigma_b} \\right] $$\n在 Swendsen-Wang 或 Wolff 团簇算法的背景下，只有当格点 $a$ 和 $b$ 的自旋方向一致（$\\sigma_a = \\sigma_b$）时，才考虑在它们之间激活一个键。激活这样一个键的概率 $p_{ab}$ 必须满足细致平衡。对团簇翻转的细致平衡推导表明，如果选择键激活概率为以下形式，则该条件得到满足：\n$$ p_{ab} = 1 - \\exp(-2\\beta K_{ab}) $$\n这个选择使得团簇翻转及其逆过程的跃迁概率之比等于相应微观态的玻尔兹曼权重之比。\n\n现在我们将这个一般结果应用于我们的有效哈密顿量 $H''(\\sigma)$ 中的两种相互作用。\n\n**2.3.1. 最近邻格点之间的键**\n对于连接晶格上最近邻格点 $i$ 和 $j$ 的键，耦合常数为 $K_{ij}=J$。因此，相应的键激活概率 $p_{\\text{NN}}$ 为：\n$$ p_{\\text{NN}} = 1 - \\exp(-2\\beta J) $$\n\n**2.3.2. 与辅助自由度相连的键**\n对于连接晶格格点 $i$ 和幽灵自旋格点 $0$ 的键，耦合常数为 $K_{i0}=h$。因此，相应的键激活概率 $p_{\\text{ghost}}$ 为：\n$$ p_{\\text{ghost}} = 1 - \\exp(-2\\beta h) $$\n\n这两个概率定义了团簇的构造规则。在一个团簇更新步骤中，对于每一对具有耦合 $K_{ab}$ 且处于相同状态（$\\sigma_a = \\sigma_b$）的相互作用自旋 $(\\sigma_a, \\sigma_b)$，以概率 $p_{ab} = 1 - \\exp(-2\\beta K_{ab})$ 在它们之间“冻结”一个键。然后，团簇被定义为所生成的键图的连通分量，每个团簇以概率 $1/2$ 被翻转（对于 Swendsen-Wang 算法），或者单个团簇被生长并翻转（对于 Wolff 算法）。推导出的概率对这两种算法都是基础。\n\n最终答案是这两个概率的集合，按要求以行向量的形式呈现。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1 - \\exp(-2\\beta J)  1 - \\exp(-2\\beta h) \\end{pmatrix} } $$"
        },
        {
            "introduction": "一个有效的蒙特卡洛算法不仅要高效，更要保证结果的正确性，这意味着它必须能遍历所有相关的状态空间，即满足遍历性。本练习通过一个思想实验，探讨了在周期性边界条件下，一个看似合理的算法修改为何会导致遍历性失效，这在处理相变问题时尤为关键。通过分析这个问题，您将深刻理解在设计或修改模拟算法时，为何必须遵循马尔可夫链的基本原理。",
            "id": "3796449",
            "problem": "考虑一个线性尺寸为 $L$ 的周期性方格晶格（一个环面）上的铁磁伊辛模型，其哈密顿量为 $H(\\{s_i\\})=-J\\sum_{\\langle i j\\rangle} s_i s_j$，其中 $J0$，$s_i\\in\\{-1,+1\\}$，并且求和遍历最近邻。\n\n在二维空间中，当逆温度 $\\beta  \\beta_c$ 时，系统处于对称性破缺相，具有两个磁化符号扇区。一种标准的团簇更新算法（例如Wolff算法）通过以概率 $p=1-\\mathrm{e}^{-2\\beta J}$ 占据自旋相同的键来构建单个团簇，并以 $1$ 的接受概率翻转整个连通分量；这在零外场下满足相对于玻尔兹曼分布的细致平衡条件。\n\n考虑以下旨在“避免拓扑翻转”的修正更新提议：在构建一个Wolff团簇后，如果提议的团簇具有非平凡缠绕（即，它在至少一个晶格方向上环绕环面），则该提议被确定性地拒绝；否则，翻转该团簇。马尔可夫链的其余部分仅由这些团簇更新组成。\n\n仅使用马尔可夫链、遍历性的基本定义以及所述的伊辛模型和团簇构建规则，推断此修正提议是否会在对称性破缺相中违反遍历性。识别一个具体的反例构型和机制来显示这种违反（如果存在），并提出一个最小的修正方案，在恢复遍历性的同时保持正确的稳态分布。选择那些正确提供有效反例和最小遍历性恢复修复方案的选项。\n\nA. 反例：在 $L\\times L$ 环面上，对于 $\\beta\\beta_c$，当 $L\\to\\infty$ 时，多数自旋以一个不为零的下界概率形成一个缠绕（非平凡缠绕）团簇。从全为$+1$的构型开始，任何可能反转磁化符号的多数自旋团簇都必然是缠绕的，因此是不可翻转的；翻转任何非缠绕团簇都不能改变全局磁化符号，因此马尔可夫链无法连接两个对称性破缺的扇区。最小修复方案：以小概率 $\\varepsilon0$ 增广动力学，加入一个翻转所有自旋 $s_i\\mapsto -s_i$ 的全局自旋翻转提议；在零场下 $\\Delta H=0$，因此接受概率为 $1$，并且增加的移动连接了两个扇区，同时保持了细致平衡。\n\nB. 反例：对于任何 $\\beta$，禁止缠绕团簇不影响遍历性，因为有限多个非缠绕团簇的连续翻转总能反转全局磁化。最小修复方案：无需更改。\n\nC. 反例：对于 $\\beta\\beta_c$，修正后的更新是非遍历的，但问题在于细致平衡的失效，而非扇区连通性问题。最小修复方案：将键概率减半至 $p\\mapsto p/2$，使得大团簇更稀有；这可以在不增加额外移动的情况下恢复遍历性。\n\nD. 反例：在环面上，对于 $\\beta\\beta_c$，一旦存在多数相的缠绕团簇，禁止翻转任何缠绕团簇会阻止在 $+m$ 和 $-m$ 磁化扇区之间的跃迁，因为任何非缠绕的少数自旋岛的翻转都会增加磁化的大小，而任何非缠绕的多数自旋子集的翻转（在Wolff连通性下不能断开缠绕主干）都不能移除渗流主干。最小修复方案：以小概率 $\\varepsilon0$ 混入一个局域单自旋Metropolis更新（例如，一次均匀随机选择的自旋翻转尝试，以概率 $\\min\\{1,\\mathrm{e}^{-\\beta \\Delta H}\\}$ 接受）。两个满足细致平衡的核（团簇和局域）的混合对于玻尔兹曼分布仍然是可逆的，并通过允许扇区之间的通信来恢复遍历性。\n\n选择所有适用项。",
            "solution": "问题陈述是计算统计物理学中一个有效的、适定的问题。它在科学上基于伊辛模型、马尔可夫链蒙特卡洛方法和相变理论的原理。术语精确，前提一致。我们可以继续进行分析。\n\n核心问题是所提出的对Wolff团簇算法的修正是否违反了遍历性。一个马尔可夫链如果既是不可约的又是非周期的，则它是遍历的。就本问题而言，关键性质是不可约性，这意味着从构型空间中的任何状态出发，在有限步内到达任何其他状态的概率都非零。构型空间由所有可能的自旋构型 $\\{s_i\\}$ 组成，目标稳态分布是玻尔兹曼分布 $P(\\{s_i\\}) \\propto \\exp(-\\beta H(\\{s_i\\}))$，当 $\\beta$ 有限时，该分布对所有构型都非零。\n\n系统是在逆温度 $\\beta  \\beta_c$ 下的 $L \\times L$ 环面上的二维铁磁伊辛模型。在这个区域（对称性破缺相），系统的自由能景观有两个深度的极小值点，分别对应于主要为正磁化强度（$M = \\sum_i s_i  0$）的状态和主要为负磁化强度（$M  0$）的状态。为了使算法具有遍历性，它必须能够在这两个构型空间扇区之间产生跃迁。\n\n标准的Wolff算法是遍历的。它的工作原理是从一个随机选择的位点 $i$ 开始，构建一个同号自旋的团簇。相邻的同号自旋 $(j, k)$ 之间的键以概率 $p = 1 - \\exp(-2\\beta J)$ 添加。然后整个团簇被翻转。在低温下（$\\beta  \\beta_c$），一个典型的构型由一个大的、渗流的多数自旋取向“海洋”和点缀其间的一些少数自旋取向的小“岛屿”组成。Wolff算法可以在这个多数自旋海洋中选择一个自旋，并生长出一个同样很大且经常环绕环面的团簇。翻转这样一个大团簇可以改变全局磁化的符号，从而使得在两个对称性破缺扇区之间的跃迁成为可能。\n\n所提出的修正是，如果团簇表现出非平凡缠绕（即，它环绕着环面），则确定性地拒绝任何提议的团簇翻转。我们必须分析这个拒绝规则的后果。\n\n**反例与遍历性违反机制**\n\n考虑一个在有序相深处（$\\beta \\gg \\beta_c$）的典型构型，例如，一个具有大正磁化强度的构型。这个构型将由$+1$自旋主导，它们形成一个单一的、大的连通分量，在至少一个方向上（通常是两个方向上）环绕环面。这是渗流理论的一个标准结果；多数自旋的密度远高于渗流阈值。\n\n要从这个正磁化状态跃迁到负磁化状态，必须翻转系统中相当大一部分的自旋。具体来说，如果初始磁化强度是 $M_{initial}0$，必须将超过 $M_{initial}/2$ 个自旋从 $+1$ 翻转到 $-1$，才能使最终磁化强度为负。一个包含如此多自旋的、从多数相中抽取的团簇，几乎肯定会是一个缠绕团簇，特别是对于大晶格尺寸 $L$。\n\n在修正的规则下，任何翻转这样一个缠绕团簇的尝试都会被拒绝。该算法只能执行两种类型的成功翻转：\n$1.$ 翻转一个小的、非缠绕的少数自旋岛（例如，$-1$自旋）。这会把它们变成$+1$自旋，从而增加正磁化的大小，并将系统更深地推入正扇区。\n$2.$ 翻转多数（$+1$）自旋海洋中的一个小的、非缠绕部分。这会在仍然缠绕的$+1$海洋中创建一个$-1$自旋岛。这一移动会减少磁化强度，但不能改变其符号。\n\n本质上，没有任何单一的移动或一系列允许的移动能够跨越正负磁化扇区之间的鸿沟。状态空间被分割成至少两个不连通的集合（互通类），$\\Omega_+ = \\{\\{s_i\\} | M  \\delta\\}$ 和 $\\Omega_- = \\{\\{s_i\\} | M  -\\delta\\}$（对于某个 $\\delta  0$），它们之间不可能发生跃迁。这违反了不可约性。因此，修正后的算法是非遍历的。\n\n**恢复遍历性的最小修正**\n\n为了恢复遍历性，必须引入至少一种能够连接不连通扇区的移动类型，同时仍然满足相对于玻尔兹曼分布的细致平衡条件。\n\n$1.$ **全局自旋翻转：** 提议翻转系统中所有的自旋，即对所有 $i$ 执行 $s_i \\mapsto -s_i$。对于给定的哈密顿量 $H(\\{s_i\\})=-J\\sum_{\\langle i j\\rangle} s_i s_j$，全局翻转的能量变化为 $\\Delta H = H(\\{-s_i\\}) - H(\\{s_i\\}) = -J\\sum_{\\langle i j\\rangle} (-s_i)(-s_j) - (-J\\sum_{\\langle i j\\rangle} s_i s_j) = 0$。Metropolis接受概率为 $\\min\\{1, \\exp(-\\beta \\Delta H)\\} = 1$。这个移动总是将一个状态 $\\{s_i\\}$ 与 $\\{-s_i\\}$ 连接起来，从而直接联系起正负磁化扇区。将此移动混入马尔可夫链（例如，以小概率 $\\varepsilon  0$ 尝试它）可以恢复不可约性并满足细致平衡。\n\n$2.$ **局域Metropolis更新：** 提议翻转一个随机选择的单个自旋 $s_k$。接受概率由标准Metropolis规则给出，$P_{acc} = \\min\\{1, \\exp(-\\beta \\Delta H_k)\\}$，其中 $\\Delta H_k$ 是局域能量变化。一系列单自旋翻转可以连接任何两个构型，因此这种移动类型本身就是遍历的。将局域更新与修正的团簇算法混合，可以确保整个链是不可约的并满足细致平衡。\n\n两者都是有效的最小修复方案。现在我们来评估各个选项。\n\n**选项A. 分析**\n- **反例：** 该选项正确地指出，对于 $\\beta  \\beta_c$，多数自旋相会形成一个缠绕团簇。它正确地论证了，任何大到足以反转磁化符号的团簇都将是一个缠绕团簇，而禁止其翻转会阻止两个对称性破缺扇区之间的跃迁。这个分析是完全合理的。\n- **最小修复方案：** 该选项提议用全局自旋翻转移动来增广动力学。它正确地指出，对于零场伊辛模型，此移动的 $\\Delta H=0$，接受概率为 $1$，并且它恢复了扇区之间的连通性，同时保持了细致平衡。这是一个有效且最小的修复方案。\n- **结论：** 正确。\n\n**选项B. 分析**\n- **反例：** 该选项声称禁止缠绕团簇不影响遍历性，正如我们的分析所表明的，这是错误的。其推理“有限多个非缠绕团簇的连续翻转总能反转全局磁化”在有序相中是不正确的，因为系统会被困在一个磁化扇区中。\n- **最小修复方案：** 它错误地指出无需更改。\n- **结论：** 错误。\n\n**选项C. 分析**\n- **反例：** 该选项正确地指出更新是非遍历的，但错误地声称问题是细致平衡的失效，而不是扇区连通性（不可约性）问题。修正后的更新规则*确实*对其允许的跃迁满足细致平衡。问题在于某些关键跃迁的概率恰好为零。\n- **最小修复方案：** 这提议改变键概率 $p$。改变定义 $p=1-\\mathrm{e}^{-2\\beta J}$ 会破坏Wolff构造相对于目标玻尔兹曼分布的细致平衡条件。最终的算法会从一个不正确的分布中抽样。这不是一个有效的修复方案。\n- **结论：** 错误。\n\n**选项D. 分析**\n- **反例：** 该选项提供了对遍历性违反的正确描述。它准确地描述了非缠绕的少数自旋岛的翻转如何加强当前的磁化扇区，以及多数自旋海洋的非缠绕部分的翻转如何无法克服渗流主干来翻转全局符号。这是一个正确且详细的机制。\n- **最小修复方案：** 该选项提议混入局域单自旋Metropolis更新。它正确地指出，这是一个恢复遍历性的有效方法，因为两个满足细致平衡的核的混合也满足细致平衡，并且局域更新核是不可约的。这是一个标准的、有效的、最小的修复方案。\n- **结论：** 正确。\n\n选项A和D都提供了一个有效的反例和一个有效的最小修复方案。因此，这两个选项都是正确的。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}