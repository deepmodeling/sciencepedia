{
    "hands_on_practices": [
        {
            "introduction": "在模拟中应用Nosé-Hoover恒温器之前，一个至关重要的前提是正确设定其目标动能。本练习将引导你处理一个实际模拟中常见且微妙的挑战：对于包含刚体和平动约束的复杂系统，如何精确计算其有效自由度。正确完成此项任务是确保模拟能够复现正确系综性质的基础。",
            "id": "3788515",
            "problem": "考虑一个三维分子动力学（MD）模拟，对象是一个粗粒化流体，其中每个分子都被视为一个刚体。假设总共有 $N$ 个分子，其中 $M$ 个是线性刚体（由于其主转动惯量为零，围绕分子轴的旋转不产生动能），而剩下的 $N - M$ 个是非线性刚体。分子 $i$ 的刚体动能是平动二次型和转动二次型之和，每一项都由一个半正定质量矩阵定义；对于线性刚体，转动惯量张量的秩为 $2$，而对于非线性刚体，其秩为 $3$。数值积分器在每一步都会移除总线性动量，以使整个系统的质心速度恒为零。该系统与一个 Nosé–Hoover 恒温器耦合，以在温度 $T$ 下对正则系综进行采样，其中 $T$ 是热力学温度，$k_B$ 是玻尔兹曼常数。\n\n仅从正则系综中二次自由度的能量均分原理和动能的刚体结构出发，确定该系统中对动能有贡献的有效二次自由度的数量。然后使用这个数量，以闭合形式写出恒温器为施加正则温度所需的能量匹配条件中出现的目标动能。您的答案必须是一个用 $N$、$M$、$k_B$ 和 $T$ 表示的单一解析表达式。不需要任何数值，并且除了此处陈述的基本原理外，不应假定任何中间公式。最终表达式不需要单位。如果您选择呈现任何中间量，请确保所有数学表达式都使用 LaTeX 格式。请仅提供最终表达式作为您的答案。",
            "solution": "该问题要求确定一个由 $N$ 个刚性分子组成的、与 Nosé–Hoover 恒温器耦合的系统的目标动能，该恒温器旨在维持恒定的平均温度 $T$。这个目标动能是系统在正则系综中的动能的系综平均值 $\\langle K \\rangle$。经典统计力学的能量均分原理指出，对于处于热平衡状态的系统，哈密顿量中的每个二次自由度贡献的平均能量为 $\\frac{1}{2} k_B T$，其中 $k_B$ 是玻尔兹曼常数。因此，任务简化为找到对系统动能有贡献的有效二次自由度的总数 $N_{dof}$。目标动能则由以下表达式给出：\n$$ \\langle K \\rangle = \\frac{1}{2} N_{dof} k_B T $$\n\n系统的总动能 $K$ 是所有 $N$ 个分子动能的总和。每个分子的动能是其平动动能和转动动能之和。我们必须确定这个总和中独立二次项的数量。\n\n首先，我们考虑平动自由度。在三维空间中，相对于其平动运动，$N$ 个分子中的每一个都可以看作一个质点。单个质量为 $m_i$、速度为 $\\mathbf{v}_i = (v_{ix}, v_{iy}, v_{iz})$ 的分子 $i$ 的平动动能由下式给出：\n$$ K_{i, \\text{trans}} = \\frac{1}{2} m_i |\\mathbf{v}_i|^2 = \\frac{1}{2} m_i (v_{ix}^2 + v_{iy}^2 + v_{iz}^2) $$\n该表达式包含 3 个速度分量的二次项。对于一个由 $N$ 个分子组成的系统，名义上将有 $3N$ 个平动自由度。然而，问题陈述了一个约束：系统的总线性动量保持为零。这对应于将质心速度设为零。总线性动量 $\\mathbf{P}$ 为：\n$$ \\mathbf{P} = \\sum_{i=1}^N m_i \\mathbf{v}_i = \\mathbf{0} $$\n这是一个矢量方程，意味着对粒子的速度分量有三个标量约束：\n$$ \\sum_{i=1}^N m_i v_{ix} = 0 $$\n$$ \\sum_{i=1}^N m_i v_{iy} = 0 $$\n$$ \\sum_{i=1}^N m_i v_{iz} = 0 $$\n这些线性约束中的每一个都从系统中移除了一个自由度。因此，独立平动自由度的总数 $N_{dof, \\text{trans}}$ 不是 $3N$，而是：\n$$ N_{dof, \\text{trans}} = 3N - 3 $$\n\n接下来，我们考虑转动自由度。该系统包含 $M$ 个线性刚体和 $N-M$ 个非线性刚体。\n对于三维空间中的线性刚体，其转动动能可以通过围绕两个垂直于分子轴的主轴的转动来描述。对于经典的线性刚体，围绕分子轴本身的转动惯量被视为零，因此围绕该轴的转动不携带动能。因此，$M$ 个线性分子中的每一个都贡献 2 个转动自由度。这一组的总数为：\n$$ N_{dof, \\text{rot, linear}} = 2M $$\n对于三维空间中的非线性刚体，围绕所有三个主轴的转动惯量都非零。因此，它有 3 个转动自由度。该系统包含 $N-M$ 个这样的分子。这一组的总数为：\n$$ N_{dof, \\text{rot, non-linear}} = 3(N - M) $$\n转动自由度的总数 $N_{dof, \\text{rot}}$ 是两种类型分子贡献的总和：\n$$ N_{dof, \\text{rot}} = 2M + 3(N - M) = 2M + 3N - 3M = 3N - M $$\n没有为总角动量指定约束，因此所有这些转动自由度都是独立的，并对动能有贡献。\n\n整个系统的有效二次自由度总数 $N_{dof}$ 是平动自由度和转动自由度的总和：\n$$ N_{dof} = N_{dof, \\text{trans}} + N_{dof, \\text{rot}} $$\n$$ N_{dof} = (3N - 3) + (3N - M) = 6N - M - 3 $$\n\n最后，我们应用能量均分原理来找到目标动能 $\\langle K \\rangle$。由于有 $N_{dof} = 6N - M - 3$ 个二次自由度，每个自由度贡献的平均能量为 $\\frac{1}{2} k_B T$，所以总平均动能为：\n$$ \\langle K \\rangle = N_{dof} \\times \\left(\\frac{1}{2} k_B T\\right) = (6N - M - 3) \\frac{1}{2} k_B T $$\n这就是恒温器所需的目标动能的闭合形式表达式。",
            "answer": "$$ \\boxed{\\frac{1}{2} (6N - M - 3) k_B T} $$"
        },
        {
            "introduction": "仅仅正确设置目标温度是不够的，恒温器的动态响应特性同样关键，它直接影响模拟的稳定性和物理真实性。本练习将理论与实践相结合，一方面从系综理论出发推导动能的自然涨落，另一方面通过线性化运动方程来揭示恒温器质量参数$Q$如何决定能量交换的特征频率。理解这一点对于在多尺度模拟中有效过滤噪声并避免非物理振荡至关重要。",
            "id": "3788475",
            "problem": "考虑一个具有 $f$ 个独立二次自由度的经典系统，该系统与温度为 $T$ 的 Nosé–Hoover 恒温器接触。令 $K$ 表示瞬时动能。假设在平衡态下实现了正则采样。从正则系综和麦克斯韦-玻尔兹曼分布的第一性原理出发，推导方差 $\\mathrm{Var}(K)$ 关于 $f$、玻尔兹曼常数 $k_{B}$ 和 $T$ 的闭式表达式。接下来，考虑一个系统的标准 Nosé–Hoover 运动方程，该系统具有坐标 $q_{i}$、动量 $p_{i}$、质量 $m_{i}$、力 $F_{i}$ 以及恒温器摩擦变量 $\\xi$ 和恒温器质量参数 $Q$：\n$$\n\\dot{q}_{i}=\\frac{p_{i}}{m_{i}},\\qquad\n\\dot{p}_{i}=F_{i}-\\xi\\,p_{i},\\qquad\n\\dot{\\xi}=\\frac{1}{Q}\\left(2K-f\\,k_{B}T\\right).\n$$\n将这些方程在热平衡点（$K=\\langle K\\rangle$ 且 $\\xi=0$）附近线性化，以获得控制系统与恒温器之间动能小振幅交换的特征角频率 $\\omega_{Q}$。将可逆维里项 $\\sum_{i} v_{i}F_{i}$ 视为快速涨落项，在恒温器时间尺度上其平均值为零，从而使得 $K$ 与 $\\xi$ 的主导阶耦合主导慢包络动力学。用 $f$、$k_{B}$、$T$ 和 $Q$ 表示 $\\omega_{Q}$。简要解释 $Q$ 如何通过设定交换时间尺度，在多尺度意义上过滤动能涨落。\n\n将你的最终答案表示为一个二元行矩阵 $\\big[\\mathrm{Var}(K),\\ \\omega_{Q}\\big]$。$\\mathrm{Var}(K)$ 以能量的平方为单位，$\\omega_{Q}$ 以弧度/单位时间为单位。不要在方框内的答案中包含单位。无需进行数值代入；仅提供精确的符号表达式。",
            "solution": "该问题包含两个部分。首先，我们推导正则系综中系统的动能方差 $\\mathrm{Var}(K)$。其次，我们线性化 Nosé-Hoover 运动方程以求出能量交换的特征频率 $\\omega_{Q}$。\n\n第一部分：动能方差 $\\mathrm{Var}(K)$ 的推导\n\n我们从正则系综的原理开始。对于一个具有 $f$ 个独立二次自由度的经典系统，其总动能由 $K = \\sum_{j=1}^{f} \\epsilon_j$ 给出，其中每个 $\\epsilon_j$ 是与一个自由度相关的动能（例如 $\\frac{p_x^2}{2m}$）。\n\n在温度为 $T$ 的正则系综中，单个自由度的动量概率分布由麦克斯韦-玻尔兹曼分布给出，这是一个高斯分布。该自由度对应的动能 $\\epsilon$ 的概率分布可以由其推导得出。这个分布是伽马分布 $\\Gamma(k, \\theta)$，其形状参数为 $k = 1/2$，尺度参数为 $\\theta = k_B T$。$\\epsilon$ 的概率密度函数为：\n$$\nP(\\epsilon) = \\frac{1}{\\Gamma(1/2)(k_B T)^{1/2}} \\epsilon^{1/2 - 1} \\exp\\left(-\\frac{\\epsilon}{k_B T}\\right)\n$$\n其中 $\\Gamma(1/2) = \\sqrt{\\pi}$。\n\n总动能 $K$ 是 $f$ 个这样的独立同分布随机变量之和。伽马分布的一个关键性质是，具有相同尺度参数 $\\theta$ 的独立伽马分布变量之和也是一个伽马分布变量。新的形状参数是各个形状参数之和。因此，$K$ 服从形状参数为 $k_K = \\sum_{j=1}^{f} (1/2) = f/2$、尺度参数为 $\\theta_K = k_B T$ 的伽马分布。$K$ 的概率密度函数为：\n$$\nP(K) = \\frac{1}{\\Gamma(f/2)(k_B T)^{f/2}} K^{f/2 - 1} \\exp\\left(-\\frac{K}{k_B T}\\right)\n$$\n对于伽马分布 $\\Gamma(k, \\theta)$，其均值为 $\\langle X \\rangle = k\\theta$，方差为 $\\mathrm{Var}(X) = k\\theta^2$。将此应用于 $K$ 的分布，我们得到平均动能：\n$$\n\\langle K \\rangle = k_K \\theta_K = \\left(\\frac{f}{2}\\right)(k_B T) = \\frac{f}{2}k_B T\n$$\n这个结果就是著名的能量均分定理。动能的方差为：\n$$\n\\mathrm{Var}(K) = k_K \\theta_K^2 = \\left(\\frac{f}{2}\\right)(k_B T)^2 = \\frac{f}{2}k_B^2 T^2\n$$\n这个表达式给出了动能方差与自由度数 $f$、玻尔兹曼常数 $k_B$ 和温度 $T$ 的关系。\n\n第二部分：特征频率 $\\omega_{Q}$ 的推导\n\n给定的标准 Nosé-Hoover 运动方程为：\n$$\n\\dot{q}_{i}=\\frac{p_{i}}{m_{i}}, \\qquad \\dot{p}_{i}=F_{i}-\\xi p_{i}, \\qquad \\dot{\\xi}=\\frac{1}{Q}\\left(2K-f k_{B}T\\right)\n$$\n我们需要找到动能 $K = \\sum_{i} \\frac{p_{i}^2}{2m_{i}}$ 的运动方程。对 $K$ 求时间导数：\n$$\n\\dot{K} = \\sum_{i} \\frac{p_{i}}{m_{i}} \\dot{p}_{i} = \\sum_{i} v_{i} \\dot{p}_{i}\n$$\n代入 $\\dot{p}_{i}$ 的表达式：\n$$\n\\dot{K} = \\sum_{i} v_{i} (F_{i} - \\xi p_{i}) = \\sum_{i} v_{i}F_{i} - \\xi \\sum_{i} v_{i}p_{i}\n$$\n认识到 $v_{i} = p_{i}/m_{i}$，第二项变为 $\\xi \\sum_{i} p_{i}^2/m_{i} = 2\\xi \\sum_{i} p_{i}^2/(2m_{i}) = 2\\xi K$。因此，$K$ 和 $\\xi$ 的动力学由以下耦合系统描述：\n$$\n\\dot{K} = \\sum_{i} v_{i}F_{i} - 2\\xi K\n$$\n$$\n\\dot{\\xi} = \\frac{1}{Q}(2K - f k_B T)\n$$\n我们围绕热平衡不动点对此系统进行线性化，该不动点的特征是 $\\langle \\xi \\rangle = 0$ 和 $\\langle K \\rangle = \\frac{f}{2}k_B T$。令此点附近的涨落为 $\\delta\\xi = \\xi - \\langle \\xi \\rangle = \\xi$ 和 $\\delta K = K - \\langle K \\rangle$。\n涨落的方程为：\n$$\n\\dot{(\\delta K)} = \\dot{K} = \\sum_{i} v_{i}F_{i} - 2(\\delta\\xi)(\\delta K + \\langle K \\rangle)\n$$\n$$\n\\dot{(\\delta\\xi)} = \\dot{\\xi} = \\frac{1}{Q}(2(\\delta K + \\langle K \\rangle) - f k_B T) = \\frac{1}{Q}(2\\delta K + 2\\langle K \\rangle - f k_B T)\n$$\n将 $\\langle K \\rangle = \\frac{f}{2}k_B T$ 代入第二个方程，可简化为：\n$$\n\\dot{(\\delta\\xi)} = \\frac{1}{Q}(2\\delta K + f k_B T - f k_B T) = \\frac{2}{Q}\\delta K\n$$\n这是第一个线性化方程。对于 $\\dot{(\\delta K)}$ 方程，我们通过忽略涨落中的二阶项，即 $-2(\\delta\\xi)(\\delta K)$ 项，来进行线性化。问题还指出，在分析恒温器的慢动力学时，可将可逆维里项 $\\sum_{i} v_{i}F_{i}$ 视为一个可以忽略的快速涨落项。这得到：\n$$\n\\dot{(\\delta K)} \\approx -2\\langle K \\rangle \\delta\\xi\n$$\n代入 $\\langle K \\rangle$ 的值：\n$$\n\\dot{(\\delta K)} = -2\\left(\\frac{f}{2}k_B T\\right)\\delta\\xi = -f k_B T \\delta\\xi\n$$\n我们现在得到一个由两个耦合线性常微分方程组成的系统：\n$$\n(1) \\qquad \\dot{(\\delta K)} = -f k_B T \\delta\\xi\n$$\n$$\n(2) \\qquad \\dot{(\\delta \\xi)} = \\frac{2}{Q} \\delta K\n$$\n为了求出特征频率，我们将它们组合成一个二阶方程。对‍‍‍‍‍‍‍‍方程 (2) 关于时间求导，得到：\n$$\n\\ddot{(\\delta \\xi)} = \\frac{2}{Q} \\dot{(\\delta K)}\n$$\n将方程 (1) 代入此表达式：\n$$\n\\ddot{(\\delta \\xi)} = \\frac{2}{Q}(-f k_B T \\delta\\xi) = -\\left(\\frac{2f k_B T}{Q}\\right)\\delta\\xi\n$$\n这是简谐振子方程的标准形式，$\\ddot{x} = -\\omega^2 x$。通过比较，特征角频率的平方是：\n$$\n\\omega_{Q}^2 = \\frac{2f k_B T}{Q}\n$$\n因此，特征角频率是：\n$$\n\\omega_{Q} = \\sqrt{\\frac{2f k_B T}{Q}}\n$$\n参数 $Q$，通常称为恒温器“质量”，控制着能量交换的时间尺度。较大的 $Q$ 值会导致较小的 $\\omega_{Q}$ 和较长的振荡周期，这意味着系统与恒温器之间的能量交换是缓慢的。恒温器是“重的”，不会紧密跟随系统动能的快速涨落。相反，较小的 $Q$ 值会导致较大的 $\\omega_{Q}$ 和快速的响应，从而将系统与恒温器紧密耦合。在多尺度模拟中，选择 $Q$ 值是为了将恒温器的响应时间尺度 $\\tau_Q \\sim 1/\\omega_Q$ 设定得比系统中最快的物理运动慢，但比所研究现象的时间尺度快，从而有效地在所需频率上过滤动能涨落。\n\n将两个结果组合成所要求的矩阵形式，即可得到最终答案。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{f}{2}k_{B}^{2}T^{2}  \\sqrt{\\frac{2f k_{B} T}{Q}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理论上的运动方程必须通过稳定而精确的数值算法来实现，才能在计算机上进行模拟。本练习将带你深入现代分子动力学模拟的核心，学习如何通过算符分裂技术，特别是对称Trotter分解，来构建一个高效、时间可逆且二阶精确的积分器。这种几何积分方法是实现长期、稳定模拟的关键技术。",
            "id": "3788516",
            "problem": "考虑一个由 $N$ 个粒子组成的系统，其位置为 $\\mathbf{r}_i$，动量为 $\\mathbf{p}_i$，质量为 $m_i$，具有一个光滑且不依赖于时间的势能 $U(\\mathbf{r}_1,\\dots,\\mathbf{r}_N)$。力由 $\\mathbf{F}_i(\\mathbf{r}) = -\\nabla_{\\mathbf{r}_i} U(\\mathbf{r})$ 给出。该系统与一个 Nosé-Hoover 恒温器耦合，恒温器变量为 $\\eta$ 和 $\\xi$，恒温器质量为 $Q$，目标温度为 $T$。令 $g$ 表示动能自由度的数量，$k_B$ 为玻尔兹曼常数。扩展相空间的动力学由以下方程组给出：\n$$\n\\frac{d \\mathbf{r}_i}{dt} = \\frac{\\mathbf{p}_i}{m_i}, \\quad\n\\frac{d \\mathbf{p}_i}{dt} = \\mathbf{F}_i(\\mathbf{r}) - \\xi \\mathbf{p}_i, \\quad\n\\frac{d \\eta}{dt} = \\xi, \\quad\n\\frac{d \\xi}{dt} = \\frac{1}{Q}\\left( \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i \\cdot \\mathbf{p}_i}{m_i} - g k_B T \\right).\n$$\n令 $\\mathcal{L}$ 为刘维尔算符，它作用于可观测量 $A(\\{\\mathbf{r}_i\\},\\{\\mathbf{p}_i\\},\\eta,\\xi)$ 上并生成此流动，该算符通过对上述方程应用链式法则来定义。在分子动力学 (MD) 中，二阶精度且可逆的积分器通常通过将 $\\mathcal{L}$ 对称 Trotter (Strang) 分裂为若干子算符来构造，这些子算符的流动可以被精确积分。\n\n从第一性原理和上述动力学系统出发：\n- 将 $\\mathcal{L}$ 分解为 $\\mathcal{L} = \\mathcal{L}_A + \\mathcal{L}_B + \\mathcal{L}_C$，其中子算符需具有明确的物理意义，分别与位置漂移、保守力“踢”和恒温器耦合相关联。\n- 进一步将 $\\mathcal{L}_C$ 分解为两个可精确求解的子算符 $\\mathcal{L}_{C1}$ 和 $\\mathcal{L}_{C2}$，它们分别独立描述了由 $\\xi$ 引起的动量乘性标度，以及在动量保持不变的情况下 $(\\eta,\\xi)$ 的演化。\n- 使用对称 Trotter (Strang) 组合定理，推导一个在一个时间步长 $\\Delta t$ 内的可逆、二阶精度传播子，其形式为子算符指数的有序乘积。然后，明确写出在一个时间步长 $\\Delta t$ 内对 $(\\mathbf{r}_i,\\mathbf{p}_i,\\eta,\\xi)$ 进行更新的相应序列，确保每个子流都被精确积分。\n\n在最终答案中，提供对称 Trotter 传播子的单一闭式解析表达式，该表达式用子算符的 $\\exp(\\cdot)$ 表示。无需进行数值计算；你的最终答案必须仅为解析表达式。",
            "solution": "该问题被验证为具有科学依据、良定且客观。它描述了计算统计物理中一个标准且重要的任务：为 Nosé-Hoover 恒温器动力学推导一个可逆的数值积分器。所提供的运动方程是正确的，所要求的分解以及 Trotter-Strang 分裂的应用是实现这一目标的规范方法。\n\n任意可观测量 $A(\\{\\mathbf{r}_i\\},\\{\\mathbf{p}_i\\},\\eta,\\xi)$ 的演化由刘维尔方程 $\\frac{dA}{dt} = \\mathcal{L}A$ 控制，其中 $\\mathcal{L}$ 是刘维尔算符。应用链式法则并代入给定的运动方程，我们得到：\n$$\n\\frac{dA}{dt} = \\sum_{i=1}^{N} \\left( \\nabla_{\\mathbf{r}_i} A \\cdot \\frac{d\\mathbf{r}_i}{dt} + \\nabla_{\\mathbf{p}_i} A \\cdot \\frac{d\\mathbf{p}_i}{dt} \\right) + \\frac{\\partial A}{\\partial \\eta} \\frac{d\\eta}{dt} + \\frac{\\partial A}{\\partial \\xi} \\frac{d\\xi}{dt}\n$$\n$$\n\\frac{dA}{dt} = \\sum_{i=1}^{N} \\left( \\nabla_{\\mathbf{r}_i} A \\cdot \\frac{\\mathbf{p}_i}{m_i} + \\nabla_{\\mathbf{p}_i} A \\cdot (\\mathbf{F}_i(\\mathbf{r}) - \\xi \\mathbf{p}_i) \\right) + \\frac{\\partial A}{\\partial \\eta} \\xi + \\frac{\\partial A}{\\partial \\xi} \\frac{1}{Q}\\left( \\sum_{j=1}^{N} \\frac{\\mathbf{p}_j \\cdot \\mathbf{p}_j}{m_j} - g k_B T \\right)\n$$\n由此，我们可以确定刘维尔算符 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L} = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i}{m_i} \\cdot \\nabla_{\\mathbf{r}_i} + \\sum_{i=1}^{N} \\mathbf{F}_i(\\mathbf{r}) \\cdot \\nabla_{\\mathbf{p}_i} - \\sum_{i=1}^{N} \\xi \\mathbf{p}_i \\cdot \\nabla_{\\mathbf{p}_i} + \\xi \\frac{\\partial}{\\partial \\eta} + \\frac{1}{Q}\\left( \\sum_{j=1}^{N} \\frac{\\mathbf{p}_j^2}{m_j} - g k_B T \\right) \\frac{\\partial}{\\partial \\xi}\n$$\n在一个时间步长 $\\Delta t$ 内，刘维尔方程的形式解由传播子 $\\exp(\\Delta t \\mathcal{L})$ 的作用给出。由于完整的算符 $\\mathcal{L}$ 很复杂，我们将其分解为更简单的子算符，这些子算符的流动可以被解析地计算。\n\n遵循问题的指示，我们定义分解 $\\mathcal{L} = \\mathcal{L}_A + \\mathcal{L}_B + \\mathcal{L}_C$：\n-   $\\mathcal{L}_A = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i}{m_i} \\cdot \\nabla_{\\mathbf{r}_i}$，对应于粒子位置的自由漂移。\n-   $\\mathcal{L}_B = \\sum_{i=1}^{N} \\mathbf{F}_i(\\mathbf{r}) \\cdot \\nabla_{\\mathbf{p}_i}$，对应于由保守力引起的动量更新（一个“踢”）。\n-   $\\mathcal{L}_C = - \\sum_{i=1}^{N} \\xi \\mathbf{p}_i \\cdot \\nabla_{\\mathbf{p}_i} + \\xi \\frac{\\partial}{\\partial \\eta} + \\frac{1}{Q}\\left( \\sum_{j=1}^{N} \\frac{\\mathbf{p}_j^2}{m_j} - g k_B T \\right) \\frac{\\partial}{\\partial \\xi}$，它包含了与恒温器耦合相关的所有项。\n\n接下来，我们将恒温器算符 $\\mathcal{L}_C$ 分解为两部分，$\\mathcal{L}_C = \\mathcal{L}_{C1} + \\mathcal{L}_{C2}$：\n-   $\\mathcal{L}_{C1} = - \\sum_{i=1}^{N} \\xi \\mathbf{p}_i \\cdot \\nabla_{\\mathbf{p}_i}$，对应于由恒温器变量 $\\xi$ 引起的动量乘性标度（阻尼/加热）。\n-   $\\mathcal{L}_{C2} = \\xi \\frac{\\partial}{\\partial \\eta} + G(\\mathbf{p}) \\frac{\\partial}{\\partial \\xi}$，其中 $G(\\mathbf{p}) = \\frac{1}{Q}\\left( \\sum_{j=1}^{N} \\frac{\\mathbf{p}_j^2}{m_j} - g k_B T \\right)$，对应于恒温器自身变量 $(\\eta, \\xi)$ 的演化。\n\n子算符 $\\mathcal{L}_A$、$\\mathcal{L}_B$、$\\mathcal{L}_{C1}$ 和 $\\mathcal{L}_{C2}$ 互不对易。因此，$\\exp(\\Delta t \\mathcal{L}) \\neq \\exp(\\Delta t \\mathcal{L}_A) \\exp(\\Delta t \\mathcal{L}_B) \\exp(\\Delta t \\mathcal{L}_{C1}) \\exp(\\Delta t \\mathcal{L}_{C2})$。为了构造一个二阶精度且可逆的积分器，我们采用对称 Trotter (或 Strang) 分裂定理，该定理指出对于算符 $\\mathcal{X}$ 和 $\\mathcal{Y}$，有 $\\exp(\\tau (\\mathcal{X}+\\mathcal{Y})) = \\exp(\\frac{\\tau}{2}\\mathcal{X}) \\exp(\\tau \\mathcal{Y}) \\exp(\\frac{\\tau}{2}\\mathcal{X}) + \\mathcal{O}(\\tau^3)$。\n\n我们递归地应用此定理。首先，我们分裂完整的刘维尔算符 $\\mathcal{L} = (\\mathcal{L}_A + \\mathcal{L}_B) + \\mathcal{L}_C$。一个常见的对称排列，类似于速度 Verlet 算法，是将力/恒温器更新置于两个位置半步之间。这建议采用 $\\mathcal{L} = \\mathcal{L}_A + (\\mathcal{L}_B + \\mathcal{L}_C)$ 形式的初级分裂。应用 Strang 分裂得到：\n$$\n\\exp(\\Delta t \\mathcal{L}) \\approx \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_A\\right) \\exp\\left(\\Delta t (\\mathcal{L}_B + \\mathcal{L}_C)\\right) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_A\\right)\n$$\n我们进一步分裂中心项 $\\exp(\\Delta t (\\mathcal{L}_B + \\mathcal{L}_C))$。一个对称分裂将恒温器部分与保守力部分分开：\n$$\n\\exp\\left(\\Delta t (\\mathcal{L}_B + \\mathcal{L}_C)\\right) \\approx \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_B\\right) \\exp(\\Delta t \\mathcal{L}_C) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_B\\right)\n$$\n最后，我们按照要求分裂恒温器算符 $\\mathcal{L}_C = \\mathcal{L}_{C1} + \\mathcal{L}_{C2}$：\n$$\n\\exp(\\Delta t \\mathcal{L}_C) \\approx \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_{C1}\\right) \\exp(\\Delta t \\mathcal{L}_{C2}) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_{C1}\\right)\n$$\n结合这些结果，得到二阶精度、可逆传播子的最终表达式：\n$$\n\\exp(\\Delta t \\mathcal{L}) \\approx \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_A\\right) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_B\\right) \\left[ \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_{C1}\\right) \\exp(\\Delta t \\mathcal{L}_{C2}) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_{C1}\\right) \\right] \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_B\\right) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_A\\right)\n$$\n在一个时间步长 $\\Delta t$ 内对相空间坐标进行更新的序列是通过从右到左应用这些算符来获得的。设时间 $t$ 的状态为 $(\\{\\mathbf{r}_i(t)\\}, \\{\\mathbf{p}_i(t)\\}, \\eta(t), \\xi(t))$。每个子流都按如下方式精确积分：\n\n1.  **应用 $\\exp(\\frac{\\Delta t}{2} \\mathcal{L}_A)$**：这会在 $d\\mathbf{r}_i/dt' = \\mathbf{p}_i/m_i$ 的动力学下演化系统，持续时间为 $\\Delta t/2$。\n    $\\mathbf{r}_i \\leftarrow \\mathbf{r}_i(t) + \\frac{\\mathbf{p}_i(t)}{m_i} \\frac{\\Delta t}{2}$。\n\n2.  **应用 $\\exp(\\frac{\\Delta t}{2} \\mathcal{L}_B)$**：这会在 $d\\mathbf{p}_i/dt' = \\mathbf{F}_i(\\mathbf{r})$ 的动力学下演化动量，持续时间为 $\\Delta t/2$。首先，计算在新位置上的力 $\\mathbf{F}_i$。\n    $\\mathbf{p}_i \\leftarrow \\mathbf{p}_i(t) + \\mathbf{F}_i \\frac{\\Delta t}{2}$。\n\n3.  **应用 $\\exp(\\frac{\\Delta t}{2} \\mathcal{L}_{C1})$**：这会在 $d\\mathbf{p}_i/dt' = -\\xi \\mathbf{p}_i$ 的动力学下演化动量，持续时间为 $\\Delta t/2$。精确解是一个指数标度。\n    $\\mathbf{p}_i \\leftarrow \\mathbf{p}_i \\exp\\left(-\\xi(t) \\frac{\\Delta t}{2}\\right)$。\n\n4.  **应用 $\\exp(\\Delta t \\mathcal{L}_{C2})$**：这会在一个完整的时间步长 $\\Delta t$ 内演化恒温器变量 $(\\eta, \\xi)$，期间粒子动量保持不变。方程为 $d\\eta/dt' = \\xi$ 和 $d\\xi/dt' = G(\\mathbf{p})$，其中 $G(\\mathbf{p})$ 在此子步中为常数。\n    首先，使用当前动量计算恒温器“力”：$G = \\frac{1}{Q}\\left( \\sum_{j=1}^{N} \\frac{\\mathbf{p}_j \\cdot \\mathbf{p}_j}{m_j} - g k_B T \\right)$。\n    存储当前值 $\\xi_{old} = \\xi$。\n    更新 $\\xi$：$\\xi \\leftarrow \\xi_{old} + G \\Delta t$。令此值为 $\\xi_{new}$。\n    更新 $\\eta$：$\\eta \\leftarrow \\eta(t) + \\frac{1}{2}(\\xi_{old} + \\xi_{new}) \\Delta t = \\eta(t) + \\xi_{old} \\Delta t + \\frac{1}{2} G (\\Delta t)^2$。\n\n5.  **应用 $\\exp(\\frac{\\Delta t}{2} \\mathcal{L}_{C1})$**：这是动量标度的第二个半步，现在使用更新后的 $\\xi$ 值。\n    $\\mathbf{p}_i \\leftarrow \\mathbf{p}_i \\exp\\left(-\\xi \\frac{\\Delta t}{2}\\right)$。\n\n6.  **应用 $\\exp(\\frac{\\Delta t}{2} \\mathcal{L}_B)$**：这是力“踢”的第二个半步。由于位置此后未曾改变，力 $\\mathbf{F}_i$ 与步骤2中相同。\n    $\\mathbf{p}_i \\leftarrow \\mathbf{p}_i + \\mathbf{F}_i \\frac{\\Delta t}{2}$。\n\n7.  **应用 $\\exp(\\frac{\\Delta t}{2} \\mathcal{L}_A)$**：这是位置漂移的最后半步，使用完全更新后的动量。\n    $\\mathbf{r}_i \\leftarrow \\mathbf{r}_i + \\frac{\\mathbf{p}_i}{m_i} \\frac{\\Delta t}{2}$。\n\n此序列完成了一个时间步长 $\\Delta t$ 的更新。最终状态 $(\\{\\mathbf{r}_i(t+\\Delta t)\\}, \\{\\mathbf{p}_i(t+\\Delta t)\\}, \\eta(t+\\Delta t), \\xi(t+\\Delta t))$ 是真实动力学的二阶精度近似，并且由于其对称构造，该积分器是时间可逆的。\n最终答案是此传播子的符号表示。",
            "answer": "$$\n\\boxed{\\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_A\\right) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_B\\right) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_{C1}\\right) \\exp(\\Delta t \\mathcal{L}_{C2}) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_{C1}\\right) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_B\\right) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_A\\right)}\n$$"
        }
    ]
}