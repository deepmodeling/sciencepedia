{
    "hands_on_practices": [
        {
            "introduction": "要掌握Berendsen恒温器的精髓，我们首先需要理解其核心机制。本练习将通过一个具体的计算任务，帮助你将描述温度弛豫的连续微分方程与分子动力学模拟中离散时间步内实际执行的速度标度因子$\\lambda$联系起来。通过推导并计算$\\lambda$的值，你将亲身体验该恒温器是如何通过微调粒子速度来引导系统温度向目标值$T_0$靠拢的，从而深刻理解其“弱耦合”的本质。",
            "id": "3792496",
            "problem": "在多尺度材料模拟中，一个子域通过分子动力学（MD）进行演化，同时通过 Berendsen 型恒温器与热浴弱耦合。瞬时动能温度 $T$ 由能量均分关系 $K = \\frac{f}{2} k_B T$ 定义，其中 $K$ 是总动能，$f$ 是独立自由度（DOF）的数量，$k_B$ 是玻尔兹曼常数。该弱耦合强制瞬时动能温度以时间常数 $\\tau_T$ 向目标温度 $T_0$ 进行一阶弛豫，其模型为常微分方程 $\\frac{dT}{dt} = \\frac{T_0 - T}{\\tau_T}$。在时间步长为 $\\Delta t$ 的离散MD积分器中，这种弛豫是通过在该步结束时将所有粒子速度统一按因子 $\\lambda$ 进行缩放来实现的。假设速度缩放是该步长内对动能的唯一修改。\n\n从这些原理出发，通过将 $T$ 的离散时间弛豫与均匀速度缩放对 $K$ 和 $T$ 的影响联系起来，推导单个时间步内的速度缩放因子 $\\lambda$ 的表达式。然后，对于一个系统，其参数为 $T = 300\\,\\mathrm{K}$，$T_0 = 310\\,\\mathrm{K}$，$\\Delta t = 2\\,\\mathrm{fs}$ 和 $\\tau_T = 0.2\\,\\mathrm{ps}$，计算：\n- 该步长中 $\\lambda$ 的值，以及\n- 该步长中由缩放引起的动能分数变化 $\\Delta K / K$。\n\n将两个答案都表示为精确的解析表达式，无需数值四舍五入。将 $\\lambda$ 和 $\\Delta K / K$ 均报告为无单位的纯数。以单行一对的形式提供您的最终答案，顺序为 $\\lambda$，然后是 $\\Delta K/K$。",
            "solution": "该问题要求推导 Berendsen 恒温器的速度缩放因子 $\\lambda$，并根据给定的一组参数计算其值以及动能的分数变化。推导过程通过将温度弛豫的连续模型与其通过速度缩放的离散实现联系起来进行。\n\n首先，我们从控制温度弛豫的常微分方程开始：\n$$\n\\frac{dT}{dt} = \\frac{T_0 - T}{\\tau_T}\n$$\n在这里，$T$ 是系统的瞬时动能温度，$T_0$ 是外部热浴的目标温度，$\\tau_T$ 是耦合的时间常数。\n\n对于具有有限时间步长 $\\Delta t$ 的离散分子动力学（MD）模拟，这个连续方程使用有限差分格式进行近似。我们使用一阶前向欧拉离散化，这对于 Berendsen 恒温器是标准做法。在从 $t$ 到 $t+\\Delta t$ 的单个时间步内，温度变化 $\\Delta T = T(t+\\Delta t) - T(t)$ 近似为：\n$$\n\\frac{T(t+\\Delta t) - T(t)}{\\Delta t} \\approx \\frac{dT}{dt}\\bigg|_t\n$$\n代入控制微分方程，我们得到：\n$$\n\\frac{T(t+\\Delta t) - T(t)}{\\Delta t} = \\frac{T_0 - T(t)}{\\tau_T}\n$$\n令 $T$ 表示步长开始时的温度 $T(t)$，$T'$ 表示步长结束时的目标温度 $T(t+\\Delta t)$。一步之后的温度方程为：\n$$\nT' - T = \\frac{\\Delta t}{\\tau_T} (T_0 - T)\n$$\n$$\nT' = T + \\frac{\\Delta t}{\\tau_T} (T_0 - T)\n$$\n这是系统在恒温步骤后应具有的温度。\n\n接下来，我们分析速度缩放对动能和温度的影响。一个由 $N$ 个粒子组成的系统，其质量为 $m_i$，速度为 $\\mathbf{v}_i$，其总动能 $K$ 由下式给出：\n$$\nK = \\sum_{i=1}^{N} \\frac{1}{2} m_i |\\mathbf{v}_i|^2\n$$\n恒温器将所有速度统一按因子 $\\lambda$ 进行缩放，使得新的速度为 $\\mathbf{v}_i' = \\lambda \\mathbf{v}_i$。新的动能 $K'$ 为：\n$$\nK' = \\sum_{i=1}^{N} \\frac{1}{2} m_i |\\lambda\\mathbf{v}_i|^2 = \\lambda^2 \\sum_{i=1}^{N} \\frac{1}{2} m_i |\\mathbf{v}_i|^2 = \\lambda^2 K\n$$\n所以，我们有关系式 $K' = \\lambda^2 K$。\n\n问题给出了动能和温度之间的能量均分关系：\n$$\nK = \\frac{f}{2} k_B T\n$$\n其中 $f$ 是自由度的数量，$k_B$ 是玻尔兹曼常数。这个关系对初始状态（具有 $K$ 和 $T$）和缩放后状态（具有 $K'$ 和 $T'$）都成立：\n$$\nK' = \\frac{f}{2} k_B T'\n$$\n将这些代入关系式 $K' = \\lambda^2 K$，我们得到：\n$$\n\\frac{f}{2} k_B T' = \\lambda^2 \\left(\\frac{f}{2} k_B T\\right)\n$$\n常数 $\\frac{f}{2} k_B$ 消去，得到缩放前后温度之间的直接关系：\n$$\nT' = \\lambda^2 T\n$$\n现在我们有两个关于步长后温度 $T'$ 的表达式。通过令它们相等，我们可以解出缩放因子 $\\lambda$：\n$$\n\\lambda^2 T = T + \\frac{\\Delta t}{\\tau_T} (T_0 - T)\n$$\n两边除以 $T$（假设 $T > 0$）：\n$$\n\\lambda^2 = 1 + \\frac{\\Delta t}{\\tau_T} \\left(\\frac{T_0 - T}{T}\\right) = 1 + \\frac{\\Delta t}{\\tau_T} \\left(\\frac{T_0}{T} - 1\\right)\n$$\n由于 $\\lambda$ 代表一个缩放因子，我们取正平方根：\n$$\n\\lambda = \\sqrt{1 + \\frac{\\Delta t}{\\tau_T} \\left(\\frac{T_0}{T} - 1\\right)}\n$$\n这就是推导出的速度缩放因子的表达式。\n\n现在，我们使用给定的参数计算 $\\lambda$ 的值：\n$T = 300\\,\\mathrm{K}$\n$T_0 = 310\\,\\mathrm{K}$\n$\\Delta t = 2\\,\\mathrm{fs} = 2 \\times 10^{-15}\\,\\mathrm{s}$\n$\\tau_T = 0.2\\,\\mathrm{ps} = 0.2 \\times 10^{-12}\\,\\mathrm{s} = 200 \\times 10^{-15}\\,\\mathrm{s}$\n\n首先，我们计算无量纲比率 $\\frac{\\Delta t}{\\tau_T}$：\n$$\n\\frac{\\Delta t}{\\tau_T} = \\frac{2 \\times 10^{-15}\\,\\mathrm{s}}{200 \\times 10^{-15}\\,\\mathrm{s}} = \\frac{2}{200} = \\frac{1}{100}\n$$\n接下来，我们计算涉及温度的项：\n$$\n\\frac{T_0}{T} - 1 = \\frac{310\\,\\mathrm{K}}{300\\,\\mathrm{K}} - 1 = \\frac{31}{30} - 1 = \\frac{31 - 30}{30} = \\frac{1}{30}\n$$\n将这些值代入 $\\lambda^2$ 的表达式中：\n$$\n\\lambda^2 = 1 + \\left(\\frac{1}{100}\\right) \\left(\\frac{1}{30}\\right) = 1 + \\frac{1}{3000} = \\frac{3000}{3000} + \\frac{1}{3000} = \\frac{3001}{3000}\n$$\n因此，$\\lambda$ 的值为：\n$$\n\\lambda = \\sqrt{\\frac{3001}{3000}}\n$$\n\n最后，我们计算动能的分数变化 $\\frac{\\Delta K}{K}$。其定义为：\n$$\n\\frac{\\Delta K}{K} = \\frac{K' - K}{K}\n$$\n使用我们之前推导的关系式 $K' = \\lambda^2 K$：\n$$\n\\frac{\\Delta K}{K} = \\frac{\\lambda^2 K - K}{K} = \\frac{(\\lambda^2 - 1)K}{K} = \\lambda^2 - 1\n$$\n代入我们计算出的 $\\lambda^2$ 的值：\n$$\n\\frac{\\Delta K}{K} = \\frac{3001}{3000} - 1 = \\frac{3001 - 3000}{3000} = \\frac{1}{3000}\n$$\n问题要求给出 $\\lambda$ 和 $\\frac{\\Delta K}{K}$ 的精确解析表达式。\n\n1. 缩放因子 $\\lambda$ 是 $\\sqrt{\\frac{3001}{3000}}$。\n2. 动能的分数变化 $\\frac{\\Delta K}{K}$ 是 $\\frac{1}{3000}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{\\frac{3001}{3000}}  \\frac{1}{3000}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了温度控制的原理后，一个自然的延伸是学习如何控制系统的压力。Berendsen恒压器采用了与恒温器类似的“弱耦合”思想，通过微调模拟盒子的大小来响应内外压差。这个练习将引导你推导体积应变率$\\xi$以及单步模拟中盒子边长的具体变化量$\\Delta L$，从而将宏观的热力学概念（如等温压缩系数$\\beta$）与模拟中的微观操作直接关联起来。",
            "id": "3792505",
            "problem": "在分子动力学（MD）中使用Berendsen恒压器进行各向同性压力控制时，一个边长为 $L$ 的立方模拟盒子受到目标外部压力 $P_{0}$ 的作用，而其瞬时内部压力为 $P$。设材料的等温压缩率为 $\\beta$，由热力学恒等式 $\\beta \\equiv -\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial P}\\right)_{T}$ 定义，其中 $V$ 是盒子体积。假设在恒压器作用下，体积的弛豫是线性响应的，其特征是压力弛豫时间 $\\tau_{P}$，并且恒压器是各向同性作用的，因此 $V \\propto L^{3}$。在离散时间步长 $\\Delta t$ 的主导阶上进行计算（即，忽略 $(\\Delta t)^{2}$ 及更高阶的项）。\n\n从这些定义和假设出发，推导瞬时体积应变率参数 $\\xi \\equiv \\frac{1}{V}\\frac{dV}{dt}$ 关于 $\\beta$、$\\tau_{P}$、$P$ 和 $P_{0}$ 的时间一阶表达式，然后为一个初始边长为 $L$ 的立方盒子，推导其在一个时间步长 $\\Delta t$ 内盒子长度的一阶变化量 $\\Delta L$。\n\n给定以下数值：$P = 0.8\\,\\mathrm{bar}$，$P_{0} = 1.0\\,\\mathrm{bar}$，$\\beta = 4.5 \\times 10^{-10}\\,\\mathrm{Pa}^{-1}$，$\\Delta t = 2\\,\\mathrm{fs}$，$\\tau_{P} = 2\\,\\mathrm{ps}$，以及 $L = 5\\,\\mathrm{nm}$，计算 $\\xi$ 和单步盒子长度变化量 $\\Delta L$ 的数值。使用 $1\\,\\mathrm{bar} = 1.0 \\times 10^{5}\\,\\mathrm{Pa}$。以 $\\mathrm{s}^{-1}$ 为单位报告 $\\xi$，以 $\\mathrm{nm}$ 为单位报告 $\\Delta L$。将你的答案四舍五入到 2 位有效数字。",
            "solution": "问题陈述经评估具有科学依据、是良定的、客观且内部一致的。这是一个计算物理学中的标准问题，特别是在分子动力学模拟的背景下，并为得到唯一解提供了所有必要信息。因此，我们进行推导和计算。\n\nBerendsen恒压器算法基于一阶动力学弛豫原理。它假设系统内部压力 $P$ 的变化率与目标外部压力 $P_0$ 的偏差成正比。这种关系由一个时间常数 $\\tau_P$（称为压力弛豫时间）控制。其控制微分方程为：\n$$\n\\frac{dP}{dt} = \\frac{P_0 - P}{\\tau_P}\n$$\n\n为了将压力变化与体积变化联系起来，我们使用等温压缩率 $\\beta$ 的定义：\n$$\n\\beta \\equiv -\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial P}\\right)_{T}\n$$\n其中 $V$ 是模拟盒子的体积，下标 $T$ 表示恒温。假设恒压器在准等温条件下运行，我们可以重排这个定义并用变化率来表示它。对于微小变化，偏导数可以近似为全导数：\n$$\n\\frac{dV}{dP} \\approx -V\\beta\n$$\n使用链式法则，体积的变化率可以写成：\n$$\n\\frac{dV}{dt} = \\frac{dV}{dP} \\frac{dP}{dt}\n$$\n代入 $\\frac{dV}{dP}$ 和 $\\frac{dP}{dt}$ 的表达式可得：\n$$\n\\frac{dV}{dt} \\approx (-V\\beta) \\left(\\frac{P_0 - P}{\\tau_P}\\right) = -V\\beta \\frac{P_0 - P}{\\tau_P}\n$$\n问题将瞬时体积应变率参数 $\\xi$ 定义为：\n$$\n\\xi \\equiv \\frac{1}{V}\\frac{dV}{dt}\n$$\n代入推导出的 $\\frac{dV}{dt}$ 表达式：\n$$\n\\xi = \\frac{1}{V} \\left(-V\\beta \\frac{P_0 - P}{\\tau_P}\\right) = -\\frac{\\beta}{\\tau_P}(P_0 - P)\n$$\n这可以改写为：\n$$\n\\xi = \\frac{\\beta}{\\tau_P}(P - P_0)\n$$\n这是第一个所需的表达式，给出了以瞬时压力、目标压力、压缩率和弛豫时间表示的体积应变率。\n\n接下来，我们推导在一个离散时间步长 $\\Delta t$ 内盒子长度的变化量 $\\Delta L$。对于一个很小的时间步长，我们可以将体积变化量 $\\Delta V$ 近似到一阶：\n$$\n\\Delta V \\approx \\frac{dV}{dt} \\Delta t = (\\xi V) \\Delta t\n$$\n对于一个边长为 $L$ 的立方模拟盒子，其体积为 $V = L^3$。体积的微分变化是 $dV = 3L^2 dL$。对于一个微小的有限变化，我们近似 $\\Delta V \\approx 3L^2 \\Delta L$。令两个关于 $\\Delta V$ 的表达式相等：\n$$\n3L^2 \\Delta L \\approx \\xi V \\Delta t = \\xi L^3 \\Delta t\n$$\n解出 $\\Delta L$ 可得一个时间步长内盒子长度的一阶变化：\n$$\n\\Delta L \\approx \\frac{\\xi L^3 \\Delta t}{3L^2} = \\frac{1}{3}\\xi L \\Delta t\n$$\n这是第二个所需的表达式。\n\n最后，我们使用所提供的数据计算 $\\xi$ 和 $\\Delta L$ 的数值。\n给定的数值是：\n$P = 0.8\\,\\mathrm{bar}$\n$P_0 = 1.0\\,\\mathrm{bar}$\n$\\beta = 4.5 \\times 10^{-10}\\,\\mathrm{Pa}^{-1}$\n$\\Delta t = 2\\,\\mathrm{fs} = 2 \\times 10^{-15}\\,\\mathrm{s}$\n$\\tau_P = 2\\,\\mathrm{ps} = 2 \\times 10^{-12}\\,\\mathrm{s}$\n$L = 5\\,\\mathrm{nm}$\n压力换算为 $1\\,\\mathrm{bar} = 1.0 \\times 10^{5}\\,\\mathrm{Pa}$。\n\n首先，我们用国际单位制单位计算压力差：\n$$\nP - P_0 = (0.8 - 1.0)\\,\\mathrm{bar} = -0.2\\,\\mathrm{bar} = -0.2 \\times 1.0 \\times 10^{5}\\,\\mathrm{Pa} = -2.0 \\times 10^{4}\\,\\mathrm{Pa}\n$$\n现在，我们可以计算 $\\xi$：\n$$\n\\xi = \\frac{\\beta}{\\tau_P}(P - P_0) = \\frac{4.5 \\times 10^{-10}\\,\\mathrm{Pa}^{-1}}{2 \\times 10^{-12}\\,\\mathrm{s}} (-2.0 \\times 10^{4}\\,\\mathrm{Pa})\n$$\n$$\n\\xi = (2.25 \\times 10^{2}\\,\\mathrm{s}^{-1}\\mathrm{Pa}^{-1})(-2.0 \\times 10^{4}\\,\\mathrm{Pa}) = -4.5 \\times 10^{6}\\,\\mathrm{s}^{-1}\n$$\n该值已满足所要求的两位有效数字。\n\n接下来，我们计算单步盒子长度的变化量 $\\Delta L$：\n$$\n\\Delta L = \\frac{1}{3}\\xi L \\Delta t = \\frac{1}{3}(-4.5 \\times 10^{6}\\,\\mathrm{s}^{-1})(5\\,\\mathrm{nm})(2 \\times 10^{-15}\\,\\mathrm{s})\n$$\n$$\n\\Delta L = \\frac{1}{3}(-4.5 \\times 10^{6} \\times 5 \\times 2 \\times 10^{-15})\\,\\mathrm{nm}\n$$\n$$\n\\Delta L = \\frac{1}{3}(-4.5 \\times 10^{-8})\\,\\mathrm{nm} = -1.5 \\times 10^{-8}\\,\\mathrm{nm}\n$$\n这个值也是两位有效数字。$\\xi$ 和 $\\Delta L$ 的负号正确地表明系统正在压缩，因为其内部压力 $P$ 小于目标压力 $P_0$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-4.5 \\times 10^{6}  -1.5 \\times 10^{-8}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}