{
    "hands_on_practices": [
        {
            "introduction": "Before we can appreciate how a thermostat works, we must first understand its objective. The Stochastic Velocity Rescaling (SVR) thermostat is designed to ensure a system's kinetic energy correctly samples the canonical distribution. This foundational exercise guides you through the derivation of this target distribution from the first principles of statistical mechanics, using the partition function and the density of states in momentum space. By completing this practice , you will build a rigorous understanding of the statistical goal of any canonical ensemble thermostat.",
            "id": "3449894",
            "problem": "A classical molecular system of $N$ particles is simulated in the canonical ensemble at temperature $T$ using a thermostat acting only on the momenta. Let the effective number of independent quadratic momentum degrees of freedom (after constraints and removal of conserved motions) be $f$. The Hamiltonian separates as $H(\\mathbf{p},\\mathbf{q})=K(\\mathbf{p})+U(\\mathbf{q})$, where the kinetic energy is $K(\\mathbf{p})=\\sum_{i=1}^{f}\\frac{p_{i}^{2}}{2 m_{i}}$ with appropriate masses $m_{i}$. The canonical phase-space probability density is proportional to $\\exp(-\\beta H)$ with $\\beta=1/(k_{B} T)$, where $k_{B}$ is the Boltzmann constant.\n\nUsing only fundamental definitions of the canonical ensemble and the equipartition theorem, do the following:\n\n1. Show that the momentum partition function factorizes and can be written as $Z_{p}(\\beta)=C\\,\\beta^{-f/2}$, where $C$ is a $\\beta$-independent constant. Then use canonical-ensemble identities to derive the mean and variance of the kinetic energy, $\\mathbb{E}[K]$ and $\\mathrm{Var}[K]$, in terms of $f$, $k_{B}$, and $T$.\n\n2. Consider the set of momentum states with kinetic energy in the interval $[K,K+\\mathrm{d}K]$. By transforming to hyperspherical coordinates in the scaled momentum space, argue that the momentum-space measure at fixed $K$ scales as $K^{f/2-1}\\,\\mathrm{d}K$. Combine this density-of-states factor with the Boltzmann weight to obtain the unnormalized probability density for $K$.\n\n3. Normalize the resulting density to obtain the stationary equilibrium probability density $p(K)$ that a correct thermostat based on stochastic velocity rescaling (SVR) must reproduce for the kinetic energy at temperature $T$. Express $p(K)$ as a closed-form analytic expression in terms of $f$, $k_{B}$, and $T$. Provide this normalized $p(K)$ as your final answer.\n\nYour final answer must be a single closed-form analytic expression for $p(K)$; do not include units in the final boxed expression.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of classical statistical mechanics, well-posed with a clear path to a unique solution, and stated objectively. We proceed with the solution by addressing the three parts in sequence.\n\nPart 1: Momentum Partition Function, Mean and Variance of Kinetic Energy\n\nThe total canonical partition function for a system with a separable Hamiltonian, $H(\\mathbf{p},\\mathbf{q})=K(\\mathbf{p})+U(\\mathbf{q})$, is the product of the momentum and position partition functions, $Z(\\beta) = Z_{p}(\\beta)Z_{q}(\\beta)$. The momentum partition function, $Z_{p}(\\beta)$, is given by the integral of the Boltzmann factor associated with the kinetic energy over all possible momenta.\nThe kinetic energy is $K(\\mathbf{p})=\\sum_{i=1}^{f}\\frac{p_{i}^{2}}{2 m_{i}}$, where $f$ is the number of independent quadratic momentum degrees of freedom.\n\nThe momentum partition function is:\n$$Z_{p}(\\beta) = \\int_{-\\infty}^{\\infty} \\dots \\int_{-\\infty}^{\\infty} \\exp(-\\beta K(\\mathbf{p})) \\, dp_1 \\dots dp_f$$\nSubstituting the expression for $K(\\mathbf{p})$:\n$$Z_{p}(\\beta) = \\int \\exp\\left(-\\beta \\sum_{i=1}^{f}\\frac{p_{i}^{2}}{2 m_{i}}\\right) \\, d^f\\mathbf{p} = \\prod_{i=1}^{f} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta p_{i}^{2}}{2 m_{i}}\\right) \\, dp_i$$\nThis is a product of $f$ Gaussian integrals. The value of a single such integral is given by the standard formula $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$. Here, $a = \\frac{\\beta}{2m_i}$.\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta p_{i}^{2}}{2 m_{i}}\\right) \\, dp_i = \\sqrt{\\frac{\\pi}{ \\frac{\\beta}{2 m_{i}} }} = \\sqrt{\\frac{2\\pi m_i}{\\beta}} = (2\\pi m_i)^{1/2} \\beta^{-1/2}$$\nMultiplying these $f$ terms together gives the momentum partition function:\n$$Z_{p}(\\beta) = \\prod_{i=1}^{f} (2\\pi m_i)^{1/2} \\beta^{-1/2} = \\left(\\prod_{i=1}^{f} \\sqrt{2\\pi m_i}\\right) \\beta^{-f/2}$$\nThis is of the form $Z_{p}(\\beta)=C\\,\\beta^{-f/2}$, where the constant $C = \\prod_{i=1}^{f} \\sqrt{2\\pi m_i}$ is independent of $\\beta = 1/(k_B T)$. This completes the first part of Task 1.\n\nNext, we derive the mean and variance of the kinetic energy using canonical-ensemble identities. The mean kinetic energy $\\mathbb{E}[K]$ is given by:\n$$\\mathbb{E}[K] = -\\frac{\\partial}{\\partial \\beta} \\ln Z_p(\\beta)$$\nFirst, we find $\\ln Z_p(\\beta)$:\n$$\\ln Z_p(\\beta) = \\ln(C \\beta^{-f/2}) = \\ln C - \\frac{f}{2} \\ln \\beta$$\nDifferentiating with respect to $\\beta$:\n$$\\frac{\\partial}{\\partial \\beta} \\ln Z_p(\\beta) = -\\frac{f}{2} \\frac{1}{\\beta}$$\nTherefore, the mean kinetic energy is:\n$$\\mathbb{E}[K] = - \\left(-\\frac{f}{2\\beta}\\right) = \\frac{f}{2\\beta} = \\frac{f}{2} k_B T$$\nThis result is a direct consequence of the equipartition theorem for quadratic degrees of freedom.\n\nThe variance of the kinetic energy, $\\mathrm{Var}[K] = \\mathbb{E}[K^2] - (\\mathbb{E}[K])^2$, is given by the second derivative of $\\ln Z_p(\\beta)$:\n$$\\mathrm{Var}[K] = \\frac{\\partial^2}{\\partial \\beta^2} \\ln Z_p(\\beta)$$\nDifferentiating our previous result for the first derivative:\n$$\\mathrm{Var}[K] = \\frac{\\partial}{\\partial \\beta} \\left(-\\frac{f}{2\\beta}\\right) = - \\left(-\\frac{f}{2\\beta^2}\\right) = \\frac{f}{2\\beta^2} = \\frac{f}{2} (k_B T)^2$$\n\nPart 2: Momentum-space Measure\n\nTo find the momentum-space measure for states with kinetic energy in the interval $[K, K + \\mathrm{d}K]$, we analyze the geometry of the constant-energy surface in momentum space. The equation $K = \\sum_{i=1}^{f} \\frac{p_i^2}{2m_i}$ describes a hyper-ellipsoid. To simplify this geometry, we introduce scaled momentum coordinates $u_i = p_i / \\sqrt{2m_i}$. In terms of these new coordinates, the kinetic energy becomes:\n$$K = \\sum_{i=1}^{f} u_i^2$$\nThis is the equation of a hypersphere of radius $R = \\sqrt{K}$ in the $f$-dimensional space of the variables $\\{u_i\\}$. The volume element in the original momentum space is $d^f\\mathbf{p} = \\prod_{i=1}^{f} dp_i$. The transformation is $p_i = u_i \\sqrt{2m_i}$, so $dp_i = \\sqrt{2m_i} du_i$. The volume element transforms as:\n$$d^f\\mathbf{p} = \\left(\\prod_{i=1}^{f} \\sqrt{2m_i}\\right) d^f\\mathbf{u} = \\left(\\frac{C}{(2\\pi)^{f/2}}\\right)d^f\\mathbf{u} \\propto d^f\\mathbf{u}$$\nThe number of states in the kinetic energy interval $[K, K + \\mathrm{d}K]$ is proportional to the volume of the corresponding shell in the $u$-space. This shell is bounded by two hyperspheres of radii $R = \\sqrt{K}$ and $R' = \\sqrt{K+\\mathrm{d}K}$.\nThe thickness of this shell is $dR = R' - R \\approx \\frac{d R}{dK} dK = \\frac{d(\\sqrt{K})}{dK} dK = \\frac{1}{2\\sqrt{K}} dK$.\nThe volume of a hyperspherical shell of radius $R$ and thickness $dR$ in $f$ dimensions is given by the surface area of the hypersphere multiplied by its thickness: $dV = S_{f-1}(R) \\, dR$, where $S_{f-1}(R)$ is the surface area of an $(f-1)$-sphere of radius $R$. The surface area scales as $R^{f-1}$. Thus, the volume of the shell is proportional to $R^{f-1} dR$.\nSubstituting $R=\\sqrt{K}$ and $dR \\propto K^{-1/2} dK$:\n$$dV \\propto (\\sqrt{K})^{f-1} \\cdot (K^{-1/2} dK) = K^{(f-1)/2} K^{-1/2} dK = K^{f/2 - 1} dK$$\nSince the momentum-space measure is proportional to this volume element, the measure at fixed $K$ scales as $K^{f/2-1} \\,\\mathrm{d}K$. The term $\\Omega(K) \\propto K^{f/2-1}$ is the density of states for the kinetic energy.\n\nPart 3: Normalized Probability Density of Kinetic Energy\n\nThe probability of finding the system with a kinetic energy $K$ is proportional to the product of the density of states $\\Omega(K)$ and the Boltzmann factor $\\exp(-\\beta K)$. The unnormalized probability density for $K$, denoted $p_{un}(K)$, is therefore:\n$$p_{un}(K) \\propto \\Omega(K) \\exp(-\\beta K) \\propto K^{f/2-1} \\exp(-\\beta K)$$\nTo obtain the normalized probability density $p(K)$, we introduce a normalization constant $\\mathcal{N}$ and set the integral of $p(K)$ over all possible values of $K$ (from $0$ to $\\infty$) to unity:\n$$p(K) = \\mathcal{N} K^{f/2-1} \\exp(-\\beta K)$$\n$$\\int_0^\\infty p(K) \\, dK = \\mathcal{N} \\int_0^\\infty K^{f/2-1} \\exp(-\\beta K) \\, dK = 1$$\nThe integral is related to the Gamma function, $\\Gamma(z) = \\int_0^\\infty t^{z-1} e^{-t} dt$. We perform a change of variables $t = \\beta K$, which means $K = t/\\beta$ and $dK = dt/\\beta$.\n\\begin{align*}\n\\int_0^\\infty K^{f/2-1} \\exp(-\\beta K) \\, dK &= \\int_0^\\infty \\left(\\frac{t}{\\beta}\\right)^{f/2-1} \\exp(-t) \\, \\frac{dt}{\\beta} \\\\\n&= \\frac{1}{\\beta^{f/2-1}} \\frac{1}{\\beta} \\int_0^\\infty t^{f/2-1} \\exp(-t) \\, dt \\\\\n&= \\frac{1}{\\beta^{f/2}} \\Gamma\\left(\\frac{f}{2}\\right)\n\\end{align*}\nThe normalization condition becomes:\n$$\\mathcal{N} \\left[ \\frac{1}{\\beta^{f/2}} \\Gamma\\left(\\frac{f}{2}\\right) \\right] = 1 \\implies \\mathcal{N} = \\frac{\\beta^{f/2}}{\\Gamma(f/2)}$$\nSubstituting this normalization constant back into the expression for $p(K)$ and replacing $\\beta$ with $1/(k_B T)$, we get the final normalized probability density for the kinetic energy:\n$$p(K) = \\frac{\\beta^{f/2}}{\\Gamma(f/2)} K^{f/2-1} \\exp(-\\beta K) = \\frac{(1/(k_B T))^{f/2}}{\\Gamma(f/2)} K^{f/2-1} \\exp\\left(-\\frac{K}{k_B T}\\right)$$\nThis is a Gamma distribution with shape parameter $\\alpha = f/2$ and rate parameter $\\beta = 1/(k_B T)$. This is the stationary equilibrium distribution that any correct thermostat, including one based on stochastic velocity rescaling, must reproduce.\n$$p(K) = \\frac{1}{\\Gamma(f/2) (k_B T)^{f/2}} K^{\\frac{f}{2}-1} \\exp\\left(-\\frac{K}{k_B T}\\right)$$",
            "answer": "$$\\boxed{\\frac{1}{\\Gamma(\\frac{f}{2}) (k_{B} T)^{f/2}} K^{\\frac{f}{2}-1} \\exp\\left(-\\frac{K}{k_{B} T}\\right)}$$"
        },
        {
            "introduction": "The theoretical energy distributions derived from statistical mechanics depend on a critical parameter: the number of effective degrees of freedom, $N_f$. In realistic molecular simulations, this number is often reduced from the simple $3N$ value by various holonomic constraints, such as fixed bond lengths. This problem  provides a concrete scenario to practice calculating $N_f$ for a constrained biomolecular system and then using it with the equipartition theorem to find the expected mean kinetic energy. This is a vital skill for correctly setting up and interpreting thermostatted simulations.",
            "id": "3841766",
            "problem": "Consider a classical, constrained biomolecular system in a multiscale materials simulation. The system has $N=1000$ atoms and $900$ independent holonomic constraints that remove one Cartesian degree of freedom each. The system is thermostatted using the stochastic velocity rescaling (SVR) thermostat, which maintains the canonical ensemble at temperature $T=310\\ \\mathrm{K}$. Assume constraints are ideal and independent, and that no additional global constraints (such as fixing the center-of-mass motion or rigid-body rotations beyond the stated constraints) are applied. \n\nStarting from first principles for classical statistical mechanics, determine the effective number of quadratic momentum degrees of freedom $N_f$ and derive the expected canonical mean kinetic energy $\\langle K \\rangle$ under SVR. Use the canonical ensemble and the Maxwell–Boltzmann distribution as the fundamental base, and justify the relationship between constraints, the dimension of momentum space, and the mean of the kinetic energy. \n\nCompute $N_f$ and the molar expected mean kinetic energy at temperature $T=310\\ \\mathrm{K}$, expressing the energy in $\\mathrm{kJ/mol}$. Round the energy to four significant figures. Your final answer must be a single row matrix containing $N_f$ and the rounded molar mean kinetic energy.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- System type: classical, constrained biomolecular system in a multiscale materials simulation.\n- Number of atoms: $N=1000$.\n- Number of independent holonomic constraints: $N_c = 900$.\n- Effect of each constraint: removes one Cartesian degree of freedom.\n- Thermostat: Stochastic Velocity Rescaling (SVR).\n- Ensemble: Canonical ensemble.\n- Temperature: $T=310\\ \\mathrm{K}$.\n- Assumptions: constraints are ideal and independent; no additional global constraints are applied.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in classical statistical mechanics and molecular dynamics simulation theory. The concepts of degrees of freedom, holonomic constraints, the canonical ensemble, and the equipartition theorem are standard. The Stochastic Velocity Rescaling (SVR) thermostat is a known method for maintaining the canonical ensemble, specifically for the kinetic degrees of freedom. The problem is well-posed, providing all necessary information ($N$, $N_c$, $T$) to determine the requested quantities ($N_f$, $\\langle K \\rangle$). The numerical values are realistic for a typical biomolecular simulation. The problem statement is objective, precise, and contains no internal contradictions or ambiguities. The explicit instruction to ignore additional global constraints (like center-of-mass motion removal) clarifies the calculation of degrees of freedom.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe solution is derived from the first principles of classical statistical mechanics. We first determine the number of effective degrees of freedom and then apply the equipartition theorem to find the mean kinetic energy.\n\n**1. Determination of the Effective Number of Degrees of Freedom ($N_f$)**\n\nA system of $N$ classical particles moving in a three-dimensional Cartesian space has $3N$ positional coordinates $(q_1, q_2, \\ldots, q_{3N})$ and $3N$ corresponding momentum components $(p_1, p_2, \\ldots, p_{3N})$. The total number of degrees of freedom in the unconstrained system is $3N$. In this problem, the number of atoms is $N=1000$, so the initial number of degrees of freedom is $3 \\times 1000 = 3000$.\n\nThe system is subject to $N_c = 900$ independent holonomic constraints. A holonomic constraint is a relation that depends only on the particle coordinates and possibly time, of the form $f_k(\\mathbf{r}_1, \\mathbf{r}_2, \\ldots, \\mathbf{r}_N) = 0$ for $k=1, \\ldots, N_c$. Each independent constraint of this type removes one degree of freedom from the system's configuration space. The number of independent coordinates required to describe the system's configuration is thus reduced.\n\nThe effective number of degrees of freedom, $N_f$, for the system is the total number of degrees of freedom minus the number of independent constraints.\n$$N_f = 3N - N_c$$\nThe problem explicitly states that no other constraints (such as fixing the center-of-mass momentum) are to be considered. Substituting the given values:\n$$N_f = 3 \\times 1000 - 900 = 3000 - 900 = 2100$$\nThese $N_f$ degrees of freedom correspond to the number of independent variables needed to specify the state of the system, and crucially for this problem, correspond to the number of effective quadratic terms in the kinetic energy.\n\n**2. Derivation of the Expected Mean Kinetic Energy ($\\langle K \\rangle$)**\n\nThe system is maintained in a canonical ensemble at a constant temperature $T$ by an SVR thermostat. A key feature of the SVR thermostat is that it ensures the kinetic energy of the system correctly samples the canonical distribution for a system with $N_f$ degrees of freedom.\n\nThe total kinetic energy of the system in Cartesian coordinates is given by the sum of the kinetic energies of all atoms:\n$$K = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i \\cdot \\mathbf{p}_i}{2m_i} = \\sum_{j=1}^{3N} \\frac{p_j^2}{2m_j'}$$\nwhere $\\mathbf{p}_i$ is the momentum of the $i$-th atom with mass $m_i$, and the second sum is over all $3N$ Cartesian momentum components $p_j$ with corresponding masses $m_j'$.\n\nThe equipartition theorem of classical statistical mechanics states that for a system in thermal equilibrium at temperature $T$, the average energy associated with each degree of freedom that appears as a quadratic term in the Hamiltonian is $\\frac{1}{2} k_B T$, where $k_B$ is the Boltzmann constant.\n\nWhile holonomic constraints introduce correlations between the momentum components $p_j$, the kinetic energy can always be expressed as a sum of $N_f$ independent quadratic terms in a set of generalized velocities. Let these generalized velocities be $\\dot{q}'_k$ for $k=1, \\ldots, N_f$. The kinetic energy takes the form $K = \\frac{1}{2} \\sum_{k=1}^{N_f} \\mu_k (\\dot{q}'_k)^2$ in an appropriate basis, where each term corresponds to an independent mode of motion. As each of these $N_f$ terms is quadratic, the equipartition theorem can be applied. The mean kinetic energy of the system, $\\langle K \\rangle$, is the sum of the average energies of these $N_f$ modes:\n$$\\langle K \\rangle = N_f \\times \\frac{1}{2} k_B T = \\frac{N_f}{2} k_B T$$\n\n**3. Calculation of the Molar Expected Mean Kinetic Energy**\n\nThe problem asks for the *molar* expected mean kinetic energy. This quantity represents the total kinetic energy of the system, but expressed in molar units (e.g., $\\mathrm{kJ/mol}$). This is obtained by multiplying the system's average kinetic energy $\\langle K \\rangle$ by the Avogadro constant $N_A$.\n$$\\langle K \\rangle_{\\text{molar}} = \\langle K \\rangle \\times N_A = \\frac{N_f}{2} k_B N_A T$$\nUsing the definition of the molar gas constant, $R = k_B N_A$, the expression simplifies to:\n$$\\langle K \\rangle_{\\text{molar}} = \\frac{N_f}{2} R T$$\nWe have the following values:\n- Number of effective degrees of freedom: $N_f = 2100$.\n- Molar gas constant: $R \\approx 8.314462618\\ \\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}}$.\n- Temperature: $T = 310\\ \\mathrm{K}$.\n\nSubstituting these values into the equation:\n$$\\langle K \\rangle_{\\text{molar}} = \\frac{2100}{2} \\times (8.314462618\\ \\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}}) \\times (310\\ \\mathrm{K})$$\n$$\\langle K \\rangle_{\\text{molar}} = 1050 \\times 8.314462618 \\times 310 \\ \\mathrm{J/mol}$$\n$$\\langle K \\rangle_{\\text{molar}} \\approx 2706356.08\\ \\mathrm{J/mol}$$\n\nThe problem requires the answer in $\\mathrm{kJ/mol}$. Converting units:\n$$\\langle K \\rangle_{\\text{molar}} \\approx 2706.35608\\ \\mathrm{kJ/mol}$$\nFinally, we must round the result to four significant figures as requested:\n$$\\langle K \\rangle_{\\text{molar}} \\approx 2706\\ \\mathrm{kJ/mol}$$\n\nThe two computed quantities are $N_f = 2100$ and $\\langle K \\rangle_{\\text{molar}} = 2706\\ \\mathrm{kJ/mol}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2100 & 2706\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from theory to practice requires making judicious choices about numerical parameters. A successful and physically meaningful simulation depends on balancing the stability of the numerical integrator with the influence of the thermostat. This exercise  presents a practical case study involving a high-temperature molten salt, a system with very fast atomic vibrations. You will need to weigh the constraints on the integration time step, $\\Delta t$, for numerical accuracy against the choice of the thermostat relaxation time, $\\tau$, to ensure proper temperature control without disrupting the system's intrinsic dynamics.",
            "id": "3841719",
            "problem": "A high-temperature molten salt is simulated using classical Molecular Dynamics (MD) with the velocity Verlet integrator and the Stochastic Velocity Rescaling (SVR) thermostat. The molten salt exhibits fast vibrational (optical-like) ionic modes due to strong short-range repulsion and long-range Coulomb interactions. Empirical spectroscopic and simulation data for similar ionic melts indicate that the fastest vibrational frequencies lie in the range $f_{\\max} \\in [20,40]\\,\\mathrm{THz}$ at temperatures above $1000\\,\\mathrm{K}$, so that the corresponding angular frequencies satisfy $\\omega_{\\max} = 2\\pi f_{\\max} \\in [1.26\\times 10^{14},\\,2.51\\times 10^{14}]\\,\\mathrm{s}^{-1}$. The SVR thermostat acts on the total kinetic energy with a relaxation time parameter $\\tau$ (so that its effective stochastic friction rate scales as $1/\\tau$).\n\nStarting from first principles, justify constraints on the MD time step $\\Delta t$ for stability and accuracy of velocity Verlet when modeling the fastest ionic vibrational mode as a harmonic oscillator, and justify constraints on $\\tau$ to ensure canonical sampling without overdamping or excessive dynamical bias in transport properties. Then, based on those constraints and trade-offs pertinent to a multiscale materials simulation (where short-time vibrational dynamics must be accurate and long-time transport should remain minimally perturbed), select the most appropriate pair $(\\Delta t,\\tau)$ from the options below for a high-temperature molten salt with the above vibrational spectrum:\n\n- A. $\\Delta t = 0.2\\,\\mathrm{fs}$, $\\tau = 100\\,\\mathrm{fs}$\n\n- B. $\\Delta t = 2.0\\,\\mathrm{fs}$, $\\tau = 10\\,\\mathrm{fs}$\n\n- C. $\\Delta t = 0.5\\,\\mathrm{fs}$, $\\tau = 500\\,\\mathrm{fs}$\n\n- D. $\\Delta t = 0.05\\,\\mathrm{fs}$, $\\tau = 5.0\\,\\mathrm{ps}$\n\nChoose the option that best balances numerical stability, statistical accuracy of canonical sampling, and minimal disturbance of intrinsic transport, and justify your choice from fundamental laws and well-tested results (e.g., Newton’s laws of motion, stability properties of velocity Verlet for harmonic oscillators, and the underdamped regime for Langevin-like thermostats).",
            "solution": "The starting point is Newton’s second law, which for a single harmonic vibrational mode can be written as $m\\,\\ddot{x}(t) = -k\\,x(t)$, where $m$ is the ionic mass, $k$ is the effective spring constant associated with the short-range repulsion and Coulombic restoring forces, and $\\omega = \\sqrt{k/m}$ is the angular frequency of that mode. The velocity Verlet integrator approximates the continuous dynamics with discrete updates at time step $\\Delta t$. For the harmonic oscillator, a linear stability analysis of symplectic two-step methods (including velocity Verlet) yields the well-tested condition for stability\n$$\n\\Delta t\\,\\omega < 2,\n$$\nand for acceptable accuracy and small phase error in the high-frequency modes one typically enforces a stricter bound\n$$\n\\Delta t\\,\\omega \\lesssim \\alpha,\n$$\nwith $\\alpha$ a small dimensionless number (empirically $\\alpha \\in [0.1,0.3]$) to ensure that truncation error and phase error do not corrupt the short-time dynamics, energy conservation, or derived transport on longer scales. For the fastest modes characterized by $\\omega_{\\max} \\in [1.26\\times 10^{14},\\,2.51\\times 10^{14}]\\,\\mathrm{s}^{-1}$, using the conservative upper bound $\\omega_{\\max} \\approx 2.51\\times 10^{14}\\,\\mathrm{s}^{-1}$ gives\n$$\n\\Delta t \\lesssim \\frac{\\alpha}{\\omega_{\\max}}.\n$$\nTaking $\\alpha \\approx 0.2$ (a common choice for stiff, fast modes in ionic systems at high temperature) yields\n$$\n\\Delta t \\lesssim \\frac{0.2}{2.51\\times 10^{14}\\,\\mathrm{s}^{-1}} \\approx 7.97\\times 10^{-16}\\,\\mathrm{s} \\approx 0.80\\,\\mathrm{fs}.\n$$\nThus, $\\Delta t$ near $0.5\\,\\mathrm{fs}$ lies comfortably within this regime, whereas $\\Delta t = 2.0\\,\\mathrm{fs}$ pushes $\\Delta t\\,\\omega_{\\max} \\approx 0.50$ (using $\\omega_{\\max}$ above), which is still linearly stable but typically too large to accurately resolve the fastest vibrations at high temperature, leading to significant phase error, poor energy conservation, and potential artifacts in sampling and transport.\n\nNext, consider the thermostat coupling. The SVR thermostat rescales velocities stochastically to control the total kinetic energy $K$ toward the canonical distribution. Its action can be mapped onto a global Langevin-like friction acting on kinetic energy with an effective rate $\\gamma = 1/\\tau$. For a single vibrational mode with angular frequency $\\omega$, the damped harmonic oscillator equation $m\\,\\ddot{x} + \\zeta\\,\\dot{x} + k\\,x = \\xi(t)$ (with $\\zeta$ a friction parameter and $\\xi(t)$ a stochastic force consistent with the fluctuation-dissipation theorem) exhibits three regimes: overdamped if $\\zeta/(2m) > \\omega$, critically damped if $\\zeta/(2m) = \\omega$, and underdamped if $\\zeta/(2m) < \\omega$. Translating this to a global friction rate $\\gamma$ acting on velocities, to avoid overdamping the fastest modes one requires\n$$\n\\gamma \\ll \\omega_{\\max},\n$$\ni.e., the dimensionless ratio $\\gamma/\\omega_{\\max} \\ll 1$, and in practice for minimal dynamical bias in transport one prefers $\\gamma/\\omega_{\\max} \\sim 10^{-2}$–$10^{-1}$, so that the thermostat relaxes the kinetic energy sufficiently fast to maintain the target temperature but does not significantly suppress oscillations or long-time correlations. Since $\\gamma = 1/\\tau$, this implies\n$$\n\\tau \\gg \\frac{1}{\\omega_{\\max}},\n$$\nwith typical choices on the order of many vibrational periods of the fastest mode. For $\\omega_{\\max} \\approx 2.51\\times 10^{14}\\,\\mathrm{s}^{-1}$, one has $1/\\omega_{\\max} \\approx 3.98\\times 10^{-15}\\,\\mathrm{s} \\approx 4.0\\,\\mathrm{fs}$. Choosing $\\tau$ one to two orders of magnitude larger than $1/\\omega_{\\max}$ (e.g., $\\tau \\sim 100$–$1000\\,\\mathrm{fs}$) places the system firmly in the underdamped regime while ensuring the total kinetic energy autocorrelation time is not so large that temperature control is ineffective over typical simulation windows. This choice preserves transport properties (diffusion, viscosity) that are sensitive to velocity correlations, which is especially important in multiscale materials simulation where short-time dynamics inform coarse-grained models and long-time sampling underpins continuum closures.\n\nNow we evaluate each option by computing the dimensionless products $\\Delta t\\,\\omega_{\\max}$ and $\\gamma/\\omega_{\\max} = 1/(\\tau\\,\\omega_{\\max})$, taking $\\omega_{\\max} \\approx 2.51\\times 10^{14}\\,\\mathrm{s}^{-1}$:\n\n- Option A: $\\Delta t = 0.2\\,\\mathrm{fs} = 2.0\\times 10^{-16}\\,\\mathrm{s}$ gives $\\Delta t\\,\\omega_{\\max} \\approx (2.0\\times 10^{-16}\\,\\mathrm{s})(2.51\\times 10^{14}\\,\\mathrm{s}^{-1}) \\approx 0.050$, well below the conservative accuracy threshold. $\\tau = 100\\,\\mathrm{fs}$ implies $\\gamma = 1/\\tau = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$, giving $\\gamma/\\omega_{\\max} \\approx 0.040$. This is underdamped and provides reasonably fast temperature control. However, $\\Delta t = 0.2\\,\\mathrm{fs}$ is extremely conservative for ionic melts and may be unnecessarily small, reducing efficiency without improving sampling materially beyond what a slightly larger time step (still satisfying $\\Delta t\\,\\omega_{\\max} \\lesssim 0.2$) would provide. In multiscale contexts where computational budget and throughput matter, this choice is not optimal. Verdict: Incorrect (overly conservative $\\Delta t$ with no compelling sampling advantage).\n\n- Option B: $\\Delta t = 2.0\\,\\mathrm{fs} = 2.0\\times 10^{-15}\\,\\mathrm{s}$ gives $\\Delta t\\,\\omega_{\\max} \\approx 0.50$, which exceeds typical accuracy bounds for fast vibrational modes and risks significant phase error and degraded energy conservation at high temperature. $\\tau = 10\\,\\mathrm{fs}$ implies $\\gamma = 1.0\\times 10^{14}\\,\\mathrm{s}^{-1}$, so $\\gamma/\\omega_{\\max} \\approx 0.40$, which is a relatively strong coupling. While still underdamped ($\\gamma/\\omega_{\\max} < 1$), it imposes substantial stochastic damping, likely biasing transport properties (e.g., diffusion coefficients) and suppressing velocity correlations. Verdict: Incorrect (time step too large for accuracy; thermostat too strong for minimally biased transport).\n\n- Option C: $\\Delta t = 0.5\\,\\mathrm{fs} = 5.0\\times 10^{-16}\\,\\mathrm{s}$ gives $\\Delta t\\,\\omega_{\\max} \\approx (5.0\\times 10^{-16}\\,\\mathrm{s})(2.51\\times 10^{14}\\,\\mathrm{s}^{-1}) \\approx 0.126$, comfortably within the conservative accuracy regime for fast vibrational modes, ensuring stable, accurate resolution of high-frequency ionic motions at high temperature. $\\tau = 500\\,\\mathrm{fs}$ implies $\\gamma = 2.0\\times 10^{12}\\,\\mathrm{s}^{-1}$, and thus $\\gamma/\\omega_{\\max} \\approx 0.008$, which is weak coupling. This preserves underdamped oscillations and minimizes dynamical bias while still providing adequate temperature control over sub-picosecond timescales. The total kinetic energy autocorrelation time $\\sim \\tau$ remains short relative to typical nanosecond simulation windows, so canonical sampling is efficient. Verdict: Correct (balances stability, accuracy, and minimal disturbance of transport).\n\n- Option D: $\\Delta t = 0.05\\,\\mathrm{fs} = 5.0\\times 10^{-17}\\,\\mathrm{s}$ gives $\\Delta t\\,\\omega_{\\max} \\approx 0.0126$, which is extremely conservative and far smaller than necessary for accuracy, greatly reducing efficiency. $\\tau = 5.0\\,\\mathrm{ps}$ implies $\\gamma = 2.0\\times 10^{11}\\,\\mathrm{s}^{-1}$, so $\\gamma/\\omega_{\\max} \\approx 0.0008$, which is extremely weak coupling. While this minimally perturbs dynamics, it also yields very slow temperature relaxation and long kinetic energy autocorrelation, reducing the number of statistically independent samples within practical simulation lengths and making thermal control sluggish—undesirable at high temperature where energy fluctuations can be large. Verdict: Incorrect (overly conservative $\\Delta t$ and overly slow thermostatting; poor practical sampling efficiency).\n\nIn summary, option C strikes the best balance for a high-temperature molten salt with fast vibrational modes: $\\Delta t = 0.5\\,\\mathrm{fs}$ respects accuracy and stability for $\\omega_{\\max}$, and $\\tau = 500\\,\\mathrm{fs}$ provides weak, underdamped coupling that preserves transport while maintaining canonical sampling effectiveness.",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}