{
    "hands_on_practices": [
        {
            "introduction": "We begin our hands-on exploration with the most fundamental crystal structure: the simple cubic lattice. This exercise will guide you through the process of constructing the reciprocal lattice and its first Brillouin zone from first principles. Mastering this foundational case  is essential for building the intuition needed to tackle more complex crystal systems.",
            "id": "3837911",
            "problem": "In multiscale materials simulation, the connection between real-space coarse-graining and reciprocal-space sampling density is mediated by the geometry and volume of the first Brillouin zone (BZ). Consider a three-dimensional monatomic crystal with a simple cubic Bravais lattice of lattice parameter $a$. Starting only from the fundamental definition of reciprocal lattice vectors and the Wigner–Seitz construction in reciprocal space, derive the primitive reciprocal lattice vectors, identify the shape of the first Brillouin zone, and compute the dimensionless product $a^{3} V_{\\mathrm{BZ}}$, where $V_{\\mathrm{BZ}}$ is the volume of the first Brillouin zone. Provide your final answer as a single closed-form analytic expression in terms of $\\pi$ only. Do not round. Do not include units in your final expression.",
            "solution": "The problem requires the derivation of the primitive reciprocal lattice vectors, the identification of the shape of the first Brillouin zone, and the calculation of the dimensionless product $a^{3} V_{\\mathrm{BZ}}$ for a simple cubic Bravais lattice with lattice parameter $a$. The derivation must proceed from fundamental definitions.\n\nFirst, we define the primitive lattice vectors for the real-space simple cubic (SC) lattice. Since the lattice is simple cubic, the primitive lattice vectors can be chosen to be orthogonal and aligned with the Cartesian axes, with a magnitude equal to the lattice parameter $a$.\nLet the basis vectors be $\\hat{x}$, $\\hat{y}$, and $\\hat{z}$. The primitive real-space lattice vectors $\\mathbf{a}_1$, $\\mathbf{a}_2$, and $\\mathbf{a}_3$ are:\n$$\n\\mathbf{a}_1 = a \\hat{x} \\\\\n\\mathbf{a}_2 = a \\hat{y} \\\\\n\\mathbf{a}_3 = a \\hat{z}\n$$\n\nNext, we derive the primitive reciprocal lattice vectors $\\mathbf{b}_1$, $\\mathbf{b}_2$, and $\\mathbf{b}_3$. The fundamental definition relating the reciprocal lattice vectors to the real-space vectors is given by:\n$$\n\\mathbf{b}_1 = 2\\pi \\frac{\\mathbf{a}_2 \\times \\mathbf{a}_3}{\\mathbf{a}_1 \\cdot (\\mathbf{a}_2 \\times \\mathbf{a}_3)} \\\\\n\\mathbf{b}_2 = 2\\pi \\frac{\\mathbf{a}_3 \\times \\mathbf{a}_1}{\\mathbf{a}_1 \\cdot (\\mathbf{a}_2 \\times \\mathbf{a}_3)} \\\\\n\\mathbf{b}_3 = 2\\pi \\frac{\\mathbf{a}_1 \\times \\mathbf{a}_2}{\\mathbf{a}_1 \\cdot (\\mathbf{a}_2 \\times \\mathbf{a}_3)}\n$$\nThe denominator, $\\mathbf{a}_1 \\cdot (\\mathbf{a}_2 \\times \\mathbf{a}_3)$, represents the volume of the primitive cell in real space, which we denote as $V_c$. Let us compute this volume:\n$$\n\\mathbf{a}_2 \\times \\mathbf{a}_3 = (a \\hat{y}) \\times (a \\hat{z}) = a^{2} (\\hat{y} \\times \\hat{z}) = a^{2} \\hat{x}\n$$\n$$\nV_c = \\mathbf{a}_1 \\cdot (\\mathbf{a}_2 \\times \\mathbf{a}_3) = (a \\hat{x}) \\cdot (a^{2} \\hat{x}) = a^{3} (\\hat{x} \\cdot \\hat{x}) = a^{3}\n$$\nNow, we can compute each reciprocal lattice vector.\nFor $\\mathbf{b}_1$:\n$$\n\\mathbf{b}_1 = 2\\pi \\frac{\\mathbf{a}_2 \\times \\mathbf{a}_3}{V_c} = 2\\pi \\frac{a^{2} \\hat{x}}{a^{3}} = \\frac{2\\pi}{a} \\hat{x}\n$$\nFor $\\mathbf{b}_2$, we first compute the cross product $\\mathbf{a}_3 \\times \\mathbf{a}_1$:\n$$\n\\mathbf{a}_3 \\times \\mathbf{a}_1 = (a \\hat{z}) \\times (a \\hat{x}) = a^{2} (\\hat{z} \\times \\hat{x}) = a^{2} \\hat{y}\n$$\n$$\n\\mathbf{b}_2 = 2\\pi \\frac{\\mathbf{a}_3 \\times \\mathbf{a}_1}{V_c} = 2\\pi \\frac{a^{2} \\hat{y}}{a^{3}} = \\frac{2\\pi}{a} \\hat{y}\n$$\nFor $\\mathbf{b}_3$, we compute the cross product $\\mathbf{a}_1 \\times \\mathbf{a}_2$:\n$$\n\\mathbf{a}_1 \\times \\mathbf{a}_2 = (a \\hat{x}) \\times (a \\hat{y}) = a^{2} (\\hat{x} \\times \\hat{y}) = a^{2} \\hat{z}\n$$\n$$\n\\mathbf{b}_3 = 2\\pi \\frac{\\mathbf{a}_1 \\times \\mathbf{a}_2}{V_c} = 2\\pi \\frac{a^{2} \\hat{z}}{a^{3}} = \\frac{2\\pi}{a} \\hat{z}\n$$\nThus, the primitive reciprocal lattice vectors are:\n$$\n\\mathbf{b}_1 = \\frac{2\\pi}{a} \\hat{x}, \\quad \\mathbf{b}_2 = \\frac{2\\pi}{a} \\hat{y}, \\quad \\mathbf{b}_3 = \\frac{2\\pi}{a} \\hat{z}\n$$\nThese vectors show that the reciprocal lattice of a simple cubic lattice is also a simple cubic lattice, with a lattice parameter of $\\frac{2\\pi}{a}$.\n\nThe next step is to identify the shape of the first Brillouin zone (BZ). The first BZ is defined as the Wigner-Seitz cell of the reciprocal lattice, centered at the origin ($\\mathbf{k}=0$). The Wigner-Seitz construction involves identifying the set of points in reciprocal space that are closer to the origin than to any other reciprocal lattice point. The boundaries of this cell are formed by the planes that are the perpendicular bisectors of the vectors connecting the origin to its nearest-neighbor reciprocal lattice points.\n\nThe general reciprocal lattice vector is $\\mathbf{G} = n_1 \\mathbf{b}_1 + n_2 \\mathbf{b}_2 + n_3 \\mathbf{b}_3$, where $n_1, n_2, n_3$ are integers. The nearest neighbors to the origin ($\\mathbf{G}=0$) are the six points corresponding to $(n_1, n_2, n_3)$ being $(\\pm 1, 0, 0)$, $(0, \\pm 1, 0)$, and $(0, 0, \\pm 1)$. These vectors are:\n$$\n\\pm \\mathbf{b}_1 = \\pm \\frac{2\\pi}{a} \\hat{x} \\\\\n\\pm \\mathbf{b}_2 = \\pm \\frac{2\\pi}{a} \\hat{y} \\\\\n\\pm \\mathbf{b}_3 = \\pm \\frac{2\\pi}{a} \\hat{z}\n$$\nThe perpendicular bisector planes must pass through the midpoints of these vectors. For example, for the vector $\\mathbf{b}_1$, the midpoint is $\\frac{1}{2}\\mathbf{b}_1 = \\frac{\\pi}{a}\\hat{x}$. The plane is normal to $\\mathbf{b}_1$ (i.e., normal to $\\hat{x}$) and passes through this point. The equation for a point $\\mathbf{k} = k_x \\hat{x} + k_y \\hat{y} + k_z \\hat{z}$ on this plane is $k_x = \\frac{\\pi}{a}$.\nApplying this to all six nearest-neighbor vectors, we obtain six planes:\n$$\nk_x = \\pm \\frac{\\pi}{a} \\\\\nk_y = \\pm \\frac{\\pi}{a} \\\\\nk_z = \\pm \\frac{\\pi}{a}\n$$\nThese six planes form the boundaries of the first Brillouin zone. The region they enclose is a cube centered at the origin of reciprocal space. The range of coordinates is $-\\frac{\\pi}{a} \\le k_x \\le \\frac{\\pi}{a}$, $-\\frac{\\pi}{a} \\le k_y \\le \\frac{\\pi}{a}$, and $-\\frac{\\pi}{a} \\le k_z \\le \\frac{\\pi}{a}$.\n\nFinally, we compute the volume of the first Brillouin zone, $V_{\\mathrm{BZ}}$, and the dimensionless product $a^{3} V_{\\mathrm{BZ}}$. The first BZ is a cube with a side length of $(\\frac{\\pi}{a}) - (-\\frac{\\pi}{a}) = \\frac{2\\pi}{a}$. The volume of a cube is the side length cubed:\n$$\nV_{\\mathrm{BZ}} = \\left(\\frac{2\\pi}{a}\\right)^{3} = \\frac{8\\pi^{3}}{a^{3}}\n$$\nNow we compute the required dimensionless product:\n$$\na^{3} V_{\\mathrm{BZ}} = a^{3} \\left( \\frac{8\\pi^{3}}{a^{3}} \\right) = 8\\pi^{3}\n$$\nThis result is a dimensionless constant, as expected, since $a^{3}$ has units of volume (e.g., $\\mathrm{m}^{3}$) and $V_{\\mathrm{BZ}}$ has units of reciprocal volume (e.g., $\\mathrm{m}^{-3}$). The value depends only on the mathematical constant $\\pi$.\nThis result is consistent with the general theorem stating that the volume of the first Brillouin zone is $(2\\pi)^{3}$ divided by the volume of the real-space primitive cell: $V_{\\mathrm{BZ}} = \\frac{(2\\pi)^{3}}{V_c} = \\frac{(2\\pi)^{3}}{a^{3}}$.",
            "answer": "$$\\boxed{8\\pi^{3}}$$"
        },
        {
            "introduction": "Building upon the basics, we now turn to centered lattices, which are common in real materials. This practice explores the body-centered cubic (BCC) lattice, revealing the fascinating dual relationship where its reciprocal lattice is face-centered cubic (FCC). Working through this derivation  deepens your understanding of how real-space centering impacts reciprocal-space geometry and is a cornerstone of solid-state physics.",
            "id": "3837974",
            "problem": "A three-dimensional Bravais lattice in real space is specified by three primitive vectors $\\mathbf{a}_{1}$, $\\mathbf{a}_{2}$, and $\\mathbf{a}_{3}$ that generate all lattice points by integer linear combinations. The reciprocal lattice is defined as the set of all wavevectors $\\mathbf{G}$ that satisfy $\\exp(i\\,\\mathbf{G}\\cdot\\mathbf{R})=1$ for every lattice translation $\\mathbf{R}$ constructed from the real-space primitive vectors. Starting from this definition and the dual-basis condition $\\mathbf{b}_{i}\\cdot\\mathbf{a}_{j}=2\\pi\\,\\delta_{ij}$, where $\\mathbf{b}_{i}$ are the reciprocal primitive vectors and $\\delta_{ij}$ is the Kronecker delta, derive the reciprocal lattice for the following centered real-space lattice.\n\nConsider a body-centered cubic (bcc) Bravais lattice with conventional cubic lattice parameter $a$ and choose a primitive basis\n$$\n\\mathbf{a}_{1}=\\frac{a}{2}(-1,\\,1,\\,1),\\quad\n\\mathbf{a}_{2}=\\frac{a}{2}(1,\\,-1,\\,1),\\quad\n\\mathbf{a}_{3}=\\frac{a}{2}(1,\\,1,\\,-1).\n$$\nUsing only foundational definitions and well-tested facts (avoid memorized target formulas), do the following:\n- From first principles, construct a primitive reciprocal basis $\\{\\mathbf{b}_{1},\\mathbf{b}_{2},\\mathbf{b}_{3}\\}$ that satisfies $\\mathbf{b}_{i}\\cdot\\mathbf{a}_{j}=2\\pi\\,\\delta_{ij}$.\n- Deduce the centering type of the reciprocal lattice (for example, face-centered cubic (fcc), body-centered cubic (bcc), or simple cubic), and justify your conclusion based on the structure of $\\{\\mathbf{b}_{i}\\}$ relative to a conventional cubic frame in reciprocal space.\n- Using the definition of the First Brillouin Zone (BZ) as the Wigner–Seitz cell of the reciprocal lattice, compute the exact volume of the First Brillouin Zone in terms of $a$.\n\nExpress your final answer for the Brillouin zone volume as a single closed-form analytic expression in terms of $a$ and $\\pi$, and state the unit in $\\text{m}^{-3}$. Do not perform any numerical rounding.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of solid-state physics, specifically the theory of crystal lattices and their reciprocal counterparts. The problem is well-posed, providing all necessary definitions, constants, and vectors to uniquely determine the required quantities. The language is objective and the tasks are unambiguous. Thus, a complete solution can be constructed.\n\nThe problem requires a three-part derivation, starting from the given primitive vectors of a body-centered cubic (bcc) lattice. The three parts are: the construction of the reciprocal primitive basis vectors, the identification of the reciprocal lattice's centering type, and the calculation of the volume of the First Brillouin Zone.\n\nFirst, we address the construction of the reciprocal lattice basis vectors $\\{\\mathbf{b}_{1}, \\mathbf{b}_{2}, \\mathbf{b}_{3}\\}$. These vectors are defined by the duality condition $\\mathbf{b}_{i} \\cdot \\mathbf{a}_{j} = 2\\pi\\,\\delta_{ij}$, where $\\{\\mathbf{a}_{j}\\}$ are the real-space primitive vectors and $\\delta_{ij}$ is the Kronecker delta. A general and systematic method to find the vectors $\\mathbf{b}_{i}$ is through the formula:\n$$\n\\mathbf{b}_{i} = 2\\pi \\frac{\\mathbf{a}_{j} \\times \\mathbf{a}_{k}}{\\mathbf{a}_{i} \\cdot (\\mathbf{a}_{j} \\times \\mathbf{a}_{k})}\n$$\nwhere $(i, j, k)$ is a cyclic permutation of $(1, 2, 3)$. The denominator, $V_c = \\mathbf{a}_{1} \\cdot (\\mathbf{a}_{2} \\times \\mathbf{a}_{3})$, is the volume of the primitive cell in real space.\n\nThe given real-space primitive vectors are:\n$$\n\\mathbf{a}_{1}=\\frac{a}{2}(-1, 1, 1)\n$$\n$$\n\\mathbf{a}_{2}=\\frac{a}{2}(1, -1, 1)\n$$\n$$\n\\mathbf{a}_{3}=\\frac{a}{2}(1, 1, -1)\n$$\nWe begin by calculating the scalar triple product, which represents the volume of the primitive unit cell. First, we compute the cross product $\\mathbf{a}_{2} \\times \\mathbf{a}_{3}$:\n$$\n\\mathbf{a}_{2} \\times \\mathbf{a}_{3} = \\left(\\frac{a}{2}\\right)^2 \\det \\begin{pmatrix} \\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\ 1 & -1 & 1 \\\\ 1 & 1 & -1 \\end{pmatrix} = \\frac{a^2}{4} \\left( ((-1)(-1) - (1)(1))\\hat{\\mathbf{x}} - ((1)(-1) - (1)(1))\\hat{\\mathbf{y}} + ((1)(1) - (-1)(1))\\hat{\\mathbf{z}} \\right)\n$$\n$$\n\\mathbf{a}_{2} \\times \\mathbf{a}_{3} = \\frac{a^2}{4} (0, 2, 2) = \\frac{a^2}{2} (0, 1, 1)\n$$\nNow, we calculate the scalar triple product:\n$$\nV_c = \\mathbf{a}_{1} \\cdot (\\mathbf{a}_{2} \\times \\mathbf{a}_{3}) = \\frac{a}{2}(-1, 1, 1) \\cdot \\frac{a^2}{2}(0, 1, 1) = \\frac{a^3}{4} ((-1)(0) + (1)(1) + (1)(1)) = \\frac{a^3}{4}(2) = \\frac{a^3}{2}\n$$\nThis is the volume of the bcc primitive cell, which is half the volume of the conventional cubic cell ($a^3$), as expected since the conventional cell contains $2$ lattice points.\n\nNow we can find the reciprocal primitive vectors. For $\\mathbf{b}_{1}$:\n$$\n\\mathbf{b}_{1} = 2\\pi \\frac{\\mathbf{a}_{2} \\times \\mathbf{a}_{3}}{V_c} = 2\\pi \\frac{\\frac{a^2}{2}(0, 1, 1)}{\\frac{a^3}{2}} = \\frac{2\\pi}{a}(0, 1, 1)\n$$\nFor $\\mathbf{b}_{2}$, we need $\\mathbf{a}_{3} \\times \\mathbf{a}_{1}$:\n$$\n\\mathbf{a}_{3} \\times \\mathbf{a}_{1} = \\left(\\frac{a}{2}\\right)^2 \\det \\begin{pmatrix} \\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\ 1 & 1 & -1 \\\\ -1 & 1 & 1 \\end{pmatrix} = \\frac{a^2}{4} \\left( (1)(1) - (-1)(1), (-1)(-1) - (1)(1), (1)(1) - (1)(-1) \\right) = \\frac{a^2}{4} (2, 0, 2) = \\frac{a^2}{2}(1, 0, 1)\n$$\n$$\n\\mathbf{b}_{2} = 2\\pi \\frac{\\mathbf{a}_{3} \\times \\mathbf{a}_{1}}{V_c} = 2\\pi \\frac{\\frac{a^2}{2}(1, 0, 1)}{\\frac{a^3}{2}} = \\frac{2\\pi}{a}(1, 0, 1)\n$$\nFor $\\mathbf{b}_{3}$, we need $\\mathbf{a}_{1} \\times \\mathbf{a}_{2}$:\n$$\n\\mathbf{a}_{1} \\times \\mathbf{a}_{2} = \\left(\\frac{a}{2}\\right)^2 \\det \\begin{pmatrix} \\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\ -1 & 1 & 1 \\\\ 1 & -1 & 1 \\end{pmatrix} = \\frac{a^2}{4}\\left( (1)(1) - (1)(-1), (1)(1) - (-1)(1), (-1)(-1) - (1)(1) \\right) = \\frac{a^2}{4}(2, 2, 0) = \\frac{a^2}{2}(1, 1, 0)\n$$\n$$\n\\mathbf{b}_{3} = 2\\pi \\frac{\\mathbf{a}_{1} \\times \\mathbf{a}_{2}}{V_c} = 2\\pi \\frac{\\frac{a^2}{2}(1, 1, 0)}{\\frac{a^3}{2}} = \\frac{2\\pi}{a}(1, 1, 0)\n$$\nThe constructed reciprocal primitive basis is thus:\n$$\n\\mathbf{b}_{1} = \\frac{2\\pi}{a}(0, 1, 1), \\quad \\mathbf{b}_{2} = \\frac{2\\pi}{a}(1, 0, 1), \\quad \\mathbf{b}_{3} = \\frac{2\\pi}{a}(1, 1, 0)\n$$\n\nSecond, we deduce the centering type of the reciprocal lattice. The vectors $\\{\\mathbf{b}_{1}, \\mathbf{b}_{2}, \\mathbf{b}_{3}\\}$ are the primitive vectors of the reciprocal lattice. We can identify the lattice type by examining their structure. These vectors are characteristic of a face-centered cubic (fcc) lattice. An fcc lattice with a conventional cubic cell of side length $A_{recip}$ can be generated by primitive vectors connecting a corner of the cube to the centers of the three adjacent faces. These vectors are:\n$$\n\\mathbf{v}_{1} = \\frac{A_{recip}}{2}(\\hat{\\mathbf{y}} + \\hat{\\mathbf{z}}), \\quad \\mathbf{v}_{2} = \\frac{A_{recip}}{2}(\\hat{\\mathbf{x}} + \\hat{\\mathbf{z}}), \\quad \\mathbf{v}_{3} = \\frac{A_{recip}}{2}(\\hat{\\mathbf{x}} + \\hat{\\mathbf{y}})\n$$\nComparing our calculated vectors $\\{\\mathbf{b}_{i}\\}$ with these standard fcc primitive vectors (up to a permutation), we see a direct correspondence:\n$$\n\\mathbf{b}_{1} \\text{ corresponds to } \\mathbf{v}_{1}, \\quad \\mathbf{b}_{2} \\text{ corresponds to } \\mathbf{v}_{2}, \\quad \\mathbf{b}_{3} \\text{ corresponds to } \\mathbf{v}_{3}\n$$\nThis match implies that the reciprocal lattice is indeed fcc. By comparing the magnitudes, we find $\\frac{A_{recip}}{2} = \\frac{2\\pi}{a}$, which gives the side length of the conventional cubic cell of the reciprocal lattice as $A_{recip} = \\frac{4\\pi}{a}$. Therefore, the reciprocal lattice of a bcc lattice is an fcc lattice.\n\nThird, we compute the volume of the First Brillouin Zone, $V_{BZ}$. The First Brillouin Zone is defined as the Wigner-Seitz cell of the reciprocal lattice. A fundamental property of Bravais lattices is that the volume of the Wigner-Seitz cell is equal to the volume of the primitive cell. Thus, $V_{BZ}$ is the volume of the primitive cell of the reciprocal lattice, which can be computed using the scalar triple product of the reciprocal primitive vectors.\n$$\nV_{BZ} = |\\mathbf{b}_{1} \\cdot (\\mathbf{b}_{2} \\times \\mathbf{b}_{3})|\n$$\nWe calculate $\\mathbf{b}_{2} \\times \\mathbf{b}_{3}$:\n$$\n\\mathbf{b}_{2} \\times \\mathbf{b}_{3} = \\left(\\frac{2\\pi}{a}\\right)^2 \\det \\begin{pmatrix} \\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\ 1 & 0 & 1 \\\\ 1 & 1 & 0 \\end{pmatrix} = \\left(\\frac{2\\pi}{a}\\right)^2 \\left( (0)(0) - (1)(1), (1)(1) - (1)(0), (1)(1) - (0)(1) \\right) = \\left(\\frac{2\\pi}{a}\\right)^2 (-1, 1, 1)\n$$\nThen we compute the dot product with $\\mathbf{b}_{1}$:\n$$\n\\mathbf{b}_{1} \\cdot (\\mathbf{b}_{2} \\times \\mathbf{b}_{3}) = \\frac{2\\pi}{a}(0, 1, 1) \\cdot \\left(\\frac{2\\pi}{a}\\right)^2 (-1, 1, 1) = \\left(\\frac{2\\pi}{a}\\right)^3 ( (0)(-1) + (1)(1) + (1)(1) ) = \\left(\\frac{2\\pi}{a}\\right)^3 (2) = \\frac{8\\pi^3}{a^3} \\cdot 2 = \\frac{16\\pi^3}{a^3}\n$$\nSo, the volume of the First Brillouin Zone is $V_{BZ} = \\frac{16\\pi^3}{a^3}$.\n\nAlternatively, we can use the general relation between the volumes of the real-space primitive cell ($V_c$) and the reciprocal-space primitive cell ($V_{BZ}$):\n$$\nV_{BZ} = \\frac{(2\\pi)^3}{V_c}\n$$\nWe previously calculated $V_c = \\frac{a^3}{2}$. Substituting this value:\n$$\nV_{BZ} = \\frac{(2\\pi)^3}{a^3/2} = \\frac{8\\pi^3}{a^3/2} = 2 \\cdot \\frac{8\\pi^3}{a^3} = \\frac{16\\pi^3}{a^3}\n$$\nBoth methods yield the same result, confirming the calculation. If the conventional lattice parameter $a$ is given in meters ($\\mathrm{m}$), then the volume of the First Brillouin Zone is in units of inverse cubic meters ($\\mathrm{m}^{-3}$).",
            "answer": "$$\\boxed{\\frac{16\\pi^3}{a^3}}$$"
        },
        {
            "introduction": "Finally, we bridge theory and computational practice by addressing the concept of band structure unfolding. In materials simulation, we often use supercells to model defects or alloys, which \"folds\" the electronic band structure into a smaller Brillouin zone; this exercise  guides you in creating an algorithm to \"unfold\" this data, making it interpretable in the context of the primitive crystal. This is a powerful technique essential for analyzing results from modern electronic structure calculations.",
            "id": "3837954",
            "problem": "Design and implement a complete, runnable program that constructs and validates an algorithm for Brillouin zone unfolding from supercell eigenstates projected onto primitive-cell Bloch states in a one-dimensional tight-binding model. The algorithm must be derived from first principles of reciprocal space and Bloch theory and must operate on a one-dimensional lattice with a supercell composed of a finite number of primitive cells.\n\nStart from the following fundamental base:\n- The reciprocal lattice vector of a one-dimensional lattice with primitive lattice constant $a$ is $b = \\frac{2\\pi}{a}$.\n- For a supercell that contains $S$ primitive cells, the supercell lattice constant is $A = S a$, and the supercell reciprocal lattice vector is $b_{\\mathrm{sc}} = \\frac{2\\pi}{A} = \\frac{2\\pi}{S a}$.\n- Bloch's theorem states that eigenstates in a periodic potential can be labeled by crystal momentum; for the supercell description the crystal momentum is $K$ within the first Brillouin zone of the supercell, which spans $K \\in \\left[-\\frac{\\pi}{S a}, \\frac{\\pi}{S a}\\right)$.\n- The first Brillouin zone of the primitive lattice spans $k \\in \\left[-\\frac{\\pi}{a}, \\frac{\\pi}{a}\\right)$.\n\nConstruct the algorithm according to the following principles:\n1. Build the supercell tight-binding Hamiltonian $H(K)$ for a one-dimensional chain with nearest-neighbor hopping. The supercell contains $S$ sublattices indexed by $s \\in \\{0,1,\\dots,S-1\\}$ with onsite energies $\\varepsilon_s$. The nearest-neighbor hopping amplitude is $t$ between sublattice $s$ and $s+1$ (with indices taken modulo $S$). Enforce Bloch boundary conditions across the supercell via a phase factor $e^{i K A}$ for hopping that crosses the supercell boundary. Explicitly, $H(K)$ is an $S \\times S$ Hermitian matrix with\n   - $H_{s,s}(K) = \\varepsilon_s$,\n   - $H_{s,(s+1)\\bmod S}(K) = t$ for $s \\in \\{0,1,\\dots,S-2\\}$ and $H_{S-1,0}(K) = t e^{i K A}$,\n   - $H_{(s+1)\\bmod S,s}(K) = [H_{s,(s+1)\\bmod S}(K)]^*$ to ensure Hermiticity.\n2. Diagonalize $H(K)$ to obtain supercell eigenvectors $\\mathbf{u}^{(n)}(K)$, where $n \\in \\{0,1,\\dots,S-1\\}$ indexes the bands for each $K$.\n3. Define the set of primitive-cell crystal momenta compatible with the supercell momentum $K$ as $k_m = K + G_m$, where $m \\in \\{0,1,\\dots,S-1\\}$ and $G_m = \\frac{2\\pi m}{S a}$ are the supercell reciprocal lattice vectors that map $K$ into the primitive first Brillouin zone.\n4. Project each supercell eigenvector $\\mathbf{u}^{(n)}(K)$ onto the primitive Bloch basis labeled by $k_m$ using the discrete Fourier transform over the sublattice index $s$:\n   - Compute the unfolding amplitude $c_m^{(n)}(K) = \\frac{1}{\\sqrt{S}} \\sum_{s=0}^{S-1} e^{-i G_m s a} \\, u^{(n)}_s(K)$.\n   - The unfolding weight is $w_m^{(n)}(K) = |c_m^{(n)}(K)|^2$.\n5. Validate the algorithm using the properties implied by orthonormality and the unitary nature of the discrete Fourier transform:\n   - For any normalized eigenvector $\\mathbf{u}^{(n)}(K)$, the weights must satisfy $\\sum_{m=0}^{S-1} w_m^{(n)}(K) = 1$.\n   - If the supercell is uniform (all onsite energies equal, $\\varepsilon_s = \\varepsilon$ for all $s$), then each eigenvector corresponds to a single primitive momentum sector, and the unfolding weights must be delta-peaked: $\\max_m w_m^{(n)}(K) \\approx 1$ for all $K$ and $n$, up to numerical tolerance.\n\nImplement the program with the following requirements:\n- Use a momentum grid in the supercell first Brillouin zone defined by $K_j = -\\frac{\\pi}{S a} + \\left(j+\\frac{1}{2}\\right) \\frac{2\\pi}{S a M}$ for $j \\in \\{0,1,\\dots,M-1\\}$ to avoid exact boundary degeneracies, where $M$ is the number of $K$-points per test case.\n- For each test case, compute $H(K_j)$ for all $K_j$, diagonalize, compute all $w_m^{(n)}(K_j)$, and apply the specified validation checks.\n\nTest Suite (each test case is a tuple-like structure to be implemented in the program):\n- Test case $1$ (happy path, uniform diatomic supercell):\n  - Parameters: `S = 2`, `a = 1.0`, `t = 1.0`, `ε = [0.0, 0.0]`, `M = 16`.\n  - Validation: Check both normalization ($\\sum_m w_m^{(n)}(K_j) = 1$ within tolerance) and delta-peaked property ($\\max_m w_m^{(n)}(K_j) \\ge 1 - \\tau$ for all $K_j$ and $n$).\n- Test case $2$ (nonuniform diatomic supercell with onsite modulation):\n  - Parameters: `S = 2`, `a = 1.0`, `t = 1.0`, `ε = [0.3, -0.3]`, `M = 16`.\n  - Validation: Check normalization only ($\\sum_m w_m^{(n)}(K_j) = 1$ within tolerance).\n- Test case $3$ (uniform triatomic supercell):\n  - Parameters: `S = 3`, `a = 1.0`, `t = 0.7`, `ε = [0.0, 0.0, 0.0]`, `M = 18`.\n  - Validation: Check both normalization and delta-peaked property.\n\nTolerance:\n- Use absolute tolerance $\\tau = 10^{-10}$ for all checks involving equality or delta-peaked behavior.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results of the three test cases as a comma-separated list enclosed in square brackets, where each element is a boolean indicating whether the test case passed (for example, `[\\mathrm{True},\\mathrm{False},\\mathrm{True}]`).",
            "solution": "The problem statement is a valid, well-posed, and scientifically sound exercise in computational condensed matter physics. It requires the implementation and validation of a band unfolding algorithm for a one-dimensional tight-binding model, a standard technique used in materials simulation to interpret supercell band structures in terms of the underlying primitive cell. All parameters, equations, and validation criteria are clearly and correctly specified. We may therefore proceed with the derivation of the solution.\n\n### Theoretical Foundation and Algorithmic Design\n\nThe core task is to relate the electronic eigenstates of a large `supercell`, which may contain internal structure (e.g., different onsite energies), back to the simpler electronic structure of the corresponding `primitive cell`. The primitive cell is the minimal repeating unit of a crystal, with lattice constant $a$. A supercell is an artificially larger repeating unit comprising $S$ primitive cells, with lattice constant $A = S a$.\n\nIn reciprocal space, this corresponds to a smaller first Brillouin zone (FBZ) for the supercell, $[-\\pi/A, \\pi/A)$, compared to the primitive cell's FBZ, $[-\\pi/a, \\pi/a)$. Consequently, the band structure calculated in the supercell formalism appears \"folded.\" Multiple points $k$ from the primitive FBZ are mapped onto a single point $K$ in the supercell FBZ. The relationship is given by $k = K + G_m$, where $G_m = m \\frac{2\\pi}{A} = m \\frac{2\\pi}{S a}$ are the reciprocal lattice vectors of the supercell lattice, for integer $m$. The unfolding algorithm quantifies how much of an eigenstate with supercell momentum $K$ corresponds to each of the original primitive cell momenta $k_m$.\n\nThe designed algorithm proceeds in four primary steps:\n\n**1. Supercell Hamiltonian Construction**\nWe model a one-dimensional atomic chain using a tight-binding approximation. The supercell contains $S$ sites (sublattices), indexed by $s \\in \\{0, 1, \\dots, S-1\\}$. Each site $s$ has an onsite energy $\\varepsilon_s$, and there is a hopping amplitude $t$ between nearest-neighbor sites. The Hamiltonian $H(K)$ for a given supercell crystal momentum $K$ is an $S \\times S$ Hermitian matrix. Its elements are derived from Bloch's theorem applied to the supercell.\nThe matrix elements are:\n-   On-diagonal (onsite energy): $H_{s,s}(K) = \\varepsilon_s$.\n-   Off-diagonal (intra-supercell hopping): $H_{s, s+1}(K) = t$ for $s \\in \\{0, \\dots, S-2\\}$.\n-   Off-diagonal (inter-supercell hopping): The hopping from site $s=S-1$ in one supercell to site $s=0$ in the next supercell acquires a phase factor $e^{iKA}$, so $H_{S-1, 0}(K) = t e^{iKA}$.\n-   Hermiticity requires $H_{r,s}(K) = [H_{s,r}(K)]^*$. This implies $H_{s+1,s}(K) = t$ for the lower off-diagonal and $H_{0,S-1}(K) = t e^{-iKA}$ for the corner element, assuming $t$ is real.\n\nFor a supercell of size $S$, the Hamiltonian matrix $H(K)$ takes the form:\n$$\nH(K) = \\begin{pmatrix}\n\\varepsilon_0 & t & 0 & \\dots & t e^{-iKA} \\\\\nt & \\varepsilon_1 & t & \\dots & 0 \\\\\n0 & t & \\varepsilon_2 & \\ddots & \\vdots \\\\\n\\vdots & \\vdots & \\ddots & \\ddots & t \\\\\nt e^{iKA} & 0 & \\dots & t & \\varepsilon_{S-1}\n\\end{pmatrix}\n$$\nThis structure is implemented by summing an intra-supercell matrix (diagonal and main off-diagonals) and an inter-supercell matrix (corner elements).\n\n**2. Eigenstate Calculation**\nFor each momentum point $K_j$ on a discrete grid within the supercell's first Brillouin zone, the Hamiltonian $H(K_j)$ is constructed and diagonalized. Since $H(K_j)$ is Hermitian, this yields $S$ real eigenvalues $E_n(K_j)$ (the band energies) and a corresponding set of $S$ orthonormal eigenvectors $\\mathbf{u}^{(n)}(K_j)$. Each eigenvector $\\mathbf{u}^{(n)}(K_j)$ is a column vector of size $S$, where the component $u_s^{(n)}(K_j)$ is the amplitude of the wavefunction on sublattice $s$.\n\n**3. Unfolding via Projection**\nThe essence of unfolding is to change the basis from the sublattice representation within the supercell to the primitive-cell Bloch-wave representation. A primitive-cell Bloch state with momentum $k_m = K + G_m$ has wavefunction components on the sublattices that vary as $e^{i k_m x_s} = e^{i k_m s a}$, where $x_s = sa$ is the position of sublattice site $s$.\nThe unfolding amplitude, $c_m^{(n)}(K)$, is the projection of the supercell eigenvector $\\mathbf{u}^{(n)}(K)$ onto the primitive-cell Bloch basis state associated with momentum $k_m$:\n$$\nc_m^{(n)}(K) = \\frac{1}{\\sqrt{S}} \\sum_{s=0}^{S-1} e^{-i G_m s a} \\, u^{(n)}_s(K)\n$$\nThe factor $1/\\sqrt{S}$ ensures the transformation is unitary. The phase is $e^{-i G_m s a} = e^{-i (\\frac{2\\pi m}{Sa}) s a} = e^{-i 2\\pi ms/S}$. This reveals that the set of amplitudes $\\{c_m^{(n)}(K)\\}_{m=0}^{S-1}$ is simply the Discrete Fourier Transform (DFT) of the eigenvector components $\\{u_s^{(n)}(K)\\}_{s=0}^{S-1}$, scaled by $1/\\sqrt{S}$. This calculation is performed efficiently using a Fast Fourier Transform (FFT) algorithm.\nThe unfolding weight, $w_m^{(n)}(K) = |c_m^{(n)}(K)|^2$, represents the probability that the supercell state $(\\mathbf{u}^{(n)}, K)$ is derived from the primitive-cell state with momentum $k_m$.\n\n**4. Algorithmic Validation**\nTwo fundamental checks validate the algorithm's correctness:\n-   **Normalization**: The projection from one orthonormal basis (sublattice sites) to another (primitive-cell momenta) is a unitary transformation. By Parseval's theorem for the DFT, the norm must be conserved. Since the eigenvectors $\\mathbf{u}^{(n)}(K)$ are normalized ($\\sum_s |u_s^{(n)}|^2 = 1$), the sum of the unfolding weights must also be unity:\n    $$\n    \\sum_{m=0}^{S-1} w_m^{(n)}(K) = \\sum_{m=0}^{S-1} |c_m^{(n)}(K)|^2 = 1\n    $$\n    This must hold for any eigenstate and any $K$ value, within a given numerical tolerance $\\tau$.\n\n-   **Uniform Limit**: If the supercell potential is uniform ($\\varepsilon_s = \\varepsilon$ for all $s$), the supercell is an artificial construct and the system retains the full translational symmetry of the primitive lattice. The true eigenstates are the primitive-cell Bloch states, each with a single well-defined momentum $k$. In the supercell calculation, this state is folded to $K = k \\pmod{G_m}$. The unfolding procedure must recover this fact, meaning the weight distribution $w_m^{(n)}(K)$ should be sharply peaked at a single value of $m$. The validation check is that the maximum weight must be approximately one: $\\max_m w_m^{(n)}(K) \\ge 1 - \\tau$. In a non-uniform supercell, this property is not expected to hold, as the potential breaks the primitive-cell symmetry and mixes different momentum components.\n\nThe implementation uses a shifted momentum grid $K_j = -\\frac{\\pi}{A} + (j+\\frac{1}{2}) \\frac{2\\pi}{AM}$ to avoid degeneracies at high-symmetry points (the zone boundaries).",
            "answer": "```python\nimport numpy as np\n\ndef run_test_case(S, a, t, eps, M, check_delta):\n    \"\"\"\n    Runs a single test case for the Brillouin zone unfolding algorithm.\n\n    Args:\n        S (int): Number of primitive cells in the supercell.\n        a (float): Primitive lattice constant.\n        t (float): Nearest-neighbor hopping amplitude.\n        eps (list or np.ndarray): List of onsite energies for each sublattice.\n        M (int): Number of K-points in the supercell Brillouin zone grid.\n        check_delta (bool): Flag to indicate if the delta-peaked validation\n                            should be performed.\n\n    Returns:\n        bool: True if all validation checks pass for the test case, False otherwise.\n    \"\"\"\n    tau = 1e-10\n    pi = np.pi\n    \n    # Supercell lattice constant\n    A = S * a\n    \n    # Onsite energies as a numpy array\n    eps = np.array(eps)\n\n    # Supercell momentum grid (shifted to avoid BZ boundaries)\n    k_step = 2 * pi / (A * M)\n    K_grid = -pi / A + (np.arange(M) + 0.5) * k_step\n\n    for K in K_grid:\n        # Construct the supercell Hamiltonian H(K)\n        # 1. Intra-supercell part (diagonal and nearest off-diagonals)\n        H_intra = np.diag(eps) + np.diag(np.full(S - 1, t), k=1) + np.diag(np.full(S - 1, t), k=-1)\n        \n        # 2. Inter-supercell part (boundary condition terms)\n        H_inter = np.zeros((S, S), dtype=np.complex128)\n        # Hopping from site S-1 to next cell's site 0\n        H_inter[S - 1, 0] = t * np.exp(1j * K * A)\n        # Hopping from site 0 to previous cell's site S-1 (Hermiticity)\n        H_inter[0, S - 1] = np.conj(H_inter[S - 1, 0])\n        \n        # 3. Total Hamiltonian\n        H = H_intra.astype(np.complex128) + H_inter\n\n        # Diagonalize the Hermitian matrix H(K)\n        # np.linalg.eigh returns normalized eigenvectors in columns\n        _eigenvalues, eigenvectors = np.linalg.eigh(H)\n\n        # Loop over each band (eigenvector)\n        for n in range(S):\n            u_n = eigenvectors[:, n]\n\n            # Compute unfolding amplitudes c_m^{(n)}(K) via FFT\n            # The formula c_m = (1/sqrt(S)) * sum_s exp(-i*G_m*s*a) * u_s\n            # is equivalent to a scaled DFT, as G_m*s*a = 2*pi*m*s/S.\n            # np.fft.fft computes sum_s u_s * exp(-i*2*pi*m*s/S)\n            c_m_vec = np.fft.fft(u_n) / np.sqrt(S)\n\n            # Compute unfolding weights w_m^{(n)}(K)\n            weights = np.abs(c_m_vec)**2\n\n            # Validation Check 1: Normalization\n            # The sum of weights must be 1 due to the unitary nature of DFT.\n            if not np.isclose(np.sum(weights), 1.0, atol=tau):\n                return False\n\n            # Validation Check 2: Delta-peaked property for uniform supercells\n            if check_delta:\n                if not (np.max(weights) >= 1.0 - tau):\n                    return False\n    \n    # If all checks pass for all K-points and all bands, the test case is successful\n    return True\n\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and run the validation.\n    \"\"\"\n    test_cases = [\n        {\n            \"S\": 2, \"a\": 1.0, \"t\": 1.0, \"eps\": [0.0, 0.0], \"M\": 16,\n            \"check_delta\": True, \"description\": \"Uniform diatomic supercell\"\n        },\n        {\n            \"S\": 2, \"a\": 1.0, \"t\": 1.0, \"eps\": [0.3, -0.3], \"M\": 16,\n            \"check_delta\": False, \"description\": \"Nonuniform diatomic supercell\"\n        },\n        { \n            \"S\": 3, \"a\": 1.0, \"t\": 0.7, \"eps\": [0.0, 0.0, 0.0], \"M\": 18,\n            \"check_delta\": True, \"description\": \"Uniform triatomic supercell\"\n        }\n    ]\n\n    results = []\n    for case_params in test_cases:\n        # Isolate the parameters needed for the run function a\n        run_params = {k: v for k, v in case_params.items() if k != 'description'}\n        passed = run_test_case(**run_params)\n        results.append(passed)\n\n    # Format and print the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}