{
    "hands_on_practices": [
        {
            "introduction": "在原子轨道线性组合（LCAO）理论中，重叠积分是衡量相邻原子轨道空间交叠程度的基本物理量，对化学键的形成和材料能带结构的计算至关重要。本练习将引导你深入探索 Slater 型轨道（STO）与 Gaussian 型轨道（GTO）之间的核心计算差异 。你将通过推导 GTO 的解析重叠积分公式，亲身体验其数学上的便利性，并通过为物理上更精确的 STO 设置数值积分，形成鲜明对比。",
            "id": "3821264",
            "problem": "考虑在多尺度材料模拟中使用的局域基组，特别是 $s$ 型高斯型轨道 (GTOs) 和 $s$ 型斯莱特型轨道 (STOs)。一个以位置矢量 $\\mathbf{A} \\in \\mathbb{R}^3$ 为中心的 $s$ 型 GTO 由函数 $\\chi(\\mathbf{r}) = N \\exp\\!\\left(-\\alpha \\lvert \\mathbf{r} - \\mathbf{A}\\rvert^2\\right)$ 定义，其中 $\\alpha > 0$ 是高斯指数， $N$ 是一个归一化因子，其选择需满足 $\\int_{\\mathbb{R}^3} \\lvert \\chi(\\mathbf{r})\\rvert^2 \\, d\\mathbf{r} = 1$。一个以 $\\mathbf{A}$ 为中心的 $s$ 型 STO 由 $\\chi(\\mathbf{r}) = N \\exp\\!\\left(-\\zeta \\lvert \\mathbf{r} - \\mathbf{A}\\rvert\\right)$ 定义，其中 $\\zeta > 0$ 是斯莱特指数， $N$ 的选择需满足 $\\int_{\\mathbb{R}^3} \\lvert \\chi(\\mathbf{r})\\rvert^2 \\, d\\mathbf{r} = 1$。所有量均采用原子单位制，其中距离以玻尔 (bohr) 为单位测量，最终的重叠积分是无量纲的。\n\n从这些定义出发，并且仅使用基本数学运算，推导两个分别以 $\\mathbf{A}$ 和 $\\mathbf{B}$ 为中心、指数为 $\\alpha_a$ 和 $\\alpha_b$ 的归一化 $s$ 型 GTO 之间的重叠积分\n$$\nS_{\\mathrm{GTO}} = \\int_{\\mathbb{R}^3} \\chi_a(\\mathbf{r}) \\, \\chi_b(\\mathbf{r}) \\, d\\mathbf{r}\n$$\n的解析表达式。你的推导必须从给定的定义、归一化条件和诸如配方法等基本原理开始，并且不得使用任何预先推导的快捷公式。\n\n然后，对于 STO 的情况，建立两个分别以 $\\mathbf{A}$ 和 $\\mathbf{B}$ 为中心、指数为 $\\zeta_a$ 和 $\\zeta_b$ 的归一化 $s$ 型 STO 之间的相应重叠积分\n$$\nS_{\\mathrm{STO}} = \\int_{\\mathbb{R}^3} \\chi_a(\\mathbf{r}) \\, \\chi_b(\\mathbf{r}) \\, d\\mathbf{r}\n$$\n。使用一个数学上可靠的数值求积方案来高精度地计算 $S_{\\mathrm{STO}}$。为确保普适性和可复现性，对变量 $u = \\cos\\theta$ 在 $[-1,1]$ 区间上使用高斯-勒让德求积 (Gauss–Legendre quadrature) 执行角度积分，并使用稳健的一维求积方法执行在 $[0,\\infty)$ 上的径向积分。明确说明任何变量替换并证明其收敛性。程序必须对下面的每个测试用例，解析地计算 $S_{\\mathrm{GTO}}$ 和数值地计算 $S_{\\mathrm{STO}}$。\n\n使用以下测试套件，其中 $\\mathbf{A}$ 和 $\\mathbf{B}$ 以玻尔 (bohr) 为单位给出，指数采用适当的原子单位：\n- 测试用例 1 (中心重合，指数相同)：$\\mathbf{A} = [\\,0,0,0\\,]$，$\\mathbf{B} = [\\,0,0,0\\,]$，$\\alpha_a = \\alpha_b = 0.7$，$\\zeta_a = \\zeta_b = 1.3$。\n- 测试用例 2 (中等分离，指数相同)：$\\mathbf{A} = [\\,0,0,0\\,]$，$\\mathbf{B} = [\\,1.0,0,0\\,]$，$\\alpha_a = \\alpha_b = 0.7$，$\\zeta_a = \\zeta_b = 1.3$。\n- 测试用例 3 (大分离，指数相同)：$\\mathbf{A} = [\\,0,0,0\\,]$，$\\mathbf{B} = [\\,5.0,0,0\\,]$，$\\alpha_a = \\alpha_b = 0.7$，$\\zeta_a = \\zeta_b = 1.3$。\n- 测试用例 4 (中等分离，指数不同)：$\\mathbf{A} = [\\,0,0,0\\,]$，$\\mathbf{B} = [\\,1.5,0,0\\,]$，$\\alpha_a = 0.5$，$\\alpha_b = 1.2$，$\\zeta_a = 1.0$，$\\zeta_b = 2.0$。\n\n你的程序必须：\n- 使用你推导出的表达式解析地计算 $S_{\\mathrm{GTO}}$。\n- 使用指定的求积方法数值地计算 $S_{\\mathrm{STO}}$，确保选择的绝对和相对积分容差能够使结果的绝对误差至少达到 $10^{-8}$。\n- 对于每个测试用例，返回数对 $\\left[S_{\\mathrm{GTO}}, S_{\\mathrm{STO}}\\right]$。\n\n最终输出格式：你的程序应生成单行输出，其中包含四个测试用例的结果，形式为一个由四个列表组成的逗号分隔列表。每个内部列表包含两个浮点数，四舍五入到小数点后 $8$ 位，并用方括号括起来，例如 $\\left[ [\\,0.12345678,0.23456789\\,], [\\,\\cdots\\,], [\\,\\cdots\\,], [\\,\\cdots\\,] \\right]$。输出中不出现单位。",
            "solution": "该问题经评估是有效的，因为它具有科学依据、提法恰当、客观，并包含一个完整且一致的设定。它提出了一个来自计算量子化学领域的标准、可验证的问题。我们现在开始解答。\n\n解答分为两部分。首先，我们推导两个 $s$ 型高斯型轨道 (GTOs) 之间重叠积分的解析表达式。其次，我们按照问题的规定，建立斯莱特型轨道 (STOs) 相应重叠积分的表达式以进行数值计算。\n\n### 第 1 部分：$s$ 型 GTO 的解析重叠积分\n\n一个以位置矢量 $\\mathbf{A} \\in \\mathbb{R}^3$ 为中心、指数为 $\\alpha > 0$ 的未归一化 $s$ 型 GTO 由 $\\phi(\\mathbf{r}) = \\exp(-\\alpha |\\mathbf{r} - \\mathbf{A}|^2)$ 给出。归一化轨道为 $\\chi(\\mathbf{r}) = N \\phi(\\mathbf{r})$，其中归一化常数 $N$ 由条件 $\\int_{\\mathbb{R}^3} |\\chi(\\mathbf{r})|^2 \\, d\\mathbf{r} = 1$ 确定。\n\n**1.1. GTO 归一化常数**\n\n归一化积分为：\n$$\n\\int_{\\mathbb{R}^3} N^2 \\exp(-2\\alpha |\\mathbf{r} - \\mathbf{A}|^2) \\, d\\mathbf{r} = 1\n$$\n通过平移坐标系原点，令 $\\mathbf{r}' = \\mathbf{r} - \\mathbf{A}$，上式变为：\n$$\nN^2 \\int_{\\mathbb{R}^3} \\exp(-2\\alpha |\\mathbf{r}'|^2) \\, d\\mathbf{r}' = 1\n$$\n该积分在笛卡尔坐标 $(x', y', z')$ 中是可分离的。使用标准高斯积分公式 $\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$，我们得到：\n$$\n\\int_{\\mathbb{R}^3} e^{-2\\alpha(x'^2+y'^2+z'^2)} dx'dy'dz' = \\left( \\int_{-\\infty}^{\\infty} e^{-2\\alpha u^2} du \\right)^3 = \\left(\\sqrt{\\frac{\\pi}{2\\alpha}}\\right)^3 = \\left(\\frac{\\pi}{2\\alpha}\\right)^{3/2}\n$$\n归一化条件变为 $N^2 (\\frac{\\pi}{2\\alpha})^{3/2} = 1$，这给出了归一化常数：\n$$\nN = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}\n$$\n\n**1.2. GTO 重叠积分推导**\n\n我们旨在计算两个归一化的 $s$ 型 GTO $\\chi_a$ 和 $\\chi_b$ 之间的重叠积分 $S_{\\mathrm{GTO}} = \\int_{\\mathbb{R}^3} \\chi_a(\\mathbf{r}) \\chi_b(\\mathbf{r}) \\, d\\mathbf{r}$，它们分别以 $\\mathbf{A}$ 和 $\\mathbf{B}$ 为中心，指数分别为 $\\alpha_a$ 和 $\\alpha_b$。\n$$\n\\chi_a(\\mathbf{r}) = \\left(\\frac{2\\alpha_a}{\\pi}\\right)^{3/4} \\exp(-\\alpha_a |\\mathbf{r} - \\mathbf{A}|^2) \\\\\n\\chi_b(\\mathbf{r}) = \\left(\\frac{2\\alpha_b}{\\pi}\\right)^{3/4} \\exp(-\\alpha_b |\\mathbf{r} - \\mathbf{B}|^2)\n$$\n重叠积分为：\n$$\nS_{\\mathrm{GTO}} = \\left(\\frac{2\\alpha_a}{\\pi}\\right)^{3/4} \\left(\\frac{2\\alpha_b}{\\pi}\\right)^{3/4} \\int_{\\mathbb{R}^3} \\exp(-\\alpha_a |\\mathbf{r} - \\mathbf{A}|^2 - \\alpha_b |\\mathbf{r} - \\mathbf{B}|^2) \\, d\\mathbf{r}\n$$\n两个高斯函数的乘积是另一个高斯函数，这个性质被称为高斯乘积定理。为了证明这一点，我们通过配方法合并指数中的项。指数为：\n$$\nE = -\\alpha_a (\\mathbf{r}^2 - 2\\mathbf{r}\\cdot\\mathbf{A} + \\mathbf{A}^2) - \\alpha_b (\\mathbf{r}^2 - 2\\mathbf{r}\\cdot\\mathbf{B} + \\mathbf{B}^2) \\\\\n= -(\\alpha_a + \\alpha_b)\\mathbf{r}^2 + 2(\\alpha_a\\mathbf{A} + \\alpha_b\\mathbf{B})\\cdot\\mathbf{r} - (\\alpha_a\\mathbf{A}^2 + \\alpha_b\\mathbf{B}^2)\n$$\n令 $\\alpha_p = \\alpha_a + \\alpha_b$ 并定义一个新中心 $\\mathbf{P} = \\frac{\\alpha_a\\mathbf{A} + \\alpha_b\\mathbf{B}}{\\alpha_p}$。我们可以将指数重写为 $-\\alpha_p|\\mathbf{r} - \\mathbf{P}|^2 + K$ 的形式：\n$$\n-\\alpha_p|\\mathbf{r} - \\mathbf{P}|^2 = -\\alpha_p(\\mathbf{r}^2 - 2\\mathbf{r}\\cdot\\mathbf{P} + \\mathbf{P}^2) = -(\\alpha_a+\\alpha_b)\\mathbf{r}^2 + 2(\\alpha_a\\mathbf{A}+\\alpha_b\\mathbf{B})\\cdot\\mathbf{r} - \\alpha_p\\mathbf{P}^2\n$$\n与 $E$ 的表达式比较，我们看到依赖于 $\\mathbf{r}$ 的项完全匹配。常数项 $K$ 是：\n$$\nK = \\alpha_p\\mathbf{P}^2 - (\\alpha_a\\mathbf{A}^2 + \\alpha_b\\mathbf{B}^2) = \\frac{(\\alpha_a\\mathbf{A} + \\alpha_b\\mathbf{B})^2}{\\alpha_a+\\alpha_b} - (\\alpha_a\\mathbf{A}^2 + \\alpha_b\\mathbf{B}^2)\n$$\n展开并简化该表达式得到：\n$$\nK = -\\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b} (\\mathbf{A}^2 - 2\\mathbf{A}\\cdot\\mathbf{B} + \\mathbf{B}^2) = -\\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b} |\\mathbf{A}-\\mathbf{B}|^2\n$$\n积分变为：\n$$\n\\int_{\\mathbb{R}^3} \\exp(-\\alpha_p |\\mathbf{r} - \\mathbf{P}|^2) \\exp(K) \\, d\\mathbf{r} = \\exp(K) \\int_{\\mathbb{R}^3} \\exp(-\\alpha_p |\\mathbf{r} - \\mathbf{P}|^2) \\, d\\mathbf{r}\n$$\n该积分是一个标准高斯积分，其值为 $(\\pi/\\alpha_p)^{3/2} = (\\pi/(\\alpha_a+\\alpha_b))^{3/2}$。\n合并 $S_{\\mathrm{GTO}}$ 的所有项：\n$$\nS_{\\mathrm{GTO}} = \\left(\\frac{4\\alpha_a\\alpha_b}{\\pi^2}\\right)^{3/4} \\left(\\frac{\\pi}{\\alpha_a+\\alpha_b}\\right)^{3/2} \\exp\\left(-\\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b} |\\mathbf{A}-\\mathbf{B}|^2\\right)\n$$\n简化前置因子：\n$$\n\\left(\\frac{(4\\alpha_a\\alpha_b)^{3/4}}{(\\pi^2)^{3/4}}\\right) \\left(\\frac{\\pi^{3/2}}{(\\alpha_a+\\alpha_b)^{3/2}}\\right) = \\frac{(4\\alpha_a\\alpha_b)^{3/4}}{\\pi^{3/2}} \\frac{\\pi^{3/2}}{(\\alpha_a+\\alpha_b)^{3/2}} = \\left(\\frac{4\\alpha_a\\alpha_b}{(\\alpha_a+\\alpha_b)^2}\\right)^{3/4}\n$$\n重叠积分的最终解析表达式为：\n$$\nS_{\\mathrm{GTO}} = \\left(\\frac{4\\alpha_a\\alpha_b}{(\\alpha_a+\\alpha_b)^2}\\right)^{3/4} \\exp\\left(-\\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b} |\\mathbf{A}-\\mathbf{B}|^2\\right)\n$$\n\n### 第 2 部分：$s$ 型 STO 的数值重叠积分\n\n一个以 $\\mathbf{A}$ 为中心、指数为 $\\zeta > 0$ 的未归一化 $s$ 型 STO 是 $\\phi(\\mathbf{r}) = \\exp(-\\zeta|\\mathbf{r}-\\mathbf{A}|)$。\n\n**2.1. STO 归一化常数**\n\n归一化积分 $\\int_{\\mathbb{R}^3} N^2 \\exp(-2\\zeta |\\mathbf{r} - \\mathbf{A}|) \\, d\\mathbf{r} = 1$ 最好在以 $\\mathbf{A}$ 为中心的球极坐标系中计算。令 $\\mathbf{r}' = \\mathbf{r} - \\mathbf{A}$。\n$$\nN^2 \\int_0^{2\\pi}d\\phi \\int_0^\\pi \\sin\\theta d\\theta \\int_0^\\infty r'^2 e^{-2\\zeta r'} dr' = 1\n$$\n角度积分得到 $4\\pi$。径向积分是一个伽马函数，$\\int_0^\\infty x^n e^{-ax} dx = n!/a^{n+1}$。对于 $n=2$ 和 $a=2\\zeta$，积分为 $2!/(2\\zeta)^3 = 2/(8\\zeta^3) = 1/(4\\zeta^3)$。\n条件变为 $N^2 (4\\pi) (1/(4\\zeta^3)) = N^2 \\pi/\\zeta^3 = 1$，得到归一化常数：\n$$\nN = \\sqrt{\\frac{\\zeta^3}{\\pi}}\n$$\n\n**2.2. STO 重叠积分的数值设置**\n\n两个分别以 $\\mathbf{A}$ 和 $\\mathbf{B}$ 为中心、指数为 $\\zeta_a$ 和 $\\zeta_b$ 的归一化 STO 之间的重叠积分 $S_{\\mathrm{STO}}$ 是：\n$$\nS_{\\mathrm{STO}} = \\frac{\\sqrt{\\zeta_a^3\\zeta_b^3}}{\\pi} \\int_{\\mathbb{R}^3} \\exp(-\\zeta_a |\\mathbf{r}-\\mathbf{A}| - \\zeta_b |\\mathbf{r}-\\mathbf{B}|) \\, d\\mathbf{r}\n$$\n该积分的值在坐标系的刚性平移和旋转下保持不变。我们可以通过将 $\\mathbf{A}$ 置于原点 $(0,0,0)$，将 $\\mathbf{B}$ 置于 $z$ 轴上的 $(0,0,R)$ 来简化设置，其中 $R=|\\mathbf{A}-\\mathbf{B}|$。距离变为 $r_a = |\\mathbf{r}-\\mathbf{A}| = r$ 和 $r_b = |\\mathbf{r}-\\mathbf{B}| = \\sqrt{r^2+R^2-2rR\\cos\\theta}$，其中 $(r, \\theta, \\phi)$ 是 $\\mathbf{r}$ 的球坐标。\n在这些坐标系下，积分为：\n$$\nS_{\\mathrm{STO}} = \\frac{\\sqrt{\\zeta_a^3\\zeta_b^3}}{\\pi} \\int_0^{2\\pi}d\\phi \\int_0^\\pi d\\theta \\int_0^\\infty dr \\left[ r^2 \\sin\\theta \\exp(-\\zeta_a r - \\zeta_b \\sqrt{r^2+R^2-2rR\\cos\\theta}) \\right]\n$$\n被积函数与 $\\phi$ 无关，因此对 $\\phi$ 的积分产生一个因子 $2\\pi$。\n$$\nS_{\\mathrm{STO}} = 2\\sqrt{\\zeta_a^3\\zeta_b^3} \\int_0^\\pi \\sin\\theta \\int_0^\\infty r^2 \\exp(-\\zeta_a r - \\zeta_b \\sqrt{r^2+R^2-2rR\\cos\\theta}) \\, dr \\, d\\theta\n$$\n按照规定，我们对角度积分进行变量替换：$u = \\cos\\theta$，因此 $du = -\\sin\\theta d\\theta$。积分限从 $[\\,0, \\pi\\,]$ 变为 $[\\,1, -1\\,]$，这等价于从 $-1$ 积分到 $1$。\n$$\nS_{\\mathrm{STO}} = 2\\sqrt{\\zeta_a^3\\zeta_b^3} \\int_{-1}^{1} \\left( \\int_0^{\\infty} r^2 \\exp(-\\zeta_a r - \\zeta_b \\sqrt{r^2+R^2-2rRu}) \\, dr \\right) du\n$$\n这个二维积分通过数值方法求解。对 $u \\in [-1,1]$ 的外部积分使用高斯-勒让德求积 (Gauss-Legendre quadrature) 进行近似：\n$$\n\\int_{-1}^{1} f(u) du \\approx \\sum_{i=1}^{N_u} w_i f(u_i)\n$$\n其中 $u_i$ 和 $w_i$ 是求积节点和权重。内部函数 $f(u_i)$ 对应于一维径向积分：\n$$\nf(u_i) = \\int_0^{\\infty} r^2 \\exp(-\\zeta_a r - \\zeta_b \\sqrt{r^2+R^2-2rRu_i}) \\, dr\n$$\n这个在半无限域 $[0, \\infty)$ 上的积分使用稳健的自适应求积程序（例如 `scipy.integrate.quad`）进行计算。\n\n这种数值方案的收敛性是有充分根据的。对于任何固定的 $r > 0$，被积函数在 $[-1, 1]$ 上是 $u$ 的一个非常光滑的函数，这确保了高斯-勒让德求积随着点数 $N_u$ 的增加而快速收敛。对于径向积分，被积函数在 $r \\to \\infty$ 时呈指数衰减，确保了积分是有限的，并且可以由为这类问题设计的自适应求积算法轻松处理。通过选择足够大的 $N_u$ 并为内部求积设置适当小的容差参数，可以达到 $10^{-8}$ 的所需精度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Main function to compute and print GTO and STO overlap integrals for given test cases.\n    \"\"\"\n    \n    # Test cases defined in the problem statement\n    # Format: (A, B, alpha_a, alpha_b, zeta_a, zeta_b)\n    test_cases = [\n        ([0.0, 0.0, 0.0], [0.0, 0.0, 0.0], 0.7, 0.7, 1.3, 1.3),\n        ([0.0, 0.0, 0.0], [1.0, 0.0, 0.0], 0.7, 0.7, 1.3, 1.3),\n        ([0.0, 0.0, 0.0], [5.0, 0.0, 0.0], 0.7, 0.7, 1.3, 1.3),\n        ([0.0, 0.0, 0.0], [1.5, 0.0, 0.0], 0.5, 1.2, 1.0, 2.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        A_vec, B_vec, alpha_a, alpha_b, zeta_a, zeta_b = case\n        A, B = np.array(A_vec), np.array(B_vec)\n\n        s_gto = compute_gto_overlap(alpha_a, alpha_b, A, B)\n        s_sto = compute_sto_overlap(zeta_a, zeta_b, A, B)\n\n        results.append([s_gto, s_sto])\n\n    # Format the final output string as specified\n    inner_parts = []\n    for r_gto, r_sto in results:\n        inner_parts.append(f\"[{r_gto:.8f}, {r_sto:.8f}]\")\n    output_string = \"[\" + \", \".join(inner_parts) + \"]\"\n    print(output_string)\n\n\ndef compute_gto_overlap(alpha_a: float, alpha_b: float, A: np.ndarray, B: np.ndarray) -> float:\n    \"\"\"\n    Computes the overlap integral between two s-type GTOs analytically.\n    \n    Args:\n        alpha_a: Exponent of GTO at center A.\n        alpha_b: Exponent of GTO at center B.\n        A: Position vector of center A.\n        B: Position vector of center B.\n\n    Returns:\n        The value of the overlap integral S_GTO.\n    \"\"\"\n    R_sq = np.sum((A - B)**2)\n    alpha_p = alpha_a + alpha_b\n    \n    prefactor_term = (4 * alpha_a * alpha_b) / (alpha_p**2)\n    prefactor = prefactor_term**(3.0 / 4.0)\n    \n    exponent_term = (alpha_a * alpha_b) / alpha_p\n    exponent = np.exp(-exponent_term * R_sq)\n    \n    return prefactor * exponent\n\n\ndef compute_sto_overlap(zeta_a: float, zeta_b: float, A: np.ndarray, B: np.ndarray) -> float:\n    \"\"\"\n    Computes the overlap integral between two s-type STOs numerically.\n    \n    The numerical integration is done using Gauss-Legendre quadrature for the\n    angular part and scipy.integrate.quad for the radial part.\n\n    Args:\n        zeta_a: Exponent of STO at center A.\n        zeta_b: Exponent of STO at center B.\n        A: Position vector of center A.\n        B: Position vector of center B.\n\n    Returns:\n        The value of the overlap integral S_STO.\n    \"\"\"\n    R = np.linalg.norm(A - B)\n\n    # Coincident centers case: use analytical formula for speed and stability\n    if np.isclose(R, 0.0):\n        if np.isclose(zeta_a, zeta_b):\n            return 1.0\n        return 8.0 * ((zeta_a * zeta_b)**0.5 / (zeta_a + zeta_b))**3.0\n\n    # Numerical integration for separated centers\n    prefactor = 2.0 * (zeta_a**3 * zeta_b**3)**0.5\n\n    # Number of points for Gauss-Legendre quadrature.\n    # 64 points is sufficient for high accuracy for these smooth integrands.\n    N_u = 64\n    u_nodes, u_weights = roots_legendre(N_u)\n\n    # Integration tolerances for the inner radial integral\n    quad_epsabs = 1e-12\n    quad_epsrel = 1e-12\n\n    angular_integral_sum = 0.0\n    for i in range(N_u):\n        u = u_nodes[i]\n        w = u_weights[i]\n\n        # Define the radial integrand for the current angular node u\n        def radial_integrand(r):\n            sqrt_arg = r**2 + R**2 - 2 * r * R * u\n            # The argument to sqrt is always non-negative for r>=0, u in [-1,1]\n            # It is (r-R)^2 at u=1 and (r+R)^2 at u=-1.\n            r_b = np.sqrt(sqrt_arg)\n            return r**2 * np.exp(-zeta_a * r - zeta_b * r_b)\n\n        # Compute the radial integral for this u\n        radial_integral_val, _ = integrate.quad(\n            radial_integrand, 0, np.inf, \n            epsabs=quad_epsabs, epsrel=quad_epsrel\n        )\n        \n        angular_integral_sum += w * radial_integral_val\n\n    return prefactor * angular_integral_sum\n\n# Execute the solution\nsolve()\n\n```"
        },
        {
            "introduction": "鉴于 GTO 在计算上的便捷性，一种常见的策略是用它们来近似拟合物理意义更明确的 STO。本练习将模拟这一过程，要求你构建一个 STO-nG 型基组，并用它来计算一个与材料内聚能相关的物理量 。这项实践的核心目标是让你掌握如何系统地测试基组收敛性，这是确保任何实际模拟结果可靠性的关键步骤。",
            "id": "3821281",
            "problem": "您的任务是为一个材料性质实现一个严谨的收敛性测试。该性质是使用高斯型轨道（GTO）作为斯莱特型轨道（STO）的近似，从定域基组计算得出的，这是多尺度材料模拟中的一种常用策略。需要监测的性质是一个源于原子轨道线性组合（LCAO）紧束缚论证的内聚能近似指标。您必须为目标斯莱特型轨道构建一个由 $N$ 项 GTO 展开组成的序列，并计算当 $N$ 增加时，所得到的内聚能近似指标如何变化。目标是确定在哪个最小的基组尺寸下，连续基组尺寸之间的性质变化小于指定的阈值。\n\n请使用以下基本依据和经过充分检验的事实：\n- 一个类 $1s$ 原子轨道的斯莱特型轨道（STO）定义为 $\\phi_{\\mathrm{STO}}(\\mathbf{r}) = \\left(\\dfrac{\\zeta^{3}}{\\pi}\\right)^{1/2} e^{-\\zeta r}$，其中 $r = \\|\\mathbf{r}\\|$，$ \\zeta$ 是 Slater 指数，且 $\\phi_{\\mathrm{STO}}$ 在三维空间中已归一化。\n- 一个以原子核为中心的高斯型轨道（GTO）$s$ 型基函数是 $g_{\\alpha}(\\mathbf{r}) = N(\\alpha)\\, e^{-\\alpha r^{2}}$，其中 $N(\\alpha)$ 是归一化因子，且 $g_{\\alpha}$ 作为三维空间中的函数已归一化。\n- 在原子轨道线性组合（LCAO）紧束缚模型中，每个原子的内聚能与带宽成比例，而带宽又与最近邻跳跃振幅成比例。在标准近似下，跳跃振幅与最近邻轨道重叠成正比。因此，我们使用一个与相邻位置上轨道间的最近邻重叠成正比的内聚能近似指标。\n\n定义以下数学对象和运算：\n- 目标 STO 的一个 $N$ 项 GTO 近似为 $\\phi_{N}(\\mathbf{r}) = \\sum_{i=1}^{N} c_{i}\\, g_{\\alpha_{i}}(\\mathbf{r})$，其中指数 $\\{\\alpha_{i}\\}_{i=1}^{N}$ 是在一个取决于 $\\zeta$ 的物理合理范围内按等比数列选择的，而系数 $\\{c_{i}\\}_{i=1}^{N}$ 是通过最小化平方误差 $\\int_{\\mathbb{R}^{3}} \\left|\\phi_{\\mathrm{STO}}(\\mathbf{r}) - \\phi_{N}(\\mathbf{r})\\right|^{2}\\, d^{3}\\mathbf{r}$ 来确定的，这简化为求解基于内积的正规方程。解出 $\\{c_{i}\\}$ 后，对 $\\phi_{N}$ 进行归一化，使得 $\\int_{\\mathbb{R}^{3}} \\left|\\phi_{N}(\\mathbf{r})\\right|^{2}\\, d^{3}\\mathbf{r} = 1$。\n- 将两个相同的原子沿一个轴放置，相隔距离 $R$。设 $\\phi_{N}^{A}(\\mathbf{r})$ 以原点为中心，$\\phi_{N}^{B}(\\mathbf{r})$ 是以距离 $R$ 处为中心的相同轨道；那么最近邻重叠为 $S_{N}(R) = \\int_{\\mathbb{R}^{3}} \\phi_{N}^{A}(\\mathbf{r})\\, \\phi_{N}^{B}(\\mathbf{r})\\, d^{3}\\mathbf{r}$。对于 GTO，这些积分可以通过已知的高斯乘积公式精确计算，或通过收敛的数值积分进行数值计算。\n- 定义内聚能近似指标为 $E_{\\mathrm{coh}}^{(N)} = C\\, z\\, S_{N}(R)$，其中 $C$ 是一个以电子伏特 $\\left(\\mathrm{eV}\\right)$ 为单位的正能量尺度，$z$ 是配位数（一个表示最近邻数量的整数），$R$ 是最近邻距离。该近似指标的动机是观察到内聚能与带宽成比例，而带宽又与跳跃振幅成比例，因此与重叠成比例。\n\n您的程序必须：\n- 对于每个测试用例，为 $N$ 从 $N_{\\min}$ 到 $N_{\\max}$ 构建一个 $N$ 项 GTO 展开序列，其指数 $\\alpha_{i}$ 在几何级数 $\\alpha_{i} \\in [\\alpha_{\\min}, \\alpha_{\\max}]$ 中选择，其中 $\\alpha_{\\min} = 0.3\\, \\zeta^{2}$ 且 $\\alpha_{\\max} = 8\\, \\zeta^{2}$。通过三维 $L^{2}$ 意义下的最小二乘法确定系数，然后重新归一化得到的展开式。\n- 对序列中的每个 $N$，使用两个相距 $R$ 的位置上的轨道之间的重叠来计算 $E_{\\mathrm{coh}}^{(N)}$（单位为 $\\mathrm{eV}$）。\n- 确定最小整数 $N^{\\ast}$，使得 $N^{\\ast} > N_{\\min}$ 且 $\\left|E_{\\mathrm{coh}}^{(N^{\\ast})} - E_{\\mathrm{coh}}^{(N^{\\ast}-1)}\\right|  \\tau$，其中 $\\tau$ 是以 $\\mathrm{eV}$ 为单位的目标阈值。如果在 $[N_{\\min}, N_{\\max}]$ 内不存在这样的 $N^{\\ast}$，则该测试用例返回 $-1$。\n\n重要的单位约定和数值要求：\n- 距离 $R$ 以埃（ångströms）为单位提供，必须转换为玻尔半径（Bohr radii）以进行积分；使用 $1\\,\\mathrm{Bohr} = 0.529177\\,\\mathrm{\\AA}$。\n- 能量必须以电子伏特 $\\left(\\mathrm{eV}\\right)$ 计算和比较。\n- 不涉及角度；不需要角度单位。\n\n测试套件：\n使用以下四个测试用例，每个用例指定为元组 $\\left(\\zeta, R_{\\mathrm{\\AA}}, z, C, \\tau, N_{\\min}, N_{\\max}\\right)$，其中 $\\zeta$ 的单位是逆玻尔半径，$R_{\\mathrm{\\AA}}$ 的单位是埃，$z$ 是整数，$C$ 和 $\\tau$ 的单位是 $\\mathrm{eV}$，$N_{\\min}, N_{\\max}$ 是整数。\n- 用例 1: $\\left(1.2, 2.5, 12, 0.8, 10^{-3}, 1, 8\\right)$\n- 用例 2: $\\left(3.0, 1.8, 6, 1.5, 5\\times 10^{-4}, 1, 10\\right)$\n- 用例 3: $\\left(0.8, 3.2, 8, 1.2, 10^{-5}, 1, 12\\right)$\n- 用例 4: $\\left(2.5, 2.0, 4, 1.0, 5\\times 10^{-2}, 1, 6\\right)$\n\n最终输出格式规范：\n- 您的程序应生成单行输出，包含对应于四个测试用例的四个整数结果 $\\left[N_{1}^{\\ast}, N_{2}^{\\ast}, N_{3}^{\\ast}, N_{4}^{\\ast}\\right]$，格式为用方括号括起来的逗号分隔列表，例如 $\\left[2,4,-1,3\\right]$。",
            "solution": "该问题要求实现一个内聚能近似指标的收敛性测试。该指标是使用一系列越来越大的高斯型轨道（GTO）基组来计算的，这些基组近似于一个目标斯莱特型轨道（STO）。任务的核心是找到最小的基组尺寸 $N^{\\ast}$，使得内聚能的变化量低于给定的阈值 $\\tau$。\n\n最基本的出发点是类 $1s$ 的斯莱特型轨道，定义为 $\\phi_{\\mathrm{STO}}(\\mathbf{r}) = \\left(\\frac{\\zeta^{3}}{\\pi}\\right)^{1/2} e^{-\\zeta r}$，其中 $\\zeta$ 是 Slater 指数，$r = \\|\\mathbf{r}\\|$。此函数已归一化，使得 $\\int_{\\mathbb{R}^3} |\\phi_{\\mathrm{STO}}(\\mathbf{r})|^2 d^3\\mathbf{r} = 1$。每个 STO 由 $N$ 个原始 $s$ 型 GTO 的线性组合来近似，即 $\\phi_{N}(\\mathbf{r}) = \\sum_{i=1}^{N} c_{i} g_{\\alpha_{i}}(\\mathbf{r})$。一个原始 GTO 由 $g_{\\alpha}(\\mathbf{r}) = N(\\alpha)\\, e^{-\\alpha r^{2}}$ 给出，其中归一化常数 $N(\\alpha) = (2\\alpha/\\pi)^{3/4}$ 确保 $\\int_{\\mathbb{R}^3} |g_{\\alpha}(\\mathbf{r})|^2 d^3\\mathbf{r} = 1$。\n\nGTO 基组的指数 $\\{\\alpha_i\\}_{i=1}^N$ 是从一个跨越区间 $[\\alpha_{\\min}, \\alpha_{\\max}]$ 的等比数列中选择的，其中 $\\alpha_{\\min} = 0.3\\,\\zeta^2$ 且 $\\alpha_{\\max} = 8\\,\\zeta^2$。对于 $N1$，指数由 $\\alpha_i = \\alpha_{\\min} \\cdot (\\alpha_{\\max}/\\alpha_{\\min})^{(i-1)/(N-1)}$ 给出。对于 $N=1$ 的特殊情况，使用单个指数 $\\alpha_1 = \\sqrt{\\alpha_{\\min}\\alpha_{\\max}}$，它代表了边界的几何平均值。\n\n系数 $\\{c_i\\}_{i=1}^N$ 是通过最小化 STO 与其 GTO 展开之间的均方误差来确定的，$\\epsilon^2 = \\int_{\\mathbb{R}^3} |\\phi_{\\mathrm{STO}}(\\mathbf{r}) - \\phi_{N}(\\mathbf{r})|^2 d^3\\mathbf{r}$。将所有 $k=1, \\dots, N$ 的偏导数 $\\partial \\epsilon^2 / \\partial c_k$ 设为零，得到一个称为正规方程的线性方程组：\n$$ \\sum_{i=1}^{N} c_i \\int_{\\mathbb{R}^3} g_{\\alpha_k}(\\mathbf{r}) g_{\\alpha_i}(\\mathbf{r}) d^3\\mathbf{r} = \\int_{\\mathbb{R}^3} g_{\\alpha_k}(\\mathbf{r}) \\phi_{\\mathrm{STO}}(\\mathbf{r}) d^3\\mathbf{r} $$\n这可以写成矩阵形式 $\\mathbf{S}\\mathbf{c} = \\mathbf{b}$，其中：\n1.  $\\mathbf{S}$ 是 GTO 基函数的 $N \\times N$ 格拉姆矩阵，其元素为 $S_{ki} = \\langle g_k | g_i \\rangle$。这是 GTO 的重叠矩阵。两个同心的、归一化的、指数为 $\\alpha_k$ 和 $\\alpha_i$ 的 $s$ 型 GTO 的重叠解析表达式为 $S_{ki} = \\left(\\frac{4\\alpha_k\\alpha_i}{(\\alpha_k+\\alpha_i)^2}\\right)^{3/4}$。\n2.  $\\mathbf{b}$ 是一个 $N$ 维向量，其元素为 $b_k = \\langle g_k | \\phi_{\\mathrm{STO}} \\rangle$。这是一个 GTO 基函数与目标 STO 之间的重叠。这个积分 $b_k = \\int_0^\\infty 4\\pi r^2 g_{\\alpha_k}(r) \\phi_{\\mathrm{STO}}(r) dr$ 没有简单的封闭形式表达式，将按照问题陈述的允许，使用高精度数值积分来计算。\n3.  $\\mathbf{c}$ 是待求解的系数向量，$\\mathbf{c} = \\mathbf{S}^{-1}\\mathbf{b}$。\n\n得到的展开式 $\\phi'_N(\\mathbf{r}) = \\sum_i c_i g_{\\alpha_i}(\\mathbf{r})$ 不保证是归一化的。我们必须将其重新归一化以获得 $\\phi_N(\\mathbf{r})$。其范数的平方是 $\\langle \\phi'_N | \\phi'_N \\rangle = \\sum_{i,j} c_i c_j \\langle g_i | g_j \\rangle = \\mathbf{c}^T \\mathbf{S} \\mathbf{c}$。归一化常数为 $K = (\\mathbf{c}^T \\mathbf{S} \\mathbf{c})^{-1/2}$，最终的归一化系数为 $d_i = K c_i$。\n\n内聚能的近似指标 $E_{\\mathrm{coh}}^{(N)}$ 定义为与两个相同的归一化轨道 $\\phi_N^A$ 和 $\\phi_N^B$ 之间的重叠积分 $S_N(R)$ 成正比，这两个轨道位于相距为 $R$ 的相邻原子位点上。\n$$ S_N(R) = \\int_{\\mathbb{R}^3} \\phi_N^A(\\mathbf{r}) \\phi_N^B(\\mathbf{r}) d^3\\mathbf{r} = \\sum_{i=1}^N \\sum_{j=1}^N d_i d_j \\int_{\\mathbb{R}^3} g_{\\alpha_i}^A(\\mathbf{r}) g_{\\alpha_j}^B(\\mathbf{r}) d^3\\mathbf{r} $$\n两个位移的 GTO 的乘积积分可以使用高斯乘积定理进行解析计算。两个相距为 $R$、指数分别为 $\\alpha_i$ 和 $\\alpha_j$ 的归一化 $s$ 型 GTO 的重叠是 $S_{ij}^{AB}(R) = S_{ij} \\exp\\left(-\\frac{\\alpha_i \\alpha_j}{\\alpha_i+\\alpha_j}R^2\\right)$，其中 $S_{ij}$ 是单中心重叠。总重叠则是 $S_N(R) = \\sum_{i,j} d_i d_j S_{ij}^{AB}(R)$。\n\n然后，内聚能近似指标为 $E_{\\mathrm{coh}}^{(N)} = C z S_N(R)$，其中 $C$ 是以电子伏特（$\\mathrm{eV}$）为单位的能量尺度，$z$ 是配位数，$R$ 是最近邻距离。输入的以埃为单位的距离 $R_{\\mathrm{\\AA}}$ 必须使用给定的转换因子 $1\\,\\mathrm{Bohr} = 0.529177\\,\\mathrm{\\AA}$ 转换为玻尔半径。\n\n对每个测试用例，总算法如下：\n1.  初始化一个空列表，用于存储每个基组尺寸 $N$ 计算出的能量。\n2.  从 $N_{\\min}$ 到 $N_{\\max}$ 迭代 $N$。在每次迭代中，执行上述步骤计算 $E_{\\mathrm{coh}}^{(N)}$。\n3.  对于每个 $N > N_{\\min}$，检查收敛标准：$\\left|E_{\\mathrm{coh}}^{(N)} - E_{\\mathrm{coh}}^{(N-1)}\\right|  \\tau$。\n4.  如果满足标准，则满足条件的最小整数 $N$ 即为答案 $N^{\\ast}$。该测试用例的搜索终止。\n5.  如果循环完成而未满足标准，则该用例的答案为 $-1$。\n所有测试用例的结果被收集并格式化为指定的输出字符串。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\nBOHR_IN_A = 0.529177\n\ndef _compute_proxy_cohesive_energy(params, N):\n    \"\"\"\n    Computes the proxy cohesive energy for a given basis size N and parameter set.\n    \"\"\"\n    zeta, R_A, z, C, _, _, _ = params\n    R_bohr = R_A / BOHR_IN_A\n\n    # Step 1: Construct GTO basis exponents\n    alpha_min = 0.3 * zeta**2\n    alpha_max = 8.0 * zeta**2\n    if N == 1:\n        alphas = np.array([np.sqrt(alpha_min * alpha_max)])\n    else:\n        alphas = np.geomspace(alpha_min, alpha_max, num=N)\n\n    # Step 2: Solve the normal equations (Sc = b)\n    # 2a. GTO-GTO overlap matrix S (Gram matrix)\n    S_matrix = np.zeros((N, N))\n    for i in range(N):\n        for j in range(i, N):\n            ai, aj = alphas[i], alphas[j]\n            val = (4 * ai * aj / (ai + aj)**2)**(3/4)\n            S_matrix[i, j] = val\n            S_matrix[j, i] = val\n\n    # 2b. STO-GTO overlap vector b\n    b_vector = np.zeros(N)\n    sto_norm = (zeta**3 / np.pi)**0.5\n    for i in range(N):\n        alpha_i = alphas[i]\n        gto_norm = (2 * alpha_i / np.pi)**(0.75)\n        \n        # Integrand for numerical quadrature: 4*pi*r^2 * phi_STO(r) * g_GTO(r)\n        def integrand(r):\n            return (4 * np.pi * r**2 * \n                    (sto_norm * np.exp(-zeta * r)) * \n                    (gto_norm * np.exp(-alpha_i * r**2)))\n            \n        b_vector[i], _ = quad(integrand, 0, np.inf)\n\n    # 2c. Solve for coefficients c\n    try:\n        c_coeffs = np.linalg.solve(S_matrix, b_vector)\n    except np.linalg.LinAlgError:\n        # This should not occur as S is positive definite, but is good practice.\n        return np.nan \n\n    # Step 3: Renormalize the LCAO coefficients\n    norm_sq = c_coeffs.T @ S_matrix @ c_coeffs\n    if norm_sq == 0: return np.nan\n    d_coeffs = c_coeffs / np.sqrt(norm_sq)\n\n    # Step 4: Compute the total two-center overlap S_N(R)\n    total_overlap_S_N_R = 0.0\n    for i in range(N):\n        for j in range(N):\n            ai, aj = alphas[i], alphas[j]\n            # Two-center overlap integral for s-type GTOs\n            exp_term = np.exp(- (ai * aj) / (ai + aj) * R_bohr**2)\n            two_center_overlap = S_matrix[i, j] * exp_term\n            total_overlap_S_N_R += d_coeffs[i] * d_coeffs[j] * two_center_overlap\n    \n    # Step 5: Compute the proxy cohesive energy\n    E_coh = C * z * total_overlap_S_N_R\n    return E_coh\n\ndef solve():\n    \"\"\"\n    Main solver function to run the convergence test for all provided cases.\n    \"\"\"\n    test_cases = [\n        # (zeta, R_Å, z, C, tau, N_min, N_max)\n        (1.2, 2.5, 12, 0.8, 1e-3, 1, 8),\n        (3.0, 1.8, 6, 1.5, 5e-4, 1, 10),\n        (0.8, 3.2, 8, 1.2, 1e-5, 1, 12),\n        (2.5, 2.0, 4, 1.0, 5e-2, 1, 6),\n    ]\n\n    results = []\n    for case in test_cases:\n        _, _, _, _, tau, N_min, N_max = case\n        \n        E_coh_prev = None\n        found_N_star = -1\n        \n        for N in range(N_min, N_max + 1):\n            E_coh_current = _compute_proxy_cohesive_energy(case, N)\n            \n            # The convergence check starts from N = N_min + 1\n            if N > N_min:\n                if E_coh_prev is None: # Should not happen if N > N_min\n                     break\n                diff = np.abs(E_coh_current - E_coh_prev)\n                if diff  tau:\n                    found_N_star = N\n                    break\n            \n            E_coh_prev = E_coh_current\n            \n        results.append(found_N_star)\n        \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "使用有限基组是量子化学计算中不可避免的近似，这会引入所谓的基组不完备性误差。本练习旨在教授一种强大的技术来减小此误差 。通过使用一系列系统性的基组（例如相关一致性基组）进行计算，我们可以将结果外推至完备基组（CBS）极限，从而获得比任何单次有限基组计算都更精确的预测值。",
            "id": "3821347",
            "problem": "在多尺度材料模拟中，定域基组通常由高斯型轨道 (GTOs) 和斯莱特型轨道 (STOs) 构建。相关一致极化价X-zeta (cc-pVXZ) GTO族旨在系统地恢复波函数中缺失的角动量分量。对于许多分子体系，使用cc-pVXZ GTOs计算时，相关能中的基组不完备性误差在经验上和理论上都可以很好地由一个渐近形式描述，该形式随基数 $X$ 按 $X^{-3}$ 标度变化。这与高角动量贡献的缺失以及高斯函数无法精确捕捉电子-电子尖点条件相一致。将完全基组 (CBS) 极限能量定义为 $E_{\\text{CBS}}$。\n\n您已使用cc-pVXZ GTOs计算了多尺度模型中一个定域量子区域的总电子能量：\n- cc-pVTZ ($X=3$) 的能量 $E(3)$：$-76.384512$ Hartree，\n- cc-pVQZ ($X=4$) 的能量 $E(4)$：$-76.389012$ Hartree。\n\n假设GTO收敛的双点渐近形式成立：\n$$E(X) = E_{\\text{CBS}} + A X^{-3},$$\n其中 $A$ 是一个依赖于体系的常数，$X \\in \\{3,4\\}$ 是cc-pVXZ的基数。\n\n从基组不完备性和GTOs的 $X^{-3}$ 渐近收敛概念出发，并且在不使用所述收敛模型之外任何捷径公式的情况下，完成以下任务：\n1. 通过消去 $A$，推导出用 $E(3)$ 和 $E(4)$ 表示 $E_{\\text{CBS}}$ 的显式代数表达式。\n2. 使用给定的 $E(3)$ 和 $E(4)$ 数值计算 $E_{\\text{CBS}}$。\n3. 简要评估该模型所隐含的 $X=4$ 时的残余基组误差，并从第一性原理的层面讨论，与GTOs相比，斯莱特型轨道 (STOs) 中物理存在的电子-原子核尖点可能会如何改变其渐近收敛行为。\n\n将您最终报告的 $E_{\\text{CBS}}$ 值四舍五入到六位有效数字。最终能量以Hartree为单位表示。",
            "solution": "问题陈述已经过验证，被认为是科学上可靠、定义明确且客观的。它提供了一个清晰的理论模型和足够的数据来执行所要求的任务，这些任务是计算量子化学领域的核心。该问题有效。\n\n按要求，解答分为三个部分。\n\n### 第1部分：$E_{\\text{CBS}}$ 表达式的推导\n\n问题假设，用基数为 $X$ 的相关一致基组计算的总电子能量 $E(X)$ 服从以下渐近关系：\n$$E(X) = E_{\\text{CBS}} + A X^{-3}$$\n其中 $E_{\\text{CBS}}$ 是完全基组极限下的能量，$A$ 是一个依赖于体系的常数。我们有两个给定的数据点，分别对应于 $X=3$ (cc-pVTZ) 和 $X=4$ (cc-pVQZ)。我们可以根据该模型写出两个联立方程：\n$$E(3) = E_{\\text{CBS}} + A (3)^{-3} \\quad \\quad (1)$$\n$$E(4) = E_{\\text{CBS}} + A (4)^{-3} \\quad \\quad (2)$$\n我们的目标是通过消去常数 $A$ 来求解这个关于未知数 $E_{\\text{CBS}}$ 的二元线性方程组。\n\n从方程 (1) 中，我们可以用 $E(3)$ 和 $E_{\\text{CBS}}$ 表示 $A$：\n$$A (3)^{-3} = E(3) - E_{\\text{CBS}}$$\n$$A = 3^3 (E(3) - E_{\\text{CBS}}) = 27 (E(3) - E_{\\text{CBS}})$$\n现在，我们将这个 $A$ 的表达式代入方程 (2)：\n$$E(4) = E_{\\text{CBS}} + [27 (E(3) - E_{\\text{CBS}})] (4)^{-3}$$\n$$E(4) = E_{\\text{CBS}} + \\frac{27}{4^3} (E(3) - E_{\\text{CBS}})$$\n$$E(4) = E_{\\text{CBS}} + \\frac{27}{64} (E(3) - E_{\\text{CBS}})$$\n我们现在整理方程以解出 $E_{\\text{CBS}}$。\n$$E(4) = E_{\\text{CBS}} + \\frac{27}{64} E(3) - \\frac{27}{64} E_{\\text{CBS}}$$\n$$E(4) - \\frac{27}{64} E(3) = E_{\\text{CBS}} - \\frac{27}{64} E_{\\text{CBS}}$$\n$$E(4) - \\frac{27}{64} E(3) = E_{\\text{CBS}} \\left(1 - \\frac{27}{64}\\right)$$\n括号中的项化简为：\n$$1 - \\frac{27}{64} = \\frac{64}{64} - \\frac{27}{64} = \\frac{37}{64}$$\n将此结果代回方程得到：\n$$E(4) - \\frac{27}{64} E(3) = E_{\\text{CBS}} \\left(\\frac{37}{64}\\right)$$\n为了解出 $E_{\\text{CBS}}$，我们将两边同乘以 $\\frac{64}{37}$：\n$$E_{\\text{CBS}} = \\frac{64}{37} \\left(E(4) - \\frac{27}{64} E(3)\\right)$$\n将因子 $\\frac{64}{37}$ 分配进去：\n$$E_{\\text{CBS}} = \\frac{64 E(4) - 27 E(3)}{37}$$\n这就是用 $E(3)$ 和 $E(4)$ 表示 $E_{\\text{CBS}}$ 的显式代数表达式。\n\n### 第2部分：$E_{\\text{CBS}}$ 的数值计算\n\n我们有以下以Hartree为单位的数值：\n- $E(3) = -76.384512$\n- $E(4) = -76.389012$\n\n将这些值代入推导出的 $E_{\\text{CBS}}$ 表达式中：\n$$E_{\\text{CBS}} = \\frac{64(-76.389012) - 27(-76.384512)}{37}$$\n首先，我们计算分子中的乘积：\n$$64 \\times (-76.389012) = -4888.896768$$\n$$27 \\times (-76.384512) = -2062.381824$$\n现在，将这些结果代回表达式中：\n$$E_{\\text{CBS}} = \\frac{-4888.896768 - (-2062.381824)}{37}$$\n$$E_{\\text{CBS}} = \\frac{-4888.896768 + 2062.381824}{37}$$\n$$E_{\\text{CBS}} = \\frac{-2826.514944}{37}$$\n进行除法运算得到未四舍五入的值：\n$$E_{\\text{CBS}} \\approx -76.3922957837... \\text{ Hartree}$$\n问题要求将最终值四舍五入到六位有效数字。前六位有效数字是 $7$、$6$、$3$、$9$、$2$、$2$。第七位数字是 $9$，大于或等于 $5$，所以我们将第六位数字向上取整。\n$$E_{\\text{CBS}} \\approx -76.3923 \\text{ Hartree}$$\n\n### 第3部分：残余误差及STO与GTO的收敛性对比\n\n在 $X=4$ 时的残余基组误差是计算得到的能量 $E(4)$ 与外推的完全基组极限能量 $E_{\\text{CBS}}$ 之间的差值。为了获得更高的精度，我们使用未四舍五入的 $E_{\\text{CBS}}$ 值：\n$$\\text{Error}(X=4) = E(4) - E_{\\text{CBS}}$$\n$$\\text{Error}(X=4) = -76.389012 - (-76.39229578...) \\approx 0.00328378 \\text{ Hartree}$$\n这个正值表明，使用cc-pVQZ基组计算的能量高于CBS极限，这与变分原理的预期相符。\n\n关于斯莱特型轨道 (STOs) 与高斯型轨道 (GTOs) 的讨论，其核心在于它们模拟电子波函数的能力，尤其是在原子核位置和电子-电子汇合点处。\n\n一个GTO的径向形式为 $\\exp(-\\alpha r^2)$，它在原子核处 ($r=0$) 的导数为零。这种函数形式在数学上不能正确描述电子-原子核尖点，根据Kato尖点条件，精确波函数在该点应具有非零导数，即 $\\frac{1}{\\psi}\\frac{\\partial\\psi}{\\partial r}|_{r=0} = -Z$，其中 $Z$ 是核电荷。未能描述此尖点是能量计算中单电子 (Hartree-Fock) 部分基组不完备性误差的主要来源。\n\n一个STO的径向形式为 $\\exp(-\\zeta r)$，它在原子核处正确地具有非零导数，因此能更好地从物理上描述电子-原子核尖点。因此，与同等大小的GTO基组相比，使用STO基组时，Hartree-Fock能量的收敛速度要快得多。\n\n相关一致基组的渐近收敛行为 $E(X) \\approx E_{\\text{CBS}} + A X^{-3}$ 主要由*相关能*的缓慢收敛决定。这种缓慢收敛源于描述电子-电子尖点的困难，该尖点在两个电子相互靠近时 ($r_{12} \\to 0$) 出现。无论是GTOs还是STOs，作为单电子函数，都无法精确表示描述电子-电子尖点所需的多变量依赖关系。$X^{-3}$ 的标度行为源于相关能的分波展开，这是一个在很大程度上独立于单电子基函数具体函数形式（GTO或STO）的数学特性。\n\n因此，STO中存在的物理电子-原子核尖点会通过以下方式改变渐近收敛行为：\n1.  总能量中单电子 (Hartree-Fock) 分量的误差会显著减小，并且使用STOs时收敛得更快。\n2.  即使对于较小的基数 $X$，总能量误差 $E(X) - E_{\\text{CBS}}$ 也将几乎完全由相关能误差主导。\n3.  因此，与GTOs相比（其收敛被收敛更慢的Hartree-Fock误差分量所“污染”），当使用STOs时，用于*总能量*的渐近 $X^{-3}$ 公式对于更小的 $X$ 值会变得更加准确。\n\n总而言之，虽然相关能的基本 $X^{-3}$ 幂律预计不会改变，但使用STOs会使总能量更紧密地遵循这种渐近形式，从而可以从更小的基组进行更可靠的外推。",
            "answer": "$$\\boxed{-76.3923}$$"
        }
    ]
}