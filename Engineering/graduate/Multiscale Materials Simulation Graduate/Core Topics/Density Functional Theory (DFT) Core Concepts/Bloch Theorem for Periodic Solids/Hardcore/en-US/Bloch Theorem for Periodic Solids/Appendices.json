{
    "hands_on_practices": [
        {
            "introduction": "The plane-wave method is a cornerstone of modern electronic structure calculations, translating the abstract Schrödinger equation into a solvable matrix problem. This first practice guides you through the process of deriving and implementing this method for a simple one-dimensional periodic potential . By constructing the Hamiltonian matrix and examining the convergence of its eigenvalues, you will gain hands-on experience with the practical aspects of band structure calculation and the critical role of the basis set.",
            "id": "3792867",
            "problem": "Consider a one-dimensional periodic solid modeled by the time-independent Schrödinger equation $[-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2} + V(x)]\\psi(x) = E\\psi(x)$ with a cosine potential $V(x) = 2V_G\\cos(Gx)$. By Bloch's theorem, eigenstates are of the form $\\psi_k(x) = e^{ikx}u_k(x)$ with $u_k(x)$ periodic under $x \\mapsto x + a$, where $a = \\frac{2\\pi}{G}$ is the lattice period. In the plane-wave method, one expands $u_k(x)$ in a Fourier series and truncates to a finite number of reciprocal-lattice harmonics. This leads to a finite-dimensional Hermitian eigenvalue problem that approximates the energy bands $E_n(k)$.\n\nYour task is to derive from first principles the truncated plane-wave Hamiltonian for $V(x) = 2V_G\\cos(Gx)$, starting from the Schrödinger equation and the Bloch form. Use a plane-wave basis labeled by integers $m \\in \\{-M,\\ldots,M\\}$ and define the truncated Hamiltonian acting on the coefficients associated with basis functions $e^{i(k+mG)x}$. Work in reduced units such that $\\frac{\\hbar^2}{2m} = 1$, so that energies $E$ are to be reported in these dimensionless units. Angles or phases do not need to be reported; if any angles are used internally, they must be in radians. Ensure all steps of the derivation are logically justified from the fundamental definitions and properties of Fourier series and orthogonality.\n\nImplement a complete, runnable program that:\n- Constructs the truncated Hamiltonian matrix for given $k$, $G$, $V_G$, and integer cutoff $M$.\n- Computes the two lowest eigenvalues $E_1(k)$ and $E_2(k)$ for each specified $k$.\n- For each test case, assesses convergence with increasing $G$-cutoff (i.e., increasing $M$) by computing a single scalar metric: the maximum absolute change in the two lowest energies across all specified $k$ when increasing $M$ from one value to the next in the test case's $M$ list. More precisely, if a test case specifies $M$ values $[M_1,M_2,\\ldots,M_L]$ and $k$ values $\\{k_j\\}$, construct the two-band energies for each $M_i$ and $k_j$, and report\n$$\n\\max_{i=1,\\ldots,L-1}\\max_{j}\\max_{n=1,2}\\left|E_n^{(M_{i+1})}(k_j) - E_n^{(M_i)}(k_j)\\right|.\n$$\n\nUse the following test suite to evaluate different regimes and edge conditions:\n- Test case $1$ (moderate nearly-free electron regime): $V_G = 0.2$, $G = 2\\pi$, $M$ list $[1,2,3]$, $k$ list $\\{0, \\frac{G}{4}, \\frac{G}{2}\\}$.\n- Test case $2$ (weak potential, focus on zone boundary): $V_G = 0.05$, $G = 2\\pi$, $M$ list $[1,2,4]$, $k$ list $\\{ \\frac{G}{2} \\}$.\n- Test case $3$ (stronger potential, need larger cutoff): $V_G = 1.0$, $G = 2\\pi$, $M$ list $[2,3,5]$, $k$ list $\\{0, \\frac{G}{4}, \\frac{G}{2}\\}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is the convergence metric (a float) for the corresponding test case, in the order given above. For example: $[r_1,r_2,r_3]$ where each $r_i$ is the maximum absolute change defined above, expressed in the reduced energy unit $\\frac{\\hbar^2}{2m}=1$ with no unit symbol and printed as plain decimal numbers.",
            "solution": "The objective is to derive the truncated plane-wave Hamiltonian for a one-dimensional periodic potential and then use it to compute band-structure energy convergence.\n\n### Derivation of the Plane-Wave Hamiltonian\n\nThe starting point is the one-dimensional time-independent Schrödinger equation for an electron of mass $m$ in a periodic potential $V(x)$:\n$$\n\\left[-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2} + V(x)\\right]\\psi(x) = E\\psi(x)\n$$\nThe problem specifies reduced units such that $\\frac{\\hbar^2}{2m} = 1$. The equation simplifies to:\n$$\n\\left[-\\frac{d^2}{dx^2} + V(x)\\right]\\psi(x) = E\\psi(x)\n$$\nThe potential is given as $V(x) = 2V_G\\cos(Gx)$. This potential is periodic with lattice period $a = \\frac{2\\pi}{G}$. According to Bloch's theorem, the eigenstates of this periodic system can be written in the form:\n$$\n\\psi_k(x) = e^{ikx} u_k(x)\n$$\nwhere $k$ is the crystal momentum (a continuous variable in the first Brillouin zone) and $u_k(x)$ is a periodic function with the same periodicity as the lattice, i.e., $u_k(x+a) = u_k(x)$.\n\nWe substitute the Bloch form of the wavefunction into the Schrödinger equation. First, we compute the second derivative of $\\psi_k(x)$:\n$$\n\\frac{d\\psi_k}{dx} = \\frac{d}{dx}\\left(e^{ikx} u_k(x)\\right) = ike^{ikx}u_k(x) + e^{ikx}\\frac{du_k}{dx} = e^{ikx}\\left(ik + \\frac{d}{dx}\\right)u_k(x)\n$$\n$$\n\\frac{d^2\\psi_k}{dx^2} = \\frac{d}{dx}\\left[e^{ikx}\\left(ik + \\frac{d}{dx}\\right)u_k(x)\\right] = e^{ikx}\\left(ik + \\frac{d}{dx}\\right)^2 u_k(x) = e^{ikx}\\left(-k^2 + 2ik\\frac{d}{dx} + \\frac{d^2}{dx^2}\\right)u_k(x)\n$$\nSubstituting this into the Schrödinger equation:\n$$\n-e^{ikx}\\left(-k^2 + 2ik\\frac{d}{dx} + \\frac{d^2}{dx^2}\\right)u_k(x) + V(x)e^{ikx}u_k(x) = E e^{ikx}u_k(x)\n$$\nDividing the entire equation by the non-zero factor $e^{ikx}$ yields an effective Schrödinger equation for the periodic part $u_k(x)$:\n$$\n\\left[k^2 - 2ik\\frac{d}{dx} - \\frac{d^2}{dx^2} + V(x)\\right]u_k(x) = E u_k(x)\n$$\nThis can be rearranged into a more standard form for the effective Hamiltonian $\\hat{H}_k$ acting on $u_k(x)$:\n$$\n\\hat{H}_k u_k(x) = \\left[\\left(-i\\frac{d}{dx} + k\\right)^2 + V(x)\\right]u_k(x) = E u_k(x)\n$$\n\nThe next step is to represent $u_k(x)$ and $V(x)$ in a suitable basis. Since $u_k(x)$ is periodic with period $a = 2\\pi/G$, it can be expanded in a Fourier series using a basis of plane waves $e^{iK_m x}$, where $K_m = m \\frac{2\\pi}{a} = mG$ are the reciprocal lattice vectors. The integer $m$ indexes the vectors.\n$$\nu_k(x) = \\sum_{m=-\\infty}^{\\infty} c_m e^{i m G x}\n$$\nThe full wavefunction, $\\psi_k(x)$, is then a superposition of plane waves:\n$$\n\\psi_k(x) = e^{ikx} \\sum_m c_m e^{i m G x} = \\sum_m c_m e^{i(k+mG)x}\n$$\nThe potential $V(x) = 2V_G\\cos(Gx)$ can be written in its complex exponential form:\n$$\nV(x) = V_G \\left(e^{iGx} + e^{-iGx}\\right)\n$$\nNow, substitute the Fourier series for $u_k(x)$ and the complex form of $V(x)$ into the effective Schrödinger equation.\nFirst, let's see how the kinetic energy operator acts on a basis function $e^{imgx}$:\n$$\n\\left(-i\\frac{d}{dx} + k\\right)^2 e^{imGx} = \\left(-i(imG) + k\\right)^2 e^{imGx} = (k+mG)^2 e^{imGx}\n$$\nApplying the full Hamiltonian $\\hat{H}_k$ to the series expansion of $u_k(x)$:\n$$\n\\hat{H}_k u_k(x) = \\sum_m c_m (k+mG)^2 e^{imGx} + V_G(e^{iGx} + e^{-iGx}) \\sum_m c_m e^{imGx} = E \\sum_m c_m e^{imGx}\n$$\nLet's expand the potential term:\n$$\nV(x) u_k(x) = V_G \\sum_m c_m e^{i(m+1)Gx} + V_G \\sum_m c_m e^{i(m-1)Gx}\n$$\nThe full equation becomes:\n$$\n\\sum_m c_m (k+mG)^2 e^{imGx} + V_G \\sum_m c_m e^{i(m+1)Gx} + V_G \\sum_m c_m e^{i(m-1)Gx} = E \\sum_m c_m e^{imGx}\n$$\nTo transform this functional equation into a matrix eigenvalue problem for the coefficients $\\{c_m\\}$, we project it onto a basis function $e^{inGx}$ for a chosen integer $n$. This involves multiplying by $e^{-inGx}$ and integrating over one lattice period, for instance, from $x=0$ to $x=a = 2\\pi/G$. We use the orthogonality relation $\\int_0^a e^{i(m-n)Gx} dx = a \\delta_{mn}$.\n\nProjecting each term:\n1.  Kinetic term: $\\sum_m c_m (k+mG)^2 \\int_0^a e^{i(m-n)Gx} dx = a c_n (k+nG)^2$.\n2.  Potential term 1: $V_G \\sum_m c_m \\int_0^a e^{i(m+1-n)Gx} dx = a V_G c_{n-1}$ (since the Kronecker delta $\\delta_{m+1,n}$ is non-zero only for $m=n-1$).\n3.  Potential term 2: $V_G \\sum_m c_m \\int_0^a e^{i(m-1-n)Gx} dx = a V_G c_{n+1}$ (since $\\delta_{m-1,n}$ is non-zero only for $m=n+1$).\n4.  Energy term (RHS): $E \\sum_m c_m \\int_0^a e^{i(m-n)Gx} dx = a E c_n$.\n\nAfter dividing by the constant factor $a$, we obtain a system of linear algebraic equations for the coefficients $c_n$:\n$$\n(k+nG)^2 c_n + V_G c_{n-1} + V_G c_{n+1} = E c_n\n$$\nIn practice, the infinite sum must be truncated. We restrict the set of reciprocal lattice vectors to $m,n \\in \\{-M, -M+1, \\ldots, M-1, M\\}$, for a positive integer cutoff $M$. This results in a finite-dimensional system of $(2M+1)$ equations. This system can be written in matrix form, $H\\mathbf{c} = E\\mathbf{c}$, where $\\mathbf{c} = (c_{-M}, \\ldots, c_M)^T$ is the vector of coefficients.\n\nThe elements of the Hamiltonian matrix $H$, indexed by $n, m \\in \\{-M, \\ldots, M\\}$, are:\n$$\nH_{nm} = \\langle n | \\hat{H}_k | m \\rangle = \\int_0^a e^{-inGx} \\hat{H}_k e^{imGx} dx / a\n$$\nFrom the equation derived above:\n$$\n\\sum_m H_{nm} c_m = (k+nG)^2 c_n + V_G c_{n-1} + V_G c_{n+1}\n$$\nBy inspection, we can identify the matrix elements:\n-   Diagonal elements ($m=n$): $H_{n,n} = (k+nG)^2$\n-   Off-diagonal elements ($m=n \\pm 1$): $H_{n,n-1} = H_{n,n+1} = V_G$\n-   All other elements are zero.\n\nThis defines a $(2M+1) \\times (2M+1)$ real, symmetric, tridiagonal matrix. For example, with $M=1$, the indices are $n,m \\in \\{-1, 0, 1\\}$. The Hamiltonian matrix is:\n$$\nH = \\begin{pmatrix}\n(k-G)^2 & V_G & 0 \\\\\nV_G & k^2 & V_G \\\\\n0 & V_G & (k+G)^2\n\\end{pmatrix}\n$$\nThe eigenvalues of this matrix correspond to the energy bands $E_n(k)$ for the truncated system. Increasing $M$ includes more plane waves in the basis set and systematically converges the calculated eigenvalues to the exact solutions for the given potential.",
            "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Computes the convergence of the two lowest energy bands for a 1D cosine potential.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"V_G\": 0.2, \n            \"G\": 2 * np.pi, \n            \"M_list\": [1, 2, 3],\n            \"k_list\": [0.0, (2 * np.pi) / 4.0, (2 * np.pi) / 2.0]\n        },\n        {\n            \"V_G\": 0.05, \n            \"G\": 2 * np.pi, \n            \"M_list\": [1, 2, 4],\n            \"k_list\": [(2 * np.pi) / 2.0]\n        },\n        {\n            \"V_G\": 1.0, \n            \"G\": 2 * np.pi, \n            \"M_list\": [2, 3, 5],\n            \"k_list\": [0.0, (2 * np.pi) / 4.0, (2 * np.pi) / 2.0]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        V_G = case[\"V_G\"]\n        G = case[\"G\"]\n        M_list = case[\"M_list\"]\n        k_list = case[\"k_list\"]\n\n        # Store computed energies for each M\n        # Format: energies_by_M[M] = {k1: (E1, E2), k2: (E1, E2), ...}\n        energies_by_M = {}\n\n        for M in M_list:\n            energies_for_this_M = {}\n            dim = 2 * M + 1\n            \n            # The off-diagonal elements are constant for a given V_G\n            off_diag = np.full(dim - 1, V_G)\n            \n            for k in k_list:\n                # The diagonal elements depend on k, M, and G\n                m_indices = np.arange(-M, M + 1)\n                diag = (k + m_indices * G)**2\n                \n                # The Hamiltonian matrix is real, symmetric, and tridiagonal.\n                # scipy.linalg.eigh_tridiagonal is highly efficient for this case.\n                # It returns sorted eigenvalues.\n                eigenvalues = linalg.eigh_tridiagonal(diag, off_diag, eigvals_only=True)\n                \n                # We need the two lowest eigenvalues\n                energies_for_this_M[k] = (eigenvalues[0], eigenvalues[1])\n            \n            energies_by_M[M] = energies_for_this_M\n\n        # Calculate the convergence metric\n        # max_i max_j max_n |E_n^(M_{i+1})(k_j) - E_n^(M_i)(k_j)|\n        max_change_overall = 0.0\n        for i in range(len(M_list) - 1):\n            M_current = M_list[i]\n            M_next = M_list[i+1]\n            \n            energies_current = energies_by_M[M_current]\n            energies_next = energies_by_M[M_next]\n            \n            # Find the max change for this step in M\n            max_change_step = 0.0\n            for k in k_list:\n                E1_curr, E2_curr = energies_current[k]\n                E1_next, E2_next = energies_next[k]\n                \n                change1 = abs(E1_next - E1_curr)\n                change2 = abs(E2_next - E2_curr)\n                \n                max_change_step = max(max_change_step, change1, change2)\n\n            max_change_overall = max(max_change_overall, max_change_step)\n        \n        results.append(max_change_overall)\n\n    # Final print statement in the exact required format.\n    # Using format specifier to ensure plain decimal output and sufficient precision.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "An electronic band structure is not just a diagram; it is a rich source of information about how electrons behave. This exercise focuses on extracting one of the most important parameters for transport phenomena: the effective mass tensor, $\\mathbf{m}^{\\ast}$ . Starting from the semiclassical equations of motion, you will derive the fundamental connection between the local curvature of the energy bands and the inertial mass of a Bloch electron, a crucial concept for linking quantum calculations to device-scale simulations.",
            "id": "3792908",
            "problem": "In multiscale materials simulation, linking quantum-scale bandstructure to continuum transport models often requires an effective mass description of Bloch electrons near a band extremum. Consider a three-dimensional periodic solid whose conduction-band energy dispersion near a non-degenerate minimum at $\\mathbf{k}=\\mathbf{0}$ can be approximated by\n$$\nE(\\mathbf{k})=E_{0}+\\alpha\\,k_{x}^{2}+\\beta\\,k_{y}^{2}+\\gamma\\,k_{z}^{2},\n$$\nwhere $\\alpha$, $\\beta$, and $\\gamma$ are positive material-dependent constants, $\\mathbf{k}=(k_{x},k_{y},k_{z})$ is the crystal wave vector, and $E_{0}$ is the band-edge energy. Starting from first principles of Bloch electron semiclassical dynamics and core definitions, do the following:\n\n1. Using the group velocity definition and the semiclassical equation of motion for a Bloch electron under a slowly varying external force $\\mathbf{F}$, derive the effective mass tensor $\\mathbf{m}^{\\ast}$ that relates $\\mathbf{F}$ to the acceleration $\\mathbf{a}$ through a Newtonian form at the band edge. Explicitly connect $\\mathbf{m}^{\\ast}$ to the local curvature (second derivatives) of $E(\\mathbf{k})$ at $\\mathbf{k}=\\mathbf{0}$, and compute the components of $\\mathbf{m}^{\\ast}$ for the dispersion above.\n\n2. Identify the principal axes of $\\mathbf{m}^{\\ast}$ for this bandstructure and justify your identification based on symmetry of the curvature.\n\n3. Consider the Density of States (DOS) effective mass, defined as $m_{\\mathrm{DOS}}=\\left(\\det \\mathbf{m}^{\\ast}\\right)^{1/3}$ for a general anisotropic quadratic band in three dimensions. Express $m_{\\mathrm{DOS}}$ in closed form in terms of $\\alpha$, $\\beta$, $\\gamma$, and the reduced Planck constant $\\hbar$.\n\nProvide a complete derivation for items 1 and 2 to establish what the effective mass tensor is and why the identified axes are principal. For item 3, report only the final analytic expression for $m_{\\mathrm{DOS}}$. No numerical evaluation is required. The final answer must be a single closed-form expression. Do not include units in the final boxed answer.",
            "solution": "The problem requires the derivation of the effective mass tensor for a Bloch electron, the identification of its principal axes, and the calculation of the density-of-states effective mass, based on a given anisotropic energy dispersion relation near a band minimum. The analysis will proceed from the fundamental principles of the semiclassical model of electron dynamics in a crystal.\n\nThe semiclassical model describes the motion of an electron wave packet in a slowly varying potential. Two core equations govern this motion:\n1. The group velocity $\\mathbf{v}_g$ of the wave packet is related to the energy dispersion $E(\\mathbf{k})$ by:\n$$\n\\mathbf{v}_g = \\frac{1}{\\hbar} \\nabla_{\\mathbf{k}} E(\\mathbf{k})\n$$\nwhere $\\hbar$ is the reduced Planck constant and $\\mathbf{k}$ is the crystal wave vector.\n\n2. The rate of change of the crystal wave vector under an external force $\\mathbf{F}$ (e.g., from an electric field) is given by:\n$$\n\\hbar \\frac{d\\mathbf{k}}{dt} = \\mathbf{F}\n$$\n\n**1. Derivation of the Effective Mass Tensor $\\mathbf{m}^{\\ast}$**\n\nThe acceleration $\\mathbf{a}$ of the electron wave packet is the time derivative of its group velocity $\\mathbf{v}_g$:\n$$\n\\mathbf{a} = \\frac{d\\mathbf{v}_g}{dt} = \\frac{d}{dt} \\left( \\frac{1}{\\hbar} \\nabla_{\\mathbf{k}} E(\\mathbf{k}) \\right)\n$$\nUsing the chain rule for differentiation, the $i$-th component of the acceleration, $a_i$, is:\n$$\na_i = \\frac{1}{\\hbar} \\frac{d}{dt} \\left( \\frac{\\partial E}{\\partial k_i} \\right) = \\frac{1}{\\hbar} \\sum_{j} \\frac{\\partial}{\\partial k_j} \\left( \\frac{\\partial E}{\\partial k_i} \\right) \\frac{dk_j}{dt}\n$$\nwhere the sum is over the components of the wave vector $\\mathbf{k}$, i.e., $j \\in \\{x, y, z\\}$. From the semiclassical equation of motion, we have $\\frac{dk_j}{dt} = \\frac{F_j}{\\hbar}$. Substituting this into the expression for acceleration gives:\n$$\na_i = \\frac{1}{\\hbar} \\sum_{j} \\left( \\frac{\\partial^2 E}{\\partial k_i \\partial k_j} \\right) \\left( \\frac{F_j}{\\hbar} \\right) = \\frac{1}{\\hbar^2} \\sum_{j} \\left( \\frac{\\partial^2 E}{\\partial k_i \\partial k_j} \\right) F_j\n$$\nThis equation relates the acceleration vector $\\mathbf{a}$ to the force vector $\\mathbf{F}$. We seek a Newtonian form $\\mathbf{F} = \\mathbf{m}^{\\ast} \\mathbf{a}$, or equivalently, $\\mathbf{a} = (\\mathbf{m}^{\\ast})^{-1} \\mathbf{F}$. By comparing this with the derived expression, we can identify the components of the inverse effective mass tensor $(\\mathbf{m}^{\\ast})^{-1}$:\n$$\n\\left( (\\mathbf{m}^{\\ast})^{-1} \\right)_{ij} = \\frac{1}{\\hbar^2} \\frac{\\partial^2 E(\\mathbf{k})}{\\partial k_i \\partial k_j}\n$$\nThe matrix with elements $\\frac{\\partial^2 E}{\\partial k_i \\partial k_j}$ is the Hessian matrix of the energy dispersion $E(\\mathbf{k})$, representing its local curvature. The effective mass tensor $\\mathbf{m}^{\\ast}$ is the inverse of this matrix, scaled by $\\hbar^2$:\n$$\n\\mathbf{m}^{\\ast} = \\hbar^2 \\left[ \\nabla_{\\mathbf{k}} \\nabla_{\\mathbf{k}} E(\\mathbf{k}) \\right]^{-1}\n$$\nNow, we apply this result to the given energy dispersion relation at the band minimum $\\mathbf{k}=\\mathbf{0}$:\n$$\nE(\\mathbf{k}) = E_{0}+\\alpha k_{x}^{2}+\\beta k_{y}^{2}+\\gamma k_{z}^{2}\n$$\nWe compute the second partial derivatives to form the Hessian matrix.\n$$\n\\frac{\\partial^2 E}{\\partial k_x^2} = 2\\alpha, \\quad \\frac{\\partial^2 E}{\\partial k_y^2} = 2\\beta, \\quad \\frac{\\partial^2 E}{\\partial k_z^2} = 2\\gamma\n$$\nAll mixed partial derivatives are zero, for example:\n$$\n\\frac{\\partial^2 E}{\\partial k_x \\partial k_y} = \\frac{\\partial}{\\partial k_x} \\left( \\frac{\\partial E}{\\partial k_y} \\right) = \\frac{\\partial}{\\partial k_x} (2\\beta k_y) = 0\n$$\nSince these derivatives are constant, the curvature is uniform near the band minimum. The Hessian matrix of $E(\\mathbf{k})$ is:\n$$\n\\nabla_{\\mathbf{k}} \\nabla_{\\mathbf{k}} E = \\begin{pmatrix} 2\\alpha & 0 & 0 \\\\ 0 & 2\\beta & 0 \\\\ 0 & 0 & 2\\gamma \\end{pmatrix}\n$$\nThe inverse effective mass tensor is then:\n$$\n(\\mathbf{m}^{\\ast})^{-1} = \\frac{1}{\\hbar^2} \\begin{pmatrix} 2\\alpha & 0 & 0 \\\\ 0 & 2\\beta & 0 \\\\ 0 & 0 & 2\\gamma \\end{pmatrix} = \\begin{pmatrix} \\frac{2\\alpha}{\\hbar^2} & 0 & 0 \\\\ 0 & \\frac{2\\beta}{\\hbar^2} & 0 \\\\ 0 & 0 & \\frac{2\\gamma}{\\hbar^2} \\end{pmatrix}\n$$\nThe effective mass tensor $\\mathbf{m}^{\\ast}$ is the inverse of $(\\mathbf{m}^{\\ast})^{-1}$. For a diagonal matrix, this is found by taking the reciprocal of each diagonal element:\n$$\n\\mathbf{m}^{\\ast} = \\begin{pmatrix} \\frac{\\hbar^2}{2\\alpha} & 0 & 0 \\\\ 0 & \\frac{\\hbar^2}{2\\beta} & 0 \\\\ 0 & 0 & \\frac{\\hbar^2}{2\\gamma} \\end{pmatrix}\n$$\nThe components are $m_{xx}^{\\ast} = \\frac{\\hbar^2}{2\\alpha}$, $m_{yy}^{\\ast} = \\frac{\\hbar^2}{2\\beta}$, and $m_{zz}^{\\ast} = \\frac{\\hbar^2}{2\\gamma}$.\n\n**2. Principal Axes of the Effective Mass Tensor**\n\nThe principal axes of a tensor are the directions of its eigenvectors. In the basis of its principal axes, a tensor is represented by a diagonal matrix, and the diagonal entries are the corresponding eigenvalues (the principal values).\nFrom the result in Part 1, the effective mass tensor $\\mathbf{m}^{\\ast}$ is already expressed as a diagonal matrix in the Cartesian coordinate system defined by the wave vector components $(k_x, k_y, k_z)$. This directly implies that the basis vectors of this coordinate system, namely $\\hat{\\mathbf{x}}$, $\\hat{\\mathbf{y}}$, and $\\hat{\\mathbf{z}}$, are the eigenvectors of $\\mathbf{m}^{\\ast}$.\nTherefore, the principal axes of the effective mass tensor for this bandstructure are the Cartesian axes $\\hat{\\mathbf{x}}$, $\\hat{\\mathbf{y}}$, and $\\hat{\\mathbf{z}}$. The justification is that the given energy dispersion $E(\\mathbf{k}) = E_{0}+\\alpha k_{x}^{2}+\\beta k_{y}^{2}+\\gamma k_{z}^{2}$ contains no cross terms such as $k_x k_y$. This functional form ensures that the Hessian matrix of $E(\\mathbf{k})$, and consequently both $(\\mathbf{m}^{\\ast})^{-1}$ and $\\mathbf{m}^{\\ast}$, are diagonal in the $(k_x, k_y, k_z)$ coordinate system.\n\n**3. Density of States (DOS) Effective Mass**\n\nThe problem defines the DOS effective mass as $m_{\\mathrm{DOS}} = \\left(\\det \\mathbf{m}^{\\ast}\\right)^{1/3}$. We compute the determinant of the effective mass tensor $\\mathbf{m}^{\\ast}$ derived above. For a diagonal matrix, the determinant is the product of its diagonal elements:\n$$\n\\det \\mathbf{m}^{\\ast} = \\left(\\frac{\\hbar^2}{2\\alpha}\\right) \\left(\\frac{\\hbar^2}{2\\beta}\\right) \\left(\\frac{\\hbar^2}{2\\gamma}\\right) = \\frac{\\hbar^6}{8\\alpha\\beta\\gamma}\n$$\nNow, we take the cube root of this determinant to find $m_{\\mathrm{DOS}}$:\n$$\nm_{\\mathrm{DOS}} = \\left( \\frac{\\hbar^6}{8\\alpha\\beta\\gamma} \\right)^{1/3} = \\frac{(\\hbar^6)^{1/3}}{(8\\alpha\\beta\\gamma)^{1/3}} = \\frac{\\hbar^2}{2(\\alpha\\beta\\gamma)^{1/3}}\n$$\nThis is the final closed-form expression for the DOS effective mass.",
            "answer": "$$ \\boxed{ \\frac{\\hbar^2}{2 \\left( \\alpha \\beta \\gamma \\right)^{1/3}} } $$"
        },
        {
            "introduction": "Real materials are often imperfect, and simulations must frequently use large 'supercells' to model defects, alloys, or surfaces, which complicates the resulting band structure. This practice introduces the powerful technique of spectral unfolding, which allows us to project the complex eigenstates from a supercell calculation back onto the simpler Brillouin zone of the primitive cell . You will implement an algorithm to compute the spectral weight, effectively learning how to 'unfold' a complex band structure and identify the remnants of the original bands, often called 'shadow bands'.",
            "id": "3792904",
            "problem": "Consider a one-dimensional periodic solid modeled as a tight-binding chain with a single orbital per site and primitive translation vector $a$. Impose Born–von Karman boundary conditions over a supercell containing $N$ primitive cells, so the Hilbert space consists of complex vectors of length $N$, representing amplitudes $\\psi_j$ on sites $j=0,1,\\dots,N-1$, with cyclic indexing under translation by $a$. By the fundamental structure of periodic systems, the Hamiltonian commutes with the translation operator $T_a$, and eigenstates can be simultaneously diagonalized with respect to the translations generated by $T_a$. For the discrete cyclic group generated by $T_a$ over $N$ cells, the primitive wavevectors are $k_n = \\frac{2\\pi n}{N a}$ for integers $n=0,1,\\dots,N-1$ (angles measured in radians).\n\nStarting from the fact that Bloch states are common eigenstates of the translation operators with eigenvalues $e^{i k a}$, construct the projection operator onto the subspace that transforms according to the one-dimensional representation labeled by a primitive wavevector $k_n$. For a normalized supercell eigenstate $\\psi$ (a complex vector of length $N$), define the spectral weight $W(k_n;\\psi)$ as the squared norm of the projected component of $\\psi$ onto the representation associated with $k_n$. Using only this fundamental base and the properties of the translation group, design an algorithm that, for any given state $\\psi$, computes the list of spectral weights $[W(k_0;\\psi),W(k_1;\\psi),\\dots,W(k_{N-1};\\psi)]$. Then, using these spectral weights, define a rule to identify shadow bands as follows: the main band(s) are the primitive wavevector indices where the spectral weight achieves its maximum value; a shadow band is any primitive wavevector index where the spectral weight is strictly positive and strictly less than this maximum. If there are multiple indices sharing the maximum, treat all of them as main bands and mark no shadow band among those maxima.\n\nYour program must implement this computation for the following test suite, with $N=4$ and $a=1$ (angles in radians), and produce the spectral weights rounded to six decimal places:\n\n1. Case A (pure Bloch state): $\\psi_j = \\frac{1}{\\sqrt{N}} e^{i k j a}$ with $k = \\frac{\\pi}{2}$ and $j=0,1,2,3$.\n2. Case B (mixed Bloch state): $\\psi = \\sqrt{0.8}\\,\\phi_{k_0} + \\sqrt{0.2}\\,\\phi_{k_1}$, where $\\phi_{k_n}$ denotes the normalized Bloch state with components $(\\phi_{k_n})_j = \\frac{1}{\\sqrt{N}} e^{i k_n j a}$, $k_0 = 0$, and $k_1 = \\frac{\\pi}{2}$, with $j=0,1,2,3$.\n3. Case C (localized state): $\\psi_j = \\delta_{j,0}$, where $\\delta_{j,0}$ is the Kronecker delta.\n\nFor each case, compute the spectral weights and identify shadow bands using the rule above. The final output format must be a single line containing a Python-style list of results for the three cases, where each case is represented by a list consisting of two lists: the first is the list of spectral weights in the order $[k_0,k_1,k_2,k_3]$, rounded to six decimal places, and the second is a list of integers of the same length, where $1$ indicates a shadow band and $0$ otherwise. For example, the output must have the form $[[\\text{weights\\_A},\\text{shadows\\_A}],[\\text{weights\\_B},\\text{shadows\\_B}],[\\text{weights\\_C},\\text{shadows\\_C}]]$ where each placeholder is replaced by actual lists of floats and integers.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[[w\\_A,s\\_A],[w\\_B,s\\_B],[w\\_C,s\\_C]]$).",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, objective, and internally consistent. It presents a standard but substantive problem in computational solid-state physics.\n\nThe core of the problem is to determine the composition of a given quantum state $\\psi$ in terms of Bloch waves, which are the elementary excitations in a periodic system. This is achieved by computing the spectral weight $W(k_n; \\psi)$ for each allowed wavevector $k_n$ in the first Brillouin zone.\n\n**1. Theoretical Framework: Bloch's Theorem and Projection Operators**\n\nIn a one-dimensional periodic solid with lattice constant $a$ and $N$ sites under Born-von Karman (periodic) boundary conditions, the system possesses discrete translational symmetry. This symmetry is described by the translation operator $T_a$, which shifts the wavefunction by one lattice site: $(T_a \\psi)_j = \\psi_{j-1 \\pmod N}$. The set of all translations forms a cyclic group of order $N$, denoted $C_N$, with elements $\\{(T_a)^m | m=0, 1, \\dots, N-1\\}$.\n\nAccording to Bloch's theorem, the eigenstates of the Hamiltonian can be chosen to be simultaneous eigenstates of the translation operator $T_a$. These eigenstates, known as Bloch states $\\phi_k$, satisfy the eigenvalue equation:\n$$\nT_a \\phi_k = \\lambda_k \\phi_k = e^{i k a} \\phi_k\n$$\nwhere $k$ is the wavevector and $e^{i k a}$ is the corresponding eigenvalue, which must be a root of unity due to the periodic boundary condition $(T_a)^N = I$. This quantizes the allowed wavevectors to the discrete set of primitive wavevectors:\n$$\nk_n = \\frac{2\\pi n}{Na}, \\quad \\text{for } n = 0, 1, \\dots, N-1.\n$$\nThe Bloch states $\\{\\phi_{k_n}\\}$ corresponding to these distinct wavevectors form a complete orthonormal basis for the $N$-dimensional Hilbert space. A normalized Bloch state has components:\n$$\n(\\phi_{k_n})_j = \\frac{1}{\\sqrt{N}} e^{i k_n j a}\n$$\n\nThe problem asks for the construction of the projection operator $P_{k_n}$ that projects any state $\\psi$ onto the one-dimensional subspace spanned by the Bloch state $\\phi_{k_n}$. This can be derived from the representation theory of the cyclic group $C_N$. The projection operator onto the subspace transforming according to the irreducible representation (irrep) labeled by $k_n$ is given by:\n$$\nP_{k_n} = \\frac{d_n}{|G|} \\sum_{g \\in G} \\overline{\\chi_{k_n}(g)} g\n$$\nFor the cyclic group $C_N$, all irreps are one-dimensional, so the dimension $d_n = 1$. The order of the group is $|G| = N$. The group elements are $g_j = (T_a)^j$ for $j=0, \\dots, N-1$. The character $\\chi_{k_n}$ for the irrep associated with $k_n$ is the eigenvalue of the group element. For the element $(T_a)^j$, the character is $\\chi_{k_n}((T_a)^j) = (e^{i k_n a})^j = e^{i k_n j a}$.\nSubstituting these into the formula yields the projection operator:\n$$\nP_{k_n} = \\frac{1}{N} \\sum_{j=0}^{N-1} e^{-i k_n j a} (T_a)^j\n$$\n\n**2. Algorithmic Design: Spectral Weight and the Discrete Fourier Transform**\n\nThe spectral weight $W(k_n; \\psi)$ is defined as the squared norm of the projection of a normalized state $\\psi$ onto the subspace corresponding to $k_n$:\n$$\nW(k_n; \\psi) = \\| P_{k_n} \\psi \\|^2\n$$\nWhile one could directly apply the operator $P_{k_n}$ to $\\psi$, a more elegant and computationally efficient method exists. Since the Bloch states $\\{\\phi_{k_m}\\}$ form an orthonormal basis, any state $\\psi$ can be expanded as:\n$$\n\\psi = \\sum_{m=0}^{N-1} c_m \\phi_{k_m}\n$$\nThe coefficients $c_m$ are given by the inner product $c_m = \\langle \\phi_{k_m} | \\psi \\rangle$. Applying the projector $P_{k_n}$ to this expansion, we note that $P_{k_n}$ annihilates all basis states $\\phi_{k_m}$ where $m \\neq n$ and acts as the identity on $\\phi_{k_n}$. Thus:\n$$\nP_{k_n} \\psi = P_{k_n} \\left( \\sum_{m=0}^{N-1} c_m \\phi_{k_m} \\right) = c_n \\phi_{k_n}\n$$\nThe spectral weight is then simply the squared magnitude of the expansion coefficient:\n$$\nW(k_n; \\psi) = \\| c_n \\phi_{k_n} \\|^2 = |c_n|^2 \\| \\phi_{k_n} \\|^2 = |c_n|^2\n$$\nsince the Bloch states are normalized. The problem reduces to finding the coefficients $c_n$. Let's compute the inner product:\n$$\nc_n = \\langle \\phi_{k_n} | \\psi \\rangle = \\sum_{j=0}^{N-1} (\\phi_{k_n})_j^* \\psi_j = \\sum_{j=0}^{N-1} \\left( \\frac{1}{\\sqrt{N}} e^{i k_n j a} \\right)^* \\psi_j = \\frac{1}{\\sqrt{N}} \\sum_{j=0}^{N-1} \\psi_j e^{-i k_n j a}\n$$\nSubstituting $k_n = \\frac{2\\pi n}{Na}$:\n$$\nc_n = \\frac{1}{\\sqrt{N}} \\sum_{j=0}^{N-1} \\psi_j e^{-i \\frac{2\\pi n j}{N}}\n$$\nThe sum is the $n$-th component of the Discrete Fourier Transform (DFT) of the state vector $\\psi = (\\psi_0, \\psi_1, \\dots, \\psi_{N-1})$. Let $(\\text{DFT}(\\psi))_n = \\sum_{j=0}^{N-1} \\psi_j e^{-i \\frac{2\\pi n j}{N}}$. Then, $c_n = \\frac{1}{\\sqrt{N}} (\\text{DFT}(\\psi))_n$.\nThe spectral weight is therefore directly related to the DFT:\n$$\nW(k_n; \\psi) = |c_n|^2 = \\left| \\frac{1}{\\sqrt{N}} (\\text{DFT}(\\psi))_n \\right|^2 = \\frac{1}{N} \\left| (\\text{DFT}(\\psi))_n \\right|^2\n$$\nThis provides a direct algorithm: given a state vector $\\psi$, compute its DFT, find the squared magnitude of each component, and normalize by dividing by $N$. Efficient algorithms like the Fast Fourier Transform (FFT) make this computation highly performant.\n\n**3. Application to Test Cases**\n\nWe apply this algorithm to the given test cases with $N=4$ and $a=1$. The primitive wavevectors are $k_n = \\frac{2\\pi n}{4 \\cdot 1} = \\frac{n\\pi}{2}$ for $n=0,1,2,3$.\n\n**Case A (Pure Bloch State):** $\\psi_j = \\frac{1}{\\sqrt{N}} e^{i k j a}$ with $k = \\pi/2$.\nThis is precisely the normalized Bloch state $\\phi_{k_1}$ (since $k_1 = \\pi/2$). The state vector is $\\psi = \\frac{1}{2}(1, i, -1, -i)$. By definition, its expansion in the Bloch basis is $\\psi = 1 \\cdot \\phi_{k_1} + 0 \\cdot \\phi_{k_n}$ for $n \\neq 1$.\nThe coefficients are $c_1=1$, and $c_n=0$ otherwise.\nThe spectral weights are $W(k_n; \\psi) = |c_n|^2$, which gives $[0, 1, 0, 0]$.\nThe maximum weight is $1.0$. No other weights are strictly positive, so there are no shadow bands. The shadow band indicators are $[0, 0, 0, 0]$.\n\n**Case B (Mixed Bloch State):** $\\psi = \\sqrt{0.8}\\,\\phi_{k_0} + \\sqrt{0.2}\\,\\phi_{k_1}$.\nThe state is already given in the Bloch basis expansion. The coefficients are $c_0 = \\sqrt{0.8}$, $c_1 = \\sqrt{0.2}$, and $c_2 = c_3 = 0$.\nThe spectral weights are $W(k_n; \\psi) = |c_n|^2$.\n$W(k_0) = |\\sqrt{0.8}|^2 = 0.8$.\n$W(k_1) = |\\sqrt{0.2}|^2 = 0.2$.\n$W(k_2) = 0$, $W(k_3) = 0$.\nThe weights are $[0.8, 0.2, 0, 0]$. The maximum is $0.8$. The weight at index $1$ is $0.2$, which satisfies $0 < 0.2 < 0.8$. Thus, $k_1$ is a shadow band. The shadow band indicators are $[0, 1, 0, 0]$.\n\n**Case C (Localized State):** $\\psi_j = \\delta_{j,0}$.\nThe state vector is $\\psi = (1, 0, 0, 0)$. This state is normalized. We compute its DFT:\n$(\\text{DFT}(\\psi))_n = \\sum_{j=0}^{3} \\psi_j e^{-i \\frac{2\\pi n j}{4}} = 1 \\cdot e^0 + 0 + 0 + 0 = 1$ for all $n=0,1,2,3$.\nThe spectral weights are $W(k_n; \\psi) = \\frac{1}{N} |(\\text{DFT}(\\psi))_n|^2 = \\frac{1}{4} |1|^2 = 0.25$.\nThe weights are $[0.25, 0.25, 0.25, 0.25]$. All weights are equal to the maximum value of $0.25$. According to the rule, \"If there are multiple indices sharing the maximum... mark no shadow band among those maxima.\" Hence, there are no shadow bands. The shadow band indicators are $[0, 0, 0, 0]$. A localized state in real space is a uniform superposition of all momentum states.\n\nThe analysis provides all the necessary components for the implementation.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes spectral weights and identifies shadow bands for three quantum states\n    in a 1D tight-binding model.\n    \"\"\"\n    N = 4\n    a = 1.0\n\n    # Define primitive reciprocal lattice vectors\n    # k_n = 2 * pi * n / (N * a) for n = 0, 1, 2, 3\n    # k_0=0, k_1=pi/2, k_2=pi, k_3=3pi/2\n    k_vals = [(2 * np.pi * n) / (N * a) for n in range(N)]\n    site_indices = np.arange(N)\n\n    # === Case A: Pure Bloch state ===\n    # psi_j = 1/sqrt(N) * exp(i * k * j * a) with k = pi/2 = k_1\n    k_A = np.pi / 2\n    psi_A = (1 / np.sqrt(N)) * np.exp(1j * k_A * site_indices * a)\n\n    # === Case B: Mixed Bloch state ===\n    # psi = sqrt(0.8)*phi_k0 + sqrt(0.2)*phi_k1\n    # where phi_kn_j = 1/sqrt(N) * exp(i * kn * j * a)\n    phi_k0 = (1 / np.sqrt(N)) * np.exp(1j * k_vals[0] * site_indices * a)\n    phi_k1 = (1 / np.sqrt(N)) * np.exp(1j * k_vals[1] * site_indices * a)\n    psi_B = np.sqrt(0.8) * phi_k0 + np.sqrt(0.2) * phi_k1\n\n    # === Case C: Localized state ===\n    # psi_j = delta_{j,0}\n    psi_C = np.zeros(N, dtype=np.complex128)\n    psi_C[0] = 1.0\n\n    # List of state vectors to process\n    test_cases_psi = [psi_A, psi_B, psi_C]\n    \n    all_results = []\n    \n    for psi in test_cases_psi:\n        # The spectral weight W(k_n; psi) is |c_n|^2, where c_n are the coefficients\n        # of the state psi in the Bloch basis. This can be efficiently computed\n        # using the Fast Fourier Transform (FFT).\n        # W(k_n; psi) = (1/N) * |DFT(psi)_n|^2\n        dft_psi = np.fft.fft(psi)\n        weights = (np.abs(dft_psi)**2) / N\n\n        # Find shadow bands based on the provided rule.\n        # Main band(s) have maximum weight.\n        # Shadow bands have weight > 0 and < max_weight.\n        # A small tolerance is used for robust floating-point comparisons.\n        max_w = np.max(weights)\n        epsilon = 1e-9  # Tolerance for float comparison\n        \n        shadows = [1 if (w > epsilon and w  max_w - epsilon) else 0 for w in weights]\n        \n        # Format weights to six decimal places\n        formatted_weights = [round(w, 6) for w in weights]\n        \n        all_results.append([formatted_weights, shadows])\n\n    # Convert the final list to a string and remove spaces to match the dense format.\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}