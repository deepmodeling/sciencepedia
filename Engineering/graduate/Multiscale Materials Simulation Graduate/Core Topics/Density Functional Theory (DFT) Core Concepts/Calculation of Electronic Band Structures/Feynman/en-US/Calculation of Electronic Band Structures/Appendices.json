{
    "hands_on_practices": [
        {
            "introduction": "A meaningful band structure diagram is not plotted along arbitrary lines in momentum space, but along specific high-symmetry paths within the first Brillouin Zone. While these paths are conventionally described using simple fractional coordinates, practical calculations often require them to be expressed in the basis of the primitive reciprocal lattice vectors, $\\{\\mathbf{b}_i\\}$. This exercise provides essential practice in navigating reciprocal space by translating the standard high-symmetry points for common cubic lattices into the primitive basis, a fundamental skill for correctly setting up and interpreting band structure calculations .",
            "id": "3794761",
            "problem": "Consider two three-dimensional Bravais lattices with conventional cubic lattice constant $a$: the face-centered cubic (fcc) lattice and the body-centered cubic (bcc) lattice. The electronic band structure of a crystalline solid is computed along high-symmetry lines connecting special points in its First Brillouin Zone (FBZ). These special points are identified by the symmetry of the FBZ and have widely accepted Cartesian coordinates when expressed in the conventional reciprocal cubic basis $\\{(2\\pi/a)\\,\\hat{\\mathbf{x}},(2\\pi/a)\\,\\hat{\\mathbf{y}},(2\\pi/a)\\,\\hat{\\mathbf{z}}\\}$.\n\nStarting from the following foundational definitions:\n- The primitive direct lattice vectors $\\{\\mathbf{a}_{i}\\}$ for fcc can be chosen as $\\mathbf{a}_{1}=\\frac{a}{2}(0,1,1)$, $\\mathbf{a}_{2}=\\frac{a}{2}(1,0,1)$, $\\mathbf{a}_{3}=\\frac{a}{2}(1,1,0)$, and for bcc as $\\mathbf{a}_{1}=\\frac{a}{2}(1,1,-1)$, $\\mathbf{a}_{2}=\\frac{a}{2}(1,-1,1)$, $\\mathbf{a}_{3}=\\frac{a}{2}(-1,1,1)$.\n- The primitive reciprocal lattice vectors $\\{\\mathbf{b}_{i}\\}$ are defined by $\\mathbf{b}_{i}\\cdot\\mathbf{a}_{j}=2\\pi\\,\\delta_{ij}$ for $i,j\\in\\{1,2,3\\}$.\n\nUse the above to construct the primitive reciprocal bases $\\{\\mathbf{b}_{i}^{\\text{(fcc)}}\\}$ and $\\{\\mathbf{b}_{i}^{\\text{(bcc)}}\\}$ explicitly. Then, using the well-tested conventional Cartesian fractional coordinates (in the basis $\\{(2\\pi/a)\\,\\hat{\\mathbf{x}},(2\\pi/a)\\,\\hat{\\mathbf{y}},(2\\pi/a)\\,\\hat{\\mathbf{z}}\\}$) for the standard high-symmetry points:\n- For fcc: $\\Gamma=(0,0,0)$, $X=(0,1,0)$, $L=\\left(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2}\\right)$, $W=\\left(\\frac{1}{2},1,0\\right)$, $K=\\left(\\frac{3}{4},\\frac{3}{4},0\\right)$.\n- For bcc: $\\Gamma=(0,0,0)$, $H=(1,0,0)$, $N=\\left(0,\\frac{1}{2},0\\right)$, $P=\\left(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2}\\right)$.\n\nCompute the dimensionless coordinates of these points in the respective primitive reciprocal bases, that is, find $(c_{1},c_{2},c_{3})$ such that $\\mathbf{k}=c_{1}\\mathbf{b}_{1}+c_{2}\\mathbf{b}_{2}+c_{3}\\mathbf{b}_{3}$ for each listed point in fcc and bcc. Express your final answer as a single row matrix containing, in order, the three components for each point:\n- fcc in the order $\\Gamma$, $X$, $L$, $W$, $K$,\n- bcc in the order $\\Gamma$, $H$, $N$, $P$.\n\nNo rounding is required; express all entries as exact rational numbers. The entries are dimensionless and must be given in units of the respective $\\mathbf{b}_{i}$.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a unique solution. We can proceed with the calculation.\n\nThe problem requires finding the coordinates $(c_1, c_2, c_3)$ of various high-symmetry points $\\mathbf{k}$ in the First Brillouin Zone (FBZ) with respect to the primitive reciprocal lattice basis $\\{\\mathbf{b}_1, \\mathbf{b}_2, \\mathbf{b}_3\\}$. The relationship is given by:\n$$ \\mathbf{k} = c_1\\mathbf{b}_1 + c_2\\mathbf{b}_2 + c_3\\mathbf{b}_3 $$\n\nThe primitive reciprocal lattice vectors $\\mathbf{b}_i$ are defined by their relationship to the primitive direct lattice vectors $\\mathbf{a}_j$:\n$$ \\mathbf{b}_i \\cdot \\mathbf{a}_j = 2\\pi \\delta_{ij} $$\nwhere $\\delta_{ij}$ is the Kronecker delta.\n\nTo find the coefficient $c_j$, we can take the dot product of the expression for $\\mathbf{k}$ with a direct lattice vector $\\mathbf{a}_j$:\n$$ \\mathbf{k} \\cdot \\mathbf{a}_j = (c_1\\mathbf{b}_1 + c_2\\mathbf{b}_2 + c_3\\mathbf{b}_3) \\cdot \\mathbf{a}_j $$\n$$ \\mathbf{k} \\cdot \\mathbf{a}_j = c_1(\\mathbf{b}_1 \\cdot \\mathbf{a}_j) + c_2(\\mathbf{b}_2 \\cdot \\mathbf{a}_j) + c_3(\\mathbf{b}_3 \\cdot \\mathbf{a}_j) $$\nUsing the orthogonality condition, this simplifies to:\n$$ \\mathbf{k} \\cdot \\mathbf{a}_j = c_j (2\\pi) $$\nThus, the coefficients can be directly calculated as:\n$$ c_j = \\frac{\\mathbf{k} \\cdot \\mathbf{a}_j}{2\\pi} $$\nThis method bypasses the explicit calculation of the $\\mathbf{b}_i$ vectors, though such a calculation would confirm that the fcc direct lattice corresponds to a bcc reciprocal lattice, and vice-versa.\n\nThe problem provides the coordinates of the high-symmetry points, denoted here as $(k'_x, k'_y, k'_z)$, in the conventional reciprocal cubic basis $\\{(2\\pi/a)\\,\\hat{\\mathbf{x}},(2\\pi/a)\\,\\hat{\\mathbf{y}},(2\\pi/a)\\,\\hat{\\mathbf{z}}\\}$. Therefore, the vector $\\mathbf{k}$ is given by:\n$$ \\mathbf{k} = \\frac{2\\pi}{a} (k'_x, k'_y, k'_z) $$\n\nSubstituting this into the formula for $c_j$:\n$$ c_j = \\frac{1}{2\\pi} \\left( \\frac{2\\pi}{a} (k'_x, k'_y, k'_z) \\right) \\cdot \\mathbf{a}_j = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\mathbf{a}_j $$\n\nWe will now apply this general formula to the fcc and bcc lattices separately.\n\n**1. Face-Centered Cubic (fcc) Lattice**\n\nThe primitive direct lattice vectors for fcc are given as:\n$$ \\mathbf{a}_1^{(\\text{fcc})} = \\frac{a}{2}(0,1,1), \\quad \\mathbf{a}_2^{(\\text{fcc})} = \\frac{a}{2}(1,0,1), \\quad \\mathbf{a}_3^{(\\text{fcc})} = \\frac{a}{2}(1,1,0) $$\n\nUsing the derived formula for $c_j$, we obtain the specific transformation equations for the fcc lattice:\n$$ c_1 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(0,1,1) = \\frac{1}{2}(k'_y + k'_z) $$\n$$ c_2 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,0,1) = \\frac{1}{2}(k'_x + k'_z) $$\n$$ c_3 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,1,0) = \\frac{1}{2}(k'_x + k'_y) $$\n\nWe now compute the coordinates $(c_1, c_2, c_3)$ for each specified fcc high-symmetry point:\n- **$\\Gamma=(0,0,0)$**: $(k'_x,k'_y,k'_z)=(0,0,0)$.\n  $c_1 = \\frac{1}{2}(0+0) = 0$, $c_2 = \\frac{1}{2}(0+0) = 0$, $c_3 = \\frac{1}{2}(0+0) = 0$. Coordinates: $(0,0,0)$.\n- **$X=(0,1,0)$**: $(k'_x,k'_y,k'_z)=(0,1,0)$.\n  $c_1 = \\frac{1}{2}(1+0) = \\frac{1}{2}$, $c_2 = \\frac{1}{2}(0+0) = 0$, $c_3 = \\frac{1}{2}(0+1) = \\frac{1}{2}$. Coordinates: $(\\frac{1}{2},0,\\frac{1}{2})$.\n- **$L=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$**: $(k'_x,k'_y,k'_z)=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$.\n  $c_1 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{2}$, $c_2 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{2}$, $c_3 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{2}$. Coordinates: $(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$.\n- **$W=(\\frac{1}{2},1,0)$**: $(k'_x,k'_y,k'_z)=(\\frac{1}{2},1,0)$.\n  $c_1 = \\frac{1}{2}(1+0) = \\frac{1}{2}$, $c_2 = \\frac{1}{2}(\\frac{1}{2}+0) = \\frac{1}{4}$, $c_3 = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$. Coordinates: $(\\frac{1}{2},\\frac{1}{4},\\frac{3}{4})$.\n- **$K=(\\frac{3}{4},\\frac{3}{4},0)$**: $(k'_x,k'_y,k'_z)=(\\frac{3}{4},\\frac{3}{4},0)$.\n  $c_1 = \\frac{1}{2}(\\frac{3}{4}+0) = \\frac{3}{8}$, $c_2 = \\frac{1}{2}(\\frac{3}{4}+0) = \\frac{3}{8}$, $c_3 = \\frac{1}{2}(\\frac{3}{4}+\\frac{3}{4}) = \\frac{3}{4}$. Coordinates: $(\\frac{3}{8},\\frac{3}{8},\\frac{3}{4})$.\n\n**2. Body-Centered Cubic (bcc) Lattice**\n\nThe primitive direct lattice vectors for bcc are given as:\n$$ \\mathbf{a}_1^{(\\text{bcc})} = \\frac{a}{2}(1,1,-1), \\quad \\mathbf{a}_2^{(\\text{bcc})} = \\frac{a}{2}(1,-1,1), \\quad \\mathbf{a}_3^{(\\text{bcc})} = \\frac{a}{2}(-1,1,1) $$\n\nThe specific transformation equations for the bcc lattice are:\n$$ c_1 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,1,-1) = \\frac{1}{2}(k'_x + k'_y - k'_z) $$\n$$ c_2 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,-1,1) = \\frac{1}{2}(k'_x - k'_y + k'_z) $$\n$$ c_3 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(-1,1,1) = \\frac{1}{2}(-k'_x + k'_y + k'_z) $$\n\nWe now compute the coordinates $(c_1, c_2, c_3)$ for each specified bcc high-symmetry point:\n- **$\\Gamma=(0,0,0)$**: $(k'_x,k'_y,k'_z)=(0,0,0)$.\n  $c_1=0$, $c_2=0$, $c_3=0$. Coordinates: $(0,0,0)$.\n- **$H=(1,0,0)$**: $(k'_x,k'_y,k'_z)=(1,0,0)$.\n  $c_1 = \\frac{1}{2}(1+0-0) = \\frac{1}{2}$, $c_2 = \\frac{1}{2}(1-0+0) = \\frac{1}{2}$, $c_3 = \\frac{1}{2}(-1+0+0) = -\\frac{1}{2}$. Coordinates: $(\\frac{1}{2},\\frac{1}{2},-\\frac{1}{2})$.\n- **$N=(0,\\frac{1}{2},0)$**: $(k'_x,k'_y,k'_z)=(0,\\frac{1}{2},0)$.\n  $c_1 = \\frac{1}{2}(0+\\frac{1}{2}-0) = \\frac{1}{4}$, $c_2 = \\frac{1}{2}(0-\\frac{1}{2}+0) = -\\frac{1}{4}$, $c_3 = \\frac{1}{2}(0+\\frac{1}{2}+0) = \\frac{1}{4}$. Coordinates: $(\\frac{1}{4},-\\frac{1}{4},\\frac{1}{4})$.\n- **$P=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$**: $(k'_x,k'_y,k'_z)=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$.\n  $c_1 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}-\\frac{1}{2}) = \\frac{1}{4}$, $c_2 = \\frac{1}{2}(\\frac{1}{2}-\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{4}$, $c_3 = \\frac{1}{2}(-\\frac{1}{2}+\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{4}$. Coordinates: $(\\frac{1}{4},\\frac{1}{4},\\frac{1}{4})$.\n\nThe results are exact rational numbers as required. We consolidate them into a single row matrix in the specified order.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0 & 0 & 0 & \\frac{1}{2} & 0 & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{4} & \\frac{3}{4} & \\frac{3}{8} & \\frac{3}{8} & \\frac{3}{4} & 0 & 0 & 0 & \\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{4} & -\\frac{1}{4} & \\frac{1}{4} & \\frac{1}{4} & \\frac{1}{4} & \\frac{1}{4} \\end{pmatrix} } $$"
        },
        {
            "introduction": "The accuracy of any plane-wave based calculation is critically dependent on the size of the basis set, which is controlled by the kinetic energy cutoff, $E_{\\text{cut}}$. Before physical properties can be trusted, one must systematically test their convergence with respect to this parameter. This hands-on coding problem guides you through this essential process, using a simplified one-dimensional model to investigate how the calculated band gap and valence bandwidth converge as $E_{\\text{cut}}$ increases, a procedure that is fundamental to achieving reliable results in any production-level simulation .",
            "id": "3739438",
            "problem": "Consider a one-dimensional periodic potential model intended to qualitatively emulate the electronic structure features of silicon while remaining computationally tractable within a plane-wave basis. The system is governed by the single-particle time-independent Schrödinger equation for an electron of mass $m_e$ in a periodic potential $V(x)$ with lattice constant $a$, expressed as $-\\frac{\\hbar^2}{2 m_e} \\frac{d^2}{dx^2} \\psi(x) + V(x) \\psi(x) = E \\psi(x)$. By Bloch's theorem, eigenstates can be written as $\\psi_{n,k}(x) = e^{i k x} u_{n,k}(x)$ where $u_{n,k}(x)$ has the periodicity of the lattice. Expanding in plane waves leads to a matrix Hamiltonian in reciprocal space indexed by reciprocal lattice vectors $G$ and $G'$:\n$$\nH_{G,G'}(k) = \\delta_{G,G'} \\left( \\frac{\\hbar^2}{2 m_e} \\left| k + G \\right|^2 \\right) + V_{G - G'}\n$$\nwhere $V_{q}$ are Fourier components of the periodic potential and $\\delta_{G,G'}$ is the Kronecker delta. The reciprocal lattice vectors are $G = n G_0$ with $n \\in \\mathbb{Z}$ and $G_0 = \\frac{2 \\pi}{a}$. In this problem, use a transferable local pseudopotential specified by two nonzero Fourier components $V_{G_0}$ and $V_{2 G_0}$, with $V_{q} = 0$ otherwise. Take $V_{G_0} = -5.0$ eV and $V_{2 G_0} = +1.5$ eV for all volumes, which constitutes a model intended to emulate the opening of an indirect gap and a finite valence bandwidth reminiscent of silicon. Use the physical constant $\\frac{\\hbar^2}{2 m_e} = 3.8099819443$ eV·Å$^2$.\n\nTo reflect a plane-wave basis truncation, impose a kinetic energy cutoff $E_{\\text{cut}}$ by including only those reciprocal lattice vectors $G$ for which the free-electron kinetic energy at $k = 0$ satisfies $\\frac{\\hbar^2}{2 m_e} G^2 \\le E_{\\text{cut}}$. For each chosen $E_{\\text{cut}}$, construct the Hamiltonian $H(k)$ on a uniform grid of wave numbers $k$ in the first Brillouin zone from $0$ to $\\pi/a$, diagonalize $H(k)$ to obtain band energies $E_n(k)$ (sorted in ascending order), and define the valence band as $n_v = 1$ and the conduction band as $n_c = 2$. This indexing corresponds to the physically motivated assumption for a one-dimensional insulator with a single primary band gap between the first and second bands in the nearly-free electron regime. The valence bandwidth is $W_v = \\max_k E_{n_v}(k) - \\min_k E_{n_v}(k)$, and the indirect band gap is $\\Delta_{\\text{ind}} = \\min_k E_{n_c}(k) - \\max_k E_{n_v}(k)$, with energies expressed in electronvolts.\n\nYour task is to compute convergence of $\\Delta_{\\text{ind}}$ and $W_v$ with respect to $E_{\\text{cut}}$, and to assess transferability of the pseudopotential across volumes by repeating the analysis at different lattice constants $a$. Use the following test suite:\n\n- Lattice constants (in Å): $a_1 = 5.43$, $a_2 = 5.30$, $a_3 = 5.60$.\n- Energy cutoffs (in eV) to test: $E_{\\text{cut}} \\in \\{ 4, 6, 8, 12, 16, 24, 32, 48 \\}$.\n- Reference energy cutoff (in eV): $E_{\\text{ref}} = 80$.\n- Tolerances (in eV): $\\varepsilon_{\\Delta} = 0.01$ for the indirect gap and $\\varepsilon_W = 0.01$ for the valence bandwidth.\n- Wave number grid: uniformly sample $k$ in $[0, \\pi/a]$ with $201$ points.\n\nFor each lattice constant $a$, compute the reference values $\\Delta_{\\text{ind}}^{\\text{ref}}(a)$ and $W_v^{\\text{ref}}(a)$ using $E_{\\text{ref}}$. Then, for each $E_{\\text{cut}}$ in the test list, compute $\\Delta_{\\text{ind}}(a; E_{\\text{cut}})$ and $W_v(a; E_{\\text{cut}})$ and determine the smallest $E_{\\text{cut}}$ such that $\\left| \\Delta_{\\text{ind}}(a; E_{\\text{cut}}) - \\Delta_{\\text{ind}}^{\\text{ref}}(a) \\right| \\le \\varepsilon_{\\Delta}$ and the smallest $E_{\\text{cut}}$ such that $\\left| W_v(a; E_{\\text{cut}}) - W_v^{\\text{ref}}(a) \\right| \\le \\varepsilon_W$. If for a given property at a given $a$ no $E_{\\text{cut}}$ in the test list meets the tolerance, report $-1$ for that entry. Energies and cutoffs are in electronvolts (eV), and distances are in ångström (Å). Wave numbers $k$ are in reciprocal ångström (Å$^{-1}$).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain six numbers in the following order: the minimal $E_{\\text{cut}}$ for the indirect gap at $a_1$, the minimal $E_{\\text{cut}}$ for the valence bandwidth at $a_1$, then the corresponding two values for $a_2$, and then for $a_3$. For example, the output format must be like $[x_1, y_1, x_2, y_2, x_3, y_3]$ where each $x_i$ and $y_i$ are floating-point numbers in eV.",
            "solution": "The problem requires the calculation of the indirect band gap and valence bandwidth of a one-dimensional periodic system and the study of their convergence with respect to the plane-wave energy cutoff parameter, $E_{\\text{cut}}$. This is a standard procedure in computational materials science to ensure the reliability of simulation results. The analysis will be performed for three different lattice constants, $a$, to assess the transferability of the provided pseudopotential.\n\nThe foundation of this problem is the time-independent single-particle Schrödinger equation for an electron of mass $m_e$ in a periodic potential $V(x)$:\n$$\n\\left[ -\\frac{\\hbar^2}{2 m_e} \\frac{d^2}{dx^2} + V(x) \\right] \\psi(x) = E \\psi(x)\n$$\nDue to the periodicity of the potential, $V(x) = V(x+a)$, Bloch's theorem states that the eigenstates can be written in the form $\\psi_{n,k}(x) = e^{ikx} u_{n,k}(x)$, where $u_{n,k}(x)$ is a periodic function with the same lattice periodicity, and $k$ is the wave number confined to the first Brillouin zone, which for a 1D lattice is $[-\\pi/a, \\pi/a]$.\n\nThe periodic function $u_{n,k}(x)$ can be expanded in a Fourier series over the reciprocal lattice vectors $G = n G_0$, where $G_0 = 2\\pi/a$ and $n \\in \\mathbb{Z}$:\n$$\nu_{n,k}(x) = \\sum_{G} c_{k,G} e^{iGx}\n$$\nSubstituting this into the Schrödinger equation leads to an eigenvalue problem in reciprocal space. The Hamiltonian becomes a matrix with elements indexed by reciprocal lattice vectors $G$ and $G'$:\n$$\nH_{G,G'}(k) = \\delta_{G,G'} \\left( \\frac{\\hbar^2}{2 m_e} |k+G|^2 \\right) + V_{G-G'}\n$$\nHere, $\\delta_{G,G'}$ is the Kronecker delta, and $V_{G-G'}$ are the Fourier coefficients of the potential $V(x)$. For a physical, real potential $V(x)$, its Fourier coefficients must satisfy $V_q = V_{-q}^*$. The problem provides real values for $V_q$, which implies $V_q = V_{-q}$. We are given two non-zero potential components: $V_{G_0} = -5.0 \\text{ eV}$ and $V_{2G_0} = +1.5 \\text{ eV}$. We thus assume $V_{-G_0} = V_{G_0}$ and $V_{-2G_0} = V_{2G_0}$. All other components, including $V_0$, are zero. The constant $\\frac{\\hbar^2}{2m_e}$ is given as $3.8099819443 \\text{ eV} \\cdot \\text{Å}^2$.\n\nIn any practical calculation, the infinite sum over $G$ must be truncated. The problem specifies a kinetic energy cutoff scheme: the basis set includes only those reciprocal lattice vectors $G$ for which the free-electron kinetic energy at $k=0$ is below a cutoff $E_{\\text{cut}}$.\n$$\n\\frac{\\hbar^2}{2 m_e} G^2 \\le E_{\\text{cut}}\n$$\nSubstituting $G = n G_0 = n \\frac{2\\pi}{a}$, we can find the maximum integer $N_{\\text{max}}$ for the basis set:\n$$\n\\frac{\\hbar^2}{2 m_e} \\left( n \\frac{2\\pi}{a} \\right)^2 \\le E_{\\text{cut}} \\implies n^2 \\le \\frac{E_{\\text{cut}} a^2}{4\\pi^2 (\\hbar^2 / 2m_e)}\n$$\nThus, $N_{\\text{max}}(a, E_{\\text{cut}}) = \\left\\lfloor \\sqrt{\\frac{E_{\\text{cut}} a^2}{4\\pi^2 (\\hbar^2 / 2m_e)}} \\right\\rfloor$. The basis will consist of $G_n = nG_0$ for $n \\in \\{-N_{\\text{max}}, \\dots, N_{\\text{max}}\\}$. The size of the Hamiltonian matrix will be $(2N_{\\text{max}} + 1) \\times (2N_{\\text{max}} + 1)$. For the problem to be meaningful (i.e., to obtain at least two bands, $n_v=1$ and $n_c=2$), the matrix size must be at least $2 \\times 2$, which means $N_{\\text{max}} \\ge 1$. If a chosen $E_{\\text{cut}}$ results in $N_{\\text{max}} < 1$, the calculation for that cutoff is not performed as the required quantities are ill-defined.\n\nThe computational procedure is as follows:\n1.  For each lattice constant $a \\in \\{5.43, 5.30, 5.60\\}$ Å:\n    a. A uniform grid of $201$ wave numbers $k$ is generated in the range $[0, \\pi/a]$.\n    b. The reference values for the indirect gap, $\\Delta_{\\text{ind}}^{\\text{ref}}(a)$, and valence bandwidth, $W_v^{\\text{ref}}(a)$, are computed using a high reference cutoff $E_{\\text{ref}} = 80 \\text{ eV}$.\n    c. For each test cutoff $E_{\\text{cut}} \\in \\{4, 6, 8, 12, 16, 24, 32, 48\\}$ eV, the quantities $\\Delta_{\\text{ind}}(a; E_{\\text{cut}})$ and $W_v(a; E_{\\text{cut}})$ are computed. This involves:\n        i. Determining $N_{\\text{max}}$ for the given $a$ and $E_{\\text{cut}}$.\n        ii. For each $k$ on the grid, constructing the $(2N_{\\text{max}}+1) \\times (2N_{\\text{max}}+1)$ Hamiltonian matrix $H(k)$. The matrix is Hermitian (in this case, real and symmetric).\n        iii. Diagonalizing $H(k)$ to obtain its eigenvalues, which are the band energies $E_n(k)$. These are sorted in ascending order.\n        iv. After looping through all $k$, the valence bandwidth is calculated as $W_v = \\max_k E_1(k) - \\min_k E_1(k)$, and the indirect band gap as $\\Delta_{\\text{ind}} = \\min_k E_2(k) - \\max_k E_1(k)$.\n    d. The smallest $E_{\\text{cut}}$ from the test list is found such that the absolute error relative to the reference value is within tolerance: $|\\Delta_{\\text{ind}} - \\Delta_{\\text{ind}}^{\\text{ref}}| \\le \\varepsilon_{\\Delta}$ for the gap ($\\varepsilon_{\\Delta} = 0.01$ eV) and $|W_v - W_v^{\\text{ref}}| \\le \\varepsilon_W$ for the bandwidth ($\\varepsilon_W = 0.01$ eV). If no such cutoff exists in the list, $-1$ is reported.\n\nThis process is repeated for each of the three lattice constants, yielding six final values for the minimal converged energy cutoffs.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the convergence of indirect band gap and valence bandwidth\n    with respect to the plane-wave energy cutoff for a 1D crystal model.\n    \"\"\"\n    \n    # --- Givens from the problem statement ---\n    \n    # Physical and model parameters\n    HBAR2_2M = 3.8099819443  # eV·Å^2\n    V_G0 = -5.0  # eV\n    V_2G0 = +1.5  # eV\n    \n    # Test suite parameters\n    LATTICE_CONSTANTS = [5.43, 5.30, 5.60]  # in Å\n    ENERGY_CUTOFFS = [4, 6, 8, 12, 16, 24, 32, 48]  # in eV\n    E_REF = 80.0  # in eV\n    EPS_DELTA = 0.01  # Tolerance for indirect gap in eV\n    EPS_W = 0.01  # Tolerance for valence bandwidth in eV\n    K_POINTS = 201\n    \n    # Dictionary of potential components\n    # V_q = V_{-q} because V(x) is real\n    POTENTIAL_FOURIER = {\n        1: V_G0,\n        -1: V_G0,\n        2: V_2G0,\n        -2: V_2G0,\n    }\n\n    def calculate_properties(a, e_cut, k_grid):\n        \"\"\"\n        Calculates band structure properties for a given lattice constant and energy cutoff.\n        \"\"\"\n        g0 = 2 * np.pi / a\n        \n        # Determine the size of the plane-wave basis set\n        n_max_sq = (e_cut * a**2) / (4 * np.pi**2 * HBAR2_2M)\n        n_max = int(np.floor(np.sqrt(n_max_sq)))\n        \n        # The problem requires at least two bands. If basis size < 2, properties are undefined.\n        if 2 * n_max + 1 < 2:\n            return None, None\n            \n        n_values = np.arange(-n_max, n_max + 1)\n        matrix_size = len(n_values)\n        \n        e1_k = np.zeros(len(k_grid))\n        e2_k = np.zeros(len(k_grid))\n        \n        # Construct and diagonalize the Hamiltonian for each k-point\n        for i, k in enumerate(k_grid):\n            H = np.zeros((matrix_size, matrix_size), dtype=np.complex128)\n            \n            # Populate Hamiltonian matrix\n            for row in range(matrix_size):\n                for col in range(matrix_size):\n                    n_row = n_values[row]\n                    n_col = n_values[col]\n                    \n                    # Kinetic energy term (diagonal)\n                    if row == col:\n                        H[row, col] += HBAR2_2M * (k + n_row * g0)**2\n                    \n                    # Potential term (off-diagonal)\n                    n_diff = n_row - n_col\n                    if n_diff in POTENTIAL_FOURIER:\n                        H[row, col] += POTENTIAL_FOURIER[n_diff]\n            \n            # Diagonalize the Hermitian matrix to find eigenvalues (band energies)\n            eigenvalues = np.linalg.eigh(H)[0]\n            \n            # Store the first two bands (sorted by eigh)\n            e1_k[i] = eigenvalues[0]\n            e2_k[i] = eigenvalues[1]\n            \n        # Calculate valence bandwidth and indirect band gap\n        w_v = np.max(e1_k) - np.min(e1_k)\n        delta_ind = np.min(e2_k) - np.max(e1_k)\n        \n        return delta_ind, w_v\n\n    final_results = []\n    \n    for a in LATTICE_CONSTANTS:\n        k_grid = np.linspace(0, np.pi / a, K_POINTS)\n        \n        # 1. Calculate reference values with E_ref\n        delta_ref, w_v_ref = calculate_properties(a, E_REF, k_grid)\n\n        # Storage for results for the current lattice constant\n        cutoff_results = {}\n        \n        # 2. Calculate properties for each test E_cut\n        for e_cut in ENERGY_CUTOFFS:\n            delta, w_v = calculate_properties(a, float(e_cut), k_grid)\n            cutoff_results[e_cut] = (delta, w_v)\n            \n        # 3. Find the minimum E_cut satisfying the convergence criteria\n        min_e_cut_delta = -1.0\n        min_e_cut_w_v = -1.0\n        \n        for e_cut in sorted(cutoff_results.keys()):\n            delta, w_v = cutoff_results[e_cut]\n            \n            if delta is not None:\n                # Check convergence for indirect gap\n                if min_e_cut_delta == -1.0 and abs(delta - delta_ref) <= EPS_DELTA:\n                    min_e_cut_delta = float(e_cut)\n                \n                # Check convergence for valence bandwidth\n                if min_e_cut_w_v == -1.0 and abs(w_v - w_v_ref) <= EPS_W:\n                    min_e_cut_w_v = float(e_cut)\n\n        final_results.extend([min_e_cut_delta, min_e_cut_w_v])\n        \n    # 4. Format and print the final output\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The choice of exchange-correlation functional is a deciding factor in the predictive accuracy of DFT calculations, particularly for the band gaps of semiconductors. While standard approximations like PBE are computationally efficient, they often fail quantitatively, a shortcoming addressed by more sophisticated hybrid functionals like HSE06. This practice uses a simplified tight-binding model to build an intuitive bridge between the abstract theory of these functionals and their concrete effects on the electronic structure, allowing you to analytically explore how including a fraction of exact exchange systematically corrects the band gap and bandwidth .",
            "id": "3794763",
            "problem": "Consider an idealized crystalline semiconductor modeled at the atomistic scale by a one-dimensional diatomic chain. The chain consists of two inequivalent sublattices per primitive cell with on-site energies that differ by a staggered potential. The calculation of electronic band structures is to be performed within a minimal tight-binding framework that is consistent with the multiscale perspective, where coarse-grained corrections from different electronic structure theories are mapped onto effective parameters. The task is to compare the predicted band gaps and valence bandwidths for a given material using the Perdew–Burke–Ernzerhof (PBE) generalized gradient approximation and the Heyd–Scuseria–Ernzerhof 2006 (HSE06) screened hybrid functional, and to justify the differences based on the inclusion of exact exchange.\n\nFundamental base:\n- The single-particle Schrödinger equation in a periodic potential implies Bloch's theorem: eigenstates can be labeled by crystal momentum $k$ and expanded in a basis that respects lattice periodicity.\n- In a nearest-neighbor tight-binding model for a diatomic chain with a two-site basis, the Bloch Hamiltonian $H(k)$ is a $2 \\times 2$ Hermitian matrix constructed from the on-site energy difference and the hopping amplitude. Let the on-site energy asymmetry be denoted by $\\Delta$ (half the difference between the two sublattice site energies) and the positive nearest-neighbor hopping amplitude be $t$. The Hamiltonian can be written as\n$$\nH(k) = \\begin{pmatrix}\n\\Delta & 2 t \\cos\\left(\\frac{k a}{2}\\right) \\\\\n2 t \\cos\\left(\\frac{k a}{2}\\right) & -\\Delta\n\\end{pmatrix},\n$$\nwhere $a$ is the lattice constant and $k$ is the crystal momentum in the Brillouin zone. The eigenvalues of $H(k)$ define the valence and conduction band dispersions.\n\nHybrid functional mapping:\n- In the spirit of multiscale materials simulation, approximate the difference between PBE and HSE06 descriptions by renormalizing the effective tight-binding parameters due to exact exchange (Fock exchange) mixing. Denote by $\\alpha$ the fraction of short-range exact exchange mixed into the exchange-correlation energy in HSE06, by $K$ an effective screened on-site exchange integral (in electronvolts) that parameterizes the magnitude of exchange-induced level repulsion for localized orbitals, and by $s \\in [0,1]$ a dimensionless localization factor that encodes how strongly the valence and conduction states are localized on different sublattices. Furthermore, include a dimensionless parameter $\\beta \\in [0,1]$ that measures the sensitivity of the hopping amplitude to exchange-induced localization (bandwidth renormalization).\n- Use the following coarse-grained mapping from Perdew–Burke–Ernzerhof (PBE) to Heyd–Scuseria–Ernzerhof 2006 (HSE06) parameters:\n$$\n\\Delta_{\\mathrm{HSE}} = \\Delta_{\\mathrm{PBE}} + \\alpha \\, s \\, K, \\quad\nt_{\\mathrm{HSE}} = t_{\\mathrm{PBE}} \\, \\max\\!\\left(0, 1 - \\beta \\, \\alpha\\right),\n$$\nwhere $\\max(\\cdot)$ enforces a non-negative hopping consistent with physical stability.\n- Under each set of parameters $(\\Delta, t)$, define the direct band gap $E_g$ at the Brillouin zone boundary as the energy difference between the bottom of the conduction band and the top of the valence band, and define the valence bandwidth $W_v$ as the difference between the maximum and minimum energy of the valence band across the Brillouin zone.\n\nTasks:\n- For each specified test case, compute the band gap $E_g$ and the valence bandwidth $W_v$ using PBE parameters $(\\Delta_{\\mathrm{PBE}}, t_{\\mathrm{PBE}})$ and the corresponding HSE06-mapped parameters $(\\Delta_{\\mathrm{HSE}}, t_{\\mathrm{HSE}})$.\n- Express all energies in electronvolts (eV) and round numerical outputs to three decimal places.\n\nTest suite:\nUse the following set of parameter values, all energies in electronvolts and all dimensionless parameters unitless:\n$1.$ $(\\Delta_{\\mathrm{PBE}} = 0.8, \\; t_{\\mathrm{PBE}} = 1.5, \\; K = 2.0, \\; s = 0.6, \\; \\alpha = 0.25, \\; \\beta = 0.15)$\n$2.$ $(\\Delta_{\\mathrm{PBE}} = 0.0, \\; t_{\\mathrm{PBE}} = 1.2, \\; K = 1.5, \\; s = 0.5, \\; \\alpha = 0.25, \\; \\beta = 0.10)$\n$3.$ $(\\Delta_{\\mathrm{PBE}} = 3.0, \\; t_{\\mathrm{PBE}} = 0.5, \\; K = 3.0, \\; s = 0.7, \\; \\alpha = 0.25, \\; \\beta = 0.20)$\n$4.$ $(\\Delta_{\\mathrm{PBE}} = 1.2, \\; t_{\\mathrm{PBE}} = 1.0, \\; K = 2.5, \\; s = 0.6, \\; \\alpha = 0.0, \\; \\beta = 0.20)$\n\nAnswer specification and output format:\n- For each test case, return a list of four floats $[E_{g,\\mathrm{PBE}}, E_{g,\\mathrm{HSE}}, W_{v,\\mathrm{PBE}}, W_{v,\\mathrm{HSE}}]$, each value in eV rounded to three decimals.\n- Your program should produce a single line of output containing the results aggregated as a comma-separated list of these four-element lists enclosed in square brackets, for example $[[e_{11},e_{12},e_{13},e_{14}],[e_{21},e_{22},e_{23},\\ldots]$, with no additional text.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of solid-state physics, well-posed, and provides a complete and consistent set of data and definitions for calculation. The task is to compute the band gap and valence bandwidth for a one-dimensional diatomic tight-binding model and to compare the results from parameters corresponding to PBE and HSE06 electronic structure theories.\n\nFirst, we determine the electronic band structure by finding the eigenvalues of the provided Bloch Hamiltonian, $H(k)$. The Hamiltonian for a crystal momentum $k$ is given by:\n$$\nH(k) = \\begin{pmatrix}\n\\Delta & 2 t \\cos\\left(\\frac{k a}{2}\\right) \\\\\n2 t \\cos\\left(\\frac{k a}{2}\\right) & -\\Delta\n\\end{pmatrix}\n$$\nHere, $\\Delta$ represents the on-site energy asymmetry, $t$ is the nearest-neighbor hopping amplitude, and $a$ is the lattice constant. The eigenvalues $E(k)$ are found by solving the characteristic equation $\\det(H(k) - E \\cdot I) = 0$:\n$$\n(\\Delta - E)(-\\Delta - E) - \\left(2 t \\cos\\left(\\frac{k a}{2}\\right)\\right)^2 = 0\n$$\n$$\nE^2 - \\Delta^2 - 4 t^2 \\cos^2\\left(\\frac{k a}{2}\\right) = 0\n$$\nThis yields the energy dispersion relations for the two bands:\n$$\nE(k) = \\pm \\sqrt{\\Delta^2 + 4 t^2 \\cos^2\\left(\\frac{k a}{2}\\right)}\n$$\nThe positive root corresponds to the conduction band, $E_c(k)$, and the negative root corresponds to the valence band, $E_v(k)$.\n\nNext, we calculate the direct band gap, $E_g$, at the boundary of the first Brillouin zone. The first Brillouin zone spans $k \\in [-\\pi/a, \\pi/a]$, so its boundary is at $k = \\pm \\pi/a$. At this point, the argument of the cosine is $ka/2 = \\pm\\pi/2$, which makes $\\cos(ka/2) = 0$. Substituting this into the energy expressions:\n- Conduction band minimum: $E_{c, \\text{min}} = E_c(\\pm\\pi/a) = \\sqrt{\\Delta^2 + 0} = |\\Delta|$. Assuming $\\Delta \\ge 0$, this is $\\Delta$.\n- Valence band maximum: $E_{v, \\text{max}} = E_v(\\pm\\pi/a) = -\\sqrt{\\Delta^2 + 0} = -|\\Delta|$. Assuming $\\Delta \\ge 0$, this is $-\\Delta$.\nThe direct band gap at the zone boundary is the difference between these two energies:\n$$\nE_g = E_c(\\pm\\pi/a) - E_v(\\pm\\pi/a) = \\Delta - (-\\Delta) = 2\\Delta\n$$\n\nThen, we determine the valence bandwidth, $W_v$. This is the difference between the maximum and minimum energies of the valence band across the entire Brillouin zone. We have already found the maximum energy of the valence band, $E_{v, \\text{max}} = -\\Delta$, which occurs at the zone boundary $k = \\pm\\pi/a$. The minimum energy of the valence band occurs when the term under the square root is maximized. The function $\\cos^2(ka/2)$ is maximal at the Brillouin zone center, $k=0$, where $\\cos^2(0) = 1$. The minimum valence band energy is therefore:\n$$\nE_{v, \\text{min}} = E_v(0) = -\\sqrt{\\Delta^2 + 4t^2 \\cos^2(0)} = -\\sqrt{\\Delta^2 + 4t^2}\n$$\nThe valence bandwidth $W_v$ is then:\n$$\nW_v = E_{v, \\text{max}} - E_{v, \\text{min}} = (-\\Delta) - \\left(-\\sqrt{\\Delta^2 + 4t^2}\\right) = \\sqrt{\\Delta^2 + 4t^2} - \\Delta\n$$\n\nThe computational procedure for each test case is as follows:\n1. Use the given PBE parameters $(\\Delta_{\\mathrm{PBE}}, t_{\\mathrm{PBE}})$ to calculate $E_{g,\\mathrm{PBE}}$ and $W_{v,\\mathrm{PBE}}$ using the derived formulas:\n   $$E_{g,\\mathrm{PBE}} = 2\\Delta_{\\mathrm{PBE}}$$\n   $$W_{v,\\mathrm{PBE}} = \\sqrt{\\Delta_{\\mathrm{PBE}}^2 + 4t_{\\mathrm{PBE}}^2} - \\Delta_{\\mathrm{PBE}}$$\n2. Compute the HSE06-mapped parameters using the coarse-grained relations:\n   $$\\Delta_{\\mathrm{HSE}} = \\Delta_{\\mathrm{PBE}} + \\alpha s K$$\n   $$t_{\\mathrm{HSE}} = t_{\\mathrm{PBE}} \\max(0, 1 - \\beta \\alpha)$$\n3. Use the calculated HSE06 parameters $(\\Delta_{\\mathrm{HSE}}, t_{\\mathrm{HSE}})$ to find $E_{g,\\mathrm{HSE}}$ and $W_{v,\\mathrm{HSE}}$:\n   $$E_{g,\\mathrm{HSE}} = 2\\Delta_{\\mathrm{HSE}}$$\n   $$W_{v,\\mathrm{HSE}} = \\sqrt{\\Delta_{\\mathrm{HSE}}^2 + 4t_{\\mathrm{HSE}}^2} - \\Delta_{\\mathrm{HSE}}$$\n\nThe physical justification for the trends observed when going from PBE to HSE06 is rooted in the inclusion of exact exchange.\n- **Band Gap Increase**: The PBE functional, a generalized gradient approximation (GGA), is known to suffer from self-interaction error, which artificially delocalizes electronic wavefunctions and systematically underestimates band gaps. The HSE06 hybrid functional corrects this by mixing a fraction $\\alpha$ of exact Hartree-Fock-like exchange. This correction tends to localize electronic states and increases the energy splitting between occupied and unoccupied levels. In our model, this is represented by an increase in the on-site energy asymmetry, $\\Delta_{\\mathrm{HSE}} > \\Delta_{\\mathrm{PBE}}$, because the term $\\alpha s K$ is non-negative. As $E_g = 2\\Delta$, the band gap necessarily increases or remains the same ($E_{g,\\mathrm{HSE}} \\ge E_{g,\\mathrm{PBE}}$).\n- **Bandwidth Decrease**: The hopping parameter $t$ governs the delocalization and width of the energy bands. The same localization effect from exact exchange that widens the gap also reduces the spatial overlap between orbitals on adjacent sites. This leads to a smaller effective hopping amplitude, so $t_{\\mathrm{HSE}} \\le t_{\\mathrm{PBE}}$. The valence bandwidth $W_v = \\sqrt{\\Delta^2 + 4t^2} - \\Delta$ decreases for two reasons: a smaller $t$ reduces the overall band dispersion, and a larger $\\Delta$ flattens the band. Both effects contribute to $W_{v, \\mathrm{HSE}} \\le W_{v, \\mathrm{PBE}}$.\n\nThese principles are applied to each test case to generate the final numerical results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates band gaps and valence bandwidths for a 1D diatomic chain model\n    using PBE and HSE06 effective parameters.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (Delta_pbe, t_pbe, K, s, alpha, beta)\n    test_cases = [\n        (0.8, 1.5, 2.0, 0.6, 0.25, 0.15),\n        (0.0, 1.2, 1.5, 0.5, 0.25, 0.10),\n        (3.0, 0.5, 3.0, 0.7, 0.25, 0.20),\n        (1.2, 1.0, 2.5, 0.6, 0.0, 0.20),\n    ]\n\n    def calculate_properties(delta, t):\n        \"\"\"\n        Calculates band gap and valence bandwidth from tight-binding parameters.\n        \n        Args:\n            delta (float): On-site energy asymmetry.\n            t (float): Hopping amplitude.\n        \n        Returns:\n            tuple: A tuple containing (band_gap, valence_bandwidth).\n        \"\"\"\n        # Band gap Eg = 2*Delta\n        band_gap = 2 * delta\n        \n        # Valence bandwidth Wv = sqrt(Delta^2 + 4*t^2) - Delta\n        valence_bandwidth = np.sqrt(delta**2 + 4 * t**2) - delta\n        \n        return band_gap, valence_bandwidth\n\n    all_results = []\n    for case in test_cases:\n        delta_pbe, t_pbe, K, s, alpha, beta = case\n        \n        # 1. PBE calculations\n        eg_pbe, wv_pbe = calculate_properties(delta_pbe, t_pbe)\n        \n        # 2. Calculate HSE06 parameters from PBE parameters\n        delta_hse = delta_pbe + alpha * s * K\n        t_hse = t_pbe * max(0, 1 - beta * alpha)\n        \n        # 3. HSE06 calculations\n        eg_hse, wv_hse = calculate_properties(delta_hse, t_hse)\n        \n        # 4. Store the results for this case\n        case_results = [eg_pbe, eg_hse, wv_pbe, wv_hse]\n        all_results.append(case_results)\n\n    # Format the final output string as specified: [[r11,r12,...],[r21,r22,...]]\n    # with no spaces and three decimal places for each number.\n    formatted_case_results = []\n    for result_set in all_results:\n        # Format each number to 3 decimal places\n        inner_list_str = '[' + ','.join([f'{val:.3f}' for val in result_set]) + ']'\n        formatted_case_results.append(inner_list_str)\n        \n    final_output_string = '[' + ','.join(formatted_case_results) + ']'\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}