{
    "hands_on_practices": [
        {
            "introduction": "为了计算和可视化能带结构，我们通常沿着第一布里渊区中的高对称性路径进行。这个基础练习旨在阐明正空间基矢和倒空间基矢之间的对偶关系，并实践如何在不同坐标系之间转换高对称点（k点）的坐标。掌握这种转换为任何实际的能带结构计算设置了必要的第一步。",
            "id": "3794761",
            "problem": "考虑两种三维Bravais晶格，其常规立方晶格常数均为$a$：面心立方（fcc）晶格和体心立方（bcc）晶格。晶体固体的电子能带结构是沿着其第一布里渊区（FBZ）中连接特殊点的高对称性路径计算的。这些特殊点由第一布里渊区的对称性确定，并且当用常规倒易立方基矢 $\\{(2\\pi/a)\\,\\hat{\\mathbf{x}},(2\\pi/a)\\,\\hat{\\mathbf{y}},(2\\pi/a)\\,\\hat{\\mathbf{z}}\\}$ 表示时，具有广泛接受的笛卡尔坐标。\n\n从以下基本定义出发：\n- 对于fcc，原胞直晶格矢量 $\\{\\mathbf{a}_{i}\\}$ 可选择为 $\\mathbf{a}_{1}=\\frac{a}{2}(0,1,1)$，$\\mathbf{a}_{2}=\\frac{a}{2}(1,0,1)$，$\\mathbf{a}_{3}=\\frac{a}{2}(1,1,0)$；对于bcc，可选择为 $\\mathbf{a}_{1}=\\frac{a}{2}(1,1,-1)$，$\\mathbf{a}_{2}=\\frac{a}{2}(1,-1,1)$，$\\mathbf{a}_{3}=\\frac{a}{2}(-1,1,1)$。\n- 原胞倒晶格矢量 $\\{\\mathbf{b}_{i}\\}$ 由 $\\mathbf{b}_{i}\\cdot\\mathbf{a}_{j}=2\\pi\\,\\delta_{ij}$ 定义，其中 $i,j\\in\\{1,2,3\\}$。\n\n使用以上信息，显式地构建原胞倒易基矢 $\\{\\mathbf{b}_{i}^{\\text{(fcc)}}\\}$ 和 $\\{\\mathbf{b}_{i}^{\\text{(bcc)}}\\}$。然后，使用经过充分检验的常规笛卡尔分数坐标（在基矢 $\\{(2\\pi/a)\\,\\hat{\\mathbf{x}},(2\\pi/a)\\,\\hat{\\mathbf{y}},(2\\pi/a)\\,\\hat{\\mathbf{z}}\\}$ 中）表示的标准高对称点：\n- 对于 fcc：$\\Gamma=(0,0,0)$，$X=(0,1,0)$，$L=\\left(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2}\\right)$，$W=\\left(\\frac{1}{2},1,0\\right)$，$K=\\left(\\frac{3}{4},\\frac{3}{4},0\\right)$。\n- 对于 bcc：$\\Gamma=(0,0,0)$，$H=(1,0,0)$，$N=\\left(0,\\frac{1}{2},0\\right)$，$P=\\left(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2}\\right)$。\n\n计算这些点在各自原胞倒易基矢中的无量纲坐标，即，对于fcc和bcc中的每个所列点，找到 $(c_{1},c_{2},c_{3})$ 使得 $\\mathbf{k}=c_{1}\\mathbf{b}_{1}+c_{2}\\mathbf{b}_{2}+c_{3}\\mathbf{b}_{3}$。将您的最终答案表示为一个单行矩阵，按顺序包含每个点的三个分量：\n- fcc 按 $\\Gamma$、$X$、$L$、$W$、$K$ 的顺序，\n- bcc 按 $\\Gamma$、$H$、$N$、$P$ 的顺序。\n\n无需四舍五入；将所有条目表示为精确的有理数。这些条目是无量纲的，并且必须以各自的 $\\mathbf{b}_{i}$ 为单位给出。",
            "solution": "该问题提法明确，具有科学依据，并包含唯一解所需的所有信息。我们可以开始计算。\n\n该问题要求计算第一布里渊区（FBZ）中各个高对称点 $\\mathbf{k}$ 相对于原胞倒晶格基矢 $\\{\\mathbf{b}_1, \\mathbf{b}_2, \\mathbf{b}_3\\}$ 的坐标 $(c_1, c_2, c_3)$。其关系由下式给出：\n$$ \\mathbf{k} = c_1\\mathbf{b}_1 + c_2\\mathbf{b}_2 + c_3\\mathbf{b}_3 $$\n\n原胞倒晶格矢量 $\\mathbf{b}_i$ 通过它们与原胞直晶格矢量 $\\mathbf{a}_j$ 的关系来定义：\n$$ \\mathbf{b}_i \\cdot \\mathbf{a}_j = 2\\pi \\delta_{ij} $$\n其中 $\\delta_{ij}$ 是克罗内克δ函数。\n\n为了求出系数 $c_j$，我们可以将 $\\mathbf{k}$ 的表达式与直晶格矢量 $\\mathbf{a}_j$ 作点积：\n$$ \\mathbf{k} \\cdot \\mathbf{a}_j = (c_1\\mathbf{b}_1 + c_2\\mathbf{b}_2 + c_3\\mathbf{b}_3) \\cdot \\mathbf{a}_j $$\n$$ \\mathbf{k} \\cdot \\mathbf{a}_j = c_1(\\mathbf{b}_1 \\cdot \\mathbf{a}_j) + c_2(\\mathbf{b}_2 \\cdot \\mathbf{a}_j) + c_3(\\mathbf{b}_3 \\cdot \\mathbf{a}_j) $$\n利用正交条件，上式可简化为：\n$$ \\mathbf{k} \\cdot \\mathbf{a}_j = c_j (2\\pi) $$\n因此，系数可以直接计算为：\n$$ c_j = \\frac{\\mathbf{k} \\cdot \\mathbf{a}_j}{2\\pi} $$\n这种方法避免了对 $\\mathbf{b}_i$ 矢量的显式计算，尽管这样的计算可以证实fcc直晶格对应于bcc倒晶格，反之亦然。\n\n问题中给出了高对称点的坐标，此处记为 $(k'_x, k'_y, k'_z)$，它们是在常规倒易立方基矢 $\\{(2\\pi/a)\\,\\hat{\\mathbf{x}},(2\\pi/a)\\,\\hat{\\mathbf{y}},(2\\pi/a)\\,\\hat{\\mathbf{z}}\\}$ 中表示的。因此，矢量 $\\mathbf{k}$ 由下式给出：\n$$ \\mathbf{k} = \\frac{2\\pi}{a} (k'_x, k'_y, k'_z) $$\n\n将此代入 $c_j$ 的公式中：\n$$ c_j = \\frac{1}{2\\pi} \\left( \\frac{2\\pi}{a} (k'_x, k'_y, k'_z) \\right) \\cdot \\mathbf{a}_j = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\mathbf{a}_j $$\n\n我们现在将此通用公式分别应用于fcc和bcc晶格。\n\n**1. 面心立方（fcc）晶格**\n\nfcc的原胞直晶格矢量为：\n$$ \\mathbf{a}_1^{(\\text{fcc})} = \\frac{a}{2}(0,1,1), \\quad \\mathbf{a}_2^{(\\text{fcc})} = \\frac{a}{2}(1,0,1), \\quad \\mathbf{a}_3^{(\\text{fcc})} = \\frac{a}{2}(1,1,0) $$\n\n使用推导出的 $c_j$ 公式，我们得到fcc晶格的具体变换方程：\n$$ c_1 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(0,1,1) = \\frac{1}{2}(k'_y + k'_z) $$\n$$ c_2 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,0,1) = \\frac{1}{2}(k'_x + k'_z) $$\n$$ c_3 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,1,0) = \\frac{1}{2}(k'_x + k'_y) $$\n\n我们现在为每个指定的fcc高对称点计算坐标 $(c_1, c_2, c_3)$：\n- **$\\Gamma=(0,0,0)$**：$(k'_x,k'_y,k'_z)=(0,0,0)$。\n  $c_1 = \\frac{1}{2}(0+0) = 0$, $c_2 = \\frac{1}{2}(0+0) = 0$, $c_3 = \\frac{1}{2}(0+0) = 0$。坐标：$(0,0,0)$。\n- **$X=(0,1,0)$**：$(k'_x,k'_y,k'_z)=(0,1,0)$。\n  $c_1 = \\frac{1}{2}(1+0) = \\frac{1}{2}$, $c_2 = \\frac{1}{2}(0+0) = 0$, $c_3 = \\frac{1}{2}(0+1) = \\frac{1}{2}$。坐标：$(\\frac{1}{2},0,\\frac{1}{2})$。\n- **$L=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$**：$(k'_x,k'_y,k'_z)=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$。\n  $c_1 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{2}$, $c_2 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{2}$, $c_3 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{2}$。坐标：$(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$。\n- **$W=(\\frac{1}{2},1,0)$**：$(k'_x,k'_y,k'_z)=(\\frac{1}{2},1,0)$。\n  $c_1 = \\frac{1}{2}(1+0) = \\frac{1}{2}$, $c_2 = \\frac{1}{2}(\\frac{1}{2}+0) = \\frac{1}{4}$, $c_3 = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$。坐标：$(\\frac{1}{2},\\frac{1}{4},\\frac{3}{4})$。\n- **$K=(\\frac{3}{4},\\frac{3}{4},0)$**：$(k'_x,k'_y,k'_z)=(\\frac{3}{4},\\frac{3}{4},0)$。\n  $c_1 = \\frac{1}{2}(\\frac{3}{4}+0) = \\frac{3}{8}$, $c_2 = \\frac{1}{2}(\\frac{3}{4}+0) = \\frac{3}{8}$, $c_3 = \\frac{1}{2}(\\frac{3}{4}+\\frac{3}{4}) = \\frac{3}{4}$。坐标：$(\\frac{3}{8},\\frac{3}{8},\\frac{3}{4})$。\n\n**2. 体心立方（bcc）晶格**\n\nbcc的原胞直晶格矢量为：\n$$ \\mathbf{a}_1^{(\\text{bcc})} = \\frac{a}{2}(1,1,-1), \\quad \\mathbf{a}_2^{(\\text{bcc})} = \\frac{a}{2}(1,-1,1), \\quad \\mathbf{a}_3^{(\\text{bcc})} = \\frac{a}{2}(-1,1,1) $$\n\nbcc晶格的具体变换方程是：\n$$ c_1 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,1,-1) = \\frac{1}{2}(k'_x + k'_y - k'_z) $$\n$$ c_2 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,-1,1) = \\frac{1}{2}(k'_x - k'_y + k'_z) $$\n$$ c_3 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(-1,1,1) = \\frac{1}{2}(-k'_x + k'_y + k'_z) $$\n\n我们现在为每个指定的bcc高对称点计算坐标 $(c_1, c_2, c_3)$：\n- **$\\Gamma=(0,0,0)$**：$(k'_x,k'_y,k'_z)=(0,0,0)$。\n  $c_1=0$, $c_2=0$, $c_3=0$。坐标：$(0,0,0)$。\n- **$H=(1,0,0)$**：$(k'_x,k'_y,k'_z)=(1,0,0)$。\n  $c_1 = \\frac{1}{2}(1+0-0) = \\frac{1}{2}$, $c_2 = \\frac{1}{2}(1-0+0) = \\frac{1}{2}$, $c_3 = \\frac{1}{2}(-1+0+0) = -\\frac{1}{2}$。坐标：$(\\frac{1}{2},\\frac{1}{2},-\\frac{1}{2})$。\n- **$N=(0,\\frac{1}{2},0)$**：$(k'_x,k'_y,k'_z)=(0,\\frac{1}{2},0)$。\n  $c_1 = \\frac{1}{2}(0+\\frac{1}{2}-0) = \\frac{1}{4}$, $c_2 = \\frac{1}{2}(0-\\frac{1}{2}+0) = -\\frac{1}{4}$, $c_3 = \\frac{1}{2}(0+\\frac{1}{2}+0) = \\frac{1}{4}$。坐标：$(\\frac{1}{4},-\\frac{1}{4},\\frac{1}{4})$。\n- **$P=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$**：$(k'_x,k'_y,k'_z)=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$。\n  $c_1 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}-\\frac{1}{2}) = \\frac{1}{4}$, $c_2 = \\frac{1}{2}(\\frac{1}{2}-\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{4}$, $c_3 = \\frac{1}{2}(-\\frac{1}{2}+\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{4}$。坐标：$(\\frac{1}{4},\\frac{1}{4},\\frac{1}{4})$。\n\n计算结果均为所要求的精确有理数。我们将它们按指定顺序合并成一个单行矩阵。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0  0  0  \\frac{1}{2}  0  \\frac{1}{2}  \\frac{1}{2}  \\frac{1}{2}  \\frac{1}{2}  \\frac{1}{2}  \\frac{1}{4}  \\frac{3}{4}  \\frac{3}{8}  \\frac{3}{8}  \\frac{3}{4}  0  0  0  \\frac{1}{2}  \\frac{1}{2}  -\\frac{1}{2}  \\frac{1}{4}  -\\frac{1}{4}  \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{4} \\end{pmatrix} } $$"
        },
        {
            "introduction": "从理论转向计算实践，任何基于平面波的计算都必须截断无限的基组，而截断能（$E_{\\text{cut}}$）的选择是决定计算精度的关键参数。这个动手编程练习模拟了执行收敛性测试的核心过程，以确保计算出的物理性质（如带隙和带宽）是可靠且具有物理意义的。通过这个练习，你将深入理解数值参数对模拟结果的影响。",
            "id": "3739438",
            "problem": "考虑一个一维周期势模型，该模型旨在定性地模拟硅的电子结构特征，同时在平面波基组下保持计算上的易处理性。该系统由质量为 $m_e$ 的电子在晶格常数为 $a$ 的周期势 $V(x)$ 中运动的单粒子不含时薛定谔方程所描述，其表达式为 $-\\frac{\\hbar^2}{2 m_e} \\frac{d^2}{dx^2} \\psi(x) + V(x) \\psi(x) = E \\psi(x)$。根据 Bloch 定理，本征态可以写成 $\\psi_{n,k}(x) = e^{i k x} u_{n,k}(x)$ 的形式，其中 $u_{n,k}(x)$ 具有晶格的周期性。在平面波中展开，可得到一个在倒易空间中的矩阵哈密顿量，其索引为倒格矢 $G$ 和 $G'$：\n$$\nH_{G,G'}(k) = \\delta_{G,G'} \\left( \\frac{\\hbar^2}{2 m_e} \\left| k + G \\right|^2 \\right) + V_{G - G'}\n$$\n其中 $V_{q}$ 是周期势的傅里叶分量，$\\delta_{G,G'}$ 是克罗内克符号。倒格矢为 $G = n G_0$，其中 $n \\in \\mathbb{Z}$ 且 $G_0 = \\frac{2 \\pi}{a}$。在本问题中，使用一个由两个非零傅里叶分量 $V_{G_0}$ 和 $V_{2 G_0}$ 指定的可移植局域赝势，而其他 $V_{q} = 0$。对于所有体积，取 $V_{G_0} = -5.0$ eV 和 $V_{2 G_0} = +1.5$ eV，这构成了一个旨在模拟间接带隙的打开和有限价带宽度的模型，让人联想到硅。使用物理常数 $\\frac{\\hbar^2}{2 m_e} = 3.8099819443$ eV·Å$^2$。\n\n为了反映平面波基组的截断，施加一个动能截断 $E_{\\text{cut}}$，方法是只包括那些在 $k = 0$ 时的自由电子动能满足 $\\frac{\\hbar^2}{2 m_e} G^2 \\le E_{\\text{cut}}$ 的倒格矢 $G$。对于每个选定的 $E_{\\text{cut}}$，在第一布里渊区从 $0$ 到 $\\pi/a$ 的均匀波矢 $k$ 网格上构建哈密顿量 $H(k)$，对 $H(k)$ 进行对角化以获得能带能量 $E_n(k)$（按升序排序），并定义价带为 $n_v = 1$、导带为 $n_c = 2$。这种索引方式对应于一个物理上合理的假设，即在一维绝缘体的近自由电子近似中，第一和第二能带之间存在一个主带隙。价带宽度为 $W_v = \\max_k E_{n_v}(k) - \\min_k E_{n_v}(k)$，间接带隙为 $\\Delta_{\\text{ind}} = \\min_k E_{n_c}(k) - \\max_k E_{n_v}(k)$，能量以电子伏特表示。\n\n您的任务是计算 $\\Delta_{\\text{ind}}$ 和 $W_v$ 相对于 $E_{\\text{cut}}$ 的收敛性，并通过在不同晶格常数 $a$ 下重复分析来评估赝势在不同体积下的可移植性。使用以下测试套件：\n\n- 晶格常数 (Å)：$a_1 = 5.43$，$a_2 = 5.30$，$a_3 = 5.60$。\n- 待测试的能量截断 (eV)：$E_{\\text{cut}} \\in \\{ 4, 6, 8, 12, 16, 24, 32, 48 \\}$。\n- 参考能量截断 (eV)：$E_{\\text{ref}} = 80$。\n- 容差 (eV)：间接带隙为 $\\varepsilon_{\\Delta} = 0.01$，价带宽度为 $\\varepsilon_W = 0.01$。\n- 波矢网格：在 $[0, \\pi/a]$ 区间内均匀采样 $201$ 个 $k$ 点。\n\n对于每个晶格常数 $a$，使用 $E_{\\text{ref}}$ 计算参考值 $\\Delta_{\\text{ind}}^{\\text{ref}}(a)$ 和 $W_v^{\\text{ref}}(a)$。然后，对于测试列表中的每个 $E_{\\text{cut}}$，计算 $\\Delta_{\\text{ind}}(a; E_{\\text{cut}})$ 和 $W_v(a; E_{\\text{cut}})$，并确定使 $\\left| \\Delta_{\\text{ind}}(a; E_{\\text{cut}}) - \\Delta_{\\text{ind}}^{\\text{ref}}(a) \\right| \\le \\varepsilon_{\\Delta}$ 成立的最小 $E_{\\text{cut}}$ 和使 $\\left| W_v(a; E_{\\text{cut}}) - W_v^{\\text{ref}}(a) \\right| \\le \\varepsilon_W$ 成立的最小 $E_{\\text{cut}}$。如果在给定 $a$ 的情况下，测试列表中的某个属性没有任何 $E_{\\text{cut}}$ 满足容差，则该条目报告为 $-1$。能量和截断值的单位是电子伏特 (eV)，距离单位是埃 (Å)。波矢 $k$ 的单位是倒埃 (Å$^{-1}$)。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。该列表必须按以下顺序包含六个数字：在 $a_1$ 时的间接带隙的最小 $E_{\\text{cut}}$，在 $a_1$ 时的价带宽度的最小 $E_{\\text{cut}}$，然后是 $a_2$ 对应的两个值，接着是 $a_3$ 对应的两个值。例如，输出格式必须类似于 $[x_1, y_1, x_2, y_2, x_3, y_3]$，其中每个 $x_i$ 和 $y_i$ 都是以 eV 为单位的浮点数。",
            "solution": "该问题要求计算一维周期性体系的间接带隙和价带宽度，并研究它们相对于平面波能量截断参数 $E_{\\text{cut}}$ 的收敛性。这是计算材料科学中的一个标准流程，用以确保模拟结果的可靠性。该分析将在三个不同的晶格常数 $a$ 下进行，以评估所提供赝势的可移植性。\n\n该问题的基础是质量为 $m_e$ 的电子在周期势 $V(x)$ 中的不含时单粒子薛定谔方程：\n$$\n\\left[ -\\frac{\\hbar^2}{2 m_e} \\frac{d^2}{dx^2} + V(x) \\right] \\psi(x) = E \\psi(x)\n$$\n由于势的周期性 $V(x) = V(x+a)$，Bloch 定理指出，本征态可以写成 $\\psi_{n,k}(x) = e^{ikx} u_{n,k}(x)$ 的形式，其中 $u_{n,k}(x)$ 是一个具有相同晶格周期性的周期函数，而 $k$ 是限制在第一布里渊区内的波矢，对于一维晶格，该区域为 $[-\\pi/a, \\pi/a]$。\n\n周期函数 $u_{n,k}(x)$ 可以在倒格矢 $G = n G_0$（其中 $G_0 = 2\\pi/a$ 且 $n \\in \\mathbb{Z}$）上展开为傅里叶级数：\n$$\nu_{n,k}(x) = \\sum_{G} c_{k,G} e^{iGx}\n$$\n将此代入薛定谔方程，会得到一个倒易空间中的本征值问题。哈密顿量变成一个矩阵，其元素由倒格矢 $G$ 和 $G'$ 索引：\n$$\nH_{G,G'}(k) = \\delta_{G,G'} \\left( \\frac{\\hbar^2}{2 m_e} |k+G|^2 \\right) + V_{G-G'}\n$$\n这里，$\\delta_{G,G'}$ 是克罗内克符号，$V_{G-G'}$ 是势 $V(x)$ 的傅里叶系数。对于一个物理的、实的势 $V(x)$，其傅里叶系数必须满足 $V_q = V_{-q}^*$。问题给出了 $V_q$ 的实数值，这意味着 $V_q = V_{-q}$。我们已知两个非零势分量：$V_{G_0} = -5.0 \\text{ eV}$ 和 $V_{2G_0} = +1.5 \\text{ eV}$。因此我们假设 $V_{-G_0} = V_{G_0}$ 和 $V_{-2G_0} = V_{2G_0}$。所有其他分量，包括 $V_0$，均为零。常数 $\\frac{\\hbar^2}{2m_e}$ 给定为 $3.8099819443 \\text{ eV} \\cdot \\text{Å}^2$。\n\n在任何实际计算中，对 $G$ 的无限求和都必须被截断。问题指定了一种动能截断方案：基组只包括那些在 $k=0$ 时的自由电子动能低于某个截断值 $E_{\\text{cut}}$ 的倒格矢 $G$。\n$$\n\\frac{\\hbar^2}{2 m_e} G^2 \\le E_{\\text{cut}}\n$$\n代入 $G = n G_0 = n \\frac{2\\pi}{a}$，我们可以找到基组的最大整数 $N_{\\text{max}}$：\n$$\n\\frac{\\hbar^2}{2 m_e} \\left( n \\frac{2\\pi}{a} \\right)^2 \\le E_{\\text{cut}} \\implies n^2 \\le \\frac{E_{\\text{cut}} a^2}{4\\pi^2 (\\hbar^2 / 2m_e)}\n$$\n因此，$N_{\\text{max}}(a, E_{\\text{cut}}) = \\left\\lfloor \\sqrt{\\frac{E_{\\text{cut}} a^2}{4\\pi^2 (\\hbar^2 / 2m_e)}} \\right\\rfloor$。基组将由 $G_n = nG_0$ 组成，其中 $n \\in \\{-N_{\\text{max}}, \\dots, N_{\\text{max}}\\}$。哈密顿矩阵的大小将是 $(2N_{\\text{max}} + 1) \\times (2N_{\\text{max}} + 1)$。为使问题有意义（即至少获得两个能带，$n_v=1$ 和 $n_c=2$），矩阵大小必须至少为 $2 \\times 2$，这意味着 $N_{\\text{max}} \\ge 1$。如果某个选定的 $E_{\\text{cut}}$ 导致 $N_{\\text{max}}  1$，则不进行该截断值的计算，因为所需的量是未定义的。\n\n计算步骤如下：\n1.  对于每个晶格常数 $a \\in \\{5.43, 5.30, 5.60\\}$ Å：\n    a. 在 $[0, \\pi/a]$ 范围内生成一个包含 $201$ 个点的均匀波矢 $k$ 网格。\n    b. 使用一个高的参考截断值 $E_{\\text{ref}} = 80 \\text{ eV}$ 计算间接带隙 $\\Delta_{\\text{ind}}^{\\text{ref}}(a)$ 和价带宽度 $W_v^{\\text{ref}}(a)$ 的参考值。\n    c. 对于每个测试截断值 $E_{\\text{cut}} \\in \\{4, 6, 8, 12, 16, 24, 32, 48\\}$ eV，计算 $\\Delta_{\\text{ind}}(a; E_{\\text{cut}})$ 和 $W_v(a; E_{\\text{cut}})$。这包括：\n        i.  根据给定的 $a$ 和 $E_{\\text{cut}}$ 确定 $N_{\\text{max}}$。\n        ii. 对于网格上的每个 $k$，构建 $(2N_{\\text{max}}+1) \\times (2N_{\\text{max}}+1)$ 的哈密顿矩阵 $H(k)$。该矩阵是厄米矩阵（在本例中为实对称矩阵）。\n        iii. 对角化 $H(k)$ 以获得其本征值，即能带能量 $E_n(k)$。这些值按升序排序。\n        iv. 遍历所有 $k$ 后，价带宽度计算为 $W_v = \\max_k E_1(k) - \\min_k E_1(k)$，间接带隙计算为 $\\Delta_{\\text{ind}} = \\min_k E_2(k) - \\max_k E_1(k)$。\n    d. 从测试列表中找到最小的 $E_{\\text{cut}}$，使得与参考值的绝对误差在容差范围内：对于带隙，满足 $|\\Delta_{\\text{ind}} - \\Delta_{\\text{ind}}^{\\text{ref}}| \\le \\varepsilon_{\\Delta}$（$\\varepsilon_{\\Delta} = 0.01$ eV）；对于带宽度，满足 $|W_v - W_v^{\\text{ref}}| \\le \\varepsilon_W$（$\\varepsilon_W = 0.01$ eV）。如果列表中没有这样的截断值，则报告 $-1$。\n\n对三个晶格常数中的每一个重复此过程，最终得到六个关于最小收敛能量截断值的结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the convergence of indirect band gap and valence bandwidth\n    with respect to the plane-wave energy cutoff for a 1D crystal model.\n    \"\"\"\n    \n    # --- Givens from the problem statement ---\n    \n    # Physical and model parameters\n    HBAR2_2M = 3.8099819443  # eV·Å^2\n    V_G0 = -5.0  # eV\n    V_2G0 = +1.5  # eV\n    \n    # Test suite parameters\n    LATTICE_CONSTANTS = [5.43, 5.30, 5.60]  # in Å\n    ENERGY_CUTOFFS = [4, 6, 8, 12, 16, 24, 32, 48]  # in eV\n    E_REF = 80.0  # in eV\n    EPS_DELTA = 0.01  # Tolerance for indirect gap in eV\n    EPS_W = 0.01  # Tolerance for valence bandwidth in eV\n    K_POINTS = 201\n    \n    # Dictionary of potential components\n    # V_q = V_{-q} because V(x) is real\n    POTENTIAL_FOURIER = {\n        1: V_G0,\n        -1: V_G0,\n        2: V_2G0,\n        -2: V_2G0,\n    }\n\n    def calculate_properties(a, e_cut, k_grid):\n        \"\"\"\n        Calculates band structure properties for a given lattice constant and energy cutoff.\n        \"\"\"\n        g0 = 2 * np.pi / a\n        \n        # Determine the size of the plane-wave basis set\n        n_max_sq = (e_cut * a**2) / (4 * np.pi**2 * HBAR2_2M)\n        n_max = int(np.floor(np.sqrt(n_max_sq)))\n        \n        # The problem requires at least two bands. If basis size  2, properties are undefined.\n        if 2 * n_max + 1  2:\n            return None, None\n            \n        n_values = np.arange(-n_max, n_max + 1)\n        matrix_size = len(n_values)\n        \n        e1_k = np.zeros(len(k_grid))\n        e2_k = np.zeros(len(k_grid))\n        \n        # Construct and diagonalize the Hamiltonian for each k-point\n        for i, k in enumerate(k_grid):\n            H = np.zeros((matrix_size, matrix_size), dtype=np.complex128)\n            \n            # Populate Hamiltonian matrix\n            for row in range(matrix_size):\n                for col in range(matrix_size):\n                    n_row = n_values[row]\n                    n_col = n_values[col]\n                    \n                    # Kinetic energy term (diagonal)\n                    if row == col:\n                        H[row, col] += HBAR2_2M * (k + n_row * g0)**2\n                    \n                    # Potential term (off-diagonal)\n                    n_diff = n_row - n_col\n                    if n_diff in POTENTIAL_FOURIER:\n                        H[row, col] += POTENTIAL_FOURIER[n_diff]\n            \n            # Diagonalize the Hermitian matrix to find eigenvalues (band energies)\n            eigenvalues = np.linalg.eigh(H)[0]\n            \n            # Store the first two bands (sorted by eigh)\n            e1_k[i] = eigenvalues[0]\n            e2_k[i] = eigenvalues[1]\n            \n        # Calculate valence bandwidth and indirect band gap\n        w_v = np.max(e1_k) - np.min(e1_k)\n        delta_ind = np.min(e2_k) - np.max(e1_k)\n        \n        return delta_ind, w_v\n\n    final_results = []\n    \n    for a in LATTICE_CONSTANTS:\n        k_grid = np.linspace(0, np.pi / a, K_POINTS)\n        \n        # 1. Calculate reference values with E_ref\n        delta_ref, w_v_ref = calculate_properties(a, E_REF, k_grid)\n\n        # Storage for results for the current lattice constant\n        cutoff_results = {}\n        \n        # 2. Calculate properties for each test E_cut\n        for e_cut in ENERGY_CUTOFFS:\n            delta, w_v = calculate_properties(a, float(e_cut), k_grid)\n            cutoff_results[e_cut] = (delta, w_v)\n            \n        # 3. Find the minimum E_cut satisfying the convergence criteria\n        min_e_cut_delta = -1.0\n        min_e_cut_w_v = -1.0\n        \n        for e_cut in sorted(cutoff_results.keys()):\n            delta, w_v = cutoff_results[e_cut]\n            \n            if delta is not None:\n                # Check convergence for indirect gap\n                if min_e_cut_delta == -1.0 and abs(delta - delta_ref) = EPS_DELTA:\n                    min_e_cut_delta = float(e_cut)\n                \n                # Check convergence for valence bandwidth\n                if min_e_cut_w_v == -1.0 and abs(w_v - w_v_ref) = EPS_W:\n                    min_e_cut_w_v = float(e_cut)\n\n        final_results.extend([min_e_cut_delta, min_e_cut_w_v])\n        \n    # 4. Format and print the final output\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "本章的最后一个练习深入探讨了密度泛函理论计算的理论核心。交换关联泛函的选择（例如PBE与HSE06）会显著影响预测的电子性质，尤其是带隙。本练习通过一个简化的紧束缚模型，直观地展示并解释了为何包含一部分精确交换的杂化泛函（如HSE06）通常能修正标准GGA泛函（如PBE）对带隙的低估问题。",
            "id": "3794763",
            "problem": "考虑一个理想化的晶体半导体，在原子尺度上用一维双原子链进行建模。该链每个原胞包含两个不等价的子晶格，其在位能因交错势而不同。电子能带结构的计算将在一个最小紧束缚框架内进行，该框架与多尺度视角相符，其中来自不同电子结构理论的粗粒化修正被映射到有效参数上。任务是使用 Perdew–Burke–Ernzerhof (PBE) 广义梯度近似和 Heyd–Scuseria–Ernzerhof 2006 (HSE06) 屏蔽杂化泛函，比较给定材料的预测带隙和价带宽度，并基于精确交换的引入来解释其差异。\n\n基本原理：\n- 周期势中的单粒子薛定谔方程意味着布洛赫定理：本征态可以用晶体动量 $k$ 来标记，并在一个尊重晶格周期性的基中展开。\n- 在一个具有双位点基的双原子链的最近邻紧束缚模型中，布洛赫哈密顿量 $H(k)$ 是一个 $2 \\times 2$ 的厄米矩阵，由在位能差和跃迁振幅构成。将在位能不对称性（两个子晶格位点能量差的一半）表示为 $\\Delta$，将正的最近邻跃迁振幅表示为 $t$。哈密顿量可以写成\n$$\nH(k) = \\begin{pmatrix}\n\\Delta  2 t \\cos\\left(\\frac{k a}{2}\\right) \\\\\n2 t \\cos\\left(\\frac{k a}{2}\\right)  -\\Delta\n\\end{pmatrix},\n$$\n其中 $a$ 是晶格常数，$k$ 是布里渊区中的晶体动量。$H(k)$ 的本征值定义了价带和导带的色散关系。\n\n杂化泛函映射：\n- 本着多尺度材料模拟的精神，通过对精确交换（福克交换）混合引起的有效紧束缚参数进行重整化，来近似 PBE 和 HSE06 描述之间的差异。用 $\\alpha$ 表示在 HSE06 中混入交换关联能的短程精确交换的分数，用 $K$ 表示一个有效的屏蔽在位交换积分（单位为电子伏特），该积分参数化了局域轨道的交换致能级排斥的幅度，用 $s \\in [0,1]$ 表示一个无量纲局域化因子，该因子编码了价带态和导带态在不同子晶格上的局域化强度。此外，引入一个无量纲参数 $\\beta \\in [0,1]$，用于衡量跃迁振幅对交换致局域化（带宽重整化）的敏感度。\n- 使用以下从 Perdew–Burke–Ernzerhof (PBE) 到 Heyd–Scuseria–Ernzerhof 2006 (HSE06) 参数的粗粒化映射：\n$$\n\\Delta_{\\mathrm{HSE}} = \\Delta_{\\mathrm{PBE}} + \\alpha \\, s \\, K, \\quad\nt_{\\mathrm{HSE}} = t_{\\mathrm{PBE}} \\, \\max\\!\\left(0, 1 - \\beta \\, \\alpha\\right),\n$$\n其中 $\\max(\\cdot)$ 确保了与物理稳定性一致的非负跃迁。\n- 在每组参数 $(\\Delta, t)$ 下，将布里渊区边界处的直接带隙 $E_g$ 定义为导带底和价带顶之间的能量差，并将价带宽度 $W_v$ 定义为整个布里渊区内价带最大能量和最小能量之间的差值。\n\n任务：\n- 对于每个指定的测试用例，使用 PBE 参数 $(\\Delta_{\\mathrm{PBE}}, t_{\\mathrm{PBE}})$ 和相应的 HSE06 映射参数 $(\\Delta_{\\mathrm{HSE}}, t_{\\mathrm{HSE}})$ 计算带隙 $E_g$ 和价带宽度 $W_v$。\n- 所有能量以电子伏特 (eV) 表示，数值输出四舍五入到三位小数。\n\n测试组：\n使用以下参数值集，所有能量单位为电子伏特，所有无量纲参数无单位：\n$1.$ $(\\Delta_{\\mathrm{PBE}} = 0.8, \\; t_{\\mathrm{PBE}} = 1.5, \\; K = 2.0, \\; s = 0.6, \\; \\alpha = 0.25, \\; \\beta = 0.15)$\n$2.$ $(\\Delta_{\\mathrm{PBE}} = 0.0, \\; t_{\\mathrm{PBE}} = 1.2, \\; K = 1.5, \\; s = 0.5, \\; \\alpha = 0.25, \\; \\beta = 0.10)$\n$3.$ $(\\Delta_{\\mathrm{PBE}} = 3.0, \\; t_{\\mathrm{PBE}} = 0.5, \\; K = 3.0, \\; s = 0.7, \\; \\alpha = 0.25, \\; \\beta = 0.20)$\n$4.$ $(\\Delta_{\\mathrm{PBE}} = 1.2, \\; t_{\\mathrm{PBE}} = 1.0, \\; K = 2.5, \\; s = 0.6, \\; \\alpha = 0.0, \\; \\beta = 0.20)$\n\n答案规格和输出格式：\n- 对每个测试用例，返回一个包含四个浮点数的列表 $[E_{g,\\mathrm{PBE}}, E_{g,\\mathrm{HSE}}, W_{v,\\mathrm{PBE}}, W_{v,\\mathrm{HSE}}]$，每个值以 eV 为单位，四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含聚合的结果，形式为由方括号括起来的、由逗号分隔的四元素列表，例如 $[[e_{11},e_{12},e_{13},e_{14}],[e_{21},e_{22},e_{23},e_{24}],\\ldots]$，不含任何附加文本。",
            "solution": "该问题是有效的，因为它科学地基于固态物理原理，提法恰当，并为计算提供了一套完整且一致的数据和定义。任务是计算一维双原子紧束缚模型的带隙和价带宽度，并比较对应于 PBE 和 HSE06 电子结构理论的参数所得出的结果。\n\n首先，我们通过求解所提供的布洛赫哈密顿量 $H(k)$ 的本征值来确定电子能带结构。对于晶体动量 $k$，其哈密顿量由下式给出：\n$$\nH(k) = \\begin{pmatrix}\n\\Delta  2 t \\cos\\left(\\frac{k a}{2}\\right) \\\\\n2 t \\cos\\left(\\frac{k a}{2}\\right)  -\\Delta\n\\end{pmatrix}\n$$\n这里，$\\Delta$ 表示在位能不对称性，$t$ 是最近邻跃迁振幅，$a$ 是晶格常数。通过求解特征方程 $\\det(H(k) - E \\cdot I) = 0$ 来找到本征值 $E(k)$：\n$$\n(\\Delta - E)(-\\Delta - E) - \\left(2 t \\cos\\left(\\frac{k a}{2}\\right)\\right)^2 = 0\n$$\n$$\nE^2 - \\Delta^2 - 4 t^2 \\cos^2\\left(\\frac{k a}{2}\\right) = 0\n$$\n这就得到了两个能带的能量色散关系：\n$$\nE(k) = \\pm \\sqrt{\\Delta^2 + 4 t^2 \\cos^2\\left(\\frac{k a}{2}\\right)}\n$$\n正根对应于导带 $E_c(k)$，负根对应于价带 $E_v(k)$。\n\n接下来，我们计算第一布里渊区边界处的直接带隙 $E_g$。第一布里渊区的范围是 $k \\in [-\\pi/a, \\pi/a]$，因此其边界在 $k = \\pm \\pi/a$。在这一点，余弦函数的自变量是 $ka/2 = \\pm\\pi/2$，这使得 $\\cos(ka/2) = 0$。将此代入能量表达式中：\n- 导带底：$E_{c, \\text{min}} = E_c(\\pm\\pi/a) = \\sqrt{\\Delta^2 + 0} = |\\Delta|$。假设 $\\Delta \\ge 0$，则为 $\\Delta$。\n- 价带顶：$E_{v, \\text{max}} = E_v(\\pm\\pi/a) = -\\sqrt{\\Delta^2 + 0} = -|\\Delta|$。假设 $\\Delta \\ge 0$，则为 $-\\Delta$。\n在布里渊区边界处的直接带隙是这两个能量之差：\n$$\nE_g = E_c(\\pm\\pi/a) - E_v(\\pm\\pi/a) = \\Delta - (-\\Delta) = 2\\Delta\n$$\n\n然后，我们确定价带宽度 $W_v$。这是整个布里渊区内价带最大能量和最小能量之间的差值。我们已经找到了价带的最大能量 $E_{v, \\text{max}} = -\\Delta$，它出现在布里渊区边界 $k = \\pm\\pi/a$ 处。价带的最小能量出现在平方根下的项最大化时。函数 $\\cos^2(ka/2)$ 在布里渊区中心 $k=0$ 处取得最大值，此时 $\\cos^2(0) = 1$。因此，最小价带能量为：\n$$\nE_{v, \\text{min}} = E_v(0) = -\\sqrt{\\Delta^2 + 4t^2 \\cos^2(0)} = -\\sqrt{\\Delta^2 + 4t^2}\n$$\n于是价带宽度 $W_v$ 为：\n$$\nW_v = E_{v, \\text{max}} - E_{v, \\text{min}} = (-\\Delta) - \\left(-\\sqrt{\\Delta^2 + 4t^2}\\right) = \\sqrt{\\Delta^2 + 4t^2} - \\Delta\n$$\n\n每个测试用例的计算过程如下：\n1. 使用给定的 PBE 参数 $(\\Delta_{\\mathrm{PBE}}, t_{\\mathrm{PBE}})$，通过推导出的公式计算 $E_{g,\\mathrm{PBE}}$ 和 $W_{v,\\mathrm{PBE}}$：\n   $$E_{g,\\mathrm{PBE}} = 2\\Delta_{\\mathrm{PBE}}$$\n   $$W_{v,\\mathrm{PBE}} = \\sqrt{\\Delta_{\\mathrm{PBE}}^2 + 4t_{\\mathrm{PBE}}^2} - \\Delta_{\\mathrm{PBE}}$$\n2. 使用粗粒化关系式计算 HSE06 映射参数：\n   $$\\Delta_{\\mathrm{HSE}} = \\Delta_{\\mathrm{PBE}} + \\alpha s K$$\n   $$t_{\\mathrm{HSE}} = t_{\\mathrm{PBE}} \\max(0, 1 - \\beta \\alpha)$$\n3. 使用计算出的 HSE06 参数 $(\\Delta_{\\mathrm{HSE}}, t_{\\mathrm{HSE}})$ 求出 $E_{g,\\mathrm{HSE}}$ 和 $W_{v,\\mathrm{HSE}}$：\n   $$E_{g,\\mathrm{HSE}} = 2\\Delta_{\\mathrm{HSE}}$$\n   $$W_{v,\\mathrm{HSE}} = \\sqrt{\\Delta_{\\mathrm{HSE}}^2 + 4t_{\\mathrm{HSE}}^2} - \\Delta_{\\mathrm{HSE}}$$\n\n从 PBE 到 HSE06 观察到的趋势，其物理上的解释根植于精确交换的引入。\n- **带隙增大**：PBE 泛函是一种广义梯度近似 (GGA)，众所周知它存在自相互作用误差，该误差会人为地使电子波函数离域，并系统性地低估带隙。HSE06 杂化泛函通过混入一部分比例为 $\\alpha$ 的精确类 Hartree-Fock 交换来修正这个问题。这种修正倾向于使电子态局域化，并增大了占据能级和非占据能级之间的能量分裂。在我们的模型中，这表现为在位能不对称性的增加，即 $\\Delta_{\\mathrm{HSE}}  \\Delta_{\\mathrm{PBE}}$，因为项 $\\alpha s K$ 是非负的。由于 $E_g = 2\\Delta$，带隙必然会增大或保持不变 ($E_{g,\\mathrm{HSE}} \\ge E_{g,\\mathrm{PBE}}$)。\n- **带宽减小**：跃迁参数 $t$ 控制着能带的离域程度和宽度。由精确交换引起的、加宽了带隙的同样局域化效应，也减少了相邻位点上轨道之间的空间交叠。这导致了更小的有效跃迁振幅，因此 $t_{\\mathrm{HSE}} \\le t_{\\mathrm{PBE}}$。价带宽度 $W_v = \\sqrt{\\Delta^2 + 4t^2} - \\Delta$ 的减小有两个原因：更小的 $t$ 会减小整体能带色散，而更大的 $\\Delta$ 会使能带变平。这两种效应都导致了 $W_{v, \\mathrm{HSE}} \\le W_{v, \\mathrm{PBE}}$。\n\n将这些原理应用于每个测试用例，以生成最终的数值结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates band gaps and valence bandwidths for a 1D diatomic chain model\n    using PBE and HSE06 effective parameters.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (Delta_pbe, t_pbe, K, s, alpha, beta)\n    test_cases = [\n        (0.8, 1.5, 2.0, 0.6, 0.25, 0.15),\n        (0.0, 1.2, 1.5, 0.5, 0.25, 0.10),\n        (3.0, 0.5, 3.0, 0.7, 0.25, 0.20),\n        (1.2, 1.0, 2.5, 0.6, 0.0, 0.20),\n    ]\n\n    def calculate_properties(delta, t):\n        \"\"\"\n        Calculates band gap and valence bandwidth from tight-binding parameters.\n        \n        Args:\n            delta (float): On-site energy asymmetry.\n            t (float): Hopping amplitude.\n        \n        Returns:\n            tuple: A tuple containing (band_gap, valence_bandwidth).\n        \"\"\"\n        # Band gap Eg = 2*Delta\n        band_gap = 2 * delta\n        \n        # Valence bandwidth Wv = sqrt(Delta^2 + 4*t^2) - Delta\n        valence_bandwidth = np.sqrt(delta**2 + 4 * t**2) - delta\n        \n        return band_gap, valence_bandwidth\n\n    all_results = []\n    for case in test_cases:\n        delta_pbe, t_pbe, K, s, alpha, beta = case\n        \n        # 1. PBE calculations\n        eg_pbe, wv_pbe = calculate_properties(delta_pbe, t_pbe)\n        \n        # 2. Calculate HSE06 parameters from PBE parameters\n        delta_hse = delta_pbe + alpha * s * K\n        t_hse = t_pbe * max(0, 1 - beta * alpha)\n        \n        # 3. HSE06 calculations\n        eg_hse, wv_hse = calculate_properties(delta_hse, t_hse)\n        \n        # 4. Store the results for this case\n        case_results = [eg_pbe, wv_pbe, eg_hse, wv_hse]\n        all_results.append(case_results)\n\n    # Format the final output string as specified: [[r11,r12,...],[r21,r22,...]]\n    # with no spaces and three decimal places for each number.\n    formatted_case_results = []\n    for result_set in all_results:\n        # Format each number to 3 decimal places\n        inner_list_str = '[' + ','.join([f'{val:.3f}' for val in result_set]) + ']'\n        formatted_case_results.append(inner_list_str)\n        \n    final_output_string = '[' + ','.join(formatted_case_results) + ']'\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}