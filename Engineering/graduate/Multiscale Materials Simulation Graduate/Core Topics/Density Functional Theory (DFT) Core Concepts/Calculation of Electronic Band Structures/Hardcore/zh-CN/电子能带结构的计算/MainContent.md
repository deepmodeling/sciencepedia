## 引言
电子能带结构是固态物理学的核心概念，它描绘了电子在晶体[周期性势场](@entry_id:140652)中允许存在的能量状态，是连接材料微观量子行为与宏观电学、光学及热学性质的关键桥梁。理解和精确计算材料的能带结构，对于设计新型半导体器件、发现前沿[量子材料](@entry_id:136741)以及推动材料科学的发展至关重要。然而，从复杂的[多体薛定谔方程](@entry_id:1127611)出发直接求解真实材料的电子态是一个几乎不可能完成的任务。因此，发展高效且准确的计算方法，并正确解读其结果，成为了现代计算材料科学的核心挑战之一。

本文旨在系统性地介绍[电子能带结构](@entry_id:136694)的[计算理论](@entry_id:273524)、实践方法及其广泛应用。通过本文的学习，读者将能够建立一个从基本量子力学原理到前沿应用研究的完整知识框架。在 **“原理与机制”** 一章中，我们将从[布洛赫定理](@entry_id:137461)出发，深入剖析作为现代计算基石的[密度泛函理论](@entry_id:139027)（DFT），探讨其实践中的关键环节，并阐明其局限性与超越DFT的[GW近似](@entry_id:140388)方法。随后，在 **“应用与交叉学科联系”** 一章中，我们将展示如何利用计算出的[能带图](@entry_id:1124081)来预测和设计[材料性质](@entry_id:146723)，涵盖从传统半导体到拓扑物态等多个领域，并探索能带概念在其他学科中的回响。最后，通过 **“动手实践”** 部分，读者将有机会通过具体的计算练习，将理论知识转化为解决实际问题的能力。

## 原理与机制

在本章中，我们将深入探讨计算电子能带结构的理论原理和关键机制。继前一章的介绍之后，我们将从晶体周期性这一[基本对称性](@entry_id:161256)出发，建立描述电子态的数学框架。随后，我们将阐述现代[电子结构计算](@entry_id:748901)的核心方法——[密度泛函理论](@entry_id:139027)（DFT），并详细讨论其实际应用中的关键技术环节，包括基[组选择](@entry_id:175784)、[赝势近似](@entry_id:167914)和[自洽场](@entry_id:136549)计算。最后，我们将审视DFT计算结果的物理解释，特别是其在预测[能隙](@entry_id:138445)方面的局限性，并引出更精确描述激发态的后DFT方法，如[GW近似](@entry_id:140388)。

### [晶格](@entry_id:148274)周期性与[布洛赫定理](@entry_id:137461)

晶体物理学的基石在于其原子结构在空间中的[平移对称性](@entry_id:171614)。一个理想的无限大晶体可以由一个称为 **布拉维[晶格](@entry_id:148274)** 的点集来描述。布拉维[晶格](@entry_id:148274)是所有形如 $\mathbf{R} = n_1 \mathbf{a}_1 + n_2 \mathbf{a}_2 + n_3 \mathbf{a}_3$ 的矢量的集合，其中 $n_i$ 是任意整数，而 $\{\mathbf{a}_1, \mathbf{a}_2, \mathbf{a}_3\}$ 是一组[线性无关](@entry_id:148207)的 **[原胞基矢](@entry_id:142930)**，定义了晶体的基本重复单元。

在这样的晶体中，电子感受到的离子实有效势 $V(\mathbf{r})$ 也具有相同的周期性，即 $V(\mathbf{r} + \mathbf{R}) = V(\mathbf{r})$ 对所有[晶格矢量](@entry_id:161583) $\mathbf{R}$ 成立。这深刻地影响了单[电子薛定谔方程](@entry_id:177999) $H\psi = E\psi$ 的解的形式，其中[哈密顿量](@entry_id:144286)为 $H = -\frac{\hbar^2}{2m}\nabla^2 + V(\mathbf{r})$。

为了分析具有周期性的函数和算符，引入 **[倒易晶格](@entry_id:136718)** 的概念至关重要。对于由 $\{\mathbf{a}_i\}$ 定义的[实空间](@entry_id:754128)[晶格](@entry_id:148274)，其对应的[倒易晶格](@entry_id:136718)基矢 $\{\mathbf{b}_j\}$ 由关系 $\mathbf{a}_i \cdot \mathbf{b}_j = 2\pi \delta_{ij}$ 定义，其中 $\delta_{ij}$ 是克罗内克符号。[倒易晶格](@entry_id:136718)本身也是一个布拉维[晶格](@entry_id:148274)，由所有形如 $\mathbf{G} = m_1 \mathbf{b}_1 + m_2 \mathbf{b}_2 + m_3 \mathbf{b}_3$ 的矢量组成，其中 $m_i$ 为整数。[倒易晶格](@entry_id:136718)的矢量构成了在[实空间](@entry_id:754128)[晶格](@entry_id:148274)上进行傅里叶展开的“波矢”集合。具体来说，任何具有[晶格](@entry_id:148274)周期性的函数 $f(\mathbf{r}) = f(\mathbf{r}+\mathbf{R})$ 都可以展开为[傅里叶级数](@entry_id:139455)：
$$
f(\mathbf{r}) = \sum_{\mathbf{G}} f_{\mathbf{G}} e^{i\mathbf{G}\cdot\mathbf{r}}
$$
其中求和遍及所有[倒易晶格矢量](@entry_id:263351) $\mathbf{G}$。这是因为只有当[波矢](@entry_id:178620)是[倒易晶格矢量](@entry_id:263351)时，平面波 $e^{i\mathbf{G}\cdot\mathbf{r}}$ 才具有[晶格](@entry_id:148274)的平移周期性，即 $e^{i\mathbf{G}\cdot(\mathbf{r}+\mathbf{R})} = e^{i\mathbf{G}\cdot\mathbf{r}} e^{i\mathbf{G}\cdot\mathbf{R}} = e^{i\mathbf{G}\cdot\mathbf{r}}$，因为根据定义，$\mathbf{G}\cdot\mathbf{R}$ 总是 $2\pi$ 的整数倍 。将[周期势](@entry_id:140652) $V(\mathbf{r})$ 按此方式展开，是理解其对电子影响的第一步。

哈密顿量的周期性意味着它与[晶格](@entry_id:148274)[平移算符](@entry_id:756122) $T_{\mathbf{R}}$ 可交换，其中 $(T_{\mathbf{R}}\psi)(\mathbf{r}) = \psi(\mathbf{r}-\mathbf{R})$。由于所有[平移算符](@entry_id:756122)构成一个[阿贝尔群](@entry_id:150284)，它们与[哈密顿量](@entry_id:144286)可以拥有共同的[本征函数](@entry_id:154705)。这导致了[凝聚态物理学](@entry_id:140205)中最核心的定理之一——**[布洛赫定理](@entry_id:137461)**。该定理指出，[周期势](@entry_id:140652)中电子的[本征函数](@entry_id:154705)（称为 **[布洛赫函数](@entry_id:189422)**）可以写成如下形式：
$$
\psi_{n\mathbf{k}}(\mathbf{r}) = e^{i\mathbf{k}\cdot\mathbf{r}} u_{n\mathbf{k}}(\mathbf{r})
$$
其中 $u_{n\mathbf{k}}(\mathbf{r})$ 是一个具有[晶格](@entry_id:148274)周期的函数，即 $u_{n\mathbf{k}}(\mathbf{r}+\mathbf{R}) = u_{n\mathbf{k}}(\mathbf{r})$。矢量 $\mathbf{k}$ 被称为 **[晶体动量](@entry_id:136369)**，是一个连续的[量子数](@entry_id:145558)，用于标记不同的电子态。[布洛赫定理](@entry_id:137461)等价于[本征函数](@entry_id:154705)在[晶格](@entry_id:148274)平移下的变换性质：$\psi_{n\mathbf{k}}(\mathbf{r}+\mathbf{R}) = e^{i\mathbf{k}\cdot\mathbf{R}}\psi_{n\mathbf{k}}(\mathbf{r})$。[布洛赫定理](@entry_id:137461)将求解无限大晶体中电子态的问题，简化为在单个[原胞](@entry_id:159354)内求解一系列以 $\mathbf{k}$ 为参数的方程，从而为能带结构的概念奠定了基础  。

### [布里渊区](@entry_id:142395)与高对称性路径

晶体动量 $\mathbf{k}$ 的取值范围是[倒易空间](@entry_id:754151)。由于 $\mathbf{k}$ 和 $\mathbf{k}+\mathbf{G}$（$\mathbf{G}$ 为任意[倒易晶格矢量](@entry_id:263351)）描述的是物理上等价的态，我们通常将 $\mathbf{k}$ 的取值限制在一个[倒易空间](@entry_id:754151)的[原胞](@entry_id:159354)内。一个特别重要且方便的选择是 **第一布里渊区**（BZ）。第一布里渊区被定义为[倒易晶格](@entry_id:136718)的 **维格纳-赛兹（Wigner-Seitz）原胞**，即[倒易空间](@entry_id:754151)中离原点（$\mathbf{G}=0$）比离任何其他[倒易晶格](@entry_id:136718)点更近的点的集合 。几何上，它可以通过作连接原点与所有[倒易晶格](@entry_id:136718)近邻点的线段的垂直平分面来构造，这些平面所围成的最小体积（或面积）区域就是第一布里渊区。

在第一布里渊区内，存在一些特殊的点和线，它们在[晶体点群](@entry_id:183880)操作下具有更高的对称性。一个 $\mathbf{k}$ 点的对称性由其 **[小群](@entry_id:198763)**（little group）描述，即[晶体点群](@entry_id:183880)中所有使 $\mathbf{k}$ 保持不变（或仅相差一个[倒易晶格矢量](@entry_id:263351)）的[对称操作](@entry_id:143398)所构成的子群。对于布里渊区中的一个普通点，其[小群](@entry_id:198763)只包含单位操作。而 **高对称性点** 的小群则包含更多的[对称元素](@entry_id:136566)。这些点通常被赋予标准标签，例如，对于六角[晶格](@entry_id:148274)，中心点是 $\Gamma$，六边形[布里渊区](@entry_id:142395)边的中点是 $M$，顶点是 $K$ 。

电子能带结构 $E_n(\mathbf{k})$ 通常沿着连接这些高对称性点的 **高对称性路径** 进行绘制，例如二维六角[晶格](@entry_id:148274)的 $\Gamma-M-K-\Gamma$ 路径。这样做有两个主要目的：首先，在这些高对称性点和线上，能带常常表现出简并或[极值](@entry_id:145933)等关键特征，这些特征由对称性决定；其次，这样的[路径图](@entry_id:274599)能够以一种紧凑和富有[信息量](@entry_id:272315)的方式，可视化能带在整个布里渊区中的主要色散行为 。然而，必须强调，这些一维[路径图](@entry_id:274599)主要用于定性分析和可视化。为了精确计算需要对整个[布里渊区积分](@entry_id:188454)的宏观物理量（如[载流子浓度](@entry_id:143028)、[电子热容](@entry_id:144815)等），必须在整个[布里渊区](@entry_id:142395)（或其不可约部分）上进行密集的 $\mathbf{k}$ 点取样，仅沿高对称性路径计算是远远不够的  。

### 能[带隙的起源](@entry_id:187265)：[近自由电子模型](@entry_id:138124)

为了直观理解能带和[能隙](@entry_id:138445)是如何形成的，我们可以考虑一个简单的 **[近自由电子模型](@entry_id:138124)**。在这个模型中，周期势 $V(x)$ 被视为对[自由电子气](@entry_id:145649)的一个微扰。考虑一个一维[晶格](@entry_id:148274)，其格常数为 $a$，[周期势](@entry_id:140652)为 $V(x) = 2V \cos(\frac{2\pi}{a}x)$。其傅里叶分量只有在 $G = \pm \frac{2\pi}{a}$ 时不为零，即 $V_G = V$。

在没有势场的情况下，电子的本征态是平面波 $|k\rangle = e^{ikx}$，能量为 $E^{(0)}_k = \frac{\hbar^2 k^2}{2m}$。当引入弱周期势时，它会引起不同[平面波](@entry_id:189798)之间的耦合。根据[微扰理论](@entry_id:138766)，当两个或多个态的能量相近时，这种耦合效应最为显著。在第一布里渊区边界 $k = \pi/a$ 处，态 $|k\rangle$ 和态 $|k-G\rangle$（其中 $G = 2\pi/a$）的自由电子能量发生简并，因为 $k-G = -\pi/a$，所以 $|k|^2 = |k-G|^2$。

在这种简并或[近简并](@entry_id:172107)的情况下，我们需要使用[简并微扰理论](@entry_id:143587)。将哈密顿量写在这两个态构成的子空间中，得到一个 $2 \times 2$ 矩阵：
$$
H_{\text{eff}}(k) =
\begin{pmatrix}
E^{(0)}_{k} & V_{G} \\
V_{G}^{*} & E^{(0)}_{k-G}
\end{pmatrix}
$$
在[布里渊区](@entry_id:142395)边界 $k = \pi/a$ 处，$E^{(0)}_{k} = E^{(0)}_{k-G}$。求解该矩阵的本征值，得到两个新的能量 $E_{\pm} = E^{(0)}_{k} \pm |V_G|$。简并被消除，两个[能级分裂](@entry_id:193178)开来，形成一个宽度为 $\Delta E = 2|V_G|$ 的 **[能隙](@entry_id:138445)**。对于我们给定的势，$|V_G| = |V|$，因此[能隙](@entry_id:138445)大小为 $2|V|$ 。这种由周期势在布里渊区边界引起的波的[相干散射](@entry_id:267724)（[布拉格反射](@entry_id:184358)），正是晶体中[能隙形成](@entry_id:265171)的基本物理机制。

### [密度泛函理论](@entry_id:139027)的核心：[科恩-沈方程](@entry_id:143968)

虽然[近自由电子模型](@entry_id:138124)提供了深刻的物理图像，但对于真实材料，其势场通常很强，微扰理论不再适用。现代电子能带结构计算最广泛使用的方法是 **密度泛函理论**（DFT）。DFT的基石是霍恩伯格-科恩（Hohenberg-Kohn）定理，它证明了多电子体系的基态性质完全由其基态电子密度 $n(\mathbf{r})$ 唯一决定。

科恩-沈（Kohn-Sham, KS）方法是DFT在实践中最成功的实现。其核心思想是，将一个复杂的相互作用多电子体系，映射到一个具有相同基[态密度](@entry_id:147894)的、无相互作用的辅助体系上。这个辅助体系的电子在满足薛定谔方程形式的 **[科恩-沈方程](@entry_id:143968)** 中运动：
$$
\left[-\frac{\hbar^2}{2m}\nabla^2 + V_{\text{eff}}[n](\mathbf{r})\right]\phi_{i}(\mathbf{r}) = \epsilon_{i}\phi_{i}(\mathbf{r})
$$
这里的有效势 $V_{\text{eff}}[n](\mathbf{r})$ 是电子密度的泛函，由三部分组成：
$$
V_{\text{eff}}[n](\mathbf{r}) = V_{\text{ext}}(\mathbf{r}) + V_{\text{H}}[n](\mathbf{r}) + V_{\text{xc}}[n](\mathbf{r})
$$
其中，$V_{\text{ext}}(\mathbf{r})$ 是由原子核产生的外部势，$V_{\text{H}}[n](\mathbf{r}) = \int \frac{e^2 n(\mathbf{r}')}{4\pi\epsilon_0|\mathbf{r}-\mathbf{r}'|} d^3r'$ 是描述电子间经典静电排斥的哈特里（Hartree）势，而 $V_{\text{xc}}[n](\mathbf{r}) = \frac{\delta E_{\text{xc}}[n]}{\delta n(\mathbf{r})}$ 是 **交换关联势**。交换关联能 $E_{\text{xc}}[n]$ 是一个普适但形式未知的泛函，它包含了所有非经典的、复杂的[多体效应](@entry_id:173569)。DFT的艺术和挑战就在于寻找对 $E_{\text{xc}}[n]$ 的精确近似。

对于晶体，由于 $V_{\text{ext}}(\mathbf{r})$ 是周期性的，基态密度 $n(\mathbf{r})$ 也将是周期性的，进而导致整个 $V_{\text{eff}}[n](\mathbf{r})$ 也是周期性的。因此，KS方程的解 $\phi_{i}$ 必须是[布洛赫函数](@entry_id:189422)，可以用能带指数 $n$ 和[晶体动量](@entry_id:136369) $\mathbf{k}$ 来标记，即 $\phi_{n\mathbf{k}}(\mathbf{r})$。KS方程的本征值 $\epsilon_{n\mathbf{k}}$ 构成了KS能带结构。

KS方程的解与它所依赖的密度之间存在耦合关系。给定一组KS轨道 $\phi_{n\mathbf{k}}$，电子密度可以通过对所有占据态求和得到：
$$
n(\mathbf{r}) = g_s \sum_{n} \int_{\text{BZ}} \frac{d^3k}{(2\pi)^3} f_{n\mathbf{k}} |\phi_{n\mathbf{k}}(\mathbf{r})|^2
$$
其中 $g_s$ 是自旋简并度（通常为2），积分遍及整个[第一布里渊区](@entry_id:269110)，$f_{n\mathbf{k}} = \left[1+\exp\left(\frac{\epsilon_{n\mathbf{k}}-\mu}{k_B T}\right)\right]^{-1}$ 是 **[费米-狄拉克分布](@entry_id:138909)函数**，描述了在温度 $T$ 和化学势 $\mu$ 下，能量为 $\epsilon_{n\mathbf{k}}$ 的量子态被电子占据的概率 。

由于[有效势](@entry_id:1124192)依赖于密度，而密度又依赖于通过求解该[有效势](@entry_id:1124192)下的KS方程得到的轨道，这个问题必须通过 **[自洽场](@entry_id:136549)（SCF）** 循环来迭代求解 。一个典型的SCF流程如下：
1.  从一个初始猜测的电子密度 $n_{\text{in}}(\mathbf{r})$ 开始。
2.  根据 $n_{\text{in}}(\mathbf{r})$ 构建有效势 $V_{\text{eff}}[n_{\text{in}}]$。
3.  求解KS方程，得到一组新的本征值 $\epsilon_{n\mathbf{k}}$ 和[本征函数](@entry_id:154705) $\phi_{n\mathbf{k}}$。
4.  利用新的轨道和能量计算出一个新的（输出）电子密度 $n_{\text{out}}(\mathbf{r})$。
5.  将 $n_{\text{out}}(\mathbf{r})$ 与 $n_{\text{in}}(\mathbf{r})$ 进行比较。如果两者足够接近（例如，总能量变化和密度残差都小于某个阈值），则认为计算已收敛，得到的密度和能带是自洽的。
6.  如果未收敛，则将 $n_{\text{in}}(\mathbf{r})$ 和 $n_{\text{out}}(\mathbf{r})$ 进行混合（mixing），生成下一个迭代步的输入密度 $n_{\text{in}}^{\text{new}}(\mathbf{r})$，然后返回第2步。

这个迭代过程是所有基于DFT的[电子结构计算](@entry_id:748901)的核心。

### [DFT计算](@entry_id:1123635)的实践要点

在将KS-DFT付诸实践时，必须做出几个关键的近似和选择，这些选择直接影响计算的精度和成本。

#### 基组与[截断能](@entry_id:177594)

为了在计算机上求解KS方程，必须将连续的KS轨道 $\phi_{n\mathbf{k}}$ 在一个有限的基函数集合中展开。对于周期性体系，最自然、最广泛使用的基组是 **[平面波基组](@entry_id:178287)**。根据[布洛赫定理](@entry_id:137461)，KS轨道可以写成 $\psi_{n\mathbf{k}}(\mathbf{r}) = \sum_{\mathbf{G}} c_{n\mathbf{k}}(\mathbf{G}) e^{i(\mathbf{k}+\mathbf{G})\cdot\mathbf{r}}$。这个展开原则上需要无穷多个[倒易晶格矢量](@entry_id:263351) $\mathbf{G}$。在实际计算中，我们必须截断这个基组。一个物理上合理的截断标准是只包含那些动能小于某个阈值的平面波，即：
$$
\frac{\hbar^2 |\mathbf{k}+\mathbf{G}|^2}{2m} \le E_{\text{cut}}
$$
这里的 $E_{\text{cut}}$ 称为 **[动能截断](@entry_id:186065)能**。这个条件在[倒易空间](@entry_id:754151)中定义了一个以 $-\mathbf{k}$ 为中心、半径为 $K_{\text{cut}} = \sqrt{2mE_{\text{cut}}}/\hbar$ 的球体。所有落入此球内的[倒易晶格矢量](@entry_id:263351) $\mathbf{G}$ 所对应的[平面波](@entry_id:189798)都被包含在基组中 。

$E_{\text{cut}}$ 是一个至关重要的收敛参数。根据[变分原理](@entry_id:198028)，使用有限基组计算出的能量总是真实能量的上限。因此，随着 $E_{\text{cut}}$ 的增加，基组变得更加完备，计算出的总能量和能带会系统地收敛到（在该赝势和交换关联泛函近似下的）精确值。然而，基组的大小 $N$ 随着 $E_{\text{cut}}$ 快速增长（在三维中，$N \propto E_{\text{cut}}^{3/2}$），而计算成本通常随 $N$ 超线性增长（例如，对于直接[对角化方法](@entry_id:273007)，成本约为 $O(N^3) \propto E_{\text{cut}}^{9/2}$）。因此，选择一个足够大以保证所需精度，但又在计算上可行的 $E_{\text{cut}}$，是所有[平面波](@entry_id:189798)[DFT计算](@entry_id:1123635)中的一个核心权衡。

#### [核心电子](@entry_id:141520)与赝势

[全电子计算](@entry_id:170546)需要非常高的 $E_{\text{cut}}$，因为要描述原子核附近价电子[波函数](@entry_id:201714)的剧烈振荡（为了与束缚紧密的芯层电子轨道保持正交）。为了降低计算成本，**赝势** 方法被引入。其思想是，只对化学性质起决定性作用的 **价电子** 进行显式计算，而将束缚得很紧、基本不参与成键的 **芯层电子** 及其与原子核共同构成的“离子实”用一个更平滑、更弱的有效势——赝势来代替。

一个好的赝势应在原子核区域外精确地再现全电子势的散射性质。根据构造方法的不同，主要有三类[赝势](@entry_id:170389)：
*   **模守恒赝势（Norm-Conserving Pseudopotentials, NCPP）**：这类赝势要求在某个核心半径 $r_c$ 内，赝[波函数](@entry_id:201714)的归一化电荷必须与全电子[波函数](@entry_id:201714)的完全相同。这保证了优良的转移性，但为了满足此条件，[赝势](@entry_id:170389)通常较“硬”，需要相对较高的 $E_{\text{cut}}$。计算上，它导出一个标准的厄米本征值问题 。
*   **[超软赝势](@entry_id:144509)（Ultrasoft Pseudopotentials, USPP）**：为了获得更平滑的赝[波函数](@entry_id:201714)从而使用更低的 $E_{\text{cut}}$，USPP方法放宽了模守恒的约束。这导致在核心区域内存在电荷亏损，为了补偿，该方法引入了额外的“增广电荷”。数学上，这导致了一个广义[本征值问题](@entry_id:142153) $H|\psi\rangle = \epsilon S |\psi\rangle$，其中 $S$ 是一个非平庸的重叠算符 。
*   **投影缀加波方法（Projector Augmented-Wave, PAW）**：PAW方法在形式上比[赝势](@entry_id:170389)更通用和精确。它通过一个线性的变换算符，精确地将平滑的赝[波函数](@entry_id:201714)映射回包含所有节瘤结构的“全电子”[波函数](@entry_id:201714)。这使得我们能够从平滑[波函数](@entry_id:201714)的计算中，重构出全电子的[物理可观测量](@entry_id:154692)（如电荷密度）。[PAW方法](@entry_id:753811)兼具高精度和高效率，是目前最先进和流行的主流方法之一 。

在处理含有半芯层态（如过渡金属的 $3s, 3p$ 电子）的体系时，通常需要将这些态也视为价电子进行计算，以保证[能带结构](@entry_id:139379)的准确性。

#### 自洽收敛性

SCF循环的收敛性是另一个重要的实践问题。对于半导体和绝缘体，简单的线性混合通常就能很好地工作。但对于 **金属**，由于[费米面](@entry_id:137798)附近存在大量能量相近的态，对有效势的微小扰动可能导致占据数的大幅变化，从而引起电荷密度的长波振荡，即所谓的 **“电荷晃洗”（charge sloshing）**。这会导致SCF循环不稳定甚至发散。为了解决这个问题，需要采用更复杂的混合方案（如Broyden或Anderson混合）并结合 **倒空间[预处理](@entry_id:141204)（preconditioning）**。例如，通过在混合前抑制密度残差的长波（小 $q$）分量，可以有效地抑制这种不稳定性，从而实现或加速收敛 。

### 解读[能带结构](@entry_id:139379)：从本征值到物理性质

在完成自洽计算并获得收敛的能带 $E_n(\mathbf{k})$ 后，下一步是解读其物理意义。

#### 直接与间接[能隙](@entry_id:138445)

对于半导体和绝缘体，最重要的性质之一是 **[能隙](@entry_id:138445)** $E_g$。[能隙](@entry_id:138445)定义为导带底（Conduction Band Minimum, CBM）和价带顶（Valence Band Maximum, VBM）之间的能量差。VBM是所有价带在整个[布里渊区](@entry_id:142395)的能量最大值，而CBM是所有导带的能量最小值。
$$
E_{\mathrm{VBM}}=\max_{\mathbf{k},\,n\in\mathrm{valence}}E_{n}(\mathbf{k}), \quad E_{\mathrm{CBM}}=\min_{\mathbf{k},\,n\in\mathrm{conduction}}E_{n}(\mathbf{k})
$$
根据VBM和CBM在 $\mathbf{k}$ 空间中的相对位置，[能隙](@entry_id:138445)分为两类：
*   **直接[能隙](@entry_id:138445)（Direct Band Gap）**：VBM和CBM位于相同的 $\mathbf{k}$ 点。
*   **间接[能隙](@entry_id:138445)（Indirect Band Gap）**：VBM和CBM位于不同的 $\mathbf{k}$ 点。

这个区别对材料的光电性质至关重要。由于光子的动量与[布里渊区](@entry_id:142395)的尺度相比非常小，[光吸收](@entry_id:136597)过程近似为“[垂直跃迁](@entry_id:275451)”，即电子的晶体动量 $\mathbf{k}$ 不变。在直接[能隙](@entry_id:138445)材料中，电子可以从价带顶直接吸收一个光子跃迁到导带底，这一过程效率很高。而在间接[能隙](@entry_id:138445)材料中，这种跃迁还需要一个声子来辅助[动量守恒](@entry_id:149964)，因此是一个效率低得多的二阶过程。

要准确地判断[能隙](@entry_id:138445)类型，必须在整个[布里渊区](@entry_id:142395)（或其不可约部分）上进行足够密集的 $\mathbf{k}$ 点搜索，以确保找到全局的VBM和CBM。仅仅检查高对称性路径上的极值是不够的，因为极值点可能位于普通的 $\mathbf{k}$ 点上 。

#### KS本征值的物理意义与[能隙问题](@entry_id:143831)

一个至关重要但常被误解的问题是：KS本征值 $\epsilon_{n\mathbf{k}}$ 的物理意义是什么？严格来说，KS-DFT是一个基态理论，KS方程及其本征值是求解基[态密度](@entry_id:147894)的一个数学辅助工具。**KS本征值本身并不是真正的[电子激发](@entry_id:190531)能（即[准粒子能量](@entry_id:173936)）**。

真正的单电子激发能（从系统中移走一个电子或向其中添加一个电子所需的能量）应该通过[多体微扰理论](@entry_id:168555)（MBPT）来描述。在MBPT中，[准粒子能量](@entry_id:173936)是[格林函数](@entry_id:147802)（Green's function）的极点，并通过包含 **自能算符** $\Sigma$ 的戴森（Dyson）方程求解。自能算符 $\Sigma(\mathbf{r}, \mathbf{r}', \omega)$ 描述了电子与其周围动态可极化环境之间的所有复杂相互作用，它通常是 **非局域的**、**能量依赖的**（动态的）和 **非厄米的**  。相比之下，KS方程中的交换关联势 $V_{\text{xc}}(\mathbf{r})$ 是局域（或半局域）的、静态的、厄米的算符。

正是这种根本性的差异导致了DFT著名的 **“[能隙问题](@entry_id:143831)”**。对于绝大多数半导体和绝缘体，使用标准交换关联泛函（如LDA、GGA）计算出的KS[能隙](@entry_id:138445)，通常远小于实验测得的光学[能隙](@entry_id:138445)。这主要源于两个原因：
1.  **自相互作用误差（Self-Interaction Error, SIE）**：在近似的DFT中，一个电子会与自身的密度发生虚假的相互作用。这种误差倾向于将电子态非局域化，人为地抬高了占据态的能量（尤其是VBM），从而减小了[能隙](@entry_id:138445)。
2.  **[导数不连续性](@entry_id:136336)（Derivative Discontinuity）**：对于精确的泛函，当体系的电子数穿过整数时，$V_{\text{xc}}$ 会有一个不连续的跳变 $\Delta_{\text{xc}}$。[准粒子](@entry_id:136584)[能隙](@entry_id:138445) $E_g^{\text{QP}}$ 与KS[能隙](@entry_id:138445) $E_g^{\text{KS}}$ 之间的关系为 $E_g^{\text{QP}} = E_g^{\text{KS}} + \Delta_{\text{xc}}$。而对于LDA、GGA等连续的泛函，$\Delta_{\text{xc}}=0$，这部分贡献完全丢失了 。

#### 交换关联泛函的选择

DFT计算的准确性在很大程度上取决于对 $E_{\text{xc}}[n]$ 的近似。这些近似通常被称为“[雅各布天梯](@entry_id:139901)”（Jacob's Ladder），按其复杂度和准确度逐级提升：
*   **局域密度近似（LDA）**：$E_{\text{xc}}$ 仅依赖于局域电子密度 $n(\mathbf{r})$。[LDA](@entry_id:138982)存在系统性的“过高束缚”问题，即预测的[晶格常数](@entry_id:158935)偏小，导致[电子轨道](@entry_id:157718)交叠过大，从而使 **能带宽度偏大**。
*   **[广义梯度近似](@entry_id:274118)（GGA）**：$E_{\text{xc}}$ 同时依赖于 $n(\mathbf{r})$ 和其梯度 $\nabla n(\mathbf{r})$。GGA通常能修正LDA的过高束缚问题，得到更准确的[晶格常数](@entry_id:158935)，因此预测的 **能带宽度比LDA更窄**，也更接近实验。
*   **[元-GGA](@entry_id:191648)（[meta-GGA](@entry_id:191648)）**：在GGA的基础上，进一步引入了动能密度 $\tau(\mathbf{r})$ 等依赖于KS轨道的半局域量。[meta-GGA](@entry_id:191648)能够更好地识别不同的化学环境（如[单键](@entry_id:188561)、双键等），因此在结构、[能隙](@entry_id:138445)和能带位置方面通常比GGA有进一步的改善。

对于能带结构，这些泛函有共同的趋势：由于[自相互作用误差](@entry_id:260813)，它们都倾向于将过渡金属中局域的 $d$ 电子态的能量预测得过高，导致其与 $s,p$ 带的杂化不准确。[meta-GGA](@entry_id:191648)在一定程度上可以缓解这个问题，将 $d$ 带束缚得更深，得到更物理的[能带排列](@entry_id:137089) 。

### 超越DFT：[GW近似](@entry_id:140388)

为了克服DFT的[能隙问题](@entry_id:143831)并获得定量的准粒子[能带结构](@entry_id:139379)，必须采用更高级的理论，即前面提到的[多体微扰理论](@entry_id:168555)。目前最成功和广泛使用的方法是 **[GW近似](@entry_id:140388)**。

[GW近似](@entry_id:140388)为自能算符 $\Sigma$ 提供了一个具体的表达式：
$$
\Sigma = i G W
$$
其中，$i$ 是虚数单位，$G$ 是[单粒子格林函数](@entry_id:140400)（通常从DFT或HF计算出发构造），而 $W$ 是 **[屏蔽库仑相互作用](@entry_id:164093)**。裸库仑相互作用 $v$ 由于体系中其他电子的响应而被“屏蔽”，形成了更弱、更短程的有效相互作用 $W = \epsilon^{-1} v$，其中 $\epsilon^{-1}$ 是逆[介电函数](@entry_id:136859)。

与KS方程中的 $V_{\text{xc}}$ 相比，GW[自能](@entry_id:145608)算符的物理内涵和数学结构都大不相同：
*   它显式地描述了一个电子（或空穴）的传播（由 $G$ 描述）以及它与由其自身引起的周围电子云极化（由 $W$ 描述）之间的相互作用。
*   它具有前面提到的所有复杂性质：非局域、动态（频率依赖）和非厄米。

由于 $\Sigma(\omega)$ 对能量的依赖性，准粒子方程是一个[非线性](@entry_id:637147)的本征值问题，求解起来非常复杂。在实践中，通常采用一种微扰性的方法，称为 $G_0W_0$。即以[DFT计算](@entry_id:1123635)得到的KS本征值 $\epsilon_{n\mathbf{k}}^{\text{KS}}$ 和[波函数](@entry_id:201714) $\psi_{n\mathbf{k}}^{\text{KS}}$ 为出发点（零阶近似 $G_0$），计算在该能量下的[自能](@entry_id:145608)[矩阵元](@entry_id:186505)，并以此修正KS能量：
$$
E_{n\mathbf{k}}^{\text{QP}} \approx \epsilon_{n\mathbf{k}}^{\text{KS}} + Z_{n\mathbf{k}} \langle \psi_{n\mathbf{k}}^{\text{KS}} | \Sigma(\epsilon_{n\mathbf{k}}^{\text{KS}}) - V_{\text{xc}} | \psi_{n\mathbf{k}}^{\text{KS}} \rangle
$$
这里的 $Z_{n\mathbf{k}}$ 称为 **[准粒子](@entry_id:136584)[重整化](@entry_id:143501)因子**，它源于对 $\Sigma(\omega)$ 能量依赖性的一阶[泰勒展开](@entry_id:145057)，是准粒子图像的一个核心特征，在静态的KS理论中没有对应物 。通过这种方式，GW方法能够显著改善[能隙](@entry_id:138445)的预测，并为半导体和绝缘体提供与实验高度符合的准粒子[能带结构](@entry_id:139379)。