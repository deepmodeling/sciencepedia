{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握态密度 (DOS) 的概念，从第一性原理出发推导其数学形式是至关重要的一步。本练习将指导您完成三维自由电子气模型的态密度推导，这是凝聚态物理中最基础的模型之一。通过这个过程，您将亲身体验如何将电子的能量-波矢色散关系 $E(\\mathbf{k})$ 与态密度 $g(E)$ 联系起来，并进一步理解投影态密度 (PDOS) 作为总态密度的加权形式的概念()。",
            "id": "3793791",
            "problem": "在多尺度材料模拟中，连续介观层面的热力学与输运性质通常通过电子态密度 (DOS) 和投影态密度 (PDOS) 计算得出，这两者将原子级量子态与粗粒化描述符联系起来。考虑一个体积为 $V$ 的宏观大立方体盒子中的三维自由电子气，其满足周期性边界条件。单粒子色散关系为 $\\epsilon(\\mathbf{k})=\\hbar^{2}|\\mathbf{k}|^{2}/(2m)$，其中 $m$ 是电子质量，$\\hbar$ 是约化普朗克常数。假设自旋简并因子为 $g_{s}=2$。\n\n从适用于此设定的第一性原理出发，使用以下基本要素：\n- DOS 定义为 $g(E)=\\frac{dN}{dE}$，其中 $N(E)$ 是能量小于或等于 $E$ 的单粒子态总数。\n- 允许的波矢 $\\mathbf{k}$ 集合在 $\\mathbf{k}$ 空间中形成一个均匀网格，其态密度为 $V/(2\\pi)^{3}$。\n- 在 $\\mathbf{k}$ 空间中，半径在 $k$ 和 $k+dk$ 之间的微分球壳的体积是 $4\\pi k^{2}\\,dk$。\n\n推导单位体积的总 DOS $g(E)/V$ 作为 $E$ 的函数。\n\n接下来，定义一个投影到局域子空间（例如，用于构建粗粒化描述符的类原子轨道函数）的投影算符 $\\hat{P}$。设归一化布洛赫态 $|\\psi_{\\mathbf{k}}\\rangle$ 的投影权重为 $w(\\mathbf{k})=\\langle \\psi_{\\mathbf{k}}|\\hat{P}|\\psi_{\\mathbf{k}}\\rangle$，并假设在给定的能量窗口内，此权重与能量无关，且等于一个常数 $w$。",
            "solution": "该问题要求推导三维自由电子气的单位体积投影态密度 (PDOS) $g_{\\mathrm{proj}}(E)/V$。推导将从第一性原理进行，首先计算总态密度 (DOS)，然后应用投影权重的概念。\n\n首先，我们推导单位体积的总态密度 $g(E)/V$。在一个小的能量区间 $dE$ 内的单粒子态数量 $dN$ 与 $\\mathbf{k}$ 空间中一个壳层的体积有关。问题指出色散关系是各向同性的，$\\epsilon(\\mathbf{k})=\\hbar^{2}|\\mathbf{k}|^{2}/(2m)$，因此等能面是 $\\mathbf{k}$ 空间中的球面。\n\n设 $k$ 是波矢 $\\mathbf{k}$ 的模。在 $\\mathbf{k}$ 空间中，半径为 $k$、厚度为 $dk$ 的球壳内的轨道态数量由 $\\mathbf{k}$ 空间中的态密度与该壳层体积的乘积给出。\n$\\mathbf{k}$ 空间中的态密度为 $V/(2\\pi)^{3}$。球壳的体积为 $4\\pi k^{2}\\,dk$。\n因此，该壳层中的轨道态数量为 $\\frac{V}{(2\\pi)^{3}} (4\\pi k^{2}\\,dk)$。\n每个轨道态可以被两个自旋相反的电子占据，因此我们必须包含自旋简并因子 $g_s=2$。该壳层中的单粒子态总数 $dN$ 为：\n$$dN = g_s \\frac{V}{(2\\pi)^{3}} (4\\pi k^{2}\\,dk) = 2 \\frac{V}{8\\pi^{3}} (4\\pi k^{2}\\,dk) = \\frac{V}{\\pi^{2}} k^{2}\\,dk$$\n态密度 $g(E)$ 定义为 $g(E) = dN/dE$。我们可以将此关系写为 $g(E) = \\frac{dN}{dk}\\frac{dk}{dE}$。从 $dN$ 的表达式，我们得到 $\\frac{dN}{dk} = \\frac{V}{\\pi^{2}} k^{2}$。\n\n为了求得 $\\frac{dk}{dE}$，我们使用色散关系 $E = \\epsilon(k) = \\frac{\\hbar^{2}k^{2}}{2m}$。将 $E$ 对 $k$ 求导得出：\n$$\\frac{dE}{dk} = \\frac{d}{dk}\\left(\\frac{\\hbar^{2}k^{2}}{2m}\\right) = \\frac{\\hbar^{2}}{2m}(2k) = \\frac{\\hbar^{2}k}{m}$$\n因此，$\\frac{dk}{dE} = \\left(\\frac{dE}{dk}\\right)^{-1} = \\frac{m}{\\hbar^{2}k}$。\n\n现在我们可以将 $g(E)$ 表示为：\n$$g(E) = \\frac{dN}{dE} = \\left(\\frac{V}{\\pi^{2}} k^{2}\\right) \\left(\\frac{m}{\\hbar^{2}k}\\right) = \\frac{Vm}{\\pi^{2}\\hbar^{2}} k$$\n为了将 DOS 表示为能量 $E$ 的函数，我们必须替换 $k$。从色散关系，$k^{2} = \\frac{2mE}{\\hbar^{2}}$，对于 $E \\geq 0$，这给出 $k = \\left(\\frac{2mE}{\\hbar^{2}}\\right)^{1/2}$。将此代入 $g(E)$ 的表达式中：\n$$g(E) = \\frac{Vm}{\\pi^{2}\\hbar^{2}} \\left(\\frac{2mE}{\\hbar^{2}}\\right)^{1/2} = \\frac{Vm}{\\pi^{2}\\hbar^{2}} \\frac{\\sqrt{2m}}{\\hbar} E^{1/2} = \\frac{V(2m)^{3/2}}{2\\pi^{2}\\hbar^{3}} E^{1/2}$$\n那么，单位体积的总 DOS $g(E)/V$ 为：\n$$\\frac{g(E)}{V} = \\frac{(2m)^{3/2}}{2\\pi^{2}\\hbar^{3}} E^{1/2} = \\frac{1}{2\\pi^{2}} \\left(\\frac{2m}{\\hbar^{2}}\\right)^{3/2} E^{1/2}$$\n\n接下来，我们推导投影态密度 $g_{\\mathrm{proj}}(E)$。PDOS 是态密度的一种加权度量。对于每个态 $|\\psi_{\\mathbf{k}}\\rangle$，其对 PDOS 的贡献由 $w(\\mathbf{k}) = \\langle \\psi_{\\mathbf{k}}|\\hat{P}|\\psi_{\\mathbf{k}}\\rangle$ 加权。PDOS 可以正式定义为：\n$$g_{\\mathrm{proj}}(E) = \\sum_{\\mathbf{k}, s} w(\\mathbf{k}) \\delta(E - \\epsilon(\\mathbf{k}))$$\n其中求和遍及所有态（波矢 $\\mathbf{k}$ 和自旋 $s$）。将求和转换为在 $\\mathbf{k}$ 空间上的积分：\n$$g_{\\mathrm{proj}}(E) = \\int g_s \\frac{V}{(2\\pi)^{3}} w(\\mathbf{k}) \\delta(E - \\epsilon(\\mathbf{k})) d^{3}k$$\n问题指出，在感兴趣的能量范围内，投影权重 $w(\\mathbf{k})$ 是一个常数 $w$。由于 $w$ 不依赖于 $\\mathbf{k}$，它可以从积分中提出来：\n$$g_{\\mathrm{proj}}(E) = w \\left( \\int g_s \\frac{V}{(2\\pi)^{3}} \\delta(E - \\epsilon(\\mathbf{k})) d^{3}k \\right)$$\n括号内的表达式恰好是总态密度 $g(E)$ 的定义。\n因此，投影态密度就是总态密度乘以常数投影权重 $w$：\n$$g_{\\mathrm{proj}}(E) = w \\cdot g(E)$$\n为了求得单位体积的投影态密度，我们除以 $V$：\n$$\\frac{g_{\\mathrm{proj}}(E)}{V} = w \\cdot \\frac{g(E)}{V}$$\n代入先前推导的单位体积总 DOS 的表达式，得到最终答案：\n$$\\frac{g_{\\mathrm{proj}}(E)}{V} = w \\frac{1}{2\\pi^{2}} \\left(\\frac{2m}{\\hbar^{2}}\\right)^{3/2} E^{1/2}$$\n对于给定的自由电子气模型，此表达式表示在由投影算符 $\\hat{P}$ 定义的子空间内，各态对态密度的贡献，作为能量 $E$ 的函数。",
            "answer": "$$\\boxed{w \\frac{1}{2\\pi^{2}} \\left( \\frac{2m}{\\hbar^{2}} \\right)^{3/2} E^{1/2}}$$"
        },
        {
            "introduction": "理论的价值在于应用。在推导出态密度的基本形式后，我们自然要问：如何使用它来理解和验证材料的物理性质？本练习提供了一个具体的应用场景：通过对一个简化的硅晶体价带态密度模型进行积分，您将计算出原胞中的价电子总数。这个练习旨在将抽象的态密度概念与材料的基本化学属性（如价电子数）联系起来，从而加深您对态密度物理意义的理解()。",
            "id": "3793817",
            "problem": "考虑一种具有金刚石结构的基准半导体，特别是晶体硅，在多尺度材料模拟中典型的平面波赝势框架内进行建模。其原胞包含$2$个等效原子。该赝势采用一种芯-价划分，其中原子的$1s$、$2s$和$2p$壳层被视为芯层，而$3s^{2}3p^{2}$电子被视为价电子。因此，每个原子的名义价电子数为$4$，每个原胞的价电子数为$8$。\n\n在有效零温下进行非自旋极化计算，因此费米-狄拉克占据数是一个阶跃函数。费米能级设置在$E_{F}=0\\,\\mathrm{eV}$，且价带完全位于$E_{F}$以下。每个原胞的总价态密度 (DOS)，分解为投影到原子中心轨道上的投影态密度 (PDOS) 分量，由代表$s$-like和$p$-like流形的紧支撑三角形函数近似。定义三角形形状函数\n$$\nT(E;E_{0},w)=\\begin{cases}\n1-\\frac{|E-E_{0}|}{w},  |E-E_{0}|\\leq w,\\\\\n0,  \\text{否则},\n\\end{cases}\n$$\n该函数以$E_{0}$为中心，半宽为$w$，峰高为单位1，并且在$[E_{0}-w,E_{0}+w]$上有有限支撑。\n\n每个原胞的价态密度由下式给出\n$$\nG_{v}(E)=2\\,C_{s}\\,T\\!\\left(E;E_{s},w_{s}\\right)+2\\,C_{p}\\,T\\!\\left(E;E_{p},w_{p}\\right),\n$$\n其中因子$2$是由于原胞中有两个原子，并且态密度包括了两个自旋通道。参数为\n$$\nE_{s}=-8\\,\\mathrm{eV},\\quad w_{s}=2\\,\\mathrm{eV},\\quad C_{s}=0.5\\,\\mathrm{states/eV},\n$$\n$$\nE_{p}=-3\\,\\mathrm{eV},\\quad w_{p}=3\\,\\mathrm{eV},\\quad C_{p}=1.0\\,\\mathrm{states/eV}.\n$$\n\n仅使用态密度和零温占据数的基本定义，计算每个原胞的总占据价态数，\n$$\nN_{v}=\\int_{-\\infty}^{E_{F}}G_{v}(E)\\,dE,\n$$\n并验证其与上述芯-价划分所隐含的名义价电子数的一致性。将您的最终结果$N_{v}$表示为单个实数。无需四舍五入，最终数值答案中不应包含单位。",
            "solution": "该问题要求计算晶体硅模型中每个原胞的总占据价态数$N_v$。该量定义为价态密度 (DOS) $G_v(E)$ 从负无穷大到费米能级$E_F$的积分。计算在零温下进行，此时占据函数是一个阶跃函数，意味着所有能量$E \\le E_F$的态都被占据，而所有$E > E_F$的态都是空的。\n\n问题给出了价态数的表达式：\n$$\nN_{v}=\\int_{-\\infty}^{E_{F}}G_{v}(E)\\,dE\n$$\n费米能级给定为 $E_F = 0\\,\\mathrm{eV}$。因此，积分变为：\n$$\nN_{v}=\\int_{-\\infty}^{0}G_{v}(E)\\,dE\n$$\n每个原胞的价态密度$G_v(E)$由两个分量之和给出，代表$s$-like和$p$-like电子流形：\n$$\nG_{v}(E)=2\\,C_{s}\\,T\\!\\left(E;E_{s},w_{s}\\right)+2\\,C_{p}\\,T\\!\\left(E;E_{p},w_{p}\\right)\n$$\n将$G_v(E)$的这个表达式代入$N_v$的积分中，我们可以利用积分的线性性质：\n$$\nN_{v}=\\int_{-\\infty}^{0} \\left[ 2\\,C_{s}\\,T\\!\\left(E;E_{s},w_{s}\\right)+2\\,C_{p}\\,T\\!\\left(E;E_{p},w_{p}\\right) \\right] dE\n$$\n$$\nN_{v}=2\\,C_{s}\\int_{-\\infty}^{0} T\\!\\left(E;E_{s},w_{s}\\right)\\,dE + 2\\,C_{p}\\int_{-\\infty}^{0} T\\!\\left(E;E_{p},w_{p}\\right)\\,dE\n$$\n现在我们必须分别计算这两个积分。每个积分都涉及三角形形状函数$T(E; E_0, w)$，该函数仅在有限区间$[E_0 - w, E_0 + w]$上非零。该函数在其整个支撑域上的积分代表一个底为$2w$、高为$1$的三角形的面积，即$\\frac{1}{2}(2w)(1) = w$。\n\n我们首先计算$s$-like分量的积分：\n$$\nI_s = \\int_{-\\infty}^{0} T\\!\\left(E;E_{s},w_{s}\\right)\\,dE\n$$\n$s$-like分量的参数是$E_s = -8\\,\\mathrm{eV}$和$w_s = 2\\,\\mathrm{eV}$。函数$T(E; E_s, w_s)$的支撑域是区间$[E_s - w_s, E_s + w_s]$，即$[-8-2, -8+2] = [-10, -6]\\,\\mathrm{eV}$。\n由于整个区间都低于积分上限$E_F = 0\\,\\mathrm{eV}$，所以积分覆盖了整个三角形函数。因此，积分的值就是三角形的面积，等于半宽$w_s$。\n$$\nI_s = \\int_{-10}^{-6} T\\!\\left(E;-8,2\\right)\\,dE = w_s = 2\\,\\mathrm{eV}\n$$\n注意，态密度分量 (states/eV) 对能量 (eV) 的积分得到的是态数（无量纲，因为eV/eV抵消了）。所以更精确地说，$I_s = 2$。\n\n接下来，我们计算$p$-like分量的积分：\n$$\nI_p = \\int_{-\\infty}^{0} T\\!\\left(E;E_{p},w_{p}\\right)\\,dE\n$$\n$p$-like分量的参数是$E_p = -3\\,\\mathrm{eV}$和$w_p = 3\\,\\mathrm{eV}$。函数$T(E; E_p, w_p)$的支撑域是区间$[E_p - w_p, E_p + w_p]$，即$[-3-3, -3+3] = [-6, 0]\\,\\mathrm{eV}$。\n同样，整个区间都包含在积分限$(-\\infty, 0]$内。支撑域的上边界与费米能级重合。因此，积分覆盖了整个三角形函数。其值是三角形的面积，等于半宽$w_p$。\n$$\nI_p = \\int_{-6}^{0} T\\!\\left(E;-3,3\\right)\\,dE = w_p = 3\\,\\mathrm{eV}\n$$\n与$s$-分量类似，积分的值是一个无量纲数，$I_p = 3$。\n\n现在我们可以将这些结果代回$N_v$的表达式中。给定的常数是$C_s = 0.5\\,\\mathrm{states/eV}$和$C_p = 1.0\\,\\mathrm{states/eV}$。\n$$\nN_{v}=2\\,C_{s}\\,I_s + 2\\,C_{p}\\,I_p\n$$\n代入常数和已计算积分的数值：\n$$\nN_{v}=2\\,(0.5) \\cdot (2) + 2\\,(1.0) \\cdot (3)\n$$\n$$\nN_{v}=1 \\cdot 2 + 2 \\cdot 3\n$$\n$$\nN_{v}=2 + 6\n$$\n$$\nN_{v}=8\n$$\n每个原胞的总占据价态数为$8$。\n\n该问题还要求将此结果与名义价电子数进行验证。晶体硅的芯-价划分为$[Ne]3s^23p^2$，意味着每个硅原子贡献$4$个价电子。金刚石结构的原胞包含$2$个原子。因此，每个原胞的名义价电子数为$2 \\text{ 原子} \\times 4 \\text{ 电子/原子} = 8 \\text{ 电子}$。\n在零温下，占据的态数必须等于电子数。我们计算出的值$N_v = 8$与原胞的名义价电子数$8$完全一致。这证实了所提供的态密度模型的自洽性。参数$C_s$和$C_p$的定义使得在这个简化模型中，对各自的投影态密度分量进行积分，可以得到$s$-like和$p$-like带的正确态数。\n$s$-like态数：$2 C_s w_s = 2 \\times 0.5 \\times 2 = 2$。\n$p$-like态数：$2 C_p w_p = 2 \\times 1.0 \\times 3 = 6$。\n总态数 = $2+6=8$。",
            "answer": "$$\n\\boxed{8}\n$$"
        },
        {
            "introduction": "在现代材料模拟中，我们处理的往往不是解析模型，而是来自复杂计算（如密度泛函理论）的大量数据。本练习将带您从理想化的模型进入真实的数据分析世界。您需要辨别出一种科学上严谨且数值上稳健的流程，用于处理、分析和验证从第一性原理计算中获得的态密度 (DOS) 和投影态密度 (PDOS) 数据。这个过程将迫使您思考有限温效应、投影不完备性以及间隙电荷等在实际计算中至关重要的细节问题()。",
            "id": "3793777",
            "problem": "一次使用投影缀加波 (Projector Augmented-Wave, PAW) 方法的自旋极化平面波密度泛函理论 (Density Functional Theory, DFT) 计算，输出了一个总态密度 (total density of states, DOS) 文件和一个投影态密度 (projected density of states, PDOS) 文件。每个文件都包含一个公共的离散能量格点 $E_i$（单位为 $\\text{eV}$），格点间距均匀为 $\\Delta E$，并以费米能 $E_{\\mathrm{F}}$ 为参考（因此 $E = 0$ 对应于费米能级）。总 DOS 文件提供了 $D^{\\uparrow}(E_i)$ 和 $D^{\\downarrow}(E_i)$，单位是态/$\\text{eV}$/原胞；PDOS 文件则为每个原子轨道通道 $\\alpha$（例如，分立原子的 $s$、$p$、$d$ 通道）提供了 $D_{\\alpha}^{\\uparrow}(E_i)$ 和 $D_{\\alpha}^{\\downarrow}(E_i)$，单位同样是态/$\\text{eV}$/原胞。计算中使用了有限的电子温度 $T$，并对自旋 $\\sigma \\in \\{\\uparrow,\\downarrow\\}$ 使用了费米-狄拉克 (Fermi–Dirac) 占据函数 $f_{\\sigma}(E;T,\\mu)$，其中化学势 $\\mu$ 与 $E_{\\mathrm{F}}$ 对齐。\n\n任务要求是计算选定能量窗口 $[E_1,E_2]$ 内的归一化轨道布居数，并验证 PDOS 的总和在合理的数值容差范围内能够复现总 DOS。你的后处理过程必须是科学上稳健的，并基于第一性原理。\n\n基本原理：\n- 自旋为 $\\sigma$ 的总 DOS 定义为 $D^{\\sigma}(E) = \\sum_{n,\\mathbf{k}} \\delta\\!\\left(E - \\varepsilon_{n\\mathbf{k}\\sigma}\\right)$，其中 $\\varepsilon_{n\\mathbf{k}\\sigma}$ 是 Kohn–Sham 本征值，求和包含了布里渊区 (Brillouin-zone) 权重。\n- 投影到轨道通道 $\\alpha$ 上且自旋为 $\\sigma$ 的 PDOS 定义为 $D_{\\alpha}^{\\sigma}(E) = \\sum_{n,\\mathbf{k}} \\left|\\langle \\phi_{\\alpha} \\mid \\psi_{n\\mathbf{k}\\sigma} \\rangle \\right|^2 \\delta\\!\\left(E - \\varepsilon_{n\\mathbf{k}\\sigma}\\right)$，其中 $\\phi_{\\alpha}$ 是一个局域投影算符，$\\psi_{n\\mathbf{k}\\sigma}$ 是一个 Kohn–Sham 态。\n- 某一能量区间内的电子布居数是通过在该区间内对由费米-狄拉克占据函数 $f_{\\sigma}(E;T,\\mu)$ 加权的 DOS 进行积分得到的。\n\n哪个选项最能描述一个正确且数值上稳健的程序，用以解析和后处理 PDOS 和总 DOS 文件，从而获得 $[E_1,E_2]$ 上的归一化轨道布居数，并验证其总和能够复现总 DOS？\n\nA. 解析 $E_i$、$D^{\\uparrow}(E_i)$、$D^{\\downarrow}(E_i)$ 以及 $D_{\\alpha}^{\\uparrow}(E_i)$、$D_{\\alpha}^{\\downarrow}(E_i)$；假设 $E_i$ 已经对齐到 $E_{\\mathrm{F}}$ 且格点在所有文件中都相同。对于选定的窗口 $[E_1,E_2]$，对每个 $\\alpha$ 计算平均值 $A_{\\alpha} = \\frac{1}{N_{\\mathrm{win}}} \\sum_{E_i \\in [E_1,E_2]} \\left[D_{\\alpha}^{\\uparrow}(E_i) + D_{\\alpha}^{\\downarrow}(E_i)\\right]$，其中 $N_{\\mathrm{win}}$ 是窗口内的格点数。通过对 $\\alpha$ 的总和进行归一化，$p_{\\alpha} = A_{\\alpha} / \\sum_{\\alpha'} A_{\\alpha'}$，得到轨道布居数。通过精确检查在 $[E_1,E_2]$ 内对所有 $E_i$ 是否有 $\\sum_{\\alpha} D_{\\alpha}^{\\sigma}(E_i) = D^{\\sigma}(E_i)$ 来验证 PDOS 的一致性。\n\nB. 解析 $E_i$ 以及自旋分辨的 DOS 和 PDOS。如果能量格点不一致，则使用一个能保持能量积分面积守恒的方案（例如，与梯形法则一致的线性插值）将所有 PDOS 通道 $D_{\\alpha}^{\\sigma}(E)$ 插值到总 DOS 的格点上。确认 $E=0$ 对应 $E_{\\mathrm{F}}$，或者平移能量使 $E_{\\mathrm{F}}$ 位于 $E=0$。对于一个窗口 $[E_1,E_2]$，通过与数据一致的数值积分方法（例如，步长为 $\\Delta E$ 的梯形法则）在公共格点上进行数值计算，得到窗口内的电子数 $N_{\\mathrm{win}} = \\sum_{\\sigma} \\int_{E_1}^{E_2} D^{\\sigma}(E)\\, f_{\\sigma}(E;T,\\mu)\\, \\mathrm{d}E$。对每个轨道通道 $\\alpha$，使用相同的数值积分方法计算 $n_{\\alpha} = \\sum_{\\sigma} \\int_{E_1}^{E_2} D_{\\alpha}^{\\sigma}(E)\\, f_{\\sigma}(E;T,\\mu)\\, \\mathrm{d}E$。定义归一化轨道布居数 $p_{\\alpha} = n_{\\alpha}/N_{\\mathrm{win}}$。通过两种方式验证 PDOS 的一致性：逐点比较窗口内的 $\\sum_{\\alpha} D_{\\alpha}^{\\sigma}(E_i)$ 和 $D^{\\sigma}(E_i)$，并报告残差 $R^{\\sigma}(E_i) = D^{\\sigma}(E_i) - \\sum_{\\alpha} D_{\\alpha}^{\\sigma}(E_i)$；以及在积分意义上，检查 $\\sum_{\\alpha} n_{\\alpha}$ 与 $N_{\\mathrm{win}}$ 的差异是否仅为一个可归因于间隙贡献和投影不完备性贡献的小残差，并相对于 $N_{\\mathrm{win}}$ 进行量化。\n\nC. 只解析 PDOS 文件。对每个轨道通道 $\\alpha$，计算 $S_{\\alpha} = \\sum_{E_i \\in [E_1,E_2]} \\left[D_{\\alpha}^{\\uparrow}(E_i) + D_{\\alpha}^{\\downarrow}(E_i)\\right]$ 而不乘以 $\\Delta E$，并归一化为 $p_{\\alpha} = S_{\\alpha}/\\sum_{\\alpha'} S_{\\alpha'}$。由于 PDOS 是投影，通过一个公共的、依赖于能量的因子对每个 $D_{\\alpha}^{\\sigma}(E_i)$ 进行重新缩放，以强制执行精确的求和规则，使得在每个 $E_i$ 处都有 $\\sum_{\\alpha} D_{\\alpha}^{\\sigma}(E_i)$ 等于 $D^{\\sigma}(E_i)$；然后接受重新缩放后的布居数为物理上正确的结果。\n\nD. 解析所有文件。为获得归一化轨道布居数，对 $D_{\\alpha}^{\\sigma}(E)$ 在 $[E_1,E_2]$ 上进行积分，不进行任何占据数加权，然后将各项除以计算中的 Kohn–Sham 能带总数 $N_{\\mathrm{bands}}$，得到 $p_{\\alpha}$。对于 PDOS 验证，仅将单个代表性原子的 $s$、$p$ 和 $d$ 通道之和与整个原胞的总 DOS 进行比较，如果形状不同，则应用一个选定宽度的高斯平滑，直到形状匹配，然后宣布 PDOS 求和规则得到满足。\n\nE. 解析 $E_i$、$D^{\\sigma}(E_i)$ 和 $D_{\\alpha}^{\\sigma}(E_i)$。计算 $[E_1,E_2]$ 上的布居数为 $n_{\\alpha} = \\sum_{\\sigma} \\int_{E_1}^{E_2} D_{\\alpha}^{\\sigma}(E)\\,\\mathrm{d}E$，并用系统中的电子总数 $N_{\\mathrm{e,tot}}$ 进行归一化，而不管窗口如何，$p_{\\alpha} = n_{\\alpha}/N_{\\mathrm{e,tot}}$。通过检查 $\\sum_{\\alpha} n_{\\alpha} = N_{\\mathrm{e,tot}}$ 来验证 PDOS 的一致性；如果不等，则将差值均匀地加到所有 $n_{\\alpha}$ 上以强制相等。",
            "solution": "### 第 1 步：提取已知信息\n问题为一次使用投影缀加波 (Projector Augmented-Wave, PAW) 方法的自旋极化平面波密度泛函理论 (DFT) 计算提供了以下信息：\n- **输入数据**: 一个总态密度 (DOS) 文件和一个投影态密度 (PDOS) 文件。\n- **数据内容**:\n    - 一个公共的离散能量格点 $E_i$，具有均匀的间距 $\\Delta E$。\n    - 能量值的单位是 $\\text{eV}$。\n    - 能量参考是费米能 $E_{\\mathrm{F}}$，因此 $E=0$ 对应 $E_{\\mathrm{F}}$。\n    - 总 DOS: $D^{\\uparrow}(E_i)$ 和 $D^{\\downarrow}(E_i)$，单位是 态/$\\text{eV}$/原胞。\n    - 投影 DOS: $D_{\\alpha}^{\\uparrow}(E_i)$ 和 $D_{\\alpha}^{\\downarrow}(E_i)$，对应每个原子轨道通道 $\\alpha$，单位是 态/$\\text{eV}$/原胞。\n- **物理条件**:\n    - 计算使用了有限的电子温度 $T$。\n    - 占据由费米-狄拉克函数 $f_{\\sigma}(E;T,\\mu)$ 描述，对应自旋 $\\sigma \\in \\{\\uparrow,\\downarrow\\}$。\n    - 化学势 $\\mu$ 与 $E_{\\mathrm{F}}$ 对齐。\n- **基本原理**:\n    - 总 DOS 定义: $D^{\\sigma}(E) = \\sum_{n,\\mathbf{k}} \\delta\\!\\left(E - \\varepsilon_{n\\mathbf{k}\\sigma}\\right)$，其中 $\\varepsilon_{n\\mathbf{k}\\sigma}$ 是 Kohn–Sham 本征值。\n    - 投影 DOS 定义: $D_{\\alpha}^{\\sigma}(E) = \\sum_{n,\\mathbf{k}} \\left|\\langle \\phi_{\\alpha} \\mid \\psi_{n\\mathbf{k}\\sigma} \\rangle \\right|^2 \\delta\\!\\left(E - \\varepsilon_{n\\mathbf{k}\\sigma}\\right)$，其中 $\\phi_{\\alpha}$ 是一个局域投影算符。\n    - 电子布居数定义: 能量区间内的布居数是 DOS 经费米-狄拉克占据函数加权后在该区间上的积分。\n\n### 第 2 步：使用提取的已知信息进行验证\n基于既定标准评估问题陈述：\n- **科学基础扎实**: 问题牢固地植根于计算材料科学和固态物理的标准实践中。总 DOS、投影 DOS 的定义以及计算电子布居数的方法都是标准且正确的。PAW DFT 计算的背景，包括自旋极化和有限温度效应，在物理上和计算上都是现实的。PAW 方法中投影算符基组 $\\{\\phi_\\alpha\\}$ 的固有不完备性，导致 $\\sum_{\\alpha} D_{\\alpha}^{\\sigma}(E) \\neq D^{\\sigma}(E)$，是此类计算的一个众所周知的特征，其差异被正确地归因于间隙贡献。\n- **问题定义明确**: 任务定义清晰：找到一个正确且数值上稳健的程序，以计算能量窗口 $[E_1, E_2]$ 内的归一化轨道布居数，并验证 PDOS 和总 DOS 之间的关系。给定的信息和基本原理足以构建这样一个程序。\n- **客观性**: 问题以精确、技术性的语言陈述，没有歧义或主观看法。\n\n### 第 3 步：结论与行动\n问题陈述是**有效的**。它描述了 DFT 结果分析中的一个标准、定义明确的任务。可以从提供的第一性原理推导出解决方案。\n\n### 正确流程的推导\n\n一个科学上正确且数值上稳健的程序必须遵守所提供的基本原理。\n\n$1$. **电子布居数计算**: 问题指出，电子布居数是通过对经费米-狄拉克占据函数加权的 DOS 进行积分得到的。因此，在能量窗口 $[E_1, E_2]$ 内，与轨道通道 $\\alpha$ 和自旋 $\\sigma$ 相关的电子数是：\n$$n_{\\alpha}^{\\sigma} = \\int_{E_1}^{E_2} D_{\\alpha}^{\\sigma}(E) f_{\\sigma}(E;T,\\mu) \\, \\mathrm{d}E$$\n通道 $\\alpha$ 的总布居数是自旋求和：\n$$n_{\\alpha} = \\sum_{\\sigma \\in \\{\\uparrow, \\downarrow\\}} n_{\\alpha}^{\\sigma} = \\sum_{\\sigma \\in \\{\\uparrow, \\downarrow\\}} \\int_{E_1}^{E_2} D_{\\alpha}^{\\sigma}(E) f_{\\sigma}(E;T,\\mu) \\, \\mathrm{d}E$$\n同样，窗口 $[E_1, E_2]$ 内的总电子布居数由总 DOS 计算得出：\n$$N_{\\mathrm{win}} = \\sum_{\\sigma \\in \\{\\uparrow, \\downarrow\\}} \\int_{E_1}^{E_2} D^{\\sigma}(E) f_{\\sigma}(E;T,\\mu) \\, \\mathrm{d}E$$\n由于提供的 DOS 数据是在间距为 $\\Delta E$ 的离散格点 $E_i$ 上，这些积分必须进行数值计算。梯形法则是数值积分的一个稳健选择，因为它与格点之间 DOS 线性变化的假设相符。\n\n$2$. **归一化**: 问题要求的是窗口 $[E_1, E_2]$ 上的*归一化*轨道布居数。一个有意义的归一化是将给定通道的布居数 $n_{\\alpha}$ 表示为同一窗口内总布居数 $N_{\\mathrm{win}}$ 的一部分。因此，归一化布居数为 $p_{\\alpha} = n_{\\alpha} / N_{\\mathrm{win}}$。\n\n$3$. **PDOS 一致性检查**: PDOS 的基本定义涉及一个投影 $\\left|\\langle \\phi_{\\alpha} \\mid \\psi_{n\\mathbf{k}\\sigma} \\rangle \\right|^2$。在 PAW 或类似方法中使用的以原子为中心的投影函数集 $\\{\\phi_{\\alpha}\\}$ 并非整个晶体体积的完备基组。因此，对于任何给定的 Kohn-Sham 态 $\\psi_{n\\mathbf{k}\\sigma}$，投影之和小于 1：$\\sum_{\\alpha} |\\langle \\phi_{\\alpha} | \\psi_{n\\mathbf{k}\\sigma} \\rangle |^2  1$。这直接意味着投影态密度之和小于总态密度：\n$$\\sum_{\\alpha} D_{\\alpha}^{\\sigma}(E) \\le D^{\\sigma}(E)$$\n差值 $D^{\\sigma}(E) - \\sum_{\\alpha} D_{\\alpha}^{\\sigma}(E)$ 代表了位于原子间隙区域的电子态部分，这部分未被原子投影算符捕获。因此，一个正确的验证程序*不能*强制执行精确的相等关系。它应该量化这个具有物理意义的差异。这可以通过两种方式完成：\n- **逐点验证**: 通过计算和分析残差函数 $R^{\\sigma}(E_i) = D^{\\sigma}(E_i) - \\sum_{\\alpha} D_{\\alpha}^{\\sigma}(E_i)$，针对每个能量点 $E_i$。\n- **积分验证**: 通过比较积分电子数：$N_{\\mathrm{win}}$ 与 $\\sum_{\\alpha} n_{\\alpha}$。差值 $N_{\\mathrm{win}} - \\sum_{\\alpha} n_{\\alpha}$ 代表了能量窗口 $[E_1, E_2]$ 内的总间隙电子布居数。\n\n$4$. **数值稳健性**: 尽管问题陈述能量格点是公共的，但一个真正稳健的程序会验证这一点，如果它们不同，会将所有数据插值到一个单一的公共格点上。插值方案的选择必须能保守积分量（态数），这使得像保持面积的线性插值这样的方法是合适的。\n\n### 逐项分析选项\n\n**A. 解析 $E_i$、$D^{\\uparrow}(E_i)$、$D^{\\downarrow}(E_i)$ 以及 $D_{\\alpha}^{\\uparrow}(E_i)$、$D_{\\alpha}^{\\downarrow}(E_i)$；假设 $E_i$ 已经对齐到 $E_{\\mathrm{F}}$ 且格点在所有文件中都相同。对于选定的窗口 $[E_1,E_2]$，对每个 $\\alpha$ 计算平均值 $A_{\\alpha} = \\frac{1}{N_{\\mathrm{win}}} \\sum_{E_i \\in [E_1,E_2]} \\left[D_{\\alpha}^{\\uparrow}(E_i) + D_{\\alpha}^{\\downarrow}(E_i)\\right]$，其中 $N_{\\mathrm{win}}$ 是窗口内的格点数。通过对 $\\alpha$ 的总和进行归一化，$p_{\\alpha} = A_{\\alpha} / \\sum_{\\alpha'} A_{\\alpha'}$，得到轨道布居数。通过精确检查在 $[E_1,E_2]$ 内对所有 $E_i$ 是否有 $\\sum_{\\alpha} D_{\\alpha}^{\\sigma}(E_i) = D^{\\sigma}(E_i)$ 来验证 PDOS 的一致性。**\n- **评析**: 此选项犯了三个关键错误。首先，它计算的是*平均* DOS 值，而不是积分布居数；它忽略了对于积分至关重要的格点间距 $\\Delta E$。其次，它完全忽略了费米-狄拉克占据函数 $f_{\\sigma}(E;T,\\mu)$，因此计算的是*态*数，而不是*电子*数。第三，它错误地要求 PDOS 的总和必须*精确*等于总 DOS，这与周期性固体中局域轨道投影的物理原理相矛盾。\n- **结论**: **错误**。\n\n**B. 解析 $E_i$ 以及自旋分辨的 DOS 和 PDOS。如果能量格点不一致，则使用一个能保持能量积分面积守恒的方案（例如，与梯形法则一致的线性插值）将所有 PDOS 通道 $D_{\\alpha}^{\\sigma}(E)$ 插值到总 DOS 的格点上。确认 $E=0$ 对应 $E_{\\mathrm{F}}$，或者平移能量使 $E_{\\mathrm{F}}$ 位于 $E=0$。对于一个窗口 $[E_1,E_2]$，通过与数据一致的数值积分方法（例如，步长为 $\\Delta E$ 的梯形法则）在公共格点上进行数值计算，得到窗口内的电子数 $N_{\\mathrm{win}} = \\sum_{\\sigma} \\int_{E_1}^{E_2} D^{\\sigma}(E)\\, f_{\\sigma}(E;T,\\mu)\\, \\mathrm{d}E$。对每个轨道通道 $\\alpha$，使用相同的数值积分方法计算 $n_{\\alpha} = \\sum_{\\sigma} \\int_{E_1}^{E_2} D_{\\alpha}^{\\sigma}(E)\\, f_{\\sigma}(E;T,\\mu)\\, \\mathrm{d}E$。定义归一化轨道布居数 $p_{\\alpha} = n_{\\alpha}/N_{\\mathrm{win}}$。通过两种方式验证 PDOS 的一致性：逐点比较窗口内的 $\\sum_{\\alpha} D_{\\alpha}^{\\sigma}(E_i)$ 和 $D^{\\sigma}(E_i)$，并报告残差 $R^{\\sigma}(E_i) = D^{\\sigma}(E_i) - \\sum_{\\alpha} D_{\\alpha}^{\\sigma}(E_i)$；以及在积分意义上，检查 $\\sum_{\\alpha} n_{\\alpha}$ 与 $N_{\\mathrm{win}}$ 的差异是否仅为一个可归因于间隙贡献和投影不完备性贡献的小残差，并相对于 $N_{\\mathrm{win}}$ 进行量化。**\n- **评析**: 此选项正确地遵循了所有从第一性原理推导出的步骤。它包括了数值上稳健的做法（格点检查、守恒插值），正确地应用了费米-狄拉克函数通过数值积分计算电子布居数，使用了合理的归一化方法，并通过量化残差而不是强制一个不正确的等式来进行物理上合理的验证。这个程序既正确又稳健。\n- **结论**: **正确**。\n\n**C. 只解析 PDOS 文件。对每个轨道通道 $\\alpha$，计算 $S_{\\alpha} = \\sum_{E_i \\in [E_1,E_2]} \\left[D_{\\alpha}^{\\uparrow}(E_i) + D_{\\alpha}^{\\downarrow}(E_i)\\right]$ 而不乘以 $\\Delta E$，并归一化为 $p_{\\alpha} = S_{\\alpha}/\\sum_{\\alpha'} S_{\\alpha'}$。由于 PDOS 是投影，通过一个公共的、依赖于能量的因子对每个 $D_{\\alpha}^{\\sigma}(E_i)$ 进行重新缩放，以强制执行精确的求和规则，使得在每个 $E_i$ 处都有 $\\sum_{\\alpha} D_{\\alpha}^{\\sigma}(E_i)$ 等于 $D^{\\sigma}(E_i)$；然后接受重新缩放后的布居数为物理上正确的结果。**\n- **评析**: 这个程序有多个缺陷。它没有执行积分（忽略了 $\\Delta E$）并且忽略了占据函数。更根本的是，它丢弃了用于验证的总 DOS 文件，然后通过非物理地重新缩放数据来强制执行一个精确的求和规则。这种缩放破坏了关于投影完备性和间隙电荷的定量信息。\n- **结论**: **错误**。\n\n**D. 解析所有文件。为获得归一化轨道布居数，对 $D_{\\alpha}^{\\sigma}(E)$ 在 $[E_1,E_2]$ 上进行积分，不进行任何占据数加权，然后将各项除以计算中的 Kohn–Sham 能带总数 $N_{\\mathrm{bands}}$，得到 $p_{\\alpha}$。对于 PDOS 验证，仅将单个代表性原子的 $s$、$p$ 和 $d$ 通道之和与整个原胞的总 DOS 进行比较，如果形状不同，则应用一个选定宽度的高斯平滑，直到形状匹配，然后宣布 PDOS 求和规则得到满足。**\n- **评析**: 这个选项在每一点上都是错误的。它错误地忽略了占据函数。用 $N_{\\mathrm{bands}}$ 进行归一化是任意的，且量纲不一致。验证程序是无效的：它将*单个原子*的 PDOS 与*整个原胞*的 DOS 进行比较，这是一个无意义的比较。使用高斯平滑来强制匹配是不科学的数据操纵，而不是验证。\n- **结论**: **错误**。\n\n**E. 解析 $E_i$、$D^{\\sigma}(E_i)$ 和 $D_{\\alpha}^{\\sigma}(E_i)$。计算 $[E_1,E_2]$ 上的布居数为 $n_{\\alpha} = \\sum_{\\sigma} \\int_{E_1}^{E_2} D_{\\alpha}^{\\sigma}(E)\\,\\mathrm{d}E$，并用系统中的电子总数 $N_{\\mathrm{e,tot}}$ 进行归一化，而不管窗口如何，$p_{\\alpha} = n_{\\alpha}/N_{\\mathrm{e,tot}}$。通过检查 $\\sum_{\\alpha} n_{\\alpha} = N_{\\mathrm{e,tot}}$ 来验证 PDOS 的一致性；如果不等，则将差值均匀地加到所有 $n_{\\alpha}$ 上以强制相等。**\n- **评析**: 此选项错误地从积分中省略了占据函数。相对于系统中的电子总数 $N_{\\mathrm{e,tot}}$ 进行归一化，并不是衡量*窗口内*布居特征的度量。验证步骤是有缺陷的；特定窗口内的电子总和 $\\sum_{\\alpha} n_{\\alpha}$ 不应等于系统中的电子总数 $N_{\\mathrm{e,tot}}$（除非窗口覆盖了所有占据态）。最后，“将差值均匀地加上”是另一个非物理性数据篡改的例子。\n- **结论**: **错误**。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}