{
    "hands_on_practices": [
        {
            "introduction": "在进行任何倒空间计算之前，首要任务是正确构建采样网格。本练习将引导你完成一个基础但至关重要的过程：为一个常见的非立方晶系（六方晶系）推导其倒易晶格，并在此基础上构建一个Monkhorst-Pack网格。通过这个实践，你将掌握在正空间和倒空间之间转换以及应用k点采样基本定义的关键技能。",
            "id": "3818403",
            "problem": "考虑一个三维六方Bravais格子，其常规晶胞参数为沿格矢 $\\mathbf{a}_{1}$、$\\mathbf{a}_{2}$ 和 $\\mathbf{a}_{3}$ 的长度 $a$、$a$ 和 $c$，轴间角为 $(90^\\circ, 90^\\circ, 120^\\circ)$。取一个笛卡尔坐标系嵌入，其中正空间原胞基矢为\n$$\n\\mathbf{a}_{1} = a\\,(1,0,0),\\quad \\mathbf{a}_{2} = a\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}, 0\\right),\\quad \\mathbf{a}_{3} = c\\,(0,0,1).\n$$\n从倒易点阵的基本定义出发，即倒易原胞基矢 $\\mathbf{b}_{i}$ 满足 $\\mathbf{a}_{i}\\cdot \\mathbf{b}_{j} = 2\\pi\\,\\delta_{ij}$，执行以下操作：\n\n1) 推导倒易点阵原胞基矢 $\\mathbf{b}_{1}$、$\\mathbf{b}_{2}$ 和 $\\mathbf{b}_{3}$ 的笛卡尔分量。\n\n2) 使用第一性原理，对具有反演对称性和周期性边界条件的布里渊区进行均匀采样，显式构建一个 $6\\times 6\\times 4$ Monkhorst-Pack (MP) 网格的分数坐标集。此处，“分数坐标”是指展开式 $\\mathbf{k}=u_{1}\\mathbf{b}_{1}+u_{2}\\mathbf{b}_{2}+u_{3}\\mathbf{b}_{3}$ 中的系数 $(u_{1},u_{2},u_{3})$。请提供沿每个倒易基矢方向的一维分数坐标列表，并指明完整的网格是它们的笛卡尔积；您无需逐个枚举所有点。\n\n3) 令 $V_{\\text{BZ}}$ 表示倒易原胞的布里渊区体积，并令 $N_{k}=6\\times 6\\times 4$。假设 MP 网格上的权重是均匀的，计算由 $w = V_{\\text{BZ}}/N_{k}$ 定义的每个 $\\mathbf{k}$ 点的积分权重 $w$，并用 $a$ 和 $c$ 的符号表示。请将 $w$ 的最终答案以立方长度的倒数单位表示（如果 $a$ 和 $c$ 的单位是 $\\text{\\AA}$，则 $w$ 的单位是 $\\text{\\AA}^{-3}$）。不代入任何数值。请将最终答案表示为单个简化的解析表达式。不要四舍五入。",
            "solution": "我们从倒易点阵的定义开始。对于一组正空间原胞基矢 $\\{\\mathbf{a}_{1},\\mathbf{a}_{2},\\mathbf{a}_{3}\\}$，倒易原胞基矢 $\\{\\mathbf{b}_{1},\\mathbf{b}_{2},\\mathbf{b}_{3}\\}$ 由以下关系定义\n$$\n\\mathbf{a}_{i}\\cdot \\mathbf{b}_{j}=2\\pi\\,\\delta_{ij}.\n$$\n一个构造性表达式是\n$$\n\\mathbf{b}_{1} = 2\\pi\\,\\frac{\\mathbf{a}_{2}\\times \\mathbf{a}_{3}}{\\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times \\mathbf{a}_{3})},\\quad\n\\mathbf{b}_{2} = 2\\pi\\,\\frac{\\mathbf{a}_{3}\\times \\mathbf{a}_{1}}{\\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times \\mathbf{a}_{3})},\\quad\n\\mathbf{b}_{3} = 2\\pi\\,\\frac{\\mathbf{a}_{1}\\times \\mathbf{a}_{2}}{\\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times \\mathbf{a}_{3})}.\n$$\n首先计算晶胞体积 $ \\Omega $：\n$$\n\\Omega = \\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times \\mathbf{a}_{3}).\n$$\n使用给定的矢量，\n$$\n\\mathbf{a}_{2}\\times \\mathbf{a}_{3} = a\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}, 0\\right)\\times c(0,0,1) = \\left(\\frac{\\sqrt{3}\\,a c}{2}, -\\frac{a c}{2}, 0\\right),\n$$\n所以\n$$\n\\Omega = \\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times \\mathbf{a}_{3}) = a(1,0,0)\\cdot \\left(\\frac{\\sqrt{3}\\,a c}{2}, -\\frac{a c}{2}, 0\\right) = \\frac{\\sqrt{3}}{2}\\,a^{2}c.\n$$\n因此，\n$$\n\\mathbf{b}_{1} = 2\\pi\\,\\frac{\\left(\\frac{\\sqrt{3}\\,a c}{2}, -\\frac{a c}{2}, 0\\right)}{\\frac{\\sqrt{3}}{2}\\,a^{2}c} = \\frac{2\\pi}{a}\\left(1, -\\frac{1}{\\sqrt{3}}, 0\\right).\n$$\n接下来，\n$$\n\\mathbf{a}_{3}\\times \\mathbf{a}_{1} = c(0,0,1)\\times a(1,0,0) = (0, c a, 0),\n$$\n所以\n$$\n\\mathbf{b}_{2} = 2\\pi\\,\\frac{(0, c a, 0)}{\\frac{\\sqrt{3}}{2}\\,a^{2}c} = \\left(0, \\frac{4\\pi}{\\sqrt{3}\\,a}, 0\\right).\n$$\n最后，\n$$\n\\mathbf{a}_{1}\\times \\mathbf{a}_{2} = a(1,0,0)\\times a\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2},0\\right) = \\left(0,0,\\frac{\\sqrt{3}}{2}\\,a^{2}\\right),\n$$\n得到\n$$\n\\mathbf{b}_{3} = 2\\pi\\,\\frac{\\left(0,0,\\frac{\\sqrt{3}}{2}\\,a^{2}\\right)}{\\frac{\\sqrt{3}}{2}\\,a^{2}c} = \\left(0,0,\\frac{2\\pi}{c}\\right).\n$$\n因此，倒易原胞基矢的笛卡尔分量为\n$$\n\\mathbf{b}_{1} = \\frac{2\\pi}{a}\\left(1, -\\frac{1}{\\sqrt{3}}, 0\\right),\\quad\n\\mathbf{b}_{2} = \\left(0, \\frac{4\\pi}{\\sqrt{3}\\,a}, 0\\right),\\quad\n\\mathbf{b}_{3} = \\left(0, 0, \\frac{2\\pi}{c}\\right).\n$$\n\n现在我们为尺寸为 $6\\times 6\\times 4$ 的 Monkhorst-Pack 网格构建分数坐标集。沿单个倒易点阵方向，对偶数个点 $N$ 进行均匀、反演对称的采样，方法是将 $N$ 个点对称地置于原点周围，位置均匀分布且避开 $\\Gamma$ 点。由此得到的一维分数坐标 $\\{u_{m}\\}$（在该方向上由 $k=u\\,b$ 定义）为\n$$\nu_{m}=\\frac{2 m - N - 1}{2 N},\\quad m=1,2,\\dots,N.\n$$\n对于 $N=6$，这得到\n$$\n\\left\\{-\\frac{5}{12},\\,-\\frac{3}{12},\\,-\\frac{1}{12},\\,\\frac{1}{12},\\,\\frac{3}{12},\\,\\frac{5}{12}\\right\\}\n=\n\\left\\{-\\frac{5}{12},\\,-\\frac{1}{4},\\,-\\frac{1}{12},\\,\\frac{1}{12},\\,\\frac{1}{4},\\,\\frac{5}{12}\\right\\}.\n$$\n对于 $N=4$，这得到\n$$\n\\left\\{-\\frac{3}{8},\\,-\\frac{1}{8},\\,\\frac{1}{8},\\,\\frac{3}{8}\\right\\}.\n$$\n因此，相对于 $(\\mathbf{b}_{1},\\mathbf{b}_{2},\\mathbf{b}_{3})$ 的 $6\\times 6\\times 4$ Monkhorst-Pack 网格，其分数坐标 $(u_{1},u_{2},u_{3})$ 是以下三个列表的笛卡尔积\n$$\nu_{1}\\in \\left\\{-\\frac{5}{12},\\,-\\frac{1}{4},\\,-\\frac{1}{12},\\,\\frac{1}{12},\\,\\frac{1}{4},\\,\\frac{5}{12}\\right\\},\\quad\nu_{2}\\in \\left\\{-\\frac{5}{12},\\,-\\frac{1}{4},\\,-\\frac{1}{12},\\,\\frac{1}{12},\\,\\frac{1}{4},\\,\\frac{5}{12}\\right\\},\\quad\nu_{3}\\in \\left\\{-\\frac{3}{8},\\,-\\frac{1}{8},\\,\\frac{1}{8},\\,\\frac{3}{8}\\right\\}.\n$$\n\n最后，我们计算每个 $\\mathbf{k}$ 点的积分权重 $w$。原胞的布里渊区体积是一个经过充分验证的结果，\n$$\nV_{\\text{BZ}}=\\frac{(2\\pi)^{3}}{\\Omega},\n$$\n其中 $\\Omega$ 是正空间原胞的体积。我们已经求得 $\\Omega = \\frac{\\sqrt{3}}{2}\\,a^{2}c$。对于 $N_{k}=6\\times 6\\times 4=144$ 个均匀加权的点，\n$$\nw=\\frac{V_{\\text{BZ}}}{N_{k}} = \\frac{(2\\pi)^{3}}{\\Omega\\,N_{k}} = \\frac{8\\pi^{3}}{\\left(\\frac{\\sqrt{3}}{2}\\,a^{2}c\\right)\\cdot 144}.\n$$\n化简后，\n$$\nw = \\frac{8\\pi^{3}}{72\\sqrt{3}\\,a^{2}c} = \\frac{\\pi^{3}}{9\\sqrt{3}\\,a^{2}c}.\n$$\n这个 $w$是与每个$\\mathbf{k}$点关联的倒易空间体积。如果 $a$ 和 $c$ 以 $\\text{\\AA}$ 表示，那么 $w$ 的单位是 $\\text{\\AA}^{-3}$。",
            "answer": "$$\\boxed{\\frac{\\pi^{3}}{9\\sqrt{3}\\,a^{2}c}}$$"
        },
        {
            "introduction": "构建完整的k点网格是第一步，但实际计算中我们总是希望尽可能提高效率。本练习将展示晶体对称性如何通过仅考虑不可约布里渊区（IBZ）中的独特k点来显著减少计算量。你将通过使用加权的IBZ点来计算一个函数的布里渊区平均值，这是所有现代电子结构计算软件中的核心技术。",
            "id": "3818447",
            "problem": "一个点群对称性为 $C_{4v}$ 的二维正方晶格，在第一布里渊区 (BZ) 中使用 $4 \\times 4$ 的 Monkhorst-Pack (MP) 网格进行采样。该网格是均匀的，并且沿每个倒格矢轴，采样的坐标为 $k_{x}, k_{y} \\in \\{-3\\pi/4, -\\pi/4, \\pi/4, 3\\pi/4\\}$ (角度以弧度为单位)。由于晶格的点群对称性，网格在对称操作下分解为多个轨道，并且可以选择一个不可约布里渊区 (IBZ)，其代表点和多重度如下：\n- IBZ 代表点 $\\mathbf{k}_{1} = (\\pi/4,\\pi/4)$，多重度 $m_{1} = 4$，\n- IBZ 代表点 $\\mathbf{k}_{2} = (3\\pi/4,3\\pi/4)$，多重度 $m_{2} = 4$，\n- IBZ 代表点 $\\mathbf{k}_{3} = (\\pi/4,3\\pi/4)$，多重度 $m_{3} = 8$。\n\n网格点总数为 $N_{\\mathrm{k}} = 16$。考虑标量被积函数 $f(\\mathbf{k}) = \\cos(k_{x}) + \\cos(k_{y})$，该函数在正方晶格的 $C_{4v}$ 对称操作下保持不变。仅使用“在均匀 MP 网格上的 BZ 平均值是所有 $N_{\\mathrm{k}}$ 个网格点的算术平均值”这一定义，完成以下任务：\n1. 从第一性原理出发，通过强制要求加权 IBZ 总和等于全网格上的均匀平均值，推导与 IBZ 代表点相关联的权重 $w_{i}$（用多重度 $m_{i}$ 和 $N_{\\mathrm{k}}$ 表示）。\n2. 计算上述三个 IBZ 代表点的权重。\n3. 使用这些权重计算 $f(\\mathbf{k})$ 的加权 IBZ 总和。论证因为 $f(\\mathbf{k})$ 是对称不变的，所以该结果等于 MP 网格上所有 $N_{\\mathrm{k}}$ 个点的均匀 BZ 平均值。\n\n报告在此网格上 $f(\\mathbf{k})$ 的 BZ 平均值作为最终答案。无需四舍五入。以纯数（无量纲）形式表示答案。",
            "solution": "在一个包含 $N_{\\mathrm{k}}$ 个点（我们将其表示为集合 $\\mathcal{K}$）的均匀网格上，函数 $f(\\mathbf{k})$ 的 BZ 平均值定义为算术平均值：\n$$\n\\langle f \\rangle_{\\mathrm{BZ}} = \\frac{1}{N_{\\mathrm{k}}} \\sum_{\\mathbf{k} \\in \\mathcal{K}} f(\\mathbf{k})\n$$\n\n### 1. IBZ 权重的推导\n\n全体 $k$ 点集合 $\\mathcal{K}$ 可以在晶格点群的作用下划分为一组不相交的轨道。假设有 $n_{\\mathrm{IBZ}}$ 个这样的轨道。每个轨道 $\\mathcal{O}_i$ 由来自 IBZ 的单个 $k$ 点 $\\mathbf{k}_i$ 代表。轨道的大小，即其多重度，为 $m_i$。BZ 上的总和可以重写为对所有轨道的求和：\n$$\n\\sum_{\\mathbf{k} \\in \\mathcal{K}} f(\\mathbf{k}) = \\sum_{i=1}^{n_{\\mathrm{IBZ}}} \\sum_{\\mathbf{k}' \\in \\mathcal{O}_i} f(\\mathbf{k}')\n$$\n问题陈述指出，被积函数 $f(\\mathbf{k})$ 在点群的对称操作下是不变的。这意味着对于代表点 $\\mathbf{k}_i$ 的轨道 $\\mathcal{O}_i$ 中的任意点 $\\mathbf{k}'$，其函数值是相同的，即 $f(\\mathbf{k}') = f(\\mathbf{k}_i)$。由于轨道 $\\mathcal{O}_i$ 中有 $m_i$ 个点，内层求和的计算结果为：\n$$\n\\sum_{\\mathbf{k}' \\in \\mathcal{O}_i} f(\\mathbf{k}') = \\sum_{\\mathbf{k}' \\in \\mathcal{O}_i} f(\\mathbf{k}_i) = m_i f(\\mathbf{k}_i)\n$$\n将此结果代回到 BZ 平均值的表达式中，得到：\n$$\n\\langle f \\rangle_{\\mathrm{BZ}} = \\frac{1}{N_{\\mathrm{k}}} \\sum_{i=1}^{n_{\\mathrm{IBZ}}} m_i f(\\mathbf{k}_i)\n$$\n这可以表示为对 IBZ 代表点的加权和：\n$$\n\\langle f \\rangle_{\\mathrm{BZ}} = \\sum_{i=1}^{n_{\\mathrm{IBZ}}} w_i f(\\mathbf{k}_i)\n$$\n通过比较这两个表达式，我们确定与 IBZ 代表点 $\\mathbf{k}_i$ 相关联的权重 $w_i$ 为：\n$$\nw_i = \\frac{m_i}{N_{\\mathrm{k}}}\n$$\n此推导适用于任何在点群操作下保持不变的函数 $f(\\mathbf{k})$。\n\n### 2. 权重的计算\n\n使用推导出的公式 $w_i = m_i / N_{\\mathrm{k}}$ 和给定值：$N_{\\mathrm{k}}=16$，$m_{1}=4$，$m_{2}=4$ 和 $m_{3}=8$。\n\n- 代表点 $\\mathbf{k}_{1}$ 的权重为：\n$$\nw_{1} = \\frac{m_{1}}{N_{\\mathrm{k}}} = \\frac{4}{16} = \\frac{1}{4}\n$$\n- 代表点 $\\mathbf{k}_{2}$ 的权重为：\n$$\nw_{2} = \\frac{m_{2}}{N_{\\mathrm{k}}} = \\frac{4}{16} = \\frac{1}{4}\n$$\n- 代表点 $\\mathbf{k}_{3}$ 的权重为：\n$$\nw_{3} = \\frac{m_{3}}{N_{\\mathrm{k}}} = \\frac{8}{16} = \\frac{1}{2}\n$$\n作为检验，权重之和为 $\\sum_i w_i = w_1 + w_2 + w_3 = \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{2} = 1$，符合预期。\n\n### 3. 加权 IBZ 总和的求值\n\n$f(\\mathbf{k}) = \\cos(k_{x}) + \\cos(k_{y})$ 的 BZ 平均值通过加权 IBZ 总和计算：\n$$\n\\langle f \\rangle_{\\mathrm{BZ}} = w_{1}f(\\mathbf{k}_{1}) + w_{2}f(\\mathbf{k}_{2}) + w_{3}f(\\mathbf{k}_{3})\n$$\n首先，我们计算函数 $f(\\mathbf{k})$ 在每个 IBZ 代表点的值：\n- 对于 $\\mathbf{k}_{1} = (\\pi/4, \\pi/4)$：\n$$\nf(\\mathbf{k}_{1}) = \\cos\\left(\\frac{\\pi}{4}\\right) + \\cos\\left(\\frac{\\pi}{4}\\right) = \\frac{\\sqrt{2}}{2} + \\frac{\\sqrt{2}}{2} = \\sqrt{2}\n$$\n- 对于 $\\mathbf{k}_{2} = (3\\pi/4, 3\\pi/4)$：\n$$\nf(\\mathbf{k}_{2}) = \\cos\\left(\\frac{3\\pi}{4}\\right) + \\cos\\left(\\frac{3\\pi}{4}\\right) = -\\frac{\\sqrt{2}}{2} - \\frac{\\sqrt{2}}{2} = -\\sqrt{2}\n$$\n- 对于 $\\mathbf{k}_{3} = (\\pi/4, 3\\pi/4)$：\n$$\nf(\\mathbf{k}_{3}) = \\cos\\left(\\frac{\\pi}{4}\\right) + \\cos\\left(\\frac{3\\pi}{4}\\right) = \\frac{\\sqrt{2}}{2} - \\frac{\\sqrt{2}}{2} = 0\n$$\n现在，将这些值和权重代入总和中：\n$$\n\\langle f \\rangle_{\\mathrm{BZ}} = \\left(\\frac{1}{4}\\right)(\\sqrt{2}) + \\left(\\frac{1}{4}\\right)(-\\sqrt{2}) + \\left(\\frac{1}{2}\\right)(0)\n$$\n$$\n\\langle f \\rangle_{\\mathrm{BZ}} = \\frac{\\sqrt{2}}{4} - \\frac{\\sqrt{2}}{4} + 0 = 0\n$$\n这个从加权 IBZ 总和得到的结果，严格等于在所有 $N_{\\mathrm{k}}=16$ 个点上的均匀 BZ 平均值。其论据是，第一部分中权重 $w_i = m_i/N_{\\mathrm{k}}$ 的推导建立在这样一个前提之上：对于任何在点群对称操作下不变的函数，加权总和必须等于完整的 BZ 平均值。问题陈述明确证实被积函数 $f(\\mathbf{k}) = \\cos(k_{x}) + \\cos(k_{y})$ 拥有此 $C_{4v}$ 对称性。因此，这种等价性是由构造本身保证的。\n\n最终答案是 BZ 平均值。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "对于非立方材料，一个简单的 $N \\times N \\times N$ 网格通常不是最高效的选择。本练习将深入探讨其背后的数学原理，要求你推导一个各向异性系统的积分误差。这个结果将定量地揭示为何需要根据倒易晶胞的尺寸来调整k点密度，以保持均匀的采样分辨率并有效地最小化计算误差。",
            "id": "3818373",
            "problem": "考虑一个正交晶体，其原胞直格子常数为 $a_{x}$、$a_{y}$ 和 $a_{z}$，它们导出的倒格子矢量模为 $G_{x} = \\frac{2\\pi}{a_{x}}$、$G_{y} = \\frac{2\\pi}{a_{y}}$ 和 $G_{z} = \\frac{2\\pi}{a_{z}}$。第一布里渊区（BZ）取为矩形区域 $[-G_{x}/2,G_{x}/2] \\times [-G_{y}/2,G_{y}/2] \\times [-G_{z}/2,G_{z}/2]$。在电子结构计算中（例如密度泛函理论（DFT）），对光滑周期性可观测量在布里渊区上的积分，通常使用均匀的 Monkhorst-Pack (MP) 网格进行近似。在其最简单的形式中，该网格与布里渊区上的复合中点法则相吻合。\n\n假设BZ被积函数主要由其在 $\\Gamma$ 点（即 $\\mathbf{k} = \\mathbf{0}$）附近的二阶泰勒展开决定，并且是各向同性光滑但曲率各向异性的：\n$$\nf(\\mathbf{k}) \\approx c + \\alpha_{x} k_{x}^{2} + \\alpha_{y} k_{y}^{2} + \\alpha_{z} k_{z}^{2},\n$$\n其中 $c$、$\\alpha_{x}$、$\\alpha_{y}$ 和 $\\alpha_{z}$ 是常数，$\\mathbf{k} = (k_{x},k_{y},k_{z})$ 在BZ内取值。$f(\\mathbf{k})$ 在BZ上的精确积分 $I$ 定义为\n$$\nI = \\int_{-G_{x}/2}^{G_{x}/2} \\int_{-G_{y}/2}^{G_{y}/2} \\int_{-G_{z}/2}^{G_{z}/2} f(\\mathbf{k}) \\, \\mathrm{d}k_{x}\\,\\mathrm{d}k_{y}\\,\\mathrm{d}k_{z}.\n$$\n\n现在使用一个在每个方向上都有相同 $N$ 值的 $N \\times N \\times N$ Monkhorst-Pack 网格来近似 $I$，即一个步长为 $\\Delta k_{x} = G_{x}/N$、$\\Delta k_{y} = G_{y}/N$ 和 $\\Delta k_{z} = G_{z}/N$ 的复合中点法则，其网格点位于\n$$\nk_{x,i} = -\\frac{G_{x}}{2} + \\left(i + \\frac{1}{2}\\right)\\Delta k_{x}, \\quad\nk_{y,j} = -\\frac{G_{y}}{2} + \\left(j + \\frac{1}{2}\\right)\\Delta k_{y}, \\quad\nk_{z,\\ell} = -\\frac{G_{z}}{2} + \\left(\\ell + \\frac{1}{2}\\right)\\Delta k_{z},\n$$\n对于 $i,j,\\ell \\in \\{0,1,\\dots,N-1\\}$。将此数值近似值记为 $I_{N}$：\n$$\nI_{N} = \\Delta k_{x}\\Delta k_{y}\\Delta k_{z} \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} \\sum_{\\ell=0}^{N-1} f(k_{x,i},k_{y,j},k_{z,\\ell}).\n$$\n\n从积分、网格和复合中点法则的定义出发，推导主阶积分误差 $E_{N} = I - I_{N}$ 的闭合形式表达式，该表达式是 $G_{x}$、$G_{y}$、$G_{z}$、$N$、$\\alpha_{x}$、$\\alpha_{y}$、$\\alpha_{z}$ 和 $c$ 的函数。明确展示当 $G_{x}$、$G_{y}$ 和 $G_{z}$ 高度各向异性时，在所有倒易方向上使用相同的 $N$ 如何导致分辨率不均匀，并在最终的误差表达式中量化这种各向异性。\n\n给出你的最终答案，作为 $E_{N}$ 的单个闭合形式解析表达式。不需要进行数值舍入，也不需要单位。",
            "solution": "积分误差定义为 $E_{N} = I - I_{N}$。推导过程是首先计算精确积分 $I$，然后计算数值近似 $I_{N}$，最后计算它们的差值。\n\n**1. 计算精确积分 $I$**\n\n被积函数为 $f(\\mathbf{k}) = c + \\alpha_{x} k_{x}^{2} + \\alpha_{y} k_{y}^{2} + \\alpha_{z} k_{z}^{2}$。在BZ上的积分 $I$ 是可分离的：\n$$\nI = \\int_{BZ} (c + \\alpha_{x} k_{x}^{2} + \\alpha_{y} k_{y}^{2} + \\alpha_{z} k_{z}^{2}) \\, \\mathrm{d}^{3}k\n$$\n我们可以分别计算每一项。常数 $c$ 在 BZ 体积 $V_{BZ} = G_{x}G_{y}G_{z}$ 上的积分为：\n$$\n\\int_{BZ} c \\, \\mathrm{d}^{3}k = c V_{BZ} = c G_{x}G_{y}G_{z}\n$$\n项 $\\alpha_{x} k_{x}^{2}$ 的积分为：\n$$\n\\int_{BZ} \\alpha_{x} k_{x}^{2} \\, \\mathrm{d}^{3}k = \\alpha_{x} \\left( \\int_{-G_{x}/2}^{G_{x}/2} k_{x}^{2} \\, \\mathrm{d}k_{x} \\right) \\left( \\int_{-G_{y}/2}^{G_{y}/2} \\mathrm{d}k_{y} \\right) \\left( \\int_{-G_{z}/2}^{G_{z}/2} \\mathrm{d}k_{z} \\right)\n$$\n$k_{x}^{2}$ 的一维积分为：\n$$\n\\int_{-G_{x}/2}^{G_{x}/2} k_{x}^{2} \\, \\mathrm{d}k_{x} = \\left[\\frac{k_{x}^{3}}{3}\\right]_{-G_{x}/2}^{G_{x}/2} = \\frac{1}{3} \\left( \\left(\\frac{G_{x}}{2}\\right)^{3} - \\left(-\\frac{G_{x}}{2}\\right)^{3} \\right) = \\frac{1}{3} \\left( \\frac{G_{x}^{3}}{8} + \\frac{G_{x}^{3}}{8} \\right) = \\frac{G_{x}^{3}}{12}\n$$\n因此，$\\alpha_{x} k_{x}^{2}$ 项的积分为 $\\alpha_{x} (\\frac{G_{x}^{3}}{12}) G_{y} G_{z}$。根据对称性，$y$ 和 $z$ 分量的积分是类似的。将所有项相加，精确积分 $I$ 为：\n$$\nI = c G_{x}G_{y}G_{z} + \\frac{\\alpha_{x} G_{x}^{3} G_{y} G_{z}}{12} + \\frac{\\alpha_{y} G_{x} G_{y}^{3} G_{z}}{12} + \\frac{\\alpha_{z} G_{x} G_{y} G_{z}^{3}}{12}\n$$\n$$\nI = G_{x}G_{y}G_{z} \\left( c + \\frac{1}{12}(\\alpha_{x} G_{x}^{2} + \\alpha_{y} G_{y}^{2} + \\alpha_{z} G_{z}^{2}) \\right)\n$$\n\n**2. 计算数值近似 $I_{N}$**\n\n数值积分 $I_{N}$ 由下式给出：\n$$\nI_{N} = \\Delta k_{x}\\Delta k_{y}\\Delta k_{z} \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} \\sum_{\\ell=0}^{N-1} f(k_{x,i}, k_{y,j}, k_{z,\\ell})\n$$\n体积元为 $\\Delta k_{x}\\Delta k_{y}\\Delta k_{z} = (\\frac{G_{x}}{N})(\\frac{G_{y}}{N})(\\frac{G_{z}}{N}) = \\frac{G_{x}G_{y}G_{z}}{N^{3}}$。代入 $f(\\mathbf{k})$ 的表达式：\n$$\n\\sum_{i,j,\\ell} f = \\sum_{i,j,\\ell} (c + \\alpha_{x} k_{x,i}^{2} + \\alpha_{y} k_{y,j}^{2} + \\alpha_{z} k_{z,\\ell}^{2})\n$$\n该求和也是可分离的。常数项 $c$ 的求和为 $\\sum_{i,j,\\ell} c = c \\sum_{i=0}^{N-1} 1 \\sum_{j=0}^{N-1} 1 \\sum_{\\ell=0}^{N-1} 1 = c N^{3}$。\n常数项对 $I_{N}$ 的贡献为 $(\\frac{G_{x}G_{y}G_{z}}{N^{3}}) (c N^{3}) = c G_{x}G_{y}G_{z}$。这与 $I$ 中相应的项相同，因为中点法则能精确积分常数函数。\n\n现在考虑 $\\alpha_{x}k_{x}^{2}$ 项。它对求和的贡献是：\n$$\n\\sum_{i,j,\\ell} \\alpha_{x} k_{x,i}^{2} = \\alpha_{x} \\left(\\sum_{i=0}^{N-1} k_{x,i}^{2}\\right) \\left(\\sum_{j=0}^{N-1} 1\\right) \\left(\\sum_{\\ell=0}^{N-1} 1\\right) = \\alpha_{x} N^{2} \\sum_{i=0}^{N-1} k_{x,i}^{2}\n$$\n为了计算这个和，我们需要求和 $\\sum_{i=0}^{N-1} k_{x,i}^{2}$。网格点为 $k_{x,i} = -\\frac{G_{x}}{2} + (i + \\frac{1}{2})\\frac{G_{x}}{N} = \\frac{G_{x}}{2N}(-N + 2i + 1)$。\n平方和为：\n$$\n\\sum_{i=0}^{N-1} k_{x,i}^{2} = \\sum_{i=0}^{N-1} \\left( \\frac{G_{x}}{2N} \\right)^{2} (-N + 1 + 2i)^{2} = \\frac{G_{x}^{2}}{4N^{2}} \\sum_{i=0}^{N-1} (-N+1+2i)^{2}\n$$\n这个和是等差数列的平方和。我们来计算这个和：\n$$\n\\sum_{i=0}^{N-1} (-N+1+2i)^{2} = \\sum_{i=0}^{N-1} ((-N+1)^{2} + 4i(-N+1) + 4i^{2})\n$$\n$$\n= N(-N+1)^{2} + 4(-N+1)\\sum_{i=0}^{N-1} i + 4\\sum_{i=0}^{N-1} i^{2}\n$$\n使用标准的幂和公式，$\\sum_{i=0}^{N-1} i = \\frac{(N-1)N}{2}$ 和 $\\sum_{i=0}^{N-1} i^{2} = \\frac{(N-1)N(2N-1)}{6}$：\n$$\n= N(N-1)^{2} + 4(1-N)\\frac{N(N-1)}{2} + 4\\frac{(N-1)N(2N-1)}{6}\n$$\n$$\n= N(N-1)^{2} - 2N(N-1)^{2} + \\frac{2N(N-1)(2N-1)}{3} = -N(N-1)^{2} + \\frac{2N(N-1)(2N-1)}{3}\n$$\n$$\n= N(N-1)\\left[-(N-1) + \\frac{2(2N-1)}{3}\\right] = N(N-1)\\left[\\frac{-3N+3+4N-2}{3}\\right]\n$$\n$$\n= N(N-1)\\frac{N+1}{3} = \\frac{N(N^{2}-1)}{3}\n$$\n将其代回，我们得到：\n$$\n\\sum_{i=0}^{N-1} k_{x,i}^{2} = \\frac{G_{x}^{2}}{4N^{2}} \\frac{N(N^{2}-1)}{3} = \\frac{G_{x}^{2}(N^{2}-1)}{12N}\n$$\n$\\alpha_{x}$ 项对 $I_{N}$ 的总贡献为：\n$$\n(\\frac{G_{x}G_{y}G_{z}}{N^{3}}) \\left(\\alpha_{x} N^{2} \\frac{G_{x}^{2}(N^{2}-1)}{12N}\\right) = \\frac{\\alpha_{x} G_{x}^{3} G_{y} G_{z} (N^{2}-1)}{12N^{2}}\n$$\n将 $I_{N}$ 的所有项相加：\n$$\nI_{N} = c G_{x}G_{y}G_{z} + \\frac{\\alpha_{x} G_{x}^{3} G_{y} G_{z} (N^{2}-1)}{12N^{2}} + \\frac{\\alpha_{y} G_{x} G_{y}^{3} G_{z} (N^{2}-1)}{12N^{2}} + \\frac{\\alpha_{z} G_{x} G_{y} G_{z}^{3} (N^{2}-1)}{12N^{2}}\n$$\n$$\nI_{N} = G_{x}G_{y}G_{z} \\left( c + \\frac{N^{2}-1}{12N^{2}}(\\alpha_{x} G_{x}^{2} + \\alpha_{y} G_{y}^{2} + \\alpha_{z} G_{z}^{2}) \\right)\n$$\n\n**3. 计算积分误差 $E_{N}$**\n\n误差是差值 $E_{N} = I - I_{N}$：\n$$\nE_{N} = G_{x}G_{y}G_{z} \\left( c + \\frac{1}{12} \\sum_{j=x,y,z} \\alpha_{j}G_{j}^{2} \\right) - G_{x}G_{y}G_{z} \\left( c + \\frac{N^{2}-1}{12N^{2}} \\sum_{j=x,y,z} \\alpha_{j}G_{j}^{2} \\right)\n$$\n常数项 $c$ 消掉了。余下的项给出：\n$$\nE_{N} = \\frac{G_{x}G_{y}G_{z}}{12} \\left( \\sum_{j=x,y,z} \\alpha_{j}G_{j}^{2} \\right) \\left( 1 - \\frac{N^{2}-1}{N^{2}} \\right)\n$$\n$$\nE_{N} = \\frac{G_{x}G_{y}G_{z}}{12} \\left( \\alpha_{x}G_{x}^{2} + \\alpha_{y}G_{y}^{2} + \\alpha_{z}G_{z}^{2} \\right) \\left( \\frac{N^{2} - (N^{2}-1)}{N^{2}} \\right)\n$$\n$$\nE_{N} = \\frac{G_{x}G_{y}G_{z}}{12N^{2}} (\\alpha_{x} G_{x}^{2} + \\alpha_{y} G_{y}^{2} + \\alpha_{z} G_{z}^{2})\n$$\n\n**4. 误差项与各向异性分析**\n\n最终的误差表达式为 $E_{N} = \\frac{V_{BZ}}{12N^{2}} \\sum_{j=x,y,z} \\alpha_{j}G_{j}^{2}$。这个表达式明确地量化了在每个方向上选择具有 $N$ 个点的均匀网格如何与布里渊区的各向异性相互作用。\n\n沿每个倒易轴的步长为 $\\Delta k_{x} = G_{x}/N$、$\\Delta k_{y} = G_{y}/N$ 和 $\\Delta k_{z} = G_{z}/N$。如果倒格子是各向异性的（例如，$G_{x} \\gg G_{y}$），那么步长也将是各向异性的（$\\Delta k_{x} \\gg \\Delta k_{y}$）。这表示“分辨率不均匀”：在倒格子矢量模较大的方向上，采样要粗糙得多。\n\n这种不均匀的分辨率直接反映在误差公式中。总误差 $E_{N}$ 是来自每个方向的贡献之和，其中来自方向 $j$ 的贡献与 $\\alpha_{j}G_{j}^{2}$ 成正比。$G_{j}^{2}$ 的依赖性意味着误差对布里渊区的最大维度高度敏感。如果某个维度（比如 $G_{x}$）显著大于其他维度，其相应的项 $\\frac{V_{BZ}}{12N^{2}}\\alpha_{x}G_{x}^{2}$ 将主导总误差。因此，积分精度受到沿“最长”BZ方向采样的限制。这表明，对于各向异性系统，在每个方向上使用相同数量的k点 $N$ 是一种低效的策略，因为误差由采样最差的方向控制。一种更高效的方案是选择每个方向上的点数（$N_{x}, N_{y}, N_{z}$），使得步长大致相等，这意味着 $N_{j} \\propto G_{j}$。",
            "answer": "$$\n\\boxed{\\frac{G_x G_y G_z}{12 N^2}(\\alpha_x G_x^2 + \\alpha_y G_y^2 + \\alpha_z G_z^2)}\n$$"
        }
    ]
}