{
    "hands_on_practices": [
        {
            "introduction": "The Hartree-Fock-Roothaan equations present a generalized eigenvalue problem, $FC=SCE$, due to the non-orthogonality of the atomic orbital basis set. To leverage standard, efficient eigensolvers, we must first transform this into a standard eigenvalue problem. This exercise  provides hands-on practice with symmetric orthogonalization, a fundamental technique where the overlap matrix $S$ is used to create a transformation that renders the basis orthonormal, setting the stage for solving the SCF equations.",
            "id": "215564",
            "problem": "In the Hartree-Fock-Roothaan self-consistent field (SCF) method, the electronic structure problem is formulated as a generalized eigenvalue problem:\n$$ \\mathbf{F}\\mathbf{C} = \\mathbf{S}\\mathbf{C}\\mathbf{E} $$\nHere, $\\mathbf{F}$ is the Fock matrix, $\\mathbf{C}$ is the matrix of molecular orbital coefficients, $\\mathbf{S}$ is the overlap matrix of the non-orthogonal atomic orbital basis functions, and $\\mathbf{E}$ is a diagonal matrix of orbital energies.\n\nTo solve this equation using standard numerical algorithms for eigenvalue problems, it must first be transformed into a standard eigenvalue problem of the form $\\mathbf{F}'\\mathbf{C}' = \\mathbf{C}'\\mathbf{E}$. A common way to achieve this is via symmetric orthogonalization, also known as Löwdin orthogonalization. This method introduces a transformation matrix $\\mathbf{X} = \\mathbf{S}^{-1/2}$, which is used to transform the basis functions and the Fock matrix.\n\nConsider a simple model for a linear, symmetric triatomic molecule A-B-A described by a minimal basis set consisting of one s-type atomic orbital on each atom, denoted $\\phi_1$, $\\phi_2$, and $\\phi_3$. The overlap matrix $\\mathbf{S}$ in this basis is given by:\n$$ \\mathbf{S} = \\begin{pmatrix} 1 & s & 0 \\\\ s & 1 & s \\\\ 0 & s & 1 \\end{pmatrix} $$\nwhere $s$ is the overlap integral between adjacent atomic orbitals, and the overlap between the terminal atoms is assumed to be zero. The parameter $s$ is a real number satisfying $0 < s < 1/\\sqrt{2}$ to ensure that the overlap matrix is positive definite.\n\nYour task is to calculate the off-diagonal matrix element $X_{12}$ of the symmetric orthogonalization matrix $\\mathbf{X} = \\mathbf{S}^{-1/2}$.",
            "solution": "We wish to compute the off‐diagonal element $X_{12}$ of \n\n$$\n\\mathbf X = \\mathbf S^{-1/2},\n\\qquad\n\\mathbf S = \\begin{pmatrix}1 & s & 0\\\\s & 1 & s\\\\0 & s & 1\\end{pmatrix}.\n$$\n\n1. Diagonalize $\\mathbf S$ by an orthonormal matrix $U$:\n\n$$\n\\mathbf S = U\\,\\Lambda\\,U^T,\n\\qquad\n\\Lambda = \\diag(\\lambda_1,\\lambda_2,\\lambda_3).\n$$\n\nFor a linear chain of three orbitals the eigenvalues are\n\n$$\n\\lambda_k=1+2s\\cos\\frac{k\\pi}{4},\n\\quad k=1,2,3,\n$$\n\nso\n\n$$\n\\lambda_1=1+\\sqrt2\\,s,\\quad\n\\lambda_2=1,\\quad\n\\lambda_3=1-\\sqrt2\\,s.\n$$\n\n\n2. The (unnormalized) eigenvectors have components \n\n$$\nu_{j k}=\\sin\\!\\bigl(jk\\pi/4\\bigr),\n\\quad j=1,2,3,\n$$\n\nand are normalized by\n$\\sum_{j=1}^3\\sin^2(jk\\pi/4)=2$. Hence\n\n$$\nU_{jk}=\\frac{\\sin(jk\\pi/4)}{\\sqrt2}.\n$$\n\n\n3. The symmetric orthogonalizer is\n\n$$\n\\mathbf X=\\mathbf S^{-1/2}\n=U\\,\\Lambda^{-1/2}\\,U^T,\n$$\n\nso each element\n\n$$\nX_{12}\n=\\sum_{k=1}^3U_{1k}\\,U_{2k}\\,\\frac1{\\sqrt{\\lambda_k}}.\n$$\n\nSince $U_{12}U_{22}=0$, only $k=1,3$ contribute.  We have\n\n$$\nU_{11}U_{21}\n=\\frac{\\sin(\\pi/4)\\sin(2\\pi/4)}{2}\n=\\frac{1}{2\\sqrt2},\n\\quad\nU_{13}U_{23}\n=\\frac{\\sin(3\\pi/4)\\sin(6\\pi/4)}{2}\n=-\\frac{1}{2\\sqrt2}.\n$$\n\nThus\n\n$$\nX_{12}\n=\\frac{1}{2\\sqrt2}\\Bigl(\\frac1{\\sqrt{1+\\sqrt2\\,s}}\n-\\frac1{\\sqrt{1-\\sqrt2\\,s}}\\Bigr).\n$$",
            "answer": "$$\\boxed{\\frac{1}{2\\sqrt{2}}\\Bigl(\\frac{1}{\\sqrt{1+\\sqrt{2}\\,s}}-\\frac{1}{\\sqrt{1-\\sqrt{2}\\,s}}\\Bigr)}$$"
        },
        {
            "introduction": "While the SCF procedure is conceptually straightforward, its convergence can be frustratingly slow or even oscillatory. To address this, sophisticated acceleration techniques are essential in virtually all quantum chemistry software. This practice  delves into the Direct Inversion in the Iterative Subspace (DIIS) method, a powerful scheme that intelligently extrapolates a new Fock matrix from a series of previous iterations, dramatically speeding up or enabling convergence.",
            "id": "215588",
            "problem": "In the context of the Hartree-Fock Self-Consistent Field (SCF) procedure, the Direct Inversion in the Iterative Subspace (DIIS) method is a powerful technique for accelerating convergence. The core idea is to find an optimal Fock matrix for the next iteration, $F_{DIIS}$, by forming a linear combination of Fock matrices from $m$ previous iterations:\n$$ F_{DIIS} = \\sum_{i=1}^{m} c_i F^{(i)} $$\nThe coefficients $c_i$ are determined by minimizing the norm of a corresponding linear combination of error vectors, $e^{(i)}$, subject to the constraint that the coefficients sum to one, $\\sum_i c_i = 1$. The error vector for a given iteration is typically constructed from the commutator of the Fock matrix $F$ and the density matrix $D$ in an orthonormal basis, $e = [F, D] = FD - DF$.\n\nThis constrained minimization leads to a system of linear equations for the coefficients $c_i$ and a Lagrange multiplier $\\lambda$:\n$$ \\begin{pmatrix}\nB_{11} & \\dots & B_{1m} & -1 \\\\\n\\vdots & \\ddots & \\vdots & \\vdots \\\\\nB_{m1} & \\dots & B_{mm} & -1 \\\\\n-1 & \\dots & -1 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\nc_1 \\\\\n\\vdots \\\\\nc_m \\\\\n\\lambda\n\\end{pmatrix} =\n\\begin{pmatrix}\n0 \\\\\n\\vdots \\\\\n0 \\\\\n-1\n\\end{pmatrix}\n$$\nwhere the matrix elements $B_{ij}$ are given by the trace of the product of error vectors: $B_{ij} = \\text{Tr}(e^{(i)\\dagger} e^{(j)})$.\n\nConsider an SCF calculation for a three-level system described in an orthonormal basis. After two iterations, we have the following real, symmetric Fock matrices:\n$$ F^{(1)} = \\begin{pmatrix} A & D & 0 \\\\ D & B & E \\\\ 0 & E & C \\end{pmatrix}, \\quad F^{(2)} = \\begin{pmatrix} A' & D' & 0 \\\\ D' & B' & E' \\\\ 0 & E' & C' \\end{pmatrix} $$\nThe corresponding real, anti-symmetric error vectors are given by:\n$$ e^{(1)} = \\begin{pmatrix} 0 & \\alpha & 0 \\\\ -\\alpha & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}, \\quad e^{(2)} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & \\beta \\\\ 0 & -\\beta & 0 \\end{pmatrix} $$\nwhere $\\alpha$ and $\\beta$ are non-zero real constants.\n\nUsing the two most recent iterations (i.e., $m=2$), calculate the DIIS-extrapolated Fock matrix $F_{DIIS}$. Express your answer as a single matrix whose elements are in terms of the given symbolic constants.",
            "solution": "1. Define the Frobenius inner products\n$$B_{ij} = \\sum_{m,n} e^{(i)}_{mn}\\,e^{(j)}_{mn}\\,. $$\n\n2. Compute the nonzero entries of the error matrices:\ne^{(1)} has entries $e^{(1)}_{12}=\\alpha,\\;e^{(1)}_{21}=-\\alpha$, so\n$$B_{11} = \\alpha^2 + (-\\alpha)^2 = 2\\alpha^2\\,. $$\ne^{(2)} has entries $e^{(2)}_{23}=\\beta,\\;e^{(2)}_{32}=-\\beta$, so\n$$B_{22} = \\beta^2 + (-\\beta)^2 = 2\\beta^2\\,. $$\nThere is no overlap of nonzero entries between $e^{(1)}$ and $e^{(2)}$, hence\n$$B_{12}=B_{21}=0\\,. $$\n\n3. The DIIS linear system for $m=2$ is\n$$\n\\begin{pmatrix}\n2\\alpha^2 & 0 & -1\\\\\n0 & 2\\beta^2 & -1\\\\\n-1 & -1 & 0\n\\end{pmatrix}\n\\begin{pmatrix}c_1\\\\c_2\\\\\\lambda\\end{pmatrix}\n=\n\\begin{pmatrix}0\\\\0\\\\-1\\end{pmatrix}.\n$$\nThis yields the equations\n\n$$\n2\\alpha^2\\,c_1 \\;=\\;\\lambda,\\quad\n2\\beta^2\\,c_2 \\;=\\;\\lambda,\\quad\nc_1+c_2=1.\n$$\n\n4. Solve for $\\lambda$ and the coefficients:\n\n$$\nc_1 = \\frac{\\lambda}{2\\alpha^2},\\quad\nc_2 = \\frac{\\lambda}{2\\beta^2},\\quad\n\\frac{\\lambda}{2\\alpha^2} + \\frac{\\lambda}{2\\beta^2} =1\n\\;\\Longrightarrow\\;\n\\lambda = \\frac{2\\alpha^2\\beta^2}{\\alpha^2+\\beta^2}.\n$$\n\nHence\n\n$$\nc_1 = \\frac{\\beta^2}{\\alpha^2+\\beta^2},\\qquad\nc_2 = \\frac{\\alpha^2}{\\alpha^2+\\beta^2}.\n$$\n\n\n5. Form the DIIS‐extrapolated Fock matrix\n$$\nF_{DIIS} = c_1\\,F^{(1)} + c_2\\,F^{(2)}\n= \\frac{1}{\\alpha^2+\\beta^2}\n\\Bigl(\\beta^2\\,F^{(1)} + \\alpha^2\\,F^{(2)}\\Bigr).\n$$\nExpanding,\n\n$$\nF_{DIIS} = \\frac{1}{\\alpha^2+\\beta^2}\n\\begin{pmatrix}\n\\beta^2 A + \\alpha^2 A' & \\beta^2 D + \\alpha^2 D' & 0\\\\\n\\beta^2 D + \\alpha^2 D' & \\beta^2 B + \\alpha^2 B' & \\beta^2 E + \\alpha^2 E'\\\\\n0 & \\beta^2 E + \\alpha^2 E' & \\beta^2 C + \\alpha^2 C'\n\\end{pmatrix}.\n$$",
            "answer": "$$\n\\boxed{\nF_{DIIS}\n=\\frac{1}{\\alpha^2+\\beta^2}\n\\begin{pmatrix}\n\\beta^2 A + \\alpha^2 A' & \\beta^2 D + \\alpha^2 D' & 0\\\\\n\\beta^2 D + \\alpha^2 D' & \\beta^2 B + \\alpha^2 B' & \\beta^2 E + \\alpha^2 E'\\\\\n0 & \\beta^2 E + \\alpha^2 E' & \\beta^2 C + \\alpha^2 C'\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The mean-field nature of the Hartree-Fock approximation can sometimes lead to solutions that do not possess the full symmetry of the molecular Hamiltonian, a phenomenon known as spontaneous symmetry breaking. This coding exercise  guides you through a minimal SCF implementation for a symmetric double-well potential, allowing you to observe firsthand how a small initial asymmetry can be amplified by the SCF feedback loop, causing the calculation to become \"trapped\" in a physically intriguing, symmetry-broken state.",
            "id": "2465549",
            "problem": "You are asked to implement a minimal, fully self-contained Self-Consistent Field (SCF) simulation that captures how a symmetry-broken mean-field solution can emerge and trap the iteration for a symmetric double-well model. The model is a two-site system in a minimal basis $\\{\\phi_L,\\phi_R\\}$ representing localized functions on the left and right wells. Consider two electrons in a closed-shell configuration (one doubly occupied spatial orbital). All quantities are dimensionless.\n\nStarting point and definitions:\n- The one-electron core Hamiltonian $H_{\\mathrm{core}}$ in the $\\{\\phi_L,\\phi_R\\}$ basis is\n$$\nH_{\\mathrm{core}} \\;=\\; \\begin{pmatrix}\n0 & -t \\\\\n-t & 0\n\\end{pmatrix}, \\quad t>0.\n$$\n- The mean-field (Fock-like) matrix is\n$$\nF[P] \\;=\\; H_{\\mathrm{core}} + V[P],\n$$\nwith a feedback term\n$$\nV[P] \\;=\\; \\begin{pmatrix}\n- g m & 0 \\\\\n0 & + g m\n\\end{pmatrix}, \\quad m \\equiv P_{LL} - P_{RR},\n$$\nwhere $P$ is the one-particle density matrix in the atomic-orbital basis. The scalar $g \\ge 0$ is a coupling strength controlling the nonlinear feedback. The population imbalance $m$ quantifies left-right asymmetry.\n- In a closed-shell, two-electron, one-orbital model, the density matrix is\n$$\nP \\;=\\; 2\\, \\mathbf{c}\\,\\mathbf{c}^{\\top}, \\qquad \\mathbf{c} = \\begin{pmatrix} c_L \\\\ c_R \\end{pmatrix}, \\quad \\|\\mathbf{c}\\|_2=1,\n$$\nwith $\\mathbf{c}$ the coefficient vector of the occupied molecular orbital in the $\\{\\phi_L,\\phi_R\\}$ basis. Thus $P_{LL} = 2 c_L^2$ and $P_{RR} = 2 c_R^2$, and $m = 2(c_L^2 - c_R^2)$.\n\nSCF iteration to implement:\n1. Initialize the occupied orbital coefficients $\\mathbf{c}^{(0)}$ from an imbalance seed $\\varepsilon$ by\n$$\n\\mathbf{c}^{(0)} \\;\\propto\\; \\begin{pmatrix} \\sqrt{0.5 + \\varepsilon} \\\\ \\sqrt{0.5 - \\varepsilon} \\end{pmatrix}, \\quad \\|\\mathbf{c}^{(0)}\\|_2=1,\n$$\nthen set $P^{(0)} = 2\\,\\mathbf{c}^{(0)} \\mathbf{c}^{(0)\\top}$.\n2. At iteration $k$, compute $m^{(k)} = P_{LL}^{(k)} - P_{RR}^{(k)}$, assemble $F^{(k)} = H_{\\mathrm{core}} + V[P^{(k)}]$, and solve the $2\\times 2$ eigenproblem to obtain the lowest-energy normalized eigenvector $\\mathbf{v}^{(k)}$.\n3. Form the new density $P_{\\mathrm{new}}^{(k)} = 2\\,\\mathbf{v}^{(k)}\\mathbf{v}^{(k)\\top}$.\n4. Apply linear density mixing with parameter $\\alpha \\in (0,1]$:\n$$\nP^{(k+1)} \\;=\\; (1-\\alpha)\\,P^{(k)} + \\alpha\\,P_{\\mathrm{new}}^{(k)}.\n$$\n5. Convergence criterion: stop if the Frobenius norm satisfies $\\|P^{(k+1)} - P^{(k)}\\|_{F} < \\tau$, or if the maximum number of iterations $N_{\\max}$ is reached. Report the final imbalance $m^{(\\mathrm{final})} = P_{LL}^{(\\mathrm{final})} - P_{RR}^{(\\mathrm{final})}$.\n\nYour task:\n- Implement the SCF iteration above.\n- For each test case listed below, run the SCF and return the final imbalance $m^{(\\mathrm{final})}$, rounded to six decimal places.\n- The purpose is to demonstrate that, for sufficiently strong feedback coupling $g$, the SCF can converge to and become trapped in a symmetry-broken solution with $m^{(\\mathrm{final})} \\neq 0$ even though $H_{\\mathrm{core}}$ is symmetric.\n\nTest suite (all parameters are dimensionless):\n1. $(t,g,\\alpha,\\varepsilon,N_{\\max},\\tau) = (1.0,\\;0.2,\\;0.5,\\; +0.01,\\; 200,\\; 10^{-12})$.\n2. $(t,g,\\alpha,\\varepsilon,N_{\\max},\\tau) = (1.0,\\;1.0,\\;0.5,\\; +0.001,\\; 200,\\; 10^{-12})$.\n3. $(t,g,\\alpha,\\varepsilon,N_{\\max},\\tau) = (1.0,\\;1.0,\\;0.5,\\; -0.001,\\; 200,\\; 10^{-12})$.\n4. $(t,g,\\alpha,\\varepsilon,N_{\\max},\\tau) = (1.0,\\;1.0,\\;0.5,\\; 0.0,\\; 200,\\; 10^{-12})$.\n5. $(t,g,\\alpha,\\varepsilon,N_{\\max},\\tau) = (1.0,\\;0.51,\\;0.5,\\; +0.001,\\; 200,\\; 10^{-12})$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the five test cases as a comma-separated list enclosed in square brackets, e.g.,\n$$\n[\\text{m\\_final\\_1},\\text{m\\_final\\_2},\\text{m\\_final\\_3},\\text{m\\_final\\_4},\\text{m\\_final\\_5}],\n$$\nwhere each $\\text{m\\_final\\_i}$ is the final imbalance rounded to six decimal places and expressed as a floating-point number without any units.",
            "solution": "The problem presented is a valid and well-posed exercise in computational quantum chemistry. It is a minimalist yet instructive model for demonstrating the phenomenon of spontaneous symmetry breaking within the Self-Consistent Field (SCF) framework, a concept of central importance in many-body physics and chemistry. The problem is scientifically sound, its parameters are complete and consistent, and the procedure is algorithmically unambiguous. We shall therefore proceed with a full solution.\n\nThe problem asks for the implementation of an SCF procedure for a two-electron, two-site system described by a minimal basis of localized atomic orbitals, $\\{\\phi_L, \\phi_R\\}$. The goal is to find a self-consistent solution for the one-particle density matrix, $P$.\n\nThe core of the problem lies in the structure of the Fock-like matrix, $F[P]$, which determines the effective one-particle Hamiltonian:\n$$\nF[P] \\;=\\; H_{\\mathrm{core}} + V[P] \\;=\\; \\begin{pmatrix}\n0 & -t \\\\\n-t & 0\n\\end{pmatrix} + \\begin{pmatrix}\n- g m & 0 \\\\\n0 & + g m\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n- g m & -t \\\\\n-t & + g m\n\\end{pmatrix}\n$$\nHere, $t > 0$ is the kinetic hopping parameter that allows electrons to tunnel between the left ($L$) and right ($R$) sites, favoring delocalization. The term $V[P]$ represents a simplified electron-electron interaction, where the coupling parameter $g \\ge 0$ controls the strength of a nonlinear feedback mechanism. This feedback depends on the population imbalance, $m = P_{LL} - P_{RR}$. A non-zero imbalance, $m \\neq 0$, creates an effective potential difference between the two sites, with one site becoming more attractive ($-gm$) and the other more repulsive ($+gm$). This feedback mechanism energetically favors localization.\n\nThe competition between the delocalizing effect of $t$ and the localizing effect of $g$ is what gives rise to the interesting physics. The SCF procedure is an iterative method to find a stationary state of this system, where the density matrix $P$ that generates the Fock matrix $F[P]$ is, in turn, produced by the ground state eigenvector of that same $F[P]$.\n\nThe self-consistency condition for the imbalance $m$ can be derived. Given a Fock matrix constructed with an input imbalance $m_{\\mathrm{in}}$, its lowest-energy normalized eigenvector $\\mathbf{c} = (c_L, c_R)^\\top$ yields an output imbalance $m_{\\mathrm{out}} = 2(c_L^2 - c_R^2)$. The eigenvalues of $F[P]$ are $\\lambda_{\\pm} = \\pm \\sqrt{t^2 + (gm_{\\mathrm{in}})^2}$. The components of the eigenvector for the lowest eigenvalue, $\\lambda_{-} = -\\sqrt{t^2 + (gm_{\\mathrm{in}})^2}$, can be shown to satisfy:\n$$\nc_L^2 = \\frac{1}{2}\\left(1 + \\frac{gm_{\\mathrm{in}}}{\\sqrt{t^2+(gm_{\\mathrm{in}})^2}}\\right), \\quad c_R^2 = \\frac{1}{2}\\left(1 - \\frac{gm_{\\mathrm{in}}}{\\sqrt{t^2+(gm_{\\mathrm{in}})^2}}\\right)\n$$\nThis leads to the output imbalance:\n$$\nm_{\\mathrm{out}} = 2(c_L^2 - c_R^2) = \\frac{2gm_{\\mathrm{in}}}{\\sqrt{t^2+(gm_{\\mathrm{in}})^2}}\n$$\nA self-consistent solution is a fixed point of this map, i.e., $m = m_{\\mathrm{in}} = m_{\\mathrm{out}}$. This gives the equation:\n$$\nm = \\frac{2gm}{\\sqrt{t^2+(gm)^2}}\n$$\nOne trivial solution is always $m=0$. This corresponds to the symmetric state where the electron density is equally distributed ($c_L^2 = c_R^2 = 0.5$). If $m \\neq 0$, we can divide by $m$ to find other solutions:\n$$\n1 = \\frac{2g}{\\sqrt{t^2+(gm)^2}} \\implies t^2+g^2m^2 = (2g)^2 \\implies m^2 = \\frac{4g^2-t^2}{g^2} = 4 - \\left(\\frac{t}{g}\\right)^2\n$$\nThese symmetry-broken solutions, $m = \\pm \\sqrt{4 - (t/g)^2}$, are real and non-zero only if $g > t/2$. For $t=1.0$, this critical point is $g_c = 0.5$.\n- If $g \\le g_c$, only the symmetric solution $m=0$ exists.\n- If $g > g_c$, three solutions exist: the symmetric solution $m=0$ (which becomes unstable) and two stable, degenerate, symmetry-broken solutions $m \\neq 0$.\n\nThe SCF algorithm specified in the problem is a numerical procedure to find one of these stable solutions.\n\n**Algorithmic Steps:**\n\n1.  **Initialization**: We start with an initial guess for the orbital coefficients, $\\mathbf{c}^{(0)}$, defined by a small symmetry-breaking seed $\\varepsilon$. A positive $\\varepsilon$ slightly increases the population on the left site, and a negative $\\varepsilon$ does the opposite.\n    $$\n    \\mathbf{c}^{(0)} = \\begin{pmatrix} \\sqrt{0.5 + \\varepsilon} \\\\ \\sqrt{0.5 - \\varepsilon} \\end{pmatrix}\n    $$\n    This vector is already normalized as $(\\sqrt{0.5+\\varepsilon})^2 + (\\sqrt{0.5-\\varepsilon})^2 = 1.0$. The initial density matrix is $P^{(0)} = 2 \\mathbf{c}^{(0)}{\\mathbf{c}^{(0)}}^\\top$. This yields an initial imbalance $m^{(0)} = 2((0.5+\\varepsilon) - (0.5-\\varepsilon)) = 4\\varepsilon$.\n\n2.  **Iteration ($k$)**: The process proceeds iteratively.\n    - The imbalance $m^{(k)} = P_{LL}^{(k)} - P_{RR}^{(k)}$ is calculated.\n    - The Fock matrix $F^{(k)}$ is constructed using $m^{(k)}$, $t$, and $g$.\n    - The eigensystem of the $2 \\times 2$ Hermitian matrix $F^{(k)}$ is solved. This yields two eigenvalues and their corresponding eigenvectors. We select the eigenvector $\\mathbf{v}^{(k)}$ corresponding to the lowest eigenvalue.\n    - A new density matrix is constructed from this eigenvector: $P_{\\mathrm{new}}^{(k)} = 2 \\mathbf{v}^{(k)}{\\mathbf{v}^{(k)}}^\\top$.\n\n3.  **Density Mixing**: To stabilize convergence, the density matrix for the next iteration, $P^{(k+1)}$, is formed by linear mixing of the old and new densities:\n    $$\n    P^{(k+1)} = (1-\\alpha)P^{(k)} + \\alpha P_{\\mathrm{new}}^{(k)}\n    $$\n    The parameter $\\alpha \\in (0, 1]$ damps oscillations that can occur during the iteration.\n\n4.  **Convergence**: The loop continues until the change in the density matrix between successive iterations is smaller than a threshold $\\tau$, measured by the Frobenius norm $\\|P^{(k+1)} - P^{(k)}\\|_F$. The process also stops if a maximum number of iterations, $N_{\\max}$, is reached.\n\nThe final reported value is the imbalance $m^{(\\mathrm{final})}$ from the converged density matrix. This procedure will be implemented to solve for the given test cases. The expectation, based on our analysis, is that for $g > g_c=0.5$, the final state will depend on the sign of the initial seed $\\varepsilon$, converging to one of the two stable symmetry-broken solutions. For $g \\le g_c$, it will converge to the symmetric state $m=0$. The special case $\\varepsilon=0$ starts exactly on the unstable fixed point (for $g > g_c$) and should, in the absence of numerical noise, remain there.",
            "answer": "```python\nimport numpy as np\n\ndef run_scf(t, g, alpha, epsilon, n_max, tau):\n    \"\"\"\n    Performs a Self-Consistent Field (SCF) iteration for a two-site model.\n\n    Args:\n        t (float): Hopping parameter.\n        g (float): Coupling strength for nonlinear feedback.\n        alpha (float): Linear mixing parameter for density matrix update.\n        epsilon (float): Initial imbalance seed.\n        n_max (int): Maximum number of iterations.\n        tau (float): Convergence threshold for the Frobenius norm of the density matrix change.\n\n    Returns:\n        float: The final converged population imbalance 'm'.\n    \"\"\"\n    # 1. Initialization\n    # The problem statement ensures that c0 is already normalized.\n    c0_L = np.sqrt(0.5 + epsilon)\n    c0_R = np.sqrt(0.5 - epsilon)\n    c0 = np.array([c0_L, c0_R])\n    \n    # P = 2 * c * c^T. np.outer(c, c) computes c * c^T.\n    p_k = 2 * np.outer(c0, c0)\n\n    # Define the core Hamiltonian\n    h_core = np.array([[0.0, -t], [-t, 0.0]])\n\n    # 2. SCF Iteration Loop\n    for _ in range(n_max):\n        # Calculate imbalance 'm' from the current density matrix P_k\n        m_k = p_k[0, 0] - p_k[1, 1]\n        \n        # Assemble the Fock-like matrix F[P] = H_core + V[P]\n        # V[P] is a diagonal matrix with elements [-g*m, +g*m]\n        v_p = np.array([[-g * m_k, 0.0], [0.0, g * m_k]])\n        f_k = h_core + v_p\n        \n        # Solve the 2x2 eigenproblem for F_k\n        # numpy.linalg.eigh is for Hermitian matrices and sorts eigenvalues in ascending order.\n        eigenvalues, eigenvectors = np.linalg.eigh(f_k)\n        \n        # The lowest-energy eigenvector is the first column of the eigenvectors matrix.\n        v_k = eigenvectors[:, 0]\n        \n        # Form the new density matrix P_new\n        p_new = 2 * np.outer(v_k, v_k)\n        \n        # Apply linear density mixing\n        p_k_plus_1 = (1 - alpha) * p_k + alpha * p_new\n        \n        # Check for convergence using the Frobenius norm of the difference matrix\n        diff_norm = np.linalg.norm(p_k_plus_1 - p_k, 'fro')\n        \n        # Update the density matrix for the next iteration\n        p_k = p_k_plus_1\n        \n        if diff_norm < tau:\n            break\n            \n    # After the loop, calculate the final imbalance from the converged density matrix\n    m_final = p_k[0, 0] - p_k[1, 1]\n    \n    return m_final\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (t, g, alpha, epsilon, n_max, tau)\n    test_cases = [\n        (1.0, 0.2, 0.5, +0.01, 200, 1e-12),\n        (1.0, 1.0, 0.5, +0.001, 200, 1e-12),\n        (1.0, 1.0, 0.5, -0.001, 200, 1e-12),\n        (1.0, 1.0, 0.5, 0.0, 200, 1e-12),\n        (1.0, 0.51, 0.5, +0.001, 200, 1e-12),\n    ]\n\n    results = []\n    for params in test_cases:\n        t, g, alpha, epsilon, n_max, tau = params\n        m_final = run_scf(t, g, alpha, epsilon, n_max, tau)\n        # Round the result to six decimal places as requested.\n        results.append(round(m_final, 6))\n\n    # Format the final output as a comma-separated list in square brackets.\n    # Using f-string formatting to ensure standard float representation.\n    results_str = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        }
    ]
}