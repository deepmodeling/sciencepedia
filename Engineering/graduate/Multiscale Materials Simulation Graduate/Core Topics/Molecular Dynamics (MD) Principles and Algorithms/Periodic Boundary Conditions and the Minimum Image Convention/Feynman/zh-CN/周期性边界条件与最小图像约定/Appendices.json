{
    "hands_on_practices": [
        {
            "introduction": "这个首个练习是一项基础性训练，旨在将最小镜像约定的抽象定义转化为具体的计算。通过解决这个问题，你将掌握在标准正交晶胞中逐分量应用周期性边界条件的核心技能，这是在分子模拟中正确计算力和能量的关键。",
            "id": "3830822",
            "problem": "考虑一个具有周期性边界条件 (PBC) 的三维正交晶系模拟晶胞，这意味着该晶胞在所有方向上进行概念上的复制，因此任何点 $\\mathbf{r}$ 在物理上都等效于 $\\mathbf{r} + n_{x} L_{x} \\hat{\\mathbf{x}} + n_{y} L_{y} \\hat{\\mathbf{y}} + n_{z} L_{z} \\hat{\\mathbf{z}}$，其中 $n_{x}$、$n_{y}$ 和 $n_{z}$ 为任意整数。最小镜像约定 (MIC) 指出，在评估短程对相互作用时，两个粒子之间的相关位移是在所有周期性镜像中具有最小欧几里得范数的向量。设晶胞边长为 $L_{x} = 3.6\\,\\mathrm{nm}$，$L_{y} = 4.2\\,\\mathrm{nm}$ 和 $L_{z} = 5.0\\,\\mathrm{nm}$。两个粒子位于主晶胞内的笛卡尔坐标位置 $\\mathbf{r}_{1} = (0.5\\,\\mathrm{nm},\\, 3.9\\,\\mathrm{nm},\\, 4.8\\,\\mathrm{nm})$ 和 $\\mathbf{r}_{2} = (3.4\\,\\mathrm{nm},\\, 0.6\\,\\mathrm{nm},\\, 0.4\\,\\mathrm{nm})$。假设对势在截断半径 $r_{c} = 1.30\\,\\mathrm{nm}$ 处截断，因此粒子间发生相互作用当且仅当它们的最小镜像距离小于或等于 $r_{c}$。\n\n仅从 PBC、欧几里得范数和作为最短周期性位移选择的 MIC 的定义出发，推导最小镜像位移向量 $\\Delta \\mathbf{r}_{\\mathrm{MIC}}$ 及其大小 $r_{\\mathrm{MIC}}$，并确定相互作用指示符 $I$，其定义为：如果 $r_{\\mathrm{MIC}} \\le r_{c}$ 则 $I = 1$，否则 $I = 0$。将 $\\Delta \\mathbf{r}_{\\mathrm{MIC}}$ 的所有分量和 $r_{\\mathrm{MIC}}$ 四舍五入到五位有效数字。位移分量和距离以纳米为单位表示。请以单行矩阵的形式提供您的最终答案，按顺序包含 $\\Delta \\mathbf{r}_{\\mathrm{MIC}}$ 的三个分量、标量距离 $r_{\\mathrm{MIC}}$ 和指示符 $I$。",
            "solution": "该问题要求计算在具有周期性边界条件 (PBC) 的三维正交晶系模拟晶胞中，两个粒子的最小镜像位移向量、其大小以及一个相互作用指示符。\n\n首先，从问题陈述中提取给定参数：\n模拟晶胞边长为 $L_{x} = 3.6\\,\\mathrm{nm}$、$L_{y} = 4.2\\,\\mathrm{nm}$ 和 $L_{z} = 5.0\\,\\mathrm{nm}$。\n两个粒子的位置为 $\\mathbf{r}_{1} = (0.5,\\, 3.9,\\, 4.8)\\,\\mathrm{nm}$ 和 $\\mathbf{r}_{2} = (3.4,\\, 0.6,\\, 0.4)\\,\\mathrm{nm}$。\n相互作用截断半径为 $r_{c} = 1.30\\,\\mathrm{nm}$。\n如果最小镜像距离 $r_{\\mathrm{MIC}} \\le r_{c}$，则相互作用指示符 $I=1$，否则 $I=0$。\n\n在主晶胞中，从粒子1到粒子2的位移向量计算为 $\\Delta \\mathbf{r} = \\mathbf{r}_{2} - \\mathbf{r}_{1}$。\n设 $\\mathbf{r}_{1}$ 的分量为 $(x_1, y_1, z_1)$，$\\mathbf{r}_{2}$ 的分量为 $(x_2, y_2, z_2)$。\n位移向量 $\\Delta \\mathbf{r} = (\\Delta x, \\Delta y, \\Delta z)$ 的分量为：\n$$\n\\Delta x = x_{2} - x_{1} = 3.4\\,\\mathrm{nm} - 0.5\\,\\mathrm{nm} = 2.9\\,\\mathrm{nm}\n$$\n$$\n\\Delta y = y_{2} - y_{1} = 0.6\\,\\mathrm{nm} - 3.9\\,\\mathrm{nm} = -3.3\\,\\mathrm{nm}\n$$\n$$\n\\Delta z = z_{2} - z_{1} = 0.4\\,\\mathrm{nm} - 4.8\\,\\mathrm{nm} = -4.4\\,\\mathrm{nm}\n$$\n因此，初始位移向量为 $\\Delta \\mathbf{r} = (2.9,\\, -3.3,\\, -4.4)\\,\\mathrm{nm}$。\n\n由于 PBC，粒子2在位置 $\\mathbf{r}_{2, \\mathbf{n}} = \\mathbf{r}_{2} + n_{x} L_{x} \\hat{\\mathbf{x}} + n_{y} L_{y} \\hat{\\mathbf{y}} + n_{z} L_{z} \\hat{\\mathbf{z}}$ 处有无限多个周期性镜像，其中 $n_x, n_y, n_z$ 为任意整数。从粒子1到这些任意镜像的位移向量为 $\\Delta \\mathbf{r}_{\\mathbf{n}} = \\mathbf{r}_{2, \\mathbf{n}} - \\mathbf{r}_{1} = \\Delta \\mathbf{r} + (n_x L_x, n_y L_y, n_z L_z)$。最小镜像约定 (MIC) 要求我们找到具有最小欧几里得范数的向量 $\\Delta \\mathbf{r}_{\\mathbf{n}}$。范数的平方为 $\\|\\Delta \\mathbf{r}_{\\mathbf{n}}\\|^2 = (\\Delta x + n_x L_x)^2 + (\\Delta y + n_y L_y)^2 + (\\Delta z + n_z L_z)^2$。由于各项是独立的，我们可以分别最小化每个分量的贡献。\n\n对于每个分量 $\\alpha \\in \\{x, y, z\\}$，最小镜像位移分量 $\\Delta \\alpha_{\\mathrm{MIC}}$ 必须满足条件 $|\\Delta \\alpha_{\\mathrm{MIC}}| \\le \\frac{L_{\\alpha}}{2}$。这可以通过对分量加上或减去晶胞长度 $L_{\\alpha}$ 所需的次数来实现，以使其进入范围 $[-\\frac{L_{\\alpha}}{2}, \\frac{L_{\\alpha}}{2}]$。对于分量 $\\Delta \\alpha$ 的一个常见实现是：\n- 如果 $\\Delta \\alpha > \\frac{L_{\\alpha}}{2}$，则 $\\Delta \\alpha_{\\mathrm{MIC}} = \\Delta \\alpha - L_{\\alpha}$。\n- 如果 $\\Delta \\alpha  -\\frac{L_{\\alpha}}{2}$，则 $\\Delta \\alpha_{\\mathrm{MIC}} = \\Delta \\alpha + L_{\\alpha}$。\n- 否则，$\\Delta \\alpha_{\\mathrm{MIC}} = \\Delta \\alpha$。\n\n我们将此方法应用于 $\\Delta \\mathbf{r}$ 的每个分量。\n\n对于x分量：\n半盒长为 $\\frac{L_{x}}{2} = \\frac{3.6}{2} = 1.8\\,\\mathrm{nm}$。\n位移分量为 $\\Delta x = 2.9\\,\\mathrm{nm}$。\n由于 $\\Delta x = 2.9\\,\\mathrm{nm} > 1.8\\,\\mathrm{nm}$，我们减去 $L_x$。\n$$\n\\Delta x_{\\mathrm{MIC}} = \\Delta x - L_{x} = 2.9 - 3.6 = -0.7\\,\\mathrm{nm}\n$$\n\n对于y分量：\n半盒长为 $\\frac{L_{y}}{2} = \\frac{4.2}{2} = 2.1\\,\\mathrm{nm}$。\n位移分量为 $\\Delta y = -3.3\\,\\mathrm{nm}$。\n由于 $\\Delta y = -3.3\\,\\mathrm{nm}  -2.1\\,\\mathrm{nm}$，我们加上 $L_y$。\n$$\n\\Delta y_{\\mathrm{MIC}} = \\Delta y + L_{y} = -3.3 + 4.2 = 0.9\\,\\mathrm{nm}\n$$\n\n对于z分量：\n半盒长为 $\\frac{L_{z}}{2} = \\frac{5.0}{2} = 2.5\\,\\mathrm{nm}$。\n位移分量为 $\\Delta z = -4.4\\,\\mathrm{nm}$。\n由于 $\\Delta z = -4.4\\,\\mathrm{nm}  -2.5\\,\\mathrm{nm}$，我们加上 $L_z$。\n$$\n\\Delta z_{\\mathrm{MIC}} = \\Delta z + L_{z} = -4.4 + 5.0 = 0.6\\,\\mathrm{nm}\n$$\n\n因此，最小镜像位移向量为 $\\Delta \\mathbf{r}_{\\mathrm{MIC}} = (-0.7,\\, 0.9,\\, 0.6)\\,\\mathrm{nm}$。将这些分量四舍五入到五位有效数字，得到 $\\Delta x_{\\mathrm{MIC}} = -0.70000\\,\\mathrm{nm}$、$\\Delta y_{\\mathrm{MIC}} = 0.90000\\,\\mathrm{nm}$ 和 $\\Delta z_{\\mathrm{MIC}} = 0.60000\\,\\mathrm{nm}$。\n\n接下来，我们计算该向量的大小，即最小镜像距离 $r_{\\mathrm{MIC}}$。\n$$\nr_{\\mathrm{MIC}} = \\|\\Delta \\mathbf{r}_{\\mathrm{MIC}}\\| = \\sqrt{(\\Delta x_{\\mathrm{MIC}})^2 + (\\Delta y_{\\mathrm{MIC}})^2 + (\\Delta z_{\\mathrm{MIC}})^2}\n$$\n$$\nr_{\\mathrm{MIC}} = \\sqrt{(-0.7)^2 + (0.9)^2 + (0.6)^2} = \\sqrt{0.49 + 0.81 + 0.36} = \\sqrt{1.66}\\,\\mathrm{nm}\n$$\n数值上，$r_{\\mathrm{MIC}} \\approx 1.28840987\\,\\mathrm{nm}$。\n四舍五入到五位有效数字，我们得到 $r_{\\mathrm{MIC}} = 1.2884\\,\\mathrm{nm}$。\n\n最后，我们通过将 $r_{\\mathrm{MIC}}$ 与截断半径 $r_{c} = 1.30\\,\\mathrm{nm}$ 进行比较来确定相互作用指示符 $I$。\n发生相互作用的条件是 $r_{\\mathrm{MIC}} \\le r_{c}$。\n我们有 $r_{\\mathrm{MIC}} = 1.2884\\,\\mathrm{nm}$ 和 $r_{c} = 1.30\\,\\mathrm{nm}$。由于 $1.2884 \\le 1.30$，该条件满足。\n因此，相互作用指示符为 $I = 1$。\n\n所需结果是 $\\Delta \\mathbf{r}_{\\mathrm{MIC}}$ 的分量、其大小 $r_{\\mathrm{MIC}}$ 和指示符 $I$。\n$\\Delta x_{\\mathrm{MIC}} = -0.70000\\,\\mathrm{nm}$\n$\\Delta y_{\\mathrm{MIC}} = 0.90000\\,\\mathrm{nm}$\n$\\Delta z_{\\mathrm{MIC}} = 0.60000\\,\\mathrm{nm}$\n$r_{\\mathrm{MIC}} = 1.2884\\,\\mathrm{nm}$\n$I = 1$\n这些结果将以单行矩阵的形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.70000  0.90000  0.60000  1.2884  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在分子动力学中，一条常见的经验法则是确保相互作用截断半径小于盒子长度的一半。本练习揭示了这条规则背后的物理原理。你将构建一个违反此条件的场景，并量化由此产生的虚假能量，从而展示不当的参数选择如何导致粒子与其自身的周期性镜像发生非物理性的相互作用。",
            "id": "3830813",
            "problem": "考虑一个三维正交模拟晶胞，其具有周期性边界条件（PBC），边长分别为 $L_x$、$L_y$ 和 $L_z$。最小镜像约定（MIC）要求，对于任意一对粒子，在计算对相互作用时，只使用单个最近的周期性镜像。在分子模拟中，为了使计算易于处理，对相互作用通常在截断距离 $r_c$ 处被截断。在本问题中，您将构建一个反例，以证明选择 $r_c > \\min(L_x,L_y,L_z)/2$ 会导致邻居粒子的重复计数，从而违反 MIC，并且您将量化由此产生的伪能量贡献。\n\n假设相同粒子之间存在对 Lennard–Jones (LJ) 相互作用，其势能为\n$$\nV(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right],\n$$\n在 $r_c$ 处截断（但未平移），并忽略长程尾部校正。考虑一个尺寸为 $L_x = 6$、$L_y = 10$ 和 $L_z = 12$ 的晶胞（所有长度均以 $\\sigma$ 为单位）。将粒子 A 放置在位置 $\\mathbf{r}_A = (0,0,0)$，粒子 B 放置在位置 $\\mathbf{r}_B = (2.8,0,0)$。选择截断距离 $r_c = 3.5$。\n\n任务：\n- 仅使用 PBC 和 MIC 的定义，证明沿 $x$ 轴的直接镜像分离距离和由 $-L_x$ 平移的镜像距离都位于截断距离 $r_c$ 之内，从而当 $r_c > L_x/2$ 时，对同一个物理粒子对产生了两个不同的邻居条目。\n- 计算因在最近镜像之外还计入了第二个镜像而对总势能产生的错误额外贡献。也就是说，计算相对于符合 MIC 的总能量（该能量只会计入最近的镜像）的伪额外能量，单位为 $\\epsilon$。\n\n将您的最终数值答案四舍五入到四位有效数字。以 $\\epsilon$ 为单位表示最终能量。",
            "solution": "该问题要求我们在特定条件下演示对最小镜像约定（MIC）的违反，并量化由此产生的伪能量贡献。该问题是有效的，因为它具有科学依据、问题明确且客观。\n\n给定的参数如下：\n- 正交晶胞尺寸：$L_x = 6$、$L_y = 10$ 和 $L_z = 12$。所有长度均以 Lennard-Jones 参数 $\\sigma$ 为单位。\n- 粒子 A 的位置：$\\mathbf{r}_A = (0, 0, 0)$。\n- 粒子 B 的位置：$\\mathbf{r}_B = (2.8, 0, 0)$。\n- 相互作用的截断半径：$r_c = 3.5$。\n- 对势能：Lennard-Jones (LJ) 势，$V(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right]$。\n\n首先，我们解决证明一个未严格遵守 MIC 的朴素邻居查找算法会导致对 (A, B) 相互作用进行“重复计数”的任务。当截断半径 $r_c$ 大于最小盒子尺寸的一半时，就会发生这种情况，在本例中为 $L_x/2 = 6/2 = 3$。给定 $r_c = 3.5$，条件 $r_c > L_x/2$ 得到满足。\n\n我们计算粒子 A 与位于 $\\mathbf{r}_B$ 的粒子 B 的主镜像之间的距离。分离矢量为：\n$$\n\\Delta\\mathbf{r}_0 = \\mathbf{r}_B - \\mathbf{r}_A = (2.8, 0, 0) - (0, 0, 0) = (2.8, 0, 0)\n$$\n距离是该矢量的大小：\n$$\nr_0 = |\\Delta\\mathbf{r}_0| = \\sqrt{2.8^2 + 0^2 + 0^2} = 2.8\n$$\n由于 $r_0 = 2.8  r_c = 3.5$，该相互作用在截断范围内，将被包含在能量计算中。\n\n接下来，我们考虑粒子 B 的一个周期性镜像。由于周期性边界条件（PBC），粒子 B 在所有整数三元组 $(n_x, n_y, n_z)$ 对应的位置 $\\mathbf{r}_B + n_x L_x \\hat{\\mathbf{i}} + n_y L_y \\hat{\\mathbf{j}} + n_z L_z \\hat{\\mathbf{k}}$ 处都有镜像。我们来考察对应于 $(n_x, n_y, n_z) = (-1, 0, 0)$ 的镜像。该镜像的位置 $\\mathbf{r}_B'$ 是：\n$$\n\\mathbf{r}_B' = \\mathbf{r}_B - L_x \\hat{\\mathbf{i}} = (2.8, 0, 0) - (6, 0, 0) = (-3.2, 0, 0)\n$$\n粒子 A 与此镜像之间的分离矢量是：\n$$\n\\Delta\\mathbf{r}_{-1} = \\mathbf{r}_B' - \\mathbf{r}_A = (-3.2, 0, 0) - (0, 0, 0) = (-3.2, 0, 0)\n$$\n到这个镜像的距离是：\n$$\nr_{-1} = |\\Delta\\mathbf{r}_{-1}| = \\sqrt{(-3.2)^2 + 0^2 + 0^2} = 3.2\n$$\n由于 $r_{-1} = 3.2  r_c = 3.5$，该相互作用也在截断半径之内。\n\n因此，我们已经证明粒子 B 的两个镜像都在粒子 A 的截断距离 $r_c$ 之内：一个是距离为 2.8 的主镜像，另一个是由 $-L_x$ 平移、距离为 3.2 的周期性镜像。一个有缺陷的算法，如果只是简单地检查 $r_c$ 范围内的所有镜像而不首先应用 MIC，就会将两者都计算在内，这违反了任何对相互作用只应考虑单个最近镜像的原则。\n\n第二个任务是计算对总势能的错误额外贡献。最小镜像约定要求我们找到粒子 A 与粒子 B 的任意镜像之间的最短距离。沿 $x$ 方向的各种距离为 $|2.8 + n_x L_x|$，其中 $n_x \\in \\mathbb{Z}$。当 $n_x=0$ 时，距离是 2.8。当 $n_x=-1$ 时，距离是 3.2。对于 $n_x$ 的其他整数值，距离会更大。因此，最小镜像距离是 $r_{\\mathrm{MIC}} = \\min(2.8, 3.2, \\dots) = 2.8$。\n\n根据 MIC，对 (A, B) 的正确势能是 $V(r_{\\mathrm{MIC}}) = V(2.8)$。然而，错误的计算会将在截断范围内的所有镜像的贡献相加，得到的计算能量为 $V(r_0) + V(r_{-1}) = V(2.8) + V(3.2)$。\n\n错误的额外贡献，即伪能量，是错误地包含了非最近镜像所产生的能量。它等于：\n$$\nE_{\\text{spurious}} = V(r_{-1}) = V(3.2)\n$$\n我们使用 Lennard-Jones 势计算这个值。由于所有长度都以 $\\sigma$ 为单位给出，我们可以在计算中设置 $\\sigma=1$。我们希望最终能量以 $\\epsilon$ 为单位。\n$$\n\\frac{E_{\\text{spurious}}}{\\epsilon} = 4 \\left[ \\left(\\frac{1}{r_{-1}/\\sigma}\\right)^{12} - \\left(\\frac{1}{r_{-1}/\\sigma}\\right)^6 \\right]\n$$\n代入 $r_{-1}/\\sigma = 3.2$：\n$$\n\\frac{E_{\\text{spurious}}}{\\epsilon} = 4 \\left[ \\left(\\frac{1}{3.2}\\right)^{12} - \\left(\\frac{1}{3.2}\\right)^6 \\right]\n$$\n我们计算各项：\n$$\n\\left(\\frac{1}{3.2}\\right)^6 = (0.3125)^6 \\approx 0.00093132257\n$$\n$$\n\\left(\\frac{1}{3.2}\\right)^{12} = \\left((0.3125)^6\\right)^2 \\approx (0.00093132257)^2 \\approx 8.673617 \\times 10^{-7}\n$$\n现在，将这些值代回能量表达式中：\n$$\n\\frac{E_{\\text{spurious}}}{\\epsilon} \\approx 4 \\left( 8.673617 \\times 10^{-7} - 0.00093132257 \\right)\n$$\n$$\n\\frac{E_{\\text{spurious}}}{\\epsilon} \\approx 4 ( -0.00093045521 )\n$$\n$$\n\\frac{E_{\\text{spurious}}}{\\epsilon} \\approx -0.00372182084\n$$\n按要求将结果四舍五入到四位有效数字：\n$$\n\\frac{E_{\\text{spurious}}}{\\epsilon} \\approx -0.003722\n$$\n这个负值表示对系统总能量存在一个伪吸引贡献。",
            "answer": "$$\n\\boxed{-0.003722}\n$$"
        },
        {
            "introduction": "虽然最小镜像约定在正交体系中简单明了，但其在倾斜的三斜晶胞中的应用需要仔细考虑。这个问题展示了一种基于笛卡尔坐标的朴素包裹方法的失效，并突出了使用分数坐标的正确、通用方法。解决这个问题将加深你对模拟复杂晶体结构所必需的几何变换的理解。",
            "id": "2793940",
            "problem": "考虑一个三维周期性模拟晶胞，由一个三斜布拉伐晶格定义，其晶胞矩阵为 $\\mathbf{H}$，其列向量为笛卡尔坐标系中的晶格矢量 $\\mathbf{a}$、$\\mathbf{b}$ 和 $\\mathbf{c}$。令\n$$\n\\mathbf{a}=\\begin{pmatrix}10 \\\\ 0 \\\\ 0\\end{pmatrix},\\quad\n\\mathbf{b}=\\begin{pmatrix}9.8 \\\\ 1.0 \\\\ 0\\end{pmatrix},\\quad\n\\mathbf{c}=\\begin{pmatrix}9.8 \\\\ 0.2 \\\\ 1.0\\end{pmatrix}\\ \\text{（所有分量单位为 \\AA）}.\n$$\n两个粒子相对于 $\\mathbf{H}$ 的分数坐标（也称为约化坐标）分别为 $\\mathbf{s}_{1}=\\begin{pmatrix}0 \\\\ 0 \\\\ 0\\end{pmatrix}$ 和 $\\mathbf{s}_{2}=\\begin{pmatrix}0.02 \\\\ 0.6 \\\\ 0\\end{pmatrix}$，因此它们的笛卡尔位置为 $\\mathbf{r}_{i}=\\mathbf{H}\\,\\mathbf{s}_{i}$。在周期性边界条件下，分离矢量 $\\mathbf{r}=\\mathbf{r}_{2}-\\mathbf{r}_{1}$ 的最小镜像根据第一性原理定义为\n$$\n\\mathbf{r}_{\\mathrm{mic}}=\\operatorname*{arg\\,min}_{\\mathbf{n}\\in\\mathbb{Z}^{3}}\\left\\|\\mathbf{r}-\\mathbf{H}\\,\\mathbf{n}\\right\\|_{2},\n$$\n即，在集合 $\\{\\mathbf{r}-\\mathbf{H}\\,\\mathbf{n}:\\mathbf{n}\\in\\mathbb{Z}^{3}\\}$ 中具有最小欧几里得长度的唯一成员。\n\n在偏斜晶胞中，一种常用但不正确的启发式方法是，使用从 $\\mathbf{H}$ 的上三角形式中获得的对角线长度 $L_{x},L_{y},L_{z}$（即 $L_{x}=a_{x}$，$L_{y}=b_{y}$，$L_{z}=c_{z}$），在笛卡尔坐标系中按分量进行“折叠”取整。在此晶胞中，$L_{x}=10$，$L_{y}=1$，$L_{z}=1$（单位为 \\AA）。这种朴素的笛卡尔折叠将笛卡尔矢量 $\\mathbf{r}=(r_{x},r_{y},r_{z})^{\\top}$ 映射为\n$$\n\\mathbf{r}_{\\mathrm{naive}}=\\begin{pmatrix}\nr_{x}-L_{x}\\,\\mathrm{nint}\\!\\left(\\frac{r_{x}}{L_{x}}\\right) \\\\\nr_{y}-L_{y}\\,\\mathrm{nint}\\!\\left(\\frac{r_{y}}{L_{y}}\\right) \\\\\nr_{z}-L_{z}\\,\\mathrm{nint}\\!\\left(\\frac{r_{z}}{L_{z}}\\right)\n\\end{pmatrix},\n$$\n其中 $\\mathrm{nint}(\\cdot)$ 表示四舍五入到最近的整数。\n\n仅根据以上定义，完成以下操作：\n\n1) 推导正确的三斜晶胞最小镜像映射。方法是：将 $\\mathbf{r}$ 表示为分数坐标 $\\mathbf{s}=\\mathbf{H}^{-1}\\mathbf{r}$，通过按分量减去最近整数将 $\\mathbf{s}$ 约化到中心晶胞以获得 $\\mathbf{s}'=\\mathbf{s}-\\mathrm{nint}(\\mathbf{s})$，然后通过 $\\mathbf{r}_{\\mathrm{mic}}=\\mathbf{H}\\,\\mathbf{s}'$ 映射回笛卡尔坐标。\n\n2) 对于给定的 $\\mathbf{H}$ 和 $\\mathbf{s}_{1},\\mathbf{s}_{2}$，计算明确的笛卡尔矢量 $\\mathbf{r}$、$\\mathbf{r}_{\\mathrm{mic}}$ 及其欧几里得长度。\n\n3) 使用上述规定，在 $L_{x}=10$，$L_{y}=1$，$L_{z}=1$ 的条件下，计算朴素的笛卡尔折叠矢量 $\\mathbf{r}_{\\mathrm{naive}}$ 及其欧几里得长度。\n\n4) 解释当 $\\mathbf{H}$ 是偏斜的时，为何不保证 $\\mathbf{r}_{\\mathrm{naive}}$ 对于任何 $\\mathbf{n}\\in\\mathbb{Z}^{3}$ 都等于 $\\mathbf{r}-\\mathbf{H}\\,\\mathbf{n}$，并对此示例明确验证，对于 $\\mathbf{n}\\in\\mathbb{Z}^{3}$ 的真正最小化器是由步骤1）中规定的选择所达到的。\n\n5) 定义距离误差 $\\delta=\\|\\mathbf{r}_{\\mathrm{naive}}\\|_{2}-\\|\\mathbf{r}_{\\mathrm{mic}}\\|_{2}$。计算此情况下的 $\\delta$。\n\n用 \\AA\\ 表示 $\\delta$ 的最终答案，并将答案四舍五入到四位有效数字。",
            "solution": "所提出的问题具有科学依据、问题明确且客观。它涉及理论化学和凝聚态物理中计算方法的一个基本而非凡的方面，即针对一般三斜模拟晶胞的最小镜像约定的正确实现。提供了解答唯一解所需的所有数据和定义，并且没有内部矛盾或逻辑缺陷。因此，该问题是有效的，我将着手解决它。\n\n解答分为问题陈述所要求的五个部分。\n\n1) 正确的三斜晶胞最小镜像映射的推导。\n最小镜像约定旨在找到连接两个粒子的最短矢量，同时考虑到它们所有的周期性镜像。粒子2和粒子1之间的分离矢量是 $\\mathbf{r} = \\mathbf{r}_{2} - \\mathbf{r}_{1}$。此分离矢量的所有周期性镜像的集合由 $\\{\\mathbf{r} - \\mathbf{H}\\mathbf{n} : \\mathbf{n} \\in \\mathbb{Z}^3\\}$ 给出，其中 $\\mathbf{H}$ 是晶胞矩阵，$\\mathbf{n}$ 是一个包含三个整数的矢量。最小镜像矢量 $\\mathbf{r}_{\\mathrm{mic}}$ 是该集合中具有最小欧几里得范数的唯一矢量。\n\n正确的程序避免了在笛卡尔坐标系中直接操作，因为除非晶胞是正交的，否则笛卡尔坐标系不适应晶格的周期性。相反，必须在分数坐标空间中工作，那里的周期性很简单。\n\n令 $\\mathbf{s} = \\mathbf{H}^{-1}\\mathbf{r}$ 为以分数坐标表示的分离矢量。$\\mathbf{s}$ 的分量，记为 $s_i$，表示沿晶格矢量 $\\mathbf{a}$、$\\mathbf{b}$ 和 $\\mathbf{c}$ 的位移。\n在这个分数空间中，原点的周期性镜像位于所有整数坐标 $\\mathbf{n} \\in \\mathbb{Z}^3$ 处。为了找到最接近原点的 $\\mathbf{s}$ 的镜像，我们只需为 $\\mathbf{s}$ 的每个分量找到最近的整数。此操作由最近整数函数 $\\mathrm{nint}(\\cdot)$ 表示。\n令 $\\mathbf{n}_{\\mathrm{mic}} = \\mathrm{nint}(\\mathbf{s})$，其中该函数是按分量应用的。这个整数矢量 $\\mathbf{n}_{\\mathrm{mic}}$ 定义了将 $\\mathbf{s}$ 移入中心模拟晶胞所需的平移，该晶胞通常配置为分数晶格的维格纳-赛兹原胞，即 $[-0.5, 0.5)^3$。\n约化后的分数矢量为 $\\mathbf{s}' = \\mathbf{s} - \\mathbf{n}_{\\mathrm{mic}}$。根据构造，$\\mathbf{s}'$ 的每个分量 $s'_i$ 都位于区间 $[-0.5, 0.5)$ 内。\n\n最后，将此约化分数矢量 $\\mathbf{s}'$ 映射回笛卡尔坐标，以获得最小镜像矢量：\n$$\n\\mathbf{r}_{\\mathrm{mic}} = \\mathbf{H}\\mathbf{s}' = \\mathbf{H}(\\mathbf{s} - \\mathbf{n}_{\\mathrm{mic}}) = \\mathbf{H}(\\mathbf{H}^{-1}\\mathbf{r} - \\mathrm{nint}(\\mathbf{H}^{-1}\\mathbf{r})) = \\mathbf{r} - \\mathbf{H}\\,\\mathrm{nint}(\\mathbf{H}^{-1}\\mathbf{r}).\n$$\n这是三斜晶胞的正确通用映射。使距离最小化的整数矢量是 $\\mathbf{n} = \\mathrm{nint}(\\mathbf{H}^{-1}\\mathbf{r})$。\n\n2) $\\mathbf{r}$、$\\mathbf{r}_{\\mathrm{mic}}$ 及其长度的计算。\n给定条件是晶胞矩阵 $\\mathbf{H}$，由列矢量 $\\mathbf{a}$、$\\mathbf{b}$ 和 $\\mathbf{c}$ 组成：\n$$\n\\mathbf{H} = \\begin{pmatrix} 10   9.8   9.8 \\\\ 0   1.0   0.2 \\\\ 0   0   1.0 \\end{pmatrix}\n$$\n以及分数坐标 $\\mathbf{s}_{1} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 和 $\\mathbf{s}_{2} = \\begin{pmatrix} 0.02 \\\\ 0.6 \\\\ 0 \\end{pmatrix}$。\n\n笛卡尔坐标系中的初始分离矢量是 $\\mathbf{r} = \\mathbf{r}_2 - \\mathbf{r}_1$。由于 $\\mathbf{s}_1$ 是原点，因此 $\\mathbf{r}_1 = \\mathbf{H}\\mathbf{s}_1 = \\mathbf{0}$，从而 $\\mathbf{r} = \\mathbf{r}_2$。\n$$\n\\mathbf{r} = \\mathbf{H}\\mathbf{s}_2 = \\begin{pmatrix} 10   9.8   9.8 \\\\ 0   1.0   0.2 \\\\ 0   0   1.0 \\end{pmatrix} \\begin{pmatrix} 0.02 \\\\ 0.6 \\\\ 0 \\end{pmatrix} = 0.02\\begin{pmatrix} 10 \\\\ 0 \\\\ 0 \\end{pmatrix} + 0.6\\begin{pmatrix} 9.8 \\\\ 1.0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.2 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 5.88 \\\\ 0.6 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 6.08 \\\\ 0.6 \\\\ 0 \\end{pmatrix}.\n$$\n$\\mathbf{r}$ 的欧几里得长度的平方为 $\\|\\mathbf{r}\\|_2^2 = 6.08^2 + 0.6^2 + 0^2 = 36.9664 + 0.36 = 37.3264$。其长度为 $\\|\\mathbf{r}\\|_2 = \\sqrt{37.3264} \\approx 6.1095\\ \\text{\\AA}$。\n\n为了计算 $\\mathbf{r}_{\\mathrm{mic}}$，我们遵循第1部分的程序。分数分离矢量为 $\\mathbf{s} = \\mathbf{s}_2 - \\mathbf{s}_1 = \\begin{pmatrix} 0.02 \\\\ 0.6 \\\\ 0 \\end{pmatrix}$。\n我们找到最近的整数矢量：$\\mathbf{n}_{\\mathrm{mic}} = \\mathrm{nint}(\\mathbf{s}) = \\begin{pmatrix} \\mathrm{nint}(0.02) \\\\ \\mathrm{nint}(0.6) \\\\ \\mathrm{nint}(0) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n约化后的分数矢量为 $\\mathbf{s}' = \\mathbf{s} - \\mathbf{n}_{\\mathrm{mic}} = \\begin{pmatrix} 0.02 \\\\ 0.6 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.02 \\\\ -0.4 \\\\ 0 \\end{pmatrix}$。\n最后，我们将 $\\mathbf{s}'$ 映射回笛卡尔坐标：\n$$\n\\mathbf{r}_{\\mathrm{mic}} = \\mathbf{H}\\mathbf{s}' = \\begin{pmatrix} 10   9.8   9.8 \\\\ 0   1.0   0.2 \\\\ 0   0   1.0 \\end{pmatrix} \\begin{pmatrix} 0.02 \\\\ -0.4 \\\\ 0 \\end{pmatrix} = 0.02\\begin{pmatrix} 10 \\\\ 0 \\\\ 0 \\end{pmatrix} - 0.4\\begin{pmatrix} 9.8 \\\\ 1.0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.2 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 3.92 \\\\ 0.4 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -3.72 \\\\ -0.4 \\\\ 0 \\end{pmatrix}.\n$$\n欧几里得长度的平方为 $\\|\\mathbf{r}_{\\mathrm{mic}}\\|_2^2 = (-3.72)^2 + (-0.4)^2 + 0^2 = 13.8384 + 0.16 = 13.9984$。其长度为 $\\|\\mathbf{r}_{\\mathrm{mic}}\\|_2 = \\sqrt{13.9984} \\approx 3.7414\\ \\text{\\AA}$。\n\n3) 朴素的笛卡尔折叠矢量 $\\mathbf{r}_{\\mathrm{naive}}$ 及其长度的计算。\n朴素方法使用上三角晶胞矩阵的对角元素，$L_x=10$，$L_y=1$，$L_z=1$。它对笛卡尔矢量 $\\mathbf{r} = \\begin{pmatrix} 6.08 \\\\ 0.6 \\\\ 0 \\end{pmatrix}$ 进行分量折叠。\n$$\nr_{\\mathrm{naive}, x} = r_x - L_x\\,\\mathrm{nint}\\!\\left(\\frac{r_x}{L_x}\\right) = 6.08 - 10\\,\\mathrm{nint}\\!\\left(\\frac{6.08}{10}\\right) = 6.08 - 10\\,\\mathrm{nint}(0.608) = 6.08 - 10(1) = -3.92.\n$$\n$$\nr_{\\mathrm{naive}, y} = r_y - L_y\\,\\mathrm{nint}\\!\\left(\\frac{r_y}{L_y}\\right) = 0.6 - 1\\,\\mathrm{nint}\\!\\left(\\frac{0.6}{1}\\right) = 0.6 - 1\\,\\mathrm{nint}(0.6) = 0.6 - 1(1) = -0.4.\n$$\n$$\nr_{\\mathrm{naive}, z} = r_z - L_z\\,\\mathrm{nint}\\!\\left(\\frac{r_z}{L_z}\\right) = 0 - 1\\,\\mathrm{nint}\\!\\left(\\frac{0}{1}\\right) = 0 - 1(0) = 0.\n$$\n因此，$\\mathbf{r}_{\\mathrm{naive}} = \\begin{pmatrix} -3.92 \\\\ -0.4 \\\\ 0 \\end{pmatrix}$。\n欧几里得长度的平方为 $\\|\\mathbf{r}_{\\mathrm{naive}}\\|_2^2 = (-3.92)^2 + (-0.4)^2 + 0^2 = 15.3664 + 0.16 = 15.5264$。其长度为 $\\|\\mathbf{r}_{\\mathrm{naive}}\\|_2 = \\sqrt{15.5264} \\approx 3.9404\\ \\text{\\AA}$。\n\n4) 朴素方法的缺陷解释与验证。\n朴素笛卡尔折叠的根本缺陷在于，从 $\\mathbf{r}$ 中减去的矢量通常不是 $\\mathbf{n} \\in \\mathbb{Z}^3$ 形式的晶格矢量 $\\mathbf{H}\\mathbf{n}$。一个矢量 $\\mathbf{v}$ 是 $\\mathbf{r}$ 的有效周期性镜像，当且仅当对于某个整数矢量 $\\mathbf{n}$，有 $\\mathbf{v} = \\mathbf{r} - \\mathbf{H}\\mathbf{n}$。\n在朴素方法中，减去的矢量是 $\\mathbf{v}_{\\mathrm{sub}} = \\begin{pmatrix} L_x\\,\\mathrm{nint}(r_x/L_x) \\\\ L_y\\,\\mathrm{nint}(r_y/L_y) \\\\ L_z\\,\\mathrm{nint}(r_z/L_z) \\end{pmatrix}$。对于此示例，这是 $\\mathbf{v}_{\\mathrm{sub}} = \\begin{pmatrix} 10(1) \\\\ 1(1) \\\\ 1(0) \\end{pmatrix} = \\begin{pmatrix} 10 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n要使 $\\mathbf{v}_{\\mathrm{sub}}$ 成为一个有效的晶格矢量，必须存在一个整数矢量 $\\mathbf{n}$ 使得 $\\mathbf{H}\\mathbf{n} = \\mathbf{v}_{\\mathrm{sub}}$。求解 $\\mathbf{n}$ 得到 $\\mathbf{n} = \\mathbf{H}^{-1}\\mathbf{v}_{\\mathrm{sub}}$。矩阵 $\\mathbf{H}$ 是上三角矩阵，因此其逆矩阵也是上三角矩阵：\n$$\n\\mathbf{H}^{-1} = \\begin{pmatrix} 1/10  -9.8/10  (-9.8 \\cdot 0.2 + 9.8 \\cdot 1)/10 \\\\ 0  1  -0.2/1 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0.1  -0.98  -0.784 \\\\ 0  1  -0.2 \\\\ 0  0  1 \\end{pmatrix}.\n$$\n让我们计算 $\\mathbf{n}$：\n$$\n\\mathbf{n} = \\begin{pmatrix} 0.1  -0.98  -0.784 \\\\ 0  1  -0.2 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.1(10) - 0.98(1) \\\\ 1(1) \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 - 0.98 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.02 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n由于这个 $\\mathbf{n}$ 不是整数矢量，矢量 $\\begin{pmatrix} 10 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 不是一个晶格矢量，因此 $\\mathbf{r}_{\\mathrm{naive}}$ 不是 $\\mathbf{r}$ 的一个有效周期性镜像。这种笛卡尔折叠程序产生了一个在集合 $\\{\\mathbf{r} - \\mathbf{H}\\mathbf{n}\\}$ 之外的矢量。\n\n为了验证第1部分的方法确实得到了真正的最小化器，我们检查整数矢量 $\\mathbf{n}_{\\mathrm{mic}} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$。相应的距离平方为 $\\|\\mathbf{r}_{\\mathrm{mic}}\\|_2^2 = 13.9984$。我们必须检查其他整数矢量 $\\mathbf{n}$ 是否会产生更小的距离。\n*   对于 $\\mathbf{n} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$：$\\|\\mathbf{r} - \\mathbf{H}\\mathbf{n}\\|^2 = \\|\\mathbf{r}\\|^2 = 37.3264$。\n*   对于 $\\mathbf{n} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$：$\\mathbf{H}\\mathbf{n} = \\mathbf{a} = \\begin{pmatrix} 10 \\\\ 0 \\\\ 0 \\end{pmatrix}$。镜像是 $\\mathbf{r} - \\mathbf{a} = \\begin{pmatrix} -3.92 \\\\ 0.6 \\\\ 0 \\end{pmatrix}$。长度平方是 $(-3.92)^2 + 0.6^2 = 15.3664 + 0.36 = 15.7264$。\n*   对于 $\\mathbf{n} = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$：$\\mathbf{H}\\mathbf{n} = \\mathbf{b}-\\mathbf{a} = \\begin{pmatrix} -0.2 \\\\ 1.0 \\\\ 0 \\end{pmatrix}$。镜像是 $\\mathbf{r} - (\\mathbf{b}-\\mathbf{a}) = \\begin{pmatrix} 6.28 \\\\ -0.4 \\\\ 0 \\end{pmatrix}$。长度平方是 $6.28^2 + (-0.4)^2 = 39.4384 + 0.16 = 39.5984$。\n所有相邻的整数矢量 $\\mathbf{n}$ 所产生的距离平方都比 $\\mathbf{n}_{\\mathrm{mic}} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 的要大。这证实了约化分数坐标的程序在此情况下得出了正确的最小镜像。\n\n5) 距离误差 $\\delta$ 的计算。\n计算出的距离误差定义为 $\\delta = \\|\\mathbf{r}_{\\mathrm{naive}}\\|_2 - \\|\\mathbf{r}_{\\mathrm{mic}}\\|_2$。\n使用之前计算的值：\n$$\n\\delta = \\sqrt{15.5264} - \\sqrt{13.9984}\n$$\n$$\n\\delta \\approx 3.9403553 - 3.7414436 = 0.1989117\n$$\n四舍五入到四位有效数字，距离误差为 $\\delta \\approx 0.1989\\ \\text{\\AA}$。这个误差表明，朴素的笛卡尔折叠不仅产生了一个物理上不正确的镜像矢量，而且还高估了粒子间的最小距离。",
            "answer": "$$\n\\boxed{0.1989}\n$$"
        }
    ]
}