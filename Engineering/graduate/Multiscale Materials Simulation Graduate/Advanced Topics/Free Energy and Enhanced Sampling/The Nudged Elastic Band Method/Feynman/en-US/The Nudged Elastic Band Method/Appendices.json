{
    "hands_on_practices": [
        {
            "introduction": "To truly understand the Nudged Elastic Band method, we must first dissect the effective force that drives the optimization. This force is a careful combination of the true potential force and an artificial spring force, each projected into a specific direction. This first exercise  provides a direct, hands-on calculation of these components for a single image, clarifying how the perpendicular force component guides the path towards the minimum energy path while the parallel spring force component ensures even spacing.",
            "id": "3849267",
            "problem": "Consider a discrete path of images used in the Nudged Elastic Band (NEB) method for finding a minimum-energy pathway in a two-dimensional configuration space. You are given three consecutive images with positions $\\mathbf{R}_{i-1} = (1.0,\\,0.0)$, $\\mathbf{R}_{i} = (2.0,\\,1.0)$, and $\\mathbf{R}_{i+1} = (3.5,\\,1.5)$, where all coordinates are in Ångström units. The path tangent at image $i$ is prescribed as the unit vector $\\hat{\\tau}_{i} = \\left(\\frac{1}{\\sqrt{2}},\\,\\frac{1}{\\sqrt{2}}\\right)$. The potential energy gradient at $\\mathbf{R}_{i}$ is $\\nabla V(\\mathbf{R}_{i}) = (4,\\,-2)$ in electronvolt per Ångström. The physical force is $\\mathbf{F}_{i}^{\\text{true}} = -\\nabla V(\\mathbf{R}_{i})$. The NEB spring constant is $k = 0.5$ in electronvolt per Ångström squared. The image is updated by a steepest-descent move using the NEB force with step size $\\eta = \\frac{1}{20}$ in Ångström squared per electronvolt.\n\nStarting from the following fundamental bases:\n- The physical force is given by $\\mathbf{F} = -\\nabla V$.\n- The parallel component of a vector $\\mathbf{a}$ along a unit direction $\\hat{\\mathbf{u}}$ is $(\\mathbf{a}\\cdot\\hat{\\mathbf{u}})\\,\\hat{\\mathbf{u}}$, and the perpendicular component is $\\mathbf{a} - (\\mathbf{a}\\cdot\\hat{\\mathbf{u}})\\,\\hat{\\mathbf{u}}$.\n- A steepest-descent update for position uses $\\mathbf{R}^{\\text{new}} = \\mathbf{R}^{\\text{old}} + \\eta\\,\\mathbf{F}^{\\text{eff}}$ for an effective force $\\mathbf{F}^{\\text{eff}}$.\n\nCompute the perpendicular and parallel components of $\\mathbf{F}_{i}^{\\text{true}}$ with respect to $\\hat{\\tau}_{i}$. Then, using the difference of neighbor separations along the path computed from the given positions, construct the parallel spring contribution along $\\hat{\\tau}_{i}$ and form the NEB effective force by combining the physical perpendicular component and the parallel spring term. Finally, determine the magnitude of the single-step displacement $\\|\\Delta \\mathbf{R}_{i}\\| = \\|\\eta\\,\\mathbf{F}_{i}^{\\text{NEB}}\\|$ produced by this NEB update.\n\nProvide your final answer as an exact closed-form analytical expression. Express the displacement magnitude in Ångström. Do not round; an exact expression is required. The final answer must be a single expression.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and all necessary information is provided.\n\n**Problem Validation**\n\nGivens extracted from the problem statement:\n- Positions of three consecutive images: $\\mathbf{R}_{i-1} = (1.0,\\,0.0)$, $\\mathbf{R}_{i} = (2.0,\\,1.0)$, and $\\mathbf{R}_{i+1} = (3.5,\\,1.5)$. All coordinates are in units of Ångström (Å).\n- Prescribed path tangent at image $i$: $\\hat{\\tau}_{i} = \\left(\\frac{1}{\\sqrt{2}},\\,\\frac{1}{\\sqrt{2}}\\right)$.\n- Potential energy gradient at $\\mathbf{R}_{i}$: $\\nabla V(\\mathbf{R}_{i}) = (4,\\,-2)$ in units of electronvolt per Ångström (eV/Å).\n- Definition of the true physical force: $\\mathbf{F}_{i}^{\\text{true}} = -\\nabla V(\\mathbf{R}_{i})$.\n- NEB spring constant: $k = 0.5$ eV/Å$^2$.\n- Steepest-descent step size: $\\eta = \\frac{1}{20}$ Å$^2$/eV.\n- Update rule: $\\mathbf{R}^{\\text{new}} = \\mathbf{R}^{\\text{old}} + \\eta\\,\\mathbf{F}^{\\text{eff}}$.\n- Definitions for vector components: Parallel component of $\\mathbf{a}$ along $\\hat{\\mathbf{u}}$ is $(\\mathbf{a}\\cdot\\hat{\\mathbf{u}})\\,\\hat{\\mathbf{u}}$, and the perpendicular component is $\\mathbf{a} - (\\mathbf{a}\\cdot\\hat{\\mathbf{u}})\\,\\hat{\\mathbf{u}}$.\n\nThe problem is scientifically sound, as it is based on the well-established Nudged Elastic Band (NEB) method used in computational science. All parameters are explicitly defined, the units are consistent, and the objectives are clear. The use of a prescribed tangent vector is a valid simplification for an exercise of this nature and does not create a contradiction. Therefore, the problem is deemed valid and a solution can be derived.\n\n**Solution Derivation**\n\nThe solution proceeds by following the steps requested in the problem statement.\n\nFirst, we determine the true physical force $\\mathbf{F}_{i}^{\\text{true}}$ acting on image $i$ using the given potential energy gradient:\n$$\n\\mathbf{F}_{i}^{\\text{true}} = -\\nabla V(\\mathbf{R}_{i}) = -(4,\\,-2) = (-4,\\,2) \\quad \\text{eV/Å}\n$$\n\nNext, we decompose this force into components parallel and perpendicular to the prescribed path tangent $\\hat{\\tau}_{i} = \\left(\\frac{1}{\\sqrt{2}},\\,\\frac{1}{\\sqrt{2}}\\right)$. The parallel component is found by projecting $\\mathbf{F}_{i}^{\\text{true}}$ onto $\\hat{\\tau}_{i}$:\n$$\n\\mathbf{F}_{i}^{\\text{true},\\parallel} = (\\mathbf{F}_{i}^{\\text{true}} \\cdot \\hat{\\tau}_{i}) \\hat{\\tau}_{i}\n$$\nThe scalar projection is:\n$$\n\\mathbf{F}_{i}^{\\text{true}} \\cdot \\hat{\\tau}_{i} = (-4,\\,2) \\cdot \\left(\\frac{1}{\\sqrt{2}},\\,\\frac{1}{\\sqrt{2}}\\right) = -4\\left(\\frac{1}{\\sqrt{2}}\\right) + 2\\left(\\frac{1}{\\sqrt{2}}\\right) = -\\frac{2}{\\sqrt{2}} = -\\sqrt{2} \\quad \\text{eV/Å}\n$$\nThe perpendicular component of the true force, $\\mathbf{F}_{i}^{\\perp}$, is the part of the true force that is orthogonal to the path tangent. This component is used in the NEB force to guide the path towards the minimum energy path without causing the images to slide along the path.\n$$\n\\mathbf{F}_{i}^{\\perp} = \\mathbf{F}_{i}^{\\text{true}} - \\mathbf{F}_{i}^{\\text{true},\\parallel} = \\mathbf{F}_{i}^{\\text{true}} - (\\mathbf{F}_{i}^{\\text{true}} \\cdot \\hat{\\tau}_{i}) \\hat{\\tau}_{i}\n$$\nSubstituting the values:\n$$\n\\mathbf{F}_{i}^{\\perp} = (-4,\\,2) - (-\\sqrt{2})\\left(\\frac{1}{\\sqrt{2}},\\,\\frac{1}{\\sqrt{2}}\\right) = (-4,\\,2) - (-1,\\,-1) = (-3,\\,3) \\quad \\text{eV/Å}\n$$\n\nThe second part of the NEB force is the spring force, which acts to maintain equal spacing between the images along the path. The spring force acts parallel to the path tangent.\n$$\n\\mathbf{F}_{i}^{\\text{spring},\\parallel} = k (\\|\\mathbf{R}_{i+1} - \\mathbf{R}_{i}\\| - \\|\\mathbf{R}_{i} - \\mathbf{R}_{i-1}\\|) \\hat{\\tau}_{i}\n$$\nWe need to calculate the lengths of the path segments adjacent to image $i$:\n$$\n\\mathbf{R}_{i} - \\mathbf{R}_{i-1} = (2.0 - 1.0,\\,1.0 - 0.0) = (1,\\,1) \\quad \\text{Å}\n$$\n$$\n\\|\\mathbf{R}_{i} - \\mathbf{R}_{i-1}\\| = \\sqrt{1^2 + 1^2} = \\sqrt{2} \\quad \\text{Å}\n$$\n$$\n\\mathbf{R}_{i+1} - \\mathbf{R}_{i} = (3.5 - 2.0,\\,1.5 - 1.0) = (1.5,\\,0.5) = \\left(\\frac{3}{2},\\,\\frac{1}{2}\\right) \\quad \\text{Å}\n$$\n$$\n\\|\\mathbf{R}_{i+1} - \\mathbf{R}_{i}\\| = \\sqrt{\\left(\\frac{3}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2} = \\sqrt{\\frac{9}{4} + \\frac{1}{4}} = \\sqrt{\\frac{10}{4}} = \\sqrt{\\frac{5}{2}} \\quad \\text{Å}\n$$\nWith the spring constant $k = 0.5 = \\frac{1}{2}$ eV/Å$^2$, the spring force is:\n$$\n\\mathbf{F}_{i}^{\\text{spring},\\parallel} = \\frac{1}{2} \\left(\\sqrt{\\frac{5}{2}} - \\sqrt{2}\\right) \\hat{\\tau}_{i}\n$$\n\nThe total NEB force, $\\mathbf{F}_{i}^{\\text{NEB}}$, is the sum of the perpendicular component of the true force and the parallel component of the spring force:\n$$\n\\mathbf{F}_{i}^{\\text{NEB}} = \\mathbf{F}_{i}^{\\perp} + \\mathbf{F}_{i}^{\\text{spring},\\parallel}\n$$\nSince $\\mathbf{F}_{i}^{\\perp}$ is orthogonal to $\\hat{\\tau}_{i}$ and $\\mathbf{F}_{i}^{\\text{spring},\\parallel}$ is parallel to $\\hat{\\tau}_{i}$, these two vectors are orthogonal to each other. Therefore, the squared magnitude of the total NEB force is the sum of their squared magnitudes:\n$$\n\\|\\mathbf{F}_{i}^{\\text{NEB}}\\|^2 = \\|\\mathbf{F}_{i}^{\\perp}\\|^2 + \\|\\mathbf{F}_{i}^{\\text{spring},\\parallel}\\|^2\n$$\nLet's calculate the squared magnitudes:\n$$\n\\|\\mathbf{F}_{i}^{\\perp}\\|^2 =\\|(-3,\\,3)\\|^2 = (-3)^2 + 3^2 = 9 + 9 = 18\n$$\n$$\n\\|\\mathbf{F}_{i}^{\\text{spring},\\parallel}\\|^2 = \\left\\| \\frac{1}{2} \\left(\\sqrt{\\frac{5}{2}} - \\sqrt{2}\\right) \\hat{\\tau}_{i} \\right\\|^2 = \\left( \\frac{1}{2} \\left(\\sqrt{\\frac{5}{2}} - \\sqrt{2}\\right) \\right)^2 \\|\\hat{\\tau}_{i}\\|^2\n$$\nSince $\\hat{\\tau}_{i}$ is a unit vector, $\\|\\hat{\\tau}_{i}\\|^2 = 1$.\n$$\n\\|\\mathbf{F}_{i}^{\\text{spring},\\parallel}\\|^2 = \\frac{1}{4} \\left(\\sqrt{\\frac{5}{2}} - \\sqrt{2}\\right)^2 = \\frac{1}{4} \\left( \\frac{5}{2} - 2\\sqrt{\\frac{5}{2}}\\sqrt{2} + 2 \\right) = \\frac{1}{4} \\left( \\frac{9}{2} - 2\\sqrt{5} \\right) = \\frac{9}{8} - \\frac{\\sqrt{5}}{2} = \\frac{9 - 4\\sqrt{5}}{8}\n$$\nNow, summing the squared magnitudes:\n$$\n\\|\\mathbf{F}_{i}^{\\text{NEB}}\\|^2 = 18 + \\frac{9 - 4\\sqrt{5}}{8} = \\frac{144}{8} + \\frac{9 - 4\\sqrt{5}}{8} = \\frac{153 - 4\\sqrt{5}}{8}\n$$\n\nFinally, we compute the magnitude of the single-step displacement, $\\|\\Delta \\mathbf{R}_{i}\\|$, using the steepest-descent update rule with step size $\\eta = \\frac{1}{20}$:\n$$\n\\|\\Delta \\mathbf{R}_{i}\\| = \\|\\eta\\,\\mathbf{F}_{i}^{\\text{NEB}}\\| = \\eta \\|\\mathbf{F}_{i}^{\\text{NEB}}\\| = \\frac{1}{20} \\sqrt{\\frac{153 - 4\\sqrt{5}}{8}}\n$$\nTo present this as a single fraction, we simplify the expression:\n$$\n\\|\\Delta \\mathbf{R}_{i}\\| = \\frac{1}{20} \\frac{\\sqrt{153 - 4\\sqrt{5}}}{\\sqrt{8}} = \\frac{\\sqrt{153 - 4\\sqrt{5}}}{20 \\cdot 2\\sqrt{2}} = \\frac{\\sqrt{153 - 4\\sqrt{5}}}{40\\sqrt{2}}\n$$\nRationalizing the denominator:\n$$\n\\|\\Delta \\mathbf{R}_{i}\\| = \\frac{\\sqrt{153 - 4\\sqrt{5}} \\cdot \\sqrt{2}}{40\\sqrt{2} \\cdot \\sqrt{2}} = \\frac{\\sqrt{2(153 - 4\\sqrt{5})}}{40 \\cdot 2} = \\frac{\\sqrt{306 - 8\\sqrt{5}}}{80}\n$$\nThis is the final exact analytical expression for the magnitude of the displacement in Ångströms.",
            "answer": "$$\\boxed{\\frac{\\sqrt{306 - 8\\sqrt{5}}}{80}}$$"
        },
        {
            "introduction": "Moving from a single image to a chain of states requires a robust definition for the local path tangent, $\\hat{\\tau}$. A naive geometric definition can lead to numerical instabilities, particularly near energy extrema. This practice  guides you through implementing and comparing a simple centered-difference tangent with an improved, energy-weighted definition on the classic Müller-Brown potential surface, revealing the importance of this algorithmic detail for stable convergence.",
            "id": "3849299",
            "problem": "You are given a two-dimensional potential energy surface known as the Müller–Brown surface. Consider a discretized path formed by a sequence of images between two fixed endpoints on this surface. The goal is to construct an algorithm to compute image tangents using two different definitions, assemble the corresponding Nudged Elastic Band (NEB) forces, perform one explicit Euler update for the image positions, and compare the aggregate motions resulting from the naive versus improved tangent definitions.\n\nStart from the following fundamental bases and core definitions:\n\n- A potential energy function $V(\\mathbf{r})$ produces a force $\\mathbf{F}(\\mathbf{r}) = -\\nabla V(\\mathbf{r})$ by the negative gradient.\n- A path in configuration space is discretized into $N$ images $\\{\\mathbf{R}_0, \\mathbf{R}_1, \\ldots, \\mathbf{R}_{N-1}\\}$, where $\\mathbf{R}_0$ and $\\mathbf{R}_{N-1}$ are fixed endpoints, and images $\\mathbf{R}_i$ for $i \\in \\{1,\\ldots,N-2\\}$ can move according to a defined force.\n- The concept of vector projection onto a unit-direction vector and its perpendicular complement allows decomposition of any vector into components parallel and orthogonal to a direction.\n\nThe Müller–Brown potential $V(x,y)$ is defined by a sum of four Gaussian-like terms with parameters that are widely used in literature. Let the parameters be:\n- $A = [-200, -100, -170, 15]$,\n- $a = [-1, -1, -6.5, 0.7]$,\n- $b = [0, 0, 11, 0.6]$,\n- $c = [-10, -10, -6.5, 0.7]$,\n- $x_0 = [1, 0, -0.5, -1]$,\n- $y_0 = [0, 0.5, 1.5, 1]$.\n\nThe potential is:\n$$\nV(x,y) = \\sum_{k=1}^{4} A_k \\exp\\left(a_k (x - x_{0,k})^2 + b_k (x - x_{0,k})(y - y_{0,k}) + c_k (y - y_{0,k})^2\\right).\n$$\n\nFrom this $V(x,y)$, compute the gradient components explicitly via differentiation of the exponentials to obtain $\\partial V / \\partial x$ and $\\partial V / \\partial y$ for use in the force $\\mathbf{F}(\\mathbf{r}) = -\\nabla V(\\mathbf{r})$.\n\nFor each interior image $\\mathbf{R}_i$ with $i \\in \\{1,\\ldots,N-2\\}$, define two tangent schemes:\n\n- Naive tangent definition: Use a centered difference direction based on neighboring images and normalize it to a unit vector. When a centered difference degenerates to the zero vector, fall back to a directional difference based on a single neighbor with the larger segment length, and normalize.\n\n- Improved tangent definition: Use the energies of neighboring images to determine the direction. Let $E_i = V(\\mathbf{R}_i)$, and define energy differences $dE_{+} = E_{i+1} - E_i$ and $dE_{-} = E_{i-1} - E_i$. Choose the tangent using these rules:\n  1. If both neighbors are higher in energy, i.e., $dE_{+} > 0$ and $dE_{-} > 0$, construct a direction as a weighted sum of forward and backward differences, with weights proportional to the magnitudes of the energy increases, and normalize the result.\n  2. If both neighbors are lower in energy, i.e., $dE_{+}  0$ and $dE_{-}  0$, construct a direction as a weighted sum of forward and backward differences, with weights proportional to the magnitudes of the energy decreases, and normalize the result.\n  3. Otherwise (monotonic energy change across the image), choose the difference vector toward the neighbor with the larger magnitude of energy change, and normalize the result.\n\nUsing the unit tangent $\\hat{\\tau}_i$ for each interior image, assemble the NEB force that comprises:\n- The true force component perpendicular to the path tangent, computed by decomposing the gradient-based force into parallel and perpendicular components with respect to $\\hat{\\tau}_i$, and discarding the parallel component.\n- A spring force that acts along the path tangent, designed to maintain even spacing of the images, using a linear spring with constant $k$ that depends on the difference of adjacent segment lengths.\n\nAfter computing these forces, perform a single explicit Euler update step with step size $\\Delta t$ for the interior images:\n$$\n\\mathbf{R}_i^{\\text{new}} = \\mathbf{R}_i + \\Delta t \\, \\mathbf{F}_i^{\\text{NEB}},\n$$\nwhile keeping endpoints fixed.\n\nYour program must:\n\n1. Implement $V(x,y)$ and its gradient $\\nabla V(x,y)$.\n2. Construct an initial path of $N$ images by linear interpolation between the given fixed endpoints.\n3. Compute image energies $E_i$.\n4. Compute tangents $\\hat{\\tau}_i$ via both the naive and improved definitions described above.\n5. Assemble NEB forces using the perpendicular component of the true force and the tangential spring force with spring constant $k$.\n6. Perform one explicit Euler update with step size $\\Delta t$ on interior images for each tangent definition.\n7. For each case, return four quantities:\n   - The sum of Euclidean norms of NEB forces over interior images using the naive tangent.\n   - The sum of Euclidean norms of NEB forces over interior images using the improved tangent.\n   - The sum of Euclidean norms of the Euler displacements over interior images using the naive tangent.\n   - The sum of Euclidean norms of the Euler displacements over interior images using the improved tangent.\n\nAll quantities are dimensionless in this problem. There are no angles or percentages involved.\n\nEndpoints for all tests are fixed at approximations to two known minima of the Müller–Brown surface:\n- $\\mathbf{R}_{\\text{start}} = (-0.558, \\; 1.442)$,\n- $\\mathbf{R}_{\\text{end}} = (0.623, \\; 0.028)$.\n\nTest Suite:\n- Case $1$: $N = 9$, $k = 1.0$, $\\Delta t = 0.05$.\n- Case $2$: $N = 3$, $k = 1.0$, $\\Delta t = 0.05$.\n- Case $3$: $N = 7$, $k = 5.0$, $\\Delta t = 0.10$.\n- Case $4$: $N = 11$, $k = 0.0$, $\\Delta t = 0.05$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case result is itself a list of four numbers in the order specified above. For example, an output line should look like:\n$$\n[\\,[f_1^{\\text{naive}}, f_1^{\\text{improved}}, d_1^{\\text{naive}}, d_1^{\\text{improved}}],\\,[f_2^{\\text{naive}}, f_2^{\\text{improved}}, d_2^{\\text{naive}}, d_2^{\\text{improved}}],\\,\\ldots\\,]\n$$",
            "solution": "The problem requires the implementation and comparison of two different tangent definitions within the Nudged Elastic Band (NEB) method. We will perform a single simulation step for a discretized path on the Müller-Brown potential energy surface. The process involves defining the potential and its gradient, initializing a path, computing NEB forces using both tangent schemes, and applying one explicit Euler integration step.\n\nFirst, we define the mathematical framework for the Müller-Brown potential energy surface (PES) and the forces derived from it. The potential $V(x,y)$ is given by:\n$$\nV(x,y) = \\sum_{k=1}^{4} A_k \\exp\\left(a_k (x - x_{0,k})^2 + b_k (x - x_{0,k})(y - y_{0,k}) + c_k (y - y_{0,k})^2\\right)\n$$\nThe parameters $\\{A_k, a_k, b_k, c_k, x_{0,k}, y_{0,k}\\}$ for $k \\in \\{1,2,3,4\\}$ are provided constants. Let $\\mathbf{r} = (x,y)$ be a position vector. The force on a particle at $\\mathbf{r}$ is given by the negative gradient of the potential, $\\mathbf{F}(\\mathbf{r}) = -\\nabla V(\\mathbf{r})$. The components of the gradient are found by partial differentiation:\n$$\n\\frac{\\partial V}{\\partial x} = \\sum_{k=1}^{4} A_k \\exp(\\dots) \\left[ 2a_k(x-x_{0,k}) + b_k(y-y_{0,k}) \\right]\n$$\n$$\n\\frac{\\partial V}{\\partial y} = \\sum_{k=1}^{4} A_k \\exp(\\dots) \\left[ b_k(x-x_{0,k}) + 2c_k(y-y_{0,k}) \\right]\n$$\nwhere $\\exp(\\dots)$ represents the full exponential term from the definition of $V(x,y)$.\n\nA reaction path is discretized into a sequence of $N$ images, denoted $\\{\\mathbf{R}_0, \\mathbf{R}_1, \\dots, \\mathbf{R}_{N-1}\\}$. The images $\\mathbf{R}_0$ and $\\mathbf{R}_{N-1}$ are fixed endpoints, corresponding to local minima on the PES. The initial path is constructed by linear interpolation between these endpoints:\n$$\n\\mathbf{R}_i = \\mathbf{R}_0 + \\frac{i}{N-1}(\\mathbf{R}_{N-1} - \\mathbf{R}_0) \\quad \\text{for } i = 0, \\dots, N-1.\n$$\n\nThe core of the NEB method is the definition of the force acting on the interior images $\\mathbf{R}_i$ for $i \\in \\{1, \\dots, N-2\\}$. This force, $\\mathbf{F}_i^{\\text{NEB}}$, is composed of two parts: the perpendicular component of the true potential force, $\\mathbf{F}_i^\\perp$, and a parallel spring force, $\\mathbf{F}_i^s$.\n$$\n\\mathbf{F}_i^{\\text{NEB}} = \\mathbf{F}_i^\\perp + \\mathbf{F}_i^s\n$$\nThe true force is $\\mathbf{F}_i = -\\nabla V(\\mathbf{R}_i)$. The decomposition requires a tangent vector $\\hat{\\tau}_i$ that defines the local direction of the path. The perpendicular force component moves the image towards the minimum energy path:\n$$\n\\mathbf{F}_i^\\perp = \\mathbf{F}_i - (\\mathbf{F}_i \\cdot \\hat{\\tau}_i)\\hat{\\tau}_i\n$$\nThe spring force component ensures approximately even spacing of the images along the path:\n$$\n\\mathbf{F}_i^s = k (\\|\\mathbf{R}_{i+1} - \\mathbf{R}_i\\| - \\|\\mathbf{R}_i - \\mathbf{R}_{i-1}\\|) \\hat{\\tau}_i\n$$\nHere, $k$ is the spring constant. The problem asks to evaluate two different definitions for the tangent vector $\\hat{\\tau}_i$.\n\n1.  **Naive Tangent**: The tangent is estimated using a simple centered finite difference of the image positions.\n    $$\n    \\mathbf{\\tau}_{i, \\text{naive}} = \\mathbf{R}_{i+1} - \\mathbf{R}_{i-1}\n    $$\n    This vector is then normalized to unit length, $\\hat{\\tau}_{i, \\text{naive}} = \\mathbf{\\tau}_{i, \\text{naive}} / \\|\\mathbf{\\tau}_{i, \\text{naive}}\\|$. A fallback is defined for the degenerate case where $\\mathbf{R}_{i+1} = \\mathbf{R}_{i-1}$, which would make the tangent vector zero. In this situation, the tangent is taken as the normalized vector along the longer of the two segments connecting to the neighbors, $(\\mathbf{R}_{i+1} - \\mathbf{R}_i)$ or $(\\mathbf{R}_i - \\mathbf{R}_{i-1})$.\n\n2.  **Improved Tangent**: This definition, inspired by the work of Henkelman and Jónsson, uses the potential energy of the images, $E_j=V(\\mathbf{R}_j)$, to provide a more robust tangent estimate, especially near extrema. Let $dE_+ = E_{i+1} - E_i$ and $dE_- = E_{i-1} - E_i$. The tangent is defined by three cases:\n    - If the image $\\mathbf{R}_i$ is at a local minimum or maximum of energy along the band (i.e., $(dE_+ > 0 \\text{ and } dE_- > 0)$ or $(dE_+  0 \\text{ and } dE_-  0)$), the tangent is a weighted average of the vectors to adjacent images, $\\mathbf{v}_+ = \\mathbf{R}_{i+1}-\\mathbf{R}_i$ and $\\mathbf{v}_- = \\mathbf{R}_i-\\mathbf{R}_{i-1}$. To prevent kinking, the tangent is weighted to be more aligned with the segment experiencing a smaller change in energy. The unnormalized tangent is $\\mathbf{\\tau}_{i, \\text{imp}} = \\mathbf{v}_+ |dE_-| + \\mathbf{v}_- |dE_+|$.\n    - Otherwise, the energy changes monotonically. The tangent is taken as the vector pointing towards the neighbor with the larger magnitude of energy change. If $|dE_+| > |dE_-|$, then $\\mathbf{\\tau}_{i, \\text{imp}} = \\mathbf{R}_{i+1} - \\mathbf{R}_i$. If $|dE_-| > |dE_+|$, then $\\mathbf{\\tau}_{i, \\text{imp}} = \\mathbf{R}_i - \\mathbf{R}_{i-1}$. If $|dE_+| = |dE_-|$, we choose the forward direction by convention.\n    In all cases, the resulting vector $\\mathbf{\\tau}_{i, \\text{imp}}$ is normalized to produce the unit tangent $\\hat{\\tau}_{i, \\text{imp}}$.\n\nOnce the NEB forces $\\mathbf{F}_{i, \\text{naive}}^{\\text{NEB}}$ and $\\mathbf{F}_{i, \\text{improved}}^{\\text{NEB}}$ are computed for all interior images $i \\in \\{1, \\dots, N-2\\}$, we perform a single step of an explicit Euler integration with step size $\\Delta t$:\n$$\n\\mathbf{R}_i^{\\text{new}} = \\mathbf{R}_i + \\Delta t \\, \\mathbf{F}_i^{\\text{NEB}}\n$$\nThis update is performed separately for each tangent definition, generating two new sets of image positions.\n\nFinally, for each of the provided test cases, we must compute and report four aggregate quantities:\n- The sum of the Euclidean norms of the NEB forces for all interior images, using the naive tangent: $\\sum_{i=1}^{N-2} \\|\\mathbf{F}_{i, \\text{naive}}^{\\text{NEB}}\\|$.\n- The same sum, but using the improved tangent: $\\sum_{i=1}^{N-2} \\|\\mathbf{F}_{i, \\text{improved}}^{\\text{NEB}}\\|$.\n- The sum of the Euclidean norms of the image displacements $\\Delta \\mathbf{R}_i = \\mathbf{R}_i^{\\text{new}} - \\mathbf{R}_i$ for the naive tangent: $\\sum_{i=1}^{N-2} \\|\\Delta t \\, \\mathbf{F}_{i, \\text{naive}}^{\\text{NEB}}\\|$.\n- The same sum for the improved tangent: $\\sum_{i=1}^{N-2} \\|\\Delta t \\, \\mathbf{F}_{i, \\text{improved}}^{\\text{NEB}}\\|$.\nNote that the displacement norms are simply $\\Delta t$ times the force norms.\n\nThe algorithm proceeds as follows for each test case:\n1.  Initialize the path of $N$ images via linear interpolation between $\\mathbf{R}_{\\text{start}} = (-0.558, \\; 1.442)$ and $\\mathbf{R}_{\\text{end}} = (0.623, \\; 0.028)$.\n2.  Calculate the potential energy $E_i = V(\\mathbf{R}_i)$ for all images.\n3.  For each interior image $i \\in \\{1, \\dots, N-2\\}$:\n    a. Compute the naive tangent $\\hat{\\tau}_{i, \\text{naive}}$ and the improved tangent $\\hat{\\tau}_{i, \\text{improved}}$.\n    b. Compute the true force $\\mathbf{F}_i = -\\nabla V(\\mathbf{R}_i)$.\n    c. Assemble the NEB forces $\\mathbf{F}_{i, \\text{naive}}^{\\text{NEB}}$ and $\\mathbf{F}_{i, \\text{improved}}^{\\text{NEB}}$ using the respective tangents.\n4.  Sum the norms of the forces and the corresponding displacements over all interior images for both methods.\n5.  Collect the four resulting scalar values for the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Global parameters for the Müller-Brown potential\nA = np.array([-200, -100, -170, 15])\na = np.array([-1, -1, -6.5, 0.7])\nb = np.array([0, 0, 11, 0.6])\nc = np.array([-10, -10, -6.5, 0.7])\nx0 = np.array([1, 0, -0.5, -1])\ny0 = np.array([0, 0.5, 1.5, 1])\n\ndef muller_brown_potential(x, y):\n    \"\"\"Computes the Müller-Brown potential V(x,y).\"\"\"\n    val = 0.0\n    for k in range(4):\n        dx = x - x0[k]\n        dy = y - y0[k]\n        val += A[k] * np.exp(a[k] * dx**2 + b[k] * dx * dy + c[k] * dy**2)\n    return val\n\ndef muller_brown_gradient(x, y):\n    \"\"\"Computes the gradient of the Müller-Brown potential.\"\"\"\n    grad_x = 0.0\n    grad_y = 0.0\n    for k in range(4):\n        dx = x - x0[k]\n        dy = y - y0[k]\n        exp_term = np.exp(a[k] * dx**2 + b[k] * dx * dy + c[k] * dy**2)\n        \n        dEx_dx = 2 * a[k] * dx + b[k] * dy\n        dEx_dy = b[k] * dx + 2 * c[k] * dy\n        \n        grad_x += A[k] * exp_term * dEx_dx\n        grad_y += A[k] * exp_term * dEx_dy\n    return np.array([grad_x, grad_y])\n\ndef normalize(v):\n    \"\"\"Normalizes a vector, handling the zero-vector case.\"\"\"\n    norm = np.linalg.norm(v)\n    if norm  1e-9:  # A small tolerance for floating point comparisons\n        return np.zeros_like(v)\n    return v / norm\n\ndef compute_neb_forces(R_path, k):\n    \"\"\"\n    Computes NEB forces for a given path using both naive and improved tangents.\n    \"\"\"\n    N = len(R_path)\n    energies = np.array([muller_brown_potential(pos[0], pos[1]) for pos in R_path])\n    \n    F_neb_naive = np.zeros_like(R_path)\n    F_neb_improved = np.zeros_like(R_path)\n\n    for i in range(1, N - 1):\n        R_prev, R_curr, R_next = R_path[i-1], R_path[i], R_path[i+1]\n        E_prev, E_curr, E_next = energies[i-1], energies[i], energies[i+1]\n        \n        true_force = -muller_brown_gradient(R_curr[0], R_curr[1])\n\n        # 1. Naive Tangent\n        tau_naive_un = R_next - R_prev\n        if np.linalg.norm(tau_naive_un)  1e-9:\n            # Fallback for degenerate centered difference\n            seg_fwd = R_next - R_curr\n            seg_bwd = R_curr - R_prev\n            if np.linalg.norm(seg_fwd) > np.linalg.norm(seg_bwd):\n                tau_naive_un = seg_fwd\n            else:\n                tau_naive_un = seg_bwd\n        tau_hat_naive = normalize(tau_naive_un)\n\n        # 2. Improved Tangent\n        dE_plus = E_next - E_curr\n        dE_minus = E_prev - E_curr\n        \n        v_fwd = R_next - R_curr\n        v_bwd = R_curr - R_prev\n\n        if dE_plus > 0 and dE_minus > 0: # Valley\n            tau_imp_un = v_fwd * abs(dE_minus) + v_bwd * abs(dE_plus)\n        elif dE_plus  0 and dE_minus  0: # Ridge\n            tau_imp_un = v_fwd * abs(dE_minus) + v_bwd * abs(dE_plus)\n        else: # Monotonic\n            if abs(dE_plus) > abs(dE_minus):\n                tau_imp_un = v_fwd\n            elif abs(dE_minus) > abs(dE_plus):\n                tau_imp_un = v_bwd\n            else: # Equal magnitude change, choose forward\n                tau_imp_un = v_fwd\n        tau_hat_improved = normalize(tau_imp_un)\n        \n        # Assemble forces for both tangent definitions\n        tangents = [tau_hat_naive, tau_hat_improved]\n        force_arrays = [F_neb_naive, F_neb_improved]\n\n        for j in range(2):\n            tau_hat = tangents[j]\n            F_neb_array = force_arrays[j]\n\n            # Perpendicular force component\n            F_perp = true_force - np.dot(true_force, tau_hat) * tau_hat\n            \n            # Spring force component\n            seg_len_plus = np.linalg.norm(v_fwd)\n            seg_len_minus = np.linalg.norm(v_bwd)\n            F_spring = k * (seg_len_plus - seg_len_minus) * tau_hat\n            \n            F_neb_array[i] = F_perp + F_spring\n            \n    return F_neb_naive, F_neb_improved\n\ndef solve():\n    R_start = np.array([-0.558, 1.442])\n    R_end = np.array([0.623, 0.028])\n\n    test_cases = [\n        (9, 1.0, 0.05),\n        (3, 1.0, 0.05),\n        (7, 5.0, 0.10),\n        (11, 0.0, 0.05),\n    ]\n\n    results = []\n    for N, k, dt in test_cases:\n        # 1. Initialize path\n        path = np.linspace(R_start, R_end, N)\n        \n        # 2. Compute NEB forces for both tangent types\n        F_naive, F_improved = compute_neb_forces(path, k)\n        \n        # 3. Calculate result metrics (sums over interior images)\n        interior_forces_naive = F_naive[1:-1]\n        interior_forces_improved = F_improved[1:-1]\n        \n        sum_F_norm_naive = np.sum(np.linalg.norm(interior_forces_naive, axis=1))\n        sum_F_norm_improved = np.sum(np.linalg.norm(interior_forces_improved, axis=1))\n\n        # Displacement is dt * Force, so sum of disp norms is dt * sum of force norms\n        sum_disp_norm_naive = dt * sum_F_norm_naive\n        sum_disp_norm_improved = dt * sum_F_norm_improved\n        \n        results.append([\n            sum_F_norm_naive, \n            sum_F_norm_improved, \n            sum_disp_norm_naive, \n            sum_disp_norm_improved\n        ])\n\n    # Final print statement in the exact required format.\n    # The format specifier ensures consistent output formatting.\n    formatted_results = [f\"[{','.join(f'{x:.7f}' for x in case_res)}]\" for case_res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "An NEB calculation converges to a chain of images representing an approximate minimum energy path, with the highest-energy image serving as a candidate for the transition state. However, this identification must be rigorously verified. This final practice  walks you through the essential post-processing step of numerically computing the Hessian matrix at the candidate saddle point and confirming it meets the strict mathematical criterion for a true transition state: having exactly one negative eigenvalue.",
            "id": "3789297",
            "problem": "You are given a dimensionless potential energy landscape in two spatial dimensions specified by functions $E(\\mathbf{x})$ with $\\mathbf{x} \\in \\mathbb{R}^2$, together with three discrete paths that pass through a candidate saddle image obtained via Nudged Elastic Band (NEB) method. Your task is to numerically construct the full Hessian matrix at the central image of each path, classify the saddle by the single negative eigenvalue criterion, and quantify the orientation of the most unstable mode relative to the NEB path tangent.\n\nFoundational base to use:\n- The Hessian of a scalar field $E(\\mathbf{x})$ at $\\mathbf{x}^\\star$ is the matrix of second-order partial derivatives defined by $H_{ij}(\\mathbf{x}^\\star) = \\frac{\\partial^2 E}{\\partial x_i \\partial x_j}(\\mathbf{x}^\\star)$.\n- The eigenvalues $\\lambda_k$ and eigenvectors $\\mathbf{v}_k$ of a symmetric Hessian satisfy $H \\mathbf{v}_k = \\lambda_k \\mathbf{v}_k$ with orthonormal $\\{\\mathbf{v}_k\\}$.\n- A transition state in atomistic modeling is an index-$1$ saddle, meaning exactly one strictly negative eigenvalue of the Hessian.\n- The NEB path tangent at an image indexed by $m$ in a discrete path $\\{\\mathbf{x}_0,\\mathbf{x}_1,\\mathbf{x}_2\\}$ is approximated by the normalized difference $\\mathbf{t} = \\frac{\\mathbf{x}_{m+1} - \\mathbf{x}_{m-1}}{\\|\\mathbf{x}_{m+1} - \\mathbf{x}_{m-1}\\|}$.\n\nYou must implement a symmetric central finite difference approximation for partial derivatives with a uniform step size $h$ to evaluate the Hessian numerically. Use a negativity tolerance $\\tau$ to classify eigenvalues: count an eigenvalue $\\lambda$ as negative if $\\lambda  -\\tau$, positive if $\\lambda > \\tau$, and otherwise treat it as numerically zero. Report the angle between the most negative-eigenvalue eigenvector and the NEB tangent in radians, and report the signed parallel component and the perpendicular component norm of that eigenvector with respect to the tangent. The angle should be computed between directions (ignoring overall sign), i.e., use the absolute value of the dot product in the cosine, and express the angle in radians.\n\nTest suite:\n- Case $1$ (happy path): $E_1(x_1,x_2) = (x_1^2 - 1)^2 + 0.5\\,x_2^2$. Discrete path images are $\\mathbf{x}_0 = (-1,0)$, $\\mathbf{x}_1 = (0,0)$, and $\\mathbf{x}_2 = (1,0)$. Use $h = 10^{-4}$ and $\\tau = 10^{-8}$.\n- Case $2$ (non-transition-state maximum): $E_2(x_1,x_2) = -x_1^2 - x_2^2 + 0.1\\,(x_1^4 + x_2^4)$. Discrete path images are $\\mathbf{x}_0 = (-0.1,0)$, $\\mathbf{x}_1 = (0,0)$, and $\\mathbf{x}_2 = (0.1,0)$. Use $h = 10^{-4}$ and $\\tau = 10^{-8}$.\n- Case $3$ (near-degenerate flat direction): $E_3(x_1,x_2) = (x_1^2 - 1)^2 + \\epsilon\\,x_2^4$ with $\\epsilon = 10^{-6}$. Discrete path images are $\\mathbf{x}_0 = (-1,0)$, $\\mathbf{x}_1 = (0,0)$, and $\\mathbf{x}_2 = (1,0)$. Use $h = 10^{-4}$ and $\\tau = 10^{-8}$.\n\nFor each case, at the central image $\\mathbf{x}_1$, perform the following:\n- Numerically compute the full Hessian $H(\\mathbf{x}_1)$ using symmetric central finite differences with step size $h$.\n- Compute all eigenvalues and eigenvectors of $H(\\mathbf{x}_1)$.\n- Verify the single negative eigenvalue criterion using $\\tau$ and return a boolean indicating whether the criterion holds.\n- Compute the NEB tangent $\\mathbf{t}$ at $\\mathbf{x}_1$ from the given neighboring images and normalize it.\n- Select the eigenvector $\\mathbf{v}_{\\min}$ corresponding to the most negative eigenvalue (i.e., the smallest eigenvalue). Compute the angle $\\theta$ between directions spanned by $\\mathbf{v}_{\\min}$ and $\\mathbf{t}$ in radians, the signed parallel component $c_{\\parallel} = \\mathbf{v}_{\\min} \\cdot \\mathbf{t}$, and the perpendicular component norm $c_{\\perp} = \\|\\mathbf{v}_{\\min} - c_{\\parallel}\\,\\mathbf{t}\\|$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one case in order. Each case’s result must be a list structured as $[\\text{boolean}, \\theta, c_{\\parallel}, c_{\\perp}]$, where the angle $\\theta$ is in radians.\n- Example format: `[[True, 0.123, 0.456, 0.789],[False, 0.321, -0.654, 0.987],[True, 0.000, 1.000, 0.000]]`.\n\nAll quantities are dimensionless; express angles in radians. No external input is required; hard-code the test suite in your program exactly as specified above.",
            "solution": "The problem requires an analysis of candidate saddle points on two-dimensional potential energy surfaces, obtained from a Nudged Elastic Band (NEB) calculation. For each of three given cases, we must characterize the stationary point at the central image, $\\mathbf{x}_1$, of a discrete path $\\{\\mathbf{x}_0, \\mathbf{x}_1, \\mathbf{x}_2\\}$. This characterization involves computing the Hessian matrix, analyzing its eigenvalues to determine if the point is an index-$1$ saddle (a transition state), and quantifying the alignment of the unstable mode with the reaction path tangent.\n\nThe procedure for each case is as follows:\n\n1.  **Numerical Computation of the Hessian Matrix**\n\nThe Hessian matrix, $H$, of a scalar potential energy function $E(\\mathbf{x})$ where $\\mathbf{x} = (x_1, x_2)$, is a $2 \\times 2$ matrix of second-order partial derivatives:\n$$\nH(\\mathbf{x}) = \\begin{pmatrix}\n\\frac{\\partial^2 E}{\\partial x_1^2}  \\frac{\\partial^2 E}{\\partial x_1 \\partial x_2} \\\\\n\\frac{\\partial^2 E}{\\partial x_2 \\partial x_1}  \\frac{\\partial^2 E}{\\partial x_2^2}\n\\end{pmatrix}\n$$\nSince potential energy functions are continuously differentiable, the Hessian is symmetric, i.e., $\\frac{\\partial^2 E}{\\partial x_1 \\partial x_2} = \\frac{\\partial^2 E}{\\partial x_2 \\partial x_1}$. We are tasked to compute this matrix at the central image $\\mathbf{x}_1 = (x_{1,1}, x_{2,1})$ using a symmetric central finite difference scheme with a step size $h$. The formulas for the components are:\n\n-   Diagonal elements:\n    $$\n    H_{11} = \\frac{\\partial^2 E}{\\partial x_1^2} \\approx \\frac{E(x_{1,1}+h, x_{2,1}) - 2E(x_{1,1}, x_{2,1}) + E(x_{1,1}-h, x_{2,1})}{h^2}\n    $$\n    $$\n    H_{22} = \\frac{\\partial^2 E}{\\partial x_2^2} \\approx \\frac{E(x_{1,1}, x_{2,1}+h) - 2E(x_{1,1}, x_{2,1}) + E(x_{1,1}, x_{2,1}-h)}{h^2}\n    $$\n-   Off-diagonal element:\n    $$\n    H_{12} = H_{21} = \\frac{\\partial^2 E}{\\partial x_1 \\partial x_2} \\approx \\frac{E(x_{1,1}+h, x_{2,1}+h) - E(x_{1,1}+h, x_{2,1}-h) - E(x_{1,1}-h, x_{2,1}+h) + E(x_{1,1}-h, x_{2,1}-h)}{4h^2}\n    $$\nThese approximations are applied to the specific energy function $E(x_1, x_2)$ for each test case at the point $\\mathbf{x}_1$.\n\n2.  **Eigenvalue Analysis and Saddle Point Classification**\n\nOnce the numerical Hessian matrix $H(\\mathbf{x}_1)$ is constructed, we solve the eigenvalue problem $H \\mathbf{v}_k = \\lambda_k \\mathbf{v}_k$ to find its eigenvalues $\\lambda_k$ and corresponding eigenvectors $\\mathbf{v}_k$. For a symmetric $2 \\times 2$ Hessian, we will obtain two real eigenvalues, $\\lambda_1$ and $\\lambda_2$.\n\nA transition state (or index-$1$ saddle point) is characterized by having exactly one negative eigenvalue. We use the provided negativity tolerance $\\tau$ to perform this classification. An eigenvalue $\\lambda$ is counted as negative if and only if $\\lambda  -\\tau$. We count the number of such negative eigenvalues. If this count is exactly one, the point $\\mathbf{x}_1$ is classified as a transition state.\n\n3.  **Unstable Mode and Path Tangent Analysis**\n\nIf the point is a saddle, the eigenvector corresponding to the single negative eigenvalue represents the direction of the \"unstable mode\"—the direction of lowest energy barrier leading away from the saddle point. We denote this eigenvector as $\\mathbf{v}_{\\min}$.\n\nThe NEB path tangent at the central image $\\mathbf{x}_1$ provides an approximation of the reaction path direction. It is calculated using the neighboring images $\\mathbf{x}_0$ and $\\mathbf{x}_2$:\n$$\n\\mathbf{t} = \\frac{\\mathbf{x}_2 - \\mathbf{x}_0}{\\|\\mathbf{x}_2 - \\mathbf{x}_0\\|}\n$$\nThe tangent vector $\\mathbf{t}$ is normalized to be a unit vector.\n\nFinally, we quantify the relationship between the unstable mode $\\mathbf{v}_{\\min}$ and the path tangent $\\mathbf{t}$. Both $\\mathbf{v}_{\\min}$ (as returned by standard eigensolvers) and $\\mathbf{t}$ are unit vectors.\n\n-   **Angle $\\theta$**: The angle between the directions of the two vectors is computed. To ensure the angle is between $0$ and $\\pi/2$ radians (i.e., we compare directions, not specific vectors which have arbitrary signs), we use the absolute value of the dot product:\n    $$\n    \\theta = \\arccos(|\\mathbf{v}_{\\min} \\cdot \\mathbf{t}|)\n    $$\n-   **Signed Parallel Component $c_{\\parallel}$**: This measures the projection of $\\mathbf{v}_{\\min}$ onto $\\mathbf{t}$. Since $\\mathbf{t}$ is a unit vector, this is simply the dot product:\n    $$\n    c_{\\parallel} = \\mathbf{v}_{\\min} \\cdot \\mathbf{t}\n    $$\n    The sign of $c_{\\parallel}$ depends on the arbitrary sign convention of the eigenvector returned by the numerical solver.\n-   **Perpendicular Component Norm $c_{\\perp}$**: This measures the magnitude of the component of $\\mathbf{v}_{\\min}$ that is orthogonal to the tangent $\\mathbf{t}$. It is calculated as the norm of the vector difference:\n    $$\n    c_{\\perp} = \\|\\mathbf{v}_{\\min} - c_{\\parallel} \\mathbf{t}\\|\n    $$\nBy applying this full procedure to each of the three test cases, we can verify the nature of the candidate saddle points and the quality of the NEB path alignment.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by analyzing candidate saddle points for three test cases.\n    \"\"\"\n\n    def compute_hessian(E, x, h):\n        \"\"\"\n        Computes the Hessian matrix of a 2D scalar function E at point x\n        using symmetric central finite differences with step size h.\n        \"\"\"\n        x1, x2 = x\n        \n        # Second derivative with respect to x1\n        H11 = (E(x1 + h, x2) - 2 * E(x1, x2) + E(x1 - h, x2)) / (h**2)\n        \n        # Second derivative with respect to x2\n        H22 = (E(x1, x2 + h) - 2 * E(x1, x2) + E(x1, x2 - h)) / (h**2)\n        \n        # Mixed partial derivative\n        H12 = (E(x1 + h, x2 + h) - E(x1 + h, x2 - h) - E(x1 - h, x2 + h) + E(x1 - h, x2 - h)) / (4 * h**2)\n        \n        # Hessian is symmetric, H21 = H12\n        return np.array([[H11, H12], [H12, H22]])\n\n    def analyze_saddle(E, path, h, tau):\n        \"\"\"\n        Performs the full analysis for a given potential and path.\n        \"\"\"\n        x0, x1, x2 = path\n        \n        # 1. Compute the Hessian at the central image x1\n        H = compute_hessian(E, x1, h)\n        \n        # 2. Compute eigenvalues and eigenvectors.\n        # numpy.linalg.eigh is used for symmetric matrices. It returns eigenvalues\n        # in ascending order and corresponding eigenvectors as columns.\n        eigenvalues, eigenvectors = np.linalg.eigh(H)\n        \n        # 3. Verify the single negative eigenvalue criterion\n        num_negative_eigenvalues = np.sum(eigenvalues  -tau)\n        is_transition_state = (num_negative_eigenvalues == 1)\n        \n        # 4. Compute the NEB tangent at x1\n        tangent_raw = x2 - x0\n        tangent = tangent_raw / np.linalg.norm(tangent_raw)\n        \n        # 5. Select the eigenvector for the most negative eigenvalue\n        # This corresponds to the first eigenvalue/eigenvector from eigh.\n        v_min = eigenvectors[:, 0]\n        \n        # 6. Compute angle, parallel, and perpendicular components\n        # Angle between directions (using abs of dot product)\n        dot_product = np.dot(v_min, tangent)\n        \n        # Handle potential floating point inaccuracies for arccos\n        # Clamp the argument to the valid range [-1, 1]\n        angle_arg = np.clip(np.abs(dot_product), -1.0, 1.0)\n        theta = np.arccos(angle_arg)\n        \n        # Signed parallel component\n        c_parallel = dot_product\n        \n        # Perpendicular component norm\n        c_perpendicular = np.linalg.norm(v_min - c_parallel * tangent)\n        \n        return [is_transition_state, theta, c_parallel, c_perpendicular]\n\n    # Test suite parameters\n    h = 1e-4\n    tau = 1e-8\n    \n    test_cases = [\n        {\n            \"E\": lambda x1, x2: (x1**2 - 1)**2 + 0.5 * x2**2,\n            \"path\": (np.array([-1.0, 0.0]), np.array([0.0, 0.0]), np.array([1.0, 0.0])),\n        },\n        {\n            \"E\": lambda x1, x2: -x1**2 - x2**2 + 0.1 * (x1**4 + x2**4),\n            \"path\": (np.array([-0.1, 0.0]), np.array([0.0, 0.0]), np.array([0.1, 0.0])),\n        },\n        {\n            \"E\": lambda x1, x2: (x1**2 - 1)**2 + 1e-6 * x2**4,\n            \"path\": (np.array([-1.0, 0.0]), np.array([0.0, 0.0]), np.array([1.0, 0.0])),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_saddle(case[\"E\"], case[\"path\"], h, tau)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The str() of a list automatically includes brackets and commas.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}