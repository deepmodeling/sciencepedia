{
    "hands_on_practices": [
        {
            "introduction": "细致平衡原则是确保动力学蒙特卡洛（KMC）模拟能够正确抽样平衡态玻尔兹曼分布的基石。对于旨在模拟系统趋向热力学平衡过程的KMC模型，其设定的动力学速率必须与系统的能量形貌保持一致。本练习提供了一个具体案例，用于检验一组给定的动力学速率是否满足细致平衡条件，并在不满足时学习如何进行调整，从而保证模拟的物理真实性 。",
            "id": "3818697",
            "problem": "考虑一个由动力学蒙特卡洛 (Kinetic Monte Carlo, KMC) 建模的双态晶格位点系统，其中状态 $1$ 和状态 $2$ 的位点能量分别为 $E_1=0\\ \\mathrm{eV}$ 和 $E_2=0.1\\ \\mathrm{eV}$。状态之间的跃迁是热激活的，并遵循过渡态理论 (Transition State Theory, TST)，具有一个共同的尝试频率 $\\nu_0$（两个方向相同）。假设跃迁的活化能垒（活化自由能）对于 $1 \\to 2$ 为 $E^{\\ddagger}_{12}=0.6\\ \\mathrm{eV}$，对于 $2 \\to 1$ 为 $E^{\\ddagger}_{21}=0.5\\ \\mathrm{eV}$。该系统与一个温度为 $T=500\\ \\mathrm{K}$ 的热浴耦合。\n\n基于以下基本原理：(i) 根据过渡态理论，KMC 速率采用阿伦尼乌斯形式 $r_{ij}=\\nu_0 \\exp(-E^{\\ddagger}_{ij}/(k_B T))$，以及 (ii) 热力学平衡占据数由玻尔兹曼分布 $\\pi_i \\propto \\exp(-E_i/(k_B T))$ 给出，请确定在给定温度下细致平衡是否成立。如果不成立，请在保持正向和反向能垒的算术平均值不变这一物理上合理的约束下，通过对动力学进行最小微扰来强制实现细致平衡，即施加 $(E^{\\ddagger\\prime}_{12}+E^{\\ddagger\\prime}_{21})/2=(E^{\\ddagger}_{12}+E^{\\ddagger}_{21})/2$，同时确保在温度 $T$ 下的细致平衡。如果细致平衡已经成立，请报告采用同样强制执行程序将产生的能垒。\n\n将最终调整后的能垒以有序对 $(E^{\\ddagger\\prime}_{12}, E^{\\ddagger\\prime}_{21})$ 的形式表示，单位为 $\\mathrm{eV}$。不要对答案进行四舍五入。",
            "solution": "该问题要求评估一个给定的双态动力学系统是否满足细致平衡原理，如果不满足，则在特定约束下强制实现它。如果系统已经满足细致平衡，我们仍必须应用该强制执行程序来确定最终的动力学参数。\n\n已知条件如下：\n- 状态1的位点能量：$E_1 = 0 \\text{ eV}$\n- 状态2的位点能量：$E_2 = 0.1 \\text{ eV}$\n- 跃迁 $1 \\to 2$ 的活化能垒：$E^{\\ddagger}_{12} = 0.6 \\text{ eV}$\n- 跃迁 $2 \\to 1$ 的活化能垒：$E^{\\ddagger}_{21} = 0.5 \\text{ eV}$\n- 系统温度：$T = 500 \\text{ K}$\n- 共同的尝试频率：$\\nu_0$\n- 速率表达式由阿伦尼乌斯形式给出：$r_{ij} = \\nu_0 \\exp(-E^{\\ddagger}_{ij} / (k_B T))$\n- 状态 $i$ 的平衡占据数由玻尔兹曼分布给出：$\\pi_i \\propto \\exp(-E_i / (k_B T))$\n- 能垒调整的约束条件是，新能垒的算术平均值必须等于旧能垒的算术平均值：$(E^{\\ddagger\\prime}_{12} + E^{\\ddagger\\prime}_{21})/2 = (E^{\\ddagger}_{12} + E^{\\ddagger}_{21})/2$。\n\n细致平衡原理要求，在热力学平衡状态下，任意两个状态之间的正向跃迁流通量等于反向跃迁流通量。对于我们的双态系统，这表示为：\n$$ \\pi_1 r_{12} = \\pi_2 r_{21} $$\n平衡占据数 $\\pi_1$ 和 $\\pi_2$ 由玻尔兹曼分布给出：\n$$ \\pi_1 = \\frac{\\exp(-E_1 / (k_B T))}{Z} $$\n$$ \\pi_2 = \\frac{\\exp(-E_2 / (k_B T))}{Z} $$\n其中 $Z$ 是配分函数 $Z = \\exp(-E_1 / (k_B T)) + \\exp(-E_2 / (k_B T))$。跃迁速率 $r_{12}$ 和 $r_{21}$ 由阿伦尼乌斯方程给出：\n$$ r_{12} = \\nu_0 \\exp\\left(-\\frac{E^{\\ddagger}_{12}}{k_B T}\\right) $$\n$$ r_{21} = \\nu_0 \\exp\\left(-\\frac{E^{\\ddagger}_{21}}{k_B T}\\right) $$\n将这些表达式代入细致平衡条件：\n$$ \\frac{\\exp(-E_1 / (k_B T))}{Z} \\nu_0 \\exp\\left(-\\frac{E^{\\ddagger}_{12}}{k_B T}\\right) = \\frac{\\exp(-E_2 / (k_B T))}{Z} \\nu_0 \\exp\\left(-\\frac{E^{\\ddagger}_{21}}{k_B T}\\right) $$\n我们可以消去两边共同的项 $\\nu_0$ 和 $Z$：\n$$ \\exp\\left(-\\frac{E_1 + E^{\\ddagger}_{12}}{k_B T}\\right) = \\exp\\left(-\\frac{E_2 + E^{\\ddagger}_{21}}{k_B T}\\right) $$\n对两边取自然对数，得到关于能量的条件：\n$$ E_1 + E^{\\ddagger}_{12} = E_2 + E^{\\ddagger}_{21} $$\n这可以重排成一个更常见的形式，将活化能垒的差异与位点能量的差异联系起来：\n$$ E^{\\ddagger}_{12} - E^{\\ddagger}_{21} = E_2 - E_1 $$\n这是动力学参数（能垒）与热力学参数（位点能量）保持一致的基本要求。请注意，此条件与温度 $T$ 无关。\n\n现在，我们检查给定的参数是否满足此条件。\n活化能垒的差异是：\n$$ E^{\\ddagger}_{12} - E^{\\ddagger}_{21} = 0.6\\ \\mathrm{eV} - 0.5\\ \\mathrm{eV} = 0.1\\ \\mathrm{eV} $$\n位点能量的差异是：\n$$ E_2 - E_1 = 0.1\\ \\mathrm{eV} - 0\\ \\mathrm{eV} = 0.1\\ \\mathrm{eV} $$\n由于 $0.1\\ \\mathrm{eV} = 0.1\\ \\mathrm{eV}$，给定的动力学参数已与热力学一致，因此系统满足细致平衡。\n\n无论如何，问题要求我们继续执行指定的强制程序。我们必须找到满足两个条件的新能垒，记为 $E^{\\ddagger\\prime}_{12}$ 和 $E^{\\ddagger\\prime}_{21}$。\n条件1：新能垒必须满足细致平衡。\n$$ E^{\\ddagger\\prime}_{12} - E^{\\ddagger\\prime}_{21} = E_2 - E_1 = 0.1\\ \\mathrm{eV} $$\n条件2：新能垒的算术平均值必须保持不变。\n$$ \\frac{E^{\\ddagger\\prime}_{12} + E^{\\ddagger\\prime}_{21}}{2} = \\frac{E^{\\ddagger}_{12} + E^{\\ddagger}_{21}}{2} $$\n这可以简化为：\n$$ E^{\\ddagger\\prime}_{12} + E^{\\ddagger\\prime}_{21} = E^{\\ddagger}_{12} + E^{\\ddagger}_{21} = 0.6\\ \\mathrm{eV} + 0.5\\ \\mathrm{eV} = 1.1\\ \\mathrm{eV} $$\n我们现在有一个包含两个未知数 $E^{\\ddagger\\prime}_{12}$ 和 $E^{\\ddagger\\prime}_{21}$ 的二元一次方程组：\n1. $E^{\\ddagger\\prime}_{12} - E^{\\ddagger\\prime}_{21} = 0.1$\n2. $E^{\\ddagger\\prime}_{12} + E^{\\ddagger\\prime}_{21} = 1.1$\n\n为了求解 $E^{\\ddagger\\prime}_{12}$，我们将两个方程相加：\n$$ (E^{\\ddagger\\prime}_{12} - E^{\\ddagger\\prime}_{21}) + (E^{\\ddagger\\prime}_{12} + E^{\\ddagger\\prime}_{21}) = 0.1 + 1.1 $$\n$$ 2E^{\\ddagger\\prime}_{12} = 1.2 $$\n$$ E^{\\ddagger\\prime}_{12} = 0.6\\ \\mathrm{eV} $$\n为了求解 $E^{\\ddagger\\prime}_{21}$，我们将 $E^{\\ddagger\\prime}_{12}$ 的值代入第二个方程：\n$$ 0.6 + E^{\\ddagger\\prime}_{21} = 1.1 $$\n$$ E^{\\ddagger\\prime}_{21} = 1.1 - 0.6 = 0.5\\ \\mathrm{eV} $$\n调整后的能垒是 $(E^{\\ddagger\\prime}_{12}, E^{\\ddagger\\prime}_{21}) = (0.6\\ \\mathrm{eV}, 0.5\\ \\mathrm{eV})$。正如预期的那样，由于原始能垒已经满足细致平衡，强制执行程序得出的结果是原始能垒。\n最终答案是调整后能垒的有序对。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.6 & 0.5 \\end{pmatrix} } $$"
        },
        {
            "introduction": "高效的动力学蒙特卡洛模拟依赖于一种快速算法来选择接下来发生的事件，尤其是在存在大量可能性时。简单的线性搜索算法的时间复杂度为 $O(N)$，在事件数量 $N$ 很大时效率低下。本练习将引导你实践二叉树搜索算法，这是一种精妙的 $O(\\log N)$ 算法，它通过构建部分和树结构，显著提升了事件选择的效率，是高性能KMC代码的基石之一 。",
            "id": "3818725",
            "problem": "考虑一个针对晶体缺陷的动力学蒙特卡洛（KMC）模拟，该缺陷服从连续时间马尔可夫链（CTMC），并且可以经历四个互斥的基本事件，索引为 $i \\in \\{1,2,3,4\\}$。每个事件 $i$ 都有一个瞬时速率 $k_{i}$，该过程是无记忆的，其等待时间服从由总风险率决定的指数分布。各事件速率分别为 $k_{1} = 0.1$、$k_{2} = 0.4$、$k_{3} = 0.2$ 和 $k_{4} = 0.3$，单位均为一致的物理单位。从 CTMC 的基本风险率解释出发，即总速率为 $R = \\sum_{i=1}^{4} k_{i}$，并且在跃迁时的事件选择由概率为 $p_{i} = k_{i}/R$ 的分类分布决定，请推导出一个 $O(\\log N)$ 的事件选择过程。该过程使用一个部分和二叉树，其叶节点按给定顺序为速率 $\\{k_{1},k_{2},k_{3},k_{4}\\}$。该过程必须从一个均匀随机变量 $u \\in (0,1)$ 开始，并正确实现由这些速率所蕴含的分类分布。请显式地构建这个部分和二叉树，并演示对于一个特定的实现值 $u = 0.73$ 的选择路径。\n\n你的最终答案必须是对于 $u = 0.73$ 所选事件的索引 $i \\in \\{1,2,3,4\\}$。无需四舍五入。最终答案只提供该索引。",
            "solution": "动力学蒙特卡洛（KMC）模拟连续时间马尔可夫链（CTMC）的核心包括两个步骤：确定时间增量和选择发生的事件。本问题关注第二步：事件选择。选择事件 $i$ 的概率 $p_i$ 与其速率 $k_i$ 成正比。具体来说，$p_i = k_i / R$，其中 $R$ 是所有可能事件的总速率。\n\n选择过程可以通过生成一个均匀随机数 $u \\in (0,1)$ 来执行，然后选择事件 $j$，使得缩放后的随机数 $r = u \\cdot R$ 落在一个划分轴的第 $j$ 个区间内，其中每个区间的长度等于速率 $k_i$。也就是说，需要找到满足以下条件的索引 $j$：\n$$\n\\sum_{i=1}^{j-1} k_i  r \\le \\sum_{i=1}^{j} k_i\n$$\n线性搜索找到 $j$ 需要 $O(N)$ 的时间，其中 $N$ 是事件的数量。本问题要求一个 $O(\\log N)$ 的过程，这可以通过一个部分和二叉树来实现。\n\n首先，我们计算总速率 $R$：\n$$\nR = \\sum_{i=1}^{4} k_i = k_1 + k_2 + k_3 + k_4 = 0.1 + 0.4 + 0.2 + 0.3 = 1.0\n$$\n\n接下来，我们构建部分和二叉树。树的叶节点是各个速率 $k_i$。每个父节点存储其子节点速率的总和。\n-   **第0层（叶节点）：** 速率按指定顺序排列：\n    $L_1 = k_1 = 0.1$\n    $L_2 = k_2 = 0.4$\n    $L_3 = k_3 = 0.2$\n    $L_4 = k_4 = 0.3$\n\n-   **第1层（内部节点）：** 我们对相邻的叶节点对求和。我们将这些节点称为 $N_{12}$ 和 $N_{34}$。\n    $N_{12} = L_1 + L_2 = k_1 + k_2 = 0.1 + 0.4 = 0.5$\n    $N_{34} = L_3 + L_4 = k_3 + k_4 = 0.2 + 0.3 = 0.5$\n\n-   **第2层（根节点）：** 根节点是第1层节点的和。\n    $N_{root} = N_{12} + N_{34} = 0.5 + 0.5 = 1.0$。正如预期的那样，这就是总速率 $R$。\n\n生成的树的结构如下：\n-   根节点：存储值 $1.0$。\n    -   左子节点 ($N_{12}$): 存储值 $0.5$。\n        -   左子节点 ($L_1$): 存储速率 $k_1 = 0.1$。\n        -   右子节点 ($L_2$): 存储速率 $k_2 = 0.4$。\n    -   右子节点 ($N_{34}$): 存储值 $0.5$。\n        -   左子节点 ($L_3$): 存储速率 $k_3 = 0.2$。\n        -   右子节点 ($L_4$): 存储速率 $k_4 = 0.3$。\n\n现在我们为给定的均匀随机数 $u = 0.73$ 演示选择过程。\n搜索的目标值为 $r = u \\cdot R = 0.73 \\cdot 1.0 = 0.73$。\n\n搜索算法按以下步骤进行：\n1.  **从根节点开始（值为 $1.0$）。**\n    -   将目标值 $r = 0.73$ 与左子节点 $N_{12}$ 的值 $0.5$ 进行比较。\n    -   由于 $r > 0.5$，我们遍历到右子节点 $N_{34}$。\n    -   在遍历之前，我们必须通过减去跳过的左分支的值来更新目标值：$r' = r - 0.5 = 0.73 - 0.5 = 0.23$。\n\n2.  **在节点 $N_{34}$ 处（值为 $0.5$）。**\n    -   当前目标值为 $r' = 0.23$。\n    -   将 $r'$ 与该节点的左子节点 $L_3$ 的值 $k_3 = 0.2$ 进行比较。\n    -   由于 $r' > 0.2$，我们遍历到右子节点 $L_4$。\n    -   再次，我们通过减去左分支的值来更新目标值：$r'' = r' - 0.2 = 0.23 - 0.2 = 0.03$。\n\n3.  **在叶节点 $L_4$ 处。**\n    -   我们已经到达一个叶节点。搜索终止。此叶节点的索引对应于所选事件。\n    -   该叶节点是 $L_4$，对应于速率 $k_4$。因此，所选事件是事件4。\n\n最终选择的事件索引为 $i=4$。此结果与线性搜索一致。累积速率为 $C_1 = 0.1$、$C_2 = 0.5$、$C_3 = 0.7$ 和 $C_4 = 1.0$。目标值 $r = 0.73$ 落在区间 $(C_3, C_4]$ 内，该区间对应事件4。二叉树搜索已正确且高效地识别了该事件。",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "在运行KMC模拟之后，一个至关重要的步骤是分析输出数据，以验证模型假设并提取物理参数。对于一个具有恒定总速率的稳态KMC过程，事件之间的等待时间理论上应服从指数分布。本实践练习模拟了这一常见的后处理任务，指导你如何对KMC生成的轨迹数据应用统计方法，例如使用柯尔莫哥洛夫-斯米尔诺夫检验来验证等待时间的指数性，并运用最大似然估计来推算系统的总事件速率 。",
            "id": "3818695",
            "problem": "给定来自一个平稳过程的三个独立的动力学蒙特卡洛轨迹，其中总事件速率假定为常数。在一个平稳的动力学蒙特卡洛设置中，下一事件的等待时间是独立同分布的，服从由恒定总速率参数化的指数分布。目标是使用单样本柯尔莫哥洛夫-斯米尔诺夫统计量对每个轨迹的指数性假设进行检验，并使用最大似然法估计该恒定速率。\n\n从“具有恒定总速率的平稳过程具有独立的等待时间”以及“指数分布是唯一具有无记忆性的连续分布”这两个定义出发，对每个轨迹执行以下操作：\n- 假设等待时间是一个具有未知速率参数的指数模型的独立同分布实现。仅使用独立样本的基本似然定义，推导并计算速率参数的最大似然估计。\n- 使用估计的速率定义指数分布的经验累积分布函数和模型累积分布函数，并将单样本柯尔莫哥洛夫-斯米尔诺夫统计量计算为这两个累积分布函数在所有时间上的绝对差的上确界。\n- 使用经典的柯尔莫哥洛夫分布尾部表达式计算渐近的单样本柯尔莫哥洛夫-斯米尔诺夫 p 值。使用决策规则“如果 $p  \\alpha$ 则拒绝”，其中 $\\alpha$ 是给定的显著性水平。\n\n物理单位和报告要求：\n- 等待时间以秒为单位提供。速率必须以秒的倒数 $s^{-1}$ 报告。柯尔莫哥洛夫-斯米尔诺夫统计量和 p 值是无量纲的。\n- 对于每个轨迹，返回一个列表，其中包含以 $s^{-1}$ 为单位的估计速率（浮点数）、柯尔莫哥洛夫-斯米尔诺夫统计量（浮点数）以及一个布尔值用于决策，其中 $\\text{True}$ 表示“拒绝指数性”，$\\text{False}$ 表示“不拒绝”。所有浮点数均以十进制形式表示。\n\n测试套件（每个轨迹是一个以秒为单位的等待时间列表，后跟一个显著性水平 $\\alpha$）：\n1. 轨迹 A，有 $n = 25$ 个等待时间，$\\alpha = 0.05$：$\\{0.12, 0.03, 0.41, 0.25, 0.02, 0.10, 0.33, 0.06, 0.09, 0.15, 0.22, 0.13, 0.19, 0.07, 0.28, 0.05, 0.11, 0.16, 0.08, 0.21, 0.18, 0.14, 0.04, 0.24, 0.12\\}$ 和 $\\alpha = 0.05$。\n2. 轨迹 B，有 $n = 15$ 个等待时间，$\\alpha = 0.05$：$\\{0.01, 0.02, 0.03, 0.02, 0.04, 0.50, 0.40, 0.60, 0.55, 0.45, 0.52, 0.48, 0.51, 0.49, 0.53\\}$ 和 $\\alpha = 0.05$。\n3. 轨迹 C，有 $n = 5$ 个等待时间，$\\alpha = 0.01$：$\\{0.20, 0.05, 0.10, 0.15, 0.08\\}$ 和 $\\alpha = 0.01$。\n\n您的程序必须生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个轨迹的结果本身必须是按 $\\left[\\hat{\\lambda}, D, \\text{decision}\\right]$ 顺序排列并用方括号括起来的逗号分隔列表，其中 $\\hat{\\lambda}$ 是以 $s^{-1}$ 为单位的最大似然速率估计值，$D$ 是柯尔莫哥洛夫-斯米尔诺夫统计量，$\\text{decision}$ 是一个布尔值。例如，您的输出必须类似于：$\\left[[\\hat{\\lambda}_A, D_A, \\text{decision}_A],[\\hat{\\lambda}_B, D_B, \\text{decision}_B],[\\hat{\\lambda}_C, D_C, \\text{decision}_C]\\right]$。",
            "solution": "动力学蒙特卡洛的背景提供了物理基础：对于一个具有恒定总事件速率的平稳过程，到下一个事件的等待时间独立于过去，且风险率是恒定的。指数分布由无记忆性唯一表征：对于等待时间随机变量 $T$，性质 $\\mathbb{P}(T > s + t \\mid T > s) = \\mathbb{P}(T > t)$（对于所有 $s, t \\ge 0$）意味着 $T$ 的分布是具有某个速率参数 $\\lambda > 0$ 的指数分布。在动力学蒙特卡洛中，当总速率 $r_{\\mathrm{tot}}$ 恒定时，我们认定 $\\lambda = r_{\\mathrm{tot}}$，并且等待时间是从具有概率密度函数 $f_T(t) = \\lambda e^{-\\lambda t}$（对于 $t \\ge 0$）的指数分布中抽取的独立同分布（i.i.d.）样本。\n\n指数速率的最大似然估计：\n- 设 $\\{t_i\\}_{i=1}^n$ 表示一个轨迹的观测等待时间，假定其为来自未知速率为 $\\lambda$ 的指数分布的独立同分布样本。利用独立性和密度定义，样本的联合似然函数为\n$$\nL(\\lambda; t_1, \\dots, t_n) = \\prod_{i=1}^n \\lambda e^{-\\lambda t_i} = \\lambda^n \\exp\\left(-\\lambda \\sum_{i=1}^n t_i\\right).\n$$\n- 对数似然函数为\n$$\n\\ell(\\lambda) = \\log L(\\lambda) = n \\log \\lambda - \\lambda \\sum_{i=1}^n t_i.\n$$\n- 对 $\\lambda$ 求导并将导数设为零，得到\n$$\n\\frac{d\\ell}{d\\lambda} = \\frac{n}{\\lambda} - \\sum_{i=1}^n t_i = 0 \\quad \\Rightarrow \\quad \\hat{\\lambda} = \\frac{n}{\\sum_{i=1}^n t_i}.\n$$\n- 二阶导数为 $-\\frac{n}{\\lambda^2}  0$，证实了这是一个最大值。因此，速率的最大似然估计是样本平均等待时间的倒数，在 $t_i$ 值以秒为单位的情况下，其单位解释为 $s^{-1}$。\n\n用于检验指数性的柯尔莫哥洛夫-斯米尔诺夫统计量：\n- 经验累积分布函数（CDF）为\n$$\n\\hat{F}_n(t) = \\frac{1}{n}\\sum_{i=1}^n \\mathbf{1}\\{t_i \\le t\\}.\n$$\n- 在速率为 $\\lambda$ 的指数模型下，理论 CDF 为\n$$\nF(t; \\lambda) = 1 - e^{-\\lambda t}.\n$$\n- 单样本柯尔莫哥洛夫-斯米尔诺夫统计量，在 $\\lambda$ 未知并由 $\\hat{\\lambda}$ 替换的复合零假设下，为\n$$\nD_n = \\sup_{t \\ge 0} \\left| \\hat{F}_n(t) - F(t; \\hat{\\lambda}) \\right|.\n$$\n- 在计算上，当样本 $\\{t_i\\}$ 按 $t_{(1)} \\le t_{(2)} \\le \\dots \\le t_{(n)}$ 排序时，上确界出现在样本点处。我们计算\n$$\nD_n = \\max_{1 \\le i \\le n} \\left\\{ \\left| \\frac{i}{n} - F(t_{(i)}; \\hat{\\lambda}) \\right|, \\left| \\frac{i-1}{n} - F(t_{(i)}; \\hat{\\lambda}) \\right| \\right\\}.\n$$\n\n使用柯尔莫哥洛夫分布计算渐近 p 值：\n- 对于当底层 CDF 完全指定时的单样本柯尔莫哥洛夫-斯米尔诺夫统计量，$D_n$ 的零分布具有由以下级数给出的柯尔莫哥洛夫尾部\n$$\nQ_K(z) = 2 \\sum_{k=1}^{\\infty} (-1)^{k-1} e^{-2 k^2 z^2}, \\quad z = D_n \\sqrt{n}.\n$$\n- 渐近 p 值由 $p \\approx Q_K(D_n \\sqrt{n})$ 近似。在实践中，当级数项变得可以忽略不计时，级数被截断；当 $|2(-1)^{k-1} e^{-2 k^2 z^2}|$ 小于一个小的容差（如 $10^{-12}$）时可以停止。对于大小合理的 $z$，该级数收敛迅速。\n- 在显著性水平 $\\alpha$ 下的决策使用规则“如果 $p  \\alpha$ 则拒绝”，否则“不拒绝”。因为 $\\hat{\\lambda}$ 是从数据中估计的，所以精确的有限样本零分布会略有改变（Lilliefors 效应）。然而，在高等研究生水平和中等 $n$ 的情况下，渐近柯尔莫哥洛夫近似被广泛用作一种有原则的方法，并且在应用决策规则时会意识到这种近似的存在。\n\n算法设计：\n1. 对于每个轨迹，使用以秒为单位的 $t_i$ 计算 $\\hat{\\lambda} = n / \\sum_{i=1}^n t_i$，以产生单位为 $s^{-1}$ 的 $\\hat{\\lambda}$。\n2. 对等待时间进行排序，并计算 $F(t_{(i)}; \\hat{\\lambda}) = 1 - e^{-\\hat{\\lambda} t_{(i)}}$。\n3. 通过以下公式计算 $D_n$\n$$\nD_n = \\max_{1 \\le i \\le n} \\left\\{ \\left(\\frac{i}{n} - F(t_{(i)}; \\hat{\\lambda})\\right)_+, \\left(F(t_{(i)}; \\hat{\\lambda}) - \\frac{i-1}{n}\\right)_+ \\right\\},\n$$\n其中 $(x)_+$ 表示正部，绝对值通过两个单侧最大值实现。\n4. 计算 $z = D_n \\sqrt{n}$，并使用在某个容差处截断的交错级数计算渐近 p 值 $p \\approx Q_K(z)$。\n5. 将 $p$ 与给定的 $\\alpha$ 进行比较，并为每个轨迹输出列表 $\\left[\\hat{\\lambda}, D_n, \\text{decision}\\right]$，其中 $\\hat{\\lambda}$ 的单位是 $s^{-1}$，$D_n$ 是无量纲的，$\\text{decision}$ 是布尔值。\n\n最终的程序将为提供的测试套件实现这些步骤，并打印单行 $\\left[[\\hat{\\lambda}_A, D_A, \\text{decision}_A],[\\hat{\\lambda}_B, D_B, \\text{decision}_B],[\\hat{\\lambda}_C, D_C, \\text{decision}_C]\\right]$。",
            "answer": "[[6.443298969072165,0.1118181373516515,False],[3.2051282051282053,0.37059155708899814,True],[8.620689655172415,0.2268686641885449,False]]"
        }
    ]
}