{
    "hands_on_practices": [
        {
            "introduction": "构建动力学蒙特卡洛（KMC）的事件目录，首先需要系统地识别出所有独特的局域原子环境，以及在每种环境下可能发生的转变。本次实践将引导您在一个二维方格点阵上完成这一基本工作流程 。您将学习如何通过考虑晶格对称性来对局域构型（“基元”）进行分类，然后为这些构型枚举所有允许的事件，并根据局域环境计算它们的速率，从而从第一性原理出发构建一个微型事件目录。",
            "id": "3807512",
            "problem": "考虑一个二维方格晶格以及为动力学蒙特卡洛（KMC）构建事件目录。中心任务是枚举出达到某个几何截断半径内的所有局部原子邻域构型，并将每种构型与允许的空位交换事件及其速率关联起来。请基于过渡态理论（TST）和晶格对称性的基本定义来推导和设计您的算法。\n\n基本原理：\n- 过渡态理论（TST）：事件速率为 $k = \\nu \\exp\\!\\big(-E_b/(k_B T)\\big)$，其中 $\\nu$ 是尝试频率，$E_b$ 是激活能垒，$k_B$ 是玻尔兹曼常数，$T$ 是温度。\n- 晶格对称性：方格晶格具有8阶二面体对称群（$D_4$），包括四个旋转（$0^\\circ, 90^\\circ, 180^\\circ, 270^\\circ$）和四个反射（例如，绕 $x$ 轴的反射与每次旋转的复合）。通过 $D_4$ 群中的一个元素相关联的两个局部构型在物理上是等效的，在目录中必须被视为同一类别。\n\n几何与表示：\n- 考虑中心晶格位置为空位。定义一个几何截断半径 $r_c = \\sqrt{2}$（以晶格单位计），该半径包括中心位置周围的第一和第二近邻壳层：\n  - 第一壳层（距离为 $1$）：位移矢量为 $\\{(0,1),(1,0),(0,-1),(-1,0)\\}$ 的位置。\n  - 第二壳层（距离为 $\\sqrt{2}$）：位移矢量为 $\\{(1,1),(1,-1),(-1,-1),(-1,1)\\}$ 的位置。\n- 将局部构型 $\\mathbf{m}$ 表示为一个8分量二进制向量 $\\mathbf{m} = (m_0,m_1,m_2,m_3,m_4,m_5,m_6,m_7)$，表示这些近邻位置的占据情况，分别按 $\\{(0,1),(1,0),(0,-1),(-1,0),(1,1),(1,-1),(-1,-1),(-1,1)\\}$ 的顺序排列，其中 $m_i \\in \\{0,1\\}$ 表示未占据或占据。\n- $D_4$ 对称性下的构型等效性：定义每个对称操作对位移矢量的作用，并相应地置换 $\\mathbf{m}$ 的分量。一个构型类别的正则代表被定义为 $\\mathbf{m}$ 的所有8个对称变换变体中字典序最小的向量。\n\n事件与能垒：\n- 允许的事件是中心空位与任何被占据的第一壳层近邻原子之间的交换。也就是说，对于每个第一壳层方向 $d \\in \\{(0,1),(1,0),(0,-1),(-1,0)\\}$，如果 $\\mathbf{m}$ 的相应分量为1，则允许一个事件发生。\n- 使用一个基于物理的局部拥挤模型来分配激活能垒：\n  - 对于方向 $d$ 的一次跳跃，令 $n_2(d)$ 为与跳跃路径相邻的已占据第二壳层近邻的数量，令 $n_1^{\\parallel}(d)$ 为与跳跃路径侧向的已占据第一壳层近邻的数量。具体来说：\n    - 对于 $d=(0,1)$（北），相邻的第二近邻是 $(1,1)$ 和 $(-1,1)$，侧向的第一近邻是 $(1,0)$ 和 $(-1,0)$。\n    - 对于 $d=(1,0)$（东），相邻的第二近邻是 $(1,1)$ 和 $(1,-1)$，侧向的第一近邻是 $(0,1)$ 和 $(0,-1)$。\n    - 对于 $d=(0,-1)$（南），相邻的第二近邻是 $(1,-1)$ 和 $(-1,-1)$，侧向的第一近邻是 $(1,0)$ 和 $(-1,0)$。\n    - 对于 $d=(-1,0)$（西），相邻的第二近邻是 $(-1,1)$ 和 $(-1,-1)$，侧向的第一近邻是 $(0,1)$ 和 $(0,-1)$。\n  - 使用能垒模型 $E_b(d) = E_0 + \\alpha\\, n_2(d) + \\beta\\, n_1^{\\parallel}(d)$，其中常数 $E_0 = 0.6\\,\\mathrm{eV}$，$\\alpha = 0.05\\,\\mathrm{eV}$，$\\beta = 0.02\\,\\mathrm{eV}$。\n- 事件速率为 $k(d) = \\nu \\exp\\!\\big(-E_b(d)/(k_B T)\\big)$，其中 $\\nu = 10^{13}\\,\\mathrm{s}^{-1}$ 且 $k_B = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV}/\\mathrm{K}$。所有速率以 $\\mathrm{s}^{-1}$ 为单位表示。\n\n程序要求：\n- 对于每个测试用例，给定一组构型（以八个二进制条目的列表形式，按上述固定顺序排列）和一个温度 $T$（单位为 $\\mathrm{K}$）。你的程序必须：\n  $1.$ 在 $D_4$ 对称性下对每个构型进行正则化，并计算存在的不同构型类别的数量。\n  $2.$ 枚举所有允许的事件（与被占据的第一壳层近邻的空位交换），并计算事件总数。\n  $3.$ 计算所有构型中所有允许事件的速率 $k(d)$ 的总和。\n- 最终输出格式：你的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表。对于每个测试用例，按顺序输出三个数字：不同构型类别的整数数量、允许事件的整数数量，以及四舍五入到六位小数的事件速率总和（单位为 $\\mathrm{s}^{-1}$）。将所有测试用例的这三元组合并成一个列表。例如，一个有效的输出可能看起来像 $[a_1,b_1,c_1,a_2,b_2,c_2,\\dots]$。\n\n测试套件：\n- 使用以下测试用例（每个构型都按固定顺序 $\\{(0,1),(1,0),(0,-1),(-1,0),(1,1),(1,-1),(-1,-1),(-1,1)\\}$ 列出）：\n  $1.$ 温度 $T=300\\,\\mathrm{K}$，构型如下：\n    - $\\mathbf{m}^{(1)} = (0,0,0,0,0,0,0,0)$\n    - $\\mathbf{m}^{(2)} = (1,0,0,0,0,0,0,0)$\n    - $\\mathbf{m}^{(3)} = (0,1,0,0,0,0,0,0)$\n    - $\\mathbf{m}^{(4)} = (0,0,0,0,1,0,0,1)$\n  $2.$ 温度 $T=600\\,\\mathrm{K}$，构型如下：\n    - $\\mathbf{m}^{(5)} = (1,1,1,1,0,0,0,0)$\n    - $\\mathbf{m}^{(6)} = (1,1,0,0,1,0,1,0)$\n    - $\\mathbf{m}^{(7)} = (1,0,1,0,0,1,0,1)$\n  $3.$ 温度 $T=1000\\,\\mathrm{K}$，构型如下：\n    - $\\mathbf{m}^{(8)} = (1,0,1,0,1,1,1,1)$\n    - $\\mathbf{m}^{(9)} = (0,0,0,0,1,0,1,0)$\n    - $\\mathbf{m}^{(10)} = (1,1,1,0,0,1,0,1)$\n\n答案规格：\n- 单位：所有速率必须以 $\\mathrm{s}^{-1}$ 报告。\n- 角度单位：所有旋转在内部被理解为弧度，但描述中使用度；程序输出中不包含任何角度值。\n- 百分比：不适用。\n- 输出取整：在输出前将每个速率总和四舍五入到六位小数。\n- 最终输出格式：单行输出，包含一个方括号括起来的逗号分隔列表，其中每个测试用例的三个结果按 $[a_1,b_1,c_1,a_2,b_2,c_2,a_3,b_3,c_3]$ 的顺序排列。",
            "solution": "该问题经评估有效，因为它具有科学依据、内容自洽、提法明确，且没有矛盾或含糊之处。它提出了一个计算材料科学领域的标准问题，尽管细节繁多，但具体涉及动力学蒙特卡洛（KMC）模拟的设置。我们将继续提供完整的解决方案。\n\n每个测试用例的解决方案包括三个主要步骤：\n1.  **对称性正则化**：对于每个给定的局部原子构型（motif），我们必须找到其正则表示。这通过应用方格晶格点群 $D_4$ 的所有对称操作，并选择字典序最小的结果构型来实现。这个过程使我们能够识别并计数唯一的物理构型类别的数量。\n2.  **事件枚举**：我们必须为每个构型识别所有可能的物理事件。问题将事件定义为中心空位与被占据的最近邻原子之间的交换。\n3.  **速率计算**：对于每个已识别的事件，我们使用提供的过渡态理论（TST）公式 $k = \\nu \\exp(-E_b/(k_B T))$ 和指定的活化能垒 $E_b$ 物理模型来计算其速率。\n\n我们现在将详细说明这些步骤的实现。\n\n### 1. 对称操作与正则化\n\n局部邻域由一个8分量二进制向量 $\\mathbf{m} = (m_0, \\dots, m_7)$ 表示，其中每个分量对应一个特定近邻位置的占据情况。这些位置的顺序如下：\n- $m_0$: 北 (N) $(0,1)$\n- $m_1$: 东 (E) $(1,0)$\n- $m_2$: 南 (S) $(0,-1)$\n- $m_3$: 西 (W) $(-1,0)$\n- $m_4$: 东北 (NE) $(1,1)$\n- $m_5$: 东南 (SE) $(1,-1)$\n- $m_6$: 西南 (SW) $(-1,-1)$\n- $m_7$: 西北 (NW) $(-1,1)$\n\n方格晶格的对称群是二面体群 $D_4$，它有8个元素：四个旋转（$R_0, R_{90}, R_{180}, R_{270}$）和四个反射。我们将每个对称操作的作用定义为对构型向量 $\\mathbf{m}$ 的索引 $\\{0, \\dots, 7\\}$ 的一个置换。一个操作将构型 $\\mathbf{m}$ 变换为一个新构型 $\\mathbf{m}'$，其中 $\\mathbf{m}$ 中位置 $i$ 的原子移动到 $\\mathbf{m}'$ 中的位置 $p(i)$。这对应于置换规则 $\\mathbf{m}'_{p(i)} = \\mathbf{m}_i$。这8个置换 $(p_0, \\dots, p_7)$ 是通过考虑近邻坐标的几何变换得出的：\n\n- $R_0$ (恒等，$0^\\circ$ 旋转): $(x,y) \\to (x,y)$。置换: $(0, 1, 2, 3, 4, 5, 6, 7)$。\n- $R_{90}$ ($90^\\circ$ 逆时针旋转): $(x,y) \\to (-y,x)$。置换: $(3, 0, 1, 2, 7, 4, 5, 6)$。\n- $R_{180}$ ($180^\\circ$ 旋转): $(x,y) \\to (-x,-y)$。置换: $(2, 3, 0, 1, 6, 7, 4, 5)$。\n- $R_{270}$ ($270^\\circ$ 逆时针旋转): $(x,y) \\to (y,-x)$。置换: $(1, 2, 3, 0, 5, 6, 7, 4)$。\n- $S_x$ (绕x轴反射): $(x,y) \\to (x,-y)$。置换: $(2, 1, 0, 3, 5, 4, 7, 6)$。\n- $S_x \\circ R_{90}$ (绕$y=-x$线反射): 置换: $(3, 2, 1, 0, 6, 5, 4, 7)$。\n- $S_x \\circ R_{180}$ (绕y轴反射, $S_y$): 置换: $(0, 3, 2, 1, 7, 6, 5, 4)$。\n- $S_x \\circ R_{270}$ (绕$y=x$线反射): 置换: $(1, 0, 3, 2, 4, 7, 6, 5)$。\n\n对于任何给定的构型 $\\mathbf{m}$，我们通过应用这些置换生成所有8个（不一定唯一）的变体。$\\mathbf{m}$ 所属类别的正则代表是这8个变体中字典序最小的一个。为了计算一个测试用例中不同构型类别的数量，我们对每个输入构型进行正则化，并使用集合数据结构来统计唯一正则形式的数量。\n\n### 2. 事件枚举与速率计算\n\n一个事件是指原子从一个被占据的第一近邻位置跳跃到中心空位。第一近邻位置对应于构型向量中的索引 $0, 1, 2, 3$。因此，对于一个给定的构型 $\\mathbf{m}$，我们遍历 $i \\in \\{0, 1, 2, 3\\}$。如果 $m_i=1$，则允许一个事件发生。事件总数是在一个测试用例中提供的所有构型上，此类允许跳跃的总和。\n\n每个事件的速率由 $k = \\nu \\exp(-E_b / (k_B T))$ 给出。常数给定为 $\\nu = 10^{13}\\,\\mathrm{s}^{-1}$ 和 $k_B=8.617333262145 \\times 10^{-5}\\,\\mathrm{eV/K}$。活化能垒 $E_b$ 通过公式 $E_b(d) = E_0 + \\alpha\\, n_2(d) + \\beta\\, n_1^{\\parallel}(d)$ 依赖于局部环境，其中 $E_0=0.6\\,\\mathrm{eV}$，$\\alpha=0.05\\,\\mathrm{eV}$，$\\beta=0.02\\,\\mathrm{eV}$。这里，$d$ 是跳跃方向，$n_2(d)$ 是与跳跃路径相邻的已占据第二壳层近邻的数量，$n_1^{\\parallel}(d)$ 是与跳跃路径侧向的已占据第一壳层近邻的数量。\n\n我们通过定义向量索引之间的邻域关系来实现这一点：\n- **向北跳跃（位置0的方向）**：\n  - $n_1^{\\parallel}$：位置 东(1) 和 西(3)。$n_1^{\\parallel} = m_1 + m_3$。\n  - $n_2$：位置 东北(4) 和 西北(7)。$n_2 = m_4 + m_7$。\n- **向东跳跃（位置1的方向）**：\n  - $n_1^{\\parallel}$：位置 北(0) 和 南(2)。$n_1^{\\parallel} = m_0 + m_2$。\n  - $n_2$：位置 东北(4) 和 东南(5)。$n_2 = m_4 + m_5$。\n- **向南跳跃（位置2的方向）**：\n  - $n_1^{\\parallel}$：位置 东(1) 和 西(3)。$n_1^{\\parallel} = m_1 + m_3$。\n  - $n_2$：位置 东南(5) 和 西南(6)。$n_2 = m_5 + m_6$。\n- **向西跳跃（位置3的方向）**：\n  - $n_1^{\\parallel}$：位置 北(0) 和 南(2)。$n_1^{\\parallel} = m_0 + m_2$。\n  - $n_2$：位置 西南(6) 和 西北(7)。$n_2 = m_6 + m_7$。\n\n对于一个测试用例中的每个构型，我们检查允许的事件。对于每个允许的事件，我们根据构型的完整配置计算其特定的能垒 $E_b$，计算相应的速率 $k$，并将其加到该测试用例的运行总和中。\n\n### 3. 最终算法\n\n每个测试用例的总体流程如下：\n1.  初始化一个用于存放正则类别的集合 `canonical_classes`，一个用于计数的整数 `total_events = 0`，以及一个用于速率总和的浮点数 `total_rate = 0.0`。\n2.  对于输入列表中的每个构型 $\\mathbf{m}$：\n    a. 通过生成所有8个对称变体并找到字典序最小值来确定 $\\mathbf{m}$ 的正则形式。将此正则形式添加到 `canonical_classes` 中。\n    b. 检查 $\\mathbf{m}$ 的前四个分量（$m_0, m_1, m_2, m_3$）。\n    c. 对于每个 $m_i=1$（其中 $i \\in \\{0,1,2,3\\}$）：\n        i.  `total_events` 增加1。\n        ii. 根据跳跃方向 $i$ 计算 $n_1^{\\parallel}$ 和 $n_2$。\n        iii. 计算 $E_b = E_0 + \\alpha n_2 + \\beta n_1^{\\parallel}$。\n        iv. 计算 $k = \\nu \\exp(-E_b / (k_B T))$。\n        v.  将 $k$ 加到 `total_rate` 中。\n3.  该测试用例的结果是：`canonical_classes` 的大小、最终的 `total_events`，以及四舍五入到六位小数的 `total_rate`。这三个值被附加到一个全局结果列表中。\n4. 处理完所有测试用例后，最终输出是包含所有收集结果的单个格式化字符串。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the KMC event catalog construction problem for the given test cases.\n    \"\"\"\n    \n    # --- Constants ---\n    NU = 1e13  # Attempt frequency in s^-1\n    KB = 8.617333262145e-5  # Boltzmann constant in eV/K\n    E0 = 0.6  # Base activation barrier in eV\n    ALPHA = 0.05  # Barrier contribution from 2nd neighbors in eV\n    BETA = 0.02   # Barrier contribution from 1st neighbors in eV\n\n    # --- Symmetry Operations ---\n    # D4 permutation group elements as scatter-index tuples.\n    # Motif vector index order: [N, E, S, W, NE, SE, SW, NW]\n    # Indices:                 [0, 1, 2, 3,  4,  5,  6,  7]\n    PERMUTATIONS = [\n        (0, 1, 2, 3, 4, 5, 6, 7),  # R0 (identity)\n        (3, 0, 1, 2, 7, 4, 5, 6),  # R90 (rotation by 90 degrees)\n        (2, 3, 0, 1, 6, 7, 4, 5),  # R180 (rotation by 180 degrees)\n        (1, 2, 3, 0, 5, 6, 7, 4),  # R270 (rotation by 270 degrees)\n        (2, 1, 0, 3, 5, 4, 7, 6),  # Sx (reflection across x-axis)\n        (3, 2, 1, 0, 6, 5, 4, 7),  # S_y=-x (reflection across y=-x line)\n        (0, 3, 2, 1, 7, 6, 5, 4),  # Sy (reflection across y-axis)\n        (1, 0, 3, 2, 4, 7, 6, 5),  # S_y=x (reflection across y=x line)\n    ]\n\n    def get_canonical_form(motif_tuple):\n        \"\"\"\n        Finds the canonical representation of a motif under D4 symmetry.\n        \"\"\"\n        variants = set()\n        for p in PERMUTATIONS:\n            new_m = [0] * 8\n            for i in range(8):\n                new_m[p[i]] = motif_tuple[i]\n            variants.add(tuple(new_m))\n        return min(variants)\n\n    # --- Test Suite ---\n    test_cases = [\n        (300, [\n            (0, 0, 0, 0, 0, 0, 0, 0),\n            (1, 0, 0, 0, 0, 0, 0, 0),\n            (0, 1, 0, 0, 0, 0, 0, 0),\n            (0, 0, 0, 0, 1, 0, 0, 1),\n        ]),\n        (600, [\n            (1, 1, 1, 1, 0, 0, 0, 0),\n            (1, 1, 0, 0, 1, 0, 1, 0),\n            (1, 0, 1, 0, 0, 1, 0, 1),\n        ]),\n        (1000, [\n            (1, 0, 1, 0, 1, 1, 1, 1),\n            (0, 0, 0, 0, 1, 0, 1, 0),\n            (1, 1, 1, 0, 0, 1, 0, 1),\n        ]),\n    ]\n    \n    all_results = []\n    \n    for T, motifs in test_cases:\n        canonical_classes = set()\n        total_events = 0\n        total_rate = 0.0\n        \n        kbt = KB * T\n        \n        for m_list in motifs:\n            m = tuple(m_list)\n            \n            # 1. Canonicalize motif and count distinct classes\n            canonical_form = get_canonical_form(m)\n            canonical_classes.add(canonical_form)\n            \n            # 2.  3. Enumerate events and sum rates\n            # Hop N (index 0)\n            if m[0] == 1:\n                total_events += 1\n                n2 = m[4] + m[7]\n                n1_parallel = m[1] + m[3]\n                eb = E0 + ALPHA * n2 + BETA * n1_parallel\n                total_rate += NU * np.exp(-eb / kbt)\n                \n            # Hop E (index 1)\n            if m[1] == 1:\n                total_events += 1\n                n2 = m[4] + m[5]\n                n1_parallel = m[0] + m[2]\n                eb = E0 + ALPHA * n2 + BETA * n1_parallel\n                total_rate += NU * np.exp(-eb / kbt)\n\n            # Hop S (index 2)\n            if m[2] == 1:\n                total_events += 1\n                n2 = m[5] + m[6]\n                n1_parallel = m[1] + m[3]\n                eb = E0 + ALPHA * n2 + BETA * n1_parallel\n                total_rate += NU * np.exp(-eb / kbt)\n                \n            # Hop W (index 3)\n            if m[3] == 1:\n                total_events += 1\n                n2 = m[6] + m[7]\n                n1_parallel = m[0] + m[2]\n                eb = E0 + ALPHA * n2 + BETA * n1_parallel\n                total_rate += NU * np.exp(-eb / kbt)\n\n        num_distinct_classes = len(canonical_classes)\n        \n        all_results.append(num_distinct_classes)\n        all_results.append(total_events)\n        all_results.append(f\"{total_rate:.6f}\")\n\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在实际研究中，事件目录中的活化能垒通常是通过高计算成本的原子尺度模拟（例如“微动弹性带”NEB方法）获得的。本练习聚焦于一个关键的数据处理步骤：如何将NEB计算输出的离散能量路径点，转化为KMC事件目录中所需的精确活化能垒 。您将练习使用插值法来克服反应路径离散化带来的限制，这是将原子尺度计算与介观尺度KMC模型连接起来的一项至关重要的技能。",
            "id": "3807534",
            "problem": "一个通过弹性带微动 (Nudged Elastic Band, NEB) 方法计算出的、用于描述晶体固体中点缺陷跳跃的离散化最小能量路径，已收敛至路径上垂直力很小的状态。反应坐标 $s$ 已被归一化到区间 $[0,1]$。动力学蒙特卡洛 (KMC) 中的事件目录需要该跳跃的活化能垒，理论上其定义为最小能量路径上的鞍点能量与初始态能量之差。从过渡态理论 (TST) 和最小能量路径的定义出发，利用给定的 NEB 数据来确定能垒。\n\n给定以下离散的图像位置 $s_i$ 及其相对于初始态的对应能量 $E(s_i)$：\n\n- $i=0$: $s_0=0.00$, $E(s_0)=0.000\\,\\text{eV}$\n- $i=1$: $s_1=0.07$, $E(s_1)=0.118\\,\\text{eV}$\n- $i=2$: $s_2=0.15$, $E(s_2)=0.255\\,\\text{eV}$\n- $i=3$: $s_3=0.25$, $E(s_3)=0.410\\,\\text{eV}$\n- $i=4$: $s_4=0.37$, $E(s_4)=0.570\\,\\text{eV}$\n- $i=5$: $s_5=0.52$, $E(s_5)=0.690\\,\\text{eV}$\n- $i=6$: $s_6=0.66$, $E(s_6)=0.755\\,\\text{eV}$\n- $i=7$: $s_7=0.77$, $E(s_7)=0.780\\,\\text{eV}$\n- $i=8$: $s_8=0.86$, $E(s_8)=0.770\\,\\text{eV}$\n- $i=9$: $s_9=0.93$, $E(s_9)=0.720\\,\\text{eV}$\n- $i=10$: $s_{10}=1.00$, $E(s_{10})=0.695\\,\\text{eV}$\n\n为了减轻有限图像离散化的影响，请通过对峰值附近的三个能量最高的图像进行局部二次插值，来估算弹性带上的连续最大能量。然后，通过计算该插值最大能量与初始态能量之差来得到活化能垒。\n\n此外，在您的推导中，请讨论一种有原则的方法来估算由图像有限离散化引起的能垒不确定度，该方法应从 $E(s)$ 在最大值附近的光滑性假设出发，并用局部曲率和图像间距来表示任何界限。\n\n最终能垒以电子伏特 (eV) 为单位表示，并将您的答案四舍五入至四位有效数字。",
            "solution": "该问题要求使用来自弹性带微动 (NEB) 计算的离散能量路径数据，来计算点缺陷跳跃的活化能垒。在过渡态理论 (TST) 中，活化能垒 $E_{barrier}$ 定义为最小能量路径 (MEP) 的鞍点能量 $E_{saddle}$ 与初始稳定态能量 $E_{initial}$ 之间的差值。\n$$ E_{barrier} = E_{saddle} - E_{initial} $$\n所提供的数据包含一组 $N=11$ 个离散点，或称图像，$(s_i, E(s_i))$，其中 $s_i$ 是归一化的反应坐标，$E(s_i)$ 是相对于初始态的能量。初始态由图像 $i=0$ 给出，其 $s_0=0.00$ 且 $E(s_0)=0.000\\,\\text{eV}$。因此，$E_{initial} = 0.000\\,\\text{eV}$，活化能垒在数值上等于鞍点能量，$E_{barrier} = E_{saddle}$。\n\n鞍点对应于最小能量路径上的最大能量。由于路径由一组离散的图像表示，真实的最大值可能位于图像之间。问题指定使用能量最高的三幅图像进行局部二次插值，以估算连续的最大值。\n\n首先，我们从提供的数据中找出能量最高的三个图像：\n- 图像 $i=6$: $(s_6, E_6) = (0.66, 0.755\\,\\text{eV})$\n- 图像 $i=7$: $(s_7, E_7) = (0.77, 0.780\\,\\text{eV})$\n- 图像 $i=8$: $(s_8, E_8) = (0.86, 0.770\\,\\text{eV})$\n\n图像 $i=7$ 具有所有离散点中的最高能量，因此真实的鞍点预计在其附近。我们将对这三个点拟合一个二次多项式 $E(s) = A s^2 + B s + C$。\n\n为方便计算，我们平移坐标系，使中间点 $(s_7, E_7)$ 位于新坐标 $s'$ 的原点。令 $s' = s - s_7 = s - 0.77$。在 $(s', E)$ 坐标系中，这三个点是：\n- $(s_6 - s_7, E_6) = (0.66 - 0.77, 0.755) = (-0.11, 0.755)$\n- $(s_7 - s_7, E_7) = (0, 0.780)$\n- $(s_8 - s_7, E_8) = (0.86 - 0.77, 0.770) = (0.09, 0.770)$\n\n现在的插值抛物线为 $E(s') = A (s')^2 + B s' + C$。利用点 $(0, 0.780)$，我们立即得到 $C = 0.780\\,\\text{eV}$。\n我们用另外两个点来建立一个关于 $A$ 和 $B$ 的二元一次方程组：\n$$\n\\begin{cases}\nA(-0.11)^2 + B(-0.11) + 0.780 = 0.755 \\\\\nA(0.09)^2 + B(0.09) + 0.780 = 0.770\n\\end{cases}\n$$\n这可以简化为：\n$$\n\\begin{cases}\n0.0121 A - 0.11 B = -0.025  (\\text{Eq. 1}) \\\\\n0.0081 A + 0.09 B = -0.010  (\\text{Eq. 2})\n\\end{cases}\n$$\n为解此方程组，我们可以将方程1乘以 $0.09$，将方程2乘以 $0.11$：\n$$\n\\begin{cases}\n0.001089 A - 0.0099 B = -0.00225 \\\\\n0.000891 A + 0.0099 B = -0.00110\n\\end{cases}\n$$\n将这两个新方程相加可以消去 $B$：\n$$ (0.001089 + 0.000891) A = -0.00225 - 0.00110 $$\n$$ 0.00198 A = -0.00335 $$\n$$ A = -\\frac{0.00335}{0.00198} \\approx -1.691919... $$\n现在，我们将 $A$ 的值代回方程2来求 $B$：\n$$ B = \\frac{-0.010 - 0.0081 A}{0.09} = \\frac{-0.010 - 0.0081(-1.691919...)}{0.09} = \\frac{-0.010 + 0.013704545...}{0.09} $$\n$$ B = \\frac{0.003704545...}{0.09} \\approx 0.041161616... $$\n抛物线 $E(s') = A(s')^2 + B s' + C$ 的顶点出现在 $s'_{max} = -B/(2A)$ 处，最大能量为 $E_{saddle} = E(s'_{max}) = C - B^2/(4A)$。\n代入 $A$、$B$ 和 $C$ 的值：\n$$ E_{saddle} = 0.780 - \\frac{(0.041161616...)^2}{4(-1.691919...)} = 0.780 - \\frac{0.00169427...}{-6.767676...} $$\n$$ E_{saddle} = 0.780 + 0.00025033... \\approx 0.78025033\\,\\text{eV} $$\n那么，活化能垒为：\n$$ E_{barrier} = E_{saddle} - E_{initial} = 0.78025033\\,\\text{eV} - 0.000\\,\\text{eV} = 0.78025033\\,\\text{eV} $$\n四舍五入到四位有效数字，我们得到 $E_{barrier} = 0.7803\\,\\text{eV}$。\n\n问题还要求讨论如何估算由有限离散化引起的不确定度。估算鞍点能量的误差源于真实的能量剖面 $E(s)$ 通常并非一个完美的二次函数。通过考虑 $E(s)$ 在真实鞍点 $s_{sp}$ 附近的泰勒级数展开，可以理解其与二次形式的偏差：\n$$ E(s) = E(s_{sp}) + \\frac{1}{2} E''(s_{sp})(s-s_{sp})^2 + \\frac{1}{6} E'''(s_{sp})(s-s_{sp})^3 + \\frac{1}{24} E^{(4)}(s_{sp})(s-s_{sp})^4 + \\dots $$\n在鞍点处，$E'(s_{sp})=0$。如果 $E(s)$ 是纯二次的（即所有3阶及更高阶导数均为零），则二次插值是精确的。因此，插值鞍点能量的误差 $\\Delta E_{error} = E_{saddle}^{interp} - E(s_{sp})$ 取决于这些高阶导数。假设路径在鞍点附近是合理对称的，则三次项 $E'''(s_{sp})$ 很小，主要的误差来源是四次项，由 $E^{(4)}(s_{sp})$ 表征。\n\n形式分析表明，二次插值方法的误差与图像间距 $\\Delta s$ 的四次方成比例。具体来说，误差与能量的四阶导数和间距的四次方的乘积成正比：\n$$ \\Delta E_{error} \\propto E^{(4)}(s_{sp}) (\\Delta s)^4 $$\n这为不确定度估算提供了一个原则性基础：对于更平滑的势能面（较小的 $E^{(4)}$）和更密集的图像离散化（较小的 $\\Delta s$），误差更小。\n\n一种估算此不确定度的实用且稳健的方法是进行收敛性研究。可以在鞍点附近使用更高密度的图像重新计算能垒，例如，将间距减半至 $\\Delta s/2$。设使用间距 $\\Delta s$ 计算的能垒为 $E_{barrier}(\\Delta s)$，使用间距 $\\Delta s/2$ 计算的能垒为 $E_{barrier}(\\Delta s/2)$。真实的能垒为 $E_{true}$。误差分别为：\n$$ E_{barrier}(\\Delta s) - E_{true} \\approx K (\\Delta s)^4 $$\n$$ E_{barrier}(\\Delta s/2) - E_{true} \\approx K (\\Delta s/2)^4 = \\frac{1}{16} K (\\Delta s)^4 $$\n两个计算值之间的差值为：\n$$ E_{barrier}(\\Delta s) - E_{barrier}(\\Delta s/2) \\approx \\frac{15}{16} K (\\Delta s)^4 $$\n因此，更精确计算中的误差 $\\epsilon(\\Delta s/2) = E_{barrier}(\\Delta s/2) - E_{true}$ 可以使用理查森外推法进行估算：\n$$ \\epsilon(\\Delta s/2) \\approx \\frac{1}{15} \\left( E_{barrier}(\\Delta s) - E_{barrier}(\\Delta s/2) \\right) $$\n这个结果提供了对离散化误差的定量估算，其基础是能量函数 $E(s)$ 的光滑性以及插值方案的系统性收敛。",
            "answer": "$$\\boxed{0.7803}$$"
        },
        {
            "introduction": "一个物理上有效的KMC事件目录必须与热力学定律保持一致。本次实践将深入探讨细致平衡原理，该原理将任意一个转变的正向和反向速率与初末态之间的自由能差联系起来 。通过应用这一定理，您将确保KMC模拟能够正确地再现系统的热力学平衡态，这是任何预测性建模的基本要求。",
            "id": "3807561",
            "problem": "在动力学蒙特卡洛（KMC）的事件目录构建中，两个亚稳态之间的每次跃迁都必须有一个满足平衡热力学和微观可逆性原理的速率表达式。考虑两个局域极小值，标记为 $i$ 和 $j$，在温度 $T$ 下其亥姆霍兹自由能分别为 $F_i$ 和 $F_j$。自由能差定义为 $\\Delta F = F_j - F_i$。通过微扰弹性带（NEB）计算，您已获得从 $j \\rightarrow i$ 跃迁的活化自由能垒，记为 $E_a^{j \\rightarrow i}$。利用正则过渡态理论（TST）和正则系综中的细致平衡条件，推导 $i \\rightarrow j$ 跃迁的活化自由能垒 $E_a^{i \\rightarrow j}$ 的表达式，该表达式需用 $\\Delta F$、$E_a^{j \\rightarrow i}$ 和 TST 振动前因子的比值来表示。然后，使用以下物理上一致的数据，对 $E_a^{i \\rightarrow j}$ 进行数值计算：\n- 温度 $T = 600\\,\\text{K}$，\n- 自由能差 $\\Delta F = 0.128\\,\\text{eV}$，\n- 活化能垒 $E_a^{j \\rightarrow i} = 0.746\\,\\text{eV}$，\n- 假设由于局域振动谱相似，两个方向的 TST 振动尝试频率相等。\n\n最终能量以 eV 为单位表示，并四舍五入到四位有效数字。在您的推理过程中，请明确说明关于前因子的任何假设及其对细致平衡的影响。",
            "solution": "该问题要求推导活化自由能垒的表达式并进行后续的数值计算。这是一个基于统计力学和化学动力学原理的有效问题。\n\n两个态（例如从态 $A$ 到态 $B$）之间的热激活跃迁速率可以用正则过渡态理论（TST）来描述。速率常数 $k_{A \\rightarrow B}$ 由类阿伦尼乌斯表达式给出：\n$$k_{A \\rightarrow B} = \\nu_{A \\rightarrow B} \\exp\\left(-\\frac{E_a^{A \\rightarrow B}}{k_B T}\\right)$$\n其中 $\\nu_{A \\rightarrow B}$ 是尝试频率或指前因子，$E_a^{A \\rightarrow B}$ 是跃迁的活化自由能垒，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n对于态 $i$ 和态 $j$ 之间的特定跃迁，正向（$i \\rightarrow j$）和逆向（$j \\rightarrow i$）速率分别为：\n$$k_{i \\rightarrow j} = \\nu_{i \\rightarrow j} \\exp\\left(-\\frac{E_a^{i \\rightarrow j}}{k_B T}\\right)$$\n$$k_{j \\rightarrow i} = \\nu_{j \\rightarrow i} \\exp\\left(-\\frac{E_a^{j \\rightarrow i}}{k_B T}\\right)$$\n\n在热力学平衡状态下，必须满足细致平衡原理。该原理指出，从态 $i$ 到态 $j$ 的总跃迁速率等于从态 $j$ 到态 $i$ 的总跃迁速率。在正则系综中，这表示为：\n$$P_i k_{i \\rightarrow j} = P_j k_{j \\rightarrow i}$$\n其中 $P_i$ 和 $P_j$ 分别是系统处于态 $i$ 和态 $j$ 的平衡概率。占据一个亥姆霍兹自由能为 $F$ 的态的概率与玻尔兹曼因子 $\\exp(-F / (k_B T))$ 成正比。因此，概率之比为：\n$$\\frac{P_j}{P_i} = \\frac{\\exp\\left(-\\frac{F_j}{k_B T}\\right)}{\\exp\\left(-\\frac{F_i}{k_B T}\\right)} = \\exp\\left(-\\frac{F_j - F_i}{k_B T}\\right)$$\n使用给定的定义 $\\Delta F = F_j - F_i$，上式变为：\n$$\\frac{P_j}{P_i} = \\exp\\left(-\\frac{\\Delta F}{k_B T}\\right)$$\n\n根据细致平衡方程，我们可以将速率常数之比写为：\n$$\\frac{k_{i \\rightarrow j}}{k_{j \\rightarrow i}} = \\frac{P_j}{P_i} = \\exp\\left(-\\frac{\\Delta F}{k_B T}\\right)$$\n\n现在，我们将 TST 速率表达式代入此方程：\n$$\\frac{\\nu_{i \\rightarrow j} \\exp\\left(-\\frac{E_a^{i \\rightarrow j}}{k_B T}\\right)}{\\nu_{j \\rightarrow i} \\exp\\left(-\\frac{E_a^{j \\rightarrow i}}{k_B T}\\right)} = \\exp\\left(-\\frac{\\Delta F}{k_B T}\\right)$$\n\n我们可以重排各项，将指数项组合在一起：\n$$\\frac{\\nu_{i \\rightarrow j}}{\\nu_{j \\rightarrow i}} \\exp\\left(-\\frac{E_a^{i \\rightarrow j} - E_a^{j \\rightarrow i}}{k_B T}\\right) = \\exp\\left(-\\frac{\\Delta F}{k_B T}\\right)$$\n\n为了求解 $E_a^{i \\rightarrow j}$，我们对等式两边取自然对数：\n$$\\ln\\left(\\frac{\\nu_{i \\rightarrow j}}{\\nu_{j \\rightarrow i}}\\right) - \\frac{E_a^{i \\rightarrow j} - E_a^{j \\rightarrow i}}{k_B T} = -\\frac{\\Delta F}{k_B T}$$\n\n两边同乘以 $-k_B T$ 得到：\n$$-k_B T \\ln\\left(\\frac{\\nu_{i \\rightarrow j}}{\\nu_{j \\rightarrow i}}\\right) + E_a^{i \\rightarrow j} - E_a^{j \\rightarrow i} = \\Delta F$$\n\n最后，我们分离出 $E_a^{i \\rightarrow j}$，得到通用表达式：\n$$E_a^{i \\rightarrow j} = E_a^{j \\rightarrow i} + \\Delta F + k_B T \\ln\\left(\\frac{\\nu_{i \\rightarrow j}}{\\nu_{j \\rightarrow i}}\\right)$$\n该表达式将正向和逆向跃迁的活化能垒与总自由能变化以及指前因子的比值联系起来。\n\n问题提出了一个具体假设：“由于局域振动谱相似，两个方向的 TST 振动尝试频率相等。” 这意味着 $\\nu_{i \\rightarrow j} = \\nu_{j \\rightarrow i}$。在此假设下，前因子的比值为 $\\frac{\\nu_{i \\rightarrow j}}{\\nu_{j \\rightarrow i}} = 1$。因此对数项变为 $\\ln(1) = 0$。当初始态和最终态的局域原子环境非常相似时，这种简化很常见，这会导致极小值点附近的振动态密度几乎相同。\n在此假设下，活化能垒的表达式简化为：\n$$E_a^{i \\rightarrow j} = E_a^{j \\rightarrow i} + \\Delta F$$\n这种关系是细致平衡的直接结果，并经常在反应坐标图中得以体现，其中活化能垒的差值必须等于初始态和最终态的能量差。\n\n现在，我们使用所提供的数据进行数值计算：\n- 自由能差 $\\Delta F = 0.128\\,\\text{eV}$\n- 活化能垒 $E_a^{j \\rightarrow i} = 0.746\\,\\text{eV}$\n\n将这些值代入简化后的表达式：\n$$E_a^{i \\rightarrow j} = 0.746\\,\\text{eV} + 0.128\\,\\text{eV}$$\n$$E_a^{i \\rightarrow j} = 0.874\\,\\text{eV}$$\n\n问题要求答案以 eV 表示，并四舍五入到四位有效数字。计算值为 $0.874$。为了表示为四位有效数字，我们追加一个零，得到 $0.8740$。由于假设前因子相等，最终计算不需要温度 $T = 600\\,\\text{K}$，但它对于完整的理论背景是必要的。",
            "answer": "$$\n\\boxed{0.8740}\n$$"
        }
    ]
}