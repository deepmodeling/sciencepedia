{
    "hands_on_practices": [
        {
            "introduction": "任何粗粒化建模的第一步都是建立从精细的原子尺度到简化的粗粒化尺度的映射关系。对于刚性分子，这一过程通常涉及将其简化为一个质心和一个描述其取向的量。本练习  提供了一个具体案例，要求您为一个刚性三聚体分子构建一个非线性的粗粒化映射，这需要您应用稳健的数学工具来确定其在空间中的最佳拟合取向。",
            "id": "3835541",
            "problem": "考虑一个三维三聚体分子的刚性粗粒化映射，该映射将全原子坐标简化为质心和单位方向四元数。设该分子由三个等质量的原子 $m_{1} = m_{2} = m_{3}$ 组成，其在体坐标系中的固定参考几何构型由以下位置给出\n$$\n\\mathbf{s}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{s}_{2} = \\begin{pmatrix} -\\tfrac{1}{2} \\\\ \\tfrac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{s}_{3} = \\begin{pmatrix} -\\tfrac{1}{2} \\\\ -\\tfrac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix},\n$$\n满足 $\\sum_{i=1}^{3} m_{i} \\mathbf{s}_{i} = \\mathbf{0}$。在实验室坐标系中，一个观测到的构型由以下原子坐标给出\n$$\n\\mathbf{r}_{1} = \\begin{pmatrix} 1 \\\\ 3 \\\\ 3 \\end{pmatrix}, \\quad\n\\mathbf{r}_{2} = \\begin{pmatrix} 1 - \\tfrac{\\sqrt{3}}{2} \\\\ \\tfrac{3}{2} \\\\ 3 \\end{pmatrix}, \\quad\n\\mathbf{r}_{3} = \\begin{pmatrix} 1 + \\tfrac{\\sqrt{3}}{2} \\\\ \\tfrac{3}{2} \\\\ 3 \\end{pmatrix}.\n$$\n所有坐标的单位均为纳米，质量相等且有限。\n\n任务：\n1. 从第一性原理（刚体运动学、质量加权定义以及三维正交 Procrustes 对齐）出发，明确地构建一个非线性粗粒化映射，该映射将 $\\{\\mathbf{r}_{i}\\}_{i=1}^{3}$ 变换为质心 $\\mathbf{R}$ 和方向单位四元数 $\\mathbf{q} = (q_{0}, q_{1}, q_{2}, q_{3})$（标量优先约定）。此四元数被定义为将 $\\{\\mathbf{s}_{i}\\}_{i=1}^{3}$ 与中心化的实验室坐标 $\\{\\mathbf{r}_{i} - \\mathbf{R}\\}_{i=1}^{3}$ 进行质量加权最小二乘对齐的唯一最大化子（在已知的双重覆盖 $\\mathbf{q} \\sim -\\mathbf{q}$ 意义下）。您的公式必须包括对 $\\mathbf{q}$ 的归一化约束和一个明确的符号约定，以确定四元数等价类的代表元。\n2. 使用您构建的显式映射，计算所提供数据的粗粒化变量。采用 $q_{0} > 0$ 的约定。质心以纳米为单位表示，四元数分量为无量纲数。如果您对根式进行近似，请将最终数值结果四舍五入至四位有效数字；否则，请给出精确值。\n\n将您的最终答案以单行矩阵的形式报告，其中包含七个粗粒化变量，顺序为 $(R_{x}, R_{y}, R_{z}, q_{0}, q_{1}, q_{2}, q_{3})$。",
            "solution": "此问题被评估为具有科学依据、问题明确且客观。它代表了多尺度材料模拟中从刚性分子的原子坐标确定其粗粒化坐标（质心和方向）的标准流程。问题提供了唯一解所需的所有数据和定义。因此，我将进行完整的推导。\n\n粗粒化映射将全原子坐标集 $\\{\\mathbf{r}_{i}\\}_{i=1}^{3}$ 变换为质心向量 $\\mathbf{R}$ 和方向单位四元数 $\\mathbf{q}$。\n\n**1. 粗粒化映射的构建**\n\n**质心 ($\\mathbf{R}$):**\n质心 $\\mathbf{R}$ 是原子位置 $\\mathbf{r}_{i}$ 的质量加权平均值：\n$$\n\\mathbf{R} = \\frac{\\sum_{i=1}^{3} m_{i} \\mathbf{r}_{i}}{\\sum_{i=1}^{3} m_{i}}\n$$\n鉴于质量相等，$m_{1} = m_{2} = m_{3} = m$，该表达式简化为位置向量的算术平均值：\n$$\n\\mathbf{R} = \\frac{m(\\mathbf{r}_{1} + \\mathbf{r}_{2} + \\mathbf{r}_{3})}{3m} = \\frac{1}{3} (\\mathbf{r}_{1} + \\mathbf{r}_{2} + \\mathbf{r}_{3})\n$$\n\n**方向四元数 ($\\mathbf{q}$):**\n方向是通过寻找一个最佳旋转来确定的，该旋转能最好地将中心化的实验室坐标 $\\mathbf{r}'_{i} = \\mathbf{r}_{i} - \\mathbf{R}$ 与参考体坐标系坐标 $\\mathbf{s}_{i}$ 对齐。这可以通过解决正交 Procrustes 问题来实现，该问题涉及最小化质量加权的偏差平方和：\n$$\nL(\\mathbf{Q}) = \\sum_{i=1}^{3} m_{i} \\|\\mathbf{r}'_{i} - \\mathbf{Q} \\mathbf{s}_{i}\\|^{2}\n$$\n其中 $\\mathbf{Q}$ 是一个 $3 \\times 3$ 的正常旋转矩阵（$\\mathbf{Q}^{T}\\mathbf{Q} = \\mathbf{I}$，$\\det(\\mathbf{Q})=1$）。由于所有质量 $m_i$ 都相等且为正，最小化 $L(\\mathbf{Q})$ 等价于最小化 $\\frac{L(\\mathbf{Q})}{m} = \\sum_{i=1}^{3} \\|\\mathbf{r}'_{i} - \\mathbf{Q} \\mathbf{s}_{i}\\|^{2}$。\n\n展开平方范数，我们发现最小化此和等价于最大化项 $\\text{Tr}(\\mathbf{Q} \\mathbf{C})$，其中 $\\mathbf{C}$ 是由下式给出的相关矩阵：\n$$\n\\mathbf{C} = \\sum_{i=1}^{3} \\mathbf{s}_{i} (\\mathbf{r}'_{i})^{T}\n$$\n这个最大化问题的解可以通过对 $\\mathbf{C}$ 进行奇异值分解 (SVD) 来找到。设 $\\mathbf{C}$ 的 SVD 为 $\\mathbf{C} = \\mathbf{U} \\mathbf{\\Sigma} \\mathbf{V}^{T}$，其中 $\\mathbf{U}$ 和 $\\mathbf{V}$ 是正交矩阵，$\\mathbf{\\Sigma}$ 是奇异值对角矩阵。最优旋转矩阵 $\\mathbf{Q}$ 由下式给出：\n$$\n\\mathbf{Q} = \\mathbf{V} \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  \\det(\\mathbf{V}\\mathbf{U}^{T}) \\end{pmatrix} \\mathbf{U}^{T}\n$$\n此公式确保 $\\mathbf{Q}$ 是一个正常旋转，校正了任何可能的反射。\n\n一旦找到最优旋转矩阵 $\\mathbf{Q}$，就使用标量优先约定将其转换为单位四元数 $\\mathbf{q} = (q_{0}, q_{1}, q_{2}, q_{3})$。其分量由以下公式给出：\n$$\n\\begin{aligned}\nq_{0} = \\frac{1}{2} \\sqrt{1 + \\text{Tr}(\\mathbf{Q})} \\\\\nq_{1} = \\frac{Q_{32} - Q_{23}}{4q_{0}} \\\\\nq_{2} = \\frac{Q_{13} - Q_{31}}{4q_{0}} \\\\\nq_{3} = \\frac{Q_{21} - Q_{12}}{4q_{0}}\n\\end{aligned}\n$$\n其中 $Q_{ij}$ 是 $\\mathbf{Q}$ 的元素。问题指定了约定 $q_{0} > 0$，这可以通过为 $q_0$ 取正根来满足。这个选择从等价类 $(\\mathbf{q} \\sim -\\mathbf{q})$ 中确定了四元数的代表元。\n\n**2. 应用于所提供的数据**\n\n**计算质心 $\\mathbf{R}$:**\n使用给定的实验室坐标：\n$$\n\\mathbf{r}_{1} = \\begin{pmatrix} 1 \\\\ 3 \\\\ 3 \\end{pmatrix}, \\quad\n\\mathbf{r}_{2} = \\begin{pmatrix} 1 - \\frac{\\sqrt{3}}{2} \\\\ \\frac{3}{2} \\\\ 3 \\end{pmatrix}, \\quad\n\\mathbf{r}_{3} = \\begin{pmatrix} 1 + \\frac{\\sqrt{3}}{2} \\\\ \\frac{3}{2} \\\\ 3 \\end{pmatrix}\n$$\n$$\n\\mathbf{R} = \\frac{1}{3} \\left( \\begin{pmatrix} 1 \\\\ 3 \\\\ 3 \\end{pmatrix} + \\begin{pmatrix} 1 - \\frac{\\sqrt{3}}{2} \\\\ \\frac{3}{2} \\\\ 3 \\end{pmatrix} + \\begin{pmatrix} 1 + \\frac{\\sqrt{3}}{2} \\\\ \\frac{3}{2} \\\\ 3 \\end{pmatrix} \\right) = \\frac{1}{3} \\begin{pmatrix} 3 \\\\ 6 \\\\ 9 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n质心为 $\\mathbf{R} = (1, 2, 3)$。\n\n**计算中心化坐标 $\\mathbf{r}'_i = \\mathbf{r}_i - \\mathbf{R}$:**\n$$\n\\mathbf{r}'_{1} = \\begin{pmatrix} 1 \\\\ 3 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{r}'_{2} = \\begin{pmatrix} 1 - \\frac{\\sqrt{3}}{2} \\\\ \\frac{3}{2} \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} -\\frac{\\sqrt{3}}{2} \\\\ -\\frac{1}{2} \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{r}'_{3} = \\begin{pmatrix} 1 + \\frac{\\sqrt{3}}{2} \\\\ \\frac{3}{2} \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} \\frac{\\sqrt{3}}{2} \\\\ -\\frac{1}{2} \\\\ 0 \\end{pmatrix}\n$$\n\n**计算相关矩阵 $\\mathbf{C}$:**\n参考坐标为：\n$$\n\\mathbf{s}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{s}_{2} = \\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{s}_{3} = \\begin{pmatrix} -\\frac{1}{2} \\\\ -\\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix}\n$$\n相关矩阵 $\\mathbf{C} = \\sum_{i=1}^{3} \\mathbf{s}_{i} (\\mathbf{r}'_{i})^{T}$ 计算如下：\n$$\n\\mathbf{C} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 0  1  0 \\end{pmatrix} + \\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix} \\begin{pmatrix} -\\frac{\\sqrt{3}}{2}  -\\frac{1}{2}  0 \\end{pmatrix} + \\begin{pmatrix} -\\frac{1}{2} \\\\ -\\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix} \\begin{pmatrix} \\frac{\\sqrt{3}}{2}  -\\frac{1}{2}  0 \\end{pmatrix}\n$$\n$$\n\\mathbf{C} = \\begin{pmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} + \\begin{pmatrix} \\frac{\\sqrt{3}}{4}  \\frac{1}{4}  0 \\\\ -\\frac{3}{4}  -\\frac{\\sqrt{3}}{4}  0 \\\\ 0  0  0 \\end{pmatrix} + \\begin{pmatrix} -\\frac{\\sqrt{3}}{4}  \\frac{1}{4}  0 \\\\ -\\frac{3}{4}  \\frac{\\sqrt{3}}{4}  0 \\\\ 0  0  0 \\end{pmatrix}\n= \\begin{pmatrix} 0  \\frac{3}{2}  0 \\\\ -\\frac{3}{2}  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n\n**对 $\\mathbf{C}$ 进行 SVD 并求出 $\\mathbf{Q}$:**\n设 $\\mathbf{C}$ 的 SVD 为 $\\mathbf{C} = \\mathbf{U} \\mathbf{\\Sigma} \\mathbf{V}^{T}$。这些矩阵是：\n$$\n\\mathbf{U} = \\begin{pmatrix} 0  1  0 \\\\ -1  0  0 \\\\ 0  0  1 \\end{pmatrix}, \\quad\n\\mathbf{\\Sigma} = \\begin{pmatrix} \\frac{3}{2}  0  0 \\\\ 0  \\frac{3}{2}  0 \\\\ 0  0  0 \\end{pmatrix}, \\quad\n\\mathbf{V} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\mathbf{I}\n$$\n我们从计算 $\\mathbf{V}\\mathbf{U}^{T}$ 开始来计算 $\\mathbf{Q}$：\n$$\n\\mathbf{V}\\mathbf{U}^{T} = \\mathbf{I} \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n行列式为 $\\det(\\mathbf{V}\\mathbf{U}^{T}) = 1$。因此，不需要校正。\n$$\n\\mathbf{Q} = \\mathbf{V}\\mathbf{U}^{T} = \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n该旋转矩阵表示绕 z 轴旋转 $+\\frac{\\pi}{2}$ 弧度（$90^\\circ$）。\n\n**将 $\\mathbf{Q}$ 转换为四元数 $\\mathbf{q}$:**\n$\\mathbf{Q}$ 的迹为 $\\text{Tr}(\\mathbf{Q}) = 0 + 0 + 1 = 1$。\n现在我们计算四元数的分量：\n$$\nq_{0} = \\frac{1}{2} \\sqrt{1 + 1} = \\frac{\\sqrt{2}}{2}\n$$\n$$\nq_{1} = \\frac{Q_{32} - Q_{23}}{4q_{0}} = \\frac{0 - 0}{4(\\frac{\\sqrt{2}}{2})} = 0\n$$\n$$\nq_{2} = \\frac{Q_{13} - Q_{31}}{4q_{0}} = \\frac{0 - 0}{4(\\frac{\\sqrt{2}}{2})} = 0\n$$\n$$\nq_{3} = \\frac{Q_{21} - Q_{12}}{4q_{0}} = \\frac{1 - (-1)}{4(\\frac{\\sqrt{2}}{2})} = \\frac{2}{2\\sqrt{2}} = \\frac{1}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2}\n$$\n得到的四元数为 $\\mathbf{q} = (\\frac{\\sqrt{2}}{2}, 0, 0, \\frac{\\sqrt{2}}{2})$。分量 $q_0$ 为正，满足指定的约定。这些值为精确值。\n\n最终的粗粒化变量是质心向量 $\\mathbf{R}$ 和方向四元数 $\\mathbf{q}$ 的分量。\n$\\mathbf{R} = (1, 2, 3)$ nm。\n$\\mathbf{q} = (\\frac{\\sqrt{2}}{2}, 0, 0, \\frac{\\sqrt{2}}{2})$。\n最终答案向量为 $(R_x, R_y, R_z, q_0, q_1, q_2, q_3)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  2  3  \\frac{\\sqrt{2}}{2}  0  0  \\frac{\\sqrt{2}}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在定义了粗粒化变量后，下一步便是确定它们之间的有效相互作用。由于自由度的减少，我们不能直接使用原子间的力场，而必须构建一个能再现原始系统某些关键结构性质（如径向分布函数 $g(r)$）的有效势。本练习  将引导您通过推导一种重要的结构匹配方法——迭代玻尔兹曼反转（Iterative Boltzmann Inversion, IBI）方法的核心更新法则，来深入理解如何从统计力学的基础原理出发构建这种有效势。",
            "id": "3835521",
            "problem": "您正在为一种简单流体开发一种成对粗粒化势，方法是在指定的热力学状态下匹配目标径向分布函数（RDF）。目标是基于每次迭代中粗粒化模拟测得的 RDF，为对势构建一个迭代更新。请在固定温度 $T$ 和数密度 $\\rho$ 的平衡统计力学正则系综框架下进行，并仅使用以下基本事实：\n\n- 径向分布函数 $g(r)$ 是通过正则系综中对间距的平衡平均值定义的，并通过 $W(r) = - k_B T \\ln g(r)$ 决定了平均力势 $W(r)$，其中 $k_B$ 是 Boltzmann 常数。\n- 在足够低的密度下，或在局部线性响应近似下，RDF 对数的变化近似地局部响应于对势的变化，即 $\\delta \\ln g(r) \\approx - \\beta \\, \\delta U(r)$，其中 $\\beta = 1/(k_B T)$。\n- 迭代玻尔兹曼反演（Iterative Boltzmann Inversion, IBI）方法寻求一种迭代方案，当模拟的 RDF 等于目标 RDF 时，该方案使对势保持不变，并朝着减小 $g(r)$ 差异的方向修正势能。\n\n从这些基础出发，并且不引用任何已有的 IBI 公式，推导对势 $U_{n+1}(r)$ 的更新规则，该规则用当前势 $U_n(r)$、使用 $U_n(r)$ 进行模拟得到的测量 RDF $g_n(r)$ 以及相同状态点下的目标 RDF $g_{\\mathrm{target}}(r)$ 来表示。您的推导应明确使用平均力势和局部线性响应近似，并应证明当 $g_n(r) = g_{\\mathrm{target}}(r)$ 时，所得更新为何具有不动点。简要解释在稀疏气体极限下以及在标量局部敏感度 $\\delta \\ln g(r) \\approx - \\beta \\alpha(r) \\, \\delta U(r)$（其中 $0  \\alpha(r)  2$）下，不动点的收敛性质。\n\n作为最终答案，请报告更新步骤 $U_{n+1}(r)$ 的闭合形式解析表达式，用 $U_n(r)$、$g_n(r)$、$g_{\\mathrm{target}}(r)$、$k_B$ 和 $T$ 表示。最终答案中不要包含任何解释性文字或单位。",
            "solution": "所述问题具有科学依据，提法恰当且客观。它基于统计力学和粗粒化理论的既定原则，包含足够的信息以获得唯一解，并且没有歧义或矛盾。因此，我们可以进行完整推导。\n\n目标是为粗粒化对势 $U(r)$ 推导一个迭代更新规则，使得使用该势的模拟所产生的径向分布函数 $g(r)$ 与给定的目标径向分布函数 $g_{\\mathrm{target}}(r)$ 相匹配。推导将在固定温度 $T$ 和数密度 $\\rho$ 的正则系综框架内构建。\n\n设 $U_n(r)$ 为第 $n$ 次迭代时的对势，$g_n(r)$ 是使用 $U_n(r)$ 进行平衡模拟得到的相应径向分布函数。目标是确定一个更新量 $\\Delta U_n(r) = U_{n+1}(r) - U_n(r)$，该更新量在随后的迭代中将 $g_n(r)$ 推向 $g_{\\mathrm{target}}(r)$。\n\n对势与流体结构之间的基本联系由平均力势（PMF）$W(r)$ 提供。PMF 由径向分布函数定义为 $W(r) = -k_B T \\ln g(r)$，其中 $k_B$ 是 Boltzmann 常数。在极低密度下，PMF 与对势相同，$W(r) \\approx U(r)$，因为多体关联效应消失了。这表明，生成 $g_{\\mathrm{target}}(r)$ 的势的第一个近似是相应的 PMF 本身，即 $W_{\\mathrm{target}}(r) = -k_B T \\ln g_{\\mathrm{target}}(r)$。这是 Boltzmann Inversion 方法的基础。\n\n然而，在有限密度下，这种近似并不精确。迭代玻尔兹曼反演（Iterative Boltzmann Inversion, IBI）方法通过在每一步引入一个校正来完善这个思想。我们寻求一个基于当前 RDF $g_n(r)$ 与目标 $g_{\\mathrm{target}}(r)$ 之间差异的更新 $U_{n+1}(r)$。让我们定义当前和目标的 PMF：\n$$W_n(r) = -k_B T \\ln g_n(r)$$\n$$W_{\\mathrm{target}}(r) = -k_B T \\ln g_{\\mathrm{target}}(r)$$\n这两个量之间的差值 $W_n(r) - W_{\\mathrm{target}}(r) = k_B T (\\ln g_{\\mathrm{target}}(r) - \\ln g_n(r))$ 代表了第 $n$ 次迭代时有效相互作用的误差。一个简单的想法是用与此误差相关的量来校正当前势 $U_n(r)$。\n\n为了将其形式化，我们使用给定的局部线性响应近似，它将势的微小变化 $\\delta U(r)$ 与 RDF 对数的相应变化 $\\delta \\ln g(r)$ 联系起来：\n$$\\delta \\ln g(r) \\approx - \\beta \\, \\delta U(r)$$\n其中 $\\beta = 1/(k_B T)$。\n\n我们希望选择一个势更新量 $\\delta U(r) = U_{n+1}(r) - U_n(r)$，它能引起 RDF 的变化 $\\delta \\ln g(r)$，从而消除当前的误差。也就是说，我们期望新的 RDF $g_{n+1}(r)$ 等于 $g_{\\mathrm{target}}(r)$。因此，期望的变化是：\n$$\\delta \\ln g(r) = \\ln g_{\\mathrm{target}}(r) - \\ln g_n(r)$$\n\n将我们期望的变化 $\\delta \\ln g(r)$ 和势更新量 $\\delta U(r)$ 代入线性响应公式，我们得到：\n$$\\ln g_{\\mathrm{target}}(r) - \\ln g_n(r) \\approx - \\beta (U_{n+1}(r) - U_n(r))$$\n\n为了求解下一个势 $U_{n+1}(r)$，我们将此近似关系视为等式来定义迭代步骤：\n$$U_{n+1}(r) - U_n(r) = - \\frac{1}{\\beta} (\\ln g_{\\mathrm{target}}(r) - \\ln g_n(r))$$\n$$U_{n+1}(r) = U_n(r) - k_B T (\\ln g_{\\mathrm{target}}(r) - \\ln g_n(r))$$\n这可以重写为标准的 IBI 更新规则：\n$$U_{n+1}(r) = U_n(r) + k_B T \\ln g_n(r) - k_B T \\ln g_{\\mathrm{target}}(r)$$\n这个表达式可以紧凑地写成 $U_{n+1}(r) = U_n(r) + W_{\\mathrm{target}}(r) - W_n(r)$，这表明势是通过目标 PMF 和当前 PMF 之间的差值来校正的。\n\n为了验证不动点性质，我们假设迭代已经收敛，即 $U_{n+1}(r) = U_n(r) = U^*(r)$。将此代入更新规则得到：\n$$U^*(r) = U^*(r) + k_B T \\ln g^*(r) - k_B T \\ln g_{\\mathrm{target}}(r)$$\n其中 $g^*(r)$ 是由势 $U^*(r)$ 产生的 RDF。该方程可简化为：\n$$0 = k_B T (\\ln g^*(r) - \\ln g_{\\mathrm{target}}(r))$$\n$$\\ln g^*(r) = \\ln g_{\\mathrm{target}}(r)$$\n$$g^*(r) = g_{\\mathrm{target}}(r)$$\n这证实了当且仅当模拟的 RDF 与目标 RDF 匹配时，迭代具有不动点，这正是所要求的。\n\n现在，我们简要解释收敛性质。\n在稀疏气体极限下（$\\rho \\to 0$），多体关联可以忽略不计，RDF 精确地由对势的 Boltzmann 因子给出：$g(r) = \\exp(-\\beta U(r))$。在这种情况下，$\\alpha(r)=1$ 的线性响应近似变得精确。对于当前迭代，$g_n(r) = \\exp(-\\beta U_n(r))$，这意味着 $\\ln g_n(r) = -\\beta U_n(r)$。目标势 $U_{\\mathrm{target}}(r)$ 产生 $g_{\\mathrm{target}}(r)$，所以 $\\ln g_{\\mathrm{target}}(r)=-\\beta U_{\\mathrm{target}}(r)$。将这些代入我们的更新规则：\n$$U_{n+1}(r) = U_n(r) + k_B T (-\\beta U_n(r)) - k_B T (-\\beta U_{\\mathrm{target}}(r))$$\n$$U_{n+1}(r) = U_n(r) - U_n(r) + U_{\\mathrm{target}}(r) = U_{\\mathrm{target}}(r)$$\n这表明，在稀疏气体极限下，无论初始猜测 $U_n(r)$ 是什么，迭代都会在一步内收敛到精确的目标势。\n\n在更一般的局部敏感度 $\\delta \\ln g(r) \\approx - \\beta \\alpha(r) \\, \\delta U(r)$ 下，我们分析不动点的稳定性。设 $U_{\\mathrm{target}}(r)$ 是生成 $g_{\\mathrm{target}}(r)$ 的真实势。设 $\\Delta U_n(r) = U_n(r) - U_{\\mathrm{target}}(r)$ 为第 $n$ 步势的误差。误差的 IBI 更新规则是：\n$$\\Delta U_{n+1}(r) = U_{n+1}(r) - U_{\\mathrm{target}}(r) = \\left(U_n(r) + k_B T (\\ln g_n(r) - \\ln g_{\\mathrm{target}}(r))\\right) - U_{\\mathrm{target}}(r)$$\n$$\\Delta U_{n+1}(r) = \\Delta U_n(r) + k_B T (\\ln g_n(r) - \\ln g_{\\mathrm{target}}(r))$$\n在目标状态附近近似 $\\ln g(r)$ 的变化：\n$$\\ln g_n(r) - \\ln g_{\\mathrm{target}}(r) \\approx - \\beta \\alpha(r) (U_n(r) - U_{\\mathrm{target}}(r)) = -\\beta \\alpha(r) \\Delta U_n(r)$$\n将此代回误差更新方程：\n$$\\Delta U_{n+1}(r) \\approx \\Delta U_n(r) + k_B T (-\\beta \\alpha(r) \\Delta U_n(r))$$\n$$\\Delta U_{n+1}(r) \\approx \\Delta U_n(r) - \\alpha(r) \\Delta U_n(r) = (1 - \\alpha(r)) \\Delta U_n(r)$$\n这表明每一步的误差都乘以一个因子 $(1 - \\alpha(r))$。为了使迭代收敛，该因子的绝对值必须小于 1，即 $|1 - \\alpha(r)|  1$。该不等式当且仅当 $-1  1 - \\alpha(r)  1$ 时成立，可简化为 $0  \\alpha(r)  2$。因此，如果系统的结构响应 $\\alpha(r)$ 在此范围内，IBI 方法就会收敛。如果 $\\alpha(r)$ 超出此范围，简单的 IBI 迭代将不稳定并会发散。",
            "answer": "$$\\boxed{U_{n+1}(r) = U_n(r) + k_B T \\ln\\left(\\frac{g_n(r)}{g_{\\mathrm{target}}(r)}\\right)}$$"
        },
        {
            "introduction": "除了静态结构，理解粗粒化模型的动力学行为也至关重要。将快速运动的原子自由度积分掉，虽然简化了系统，但却在粗粒化变量的运动方程中引入了复杂的记忆效应和随机力，这些都体现在广义朗之万方程（Generalized Langevin Equation, GLE）中。本练习  将引导您探索这些动力学效应，通过分析一个具体的记忆核函数，来量化何时可以将复杂的非马尔可夫动力学简化为更简单的马尔可夫近似，并理解这种近似的适用边界。",
            "id": "3835538",
            "problem": "一个通过将高维原子动力学投影到标量集体坐标上获得的单个粗粒化变量 $q(t)$，服从广义朗之万方程 (GLE)。根据 Mori–Zwanzig 投影算符形式和涨落-耗散定理 (FDT)，该约化动力学可以写作\n$$\nm \\ddot{q}(t) + \\int_{0}^{t} K(t-s)\\,\\dot{q}(s)\\,\\mathrm{d}s + k\\,q(t) = F_{\\mathrm{R}}(t),\n$$\n其中 $m$ 是有效质量，$k$ 是粗粒化谐波刚度，$K(t)$ 是由未解析的自由度决定的记忆核，$F_{\\mathrm{R}}(t)$ 是与 FDT 一致的平稳随机力。记忆核的宽度由正交动力学的退相关时间决定；将此宽度记为快时间尺度 $\\tau_{f}  0$。在马尔可夫过阻尼极限下，粗粒化模式的慢弛豫时间尺度为 $\\tau_{s} = \\gamma/k$，其中 $\\gamma$ 是定义为记忆核积分的摩擦系数。\n\n考虑高摩擦过阻尼区域 $m \\to 0$，并通过设置 $F_{\\mathrm{R}}(t) = 0$ 来关注均值的确定性弛豫。假设记忆核采用科学上标准的参数化形式，通过单指数形式表示弱尺度分离\n$$\nK(t) = \\frac{\\gamma}{\\tau_{f}} \\exp\\!\\Big(-\\frac{t}{\\tau_{f}}\\Big),\n$$\n其积分为 $\\int_{0}^{\\infty} K(t)\\,\\mathrm{d}t = \\gamma$，宽度为 $\\tau_{f}$。使用狄拉克 delta 函数核的马尔可夫闭合将 $K(t)$ 替换为 $K_{\\delta}(t) = \\gamma\\,\\delta(t)$。\n\n基于上述基础，分别确定由非马尔可夫单指数核和马尔可夫 $\\delta$-核闭合所预测的慢弛豫速率。然后，计算马尔可夫预测相对于非马尔可夫预测的相对误差 $E$ 的解析表达式，其定义为\n$$\nE \\equiv \\frac{|\\lambda_{\\delta} - \\lambda_{\\mathrm{NM}}|}{|\\lambda_{\\mathrm{NM}}|},\n$$\n其中 $\\lambda_{\\delta}$ 是在马尔可夫 $\\delta$-核闭合下的弛豫速率，$\\lambda_{\\mathrm{NM}}$ 是在非马尔可夫单指数核下的弛豫速率。您的最终答案必须是 $E$ 关于 $\\tau_{f}$ 和 $\\tau_{s}$ 的单一闭式表达式。无需进行数值评估。仅在相关时说明单位或角度单位；此处不需要。通过将 $E$ 与预设的容差关联，从物理上解释带有 $\\delta$-核摩擦的马尔可夫闭合在何时会失效，但不要在最终答案中包含任何不等式。",
            "solution": "用户提供了一个来自粗粒化建模领域的科学上有效且定义明确的问题陈述。所有必要的定义和方程都已提供，问题没有矛盾或含糊之处。因此，我将继续提供完整解答。\n\n该问题要求我们确定在过阻尼广义朗之万方程 (GLE) 中，粗粒化变量 $q(t)$ 在两种不同的记忆核 $K(t)$ 模型下的慢弛豫速率。在过阻尼极限 ($m \\to 0$) 下，用于均值确定性弛豫的 GLE 由下式给出：\n$$\n\\int_{0}^{t} K(t-s)\\,\\dot{q}(s)\\,\\mathrm{d}s + k\\,q(t) = 0\n$$\n我们将首先分析马尔可夫情况，然后分析非马尔可夫情况，最后计算它们预测的弛豫速率之间的相对误差。\n\n**1. 马尔可夫弛豫速率 ($\\lambda_{\\delta}$)**\n\n马尔可夫近似将记忆核 $K(t)$ 替换为狄拉克 delta 函数，$K_{\\delta}(t) = \\gamma\\,\\delta(t)$，其中 $\\gamma = \\int_{0}^{\\infty} K(t')\\,\\mathrm{d}t'$ 是总摩擦。将此代入 GLE：\n$$\n\\int_{0}^{t} \\gamma\\,\\delta(t-s)\\,\\dot{q}(s)\\,\\mathrm{d}s + k\\,q(t) = 0\n$$\n使用狄拉克 delta 函数的筛选性质，该积分计算结果为 $\\gamma\\,\\dot{q}(t)$：\n$$\n\\gamma\\,\\dot{q}(t) + k\\,q(t) = 0\n$$\n这是一个一阶线性常微分方程。我们寻求形式为 $q(t) = q(0)\\,\\exp(-\\lambda t)$ 的解，该解描述了指数弛豫。将此拟设代入方程可得：\n$$\n\\gamma\\,(-\\lambda\\,q(t)) + k\\,q(t) = 0\n$$\n对于一个非平凡解 ($q(t) \\neq 0$)，速率 $\\lambda$ 必须满足：\n$$\n-\\gamma\\,\\lambda + k = 0\n$$\n解出我们记为 $\\lambda_{\\delta}$ 的弛豫速率，我们发现：\n$$\n\\lambda_{\\delta} = \\frac{k}{\\gamma}\n$$\n问题将慢弛豫时间尺度定义为 $\\tau_s = \\gamma/k$。因此，马尔可夫弛豫速率为：\n$$\n\\lambda_{\\delta} = \\frac{1}{\\tau_s}\n$$\n\n**2. 非马尔可夫弛豫速率 ($\\lambda_{\\mathrm{NM}}$)**\n\n对于非马尔可夫情况，记忆核由单指数形式给出：\n$$\nK(t) = \\frac{\\gamma}{\\tau_{f}} \\exp\\left(-\\frac{t}{\\tau_{f}}\\right)\n$$\n其中 $\\tau_f$ 是记忆退相关时间。主导的积分-微分方程是：\n$$\n\\int_{0}^{t} \\frac{\\gamma}{\\tau_{f}} \\exp\\left(-\\frac{t-s}{\\tau_{f}}\\right)\\,\\dot{q}(s)\\,\\mathrm{d}s + k\\,q(t) = 0\n$$\n这是一个卷积型 Volterra 积分方程。解决此问题的标准方法是将其转换为一个常微分方程组。让我们定义一个辅助变量 $z(t)$ 作为摩擦项：\n$$\nz(t) \\equiv \\int_{0}^{t} \\frac{\\gamma}{\\tau_{f}} \\exp\\left(-\\frac{t-s}{\\tau_{f}}\\right)\\,\\dot{q}(s)\\,\\mathrm{d}s\n$$\nGLE 于是变为 $z(t) + k\\,q(t) = 0$，这意味着 $z(t) = -k\\,q(t)$。对时间求导可得 $\\dot{z}(t) = -k\\,\\dot{q}(t)$。\n\n现在，我们使用莱布尼茨积分法则对 $z(t)$ 的定义进行微分：\n$$\n\\dot{z}(t) = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{0}^{t} K(t-s)\\,\\dot{q}(s)\\,\\mathrm{d}s = K(0)\\,\\dot{q}(t) + \\int_{0}^{t} \\frac{\\partial K(t-s)}{\\partial t}\\,\\dot{q}(s)\\,\\mathrm{d}s\n$$\n对于我们的核，$K(0) = \\gamma/\\tau_f$ 且 $\\frac{\\partial K(t-s)}{\\partial t} = -\\frac{1}{\\tau_f} K(t-s)$。代入这些：\n$$\n\\dot{z}(t) = \\frac{\\gamma}{\\tau_f}\\,\\dot{q}(t) - \\frac{1}{\\tau_f} \\int_{0}^{t} K(t-s)\\,\\dot{q}(s)\\,\\mathrm{d}s = \\frac{\\gamma}{\\tau_f}\\,\\dot{q}(t) - \\frac{1}{\\tau_f} z(t)\n$$\n我们现在有一个包含两个方程的方程组：\n1. $\\dot{z}(t) = -k\\,\\dot{q}(t)$\n2. $\\dot{z}(t) = \\frac{\\gamma}{\\tau_f}\\,\\dot{q}(t) - \\frac{1}{\\tau_f} z(t)$\n\n令 $\\dot{z}(t)$ 的表达式相等，并代入 $z(t) = -k\\,q(t)$：\n$$\n-k\\,\\dot{q}(t) = \\frac{\\gamma}{\\tau_f}\\,\\dot{q}(t) - \\frac{1}{\\tau_f}(-k\\,q(t))\n$$\n重新整理各项，形成关于 $q(t)$ 的单一常微分方程：\n$$\n\\left(k + \\frac{\\gamma}{\\tau_f}\\right)\\dot{q}(t) + \\frac{k}{\\tau_f}\\,q(t) = 0\n$$\n乘以 $\\tau_f$：\n$$\n(k\\,\\tau_f + \\gamma)\\dot{q}(t) + k\\,q(t) = 0\n$$\n这又是一个一阶线性常微分方程。弛豫速率 $\\lambda_{\\mathrm{NM}}$ 可由特征方程求得：\n$$\n(k\\,\\tau_f + \\gamma)(-\\lambda_{\\mathrm{NM}}) + k = 0\n$$\n解出 $\\lambda_{\\mathrm{NM}}$：\n$$\n\\lambda_{\\mathrm{NM}} = \\frac{k}{\\gamma + k\\,\\tau_f}\n$$\n\n**3. 相对误差计算**\n\n马尔可夫预测相对于非马尔可夫预测的相对误差 $E$ 定义为：\n$$\nE \\equiv \\frac{|\\lambda_{\\delta} - \\lambda_{\\mathrm{NM}}|}{|\\lambda_{\\mathrm{NM}}|}\n$$\n由于 $k, \\gamma, \\tau_f  0$，速率 $\\lambda_{\\delta}$ 和 $\\lambda_{\\mathrm{NM}}$ 均为正。同时，$\\gamma + k\\tau_f  \\gamma$，所以 $\\lambda_{\\mathrm{NM}}  \\lambda_\\delta$。分子为正，因此我们可以去掉外层的绝对值。\n$$\nE = \\frac{\\lambda_{\\delta} - \\lambda_{\\mathrm{NM}}}{\\lambda_{\\mathrm{NM}}} = \\frac{\\lambda_{\\delta}}{\\lambda_{\\mathrm{NM}}} - 1\n$$\n代入速率的表达式：\n$$\nE = \\frac{k/\\gamma}{k/(\\gamma + k\\,\\tau_f)} - 1 = \\frac{\\gamma + k\\,\\tau_f}{\\gamma} - 1 = \\left(1 + \\frac{k\\,\\tau_f}{\\gamma}\\right) - 1\n$$\n这简化为：\n$$\nE = \\frac{k\\,\\tau_f}{\\gamma}\n$$\n最后，我们用给定的时间尺度 $\\tau_f$ 和 $\\tau_s = \\gamma/k$ 来表示这个结果。我们注意到 $k/\\gamma = 1/\\tau_s$。\n$$\nE = \\left(\\frac{k}{\\gamma}\\right) \\tau_f = \\frac{\\tau_f}{\\tau_s}\n$$\n\n**物理诠释**\n相对误差 $E = \\tau_f / \\tau_s$ 是快记忆时间尺度 $\\tau_f$ 与慢粗粒化弛豫时间尺度 $\\tau_s$ 的比率。马尔可夫近似假设时间尺度是无限分离的，即与慢变量的演化相比，热库是瞬时退相关的 ($\\tau_f \\to 0$)。我们的结果量化了当这个假设未能被完美满足时所产生的误差。如果为弛豫速率规定了某个相对误差容差，例如 $\\epsilon$，那么当 $E  \\epsilon$ 时，马尔可夫闭合被认为失效，这转化为 $\\tau_f / \\tau_s  \\epsilon$。当记忆持续时间 $\\tau_f$ 成为系统自身弛豫时间 $\\tau_s$ 的一个不可忽略的部分时，这种失效就会发生，这违反了时间尺度分离原则。",
            "answer": "$$\\boxed{\\frac{\\tau_f}{\\tau_s}}$$"
        }
    ]
}