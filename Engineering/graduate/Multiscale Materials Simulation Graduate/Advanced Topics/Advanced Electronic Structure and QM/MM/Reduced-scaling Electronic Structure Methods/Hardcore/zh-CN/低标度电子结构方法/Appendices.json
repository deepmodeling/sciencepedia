{
    "hands_on_practices": [
        {
            "introduction": "减小标度方法之所以高效，其核心在于利用了电子相互作用的“短视性”原理。这意味着许多计算成本高昂的项，例如双电子排斥积分（ERI），其数值实际上是微不足道的，可以在计算早期就被筛选掉。本练习提供了一个简化的动手实践，您将通过应用直接的几何准则，来确定在一个模型系统中哪些积分是重要的，从而亲身体验筛选过程，并对数据稀疏性建立起直观的理解 。",
            "id": "2457312",
            "problem": "考虑一个受线性标度电子结构方法启发的模型筛选程序，该程序应用于方形 $\\mathrm{H}_4$ 团簇，使用由局域化的 $1s$ 原子轨道（AO）组成的最小基组。四个氢原子核固定在笛卡尔坐标（以任意长度单位）$\\mathbf{R}_1=(0,0,0)$、$\\mathbf{R}_2=(L,0,0)$、$\\mathbf{R}_3=(L,L,0)$ 和 $\\mathbf{R}_4=(0,L,0)$ 处，其中 $L>0$。设 $(\\mu\\nu|\\lambda\\sigma)$ 表示化学家记法中的一个双电子库仑排斥积分，该积分作用于以原子核为中心的原子轨道上，原子核索引为 $\\mu,\\nu,\\lambda,\\sigma \\in \\{1,2,3,4\\}$。\n\n你需要将以下纯粹基于距离的筛选规则应用于所有 $(\\mu\\nu|\\lambda\\sigma)$ 的完整有序列表（即所有 $4^4$ 个有序四元组）：\n\n1. 对紧致性条件：对于一对 AO 索引 $(\\mu,\\nu)$，定义中心间距 $d_{\\mu\\nu}=\\|\\mathbf{R}_\\mu-\\mathbf{R}_\\nu\\|$。如果 $d_{\\mu\\nu}\\le r_p$ 且 $r_p=L$，则该对 $(\\mu,\\nu)$ 被认为是紧致的。类似地为 $(\\lambda,\\sigma)$ 定义紧致性。\n\n2. 对质心分离条件：对于一对 $(\\mu,\\nu)$，定义其质心为 $\\mathbf{C}_{\\mu\\nu}=\\tfrac{1}{2}(\\mathbf{R}_\\mu+\\mathbf{R}_\\nu)$。给定两对 $(\\mu,\\nu)$ 和 $(\\lambda,\\sigma)$，定义对质心间距 $D_{\\mu\\nu,\\lambda\\sigma}=\\|\\mathbf{C}_{\\mu\\nu}-\\mathbf{C}_{\\lambda\\sigma}\\|$。仅当 $D_{\\mu\\nu,\\lambda\\sigma}\\le R_c$ 且 $R_c=\\tfrac{L}{2}$ 时，双电子积分 $(\\mu\\nu|\\lambda\\sigma)$ 才被保留。\n\n一个双电子积分 $(\\mu\\nu|\\lambda\\sigma)$ 被筛选保留下来，当且仅当两个对紧致性条件和对质心分离条件都得到满足。按其有序索引 $(\\mu,\\nu,\\lambda,\\sigma)$ 将所有保留的积分作为不同的积分进行计数；不要调用任何置换对称性。\n\n被此筛选规则保留的有序双电子积分 $(\\mu\\nu|\\lambda\\sigma)$ 的总数是多少？请以单个整数形式提供你的答案。无需四舍五入。",
            "solution": "该问题要求我们计算被一个特定的三部分筛选规则保留的有序双电子积分 $(\\mu\\nu|\\lambda\\sigma)$ 的总数，其中索引 $\\mu, \\nu, \\lambda, \\sigma$ 的取值范围均为 1 到 4。一个积分被保留，当且仅当以下所有三个条件都得到满足：\n$1$. 对 $(\\mu,\\nu)$ 是紧致的：$d_{\\mu\\nu} = \\|\\mathbf{R}_\\mu - \\mathbf{R}_\\nu\\| \\le r_p$，其中 $r_p=L$。\n$2$. 对 $(\\lambda,\\sigma)$ 是紧致的：$d_{\\lambda\\sigma} = \\|\\mathbf{R}_\\lambda - \\mathbf{R}_\\sigma\\| \\le r_p$，其中 $r_p=L$。\n$3$. 对质心间距很小：$D_{\\mu\\nu,\\lambda\\sigma} = \\|\\mathbf{C}_{\\mu\\nu} - \\mathbf{C}_{\\lambda\\sigma}\\| \\le R_c$，其中 $R_c = \\frac{L}{2}$。\n\n求解过程遵循一系列逻辑步骤：首先，我们识别出所有满足紧致性条件的原子轨道索引对。其次，我们计算这些紧致对的质心。第三，利用这组紧致对及其质心，我们枚举出所有满足对质心分离条件的对的组合 $((\\mu,\\nu), (\\lambda,\\sigma))$。\n\n四个氢原子核位于 $xy$ 平面内一个正方形的顶点上：$\\mathbf{R}_1=(0,0,0)$、$\\mathbf{R}_2=(L,0,0)$、$\\mathbf{R}_3=(L,L,0)$ 和 $\\mathbf{R}_4=(0,L,0)$。\n\n步骤 1：识别紧致对的集合 $S_p$。\n我们必须找到所有有序对 $(\\mu,\\nu)$，使得距离 $d_{\\mu\\nu} = \\|\\mathbf{R}_\\mu - \\mathbf{R}_\\nu\\|$ 小于或等于 $L$。让我们计算相关的距离平方 $d_{\\mu\\nu}^2$：\n- 对于 $\\mu=\\nu$：$d_{\\mu\\mu}^2 = 0$。距离为 $d_{\\mu\\mu}=0$。由于 $0 \\le L$，所有 4 个形式为 $(\\mu,\\mu)$ 的对都是紧致的：$(1,1), (2,2), (3,3), (4,4)$。\n- 对于相邻原子核（正方形的边）：$d_{12}^2 = L^2$, $d_{23}^2 = L^2$, $d_{34}^2 = L^2$, $d_{41}^2 = L^2$。在这些情况下，距离为 $d_{\\mu\\nu}=L$。由于 $L \\le L$，这些对是紧致的。这给了我们 $(1,2), (2,1), (2,3), (3,2), (3,4), (4,3), (4,1), (1,4)$ 这些对，总共 8 对。\n- 对于相对的原子核（正方形的对角线）：$d_{13}^2 = L^2+L^2 = 2L^2$ 且 $d_{24}^2 = L^2+L^2 = 2L^2$。距离为 $d_{\\mu\\nu}=L\\sqrt{2}$。由于 $L\\sqrt{2} > L$（因为 $L>0$），这些对不是紧致的。\n\n因此，紧致对的集合 $S_p$ 由 $4+8=12$ 对组成：\n$S_p = \\{ (1,1), (2,2), (3,3), (4,4), (1,2), (2,1), (2,3), (3,2), (3,4), (4,3), (1,4), (4,1) \\}$。\n\n步骤 2：确定所有紧致对的质心。\n一对 $(\\mu,\\nu)$ 的质心为 $\\mathbf{C}_{\\mu\\nu} = \\frac{1}{2}(\\mathbf{R}_\\mu + \\mathbf{R}_\\nu)$。我们发现对应于紧致对的质心有两种不同类型：\n- 对于形式为 $(\\mu,\\mu)$ 的对，质心是原子核本身的位置：$\\mathbf{C}_{\\mu\\mu} = \\mathbf{R}_\\mu$。这些是正方形的 4 个顶点，我们称之为“顶点质心”。\n    - $\\mathbf{C}_{11} = (0,0,0)$\n    - $\\mathbf{C}_{22} = (L,0,0)$\n    - $\\mathbf{C}_{33} = (L,L,0)$\n    - $\\mathbf{C}_{44} = (0,L,0)$\n    每个顶点质心恰好对应 1 个紧致对。\n- 对于相邻原子核对 $(\\mu,\\nu)$，质心是连接它们的边的中点。注意 $\\mathbf{C}_{\\mu\\nu} = \\mathbf{C}_{\\nu\\mu}$。这些是正方形 4 条边的中点，我们称之为“中点质心”。\n    - $\\mathbf{C}_{12} = \\mathbf{C}_{21} = (\\frac{L}{2}, 0, 0)$\n    - $\\mathbf{C}_{23} = \\mathbf{C}_{32} = (L, \\frac{L}{2}, 0)$\n    - $\\mathbf{C}_{34} = \\mathbf{C}_{43} = (\\frac{L}{2}, L, 0)$\n    - $\\mathbf{C}_{41} = \\mathbf{C}_{14} = (0, \\frac{L}{2}, 0)$\n    每个中点质心恰好对应 2 个紧致对。\n\n步骤 3：应用对质心分离条件并计数积分。\n保留的积分总数 $N$ 是对所有初始紧致对 $(\\mu,\\nu) \\in S_p$ 进行求和，求和的项是满足 $\\|\\mathbf{C}_{\\mu\\nu} - \\mathbf{C}_{\\lambda\\sigma}\\| \\le \\frac{L}{2}$ 的最终紧致对 $(\\lambda,\\sigma) \\in S_p$ 的数量。\n让我们分析质心之间的距离。\n- 一个相邻的顶点质心和中点质心之间的距离，例如 $\\|\\mathbf{C}_{11} - \\mathbf{C}_{12}\\| = \\|(0,0,0) - (\\frac{L}{2},0,0)\\| = \\frac{L}{2}$。这个距离满足条件。根据对称性，任何顶点质心与其两个相邻的中点质心之间的距离都是 $\\frac{L}{2}$。\n- 任何两个不同顶点质心之间的距离至少为 $L$，大于 $\\frac{L}{2}$。\n- 任何两个不同中点质心之间的距离至少为 $\\frac{L\\sqrt{2}}{2} \\approx 0.707L$，大于 $\\frac{L}{2}$。\n- 一个质心到其自身的距离为 0，满足条件。\n\n因此，一个给定的质心 $\\mathbf{C}$ 只与它自身以及质心集合中的最近邻“相连”（即满足分离条件）。具体来说：\n- 一个顶点质心与它自身及其 2 个相邻的中点质心相连。\n- 一个中点质心与它自身及其 2 个相邻的顶点质心相连。\n\n我们现在可以通过考虑两种类型的初始对 $(\\mu,\\nu)$ 来计算积分总数。\n\n情况 A：初始对 $(\\mu,\\nu)$ 具有顶点质心。\n在 $S_p$ 中有 4 个这样的对：$(1,1), (2,2), (3,3), (4,4)$。让我们考虑 $(\\mu,\\nu)=(1,1)$，其质心为 $\\mathbf{C}_{11}=(0,0,0)$。最终对 $(\\lambda,\\sigma)$ 的质心必须在 $\\mathbf{C}_{11}$ 的 $\\frac{L}{2}$ 距离内。这些质心是 $\\mathbf{C}_{11}$ 本身，以及相邻的中点质心 $\\mathbf{C}_{12}$ 和 $\\mathbf{C}_{41}$。\n- 质心为 $\\mathbf{C}_{11}$ 的对的数量：1 对，即 $(1,1)$。\n- 质心为 $\\mathbf{C}_{12}$ 的对的数量：2 对，即 $(1,2)$ 和 $(2,1)$。\n- 质心为 $\\mathbf{C}_{41}$ 的对的数量：2 对，即 $(1,4)$ 和 $(4,1)$。\n对于一个具有顶点质心的初始对，有 $1+2+2=5$ 个有效的最终对。\n由于有 4 个这样的初始对，这部分对总数的贡献为 $4 \\times 5 = 20$。\n\n情况 B：初始对 $(\\mu,\\nu)$ 具有中点质心。\n在 $S_p$ 中有 8 个这样的对。让我们考虑 $(\\mu,\\nu)=(1,2)$，其质心为 $\\mathbf{C}_{12}=(\\frac{L}{2},0,0)$。最终对 $(\\lambda,\\sigma)$ 的质心必须在 $\\mathbf{C}_{12}$ 的 $\\frac{L}{2}$ 距离内。这些质心是 $\\mathbf{C}_{12}$ 本身，以及相邻的顶点质心 $\\mathbf{C}_{11}$ 和 $\\mathbf{C}_{22}$。\n- 质心为 $\\mathbf{C}_{12}$ 的对的数量：2 对，即 $(1,2)$ 和 $(2,1)$。\n- 质心为 $\\mathbf{C}_{11}$ 的对的数量：1 对，即 $(1,1)$。\n- 质心为 $\\mathbf{C}_{22}$ 的对的数量：1 对，即 $(2,2)$。\n对于一个具有中点质心的初始对，有 $2+1+1=4$ 个有效的最终对。\n由于有 8 个这样的初始对，这部分对总数的贡献为 $8 \\times 4 = 32$。\n\n最后，保留的积分总数是两种情况贡献的总和。\n$N = 20 + 32 = 52$。",
            "answer": "$$\n\\boxed{52}\n$$"
        },
        {
            "introduction": "通过截断轨道或矩阵元素来强制实现稀疏性是一种近似，它可能会破坏量子化学中的基本物理约束。例如，电子数守恒和通过密度矩阵的幂等性来体现的泡利不相容原理可能会被违反。本练习旨在引导您完成一项严谨的分析任务：首先，量化截断一个原子轨道所引入的误差（范数亏损）；其次，设计一个校正方案，以恢复这些因近似而受损的关键物理性质 。",
            "id": "3791707",
            "problem": "在多尺度材料模拟中，线性标度电子结构方法通常对定域轨道施加有限空间支持，以降低计算成本。考虑一个三维空间中归一化的Slater型$s$轨道，其形式为 $\\chi(\\mathbf{r}) = N \\exp(-\\zeta r)$，其中 $r = |\\mathbf{r}|$ 且 $\\zeta > 0$ 是衰减参数。该归一化轨道满足 $\\int_{\\mathbb{R}^{3}} |\\chi(\\mathbf{r})|^{2} \\, d^{3}\\mathbf{r} = 1$。定义截断轨道为 $\\chi_{R}(\\mathbf{r}) = \\chi(\\mathbf{r}) W_{R}(\\mathbf{r})$，其中 $W_{R}(\\mathbf{r})$ 是以原点为中心、半径为 $R$ 的球体的指示函数，即当 $r \\leq R$ 时 $W_{R}(\\mathbf{r}) = 1$，否则 $W_{R}(\\mathbf{r}) = 0$。由截断引起的模长亏损为 $\\varepsilon_{N}(R) = 1 - \\int_{|\\mathbf{r}| \\leq R} |\\chi(\\mathbf{r})|^{2} \\, d^{3}\\mathbf{r}$。\n\n首先，从归一化定义出发，推导 $\\varepsilon_{N}(R)$ 关于 $\\zeta$ 和 $R$ 的闭式表达式。\n\n接下来，考虑一个最小非正交定域基 $\\{ \\chi_{1}, \\chi_{2} \\}$，其中单个电子占据由 $\\chi_{1}$ 张成的子空间。在此基下，单电子密度核 $K$ 表示为矩阵 $K = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$。截断到有限支持域 $R$ 后，重叠矩阵变为 $S_{R}$，其矩阵元为 $S_{ij}(R) = \\langle \\chi_{i,R} | \\chi_{j,R} \\rangle$。在非正交基中，密度算符的幂等性意味着 $K S_{R} K = K$，电子数守恒意味着 $\\operatorname{Tr}(K S_{R}) = 1$。提出一个标量重缩放方案 $K' = \\alpha(R) K$，使得在有限支持域下，幂等性和归一化条件同时满足，并利用你得到的 $\\varepsilon_{N}(R)$ 表达式，推导 $\\alpha(R)$ 的闭式解。\n\n请以 $\\zeta$ 和 $R$ 表示的单个闭式解析表达式的形式给出 $\\alpha(R)$ 的最终答案。无需进行数值计算。不要包含任何单位。如果发现多种等价形式，请给出最简的精确形式。最终答案必须是单个表达式。",
            "solution": "该问题要求两个量：首先，截断Slater型轨道的模长亏损 $\\varepsilon_{N}(R)$ 的闭式表达式；其次，为使密度核在此截断下保持幂等性和归一化所需的标量重缩放因子 $\\alpha(R)$。解题过程将相应地分为两部分。\n\n第一部分：推导模长亏损 $\\varepsilon_{N}(R)$。\n\nSlater型$s$轨道由 $\\chi(\\mathbf{r}) = N \\exp(-\\zeta r)$ 给出，其中 $r=|\\mathbf{r}|$。归一化条件为 $\\int_{\\mathbb{R}^{3}} |\\chi(\\mathbf{r})|^{2} \\, d^{3}\\mathbf{r} = 1$。我们首先确定归一化常数 $N$。该积分最好在球坐标中计算，其中 $d^{3}\\mathbf{r} = r^{2}\\sin\\theta \\, dr \\, d\\theta \\, d\\phi$。\n\n轨道的模平方为 $|\\chi(\\mathbf{r})|^2 = N^2 \\exp(-2\\zeta r)$。归一化积分变为：\n$$ \\int_{\\mathbb{R}^{3}} N^{2} \\exp(-2\\zeta r) \\, d^{3}\\mathbf{r} = N^{2} \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\pi} \\sin\\theta \\, d\\theta \\int_{0}^{\\infty} r^{2} \\exp(-2\\zeta r) \\, dr = 1 $$\n角度积分的结果是一个因子 $4\\pi$。径向积分是与Gamma函数相关的标准形式：$\\int_{0}^{\\infty} x^n \\exp(-ax) \\, dx = \\frac{n!}{a^{n+1}}$。对于 $n=2$ 和 $a=2\\zeta$，我们有：\n$$ \\int_{0}^{\\infty} r^{2} \\exp(-2\\zeta r) \\, dr = \\frac{2!}{(2\\zeta)^{3}} = \\frac{2}{8\\zeta^{3}} = \\frac{1}{4\\zeta^{3}} $$\n将此结果代入归一化方程：\n$$ N^{2} (4\\pi) \\left(\\frac{1}{4\\zeta^{3}}\\right) = 1 \\implies \\frac{\\pi N^{2}}{\\zeta^{3}} = 1 \\implies N^{2} = \\frac{\\zeta^{3}}{\\pi} $$\n接下来，我们计算半径为 $R$ 的球体内的模长，记为 $I_R$：\n$$ I_R = \\int_{|\\mathbf{r}| \\leq R} |\\chi(\\mathbf{r})|^{2} \\, d^{3}\\mathbf{r} = N^{2} \\int_{0}^{R} 4\\pi r^2 \\exp(-2\\zeta r) \\, dr $$\n我们必须计算定积分 $\\int_{0}^{R} r^{2} \\exp(-2\\zeta r) \\, dr$。使用两次分部积分法，我们求得不定积分为：\n$$ \\int r^{2} \\exp(-2\\zeta r) \\, dr = -\\exp(-2\\zeta r) \\left( \\frac{r^{2}}{2\\zeta} + \\frac{r}{2\\zeta^{2}} + \\frac{1}{4\\zeta^{3}} \\right) $$\n计算其在 $0$ 到 $R$ 上的定积分：\n$$ \\int_{0}^{R} r^{2} \\exp(-2\\zeta r) \\, dr = \\left[ -\\exp(-2\\zeta r) \\left( \\frac{r^{2}}{2\\zeta} + \\frac{r}{2\\zeta^{2}} + \\frac{1}{4\\zeta^{3}} \\right) \\right]_{0}^{R} $$\n$$ = \\left( -\\exp(-2\\zeta R) \\left( \\frac{R^{2}}{2\\zeta} + \\frac{R}{2\\zeta^{2}} + \\frac{1}{4\\zeta^{3}} \\right) \\right) - \\left( -\\exp(0) \\left( 0 + 0 + \\frac{1}{4\\zeta^{3}} \\right) \\right) $$\n$$ = \\frac{1}{4\\zeta^{3}} - \\exp(-2\\zeta R) \\left( \\frac{R^{2}}{2\\zeta} + \\frac{R}{2\\zeta^{2}} + \\frac{1}{4\\zeta^{3}} \\right) = \\frac{1}{4\\zeta^{3}} \\left[ 1 - \\exp(-2\\zeta R) \\left( 1 + 2\\zeta R + 2\\zeta^{2} R^{2} \\right) \\right] $$\n现在，我们将此结果以及 $N^2 = \\zeta^3/\\pi$ 代回到 $I_R$ 的表达式中：\n$$ I_R = \\left(\\frac{\\zeta^{3}}{\\pi}\\right) (4\\pi) \\left( \\frac{1}{4\\zeta^{3}} \\left[ 1 - \\exp(-2\\zeta R) \\left( 1 + 2\\zeta R + 2\\zeta^{2} R^{2} \\right) \\right] \\right) $$\n$$ I_R = 1 - \\exp(-2\\zeta R) (1 + 2\\zeta R + 2\\zeta^{2} R^{2}) $$\n模长亏损定义为 $\\varepsilon_{N}(R) = 1 - I_R$。因此，第一个要求的表达式是：\n$$ \\varepsilon_{N}(R) = \\exp(-2\\zeta R) (1 + 2\\zeta R + 2\\zeta^{2} R^{2}) $$\n\n第二部分：推导重缩放因子 $\\alpha(R)$。\n\n给定一个最小基 $\\{\\chi_{1}, \\chi_{2}\\}$ 和一个单电子密度核 $K = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$。基轨道被截断到支持域半径 $R$，产生截断轨道 $\\chi_{i,R}$ 和截断重叠矩阵 $S_R$，其矩阵元为 $S_{ij}(R) = \\langle \\chi_{i,R} | \\chi_{j,R} \\rangle$。我们寻求一个重缩放的密度核 $K' = \\alpha(R) K$，使其满足幂等性条件 $K'S_R K' = K'$ 和归一化条件 $\\operatorname{Tr}(K'S_R) = 1$。\n\n让我们用 $K' = \\alpha K$ 来分析这两个条件：\n1.  幂等性：$(\\alpha K) S_R (\\alpha K) = \\alpha K \\implies \\alpha^{2} K S_R K = \\alpha K$。假设 $\\alpha \\neq 0$，这可以简化为 $\\alpha K S_R K = K$。\n2.  归一化：$\\operatorname{Tr}(\\alpha K S_R) = 1 \\implies \\alpha \\operatorname{Tr}(K S_R) = 1$。这给出 $\\alpha = \\frac{1}{\\operatorname{Tr}(K S_R)}$。\n\n让我们使用给定的 $K$ 的形式来计算矩阵乘积：\n$$ K S_R = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} S_{11}  S_{12} \\\\ S_{21}  S_{22} \\end{pmatrix} = \\begin{pmatrix} S_{11}  S_{12} \\\\ 0  0 \\end{pmatrix} $$\n迹为 $\\operatorname{Tr}(K S_R) = S_{11}$。根据归一化条件，我们得到 $\\alpha(R) = \\frac{1}{S_{11}(R)}$。\n\n现在我们来检查与幂等性条件的一致性。该条件变为 $\\frac{1}{S_{11}(R)} K S_R K = K$，这要求 $K S_R K = S_{11}(R) K$。我们来计算左边：\n$$ K S_R K = \\begin{pmatrix} S_{11}  S_{12} \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} S_{11}  0 \\\\ 0  0 \\end{pmatrix} $$\n右边是：\n$$ S_{11}(R) K = S_{11} \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} S_{11}  0 \\\\ 0  0 \\end{pmatrix} $$\n两边是相同的，因此条件是一致的，并且都得出 $\\alpha(R) = \\frac{1}{S_{11}(R)}$。\n\n$S_{11}(R)$ 项是截断轨道 $\\chi_{1,R}$ 的自重叠：\n$$ S_{11}(R) = \\langle \\chi_{1,R} | \\chi_{1,R} \\rangle = \\int_{\\mathbb{R}^3} |\\chi_{1,R}(\\mathbf{r})|^2 \\, d^3\\mathbf{r} = \\int_{|\\mathbf{r}| \\leq R} |\\chi_1(\\mathbf{r})|^2 \\, d^3\\mathbf{r} $$\n问题背景意味着轨道 $\\chi_1$ 是前述通用Slater型轨道 $\\chi(\\mathbf{r})$ 的一个实例。因此，$S_{11}(R)$ 的积分与第一部分中计算的 $I_R$ 的积分是相同的。\n$$ S_{11}(R) = I_R = 1 - \\exp(-2\\zeta R) (1 + 2\\zeta R + 2\\zeta^{2} R^{2}) $$\n问题要求使用 $\\varepsilon_N(R)$ 的表达式来推导 $\\alpha(R)$。我们有 $S_{11}(R) = I_R$ 和 $\\varepsilon_N(R) = 1 - I_R$，这意味着 $S_{11}(R) = 1 - \\varepsilon_N(R)$。\n因此，重缩放因子是：\n$$ \\alpha(R) = \\frac{1}{S_{11}(R)} = \\frac{1}{1 - \\varepsilon_N(R)} $$\n将推导出的 $\\varepsilon_N(R)$ 表达式代入：\n$$ \\alpha(R) = \\frac{1}{1 - \\exp(-2\\zeta R) (1 + 2\\zeta R + 2\\zeta^{2} R^{2})} $$\n这就是 $\\alpha(R)$ 关于 $\\zeta$ 和 $R$ 的最终闭式表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{1 - \\exp(-2\\zeta R) (1 + 2\\zeta R + 2\\zeta^{2} R^{2})}}\n$$"
        },
        {
            "introduction": "在实际的计算模拟中，我们不仅需要应用近似方法，还需要可靠地估计它们所引入的误差。本练习作为一个计算项目，将这些概念融会贯通，您将对一个模型哈密顿量实现密度矩阵的稀疏近似。您的核心任务是数值验证一个“后验”误差界，该误差界将总能量的误差与系统的谱隙以及近似密度矩阵与哈密顿量对易的失败程度联系起来。这项实践突显了在控制近似误差时，物理性质（如能隙）与数值产物（如对易子残差）之间的相互作用 。",
            "id": "2457291",
            "problem": "给定一个实对称矩阵 $H \\in \\mathbb{R}^{n \\times n}$（可看作单粒子哈密顿量）和一个费米能级 $\\mu \\in \\mathbb{R}$。在零温下，对于 $\\mu$ 附近有带隙的谱，基态密度矩阵 $P^\\star \\in \\mathbb{R}^{n \\times n}$ 是 $H$ 的谱投影算子，它投影到由特征值严格小于 $\\mu$ 的特征向量所张成的不变子空间上。通过将 $P^\\star$ 中所有满足 $|i-j| > r$ 的元素 $(i,j)$ 置零，可以得到一个严格稀疏近似 $P_s$。这里 $r \\in \\mathbb{Z}_{\\ge 0}$ 是一个预设的半带宽，索引从 $0$ 计数到 $n-1$。因强制施加严格稀疏性而引起的精确能带能量误差定义为\n$$\nE_{\\mathrm{err}} \\;=\\; \\left|\\mathrm{Tr}\\!\\left(H\\,(P^\\star - P_s)\\right)\\right|.\n$$\n假设 $H$ 的谱在 $\\mu$ 附近有一个非零带隙 $\\gamma > 0$，定义为\n$$\n\\gamma \\;=\\; \\min\\{\\lambda \\in \\sigma(H) \\,:\\, \\lambda > \\mu\\} \\;-\\; \\max\\{\\lambda \\in \\sigma(H) \\,:\\, \\lambda < \\mu\\}.\n$$\n定义残差对易子 $R = [H,P_s] = H P_s - P_s H$ 和弗罗贝尼乌斯范数 $\\|A\\|_F = \\sqrt{\\mathrm{Tr}(A^\\top A)}$。考虑以下用于能带能量误差的后验误差估计量：\n$$\n\\mathcal{B} \\;=\\; \\frac{\\|H\\|_F}{\\gamma}\\,\\|[H,P_s]\\|_F.\n$$\n\n你的任务是编写一个程序，对下面定义的每个测试用例，构建 $H$，计算 $P^\\star$，根据给定的 $r$ 按严格稀疏性规则构成 $P_s$，评估精确能带能量误差 $E_{\\mathrm{err}}$，计算 $\\mu$ 附近的谱带隙 $\\gamma$，评估估计量 $\\mathcal{B}$，并返回这两个值以及一个布尔值，该布尔值指示是否在数值容差范围内满足该界限。\n\n测试套件和构建细节：\n- 对每个测试，使用一个长度为 $n$、具有开放边界条件的一维紧束缚链，其定义如下：\n  - 在位势：若 $i$ 为偶数，则 $H_{ii} = \\Delta$；若 $i$ 为奇数，则 $H_{ii} = -\\Delta$，$i \\in \\{0,1,\\dots,n-1\\}$。\n  - 最近邻跃迁：$H_{i,i+1} = H_{i+1,i} = t$，$i \\in \\{0,1,\\dots,n-2\\}$。\n- 设置费米能级为 $\\mu = 0$。\n- 将 $P^\\star$ 构建为 $H$ 的谱投影算子，投影到特征值严格小于 $\\mu$ 的特征向量上。\n- 通过设置 $(P_s)_{ij} = (P^\\star)_{ij}$（如果 $|i-j| \\le r$）和 $(P_s)_{ij} = 0$（其他情况）来构建 $P_s$。\n- 计算 $E_{\\mathrm{err}} = \\left|\\mathrm{Tr}\\!\\left(H\\,(P^\\star - P_s)\\right)\\right|$。\n- 计算谱带隙 $\\gamma$，即 $H$ 的严格大于 $\\mu$ 的最小特征值与严格小于 $\\mu$ 的最大特征值之差。\n- 计算 $\\mathcal{B} = \\dfrac{\\|H\\|_F}{\\gamma}\\,\\|[H,P_s]\\|_F$。\n- 定义一个布尔值 $\\mathrm{ok}$，如果 $E_{\\mathrm{err}} \\le \\mathcal{B} + 10^{-12}$，则其为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。\n\n使用以下参数集 $(n,t,\\Delta,r)$:\n- 测试 $1$: $(n,t,\\Delta,r) = (8,-1.0,1.0,1)$。\n- 测试 $2$: $(n,t,\\Delta,r) = (8,-1.0,1.0,7)$。\n- 测试 $3$: $(n,t,\\Delta,r) = (8,-1.0,0.2,1)$。\n- 测试 $4$: $(n,t,\\Delta,r) = (8,-1.0,1.0,0)$。\n\n不涉及角度单位。不需要物理单位；所有量均为无量纲。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序如下：\n$$\n\\big[E_{\\mathrm{err}}^{(1)},\\, \\mathcal{B}^{(1)},\\, \\mathrm{ok}^{(1)},\\, E_{\\mathrm{err}}^{(2)},\\, \\mathcal{B}^{(2)},\\, \\mathrm{ok}^{(2)},\\, E_{\\mathrm{err}}^{(3)},\\, \\mathcal{B}^{(3)},\\, \\mathrm{ok}^{(3)},\\, E_{\\mathrm{err}}^{(4)},\\, \\mathcal{B}^{(4)},\\, \\mathrm{ok}^{(4)}\\big].\n$$\n所有浮点输出必须四舍五入到六位小数。布尔值必须打印为 $\\mathrm{True}$ 或 $\\mathrm{False}$，不带引号。",
            "solution": "所提出的问题是电子结构理论领域内一个有效的计算任务。它要求对因密度矩阵的稀疏近似而产生的能带能量的一个假定的后验误差界进行数值验证。所有术语，包括哈密顿模型、密度矩阵及其近似、误差度量和误差估计量，都定义明确，并基于量子力学和数值线性代数的标准原理。该问题是自洽的、客观的，并且在计算上是可行的。我们现在将着手进行一个有原则的求解。\n\n目标是为一个简化的量子体系计算精确的能带能量误差 $E_{\\mathrm{err}}$ 和一个提议的误差估计量 $\\mathcal{B}$，并验证不等式 $E_{\\mathrm{err}} \\le \\mathcal{B}$ 是否成立。\n\n该体系是一个长度为 $n$、具有开放边界条件的一维紧束缚链。其无相互作用的电子结构由一个单粒子哈密顿矩阵 $H \\in \\mathbb{R}^{n \\times n}$ 描述。该矩阵的元素定义如下：\n$$\nH_{ij} =\n\\begin{cases}\n    (-1)^i \\Delta  & \\text{if } i = j \\\\\n    t  & \\text{if } |i-j| = 1 \\\\\n    0  & \\text{otherwise}\n\\end{cases}\n$$\n其中 $i, j \\in \\{0, 1, \\dots, n-1\\}$。参数 $\\Delta$ 表示交错在位势，$t$ 是最近邻跃迁积分。该哈密顿量是一个实对称矩阵。\n\n根据谱定理，$H$ 可以被对角化为 $H = V \\Lambda V^\\top$，其中 $\\Lambda$ 是由实特征值 $\\lambda_k$ 构成的对角矩阵，$V$ 是一个正交矩阵，其列向量 $\\mathbf{v}_k$ 是对应的特征向量。因此，$H \\mathbf{v}_k = \\lambda_k \\mathbf{v}_k$。\n\n在零温下，电子占据费米能级 $\\mu$ 以下的所有能态。基态投影算子，也称为密度矩阵 $P^\\star$，是投影到由特征值小于 $\\mu$ 的特征向量所张成的子空间上的谱投影算子。在数学上，这表示为：\n$$\nP^\\star = \\sum_{k : \\lambda_k < \\mu} \\mathbf{v}_k \\mathbf{v}_k^\\top\n$$\n这个矩阵 $P^\\star$ 是幂等的（$ (P^\\star)^2 = P^\\star $）并与哈密顿量对易（$[H, P^\\star] = 0$）。占据态的总能量，即能带能量，是 $E_{\\mathrm{band}} = \\mathrm{Tr}(H P^\\star) = \\sum_{k : \\lambda_k < \\mu} \\lambda_k$。\n\n在线性标度电子结构方法中，密度矩阵 $P^\\star$ 通常被近似为一个稀疏矩阵以降低计算成本。该问题通过应用基于半带宽 $r$ 的硬截断来定义一个严格稀疏近似 $P_s$：\n$$\n(P_s)_{ij} =\n\\begin{cases}\n    (P^\\star)_{ij}  & \\text{if } |i-j| \\le r \\\\\n    0  & \\text{if } |i-j| > r\n\\end{cases}\n$$\n这种截断破坏了幂等性以及与 $H$ 的对易性。由此近似引起的能带能量误差定义为：\n$$\nE_{\\mathrm{err}} = \\left| \\mathrm{Tr}(H P^\\star) - \\mathrm{Tr}(H P_s) \\right| = \\left|\\mathrm{Tr}\\left(H\\,(P^\\star - P_s)\\right)\\right|\n$$\n\n该问题为 $E_{\\mathrm{err}}$ 提出了一个后验误差估计量 $\\mathcal{B}$。该估计量由无需知道精确解 $P^\\star$ 即可计算的量构成。然而，在这个问题中，$\\mathcal{B}$ 的公式依赖于 $\\gamma$，而计算 $\\gamma$ 需要完全对角化。该估计量为：\n$$\n\\mathcal{B} = \\frac{\\|H\\|_F}{\\gamma} \\|[H, P_s]\\|_F\n$$\n此处，$\\|A\\|_F = \\sqrt{\\mathrm{Tr}(A^\\top A)}$ 是弗罗贝尼乌斯范数。项 $[H, P_s] = H P_s - P_s H$ 是残差对易子；其范数衡量了 $P_s$ 未能表示 $H$ 的一个不变子空间的程度。量 $\\gamma$ 是围绕费米能级 $\\mu$ 的谱带隙，定义为最低未占态与最高已占态之间的能量差：\n$$\n\\gamma = \\min\\{\\lambda \\in \\sigma(H) \\,:\\, \\lambda > \\mu\\} - \\max\\{\\lambda \\in \\sigma(H) \\,:\\, \\lambda < \\mu\\}\n$$\n一个非零带隙 $\\gamma > 0$ 对于投影算子的稳定性以及确保此类界限定义良好至关重要。因子 $1/\\gamma$ 表明，对于带隙较小的体系，误差会更大，这是固态物理学中的一个关键原理。\n\n每个测试用例 $(n, t, \\Delta, r)$ 的计算步骤如下：\n1. 构建 $n \\times n$ 的哈密顿矩阵 $H$，其中 $\\mu=0$。\n2. 求解特征值问题 $H \\mathbf{v}_k = \\lambda_k \\mathbf{v}_k$，找到所有特征值 $\\lambda_k$ 和特征向量 $\\mathbf{v}_k$。\n3. 识别低于 $\\mu=0$ 和高于 $\\mu=0$ 的特征值。计算谱带隙 $\\gamma$。\n4. 根据对应于特征值 $\\lambda_k < 0$ 的特征向量构建精确密度矩阵 $P^\\star$。\n5. 通过仅保留 $|i-j| \\le r$ 的元素 $(P^\\star)_{ij}$ 来构建稀疏近似 $P_s$。\n6. 计算精确能带能量误差 $E_{\\mathrm{err}} = \\left|\\mathrm{Tr}\\left(H\\,(P^\\star - P_s)\\right)\\right|$。\n7. 计算哈密顿量的弗罗贝尼乌斯范数 $\\|H\\|_F$。\n8. 计算残差对易子 $R = [H, P_s]$ 及其弗罗贝尼乌斯范数 $\\|R\\|_F$。\n9. 计算估计量 $\\mathcal{B} = (\\|H\\|_F / \\gamma) \\|R\\|_F$。\n10. 验证不等式 $E_{\\mathrm{err}} \\le \\mathcal{B} + \\epsilon$ 是否对一个小的容差 $\\epsilon = 10^{-12}$ 成立。这将确定布尔值 `ok`。\n\n这个结构化的步骤允许对能带能量误差 $E_{\\mathrm{err}}$ 与其估计量 $\\mathcal{B}$ 之间的关系进行直接的数值检验。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test cases.\n    For each test case, it constructs the Hamiltonian, computes the exact and\n    sparse density matrices, and evaluates the band-energy error and an estimator.\n    \"\"\"\n    # Test cases are given as tuples of (n, t, Delta, r).\n    test_cases = [\n        (8, -1.0, 1.0, 1),\n        (8, -1.0, 1.0, 7),\n        (8, -1.0, 0.2, 1),\n        (8, -1.0, 1.0, 0),\n    ]\n\n    results = []\n    mu = 0.0\n    tolerance = 1e-12\n\n    for n, t, Delta, r in test_cases:\n        # 1. Construct the Hamiltonian matrix H\n        H = np.zeros((n, n), dtype=float)\n        for i in range(n):\n            # On-site potential\n            H[i, i] = Delta if i % 2 == 0 else -Delta\n            # Nearest-neighbor hopping\n            if i < n - 1:\n                H[i, i + 1] = t\n                H[i + 1, i] = t\n\n        # 2. Solve the eigenvalue problem\n        # np.linalg.eigh is used for symmetric matrices. It returns sorted eigenvalues.\n        eigvals, eigvecs = np.linalg.eigh(H)\n\n        # 3. Compute the spectral gap gamma\n        occupied_eigvals = eigvals[eigvals < mu]\n        unoccupied_eigvals = eigvals[eigvals > mu]\n        \n        # This problem setup ensures a non-empty set of occupied and unoccupied states.\n        lambda_homo = occupied_eigvals[-1]\n        lambda_lumo = unoccupied_eigvals[0]\n        gamma = lambda_lumo - lambda_homo\n\n        # 4. Construct the exact density matrix P_star\n        occupied_indices = np.where(eigvals < mu)[0]\n        occupied_vecs = eigvecs[:, occupied_indices]\n        P_star = occupied_vecs @ occupied_vecs.T\n\n        # 5. Construct the sparse approximation P_s\n        P_s = np.zeros_like(P_star)\n        for i in range(n):\n            for j in range(n):\n                if abs(i - j) <= r:\n                    P_s[i, j] = P_star[i, j]\n\n        # 6. Compute the exact band-energy error E_err\n        # E_err = |Tr(H * (P_star - P_s))|\n        E_err = np.abs(np.trace(H @ (P_star - P_s)))\n\n        # 7. Compute the Frobenius norm of H\n        norm_H_F = np.linalg.norm(H, 'fro')\n\n        # 8. Compute the residual commutator R and its norm\n        R = H @ P_s - P_s @ H\n        norm_R_F = np.linalg.norm(R, 'fro')\n\n        # 9. Calculate the estimator B\n        if gamma > 0:\n            B = (norm_H_F / gamma) * norm_R_F\n        else:\n            # Handle the case of zero gap, though not expected in these tests.\n            # If norm_R_F is also zero, B can be 0. Otherwise, it's infinite.\n            B = 0.0 if np.isclose(norm_R_F, 0.0) else np.inf\n\n        # 10. Verify the inequality\n        ok = E_err <= B + tolerance\n\n        # Append results formatted as required\n        results.extend([f\"{E_err:.6f}\", f\"{B:.6f}\", str(ok)])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}