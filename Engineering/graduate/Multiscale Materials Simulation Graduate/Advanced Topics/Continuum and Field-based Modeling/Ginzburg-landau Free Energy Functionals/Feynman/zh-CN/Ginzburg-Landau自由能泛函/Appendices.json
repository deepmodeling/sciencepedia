{
    "hands_on_practices": [
        {
            "introduction": "掌握金兹堡-朗道（Ginzburg-Landau, GL）理论的第一步，是从其核心的自由能泛函出发，推导出系统在相变附近的基本行为。本练习将引导你通过一个基础但至关重要的计算，来理解序参量是如何自发出现的。 通过假设一个空间均匀的序参量并最小化自由能，你将亲手推导出在临界温度以下序参量的平衡值，并从中提取出描述其温变行为的平均场临界指数。这个过程不仅能加深你对朗道相变理论的理解，也是后续更复杂分析的基石。",
            "id": "3766239",
            "problem": "在均匀、各向同性的超导体中，当其温度接近临界温度时，考虑来自 Ginzburg-Landau (GL) 理论（Ginzburg-Landau (GL)）的复标量序参量场 $\\psi(\\mathbf{x})$ 的粗粒化自由能泛函。该泛函在 Landau 展开中写至最低非平庸阶，并包含主导的梯度惩罚项：\n$$\n\\mathcal{F}[\\psi] = \\int_{\\Omega} \\left( \\alpha(T)\\,|\\psi(\\mathbf{x})|^{2} + \\frac{b}{2}\\,|\\psi(\\mathbf{x})|^{4} + \\frac{\\kappa}{2}\\,|\\nabla \\psi(\\mathbf{x})|^{2} \\right)\\,d^{d}\\mathbf{x},\n$$\n其中 $\\alpha(T) = a_{0}\\,(T - T_{c})$，$a_{0}  0$，$b  0$ 且 $\\kappa  0$。$T$ 是温度，$T_{c}$ 是临界温度，$\\Omega$ 是一个具有周期性边界条件的大区域。假设没有与外场的耦合，因此规范势可以忽略。梯度项模拟了因对微观尺度进行粗粒化而产生的介观尺度上的平滑性约束，而四次项系数 $b  0$ 确保了热力学稳定性。\n\n从第一性原理出发，通过最小化自由能，并在 $T_{c}$ 以下平衡态极小值点是空间均匀的假设下，推导平衡振幅 $|\\psi|$ 作为 $T$ 的函数（对于 $T  T_{c}$）。然后，从其在 $T \\to T_{c}^{-}$ 时随 $T$ 变化的主导标度行为中，提取由渐近关系 $|\\psi| \\sim (T_{c} - T)^{\\beta_{\\mathrm{op}}}$ 定义的序参量的平均场临界指数 $\\beta_{\\mathrm{op}}$。\n\n$\\beta_{\\mathrm{op}}$ 的值是多少？请给出一个无单位的精确数作为答案。",
            "solution": "该问题要求推导由 Ginzburg-Landau (GL) 自由能泛函描述的标量序参量 $\\psi(\\mathbf{x})$ 的平均场临界指数 $\\beta_{\\mathrm{op}}$。推导从第一性原理出发，通过最小化该泛函来进行。\n\nGL 自由能泛函由下式给出：\n$$\n\\mathcal{F}[\\psi] = \\int_{\\Omega} \\left( \\alpha(T)\\,|\\psi(\\mathbf{x})|^{2} + \\frac{b}{2}\\,|\\psi(\\mathbf{x})|^{4} + \\frac{\\kappa}{2}\\,|\\nabla \\psi(\\mathbf{x})|^{2} \\right)\\,d^{d}\\mathbf{x}\n$$\n参数定义为 $\\alpha(T) = a_{0}\\,(T - T_{c})$，其中常数 $a_{0}  0$，$b  0$ 且 $\\kappa  0$。\n\n问题指出，对于 $T  T_c$，可以假设最小化 $\\mathcal{F}[\\psi]$ 的平衡态是空间均匀的。设此均匀序参量为 $\\psi(\\mathbf{x}) = \\psi_{0}$，其中 $\\psi_{0}$ 是一个与位置 $\\mathbf{x}$ 无关的复常数。\n\n在均匀性假设下，序参量的梯度为零：$\\nabla\\psi_{0} = \\mathbf{0}$。因此，自由能泛函中的梯度项 $\\frac{\\kappa}{2}\\,|\\nabla \\psi(\\mathbf{x})|^{2}$ 消失。泛函简化为：\n$$\n\\mathcal{F}[\\psi_{0}] = \\int_{\\Omega} \\left( \\alpha(T)\\,|\\psi_{0}|^{2} + \\frac{b}{2}\\,|\\psi_{0}|^{4} \\right)\\,d^{d}\\mathbf{x}\n$$\n由于此时被积函数在整个区域 $\\Omega$ 内是常数，积分就是被积函数乘以区域的体积 $V = \\int_{\\Omega} d^{d}\\mathbf{x}$。\n$$\n\\mathcal{F}[\\psi_{0}] = V \\left( \\alpha(T)\\,|\\psi_{0}|^{2} + \\frac{b}{2}\\,|\\psi_{0}|^{4} \\right)\n$$\n为了找到使总自由能 $\\mathcal{F}[\\psi_{0}]$ 最小的 $\\psi_{0}$ 的平衡值，只需最小化自由能密度即可，我们将其记为 $f(\\psi_{0})$：\n$$\nf(\\psi_{0}) = \\alpha(T)\\,|\\psi_{0}|^{2} + \\frac{b}{2}\\,|\\psi_{0}|^{4}\n$$\n此表达式仅依赖于序参量的模 $|\\psi_{0}|$，而与其复相位无关。我们定义一个实数、非负变量 $\\rho = |\\psi_{0}|$ 来表示序参量的振幅。自由能密度可以写成 $\\rho$ 的函数：\n$$\nf(\\rho) = \\alpha(T)\\,\\rho^{2} + \\frac{b}{2}\\,\\rho^{4}\n$$\n为了找到最小化此函数的 $\\rho$ 值，我们计算其对 $\\rho$ 的一阶导数并令其为零：\n$$\n\\frac{df}{d\\rho} = 2\\,\\alpha(T)\\,\\rho + 2\\,b\\,\\rho^{3} = 0\n$$\n分解此方程可得：\n$$\n2\\rho\\,(\\alpha(T) + b\\,\\rho^{2}) = 0\n$$\n该方程对振幅 $\\rho$ 有两个可能的解：\n1. $\\rho = 0$\n2. $\\alpha(T) + b\\,\\rho^{2} = 0 \\implies \\rho^{2} = -\\frac{\\alpha(T)}{b}$\n\n为了确定哪个解对应于稳定平衡（自由能的极小值），我们考察 $f(\\rho)$ 的二阶导数：\n$$\n\\frac{d^{2}f}{d\\rho^{2}} = 2\\,\\alpha(T) + 6\\,b\\,\\rho^{2}\n$$\n问题关注的是超导态，它存在于临界温度以下的温度范围，即 $T  T_{c}$。在此区域内，系数 $\\alpha(T) = a_{0}(T - T_{c})$ 为负，即 $\\alpha(T)  0$。\n\n让我们分析在 $T  T_{c}$ 时两个解的稳定性：\n对于解 $\\rho = 0$：\n二阶导数为 $\\left.\\frac{d^{2}f}{d\\rho^{2}}\\right|_{\\rho=0} = 2\\,\\alpha(T)$。由于 $\\alpha(T)  0$，二阶导数为负。这表明 $\\rho=0$（正常态 $\\psi_{0}=0$）是自由能的一个局域极大值，因此在临界温度以下是不稳定的。\n\n对于解 $\\rho^{2} = -\\frac{\\alpha(T)}{b}$：\n由于 $\\alpha(T)  0$ 且 $b > 0$，右侧为正，从而产生振幅 $\\rho = \\sqrt{-\\frac{\\alpha(T)}{b}}$ 的实数解。在此点，二阶导数为：\n$$\n\\frac{d^{2}f}{d\\rho^{2}} = 2\\,\\alpha(T) + 6\\,b\\,\\left(-\\frac{\\alpha(T)}{b}\\right) = 2\\,\\alpha(T) - 6\\,\\alpha(T) = -4\\,\\alpha(T)\n$$\n由于 $\\alpha(T)  0$，二阶导数 $-4\\,\\alpha(T)$ 为正。这表明这个非零振幅对应于自由能的一个局域极小值，代表了稳定平衡态。\n\n因此，对于 $T  T_{c}$，序参量的平衡振幅为：\n$$\n|\\psi| = \\sqrt{-\\frac{\\alpha(T)}{b}}\n$$\n代入 $\\alpha(T)$ 的定义：\n$$\n|\\psi| = \\sqrt{-\\frac{a_{0}(T - T_{c})}{b}} = \\sqrt{\\frac{a_{0}(T_{c} - T)}{b}}\n$$\n为了提取临界指数，我们重写此表达式以分离出对温度的依赖关系：\n$$\n|\\psi| = \\left(\\frac{a_{0}}{b}\\right)^{1/2} (T_{c} - T)^{1/2}\n$$\n问题要求找到由渐近关系 $|\\psi| \\sim (T_{c} - T)^{\\beta_{\\mathrm{op}}}$ 定义的临界指数 $\\beta_{\\mathrm{op}}$，其中温度从下方趋近于临界温度（$T \\to T_{c}^{-}$）。\n\n通过将推导出的平衡振幅与定义关系进行比较，我们得到：\n$$\n\\left(\\frac{a_{0}}{b}\\right)^{1/2} (T_{c} - T)^{1/2} \\sim (T_{c} - T)^{\\beta_{\\mathrm{op}}}\n$$\n这一比较直接得出指数的值：\n$$\n\\beta_{\\mathrm{op}} = \\frac{1}{2}\n$$\n这是序参量临界指数的经典平均场值。",
            "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$"
        },
        {
            "introduction": "在理解了均匀系统中的自发对称性破缺之后，下一步是探究超导体如何与外部电磁场相互作用。本练习将金兹堡-朗道泛函扩展到包含磁矢量势的情况，让你能够推导出超导物理学中的一个关键参数——伦敦穿透深度 $\\lambda$。 通过分析动能项和磁场能量项，你将揭示超导电流如何响应并排斥外部磁场，并理解穿透深度与超导载流子密度（由序参量模的平方 $| \\psi |^2$ 表示）之间的反比关系。这一实践是连接GL微观理论与超导宏观电磁特性的桥梁。",
            "id": "3766171",
            "problem": "考虑存在外磁场时，超导体的金兹堡-朗道（Ginzburg–Landau, GL）自由能泛函，\n$$\n\\mathcal{F}[\\psi,\\mathbf{A}] \\;=\\; \\int_{\\Omega} \\left[ \\alpha\\,|\\psi|^{2} \\;+\\; \\frac{\\beta}{2}\\,|\\psi|^{4} \\;+\\; \\frac{1}{2m}\\,\\left| \\left(-i\\hbar\\nabla - q\\,\\mathbf{A}\\right)\\psi \\right|^{2} \\;+\\; \\frac{|\\mathbf{B}|^{2}}{2\\mu_{0}} \\right]\\,\\mathrm{d}^{3}\\mathbf{r},\n$$\n其中 $\\psi$ 是复序参量，$\\mathbf{A}$ 是矢势，满足 $\\mathbf{B}=\\nabla\\times\\mathbf{A}$，$m$ 是有效质量，$q$ 是超流载流子的电荷，$\\mu_{0}$ 是真空磁导率。假设一个静态弱场构型，其中序参量具有均匀的模和相位，因此 $|\\psi|$ 在空间上是常数，且 $\\nabla \\arg\\psi=\\mathbf{0}$。在库仑规范 $\\nabla\\cdot\\mathbf{A}=0$ 下进行计算，并考虑在 $|\\psi|$ 固定的情况下对 $\\mathbf{A}$ 的变分。\n\n仅使用电磁场能量和在所述假设下从 GL 泛函中的动能项得到的超流响应，推导控制 $\\mathbf{A}$ 的线性场方程，并推导在半无限几何结构中磁场 $\\mathbf{B}$ 从平面边界穿入并在体材料内部衰减时的特征磁场衰减长度（伦敦穿透深度）$\\lambda$。将 $\\lambda$ 表示为包含 $m$、$\\mu_{0}$、$q$ 和 $|\\psi|$ 的闭式解析表达式。\n\n根据你的推导，简要解释 $\\lambda$ 如何依赖于 $|\\psi|$。最终答案以 $\\lambda$ 的单个符号表达式给出；不要附加单位。",
            "solution": "问题要求从金兹堡-朗道（Ginzburg-Landau, GL）自由能泛函推导磁矢势 $\\mathbf{A}$ 的线性场方程和伦敦穿透深度 $\\lambda$。\n\n给定的 GL 泛函为：\n$$\n\\mathcal{F}[\\psi,\\mathbf{A}] \\;=\\; \\int_{\\Omega} \\left[ \\alpha\\,|\\psi|^{2} \\;+\\; \\frac{\\beta}{2}\\,|\\psi|^{4} \\;+\\; \\frac{1}{2m}\\,\\left| \\left(-i\\hbar\\nabla - q\\,\\mathbf{A}\\right)\\psi \\right|^{2} \\;+\\; \\frac{|\\mathbf{B}|^{2}}{2\\mu_{0}} \\right]\\,\\mathrm{d}^{3}\\mathbf{r}\n$$\n根据要求，我们只考虑电磁场能量和动能项产生的超流响应，并假设序参量 $\\psi$ 的模 $|\\psi|$ 和相位在空间上是常数，即 $\\nabla \\arg\\psi = \\mathbf{0}$。\n\n首先，我们简化动能密度项 $\\frac{1}{2m}\\,\\left| \\left(-i\\hbar\\nabla - q\\,\\mathbf{A}\\right)\\psi \\right|^{2}$。序参量可以写成 $\\psi = |\\psi|\\exp(i\\phi)$，其中 $\\phi$ 是相位。其梯度为 $\\nabla\\psi = (\\nabla|\\psi|)\\exp(i\\phi) + |\\psi|\\exp(i\\phi)(i\\nabla\\phi)$。$|\\psi|$ 是常数和 $\\nabla\\arg\\psi = \\nabla\\phi = \\mathbf{0}$ 的假设直接意味着 $\\nabla\\psi = \\mathbf{0}$。\n将 $\\nabla\\psi = \\mathbf{0}$ 代入动能项算符，得到：\n$$\n\\left(-i\\hbar\\nabla - q\\,\\mathbf{A}\\right)\\psi = -i\\hbar(\\nabla\\psi) - q\\mathbf{A}\\psi = -q\\mathbf{A}\\psi\n$$\n因此，动能密度简化为：\n$$\n\\frac{1}{2m} \\left| -q\\mathbf{A}\\psi \\right|^{2} = \\frac{1}{2m} q^{2} |\\mathbf{A}|^{2} |\\psi|^{2} = \\frac{q^{2}|\\psi|^{2}}{2m} |\\mathbf{A}|^{2}\n$$\n问题指明我们只应考虑此超流响应和电磁场能量，后者由 $\\frac{|\\mathbf{B}|^2}{2\\mu_0} = \\frac{|\\nabla \\times \\mathbf{A}|^2}{2\\mu_0}$ 给出。因为 $|\\psi|$ 是常数，势能项 $\\alpha|\\psi|^2$ 和 $\\frac{\\beta}{2}|\\psi|^4$ 也是常数，所以它们对 $\\mathbf{A}$ 的变分为零，对 $\\mathbf{A}$ 的场方程没有贡献。\n\n因此，需要对 $\\mathbf{A}$ 进行最小化的有效自由能泛函为：\n$$\n\\mathcal{F}_{eff}[\\mathbf{A}] = \\int_{\\Omega} \\left( \\frac{q^{2}|\\psi|^{2}}{2m} |\\mathbf{A}|^{2} + \\frac{1}{2\\mu_{0}} |\\nabla \\times \\mathbf{A}|^{2} \\right) \\mathrm{d}^{3}\\mathbf{r}\n$$\n为了找到 $\\mathbf{A}$ 的控制方程，我们计算 $\\mathcal{F}_{eff}$ 关于 $\\mathbf{A}$ 的变分导数，并令其为零，即 $\\delta\\mathcal{F}_{eff} = 0$。考虑一个变分 $\\mathbf{A} \\to \\mathbf{A} + \\delta\\mathbf{A}$：\n$$\n\\delta\\mathcal{F}_{eff} = \\int_{\\Omega} \\left( \\frac{q^{2}|\\psi|^{2}}{2m} \\delta(|\\mathbf{A}|^{2}) + \\frac{1}{2\\mu_{0}} \\delta(|\\nabla \\times \\mathbf{A}|^{2}) \\right) \\mathrm{d}^{3}\\mathbf{r}\n$$\n平方项的变分为 $\\delta(|\\mathbf{A}|^2) = 2\\mathbf{A}\\cdot\\delta\\mathbf{A}$ 和 $\\delta(|\\nabla \\times \\mathbf{A}|^2) = 2(\\nabla \\times \\mathbf{A}) \\cdot (\\nabla \\times \\delta\\mathbf{A})$。\n将这些代入 $\\delta\\mathcal{F}_{eff}$ 的表达式中：\n$$\n\\delta\\mathcal{F}_{eff} = \\int_{\\Omega} \\left( \\frac{q^{2}|\\psi|^{2}}{m} \\mathbf{A}\\cdot\\delta\\mathbf{A} + \\frac{1}{\\mu_{0}} (\\nabla \\times \\mathbf{A}) \\cdot (\\nabla \\times \\delta\\mathbf{A}) \\right) \\mathrm{d}^{3}\\mathbf{r}\n$$\n我们使用矢量微积分恒等式 $\\mathbf{F}\\cdot(\\nabla \\times \\mathbf{G}) = \\mathbf{G}\\cdot(\\nabla \\times \\mathbf{F}) - \\nabla\\cdot(\\mathbf{F} \\times \\mathbf{G})$。令 $\\mathbf{G} = \\nabla \\times \\mathbf{A}$ 和 $\\mathbf{F} = \\delta\\mathbf{A}$。则 $(\\nabla \\times \\delta\\mathbf{A}) \\cdot (\\nabla \\times \\mathbf{A}) = \\delta\\mathbf{A} \\cdot (\\nabla \\times (\\nabla \\times \\mathbf{A})) + \\nabla\\cdot(\\delta\\mathbf{A} \\times (\\nabla \\times \\mathbf{A}))$。通过散度定理，散度项的积分可以转化为一个面积分。假设变分 $\\delta\\mathbf{A}$ 在区域 $\\Omega$ 的边界上为零，则该面积分为零。变分变为：\n$$\n\\delta\\mathcal{F}_{eff} = \\int_{\\Omega} \\left( \\frac{q^{2}|\\psi|^{2}}{m} \\mathbf{A} + \\frac{1}{\\mu_{0}} \\nabla \\times (\\nabla \\times \\mathbf{A}) \\right) \\cdot \\delta\\mathbf{A} \\, \\mathrm{d}^{3}\\mathbf{r} = 0\n$$\n由于此式必须对任意变分 $\\delta\\mathbf{A}$ 都成立，括号中的项必须为零。这就给出了 $\\mathbf{A}$ 的线性场方程：\n$$\n\\frac{1}{\\mu_{0}} \\nabla \\times (\\nabla \\times \\mathbf{A}) + \\frac{q^{2}|\\psi|^{2}}{m} \\mathbf{A} = \\mathbf{0}\n$$\n该方程也可以通过确定超流密度 $\\mathbf{J}$ 来获得。超流的一般定义是 $\\mathbf{J} = -\\frac{\\delta \\mathcal{F}}{\\delta \\mathbf{A}}$。从我们简化的动能项中，我们发现 $\\mathbf{J} = - \\frac{q^{2}|\\psi|^{2}}{m} \\mathbf{A}$。将其与静态安培定律 $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$ 和 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 结合，我们得到 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = -\\frac{\\mu_0 q^2 |\\psi|^2}{m} \\mathbf{A}$，这与通过变分推导出的方程是相同的。\n\n为了推导穿透深度，我们使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$ 进一步简化方程。问题指定了库仑规范 $\\nabla \\cdot \\mathbf{A} = 0$，因此方程简化为：\n$$\n-\\frac{1}{\\mu_{0}} \\nabla^2 \\mathbf{A} + \\frac{q^{2}|\\psi|^{2}}{m} \\mathbf{A} = \\mathbf{0}\n$$\n重新整理得到：\n$$\n\\nabla^2 \\mathbf{A} = \\frac{\\mu_{0} q^{2}|\\psi|^{2}}{m} \\mathbf{A}\n$$\n这是反应-扩散方程的矢量形式。对于一维几何，例如场沿 $z$ 轴穿透，这变成一个简单的常微分方程，其解的形式为 $\\exp(\\pm z/\\lambda)$。该方程的一般形式是 $\\nabla^2 \\mathbf{A} = \\frac{1}{\\lambda^{2}}\\mathbf{A}$，其中 $\\lambda$ 是特征衰减长度。通过将我们推导的方程与此一般形式进行比较，我们可以确定 $\\lambda^{-2}$：\n$$\n\\frac{1}{\\lambda^{2}} = \\frac{\\mu_{0} q^{2}|\\psi|^{2}}{m}\n$$\n解出 $\\lambda$，我们得到伦敦穿透深度：\n$$\n\\lambda = \\sqrt{\\frac{m}{\\mu_{0} q^{2}|\\psi|^{2}}}\n$$\n对这个结果的解释是，$\\lambda$ 与 $|\\psi|$ 成反比。在 GL 理论中，$|\\psi|^2$ 代表超导载流子（库珀对）的密度。$|\\psi|$ 的值越大，意味着载流子密度越高。这些载流子产生屏蔽电流来抵消外磁场。更高的载流子密度可以产生更强的屏蔽电流，从而更有效地抵消磁场，导致磁场在超导体内部更快地指数衰减。因此，$|\\psi|$ 越大，穿透深度 $\\lambda$ 越小。反之，当 $|\\psi| \\to 0$（例如，当温度接近临界温度时），$\\lambda \\to \\infty$，磁场可以完全穿透材料，从而破坏超导态。",
            "answer": "$$\\boxed{\\sqrt{\\frac{m}{\\mu_{0} q^{2} |\\psi|^{2}}}}$$"
        },
        {
            "introduction": "理论推导为了解物理现象提供了深刻的洞见，但许多复杂模式的形成，尤其是在有限尺寸和强场条件下，需要借助数值模拟来研究。这个实践练习将带你从解析计算跃迁到计算物理，通过数值求解含时金兹堡-朗道方程来模拟超导条带中的涡旋形成。 你将学习如何在离散格子上实现规范不变的差分格式，并使用梯度下降法来最小化自由能，从而直观地观察到量子化磁通涡旋在外磁场作用下进入超导体的动态过程。这项实践为你提供了将理论模型转化为可执行代码以探索复杂物理现象的核心技能。",
            "id": "3766232",
            "problem": "考虑一个二维超导带的金兹堡-朗道（GL）理论的极端第二类极限，其中由超电流引起的磁场变化被忽略。在此极限下，矢量势由外部施加，GL自由能泛函在矩形域 $\\Omega = [0,L_x] \\times [0,W]$ 上简化为以下无量纲形式：\n$$\n\\mathcal{F}[\\psi] \\;=\\; \\int_{\\Omega} \\left( \\left| (\\nabla - i \\mathbf{A}) \\psi \\right|^2 \\;+\\; \\frac{1}{2} \\left( 1 - |\\psi|^2 \\right)^2 \\right) \\, d^2\\mathbf{r},\n$$\n其中 $\\psi(\\mathbf{r})$ 是复序参量，$\\mathbf{A}$ 是对应于无量纲强度为 $B$ 的均匀垂直磁场的矢量势，所有量均为无量纲。使用朗道规范 $\\mathbf{A} = (-B y, 0)$，因此 $A_x = -B y$ 且 $A_y = 0$。沿 $x$ 方向施加周期性边界条件，沿 $y$ 方向施加 de Gennes（超导体-绝缘体）边界条件：\n$$\n\\mathbf{n} \\cdot (\\nabla - i \\mathbf{A}) \\psi \\;=\\; 0 \\quad \\text{on} \\quad y=0 \\quad \\text{and} \\quad y=W,\n$$\n其中 $\\mathbf{n}$ 是向外的单位法向量。角度必须以弧度为单位处理。\n\n您必须通过梯度流（最速下降法）在均匀离散网格上对 $\\mathcal{F}[\\psi]$ 进行数值最小化，从一个轻微扰动的均匀初始状态开始。使用规范不变的链路变量将协变导数离散化。在一个 $x$ 方向有 $N_x$ 个点，$y$ 方向有 $N_y$ 个点，间距为 $\\Delta x$ 和 $\\Delta y$（使用 $\\Delta x = \\Delta y$）的均匀网格上，定义前向协变差分算符：\n$$\nD_x \\psi_{i,j} \\;=\\; U_{x,j} \\, \\psi_{i+1,j} - \\psi_{i,j}, \\quad U_{x,j} \\;=\\; e^{-i A_x(j) \\Delta x} \\;=\\; e^{i B \\, y_j \\, \\Delta x},\n$$\n$$\nD_y \\psi_{i,j} \\;=\\; \\psi_{i,j+1} - \\psi_{i,j},\n$$\n其中 $i$ 的索引是周期性的，且 $y_0 = 0$, $y_j = j \\, \\Delta y$。网格上的伴随算符产生规范协变的离散拉普拉斯分量：\n$$\nD_x^\\dagger D_x \\psi_{i,j} \\;=\\; U_{x,j} \\, \\psi_{i+1,j} + U_{x,j}^\\ast \\, \\psi_{i-1,j} - 2 \\psi_{i,j},\n$$\n$$\nD_y^\\dagger D_y \\psi_{i,j} \\;=\\; \\psi_{i,j+1} + \\psi_{i,j-1} - 2 \\psi_{i,j},\n$$\n其中 de Gennes 边界条件通过在 $y$ 方向上的反射来施加，使得 $\\psi_{i,-1} = \\psi_{i,0}$ 且 $\\psi_{i,N_y} = \\psi_{i,N_y-1}$。最速下降演化（时间相关的GL梯度流的无量纲形式）是\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; - \\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast} \\;=\\; - \\left( D_x^\\dagger D_x \\psi + D_y^\\dagger D_y \\psi - \\left(1 - |\\psi|^2\\right)\\psi \\right),\n$$\n您必须使用时间步长 $\\Delta t$ 对其进行显式离散化得到：\n$$\n\\psi^{(n+1)} \\;=\\; \\psi^{(n)} \\;-\\; \\Delta t \\left( D_x^\\dagger D_x \\psi^{(n)} + D_y^\\dagger D_y \\psi^{(n)} - \\left(1 - \\left|\\psi^{(n)}\\right|^2\\right)\\psi^{(n)} \\right).\n$$\n\n为了量化涡旋进入和边界引起的图案形成，在收敛后，使用链路上规范不变的相位差来计算总规范不变涡度：\n$$\n\\delta\\theta_x(i,j) \\;=\\; \\mathrm{wrap}\\left( \\arg(\\psi_{i+1,j}) - \\arg(\\psi_{i,j}) - \\arg(U_{x,j}) \\right), \\quad \\delta\\theta_y(i,j) \\;=\\; \\mathrm{wrap}\\left( \\arg(\\psi_{i,j+1}) - \\arg(\\psi_{i,j}) \\right),\n$$\n其中 $\\mathrm{wrap}(\\cdot)$ 将角度映射到 $(-\\pi,\\pi]$。小方格涡度（规范不变环流）为\n$$\n\\omega(i,j) \\;=\\; \\mathrm{wrap}\\left( \\delta\\theta_x(i,j) + \\delta\\theta_y(i+1,j) - \\delta\\theta_x(i,j+1) - \\delta\\theta_y(i,j) \\right),\n$$\n对于 $i \\in \\{0,\\dots,N_x-1\\}$（$i$ 具有周期性环绕）和 $j \\in \\{0,\\dots,N_y-2\\}$。净整数涡旋数则为\n$$\nN_v \\;=\\; \\mathrm{round}\\left( \\frac{1}{2\\pi} \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-2} \\omega(i,j) \\right).\n$$\n\n您的程序必须使用以下固定的网格和数值参数（以无量纲单位）来实现上述离散化：\n- 使用 $N_x = 24$, $N_y = 12$, $\\Delta x = \\Delta y = 1$。\n- 每个测试使用显式梯度下降法，$\\Delta t = 0.05$，总共 $N_{\\mathrm{iter}} = 400$ 次迭代。\n- 将 $\\psi$ 初始化为 $\\psi_{i,j}^{(0)} = 1 + \\epsilon \\, \\eta_{i,j}$，其中 $\\epsilon = 10^{-2}$，$\\eta_{i,j}$ 是一个零均值和单位方差的复高斯扰动，为保证可复现性，使用固定的随机种子。\n\n测试套件：\n- 情况1：$B = 0.0000$（极低场；预期无涡旋）。\n- 情况2：$B = \\frac{2\\pi}{N_x (N_y - 1)} \\approx 0.0238$（大约一个磁通量子穿过超导带内部）。\n- 情况3：$B = \\frac{4\\pi}{N_x (N_y - 1)} \\approx 0.0476$（大约两个磁通量子）。\n- 情况4：$B = \\frac{6\\pi}{N_x (N_y - 1)} \\approx 0.0714$（大约三个磁通量子）。\n- 情况5（边缘覆盖，非整数磁通）：$B = \\frac{3\\pi}{N_x (N_y - 1)} \\approx 0.0357$。\n\n对于每种情况，在最小化 $\\mathcal{F}[\\psi]$ 后，计算如上定义的 $N_v$。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $[n_1,n_2,n_3,n_4,n_5]$，其中每个 $n_k$ 是对应测试情况的整数涡旋数。所有量均为无量纲；无需进行物理单位转换，所有角度均以弧度为单位。",
            "solution": "该问题要求对二维超导带的金兹堡-朗道（GL）自由能泛函进行数值最小化。这是通过在离散网格上使用显式时间步进法模拟序参量 $\\psi$ 的梯度流来实现的。主要目标是计算在不同强度的外部磁场 $B$ 下涌现的涡旋数量 $N_v$。该问题是适定的、科学上合理的，并为数值实现提供了一套完整的指令。\n\n在域 $\\Omega = [0,L_x] \\times [0,W]$ 上的金兹堡-朗道自由能泛函由下式给出：\n$$\n\\mathcal{F}[\\psi] \\;=\\; \\int_{\\Omega} \\left( \\left| (\\nabla - i \\mathbf{A}) \\psi \\right|^2 \\;+\\; \\frac{1}{2} \\left( 1 - |\\psi|^2 \\right)^2 \\right) \\, d^2\\mathbf{r}\n$$\n此处，$\\psi$ 是复序参量，$\\mathbf{A} = (-B y, 0)$ 是在朗道规范下强度为 $B$ 的均匀磁场的矢量势。\n\n$\\mathcal{F}[\\psi]$ 的最小化是通过最速下降（梯度流）方法进行的。这对应于根据含时金兹堡-朗道方程，在虚拟时间 $t$ 中演化 $\\psi$：\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; - \\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast}\n$$\n变分导数 $\\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast}$ 在问题陈述中给出，从而得到演化方程：\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; (\\nabla - i \\mathbf{A})^2 \\psi + (1 - |\\psi|^2)\\psi\n$$\n项 $(\\nabla - i \\mathbf{A})^2 \\psi$ 是规范协变拉普拉斯算子。问题提供了此方程在均匀网格上的一个特定的显式离散化方案，我们将实现该方案。\n\n该域被离散化为一个大小为 $N_x \\times N_y$ 的网格，格点间距为 $\\Delta x = \\Delta y = 1$。序参量 $\\psi(\\mathbf{r})$ 变为一个复数数组 $\\psi_{i,j}$，其中 $i \\in \\{0, \\dots, N_x-1\\}$ 且 $j \\in \\{0, \\dots, N_y-1\\}$。\n\n时间演化使用时间步长为 $\\Delta t$ 的显式前向欧拉格式进行离散化：\n$$\n\\psi^{(n+1)}_{i,j} \\;=\\; \\psi^{(n)}_{i,j} \\;+\\; \\Delta t \\cdot \\left( \\frac{\\partial \\psi}{\\partial t} \\right)_{i,j}^{(n)}\n$$\n右侧的离散形式，代表 $-\\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast}$，给出如下：\n$$\n-\\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast} \\to (D_x^\\dagger D_x \\psi)_{i,j} + (D_y^\\dagger D_y \\psi)_{i,j} - \\left(1 - |\\psi_{i,j}|^2\\right)\\psi_{i,j}\n$$\n离散的规范协变拉普拉斯分量具体如下：\n1.  **x方向：** 为了在离散化下保持规范不变性，引入了一个链路变量 $U_{x,j} = e^{i B y_j \\Delta x}$，其中 $y_j = j \\Delta y$。拉普拉斯算子是：\n    $$\n    (D_x^\\dagger D_x \\psi)_{i,j} \\;=\\; U_{x,j} \\, \\psi_{i+1,j} + U_{x,j}^\\ast \\, \\psi_{i-1,j} - 2 \\psi_{i,j}\n    $$\n    在 $x$ 方向上应用周期性边界条件，因此索引 $i$ 按模 $N_x$ 计算。\n\n2.  **y方向：** 矢量势在 $y$ 方向上没有分量（$A_y=0$），因此链路变量为1。拉普拉斯算子是：\n    $$\n    (D_y^\\dagger D_y \\psi)_{i,j} \\;=\\; \\psi_{i,j+1} + \\psi_{i,j-1} - 2 \\psi_{i,j}\n    $$\n    de Gennes（超导体-绝缘体）边界条件 $\\mathbf{n} \\cdot (\\nabla - i\\mathbf{A})\\psi = 0$ 在离散格子上通过反射来实现：$\\psi_{i,-1} = \\psi_{i,0}$ 且 $\\psi_{i,N_y} = \\psi_{i,N_y-1}$。这导致了边界处拉普拉斯算子的特定形式：\n    - 在 $j=0$ 处：$(D_y^\\dagger D_y \\psi)_{i,0} = \\psi_{i,1} + \\psi_{i,-1} - 2\\psi_{i,0} = \\psi_{i,1} - \\psi_{i,0}$。\n    - 在 $j=N_y-1$ 处：$(D_y^\\dagger D_y \\psi)_{i,N_y-1} = \\psi_{i,N_y-2} + \\psi_{i,N_y} - 2\\psi_{i,N_y-1} = \\psi_{i,N_y-2} - \\psi_{i,N_y-1}$。\n\n模拟从初始状态 $\\psi_{i,j}^{(0)} = 1 + \\epsilon \\, \\eta_{i,j}$ 开始，其中 $\\epsilon = 10^{-2}$ 是一个小的扰动幅度，$\\eta_{i,j}$ 是来自零均值和单位方差的高斯分布的复随机数。为保证可复现性，使用固定的随机种子。系统以 $\\Delta t=0.05$ 的时间步长演化 $N_{\\mathrm{iter}} = 400$ 步。\n\n在模拟收敛到最小能量状态后，计算涡旋数量 $N_v$。涡旋是一种拓扑缺陷，在它周围的闭合回路上，$\\psi$ 的相位变化为 $2\\pi$ 的整数倍。在格点上，这是通过对每个基本小方格周围的规范不变环流求和来计算的。\n\n跨链路的规范不变相位差为：\n$$\n\\delta\\theta_x(i,j) = \\mathrm{wrap}\\left( \\arg(\\psi_{i+1,j}) - \\arg(\\psi_{i,j}) - \\arg(U_{x,j}) \\right)\n$$\n$$\n\\delta\\theta_y(i,j) = \\mathrm{wrap}\\left( \\arg(\\psi_{i,j+1}) - \\arg(\\psi_{i,j}) \\right)\n$$\n函数 $\\mathrm{wrap}(\\cdot)$ 将角度映射到区间 $(-\\pi, \\pi]$。\n对于左下角位于 $(i,j)$ 的单元格，其小方格涡度是其周围相位差的总和：\n$$\n\\omega(i,j) = \\mathrm{wrap}\\left( \\delta\\theta_x(i,j) + \\delta\\theta_y(i+1,j) - \\delta\\theta_x(i,j+1) - \\delta\\theta_y(i,j) \\right)\n$$\n这对每个小方格进行计算，其索引为 $i \\in \\{0, \\dots, N_x-1\\}$ 和 $j \\in \\{0, \\dots, N_y-2\\}$。总涡旋数是所有小方格涡度之和，用 $2\\pi$ 归一化后四舍五入到最近的整数：\n$$\nN_v = \\mathrm{round}\\left( \\frac{1}{2\\pi} \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-2} \\omega(i,j) \\right)\n$$\n对测试套件中指定的每个 $B$ 值重复此过程。所有计算均使用提供的无量纲参数：$N_x = 24$, $N_y = 12$, $\\Delta x = \\Delta y = 1$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Ginzburg-Landau equation using gradient descent\n    and computes the vortex count for several magnetic field strengths.\n    \"\"\"\n    \n    # Fixed grid and numerical parameters\n    Nx = 24\n    Ny = 12\n    dx = 1.0\n    dy = 1.0\n    dt = 0.05\n    N_iter = 400\n    epsilon = 1e-2\n    \n    # Define test cases for the magnetic field B.\n    # The area for flux calculation is Lx * W = (Nx*dx) * ((Ny-1)*dy).\n    # Since dx=dy=1, this is Nx * (Ny-1).\n    B_denom = Nx * (Ny - 1)\n    test_cases = [\n        0.0,\n        (2 * np.pi) / B_denom,\n        (4 * np.pi) / B_denom,\n        (6 * np.pi) / B_denom,\n        (3 * np.pi) / B_denom,\n    ]\n\n    results = []\n\n    # Use a fixed random seed for reproducibility\n    np.random.seed(0)\n\n    # Grid coordinates for the y-axis\n    y_coords = np.arange(Ny) * dy\n\n    # Angle wrapping function to map angles to (-pi, pi]\n    def wrap_angle(angles):\n        return (angles + np.pi) % (2 * np.pi) - np.pi\n\n    for B in test_cases:\n        # Initialize the order parameter psi with a small random perturbation\n        noise_real = np.random.randn(Nx, Ny)\n        noise_imag = np.random.randn(Nx, Ny)\n        psi = 1.0 + epsilon * (noise_real + 1j * noise_imag)\n\n        # Pre-compute link variables U_x, which depend only on y\n        arg_U_x = (B * y_coords * dx).reshape(1, Ny)\n        U_x = np.exp(1j * arg_U_x)\n        U_x_conj = np.conj(U_x)\n\n        # Perform gradient descent (explicit Euler time evolution)\n        for _ in range(N_iter):\n            # Calculate the gauge-covariant Laplacian in the x-direction.\n            # Periodic boundary conditions are handled by np.roll.\n            psi_xp1 = np.roll(psi, -1, axis=0)\n            psi_xm1 = np.roll(psi, 1, axis=0)\n            lap_x = U_x * psi_xp1 + U_x_conj * psi_xm1 - 2.0 * psi\n\n            # Calculate the Laplacian in the y-direction, enforcing de Gennes BC.\n            lap_y = np.zeros_like(psi, dtype=np.complex128)\n            # Interior points (central difference)\n            if Ny > 2:\n                lap_y[:, 1:-1] = psi[:, 2:] + psi[:, :-2] - 2.0 * psi[:, 1:-1]\n            # Boundary at y=0 (j=0), implementing D_y^dagger D_y psi = psi_1 - psi_0\n            lap_y[:, 0] = psi[:, 1] - psi[:, 0]\n            # Boundary at y=W (j=Ny-1), implementing D_y^dagger D_y psi = psi_{N-2} - psi_{N-1}\n            if Ny > 1:\n                lap_y[:, -1] = psi[:, -2] - psi[:, -1]\n            \n            # Calculate the potential term\n            potential_term = (1.0 - np.abs(psi)**2) * psi\n\n            # Gradient of the free energy functional (RHS of the evolution eq.)\n            # The sign is positive because the evolution is psi_t = -delta F/delta psi*\n            # and the Laplacian term in F has a positive sign.\n            d_psi_dt = lap_x + lap_y + potential_term\n\n            # Update psi using a forward Euler step\n            psi += dt * d_psi_dt\n\n        # --- Vortex Counting ---\n        # Calculate gauge-invariant phase differences on links\n        arg_psi = np.angle(psi)\n\n        # Phase difference on horizontal links (size Nx, Ny)\n        d_theta_x = wrap_angle(np.roll(arg_psi, -1, axis=0) - arg_psi - arg_U_x)\n\n        # Phase difference on vertical links (size Nx, Ny-1)\n        d_theta_y = wrap_angle(arg_psi[:, 1:] - arg_psi[:, :-1])\n\n        # Calculate plaquette vorticity (gauge-invariant circulation)\n        # A plaquette (i,j) is bounded by points (i,j), (i+1,j), (i+1,j+1), (i,j+1).\n        # omega has shape (Nx, Ny-1).\n        omega = wrap_angle(\n            d_theta_x[:, :-1] + \n            np.roll(d_theta_y, -1, axis=0) - \n            d_theta_x[:, 1:] - \n            d_theta_y\n        )\n\n        # Sum over all plaquettes and normalize to get the net vortex count\n        total_vorticity = np.sum(omega)\n        Nv = int(np.round(total_vorticity / (2 * np.pi)))\n        results.append(Nv)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}