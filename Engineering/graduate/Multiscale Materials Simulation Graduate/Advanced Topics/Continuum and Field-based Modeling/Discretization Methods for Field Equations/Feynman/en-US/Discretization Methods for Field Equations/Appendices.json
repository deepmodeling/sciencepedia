{
    "hands_on_practices": [
        {
            "introduction": "At the heart of discretizing field equations is the approximation of differential operators on a grid. This first practice focuses on the Laplacian, a cornerstone of models for electrostatics, heat conduction, and other steady-state phenomena. You will use the foundational technique of Taylor series expansion to derive the celebrated five-point stencil for the Poisson equation and learn how to handle derivative boundary conditions accurately using the \"ghost point\" method, a fundamental skill for any computational scientist .",
            "id": "3802275",
            "problem": "In multiscale materials simulation, coarse-grained fields such as electrostatic potential or chemical potential are often governed at the mesoscale by the two-dimensional ($2$D) Poisson Partial Differential Equation (PDE), where the field variable $u(x,y)$ satisfies $\\Delta u = f(x,y)$ on a rectangular domain. Consider the rectangular domain $\\Omega = [0,L_x] \\times [0,L_y]$ with a uniform tensor-product grid defined by $x_i = (i-1)h_x$ for $i \\in \\{1,\\dots,N_x\\}$ and $y_j = (j-1)h_y$ for $j \\in \\{1,\\dots,N_y\\}$, where $h_x = L_x/(N_x-1)$ and $h_y = L_y/(N_y-1)$. Let $u_{i,j}$ denote the discrete approximation to $u(x_i,y_j)$. Assume the following boundary conditions: Dirichlet data $u = u_D$ on $x=L_x$, $y=0$, and $y=L_y$, and a Neumann flux $\\partial u/\\partial x = g(y)$ on the boundary $x=0$. Let $g_j \\equiv g(y_j)$.\n\nStarting from Taylor expansions as the fundamental base, construct a second-order accurate finite difference discretization of the Laplacian operator on this grid. Your tasks are:\n\n(1) Derive the second-order accurate discrete Laplacian at an interior grid point $(i,j)$, with $i \\in \\{2,\\dots,N_x-1\\}$ and $j \\in \\{2,\\dots,N_y-1\\}$.\n\n(2) Enforce the Neumann boundary condition at $x=0$ using a ghost point at $i=0$ to obtain a second-order accurate boundary treatment. Eliminate the ghost value to produce a discrete expression for the Laplacian centered at the boundary-aligned node $(i,j)=(1,j)$ with $j \\in \\{2,\\dots,N_y-1\\}$, expressed solely in terms of $u_{1,j}$, $u_{2,j}$, $u_{1,j\\pm 1}$, $h_x$, $h_y$, and $g_j$.\n\nFor clarity and unambiguous assessment, report the final result of your derivation as two analytic expressions arranged as entries of a single row vector in the order: first the interior-node discrete Laplacian, then the boundary-node discrete Laplacian with the Neumann condition enforced by ghost-point elimination. No numerical evaluation is required, and no units are needed. The final answer must be given as a single analytic row vector as specified.",
            "solution": "The problem statement has been validated and is deemed sound. It is a well-posed problem in numerical analysis, requesting the derivation of finite difference stencils for the Laplacian operator. The derivation will proceed based on fundamental Taylor series expansions.\n\nThe two-dimensional Laplacian operator is given by $\\Delta u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}$. We are tasked with deriving its discrete approximation at an interior grid point and at a boundary grid point with a Neumann condition.\n\n**(1) Discretization at an Interior Grid Point**\n\nLet an interior grid point be $(x_i, y_j)$, where $i \\in \\{2,\\dots,N_x-1\\}$ and $j \\in \\{2,\\dots,N_y-1\\}$. We derive the second-order accurate central difference approximation for the second partial derivatives, starting with $\\frac{\\partial^2 u}{\\partial x^2}$.\n\nThe Taylor series for $u(x,y)$ expanded around $(x_i, y_j)$ in the $x$-direction are:\n$$u(x_i+h_x, y_j) = u(x_i, y_j) + h_x \\frac{\\partial u}{\\partial x} + \\frac{h_x^2}{2!} \\frac{\\partial^2 u}{\\partial x^2} + \\frac{h_x^3}{3!} \\frac{\\partial^3 u}{\\partial x^3} + \\frac{h_x^4}{4!} \\frac{\\partial^4 u}{\\partial x^4} + O(h_x^5)$$\n$$u(x_i-h_x, y_j) = u(x_i, y_j) - h_x \\frac{\\partial u}{\\partial x} + \\frac{h_x^2}{2!} \\frac{\\partial^2 u}{\\partial x^2} - \\frac{h_x^3}{3!} \\frac{\\partial^3 u}{\\partial x^3} + \\frac{h_x^4}{4!} \\frac{\\partial^4 u}{\\partial x^4} - O(h_x^5)$$\nwhere all derivatives are evaluated at $(x_i, y_j)$.\n\nAdding these two expansions eliminates the odd-order derivative terms:\n$$u(x_i+h_x, y_j) + u(x_i-h_x, y_j) = 2u(x_i, y_j) + h_x^2 \\frac{\\partial^2 u}{\\partial x^2} + \\frac{h_x^4}{12} \\frac{\\partial^4 u}{\\partial x^4} + O(h_x^6)$$\n\nSolving for $\\frac{\\partial^2 u}{\\partial x^2}$:\n$$\\frac{\\partial^2 u}{\\partial x^2} = \\frac{u(x_i+h_x, y_j) - 2u(x_i, y_j) + u(x_i-h_x, y_j)}{h_x^2} - \\frac{h_x^2}{12} \\frac{\\partial^4 u}{\\partial x^4} - O(h_x^4)$$\nUsing the discrete notation $u_{i,j} \\equiv u(x_i,y_j)$, the second-order accurate central difference approximation is:\n$$\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{(i,j)} \\approx \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h_x^2}$$\nThe truncation error of this approximation is $O(h_x^2)$.\n\nBy an identical argument for the $y$-direction, we obtain:\n$$\\frac{\\partial^2 u}{\\partial y^2}\\bigg|_{(i,j)} \\approx \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h_y^2}$$\nwith a truncation error of $O(h_y^2)$.\n\nThe discrete Laplacian at the interior point $(i,j)$ is the sum of these two expressions:\n$$(\\Delta u)_{i,j} \\approx \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h_x^2} + \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h_y^2}$$\nThis expression can be rearranged to group terms by their spatial location:\n$$(\\Delta u)_{i,j} \\approx \\frac{u_{i+1,j} + u_{i-1,j}}{h_x^2} + \\frac{u_{i,j+1} + u_{i,j-1}}{h_y^2} - 2\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right)u_{i,j}$$\nThis is the first required expression.\n\n**(2) Discretization at the Boundary with a Neumann Condition**\n\nWe now consider a point on the left boundary, $(x_1, y_j)$, where $x_1=0$ and $j \\in \\{2,\\dots,N_y-1\\}$. The Neumann boundary condition is $\\frac{\\partial u}{\\partial x}|_{x=0} = g(y)$.\n\nThe standard five-point stencil for the Laplacian at $(1,j)$ would be:\n$$(\\Delta u)_{1,j} \\approx \\frac{u_{2,j} - 2u_{1,j} + u_{0,j}}{h_x^2} + \\frac{u_{1,j+1} - 2u_{1,j} + u_{1,j-1}}{h_y^2}$$\nThis expression involves the node $u_{0,j}$, which corresponds to the point $(x_0, y_j) = (-h_x, y_j)$ and lies outside the domain $\\Omega$. This is a \"ghost point.\" To maintain second-order accuracy, we must use a second-order accurate approximation of the Neumann condition to eliminate $u_{0,j}$.\n\nWe construct a second-order accurate central difference for the first derivative, $\\frac{\\partial u}{\\partial x}$, centered at the boundary point $(x_1, y_j)$. Subtracting the Taylor expansion for $u(x_1-h_x, y_j)$ from that for $u(x_1+h_x, y_j)$:\n$$u(x_1+h_x, y_j) - u(x_1-h_x, y_j) = 2h_x \\frac{\\partial u}{\\partial x} + \\frac{h_x^3}{3} \\frac{\\partial^3 u}{\\partial x^3} + O(h_x^5)$$\nSolving for $\\frac{\\partial u}{\\partial x}$ evaluates at $(x_1, y_j)$:\n$$\\frac{\\partial u}{\\partial x} = \\frac{u(x_1+h_x, y_j) - u(x_1-h_x, y_j)}{2h_x} - \\frac{h_x^2}{6} \\frac{\\partial^3 u}{\\partial x^3} - O(h_x^4)$$\nThe discrete approximation is:\n$$\\frac{\\partial u}{\\partial x}\\bigg|_{(1,j)} \\approx \\frac{u_{2,j} - u_{0,j}}{2h_x}$$\nThis approximation is second-order accurate, with truncation error $O(h_x^2)$.\n\nApplying the Neumann boundary condition, $g_j \\equiv g(y_j)$:\n$$\\frac{u_{2,j} - u_{0,j}}{2h_x} = g_j$$\nWe solve for the ghost point value $u_{0,j}$:\n$$u_{0,j} = u_{2,j} - 2h_x g_j$$\n\nNow, we substitute this expression for $u_{0,j}$ into the formal discrete Laplacian at $(1,j)$:\n$$(\\Delta u)_{1,j} \\approx \\frac{u_{2,j} - 2u_{1,j} + (u_{2,j} - 2h_x g_j)}{h_x^2} + \\frac{u_{1,j+1} - 2u_{1,j} + u_{1,j-1}}{h_y^2}$$\nSimplifying the term involving $x$-derivatives:\n$$\\frac{2u_{2,j} - 2u_{1,j} - 2h_x g_j}{h_x^2} = \\frac{2u_{2,j}}{h_x^2} - \\frac{2u_{1,j}}{h_x^2} - \\frac{2g_j}{h_x}$$\nSubstituting this back into the expression for $(\\Delta u)_{1,j}$:\n$$(\\Delta u)_{1,j} \\approx \\left(\\frac{2u_{2,j}}{h_x^2} - \\frac{2u_{1,j}}{h_x^2} - \\frac{2g_j}{h_x}\\right) + \\left(\\frac{u_{1,j+1} - 2u_{1,j} + u_{1,j-1}}{h_y^2}\\right)$$\nFinally, we collect terms based on their nodal values, similar to the interior point case, to obtain the second required expression:\n$$(\\Delta u)_{1,j} \\approx \\frac{2u_{2,j}}{h_x^2} + \\frac{u_{1,j+1} + u_{1,j-1}}{h_y^2} - 2\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right)u_{1,j} - \\frac{2g_j}{h_x}$$\nThis is the second-order accurate discrete Laplacian at the Neumann boundary node $(1,j)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{u_{i+1,j} + u_{i-1,j}}{h_x^2} + \\frac{u_{i,j+1} + u_{i,j-1}}{h_y^2} - 2\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right)u_{i,j} & \\frac{2u_{2,j}}{h_x^2} + \\frac{u_{1,j+1} + u_{1,j-1}}{h_y^2} - 2\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right)u_{1,j} - \\frac{2g_j}{h_x}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on the basics of central differencing, this practice tackles the complexities of transport phenomena where both advection and diffusion are present. Using the 1D advection-diffusion equation as a model, you will investigate why numerically accurate schemes can sometimes lead to physically incorrect solutions. This exercise demonstrates how to diagnose this failure through the cell Peclet number, $Pe_h$, and introduces the concept of \"upwinding\" as a robust alternative, highlighting the critical trade-off between formal accuracy and the preservation of physical constraints in a simulation .",
            "id": "3802256",
            "problem": "Consider the steady one-dimensional transport of a scalar concentration field $c(x)$ along a grain boundary segment of length $L$ in a polycrystalline material, where advection is driven by an effective drift velocity $a$ (constant) and diffusion is characterized by a molecular diffusivity $D$ (constant). The governing conservation law is the steady advection–diffusion equation in flux form,\n$$\\frac{d}{dx}\\left(-D\\,\\frac{dc}{dx} + a\\,c\\right) = 0,$$\nequivalently written as the field equation\n$$a\\,\\frac{dc}{dx} - D\\,\\frac{d^{2}c}{dx^{2}} = 0.$$\nYou will construct a conservative, monotone semi-discrete finite difference scheme on a uniform grid and assess the monotonicity of a central differencing scheme via the discrete maximum principle.\n\nWorking on a uniform grid $x_{i} = i\\,h$ with spacing $h$ and interior nodes $i=1,\\dots,N-1$, perform the following:\n\n1. Starting from the flux balance statement over a control volume centered at $x_{i}$, derive the semi-discrete linear system for the interior node values $\\{c_{i}\\}$ when the advective flux is approximated using a first-order upwind finite difference consistent with the sign of $a$ and the diffusive flux is approximated using second-order central differences. State the resulting tridiagonal stencil coefficients of the discrete operator for the case $a>0$.\n\n2. Starting from the same flux balance, derive the semi-discrete linear system for the interior node values $\\{c_{i}\\}$ when the advective term $a\\,dc/dx$ is discretized using second-order central differences and the diffusive term $D\\,d^{2}c/dx^{2}$ is discretized using second-order central differences. State the resulting tridiagonal stencil coefficients.\n\n3. Using the discrete maximum principle and the characterization that a necessary condition for monotonicity is that the linear system matrix be an $M$-matrix (diagonal entries strictly positive, off-diagonal entries non-positive, and the row sums non-negative for homogeneous interior equations), derive the condition on the cell Peclet number\n$$\\mathrm{Pe}_{h} \\equiv \\frac{|a|\\,h}{D}$$\nunder which the central-difference advection–diffusion discretization in part 2 is monotone. Show explicitly that this monotonicity condition fails for sufficiently large $\\mathrm{Pe}_{h}$.\n\n4. In a multiscale materials simulation of electromigration along a grain boundary, suppose the effective drift velocity is $a = 3.0 \\times 10^{-5}\\ \\mathrm{m/s}$ and the diffusivity is $D = 7.0 \\times 10^{-12}\\ \\mathrm{m^{2}/s}$. Compute the largest uniform grid spacing $h_{\\mathrm{crit}}$ such that the central-difference scheme from part 2 remains monotone according to your derived condition. Express $h_{\\mathrm{crit}}$ in micrometers and round your answer to four significant figures.\n\nYour final answer must be only the numerical value of $h_{\\mathrm{crit}}$ in micrometers.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Governing Equation (Flux Form):** $\\frac{d}{dx}\\left(-D\\,\\frac{dc}{dx} + a\\,c\\right) = 0$\n- **Governing Equation (Field Form):** $a\\,\\frac{dc}{dx} - D\\,\\frac{d^{2}c}{dx^{2}} = 0$\n- **Variables and Constants:** Scalar concentration field $c(x)$, drift velocity $a$ (constant), molecular diffusivity $D$ (constant), length of domain $L$.\n- **Grid:** Uniform grid $x_{i} = i\\,h$ with spacing $h$, interior nodes $i=1,\\dots,N-1$.\n- **Task 1:** Derive the semi-discrete linear system for $\\{c_i\\}$ using first-order upwind for advection ($a>0$) and second-order central for diffusion, starting from flux balance. State tridiagonal stencil coefficients.\n- **Task 2:** Derive the semi-discrete linear system for $\\{c_i\\}$ using second-order central differences for both advection ($a\\,dc/dx$) and diffusion ($D\\,d^{2}c/dx^{2}$), starting from flux balance. State tridiagonal stencil coefficients.\n- **Task 3:** Using the discrete maximum principle and M-matrix conditions (diagonal entries $> 0$, off-diagonal entries $\\le 0$, row sums $\\ge 0$), derive the condition on the cell Peclet number, $\\mathrm{Pe}_{h} \\equiv \\frac{|a|\\,h}{D}$, for the central-difference scheme from part 2 to be monotone.\n- **Task 4:** For $a = 3.0 \\times 10^{-5}\\ \\mathrm{m/s}$ and $D = 7.0 \\times 10^{-12}\\ \\mathrm{m^{2}/s}$, compute the critical uniform grid spacing $h_{\\mathrm{crit}}$ in micrometers (rounded to four significant figures) for the central-difference scheme to remain monotone.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem describes the steady-state, one-dimensional advection-diffusion equation, a fundamental and universally accepted model for transport phenomena in various STEM fields, including materials science. The tasks involve standard numerical analysis techniques (finite differences, M-matrix analysis) applied to this equation. The physical parameters provided are representative of atomic transport phenomena like electromigration. The problem is scientifically sound.\n2.  **Well-Posed:** The tasks are clearly defined mathematical derivations and a final calculation based on the derived result. The problem is structured to lead to a unique and meaningful solution.\n3.  **Objective:** The language is precise and technical. All terms are standard within the fields of transport phenomena and numerical analysis. The problem is free of subjectivity.\n4.  **Self-Contained and Consistent:** The problem provides the governing equation, discretization methods to be used, the analysis framework (M-matrix), and all necessary physical constants. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n***\n\nThe solution proceeds by addressing each of the four parts of the problem in sequence.\n\n### Part 1: Upwind Discretization for Advection\nWe start with the integral form of the conservation law over a control volume $V_i = [x_{i-1/2}, x_{i+1/2}]$ centered at node $x_i$, where $x_{i \\pm 1/2} = x_i \\pm h/2$. The flux is defined as $J(x) = -D\\,\\frac{dc}{dx} + a\\,c$. For a steady state, the net flux out of the control volume is zero:\n$$J(x_{i+1/2}) - J(x_{i-1/2}) = 0$$\nThe diffusive flux term, $-D\\,dc/dx$, is approximated at the control volume faces using a second-order central difference:\n$$-D\\,\\frac{dc}{dx}\\bigg|_{x_{i+1/2}} \\approx -D\\,\\frac{c_{i+1} - c_i}{h}$$\n$$-D\\,\\frac{dc}{dx}\\bigg|_{x_{i-1/2}} \\approx -D\\,\\frac{c_i - c_{i-1}}{h}$$\nThe advective flux term, $a\\,c$, is approximated using a first-order upwind scheme. For the specified case $a > 0$, the concentration at a face is taken from the \"upwind\" node, which is the node to the left.\n$$a\\,c(x_{i+1/2}) \\approx a\\,c(x_i) = a\\,c_i$$\n$$a\\,c(x_{i-1/2}) \\approx a\\,c(x_{i-1}) = a\\,c_{i-1}$$\nThe total fluxes at the faces are therefore:\n$$J_{i+1/2} \\approx -D\\,\\frac{c_{i+1} - c_i}{h} + a\\,c_i$$\n$$J_{i-1/2} \\approx -D\\,\\frac{c_i - c_{i-1}}{h} + a\\,c_{i-1}$$\nSubstituting these into the flux balance equation gives:\n$$\\left(-D\\,\\frac{c_{i+1} - c_i}{h} + a\\,c_i\\right) - \\left(-D\\,\\frac{c_i - c_{i-1}}{h} + a\\,c_{i-1}\\right) = 0$$\nTo find the stencil coefficients, we group terms by $c_{i-1}$, $c_i$, and $c_{i+1}$, which yields:\n$$\\left(-\\frac{D}{h} - a\\right)c_{i-1} + \\left(\\frac{2D}{h} + a\\right)c_i + \\left(-\\frac{D}{h}\\right)c_{i+1} = 0$$\nThe stencil coefficients for the tridiagonal system are:\n- Coefficient of $c_{i-1}$: $-\\frac{D}{h} - a$\n- Coefficient of $c_i$: $\\frac{2D}{h} + a$\n- Coefficient of $c_{i+1}$: $-\\frac{D}{h}$\n\n### Part 2: Central Difference Discretization\nWe again start from the flux balance $J(x_{i+1/2}) - J(x_{i-1/2}) = 0$. The diffusive flux is approximated as before. The advective flux is now approximated using a second-order central average at the faces:\n$$a\\,c(x_{i+1/2}) \\approx a\\,\\frac{c_i + c_{i+1}}{2}$$\n$$a\\,c(x_{i-1/2}) \\approx a\\,\\frac{c_{i-1} + c_i}{2}$$\nThe total fluxes at the faces are:\n$$J_{i+1/2} \\approx -D\\,\\frac{c_{i+1} - c_i}{h} + a\\,\\frac{c_i + c_{i+1}}{2}$$\n$$J_{i-1/2} \\approx -D\\,\\frac{c_i - c_{i-1}}{h} + a\\,\\frac{c_{i-1} + c_i}{2}$$\nSubstituting into the flux balance equation:\n$$\\left(-D\\,\\frac{c_{i+1} - c_i}{h} + a\\,\\frac{c_i + c_{i+1}}{2}\\right) - \\left(-D\\,\\frac{c_i - c_{i-1}}{h} + a\\,\\frac{c_{i-1} + c_i}{2}\\right) = 0$$\nGrouping terms by stencil location:\n- $c_{i+1}$ terms: $-\\frac{D}{h}c_{i+1} + \\frac{a}{2}c_{i+1} = \\left(-\\frac{D}{h} + \\frac{a}{2}\\right)c_{i+1}$\n- $c_i$ terms: $\\frac{D}{h}c_i + \\frac{a}{2}c_i - \\left(-\\frac{D}{h}c_i + \\frac{a}{2}c_i\\right) = \\left(\\frac{D}{h} + \\frac{a}{2} + \\frac{D}{h} - \\frac{a}{2}\\right)c_i = \\frac{2D}{h}c_i$\n- $c_{i-1}$ terms: $-\\left(\\frac{D}{h}c_{i-1} + \\frac{a}{2}c_{i-1}\\right) = \\left(-\\frac{D}{h} - \\frac{a}{2}\\right)c_{i-1}$\nCombining these gives the discrete equation:\n$$\\left(-\\frac{D}{h} - \\frac{a}{2}\\right)c_{i-1} + \\left(\\frac{2D}{h}\\right)c_i + \\left(-\\frac{D}{h} + \\frac{a}{2}\\right)c_{i+1} = 0$$\nThe tridiagonal stencil coefficients for the central difference scheme are:\n- Coefficient of $c_{i-1}$: $-\\frac{D}{h} - \\frac{a}{2}$\n- Coefficient of $c_i$: $\\frac{2D}{h}$\n- Coefficient of $c_{i+1}$: $-\\frac{D}{h} + \\frac{a}{2}$\n\n### Part 3: Monotonicity Analysis of the Central Scheme\nA linear system $A\\mathbf{c}=\\mathbf{b}$ satisfies a discrete maximum principle, and the scheme is considered monotone, if the matrix $A$ is an M-matrix. A necessary condition for a matrix to be an M-matrix is that its diagonal entries are strictly positive and all its off-diagonal entries are non-positive. Let the linear system be written as $A_{i,i-1}c_{i-1} + A_{i,i}c_i + A_{i,i+1}c_{i+1} = 0$ for interior nodes. From Part 2, the matrix entries for row $i$ are:\n$$A_{i,i} = \\frac{2D}{h}$$\n$$A_{i,i-1} = -\\frac{D}{h} - \\frac{a}{2}$$\n$$A_{i,i+1} = -\\frac{D}{h} + \\frac{a}{2}$$\nWe check the M-matrix conditions:\n1.  **Positive diagonal entries:** $A_{i,i} = \\frac{2D}{h} > 0$. Since diffusivity $D$ and grid spacing $h$ are positive physical quantities, this condition is always satisfied.\n2.  **Non-positive off-diagonal entries:** We require $A_{i,i-1} \\le 0$ and $A_{i,i+1} \\le 0$.\n    - For $A_{i,i-1}$: $-\\frac{D}{h} - \\frac{a}{2} \\le 0 \\implies \\frac{D}{h} + \\frac{a}{2} \\ge 0$.\n    - For $A_{i,i+1}$: $-\\frac{D}{h} + \\frac{a}{2} \\le 0 \\implies \\frac{a}{2} \\le \\frac{D}{h}$.\n    Combining these two inequalities, we must have $-\\frac{D}{h} \\le \\frac{a}{2} \\le \\frac{D}{h}$, which is equivalent to $\\left|\\frac{a}{2}\\right| \\le \\frac{D}{h}$.\n3.  **Non-negative row sums:** The row sum for an interior node is $S_i = A_{i,i-1} + A_{i,i} + A_{i,i+1}$.\n    $$S_i = \\left(-\\frac{D}{h} - \\frac{a}{2}\\right) + \\left(\\frac{2D}{h}\\right) + \\left(-\\frac{D}{h} + \\frac{a}{2}\\right) = 0$$\n    The condition $S_i \\ge 0$ is satisfied.\n\nThe scheme is monotone if the off-diagonal condition is met. The condition is $|\\frac{a}{2}| \\le \\frac{D}{h}$. We can rearrange this condition in terms of the cell Peclet number, $\\mathrm{Pe}_{h} = \\frac{|a|h}{D}$:\n$$|\\frac{a}{2}| \\le \\frac{D}{h} \\implies |a|h \\le 2D \\implies \\frac{|a|h}{D} \\le 2$$\nSo, the condition for monotonicity is $\\mathrm{Pe}_{h} \\le 2$.\n\nFor sufficiently large $\\mathrm{Pe}_{h}$, specifically for $\\mathrm{Pe}_{h} > 2$, this condition fails. For example, if $a>0$ and $\\mathrm{Pe}_{h} > 2$, then $\\frac{ah}{D} > 2$, which implies $\\frac{a}{2} > \\frac{D}{h}$. In this case, the off-diagonal coefficient $A_{i,i+1} = -\\frac{D}{h} + \\frac{a}{2}$ becomes positive, violating the M-matrix condition. This leads to a loss of monotonicity and can cause unphysical oscillations in the numerical solution.\n\n### Part 4: Critical Grid Spacing Calculation\nWe are given the physical parameters:\n- Drift velocity: $a = 3.0 \\times 10^{-5}\\ \\mathrm{m/s}$\n- Diffusivity: $D = 7.0 \\times 10^{-12}\\ \\mathrm{m^{2}/s}$\n\nThe central-difference scheme remains monotone as long as the condition $\\mathrm{Pe}_{h} \\le 2$ is satisfied. The critical grid spacing, $h_{\\mathrm{crit}}$, is the maximum spacing for which this condition holds. This occurs at the limit of the inequality:\n$$\\mathrm{Pe}_{h} = \\frac{|a|h_{\\mathrm{crit}}}{D} = 2$$\nWe solve for $h_{\\mathrm{crit}}$:\n$$h_{\\mathrm{crit}} = \\frac{2D}{|a|}$$\nSince $a > 0$, $|a| = a$. Substituting the given values:\n$$h_{\\mathrm{crit}} = \\frac{2 \\times (7.0 \\times 10^{-12}\\ \\mathrm{m^{2}/s})}{3.0 \\times 10^{-5}\\ \\mathrm{m/s}}$$\n$$h_{\\mathrm{crit}} = \\frac{14.0 \\times 10^{-12}}{3.0 \\times 10^{-5}}\\ \\mathrm{m} = \\frac{14}{3} \\times 10^{-7}\\ \\mathrm{m}$$\n$$h_{\\mathrm{crit}} \\approx 4.6666... \\times 10^{-7}\\ \\mathrm{m}$$\nThe problem requires the answer in micrometers ($1\\ \\mu\\mathrm{m} = 10^{-6}\\ \\mathrm{m}$).\n$$h_{\\mathrm{crit}} = (4.6666... \\times 10^{-7}\\ \\mathrm{m}) \\times \\left(\\frac{1\\ \\mu\\mathrm{m}}{10^{-6}\\ \\mathrm{m}}\\right) = 0.46666...\\ \\mu\\mathrm{m}$$\nRounding to four significant figures, we get:\n$$h_{\\mathrm{crit}} \\approx 0.4667\\ \\mu\\mathrm{m}$$",
            "answer": "$$\\boxed{0.4667}$$"
        },
        {
            "introduction": "Real-world simulations often involve the interplay of multiple physical processes, such as the simultaneous diffusion and reaction of chemical species. This final practice introduces operator splitting, a powerful strategy for tackling such coupled, multi-physics problems by solving for each process in sequence. You will implement and compare a direct \"monolithic\" solution with first-order (Lie) and second-order (Strang) splitting schemes for a reaction-diffusion system. This exercise provides concrete experience in quantifying the \"splitting error\" and understanding the trade-offs between accuracy, stability, and computational efficiency in modern multiscale simulations .",
            "id": "3802257",
            "problem": "Consider a coupled, linear reaction-diffusion Partial Differential Equation (PDE) system on a one-dimensional periodic domain, which is representative of mesoscale transport and exchange processes in multiscale materials simulation. The system is\n$$\n\\frac{\\partial u}{\\partial t} = D_u \\frac{\\partial^2 u}{\\partial x^2} + k \\left( v - u \\right), \\quad\n\\frac{\\partial v}{\\partial t} = D_v \\frac{\\partial^2 v}{\\partial x^2} + k \\left( u - v \\right),\n$$\nfor $x \\in [0,1]$ with periodic boundary conditions and dimensionless variables. Here $D_u$ and $D_v$ are diffusion coefficients and $k$ is a symmetric exchange rate constant. The goal is to compare operator splitting methods with a monolithic time-discretization in terms of stability and accuracy, and to quantify the error introduced by splitting.\n\nStarting from established principles of diffusion (Fick's law) and linear reaction kinetics, discretize space using the method of lines on a uniform grid with $N$ points and spacing $h = 1/N$. The discrete Laplacian $L_h$ for a grid function $w_i \\approx w(x_i)$ at $x_i = i h$ is defined by\n$$\n\\left(L_h w\\right)_i = \\frac{w_{i+1} - 2 w_i + w_{i-1}}{h^2}, \\quad \\text{with periodic indexing,}\n$$\nthat is, $w_{-1} \\equiv w_{N-1}$ and $w_N \\equiv w_0$. Denote by $\\mathbf{U}(t)$ and $\\mathbf{V}(t)$ the vectors of nodal values of $u$ and $v$ at time $t$.\n\nTime-discretize the semi-discrete system over time steps of size $\\Delta t$ as follows:\n\n- Monolithic backward Euler (fully coupled linear system per step):\n$$\n\\left(I - \\Delta t\\, D_u L_h + \\Delta t\\, k I\\right)\\mathbf{U}^{n+1} - \\Delta t\\, k\\, \\mathbf{V}^{n+1} = \\mathbf{U}^n,\n$$\n$$\n- \\Delta t\\, k\\, \\mathbf{U}^{n+1} + \\left(I - \\Delta t\\, D_v L_h + \\Delta t\\, k I\\right)\\mathbf{V}^{n+1} = \\mathbf{V}^n,\n$$\nwhich must be solved as a single block system each step.\n\n- Lie splitting with implicit substeps (first order): first solve diffusion implicitly for both fields over full $\\Delta t$,\n$$\n\\left(I - \\Delta t\\, D_u L_h\\right)\\mathbf{U}^{\\mathrm{d}} = \\mathbf{U}^n, \\quad \\left(I - \\Delta t\\, D_v L_h\\right)\\mathbf{V}^{\\mathrm{d}} = \\mathbf{V}^n,\n$$\nthen solve the reaction implicitly at each node over full $\\Delta t$ using backward Euler on the $2\\times 2$ local system\n$$\n\\begin{pmatrix} 1 + \\Delta t\\, k & -\\Delta t\\, k \\\\ -\\Delta t\\, k & 1 + \\Delta t\\, k \\end{pmatrix}\n\\begin{pmatrix} U^{n+1}_i \\\\ V^{n+1}_i \\end{pmatrix} = \\begin{pmatrix} U^{\\mathrm{d}}_i \\\\ V^{\\mathrm{d}}_i \\end{pmatrix}.\n$$\n\n- Strang splitting with implicit substeps (second order): first half-reaction implicit over $\\Delta t/2$, then full diffusion implicit over $\\Delta t$, then half-reaction implicit over $\\Delta t/2$. The reaction half-step is the same local $2 \\times 2$ backward Euler system with $\\Delta t$ replaced by $\\Delta t/2$.\n\nDefine the discrete energy at time step $n$ by\n$$\nE^n = \\|\\mathbf{U}^n\\|_2^2 + \\|\\mathbf{V}^n\\|_2^2,\n$$\nand call a scheme stable over $[0,T]$ if $E^{N_T} \\leq E^0 \\left(1 + \\varepsilon\\right)$ with $\\varepsilon = 10^{-10}$ and $N_T = T/\\Delta t$ an integer. Quantify the splitting error at time $T$ by the combined relative $\\ell^2$ error versus the monolithic backward Euler solution,\n$$\n\\mathrm{err} = \\frac{\\left\\| \\begin{pmatrix} \\mathbf{U}_{\\mathrm{split}}(T) - \\mathbf{U}_{\\mathrm{mono}}(T) \\\\ \\mathbf{V}_{\\mathrm{split}}(T) - \\mathbf{V}_{\\mathrm{mono}}(T) \\end{pmatrix} \\right\\|_2}{\\left\\| \\begin{pmatrix} \\mathbf{U}_{\\mathrm{mono}}(T) \\\\ \\mathbf{V}_{\\mathrm{mono}}(T) \\end{pmatrix} \\right\\|_2}.\n$$\n\nImplement the three schemes, advance from given initial conditions to final time $T$, and, for each test case, report:\n\n- The splitting error for Lie splitting with implicit substeps, as a float.\n- The splitting error for Strang splitting with implicit substeps, as a float.\n- The stability boolean for Lie splitting with implicit substeps.\n- The stability boolean for Strang splitting with implicit substeps.\n\nAll quantities are dimensionless. Angles do not appear. Percentages are not used.\n\nUse the following test suite of parameter values and initial conditions, with $x_i = i h$ and $h = 1/N$:\n\n- Test $1$ (happy path): $N = 128$, $D_u = 10^{-2}$, $D_v = 5 \\times 10^{-3}$, $k = 1$, $\\Delta t = 10^{-3}$, $T = 10^{-1}$, $\\mathbf{U}^0_i = \\sin\\left(2\\pi x_i\\right)$, $\\mathbf{V}^0_i = \\tfrac{1}{2}\\sin\\left(2\\pi x_i\\right)$.\n- Test $2$ (moderate time step): $N = 128$, $D_u = 10^{-2}$, $D_v = 5 \\times 10^{-3}$, $k = 1$, $\\Delta t = 5 \\times 10^{-2}$, $T = 10^{-1}$, same initial conditions as Test $1$.\n- Test $3$ (large time step boundary for first-order accuracy): $N = 128$, $D_u = 10^{-2}$, $D_v = 5 \\times 10^{-3}$, $k = 1$, $\\Delta t = 2 \\times 10^{-1}$, $T = 2 \\times 10^{-1}$, same initial conditions as Test $1$.\n- Test $4$ (edge case with no coupling): $N = 128$, $D_u = 10^{-2}$, $D_v = 5 \\times 10^{-3}$, $k = 0$, $\\Delta t = 10^{-1}$, $T = 10^{-1}$, same initial conditions as Test $1$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets, one inner list per test in the order above, with entries ordered as $[\\mathrm{err}_{\\mathrm{Lie}}, \\mathrm{err}_{\\mathrm{Strang}}, \\mathrm{stable}_{\\mathrm{Lie}}, \\mathrm{stable}_{\\mathrm{Strang}}]$. For example, a syntactically valid output (illustrative only) would be\n$$\n\\left[ [0.00123, 0.000045, \\mathrm{True}, \\mathrm{True}], [\\ldots], [\\ldots], [\\ldots] \\right].\n$$",
            "solution": "The problem presented is a well-posed and scientifically grounded exercise in the numerical solution of partial differential equations (PDEs), specifically within the context of multiscale materials simulation. It requires the implementation and comparison of three distinct time-stepping schemes for a coupled linear reaction-diffusion system. All parameters and conditions are clearly defined, and the premises are consistent with established principles of numerical analysis and physics. The problem is therefore deemed valid and a full solution can be constructed.\n\nThe core of the problem is to solve the semi-discrete system of ordinary differential equations (ODEs) resulting from the method of lines applied to the given PDEs. The spatial discretization on a periodic grid leads to a system that is efficiently solved in Fourier space. Let us formalize this approach.\n\n**1. Spatial Discretization and Fourier Representation**\n\nThe continuous problem is given by:\n$$\n\\frac{\\partial u}{\\partial t} = D_u \\frac{\\partial^2 u}{\\partial x^2} + k ( v - u )\n$$\n$$\n\\frac{\\partial v}{\\partial t} = D_v \\frac{\\partial^2 v}{\\partial x^2} + k ( u - v )\n$$\non the domain $x \\in [0,1]$ with periodic boundary conditions.\n\nWe discretize space using a uniform grid with $N$ points $x_i = i h$ for $i=0, \\dots, N-1$, where the grid spacing is $h=1/N$. The functions $u(x,t)$ and $v(x,t)$ are approximated by grid functions $U_i(t) \\approx u(x_i, t)$ and $V_i(t) \\approx v(x_i, t)$, represented by vectors $\\mathbf{U}(t)$ and $\\mathbf{V}(t)$. The second spatial derivative is approximated by the centered finite difference operator, yielding the discrete Laplacian $L_h$:\n$$\n\\left(L_h \\mathbf{W}\\right)_i = \\frac{W_{i+1} - 2 W_i + W_{i-1}}{h^2}\n$$\nwith periodic indexing ($W_N \\equiv W_0$ and $W_{-1} \\equiv W_{N-1}$). The matrix representation of $L_h$ is an $N \\times N$ circulant matrix.\n\nThe semi-discrete system of ODEs is:\n$$\n\\frac{d\\mathbf{U}}{dt} = D_u L_h \\mathbf{U} + k (\\mathbf{V} - \\mathbf{U})\n$$\n$$\n\\frac{d\\mathbf{V}}{dt} = D_v L_h \\mathbf{V} + k (\\mathbf{U} - \\mathbf{V})\n$$\n\nDue to the periodic boundary conditions, the discrete Fourier transform (DFT) diagonalizes the Laplacian matrix $L_h$. The eigenfunctions of $L_h$ are the discrete complex exponentials, and its eigenvalues are given by:\n$$\n\\lambda_m = \\frac{2}{h^2} \\left( \\cos\\left(\\frac{2\\pi m}{N}\\right) - 1 \\right), \\quad m = 0, 1, \\dots, N-1\n$$\nApplying the DFT to the semi-discrete system transforms the vector ODEs into a set of $N$ independent $2 \\times 2$ ODE systems, one for each Fourier mode $m$:\n$$\n\\frac{d\\hat{U}_m}{dt} = D_u \\lambda_m \\hat{U}_m + k (\\hat{V}_m - \\hat{U}_m) = (D_u \\lambda_m - k)\\hat{U}_m + k\\hat{V}_m\n$$\n$$\n\\frac{d\\hat{V}_m}{dt} = D_v \\lambda_m \\hat{V}_m + k (\\hat{U}_m - \\hat{V}_m) = k\\hat{U}_m + (D_v \\lambda_m - k)\\hat{V}_m\n$$\nwhere $\\hat{\\mathbf{U}} = \\mathrm{DFT}(\\mathbf{U})$ and $\\hat{\\mathbf{V}} = \\mathrm{DFT}(\\mathbf{V})$. This formulation is key to an efficient implementation.\n\n**2. Time Discretization Schemes**\n\nWe advance the solution from time $t_n$ to $t_{n+1} = t_n + \\Delta t$.\n\n**2.1. Monolithic Backward Euler**\n\nThis scheme is fully implicit and treats all terms simultaneously. The discrete system for each Fourier mode $m$ is:\n$$\n\\frac{\\hat{U}_m^{n+1} - \\hat{U}_m^n}{\\Delta t} = (D_u \\lambda_m - k)\\hat{U}_m^{n+1} + k\\hat{V}_m^{n+1}\n$$\n$$\n\\frac{\\hat{V}_m^{n+1} - \\hat{V}_m^n}{\\Delta t} = k\\hat{U}_m^{n+1} + (D_v \\lambda_m - k)\\hat{V}_m^{n+1}\n$$\nRearranging these terms gives a $2 \\times 2$ linear system for $(\\hat{U}_m^{n+1}, \\hat{V}_m^{n+1})$ for each mode $m$:\n$$\n\\begin{pmatrix}\n1 - \\Delta t (D_u \\lambda_m - k) & -\\Delta t k \\\\\n-\\Delta t k & 1 - \\Delta t (D_v \\lambda_m - k)\n\\end{pmatrix}\n\\begin{pmatrix} \\hat{U}_m^{n+1} \\\\ \\hat{V}_m^{n+1} \\end{pmatrix}\n= \\begin{pmatrix} \\hat{U}_m^n \\\\ \\hat{V}_m^n \\end{pmatrix}\n$$\nThis system is solved for all $m=0, \\dots, N-1$. The solution in physical space, $\\mathbf{U}^{n+1}$ and $\\mathbf{V}^{n+1}$, is then recovered via the inverse DFT.\n\n**2.2. Lie Splitting (First-Order)**\n\nThis scheme splits the full operator into a diffusion part and a reaction part, which are solved sequentially.\ni. **Diffusion Step**: Solve $\\frac{\\partial \\mathbf{W}}{\\partial t} = D_W L_h \\mathbf{W}$ over $\\Delta t$ implicitly.\nIn Fourier space, for each mode $m$:\n$$\n\\frac{\\hat{U}_m^{\\mathrm{d}} - \\hat{U}_m^n}{\\Delta t} = D_u \\lambda_m \\hat{U}_m^{\\mathrm{d}} \\implies \\hat{U}_m^{\\mathrm{d}} = \\frac{\\hat{U}_m^n}{1 - \\Delta t D_u \\lambda_m}\n$$\n$$\n\\frac{\\hat{V}_m^{\\mathrm{d}} - \\hat{V}_m^n}{\\Delta t} = D_v \\lambda_m \\hat{V}_m^{\\mathrm{d}} \\implies \\hat{V}_m^{\\mathrm{d}} = \\frac{\\hat{V}_m^n}{1 - \\Delta t D_v \\lambda_m}\n$$\nThe intermediate solutions $\\mathbf{U}^{\\mathrm{d}}$ and $\\mathbf{V}^{\\mathrm{d}}$ are found by applying the inverse DFT.\n\nii. **Reaction Step**: Solve $\\frac{\\partial w}{\\partial t} = \\pm k(z-w)$ over $\\Delta t$ implicitly, using $(\\mathbf{U}^{\\mathrm{d}}, \\mathbf{V}^{\\mathrm{d}})$ as initial conditions. This is a local operation at each grid point $i$:\n$$\n\\begin{pmatrix} 1 + \\Delta t k & -\\Delta t k \\\\ -\\Delta t k & 1 + \\Delta t k \\end{pmatrix}\n\\begin{pmatrix} U^{n+1}_i \\\\ V^{n+1}_i \\end{pmatrix} = \\begin{pmatrix} U^{\\mathrm{d}}_i \\\\ V^{\\mathrm{d}}_i \\end{pmatrix}\n$$\nThis $2 \\times 2$ system can be solved analytically for $(U_i^{n+1}, V_i^{n+1})$. The determinant is $1 + 2\\Delta t k$.\n\n**2.3. Strang Splitting (Second-Order)**\n\nStrang splitting provides second-order accuracy by arranging the substeps symmetrically.\ni. **Half Reaction Step**: Solve the reaction system over $\\Delta t/2$.\nii. **Full Diffusion Step**: Solve the diffusion system over the full step $\\Delta t$.\niii. **Half Reaction Step**: Solve the reaction system again over $\\Delta t/2$.\nThe individual substeps are identical to those in Lie splitting, but with adjusted time step durations for the reaction parts.\n\n**3. Evaluation Metrics**\n\n- **Stability**: The discrete energy is $E^n = \\|\\mathbf{U}^n\\|_2^2 + \\|\\mathbf{V}^n\\|_2^2 = \\sum_{i=0}^{N-1} ( (U_i^n)^2 + (V_i^n)^2 )$. The continuous system is dissipative, so energy should not grow. A scheme is considered stable if the final energy $E^{N_T}$ does not exceed the initial energy $E^0$ by more than a small tolerance $\\varepsilon = 10^{-10}$ for floating-point error, i.e., $E^{N_T} \\leq E^0 (1 + \\varepsilon)$. Since all schemes utilize unconditionally stable implicit methods for each sub-problem, they are all expected to be stable.\n\n- **Splitting Error**: The error of the splitting methods is quantified by comparison to the more accurate (for a given $\\Delta t$) monolithic solution. The combined relative $\\ell^2$ error is:\n$$\n\\mathrm{err} = \\frac{\\sqrt{\\|\\mathbf{U}_{\\mathrm{split}}(T) - \\mathbf{U}_{\\mathrm{mono}}(T)\\|_2^2 + \\|\\mathbf{V}_{\\mathrm{split}}(T) - \\mathbf{V}_{\\mathrm{mono}}(T)\\|_2^2}}{\\sqrt{\\|\\mathbf{U}_{\\mathrm{mono}}(T)\\|_2^2 + \\|\\mathbf{V}_{\\mathrm{mono}}(T)\\|_2^2}}\n$$\nThis measures the deviation of the splitting schemes from the monolithic reference solution. We expect the Strang splitting error to be significantly smaller than the Lie splitting error, especially for larger $\\Delta t$, reflecting its higher order of accuracy. For the case $k=0$, all three schemes are mathematically identical, and the splitting error should be zero (within machine precision).",
            "answer": "```\n[[0.0003009586119108157, 1.258757041490979e-06, True, True], [0.01428581635817024, 0.0003061413240212726, True, True], [0.05432657788448552, 0.004652230182470559, True, True], [0.0, 0.0, True, True]]\n```"
        }
    ]
}