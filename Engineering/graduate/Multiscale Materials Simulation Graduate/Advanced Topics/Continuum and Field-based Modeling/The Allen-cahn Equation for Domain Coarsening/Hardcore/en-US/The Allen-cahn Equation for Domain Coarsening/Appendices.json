{
    "hands_on_practices": [
        {
            "introduction": "Before numerically solving the Allen-Cahn equation, it is essential to understand the physical properties inherent in its governing free energy functional. This practice bridges the theoretical model and a key physical quantity by guiding you through the derivation of the interfacial energy, $\\sigma$ . By applying variational principles to the one-dimensional stationary interface, you will see how the model's gradient energy coefficient, $\\kappa$, and potential function, $W(\\phi)$, combine to define the energetic cost of creating a boundary between two phases.",
            "id": "3844125",
            "problem": "Consider the Ginzburg–Landau free energy functional for a scalar order parameter field $\\phi(\\mathbf{x},t)$ used in the Allen–Cahn model of phase ordering:\n$$\n\\mathcal{F}[\\phi] = \\int_{\\Omega} \\left( \\frac{\\kappa}{2} |\\nabla \\phi|^2 + W(\\phi) \\right) \\,\\mathrm{d}V,\n$$\nwhere $\\kappa  0$ is a gradient-energy coefficient and $W(\\phi)$ is a symmetric double-well potential with minima at $\\phi=\\pm 1$. The Allen–Cahn gradient flow is the overdamped relaxation $\\partial_t \\phi = - M \\,\\delta \\mathcal{F}/\\delta \\phi$, with $M0$ a mobility. In a stationary planar interface, $\\phi$ depends only on a single spatial coordinate $x$ and minimizes $\\mathcal{F}$ subject to boundary conditions $\\phi(x\\to -\\infty) = -1$ and $\\phi(x\\to +\\infty) = +1$, where the homogeneous bulk states have zero potential energy. Under the standard normalization, take $W(\\phi) = \\frac{1}{4}(\\phi^2 - 1)^2$.\n\nStarting from the fundamental definitions above and the Euler–Lagrange condition for stationary extrema, derive the one-dimensional equilibrium relation between the gradient term and the potential along the interface, and use it to express the interfacial free energy per unit area $\\sigma$ as the excess free-energy density integrated across the interface:\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} \\left( \\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 + W(\\phi) \\right) \\mathrm{d}x.\n$$\nEvaluate $\\sigma$ in closed form for the given $W(\\phi)$, expressing your result solely in terms of $\\kappa$. As a consistency check, verify that the stationary profile solves the Euler–Lagrange equation and write its explicit form $\\phi^*(x)$ up to translation. Provide your final answer as the exact analytic expression for $\\sigma$. No rounding is required, and no physical units are to be reported with the final answer.",
            "solution": "The user has provided a problem statement that requires validation before a solution can be attempted.\n\n### Step 1: Extract Givens\n-   Ginzburg–Landau free energy functional: $\\mathcal{F}[\\phi] = \\int_{\\Omega} \\left( \\frac{\\kappa}{2} |\\nabla \\phi|^2 + W(\\phi) \\right) \\,\\mathrm{d}V$\n-   Scalar order parameter field: $\\phi(\\mathbf{x},t)$\n-   Gradient-energy coefficient: $\\kappa  0$\n-   Double-well potential: $W(\\phi)$ with minima at $\\phi=\\pm 1$\n-   Allen–Cahn gradient flow: $\\partial_t \\phi = - M \\,\\delta \\mathcal{F}/\\delta \\phi$\n-   Mobility: $M0$\n-   System configuration: Stationary planar interface where $\\phi$ depends only on a single spatial coordinate $x$.\n-   Boundary conditions: $\\phi(x\\to -\\infty) = -1$ and $\\phi(x\\to +\\infty) = +1$\n-   Potential energy in bulk: $W(\\pm 1) = 0$\n-   Specific form of the potential: $W(\\phi) = \\frac{1}{4}(\\phi^2 - 1)^2$\n-   Definition of interfacial free energy per unit area: $\\sigma = \\int_{-\\infty}^{+\\infty} \\left( \\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 + W(\\phi) \\right) \\mathrm{d}x$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes the canonical Allen-Cahn model for phase-field simulations, a standard topic in materials physics and applied mathematics. The functional, potential, and dynamic equation are all standard forms. The problem is self-contained, with all necessary information provided. The specific potential $W(\\phi) = \\frac{1}{4}(\\phi^2 - 1)^2$ correctly has minima at $\\phi=\\pm 1$ where $W(\\pm 1) = \\frac{1}{4}((\\pm 1)^2 - 1)^2 = 0$, consistent with the problem's description. The task is to derive a classic result (the interfacial energy for a specific potential), which is a well-defined mathematical procedure leading to a unique answer. No scientific, logical, or factual flaws are present.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\nThe problem asks for the derivation of the interfacial free energy per unit area, $\\sigma$. For a one-dimensional stationary interface, the profile $\\phi(x)$ minimizes the free energy functional per unit area, which is given by:\n$$\n\\sigma[\\phi] = \\int_{-\\infty}^{+\\infty} \\left( \\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 + W(\\phi) \\right) \\mathrm{d}x\n$$\nThe integrand, $L(\\phi, \\phi') = \\frac{\\kappa}{2} (\\phi')^2 + W(\\phi)$ where $\\phi' = \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}$, can be treated as a Lagrangian. The profile that minimizes this functional must satisfy the Euler-Lagrange equation:\n$$\n\\frac{\\partial L}{\\partial \\phi} - \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\partial L}{\\partial \\phi'} \\right) = 0\n$$\nCalculating the partial derivatives:\n$$\n\\frac{\\partial L}{\\partial \\phi} = \\frac{\\mathrm{d}W}{\\mathrm{d}\\phi}\n$$\n$$\n\\frac{\\partial L}{\\partial \\phi'} = \\kappa \\phi' = \\kappa \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\n$$\nSubstituting these into the Euler-Lagrange equation gives the equation for the stationary profile:\n$$\n\\frac{\\mathrm{d}W}{\\mathrm{d}\\phi} - \\kappa \\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}x^2} = 0 \\quad \\implies \\quad \\kappa \\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}x^2} = \\frac{\\mathrm{d}W}{\\mathrm{d}\\phi}\n$$\nTo find the required equilibrium relation, we multiply this equation by $\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}$:\n$$\n\\kappa \\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}x^2} \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} = \\frac{\\mathrm{d}W}{\\mathrm{d}\\phi} \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\n$$\nBy the chain rule, we can write both sides as total derivatives with respect to $x$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 \\right) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( W(\\phi) \\right)\n$$\nIntegrating this equation with respect to $x$ yields a first integral of motion:\n$$\n\\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 - W(\\phi) = C\n$$\nwhere $C$ is a constant of integration. We determine $C$ using the boundary conditions. As $x \\to \\pm\\infty$, the system is in a homogeneous bulk state, so $\\phi \\to \\pm 1$ and the profile is flat, meaning $\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} \\to 0$. The potential is defined such that $W(\\pm 1) = 0$. Applying these conditions:\n$$\n\\frac{\\kappa}{2} (0)^2 - W(\\pm 1) = 0 - 0 = 0\n$$\nThus, the constant $C=0$. This gives the equilibrium relation between the gradient and potential energy densities along the interface:\n$$\n\\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 = W(\\phi)\n$$\nThis result shows that for the stationary solution, the gradient and potential energy densities are equal at every point $x$.\n\nNow we evaluate the interfacial energy $\\sigma$. Using the relation we just derived, we can rewrite the integrand of $\\sigma$:\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} \\left( W(\\phi) + W(\\phi) \\right) \\mathrm{d}x = \\int_{-\\infty}^{+\\infty} 2W(\\phi) \\mathrm{d}x\n$$\nAlternatively, and more conveniently for calculation, we can express $\\mathrm{d}x$ in terms of $\\mathrm{d}\\phi$. From the equilibrium relation, since $\\phi$ increases with $x$:\n$$\n\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} = \\sqrt{\\frac{2W(\\phi)}{\\kappa}} \\quad \\implies \\quad \\mathrm{d}x = \\sqrt{\\frac{\\kappa}{2W(\\phi)}} \\mathrm{d}\\phi\n$$\nSubstituting this into the integral for $\\sigma$:\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} 2W(\\phi) \\mathrm{d}x = \\int_{-1}^{+1} 2W(\\phi) \\sqrt{\\frac{\\kappa}{2W(\\phi)}} \\mathrm{d}\\phi\n$$\nThe integral limits are changed because as $x$ goes from $-\\infty$ to $+\\infty$, $\\phi$ goes from $-1$ to $+1$.\n$$\n\\sigma = \\int_{-1}^{+1} \\sqrt{4W(\\phi)^2 \\frac{\\kappa}{2W(\\phi)}} \\mathrm{d}\\phi = \\int_{-1}^{+1} \\sqrt{2\\kappa W(\\phi)} \\mathrm{d}\\phi\n$$\nNow we substitute the given potential, $W(\\phi) = \\frac{1}{4}(\\phi^2-1)^2$:\n$$\n\\sigma = \\int_{-1}^{+1} \\sqrt{2\\kappa \\cdot \\frac{1}{4}(\\phi^2-1)^2} \\mathrm{d}\\phi = \\int_{-1}^{+1} \\sqrt{\\frac{\\kappa}{2} (\\phi^2-1)^2} \\mathrm{d}\\phi\n$$\nFor the integration range $\\phi \\in [-1, 1]$, the term $\\phi^2-1$ is non-positive. Therefore, $\\sqrt{(\\phi^2-1)^2} = |\\phi^2-1| = -( \\phi^2-1) = 1-\\phi^2$.\n$$\n\\sigma = \\sqrt{\\frac{\\kappa}{2}} \\int_{-1}^{+1} (1-\\phi^2) \\mathrm{d}\\phi\n$$\nWe now evaluate the definite integral:\n$$\n\\int_{-1}^{+1} (1-\\phi^2) \\mathrm{d}\\phi = \\left[ \\phi - \\frac{\\phi^3}{3} \\right]_{-1}^{+1} = \\left(1 - \\frac{1^3}{3}\\right) - \\left(-1 - \\frac{(-1)^3}{3}\\right) = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\nSubstituting this result back into the expression for $\\sigma$:\n$$\n\\sigma = \\sqrt{\\frac{\\kappa}{2}} \\cdot \\frac{4}{3} = \\frac{4\\sqrt{\\kappa}}{3\\sqrt{2}} = \\frac{4\\sqrt{2}\\sqrt{\\kappa}}{3 \\cdot 2} = \\frac{2\\sqrt{2}}{3}\\sqrt{\\kappa}\n$$\nAs a consistency check, we find the stationary profile $\\phi^*(x)$. From $\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} = \\sqrt{\\frac{2W(\\phi)}{\\kappa}}$, we have:\n$$\n\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} = \\sqrt{\\frac{2}{\\kappa} \\frac{1}{4}(\\phi^2-1)^2} = \\frac{1}{\\sqrt{2\\kappa}}(1-\\phi^2)\n$$\nThis is a separable differential equation:\n$$\n\\frac{\\mathrm{d}\\phi}{1-\\phi^2} = \\frac{1}{\\sqrt{2\\kappa}} \\mathrm{d}x\n$$\nIntegrating both sides (with $\\int \\frac{d\\phi}{1-\\phi^2} = \\mathrm{arctanh}(\\phi)$) yields:\n$$\n\\mathrm{arctanh}(\\phi) = \\frac{x}{\\sqrt{2\\kappa}} + C_0\n$$\nSetting the center of the interface at $x_0=0$ such that $\\phi(0)=0$ gives $C_0=0$. The profile is therefore:\n$$\n\\phi^*(x) = \\tanh\\left(\\frac{x}{\\sqrt{2\\kappa}}\\right)\n$$\nThis profile correctly satisfies the boundary conditions, and one can verify that it solves the second-order Euler-Lagrange equation $\\kappa \\phi'' = W'(\\phi)$, confirming the consistency of our approach. The final expression for the interfacial energy depends only on $\\kappa$.\n$$\n\\sigma = \\frac{2\\sqrt{2\\kappa}}{3}\n$$",
            "answer": "$$\\boxed{\\frac{2\\sqrt{2\\kappa}}{3}}$$"
        },
        {
            "introduction": "Moving from the continuous theory to a computational setting introduces new challenges, chief among them being numerical stability. This practice delves into the practical aspects of solving the Allen-Cahn equation on a grid, focusing on the stiffness introduced by the Laplacian term . Through a von Neumann stability analysis, you will derive the Courant–Friedrichs–Lewy (CFL)-like condition for an explicit time-stepping scheme, revealing the strict relationship between the time step $\\Delta t$ and the spatial grid size $\\Delta x$ required to prevent numerical solutions from becoming unstable.",
            "id": "3844140",
            "problem": "Consider the Allen–Cahn equation for a nonconserved order parameter field $u(\\boldsymbol{x},t)$,\n$$\n\\partial_{t} u(\\boldsymbol{x},t) \\;=\\; -\\,\\kappa\\,\\frac{\\delta \\mathcal{F}[u]}{\\delta u(\\boldsymbol{x},t)}\\,,\n$$\nwhere the Ginzburg–Landau free-energy functional is\n$$\n\\mathcal{F}[u] \\;=\\; \\int_{\\Omega} \\left( \\frac{L}{2}\\,|\\nabla u|^{2} \\;+\\; W(u) \\right)\\, \\mathrm{d}\\boldsymbol{x}\\,,\n$$\nwith $L0$ the gradient-energy coefficient and $W(u)$ a smooth double-well potential. The evolution equation can be written as\n$$\n\\partial_{t} u \\;=\\; \\kappa\\,L\\,\\nabla^{2} u \\;-\\; \\kappa\\,W'(u)\\,.\n$$\nLet $\\Omega$ be a three-dimensional periodic cube discretized by a uniform Cartesian grid with spacing $\\Delta x$ in each direction and $N$ points per direction. Use the second-order central difference stencil for the Laplacian and an explicit forward Euler time integrator. Focusing on the stiffness induced by the Laplacian term, and considering linear stability of the semi-discrete scheme for all discrete Fourier modes under periodic boundary conditions, derive the sharp Courant–Friedrichs–Lewy (CFL)-like constant $C$ in the bound\n$$\n\\Delta t_{\\max} \\;=\\; C\\,\\frac{\\Delta x^{2}}{L\\,\\kappa}\\,,\n$$\nfor three spatial dimensions. Provide the single value of $C$ as your final answer. Do not evaluate any numerical values for parameters; your answer must be exact and expressed as a number without units.",
            "solution": "The problem asks for the stability condition for a numerical scheme applied to the Allen-Cahn equation. The validation process confirms that the problem statement is scientifically grounded, well-posed, objective, and complete. We can therefore proceed with the derivation.\n\nThe governing partial differential equation (PDE) is the Allen-Cahn equation:\n$$\n\\partial_{t} u = \\kappa L \\nabla^{2} u - \\kappa W'(u)\n$$\nwhere $u(\\boldsymbol{x},t)$ is the order parameter, $\\kappa  0$ is a mobility coefficient, and $L  0$ is the gradient-energy coefficient. The problem specifies that the stability analysis should focus on the stiffness introduced by the Laplacian term, $\\nabla^2 u$. This is a standard approach in von Neumann stability analysis, where the stability is governed by the highest-order spatial derivative term. Thus, we analyze the linear heat equation component of the model:\n$$\n\\partial_{t} u = M \\nabla^{2} u\n$$\nwith an effective diffusion coefficient $M = \\kappa L$.\n\nThe domain is a three-dimensional periodic cube, discretized by a uniform Cartesian grid with spacing $\\Delta x$ in all directions. Let $u_{i,j,k}(t)$ be the value of the order parameter at the grid point $(i\\Delta x, j\\Delta x, k\\Delta x)$. The second-order central difference approximation for the three-dimensional Laplacian operator $\\nabla^2$ at grid point $(i,j,k)$ is:\n$$\n(\\nabla_{h}^{2} u)_{i,j,k} = \\frac{u_{i+1,j,k} - 2u_{i,j,k} + u_{i-1,j,k}}{\\Delta x^2} + \\frac{u_{i,j+1,k} - 2u_{i,j,k} + u_{i,j-1,k}}{\\Delta x^2} + \\frac{u_{i,j,k+1} - 2u_{i,j,k} + u_{i,j,k-1}}{\\Delta x^2}\n$$\nThe semi-discrete form of the governing equation is:\n$$\n\\frac{d u_{i,j,k}}{dt} = \\kappa L (\\nabla_{h}^{2} u)_{i,j,k}\n$$\nThe time integration is performed using the explicit forward Euler method. Let $u_{i,j,k}^{n}$ denote the solution at time $t_n = n \\Delta t$. The fully discrete scheme is:\n$$\n\\frac{u_{i,j,k}^{n+1} - u_{i,j,k}^{n}}{\\Delta t} = \\kappa L (\\nabla_{h}^{2} u^{n})_{i,j,k}\n$$\nRearranging for $u_{i,j,k}^{n+1}$ gives:\n$$\nu_{i,j,k}^{n+1} = u_{i,j,k}^{n} + \\frac{\\kappa L \\Delta t}{\\Delta x^2} \\left[ (u_{i+1,j,k}^{n} + u_{i-1,j,k}^{n}) + (u_{i,j+1,k}^{n} + u_{i,j-1,k}^{n}) + (u_{i,j,k+1}^{n} + u_{i,j,k-1}^{n}) - 6u_{i,j,k}^{n} \\right]\n$$\nTo perform the von Neumann stability analysis, we consider a single Fourier mode as a solution on the periodic grid:\n$$\nu_{i,j,k}^{n} = \\hat{u}^{n}(\\boldsymbol{k}) \\exp(I (k_x i \\Delta x + k_y j \\Delta x + k_z k \\Delta x))\n$$\nwhere $I = \\sqrt{-1}$ is the imaginary unit, $\\boldsymbol{k} = (k_x, k_y, k_z)$ is the wave vector, and $\\hat{u}^{n}(\\boldsymbol{k})$ is the amplitude of the mode at time step $n$. The amplification factor is defined as $G(\\boldsymbol{k}) = \\hat{u}^{n+1}(\\boldsymbol{k}) / \\hat{u}^{n}(\\boldsymbol{k})$, so that $u_{i,j,k}^{n+1} = G(\\boldsymbol{k}) u_{i,j,k}^{n}$.\n\nSubstituting the Fourier mode into the discrete equation, we can find the amplification factor $G(\\boldsymbol{k})$. The terms like $u_{i+1,j,k}^{n}$ become:\n$$\nu_{i+1,j,k}^{n} = u_{i,j,k}^{n} \\exp(I k_x \\Delta x)\n$$\n$$\nu_{i-1,j,k}^{n} = u_{i,j,k}^{n} \\exp(-I k_x \\Delta x)\n$$\nThe sum $u_{i+1,j,k}^{n} + u_{i-1,j,k}^{n} = u_{i,j,k}^{n} (\\exp(I k_x \\Delta x) + \\exp(-I k_x \\Delta x)) = 2u_{i,j,k}^{n} \\cos(k_x \\Delta x)$.\nApplying this to all three dimensions and substituting into the fully discrete scheme:\n$$\nG u_{i,j,k}^{n} = u_{i,j,k}^{n} + \\frac{\\kappa L \\Delta t}{\\Delta x^2} \\left[ 2 \\cos(k_x \\Delta x) + 2 \\cos(k_y \\Delta x) + 2 \\cos(k_z \\Delta x) - 6 \\right] u_{i,j,k}^{n}\n$$\nDividing by $u_{i,j,k}^{n}$, we obtain the expression for the amplification factor:\n$$\nG(\\boldsymbol{k}) = 1 + \\frac{2 \\kappa L \\Delta t}{\\Delta x^2} \\left[ \\cos(k_x \\Delta x) + \\cos(k_y \\Delta x) + \\cos(k_z \\Delta x) - 3 \\right]\n$$\nUsing the half-angle identity $\\cos(\\theta) - 1 = -2\\sin^2(\\theta/2)$:\n$$\nG(\\boldsymbol{k}) = 1 - \\frac{4 \\kappa L \\Delta t}{\\Delta x^2} \\left[ \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_z \\Delta x}{2}\\right) \\right]\n$$\nFor the numerical scheme to be stable, the magnitude of the amplification factor must be less than or equal to one for all possible wave vectors $\\boldsymbol{k}$: $|G(\\boldsymbol{k})| \\le 1$. Since $G(\\boldsymbol{k})$ is real, this condition is equivalent to $-1 \\le G(\\boldsymbol{k}) \\le 1$.\n\nThe term involving the sum of sines is always non-negative, so $G(\\boldsymbol{k}) \\le 1$ is always satisfied. The constraint for stability comes from the lower bound:\n$$\n-1 \\le 1 - \\frac{4 \\kappa L \\Delta t}{\\Delta x^2} \\left[ \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_z \\Delta x}{2}\\right) \\right]\n$$\nRearranging this inequality yields:\n$$\n\\frac{4 \\kappa L \\Delta t}{\\Delta x^2} \\left[ \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_z \\Delta x}{2}\\right) \\right] \\le 2\n$$\n$$\n\\Delta t \\le \\frac{2 \\Delta x^2}{4 \\kappa L \\left[ \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_z \\Delta x}{2}\\right) \\right]}\n$$\nThis condition must hold for all wave vectors $\\boldsymbol{k}$. The most stringent constraint on $\\Delta t$ is determined by the wave vector that maximizes the denominator. The maximum value of $\\sin^2(\\theta)$ is $1$, which occurs when $\\theta = \\pi/2$. The arguments $\\frac{k_x \\Delta x}{2}$, $\\frac{k_y \\Delta x}{2}$, and $\\frac{k_z \\Delta x}{2}$ can reach $\\pi/2$ for the highest frequency (Nyquist) modes on the grid, where $k_x \\Delta x = \\pi$, $k_y \\Delta x = \\pi$, and $k_z \\Delta x = \\pi$.\n\nFor this worst-case scenario, the sum of sine terms becomes:\n$$\n\\max_{\\boldsymbol{k}} \\left[ \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_z \\Delta x}{2}\\right) \\right] = \\sin^2\\left(\\frac{\\pi}{2}\\right) + \\sin^2\\left(\\frac{\\pi}{2}\\right) + \\sin^2\\left(\\frac{\\pi}{2}\\right) = 1 + 1 + 1 = 3\n$$\nSubstituting this maximum value into the inequality for $\\Delta t$ gives the stability limit:\n$$\n\\Delta t_{\\max} = \\frac{2 \\Delta x^2}{4 \\kappa L (3)} = \\frac{2 \\Delta x^2}{12 \\kappa L} = \\frac{1}{6} \\frac{\\Delta x^2}{\\kappa L}\n$$\nThe problem specifies the bound in the form $\\Delta t_{\\max} = C \\frac{\\Delta x^2}{L \\kappa}$. By comparing this with our derived expression, we identify the constant $C$.\n$$\nC \\frac{\\Delta x^2}{L \\kappa} = \\frac{1}{6} \\frac{\\Delta x^2}{\\kappa L}\n$$\nThus, the sharp CFL-like constant is $C = 1/6$.",
            "answer": "$$\\boxed{\\frac{1}{6}}$$"
        },
        {
            "introduction": "This final practice synthesizes theoretical understanding and numerical implementation to validate the physical behavior of the Allen-Cahn model. You will build and use a robust semi-implicit spectral solver, a method that efficiently handles the stiffness of the equation, to simulate the evolution of a simple domain . The objective is to numerically verify a cornerstone of phase-field theory: in the sharp-interface limit where $\\varepsilon \\to 0$, the Allen-Cahn dynamics reduce to motion by mean curvature. By comparing your simulation results for a shrinking circle or sphere against the derived analytical solution, you will gain hands-on confirmation of this fundamental asymptotic connection.",
            "id": "3844103",
            "problem": "Consider the Allen–Cahn equation and its sharp-interface asymptotic behavior in the context of domain coarsening. The Allen–Cahn equation is a gradient flow of a Ginzburg–Landau free energy and is widely used in multiscale materials simulation to model phase separation and interface motion. In dimensionless form, the Allen–Cahn equation for an order parameter field $u(\\mathbf{x},t)$ with a double-well potential is\n$$\n\\frac{\\partial u}{\\partial t} = \\Delta u - \\frac{1}{\\varepsilon^2}\\,f(u),\n$$\nwhere $\\Delta$ is the Laplace operator, $\\varepsilon$ is a small positive parameter that sets the characteristic interface thickness, and $f(u)$ is the derivative of a symmetric double-well potential with minima at $u=\\pm 1$. The canonical choice is $f(u) = u^3 - u$ and the corresponding potential $F(u) = \\frac{1}{4}(u^2 - 1)^2$.\n\nIn the sharp-interface limit (small $\\,\\varepsilon\\,$), interfaces evolve by curvature-driven motion. For simple geometries like circles in two dimensions and spheres in three dimensions, this motion can be fully characterized by the mean curvature. Your task is to validate the asymptotic predictions by comparing numerical Allen–Cahn simulations to the corresponding sharp-interface curvature flow for circles and spheres.\n\nStarting from the fundamental base that the Allen–Cahn equation is the $L^2$ gradient flow of the Ginzburg–Landau free energy\n$$\n\\mathcal{E}[u] = \\int \\left( \\frac{1}{2}\\lvert\\nabla u\\rvert^2 + \\frac{1}{\\varepsilon^2} F(u) \\right)\\,d\\mathbf{x},\n$$\nand from the well-tested fact that matched asymptotic analysis connects the Allen–Cahn dynamics to motion by mean curvature in the limit of small $\\,\\varepsilon\\,$, complete the following tasks:\n\n- Derive from first principles the curvature-driven evolution law for the effective radius $R(t)$ of a circle in two dimensions and a sphere in three dimensions under mean curvature motion, as implied by the Allen–Cahn asymptotics. Do not assume any pre-specified formula; derive the law by combining the definition of mean curvature with the kinematic relation linking normal velocity and curvature in the sharp-interface limit.\n- Design and implement a stable, semi-implicit numerical solver for the Allen–Cahn equation on a periodic domain using a spectral method:\n  - Use a linear implicit treatment for the diffusion term and an explicit treatment for the nonlinear term $\\,f(u)\\,$.\n  - Use the standard discrete Fourier transform on a uniform grid of size $\\,N\\times N\\,$ in two dimensions and $\\,N\\times N\\times N\\,$ in three dimensions with periodic boundary conditions.\n  - Initialize the order parameter $u(\\mathbf{x},0)$ to an approximate equilibrium interface corresponding to a circle or a sphere with initial radius $\\,R_0\\,$ centered in the domain, e.g., via a hyperbolic tangent profile across the signed distance to the interface.\n- After evolving the Allen–Cahn equation for a short time interval $\\,t\\,$, compute the effective radius $\\,R_{\\mathrm{AC}}(t)\\,$ by converting the measured area (two dimensions) or volume (three dimensions) of the $\\,u0\\,$ region into the radius of a circle or sphere, respectively.\n- Compute the sharp-interface prediction $\\,R_{\\mathrm{SI}}(t)\\,$ derived from curvature flow and compare it to $\\,R_{\\mathrm{AC}}(t)\\,$ using the relative error\n$$\n\\mathrm{err} = \\frac{\\lvert R_{\\mathrm{AC}}(t) - R_{\\mathrm{SI}}(t) \\rvert}{R_{\\mathrm{SI}}(t)}.\n$$\nUse dimensionless units for all quantities.\n\nYou must implement the program to run the following test suite that covers general behavior, early-time damping, and dimensional effects. For each case, use the specified parameters exactly as given:\n\n- Two-dimensional circle cases on a square periodic domain of side length $\\,L = 1\\,$:\n  1. $\\,(\\text{dim}=2, N=128, L=1, \\varepsilon=0.02, R_0=0.25, \\Delta t=10^{-4}, \\text{steps}=150)\\,$\n  2. $\\,(\\text{dim}=2, N=128, L=1, \\varepsilon=0.02, R_0=0.20, \\Delta t=7.5\\times 10^{-5}, \\text{steps}=40)\\,$\n- Three-dimensional sphere cases on a cubic periodic domain of side length $\\,L = 1\\,$:\n  3. $\\,(\\text{dim}=3, N=32, L=1, \\varepsilon=0.03, R_0=0.23, \\Delta t=10^{-4}, \\text{steps}=40)\\,$\n  4. $\\,(\\text{dim}=3, N=32, L=1, \\varepsilon=0.03, R_0=0.15, \\Delta t=7.5\\times 10^{-5}, \\text{steps}=40)\\,$\n\nFor each case:\n- Initialize $\\,u\\,$ using $\\,u(\\mathbf{x},0) \\approx \\tanh\\!\\left(\\frac{R_0 - d(\\mathbf{x})}{\\sqrt{2}\\,\\varepsilon}\\right)\\,$, where $\\,d(\\mathbf{x})\\,$ is the radial distance from the domain center.\n- Evolve the Allen–Cahn equation using the semi-implicit spectral method for the specified number of time steps.\n- Estimate $\\,R_{\\mathrm{AC}}(t)\\,$ from the area (two dimensions) or volume (three dimensions) of the $\\,u0\\,$ region via $\\,R_{\\mathrm{AC}}(t) = \\sqrt{A/\\pi}\\,$ in two dimensions and $\\,R_{\\mathrm{AC}}(t) = \\left(\\frac{3V}{4\\pi}\\right)^{1/3}\\,$ in three dimensions.\n- Compute $\\,t = \\text{steps} \\times \\Delta t\\,$ and the corresponding sharp-interface radius $\\,R_{\\mathrm{SI}}(t)\\,$ derived from the mean curvature law you established.\n- Report the relative error $\\,\\mathrm{err}\\,$ as a floating-point number.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the four test cases given above, i.e., $\\,\\big[\\mathrm{err}_1,\\mathrm{err}_2,\\mathrm{err}_3,\\mathrm{err}_4\\big]\\,$. All outputs must be dimensionless floating-point numbers. No angles or physical units are involved; use dimensionless quantities throughout and express all time, length, and errors as plain floating-point values.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of phase-field modeling, specifically the Allen-Cahn equation and its sharp-interface limit. The problem is well-posed, with all parameters, equations, and numerical methods clearly and consistently defined. It provides a non-trivial computational task that is standard in the field of multiscale materials simulation for verifying numerical implementations against analytical theory.\n\n### Part 1: Derivation of the Sharp-Interface Evolution Law\n\nThe Allen-Cahn equation is a gradient flow for the Ginzburg-Landau free energy, given by:\n$$\n\\frac{\\partial u}{\\partial t} = \\Delta u - \\frac{1}{\\varepsilon^2}f(u) \\quad \\text{where} \\quad f(u) = u^3 - u\n$$\nIn the sharp-interface limit, as the parameter $\\,\\varepsilon \\to 0\\,$, the dynamics of the interface separating the phases $\\,u \\approx +1\\,$ and $\\,u \\approx -1\\,$ are described by motion by mean curvature. The normal velocity $\\,v_n\\,$ of the interface is proportional to its mean curvature $\\,\\kappa\\,$. For the given dimensionless form of the Allen-Cahn equation, the relationship is:\n$$\nv_n = -\\kappa\n$$\nThe negative sign indicates that regions with positive mean curvature (like the outside of a circle or sphere) will shrink. For a radially symmetric interface with radius $\\,R(t)\\,$, the normal velocity is simply the rate of change of the radius, $\\,v_n = \\frac{dR}{dt}\\,$. We must now determine the mean curvature $\\,\\kappa\\,$ for the two geometries.\n\n_Case 1: Circle in Two Dimensions (2D)_\n\nIn 2D, a circle of radius $\\,R\\,$ has a single principal curvature, which is $\\,k_1 = 1/R\\,$. The mean curvature is simply this value.\n$$\n\\kappa_{2D} = \\frac{1}{R}\n$$\nSubstituting this into the evolution law gives the ordinary differential equation (ODE) for the radius:\n$$\n\\frac{dR}{dt} = - \\frac{1}{R}\n$$\nThis is a separable ODE. We solve it with the initial condition $\\,R(0) = R_0\\,$:\n$$\nR \\, dR = -dt \\implies \\int_{R_0}^{R(t)} R' \\, dR' = \\int_0^t -1 \\, dt'\n$$\n$$\n\\left[ \\frac{1}{2}(R')^2 \\right]_{R_0}^{R(t)} = -[t']_0^t\n$$\n$$\n\\frac{1}{2}R(t)^2 - \\frac{1}{2}R_0^2 = -t\n$$\nSolving for $\\,R(t)\\,$ yields the sharp-interface prediction for a 2D circle:\n$$\nR_{\\mathrm{SI}}(t) = \\sqrt{R_0^2 - 2t}\n$$\n\n_Case 2: Sphere in Three Dimensions (3D)_\n\nIn 3D, a sphere of radius $\\,R\\,$ has two equal principal curvatures, $\\,k_1 = k_2 = 1/R\\,$. The mean curvature is their sum:\n$$\n\\kappa_{3D} = \\frac{1}{R} + \\frac{1}{R} = \\frac{2}{R}\n$$\nSubstituting this into the evolution law gives the ODE for the radius of the sphere:\n$$\n\\frac{dR}{dt} = - \\frac{2}{R}\n$$\nSolving this separable ODE with the initial condition $\\,R(0) = R_0\\,$:\n$$\nR \\, dR = -2dt \\implies \\int_{R_0}^{R(t)} R' \\, dR' = \\int_0^t -2 \\, dt'\n$$\n$$\n\\frac{1}{2}R(t)^2 - \\frac{1}{2}R_0^2 = -2t\n$$\nSolving for $\\,R(t)\\,$ yields the sharp-interface prediction for a 3D sphere:\n$$\nR_{\\mathrm{SI}}(t) = \\sqrt{R_0^2 - 4t}\n$$\n\n### Part 2: Numerical Solver Design\n\nWe will solve the Allen-Cahn equation using a semi-implicit spectral method on a periodic domain. The equation is:\n$$\n\\frac{\\partial u}{\\partial t} = \\Delta u - \\frac{1}{\\varepsilon^2}(u^3 - u)\n$$\nThe diffusion term ($\\,\\Delta u\\,$) is linear and stiff, making it suitable for implicit time integration. The nonlinear reaction term ($\\,f(u) = u^3 - u\\,$) is treated explicitly. This leads to an IMEX (Implicit-Explicit) scheme. Using a first-order Euler method for both parts, we discretize in time as:\n$$\n\\frac{u^{n+1} - u^n}{\\Delta t} = \\Delta u^{n+1} - \\frac{1}{\\varepsilon^2}f(u^n)\n$$\nwhere $\\,u^n\\,$ denotes the solution at time step $\\,n\\,$. This scheme is unconditionally stable with respect to the diffusion term. The explicit treatment of the nonlinear term imposes a constraint on the time step $\\,\\Delta t\\,$ for stability, but this is less severe than the constraint from the diffusion term.\n\nThe use of a spectral method is ideal for periodic domains and the Laplacian operator. Let $\\,\\mathcal{F}\\,$ denote the discrete Fourier transform. Applying it to the time-discretized equation, and using the property $\\,\\mathcal{F}\\{\\Delta u\\} = -|\\mathbf{k}|^2 \\mathcal{F}\\{u\\}\\,$, where $\\,\\mathbf{k}\\,$ is the wavevector, we get:\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} = -|\\mathbf{k}|^2 \\hat{u}^{n+1} - \\frac{1}{\\varepsilon^2}\\mathcal{F}\\{f(u^n)\\}\n$$\nwhere $\\,\\hat{u} = \\mathcal{F}\\{u\\}\\,$. We can now algebraically solve for the solution at the next time step, $\\,\\hat{u}^{n+1}\\,$:\n$$\n\\hat{u}^{n+1}(1 + \\Delta t |\\mathbf{k}|^2) = \\hat{u}^n - \\frac{\\Delta t}{\\varepsilon^2}\\mathcal{F}\\{u^n(u^n)^2 - u^n\\}\n$$\n$$\n\\hat{u}^{n+1} = \\frac{\\hat{u}^n - \\frac{\\Delta t}{\\varepsilon^2}\\widehat{f(u^n)}}{1 + \\Delta t |\\mathbf{k}|^2}\n$$\nThis equation provides the update rule for the simulation in Fourier space.\n\n### Part 3: Implementation Algorithm\n\nThe simulation proceeds as follows for each test case:\n1.  **Setup**: A uniform grid of size $\\,N^d\\,$ represents the domain $\\,[0, L]^d\\,$ for dimension $\\,d \\in \\{2, 3\\}\\,$. A corresponding grid of wavevectors $\\,\\mathbf{k}\\,$ is constructed. The denominator term $\\,1 + \\Delta t |\\mathbf{k}|^2\\,$ is pre-computed for efficiency.\n2.  **Initialization**: The order parameter field $\\,u(\\mathbf{x}, 0)\\,$ is initialized. For this, we define a coordinate system centered at $\\,(-L/2, L/2)^d\\,$ and calculate the Euclidean distance $\\,d(\\mathbf{x})\\,$ from the origin. The initial field is then set using the hyperbolic tangent profile:\n    $$\n    u(\\mathbf{x}, 0) = \\tanh\\left(\\frac{R_0 - d(\\mathbf{x})}{\\sqrt{2}\\,\\varepsilon}\\right)\n    $$\n3.  **Time Evolution**: The system is evolved for the specified number of steps. In each step:\n    a. The current field $\\,u^n\\,$ is transformed to Fourier space to get $\\,\\hat{u}^n\\,$.\n    b. The nonlinear term $\\,f(u^n) = (u^n)^3 - u^n\\,$ is computed in real space.\n    c. $\\,f(u^n)\\,$ is transformed to Fourier space to get $\\,\\widehat{f(u^n)}\\,$.\n    d. The update rule is applied to compute $\\,\\hat{u}^{n+1}\\,$.\n    e. $\\,\\hat{u}^{n+1}\\,$ is transformed back to real space via an inverse Fourier transform to obtain $\\,u^{n+1}\\,$.\n4.  **Analysis**: After the final time step, we have the field $\\,u(\\mathbf{x}, t)\\,$ at $\\,t = \\text{steps} \\times \\Delta t\\,$.\n    a. The effective radius from the simulation, $\\,R_{\\mathrm{AC}}(t)\\,$, is calculated. We count the number of grid cells where $\\,u  0\\,$ to find the total area ($\\,A\\,$) or volume ($\\,V\\,$) of the positive phase. The radius is then found by inverting the geometric formulas:\n       $$\n       R_{\\mathrm{AC}}(t) = \\sqrt{A/\\pi} \\quad \\text{(2D)}, \\qquad R_{\\mathrm{AC}}(t) = \\left(\\frac{3V}{4\\pi}\\right)^{1/3} \\quad \\text{(3D)}\n       $$\n    b. The theoretical radius, $\\,R_{\\mathrm{SI}}(t)\\,$, is calculated using the derived analytical formulas from Part 1.\n    c. The relative error is computed as:\n       $$\n       \\mathrm{err} = \\frac{\\lvert R_{\\mathrm{AC}}(t) - R_{\\mathrm{SI}}(t) \\rvert}{R_{\\mathrm{SI}}(t)}\n       $$\nThis procedure is repeated for all four test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # (dim, N, L, eps, R0, dt, steps)\n    test_cases = [\n        (2, 128, 1.0, 0.02, 0.25, 1e-4, 150),\n        (2, 128, 1.0, 0.02, 0.20, 7.5e-5, 40),\n        (3, 32, 1.0, 0.03, 0.23, 1e-4, 40),\n        (3, 32, 1.0, 0.03, 0.15, 7.5e-5, 40),\n    ]\n\n    results = []\n    for case in test_cases:\n        error = run_simulation(*case)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(dim, N, L, eps, R0, dt, steps):\n    \"\"\"\n    Runs a single Allen-Cahn simulation case and returns the relative error.\n\n    Args:\n        dim (int): Dimensionality of the problem (2 or 3).\n        N (int): Number of grid points along one dimension.\n        L (float): Length of the periodic domain.\n        eps (float): Interface thickness parameter.\n        R0 (float): Initial radius of the circle/sphere.\n        dt (float): Time step size.\n        steps (int): Number of time steps to evolve.\n\n    Returns:\n        float: The relative error between the simulated and theoretical radius.\n    \"\"\"\n    \n    # 1. Setup Grid and Wavevectors\n    h = L / N\n    # Create a centered coordinate system for easier distance calculation\n    coords1d = np.linspace(-L / 2, L / 2, N, endpoint=False)\n    \n    if dim == 2:\n        coords = np.meshgrid(coords1d, coords1d, indexing='ij')\n    elif dim == 3:\n        coords = np.meshgrid(coords1d, coords1d, coords1d, indexing='ij')\n    else:\n        raise ValueError(\"Dimension must be 2 or 3\")\n\n    dist = np.sqrt(sum(c**2 for c in coords))\n\n    # Wavevectors for FFT\n    k1d = 2 * np.pi * np.fft.fftfreq(N, d=h)\n    if dim == 2:\n        k_grids = np.meshgrid(k1d, k1d, indexing='ij')\n    else: # dim == 3\n        k_grids = np.meshgrid(k1d, k1d, k1d, indexing='ij')\n    \n    k_sq = sum(k**2 for k in k_grids)\n\n    # 2. Initialization\n    # Initial field u(x,0) using tanh profile\n    u = np.tanh((R0 - dist) / (np.sqrt(2) * eps))\n    \n    # Pre-compute the denominator for the spectral update rule\n    denominator = 1.0 + dt * k_sq\n    \n    # 3. Time Evolution (Semi-implicit Spectral Method)\n    for _ in range(steps):\n        # Go to Fourier space\n        u_hat = np.fft.fftn(u)\n        \n        # Calculate nonlinear term f(u) = u^3 - u in real space\n        nl_term = u**3 - u\n        nl_term_hat = np.fft.fftn(nl_term)\n        \n        # Update in Fourier space\n        u_hat_new = (u_hat - (dt / eps**2) * nl_term_hat) / denominator\n        \n        # Go back to real space\n        u = np.fft.ifftn(u_hat_new).real\n\n    # 4. Analysis\n    final_time = steps * dt\n    \n    # Calculate sharp-interface prediction R_SI(t)\n    if dim == 2:\n        # R(t)^2 = R0^2 - 2*t\n        r_si_sq = R0**2 - 2 * final_time\n        R_si = np.sqrt(r_si_sq) if r_si_sq > 0 else 0.0\n    else: # dim == 3\n        # R(t)^2 = R0^2 - 4*t\n        r_si_sq = R0**2 - 4 * final_time\n        R_si = np.sqrt(r_si_sq) if r_si_sq > 0 else 0.0\n\n    # Calculate Allen-Cahn effective radius R_AC(t)\n    # Count grid points where u > 0 to get area/volume\n    positive_phase_volume = np.sum(u > 0) * (h**dim)\n    \n    if dim == 2:\n        # A = pi * R^2 => R = sqrt(A/pi)\n        R_ac = np.sqrt(positive_phase_volume / np.pi)\n    else: # dim == 3\n        # V = (4/3) * pi * R^3 => R = (3*V / (4*pi))^(1/3)\n        R_ac = (3 * positive_phase_volume / (4 * np.pi))**(1/3)\n\n    # Compute relative error\n    if R_si > 1e-9: # Avoid division by zero if circle has vanished\n        relative_error = np.abs(R_ac - R_si) / R_si\n    else:\n        relative_error = np.abs(R_ac)\n\n    return relative_error\n\nsolve()\n```"
        }
    ]
}