{
    "hands_on_practices": [
        {
            "introduction": "界面能是控制相变热力学和动力学的关键物理量。本练习旨在巩固您对 Ginzburg-Landau 自由能泛函以及决定平衡界面结构的变分原理的理解。通过推导，您将直接了解模型的参数（如 $\\kappa$）和势函数（$W(\\phi)$）如何共同决定这一关键的宏观性质。",
            "id": "3844125",
            "problem": "考虑在相序的 Allen–Cahn 模型中使用的标量序参量场 $\\phi(\\mathbf{x},t)$ 的金兹堡-朗道自由能泛函：\n$$\n\\mathcal{F}[\\phi] = \\int_{\\Omega} \\left( \\frac{\\kappa}{2} |\\nabla \\phi|^2 + W(\\phi) \\right) \\mathrm{d}V,\n$$\n其中 $\\kappa > 0$ 是梯度能量系数，$W(\\phi)$ 是一个对称双势阱，其极小值点在 $\\phi=\\pm 1$。Allen–Cahn 梯度流是过阻尼弛豫 $\\partial_t \\phi = - M \\delta \\mathcal{F}/\\delta \\phi$，其中 $M>0$ 是迁移率。在一个稳态平面界面中，$\\phi$ 仅依赖于单个空间坐标 $x$，并在边界条件 $\\phi(x\\to -\\infty) = -1$ 和 $\\phi(x\\to +\\infty) = +1$ 下最小化 $\\mathcal{F}$，其中均匀体态的势能为零。在标准归一化下，取 $W(\\phi) = \\frac{1}{4}(\\phi^2 - 1)^2$。\n\n从上述基本定义和稳态极值的欧拉-拉格朗日条件出发，推导梯度项与界面上势能之间的一维平衡关系，并用它将单位面积的界面自由能 $\\sigma$ 表示为跨界面积分的额外自由能密度：\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} \\left( \\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 + W(\\phi) \\right) \\mathrm{d}x.\n$$\n对于给定的 $W(\\phi)$，以闭合形式计算 $\\sigma$，并将结果仅用 $\\kappa$ 表示。作为一致性检验，验证稳态剖面满足欧拉-拉格朗日方程，并写出其在平移变换下的显式形式 $\\phi^*(x)$。提供 $\\sigma$ 的精确解析表达式作为最终答案。不需要四舍五入，最终答案也不应包含物理单位。",
            "solution": "对于一维稳态界面，剖面 $\\phi(x)$ 使单位面积的自由能泛函最小化：\n$$\n\\sigma[\\phi] = \\int_{-\\infty}^{+\\infty} \\left( \\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 + W(\\phi) \\right) \\mathrm{d}x\n$$\n最小化该泛函的剖面必须满足欧拉-拉格朗日方程：\n$$\n\\frac{\\mathrm{d}W}{\\mathrm{d}\\phi} - \\kappa \\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}x^2} = 0 \\quad \\implies \\quad \\kappa \\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}x^2} = \\frac{\\mathrm{d}W}{\\mathrm{d}\\phi}\n$$\n我们将此方程乘以 $\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}$ 并对 $x$ 积分，利用链式法则得到运动第一积分：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 \\right) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( W(\\phi) \\right) \\quad \\implies \\quad \\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 - W(\\phi) = C\n$$\n其中 $C$ 是一个积分常数。利用边界条件 $x \\to \\pm\\infty$ 时 $\\phi \\to \\pm 1$、$\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} \\to 0$ 以及 $W(\\pm 1) = 0$，我们确定 $C=0$。这给出了界面上梯度能量密度和势能密度之间的平衡关系（能量均分）：\n$$\n\\frac{\\kappa}{2} \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 = W(\\phi)\n$$\n利用这个关系，我们可以重写界面能 $\\sigma$ 的被积函数：\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} \\left( W(\\phi) + W(\\phi) \\right) \\mathrm{d}x = \\int_{-\\infty}^{+\\infty} 2W(\\phi) \\mathrm{d}x\n$$\n为了计算积分，我们进行变量代换。从能量均分关系可得 $\\mathrm{d}x = \\sqrt{\\frac{\\kappa}{2W(\\phi)}} \\mathrm{d}\\phi$。将此代入 $\\sigma$ 的积分中，并将积分限从 $(-\\infty, +\\infty)$ 映射到 $(-1, +1)$：\n$$\n\\sigma = \\int_{-1}^{+1} 2W(\\phi) \\sqrt{\\frac{\\kappa}{2W(\\phi)}} \\mathrm{d}\\phi = \\int_{-1}^{+1} \\sqrt{2\\kappa W(\\phi)} \\mathrm{d}\\phi\n$$\n现在我们代入给定的势 $W(\\phi) = \\frac{1}{4}(\\phi^2-1)^2$。在积分区间 $\\phi \\in [-1, 1]$ 内，$\\sqrt{(\\phi^2-1)^2} = |\\phi^2-1| = 1-\\phi^2$。\n$$\n\\sigma = \\int_{-1}^{+1} \\sqrt{2\\kappa \\cdot \\frac{1}{4}(\\phi^2-1)^2} \\mathrm{d}\\phi = \\sqrt{\\frac{\\kappa}{2}} \\int_{-1}^{+1} (1-\\phi^2) \\mathrm{d}\\phi\n$$\n计算定积分：\n$$\n\\int_{-1}^{+1} (1-\\phi^2) \\mathrm{d}\\phi = \\left[ \\phi - \\frac{\\phi^3}{3} \\right]_{-1}^{+1} = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 + \\frac{1}{3}\\right) = \\frac{4}{3}\n$$\n将此结果代回 $\\sigma$ 的表达式中，得到最终答案：\n$$\n\\sigma = \\sqrt{\\frac{\\kappa}{2}} \\cdot \\frac{4}{3} = \\frac{2\\sqrt{2\\kappa}}{3}\n$$\n作为一致性检验，求解可分离微分方程 $\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} = \\sqrt{\\frac{2W(\\phi)}{\\kappa}} = \\frac{1}{\\sqrt{2\\kappa}}(1-\\phi^2)$，得到稳态剖面解 $\\phi^*(x) = \\tanh\\left(\\frac{x}{\\sqrt{2\\kappa}}\\right)$，这验证了我们方法的一致性。",
            "answer": "$$\\boxed{\\frac{2\\sqrt{2\\kappa}}{3}}$$"
        },
        {
            "introduction": "在理解了模型参数如何定义物理性质之后，一个实际的问题是如何为真实的材料体系确定这些参数。本练习将前一个问题反过来，要求您进行一次逆向计算。您将从可测量的宏观量——界面能 $\\sigma$ 和界面宽度 $\\ell$——出发，反推出潜在的模型参数 $\\kappa$ 和 $W$，这对于学习如何使用实验数据或更高精度的模拟数据来校准相场模型至关重要。",
            "id": "3844194",
            "problem": "一个正在进行畴粗化的对称二元合金在扩散界面框架中由一个标量相场序参量 $\\phi(\\mathbf{x},t)$ 描述，其朗道型自由能泛函为\n$$\nF[\\phi] = \\int_{\\Omega} \\left( \\frac{\\kappa}{2}|\\nabla \\phi|^{2} + W f(\\phi) \\right) \\mathrm{d}V,\n$$\n其中 $\\kappa>0$ 是梯度能量系数，$W>0$ 是局域势的能量尺度前因子，$f(\\phi)$ 是一个在 $\\phi=\\pm 1$ 处有极小值的对称双阱。考虑经典的四次双阱选择\n$$\nf(\\phi) = \\frac{(\\phi^{2}-1)^{2}}{4}.\n$$\n令 $\\phi(x)$ 表示一个连接 $\\phi(-\\infty)=-1$ 到 $\\phi(+\\infty)=+1$ 的一维平面稳态平衡界面，该界面在这些边界条件下使 $F[\\phi]$ 最小化。将单位面积的界面能 $\\sigma$ 定义为界面相对于体相极小值的过剩自由能，并将界面宽度 $\\ell$ 定义为平衡剖面取值为 $\\phi=-a$ 和 $\\phi=+a$ 的两点之间的空间距离，其中 $a\\in(0,1)$ 为一固定值。\n\n从稳态剖面满足与 $F[\\phi]$ 相关的欧拉-拉格朗日条件的变分原理出发，并且仅使用给定的泛函形式和边界条件，推导出连接 $\\sigma$ 和 $\\ell$ 与 $\\kappa$ 和 $W$ 的关系式。然后，对于给定的目标值 $\\sigma$ 和 $\\ell$（其中 $\\ell$ 的定义基于上述的 $a$），计算能够再现这些目标值的容许对 $(\\kappa,W)$。\n\n你的最终答案必须是关于 $(\\kappa,W)$ 对的单个解析表达式，用 $\\sigma$、$\\ell$ 和 $a$ 表示。不要进行任何数值舍入。另外，在你的解答中简要解释，当不同的势函数形状 $f(\\phi)$ 可以再现相同的观测值 $\\sigma$ 和 $\\ell$ 时，会出现什么样的可辨识性问题，以及需要哪些额外信息来解决这种模糊性。",
            "solution": "稳态平衡剖面 $\\phi(x)$ 最小化一维自由能泛函，并满足欧拉-拉格朗日方程。这导出了梯度能量密度与势能密度之间的能量均分关系：\n$$\n\\frac{\\kappa}{2}\\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^2 = W f(\\phi) = W \\frac{(\\phi^2-1)^2}{4}\n$$\n从中我们可以得到一阶常微分方程：\n$$\n\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} = \\sqrt{\\frac{2W}{\\kappa}f(\\phi)} = \\sqrt{\\frac{W}{2\\kappa}}|\\phi^2-1|\n$$\n由于在界面内部 $-1  \\phi  1$，我们有 $|\\phi^2-1| = 1-\\phi^2$。这是一个可分离变量的微分方程：\n$$\n\\frac{\\mathrm{d}\\phi}{1-\\phi^2} = \\sqrt{\\frac{W}{2\\kappa}} \\mathrm{d}x\n$$\n对其积分可得平衡剖面解 $\\phi(x) = \\tanh\\left(\\sqrt{\\frac{W}{2\\kappa}} x\\right)$（假设界面中心位于 $x=0$）。\n\n接下来，我们推导界面能 $\\sigma$ 和宽度 $\\ell$ 的表达式。\n界面能 $\\sigma$ 是单位面积上的总过剩自由能。利用能量均分关系，我们可以将其写为：\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} \\left( \\frac{\\kappa}{2}\\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)^{2} + W f(\\phi) \\right) \\mathrm{d}x = \\int_{-\\infty}^{+\\infty} 2Wf(\\phi) \\mathrm{d}x\n$$\n通过变量代换 $\\mathrm{d}x = \\left(\\sqrt{\\frac{W}{2\\kappa}}(1-\\phi^2)\\right)^{-1} \\mathrm{d}\\phi$，并将积分限从 $x \\in (-\\infty, \\infty)$ 改为 $\\phi \\in (-1, 1)$：\n$$\n\\sigma = \\int_{-1}^{+1} \\sqrt{2\\kappa W f(\\phi)} \\mathrm{d}\\phi = \\sqrt{2\\kappa W} \\int_{-1}^{+1} \\frac{1-\\phi^2}{2} \\mathrm{d}\\phi = \\frac{\\sqrt{2\\kappa W}}{2} \\left[ \\phi - \\frac{\\phi^3}{3} \\right]_{-1}^{+1} = \\frac{2\\sqrt{2}}{3}\\sqrt{\\kappa W}\n$$\n界面宽度 $\\ell$ 是 $\\phi=-a$ 和 $\\phi=a$ 两点之间的距离。利用剖面解 $x = \\sqrt{\\frac{2\\kappa}{W}}\\arctanh(\\phi)$：\n$$\nx_1 = \\sqrt{\\frac{2\\kappa}{W}}\\arctanh(-a) = -\\sqrt{\\frac{2\\kappa}{W}}\\arctanh(a)\n$$\n$$\nx_2 = \\sqrt{\\frac{2\\kappa}{W}}\\arctanh(a)\n$$\n宽度为 $\\ell = x_2 - x_1 = 2\\sqrt{\\frac{2\\kappa}{W}}\\arctanh(a)$。\n\n我们现在得到了一个包含两个未知数 $\\kappa$ 和 $W$ 的方程组：\n1. $\\sigma = \\frac{2\\sqrt{2}}{3}\\sqrt{\\kappa W}$\n2. $\\ell = 2\\sqrt{2}\\sqrt{\\frac{\\kappa}{W}}\\arctanh(a)$\n\n为了用 $\\sigma$、$\\ell$ 和 $a$ 表示 $\\kappa$ 和 $W$，我们首先从以上两式中解出 $\\sqrt{\\kappa W}$ 和 $\\sqrt{\\kappa/W}$：\n$$\n\\sqrt{\\kappa W} = \\frac{3\\sigma}{2\\sqrt{2}}\n$$\n$$\n\\sqrt{\\frac{\\kappa}{W}} = \\frac{\\ell}{2\\sqrt{2}\\arctanh(a)}\n$$\n将这两个表达式相乘得到 $\\kappa$：\n$$\n\\kappa = \\left(\\sqrt{\\kappa W}\\right) \\left(\\sqrt{\\frac{\\kappa}{W}}\\right) = \\left(\\frac{3\\sigma}{2\\sqrt{2}}\\right) \\left(\\frac{\\ell}{2\\sqrt{2}\\arctanh(a)}\\right) = \\frac{3\\sigma\\ell}{8\\arctanh(a)}\n$$\n将第一个表达式除以第二个表达式得到 $W$：\n$$\nW = \\frac{\\sqrt{\\kappa W}}{\\sqrt{\\kappa/W}} = \\frac{3\\sigma/(2\\sqrt{2})}{\\ell/(2\\sqrt{2}\\arctanh(a))} = \\frac{3\\sigma \\arctanh(a)}{\\ell}\n$$\n因此，能够再现目标值的容许对 $(\\kappa, W)$ 为 $\\left(\\frac{3\\sigma\\ell}{8\\arctanh(a)}, \\frac{3\\sigma\\arctanh(a)}{\\ell}\\right)$。\n\n关于可辨识性：本问题中，由于势函数 $f(\\phi)$ 的形式是预先指定的，因此可以从两个可观测量 $(\\sigma, \\ell)$ 唯一地确定两个模型参数 $(\\kappa, W)$。然而，如果 $f(\\phi)$ 的函数形式不是先验已知的，而是属于一个更广泛的函数族，则会出现可辨识性问题。在这种情况下，$\\sigma$ 和 $\\ell$ 的表达式将依赖于与 $f(\\phi)$ 形状相关的无量纲积分。不同的参数 $(\\kappa, W)$ 和势函数形式的组合可能产生相同的 $\\sigma$ 和 $\\ell$ 测量值。这是一个经典的欠定逆问题：未知的模型参数多于独立的测量值。为了解决这种模糊性并唯一地辨识材料参数和势函数，将需要额外的、独立的实验数据，例如对完整界面剖面形状的直接测量、界面运动的动力学系数，或探测局域能量景观的光谱数据。",
            "answer": "$$\n\\boxed{\\left( \\frac{3\\sigma\\ell}{8\\arctanh(a)}, \\frac{3\\sigma\\arctanh(a)}{\\ell} \\right)}\n$$"
        },
        {
            "introduction": "Allen-Cahn 方程最重要的预测之一是在尖锐界面极限下，界面会根据其平均曲率演化。这个综合性练习旨在将理论与计算联系起来，您需要首先推导曲率驱动运动的尖锐界面定律，然后实现一个数值求解器来直接模拟 Allen-Cahn 方程。通过将模拟结果与理论预测进行比较，您将在验证连续介质模型和理解其渐近行为方面获得宝贵的实践经验。",
            "id": "3844103",
            "problem": "请在区域粗化的背景下考虑 Allen–Cahn 方程及其尖锐界面渐近行为。Allen–Cahn 方程是 Ginzburg–Landau 自由能的梯度流，广泛用于多尺度材料模拟，以模拟相分离和界面运动。在无量纲形式下，对于具有双阱势的序参量场 $u(\\mathbf{x},t)$，Allen–Cahn 方程为\n$$\n\\frac{\\partial u}{\\partial t} = \\Delta u - \\frac{1}{\\varepsilon^2}\\,f(u),\n$$\n其中 $\\Delta$ 是拉普拉斯算子，$\\varepsilon$ 是一个设定特征界面厚度的小正参数，$f(u)$ 是在 $u=\\pm 1$ 处有极小值的对称双阱势的导数。典型的选择是 $f(u) = u^3 - u$，相应的势为 $F(u) = \\frac{1}{4}(u^2 - 1)^2$。\n\n在尖锐界面极限（小 $\\varepsilon$）下，界面通过曲率驱动运动演化。对于二维中的圆形和三维中的球形等简单几何形状，这种运动可以完全由平均曲率来表征。您的任务是通过比较数值 Allen–Cahn 模拟与圆形和球形相应的尖锐界面曲率流，来验证渐近预测。\n\n从 Allen–Cahn 方程是 Ginzburg–Landau 自由能的 $L^2$ 梯度流这一基本基础出发\n$$\n\\mathcal{E}[u] = \\int \\left( \\frac{1}{2}\\lvert\\nabla u\\rvert^2 + \\frac{1}{\\varepsilon^2} F(u) \\right)\\,d\\mathbf{x},\n$$\n并基于经过充分检验的事实，即在小 $\\varepsilon$ 极限下，匹配渐近分析将 Allen–Cahn 动力学与平均曲率运动联系起来，请完成以下任务：\n\n- 从第一性原理出发，推导在平均曲率运动下，二维圆形和三维球体的有效半径 $R(t)$ 的曲率驱动演化定律，此定律由 Allen–Cahn 渐近理论所隐含。不要假设任何预先给定的公式；通过将平均曲率的定义与连接尖锐界面极限中法向速度和曲率的运动学关系相结合来推导该定律。\n- 设计并实现一个在周期性域上使用谱方法求解 Allen–Cahn 方程的稳定、半隐式数值求解器：\n  - 对扩散项使用线性隐式处理，对非线性项 $f(u)$ 使用显式处理。\n  - 在二维的 $N\\times N$ 和三维的 $N\\times N\\times N$ 均匀网格上，使用带有周期性边界条件的标准离散傅里叶变换。\n  - 将序参量 $u(\\mathbf{x},0)$ 初始化为一个近似的平衡界面，该界面对应于以域中心为中心的初始半径为 $R_0$ 的圆形或球形，例如，通过跨越到界面的有符号距离的双曲正切剖面来实现。\n- 在将 Allen–Cahn 方程演化一个短时间间隔 $t$ 后，通过将测量的 $u0$ 区域的面积（二维）或体积（三维）分别转换为圆形或球形的半径，来计算有效半径 $R_{\\mathrm{AC}}(t)$。\n- 计算从曲率流推导出的尖锐界面预测 $R_{\\mathrm{SI}}(t)$，并使用相对误差与 $R_{\\mathrm{AC}}(t)$ 进行比较\n$$\n\\mathrm{err} = \\frac{\\lvert R_{\\mathrm{AC}}(t) - R_{\\mathrm{SI}}(t) \\rvert}{R_{\\mathrm{SI}}(t)}.\n$$\n所有量均使用无量纲单位。\n\n您必须实现程序以运行以下测试套件，该套件涵盖了一般行为、早期阻尼和维度效应。对于每种情况，请完全按照给定的参数进行操作：\n\n- 在边长为 $L = 1$ 的方形周期域上的二维圆形情况：\n  1. $(\\text{dim}=2, N=128, L=1, \\varepsilon=0.02, R_0=0.25, \\Delta t=10^{-4}, \\text{steps}=150)$\n  2. $(\\text{dim}=2, N=128, L=1, \\varepsilon=0.02, R_0=0.20, \\Delta t=7.5\\times 10^{-5}, \\text{steps}=40)$\n- 在边长为 $L = 1$ 的立方周期域上的三维球形情况：\n  3. $(\\text{dim}=3, N=32, L=1, \\varepsilon=0.03, R_0=0.23, \\Delta t=10^{-4}, \\text{steps}=40)$\n  4. $(\\text{dim}=3, N=32, L=1, \\varepsilon=0.03, R_0=0.15, \\Delta t=7.5\\times 10^{-5}, \\text{steps}=40)$\n\n对于每种情况：\n- 使用 $u(\\mathbf{x},0) \\approx \\tanh\\!\\left(\\frac{R_0 - d(\\mathbf{x})}{\\sqrt{2}\\,\\varepsilon}\\right)$ 初始化 $u$，其中 $d(\\mathbf{x})$ 是距域中心的径向距离。\n- 使用半隐式谱方法将 Allen–Cahn 方程演化指定的步数。\n- 通过 $u0$ 区域的面积（二维）或体积（三维）估算 $R_{\\mathrm{AC}}(t)$，在二维中为 $R_{\\mathrm{AC}}(t) = \\sqrt{A/\\pi}$，在三维中为 $R_{\\mathrm{AC}}(t) = \\left(\\frac{3V}{4\\pi}\\right)^{1/3}$。\n- 计算 $t = \\text{steps} \\times \\Delta t$ 以及从您建立的平均曲率定律推导出的相应尖锐界面半径 $R_{\\mathrm{SI}}(t)$。\n- 以浮点数形式报告相对误差 $\\mathrm{err}$。\n\n您的程序应生成一行输出，其中包含一个逗号分隔的列表，该列表用方括号括起来，按上述四个测试用例的顺序排列结果，即 $\\big[\\mathrm{err}_1,\\mathrm{err}_2,\\mathrm{err}_3,\\mathrm{err}_4\\big]$。所有输出必须是无量纲的浮点数。不涉及任何角度或物理单位；始终使用无量纲量，并将所有时间、长度和误差表示为纯浮点值。",
            "solution": "### 第一部分：尖锐界面演化定律的推导\n\n在尖锐界面极限下 ($\\varepsilon \\to 0$)，Allen-Cahn方程的动力学等效于平均曲率流。界面的法向速度 $v_n$ 与其平均曲率 $\\kappa$ 成正比。对于给定的无量纲方程，此关系为：\n$$\nv_n = -\\kappa\n$$\n对于半径为 $R(t)$ 的径向对称界面，法向速度即为半径的变化率 $v_n = \\frac{dR}{dt}$。\n\n**情况1：二维 (2D) 中的圆形**\n半径为 $R$ 的圆形的平均曲率是 $\\kappa_{2D} = 1/R$。代入演化定律得到：\n$$\n\\frac{dR}{dt} = - \\frac{1}{R}\n$$\n这是一个可分离的常微分方程。在初始条件 $R(0) = R_0$ 下积分 $R \\, dR = -dt$ 可得：\n$$\n\\frac{1}{2}R(t)^2 - \\frac{1}{2}R_0^2 = -t \\implies R_{\\mathrm{SI}}(t) = \\sqrt{R_0^2 - 2t}\n$$\n\n**情况2：三维 (3D) 中的球体**\n半径为 $R$ 的球体的平均曲率是 $\\kappa_{3D} = 1/R + 1/R = 2/R$。代入演化定律得到：\n$$\n\\frac{dR}{dt} = - \\frac{2}{R}\n$$\n积分 $R \\, dR = -2dt$ 得到：\n$$\n\\frac{1}{2}R(t)^2 - \\frac{1}{2}R_0^2 = -2t \\implies R_{\\mathrm{SI}}(t) = \\sqrt{R_0^2 - 4t}\n$$\n\n### 第二部分：数值求解器设计\n\n我们将使用半隐式谱方法求解Allen-Cahn方程。方程的时间离散化（对扩散项隐式，对反应项显式）为：\n$$\n\\frac{u^{n+1} - u^n}{\\Delta t} = \\Delta u^{n+1} - \\frac{1}{\\varepsilon^2}f(u^n)\n$$\n应用傅里叶变换 $\\mathcal{F}$，并利用 $\\mathcal{F}\\{\\Delta u\\} = -|\\mathbf{k}|^2 \\hat{u}$，其中 $\\hat{u} = \\mathcal{F}\\{u\\}$ 且 $\\mathbf{k}$ 是波矢，我们得到傅里叶空间中的方程：\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} = -|\\mathbf{k}|^2 \\hat{u}^{n+1} - \\frac{1}{\\varepsilon^2}\\widehat{f(u^n)}\n$$\n求解 $\\hat{u}^{n+1}$，得到更新规则：\n$$\n\\hat{u}^{n+1} = \\frac{\\hat{u}^n - \\frac{\\Delta t}{\\varepsilon^2}\\widehat{f(u^n)}}{1 + \\Delta t |\\mathbf{k}|^2}\n$$\n\n### 第三部分：实现算法\n对于每个测试用例，模拟按以下步骤进行：\n1.  **设置**：在大小为 $N^d$ 的均匀网格上构建坐标和傅里叶空间的波矢。预计算更新规则中的分母项以提高效率。\n2.  **初始化**：使用给定的双曲正切剖面 $u(\\mathbf{x}, 0) = \\tanh\\left(\\frac{R_0 - d(\\mathbf{x})}{\\sqrt{2}\\,\\varepsilon}\\right)$ 初始化序参量场。\n3.  **时间演化**：对于指定的步数，在每个时间步中：\n    a. 计算非线性项 $f(u^n) = (u^n)^3 - u^n$。\n    b. 对 $u^n$ 和 $f(u^n)$ 进行傅里叶变换。\n    c. 应用傅里叶空间中的更新规则计算 $\\hat{u}^{n+1}$。\n    d. 将 $\\hat{u}^{n+1}$ 通过傅里叶逆变换转回实空间得到 $u^{n+1}$。\n4.  **分析**：演化结束后，在最终时间 $t = \\text{steps} \\times \\Delta t$：\n    a. 通过计算 $u > 0$ 的网格单元数量来估算模拟的有效半径 $R_{\\mathrm{AC}}(t)$。\n    b. 使用第一部分推导的解析公式计算理论半径 $R_{\\mathrm{SI}}(t)$。\n    c. 计算相对误差 $\\mathrm{err} = |R_{\\mathrm{AC}}(t) - R_{\\mathrm{SI}}(t)| / R_{\\mathrm{SI}}(t)$。\n对所有四个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # (dim, N, L, eps, R0, dt, steps)\n    test_cases = [\n        (2, 128, 1.0, 0.02, 0.25, 1e-4, 150),\n        (2, 128, 1.0, 0.02, 0.20, 7.5e-5, 40),\n        (3, 32, 1.0, 0.03, 0.23, 1e-4, 40),\n        (3, 32, 1.0, 0.03, 0.15, 7.5e-5, 40),\n    ]\n\n    results = []\n    for case in test_cases:\n        error = run_simulation(*case)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(dim, N, L, eps, R0, dt, steps):\n    \"\"\"\n    Runs a single Allen-Cahn simulation case and returns the relative error.\n\n    Args:\n        dim (int): Dimensionality of the problem (2 or 3).\n        N (int): Number of grid points along one dimension.\n        L (float): Length of the periodic domain.\n        eps (float): Interface thickness parameter.\n        R0 (float): Initial radius of the circle/sphere.\n        dt (float): Time step size.\n        steps (int): Number of time steps to evolve.\n\n    Returns:\n        float: The relative error between the simulated and theoretical radius.\n    \"\"\"\n    \n    # 1. Setup Grid and Wavevectors\n    h = L / N\n    # Create a centered coordinate system for easier distance calculation\n    coords1d = np.linspace(-L / 2, L / 2, N, endpoint=False)\n    \n    if dim == 2:\n        coords = np.meshgrid(coords1d, coords1d, indexing='ij')\n    elif dim == 3:\n        coords = np.meshgrid(coords1d, coords1d, coords1d, indexing='ij')\n    else:\n        raise ValueError(\"Dimension must be 2 or 3\")\n\n    dist = np.sqrt(sum(c**2 for c in coords))\n\n    # Wavevectors for FFT\n    k1d = 2 * np.pi * np.fft.fftfreq(N, d=h)\n    if dim == 2:\n        k_grids = np.meshgrid(k1d, k1d, indexing='ij')\n    else: # dim == 3\n        k_grids = np.meshgrid(k1d, k1d, k1d, indexing='ij')\n    \n    k_sq = sum(k**2 for k in k_grids)\n\n    # 2. Initialization\n    # Initial field u(x,0) using tanh profile\n    u = np.tanh((R0 - dist) / (np.sqrt(2) * eps))\n    \n    # Pre-compute the denominator for the spectral update rule\n    denominator = 1.0 + dt * k_sq\n    \n    # 3. Time Evolution (Semi-implicit Spectral Method)\n    for _ in range(steps):\n        # Go to Fourier space\n        u_hat = np.fft.fftn(u)\n        \n        # Calculate nonlinear term f(u) = u^3 - u in real space\n        nl_term = u**3 - u\n        nl_term_hat = np.fft.fftn(nl_term)\n        \n        # Update in Fourier space\n        u_hat_new = (u_hat - (dt / eps**2) * nl_term_hat) / denominator\n        \n        # Go back to real space\n        u = np.fft.ifftn(u_hat_new).real\n\n    # 4. Analysis\n    final_time = steps * dt\n    \n    # Calculate sharp-interface prediction R_SI(t)\n    if dim == 2:\n        # R(t)^2 = R0^2 - 2*t\n        r_si_sq = R0**2 - 2 * final_time\n        R_si = np.sqrt(r_si_sq) if r_si_sq  0 else 0.0\n    else: # dim == 3\n        # R(t)^2 = R0^2 - 4*t\n        r_si_sq = R0**2 - 4 * final_time\n        R_si = np.sqrt(r_si_sq) if r_si_sq  0 else 0.0\n\n    # Calculate Allen-Cahn effective radius R_AC(t)\n    # Count grid points where u  0 to get area/volume\n    positive_phase_volume = np.sum(u  0) * (h**dim)\n    \n    if dim == 2:\n        # A = pi * R^2 = R = sqrt(A/pi)\n        R_ac = np.sqrt(positive_phase_volume / np.pi)\n    else: # dim == 3\n        # V = (4/3) * pi * R^3 = R = (3*V / (4*pi))^(1/3)\n        R_ac = (3 * positive_phase_volume / (4 * np.pi))**(1/3)\n\n    # Compute relative error\n    if R_si  1e-9: # Avoid division by zero if circle has vanished\n        relative_error = np.abs(R_ac - R_si) / R_si\n    else:\n        relative_error = np.abs(R_ac)\n\n    return relative_error\n\nsolve()\n```"
        }
    ]
}