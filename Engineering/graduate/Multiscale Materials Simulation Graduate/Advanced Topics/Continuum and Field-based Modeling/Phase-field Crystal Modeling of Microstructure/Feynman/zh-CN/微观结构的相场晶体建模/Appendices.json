{
    "hands_on_practices": [
        {
            "introduction": "在深入研究相场晶体（PFC）模型的复杂应用之前，首要任务是掌握其数学基础。通过无量纲化，我们可以将控制方程转化为一种通用形式，这不仅简化了分析，还揭示了控制系统行为的关键参数组合。这项练习  将引导您完成对PFC自由能和动力学方程的严格无量纲化过程，这是将理论模型与具体物理系统联系起来的基石。",
            "id": "3831665",
            "problem": "考虑一个用于标量序参量场 $\\psi(\\mathbf{r},t)$ 的相场晶体（PFC）模型，该模型在扩散时间尺度上通过粗粒化自由能描述来捕捉原子尺度的周期性。有量纲的自由能泛函为\n$$\nF[\\psi] \\;=\\; \\int d^d r \\,\\left\\{ \\frac{A}{2}\\,\\psi^2 \\;+\\; \\frac{C}{2}\\,\\psi\\,\\big(q_0^2 + \\nabla_{\\mathbf{r}}^2\\big)^2\\,\\psi \\;+\\; \\frac{G}{3}\\,\\psi^3 \\;+\\; \\frac{U}{4}\\,\\psi^4 \\right\\},\n$$\n其中 $A$、$C$、$G$ 和 $U$ 是与材料相关的常数，$q_0$ 设定了主导的晶体波数，$d$ 是空间维度，$\\nabla_{\\mathbf{r}}^2$ 是关于 $\\mathbf{r}$ 的拉普拉斯算子。质量守恒的弛豫动力学由下式给出\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; M \\,\\nabla_{\\mathbf{r}}^2 \\,\\mu, \\quad \\mu \\;=\\; \\frac{\\delta F}{\\delta \\psi},\n$$\n其中 $M$ 是一个迁移率系数，$\\mu$ 是化学势。\n\n您的任务是基于第一性原理进行严格的无量纲化。定义标度化的长度 $\\mathbf{x} = q_0\\,\\mathbf{r}$，标度化的场 $\\psi(\\mathbf{r},t) = \\psi_0\\,n(\\mathbf{x},t)$（其中常数 $\\psi_0$ 的选择是为了获得典则无量纲形式），以及标度化的时间 $t' = t/t_0$（其中特征时间 $t_0$ 用 $M$、$C$ 和 $q_0$ 表示）。仅从给定的有量纲表达式以及泛函导数和微分算子的标准定义出发，构建无量纲自由能 $F^\\ast[n]$ 和 $n(\\mathbf{x},t')$ 的无量纲动力学，并施加典则归一化，使得 $F^\\ast$ 的被积函数中乘以 $n\\,\\big(1+\\nabla_{\\mathbf{x}}^2\\big)^2\\,n$ 的系数为 $1/2$，且四次项系数为 $1$。\n\n最后，请提供无量纲线性控制参数 $r$（$F^\\ast$ 被积函数中乘以 $n^2$ 的系数）的闭式解析表达式，该表达式应以 $A$、$C$ 和 $q_0$ 表示。最终答案必须是单一的解析表达式。不要计算任何数值。不需要四舍五入。最终答案中不需要物理单位。",
            "solution": "我们从给定的有量纲自由能泛函开始\n$$\nF[\\psi] \\;=\\; \\int d^d r \\,\\left\\{ \\frac{A}{2}\\,\\psi^2 \\;+\\; \\frac{C}{2}\\,\\psi\\,\\big(q_0^2 + \\nabla_{\\mathbf{r}}^2\\big)^2\\,\\psi \\;+\\; \\frac{G}{3}\\,\\psi^3 \\;+\\; \\frac{U}{4}\\,\\psi^4 \\right\\}.\n$$\n相应的化学势由泛函导数定义\n$$\n\\mu \\;=\\; \\frac{\\delta F}{\\delta \\psi} \\;=\\; A\\,\\psi \\;+\\; C\\,\\big(q_0^2 + \\nabla_{\\mathbf{r}}^2\\big)^2\\,\\psi \\;+\\; G\\,\\psi^2 \\;+\\; U\\,\\psi^3,\n$$\n这里我们利用了泛函导数的线性性质以及 $\\big(q_0^2 + \\nabla_{\\mathbf{r}}^2\\big)^2$ 的自伴性。守恒动力学是B模型类型的：\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; M\\,\\nabla_{\\mathbf{r}}^2 \\,\\mu.\n$$\n\n我们引入无量纲变量。定义无量纲位置 $\\mathbf{x} = q_0\\,\\mathbf{r}$，因此导数变换如下\n$$\n\\nabla_{\\mathbf{r}} \\;=\\; q_0\\,\\nabla_{\\mathbf{x}}, \\qquad \\nabla_{\\mathbf{r}}^2 \\;=\\; q_0^2\\,\\nabla_{\\mathbf{x}}^2,\n$$\n测度变换为 $d^d r = d^d x \\, q_0^{-d}$。定义标度化的场 $\\psi(\\mathbf{r},t) = \\psi_0\\,n(\\mathbf{x},t)$，其中恒定的振幅标度 $\\psi_0$ 待定。由此，自由能变为\n\\begin{align*}\nF[\\psi] = \\int d^d r \\left\\{ \\frac{A}{2}\\,\\psi^2 + \\frac{C}{2}\\,\\psi\\,\\big(q_0^2 + \\nabla_{\\mathbf{r}}^2\\big)^2\\,\\psi + \\frac{G}{3}\\,\\psi^3 + \\frac{U}{4}\\,\\psi^4 \\right\\} \\\\\n= \\int d^d x \\, q_0^{-d} \\left\\{ \\frac{A}{2}\\,\\psi_0^2\\,n^2 + \\frac{C}{2}\\,(\\psi_0 n)\\,\\big(q_0^2 + q_0^2 \\nabla_{\\mathbf{x}}^2\\big)^2\\,(\\psi_0 n) + \\frac{G}{3}\\,\\psi_0^3\\,n^3 + \\frac{U}{4}\\,\\psi_0^4\\,n^4 \\right\\}.\n\\end{align*}\n使用 $\\big(q_0^2 + \\nabla_{\\mathbf{r}}^2\\big)^2 = \\big(q_0^2 + q_0^2 \\nabla_{\\mathbf{x}}^2\\big)^2 = q_0^4 \\big(1 + \\nabla_{\\mathbf{x}}^2\\big)^2$，第二项简化为 $\\frac{C}{2}\\,\\psi_0^2\\,q_0^4\\,n\\,\\big(1 + \\nabla_{\\mathbf{x}}^2\\big)^2\\,n$。我们现在提取出一个能量标度\n$$\nF_0 \\;=\\; C\\,\\psi_0^2\\,q_0^{4-d},\n$$\n使得无量纲自由能 $F^\\ast = F/F_0$ 表达式为\n\\begin{align*}\nF^\\ast[n] = \\int d^d x \\left\\{ \\frac{1}{2}\\,n\\,\\big(1 + \\nabla_{\\mathbf{x}}^2\\big)^2\\,n \\;+\\; \\frac{A}{2\\,C\\,q_0^4}\\,n^2 \\;+\\; \\frac{G\\,\\psi_0}{3\\,C\\,q_0^4}\\,n^3 \\;+\\; \\frac{U\\,\\psi_0^2}{4\\,C\\,q_0^4}\\,n^4 \\right\\}.\n\\end{align*}\n这实现了典则归一化，其中 $n\\,\\big(1+\\nabla_{\\mathbf{x}}^2\\big)^2\\,n$ 的系数为 $\\frac{1}{2}$，且与 $d$ 无关。为了完成典则形式，我们选择 $\\psi_0$ 将四次项系数固定为 $1$，即\n$$\n\\frac{U\\,\\psi_0^2}{4\\,C\\,q_0^4} = 1 \\quad \\Rightarrow \\quad \\psi_0^2 = \\frac{4\\,C\\,q_0^4}{U} \\quad \\Rightarrow \\quad \\psi_0 = 2\\sqrt{\\frac{C\\,q_0^4}{U}}.\n$$\n做出此选择后，无量纲自由能的被积函数包含项 $\\frac{A}{2\\,C\\,q_0^4}\\,n^2$、$\\frac{G\\psi_0}{3Cq_0^4}\\,n^3$ 和 $n^4$。因此无量纲系数为\n$$\nr \\;=\\; \\frac{A}{C\\,q_0^4}, \\qquad v \\;=\\; \\frac{G\\,\\psi_0}{C\\,q_0^4} \\;=\\; \\frac{2G}{\\sqrt{U\\,C\\,q_0^4}}, \\qquad u \\;=\\; 1.\n$$\n\n我们现在对动力学进行无量纲化。化学势的标度关系如下\n\\begin{align*}\n\\mu = A\\,\\psi + C\\,\\big(q_0^2 + \\nabla_{\\mathbf{r}}^2\\big)^2\\,\\psi + G\\,\\psi^2 + U\\,\\psi^3 \\\\\n= \\psi_0 \\left[ A\\,n + C\\,q_0^4\\,\\big(1 + \\nabla_{\\mathbf{x}}^2\\big)^2\\,n + G\\,\\psi_0\\,n^2 + U\\,\\psi_0^2\\,n^3 \\right].\n\\end{align*}\n引入化学势标度 $\\mu_0 = C\\,\\psi_0\\,q_0^4$，得到无量纲化学势 $\\mu^* = \\mu/\\mu_0$\n$$\n\\mu^* \\;=\\; \\frac{A}{Cq_0^4}\\,n \\;+\\; \\big(1 + \\nabla_{\\mathbf{x}}^2\\big)^2\\,n \\;+\\; \\frac{G\\psi_0}{Cq_0^4}\\,n^2 \\;+\\; \\frac{U\\psi_0^2}{Cq_0^4}\\,n^3.\n$$\n注意，由 $\\frac{U\\psi_0^2}{4Cq_0^4}=1$ 可得 $\\frac{U\\psi_0^2}{Cq_0^4}=4$。因此\n$$\n\\mu^* = r\\,n \\;+\\; \\big(1 + \\nabla_{\\mathbf{x}}^2\\big)^2\\,n \\;+\\; v\\,n^2 \\;+\\; 4\\,n^3.\n$$\n动力学方程变为\n\\begin{align*}\n\\frac{\\partial \\psi}{\\partial t} = M\\,\\nabla_{\\mathbf{r}}^2 \\,\\mu \\;=\\; M\\,q_0^2\\,\\nabla_{\\mathbf{x}}^2 \\,\\mu \\\\\n\\Rightarrow \\quad \\psi_0\\,\\frac{\\partial n}{\\partial t} = M\\,q_0^2\\,\\nabla_{\\mathbf{x}}^2 \\,\\mu_0 \\mu^* \\\\\n\\Rightarrow \\quad \\frac{\\partial n}{\\partial t} = \\frac{M q_0^2 \\mu_0}{\\psi_0} \\nabla_{\\mathbf{x}}^2 \\mu^* = \\big(M\\,C\\,q_0^6\\big)\\,\\nabla_{\\mathbf{x}}^2 \\mu^*,\n\\end{align*}\n其中我们使用了 $\\mu_0 = C\\,\\psi_0\\,q_0^4$ 并消去了 $\\psi_0$。定义特征时间 $t_0$ 为\n$$\nt_0 \\;=\\; \\frac{1}{M\\,C\\,q_0^6}, \\qquad t' \\;=\\; \\frac{t}{t_0}.\n$$\n于是，无量纲动力学方程为\n$$\n\\frac{\\partial n}{\\partial t'} \\;=\\; \\nabla_{\\mathbf{x}}^2 \\left[ r\\,n + \\big(1 + \\nabla_{\\mathbf{x}}^2\\big)^2\\,n + v\\,n^2 + 4\\,n^3 \\right],\n$$\n其中 $r$ 和 $v$ 如上所示，这与指定的典则归一化一致。\n\n因此，所求的无量纲线性控制参数 $r$ 可通过二次项的无量纲化直接得到（在标准形式 $\\frac{r}{2}n^2$ 中）：\n$$\nr \\;=\\; \\frac{A}{C\\,q_0^4}.\n$$\n这是一个仅依赖于 $A$、$C$ 和 $q_0$ 的闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{A}{C\\,q_0^4}}$$"
        },
        {
            "introduction": "掌握了无量纲化的控制方程后，下一步便是将其转化为可执行的计算模型。伪谱法因其在处理周期性边界条件下的微分方程时具有高精度和高效率，是求解PFC方程的理想选择。本练习  要求您从零开始，构建一个基于傅里叶空间的半隐式时间积分求解器，并借此验证PFC模型的一个核心物理特性——质量守恒。亲手实现这一过程，将极大地加深您对PFC动力学模拟背后数值原理的理解。",
            "id": "3831730",
            "problem": "给定一个周期性区域中守恒序参量场 $ \\psi(\\mathbf{r}, t) $ 的无量纲相场晶体 (PFC) 动力学。其热力学驱动力是粗粒化自由能的泛函导数。考虑自由能\n$$\nF[\\psi] = \\int_{\\Omega} \\left[ \\frac{1}{2}\\,\\psi\\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\psi + \\frac{1}{4}\\,\\psi^4 \\right]\\, d\\mathbf{r},\n$$\n其中 $ \\Omega $ 是一个 $ d $ 维周期性区域，$ r \\in \\mathbb{R} $ 是一个控制参数，且所有量均为无量纲。化学势为 $ \\mu = \\delta F/\\delta \\psi $，其演化方程是一个守恒梯度流\n$$\n\\frac{\\partial \\psi}{\\partial t} = \\nabla^2 \\mu,\n$$\n满足在 $ \\Omega $ 上的周期性边界条件。总质量定义为\n$$\nM(t) = \\int_{\\Omega} \\psi(\\mathbf{r}, t)\\, d\\mathbf{r}.\n$$\n\n从第一性原理和核心定义出发，实现一个数值求解器，该求解器在具有周期性边界的均匀网格上，使用傅里叶空间中的伪谱法来对 $ \\psi $ 进行时间演化。你的求解器必须：\n- 在大小为 $ L_x \\times L_y $ 的矩形区域上，使用一个具有 $ N_x \\times N_y $ 个节点和周期性边界条件的均匀网格。\n- 通过波矢为 $ \\mathbf{k} = (k_x, k_y) $ 的傅里叶模来表示空间导数，其中傅里叶微分映射为 $ \\nabla^2 \\mapsto -|\\mathbf{k}|^2 $。\n- 在与守恒梯度流和周期性一致的一阶精度时间积分中，对线性项进行隐式处理，对非线性项进行显式处理。不要使用任何混叠校正。\n- 至少在初始和最终时刻，通过均匀网格上的梯形法则计算总质量 $ M(t) $，在此周期性和均匀网格设置下，该法则恰好是矩形法则：\n$$\nM(t) = \\left(\\sum_{i=1}^{N_x}\\sum_{j=1}^{N_y} \\psi_{i,j}(t)\\right)\\, \\Delta x\\, \\Delta y,\n$$\n其中 $ \\Delta x = L_x/N_x $ 且 $ \\Delta y = L_y/N_y $。\n- 对每个测试用例，以浮点数形式报告绝对差 $ \\Delta M = |M(t_{\\text{final}}) - M(0)| $。所有报告的数字都是无单位的。\n\n设计一个独立的程序（无用户输入），运行以下测试套件，并在一行中输出包含四个结果的列表 $ [\\Delta M_1, \\Delta M_2, \\Delta M_3, \\Delta M_4] $，以逗号分隔并用方括号括起。初始条件在实空间中指定如下，其中 $ x \\in [0, L_x) $ 且 $ y \\in [0, L_y) $：\n- 测试用例 $ 1 $ (正常路径随机平均场):\n  - $ N_x = 32 $，$ N_y = 32 $，$ L_x = 32 $，$ L_y = 32 $，$ r = -0.25 $，$ \\Delta t = 0.1 $，$ n_{\\text{steps}} = 50 $。\n  - 初始条件 $ \\psi(\\mathbf{r},0) = m + a \\,\\xi(\\mathbf{r}) $，其中 $ m = 0.1 $，$ a = 0.01 $，$ \\xi $ 是一个在 $ [-0.5, 0.5] $ 范围内的独立值的可复现伪随机场（使用固定种子）。\n- 测试用例 $ 2 $ (结构化正弦模):\n  - $ N_x = 64 $，$ N_y = 64 $，$ L_x = 64 $，$ L_y = 64 $，$ r = -0.5 $，$ \\Delta t = 0.05 $，$ n_{\\text{steps}} = 20 $。\n  - 初始条件 $ \\psi(\\mathbf{r},0) = m + a\\left[ \\cos\\left( \\frac{2\\pi m_x x}{L_x} \\right)\\cos\\left( \\frac{2\\pi m_y y}{L_y} \\right) \\right] $，其中 $ m = 0 $，$ a = 0.1 $，$ m_x = 3 $，$ m_y = 2 $。\n- 测试用例 $ 3 $ (边界情况，常数场):\n  - $ N_x = 16 $，$ N_y = 16 $，$ L_x = 16 $，$ L_y = 16 $，$ r = -0.25 $，$ \\Delta t = 0.5 $，$ n_{\\text{steps}} = 5 $。\n  - 初始条件 $ \\psi(\\mathbf{r},0) = m $，其中 $ m = 0.2 $。\n- 测试用例 $ 4 $ (边缘情况，零线性驱动参数):\n  - $ N_x = 48 $，$ N_y = 48 $，$ L_x = 48 $，$ L_y = 48 $，$ r = 0 $，$ \\Delta t = 0.2 $，$ n_{\\text{steps}} = 10 $。\n  - 初始条件 $ \\psi(\\mathbf{r},0) = m + a \\,\\xi(\\mathbf{r}) $，其中 $ m = -0.02 $，$ a = 0.02 $，$ \\xi $ 是一个与测试用例 $ 1 $ 中类似的可复现伪随机场（使用不同的固定种子）。\n\n你的程序必须：\n- 仅从上述定义出发，实现与守恒 PFC 动力学和周期性边界条件一致的伪谱时间步进法。\n- 对每个测试用例，计算定义的 $ \\Delta M $ 并将其存储为浮点数。\n- 生成一行输出，其中包含以逗号分隔并用方括号括起来的结果，例如 $ [\\Delta M_1,\\Delta M_2,\\Delta M_3,\\Delta M_4] $。\n- 所有量均为无量纲；报告无单位的数字。\n\n注：\n- 算法的选择必须确保零波矢模的处理与周期性守恒一致，从而使 $ M(t) $ 在数值舍入误差范围内保持不变。\n- 所报告的 $ \\Delta M $ 值应该很小（接近机器精度），但你必须报告原始计算值，而不应用阈值或转换为布尔值。",
            "solution": "该问题是有效的，因为它在科学上基于已建立的相场晶体 (PFC) 方法论，其参数完备且一致，问题本身表述良好，并以客观、正式的语言表达。我们开始求解。\n\n问题的核心是在二维周期性区域 $ \\Omega $ 上求解守恒序参量场 $ \\psi(\\mathbf{r}, t) $ 的 PFC 演化方程。其动力学由从粗粒化自由能泛函 $ F[\\psi] $ 导出的守恒梯度流所控制。\n\n自由能泛函由下式给出：\n$$\nF[\\psi] = \\int_{\\Omega} \\left[ \\frac{1}{2}\\,\\psi\\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\psi + \\frac{1}{4}\\,\\psi^4 \\right]\\, d\\mathbf{r}\n$$\n此处，$ r $ 是一个控制参数，$ \\nabla^2 $ 是拉普拉斯算子。项 $ (1 + \\nabla^2)^2 $ 惩罚了对特征长度尺度的偏离，从而导致周期性（晶体）结构。$ \\psi^4 $ 项是一个标准的双势阱，用于稳定场。\n\n化学势 $ \\mu $ 是自由能相对于场 $ \\psi $ 的泛函导数：\n$$\n\\mu = \\frac{\\delta F}{\\delta \\psi}\n$$\n为计算此导数，我们考虑一个小的变分 $ \\delta\\psi $：\n$$\n\\delta F = \\int_{\\Omega} \\left[ \\frac{1}{2}\\,\\delta\\psi\\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\psi + \\frac{1}{2}\\,\\psi\\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\delta\\psi + \\psi^3 \\delta\\psi \\right]\\, d\\mathbf{r}\n$$\n在周期性边界条件下，算子 $ r + (1 + \\nabla^2)^2 $ 是自伴的。因此，被积函数中的前两项是相同的。这导致：\n$$\n\\delta F = \\int_{\\Omega} \\left[ \\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\psi + \\psi^3 \\right] \\delta\\psi \\, d\\mathbf{r}\n$$\n根据泛函导数的定义，我们确定化学势为：\n$$\n\\mu(\\mathbf{r}, t) = \\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\psi + \\psi^3\n$$\n\n$ \\psi $ 的演化遵循一个 Cahn-Hilliard 类型的守恒动力学方程：\n$$\n\\frac{\\partial \\psi}{\\partial t} = \\nabla^2 \\mu = \\nabla^2 \\left[ \\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\psi + \\psi^3 \\right]\n$$\n这可以分离为线性和非线性部分：\n$$\n\\frac{\\partial \\psi}{\\partial t} = \\nabla^2 \\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\psi + \\nabla^2(\\psi^3)\n$$\n\n为数值求解此偏微分方程，我们采用伪谱法，该方法对于周期性边界条件问题非常高效。该方法涉及将方程变换到傅里叶空间。令 $ \\hat{\\psi}(\\mathbf{k}, t) = \\mathcal{F}\\{\\psi(\\mathbf{r}, t)\\} $ 为 $ \\psi(\\mathbf{r}, t) $ 的傅里叶变换，其中 $ \\mathbf{k}=(k_x, k_y) $ 是波矢。在傅里叶空间中，拉普拉斯算子变为简单的乘法：$ \\mathcal{F}\\{\\nabla^2 f\\} = -|\\mathbf{k}|^2 \\hat{f} $，其中 $ |\\mathbf{k}|^2 = k_x^2 + k_y^2 $。\n\n对演化方程应用傅里叶变换，得到：\n$$\n\\frac{\\partial \\hat{\\psi}}{\\partial t} = -|\\mathbf{k}|^2 \\left[ \\left( r + (1 - |\\mathbf{k}|^2)^2 \\right)\\hat{\\psi} + \\mathcal{F}\\{\\psi^3\\} \\right]\n$$\n我们可以将其写为：\n$$\n\\frac{\\partial \\hat{\\psi}}{\\partial t} = L(\\mathbf{k}) \\hat{\\psi} + N(\\psi)\n$$\n其中线性部分为 $ L(\\mathbf{k}) = -|\\mathbf{k}|^2\\left(r + (1 - |\\mathbf{k}|^2)^2\\right) $，非线性部分为 $ N(\\psi) = -|\\mathbf{k}|^2\\mathcal{F}\\{\\psi^3\\} $。\n\n问题指定了一个一阶时间积分方案，其中线性项被隐式处理，非线性项被显式处理。这是一种半隐式欧拉（或前向-后向欧拉）方案。对于时间步长 $ \\Delta t $，我们将方程离散化为：\n$$\n\\frac{\\hat{\\psi}^{n+1} - \\hat{\\psi}^n}{\\Delta t} = L(\\mathbf{k}) \\hat{\\psi}^{n+1} + N(\\psi^n)\n$$\n其中上标 $ n $ 和 $ n+1 $ 分别表示当前和下一个时间层级。重新整理以求解 $ \\hat{\\psi}^{n+1} $：\n$$\n\\hat{\\psi}^{n+1}(1 - \\Delta t L(\\mathbf{k})) = \\hat{\\psi}^n + \\Delta t N(\\psi^n)\n$$\n$$\n\\hat{\\psi}^{n+1}(\\mathbf{k}) = \\frac{\\hat{\\psi}^n(\\mathbf{k}) + \\Delta t N(\\psi^n)}{1 - \\Delta t L(\\mathbf{k})}\n$$\n代入 $ L(\\mathbf{k}) $ 和 $ N(\\psi^n) $ 的表达式：\n$$\n\\hat{\\psi}^{n+1}(\\mathbf{k}) = \\frac{\\hat{\\psi}^n(\\mathbf{k}) - \\Delta t |\\mathbf{k}|^2 \\mathcal{F}\\{(\\psi^n)^3\\}}{1 + \\Delta t |\\mathbf{k}|^2 \\left(r + (1-|\\mathbf{k}|^2)^2\\right)}\n$$\n这就是场在傅里叶空间中的更新规则。\n\n该方案的一个关键特征是其对质量守恒的处理。总质量 $ M(t) = \\int_{\\Omega} \\psi(\\mathbf{r}, t) d\\mathbf{r} $ 与零波矢傅里叶模 $ \\hat{\\psi}(\\mathbf{k}=\\mathbf{0}) $ 成正比。对于 $ \\mathbf{k}=\\mathbf{0} $ 模，$ |\\mathbf{k}|^2=0 $。更新方程简化为：\n$$\n\\hat{\\psi}^{n+1}(\\mathbf{0}) = \\frac{\\hat{\\psi}^n(\\mathbf{0}) - \\Delta t \\cdot 0 \\cdot \\mathcal{F}\\{(\\psi^n)^3\\}(\\mathbf{0})}{1 + \\Delta t \\cdot 0 \\cdot (\\dots)} = \\hat{\\psi}^n(\\mathbf{0})\n$$\n这表明 $ \\mathbf{k}=\\mathbf{0} $ 模被数值方案精确守恒。总质量的任何变化（计算为 $ M(t) = (\\sum_{i,j} \\psi_{i,j}(t)) \\Delta x \\Delta y $）将仅由浮点舍入误差引起，并预期接近机器精度。\n\n每个测试用例的数值算法如下：\n1.  初始化参数：$ N_x, N_y, L_x, L_y, r, \\Delta t, n_{\\text{steps}} $。\n2.  定义实空间网格坐标 $ x, y $ 和网格间距 $ \\Delta x = L_x/N_x, \\Delta y = L_y/N_y $。\n3.  定义傅里叶空间波矢分量 $ k_x, k_y $，并构建二维波矢网格 $ \\mathbf{k}=(k_x, k_y) $ 和模平方网格 $ |\\mathbf{k}|^2 $。\n4.  在实空间网格上生成初始条件 $ \\psi(\\mathbf{r}, 0) $。\n5.  使用提供的求和公式计算初始质量 $ M(0) $。\n6.  循环 $ n_{\\text{steps}} $ 次：\n    a.  计算当前场的傅里叶变换，$ \\hat{\\psi}^n = \\mathcal{F}\\{\\psi^n\\} $。\n    b.  在实空间中计算非线性项 $ (\\psi^n)^3 $，并对其进行傅里叶变换，得到 $ \\mathcal{F}\\{(\\psi^n)^3\\} $。\n    c.  在傅里叶空间中应用半隐式更新公式计算 $ \\hat{\\psi}^{n+1} $。\n    d.  通过傅里叶逆变换计算新的实空间场，$ \\psi^{n+1} = \\mathcal{F}^{-1}\\{\\hat{\\psi}^{n+1}\\} $。结果应为实数，因此我们取其实部以丢弃由舍入误差产生的可忽略的虚部。\n7.  循环结束后，计算最终质量 $ M(t_{\\text{final}}) $。\n8.  计算测试用例的最终结果 $ \\Delta M = |M(t_{\\text{final}}) - M(0)| $。\n\n对所提供的四个测试用例中的每一个都实施此程序。",
            "answer": "```python\nimport numpy as np\n\ndef run_simulation(Nx, Ny, Lx, Ly, r, dt, n_steps, initial_condition_func):\n    \"\"\"\n    Runs a single Phase-Field Crystal simulation.\n\n    Args:\n        Nx (int): Number of grid points in x.\n        Ny (int): Number of grid points in y.\n        Lx (float): Domain size in x.\n        Ly (float): Domain size in y.\n        r (float): Control parameter.\n        dt (float): Time step size.\n        n_steps (int): Number of time steps.\n        initial_condition_func (function): A function that returns the initial psi field.\n\n    Returns:\n        float: The absolute difference between final and initial total mass.\n    \"\"\"\n    # Grid and wavevector setup\n    dx = Lx / Nx\n    dy = Ly / Ny\n    \n    # Create wavevectors in the order numpy.fft expects them\n    kx_vals = 2 * np.pi * np.fft.fftfreq(Nx, d=dx)\n    ky_vals = 2 * np.pi * np.fft.fftfreq(Ny, d=dy)\n    kx, ky = np.meshgrid(kx_vals, ky_vals)\n    k2 = kx**2 + ky**2\n    \n    # Initial condition\n    psi = initial_condition_func(Nx, Ny, Lx, Ly)\n    \n    # Calculate initial mass\n    mass_initial = np.sum(psi) * dx * dy\n    \n    # Pre-compute the denominator for the time-stepping update rule\n    # Denominator: 1 + dt * |k|^2 * (r + (1 - |k|^2)^2)\n    denominator = 1 + dt * k2 * (r + (1 - k2)**2)\n    # Avoid division by zero, though for k=0, denominator is 1\n    # For very large k, denominator can be huge, which is fine\n    \n    # Time-stepping loop\n    psi_hat = np.fft.fft2(psi)\n\n    for _ in range(n_steps):\n        # Compute nonlinear term in real space and transform\n        psi_cubed = psi**3\n        psi_cubed_hat = np.fft.fft2(psi_cubed)\n        \n        # Update rule in Fourier space\n        # Numerator: psi_hat - dt * |k|^2 * FFT(psi^3)\n        numerator = psi_hat - dt * k2 * psi_cubed_hat\n        \n        psi_hat = numerator / denominator\n        \n        # Transform back to real space for the next iteration's nonlinear term\n        # The result of ifft2 on a field with appropriate symmetry will be real.\n        # Taking .real discards negligible imaginary parts due to roundoff.\n        psi = np.fft.ifft2(psi_hat).real\n\n    # Calculate final mass\n    mass_final = np.sum(psi) * dx * dy\n    \n    # Compute the absolute difference in mass\n    delta_mass = abs(mass_final - mass_initial)\n    \n    return delta_mass\n\ndef solve():\n    \"\"\"\n    Defines and runs the test suite for the PFC simulation.\n    \"\"\"\n    test_cases = [\n        # Test case 1 (happy path random mean field)\n        {\n            \"params\": {\"Nx\": 32, \"Ny\": 32, \"Lx\": 32, \"Ly\": 32, \"r\": -0.25, \"dt\": 0.1, \"n_steps\": 50},\n            \"ic_func\": lambda Nx, Ny, Lx, Ly: (\n                0.1 + 0.01 * (np.random.default_rng(seed=42).uniform(-0.5, 0.5, size=(Ny, Nx)))\n            ),\n        },\n        # Test case 2 (structured sinusoidal mode)\n        {\n            \"params\": {\"Nx\": 64, \"Ny\": 64, \"Lx\": 64, \"Ly\": 64, \"r\": -0.5, \"dt\": 0.05, \"n_steps\": 20},\n            \"ic_func\": lambda Nx, Ny, Lx, Ly: (\n                (lambda m, a, mx, my: (\n                    m + a * (np.cos(2 * np.pi * mx * np.linspace(0, Lx, Nx, endpoint=False) / Lx)[np.newaxis, :]) *\n                           (np.cos(2 * np.pi * my * np.linspace(0, Ly, Ny, endpoint=False) / Ly)[:, np.newaxis])\n                ))(m=0.0, a=0.1, mx=3, my=2)\n            ),\n        },\n        # Test case 3 (boundary case, constant field)\n        {\n            \"params\": {\"Nx\": 16, \"Ny\": 16, \"Lx\": 16, \"Ly\": 16, \"r\": -0.25, \"dt\": 0.5, \"n_steps\": 5},\n            \"ic_func\": lambda Nx, Ny, Lx, Ly: 0.2 * np.ones((Ny, Nx)),\n        },\n        # Test case 4 (edge case, zero linear driving parameter)\n        {\n            \"params\": {\"Nx\": 48, \"Ny\": 48, \"Lx\": 48, \"Ly\": 48, \"r\": 0.0, \"dt\": 0.2, \"n_steps\": 10},\n            \"ic_func\": lambda Nx, Ny, Lx, Ly: (\n                -0.02 + 0.02 * (np.random.default_rng(seed=1337).uniform(-0.5, 0.5, size=(Ny, Nx)))\n            ),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_m = run_simulation(\n            Nx=case[\"params\"][\"Nx\"],\n            Ny=case[\"params\"][\"Ny\"],\n            Lx=case[\"params\"][\"Lx\"],\n            Ly=case[\"params\"][\"Ly\"],\n            r=case[\"params\"][\"r\"],\n            dt=case[\"params\"][\"dt\"],\n            n_steps=case[\"params\"][\"n_steps\"],\n            initial_condition_func=case[\"ic_func\"]\n        )\n        results.append(delta_m)\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "PFC模拟能够生成丰富的微观结构，例如条纹状或六方晶格，但这些特定物相为何会在特定条件下出现？弱非线性分析为我们提供了洞察这一问题的强大理论工具。通过在失稳阈值附近进行多尺度展开，我们可以推导出描述不同模式之间竞争的振幅方程。这项高级练习  将指导您推导这些振幅方程，并确定条纹相和六方相出现的相变点，从而揭示模型的控制参数（如过冷度 $r$ 和平均密度 $\\bar{\\psi}$）与最终稳定微观结构之间的深刻联系。",
            "id": "3831515",
            "problem": "考虑标量原子密度场 $\\psi(\\mathbf{x},t)$ 的相场晶体（PFC）模型，其在守恒梯度动力学下演化，由自由能泛函定义\n$$\nF[\\psi] = \\int_{\\Omega} \\left[ \\frac{1}{2}\\,\\psi\\,\\left(r + (1 + \\nabla^2)^2\\right)\\,\\psi + \\frac{1}{4}\\,\\psi^4 \\right]\\,\\mathrm{d}\\mathbf{x},\n$$\n以及动力学方程\n$$\n\\frac{\\partial \\psi}{\\partial t} = \\nabla^2\\left( \\frac{\\delta F}{\\delta \\psi} \\right) = \\nabla^2\\left( r\\,\\psi + (1 + \\nabla^2)^2 \\psi + \\psi^3 \\right),\n$$\n该方程为无量纲形式，其中 $r$ 是一个控制参数。设区域 $\\Omega$ 足够大且各向同性，从而可以忽略边界效应，并假设均匀态 $\\psi(\\mathbf{x},t) \\equiv \\bar{\\psi}$ 受到特征波数 $k_0$ 接近于1的空间周期性模的扰动。定义涨落 $\\phi(\\mathbf{x},t) = \\psi(\\mathbf{x},t) - \\bar{\\psi}$，并假设在不稳定性发生的临界点附近存在弱非线性斑图形成，其中 $\\phi$ 可以用一个慢变的复振幅，在一个小参数 $\\epsilon \\ll 1$下展开。\n\n从上述自由能和动力学方程出发，利用在临界波数 $k_0 = 1$ 附近的系统性多尺度展开，推导控制以下两者之间竞争的领头阶振幅方程：\n- 条纹（或称滚卷），由单个临界模表示，其波矢为 $\\mathbf{q}_1$，大小为 $|\\mathbf{q}_1| = 1$，以及\n- 六边形，由三个临界模表示，其波矢为 $\\mathbf{q}_1$、$\\mathbf{q}_2$、$\\mathbf{q}_3$，大小相等 $|\\mathbf{q}_i| = 1$，相互夹角为 $120^\\circ$，满足三波共振条件 $\\mathbf{q}_1 + \\mathbf{q}_2 + \\mathbf{q}_3 = \\mathbf{0}$。\n\n将振幅视为慢时间变量的函数，并假设 $r$ 相对于 $\\bar{\\psi}$ 的近阈值标度能够产生非平凡的弱非线性动力学。仔细识别并保留所有对振幅演化的领头阶有贡献的共振项，包括那些由非零平均密度 $\\bar{\\psi}$ 的存在引起的项。\n\n然后，通过分析所推导的振幅方程的稳态解：\n1. 确定作为 $r$ 和 $\\bar{\\psi}$ 函数的条纹出现的叉式分岔阈值。\n2. 确定作为 $r$ 和 $\\bar{\\psi}$ 函数的等振幅六边形出现的鞍结分岔阈值。\n\n以 $\\bar{\\psi}$ 的闭式解析表达式对的形式给出你的最终答案，分别给出条纹和六边形的阈值。不需要进行数值计算，也不需要报告单位。以精确形式提供最终表达式，不要四舍五入。",
            "solution": "用户希望我解决以下问题：\n考虑标量原子密度场 $\\psi(\\mathbf{x},t)$ 的相场晶体（PFC）模型，其在守恒梯度动力学下演化，由自由能泛函定义\n$$\nF[\\psi] = \\int_{\\Omega} \\left[ \\frac{1}{2}\\,\\psi\\,\\left(r + (1 + \\nabla^2)^2\\right)\\,\\psi + \\frac{1}{4}\\,\\psi^4 \\right]\\,\\mathrm{d}\\mathbf{x},\n$$\n以及动力学方程\n$$\n\\frac{\\partial \\psi}{\\partial t} = \\nabla^2\\left( \\frac{\\delta F}{\\delta \\psi} \\right) = \\nabla^2\\left( r\\,\\psi + (1 + \\nabla^2)^2 \\psi + \\psi^3 \\right),\n$$\n该方程为无量纲形式，其中 $r$ 是一个控制参数。设区域 $\\Omega$ 足够大且各向同性，从而可以忽略边界效应，并假设均匀态 $\\psi(\\mathbf{x},t) \\equiv \\bar{\\psi}$ 受到特征波数 $k_0$ 接近于1的空间周期性模的扰动。定义涨落 $\\phi(\\mathbf{x},t) = \\psi(\\mathbf{x},t) - \\bar{\\psi}$，并假设在不稳定性发生的临界点附近存在弱非线性斑图形成，其中 $\\phi$ 可以用一个慢变的复振幅，在一个小参数 $\\epsilon \\ll 1$下展开。\n\n从上述自由能和动力学方程出发，利用在临界波数 $k_0 = 1$ 附近的系统性多尺度展开，推导控制以下两者之间竞争的领头阶振幅方程：\n- 条纹（或称滚卷），由单个临界模表示，其波矢为 $\\mathbf{q}_1$，大小为 $|\\mathbf{q}_1| = 1$，以及\n- 六边形，由三个临界模表示，其波矢为 $\\mathbf{q}_1$、$\\mathbf{q}_2$、$\\mathbf{q}_3$，大小相等 $|\\mathbf{q}_i| = 1$，相互夹角为 $120^\\circ$，满足三波共振条件 $\\mathbf{q}_1 + \\mathbf{q}_2 + \\mathbf{q}_3 = \\mathbf{0}$。\n\n将振幅视为慢时间变量的函数，并假设 $r$ 相对于 $\\bar{\\psi}$ 的近阈值标度能够产生非平凡的弱非线性动力学。仔细识别并保留所有对振幅演化的领头阶有贡献的共振项，包括那些由非零平均密度 $\\bar{\\psi}$ 的存在引起的项。\n\n然后，通过分析所推导的振幅方程的稳态解：\n1. 确定作为 $r$ 和 $\\bar{\\psi}$ 函数的条纹出现的叉式分岔阈值。\n2. 确定作为 $r$ 和 $\\bar{\\psi}$ 函数的等振幅六边形出现的鞍结分岔阈值。\n\n以 $\\bar{\\psi}$ 的闭式解析表达式对的形式给出你的最终答案，分别给出条纹和六边形的阈值。不需要进行数值计算，也不需要报告单位。以精确形式提供最终表达式，不要四舍五入。\n\n### 涨落的动力学方程推导\n\n我们首先将 $\\psi(\\mathbf{x},t) = \\bar{\\psi} + \\phi(\\mathbf{x},t)$ 代入PFC动力学方程。平均密度 $\\bar{\\psi}$ 是一个常数。变分导数为：\n$$\n\\frac{\\delta F}{\\delta \\psi} = r\\psi + (1+\\nabla^2)^2\\psi + \\psi^3\n$$\n代入 $\\psi = \\bar{\\psi}+\\phi$：\n$$\n\\frac{\\delta F}{\\delta \\psi} = r(\\bar{\\psi}+\\phi) + (1+\\nabla^2)^2(\\bar{\\psi}+\\phi) + (\\bar{\\psi}+\\phi)^3\n$$\n根据 $\\phi$ 的幂次展开并收集各项：\n$$\n\\frac{\\delta F}{\\delta \\psi} = [r\\bar{\\psi} + \\bar{\\psi} + \\bar{\\psi}^3] + [r+3\\bar{\\psi}^2]\\phi + (1+\\nabla^2)^2\\phi + 3\\bar{\\psi}\\phi^2 + \\phi^3\n$$\n第一个方括号中的项是均匀态的恒定化学势 $\\mu_0 = r\\bar{\\psi} + \\bar{\\psi} + \\bar{\\psi}^3$。由于 $\\nabla^2 \\mu_0 = 0$，涨落 $\\phi$ 的动力学由其余项决定：\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\nabla^2 \\left[ (r+3\\bar{\\psi}^2)\\phi + (1+\\nabla^2)^2\\phi + 3\\bar{\\psi}\\phi^2 + \\phi^3 \\right]\n$$\n\n### 线性稳定性分析\n\n为了找到斑图形成的起始点，我们对 $\\phi$ 的方程进行线性化：\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\nabla^2 \\left[ (r+3\\bar{\\psi}^2)\\phi + (1+\\nabla^2)^2\\phi \\right]\n$$\n我们考虑单个傅里叶模式扰动 $\\phi(\\mathbf{x},t) \\propto \\exp(i\\mathbf{k}\\cdot\\mathbf{x} + \\omega t)$，其中 $k=|\\mathbf{k}|$。将此代入线性化方程，得到增长率 $\\omega(k)$ 的色散关系：\n$$\n\\omega(k) = -k^2 \\left[ (r+3\\bar{\\psi}^2) + (1-k^2)^2 \\right]\n$$\n当对于任何 $k$ 有 $\\omega(k)  0$ 时，均匀态 $\\bar{\\psi}$ 变得不稳定。这首先发生在方括号中的项变为负值时。我们找到函数 $g(k) = (r+3\\bar{\\psi}^2) + (1-k^2)^2$ 相对于 $k$ 的最小值。\n$$\n\\frac{\\mathrm{d}g}{\\mathrm{d}k} = 2(1-k^2)(-2k) = 0\n$$\n这给出了临界波数 $k_0=1$。在此波数下，最小值为 $g(1) = r+3\\bar{\\psi}^2$。不稳定性的起始点（线性阈值）在该值为零时出现。\n$$\nr_c + 3\\bar{\\psi}^2 = 0 \\implies r_c = -3\\bar{\\psi}^2\n$$\n在该阈值附近（$r \\approx r_c$），波数 $k \\approx 1$ 的模式将会增长。\n\n### 振幅方程推导\n\n我们通过推导临界模慢演化的振幅方程，在阈值附近进行弱非线性分析。涨落场 $\\phi$ 的领头阶解是波数为 $k=1$ 的模式的叠加：\n$$\n\\phi(\\mathbf{x},t) = \\sum_{j=1}^{N} \\left( A_j(T) e^{i\\mathbf{q}_j \\cdot \\mathbf{x}} + \\mathrm{c.c.} \\right) + \\text{h.o.t.}\n$$\n其中 $A_j(T)$ 是慢变的复振幅，$T$ 是慢时间尺度，$|\\mathbf{q}_j|=1$，c.c. 表示复共轭，h.o.t. 表示高阶项。\n\n该系统的振幅方程结构是众所周知的。对于形成六边形共振三波的一组三个临界模 $\\{\\mathbf{q}_1, \\mathbf{q}_2, \\mathbf{q}_3\\}$，振幅方程的一般形式为：\n$$\n\\frac{\\mathrm{d}A_j}{\\mathrm{d}T} = \\alpha A_j + \\beta A_{j+1}^* A_{j+2}^* - (\\gamma |A_j|^2 + \\delta \\sum_{k \\neq j} |A_k|^2) A_j\n$$\n其中下标以3为模，并且我们已经重新标度了慢时间 $T$。系数 $\\alpha, \\beta, \\gamma, \\delta$ 通过将完整动力学投影到临界模上来确定。这是一个标准但冗长的计算。主要贡献来自于线性项、二次非线性项 $3\\bar{\\psi}\\phi^2$ 和三次非线性项 $\\phi^3$。守恒动力学从作用于临界模的领头 $\\nabla^2$ 算子引入了一个总因子 $-k^2=-1$。\n\n1.  **线性项**：增长率由与线性阈值的距离控制。\n    $$ \\alpha = -(r - r_c) = -(r + 3\\bar{\\psi}^2) $$\n2.  **二次项**：项 $\\beta A_{j+1}^*A_{j+2}^*$ 来自于 $-3\\bar{\\psi}\\phi^2$ 的投影。乘积 $(A_{j+1}^* e^{-i\\mathbf{q}_{j+1}\\cdot\\mathbf{x}})(A_{j+2}^* e^{-i\\mathbf{q}_{j+2}\\cdot\\mathbf{x}})$ 产生一个波矢为 $-(\\mathbf{q}_{j+1}+\\mathbf{q}_{j+2}) = \\mathbf{q}_j$ 的波。组合因子为 $2$。\n    $$ \\beta = - (3\\bar{\\psi} \\times 2) = -6\\bar{\\psi} $$\n3.  **三次项**：这些项来自于 $-\\phi^3$ 的直接投影，以及基模与由二次非线性产生的二次谐波模的相互作用。对于这个经典的PFC模型，在最简单的近似下（忽略对三次项系数进行修正的 $\\bar{\\psi}$ 的高阶项），系数为：\n    $$ \\gamma = 3 \\quad \\text{和} \\quad \\delta = 6 $$\n    这个近似捕捉了斑图竞争的基本物理。\n\n因此，模 $A_1$ 的振幅方程为：\n$$\n\\frac{\\mathrm{d}A_1}{\\mathrm{d}T} = -(r+3\\bar{\\psi}^2)A_1 - 6\\bar{\\psi}A_2^*A_3^* - 3|A_1|^2A_1 - 6(|A_2|^2+|A_3|^2)A_1\n$$\n$A_2$ 和 $A_3$ 的方程可通过对下标进行循环置换得到。\n\n### 稳态分析与分岔阈值\n\n我们现在通过设置 $\\frac{\\mathrm{d}A_j}{\\mathrm{d}T} = 0$ 来寻找稳态解。\n\n**1. 条纹（滚卷）**\n\n对于条纹斑图，只有一个模式存在。我们设 $A_1 \\neq 0$ 和 $A_2 = A_3 = 0$。$A_1$ 的振幅方程简化为：\n$$\n0 = -(r+3\\bar{\\psi}^2)A_1 - 3|A_1|^2A_1\n$$\n该方程有两个解：\n- 平庸解 $A_1=0$，对应于均匀态。\n- 条纹解 $|A_1|^2 = -\\frac{r+3\\bar{\\psi}^2}{3}$。\n振幅 $|A_1|$ 的非平庸实数解仅在右侧为正时存在，即 $-(r+3\\bar{\\psi}^2)  0$，或 $r  -3\\bar{\\psi}^2$。从平庸态的分岔恰好发生在先行稳定性阈值处。这是一个叉式分岔。\n条纹出现的阈值为：\n$$\nr_{\\text{stripes}} = -3\\bar{\\psi}^2\n$$\n\n**2. 六边形**\n\n对于六边形斑图，所有三个振幅都非零。我们寻找一个对称解，其中 $|A_1|=|A_2|=|A_3| = R_H$。$A_1$ 的振幅方程变为：\n$$\n0 = -(r+3\\bar{\\psi}^2)A_1 - 6\\bar{\\psi}A_2^*A_3^* - (3R_H^2 + 6(R_H^2+R_H^2))A_1\n$$\n$$\n0 = -(r+3\\bar{\\psi}^2)A_1 - 6\\bar{\\psi}A_2^*A_3^* - 15R_H^2 A_1\n$$\n设 $A_j = R_H e^{i\\theta_j}$。二次项耦合了相位。当 $\\theta_1+\\theta_2+\\theta_3=0$ 或 $\\pi$ 时，可以找到一个稳定的定常态。我们假设一种构型，其中 $A_j$ 可以被视为实数且为正，$A_j=R_H$。这等效于适当地设置相位（例如 $\\theta_j=0$，如果 $\\beta$ 是实数，这就有可能，而它确实是实数），并导致 $A_2^*A_3^* = R_H^2$。\n$R_H$ 的方程是：\n$$\n0 = -(r+3\\bar{\\psi}^2)R_H - 6\\bar{\\psi}R_H^2 - 15R_H^3\n$$\n对于非平庸解，除以 $R_H$：\n$$\n15R_H^2 + 6\\bar{\\psi}R_H + (r+3\\bar{\\psi}^2) = 0\n$$\n这是一个关于六边形斑图振幅 $R_H$ 的二次方程。解为：\n$$\nR_H = \\frac{-6\\bar{\\psi} \\pm \\sqrt{(6\\bar{\\psi})^2 - 4(15)(r+3\\bar{\\psi}^2)}}{2(15)}\n$$\n只有当判别式非负时，$R_H$ 的实数解才存在：\n$$\n36\\bar{\\psi}^2 - 60(r+3\\bar{\\psi}^2) \\ge 0\n$$\n六边形解存在的阈值由鞍结分岔点给出，此时判别式为零。\n$$\n36\\bar{\\psi}^2 - 60(r_{\\text{hex}}+3\\bar{\\psi}^2) = 0\n$$\n$$\n36\\bar{\\psi}^2 = 60(r_{\\text{hex}}+3\\bar{\\psi}^2)\n$$\n除以12：\n$$\n3\\bar{\\psi}^2 = 5(r_{\\text{hex}}+3\\bar{\\psi}^2)\n$$\n$$\n\\frac{3}{5}\\bar{\\psi}^2 = r_{\\text{hex}}+3\\bar{\\psi}^2\n$$\n求解六边形阈值 $r_{\\text{hex}}$：\n$$\nr_{\\text{hex}} = \\frac{3}{5}\\bar{\\psi}^2 - 3\\bar{\\psi}^2 = \\left(\\frac{3-15}{5}\\right)\\bar{\\psi}^2 = -\\frac{12}{5}\\bar{\\psi}^2\n$$\n六边形的鞍结分岔发生在 $r_{\\text{hex}} = -2.4\\bar{\\psi}^2$。由于 $-2.4  -3$，六边形斑图通过亚临界分岔出现，其出现的 $r$ 值高于条纹的阈值。\n\n分岔阈值为：\n- 条纹：$r_{\\text{stripes}} = -3\\bar{\\psi}^2$\n- 六边形：$r_{\\text{hex}} = -\\frac{12}{5}\\bar{\\psi}^2$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -3\\bar{\\psi}^2 \\\\ -\\frac{12}{5}\\bar{\\psi}^2 \\end{pmatrix}}\n$$"
        }
    ]
}