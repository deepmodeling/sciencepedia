{
    "hands_on_practices": [
        {
            "introduction": "任何相场模型的基石都是系统的自由能函数，它描绘了驱动微结构演化的热力学“景观”。本练习旨在将抽象的自由能函数与物理上可测量的相图特征联系起来。通过直接从正则溶体模型的自由能表达式出发，计算双节线（binodal）和旋节线（spinodal）成分点，您将掌握识别控制相变的稳定、亚稳和不稳定区域的核心技能。",
            "id": "2847472",
            "problem": "考虑一个二元、成分对称的正则溶液，其摩尔自由能密度为\n$$\nf(c) = RT\\big[c\\ln c + (1-c)\\ln(1-c)\\big] + \\Omega\\,c(1-c),\n$$\n其中 $c \\in (0,1)$ 是溶质的摩尔分数，$R$ 是通用气体常数，$T$ 是绝对温度，$\\Omega$ 是一个与温度无关的相互作用参数。利用相共存的平衡热力学第一性原理（化学势相等和公切线构造）以及亚稳相分解线（spinodal）的定义（自由能密度的曲率消失），确定在温度 $T$ 和相互作用参数 $\\Omega$ 下的两个双节线（binodal）成分和两个亚稳相分解线成分。假设 $T = 800\\,\\mathrm{K}$，$\\Omega = 24.0 \\times 10^{3}\\,\\mathrm{J\\,mol^{-1}}$，以及 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。由于自由能相对于 $c = 1/2$ 是对称的，请将结果报告为 $c_{\\mathrm{b,low}}$、$c_{\\mathrm{b,high}}$、$c_{\\mathrm{s,low}}$ 和 $c_{\\mathrm{s,high}}$，其中 $c_{\\mathrm{b,high}} = 1 - c_{\\mathrm{b,low}}$ 且 $c_{\\mathrm{s,high}} = 1 - c_{\\mathrm{s,low}}$。将每个成分四舍五入到四位有效数字，并以纯小数形式表示（无单位）。请按 $\\big(c_{\\mathrm{b,low}},\\,c_{\\mathrm{b,high}},\\,c_{\\mathrm{s,low}},\\,c_{\\mathrm{s,high}}\\big)$ 的顺序，将最终答案以单个行向量的形式提供。",
            "solution": "二元正则溶液的摩尔自由能密度由下式给出：\n$$\nf(c) = RT\\big[c\\ln c + (1-c)\\ln(1-c)\\big] + \\Omega\\,c(1-c)\n$$\n其中 $c$ 是溶质摩尔分数，$R$ 是通用气体常数，$T$ 是绝对温度，$\\Omega$ 是相互作用参数。给定的数值为 $T = 800\\,\\mathrm{K}$，$\\Omega = 24.0 \\times 10^{3}\\,\\mathrm{J\\,mol^{-1}}$，以及 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。该体系在 $c = 0.5$ 附近表现出成分对称性，即 $f(c) = f(1-c)$。\n\n首先，我们确定亚稳相分解线成分。亚稳相分解线定义了相抵抗微小成分涨落的局部稳定性的极限。当自由能密度的曲率变为零时，就达到了这个极限。在数学上，这个条件表示为：\n$$\n\\frac{d^2f}{dc^2} = 0\n$$\n为了应用这个条件，我们首先计算 $f(c)$ 关于 $c$ 的一阶和二阶导数。\n一阶导数为：\n$$\n\\frac{df}{dc} = \\frac{d}{dc} \\left( RT\\big[c\\ln c + (1-c)\\ln(1-c)\\big] + \\Omega\\,c(1-c) \\right)\n$$\n$$\n\\frac{df}{dc} = RT\\left[ (\\ln c + c\\cdot\\frac{1}{c}) + (-\\ln(1-c) + (1-c)\\cdot\\frac{-1}{1-c}) \\right] + \\Omega(1 - 2c)\n$$\n$$\n\\frac{df}{dc} = RT\\left[ \\ln c + 1 - \\ln(1-c) - 1 \\right] + \\Omega(1 - 2c) = RT\\ln\\left(\\frac{c}{1-c}\\right) + \\Omega(1 - 2c)\n$$\n二阶导数为：\n$$\n\\frac{d^2f}{dc^2} = \\frac{d}{dc} \\left( RT\\ln\\left(\\frac{c}{1-c}\\right) + \\Omega(1 - 2c) \\right)\n$$\n$$\n\\frac{d^2f}{dc^2} = RT \\frac{d}{dc} \\left( \\ln c - \\ln(1-c) \\right) - 2\\Omega\n$$\n$$\n\\frac{d^2f}{dc^2} = RT\\left( \\frac{1}{c} - \\frac{-1}{1-c} \\right) - 2\\Omega = RT\\left( \\frac{1}{c} + \\frac{1}{1-c} \\right) - 2\\Omega = \\frac{RT}{c(1-c)} - 2\\Omega\n$$\n将二阶导数设为零，以求得亚稳相分解线成分，记为 $c_s$：\n$$\n\\frac{RT}{c_s(1-c_s)} - 2\\Omega = 0 \\implies c_s(1-c_s) = \\frac{RT}{2\\Omega}\n$$\n这是一个关于 $c_s$ 的二次方程：\n$$\nc_s^2 - c_s + \\frac{RT}{2\\Omega} = 0\n$$\n解由二次公式给出：\n$$\nc_s = \\frac{1 \\pm \\sqrt{1 - 4\\left(\\frac{RT}{2\\Omega}\\right)}}{2} = \\frac{1 \\pm \\sqrt{1 - \\frac{2RT}{\\Omega}}}{2}\n$$\n代入给定值：\n$$\n\\frac{2RT}{\\Omega} = \\frac{2 \\times 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} \\times 800\\,\\mathrm{K}}{24.0 \\times 10^{3}\\,\\mathrm{J\\,mol^{-1}}} = \\frac{13302.4}{24000} \\approx 0.554267\n$$\n亚稳相分解线成分为：\n$$\nc_s = \\frac{1 \\pm \\sqrt{1 - 0.554267}}{2} = \\frac{1 \\pm \\sqrt{0.445733}}{2} = \\frac{1 \\pm 0.667632}{2}\n$$\n这给出了两个亚稳相分解线成分：\n$$\nc_{\\mathrm{s,low}} = \\frac{1 - 0.667632}{2} = 0.166184\n$$\n$$\nc_{\\mathrm{s,high}} = \\frac{1 + 0.667632}{2} = 0.833816\n$$\n四舍五入到四位有效数字，我们得到 $c_{\\mathrm{s,low}} = 0.1662$ 和 $c_{\\mathrm{s,high}} = 0.8338$。\n\n其次，我们确定双节线成分。双节线定义了处于热力学平衡状态的各相的成分。对于一个二元体系，这些成分 $c_1$ 和 $c_2$ 是通过公切线构造找到的，这在数学上等价于两相中各组分的化学势相等：\n$$\n\\mu_A(c_1) = \\mu_A(c_2) \\quad \\text{and} \\quad \\mu_B(c_1) = \\mu_B(c_2)\n$$\n其中 $\\mu_A = f(c) - c\\frac{df}{dc}$ 且 $\\mu_B = f(c) + (1-c)\\frac{df}{dc}$。这个方程组导出以下条件：\n$$\n\\frac{df}{dc}\\bigg|_{c_1} = \\frac{df}{dc}\\bigg|_{c_2} \\quad \\text{and} \\quad \\frac{f(c_2) - f(c_1)}{c_2 - c_1} = \\frac{df}{dc}\\bigg|_{c_1}\n$$\n由于自由能函数 $f(c) = f(1-c)$ 的成分对称性，两个平衡成分必须相对于 $c=0.5$ 是对称的。设 $c_1 = c_b$ 和 $c_2 = 1-c_b$。\n该函数的对称性意味着其导数关于 $c=0.5$ 是反对称的，即 $\\frac{df}{dc}(c) = -\\frac{df}{dc}(1-c)$。\n第一个平衡条件 $\\frac{df}{dc}(c_b) = \\frac{df}{dc}(1-c_b)$ 变为 $\\frac{df}{dc}(c_b) = -\\frac{df}{dc}(c_b)$，这意味着 $2\\frac{df}{dc}(c_b) = 0$，所以 $\\frac{df}{dc}(c_b) = 0$。\n如果 $\\frac{df}{dc}(c_b) = 0$，第二个平衡条件也得到满足，因为根据对称性 $f(c_b)=f(1-c_b)$，使得左手边为零。\n因此，对于这个对称系统，双节线成分 $c_b$ 是以下方程的解：\n$$\n\\frac{df}{dc} = RT\\ln\\left(\\frac{c_b}{1-c_b}\\right) + \\Omega(1 - 2c_b) = 0\n$$\n整理方程：\n$$\n\\ln\\left(\\frac{c_b}{1-c_b}\\right) = -\\frac{\\Omega}{RT}(1 - 2c_b) = \\frac{\\Omega}{RT}(2c_b - 1)\n$$\n我们需要求解这个关于 $c_b$ 的超越方程。我们先计算常数项：\n$$\n\\frac{\\Omega}{RT} = \\frac{24.0 \\times 10^{3}\\,\\mathrm{J\\,mol^{-1}}}{8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} \\times 800\\,\\mathrm{K}} = \\frac{24000}{6651.2} \\approx 3.60835\n$$\n需要求解的方程是：\n$$\n\\ln\\left(\\frac{c_b}{1-c_b}\\right) = 3.60835(2c_b - 1)\n$$\n一个平凡解是 $c_b = 0.5$，它对应于自由能的不稳定最大值。另外两个解是稳定的双节线成分。设 $x = 2c_b - 1$。方程变换为 $c_b = (x+1)/2$ 和 $1-c_b = (1-x)/2$。\n$$\n\\ln\\left(\\frac{1+x}{1-x}\\right) = \\frac{\\Omega}{RT}x \\implies 2\\,\\text{arctanh}(x) = \\frac{\\Omega}{RT}x \\implies \\text{arctanh}(x) = \\frac{\\Omega}{2RT}x\n$$\n当 $\\frac{\\Omega}{2RT} \\approx 1.804175$ 时，我们数值求解 $x = \\tanh(1.804175\\,x)$。发现非零解为 $x \\approx \\pm 0.933374$。\n双节线成分由这些 $x$ 值计算得出：\n$$\nc_{\\mathrm{b,low}} = \\frac{1 - 0.933374}{2} = 0.033313\n$$\n$$\nc_{\\mathrm{b,high}} = \\frac{1 + 0.933374}{2} = 0.966687\n$$\n四舍五入到四位有效数字，我们得到 $c_{\\mathrm{b,low}} = 0.03331$ 和 $c_{\\mathrm{b,high}} = 0.9667$。\n\n总而言之，计算出的成分是：\n双节线：$c_{\\mathrm{b,low}} = 0.03331$，$c_{\\mathrm{b,high}} = 0.9667$。\n亚稳相分解线：$c_{\\mathrm{s,low}} = 0.1662$，$c_{\\mathrm{s,high}} = 0.8338$。\n这些值遵循预期的顺序 $c_{\\mathrm{b,low}}  c_{\\mathrm{s,low}}  0.5  c_{\\mathrm{s,high}}  c_{\\mathrm{b,high}}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.03331  0.9667  0.1662  0.8338\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在确定了相分离的热力学驱动力之后，我们自然会问：这一过程是如何在时间上展开的？本练习将带您从静态热力学分析转向动态演化过程。通过对描述保守系统的Cahn-Hilliard方程进行线性稳定性分析，您将揭示旋节线分解的内在机理：在热力学不稳定区域（即 $f_{0}''(c_{0}) \\lt 0$），特定波长的微小成分涨落如何被选择性放大，从而启动相分离过程并决定了早期微观结构的特征长度尺度。",
            "id": "2508094",
            "problem": "考虑一个由守恒组分场 $c(\\mathbf{x},t)$ 描述的等温二元混合物，该混合物通过扩散动力学演化。系统的自由能由平方梯度泛函给出\n$$\nF[c] \\;=\\; \\int_{\\Omega} \\left( f_{0}(c) \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla c|^{2} \\right)\\,\\mathrm{d}V,\n$$\n其中 $\\kappa0$ 是一个常数梯度能量系数，$f_{0}(c)$ 是一个光滑的体自由能密度。化学势由变分导数 $\\mu \\equiv \\delta F/\\delta c$ 定义，扩散通量遵循线性 Onsager 动力学 $\\mathbf{J} = - M \\nabla \\mu$（其中迁移率 $M0$ 为常数），质量守恒要求 $\\partial_{t} c + \\nabla\\!\\cdot \\mathbf{J} = 0$。\n\n令 $c_{0}$ 为一个空间均匀的定态。引入一个振幅 $0  \\varepsilon \\ll 1$ 的小振幅平面波微扰 $\\delta c(\\mathbf{x},t) = \\varepsilon\\,\\phi\\,\\exp\\!\\left(i\\,\\mathbf{k}\\!\\cdot\\!\\mathbf{x} + \\omega t\\right)$，其中波矢 $\\mathbf{k}$ 为实数，其模为 $k=|\\mathbf{k}|$，增长率 $\\omega$ 为复数。将控制方程在 $c_{0}$ 附近进行线性化，并消去 $\\phi$ 以获得色散关系 $\\omega(k)$。\n\n仅使用上述定义和定律，推导 $\\omega(k)$ 关于 $M$、$\\kappa$、$f_{0}''(c_{0})$ 和 $k$ 的闭合形式解析表达式。将您的最终答案表示为 $\\omega(k)$ 的单个解析表达式（无需单位）。",
            "solution": "推导过程分三个阶段。首先，推导 $c(\\mathbf{x},t)$ 的控制偏微分方程的显式形式。其次，将此方程在均匀态 $c_{0}$ 附近进行线性化。第三，将平面波拟设代入线性化方程中，以求出色散关系 $\\omega(k)$。\n\n化学势 $\\mu$ 定义为自由能 $F[c]$ 相对于场 $c$ 的变分导数。\n$$\n\\mu(\\mathbf{x}) = \\frac{\\delta F}{\\delta c(\\mathbf{x})}\n$$\n为了计算这个导数，我们考虑一个小的变分 $\\delta c(\\mathbf{x})$，并计算泛函 $\\delta F$ 的变化：\n$$\n\\delta F = F[c+\\delta c] - F[c] = \\int_{\\Omega} \\left[ f_{0}(c+\\delta c) - f_{0}(c) + \\frac{\\kappa}{2} \\left( |\\nabla(c+\\delta c)|^{2} - |\\nabla c|^{2} \\right) \\right] \\mathrm{d}V\n$$\n对于无穷小变分 $\\delta c$，我们展开到一阶。\n$$\nf_{0}(c+\\delta c) \\approx f_{0}(c) + \\frac{\\mathrm{d}f_{0}}{\\mathrm{d}c} \\delta c = f_{0}(c) + f_{0}'(c) \\delta c\n$$\n$$\n|\\nabla(c+\\delta c)|^{2} = (\\nabla c + \\nabla \\delta c) \\cdot (\\nabla c + \\nabla \\delta c) = |\\nabla c|^{2} + 2\\nabla c \\cdot \\nabla \\delta c + |\\nabla \\delta c|^{2} \\approx |\\nabla c|^{2} + 2\\nabla c \\cdot \\nabla \\delta c\n$$\n将这些展开式代入 $\\delta F$ 的表达式中：\n$$\n\\delta F \\approx \\int_{\\Omega} \\left[ f_{0}'(c) \\delta c + \\kappa \\nabla c \\cdot \\nabla \\delta c \\right] \\mathrm{d}V\n$$\n我们对第二项应用分部积分，使用恒等式 $\\nabla \\cdot (\\psi \\mathbf{A}) = (\\nabla \\psi) \\cdot \\mathbf{A} + \\psi (\\nabla \\cdot \\mathbf{A})$。令 $\\psi = \\delta c$ 和 $\\mathbf{A} = \\kappa \\nabla c$。则 $\\nabla \\delta c \\cdot (\\kappa \\nabla c) = \\nabla \\cdot (\\delta c \\, \\kappa \\nabla c) - \\delta c \\, \\nabla \\cdot (\\kappa \\nabla c)$。\n$$\n\\int_{\\Omega} \\kappa \\nabla c \\cdot \\nabla \\delta c \\, \\mathrm{d}V = \\int_{\\Omega} \\nabla \\cdot (\\delta c \\, \\kappa \\nabla c) \\, \\mathrm{d}V - \\int_{\\Omega} \\delta c \\, (\\kappa \\nabla^{2} c) \\, \\mathrm{d}V\n$$\n使用散度定理，右侧的第一个积分变成在边界 $\\partial\\Omega$ 上的面积分。假设为自然边界条件（在 $\\partial\\Omega$ 上 $\\nabla c \\cdot \\mathbf{n} = 0$）或周期性边界条件，该面积分项为零。\n$$\n\\delta F = \\int_{\\Omega} \\left[ f_{0}'(c) - \\kappa \\nabla^{2} c \\right] \\delta c \\, \\mathrm{d}V\n$$\n根据定义 $\\delta F = \\int \\mu \\, \\delta c \\, \\mathrm{d}V$，我们确定化学势为：\n$$\n\\mu = f_{0}'(c) - \\kappa \\nabla^{2} c\n$$\n现在，我们构建控制方程。连续性方程为 $\\partial_{t} c = - \\nabla \\cdot \\mathbf{J}$。代入通量定律 $\\mathbf{J} = -M \\nabla \\mu$ 得到：\n$$\n\\partial_{t} c = - \\nabla \\cdot (-M \\nabla \\mu) = M \\nabla^{2} \\mu\n$$\n因为迁移率 $M$ 是常数。代入 $\\mu$ 的表达式：\n$$\n\\partial_{t} c = M \\nabla^{2} \\left[ f_{0}'(c) - \\kappa \\nabla^{2} c \\right]\n$$\n这就是 Cahn-Hilliard 方程。我们现在将此方程在常数参考态 $c = c_{0}$ 附近进行线性化。令 $c(\\mathbf{x}, t) = c_{0} + \\delta c(\\mathbf{x}, t)$，其中 $\\delta c$ 是一个小微扰。\n方程左边变为：\n$$\n\\partial_{t} (c_{0} + \\delta c) = \\partial_{t} \\delta c\n$$\n对于方程右边，我们首先线性化 $f_{0}'(c)$ 项：\n$$\nf_{0}'(c) = f_{0}'(c_{0} + \\delta c) \\approx f_{0}'(c_{0}) + f_{0}''(c_{0}) \\delta c\n$$\n将此代入 Cahn-Hilliard 方程：\n$$\n\\partial_{t} \\delta c = M \\nabla^{2} \\left[ f_{0}'(c_{0}) + f_{0}''(c_{0}) \\delta c - \\kappa \\nabla^{2}(c_{0} + \\delta c) \\right]\n$$\n由于 $c_{0}$ 是常数，$f_{0}'(c_{0})$ 也是常数，且 $\\nabla^{2}c_{0} = 0$。因此，$\\nabla^{2}[f_{0}'(c_{0})] = 0$。方程简化为：\n$$\n\\partial_{t} \\delta c = M \\nabla^{2} \\left[ f_{0}''(c_{0}) \\delta c - \\kappa \\nabla^{2} \\delta c \\right] = M f_{0}''(c_{0}) \\nabla^{2} \\delta c - M \\kappa \\nabla^{4} \\delta c\n$$\n这是微扰 $\\delta c$ 的线性化演化方程。\n最后，我们代入平面波拟设 $\\delta c(\\mathbf{x},t) = A \\exp(i\\,\\mathbf{k}\\!\\cdot\\!\\mathbf{x} + \\omega t)$，其中 $A=\\varepsilon\\phi$ 是一个常数振幅。所需的导数是：\n$$\n\\partial_{t} \\delta c = \\omega \\, \\delta c\n$$\n$$\n\\nabla \\delta c = i \\mathbf{k} \\, \\delta c\n$$\n$$\n\\nabla^{2} \\delta c = \\nabla \\cdot (i \\mathbf{k} \\, \\delta c) = (i \\mathbf{k}) \\cdot (i \\mathbf{k}) \\, \\delta c = -|\\mathbf{k}|^{2} \\delta c = -k^{2} \\delta c\n$$\n$$\n\\nabla^{4} \\delta c = \\nabla^{2}(\\nabla^{2} \\delta c) = \\nabla^{2}(-k^{2} \\delta c) = -k^{2} \\nabla^{2} \\delta c = (-k^{2})(-k^{2} \\delta c) = k^{4} \\delta c\n$$\n将这些导数代入线性化方程中：\n$$\n\\omega \\, \\delta c = M f_{0}''(c_{0}) (-k^{2} \\delta c) - M \\kappa (k^{4} \\delta c)\n$$\n两边除以非零项 $\\delta c$，得到 $\\omega$ 的色散关系：\n$$\n\\omega(k) = -M f_{0}''(c_{0}) k^{2} - M \\kappa k^{4}\n$$\n提取公因式得到最终表达式。\n$$\n\\omega(k) = -M k^{2} \\left( f_{0}''(c_{0}) + \\kappa k^{2} \\right)\n$$\n该表达式给出了增长率 $\\omega$ 作为波数 $k$ 和系统参数 $M$、$\\kappa$ 以及体自由能密度在参考组分下的二阶导数 $f_{0}''(c_{0})$ 的函数。",
            "answer": "$$\n\\boxed{-M k^{2} \\left( f_{0}''(c_{0}) + \\kappa k^{2} \\right)}\n$$"
        },
        {
            "introduction": "理论分析为了解演化初期提供了深刻见解，但要捕捉从初始涨落到最终粗化的完整、复杂的微观结构演化过程，则必须借助数值模拟。本练习是前面理论知识的综合与升华，要求您亲手构建一个Cahn-Hilliard方程的数值求解器。通过完成这个编码任务，您不仅将学会如何实现一种高效的相场方程数值解法（傅里叶谱方法），更重要的是，您将通过追踪系统总自由能的演变，来计算验证一个基本物理定律——孤立系统自由能的单调递减，从而深刻体会理论、计算与物理定律之间的联系。",
            "id": "2847487",
            "problem": "考虑一个长度为 $L$ 的一维周期性区域上的守恒相场 $c(x,t)$ 的 Cahn–Hilliard 方程，\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 \\mu,\\quad \\mu = \\frac{\\delta \\mathcal{F}}{\\delta c},\n$$\n其中自由能泛函为\n$$\n\\mathcal{F}[c] = \\int_0^L \\left( F(c) + \\frac{\\kappa}{2} \\left|\\nabla c\\right|^2 \\right)\\, dx,\\quad F(c) = \\frac{1}{4}\\left(c^2-1\\right)^2,\n$$\n其中迁移率 $M0$ 且梯度能量系数 $\\kappa0$。假设采用周期性边界条件和无量纲变量，因此在计算或输出的任何部分都不需要物理单位。\n\n你的任务是从这些定义和第一性原理出发，通过调用变分导数和化学势的定义，推导出一个时间上一阶精确的傅里叶伪谱半隐式离散格式。在该格式中，由梯度能量项引起的化学势贡献被隐式处理，而非线性体导数 $F'(c)$ 则被显式处理。使用一个在长度为 $L$ 的周期性区间上包含 $N$ 个点的均匀网格来离散空间，并使用快速傅里叶变换在谱空间中表示空间导数。将相场 $c$ 向前演化指定数量的时间步，步长为 $\\Delta t$，并在每个时间步使用网格上的梯形法则计算离散自由能：\n$$\n\\mathcal{F}_h[c] = \\sum_{j=0}^{N-1} \\left[ \\frac{1}{4}\\left(c_j^2-1\\right)^2 + \\frac{\\kappa}{2} \\left(\\partial_x c\\big|_j\\right)^2 \\right] \\Delta x,\n$$\n其中 $\\Delta x = L/N$，$c_j = c(x_j)$，$x_j = j\\,\\Delta x$，而 $\\partial_x c$ 通过将 $c$ 的傅里叶系数与对应所选 $L$ 和 $N$ 的标准波数 $k$ 的 $\\mathrm{i}k$ 相乘，在谱空间中进行计算。对于每个测试用例，你必须验证离散自由能序列 $\\{\\mathcal{F}_h^n\\}_{n=0}^{N_t}$（其中 $N_t$ 是时间步数）是否单调非增，即对于所有 $n$ 是否都有 $\\mathcal{F}_h^{n+1} \\le \\mathcal{F}_h^{n}$。由于浮点舍入误差，你可以允许一个算法确定的小的非负容差，但你必须在你的解决方案中解释和证明你的选择。\n\n将你的推导实现为一个可执行程序，该程序为每个指定的参数集构建谱算子，推进半隐式格式，计算每一步的离散自由能，并返回一个布尔值，指示在整个运行过程中自由能是否单调递减。\n\n使用以下参数集测试套件。对于所有情况，设区域长度为 $L=2\\pi$，并使用无量纲参数。“noise”（噪声）情况下的初始条件是具有零均值和指定振幅的空间不相关高斯扰动，通过指定的伪随机种子使其可复现。“uniform”（均匀）情况下的初始条件是空间常数。对于每种情况，报告在所采取的步骤中自由能是否单调非增。\n\n- 情况 1 (正常路径): $N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 2\\times 10^{-5}$, 步数 $N_t=2000$, 初始条件类型 “noise”（噪声），振幅 $10^{-2}$，种子 $1$。\n- 情况 2 (中等小时间步): $N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 10^{-4}$, 步数 $N_t=400$, 初始条件类型 “noise”（噪声），振幅 $10^{-2}$，种子 $2$。\n- 情况 3 (初始条件处于体相最小值): $N=64$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 5\\times 10^{-4}$, 步数 $N_t=200$, 初始条件类型 “uniform”（均匀），值为 $+1$。\n- 情况 4 (较大时间步，可能违反单调递减): $N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 2\\times 10^{-3}$, 步数 $N_t=100$, 初始条件类型 “noise”（噪声），振幅 $10^{-2}$，种子 $3$。\n\n所有变量和参数都是无量纲的；任何量都不需要物理单位。你的程序必须在单行中生成一个包含四个布尔值的列表，按所述顺序对应上述四种情况。最终输出格式必须是仅包含一行结果的方括号内逗号分隔列表，例如，“[True,False,True,True]”。\n\n你的实现必须是自包含的，使用傅里叶伪谱表示法进行空间求导，并遵循你从所述原理推导出的半隐式时间离散化方法，不依赖任何外部数据。不要包含任何无关的输出。唯一可接受的输出是指定的单行布尔值列表。",
            "solution": "Cahn-Hilliard 方程描述了守恒相场 $c(x,t)$ 的演化，其形式如下\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 \\mu,\n$$\n其中 $M$ 是迁移率，$\\mu$ 是化学势。化学势定义为 Ginzburg-Landau 自由能泛函 $\\mathcal{F}[c]$ 相对于相场 $c$ 的变分导数：\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta c}.\n$$\n自由能泛函由下式给出\n$$\n\\mathcal{F}[c] = \\int_0^L \\left( F(c) + \\frac{\\kappa}{2} |\\nabla c|^2 \\right) dx,\n$$\n其中包含一个双势阱体能量密度 $F(c) = \\frac{1}{4}(c^2-1)^2$ 和一个梯度能量系数 $\\kappa  0$。\n\n首先，我们推导化学势 $\\mu$ 的显式形式。泛函的被积函数为 $I(c, \\nabla c) = F(c) + \\frac{\\kappa}{2} |\\nabla c|^2$。使用 Euler-Lagrange 方程可求得变分导数：\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta c} = \\frac{\\partial I}{\\partial c} - \\nabla \\cdot \\frac{\\partial I}{\\partial (\\nabla c)}.\n$$\n所需的偏导数为：\n$$\n\\frac{\\partial I}{\\partial c} = \\frac{dF}{dc} = \\frac{d}{dc}\\left[\\frac{1}{4}(c^2-1)^2\\right] = \\frac{1}{4} \\cdot 2(c^2-1) \\cdot 2c = c^3 - c.\n$$\n$$\n\\frac{\\partial I}{\\partial (\\nabla c)} = \\kappa \\nabla c.\n$$\n将这些代入 $\\mu$ 的表达式中，得到：\n$$\n\\mu = (c^3 - c) - \\kappa \\nabla^2 c.\n$$\n将此结果代入 Cahn-Hilliard 方程，得到完整的四阶非线性偏微分方程：\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 (c^3 - c - \\kappa \\nabla^2 c) = M \\left( \\nabla^2(c^3 - c) - \\kappa \\nabla^4 c \\right).\n$$\n\n对于数值解，我们采用傅里叶伪谱方法进行空间离散，并采用一阶半隐式格式进行时间积分。空间域 $[0, L]$ 被离散为 $N$ 个网格点 $x_j = j \\Delta x$，网格间距为 $\\Delta x = L/N$。相场 $c(x,t)$ 由其在该网格上的值 $c_j(t)$ 表示。在傅里叶谱方法中，空间导数在傅里叶空间中计算。一个函数 $f(x)$ 被变换为其傅里叶系数 $\\hat{f}(k)$，其中 $k$ 是波数。在傅里叶空间中，$n$ 阶导数对应于乘以 $(ik)^n$。因此，$\\nabla^2$ 变为乘以 $-k^2$，$\\nabla^4$ 变为乘以 $k^4$。\n\n问题要求采用一种半隐式时间步进格式，其中来自 $F'(c) = c^3-c$ 的非线性体项贡献被显式处理，而刚性的梯度能量项 $-\\kappa\\nabla^2 c$ 被隐式处理。对显式部分使用一阶前向欧拉法，对隐式部分使用后向欧拉法，从时间步 $n$ 到 $n+1$ 的时间离散方程（步长为 $\\Delta t$）为：\n$$\n\\frac{c^{n+1} - c^n}{\\Delta t} = M \\nabla^2 \\left[ ( (c^n)^3 - c^n ) - \\kappa \\nabla^2 c^{n+1} \\right].\n$$\n这个方程在傅里叶空间中是代数的，这使得求解 $\\hat{c}^{n+1}$ 变得容易。设 $\\hat{c}^n(k)$ 为 $c^n(x_j)$ 的离散傅里叶变换。对该方程进行变换，我们得到：\n$$\n\\frac{\\hat{c}^{n+1} - \\hat{c}^n}{\\Delta t} = M (-k^2) \\left[ \\widehat{((c^n)^3 - c^n)} + \\kappa k^2 \\hat{c}^{n+1} \\right].\n$$\n项 $\\widehat{((c^n)^3 - c^n)}$ 是通过伪谱方法计算的：表达式 $(c^n)^3 - c^n$ 在实空间中的每个网格点上进行计算，然后将结果变换到傅里叶空间。\n我们重新整理方程以求解 $\\hat{c}^{n+1}(k)$：\n$$\n\\hat{c}^{n+1} - \\hat{c}^n = -M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)} - M \\kappa k^4 \\Delta t \\, \\hat{c}^{n+1}\n$$\n$$\n\\hat{c}^{n+1}(1 + M \\kappa k^4 \\Delta t) = \\hat{c}^n - M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)}\n$$\n这就得到了每个时间步傅里叶系数的更新规则：\n$$\n\\hat{c}^{n+1}(k) = \\frac{\\hat{c}^n(k) - M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)}(k)}{1 + M \\kappa k^4 \\Delta t}.\n$$\n在每个时间步，我们从 $c^n$ 开始，计算其傅里叶变换 $\\hat{c}^n$，计算非线性项及其变换，应用更新规则找到 $\\hat{c}^{n+1}$，然后执行傅里叶逆变换以获得 $c^{n+1}$。\n\n离散自由能 $\\mathcal{F}_h$ 在每一步都使用网格上的梯形法则进行计算：\n$$\n\\mathcal{F}_h[c] = \\sum_{j=0}^{N-1} \\left[ \\frac{1}{4}(c_j^2-1)^2 + \\frac{\\kappa}{2} (\\partial_x c|_j)^2 \\right] \\Delta x.\n$$\n空间导数 $\\partial_x c$ 在谱空间中计算，方法是对 $c$ 进行傅里叶变换，将其系数 $\\hat{c}(k)$ 乘以 $ik$，然后进行傅里叶逆变换。\n\n我们必须验证能量序列 $\\{\\mathcal{F}_h^n\\}$ 是否单调非增。使用有限精度算术的数值计算会引入舍入误差。因此，检查严格不等式 $\\mathcal{F}_h^{n+1} \\le \\mathcal{F}_h^{n}$ 是不恰当的。只有当能量增加超过一个容差时，才认为该增加是显著的。一个鲁棒的容差必须同时考虑能量接近零时潜在舍入误差的绝对量级，以及能量较大时的相对误差。我们将容差 $\\epsilon_{tol}$ 定义为一个绝对分量 $\\tau_{abs}$ 和一个相对分量 $\\tau_{rel} \\cdot |\\mathcal{F}_h^n|$ 的和。于是，一个非单调步的条件是 $\\mathcal{F}_h^{n+1} - \\mathcal{F}_h^n  \\tau_{abs} + \\tau_{rel} |\\mathcal{F}_h^n|$。对于所使用的双精度浮点数，我们选择保守值 $\\tau_{abs} = 10^{-12}$ 和 $\\tau_{rel} = 10^{-10}$。如果在任何时间步 $n$ 满足此条件，则认为能量序列是非单调的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and print the final result.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path): N=128, M=1, kappa=10^-2, dt=2x10^-5, Nt=2000, \n        # IC noise amp=10^-2, seed=1.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 2e-5, 'Nt': 2000, \n         'ic_type': 'noise', 'ic_params': (1e-2, 1)},\n        # Case 2 (moderately small time step): N=128, M=1, kappa=10^-2, dt=10^-4, Nt=400,\n        # IC noise amp=10^-2, seed=2.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 1e-4, 'Nt': 400, \n         'ic_type': 'noise', 'ic_params': (1e-2, 2)},\n        # Case 3 (boundary condition at a bulk minimum): N=64, M=1, kappa=10^-2, dt=5x10-4, Nt=200,\n        # IC uniform value=+1.\n        {'N': 64, 'M': 1.0, 'kappa': 1e-2, 'dt': 5e-4, 'Nt': 200,\n         'ic_type': 'uniform', 'ic_params': (1.0,)},\n        # Case 4 (larger time step, potential to violate monotonic decay): N=128, M=1, kappa=10^-2, dt=2x10-3, Nt=100,\n        # IC noise amp=10^-2, seed=3.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 2e-3, 'Nt': 100,\n         'ic_type': 'noise', 'ic_params': (1e-2, 3)},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(**case)\n        results.append(result)\n\n    # Format the final output string as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(N, M, kappa, dt, Nt, ic_type, ic_params):\n    \"\"\"\n    Runs a single Cahn-Hilliard simulation for a given set of parameters.\n    Returns a boolean indicating if the free energy was monotonically non-increasing.\n    \"\"\"\n    L = 2.0 * np.pi\n    dx = L / N\n    k = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # Set up initial condition\n    if ic_type == \"noise\":\n        amplitude, seed = ic_params\n        np.random.seed(seed)\n        c = amplitude * np.random.randn(N)\n    elif ic_type == \"uniform\":\n        value = ic_params[0]\n        c = np.full(N, value, dtype=float)\n\n    # Pre-calculate the denominator for the semi-implicit scheme, as it is constant.\n    den = 1.0 + M * kappa * k**4 * dt\n\n    energies = []\n    \n    # Calculate and store initial energy\n    energies.append(calculate_energy(c, k, kappa, dx))\n\n    # Perform time-stepping\n    for _ in range(Nt):\n        # Evaluate nonlinear term F'(c) = c^3 - c in real space\n        F_prime = c**3 - c\n        F_prime_hat = np.fft.fft(F_prime)\n        \n        c_hat = np.fft.fft(c)\n        \n        # Calculate numerator of the update rule\n        num = c_hat - M * dt * k**2 * F_prime_hat\n        \n        # Update concentration field in Fourier space\n        c_hat_new = num / den\n        \n        # Transform back to real space for the next step\n        # Taking np.real is necessary to discard numerical noise in the imaginary part\n        c = np.real(np.fft.ifft(c_hat_new))\n        \n        # Calculate and store energy of the new state\n        energies.append(calculate_energy(c, k, kappa, dx))\n\n    # Check for monotonic decrease in the stored energy sequence\n    is_monotonic = True\n    for i in range(len(energies) - 1):\n        # A tolerance is necessary for floating-point comparisons.\n        # It combines an absolute component for near-zero energies and\n        # a relative component for larger energies.\n        abs_tol = 1e-12\n        rel_tol = 1e-10\n        tolerance = abs_tol + rel_tol * abs(energies[i])\n        \n        if energies[i+1] > energies[i] + tolerance:\n            is_monotonic = False\n            break\n            \n    return is_monotonic\n\ndef calculate_energy(c, k, kappa, dx):\n    \"\"\"\n    Computes the discrete free energy of the system using the trapezoidal rule.\n    \"\"\"\n    # Bulk energy contribution: F(c) = (1/4)(c^2-1)^2\n    bulk_energy_density = 0.25 * (c**2 - 1)**2\n    \n    # Gradient energy contribution: (kappa/2) |grad c|^2\n    # The derivative is computed spectrally for high accuracy.\n    c_hat = np.fft.fft(c)\n    grad_c_hat = 1j * k * c_hat\n    grad_c = np.real(np.fft.ifft(grad_c_hat))\n    gradient_energy_density = 0.5 * kappa * grad_c**2\n    \n    # Total free energy is the integral over the domain, approximated by a sum.\n    # For a periodic function on a uniform grid, this sum is the trapezoidal rule.\n    total_energy = np.sum(bulk_energy_density + gradient_energy_density) * dx\n    return total_energy\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}