{
    "hands_on_practices": [
        {
            "introduction": "Before delving into the complexities of entangled systems, we must first establish a baseline for polymer dynamics. The Rouse model provides this foundation by describing the motion of an isolated chain without topological constraints. This exercise  guides you through deriving the chain's center-of-mass diffusion coefficient, linking microscopic frictional and thermal forces to a key macroscopic transport property and revealing its characteristic scaling with chain length.",
            "id": "3834543",
            "problem": "Consider a linear polymer modeled as a Rouse chain of $N$ identical beads connected by harmonic springs, immersed in a Newtonian solvent at absolute temperature $T$. Each bead experiences an isotropic Stokes friction with coefficient $\\zeta$ and a random thermal force due to the solvent. Assume overdamped dynamics (negligible inertia), no hydrodynamic interactions between beads, and no excluded volume interactions. Let the bead positions be $\\{\\mathbf{r}_{n}(t)\\}_{n=1}^{N}$, and define the center-of-mass position as $\\mathbf{R}(t) = \\frac{1}{N}\\sum_{n=1}^{N} \\mathbf{r}_{n}(t)$. The stochastic dynamics of each bead is governed by the Langevin equation\n$$\n\\zeta\\,\\dot{\\mathbf{r}}_{n}(t) = \\mathbf{F}_{n}^{\\text{int}}(t) + \\boldsymbol{\\xi}_{n}(t),\n$$\nwhere $\\mathbf{F}_{n}^{\\text{int}}(t)$ is the total internal spring force on bead $n$ from nearest-neighbor harmonic springs and $\\boldsymbol{\\xi}_{n}(t)$ is zero-mean Gaussian white noise. The random forces satisfy the fluctuation-dissipation relation\n$$\n\\langle \\xi_{n,i}(t)\\,\\xi_{m,j}(t') \\rangle = 2\\,k_{B}T\\,\\zeta\\,\\delta_{nm}\\,\\delta_{ij}\\,\\delta(t-t'),\n$$\nwhere $k_{B}$ is the Boltzmann constant, and $i,j \\in \\{x,y,z\\}$ label Cartesian components.\n\nStarting from these equations, derive the expression for the center-of-mass diffusion coefficient $D$ of the chain in terms of $N$, $\\zeta$, $k_{B}$, and $T$. Then, evaluate $D$ numerically for $N=100$, $\\zeta=10^{-12}\\ \\text{kg/s}$, and $T=300\\ \\text{K}$. Express the final diffusion coefficient in $\\text{m}^{2}\\,\\text{s}^{-1}$ and round your numerical answer to four significant figures.",
            "solution": "The problem asks for the derivation of the center-of-mass diffusion coefficient, $D$, for a Rouse chain and its numerical evaluation for a given set of parameters. We begin by analyzing the dynamics of the center of mass.\n\nThe position of the center of mass, $\\mathbf{R}(t)$, is defined as the average position of the $N$ beads:\n$$\n\\mathbf{R}(t) = \\frac{1}{N} \\sum_{n=1}^{N} \\mathbf{r}_{n}(t)\n$$\nTo find the equation of motion for the center of mass, we differentiate $\\mathbf{R}(t)$ with respect to time $t$:\n$$\n\\dot{\\mathbf{R}}(t) = \\frac{d\\mathbf{R}}{dt} = \\frac{1}{N} \\sum_{n=1}^{N} \\dot{\\mathbf{r}}_{n}(t)\n$$\nThe problem provides the Langevin equation for each bead $n$:\n$$\n\\zeta\\,\\dot{\\mathbf{r}}_{n}(t) = \\mathbf{F}_{n}^{\\text{int}}(t) + \\boldsymbol{\\xi}_{n}(t)\n$$\nwhere $\\zeta$ is the friction coefficient, $\\mathbf{F}_{n}^{\\text{int}}(t)$ is the internal spring force, and $\\boldsymbol{\\xi}_{n}(t)$ is the random thermal force. We can express $\\dot{\\mathbf{r}}_{n}(t)$ as:\n$$\n\\dot{\\mathbf{r}}_{n}(t) = \\frac{1}{\\zeta} \\left( \\mathbf{F}_{n}^{\\text{int}}(t) + \\boldsymbol{\\xi}_{n}(t) \\right)\n$$\nSubstituting this expression into the equation for the center-of-mass velocity gives:\n$$\n\\dot{\\mathbf{R}}(t) = \\frac{1}{N} \\sum_{n=1}^{N} \\frac{1}{\\zeta} \\left( \\mathbf{F}_{n}^{\\text{int}}(t) + \\boldsymbol{\\xi}_{n}(t) \\right) = \\frac{1}{N\\zeta} \\left( \\sum_{n=1}^{N} \\mathbf{F}_{n}^{\\text{int}}(t) + \\sum_{n=1}^{N} \\boldsymbol{\\xi}_{n}(t) \\right)\n$$\nThe sum of all internal forces within an isolated system must be zero due to Newton's third law. The internal forces $\\mathbf{F}_{n}^{\\text{int}}(t)$ arise from harmonic springs connecting nearest-neighbor beads. The force that bead $n$ exerts on bead $n+1$ is equal and opposite to the force that bead $n+1$ exerts on bead $n$. Therefore, when summed over all beads, these forces cancel out in pairs:\n$$\n\\sum_{n=1}^{N} \\mathbf{F}_{n}^{\\text{int}}(t) = \\mathbf{0}\n$$\nThe equation for the center-of-mass velocity simplifies to:\n$$\n\\dot{\\mathbf{R}}(t) = \\frac{1}{N\\zeta} \\sum_{n=1}^{N} \\boldsymbol{\\xi}_{n}(t)\n$$\nWe can rearrange this into the form of a Langevin equation for the center of mass:\n$$\n(N\\zeta) \\dot{\\mathbf{R}}(t) = \\sum_{n=1}^{N} \\boldsymbol{\\xi}_{n}(t)\n$$\nLet us define the total random force on the center of mass as $\\boldsymbol{\\Xi}(t) = \\sum_{n=1}^{N} \\boldsymbol{\\xi}_{n}(t)$. The equation of motion for the center of mass is then:\n$$\n\\zeta_{CM} \\dot{\\mathbf{R}}(t) = \\boldsymbol{\\Xi}(t)\n$$\nwhere $\\zeta_{CM} = N\\zeta$ is the effective friction coefficient for the center of mass of the entire chain.\n\nThis equation describes the Brownian motion of a particle with friction coefficient $\\zeta_{CM}$ under a random force $\\boldsymbol{\\Xi}(t)$. For this description to be consistent, the total random force must satisfy the fluctuation-dissipation theorem with the effective friction coefficient $\\zeta_{CM}$. Let us verify this. We compute the correlation function of $\\boldsymbol{\\Xi}(t)$:\n$$\n\\langle \\Xi_{i}(t) \\Xi_{j}(t') \\rangle = \\left\\langle \\left( \\sum_{n=1}^{N} \\xi_{n,i}(t) \\right) \\left( \\sum_{m=1}^{N} \\xi_{m,j}(t') \\right) \\right\\rangle = \\sum_{n=1}^{N} \\sum_{m=1}^{N} \\langle \\xi_{n,i}(t) \\xi_{m,j}(t') \\rangle\n$$\nUsing the given correlation for the individual noise terms, $\\langle \\xi_{n,i}(t)\\,\\xi_{m,j}(t') \\rangle = 2\\,k_{B}T\\,\\zeta\\,\\delta_{nm}\\,\\delta_{ij}\\,\\delta(t-t')$:\n$$\n\\langle \\Xi_{i}(t) \\Xi_{j}(t') \\rangle = \\sum_{n=1}^{N} \\sum_{m=1}^{N} 2\\,k_{B}T\\,\\zeta\\,\\delta_{nm}\\,\\delta_{ij}\\,\\delta(t-t')\n$$\nThe Kronecker delta $\\delta_{nm}$ collapses the sum over $m$, setting $m=n$:\n$$\n\\langle \\Xi_{i}(t) \\Xi_{j}(t') \\rangle = \\sum_{n=1}^{N} 2\\,k_{B}T\\,\\zeta\\,\\delta_{ij}\\,\\delta(t-t')\n$$\nSince the summand is independent of the index $n$, the summation simply results in a multiplication by $N$:\n$$\n\\langle \\Xi_{i}(t) \\Xi_{j}(t') \\rangle = N (2\\,k_{B}T\\,\\zeta\\,\\delta_{ij}\\,\\delta(t-t')) = 2\\,k_{B}T\\,(N\\zeta)\\,\\delta_{ij}\\,\\delta(t-t')\n$$\nThis is precisely the form of the fluctuation-dissipation theorem for a particle with friction coefficient $\\zeta_{CM} = N\\zeta$. Therefore, the center of mass of the Rouse chain diffuses like a single particle with friction coefficient $\\zeta_{CM}$. The diffusion coefficient $D$ is given by the Einstein relation:\n$$\nD = \\frac{k_{B}T}{\\zeta_{CM}}\n$$\nSubstituting $\\zeta_{CM} = N\\zeta$, we obtain the desired expression for the diffusion coefficient:\n$$\nD = \\frac{k_{B}T}{N\\zeta}\n$$\nThis result is a direct consequence of the assumption that there are no hydrodynamic interactions; the total friction on the chain is simply the sum of the friction on each bead.\n\nNext, we evaluate $D$ numerically using the provided values: $N=100$, $\\zeta=10^{-12}\\ \\text{kg/s}$, and $T=300\\ \\text{K}$. We use the standard value for the Boltzmann constant, $k_{B} = 1.380649 \\times 10^{-23}\\ \\text{J}\\,\\text{K}^{-1}$.\n$$\nD = \\frac{(1.380649 \\times 10^{-23}\\ \\text{J}\\,\\text{K}^{-1}) \\times (300\\ \\text{K})}{(100) \\times (10^{-12}\\ \\text{kg}\\,\\text{s}^{-1})}\n$$\n$$\nD = \\frac{4.141947 \\times 10^{-21}\\ \\text{J}}{10^{-10}\\ \\text{kg}\\,\\text{s}^{-1}}\n$$\nRecalling that $1\\ \\text{J} = 1\\ \\text{kg}\\,\\text{m}^{2}\\,\\text{s}^{-2}$, the units become $(\\text{kg}\\,\\text{m}^{2}\\,\\text{s}^{-2}) / (\\text{kg}\\,\\text{s}^{-1}) = \\text{m}^{2}\\,\\text{s}^{-1}$, which are the correct units for a diffusion coefficient.\n$$\nD = 4.141947 \\times 10^{-11}\\ \\text{m}^{2}\\,\\text{s}^{-1}\n$$\nThe problem specifies that the answer should be rounded to four significant figures. The fifth significant digit is $9$, so we round up the fourth digit.\n$$\nD \\approx 4.142 \\times 10^{-11}\\ \\text{m}^{2}\\,\\text{s}^{-1}\n$$",
            "answer": "$$\n\\boxed{4.142 \\times 10^{-11}}\n$$"
        },
        {
            "introduction": "The crucial conceptual leap from the Rouse model to reptation theory is the introduction of the 'tube,' a virtual confinement representing topological constraints from neighboring chains. Understanding the physical origin and scale of this tube is fundamental. This practice  demonstrates how to estimate the tube diameter $a$ from the underlying microscopic chain statistics, providing a tangible connection between the entanglement length $N_e$ and the size of the mesoscopic confinement.",
            "id": "3834565",
            "problem": "Consider a flexible polymer melt described within the Doi–Edwards reptation framework, where each chain is confined by topological constraints to a virtual tube that follows its primitive path. Let the chain be modeled as a Gaussian random walk composed of $N$ statistically independent Kuhn steps of length $b$, so that over $N$ steps the end-to-end vector $\\mathbf{R}$ has components with zero mean and identical variances due to isotropy. The entanglement length $N_e$ is defined as the number of Kuhn steps between successive topological constraints that effectively confine the chain. The tube diameter $a$ is operationally defined as the characteristic root-mean-square amplitude of the chain’s transverse fluctuations relative to the primitive path over a segment of $N_e$ Kuhn steps. Starting from Gaussian-chain random-walk statistics and isotropy of the displacement components, derive the scaling estimate of $a$ in terms of $b$ and $N_e$ by identifying $a^2$ with the mean-square transverse displacement of a segment containing $N_e$ Kuhn steps, up to an order-one prefactor. Then compute $a$ for $b = 1 \\,\\mathrm{nm}$ and $N_e = 50$. Express the final diameter in nanometers and round your answer to three significant figures.",
            "solution": "The problem asks for a scaling estimate for the tube diameter $a$ in a polymer melt, based on the reptation model. We begin with the fundamental concepts provided.\n\nA long flexible polymer chain is modeled as a random walk of $N$ Kuhn steps, each of length $b$. For a sufficiently long chain ($N \\gg 1$), the mean-square end-to-end distance, according to random walk statistics, is given by:\n$$\n\\langle |\\mathbf{R}|^2 \\rangle = N b^2\n$$\n\nIn a dense melt, the motion of a given chain is constrained by entanglements with its neighbors. The reptation model posits that these constraints confine the chain to a tube-like region. The centerline of this tube is called the primitive path. This primitive path is itself a random walk, composed of $N_{pp} = N/N_e$ steps, where $N_e$ is the number of Kuhn steps in a chain segment between two consecutive entanglements.\n\nThe length of a step of the primitive path is operationally defined as the tube diameter, $a$. Since the primitive path is a random walk of $N_{pp}$ steps of length $a$, its mean-square end-to-end distance is:\n$$\n\\langle |\\mathbf{R}_{PP}|^2 \\rangle = N_{pp} a^2 = \\frac{N}{N_e} a^2\n$$\n\nA crucial aspect of this coarse-graining procedure is that the overall dimensions of the primitive path must match the overall dimensions of the original chain. Therefore, we equate the mean-square end-to-end distances of the two models:\n$$\n\\langle |\\mathbf{R}|^2 \\rangle = \\langle |\\mathbf{R}_{PP}|^2 \\rangle\n$$\n$$\nN b^2 = \\frac{N}{N_e} a^2\n$$\n\nSolving for $a^2$, we cancel the total number of steps $N$ from both sides:\n$$\na^2 = N_e b^2\n$$\nThis gives the fundamental scaling relationship for the tube diameter:\n$$\na = \\sqrt{N_e} b\n$$\n\nThis result establishes that the tube diameter is equal to the root-mean-square end-to-end distance of a subchain of length $N_e$. This aligns with the physical picture that a chain segment between entanglements determines the size of its own confinement.\n\nThe problem statement also directs us to consider the \"mean-square transverse displacement\". This provides an alternative, albeit consistent, perspective. Let us consider a subchain of $N_e$ Kuhn steps. Its mean-square end-to-end distance is $\\langle |\\mathbf{R}_{N_e}|^2 \\rangle = N_e b^2$. Let us establish an arbitrary Cartesian coordinate system. Due to the isotropy of the random walk, the mean-square components of the end-to-end vector are equal:\n$$\n\\langle R_x^2 \\rangle = \\langle R_y^2 \\rangle = \\langle R_z^2 \\rangle = \\frac{1}{3} \\langle |\\mathbf{R}_{N_e}|^2 \\rangle = \\frac{1}{3} N_e b^2\n$$\nIf we align the local primitive path with the $z$-axis, the displacement in the $xy$-plane is considered transverse. The mean-square transverse displacement of the end of the segment with respect to its beginning is $\\langle R_{\\perp}^2 \\rangle = \\langle R_x^2 + R_y^2 \\rangle$.\n$$\n\\langle R_{\\perp}^2 \\rangle = \\langle R_x^2 \\rangle + \\langle R_y^2 \\rangle = \\frac{1}{3} N_e b^2 + \\frac{1}{3} N_e b^2 = \\frac{2}{3} N_e b^2\n$$\nThe problem states to identify $a^2$ with this quantity, \"up to an order-one prefactor\". This confirms the scaling $a^2 \\propto N_e b^2$. The derivation based on matching the overall chain dimensions yields the simplest form of this relation, with a prefactor of $1$, which we adopt for the calculation as is standard for such scaling estimates.\n\nNow, we compute the numerical value of $a$ using the provided data:\n- Kuhn step length, $b = 1 \\,\\mathrm{nm}$\n- Entanglement length, $N_e = 50$\n\nUsing the derived scaling relation $a = \\sqrt{N_e} b$:\n$$\na = \\sqrt{50} \\times (1 \\,\\mathrm{nm})\n$$\n$$\na = \\sqrt{25 \\times 2} \\,\\mathrm{nm} = 5\\sqrt{2} \\,\\mathrm{nm}\n$$\nTo find the numerical value, we use the approximation $\\sqrt{2} \\approx 1.41421356...$:\n$$\na \\approx 5 \\times 1.41421356 \\,\\mathrm{nm} \\approx 7.0710678 \\,\\mathrm{nm}\n$$\nRounding the result to three significant figures, as requested:\n$$\na \\approx 7.07 \\,\\mathrm{nm}\n$$",
            "answer": "$$\\boxed{7.07}$$"
        },
        {
            "introduction": "The power of the reptation model lies in its ability to connect microscopic properties to macroscopic rheology, but its parameters must be determined from experiments or more detailed simulations. This exercise introduces Primitive Path Analysis (PPA), a vital computational technique for bridging the atomistic and mesoscopic scales. By analyzing data from a simulated melt , you will learn how to extract the core parameters of the tube model, such as the entanglement length $N_e$ and tube diameter $a$, grounding the abstract theory in practical analysis.",
            "id": "3834561",
            "problem": "You are given a conceptual bridge from atomistic to mesoscale descriptions for an entangled polymer melt through the notion of the primitive path. Consider a polymer chain of $N$ monomers in a dense melt. In a primitive path analysis, chain ends are fixed while all intrachain slack is removed subject to topological constraints, resulting in a primitive path with total contour length $L_{\\mathrm{pp}}$ and preserving the original chain end-to-end vector of magnitude $R_{\\mathrm{ee}}$. In the classical tube picture of reptation, the primitive path can be modeled as a random walk of $Z$ uncorrelated steps, each of effective length (tube diameter parameter) $a$. Assume Gaussian chain statistics at all relevant coarse-graining levels and that entanglement strands correspond to $N_e$ monomers each. Use the following foundational bases without invoking any result beyond them:\n- The random-walk relation for an ideal chain: for $Z$ uncorrelated steps of length $a$, the mean-squared end-to-end distance satisfies $\\langle R^2 \\rangle = Z a^2$ and the total contour length is $L = Z a$.\n- For a Gaussian polymer with characteristic ratio $C_{\\infty}$ and monomeric statistical segment length $b$ (distance between effective consecutive segments), the mean-squared end-to-end distance of a subchain of $n$ monomers is $\\langle R^2 \\rangle = C_{\\infty} b^2 n$.\n\nTask:\n- Starting from the principles above and the definitions of the primitive path and the tube model, derive how to compute the number of entanglements per chain $Z$ solely from $R_{\\mathrm{ee}}$ and $L_{\\mathrm{pp}}$, the entanglement length $N_e$ from $Z$ and $N$, and two equivalent determinations of the tube diameter parameter $a$: one using primitive path quantities and one using Gaussian statistics for an entanglement strand of $N_e$ monomers.\n- Design an algorithm that, for each test case, computes:\n  1. $Z$ using only $R_{\\mathrm{ee}}$ and $L_{\\mathrm{pp}}$,\n  2. $N_e$ in monomers from $Z$ and $N$,\n  3. $a$ using primitive path quantities,\n  4. $a$ using monomeric statistics with $C_{\\infty}$ and $b$,\n  5. a boolean flag indicating whether the two $a$ values agree within a relative tolerance of $10^{-9}$.\n- Physical units: interpret all distances as nanometers and all monomer counts ($N$ and $N_e$) as dimensionless counts of monomers. Express the tube diameter parameter in nanometers in the output. No angles are involved.\n\nTest suite:\nProvide a program that evaluates the following four parameter sets, each given as $(N, R_{\\mathrm{ee}}, L_{\\mathrm{pp}}, b, C_{\\infty})$ with distances in nanometers:\n- Case 1 (general, moderately entangled): $(1000, 100.0, 300.0, 1.0, 10.0)$.\n- Case 2 (highly entangled, stiffer chain): $(5000, 250.0, 2500.0, 0.5, 50.0)$.\n- Case 3 (near-threshold entanglement count $Z = 2$): $(200, 50.0, 70.71067811865476, 1.0, 12.5)$.\n- Case 4 (boundary case $Z = 1$): $(120, 60.0, 60.0, 0.5, 120.0)$.\n\nRequired output:\n- For each test case, output a list of four elements: $[N_e, a_{\\mathrm{PPA}}, a_{\\mathrm{stat}}, \\text{agree}]$, where $N_e$ is a float (monomers), $a_{\\mathrm{PPA}}$ is the tube diameter from primitive path quantities in nanometers, $a_{\\mathrm{stat}}$ is the tube diameter from monomeric statistics in nanometers, and $\\text{agree}$ is a boolean indicating agreement within the specified tolerance.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the four-element list for one test case, in the same order as above. For example: $[[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot]]$.",
            "solution": "The task is to derive expressions for key quantities in the tube model ($Z$, $N_e$, and $a$) and then implement a calculation for several test cases. The derivations will be performed first, followed by the algorithmic plan.\n\n**Part 1: Derivations from First Principles**\n\nThe problem provides two foundational bases:\n1.  For a primitive path modeled as a random walk of $Z$ steps of length $a$:\n    -   The mean-squared end-to-end distance is $\\langle R^2 \\rangle = Z a^2$.\n    -   The total contour length is $L = Z a$.\n2.  For a Gaussian subchain of $n$ monomers with characteristic ratio $C_{\\infty}$ and statistical segment length $b$:\n    -   The mean-squared end-to-end distance is $\\langle R^2 \\rangle = C_{\\infty} b^2 n$.\n\nWe are given that a specific primitive path has contour length $L_{\\mathrm{pp}}$ and end-to-end distance $R_{\\mathrm{ee}}$. We equate these specific values with the quantities from the random walk model.\n\n**1. Derivation of the Number of Entanglements, $Z$**\n\nThe primitive path is modeled as a random walk. We apply the two relations from the random walk model to the given primitive path quantities:\n$$R_{\\mathrm{ee}}^2 = Z a^2 \\quad (1)$$\n$$L_{\\mathrm{pp}} = Z a \\quad (2)$$\nWe have a system of two equations with two unknowns, $Z$ and $a$. To find $Z$ in terms of $R_{\\mathrm{ee}}$ and $L_{\\mathrm{pp}}$, we first solve Equation (2) for $a$:\n$$a = \\frac{L_{\\mathrm{pp}}}{Z}$$\nNow, substitute this expression for $a$ into Equation (1):\n$$R_{\\mathrm{ee}}^2 = Z \\left( \\frac{L_{\\mathrm{pp}}}{Z} \\right)^2 = Z \\frac{L_{\\mathrm{pp}}^2}{Z^2} = \\frac{L_{\\mathrm{pp}}^2}{Z}$$\nFinally, we solve for $Z$:\n$$Z = \\frac{L_{\\mathrm{pp}}^2}{R_{\\mathrm{ee}}^2} = \\left(\\frac{L_{\\mathrm{pp}}}{R_{\\mathrm{ee}}}\\right)^2$$\nThis equation shows that the number of entanglement segments is determined by the ratio of the squared primitive path contour length to the squared end-to-end distance.\n\n**2. Derivation of the Entanglement Length, $N_e$**\n\nThe total polymer chain consists of $N$ monomers. This chain is coarse-grained into $Z$ entanglement segments. Each entanglement segment is stated to correspond to $N_e$ monomers. Assuming the entire chain is composed of these segments, the total number of monomers $N$ is the product of the number of segments $Z$ and the number of monomers per segment $N_e$:\n$$N = Z N_e$$\nSolving for $N_e$, the number of monomers per entanglement, we get:\n$$N_e = \\frac{N}{Z}$$\n\n**3. Two Determinations of the Tube Diameter, $a$**\n\nThe tube diameter parameter $a$ represents the effective step length of the primitive path.\n\n**3.1. Determination from Primitive Path Analysis ($a_{\\mathrm{PPA}}$)**\n\nThis value can be directly calculated from the primitive path random walk model. Using Equation (2) from the initial derivation:\n$$L_{\\mathrm{pp}} = Z a$$\nWe can solve for $a$ using the previously derived expression for $Z$:\n$$a_{\\mathrm{PPA}} = \\frac{L_{\\mathrm{pp}}}{Z}$$\nAlternatively, one could use $a = R_{\\mathrm{ee}}/\\sqrt{Z}$ or $a=R_{\\mathrm{ee}}^2/L_{\\mathrm{pp}}$, which are mathematically equivalent. We will use the expression $L_{\\mathrm{pp}}/Z$ as it directly uses the computed value of $Z$.\n\n**3.2. Determination from Monomeric Statistics ($a_{\\mathrm{stat}}$)**\n\nThe tube diameter $a$ is physically the characteristic size of the confinement tube, which is equivalent to the end-to-end distance of an entanglement strand. An entanglement strand is a subchain containing $N_e$ monomers. We can therefore use the Gaussian chain model for a subchain to determine this distance.\nFrom the second foundational basis, the mean-squared end-to-end distance for a chain of $n$ monomers is $\\langle R^2 \\rangle = C_{\\infty} b^2 n$.\nFor an entanglement strand, we set $n = N_e$. The mean-squared end-to-end distance of this strand is:\n$$\\langle R_{\\mathrm{strand}}^2 \\rangle = C_{\\infty} b^2 N_e$$\nThe tube diameter $a$ is the root-mean-square of this distance. Thus, $a^2$ is equal to this mean-squared distance:\n$$a^2 = C_{\\infty} b^2 N_e$$\nSolving for $a$ gives the second determination:\n$$a_{\\mathrm{stat}} = \\sqrt{C_{\\infty} b^2 N_e} = b \\sqrt{C_{\\infty} N_e}$$\n\n**Part 2: Algorithmic Design**\n\nThe algorithm will process a list of test cases, where each case is a tuple of parameters $(N, R_{\\mathrm{ee}}, L_{\\mathrm{pp}}, b, C_{\\infty})$. For each case, the following steps are executed:\n1.  Calculate the number of entanglements per chain, $Z$, using the derived formula:\n    $$Z = (L_{\\mathrm{pp}} / R_{\\mathrm{ee}})^2$$\n2.  Calculate the number of monomers per entanglement, $N_e$:\n    $$N_e = N / Z$$\n3.  Calculate the tube diameter from primitive path analysis, $a_{\\mathrm{PPA}}$:\n    $$a_{\\mathrm{PPA}} = L_{\\mathrm{pp}} / Z$$\n4.  Calculate the tube diameter from monomeric statistics, $a_{\\mathrm{stat}}$:\n    $$a_{\\mathrm{stat}} = b \\sqrt{C_{\\infty} N_e}$$\n5.  Compare $a_{\\mathrm{PPA}}$ and $a_{\\mathrm{stat}}$ to check for agreement. The boolean flag `agree` is set to `True` if the relative difference is within a tolerance of $10^{-9}$, and `False` otherwise. The check is formulated as:\n    $$\\frac{|a_{\\mathrm{PPA}} - a_{\\mathrm{stat}}|}{\\max(|a_{\\mathrm{PPA}}|, |a_{\\mathrm{stat}}|)} \\le 10^{-9}$$\n    This check confirms the internal consistency of the model parameters for each test case.\n6.  The results for each case, $[N_e, a_{\\mathrm{PPA}}, a_{\\mathrm{stat}}, \\text{agree}]$, are collected. The final output is a list containing the results for all test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the polymer physics problem for given test cases, deriving primitive path \n    and tube model parameters from foundational principles.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (N, R_ee, L_pp, b, C_inf)\n    # N: total monomers per chain (dimensionless)\n    # R_ee: end-to-end distance of the chain (nm)\n    # L_pp: contour length of the primitive path (nm)\n    # b: monomeric statistical segment length (nm)\n    # C_inf: characteristic ratio (dimensionless)\n    test_cases = [\n        (1000.0, 100.0, 300.0, 1.0, 10.0),\n        (5000.0, 250.0, 2500.0, 0.5, 50.0),\n        (200.0, 50.0, 70.71067811865476, 1.0, 12.5),\n        (120.0, 60.0, 60.0, 0.5, 120.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N, R_ee, L_pp, b, C_inf = case\n\n        # 1. Compute Z, the number of entanglements per chain.\n        # Z = (L_pp / R_ee)^2\n        # This relationship derives from modeling the primitive path as a random walk\n        # where R_ee^2 = Z * a^2 and L_pp = Z * a.\n        if R_ee == 0:\n            # Avoid division by zero, although physically R_ee > 0 for a polymer chain\n            # and all test cases adhere to this.\n            # Z would be infinite, which is unphysical.\n            # For this problem, we can assume R_ee is always positive.\n            pass\n        \n        Z = (L_pp / R_ee)**2\n\n        # 2. Compute N_e, the entanglement length in monomers.\n        # N_e = N / Z\n        # This assumes the entire chain of N monomers is composed of Z entanglement strands.\n        if Z == 0:\n            # An unentangled chain might be considered as Z->0, leading to N_e->inf,\n            # but the model is for Z >= 1. The test cases have Z >= 1.\n            pass\n\n        N_e = N / Z\n\n        # 3. Compute a_PPA, the tube diameter from primitive path analysis.\n        # a_PPA = L_pp / Z\n        # This is the effective step length of the primitive path random walk.\n        a_PPA = L_pp / Z\n\n        # 4. Compute a_stat, the tube diameter from monomeric statistics.\n        # a_stat = b * sqrt(C_inf * N_e)\n        # This is the root-mean-square end-to-end distance of a subchain\n        # of N_e monomers, which corresponds to one entanglement strand.\n        a_stat = b * np.sqrt(C_inf * N_e)\n\n        # 5. Check if the two determinations of 'a' agree within the specified tolerance.\n        # The problem is constructed such that these values should be consistent,\n        # reflecting a self-consistent physical model.\n        tolerance = 1e-9\n        agree = np.isclose(a_PPA, a_stat, rtol=tolerance, atol=0)\n\n        # Append the results for the current case.\n        results.append([N_e, a_PPA, a_stat, bool(agree)])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, represented as a string.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}