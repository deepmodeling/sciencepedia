{
    "hands_on_practices": [
        {
            "introduction": "一维双原子链是理解声子色散的经典模型，为更复杂的真实材料计算提供了概念基础。本练习旨在通过从第一性原理推导声学支和光学支，来揭示布里渊区中心频率带隙的物理起源。虽然在实际应用中，原子间的力常数（如 $\\kappa$）是通过密度泛函微扰理论（DFPT）计算的，但掌握此模型是正确解读这些计算结果的关键。",
            "id": "3800615",
            "problem": "考虑一个一维双原子布拉菲格子，其原胞平移长度为 $a$。每个原胞包含 $2$ 个原子：种类 $\\kappa=1$ 的原子质量为 $M_1$，位于位置 $x=na$；种类 $\\kappa=2$ 的原子质量为 $M_2$，位于位置 $x=na + a/2$，其中 $n \\in \\mathbb{Z}$ 标记原胞。假设 Born–Oppenheimer 近似和简谐近似成立。原子间力常数通过密度泛函微扰理论 (DFPT) 计算，并且由于对称性和短程成键，仅在最近邻的不同类原子对之间非零。通过刚度为 $\\kappa$ 的相同标量弹簧来模拟这些相互作用，每个 $\\kappa=1$ 原子连接到其两个最近的 $\\kappa=2$ 邻居（一个在同一原胞内，一个在相邻原胞内），类似地，每个 $\\kappa=2$ 原子也连接到其两个最近的 $\\kappa=1$ 邻居。\n\n从原子 $(R,\\kappa)$ 上的简谐力定义 $F_{R\\kappa} = - \\sum_{R',\\kappa'} \\Phi_{R\\kappa,R'\\kappa'}\\, u_{R'\\kappa'}$ 出发，其中 $\\Phi_{R\\kappa,R'\\kappa'}$ 是原子间力常数，$u_{R\\kappa}$ 是小位移，并利用晶格周期性和布洛赫形式的位移 $u_{R\\kappa}(t) = U_{\\kappa}(q)\\, \\exp(i q R - i \\omega t)$，构建 $2 \\times 2$ 的质量加权动力学矩阵 $D(q)$。该矩阵的本征值问题通过其本征值给出声子频率 $\\omega^2(q)$。推导两个分支 $\\omega_{-}(q)$（声学支）和 $\\omega_{+}(q)$（光学支），并阐明基矢的作用以及由 $a/2$ 内坐标产生的相位因子。然后，通过分析布里渊区中心极限 $q \\to 0$，确定 $q=0$ 处的光学模带隙，并以 $\\kappa$、$M_1$ 和 $M_2$ 的闭合形式表达式给出。\n\n仅提供布里渊区中心光学频率 $\\omega_{+}(0)$ 的解析表达式作为最终答案。无需进行数值计算。",
            "solution": "用户希望解决一个关于一维双原子链的晶格动力学问题。在继续之前，我将验证问题陈述。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n\n*   **系统**：一维双原子布拉菲格子。\n*   **原胞平移**：长度 $a$。\n*   **基矢**：每个原胞有 $2$ 个原子。\n    *   原子 $\\kappa=1$：质量 $M_1$，位置 $x=na$。\n    *   原子 $\\kappa=2$：质量 $M_2$，位置 $x=na + a/2$。\n    *   $n \\in \\mathbb{Z}$ 是原胞指数。\n*   **近似**：Born–Oppenheimer 近似和简谐近似。\n*   **相互作用**：仅在最近邻的不同类原子对之间力常数非零，模型为刚度为 $\\kappa$ 的相同标量弹簧。\n*   **定义**：\n    *   简谐力：$F_{R\\kappa} = - \\sum_{R',\\kappa'} \\Phi_{R\\kappa,R'\\kappa'}\\, u_{R'\\kappa'}$。\n    *   布洛赫形式位移：$u_{R\\kappa}(t) = U_{\\kappa}(q)\\, \\exp(i q R - i \\omega t)$。\n*   **任务**：\n    1.  构建 $2 \\times 2$ 的质量加权动力学矩阵 $D(q)$。\n    2.  推导两个分支 $\\omega_{-}(q)$（声学支）和 $\\omega_{+}(q)$（光学支）。\n    3.  分析布里渊区中心极限 $q \\to 0$。\n    4.  确定 $q=0$ 处的光学模带隙的闭合形式表达式。\n    5.  提供布里渊区中心光学频率 $\\omega_{+}(0)$ 的解析表达式。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n*   **科学依据**：该问题是入门固体物理学中的一个典型练习，用于解释声子色散关系、声学支和光学支的概念，以及基矢在晶格中的作用。所有原理和近似（简谐近似、布洛赫定理）都是该领域的基础。提及密度泛函微扰理论 (DFPT) 正确地将该问题置于现代计算材料科学的背景下，其中 DFPT 是计算力常数（此处为 $\\kappa$）的标准方法。该问题在科学上是合理的。\n*   **适定性**：该问题定义清晰，包含所有必要的参数（$M_1, M_2, a, \\kappa$）和一个直接的物理模型（最近邻弹簧）。目标明确，可以导出一个唯一且有意义的解。\n*   **客观性**：问题以精确、无偏见和形式化的科学语言陈述。没有主观或模糊的术语。\n\n该问题没有违反任何无效性标准。它在其领域内是一个适定的、有科学依据的标准问题。\n\n**第 3 步：结论与行动**\n\n问题是**有效的**。将提供完整解答。\n\n### 解\n\n我们首先为标号为 $n$ 的原胞中的两个原子建立运动方程。设 $u_{n,1}$ 和 $u_{n,2}$ 分别为原胞 $n$ 中质量为 $M_1$ 和 $M_2$ 的原子偏离平衡位置的位移。\n\n位于 $na$ 位置、质量为 $M_1$ 的原子与其两个最近邻相连：一个是在同一原胞内位于 $na+a/2$ 的质量为 $M_2$ 的原子，另一个是在前一个原胞内位于 $(n-1)a+a/2$ 的质量为 $M_2$ 的原子。该原子受到的净力是这两个弹簧施加的力的总和：\n$$F_{n,1} = \\kappa(u_{n,2} - u_{n,1}) + \\kappa(u_{n-1,2} - u_{n,1})$$\n应用牛顿第二定律 $F_{n,1} = M_1 \\ddot{u}_{n,1}$，我们得到：\n$$M_1 \\ddot{u}_{n,1} = \\kappa(u_{n,2} + u_{n-1,2} - 2 u_{n,1})$$\n类似地，位于 $na+a/2$ 位置、质量为 $M_2$ 的原子与其两个最近邻相连：一个是在同一原胞内位于 $na$ 的质量为 $M_1$ 的原子，另一个是在下一个原胞内位于 $(n+1)a$ 的质量为 $M_1$ 的原子。其受到的净力为：\n$$F_{n,2} = \\kappa(u_{n,1} - u_{n,2}) + \\kappa(u_{n+1,1} - u_{n,2})$$\n应用牛顿第二定律 $F_{n,2} = M_2 \\ddot{u}_{n,2}$，我们得到：\n$$M_2 \\ddot{u}_{n,2} = \\kappa(u_{n+1,1} + u_{n,1} - 2 u_{n,2})$$\n我们寻找符合布洛赫定理的平面波解（声子）。在原胞 $n$（位置 $R=na$）中，带有原胞内基矢 $\\vec{\\tau}_\\kappa$ 的原子 $\\kappa$ 的位移由下式给出：\n$$u_{n,\\kappa}(t) = U_{\\kappa}(q) \\exp[i(q(na+\\tau_\\kappa) - \\omega t)]$$\n在当前的一维情况下，基矢为原子 1 的 $\\tau_1=0$ 和原子 2 的 $\\tau_2=a/2$。位移为：\n$$u_{n,1}(t) = U_1 \\exp[i(qna - \\omega t)]$$\n$$u_{n,2}(t) = U_2 \\exp[i(q(na+a/2) - \\omega t)]$$\n相邻原子的位移可以与这些位移关联起来：\n$$u_{n-1,2}(t) = U_2 \\exp[i(q((n-1)a+a/2) - \\omega t)] = U_2 \\exp[i(q(na+a/2) - \\omega t)] \\exp(-iqa) = u_{n,2}(t) \\exp(-iqa)$$\n$$u_{n+1,1}(t) = U_1 \\exp[i(q(n+1)a - \\omega t)] = U_1 \\exp[i(qna - \\omega t)] \\exp(iqa) = u_{n,1}(t) \\exp(iqa)$$\n对时间的二阶导数为 $\\ddot{u}_{n,\\kappa} = -\\omega^2 u_{n,\\kappa}$。\n\n将这些代入运动方程：\n对于质量 $M_1$：\n$$-M_1 \\omega^2 u_{n,1} = \\kappa(u_{n,2} + u_{n-1,2} - 2 u_{n,1}) = \\kappa(u_{n,2} + u_{n,2}\\exp(-iqa) - 2 u_{n,1})$$\n两边同除以 $u_{n,1} = U_1 \\exp[i(qna - \\omega t)]$：\n$$-M_1 \\omega^2 U_1 = \\kappa \\left( \\frac{u_{n,2}}{u_{n,1}} (1+\\exp(-iqa)) - 2U_1 \\right)$$\n相位比为 $\\frac{u_{n,2}}{u_{n,1}} = \\frac{U_2}{U_1} \\exp(iqa/2)$。\n$$-M_1 \\omega^2 U_1 = \\kappa \\left( \\frac{U_2}{U_1} \\exp(iqa/2) (1+\\exp(-iqa)) - 2U_1 \\right)$$\n$$-M_1 \\omega^2 U_1 = \\kappa \\left( \\frac{U_2}{U_1} (\\exp(iqa/2)+\\exp(-iqa/2)) - 2U_1 \\right)$$\n$$-M_1 \\omega^2 U_1 = \\kappa(2 \\frac{U_2}{U_1} \\cos(qa/2) - 2U_1)$$\n$$(2\\kappa - M_1 \\omega^2) U_1 - 2\\kappa \\cos(qa/2) U_2 = 0$$\n对于质量 $M_2$：\n$$-M_2 \\omega^2 u_{n,2} = \\kappa(u_{n+1,1} + u_{n,1} - 2u_{n,2}) = \\kappa(u_{n,1}\\exp(iqa) + u_{n,1} - 2u_{n,2})$$\n两边同除以 $u_{n,2} = U_2 \\exp[i(q(na+a/2) - \\omega t)]$：\n$$-M_2 \\omega^2 U_2 = \\kappa \\left( \\frac{u_{n,1}}{u_{n,2}} (\\exp(iqa)+1) - 2U_2 \\right)$$\n相位比为 $\\frac{u_{n,1}}{u_{n,2}} = \\frac{U_1}{U_2} \\exp(-iqa/2)$。与前面类似地处理：\n$$-M_2 \\omega^2 U_2 = \\kappa(2 \\frac{U_1}{U_2} \\cos(qa/2) - 2U_2)$$\n$$-2\\kappa \\cos(qa/2) U_1 + (2\\kappa - M_2 \\omega^2) U_2 = 0$$\n这两个关于振幅 $U_1$ 和 $U_2$ 的齐次线性方程组可以写成矩阵形式：\n$$\n\\begin{pmatrix}\n2\\kappa - M_1 \\omega^2  -2\\kappa \\cos(qa/2) \\\\\n-2\\kappa \\cos(qa/2)  2\\kappa - M_2 \\omega^2\n\\end{pmatrix}\n\\begin{pmatrix}\nU_1 \\\\\nU_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\n其形式为 $(C(q) - M\\omega^2)U = 0$，其中 $C(q)$ 是傅里叶变换后的力常数矩阵，$M$ 是对角质量矩阵。质量加权动力学矩阵 $D(q)$ 由本征值问题 $D(q)v=\\omega^2 v$ 定义，其中 $v = M^{1/2}U$。这给出 $D(q) = M^{-1/2}C(q)M^{-1/2}$。\n$$\nC(q) = \\begin{pmatrix}\n2\\kappa  -2\\kappa \\cos(qa/2) \\\\\n-2\\kappa \\cos(qa/2)  2\\kappa\n\\end{pmatrix}\n$$\n$$\nD(q) = \\begin{pmatrix}\n\\frac{1}{\\sqrt{M_1}}  0 \\\\\n0  \\frac{1}{\\sqrt{M_2}}\n\\end{pmatrix}\n\\begin{pmatrix}\n2\\kappa  -2\\kappa \\cos(qa/2) \\\\\n-2\\kappa \\cos(qa/2)  2\\kappa\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{1}{\\sqrt{M_1}}  0 \\\\\n0  \\frac{1}{\\sqrt{M_2}}\n\\end{pmatrix}\n$$\n$$\nD(q) = \\begin{pmatrix}\n\\frac{2\\kappa}{M_1}  -\\frac{2\\kappa}{\\sqrt{M_1 M_2}} \\cos(qa/2) \\\\\n-\\frac{2\\kappa}{\\sqrt{M_1 M_2}} \\cos(qa/2)  \\frac{2\\kappa}{M_2}\n\\end{pmatrix}\n$$\n这就是所求的 $2 \\times 2$ 质量加权动力学矩阵。其本征值 $\\omega^2$ 可通过求解久期方程 $\\det(D(q) - \\omega^2 I)=0$ 得到：\n$$ \\left(\\frac{2\\kappa}{M_1} - \\omega^2\\right) \\left(\\frac{2\\kappa}{M_2} - \\omega^2\\right) - \\left(\\frac{2\\kappa}{\\sqrt{M_1 M_2}} \\cos(qa/2)\\right)^2 = 0 $$\n$$ \\omega^4 - 2\\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right)\\omega^2 + \\frac{4\\kappa^2}{M_1 M_2} - \\frac{4\\kappa^2}{M_1 M_2}\\cos^2(qa/2) = 0 $$\n$$ \\omega^4 - 2\\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right)\\omega^2 + \\frac{4\\kappa^2}{M_1 M_2}\\sin^2(qa/2) = 0 $$\n这是一个关于 $\\omega^2$ 的二次方程。求解 $\\omega^2$：\n$$ \\omega^2 = \\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) \\pm \\sqrt{\\kappa^2\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right)^2 - \\frac{4\\kappa^2}{M_1 M_2}\\sin^2(qa/2)} $$\n$$ \\omega^2 = \\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) \\pm \\kappa\\sqrt{\\left(\\frac{1}{M_1^2} + \\frac{2}{M_1 M_2} + \\frac{1}{M_2^2}\\right) - \\frac{4}{M_1 M_2}\\sin^2(qa/2)} $$\n使用 $\\sin^2(x) = 1-\\cos^2(x)$：\n$$ \\omega^2 = \\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) \\pm \\kappa\\sqrt{\\left(\\frac{1}{M_1^2} - \\frac{2}{M_1 M_2} + \\frac{1}{M_2^2}\\right) + \\frac{4}{M_1 M_2}\\cos^2(qa/2)} $$\n$$ \\omega_{\\pm}^2(q) = \\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) \\pm \\kappa\\sqrt{\\left(\\frac{1}{M_1} - \\frac{1}{M_2}\\right)^2 + \\frac{4}{M_1 M_2}\\cos^2(qa/2)} $$\n上分支（$+$号）是光学支 $\\omega_{+}(q)$，下分支（$-$号）是声学支 $\\omega_{-}(q)$。\n\n为了找到布里渊区中心的光学频率，我们计算 $q=0$ 处的光学支。当 $q \\to 0$ 时，$\\cos(qa/2) \\to 1$。\n$$ \\omega_{+}^2(0) = \\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) + \\kappa\\sqrt{\\left(\\frac{1}{M_1} - \\frac{1}{M_2}\\right)^2 + \\frac{4}{M_1 M_2}} $$\n平方根下的项可以简化：\n$$ \\sqrt{\\left(\\frac{1}{M_1^2} - \\frac{2}{M_1 M_2} + \\frac{1}{M_2^2}\\right) + \\frac{4}{M_1 M_2}} = \\sqrt{\\frac{1}{M_1^2} + \\frac{2}{M_1 M_2} + \\frac{1}{M_2^2}} = \\sqrt{\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right)^2} = \\frac{1}{M_1} + \\frac{1}{M_2} $$\n将此结果代回 $\\omega_{+}^2(0)$ 的表达式中：\n$$ \\omega_{+}^2(0) = \\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) + \\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) = 2\\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) $$\n布里渊区中心的光学频率是该值的平方根。\n$$ \\omega_{+}(0) = \\sqrt{2\\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right)} $$\n这表示光学模的频率，在此模式下，原胞中的两个原子彼此反向振动，而它们的质心保持静止。$q=0$ 处声学支和光学支之间的能隙由 $\\omega_{+}(0) - \\omega_{-}(0)$ 给出。由于 $\\omega_{-}(0)=0$，该带隙就是 $\\omega_{+}(0)$。",
            "answer": "$$\\boxed{\\sqrt{2\\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right)}}$$"
        },
        {
            "introduction": "纵向光学-横向光学（LO-TO）声子劈裂是极性材料的一个关键特征，也是 DFPT 计算必须精确捕捉的现象。本练习将演示长程库仑相互作用如何对动力学矩阵产生一个非解析的修正项，从而导致频率劈裂的大小依赖于声子的传播方向。通过该练习，您将把晶格动力学与宏观静电学联系起来，加深对极性材料中声子行为的理解。",
            "id": "3800578",
            "problem": "一个二元极性双原子晶体在布里渊区中心有一个红外活性光学模式。在长波极限下，密度泛函微扰理论 (Density Functional Perturbation Theory, DFPT) 指出，对区中心动力学矩阵存在一个非解析的长程库仑贡献，该贡献导致了纵向光学–横向光学 (LO–TO) 频率劈裂。子晶格 $\\kappa$ 的 Born 有效电荷张量定义为 $Z^{*}_{\\kappa,\\alpha\\beta} = \\Omega \\left.\\partial P_{\\beta}/\\partial u_{\\kappa,\\alpha}\\right|_{\\mathbf{E}=0}$，其中 $\\Omega$ 是原胞体积，$\\mathbf{P}$ 是宏观极化强度，$\\mathbf{u}_{\\kappa}$ 是子晶格位移。考虑一个简单的双原子晶体，它具有单一的极性光学模式，其本征位移与声子传播方向 $\\hat{\\mathbf{q}}$ 共线。在电动力学计算中使用高斯单位制。\n\n该晶体的特征数据如下：\n- 各向同性的 Born 有效电荷 $Z^{*}_{A} = +Z^{*}\\,\\mathbf{I}$ 和 $Z^{*}_{B} = -Z^{*}\\,\\mathbf{I}$，其中 $Z^{*} = 2.10$。\n- 高频介电张量 $\\boldsymbol{\\epsilon}^{\\infty} = \\mathrm{diag}(5.50,\\,5.50,\\,3.30)$。\n- 子晶格质量 $M_{A} = 23.0$ 和 $M_{B} = 35.45$（单位为原子质量单位），以及原胞体积 $\\Omega = 90.0$（单位为 $\\text{\\AA}^{3}$）。\n\n从上述定义、纵向模式的长波静电边界条件以及相对坐标的运动方程出发，推导该双原子晶体 LO–TO 劈裂 $\\Delta \\omega^{2}(\\hat{\\mathbf{q}}) \\equiv \\omega_{\\mathrm{LO}}^{2}(\\hat{\\mathbf{q}}) - \\omega_{\\mathrm{TO}}^{2}$ 的闭合形式表达式，该表达式是传播方向 $\\hat{\\mathbf{q}}$ 的函数。然后，利用所提供的数据，计算比值\n$$\nR \\equiv \\frac{\\Delta \\omega^{2}(\\hat{\\mathbf{q}} = [100])}{\\Delta \\omega^{2}(\\hat{\\mathbf{q}} = [001])}.\n$$\n将您计算出的 $R$ 值四舍五入到四位有效数字。以无单位的纯数形式表示您的最终答案。",
            "solution": "### 步骤 1：提取已知条件\n题目为一种二元极性双原子晶体提供了以下信息：\n- 它在布里渊区中心（$\\mathbf{q} \\to 0$）有一个单一的红外活性光学模式。\n- 该极性光学模式的本征位移与声子传播方向 $\\hat{\\mathbf{q}}$ 共线。\n- 该系统在电动力学计算中使用高斯单位制。\n- Born 有效电荷张量是各向同性的：$Z^{*}_{A} = +Z^{*}\\,\\mathbf{I}$ 和 $Z^{*}_{B} = -Z^{*}\\,\\mathbf{I}$，其无量纲数值为 $Z^{*} = 2.10$。\n- 高频介电张量为 $\\boldsymbol{\\epsilon}^{\\infty} = \\mathrm{diag}(5.50,\\,5.50,\\,3.30)$。\n- 子晶格质量为 $M_{A} = 23.0$ amu 和 $M_{B} = 35.45$ amu。\n- 原胞体积为 $\\Omega = 90.0 \\, \\text{\\AA}^{3}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，描述了极性晶体中一个公认的现象——纵向光学-横向光学 (LO–TO) 劈裂。这种劈裂源于区中心动力学矩阵的非解析行为，这是晶格动力学中的一个核心概念，并能被密度泛函微扰理论 (DFPT) 精确地建模。所提供的定义和数据与标准的固态物理理论相符。介电常数、质量和 Born 有效电荷的值对于真实材料（例如，II-VI族或III-V族半导体）而言，在物理上是合理的。该问题是自洽的、提法得当且客观的。它要求进行标准的推导，然后进行计算，根据所提供的数据，该问题有唯一的解。在最终比值的计算中包含多余的数据（$M_A$、$M_B$、$\\Omega$、$Z^*$）是检验概念性理解的常用方法，以确保解题者能够识别出相关的物理量。该问题不违反任何无效标准。\n\n### 步骤 3：结论与行动\n该问题有效。将提供一个完整的、有理有据的解答。\n\n### LO-TO 劈裂的推导\nLO-TO 劈裂是在极性材料中伴随纵向光学声子而产生的宏观电场的结果。我们可以通过考虑两个子晶格相对位移的运动方程来推导该劈裂的表达式。\n\n设 $\\mathbf{w} = \\mathbf{u}_A - \\mathbf{u}_B$ 为两个子晶格 A 和 B 之间的相对位移矢量。这个相对坐标的运动方程，可将其视为一个折合质量为 $\\mu = \\frac{M_A M_B}{M_A + M_B}$ 的谐振子，可以写为：\n$$\n\\mu \\frac{d^2\\mathbf{w}}{dt^2} = \\mathbf{F}_{\\text{SR}} + \\mathbf{F}_{\\text{LR}}\n$$\n其中 $\\mathbf{F}_{\\text{SR}}$ 是短程回复力，$\\mathbf{F}_{\\text{LR}}$ 是由宏观电场引起的长程力。\n\n短程力定义了横向光学 (TO) 频率 $\\omega_{\\text{TO}}$，因为对于横波（宏观场为零），这是唯一存在的作用力。我们可以将其写为 $\\mathbf{F}_{\\text{SR}} = -\\mu \\omega_{\\text{TO}}^2 \\mathbf{w}$。\n\n长程力源于离子与宏观电场 $\\mathbf{E}$ 的相互作用。作用在离子 $\\kappa$ 上的力由 $q_{\\kappa} \\mathbf{E}$ 给出，其中 $q_{\\kappa}$ 是其有效电荷。对于相对运动，有效力由一个有效电荷 $Z^{*}_{\\text{mode}}$ 驱动。对于给定的具有各向同性电荷 $Z_A^*=Z^*e\\,\\mathbf{I}$ 和 $Z_B^*=-Z^*e\\,\\mathbf{I}$ 的双原子晶体，作用在相对坐标上的力是 $Z^*e\\mathbf{E}$。因此，$\\mathbf{F}_{\\text{LR}} = Z^* e \\mathbf{E}$。我们记模式电荷为 $Q^* = Z^*e$。\n运动方程为：\n$$\n\\mu \\frac{d^2\\mathbf{w}}{dt^2} = -\\mu\\omega_{\\text{TO}}^2 \\mathbf{w} + Q^* \\mathbf{E}\n$$\n由晶格位移引起的宏观极化强度 $\\mathbf{P}$ 由单位体积内的总偶极矩给出。对于相对位移 $\\mathbf{w}$，其表达式为：\n$$\n\\mathbf{P} = \\frac{Q^*}{\\Omega} \\mathbf{w}\n$$\n其中 $\\Omega$ 是原胞体积。\n\n对于沿方向 $\\hat{\\mathbf{q}}$ 传播的纵向模式，位移 $\\mathbf{w}$、极化强度 $\\mathbf{P}$ 和电场 $\\mathbf{E}$ 都与 $\\hat{\\mathbf{q}}$ 平行。在没有自由电荷的区域，电位移场 $\\mathbf{D}$ 的散度为零：$\\nabla \\cdot \\mathbf{D} = 0$。在傅里叶空间中，此条件变为 $\\mathbf{q} \\cdot \\mathbf{D}(\\mathbf{q}) = 0$。本构关系为 $\\mathbf{D} = \\boldsymbol{\\epsilon}^{\\infty} \\mathbf{E} + 4\\pi\\mathbf{P}$，其中 $\\boldsymbol{\\epsilon}^{\\infty}$ 是高频介电张量。\n对于纵波，这给出：\n$$\n\\hat{\\mathbf{q}} \\cdot (\\boldsymbol{\\epsilon}^{\\infty} \\mathbf{E} + 4\\pi\\mathbf{P}) = 0\n$$\n由于 $\\mathbf{E} = E\\hat{\\mathbf{q}}$ 和 $\\mathbf{P} = P\\hat{\\mathbf{q}}$，我们可以写出：\n$$\n(\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\hat{\\mathbf{q}}) E + 4\\pi P = 0\n$$\n这给出了用极化强度表示的宏观电场：\n$$\n\\mathbf{E} = E\\hat{\\mathbf{q}} = -\\frac{4\\pi P}{\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\hat{\\mathbf{q}}} \\hat{\\mathbf{q}} = -\\frac{4\\pi \\mathbf{P}}{\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}}\n$$\n现在，我们将用 $\\mathbf{w}$ 表示的 $\\mathbf{P}$ 的表达式代入：\n$$\n\\mathbf{E} = -\\frac{4\\pi}{\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}} \\left(\\frac{Q^*}{\\Omega}\\mathbf{w}\\right)\n$$\n将该电场代回运动方程：\n$$\n\\mu \\frac{d^2\\mathbf{w}}{dt^2} = -\\mu\\omega_{\\text{TO}}^2 \\mathbf{w} - Q^* \\left(\\frac{4\\pi Q^*}{\\Omega(\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}})}\\mathbf{w}\\right)\n$$\n对于以纵向光学频率 $\\omega_{\\text{LO}}$ 进行的谐振动，我们有 $\\frac{d^2\\mathbf{w}}{dt^2} = -\\omega_{\\text{LO}}^2 \\mathbf{w}$。\n$$\n-\\mu\\omega_{\\text{LO}}^2 \\mathbf{w} = -\\mu\\omega_{\\text{TO}}^2 \\mathbf{w} - \\frac{4\\pi (Q^*)^2}{\\Omega(\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}})} \\mathbf{w}\n$$\n两边同除以 $-\\mathbf{w}$ 并重新整理，我们得到：\n$$\n\\mu\\omega_{\\text{LO}}^2(\\hat{\\mathbf{q}}) = \\mu\\omega_{\\text{TO}}^2 + \\frac{4\\pi (Q^*)^2}{\\Omega(\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}})}\n$$\n因此，LO-TO 劈裂 $\\Delta \\omega^{2}(\\hat{\\mathbf{q}}) \\equiv \\omega_{\\mathrm{LO}}^{2}(\\hat{\\mathbf{q}}) - \\omega_{\\mathrm{TO}}^{2}$ 由以下闭合形式表达式给出：\n$$\n\\Delta \\omega^{2}(\\hat{\\mathbf{q}}) = \\frac{4\\pi (Z^*e)^2}{\\mu\\Omega(\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}})}\n$$\n\n### 比值的计算\n我们被要求计算比值 $R \\equiv \\frac{\\Delta \\omega^{2}(\\hat{\\mathbf{q}} = [100])}{\\Delta \\omega^{2}(\\hat{\\mathbf{q}} = [001])}$。\n设 $\\hat{\\mathbf{q}}_1 = [100]$ 为单位矢量 $(1, 0, 0)$，$\\hat{\\mathbf{q}}_2 = [001]$ 为单位矢量 $(0, 0, 1)$。\n使用推导出的 $\\Delta \\omega^2(\\hat{\\mathbf{q}})$ 表达式：\n$$\nR = \\frac{\\Delta \\omega^{2}(\\hat{\\mathbf{q}}_1)}{\\Delta \\omega^{2}(\\hat{\\mathbf{q}}_2)} = \\frac{\\frac{4\\pi (Z^*e)^2}{\\mu\\Omega(\\hat{\\mathbf{q}}_1 \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}_1)}}{\\frac{4\\pi (Z^*e)^2}{\\mu\\Omega(\\hat{\\mathbf{q}}_2 \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}_2)}}\n$$\n恒定前因子 $\\frac{4\\pi (Z^*e)^2}{\\mu\\Omega}$ 被消掉了。这意味着此计算不需要 $Z^*$、$M_A$、$M_B$ 和 $\\Omega$ 的值。该比值简化为：\n$$\nR = \\frac{\\hat{\\mathbf{q}}_2 \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}_2}{\\hat{\\mathbf{q}}_1 \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}_1}\n$$\n高频介电张量为 $\\boldsymbol{\\epsilon}^{\\infty} = \\mathrm{diag}(5.50,\\,5.50,\\,3.30)$。\n我们计算分子和分母中的项。\n对于分母，当 $\\hat{\\mathbf{q}}_1 = (1, 0, 0)$ 时：\n$$\n\\hat{\\mathbf{q}}_1 \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}_1 = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 5.50  0  0 \\\\ 0  5.50  0 \\\\ 0  0  3.30 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\epsilon^{\\infty}_{xx} = 5.50\n$$\n对于分子，当 $\\hat{\\mathbf{q}}_2 = (0, 0, 1)$ 时：\n$$\n\\hat{\\mathbf{q}}_2 \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}_2 = \\begin{pmatrix} 0  0  1 \\end{pmatrix} \\begin{pmatrix} 5.50  0  0 \\\\ 0  5.50  0 \\\\ 0  0  3.30 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\epsilon^{\\infty}_{zz} = 3.30\n$$\n将这些值代入 R 的表达式中：\n$$\nR = \\frac{3.30}{5.50} = \\frac{33}{55} = \\frac{3}{5} = 0.6\n$$\n题目要求答案四舍五入到四位有效数字。\n$$\nR = 0.6000\n$$",
            "answer": "$$\\boxed{0.6000}$$"
        },
        {
            "introduction": "声学声子求和规则（Acoustic Sum Rule, ASR）是反映晶体平移不变性的基本物理约束。在实际的 DFPT 计算中，数值误差可能导致 ASR 被违反，从而产生非物理的结果，例如在布里渊区中心 ($\\Gamma$ 点) 出现声学声子能隙。本动手编程练习模拟了这一效应，并演示了强制执行 ASR 对于获得正确的声速等物理量至关重要。",
            "id": "3800613",
            "problem": "要求您构建并分析一个一维单原子模型，该模型在密度泛函微扰理论 (DFPT) 的框架内，捕捉了施加声学求和规则 (ASR) 如何影响共价晶体中的低频声子色散。请完全按照第一性原理进行如下操作。\n\n从谐振晶格动力学由动力学矩阵 $D(\\mathbf{q})$ 控制的定义出发，该矩阵由 Born-Oppenheimer 能量的二阶导数（原子间力常数）得到。在一维情况下，对于质量为 $m$、晶格常数为 $a$ 的单原子基矢，以及截至次近邻的标量原子间力常数，通过弹簧常数 $k_1$（最近邻）和 $k_2$（次近邻）来模拟一个共价晶体，并通过一个小参数 $\\delta$ 在格点自身项上引入一个可控的 ASR 违背。一维中的物理原子间力常数为\n- $\\Phi(0,0) = 2 k_1 + 2 k_2 + \\delta$,\n- $\\Phi(0,\\pm a) = -k_1$,\n- $\\Phi(0,\\pm 2a) = -k_2$,\n其他情况为零。ASR 等价于平移不变性，这要求力常数矩阵的每一行（或列）之和为零。在此模型中施加 ASR 意味着通过 $\\Phi(0,0) \\leftarrow -\\sum_{R \\neq 0} \\Phi(0,R)$ 重新定义格点自身项，从而消除了 $\\delta$。\n\n对于一维布里渊区中的波矢 $q$，倒易空间中的标量动力学矩阵是通过对实空间力常数进行离散傅里叶变换得到的。声学角频率 $\\omega(q)$ 是 $D(q)$ 单个特征值的平方根，其中 $q$ 的单位是弧度/米，$\\omega$ 的单位是弧度/秒。声速是低 $q$ 时的斜率 $v = \\left.\\frac{d \\omega}{d q}\\right|_{q \\to 0}$。\n\n程序要求：\n- 实现一个函数，该函数在给定 $(a, m, k_1, k_2, \\delta)$ 的情况下，根据上述原子间力常数，构建不施加 ASR 和施加 ASR 时的一维标量动力学矩阵 $D(q)$，并返回在 $q=0$ 附近的小波矢网格上相应的声学色散 $\\omega_{\\text{noASR}}(q)$ 和 $\\omega_{\\text{ASR}}(q)$。\n- 使用一个包含 $N_q$ 个点的波矢网格，其中 $N_q = 16$，在 $q_{\\min}$到 $q_{\\max}$ 之间均匀分布，其中 $q_{\\min} = \\frac{q_{\\max}}{N_q}$ 且 $q_{\\max} = 0.05 \\times \\frac{\\pi}{a}$。拟合中不要包含 $q=0$。角度量使用弧度。\n- 通过在此网格上对 $\\omega(q)$ 与 $|q|$ 进行普通最小二乘线性拟合，拟合 $\\omega(q) \\approx c + v |q|$，来提取声速 $v_{\\text{noASR}}$ 和 $v_{\\text{ASR}}$，并将拟合的斜率作为速度。\n- 物理单位与转换。输入参数使用以下单位：\n  - `a` 的单位是埃 ($\\mathrm{\\AA}$)，\n  - `m` 的单位是原子质量单位 (amu)，\n  - `k_1`、`k_2` 和 `\\delta` 的单位是电子伏特每平方埃 ($\\mathrm{eV}/\\mathrm{\\AA}^2$)。\n  使用以下公式转换为国际单位制 (SI)：\n  - $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$,\n  - $1\\,\\mathrm{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$,\n  - $1\\,\\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$.\n  单位为 $\\mathrm{eV}/\\mathrm{\\AA}^2$ 的力常数必须转换为 $\\mathrm{N}/\\mathrm{m}$，最终的速度必须以米每秒 ($\\mathrm{m}/\\mathrm{s}$) 表示。\n- 通过报告每个测试案例的三元组 $[v_{\\text{noASR}}, v_{\\text{ASR}}, \\Delta]$ 来量化施加 ASR 的影响，其中 $\\Delta = \\frac{v_{\\text{ASR}} - v_{\\text{noASR}}}{v_{\\text{ASR}}}$ 是一个无量纲的小数。\n\n测试套件：\n为以下四个测试案例提供结果，每个案例由 $(a, m, k_1, k_2, \\delta)$ 定义：\n- 案例 A（共价链，中等次近邻耦合，小的 ASR 违背）：$a = 2.5\\,\\mathrm{\\AA}$， $m = 12.0\\,\\mathrm{amu}$， $k_1 = 20.0\\,\\mathrm{eV}/\\mathrm{\\AA}^2$，$k_2 = 5.0\\,\\mathrm{eV}/\\mathrm{\\AA}^2$，$\\delta = 0.2\\,\\mathrm{eV}/\\mathrm{\\AA}^2$。\n- 案例 B（相同晶体，ASR 已满足）：$a = 2.5\\,\\mathrm{\\AA}$， $m = 12.0\\,\\mathrm{amu}$，$k_1 = 20.0\\,\\mathrm{eV}/\\mathrm{\\AA}^2$，$k_2 = 5.0\\,\\mathrm{eV}/\\mathrm{\\AA}^2$，$\\delta = 0.0\\,\\mathrm{eV}/\\mathrm{\\AA}^2$。\n- 案例 C（相同晶体，较大的 ASR 违背）：$a = 2.5\\,\\mathrm{\\AA}$， $m = 12.0\\,\\mathrm{amu}$，$k_1 = 20.0\\,\\mathrm{eV}/\\mathrm{\\AA}^2$，$k_2 = 5.0\\,\\mathrm{eV}/\\mathrm{\\AA}^2$，$\\delta = 2.0\\,\\mathrm{eV}/\\mathrm{\\AA}^2$。\n- 案例 D（类硅参数，具有较弱、略微不稳定的次近邻，中等 ASR 违背）：$a = 5.43\\,\\mathrm{\\AA}$，$m = 28.0855\\,\\mathrm{amu}$，$k_1 = 15.0\\,\\mathrm{eV}/\\mathrm{\\AA}^2$，$k_2 = -2.0\\,\\mathrm{eV}/\\mathrm{\\AA}^2$，$\\delta = 0.5\\,\\mathrm{eV}/\\mathrm{\\AA}^2$。\n\n您的程序必须生成单行输出，其中包含四个案例的结果，格式为逗号分隔的列表的列表，每个内部列表按 $[v_{\\text{noASR}}, v_{\\text{ASR}}, \\Delta]$ 排序，所有速度单位为 $\\mathrm{m}/\\mathrm{s}$，$\\Delta$ 为无量纲，例如以下形式\n$[[v^{(A)}_{\\text{noASR}}, v^{(A)}_{\\text{ASR}}, \\Delta^{(A)}],[v^{(B)}_{\\text{noASR}}, v^{(B)}_{\\text{ASR}}, \\Delta^{(B)}],[v^{(C)}_{\\text{noASR}}, v^{(C)}_{\\text{ASR}}, \\Delta^{(C)}],[v^{(D)}_{\\text{noASR}}, v^{(D)}_{\\text{ASR}}, \\Delta^{(D)}]]$。",
            "solution": "用户提供的问题是有效且定义明确的。它涉及计算材料科学中的一个基本概念：声学求和规则 (ASR) 的施加及其对在密度泛函微扰理论 (DFPT) 框架内计算的声子色散关系的影响。该问题在科学上基于固态物理学的原理，特别是晶格动力学的谐振理论。\n\n该解答从第一性原理出发，从给定的一维单原子链的原子间力常数 (IFC) 开始。控制晶格振动的动力学矩阵 $D(q)$ 是通过对这些 IFC 进行傅里叶变换得出的。然后，声子频率 $\\omega(q)$ 从该矩阵的特征值获得。声速是从色散曲线 $\\omega(q)$ 的声学支在长波极限 ($q \\to 0$) 下的斜率提取的。\n\n首先，我们确定必要的物理常数和单位转换。输入参数以混合单位（$\\mathrm{\\AA}$、amu、$\\mathrm{eV}/\\mathrm{\\AA}^2$）给出，必须将其转换为国际单位制 (SI) 以进行一致的计算。所需的转换因子为：\n- $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$\n- $1\\,\\mathrm{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$\n- $1\\,\\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$\n由此，可以推导出对力常数的转换：\n$1\\,\\mathrm{eV}/\\mathrm{\\AA}^2 = \\frac{1.602176634 \\times 10^{-19}\\,\\mathrm{J}}{(1.0 \\times 10^{-10}\\,\\mathrm{m})^2} = 16.02176634\\,\\mathrm{J}/\\mathrm{m}^2 = 16.02176634\\,\\mathrm{N}/\\mathrm{m}$。\n\n一维单原子晶格的动力学“矩阵”是一个标量 $D(q)$，由实空间 IFC $\\Phi(0, R)$ 对晶格位置 $R$ 的傅里叶求和给出：\n$$D(q) = \\frac{1}{m} \\sum_{R} \\Phi(0,R) e^{-iqR}$$\n在我们的模型中，相互作用延伸至次近邻，因此 $R$ 取值为 $0, \\pm a, \\pm 2a$。由于晶体具有反演对称性，IFC 是对称的，即 $\\Phi(0, R) = \\Phi(0, -R)$。可以使用欧拉恒等式 $e^{ix} + e^{-ix} = 2\\cos(x)$ 来简化求和：\n$$D(q) = \\frac{1}{m} \\left[ \\Phi(0,0) + 2\\Phi(0,a)\\cos(qa) + 2\\Phi(0,2a)\\cos(2qa) \\right]$$\n代入给定的 IFC，$\\Phi(0,a) = -k_1$ 和 $\\Phi(0,2a) = -k_2$：\n$$D(q) = \\frac{1}{m} \\left[ \\Phi(0,0) - 2k_1\\cos(qa) - 2k_2\\cos(2qa) \\right]$$\n\n对于格点自身力常数 $\\Phi(0,0)$，考虑两种情况：\n1.  **不施加 ASR ($\\omega_{\\text{noASR}}$):** 按给定方式使用 IFC，包含数值违背项 $\\delta$。\n    $$\\Phi_{\\text{noASR}}(0,0) = 2k_1 + 2k_2 + \\delta$$\n    动力学矩阵为：\n    $$D_{\\text{noASR}}(q) = \\frac{1}{m} \\left[ (2k_1 + 2k_2 + \\delta) - 2k_1\\cos(qa) - 2k_2\\cos(2qa) \\right]$$\n    $$D_{\\text{noASR}}(q) = \\frac{1}{m} \\left[ 2k_1(1-\\cos(qa)) + 2k_2(1-\\cos(2qa)) + \\delta \\right]$$\n2.  **施加 ASR ($\\omega_{\\text{ASR}}$):** ASR 要求如果所有原子发生相同的位移，作用在单个原子上的力之和为零。这意味着 $\\sum_R \\Phi(0,R) = 0$。调整格点自身项以强制满足此条件：\n    $$\\Phi_{\\text{ASR}}(0,0) = -\\sum_{R \\neq 0} \\Phi(0,R) = -(\\Phi(0,a) + \\Phi(0,-a) + \\Phi(0,2a) + \\Phi(0,-2a))$$\n    $$\\Phi_{\\text{ASR}}(0,0) = -(-k_1 - k_1 - k_2 - k_2) = 2k_1 + 2k_2$$\n    相应的动力学矩阵为：\n    $$D_{\\text{ASR}}(q) = \\frac{1}{m} \\left[ 2k_1(1-\\cos(qa)) + 2k_2(1-\\cos(2qa)) \\right]$$\n\n角频率是动力学矩阵特征值的平方根，即 $\\omega(q) = \\sqrt{D(q)}$。$D_{\\text{noASR}}(q)$ 中的非零 $\\delta$ 项导致在 $q=0$ 处频率不为零，$\\omega_{\\text{noASR}}(0) = \\sqrt{\\delta/m}$，这是一个被称为“声学带隙”的物理假象。相比之下，$D_{\\text{ASR}}(0)=0$，因此 $\\omega_{\\text{ASR}}(0)=0$，这符合声学声子模式的要求。\n\n为了计算声速，我们遵循指定的数值程序。在 $[q_{\\min}, q_{\\max}]$ 范围内生成一个包含 $N_q=16$ 个波矢的网格，其中 $q_{\\max} = 0.05 \\frac{\\pi}{a}$ 且 $q_{\\min} = q_{\\max}/N_q$。对于每种情况（施加和不施加 ASR），计算网格上每个 $q_i$ 的频率 $\\omega(q_i)$。然后，对数据点 $(q_i, \\omega(q_i))$ 进行模型 $\\omega(q) \\approx c + v|q|$ 的普通最小二乘线性拟合。拟合的斜率 $v$ 即为声速。对 $\\omega_{\\text{noASR}}(q)$ 和 $\\omega_{\\text{ASR}}(q)$ 都实施此程序，以获得 $v_{\\text{noASR}}$ 和 $v_{\\text{ASR}}$。\n\n最后，通过 $\\Delta = (v_{\\text{ASR}} - v_{\\text{noASR}}) / v_{\\text{ASR}}$ 来量化施加 ASR 的相对影响。每个测试案例的最终输出是三元组 $[v_{\\text{noASR}}, v_{\\text{ASR}}, \\Delta]$。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_velocities(case):\n    \"\"\"\n    Calculates sound velocities for a 1D monoatomic chain with and without ASR.\n\n    Args:\n        case (tuple): A tuple containing (a, m, k1, k2, delta) with units\n                      Å, amu, eV/Å^2, eV/Å^2, and eV/Å^2 respectively.\n\n    Returns:\n        list: A list containing [v_noASR, v_ASR, Delta] in m/s and dimensionless.\n    \"\"\"\n    # Unpack test case parameters\n    a_in, m_in, k1_in, k2_in, delta_in = case\n\n    # Physical constants for unit conversion\n    EV_to_J = 1.602176634e-19\n    ANGSTROM_to_M = 1.0e-10\n    AMU_to_KG = 1.66053906660e-27\n    EV_per_A2_to_N_per_M = EV_to_J / (ANGSTROM_to_M**2)\n\n    # Convert inputs to SI units\n    a_si = a_in * ANGSTROM_to_M\n    m_si = m_in * AMU_to_KG\n    k1_si = k1_in * EV_per_A2_to_N_per_M\n    k2_si = k2_in * EV_per_A2_to_N_per_M\n    delta_si = delta_in * EV_per_A2_to_N_per_M\n\n    # Set up the wavevector grid\n    Nq = 16\n    q_max = 0.05 * np.pi / a_si\n    q_min = q_max / Nq\n    q_grid = np.linspace(q_min, q_max, Nq)\n\n    # Define dispersion relation functions\n    def omega(q_values, k1, k2, m, a, delta):\n        cos_qa = np.cos(q_values * a)\n        cos_2qa = np.cos(2 * q_values * a)\n        # Note: All arguments to this function must be in SI units\n        # D(q) = (1/m) * [2*k1*(1-cos(qa)) + 2*k2*(1-cos(2qa)) + delta]\n        dynamical_matrix = (2 * k1 * (1 - cos_qa) + 2 * k2 * (1 - cos_2qa) + delta) / m\n        # Ensure argument to sqrt is non-negative\n        dynamical_matrix[dynamical_matrix  0] = 0\n        return np.sqrt(dynamical_matrix)\n\n    # Calculate frequencies for both cases\n    omega_noASR_values = omega(q_grid, k1_si, k2_si, m_si, a_si, delta_si)\n    omega_ASR_values = omega(q_grid, k1_si, k2_si, m_si, a_si, 0.0)\n\n    # Perform ordinary least-squares linear fit: omega = v*q + c\n    # The slope 'v' is the sound velocity.\n    v_noASR, _ = np.polyfit(q_grid, omega_noASR_values, 1)\n    v_ASR, _ = np.polyfit(q_grid, omega_ASR_values, 1)\n    \n    # Handle the case where v_ASR is zero to avoid division by zero\n    if v_ASR == 0:\n        delta_v = np.nan if v_noASR != 0 else 0.0\n    else:\n        delta_v = (v_ASR - v_noASR) / v_ASR\n\n    return [v_noASR, v_ASR, delta_v]\n\ndef solve():\n    \"\"\"\n    Main solver function that processes all test cases and prints the result.\n    \"\"\"\n    # Test suite as defined in the problem statement\n    # (a [Å], m [amu], k1 [eV/Å^2], k2 [eV/Å^2], delta [eV/Å^2])\n    test_cases = [\n        (2.5, 12.0, 20.0, 5.0, 0.2),    # Case A\n        (2.5, 12.0, 20.0, 5.0, 0.0),    # Case B\n        (2.5, 12.0, 20.0, 5.0, 2.0),    # Case C\n        (5.43, 28.0855, 15.0, -2.0, 0.5) # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_velocities(case)\n        results.append(result)\n\n    # Format the output as a string representation of a list of lists.\n    # e.g., \"[[r1, r2, r3],[s1, s2, s3]]\"\n    result_str = \"[\" + \",\".join(str(res) for res in results) + \"]\"\n    \n    # Print the final result in the exact single-line format required.\n    # The string representation of list in Python includes spaces, so we remove them\n    # to match the example format if it were compact.\n    # However, common pretty-printing includes spaces, so sticking to default str() is safer.\n    print(result_str.replace(\" \", \"\"))\n\nsolve()\n\n```"
        }
    ]
}