{
    "hands_on_practices": [
        {
            "introduction": "从头算方法是预测材料弹性性质的强大工具，但直接计算完整的弹性张量可能计算成本高昂。通过巧妙地利用晶体对称性，我们可以设计一套最小化的应变方案，从而高效地确定所有独立的弹性常数。这项练习旨在训练您像计算科学家一样思考，通过构建对称性匹配的应变路径，为不同晶系的材料设计最优的计算实验。",
            "id": "3794393",
            "problem": "您的任务是为三种晶系设计最小的对称性匹配均匀应变方案，这些方案在小应变、零温极限下使用，并应用于弹性常数的第一性原理计算。请在以下范围内进行研究：从密度泛函理论（DFT）获得的总能量与无应变参考态的能量差，可以很好地用应变的二次型来描述。在 Voigt 标记法中，将应变矢量表示为 $\\boldsymbol{\\epsilon} = (\\epsilon_{1}, \\epsilon_{2}, \\epsilon_{3}, \\epsilon_{4}, \\epsilon_{5}, \\epsilon_{6})$，其中 $(\\epsilon_{1}, \\epsilon_{2}, \\epsilon_{3})$ 为正应变，$(\\epsilon_{4}, \\epsilon_{5}, \\epsilon_{6})$ 为工程剪切应变。相对于基态的弹性应变能密度为\n$$\n\\Delta E/V = \\frac{1}{2}\\,\\sum_{i=1}^{6}\\sum_{j=1}^{6} C_{ij}\\,\\epsilon_{i}\\,\\epsilon_{j},\n$$\n其中 $C_{ij}$ 是晶轴坐标系中弹性刚度张量的分量。\n\n从这个二次能量定律出发，仅使用对称性约束以及应变和能量之间的映射关系，为以下每个晶系构建一个最小的对称性匹配均匀应变矢量集 $\\{\\boldsymbol{\\epsilon}^{(k)}\\}$。对于每个 $\\boldsymbol{\\epsilon}^{(k)}$，通过将 $\\Delta E(\\boldsymbol{\\epsilon}^{(k)})$ 拟合为单一标量应变幅度的函数，就足以确定该晶系的所有独立弹性常数，而不会出现病态问题，也无需进行混合多参数拟合：\n\n- 立方晶系。\n- 六方晶系。\n- 正交晶系。\n\n您的构建必须在科学上是合理的：每个所选的应变必须与晶体对称性兼容（例如，与主对称轴或对称性相关的剪切对齐），并且必须能够导出一个单一的刚度分量或一个线性无关的组合，从而可以解出完整的独立常数集。请用 Voigt 分量明确说明所提出的应变矢量，并证明所得的集合是最小且可逆的，可以通过二阶能量拟合来提取独立的弹性常数。\n\n最后，在上述约束条件下，计算这三个晶系合计所需的不同应变状态的最小总数。将此总数作为最终答案。无需四舍五入。最终答案是一个没有单位的纯数。",
            "solution": "该问题要求构建最小的对称性匹配均匀应变矢量集，以便通过第一性原理能量计算来确定立方、六方和正交晶系的全套独立弹性常数。此任务的基础是在小应变极限下的弹性应变能密度关系，用 Voigt 标记法表示为：\n$$\n\\frac{\\Delta E}{V} = \\frac{1}{2} \\sum_{i=1}^{6} \\sum_{j=1}^{6} C_{ij} \\epsilon_{i} \\epsilon_{j}\n$$\n其中 $V$ 是参考晶胞的体积，$\\Delta E$ 是总能量的变化，$\\boldsymbol{\\epsilon} = (\\epsilon_{1}, \\epsilon_{2}, \\epsilon_{3}, \\epsilon_{4}, \\epsilon_{5}, \\epsilon_{6})$ 是应变矢量，$C_{ij}$ 是刚度张量的元素。应变 $\\epsilon_1, \\epsilon_2, \\epsilon_3$ 是正应变，$\\epsilon_4, \\epsilon_5, \\epsilon_6$ 是工程剪切应变。\n\n对于由单一标量参数 $\\delta$ 定义的特定应变方案，使得 $\\boldsymbol{\\epsilon}^{(k)} = \\delta \\cdot \\mathbf{v}^{(k)}$，其中 $\\mathbf{v}^{(k)}$ 是一个常数矢量，能量密度变为：\n$$\n\\frac{\\Delta E(\\delta)}{V} = \\frac{1}{2} \\delta^2 \\left( \\sum_{i=1}^{6} \\sum_{j=1}^{6} C_{ij} v_{i}^{(k)} v_{j}^{(k)} \\right)\n$$\n总能量对应变参数 $\\delta$ 的二阶导数，在 $\\delta=0$ 处求值，提供了弹性常数的一个线性组合：\n$$\n\\frac{1}{V} \\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} \\bigg|_{\\delta=0} = \\sum_{i=1}^{6} \\sum_{j=1}^{6} C_{ij} v_{i}^{(k)} v_{j}^{(k)}\n$$\n通过设计一组 $N$ 个线性无关的应变矢量 $\\{\\mathbf{v}^{(k)}\\}$，我们可以生成一个包含 $N$ 个线性方程的方程组。如果 $N$ 等于给定晶系的独立弹性常数数量，并且所得的方程组是可逆的，那么这组应变就是最小且充分的。\n\n我们现在为每个指定的晶系构建这样的最小集。\n\n### 1. 立方晶系\n\n立方对称性对弹性张量施加了显著的约束。其刚度矩阵只有 3 个独立分量：$C_{11}$、$C_{12}$ 和 $C_{44}$。矩阵形式为：\n$$\n\\mathbf{C}_{\\text{cubic}} = \\begin{pmatrix}\nC_{11}  C_{12}  C_{12}  0  0  0 \\\\\nC_{12}  C_{11}  C_{12}  0  0  0 \\\\\nC_{12}  C_{12}  C_{11}  0  0  0 \\\\\n0  0  0  C_{44}  0  0 \\\\\n0  0  0  0  C_{44}  0 \\\\\n0  0  0  0  0  C_{44}\n\\end{pmatrix}\n$$\n为了确定这 3 个常数，我们需要一个最小的包含 3 种不同应变状态的集合，以产生 3 个线性无关的方程。\n\n1.  **应变 1：沿主轴的单轴应变。**\n    设 $\\boldsymbol{\\epsilon}^{(1)} = (\\delta, 0, 0, 0, 0, 0)$。\n    能量表达式为 $\\frac{\\Delta E}{V} = \\frac{1}{2} C_{11} \\delta^2$。\n    二阶导数得到：$\\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{11}$。该应变直接确定 $C_{11}$。\n\n2.  **应变 2：在主平面上的剪切应变。**\n    设 $\\boldsymbol{\\epsilon}^{(2)} = (0, 0, 0, \\delta, 0, 0)$。\n    能量表达式为 $\\frac{\\Delta E}{V} = \\frac{1}{2} C_{44} \\delta^2$。\n    二阶导数得到：$\\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{44}$。该应变直接确定 $C_{44}$。\n\n3.  **应变 3：静水应变。**\n    设 $\\boldsymbol{\\epsilon}^{(3)} = (\\delta, \\delta, \\delta, 0, 0, 0)$。\n    能量表达式为 $\\frac{\\Delta E}{V} = \\frac{1}{2} [C_{11}(\\delta^2+\\delta^2+\\delta^2) + 2C_{12}(\\delta\\cdot\\delta + \\delta\\cdot\\delta + \\delta\\cdot\\delta)] = \\frac{3}{2}(C_{11} + 2C_{12})\\delta^2$。\n    二阶导数得到：$\\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = 3(C_{11} + 2C_{12})$。由于 $C_{11}$ 已由应变 1 确定，该方程可求解出 $C_{12}$。\n\n这组 3 种应变是最小的，并允许确定所有独立的弹性常数。\n\n### 2. 六方晶系\n\n六方对称性导致有 5 个独立的弹性常数：$C_{11}$、$C_{12}$、$C_{13}$、$C_{33}$ 和 $C_{44}$。此外，面内剪切常数 $C_{66}$ 与正应变常数相关，关系为 $C_{66} = \\frac{1}{2}(C_{11}-C_{12})$。刚度矩阵为：\n$$\n\\mathbf{C}_{\\text{hexagonal}} = \\begin{pmatrix}\nC_{11}  C_{12}  C_{13}  0  0  0 \\\\\nC_{12}  C_{11}  C_{13}  0  0  0 \\\\\nC_{13}  C_{13}  C_{33}  0  0  0 \\\\\n0  0  0  C_{44}  0  0 \\\\\n0  0  0  0  C_{44}  0 \\\\\n0  0  0  0  0  \\frac{1}{2}(C_{11}-C_{12})\n\\end{pmatrix}\n$$\n需要一个最小的包含 5 种应变的集合。\n\n1.  **应变 1：沿 [100] 方向（基面内）的单轴应变。**\n    设 $\\boldsymbol{\\epsilon}^{(1)} = (\\delta, 0, 0, 0, 0, 0)$。\n    能量：$\\frac{\\Delta E}{V} = \\frac{1}{2} C_{11} \\delta^2$。这确定了 $C_{11}$。\n\n2.  **应变 2：沿 [001] 方向（c 轴）的单轴应变。**\n    设 $\\boldsymbol{\\epsilon}^{(2)} = (0, 0, \\delta, 0, 0, 0)$。\n    能量：$\\frac{\\Delta E}{V} = \\frac{1}{2} C_{33} \\delta^2$。这确定了 $C_{33}$。\n\n3.  **应变 3：在 (100) 平面上的剪切应变。**\n    设 $\\boldsymbol{\\epsilon}^{(3)} = (0, 0, 0, 0, \\delta, 0)$。\n    能量：$\\frac{\\Delta E}{V} = \\frac{1}{2} C_{55} \\delta^2 = \\frac{1}{2} C_{44} \\delta^2$。这确定了 $C_{44}$。\n\n4.  **应变 4：在 (001) 平面上的面内剪切应变。**\n    设 $\\boldsymbol{\\epsilon}^{(4)} = (0, 0, 0, 0, 0, \\delta)$。\n    能量：$\\frac{\\Delta E}{V} = \\frac{1}{2} C_{66} \\delta^2 = \\frac{1}{4}(C_{11} - C_{12}) \\delta^2$。\n    二阶导数给出关系式 $C_{66} = \\frac{1}{2}(C_{11} - C_{12})$。由于 $C_{11}$ 已由应变 1 确定，可以确定 $C_{12}$。\n\n5.  **应变 5：组合单轴应变。**\n    设 $\\boldsymbol{\\epsilon}^{(5)} = (\\delta, 0, \\delta, 0, 0, 0)$。\n    能量：$\\frac{\\Delta E}{V} = \\frac{1}{2}(C_{11}\\delta^2 + C_{33}\\delta^2 + 2C_{13}\\delta^2)$。\n    二阶导数给出 $C_{11} + C_{33} + 2C_{13}$。由于 $C_{11}$ 和 $C_{33}$ 已由应变 1 和 2 确定，该方程确定了 $C_{13}$。\n\n这组 5 种应变是最小的，并且足以确定所有 5 个独立常数。\n\n### 3. 正交晶系\n\n正交晶系具有三个正交的二重旋转轴，导致有 9 个独立的弹性常数：$C_{11}$、$C_{22}$、$C_{33}$、$C_{12}$、$C_{13}$、$C_{23}$、$C_{44}$、$C_{55}$ 和 $C_{66}$。刚度矩阵为：\n$$\n\\mathbf{C}_{\\text{orthorhombic}} = \\begin{pmatrix}\nC_{11}  C_{12}  C_{13}  0  0  0 \\\\\nC_{12}  C_{22}  C_{23}  0  0  0 \\\\\nC_{13}  C_{23}  C_{33}  0  0  0 \\\\\n0  0  0  C_{44}  0  0 \\\\\n0  0  0  0  C_{55}  0 \\\\\n0  0  0  0  0  C_{66}\n\\end{pmatrix}\n$$\n需要一个最小的包含 9 种应变的集合。我们可以通过系统地分离每个常数或一个简单的组合来构建这个集合。\n\n**用于对角项（$C_{11}, C_{22}, C_{33}, C_{44}, C_{55}, C_{66}$）的应变：**\n\n1.  $\\boldsymbol{\\epsilon}^{(1)} = (\\delta, 0, 0, 0, 0, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{11}$\n2.  $\\boldsymbol{\\epsilon}^{(2)} = (0, \\delta, 0, 0, 0, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{22}$\n3.  $\\boldsymbol{\\epsilon}^{(3)} = (0, 0, \\delta, 0, 0, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{33}$\n4.  $\\boldsymbol{\\epsilon}^{(4)} = (0, 0, 0, \\delta, 0, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{44}$\n5.  $\\boldsymbol{\\epsilon}^{(5)} = (0, 0, 0, 0, \\delta, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{55}$\n6.  $\\boldsymbol{\\epsilon}^{(6)} = (0, 0, 0, 0, 0, \\delta) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{66}$\n\n这 6 种简单的单轴和剪切应变直接确定了刚度矩阵的 6 个对角分量。\n\n**用于非对角正应变项（$C_{12}, C_{13}, C_{23}$）的应变：**\n\n7.  $\\boldsymbol{\\epsilon}^{(7)} = (\\delta, \\delta, 0, 0, 0, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{11} + C_{22} + 2C_{12}$。已知 $C_{11}$ 和 $C_{22}$，可求得 $C_{12}$。\n8.  $\\boldsymbol{\\epsilon}^{(8)} = (\\delta, 0, \\delta, 0, 0, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{11} + C_{33} + 2C_{13}$。已知 $C_{11}$ 和 $C_{33}$，可求得 $C_{13}$。\n9.  $\\boldsymbol{\\epsilon}^{(9)} = (0, \\delta, \\delta, 0, 0, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{22} + C_{33} + 2C_{23}$。已知 $C_{22}$ 和 $C_{33}$，可求得 $C_{23}$。\n\n这组 9 种应变是最小的，并提供了一条条件良好、系统化的路径来确定所有 9 个独立的弹性常数。\n\n### 应变状态总数\n\n问题要求计算这三个晶系合计所需的不同应变状态的最小总数。根据上述构建：\n- 立方晶系最少需要 3 种应变状态。\n- 六方晶系最少需要 5 种应变状态。\n- 正交晶系最少需要 9 种应变状态。\n\n不同应变状态的最小总数是这些单个计数的总和。\n总数 = $3 + 5 + 9 = 17$。\n这代表了每个晶系的独立弹性常数数量之和。",
            "answer": "$$\\boxed{17}$$"
        },
        {
            "introduction": "在计算出弹性张量后，一个至关重要的步骤是验证结果的准确性。这项练习展示了一种强有力的自洽性检验方法：将从完整弹性张量$C_{ij}$导出的体积模量与直接通过静水压缩（能量-体积曲线）计算出的体积模量进行比较。这种交叉验证对于建立对计算结果的信心至关重要，是严谨科学研究中不可或缺的一环。",
            "id": "3794414",
            "problem": "一种立方晶体材料在零温下通过两种独立的第一性原理密度泛函理论（DFT）计算方法进行了表征。第一种方法使用平衡体积 $V_0$ 附近每个原子的总能量作为每个原子体积的函数，即 $E(V)$。在 $V_0$ 附近，能量可以很好地用以下展开式描述\n$$\nE(V) = E_0 + \\frac{1}{2} a_2 (V - V_0)^{2} + \\frac{1}{6} a_3 (V - V_0)^{3},\n$$\n其中 $E_0$ 是一个常数，$V_0 = 15.5\\,\\text{\\AA}^3$，$a_2 = 0.070\\,\\text{eV}/\\text{\\AA}^{6}$，以及 $a_3 = -0.002\\,\\text{eV}/\\text{\\AA}^{9}$。第二种方法使用线性响应应力-应变DFT数据来确定该立方晶体的独立单晶弹性刚度，得到 $C_{11} = 240.0\\,\\text{GPa}$，$C_{12} = 140.0\\,\\text{GPa}$，以及 $C_{44} = 120.0\\,\\text{GPa}$。\n\n从压力和体积模量的热力学定义出发，并利用立方晶体在微小、均匀（静水）应变下的胡克定律的一般形式，推导从 $E(V)$ 和 $\\{C_{ij}\\}$ 计算各向同性体积模量所需的表达式。然后，使用所提供的数据，计算两个体积模量之间的相对差异，定义为\n$$\n\\Delta = \\frac{B_{\\text{energy}} - B_{\\text{tensor}}}{B_{\\text{tensor}}}.\n$$\n将 $\\Delta$ 报告为小数，并四舍五入到四位有效数字。在能量密度和压力单位之间进行转换时，使用已确立的转换关系 $1\\,\\text{eV}/\\text{\\AA}^{3} = 160.21766208\\,\\text{GPa}$。",
            "solution": "该问题要求计算和比较通过两种独立的第一性原理方法推导出的立方晶体的体积模量：一种基于能量-体积曲线，另一种基于弹性刚度张量。最终目标是计算这两个结果之间的相对差异。分析过程分为三个阶段：首先，从能量-体积数据推导和计算体积模量（$B_{\\text{energy}}$）；其次，从弹性常数推导和计算体积模量（$B_{\\text{tensor}}$）；第三，计算相对差异 $\\Delta$。\n\n**1. 从能量-体积曲线计算体积模量（$B_{\\text{energy}}$）**\n\n体积模量 $B$ 是衡量物质抵抗均匀压缩能力的物理量。在零温（$T=0$）下，它在热力学上根据压力 $P$ 和体积 $V$ 定义为：\n$$\nB = -V \\frac{dP}{dV}\n$$\n而压力 $P$ 又定义为总能量 $E$ 对体积 $V$ 的负导数：\n$$\nP = -\\frac{dE}{dV}\n$$\n问题提供了每个原子的能量 $E(V)$ 作为每个原子体积 $V$ 的函数。压力和体积模量的定义同样适用于这些基于每个原子的量。结合这两个定义，我们可以直接用能量-体积关系来表示体积模量：\n$$\nB = -V \\frac{d}{dV}\\left(-\\frac{dE}{dV}\\right) = V \\frac{d^2E}{dV^2}\n$$\n体积模量通常在平衡体积 $V_0$ 处进行评估，该体积对应于零压力状态。\n\n给定的能量-体积关系为：\n$$\nE(V) = E_0 + \\frac{1}{2} a_2 (V - V_0)^{2} + \\frac{1}{6} a_3 (V - V_0)^{3}\n$$\n我们首先计算 $E(V)$ 对 $V$ 的一阶和二阶导数：\n$$\n\\frac{dE}{dV} = a_2 (V - V_0) + \\frac{1}{2} a_3 (V - V_0)^{2}\n$$\n$$\n\\frac{d^2E}{dV^2} = a_2 + a_3 (V - V_0)\n$$\n为了求得平衡状态下的体积模量，我们在 $V = V_0$ 处计算二阶导数：\n$$\n\\left. \\frac{d^2E}{dV^2} \\right|_{V=V_0} = a_2 + a_3 (V_0 - V_0) = a_2\n$$\n将此结果代入平衡状态下体积模量的表达式中，我们得到 $B_{\\text{energy}}$ 的公式：\n$$\nB_{\\text{energy}} = V_0 \\left. \\frac{d^2E}{dV^2} \\right|_{V=V_0} = V_0 a_2\n$$\n使用所提供的数据，$V_0 = 15.5\\,\\text{\\AA}^3$ 和 $a_2 = 0.070\\,\\text{eV}/\\text{\\AA}^{6}$：\n$$\nB_{\\text{energy}} = (15.5\\,\\text{\\AA}^3) \\times (0.070\\,\\text{eV}/\\text{\\AA}^{6}) = 1.085\\,\\text{eV}/\\text{\\AA}^{3}\n$$\n为了以吉帕斯卡（GPa）为单位表示，我们使用给定的转换因子 $1\\,\\text{eV}/\\text{\\AA}^{3} = 160.21766208\\,\\text{GPa}$：\n$$\nB_{\\text{energy}} = 1.085 \\times 160.21766208\\,\\text{GPa} \\approx 173.83616336\\,\\text{GPa}\n$$\n\n**2. 从弹性刚度张量计算体积模量（$B_{\\text{tensor}}$）**\n\n对于立方晶体，应力张量 $\\sigma$ 和应变张量 $\\epsilon$ 之间的关系（在Voigt标记法中，下标从1到6）由胡克定律给出：\n$$\n\\begin{pmatrix} \\sigma_1 \\\\ \\sigma_2 \\\\ \\sigma_3 \\\\ \\sigma_4 \\\\ \\sigma_5 \\\\ \\sigma_6 \\end{pmatrix} = \\begin{pmatrix} C_{11}  C_{12}  C_{12}  0  0  0 \\\\ C_{12}  C_{11}  C_{12}  0  0  0 \\\\ C_{12}  C_{12}  C_{11}  0  0  0 \\\\ 0  0  0  C_{44}  0  0 \\\\ 0  0  0  0  C_{44}  0 \\\\ 0  0  0  0  0  C_{44} \\end{pmatrix} \\begin{pmatrix} \\epsilon_1 \\\\ \\epsilon_2 \\\\ \\epsilon_3 \\\\ \\epsilon_4 \\\\ \\epsilon_5 \\\\ \\epsilon_6 \\end{pmatrix}\n$$\n静水压力 $P$ 对应于一种应力状态，其中正应力相等且剪应力为零：$\\sigma_1 = \\sigma_2 = \\sigma_3 = -P$，且 $\\sigma_4 = \\sigma_5 = \\sigma_6 = 0$。由于立方对称性，这种应力状态会引起一种均匀的应变状态，其中正应变相等且剪应变为零：$\\epsilon_1 = \\epsilon_2 = \\epsilon_3 = \\epsilon$，且 $\\epsilon_4 = \\epsilon_5 = \\epsilon_6 = 0$。\n\n将这种应变状态代入胡克定律中任意一个正应力分量（例如 $\\sigma_1$）的表达式：\n$$\n\\sigma_1 = C_{11}\\epsilon_1 + C_{12}\\epsilon_2 + C_{12}\\epsilon_3 = C_{11}\\epsilon + C_{12}\\epsilon + C_{12}\\epsilon = (C_{11} + 2C_{12})\\epsilon\n$$\n由于 $\\sigma_1 = -P$，我们有：\n$$\n-P = (C_{11} + 2C_{12})\\epsilon\n$$\n体积模量通过压力随相对体积变化 $\\epsilon_V = \\Delta V / V_0$ 的变化来定义。对于小应变，体积应变是正应变之和：$\\epsilon_V = \\epsilon_1 + \\epsilon_2 + \\epsilon_3 = 3\\epsilon$。因此，我们可以写出：\n$$\nB = -\\frac{dP}{d\\epsilon_V} = -\\frac{dP}{d(3\\epsilon)} = -\\frac{1}{3}\\frac{dP}{d\\epsilon}\n$$\n从关系式 $-P = (C_{11} + 2C_{12})\\epsilon$，我们求导数 $\\frac{dP}{d\\epsilon}$：\n$$\n\\frac{dP}{d\\epsilon} = -(C_{11} + 2C_{12})\n$$\n将此结果代入体积模量的表达式，我们得到 $B_{\\text{tensor}}$ 的公式：\n$$\nB_{\\text{tensor}} = -\\frac{1}{3} \\left[-(C_{11} + 2C_{12})\\right] = \\frac{C_{11} + 2C_{12}}{3}\n$$\n使用所提供的弹性常数，$C_{11} = 240.0\\,\\text{GPa}$ 和 $C_{12} = 140.0\\,\\text{GPa}$：\n$$\nB_{\\text{tensor}} = \\frac{240.0\\,\\text{GPa} + 2 \\times 140.0\\,\\text{GPa}}{3} = \\frac{240.0 + 280.0}{3}\\,\\text{GPa} = \\frac{520.0}{3}\\,\\text{GPa}\n$$\n数值上，这等于 $B_{\\text{tensor}} \\approx 173.33333333\\,\\text{GPa}$。\n\n**3. 相对差异（$\\Delta$）**\n\n相对差异定义为：\n$$\n\\Delta = \\frac{B_{\\text{energy}} - B_{\\text{tensor}}}{B_{\\text{tensor}}}\n$$\n代入计算出的值：\n$$\nB_{\\text{energy}} \\approx 173.83616336\\,\\text{GPa}\n$$\n$$\nB_{\\text{tensor}} = \\frac{520.0}{3}\\,\\text{GPa} \\approx 173.33333333\\,\\text{GPa}\n$$\n$$\n\\Delta = \\frac{173.83616336 - \\frac{520.0}{3}}{\\frac{520.0}{3}} = \\frac{173.83616336 - 173.33333333}{173.33333333}\n$$\n$$\n\\Delta \\approx \\frac{0.50283003}{173.33333333} \\approx 0.00290094248\n$$\n将结果四舍五入到四位有效数字，我们得到：\n$$\n\\Delta \\approx 0.002901\n$$\n在实践中，这种微小的差异是预料之中的，因为这两种计算途径涉及不同类型的计算（总能量与应力响应），并且可能受到不同数值近似（例如，k点取样、基组选择）或物理近似（例如，交换关联泛函的选择）的影响。",
            "answer": "$$\n\\boxed{0.002901}\n$$"
        },
        {
            "introduction": "真实的材料行为往往超越了小应变下的线性弹性范畴，其许多性质（如热膨胀和声子相互作用）与非线性弹性有关，这需要通过高阶弹性常数来描述。这项高级练习将引导您进入有限应变理论的框架，通过拟合能量-应变数据来提取三阶弹性常数。此过程要求您仔细选择合适的应变范围，以平衡信号强度与高阶项截断误差，从而确保结果的物理真实性。",
            "id": "3794412",
            "problem": "给定一个立方晶体在沿 $x$ 轴的单轴有限应变下的合成第一性原理能量密度数据。目标是通过在有限应变框架中拟合能量-应变关系来提取三阶弹性常数，并证明所使用的应变范围的合理性。工作在超弹性、等温体系中，并假设质量密度不变。所有量均为单位体积量。\n\n基本和建模假设：\n- 在沿 $x$ 轴的单轴工程应变 $\\varepsilon$ 下，形变梯度为 $F = \\mathrm{diag}(1+\\varepsilon, 1, 1)$。\n- Green–Lagrange 应变（也称为有限应变）为 $E_{ij} = \\tfrac{1}{2}(F_{ki}F_{kj} - \\delta_{ij})$。在上述 $F$ 下，唯一的非零应变分量是 $E_{11} = \\varepsilon + \\tfrac{1}{2}\\varepsilon^2$，为简洁起见记为 $E$。\n- 对于在这种载荷下的立方晶体，应变能密度 $W$ 在 $E$ 中被建模为截至三阶的泰勒展开，相关常数为二阶弹性常数 $C_{11}$ 和三阶弹性常数 $C_{111}$。具体来说，$W(E)$ 被截断至三阶，并且仅通过在单轴载荷下与立方对称性一致的不变量依赖于 $E$。\n\n任务：\n1. 使用 Green–Lagrange 应变 $E = \\varepsilon + \\tfrac{1}{2}\\varepsilon^2$，用一个在 $E$ 中为三阶的模型（仅含二阶和三阶项）来拟合能量密度数据 $W(\\varepsilon)$，并推断出 $C_{11}$ 和 $C_{111}$。\n2. 通过要求在所选范围内的最大应变处，建模的三次项贡献与二次项贡献的量值之比位于一个预定区间内，来证明所选应变范围的合理性。定义\n   $$\n   R = \\left|\\frac{W_3}{W_2}\\right| = \\left|\\frac{\\tfrac{1}{6} C_{111} E_{\\max}^3}{\\tfrac{1}{2} C_{11} E_{\\max}^2}\\right| = \\left|\\frac{C_{111}}{3 C_{11}} E_{\\max}\\right|,\n   $$\n   其中 $E_{\\max}$ 是拟合中使用的最大工程应变处的 Green–Lagrange 应变。如果 $0.05 \\le R \\le 0.5$，则该范围是可接受的，这确保了三次项是可检测的，同时截断至三阶仍然可信。\n3. 此外，通过计算相对残差来量化三阶截断的保真度\n   $$\n   \\rho = \\frac{\\|W - \\hat{W}\\|_2}{\\|W\\|_2},\n   $$\n   其中 $\\hat{W}$ 是拟合的三阶模型，$\\|\\cdot\\|_2$ 表示在所选应变点上的欧几里得范数。要求 $\\rho \\le 0.02$ 才可接受。\n\n模型和拟合细节：\n- 用参数线性模型 $W(E) = a_2 E^2 + a_3 E^3$ 拟合 $W(E)$，然后推断 $C_{11} = 2 a_2$ 和 $C_{111} = 6 a_3$。这是一个关于回归量 $E^2$ 和 $E^3$ 的线性最小二乘问题。\n- 用于拟合的应变范围必须由上述 $R$ 和 $\\rho$ 标准来证明其合理性。如果所提供的完整范围未能满足 $R$ 的下限，则报告在完整提供范围上可达成的最佳拟合并标记为不可接受。如果 $R$ 的上限或残差界限未能满足，则将范围缩小到满足这两个标准的最大子集。\n\n单位：\n- 能量密度 $W$ 的单位是焦耳每立方米（$\\mathrm{J/m^3}$），等于帕斯卡（$\\mathrm{Pa}$）。\n- 弹性常数 $C_{11}$ 和 $C_{111}$ 的单位是帕斯卡（$\\mathrm{Pa}$）。\n- 将报告的 $C_{111}$ 以吉帕斯卡（$\\mathrm{GPa}$）为单位表示为浮点数。四舍五入到三位小数。\n- 不使用角度。\n- 百分比必须以小数表示；工程应变以小数形式提供。\n\n数据生成背景：\n- 合成的 $W(\\varepsilon)$ 数据通过已知的常数计算 $W$ 来模拟密度泛函理论（DFT）总能量计算的结果，并在一个案例中包含一个小的 $E$ 的四次项，该项代表超出三阶的贡献。该项不包含在拟合模型中，因此会对残差产生贡献。\n\n测试套件：\n对于每个测试用例，给定 $C_{11}$、$C_{111}$、最大工程应变 $\\varepsilon_{\\max}$、工程应变步长 $\\Delta \\varepsilon$ 和一个四次项系数 $k$（$k = 0$ 表示没有四次项贡献）。将应变网格 $\\{\\varepsilon_n\\}$ 定义为 $\\varepsilon_n = n \\Delta \\varepsilon$，其中整数 $n$ 从 $0$ 到 $N$ 且 $N \\Delta \\varepsilon = \\varepsilon_{\\max}$。对于每个 $\\varepsilon_n$，计算 $E_n = \\varepsilon_n + \\tfrac{1}{2}\\varepsilon_n^2$，然后\n$$\nW_n = \\tfrac{1}{2} C_{11} E_n^2 + \\tfrac{1}{6} C_{111} E_n^3 + k E_n^4.\n$$\n您必须只拟合到三阶（在拟合模型中忽略四次项），并根据 $R$ 和 $\\rho$ 的标准选择所提供网格的最大可接受子集。\n\n- 测试用例 1（理想路径）：$C_{11} = 200 \\times 10^9 \\ \\mathrm{Pa}$，$C_{111} = -1200 \\times 10^9 \\ \\mathrm{Pa}$，$\\varepsilon_{\\max} = 0.08$，$\\Delta \\varepsilon = 0.004$，$k = 0$。\n- 测试用例 2（边界：应变太小）：$C_{11} = 200 \\times 10^9 \\ \\mathrm{Pa}$，$C_{111} = -1200 \\times 10^9 \\ \\mathrm{Pa}$，$\\varepsilon_{\\max} = 0.01$，$\\Delta \\varepsilon = 0.001$，$k = 0$。\n- 测试用例 3（边缘：较大应变与四次项不匹配）：$C_{11} = 200 \\times 10^9 \\ \\mathrm{Pa}$，$C_{111} = -1200 \\times 10^9 \\ \\mathrm{Pa}$，$\\varepsilon_{\\max} = 0.15$，$\\Delta \\varepsilon = 0.005$，$k = 5 \\times 10^{10} \\ \\mathrm{Pa}$。\n\n要求的最终输出：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个元素对应一个测试用例，其本身是一个形式为 $[C_{111}^{\\mathrm{(GPa)}}, \\text{range\\_acceptable}]$ 的双元素列表，其中 $C_{111}^{\\mathrm{(GPa)}}$ 是以 $\\mathrm{GPa}$ 为单位、四舍五入到三位小数的拟合三阶常数，而 $\\text{range\\_acceptable}$ 是一个布尔值，指示在所选范围上是否同时满足 $R$ 和 $\\rho$ 标准。例如：$[[x_1,b_1],[x_2,b_2],[x_3,b_3]]$。",
            "solution": "### 1. 理论框架\n\n该问题属于连续介质力学领域，特别是关于材料经历有限形变的超弹性理论。\n\n#### 1.1. 有限应变张量\n对于大形变，无穷小应变张量是不够的。Green–Lagrange 有限应变张量 $E_{ij}$ 提供了一种几何上精确的应变度量。它是根据形变梯度张量 $F_{ij} = \\partial x_i / \\partial X_j$ 定义的，该张量将物质点从参考构型 $\\mathbf{X}$ 映射到当前构型 $\\mathbf{x}$。\n$$\nE_{ij} = \\frac{1}{2} (F_{ki} F_{kj} - \\delta_{ij})\n$$\n其中 $\\delta_{ij}$ 是克罗内克符号。对于沿 $x$ 轴（或 $1$ 轴）的规定单轴形变，工程应变为 $\\varepsilon$，则形变梯度张量为 $F = \\mathrm{diag}(1+\\varepsilon, 1, 1)$。Green–Lagrange 应变张量的唯一非零分量为：\n$$\nE_{11} = \\frac{1}{2} ((1+\\varepsilon)^2 - 1) = \\frac{1}{2} (1 + 2\\varepsilon + \\varepsilon^2 - 1) = \\varepsilon + \\frac{1}{2}\\varepsilon^2\n$$\n为简洁起见，我们将此单分量表示为 $E$。\n\n#### 1.2. 立方晶体的应变能密度\n在超弹性理论中，材料的响应由应变能密度函数 $W$ 描述，它是应变张量的标量势函数。对于晶体，$W$ 必须在其晶体点群的对称操作下保持不变。对于在指定单轴应变沿晶轴（例如，$[100]$）作用下的立方晶体，应变能密度可以在应变分量 $E = E_{11}$ 中展开为泰勒级数：\n$$\nW(E) = \\frac{1}{2} C_{11} E^2 + \\frac{1}{6} C_{111} E^3 + \\frac{1}{24} C_{1111} E^4 + \\dots\n$$\n其中 $C_{11}$ 是二阶弹性常数 (SOEC)，$C_{111}$、$C_{1111}$ 等分别是三阶 (TOEC) 和更高阶的弹性常数。这些常数是基本材料属性。本问题的目标是通过将此模型与能量-应变数据进行拟合来确定 $C_{11}$ 和 $C_{111}$。\n\n### 2. 拟合过程和模型验证\n\n该问题要求拟合在工程应变 $\\varepsilon$ 网格上生成的合成能量密度数据 $W(\\varepsilon)$。\n\n#### 2.1. 线性最小二乘回归\n拟合模型是应变能展开在 $E$ 中截断到三阶的形式：\n$$\n\\hat{W}(E) = a_2 E^2 + a_3 E^3\n$$\n目标是找到系数 $a_2$ 和 $a_3$，以最小化模型预测 $\\hat{W}$ 与所提供数据 $W$ 之间的差异。将其与理论形式进行比较，我们可以推断出弹性常数：\n$$\nC_{11} = 2 a_2, \\quad C_{111} = 6 a_3\n$$\n对于一组 $m$ 个数据点 $(E_i, W_i)$，其中 $i=1, \\dots, m$（不包括平凡点 $(0,0)$），我们可以构建一个线性方程组 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta}$，其中：\n- $\\mathbf{y}$ 是一个包含能量密度值 $W_i$ 的 $m \\times 1$ 向量。\n- $\\mathbf{X}$ 是 $m \\times 2$ 的设计矩阵，其第 $i$ 行为 $[E_i^2, E_i^3]$。\n- $\\boldsymbol{\\beta}$ 是一个包含未知系数 $[a_2, a_3]^T$ 的 $2 \\times 1$ 向量。\n\n这个超定系统使用线性最小二乘法求解，该方法找到向量 $\\boldsymbol{\\beta}$，以最小化残差向量的欧几里得范数 $\\|\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta}\\|_2$。解可以通过正规方程 $\\boldsymbol{\\beta} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}$ 找到，但更推荐使用数值稳定的方法，如 QR 分解（在 `scipy.linalg.lstsq` 中实现）。\n\n#### 2.2. 应变范围的合理性证明\n提取像 $C_{111}$ 这样的非线性属性的一个关键方面是选择用于拟合的应变范围。\n- 如果应变太小，与二次项 $\\propto E^2$ 相比，三次项 $\\propto E^3$ 可以忽略不计，因此无法可靠地确定 $C_{111}$。\n- 如果应变太大，在拟合模型中被忽略的高阶项（如 $E^4$ 及更高阶项）会变得显著，导致拟合效果差，对 $C_{11}$ 和 $C_{111}$ 的估计不准确。\n\n该问题定义了两个定量标准以确保所选应变范围是合适的：\n\n1.  **三次项与二次项贡献之比 $R$**：该比率评估在拟合范围的最大应变 $E_{\\max}$ 处非线性项的重要性。\n    $$\n    R = \\left|\\frac{\\text{Cubic energy term}}{\\text{Quadratic energy term}}\\right|_{E=E_{\\max}} = \\left|\\frac{\\frac{1}{6} C_{111} E_{\\max}^3}{\\frac{1}{2} C_{11} E_{\\max}^2}\\right| = \\left|\\frac{C_{111}}{3 C_{11}} E_{\\max}\\right|\n    $$\n    问题要求 $0.05 \\le R \\le 0.5$。下限确保三次项足够大以便被检测到，而上限则提供了级数中的下一项（$E^4$）可能仍然很小的信心。\n\n2.  **相对残差 $\\rho$**：该度量量化了整体的拟合优度。\n    $$\n    \\rho = \\frac{\\|W - \\hat{W}\\|_2}{\\|W\\|_2}\n    $$\n    其中 $W$ 是数据值，$\\hat{W}$ 是拟合模型预测的值。问题要求 $\\rho \\le 0.02$，这将模型与数据的偏差限制在 $2\\%$ 以内。\n\n### 3. 算法实现\n\n任务是找到从 $\\varepsilon = 0$ 开始，满足 $R$ 和 $\\rho$ 两个标准的最大应变范围。对于每个测试用例，算法按以下步骤进行：\n\n1.  **数据生成**：对于给定的参数（$C_{11}$、$C_{111}$、$\\varepsilon_{\\max}$、$\\Delta\\varepsilon$、$k$），生成 $N+1$ 个数据点集。工程应变为 $\\varepsilon_n = n \\Delta\\varepsilon$，其中 $n = 0, \\dots, N$，$N=\\varepsilon_{\\max}/\\Delta\\varepsilon$。对于每个 $\\varepsilon_n$，计算有限应变 $E_n = \\varepsilon_n + \\frac{1}{2}\\varepsilon_n^2$ 和能量密度 $W_n = \\frac{1}{2} C_{11} E_n^2 + \\frac{1}{6} C_{111} E_n^3 + k E_n^4$。拟合数据将由 $n=1, \\dots, N$ 的点组成。\n\n2.  **在完整范围上进行初始拟合**：使用所有非平凡数据点（从 $n=1$ 到 $N$）进行最小二乘拟合。计算拟合常数 $C_{11, \\text{fit}}$ 和 $C_{111, \\text{fit}}$，以及验证指标 $R$ 和 $\\rho$。\n    - 如果 $R  0.05$，此测试用例的程序终止。由于非线性不足，拟合被视为不可接受，但报告此全范围拟合得到的 $C_{111}$，并附带一个 `False` 标志。\n    - 如果 $0.05 \\le R \\le 0.5$ 且 $\\rho \\le 0.02$，则完整范围是可接受的。程序终止，报告拟合的 $C_{111}$ 和一个 `True` 标志。\n\n3.  **迭代缩减范围**：如果初始拟合因 $R  0.5$ 或 $\\rho  0.02$ 而失败，则应变范围过大。通过移除具有最高应变的数据点来迭代缩减范围。算法通过从 $m = N-1$ 向下循环到一个最小点数（例如，$m=2$，这是双参数拟合的最小值）来进行。在每次迭代中：a. 对当前 $m$ 个点的范围进行拟合。b. 计算 $C_{11, \\text{fit}}$、$C_{111, \\text{fit}}$、$R$ 和 $\\rho$。c. 如果 $0.05 \\le R \\le 0.5$ 且 $\\rho \\le 0.02$，则满足标准。这代表了最大的可接受应变范围。循环终止，并报告当前拟合的 $C_{111}$ 和一个 `True` 标志。\n\n4.  **最终输出**：对于每个测试用例，将确定的 $C_{111}$ 转换为吉帕斯卡（GPa）并四舍五入到 $3$ 位小数。最终结果是一个包含该值和布尔可接受性标志的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import lstsq\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It generates synthetic data, performs fits, and validates the strain range.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    test_cases = [\n        # (C11_Pa, C111_Pa, eps_max, delta_eps, k_Pa)\n        (200e9, -1200e9, 0.08, 0.004, 0.0),\n        (200e9, -1200e9, 0.01, 0.001, 0.0),\n        (200e9, -1200e9, 0.15, 0.005, 5e10),\n    ]\n\n    results = []\n    for c11_true, c111_true, eps_max, delta_eps, k in test_cases:\n        # Step 1: Generate synthetic data\n        num_steps = int(round(eps_max / delta_eps))\n        # Strain grid from n=0...num_steps. We use n=1... for fitting.\n        eps_n = np.linspace(0, eps_max, num_steps + 1)\n        # Green-Lagrange strain E = e + 0.5*e^2\n        E_n = eps_n + 0.5 * eps_n**2\n        # Strain energy density W = 1/2*C11*E^2 + 1/6*C111*E^3 + k*E^4\n        W_n = (0.5 * c11_true * E_n**2 + \n               (1/6) * c111_true * E_n**3 + \n               k * E_n**4)\n\n        # We fit using non-zero strain points\n        fit_eps = eps_n[1:]\n        fit_E = E_n[1:]\n        fit_W = W_n[1:]\n\n        # Algorithmic logic for range selection\n        # Start with the full range and shrink if necessary.\n        case_result = None\n        \n        # Loop from full range (m = num_steps) down to 2 points\n        for m in range(num_steps, 1, -1):\n            current_eps = fit_eps[:m]\n            current_E = fit_E[:m]\n            current_W = fit_W[:m]\n\n            # Set up the linear least squares problem: y = X*beta\n            # X matrix columns are E^2 and E^3\n            X = np.vstack([current_E**2, current_E**3]).T\n            y = current_W\n\n            # Solve for beta = [a2, a3]\n            beta, _, _, _ = lstsq(X, y, cond=None)\n            a2, a3 = beta[0], beta[1]\n\n            # Infer elastic constants\n            c11_fit = 2 * a2\n            c111_fit = 6 * a3\n\n            # Calculate predicted energy\n            W_hat = X @ beta\n\n            # Calculate validation criteria R and rho\n            E_max_current = current_E[-1]\n            \n            # Use fitted constants to calculate R as per best practice\n            if c11_fit == 0:\n                # Avoid division by zero, R is effectively infinite in this pathological case.\n                R = float('inf')\n            else:\n                R = np.abs((c111_fit / (3 * c11_fit)) * E_max_current)\n\n            # Calculate relative residual rho\n            norm_W = np.linalg.norm(current_W)\n            if norm_W == 0:\n                # Avoid division by zero if all data points are zero\n                rho = 0.0\n            else:\n                rho = np.linalg.norm(current_W - W_hat) / norm_W\n\n            acceptable = (0.05 = R = 0.5) and (rho = 0.02)\n            c111_gpa = c111_fit / 1e9\n            \n            # Logic for handling range acceptance/rejection\n            if m == num_steps: # First iteration with full range\n                if R  0.05:\n                    # Per instructions: if full range fails lower R bound, report\n                    # as not acceptable and stop.\n                    case_result = [round(c111_gpa, 3), False]\n                    break\n                elif acceptable:\n                    # Full range is acceptable\n                    case_result = [round(c111_gpa, 3), True]\n                    break\n                # Otherwise, continue to shrink range\n            elif acceptable:\n                # Found the largest acceptable range\n                case_result = [round(c111_gpa, 3), True]\n                break\n        \n        # This case should not be reached with the given problems, but\n        # as a fallback, if no acceptable range is found, store something.\n        if case_result is None:\n            # Fallback based on the a fit of the minimum number of points (2)\n            # This outcome indicates no subset satisfied the criteria.\n            # We report the result of the smallest fit, flagged as not acceptable.\n            c111_gpa = c111_fit / 1e9\n            case_result = [round(c111_gpa, 3), False]\n            \n        results.append(case_result)\n\n\n    # Final print statement must produce the exact specified format.\n    # We manually construct the string to avoid spaces from str(list).\n    inner_results_str = [f\"[{res[0]:.3f},{str(res[1]).lower()}]\" for res in results]\n    final_output_str = f\"[{','.join(inner_results_str)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}