{
    "hands_on_practices": [
        {
            "introduction": "Cohesive zone models are powerful tools for simulating fracture by describing the traction-separation behavior of a developing crack. To be physically meaningful, the parameters of these models should reflect the underlying microstructural processes. This practice  provides a hands-on approach to multiscale homogenization, where you will derive a macroscopic cohesive law from the collective response of individual microscopic ligaments. By ensuring the homogenized model reproduces a target fracture energy, $G_c$, you will gain insight into how micro-scale heterogeneity influences macro-scale fracture properties.",
            "id": "3810119",
            "problem": "Consider a Representative Volume Element (RVE) consisting of $N$ parallel unit-area microscopic ligaments that carry normal traction under an imposed opening separation $ \\delta \\ge 0 $. Each ligament $i$ is characterized by three parameters: a normal stiffness $k_i$ with units $\\text{Pa}/\\text{m}$, a damage onset separation $ \\delta_{0,i} $ with units $\\text{m}$, and a final separation $ \\delta_{f,i} $ with units $\\text{m}$ where the traction reduces to zero. The microscopic traction-separation response for ligament $i$ is defined by the following piecewise law (the following piecewise cohesive law):\n\n- Elastic regime: for $ 0 \\le \\delta \\le \\delta_{0,i} $, $ t_i(\\delta) = \\alpha \\, k_i \\, \\delta $.\n- Softening regime: for $ \\delta_{0,i} < \\delta < \\delta_{f,i} $, $ t_i(\\delta) = \\alpha \\, k_i \\, \\delta \\left( 1 - \\dfrac{\\delta - \\delta_{0,i}}{\\delta_{f,i} - \\delta_{0,i}} \\right) $.\n- Fully separated: for $ \\delta \\ge \\delta_{f,i} $, $ t_i(\\delta) = 0 $.\n\nHere, $ \\alpha $ is a dimensionless scalar that multiplies the microscopic stiffnesses to homogenize the macroscopic traction-separation law. The homogenized macroscopic traction is defined as the area-average of the microscopic tractions,\n$$\nT(\\delta) = \\frac{1}{N} \\sum_{i=1}^{N} t_i(\\delta).\n$$\n\nThe macroscopic fracture energy $ G_c $ with units $ \\text{J}/\\text{m}^2 $ is defined as the work of separation per unit area, given by the area under the macroscopic traction-separation curve,\n$$\nG_c = \\int_{0}^{\\delta_{\\max}} T(\\delta) \\, d\\delta, \\quad \\delta_{\\max} = \\max_{i} \\delta_{f,i}.\n$$\n\nYour task is to derive, implement, and verify a homogenized cohesive law $ T(\\delta) $ by:\n- Starting from the definition of the microscopic traction law, the macroscopic average, and the work of separation equivalence.\n- Determining the scalar $ \\alpha $ such that the macroscopic work of separation equals a specified target $ G_c $ for each test case.\n- Computing the macroscopic traction-separation curve $ T(\\delta) $ on a uniform grid and reporting its peak value.\n\nAll quantities must be expressed in consistent units: $ \\delta $ in $\\text{m}$, $ T $ in $\\text{Pa}$, and $ G_c $ in $\\text{J}/\\text{m}^2$. The peak traction should be reported in megapascals ($\\text{MPa}$). Angles are not involved in this problem.\n\nSimulation and numerical requirements:\n- Use a uniform separation grid of $M$ points from $ \\delta = 0 $ to $ \\delta = \\delta_{\\max} $ inclusive, with $ M = 4097 $.\n- Use the trapezoidal rule to numerically integrate $ T(\\delta) $ and verify the macroscopic fracture energy.\n- Construct deterministic microscopic parameter sets using linear spacing across specified ranges to ensure reproducibility.\n\nTest suite:\nFor each test case, define $N$, the ranges for $k_i$, $ \\delta_{0,i} $, and $ \\delta_{f,i} $, and the target $ G_c $. For $i = 1, 2, \\ldots, N$, define\n$$\nk_i = k_{\\min} + \\frac{i-1}{N-1} (k_{\\max} - k_{\\min}), \\quad\n\\delta_{0,i} = \\delta_{0,\\min} + \\frac{i-1}{N-1} (\\delta_{0,\\max} - \\delta_{0,\\min}), \\quad\n\\delta_{f,i} = \\delta_{f,\\min} + \\frac{i-1}{N-1} (\\delta_{f,\\max} - \\delta_{f,\\min}).\n$$\nIf a range has equal endpoints then the parameter is constant across $i$.\n\nProvide four test cases:\n1. Case $1$: $N = 50$, $k_{\\min} = 1.0 \\times 10^{12}$, $k_{\\max} = 4.0 \\times 10^{12}$, $\\delta_{0,\\min} = 2.0 \\times 10^{-6}$, $\\delta_{0,\\max} = 6.0 \\times 10^{-6}$, $\\delta_{f,\\min} = 1.0 \\times 10^{-5}$, $\\delta_{f,\\max} = 3.0 \\times 10^{-5}$, target $ G_c = 200.0 $.\n2. Case $2$: $N = 50$, $k_{\\min} = 2.0 \\times 10^{12}$, $k_{\\max} = 2.0 \\times 10^{12}$, $\\delta_{0,\\min} = 5.0 \\times 10^{-6}$, $\\delta_{0,\\max} = 5.0 \\times 10^{-6}$, $\\delta_{f,\\min} = 8.0 \\times 10^{-6}$, $\\delta_{f,\\max} = 1.2 \\times 10^{-5}$, target $ G_c = 50.0 $.\n3. Case $3$: $N = 200$, $k_{\\min} = 5.0 \\times 10^{11}$, $k_{\\max} = 5.0 \\times 10^{12}$, $\\delta_{0,\\min} = 1.0 \\times 10^{-6}$, $\\delta_{0,\\max} = 1.5 \\times 10^{-5}$, $\\delta_{f,\\min} = 2.0 \\times 10^{-5}$, $\\delta_{f,\\max} = 6.0 \\times 10^{-5}$, target $ G_c = 800.0 $.\n4. Case $4$: $N = 5$, $k_{\\min} = 1.0 \\times 10^{12}$, $k_{\\max} = 1.0 \\times 10^{12}$, $\\delta_{0,\\min} = 1.0 \\times 10^{-6}$, $\\delta_{0,\\max} = 1.5 \\times 10^{-6}$, $\\delta_{f,\\min} = 2.0 \\times 10^{-6}$, $\\delta_{f,\\max} = 3.0 \\times 10^{-6}$, target $ G_c = 10.0 $.\n\nAnswer specification:\n- For each test case, compute and return a list $ [\\alpha, T_{\\max}, e] $, where $ \\alpha $ is dimensionless, $ T_{\\max} $ is the peak of $ T(\\delta) $ reported in $\\text{MPa}$, and $ e $ is the absolute relative error of the numerically integrated $ G_c $ defined by $ e = \\left| G_c^{\\text{num}} - G_c^{\\text{target}} \\right| / G_c^{\\text{target}} $ expressed as a decimal.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one list per test case in order. For example, the output format should be\n$$\n[ [\\alpha_1, T_{\\max,1}, e_1], [\\alpha_2, T_{\\max,2}, e_2], [\\alpha_3, T_{\\max,3}, e_3], [\\alpha_4, T_{\\max,4}, e_4] ].\n$$",
            "solution": "The derivation is grounded in energy equivalence and homogenization principles appropriate for multiscale materials simulation. The Representative Volume Element (RVE) contains $N$ parallel unit-area ligaments, each with a microscopic traction-separation response $t_i(\\delta)$ defined by the piecewise cohesive model from the problem description. The macroscopic traction $T(\\delta)$ is defined by the area average of $t_i(\\delta)$ over the ligaments, which for equal areas and parallel coupling reduces to an arithmetic mean.\n\nFoundational principles:\n- Work of separation per unit area equals fracture energy. For a cohesive interface, the macroscopic fracture energy $G_c$ is the area under the macroscopic traction-separation curve, given by $ G_c = \\int_{0}^{\\delta_{\\max}} T(\\delta) \\, d\\delta $.\n- Homogenization under uniform loading of parallel unit-area ligaments gives $$ T(\\delta) = \\frac{1}{N} \\sum_{i=1}^{N} t_i(\\delta) $$.\n- To enforce a target $G_c$ at the macroscale using consistent microphysics, we scale the microscopic stiffnesses by a single scalar $ \\alpha $ so that the area under $T(\\delta)$ matches the target $ G_c $ exactly. Because $ t_i(\\delta) $ is linear in $ k_i $, and $ T(\\delta) $ is a linear average of $t_i(\\delta)$, the macroscopic area under $T(\\delta)$ scales linearly with $ \\alpha $.\n\nDefine the microscopic traction $ t_i(\\delta) $ piecewise:\n- For $ 0 \\le \\delta \\le \\delta_{0,i} $,\n$$\nt_i(\\delta) = \\alpha \\, k_i \\, \\delta.\n$$\n- For $ \\delta_{0,i} < \\delta < \\delta_{f,i} $, letting $ \\Delta_i = \\delta_{f,i} - \\delta_{0,i} > 0 $,\n$$\nt_i(\\delta) = \\alpha \\, k_i \\, \\delta \\left( 1 - \\frac{\\delta - \\delta_{0,i}}{\\Delta_i} \\right).\n$$\n- For $ \\delta \\ge \\delta_{f,i} $,\n$$\nt_i(\\delta) = 0.\n$$\n\nThe macroscopic traction is $ T(\\delta) = \\frac{1}{N} \\sum_{i=1}^{N} t_i(\\delta) $, and the macroscopic fracture energy is\n$$\nG_c = \\int_{0}^{\\delta_{\\max}} T(\\delta) \\, d\\delta, \\quad \\delta_{\\max} = \\max_{i} \\delta_{f,i}.\n$$\n\nTo determine $ \\alpha $, observe that the macroscopic fracture energy can be expressed in terms of microscopic work contributions. Define the microscopic work of separation (with $ \\alpha = 1 $) for ligament $i$:\n$$\ng_i = \\int_{0}^{\\delta_{0,i}} k_i \\, \\delta \\, d\\delta + \\int_{\\delta_{0,i}}^{\\delta_{f,i}} k_i \\, \\delta \\left( 1 - \\frac{\\delta - \\delta_{0,i}}{\\Delta_i} \\right) d\\delta.\n$$\nThe first integral evaluates to\n$$\n\\int_{0}^{\\delta_{0,i}} k_i \\, \\delta \\, d\\delta = \\frac{1}{2} k_i \\, \\delta_{0,i}^{\\,2}.\n$$\nThe second integral, using $ \\Delta_i = \\delta_{f,i} - \\delta_{0,i} $, expands as\n$$\n\\int_{\\delta_{0,i}}^{\\delta_{f,i}} k_i \\left[ \\delta - \\frac{\\delta^{2} - \\delta \\, \\delta_{0,i}}{\\Delta_i} \\right] d\\delta\n= k_i \\left[ \\frac{1}{2} \\delta^{2} - \\frac{1}{3 \\Delta_i} \\delta^{3} + \\frac{\\delta_{0,i}}{2 \\Delta_i} \\delta^{2} \\right]_{\\delta_{0,i}}^{\\delta_{f,i}}.\n$$\nTherefore, the microscopic work is\n$$\ng_i = \\frac{1}{2} k_i \\, \\delta_{0,i}^{\\,2}\n+ k_i \\left( \\left[ \\frac{1}{2} \\delta_{f,i}^{\\,2} - \\frac{1}{3 \\Delta_i} \\delta_{f,i}^{\\,3} + \\frac{\\delta_{0,i}}{2 \\Delta_i} \\delta_{f,i}^{\\,2} \\right]\n- \\left[ \\frac{1}{2} \\delta_{0,i}^{\\,2} - \\frac{1}{3 \\Delta_i} \\delta_{0,i}^{\\,3} + \\frac{\\delta_{0,i}}{2 \\Delta_i} \\delta_{0,i}^{\\,2} \\right] \\right).\n$$\nThe macroscopic unscaled fracture energy (with $ \\alpha = 1 $) is the average microscopic work,\n$$\nG_c^{\\text{unscaled}} = \\frac{1}{N} \\sum_{i=1}^{N} g_i.\n$$\nBecause $ t_i(\\delta) $ and hence $ T(\\delta) $ scale linearly with $ \\alpha $, the macroscopic fracture energy scales linearly with $ \\alpha $:\n$$\nG_c(\\alpha) = \\alpha \\, G_c^{\\text{unscaled}}.\n$$\nImposing $ G_c(\\alpha) = G_c^{\\text{target}} $ yields the scalar\n$$\n\\alpha = \\frac{G_c^{\\text{target}}}{G_c^{\\text{unscaled}}}.\n$$\n\nAlgorithmic procedure:\n1. Construct $k_i$, $ \\delta_{0,i} $, and $ \\delta_{f,i} $ deterministically using linear spacing across their specified ranges for each test case. Ensure $ \\Delta_i = \\delta_{f,i} - \\delta_{0,i} > 0 $.\n2. Compute $ g_i $ for each ligament with $ \\alpha = 1 $ using the closed-form integrals above, and then compute $ G_c^{\\text{unscaled}} = \\frac{1}{N} \\sum_i g_i $.\n3. Determine $ \\alpha = \\frac{G_c^{\\text{target}}}{G_c^{\\text{unscaled}}} $.\n4. Build a uniform separation grid of $ M = 4097 $ points spanning $ \\delta \\in [0, \\delta_{\\max}] $ with $ \\delta_{\\max} = \\max_i \\delta_{f,i} $.\n5. For each ligament $ i $ and each grid point $ \\delta_j $, evaluate $ t_i(\\delta_j) $ using the piecewise law with the computed $ \\alpha $, then compute $ T(\\delta_j) = \\frac{1}{N} \\sum_i t_i(\\delta_j) $.\n6. Compute the numerical macroscopic fracture energy $ G_c^{\\text{num}} = \\int_0^{\\delta_{\\max}} T(\\delta) \\, d\\delta $ via the trapezoidal rule on the grid.\n7. Find $ T_{\\max} = \\max_j T(\\delta_j) $ and report it in $\\text{MPa}$ using $ T_{\\max,\\text{MPa}} = T_{\\max} / 10^{6} $.\n8. Report $ \\alpha $, $ T_{\\max,\\text{MPa}} $, and the absolute relative error $ e = \\left| G_c^{\\text{num}} - G_c^{\\text{target}} \\right| / G_c^{\\text{target}} $.\n\nEdge cases and consistency:\n- For narrow ranges of $ \\delta_{0,i} $ and $ \\delta_{f,i} $, the macroscopic traction may exhibit a sharp peak near $ \\delta \\approx \\delta_{0,i} $.\n- As $ N $ increases and heterogeneity broadens, $ T(\\delta) $ typically becomes smoother and the peak shifts depending on distributions of $ \\delta_{0,i} $ and $ k_i $.\n- Units are consistent: $ t_i $ and $ T $ in $ \\text{Pa} $, $ \\delta $ in $ \\text{m} $, and $ \\int T \\, d\\delta $ in $ \\text{Pa}\\cdot\\text{m} = \\text{J}/\\text{m}^2 $.\n\nThe final implementation follows these steps, ensuring deterministic parameter generation and numerical verification of the energy equivalence with the specified target $ G_c $ for each test case, and outputs the required lists in the specified single-line format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_micro_work_unscaled(k, d0, df):\n    \"\"\"\n    Compute the microscopic work of separation g_i for a single ligament with alpha = 1.\n    Piecewise traction law:\n      - t = k * delta, for 0 <= delta <= d0\n      - t = k * delta * (1 - (delta - d0)/(df - d0)), for d0 < delta < df\n      - t = 0, for delta >= df\n    Returns g_i = integral of t over delta from 0 to df.\n    \"\"\"\n    Delta = df - d0\n    if Delta <= 0:\n        # Physically invalid; return 0 to avoid division by zero.\n        return 0.0\n    # First integral: elastic regime [0, d0]\n    I1 = 0.5 * k * d0**2\n    # Second integral: softening regime [d0, df]\n    # Integrand: k * [ delta - (delta^2 - delta*d0)/Delta ]\n    # Antiderivative: k * [ 0.5*delta^2 - (1/(3*Delta))*delta^3 + (d0/(2*Delta))*delta^2 ]\n    A = 0.5 * df**2 - (df**3) / (3.0 * Delta) + (d0 * df**2) / (2.0 * Delta)\n    B = 0.5 * d0**2 - (d0**3) / (3.0 * Delta) + (d0 * d0**2) / (2.0 * Delta)\n    I2 = k * (A - B)\n    return I1 + I2\n\ndef build_parameters(N, kmin, kmax, d0min, d0max, dfmin, dfmax):\n    \"\"\"\n    Deterministically construct arrays k_i, d0_i, df_i using linear spacing.\n    \"\"\"\n    if N == 1:\n        ks = np.array([kmin])\n        d0s = np.array([d0min])\n        dfs = np.array([dfmin])\n    else:\n        ks = np.linspace(kmin, kmax, N)\n        d0s = np.linspace(d0min, d0max, N)\n        dfs = np.linspace(dfmin, dfmax, N)\n    return ks, d0s, dfs\n\ndef compute_alpha(ks, d0s, dfs, Gc_target):\n    \"\"\"\n    Compute alpha = Gc_target / Gc_unscaled, where Gc_unscaled is the average microscopic work.\n    \"\"\"\n    g_list = [compute_micro_work_unscaled(k, d0, df) for k, d0, df in zip(ks, d0s, dfs)]\n    Gc_unscaled = np.mean(g_list)\n    # Avoid division by zero; if Gc_unscaled ~ 0, set alpha = 0 to reflect no capacity.\n    if Gc_unscaled <= 0.0:\n        return 0.0, Gc_unscaled\n    alpha = Gc_target / Gc_unscaled\n    return alpha, Gc_unscaled\n\ndef compute_macro_curve(ks, d0s, dfs, alpha, M=4097):\n    \"\"\"\n    Compute the macroscopic traction-separation curve T(delta) over a uniform grid of M points.\n    Returns delta_grid, T(delta).\n    \"\"\"\n    df_max = float(np.max(dfs))\n    delta_grid = np.linspace(0.0, df_max, M)\n    N = len(ks)\n    T = np.zeros_like(delta_grid)\n    # Vectorized computation per ligament\n    for k, d0, df in zip(ks, d0s, dfs):\n        Delta = df - d0\n        # Masks for regions\n        mask_elastic = delta_grid <= d0\n        mask_softening = (delta_grid > d0) & (delta_grid < df)\n        # Elastic contribution\n        t_elastic = alpha * k * delta_grid\n        # Softening contribution\n        # Protect against Delta <= 0\n        if Delta > 0.0:\n            soft_factor = 1.0 - (delta_grid - d0) / Delta\n            t_soft = alpha * k * delta_grid * soft_factor\n        else:\n            t_soft = np.zeros_like(delta_grid)\n        # Assemble per ligament\n        ti = np.zeros_like(delta_grid)\n        ti[mask_elastic] = t_elastic[mask_elastic]\n        ti[mask_softening] = t_soft[mask_softening]\n        # Add to macroscopic traction (mean over ligaments)\n        T += ti / N\n    return delta_grid, T\n\ndef analyze_case(N, kmin, kmax, d0min, d0max, dfmin, dfmax, Gc_target, M=4097):\n    \"\"\"\n    Build parameters, compute alpha, macroscopic curve, numerical Gc, peak traction, and error.\n    \"\"\"\n    ks, d0s, dfs = build_parameters(N, kmin, kmax, d0min, d0max, dfmin, dfmax)\n    alpha, Gc_unscaled = compute_alpha(ks, d0s, dfs, Gc_target)\n    delta_grid, T = compute_macro_curve(ks, d0s, dfs, alpha, M=M)\n    # Numerical integration of T over delta using trapezoidal rule\n    Gc_num = np.trapz(T, delta_grid)\n    # Peak traction in MPa\n    Tmax_MPa = np.max(T) / 1.0e6\n    # Absolute relative error\n    if Gc_target > 0.0:\n        err = abs(Gc_num - Gc_target) / Gc_target\n    else:\n        err = 0.0\n    return [alpha, Tmax_MPa, err]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            \"N\": 50,\n            \"kmin\": 1.0e12, \"kmax\": 4.0e12,\n            \"d0min\": 2.0e-6, \"d0max\": 6.0e-6,\n            \"dfmin\": 1.0e-5, \"dfmax\": 3.0e-5,\n            \"Gc_target\": 200.0\n        },\n        # Case 2\n        {\n            \"N\": 50,\n            \"kmin\": 2.0e12, \"kmax\": 2.0e12,\n            \"d0min\": 5.0e-6, \"d0max\": 5.0e-6,\n            \"dfmin\": 8.0e-6, \"dfmax\": 1.2e-5,\n            \"Gc_target\": 50.0\n        },\n        # Case 3\n        {\n            \"N\": 200,\n            \"kmin\": 5.0e11, \"kmax\": 5.0e12,\n            \"d0min\": 1.0e-6, \"d0max\": 1.5e-5,\n            \"dfmin\": 2.0e-5, \"dfmax\": 6.0e-5,\n            \"Gc_target\": 800.0\n        },\n        # Case 4\n        {\n            \"N\": 5,\n            \"kmin\": 1.0e12, \"kmax\": 1.0e12,\n            \"d0min\": 1.0e-6, \"d0max\": 1.5e-6,\n            \"dfmin\": 2.0e-6, \"dfmax\": 3.0e-6,\n            \"Gc_target\": 10.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_case(\n            N=case[\"N\"],\n            kmin=case[\"kmin\"], kmax=case[\"kmax\"],\n            d0min=case[\"d0min\"], d0max=case[\"d0max\"],\n            dfmin=case[\"dfmin\"], dfmax=case[\"dfmax\"],\n            Gc_target=case[\"Gc_target\"],\n            M=4097\n        )\n        # Ensure result types are fundamental floats\n        results.append([float(result[0]), float(result[1]), float(result[2])])\n\n    # Final print statement in the exact required format.\n    # Produce a single line with the nested list.\n    print(f\"[{','.join('[' + ','.join(map(str, r)) + ']' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The interaction between mechanical stress and the chemical environment can dramatically reduce a material's resistance to fracture, a phenomenon known as environmentally assisted cracking. This exercise  delves into the critical issue of hydrogen embrittlement by building a quantitative, chemo-mechanical model. You will apply principles of stress-assisted diffusion to predict hydrogen accumulation at a crack tip and see how this degrades the material's cohesive strength and ultimate fracture toughness, $K_{Ic}$.",
            "id": "3810154",
            "problem": "An isotropic elastic steel plate contains a straight through-thickness crack of length much larger than any internal material length. The crack is loaded under Mode I conditions in plane strain, and the environment provides hydrogen at a constant far-field concentration. The goal is to determine the steady-state hydrogen concentration at the crack tip under chemomechanical equilibrium and then predict the reduction in the critical Mode I fracture toughness from a hydrogen-degraded cohesive response.\n\nStart from the following fundamentals:\n- The local chemical potential of interstitial hydrogen in a stressed solid, following the Larché–Cahn framework, is given by $\\mu = \\mu^{0} + R T \\ln c - \\bar{V}_{H} \\sigma_{h}$, where $R$ is the universal gas constant, $T$ is the absolute temperature, $c$ is the local hydrogen atomic fraction (dimensionless), $\\bar{V}_{H}$ is the partial molar volume of hydrogen, and $\\sigma_{h}$ is the hydrostatic stress (positive in tension).\n- At steady state and under isothermal conditions, local equilibrium implies a spatially uniform chemical potential $\\mu$. Hence $c$ must adjust to mechanical fields such that $R T \\ln c - \\bar{V}_{H} \\sigma_{h} = \\text{constant}$.\n- In Linear Elastic Fracture Mechanics (LEFM), the near-tip stress field for Mode I ahead of the crack along $\\theta = 0$ has a tensile normal stress $\\sigma_{yy}(r,0) = \\dfrac{K_{I}}{\\sqrt{2 \\pi r}}$. Under plane strain, the out-of-plane stress is $\\sigma_{zz} = \\nu(\\sigma_{xx} + \\sigma_{yy})$, so the hydrostatic stress ahead of the tip is $\\sigma_{h}(r) = \\dfrac{1 + \\nu}{3}\\, \\dfrac{K_{I}}{\\sqrt{2 \\pi r}}$, where $\\nu$ is Poisson’s ratio and $K_{I}$ is the Mode I stress intensity factor.\n- In cohesive-zone modeling with a linear softening traction–separation law, the area under the traction–separation curve equals the fracture energy $G_{c} = \\dfrac{1}{2} T_{\\max} \\delta_{f}$, where $T_{\\max}$ is the cohesive strength and $\\delta_{f}$ is the critical separation at which complete decohesion occurs.\n- The plane strain modulus is $E' = \\dfrac{E}{1 - \\nu^{2}}$, where $E$ is Young’s modulus. The Mode I toughness satisfies $K_{Ic}^{2} = E' G_{c}$.\n\nAssume the following scientifically realistic material parameters and boundary conditions:\n- Young’s modulus $E = 210 \\times 10^{9}$, Poisson’s ratio $\\nu = 0.30$, and temperature $T = 300$.\n- Universal gas constant $R = 8.314$.\n- Partial molar volume of hydrogen $\\bar{V}_{H} = 2.00 \\times 10^{-6}$.\n- Far-field hydrogen concentration $c_{\\infty} = 1.50 \\times 10^{-6}$ (dimensionless atomic fraction).\n- Hydrogen-free cohesive parameters: maximum cohesive traction $T_{\\max}^{0} = 3.00 \\times 10^{9}$ and critical separation $\\delta_{f} = 1.33 \\times 10^{-6}$, giving a hydrogen-free fracture energy $G_{c}^{0} = \\dfrac{1}{2} T_{\\max}^{0} \\delta_{f}$ and hydrogen-free toughness $K_{Ic}^{0} = \\sqrt{E' G_{c}^{0}}$.\n- The crack-tip hydrogen concentration is controlled by the near-tip hydrostatic stress evaluated at a physically meaningful inner cutoff position $r_{c} = 3.50 \\times 10^{-6}$, representing the size of the process zone where the elastic singularity is regularized.\n- During environmental exposure, the mechanical field reaches $K_{I} = K_{Ic}^{0}$ before hydrogen-induced decohesion occurs.\n- Hydrogen reduces the cohesive strength locally according to $T_{\\max}(c) = T_{\\max}^{0} \\exp(-\\gamma c)$, with sensitivity parameter $\\gamma = 5.00 \\times 10^{4}$, while $\\delta_{f}$ is unaffected.\n\nTasks:\n1. Using the chemomechanical equilibrium condition, compute the steady-state hydrogen concentration at the crack tip $c_{\\text{tip}} = c(r = r_{c})$.\n2. Using the hydrogen-degraded cohesive strength at the tip, $T_{\\max}(c_{\\text{tip}})$, compute the reduced fracture energy $G_{c}(c_{\\text{tip}}) = \\dfrac{1}{2} T_{\\max}(c_{\\text{tip}}) \\delta_{f}$ and the corresponding reduced Mode I toughness $K_{Ic}(c_{\\text{tip}}) = \\sqrt{E' G_{c}(c_{\\text{tip}})}$.\n\nAnswer specification:\n- Express $c_{\\text{tip}}$ as a dimensionless atomic fraction.\n- Express the toughness in $\\text{MPa}\\sqrt{\\text{m}}$.\n- Round both $c_{\\text{tip}}$ and $K_{Ic}(c_{\\text{tip}})$ to three significant figures.",
            "solution": "The user wants to analyze hydrogen-induced degradation of fracture toughness in a steel plate using a chemomechanical model. The problem is approached by combining Linear Elastic Fracture Mechanics (LEFM), a cohesive zone model for fracture, and the Larché–Cahn theory for hydrogen transport in stressed solids.\n\n### Step 1: Extract Givens\n\nThe following data and models are provided in the problem statement:\n-   **Chemical Potential**: $\\mu = \\mu^{0} + R T \\ln c - \\bar{V}_{H} \\sigma_{h}$\n-   **Equilibrium Condition**: $R T \\ln c - \\bar{V}_{H} \\sigma_{h} = \\text{constant}$\n-   **LEFM Hydrostatic Stress (plane strain, $\\theta=0$)**: $\\sigma_{h}(r) = \\dfrac{1 + \\nu}{3}\\, \\dfrac{K_{I}}{\\sqrt{2 \\pi r}}$\n-   **Cohesive Law and Fracture Energy**: $G_{c} = \\dfrac{1}{2} T_{\\max} \\delta_{f}$\n-   **Toughness-Energy Relation (plane strain)**: $K_{Ic}^{2} = E' G_{c}$, with $E' = \\dfrac{E}{1 - \\nu^{2}}$\n-   **Material Properties**:\n    -   Young's modulus, $E = 210 \\times 10^{9}$ Pa\n    -   Poisson's ratio, $\\nu = 0.30$\n    -   Temperature, $T = 300$ K\n    -   Universal gas constant, $R = 8.314$ J/(mol·K)\n    -   Partial molar volume of hydrogen, $\\bar{V}_{H} = 2.00 \\times 10^{-6}$ m³/mol\n-   **Boundary Conditions**:\n    -   Far-field hydrogen concentration, $c_{\\infty} = 1.50 \\times 10^{-6}$\n    -   Stress intensity factor for equilibrium, $K_{I} = K_{Ic}^{0}$\n-   **Fracture Parameters (Hydrogen-Free)**:\n    -   Cohesive strength, $T_{\\max}^{0} = 3.00 \\times 10^{9}$ Pa\n    -   Critical separation, $\\delta_{f} = 1.33 \\times 10^{-6}$ m\n-   **Local Fracture Model Parameters**:\n    -   Process zone cutoff radius, $r_{c} = 3.50 \\times 10^{-6}$ m\n-   **Hydrogen Degradation Model**:\n    -   Degraded cohesive strength, $T_{\\max}(c) = T_{\\max}^{0} \\exp(-\\gamma c)$\n    -   Sensitivity parameter, $\\gamma = 5.00 \\times 10^{4}$\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is based on standard, well-established theories in solid mechanics and materials science: LEFM for stress analysis, cohesive zone modeling for the fracture process, and the Larché–Cahn theory for stress-assisted diffusion. All equations provided are standard representations of these theories. The material parameters and boundary conditions are physically realistic for high-strength steel under typical environmental conditions. The problem is self-contained, providing all necessary information to proceed with a unique solution. The language is objective and technical. The problem is scientifically grounded, well-posed, and all data are dimensionally consistent.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. A full, reasoned solution will be provided.\n\n### Solution\n\nThe solution proceeds in two main parts as requested: first, determining the steady-state hydrogen concentration at the crack tip, and second, calculating the resulting reduction in fracture toughness.\n\n**Part 1: Calculation of Crack-Tip Hydrogen Concentration, $c_{\\text{tip}}$**\n\nThe calculation requires the hydrostatic stress at the crack tip, which in turn depends on the hydrogen-free fracture toughness, $K_{Ic}^{0}$. We must first compute this value.\n\n1.  **Calculate Hydrogen-Free Properties ($G_{c}^{0}$ and $K_{Ic}^{0}$)**\n    The plane strain modulus, $E'$, is:\n    $$E' = \\frac{E}{1 - \\nu^{2}} = \\frac{210 \\times 10^{9} \\, \\text{Pa}}{1 - (0.30)^{2}} = \\frac{210 \\times 10^{9} \\, \\text{Pa}}{0.91} \\approx 2.3077 \\times 10^{11} \\, \\text{Pa}$$\n    The hydrogen-free fracture energy, $G_{c}^{0}$, is:\n    $$G_{c}^{0} = \\frac{1}{2} T_{\\max}^{0} \\delta_{f} = \\frac{1}{2} (3.00 \\times 10^{9} \\, \\text{Pa}) (1.33 \\times 10^{-6} \\, \\text{m}) = 1995 \\, \\text{J/m}^2$$\n    The hydrogen-free fracture toughness, $K_{Ic}^{0}$, is then:\n    $$K_{Ic}^{0} = \\sqrt{E' G_{c}^{0}} = \\sqrt{(2.3077 \\times 10^{11} \\, \\text{Pa}) \\times (1995 \\, \\text{J/m}^2)} \\approx 2.1457 \\times 10^{7} \\, \\text{Pa}\\sqrt{\\text{m}}$$\n\n2.  **Calculate Hydrostatic Stress at the Cutoff Radius**\n    The problem states that hydrogen accumulation is driven by the stress field corresponding to $K_{I} = K_{Ic}^{0}$. The hydrostatic stress is evaluated at the process zone boundary $r = r_{c}$:\n    $$\\sigma_{h}(r_{c}) = \\frac{1 + \\nu}{3} \\frac{K_{Ic}^{0}}{\\sqrt{2 \\pi r_{c}}} = \\frac{1 + 0.30}{3} \\frac{2.1457 \\times 10^{7} \\, \\text{Pa}\\sqrt{\\text{m}}}{\\sqrt{2 \\pi (3.50 \\times 10^{-6} \\, \\text{m})}}$$\n    $$\\sigma_{h}(r_{c}) \\approx \\frac{1.3}{3} \\frac{2.1457 \\times 10^{7}}{4.6895 \\times 10^{-3}} \\, \\text{Pa} \\approx 1.9827 \\times 10^{9} \\, \\text{Pa}$$\n\n3.  **Calculate Crack-Tip Hydrogen Concentration, $c_{\\text{tip}}$**\n    At chemomechanical equilibrium, the chemical potential $\\mu$ is uniform. We equate the potential at the crack tip ($r = r_{c}$) with the potential in the far-field ($r \\to \\infty$, where $\\sigma_h = 0$):\n    $$\\mu^{0} + R T \\ln c_{\\text{tip}} - \\bar{V}_{H} \\sigma_{h}(r_{c}) = \\mu^{0} + R T \\ln c_{\\infty}$$\n    Rearranging gives the relationship for hydrogen accumulation, often called the stress-driven segregation law:\n    $$c_{\\text{tip}} = c_{\\infty} \\exp\\left(\\frac{\\bar{V}_{H} \\sigma_{h}(r_{c})}{R T}\\right)$$\n    We now substitute the known values. The term $RT$ is:\n    $$RT = (8.314 \\, \\text{J/(mol}\\cdot\\text{K)}) \\times (300 \\, \\text{K}) = 2494.2 \\, \\text{J/mol}$$\n    The exponential argument is:\n    $$\\frac{\\bar{V}_{H} \\sigma_{h}(r_{c})}{R T} = \\frac{(2.00 \\times 10^{-6} \\, \\text{m}^3\\text{/mol}) \\times (1.9827 \\times 10^{9} \\, \\text{Pa})}{2494.2 \\, \\text{J/mol}} \\approx 1.5898$$\n    The crack-tip hydrogen concentration is:\n    $$c_{\\text{tip}} = (1.50 \\times 10^{-6}) \\times \\exp(1.5898) \\approx (1.50 \\times 10^{-6}) \\times 4.9031 \\approx 7.3547 \\times 10^{-6}$$\n    Rounding to three significant figures, we get:\n    $$c_{\\text{tip}} \\approx 7.35 \\times 10^{-6}$$\n\n**Part 2: Calculation of Reduced Fracture Toughness, $K_{Ic}(c_{\\text{tip}})$**\n\n1.  **Calculate Hydrogen-Degraded Cohesive Strength**\n    Using the calculated $c_{\\text{tip}}$ and the given degradation law:\n    $$T_{\\max}(c_{\\text{tip}}) = T_{\\max}^{0} \\exp(-\\gamma c_{\\text{tip}}) = (3.00 \\times 10^{9} \\, \\text{Pa}) \\exp(-(5.00 \\times 10^{4}) \\times (7.3547 \\times 10^{-6}))$$\n    $$T_{\\max}(c_{\\text{tip}}) = (3.00 \\times 10^{9} \\, \\text{Pa}) \\exp(-0.3677) \\approx (3.00 \\times 10^{9} \\, \\text{Pa}) \\times 0.6923 \\approx 2.0769 \\times 10^{9} \\, \\text{Pa}$$\n\n2.  **Calculate Reduced Fracture Energy and Toughness**\n    Since $\\delta_{f}$ is unaffected, the hydrogen-degraded fracture energy $G_{c}(c_{\\text{tip}})$ is:\n    $$G_{c}(c_{\\text{tip}}) = \\frac{1}{2} T_{\\max}(c_{\\text{tip}}) \\delta_{f} = \\frac{1}{2} (2.0769 \\times 10^{9} \\, \\text{Pa}) (1.33 \\times 10^{-6} \\, \\text{m}) \\approx 1381.1 \\, \\text{J/m}^2$$\n    The corresponding reduced fracture toughness, $K_{Ic}(c_{\\text{tip}})$, is:\n    $$K_{Ic}(c_{\\text{tip}}) = \\sqrt{E' G_{c}(c_{\\text{tip}})} = \\sqrt{(2.3077 \\times 10^{11} \\, \\text{Pa}) \\times (1381.1 \\, \\text{J/m}^2)}$$\n    $$K_{Ic}(c_{\\text{tip}}) \\approx \\sqrt{3.1873 \\times 10^{14}} \\, \\text{Pa}\\sqrt{\\text{m}} \\approx 1.7853 \\times 10^{7} \\, \\text{Pa}\\sqrt{\\text{m}}$$\n    To express the result in units of $\\text{MPa}\\sqrt{\\text{m}}$, we divide by $10^{6}$:\n    $$K_{Ic}(c_{\\text{tip}}) \\approx 17.853 \\, \\text{MPa}\\sqrt{\\text{m}}$$\n    Rounding to three significant figures, we obtain:\n    $$K_{Ic}(c_{\\text{tip}}) \\approx 17.9 \\, \\text{MPa}\\sqrt{\\text{m}}$$\n\nThe final answers are $c_{\\text{tip}} \\approx 7.35 \\times 10^{-6}$ and $K_{Ic}(c_{\\text{tip}}) \\approx 17.9 \\, \\text{MPa}\\sqrt{\\text{m}}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n7.35 \\times 10^{-6} & 17.9\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Classical fatigue models based on Linear Elastic Fracture Mechanics (LEFM) often fail to predict the behavior of small cracks, whose growth is strongly influenced by microstructural features like grain boundaries. This exercise  tackles this \"short-crack problem\" by implementing a model that unifies the disparate behaviors of short and long cracks. You will derive and apply a crack-size-dependent threshold that bridges the gap between the material's intrinsic fatigue limit and the long-crack LEFM threshold, leading to more accurate fatigue life predictions.",
            "id": "3810161",
            "problem": "You are tasked with formulating and implementing a physically consistent model to capture deviations from Paris law behavior near threshold by explicitly incorporating microstructural barriers and short-crack effects through an intrinsic length scale, and to predict the effective threshold for fatigue crack growth. The setting is Linear Elastic Fracture Mechanics (LEFM) and the model must respect the transition from small-crack behavior governed by microstructural fatigue limits to long-crack behavior governed by stress intensity thresholds.\n\nUse the following foundational base statements, which are acceptable starting points:\n\n- The Mode I Stress Intensity Factor (SIF) for a through-thickness crack of length $a$ in a body with uniform stress amplitude $\\Delta\\sigma$ can be represented as $\\Delta K = Y\\,\\Delta\\sigma\\,\\sqrt{\\pi a}$, where $Y$ is a dimensionless geometry factor and $\\pi$ is the circle constant.\n- The Energy Release Rate is related to the SIF by $G = K^2/E'$, where $E'$ is the effective elastic modulus, with $E' = E$ for plane stress and $E' = E/(1-\\nu^2)$ for plane strain.\n- The Paris relation expresses the fatigue crack growth rate as a power law in the effective driving force, i.e., $da/dN = C\\,(\\Delta K_{\\mathrm{eff}})^m$, with $C$ and $m$ material parameters, where $\\Delta K_{\\mathrm{eff}}$ is a suitable effective SIF range accounting for thresholds and shielding.\n\nYour task is to derive and implement a consistent short-crack threshold model that introduces an intrinsic material length scale to represent microstructural barriers. The model must satisfy the following scientific realism and consistency requirements:\n\n1. The threshold behavior must transition smoothly between:\n   - A small-crack regime governed by a fatigue limit (endurance limit) $\\Delta\\sigma_e$ for a microstructure without macroscopic cracks, and\n   - A long-crack regime governed by a long-crack stress intensity threshold $\\Delta K_{\\mathrm{th,long}}$.\n2. The transition must be monotonic with respect to crack length $a$ and must be continuously differentiable, embodying a single intrinsic length scale that can be determined by matching the two regimes at an appropriate crossover without introducing discontinuities.\n3. The derived model must produce an effective threshold stress intensity range $\\Delta K_{\\mathrm{th,eff}}(a)$ that recovers the long-crack threshold as $a \\to \\infty$ and that permits growth of sufficiently short cracks even when $\\Delta K < \\Delta K_{\\mathrm{th,long}}$ if microstructural barriers are overcome.\n\nOnce you have derived the model and its intrinsic length scale, implement the following algorithm:\n\n- For each test case, compute the applied SIF range $\\Delta K = Y\\,\\Delta\\sigma\\,\\sqrt{\\pi a}$ in $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$.\n- Compute the effective threshold $\\Delta K_{\\mathrm{th,eff}}(a)$ in $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$ predicted by your model.\n- Compute the modified near-threshold growth rate $da/dN$ using the Paris relation with the effective driving force $\\max\\{\\Delta K - \\Delta K_{\\mathrm{th,eff}}(a),\\,0\\}$ in $\\mathrm{m}/\\mathrm{cycle}$.\n- For comparison, compute the classical Paris prediction using the long-crack threshold $\\max\\{\\Delta K - \\Delta K_{\\mathrm{th,long}},\\,0\\}$ in $\\mathrm{m}/\\mathrm{cycle}$.\n\nPhysical units must be respected as follows:\n- Express every stress amplitude $\\Delta\\sigma$ in $\\mathrm{MPa}$.\n- Express every crack length $a$ in $\\mathrm{m}$.\n- Express every stress intensity factor range $\\Delta K$ and threshold $\\Delta K_{\\mathrm{th,eff}}$ in $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$.\n- Express every growth rate $da/dN$ in $\\mathrm{m}/\\mathrm{cycle}$.\n\nUse the following material parameters and geometry factor for all test cases:\n- Long-crack threshold: $\\Delta K_{\\mathrm{th,long}} = 4.0\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$.\n- Fatigue limit: $\\Delta\\sigma_e = 100.0\\,\\mathrm{MPa}$.\n- Geometry factor: $Y = 1.0$.\n- Paris parameters: $C = 2.0\\times 10^{-10}$ with unit $\\mathrm{m}/(\\mathrm{cycle}\\cdot(\\mathrm{MPa}\\sqrt{\\mathrm{m}})^m)$ and $m = 3.0$.\n\nTest Suite:\nProvide results for the following five cases, chosen to probe diverse regimes:\n- Case A (happy path, moderately above long-crack threshold): $a = 0.002\\,\\mathrm{m}$, $\\Delta\\sigma = 60.0\\,\\mathrm{MPa}$.\n- Case B (short-crack effect enabling growth below long-crack threshold): $a = 5.0\\times 10^{-5}\\,\\mathrm{m}$, $\\Delta\\sigma = 100.0\\,\\mathrm{MPa}$.\n- Case C (long-crack, far above threshold): $a = 0.020\\,\\mathrm{m}$, $\\Delta\\sigma = 80.0\\,\\mathrm{MPa}$.\n- Case D (near-threshold boundary; long-crack prediction arrests, short-crack model allows slow growth): $a = 0.002\\,\\mathrm{m}$, $\\Delta\\sigma = 50.0\\,\\mathrm{MPa}$.\n- Case E (edge case below modified threshold; both models arrest): $a = 0.0005\\,\\mathrm{m}$, $\\Delta\\sigma = 50.0\\,\\mathrm{MPa}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case’s result must be a list of three floats in the order $[\\Delta K_{\\mathrm{th,eff}}(a),\\, (da/dN)_{\\mathrm{modified}},\\, (da/dN)_{\\mathrm{Paris}}]$, where $\\Delta K_{\\mathrm{th,eff}}(a)$ is in $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$ and both growth rates are in $\\mathrm{m}/\\mathrm{cycle}$. For example, the output should have the form $[[x_1,y_1,z_1],[x_2,y_2,z_2],\\dots]$ with no additional text.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of linear elastic fracture mechanics (LEFM) and addresses the well-documented phenomenon of short-crack behavior in fatigue. The provided parameters are physically consistent and the requirements for the model are well-posed, leading to a unique and standard solution.\n\nThe task is to formulate and implement a model for the effective fatigue crack growth threshold, $\\Delta K_{\\mathrm{th,eff}}(a)$, that unifies the behavior of short and long cracks. The model must smoothly transition between two regimes:\n$1$. The short-crack regime (as crack length $a \\to 0$), where growth is governed by the material's fatigue limit, $\\Delta\\sigma_e$. Growth occurs if the applied stress amplitude $\\Delta\\sigma$ exceeds this limit: $\\Delta\\sigma \\ge \\Delta\\sigma_e$.\n$2$. The long-crack regime (as $a \\to \\infty$), where growth is governed by the long-crack stress intensity factor threshold, $\\Delta K_{\\mathrm{th,long}}$. Growth occurs if the applied stress intensity factor range, $\\Delta K$, exceeds this threshold: $\\Delta K \\ge \\Delta K_{\\mathrm{th,long}}$.\n\nA well-established method to bridge these regimes is the El Haddad-Smith-Topper (EHST) model, which introduces an intrinsic material length scale, $a_0$. This length scale represents the characteristic size of microstructural features that act as inherent flaws. The model postulates that the effective crack length is the sum of the physical crack length $a$ and this intrinsic length $a_0$.\n\nThe driving force for crack growth is then expressed using this effective length, $a+a_0$, and growth is assumed to occur when this modified stress intensity factor reaches the long-crack threshold $\\Delta K_{\\mathrm{th,long}}$. The criterion is:\n$$\nY\\,\\Delta\\sigma\\,\\sqrt{\\pi(a+a_0)} \\ge \\Delta K_{\\mathrm{th,long}}\n$$\nThis single equation must be consistent with both limiting cases. We can determine the intrinsic length $a_0$ by enforcing the short-crack limit. As the physical crack length $a \\to 0$, the threshold stress for crack growth, $\\Delta\\sigma_{\\mathrm{th}}$, must approach the fatigue limit, $\\Delta\\sigma_e$. From the criterion above, the threshold stress is:\n$$\n\\Delta\\sigma_{\\mathrm{th}}(a) = \\frac{\\Delta K_{\\mathrm{th,long}}}{Y\\sqrt{\\pi(a+a_0)}}\n$$\nSetting $a=0$ and $\\Delta\\sigma_{\\mathrm{th}}(0) = \\Delta\\sigma_e$:\n$$\n\\Delta\\sigma_e = \\frac{\\Delta K_{\\mathrm{th,long}}}{Y\\sqrt{\\pi a_0}}\n$$\nSolving for the intrinsic length scale $a_0$:\n$$\n\\sqrt{\\pi a_0} = \\frac{\\Delta K_{\\mathrm{th,long}}}{Y\\,\\Delta\\sigma_e} \\implies a_0 = \\frac{1}{\\pi}\\left(\\frac{\\Delta K_{\\mathrm{th,long}}}{Y\\,\\Delta\\sigma_e}\\right)^2\n$$\nThis expression defines $a_0$ in terms of fundamental material properties, satisfying the requirement for a single, consistently defined intrinsic length scale.\n\nThe problem asks for an effective, crack-length-dependent threshold, $\\Delta K_{\\mathrm{th,eff}}(a)$, such that the growth condition is written in the standard form $\\Delta K \\ge \\Delta K_{\\mathrm{th,eff}}(a)$, where $\\Delta K = Y\\,\\Delta\\sigma\\,\\sqrt{\\pi a}$. We can derive $\\Delta K_{\\mathrm{th,eff}}(a)$ by finding the value of $\\Delta K$ at the threshold stress $\\Delta\\sigma_{\\mathrm{th}}(a)$:\n$$\n\\Delta K_{\\mathrm{th,eff}}(a) = Y\\,\\Delta\\sigma_{\\mathrm{th}}(a)\\,\\sqrt{\\pi a}\n$$\nSubstituting the expression for $\\Delta\\sigma_{\\mathrm{th}}(a)$:\n$$\n\\Delta K_{\\mathrm{th,eff}}(a) = Y\\left( \\frac{\\Delta K_{\\mathrm{th,long}}}{Y\\sqrt{\\pi(a+a_0)}} \\right)\\sqrt{\\pi a} = \\Delta K_{\\mathrm{th,long}}\\sqrt{\\frac{a}{a+a_0}}\n$$\nThis is the final form of our model for the effective threshold. Let us verify its properties:\n- As $a \\to \\infty$: $\\lim_{a\\to\\infty} \\Delta K_{\\mathrm{th,eff}}(a) = \\Delta K_{\\mathrm{th,long}}\\lim_{a\\to\\infty} \\sqrt{\\frac{1}{1+a_0/a}} = \\Delta K_{\\mathrm{th,long}}$. The model correctly recovers the long-crack threshold.\n- As $a \\to 0$: The growth condition $\\Delta K \\ge \\Delta K_{\\mathrm{th,eff}}(a)$ becomes $Y\\,\\Delta\\sigma\\,\\sqrt{\\pi a} \\ge \\Delta K_{\\mathrm{th,long}}\\sqrt{\\frac{a}{a+a_0}}$. This simplifies to $Y\\,\\Delta\\sigma\\,\\sqrt{\\pi(a+a_0)} \\ge \\Delta K_{\\mathrm{th,long}}$, which, as $a \\to 0$, yields $\\Delta\\sigma \\ge \\frac{\\Delta K_{\\mathrm{th,long}}}{Y\\sqrt{\\pi a_0}}$. By our definition of $a_0$, this is equivalent to $\\Delta\\sigma \\ge \\Delta\\sigma_e$. The model correctly recovers the fatigue limit criterion.\n- The function is continuously differentiable for $a>0$ and monotonic, thus ensuring a smooth transition between regimes.\n\nThe computational algorithm for each test case is as follows:\n$1$. Calculate the intrinsic length scale $a_0$ using the given material parameters:\n   - $\\Delta K_{\\mathrm{th,long}} = 4.0\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$\n   - $\\Delta\\sigma_e = 100.0\\,\\mathrm{MPa}$\n   - $Y = 1.0$\n   - $a_0 = \\frac{1}{\\pi}\\left(\\frac{4.0}{1.0 \\times 100.0}\\right)^2 = \\frac{0.0016}{\\pi}\\,\\mathrm{m}$\n$2$. For each test case with given crack length $a$ and stress amplitude $\\Delta\\sigma$:\n   a. Compute the applied stress intensity factor range: $\\Delta K = Y\\,\\Delta\\sigma\\,\\sqrt{\\pi a}$.\n   b. Compute the effective threshold from our derived model: $\\Delta K_{\\mathrm{th,eff}}(a) = \\Delta K_{\\mathrm{th,long}}\\sqrt{\\frac{a}{a+a_0}}$.\n   c. Compute the modified crack growth rate using the effective driving force $\\Delta K_{\\mathrm{drive,mod}} = \\max\\{\\Delta K - \\Delta K_{\\mathrm{th,eff}}(a),\\,0\\}$:\n      $$(da/dN)_{\\mathrm{modified}} = C \\left( \\Delta K_{\\mathrm{drive,mod}} \\right)^m$$\n   d. Compute the classical Paris law growth rate using the long-crack threshold and driving force $\\Delta K_{\\mathrm{drive,Paris}} = \\max\\{\\Delta K - \\Delta K_{\\mathrm{th,long}},\\,0\\}$:\n      $$(da/dN)_{\\mathrm{Paris}} = C \\left( \\Delta K_{\\mathrm{drive,Paris}} \\right)^m$$\n   e. The material parameters for the Paris law are $C = 2.0\\times 10^{-10}\\,\\mathrm{m}/(\\mathrm{cycle}\\cdot(\\mathrm{MPa}\\sqrt{\\mathrm{m}})^m)$ and $m=3.0$.\n\nThis procedure is implemented for each of the five test cases provided.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a short-crack threshold model for fatigue,\n    then computes results for a suite of test cases. The model unifies\n    the fatigue limit for short cracks with the LEFM threshold for long cracks.\n    \"\"\"\n\n    # --- Material Parameters and Constants ---\n    # Long-crack fatigue threshold in MPa*sqrt(m)\n    dK_th_long = 4.0\n    # Fatigue limit (endurance limit) in MPa\n    d_sigma_e = 100.0\n    # Geometry factor (dimensionless)\n    Y = 1.0\n    # Paris Law constant in m/(cycle * (MPa*sqrt(m))^m)\n    C = 2.0e-10\n    # Paris Law exponent (dimensionless)\n    m = 3.0\n\n    # --- Test Cases ---\n    # Each case is a tuple of (crack length a in m, stress amplitude d_sigma in MPa)\n    test_cases = [\n        # Case A: Happy path, moderately above long-crack threshold\n        (0.002, 60.0),\n        # Case B: Short-crack effect enabling growth below long-crack threshold\n        (5.0e-5, 100.0),\n        # Case C: Long-crack, far above threshold\n        (0.020, 80.0),\n        # Case D: Near-threshold boundary; arrest in classical, growth in modified\n        (0.002, 50.0),\n        # Case E: Edge case below modified threshold; both models arrest\n        (0.0005, 50.0),\n    ]\n\n    # --- Model Derivation and Calculation ---\n\n    # Calculate the intrinsic material length scale 'a0' (El Haddad parameter)\n    # a0 = (1/pi) * (dK_th_long / (Y * d_sigma_e))^2\n    a0 = (1 / np.pi) * (dK_th_long / (Y * d_sigma_e))**2\n\n    results = []\n    for a, d_sigma in test_cases:\n        # 1. Compute the applied Stress Intensity Factor (SIF) range, dK\n        # dK = Y * d_sigma * sqrt(pi * a)\n        dK_applied = Y * d_sigma * np.sqrt(np.pi * a)\n\n        # 2. Compute the effective threshold SIF range, dK_th_eff(a)\n        # dK_th_eff(a) = dK_th_long * sqrt(a / (a + a0))\n        dK_th_eff = dK_th_long * np.sqrt(a / (a + a0))\n\n        # 3. Compute the modified near-threshold growth rate (da/dN)_modified\n        # The driving force is the applied SIF minus the effective threshold.\n        # It must be non-negative.\n        dK_drive_modified = max(dK_applied - dK_th_eff, 0.0)\n        dadn_modified = C * (dK_drive_modified**m)\n\n        # 4. Compute the classical Paris prediction for comparison\n        # The driving force is the applied SIF minus the long-crack threshold.\n        # It must be non-negative.\n        dK_drive_paris = max(dK_applied - dK_th_long, 0.0)\n        dadn_paris = C * (dK_drive_paris**m)\n\n        # Store the results for this case\n        results.append([dK_th_eff, dadn_modified, dadn_paris])\n\n    # --- Final Output Formatting ---\n    # Convert each inner list of floats to its string representation\n    # and join them with commas, enclosed in an outer list.\n    # Ex: [[x1, y1, z1], [x2, y2, z2]] -> \"[[x1, y1, z1],[x2, y2, z2]]\"\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}