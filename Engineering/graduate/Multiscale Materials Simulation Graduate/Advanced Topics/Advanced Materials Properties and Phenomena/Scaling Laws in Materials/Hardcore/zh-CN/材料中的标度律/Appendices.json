{
    "hands_on_practices": [
        {
            "introduction": "在着手建立复杂的物理模型之前，量纲分析是一种强大的初步工具，可以揭示问题的基本结构。本练习将指导您应用白金汉 $\\Pi$ 定理，这是一个从一组物理变量中推导出无量纲参数（或 $\\Pi$ 群）的系统性方法。通过分析一个多孔固体中弹性波速的假设情景，您将练习如何将一个看似复杂的多变量问题简化为几个关键无量纲群之间的关系 。",
            "id": "3839296",
            "problem": "一道相速度为 $c$ 的弹性压缩波在一种均匀、各向同性、干燥的多孔固体中传播。在所关注的尺度上，该固体的有效行为由质量密度 $\\rho$、有效弹性模量 $E$、孔隙度 $\\phi$ 以及一个量化代表性孔隙尺寸的特征微观结构长度 $L$ 来表征。假设在所关注的频率下，没有额外的物理效应（如粘性阻力或流固耦合）起作用，因此唯一相关的基本量纲是质量、长度和时间。使用量纲齐次性原理和白金汉Pi定理，推导控制波速对这些变量依赖关系的最小独立无量纲数组。\n\n你的推导必须：\n- 确定变量集及其以质量、长度和时间表示的量纲。\n- 确定独立无量纲数组的数量。\n- 在基本量纲空间中选择一组具有满秩的合适的重复变量。\n- 构建独立无量纲数组并验证其独立性。\n\n将最终的最小无量纲数组以单行矩阵的形式报告，其中第一个条目选择为基于所列变量的无量纲波速。无需进行数值评估，报告的矩阵中不应包含任何单位。",
            "solution": "该问题经证实具有科学依据、提法恰当且客观。这是量纲分析在连续介质力学和材料科学领域中的一个标准应用。未发现任何缺陷。\n\n目标是推导控制压缩波相速度 $c$ 与多孔固体性质（质量密度 $\\rho$、弹性模量 $E$、孔隙度 $\\phi$ 和特征长度 $L$）之间关系的最小独立无量纲数组。我们将使用白金汉Pi定理。\n\n首先，我们确定相关变量及其以质量 ($M$)、长度 ($L$) 和时间 ($T$) 表示的基本量纲。总共有 $n=5$ 个变量。\n1.  相速度 $c$：$[c] = L T^{-1}$\n2.  质量密度 $\\rho$：$[\\rho] = M L^{-3}$\n3.  有效弹性模量 $E$：$[E] = M L^{-1} T^{-2}$（因为模量的单位是应力，即力/面积）\n4.  孔隙度 $\\phi$：$[\\phi] = 1$（无量纲，因为它是体积之比）\n5.  特征长度 $L$：$[L] = L$\n\n接下来，我们确定基本量纲的数量，即 $k=3$（质量 $M$、长度 $L$ 和时间 $T$）。根据白金汉Pi定理，独立无量纲数组（记为 $\\Pi$ 组）的数量由 $p = n - r$ 给出，其中 $r$ 是量纲矩阵的秩。变量 $\\{c, \\rho, E, L, \\phi\\}$ 的量纲矩阵为：\n$$\n\\begin{array}{c|ccccc}\n   c  \\rho  E  L  \\phi \\\\\n\\hline\nM  0  1  1  0  0 \\\\\nL  1  -3  -1  1  0 \\\\\nT  -1  0  -2  0  0\n\\end{array}\n$$\n该矩阵的秩 $r$ 是线性无关的行或列的数量。我们可以通过选择一个子矩阵并检查其行列式来求秩。对于 $\\{\\rho, E, c\\}$ 的子矩阵是：\n$$\n\\begin{pmatrix} 1  1  0 \\\\ -3  -1  1 \\\\ 0  -2  -1 \\end{pmatrix}\n$$\n行列式为 $1((-1)(-1) - (1)(-2)) - 1((-3)(-1) - (1)(0)) + 0 = 1(1+2) - 1(3) = 3 - 3 = 0$。这组变量在量纲上是相关的。让我们尝试集合 $\\{\\rho, E, L\\}$：\n$$\n\\begin{pmatrix} 1  1  0 \\\\ -3  -1  1 \\\\ 0  -2  0 \\end{pmatrix}\n$$\n行列式为 $1(0 - (-2)) - 1(0 - 0) + 0 = 2 \\neq 0$。因此，量纲矩阵的秩为 $r=3$。独立无量纲数组的数量为 $p = n-r = 5-3=2$。\n\n为了构建这两个数组，我们选择 $r=3$ 个重复变量。所选的重复变量集必须量纲独立（即，它们的量纲子矩阵的秩必须为 $3$）。根据上述计算，集合 $\\{\\rho, E, L\\}$ 是一个有效的选择。这些变量代表了系统的基本物理方面：质量、刚度和几何形状。剩下的变量是 $c$ 和 $\\phi$。我们将为这两个变量各构建一个 $\\Pi$ 组。\n\n第一个无量纲数组 $\\Pi_1$ 由相速度 $c$ 构成。问题指定该数组应为一个无量纲波速。\n$$\n\\Pi_1 = c^1 \\rho^a E^b L^d\n$$\n为使 $\\Pi_1$ 无量纲，等式右侧的量纲必须相互抵消。我们写出量纲方程：\n$$\n[ \\Pi_1 ] = M^0 L^0 T^0 = (L T^{-1})^1 (M L^{-3})^a (M L^{-1} T^{-2})^b (L)^d\n$$\n我们对每个基本量纲的指数建立方程：\n- $M$ 的指数：$0 = a + b$\n- $L$ 的指数：$0 = 1 - 3a - b + d$\n- $T$ 的指数：$0 = -1 - 2b$\n\n解这个线性方程组：\n从 $T$ 方程， $2b = -1 \\implies b = -\\frac{1}{2}$。\n从 $M$ 方程， $a = -b \\implies a = \\frac{1}{2}$。\n从 $L$ 方程， $d = 3a + b - 1 = 3(\\frac{1}{2}) + (-\\frac{1}{2}) - 1 = \\frac{3}{2} - \\frac{1}{2} - 1 = 1 - 1 = 0$。\n将这些指数代回 $\\Pi_1$ 的表达式中：\n$$\n\\Pi_1 = c^1 \\rho^{1/2} E^{-1/2} L^0 = c \\sqrt{\\frac{\\rho}{E}}\n$$\n这个数组代表了波速 $c$ 与介质中弹性波的特征速度 $\\sqrt{E/\\rho}$ 之比。这满足了对无量纲波速的要求。\n\n第二个无量纲数组 $\\Pi_2$ 由剩余的变量 $\\phi$（孔隙度）构成。\n$$\n\\Pi_2 = \\phi^1 \\rho^a E^b L^d\n$$\n由于 $\\phi$ 本身是无量纲的（$[\\phi]=1$），为使 $\\Pi_2$ 无量纲，重复变量的乘积也必须是无量纲的。由于 $\\{\\rho, E, L\\}$ 在量纲上是独立的，这只有在它们的指数全为零时才可能实现。\n$$\n[\\Pi_2] = 1 = (1)^1 (M L^{-3})^a (M L^{-1} T^{-2})^b (L)^d\n$$\n这要求 $a=0$，$b=0$，$d=0$。因此，第二个无量纲数组就是孔隙度本身：\n$$\n\\Pi_2 = \\phi\n$$\n\n控制该系统的最小独立无量纲数组集为 $\\{\\Pi_1, \\Pi_2\\}$。函数关系可以表示为 $f(\\Pi_1, \\Pi_2) = 0$ 或 $\\Pi_1 = g(\\Pi_2)$，这意味着 $c \\sqrt{\\rho/E} = g(\\phi)$。这是一个具有物理意义的结果，表明归一化波速是材料孔隙度的函数。推导出的两个数组 $\\Pi_1 = c \\sqrt{\\rho/E}$ 和 $\\Pi_2 = \\phi$ 显然是独立的，因为一个不能由另一个构成。\n\n最终的最小独立无量纲数组集为 $\\{ c \\sqrt{\\frac{\\rho}{E}}, \\phi \\}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} c \\sqrt{\\frac{\\rho}{E}}  \\phi \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "许多材料的标度律源于严格的均匀化理论，该理论将微观结构细节与宏观有效性能联系起来。本练习提供了一个经典的微观力学问题，要求您从第一性原理出发，推导在稀疏极限下复合材料有效模量的一阶修正。通过解决这个包含圆形夹杂物的理想化问题，您将亲身体验如何从微观场的解中提炼出宏观的标度关系 。",
            "id": "3839249",
            "problem": "考虑一个二维周期性复合材料代表性体积单元 (RVE)，它由一个单位正方形周期性胞元组成，其中包含一个半径为 $a$ 的中心圆形夹杂物，该夹杂物嵌入在基体中。设基体具有恒定的抗平面剪切模量（等效于标量电导率）$\\mu_{m}0$，夹杂物具有恒定的抗平面剪切模量 $\\mu_{i}0$。用 $\\phi=\\pi a^{2}$ 表示夹杂物面积分数，并假设在每个胞元有一个夹杂物的稀疏极限 $\\phi \\to 0$。\n\n在微观尺度上，面外位移 $u(x)$（等效于标量势）满足准静态线动量平衡方程（等效于稳态传导方程），\n$$\n\\nabla \\cdot \\left(\\mu\\left(\\frac{x}{\\varepsilon}\\right) \\nabla u(x)\\right)=0 \\quad \\text{in } \\mathbb{R}^{2},\n$$\n其中 $\\mu(y)$ 是 $Y$-周期函数，周期胞元为 $Y=[0,1]^{2}$，在以胞元中心为圆心、半径为 $a$ 的圆盘内部等于 $\\mu_{i}$，在周围的基体中等于 $\\mu_{m}$，且 $\\varepsilon0$ 是小尺度参数。均匀化（有效）模量 $\\mu^{\\ast}$ 由标准周期性均匀化胞元问题定义：对于给定的施加宏观单位梯度 $e \\in \\mathbb{R}^{2}$，求解零均值的 $Y$-周期性修正子 $w^{e}(y)$，使得\n$$\n\\nabla_{y} \\cdot \\left( \\mu(y) \\left( e + \\nabla_{y} w^{e}(y) \\right) \\right) = 0 \\quad \\text{in } Y,\n$$\n并定义\n$$\n\\mu^{\\ast} e = \\int_{Y} \\mu(y) \\left( e + \\nabla_{y} w^{e}(y) \\right) \\, \\mathrm{d}y,\n$$\n在此设定下，根据对称性，该定义简化为一个与 $e$ 无关的标量 $\\mu^{\\ast}$。\n\n从上述定义和控制方程出发，仅使用调和场的基本性质和界面条件（位移和面力的连续性），通过将周期性阵列替换为嵌入在无限大基体中的单个圆形夹杂物，并施加均匀的远场单位梯度 $e = e_{1}$，来分析稀疏极限 $\\phi \\to 0$。求解相应的传输问题，并确定 $\\mu^{\\ast}$ 对 $\\phi$ 的主阶依赖关系。\n\n具体而言，证明存在一个常数 $C(\\mu_{m},\\mu_{i})$ 使得\n$$\n\\mu^{\\ast}(\\phi) = \\mu_{m} + C(\\mu_{m},\\mu_{i}) \\, \\phi + o(\\phi) \\quad \\text{as } \\phi \\to 0,\n$$\n成立，并计算系数 $C(\\mu_{m},\\mu_{i})$ 的闭式解析表达式。\n\n你的最终答案必须是 $C(\\mu_{m},\\mu_{i})$ 的单一表达式。不需要进行数值计算。最终答案以无单位形式表示。",
            "solution": "### 问题验证\n该问题是关于一阶均匀化理论的一个经典应用，旨在计算稀疏极限下复合材料的有效属性。问题的表述在物理上和数学上都是合理的、适定的且客观的。所有必要的参数、方程和定义都已提供。\n\n### 求解推导\n\n目标是确定有效模量 $\\mu^{\\ast}$ 在夹杂物面积分数 $\\phi$ 较小时展开式中的系数 $C(\\mu_m, \\mu_i)$。问题要求使用稀疏极限近似，这涉及求解无限域中单个夹杂物周围的场。\n\n设域为 $\\mathbb{R}^2$，其中有一个以原点为中心、半径为 $a$ 的圆形夹杂物。当 $r \\to \\infty$ 时，位移场 $u(x)$ 趋近于宏观场 $e \\cdot x$。不失一般性，我们施加一个沿 $x_1$ 方向的单位梯度，即 $e=e_1=(1,0)$。因此，远场位移为 $u(x) \\to x_1 = r \\cos\\theta$。\n\n由于方程是线性的，我们可以将总位移场表示为远场和扰动场的叠加。在极坐标 $(r, \\theta)$ 中，位移场的一般解形式为：\n- 基体中（$r  a$）：$u_m(r, \\theta) = (r + A/r) \\cos\\theta$。这里 $r \\cos\\theta$ 是远场，$A/r \\cos\\theta$ 是由夹杂物引起的偶极子扰动场。\n- 夹杂物内（$r  a$）：$u_i(r, \\theta) = B r \\cos\\theta$。场在原点必须是正则的，因此不包含 $1/r$ 项。\n\n常数 $A$ 和 $B$ 由界面 $r=a$ 处的连续性条件确定：\n1.  **位移连续性**：$u_m(a, \\theta) = u_i(a, \\theta)$\n    $$ (a + A/a) \\cos\\theta = B a \\cos\\theta \\implies 1 + A/a^2 = B $$\n2.  **法向通量（面力）连续性**：$\\mu_m \\frac{\\partial u_m}{\\partial r} |_{r=a} = \\mu_i \\frac{\\partial u_i}{\\partial r} |_{r=a}$\n    $$ \\mu_m (1 - A/a^2) \\cos\\theta = \\mu_i B \\cos\\theta \\implies \\mu_m (1 - A/a^2) = \\mu_i B $$\n\n这是一个关于 $A$ 和 $B$ 的线性方程组。将第一个方程代入第二个方程：\n$$ \\mu_m(1 - A/a^2) = \\mu_i(1 + A/a^2) $$\n$$ \\mu_m - \\mu_i = (\\mu_m + \\mu_i) A/a^2 $$\n解得：\n$$ A = a^2 \\frac{\\mu_m - \\mu_i}{\\mu_m + \\mu_i} $$\n进而求得 $B$：\n$$ B = 1 + \\frac{A}{a^2} = 1 + \\frac{\\mu_m - \\mu_i}{\\mu_m + \\mu_i} = \\frac{(\\mu_m + \\mu_i) + (\\mu_m - \\mu_i)}{\\mu_m + \\mu_i} = \\frac{2\\mu_m}{\\mu_m + \\mu_i} $$\n常数 $B$ 代表了夹杂物内部的平均梯度与远场梯度之比。\n\n根据均匀化理论，有效模量 $\\mu^{\\ast}$ 定义为平均通量与平均梯度之间的比例关系：$\\langle \\mathbf{q} \\rangle = \\mu^{\\ast} \\langle \\nabla u \\rangle$。在我们的设定中，$\\langle \\nabla u \\rangle = e_1$。\n对于稀疏极限，有一个更直接的公式（也称为麦克斯韦方法或Eshelby方法的一阶展开）：\n$$ \\mu^{\\ast} \\approx \\mu_m + \\phi (\\mu_i - \\mu_m) \\frac{\\langle |\\nabla u \\rangle_{\\text{inclusion}}}{|e|} $$\n由于夹杂物内部的场是均匀的（$\\nabla u_i = B e_1$），夹杂物内部的平均梯度就是 $B e_1$。因此，平均梯度与远场梯度之比为 $B$。\n$$ \\mu^{\\ast} \\approx \\mu_m + \\phi (\\mu_i - \\mu_m) B $$\n将我们求得的 $B$ 代入：\n$$ \\mu^{\\ast} = \\mu_m + \\phi (\\mu_i - \\mu_m) \\frac{2\\mu_m}{\\mu_m + \\mu_i} + O(\\phi^2) $$\n将此结果与目标形式 $\\mu^{\\ast}(\\phi) = \\mu_m + C(\\mu_m, \\mu_i) \\phi + o(\\phi)$ 进行比较，我们可以确定系数 $C(\\mu_m, \\mu_i)$：\n$$ C(\\mu_m, \\mu_i) = (\\mu_i - \\mu_m) \\frac{2\\mu_m}{\\mu_m + \\mu_i} = \\frac{2\\mu_m(\\mu_i - \\mu_m)}{\\mu_i + \\mu_m} $$\n这就是所求的系数。",
            "answer": "$$ \\boxed{\\frac{2\\mu_{m}(\\mu_{i}-\\mu_{m})}{\\mu_{i}+\\mu_{m}}} $$"
        },
        {
            "introduction": "理论推导的标度律在计算材料科学中有着至关重要的应用，尤其是在处理模拟数据时。分子动力学等计算模拟由于计算域尺寸有限，其结果会包含系统性偏差。本练习将引导您扮演计算科学家的角色，使用从统计第一性原理（最大似然估计）导出的加权最小二乘法，来分析一组模拟数据，通过有限尺寸标度律将结果外推至宏观体积极限，并对外推值进行不确定性量化 。",
            "id": "3839284",
            "problem": "考虑在周期性边界条件下，平衡分子动力学（MD）模拟中的有限尺寸效应。在线性尺寸为 $L$ 或粒子数为 $N$ 的有限模拟区域中测量的许多热物理性质，由于流体力学模式的量子化和长程相关性，会偏离其体相（无限尺寸）极限。在Lennard-Jones约化单位（无量纲）下，假设主导的有限尺寸偏差由一个单一的小参数控制，该参数与逆线性尺寸 $1/L$ 或逆粒子数 $1/N$ 成比例。并且，对于某些输运系数，其来自于高阶流体力学贡献的次级修正项包含 $1/L^3$。根据中心极限定理，在不同尺寸下观测到的MD估计值 $y_i$ 具有独立的、因有限采样而产生的近似高斯分布的不确定度 $\\sigma_i$。\n\n你的任务是从基本原理出发，通过使用合适的标度变量移除主导的有限尺寸偏差，从而为体相性质 $y_{\\infty}$ 推导出一个统计上一致的估计量。你必须假设以下几点：\n- 对于每个数据集，在主导修正项起作用的邻域内，测量性质与所选标度变量之间存在一个潜在的线性关系。\n- 所报告的标准误差 $\\sigma_i$ 是已知的，并对应于 $y_i$ 上的独立高斯噪声。\n- 目标是在标度变量趋于零的极限下，估计该线性关系的y轴截距 $y_{\\infty}$。\n\n你必须设计一个算法，针对以下每种情况，根据标度变量构建合适的线性设计矩阵，在高斯噪声假设下对 $y_{\\infty}$ 进行统计最优估计，并从该估计量的抽样分布中推导出 $y_{\\infty}$ 的不确定度。你的最终程序必须为每个测试用例计算并返回一个数对，该数对包含估计的 $y_{\\infty}$ 及其标准不确定度。所有量均被视为无量纲的（Lennard-Jones约化单位），因此无需进行物理单位转换。\n\n以下测试套件定义了五种情况。每种情况都指定了要使用的标度形式，并提供了原始的MD估计值及其不确定度：\n- 情况 A (使用 $1/L$ 标度)：尺寸 $L \\in \\{\\,10,12,16,20,24,32\\,\\}$，测量值 $y \\in \\{\\,0.2062,\\,0.1921,\\,0.1739,\\,0.1658,\\,0.1580,\\,0.1509\\,\\}$，标准误差 $\\sigma \\in \\{\\,0.0040,\\,0.0035,\\,0.0030,\\,0.0025,\\,0.0022,\\,0.0020\\,\\}$。\n- 情况 B (使用 $1/N$ 标度)：粒子数 $N \\in \\{\\,500,\\,1000,\\,2000,\\,4000,\\,8000\\,\\}$，测量值 $y \\in \\{\\,7.38,\\,6.23,\\,5.58,\\,5.31,\\,5.16\\,\\}$，标准误差 $\\sigma \\in \\{\\,0.060,\\,0.050,\\,0.045,\\,0.040,\\,0.040\\,\\}$。\n- 情况 C (使用组合 $1/L$ 和 $1/L^3$ 标度)：尺寸 $L \\in \\{\\,8,\\,10,\\,12,\\,14,\\,16,\\,20,\\,24\\,\\}$，测量值 $y \\in \\{\\,2.2840,\\,2.3020,\\,2.2960,\\,2.2930,\\,2.2860,\\,2.2710,\\,2.2620\\,\\}$，标准误差 $\\sigma \\in \\{\\,0.0060,\\,0.0060,\\,0.0055,\\,0.0050,\\,0.0050,\\,0.0045,\\,0.0045\\,\\}$。\n- 情况 D (边缘情况，最少数据；使用 $1/L$ 标度)：尺寸 $L \\in \\{\\,40,\\,60\\,\\}$，测量值 $y \\in \\{\\,1.5200,\\,1.5140\\,\\}$，标准误差 $\\sigma \\in \\{\\,0.0100,\\,0.0100\\,\\}$。\n- 情况 E (使用 $1/N$ 标度且呈递增趋势)：粒子数 $N \\in \\{\\,200,\\,400,\\,800,\\,1600\\,\\}$，测量值 $y \\in \\{\\,0.2600,\\,0.5100,\\,0.6200,\\,0.6890\\,\\}$，标准误差 $\\sigma \\in \\{\\,0.0200,\\,0.0150,\\,0.0120,\\,0.0100\\,\\}$。\n\n对于每种情况，根据所选的标度变量构建一个线性模型，其截距为 $y_{\\infty}$：\n- 对于 $1/L$ 标度，使用回归量 $[\\,1,\\,1/L\\,]$。\n- 对于 $1/N$ 标度，使用回归量 $[\\,1,\\,1/N\\,]$。\n- 对于 $L$ 的组合标度，使用回归量 $[\\,1,\\,1/L,\\,1/L^3\\,]$。\n\n假设每个 $y_i$ 都具有独立的、标准差为已知值 $\\sigma_i$ 的高斯误差，并从第一性原理推导出 $y_{\\infty}$ 的最大似然估计量及其标准不确定度，不要引用任何预先推导出的简化公式。然后相应地实现该估计量。\n\n你的程序必须在没有任何用户输入的情况下执行，并按指定顺序处理所有五种情况。最终输出格式必须是包含五个条目（每个情况一个）的单行列表，其中每个条目是一个双元素列表 $[\\,y_{\\infty},\\,u(y_{\\infty})\\,]$，两个数字都四舍五入到小数点后恰好六位。例如，一个有效的整体输出格式是 $[\\,[\\,0.123456,0.000789\\,],\\,[\\,\\dots\\,],\\,[\\,\\dots\\,],\\,[\\,\\dots\\,],\\,[\\,\\dots\\,]\\,]$。",
            "solution": "该问题要求推导并实现一个统计最优估计量，用于从一系列有限尺寸的分子动力学模拟结果中，将一个物理性质外推到其无限尺寸极限 ($y_{\\infty}$)。这个问题是适定的，并且其科学基础在于统计力学和估计理论的原理。\n\n所提供的数据包含一组在不同系统尺寸下进行的测量值 $\\{y_i\\}$，尺寸由线性维度 $L_i$ 或粒子数 $N_i$ 表征。每次测量 $y_i$ 都有一个已知的、独立的高斯不确定度 $\\sigma_i$。有限尺寸效应通过一个关于特定标度变量（从 $L_i$ 或 $N_i$ 导出）的线性模型来描述。该线性模型的一般形式为：\n$$ y_i = \\beta_0 + \\sum_{j=1}^{p-1} \\beta_j x_{ij} + \\epsilon_i $$\n在这里，$\\beta_0$ 代表所求的体相性质 $y_{\\infty}$，$\\{x_{ij}\\}$ 是第 $i$ 次测量的 $p-1$ 个标度变量的值，$\\{\\beta_j\\}_{j=1}^{p-1}$ 是相应的标度系数，而 $\\epsilon_i$ 是第 $i$ 次测量的随机误差。问题陈述 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma_i^2)$，其中 $\\mathcal{N}$ 表示正态分布。\n\n用矩阵表示法，对于 $n$ 个观测值，模型可以表示为：\n$$ \\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon} $$\n其中 $\\mathbf{y} = [y_1, \\dots, y_n]^T$ 是观测值的 $n \\times 1$ 向量，$\\mathbf{X}$ 是 $n \\times p$ 的设计矩阵，其行向量为 $[1, x_{i1}, \\dots, x_{i,p-1}]$，$\\boldsymbol{\\beta} = [\\beta_0, \\beta_1, \\dots, \\beta_{p-1}]^T$ 是待估参数的 $p \\times 1$ 向量，$\\boldsymbol{\\epsilon} = [\\epsilon_1, \\dots, \\epsilon_n]^T$ 是独立随机误差的向量。误差的协方差矩阵 $\\text{Cov}(\\boldsymbol{\\epsilon})$ 是一个对角矩阵，其元素为 $\\text{Cov}(\\boldsymbol{\\epsilon})_{ii} = \\sigma_i^2$。\n\n为了从第一性原理推导统计最优估计量，我们采用最大似然估计（MLE）方法。对于单个观测值 $y_i$，给定参数 $\\boldsymbol{\\beta}$，其概率密度函数（PDF）为：\n$$ f(y_i|\\boldsymbol{\\beta}, \\sigma_i) = \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\exp\\left( -\\frac{(y_i - (\\mathbf{X}\\boldsymbol{\\beta})_i)^2}{2\\sigma_i^2} \\right) $$\n由于观测值是独立的，整个数据集 $\\mathbf{y}$ 的联合似然函数是各单个PDF的乘积：\n$$ \\mathcal{L}(\\boldsymbol{\\beta}|\\mathbf{y}) = \\prod_{i=1}^n f(y_i|\\boldsymbol{\\beta}, \\sigma_i) = \\left( \\prod_{i=1}^n \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\right) \\exp\\left( -\\frac{1}{2} \\sum_{i=1}^n \\frac{(y_i - (\\mathbf{X}\\boldsymbol{\\beta})_i)^2}{\\sigma_i^2} \\right) $$\n最大化似然函数 $\\mathcal{L}(\\boldsymbol{\\beta})$ 等价于最大化其对数，即对数似然函数 $\\ln \\mathcal{L}(\\boldsymbol{\\beta})$：\n$$ \\ln \\mathcal{L}(\\boldsymbol{\\beta}) = \\text{const} - \\frac{1}{2} \\sum_{i=1}^n \\left( \\frac{y_i - (\\mathbf{X}\\boldsymbol{\\beta})_i}{\\sigma_i} \\right)^2 $$\n为了最大化 $\\ln \\mathcal{L}(\\boldsymbol{\\beta})$，我们必须最小化加权残差平方和 $\\chi^2$：\n$$ \\chi^2(\\boldsymbol{\\beta}) = \\sum_{i=1}^n w_i (y_i - (\\mathbf{X}\\boldsymbol{\\beta})_i)^2 $$\n其中权重为 $w_i = 1/\\sigma_i^2$。这就是加权最小二乘法（WLS）的原理。以矩阵形式，定义一个对角权重矩阵 $\\mathbf{W}$，其元素为 $W_{ii} = w_i$，则表达式变为：\n$$ \\chi^2(\\boldsymbol{\\beta}) = (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta})^T \\mathbf{W} (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta}) $$\n为了找到最小化 $\\chi^2$ 的参数向量 $\\hat{\\boldsymbol{\\beta}}$，我们对 $\\boldsymbol{\\beta}$ 求导并令梯度为零：\n$$ \\frac{\\partial \\chi^2}{\\partial \\boldsymbol{\\beta}} = -2 \\mathbf{X}^T \\mathbf{W} \\mathbf{y} + 2 \\mathbf{X}^T \\mathbf{W} \\mathbf{X} \\boldsymbol{\\beta} = \\mathbf{0} $$\n这就得到了WLS正规方程组：\n$$ (\\mathbf{X}^T \\mathbf{W} \\mathbf{X}) \\hat{\\boldsymbol{\\beta}} = \\mathbf{X}^T \\mathbf{W} \\mathbf{y} $$\n估计参数的解为：\n$$ \\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{y} $$\n这个 $\\hat{\\boldsymbol{\\beta}}$ 就是最大似然估计量。其第一个分量 $\\hat{\\beta}_0$ 是我们对 $y_{\\infty}$ 的估计。\n\n接下来，我们推导这个估计量的不确定度。不确定度由参数的标准差给出，即参数协方差矩阵 $\\text{Cov}(\\hat{\\boldsymbol{\\beta}})$ 对角线元素的平方根。\n$$ \\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{y} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} (\\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}) = \\boldsymbol{\\beta} + (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\boldsymbol{\\epsilon} $$\n$\\hat{\\boldsymbol{\\beta}}$ 的协方差矩阵是 $\\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\mathbb{E}[(\\hat{\\boldsymbol{\\beta}}-\\boldsymbol{\\beta})(\\hat{\\boldsymbol{\\beta}}-\\boldsymbol{\\beta})^T]$。代入 $\\hat{\\boldsymbol{\\beta}}-\\boldsymbol{\\beta}$ 的表达式：\n$$ \\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\mathbb{E}[ ( (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\boldsymbol{\\epsilon} ) ( ( \\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\boldsymbol{\\epsilon} )^T ] $$\n$$ \\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbb{E}[\\boldsymbol{\\epsilon}\\boldsymbol{\\epsilon}^T] \\mathbf{W}^T \\mathbf{X} ((\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1})^T $$\n根据定义，误差的协方差矩阵 $\\mathbb{E}[\\boldsymbol{\\epsilon}\\boldsymbol{\\epsilon}^T]$ 是 $\\mathbf{W}^{-1}$。因为 $\\mathbf{W}$ 是对角矩阵，所以 $\\mathbf{W}^T = \\mathbf{W}$。并且 $\\mathbf{X}^T \\mathbf{W} \\mathbf{X}$ 是对称的，所以其逆矩阵也是对称的。\n$$ \\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} (\\mathbf{W}^{-1}) \\mathbf{W} \\mathbf{X} (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} $$\n$$ \\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} (\\mathbf{X}^T \\mathbf{W} \\mathbf{X}) (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} $$\n$$ \\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} $$\n这个基本结果给出了估计参数的协方差矩阵。体相性质的估计值为 $y_{\\infty} = \\hat{\\beta}_0$，其标准不确定度为 $u(y_{\\infty}) = \\sqrt{\\text{Cov}(\\hat{\\boldsymbol{\\beta}})_{00}}$。\n\n将要实现的算法如下：\n1. 对于每种情况，根据指定的标度变量，构建观测向量 $\\mathbf{y}$、标准误差向量 $\\boldsymbol{\\sigma}$ 和设计矩阵 $\\mathbf{X}$。\n2. 构建对角权重矩阵 $\\mathbf{W}$，其元素为 $W_{ii} = 1/\\sigma_i^2$。\n3. 计算矩阵 $\\mathbf{A} = \\mathbf{X}^T \\mathbf{W} \\mathbf{X}$ 和向量 $\\mathbf{b} = \\mathbf{X}^T \\mathbf{W} \\mathbf{y}$。\n4. 计算 $\\mathbf{A}$ 的逆矩阵，即协方差矩阵：$\\mathbf{C} = \\mathbf{A}^{-1} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1}$。\n5. 计算参数向量的估计值：$\\hat{\\boldsymbol{\\beta}} = \\mathbf{C} \\mathbf{b}$。\n6. 体相性质的估计值是 $\\hat{\\boldsymbol{\\beta}}$ 的第一个元素，$y_{\\infty} = \\hat{\\beta}_0$。\n7. 该估计的不确定度是 $\\mathbf{C}$ 的第一个对角元素的平方根，$u(y_{\\infty}) = \\sqrt{C_{00}}$。\n此过程将应用于所有五个测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the bulk property and its uncertainty for five different cases\n    of finite-size scaling in molecular dynamics simulations.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: 1/L scaling\n        {\n            \"scaling_vars\": [\"1/L\"],\n            \"L\": np.array([10, 12, 16, 20, 24, 32]),\n            \"N\": None,\n            \"y\": np.array([0.2062, 0.1921, 0.1739, 0.1658, 0.1580, 0.1509]),\n            \"sigma\": np.array([0.0040, 0.0035, 0.0030, 0.0025, 0.0022, 0.0020]),\n        },\n        # Case B: 1/N scaling\n        {\n            \"scaling_vars\": [\"1/N\"],\n            \"L\": None,\n            \"N\": np.array([500, 1000, 2000, 4000, 8000]),\n            \"y\": np.array([7.38, 6.23, 5.58, 5.31, 5.16]),\n            \"sigma\": np.array([0.060, 0.050, 0.045, 0.040, 0.040]),\n        },\n        # Case C: 1/L and 1/L^3 scaling\n        {\n            \"scaling_vars\": [\"1/L\", \"1/L^3\"],\n            \"L\": np.array([8, 10, 12, 14, 16, 20, 24]),\n            \"N\": None,\n            \"y\": np.array([2.2840, 2.3020, 2.2960, 2.2930, 2.2860, 2.2710, 2.2620]),\n            \"sigma\": np.array([0.0060, 0.0060, 0.0055, 0.0050, 0.0050, 0.0045, 0.0045]),\n        },\n        # Case D: edge case, 1/L scaling\n        {\n            \"scaling_vars\": [\"1/L\"],\n            \"L\": np.array([40, 60]),\n            \"N\": None,\n            \"y\": np.array([1.5200, 1.5140]),\n            \"sigma\": np.array([0.0100, 0.0100]),\n        },\n        # Case E: 1/N scaling with increasing trend\n        {\n            \"scaling_vars\": [\"1/N\"],\n            \"L\": None,\n            \"N\": np.array([200, 400, 800, 1600]),\n            \"y\": np.array([0.2600, 0.5100, 0.6200, 0.6890]),\n            \"sigma\": np.array([0.0200, 0.0150, 0.0120, 0.0100]),\n        },\n    ]\n\n    results_list = []\n    \n    for case in test_cases:\n        y_obs = case[\"y\"]\n        sigmas = case[\"sigma\"]\n        n_points = len(y_obs)\n\n        # Construct the Design Matrix X\n        num_params = 1 + len(case[\"scaling_vars\"])\n        X = np.zeros((n_points, num_params))\n        X[:, 0] = 1.0  # Intercept term\n\n        col_idx = 1\n        for var in case[\"scaling_vars\"]:\n            if var == \"1/L\":\n                X[:, col_idx] = 1.0 / case[\"L\"]\n            elif var == \"1/N\":\n                X[:, col_idx] = 1.0 / case[\"N\"]\n            elif var == \"1/L^3\":\n                X[:, col_idx] = 1.0 / (case[\"L\"] ** 3)\n            col_idx += 1\n\n        # Construct the Weight Matrix W\n        W = np.diag(1.0 / sigmas**2)\n\n        # Apply the Weighted Least Squares (WLS) formulas derived from MLE\n        # Covariance matrix of parameters is (X^T * W * X)^-1\n        XT_W_X = X.T @ W @ X\n        cov_beta = np.linalg.inv(XT_W_X)\n        \n        # Parameter estimates are (X^T * W * X)^-1 * X^T * W * y\n        XT_W_y = X.T @ W @ y_obs\n        beta_hat = cov_beta @ XT_W_y\n\n        # The estimated bulk property y_inf is the first parameter (intercept)\n        y_inf = beta_hat[0]\n        \n        # The uncertainty is the square root of the first diagonal element of the covariance matrix\n        u_y_inf = np.sqrt(cov_beta[0, 0])\n\n        results_list.append([round(y_inf, 6), round(u_y_inf, 6)])\n\n    # Format the final list of lists into the required string representation for output\n    # This matches the example format provided in the problem description.\n    result_str_parts = [f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in results_list]\n    final_output_string = f\"[{','.join(result_str_parts)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}