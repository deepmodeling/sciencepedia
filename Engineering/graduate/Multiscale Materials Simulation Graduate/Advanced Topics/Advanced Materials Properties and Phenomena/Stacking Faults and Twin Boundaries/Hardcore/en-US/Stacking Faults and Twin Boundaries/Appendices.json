{
    "hands_on_practices": [
        {
            "introduction": "This practice focuses on the crucial first step of any reliable simulation: designing the computational experiment. You will develop a workflow to select the key parameters for a Density Functional Theory (DFT) calculation, ensuring that the computed stacking fault energy is converged and free from numerical artifacts. This exercise builds foundational skills in computational due diligence, which is essential for producing physically meaningful results .",
            "id": "3840535",
            "problem": "You are tasked with designing a numerical workflow, grounded in first principles, to select computational parameters for computing the stacking fault energy per unit area $\\gamma_{\\mathrm{sf}}$ in a Face-Centered Cubic (FCC) metal using Density Functional Theory (DFT). The workflow must produce recommendations for the Monkhorst-Pack (MP) $k$-point mesh, plane-wave kinetic energy cutoff, supercell thickness along the $(111)$ direction, the number of layers to relax near the fault, and convergence checks to suppress spurious interactions between periodically repeated faults. Your program must implement the following mathematical model and rules to determine these parameters.\n\nFundamental base and core definitions:\n- The FCC conventional cubic lattice has lattice parameter $a$ (in $\\mathrm{\\AA}$). The $(111)$ plane is spanned by two real-space vectors $u_1 = \\frac{a}{2}(1,-1,0)$ and $u_2 = \\frac{a}{2}(1,0,-1)$, which have magnitude $|u_1| = |u_2| = \\frac{a}{\\sqrt{2}}$ and an angle of $60^\\circ$ between them. The interplanar spacing for $(111)$ is $d_{111} = \\frac{a}{\\sqrt{3}}$. The vector normal to the $(111)$ plane of one interplanar spacing is $u_3 = \\frac{a}{3}(1,1,1)$, which has magnitude $|u_3| = d_{111}$.\n- A supercell with $m$ and $n$ repetitions in-plane and $N$ atomic layers along the $(111)$ direction has real-space lattice matrix $A = [m u_1, n u_2, N u_3]$, with columns as the three lattice vectors (units in $\\mathrm{\\AA}$).\n- The reciprocal lattice matrix is $B = 2\\pi A^{-T}$ with columns $b_1$, $b_2$, and $b_3$ (units in $\\mathrm{\\AA}^{-1}$).\n- The Monkhorst-Pack grid $N_k = (N_{k,1}, N_{k,2}, N_{k,3})$ is chosen such that $N_{k,i} \\ge 1$ and the spacing along each reciprocal lattice direction satisfies $\\Delta k_i = \\frac{|b_i|}{N_{k,i}} \\le \\Delta k_{\\mathrm{target}}$ (units in $\\mathrm{\\AA}^{-1}$). Thus, $N_{k,i} = \\left\\lceil \\frac{|b_i|}{\\Delta k_{\\mathrm{target}}} \\right\\rceil$.\n- The plane-wave kinetic energy cutoff $E_{\\mathrm{cut}}$ is determined by a maximum reciprocal vector magnitude $G_{\\max}$ through $E_{\\mathrm{cut}} = \\frac{\\hbar^2 G_{\\max}^2}{2 m_e}$, where $\\hbar$ is the reduced Planck constant and $m_e$ is the electron mass. By the Nyquist sampling principle, choose $G_{\\max} = \\frac{\\pi}{h}$, where $h$ is a target real-space grid spacing. To resolve pseudopotential features with a core radius $r_c$ (in $\\mathrm{\\AA}$), set $h = \\frac{r_c}{s_{\\mathrm{margin}}}$ for a safety margin $s_{\\mathrm{margin}} > 1$. Express $E_{\\mathrm{cut}}$ in electronvolts (eV), rounded to one decimal place.\n- The stacking fault is generated by a Shockley partial dislocation with Burgers vector magnitude $b = \\frac{a}{\\sqrt{6}}$. Within a screened medium, residual image interactions between periodically repeated faults can be modeled to decay exponentially with supercell thickness. Let the finite-size correction to the stacking fault energy be modeled as\n$$\n\\gamma(N) = \\gamma_{\\infty} + C \\exp\\!\\left(-\\frac{N d_{111}}{\\lambda}\\right),\n$$\nwhere $\\gamma_{\\infty}$ is the converged stacking fault energy (in $\\mathrm{mJ/m^2}$), $C$ is the amplitude of the leading correction (in $\\mathrm{mJ/m^2}$), and $\\lambda$ is a characteristic decay length (in $\\mathrm{\\AA}$).\n- Convergence for the supercell thickness $N$ is achieved when both conditions hold simultaneously:\n  1. The change in $\\gamma(N)$ upon increasing the layer count by $\\Delta N$ is below a tolerance $\\delta_{\\gamma}$:\n  $$\n  \\left|\\gamma(N+\\Delta N) - \\gamma(N)\\right| \\le \\delta_{\\gamma}.\n  $$\n  2. The displacement amplitude at the periodic image boundary, modeled as\n  $$\n  u_{\\mathrm{boundary}}(N) = \\frac{b}{2} \\exp\\!\\left(-\\frac{N d_{111}}{\\lambda}\\right),\n  $$\n  is below a threshold $u_{\\mathrm{tol}}$ (in $\\mathrm{\\AA}$).\n- The relaxation protocol specifies that only a subset of layers around the stacking fault are allowed to relax. Let the relaxation thickness be $t_{\\mathrm{relax}} = \\alpha_{\\mathrm{relax}} \\lambda$ (in $\\mathrm{\\AA}$), and the corresponding number of relaxable layers is $n_{\\mathrm{relax}} = \\left\\lceil \\frac{t_{\\mathrm{relax}}}{d_{111}} \\right\\rceil$. The remaining layers are kept fixed to emulate bulk-like boundary conditions.\n\nAlgorithmic requirements:\n- Given inputs $(a, m, n, \\Delta k_{\\mathrm{target}}, r_c, s_{\\mathrm{margin}}, \\lambda, \\gamma_{\\infty}, C, \\delta_{\\gamma}, u_{\\mathrm{tol}}, N_{\\min}, N_{\\max}, \\Delta N, \\alpha_{\\mathrm{relax}})$, your program must:\n  1. Compute $d_{111}$ and $b$.\n  2. Iterate $N$ from $N_{\\min}$ to $N_{\\max}$ in steps of $\\Delta N$ to find the smallest $N$ for which both convergence criteria are satisfied. If no such $N$ exists, set $N = N_{\\max}$ and mark the run as not converged.\n  3. With the chosen $N$, build $A$ and $B$, then compute the MP grid $N_k$ using the $\\Delta k_{\\mathrm{target}}$ criterion.\n  4. Compute $E_{\\mathrm{cut}}$ using the Nyquist relation and the given $r_c$ and $s_{\\mathrm{margin}}$, and express $E_{\\mathrm{cut}}$ in eV rounded to one decimal place.\n  5. Compute $n_{\\mathrm{relax}}$ using $t_{\\mathrm{relax}} = \\alpha_{\\mathrm{relax}} \\lambda$.\n- Physical units: $a$, $r_c$, $\\lambda$, $u_{\\mathrm{tol}}$ are in $\\mathrm{\\AA}$; $\\Delta k_{\\mathrm{target}}$ is in $\\mathrm{\\AA}^{-1}$; $\\gamma_{\\infty}$, $C$, and $\\delta_{\\gamma}$ are in $\\mathrm{mJ/m^2}$; $E_{\\mathrm{cut}}$ is in eV.\n- Angle unit: The algorithm implicitly uses radians in trigonometric relations.\n\nTest suite and parameters:\n- Case 1 (happy path, aluminum-like):\n  - $a = 4.05\\,\\mathrm{\\AA}$, $m = 3$, $n = 3$, $\\Delta k_{\\mathrm{target}} = 0.025\\,\\mathrm{\\AA}^{-1}$,\n  - $r_c = 1.25\\,\\mathrm{\\AA}$, $s_{\\mathrm{margin}} = 2.5$,\n  - $\\lambda = 2.0\\,\\mathrm{\\AA}$, $\\gamma_{\\infty} = 150.0\\,\\mathrm{mJ/m^2}$, $C = 50.0\\,\\mathrm{mJ/m^2}$,\n  - $\\delta_{\\gamma} = 1.0\\,\\mathrm{mJ/m^2}$, $u_{\\mathrm{tol}} = 0.010\\,\\mathrm{\\AA}$,\n  - $N_{\\min} = 12$, $N_{\\max} = 40$, $\\Delta N = 2$, $\\alpha_{\\mathrm{relax}} = 3.0$.\n- Case 2 (different lattice and tolerances, nickel-like):\n  - $a = 3.52\\,\\mathrm{\\AA}$, $m = 4$, $n = 4$, $\\Delta k_{\\mathrm{target}} = 0.030\\,\\mathrm{\\AA}^{-1}$,\n  - $r_c = 1.10\\,\\mathrm{\\AA}$, $s_{\\mathrm{margin}} = 2.2$,\n  - $\\lambda = 1.5\\,\\mathrm{\\AA}$, $\\gamma_{\\infty} = 125.0\\,\\mathrm{mJ/m^2}$, $C = 40.0\\,\\mathrm{mJ/m^2}$,\n  - $\\delta_{\\gamma} = 0.5\\,\\mathrm{mJ/m^2}$, $u_{\\mathrm{tol}} = 0.008\\,\\mathrm{\\AA}$,\n  - $N_{\\min} = 16$, $N_{\\max} = 50$, $\\Delta N = 2$, $\\alpha_{\\mathrm{relax}} = 3.0$.\n- Case 3 (edge case with strict energy tolerance and small in-plane cell, copper-like):\n  - $a = 3.61\\,\\mathrm{\\AA}$, $m = 2$, $n = 2$, $\\Delta k_{\\mathrm{target}} = 0.020\\,\\mathrm{\\AA}^{-1}$,\n  - $r_c = 1.00\\,\\mathrm{\\AA}$, $s_{\\mathrm{margin}} = 3.0$,\n  - $\\lambda = 1.0\\,\\mathrm{\\AA}$, $\\gamma_{\\infty} = 45.0\\,\\mathrm{mJ/m^2}$, $C = 60.0\\,\\mathrm{mJ/m^2}$,\n  - $\\delta_{\\gamma} = 0.010\\,\\mathrm{mJ/m^2}$, $u_{\\mathrm{tol}} = 0.005\\,\\mathrm{\\AA}$,\n  - $N_{\\min} = 10$, $N_{\\max} = 18$, $\\Delta N = 2$, $\\alpha_{\\mathrm{relax}} = 2.0$.\n\nFinal output format:\n- For each test case, output a list containing $[E_{\\mathrm{cut}}\\ \\mathrm{(eV)}, N_{k,1}, N_{k,2}, N_{k,3}, N, n_{\\mathrm{relax}}, \\mathrm{converged}]$, where $E_{\\mathrm{cut}}$ is a float rounded to one decimal place, $N_{k,i}$, $N$, and $n_{\\mathrm{relax}}$ are integers, and $\\mathrm{converged}$ is a boolean.\n- Your program should produce a single line of output containing the results for all three test cases as a comma-separated list enclosed in square brackets, for example: $[[\\dots],[\\dots],[\\dots]]$.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of solid-state physics and computational materials science, specifically Density Functional Theory (DFT). The problem is well-posed, with all necessary parameters and a clear, deterministic algorithm provided. The values used in the test cases are physically realistic for the specified types of metals. Therefore, a solution is presented below.\n\nThis solution outlines the systematic procedure for determining a set of optimal computational parameters for a DFT calculation of the stacking fault energy ($\\gamma_{\\mathrm{sf}}$) in a Face-Centered Cubic (FCC) crystal. The workflow is based on first principles and established models for finite-size effects in periodic simulations.\n\nFirst, we define the fundamental geometric properties of the system. For an FCC crystal with a conventional lattice parameter $a$, the stacking of atomic planes occurs along the $\\langle 111 \\rangle$ directions. The interplanar distance for the $(111)$ planes is given by:\n$$\nd_{111} = \\frac{a}{\\sqrt{3}}\n$$\nAn intrinsic stacking fault is created by shearing one part of the crystal relative to the other by a Shockley partial dislocation, which has a Burgers vector of magnitude:\n$$\nb = \\frac{a}{\\sqrt{6}}\n$$\nThese quantities, $d_{111}$ and $b$, are computed at the outset as they are essential for subsequent calculations.\n\nNext, we establish the supercell model used for the simulation. To study an isolated stacking fault, we construct a three-dimensional periodic supercell. The cell is oriented such that the fault lies in the $(xy)$-plane, and the direction perpendicular to the fault is along the $z$-axis. The real-space lattice vectors of the supercell are defined as $A = [m u_1, n u_2, N u_3]$, where $u_1 = \\frac{a}{2}(1,-1,0)$ and $u_2 = \\frac{a}{2}(1,0,-1)$ are vectors spanning an $m \\times n$ repeated unit cell in the $(111)$ plane, and $u_3 = \\frac{a}{3}(1,1,1)$ is the vector normal to the planes. The parameter $N$ represents the total number of atomic layers along the stacking direction, defining the supercell thickness $L_z = N d_{111}$.\n\nA critical step is to determine the minimum supercell thickness $N$ that sufficiently isolates the stacking fault from its periodic images, thereby minimizing spurious interactions that contaminate the calculated energy. The problem provides a physically-motivated model for the convergence of the stacking fault energy per unit area, $\\gamma(N)$, with respect to the number of layers $N$:\n$$\n\\gamma(N) = \\gamma_{\\infty} + C \\exp\\!\\left(-\\frac{N d_{111}}{\\lambda}\\right)\n$$\nHere, $\\gamma_{\\infty}$ is the true stacking fault energy in the limit of infinite thickness, $C$ is an amplitude factor, and $\\lambda$ is the characteristic screening length of the material. Convergence is determined by two simultaneous criteria.\n\nThe first criterion addresses the energy convergence. We require the change in the calculated SFE, when increasing the cell thickness from $N$ to $N+\\Delta N$ layers, to be smaller than a specified tolerance $\\delta_{\\gamma}$:\n$$\n|\\gamma(N+\\Delta N) - \\gamma(N)| = \\left|C \\left( e^{-(N+\\Delta N)d_{111}/\\lambda} - e^{-Nd_{111}/\\lambda} \\right)\\right| \\le \\delta_{\\gamma}\n$$\nThe second criterion addresses the residual strain at the supercell boundaries. The displacement field from the fault decays with distance. The displacement at the halfway point to the nearest periodic image, $u_{\\mathrm{boundary}}$, must be below a tolerance $u_{\\mathrm{tol}}$:\n$$\nu_{\\mathrm{boundary}}(N) = \\frac{b}{2} \\exp\\!\\left(-\\frac{N d_{111}}{\\lambda}\\right) \\le u_{\\mathrm{tol}}\n$$\nThe algorithm iterates through possible values of $N$ starting from $N_{\\min}$ up to $N_{\\max}$ with a step of $\\Delta N$, selecting the smallest $N$ that satisfies both conditions. If no such $N$ is found, the system is considered not converged within the given range, and $N$ is set to $N_{\\max}$.\n\nOnce the supercell thickness $N$ is determined, we define the parameters for the electronic structure calculation. In DFT, the Bloch states are sampled on a discrete grid in the reciprocal space, known as a Monkhorst-Pack (MP) grid. The reciprocal lattice vectors, which form the columns of the matrix $B = 2\\pi (A^T)^{-1}$, define the reciprocal unit cell. To ensure adequate sampling of the Brillouin zone, the number of $k$-points along each reciprocal lattice direction $i$, denoted $N_{k,i}$, is chosen such that the spacing between $k$-points is no larger than a target value $\\Delta k_{\\mathrm{target}}$:\n$$\nN_{k,i} = \\left\\lceil \\frac{|b_i|}{\\Delta k_{\\mathrm{target}}} \\right\\rceil\n$$\nwhere $|b_i|$ is the magnitude of the $i$-th reciprocal lattice vector.\n\nThe electronic wavefunctions are expanded in a basis set of plane waves, truncated at a maximum kinetic energy, the cutoff energy $E_{\\mathrm{cut}}$. This cutoff is related to the maximum magnitude of the reciprocal lattice vector, $G_{\\max}$, included in the basis:\n$$\nE_{\\mathrm{cut}} = \\frac{\\hbar^2 G_{\\max}^2}{2 m_e}\n$$\nwhere $\\hbar$ is the reduced Planck constant and $m_e$ is the electron mass. The value of $G_{\\max}$ determines the smallest real-space features that can be accurately represented. By the Nyquist-Shannon sampling theorem, a real-space grid spacing of $h$ requires $G_{\\max} \\ge \\pi/h$. To accurately resolve the rapid oscillations of the wavefunction near the atomic nuclei, which are described by pseudopotentials with a characteristic core radius $r_c$, a safety margin $s_{\\mathrm{margin}}$ is introduced, setting the target real-space resolution to $h = r_c / s_{\\mathrm{margin}}$. This leads to the formula for the cutoff energy, which is typically expressed in electronvolts (eV).\n\nFinally, to manage computational cost, it is common practice to relax only the atomic positions of layers close to the defect, where strains are largest. The remaining layers are kept fixed in their ideal bulk positions. The thickness of this relaxed region, $t_{\\mathrm{relax}}$, is scaled with the characteristic decay length $\\lambda$ by a factor $\\alpha_{\\mathrm{relax}}$. The number of layers to be relaxed, $n_{\\mathrm{relax}}$, is then the smallest integer number of layers that covers this thickness:\n$$\nn_{\\mathrm{relax}} = \\left\\lceil \\frac{t_{\\mathrm{relax}}}{d_{111}} \\right\\rceil = \\left\\lceil \\frac{\\alpha_{\\mathrm{relax}} \\lambda}{d_{111}} \\right\\rceil\n$$\nThis completes the workflow for determining the necessary computational parameters.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Implements the numerical workflow to determine DFT parameters for\n    stacking fault energy calculations based on the provided problem statement.\n    \"\"\"\n    \n    # This constant represents h-bar^2 / (2 * m_e) in units of eV * Angstrom^2.\n    # It is used to convert the G_max^2 (in A^-2) to E_cut (in eV).\n    HBAR2_OVER_2M_EV_A2 = 3.809982\n\n    test_cases = [\n        # Case 1 (happy path, aluminum-like)\n        (4.05, 3, 3, 0.025, 1.25, 2.5, 2.0, 150.0, 50.0, 1.0, 0.010, 12, 40, 2, 3.0),\n        # Case 2 (different lattice and tolerances, nickel-like)\n        (3.52, 4, 4, 0.030, 1.10, 2.2, 1.5, 125.0, 40.0, 0.5, 0.008, 16, 50, 2, 3.0),\n        # Case 3 (edge case with strict energy tolerance and small in-plane cell, copper-like)\n        (3.61, 2, 2, 0.020, 1.00, 3.0, 1.0, 45.0, 60.0, 0.010, 0.005, 10, 18, 2, 2.0)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        a, m, n, delta_k_target, r_c, s_margin, lmbda, gamma_inf, C, delta_gamma, u_tol, N_min, N_max, delta_N, alpha_relax = case\n\n        # Step 1: Compute fundamental parameters\n        d_111 = a / np.sqrt(3)\n        b = a / np.sqrt(6)\n\n        # Step 2: Iterate to find the converged number of layers N\n        N_opt = N_max\n        converged = False\n        \n        for N in range(N_min, N_max + 1, delta_N):\n            # Energy convergence criterion\n            gamma_N = gamma_inf + C * np.exp(-N * d_111 / lmbda)\n            gamma_N_plus_delta = gamma_inf + C * np.exp(-(N + delta_N) * d_111 / lmbda)\n            energy_diff = np.abs(gamma_N_plus_delta - gamma_N)\n            energy_criterion_met = energy_diff <= delta_gamma\n\n            # Displacement convergence criterion\n            u_boundary = (b / 2) * np.exp(-N * d_111 / lmbda)\n            displacement_criterion_met = u_boundary <= u_tol\n\n            if energy_criterion_met and displacement_criterion_met:\n                N_opt = N\n                converged = True\n                break\n        \n        # Step 3: Compute Monkhorst-Pack grid N_k\n        u1 = (a / 2) * np.array([1, -1, 0])\n        u2 = (a / 2) * np.array([1, 0, -1])\n        u3 = (a / 3) * np.array([1, 1, 1])\n        \n        # Real-space lattice matrix A (columns are lattice vectors)\n        A = np.array([m * u1, n * u2, N_opt * u3]).T\n        \n        # Reciprocal lattice matrix B\n        B = 2 * np.pi * np.linalg.inv(A).T\n        \n        # Magnitudes of reciprocal lattice vectors\n        b_mags = np.linalg.norm(B, axis=0)\n        \n        # MP grid dimensions\n        Nk = np.ceil(b_mags / delta_k_target).astype(int)\n        N_k1, N_k2, N_k3 = Nk[0], Nk[1], Nk[2]\n\n        # Step 4: Compute plane-wave kinetic energy cutoff E_cut\n        h = r_c / s_margin\n        G_max = np.pi / h\n        E_cut = HBAR2_OVER_2M_EV_A2 * G_max**2\n        E_cut_rounded = round(E_cut, 1)\n\n        # Step 5: Compute number of relaxable layers n_relax\n        t_relax = alpha_relax * lmbda\n        n_relax = int(np.ceil(t_relax / d_111))\n\n        # Collate results for the current case\n        case_result = [E_cut_rounded, N_k1, N_k2, N_k3, N_opt, n_relax, converged]\n        results.append(case_result)\n\n    # Format the final output string to be a single line with no spaces inside lists.\n    # e.g., \"[[item1,item2],[item3,item4]]\"\n    string_results = [str(r).replace(\" \", \"\") for r in results]\n    final_output = f\"[{','.join(string_results)}]\"\n\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Once a simulation is complete, the next step is to extract physical quantities from the raw output data. This exercise demonstrates how to calculate interfacial energies, such as the stacking fault energy ($\\gamma_{\\mathrm{sf}}$) and twin boundary energy ($\\gamma_{\\mathrm{tb}}$), from the total energies obtained in DFT calculations. You will learn to correctly account for the presence of multiple interfaces within a periodic supercell, a common feature in such simulations .",
            "id": "3840557",
            "problem": "A face-centered cubic (FCC) metal is simulated with Density Functional Theory (DFT) under periodic boundary conditions. The objective is to compute the interfacial energies per unit area for an intrinsic stacking fault and for coherent twin boundaries, denoted by $\\gamma_{\\mathrm{sf}}$ and $\\gamma_{\\mathrm{tb}}$, respectively. Use the following foundational ideas: an interfacial energy is defined as the excess energy per unit area required to create the interface relative to the perfect bulk reference under the same thermodynamic state, and under periodic boundary conditions a supercell may contain multiple identical interfaces whose contributions must be properly accounted for.\n\nThe following total energies and supercell characteristics are obtained from converged DFT calculations at zero external stress and identical computational settings:\n- Perfect FCC supercell: $N_{\\mathrm{fcc}} = 144$ atoms, total energy $E_{\\mathrm{fcc}} = -504.000~\\mathrm{eV}$.\n- Supercell containing an intrinsic stacking fault: $N_{\\mathrm{sf}} = 144$ atoms, total energy $E_{\\mathrm{sf}} = -501.760~\\mathrm{eV}$. Due to periodic boundary conditions normal to the $\\{111\\}$ plane, this supercell contains $m_{\\mathrm{sf}} = 2$ equivalent stacking fault planes per unit cell.\n- Supercell containing coherent twin boundaries (CTBs): $N_{\\mathrm{tb}} = 144$ atoms, total energy $E_{\\mathrm{tb}} = -503.002~\\mathrm{eV}$. Owing to mirror-symmetric periodicity, this supercell contains $m_{\\mathrm{tb}} = 2$ twin boundaries per unit cell.\n\nIn both defective supercells, the planar defect lies on the same crystallographic $\\{111\\}$ plane; the in-plane area of that plane within the supercell is $A = 400~\\text{\\AA}^{2}$.\n\nStarting from the fundamental definition of interfacial energy as excess energy per unit area, and carefully accounting for the number of equivalent interfaces present due to periodic images, derive expressions for $\\gamma_{\\mathrm{sf}}$ and $\\gamma_{\\mathrm{tb}}$ in terms of the given quantities and evaluate them numerically. Use the perfect FCC supercell to define the bulk reference energy per atom. Express both $\\gamma_{\\mathrm{sf}}$ and $\\gamma_{\\mathrm{tb}}$ in $\\mathrm{mJ/m}^{2}$ and round each final value to three significant figures.\n\nUse the exact physical constants $1~\\mathrm{eV} = 1.602176634 \\times 10^{-19}~\\mathrm{J}$ and $1~\\text{\\AA} = 10^{-10}~\\mathrm{m}$.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of computational materials science, well-posed with all necessary data provided, and objective in its formulation. The data are self-consistent and plausible for a Density Functional Theory (DFT) study of a face-centered cubic (FCC) metal.\n\nThe fundamental definition of an interfacial energy per unit area, $\\gamma$, is the excess energy of a system containing an interface, $\\Delta E_{\\text{excess}}$, relative to a perfect bulk reference, divided by the total area of the interface(s), $A_{\\text{total}}$.\n$$\n\\gamma = \\frac{\\Delta E_{\\text{excess}}}{A_{\\text{total}}}\n$$\nThe excess energy, $\\Delta E_{\\text{excess}}$, is the difference between the total energy of the supercell containing the defect(s), $E_{\\text{defective}}$, and the energy of an equivalent number of atoms in a perfect, defect-free bulk configuration, $E_{\\text{reference}}$.\n$$\n\\Delta E_{\\text{excess}} = E_{\\text{defective}} - E_{\\text{reference}}\n$$\nThe reference energy is calculated using the energy per atom of the perfect bulk material, $E_{\\text{atom, bulk}}$. This is obtained from the perfect FCC supercell calculation. Given $E_{\\mathrm{fcc}}$ as the total energy of the perfect supercell containing $N_{\\mathrm{fcc}}$ atoms, the energy per atom is:\n$$\nE_{\\text{atom, bulk}} = \\frac{E_{\\mathrm{fcc}}}{N_{\\mathrm{fcc}}}\n$$\nFor a defective supercell containing $N_{\\text{defective}}$ atoms, the reference energy is $E_{\\text{reference}} = N_{\\text{defective}} \\cdot E_{\\text{atom, bulk}}$. In this problem, all supercells contain the same number of atoms, i.e., $N_{\\mathrm{fcc}} = N_{\\mathrm{sf}} = N_{\\mathrm{tb}} = 144$. This simplifies the calculation of excess energy. For any defective supercell, the reference energy is simply $E_{\\mathrm{fcc}}$.\n$$\nE_{\\text{reference}} = N_{\\text{defective}} \\cdot \\frac{E_{\\mathrm{fcc}}}{N_{\\mathrm{fcc}}} = N_{\\mathrm{fcc}} \\cdot \\frac{E_{\\mathrm{fcc}}}{N_{\\mathrm{fcc}}} = E_{\\mathrm{fcc}}\n$$\nDue to periodic boundary conditions, the supercell contains multiple equivalent interfaces. If a supercell with in-plane area $A$ contains $m$ identical interfaces, the total interface area is $A_{\\text{total}} = m \\cdot A$. Therefore, the general expression for the interfacial energy is:\n$$\n\\gamma = \\frac{E_{\\text{defective}} - E_{\\mathrm{fcc}}}{m \\cdot A}\n$$\n\nFirst, we calculate the intrinsic stacking fault energy, $\\gamma_{\\mathrm{sf}}$. The relevant quantities are the total energy of the stacking fault supercell, $E_{\\mathrm{sf}} = -501.760~\\mathrm{eV}$, the total energy of the perfect reference supercell, $E_{\\mathrm{fcc}} = -504.000~\\mathrm{eV}$, the number of stacking faults in the supercell, $m_{\\mathrm{sf}} = 2$, and the in-plane area, $A = 400~\\text{\\AA}^{2}$.\nThe excess energy associated with the two stacking faults is:\n$$\n\\Delta E_{\\mathrm{sf}} = E_{\\mathrm{sf}} - E_{\\mathrm{fcc}} = -501.760~\\mathrm{eV} - (-504.000~\\mathrm{eV}) = 2.240~\\mathrm{eV}\n$$\nThe stacking fault energy $\\gamma_{\\mathrm{sf}}$ is this excess energy divided by the total area of the two faults:\n$$\n\\gamma_{\\mathrm{sf}} = \\frac{\\Delta E_{\\mathrm{sf}}}{m_{\\mathrm{sf}} \\cdot A} = \\frac{2.240~\\mathrm{eV}}{2 \\cdot 400~\\text{\\AA}^{2}} = \\frac{2.240~\\mathrm{eV}}{800~\\text{\\AA}^{2}} = 0.0028~\\mathrm{eV/\\AA^2}\n$$\n\nNext, we calculate the coherent twin boundary energy, $\\gamma_{\\mathrm{tb}}$. The relevant quantities are the total energy of the twin boundary supercell, $E_{\\mathrm{tb}} = -503.002~\\mathrm{eV}$, the reference energy $E_{\\mathrm{fcc}} = -504.000~\\mathrm{eV}$, the number of twin boundaries, $m_{\\mathrm{tb}} = 2$, and the area $A = 400~\\text{\\AA}^{2}$.\nThe excess energy associated with the two twin boundaries is:\n$$\n\\Delta E_{\\mathrm{tb}} = E_{\\mathrm{tb}} - E_{\\mathrm{fcc}} = -503.002~\\mathrm{eV} - (-504.000~\\mathrm{eV}) = 0.998~\\mathrm{eV}\n$$\nThe twin boundary energy $\\gamma_{\\mathrm{tb}}$ is this excess energy divided by the total area of the two boundaries:\n$$\n\\gamma_{\\mathrm{tb}} = \\frac{\\Delta E_{\\mathrm{tb}}}{m_{\\mathrm{tb}} \\cdot A} = \\frac{0.998~\\mathrm{eV}}{2 \\cdot 400~\\text{\\AA}^{2}} = \\frac{0.998~\\mathrm{eV}}{800~\\text{\\AA}^{2}} = 0.0012475~\\mathrm{eV/\\AA^2}\n$$\n\nFinally, we must convert these energies from units of $\\mathrm{eV/\\AA^2}$ to $\\mathrm{mJ/m^2}$. We use the given conversion factors: $1~\\mathrm{eV} = 1.602176634 \\times 10^{-19}~\\mathrm{J}$ and $1~\\text{\\AA} = 10^{-10}~\\mathrm{m}$.\nThe conversion factor from $\\mathrm{eV/\\AA^2}$ to $\\mathrm{J/m^2}$ is:\n$$\n1~\\frac{\\mathrm{eV}}{\\text{\\AA}^2} = \\frac{1.602176634 \\times 10^{-19}~\\mathrm{J}}{(10^{-10}~\\mathrm{m})^2} = \\frac{1.602176634 \\times 10^{-19}~\\mathrm{J}}{10^{-20}~\\mathrm{m}^2} = 16.02176634~\\frac{\\mathrm{J}}{\\mathrm{m}^2}\n$$\nSince $1~\\mathrm{J} = 1000~\\mathrm{mJ}$, the conversion to $\\mathrm{mJ/m^2}$ is:\n$$\n1~\\frac{\\mathrm{eV}}{\\text{\\AA}^2} = 16.02176634~\\frac{\\mathrm{J}}{\\mathrm{m}^2} \\times 1000~\\frac{\\mathrm{mJ}}{\\mathrm{J}} = 16021.76634~\\frac{\\mathrm{mJ}}{\\mathrm{m}^2}\n$$\nNow we apply this conversion factor to our calculated energies.\nFor the stacking fault energy:\n$$\n\\gamma_{\\mathrm{sf}} = 0.0028~\\frac{\\mathrm{eV}}{\\text{\\AA}^2} \\times 16021.76634~\\frac{\\mathrm{mJ/m}^2}{\\mathrm{eV/\\AA}^2} \\approx 44.8609~\\frac{\\mathrm{mJ}}{\\mathrm{m}^2}\n$$\nRounding to three significant figures, we get $\\gamma_{\\mathrm{sf}} = 44.9~\\mathrm{mJ/m}^2$.\n\nFor the twin boundary energy:\n$$\n\\gamma_{\\mathrm{tb}} = 0.0012475~\\frac{\\mathrm{eV}}{\\text{\\AA}^2} \\times 16021.76634~\\frac{\\mathrm{mJ/m}^2}{\\mathrm{eV/\\AA}^2} \\approx 19.9872~\\frac{\\mathrm{mJ}}{\\mathrm{m}^2}\n$$\nRounding to three significant figures, we get $\\gamma_{\\mathrm{tb}} = 20.0~\\mathrm{mJ/m}^2$.\n\nThe final results for the stacking fault energy and twin boundary energy are $44.9~\\mathrm{mJ/m}^2$ and $20.0~\\mathrm{mJ/m}^2$, respectively.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 44.9 & 20.0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The final step in multiscale modeling is often to use parameters from fine-grained simulations to inform higher-level theories. In this practice, you will use the stacking fault energy, a quantity obtainable from DFT, as an input for a continuum elasticity model of a dissociated dislocation. By balancing the elastic forces between partial dislocations with the tension from the stacking fault, you will derive the equilibrium separation width, directly linking a quantum-mechanical energy to a microstructural feature .",
            "id": "3840530",
            "problem": "A straight perfect dislocation in a Face-Centered Cubic (FCC) metal with lattice parameter $a$ lies on the $\\{111\\}$ slip plane and has line direction parallel to $[1\\,\\overline{1}\\,0]$. The material is elastically isotropic with shear modulus $\\mu$ and Poisson’s ratio $\\nu$. The perfect dislocation is a pure screw with Burgers vector $\\mathbf{b} = \\frac{a}{2}[1\\,\\overline{1}\\,0]$ and dissociates on the $(111)$ plane into two Shockley partial dislocations with Burgers vectors\n- $\\mathbf{b}_{1} = \\frac{a}{6}[2\\,\\overline{1}\\,\\overline{1}]$,\n- $\\mathbf{b}_{2} = \\frac{a}{6}[1\\,\\overline{2}\\,1]$,\nseparated by a distance $d$ measured within the $(111)$ plane along the direction perpendicular to the line direction. The region between the partials is a stacking fault of energy density $\\gamma_{\\mathrm{sf}}$ (energy per unit area).\n\nAssume linear isotropic elasticity, no applied stress, and neglect core and image forces. Starting from fundamental definitions of dislocation interactions in isotropic elasticity (for example, the Peach–Koehler force and the mixed-character decomposition into screw and edge components), and treating the stacking fault as contributing an energy per unit length $E_{\\mathrm{sf}}(d) = \\gamma_{\\mathrm{sf}} d$, derive an explicit analytical expression for the equilibrium separation $d$ that results from balancing the elastic repulsion of the two partials with the attractive force due to the stacking fault.\n\nAssume all quantities are expressed in the International System of Units (SI). Express the final separation $d$ in meters as a closed-form expression in terms of $\\mu$, $\\nu$, $a$, and $\\gamma_{\\mathrm{sf}}$. No rounding is required.",
            "solution": "The problem requires the derivation of the equilibrium separation distance, $d$, between two Shockley partial dislocations that result from the dissociation of a perfect screw dislocation in an FCC crystal. The equilibrium is achieved when the elastic repulsive force between the two partials is exactly balanced by the attractive force exerted by the stacking fault ribbon that connects them.\n\nThe attractive force per unit length, $F_{\\mathrm{attr}}/L$, due to the stacking fault is constant and equal in magnitude to the stacking fault energy per unit area, $\\gamma_{\\mathrm{sf}}$. This force acts to minimize the area of the fault, thus pulling the partials together.\n$$ \\frac{F_{\\mathrm{attr}}}{L} = \\gamma_{\\mathrm{sf}} $$\n\nThe elastic repulsive force per unit length, $F_{\\mathrm{rep}}/L$, between two parallel dislocations (labeled $1$ and $2$) separated by a distance $d$ in their common slip plane is given by the formula for the force component within that plane:\n$$ \\frac{F_{\\mathrm{rep}}}{L} = \\frac{\\mu}{2\\pi d} \\left( (\\mathbf{b}_{1s} \\cdot \\mathbf{b}_{2s}) + \\frac{1}{1-\\nu} (\\mathbf{b}_{1e} \\cdot \\mathbf{b}_{2e}) \\right) $$\nHere, $\\mu$ is the shear modulus, $\\nu$ is the Poisson's ratio, and $\\mathbf{b}_{s}$ and $\\mathbf{b}_{e}$ are the screw and edge components, respectively, of the Burgers vectors of the partial dislocations.\n\nThe line direction of the dislocations is parallel to the crystallographic direction $[1\\,\\overline{1}\\,0]$. The normalized line vector $\\hat{\\mathbf{t}}$ is:\n$$ \\hat{\\mathbf{t}} = \\frac{1}{\\sqrt{1^2 + (-1)^2 + 0^2}} [1\\bar{1}0] = \\frac{1}{\\sqrt{2}} [1\\bar{1}0] $$\n\nThe Burgers vectors of the two Shockley partials are given as:\n$$ \\mathbf{b}_{1} = \\frac{a}{6}[2\\bar{1}\\bar{1}] $$\n$$ \\mathbf{b}_{2} = \\frac{a}{6}[1\\bar{2}1] $$\n\nWe must decompose each Burgers vector into its screw component (parallel to $\\hat{\\mathbf{t}}$) and its edge component (perpendicular to $\\hat{\\mathbf{t}}$). The screw component of a vector $\\mathbf{b}$ is given by $\\mathbf{b}_s = (\\mathbf{b} \\cdot \\hat{\\mathbf{t}})\\hat{\\mathbf{t}}$.\n\nFor the first partial, $\\mathbf{b}_1$:\nThe scalar projection onto the line direction is:\n$$ \\mathbf{b}_{1} \\cdot \\hat{\\mathbf{t}} = \\frac{a}{6}[2\\bar{1}\\bar{1}] \\cdot \\frac{1}{\\sqrt{2}}[1\\bar{1}0] = \\frac{a}{6\\sqrt{2}}((2)(1) + (-1)(-1) + (-1)(0)) = \\frac{a}{6\\sqrt{2}}(3) = \\frac{a}{2\\sqrt{2}} $$\nThe screw component vector is:\n$$ \\mathbf{b}_{1s} = \\left(\\frac{a}{2\\sqrt{2}}\\right) \\hat{\\mathbf{t}} = \\frac{a}{2\\sqrt{2}} \\left(\\frac{1}{\\sqrt{2}}[1\\bar{1}0]\\right) = \\frac{a}{4}[1\\bar{1}0] $$\nThe edge component is $\\mathbf{b}_{1e} = \\mathbf{b}_1 - \\mathbf{b}_{1s}$:\n$$ \\mathbf{b}_{1e} = \\frac{a}{6}[2\\bar{1}\\bar{1}] - \\frac{a}{4}[1\\bar{1}0] = a\\left[\\frac{2}{6}-\\frac{1}{4}, -\\frac{1}{6}+\\frac{1}{4}, -\\frac{1}{6}-0\\right] = a\\left[\\frac{4-3}{12}, \\frac{-2+3}{12}, -\\frac{2}{12}\\right] = \\frac{a}{12}[1,1,\\bar{2}] $$\n\nFor the second partial, $\\mathbf{b}_2$:\nThe scalar projection onto the line direction is:\n$$ \\mathbf{b}_{2} \\cdot \\hat{\\mathbf{t}} = \\frac{a}{6}[1\\bar{2}1] \\cdot \\frac{1}{\\sqrt{2}}[1\\bar{1}0] = \\frac{a}{6\\sqrt{2}}((1)(1) + (-2)(-1) + (1)(0)) = \\frac{a}{6\\sqrt{2}}(3) = \\frac{a}{2\\sqrt{2}} $$\nThe screw component vector is:\n$$ \\mathbf{b}_{2s} = \\left(\\frac{a}{2\\sqrt{2}}\\right) \\hat{\\mathbf{t}} = \\frac{a}{4}[1\\bar{1}0] $$\nThe edge component is $\\mathbf{b}_{2e} = \\mathbf{b}_2 - \\mathbf{b}_{2s}$:\n$$ \\mathbf{b}_{2e} = \\frac{a}{6}[1\\bar{2}1] - \\frac{a}{4}[1\\bar{1}0] = a\\left[\\frac{1}{6}-\\frac{1}{4}, -\\frac{2}{6}+\\frac{1}{4}, \\frac{1}{6}-0\\right] = a\\left[\\frac{2-3}{12}, \\frac{-4+3}{12}, \\frac{2}{12}\\right] = \\frac{a}{12}[\\bar{1},\\bar{1},2] $$\nNote that $\\mathbf{b}_{1s} = \\mathbf{b}_{2s}$ and $\\mathbf{b}_{1e} = -\\mathbf{b}_{2e}$.\n\nNow, we calculate the dot products required for the force formula:\n$$ \\mathbf{b}_{1s} \\cdot \\mathbf{b}_{2s} = \\left(\\frac{a}{4}[1\\bar{1}0]\\right) \\cdot \\left(\\frac{a}{4}[1\\bar{1}0]\\right) = \\frac{a^2}{16}(1^2 + (-1)^2 + 0^2) = \\frac{2a^2}{16} = \\frac{a^2}{8} $$\n$$ \\mathbf{b}_{1e} \\cdot \\mathbf{b}_{2e} = \\left(\\frac{a}{12}[1,1,\\bar{2}]\\right) \\cdot \\left(\\frac{a}{12}[\\bar{1},\\bar{1},2]\\right) = \\frac{a^2}{144}((1)(-1) + (1)(-1) + (-2)(2)) = \\frac{a^2}{144}(-1-1-4) = -\\frac{6a^2}{144} = -\\frac{a^2}{24} $$\n\nSubstitute these dot products into the expression for the repulsive force per unit length:\n$$ \\frac{F_{\\mathrm{rep}}}{L} = \\frac{\\mu}{2\\pi d} \\left( \\frac{a^2}{8} + \\frac{1}{1-\\nu} \\left(-\\frac{a^2}{24}\\right) \\right) = \\frac{\\mu a^2}{2\\pi d} \\left( \\frac{1}{8} - \\frac{1}{24(1-\\nu)} \\right) $$\nTo simplify the term in parenthesis, we find a common denominator:\n$$ \\frac{F_{\\mathrm{rep}}}{L} = \\frac{\\mu a^2}{2\\pi d} \\left( \\frac{3(1-\\nu) - 1}{24(1-\\nu)} \\right) = \\frac{\\mu a^2}{2\\pi d} \\left( \\frac{3 - 3\\nu - 1}{24(1-\\nu)} \\right) = \\frac{\\mu a^2 (2 - 3\\nu)}{48\\pi d (1-\\nu)} $$\n\nAt equilibrium, the repulsive force equals the attractive force:\n$$ \\frac{F_{\\mathrm{rep}}}{L} = \\frac{F_{\\mathrm{attr}}}{L} $$\n$$ \\frac{\\mu a^2 (2 - 3\\nu)}{48\\pi d (1-\\nu)} = \\gamma_{\\mathrm{sf}} $$\n\nFinally, we solve for the equilibrium separation distance $d$:\n$$ d = \\frac{\\mu a^2 (2 - 3\\nu)}{48\\pi \\gamma_{\\mathrm{sf}} (1-\\nu)} $$\nThis is the closed-form expression for the equilibrium separation.",
            "answer": "$$\n\\boxed{\\frac{\\mu a^{2} (2 - 3\\nu)}{48\\pi \\gamma_{\\mathrm{sf}} (1-\\nu)}}\n$$"
        }
    ]
}