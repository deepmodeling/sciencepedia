{
    "hands_on_practices": [
        {
            "introduction": "在运行任何复杂的模拟之前，周密的规划对于获得准确且具有物理意义的结果至关重要。本实践将指导您完成设计密度泛函理论 (DFT) 工作流程以计算层错能的过程。您将学习如何选择关键参数，如超胞尺寸、k点采样和能量截断，以确保您的计算是收敛的且没有数值伪影，这是任何计算材料科学家的一项基石技能。",
            "id": "3840535",
            "problem": "您的任务是设计一个基于第一性原理的数值计算流程，用于选择计算参数，以利用密度泛函理论 (DFT) 计算面心立方 (FCC) 金属中单位面积的层错能 $\\gamma_{\\mathrm{sf}}$。该工作流程必须为 Monkhorst-Pack (MP) $k$点网格、平面波动能截断、沿 $(111)$ 方向的超胞厚度、缺陷附近需要弛豫的原子层数以及抑制周期性重复缺陷之间赝相互作用的收敛性检查提供建议。您的程序必须实现以下数学模型和规则来确定这些参数。\n\n基本核心定义：\n- FCC 常规立方晶格的晶格参数为 $a$ (单位为 $\\mathrm{\\AA}$)。$(111)$ 晶面由两个实空间矢量 $u_1 = \\frac{a}{2}(1,-1,0)$ 和 $u_2 = \\frac{a}{2}(1,0,-1)$ 张成，它们的模长为 $|u_1| = |u_2| = \\frac{a}{\\sqrt{2}}$，彼此之间的夹角为 $60^\\circ$。$(111)$ 晶面的晶面间距为 $d_{111} = \\frac{a}{\\sqrt{3}}$。垂直于 $(111)$ 晶面且长度为一个晶面间距的矢量是 $u_3 = \\frac{a}{3}(1,1,1)$，其模长为 $|u_3| = d_{111}$。\n- 一个在面内有 $m$ 和 $n$ 次重复、沿 $(111)$ 方向有 $N$ 个原子层的超胞，其实空间晶格矩阵为 $A = [m u_1, n u_2, N u_3]$，其中列向量是三个晶格矢量（单位为 $\\mathrm{\\AA}$）。\n- 倒易晶格矩阵为 $B = 2\\pi A^{-T}$，其列向量为 $b_1$、$b_2$ 和 $b_3$（单位为 $\\mathrm{\\AA}^{-1}$）。\n- 选择 Monkhorst-Pack 网格 $N_k = (N_{k,1}, N_{k,2}, N_{k,3})$，使得 $N_{k,i} \\ge 1$ 且沿每个倒易晶格方向的间距满足 $\\Delta k_i = \\frac{|b_i|}{N_{k,i}} \\le \\Delta k_{\\mathrm{target}}$（单位为 $\\mathrm{\\AA}^{-1}$）。因此，$N_{k,i} = \\left\\lceil \\frac{|b_i|}{\\Delta k_{\\mathrm{target}}} \\right\\rceil$。\n- 平面波动能截断 $E_{\\mathrm{cut}}$ 由最大倒易矢量模长 $G_{\\max}$ 通过 $E_{\\mathrm{cut}} = \\frac{\\hbar^2 G_{\\max}^2}{2 m_e}$ 决定，其中 $\\hbar$ 是约化普朗克常数，$m_e$ 是电子质量。根据 Nyquist 采样原理，选择 $G_{\\max} = \\frac{\\pi}{h}$，其中 $h$ 是目标实空间网格间距。为了解析核心半径为 $r_c$（单位为 $\\mathrm{\\AA}$）的赝势特征，设置 $h = \\frac{r_c}{s_{\\mathrm{margin}}}$，其中安全余量 $s_{\\mathrm{margin}} > 1$。将 $E_{\\mathrm{cut}}$ 以电子伏特 (eV) 表示，并四舍五入到一位小数。\n- 层错是由一个伯格斯矢量模长为 $b = \\frac{a}{\\sqrt{6}}$ 的 Shockley 不全位错产生的。在屏蔽介质中，周期性重复缺陷之间的残余镜像相互作用可以被建模为随超胞厚度指数衰减。设层错能的有限尺寸修正模型为\n$$\n\\gamma(N) = \\gamma_{\\infty} + C \\exp\\!\\left(-\\frac{N d_{111}}{\\lambda}\\right),\n$$\n其中 $\\gamma_{\\infty}$ 是收敛的层错能（单位为 $\\mathrm{mJ/m^2}$），$C$ 是主要修正项的振幅（单位为 $\\mathrm{mJ/m^2}$），$\\lambda$ 是特征衰减长度（单位为 $\\mathrm{\\AA}$）。\n- 当以下两个条件同时满足时，超胞厚度 $N$ 达到收敛：\n  1. 将原子层数增加 $\\Delta N$ 时，$\\gamma(N)$ 的变化量低于容差 $\\delta_{\\gamma}$：\n  $$\n  \\left|\\gamma(N+\\Delta N) - \\gamma(N)\\right| \\le \\delta_{\\gamma}.\n  $$\n  2. 周期性镜像边界处的位移振幅，其模型为\n  $$\n  u_{\\mathrm{boundary}}(N) = \\frac{b}{2} \\exp\\!\\left(-\\frac{N d_{111}}{\\lambda}\\right),\n  $$\n  低于阈值 $u_{\\mathrm{tol}}$（单位为 $\\mathrm{\\AA}$）。\n- 弛豫方案指定只允许层错周围的一部分原子层进行弛豫。设弛豫厚度为 $t_{\\mathrm{relax}} = \\alpha_{\\mathrm{relax}} \\lambda$（单位为 $\\mathrm{\\AA}$），相应的可弛豫原子层数为 $n_{\\mathrm{relax}} = \\left\\lceil \\frac{t_{\\mathrm{relax}}}{d_{111}} \\right\\rceil$。其余原子层保持固定，以模拟类体相的边界条件。\n\n算法要求：\n- 给定输入 $(a, m, n, \\Delta k_{\\mathrm{target}}, r_c, s_{\\mathrm{margin}}, \\lambda, \\gamma_{\\infty}, C, \\delta_{\\gamma}, u_{\\mathrm{tol}}, N_{\\min}, N_{\\max}, \\Delta N, \\alpha_{\\mathrm{relax}})$，您的程序必须：\n  1. 计算 $d_{111}$ 和 $b$。\n  2. 从 $N_{\\min}$ 到 $N_{\\max}$ 以 $\\Delta N$ 为步长迭代 $N$，找到满足两个收敛标准的最小 $N$。如果不存在这样的 $N$，则设 $N = N_{\\max}$ 并将该次运行标记为未收敛。\n  3. 使用选定的 $N$ 构建 $A$ 和 $B$，然后使用 $\\Delta k_{\\mathrm{target}}$ 标准计算 MP 网格 $N_k$。\n  4. 使用 Nyquist 关系以及给定的 $r_c$ 和 $s_{\\mathrm{margin}}$ 计算 $E_{\\mathrm{cut}}$，并以 eV 为单位表示，四舍五入到一位小数。\n  5. 使用 $t_{\\mathrm{relax}} = \\alpha_{\\mathrm{relax}} \\lambda$ 计算 $n_{\\mathrm{relax}}$。\n- 物理单位：$a$、$r_c$、$\\lambda$、$u_{\\mathrm{tol}}$ 的单位是 $\\mathrm{\\AA}$；$\\Delta k_{\\mathrm{target}}$ 的单位是 $\\mathrm{\\AA}^{-1}$；$\\gamma_{\\infty}$、$C$ 和 $\\delta_{\\gamma}$ 的单位是 $\\mathrm{mJ/m^2}$；$E_{\\mathrm{cut}}$ 的单位是 eV。\n- 角度单位：该算法在三角关系中隐式使用弧度。\n\n测试套件与参数：\n- 案例 1 (正常路径，类铝)：\n  - $a = 4.05\\,\\mathrm{\\AA}$，$m = 3$，$n = 3$，$\\Delta k_{\\mathrm{target}} = 0.025\\,\\mathrm{\\AA}^{-1}$，\n  - $r_c = 1.25\\,\\mathrm{\\AA}$，$s_{\\mathrm{margin}} = 2.5$，\n  - $\\lambda = 2.0\\,\\mathrm{\\AA}$，$\\gamma_{\\infty} = 150.0\\,\\mathrm{mJ/m^2}$，$C = 50.0\\,\\mathrm{mJ/m^2}$，\n  - $\\delta_{\\gamma} = 1.0\\,\\mathrm{mJ/m^2}$，$u_{\\mathrm{tol}} = 0.010\\,\\mathrm{\\AA}$，\n  - $N_{\\min} = 12$，$N_{\\max} = 40$，$\\Delta N = 2$，$\\alpha_{\\mathrm{relax}} = 3.0$。\n- 案例 2 (不同晶格和容差，类镍)：\n  - $a = 3.52\\,\\mathrm{\\AA}$，$m = 4$，$n = 4$，$\\Delta k_{\\mathrm{target}} = 0.030\\,\\mathrm{\\AA}^{-1}$，\n  - $r_c = 1.10\\,\\mathrm{\\AA}$，$s_{\\mathrm{margin}} = 2.2$，\n  - $\\lambda = 1.5\\,\\mathrm{\\AA}$，$\\gamma_{\\infty} = 125.0\\,\\mathrm{mJ/m^2}$，$C = 40.0\\,\\mathrm{mJ/m^2}$，\n  - $\\delta_{\\gamma} = 0.5\\,\\mathrm{mJ/m^2}$，$u_{\\mathrm{tol}} = 0.008\\,\\mathrm{\\AA}$，\n  - $N_{\\min} = 16$，$N_{\\max} = 50$，$\\Delta N = 2$，$\\alpha_{\\mathrm{relax}} = 3.0$。\n- 案例 3 (边界情况，具有严格能量容差和小的面内原胞，类铜)：\n  - $a = 3.61\\,\\mathrm{\\AA}$，$m = 2$，$n = 2$，$\\Delta k_{\\mathrm{target}} = 0.020\\,\\mathrm{\\AA}^{-1}$，\n  - $r_c = 1.00\\,\\mathrm{\\AA}$，$s_{\\mathrm{margin}} = 3.0$，\n  - $\\lambda = 1.0\\,\\mathrm{\\AA}$，$\\gamma_{\\infty} = 45.0\\,\\mathrm{mJ/m^2}$，$C = 60.0\\,\\mathrm{mJ/m^2}$，\n  - $\\delta_{\\gamma} = 0.010\\,\\mathrm{mJ/m^2}$，$u_{\\mathrm{tol}} = 0.005\\,\\mathrm{\\AA}$，\n  - $N_{\\min} = 10$，$N_{\\max} = 18$，$\\Delta N = 2$，$\\alpha_{\\mathrm{relax}} = 2.0$。\n\n最终输出格式：\n- 对于每个测试案例，输出一个列表，包含 $[E_{\\mathrm{cut}}\\ \\mathrm{(eV)}, N_{k,1}, N_{k,2}, N_{k,3}, N, n_{\\mathrm{relax}}, \\mathrm{converged}]$，其中 $E_{\\mathrm{cut}}$ 是一个四舍五入到一位小数的浮点数，$N_{k,i}$、$N$ 和 $n_{\\mathrm{relax}}$ 是整数，$\\mathrm{converged}$ 是一个布尔值。\n- 您的程序应生成单行输出，其中包含所有三个测试案例的结果，格式为用方括号括起来的逗号分隔列表，例如：$[[\\dots],[\\dots],[\\dots]]$。",
            "solution": "问题陈述经评估有效。它在科学上基于固态物理学和计算材料科学的原理，特别是密度泛函理论 (DFT)。该问题是良构的，提供了所有必要的参数和清晰的确定性算法。测试案例中使用的值对于指定类型的金属在物理上是现实的。因此，下面将给出一个解决方案。\n\n本解决方案概述了确定用于面心立方 (FCC) 晶体中层错能 ($\\gamma_{\\mathrm{sf}}$) 的 DFT 计算的一组最佳计算参数的系统性步骤。该工作流程基于第一性原理和用于周期性模拟中有限尺寸效应的已建立模型。\n\n首先，我们定义系统的基本几何性质。对于一个具有常规晶格参数 $a$ 的 FCC 晶体，原子面沿 $\\langle 111 \\rangle$ 方向堆叠。$(111)$ 晶面的晶面间距由下式给出：\n$$\nd_{111} = \\frac{a}{\\sqrt{3}}\n$$\n通过一个 Shockley 不全位错将晶体的一部分相对于另一部分进行剪切，从而产生一个内禀层错，该位错的伯格斯矢量模长为：\n$$\nb = \\frac{a}{\\sqrt{6}}\n$$\n这些量，$d_{111}$ 和 $b$，在开始时就计算出来，因为它们对后续计算至关重要。\n\n接下来，我们建立用于模拟的超胞模型。为了研究一个孤立的层错，我们构建一个三维周期性超胞。该胞的取向使得缺陷位于 $(xy)$ 平面内，而垂直于缺陷的方向沿 $z$ 轴。超胞的实空间晶格矢量定义为 $A = [m u_1, n u_2, N u_3]$，其中 $u_1 = \\frac{a}{2}(1,-1,0)$ 和 $u_2 = \\frac{a}{2}(1,0,-1)$ 是在 $(111)$ 平面内张成一个 $m \\times n$ 重复晶胞的矢量，$u_3 = \\frac{a}{3}(1,1,1)$ 是垂直于这些平面的矢量。参数 $N$ 表示沿堆叠方向的原子层总数，定义了超胞厚度 $L_z = N d_{111}$。\n\n一个关键步骤是确定最小的超胞厚度 $N$，该厚度能将层错与其周期性镜像充分隔离，从而最大限度地减少污染计算能量的赝相互作用。问题提供了一个具有物理动机的模型，用于描述单位面积层错能 $\\gamma(N)$ 相对于原子层数 $N$ 的收敛性：\n$$\n\\gamma(N) = \\gamma_{\\infty} + C \\exp\\!\\left(-\\frac{N d_{111}}{\\lambda}\\right)\n$$\n此处，$\\gamma_{\\infty}$ 是在无限厚度极限下的真实层错能，$C$ 是一个振幅因子，$\\lambda$ 是材料的特征屏蔽长度。收敛性由两个同时成立的标准确定。\n\n第一个标准针对能量收敛。我们要求当胞元厚度从 $N$ 层增加到 $N+\\Delta N$ 层时，计算出的层错能的变化量小于指定的容差 $\\delta_{\\gamma}$：\n$$\n|\\gamma(N+\\Delta N) - \\gamma(N)| = \\left|C \\left( e^{-(N+\\Delta N)d_{111}/\\lambda} - e^{-Nd_{111}/\\lambda} \\right)\\right| \\le \\delta_{\\gamma}\n$$\n第二个标准针对超胞边界处的残余应变。由缺陷引起的位移场随距离衰减。到最近周期性镜像中点处的位移 $u_{\\mathrm{boundary}}$ 必须低于容差 $u_{\\mathrm{tol}}$：\n$$\nu_{\\mathrm{boundary}}(N) = \\frac{b}{2} \\exp\\!\\left(-\\frac{N d_{111}}{\\lambda}\\right) \\le u_{\\mathrm{tol}}\n$$\n该算法从 $N_{\\min}$ 开始，以 $\\Delta N$ 为步长，遍历到 $N_{\\max}$，选择满足这两个条件的最小 $N$。如果在给定范围内找不到这样的 $N$，则认为系统未收敛，并将 $N$ 设置为 $N_{\\max}$。\n\n一旦确定了超胞厚度 $N$，我们就为电子结构计算定义参数。在 DFT 中，布洛赫态在倒易空间中的一个离散网格上进行采样，这个网格被称为 Monkhorst-Pack (MP) 网格。倒易晶格矢量是矩阵 $B = 2\\pi (A^T)^{-1}$ 的列，它们定义了倒易晶胞。为确保对布里渊区的充分采样，沿每个倒易晶格方向 $i$ 的 $k$ 点数（表示为 $N_{k,i}$）的选择要使得 $k$ 点之间的间距不大于目标值 $\\Delta k_{\\mathrm{target}}$：\n$$\nN_{k,i} = \\left\\lceil \\frac{|b_i|}{\\Delta k_{\\mathrm{target}}} \\right\\rceil\n$$\n其中 $|b_i|$ 是第 $i$ 个倒易晶格矢量的模长。\n\n电子波函数在一组平面波基下展开，并在一个最大动能，即截断能 $E_{\\mathrm{cut}}$ 处截断。该截断能与基组中包含的倒易晶格矢量最大模长 $G_{\\max}$ 相关：\n$$\nE_{\\mathrm{cut}} = \\frac{\\hbar^2 G_{\\max}^2}{2 m_e}\n$$\n其中 $\\hbar$ 是约化普朗克常数，$m_e$ 是电子质量。$G_{\\max}$ 的值决定了可以被精确表示的最小实空间特征。根据 Nyquist-Shannon 采样定理，实空间网格间距为 $h$ 要求 $G_{\\max} \\ge \\pi/h$。为了精确解析原子核附近波函数的快速振荡（由具有特征核心半径 $r_c$ 的赝势描述），引入了一个安全余量 $s_{\\mathrm{margin}}$，将目标实空间分辨率设置为 $h = r_c / s_{\\mathrm{margin}}$。这导出了截断能的公式，通常以电子伏特 (eV) 表示。\n\n最后，为了控制计算成本，通常的做法是只弛豫靠近缺陷的原子层的位置，因为这些地方的应变最大。其余的原子层则固定在其理想的体相位置。这个弛豫区域的厚度 $t_{\\mathrm{relax}}$ 与特征衰减长度 $\\lambda$ 按一个因子 $\\alpha_{\\mathrm{relax}}$ 进行缩放。需要弛豫的原子层数 $n_{\\mathrm{relax}}$ 则是覆盖该厚度的最小整数层数：\n$$\nn_{\\mathrm{relax}} = \\left\\lceil \\frac{t_{\\mathrm{relax}}}{d_{111}} \\right\\rceil = \\left\\lceil \\frac{\\alpha_{\\mathrm{relax}} \\lambda}{d_{111}} \\right\\rceil\n$$\n这就完成了确定必要计算参数的工作流程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Implements the numerical workflow to determine DFT parameters for\n    stacking fault energy calculations based on the provided problem statement.\n    \"\"\"\n    \n    # This constant represents h-bar^2 / (2 * m_e) in units of eV * Angstrom^2.\n    # It is used to convert the G_max^2 (in A^-2) to E_cut (in eV).\n    HBAR2_OVER_2M_EV_A2 = 3.809982\n\n    test_cases = [\n        # Case 1 (happy path, aluminum-like)\n        (4.05, 3, 3, 0.025, 1.25, 2.5, 2.0, 150.0, 50.0, 1.0, 0.010, 12, 40, 2, 3.0),\n        # Case 2 (different lattice and tolerances, nickel-like)\n        (3.52, 4, 4, 0.030, 1.10, 2.2, 1.5, 125.0, 40.0, 0.5, 0.008, 16, 50, 2, 3.0),\n        # Case 3 (edge case with strict energy tolerance and small in-plane cell, copper-like)\n        (3.61, 2, 2, 0.020, 1.00, 3.0, 1.0, 45.0, 60.0, 0.010, 0.005, 10, 18, 2, 2.0)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        a, m, n, delta_k_target, r_c, s_margin, lmbda, gamma_inf, C, delta_gamma, u_tol, N_min, N_max, delta_N, alpha_relax = case\n\n        # Step 1: Compute fundamental parameters\n        d_111 = a / np.sqrt(3)\n        b = a / np.sqrt(6)\n\n        # Step 2: Iterate to find the converged number of layers N\n        N_opt = N_max\n        converged = False\n        \n        for N in range(N_min, N_max + 1, delta_N):\n            # Energy convergence criterion\n            gamma_N = gamma_inf + C * np.exp(-N * d_111 / lmbda)\n            gamma_N_plus_delta = gamma_inf + C * np.exp(-(N + delta_N) * d_111 / lmbda)\n            energy_diff = np.abs(gamma_N_plus_delta - gamma_N)\n            energy_criterion_met = energy_diff = delta_gamma\n\n            # Displacement convergence criterion\n            u_boundary = (b / 2) * np.exp(-N * d_111 / lmbda)\n            displacement_criterion_met = u_boundary = u_tol\n\n            if energy_criterion_met and displacement_criterion_met:\n                N_opt = N\n                converged = True\n                break\n        \n        # Step 3: Compute Monkhorst-Pack grid N_k\n        u1 = (a / 2) * np.array([1, -1, 0])\n        u2 = (a / 2) * np.array([1, 0, -1])\n        u3 = (a / 3) * np.array([1, 1, 1])\n        \n        # Real-space lattice matrix A (columns are lattice vectors)\n        A = np.array([m * u1, n * u2, N_opt * u3]).T\n        \n        # Reciprocal lattice matrix B\n        B = 2 * np.pi * np.linalg.inv(A).T\n        \n        # Magnitudes of reciprocal lattice vectors\n        b_mags = np.linalg.norm(B, axis=0)\n        \n        # MP grid dimensions\n        Nk = np.ceil(b_mags / delta_k_target).astype(int)\n        N_k1, N_k2, N_k3 = Nk[0], Nk[1], Nk[2]\n\n        # Step 4: Compute plane-wave kinetic energy cutoff E_cut\n        h = r_c / s_margin\n        G_max = np.pi / h\n        E_cut = HBAR2_OVER_2M_EV_A2 * G_max**2\n        E_cut_rounded = round(E_cut, 1)\n\n        # Step 5: Compute number of relaxable layers n_relax\n        t_relax = alpha_relax * lmbda\n        n_relax = int(np.ceil(t_relax / d_111))\n\n        # Collate results for the current case\n        case_result = [E_cut_rounded, N_k1, N_k2, N_k3, N_opt, n_relax, converged]\n        results.append(case_result)\n\n    # Format the final output string to be a single line with no spaces inside lists.\n    # e.g., \"[[item1,item2],[item3,item4]]\"\n    string_results = [str(r).replace(\" \", \"\") for r in results]\n    final_output = f\"[{','.join(string_results)}]\"\n\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "成功的DFT模拟完成后，下一步是从原始输出数据中提取感兴趣的物理量。本练习侧重于界面能作为一种“过剩能量”的基本定义。您将练习如何使用来自完美超胞以及含有层错或孪晶界超胞的总能量，来计算层错能 ($\\gamma_{\\mathrm{sf}}$) 和孪晶界能 ($\\gamma_{\\mathrm{tb}}$)，并特别注意周期性边界条件的影响。",
            "id": "3840557",
            "problem": "一个面心立方（FCC）金属在周期性边界条件下通过密度泛函理论（DFT）进行模拟。其目标是计算内禀堆垛层错和共格孪晶界的单位面积界面能，分别表示为 $\\gamma_{\\mathrm{sf}}$ 和 $\\gamma_{\\mathrm{tb}}$。使用以下基本思想：界面能定义为，在相同的热力学状态下，相对于完美的块体参考，形成界面所需的单位面积过剩能量；并且，在周期性边界条件下，一个超胞可能包含多个相同的界面，其贡献必须被恰当地考虑。\n\n以下总能量和超胞特征是在零外部应力和相同计算设置下，通过收敛的DFT计算获得的：\n- 完美的FCC超胞：$N_{\\mathrm{fcc}} = 144$ 个原子，总能量 $E_{\\mathrm{fcc}} = -504.000~\\mathrm{eV}$。\n- 包含内禀堆垛层错的超胞：$N_{\\mathrm{sf}} = 144$ 个原子，总能量 $E_{\\mathrm{sf}} = -501.760~\\mathrm{eV}$。由于垂直于$\\{111\\}$晶面的周期性边界条件，该超胞每个晶胞包含 $m_{\\mathrm{sf}} = 2$ 个等效的堆垛层错面。\n- 包含共格孪晶界（CTBs）的超胞：$N_{\\mathrm{tb}} = 144$ 个原子，总能量 $E_{\\mathrm{tb}} = -503.002~\\mathrm{eV}$。由于镜像对称的周期性，该超胞每个晶胞包含 $m_{\\mathrm{tb}} = 2$ 个孪晶界。\n\n在两个有缺陷的超胞中，平面缺陷均位于相同的$\\{111\\}$晶面上；该晶面在超胞内的面内面积为 $A = 400~\\text{\\AA}^{2}$。\n\n从界面能作为单位面积过剩能量的基本定义出发，并仔细考虑由于周期性镜像而存在的等效界面数量，推导出 $\\gamma_{\\mathrm{sf}}$ 和 $\\gamma_{\\mathrm{tb}}$ 关于给定量的表达式，并进行数值计算。使用完美的FCC超胞来定义每个原子的块体参考能量。将 $\\gamma_{\\mathrm{sf}}$ 和 $\\gamma_{\\mathrm{tb}}$ 均以 $\\mathrm{mJ/m}^{2}$ 为单位表示，并将每个最终值四舍五入到三位有效数字。\n\n使用精确的物理常数 $1~\\mathrm{eV} = 1.602176634 \\times 10^{-19}~\\mathrm{J}$ 和 $1~\\text{\\AA} = 10^{-10}~\\mathrm{m}$。",
            "solution": "该问题是有效的，因为它科学地基于计算材料科学的原理，问题适定且提供了所有必要数据，并且其表述是客观的。对于一个面心立方（FCC）金属的密度泛函理论（DFT）研究来说，这些数据是自洽且合理的。\n\n单位面积的界面能 $\\gamma$ 的基本定义是，一个包含界面的系统的过剩能量 $\\Delta E_{\\text{excess}}$（相对于一个完美的块体参考）除以界面（们）的总面积 $A_{\\text{total}}$。\n$$\n\\gamma = \\frac{\\Delta E_{\\text{excess}}}{A_{\\text{total}}}\n$$\n过剩能量 $\\Delta E_{\\text{excess}}$ 是包含缺陷的超胞的总能量 $E_{\\text{defective}}$ 与等量原子在完美的、无缺陷的块体构型中的能量 $E_{\\text{reference}}$ 之间的差值。\n$$\n\\Delta E_{\\text{excess}} = E_{\\text{defective}} - E_{\\text{reference}}\n$$\n参考能量是使用完美块体材料中每个原子的能量 $E_{\\text{atom, bulk}}$ 来计算的。该值从完美的FCC超胞计算中获得。给定包含 $N_{\\mathrm{fcc}}$ 个原子的完美超胞的总能量为 $E_{\\mathrm{fcc}}$，则每个原子的能量为：\n$$\nE_{\\text{atom, bulk}} = \\frac{E_{\\mathrm{fcc}}}{N_{\\mathrm{fcc}}}\n$$\n对于一个包含 $N_{\\text{defective}}$ 个原子的有缺陷的超胞，其参考能量为 $E_{\\text{reference}} = N_{\\text{defective}} \\cdot E_{\\text{atom, bulk}}$。在本问题中，所有超胞都包含相同数量的原子，即 $N_{\\mathrm{fcc}} = N_{\\mathrm{sf}} = N_{\\mathrm{tb}} = 144$。这简化了过剩能量的计算。对于任何有缺陷的超胞，其参考能量就是 $E_{\\mathrm{fcc}}$。\n$$\nE_{\\text{reference}} = N_{\\text{defective}} \\cdot \\frac{E_{\\mathrm{fcc}}}{N_{\\mathrm{fcc}}} = N_{\\mathrm{fcc}} \\cdot \\frac{E_{\\mathrm{fcc}}}{N_{\\mathrm{fcc}}} = E_{\\mathrm{fcc}}\n$$\n由于周期性边界条件，超胞包含多个等效界面。如果一个面内面积为 $A$ 的超胞包含 $m$ 个相同的界面，则总界面面积为 $A_{\\text{total}} = m \\cdot A$。因此，界面能的通用表达式为：\n$$\n\\gamma = \\frac{E_{\\text{defective}} - E_{\\mathrm{fcc}}}{m \\cdot A}\n$$\n\n首先，我们计算内禀堆垛层错能 $\\gamma_{\\mathrm{sf}}$。相关量为：含堆垛层错超胞的总能量 $E_{\\mathrm{sf}} = -501.760~\\mathrm{eV}$，完美参考超胞的总能量 $E_{\\mathrm{fcc}} = -504.000~\\mathrm{eV}$，超胞中的堆垛层错数量 $m_{\\mathrm{sf}} = 2$，以及面内面积 $A = 400~\\text{\\AA}^{2}$。\n与两个堆垛层错相关的过剩能量为：\n$$\n\\Delta E_{\\mathrm{sf}} = E_{\\mathrm{sf}} - E_{\\mathrm{fcc}} = -501.760~\\mathrm{eV} - (-504.000~\\mathrm{eV}) = 2.240~\\mathrm{eV}\n$$\n堆垛层错能 $\\gamma_{\\mathrm{sf}}$ 是此过剩能量除以两个层错的总面积：\n$$\n\\gamma_{\\mathrm{sf}} = \\frac{\\Delta E_{\\mathrm{sf}}}{m_{\\mathrm{sf}} \\cdot A} = \\frac{2.240~\\mathrm{eV}}{2 \\cdot 400~\\text{\\AA}^{2}} = \\frac{2.240~\\mathrm{eV}}{800~\\text{\\AA}^{2}} = 0.0028~\\mathrm{eV/\\AA^2}\n$$\n\n接下来，我们计算共格孪晶界能 $\\gamma_{\\mathrm{tb}}$。相关量为：含孪晶界超胞的总能量 $E_{\\mathrm{tb}} = -503.002~\\mathrm{eV}$，参考能量 $E_{\\mathrm{fcc}} = -504.000~\\mathrm{eV}$，孪晶界数量 $m_{\\mathrm{tb}} = 2$，以及面积 $A = 400~\\text{\\AA}^{2}$。\n与两个孪晶界相关的过剩能量为：\n$$\n\\Delta E_{\\mathrm{tb}} = E_{\\mathrm{tb}} - E_{\\mathrm{fcc}} = -503.002~\\mathrm{eV} - (-504.000~\\mathrm{eV}) = 0.998~\\mathrm{eV}\n$$\n孪晶界能 $\\gamma_{\\mathrm{tb}}$ 是此过剩能量除以两个孪晶界的总面积：\n$$\n\\gamma_{\\mathrm{tb}} = \\frac{\\Delta E_{\\mathrm{tb}}}{m_{\\mathrm{tb}} \\cdot A} = \\frac{0.998~\\mathrm{eV}}{2 \\cdot 400~\\text{\\AA}^{2}} = \\frac{0.998~\\mathrm{eV}}{800~\\text{\\AA}^{2}} = 0.0012475~\\mathrm{eV/\\AA^2}\n$$\n\n最后，我们必须将这些能量的单位从 $\\mathrm{eV/\\AA^2}$ 转换为 $\\mathrm{mJ/m^2}$。我们使用给定的转换因子：$1~\\mathrm{eV} = 1.602176634 \\times 10^{-19}~\\mathrm{J}$ 和 $1~\\text{\\AA} = 10^{-10}~\\mathrm{m}$。\n从 $\\mathrm{eV/\\AA^2}$ 到 $\\mathrm{J/m^2}$ 的转换因子是：\n$$\n1~\\frac{\\mathrm{eV}}{\\text{\\AA}^2} = \\frac{1.602176634 \\times 10^{-19}~\\mathrm{J}}{(10^{-10}~\\mathrm{m})^2} = \\frac{1.602176634 \\times 10^{-19}~\\mathrm{J}}{10^{-20}~\\mathrm{m}^2} = 16.02176634~\\frac{\\mathrm{J}}{\\mathrm{m}^2}\n$$\n由于 $1~\\mathrm{J} = 1000~\\mathrm{mJ}$，转换为 $\\mathrm{mJ/m^2}$ 的计算如下：\n$$\n1~\\frac{\\mathrm{eV}}{\\text{\\AA}^2} = 16.02176634~\\frac{\\mathrm{J}}{\\mathrm{m}^2} \\times 1000~\\frac{\\mathrm{mJ}}{\\mathrm{J}} = 16021.76634~\\frac{\\mathrm{mJ}}{\\mathrm{m}^2}\n$$\n现在我们将此转换因子应用于我们计算出的能量。\n对于堆垛层错能：\n$$\n\\gamma_{\\mathrm{sf}} = 0.0028~\\frac{\\mathrm{eV}}{\\text{\\AA}^2} \\times 16021.76634~\\frac{\\mathrm{mJ/m}^2}{\\mathrm{eV/\\AA}^2} \\approx 44.8609~\\frac{\\mathrm{mJ}}{\\mathrm{m}^2}\n$$\n四舍五入到三位有效数字，我们得到 $\\gamma_{\\mathrm{sf}} = 44.9~\\mathrm{mJ/m}^2$。\n\n对于孪晶界能：\n$$\n\\gamma_{\\mathrm{tb}} = 0.0012475~\\frac{\\mathrm{eV}}{\\text{\\AA}^2} \\times 16021.76634~\\frac{\\mathrm{mJ/m}^2}{\\mathrm{eV/\\AA}^2} \\approx 19.9872~\\frac{\\mathrm{mJ}}{\\mathrm{m}^2}\n$$\n四舍五入到三位有效数字，我们得到 $\\gamma_{\\mathrm{tb}} = 20.0~\\mathrm{mJ/m}^2$。\n\n堆垛层错能和孪晶界能的最终结果分别为 $44.9~\\mathrm{mJ/m}^2$ 和 $20.0~\\mathrm{mJ/m}^2$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 44.9  20.0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "多尺度模拟的一个关键目标是利用在一个尺度上计算的参数来预测另一尺度上的行为。本实践将量子力学层面的层错能（如前述练习中用DFT计算）与位错的介观尺度行为联系起来。通过平衡两个肖克利不全位错之间的弹性排斥力与层錯带产生的吸引力，您将推导出平衡分离距离，从而在材料的电子结构和其力学性能之间建立起切实的联系。",
            "id": "3840530",
            "problem": "在晶格常数为 $a$ 的面心立方 (FCC) 金属中，有一条直的完整位错，该位错位于 $\\{111\\}$ 滑移面上，其线方向平行于 $[1\\,\\overline{1}\\,0]$。该材料是弹性各向同性的，剪切模量为 $\\mu$，泊松比为 $\\nu$。该完整位错是纯螺位错，其伯格斯矢量为 $\\mathbf{b} = \\frac{a}{2}[1\\,\\overline{1}\\,0]$，并在 $(111)$ 面上分解为两个肖克利（Shockley）不全位错，其伯格斯矢量分别为\n- $\\mathbf{b}_{1} = \\frac{a}{6}[2\\,\\overline{1}\\,\\overline{1}]$,\n- $\\mathbf{b}_{2} = \\frac{a}{6}[1\\,\\overline{2}\\,1]$,\n它们在 $(111)$ 平面内沿着垂直于位错线方向的距离为 $d$。两个不全位错之间的区域是一个层错，其能量密度（单位面积的能量）为 $\\gamma_{\\mathrm{sf}}$。\n\n假设材料为线性各向同性弹性体，无外加应力，并忽略位错核心和镜像力。从各向同性弹性理论中位错相互作用的基本定义出发（例如，Peach–Koehler 力以及将混合位错分解为螺型和刃型分量），并将层错视为贡献了单位长度能量 $E_{\\mathrm{sf}}(d) = \\gamma_{\\mathrm{sf}} d$，推导出一个显式解析表达式，用于描述由两个不全位错的弹性排斥力与层错引起的吸引力相平衡所产生的平衡间距 $d$。\n\n假设所有物理量均以国际单位制 (SI) 表示。将最终间距 $d$（单位为米）表示为以 $\\mu$、$\\nu$、$a$ 和 $\\gamma_{\\mathrm{sf}}$ 表示的封闭形式表达式。无需取整。",
            "solution": "该问题要求推导在一个 FCC 晶体中，由一个完整螺位错分解产生的两个肖克利（Shockley）不全位错之间的平衡间距 $d$。当两个不全位错之间的弹性排斥力与连接它们的层错带所施加的吸引力完全平衡时，达到平衡状态。\n\n由层错引起的单位长度上的吸引力 $F_{\\mathrm{attr}}/L$ 是一个常数，其大小等于单位面积的层错能 $\\gamma_{\\mathrm{sf}}$。该力作用于使层错面积最小化，从而将两个不全位错拉近。\n$$ \\frac{F_{\\mathrm{attr}}}{L} = \\gamma_{\\mathrm{sf}} $$\n\n在两个平行的位错（标记为 1 和 2）之间，当它们在共同的滑移面上相距为 $d$ 时，单位长度上的弹性排斥力 $F_{\\mathrm{rep}}/L$ 由该平面内的力分量公式给出：\n$$ \\frac{F_{\\mathrm{rep}}}{L} = \\frac{\\mu}{2\\pi d} \\left( (\\mathbf{b}_{1s} \\cdot \\mathbf{b}_{2s}) + \\frac{1}{1-\\nu} (\\mathbf{b}_{1e} \\cdot \\mathbf{b}_{2e}) \\right) $$\n这里，$\\mu$ 是剪切模量，$\\nu$ 是泊松比，$\\mathbf{b}_{s}$ 和 $\\mathbf{b}_{e}$ 分别是不全位错伯格斯矢量的螺型和刃型分量。\n\n位错的线方向平行于晶体学方向 $[1\\,\\overline{1}\\,0]$。归一化的线矢量 $\\hat{\\mathbf{t}}$ 为：\n$$ \\hat{\\mathbf{t}} = \\frac{1}{\\sqrt{1^2 + (-1)^2 + 0^2}} [1,-1,0] = \\frac{1}{\\sqrt{2}} [1,-1,0] $$\n\n两个肖克利（Shockley）不全位错的伯格斯矢量为：\n$$ \\mathbf{b}_{1} = \\frac{a}{6}[2\\,\\overline{1}\\,\\overline{1}] $$\n$$ \\mathbf{b}_{2} = \\frac{a}{6}[1\\,\\overline{2}\\,1] $$\n\n我们必须将每个伯格斯矢量分解为其螺型分量（平行于 $\\hat{\\mathbf{t}}$）和刃型分量（垂直于 $\\hat{\\mathbf{t}}$）。矢量 $\\mathbf{b}$ 的螺型分量由 $\\mathbf{b}_s = (\\mathbf{b} \\cdot \\hat{\\mathbf{t}})\\hat{\\mathbf{t}}$ 给出。\n\n对于第一个不全位错 $\\mathbf{b}_1$：\n其在线方向上的标量投影为：\n$$ \\mathbf{b}_{1} \\cdot \\hat{\\mathbf{t}} = \\frac{a}{6}[2,-1,-1] \\cdot \\frac{1}{\\sqrt{2}}[1,-1,0] = \\frac{a}{6\\sqrt{2}}((2)(1) + (-1)(-1) + (-1)(0)) = \\frac{a}{6\\sqrt{2}}(3) = \\frac{a}{2\\sqrt{2}} $$\n螺型分量矢量为：\n$$ \\mathbf{b}_{1s} = \\left(\\frac{a}{2\\sqrt{2}}\\right) \\hat{\\mathbf{t}} = \\frac{a}{2\\sqrt{2}} \\left(\\frac{1}{\\sqrt{2}}[1,-1,0]\\right) = \\frac{a}{4}[1,-1,0] $$\n刃型分量为 $\\mathbf{b}_{1e} = \\mathbf{b}_1 - \\mathbf{b}_{1s}$：\n$$ \\mathbf{b}_{1e} = \\frac{a}{6}[2,-1,-1] - \\frac{a}{4}[1,-1,0] = a\\left[\\frac{2}{6}-\\frac{1}{4}, -\\frac{1}{6}+\\frac{1}{4}, -\\frac{1}{6}-0\\right] = a\\left[\\frac{4-3}{12}, \\frac{-2+3}{12}, -\\frac{2}{12}\\right] = \\frac{a}{12}[1,1,-2] $$\n\n对于第二个不全位错 $\\mathbf{b}_2$：\n其在线方向上的标量投影为：\n$$ \\mathbf{b}_{2} \\cdot \\hat{\\mathbf{t}} = \\frac{a}{6}[1,-2,1] \\cdot \\frac{1}{\\sqrt{2}}[1,-1,0] = \\frac{a}{6\\sqrt{2}}((1)(1) + (-2)(-1) + (1)(0)) = \\frac{a}{6\\sqrt{2}}(3) = \\frac{a}{2\\sqrt{2}} $$\n螺型分量矢量为：\n$$ \\mathbf{b}_{2s} = \\left(\\frac{a}{2\\sqrt{2}}\\right) \\hat{\\mathbf{t}} = \\frac{a}{4}[1,-1,0] $$\n刃型分量为 $\\mathbf{b}_{2e} = \\mathbf{b}_2 - \\mathbf{b}_{2s}$：\n$$ \\mathbf{b}_{2e} = \\frac{a}{6}[1,-2,1] - \\frac{a}{4}[1,-1,0] = a\\left[\\frac{1}{6}-\\frac{1}{4}, -\\frac{2}{6}+\\frac{1}{4}, \\frac{1}{6}-0\\right] = a\\left[\\frac{2-3}{12}, \\frac{-4+3}{12}, \\frac{2}{12}\\right] = \\frac{a}{12}[-1,-1,2] $$\n注意，$\\mathbf{b}_{1s} = \\mathbf{b}_{2s}$ 且 $\\mathbf{b}_{1e} = -\\mathbf{b}_{2e}$。\n\n现在，我们计算力公式所需的点积：\n$$ \\mathbf{b}_{1s} \\cdot \\mathbf{b}_{2s} = \\left(\\frac{a}{4}[1,-1,0]\\right) \\cdot \\left(\\frac{a}{4}[1,-1,0]\\right) = \\frac{a^2}{16}(1^2 + (-1)^2 + 0^2) = \\frac{2a^2}{16} = \\frac{a^2}{8} $$\n$$ \\mathbf{b}_{1e} \\cdot \\mathbf{b}_{2e} = \\left(\\frac{a}{12}[1,1,-2]\\right) \\cdot \\left(\\frac{a}{12}[-1,-1,2]\\right) = \\frac{a^2}{144}((1)(-1) + (1)(-1) + (-2)(2)) = \\frac{a^2}{144}(-1-1-4) = -\\frac{6a^2}{144} = -\\frac{a^2}{24} $$\n\n将这些点积代入单位长度排斥力的表达式中：\n$$ \\frac{F_{\\mathrm{rep}}}{L} = \\frac{\\mu}{2\\pi d} \\left( \\frac{a^2}{8} + \\frac{1}{1-\\nu} \\left(-\\frac{a^2}{24}\\right) \\right) = \\frac{\\mu a^2}{2\\pi d} \\left( \\frac{1}{8} - \\frac{1}{24(1-\\nu)} \\right) $$\n为简化括号中的项，我们找到一个公分母：\n$$ \\frac{F_{\\mathrm{rep}}}{L} = \\frac{\\mu a^2}{2\\pi d} \\left( \\frac{3(1-\\nu) - 1}{24(1-\\nu)} \\right) = \\frac{\\mu a^2}{2\\pi d} \\left( \\frac{3 - 3\\nu - 1}{24(1-\\nu)} \\right) = \\frac{\\mu a^2 (2 - 3\\nu)}{48\\pi d (1-\\nu)} $$\n\n在平衡状态下，排斥力等于吸引力：\n$$ \\frac{F_{\\mathrm{rep}}}{L} = \\frac{F_{\\mathrm{attr}}}{L} $$\n$$ \\frac{\\mu a^2 (2 - 3\\nu)}{48\\pi d (1-\\nu)} = \\gamma_{\\mathrm{sf}} $$\n\n最后，我们求解平衡间距 $d$：\n$$ d = \\frac{\\mu a^2 (2 - 3\\nu)}{48\\pi \\gamma_{\\mathrm{sf}} (1-\\nu)} $$\n这就是平衡间距的封闭形式表达式。",
            "answer": "$$\n\\boxed{\\frac{\\mu a^{2} (2 - 3\\nu)}{48\\pi \\gamma_{\\mathrm{sf}} (1-\\nu)}}\n$$"
        }
    ]
}