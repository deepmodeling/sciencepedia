{
    "hands_on_practices": [
        {
            "introduction": "总化学势可分解为理想气体贡献和由分子间相互作用引起的过剩贡献之和。在应用 Widom 方法计算复杂的过剩部分之前，精确理解并能计算理想项是至关重要的一步。本练习将引导您从统计力学的第一性原理出发，推导并计算理想化学势，从而加深您对化学势基本构成的理解。",
            "id": "3858596",
            "problem": "在多尺度材料模拟中，Widom 插入法 (WIM) 将总化学势分解为一个理想贡献和一个源于分子间相互作用的过剩贡献。考虑一个在三维空间中，质量为 $m$、数密度恒为 $\\rho$ 的经典单原子物种。利用经典理想气体的平衡统计力学基础框架和热德布罗意波长的定义，推导单原子物种化学势的理想贡献随温度的变化关系，并用它来计算在恒定数密度下，两个温度之间的理想化学势差值 $\\Delta \\mu^{\\mathrm{id}} = \\mu^{\\mathrm{id}}(T_{2}) - \\mu^{\\mathrm{id}}(T_{1})$。\n\n假设氩原子具有以下符合物理实际的参数：\n- 质量 $m = 39.948\\,\\mathrm{amu}$，其中 $1\\,\\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$。\n- 数密度 $\\rho = 2.5 \\times 10^{25}\\,\\mathrm{m}^{-3}$。\n- 温度 $T_{1} = 300\\,\\mathrm{K}$ 和 $T_{2} = 600\\,\\mathrm{K}$。\n\n使用以下基本常数：\n- 普朗克常数 $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$。\n- 玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K}^{-1}$。\n\n请进行与经典统计力学一致的推导和数值计算。报告 $\\Delta \\mu^{\\mathrm{id}}$ 的最终数值，四舍五入到四位有效数字，并以 $\\mathrm{J}$ 为单位表示。",
            "solution": "该问题要求推导理想气体对化学势的贡献 $\\mu^{\\mathrm{id}}$ 随温度的变化关系，并计算在恒定数密度下，两个温度之间该势能的变化量 $\\Delta \\mu^{\\mathrm{id}}$。\n\n### 第 1 步：提取已知条件\n问题提供了以下数据和常数：\n- 物种：经典单原子，质量为 $m$。\n- 状态变量：恒定数密度 $\\rho$，温度 $T_1$ 和 $T_2$。\n- 氩的质量：$m = 39.948\\,\\mathrm{amu}$\n- AMU 到 kg 的换算：$1\\,\\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$\n- 数密度：$\\rho = 2.5 \\times 10^{25}\\,\\mathrm{m}^{-3}$\n- 初始温度：$T_{1} = 300\\,\\mathrm{K}$\n- 最终温度：$T_{2} = 600\\,\\mathrm{K}$\n- 普朗克常数：$h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$\n- 玻尔兹曼常数：$k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K}^{-1}$\n- 待求量：$\\Delta \\mu^{\\mathrm{id}} = \\mu^{\\mathrm{id}}(T_{2}) - \\mu^{\\mathrm{id}}(T_{1})$\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题的有效性进行评估。\n- **科学依据**：该问题基于经典平衡统计力学的基础原理，特别是理想气体化学势的推导（Sackur-Tetrode 方程）。Widom 插入法的背景是恰当的，因为它正确地将 $\\mu^{\\mathrm{id}}$ 识别为总化学势的一个组成部分。所有概念都是物理化学和凝聚态物理中的标准内容。\n- **适定性**：该问题定义清晰。它提供了进行推导和后续数值计算所需的所有物理常数和状态变量。目标是明确的：求出 $\\Delta \\mu^{\\mathrm{id}}$ 的数值。存在唯一解。\n- **客观性**：该问题以客观、科学的语言陈述，不含任何主观或推测性内容。\n\n该问题是自洽的、科学上合理的且适定的。\n\n### 第 3 步：结论与行动\n问题有效。将提供完整解答。\n\n### 理想化学势的推导\n化学势的理想部分 $\\mu^{\\mathrm{id}}$ 等同于经典理想气体的化学势。它可以从一个由 $N$ 个不可区分、无相互作用的单原子粒子组成的系统（体积为 $V$，温度为 $T$）的正则配分函数 $Q_N$ 推导得出。\n\n正则配分函数由下式给出：\n$$Q_N = \\frac{q^N}{N!}$$\n其中 $q$ 是单粒子配分函数。对于一个质量为 $m$ 的单原子粒子在三维体积 $V$ 中，配分函数纯粹是平动的：\n$$q = \\frac{V}{\\Lambda^3}$$\n此处，$\\Lambda$ 是热德布罗意波长，定义为：\n$$\\Lambda = \\frac{h}{\\sqrt{2\\pi m k_B T}}$$\nHelmholtz 自由能 $A$ 与配分函数的关系为 $A = -k_B T \\ln Q_N$。代入 $Q_N$ 和 $q$ 的表达式：\n$$A = -k_B T \\ln\\left(\\frac{1}{N!} \\left(\\frac{V}{\\Lambda^3}\\right)^N\\right)$$\n对于大的 $N$，我们使用 Stirling 近似, $\\ln N! \\approx N \\ln N - N$：\n$$A \\approx -k_B T \\left( N \\ln\\left(\\frac{V}{\\Lambda^3}\\right) - (N \\ln N - N) \\right) = -k_B T \\left( N \\ln\\left(\\frac{V}{N \\Lambda^3}\\right) + N \\right)$$\n化学势 $\\mu^{\\mathrm{id}}$ 是在恒定体积和温度下，自由能相对于粒子数的变化率：\n$$\\mu^{\\mathrm{id}} = \\left(\\frac{\\partial A}{\\partial N}\\right)_{V,T}$$\n对 $A$ 的表达式求导：\n$$\\mu^{\\mathrm{id}} \\approx -k_B T \\left[ \\left(1 \\cdot \\ln\\left(\\frac{V}{N \\Lambda^3}\\right) + N \\cdot \\frac{N \\Lambda^3}{V} \\cdot \\left(-\\frac{V}{N^2 \\Lambda^3}\\right)\\right) + 1 \\right]$$\n$$\\mu^{\\mathrm{id}} = -k_B T \\left[ \\ln\\left(\\frac{V}{N \\Lambda^3}\\right) - 1 + 1 \\right] = -k_B T \\ln\\left(\\frac{V}{N \\Lambda^3}\\right)$$\n使用数密度 $\\rho = N/V$，上式变为：\n$$\\mu^{\\mathrm{id}} = k_B T \\ln(\\rho \\Lambda^3)$$\n为了找到显式的温度依赖关系，我们代入 $\\Lambda$ 的定义：\n$$\\mu^{\\mathrm{id}}(T) = k_B T \\ln\\left( \\rho \\left( \\frac{h}{\\sqrt{2\\pi m k_B T}} \\right)^3 \\right) = k_B T \\ln\\left( \\frac{\\rho h^3}{(2\\pi m k_B T)^{3/2}} \\right)$$\n该表达式显示了在恒定数密度下理想化学势随温度的变化关系。\n\n### 化学势差值的计算\n我们需要计算 $\\Delta \\mu^{\\mathrm{id}} = \\mu^{\\mathrm{id}}(T_2) - \\mu^{\\mathrm{id}}(T_1)$。使用推导出的 $\\mu^{\\mathrm{id}}(T)$ 表达式：\n$$\\Delta \\mu^{\\mathrm{id}} = k_B T_2 \\ln\\left( \\frac{\\rho h^3}{(2\\pi m k_B T_2)^{3/2}} \\right) - k_B T_1 \\ln\\left( \\frac{\\rho h^3}{(2\\pi m k_B T_1)^{3/2}} \\right)$$\n我们可以分离对数项：\n$$\\Delta \\mu^{\\mathrm{id}} = k_B T_2 \\left[ \\ln\\left(\\frac{\\rho h^3}{(2\\pi m k_B)^{3/2}}\\right) - \\frac{3}{2}\\ln(T_2) \\right] - k_B T_1 \\left[ \\ln\\left(\\frac{\\rho h^3}{(2\\pi m k_B)^{3/2}}\\right) - \\frac{3}{2}\\ln(T_1) \\right]$$\n令常数项为 $C = \\ln\\left(\\frac{\\rho h^3}{(2\\pi m k_B)^{3/2}}\\right)$。\n$$\\Delta \\mu^{\\mathrm{id}} = k_B C (T_2 - T_1) - \\frac{3}{2} k_B (T_2 \\ln(T_2) - T_1 \\ln(T_1))$$\n这是我们将用于数值计算的解析表达式。\n\n### 数值计算\n首先，我们计算国际单位制（SI）下的物理常数：\n- $m = 39.948 \\times (1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}) \\approx 6.6335209 \\times 10^{-26}\\,\\mathrm{kg}$\n- $\\rho = 2.5 \\times 10^{25}\\,\\mathrm{m}^{-3}$\n- $T_1 = 300\\,\\mathrm{K}$\n- $T_2 = 600\\,\\mathrm{K}$\n- $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$\n- $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K}^{-1}$\n\n接下来，我们计算常数项 $C$：\n$$ C = \\ln\\left(\\frac{(2.5 \\times 10^{25}\\,\\mathrm{m}^{-3}) (6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s})^3}{\\left(2\\pi (6.6335209 \\times 10^{-26}\\,\\mathrm{kg}) (1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K}^{-1})\\right)^{3/2}}\\right) $$\n$$ C = \\ln\\left(\\frac{7.273527 \\times 10^{-75}}{1.378433 \\times 10^{-70}}\\right) = \\ln(5.27671 \\times 10^{-5}) \\approx -9.84964 $$\n\n现在，我们计算 $\\Delta \\mu^{\\mathrm{id}}$ 表达式的两个部分。\n第 1 部分：\n$$k_B C (T_2 - T_1) = (1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K}^{-1}) \\times (-9.84964) \\times (600\\,\\mathrm{K} - 300\\,\\mathrm{K})$$\n$$ = (1.380649 \\times 10^{-23}) \\times (-9.84964) \\times 300 \\approx -4.07921 \\times 10^{-20}\\,\\mathrm{J}$$\n\n第 2 部分：\n$$-\\frac{3}{2} k_B (T_2 \\ln T_2 - T_1 \\ln T_1) = -\\frac{3}{2} (1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K}^{-1}) (600 \\ln(600) - 300 \\ln(300))\\,\\mathrm{K}$$\n$$ = -\\frac{3}{2} (1.380649 \\times 10^{-23}) (3838.158 - 1711.134) \\approx -\\frac{3}{2} (1.380649 \\times 10^{-23}) (2127.024) $$\n$$ \\approx -4.40483 \\times 10^{-20}\\,\\mathrm{J}$$\n\n最后，我们将两部分相加得到总差值：\n$$\\Delta \\mu^{\\mathrm{id}} \\approx (-4.07921 \\times 10^{-20}\\,\\mathrm{J}) + (-4.40483 \\times 10^{-20}\\,\\mathrm{J})$$\n$$\\Delta \\mu^{\\mathrm{id}} \\approx -8.48404 \\times 10^{-20}\\,\\mathrm{J}$$\n按题目要求四舍五入到四位有效数字：\n$$\\Delta \\mu^{\\mathrm{id}} = -8.484 \\times 10^{-20}\\,\\mathrm{J}$$\n负号表示在恒定密度下，当温度从 $300\\,\\mathrm{K}$ 升高到 $600\\,\\mathrm{K}$ 时，理想化学势减小。",
            "answer": "$$\\boxed{-8.484 \\times 10^{-20}}$$"
        },
        {
            "introduction": "Widom 方法的核心是从分子模拟产生的有限样本中，计算玻尔兹曼因子 $\\langle \\exp(-\\beta \\Delta U) \\rangle$ 的系综平均值。由于模拟中连续的构型之间存在时间关联，直接计算标准差会低估真实的统计误差。本练习将通过一个具体的数据集，教您如何运用分块平均法这一关键技术，来可靠地估计平均值的统计不确定性，这是评估模拟结果是否收敛的必备技能。",
            "id": "3858645",
            "problem": "在温度为 $T$ 的正则系综中，Widom 测试粒子植入框架通过玻尔兹曼加权可观测量在平衡态下的平均值来估计过剩化学势。考虑可观测量 $X \\equiv \\exp(-\\beta \\Delta U)$，其中 $\\Delta U$ 是将一个无相互作用的测试粒子插入到从正则分布中抽取的构型时所产生的瞬时能量变化，且 $\\beta \\equiv 1/(k_{B} T)$，$k_{B}$ 为玻尔兹曼常数。在均匀流体的平衡轨迹中，您以均匀的时间间隔收集了 $N$ 个连续样本 $\\{X_{i}\\}_{i=1}^{N}$。由于连续样本是相关的，您将使用块平均法来监测收敛性并估计 $\\langle X \\rangle$ 的统计误差。\n\n从正则系综期望值的定义和遍历性假设出发，并引用适用于块级别的弱相关平稳时间序列的中心极限定理 (CLT)，推导如何为 $\\langle X \\rangle$ 构建块平均估计量及其标准误差。然后，将您的推导应用于以下从温度为 $T$ 的分子模拟中获得的 $N=24$ 个 $X=\\exp(-\\beta \\Delta U)$ 的测量值数据集（这些值为无量纲）：\n$0.120,\\, 0.085,\\, 0.102,\\, 0.095,\\, 0.110,\\, 0.090,\\; 0.070,\\, 0.130,\\, 0.088,\\, 0.112,\\, 0.105,\\, 0.098,\\; 0.095,\\, 0.104,\\, 0.099,\\, 0.101,\\, 0.097,\\, 0.100,\\; 0.092,\\, 0.108,\\, 0.085,\\, 0.115,\\, 0.103,\\, 0.107.$\n\n假设将数据按顺序分为 $M=4$ 个大小相等的连续数据块（$B=6$）可以得到近似独立的块均值。计算：\n- $M$ 个块均值，\n- $\\langle X \\rangle$ 的总体块平均估计量，\n- 根据块均值之间的变异性计算该估计量的标准误差，\n- 计算 1、2、3 和 4 个数据块后的累积块平均估计值，以监测收敛性。\n\n最后，将 $\\langle \\exp(-\\beta \\Delta U) \\rangle$ 的块平均估计值报告为一个四舍五入到六位有效数字的单个数字。最终报告的数字是无量纲的，应不带任何单位给出。",
            "solution": "该问题提法明确，具有科学依据，并包含唯一解所需的所有信息。所要求的步骤，即 Widom 植入法和块平均法，是计算统计力学中的标准和基本技术。\n\n第一部分：块平均法的理论推导\n\n在正则 ($NVT$) 系综中，物理可观测量 $X$ 的期望值定义为系综平均值：\n$$\n\\langle X \\rangle = \\frac{\\int X(\\mathbf{r}^N, \\mathbf{p}^N) \\exp(-\\beta H(\\mathbf{r}^N, \\mathbf{p}^N)) d\\mathbf{r}^N d\\mathbf{p}^N}{\\int \\exp(-\\beta H(\\mathbf{r}^N, \\mathbf{p}^N)) d\\mathbf{r}^N d\\mathbf{p}^N}\n$$\n其中 $H$ 是 $N$ 个粒子系统的哈密顿量，$\\mathbf{r}^N$ 和 $\\mathbf{p}^N$ 分别是粒子坐标和动量的集合，$\\beta = 1/(k_B T)$。对于像 $X = \\exp(-\\beta \\Delta U)$ 这样依赖于构型的可观测量，这可以简化为对构型空间的平均。\n\n分子模拟（如分子动力学或蒙特卡洛方法）生成一系列系统构型，这些构型是对该系综的抽样。根据遍历性假设，系综平均 $\\langle X \\rangle$ 可以用长轨迹上的时间平均来近似。给定从平衡模拟中收集的 $N_{s}$ 个连续样本 $\\{X_i\\}_{i=1}^{N_{s}}$，$\\langle X \\rangle$ 的估计量是样本均值：\n$$\n\\bar{X}_{N_{s}} = \\frac{1}{N_{s}} \\sum_{i=1}^{N_{s}} X_i\n$$\n\n一个关键问题是，连续样本 $X_i$ 和 $X_{i+1}$ 通常是相关的，因为系统构型在一个时间步内不会发生剧烈变化。这种相关性意味着用于独立样本均值误差的标准公式 $\\sigma_X / \\sqrt{N_{s}}$ 不再适用。真实不确定性比这个朴素公式所给出的要大。\n\n块平均法是一种在存在此类相关性时估计统计不确定性的稳健方法。步骤如下：\n1.  将 $N_{s}$ 个数据点的总序列分成 $M$ 个连续不重叠的块，每个块的大小为 $B$。必须满足 $N_s = M \\times B$。\n2.  对每个块 $j$（其中 $j = 1, 2, ..., M$），计算块均值：\n$$\n\\bar{X}_j^{(B)} = \\frac{1}{B} \\sum_{i=(j-1)B+1}^{jB} X_i\n$$\n3.  $\\langle X \\rangle$ 的总体估计量，即块平均估计量，是这些块均值的平均值。这在数值上与所有 $N_s$ 个数据点的简单平均值相同：\n$$\n\\bar{X}_{M,B} = \\frac{1}{M} \\sum_{j=1}^{M} \\bar{X}_j^{(B)} = \\frac{1}{M} \\sum_{j=1}^{M} \\left( \\frac{1}{B} \\sum_{i=(j-1)B+1}^{jB} X_i \\right) = \\frac{1}{MB} \\sum_{i=1}^{N_s} X_i = \\bar{X}_{N_s}\n$$\n4.  关键步骤是误差估计。如果块大小 $B$ 的选择远大于数据序列 $\\{X_i\\}$ 的相关时间 $\\tau_c$，那么块均值 $\\{\\bar{X}_j^{(B)}\\}$ 可以被视为近似独立同分布 (i.i.d.) 的随机变量。\n5.  对这 $M$ 个块均值应用中心极限定理 (CLT)，我们可以将它们视为从一个正态分布中抽取的 $M$ 个独立样本，该分布的均值就是我们感兴趣的量 $\\langle X \\rangle$。然后，我们可以将均值误差的标准统计公式应用于这组块均值。\n6.  首先，我们计算块均值的样本方差，记为 $s_{\\text{block}}^2$：\n$$\ns_{\\text{block}}^2 = \\frac{1}{M-1} \\sum_{j=1}^{M} \\left(\\bar{X}_j^{(B)} - \\bar{X}_{M,B}\\right)^2\n$$\n使用因子 $M-1$ (Bessel 校正) 是因为我们是从样本来估计总体方差。\n7.  那么，总体均值估计 $\\bar{X}_{M,B}$ 的方差估计为 $\\frac{s_{\\text{block}}^2}{M}$。\n8.  块平均估计量 $\\bar{X}_{M,B}$ 的标准误差是该方差的平方根：\n$$\nSE(\\bar{X}_{M,B}) = \\sqrt{\\frac{s_{\\text{block}}^2}{M}} = \\frac{s_{\\text{block}}}{\\sqrt{M}} = \\sqrt{\\frac{1}{M(M-1)} \\sum_{j=1}^{M} \\left(\\bar{X}_j^{(B)} - \\bar{X}_{M,B}\\right)^2}\n$$\n如果独立块均值的假设成立，这就为均值的不确定性提供了一个统计上可靠的估计。\n\n第二部分：应用于给定数据\n\n该问题提供了可观测量 $X = \\exp(-\\beta \\Delta U)$ 的 $N=24$ 个数据点。这些数据将被分为 $M=4$ 个块，每个块的大小为 $B=6$。\n\n数据集为：\n$0.120, 0.085, 0.102, 0.095, 0.110, 0.090$\n$0.070, 0.130, 0.088, 0.112, 0.105, 0.098$\n$0.095, 0.104, 0.099, 0.101, 0.097, 0.100$\n$0.092, 0.108, 0.085, 0.115, 0.103, 0.107$\n\n该问题要求进行四项具体计算。\n\n1.  $M$ 个块均值, $\\bar{X}_j^{(B)}$:\n块 1: $\\bar{X}_1^{(6)} = \\frac{1}{6}(0.120+0.085+0.102+0.095+0.110+0.090) = \\frac{0.602}{6} \\approx 0.100333$\n块 2: $\\bar{X}_2^{(6)} = \\frac{1}{6}(0.070+0.130+0.088+0.112+0.105+0.098) = \\frac{0.603}{6} = 0.1005$\n块 3: $\\bar{X}_3^{(6)} = \\frac{1}{6}(0.095+0.104+0.099+0.101+0.097+0.100) = \\frac{0.596}{6} \\approx 0.099333$\n块 4: $\\bar{X}_4^{(6)} = \\frac{1}{6}(0.092+0.108+0.085+0.115+0.103+0.107) = \\frac{0.610}{6} \\approx 0.101667$\n\n2.  $\\langle X \\rangle$ 的总体块平均估计量, $\\bar{X}_{M,B}$:\n这是块均值的均值，或者更简单地说，是所有 $N=24$ 个数据点的均值。\n所有数据点的总和是各块之和的总和：$S_{total} = 0.602 + 0.603 + 0.596 + 0.610 = 2.411$。\n$$\n\\bar{X}_{4,6} = \\frac{2.411}{24} \\approx 0.100458333...\n$$\n\n3.  该估计量的标准误差, $SE(\\bar{X}_{4,6})$:\n使用上面推导的公式，其中 $M=4$:\n$$\nSE(\\bar{X}_{4,6}) = \\sqrt{\\frac{1}{4(4-1)} \\sum_{j=1}^{4} \\left(\\bar{X}_j^{(6)} - \\bar{X}_{4,6}\\right)^2}\n$$\n首先，计算块均值的样本方差 $s_{\\text{block}}^2$:\n$$\ns_{\\text{block}}^2 = \\frac{1}{3} \\left[ (0.100333... - 0.1004583...)^2 + (0.1005 - 0.1004583...)^2 + (0.099333... - 0.1004583...)^2 + (0.101667... - 0.1004583...)^2 \\right]\n$$\n为精确起见，我们使用精确分数。$\\bar{X}_1^{(6)}=\\frac{0.602}{6}$，$\\bar{X}_2^{(6)}=\\frac{0.603}{6}$，$\\bar{X}_3^{(6)}=\\frac{0.596}{6}$，$\\bar{X}_4^{(6)}=\\frac{0.610}{6}$，以及 $\\bar{X}_{4,6}=\\frac{2.411}{24}$。\n块和与其均值 $(\\bar{S} = 2.411/4 = 0.60275)$ 的离差平方和更简单：\n$\\sum_{j=1}^4 (S_j - \\bar{S})^2 = (0.602-0.60275)^2 + (0.603-0.60275)^2 + (0.596-0.60275)^2 + (0.610-0.60275)^2$\n$= (-0.00075)^2 + (0.00025)^2 + (-0.00675)^2 + (0.00725)^2$\n$= 5.625 \\times 10^{-7} + 6.25 \\times 10^{-8} + 4.55625 \\times 10^{-5} + 5.25625 \\times 10^{-5} = 9.875 \\times 10^{-5}$。\n$s_{\\text{block}}^2 = \\frac{1}{M-1} \\sum (\\frac{S_j}{B} - \\frac{\\bar{S}}{B})^2 = \\frac{1}{(M-1)B^2} \\sum (S_j - \\bar{S})^2 = \\frac{9.875 \\times 10^{-5}}{(3)(6^2)} = \\frac{9.875 \\times 10^{-5}}{108} \\approx 9.1435 \\times 10^{-7}$。\n标准误差为：\n$$\nSE(\\bar{X}_{4,6}) = \\sqrt{\\frac{s_{\\text{block}}^2}{M}} = \\sqrt{\\frac{9.1435 \\times 10^{-7}}{4}} = \\sqrt{2.285875 \\times 10^{-7}} \\approx 0.0004781\n$$\n\n4.  累积块平均估计值：\n这是在每个完整数据块之后计算的可观测量的移动平均值。\n经过 $k$ 个块后，累积估计值 $\\bar{X}_{cum, k}$ 是前 $k \\times B$ 个数据点的均值。\n$k=1$: $\\bar{X}_{cum, 1} = \\bar{X}_1^{(6)} = \\frac{0.602}{6} \\approx 0.100333$\n$k=2$: $\\bar{X}_{cum, 2} = \\frac{0.602 + 0.603}{12} = \\frac{1.205}{12} \\approx 0.100417$\n$k=3$: $\\bar{X}_{cum, 3} = \\frac{0.602 + 0.603 + 0.596}{18} = \\frac{1.801}{18} \\approx 0.100056$\n$k=4$: $\\bar{X}_{cum, 4} = \\frac{0.602 + 0.603 + 0.596 + 0.610}{24} = \\frac{2.411}{24} \\approx 0.100458$\n\n最终的块平均估计值是处理完所有数据块后的值，即 $\\bar{X}_{4,6}$。将其四舍五入到六位有效数字得到 $0.100458$。\n基于这些计算，$\\langle \\exp(-\\beta \\Delta U) \\rangle$ 的最终报告值为 $0.100458$。",
            "answer": "$$\n\\boxed{0.100458}\n$$"
        },
        {
            "introduction": "为了提高计算效率，分子模拟中常常在一定截断半径 $r_{c}$ 处截断相互作用势，但这会为计算结果引入系统性偏差。作为一名严谨的研究者，理解并能估算这种近似所带来的影响是十分必要的。本练习旨在阐明截断势如何影响通过 Widom 方法计算的过剩化学势，并指导您推导和估算由此产生的偏差，帮助您深入理解计算精度与效率之间的权衡。",
            "id": "3858611",
            "problem": "考虑一种用于多尺度材料模拟的均匀、各向同性、单组分原子流体。原子间通过 Lennard-Jones 对势相互作用，其能量参数为 $\\varepsilon$，长度参数为 $\\sigma$，$u(r)=4\\varepsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^{6}\\right]$。该系统采用半径为 $r_{c}$ 的球形截断进行模拟，忽略了超出 $r_{c}$ 的相互作用，并且省略了任何长程校正 (LRC)。过剩化学势 $\\mu^{\\mathrm{ex}}$ 是通过一种称为 Widom 插入法的插入方法获得的，该方法评估了向系统中添加一个测试粒子所需的自由能代价。\n\n从化学势的平衡统计力学定义以及在大的均匀系统中添加测试粒子的玻尔兹曼权重出发，证明忽略超出 $r_{c}$ 的相互作用会使估算的过剩化学势产生偏差。在物理上标准的假设下，即对于 $r\\ge r_{c}$，(i) 径向分布函数 (RDF) $g(r)$ 近似为 1，以及 (ii) 内部区域 $r<r_{c}$ 的构型与外部区域 $r\\ge r_{c}$ 的构型在统计上是解耦的，推导出该偏差的一阶近似表达式。\n\n然后，使用您的表达式，估算对于一个在约化单位下数密度为 $\\rho^*=\\rho\\sigma^3=0.8$、截断半径为 $r_{c}=3\\sigma$ 的系统，其相对偏差的大小。假设模拟得到的截断过剩化学势为 $\\mu^{\\mathrm{ex}}_{\\text{trunc}} = -4.18\\varepsilon$。将您的最终答案报告为一个无量纲数，四舍五入到四位有效数字。",
            "solution": "该问题要求我们首先推导在使用 Widom 插入法计算过剩化学势时，因对势函数被截断而产生的偏差表达式，然后在一系列特定近似和条件下估算该偏差的大小。\n\n过剩化学势 $\\mu^{\\mathrm{ex}}$ 定义为在恒定体积 $V$ 和温度 $T$ 下，将一个测试粒子插入到包含 $N$ 个粒子的系统中所需要的功。在 Widom 插入法的框架内，其表达式为：\n$$\n\\mu^{\\mathrm{ex}} = -k_B T \\ln \\langle \\exp(-\\beta \\Delta U) \\rangle_{N,V,T}\n$$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$\\beta \\equiv 1/(k_B T)$，$\\Delta U$ 是测试粒子与系统中已有的 $N$ 个粒子之间的相互作用能。尖括号 $\\langle \\dots \\rangle_{N,V,T}$ 表示对 $N$ 个粒子的所有构型进行的正则系综平均。\n\n相互作用能 $\\Delta U$ 是测试粒子与所有其他粒子之间对相互作用的总和：\n$$\n\\Delta U = \\sum_{i=1}^{N} u(r_i)\n$$\n其中 $r_i$ 是测试粒子与粒子 $i$ 之间的距离。\n\n在带有截断势的模拟中，当 $r > r_c$ 时，对势 $u(r)$ 被设为零。计算出的过剩化学势，我们记为 $\\mu^{\\mathrm{ex}}_{\\text{trunc}}$，是基于这个截断的相互作用能 $\\Delta U_{\\text{trunc}}$ 的：\n$$\n\\Delta U_{\\text{trunc}} = \\sum_{i=1}^{N} u_{\\text{trunc}}(r_i) \\quad \\text{其中} \\quad u_{\\text{trunc}}(r) = \\begin{cases} u(r) & r \\le r_c \\\\ 0 & r > r_c \\end{cases}\n$$\n$$\n\\mu^{\\mathrm{ex}}_{\\text{trunc}} = -k_B T \\ln \\langle \\exp(-\\beta \\Delta U_{\\text{trunc}}) \\rangle\n$$\n真实的过剩化学势 $\\mu^{\\mathrm{ex}}_{\\text{full}}$ 对应于完整的、未截断的势。我们可以将总相互作用能 $\\Delta U$ 分为来自截断半径内部的贡献 $\\Delta U_{\\text{in}}$ 和来自截断半径外部的贡献 $\\Delta U_{\\text{out}}$：\n$$\n\\Delta U = \\Delta U_{\\text{in}} + \\Delta U_{\\text{out}} = \\sum_{i: r_i \\le r_c} u(r_i) + \\sum_{i: r_i > r_c} u(r_i)\n$$\n注意 $\\Delta U_{\\text{trunc}} = \\Delta U_{\\text{in}}$。因此，我们有：\n$$\n\\exp(-\\beta \\mu^{\\mathrm{ex}}_{\\text{trunc}}) = \\langle \\exp(-\\beta \\Delta U_{\\text{in}}) \\rangle\n$$\n$$\n\\exp(-\\beta \\mu^{\\mathrm{ex}}_{\\text{full}}) = \\langle \\exp(-\\beta (\\Delta U_{\\text{in}} + \\Delta U_{\\text{out}})) \\rangle\n$$\n问题陈述了这样一个假设：内部区域 ($r<r_c$) 和外部区域 ($r \\ge r_c$) 的构型是统计上解耦的。这使得我们可以将玻尔兹曼因子的平均值分解：\n$$\n\\langle \\exp(-\\beta (\\Delta U_{\\text{in}} + \\Delta U_{\\text{out}})) \\rangle \\approx \\langle \\exp(-\\beta \\Delta U_{\\text{in}}) \\rangle \\langle \\exp(-\\beta \\Delta U_{\\text{out}}) \\rangle\n$$\n此外，对于长程相互作用，$\\beta \\Delta U_{\\text{out}}$ 通常足够小，以至于我们可以使用一阶泰勒展开（或第一阶累积展开）来近似：$\\langle \\exp(x) \\rangle \\approx 1 + \\langle x \\rangle$。\n$$\n\\langle \\exp(-\\beta \\Delta U_{\\text{out}}) \\rangle \\approx 1 - \\beta \\langle \\Delta U_{\\text{out}} \\rangle\n$$\n将这些近似结合起来：\n$$\n\\exp(-\\beta \\mu^{\\mathrm{ex}}_{\\text{full}}) \\approx \\exp(-\\beta \\mu^{\\mathrm{ex}}_{\\text{trunc}}) (1 - \\beta \\langle \\Delta U_{\\text{out}} \\rangle)\n$$\n对两边取自然对数：\n$$\n-\\beta \\mu^{\\mathrm{ex}}_{\\text{full}} \\approx -\\beta \\mu^{\\mathrm{ex}}_{\\text{trunc}} + \\ln(1 - \\beta \\langle \\Delta U_{\\text{out}} \\rangle)\n$$\n再次使用泰勒展开，$\\ln(1-x) \\approx -x$ 对小的 $x$ 成立：\n$$\n-\\beta \\mu^{\\mathrm{ex}}_{\\text{full}} \\approx -\\beta \\mu^{\\mathrm{ex}}_{\\text{trunc}} - \\beta \\langle \\Delta U_{\\text{out}} \\rangle\n$$\n因此，我们得到偏差的一阶近似：\n$$\n\\text{Bias} = \\mu^{\\mathrm{ex}}_{\\text{full}} - \\mu^{\\mathrm{ex}}_{\\text{trunc}} \\approx \\langle \\Delta U_{\\text{out}} \\rangle\n$$\n这个偏差，通常称为长程校正 (LRC) 或尾部校正，就是测试粒子与截断半径之外的所有粒子之间的平均相互作用能。\n\n要计算 $\\langle \\Delta U_{\\text{out}} \\rangle$，我们将其表示为在整个外部体积上的积分，使用系统的数密度 $\\rho$ 和径向分布函数 (RDF) $g(r)$：\n$$\n\\langle \\Delta U_{\\text{out}} \\rangle = \\int_{r_c}^{\\infty} u(r) \\rho g(r) 4\\pi r^2 dr\n$$\n在 $r \\ge r_c$ 时 $g(r) \\approx 1$ 的假设下，这简化为：\n$$\n\\langle \\Delta U_{\\text{LRC}} \\rangle \\approx \\rho \\int_{r_c}^{\\infty} u(r) 4\\pi r^2 dr\n$$\n对于 Lennard-Jones 势，$u(r) = 4\\varepsilon\\left[(\\sigma/r)^{12} - (\\sigma/r)^{6}\\right]$，积分结果为：\n$$\n\\langle \\Delta U_{\\text{LRC}} \\rangle = 4\\pi\\rho \\int_{r_c}^{\\infty} 4\\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right] r^2 dr = 16\\pi\\rho\\varepsilon \\left[ \\sigma^{12}\\int_{r_c}^{\\infty} r^{-10} dr - \\sigma^6\\int_{r_c}^{\\infty} r^{-4} dr \\right]\n$$\n$$\n= 16\\pi\\rho\\varepsilon \\left[ \\sigma^{12} \\left( \\frac{r^{-9}}{-9} \\right) \\bigg|_{r_c}^{\\infty} - \\sigma^6 \\left( \\frac{r^{-3}}{-3} \\right) \\bigg|_{r_c}^{\\infty} \\right] = 16\\pi\\rho\\varepsilon \\left[ \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right]\n$$\n在约化单位下，$\\sigma=1, \\varepsilon=1, \\rho^* = \\rho\\sigma^3$，表达式变为：\n$$\n\\langle \\Delta U_{\\text{LRC}} \\rangle = 16\\pi\\rho^* \\varepsilon \\left[ \\frac{1}{9} \\left(\\frac{\\sigma}{r_c}\\right)^9 - \\frac{1}{3} \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right]\n$$\n现在我们使用给定的值进行计算：$\\rho^*=0.8$，$r_c=3\\sigma$。\n$$\n\\langle \\Delta U_{\\text{LRC}} \\rangle = 16\\pi(0.8)\\varepsilon \\left[ \\frac{1}{9}\\left(\\frac{1}{3}\\right)^9 - \\frac{1}{3}\\left(\\frac{1}{3}\\right)^3 \\right]\n$$\n$$\n= 12.8\\pi\\varepsilon \\left[ \\frac{1}{9 \\times 19683} - \\frac{1}{3 \\times 27} \\right] = 12.8\\pi\\varepsilon \\left[ \\frac{1}{177147} - \\frac{1}{81} \\right]\n$$\n$$\n\\approx 40.212\\varepsilon [0.000005645 - 0.012345679] \\approx 40.212\\varepsilon [-0.012340034] \\approx -0.4962\\varepsilon\n$$\n偏差为 $\\Delta \\mu^{\\text{ex}}_{\\text{bias}} \\approx -0.4962\\varepsilon$。\n相对偏差的大小是 $|\\Delta \\mu^{\\text{ex}}_{\\text{bias}}| / |\\mu^{\\mathrm{ex}}_{\\text{trunc}}|$。\n$$\n\\text{相对偏差} = \\frac{|-0.4962\\varepsilon|}{|-4.18\\varepsilon|} = \\frac{0.4962}{4.18} \\approx 0.118708\n$$\n四舍五入到四位有效数字，相对偏差为 $0.1187$。",
            "answer": "$$\\boxed{0.1187}$$"
        }
    ]
}