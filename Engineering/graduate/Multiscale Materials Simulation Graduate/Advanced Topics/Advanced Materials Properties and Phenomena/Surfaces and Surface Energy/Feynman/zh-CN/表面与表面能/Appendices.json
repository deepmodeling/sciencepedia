{
    "hands_on_practices": [
        {
            "introduction": "本节的第一个练习将带你实践从量子力学模拟得到的能量数据中计算 $T=0$ 时表面能的基本方法。通过应用表面能的核心定义，你将把板坯模型的原始总能量转化为一个具有物理意义的表面能数值。掌握这项技能是计算材料科学研究的基石 。",
            "id": "3843480",
            "problem": "一个化学计量比的、对称的金属板使用密度泛函理论（DFT）进行建模。模拟在 $T=0$ 条件下进行，因此熵的贡献消失，相关的物理量是内能。该板包含 $N=200$ 个相同元素的原子，且两个相对的表面在晶体学上是等价的。该板足够厚，以至于两个表面不会通过真空相互作用，并且横向应变可以忽略不计。计算出的板的总能量为 $E_{\\text{slab}}=-685.000\\,\\text{eV}$。对于相同元素和交换关联泛函计算的单个原子的体相参考能量为 $E_{\\text{bulk}}=-3.500\\,\\text{eV}$。板的一个面的表面积为 $A=100.00\\,\\text{\\AA}^{2}$。\n\n仅使用适用于 $T=0$ 条件下化学计量比对称板的第一性原理定义，计算一个表面的表面能 $\\gamma$。请将您的最终答案以 $\\text{J m}^{-2}$ 为单位表示，并四舍五入到四位有效数字。使用基本常数 $1\\,\\text{eV}=1.602176634\\times 10^{-19}\\,\\text{J}$ 和 $1\\,\\text{\\AA}=10^{-10}\\,\\text{m}$。在您的推理中，请在金属键的背景下解释 $\\gamma$ 的预期符号和典型数量级，但最终答案只报告所要求的数值。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、提法明确且客观。它提出了一个计算材料科学中的标准问题，可以使用第一性原理来解决。所有必要的数据均已提供，且条件在物理上是一致的并有明确定义。\n\n在温度 $T=0$ 时，表面能 $\\gamma$ 定义为与创建表面相关的单位面积的过剩吉布斯自由能。在 $T=0$ 时，熵的贡献消失，吉布斯自由能等于内能 $E$。因此，表面能是相对于体相材料的单位表面积的过剩内能。\n$$\n\\gamma = \\frac{E_{\\text{surface}}}{A}\n$$\n其中 $E_{\\text{surface}}$ 是总过剩能量，$A$ 是表面积。\n\n对于所描述的板模型，总能量 $E_{\\text{slab}}$ 是原子处于体相中时的能量与由两个表面的存在引起的过剩能量之和。原子在体相参考状态下的能量是原子数 $N$ 乘以每个原子的体相能量 $E_{\\text{bulk}}$。\n因此，整个板的总过剩能量为：\n$$\nE_{\\text{excess}} = E_{\\text{slab}} - N E_{\\text{bulk}}\n$$\n问题指出，该板是对称的并且足够厚，以至于两个表面不相互作用。这意味着该板有两个相同的表面，每个表面的面积为 $A$。创建的总表面积为 $2A$。过剩能量均匀分布在这两个表面之间。因此，一个表面的表面能 $\\gamma$ 由下式给出：\n$$\n\\gamma = \\frac{E_{\\text{slab}} - N E_{\\text{bulk}}}{2A}\n$$\n在计算数值之前，我们考虑 $\\gamma$ 的预期符号和数量级。创建一个表面需要断开在体相晶体中将原子结合在一起的内聚键。在金属中，这些是强的金属键。断键是一个吸能过程，意味着它需要能量输入。因此，一个有表面的系统比相同数量的原子在体相中时处于更高的能量状态。这意味着 $E_{\\text{slab}}$ 必须大于（负得更少）$N E_{\\text{bulk}}$，使得分子 $E_{\\text{slab}} - N E_{\\text{bulk}}$ 是一个正量。由于面积 $A$ 也是正的，所以表面能 $\\gamma$ 必须是正的。负的表面能将意味着材料可以通过自发增加其表面积来降低其能量，这在物理上是不可能的。$\\gamma$ 的数量级与材料的内聚能（大约为 $-E_{\\text{bulk}}$）有关。对于内聚能为每原子几个电子伏特的金属，典型的表面能大约在 $1\\,\\text{J m}^{-2}$ 的数量级。\n\n我们已知以下值：\n- 原子数，$N = 200$。\n- 板的总能量，$E_{\\text{slab}} = -685.000\\,\\text{eV}$。\n- 每个原子的体相能量，$E_{\\text{bulk}} = -3.500\\,\\text{eV}$。\n- 一个表面的面积，$A = 100.00\\,\\text{\\AA}^{2}$。\n\n首先，我们计算过剩能量 $E_{\\text{excess}}$：\n$$\nE_{\\text{excess}} = (-685.000\\,\\text{eV}) - (200 \\times -3.500\\,\\text{eV})\n$$\n$$\nE_{\\text{excess}} = -685.000\\,\\text{eV} - (-700.000\\,\\text{eV})\n$$\n$$\nE_{\\text{excess}} = 15.000\\,\\text{eV}\n$$\n总表面积为 $2A$：\n$$\n2A = 2 \\times 100.00\\,\\text{\\AA}^{2} = 200.00\\,\\text{\\AA}^{2}\n$$\n现在我们以 $\\text{eV}/\\text{\\AA}^{2}$ 为单位计算表面能 $\\gamma$：\n$$\n\\gamma = \\frac{15.000\\,\\text{eV}}{200.00\\,\\text{\\AA}^{2}} = 0.075000\\,\\frac{\\text{eV}}{\\text{\\AA}^{2}}\n$$\n问题要求最终答案以 $\\text{J m}^{-2}$ 为单位。我们使用提供的转换因子：\n- $1\\,\\text{eV} = 1.602176634 \\times 10^{-19}\\,\\text{J}$\n- $1\\,\\text{\\AA} = 10^{-10}\\,\\text{m}$，这意味着 $1\\,\\text{\\AA}^{2} = (10^{-10}\\,\\text{m})^{2} = 10^{-20}\\,\\text{m}^{2}$\n\n表面能的转换因子是：\n$$\n1\\,\\frac{\\text{eV}}{\\text{\\AA}^{2}} = \\frac{1.602176634 \\times 10^{-19}\\,\\text{J}}{10^{-20}\\,\\text{m}^{2}} = 16.02176634\\,\\frac{\\text{J}}{\\text{m}^{2}}\n$$\n将此转换应用于我们计算的 $\\gamma$：\n$$\n\\gamma = 0.075000\\,\\frac{\\text{eV}}{\\text{\\AA}^{2}} \\times 16.02176634\\,\\frac{\\text{J}/\\text{m}^{2}}{\\text{eV}/\\text{\\AA}^{2}}\n$$\n$$\n\\gamma = 1.2016324755\\,\\frac{\\text{J}}{\\text{m}^{2}}\n$$\n最后，我们按照题目要求将结果四舍五入到四位有效数字。\n$$\n\\gamma \\approx 1.202\\,\\frac{\\text{J}}{\\text{m}^{2}}\n$$\n该值为正，其数量级对于金属表面是典型的，与我们的物理推理一致。",
            "answer": "$$\\boxed{1.202}$$"
        },
        {
            "introduction": "一次可靠的表面能计算需要严谨的收敛性测试，以消除模拟设置本身带来的计算伪影。这个练习将引导你深入探究板坯模型计算中的两个主要误差来源：有限的板坯厚度和周期性镜像相互作用。你将需要推导并应用相应的判据，以确保你的计算结果达到预设的精度要求 。",
            "id": "3843422",
            "problem": "您正在使用周期性边界条件（PBC）下的重复平板模型方法对表面形成能进行建模。单位面积的表面能定义为将块状固体切割成两个表面时，每个表面的过剩能量，$$\\gamma = \\dfrac{E_{\\text{slab}} - N E_{\\text{bulk}}}{2A},$$ 其中 $E_{\\text{slab}}$ 是一个具有 $N$ 个原子层和横截面积 $A$ 的平板的总能量，$E_{\\text{bulk}}$ 是每层的体相能量。在一个有限厚度平板、有限真空层的超胞中，由于两种物理上截然不同且经充分检验在屏蔽作用下会迅速衰减的有限尺寸相互作用，计算出的 $\\gamma$ 会偏离其半无限极限 $\\gamma_{\\infty}$：\n- 穿过平板内部的表面间耦合，该作用随层数 $n$ 衰减，以及\n- 由周期性副本引起的穿过真空层的镜像间耦合，该作用随真空层厚度 $L_{\\text{vac}}$ 衰减。\n\n假设以下两个基本物理事实对于广大的非病态材料类别均成立：\n1. 残余的表面间相互作用的大小受一个指数衰减包络的限制，$$\\left|\\Delta_{\\text{slab}}(n)\\right| \\leq C_{\\text{s}} e^{-n/\\xi},$$ 其中 $C_{\\text{s}}  0$ 是一个与材料和终止面相关的振幅（单位与 $\\gamma$ 相同），$\\xi  0$ 是一个以层数为单位的有效屏蔽长度。\n2. 残余的镜像间相互作用的大小受一个指数衰减包络的限制，$$\\left|\\Delta_{\\text{vac}}(L_{\\text{vac}})\\right| \\leq C_{\\text{v}} e^{-\\kappa L_{\\text{vac}}},$$ 其中 $C_{\\text{v}}  0$ 是一个振幅（单位与 $\\gamma$ 相同），$\\kappa  0$ 是一个衰减常数（单位为长度的倒数），$L_{\\text{vac}}$ 是真空层厚度。\n\n您将推导一个关于 $(n, L_{\\text{vac}})$ 的充分收敛判据，以保证 $\\gamma$ 达到目标绝对容差 $\\varepsilon$，然后实现该判据来为几个测试用例计算最小的 $(n, L_{\\text{vac}})$。\n\n任务：\n1) 仅使用上述 $\\gamma$ 的定义以及 $\\Delta_{\\text{slab}}(n)$ 和 $\\Delta_{\\text{vac}}(L_{\\text{vac}})$ 的指数误差界，推导出一个能保证 $$\\left|\\gamma(n, L_{\\text{vac}}) - \\gamma_{\\infty}\\right| \\leq \\varepsilon.$$ 的充分条件。将自己限制在一种简单、保守的资源分配策略中，其中每个误差源被分配总容差预算的一半，即 $$\\left|\\Delta_{\\text{slab}}(n)\\right| \\leq \\varepsilon/2 \\quad \\text{and} \\quad \\left|\\Delta_{\\text{vac}}(L_{\\text{vac}})\\right| \\leq \\varepsilon/2.$$ 由此，为最小平板厚度 $n_{\\min}$（整数层数）和最小真空层厚度 $L_{\\text{vac},\\min}$（非负实数长度）推导出显式不等式。\n2) 实现一个程序，为每个测试用例计算：\n   - 满足您推导出的平板判据的最小整数 $n_{\\min} \\geq 1$。\n   - 满足您推导出的真空层判据的最小非负值 $L_{\\text{vac},\\min}$，以埃（ångström）为单位报告。将 $L_{\\text{vac},\\min}$ 向上取整到两位小数（即小数点后保留两位数字的下一个更大的值）。$L_{\\text{vac}}$ 以埃为单位，$\\gamma$ 和 $\\varepsilon$ 以焦耳/平方米为单位。\n   - 一个布尔值“平台见证”，用于证明其趋近于半无限极限：构建序列 $$\\gamma(n) = \\gamma_{\\infty} + C_{\\text{s}} e^{-n/\\xi}$$ （即，取 $L_{\\text{vac}} \\to \\infty$ 以隔离平板厚度的影响），对从 $n=1$ 到 $$n_{\\text{end}} = n_{\\min} + \\max\\left(20, 10\\lceil \\xi \\rceil\\right),$$ 的整数 $n$ 对此序列进行求值，如果序列是单调非增且满足 $$\\left|\\gamma(n_{\\text{end}}) - \\gamma_{\\infty}\\right| \\leq 10^{-8} \\text{ J m}^{-2}。$$，则返回 true。否则返回 false。这定量地证明了在假设的衰减下，$\\gamma(n)$ 在 $n \\to \\infty$ 时趋于一个平台。\n3) 使用以下测试套件。对每个用例，计算并返回 $n_{\\min}$（整数）、以埃为单位的 $L_{\\text{vac},\\min}$（向上取整到两位小数）和平台见证布尔值。所有参数 $C_{\\text{s}}$、$C_{\\text{v}}$、$\\gamma_{\\infty}$ 和 $\\varepsilon$ 的单位是焦耳/平方米，$\\xi$ 的单位是层，$\\kappa$ 的单位是埃的倒数，以及 $L_{\\text{vac}}$ 的单位是埃。\n   - 用例 A（理想路径）：$\\gamma_{\\infty} = 1.20$, $C_{\\text{s}} = 0.20$, $\\xi = 3.00$, $C_{\\text{v}} = 0.05$, $\\kappa = 0.80$, $\\varepsilon = 0.01$。\n   - 用例 B（平板耦合为零的边界情况）：$\\gamma_{\\infty} = 0.85$, $C_{\\text{s}} = 0.00$, $\\xi = 1.00$, $C_{\\text{v}} = 0.03$, $\\kappa = 0.50$, $\\varepsilon = 0.005$。\n   - 用例 C（严格容差）：$\\gamma_{\\infty} = 1.00$, $C_{\\text{s}} = 0.10$, $\\xi = 2.00$, $C_{\\text{v}} = 0.02$, $\\kappa = 1.20$, $\\varepsilon = 0.001$。\n   - 用例 D（平板衰减慢，真空衰减快）：$\\gamma_{\\infty} = 1.50$, $C_{\\text{s}} = 0.08$, $\\xi = 10.00$, $C_{\\text{v}} = 0.01$, $\\kappa = 2.00$, $\\varepsilon = 0.02$。\n\n最终输出格式：\n- 您的程序应产生单行输出，其中包含四个用例的结果，格式为类 JSON 的列表的列表：$$\\left[\\left[n_{\\min}^{(A)}, L_{\\text{vac},\\min}^{(A)}, b^{(A)}\\right], \\left[n_{\\min}^{(B)}, L_{\\text{vac},\\min}^{(B)}, b^{(B)}\\right], \\left[n_{\\min}^{(C)}, L_{\\text{vac},\\min}^{(C)}, b^{(C)}\\right], \\left[n_{\\min}^{(D)}, L_{\\text{vac},\\min}^{(D)}, b^{(D)}\\right]\\right],$$ 其中 $b^{(\\cdot)}$ 是平台见证布尔值。该行必须严格按照这种带括号、逗号分隔的格式打印，并使用数值（$n_{\\min}$ 为整数，$L_{\\text{vac},\\min}$ 为带两位小数的浮点数，以及布尔值）。",
            "solution": "目标是推导并实现在重复平板模拟中计算表面能 $\\gamma$ 的充分收敛判据。该判据必须保证计算值 $\\gamma(n, L_{\\text{vac}})$ 与真实的半无限极限 $\\gamma_{\\infty}$ 的差值在指定的绝对容差 $\\varepsilon$ 之内，即 $|\\gamma(n, L_{\\text{vac}}) - \\gamma_{\\infty}| \\leq \\varepsilon$。此处，$n$ 是平板中的原子层数，$L_{\\text{vac}}$ 是真空层厚度。\n\n总误差假定为两个独立贡献之和：表面间耦合误差 $\\Delta_{\\text{slab}}(n)$ 和镜像间耦合误差 $\\Delta_{\\text{vac}}(L_{\\text{vac}})$。\n$$ \\gamma(n, L_{\\text{vac}}) - \\gamma_{\\infty} = \\Delta_{\\text{slab}}(n) + \\Delta_{\\text{vac}}(L_{\\text{vac}}) $$\n这些误差的大小受问题描述中给出的指数衰减函数的限制：\n$$ |\\Delta_{\\text{slab}}(n)| \\leq C_{\\text{s}} e^{-n/\\xi} $$\n$$ |\\Delta_{\\text{vac}}(L_{\\text{vac}})| \\leq C_{\\text{v}} e^{-\\kappa L_{\\text{vac}}} $$\n使用三角不等式，总误差的大小受限：\n$$ |\\gamma(n, L_{\\text{vac}}) - \\gamma_{\\infty}| = |\\Delta_{\\text{slab}}(n) + \\Delta_{\\text{vac}}(L_{\\text{vac}})| \\leq |\\Delta_{\\text{slab}}(n)| + |\\Delta_{\\text{vac}}(L_{\\text{vac}})| $$\n为确保总误差不超过 $\\varepsilon$，只需满足以下条件即可：\n$$ |\\Delta_{\\text{slab}}(n)| + |\\Delta_{\\text{vac}}(L_{\\text{vac}})| \\leq \\varepsilon $$\n\n问题指定了一种保守的误差预算策略，其中每个误差源被分配总容差的一半，即 $\\varepsilon/2$。这将问题解耦为两个独立的条件：\n1. $|\\Delta_{\\text{slab}}(n)| \\leq \\varepsilon/2$\n2. $|\\Delta_{\\text{vac}}(L_{\\text{vac}})| \\leq \\varepsilon/2$\n\n我们使用给定的指数界来找到关于 $n$ 和 $L_{\\text{vac}}$ 的充分条件。\n\n**1. 最小平板厚度 ($n_{\\min}$) 的推导**\n\n我们必须满足条件 $C_{\\text{s}} e^{-n/\\xi} \\leq \\varepsilon/2$。\n我们寻求满足此不等式的最小整数 $n_{\\min} \\geq 1$。\n\n首先，考虑平板耦合振幅 $C_{\\text{s}} = 0$ 的边界情况。不等式变为 $0 \\leq \\varepsilon/2$，对于任何正容差 $\\varepsilon$ 这总是成立的。因此，任何层数 $n \\geq 1$ 都足够。最小整数值为 $n_{\\min}=1$。\n\n现在，对于 $C_{\\text{s}}  0$，我们对 $n$ 求解：\n$$ e^{-n/\\xi} \\leq \\frac{\\varepsilon}{2C_{\\text{s}}} $$\n如果 $2C_{\\text{s}} \\leq \\varepsilon$，则 $\\varepsilon/(2C_{\\text{s}}) \\geq 1$。由于对于所有 $n \\geq 1$ 和 $\\xi  0$ 都有 $e^{-n/\\xi} \\leq 1$，该不等式对任何 $n \\geq 1$ 都成立。最小值同样是 $n_{\\min}=1$。\n\n如果 $2C_{\\text{s}}  \\varepsilon$，我们可以对两边取自然对数：\n$$ -\\frac{n}{\\xi} \\leq \\ln\\left(\\frac{\\varepsilon}{2C_{\\text{s}}}\\right) $$\n乘以 $-\\xi$（因为 $\\xi0$，所以该值为负）会反转不等号：\n$$ n \\geq -\\xi \\ln\\left(\\frac{\\varepsilon}{2C_{\\text{s}}}\\right) = \\xi \\ln\\left(\\left(\\frac{\\varepsilon}{2C_{\\text{s}}}\\right)^{-1}\\right) = \\xi \\ln\\left(\\frac{2C_{\\text{s}}}{\\varepsilon}\\right) $$\n由于 $n$ 必须是整数，我们必须对右侧取上取整（ceiling）。最小整数 $n_{\\min}$ 是满足此条件的最小整数，同时也要至少为 $1$。综合所有情况，对于 $C_{\\text{s}}  0$：\n$$ n_{\\min} = \\max\\left(1, \\left\\lceil \\xi \\ln\\left(\\frac{2C_{\\text{s}}}{\\varepsilon}\\right) \\right\\rceil\\right) $$\n当 $2C_{\\text{s}} \\leq \\varepsilon$ 时，此表达式正确地计算为 $1$，因为对数的参数 $\\leq 1$，使得对数值 $\\leq 0$。\n\n**2. 最小真空层厚度 ($L_{\\text{vac,min}}$) 的推导**\n\n我们必须满足条件 $C_{\\text{v}} e^{-\\kappa L_{\\text{vac}}} \\leq \\varepsilon/2$。\n我们寻求满足此不等式的最小非负实数 $L_{\\text{vac,min}}$。参数 $C_{\\text{v}}$ 被给定为正数。\n\n我们对 $L_{\\text{vac}}$ 求解：\n$$ e^{-\\kappa L_{\\text{vac}}} \\leq \\frac{\\varepsilon}{2C_{\\text{v}}} $$\n如果 $2C_{\\text{v}} \\leq \\varepsilon$，则 $\\varepsilon/(2C_{\\text{v}}) \\geq 1$。由于对于非负 $L_{\\text{vac}}$ 有 $e^{-\\kappa L_{\\text{vac}}} \\leq 1$，该不等式对所有 $L_{\\text{vac}} \\geq 0$ 都成立。最小值为 $L_{\\text{vac,min}} = 0$。\n\n如果 $2C_{\\text{v}}  \\varepsilon$，我们取自然对数：\n$$ -\\kappa L_{\\text{vac}} \\leq \\ln\\left(\\frac{\\varepsilon}{2C_{\\text{v}}}\\right) $$\n除以 $-\\kappa$（因为 $\\kappa0$，所以该值为负）会反转不等号：\n$$ L_{\\text{vac}} \\geq -\\frac{1}{\\kappa} \\ln\\left(\\frac{\\varepsilon}{2C_{\\text{v}}}\\right) = \\frac{1}{\\kappa} \\ln\\left(\\frac{2C_{\\text{v}}}{\\varepsilon}\\right) $$\n最小值就是下界。一个涵盖两种情况的单一表达式是：\n$$ L_{\\text{vac,min}} = \\max\\left(0, \\frac{1}{\\kappa} \\ln\\left(\\frac{2C_{\\text{v}}}{\\varepsilon}\\right)\\right) $$\n问题要求将该值向上取整到两位小数。\n\n**3. 平台见证逻辑**\n\n平台见证用于验证平板厚度的收敛行为。它涉及对模型序列 $\\gamma(n) = \\gamma_{\\infty} + C_{\\text{s}} e^{-n/\\xi}$ 的两个检查，其中整数 $n$ 从 $1$ 到 $n_{\\text{end}}$，而 $n_{\\text{end}} = n_{\\min} + \\max(20, 10\\lceil \\xi \\rceil)$。\n\na) **单调性**：序列必须是单调非增的，即对于 $n=2, ..., n_{\\text{end}}$，有 $\\gamma(n) \\leq \\gamma(n-1)$。\n对于 $C_{\\text{s}} = 0$，$\\gamma(n) = \\gamma_{\\infty}$ 是常数，因此是非增的。\n对于 $C_{\\text{s}}  0$，由于 $e^{-x}$ 是一个严格递减函数，$\\gamma(n)$ 是严格递减的。\n因此，对于给定的模型，此条件在数学上总是满足的。实现时将执行一个显式检查以作演示。\n\nb) **终值容差**：在终点 $n_{\\text{end}}$ 的误差必须低于一个非常严格的阈值，给定为 $10^{-8} \\text{ J m}^{-2}$。\n$$ |\\gamma(n_{\\text{end}}) - \\gamma_{\\infty}| \\leq 10^{-8} $$\n代入模型序列：\n$$ |(\\gamma_{\\infty} + C_{\\text{s}} e^{-n_{\\text{end}}/\\xi}) - \\gamma_{\\infty}| = C_{\\text{s}} e^{-n_{\\text{end}}/\\xi} \\leq 10^{-8} $$\n当且仅当（显然为真的）单调性条件和此终值条件都满足时，平台见证为 `True`。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a sufficient convergence criterion for surface energy calculations.\n    \"\"\"\n    test_cases = [\n        # Case A: (gamma_inf, Cs, xi, Cv, kappa, epsilon)\n        (1.20, 0.20, 3.00, 0.05, 0.80, 0.01),\n        # Case B\n        (0.85, 0.00, 1.00, 0.03, 0.50, 0.005),\n        # Case C\n        (1.00, 0.10, 2.00, 0.02, 1.20, 0.001),\n        # Case D\n        (1.50, 0.08, 10.00, 0.01, 2.00, 0.02),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        gamma_inf, Cs, xi, Cv, kappa, epsilon = case\n        \n        # --- Task 1: Calculate minimal slab thickness n_min ---\n        # The condition is Cs * exp(-n/xi) = epsilon / 2.\n        # This implies n >= xi * ln(2*Cs / epsilon).\n        \n        n_min = 1\n        if Cs > 0:\n            val = 2 * Cs / epsilon\n            if val > 1:\n                n_min_calc = xi * np.log(val)\n                # n must be an integer, so we take the ceiling.\n                n_min = int(np.ceil(n_min_calc))\n        if n_min  1:\n            n_min = 1\n            \n        # --- Task 1: Calculate minimal vacuum thickness L_vac_min ---\n        # The condition is Cv * exp(-kappa * L_vac) = epsilon / 2.\n        # This implies L_vac >= (1/kappa) * ln(2*Cv / epsilon).\n        \n        L_vac_min = 0.0\n        val_vac = 2 * Cv / epsilon\n        if val_vac > 1:\n            L_vac_min = (1 / kappa) * np.log(val_vac)\n\n        # Round L_vac_min up to two decimal places.\n        L_vac_min_rounded = np.ceil(L_vac_min * 100) / 100\n\n        # --- Task 2: Compute the plateau witness ---\n        # Calculate n_end\n        n_end = n_min + int(np.max([20, 10 * np.ceil(xi)]))\n        \n        # a) Monotonicity check\n        # For the function gamma(n) = gamma_inf + Cs * exp(-n/xi),\n        # with Cs >= 0 and xi > 0, the sequence is always non-increasing.\n        # This check is mathematically guaranteed to pass.\n        is_monotonic = True\n        if Cs > 0: # If Cs is 0, sequence is constant, so non-increasing.\n            # Explicitly check for demonstration purposes, as requested.\n            val_prev = gamma_inf + Cs * np.exp(-1 / xi)\n            for n_i in range(2, n_end + 1):\n                val_curr = gamma_inf + Cs * np.exp(-n_i / xi)\n                if val_curr > val_prev:\n                    is_monotonic = False\n                    break\n                val_prev = val_curr\n                \n        # b) Final value check: |gamma(n_end) - gamma_inf| = 1e-8\n        final_value_error = Cs * np.exp(-n_end / xi)\n        is_converged_to_limit = final_value_error = 1e-8\n        \n        plateau_witness = is_monotonic and is_converged_to_limit\n        \n        results.append([n_min, L_vac_min_rounded, plateau_witness])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists in Python\n    # matches the required JSON-like format.\n    # Example: [[12, 2.88, False], [1, 4.97, True], ...]\n    print(f\"{results}\")\n\nsolve()\n```"
        },
        {
            "introduction": "并非所有晶体表面都具有相同的性质；由于宏观偶极矩的存在，极性表面给计算带来了独特的挑战。本练习通过对比简单的非极性表面与复杂的极性表面，展示了在模拟离子晶体时，为了获得物理上真实的能量，偶极校正所扮演的关键角色。这个假想的场景旨在清晰地揭示极性与计算收敛性之间的重要联系 。",
            "id": "3843490",
            "problem": "一种晶体离子固体具有多个表面，可以使用密度泛函理论（DFT）和周期性边界条件（PBC）对其进行建模。表面能定义为从体相材料中创造一个单位面积的表面所需的可逆功。对于一个包含 $N$ 个体相化学式单元、横向面积为 $A$ 且具有两个自由表面的板层计算，其表面能 $ \\gamma $ 是通过从总能量中减去体相参考能量并按面积进行归一化来计算的。对于非极性对称板层（上下表面等效），该计算得出单个表面的能量。对于极性非对称板层（上下表面不等效），同样的归一化方法返回两个表面能的算术平均值。当板层存在垂直于表面的净偶极矩时，PBC 中的重复镜像真空区域会产生一个均匀电场。根据 Gauss 定律和场能量密度，这种伪静电贡献与真空层厚度成正比，除非应用显式的偶极校正来抵消该电场，否则会阻碍计算收敛。\n\n基于以下核心原则：\n- 具有两个表面的板层的单个表面能，是通过将板层过剩能量除以 $2A$ 进行归一化得到的。\n- 电场的能量由 $U = \\dfrac{\\varepsilon_0}{2} \\int E^2 \\, dV$ 给出，因此在厚度为 $L_{\\mathrm{vac}}$ 的真空区域中的均匀电场会增加一个随 $L_{\\mathrm{vac}}$ 增长的能量项。\n\n实现一个程序，为每个提供的测试用例计算：\n1. 非极性氧化镁 (MgO) $(100)$ 对称板层的单个表面能 $ \\gamma_{100} $，以及极性 MgO $(111)$ 非对称板层的单个表面平均能量 $ \\gamma_{111} $，两者均以焦耳/平方米 (J/m$^2$) 为单位。\n2. 能量差 $ \\Delta \\gamma_{\\mathrm{dc}} = \\gamma_{111}^{\\mathrm{(dc)}} - \\gamma_{100} $ 和 $ \\Delta \\gamma_{\\mathrm{no\\,dc}} = \\gamma_{111}^{\\mathrm{(no\\,dc)}} - \\gamma_{100} $，其中“dc”表示带有显式偶极校正的计算，“no dc”表示不带此校正的计算。\n\n在每次计算中使用以下单位换算：\n- 电子伏特到焦耳：$1~\\mathrm{eV} = 1.602176634 \\times 10^{-19}~\\mathrm{J}$。\n- 平方埃到平方米：$1~\\mathrm{\\AA}^2 = 1 \\times 10^{-20}~\\mathrm{m}^2$。\n\n因此，对于给定的板层，其总能量 $E_{\\mathrm{slab}}$（单位：电子伏特），单位化学式单元的体相能量 $E_{\\mathrm{bulk}}$（单位：电子伏特），整数计数 $N$，以及横向面积 $A$（单位：平方埃），其单个表面的能量（单位：焦耳/平方米）计算如下：\n$$\n\\gamma = \\frac{\\left(E_{\\mathrm{slab}} - N \\, E_{\\mathrm{bulk}}\\right) \\times \\left(1.602176634 \\times 10^{-19}~\\mathrm{J/eV}\\right)}{2 \\, A \\times \\left(1 \\times 10^{-20}~\\mathrm{m}^2/\\mathrm{\\AA}^2\\right)}.\n$$\n这种归一化方法为对称板层返回单个表面的能量值，为非对称板层返回上下两个表面的算术平均值。\n\n将所有最终的能量差 $ \\Delta \\gamma $ 以 J/m$^2$ 为单位表示为浮点数。计算中不涉及角度，因此不需要角度单位。\n\n测试套件（所有能量单位为电子伏特，面积单位为平方埃，真空层厚度单位为埃）：\n- 所有测试用例的全局材料参数：\n  - MgO 单位化学式单元的体相能量：$E_{\\mathrm{bulk}} = -197.0$。\n  - MgO $(100)$ 横向面积：$A_{100} = 17.7241$。\n  - MgO $(111)$ 横向面积：$A_{111} = 7.6710$。\n\n- 测试用例 1（理想情况：厚板层，中等真空度）：\n  - 板层单元数：$N_{100} = 16$, $N_{111} = 16$。\n  - 真空层厚度：$L_{\\mathrm{vac}} = 20.0$。\n  - DFT 总能量：\n    - $E_{\\mathrm{slab},100} = -3149.7371$。\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(dc)}} = -3146.6504$。\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(no\\,dc)}} = -3145.1504$。\n\n- 测试用例 2（中等厚度板层，较小真空度）：\n  - 板层单元数：$N_{100} = 8$, $N_{111} = 8$。\n  - 真空层厚度：$L_{\\mathrm{vac}} = 15.0$。\n  - DFT 总能量：\n    - $E_{\\mathrm{slab},100} = -1573.6671$。\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(dc)}} = -1570.6104$。\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(no\\,dc)}} = -1569.4104$。\n\n- 测试用例 3（边缘情况：非常薄的极性板层，小真空度；显著的非对称性和电场效应）：\n  - 板层单元数：$N_{100} = 3$, $N_{111} = 3$。\n  - 真空层厚度：$L_{\\mathrm{vac}} = 8.0$。\n  - DFT 总能量：\n    - $E_{\\mathrm{slab},100} = -588.2871$。\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(dc)}} = -585.1304$。\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(no\\,dc)}} = -584.2304$。\n\n- 测试用例 4（边缘情况：大真空度；测试无偶极校正时的非收敛性）：\n  - 板层单元数：$N_{100} = 8$, $N_{111} = 8$。\n  - 真空层厚度：$L_{\\mathrm{vac}} = 30.0$。\n  - DFT 总能量：\n    - $E_{\\mathrm{slab},100} = -1573.6671$。\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(dc)}} = -1570.6104$。\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(no\\,dc)}} = -1568.2104$。\n\n你的程序必须为每个测试用例计算以 J/m$^2$ 为单位的数值对 $[\\Delta \\gamma_{\\mathrm{dc}}, \\Delta \\gamma_{\\mathrm{no\\,dc}}]$，并生成单行输出。该行输出包含一个由方括号括起来的逗号分隔列表，其中每个元素对应一个测试用例，并且本身是一个包含两个元素的列表。例如，输出格式必须类似于 $[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]]$，其中 $x_i$ 和 $y_i$ 被数值替换。",
            "solution": "该问题是有效的。它在科学上基于计算材料科学的原理，特别是基于密度泛函理论（DFT）通过板层模型计算表面能的方法。问题提法适定、客观，并为获得唯一的、可验证的解提供了所有必要的数据和方程。\n\n核心任务是计算氧化镁（MgO）不同晶体取向的表面能 $\\gamma$，然后找出相对于稳定的 $(100)$ 表面的能量差。该计算取决于表面能的基本定义，即板层模型相对于体相材料的过剩能量，并按表面积进行归一化。\n\n对于一个具有两个表面的板层，其单个表面的能量 $\\gamma$ 的公式如下：\n$$\n\\gamma = \\frac{E_{\\mathrm{slab}} - N E_{\\mathrm{bulk}}}{2A}\n$$\n其中 $E_{\\mathrm{slab}}$ 是板层超胞的总能量，$E_{\\mathrm{bulk}}$ 是单个体相化学式单元的能量，$N$ 是板层中化学式单元的数量，$A$ 是板层表面的横向面积。该公式为对称板层提供单个表面的能量，为非对称板层提供两个不同表面能的算术平均值。\n\n输入的能量单位为电子伏特（$eV$），面积单位为平方埃（$\\mathrm{\\AA}^2$）。期望的输出单位为焦耳/平方米（$\\mathrm{J/m}^2$）。所需的转换因子如下：\n- $1~\\mathrm{eV} = 1.602176634 \\times 10^{-19}~\\mathrm{J}$\n- $1~\\mathrm{\\AA}^2 = 1 \\times 10^{-20}~\\mathrm{m}^2$\n\n整合这些转换后，计算方程变为：\n$$\n\\gamma \\left[\\mathrm{J/m}^2\\right] = \\frac{\\left(E_{\\mathrm{slab}}[\\mathrm{eV}] - N E_{\\mathrm{bulk}}[\\mathrm{eV}]\\right) \\times (1.602176634 \\times 10^{-19}~\\mathrm{J/eV})}{2 \\times A[\\mathrm{\\AA}^2] \\times (1 \\times 10^{-20}~\\mathrm{m}^2/\\mathrm{\\AA}^2)}\n$$\n这可以通过预先计算转换常数来简化：\n$$\nC = \\frac{1.602176634 \\times 10^{-19}}{1 \\times 10^{-20}} = 16.02176634\n$$\n因此，简化的公式为：\n$$\n\\gamma \\left[\\mathrm{J/m}^2\\right] = \\frac{E_{\\mathrm{slab}} - N E_{\\mathrm{bulk}}}{2A} \\times C\n$$\n该问题要求为每个测试用例计算三种表面能：\n1. $\\gamma_{100}$：非极性、对称的 MgO $(100)$ 板层的表面能。\n2. $\\gamma_{111}^{\\mathrm{(dc)}}$：极性、非对称的 MgO $(111)$ 板层的平均表面能，计算时带偶极校正。\n3. $\\gamma_{111}^{\\mathrm{(no\\,dc)}}$：极性、非对称的 MgO $(111)$ 板层的平均表面能，计算时不带偶极校正。问题描述正确地指出，在周期性边界条件下，由于真空区域中存在伪电场，不带偶极校正的极性板层的能量对真空层厚度 $L_{\\mathrm{vac}}$ 很敏感。所提供的“no dc”情况下的总能量反映了这种计算假象。\n\n根据这些值，我们为每个测试用例计算两个差值：\n- $\\Delta \\gamma_{\\mathrm{dc}} = \\gamma_{111}^{\\mathrm{(dc)}} - \\gamma_{100}$\n- $\\Delta \\gamma_{\\mathrm{no\\,dc}} = \\gamma_{111}^{\\mathrm{(no\\,dc)}} - \\gamma_{100}$\n\n我们将对提供的四个测试用例应用此过程，使用全局参数 $E_{\\mathrm{bulk}} = -197.0~\\mathrm{eV}$、$A_{100} = 17.7241~\\mathrm{\\AA}^2$ 和 $A_{111} = 7.6710~\\mathrm{\\AA}^2$。\n\n让我们以测试用例 1 为例说明计算过程：\n- 给定：$N_{100} = 16$，$N_{111} = 16$，$E_{\\mathrm{slab},100} = -3149.7371~\\mathrm{eV}$，$E_{\\mathrm{slab},111}^{\\mathrm{(dc)}} = -3146.6504~\\mathrm{eV}$，以及 $E_{\\mathrm{slab},111}^{\\mathrm{(no\\,dc)}} = -3145.1504~\\mathrm{eV}$。\n\n1.  计算 $\\gamma_{100}$：\n    - 过剩能量 $E_{\\mathrm{exc},100} = -3149.7371 - (16 \\times -197.0) = 2.2629~\\mathrm{eV}$。\n    - $\\gamma_{100} = \\frac{2.2629}{2 \\times 17.7241} \\times 16.02176634 \\approx 1.022759~\\mathrm{J/m}^2$。\n\n2.  计算 $\\gamma_{111}^{\\mathrm{(dc)}}$：\n    - 过剩能量 $E_{\\mathrm{exc},111}^{\\mathrm{(dc)}} = -3146.6504 - (16 \\times -197.0) = 5.3496~\\mathrm{eV}$。\n    - $\\gamma_{111}^{\\mathrm{dc}} = \\frac{5.3496}{2 \\times 7.6710} \\times 16.02176634 \\approx 5.586683~\\mathrm{J/m}^2$。\n\n3.  计算 $\\gamma_{111}^{\\mathrm{(no\\,dc)}}$：\n    - 过剩能量 $E_{\\mathrm{exc},111}^{\\mathrm{(no\\,dc)}} = -3145.1504 - (16 \\times -197.0) = 6.8496~\\mathrm{eV}$。\n    - $\\gamma_{111}^{\\mathrm{(no\\,dc)}} = \\frac{6.8496}{2 \\times 7.6710} \\times 16.02176634 \\approx 7.153106~\\mathrm{J/m}^2$。\n\n4.  计算差值：\n    - $\\Delta \\gamma_{\\mathrm{dc}} = 5.586683 - 1.022759 = 4.563924~\\mathrm{J/m}^2$。\n    - $\\Delta \\gamma_{\\mathrm{no\\,dc}} = 7.153106 - 1.022759 = 6.130347~\\mathrm{J/m}^2$。\n\n将此计算过程系统地应用于所有四个测试用例，以生成最终输出。该实现将把此逻辑封装在一个可重用的函数中。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes surface energy differences for MgO slabs based on DFT total energies.\n    \"\"\"\n    # Define unit conversions and global material parameters\n    EV_TO_J = 1.602176634e-19\n    ANG2_TO_M2 = 1e-20\n    CONVERSION_FACTOR = EV_TO_J / ANG2_TO_M2  # J*Å^2 / (eV*m^2)\n\n    E_BULK = -197.0  # eV\n    A_100 = 17.7241  # Å^2\n    A_111 = 7.6710   # Å^2\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {\n            \"N_100\": 16, \"N_111\": 16,\n            \"E_slab_100\": -3149.7371,\n            \"E_slab_111_dc\": -3146.6504,\n            \"E_slab_111_no_dc\": -3145.1504,\n        },\n        {\n            \"N_100\": 8, \"N_111\": 8,\n            \"E_slab_100\": -1573.6671,\n            \"E_slab_111_dc\": -1570.6104,\n            \"E_slab_111_no_dc\": -1569.4104,\n        },\n        {\n            \"N_100\": 3, \"N_111\": 3,\n            \"E_slab_100\": -588.2871,\n            \"E_slab_111_dc\": -585.1304,\n            \"E_slab_111_no_dc\": -584.2304,\n        },\n        {\n            \"N_100\": 8, \"N_111\": 8,\n            \"E_slab_100\": -1573.6671,\n            \"E_slab_111_dc\": -1570.6104,\n            \"E_slab_111_no_dc\": -1568.2104,\n        },\n    ]\n\n    def calculate_gamma(E_slab, N, E_bulk, A):\n        \"\"\"\n        Calculates the per-surface energy in J/m^2.\n\n        Args:\n            E_slab (float): Total energy of the slab in eV.\n            N (int): Number of bulk formula units in the slab.\n            E_bulk (float): Energy per bulk formula unit in eV.\n            A (float): Lateral area of the slab in Å^2.\n\n        Returns:\n            float: Surface energy in J/m^2.\n        \"\"\"\n        excess_energy_ev = E_slab - N * E_bulk\n        gamma = (excess_energy_ev / (2 * A)) * CONVERSION_FACTOR\n        return gamma\n\n    results = []\n    for case in test_cases:\n        # Calculate gamma for the (100) surface\n        gamma_100 = calculate_gamma(\n            case[\"E_slab_100\"], case[\"N_100\"], E_BULK, A_100\n        )\n\n        # Calculate gamma for the (111) surface with dipole correction\n        gamma_111_dc = calculate_gamma(\n            case[\"E_slab_111_dc\"], case[\"N_111\"], E_BULK, A_111\n        )\n\n        # Calculate gamma for the (111) surface without dipole correction\n        gamma_111_no_dc = calculate_gamma(\n            case[\"E_slab_111_no_dc\"], case[\"N_111\"], E_BULK, A_111\n        )\n        \n        # Calculate the required differences\n        delta_gamma_dc = gamma_111_dc - gamma_100\n        delta_gamma_no_dc = gamma_111_no_dc - gamma_100\n        \n        results.append([delta_gamma_dc, delta_gamma_no_dc])\n\n    # Format the final output string exactly as required\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}