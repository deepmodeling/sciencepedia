{
    "hands_on_practices": [
        {
            "introduction": "The most direct way to understand the ghost force phenomenon is to see it appear in the simplest possible setting. This first practice invites you to do just that, using a one-dimensional chain of atoms connected by ideal harmonic springs. By imposing a uniform stretch—a deformation that should result in zero net force on any atom in a perfect lattice—and then artificially cutting a single bond to create an interface, you will calculate the resulting non-zero force imbalance. This exercise  quantitatively reveals the \"ghost force\" as a direct consequence of an inconsistent energy description at the atomistic-continuum boundary.",
            "id": "3812134",
            "problem": "Consider an infinite one-dimensional atomic chain with reference lattice spacing $a>0$ and atoms labeled by indices $i\\in\\mathbb{Z}$. Each pair of nearest neighbors $(i,i+1)$ interacts via a harmonic spring with stiffness $k>0$ and rest length $a$. The total atomistic potential energy for a configuration with deformed positions $y_i$ is\n$$\n\\mathcal{E}_{\\mathrm{atom}}(y)=\\sum_{i\\in\\mathbb{Z}}\\frac{k}{2}\\left(\\left(y_{i+1}-y_i\\right)-a\\right)^{2}.\n$$\nIn a naive atomistic–continuum coupling construction mimicking an abrupt interface, suppose that all bonds that cross the interface between atoms $i=0$ and $i=1$ are deleted (i.e., the nearest-neighbor bond $(0,1)$ is removed), while all other bonds remain unchanged. There are no external forces. Adopt the quasi-static setting so that forces derive from the gradient of the potential energy with respect to positions.\n\nNow impose the uniform affine displacement field $u_i=\\epsilon\\, i\\, a$ for a fixed small strain $\\epsilon\\in\\mathbb{R}$, so the deformed configuration is $y_i=x_i+u_i=(1+\\epsilon)\\,i\\,a$, where $x_i=i\\,a$ are the reference positions. Define the internal nodal force $f_i(y)$ as the negative gradient of the total energy with respect to $y_i$.\n\nUsing only the definitions above and standard principles of mechanics (force as negative energy gradient; Hooke’s law for harmonic springs), construct this counterexample explicitly and compute the exact residual internal force at the interface node $i=0$ that results from the cut bond. Specify the sign of the force using the convention that positive force acts in the positive lattice direction (from smaller $i$ to larger $i$). Express your final answer as a closed-form symbolic expression in terms of $k$, $a$, and $\\epsilon$. If you were to assign units, take $k$ in Newtons per meter (N/m), $a$ in meters (m), and note that $\\epsilon$ is dimensionless, so the force would be in Newtons (N). Do not substitute numerical values.",
            "solution": "The total potential energy of the modified system, $\\mathcal{E}_{\\text{cut}}$, is the sum of the energies of all bonds except for the one between atoms $i=0$ and $i=1$:\n$$\n\\mathcal{E}_{\\text{cut}}(y) = \\sum_{j \\in \\mathbb{Z}, j \\neq 0} \\frac{k}{2} \\left( (y_{j+1} - y_j) - a \\right)^2\n$$\nThe internal force on atom $i=0$ is the negative gradient of the total potential energy with respect to its position, $y_0$:\n$$\nf_0 = -\\frac{\\partial \\mathcal{E}_{\\text{cut}}}{\\partial y_0}\n$$\nTo compute this derivative, we identify the terms in the energy expression that depend on $y_0$. Since the bond $(0,1)$ is removed, the only term involving $y_0$ is the energy of the bond between atom $i=-1$ and atom $i=0$. This corresponds to the $j=-1$ term in the sum over all bonds $(j, j+1)$.\n$$\nf_0 = -\\frac{\\partial}{\\partial y_0} \\left[ \\frac{k}{2} \\left( (y_0 - y_{-1}) - a \\right)^2 \\right]\n$$\nApplying the chain rule gives:\n$$\nf_0 = -k \\left( (y_0 - y_{-1}) - a \\right)\n$$\nWe now substitute the given deformed positions $y_i = (1+\\epsilon)ia$ into this force expression. For atom $i=0$, we have $y_0 = (1+\\epsilon)(0)a = 0$. For atom $i=-1$, we have $y_{-1} = (1+\\epsilon)(-1)a = -(1+\\epsilon)a$.\nSubstituting these positions into the expression for $f_0$:\n$$\nf_0 = -k \\left( 0 - (-(1+\\epsilon)a) - a \\right) = -k \\left( (1+\\epsilon)a - a \\right) = -k ( a + \\epsilon a - a )\n$$\n$$\nf_0 = -k (\\epsilon a)\n$$\nThe resulting ghost force is $f_0 = -k a \\epsilon$. This non-zero force is an artifact of the inconsistent model. In a perfect, uncut lattice under the same uniform strain, the force from the bond $(-1,0)$ would be perfectly canceled by the force from the bond $(0,1)$, resulting in zero net force.",
            "answer": "$$\n\\boxed{-k a \\epsilon}\n$$"
        },
        {
            "introduction": "Real materials feature interactions that extend beyond the nearest neighbors. This practice builds upon the basic model by incorporating next-nearest-neighbor interactions, which makes the ghost force calculation more complex and sensitive to the interface definition. You will compare two different ways of partitioning the energy at the interface: a naive \"asymmetric cut\" and a more balanced \"symmetric cut.\" This exercise  demonstrates not only how interaction range affects ghost forces but also introduces a foundational concept in their correction: symmetrically distributing energy or forces at the interface.",
            "id": "3812109",
            "problem": "Consider an infinite one-dimensional crystalline chain with atoms indexed by integers $i \\in \\mathbb{Z}$, reference lattice spacing $a>0$, and harmonic pair interactions up to next-nearest neighbors. The potential energy of the fully atomistic system is\n$$\nE_{\\text{atom}} = \\sum_{i\\in\\mathbb{Z}} \\left[ \\frac{1}{2} k_{1} \\left( y_{i+1} - y_{i} - a \\right)^{2} + \\frac{1}{2} k_{2} \\left( y_{i+2} - y_{i} - 2a \\right)^{2} \\right],\n$$\nwhere $k_{1}>0$ and $k_{2}>0$ are spring constants for nearest neighbor and next-nearest neighbor interactions, respectively, and $y_{i}$ are the current positions of atoms. Assume a uniform small strain $\\epsilon$ so that the displacement field is $u_{i} = \\epsilon\\, i\\, a$ and thus $y_{i} = i a + u_{i} = i a (1+\\epsilon)$.\n\nWe couple an atomistic region to a continuum region using an energy-based scheme inspired by the QuasiContinuum (QC) method, with the interface located between $i=0$ and $i=1$. The left side ($i\\le 0$) is treated atomistically, and the right side ($i\\ge 1$) is treated by the Cauchy–Born rule in a continuum approximation. Ghost forces arise because bonds that cross the interface are not represented consistently. Define the left-region energy $E_{\\text{left}}$ as the portion of the total energy assigned to the atomistic side, which determines the force on the interfacial atom $i=0$ via $f_{0} = -\\partial E_{\\text{left}}/\\partial y_{0}$.\n\nTwo cutting strategies for bonds at the interface are considered:\n\n- Asymmetric cut: include in $E_{\\text{left}}$ only bonds whose both endpoints lie in the atomistic region ($i \\le 0$). Bonds with one endpoint in $i\\le 0$ and the other in $i\\ge 1$ are omitted from $E_{\\text{left}}$.\n\n- Symmetric cut: include in $E_{\\text{left}}$ all bonds whose left endpoint is in $i\\le 0$ with the following weights: bonds whose right endpoint also lies in $i\\le 0$ have weight $1$, and bonds that cross the interface (one endpoint in $i\\le 0$ and the other in $i\\ge 1$) have weight $1/2$.\n\nStarting from fundamental definitions of force as the negative gradient of energy and using the uniform-strain configuration described above, derive the analytical expressions for the ghost force $f_{0}$ on the interfacial atom for both cutting strategies. Then, report the ratio of magnitudes $R = |f_{0}^{\\text{asym}}|/|f_{0}^{\\text{sym}}|$ as a single closed-form analytic expression in terms of $k_{1}$ and $k_{2}$. No numerical evaluation or rounding is required.",
            "solution": "The problem asks to derive the ghost force $f_{0}$ on the interfacial atom at $i=0$ for two energy partitioning schemes and then to find the ratio of the force magnitudes. The ghost force is defined as $f_{0} = -\\partial E_{\\text{left}}/\\partial y_{0}$, where $E_{\\text{left}}$ is the energy assigned to the atomistic region ($i \\le 0$).\n\nUnder a uniform strain $\\epsilon$, the deformed position of atom $i$ is $y_{i} = i a (1+\\epsilon)$. The bond elongations relative to their rest lengths are constant throughout the chain:\n-   Nearest-neighbor elongation: $\\Delta L_1 = (y_{i+1} - y_{i}) - a = a\\epsilon$.\n-   Next-nearest-neighbor elongation: $\\Delta L_2 = (y_{i+2} - y_{i}) - 2a = 2a\\epsilon$.\n\n**Asymmetric Cut**\nIn this scheme, $E_{\\text{left}}^{\\text{asym}}$ includes only the energy of bonds where both endpoints have indices $i \\le 0$. For the force on atom $0$, only its interactions with atoms to its left (i.e., atom $-1$ and $-2$) are considered.\n$$\nf_{0}^{\\text{asym}} = -\\frac{\\partial}{\\partial y_{0}} \\left[ \\frac{1}{2} k_{1} (y_0 - y_{-1} - a)^2 + \\frac{1}{2} k_{2} (y_0 - y_{-2} - 2a)^2 \\right]\n$$\n$$\nf_{0}^{\\text{asym}} = - \\left[ k_{1} (y_0 - y_{-1} - a) + k_{2} (y_0 - y_{-2} - 2a) \\right]\n$$\nSubstituting the constant elongations $\\Delta L_1$ and $\\Delta L_2$:\n$$\nf_{0}^{\\text{asym}} = - [ k_{1} (a\\epsilon) + k_{2} (2a\\epsilon) ] = -a\\epsilon (k_{1} + 2k_{2})\n$$\n\n**Symmetric Cut**\nIn this scheme, bonds crossing the interface are shared, with weight $1/2$ assigned to $E_{\\text{left}}^{\\text{sym}}$. The force on atom $0$ now includes contributions from its interactions with atoms to the right ($1$ and $2$), but weighted by $1/2$. The relevant energy terms are those for bonds $(-1,0)$, $(-2,0)$, $(0,1)$, and $(0,2)$.\n$$\nE_{\\text{left}}^{\\text{sym}} \\supset \\frac{1}{2} k_{1} (y_0 - y_{-1} - a)^2 + \\frac{1}{2} k_{2} (y_0 - y_{-2} - 2a)^2 + \\frac{1}{4} k_{1} (y_1 - y_0 - a)^2 + \\frac{1}{4} k_{2} (y_2 - y_0 - 2a)^2\n$$\nThe force is the negative gradient of this energy with respect to $y_0$:\n$$\nf_{0}^{\\text{sym}} = - \\left[ k_{1} (y_0 - y_{-1} - a) + k_{2} (y_0 - y_{-2} - 2a) - \\frac{1}{2} k_{1} (y_1 - y_0 - a) - \\frac{1}{2} k_{2} (y_2 - y_0 - 2a) \\right]\n$$\nSince the strain is uniform, all bond elongations are the same regardless of position. Substituting the elongations:\n$$\nf_{0}^{\\text{sym}} = - \\left[ k_{1}(a\\epsilon) + k_{2}(2a\\epsilon) - \\frac{1}{2} k_{1}(a\\epsilon) - \\frac{1}{2} k_{2}(2a\\epsilon) \\right]\n$$\n$$\nf_{0}^{\\text{sym}} = - \\left( \\frac{1}{2}k_{1} a\\epsilon + \\frac{1}{2}k_{2} 2a\\epsilon \\right) = - \\left( \\frac{1}{2}k_{1} a\\epsilon + k_{2} a\\epsilon \\right) = -\\frac{1}{2} a\\epsilon (k_1 + 2k_2)\n$$\n\n**Ratio of Magnitudes**\nThe ratio is $R = |f_{0}^{\\text{asym}}| / |f_{0}^{\\text{sym}}|$.\n$$\nR = \\frac{|-a\\epsilon (k_{1} + 2k_{2})|}{|-\\frac{1}{2} a\\epsilon (k_1 + 2k_2)|} = \\frac{|a\\epsilon|(k_1+2k_2)}{\\frac{1}{2}|a\\epsilon|(k_1+2k_2)} = 2\n$$",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "Ghost forces are not just artifacts of cutting bonds under strain; they can arise from more fundamental violations of physical principles. This practice shifts the focus to the force calculation itself and the crucial requirement of rigid-body invariance—the principle that a uniform translation of the system should induce no internal forces. You will derive the mathematical condition that a coupled force operator must satisfy to respect this principle and then calculate the spurious force generated by an operator that fails this test. This exercise  provides a deeper understanding of ghost forces as a failure of the numerical scheme to satisfy a fundamental consistency condition, a concept central to the \"patch test\" used to validate multiscale methods.",
            "id": "3812118",
            "problem": "Consider a one-dimensional crystalline chain with reference positions $X_i = i a$ and nearest-neighbor interactions described by a harmonic pair potential with stiffness $k$. Let $u = \\{u_i\\}_{i=1}^{N}$ denote the displacement field. The purely atomistic energy is defined by $E^{\\text{a}}(u) = \\frac{1}{2} k \\sum_{i=1}^{N-1} (u_{i+1} - u_i)^2$, so that atomistic forces are obtained by $F^{\\text{a}}_j(u) = -\\frac{\\partial E^{\\text{a}}}{\\partial u_j}$. In an Atomistic-to-Continuum (A/C) coupling, the force operator is modified in an interface set $\\mathcal{I} \\subset \\{2,\\dots,N-1\\}$ by a linear discrete operator with node-dependent coefficients,\n$$\nF^{\\text{couple}}_j(u) = k \\left( a_j u_j - b_j u_{j-1} - c_j u_{j+1} \\right), \\quad j \\in \\mathcal{I},\n$$\nwhile outside $\\mathcal{I}$ the atomistic operator $F^{\\text{a}}_j(u)$ is retained. Assume $a_j$, $b_j$, and $c_j$ are positive and vary smoothly with $j$ across $\\mathcal{I}$ due to blending with a Cauchy–Born finite element surrogate.\n\nStarting from fundamental principles, namely that rigid-body translations leave the physical energy invariant and forces must vanish under $u_i = \\alpha$ for any constant $\\alpha$ (rigid-body invariance), derive the necessary and sufficient condition on the coefficients $a_j$, $b_j$, and $c_j$ such that $F_j^{\\text{couple}}(\\alpha \\mathbf{1}) = 0$ for all $j \\in \\mathcal{I}$ and all $\\alpha \\in \\mathbb{R}$, where $\\mathbf{1}$ denotes the all-ones vector. Then, consider a specific interface node $j^{\\star} \\in \\mathcal{I}$ with coefficients $a_{j^{\\star}} = 2.05$, $b_{j^{\\star}} = 1.00$, $c_{j^{\\star}} = 1.00$, stiffness $k = 100$ in $\\text{N}/\\text{m}$, and a uniform translation $u_i = \\alpha$ with $\\alpha = 1.0 \\times 10^{-2}$ in $\\text{m}$. Compute the ghost force $F_{j^{\\star}}^{\\text{ghost}}$ at $j^{\\star}$ induced by the violation of rigid-body invariance, and express the result in $\\text{N}$. Round your answer to four significant figures.",
            "solution": "The problem consists of two parts: first, to derive the rigid-body invariance condition for a given force operator, and second, to calculate the ghost force generated by an operator that violates this condition.\n\n**Part 1: Rigid-Body Invariance Condition**\nThe principle of rigid-body invariance requires that a uniform translation of the system, $u_i = \\alpha$ for all $i$ and any constant $\\alpha$, must not induce any internal forces. For any node $j$ in the interface set $\\mathcal{I}$, the force must be zero under this displacement.\nThe coupled force operator is given by:\n$$\nF^{\\text{couple}}_j(u) = k \\left( a_j u_j - b_j u_{j-1} - c_j u_{j+1} \\right)\n$$\nSubstituting the uniform displacement $u_i = \\alpha$ gives:\n$$\nF_j^{\\text{couple}}(\\alpha \\mathbf{1}) = k \\left( a_j (\\alpha) - b_j (\\alpha) - c_j (\\alpha) \\right) = k \\alpha (a_j - b_j - c_j)\n$$\nFor this force to be zero for any arbitrary non-zero constant $\\alpha$ and stiffness $k>0$, the term in parentheses must be zero. This gives the necessary and sufficient condition for rigid-body invariance:\n$$\na_j - b_j - c_j = 0 \\quad \\text{or} \\quad a_j = b_j + c_j\n$$\n\n**Part 2: Ghost Force Calculation**\nA ghost force is the spurious, non-zero force generated by a numerical scheme that fails a fundamental consistency test. Here, the test is rigid-body invariance. We are given the following data for an interface node $j^{\\star}$:\n- $a_{j^{\\star}} = 2.05$\n- $b_{j^{\\star}} = 1.00$\n- $c_{j^{\\star}} = 1.00$\n- $k = 100 \\text{ N/m}$\n- $\\alpha = 1.0 \\times 10^{-2} \\text{ m}$\n\nWe first check if the invariance condition is satisfied:\n$$\na_{j^{\\star}} \\stackrel{?}{=} b_{j^{\\star}} + c_{j^{\\star}} \\implies 2.05 \\neq 1.00 + 1.00\n$$\nThe condition is violated. The resulting ghost force, $F_{j^{\\star}}^{\\text{ghost}}$, is calculated by substituting the given values into the force expression for a uniform translation:\n$$\nF_{j^{\\star}}^{\\text{ghost}} = k \\alpha (a_{j^{\\star}} - b_{j^{\\star}} - c_{j^{\\star}})\n$$\n$$\nF_{j^{\\star}}^{\\text{ghost}} = (100 \\text{ N/m}) \\times (1.0 \\times 10^{-2} \\text{ m}) \\times (2.05 - 1.00 - 1.00)\n$$\n$$\nF_{j^{\\star}}^{\\text{ghost}} = (1 \\text{ N}) \\times (0.05) = 0.05 \\text{ N}\n$$\nThe problem requires the answer to be expressed with four significant figures, which is $0.05000$ N.",
            "answer": "$$\n\\boxed{0.05000}\n$$"
        }
    ]
}