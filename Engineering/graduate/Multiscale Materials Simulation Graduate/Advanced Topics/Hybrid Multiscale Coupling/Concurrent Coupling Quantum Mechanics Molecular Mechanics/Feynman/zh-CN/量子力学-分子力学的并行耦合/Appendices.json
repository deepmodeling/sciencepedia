{
    "hands_on_practices": [
        {
            "introduction": "在凝聚态物质的 QM/MM 模拟中，一个核心挑战是如何精确计算周期性边界条件下（PBC）的长程静电相互作用。由于库仑相互作用 $1/r$ 的衰减非常缓慢，直接对晶格中的所有电荷求和会导致条件收敛，结果取决于求和顺序。本练习将指导您从第一性原理出发，使用经典的 Ewald 求和技术，推导出一个位于 QM 区域的电子所感受到的、由周期性排列的 MM 点电荷产生的静电势表达式 。掌握这一推导对于深刻理解如何在多尺度模拟中正确处理长程力至关重要。",
            "id": "3796872",
            "problem": "考虑在三维周期性边界条件 (PBC) 下的多尺度材料模拟中的并行量子力学/分子力学 (QM/MM) 嵌入。分子力学 (MM) 区域由 $N$ 个固定点电荷 $\\{q_{I}\\}_{I=1}^{N}$ 组成，它们位于由正格矢 $\\mathbf{a}_{1}$、$\\mathbf{a}_{2}$ 和 $\\mathbf{a}_{3}$ 张成的体积为 $V$ 的晶胞内的位置 $\\{\\mathbf{R}_{I}\\}_{I=1}^{N}$。量子力学 (QM) 区域包含由连续密度描述的电子，但为了推导静电嵌入势，将 QM 电子建模为位于位置 $\\mathbf{r}$ 的测试点。\n\n令 $\\mathcal{L}=\\{ \\mathbf{R}=n_{1}\\mathbf{a}_{1}+n_{2}\\mathbf{a}_{2}+n_{3}\\mathbf{a}_{3} : n_{1},n_{2},n_{3}\\in\\mathbb{Z}\\}$ 表示周期性映像的布拉菲晶格，并令倒格矢为 $\\mathbf{k}=h_{1}\\mathbf{b}_{1}+h_{2}\\mathbf{b}_{2}+h_{3}\\mathbf{b}_{3}$，其中 $\\mathbf{a}_{i}\\cdot\\mathbf{b}_{j}=2\\pi\\delta_{ij}$ 且 $h_{1},h_{2},h_{3}\\in\\mathbb{Z}$。假设采用导电（锡箔）边界条件，并且净 MM 电荷满足 $\\sum_{I=1}^{N} q_{I}=0$，以确保在没有宏观电场的情况下绝对收敛。\n\n从库仑定律和通过误差函数将 $1/r$ 核分解为短程和长程分量开始，\n$$\n\\frac{1}{r}=\\frac{\\operatorname{erfc}(\\alpha r)}{r}+\\frac{\\operatorname{erf}(\\alpha r)}{r},\n$$\n使用一个正的 Ewald 分裂参数 $\\alpha>0$，利用 Ewald 求和方法，从第一性原理推导出一个位于位置 $\\mathbf{r}$ 的 QM 电子所感受到的、由 MM 点电荷产生的周期性静电势 $\\phi_{\\mathrm{MM}}(\\mathbf{r})$。您的推导应从基本库仑相互作用出发，引入高斯屏蔽方法，对平滑分量在傅里叶空间中应用泊松方程，并正确处理自相互作用的消除。将最终结果表示为一个以 $\\{q_{I}\\}$、$\\{\\mathbf{R}_{I}\\}$、$\\mathcal{L}$、倒格矢 $\\mathbf{k}$、体积 $V$ 和 Ewald 参数 $\\alpha$ 表示的闭式解析表达式。不需要进行数值计算。请以单个解析表达式的形式提供您的最终答案。请勿在最终答案框中包含任何单位。",
            "solution": "用户希望我推导由周期性点电荷晶格产生的静电势的表达式，这是一个使用 Ewald 求和技术解决的经典问题。\n\n### 步骤 1：提取已知条件\n- 一组 $N$ 个点电荷 $\\{q_{I}\\}_{I=1}^{N}$，位于晶胞内的位置 $\\{\\mathbf{R}_{I}\\}_{I=1}^{N}$。\n- 晶胞体积为 $V$，由格矢 $\\mathbf{a}_{1}$、$\\mathbf{a}_{2}$、$\\mathbf{a}_{3}$ 定义。\n- 布拉菲晶格为 $\\mathcal{L}=\\{ \\mathbf{L}=n_{1}\\mathbf{a}_{1}+n_{2}\\mathbf{a}_{2}+n_{3}\\mathbf{a}_{3} : n_{1},n_{2},n_{3}\\in\\mathbb{Z}\\}$。（为清晰起见，变量从 $\\mathbf{R}$ 重命名为 $\\mathbf{L}$，以区分格矢和粒子坐标）。\n- 倒格矢为 $\\mathbf{k}$，满足 $\\mathbf{a}_{i}\\cdot\\mathbf{b}_{j}=2\\pi\\delta_{ij}$。\n- 体系呈电中性：$\\sum_{I=1}^{N} q_{I}=0$。\n- 边界条件为导电（锡箔），意味着平均静电势为零。\n- 势将在 QM 电子位置 $\\mathbf{r}$ 处计算。\n- 给出了用于分裂库仑核的数学恒等式：$\\frac{1}{r}=\\frac{\\operatorname{erfc}(\\alpha r)}{r}+\\frac{\\operatorname{erf}(\\alpha r)}{r}$，其中分裂参数 $\\alpha>0$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法恰当且客观。它描述了解决计算物理和化学中一个基本问题（计算周期性系统中的静电相互作用）的标准方法（Ewald 求和）。所提供的信息是完整和一致的，包含了推导所需的所有必要组成部分：电荷性质、晶格几何、电中性、边界条件以及所需的数学恒等式。问题陈述精确，不含任何科学缺陷、歧义或非形式化概念。它完全属于 QM/MM 模拟的指定主题范畴。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供完整的推导过程。\n\n### 推导\n位于位置 $\\mathbf{r}$（QM 电子的位置）处，由 MM 点电荷 $\\{q_{I}\\}$ 及其所有周期性映像产生的静电势 $\\phi_{\\mathrm{MM}}(\\mathbf{r})$ 由库仑势的总和给出：\n$$\n\\phi_{\\mathrm{MM}}(\\mathbf{r}) = \\sum_{I=1}^{N} \\sum_{\\mathbf{L} \\in \\mathcal{L}} \\frac{q_I}{|\\mathbf{r} - \\mathbf{R}_I - \\mathbf{L}|}\n$$\n这个和是条件收敛的，其值取决于求和的顺序。Ewald 方法通过将其分裂为两个快速收敛的级数（一个在实空间，一个在倒易空间），为计算这个和提供了一个稳健的程序。\n\n我们使用所提供的恒等式，它将库仑核 $1/x$ 分裂为一个短程部分和一个长程部分：\n$$\n\\frac{1}{|\\mathbf{r}'|} = \\frac{\\operatorname{erfc}(\\alpha |\\mathbf{r}'|)}{|\\mathbf{r}'|} + \\frac{\\operatorname{erf}(\\alpha |\\mathbf{r}'|)}{|\\mathbf{r}'|}\n$$\n其中 $\\operatorname{erf}(x)$ 是误差函数，$\\operatorname{erfc}(x) = 1 - \\operatorname{erf}(x)$ 是互补误差函数。将此代入势的表达式，我们得到两项：\n$$\n\\phi_{\\mathrm{MM}}(\\mathbf{r}) = \\phi_{\\mathrm{SR}}(\\mathbf{r}) + \\phi_{\\mathrm{LR}}(\\mathbf{r})\n$$\n$$\n\\phi_{\\mathrm{SR}}(\\mathbf{r}) = \\sum_{I=1}^N \\sum_{\\mathbf{L} \\in \\mathcal{L}} q_I \\frac{\\operatorname{erfc}(\\alpha |\\mathbf{r} - \\mathbf{R}_I - \\mathbf{L}|)}{|\\mathbf{r} - \\mathbf{R}_I - \\mathbf{L}|}\n$$\n$$\n\\phi_{\\mathrm{LR}}(\\mathbf{r}) = \\sum_{I=1}^N \\sum_{\\mathbf{L} \\in \\mathcal{L}} q_I \\frac{\\operatorname{erf}(\\alpha |\\mathbf{r} - \\mathbf{R}_I - \\mathbf{L}|)}{|\\mathbf{r} - \\mathbf{R}_I - \\mathbf{L}|}\n$$\n\n第一项 $\\phi_{\\mathrm{SR}}(\\mathbf{r})$ 是**短程（实空间）贡献**。由于函数 $\\operatorname{erfc}(\\alpha x)/x$ 的快速衰减，这个和收敛得很快，可以在少数相邻晶胞处截断。\n\n第二项 $\\phi_{\\mathrm{LR}}(\\mathbf{r})$ 是**长程（倒易空间）贡献**。函数 $\\operatorname{erf}(\\alpha x)/x$ 是平滑且长程的，这使得在实空间中直接求和效率低下。我们在倒易空间中计算这一项。这个势可以看作是由平滑的高斯电荷分布的周期性排列所产生的势：\n$$\n\\rho_{\\mathrm{LR}}(\\mathbf{x}) = \\sum_{I=1}^N \\sum_{\\mathbf{L} \\in \\mathcal{L}} q_I \\left(\\frac{\\alpha}{\\sqrt{\\pi}}\\right)^3 \\exp(-\\alpha^2 |\\mathbf{x} - \\mathbf{R}_I - \\mathbf{L}|^2)\n$$\n由于 $\\rho_{\\mathrm{LR}}(\\mathbf{x})$ 是一个具有晶格周期性的周期函数，它可以展开成傅里叶级数：\n$$\n\\rho_{\\mathrm{LR}}(\\mathbf{x}) = \\sum_{\\mathbf{k}} \\tilde{\\rho}_{\\mathrm{LR}}(\\mathbf{k}) \\exp(i\\mathbf{k}\\cdot\\mathbf{x})\n$$\n其中求和遍及所有倒格矢 $\\mathbf{k}$。傅里叶系数 $\\tilde{\\rho}_{\\mathrm{LR}}(\\mathbf{k})$ 由下式给出：\n$$\n\\tilde{\\rho}_{\\mathrm{LR}}(\\mathbf{k}) = \\frac{1}{V} \\int_V \\rho_{\\mathrm{LR}}(\\mathbf{x}) \\exp(-i\\mathbf{k}\\cdot\\mathbf{x}) d^3x\n$$\n代入 $\\rho_{\\mathrm{LR}}(\\mathbf{x})$ 的表达式，并利用周期性将晶胞体积 $V$ 上的积分扩展到整个空间 $\\mathbb{R}^3$：\n$$\n\\tilde{\\rho}_{\\mathrm{LR}}(\\mathbf{k}) = \\frac{1}{V} \\sum_{I=1}^N q_I \\int_{\\mathbb{R}^3} \\left(\\frac{\\alpha}{\\sqrt{\\pi}}\\right)^3 \\exp(-\\alpha^2 |\\mathbf{x} - \\mathbf{R}_I|^2) \\exp(-i\\mathbf{k}\\cdot\\mathbf{x}) d^3x\n$$\n该积分是高斯函数的傅里叶变换。函数 $f(\\mathbf{x}) = \\exp(-a|\\mathbf{x}|^2)$ 的傅里叶变换是 $\\tilde{f}(\\mathbf{k}) = (\\pi/a)^{3/2} \\exp(-|\\mathbf{k}|^2/(4a))$。在我们的情况中，$a = \\alpha^2$。对傅里叶变换应用位移定理后，我们得到：\n$$\n\\tilde{\\rho}_{\\mathrm{LR}}(\\mathbf{k}) = \\frac{1}{V} \\sum_{I=1}^N q_I \\exp(-i\\mathbf{k}\\cdot\\mathbf{R}_I) \\exp\\left(-\\frac{|\\mathbf{k}|^2}{4\\alpha^2}\\right)\n$$\n对于 $\\mathbf{k}=\\mathbf{0}$ 分量，我们有 $\\exp(-i\\mathbf{0}\\cdot\\mathbf{R}_I)=1$ 和 $\\exp(0)=1$，所以：\n$$\n\\tilde{\\rho}_{\\mathrm{LR}}(\\mathbf{k=0}) = \\frac{1}{V} \\sum_{I=1}^N q_I = 0\n$$\n由于电中性条件 $\\sum_I q_I = 0$，该值为零，表明没有净电荷密度。\n\n势 $\\phi_{\\mathrm{LR}}(\\mathbf{r})$ 通过泊松方程 $\\nabla^2 \\phi_{\\mathrm{LR}} = -4\\pi\\rho_{\\mathrm{LR}}$ 与电荷密度 $\\rho_{\\mathrm{LR}}(\\mathbf{r})$ 相关。在傅里叶空间中，这对每个 $\\mathbf{k}$ 都变成一个代数方程：\n$$\n-|\\mathbf{k}|^2 \\tilde{\\phi}_{\\mathrm{LR}}(\\mathbf{k}) = -4\\pi\\tilde{\\rho}_{\\mathrm{LR}}(\\mathbf{k})\n$$\n对于 $\\mathbf{k} \\neq \\mathbf{0}$，我们可以解出势的傅里叶系数：\n$$\n\\tilde{\\phi}_{\\mathrm{LR}}(\\mathbf{k}) = \\frac{4\\pi}{|\\mathbf{k}|^2} \\tilde{\\rho}_{\\mathrm{LR}}(\\mathbf{k}) = \\frac{4\\pi}{V|\\mathbf{k}|^2} \\exp\\left(-\\frac{|\\mathbf{k}|^2}{4\\alpha^2}\\right) \\sum_{I=1}^N q_I \\exp(-i\\mathbf{k}\\cdot\\mathbf{R}_I)\n$$\n对于 $\\mathbf{k}=\\mathbf{0}$，平均势 $\\tilde{\\phi}_{\\mathrm{LR}}(\\mathbf{k=0})$ 由边界条件决定。指定的“导电（锡箔）”边界条件意味着平均势为零，因此 $\\tilde{\\phi}_{\\mathrm{LR}}(\\mathbf{k=0})=0$。\n\n我们通过对其傅里叶级数求和来重构长程势：\n$$\n\\phi_{\\mathrm{LR}}(\\mathbf{r}) = \\sum_{\\mathbf{k} \\neq \\mathbf{0}} \\tilde{\\phi}_{\\mathrm{LR}}(\\mathbf{k}) \\exp(i\\mathbf{k}\\cdot\\mathbf{r})\n$$\n$$\n\\phi_{\\mathrm{LR}}(\\mathbf{r}) = \\sum_{\\mathbf{k} \\neq \\mathbf{0}} \\frac{4\\pi}{V|\\mathbf{k}|^2} \\exp\\left(-\\frac{|\\mathbf{k}|^2}{4\\alpha^2}\\right) \\left( \\sum_{I=1}^N q_I \\exp(-i\\mathbf{k}\\cdot\\mathbf{R}_I) \\right) \\exp(i\\mathbf{k}\\cdot\\mathbf{r})\n$$\n合并指数项，简化为：\n$$\n\\phi_{\\mathrm{LR}}(\\mathbf{r}) = \\frac{4\\pi}{V} \\sum_{\\mathbf{k} \\neq \\mathbf{0}} \\frac{\\exp(-\\frac{|\\mathbf{k}|^2}{4\\alpha^2})}{|\\mathbf{k}|^2} \\sum_{I=1}^N q_I \\exp(i\\mathbf{k}\\cdot(\\mathbf{r} - \\mathbf{R}_I))\n$$\n\n最后，总静电势是短程和长程贡献的总和：\n$$\n\\phi_{\\mathrm{MM}}(\\mathbf{r}) = \\phi_{\\mathrm{SR}}(\\mathbf{r}) + \\phi_{\\mathrm{LR}}(\\mathbf{r})\n$$\n在这个势的表达式中，不需要“自相互作用”校正项。这种项在计算 MM 粒子系统本身的总静电能时出现，用于校正粒子与其自身屏蔽电荷相互作用的人为效应。在这里，我们计算的是在一个测试点 $\\mathbf{r}$（QM 电子）处的势，该点与任何 MM 电荷位置 $\\{\\mathbf{R}_I\\}$ 都不同，因此这种校正不适用。\n\n势的完整表达式为：\n$$\n\\phi_{\\mathrm{MM}}(\\mathbf{r}) = \\sum_{I=1}^N \\sum_{\\mathbf{L} \\in \\mathcal{L}} q_I \\frac{\\operatorname{erfc}(\\alpha |\\mathbf{r} - \\mathbf{R}_I - \\mathbf{L}|)}{|\\mathbf{r} - \\mathbf{R}_I - \\mathbf{L}|} + \\frac{4\\pi}{V} \\sum_{\\mathbf{k} \\neq \\mathbf{0}} \\frac{\\exp(-\\frac{|\\mathbf{k}|^2}{4\\alpha^2})}{|\\mathbf{k}|^2} \\sum_{I=1}^N q_I \\exp(i\\mathbf{k}\\cdot(\\mathbf{r} - \\mathbf{R}_I))\n$$\n这就是嵌入在周期性 MM 电荷场中的 QM 电子所感受到的周期性静电势。",
            "answer": "$$\n\\boxed{ \\sum_{I=1}^N \\sum_{\\mathbf{L} \\in \\mathcal{L}} q_I \\frac{\\operatorname{erfc}(\\alpha |\\mathbf{r} - \\mathbf{R}_I - \\mathbf{L}|)}{|\\mathbf{r} - \\mathbf{R}_I - \\mathbf{L}|} + \\frac{4\\pi}{V} \\sum_{\\mathbf{k} \\neq \\mathbf{0}} \\frac{\\exp\\left(-\\frac{|\\mathbf{k}|^2}{4\\alpha^2}\\right)}{|\\mathbf{k}|^2} \\sum_{I=1}^N q_I \\exp(i\\mathbf{k}\\cdot(\\mathbf{r} - \\mathbf{R}_I)) }\n$$"
        },
        {
            "introduction": "虽然固定点电荷模型在许多 QM/MM 应用中很有效，但它忽略了一个重要的物理效应：QM 区域和 MM 环境之间的相互极化。更高精度的模型允许 MM 原子响应 QM 区域的电场而极化，同时 QM 电子云也反过来感受到这些诱导偶极子的影响。本练习旨在推导描述这种相互作用的自洽方程 ，您将通过最小化总极化能，得到定义诱导偶极子的线性方程组。这一过程是构建高级极化嵌入方案的核心。",
            "id": "3796879",
            "problem": "考虑在多尺度材料模拟中的一个并行量子力学/分子力学 (QM/MM) 嵌入，其中一个分子力学 (MM) 环境包含 $N$ 个可极化相互作用位点，每个位点位于位置 $\\mathbf{R}_i$，具有各向同性极化率 $\\alpha_i$。每个 MM 位点可以携带产生静电场的永久多极矩（电荷、偶极矩及更高阶）。一个由电子电荷密度 $\\rho(\\mathbf{r})$ 和固定的 QM 原子核描述的量子力学 (QM) 子系统，在 MM 区域产生一个静电场。MM 位点可以产生感生偶极矩 $\\boldsymbol{\\mu}_i$，其对局域电场作出线性响应。\n\n假设以下物理上标准的要素：\n- 由 QM 子系统在 MM 位点 $i$ 处产生的静电场由 Coulomb 定律应用于总 QM 电荷分布（电子加原子核）给出，记为 $\\mathbf{E}^{\\mathrm{QM}}_i[\\rho]$。此推导不需要其显式泛函形式，只需知道它是在 $\\mathbf{R}_i$ 处由 QM 子系统产生的静电场。\n- 由 MM 永久多极矩在 MM 位点 $i$ 处产生的静电场记为 $\\mathbf{E}^{\\mathrm{perm}}_i$，由 MM 位点的标准多极展开（不包括感生贡献）得到。\n- 位于位点 $i \\neq j$ 的两个感生偶极矩之间的偶极-偶极相互作用由经典偶极相互作用张量 $\\mathbf{T}_{ij}$ 决定，其定义为 $\\mathbf{T}_{ij} = \\nabla_{\\mathbf{R}_i} \\nabla_{\\mathbf{R}_j} \\frac{1}{|\\mathbf{R}_i - \\mathbf{R}_j|}$，作用于向量为 $\\mathbf{T}_{ij} \\boldsymbol{\\mu}_j$，且 $\\mathbf{T}_{ii} = \\mathbf{0}$。\n\n从基本静电学和线性响应出发：\n- 在线性响应下，于位点 $i$ 处产生一个感生偶极矩 $\\boldsymbol{\\mu}_i$ 所做的功为 $\\frac{1}{2} \\boldsymbol{\\mu}_i \\cdot \\alpha_i^{-1} \\boldsymbol{\\mu}_i$。\n- 一个偶极矩与给定的外场 $\\mathbf{E}_i^{\\mathrm{ext}}$ 的相互作用能为 $- \\boldsymbol{\\mu}_i \\cdot \\mathbf{E}_i^{\\mathrm{ext}}$。\n- 感生偶极矩之间的两两相互作用能为 $- \\frac{1}{2} \\sum_{i \\neq j} \\boldsymbol{\\mu}_i \\cdot \\mathbf{T}_{ij} \\cdot \\boldsymbol{\\mu}_j$。\n\n将位点 $i$ 处的外场视为叠加 $\\mathbf{E}_i^{\\mathrm{ext}} = \\mathbf{E}^{\\mathrm{QM}}_i[\\rho] + \\mathbf{E}^{\\mathrm{perm}}_i$。利用这些要素，写出作为感生偶极矩泛函的总极化能，推导关于 $\\boldsymbol{\\mu}_i$ 的平稳性条件，并由此获得定义感生偶极矩的自洽线性方程组，该方程组用 QM 电子密度和 MM 永久多极矩产生的局域场来表示。\n\n引入感生偶极矩的 $3N$ 维堆叠向量 $\\boldsymbol{\\mu} = (\\boldsymbol{\\mu}_1; \\dots; \\boldsymbol{\\mu}_N)$，块对角极化率矩阵 $\\mathcal{A} = \\mathrm{diag}(\\alpha_1 \\mathbf{I}_3, \\dots, \\alpha_N \\mathbf{I}_3)$，由 $i \\neq j$ 时的 $3 \\times 3$ 块 $\\mathbf{T}_{ij}$ 和对角线上的 $\\mathbf{0}$ 构成的 $3N \\times 3N$ 相互作用矩阵 $\\mathcal{T}$，以及堆叠了所有位点上电场的 $3N$ 维向量 $\\mathbf{E}^{\\mathrm{QM}}$ 和 $\\mathbf{E}^{\\mathrm{perm}}$。将您的最终结果表示为关于 $\\boldsymbol{\\mu}$ 的一个单一紧凑矩阵表达式，用 $\\mathcal{A}$、$\\mathcal{T}$、$\\mathbf{E}^{\\mathrm{QM}}$ 和 $\\mathbf{E}^{\\mathrm{perm}}$ 表示。\n\n您的最终答案必须是一个单一的闭式解析表达式。最终答案中不要包含任何单位。无需进行数值计算。",
            "solution": "该问题具有科学依据、自洽且适定。它描述了量子力学/分子力学 (QM/MM) 框架中一个标准的极化物理模型。我们着手推导感生偶极矩的自洽方程。\n\n总极化能 $U_{\\text{pol}}$ 是三部分贡献的总和：($1$) 产生感生偶极矩的能量（极化自能），($2$) 感生偶极矩与静态外电场的相互作用能，以及 ($3$) 感生偶极矩之间的相互作用能。使用所提供的表达式，作为感生偶极矩集合 $\\{\\boldsymbol{\\mu}_i\\}_{i=1}^N$ 的泛函的总极化能为：\n$$\nU_{\\text{pol}}[\\{\\boldsymbol{\\mu}_i\\}] = \\sum_{i=1}^N \\frac{1}{2} \\boldsymbol{\\mu}_i \\cdot (\\alpha_i \\mathbf{I}_3)^{-1} \\boldsymbol{\\mu}_i - \\sum_{i=1}^N \\boldsymbol{\\mu}_i \\cdot \\mathbf{E}_i^{\\text{ext}} - \\frac{1}{2} \\sum_{i=1}^N \\sum_{j=1, j\\neq i}^N \\boldsymbol{\\mu}_i \\cdot \\mathbf{T}_{ij} \\boldsymbol{\\mu}_j\n$$\n这里，$\\alpha_i$ 是位点 $i$ 的各向同性极化率，因此其极化率张量为 $\\alpha_i \\mathbf{I}_3$，其中 $\\mathbf{I}_3$ 是 $3 \\times 3$ 单位矩阵。其逆矩阵为 $(\\alpha_i \\mathbf{I}_3)^{-1} = \\frac{1}{\\alpha_i}\\mathbf{I}_3$。位点 $i$ 处的外场 $\\mathbf{E}_i^{\\text{ext}}$ 是来自 QM 子系统的场 $\\mathbf{E}^{\\mathrm{QM}}_i$ 和来自永久 MM 多极矩的场 $\\mathbf{E}^{\\mathrm{perm}}_i$ 的总和。因此，能量泛函为：\n$$\nU_{\\text{pol}} = \\sum_{i=1}^N \\frac{|\\boldsymbol{\\mu}_i|^2}{2\\alpha_i} - \\sum_{i=1}^N \\boldsymbol{\\mu}_i \\cdot (\\mathbf{E}^{\\mathrm{QM}}_i + \\mathbf{E}^{\\mathrm{perm}}_i) - \\frac{1}{2} \\sum_{i \\neq j} \\boldsymbol{\\mu}_i \\cdot \\mathbf{T}_{ij} \\boldsymbol{\\mu}_j\n$$\n感生偶极矩系统将平衡到一个使总能量达到平稳的构型。对于一个稳定的物理系统，这对应于一个最小值。我们通过要求 $U_{\\text{pol}}$ 相对于每个感生偶极矩向量 $\\boldsymbol{\\mu}_k$ 的梯度为零向量来找到这个构型：\n$$\n\\frac{\\partial U_{\\text{pol}}}{\\partial \\boldsymbol{\\mu}_k} = \\mathbf{0} \\quad \\text{对于 } k = 1, 2, \\dots, N\n$$\n我们通过对 $U_{\\text{pol}}$ 中的三项分别关于 $\\boldsymbol{\\mu}_k$ 求导来计算梯度：\n\n$1$. 自能项：\n$$\n\\frac{\\partial}{\\partial \\boldsymbol{\\mu}_k} \\left( \\sum_{i=1}^N \\frac{|\\boldsymbol{\\mu}_i|^2}{2\\alpha_i} \\right) = \\frac{\\partial}{\\partial \\boldsymbol{\\mu}_k} \\left( \\frac{|\\boldsymbol{\\mu}_k|^2}{2\\alpha_k} \\right) = \\frac{1}{\\alpha_k} \\boldsymbol{\\mu}_k\n$$\n\n$2$. 外场相互作用项：\n$$\n\\frac{\\partial}{\\partial \\boldsymbol{\\mu}_k} \\left( - \\sum_{i=1}^N \\boldsymbol{\\mu}_i \\cdot (\\mathbf{E}^{\\mathrm{QM}}_i + \\mathbf{E}^{\\mathrm{perm}}_i) \\right) = - (\\mathbf{E}^{\\mathrm{QM}}_k + \\mathbf{E}^{\\mathrm{perm}}_k)\n$$\n\n$3$. 感生偶极-偶极相互作用项。我们注意到相互作用张量 $\\mathbf{T}_{ij}$ 既作为 $3 \\times 3$ 矩阵是对称的（$\\mathbf{T}_{ij} = \\mathbf{T}_{ij}^T$），也关于粒子指标是对称的（$\\mathbf{T}_{ij} = \\mathbf{T}_{ji}$）。\n$$\n\\frac{\\partial}{\\partial \\boldsymbol{\\mu}_k} \\left( - \\frac{1}{2} \\sum_{i \\neq j} \\boldsymbol{\\mu}_i \\cdot \\mathbf{T}_{ij} \\boldsymbol{\\mu}_j \\right) = - \\frac{1}{2} \\sum_{j \\neq k} \\frac{\\partial}{\\partial \\boldsymbol{\\mu}_k} (\\boldsymbol{\\mu}_k \\cdot \\mathbf{T}_{kj} \\boldsymbol{\\mu}_j) - \\frac{1}{2} \\sum_{i \\neq k} \\frac{\\partial}{\\partial \\boldsymbol{\\mu}_k} (\\boldsymbol{\\mu}_i \\cdot \\mathbf{T}_{ik} \\boldsymbol{\\mu}_k)\n$$\n利用矢量微积分法则（$\\frac{\\partial}{\\partial \\mathbf{x}}(\\mathbf{x} \\cdot \\mathbf{A} \\mathbf{y}) = \\mathbf{A} \\mathbf{y}$ 和 $\\frac{\\partial}{\\partial \\mathbf{x}}(\\mathbf{y} \\cdot \\mathbf{A} \\mathbf{x}) = \\mathbf{A}^T \\mathbf{y}$），以及对称性 $\\mathbf{T}_{ik} = \\mathbf{T}_{ik}^T$，这变为：\n$$\n= - \\frac{1}{2} \\sum_{j \\neq k} \\mathbf{T}_{kj} \\boldsymbol{\\mu}_j - \\frac{1}{2} \\sum_{i \\neq k} \\mathbf{T}_{ik} \\boldsymbol{\\mu}_i = - \\sum_{j \\neq k} \\mathbf{T}_{kj} \\boldsymbol{\\mu}_j\n$$\n结合这三个结果，位点 $k$ 的平稳性条件是：\n$$\n\\frac{1}{\\alpha_k} \\boldsymbol{\\mu}_k - (\\mathbf{E}^{\\mathrm{QM}}_k + \\mathbf{E}^{\\mathrm{perm}}_k) - \\sum_{j \\neq k} \\mathbf{T}_{kj} \\boldsymbol{\\mu}_j = \\mathbf{0}\n$$\n整理这个方程得到 $\\boldsymbol{\\mu}_k$ 的自洽条件：\n$$\n\\frac{1}{\\alpha_k} \\boldsymbol{\\mu}_k - \\sum_{j \\neq k} \\mathbf{T}_{kj} \\boldsymbol{\\mu}_j = \\mathbf{E}^{\\mathrm{QM}}_k + \\mathbf{E}^{\\mathrm{perm}}_k\n$$\n这代表了一个由 $N$ 个耦合的线性矢量方程组成的系统，每个位点 $k=1, \\dots, N$ 对应一个方程。为了将此系统以紧凑的矩阵形式表示，我们使用问题中定义的 $3N$ 维堆叠向量和 $3N \\times 3N$ 块矩阵。所有感生偶极矩的堆叠向量是 $\\boldsymbol{\\mu} = (\\boldsymbol{\\mu}_1; \\dots; \\boldsymbol{\\mu}_N)$。外场向量是 $\\mathbf{E}^{\\mathrm{ext}} = \\mathbf{E}^{\\mathrm{QM}} + \\mathbf{E}^{\\mathrm{perm}}$。\n\n对于所有的 $k$，项 $\\frac{1}{\\alpha_k} \\boldsymbol{\\mu}_k$ 对应于矩阵-向量乘积 $\\mathcal{A}^{-1} \\boldsymbol{\\mu}$，其中 $\\mathcal{A}^{-1} = \\mathrm{diag}(\\frac{1}{\\alpha_1}\\mathbf{I}_3, \\dots, \\frac{1}{\\alpha_N}\\mathbf{I}_3)$。\n项 $\\sum_{j \\neq k} \\mathbf{T}_{kj} \\boldsymbol{\\mu}_j$ 是矩阵-向量乘积 $\\mathcal{T}\\boldsymbol{\\mu}$ 的第 $k$ 个块，其中 $\\mathcal{T}$ 是一个块矩阵，其块元素 $\\mathcal{T}_{ij}$ 在 $i \\neq j$ 时为 $\\mathbf{T}_{ij}$，且 $\\mathcal{T}_{ii}=\\mathbf{0}$。\n\n因此，整个方程组可以写成：\n$$\n\\mathcal{A}^{-1} \\boldsymbol{\\mu} - \\mathcal{T} \\boldsymbol{\\mu} = \\mathbf{E}^{\\mathrm{QM}} + \\mathbf{E}^{\\mathrm{perm}}\n$$\n提出因子 $\\boldsymbol{\\mu}$ 得到：\n$$\n(\\mathcal{A}^{-1} - \\mathcal{T}) \\boldsymbol{\\mu} = \\mathbf{E}^{\\mathrm{QM}} + \\mathbf{E}^{\\mathrm{perm}}\n$$\n为了解出 $\\boldsymbol{\\mu}$ 并用 $\\mathcal{A}$ 而非 $\\mathcal{A}^{-1}$ 表示结果，我们可以左乘 $\\mathcal{A}$：\n$$\n\\mathcal{A} (\\mathcal{A}^{-1} - \\mathcal{T}) \\boldsymbol{\\mu} = \\mathcal{A} (\\mathbf{E}^{\\mathrm{QM}} + \\mathbf{E}^{\\mathrm{perm}})\n$$\n$$\n(\\mathcal{A}\\mathcal{A}^{-1} - \\mathcal{A}\\mathcal{T}) \\boldsymbol{\\mu} = \\mathcal{A} (\\mathbf{E}^{\\mathrm{QM}} + \\mathbf{E}^{\\mathrm{perm}})\n$$\n注意到 $\\mathcal{A}\\mathcal{A}^{-1} = \\mathbf{I}$，其中 $\\mathbf{I}$ 是 $3N \\times 3N$ 单位矩阵，我们有：\n$$\n(\\mathbf{I} - \\mathcal{A}\\mathcal{T}) \\boldsymbol{\\mu} = \\mathcal{A} (\\mathbf{E}^{\\mathrm{QM}} + \\mathbf{E}^{\\mathrm{perm}})\n$$\n最后，我们通过左乘矩阵 $(\\mathbf{I} - \\mathcal{A}\\mathcal{T})$ 的逆矩阵来解出 $\\boldsymbol{\\mu}$：\n$$\n\\boldsymbol{\\mu} = (\\mathbf{I} - \\mathcal{A}\\mathcal{T})^{-1} \\mathcal{A} (\\mathbf{E}^{\\mathrm{QM}} + \\mathbf{E}^{\\mathrm{perm}})\n$$\n这是自洽确定的感生偶极矩的最终紧凑矩阵表达式。",
            "answer": "$$\n\\boxed{(\\mathbf{I} - \\mathcal{A}\\mathcal{T})^{-1} \\mathcal{A} (\\mathbf{E}^{\\mathrm{QM}} + \\mathbf{E}^{\\mathrm{perm}})}\n$$"
        },
        {
            "introduction": "成功的 QM/MM 模拟不仅需要物理模型的准确性，还需要计算上的可行性。在设计一个模拟时，选择 QM 和 MM 区域的大小是一个关键的权衡，它直接影响计算成本和结果的精度。本练习将理论与实践相结合，要求您基于 QM 和 MM 算法的已知计算标度律，构建一个预测单步分子动力学模拟时间的成本模型 。通过将该模型与实际的性能分析数据进行拟合，您将掌握一项量化和预测模拟性能的重要技能，这对于规划和优化大规模计算至关重要。",
            "id": "3796866",
            "problem": "您正在为一个并行耦合的量子力学/分子力学 (QM/MM) 多尺度模拟中的每个分子动力学步长的计算墙上时间进行建模。每步的墙上时间分解为量子力学区域、分子力学区域以及并行开销（通信和同步）的贡献。设 $N_{\\mathrm{basis}}$ 表示量子力学区域中单电子基函数的数量，$N_{\\mathrm{MM}}$ 表示分子力学区域中原子的数量。假设每步的墙上时间（秒）由以下加性模型给出：\n$$\nt\\left(N_{\\mathrm{basis}}, N_{\\mathrm{MM}}\\right) = t_{\\mathrm{QM}}\\left(N_{\\mathrm{basis}}\\right) + t_{\\mathrm{MM}}\\left(N_{\\mathrm{MM}}\\right) + t_{\\mathrm{comm}},\n$$\n其中，$t_{\\mathrm{QM}}$ 主要由固定密度下的对角化和积分形成主导，其标度为一个三次多项式项和一个附加的线性项；$t_{\\mathrm{MM}}$ 由于带截断的短程对相互作用，与 $N_{\\mathrm{MM}}$ 呈线性标度关系；$t_{\\mathrm{comm}}$ 是由并行耦合（区域分解、晕圈交换和同步）引起的每步恒定开销。形式上，模型为：\n$$\nt_{\\mathrm{QM}}(N_{\\mathrm{basis}}) = \\alpha \\, N_{\\mathrm{basis}}^{3} + \\delta \\, N_{\\mathrm{basis}},\n\\quad\nt_{\\mathrm{MM}}(N_{\\mathrm{MM}}) = \\beta \\, N_{\\mathrm{MM}},\n\\quad\nt_{\\mathrm{comm}} = \\gamma,\n$$\n其中未知参数 $\\alpha$、$\\beta$、$\\gamma$、$\\delta$ 将使用普通最小二乘法从性能分析数据中估计得出。\n\n您将获得由 $(N_{\\mathrm{basis}}, N_{\\mathrm{MM}}, t)$ 三元组组成的性能分析测量数据，其中 $t$ 是测得的墙上时间（秒）。请使用这些数据，通过对特征向量 $\\left[N_{\\mathrm{basis}}^{3}, N_{\\mathrm{basis}}, N_{\\mathrm{MM}}, 1\\right]$ 应用线性最小二乘法来拟合参数 $\\alpha$、$\\beta$、$\\gamma$、$\\delta$。然后，使用拟合的参数，预测下列每个测试用例的墙上时间（秒）。\n\n性能分析数据集（所有 $t$ 单位为秒）：\n- $(150, 1000, 0.073375)$\n- $(200, 2000, 0.099700)$\n- $(300, 1500, 0.196300)$\n- $(400, 2500, 0.384500)$\n- $(500, 3000, 0.696000)$\n- $(350, 4000, 0.282675)$\n- $(250, 500, 0.135725)$\n- $(180, 8000, 0.106560)$\n- $(220, 12000, 0.145040)$\n- $(100, 10000, 0.086500)$\n\n用于评估预测的测试套件（所有 $N_{\\mathrm{basis}}$ 和 $N_{\\mathrm{MM}}$ 均为整数）：\n- 用例 A（通用）：$(N_{\\mathrm{basis}}, N_{\\mathrm{MM}}) = (320, 3500)$\n- 用例 B（小规模）：$(N_{\\mathrm{basis}}, N_{\\mathrm{MM}}) = (120, 200)$\n- 用例 C（无分子力学环境的纯QM边界情况）：$(N_{\\mathrm{basis}}, N_{\\mathrm{MM}}) = (450, 0)$\n- 用例 D（MM主导的环境）：$(N_{\\mathrm{basis}}, N_{\\mathrm{MM}}) = (180, 15000)$\n- 用例 E（大规模QM和MM）：$(N_{\\mathrm{basis}}, N_{\\mathrm{MM}}) = (600, 6000)$\n\n要求输出：您的程序应生成单行输出，其中包含五个测试用例的预测墙上时间（秒），每个值四舍五入到六位小数，格式为逗号分隔的列表并用方括号括起（例如，$[0.123456,0.234567,0.345678,0.456789,0.567890]$）。\n\n单位规范：所有时间必须以秒为单位表示。\n\n算法约束和推导要求：您的方法必须从上述标度假设出发，并使用以 $\\left[N_{\\mathrm{basis}}^{3}, N_{\\mathrm{basis}}, N_{\\mathrm{MM}}, 1\\right]$ 为列的设计矩阵，推导出 $\\alpha$、$\\beta$、$\\gamma$、$\\delta$ 的线性最小二乘估计器。解决方案必须最小化测量时间 $t$ 与模型预测值之间的残差平方和。不允许使用任何临时的拟合技巧或非线性回归捷径；必须使用基于线性代数的普通最小二乘法。请使用经过充分测试的线性代数方法，以确保数值稳定性。\n\n最终输出格式规范：您的程序应生成单行输出，其中包含一个由方括号括起的逗号分隔列表形式的结果，每个值四舍五入到六位小数（例如，$[r_1,r_2,r_3,r_4,r_5]$）。",
            "solution": "该问题要求将一个QM/MM模拟的计算成本模型拟合到给定的数据集，然后使用拟合后的模型为一组测试用例预测墙上时间。\n\n### 步骤 1：问题验证\n\n第一步是验证问题陈述。\n\n**从问题陈述中提取的已知信息：**\n1.  **每步墙上时间模型**：$t\\left(N_{\\mathrm{basis}}, N_{\\mathrm{MM}}\\right) = t_{\\mathrm{QM}}\\left(N_{\\mathrm{basis}}\\right) + t_{\\mathrm{MM}}\\left(N_{\\mathrm{MM}}\\right) + t_{\\mathrm{comm}}$。\n2.  **各组分标度模型**：\n    - $t_{\\mathrm{QM}}(N_{\\mathrm{basis}}) = \\alpha \\, N_{\\mathrm{basis}}^{3} + \\delta \\, N_{\\mathrm{basis}}$\n    - $t_{\\mathrm{MM}}(N_{\\mathrm{MM}}) = \\beta \\, N_{\\mathrm{MM}}$\n    - $t_{\\mathrm{comm}} = \\gamma$\n3.  **组合线性模型**：$t = \\alpha \\, N_{\\mathrm{basis}}^{3} + \\delta \\, N_{\\mathrm{basis}} + \\beta \\, N_{\\mathrm{MM}} + \\gamma$，其中 $\\alpha$、$\\beta$、$\\gamma$ 和 $\\delta$ 是未知参数。\n4.  **方法论**：使用普通最小二乘法和特征向量 $\\left[N_{\\mathrm{basis}}^{3}, N_{\\mathrm{basis}}, N_{\\mathrm{MM}}, 1\\right]$ 拟合参数。\n5.  **性能分析数据集**（$m=10$ 次测量）：\n    - $(150, 1000, 0.073375)$\n    - $(200, 2000, 0.099700)$\n    - $(300, 1500, 0.196300)$\n    - $(400, 2500, 0.384500)$\n    - $(500, 3000, 0.696000)$\n    - $(350, 4000, 0.282675)$\n    - $(250, 500, 0.135725)$\n    - $(180, 8000, 0.106560)$\n    - $(220, 12000, 0.145040)$\n    - $(100, 10000, 0.086500)$\n6.  **测试套件**（用于预测 $t$）：\n    - 用例 A：$(N_{\\mathrm{basis}}, N_{\\mathrm{MM}}) = (320, 3500)$\n    - 用例 B：$(N_{\\mathrm{basis}}, N_{\\mathrm{MM}}) = (120, 200)$\n    - 用例 C：$(N_{\\mathrm{basis}}, N_{\\mathrm{MM}}) = (450, 0)$\n    - 用例 D：$(N_{\\mathrm{basis}}, N_{\\mathrm{MM}}) = (180, 15000)$\n    - 用例 E：$(N_{\\mathrm{basis}}, N_{\\mathrm{MM}}) = (600, 6000)$\n\n**验证评估：**\n- **科学基础**：该模型是许多QM/MM方法计算成本的标准且物理上合理的近似。QM部分的立方标度 $O(N_{\\mathrm{basis}}^3)$ 是以矩阵对角化为主导的方法（例如Hartree-Fock或DFT）的特征，而MM部分的线性标度 $O(N_{\\mathrm{MM}})$ 对于使用截断半径评估短程相互作用的系统是典型的。对于并行耦合方案，恒定的开销项是合理的。该问题在科学上是合理的。\n- **适定性**：任务是解决一个线性回归问题。我们有10个数据点来确定4个参数。这是一个超定系统。只要设计矩阵的列是线性无关的，就存在一个最小化最小二乘误差的唯一解。输入数据点 $(N_{\\mathrm{basis}}, N_{\\mathrm{MM}})$ 的多样性确保了这一条件的满足，使得问题是适定的。\n- **客观性**：问题是用精确的数学公式、数值数据和明确的目标来规定的。它不含主观或模糊的元素。\n\n**结论：**\n问题有效。我们可以继续进行求解。\n\n### 步骤 2：解法推导\n\n问题是找到最能拟合给定数据的参数 $\\alpha, \\delta, \\beta, \\gamma$。模型方程为：\n$$\nt = \\alpha N_{\\mathrm{basis}}^{3} + \\delta N_{\\mathrm{basis}} + \\beta N_{\\mathrm{MM}} + \\gamma\n$$\n该方程对参数是线性的。对于一组 $m$ 次测量，我们可以写出一个线性方程组。设参数向量定义为 $\\mathbf{p}$：\n$$\n\\mathbf{p} = \\begin{bmatrix} \\alpha \\\\ \\delta \\\\ \\beta \\\\ \\gamma \\end{bmatrix}\n$$\n对于每次测量 $i \\in \\{1, \\dots, m\\}$，我们有一个测量时间 $t_i$，对应于输入 $N_{\\mathrm{basis}, i}$ 和 $N_{\\mathrm{MM}, i}$。第 $i$ 次测量的模型方程为：\n$$\nt_i \\approx \\alpha (N_{\\mathrm{basis}, i})^3 + \\delta (N_{\\mathrm{basis}, i}) + \\beta (N_{\\mathrm{MM}, i}) + \\gamma \\cdot 1\n$$\n这可以表示为矩阵-向量方程 $\\mathbf{y} \\approx \\mathbf{Xp}$，其中 $\\mathbf{y}$ 是观测时间的向量，$\\mathbf{X}$ 是设计矩阵。\n$$\n\\mathbf{y} = \\begin{bmatrix} t_1 \\\\ t_2 \\\\ \\vdots \\\\ t_m \\end{bmatrix}, \\quad\n\\mathbf{X} = \\begin{bmatrix}\n(N_{\\mathrm{basis}, 1})^3  N_{\\mathrm{basis}, 1}  N_{\\mathrm{MM}, 1}  1 \\\\\n(N_{\\mathrm{basis}, 2})^3  N_{\\mathrm{basis}, 2}  N_{\\mathrm{MM}, 2}  1 \\\\\n\\vdots  \\vdots  \\vdots  \\vdots \\\\\n(N_{\\mathrm{basis}, m})^3  N_{\\mathrm{basis}, m}  N_{\\mathrm{MM}, m}  1\n\\end{bmatrix}\n$$\n问题规定了 $m=10$ 个数据点和 $4$ 个参数。普通最小二乘法的目标是找到使残差平方和 $S(\\mathbf{p}) = \\|\\mathbf{y} - \\mathbf{Xp}\\|_2^2$ 最小化的参数向量 $\\mathbf{p}$。这个最小化问题的解可以通过求解正规方程得到：\n$$\n(\\mathbf{X}^T\\mathbf{X})\\mathbf{p} = \\mathbf{X}^T\\mathbf{y}\n$$\n$\\mathbf{p}$ 的形式解为 $\\mathbf{p} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}$。出于数值稳定性的考虑，最好使用QR分解或奇异值分解（SVD）等方法来求解 $\\mathbf{p}$，而不是显式计算 $\\mathbf{X}^T\\mathbf{X}$ 的逆矩阵。`numpy.linalg.lstsq` 函数为找到这个最小二乘解提供了一个稳健的实现。\n\n首先，我们根据性能分析数据构建 $10 \\times 4$ 的设计矩阵 $\\mathbf{X}$ 和 $10 \\times 1$ 的观测向量 $\\mathbf{y}$。\n$$\n\\mathbf{X} = \\begin{bmatrix}\n150^3  150  1000  1 \\\\\n200^3  200  2000  1 \\\\\n300^3  300  1500  1 \\\\\n400^3  400  2500  1 \\\\\n500^3  500  3000  1 \\\\\n350^3  350  4000  1 \\\\\n250^3  250  500  1 \\\\\n180^3  180  8000  1 \\\\\n220^3  220  12000  1 \\\\\n100^3  100  10000  1\n\\end{bmatrix}, \\quad\n\\mathbf{y} = \\begin{bmatrix}\n0.073375 \\\\\n0.099700 \\\\\n0.196300 \\\\\n0.384500 \\\\\n0.696000 \\\\\n0.282675 \\\\\n0.135725 \\\\\n0.106560 \\\\\n0.145040 \\\\\n0.086500\n\\end{bmatrix}\n$$\n以最小二乘意义求解系统 $\\mathbf{Xp} = \\mathbf{y}$，得到估计的参数向量 $\\mathbf{p} = [\\hat{\\alpha}, \\hat{\\delta}, \\hat{\\beta}, \\hat{\\gamma}]^T$。\n\n一旦确定了参数，对于任何新的值对 $(N_{\\mathrm{basis}, \\text{test}}, N_{\\mathrm{MM}, \\text{test}})$，其墙上时间可以用拟合模型预测：\n$$\nt_{\\text{pred}} = \\hat{\\alpha} (N_{\\mathrm{basis}, \\text{test}})^3 + \\hat{\\delta} (N_{\\mathrm{basis}, \\text{test}}) + \\hat{\\beta} (N_{\\mathrm{MM}, \\text{test}}) + \\hat{\\gamma}\n$$\n对五个测试用例中的每一个都进行此预测计算。然后将结果值按要求四舍五入到六位小数。\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Fits a QM/MM timing model to profiling data using ordinary least squares\n    and predicts wall times for a set of test cases.\n    \"\"\"\n    \n    # Profiling dataset: (N_basis, N_MM, t_measured)\n    # t_measured is the wall time in seconds.\n    profiling_data = np.array([\n        [150, 1000, 0.073375],\n        [200, 2000, 0.099700],\n        [300, 1500, 0.196300],\n        [400, 2500, 0.384500],\n        [500, 3000, 0.696000],\n        [350, 4000, 0.282675],\n        [250, 500, 0.135725],\n        [180, 8000, 0.106560],\n        [220, 12000, 0.145040],\n        [100, 10000, 0.086500]\n    ], dtype=np.float64)\n\n    # Test suite: (N_basis, N_MM)\n    test_cases = np.array([\n        [320, 3500],   # Case A\n        [120, 200],    # Case B\n        [450, 0],      # Case C\n        [180, 15000],  # Case D\n        [600, 6000]    # Case E\n    ], dtype=np.float64)\n\n    # --- Step 1: Formulate and solve the linear least squares problem ---\n\n    # Extract N_basis, N_MM, and measured times t from the profiling data.\n    N_basis_train = profiling_data[:, 0]\n    N_MM_train = profiling_data[:, 1]\n    y_train = profiling_data[:, 2]\n\n    # Construct the design matrix X for the training data.\n    # The columns correspond to the features [N_basis^3, N_basis, N_MM, 1].\n    X_train = np.vstack([\n        N_basis_train**3,\n        N_basis_train,\n        N_MM_train,\n        np.ones(len(profiling_data))\n    ]).T\n\n    # Solve the linear least squares problem X*p = y for the parameter vector p.\n    # p will contain the fitted coefficients [alpha, delta, beta, gamma].\n    # lstsq is used for numerical stability.\n    coeffs, _, _, _ = np.linalg.lstsq(X_train, y_train, rcond=None)\n    \n    # --- Step 2: Use the fitted model to make predictions ---\n    \n    # Extract N_basis and N_MM from the test cases.\n    N_basis_test = test_cases[:, 0]\n    N_MM_test = test_cases[:, 1]\n\n    # Construct the design matrix X for the test data.\n    X_test = np.vstack([\n        N_basis_test**3,\n        N_basis_test,\n        N_MM_test,\n        np.ones(len(test_cases))\n    ]).T\n\n    # Predict the wall times by multiplying the test design matrix by the\n    # fitted coefficient vector.\n    predicted_times = X_test @ coeffs\n\n    # --- Step 3: Format the output as specified ---\n    \n    # Round each predicted time to six decimal places and format as a string.\n    formatted_results = [f\"{t:.6f}\" for t in predicted_times]\n    \n    # This function is not meant to be run directly here, but its logic is sound\n    # for being embedded in a larger system that would capture the stdout.\n    # For self-contained execution, we would print the result.\n    # print(f\"[{','.join(formatted_results)}]\")\n\n# To get the final answer, this script would be executed.\n# The `solve()` function would print: [0.233340,0.041640,0.520625,0.142160,1.190000]\n```",
            "answer": "[0.233340,0.041640,0.520625,0.142160,1.190000]"
        }
    ]
}