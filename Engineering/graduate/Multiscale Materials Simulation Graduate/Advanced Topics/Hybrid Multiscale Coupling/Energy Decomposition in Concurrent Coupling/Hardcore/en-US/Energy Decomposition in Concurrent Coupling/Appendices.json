{
    "hands_on_practices": [
        {
            "introduction": "A robust concurrent coupling scheme requires that the continuum model faithfully represents the underlying atomistics in the appropriate limit. This exercise provides foundational practice in deriving a continuum stored-energy function, $W(\\mathbf{F})$, directly from a specific interatomic potential using the Cauchy–Born rule . Mastering this derivation is essential for understanding the physical basis of the coarse-grained models used in any energy-based multiscale simulation.",
            "id": "3806294",
            "problem": "Consider a face-centered cubic (FCC) Lennard–Jones (LJ) crystal occupying the coarse-grained continuum region $\\Omega_o$ in a concurrent atomistic–continuum coupling scheme. The crystal has conventional cubic lattice parameter $a$ and contains $4$ atoms per conventional unit cell of volume $a^3$. The pair potential is the standard Lennard–Jones form $\\varphi(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$, where $\\varepsilon$ and $\\sigma$ are material parameters. The crystal is subjected to a spatially homogeneous isotropic dilation characterized by the deformation gradient $\\mathbf{F} = \\lambda \\mathbf{I}$, where $\\lambda > 0$ and $\\mathbf{I}$ is the identity tensor.\n\nIn concurrent coupling, the total energy is decomposed into atomistic and continuum contributions, and the coarse-grained continuum contribution in $\\Omega_o$ is represented by an energy density $W(\\mathbf{F})$. Under homogeneous deformations, the Cauchy–Born rule connects the macroscopic deformation to the microscopic bond stretches, allowing construction of $W(\\mathbf{F})$ from the underlying atomistic interactions. To maintain scientific realism, restrict the LJ interactions to the first two neighbor shells of the FCC lattice. These shells have the following coordination numbers and reference distances in terms of $a$:\n- First shell: $z_1 = 12$ neighbors at distance $r_1 = a / \\sqrt{2}$.\n- Second shell: $z_2 = 6$ neighbors at distance $r_2 = a$.\n\nAssume periodic boundary conditions (PBC) and no surface effects. Use only the facts above, the definition of total pairwise energy, and the Cauchy–Born rule for homogeneous deformations as your starting point. Derive the coarse-grained energy density $W(\\mathbf{F})$ in $\\Omega_o$ under $\\mathbf{F} = \\lambda \\mathbf{I}$, truncated to the first two FCC neighbor shells. Define the dimensionless energy density $\\tilde{W}(\\lambda) := \\frac{a^3}{\\varepsilon} W(\\mathbf{F})$ and express it as a closed-form analytic function of $\\lambda$, $a$, and $\\sigma$.\n\nThen, compute the direct atomistic energy per unit volume for the same uniformly dilated state by counting pair contributions per atom with PBC in a representative unit cell, and compare it to the coarse-grained $W(\\mathbf{F})$ to validate the approximation in $\\Omega_o$.\n\nAnswer specification:\n- Report the final answer as the single closed-form analytic expression for the dimensionless energy density $\\tilde{W}(\\lambda)$ in terms of $\\lambda$, $a$, and $\\sigma$. Do not round or approximate.\n- No physical units are required in the final answer because $\\tilde{W}(\\lambda)$ is dimensionless by construction.",
            "solution": "The problem asks for the derivation of the coarse-grained energy density, $W(\\mathbf{F})$, for a face-centered cubic (FCC) crystal subjected to a homogeneous isotropic dilation, $\\mathbf{F} = \\lambda \\mathbf{I}$. This energy density is a key quantity in concurrent atomistic-continuum coupling schemes. The derivation is based on the Cauchy–Born rule, which postulates that for a homogeneous deformation, the crystal lattice deforms in the same way as the continuum. The energy density is then the potential energy of the deformed lattice per unit of reference volume. For a periodic system with pairwise interactions, this can be expressed in terms of the energy per atom.\n\nThe total potential energy per atom, $E_{atom}$, in a crystal with pairwise interactions described by a potential $\\varphi(r)$ is given by half the sum of the potential energies of interaction between a reference atom and all its neighbors.\n$$\nE_{atom} = \\frac{1}{2} \\sum_{j} \\varphi(r_j)\n$$\nwhere $r_j$ is the distance to the $j$-th neighbor atom. The problem restricts interactions to the first two neighbor shells. The coordination numbers and reference distances for an FCC lattice with lattice parameter $a$ are given as:\n- First shell: $z_1 = 12$ neighbors at distance $R_1 = \\frac{a}{\\sqrt{2}}$.\n- Second shell: $z_2 = 6$ neighbors at distance $R_2 = a$.\n\nThe energy per atom in the deformed configuration, $E_{atom}(\\mathbf{F})$, is:\n$$\nE_{atom}(\\mathbf{F}) = \\frac{1}{2} \\left[ z_1 \\varphi(r'_1) + z_2 \\varphi(r'_2) \\right]\n$$\nwhere $r'_1$ and $r'_2$ are the neighbor distances in the deformed state.\n\nAccording to the Cauchy–Born rule, a material vector $\\mathbf{R}$ in the reference configuration is mapped to $\\mathbf{r} = \\mathbf{F}\\mathbf{R}$ in the deformed configuration. For the specified isotropic dilation, $\\mathbf{F} = \\lambda \\mathbf{I}$, where $\\mathbf{I}$ is the identity tensor. Thus, a bond vector $\\mathbf{R}$ becomes $\\mathbf{r} = \\lambda \\mathbf{R}$, and its length becomes $r = |\\mathbf{r}| = |\\lambda \\mathbf{R}| = \\lambda R$. All interatomic distances are scaled by the factor $\\lambda$.\n\nThe deformed neighbor distances are therefore:\n$$\nr'_1 = \\lambda R_1 = \\frac{\\lambda a}{\\sqrt{2}}\n$$\n$$\nr'_2 = \\lambda R_2 = \\lambda a\n$$\n\nThe Lennard–Jones (LJ) pair potential is given by:\n$$\n\\varphi(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]\n$$\nwhere $\\varepsilon$ and $\\sigma$ are constants.\n\nWe can now express the energy per atom in the deformed state, $E_{atom}(\\lambda)$, by substituting the deformed distances and coordination numbers:\n$$\nE_{atom}(\\lambda) = \\frac{1}{2} \\left[ 12 \\cdot 4 \\varepsilon \\left( \\left( \\frac{\\sigma}{r'_1} \\right)^{12} - \\left( \\frac{\\sigma}{r'_1} \\right)^{6} \\right) + 6 \\cdot 4 \\varepsilon \\left( \\left( \\frac{\\sigma}{r'_2} \\right)^{12} - \\left( \\frac{\\sigma}{r'_2} \\right)^{6} \\right) \\right]\n$$\nSubstituting the expressions for $r'_1$ and $r'_2$:\n$$\nE_{atom}(\\lambda) = 24 \\varepsilon \\left[ \\left( \\frac{\\sigma}{\\lambda a / \\sqrt{2}} \\right)^{12} - \\left( \\frac{\\sigma}{\\lambda a / \\sqrt{2}} \\right)^{6} \\right] + 12 \\varepsilon \\left[ \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right]\n$$\nWe can simplify the terms involving $\\sqrt{2}$:\n$$\n(\\sqrt{2})^{12} = (2^{1/2})^{12} = 2^6 = 64\n$$\n$$\n(\\sqrt{2})^6 = (2^{1/2})^6 = 2^3 = 8\n$$\nThus, the energy per atom becomes:\n$$\nE_{atom}(\\lambda) = 24 \\varepsilon \\left[ 64 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - 8 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right] + 12 \\varepsilon \\left[ \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right]\n$$\nGrouping terms with the same power of $(\\sigma / \\lambda a)$:\n$$\nE_{atom}(\\lambda) = \\varepsilon \\left[ (24 \\cdot 64 + 12) \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - (24 \\cdot 8 + 12) \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right]\n$$\nCalculating the coefficients:\n$$\n24 \\cdot 64 + 12 = 1536 + 12 = 1548\n$$\n$$\n24 \\cdot 8 + 12 = 192 + 12 = 204\n$$\nSo, the energy per atom is:\n$$\nE_{atom}(\\lambda) = \\varepsilon \\left[ 1548 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - 204 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right]\n$$\nThe energy density $W(\\mathbf{F}) = W(\\lambda)$ is the energy per unit of *reference* volume. The conventional FCC unit cell has a volume of $a^3$ and contains $4$ atoms. Therefore, the reference volume per atom is $\\Omega_{atom} = a^3/4$.\n$$\nW(\\lambda) = \\frac{E_{atom}(\\lambda)}{\\Omega_{atom}} = \\frac{E_{atom}(\\lambda)}{a^3 / 4} = \\frac{4 E_{atom}(\\lambda)}{a^3}\n$$\nSubstituting the expression for $E_{atom}(\\lambda)$:\n$$\nW(\\lambda) = \\frac{4 \\varepsilon}{a^3} \\left[ 1548 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - 204 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right]\n$$\nThe problem asks for the dimensionless energy density $\\tilde{W}(\\lambda)$, defined as $\\tilde{W}(\\lambda) := \\frac{a^3}{\\varepsilon} W(\\lambda)$.\n$$\n\\tilde{W}(\\lambda) = \\frac{a^3}{\\varepsilon} \\left( \\frac{4 \\varepsilon}{a^3} \\left[ 1548 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - 204 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right] \\right)\n$$\n$$\n\\tilde{W}(\\lambda) = 4 \\left[ 1548 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - 204 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right]\n$$\nMultiplying by $4$:\n$$\n4 \\cdot 1548 = 6192\n$$\n$$\n4 \\cdot 204 = 816\n$$\nThis gives the final closed-form analytic expression for the dimensionless energy density:\n$$\n\\tilde{W}(\\lambda) = 6192 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - 816 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6}\n$$\nThe problem also asks to compare this result with a direct atomistic energy calculation. The procedure followed above *is* the direct atomistic calculation for a homogeneously deformed periodic crystal. For a homogeneous deformation, the Cauchy–Born rule is not an approximation but an exact statement. It provides the framework to define the continuum energy density from the underlying atomic interactions. Therefore, the derived $W(\\mathbf{F})$ is identical to the direct atomistic energy per unit reference volume, validating the consistency of the approach for this specific loading case. The \"approximation\" in continuum modeling arises when such an energy density function, derived under homogeneous assumptions, is used to model the energy of a region with *non-homogeneous* deformation.",
            "answer": "$$\n\\boxed{6192 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - 816 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6}}\n$$"
        },
        {
            "introduction": "Once atomistic and continuum models are defined, the next step is to combine them. This practice problem delves into the mechanics of the energy decomposition itself, where atomistic and continuum energy densities are blended within an overlap region . By analytically calculating the total energy of a simple one-dimensional coupled system, you will directly investigate how the blending scheme affects the system's energy and discover the critical consistency condition required for a seamless, artifact-free coupling.",
            "id": "3806283",
            "problem": "Consider a concurrent energy-based coupling between an atomistic one-dimensional chain and a continuum rod. The atomistic subsystem consists of $N$ atoms arranged along a line with reference lattice spacing $a_0$, connected by identical nearest-neighbor harmonic springs of stiffness $k$. Under a prescribed uniform axial strain $\\varepsilon$, neglect end effects so that the total reference length is $L_{\\text{tot}} = N a_0$ and the per-bond extension is $a_0 \\varepsilon$. The continuum subsystem is a linearly elastic rod characterized by an effective axial modulus per unit length $M_c$ (for a continuum with Young's modulus $Y_c$ and cross-sectional area $A$, one may identify $M_c = Y_c A$), so that its strain energy density per unit length is $\\frac{1}{2} M_c \\varepsilon^2$.\n\nThe two models are concurrently coupled over a finite overlap region of length $L_o$, flanked by a purely atomistic region of length $L_a$ and a purely continuum region of length $L_c$, with $L_{\\text{tot}} = L_a + L_o + L_c$. In the overlap, the total energy density per unit length is constructed by a convex blending of the two model energies with linear partition-of-unity weights\n$$\nw_a(x) = \\frac{x}{L_o}, \\quad w_c(x) = 1 - \\frac{x}{L_o}, \\quad x \\in [0, L_o],\n$$\nwhere $x$ is the local coordinate measured from the left edge of the overlap. Outside the overlap, only the respective model contributes.\n\nStarting only from the definitions of harmonic spring energy and linear elastic strain energy, and the above-described energy decomposition with $w_a(x)$ and $w_c(x)$, derive the closed-form expression of the total coupled energy $E_{\\text{tot}}$ under the uniform strain $\\varepsilon$ as a function of $L_o$, $N$, $a_0$, $L_a$, $k$, $M_c$, and $\\varepsilon$. Then, within your derivation, determine how $E_{\\text{tot}}$ depends on $L_o$ and identify the condition under which $E_{\\text{tot}}$ is independent of $L_o$.\n\nExpress the final energy in Joules. Provide your final answer as a single closed-form analytic expression for $E_{\\text{tot}}(L_o)$ in terms of the given parameters. No numerical evaluation is required.",
            "solution": "The total energy of the system, $E_{\\text{tot}}$, is the sum of the energies from the purely atomistic region ($E_a$), the overlap region ($E_o$), and the purely continuum region ($E_c$). First, we define the energy densities per unit length for the atomistic model ($e_a$) and the continuum model ($e_c$).\n\nThe energy of a single harmonic bond is $U_{\\text{bond}} = \\frac{1}{2} k (\\text{extension})^2 = \\frac{1}{2} k (a_0 \\varepsilon)^2$. Since there is one bond per length $a_0$, the atomistic energy density is:\n$$\ne_a = \\frac{U_{\\text{bond}}}{a_0} = \\frac{1}{a_0} \\left( \\frac{1}{2} k (a_0 \\varepsilon)^2 \\right) = \\frac{1}{2} k a_0 \\varepsilon^2\n$$\nThe continuum energy density is given as $e_c = \\frac{1}{2} M_c \\varepsilon^2$.\n\nThe energies of the pure regions are found by multiplying the respective density by the region's length:\n- Purely atomistic region energy: $E_a = e_a L_a$\n- Purely continuum region energy: $E_c = e_c L_c = e_c (L_{\\text{tot}} - L_a - L_o) = e_c (N a_0 - L_a - L_o)$\n\nIn the overlap region of length $L_o$, the energy density is blended: $e_o(x) = w_a(x) e_a + w_c(x) e_c$. The total energy of the overlap region is the integral of $e_o(x)$ from $x=0$ to $x=L_o$:\n$$\nE_o = \\int_0^{L_o} \\left[ \\left(\\frac{x}{L_o}\\right) e_a + \\left(1 - \\frac{x}{L_o}\\right) e_c \\right] dx\n$$\nDue to the linear blending weights, the integral evaluates to the average of the two densities multiplied by the length:\n$$\nE_o = \\frac{L_o}{2} (e_a + e_c)\n$$\nThe total energy is the sum $E_{\\text{tot}} = E_a + E_o + E_c$:\n$$\nE_{\\text{tot}} = e_a L_a + \\frac{L_o}{2} (e_a + e_c) + e_c (N a_0 - L_a - L_o)\n$$\nTo find the dependence on $L_o$, we collect the terms involving $L_o$:\n$$\nE_{\\text{tot}} = e_a L_a - e_c L_a + e_c N a_0 + \\left(\\frac{1}{2}e_a + \\frac{1}{2}e_c - e_c\\right) L_o\n$$\n$$\nE_{\\text{tot}} = (e_a - e_c)L_a + e_c N a_0 + \\frac{1}{2}(e_a - e_c) L_o\n$$\nThe total energy $E_{\\text{tot}}$ is independent of the overlap length $L_o$ if and only if the coefficient of $L_o$ is zero, which requires $e_a = e_c$. This is the consistency condition between the atomistic and continuum models. Substituting the density expressions, this means $\\frac{1}{2} k a_0 \\varepsilon^2 = \\frac{1}{2} M_c \\varepsilon^2$, which simplifies to $k a_0 = M_c$ for any non-zero strain $\\varepsilon$.\n\nSubstituting the explicit forms for $e_a$ and $e_c$ into the total energy equation gives the final expression:\n$$\nE_{\\text{tot}}(L_o) = \\frac{\\varepsilon^2}{2} \\left[ (k a_0 - M_c) L_a + M_c N a_0 + \\frac{1}{2} (k a_0 - M_c) L_o \\right]\n$$\nThis can be rearranged into the final compact form:\n$$\nE_{\\text{tot}}(L_o) = \\frac{\\varepsilon^2}{2} \\left[ M_c N a_0 + (k a_0 - M_c) \\left(L_a + \\frac{L_o}{2}\\right) \\right]\n$$",
            "answer": "$$\n\\boxed{\\frac{\\varepsilon^2}{2} \\left[ M_c N a_0 + (k a_0 - M_c) \\left(L_a + \\frac{L_o}{2}\\right) \\right]}\n$$"
        },
        {
            "introduction": "Moving from pure theory to numerical implementation, even perfectly consistent models can exhibit unphysical behavior if the energy decomposition is not handled carefully. This coding exercise makes the abstract concept of \"ghost forces\" tangible by demonstrating how they arise from asymmetries in the numerical quadrature used at the atomistic-continuum interface . You will quantify these spurious forces and implement a correction to ensure the coupled model passes a fundamental validation benchmark known as the patch test.",
            "id": "3806348",
            "problem": "Consider a one-dimensional crystalline chain with atoms indexed by the integer $i$, lattice spacing $a$, and positions $x_i$. The chain has homogeneous nearest-neighbor and next-nearest-neighbor pair interactions with harmonic energies. The total atomistic energy for a chain segment is defined by\n$$\nE_{\\text{atom}} = \\sum_{i} \\frac{1}{2} k_1 \\left( x_{i+1} - x_i - a \\right)^2 + \\sum_{i} \\frac{1}{2} k_2 \\left( x_{i+2} - x_i - 2a \\right)^2,\n$$\nwhere $k_1$ and $k_2$ are the stiffnesses for nearest-neighbor and next-nearest-neighbor interactions, respectively. In static equilibrium, the net internal force on atom $i$ is $f_i = -\\partial E / \\partial x_i$. Under a uniform strain field with deformation $x_i = i a (1 + \\epsilon)$, a fully atomistic model produces zero net internal force at every atom due to symmetry and cancellation of pair forces.\n\nIn a concurrent coupling setting, the domain is partitioned into an atomistic subregion (left) and a continuum subregion (right). The continuum subregion is discretized coarsely (representative atoms spaced $r a$) and its contribution to the energy is approximated by quadrature. Near the interface atom (denote it by $i = 0$), interactions that extend into the continuum subregion are assigned quadrature weights. Let $w_1^{\\text{right}}$ and $w_2^{\\text{right}}$ denote the effective quadrature weights applied to the continuum-side contributions at atom $i = 0$ for nearest-neighbor and next-nearest-neighbor bonds, respectively. The atomistic-side weights are $w_1^{\\text{left}} = 1$ and $w_2^{\\text{left}} = 1$ (exact summation). Assume uniform strain $x_i = i a (1 + \\epsilon)$ holds across the interface.\n\nFor this setting, define the ghost force at the interface as the residual net internal force at $i = 0$ produced by asymmetric quadrature weighting under the uniform strain field. Using energy-based definitions and Newtonian force as the negative energy gradient, one can show that under uniform strain the ghost force magnitude at the interface is\n$$\nF_{\\text{ghost}} = \\left| \\left(w_1^{\\text{left}} - w_1^{\\text{right}} \\right) k_1 a \\epsilon + \\left(w_2^{\\text{left}} - w_2^{\\text{right}} \\right) k_2 \\cdot 2 a \\epsilon \\right|.\n$$\nThis model assumes linear elasticity, harmonic pair potentials, and symmetric left-side exact summation.\n\nInfluence of quadrature: Different element quadrature rules determine $w_1^{\\text{right}}$ and $w_2^{\\text{right}}$ as follows (plausible mapping for interface treatment under a uniform field):\n- Midpoint rule: $w_1^{\\text{right}} = \\frac{1}{2}$, $w_2^{\\text{right}} = \\frac{1}{2}$.\n- Trapezoid rule: $w_1^{\\text{right}} = 1$, $w_2^{\\text{right}} = 1$.\n- One-point Gaussian rule: $w_1^{\\text{right}} = \\frac{1}{2}$, $w_2^{\\text{right}} = \\frac{1}{2}$.\n- Node-lumped to the atomistic interface node (extreme lumping to the left): $w_1^{\\text{right}} = 0$, $w_2^{\\text{right}} = 0$.\n- Fully atomistic (no coarsening, $r = 1$): $w_1^{\\text{right}} = 1$, $w_2^{\\text{right}} = 1$.\n\nPatch test corrections: A correction that restores patch test performance requires symmetry of contributions at the interface, i.e., set $w_n^{\\text{right}} = w_n^{\\text{left}}$ for $n \\in \\{1,2\\}$. Equivalently, choose quadrature or apply a bond-based correction so that $w_1^{\\text{right}} = 1$ and $w_2^{\\text{right}} = 1$. With these corrected weights, the ghost force vanishes under uniform strain.\n\nTask: Implement a program that, for a set of test cases, computes the ghost force magnitude $F_{\\text{ghost}}$ before correction (based on the specified quadrature rule) and after applying a patch test restoration correction that sets $w_1^{\\text{right}} = 1$ and $w_2^{\\text{right}} = 1$.\n\nAll quantities are to be treated in nondimensional units consistent with the choice $a = 1$ and harmonic stiffnesses $k_1$, $k_2$; you must express forces in nondimensional units.\n\nTest suite:\n- Test $1$: $k_1 = 1.0$, $k_2 = 0.4$, $a = 1.0$, $\\epsilon = 0.01$, quadrature rule = midpoint, $r = 4$.\n- Test $2$: $k_1 = 1.0$, $k_2 = 0.4$, $a = 1.0$, $\\epsilon = 0.01$, quadrature rule = trapezoid, $r = 4$.\n- Test $3$: $k_1 = 1.0$, $k_2 = 0.4$, $a = 1.0$, $\\epsilon = 0.01$, quadrature rule = node\\_lumped, $r = 8$.\n- Test $4$: $k_1 = 1.0$, $k_2 = 0.4$, $a = 1.0$, $\\epsilon = 0.01$, quadrature rule = atomistic, $r = 1$.\n- Test $5$ (edge case): $k_1 = 1.0$, $k_2 = 0.4$, $a = 1.0$, $\\epsilon = 0.0$, quadrature rule = midpoint, $r = 4$.\n\nAlgorithmic specification:\n- For each test, map the quadrature rule to $(w_1^{\\text{right}}, w_2^{\\text{right}})$ as above.\n- Compute the pre-correction ghost force magnitude using the formula for $F_{\\text{ghost}}$.\n- Compute the post-correction ghost force magnitude by setting $(w_1^{\\text{right}}, w_2^{\\text{right}}) = (1, 1)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a JSON-like nested list with two sublists: the first sublist contains the pre-correction ghost force magnitudes for tests $1$ through $5$, and the second sublist contains the post-correction magnitudes for the same tests. Each float must be rounded to $6$ decimal places. For example, the output must look like\n$$\n\\left[ [f_1, f_2, f_3, f_4, f_5], [g_1, g_2, g_3, g_4, g_5] \\right]\n$$\nwith $f_i$ and $g_i$ printed as decimal floats rounded to $6$ decimals.",
            "solution": "The central task is to compute the magnitude of the ghost force at the interface of a coupled atomistic-continuum domain for a one-dimensional harmonic crystal chain under uniform strain. This force arises from an asymmetry in the energy summation (quadrature) across the interface. We will calculate this force for a set of test cases, both before and after a patch test correction is applied.\n\nThe governing equation for the magnitude of the ghost force, $F_{\\text{ghost}}$, at the interface atom ($i=0$) is given as:\n$$\nF_{\\text{ghost}} = \\left| \\left(w_1^{\\text{left}} - w_1^{\\text{right}} \\right) k_1 a \\epsilon + \\left(w_2^{\\text{left}} - w_2^{\\text{right}} \\right) k_2 \\cdot 2 a \\epsilon \\right|\n$$\nwhere:\n- $k_1$ and $k_2$ are the nearest-neighbor and next-nearest-neighbor bond stiffnesses.\n- $a$ is the lattice spacing ($a=1$).\n- $\\epsilon$ is the uniform applied strain.\n- $w_1^{\\text{left}}=1$ and $w_2^{\\text{left}}=1$ are the fixed weights for the atomistic side.\n- $w_1^{\\text{right}}$ and $w_2^{\\text{right}}$ are the quadrature weights for the continuum side, which vary by rule.\n\nSubstituting the known values, the formula simplifies to:\n$$\nF_{\\text{ghost}} = |a \\epsilon| \\cdot \\left| \\left(1 - w_1^{\\text{right}} \\right) k_1 + 2\\left(1 - w_2^{\\text{right}} \\right) k_2 \\right|\n$$\n\n**Part 1: Pre-Correction Ghost Force Calculation**\n\nWe apply the formula using the parameters for each test. For tests 1-4, $k_1 = 1.0$, $k_2 = 0.4$, $a = 1.0$, and $\\epsilon = 0.01$.\n\n- **Test 1** (midpoint rule): $w_1^{\\text{right}} = 0.5$, $w_2^{\\text{right}} = 0.5$.\n  $F_{\\text{ghost}} = 0.01 \\cdot |(1 - 0.5) \\cdot 1.0 + 2(1 - 0.5) \\cdot 0.4| = 0.01 \\cdot |0.5 + 0.4| = 0.009$.\n\n- **Test 2** (trapezoid rule): $w_1^{\\text{right}} = 1$, $w_2^{\\text{right}} = 1$.\n  $F_{\\text{ghost}} = 0.01 \\cdot |(1 - 1) \\cdot 1.0 + 2(1 - 1) \\cdot 0.4| = 0$.\n\n- **Test 3** (node_lumped rule): $w_1^{\\text{right}} = 0$, $w_2^{\\text{right}} = 0$.\n  $F_{\\text{ghost}} = 0.01 \\cdot |(1 - 0) \\cdot 1.0 + 2(1 - 0) \\cdot 0.4| = 0.01 \\cdot |1.0 + 0.8| = 0.018$.\n\n- **Test 4** (atomistic rule): $w_1^{\\text{right}} = 1$, $w_2^{\\text{right}} = 1$.\n  This is identical to the trapezoid rule, so $F_{\\text{ghost}} = 0$.\n\n- **Test 5** ($\\epsilon = 0.0$):\n  Since the force is proportional to $\\epsilon$, the ghost force is zero regardless of the quadrature rule. $F_{\\text{ghost}} = 0$.\n\nThe pre-correction ghost force magnitudes are: $0.009$, $0.0$, $0.018$, $0.0$, and $0.0$.\n\n**Part 2: Post-Correction Ghost Force Calculation**\n\nThe patch test correction enforces symmetry by setting the right-side weights equal to the left-side weights: $w_1^{\\text{right}} = 1$ and $w_2^{\\text{right}} = 1$. Applying these corrected weights to the formula:\n$$\nF_{\\text{ghost, corr}} = |a \\epsilon| \\cdot \\left| \\left(1 - 1 \\right) k_1 + 2\\left(1 - 1 \\right) k_2 \\right| = 0\n$$\nThus, for all test cases, the post-correction ghost force is exactly $0$. This demonstrates that the correction successfully eliminates the spurious force under uniform deformation, passing the patch test.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ghost force magnitude for a 1D atomistic-continuum coupled chain\n    before and after a patch test correction.\n    \"\"\"\n\n    # Define the mapping from quadrature rule names to right-side weights (w1_right, w2_right).\n    # The problem statement mentions one-point Gaussian, which is included here for completeness,\n    # though not used in the test suite.\n    quad_rules = {\n        \"midpoint\": (0.5, 0.5),\n        \"trapezoid\": (1.0, 1.0),\n        \"one_point_gaussian\": (0.5, 0.5),\n        \"node_lumped\": (0.0, 0.0),\n        \"atomistic\": (1.0, 1.0),\n    }\n\n    # Define the test suite as a list of dictionaries for clarity.\n    # The variable 'r' (coarsening ratio) is provided for context but not used in the given formula.\n    test_cases = [\n        {\"k1\": 1.0, \"k2\": 0.4, \"a\": 1.0, \"epsilon\": 0.01, \"quadrature_rule\": \"midpoint\", \"r\": 4},\n        {\"k1\": 1.0, \"k2\": 0.4, \"a\": 1.0, \"epsilon\": 0.01, \"quadrature_rule\": \"trapezoid\", \"r\": 4},\n        {\"k1\": 1.0, \"k2\": 0.4, \"a\": 1.0, \"epsilon\": 0.01, \"quadrature_rule\": \"node_lumped\", \"r\": 8},\n        {\"k1\": 1.0, \"k2\": 0.4, \"a\": 1.0, \"epsilon\": 0.01, \"quadrature_rule\": \"atomistic\", \"r\": 1},\n        {\"k1\": 1.0, \"k2\": 0.4, \"a\": 1.0, \"epsilon\": 0.0, \"quadrature_rule\": \"midpoint\", \"r\": 4},\n    ]\n\n    # Atomistic-side weights are fixed.\n    w1_left = 1.0\n    w2_left = 1.0\n    \n    # Post-correction weights are fixed, by definition of the patch test restoration.\n    w1_right_corrected = 1.0\n    w2_right_corrected = 1.0\n\n    pre_correction_forces = []\n    post_correction_forces = []\n\n    def calculate_ghost_force(k1, k2, a, epsilon, w1_l, w2_l, w1_r, w2_r):\n        \"\"\"\n        Calculates ghost force magnitude based on the provided formula.\n        F_ghost = | (w1_left - w1_right) * k1*a*eps + (w2_left - w2_right) * k2*2*a*eps |\n        \"\"\"\n        term1 = (w1_l - w1_r) * k1 * a * epsilon\n        term2 = (w2_l - w2_r) * k2 * 2 * a * epsilon\n        return abs(term1 + term2)\n\n    for case in test_cases:\n        k1 = case[\"k1\"]\n        k2 = case[\"k2\"]\n        a = case[\"a\"]\n        epsilon = case[\"epsilon\"]\n        rule = case[\"quadrature_rule\"]\n\n        # 1. Pre-correction calculation\n        w1_right, w2_right = quad_rules[rule]\n        f_ghost_pre = calculate_ghost_force(k1, k2, a, epsilon, w1_left, w2_left, w1_right, w2_right)\n        pre_correction_forces.append(f_ghost_pre)\n\n        # 2. Post-correction calculation\n        f_ghost_post = calculate_ghost_force(k1, k2, a, epsilon, w1_left, w2_left, w1_right_corrected, w2_right_corrected)\n        post_correction_forces.append(f_ghost_post)\n    \n    # Format the results to 6 decimal places as required.\n    pre_formatted = [f\"{f:.6f}\" for f in pre_correction_forces]\n    post_formatted = [f\"{g:.6f}\" for g in post_correction_forces]\n\n    # Construct the final output string in the exact specified format.\n    output_string = f\"[[{','.join(pre_formatted)}],[{','.join(post_formatted)}]]\"\n    \n    print(output_string)\n\nsolve()\n```"
        }
    ]
}