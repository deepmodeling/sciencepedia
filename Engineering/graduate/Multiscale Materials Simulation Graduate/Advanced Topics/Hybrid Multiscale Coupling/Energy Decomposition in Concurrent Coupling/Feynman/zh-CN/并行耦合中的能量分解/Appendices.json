{
    "hands_on_practices": [
        {
            "introduction": "理论的基石在于实践。本章的首个练习将引导您在一个简洁的一维原子链-连续介质耦合系统中，亲手推导总能量的表达式。通过这个过程，您不仅能深入理解能量是如何在重叠区域进行分解与混合的，还将发现消除界面人为效应、确保能量一致性的关键条件。",
            "id": "3806283",
            "problem": "考虑一个原子尺度一维链和一个连续介质杆之间的并行基于能量的耦合。该原子尺度子系统由$N$个原子沿一条直线排列组成，参考晶格间距为$a_0$，原子之间由刚度为$k$的相同的最近邻谐振子弹簧连接。在给定的均匀轴向应变$\\varepsilon$下，忽略端点效应，因此总参考长度为$L_{\\text{tot}} = N a_0$，每键伸长量为$a_0 \\varepsilon$。连续介质子系统是一根线性弹性杆，其特征是单位长度的有效轴向模量$M_c$（对于杨氏模量为$Y_c$、横截面积为$A$的连续介质，可以确定$M_c = Y_c A$），因此其单位长度的应变能密度为$\\frac{1}{2} M_c \\varepsilon^2$。\n\n这两个模型在一个长度为$L_o$的有限重叠区域内进行并行耦合，该区域两侧分别是长度为$L_a$的纯原子尺度区域和长度为$L_c$的纯连续介质区域，且$L_{\\text{tot}} = L_a + L_o + L_c$。在重叠区域中，单位长度的总能量密度是通过两种模型能量的凸混合构建的，使用线性的单位分解权函数\n$$\nw_a(x) = \\frac{x}{L_o}, \\quad w_c(x) = 1 - \\frac{x}{L_o}, \\quad x \\in [0, L_o],\n$$\n其中$x$是从重叠区域左边缘测量的局部坐标。在重叠区域之外，只有各自的模型贡献能量。\n\n仅从谐振子弹簧能量和线性弹性应变能的定义，以及上述使用$w_a(x)$和$w_c(x)$的能量分解，推导在均匀应变$\\varepsilon$下，总耦合能量$E_{\\text{tot}}$作为$L_o$、$N$、$a_0$、$L_a$、$k$、$M_c$和$\\varepsilon$的函数的闭式表达式。然后，在你的推导过程中，确定$E_{\\text{tot}}$如何依赖于$L_o$，并找出$E_{\\text{tot}}$不依赖于$L_o$的条件。\n\n最终能量以焦耳为单位表示。请以给定的参数，为$E_{\\text{tot}}(L_o)$提供一个单一的闭式解析表达式作为最终答案。不需要进行数值计算。",
            "solution": "用户希望我解决一个问题。\n\n### 第一步：提取已知条件\n- **系统**：一个并行耦合的一维原子链和连续介质杆。\n- **原子尺度子系统**：\n    - 原子数：$N$。\n    - 参考晶格间距：$a_0$。\n    - 连接性：最近邻谐振子弹簧。\n    - 弹簧刚度：$k$。\n- **连续介质子系统**：\n    - 线性弹性杆。\n    - 单位长度有效轴向模量：$M_c$。\n    - 单位长度应变能密度：$\\frac{1}{2} M_c \\varepsilon^2$。\n- **系统几何与加载**：\n    - 给定的均匀轴向应变：$\\varepsilon$。\n    - 总参考长度：$L_{\\text{tot}} = N a_0$。端点效应被忽略。\n    - 每键伸长量：$a_0 \\varepsilon$。\n    - 系统分为三个区域：长度为$L_a$的纯原子尺度区域，长度为$L_c$的纯连续介质区域，以及长度为$L_o$的重叠区域。\n    - 总长度关系：$L_{\\text{tot}} = L_a + L_o + L_c$。\n- **耦合方案**：\n    - 重叠区域内基于能量的混合。\n    - 混合权重（单位分解）：\n        - 原子尺度权重：$w_a(x) = \\frac{x}{L_o}$，对于$x \\in [0, L_o]$。\n        - 连续介质权重：$w_c(x) = 1 - \\frac{x}{L_o}$，对于$x \\in [0, L_o]$。\n    - 局部坐标$x$从重叠区域的左边缘开始测量。\n- **目标**：\n    1. 推导总耦合能量$E_{\\text{tot}}$作为$L_o$、$N$、$a_0$、$L_a$、$k$、$M_c$和$\\varepsilon$的函数的闭式表达式。\n    2. 在推导过程中，确定$E_{\\text{tot}}$对$L_o$的依赖关系。\n    3. 找出$E_{\\text{tot}}$不依赖于$L_o$的条件。\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于固体力学的基本原理：离散弹簧的胡克定律和连续介质的线性弹性。所描述的并行耦合方案是一种简化但标准化的模型，用于计算多尺度材料模拟（例如，在准连续介质方法中）。所有概念在科学上都是合理的。\n2.  **良态问题**：该问题提供了推导总能量唯一表达式所需的所有必要信息和定义。目标明确，可以从给定的条件中实现。\n3.  **客观性**：该问题以精确、客观的数学和物理术语陈述。它不包含任何主观或基于意见的论断。\n\n该问题不存在科学上不合理、信息缺失或模棱两可等缺陷。要求以焦耳表示能量的指令是关于单位的说明；它不会导致问题无效，因为最终表达式将是符号性的，并且在量纲上等同于能量。该问题为推导提供了一个自洽的逻辑框架。\n\n### 第三步：结论与行动\n问题有效。我将继续进行求解。\n\n### 推导\n耦合系统的总能量$E_{\\text{tot}}$是三个不同区域能量的总和：纯原子尺度区域($E_a$)、重叠区域($E_o$)和纯连续介质区域($E_c$)\n$$E_{\\text{tot}} = E_a + E_o + E_c$$\n\n首先，我们必须确定在均匀应变$\\varepsilon$下，原子尺度模型和连续介质模型的单位长度能量密度。\n\n**1. 原子尺度能量密度 ($e_a$)**\n一个刚度为$k$、伸长量为$\\Delta L$的谐振子弹簧所储存的能量由$U_{\\text{spring}} = \\frac{1}{2} k (\\Delta L)^2$给出。\n问题陈述，每键伸长量为$\\Delta L = a_0 \\varepsilon$。因此，每键的能量是：\n$$U_{\\text{bond}} = \\frac{1}{2} k (a_0 \\varepsilon)^2$$\n原子链中单位长度的键数为$1/a_0$。原子尺度应变能密度$e_a$，即单位参考长度的能量，是每键能量除以键长$a_0$：\n$$e_a = \\frac{U_{\\text{bond}}}{a_0} = \\frac{1}{a_0} \\left( \\frac{1}{2} k (a_0 \\varepsilon)^2 \\right) = \\frac{1}{2} k a_0 \\varepsilon^2$$\n\n**2. 连续介质能量密度 ($e_c$)**\n单位长度的连续介质应变能密度$e_c$在问题陈述中直接给出为：\n$$e_c = \\frac{1}{2} M_c \\varepsilon^2$$\n\n现在，我们可以通过在各区域的长度上对相应的能量密度进行积分，来计算每个区域的能量。\n\n**3. 纯原子尺度区域的能量 ($E_a$)**\n该区域长度为$L_a$，由原子尺度模型描述。其能量为：\n$$E_a = \\int_0^{L_a} e_a \\, dx = e_a \\int_0^{L_a} dx = e_a L_a = \\left( \\frac{1}{2} k a_0 \\varepsilon^2 \\right) L_a$$\n\n**4. 纯连续介质区域的能量 ($E_c$)**\n该区域长度为$L_c$。根据总长度分解，有$L_c = L_{\\text{tot}} - L_a - L_o$。该区域由连续介质模型描述。其能量为：\n$$E_c = \\int_0^{L_c} e_c \\, dx = e_c L_c = e_c (L_{\\text{tot}} - L_a - L_o) = \\left( \\frac{1}{2} M_c \\varepsilon^2 \\right) (N a_0 - L_a - L_o)$$\n这里我们代入了给定的关系$L_{\\text{tot}} = N a_0$。\n\n**5. 重叠区域的能量 ($E_o$)**\n该区域长度为$L_o$。此区域内的能量密度$e_o(x)$是原子尺度和连续介质能量密度的线性混合，使用权重$w_a(x)$和$w_c(x)$，其中$x$是$0$到$L_o$的局部坐标。\n$$e_o(x) = w_a(x) e_a + w_c(x) e_c = \\left(\\frac{x}{L_o}\\right) e_a + \\left(1 - \\frac{x}{L_o}\\right) e_c$$\n重叠区域的总能量是此密度在其长度上的积分：\n$$E_o = \\int_0^{L_o} e_o(x) \\, dx = \\int_0^{L_o} \\left[ \\left(\\frac{x}{L_o}\\right) e_a + \\left(1 - \\frac{x}{L_o}\\right) e_c \\right] dx$$\n我们可以将积分分开：\n$$E_o = \\frac{e_a}{L_o} \\int_0^{L_o} x \\, dx + e_c \\int_0^{L_o} \\left(1 - \\frac{x}{L_o}\\right) dx$$\n$$E_o = \\frac{e_a}{L_o} \\left[ \\frac{x^2}{2} \\right]_0^{L_o} + e_c \\left[ x - \\frac{x^2}{2L_o} \\right]_0^{L_o}$$\n$$E_o = \\frac{e_a}{L_o} \\left( \\frac{L_o^2}{2} \\right) + e_c \\left( L_o - \\frac{L_o^2}{2L_o} \\right) = \\frac{1}{2} e_a L_o + e_c \\left( L_o - \\frac{L_o}{2} \\right)$$\n$$E_o = \\frac{1}{2} e_a L_o + \\frac{1}{2} e_c L_o = \\frac{L_o}{2} (e_a + e_c)$$\n代入$e_a$和$e_c$的表达式：\n$$E_o = \\frac{L_o}{2} \\left( \\frac{1}{2} k a_0 \\varepsilon^2 + \\frac{1}{2} M_c \\varepsilon^2 \\right) = \\frac{L_o \\varepsilon^2}{4} (k a_0 + M_c)$$\n\n**6. 总能量及对$L_o$的依赖关系**\n现在我们将三个区域的能量相加，求得总能量$E_{\\text{tot}}$：\n$$E_{\\text{tot}} = E_a + E_o + E_c$$\n$$E_{\\text{tot}} = e_a L_a + \\frac{L_o}{2} (e_a + e_c) + e_c (L_{\\text{tot}} - L_a - L_o)$$\n我们展开并根据长度$L_a$、$L_o$和$L_{\\text{tot}}$合并项：\n$$E_{\\text{tot}} = e_a L_a + \\frac{1}{2}e_a L_o + \\frac{1}{2}e_c L_o + e_c L_{\\text{tot}} - e_c L_a - e_c L_o$$\n$$E_{\\text{tot}} = (e_a - e_c) L_a + e_c L_{\\text{tot}} + \\left(\\frac{1}{2}e_a - \\frac{1}{2}e_c\\right) L_o$$\n该表达式清楚地显示了$E_{\\text{tot}}$对$L_o$的依赖关系。总能量是重叠长度$L_o$的线性函数。决定这种依赖关系的项是$\\frac{L_o}{2}(e_a - e_c)$。\n\n**7. 不依赖于$L_o$的条件**\n总能量$E_{\\text{tot}}$不依赖于重叠长度$L_o$的充要条件是$L_o$项的系数为零。\n$$\\frac{1}{2}e_a - \\frac{1}{2}e_c = 0 \\implies e_a = e_c$$\n这是两个模型之间能量一致性的条件。代入能量密度的定义：\n$$\\frac{1}{2} k a_0 \\varepsilon^2 = \\frac{1}{2} M_c \\varepsilon^2$$\n假设应变非零，即$\\varepsilon \\neq 0$，我们可以消去两边的$\\frac{1}{2}\\varepsilon^2$项，得到关于模型参数的条件：\n$$k a_0 = M_c$$\n这个条件，对于本问题被称为柯西-玻恩一致性条件，确保了原子尺度模型在长波极限下的力学响应（和能量）与连续介质模型相匹配。当此条件成立时，界面位置和重叠长度的选择不影响系统在均匀应变下的总能量，这是多尺度方法的一个理想特性。\n\n**8. 总能量的最终表达式**\n为了得到$E_{\\text{tot}}$的最终表达式，我们将$e_a$和$e_c$的显式形式以及$L_{\\text{tot}} = N a_0$代入$E_{\\text{tot}}$的表达式中：\n$$E_{\\text{tot}}(L_o) = \\left(\\frac{1}{2}k a_0 \\varepsilon^2 - \\frac{1}{2}M_c \\varepsilon^2 \\right) L_a + \\left( \\frac{1}{2}M_c \\varepsilon^2 \\right) (N a_0) + \\frac{L_o}{2} \\left(\\frac{1}{2}k a_0 \\varepsilon^2 - \\frac{1}{2}M_c \\varepsilon^2 \\right)$$\n提取公因式：\n$$E_{\\text{tot}}(L_o) = \\frac{\\varepsilon^2}{2} (k a_0 - M_c) L_a + \\frac{\\varepsilon^2}{2} M_c N a_0 + \\frac{\\varepsilon^2}{4} (k a_0 - M_c) L_o$$\n$$E_{\\text{tot}}(L_o) = \\frac{\\varepsilon^2}{2} \\left[ (k a_0 - M_c) L_a + M_c N a_0 + \\frac{1}{2} (k a_0 - M_c) L_o \\right]$$\n一个更紧凑的形式是：\n$$E_{\\text{tot}}(L_o) = \\frac{\\varepsilon^2}{2} \\left[ M_c N a_0 + (k a_0 - M_c) \\left( L_a + \\frac{L_o}{2} \\right) \\right]$$\n这是总能量作为指定参数函数的最终闭式表达式。如果参数以国际单位制（SI units）给出（$k$的单位为$\\text{N/m}$，$a_0$、$L_a$、$L_o$的单位为$\\text{m}$，$M_c$的单位为$\\text{N}$），该表达式将得出以焦耳为单位的能量。",
            "answer": "$$\n\\boxed{\\frac{\\varepsilon^2}{2} \\left[ M_c N a_0 + (k a_0 - M_c) \\left(L_a + \\frac{L_o}{2}\\right) \\right]}\n$$"
        },
        {
            "introduction": "一个可靠的并发耦合方案，其核心在于所采用的连续介质模型能够忠实地反映底层的原子尺度物理。本练习将带您运用连接宏观与微观的关键桥梁——Cauchy-Born 法则，从一个具体的 Lennard-Jones 原子间势函数出发，直接推导出宏观连续介质的应变能密度函数。这项实践将使您对多尺度模型中能量参数的物理来源有更深刻的认识。",
            "id": "3806294",
            "problem": "考虑一个面心立方 (FCC) Lennard-Jones (LJ) 晶体，在一个原子-连续介质并发耦合方案中占据粗粒化连续介质区域 $\\Omega_o$。该晶体具有常规立方晶格参数 $a$，每个体积为 $a^3$ 的常规晶胞包含 $4$ 个原子。其对势为标准的 Lennard-Jones 形式 $\\varphi(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$，其中 $\\varepsilon$ 和 $\\sigma$ 是材料参数。该晶体承受一个空间均匀的各向同性膨胀，其特征在于变形梯度 $\\mathbf{F} = \\lambda \\mathbf{I}$，其中 $\\lambda > 0$ 且 $\\mathbf{I}$ 是单位张量。\n\n在并发耦合中，总能量被分解为原子贡献和连续介质贡献，而 $\\Omega_o$ 中的粗粒化连续介质贡献由能量密度 $W(\\mathbf{F})$ 表示。在均匀变形下，Cauchy-Born 法则将宏观变形与微观键的伸长联系起来，从而允许从底层的原子相互作用构建 $W(\\mathbf{F})$。为保持科学真实性，将 LJ 相互作用限制在 FCC 晶格的前两个近邻壳层。这些壳层具有以下用 $a$ 表示的配位数和参考距离：\n- 第一壳层：$z_1 = 12$ 个邻居，距离为 $r_1 = a / \\sqrt{2}$。\n- 第二壳层：$z_2 = 6$ 个邻居，距离为 $r_2 = a$。\n\n假设采用周期性边界条件 (PBC) 且无表面效应。仅使用上述事实、总对势能的定义以及均匀变形的 Cauchy-Born 法则作为你的出发点。在 $\\mathbf{F} = \\lambda \\mathbf{I}$ 的条件下，推导 $\\Omega_o$ 中的粗粒化能量密度 $W(\\mathbf{F})$，并截断至前两个 FCC 近邻壳层。定义无量纲能量密度 $\\tilde{W}(\\lambda) := \\frac{a^3}{\\varepsilon} W(\\mathbf{F})$，并将其表示为 $\\lambda$、$a$ 和 $\\sigma$ 的闭合形式解析函数。\n\n然后，通过在代表性晶胞中利用 PBC 计算每个原子的对贡献，来计算相同均匀膨胀状态下每单位体积的直接原子能量，并将其与粗粒化的 $W(\\mathbf{F})$ 进行比较，以验证在 $\\Omega_o$ 中的近似。\n\n答案规格：\n- 将最终答案报告为无量纲能量密度 $\\tilde{W}(\\lambda)$ 关于 $\\lambda$、$a$ 和 $\\sigma$ 的单一闭合形式解析表达式。不要进行四舍五入或近似计算。\n- 最终答案中无需物理单位，因为 $\\tilde{W}(\\lambda)$ 根据其构造是无量纲的。",
            "solution": "该问题要求推导面心立方 (FCC) 晶体在承受均匀各向同性膨胀 $\\mathbf{F} = \\lambda \\mathbf{I}$ 时的粗粒化能量密度 $W(\\mathbf{F})$。该能量密度是原子-连续介质并发耦合方案中的一个关键量。推导基于 Cauchy-Born 法则，该法则假定对于均匀变形，晶格与连续介质以相同的方式变形。能量密度即为变形晶格每单位参考体积的势能。对于具有对相互作用的周期性系统，这可以表示为每个原子的能量。\n\n在一个由势 $\\varphi(r)$ 描述对相互作用的晶体中，每个原子的总势能 $E_{atom}$ 由一个参考原子与其所有邻居之间相互作用势能之和的一半给出。\n$$\nE_{atom} = \\frac{1}{2} \\sum_{j} \\varphi(r_j)\n$$\n其中 $r_j$ 是到第 $j$ 个邻居原子的距离。问题将相互作用限制在前两个近邻壳层。对于晶格参数为 $a$ 的 FCC 晶格，其配位数和参考距离如下：\n- 第一壳层：$z_1 = 12$ 个邻居，距离为 $R_1 = \\frac{a}{\\sqrt{2}}$。\n- 第二壳层：$z_2 = 6$ 个邻居，距离为 $R_2 = a$。\n\n变形构型中每个原子的能量 $E_{atom}(\\mathbf{F})$ 为：\n$$\nE_{atom}(\\mathbf{F}) = \\frac{1}{2} \\left[ z_1 \\varphi(r'_1) + z_2 \\varphi(r'_2) \\right]\n$$\n其中 $r'_1$ 和 $r'_2$ 是变形状态下的近邻距离。\n\n根据 Cauchy-Born 法则，参考构型中的物质矢量 $\\mathbf{R}$ 在变形构型中被映射为 $\\mathbf{r} = \\mathbf{F}\\mathbf{R}$。对于指定的各向同性膨胀，$\\mathbf{F} = \\lambda \\mathbf{I}$，其中 $\\mathbf{I}$ 是单位张量。因此，一个键矢量 $\\mathbf{R}$ 变为 $\\mathbf{r} = \\lambda \\mathbf{R}$，其长度变为 $r = |\\mathbf{r}| = |\\lambda \\mathbf{R}| = \\lambda R$。所有的原子间距都按因子 $\\lambda$ 进行缩放。\n\n因此，变形后的近邻距离为：\n$$\nr'_1 = \\lambda R_1 = \\frac{\\lambda a}{\\sqrt{2}}\n$$\n$$\nr'_2 = \\lambda R_2 = \\lambda a\n$$\n\nLennard-Jones (LJ) 对势由下式给出：\n$$\n\\varphi(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]\n$$\n其中 $\\varepsilon$ 和 $\\sigma$ 是常数。\n\n现在，我们可以通过代入变形后的距离和配位数来表示变形状态下每个原子的能量 $E_{atom}(\\lambda)$：\n$$\nE_{atom}(\\lambda) = \\frac{1}{2} \\left[ 12 \\cdot 4 \\varepsilon \\left( \\left( \\frac{\\sigma}{r'_1} \\right)^{12} - \\left( \\frac{\\sigma}{r'_1} \\right)^{6} \\right) + 6 \\cdot 4 \\varepsilon \\left( \\left( \\frac{\\sigma}{r'_2} \\right)^{12} - \\left( \\frac{\\sigma}{r'_2} \\right)^{6} \\right) \\right]\n$$\n代入 $r'_1$ 和 $r'_2$ 的表达式：\n$$\nE_{atom}(\\lambda) = 24 \\varepsilon \\left[ \\left( \\frac{\\sigma}{\\lambda a / \\sqrt{2}} \\right)^{12} - \\left( \\frac{\\sigma}{\\lambda a / \\sqrt{2}} \\right)^{6} \\right] + 12 \\varepsilon \\left[ \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right]\n$$\n我们可以简化包含 $\\sqrt{2}$ 的项：\n$$\n(\\sqrt{2})^{12} = (2^{1/2})^{12} = 2^6 = 64\n$$\n$$\n(\\sqrt{2})^6 = (2^{1/2})^6 = 2^3 = 8\n$$\n因此，每个原子的能量变为：\n$$\nE_{atom}(\\lambda) = 24 \\varepsilon \\left[ 64 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - 8 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right] + 12 \\varepsilon \\left[ \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right]\n$$\n将具有相同 $(\\sigma / \\lambda a)$ 幂次的项组合在一起：\n$$\nE_{atom}(\\lambda) = \\varepsilon \\left[ (24 \\cdot 64 + 12) \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - (24 \\cdot 8 + 12) \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right]\n$$\n计算系数：\n$$\n24 \\cdot 64 + 12 = 1536 + 12 = 1548\n$$\n$$\n24 \\cdot 8 + 12 = 192 + 12 = 204\n$$\n所以，每个原子的能量为：\n$$\nE_{atom}(\\lambda) = \\varepsilon \\left[ 1548 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - 204 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right]\n$$\n能量密度 $W(\\mathbf{F}) = W(\\lambda)$ 是每单位*参考*体积的能量。常规 FCC 晶胞的体积为 $a^3$ 并包含 $4$ 个原子。因此，每个原子的参考体积为 $\\Omega_{atom} = a^3/4$。\n$$\nW(\\lambda) = \\frac{E_{atom}(\\lambda)}{\\Omega_{atom}} = \\frac{E_{atom}(\\lambda)}{a^3 / 4} = \\frac{4 E_{atom}(\\lambda)}{a^3}\n$$\n代入 $E_{atom}(\\lambda)$ 的表达式：\n$$\nW(\\lambda) = \\frac{4 \\varepsilon}{a^3} \\left[ 1548 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - 204 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right]\n$$\n问题要求的是无量纲能量密度 $\\tilde{W}(\\lambda)$，其定义为 $\\tilde{W}(\\lambda) := \\frac{a^3}{\\varepsilon} W(\\lambda)$。\n$$\n\\tilde{W}(\\lambda) = \\frac{a^3}{\\varepsilon} \\left( \\frac{4 \\varepsilon}{a^3} \\left[ 1548 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - 204 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right] \\right)\n$$\n$$\n\\tilde{W}(\\lambda) = 4 \\left[ 1548 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - 204 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6} \\right]\n$$\n乘以 $4$：\n$$\n4 \\cdot 1548 = 6192\n$$\n$$\n4 \\cdot 204 = 816\n$$\n这给出了无量纲能量密度的最终闭合形式解析表达式：\n$$\n\\tilde{W}(\\lambda) = 6192 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - 816 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6}\n$$\n问题还要求将此结果与直接的原子能量计算进行比较。上述遵循的过程*就是*对均匀变形的周期性晶体进行的直接原子计算。对于均匀变形，Cauchy-Born 法则不是一个近似，而是一个精确的陈述。它提供了从底层原子相互作用来定义连续介质能量密度的框架。因此，推导出的 $W(\\mathbf{F})$ 与每单位参考体积的直接原子能量是相同的，这验证了该方法在这种特定加载情况下的自洽性。连续介质建模中的“近似”出现在当一个在均匀假设下推导出的能量密度函数，被用来模拟一个具有*非均匀*变形区域的能量时。",
            "answer": "$$\n\\boxed{6192 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{12} - 816 \\left( \\frac{\\sigma}{\\lambda a} \\right)^{6}}\n$$"
        },
        {
            "introduction": "即便能量分解的理论框架是自洽的，数值实现中的细节也可能引入非物理的“鬼力” (ghost forces)，从而破坏模拟的准确性。本练习提供了一个具体的计算任务，旨在量化这些由数值积分不对称性引起的鬼力。通过这项实践，您将学会如何通过“补丁测试” (patch test) 来诊断并修正这些数值赝像，确保耦合方案的保真度。",
            "id": "3806348",
            "problem": "考虑一个一维晶体链，原子由整数 $i$ 索引，晶格间距为 $a$，位置为 $x_i$。该链具有均匀的最近邻和次近邻谐波能量对相互作用。链段的总原子能量定义为\n$$\nE_{\\text{atom}} = \\sum_{i} \\frac{1}{2} k_1 \\left( x_{i+1} - x_i - a \\right)^2 + \\sum_{i} \\frac{1}{2} k_2 \\left( x_{i+2} - x_i - 2a \\right)^2,\n$$\n其中 $k_1$ 和 $k_2$ 分别是最近邻和次近邻相互作用的刚度。在静态平衡中，原子 $i$ 上的净内力为 $f_i = -\\partial E / \\partial x_i$。在均匀应变场下，变形为 $x_i = i a (1 + \\epsilon)$，一个完全原子模型由于对称性和对力的抵消，在每个原子上产生零净内力。\n\n在并行耦合设置中，区域被划分为原子子区域（左侧）和连续介质子区域（右侧）。连续介质子区域被粗略离散化（代表性原子间距为 $r a$），其对能量的贡献通过求积法进行近似。在界面原子（记为 $i = 0$）附近，延伸到连续介质子区域的相互作用被分配了求积权重。设 $w_1^{\\text{right}}$ 和 $w_2^{\\text{right}}$ 分别表示施加在原子 $i = 0$ 处，用于最近邻和次近邻键的连续介质侧贡献的有效求积权重。原子侧的权重为 $w_1^{\\text{left}} = 1$ 和 $w_2^{\\text{left}} = 1$（精确求和）。假设均匀应变 $x_i = i a (1 + \\epsilon)$ 在整个界面上成立。\n\n对于此设置，将界面处的鬼力定义为在均匀应变场下，由非对称求积权重在 $i = 0$ 处产生的残余净内力。使用基于能量的定义和牛顿力作为负能量梯度，可以证明在均匀应变下，界面处的鬼力大小为\n$$\nF_{\\text{ghost}} = \\left| \\left(w_1^{\\text{left}} - w_1^{\\text{right}} \\right) k_1 a \\epsilon + \\left(w_2^{\\text{left}} - w_2^{\\text{right}} \\right) k_2 \\cdot 2 a \\epsilon \\right|.\n$$\n该模型假设线性弹性、谐波对势以及对称的左侧精确求和。\n\n求积法的影响：不同的单元求积规则如下确定 $w_1^{\\text{right}}$ 和 $w_2^{\\text{right}}$（在均匀场下界面处理的合理映射）：\n- 中点法则：$w_1^{\\text{right}} = \\frac{1}{2}$，$w_2^{\\text{right}} = \\frac{1}{2}$。\n- 梯形法则：$w_1^{\\text{right}} = 1$，$w_2^{\\text{right}} = 1$。\n- 单点高斯法则：$w_1^{\\text{right}} = \\frac{1}{2}$，$w_2^{\\text{right}} = \\frac{1}{2}$。\n- 节点集中到原子界面节点（向左极端集中）：$w_1^{\\text{right}} = 0$，$w_2^{\\text{right}} = 0$。\n- 完全原子模拟（无粗化，$r = 1$）：$w_1^{\\text{right}} = 1$，$w_2^{\\text{right}} = 1$。\n\n补丁测试修正：恢复补丁测试性能的修正要求界面处贡献的对称性，即设置 $w_n^{\\text{right}} = w_n^{\\text{left}}$，其中 $n \\in \\{1,2\\}$。等效地，选择求积法或应用基于键的修正，以使 $w_1^{\\text{right}} = 1$ 和 $w_2^{\\text{right}} = 1$。使用这些修正后的权重，鬼力在均匀应变下消失。\n\n任务：实现一个程序，对于一组测试用例，计算修正前（基于指定的求积规则）和应用补丁测试恢复修正（设置 $w_1^{\\text{right}} = 1$ 和 $w_2^{\\text{right}} = 1$）后的鬼力大小 $F_{\\text{ghost}}$。\n\n所有量都应以与选择 $a = 1$ 和谐波刚度 $k_1, k_2$ 一致的无量纲单位处理；您必须以无量纲单位表示力。\n\n测试套件：\n- 测试 1：$k_1 = 1.0$, $k_2 = 0.4$, $a = 1.0$, $\\epsilon = 0.01$, 求积规则 = midpoint, $r = 4$。\n- 测试 2：$k_1 = 1.0$, $k_2 = 0.4$, $a = 1.0$, $\\epsilon = 0.01$, 求积规则 = trapezoid, $r = 4$。\n- 测试 3：$k_1 = 1.0$, $k_2 = 0.4$, $a = 1.0$, $\\epsilon = 0.01$, 求积规则 = node_lumped, $r = 8$。\n- 测试 4：$k_1 = 1.0$, $k_2 = 0.4$, $a = 1.0$, $\\epsilon = 0.01$, 求积规则 = atomistic, $r = 1$。\n- 测试 5（边界情况）：$k_1 = 1.0$, $k_2 = 0.4$, $a = 1.0$, $\\epsilon = 0.0$, 求积规则 = midpoint, $r = 4$。\n\n算法规范：\n- 对于每个测试，如上所述将求积规则映射到 $(w_1^{\\text{right}}, w_2^{\\text{right}})$。\n- 使用 $F_{\\text{ghost}}$ 的公式计算修正前的鬼力大小。\n- 通过设置 $(w_1^{\\text{right}}, w_2^{\\text{right}}) = (1, 1)$ 来计算修正后的鬼力大小。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个类似 JSON 的嵌套列表的结果，该列表包含两个子列表：第一个子列表包含测试 1 到 5 的修正前鬼力大小，第二个子列表包含相同测试的修正后大小。每个浮点数必须四舍五入到 6 位小数。例如，输出必须如下所示\n$$\n\\left[ [f_1, f_2, f_3, f_4, f_5], [g_1, g_2, g_3, g_4, g_5] \\right]\n$$\n其中 $f_i$ 和 $g_i$ 以四舍五入到 6 位小数的十进制浮点数打印。",
            "solution": "该问题是有效的。它在科学上基于多尺度材料模拟的既定理论，特别是关于并行原子-连续介质耦合和被称为鬼力的数值伪影。该问题是适定的，提供了明确的目标、所有必要的数据和可验证的公式。它没有歧义、矛盾和事实错误。\n\n核心任务是计算在均匀应变下，一维谐波晶体链的耦合原子-连续介质区域界面处的鬼力大小。这种力源于跨界面能量求和（求积）的不对称性。我们将为一组测试用例计算这个力，包括在应用补丁测试修正之前和之后。\n\n界面原子（$i=0$）处鬼力大小 $F_{\\text{ghost}}$ 的控制方程如下：\n$$\nF_{\\text{ghost}} = \\left| \\left(w_1^{\\text{left}} - w_1^{\\text{right}} \\right) k_1 a \\epsilon + \\left(w_2^{\\text{left}} - w_2^{\\text{right}} \\right) k_2 \\cdot 2 a \\epsilon \\right|\n$$\n其中：\n- $k_1$ 和 $k_2$ 分别是最近邻和次近邻键的刚度。\n- $a$ 是晶格间距，为实现无量纲化设为 $1$。\n- $\\epsilon$ 是施加的均匀应变。\n- $w_1^{\\text{left}}$ 和 $w_2^{\\text{left}}$ 是延伸到完全解析的原子区域的键的权重。问题指定这些权重始终为 $1$，即 $w_1^{\\text{left}} = 1$ 和 $w_2^{\\text{left}} = 1$。\n- $w_1^{\\text{right}}$ 和 $w_2^{\\text{right}}$ 是延伸到粗粒化连续介质区域的键的求积权重。它们的值取决于所选择的求积规则。\n\n代入左侧权重的给定值，公式简化为：\n$$\nF_{\\text{ghost}} = \\left| \\left(1 - w_1^{\\text{right}} \\right) k_1 a \\epsilon + 2\\left(1 - w_2^{\\text{right}} \\right) k_2 a \\epsilon \\right|\n$$\n这可以进一步通过 $a \\epsilon$ 分解因式：\n$$\nF_{\\text{ghost}} = |a \\epsilon| \\cdot \\left| \\left(1 - w_1^{\\text{right}} \\right) k_1 + 2\\left(1 - w_2^{\\text{right}} \\right) k_2 \\right|\n$$\n\n每个测试用例的计算分两个阶段进行：使用指定求积规则的修正前计算，以及模拟成功补丁测试的修正后计算。\n\n从求积规则名称到权重 $(w_1^{\\text{right}}, w_2^{\\text{right}})$ 的映射提供如下：\n- 中点法则：$(w_1^{\\text{right}}, w_2^{\\text{right}}) = (0.5, 0.5)$\n- 梯形法则：$(w_1^{\\text{right}}, w_2^{\\text{right}}) = (1, 1)$\n- 节点集中：$(w_1^{\\text{right}}, w_2^{\\text{right}}) = (0, 0)$\n- 完全原子模拟：$(w_1^{\\text{right}}, w_2^{\\text{right}}) = (1, 1)$\n\n**第 1 部分：修正前鬼力计算**\n\n我们对每个测试使用特定参数应用简化公式。对于测试 1 到 4，通用参数为 $k_1 = 1.0$, $k_2 = 0.4$, $a = 1.0$ 和 $\\epsilon = 0.01$。\n\n- **测试 1**：求积规则 = midpoint。\n  - 权重为 $w_1^{\\text{right}} = 0.5$ 和 $w_2^{\\text{right}} = 0.5$。\n  - $F_{\\text{ghost}} = |1.0 \\cdot 0.01| \\cdot \\left| (1 - 0.5) \\cdot 1.0 + 2(1 - 0.5) \\cdot 0.4 \\right|$\n  - $F_{\\text{ghost}} = 0.01 \\cdot \\left| (0.5) \\cdot 1.0 + 2(0.5) \\cdot 0.4 \\right| = 0.01 \\cdot |0.5 + 0.4| = 0.01 \\cdot 0.9 = 0.009$。\n\n- **测试 2**：求积规则 = trapezoid。\n  - 权重为 $w_1^{\\text{right}} = 1$ 和 $w_2^{\\text{right}} = 1$。\n  - $F_{\\text{ghost}} = |1.0 \\cdot 0.01| \\cdot \\left| (1 - 1) \\cdot 1.0 + 2(1 - 1) \\cdot 0.4 \\right|$\n  - $F_{\\text{ghost}} = 0.01 \\cdot \\left| 0 + 0 \\right| = 0$。\n\n- **测试 3**：求积规则 = node_lumped。\n  - 权重为 $w_1^{\\text{right}} = 0$ 和 $w_2^{\\text{right}} = 0$。\n  - $F_{\\text{ghost}} = |1.0 \\cdot 0.01| \\cdot \\left| (1 - 0) \\cdot 1.0 + 2(1 - 0) \\cdot 0.4 \\right|$\n  - $F_{\\text{ghost}} = 0.01 \\cdot \\left| 1.0 + 2 \\cdot 0.4 \\right| = 0.01 \\cdot |1.0 + 0.8| = 0.01 \\cdot 1.8 = 0.018$。\n\n- **测试 4**：求积规则 = atomistic。\n  - 权重为 $w_1^{\\text{right}} = 1$ 和 $w_2^{\\text{right}} = 1$。\n  - 这与梯形法则的情况相同。\n  - $F_{\\text{ghost}} = 0$。\n\n- **测试 5**：求积规则 = midpoint，但 $\\epsilon = 0.0$。\n  - 因子 $|a \\epsilon|$ 变为 $|1.0 \\cdot 0.0| = 0$。\n  - $F_{\\text{ghost}} = 0 \\cdot \\left| \\dots \\right| = 0$。这是预料之中的，因为没有变形来产生力。\n\n修正前的鬼力大小为：$0.009$、$0.0$、$0.018$、$0.0$ 和 $0.0$。\n\n**第 2 部分：修正后鬼力计算**\n\n补丁测试修正确保了耦合方法能正确再现一个恒定应变场，在任何内部原子上净力为零。这是通过在力/能量求和中强制对称性来实现的，这对应于设置 $w_1^{\\text{right}} = w_1^{\\text{left}} = 1$ 和 $w_2^{\\text{right}} = w_2^{\\text{left}} = 1$。\n\n将这些修正后的权重应用于任何测试用例的鬼力公式：\n$$\nF_{\\text{ghost, corr}} = |a \\epsilon| \\cdot \\left| \\left(1 - 1 \\right) k_1 + 2\\left(1 - 1 \\right) k_2 \\right|\n$$\n$$\nF_{\\text{ghost, corr}} = |a \\epsilon| \\cdot \\left| 0 \\cdot k_1 + 2 \\cdot 0 \\cdot k_2 \\right| = |a \\epsilon| \\cdot 0 = 0\n$$\n因此，对于所有测试用例，修正后的鬼力恰好为 $0$。这个结果对于补丁测试的目的至关重要：消除均匀变形下的伪力。\n\n修正后的鬼力大小为：$0.0$、$0.0$、$0.0$、$0.0$ 和 $0.0$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ghost force magnitude for a 1D atomistic-continuum coupled chain\n    before and after a patch test correction.\n    \"\"\"\n\n    # Define the mapping from quadrature rule names to right-side weights (w1_right, w2_right).\n    # The problem statement mentions one-point Gaussian, which is included here for completeness,\n    # though not used in the test suite.\n    quad_rules = {\n        \"midpoint\": (0.5, 0.5),\n        \"trapezoid\": (1.0, 1.0),\n        \"one_point_gaussian\": (0.5, 0.5),\n        \"node_lumped\": (0.0, 0.0),\n        \"atomistic\": (1.0, 1.0),\n    }\n\n    # Define the test suite as a list of dictionaries for clarity.\n    # The variable 'r' (coarsening ratio) is provided for context but not used in the given formula.\n    test_cases = [\n        {\"k1\": 1.0, \"k2\": 0.4, \"a\": 1.0, \"epsilon\": 0.01, \"quadrature_rule\": \"midpoint\", \"r\": 4},\n        {\"k1\": 1.0, \"k2\": 0.4, \"a\": 1.0, \"epsilon\": 0.01, \"quadrature_rule\": \"trapezoid\", \"r\": 4},\n        {\"k1\": 1.0, \"k2\": 0.4, \"a\": 1.0, \"epsilon\": 0.01, \"quadrature_rule\": \"node_lumped\", \"r\": 8},\n        {\"k1\": 1.0, \"k2\": 0.4, \"a\": 1.0, \"epsilon\": 0.01, \"quadrature_rule\": \"atomistic\", \"r\": 1},\n        {\"k1\": 1.0, \"k2\": 0.4, \"a\": 1.0, \"epsilon\": 0.0, \"quadrature_rule\": \"midpoint\", \"r\": 4},\n    ]\n\n    # Atomistic-side weights are fixed.\n    w1_left = 1.0\n    w2_left = 1.0\n    \n    # Post-correction weights are fixed, by definition of the patch test restoration.\n    w1_right_corrected = 1.0\n    w2_right_corrected = 1.0\n\n    pre_correction_forces = []\n    post_correction_forces = []\n\n    def calculate_ghost_force(k1, k2, a, epsilon, w1_l, w2_l, w1_r, w2_r):\n        \"\"\"\n        Calculates ghost force magnitude based on the provided formula.\n        F_ghost = | (w1_left - w1_right) * k1*a*eps + (w2_left - w2_right) * k2*2*a*eps |\n        \"\"\"\n        term1 = (w1_l - w1_r) * k1 * a * epsilon\n        term2 = (w2_l - w2_r) * k2 * 2 * a * epsilon\n        return abs(term1 + term2)\n\n    for case in test_cases:\n        k1 = case[\"k1\"]\n        k2 = case[\"k2\"]\n        a = case[\"a\"]\n        epsilon = case[\"epsilon\"]\n        rule = case[\"quadrature_rule\"]\n\n        # 1. Pre-correction calculation\n        w1_right, w2_right = quad_rules[rule]\n        f_ghost_pre = calculate_ghost_force(k1, k2, a, epsilon, w1_left, w2_left, w1_right, w2_right)\n        pre_correction_forces.append(f_ghost_pre)\n\n        # 2. Post-correction calculation\n        f_ghost_post = calculate_ghost_force(k1, k2, a, epsilon, w1_left, w2_left, w1_right_corrected, w2_right_corrected)\n        post_correction_forces.append(f_ghost_post)\n    \n    # Format the results to 6 decimal places as required.\n    pre_formatted = [f\"{f:.6f}\" for f in pre_correction_forces]\n    post_formatted = [f\"{g:.6f}\" for g in post_correction_forces]\n\n    # Construct the final output string in the exact specified format.\n    output_string = f\"[[{','.join(pre_formatted)}],[{','.join(post_formatted)}]]\"\n    \n    print(output_string)\n\nsolve()\n```"
        }
    ]
}