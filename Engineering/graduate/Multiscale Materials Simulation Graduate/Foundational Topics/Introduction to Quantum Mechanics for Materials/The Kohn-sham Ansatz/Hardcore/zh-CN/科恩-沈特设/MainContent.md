## 引言
密度泛函理论（DFT）通过深刻的[Hohenberg-Kohn定理](@entry_id:139793)证明，一个系统的所有基态性质都由其电子密度唯一确定，为从根本上理解物质世界提供了强大的理论框架。然而，直接应用这些定理面临着一个巨大的实践障碍：包含复杂多体动能的普适[能量泛函](@entry_id:170311)其具体形式是未知的，这使得直接从密度计算能量变得遥不可及。为了跨越从精确理论到实用计算的鸿沟，[Kohn-Sham拟设](@entry_id:1126958)应运而生，它是一种革命性的策略，至今仍是现代计算材料科学和量子化学的基石。

本文旨在系统性地剖析[Kohn-Sham拟设](@entry_id:1126958)。我们将从第一性原理出发，逐步构建这一理论。
*   在“原理与机制”一章中，我们将深入探讨该拟设如何巧妙地引入一个辅助的[无相互作用系统](@entry_id:143064)，从而推导出核心的[Kohn-Sham方程](@entry_id:143968)。我们还将剖析关键的交换关联泛函的物理内涵，并解释求解方程的[自洽场方法](@entry_id:165084)。
*   接下来，在“应用与交叉学科联系”一章中，我们将展示该方法在预测材料的电子、结构和磁学性质方面的强大能力，并探讨其如何通过[赝势](@entry_id:170389)等计算技术得以实现，以及如何扩展到描述动力学和相对论效应。
*   最后，“实践操作”部分将提供具体的计算练习，帮助读者将理论知识转化为实践技能。

通过这一系列的阐述，读者将对[Kohn-Sham DFT](@entry_id:172809)的强大功能、内在逻辑及其局限性有一个全面而深刻的理解。

## 原理与机制

在[密度泛函理论](@entry_id:139027)（DFT）的框架内，Hohenberg-Kohn 定理为我们提供了深刻的理论基础：一个多电子系统的基态性质完全由其基态电子密度 $n(\mathbf{r})$ 唯一确定。然而，这些定理本身并未提供一个直接计算系统能量的实用方法。本章的核心任务是阐述 Kohn-Sham (KS) 拟设，这是一种将形式上精确但难以实践的 Hohenberg-Kohn 框架转化为一种强大且广泛应用的计算方法的巧妙策略。我们将从第一性原理出发，系统地构建 Kohn-Sham 理论的结构，推导其核心方程，并探讨其实际应用、诠释及固有限制。

### [变分原理](@entry_id:198028)：基态能量的搜寻

[密度泛函理论](@entry_id:139027)的实践基础是第二个 Hohenberg-Kohn 定理，它为我们提供了一个关于能量的[变分原理](@entry_id:198028)。这个原理的现代、更严谨的形式是通过 Levy-Lieb 的约[束搜索](@entry_id:634146)（constrained-search）表述来理解的。

首先，我们定义一个[普适泛函](@entry_id:140176) $F[n]$。对于任何一个给定的、符合物理要求的电子密度 $n(\mathbf{r})$，我们可以在所有能够产生该密度的反对称 $N$ 电子[波函数](@entry_id:201714) $\Psi$ 的集合中进行搜索，并找到使得动能 $\hat{T}$ 和[电子-电子相互作用](@entry_id:139900)能 $\hat{W}$ 的[期望值](@entry_id:150961)之和最小的那个[波函数](@entry_id:201714)。这个最小的[期望值](@entry_id:150961)就被定义为[普适泛函](@entry_id:140176) $F[n]$ 的值：

$$
F[n] = \min_{\Psi \to n} \langle \Psi | \hat{T} + \hat{W} | \Psi \rangle
$$

这里的密度 $n(\mathbf{r})$ 必须是 **$N$-可表象的**（$N$-representable），这意味着必须存在至少一个反对称的 $N$ 电子量子态（[纯态](@entry_id:141688)或系综），其单体密度恰好为 $n(\mathbf{r})$。[普适泛函](@entry_id:140176) $F[n]$ 之所以“普适”，是因为它的定义完全不依赖于系统所处的外部势 $v_{\text{ext}}(\mathbf{r})$。

有了 $F[n]$，在特定外势 $v_{\text{ext}}(\mathbf{r})$ 中，系统的总能量可以表示为一个关于密度的泛函 $E_v[n]$：

$$
E_v[n] = F[n] + \int v_{\text{ext}}(\mathbf{r}) n(\mathbf{r}) \,d\mathbf{r}
$$

现在，我们可以推导[变分原理](@entry_id:198028) 。对于任意一个 $N$-可表象的密度 $n(\mathbf{r})$，根据 $F[n]$ 的定义，总存在一个[波函数](@entry_id:201714) $\Psi_n$ 使得 $F[n] = \langle \Psi_n | \hat{T} + \hat{W} | \Psi_n \rangle$。将此代入 $E_v[n]$ 的表达式中，我们得到：

$$
E_v[n] = \langle \Psi_n | \hat{T} + \hat{W} | \Psi_n \rangle + \int v_{\text{ext}}(\mathbf{r}) n(\mathbf{r}) \,d\mathbf{r} = \langle \Psi_n | \hat{T} + \hat{W} + \hat{V}_{\text{ext}} | \Psi_n \rangle = \langle \Psi_n | \hat{H}[v_{\text{ext}}] | \Psi_n \rangle
$$

根据量子力学的瑞利-里兹（Rayleigh-Ritz）变分原理，任何试验[波函数](@entry_id:201714)（这里是 $\Psi_n$）所对应的[哈密顿量](@entry_id:144286)[期望值](@entry_id:150961)，必然大于或等于系统的[基态能量](@entry_id:263704) $E_0$。因此，我们得到一个至关重要的不等式：

$$
E_v[n] \ge E_0
$$

这个不等式对所有 $N$-可表象的密度都成立。而对于真实的基[态密度](@entry_id:147894) $n_0(\mathbf{r})$，其对应的基态[波函数](@entry_id:201714)为 $\Psi_0$。显然，$E_v[n_0]$ 的值应等于基态能量 $E_0$。综合可知，基态密度 $n_0(\mathbf{r})$ 使总能量泛函 $E_v[n]$ 达到其最小值，这个最小值就是[基态能量](@entry_id:263704) $E_0$。这为我们通过最小化能量泛函来寻找基态密度和能量提供了理论依据。

### Kohn-Sham 拟设：一个巧妙的替代策略

尽管变分原理在理论上是完美的，但它有一个致命的实践障碍：[普适泛函](@entry_id:140176) $F[n]$ 的具体形式是未知的，特别是其中的动能部分 $T[n]$ 作为一个密度泛函极难处理。Kohn-Sham 拟设通过引入一个[辅助系统](@entry_id:142219)，巧妙地绕过了这个难题 。

其核心思想是，用一个虚构的、无相互作用的电子系统来替代真实的、有相互作用的系统。这个**[辅助系统](@entry_id:142219)**被精心设计，使其基态密度与真实系统的基态密度完全相同。通过这种方式，真实[多体系统](@entry_id:144006)动能中最大、最主要的部分可以被精确地计算出来。

这个拟设包含一个深刻的隐含假设：真实相互作用系统的基[态密度](@entry_id:147894) $n(\mathbf{r})$ 必须是**无相互作用 $v$-可表象的**（non-interacting $v$-representable）。这意味着，必须存在一个局域的、乘性的单粒子势 $v_s(\mathbf{r})$，使得一个无[相互作用费米子](@entry_id:160994)系统的基态密度恰好是 $n(\mathbf{r})$。如果这个假设不成立，那么就不可能找到这样一个辅助系统，整个 Kohn-Sham 框架也将失效。幸运的是，对于绝大多数物理系统，这个假设被认为是成立的。这个假设比 $N$-可表象性要严格得多，后者仅仅要求密度可以由某个[反对称波函数](@entry_id:153813)产生，而不关心该[波函数](@entry_id:201714)是否是某个无[相互作用哈密顿量](@entry_id:181720)的基态。

### 能量泛函的分解

在 Kohn-Sham 框架下，总能量泛函 $E[n]$ 被重新分解为四个部分：

$$
E[n] = T_{s}[n] + \int v_{\text{ext}}(\mathbf{r}) n(\mathbf{r}) \,d\mathbf{r} + E_{H}[n] + E_{xc}[n]
$$

让我们逐一审视这些项的定义和意义：

*   **无相互作用动能 $T_s[n]$**：这是 Kohn-Sham [辅助系统](@entry_id:142219)中无相互作用电子的动能。与真实的、难以处理的动能泛函 $T[n]$ 不同，$T_s[n]$ 可以通过 Kohn-Sham 轨道 $\phi_i$ 精确地表示出来：
    $$
    T_s[n] = \sum_{i}^{\text{occ}} \int \phi_i^*(\mathbf{r}) \left( -\frac{1}{2}\nabla^2 \right) \phi_i(\mathbf{r}) \,d\mathbf{r}
    $$
    这正是 Kohn-Sham 方法的精髓所在：将动能的主要部分转化为一个可以精确计算的形式。

*   **外势能**：$\int v_{\text{ext}}(\mathbf{r}) n(\mathbf{r}) \,d\mathbf{r}$，这部分描述了电子密度与原子核等外部势场的相互作用，形式简单明了。

*   **哈特里能 $E_H[n]$**：这是[电子-电子相互作用](@entry_id:139900)能中的经典静电部分，即电子云作为经典电荷分布与其自身相互作用的能量 。
    $$
    E_H[n] = \frac{1}{2} \iint \frac{n(\mathbf{r}) n(\mathbf{r}')}{|\mathbf{r} - \mathbf{r}'|} \,d\mathbf{r} \,d\mathbf{r}'
    $$
    这部分能量也被称为经典[库仑能](@entry_id:161936)或平均场排斥能。

*   **交换关联能 $E_{xc}[n]$**：这是一个“万能”项，根据定义，它包含了所有被上述三项忽略的能量贡献，从而保证总能量表达式是精确的。它是 [Kohn-Sham DFT](@entry_id:172809) 的核心，也是所有近似的来源。

### 交换关联泛函：多体物理的核心

为了理解 [Kohn-Sham DFT](@entry_id:172809) 的本质，我们必须深入剖析交换关联能 $E_{xc}[n]$ 的构成 。通过将 Kohn-Sham 能量表达式与精确的能量表达式进行比较，我们可以得到 $E_{xc}[n]$ 的正式定义：

$$
E_{xc}[n] = (T[n] - T_s[n]) + (V_{ee}[n] - E_H[n])
$$

这个表达式揭示了 $E_{xc}[n]$ 的两个主要物理来源：

1.  **动能关联贡献 $(T[n] - T_s[n])$**：这是真实相互作用系统的动能 $T[n]$ 与 Kohn-Sham 辅助系统动能 $T_s[n]$ 之间的差值 。由于真实系统的[多体波函数](@entry_id:203043)比单个[斯莱特行列式](@entry_id:139034)（Kohn-Sham 系统的[波函数](@entry_id:201714)）要复杂得多，电子为了相互规避，其动能会发生改变。这部分能量差异就被包含在 $E_{xc}[n]$ 中。

2.  **势能贡献 $(V_{ee}[n] - E_H[n])$**：这是真实的[电子-电子相互作用](@entry_id:139900)能 $V_{ee}[n]$ 与其经典平均场部分 $E_H[n]$ 之间的差值。这部分又可细分为：
    *   **交换能 ($E_x$)**：源于泡利不相容原理，它描述了同自旋电子之间由于[波函数](@entry_id:201714)的[反对称性](@entry_id:261893)而产生的有效“排斥”，导致了所谓的“[交换空穴](@entry_id:148904)”。
    *   **[相关能](@entry_id:144432) ($E_c$)**：描述了电子运动的动态关联，即电子为了躲避彼此而采取的、超出平均场和交换效应的复杂运动。

一个典型的例子可以揭示 $E_{xc}[n]$ 的一个基本性质：**[自相互作用](@entry_id:201333)校正** 。考虑一个只有一个电子的系统（如氢原子）。在物理上，这个电子不与自身相互作用，因此真实的[电子-电子相互作用](@entry_id:139900)能为零。然而，在 Kohn-Sham 的[能量分解](@entry_id:193582)中，哈特里能 $E_H[n]$ 却不为零，它错误地包含了一个电子与其自身电荷云相互作用的非物理能量，这被称为**[自相互作用误差](@entry_id:260813)** (Self-Interaction Error, SIE)。为了使总能量正确，精确的交换关联泛函必须完美地抵消掉这一项。因此，对于任何单电子密度，我们必须有：

$$
E_H[n] + E_{xc}[n] = 0 \quad \text{或} \quad E_{xc}[n] = -E_H[n]
$$

由于单电子系统不存在电子关联，所以 $E_c[n]=0$。这意味着，对于精确泛函，自相互作用完全由交换能部分来抵消，即 $E_x[n] = -E_H[n]$。然而，许多广泛使用的近似泛函（如 LDA 和 GGA）并不能完全满足这个条件，从而导致了自相互作用误差，这是它们的一个主要缺陷。

### Kohn-Sham 方程的推导

我们已经定义了 Kohn-Sham 能量泛函的各个组成部分。现在，我们的目标是找到能使总能量 $E[n]$ 最小化的 Kohn-Sham 轨道 $\phi_i$。通过对总能量泛函应用变分原理，并保持轨道归一正交的约束条件，我们可以推导出一组有效的单粒子薛定谔方程，即**Kohn-Sham 方程**  ：

$$
\left( -\frac{1}{2}\nabla^2 + v_s(\mathbf{r}) \right) \phi_i(\mathbf{r}) = \epsilon_i \phi_i(\mathbf{r})
$$

这里的 $\epsilon_i$ 是 Kohn-Sham 轨道能，而 $v_s(\mathbf{r})$ 是**[有效势](@entry_id:1124192)**（或称 Kohn-Sham 势）。它是一个局域的、乘性的[势场](@entry_id:143025)，作用于系统中的每一个（无相互作用的）Kohn-Sham 电子。通过变分推导，可以确定有效势的构成：

$$
v_s(\mathbf{r}) = v_{\text{ext}}(\mathbf{r}) + v_H(\mathbf{r}) + v_{xc}(\mathbf{r})
$$

其中：
*   $v_{\text{ext}}(\mathbf{r})$ 是外部势。
*   $v_H(\mathbf{r})$ 是**哈特里势**，它是[哈特里能量](@entry_id:167303) $E_H[n]$ 对密度的泛函导数：
    $$
    v_H(\mathbf{r}) = \frac{\delta E_H[n]}{\delta n(\mathbf{r})} = \int \frac{n(\mathbf{r}')}{|\mathbf{r} - \mathbf{r}'|} \,d\mathbf{r}'
    $$
    它代表了在 $\mathbf{r}$ 处的电子感受到的来自整个电子云的经典[静电势](@entry_id:188370)。
*   $v_{xc}(\mathbf{r})$ 是**交换关联势**，它是交换关联能量 $E_{xc}[n]$ 对密度的泛函导数：
    $$
    v_{xc}(\mathbf{r}) = \frac{\delta E_{xc}[n]}{\delta n(\mathbf{r})}
    $$
    这个势是 Kohn-Sham 理论中最复杂、最核心的部分。它将所有棘手的多体量子效应（交换、关联、动能关联）都“打包”进一个有效的单粒子势中，正是这个势迫使无相互作用的辅助系统产生与真实系统完全相同的基[态密度](@entry_id:147894)。

### 求解方程：[自洽场](@entry_id:136549)（SCF）循环

Kohn-Sham 方程的结构本身就暗示了一种迭代求解的方案。[有效势](@entry_id:1124192) $v_s$ 依赖于电子密度 $n$，而电子密度 $n$ 又是由作为 Kohn-Sham 方程解的轨道 $\phi_i$ 决定的，而这些轨道本身又依赖于[有效势](@entry_id:1124192) $v_s$。这种“鸡生蛋，蛋生鸡”的循环关系必须通过**[自洽场](@entry_id:136549) (Self-Consistent Field, SCF)** 方法来解决 。一个典型的 SCF 循环流程如下：

1.  **初始化**：从一个初始的猜测密度 $n^{(0)}(\mathbf{r})$ 开始。通常，这个猜测密度可以通过叠加构成系统的各个原子的电荷密度来获得。这个初始密度必须满足粒子数守恒，即 $\int n^{(0)}(\mathbf{r}) \,d\mathbf{r} = N$。

2.  **构造势**：利用当前的密度 $n^{(k)}(\mathbf{r})$，计算哈特里势 $v_H[n^{(k)}](\mathbf{r})$ 和交换关联势 $v_{xc}[n^{(k)}](\mathbf{r})$，从而构造出当前迭代步的[有效势](@entry_id:1124192) $v_s^{(k)}(\mathbf{r})$。

3.  **求解 KS 方程**：在势场 $v_s^{(k)}(\mathbf{r})$ 中求解 Kohn-Sham 方程，得到一组新的轨道 $\{\phi_i^{(k)}\}$ 和轨道能 $\{\epsilon_i^{(k)}\}$。

4.  **计算新密度**：根据得到的轨道，通过占据数（例如，对于绝缘体，占据能量最低的 $N/2$ 个轨道，每个轨道占据 2 个电子）求和，构造出一个新的输出密度 $\tilde{n}^{(k+1)}(\mathbf{r}) = \sum_i f_i |\phi_i^{(k)}(\mathbf{r})|^2$。

5.  **密度混合**：为了防止迭代过程发生振荡或发散，不能直接用新的输出密度 $\tilde{n}^{(k+1)}$ 作为下一步的输入密度。而是将输入密度 $n^{(k)}$ 和输出密度 $\tilde{n}^{(k+1)}$ 进行混合，生成下一步的输入密度 $n^{(k+1)}$。一个简单的线性混合方案是 $n^{(k+1)} = (1-\alpha)n^{(k)} + \alpha \tilde{n}^{(k+1)}$，其中 $0  \alpha \le 1$ 是一个混合参数。更复杂的混合方案（如 Pulay 或 Broyden 混合）在实际计算中更为常用。

6.  **收敛性检查**：计算新的总能量 $E[n^{(k+1)}]$，并检查迭代是否收敛。通常需要同时满足多个[收敛判据](@entry_id:158093)，例如，相邻两次迭代的总能量之差小于某个阈值（如 $10^{-6}$ eV），并且密度或势的某些范数之差也小于一个阈值。

7.  **循环或结束**：如果满足[收敛判据](@entry_id:158093)，则计算完成，得到的密度、能量和轨道就是自洽的 Kohn-Sham 解。否则，返回第二步，继续进行下一次迭代，直到达到自洽。

### 结果的诠释与局限性

虽然 Kohn-Sham 方法非常成功，但对其结果的诠释需要谨慎，并且必须认识到其局限性，特别是当使用近似泛函时。

#### Kohn-Sham 轨道能的物理意义

一个常见的问题是：Kohn-Sham 轨道和轨道能 $\epsilon_i$ 是否具有物理意义？根据 **Janak 定理**，轨道能等于总能量对该轨道占据数的偏导数：$\epsilon_i = \partial E / \partial f_i$。

对于**精确的**交换关联泛函，可以证明总能量 $E(N)$ 作为粒子数 $N$ 的函数，在整数之间是[分段线性](@entry_id:201467)的 。这一性质导致了一个重要的结论：最高占据分子轨道（HOMO）的能量精确地等于系统[第一电离能](@entry_id:136840) $I$ 的负值，即 $\epsilon_{\text{HOMO}} = -I$。这个等式的成立，还依赖于精确的交换关联势 $v_{xc}(\mathbf{r})$ 在远离原子核的渐进行为必须是 $-1/r$。

然而，对于大多数**近似泛函**（如 [LDA](@entry_id:138982) 和 GGA），上述两个条件都不满足。它们的能量 $E(N)$ 曲线是凸的，而非[分段线性](@entry_id:201467)；它们的 $v_{xc}(\mathbf{r})$ 势在渐进区域衰减得过快（通常是指数衰减）。这两个缺陷共同导致了 $\epsilon_{\text{HOMO}}$ 通常会系统性地高于 $-I$。因此，在使用近似泛函时，将 KS 轨道能直接等同于[准粒子能量](@entry_id:173936)（如光[电子能谱](@entry_id:160814)中的峰位）在理论上是不严谨的，尽管在实践中有时可以作为一种定性的指导。

#### [强关联体系](@entry_id:145791)的挑战

[Kohn-Sham DFT](@entry_id:172809)，特别是依赖于半局域（semilocal）泛函（如 [LDA](@entry_id:138982) 和 GGA）的计算，在处理**[强关联电子体系](@entry_id:183796)**（如[莫特绝缘体](@entry_id:140685)）时会遇到根本性的困难 。

[莫特绝缘体](@entry_id:140685)（Mott Insulator）的物理图像是，在一个每个格点只有一个电子的半满带系统中，由于强大的[在位库仑排斥](@entry_id:269911)能 $U$，电子的跳跃运动被极大地抑制，从而打开了一个[能隙](@entry_id:138445)，使系统呈现绝缘性。这种[能隙](@entry_id:138445)是纯粹的关联效应。

然而，在一个保持[晶格](@entry_id:148274)对称性的半满带 Kohn-Sham 计算中，其[有效势](@entry_id:1124192) $v_s(\mathbf{r})$ 也具有[晶格](@entry_id:148274)的完全周期性。根据[能带理论](@entry_id:139801)，这样的无相互作用（或有效单粒子）系统必然是金属，其 KS [能隙](@entry_id:138445)为零。那么，真实的[能隙](@entry_id:138445)从何而来？在精确的 DFT 理论中，这个[能隙](@entry_id:138445)完全来自于交换关联势在整数粒子数上的**[导数不连续性](@entry_id:136336)**（derivative discontinuity）$\Delta_{xc}$。即，真实的基本[能隙](@entry_id:138445) $E_g$ 等于 KS [能隙](@entry_id:138445)（在此为零）加上这个不连续项：$E_g = E_g^{\text{KS}} + \Delta_{xc} = \Delta_{xc}$。

半局域泛函，由于其对密度（或其梯度）的光滑依赖性，无法描述这种[不连续性](@entry_id:144108)，导致 $\Delta_{xc} \approx 0$。因此，它们错误地预测[莫特绝缘体](@entry_id:140685)为金属。这种失败的根源在于，一个由单个[斯莱特行列式](@entry_id:139034)描述的 KS 系统，需要一个极其复杂的、高度非局域的 $E_{xc}$ 泛函才能捕捉到真实莫特基态所具有的强多[参考态](@entry_id:151465)特征（即对双重占据的抑制）。半局域泛函远不足以完成这一艰巨的映射任务，从而导致了定性上的失败。