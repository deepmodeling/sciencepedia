{
    "hands_on_practices": [
        {
            "introduction": "尺度分离假设的数学基础在于均质化理论，它允许我们将具有快速空间变化的微观物理定律转化为一个更简单的宏观有效模型。双尺度渐近展开是实现这一目标的核心数学工具。本练习将引导您亲手实践这一过程，为一个经典的周期性介质中的扩散问题推导出宏观控制方程，从而揭示微观细节如何被“平均掉”以形成一个有效的宏观行为。",
            "id": "3851907",
            "problem": "考虑一个标量浓度场 $u(x,t)$ 在大小为 $L>0$ 的区域上的一维扩散，该过程由质量守恒和 Fick 定律控制。设微观扩散系数随空间呈周期性振荡，周期为 $l>0$，因此通量为 $j(x,t)=-D(x/l)\\,\\partial_x u(x,t)$，偏微分方程（PDE）为\n$$\n\\partial_t u(x,t)-\\partial_x\\!\\big(D(x/l)\\,\\partial_x u(x,t)\\big)=0,\\quad x\\in(0,L),\\ t>0.\n$$\n假设 $D(x/l)=D_0\\,d(x/l)$，其中 $D_0>0$ 是一个特征扩散系数，$d(y)$ 是其自变量 $y\\in\\mathbb{R}$ 的光滑、严格为正的 1-周期函数，且没有施加其他对称性。定义小的无量纲尺度分离参数 $\\epsilon=l/L$，并假设 $\\epsilon\\ll 1$。\n\n基于宏观尺度 $x=L\\,\\hat{x}$ 和 $t=T\\,\\hat{t}$ 进行无量纲化，其中 $T$ 是为消除无量纲化偏微分方程中显式前因子而选择的扩散时间尺度。写出得到的关于 $u^{\\epsilon}(\\hat{x},\\hat{t})$ 的无量纲方程，其中对 $\\epsilon$ 的依赖性仅通过振荡系数 $d(\\hat{x}/\\epsilon)$ 产生。\n\n然后，使用形式化的双尺度展开 $u^{\\epsilon}(\\hat{x},\\hat{t})=u_0(\\hat{x},\\hat{t})+\\epsilon\\,u_1(\\hat{x},\\hat{t},y)+\\epsilon^2\\,u_2(\\hat{x},\\hat{t},y)+\\cdots$，其中快变量为 $y=\\hat{x}/\\epsilon$，并选择 $u_1$ 在一个周期内 $y$ 的平均值为零，精确指出在展开的无量纲偏微分方程中哪些项在极限 $\\epsilon\\to 0$ 时消失，并解释它们为什么会消失。推导 $u_0(\\hat{x},\\hat{t})$ 的匀质化主阶宏观偏微分方程，并用 $d(y)$ 表示有效的无量纲扩散系数 $d_{\\mathrm{eff}}$。\n\n你的最终答案必须是 $d_{\\mathrm{eff}}$ 的单一闭式解析表达式，且不应包含任何其他量。不需要进行数值计算。",
            "solution": "首先验证问题以确保其具有科学依据、是适定的且客观的。该问题描述了在具有周期性变化的微观扩散系数的介质中的一维 Fick 扩散。这是匀质化理论中的一个经典问题，匀质化理论是应用数学和物理学中一个成熟的子领域。双尺度渐近展开法是处理此类问题的标准技术。所给信息是完整且自洽的，所有变量、函数和小参数 $\\epsilon$ 都有明确的定义。因此，该问题被认为是有效的。\n\n解答过程主要分为三个部分：无量纲化、应用双尺度渐近展开、以及推导匀质化方程和有效扩散系数。\n\n**第1部分：无量纲化**\n控制偏微分方程（PDE）为：\n$$\n\\partial_t u(x,t) - \\partial_x \\left( D(x/l) \\, \\partial_x u(x,t) \\right) = 0\n$$\n已知条件为宏观长度尺度 $L$、微观长度尺度 $l$ 和扩散系数 $D(x/l) = D_0 \\, d(x/l)$。我们引入无量纲变量 $\\hat{x}$ 和 $\\hat{t}$，使得 $x = L\\hat{x}$ 和 $t=T\\hat{t}$，其中 $T$ 是一个特征时间尺度。导数变换如下：\n$$\n\\partial_t = \\frac{\\partial \\hat{t}}{\\partial t} \\partial_{\\hat{t}} = \\frac{1}{T} \\partial_{\\hat{t}}\n$$\n$$\n\\partial_x = \\frac{\\partial \\hat{x}}{\\partial x} \\partial_{\\hat{x}} = \\frac{1}{L} \\partial_{\\hat{x}}\n$$\n将这些代入偏微分方程得到：\n$$\n\\frac{1}{T} \\partial_{\\hat{t}} u - \\frac{1}{L} \\partial_{\\hat{x}} \\left( D_0 \\, d\\left(\\frac{L\\hat{x}}{l}\\right) \\frac{1}{L} \\partial_{\\hat{x}} u \\right) = 0\n$$\n令 $\\epsilon = l/L$ 为无量纲尺度分离参数。$d$ 函数的自变量变为 $L\\hat{x}/l = \\hat{x}/\\epsilon$。方程可重排为：\n$$\n\\partial_{\\hat{t}} u = \\frac{T D_0}{L^2} \\partial_{\\hat{x}} \\left( d(\\hat{x}/\\epsilon) \\, \\partial_{\\hat{x}} u \\right)\n$$\n问题指明，选择扩散时间尺度 $T$ 以消除显式前因子。这需要将系数群设为1：\n$$\n\\frac{T D_0}{L^2} = 1 \\implies T = \\frac{L^2}{D_0}\n$$\n这是在宏观长度尺度 $L$ 上的特征扩散时间。令 $u^{\\epsilon}(\\hat{x},\\hat{t})$ 表示在这些无量纲变量下的解，则无量纲偏微分方程为：\n$$\n\\partial_{\\hat{t}} u^{\\epsilon} - \\partial_{\\hat{x}} \\left( d(\\hat{x}/\\epsilon) \\, \\partial_{\\hat{x}} u^{\\epsilon} \\right) = 0\n$$\n为记法清晰，下文我们省略帽子符号和上标 $\\epsilon$，将无量纲变量写为 $x$ 和 $t$。\n\n**第2部分：双尺度渐近展开**\n我们寻求一个形式为关于 $\\epsilon \\ll 1$ 的幂的形式化双尺度展开解：\n$$\nu(x,t) = u_0(x,t) + \\epsilon u_1(x,t,y) + \\epsilon^2 u_2(x,t,y) + \\mathcal{O}(\\epsilon^3)\n$$\n其中 $y=x/\\epsilon$ 是捕捉微观振荡的快变量。假设对于 $i \\ge 1$，$u_i(x,t,y)$ 函数在 $y$ 上是 1-周期的。假设首项 $u_0$ 与快尺度 $y$ 无关。空间导数算子必须使用链式法则进行变换，将 $x$ 和 $y$ 视为独立变量：\n$$\n\\partial_x \\rightarrow \\partial_x + \\frac{1}{\\epsilon} \\partial_y\n$$\n将展开式和变换后的导数代入无量纲偏微分方程得到：\n$$\n\\partial_t \\left( u_0 + \\epsilon u_1 + \\dots \\right) - \\left( \\partial_x + \\frac{1}{\\epsilon}\\partial_y \\right) \\left[ d(y) \\left( \\partial_x + \\frac{1}{\\epsilon}\\partial_y \\right) \\left( u_0 + \\epsilon u_1 + \\dots \\right) \\right] = 0\n$$\n我们展开微分算子，并根据 $\\epsilon$ 的幂次收集各项。\n$$\n\\partial_t u_0 + \\mathcal{O}(\\epsilon) - \\left[ \\frac{1}{\\epsilon^2}\\mathcal{L}_{yy} + \\frac{1}{\\epsilon}\\mathcal{L}_{xy} + \\mathcal{L}_{xx} \\right] (u_0 + \\epsilon u_1 + \\dots) = 0\n$$\n其中算子定义为：\n$\\mathcal{L}_{yy} = \\partial_y (d(y) \\partial_y)$\n$\\mathcal{L}_{xy} = \\partial_y (d(y) \\partial_x) + \\partial_x (d(y) \\partial_y)$\n$\\mathcal{L}_{xx} = \\partial_x (d(y) \\partial_x)$\n\n为使渐近展开有效，在 $\\epsilon$ 的每一阶收集的项必须独立地为零。“在极限 $\\epsilon \\to 0$ 时消失”的项，正是那些构成渐近层级结构中每一阶方程的项。必须首先将最奇异的项（$\\epsilon$ 的负幂次项）设为零。\n\n$\\mathcal{O}(\\epsilon^{-2})$ 阶：\n展开式中的首项是 $\\mathcal{L}_{yy} u_0 = \\partial_y(d(y)\\partial_y u_0)$。该项恒为零，因为 $u_0(x,t)$ 与快变量 $y$ 无关，所以 $\\partial_y u_0 = 0$。\n\n$\\mathcal{O}(\\epsilon^{-1})$ 阶：\n这一阶的项之和必须为零：$\\mathcal{L}_{yy} u_1 + \\mathcal{L}_{xy} u_0 = 0$。\n我们来计算这些算子：\n$\\mathcal{L}_{yy} u_1 = \\partial_y(d(y)\\partial_y u_1)$。\n$\\mathcal{L}_{xy} u_0 = \\partial_y(d(y)\\partial_x u_0) + \\partial_x(d(y)\\partial_y u_0) = \\partial_y(d(y)\\partial_x u_0)$，因为 $\\partial_y u_0=0$。\n因为 $\\partial_x u_0$ 与 $y$ 无关，这可以简化为 $(\\partial_y d(y)) \\partial_x u_0$。\n方程为 $\\partial_y(d(y)\\partial_y u_1) + (\\partial_y d(y))\\partial_x u_0 = 0$。这可以写成：\n$$\n\\partial_y \\left( d(y)\\partial_y u_1 + d(y)\\partial_x u_0 \\right) = 0\n$$\n对该方程关于 $y$ 积分得到：\n$$\nd(y)\\partial_y u_1 + d(y)\\partial_x u_0 = C_1(x,t)\n$$\n其中 $C_1(x,t)$ 是一个关于 $y$ 的积分“常数”。为确定 $C_1$，我们施加 $u_1$ 必须在 $y$ 上是周期性的条件。我们重排以求解 $\\partial_y u_1$：\n$$\n\\partial_y u_1 = \\frac{C_1(x,t)}{d(y)} - \\partial_x u_0\n$$\n为使 $u_1$ 在 $y$ 上是周期的，$\\partial_y u_1$ 在一个周期上的积分必须为零。令 $\\langle f \\rangle = \\int_0^1 f(y)dy$ 表示在 $y$ 的一个单位晶胞上的平均值。\n$$\n\\langle \\partial_y u_1 \\rangle = \\int_0^1 \\left(\\frac{C_1}{d(y)} - \\partial_x u_0\\right) dy = 0\n$$\n$C_1 \\langle d^{-1} \\rangle - \\partial_x u_0 = 0 \\implies C_1(x,t) = \\frac{\\partial_x u_0}{\\langle d^{-1} \\rangle}$。\n这将 $C_1$ 与 $u_0$ 的宏观梯度联系起来。\n\n**第3部分：匀质化方程的推导**\n我们现在处理 $\\mathcal{O}(\\epsilon^0)$ 阶方程：\n$$\n\\partial_t u_0 - \\left( \\mathcal{L}_{yy} u_2 + \\mathcal{L}_{xy} u_1 + \\mathcal{L}_{xx} u_0 \\right) = 0\n$$\n该方程包含未知的二阶修正项 $u_2$。为得到关于 $u_0$ 的闭合方程，我们应用一个可解性条件，即对整个方程在快变量 $y$ 的一个周期上进行平均。\n$$\n\\langle \\partial_t u_0 \\rangle - \\langle \\mathcal{L}_{yy} u_2 \\rangle - \\langle \\mathcal{L}_{xy} u_1 \\rangle - \\langle \\mathcal{L}_{xx} u_0 \\rangle = 0\n$$\n我们计算每一项的平均值：\n1. $\\langle \\partial_t u_0 \\rangle = \\partial_t u_0$，因为 $u_0$ 与 $y$ 无关。\n2. $\\langle \\mathcal{L}_{yy} u_2 \\rangle = \\langle \\partial_y(d(y)\\partial_y u_2) \\rangle = \\int_0^1 \\partial_y(d(y)\\partial_y u_2) dy = [d(y)\\partial_y u_2]_0^1 = 0$。由于 $d(y)$ 和 $u_2(y)$ 的周期性，该项为零。这是消除未知项 $u_2$ 的关键步骤。\n3. $\\langle \\mathcal{L}_{xy} u_1 \\rangle = \\langle \\partial_y(d\\partial_x u_1) + \\partial_x(d\\partial_y u_1) \\rangle = \\langle \\partial_y(d\\partial_x u_1) \\rangle + \\langle \\partial_x(d\\partial_y u_1) \\rangle$。第一部分因周期性而消失，$\\langle \\partial_y(d\\partial_x u_1) \\rangle = 0$。第二部分变为 $\\partial_x \\langle d\\partial_y u_1 \\rangle$。\n4. $\\langle \\mathcal{L}_{xx} u_0 \\rangle = \\langle \\partial_x(d\\partial_x u_0) \\rangle = \\partial_x \\langle d\\partial_x u_0 \\rangle = \\partial_x (\\langle d \\rangle \\partial_x u_0)$。\n\n综合这些结果，$u_0$ 的平均方程为：\n$$\n\\partial_t u_0 - \\partial_x \\langle d\\partial_y u_1 \\rangle - \\partial_x (\\langle d \\rangle \\partial_x u_0) = 0\n$$\n$$\n\\partial_t u_0 - \\partial_x \\left( \\langle d\\partial_y u_1 + d\\partial_x u_0 \\rangle \\right) = 0\n$$\n我们认出平均号内的项 $d(y)\\partial_y u_1 + d(y)\\partial_x u_0$ 就是我们之前发现等于 $C_1(x,t)$ 的量。\n$$\n\\partial_t u_0 - \\partial_x \\langle C_1(x,t) \\rangle = 0\n$$\n由于 $C_1(x,t)$ 不依赖于 $y$，它的平均值就是它本身：$\\langle C_1(x,t) \\rangle = C_1(x,t)$。\n$$\n\\partial_t u_0 - \\partial_x (C_1(x,t)) = 0\n$$\n代入 $C_1$ 的表达式：\n$$\n\\partial_t u_0 - \\partial_x \\left( \\frac{\\partial_x u_0}{\\langle d^{-1} \\rangle} \\right) = 0\n$$\n由于 $\\langle d^{-1} \\rangle = \\int_0^1 1/d(y) dy$ 是一个常数，这可以简化为：\n$$\n\\partial_t u_0 - \\frac{1}{\\langle d^{-1} \\rangle} \\partial_x^2 u_0 = 0\n$$\n这就是主阶浓度场 $u_0(x,t)$ 的匀质化宏观扩散方程。它具有一个带有常数有效扩散系数的扩散方程的标准形式。通过将其与一般形式 $\\partial_t u_0 - d_{\\mathrm{eff}} \\partial_x^2 u_0 = 0$ 进行比较，我们确定了有效的无量纲扩散系数 $d_{\\mathrm{eff}}$。\n\n有效系数是微观扩散系数分布的调和平均值：\n$$\nd_{\\mathrm{eff}} = \\frac{1}{\\langle d(y)^{-1} \\rangle} = \\frac{1}{\\int_0^1 \\frac{1}{d(y)} dy}\n$$\n这个结果对于一维串联系统是物理上直观的，其中电导（扩散系数）通过它们的倒数（电阻）来组合。",
            "answer": "$$\n\\boxed{\\frac{1}{\\int_{0}^{1} \\frac{1}{d(y)} \\, dy}}\n$$"
        },
        {
            "introduction": "当从确定性的周期性材料转向更符合实际的随机非均质材料时，尺度分离的概念就与代表性体积单元（RVE）的选取紧密相连。一个有效的RVE必须足够大，以至于其尺寸远大于材料内部的微观结构相关长度，从而能准确反映材料的整体统计特性。本练习将理论付诸实践，指导您如何基于微观结构的统计信息（如相关长度）和可接受的误差容限，来估算获得可靠有效模量所需的最小RVE尺寸。",
            "id": "3851880",
            "problem": "考虑一个空间维度为 $d \\in \\mathbb{N}$ 的统计均匀且各向同性的微观结构，其局部标量弹性模量场 $E(\\mathbf{x})$ 被建模为一个均值为 $\\mu$、方差为 $\\sigma^{2}$ 的平稳遍历随机场。假设其两点协方差函数仅依赖于分离距离，并按如下形式呈指数衰减\n$$\nC(|\\mathbf{x}-\\mathbf{y}|) \\equiv \\operatorname{Cov}(E(\\mathbf{x}),E(\\mathbf{y})) = \\sigma^{2} \\exp\\!\\left(-\\frac{|\\mathbf{x}-\\mathbf{y}|}{\\ell_{c}}\\right),\n$$\n其中 $\\ell_{c}$ 是相关长度。设代表性体积单元 (RVE) 域为一个半径为 $R$、体积为 $V_{d}(R)$ 的 $d$ 维球。等效模量估计量取为空间平均\n$$\n\\widehat{E}_{R} = \\frac{1}{V_{d}(R)} \\int_{|\\mathbf{x}| \\le R} E(\\mathbf{x}) \\, \\mathrm{d}\\mathbf{x}.\n$$\n根据尺度分离假设，宏观响应在远大于 $\\ell_{c}$ 的长度尺度上变化，并且当 $R \\gg \\ell_{c}$ 时，空间平均的方差由协方差结构和域尺寸控制。\n\n从空间平均方差由协方差在域上的二重积分表示的定义出发，推导在 $R/\\ell_{c} \\to \\infty$ 极限下 $\\operatorname{Var}(\\widehat{E}_{R})$ 的渐近表达式。然后，施加等效模量估计量的方差不超过指定容差水平 $\\theta > 0$ 的要求，即\n$$\n\\operatorname{Var}(\\widehat{E}_{R}) \\le \\theta,\n$$\n并确定满足此界限的最小无量纲RVE尺寸比 $r_{\\min} \\equiv R/\\ell_{c}$。\n\n将您的最终答案表示为关于 $\\sigma$、$\\theta$ 和 $d$ 的单个闭式解析表达式。无需进行数值计算或四舍五入。将 $r_{\\min}$（无量纲）作为最终答案报告。",
            "solution": "问题经过验证。\n\n步骤1：提取已知条件\n- 空间维度：$d \\in \\mathbb{N}$\n- 标量弹性模量场：$E(\\mathbf{x})$，一个平稳遍历随机场\n- 场的均值：$\\mu$\n- 场的方差：$\\sigma^2$\n- 两点协方差函数：$C(|\\mathbf{x}-\\mathbf{y}|) \\equiv \\operatorname{Cov}(E(\\mathbf{x}),E(\\mathbf{y})) = \\sigma^{2} \\exp\\!\\left(-\\frac{|\\mathbf{x}-\\mathbf{y}|}{\\ell_{c}}\\right)$\n- 相关长度：$\\ell_{c}$\n- 代表性体积单元 (RVE) 域：一个半径为 $R$ 的 $d$ 维球\n- RVE的体积：$V_{d}(R)$\n- 等效模量估计量：$\\widehat{E}_{R} = \\frac{1}{V_{d}(R)} \\int_{|\\mathbf{x}| \\le R} E(\\mathbf{x}) \\, \\mathrm{d}\\mathbf{x}$\n- 渐近条件：$R/\\ell_{c} \\to \\infty$\n- 容差约束：$\\operatorname{Var}(\\widehat{E}_{R}) \\le \\theta$，其中 $\\theta > 0$\n- 待求量：最小无量纲RVE尺寸比 $r_{\\min} \\equiv R/\\ell_{c}$\n\n步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题设定在随机力学和多尺度材料建模的既定框架内。它使用了诸如平稳随机场、遍历性、协方差函数和代表性体积单元（RVE）等标准概念。指数协方差是一个广泛使用的模型，而尺度分离假设是均匀化理论的一个基本原则。该问题具有科学合理性。\n- **适定性**：问题要求推导一个渐近表达式并求解由此产生的不等式。定义清晰，目标是找到一个特定量 $r_{\\min}$。预期会有一个唯一解。\n- **客观性**：问题以精确、客观的数学语言陈述，没有任何主观或模糊的术语。\n- **完整性**：提供了所有必要的信息。虽然没有给出 $d$ 维球的体积公式，但在此背景下，这属于标准的、假定已知的知识。要遵循的步骤是逻辑清晰的。\n- **其他缺陷**：该问题不是无关紧要、不切实际、自相矛盾或不适定的。它代表了该领域一个标准的、非平凡的计算。\n\n步骤3：结论与行动\n问题是有效的。将提供完整的解答。\n\n等效模量估计量 $\\widehat{E}_{R}$ 的方差定义为：\n$$\n\\operatorname{Var}(\\widehat{E}_{R}) = \\operatorname{Var}\\left( \\frac{1}{V_{d}(R)} \\int_{V} E(\\mathbf{x}) \\, \\mathrm{d}\\mathbf{x} \\right)\n$$\n其中 $V$ 是RVE域，一个半径为 $R$ 的 $d$ 维球。利用方差算子的性质，上式变为：\n$$\n\\operatorname{Var}(\\widehat{E}_{R}) = \\frac{1}{V_{d}(R)^2} \\operatorname{Var}\\left( \\int_{V} E(\\mathbf{x}) \\, \\mathrm{d}\\mathbf{x} \\right) = \\frac{1}{V_{d}(R)^2} \\mathbb{E}\\left[ \\left( \\int_{V} (E(\\mathbf{x})-\\mu) \\, \\mathrm{d}\\mathbf{x} \\right)^2 \\right]\n$$\n这可以写成协方差函数的二重积分：\n$$\n\\operatorname{Var}(\\widehat{E}_{R}) = \\frac{1}{V_{d}(R)^2} \\int_{V} \\int_{V} \\operatorname{Cov}(E(\\mathbf{x}), E(\\mathbf{y})) \\, \\mathrm{d}\\mathbf{x} \\, \\mathrm{d}\\mathbf{y}\n$$\n代入给定的协方差函数 $C(|\\mathbf{x}-\\mathbf{y}|)$：\n$$\n\\operatorname{Var}(\\widehat{E}_{R}) = \\frac{1}{V_{d}(R)^2} \\int_{V} \\int_{V} C(|\\mathbf{x}-\\mathbf{y}|) \\, \\mathrm{d}\\mathbf{x} \\, \\mathrm{d}\\mathbf{y}\n$$\n问题要求在 $R \\gg \\ell_{c}$ 极限下该方差的渐近表达式。在此极限下，域尺寸 $R$ 远大于随机场的相关长度 $\\ell_{c}$。协方差函数 $C(|\\mathbf{z}|)$ 在 $|\\mathbf{z}| > \\ell_{c}$ 时迅速衰减至零。这意味着二重积分主要由 $\\mathbf{x}$ 和 $\\mathbf{y}$ 彼此接近时的贡献所主导。\n二重积分可简化如下。我们引入变量替换 $\\mathbf{z} = \\mathbf{x} - \\mathbf{y}$。积分变为：\n$$\n\\int_{V} \\int_{V} C(|\\mathbf{x}-\\mathbf{y}|) \\, \\mathrm{d}\\mathbf{x} \\, \\mathrm{d}\\mathbf{y} = \\int_{\\mathbb{R}^d} C(|\\mathbf{z}|) \\left( \\int_{V \\cap (V+\\mathbf{z})} \\mathrm{d}\\mathbf{x} \\right) \\mathrm{d}\\mathbf{z}\n$$\n内层积分是域 $V$ 与其自身平移版本交集的体积，该体积是平移向量 $\\mathbf{z}$ 的函数。由于当 $|\\mathbf{z}| \\gg \\ell_{c}$ 时 $C(|\\mathbf{z}|)$ 可忽略不计，且我们处于 $R \\gg \\ell_{c}$ 的状态，因此对于相关的 $\\mathbf{z}$ 值，交集体积近似于域的完整体积 $V_d(R)$。这导出了渐近近似：\n$$\n\\operatorname{Var}(\\widehat{E}_{R}) \\approx \\frac{1}{V_{d}(R)^2} V_{d}(R) \\int_{\\mathbb{R}^d} C(|\\mathbf{z}|) \\, \\mathrm{d}\\mathbf{z} = \\frac{1}{V_{d}(R)} \\int_{\\mathbb{R}^d} C(|\\mathbf{z}|) \\, \\mathrm{d}\\mathbf{z}\n$$\n现在，我们必须计算协方差函数在 $\\mathbb{R}^d$ 上的积分：\n$$\nI_C = \\int_{\\mathbb{R}^d} \\sigma^2 \\exp\\left(-\\frac{|\\mathbf{z}|}{\\ell_c}\\right) \\, \\mathrm{d}\\mathbf{z}\n$$\n为了计算这个积分，我们切换到 $d$ 维超球坐标。设 $\\rho = |\\mathbf{z}|$。体积元为 $\\mathrm{d}\\mathbf{z} = \\rho^{d-1} \\mathrm{d}\\rho \\, \\mathrm{d}\\Omega_{d-1}$，其中 $\\mathrm{d}\\Omega_{d-1}$ 是立体角元。对立体角的积分得到单位 $(d-1)$ 维球面的表面积，$S_{d-1} = \\frac{2\\pi^{d/2}}{\\Gamma(d/2)}$。\n$$\nI_C = \\sigma^2 \\int_{S_{d-1}} \\mathrm{d}\\Omega_{d-1} \\int_{0}^{\\infty} \\exp\\left(-\\frac{\\rho}{\\ell_c}\\right) \\rho^{d-1} \\, \\mathrm{d}\\rho = \\sigma^2 S_{d-1} \\int_{0}^{\\infty} \\rho^{d-1} \\exp\\left(-\\frac{\\rho}{\\ell_c}\\right) \\, \\mathrm{d}\\rho\n$$\n剩下的径向积分可以通过换元 $u = \\rho/\\ell_c$ 来计算，因此 $\\rho = u\\ell_c$ 且 $\\mathrm{d}\\rho = \\ell_c \\mathrm{d}u$。\n$$\n\\int_{0}^{\\infty} (u\\ell_c)^{d-1} \\exp(-u) \\, (\\ell_c \\mathrm{d}u) = \\ell_c^d \\int_{0}^{\\infty} u^{d-1} \\exp(-u) \\, \\mathrm{d}u = \\ell_c^d \\Gamma(d)\n$$\n其中 $\\Gamma(d)$ 是伽马函数。\n因此，协方差的积分为：\n$$\nI_C = \\sigma^2 S_{d-1} \\ell_c^d \\Gamma(d)\n$$\n半径为 $R$ 的 $d$ 维球的体积为 $V_d(R) = \\frac{\\pi^{d/2} R^d}{\\Gamma(d/2+1)}$。我们也可以将体积与单位球的表面积联系起来：$V_d(R) = \\frac{S_{d-1}}{d}R^d$。\n将这些代入渐近方差表达式中：\n$$\n\\operatorname{Var}(\\widehat{E}_{R}) \\approx \\frac{I_C}{V_d(R)} = \\frac{\\sigma^2 S_{d-1} \\ell_c^d \\Gamma(d)}{\\frac{S_{d-1}}{d}R^d} = \\sigma^2 d \\Gamma(d) \\left(\\frac{\\ell_c}{R}\\right)^d\n$$\n这就是所需的估计量方差的渐近表达式。\n\n接下来，我们施加容差约束 $\\operatorname{Var}(\\widehat{E}_{R}) \\le \\theta$：\n$$\n\\sigma^2 d \\Gamma(d) \\left(\\frac{\\ell_c}{R}\\right)^d \\le \\theta\n$$\n我们需要求解最小尺寸比 $r = R/\\ell_c$。整理不等式：\n$$\n\\left(\\frac{R}{\\ell_c}\\right)^d \\ge \\frac{\\sigma^2 d \\Gamma(d)}{\\theta}\n$$\n由于 $R$、$\\ell_c$ 和 $d$ 均为正，我们可以对两边取 $d$ 次方根：\n$$\n\\frac{R}{\\ell_c} \\ge \\left( \\frac{\\sigma^2 d \\Gamma(d)}{\\theta} \\right)^{1/d}\n$$\n最小无量纲RVE尺寸比 $r_{\\min} = R/\\ell_c$ 是使此不等式取等号的值：\n$$\nr_{\\min} = \\left( \\frac{\\sigma^2 d \\Gamma(d)}{\\theta} \\right)^{1/d}\n$$\n这就是确保等效模量估计量的方差低于容差 $\\theta$ 的最小RVE尺寸比的最终表达式。",
            "answer": "$$\n\\boxed{\\left( \\frac{\\sigma^2 d \\Gamma(d)}{\\theta} \\right)^{1/d}}\n$$"
        },
        {
            "introduction": "在实际的多尺度计算模拟中，我们只能使用有限尺寸的代表性体积单元（RVE），这不可避免地会引入误差，即所谓的“有限尺寸效应”。本计算练习旨在通过一个具体的模型来量化这种效应，特别是展示了当RVE尺寸过小时，如何违反作为宏观与微观能量一致性基本准则的Hill-Mandel条件。通过这个实践，您可以直观地理解尺度分离假设在有限计算中被破坏时的后果，以及如何通过能量不匹配来度量这种偏差。",
            "id": "3851932",
            "problem": "构建并分析一个数学定义的微观结构模型，在运动学一致（Dirichlet）边界条件下，通过 Hill–Mandel 宏观均匀性条件直接检验尺度分离假设。考虑一个二维线性弹性介质，其刚度仅沿横向坐标 $y$ 呈光滑周期性模式变化。局部杨氏模量定义为 $E(y) = E_0 \\left[ 1 + \\alpha \\sin\\left( \\dfrac{2\\pi y}{\\ell} \\right) \\right]$，其中 $E_0$ 是一个正常数，$\\alpha$ 满足 $0 < \\alpha < 1$，$\\ell$ 是微观结构周期。宏观加载是沿 $x$ 方向指定的均匀位移梯度，使得微观轴向应变场等于施加的宏观轴向应变，即在代表性体积单元内的所有点 $(x,y)$ 都有 $\\varepsilon_{xx}(x,y) \\equiv \\varepsilon_{\\mathrm{macro}}$。角度以弧度为单位。\n\n需要使用且不可超出的基本理论包括：小应变下的线性弹性理论、无体力情况下的平衡、Hill–Mandel 宏观均匀性条件的定义以及周期性微观结构统计。根据尺度分离假设，在这种加载构型下，无限周期介质的均质化刚度 $E_{\\mathrm{eff}}$ 等于 $E(y)$ 在一个完整周期内的体积平均值，对于给定的 $E(y)$，该值简化为 $E_{\\mathrm{eff}} = E_0$，因为正弦函数在一个完整周期内的平均值为零。\n\n现在，定义一个在 $y$ 方向上高度有限为 $L_{\\mathrm{RVE}}$ 的代表性体积单元（RVE），其下边界位于 $y_0$，上边界位于 $y_0 + L_{\\mathrm{RVE}}$，其中 $y_0$ 可以取任何实数值。在施加均匀轴向应变 $\\varepsilon_{\\mathrm{macro}}$ 的 Dirichlet 边界条件下，RVE 内的微观应力场为 $\\sigma_{xx}(y) = E(y)\\,\\varepsilon_{\\mathrm{macro}}$，微观应变能密度为 $w(y) = \\dfrac{1}{2} E(y)\\,\\varepsilon_{\\mathrm{macro}}^2$，从 RVE 推断出的表观刚度是算术平均值\n$$\nE_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}}) = \\dfrac{1}{L_{\\mathrm{RVE}}} \\int_{y_0}^{y_0 + L_{\\mathrm{RVE}}} E(y)\\,dy,\n$$\n对于给定的 $E(y)$，此式可计算出闭式解。Hill–Mandel 条件要求，当尺度分离时，在任何容许的 RVE 中，宏观应力-应变功率 $\\sigma_{\\mathrm{macro}}\\,\\varepsilon_{\\mathrm{macro}}$ 必须等于微观功率的体积平均值 $\\langle \\sigma_{xx} \\varepsilon_{xx} \\rangle$。对于给定的加载条件下的无限周期介质，$\\sigma_{\\mathrm{macro}} = E_{\\mathrm{eff}}\\,\\varepsilon_{\\mathrm{macro}} = E_0\\,\\varepsilon_{\\mathrm{macro}}$，因此宏观功率为 $\\varepsilon_{\\mathrm{macro}}^2 E_0$，而有限 RVE 上的微观平均功率为 $\\varepsilon_{\\mathrm{macro}}^2 E_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}})$。当 $E_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}}) \\ne E_0$ 时，一个过小的、采用 Dirichlet 边界条件的 RVE 相对于无限周期介质，预期会违反 Hill-Mandel 条件。\n\n您的任务是编写一个完整、可运行的程序，对于指定的参数值，计算因使用尺寸过小的、采用 Dirichlet 边界条件的 RVE 而导致的有效刚度估计的相对偏差，并同时量化相对于无限周期介质的 Hill-Mandel 条件违反程度。每个测试案例需要计算的量是：\n- 相对偏差\n$$\n\\mathrm{bias}(y_0, L_{\\mathrm{RVE}}) = \\dfrac{E_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}}) - E_0}{E_0}.\n$$\n- 归一化的 Hill–Mandel 能量不匹配度量\n$$\n\\Delta_{\\mathrm{HM}}(y_0, L_{\\mathrm{RVE}}) = \\dfrac{\\left| \\varepsilon_{\\mathrm{macro}}^2 E_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}}) - \\varepsilon_{\\mathrm{macro}}^2 E_0 \\right|}{\\varepsilon_{\\mathrm{macro}}^2 E_0} = \\left| \\mathrm{bias}(y_0, L_{\\mathrm{RVE}}) \\right|.\n$$\n\n所有输出必须是无量纲的十进制数。使用以下科学上合理且一致的参数值：\n- $E_0 = 8.0 \\times 10^{10}$ （隐含单位为帕斯卡，不在输出中使用），\n- $\\alpha = 0.6$，\n- $\\ell = 1.0$ （隐含单位为毫米，不在输出中使用），\n- $\\varepsilon_{\\mathrm{macro}} = 0.01$。\n\n计算所需的 $E_{\\mathrm{app}}$ 的解析表达式可直接通过对正弦项积分得到：\n$$\nE_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}}) = E_0 \\left[ 1 + \\alpha \\cdot \\dfrac{1}{L_{\\mathrm{RVE}}} \\int_{y_0}^{y_0 + L_{\\mathrm{RVE}}} \\sin\\left( \\dfrac{2\\pi y}{\\ell} \\right) dy \\right]\n= E_0 \\left[ 1 + \\alpha \\cdot \\dfrac{1}{k L_{\\mathrm{RVE}}} \\left( \\cos(k y_0) - \\cos(k(y_0 + L_{\\mathrm{RVE}})) \\right) \\right],\n$$\n其中 $k = \\dfrac{2\\pi}{\\ell}$，角度以弧度为单位。\n\n实施该程序以评估以下测试套件，这些测试案例旨在探究正常路径、偏差极值、混叠效应以及近渐近尺度分离：\n- 案例 1：$L_{\\mathrm{RVE}} = \\ell$，$y_0 = 0$。\n- 案例 2：$L_{\\mathrm{RVE}} = 0.25\\,\\ell$，$y_0 = 0$。\n- 案例 3：$L_{\\mathrm{RVE}} = 0.25\\,\\ell$，$y_0 = 0.5\\,\\ell$。\n- 案例 4：$L_{\\mathrm{RVE}} = 0.5\\,\\ell$，$y_0 = 0.1\\,\\ell$。\n- 案例 5：$L_{\\mathrm{RVE}} = 5\\,\\ell$，$y_0 = 0.3\\,\\ell$。\n\n您的程序应生成单行输出，其中包含一个列表的列表，每个内部列表对应一个测试案例，并包含两个十进制数：该案例的相对偏差和归一化的 Hill-Mandel 能量不匹配度量。确切的输出格式必须是打印为单行、由方括号括起的逗号分隔列表，其中每个包含两个元素的内部列表也由方括号括起，例如：“[[b1,d1],[b2,d2],...]”，其中 $b_i$ 和 $d_i$ 是案例 $i$ 的十进制数。",
            "solution": "该问题要求在多尺度材料模拟的框架内分析尺度分离假设。具体来说，我们要量化使用有限尺寸的代表性体积单元（RVE）和运动学一致（Dirichlet）边界条件所引入的误差，并与无限周期介质的行为进行比较。该误差通过表观刚度和相关的 Hill-Mandel 宏观均匀性条件的违反程度来衡量。\n\n所考虑的材料是一种二维线性弹性介质，其杨氏模量 $E$ 沿一个坐标 $y$ 周期性变化。刚度由以下函数给出：\n$$E(y) = E_0 \\left[ 1 + \\alpha \\sin\\left( \\frac{2\\pi y}{\\ell} \\right) \\right]$$\n其中 $E_0$ 是平均刚度，$\\alpha$ 是刚度波动的幅度（$0 < \\alpha < 1$），$\\ell$ 是微观结构周期。\n\n根据尺度分离假设，无限介质的有效刚度 $E_{\\mathrm{eff}}$ 是微观刚度在一个周期内的体积平均值。对于给定的 $E(y)$，正弦项在一个周期 $\\ell$ 上的积分消失，得到：\n$$E_{\\mathrm{eff}} = \\frac{1}{\\ell} \\int_{0}^{\\ell} E_0 \\left[ 1 + \\alpha \\sin\\left( \\frac{2\\pi y}{\\ell} \\right) \\right] dy = E_0$$\n\n当分析一个高度为 $L_{\\mathrm{RVE}}$、从 $y_0$ 延伸到 $y_0 + L_{\\mathrm{RVE}}$ 的有限 RVE 时，表观刚度 $E_{\\mathrm{app}}$ 定义为 $E(y)$ 在此有限域上的算术平均值。问题陈述指出，对于指定的均匀应变加载 $\\varepsilon_{xx} = \\varepsilon_{\\mathrm{macro}}$，该平均值由下式给出：\n$$E_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}}) = \\frac{1}{L_{\\mathrm{RVE}}} \\int_{y_0}^{y_0 + L_{\\mathrm{RVE}}} E(y) \\, dy$$\n代入 $E(y)$ 的表达式并进行积分，可得到提供的解析公式。令 $k = 2\\pi/\\ell$。\n$$E_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}}) = \\frac{E_0}{L_{\\mathrm{RVE}}} \\int_{y_0}^{y_0 + L_{\\mathrm{RVE}}} \\left[ 1 + \\alpha \\sin(ky) \\right] dy$$\n$$E_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}}) = \\frac{E_0}{L_{\\mathrm{RVE}}} \\left[ y - \\frac{\\alpha}{k} \\cos(ky) \\right]_{y_0}^{y_0 + L_{\\mathrm{RVE}}}$$\n$$E_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}}) = \\frac{E_0}{L_{\\mathrm{RVE}}} \\left[ (y_0 + L_{\\mathrm{RVE}} - y_0) - \\frac{\\alpha}{k} (\\cos(k(y_0 + L_{\\mathrm{RVE}})) - \\cos(ky_0)) \\right]$$\n$$E_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}}) = E_0 \\left[ 1 + \\frac{\\alpha}{k L_{\\mathrm{RVE}}} (\\cos(ky_0) - \\cos(k(y_0 + L_{\\mathrm{RVE}}))) \\right]$$\n这证实了问题陈述中提供的闭式表达式。\n\n第一个要计算的量是相对偏差 $\\mathrm{bias}$，它衡量表观刚度与真实有效刚度 $E_0$ 的偏离程度：\n$$\\mathrm{bias}(y_0, L_{\\mathrm{RVE}}) = \\frac{E_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}}) - E_0}{E_0}$$\n通过代入 $E_{\\mathrm{app}}$ 的表达式，我们可以推导出与 $E_0$ 无关的偏差简化公式：\n$$\\mathrm{bias}(y_0, L_{\\mathrm{RVE}}) = \\frac{E_0 \\left[ 1 + \\frac{\\alpha}{k L_{\\mathrm{RVE}}} (\\cos(ky_0) - \\cos(k(y_0 + L_{\\mathrm{RVE}}))) \\right] - E_0}{E_0}$$\n$$\\mathrm{bias}(y_0, L_{\\mathrm{RVE}}) = \\frac{\\alpha}{k L_{\\mathrm{RVE}}} \\left( \\cos(ky_0) - \\cos(k(y_0 + L_{\\mathrm{RVE}})) \\right)$$\n这是我们计算的核心表达式。\n\n第二个量是归一化的 Hill–Mandel 能量不匹配度量 $\\Delta_{\\mathrm{HM}}$。这量化了对宏观均匀性条件的违反程度，该条件要求平均微观功密度等于宏观功密度。如果我们考虑平均应力 $\\langle \\sigma_{xx} \\rangle = E_{\\mathrm{app}}\\varepsilon_{\\mathrm{macro}}$，功密度分别为 $\\frac{1}{2} E_{\\mathrm{app}} \\varepsilon_{\\mathrm{macro}}^2$ 和 $\\frac{1}{2} E_{\\mathrm{eff}} \\varepsilon_{\\mathrm{macro}}^2$。问题基于功率（与能量密度成正比）定义了这种不匹配，并由宏观功率 $\\varepsilon_{\\mathrm{macro}}^2 E_0$ 进行归一化：\n$$\\Delta_{\\mathrm{HM}}(y_0, L_{\\mathrm{RVE}}) = \\frac{\\left| \\varepsilon_{\\mathrm{macro}}^2 E_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}}) - \\varepsilon_{\\mathrm{macro}}^2 E_0 \\right|}{\\varepsilon_{\\mathrm{macro}}^2 E_0}$$\n$\\varepsilon_{\\mathrm{macro}}^2$ 项相互抵消，揭示了 $\\Delta_{\\mathrm{HM}}$ 与偏差之间的直接关系：\n$$\\Delta_{\\mathrm{HM}}(y_0, L_{\\mathrm{RVE}}) = \\frac{\\left| E_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}}) - E_0 \\right|}{E_0} = \\left| \\frac{E_{\\mathrm{app}}(y_0, L_{\\mathrm{RVE}}) - E_0}{E_0} \\right| = \\left| \\mathrm{bias}(y_0, L_{\\mathrm{RVE}}) \\right|$$\n因此，一旦知道了偏差，$\\Delta_{\\mathrm{HM}}$ 的计算就变得很简单。\n\n计算步骤如下：\n1.  定义物理常数 $\\alpha = 0.6$ 和 $\\ell = 1.0$。\n2.  计算波数 $k = 2\\pi/\\ell$。\n3.  对于由 $(y_0, L_{\\mathrm{RVE}})$ 指定的每个测试案例：\n    a. 使用推导出的公式计算偏差：$\\mathrm{bias} = \\frac{\\alpha}{k L_{\\mathrm{RVE}}} (\\cos(ky_0) - \\cos(k(y_0 + L_{\\mathrm{RVE}})))$。\n    b. 计算 Hill-Mandel 不匹配度为 $\\Delta_{\\mathrm{HM}} = |\\mathrm{bias}|$。\n4.  收集所有测试案例的 $[\\mathrm{bias}, \\Delta_{\\mathrm{HM}}]$ 对。\n5.  将结果格式化为指定的字符串格式 \"[[b1,d1],[b2,d2],...]\"。\n\n此分析直接探究了向均质化极限的收敛过程。当 $L_{\\mathrm{RVE}} \\to \\infty$ 时，$1/(kL_{\\mathrm{RVE}})$ 项占主导地位，迫使 $\\mathrm{bias} \\to 0$，这展示了尺度分离原理。$L_{\\mathrm{RVE}}$ 是 $\\ell$ 的整数倍的测试案例（案例1和案例5）将具有零偏差，因为正弦函数在任意整数个完整周期上的积分都为零，而与起始点 $y_0$ 无关。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative bias and Hill-Mandel mismatch for a\n    periodic microstructural model under Dirichlet boundary conditions.\n    \"\"\"\n    \n    # Define the physical parameters from the problem statement.\n    # Note: E_0 and epsilon_macro are not needed for the final computation\n    # as they cancel out in the dimensionless quantities.\n    alpha = 0.6\n    ell = 1.0\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple (L_RVE, y_0).\n    test_cases = [\n        # Case 1: L_RVE = l, y_0 = 0.\n        (1.0 * ell, 0.0),\n        # Case 2: L_RVE = 0.25*l, y_0 = 0.\n        (0.25 * ell, 0.0),\n        # Case 3: L_RVE = 0.25*l, y_0 = 0.5*l.\n        (0.25 * ell, 0.5 * ell),\n        # Case 4: L_RVE = 0.5*l, y_0 = 0.1*l.\n        (0.5 * ell, 0.1 * ell),\n        # Case 5: L_RVE = 5*l, y_0 = 0.3*l.\n        (5.0 * ell, 0.3 * ell),\n    ]\n\n    results = []\n    \n    # Calculate angular wavenumber k\n    k = 2 * np.pi / ell\n    \n    for L_RVE, y_0 in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        \n        # The core expression for bias is:\n        # bias = (alpha / (k * L_RVE)) * (cos(k*y0) - cos(k*(y0 + L_RVE)))\n        \n        # Handle the case where L_RVE is an integer multiple of the period ell.\n        # In this situation, the integral of the sine term over the RVE is zero,\n        # leading to a zero bias. This avoids potential floating point inaccuracies.\n        # k * L_RVE = (2*pi/ell) * (n*ell) = 2*pi*n.\n        # cos(k*y0) - cos(k*y0 + 2*pi*n) = cos(k*y0) - cos(k*y0) = 0.\n        # A small tolerance is used to check for integer multiples.\n        if np.isclose(L_RVE / ell, round(L_RVE / ell)):\n             bias = 0.0\n        else:\n             arg1 = k * y_0\n             arg2 = k * (y_0 + L_RVE)\n             cos_diff = np.cos(arg1) - np.cos(arg2)\n             bias = (alpha / (k * L_RVE)) * cos_diff\n\n        # The normalized Hill-Mandel energy-mismatch measure is the absolute value of the bias.\n        delta_hm = np.abs(bias)\n        \n        results.append([bias, delta_hm])\n\n    # Format the final output string as per the problem specification.\n    # Ex: [[b1,d1],[b2,d2],...]\n    results_str_list = [f\"[{b},{d}]\" for b, d in results]\n    output_str = f\"[{','.join(results_str_list)}]\"\n\n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}