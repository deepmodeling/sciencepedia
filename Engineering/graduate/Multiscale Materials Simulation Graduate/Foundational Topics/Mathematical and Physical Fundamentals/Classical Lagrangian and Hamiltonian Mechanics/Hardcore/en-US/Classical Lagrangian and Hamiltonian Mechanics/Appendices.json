{
    "hands_on_practices": [
        {
            "introduction": "Mastering Lagrangian and Hamiltonian mechanics begins with a firm grasp of its foundational procedures. This exercise guides you through the complete derivation for a simple pendulum, a cornerstone model in physics that serves as an excellent proxy for coarse-grained rotational degrees of freedom in materials simulation . By starting from Cartesian coordinates and systematically applying the principles of stationary action and the Legendre transformation, you will not only derive the equations of motion but also see how this elegant formalism connects back to and simplifies Newtonian analysis.",
            "id": "3814041",
            "problem": "A coarse-grained element in multiscale materials simulation can often be represented by a single rotational degree of freedom subjected to a holonomic constraint. Consider a planar pendulum of length $l$ and mass $m$ attached to a frictionless pivot in a uniform gravitational field of magnitude $g$. The bob moves in a vertical plane, and the configuration can be described by the generalized coordinate $\\theta$, defined as the angle between the rod and the downward vertical. Take the zero of potential energy at the lowest point of the swing. Assume the rod is massless and rigid and the bob is a point mass.\n\nUsing only fundamental principles, namely Newton's second law, the definition of kinetic energy, holonomic constraints, the definition of generalized coordinates, and the principle of stationary action, carry out the following tasks:\n- Express the Cartesian coordinates of the bob as functions of $\\theta$ and $l$, and use time differentiation to obtain the velocity components.\n- Construct the kinetic energy $T$ and potential energy $U$ from these kinematic relations.\n- Form the Lagrangian $L = T - U$ in terms of $\\theta$ and $\\dot{\\theta}$.\n- Derive the equation of motion by applying the Euler–Lagrange equation to $L$.\n- Define the canonical momentum $p_{\\theta}$ and construct the Hamiltonian $H$ by a Legendre transform. Show that Hamilton's equations reproduce the same equation of motion obtained from the Euler–Lagrange equation and are equivalent to the tangential component of Newton's second law once the tension constraint force is eliminated.\n\nFor grading, report only the Lagrangian $L(\\theta,\\dot{\\theta})$ you obtain as a single closed-form expression. Do not include units inside the final boxed answer. If you choose to introduce any numerical constants, they must be exact; no rounding is required or permitted.",
            "solution": "The problem statement has been validated and is deemed sound. It presents a standard exercise in classical mechanics, specifically the application of Lagrangian and Hamiltonian formalisms to a simple pendulum. The givens are complete, consistent, and scientifically grounded. We may proceed with a full derivation.\n\nThe problem requires a systematic derivation starting from Cartesian coordinates and fundamental principles, leading to the Lagrangian, the equation of motion via the Euler-Lagrange equation, and a parallel derivation using the Hamiltonian formalism.\n\nLet us establish a coordinate system where the frictionless pivot is at the origin $(0, 0)$. We align the y-axis with the downward vertical direction and the x-axis horizontally. The generalized coordinate $\\theta$ is the angle the rod makes with this downward vertical y-axis.\n\n**1. Cartesian Coordinates and Velocity**\n\nThe position of the bob of mass $m$ at the end of the rod of length $l$ is given by its Cartesian coordinates $(x, y)$. From the geometric definition of $\\theta$:\n$$x(\\theta) = l \\sin(\\theta)$$\n$$y(\\theta) = l \\cos(\\theta)$$\nTo find the velocity components, we differentiate these expressions with respect to time $t$, using the chain rule ($\\dot{\\theta} = \\frac{d\\theta}{dt}$):\n$$\\dot{x} = \\frac{dx}{dt} = \\frac{d}{dt}(l \\sin(\\theta)) = l \\cos(\\theta) \\dot{\\theta}$$\n$$\\dot{y} = \\frac{dy}{dt} = \\frac{d}{dt}(l \\cos(\\theta)) = -l \\sin(\\theta) \\dot{\\theta}$$\n\n**2. Kinetic and Potential Energy**\n\nThe kinetic energy $T$ is given by $T = \\frac{1}{2} m v^2$, where $v^2 = \\dot{x}^2 + \\dot{y}^2$. Substituting the velocity components:\n$$T = \\frac{1}{2} m ( (l \\cos(\\theta) \\dot{\\theta})^2 + (-l \\sin(\\theta) \\dot{\\theta})^2 )$$\n$$T = \\frac{1}{2} m ( l^2 \\cos^2(\\theta) \\dot{\\theta}^2 + l^2 \\sin^2(\\theta) \\dot{\\theta}^2 )$$\n$$T = \\frac{1}{2} m l^2 \\dot{\\theta}^2 (\\cos^2(\\theta) + \\sin^2(\\theta))$$\nUsing the trigonometric identity $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$, the kinetic energy simplifies to:\n$$T(\\dot{\\theta}) = \\frac{1}{2} m l^2 \\dot{\\theta}^2$$\nThe potential energy $U$ is due to the uniform gravitational field of magnitude $g$. The gravitational force is $\\vec{F}_g = m\\vec{g}$. In our coordinate system, $\\vec{g}$ points in the positive y-direction, so the force is $(0, mg)$. The potential energy $U$ is defined such that $\\vec{F}_g = -\\nabla U$. This gives $U = -mgy + C$, where $C$ is a constant of integration.\nThe problem specifies that the zero of potential energy is at the lowest point of the swing. This occurs when $\\theta = 0$, which corresponds to the position $y = l \\cos(0) = l$.\nSetting $U=0$ at $y=l$:\n$$0 = -mg(l) + C \\implies C = mgl$$\nThus, the potential energy as a function of $y$ is $U(y) = mg(l-y)$. Substituting $y = l \\cos(\\theta)$, we obtain the potential energy as a function of the generalized coordinate $\\theta$:\n$$U(\\theta) = mg(l - l \\cos(\\theta)) = mgl(1 - \\cos(\\theta))$$\n\n**3. Lagrangian Formulation**\n\nThe Lagrangian $L$ is defined as $L = T - U$.\n$$L(\\theta, \\dot{\\theta}) = \\frac{1}{2} m l^2 \\dot{\\theta}^2 - mgl(1 - \\cos(\\theta))$$\nThis is the required expression for the Lagrangian.\n\n**4. Euler-Lagrange Equation of Motion**\n\nThe equation of motion is derived from the Euler-Lagrange equation for the coordinate $\\theta$:\n$$\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{\\theta}}\\right) - \\frac{\\partial L}{\\partial \\theta} = 0$$\nWe compute the required partial derivatives:\n$$\\frac{\\partial L}{\\partial \\dot{\\theta}} = \\frac{\\partial}{\\partial \\dot{\\theta}} \\left( \\frac{1}{2} m l^2 \\dot{\\theta}^2 - mgl(1 - \\cos(\\theta)) \\right) = m l^2 \\dot{\\theta}$$\n$$\\frac{\\partial L}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left( \\frac{1}{2} m l^2 \\dot{\\theta}^2 - mgl(1 - \\cos(\\theta)) \\right) = -mgl(0 - (-\\sin(\\theta))) = -mgl \\sin(\\theta)$$\nSubstituting these into the Euler-Lagrange equation:\n$$\\frac{d}{dt}(m l^2 \\dot{\\theta}) - (-mgl \\sin(\\theta)) = 0$$\n$$m l^2 \\ddot{\\theta} + mgl \\sin(\\theta) = 0$$\nDividing by $ml^2$ (since $m \\neq 0$ and $l \\neq 0$) yields the equation of motion:\n$$\\ddot{\\theta} + \\frac{g}{l} \\sin(\\theta) = 0$$\n\n**5. Hamiltonian Formulation**\n\nFirst, we define the canonical momentum $p_{\\theta}$ conjugate to the coordinate $\\theta$:\n$$p_{\\theta} = \\frac{\\partial L}{\\partial \\dot{\\theta}} = m l^2 \\dot{\\theta}$$\nThe Hamiltonian $H$ is constructed via the Legendre transformation of the Lagrangian: $H = p_{\\theta}\\dot{\\theta} - L$. To express $H$ as a function of the phase space variables $(\\theta, p_{\\theta})$, we must eliminate $\\dot{\\theta}$. From the definition of $p_{\\theta}$, we have $\\dot{\\theta} = \\frac{p_{\\theta}}{ml^2}$.\n$$H = p_{\\theta}\\left(\\frac{p_{\\theta}}{ml^2}\\right) - \\left( \\frac{1}{2} m l^2 \\left(\\frac{p_{\\theta}}{ml^2}\\right)^2 - mgl(1 - \\cos(\\theta)) \\right)$$\n$$H = \\frac{p_{\\theta}^2}{ml^2} - \\left( \\frac{1}{2} m l^2 \\frac{p_{\\theta}^2}{m^2 l^4} - mgl(1 - \\cos(\\theta)) \\right)$$\n$$H = \\frac{p_{\\theta}^2}{ml^2} - \\frac{p_{\\theta}^2}{2ml^2} + mgl(1 - \\cos(\\theta))$$\n$$H(\\theta, p_{\\theta}) = \\frac{p_{\\theta}^2}{2ml^2} + mgl(1 - \\cos(\\theta))$$\nNote that $H = T+U$, which is the total energy of the system.\n\n**6. Hamilton's Equations and Equivalence**\n\nHamilton's equations of motion are:\n$$\\dot{\\theta} = \\frac{\\partial H}{\\partial p_{\\theta}} \\quad \\text{and} \\quad \\dot{p}_{\\theta} = -\\frac{\\partial H}{\\partial \\theta}$$\nLet's compute these:\n$$\\dot{\\theta} = \\frac{\\partial}{\\partial p_{\\theta}} \\left( \\frac{p_{\\theta}^2}{2ml^2} + mgl(1 - \\cos(\\theta)) \\right) = \\frac{2p_{\\theta}}{2ml^2} = \\frac{p_{\\theta}}{ml^2}$$\nThis recovers the definition of the canonical momentum, $p_{\\theta} = m l^2 \\dot{\\theta}$.\n$$\\dot{p}_{\\theta} = -\\frac{\\partial}{\\partial \\theta} \\left( \\frac{p_{\\theta}^2}{2ml^2} + mgl(1 - \\cos(\\theta)) \\right) = -mgl(0 - (-\\sin(\\theta))) = -mgl \\sin(\\theta)$$\nTo obtain the second-order differential equation for $\\theta$, we differentiate $p_{\\theta} = ml^2 \\dot{\\theta}$ with respect to time, yielding $\\dot{p}_{\\theta} = ml^2 \\ddot{\\theta}$. Equating the two expressions for $\\dot{p}_{\\theta}$:\n$$ml^2 \\ddot{\\theta} = -mgl \\sin(\\theta)$$\n$$ml^2 \\ddot{\\theta} + mgl \\sin(\\theta) = 0 \\implies \\ddot{\\theta} + \\frac{g}{l} \\sin(\\theta) = 0$$\nThis is identical to the equation of motion derived from the Lagrangian formalism.\n\nFinally, we show its equivalence to the tangential component of Newton's second law, $\\vec{F}_{\\text{net}} = m\\vec{a}$.\nThe forces are tension $\\vec{F}_T$ (radial, towards the pivot) and gravity $\\vec{F}_g = (0, mg)$. In a polar basis $(\\hat{r}, \\hat{\\theta})$ centered at the pivot, with $\\hat{r}$ pointing from pivot to mass, $\\vec{F}_T = -|\\vec{F}_T|\\hat{r}$ and $\\vec{F}_g = (mg\\cos\\theta)\\hat{r} - (mg\\sin\\theta)\\hat{\\theta}$.\nThe acceleration in this basis for circular motion at radius $l$ is $\\vec{a} = -l\\dot{\\theta}^2\\hat{r} + l\\ddot{\\theta}\\hat{\\theta}$.\nThe tangential component of $\\vec{F}_{\\text{net}} = m\\vec{a}$ is $F_{\\text{net},\\theta} = m a_{\\theta}$.\nThe tension force $\\vec{F}_T$ is purely radial, so it has no tangential component. The tangential component of gravity is $-mg\\sin\\theta$.\nTherefore, we have:\n$$-mg\\sin\\theta = m(l\\ddot{\\theta})$$\n$$ml\\ddot{\\theta} + mg\\sin\\theta = 0 \\implies \\ddot{\\theta} + \\frac{g}{l}\\sin(\\theta) = 0$$\nThis confirms that the Lagrangian and Hamiltonian formalisms correctly reproduce Newton's law for the unconstrained degree of freedom, automatically eliminating the constraint force of tension.\nThe final task is to report the Lagrangian.",
            "answer": "$$\\boxed{\\frac{1}{2} m l^2 \\dot{\\theta}^2 - mgl(1 - \\cos(\\theta))}$$"
        },
        {
            "introduction": "The power of Lagrangian mechanics truly shines in handling constrained systems, but this requires a careful understanding of virtual displacements. This practice uses a bead on a circular track—a model for constrained particle motion at the mesoscale—to explore common conceptual pitfalls and clarify the crucial role of admissible variations as dictated by d'Alembert's principle . Analyzing this system will deepen your understanding of why constraint forces are handled so elegantly and correctly within the Lagrangian and Hamiltonian frameworks, either by restricting variations or by using Lagrange multipliers.",
            "id": "3796150",
            "problem": "In multiscale materials simulation, coarse-grained constraints are routinely imposed to eliminate fast internal modes while retaining essential collective dynamics. Consider a coarse-grained bead of mass $m$ representing a mesoscale inclusion moving in a plane under a uniform body force that mimics gravity, with magnitude $mg$ directed along the negative $y$-axis. The bead is constrained to a fixed circular track of radius $R$ centered at the origin, modeling a rigid pore cross-section at the mesoscale. Let the position be parametrized by polar coordinates with $x = r \\cos \\theta$, $y = r \\sin \\theta$. The kinetic energy is $T = \\tfrac{1}{2} m (\\dot{r}^2 + r^2 \\dot{\\theta}^2)$ and the potential energy is $V = mg y = mg r \\sin \\theta$, so the unconstrained Lagrangian is $L = T - V$. The holonomic constraint can be written either as $C_1(\\mathbf{r}) = r - R = 0$ or equivalently $C_2(\\mathbf{r}) = \\mathbf{r} \\cdot \\mathbf{r} - R^2 = 0$.\n\nJean le Rond d'Alembert's principle (d'Alembert) states that for ideal constraints the total virtual work of the applied forces and the inertial forces vanishes for any admissible virtual displacement consistent with the constraints. In Hamilton's principle, constraints may be enforced either by restricting variations to the constraint manifold (admissible variations) or by introducing Lagrange multipliers.\n\nA common pitfall is to treat virtual displacements as arbitrary and simultaneously assert that ideal constraint forces do no virtual work for all such displacements. Your task is to use this bead-on-a-circle system as a counterexample to analyze the consequences of that pitfall, and to explain how admissible variations enforce the correct coarse-grained dynamics in this constrained system.\n\nWhich of the following statements are correct?\n\nA. If one allows arbitrary virtual displacements and further requires that the ideal constraint reaction $\\mathbf{N}$ does no virtual work for all such variations, i.e., $\\mathbf{N} \\cdot \\delta \\mathbf{r} = 0$ for every $\\delta \\mathbf{r}$, then it follows that $\\mathbf{N} = \\mathbf{0}$. This conclusion is inconsistent with the need for centripetal acceleration in circular motion and therefore demonstrates that the approach is incorrect.\n\nB. Restricting virtual displacements to be tangent to the constraint manifold, which for $C_2(\\mathbf{r}) = \\mathbf{r} \\cdot \\mathbf{r} - R^2 = 0$ is the admissibility condition $\\mathbf{r} \\cdot \\delta \\mathbf{r} = 0$, yields the correct tangential equation of motion $m R^2 \\ddot{\\theta} = - m g R \\cos \\theta$, while the radial balance is provided by the nonzero constraint reaction and is not obtained from d'Alembert's principle because radial virtual displacements are inadmissible.\n\nC. In Hamilton's principle without Lagrange multipliers, performing unconstrained variations still produces the correct equations of motion as long as the endpoints satisfy the constraint; the normal reaction of the bead is determined automatically from the unconstrained extremal.\n\nD. Introducing a Lagrange multiplier $\\lambda(t)$ to enforce $r = R$ in the augmented Lagrangian $L' = L + \\lambda (r - R)$ permits arbitrary variations while yielding equations equivalent to those obtained from admissible variations; the multiplier $\\lambda$ recovers the normal constraint reaction (up to sign convention). Without such a multiplier, arbitrary variations generally produce incorrect equations in constrained systems.",
            "solution": "The problem statement is a valid exercise in classical Lagrangian mechanics, presenting a standard system to analyze the foundational principles of constrained motion. All physical quantities and mathematical expressions are correctly stated and self-consistent.\n\nThe ground truth for the equations of motion can be derived from Newton's second law, $\\mathbf{F}_{\\text{total}} = m\\mathbf{a}$. The particle is subject to an applied gravitational force $\\mathbf{F}_g = -mg\\hat{\\mathbf{j}}$ and a constraint force $\\mathbf{N}$ from the circular track. Since the track is a circle of radius $R$ centered at the origin, the constraint force must be radial: $\\mathbf{N} = N_r \\hat{\\mathbf{r}}$, where $\\hat{\\mathbf{r}}$ is the unit vector in the radial direction. The position vector is $\\mathbf{r} = R\\hat{\\mathbf{r}}$. The acceleration in polar coordinates is $\\mathbf{a} = (\\ddot{r} - r\\dot{\\theta}^2)\\hat{\\mathbf{r}} + (r\\ddot{\\theta} + 2\\dot{r}\\dot{\\theta})\\hat{\\boldsymbol{\\theta}}$. With the constraint $r=R$, we have $\\dot{r}=0$ and $\\ddot{r}=0$, so the acceleration simplifies to $\\mathbf{a} = -R\\dot{\\theta}^2\\hat{\\mathbf{r}} + R\\ddot{\\theta}\\hat{\\boldsymbol{\\theta}}$. The gravitational force can be decomposed into polar components using $\\hat{\\mathbf{j}} = \\sin\\theta\\hat{\\mathbf{r}} + \\cos\\theta\\hat{\\boldsymbol{\\theta}}$, giving $\\mathbf{F}_g = -mg(\\sin\\theta\\hat{\\mathbf{r}} + \\cos\\theta\\hat{\\boldsymbol{\\theta}})$.\n\nApplying $m\\mathbf{a} = \\mathbf{F}_g + \\mathbf{N}$:\n$$m(-R\\dot{\\theta}^2\\hat{\\mathbf{r}} + R\\ddot{\\theta}\\hat{\\boldsymbol{\\theta}}) = -mg(\\sin\\theta\\hat{\\mathbf{r}} + \\cos\\theta\\hat{\\boldsymbol{\\theta}}) + N_r\\hat{\\mathbf{r}}$$\nSeparating the vector equation into its radial ($\\hat{\\mathbf{r}}$) and tangential ($\\hat{\\boldsymbol{\\theta}}$) components yields two scalar equations:\n$1$. Radial: $-mR\\dot{\\theta}^2 = -mg\\sin\\theta + N_r \\implies N_r = mg\\sin\\theta - mR\\dot{\\theta}^2$. This equation determines the magnitude of the constraint force.\n$2$. Tangential: $mR\\ddot{\\theta} = -mg\\cos\\theta$. This is the equation of motion for the bead along the track. It can be written as $mR^2\\ddot{\\theta} = -mgR\\cos\\theta$.\n\nWith these correct equations as a benchmark, we will evaluate each statement.\n\n**A. If one allows arbitrary virtual displacements and further requires that the ideal constraint reaction $\\mathbf{N}$ does no virtual work for all such variations, i.e., $\\mathbf{N} \\cdot \\delta\\mathbf{r} = 0$ for every $\\delta \\mathbf{r}$, then it follows that $\\mathbf{N} = \\mathbf{0}$. This conclusion is inconsistent with the need for centripetal acceleration in circular motion and therefore demonstrates that the approach is incorrect.**\n\nThis statement analyzes a specific logical error. The premise is to assume that the virtual work done by the constraint force, $\\mathbf{N} \\cdot \\delta\\mathbf{r}$, is zero for *any* virtual displacement $\\delta\\mathbf{r}$, not just admissible ones. In a vector space, if the dot product of a fixed vector $\\mathbf{N}$ with an arbitrary vector $\\delta\\mathbf{r}$ is always zero, the fixed vector must be the zero vector, $\\mathbf{N} = \\mathbf{0}$. This deduction is mathematically sound.\n\nHowever, the conclusion $\\mathbf{N} = \\mathbf{0}$ is physically incorrect. As derived from Newton's laws, the constraint force is $N_r = mg\\sin\\theta - mR\\dot{\\theta}^2$. This force is generally non-zero and is responsible for providing the centripetal acceleration necessary to keep the bead on the circular path. If $\\mathbf{N}$ were zero, the bead would only be subject to gravity and would follow a parabolic trajectory, not move in a circle.\n\nThe fact that a faulty premise (requiring zero virtual work for *arbitrary* displacements) leads to a physically absurd conclusion ($\\mathbf{N} = \\mathbf{0}$) demonstrates that the premise itself is incorrect. The principle of virtual work for ideal constraints only states that $\\mathbf{N} \\cdot \\delta\\mathbf{r} = 0$ for *admissible* virtual displacements, which are those consistent with the constraints (i.e., tangent to the circular track). The statement correctly identifies this pitfall and its consequences.\n\nTherefore, statement A is **Correct**.\n\n**B. Restricting virtual displacements to be tangent to the constraint manifold, which for $C_2(\\mathbf{r}) = \\mathbf{r} \\cdot \\mathbf{r} - R^2 = 0$ is the admissibility condition $\\mathbf{r} \\cdot \\delta \\mathbf{r} = 0$, yields the correct tangential equation of motion $m R^2 \\ddot{\\theta} = - m g R \\cos \\theta$, while the radial balance is provided by the nonzero constraint reaction and is not obtained from d'Alembert's principle because radial virtual displacements are inadmissible.**\n\nThis statement describes the standard application of d'Alembert's principle with admissible variations.\nFirst, we verify the admissibility condition. A virtual displacement $\\delta\\mathbf{r}$ is admissible if it lies on the tangent space of the constraint manifold. The normal to the constraint surface $C_2(\\mathbf{r}) = \\mathbf{r} \\cdot \\mathbf{r} - R^2 = 0$ is given by $\\nabla C_2 \\propto \\mathbf{r}$. The admissibility condition is that the virtual displacement is orthogonal to the normal, i.e., $\\nabla C_2 \\cdot \\delta\\mathbf{r} = 0$, which simplifies to $\\mathbf{r} \\cdot \\delta\\mathbf{r} = 0$. This is correct. For a circle, $\\mathbf{r}$ is the radial vector, so this condition means $\\delta\\mathbf{r}$ must be purely tangential.\n\nNext, we apply d'Alembert's principle, $(m\\mathbf{a} - \\mathbf{F}_{\\text{applied}}) \\cdot \\delta\\mathbf{r} = 0$, for an admissible $\\delta\\mathbf{r} = (R\\delta\\theta)\\hat{\\boldsymbol{\\theta}}$.\n$$( (m(-R\\dot{\\theta}^2)\\hat{\\mathbf{r}} + mR\\ddot{\\theta}\\hat{\\boldsymbol{\\theta}}) - (-mg\\sin\\theta\\hat{\\mathbf{r}} - mg\\cos\\theta\\hat{\\boldsymbol{\\theta}}) ) \\cdot (R\\delta\\theta)\\hat{\\boldsymbol{\\theta}} = 0$$\nTaking the dot product, only the $\\hat{\\boldsymbol{\\theta}}$ components survive:\n$$(mR\\ddot{\\theta} + mg\\cos\\theta) (R\\delta\\theta) = 0$$\nSince this must hold for any non-zero $\\delta\\theta$, we must have $mR\\ddot{\\theta} + mg\\cos\\theta = 0$, which rearranges to $mR^2\\ddot{\\theta} = -mgR\\cos\\theta$. This is the correct tangential equation of motion.\n\nFinally, the statement asserts that the radial balance, which involves the constraint force $\\mathbf{N}$, is not obtained from this principle. This is also correct. By design, d'Alembert's principle projects the dynamics onto the space of admissible displacements, thereby eliminating the constraint forces (which are orthogonal to this space) from consideration. Radial virtual displacements ($\\delta r \\neq 0$) are inadmissible, so the principle yields no information about forces in the radial direction.\n\nTherefore, statement B is **Correct**.\n\n**C. In Hamilton's principle without Lagrange multipliers, performing unconstrained variations still produces the correct equations of motion as long as the endpoints satisfy the constraint; the normal reaction of the bead is determined automatically from the unconstrained extremal.**\n\nThis statement proposes applying unconstrained variations to the unconstrained Lagrangian, $L = \\frac{1}{2} m (\\dot{r}^2 + r^2 \\dot{\\theta}^2) - mg r \\sin \\theta$. This means treating $r$ and $\\theta$ as independent generalized coordinates. The Euler-Lagrange equations are:\nFor $r$: $\\frac{d}{dt}(\\frac{\\partial L}{\\partial \\dot{r}}) - \\frac{\\partial L}{\\partial r} = 0 \\implies m\\ddot{r} - (mr\\dot{\\theta}^2 - mg\\sin\\theta) = 0$.\nFor $\\theta$: $\\frac{d}{dt}(\\frac{\\partial L}{\\partial \\dot{\\theta}}) - \\frac{\\partial L}{\\partial \\theta} = 0 \\implies \\frac{d}{dt}(mr^2\\dot{\\theta}) - (-mgr\\cos\\theta) = 0 \\implies mr^2\\ddot{\\theta} + 2mr\\dot{r}\\dot{\\theta} + mgr\\cos\\theta = 0$.\n\nThese equations describe the motion of a particle in $2$D space under a gravitational force, they are not the equations for a particle constrained to a circle. If we try to enforce the constraint $r=R$ (and thus $\\dot{r}=0, \\ddot{r}=0$) *after* deriving these equations, we get:\nFrom the $r$ equation: $0 - mR\\dot{\\theta}^2 + mg\\sin\\theta = 0$, or $mR\\dot{\\theta}^2 = mg\\sin\\theta$. This is incorrect. It is missing the constraint force $N_r$. This equation wrongly implies that the sum of the radial component of gravity and the centrifugal term is zero.\nFrom the $\\theta$ equation: $mR^2\\ddot{\\theta} + 0 + mgR\\cos\\theta = 0$, which is the correct tangential equation.\n\nSince one of the resulting equations is incorrect, the claim that this procedure \"produces the correct equations of motion\" is false. Furthermore, this formalism has no mechanism for determining the constraint force, so the claim that \"the normal reaction ... is determined automatically\" is also false. The correct way to use Hamilton's principle without multipliers is to first substitute the constraint into the Lagrangian ($r=R, \\dot{r}=0$), which restricts the variations to be admissible from the start, as in the logic of option B.\n\nTherefore, statement C is **Incorrect**.\n\n**D. Introducing a Lagrange multiplier $\\lambda(t)$ to enforce $r = R$ in the augmented Lagrangian $L' = L + \\lambda (r - R)$ permits arbitrary variations while yielding equations equivalent to those obtained from admissible variations; the multiplier $\\lambda$ recovers the normal constraint reaction (up to sign convention). Without such a multiplier, arbitrary variations generally produce incorrect equations in constrained systems.**\n\nThis statement describes the method of Lagrange multipliers. The augmented Lagrangian is $L' = \\frac{1}{2} m (\\dot{r}^2 + r^2 \\dot{\\theta}^2) - mg r \\sin \\theta + \\lambda(t) (r-R)$. We treat $r$, $\\theta$, and $\\lambda$ as independent and apply the Euler-Lagrange equations for $r$ and $\\theta$.\nThe $\\theta$ equation is unchanged from the unconstrained case in C, as $L'$ has the same $\\theta$ dependence as $L$.\nThe $r$ equation is now: $\\frac{d}{dt}(\\frac{\\partial L'}{\\partial \\dot{r}}) - \\frac{\\partial L'}{\\partial r} = 0 \\implies m\\ddot{r} - (mr\\dot{\\theta}^2 - mg\\sin\\theta + \\lambda) = 0$.\n\nWe now enforce the constraint $r=R$ (so $\\dot{r}=0, \\ddot{r}=0$) on this system of equations:\nThe $\\theta$ equation becomes $mR^2\\ddot{\\theta} + mgR\\cos\\theta = 0$, which is the correct tangential equation of motion.\nThe $r$ equation becomes $0 - (mR\\dot{\\theta}^2 - mg\\sin\\theta + \\lambda) = 0 \\implies \\lambda = mg\\sin\\theta - mR\\dot{\\theta}^2$.\n\nComparing this expression for $\\lambda$ with the Newtonian constraint force $N_r = mg\\sin\\theta - mR\\dot{\\theta}^2$, we see that $\\lambda = N_r$. The Lagrange multiplier is precisely the force of constraint. (The sign depends on the definition of $L'$ and the constraint function, hence \"up to sign convention\" is an accurate qualifier). The method allows for arbitrary variations of $r$ and $\\theta$ at the outset and correctly yields both the equation of motion and the constraint force. The final part of the statement correctly notes that without the multiplier, this approach fails, as demonstrated in the analysis of C.\n\nTherefore, statement D is **Correct**.",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "The principles of Hamiltonian mechanics are not just theoretical constructs; they are essential for developing and analyzing the numerical algorithms used in molecular dynamics simulations. This problem bridges theory and practice by asking you to analyze the stability of the widely-used Störmer-Verlet integrator for a harmonic oscillator, a fundamental model for stiff bonded interactions in coarse-grained systems . By performing a linear stability analysis, you will determine the maximum stable timestep, a critical parameter that directly links the physical properties of the system to the feasibility of its simulation.",
            "id": "3796146",
            "problem": "In a multiscale materials simulation, consider a bonded dimer used as a coarse-grained surrogate for a stiff atomistic interaction embedded in a larger Molecular Dynamics (MD) region. The two coarse-grained sites have masses $m_{1}$ and $m_{2}$ and interact via a harmonic bonded potential with stiffness $k_{b}$ so that the fine-scale energy stored in the bond is represented by a quadratic form in the bond stretch. Model the dimer as an isolated Hamiltonian subsystem with canonical coordinates $(x_{1},p_{1})$ and $(x_{2},p_{2})$ and a Hamiltonian comprising kinetic energy of each mass and a harmonic potential depending on the bond extension $x_{2}-x_{1}$. Assume that the explicit time integration in the MD solver for this bonded interaction is performed using the Störmer–Verlet (also called velocity Verlet) symplectic scheme applied directly to the canonical equations of motion for this subsystem. Using first principles of classical Lagrangian and Hamiltonian mechanics, reformulate the dynamics in a single internal coordinate that captures the stiff bonded vibration, derive the associated linear discrete update map for the Störmer–Verlet scheme, and perform a linear stability analysis of this map by determining the amplification factors of the one-step recurrence. From this analysis, determine the largest stable timestep for explicit integration as a closed-form analytic expression in terms of $m_{1}$, $m_{2}$, and $k_{b}$.\n\nProvide only the final expression for the maximum stable timestep as your answer. You do not need to substitute numerical values or include units. Round-off instructions are not applicable.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n-   The system is a bonded dimer with two coarse-grained sites of masses $m_{1}$ and $m_{2}$.\n-   The interaction is a harmonic bonded potential with stiffness $k_{b}$.\n-   The potential energy is a quadratic form in the bond stretch.\n-   The system is modeled as an isolated Hamiltonian subsystem with canonical coordinates $(x_{1},p_{1})$ and $(x_{2},p_{2})$.\n-   The Hamiltonian consists of kinetic energy for each mass and a harmonic potential dependent on the bond extension $x_{2}-x_{1}$.\n-   Time integration is performed using the Störmer–Verlet (velocity Verlet) symplectic scheme.\n-   The task is to reformulate the dynamics into a single internal coordinate, derive the discrete update map for the Störmer–Verlet scheme, perform a linear stability analysis, and find the largest stable timestep $\\Delta t$ as a closed-form analytic expression in terms of $m_{1}$, $m_{2}$, and $k_{b}$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is a standard exercise in computational classical mechanics, specifically the analysis of numerical integrators for molecular dynamics. The model (a harmonic dimer) and the algorithm (Störmer-Verlet) are fundamental concepts in this field. The principles are well-established.\n-   **Well-Posed**: The problem is clearly defined. The parameters are given, and the objective is to find a specific quantity ($\\Delta t_{max}$) based on these parameters. A unique, stable, and meaningful solution exists.\n-   **Objective**: The language is precise and unbiased. All terms like \"harmonic potential\", \"Störmer-Verlet\", and \"linear stability analysis\" have rigorous mathematical definitions.\n-   The problem is self-contained and consistent. It does not exhibit any of the flaws listed in the validation criteria. It is directly relevant to the topic of classical mechanics within multiscale simulation.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### Solution\nThe system consists of two particles with masses $m_{1}$ and $m_{2}$ at positions $x_{1}$ and $x_{2}$. The Hamiltonian is given by\n$$\nH(x_{1}, p_{1}, x_{2}, p_{2}) = \\frac{p_{1}^{2}}{2m_{1}} + \\frac{p_{2}^{2}}{2m_{2}} + V(x_{2}-x_{1})\n$$\nwhere the potential energy $V$ is a harmonic function of the bond extension. Let the equilibrium bond length be $l_{0}$. The potential is $V = \\frac{1}{2} k_{b} (x_{2}-x_{1}-l_{0})^{2}$.\n\nThe problem of the stiff bonded vibration can be isolated by transforming to center-of-mass and relative coordinates. The center of mass is $X = \\frac{m_{1}x_{1} + m_{2}x_{2}}{m_{1}+m_{2}}$ and the relative coordinate is $q = x_{2}-x_{1}$. The motion of the center of mass is that of a free particle, as the system is isolated. The dynamics of the internal vibration are governed by the relative coordinate $q$.\n\nThe kinetic energy of the system separates into contributions from the center-of-mass motion and the relative motion:\n$$\nT = \\frac{1}{2} (m_{1}+m_{2}) \\dot{X}^{2} + \\frac{1}{2} \\mu \\dot{q}^{2}\n$$\nwhere $\\mu = \\frac{m_{1}m_{2}}{m_{1}+m_{2}}$ is the reduced mass of the dimer.\n\nThe potential energy depends only on the relative coordinate $q$. Let $r = q - l_{0}$ be the deviation of the bond length from its equilibrium value. Then $\\dot{r} = \\dot{q}$, and the potential energy is $V(r) = \\frac{1}{2}k_{b}r^{2}$. The Lagrangian for the internal vibrational degree of freedom is\n$$\nL_{r}(\\dot{r}, r) = \\frac{1}{2}\\mu \\dot{r}^{2} - \\frac{1}{2}k_{b}r^{2}\n$$\nThe Euler-Lagrange equation, $\\frac{d}{dt}\\frac{\\partial L_{r}}{\\partial \\dot{r}} - \\frac{\\partial L_{r}}{\\partial r} = 0$, yields the equation of motion for the internal vibration:\n$$\n\\mu \\ddot{r} + k_{b}r = 0\n$$\nThis is the equation for a simple harmonic oscillator, which can be written as $\\ddot{r} + \\omega_{0}^{2}r = 0$, where $\\omega_{0} = \\sqrt{\\frac{k_{b}}{\\mu}}$ is the natural frequency of the vibration.\n\nWe now analyze the stability of the Störmer-Verlet (velocity Verlet) integration scheme for this equation. Let $r_{n}$ and $v_{n}$ be the position and velocity at time $t_{n} = n\\Delta t$, where $\\Delta t$ is the timestep. The acceleration is $a_{n} = \\ddot{r}(t_{n}) = -\\omega_{0}^{2} r_{n}$. The velocity Verlet algorithm proceeds as:\n1. Update position: $r_{n+1} = r_{n} + v_{n}\\Delta t + \\frac{1}{2}a_{n}(\\Delta t)^{2}$\n2. Calculate new acceleration: $a_{n+1} = -\\omega_{0}^{2}r_{n+1}$\n3. Update velocity: $v_{n+1} = v_{n} + \\frac{1}{2}(a_{n} + a_{n+1})\\Delta t$\n\nTo perform a linear stability analysis, we express this update as a matrix transformation on the state vector $\\mathbf{z}_{n} = \\begin{pmatrix} r_{n} \\\\ v_{n} \\end{pmatrix}$.\nSubstituting $a_{n} = -\\omega_{0}^{2} r_{n}$ into the position update:\n$$\nr_{n+1} = r_{n} + v_{n}\\Delta t - \\frac{1}{2}\\omega_{0}^{2}r_{n}(\\Delta t)^{2} = \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)r_{n} + (\\Delta t)v_{n}\n$$\nSubstituting $a_{n}$ and $a_{n+1}$ into the velocity update:\n$$\nv_{n+1} = v_{n} + \\frac{1}{2}(-\\omega_{0}^{2}r_{n} - \\omega_{0}^{2}r_{n+1})\\Delta t = v_{n} - \\frac{\\omega_{0}^{2}\\Delta t}{2}(r_{n} + r_{n+1})\n$$\nNow, substitute the expression for $r_{n+1}$ into the velocity update equation:\n$$\nv_{n+1} = v_{n} - \\frac{\\omega_{0}^{2}\\Delta t}{2}\\left(r_{n} + \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)r_{n} + (\\Delta t)v_{n}\\right)\n$$\n$$\nv_{n+1} = v_{n} - \\frac{\\omega_{0}^{2}\\Delta t}{2}\\left(2 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)r_{n} - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}v_{n}\n$$\n$$\nv_{n+1} = -\\left(\\omega_{0}^{2}\\Delta t - \\frac{\\omega_{0}^{4}(\\Delta t)^{3}}{4}\\right)r_{n} + \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)v_{n}\n$$\nThe update can be written as $\\mathbf{z}_{n+1} = \\mathbf{A} \\mathbf{z}_{n}$, where $\\mathbf{A}$ is the amplification matrix (or transfer matrix):\n$$\n\\mathbf{A} = \\begin{pmatrix} 1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2} & \\Delta t \\\\ -\\omega_{0}^{2}\\Delta t \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{4}\\right) & 1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2} \\end{pmatrix}\n$$\nFor the numerical integration to be stable, the eigenvalues $\\lambda$ of the amplification matrix $\\mathbf{A}$ must have a magnitude less than or equal to one, i.e., $|\\lambda| \\leq 1$. The eigenvalues are the roots of the characteristic equation $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = 0$.\nThe characteristic equation is $\\lambda^{2} - \\mathrm{Tr}(\\mathbf{A})\\lambda + \\det(\\mathbf{A}) = 0$.\nThe trace of $\\mathbf{A}$ is:\n$$\n\\mathrm{Tr}(\\mathbf{A}) = \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right) + \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right) = 2 - \\omega_{0}^{2}(\\Delta t)^{2}\n$$\nThe determinant of $\\mathbf{A}$ is:\n$$\n\\det(\\mathbf{A}) = \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)^{2} - (\\Delta t)\\left(-\\omega_{0}^{2}\\Delta t \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{4}\\right)\\right)\n$$\n$$\n\\det(\\mathbf{A}) = 1 - \\omega_{0}^{2}(\\Delta t)^{2} + \\frac{\\omega_{0}^{4}(\\Delta t)^{4}}{4} + \\omega_{0}^{2}(\\Delta t)^{2} - \\frac{\\omega_{0}^{4}(\\Delta t)^{4}}{4} = 1\n$$\nAs expected for a symplectic integrator applied to a linear system, the determinant is $1$. The characteristic equation becomes $\\lambda^{2} - (2 - \\omega_{0}^{2}(\\Delta t)^{2})\\lambda + 1 = 0$.\nThe roots are $\\lambda_{\\pm} = \\frac{(2 - \\omega_{0}^{2}(\\Delta t)^{2}) \\pm \\sqrt{(2 - \\omega_{0}^{2}(\\Delta t)^{2})^{2} - 4}}{2}$.\nFor the magnitudes of the roots to be $|\\lambda|=1$ (neutral stability), the discriminant must be non-positive:\n$$\n(2 - \\omega_{0}^{2}(\\Delta t)^{2})^{2} - 4 \\leq 0\n$$\n$$\n(2 - \\omega_{0}^{2}(\\Delta t)^{2})^{2} \\leq 4\n$$\nTaking the square root of both sides:\n$$\n|2 - \\omega_{0}^{2}(\\Delta t)^{2}| \\leq 2\n$$\nThis inequality is equivalent to $-2 \\leq 2 - \\omega_{0}^{2}(\\Delta t)^{2} \\leq 2$.\nThe right-hand side inequality, $2 - \\omega_{0}^{2}(\\Delta t)^{2} \\leq 2$, implies $-\\omega_{0}^{2}(\\Delta t)^{2} \\leq 0$, which is always true.\nThe left-hand side inequality, $-2 \\leq 2 - \\omega_{0}^{2}(\\Delta t)^{2}$, implies $\\omega_{0}^{2}(\\Delta t)^{2} \\leq 4$.\nSince $\\omega_{0}$ and $\\Delta t$ are positive, this gives the stability condition:\n$$\n\\omega_{0} \\Delta t \\leq 2\n$$\nThe largest stable timestep $\\Delta t_{max}$ is thus given by the equality:\n$$\n\\Delta t_{max} = \\frac{2}{\\omega_{0}}\n$$\nFinally, we express this result in terms of the given parameters $m_{1}$, $m_{2}$, and $k_{b}$. Substituting $\\omega_{0} = \\sqrt{k_{b}/\\mu}$ and $\\mu = \\frac{m_{1}m_{2}}{m_{1}+m_{2}}$:\n$$\n\\Delta t_{max} = 2\\sqrt{\\frac{\\mu}{k_{b}}} = 2\\sqrt{\\frac{1}{k_{b}} \\frac{m_{1}m_{2}}{m_{1}+m_{2}}}\n$$\nThis is the closed-form analytic expression for the maximum stable timestep.",
            "answer": "$$\n\\boxed{2\\sqrt{\\frac{m_{1}m_{2}}{k_{b}(m_{1}+m_{2})}}}\n$$"
        }
    ]
}