{
    "hands_on_practices": [
        {
            "introduction": "在多尺度材料模拟中，理解哈密顿动力学的核心始于其代数结构——泊松括号。这个练习旨在揭示一个基本的恒等式，即哈密顿量与自身的泊松括号为零（$\\{H,H\\}=0$）。通过证明这一结论，我们可以直接推导出能量守恒定律，这是模拟封闭系统时最基本的物理准则。",
            "id": "3820591",
            "problem": "在多尺度材料模拟中，哈密顿动力学下的相空间流为原子级分子动力学 (MD) 和粗粒化连续介质模型提供了共同的基础。考虑一个不含时哈密顿量 $H(\\mathbf{q},\\mathbf{p})$，其正则坐标为 $(\\mathbf{q},\\mathbf{p}) \\in \\mathbb{R}^{n} \\times \\mathbb{R}^{n}$，其中 $n$ 表示正则位置-动量对的数量。假设 $H(\\mathbf{q},\\mathbf{p}) = T(\\mathbf{p}) + U(\\mathbf{q})$，其中动能为 $T(\\mathbf{p}) = \\frac{1}{2}\\,\\mathbf{p}^{\\mathsf{T}} M^{-1} \\mathbf{p}$，势能 $U(\\mathbf{q})$ 由物理上真实的原子间和粗粒化相互作用构成，而 $M$ 是一个常数、对称、正定的质量矩阵。两个可微函数 $A(\\mathbf{q},\\mathbf{p})$ 和 $B(\\mathbf{q},\\mathbf{p})$ 的正则泊松括号定义为\n$$\n\\{A,B\\} \\equiv \\sum_{i=1}^{n} \\left( \\frac{\\partial A}{\\partial q_{i}} \\frac{\\partial B}{\\partial p_{i}} - \\frac{\\partial A}{\\partial p_{i}} \\frac{\\partial B}{\\partial q_{i}} \\right).\n$$\n仅从泊松括号的定义和哈密顿方程出发，计算泊松括号 $\\{H,H\\}$，并在除了可微性之外不对方程 $U(\\mathbf{q})$ 的形式做任何特殊假设的情况下，论证其结果为何必须为零。然后，简要地将 $\\{H,H\\}$ 为零的结果与哈密顿轨迹上的能量守恒以及相空间流的结构联系起来。将最终答案表示为一个不带单位的数字。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、问题明确且客观。它提出了经典哈密顿力学中的一个标准问题，而经典哈密顿力学是分子动力学模拟的基础理论。该问题是自洽的，并提供了进行严格推导所需的所有必要定义。\n\n问题要求计算哈密顿量与自身的泊松括号 $\\{H,H\\}$，并解释该结果在能量守恒和相空间流结构方面的意义。\n\n首先，我们使用给定的定义计算泊松括号 $\\{H,H\\}$：\n$$\n\\{A,B\\} \\equiv \\sum_{i=1}^{n} \\left( \\frac{\\partial A}{\\partial q_{i}} \\frac{\\partial B}{\\partial p_{i}} - \\frac{\\partial A}{\\partial p_{i}} \\frac{\\partial B}{\\partial q_{i}} \\right)\n$$\n代入 $A=H$ 和 $B=H$，我们得到：\n$$\n\\{H,H\\} = \\sum_{i=1}^{n} \\left( \\frac{\\partial H}{\\partial q_{i}} \\frac{\\partial H}{\\partial p_{i}} - \\frac{\\partial H}{\\partial p_{i}} \\frac{\\partial H}{\\partial q_{i}} \\right)\n$$\n哈密顿量 $H$ 是相空间坐标 $(\\mathbf{q},\\mathbf{p})$ 的标量函数。因此，其偏导数 $\\frac{\\partial H}{\\partial q_{i}}$ 和 $\\frac{\\partial H}{\\partial p_{i}}$ 也是标量函数。标量函数的乘法是可交换的。因此，对于每个索引 $i$，求和中的项为：\n$$\n\\frac{\\partial H}{\\partial q_{i}} \\frac{\\partial H}{\\partial p_{i}} = \\frac{\\partial H}{\\partial p_{i}} \\frac{\\partial H}{\\partial q_{i}}\n$$\n这导致：\n$$\n\\frac{\\partial H}{\\partial q_{i}} \\frac{\\partial H}{\\partial p_{i}} - \\frac{\\partial H}{\\partial p_{i}} \\frac{\\partial H}{\\partial q_{i}} = 0\n$$\n由于求和中的每一项都为零，所以整个和为零。\n$$\n\\{H,H\\} = \\sum_{i=1}^{n} 0 = 0\n$$\n这个结果对任何可微的哈密顿量 $H(\\mathbf{q},\\mathbf{p})$ 都成立，无论其具体形式如何，包括给定的可分离形式 $H(\\mathbf{q},\\mathbf{p}) = T(\\mathbf{p}) + U(\\mathbf{q})$。这是泊松括号的反对称性 $\\{A,B\\} = -\\{B,A\\}$ 的直接推论，该性质意味着对任何函数 $A$ 都有 $\\{A,A\\}=0$。\n\n接下来，我们将此结果与能量守恒和相空间流的结构联系起来。\n\n在哈密顿动力学支配的轨迹上，任何可微函数 $A(\\mathbf{q},\\mathbf{p},t)$ 的时间演化由其全时间导数给出：\n$$\n\\frac{dA}{dt} = \\frac{\\partial A}{\\partial t} + \\sum_{i=1}^{n} \\left( \\frac{\\partial A}{\\partial q_{i}} \\frac{dq_i}{dt} + \\frac{\\partial A}{\\partial p_{i}} \\frac{dp_i}{dt} \\right)\n$$\n使用哈密顿运动方程 $\\frac{dq_i}{dt} = \\dot{q}_i = \\frac{\\partial H}{\\partial p_i}$ 和 $\\frac{dp_i}{dt} = \\dot{p}_i = -\\frac{\\partial H}{\\partial q_i}$，我们可以替换正则坐标的时间导数：\n$$\n\\frac{dA}{dt} = \\frac{\\partial A}{\\partial t} + \\sum_{i=1}^{n} \\left( \\frac{\\partial A}{\\partial q_{i}} \\frac{\\partial H}{\\partial p_{i}} - \\frac{\\partial A}{\\partial p_{i}} \\frac{\\partial H}{\\partial q_{i}} \\right)\n$$\n求和项是泊松括号 $\\{A,H\\}$ 的定义。因此，哈密顿形式下的普遍运动方程是：\n$$\n\\frac{dA}{dt} = \\frac{\\partial A}{\\partial t} + \\{A,H\\}\n$$\n为了确定能量是否守恒，我们令 $A=H$。问题指定了一个不含时的哈密顿量，因此 $\\frac{\\partial H}{\\partial t} = 0$。$H$ 的时间演化方程变为：\n$$\n\\frac{dH}{dt} = \\{H,H\\}\n$$\n正如我们刚刚证明的，$\\{H,H\\} = 0$。因此，\n$$\n\\frac{dH}{dt} = 0\n$$\n这表明哈密顿量 $H$ 是在其自身动力学下演化的任何轨迹上的一个运动常数。由于 $H$ 代表系统的总能量，这个结果就是能量守恒定律。它意味着系统在相空间中的轨迹被限制在由初始能量 $H(\\mathbf{q},\\mathbf{p}) = E_0$ 定义的 $(2n-1)$ 维超曲面上。\n\n相空间流的结构由刘维尔定理 (Liouville's theorem) 描述，该定理指出相空间流是不可压缩的。这意味着相空间中的一个无穷小体积元在随时间演化时其体积不变。不可压缩流的条件是相空间中“速度”矢量的散度必须为零。相空间速度矢量为 $\\mathbf{v} = (\\dot{q}_1, \\dots, \\dot{q}_n, \\dot{p}_1, \\dots, \\dot{p}_n)$。其散度为：\n$$\n\\nabla_{\\mathbf{q},\\mathbf{p}} \\cdot \\mathbf{v} = \\sum_{i=1}^{n} \\left( \\frac{\\partial \\dot{q}_i}{\\partial q_i} + \\frac{\\partial \\dot{p}_i}{\\partial p_i} \\right)\n$$\n将哈密顿方程代入此表达式得到：\n$$\n\\nabla_{\\mathbf{q},\\mathbf{p}} \\cdot \\mathbf{v} = \\sum_{i=1}^{n} \\left( \\frac{\\partial}{\\partial q_i} \\left( \\frac{\\partial H}{\\partial p_i} \\right) + \\frac{\\partial}{\\partial p_i} \\left( -\\frac{\\partial H}{\\partial q_i} \\right) \\right) = \\sum_{i=1}^{n} \\left( \\frac{\\partial^2 H}{\\partial q_i \\partial p_i} - \\frac{\\partial^2 H}{\\partial p_i \\partial q_i} \\right)\n$$\n对于任何“物理上真实的”哈密顿量，如问题所述，函数 $H$ 被假设为至少二阶连续可微。根据关于混合偏导数相等的克莱罗定理 (Clairaut's theorem)，我们有 $\\frac{\\partial^2 H}{\\partial q_i \\partial p_i} = \\frac{\\partial^2 H}{\\partial p_i \\partial q_i}$。因此，和中的每一项都为零，相空间流的散度消失：\n$$\n\\nabla_{\\mathbf{q},\\mathbf{p}} \\cdot \\mathbf{v} = 0\n$$\n$\\{H,H\\}$ 的消失和相空间流的不可压缩性都是哈密顿力学数学结构的基本推论。同一个光滑的标量函数 $H$ 通过其偏导数生成动力学。$\\{H,H\\}$ 的消失是一个代数恒等式，通过运动方程保证了能量守恒，将轨迹限制在能量超曲面上。流的不可压缩性是一个微分性质，它描述了轨迹系综如何在这些曲面上运动，同时保持相空间体积。这两个性质都依赖于哈密顿量的光滑性，但它们源于不同但相关的数学运算。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "哈密顿力学的代数性质带来了深刻的几何结论，其中最著名的就是刘维尔定理。这个练习将带领我们从抽象理论走向具体应用，将相空间流不可压缩性的概念应用于一个简单直观的物理模型——竖直圆环上的珠子。通过显式计算流速散度，我们可以亲手验证刘维尔定理，从而加深对相空间体积守恒这一核心概念的理解。",
            "id": "1250747",
            "problem": "一个质量为 $m$ 的质点被约束在一个半径为 $R$ 的竖直圆环上无摩擦地运动。该系统处于一个加速度为 $g$ 的匀强引力场中。系统的状态可以用一个二维相空间中的坐标 $(q, p)$ 来描述，其中 $q$ 是广义坐标，$p$ 是其共轭动量。设广义坐标为从圆环底部测量的角度 $\\theta$。\n\n在哈密顿力学中，系统状态 $(q_i, p_i)$ 在相空间中的时间演化由哈密顿方程决定：\n$$\n\\dot{q_i} = \\frac{\\partial H}{\\partial p_i}, \\quad \\dot{p_i} = -\\frac{\\partial H}{\\partial q_i}\n$$\n这些方程定义了一个矢量场 $\\mathbf{v} = (\\dot{q_1}, \\dots, \\dot{q_n}, \\dot{p_1}, \\dots, \\dot{p_n})$，它描述了相空间点的流。Liouville 定理指出，对于任何哈密顿系统，相空间流都是不可压缩的。这种不可压缩性在数学上表示为流矢量的散度为零：\n$$\n\\nabla \\cdot \\mathbf{v} = \\sum_{i=1}^{n} \\left( \\frac{\\partial \\dot{q_i}}{\\partial q_i} + \\frac{\\partial \\dot{p_i}}{\\partial p_i} \\right) = 0\n$$\n你的任务是为这个在环上运动的质点明确地验证这个结果。首先，求出系统的哈密顿量 $H(\\theta, p_\\theta)$。然后，使用哈密顿方程确定相空间流矢量 $\\mathbf{v} = (\\dot{\\theta}, \\dot{p_\\theta})$ 的分量。最后，计算这个流的散度 $\\nabla \\cdot \\mathbf{v} = \\frac{\\partial \\dot{\\theta}}{\\partial \\theta} + \\frac{\\partial \\dot{p_\\theta}}{\\partial p_\\theta}$。\n\n为该系统的相空间流的散度推导出一个单一值。",
            "solution": "系统的动能和势能分别为：\n$$\nT = \\tfrac{1}{2}mR^2\\dot\\theta^2, \\quad V = mgR\\bigl(1-\\cos\\theta\\bigr)\n$$\n共轭动量为：\n$$\np_\\theta = \\frac{\\partial L}{\\partial\\dot\\theta} = \\frac{\\partial (T-V)}{\\partial\\dot\\theta} = mR^2\\dot\\theta\n$$\n\n哈密顿量是总能量，用坐标和共轭动量表示：\n$$\nH(\\theta,p_\\theta) = T+V = \\frac{p_\\theta^2}{2mR^2} + mgR\\bigl(1-\\cos\\theta\\bigr)\n$$\n\n哈密顿方程给出了相空间流的分量：\n$$\n\\dot\\theta = \\frac{\\partial H}{\\partial p_\\theta} = \\frac{p_\\theta}{mR^2}\n$$\n$$\n\\dot p_\\theta = -\\frac{\\partial H}{\\partial \\theta} = -mgR\\sin\\theta\n$$\n\n流的散度计算如下：\n$$\n\\nabla\\!\\cdot\\mathbf v = \\frac{\\partial\\dot\\theta}{\\partial\\theta} + \\frac{\\partial\\dot p_\\theta}{\\partial p_\\theta} = \\frac{\\partial}{\\partial\\theta}\\left(\\frac{p_\\theta}{mR^2}\\right) + \\frac{\\partial}{\\partial p_\\theta}\\left(-mgR\\sin\\theta\\right)\n$$\n由于 $\\dot\\theta$ 不显含 $\\theta$ 而 $\\dot p_\\theta$ 不显含 $p_\\theta$，两个偏导数均为零。\n$$\n\\nabla\\!\\cdot\\mathbf v = 0 + 0 = 0\n$$",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "理想的哈密顿系统是理论的基石，但真实的模拟往往需要考虑系统与环境的相互作用，例如通过引入耗散力来模拟热浴。这个练习提供了一个与理想哈密顿情况形成鲜明对比的关键案例。我们将分析一个包含摩擦力的非哈密顿系统，并定量计算其相空间体积如何随时间演化，从而揭示为何在这类更为真实的模拟中，相空间体积不再守恒。",
            "id": "3820548",
            "problem": "在多尺度材料模拟中，恒温粗粒化模型常常引入耗散力，使得微观动力学呈非哈密顿性。考虑一个代表三维空间中纳米团簇的单个粗粒化粒子，其位置为 $\\mathbf{r} \\in \\mathbb{R}^{3}$，动量为 $\\mathbf{p} \\in \\mathbb{R}^{3}$。其确定性运动方程为\n$$\n\\dot{\\mathbf{r}}=\\frac{\\mathbf{p}}{m},\\qquad \\dot{\\mathbf{p}}=\\mathbf{F}(\\mathbf{r})-\\gamma(t)\\,\\mathbf{p},\n$$\n其中 $m$ 是粗粒化质量，$\\mathbf{F}(\\mathbf{r})=-\\nabla U(\\mathbf{r})$ 是源于光滑势 $U(\\mathbf{r})$ 的保守力，$\\gamma(t)$ 是一个随时间变化的各向同性摩擦系数，用于模拟与环境的时间调制耦合。设摩擦系数由下式给出\n$$\n\\gamma(t)=\\frac{\\gamma_{0}}{1+(t/\\tau)^{2}},\n$$\n其中 $\\gamma_{0}>0$ 且 $\\tau>0$，$\\gamma_{0}$ 的单位是时间的倒数，$\\tau$ 的单位是时间。在以坐标 $z=(\\mathbf{r},\\mathbf{p})$ 表示的 $6$ 维相空间中进行分析。\n\n仅从相空间流和概率守恒（相空间连续性方程）的基本定义出发，分析由上述动力学的矢量场生成的诱导流映射 $\\Phi_{t}:z(0)\\mapsto z(t)$。推导控制沿轨迹的无穷小相体积变化的雅可比行列式 $J(t):=\\det\\left(\\frac{\\partial z(t)}{\\partial z(0)}\\right)$ 的演化方程，并求解该方程，以获得在任意最终时刻 $T>0$ 的无量纲相空间体积比 $V(T)/V(0)=J(T)$ 的闭式表达式。\n\n将你的最终答案表示为仅含 $\\gamma_{0}$、$\\tau$ 和 $T$ 的单个闭式解析表达式。所有反三角函数均以弧度为单位。无需进行数值计算或四舍五入。报告无量纲比值 $V(T)/V(0)$。",
            "solution": "系统的状态由 6 维相空间中的一个点 $z(t)$ 描述，其坐标为 $z = (\\mathbf{r}, \\mathbf{p}) = (r_1, r_2, r_3, p_1, p_2, p_3)$。$z(t)$ 的时间演化由一阶常微分方程组 $\\dot{z} = \\mathbf{v}(z, t)$ 控制，其中 $\\mathbf{v}(z, t)$ 是相空间速度矢量场，由下式给出：\n$$\n\\mathbf{v}(z, t) = (\\dot{\\mathbf{r}}, \\dot{\\mathbf{p}}) = \\left( \\frac{\\mathbf{p}}{m}, \\mathbf{F}(\\mathbf{r}) - \\gamma(t)\\mathbf{p} \\right)\n$$\n相空间中一个无穷小体积元的变化率与相空间速度场的散度有关。具体来说，流映射 $\\Phi_t: z(0) \\mapsto z(t)$ 的雅可比行列式 $J(t) = \\det(\\partial z(t) / \\partial z(0))$ 满足刘维尔公式：\n$$\n\\frac{dJ(t)}{dt} = J(t) \\left( \\nabla_z \\cdot \\mathbf{v}(z(t), t) \\right)\n$$\n其中 $\\nabla_z \\cdot \\mathbf{v}$ 是速度场相对于相空间坐标 $z$ 的散度。\n\n我们必须计算这个散度。相空间速度 $\\mathbf{v}$ 的分量为 $v_{r_i} = p_i/m$ 和 $v_{p_i} = F_i(\\mathbf{r}) - \\gamma(t)p_i$ (对于 $i=1,2,3$)。散度是其分量对相应坐标的偏导数之和：\n$$\n\\nabla_z \\cdot \\mathbf{v} = \\sum_{i=1}^{3} \\left( \\frac{\\partial v_{r_i}}{\\partial r_i} + \\frac{\\partial v_{p_i}}{\\partial p_i} \\right)\n$$\n我们来计算各项：\n1.  对位置的导数：\n    $$\n    \\frac{\\partial v_{r_i}}{\\partial r_i} = \\frac{\\partial}{\\partial r_i} \\left( \\frac{p_i}{m} \\right) = 0\n    $$\n    因为 $p_i$ 和 $r_i$ 是相空间中的独立坐标。\n\n2.  对动量的导数：\n    $$\n    \\frac{\\partial v_{p_i}}{\\partial p_i} = \\frac{\\partial}{\\partial p_i} \\left( F_i(\\mathbf{r}) - \\gamma(t)p_i \\right) = -\\gamma(t)\n    $$\n    因为 $\\mathbf{F}(\\mathbf{r})$ 仅依赖于 $\\mathbf{r}$。\n\n将所有贡献相加，我们得到散度：\n$$\n\\nabla_z \\cdot \\mathbf{v} = \\sum_{i=1}^{3} \\left( 0 - \\gamma(t) \\right) = -3\\gamma(t)\n$$\n值得注意的是，散度仅是时间 $t$ 的函数，与相空间位置 $z$ 无关。将此结果代入 $J(t)$ 的演化方程：\n$$\n\\frac{dJ(t)}{dt} = -3\\gamma(t) J(t)\n$$\n这是一个一阶线性齐次微分方程。通过分离变量并从 $t=0$ 积分到 $t=T$，考虑到初始条件 $J(0) = 1$，我们得到：\n$$\n\\int_{1}^{J(T)} \\frac{dJ}{J} = \\int_{0}^{T} -3\\gamma(t) dt \\implies \\ln(J(T)) = -3 \\int_{0}^{T} \\frac{\\gamma_{0}}{1+(t/\\tau)^{2}} dt\n$$\n为了计算该积分，我们进行变量替换 $u = t/\\tau$，$dt = \\tau du$：\n$$\n\\int_{0}^{T} \\frac{\\gamma_{0}}{1+(t/\\tau)^{2}} dt = \\gamma_{0}\\tau \\int_{0}^{T/\\tau} \\frac{1}{1+u^2} du = \\gamma_{0}\\tau \\left[ \\arctan(u) \\right]_{0}^{T/\\tau} = \\gamma_{0}\\tau \\arctan\\left(\\frac{T}{\\tau}\\right)\n$$\n将此结果代回，我们得到：\n$$\n\\ln(J(T)) = -3 \\gamma_{0}\\tau \\arctan\\left(\\frac{T}{\\tau}\\right)\n$$\n对两边取指数，得到雅可比行列式：\n$$\nJ(T) = \\exp\\left(-3 \\gamma_{0}\\tau \\arctan\\left(\\frac{T}{\\tau}\\right)\\right)\n$$\n相空间体积比 $V(T)/V(0)$ 等于 $J(T)$，因为散度与相空间坐标无关。因此，该比值为：\n$$\n\\frac{V(T)}{V(0)} = \\exp\\left(-3 \\gamma_{0}\\tau \\arctan\\left(\\frac{T}{\\tau}\\right)\\right)\n$$",
            "answer": "$$\\boxed{\\exp\\left(-3 \\gamma_{0} \\tau \\arctan\\left(\\frac{T}{\\tau}\\right)\\right)}$$"
        }
    ]
}