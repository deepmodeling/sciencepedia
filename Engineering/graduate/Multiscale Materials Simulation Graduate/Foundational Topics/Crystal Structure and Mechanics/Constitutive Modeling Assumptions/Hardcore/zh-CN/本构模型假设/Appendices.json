{
    "hands_on_practices": [
        {
            "introduction": "此练习探讨了尺度分离的基本假设，该假设为经典连续介质模型的使用提供了理论依据。通过分析宏观与微观长度尺度的比率，您将学习如何定量估计高阶效应（如应变梯度效应）在何时变得显著，以及在何时可以安全地忽略它们。",
            "id": "3797607",
            "problem": "多晶金属构件在宏观尺度上通过一个连续介质来建模，其本构法则可能包含高阶（应变梯度）项，以表示源于微观结构的尺寸效应。设特征结构尺寸为 $L$，平均晶粒尺寸为 $\\ell$。代表性体积元（RVE）假设指出，当 $L/\\ell \\gg 1$ 时，尺度分离成立，这为使用经典局部本构模型提供了依据。在梯度增强本构理论中，通过引入一个材料长度尺度，所增加的能量密度被构造成与经典能量密度具有相同的物理单位。考虑一个产生典型应变大小 $|\\varepsilon|$ 和典型应变梯度大小 $|\\nabla \\varepsilon|$ 的光滑位移场；使用量纲一致性和特征尺度论证来估计梯度项相对于经典项的相对重要性，并将此重要性与比值 $\\ell/L$ 联系起来。\n\n给定一个晶粒尺寸为 $\\ell=10\\,\\mu\\mathrm{m}$ 且结构尺寸为 $L=10\\,\\mathrm{mm}$ 的单晶集合体，完成以下任务：\n\n- 从第一性原理和量纲推理出发，假设光滑应变场满足 $|\\nabla \\varepsilon| \\sim |\\varepsilon|/L$，推导梯度能量密度与经典能量密度之比关于 $\\ell$ 和 $L$ 的标度关系。\n\n- 用所提供的值计算 $L/\\ell$，并根据您推导的标度关系，论证在光滑加载下应变梯度效应是否显著。说明您对场规律性和加载所做的任何假设。\n\n将 $L/\\ell$ 作为最终答案报告。将最终比值表示为一个无单位的纯数。无需四舍五入。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- 特征结构尺寸：$L$\n- 平均晶粒尺寸：$\\ell$\n- 代表性体积元（RVE）假设的条件：$L/\\ell \\gg 1$\n- 梯度理论中增加的能量密度与经典能量密度具有相同的物理单位。\n- 为保证量纲一致性，引入了一个材料长度尺度。\n- 典型应变大小：$|\\varepsilon|$\n- 典型应变梯度大小：$|\\nabla \\varepsilon|$\n- 光滑应变场的假设：$|\\nabla \\varepsilon| \\sim |\\varepsilon|/L$\n- 给定的晶粒尺寸值：$\\ell = 10\\,\\mu\\mathrm{m}$\n- 给定的结构尺寸值：$L = 10\\,\\mathrm{mm}$\n\n### 第2步：使用提取的已知条件进行验证\n对问题的有效性进行评估：\n- **科学依据**：该问题基于连续介质力学的既定原理，特别是关于具有微观结构和应变梯度效应的材料理论。RVE、能量密度、应变、应变梯度和特征长度尺度等概念是多尺度材料建模中的标准概念。所描述的框架与 Aifantis、Fleck、Hutchinson 等人发展的理论一致。该问题是科学合理的。\n- **适定性**：该问题提供了所有必要的定义、变量和一个关键的标度假设（$|\\nabla \\varepsilon| \\sim |\\varepsilon|/L$），以推导所要求的比率并进行后续分析。问题具体，能够得出一个唯一且有意义的答案。\n- **客观性**：问题以精确的技术语言陈述，没有主观或含糊的术语。\n- **不完整或矛盾的设定**：问题是自洽且一致的。给定的数据和假设足以求解。\n- **不切实际或不可行**：所描述的物理情景（一个多晶金属构件）以及为 $L$（$10\\,\\mathrm{mm}$）和 $\\ell$（$10\\,\\mu\\mathrm{m}$）提供的值在物理上是现实的。\n\n### 第3步：结论与行动\n问题被认为是**有效的**，因为它具有科学依据、适定、客观且内部一致。将提供解答。\n\n解答按要求分为两部分。\n\n首先，我们推导梯度能量密度与经典能量密度之比的标度关系。经典应变能密度，我们记为 $W_{classical}$，是应变张量 $\\varepsilon$ 的函数。对于线性弹性各向同性材料，其形式为 $W_{classical} = \\frac{1}{2} \\lambda (\\mathrm{tr}(\\varepsilon))^2 + \\mu \\mathrm{tr}(\\varepsilon^2)$，其中 $\\lambda$ 和 $\\mu$ 是拉梅参数。为了进行标度分析，我们可以说能量密度与特征应变大小 $|\\varepsilon|$ 的平方成正比，再乘以一个特征弹性模量，我们用一个通用的刚度常数 $C$ 来表示。\n$$\nW_{classical} \\sim C |\\varepsilon|^2\n$$\n能量密度的物理单位是能量每体积，或力每面积（应力），这与 $C$ 的单位（应力）一致，因为应变 $|\\varepsilon|$ 是无量纲的。\n\n接下来，我们考虑应变梯度能量密度 $W_{gradient}$。引入此项是为了解释尺寸效应，它取决于应变张量的梯度 $\\nabla \\varepsilon$。问题指出，引入一个材料长度尺度以确保 $W_{gradient}$ 与 $W_{classical}$ 具有相同的物理单位。应变梯度的单位是长度的倒数，因为 $[\\nabla \\varepsilon] = [\\varepsilon]/[\\text{长度}] = 1/[\\text{长度}]$。为了构建一个能量密度项，我们必须将 $|\\nabla \\varepsilon|$ 与材料参数结合以获得应力的单位。梯度能量项的一种常见形式涉及应变梯度大小的平方 $|\\nabla \\varepsilon|^2$，其单位为 $1/[\\text{长度}]^2$。为了使该项具有应力单位，它必须乘以一个单位为 [应力] $\\times$ [长度]$^2$ 的因子。这个因子通常由一个材料刚度（比如 $C'$）和一个内在材料长度尺度（我们记为 $l_m$）的平方构成。这个长度尺度代表了底层微观结构的影响。\n$$\nW_{gradient} \\sim C' l_m^2 |\\nabla \\varepsilon|^2\n$$\n从物理上讲，假设内在长度尺度 $l_m$ 与微观结构的特征尺寸相关是合理的，在本问题中即为平均晶粒尺寸 $\\ell$。因此，我们假设 $l_m \\sim \\ell$。此外，对于标度分析，我们可以假设高阶刚度 $C'$ 与经典刚度 $C$ 处于同一数量级。有了这些假设，梯度能量密度的标度关系变为：\n$$\nW_{gradient} \\sim C \\ell^2 |\\nabla \\varepsilon|^2\n$$\n现在，我们可以求出梯度能量密度与经典能量密度之比：\n$$\n\\frac{W_{gradient}}{W_{classical}} \\sim \\frac{C \\ell^2 |\\nabla \\varepsilon|^2}{C |\\varepsilon|^2} = \\ell^2 \\left(\\frac{|\\nabla \\varepsilon|}{|\\varepsilon|}\\right)^2\n$$\n问题为结构尺寸 $L$ 上的光滑加载条件提供了一个关键假设：特征应变梯度大小通过 $|\\nabla \\varepsilon| \\sim |\\varepsilon|/L$ 与特征应变大小相关。将此代入我们的比率，得到所需的关于 $\\ell$ 和 $L$ 的标度关系：\n$$\n\\frac{W_{gradient}}{W_{classical}} \\sim \\ell^2 \\left(\\frac{|\\varepsilon|/L}{|\\varepsilon|}\\right)^2 = \\ell^2 \\left(\\frac{1}{L}\\right)^2 = \\left(\\frac{\\ell}{L}\\right)^2\n$$\n这个推导表明，梯度能量项的相对重要性与微观结构长度尺度与宏观结构长度尺度之比的平方成标度关系。\n\n其次，我们使用给定的值计算比率 $L/\\ell$ 并评估应变梯度效应的显著性。\n给定的值为 $\\ell = 10\\,\\mu\\mathrm{m}$ 和 $L = 10\\,\\mathrm{mm}$。首先，我们将它们转换为一致的单位，例如米（$m$）。\n$$\n\\ell = 10\\,\\mu\\mathrm{m} = 10 \\times 10^{-6}\\,\\mathrm{m} = 10^{-5}\\,\\mathrm{m}\n$$\n$$\nL = 10\\,\\mathrm{mm} = 10 \\times 10^{-3}\\,\\mathrm{m} = 10^{-2}\\,\\mathrm{m}\n$$\n那么比率 $L/\\ell$ 是：\n$$\n\\frac{L}{\\ell} = \\frac{10^{-2}\\,\\mathrm{m}}{10^{-5}\\,\\mathrm{m}} = 10^{(-2 - (-5))} = 10^3 = 1000\n$$\n比率 $L/\\ell = 1000$ 远大于 $1$，满足 RVE 假设的条件（$L/\\ell \\gg 1$）。这表明，对于许多目的而言，经典的局部本构模型就足够了。\n\n为了评估应变梯度效应的显著性，我们使用先前推导的标度关系：\n$$\n\\frac{W_{gradient}}{W_{classical}} \\sim \\left(\\frac{\\ell}{L}\\right)^2 = \\left(\\frac{1}{1000}\\right)^2 = (10^{-3})^2 = 10^{-6}\n$$\n这个结果表明，来自应变梯度的能量贡献大约是来自经典应变能贡献的百万分之一。基于此，我们可以论证，在该光滑应变场（即没有显著应变局部化的光滑加载）的假设下，该构件的应变梯度效应预计完全可以忽略不计。如果加载会引起剪切带或裂纹尖端附近的塑性等尖锐特征，局部应变梯度可能会变得非常大，并且假设 $|\\nabla \\varepsilon| \\sim |\\varepsilon|/L$ 将不再成立，这可能使梯度效应在局部变得显著。然而，在光滑场的情况下，它们的贡献是微不足道的。\n\n问题要求将 $L/\\ell$ 作为最终答案报告。\n$$\n\\frac{L}{\\ell} = 1000\n$$",
            "answer": "$$\\boxed{1000}$$"
        },
        {
            "introduction": "均匀化理论的一个核心假设是，宏观功率应等于微观功率的体积平均值，这一原则被称为 Hill-Mandel 条件。本练习通过推导和编程任务，展示了该条件如何关键性地依赖于施加在代表性体积单元 (RVE) 上的边界条件，特别是波动场的周期性。",
            "id": "3797595",
            "problem": "考虑一个一维代表性体积单元 (RVE)，它是一个长度为 $L$、横截面积恒为 $A$ 的非均匀弹性杆。轴向坐标为 $x \\in [0,L]$。该杆由 $n$ 层组成，其杨氏模量 $E(x)$ 为分段常数，由各层模量 $E_i$ 和厚度分数 $f_i$ 指定，使得 $\\sum_{i=1}^{n} f_i = 1$，且相应的空间划分满足 $\\int_{0}^{L} \\frac{dx}{E(x)} = L \\sum_{i=1}^{n} \\frac{f_i}{E_i}$。局部运动学量为位移 $u(x)$、应变 $\\varepsilon(x) = \\frac{du}{dx}$ 和应力 $\\sigma(x)$。假设准静态条件、无体力、以及经典线弹性，因此局部平衡和本构响应由 $\\frac{d\\sigma}{dx} = 0$ 和 $\\sigma(x) = E(x)\\varepsilon(x)$ 控制。宏观（均匀化）应变 $E_{\\text{bar}}$ 是给定的，涨落量 $u^{\\sim}(x)$ 由加法分解 $u(x) = E_{\\text{bar}} x + u^{\\sim}(x)$ 定义。Hill-Mandel 宏观均匀性条件要求宏观功率与微观功率的体积平均值相等：$\\langle \\sigma \\dot{\\varepsilon} \\rangle = \\Sigma_{\\text{bar}} \\dot{E}_{\\text{bar}}$，其中 $\\langle \\cdot \\rangle$ 表示在 RVE 上的空间平均，$\\Sigma_{\\text{bar}} = \\langle \\sigma \\rangle$ 是宏观应力。\n\n你需要构建一个由于不相容的微观边界条件而导致 Hill-Mandel 条件失效的案例，然后通过施加周期性涨落 $u^{\\sim}(L) = u^{\\sim}(0)$ 和在 RVE 边界上施加零均值微观面力来演示宏观均匀性的恢复。为此，考虑位移边界条件 $u(0) = 0$ 和 $u(L) = E_{\\text{bar}} L + \\Delta$，其中参数 $\\Delta$ 表示一个位移不匹配量，当 $\\Delta \\neq 0$ 时会破坏周期性。在这些条件下，局部平衡意味着应力恒定 $\\sigma(x) \\equiv \\sigma$，边界上的面力为 $x=0$ 处的 $t(0) = -\\sigma$ 和 $x=L$ 处的 $t(L) = \\sigma$。平均面力（微观面力均值）为 $\\bar{t} = \\frac{t(0) + t(L)}{2}$。\n\n从上述基本定律和定义（线动量平衡、线弹性、运动学可加性以及 Hill-Mandel 功率等价性）出发，推导 Hill-Mandel 残差 $R$ 的表达式，其定义为\n$$\nR = \\langle \\sigma \\varepsilon \\rangle - \\Sigma_{\\text{bar}} E_{\\text{bar}},\n$$\n用参数 $L$、$E_i$、$f_i$、$E_{\\text{bar}}$ 和 $\\Delta$ 表示。展示 $R$ 如何依赖于不相容性 $\\Delta$，并解释周期性涨落和零均值微观面力在使 $R$ 为零中的作用。然后，实现一个程序，为下面的每个测试用例计算 $R$ 和 $\\bar{t}$。$R$ 和 $\\bar{t}$ 以帕斯卡（Pa）表示。角度单位不适用。应变必须指定并作为十进制数处理。\n\n所有测试用例均使用 $L = 1$ $\\text{m}$。层模量 $E_i$ 以吉帕斯卡（GPa）给出，在计算中必须转换为帕斯卡。最终输出必须是单行，包含一个由数对 $[R,\\bar{t}]$ 组成的列表，每个测试用例一个数对，严格按照测试套件的顺序，用方括号括起来并以逗号分隔，例如：$[[r_1,t_1],[r_2,t_2],\\dots]$。\n\n测试套件：\n- 案例 1（正常情况：施加周期性涨落）：$n=2$，$E_1 = 70$ $\\text{GPa}$，$E_2 = 210$ $\\text{GPa}$，$f_1 = 0.6$，$f_2 = 0.4$，$E_{\\text{bar}} = 0.01$，$\\Delta = 0.0$ $\\text{m}$。\n- 案例 2（因非周期性涨落而失效）：$n=2$，$E_1 = 70$ $\\text{GPa}$，$E_2 = 210$ $\\text{GPa}$，$f_1 = 0.6$，$f_2 = 0.4$，$E_{\\text{bar}} = 0.01$，$\\Delta = 10^{-5}$ $\\text{m}$。\n- 案例 3（边缘情况：宏观应变为零，但有非周期性涨落）：$n=2$，$E_1 = 70$ $\\text{GPa}$，$E_2 = 210$ $\\text{GPa}$，$f_1 = 0.6$，$f_2 = 0.4$，$E_{\\text{bar}} = 0.0$，$\\Delta = 10^{-5}$ $\\text{m}$。\n- 案例 4（强非均匀性下的正常情况）：$n=2$，$E_1 = 5$ $\\text{GPa}$，$E_2 = 300$ $\\text{GPa}$，$f_1 = 0.5$，$f_2 = 0.5$，$E_{\\text{bar}} = 0.02$，$\\Delta = 0.0$ $\\text{m}$。\n- 案例 5（符号敏感的边缘情况）：$n=2$，$E_1 = 100$ $\\text{GPa}$，$E_2 = 50$ $\\text{GPa}$，$f_1 = 0.2$，$f_2 = 0.8$，$E_{\\text{bar}} = 0.015$，$\\Delta = -2 \\times 10^{-5}$ $\\text{m}$。\n\n你的程序应生成单行输出，其中包含结果，格式为一个逗号分隔的列表，用方括号括起来，每个元素是一个双元素列表 $[R,\\bar{t}]$，单位为帕斯卡，严格按照测试套件的顺序，例如：$[[r_1,t_1],[r_2,t_2],[r_3,t_3],[r_4,t_4],[r_5,t_5]]$。",
            "solution": "该问题是有效的，因为它科学地基于连续介质力学和均匀化理论的原理，问题提法良好，信息充分，可得到唯一解，并以客观、正式的语言表述。我们现在开始推导和求解。\n\n**1. 应力场的推导**\n\n分析始于准静态条件和无体力下的一维局部平衡方程：\n$$\n\\frac{d\\sigma}{dx} = 0\n$$\n这意味着应力 $\\sigma(x)$ 在整个代表性体积单元 (RVE) 中是恒定的。我们用 $\\sigma$ 表示这个恒定应力。\n$$\n\\sigma(x) = \\sigma\n$$\n宏观应力 $\\Sigma_{\\text{bar}}$ 定义为微观应力的体积平均值，因此也等于这个常数值：\n$$\n\\Sigma_{\\text{bar}} = \\langle \\sigma \\rangle = \\frac{1}{L} \\int_0^L \\sigma \\, dx = \\sigma\n$$\n局部本构关系由线弹性给出：$\\sigma(x) = E(x)\\varepsilon(x)$。因此，局部应变 $\\varepsilon(x)$ 可表示为：\n$$\n\\varepsilon(x) = \\frac{\\sigma}{E(x)}\n$$\n应变通过 $\\varepsilon(x) = \\frac{du}{dx}$ 与位移场 $u(x)$ 相关联。我们可以通过从边界 $x=0$ 处对应变进行积分来求得位移：\n$$\nu(x) = u(0) + \\int_0^x \\varepsilon(\\xi) \\, d\\xi\n$$\n使用边界条件 $u(0)=0$ 和应变表达式，我们得到：\n$$\nu(x) = \\sigma \\int_0^x \\frac{d\\xi}{E(\\xi)}\n$$\n现在，我们施加在 $x=L$ 处的第二个边界条件：$u(L) = E_{\\text{bar}} L + \\Delta$。\n$$\nu(L) = \\sigma \\int_0^L \\frac{dx}{E(x)}\n$$\n问题陈述提供了材料空间分布的属性：$\\int_{0}^{L} \\frac{dx}{E(x)} = L \\sum_{i=1}^{n} \\frac{f_i}{E_i}$。这对应于串联分层复合材料的有效柔度。将此代入 $u(L)$ 的方程中得到：\n$$\nu(L) = \\sigma L \\sum_{i=1}^{n} \\frac{f_i}{E_i}\n$$\n将其与给定的边界条件 $u(L) = E_{\\text{bar}} L + \\Delta$ 等同，我们可以解出恒定应力 $\\sigma$：\n$$\n\\sigma L \\sum_{i=1}^{n} \\frac{f_i}{E_i} = E_{\\text{bar}} L + \\Delta\n$$\n$$\n\\sigma = \\frac{E_{\\text{bar}} L + \\Delta}{L \\sum_{i=1}^{n} \\frac{f_i}{E_i}} = \\frac{E_{\\text{bar}} + \\Delta/L}{\\sum_{i=1}^{n} \\frac{f_i}{E_i}}\n$$\n该表达式用给定的问题参数表示了应力 $\\sigma$（并因此表示了 $\\Sigma_{\\text{bar}}$）。\n\n**2. Hill-Mandel 残差的推导**\n\nHill-Mandel 残差 $R$ 定义为 $R = \\langle \\sigma \\varepsilon \\rangle - \\Sigma_{\\text{bar}} E_{\\text{bar}}$。让我们计算第一项，即内功的平均值 $\\langle \\sigma \\varepsilon \\rangle$。\n$$\n\\langle \\sigma \\varepsilon \\rangle = \\frac{1}{L} \\int_0^L \\sigma(x) \\varepsilon(x) \\, dx\n$$\n由于 $\\sigma(x) = \\sigma$ 是常数，我们可以将其从积分中提出：\n$$\n\\langle \\sigma \\varepsilon \\rangle = \\sigma \\left( \\frac{1}{L} \\int_0^L \\varepsilon(x) \\, dx \\right) = \\sigma \\langle \\varepsilon \\rangle\n$$\n平均应变 $\\langle \\varepsilon \\rangle$ 可以使用应变的定义和微积分基本定理直接计算：\n$$\n\\langle \\varepsilon \\rangle = \\frac{1}{L} \\int_0^L \\frac{du}{dx} \\, dx = \\frac{u(L) - u(0)}{L}\n$$\n代入边界条件 $u(0)=0$ 和 $u(L) = E_{\\text{bar}} L + \\Delta$：\n$$\n\\langle \\varepsilon \\rangle = \\frac{(E_{\\text{bar}} L + \\Delta) - 0}{L} = E_{\\text{bar}} + \\frac{\\Delta}{L}\n$$\n因此，平均内功为：\n$$\n\\langle \\sigma \\varepsilon \\rangle = \\sigma \\left( E_{\\text{bar}} + \\frac{\\Delta}{L} \\right)\n$$\n现在我们可以计算残差 $R$。回想一下 $\\Sigma_{\\text{bar}} = \\sigma$：\n$$\nR = \\langle \\sigma \\varepsilon \\rangle - \\Sigma_{\\text{bar}} E_{\\text{bar}} = \\sigma \\left( E_{\\text{bar}} + \\frac{\\Delta}{L} \\right) - \\sigma E_{\\text{bar}}\n$$\n$$\nR = \\sigma E_{\\text{bar}} + \\sigma \\frac{\\Delta}{L} - \\sigma E_{\\text{bar}} = \\sigma \\frac{\\Delta}{L}\n$$\n代入 $\\sigma$ 的表达式：\n$$\nR = \\left( \\frac{E_{\\text{bar}} + \\Delta/L}{\\sum_{i=1}^{n} \\frac{f_i}{E_i}} \\right) \\frac{\\Delta}{L}\n$$\n这是 Hill-Mandel 残差 $R$ 的最终表达式。\n\n**3. 均匀化条件的分析**\n\nHill-Mandel 宏观均匀性条件要求宏观功率与微观功率的体积平均值相等，在其时间积分形式下，这意味着 $R=0$。\n\n推导出的表达式 $R = \\sigma \\frac{\\Delta}{L}$ 表明，残差不为零当且仅当 $\\sigma \\neq 0$ 和 $\\Delta \\neq 0$ 同时成立。参数 $\\Delta$ 代表了对位移涨落 $u^{\\sim}(x)$ 周期性的违反。这可以通过检查定义 $u(x) = E_{\\text{bar}}x + u^{\\sim}(x)$ 来证明：\n- 在 $x=0$ 处：$u(0) = E_{\\text{bar}}(0) + u^{\\sim}(0)$。因为 $u(0)=0$，所以我们有 $u^{\\sim}(0) = 0$。\n- 在 $x=L$ 处：$u(L) = E_{\\text{bar}}L + u^{\\sim}(L)$。边界条件表明 $u(L) = E_{\\text{bar}}L + \\Delta$。\n- 比较这两者意味着 $u^{\\sim}(L) = \\Delta$。\n周期性涨落的条件是 $u^{\\sim}(L) = u^{\\sim}(0)$，这转换成 $\\Delta = 0$。当施加周期性涨落（$\\Delta=0$）时，残差 $R$ 为零，Hill-Mandel 条件得到满足。\n\n接下来，我们考虑‘零均值微观面力’的作用。在具有外法向向量 $\\mathbf{n}$ 的表面上的面力 $t$ 由 $\\mathbf{t} = \\boldsymbol{\\sigma} \\cdot \\mathbf{n}$ 给出。在我们的 1D 情况下：\n- 在 $x=L$ 处，外法线为 $n=1$，因此面力为 $t(L) = \\sigma(L) = \\sigma$。\n- 在 $x=0$ 处，外法线为 $n=-1$，因此面力为 $t(0) = \\sigma(0) \\cdot (-1) = -\\sigma$。\n平均微观面力定义为 $\\bar{t} = \\frac{t(0) + t(L)}{2}$。代入面力的表达式：\n$$\n\\bar{t} = \\frac{-\\sigma + \\sigma}{2} = 0\n$$\n这表明，对于一个无体力的一维杆，平均微观面力始终为零，这是静力平衡（$\\frac{d\\sigma}{dx}=0$）的直接结果。因此，对于本问题中的所有情况，这个条件都是自然满足的。宏观均匀性的失效（$R \\neq 0$）完全是由于非周期性的位移涨落，即当 $\\Delta \\neq 0$ 时。\n\n**4. 用于实现的公式摘要**\n\n对于每个具有参数 $L$、$E_i$、$f_i$、$E_{\\text{bar}}$ 和 $\\Delta$ 的测试用例：\n1. 计算有效柔度项：$S_{eff} = \\sum_{i=1}^{n} \\frac{f_i}{E_i}$。\n2. 计算应力：$\\sigma = \\frac{E_{\\text{bar}} + \\Delta/L}{S_{eff}}$。\n3. 计算残差：$R = \\sigma \\frac{\\Delta}{L}$。\n4. 平均面力始终为零：$\\bar{t} = 0$。\n所有的 $E_i$ 都必须从 GPa 转换为 Pa（$1 \\text{ GPa} = 10^9 \\text{ Pa}$）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Hill-Mandel residual R and mean microtraction t_bar\n    for a series of test cases on a 1D heterogeneous bar.\n    \"\"\"\n    \n    # Common parameter for all test cases\n    L = 1.0  # meters\n\n    # Test suite: (n, E_list_GPa, f_list, E_bar, Delta)\n    # E_list_GPa contains Young's moduli in GPa.\n    # f_list contains the thickness fractions.\n    # E_bar is the macroscopic strain (dimensionless).\n    # Delta is the displacement mismatch in meters.\n    test_cases = [\n        # Case 1 (happy path: periodic fluctuations enforced)\n        (2, [70.0, 210.0], [0.6, 0.4], 0.01, 0.0),\n        # Case 2 (failure due to non-periodic fluctuations)\n        (2, [70.0, 210.0], [0.6, 0.4], 0.01, 1e-5),\n        # Case 3 (edge case: zero macroscopic strain with non-periodic fluctuations)\n        (2, [70.0, 210.0], [0.6, 0.4], 0.0, 1e-5),\n        # Case 4 (happy path with strong heterogeneity)\n        (2, [5.0, 300.0], [0.5, 0.5], 0.02, 0.0),\n        # Case 5 (sign-sensitive edge case)\n        (2, [100.0, 50.0], [0.2, 0.8], 0.015, -2e-5),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        n, E_list_GPa, f_list, E_bar, Delta = case\n\n        # Convert E from GPa to Pa\n        E_list_Pa = [E * 1e9 for E in E_list_GPa]\n\n        # 1. Calculate the effective compliance term S_eff\n        # S_eff = sum(f_i / E_i)\n        S_eff = sum(f / E for f, E in zip(f_list, E_list_Pa))\n\n        # 2. Calculate the constant stress sigma\n        # sigma = (E_bar + Delta/L) / S_eff\n        sigma = (E_bar + Delta / L) / S_eff\n\n        # 3. Calculate the Hill-Mandel residual R\n        # R = sigma * (Delta / L)\n        R = sigma * (Delta / L)\n\n        # 4. Calculate the mean microtraction t_bar\n        # As derived, t_bar = (t(0) + t(L))/2 = (-sigma + sigma)/2 = 0\n        # for a 1D bar in equilibrium with no body forces.\n        t_bar = 0.0\n        \n        results.append([R, t_bar])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list '[...]' is used for each pair.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "本构律的数学形式对控制方程的适定性有着深远的影响，尤其是在应变软化等情况下。这个高级练习将引导您使用粘塑性公式对率无关塑性模型进行正则化，揭示该假设如何引入一个内部长度尺度，并确保数值稳定、与网格无关的结果。",
            "id": "3797613",
            "problem": "考虑一根一维小应变弹塑性杆，其密度为 $\\rho$，其纵向运动由线性动量守恒和标准运动学控制。设 $u(x,t)$ 为位移场，$\\epsilon(x,t) = \\partial u/\\partial x$ 为总应变，$\\epsilon_{p}(x,t)$ 为塑性应变。应力由线性弹性给出，其弹性应变为 $\\epsilon_{e} = \\epsilon - \\epsilon_{p}$，因此 $\\sigma(x,t) = E \\, \\epsilon_{e} = E \\left( \\epsilon - \\epsilon_{p} \\right)$，其中 $E>0$ 是杨氏模量。屈服应力取为 $\\sigma_{y}(\\epsilon_{p}) = \\sigma_{0} + H \\, \\epsilon_{p}$，其中 $\\sigma_{0}>0$，$H$ 是一个恒定的硬化/软化模量（允许 $H<0$）。假设为拉伸加载，因此屈服函数可写为 $f(\\sigma,\\epsilon_{p}) = \\sigma - \\sigma_{y}(\\epsilon_{p})$。\n\n通过采用指数 $m=1$ 和黏性参数 $\\eta>0$ 的 Perzyna 型黏塑性本构，对率无关塑性定律进行正则化，使得塑性应变率为\n$$\n\\dot{\\epsilon}_{p} = \\frac{1}{\\eta} \\left\\langle f(\\sigma,\\epsilon_{p}) \\right\\rangle,\n$$\n其中 $\\langle \\cdot \\rangle$ 表示 Macaulay 括号。\n\n从线性动量守恒\n$$\n\\rho \\, \\ddot{u} = \\frac{\\partial \\sigma}{\\partial x},\n$$\n运动学关系 $\\epsilon = \\frac{\\partial u}{\\partial x}$，弹性定律 $\\sigma = E(\\epsilon - \\epsilon_{p})$，以及上述 Perzyna 定律出发，完成以下任务：\n\n1. 推导 $u(x,t)$ 和 $\\epsilon_{p}(x,t)$ 的耦合演化方程，其形式在塑性流动激活时（即当 $f>0$ 时，因此在对塑性流动状态进行局部线性化时可以移除 Macaulay 括号）有效。\n\n2. 对所得系统在一个均匀的塑性流动参考状态附近进行线性化，该参考状态具有恒定的 $u_{x}$ 和 $\\epsilon_{p}$，在基态下满足 $f=0$。考虑小扰动 $\\hat{u}(x,t)$ 和 $\\hat{\\epsilon}_{p}(x,t)$。假设扰动具有平面波形式 $\\hat{u}(x,t), \\hat{\\epsilon}_{p}(x,t) \\propto \\exp\\!\\left( i (k x - \\omega t) \\right)$，其中波数 $k$ 为实数，角频率 $\\omega$ 为复数。推导连接 $\\omega$ 和 $k$ 的色散关系。\n\n3. 根据色散关系，确定底层弹性介质的波速 $c$ 和在塑性流动状态下黏塑性松弛的线性时间阻尼率 $\\beta$（将两者用 $E$、$H$、$\\rho$ 和 $\\eta$ 表示）。利用这些量，将特征黏性长度尺度定义为 $l_{v} = c/\\beta$，并给出其闭合形式表达式。\n\n基于推导出的色散关系，讨论引入 Perzyna 型黏塑性正则化如何影响在存在软化（$H<0$）时初值问题的适定性和数值解的网格依赖性。最后给出特征黏性长度尺度 $l_{v}$ 的符号表达式。请用米作为单位表示 $l_v$ 的最终答案。无需给出数值；请提供闭合形式的最终表达式。",
            "solution": "该问题陈述在连续介质力学和材料建模领域中构成了一个有效且适定的问题。它描述了一个标准的一维弹黏塑性固体，并要求进行标准的、但详细的数学分析，包括推导、线性化和稳定性分析。所有提供的信息在科学上都是合理的、一致的，并且足以推导出唯一的解。\n\n分析按问题陈述的要求分为四个部分进行。\n\n首先，我们推导位移场 $u(x,t)$ 和塑性应变 $\\epsilon_p(x,t)$ 的耦合演化方程。\n线性动量守恒由下式给出\n$$\n\\rho \\, \\ddot{u} = \\frac{\\partial \\sigma}{\\partial x}\n$$\n其中 $\\rho$ 是密度，$u$ 是位移，$\\sigma$ 是应力。双点表示对时间 $t$ 的二阶偏导数。\n应力 $\\sigma$ 通过线性弹性本构律与总应变 $\\epsilon = \\frac{\\partial u}{\\partial x}$ 和塑性应变 $\\epsilon_p$ 相关联\n$$\n\\sigma = E (\\epsilon - \\epsilon_p) = E \\left(\\frac{\\partial u}{\\partial x} - \\epsilon_p\\right)\n$$\n其中 $E$ 是杨氏模量。将此式代入动量守恒方程，得到第一个演化方程：\n$$\n\\rho \\, \\ddot{u} = \\frac{\\partial}{\\partial x} \\left[ E \\left(\\frac{\\partial u}{\\partial x} - \\epsilon_p\\right) \\right] = E \\frac{\\partial^2 u}{\\partial x^2} - E \\frac{\\partial \\epsilon_p}{\\partial x}\n$$\n该方程耦合了位移场 $u$ 和塑性应变场 $\\epsilon_p$。\n\n第二个演化方程控制塑性应变 $\\epsilon_p$。问题指定了一个具有线性黏性定律（$m=1$）的 Perzyna 型黏塑性模型。对于激活的塑性流动，屈服函数 $f(\\sigma, \\epsilon_p) = \\sigma - \\sigma_y(\\epsilon_p)$ 为正，可以移除 Macaulay 括号。塑性应变率 $\\dot{\\epsilon}_p$ 由下式给出\n$$\n\\dot{\\epsilon}_p = \\frac{1}{\\eta} f(\\sigma, \\epsilon_p) = \\frac{1}{\\eta} (\\sigma - \\sigma_y(\\epsilon_p))\n$$\n其中 $\\eta$ 是黏性参数。屈服应力 $\\sigma_y$ 根据线性硬化/软化定律 $\\sigma_y(\\epsilon_p) = \\sigma_0 + H \\epsilon_p$ 随塑性应变演化，其中 $\\sigma_0$ 是初始屈服应力，$H$ 是硬化模量。将 $\\sigma$ 和 $\\sigma_y$ 的表达式代入流动法则，得到第二个演化方程：\n$$\n\\dot{\\epsilon}_p = \\frac{1}{\\eta} \\left[ E \\left(\\frac{\\partial u}{\\partial x} - \\epsilon_p\\right) - (\\sigma_0 + H \\epsilon_p) \\right]\n$$\n整理此方程，我们得到：\n$$\n\\dot{\\epsilon}_p = \\frac{E}{\\eta} \\frac{\\partial u}{\\partial x} - \\frac{E+H}{\\eta} \\epsilon_p - \\frac{\\sigma_0}{\\eta}\n$$\n因此，$u(x,t)$ 和 $\\epsilon_p(x,t)$ 的耦合演化方程组为：\n$$\n\\rho \\, \\ddot{u} - E \\frac{\\partial^2 u}{\\partial x^2} + E \\frac{\\partial \\epsilon_p}{\\partial x} = 0\n$$\n$$\n\\dot{\\epsilon}_p + \\frac{E+H}{\\eta} \\epsilon_p - \\frac{E}{\\eta} \\frac{\\partial u}{\\partial x} + \\frac{\\sigma_0}{\\eta} = 0\n$$\n\n其次，我们在这个均匀的、塑性流动的参考状态附近对该系统进行线性化。该参考状态的特点是具有恒定的总应变 $\\frac{\\partial u_0}{\\partial x} = \\epsilon_{0}$ 和恒定的塑性应变 $\\epsilon_{p0}$，它们与时间无关。在此基态下，$f=0$ 的条件成立，意味着 $\\sigma_0 = \\sigma_{y}(\\epsilon_{p0})$，其中 $\\sigma_0 = E(\\epsilon_0 - \\epsilon_{p0})$。因此，$E(\\epsilon_0 - \\epsilon_{p0}) - (\\sigma_0 + H\\epsilon_{p0}) = 0$。\n我们引入小扰动 $\\hat{u}(x,t)$ 和 $\\hat{\\epsilon}_p(x,t)$，使得 $u(x,t) = \\epsilon_0 x + \\hat{u}(x,t)$ 且 $\\epsilon_p(x,t) = \\epsilon_{p0} + \\hat{\\epsilon}_p(x,t)$。将这些代入耦合方程并仅保留扰动的一阶项，得到线性化系统：\n$$\n\\rho \\, \\ddot{\\hat{u}} - E \\frac{\\partial^2 \\hat{u}}{\\partial x^2} + E \\frac{\\partial \\hat{\\epsilon}_p}{\\partial x} = 0\n$$\n$$\n\\dot{\\hat{\\epsilon}}_p + \\frac{E+H}{\\eta} \\hat{\\epsilon}_p - \\frac{E}{\\eta} \\frac{\\partial \\hat{u}}{\\partial x} = 0\n$$\n接下来，我们假设扰动的平面波解形式为 $\\hat{u}(x,t) = U_0 \\exp(i(kx - \\omega t))$ 和 $\\hat{\\epsilon}_p(x,t) = P_0 \\exp(i(kx - \\omega t))$，其中 $k$ 是实波数，$\\omega$ 是复角频率。其导数为 $\\ddot{\\hat{u}} = -\\omega^2 \\hat{u}$，$\\frac{\\partial \\hat{u}}{\\partial x} = ik\\hat{u}$，$\\frac{\\partial^2 \\hat{u}}{\\partial x^2} = -k^2 \\hat{u}$，$\\dot{\\hat{\\epsilon}}_p = -i\\omega \\hat{\\epsilon}_p$，以及 $\\frac{\\partial \\hat{\\epsilon}_p}{\\partial x} = ik\\hat{\\epsilon}_p$。将这些代入线性化偏微分方程，得到关于振幅 $U_0$ 和 $P_0$ 的代数系统：\n$$\n(-\\rho \\omega^2 + E k^2) U_0 + (iEk) P_0 = 0\n$$\n$$\n\\left(-i\\frac{Ek}{\\eta}\\right) U_0 + \\left(-i\\omega + \\frac{E+H}{\\eta}\\right) P_0 = 0\n$$\n为了得到非平凡解 $(U_0, P_0)$，系数矩阵的行列式必须为零：\n$$\n\\det \\begin{pmatrix} E k^2 - \\rho \\omega^2 & iEk \\\\ -i\\frac{Ek}{\\eta} & \\frac{E+H}{\\eta} - i\\omega \\end{pmatrix} = 0\n$$\n计算行列式得到色散关系：\n$$\n(E k^2 - \\rho \\omega^2) \\left(\\frac{E+H}{\\eta} - i\\omega\\right) - (iEk)\\left(-i\\frac{Ek}{\\eta}\\right) = 0\n$$\n$$\n(E k^2 - \\rho \\omega^2) \\left(\\frac{E+H}{\\eta} - i\\omega\\right) - \\frac{E^2 k^2}{\\eta} = 0\n$$\n展开并整理各项，我们得到一个关于 $\\omega$ 的三次多项式：\n$$\nE k^2 \\frac{E+H}{\\eta} - i\\omega E k^2 - \\rho \\omega^2 \\frac{E+H}{\\eta} + i\\rho\\omega^3 - \\frac{E^2 k^2}{\\eta} = 0\n$$\n$$\ni\\rho\\omega^3 - \\rho\\frac{E+H}{\\eta}\\omega^2 - iE k^2 \\omega + \\frac{E H k^2}{\\eta} = 0\n$$\n这就是所要求的连接 $\\omega$ 和 $k$ 的色散关系。\n\n第三，我们确定特征参数。底层弹性介质的波速 $c$ 对应于高频极限（$|\\omega| \\to \\infty$），此时塑性应变的黏性松弛无法发生。在此极限下，材料表现为弹性。纯弹性介质的色散关系为 $\\rho\\omega^2 = E k^2$，这给出了波速 $c = \\sqrt{E/\\rho}$。\n黏塑性松弛的线性时间阻尼率 $\\beta$ 可以从 $\\hat{\\epsilon}_p$ 的线性化方程中确定。如果我们考虑在固定总应变下（即 $\\frac{\\partial \\hat{u}}{\\partial x} = 0$）的塑性应变松弛，该方程变为 $\\dot{\\hat{\\epsilon}}_p = -\\frac{E+H}{\\eta} \\hat{\\epsilon}_p$。这是一个一阶松弛过程，其速率常数为 $\\beta = \\frac{E+H}{\\eta}$。为了发生阻尼，我们必须有 $\\beta > 0$，这要求 $E+H > 0$。\n特征黏性长度尺度 $l_v$ 定义为这两个量的比值：\n$$\nl_v = \\frac{c}{\\beta} = \\frac{\\sqrt{E/\\rho}}{\\frac{E+H}{\\eta}} = \\frac{\\eta \\sqrt{E/\\rho}}{E+H} = \\frac{\\eta}{E+H}\\sqrt{\\frac{E}{\\rho}}\n$$\n这个长度尺度在量纲上是正确的，单位为长度。\n\n最后，我们讨论在材料软化（$H<0$）的情况下，黏塑性正则化对问题适定性的影响。\n在率无关极限下（$\\eta \\to 0$），对于一个软化材料（其中 $-E  H  0$），切线模量 $E_T = \\frac{EH}{E+H}$ 变为负值。波传播的控制方程变为 $\\rho \\ddot{u} - E_T \\frac{\\partial^2 u}{\\partial x^2} = 0$，对于时间演化而言，这是一个椭圆型方程。椭圆型方程的初值问题是不适定的。这表现为短波长（$k \\to \\infty$）扰动的无界增长率，导致病态的应变局部化，集中到一个零宽度的区域，并在数值解中产生严重的网格依赖性。\n引入黏塑性正则化（$\\eta  0$）从根本上改变了问题的数学特性。为了分析适定性，我们考察复频率 $\\omega(k) = \\omega_r(k) + i\\omega_i(k)$ 在大波数（$k \\to \\infty$）时的行为。一个模式的增长率由 $\\omega_i(k)$ 给出。如果对于所有 $k$，$\\omega_i(k)$ 都有上界，则问题是适定的。\n根据色散关系，对大 $k$ 的渐近分析表明，传播模式的行为是 $\\omega(k) \\approx \\pm k \\sqrt{E/\\rho} - i \\frac{E}{2\\eta}$。实部 $\\omega_r(k)$ 随 $k$ 线性增长，表明在高波数极限下存在一个有限的相速度 $v_p = \\omega_r/k \\to \\pm\\sqrt{E/\\rho}$。因此，控制系统对于所有 $k$ 都保持双曲型。虚部 $\\omega_i(k)$ 趋于一个有限的常数值 $-\\frac{E}{2\\eta}$。由于增长率 $\\omega_i$ 对所有 $k$ 都是有界的，因此短波长扰动的无界增长被抑制了。因此，即使对于软化材料（$H0$），初值问题也变得适定。\n正则化引入了内禀长度尺度 $l_v$，它设定了局部化带的最小宽度。数值解变得具有网格客观性，这意味着只要网格尺寸足够小以解析长度尺度 $l_v$，随着网格的细化，解会收敛到一个物理的解。与软化相关的物理不稳定性（$H0$ 可能导致增长率为 $-H/\\eta$ 的非传播不稳定模式）并未被消除，但其病态的数学后果被正则化了。\n\n因此，特征黏性长度尺度 $l_v$ 的符号表达式如上所述。",
            "answer": "$$\\boxed{\\frac{\\eta}{E+H}\\sqrt{\\frac{E}{\\rho}}}$$"
        }
    ]
}