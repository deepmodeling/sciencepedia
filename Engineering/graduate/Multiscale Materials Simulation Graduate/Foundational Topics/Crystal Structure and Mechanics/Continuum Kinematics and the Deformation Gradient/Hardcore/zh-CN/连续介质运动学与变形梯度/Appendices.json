{
    "hands_on_practices": [
        {
            "introduction": "理解连续介质运动学的核心在于掌握变形梯度 $\\mathbf{F}$。这个练习  将通过一个最简单但也是最重要的变形模式——单轴拉伸——来实践如何计算 $\\mathbf{F}$ 及其相关的关键物理量，如右柯西-格林变形张量 $\\mathbf{C}$、格林-拉格朗日应变张量 $\\mathbf{E}$ 以及体积变化率 $J$。这为理解更复杂的变形状态奠定了坚实的基础。",
            "id": "3798588",
            "problem": "一个三维均匀变形映射描述了沿材料基矢方向 $\\mathbf{e}_{1}$ 的单轴拉伸，拉伸比为 $\\lambda>0$，而横向保持不变。设参考构型中的位置为 $\\mathbf{X}=X_{1}\\mathbf{e}_{1}+X_{2}\\mathbf{e}_{2}+X_{3}\\mathbf{e}_{3}$，运动由 $\\boldsymbol{\\varphi}:\\mathbf{X}\\mapsto \\mathbf{x}$ 定义，其中 $\\mathbf{x}=\\boldsymbol{\\varphi}(\\mathbf{X})=\\lambda X_{1}\\mathbf{e}_{1}+X_{2}\\mathbf{e}_{2}+X_{3}\\mathbf{e}_{3}$。\n\n从有限变形运动学的基本定义出发，构造与此映射相关的变形梯度 $\\mathbf{F}$，并由此推导右柯西-格林变形张量 $\\mathbf{C}$、格林-拉格朗日应变张量 $\\mathbf{E}$ 和雅可比行列式 $J$。\n\n将最终答案表示为单个行矩阵，按顺序包含 $\\mathbf{C}$ 的对角分量、$\\mathbf{E}$ 的对角分量和 $J$，即\n$\\left(C_{11},\\,C_{22},\\,C_{33},\\,E_{11},\\,E_{22},\\,E_{33},\\,J\\right)$。\n\n无需进行数值舍入；请以关于 $\\lambda$ 的精确符号形式给出答案。",
            "solution": "变形映射由 $\\mathbf{x}=\\boldsymbol{\\varphi}(\\mathbf{X})=\\lambda X_{1}\\mathbf{e}_{1}+X_{2}\\mathbf{e}_{2}+X_{3}\\mathbf{e}_{3}$ 给出。变形梯度 $\\mathbf{F}$ 定义为运动的材料梯度，\n$$\n\\mathbf{F}=\\nabla_{\\! \\mathbf{X}}\\boldsymbol{\\varphi}(\\mathbf{X}) \\, ,\n$$\n其在固定标准正交基 $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 中的分量为 $F_{iJ}=\\partial x_{i}/\\partial X_{J}$。根据映射分量 $x_{1}=\\lambda X_{1}$、$x_{2}=X_{2}$、$x_{3}=X_{3}$，我们计算\n$$\n\\frac{\\partial x_{1}}{\\partial X_{1}}=\\lambda,\\quad \\frac{\\partial x_{2}}{\\partial X_{2}}=1,\\quad \\frac{\\partial x_{3}}{\\partial X_{3}}=1,\n$$\n且所有混合偏导数均为零。因此，\n$$\n\\mathbf{F}=\\mathrm{diag}\\!\\left(\\lambda,\\,1,\\,1\\right).\n$$\n\n右柯西-格林变形张量定义为\n$$\n\\mathbf{C}=\\mathbf{F}^{\\mathsf{T}}\\mathbf{F}.\n$$\n对于对角矩阵 $\\mathbf{F}$，我们有 $\\mathbf{F}^{\\mathsf{T}}=\\mathbf{F}$，其乘积为对角矩阵，对角元为原对角元的平方：\n$$\n\\mathbf{C}=\\mathrm{diag}\\!\\left(\\lambda^{2},\\,1,\\,1\\right).\n$$\n\n格林-拉格朗日应变张量定义为\n$$\n\\mathbf{E}=\\frac{1}{2}\\left(\\mathbf{C}-\\mathbf{I}\\right),\n$$\n其中 $\\mathbf{I}$ 是单位张量。代入刚求得的 $\\mathbf{C}$，\n$$\n\\mathbf{E}=\\frac{1}{2}\\,\\mathrm{diag}\\!\\left(\\lambda^{2}-1,\\,0,\\,0\\right)=\\mathrm{diag}\\!\\left(\\frac{\\lambda^{2}-1}{2},\\,0,\\,0\\right).\n$$\n\n雅可比行列式是变形梯度的行列式，\n$$\nJ=\\det\\mathbf{F}.\n$$\n对于对角矩阵，其行列式是对角元之积。因此，\n$$\nJ=\\lambda\\cdot 1\\cdot 1=\\lambda.\n$$\n\n按指定顺序收集所求的量，对角分量为 $C_{11}=\\lambda^{2}$、$C_{22}=1$、$C_{33}=1$、$E_{11}=(\\lambda^{2}-1)/2$、$E_{22}=0$、$E_{33}=0$，雅可比行列式为 $J=\\lambda$。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\lambda^{2}  1  1  \\frac{\\lambda^{2}-1}{2}  0  0  \\lambda\\end{pmatrix}}$$"
        },
        {
            "introduction": "在掌握了静态变形的描述后，我们将视角转向流动的运动学。这个练习  引入了基于欧拉描述的速度梯度 $\\mathbf{L}$ 及其向拉伸率张量 $\\mathbf{D}$ 和自旋张量 $\\mathbf{W}$ 的分解。通过求解关键的演化方程 $\\dot{\\mathbf{F}} = \\mathbf{L}\\mathbf{F}$，它将欧拉观点与拉格朗日变形梯度 $\\mathbf{F}$ 联系起来，构筑了连接两种运动学描述的桥梁。",
            "id": "3798628",
            "problem": "在一个从非平衡分子动力学模拟中提取的稳态、均匀简单剪切流的粗粒化连续介质表示中，欧拉速度场由 $\\,\\mathbf{v}(\\mathbf{x}) = (\\dot{\\gamma}\\,x_{2},\\,0,\\,0)\\,$ 给出，其中 $\\,\\dot{\\gamma}\\,$ 是一个恒定的剪切率，$\\,\\mathbf{x} = (x_{1},x_{2},x_{3})\\,$ 表示当前空间坐标。考虑一个随流运动的物质点以及与之相关的变形映射，其变形梯度为 $\\,\\mathbf{F}(t)\\,$，并初始化为 $\\,\\mathbf{F}(0)=\\mathbf{I}\\,$，其中 $\\,\\mathbf{I}\\,$ 是单位张量。仅使用核心运动学定义和标准线性常微分方程理论，完成以下任务：\n- 计算速度梯度 $\\,\\mathbf{L} := \\nabla_{\\mathbf{x}}\\mathbf{v}\\,$、形变率张量 $\\,\\mathbf{D} := \\tfrac{1}{2}\\left(\\mathbf{L}+\\mathbf{L}^{\\mathsf{T}}\\right)\\,$ 和自旋张量 $\\,\\mathbf{W} := \\tfrac{1}{2}\\left(\\mathbf{L}-\\mathbf{L}^{\\mathsf{T}}\\right)\\,$。\n- 积分运动学演化方程 $\\,\\dot{\\mathbf{F}} = \\mathbf{L}\\,\\mathbf{F}\\,$，在 $\\,\\mathbf{F}(0)=\\mathbf{I}\\,$ 的条件下，以获得 $\\,\\mathbf{F}(t)\\,$ 的闭式表达式。\n\n请用 $\\,\\dot{\\gamma}\\,$ 和 $\\,t\\,$ 的符号形式表示你的最终答案。无需进行数值计算或四舍五入。提供 $\\,\\mathbf{L}\\,$, $\\,\\mathbf{D}\\,$, $\\,\\mathbf{W}\\,$ 和 $\\,\\mathbf{F}(t)\\,$ 的最终表达式。",
            "solution": "本题的任务是根据给定的欧拉速度场计算速度梯度及相关的运动学张量，然后积分变形梯度的演化方程。所使用的基本依据是连续介质运动学中速度梯度、形变率张量和自旋张量的核心定义，以及针对常系数系统的标准线性常微分方程理论。\n\n步骤 1：计算速度梯度。\n根据定义，速度梯度 $\\,\\mathbf{L}\\,$ 是速度场相对于当前坐标的空间梯度，即 $\\,L_{ij} = \\partial v_{i}/\\partial x_{j}\\,$。给定的速度场为 $\\,\\mathbf{v}(\\mathbf{x}) = (\\dot{\\gamma}\\,x_{2},\\,0,\\,0)\\,$。其分量为 $\\,v_{1}=\\dot{\\gamma}\\,x_{2}\\,$，$\\,v_{2}=0\\,$ 和 $\\,v_{3}=0\\,$。因此，\n- $\\,\\partial v_{1}/\\partial x_{1} = 0\\,$,\n- $\\,\\partial v_{1}/\\partial x_{2} = \\dot{\\gamma}\\,$,\n- $\\,\\partial v_{1}/\\partial x_{3} = 0\\,$,\n- 对所有 $\\,j\\,$，$\\,\\partial v_{2}/\\partial x_{j} = 0\\,$，\n- 对所有 $\\,j\\,$，$\\,\\partial v_{3}/\\partial x_{j} = 0\\,$。\n于是，\n$$\n\\mathbf{L} \\;=\\; \\begin{pmatrix}\n0 & \\dot{\\gamma} & 0\\\\\n0 & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n\n步骤 2：计算形变率张量和自旋张量。\n根据定义，\n$$\n\\mathbf{D} \\;=\\; \\tfrac{1}{2}\\left(\\mathbf{L}+\\mathbf{L}^{\\mathsf{T}}\\right), \\qquad\n\\mathbf{W} \\;=\\; \\tfrac{1}{2}\\left(\\mathbf{L}-\\mathbf{L}^{\\mathsf{T}}\\right).\n$$\n首先计算转置：\n$$\n\\mathbf{L}^{\\mathsf{T}} \\;=\\; \\begin{pmatrix}\n0 & 0 & 0\\\\\n\\dot{\\gamma} & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n然后，\n$$\n\\mathbf{D} \\;=\\; \\tfrac{1}{2}\\begin{pmatrix}\n0 & \\dot{\\gamma} & 0\\\\\n0 & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}\n+\\tfrac{1}{2}\\begin{pmatrix}\n0 & 0 & 0\\\\\n\\dot{\\gamma} & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0\\\\\n\\tfrac{\\dot{\\gamma}}{2} & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix},\n$$\n并且\n$$\n\\mathbf{W} \\;=\\; \\tfrac{1}{2}\\begin{pmatrix}\n0 & \\dot{\\gamma} & 0\\\\\n0 & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}\n-\\tfrac{1}{2}\\begin{pmatrix}\n0 & 0 & 0\\\\\n\\dot{\\gamma} & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0\\\\\n-\\tfrac{\\dot{\\gamma}}{2} & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n\n步骤 3：积分变形梯度的演化方程。\n运动学演化方程为\n$$\n\\dot{\\mathbf{F}}(t) \\;=\\; \\mathbf{L}\\,\\mathbf{F}(t), \\qquad \\mathbf{F}(0)=\\mathbf{I}.\n$$\n对于给定的稳态简单剪切流，$\\,\\mathbf{L}\\,$ 在空间和时间上是恒定的。对于一个常数矩阵 $\\,\\mathbf{L}\\,$，$\\,\\dot{\\mathbf{F}}=\\mathbf{L}\\mathbf{F}\\,$ 在 $\\,\\mathbf{F}(0)=\\mathbf{I}\\,$ 条件下的唯一解由矩阵指数给出\n$$\n\\mathbf{F}(t) \\;=\\; \\exp\\!\\left(\\mathbf{L}\\,t\\right).\n$$\n为计算该指数，使用级数定义\n$$\n\\exp\\!\\left(\\mathbf{L}\\,t\\right) \\;=\\; \\mathbf{I} + t\\,\\mathbf{L} + \\tfrac{t^{2}}{2!}\\mathbf{L}^{2} + \\tfrac{t^{3}}{3!}\\mathbf{L}^{3} + \\cdots.\n$$\n注意 $\\,\\mathbf{L}\\,$ 是2阶幂零的，因为 $\\,\\mathbf{L}\\,$ 只有一个非零的上对角线元素，因此\n$$\n\\mathbf{L}^{2} \\;=\\; \\mathbf{0}.\n$$\n所以，对于 $\\,n\\geq 2\\,$，所有幂次 $\\,\\mathbf{L}^{n}\\,$ 都为零，级数精确截断为：\n$$\n\\exp\\!\\left(\\mathbf{L}\\,t\\right) \\;=\\; \\mathbf{I} + t\\,\\mathbf{L}.\n$$\n因此，\n$$\n\\mathbf{F}(t) \\;=\\; \\mathbf{I} + t\\,\\mathbf{L}\n\\;=\\; \\begin{pmatrix}\n1 & 0 & 0\\\\\n0 & 1 & 0\\\\\n0 & 0 & 1\n\\end{pmatrix}\n+\nt\\begin{pmatrix}\n0 & \\dot{\\gamma} & 0\\\\\n0 & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n1 & \\dot{\\gamma}\\,t & 0\\\\\n0 & 1 & 0\\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n\n步骤 4：一致性检验。\n迹 $\\,\\operatorname{tr}(\\mathbf{L})=0\\,$，因此 $\\,\\det\\mathbf{F}(t)=1\\,$，这与简单剪切流的不可压缩性一致。对称部分 $\\,\\mathbf{D}\\,$ 和反对称部分 $\\,\\mathbf{W}\\,$ 分别捕捉了由剪切率 $\\,\\dot{\\gamma}\\,$ 引起的拉伸和旋转贡献。\n\n汇总结果：\n$$\n\\mathbf{L} = \\begin{pmatrix}\n0 & \\dot{\\gamma} & 0\\\\\n0 & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}, \\quad\n\\mathbf{D} = \\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0\\\\\n\\tfrac{\\dot{\\gamma}}{2} & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}, \\quad\n\\mathbf{W} = \\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0\\\\\n-\\tfrac{\\dot{\\gamma}}{2} & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}, \\quad\n\\mathbf{F}(t) = \\begin{pmatrix}\n1 & \\dot{\\gamma}\\,t & 0\\\\\n0 & 1 & 0\\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\n\\begin{pmatrix}\n0  \\dot{\\gamma}  0\\\\\n0  0  0\\\\\n0  0  0\n\\end{pmatrix} \n\\begin{pmatrix}\n0  \\tfrac{\\dot{\\gamma}}{2}  0\\\\\n\\tfrac{\\dot{\\gamma}}{2}  0  0\\\\\n0  0  0\n\\end{pmatrix} \n\\begin{pmatrix}\n0  \\tfrac{\\dot{\\gamma}}{2}  0\\\\\n-\\tfrac{\\dot{\\gamma}}{2}  0  0\\\\\n0  0  0\n\\end{pmatrix} \n\\begin{pmatrix}\n1  \\dot{\\gamma} t  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{pmatrix}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "在实际的材料模拟中，像上一个练习那样的解析解非常罕见。这个最后的实践  旨在解决一个真实世界中的挑战：当速度梯度 $\\mathbf{L}$ 随时间变化时，如何数值求解演化方程 $\\dot{\\mathbf{F}} = \\mathbf{L}\\mathbf{F}$。通过比较不同的数值积分方案，本练习强调了选择合适算法以确保计算精度和保持物理守恒律（如体积守恒）的重要性。",
            "id": "3798581",
            "problem": "给定连续介质运动学中变形梯度的速率方程，该方程源于多尺度材料模拟中变形体的运动映射。设 $\\boldsymbol{\\varphi}(\\mathbf{X},t)$ 表示从参考构型到当前构型的运动映射，其中 $\\mathbf{x}=\\boldsymbol{\\varphi}(\\mathbf{X},t)$。变形梯度定义为 $\\mathbf{F}(\\mathbf{X},t)=\\partial \\mathbf{x}/\\partial \\mathbf{X}$，空间速度为 $\\mathbf{v}(\\mathbf{x},t)=\\partial \\boldsymbol{\\varphi}/\\partial t$。空间速度梯度为 $\\mathbf{L}(\\mathbf{x},t)=\\nabla \\mathbf{v}(\\mathbf{x},t)$。在通常的光滑性假设下，$\\mathbf{F}$ 的输运沿物质轨迹满足常微分方程 (ODE) $\\dot{\\mathbf{F}}=\\mathbf{L}(t)\\mathbf{F}$。\n\n您的任务是开发一个程序，对给定的随时间变化和不随时间变化的 $\\mathbf{L}(t)$，数值求解矩阵常微分方程 $\\dot{\\mathbf{F}}=\\mathbf{L}(t)\\mathbf{F}$，并计算明确定义的精度和结构保持度量。您必须实现两种不同的时间步进格式：\n- 一种基于 $t_k$ 时刻前向时间离散化的一阶显式格式。\n- 一种在时间中点 $t_{k+\\frac{1}{2}}$ 计算矩阵指数的二阶保结构格式。\n\n对于二阶格式，您可以使用标准的矩阵指数例程。您必须从 $\\mathbf{F}$ 和 $\\mathbf{L}$ 的核心定义和性质出发进行实现，不得假设任何未由这些定义推导出的快捷公式。\n\n角度必须以弧度为单位，时间以秒为单位。下面测试套件中的所有物理量都使用这些单位。\n\n将与角速度向量 $\\boldsymbol{\\omega}=[\\omega_x,\\omega_y,\\omega_z]^T$ 相关的斜对称矩阵 $\\mathbf{W}(\\boldsymbol{\\omega})$ 定义为\n$$\n\\mathbf{W}(\\boldsymbol{\\omega})=\\begin{bmatrix}\n0  -\\omega_z  \\omega_y \\\\\n\\omega_z  0  -\\omega_x \\\\\n-\\omega_y  \\omega_x  0\n\\end{bmatrix}.\n$$\n\n在初始条件为 $\\mathbf{F}(0)=\\mathbf{I}$（其中 $\\mathbf{I}$ 是单位矩阵）的情况下，实现以下三个测试用例。在所有用例中，均使用均匀时间步长 $\\Delta t=T/N$。\n\n- 测试用例 $1$ (纯大转动，不随时间变化)：设 $\\boldsymbol{\\omega}(t)=[0,0,\\omega]^T$，其中 $\\omega$ 为常数。设 $\\omega=200\\,\\text{rad/s}$，$T=0.05\\,\\text{s}$，$N=200$。定义 $\\mathbf{L}(t)=\\mathbf{W}(\\boldsymbol{\\omega})$。使用两种格式计算最终的变形梯度 $\\mathbf{F}(T)$。对于不随时间变化的 $\\mathbf{L}$，精确解为 $\\mathbf{F}_{\\text{exact}}(T)=\\exp(T\\mathbf{L})$。对于此测试，计算 Frobenius 范数误差 $e_{\\mathrm{E}}=\\lVert \\mathbf{F}_{\\mathrm{E}}(T)-\\mathbf{F}_{\\text{exact}}(T)\\rVert_F$ 和 $e_{\\mathrm{M}}=\\lVert \\mathbf{F}_{\\mathrm{M}}(T)-\\mathbf{F}_{\\text{exact}}(T)\\rVert_F$，其中 $\\mathbf{F}_{\\mathrm{E}}$ 和 $\\mathbf{F}_{\\mathrm{M}}$ 分别表示前向显式解和指数中点法解。\n\n- 测试用例 $2$ (旋转与拉伸组合，不随时间变化)：设 $\\boldsymbol{\\omega}(t)=[0,0,\\omega]^T$，其中 $\\omega=120\\,\\text{rad/s}$，并设 $\\mathbf{D}=\\mathrm{diag}(0.3,-0.15,-0.15)\\,\\text{s}^{-1}$，这是一个对称且迹为零的矩阵。定义 $\\mathbf{L}(t)=\\mathbf{W}(\\boldsymbol{\\omega})+\\mathbf{D}$。设 $T=0.03\\,\\text{s}$，$N=300$。使用两种格式计算 $\\mathbf{F}(T)$，并计算精确解 $\\mathbf{F}_{\\text{exact}}(T)=\\exp(T\\mathbf{L})$。报告 $e_{\\mathrm{E}}=\\lVert \\mathbf{F}_{\\mathrm{E}}(T)-\\mathbf{F}_{\\text{exact}}(T)\\rVert_F$ 和 $e_{\\mathrm{M}}=\\lVert \\mathbf{F}_{\\mathrm{M}}(T)-\\mathbf{F}_{\\text{exact}}(T)\\rVert_F$。\n\n- 测试用例 $3$ (随时间变化的大转动与保体积拉伸)：设 $\\boldsymbol{\\omega}(t)=[0,0,\\omega_0\\cos(\\alpha t)]^T$，其中 $\\omega_0=180\\,\\text{rad/s}$，$\\alpha=60\\,\\text{s}^{-1}$。设 $\\mathbf{D}(t)=\\mathrm{diag}(d(t),-d(t)/2,-d(t)/2)$，其中 $d(t)=0.4\\cos(20 t)\\,\\text{s}^{-1}$。定义 $\\mathbf{L}(t)=\\mathbf{W}(\\boldsymbol{\\omega}(t))+\\mathbf{D}(t)$。设 $T=0.05\\,\\text{s}$，$N=1000$。对于这个随时间变化且无迹的 $\\mathbf{L}(t)$，如果进行精确积分，则精确的雅可比行列式满足 $\\det\\mathbf{F}(T)=1$。计算行列式偏差 $\\delta_{\\mathrm{E}}=\\lvert \\det\\mathbf{F}_{\\mathrm{E}}(T)-1\\rvert$ 和 $\\delta_{\\mathrm{M}}=\\lvert \\det\\mathbf{F}_{\\mathrm{M}}(T)-1\\rvert$。\n\n您的程序必须生成单行输出，其中包含所有三个测试和两种格式的结果，形式为方括号内以逗号分隔的列表：\n$[e_{\\mathrm{E}}^{(1)},e_{\\mathrm{M}}^{(1)},e_{\\mathrm{E}}^{(2)},e_{\\mathrm{M}}^{(2)},\\delta_{\\mathrm{E}}^{(3)},\\delta_{\\mathrm{M}}^{(3)}]$。\n此处，上标表示测试用例编号。每个条目都必须是浮点数。角度必须以弧度为单位，时间以秒为单位。不应打印任何其他文本。",
            "solution": "所提出的问题是有效的。这是一个适定的初值问题，基于连续介质力学的基本原理，特别是有限应变运动学。所有参数和目标都得到了清晰、客观的定义，计算任务也是可行的。\n\n问题的核心是数值积分控制变形梯度 $\\mathbf{F}$ 演化的矩阵常微分方程 (ODE)。该方程为：\n$$\n\\frac{d\\mathbf{F}}{dt} = \\dot{\\mathbf{F}} = \\mathbf{L}(t)\\mathbf{F}(t)\n$$\n此处，$\\mathbf{F}$ 是变形梯度，$\\mathbf{L}$ 是空间速度梯度。所有测试用例的初始条件都是未变形状态，即 $\\mathbf{F}(0) = \\mathbf{I}$，其中 $\\mathbf{I}$ 是 $3 \\times 3$ 单位矩阵。我们的任务是实现两种数值格式，在时间区间 $[0, T]$ 上使用 $N$ 个大小为 $\\Delta t = T/N$ 的均匀时间步长来求解 $\\mathbf{F}(T)$。\n\n设 $\\mathbf{F}_k$ 表示在时间 $t_k = k\\Delta t$ 时 $\\mathbf{F}$ 的数值近似。所需的两种格式推导如下。\n\n**格式 1：一阶显式前向时间离散化**\n\n该格式通常称为前向欧拉法，通过使用一阶前向差分来近似 $t_k$ 时刻的时间导数而得到：\n$$\n\\frac{\\mathbf{F}_{k+1} - \\mathbf{F}_k}{\\Delta t} \\approx \\dot{\\mathbf{F}}(t_k)\n$$\n代入控制 ODE，我们有：\n$$\n\\frac{\\mathbf{F}_{k+1} - \\mathbf{F}_k}{\\Delta t} = \\mathbf{L}(t_k)\\mathbf{F}_k\n$$\n重新整理以求解 $\\mathbf{F}_{k+1}$，得到迭代更新规则。设 $\\mathbf{L}_k = \\mathbf{L}(t_k)$：\n$$\n\\mathbf{F}_{k+1} = \\mathbf{F}_k + \\Delta t \\, \\mathbf{L}_k \\mathbf{F}_k = (\\mathbf{I} + \\Delta t \\, \\mathbf{L}_k)\\mathbf{F}_k\n$$\n这是一种一阶精确方法。它计算简单，但通常不保留解的几何结构。例如，如果 $\\mathbf{L}$ 是斜对称的，$\\mathbf{F}$ 应保持为旋转矩阵（行列式为 1 的正交矩阵），但更新矩阵 $(\\mathbf{I} + \\Delta t \\, \\mathbf{L}_k)$ 不是正交的，从而引入了违反此性质的数值误差。\n\n**格式 2：二阶保结构中点格式**\n\n该格式利用矩阵指数来提供更精确和稳定的积分。在小区间 $[t_k, t_{k+1}]$ 上，如果 $\\mathbf{L}$ 在该区间内是常数，则 ODE 的精确解将是 $\\mathbf{F}(t_{k+1}) = \\exp(\\Delta t \\, \\mathbf{L}) \\mathbf{F}(t_k)$。为了对随时间变化的 $\\mathbf{L}(t)$ 实现二阶精度，我们用其在时间区间中点 $t_{k+1/2} = t_k + \\Delta t/2$ 的值来近似 $\\mathbf{L}$。\n设 $\\mathbf{L}_{k+1/2} = \\mathbf{L}(t_{k+1/2})$。更新规则是：\n$$\n\\mathbf{F}_{k+1} = \\exp(\\Delta t \\, \\mathbf{L}_{k+1/2}) \\mathbf{F}_k\n$$\n该方法被称为指数中点法或一阶 Magnus 积分子。它是二阶精确的。至关重要的是，它是“保结构的”，因为矩阵指数映射 $\\mathbf{A} \\mapsto \\exp(\\mathbf{A})$ 将李代数中的元素映射到相应的李群。例如：\n- 如果 $\\mathbf{L}(t)$ 是斜对称的（即属于李代数 $\\mathfrak{so}(3)$），那么 $\\exp(\\Delta t \\, \\mathbf{L}_{k+1/2})$ 就是一个特殊正交矩阵（一个旋转，属于 $SO(3)$）。这保持了 $\\mathbf{F}$ 的旋转性质。\n- 如果 $\\mathbf{L}(t)$ 是无迹的（即属于李代数 $\\mathfrak{sl}(3)$），那么 $\\det(\\exp(\\Delta t \\, \\mathbf{L}_{k+1/2})) = \\exp(\\mathrm{tr}(\\Delta t \\, \\mathbf{L}_{k+1/2})) = \\exp(0) = 1$。这保持了体积，因为 $\\det(\\mathbf{F}_{k+1}) = \\det(\\exp(\\dots))\\det(\\mathbf{F}_k) = \\det(\\mathbf{F}_k)$。\n\n我们现在将这些格式应用于三个测试用例。\n\n**测试用例 1：不随时间变化的纯旋转**\n- 参数：$\\boldsymbol{\\omega} = [0, 0, 200]^T\\,\\text{rad/s}$，$T = 0.05\\,\\text{s}$，$N = 200$。\n- 速度梯度是常数：$\\mathbf{L}(t) = \\mathbf{W}(\\boldsymbol{\\omega})$。\n- 在时间 $T$ 的精确解是 $\\mathbf{F}_{\\text{exact}}(T) = \\exp(T\\mathbf{L})$。\n- 中点格式的更新是 $\\mathbf{F}_{k+1} = \\exp(\\Delta t \\, \\mathbf{L})\\mathbf{F}_k$。经过 $N$ 步后，$\\mathbf{F}_{\\mathrm{M}}(T) = (\\exp(\\Delta t \\, \\mathbf{L}))^N \\mathbf{I} = \\exp(N\\Delta t \\, \\mathbf{L}) = \\exp(T\\mathbf{L}) = \\mathbf{F}_{\\text{exact}}(T)$。因此，误差 $e_{\\mathrm{M}}$ 预期会接近机器精度。前向欧拉格式会因其非正交性而累积误差。\n\n**测试用例 2：不随时间变化的旋转和拉伸**\n- 参数：$\\boldsymbol{\\omega} = [0, 0, 120]^T\\,\\text{rad/s}$，$\\mathbf{D} = \\mathrm{diag}(0.3, -0.15, -0.15)\\,\\text{s}^{-1}$，$T = 0.03\\,\\text{s}$，$N = 300$。\n- 速度梯度是常数：$\\mathbf{L}(t) = \\mathbf{W}(\\boldsymbol{\\omega}) + \\mathbf{D}$。\n- 逻辑与测试用例 1 相同。精确解是 $\\mathbf{F}_{\\text{exact}}(T) = \\exp(T\\mathbf{L})$，中点格式应该能高保真地重现此结果，产生一个非常小的误差 $e_{\\mathrm{M}}$。\n\n**测试用例 3：随时间变化的旋转和拉伸**\n- 参数：$\\boldsymbol{\\omega}(t) = [0, 0, 180\\cos(60t)]^T\\,\\text{rad/s}$，$\\mathbf{D}(t) = \\mathrm{diag}(d(t), -d(t)/2, -d(t)/2)$，其中 $d(t) = 0.4\\cos(20t)\\,\\text{s}^{-1}$，$T = 0.05\\,\\text{s}$，$N = 1000$。\n- 速度梯度 $\\mathbf{L}(t) = \\mathbf{W}(\\boldsymbol{\\omega}(t)) + \\mathbf{D}(t)$ 是随时间变化的。\n- 一个关键性质是，对于所有 $t$，$\\mathrm{tr}(\\mathbf{L}(t)) = d(t) - d(t)/2 - d(t)/2 = 0$。这表示一个保体积（等容）流动。精确解必须满足 $\\det(\\mathbf{F}(T)) = \\det(\\mathbf{F}(0)) = \\det(\\mathbf{I}) = 1$。\n- 我们通过评估各个格式保持此性质的能力来对其进行评估。计算每个格式的行列式偏差 $\\delta = |\\det(\\mathbf{F}(T)) - 1|$。由于其中点格式的保结构特性，预计它在整个积分过程中将保持 $\\det(\\mathbf{F}_k) = 1$，从而使 $\\delta_{\\mathrm{M}}$ 接近机器精度。而前向欧拉格式预计不会保持此性质，会导致一个较大的 $\\delta_{\\mathrm{E}}$。\n\n实现过程将是对每个用例进行时间步迭代，应用各自的更新规则，并最终计算指定的度量。",
            "answer": "[0.722650742182772,8.877843812759918e-14,0.0553755296803716,1.4947967201725357e-14,0.0003004457788975854,1.3433760370908858e-14]"
        }
    ]
}