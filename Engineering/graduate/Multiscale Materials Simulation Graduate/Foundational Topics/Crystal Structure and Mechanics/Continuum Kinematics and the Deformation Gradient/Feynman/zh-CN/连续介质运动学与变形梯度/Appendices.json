{
    "hands_on_practices": [
        {
            "introduction": "本章的第一个实践练习旨在通过一个简单直观的案例——单轴拉伸，来巩固您对基本运动学概念的理解。通过直接应用定义来计算变形梯度 $\\mathbf{F}$、右柯西-格林变形张量 $\\mathbf{C}$ 和格林-拉格朗日应变张量 $\\mathbf{E}$，您将掌握量化有限变形的核心计算方法。这个练习是后续更复杂分析的基础。",
            "id": "3798588",
            "problem": "一个三维均匀变形映射描述了沿材料基矢方向 $\\mathbf{e}_{1}$ 的单轴拉伸，拉伸比为 $\\lambda>0$，而横向保持不变。设参考构型中的位置为 $\\mathbf{X}=X_{1}\\mathbf{e}_{1}+X_{2}\\mathbf{e}_{2}+X_{3}\\mathbf{e}_{3}$，运动定义为 $\\boldsymbol{\\varphi}:\\mathbf{X}\\mapsto \\mathbf{x}$，其中 $\\mathbf{x}=\\boldsymbol{\\varphi}(\\mathbf{X})=\\lambda X_{1}\\mathbf{e}_{1}+X_{2}\\mathbf{e}_{2}+X_{3}\\mathbf{e}_{3}$。\n\n从有限变形运动学的基本定义出发，构建与此映射相关的变形梯度 $\\mathbf{F}$，并由此推导出右柯西-格林变形张量 $\\mathbf{C}$、格林-拉格朗日应变张量 $\\mathbf{E}$ 和雅可比行列式 $J$。\n\n将你的最终答案表示为一个单行矩阵，按此顺序包含 $\\mathbf{C}$ 的对角分量、$\\mathbf{E}$ 的对角分量和 $J$，即\n$\\left(C_{11},\\,C_{22},\\,C_{33},\\,E_{11},\\,E_{22},\\,E_{33},\\,J\\right)$。\n\n无需数值取整；以关于 $\\lambda$ 的精确符号形式给出你的答案。",
            "solution": "变形映射由 $\\mathbf{x}=\\boldsymbol{\\varphi}(\\mathbf{X})=\\lambda X_{1}\\mathbf{e}_{1}+X_{2}\\mathbf{e}_{2}+X_{3}\\mathbf{e}_{3}$ 给出。变形梯度 $\\mathbf{F}$ 定义为运动的物质梯度，\n$$\n\\mathbf{F}=\\nabla_{\\! \\mathbf{X}}\\boldsymbol{\\varphi}(\\mathbf{X}) \\, ,\n$$\n其在固定标准正交基 $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 中的分量为 $F_{iJ}=\\partial x_{i}/\\partial X_{J}$。根据映射的分量 $x_{1}=\\lambda X_{1}$、$x_{2}=X_{2}$、$x_{3}=X_{3}$，我们计算\n$$\n\\frac{\\partial x_{1}}{\\partial X_{1}}=\\lambda,\\quad \\frac{\\partial x_{2}}{\\partial X_{2}}=1,\\quad \\frac{\\partial x_{3}}{\\partial X_{3}}=1,\n$$\n且所有混合偏导数均为零。因此，\n$$\n\\mathbf{F}=\\mathrm{diag}\\!\\left(\\lambda,\\,1,\\,1\\right).\n$$\n\n右柯西-格林变形张量定义为\n$$\n\\mathbf{C}=\\mathbf{F}^{\\top}\\mathbf{F}.\n$$\n对于对角矩阵 $\\mathbf{F}$，我们有 $\\mathbf{F}^{\\top}=\\mathbf{F}$，其乘积为对角矩阵，对角线元素为原元素的平方：\n$$\n\\mathbf{C}=\\mathrm{diag}\\!\\left(\\lambda^{2},\\,1,\\,1\\right).\n$$\n\n格林-拉格朗日应变张量定义为\n$$\n\\mathbf{E}=\\frac{1}{2}\\left(\\mathbf{C}-\\mathbf{I}\\right),\n$$\n其中 $\\mathbf{I}$ 是单位张量。代入刚刚求得的 $\\mathbf{C}$，\n$$\n\\mathbf{E}=\\frac{1}{2}\\,\\mathrm{diag}\\!\\left(\\lambda^{2}-1,\\,0,\\,0\\right)=\\mathrm{diag}\\!\\left(\\frac{\\lambda^{2}-1}{2},\\,0,\\,0\\right).\n$$\n\n雅可比行列式是变形梯度的行列式，\n$$\nJ=\\det(\\mathbf{F}).\n$$\n对于对角矩阵，行列式是对角元素的乘积。因此，\n$$\nJ=\\lambda\\cdot 1\\cdot 1=\\lambda.\n$$\n\n按指定顺序收集所求的量，对角分量为 $C_{11}=\\lambda^{2}$、$C_{22}=1$、$C_{33}=1$，$E_{11}=(\\lambda^{2}-1)/2$、$E_{22}=0$、$E_{33}=0$，雅可比行列式为 $J=\\lambda$。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\lambda^{2}  & 1 & 1 & \\frac{\\lambda^{2}-1}{2} & 0 & 0 & \\lambda\\end{pmatrix}}$$"
        },
        {
            "introduction": "在掌握了静态变形的描述后，我们转向动态过程。这个练习从欧拉速度场的描述出发，介绍了速度梯度 $\\mathbf{L}$ 及其对称部分（应变率张量 $\\mathbf{D}$）和反对称部分（自旋张量 $\\mathbf{W}$）的概念。通过求解变形梯度的演化方程 $\\dot{\\mathbf{F}} = \\mathbf{L}\\mathbf{F}$，您将学习如何连接瞬时变形率与累积的有限变形，这是理解材料在流动和加工过程中行为的关键一步。",
            "id": "3798628",
            "problem": "在一个从非平衡分子动力学模拟中提取的稳态、均匀简单剪切流的粗粒化连续介质表示中，欧拉速度场由 $\\,\\mathbf{v}(\\mathbf{x}) = (\\dot{\\gamma}\\,x_{2},\\,0,\\,0)\\,$ 给出，其中 $\\,\\dot{\\gamma}\\,$ 是一个恒定的剪切速率，$\\,\\mathbf{x} = (x_{1},x_{2},x_{3})\\,$ 表示当前的空间坐标。考虑一个随流运动的物质点以及相关的形变映射，其形变梯度为 $\\,\\mathbf{F}(t)\\,$，初始条件为 $\\,\\mathbf{F}(0)=\\mathbf{I}\\,$，其中 $\\,\\mathbf{I}\\,$ 是单位张量。仅使用核心运动学定义和标准线性常微分方程理论，完成以下任务：\n- 计算速度梯度 $\\,\\mathbf{L} := \\nabla_{\\mathbf{x}}\\mathbf{v}\\,$、形变率张量 $\\,\\mathbf{D} := \\tfrac{1}{2}\\left(\\mathbf{L}+\\mathbf{L}^{\\top}\\right)\\,$ 和自旋张量 $\\,\\mathbf{W} := \\tfrac{1}{2}\\left(\\mathbf{L}-\\mathbf{L}^{\\top}\\right)\\,$。\n- 在初始条件 $\\,\\mathbf{F}(0)=\\mathbf{I}\\,$ 下，积分运动学演化方程 $\\,\\dot{\\mathbf{F}} = \\mathbf{L}\\,\\mathbf{F}\\,$，以获得 $\\,\\mathbf{F}(t)\\,$ 的闭式表达式。\n\n用 $\\,\\dot{\\gamma}\\,$ 和 $\\,t\\,$ 的符号形式表示你的最终答案。不需要进行数值计算或四舍五入。提供 $\\,\\mathbf{L}\\,$、$\\,\\mathbf{D}\\,$、$\\,\\mathbf{W}\\,$ 和 $\\,\\mathbf{F}(t)\\,$ 的最终表达式。",
            "solution": "任务是根据给定的欧拉速度场计算速度梯度及相关的运动学张量，然后积分形变梯度的演化方程。所使用的基本依据是连续介质运动学中速度梯度、形变率张量和自旋张量的核心定义，以及适用于常系数系统的标准线性常微分方程理论。\n\n第一步：计算速度梯度。\n根据定义，速度梯度 $\\,\\mathbf{L}\\,$ 是速度场相对于当前坐标的空间梯度，即 $\\,L_{ij} = \\partial v_{i}/\\partial x_{j}\\,$。给定的速度场为 $\\,\\mathbf{v}(\\mathbf{x}) = (\\dot{\\gamma}\\,x_{2},\\,0,\\,0)\\,$。其分量为 $v_{1}=\\dot{\\gamma}\\,x_{2}$、$v_{2}=0$ 和 $v_{3}=0$。因此，\n- $\\,\\partial v_{1}/\\partial x_{1} = 0\\,$，\n- $\\,\\partial v_{1}/\\partial x_{2} = \\dot{\\gamma}\\,$，\n- $\\,\\partial v_{1}/\\partial x_{3} = 0\\,$，\n- $\\,\\partial v_{2}/\\partial x_{j} = 0\\,$ 对所有 $\\,j\\,$ 成立，\n- $\\,\\partial v_{3}/\\partial x_{j} = 0\\,$ 对所有 $\\,j\\,$ 成立。\n因此，\n$$\n\\mathbf{L} \\;=\\; \\begin{pmatrix}\n0 & \\dot{\\gamma} & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n\n第二步：计算形变率张量和自旋张量。\n根据定义，\n$$\n\\mathbf{D} \\;=\\; \\tfrac{1}{2}\\left(\\mathbf{L}+\\mathbf{L}^{\\top}\\right), \\qquad\n\\mathbf{W} \\;=\\; \\tfrac{1}{2}\\left(\\mathbf{L}-\\mathbf{L}^{\\top}\\right).\n$$\n首先计算转置：\n$$\n\\mathbf{L}^{\\top} \\;=\\; \\begin{pmatrix}\n0 & 0 & 0 \\\\\n\\dot{\\gamma} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n然后，\n$$\n\\mathbf{D} \\;=\\; \\tfrac{1}{2}\\begin{pmatrix}\n0 & \\dot{\\gamma} & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n+\\tfrac{1}{2}\\begin{pmatrix}\n0 & 0 & 0 \\\\\n\\dot{\\gamma} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0 \\\\\n\\tfrac{\\dot{\\gamma}}{2} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix},\n$$\n以及\n$$\n\\mathbf{W} \\;=\\; \\tfrac{1}{2}\\begin{pmatrix}\n0 & \\dot{\\gamma} & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n-\\tfrac{1}{2}\\begin{pmatrix}\n0 & 0 & 0 \\\\\n\\dot{\\gamma} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0 \\\\\n-\\tfrac{\\dot{\\gamma}}{2} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n\n第三步：积分形变梯度的演化方程。\n运动学演化方程为\n$$\n\\dot{\\mathbf{F}}(t) \\;=\\; \\mathbf{L}\\,\\mathbf{F}(t), \\qquad \\mathbf{F}(0)=\\mathbf{I}.\n$$\n对于给定的稳态简单剪切流，$\\,\\mathbf{L}\\,$ 在空间和时间上是恒定的。对于一个恒定的矩阵 $\\,\\mathbf{L}\\,$，方程 $\\,\\dot{\\mathbf{F}}=\\mathbf{L}\\mathbf{F}\\,$ 在初始条件 $\\,\\mathbf{F}(0)=\\mathbf{I}\\,$ 下的唯一解由矩阵指数给出\n$$\n\\mathbf{F}(t) \\;=\\; \\exp\\!\\left(\\mathbf{L}\\,t\\right).\n$$\n为了计算这个指数，使用级数定义\n$$\n\\exp\\!\\left(\\mathbf{L}\\,t\\right) \\;=\\; \\mathbf{I} + t\\,\\mathbf{L} + \\tfrac{t^{2}}{2!}\\mathbf{L}^{2} + \\tfrac{t^{3}}{3!}\\mathbf{L}^{3} + \\cdots.\n$$\n注意到 $\\,\\mathbf{L}\\,$ 是一个2阶幂零矩阵，因为 $\\,\\mathbf{L}\\,$ 只有一个非零的上对角线元素，因此\n$$\n\\mathbf{L}^{2} \\;=\\; \\mathbf{0}.\n$$\n所以，对于 $\\,n\\geq 2\\,$，所有的高次幂 $\\,\\mathbf{L}^{n}\\,$ 都为零，级数精确地截断为：\n$$\n\\exp\\!\\left(\\mathbf{L}\\,t\\right) \\;=\\; \\mathbf{I} + t\\,\\mathbf{L}.\n$$\n因此，\n$$\n\\mathbf{F}(t) \\;=\\; \\mathbf{I} + t\\,\\mathbf{L}\n\\;=\\; \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n+\nt\\begin{pmatrix}\n0 & \\dot{\\gamma} & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n1 & \\dot{\\gamma}\\,t & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n\n第四步：一致性检查。\n迹 $\\,\\operatorname{tr}(\\mathbf{L})=0\\,$，所以 $\\,\\det\\mathbf{F}(t)=1\\,$，这与简单剪切流的不可压缩性一致。对称部分 $\\,\\mathbf{D}\\,$ 和反对称部分 $\\,\\mathbf{W}\\,$ 分别捕捉了由剪切速率 $\\,\\dot{\\gamma}\\,$ 引起的拉伸和旋转贡献。\n\n汇总结果：\n$$\n\\mathbf{L} = \\begin{pmatrix}\n0 & \\dot{\\gamma} & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}, \\quad\n\\mathbf{D} = \\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0 \\\\\n\\tfrac{\\dot{\\gamma}}{2} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}, \\quad\n\\mathbf{W} = \\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0 \\\\\n-\\tfrac{\\dot{\\gamma}}{2} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}, \\quad\n\\mathbf{F}(t) = \\begin{pmatrix}\n1 & \\dot{\\gamma}\\,t & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\n\\begin{pmatrix}\n0 & \\dot{\\gamma} & 0\\\\\n0 & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix} \n&\n\\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0\\\\\n\\tfrac{\\dot{\\gamma}}{2} & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix} \n&\n\\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0\\\\\n-\\tfrac{\\dot{\\gamma}}{2} & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix} \n&\n\\begin{pmatrix}\n1 & \\dot{\\gamma} t & 0\\\\\n0 & 1 & 0\\\\\n0 & 0 & 1\n\\end{pmatrix}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "从解析解到实际的计算机模拟，是多尺度材料建模的关键跨越。这个编程练习旨在解决一个核心挑战：当速度梯度 $\\mathbf{L}(t)$ 是复杂且随时间变化时，如何对演化方程 $\\dot{\\mathbf{F}} = \\mathbf{L}(t)\\mathbf{F}$ 进行数值积分。通过对比一个简单显式格式与一个更稳健的保结构算法，您将深入了解在处理大转动问题时，数值精度、稳定性以及诸如体积守恒等物理性质保持的重要性。",
            "id": "3798581",
            "problem": "给定连续介质运动学中变形梯度的速率方程，该方程源于多尺度材料模拟中变形体的运动映射。令$\\boldsymbol{\\varphi}(\\mathbf{X},t)$表示从参考构型到当前构型的运动映射，其中$\\mathbf{x}=\\boldsymbol{\\varphi}(\\mathbf{X},t)$。变形梯度定义为$\\mathbf{F}(\\mathbf{X},t)=\\partial \\mathbf{x}/\\partial \\mathbf{X}$，空间速度为$\\mathbf{v}(\\mathbf{x},t)=\\partial \\boldsymbol{\\varphi}/\\partial t$。空间速度梯度为$\\mathbf{L}(\\mathbf{x},t)=\\nabla \\mathbf{v}(\\mathbf{x},t)$。在通常的光滑性假设下，$\\mathbf{F}$的输运沿物质轨迹满足常微分方程(ODE) $\\dot{\\mathbf{F}}=\\mathbf{L}(t)\\mathbf{F}$。\n\n您的任务是开发一个程序，对给定的时间相关和时间无关的$\\mathbf{L}(t)$，数值积分矩阵ODE $\\dot{\\mathbf{F}}=\\mathbf{L}(t)\\mathbf{F}$，并计算明确定义的精度和结构保持度量。您必须实现两种不同的时间步进格式：\n- 基于$t_k$时刻前向时间离散化的一阶显式格式。\n- 使用在$t_{k+\\frac{1}{2}}$中点处求值的矩阵指数的二阶保结构格式。\n\n对于二阶格式，您可以使用标准的矩阵指数例程。您的实现必须源于$\\mathbf{F}$和$\\mathbf{L}$的核心定义和性质，不得假定任何未由这些定义所蕴含的捷径公式。\n\n角度必须以弧度为单位，时间以秒为单位。下面测试套件中的所有物理量均使用这些单位。\n\n定义与角速度矢量$\\boldsymbol{\\omega}=[\\omega_x,\\omega_y,\\omega_z]^T$相关的斜对称矩阵$\\mathbf{W}(\\boldsymbol{\\omega})$为\n$$\n\\mathbf{W}(\\boldsymbol{\\omega})=\\begin{bmatrix}\n0  -\\omega_z  \\omega_y \\\\\n\\omega_z  0  -\\omega_x \\\\\n-\\omega_y  \\omega_x  0\n\\end{bmatrix}.\n$$\n\n使用初始条件$\\mathbf{F}(0)=\\mathbf{I}$（其中$\\mathbf{I}$是单位矩阵）实现以下三个测试用例。在所有用例中，均使用均匀时间步长$\\Delta t=T/N$。\n\n- 测试用例1（纯大转动，时间无关）：令$\\boldsymbol{\\omega}(t)=[0,0,\\omega]^T$，其中$\\omega$为常数。设$\\omega=200\\,\\text{rad/s}$，$T=0.05\\,\\text{s}$，$N=200$。定义$\\mathbf{L}(t)=\\mathbf{W}(\\boldsymbol{\\omega})$。用两种格式计算最终变形梯度$\\mathbf{F}(T)$。对于时间无关的$\\mathbf{L}$，精确解为$\\mathbf{F}_{\\text{exact}}(T)=\\exp(T\\mathbf{L})$。对于此测试，计算Frobenius范数误差$e_{\\mathrm{E}}=\\lVert \\mathbf{F}_{\\mathrm{E}}(T)-\\mathbf{F}_{\\text{exact}}(T)\\rVert_F$和$e_{\\mathrm{M}}=\\lVert \\mathbf{F}_{\\mathrm{M}}(T)-\\mathbf{F}_{\\text{exact}}(T)\\rVert_F$，其中$\\mathbf{F}_{\\mathrm{E}}$和$\\mathbf{F}_{\\mathrm{M}}$分别表示前向显式解和指数中点解。\n\n- 测试用例2（组合转动和拉伸，时间无关）：令$\\boldsymbol{\\omega}(t)=[0,0,\\omega]^T$，其中$\\omega=120\\,\\text{rad/s}$，并令$\\mathbf{D}=\\mathrm{diag}(0.3,-0.15,-0.15)\\,\\text{s}^{-1}$，此矩阵对称且迹为零。定义$\\mathbf{L}(t)=\\mathbf{W}(\\boldsymbol{\\omega})+\\mathbf{D}$。设$T=0.03\\,\\text{s}$，$N=300$。用两种格式计算$\\mathbf{F}(T)$以及精确解$\\mathbf{F}_{\\text{exact}}(T)=\\exp(T\\mathbf{L})$。报告$e_{\\mathrm{E}}=\\lVert \\mathbf{F}_{\\mathrm{E}}(T)-\\mathbf{F}_{\\text{exact}}(T)\\rVert_F$和$e_{\\mathrm{M}}=\\lVert \\mathbf{F}_{\\mathrm{M}}(T)-\\mathbf{F}_{\\text{exact}}(T)\\rVert_F$。\n\n- 测试用例3（含保体拉伸的时间相关大转动）：令$\\boldsymbol{\\omega}(t)=[0,0,\\omega_0\\cos(\\alpha t)]^T$，其中$\\omega_0=180\\,\\text{rad/s}$，$\\alpha=60\\,\\text{s}^{-1}$。令$\\mathbf{D}(t)=\\mathrm{diag}(d(t),-d(t)/2,-d(t)/2)$，其中$d(t)=0.4\\cos(20 t)\\,\\text{s}^{-1}$。定义$\\mathbf{L}(t)=\\mathbf{W}(\\boldsymbol{\\omega}(t))+\\mathbf{D}(t)$。设$T=0.05\\,\\text{s}$，$N=1000$。对于这个时间相关且无迹的$\\mathbf{L}(t)$，如果精确积分，精确的雅可比行列式满足$\\det\\mathbf{F}(T)=1$。计算行列式偏差$\\delta_{\\mathrm{E}}=\\lvert \\det\\mathbf{F}_{\\mathrm{E}}(T)-1\\rvert$和$\\delta_{\\mathrm{M}}=\\lvert \\det\\mathbf{F}_{\\mathrm{M}}(T)-1\\rvert$。\n\n您的程序必须生成单行输出，其中包含所有三个测试和两种格式的结果，形式为方括号括起来的逗号分隔列表：\n$[e_{\\mathrm{E}}^{(1)},e_{\\mathrm{M}}^{(1)},e_{\\mathrm{E}}^{(2)},e_{\\mathrm{M}}^{(2)},\\delta_{\\mathrm{E}}^{(3)},\\delta_{\\mathrm{M}}^{(3)}]$。\n此处，上标表示测试用例编号。每个条目必须是浮点数。角度必须以弧度为单位，时间以秒为单位。不应打印任何其他文本。",
            "solution": "所提出的问题是有效的。这是一个适定的初值问题，其基础是连续介质力学的基本原理，特别是有限应变运动学。所有参数和目标都得到了清晰客观的定义，并且计算任务是可行的。\n\n问题的核心是控制变形梯度$\\mathbf{F}$演化的矩阵常微分方程（ODE）的数值积分。该方程为：\n$$\n\\frac{d\\mathbf{F}}{dt} = \\dot{\\mathbf{F}} = \\mathbf{L}(t)\\mathbf{F}(t)\n$$\n在此，$\\mathbf{F}$是变形梯度，$\\mathbf{L}$是空间速度梯度。所有测试用例的初始条件都是未变形状态，即$\\mathbf{F}(0) = \\mathbf{I}$，其中$\\mathbf{I}$是$3 \\times 3$的单位矩阵。我们的任务是实现两种数值格式，使用$N$个大小为$\\Delta t = T/N$的均匀时间步，在时间区间$[0, T]$上求解$\\mathbf{F}(T)$。\n\n令$\\mathbf{F}_k$表示在时间$t_k = k\\Delta t$时$\\mathbf{F}$的数值近似。所要求的两种格式推导如下。\n\n**格式1：一阶显式前向时间离散化**\n\n该格式通常称为前向欧拉法，其推导通过使用一阶前向差分来近似$t_k$时刻的时间导数：\n$$\n\\frac{\\mathbf{F}_{k+1} - \\mathbf{F}_k}{\\Delta t} \\approx \\dot{\\mathbf{F}}(t_k)\n$$\n代入控制ODE，我们得到：\n$$\n\\frac{\\mathbf{F}_{k+1} - \\mathbf{F}_k}{\\Delta t} = \\mathbf{L}(t_k)\\mathbf{F}_k\n$$\n对$\\mathbf{F}_{k+1}$进行整理，得到迭代更新法则。令$\\mathbf{L}_k = \\mathbf{L}(t_k)$：\n$$\n\\mathbf{F}_{k+1} = \\mathbf{F}_k + \\Delta t \\, \\mathbf{L}_k \\mathbf{F}_k = (\\mathbf{I} + \\Delta t \\, \\mathbf{L}_k)\\mathbf{F}_k\n$$\n这是一种一阶精度方法。它计算简单，但通常不保持解的几何结构。例如，如果$\\mathbf{L}$是斜对称的，$\\mathbf{F}$应保持为旋转矩阵（行列式为1的正交矩阵），但更新矩阵$(\\mathbf{I} + \\Delta t \\, \\mathbf{L}_k)$不是正交的，从而引入了违反此性质的数值误差。\n\n**格式2：二阶保结构中点格式**\n\n该格式利用矩阵指数来提供更精确和稳定的积分。如果在小区间$[t_k, t_{k+1}]$上$\\mathbf{L}$是常数，则ODE在该区间上的精确解将是$\\mathbf{F}(t_{k+1}) = \\exp(\\Delta t \\, \\mathbf{L}) \\mathbf{F}(t_k)$。为了对时变的$\\mathbf{L}(t)$实现二阶精度，我们用其在时间区间中点$t_{k+1/2} = t_k + \\Delta t/2$处的值来近似$\\mathbf{L}$。\n令$\\mathbf{L}_{k+1/2} = \\mathbf{L}(t_{k+1/2})$。更新法则是：\n$$\n\\mathbf{F}_{k+1} = \\exp(\\Delta t \\, \\mathbf{L}_{k+1/2}) \\mathbf{F}_k\n$$\n此方法被称为指数中点法或一阶Magnus积分器。它具有二阶精度。关键在于，它是“保结构的”，因为矩阵指数映射$\\mathbf{A} \\mapsto \\exp(\\mathbf{A})$将李代数的元素映射到相应的李群。例如：\n- 如果$\\mathbf{L}(t)$是斜对称的（即属于李代数$\\mathfrak{so}(3)$），那么$\\exp(\\Delta t \\, \\mathbf{L}_{k+1/2})$是一个特殊正交矩阵（一个旋转，在$SO(3)$中）。这保持了$\\mathbf{F}$的旋转性质。\n- 如果$\\mathbf{L}(t)$是无迹的（即属于李代数$\\mathfrak{sl}(3)$），那么$\\det(\\exp(\\Delta t \\, \\mathbf{L}_{k+1/2})) = \\exp(\\mathrm{tr}(\\Delta t \\, \\mathbf{L}_{k+1/2})) = \\exp(0) = 1$。这保持了体积，因为$\\det(\\mathbf{F}_{k+1}) = \\det(\\exp(\\dots))\\det(\\mathbf{F}_k) = \\det(\\mathbf{F}_k)$。\n\n我们现在将这些格式应用于三个测试用例。\n\n**测试用例1：时间无关的纯转动**\n- 参数：$\\boldsymbol{\\omega} = [0, 0, 200]^T\\,\\text{rad/s}$，$T = 0.05\\,\\text{s}$，$N = 200$。\n- 速度梯度是常数：$\\mathbf{L}(t) = \\mathbf{W}(\\boldsymbol{\\omega})$。\n- 在时间$T$的精确解是$\\mathbf{F}_{\\text{exact}}(T) = \\exp(T\\mathbf{L})$。\n- 中点格式的更新是$\\mathbf{F}_{k+1} = \\exp(\\Delta t \\, \\mathbf{L})\\mathbf{F}_k$。经过$N$步后，$\\mathbf{F}_{\\mathrm{M}}(T) = (\\exp(\\Delta t \\, \\mathbf{L}))^N \\mathbf{I} = \\exp(N\\Delta t \\, \\mathbf{L}) = \\exp(T\\mathbf{L}) = \\mathbf{F}_{\\text{exact}}(T)$。因此，误差$e_{\\mathrm{M}}$预期接近机器精度。前向欧拉格式会因其非正交性而累积误差。\n\n**测试用例2：时间无关的转动和拉伸**\n- 参数：$\\boldsymbol{\\omega} = [0, 0, 120]^T\\,\\text{rad/s}$，$\\mathbf{D} = \\mathrm{diag}(0.3, -0.15, -0.15)\\,\\text{s}^{-1}$，$T = 0.03\\,\\text{s}$，$N = 300$。\n- 速度梯度是常数：$\\mathbf{L}(t) = \\mathbf{W}(\\boldsymbol{\\omega}) + \\mathbf{D}$。\n- 逻辑与测试用例1相同。精确解是$\\mathbf{F}_{\\text{exact}}(T) = \\exp(T\\mathbf{L})$，中点格式应能高保真地再现此结果，产生非常小的误差$e_{\\mathrm{M}}$。\n\n**测试用例3：时间相关的转动和拉伸**\n- 参数：$\\boldsymbol{\\omega}(t) = [0, 0, 180\\cos(60t)]^T\\,\\text{rad/s}$，$\\mathbf{D}(t) = \\mathrm{diag}(d(t), -d(t)/2, -d(t)/2)$，其中$d(t) = 0.4\\cos(20t)\\,\\text{s}^{-1}$，$T = 0.05\\,\\text{s}$，$N = 1000$。\n- 速度梯度$\\mathbf{L}(t) = \\mathbf{W}(\\boldsymbol{\\omega}(t)) + \\mathbf{D}(t)$是时间相关的。\n- 一个关键性质是对所有$t$，$\\mathrm{tr}(\\mathbf{L}(t)) = d(t) - d(t)/2 - d(t)/2 = 0$。这表示一个保体积（等容）流。精确解必须满足$\\det(\\mathbf{F}(T)) = \\det(\\mathbf{F}(0)) = \\det(\\mathbf{I}) = 1$。\n- 我们通过评估各个格式保持此性质的能力来对其进行评价。计算每个格式的行列式偏差$\\delta = |\\det(\\mathbf{F}(T)) - 1|$。由于其中点格式的保结构性质，预计它将在整个积分过程中保持$\\det(\\mathbf{F}_k) = 1$，导致$\\delta_{\\mathrm{M}}$接近机器精度。而前向欧拉格式预计不会保持此性质，从而导致一个更大的$\\delta_{\\mathrm{E}}$。\n\n实现过程将是对每个用例进行时间步迭代，应用各自的更新法则，并最终计算指定的度量。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n\n    # Helper function to create the skew-symmetric matrix W\n    def make_W(omega_vec):\n        wx, wy, wz = omega_vec\n        return np.array([\n            [0.0, -wz, wy],\n            [wz, 0.0, -wx],\n            [-wy, wx, 0.0]\n        ])\n\n    def solve_case_1():\n        \"\"\"\n        Solves Test Case 1: pure large rotation, time-independent.\n        \"\"\"\n        omega_val = 200.0\n        T = 0.05\n        N = 200\n        dt = T / N\n\n        omega_vec = np.array([0.0, 0.0, omega_val])\n        L = make_W(omega_vec)\n\n        # Scheme 1: Forward Explicit (FE)\n        F_E = np.identity(3)\n        integrator_E = np.identity(3) + dt * L\n        for _ in range(N):\n            F_E = integrator_E @ F_E\n\n        # Scheme 2: Exponential Midpoint (EM)\n        F_M = np.identity(3)\n        integrator_M = expm(dt * L)\n        for _ in range(N):\n            F_M = integrator_M @ F_M\n\n        # Exact Solution\n        F_exact = expm(T * L)\n\n        # Compute Frobenius norm errors\n        e_E = np.linalg.norm(F_E - F_exact, 'fro')\n        e_M = np.linalg.norm(F_M - F_exact, 'fro')\n\n        return e_E, e_M\n\n    def solve_case_2():\n        \"\"\"\n        Solves Test Case 2: combined rotation and stretch, time-independent.\n        \"\"\"\n        omega_val = 120.0\n        D = np.diag([0.3, -0.15, -0.15])\n        T = 0.03\n        N = 300\n        dt = T / N\n\n        omega_vec = np.array([0.0, 0.0, omega_val])\n        W = make_W(omega_vec)\n        L = W + D\n\n        # Scheme 1: Forward Explicit (FE)\n        F_E = np.identity(3)\n        integrator_E = np.identity(3) + dt * L\n        for _ in range(N):\n            F_E = integrator_E @ F_E\n\n        # Scheme 2: Exponential Midpoint (EM)\n        F_M = np.identity(3)\n        integrator_M = expm(dt * L)\n        for _ in range(N):\n            F_M = integrator_M @ F_M\n        \n        # Exact Solution\n        F_exact = expm(T * L)\n\n        # Compute Frobenius norm errors\n        e_E = np.linalg.norm(F_E - F_exact, 'fro')\n        e_M = np.linalg.norm(F_M - F_exact, 'fro')\n\n        return e_E, e_M\n\n    def solve_case_3():\n        \"\"\"\n        Solves Test Case 3: time-dependent rotation and volume-preserving stretch.\n        \"\"\"\n        omega0 = 180.0\n        alpha = 60.0\n        d_amp = 0.4\n        d_freq = 20.0\n        T = 0.05\n        N = 1000\n        dt = T / N\n\n        # Define L(t) as a function\n        def get_L(t):\n            wz_t = omega0 * np.cos(alpha * t)\n            d_t = d_amp * np.cos(d_freq * t)\n            omega_vec_t = np.array([0.0, 0.0, wz_t])\n            W_t = make_W(omega_vec_t)\n            D_t = np.diag([d_t, -d_t / 2.0, -d_t / 2.0])\n            return W_t + D_t\n\n        # Scheme 1: Forward Explicit (FE)\n        F_E = np.identity(3)\n        for k in range(N):\n            t_k = k * dt\n            L_k = get_L(t_k)\n            F_E = (np.identity(3) + dt * L_k) @ F_E\n\n        # Scheme 2: Exponential Midpoint (EM)\n        F_M = np.identity(3)\n        for k in range(N):\n            t_k_half = (k + 0.5) * dt\n            L_k_half = get_L(t_k_half)\n            F_M = expm(dt * L_k_half) @ F_M\n\n        # Compute determinant deviations\n        delta_E = abs(np.linalg.det(F_E) - 1.0)\n        delta_M = abs(np.linalg.det(F_M) - 1.0)\n\n        return delta_E, delta_M\n\n    # Run all test cases\n    e_E1, e_M1 = solve_case_1()\n    e_E2, e_M2 = solve_case_2()\n    delta_E3, delta_M3 = solve_case_3()\n    \n    # Collate results\n    results = [e_E1, e_M1, e_E2, e_M2, delta_E3, delta_M3]\n    \n    # Print in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}