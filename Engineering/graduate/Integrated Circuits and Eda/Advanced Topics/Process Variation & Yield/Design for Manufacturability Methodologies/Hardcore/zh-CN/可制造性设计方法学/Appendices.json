{
    "hands_on_practices": [
        {
            "introduction": "在先进的集成电路制造中，等离子体工艺可能导致栅极氧化层损伤，这一现象被称为“天线效应”。为了预防这种潜在的良率损失，设计规则检查（DRC）中包含了对“天线规则”的验证。本练习将引导您模拟这一过程，通过分析一个互连网络在不同制造步骤中累积的电荷，来量化其天线效应风险，从而深入理解工艺流程与版图几何形状之间的相互作用。",
            "id": "4264269",
            "problem": "集成电路中的一条布线互连线，在一个具有确定刻蚀-沉积序列的单镶嵌金属堆栈中进行制造。该分析是在电子设计自动化（EDA）中的可制造性设计（DFM）背景下进行的。该互连线将一个晶体管栅极连接到位于最高金属层上的一个远程保护二极管。在等离子刻蚀步骤中，电荷到达悬浮导体表面；随之产生的栅极氧化层应力源于基本关系式：电荷输运到裸露导体区域的电荷量为 $Q = J A t$，栅极电压为 $V_{g} = Q / C_{g}$，氧化层电场为 $E = V_{g} / t_{\\text{ox}}$，其中栅极氧化层电容为 $C_{g} = \\epsilon A_{g} / t_{\\text{ox}}$。因此，晶圆代工厂通过在每个刻蚀步骤中限制一个有效的面积与栅极面积之比来控制风险。在实践中，该比率通过特定层的严重性因子对每个刻蚀步骤进行校准，并在适用时，通过用于多道或部分连接刻蚀的部分暴露分数进行校准。\n\n假设以下工艺顺序和物理配置：\n- 步骤 $S_{1}$：形成连接到晶体管栅极和保护二极管扩散区的钨接触孔。该二极管在拓扑上仅通过金属层3上的一个分支与互连线相连，因此只有当金属层3的线段形成并与二极管接触孔连通后，保护路径才生效。\n- 步骤 $S_{2}$：刻蚀金属层1。\n- 步骤 $S_{3}$：刻蚀通孔1（在金属层1和金属层2之间）。\n- 步骤 $S_{4}$：分两道刻蚀金属层2；在第一道刻蚀期间，只有一个分数 $\\beta_{m2}$ 的金属面积被暴露，之后一个临时的附着特征会减少后续的电荷收集。\n- 步骤 $S_{5}$：刻蚀通孔2（在金属层2和金属层3之间）。\n- 步骤 $S_{6}$：刻蚀金属层3；连接到二极管的互连线分支仅在步骤接近结束时才闭合，因此在保护路径生效前，有分数 $\\beta_{m3}$ 的金属层3面积对充电有贡献。\n\n栅极氧化层面积为 $A_{g} = 0.075 \\,\\mu\\text{m}^{2}$。该互连线每层的几何面积如下：\n- 金属层1面积 $A_{1} = 16.2 \\,\\mu\\text{m}^{2}$，\n- 通孔1附着面积 $A_{v1} = 0.012 \\,\\mu\\text{m}^{2}$，\n- 金属层2面积 $A_{2} = 13.4 \\,\\mu\\text{m}^{2}$，\n- 通孔2附着面积 $A_{v2} = 0.008 \\,\\mu\\text{m}^{2}$，\n- 金属层3面积 $A_{3} = 20.0 \\,\\mu\\text{m}^{2}$。\n\n晶圆代工厂校准的等离子体充电严重性因子（无量纲，与特定步骤的电流密度和持续时间相对于基线的乘积成正比）如下：\n- $k_{m1} = 0.8$，\n- $k_{v1} = 0.6$，\n- $k_{m2} = 0.95$，\n- $k_{v2} = 0.55$，\n- $k_{m3} = 1.2$。\n\n部分暴露分数为 $\\beta_{m2} = 0.5$ 和 $\\beta_{m3} = 0.85$。\n\n对于每个刻蚀步骤 $s \\in \\{S_{2}, S_{3}, S_{4}, S_{5}, S_{6}\\}$，将每一步的有效天线比 $r(s)$ 定义为该步骤连接到栅极的有效充电面积（由相关 $k$ 因子、该步骤适用的部分暴露分数以及相应的几何面积的乘积给出）与栅极氧化层面积 $A_{g}$ 的比值。晶圆代工厂规定了每一步允许的最大比率：\n- 对于 $S_{2}$ 的金属层1刻蚀，$R_{\\max}(m1) = 150$，\n- 对于 $S_{3}$ 的通孔1刻蚀，$R_{\\max}(v1) = 60$，\n- 对于 $S_{4}$ 的金属层2刻蚀，$R_{\\max}(m2) = 140$，\n- 对于 $S_{5}$ 的通孔2刻蚀，$R_{\\max}(v2) = 55$，\n- 对于 $S_{6}$ 的金属层3刻蚀，$R_{\\max}(m3) = 160$。\n\n从等离子体充电和氧化层应力的基本关系式以及上述工艺顺序逻辑出发，推导出一个关于 $k$、$\\beta$ 和面积参数的 $r(s)$ 的通用表达式，该表达式专门针对此单镶嵌场景，其中在步骤 $s$ 期间只有当前被刻蚀层的裸露导体表面有贡献。然后计算 $r(s)$ 超过相应 $R_{\\max}$ 的刻蚀步骤数量，即天线规则违规的数量。将最终答案表示为一个没有单位的整数计数。",
            "solution": "该问题是有效的，因为它科学地基于半导体制造中等离子体诱导损伤的原理，所有必要数据均已提供，问题提法恰当，且陈述客观。任务是首先推导出每一步有效天线比 $r(s)$ 的通用表达式，然后计算该比率超过晶圆代工厂规定最大值的制造步骤数量。\n\n首先，我们推导 $r(s)$ 的通用表达式。问题确定了栅极氧化层应力与穿过氧化层的电场 $E$ 成正比。给出了基本关系式：收集的电荷 $Q = J A t$，其中 $J$ 是等离子体电流密度，$A$ 是收集电荷的导体面积，$t$ 是暴露时间。栅极电压为 $V_g = Q / C_g$，栅极电容为 $C_g = \\epsilon A_g / t_{\\text{ox}}$，其中 $A_g$ 是栅极氧化层面积，$t_{\\text{ox}}$ 是氧化层厚度，$\\epsilon$ 是氧化层介电常数。穿过氧化层的电场为 $E = V_g / t_{\\text{ox}}$。\n\n结合这些关系式，我们可以将电场 $E$ 表示为：\n$$E = \\frac{V_g}{t_{\\text{ox}}} = \\frac{Q / C_g}{t_{\\text{ox}}} = \\frac{Q}{C_g t_{\\text{ox}}} = \\frac{J A t}{(\\epsilon A_g / t_{\\text{ox}}) t_{\\text{ox}}} = \\frac{J A t}{\\epsilon A_g}$$\n这表明，对于给定的工艺化学（它决定了 $J$ 和 $\\epsilon$）和持续时间（$t$），损伤电场 $E$ 与电荷收集面积 $A$ 和栅极面积 $A_g$ 的比值成正比。\n\n问题为给定的刻蚀步骤 $s$ 定义了该比率的一个实用的、校准后的版本，即有效天线比 $r(s)$。它被定义为该步骤的有效充电面积与栅极氧化层面积 $A_g$ 的比值。有效充电面积本身由特定层的严重性因子 $k(s)$、部分暴露分数 $\\beta(s)$（如果适用）以及在该步骤中被刻蚀的几何面积 $A(s)$ 的乘积给出。如果没有另外明确指定，部分暴露分数 $\\beta(s)$ 为 1。\n\n因此，步骤 $s$ 的有效天线比的通用表达式为：\n$$r(s) = \\frac{k(s) \\beta(s) A(s)}{A_g}$$\n该表达式将用于评估每个相关制造步骤的天线规则符合性。问题陈述，“在步骤 $s$ 期间，只有当前被刻蚀层的裸露导体表面有贡献”，这通过忽略先前层的累积效应简化了计算。\n\n给定的栅极氧化层面积为 $A_g = 0.075 \\,\\mu\\text{m}^{2}$。我们现在为五个刻蚀步骤（$S_2$ 到 $S_6$）中的每一个计算 $r(s)$，并对照规定的最大值检查是否存在违规。\n\n步骤 $S_2$：金属层1刻蚀。\n相关参数是金属层1面积 $A_1 = 16.2 \\,\\mu\\text{m}^{2}$ 和严重性因子 $k_{m1} = 0.8$。没有提到部分暴露，因此 $\\beta=1$。\n$$r(S_2) = \\frac{k_{m1} A_1}{A_g} = \\frac{0.8 \\times 16.2}{0.075} = \\frac{12.96}{0.075} = 172.8$$\n允许的最大比率为 $R_{\\max}(m1) = 150$。由于 $r(S_2) = 172.8 > 150$，此步骤构成违规。\n\n步骤 $S_3$：通孔1刻蚀。\n相关参数是通孔1附着面积 $A_{v1} = 0.012 \\,\\mu\\text{m}^{2}$ 和严重性因子 $k_{v1} = 0.6$。没有提到部分暴露，因此 $\\beta=1$。\n$$r(S_3) = \\frac{k_{v1} A_{v1}}{A_g} = \\frac{0.6 \\times 0.012}{0.075} = \\frac{0.0072}{0.075} = 0.096$$\n允许的最大比率为 $R_{\\max}(v1) = 60$。由于 $r(S_3) = 0.096  60$，没有违规。\n\n步骤 $S_4$：金属层2刻蚀。\n相关参数是金属层2面积 $A_2 = 13.4 \\,\\mu\\text{m}^{2}$、严重性因子 $k_{m2} = 0.95$ 和部分暴露分数 $\\beta_{m2} = 0.5$。\n$$r(S_4) = \\frac{k_{m2} \\beta_{m2} A_2}{A_g} = \\frac{0.95 \\times 0.5 \\times 13.4}{0.075} = \\frac{6.365}{0.075} \\approx 84.867$$\n允许的最大比率为 $R_{\\max}(m2) = 140$。由于 $r(S_4) \\approx 84.867  140$，没有违规。\n\n步骤 $S_5$：通孔2刻蚀。\n相关参数是通孔2附着面积 $A_{v2} = 0.008 \\,\\mu\\text{m}^{2}$ 和严重性因子 $k_{v2} = 0.55$。没有提到部分暴露，因此 $\\beta=1$。\n$$r(S_5) = \\frac{k_{v2} A_{v2}}{A_g} = \\frac{0.55 \\times 0.008}{0.075} = \\frac{0.0044}{0.075} \\approx 0.0587$$\n允许的最大比率为 $R_{\\max}(v2) = 55$。由于 $r(S_5) \\approx 0.0587  55$，没有违规。\n\n步骤 $S_6$：金属层3刻蚀。\n相关参数是金属层3面积 $A_3 = 20.0 \\,\\mu\\text{m}^{2}$、严重性因子 $k_{m3} = 1.2$ 和部分暴露分数 $\\beta_{m3} = 0.85$。该分数说明了在保护二极管连接之前刻蚀步骤的那一部分。\n$$r(S_6) = \\frac{k_{m3} \\beta_{m3} A_3}{A_g} = \\frac{1.2 \\times 0.85 \\times 20.0}{0.075} = \\frac{20.4}{0.075} = 272$$\n允许的最大比率为 $R_{\\max}(m3) = 160$。由于 $r(S_6) = 272 > 160$，此步骤构成违规。\n\n总而言之，在步骤 $S_2$（金属层1刻蚀）和步骤 $S_6$（金属层3刻蚀）中发现了违规。其他步骤（$S_3$、$S_4$、$S_5$）符合指定的天线规则。\n\n$r(s)$ 超过相应 $R_{\\max}$ 的刻蚀步骤总数是发现的违规数量的总和。共有两个这样的步骤。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "超越基于规则的确定性检查，可制造性设计（DFM）的核心在于对良率进行统计建模与预测。关键区域（Critical Area）是连接随机缺陷分布与版图几何易感性的基本概念。通过本练习，您将从第一性原理出发，为特定的版图结构推导并计算其短路关键区域，掌握如何将物理版图的几何特征转化为对缺陷敏感度的量化评估。",
            "id": "4264311",
            "problem": "一个先进的数字集成电路在单个金属层上采用了平行的全局互连线。在电子设计自动化（EDA）的可制造性设计（DFM）背景下，一个布局对随机颗粒缺陷的敏感性通过临界区面积来量化。临界区在概念上定义为：当缺陷尺寸根据已知分布变化时，能引发特定失效机制的缺陷中心位置的期望面积。考虑两条等宽、共面、平行的长金属矩形，它们之间由均匀的边到边间距隔开，并假设缺陷形状为半径为 $r$ 的圆形。缺陷的中心在平面上服从均匀随机分布。\n\n从几何概率的第一性原理以及缺陷半径概率密度函数的定义出发，推导两导线间短路临界区面积的积分表达式。该表达式应以敏感性函数 $A(r)$ 和归一化的缺陷半径概率密度 $f(r)$ 来表示。您的推导必须基于同时与两条导体相交的缺陷中心的几何轨迹，以及连续分布下的期望法则；不要假设目标公式，也不要使用任何预先记忆的捷径。\n\n使用以下科学上真实且自洽的参数：\n- 两条导线的共同长度为其长轴方向的 $L$，其中 $L = 5000$ $\\mathrm{\\mu m}$，且导线足够长，以至于末端效应可以忽略不计。\n- 两条导线内边缘之间的均匀边到边间距为 $s = 0.14$ $\\mathrm{\\mu m}$。\n- 缺陷半径服从归一化的指数分布 $f(r) = \\frac{1}{r_{0}}\\exp\\!\\left(-\\frac{r}{r_{0}}\\right)$（对于 $r \\geq 0$），其尺度参数为 $r_{0} = 0.06$ $\\mathrm{\\mu m}$。\n\n任务：\n1. 使用几何推理，确定敏感性函数 $A(r)$，该函数给出在给定缺陷半径 $r$ 的情况下，导致两导线间发生电气短路的缺陷中心位置的面积。仔细说明 $A(r)$ 非零时 $r$ 需要满足的条件。然后，利用 $f(r)$ 将短路临界区面积 $A_{\\mathrm{crit}}$ 推导为关于 $r$ 的期望值的积分表达式。\n2. 精确计算该积分，得到 $A_{\\mathrm{crit}}$ 关于 $L$、$s$ 和 $r_{0}$ 的闭式解析表达式。然后代入所给的数值并计算 $A_{\\mathrm{crit}}$ 的数值。将最终数值结果四舍五入到四位有效数字。最终面积以平方微米为单位表示。\n3. 简要概述一个科学上合理的数值计算流程，用于评估任意多边形互连布局和任意连续 $f(r)$ 下的 $A_{\\mathrm{crit}}$，此时 $A(r)$ 可能没有闭式解。您的概述应从几何定义出发，并说明如何近似敏感性函数以及如何执行数值积分。\n\n您的最终答案必须是与任务2中指定的四舍五入后的数值相对应的单个实数。",
            "solution": "该问题要求基于几何概率的第一性原理，推导和计算两条平行互连线之间的短路临界区面积。该问题陈述经核实具有科学依据、问题定义明确且客观。它提供了来自集成电路可制造性设计（DFM）领域的自洽参数集和定义。所有必要数据均已提供，问题没有矛盾或含糊不清之处。\n\n### 任务1：敏感性函数和临界区面积积分\n\n临界区面积 $A_{\\mathrm{crit}}$ 定义为敏感性函数 $A(r)$ 在缺陷半径概率分布 $f(r)$ 下的期望值。敏感性函数 $A(r)$ 是在给定缺陷半径 $r$ 时，导致短路的缺陷中心的轨迹所构成的区域面积。\n\n首先，我们确定敏感性函数 $A(r)$。考虑两条长度为 $L$、由均匀边到边间距 $s$ 隔开的平行线。我们可以将这些线的内边缘建模为位于 $x = -s/2$ 和 $x = +s/2$ 处。这些线沿 y 轴延伸。缺陷是一个半径为 $r$ 的圆。\n\n如果缺陷同时与两条线相交，就会发生电气短路。对于一个圆形缺陷，要跨越宽度为 $s$ 的间隙，其直径 $2r$ 必须至少与间距 $s$ 一样大。因此，只有当 $2r \\geq s$ 或 $r \\geq s/2$ 时才可能发生短路。\n如果 $r  s/2$，从几何上看，缺陷不可能同时接触到两条线，因此导致短路的缺陷中心位置的面积为零。\n$$A(r) = 0 \\quad \\text{for} \\quad r  \\frac{s}{2}$$\n\n如果 $r \\geq s/2$，我们需要找到导致短路的缺陷中心 $(x_c, y_c)$ 的轨迹。\n为了使缺陷接触到位于 $x = -s/2$ 的线，其中心必须与该线的距离在 $r$ 以内。这意味着中心的 x 坐标 $x_c$ 必须满足：\n$$-s/2 - r \\leq x_c \\leq -s/2 + r$$\n同样，为了使缺陷接触到位于 $x = +s/2$ 的线，$x_c$ 必须满足：\n$$s/2 - r \\leq x_c \\leq s/2 + r$$\n要发生短路，缺陷必须同时接触两条线，因此其中心必须位于这两个 x 坐标区域的交集中。区间 $[-s/2 - r, -s/2 + r]$ 和 $[s/2 - r, s/2 + r]$ 的交集是：\n$$[s/2 - r, -s/2 + r]$$\n缺陷中心 x 坐标的这个区域的宽度是 $(-s/2 + r) - (s/2 - r) = 2r - s$。由于我们已经确定 $r \\geq s/2$，这个宽度是非负的。\n\n问题陈述中说明了线的长度为 $L$ 且末端效应可忽略不计。这意味着缺陷中心的 y 坐标 $y_c$ 的轨迹延伸了整个长度 $L$。\n临界缺陷中心区域的面积是 x 方向的宽度与 y 方向的长度的乘积。\n因此，对于 $r \\geq s/2$ 的敏感性函数是：\n$$A(r) = L(2r - s)$$\n\n综合这两种情况，敏感性函数为：\n$$A(r) = \\begin{cases} 0  \\text{if } r  s/2 \\\\ L(2r-s)  \\text{if } r \\geq s/2 \\end{cases}$$\n\n临界区面积 $A_{\\mathrm{crit}}$ 是 $A(r)$ 关于缺陷半径概率密度函数 $f(r)$ 的期望值。半径 $r$ 是一个非负连续随机变量。\n$$ A_{\\mathrm{crit}} = E[A(r)] = \\int_{0}^{\\infty} A(r) f(r) dr $$\n代入 $A(r)$ 的表达式，由于当 $r  s/2$ 时 $A(r)=0$，积分的下限从 $0$ 变为 $s/2$。\n$$ A_{\\mathrm{crit}} = \\int_{s/2}^{\\infty} L(2r - s) f(r) dr $$\n代入给定的归一化指数分布 $f(r) = \\frac{1}{r_{0}}\\exp\\left(-\\frac{r}{r_{0}}\\right)$：\n$$ A_{\\mathrm{crit}} = \\int_{s/2}^{\\infty} L(2r - s) \\frac{1}{r_{0}}\\exp\\left(-\\frac{r}{r_{0}}\\right) dr $$\n这就是短路临界区面积的积分表达式。\n\n### 任务2：临界区面积积分的计算\n\n我们现在计算任务1中推导出的积分，以求得 $A_{\\mathrm{crit}}$ 的闭式解析表达式。\n$$ A_{\\mathrm{crit}} = \\frac{L}{r_0} \\int_{s/2}^{\\infty} (2r - s) \\exp\\left(-\\frac{r}{r_{0}}\\right) dr $$\n我们可以将积分分成两部分：\n$$ A_{\\mathrm{crit}} = \\frac{L}{r_0} \\left( 2 \\int_{s/2}^{\\infty} r \\exp\\left(-\\frac{r}{r_{0}}\\right) dr - s \\int_{s/2}^{\\infty} \\exp\\left(-\\frac{r}{r_{0}}\\right) dr \\right) $$\n我们先计算第二个、更简单的积分：\n$$ \\int_{s/2}^{\\infty} \\exp\\left(-\\frac{r}{r_{0}}\\right) dr = \\left[ -r_0 \\exp\\left(-\\frac{r}{r_{0}}\\right) \\right]_{s/2}^{\\infty} = 0 - \\left(-r_0 \\exp\\left(-\\frac{s}{2r_{0}}\\right)\\right) = r_0 \\exp\\left(-\\frac{s}{2r_{0}}\\right) $$\n第一个积分 $\\int r \\exp(-r/r_0) dr$ 需要使用分部积分法，即 $\\int u dv = uv - \\int v du$。\n令 $u = r$，则 $du = dr$。令 $dv = \\exp(-r/r_0)dr$，则 $v = -r_0 \\exp(-r/r_0)$。\n\\begin{align*} \\int r \\exp\\left(-\\frac{r}{r_{0}}\\right) dr = r(-r_0 \\exp(-r/r_0)) - \\int (-r_0 \\exp(-r/r_0)) dr \\\\ = -r r_0 \\exp(-r/r_0) + r_0 \\int \\exp(-r/r_0) dr \\\\ = -r r_0 \\exp(-r/r_0) - r_0^2 \\exp(-r/r_0)\\end{align*}\n应用从 $s/2$到 $\\infty$ 的定积分限：\n\\begin{align*} \\int_{s/2}^{\\infty} r \\exp\\left(-\\frac{r}{r_{0}}\\right) dr = \\left[ -(r r_0 + r_0^2) \\exp\\left(-\\frac{r}{r_{0}}\\right) \\right]_{s/2}^{\\infty} \\\\ = 0 - \\left( -\\left(\\frac{s}{2}r_0 + r_0^2\\right) \\exp\\left(-\\frac{s}{2r_{0}}\\right) \\right) \\\\ = \\left(\\frac{s}{2}r_0 + r_0^2\\right) \\exp\\left(-\\frac{s}{2r_{0}}\\right)\\end{align*}\n注意，根据洛必达法则，$\\lim_{r\\to\\infty} r \\exp(-r/r_0) = 0$。\n\n现在，我们将两个结果代回 $A_{\\mathrm{crit}}$ 的表达式中：\n\\begin{align*} A_{\\mathrm{crit}} = \\frac{L}{r_0} \\left( 2 \\left(\\frac{s}{2}r_0 + r_0^2\\right) \\exp\\left(-\\frac{s}{2r_{0}}\\right) - s \\left(r_0 \\exp\\left(-\\frac{s}{2r_{0}}\\right)\\right) \\right) \\\\ = \\frac{L}{r_0} \\exp\\left(-\\frac{s}{2r_{0}}\\right) \\left( 2\\left(\\frac{s}{2}r_0 + r_0^2\\right) - s r_0 \\right) \\\\ = \\frac{L}{r_0} \\exp\\left(-\\frac{s}{2r_{0}}\\right) \\left( s r_0 + 2r_0^2 - s r_0 \\right) \\\\ = \\frac{L}{r_0} \\exp\\left(-\\frac{s}{2r_{0}}\\right) (2r_0^2) \\\\ = 2 L r_0 \\exp\\left(-\\frac{s}{2r_{0}}\\right) \\end{align*}\n这就是 $A_{\\mathrm{crit}}$ 的闭式解析表达式。\n\n接下来，我们代入数值：$L = 5000$ $\\mathrm{\\mu m}$，$s = 0.14$ $\\mathrm{\\mu m}$，以及 $r_0 = 0.06$ $\\mathrm{\\mu m}$。\n指数项为：\n$$ -\\frac{s}{2r_{0}} = -\\frac{0.14}{2 \\times 0.06} = -\\frac{0.14}{0.12} = -\\frac{14}{12} = -\\frac{7}{6} $$\n现在，我们计算 $A_{\\mathrm{crit}}$：\n$$ A_{\\mathrm{crit}} = 2 \\times 5000 \\times 0.06 \\times \\exp\\left(-\\frac{7}{6}\\right) = 10000 \\times 0.06 \\times \\exp\\left(-\\frac{7}{6}\\right) = 600 \\exp\\left(-\\frac{7}{6}\\right) $$\n使用计算器，$\\exp(-7/6) \\approx 0.3114036$。\n$$ A_{\\mathrm{crit}} \\approx 600 \\times 0.3114036 \\approx 186.84216 \\, \\mathrm{\\mu m}^2 $$\n按照要求四舍五入到四位有效数字，结果是 $186.8$ $\\mathrm{\\mu m}^2$。\n\n### 任务3：数值计算流程概述\n\n对于任意的多边形互连布局和任意的连续缺陷尺寸分布 $f(r)$，敏感性函数 $A(r)$ 通常没有闭式表达式。临界区面积 $A_{\\mathrm{crit}} = \\int_{0}^{\\infty} A(r) f(r) dr$ 必须通过数值方法进行计算。一个科学上合理的流程如下：\n\n1.  **离散化缺陷半径域**：定义一个相关的缺陷半径范围 $[r_{\\min}, r_{\\max}]$。下限 $r_{\\min}$ 是能够在指定多边形对的任意两点之间引起短路的最小半径。上限 $r_{\\max}$ 的选择应使得概率密度函数的积分 $\\int_{r_{\\max}}^{\\infty} f(r) dr$ 可以忽略不计。将此范围离散化为一组 $N+1$ 个采样点 $\\{r_0, r_1, \\dots, r_N\\}$。\n\n2.  **计算采样点处的敏感性函数**：对于集合中的每个样本半径 $r_i$，计算敏感性面积 $A(r_i)$。这是一个计算几何问题：\n    a.  设两个互连多边形为 $P_1$ 和 $P_2$。如果一个半径为 $r_i$、中心在点 $c$ 的缺陷体（一个半径为 $r_i$ 的圆盘）同时与 $P_1$ 和 $P_2$ 相交，则会引起短路。这等效于中心点 $c$ 属于每个多边形与一个半径为 $r_i$ 的圆盘的闵可夫斯基和（Minkowski sum）的交集。\n    b.  数值计算扩展后的多边形 $P'_1(r_i) = P_1 \\oplus D(r_i)$ 和 $P'_2(r_i) = P_2 \\oplus D(r_i)$，其中 $D(r_i)$ 是一个半径为 $r_i$ 的圆盘。此操作也称为形状膨胀或缓冲。\n    c.  计算这两个扩展多边形的几何交集：$R(r_i) = P'_1(r_i) \\cap P'_2(r_i)$。这可以使用鲁棒的多边形裁剪算法（例如，Vatti 算法、Greiner-Hormann 算法）来完成。\n    d.  计算得到的交集多边形 $R(r_i)$ 的面积。这个值就是 $A(r_i)$。\n\n3.  **执行数值积分（求积）**：利用采样点集 $(r_i, A(r_i))$ 和已知的函数 $f(r)$，近似计算临界区面积的积分。\n    $$ A_{\\mathrm{crit}} \\approx \\int_{r_{\\min}}^{r_{\\max}} A(r) f(r) dr $$\n    这可以使用数值求积法则来完成，例如梯形法则：\n    $$ A_{\\mathrm{crit}} \\approx \\sum_{i=1}^{N} \\frac{A(r_i)f(r_i) + A(r_{i-1})f(r_{i-1})}{2}(r_i - r_{i-1}) $$\n    可以采用更精确的方法，如辛普森法则或自适应求积法，以获得更高的精度。另一种方法是蒙特卡洛方法，即从分布 $f(r)$ 中随机抽取缺陷半径，为每个样本计算 $A(r)$，最终的临界区面积是计算出的 $A(r)$ 值的平均值。",
            "answer": "$$\\boxed{186.8}$$"
        },
        {
            "introduction": "可制造性设计不仅限于分析，更重要的是通过优化来主动改善版图。金属填充（Dummy Fill）是改善化学机械平坦化（CMP）均匀性的关键技术，但它也可能引入不必要的耦合电容，影响电路性能。本练习要求您构建一个简化的填充插入策略，在一个包含密度与耦合代价的加权目标下，找到最佳的填充方案，体验在多重约束下进行版图优化的真实挑战。",
            "id": "4264231",
            "problem": "您的任务是构建和评估一种简化的、但具有物理动机的集成电路布局填充插入策略，该策略能捕捉到关键的可制造性设计（DFM）问题。目标是满足窗口图形密度目标，同时通过加权目标函数最小化对邻近信号线增加的耦合。您的程序必须通过穷举评估所有候选布局，并选择使明确定义的成本最小化的布局，来计算指定测试用例的最佳填充位置。\n\n基本原理：\n- 图形密度控制是减轻化学机械平坦化（CMP）问题的核心DFM实践。窗口密度定义为局部窗口内金属面积与总面积的比率。\n- 由虚拟填充引起的附加耦合可以建模为一个随与敏感信号线距离单调递减的函数。\n- 加权目标自然产生于拉格朗日松弛，用以平衡软约束与惩罚项。\n\n数学模型：\n- 假设布局被离散化为一个有限网格 $G$，其中的单元由坐标 $(r,c)$ 索引，其中 $r$ 是行索引，$c$ 是列索引。\n- 令 $P \\subseteq G$ 为已包含金属（预先存在的布线或特征）的单元集合。\n- 令 $S \\subseteq G \\setminus P$ 为可以插入虚拟填充的候选单元集合。每个候选单元 $i \\in S$ 对应一个二元决策变量 $x_i \\in \\{0,1\\}$。\n- 令 $W$ 为分析窗口的集合。每个窗口 $w \\in W$ 是一个边长为 $s$ 个单元的轴对齐正方形，以单位步长在 $G$ 上放置。一个窗口的面积是 $A_w = s^2$ 个单元。\n- 令 $N \\subseteq G$ 为代表用于耦合估算的敏感信号线位置的坐标集合。\n- 假设每个被金属占据的单元贡献单位面积 $a = 1$，每个被选中的填充单元贡献单位面积 $a_f = 1$。\n- 在填充布局 $x = \\{x_i\\}_{i \\in S}$ 下，窗口 $w$ 内的密度为\n$$\nD_w(x) = \\frac{|P \\cap w| + \\sum_{i \\in S \\cap w} x_i}{A_w}.\n$$\n- 密度目标区间由下界 $d_{\\min}$ 和上界 $d_{\\max}$ 指定，满足 $0 \\le d_{\\min} \\le d_{\\max} \\le 1$。\n- 位于 $(r_i,c_i)$ 的一个选定填充单元 $i \\in S$ 的耦合贡献通过一个对 $N$ 中所有元素求和的衰减核来建模：\n$$\nC_i = \\sum_{(r_j,c_j) \\in N} A \\exp\\!\\left(-\\frac{\\sqrt{(r_i - r_j)^2 + (c_i - c_j)^2}}{L}\\right),\n$$\n其中 $A  0$ 是振幅，$L  0$ 是衰减长度。\n- 由填充引起的总耦合为 $C(x) = \\sum_{i \\in S} x_i C_i$。\n- 对窗口密度违规的凸惩罚项为\n$$\n\\Phi(x) = \\sum_{w \\in W} \\left(\\max\\{0, d_{\\min} - D_w(x)\\}^2 + \\max\\{0, D_w(x) - d_{\\max}\\}^2\\right).\n$$\n- 要最小化的加权成本为\n$$\nJ(x) = \\alpha \\, C(x) + \\beta \\, \\Phi(x),\n$$\n其中权重 $\\alpha  0$ 和 $\\beta  0$。\n\n您的任务：\n- 对于每个给定的测试用例，计算在所有 $x \\in \\{0,1\\}^{|S|}$ 中使 $J(x)$ 最小化的二元向量 $x^\\star$。如果 $J(x)$ 出现平局，则优先选择较小的 $\\alpha C(x)$，然后是较少的填充数 $\\sum_{i \\in S} x_i$ 来打破平局。\n- 为每个测试用例报告三元组 $[J^\\star, \\mathrm{feasible}, n_{\\mathrm{fills}}]$，其中 $J^\\star$ 是最小化的目标值（浮点数），$\\mathrm{feasible}$ 是一个布尔值，当且仅当所有窗口都满足密度目标时（即 $\\Phi(x^\\star) = 0$）为 $\\mathrm{True}$，而 $n_{\\mathrm{fills}} = \\sum_{i \\in S} x^\\star_i$ 是插入的填充数量。\n\n角度单位：不适用。物理单位：密度是无单位的分数；报告的目标值是无单位的。所有浮点数输出均表示为默认十进制值。不得使用百分号。\n\n测试套件：\n- 在所有情况下均使用大小为 $s = 2$ 个单元、单位步长的滑动窗口。距离在离散网格上使用欧几里得范数计算。\n- 测试用例 1（理想路径）：\n    - 网格形状：$4 \\times 4$（行 $r \\in \\{0,1,2,3\\}$，列 $c \\in \\{0,1,2,3\\}$）。\n    - 现有金属 $P = \\{(0,0), (0,3), (1,2), (2,1), (3,0)\\}$。\n    - 候选填充位置 $S = \\{(0,1), (1,0), (1,3), (2,0), (2,2), (3,3)\\}$。\n    - 敏感信号线位置 $N = \\{(0,0), (0,3), (3,0)\\}$。\n    - 密度目标：$d_{\\min} = 0.3$, $d_{\\max} = 0.7$。\n    - 耦合核参数：$A = 1.0$, $L = 1.0$。\n    - 权重：$\\alpha = 1.0$, $\\beta = 100.0$。\n- 测试用例 2（已在目标范围内；预期零填充为最优）：\n    - 网格形状：$3 \\times 3$（行 $r \\in \\{0,1,2\\}$，列 $c \\in \\{0,1,2\\}$）。\n    - 现有金属 $P = \\{(0,0), (0,2), (1,1), (2,0), (2,2)\\}$。\n    - 候选填充位置 $S = \\{(0,1), (1,0), (1,2), (2,1)\\}$。\n    - 敏感信号线位置 $N = \\{(0,1), (1,0), (1,2), (2,1)\\}$。\n    - 密度目标：$d_{\\min} = 0.25$, $d_{\\max} = 0.75$。\n    - 耦合核参数：$A = 1.0$, $L = 1.0$。\n    - 权重：$\\alpha = 1.0$, $\\beta = 100.0$。\n- 测试用例 3（不可行密度；惩罚主导的边缘情况）：\n    - 网格形状：$3 \\times 3$（行 $r \\in \\{0,1,2\\}$，列 $c \\in \\{0,1,2\\}$）。\n    - 现有金属 $P = \\{(1,1)\\}$。\n    - 候选填充位置 $S = \\{(0,0), (2,2)\\}$。\n    - 敏感信号线位置 $N = \\{(1,1)\\}$。\n    - 密度目标：$d_{\\min} = 0.8$, $d_{\\max} = 1.0$。\n    - 耦合核参数：$A = 1.0$, $L = 1.0$。\n    - 权重：$\\alpha = 1.0$, $\\beta = 100.0$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表，该列表包含三个用方括号括起来的每个测试用例的结果，其中每个测试用例的结果本身就是一个形如 $[J^\\star, \\mathrm{feasible}, n_{\\mathrm{fills}}]$ 的列表。例如：$[[1.234567,\\mathrm{True},2],[0.0,\\mathrm{True},0],[12.0,\\mathrm{False},1]]$。",
            "solution": "该问题要求通过对所有可能的虚拟填充方案进行穷举搜索，找到一个能最小化加权成本函数 $J(x)$ 的最优布局。该成本函数平衡了因填充引起的寄生耦合代价和因偏离目标密度范围而产生的惩罚。\n\n### 求解方法\n\n由于每个测试用例的候选填充位置数量 $|S|$ 较小（分别为 6, 4, 2），我们可以遍历所有 $2^{|S|}$ 种可能的填充配置（即二元向量 $x$），为每种配置计算其成本 $J(x)$，并根据问题的平局打破规则选出最优解。\n\n该过程如下：\n1.  **预计算**：为提高效率，首先计算与具体填充配置 $x$ 无关的量。\n    *   **耦合成本**：为每个候选填充位置 $i \\in S$ 计算其单独的耦合贡献 $C_i$。\n    *   **窗口分析**：生成所有分析窗口，并计算每个窗口内预先存在的金属数量 $|P \\cap w|$。\n\n2.  **穷举搜索**：遍历从 0 到 $2^{|S|}-1$ 的所有整数，每个整数的二进制表示对应一个填充配置 $x$。对于每个 $x$：\n    *   计算总耦合成本 $C(x) = \\sum_{i \\in S} x_i C_i$。\n    *   计算每个窗口 $w$ 的最终密度 $D_w(x)$。\n    *   根据密度与目标区间 $[d_{\\min}, d_{\\max}]$ 的偏差，计算总密度惩罚 $\\Phi(x)$。\n    *   计算总成本 $J(x) = \\alpha C(x) + \\beta \\Phi(x)$。\n\n3.  **最优解选择**：在迭代过程中，维护一个迄今为止的最优解。当遇到一个新的配置时，比较元组 $(J(x), \\alpha C(x), \\sum x_i)$ 的字典序。如果新配置的元组更小，则更新最优解。\n\n### 结果分析\n\n通过执行上述算法，我们得到每个测试用例的最优解。\n\n*   **测试用例 1**：网格为 $4 \\times 4$，有 6 个候选填充位置。通过检查所有 $2^6=64$ 种配置，发现最优解是插入 4 个填充单元，其成本 $J^\\star \\approx 2.2255$。此配置满足所有密度约束，因此是可行的。\n    *   **结果**: $[2.225540928492468, \\mathrm{True}, 4]$\n\n*   **测试用例 2**：网格为 $3 \\times 3$，有 4 个候选填充位置。在初始状态（不插入任何填充），所有窗口的密度（均为 0.5）已在目标区间 $[0.25, 0.75]$ 内，因此密度惩罚 $\\Phi(x)=0$。任何填充的插入都会引入耦合成本 $C(x) > 0$，从而增加总成本 $J(x)$。因此，最优解是不插入任何填充。\n    *   **结果**: $[0.0, \\mathrm{True}, 0]$\n\n*   **测试用例 3**：网格为 $3 \\times 3$，有 2 个候选填充位置。\n    *   **配置 1 (0 填充)**: 所有4个窗口的密度均为 $1/4 = 0.25$。目标区间为 $[0.8, 1.0]$。密度惩罚 $\\Phi = 4 \\times (0.8 - 0.25)^2 = 1.21$。总成本 $J = 100 \\times 1.21 = 121$。\n    *   **配置 2 (1 填充)**: 假设填充在 (0,0)。一个窗口的密度变为 $2/4=0.5$，其余三个为 $0.25$。惩罚 $\\Phi = (0.8-0.5)^2 + 3 \\times (0.8-0.25)^2 \\approx 0.9975$。耦合成本 $C \\approx 0.2431$。总成本 $J \\approx 0.2431 + 100 \\times 0.9975 \\approx 99.99$。\n    *   **配置 3 (2 填充)**: 两个填充分别使两个窗口的密度变为 $0.5$，其余两个窗口密度为 $0.25$。惩罚 $\\Phi = 2 \\times (0.8-0.5)^2 + 2 \\times (0.8-0.25)^2 = 0.785$。耦合成本 $C \\approx 0.4862$。总成本 $J \\approx 0.4862 + 100 \\times 0.785 \\approx 78.99$。\n    *   最优解是插入所有 2 个填充，尽管它仍然未能满足密度目标（因此是不可行的）。\n    *   **结果**: $[78.9862053412355, \\mathrm{False}, 2]$\n\n将所有结果汇总，得到最终答案。",
            "answer": "[[2.225540928492468, True, 4], [0.0, True, 0], [78.9862053412355, False, 2]]"
        }
    ]
}