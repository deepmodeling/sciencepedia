## Introduction
Fractional-N Phase-Locked Loops (PLLs) are a cornerstone of modern high-[frequency synthesis](@entry_id:266572), enabling the generation of precise, agile clock signals essential for [wireless communication](@entry_id:274819), data conversion, and processing systems. Their ability to synthesize frequencies with exceptionally fine resolution provides unparalleled design flexibility. However, this advantage introduces a significant design challenge: the inherent generation of unwanted [spectral lines](@entry_id:157575), known as spurious tones or spurs. These deterministic errors can degrade signal quality, increase jitter, and compromise the performance of the entire system. Addressing this knowledge gap—understanding the precise origins of spurs and mastering the techniques to mitigate them—is paramount for any high-performance integrated circuit designer.

This article provides a comprehensive journey into the theory and practice of [spur mitigation](@entry_id:1132234) in fractional-N PLLs. In the **Principles and Mechanisms** chapter, we will dissect the fundamental operation of fractional-N synthesis, develop a linear model for analysis, and explore the root causes of both parasitic [reference spurs](@entry_id:1130774) and intrinsic [fractional spurs](@entry_id:1125281). Building on this theoretical foundation, the **Applications and Interdisciplinary Connections** chapter will bridge theory to practice, demonstrating how these concepts apply to EDA simulation, laboratory characterization, and system-level optimization, while also highlighting connections to fields like Digital Signal Processing and Power Electronics. Finally, the **Hands-On Practices** section will allow you to apply and test your understanding through guided design and analysis problems, solidifying your ability to diagnose and solve real-world spur issues.

## Principles and Mechanisms

### Fractional-N Synthesis and Linear Modeling

The fundamental purpose of a fractional-N Phase-Locked Loop (PLL) is to synthesize an output frequency $f_{\text{out}}$ that is a non-integer multiple of a reference frequency $f_{\text{ref}}$. This capability provides superior flexibility compared to its predecessor, the integer-N PLL, which restricts the output frequency to integer multiples of the reference, $f_{\text{out}} = N \cdot f_{\text{ref}}$. In a fractional-N PLL, the goal is to achieve $f_{\text{out}} = (N + \alpha) \cdot f_{\text{ref}}$, where $N$ is an integer and $\alpha$ is the [fractional part](@entry_id:275031), $0 \lt \alpha \lt 1$.

This fractional division is not achieved by an analog fractional divider, but rather through a digital technique of [time-averaging](@entry_id:267915). A **Multi-Modulus Divider (MMD)** in the feedback path is dynamically switched between two or more [integer division](@entry_id:154296) ratios, typically $N$ and $N+1$. Over a specific period, the divider is set to $N+1$ for a certain number of reference cycles and to $N$ for the remaining cycles, such that the time-averaged division ratio is exactly $N+\alpha$ . This dynamic switching is the defining characteristic of a fractional-N PLL and, as we will see, the primary source of its unique design challenges.

To analyze the behavior of the PLL, we employ a linearized phase-domain model. This model describes the relationship between small phase deviations and the corresponding control signals within the loop. The key components in the [forward path](@entry_id:275478) are the Phase-Frequency Detector (PFD)/Charge Pump (CP) combination, the loop filter, and the Voltage-Controlled Oscillator (VCO). Their small-signal gains determine the loop's dynamics.

The PFD and CP work in concert to convert a phase error $\Delta\phi$ between the reference and divided VCO signals into an average current injected into the loop filter. We can define a composite gain $K_{\phi}$, but it is often more insightful to separate it into two components: the PFD gain, $K_{pd}$, and the CP gain, $K_{cp}$ .

For an ideal tri-state PFD, a [phase error](@entry_id:162993) $\Delta\phi$ (in [radians](@entry_id:171693)) results in an UP or DOWN pulse of duration $\Delta t = \Delta\phi / \omega_{\text{ref}}$. The **PFD gain**, $K_{pd}$, is defined as the proportionality constant mapping this [phase error](@entry_id:162993) to a normalized pulse width, or duty fraction, over one reference period $T_{\text{ref}}$.
$$ K_{pd} = \frac{\Delta t}{T_{\text{ref}} \cdot \Delta\phi} = \frac{\Delta\phi / (2\pi/T_{\text{ref}})}{T_{\text{ref}} \cdot \Delta\phi} = \frac{1}{2\pi} $$
Thus, $K_{pd}$ has units of $1/\text{rad}$. The **CP gain**, $K_{cp}$, is simply the magnitude of the current, $I_{cp}$, that the [charge pump](@entry_id:1122300) sources or sinks, with units of Amperes ($\text{A}$). The average current injected into the loop filter per radian of phase error is the product of these gains:
$$ K_{\phi} = K_{pd} K_{cp} = \frac{I_{cp}}{2\pi} \quad [\text{A/rad}] $$
This gain term, directly proportional to the [charge pump](@entry_id:1122300) current $I_{cp}$, is a critical parameter that scales the entire open-[loop gain](@entry_id:268715) and dictates the loop's response to any phase disturbances, including those that manifest as spurs .

The current from the charge pump is converted to a control voltage, $V_{\text{ctrl}}$, by the loop filter, which has a transfer function $Z(s)$. This voltage then drives the VCO. The **VCO sensitivity**, $K_{VCO}$, defines how the oscillator's frequency responds to changes in its control voltage:
$$ K_{VCO} = \frac{d\omega_{\text{out}}}{dV_{\text{ctrl}}} \quad [\text{rad/s/V}] $$
Since the output phase $\phi_{\text{out}}(t)$ is the time integral of the [angular frequency](@entry_id:274516) $\omega_{\text{out}}(t)$, the VCO acts as a perfect integrator in the phase domain. Its transfer function from control voltage to output phase is therefore $\frac{K_{VCO}}{s}$. This is a fundamental property: the VCO inherently converts [frequency modulation](@entry_id:162932) at its input to [phase modulation](@entry_id:262420) at its output . Occasionally, the VCO gain is specified in Hertz per volt, $K_{VCO,Hz} = \frac{df_{\text{out}}}{dV_{\text{ctrl}}}$. The two are related by $K_{VCO} = 2\pi K_{VCO,Hz}$ .

Combining these blocks, the [open-loop transfer function](@entry_id:276280) of the PLL, which describes the gain around the entire loop, is given by:
$$ L(s) = K_{\phi} Z(s) \frac{K_{VCO}}{s} = \frac{I_{cp}}{2\pi} Z(s) \frac{K_{VCO}}{s} $$
This expression forms the basis for analyzing the stability and noise performance of the PLL, including its susceptibility to spurious tones.

### The Genesis of Spurious Tones

Spurious tones, or **spurs**, are unwanted, discrete [spectral lines](@entry_id:157575) that appear in the output spectrum of a [frequency synthesizer](@entry_id:276573). They represent a form of deterministic noise and are a primary concern in PLL design. We can categorize them based on their origin.

#### Reference Spurs

Reference spurs are [sidebands](@entry_id:261079) that appear at integer multiples of the reference frequency, $f_{\text{out}} \pm k f_{\text{ref}}$. They are not unique to fractional-N designs and can be a dominant issue in integer-N PLLs as well. These spurs arise from any mechanism that allows the periodic activity of the reference clock to leak into the sensitive VCO control node, $V_{\text{ctrl}}$ . Primary leakage paths include:
1.  **Charge Pump Ripple:** Even in a locked state, the PFD and CP generate small, periodic current pulses to correct for tiny phase drifts. This periodic injection of charge into the loop filter, which has a finite impedance at $f_{\text{ref}}$, creates a voltage ripple on $V_{\text{ctrl}}$.
2.  **PFD Feedthrough:** The fast-switching logic of the PFD can couple directly to the control node through the substrate or power supplies.
3.  **Reference Coupling:** The reference [clock signal](@entry_id:174447) itself, being a large and fast digital signal, can couple electromagnetically or through the substrate to the VCO input.

Any such periodic ripple on $V_{\text{ctrl}}$ directly modulates the VCO's frequency. A small sinusoidal ripple $v_{\text{ripple}}(t) = V_{\text{r,pk}} \cos(2\pi f_{\text{ref}} t)$ causes a peak frequency deviation of $\Delta f = K_{VCO} V_{\text{r,pk}}$. This [frequency modulation](@entry_id:162932) results in [phase modulation](@entry_id:262420) with a peak [phase deviation](@entry_id:276073) (or modulation index) $\beta = \Delta f / f_{\text{ref}}$. For small modulation indices, this produces two [sidebands](@entry_id:261079) at $\pm f_{\text{ref}}$ with a power level relative to the carrier given by:
$$ L_{\text{spur}} [\text{dBc}] = 20 \log_{10}\left(\frac{\beta}{2}\right) = 20 \log_{10}\left(\frac{K_{VCO} V_{\text{r,pk}}}{2 f_{\text{ref}}}\right) $$
For example, if a PLL with $f_{\text{ref}} = 25\,\text{MHz}$ and $K_{VCO} = 50\,\text{MHz/V}$ has a measured control [voltage ripple](@entry_id:1133886) of $V_{\text{r,rms}} = 2\,\text{mV}$ (which corresponds to a peak voltage of $V_{\text{r,pk}} = 2\sqrt{2}\,\text{mV}$), the resulting [reference spurs](@entry_id:1130774) would be approximately $-51\,\text{dBc}$ . Mitigation of [reference spurs](@entry_id:1130774) primarily involves careful layout techniques—such as differential routing, supply isolation, and guarding—to minimize coupling, and using a loop filter that provides sufficient attenuation at $f_{\text{ref}}$.

#### Fractional Spurs and Quantization Error

While [reference spurs](@entry_id:1130774) are parasitic, **[fractional spurs](@entry_id:1125281)** are intrinsic to the very mechanism of fractional-N synthesis. They arise from the quantization error inherent in approximating the fractional division ratio $\alpha$. The circuitry responsible for switching the MMD is a digital **Delta-Sigma Modulator (DSM)**. In its simplest form, this is a first-order accumulator.

Consider a simple accumulator that takes the constant fractional value $\alpha$ as input and produces an output sequence $a[n] \in \{0,1\}$ to control the MMD. Its state $s[n]$ updates according to $s[n] = s[n-1] + \alpha - a[n]$, where $a[n] = \lfloor s[n-1] + \alpha \rfloor$ is the integer part (carry-out) and the state $s[n] \in [0,1)$ is the [fractional part](@entry_id:275031) (the value remaining in the accumulator) . The sequence $a[n]$ is the command that selects between division by $N$ or $N+1$.

The **[quantization error](@entry_id:196306)** at each step is defined as $e[n] = a[n] - \alpha$. If the [fractional part](@entry_id:275031) is a rational number, $\alpha = p/q$ (where $p$ and $q$ are coprime integers), the accumulator state $s[n]$ can only take on values that are multiples of $1/q$. Since there are only $q$ such possible states, the sequence of states must eventually repeat. It can be shown that the state sequence $s[n]$, and therefore the output sequence $a[n]$ and the error sequence $e[n]$, are strictly periodic with a [fundamental period](@entry_id:267619) of $q$ reference cycles . For instance, if a DSM is used to generate a fractional value of $\alpha = 137/512$, the output sequence that controls the divider will repeat every $L=512$ reference cycles .

This periodic [quantization error](@entry_id:196306) $e[n]$ effectively phase modulates the feedback signal. A discrete-time error sequence that is periodic with period $q$ and clocked at $f_{\text{ref}}$ has a [discrete spectrum](@entry_id:150970) composed of tones at frequencies $k \cdot (f_{\text{ref}}/q)$. This modulation translates directly into spurs in the PLL output spectrum at offset frequencies:
$$ f_{\text{spur_offset}} = \pm k \frac{f_{\text{ref}}}{q}, \quad k \in \mathbb{Z}^+ $$
Since $q$ can be very large, these [fractional spurs](@entry_id:1125281) can appear at very low offset frequencies, often well within the PLL's loop bandwidth, where the loop filter cannot attenuate them. In fact, for in-band spurs, the feedback loop may even amplify them. These deterministic, low-frequency spurs were the primary limitation of early fractional-N architectures .

#### System-Level Impact: From Spurs to Jitter

Spurs are not just an aesthetic imperfection in the spectrum; they correspond to a real, deterministic error in the timing of the output clock's edges. This timing error is known as **[deterministic jitter](@entry_id:1123600)**. A spur at an offset $f_s$ with a power level $L_{\text{spur}}$ corresponds to a sinusoidal [phase modulation](@entry_id:262420) of the carrier. This [phase error](@entry_id:162993) $\phi(t)$ directly translates into a timing error $\Delta t(t)$ via the relationship $\Delta t(t) = -\phi(t)/(2\pi f_o)$ .

The peak-to-peak [deterministic timing](@entry_id:174241) error induced by a single spur is bounded and can be calculated. For a single spur at a level of $-50\,\text{dBc}$ at an offset of $f_s = 20\,\text{MHz}$ from a $2.4\,\text{GHz}$ carrier, the corresponding peak [phase deviation](@entry_id:276073) is $\Delta\phi_{\text{peak}} \approx 6.325 \times 10^{-3}\,\text{rad}$. This results in a peak-to-peak timing error of approximately $0.84\,\text{ps}$ .

It is critical to distinguish this bounded, [deterministic jitter](@entry_id:1123600) from unbounded, random jitter, which is typically modeled with a Gaussian distribution. Even if a random jitter process has the same RMS value as the spur-induced timing error (in the example above, $\sigma_{t,spur} \approx 0.30\,\text{ps}$), its impact is vastly different. A Gaussian process is unbounded, meaning there is a non-zero, albeit small, probability of arbitrarily large timing errors. For a random process with an RMS value of $0.30\,\text{ps}$, there is a significant probability (around $16\%$) that its instantaneous error will exceed the peak error of the deterministic spur ($0.42\,\text{ps}$) . For high-reliability communication systems, the "effective peak" of [random jitter](@entry_id:1130551) is often considered to be $6-7$ times its RMS value, which would be far worse than the [deterministic jitter](@entry_id:1123600) from the spur. This fundamental difference in their statistical nature is why [spur mitigation](@entry_id:1132234) is a distinct and crucial design goal, separate from managing the random noise floor.

### Spur Generation from Circuit Non-Idealities

The ideal model of quantization error explains the fundamental origin of [fractional spurs](@entry_id:1125281). However, in practical circuits, various non-idealities can create new spurs or worsen existing ones. These mechanisms often involve the interaction between different periodic events within the PLL.

#### Charge Pump Asymmetries

An illustrative example of non-ideality-driven spurs arises from asymmetries in the [charge pump](@entry_id:1122300). Consider a fractional-N PLL configured to produce an average division of $N+0.5$. A simple first-order DSM would generate a perfectly alternating sequence of division by $N$ and $N+1$. This causes the PFD to generate a sequence of alternating UP and DOWN pulses of equal duration, $\delta$.

In an ideal CP, the charge injected during an UP pulse ($Q_{\text{U}}$) would be perfectly cancelled by the charge extracted during a DOWN pulse ($Q_{\text{D}}$), resulting in zero net charge over two cycles. However, real charge pumps suffer from current mismatch ($I_{\text{U}} \neq I_{\text{D}}$) and asymmetric rise/fall times ($t_{r, \text{U}}, t_{f, \text{U}}, t_{r, \text{D}}, t_{f, \text{D}}$). The charge delivered by a trapezoidal UP pulse is $Q_{\text{U}} = I_{\text{U}}\delta - \frac{1}{2}I_{\text{U}}(t_{r,\text{U}}+t_{f,\text{U}})$, and the charge for a DOWN pulse is $Q_{\text{D}} = -I_{\text{D}}\delta + \frac{1}{2}I_{\text{D}}(t_{r,\text{D}}+t_{f,\text{D}})$.

The total charge delivered over the repeating two-cycle period is $Q_{\text{U}}+Q_{\text{D}}$, which is generally non-zero and contributes to a DC offset. The *alternating* component of [charge injection](@entry_id:1122296), related to the sequence $Q_{\text{U}}, Q_{\text{D}}, Q_{\text{U}}, \dots$, has a period of $2T_{\text{ref}}$ and a fundamental frequency of $f_{\text{ref}}/2$. Fourier analysis reveals that this alternating sequence creates a current component at $f_{\text{ref}}/2$ with an amplitude proportional to $|Q_{\text{U}} - Q_{\text{D}}|$. This current component generates a voltage ripple on the loop [filter capacitor](@entry_id:271169), resulting in a prominent spur at an offset of $f_{\text{ref}}/2$ . This shows how a deterministic pattern from the DSM can interact with circuit mismatches to create a strong spur that would not exist in an ideal system.

#### Interaction of Periodic Errors

More complex spur patterns arise when multiple, independent periodic error sources interact. This is a form of intermodulation. Consider a PLL where the charge pump is built from $P=8$ unit current cells that are selected in a rotating sequence to average out mismatches. This rotation itself creates a small, periodic current error $e_c[n]$ with a period of $P=8$ reference cycles. Simultaneously, the DSM, targeting a fraction like $\alpha=13/64$, generates its own periodic sequence $a[n]$ with a period of $L=64$ cycles .

The charge pump current error $e_c[n]$ is gated by the PFD pulses, whose polarity and duration are determined by the DSM sequence $a[n]$. This results in an effective error signal at the [loop filter](@entry_id:275178) input that is a product of two [periodic signals](@entry_id:266688) with different fundamental frequencies ($f_1 = f_{\text{ref}}/L$ and $f_2 = f_{\text{ref}}/P$). In the frequency domain, this [time-domain multiplication](@entry_id:275182) becomes a convolution. The convolution of two [line spectra](@entry_id:144909) produces a new line spectrum with tones at all possible sum and difference frequencies.

Therefore, in addition to the spurs at multiples of $f_{\text{ref}}/64$ (from the DSM) and $f_{\text{ref}}/8$ (from the CP rotation), new intermodulation spurs will appear at offset frequencies $|k_1 \frac{f_{\text{ref}}}{L} \pm k_2 \frac{f_{\text{ref}}}{P}|$. For $f_{\text{ref}}=50\,\text{MHz}$, this would create strong spurs near $|6.25\,\text{MHz} \pm 0.78125\,\text{MHz}|$, i.e., at $5.46875\,\text{MHz}$ and $7.03125\,\text{MHz}$ . Understanding these interaction mechanisms is crucial for diagnosing complex spur behaviors in high-performance synthesizers.

### Key Mechanisms for Spur Mitigation

Given the detrimental effects of spurs, several advanced techniques have been developed to mitigate them. These methods either address the root cause of the spurs—[quantization error](@entry_id:196306) and element mismatch—or mask their effects.

#### Noise Shaping with Delta-Sigma Modulators

The most fundamental technique for mitigating [fractional spurs](@entry_id:1125281) is the use of a **Delta-Sigma Modulator (DSM)** itself. While a simple first-order accumulator generates a periodic [quantization error](@entry_id:196306), higher-order DSMs are designed to perform **noise shaping**. The transfer function from the DSM's [quantization error](@entry_id:196306) source to its output is designed to be a high-pass filter. This means that instead of the [quantization error](@entry_id:196306) energy being concentrated in discrete, low-frequency spurs, it is reshaped into a pseudo-random, noise-like signal whose power is pushed towards higher frequencies .

The PLL's closed-loop response to [phase noise](@entry_id:264787) injected at the PFD is inherently low-pass, with a [cutoff frequency](@entry_id:276383) set by the loop bandwidth, $f_{\text{BW}}$. By designing the DSM to push the quantization noise energy to frequencies well above $f_{\text{BW}}$, the PLL's natural low-pass filtering action can effectively suppress this noise. The result is a clean in-band spectrum where the deterministic [fractional spurs](@entry_id:1125281) are replaced by a low-level, high-frequency noise floor that is largely outside the band of interest.

#### Decorrelation through Dithering

While higher-order DSMs are effective at [noise shaping](@entry_id:268241), they are still deterministic finite-[state machines](@entry_id:171352). When driven with a constant, rational input, they can fall into **[limit cycles](@entry_id:274544)**—long but still periodic output sequences. These limit cycles manifest as low-level but discrete tones, often called idle tones. To break these remaining deterministic patterns, a technique called **[dithering](@entry_id:200248)** is employed.

Additive dither involves adding a small, zero-mean random or pseudo-random signal to the input of the DSM's quantizer . By adding this random component, the quantizer's decision at each step is no longer solely dependent on the signal history. If the [dither signal](@entry_id:177752) is chosen correctly (e.g., satisfying the Schuchman conditions), it can make the quantization error statistically independent of the input signal. This randomization breaks the [limit cycles](@entry_id:274544) and converts the residual discrete tone energy into a continuous, broadband [noise spectrum](@entry_id:147040).

The trade-off is that this process inevitably raises the total noise floor. For a quantizer with step size $\Delta$, the dithered [quantization error](@entry_id:196306) can be modeled as a white noise source with power $\Delta^2/12$ . Dithering thus represents a classic engineering compromise: deterministic, correlated spurs are eliminated at the cost of an increased broadband random noise floor.

#### Dynamic Element Matching (DEM)

Dithering and [noise shaping](@entry_id:268241) address spurs arising from quantization error. However, they do not address spurs caused by static physical mismatches in circuit elements, such as the current source mismatches in a charge pump or delay mismatches in an MMD. **Dynamic Element Matching (DEM)** is a powerful technique designed specifically for this problem .

Instead of using the same physical element (e.g., the same unit current source) every time a certain command is received, DEM employs a sequencing logic to systematically or pseudo-randomly permute the selection of the unit elements. For example, if a [charge pump](@entry_id:1122300) requires 5 units of current out of 8 available matched cells, a simple DEM rotator would ensure that over time, each of the 8 cells is used with equal probability.

This process does not eliminate the mismatch itself, but it modulates it. A static mismatch error associated with a particular element is converted into a time-varying error sequence. Much like a DSM, the DEM sequencing algorithm can be designed to have a high-pass spectral characteristic. By rapidly swapping the elements, the low-frequency error contribution is averaged out, and the mismatch error energy is pushed to higher frequencies. This high-frequency error can then be effectively filtered by the PLL's low-pass response. In essence, DEM performs [noise shaping](@entry_id:268241) on the circuit element mismatch error, analogous to how a DSM performs noise shaping on the [quantization error](@entry_id:196306) .