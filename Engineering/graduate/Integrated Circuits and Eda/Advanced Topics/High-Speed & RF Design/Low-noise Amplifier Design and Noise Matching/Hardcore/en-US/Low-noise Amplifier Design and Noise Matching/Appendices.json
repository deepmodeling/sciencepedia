{
    "hands_on_practices": [
        {
            "introduction": "Before we can design a low-noise amplifier, we must first master the origin of electronic noise itself: the random thermal motion of charge carriers in resistive materials. This exercise  provides a foundational look at Johnson-Nyquist thermal noise. By deriving and comparing the total noise from resistors in series versus parallel, you will solidify your understanding of how uncorrelated noise sources combine and how the equivalent resistance of a network dictates its noise contribution.",
            "id": "4280455",
            "problem": "A Low-Noise Amplifier (LNA, Low-Noise Amplifier) front end at radio frequency employs a passive resistive network at its input. To assess the input-referred thermal noise, consider two design options for a two-terminal network seen by the LNA input: Option A places two resistors $R_1$ and $R_2$ in series, and Option B places the same two resistors $R_1$ and $R_2$ in parallel. Assume all elements are linear, time-invariant, and in thermal equilibrium at absolute temperature $T$, with thermal noise arising from microscopic fluctuations consistent with the fluctuation–dissipation theorem.\n\nStarting from the fundamental description of thermal noise for resistors and the superposition of uncorrelated noise sources, derive how the open-circuit voltage noise spectral density across the two-terminal port depends on the equivalent resistance for each configuration. Then, for the specific values $R_1 = 80\\,\\Omega$, $R_2 = 20\\,\\Omega$, and $T = 290\\,\\mathrm{K}$, compute the ratio of the series-case open-circuit voltage noise spectral density to the parallel-case open-circuit voltage noise spectral density. Express your final answer as a dimensionless number. Round your answer to four significant figures.",
            "solution": "The problem statement is first subjected to validation.\n\n### Step 1: Extract Givens\n- A Low-Noise Amplifier (LNA) front end with a passive resistive network at its input.\n- Two design options for the two-terminal network:\n  - Option A: Two resistors, $R_1$ and $R_2$, in series.\n  - Option B: The same two resistors, $R_1$ and $R_2$, in parallel.\n- All elements are linear, time-invariant, and in thermal equilibrium at absolute temperature $T$.\n- Thermal noise is consistent with the fluctuation–dissipation theorem.\n- Task 1: Derive the open-circuit voltage noise spectral density for each configuration.\n- Task 2: Compute the ratio of the series-case open-circuit voltage noise spectral density to the parallel-case open-circuit voltage noise spectral density.\n- Specific values: $R_1 = 80\\,\\Omega$, $R_2 = 20\\,\\Omega$, $T = 290\\,\\mathrm{K}$.\n- Final answer requirements: Dimensionless number, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem concerns Johnson-Nyquist thermal noise in resistors, a fundamental and well-established concept in physics and electrical engineering. The fluctuation-dissipation theorem is the correct theoretical underpinning. The models and analysis methods are standard. The problem is scientifically sound.\n- **Well-Posed**: The problem is clearly defined. It asks for a derivation and a specific numerical ratio based on the provided data. The configurations (series and parallel) are unambiguous. A unique and meaningful solution exists.\n- **Objective**: The language is technical, precise, and free of any subjectivity or opinion.\n- **Flaw Analysis**:\n  1. **Scientific/Factual Unsoundness**: None. The physics is correct.\n  2. **Non-Formalizable/Irrelevant**: None. The problem is a standard circuit analysis task directly relevant to LNA design.\n  3. **Incomplete/Contradictory Setup**: None. All necessary values ($R_1$, $R_2$) for the ratio are provided. The temperature $T$ is given, although as will be shown, it is not needed for the final ratio. No contradictions are present.\n  4. **Unrealistic/Infeasible**: None. The resistor values are common, and the temperature is a standard reference for noise calculations.\n  5. **Ill-Posed/Poorly Structured**: None. The problem is structured logically.\n  6. **Pseudo-Profound/Trivial**: None. The problem requires a correct application of noise theory and circuit analysis.\n  7. **Outside Scientific Verifiability**: None. The result is calculable and, in principle, experimentally verifiable.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\n***\n\nThe fundamental principle governing this problem is the Johnson-Nyquist noise in a resistor. A physical resistor with resistance $R$ at an absolute temperature $T$ can be modeled as an ideal, noiseless resistor in series with a noise voltage source, $v_n$. The one-sided power spectral density of this voltage source, for frequencies much less than $k_B T/h$ (where $k_B$ is the Boltzmann constant and $h$ is Planck's constant), is given by:\n$$\nS_v(f) = 4k_B T R\n$$\nThis spectral density is independent of frequency, representing white noise. When multiple noise sources are uncorrelated, as is the case for thermal noise from distinct resistors, their power spectral densities add.\n\n**Option A: Series Configuration**\n\nIn the series configuration, the two resistors $R_1$ and $R_2$ are connected in series. Each resistor is modeled with its associated series noise voltage source, $v_{n1}$ and $v_{n2}$ respectively. The total open-circuit voltage $v_{n,s}$ across the two-terminal network is the sum of the individual noise voltages:\n$$\nv_{n,s}(t) = v_{n1}(t) + v_{n2}(t)\n$$\nSince the noise sources are uncorrelated, the total voltage noise spectral density, $S_{v,s}$, is the sum of the individual spectral densities:\n$$\nS_{v,s} = S_{v1} + S_{v2} = 4k_B T R_1 + 4k_B T R_2\n$$\nFactoring out the common terms, we get:\n$$\nS_{v,s} = 4k_B T (R_1 + R_2)\n$$\nThe equivalent resistance of the series network is $R_s = R_1 + R_2$. Therefore, the noise spectral density is $S_{v,s} = 4k_B T R_s$, which is consistent with the noise of the equivalent resistor.\n\n**Option B: Parallel Configuration**\n\nIn the parallel configuration, the analysis is more conveniently performed using the Norton equivalent noise model. A resistor $R$ at temperature $T$ can be modeled as an ideal noiseless resistor in parallel with a noise current source, $i_n$. The spectral density of this current source, $S_i$, is related to the voltage spectral density by $S_i = S_v / R^2$.\n$$\nS_i(f) = \\frac{4k_B T R}{R^2} = 4k_B T \\frac{1}{R} = 4k_B T G\n$$\nwhere $G = 1/R$ is the conductance.\n\nFor the parallel combination of $R_1$ and $R_2$, the total noise current $i_{n,p}$ is the sum of the individual uncorrelated noise currents, $i_{n1}$ and $i_{n2}$. The total current noise spectral density, $S_{i,p}$, is the sum of the individual densities:\n$$\nS_{i,p} = S_{i1} + S_{i2} = 4k_B T G_1 + 4k_B T G_2 = 4k_B T \\left(\\frac{1}{R_1} + \\frac{1}{R_2}\\right)\n$$\nThis total noise current source is in parallel with the equivalent resistance of the parallel network, $R_p$.\n$$\nR_p = \\left(\\frac{1}{R_1} + \\frac{1}{R_2}\\right)^{-1} = \\frac{R_1 R_2}{R_1 + R_2}\n$$\nTo find the open-circuit voltage noise spectral density, $S_{v,p}$, we use the relationship between the Norton and Thévenin equivalents. The open-circuit voltage is $v_{n,p} = i_{n,p} R_p$. The corresponding relationship for the spectral densities is $S_{v,p} = S_{i,p} R_p^2$.\n$$\nS_{v,p} = \\left[ 4k_B T \\left(\\frac{1}{R_1} + \\frac{1}{R_2}\\right) \\right] \\left( \\frac{R_1 R_2}{R_1 + R_2} \\right)^2\n$$\nSubstituting $\\frac{1}{R_1} + \\frac{1}{R_2} = \\frac{R_1 + R_2}{R_1 R_2}$:\n$$\nS_{v,p} = 4k_B T \\left( \\frac{R_1 + R_2}{R_1 R_2} \\right) \\frac{(R_1 R_2)^2}{(R_1 + R_2)^2} = 4k_B T \\frac{R_1 R_2}{R_1 + R_2}\n$$\nThis is $S_{v,p} = 4k_B T R_p$, which is again consistent with the noise of the equivalent resistor.\n\n**Calculation of the Ratio**\n\nThe problem asks for the ratio of the series-case open-circuit voltage noise spectral density to the parallel-case open-circuit voltage noise spectral density. Let this ratio be $\\mathcal{R}$.\n$$\n\\mathcal{R} = \\frac{S_{v,s}}{S_{v,p}} = \\frac{4k_B T (R_1 + R_2)}{4k_B T \\frac{R_1 R_2}{R_1 + R_2}}\n$$\nThe term $4k_B T$ cancels, indicating the ratio is independent of temperature.\n$$\n\\mathcal{R} = \\frac{R_1 + R_2}{\\frac{R_1 R_2}{R_1 + R_2}} = \\frac{(R_1 + R_2)^2}{R_1 R_2}\n$$\nNow, we substitute the given numerical values: $R_1 = 80\\,\\Omega$ and $R_2 = 20\\,\\Omega$.\n$$\nR_1 + R_2 = 80 + 20 = 100\\,\\Omega\n$$\n$$\nR_1 R_2 = 80 \\times 20 = 1600\\,\\Omega^2\n$$\nSubstituting these into the expression for the ratio $\\mathcal{R}$:\n$$\n\\mathcal{R} = \\frac{(100)^2}{1600} = \\frac{10000}{1600} = \\frac{100}{16} = \\frac{25}{4} = 6.25\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\mathcal{R} = 6.250\n$$",
            "answer": "$$\n\\boxed{6.250}\n$$"
        },
        {
            "introduction": "With a firm grasp of thermal noise fundamentals, we can now apply these principles to a practical design scenario. This practice  challenges you to design a common-gate Low-Noise Amplifier (LNA) stage, a common building block in RF receivers. You will determine the necessary transistor dimensions to achieve a specific input impedance match and then evaluate the resulting noise figure, directly linking physical device parameters to critical high-frequency performance metrics.",
            "id": "4280450",
            "problem": "A Low-Noise Amplifier (LNA) is to be implemented as a common-gate Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET) stage for narrowband operation around a specified radio frequency, with the input signal source impedance modeled as a real resistance. The goal is to select the transistor width to meet a target input match and then evaluate the resulting transconductance and noise figure under stated assumptions grounded in first principles. The design context is within Integrated Circuits and Electronic Design Automation (EDA) for advanced radio-frequency receivers.\n\nConsider an $n$-channel MOSFET operated in strong inversion and velocity-unlimited saturation, with square-law behavior and negligible channel-length modulation, described by the drain current model $I_{D} = \\frac{1}{2} \\mu_{n} C_{ox} \\frac{W}{L} V_{ov}^{2}$, where $I_{D}$ is the drain bias current, $\\mu_{n}$ is the electron mobility, $C_{ox}$ is the oxide capacitance per unit area, $W$ is the transistor width, $L$ is the channel length, and $V_{ov}$ is the overdrive voltage. The small-signal transconductance is defined as $g_{m} = \\partial I_{D} / \\partial V_{ov}$. The amplifier is configured in common-gate with the gate at radio-frequency (RF) ground via a large bypass capacitance, and the drain isolated by an ideal RF load such that the drain node is an RF ground for small-signal analysis at the design frequency. The source is driven from an external source resistance $R_{s} = 50\\,\\Omega$ at temperature $T$, and the target input impedance match is $Z_{in} \\approx 50\\,\\Omega$. Assume frequency $f = 3\\,\\mathrm{GHz}$, and that the intrinsic device capacitances are sufficiently small at this frequency that $\\omega C_{gd} \\ll g_{m}$ and $\\omega C_{gs} \\ll g_{m}$, with $\\omega = 2\\pi f$, so that the reactive contributions to the input admittance are negligible compared to the transconductance over the narrowband of interest.\n\nThermal channel noise is modeled by a drain current source with two-sided power spectral density $\\overline{i_{n}^{2}} = 4 k_{B} T \\gamma g_{m}$, where $k_{B}$ is the Boltzmann constant and $\\gamma$ is the excess noise factor for channel thermal noise under strong inversion. Ignore gate-induced noise, gate resistance noise, flicker noise, substrate noise, and correlation effects; treat the input source as an ideal $50\\,\\Omega$ thermal noise source. Use $T = 300\\,\\mathrm{K}$ and $\\gamma = 2/3$. The process parameters are $\\mu_{n} = 0.05\\,\\mathrm{m^{2}/(V\\,s)}$, $C_{ox} = 2.0 \\times 10^{-3}\\,\\mathrm{F/m^{2}}$, and the channel length is $L = 120\\,\\mathrm{nm}$. The bias current is $I_{D} = 5\\,\\mathrm{mA}$.\n\nStarting from the square-law model and small-signal definitions, and using the above physical assumptions to justify the approximation for the input impedance of a common-gate stage, perform the following:\n1. Determine the transistor width $W$ that achieves the input match $Z_{in} \\approx 50\\,\\Omega$ at $f = 3\\,\\mathrm{GHz}$.\n2. Evaluate the resulting transconductance $g_{m}$ at the given bias current.\n3. Compute the noise figure $F$ (dimensionless ratio) of the stage under the stated thermal noise model and matching condition.\n\nExpress the final reported quantity as the noise figure $F$ (dimensionless ratio). Round your final reported value to four significant figures. No units are required for the final reported number.",
            "solution": "The problem requires determining the device width that achieves an input match and then computing the transconductance and noise figure from first principles. The base facts are the square-law strong-inversion model, the small-signal transconductance definition, and the thermal noise spectral density model for MOSFET channel noise.\n\nWe first justify the input impedance approximation for the common-gate Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET). With the gate at radio-frequency (RF) ground, the small-signal drain current is $i_{d} = g_{m} v_{gs}$ where $v_{gs}$ is the gate-to-source voltage. For a small input voltage applied at the source, $v_{in} = v_{s}$, and with the gate grounded, $v_{gs} = -v_{s}$. If the drain is also RF-grounded by an ideal load network (cascode or tuned load), the small-signal input current at the source is approximately equal to the drain current, so $i_{in} \\approx i_{d} = g_{m} v_{s} = g_{m} v_{in}$. Therefore, the input admittance is $Y_{in} \\approx g_{m}$ and the input impedance is\n$$\nZ_{in} \\approx \\frac{1}{g_{m}}.\n$$\nThis relies on the assumptions in the problem that reactive effects are negligible compared with the transconductance at $f = 3\\,\\mathrm{GHz}$, i.e., $\\omega C_{gd} \\ll g_{m}$ and $\\omega C_{gs} \\ll g_{m}$, so that the input conductance dominates, and that the drain is effectively at RF ground over the narrowband of interest.\n\nTo meet the target input match $Z_{in} \\approx 50\\,\\Omega$ with the source resistance $R_{s} = 50\\,\\Omega$, we set\n$$\n\\frac{1}{g_{m}} \\approx R_{s} \\quad \\Rightarrow \\quad g_{m} \\approx \\frac{1}{R_{s}}.\n$$\nHence, the required transconductance is\n$$\ng_{m,\\mathrm{req}} = \\frac{1}{50\\,\\Omega} = 0.02\\,\\mathrm{S}.\n$$\n\nNext, we relate $g_{m}$ to the device dimensions and bias current from the square-law model. The drain current in strong inversion saturation is\n$$\nI_{D} = \\frac{1}{2} \\mu_{n} C_{ox} \\frac{W}{L} V_{ov}^{2},\n$$\nand the small-signal transconductance is\n$$\ng_{m} = \\frac{\\partial I_{D}}{\\partial V_{ov}} = \\mu_{n} C_{ox} \\frac{W}{L} V_{ov}.\n$$\nEliminating $V_{ov}$ between these two relations yields a standard square-law relation for $g_{m}$ at a given $I_{D}$:\n$$\ng_{m} = \\sqrt{2 \\mu_{n} C_{ox} \\frac{W}{L} I_{D}}.\n$$\nSolving for the width $W$ to achieve a specified $g_{m}$ at a given $I_{D}$ gives\n$$\nW = \\frac{L g_{m}^{2}}{2 \\mu_{n} C_{ox} I_{D}}.\n$$\n\nUsing the given parameters $L = 120\\,\\mathrm{nm} = 1.2 \\times 10^{-7}\\,\\mathrm{m}$, $\\mu_{n} = 0.05\\,\\mathrm{m^{2}/(V\\,s)}$, $C_{ox} = 2.0 \\times 10^{-3}\\,\\mathrm{F/m^{2}}$, $I_{D} = 5\\,\\mathrm{mA} = 5.0 \\times 10^{-3}\\,\\mathrm{A}$, and the required transconductance $g_{m,\\mathrm{req}} = 0.02\\,\\mathrm{S}$, we compute:\n$$\n\\mu_{n} C_{ox} = 0.05 \\times 2.0 \\times 10^{-3} = 1.0 \\times 10^{-4}\\,\\mathrm{A/V^{2}},\n$$\nand\n$$\n2 \\mu_{n} C_{ox} I_{D} = 2 \\times 1.0 \\times 10^{-4} \\times 5.0 \\times 10^{-3} = 1.0 \\times 10^{-6}.\n$$\nThus,\n$$\nW = \\frac{1.2 \\times 10^{-7} \\times (0.02)^{2}}{1.0 \\times 10^{-6}} = \\frac{1.2 \\times 10^{-7} \\times 4.0 \\times 10^{-4}}{1.0 \\times 10^{-6}} = 4.8 \\times 10^{-5}\\,\\mathrm{m}.\n$$\nTherefore, the width is $W = 48\\,\\mathrm{\\mu m}$, which is physically plausible for RF common-gate matching at the specified bias.\n\nBy construction, with this width and bias current, the transconductance is $g_{m} = 0.02\\,\\mathrm{S}$, satisfying the matching condition $Z_{in} \\approx 1/g_{m} \\approx 50\\,\\Omega$ under the stated assumptions.\n\nFinally, we compute the noise figure. The input source resistance $R_{s}$ has thermal voltage noise spectral density $\\overline{v_{s}^{2}} = 4 k_{B} T R_{s}$. The transistor’s thermal channel noise is modeled as a drain current source with spectral density $\\overline{i_{n}^{2}} = 4 k_{B} T \\gamma g_{m}$. In the common-gate configuration where the input impedance is approximately real and equal to $R_{s}$, the dominant effect of the transistor’s noise at the input can be treated as a parallel input current source $\\overline{i_{n}^{2}}$ flowing into the input resistance $R_{s}$, producing an additional input-referred voltage noise $\\overline{v_{n,\\mathrm{add}}^{2}} = \\overline{i_{n}^{2}} R_{s}^{2}$. The total input-referred voltage noise becomes\n$$\n\\overline{v_{\\mathrm{in,total}}^{2}} = 4 k_{B} T R_{s} + \\overline{i_{n}^{2}} R_{s}^{2} = 4 k_{B} T R_{s} + \\left(4 k_{B} T \\gamma g_{m}\\right) R_{s}^{2}.\n$$\nThe noise figure $F$ is the ratio of input signal-to-noise ratio to output signal-to-noise ratio for a linear time-invariant, matched system, which for input-referred quantities can be expressed as\n$$\nF = \\frac{\\overline{v_{\\mathrm{in,total}}^{2}}}{4 k_{B} T R_{s}} = 1 + \\frac{\\left(4 k_{B} T \\gamma g_{m}\\right) R_{s}^{2}}{4 k_{B} T R_{s}} = 1 + \\gamma g_{m} R_{s}.\n$$\nUnder the exact match $g_{m} R_{s} = 1$, this reduces to\n$$\nF = 1 + \\gamma.\n$$\nWith $\\gamma = 2/3$, the noise figure is\n$$\nF = 1 + \\frac{2}{3} = \\frac{5}{3} \\approx 1.666666\\ldots.\n$$\nRounding to four significant figures as required yields\n$$\nF \\approx 1.667.\n$$\nThis final result is dimensionless, as required. Note that the frequency $f = 3\\,\\mathrm{GHz}$ and the capacitance conditions ensured the validity of $Z_{in} \\approx 1/g_{m}$ and did not explicitly enter the final numeric value of $F$ under the adopted noise model and matching condition.",
            "answer": "$$\\boxed{1.667}$$"
        },
        {
            "introduction": "The performance of an LNA is not described by a single noise figure value, but rather by how its noise figure changes with the source impedance presented to it. This complete behavior is captured by a set of four noise parameters. This computational exercise  guides you through the process of extracting these fundamental parameters—$F_{\\min}$, $R_n$, and $\\Gamma_{\\text{opt}}$—from simulated noise figure data, a task central to modern EDA workflows. Mastering this allows you to create a predictive model of the LNA's noise performance for any source condition.",
            "id": "4280447",
            "problem": "You are given a linear two-port representation of a Low-Noise Amplifier (LNA) in the context of Electronic Design Automation (EDA). The LNA is driven by a source with reflection coefficient $\\Gamma_s$, and a simulator computes the small-signal noise figure $F$ for various source impedances at a specified source noise temperature $T_s$. The linear two-port is characterized with respect to a real reference impedance $Z_0$. Your task is to implement an algorithm that estimates the canonical two-port noise parameters that uniquely characterize the LNA from these measurements: the minimum noise figure $F_{\\min}$, the equivalent noise resistance $R_n$, and the optimum source reflection coefficient $\\Gamma_{\\text{opt}}$. You must express $R_n$ in $\\Omega$ (ohms), $T_s$ in $\\mathrm{K}$ (Kelvin), and angles in radians. The quantities $F_{\\min}$ must be returned as a dimensionless ratio, not in decibels. The parameter $\\Gamma_{\\text{opt}}$ is complex and must be reported via its real and imaginary parts.\n\nStart from the following fundamental base:\n- The noise figure $F$ is defined as $F \\equiv \\mathrm{SNR}_{\\text{in}} / \\mathrm{SNR}_{\\text{out}}$, where $\\mathrm{SNR}$ denotes the signal-to-noise ratio.\n- The effective input-referred noise temperature $T_e$ of a linear two-port is defined by $F = 1 + T_e/T_s$ for a source at physical temperature $T_s$.\n- A canonical representation exists for how $F$ varies with $\\Gamma_s$ in terms of three scalar parameters $(F_{\\min}, R_n, \\Gamma_{\\text{opt}})$ and the reference impedance $Z_0$. Derive this relationship rigorously from the above base and use it to construct an estimator.\n\nYour program must:\n1. Accept the provided test suite of measurements (embedded in code, no external input).\n2. For each test case, convert the measured $F$ at $T_s$ to an equivalent $F$ referenced to the standard temperature $T_0 = 290\\,\\mathrm{K}$ using the effective noise temperature $T_e$. Use $T_e = (F - 1)\\,T_s$ and return $F_{T_0} = 1 + T_e/T_0$.\n3. Estimate ($F_{\\min}, R_n, \\Gamma_{\\text{opt}}$) by solving a nonlinear least-squares problem that fits the canonical relationship between $F$ and $\\Gamma_s$ to the converted $F_{T_0}$ data, subject to the physical constraints $F_{\\min} \\ge 1$, $R_n \\ge 0$, and $\\lvert \\Gamma_{\\text{opt}} \\rvert < 1$.\n4. Output, for each test case, a list $[F_{\\min}, R_n, \\Re\\{\\Gamma_{\\text{opt}}\\}, \\Im\\{\\Gamma_{\\text{opt}}\\}]$ with each float rounded to six decimal places.\n\nPhysical units and angle specification:\n- Report $R_n$ in $\\Omega$ (ohms).\n- Report $T_s$ in $\\mathrm{K}$ (Kelvin).\n- Angles for $\\Gamma_s$ are provided in radians and must be interpreted in radians.\n\nThe test suite consists of three cases. Each case defines ($Z_0$, $T_s$), a set of source reflection coefficients as polar pairs ($\\lvert \\Gamma_s \\rvert, \\angle \\Gamma_s$), and corresponding measured noise figures $F$:\n\n- Case 1 (happy path, diverse $\\Gamma_s$):\n  - $Z_0 = 50\\,\\Omega$, $T_s = 290\\,\\mathrm{K}$.\n  - $\\Gamma_s$ (magnitude, angle in radians):\n    - $(0.2, 0.0)$,\n    - $(0.4, -\\pi/3)$,\n    - $(0.6, \\pi/2)$,\n    - $(0.8, -2\\pi/3)$,\n    - $(0.5, \\pi/6)$,\n    - $(0.7, \\pi)$,\n    - $(0.3, -\\pi/6)$,\n    - $(0.9, 2\\pi/3)$.\n  - Measured $F$: $[1.21639, 1.21202, 1.639, 1.942, 1.3307, 1.93, 1.201242, 4.261]$.\n\n- Case 2 (lower $F_{\\min}$, moderate $R_n$, includes near-boundary $\\lvert \\Gamma_s \\rvert$):\n  - $Z_0 = 50\\,\\Omega$, $T_s = 290\\,\\mathrm{K}$.\n  - $\\Gamma_s$ (magnitude, angle in radians):\n    - $(0.1, 0.0)$,\n    - $(0.3, \\pi/3)$,\n    - $(0.5, -\\pi/2)$,\n    - $(0.7, 5\\pi/6)$,\n    - $(0.9, -5\\pi/6)$,\n    - $(0.95, \\pi)$.\n  - Measured $F$: $[1.05391, 1.051414, 1.12965, 1.18306, 1.83864, 2.547]$.\n\n- Case 3 (edge case with nonstandard source temperature requiring conversion):\n  - $Z_0 = 50\\,\\Omega$, $T_s = 350\\,\\mathrm{K}$.\n  - $\\Gamma_s$ (magnitude, angle in radians):\n    - $(0.2, -\\pi/2)$,\n    - $(0.4, -2\\pi/3)$,\n    - $(0.6, 0.0)$,\n    - $(0.8, \\pi/4)$,\n    - $(0.95, -\\pi/4)$.\n  - Measured $F$: $[1.473143, 1.46205, 2.023, 3.989, 4.551]$.\n\nYour program should produce a single line of output containing the results for the three test cases as a comma-separated list of lists, each inner list being $[F_{\\min}, R_n, \\Re\\{\\Gamma_{\\text{opt}}\\}, \\Im\\{\\Gamma_{\\text{opt}}\\}]$. For example:\n\"[[f1,r1,re1,im1],[f2,r2,re2,im2],[f3,r3,re3,im3]]\"\nAll values must be floats rounded to six decimal places.",
            "solution": "The problem requires the estimation of the canonical noise parameters of a linear two-port amplifier, specifically the minimum noise figure $F_{\\min}$, the equivalent noise resistance $R_n$, and the optimum source reflection coefficient $\\Gamma_{\\text{opt}}$. These parameters are to be determined from a set of measurements of the noise figure $F$ at various source reflection coefficients $\\Gamma_s$.\n\nThe solution proceeds in three stages:\n1.  Establish the theoretical model that relates the measured quantities ($F, \\Gamma_s$) to the desired noise parameters ($F_{\\min}, R_n, \\Gamma_{\\text{opt}}$).\n2.  Formulate a numerical optimization procedure (nonlinear least-squares) to estimate the parameters from the provided data.\n3.  Apply this procedure to the given test cases, ensuring all data conversions and constraints are correctly handled.\n\n**1. Theoretical Model Derivation**\n\nThe problem provides two fundamental definitions. First, the noise figure $F$ is defined as the ratio of the input signal-to-noise ratio to the output signal-to-noise ratio. Second, for a source at a physical temperature $T_s$, the noise figure is related to the two-port's effective input-referred noise temperature, $T_e$, by:\n$$ F = 1 + \\frac{T_e}{T_s} $$\nThe effective temperature $T_e$ is an intrinsic property of the two-port device and its operating conditions, but it is independent of the source temperature $T_s$. The noise figure $F$, however, is dependent on $T_s$. To establish a consistent basis for parameter fitting, all measured noise figures must be referenced to the standard noise temperature, $T_0 = 290\\,\\text{K}$. For each measurement of $F$ taken with a source at temperature $T_s$, we first calculate the invariant effective temperature $T_e$:\n$$ T_e = (F - 1)T_s $$\nThen, we compute the equivalent noise figure $F_{T_0}$ referenced to $T_0$:\n$$ F_{T_0} = 1 + \\frac{T_e}{T_0} $$\nThis conversion is a necessary first step for any test case where $T_s \\neq T_0$.\n\nThe canonical representation for the noise figure of a linear two-port expresses its dependence on the source impedance. While often expressed in terms of source reflection coefficient $\\Gamma_s$, the most fundamental relationship is in terms of the source admittance, $Y_s = G_s + jB_s$. This relationship is given by:\n$$ F(Y_s) = F_{\\min} + \\frac{R_n}{G_s} |Y_s - Y_{\\text{opt}}|^2 $$\nHere, $F_{\\min}$ is the minimum achievable noise figure, $R_n$ is the equivalent noise resistance, and $Y_{\\text{opt}} = G_{\\text{opt}} + jB_{\\text{opt}}$ is the optimum source admittance that results in $F = F_{\\min}$. These three parameters ($F_{\\min}$, $R_n$, $Y_{\\text{opt}}$) uniquely characterize the noise performance of the two-port. The problem asks for $\\Gamma_{\\text{opt}}$, which is related to $Y_{\\text{opt}}$.\n\nOur task reduces to finding the four real parameters ($F_{\\min}, R_n, G_{\\text{opt}}, B_{\\text{opt}}$) that best fit the provided measurement data. The equation can be expanded as:\n$$ F(Y_s) = F_{\\min} + \\frac{R_n}{G_s} \\left( (G_s - G_{\\text{opt}})^2 + (B_s - B_{\\text{opt}})^2 \\right) $$\n\nFor each measurement point, the source reflection coefficient $\\Gamma_s$ must be converted to source admittance $Y_s$. Given a reference impedance $Z_0$, the relationship is:\n$$ Y_s = \\frac{1}{Z_0} \\frac{1 - \\Gamma_s}{1 + \\Gamma_s} $$\nFrom this complex value, we extract the real part, $G_s = \\Re\\{Y_s\\}$, and the imaginary part, $B_s = \\Im\\{Y_s\\}$.\n\n**2. Parameter Estimation via Nonlinear Least-Squares**\n\nWith the model established, we can formulate the estimation as a nonlinear least-squares problem. We seek the parameter vector $p = [F_{\\min}, R_n, G_{\\text{opt}}, B_{\\text{opt}}]$ that minimizes the sum of squared differences between the measured (and temperature-corrected) noise figures, $F_{i,T_0}$, and the values predicted by the model, $F_{\\text{model}}(Y_{s,i}; p)$:\n$$ \\min_{p} \\sum_{i} \\left( F_{i,T_0} - F_{\\text{model}}(Y_{s,i}; p) \\right)^2 $$\nThis optimization must be performed subject to physical constraints:\n1.  $F_{\\min} \\ge 1$: The noise figure of a passive source network followed by an amplifier cannot be less than $1$ (which corresponds to $0\\,\\text{dB}$).\n2.  $R_n \\ge 0$: The noise resistance must be non-negative.\n3.  $|\\Gamma_{\\text{opt}}| < 1$: The optimum source impedance must be passive, meaning it has a positive real part. The condition $|\\Gamma_{\\text{opt}}|<1$ for a reflection coefficient corresponds to the real part of its associated impedance/admittance being positive. For a real $Z_0 > 0$, the condition $|\\Gamma_{\\text{opt}}| < 1$ is equivalent to $\\Re\\{Y_{\\text{opt}}\\} > 0$, or $G_{\\text{opt}} > 0$.\n\nWe will use the `scipy.optimize.least_squares` function, which is well-suited for this task and can directly handle bound constraints on the parameters.\n\n**3. Implementation and Final Conversion**\n\nThe algorithm for each test case is as follows:\n1.  For each measurement point $(\\Gamma_{s,i}, F_i)$, perform data preprocessing:\n    a. Convert the polar representation $(\\lvert\\Gamma_s\\rvert, \\angle\\Gamma_s)$ to a complex number $\\Gamma_{s,i}$.\n    b. Calculate the corresponding source admittance $Y_{s,i} = G_{s,i} + jB_{s,i}$.\n    c. If $T_s \\neq 290\\,\\text{K}$, convert the measured $F_i$ to its standard temperature equivalent $F_{i,T_0}$.\n2.  Set up the nonlinear least-squares problem:\n    a. Define a residual function that computes $F_{\\text{model}}(Y_{s,i}; p) - F_{i,T_0}$ for all $i$.\n    b. Provide an initial guess for the parameters $p_0 = [F_{\\min,0}, R_{n,0}, G_{\\text{opt},0}, B_{\\text{opt},0}]$. A reasonable heuristic is to use the measurement point with the lowest noise figure to inform the initial guess for $F_{\\min}$ and $Y_{\\text{opt}}$.\n    c. Specify the bounds for the parameters: $[1, 0, \\epsilon, -\\infty]$ for the lower bounds and $[\\infty, \\infty, \\infty, \\infty]$ for the upper bounds, where $\\epsilon$ is a small positive number (e.g., $10^{-9}$) to enforce $G_{\\text{opt}} > 0$.\n3.  Execute the optimization to find the best-fit parameters $\\hat{p} = [\\hat{F}_{\\min}, \\hat{R}_n, \\hat{G}_{\\text{opt}}, \\hat{B}_{\\text{opt}}]$.\n4.  Convert the optimal source admittance $\\hat{Y}_{\\text{opt}} = \\hat{G}_{\\text{opt}} + j\\hat{B}_{\\text{opt}}$ back to the required optimal source reflection coefficient $\\hat{\\Gamma}_{\\text{opt}}$:\n    $$ \\hat{\\Gamma}_{\\text{opt}} = \\frac{1 - \\hat{Y}_{\\text{opt}}Z_0}{1 + \\hat{Y}_{\\text{opt}}Z_0} $$\n5.  Finally, format the results $[\\hat{F}_{\\min}, \\hat{R}_n, \\Re\\{\\hat{\\Gamma}_{\\text{opt}}\\}, \\Im\\{\\hat{\\Gamma}_{\\text{opt}}\\}]$ and round each value to six decimal places as requested.\n\nThis structured, principle-based approach ensures a robust and accurate estimation of the LNA's noise parameters.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, process them, and print the results.\n    \"\"\"\n\n    # Define the test suite of measurements.\n    test_cases = [\n        {\n            \"Z0\": 50.0,\n            \"Ts\": 290.0,\n            \"gamma_s_polar\": [\n                (0.2, 0.0), (0.4, -np.pi/3), (0.6, np.pi/2), (0.8, -2*np.pi/3),\n                (0.5, np.pi/6), (0.7, np.pi), (0.3, -np.pi/6), (0.9, 2*np.pi/3)\n            ],\n            \"F_measured\": [1.21639, 1.21202, 1.639, 1.942, 1.3307, 1.93, 1.201242, 4.261]\n        },\n        {\n            \"Z0\": 50.0,\n            \"Ts\": 290.0,\n            \"gamma_s_polar\": [\n                (0.1, 0.0), (0.3, np.pi/3), (0.5, -np.pi/2), (0.7, 5*np.pi/6),\n                (0.9, -5*np.pi/6), (0.95, np.pi)\n            ],\n            \"F_measured\": [1.05391, 1.051414, 1.12965, 1.18306, 1.83864, 2.547]\n        },\n        {\n            \"Z0\": 50.0,\n            \"Ts\": 350.0,\n            \"gamma_s_polar\": [\n                (0.2, -np.pi/2), (0.4, -2*np.pi/3), (0.6, 0.0),\n                (0.8, np.pi/4), (0.95, -np.pi/4)\n            ],\n            \"F_measured\": [1.473143, 1.46205, 2.023, 3.989, 4.551]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = estimate_noise_parameters(\n            case[\"Z0\"], case[\"Ts\"], case[\"gamma_s_polar\"], case[\"F_measured\"]\n        )\n        results.append(result)\n\n    # Format the final output string to match the specified format.\n    # str(list) introduces spaces, so they are removed.\n    print(str(results).replace(\" \", \"\"))\n\ndef estimate_noise_parameters(Z0, Ts, gamma_s_polar, F_measured):\n    \"\"\"\n    Estimates LNA noise parameters from measurement data using non-linear least squares.\n\n    Args:\n        Z0 (float): Reference impedance in Ohms.\n        Ts (float): Source noise temperature in Kelvin.\n        gamma_s_polar (list of tuples): List of (magnitude, angle in radians) for Gamma_s.\n        F_measured (list of floats): List of measured noise figures (dimensionless ratio).\n\n    Returns:\n        list: A list containing [F_min, R_n, Re(Gamma_opt), Im(Gamma_opt)],\n              with each value rounded to six decimal places.\n    \"\"\"\n    T0 = 290.0\n    \n    # 1. Data Preparation\n    gamma_s = np.array([mag * np.exp(1j * ang) for mag, ang in gamma_s_polar])\n    Y0 = 1.0 / Z0\n    Y_s = Y0 * (1 - gamma_s) / (1 + gamma_s)\n    G_s = Y_s.real\n    B_s = Y_s.imag\n    \n    # Convert measured F to F at standard temperature T0\n    F_measured_arr = np.array(F_measured)\n    T_e = (F_measured_arr - 1.0) * Ts\n    F_T0 = 1.0 + T_e / T0\n\n    # 2. Least-squares fitting\n    def residuals(params, Gs_arr, Bs_arr, Fs_arr):\n        \"\"\"Residuals for the non-linear least squares fit.\"\"\"\n        F_min, R_n, G_opt, B_opt = params\n        F_model = F_min + (R_n / Gs_arr) * ((Gs_arr - G_opt)**2 + (Bs_arr - B_opt)**2)\n        return F_model - Fs_arr\n\n    # Heuristic initial guess based on data\n    min_F_idx = np.argmin(F_T0)\n    x0_F_min = F_T0[min_F_idx]\n    x0_Rn = Z0 / 2.0  # Common order of magnitude\n    x0_Y_opt = Y_s[min_F_idx]\n    x0 = [x0_F_min, x0_Rn, x0_Y_opt.real, x0_Y_opt.imag]\n\n    # Physical constraints as bounds\n    # F_min >= 1, R_n >= 0, G_opt > 0\n    bounds = ([1.0, 0.0, 1e-9, -np.inf], [np.inf, np.inf, np.inf, np.inf])\n\n    # Perform the optimization\n    res = least_squares(residuals, x0, args=(G_s, B_s, F_T0), bounds=bounds, method='trf')\n    F_min_fit, R_n_fit, G_opt_fit, B_opt_fit = res.x\n\n    # 3. Convert optimal admittance Y_opt back to reflection coefficient Gamma_opt\n    Y_opt_fit = G_opt_fit + 1j * B_opt_fit\n    gamma_opt_fit = (1 - Y_opt_fit * Z0) / (1 + Y_opt_fit * Z0)\n\n    # 4. Format and return the final results\n    return [\n        round(F_min_fit, 6),\n        round(R_n_fit, 6),\n        round(gamma_opt_fit.real, 6),\n        round(gamma_opt_fit.imag, 6)\n    ]\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}