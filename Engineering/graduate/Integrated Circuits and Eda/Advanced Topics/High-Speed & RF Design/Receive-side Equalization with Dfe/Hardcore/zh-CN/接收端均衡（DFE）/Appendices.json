{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导您亲手完成判决反馈均衡器 (DFE) 核心功能的完整推演。通过为给定的四电平脉冲幅度调制 (PAM4) 信号手动计算每个时间步的输出，您将清晰地看到 DFE 如何利用过去的判决来消除后标游标码间干扰 (post-cursor ISI)，从而做出新的判决。这项实践旨在巩固您对 DFE 基本递归方程的理解。",
            "id": "4292729",
            "problem": "在一个基带脉冲幅度调制 (PAM) 链路的接收端，使用了一个符号速率判决反馈均衡器 (DFE)。发送的符号来自四电平脉冲幅度调制 (PAM4) 码元集 $\\{-3,-1,+1,+3\\}$，具有单位符号间隔和符号周期 $T$ 秒。该离散时间基带信道是线性时不变的，其有限脉冲响应 $h[n]$ 的支撑集为 $\\{0,1,2\\}$。信道输出受到独立同分布、均值为零、方差为 $\\sigma^{2}$ 的加性高斯白噪声 (AWGN) 采样的干扰。接收机由一个在 $t=nT$ 处采样的采样器、一个具有 $M=2$ 个反馈抽头的T间隔DFE和一个增益归一化判决器组成。DFE从当前采样中减去一个按比例重构的过去已判决符号，以抑制后码间干扰。判决器将其输入映射到 $\\{-3,-1,+1,+3\\}$ 中最近的符号，判决阈值位于相邻符号的中间。在判决之前，应用一个等于主抽头系数倒数的增益归一化，以便判决器对一个适当归一化的采样进行操作。\n\n从采样器输出端接收采样的标准离散时间线性时不变卷积模型和T间隔判决反馈均衡器的定义出发，推导DFE判决变量关于信道脉冲响应采样、反馈系数、过去已判决符号和噪声的递推公式。然后，使用你推导出的递推公式，根据以下指定的参数和信号，计算当 $n=0,1,2,3,4,5$ 时判决变量 $y[n]$ 和已判决符号 $d[n]$ 的数值序列：\n\n- 信道脉冲响应采样: $h[0]=0.9$, $h[1]=0.35$, $h[2]=0.2$.\n- DFE反馈系数: $b_{1}=0.35$, $b_{2}=0.2$.\n- 噪声方差: $\\sigma^{2}=0.04$.\n- 噪声实现 (为保证可复现性，采用一次固定的抽取): $w[0]=0.06$, $w[1]=-0.12$, $w[2]=0.15$, $w[3]=-0.04$, $w[4]=0.09$, $w[5]=-0.22$.\n- 发送的PAM4符号: $a[0]=+3$, $a[1]=+1$, $a[2]=-1$, $a[3]=-3$, $a[4]=+1$, $a[5]=+3$.\n- 初始化: $d[-1]=0$, $d[-2]=0$.\n- 判决器归一化: 在判决前，对DFE输出应用一个等于 $1/h[0]$ 的增益因子。\n- 判决器判决规则: 对于输入$v$，如果 $v  -2$ 则判决为-3，如果 $-2 \\leq v  0$ 则判决为-1，如果 $0 \\leq v  2$ 则判决为+1，如果 $v \\geq 2$ 则判决为+3。\n\n将你的最终结果报告为一个单一的行向量，该向量按顺序连接六个判决变量和六个已判决符号\n$$\\big(y[0],y[1],y[2],y[3],y[4],y[5],d[0],d[1],d[2],d[3],d[4],d[5]\\big)。$$\n将所有数值条目四舍五入到四位有效数字。答案无单位。",
            "solution": "该问题提法明确，具有科学依据，并为得到唯一解提供了所有必要的信息。我将首先推导系统的控制方程，然后计算所需的序列。\n\n首先，我们建立采样器输出端信号的离散时间模型，记为$x[n]$。该信号是发送符号$a[n]$与信道有限脉冲响应$h[n]$卷积的结果，并受到加性高斯白噪声$w[n]$的干扰。卷积由下式给出：\n$$ x[n] = \\sum_{k=-\\infty}^{\\infty} h[k] a[n-k] + w[n] $$\n鉴于信道脉冲响应$h[n]$的支撑集为$\\{0,1,2\\}$，该求和简化为：\n$$ x[n] = h[0]a[n] + h[1]a[n-1] + h[2]a[n-2] + w[n] $$\n在这里，$h[0]$代表主抽头，而$h[1]$和$h[2]$代表后码间干扰 (ISI) 抽头。\n\n判决反馈均衡器 (DFE) 旨在消除由先前已判决符号引起的码间干扰。DFE通过从接收采样$x[n]$中减去后码间干扰的估计值来计算判决变量$y[n]$。该码间干扰估计值由最近的$M$个已判决符号$d[n-k]$与反馈系数$b_k$的线性组合构成。对于本问题，$M=2$。\n因此，判决变量$y[n]$为：\n$$ y[n] = x[n] - \\sum_{k=1}^{M} b_k d[n-k] = x[n] - (b_1 d[n-1] + b_2 d[n-2]) $$\n将$x[n]$的表达式代入$y[n]$的方程，我们得到判决变量的完整递推公式：\n$$ y[n] = (h[0]a[n] + h[1]a[n-1] + h[2]a[n-2] + w[n]) - (b_1 d[n-1] + b_2 d[n-2]) $$\n这就是问题所要求的DFE判决变量的递推公式。\n\n在做出判决之前，判决变量$y[n]$通过一个等于主抽头系数倒数$1/h[0]$的增益因子进行归一化。我们称归一化的判决器输入为$v[n]$：\n$$ v[n] = \\frac{1}{h[0]} y[n] $$\n然后，判决器将$v[n]$映射到PAM4码元集$\\{-3, -1, +1, +3\\}$中最近的符号，以产生已判决符号$d[n]$。判决阈值被指定为相邻符号的中间点，即-2、0和2。判决器函数 $d[n] = \\text{slicer}(v[n])$ 定义如下：\n$$ d[n] = \\begin{cases} -3  \\text{if } v[n]  -2 \\\\ -1  \\text{if } -2 \\leq v[n]  0 \\\\ +1  \\text{if } 0 \\leq v[n]  2 \\\\ +3  \\text{if } v[n] \\geq 2 \\end{cases} $$\n我们现在开始计算 $n=0, 1, ..., 5$ 时 $y[n]$ 和 $d[n]$ 的数值序列。问题提供了 $n \\geq 0$ 时的发送符号序列 $a[n]$。我们做出标准假设，即传输从 $n=0$ 开始，因此对于任何 $k  0$，都有 $a[k]=0$。\n\n计算所用的参数如下：\n- 信道: $h[0]=0.9$, $h[1]=0.35$, $h[2]=0.2$.\n- DFE抽头: $b_1=0.35$, $b_2=0.2$.\n- 发送符号: $a[0]=3$, $a[1]=1$, $a[2]=-1$, $a[3]=-3$, $a[4]=1$, $a[5]=3$.\n- 噪声采样: $w[0]=0.06$, $w[1]=-0.12$, $w[2]=0.15$, $w[3]=-0.04$, $w[4]=0.09$, $w[5]=-0.22$.\n- 初始条件: $d[-1]=0$, $d[-2]=0$. 我们也假设 $a[-1]=0$, $a[-2]=0$.\n\n**逐步计算：**\n\n对于 $n=0$:\n$y[0] = h[0]a[0] + h[1]a[-1] + h[2]a[-2] + w[0] - b_1 d[-1] - b_2 d[-2]$\n$y[0] = (0.9)(3) + (0.35)(0) + (0.2)(0) + 0.06 - (0.35)(0) - (0.2)(0) = 2.7 + 0.06 = 2.76$\n$v[0] = y[0] / 0.9 = 2.76 / 0.9 \\approx 3.0667$。因为 $v[0] \\geq 2$，所以 $d[0]=3$。\n\n对于 $n=1$:\n$y[1] = h[0]a[1] + h[1]a[0] + h[2]a[-1] + w[1] - b_1 d[0] - b_2 d[-1]$\n$y[1] = (0.9)(1) + (0.35)(3) + (0.2)(0) + (-0.12) - (0.35)(3) - (0.2)(0) = 0.9 + 1.05 - 0.12 - 1.05 = 0.78$\n$v[1] = y[1] / 0.9 = 0.78 / 0.9 \\approx 0.8667$。因为 $0 \\leq v[1]  2$，所以 $d[1]=1$。\n\n对于 $n=2$:\n$y[2] = h[0]a[2] + h[1]a[1] + h[2]a[0] + w[2] - b_1 d[1] - b_2 d[0]$\n$y[2] = (0.9)(-1) + (0.35)(1) + (0.2)(3) + 0.15 - (0.35)(1) - (0.2)(3) = -0.9 + 0.35 + 0.6 + 0.15 - 0.35 - 0.6 = -0.75$\n$v[2] = y[2] / 0.9 = -0.75 / 0.9 \\approx -0.8333$。因为 $-2 \\leq v[2]  0$，所以 $d[2]=-1$。\n\n对于 $n=3$:\n$y[3] = h[0]a[3] + h[1]a[2] + h[2]a[1] + w[3] - b_1 d[2] - b_2 d[1]$\n$y[3] = (0.9)(-3) + (0.35)(-1) + (0.2)(1) + (-0.04) - (0.35)(-1) - (0.2)(1) = -2.7 - 0.35 + 0.2 - 0.04 + 0.35 - 0.2 = -2.74$\n$v[3] = y[3] / 0.9 = -2.74 / 0.9 \\approx -3.0444$。因为 $v[3]  -2$，所以 $d[3]=-3$。\n\n对于 $n=4$:\n$y[4] = h[0]a[4] + h[1]a[3] + h[2]a[2] + w[4] - b_1 d[3] - b_2 d[2]$\n$y[4] = (0.9)(1) + (0.35)(-3) + (0.2)(-1) + 0.09 - (0.35)(-3) - (0.2)(-1) = 0.9 - 1.05 - 0.2 + 0.09 + 1.05 + 0.2 = 0.99$\n$v[4] = y[4] / 0.9 = 0.99 / 0.9 = 1.1$。因为 $0 \\leq v[4]  2$，所以 $d[4]=1$。\n\n对于 $n=5$:\n$y[5] = h[0]a[5] + h[1]a[4] + h[2]a[3] + w[5] - b_1 d[4] - b_2 d[3]$\n$y[5] = (0.9)(3) + (0.35)(1) + (0.2)(-3) + (-0.22) - (0.35)(1) - (0.2)(-3) = 2.7 + 0.35 - 0.6 - 0.22 - 0.35 + 0.6 = 2.48$\n$v[5] = y[5] / 0.9 = 2.48 / 0.9 \\approx 2.7556$。因为 $v[5] \\geq 2$，所以 $d[5]=3$。\n\n一个重要的观察是，DFE反馈系数$b_k$被选择为等于信道的后码间干扰抽头$h[k]$（对于$k=1,2$）。这是一种迫零DFE设计。只要没有判决错误（即，对于$k>0$有$d[n-k] = a[n-k]$），码间干扰就会被完全消除。在我们的计算中，我们发现对于所有$n \\in \\{0, 1, ..., 5\\}$，都有$d[n]=a[n]$。因此，对于$n \\geq 2$，码间干扰项$\\sum h[k]a[n-k]$和$\\sum b_k d[n-k]$相互抵消，将判决变量简化为$y[n] = h[0]a[n] + w[n]$。这证实了我们逐步计算的正确性。\n\n计算出的序列是：\n$y = [2.76, 0.78, -0.75, -2.74, 0.99, 2.48]$\n$d = [3, 1, -1, -3, 1, 3]$\n\n将这些数值四舍五入到四位有效数字后得到：\n$y_{\\text{rounded}} = [2.760, 0.7800, -0.7500, -2.740, 0.9900, 2.480]$\n$d_{\\text{rounded}} = [3.000, 1.000, -1.000, -3.000, 1.000, 3.000]$\n\n最终的连接向量由这些值组成。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 2.760  0.7800  -0.7500  -2.740  0.9900  2.480  3.000  1.000  -1.000  -3.000  1.000  3.000 \\end{pmatrix} } $$"
        },
        {
            "introduction": "DFE 的有效性取决于其抽头系数是否与信道的后标游标 ISI 相匹配。本练习将探讨如何使用最小均方 (LMS) 算法自动学习这些系数。您将执行单个更新步骤，亲身体验期望输出与实际输出之间的误差如何指导反馈抽头的调整，从而深入理解 DFE 的自适应过程。",
            "id": "4292782",
            "problem": "考虑一个用于集成电路与电子设计自动化 (EDA) 领域中高速串行器/解串器 (SerDes) 接收链路的基带判决反馈均衡器 (DFE)。DFE 的目标是消除由离散时间线性时不变信道引入的后标脉冲间干扰。在符号时刻 $n$ 的 DFE 输出被建模为 $y[n] = y_{\\mathrm{ff}}[n] - \\sum_{i=1}^{M} b_{i}\\,d[n-i]$，其中 $y_{\\mathrm{ff}}[n]$ 是前馈均衡器输出，$b_{i}$ 是 DFE 反馈抽头系数，$d[n-i] \\in \\{-1,+1\\}$ 是过去的硬判决。瞬时误差定义为 $e[n] = a[n] - y[n]$，其中 $a[n] \\in \\{-1,+1\\}$ 是在由伪随机二进制序列 (PRBS) 驱动的训练间隔期间的已知训练符号。\n\n在训练期间，由于已知和受控的训练模式，假定过去的硬判决等于过去的训练符号。设用于自适应的代价函数为瞬时半均方误差 $J[n] = \\tfrac{1}{2} e[n]^{2}$，并使用梯度下降法来更新反馈系数。您将使用最小均方 (LMS) 方法，在单个时间点 $n_{0}$ 执行一个自适应步骤，将瞬时梯度视为期望的估计。\n\n在时刻 $n_{0}$，以下为测量或已知值：\n- PRBS 训练映射使用 $0 \\mapsto -1$ 和 $1 \\mapsto +1$。在 $n_{0}$ 之前的最后三个训练比特是 $\\{1,0,0\\}$，因此过去的硬判决为 $d[n_{0}-1]=+1$，$d[n_{0}-2]=-1$ 和 $d[n_{0}-3]=-1$。\n- 当前的训练符号是 $a[n_{0}] = +1$。\n- 当前均衡器输出的测量值为 $y[n_{0}] = 0.85$，所以瞬时误差为 $e[n_{0}] = a[n_{0}] - y[n_{0}]$。\n- 当前的反馈抽头向量是 $\\mathbf{b} = [\\,b_{1},\\,b_{2},\\,b_{3}\\,] = [\\,0.04,\\,-0.015,\\,0.02\\,]$。\n- 步长是 $\\mu = 0.01$，反馈抽头的数量是 $M=3$。\n\n从上述模型假设和代价函数的定义出发，使用梯度下降的第一性原理推导反馈系数的瞬时 LMS 更新，然后在 $n_{0}$ 时刻进行一次迭代后，数值计算更新后的反馈抽头向量。将您最终更新的系数表示为 $[\\,b_{1}^{+},\\,b_{2}^{+},\\,b_{3}^{+}\\,]$ 形式的无量纲行矩阵。将您的答案四舍五入到六位有效数字。",
            "solution": "## 问题有效性分析\n\n根据定义的标准对问题进行审查。该问题描述了一个使用最小均方 (LMS) 算法进行自适应的判决反馈均衡器 (DFE)。这是数字通信、信号处理以及用于 SerDes 接收器的集成电路设计中的一个标准和基础课题。所有的模型和定义（$y[n]$，$e[n]$，$J[n]$）都是标准表示法，问题在科学上是合理的。问题陈述清晰，并提供了计算 DFE 系数单个更新步骤所需的所有数值和定义。目标明确，可以获得唯一解。因此，此问题是 **有效的**，将提供完整的解法。\n\n## 解题步骤\n\n目标是计算在时刻 $n_0$ 进行单个自适应步骤后更新的 DFE 反馈抽头向量，记为 $\\mathbf{b}^{+}$。该自适应过程由应用于瞬时代价函数 $J[n_0]$ 的梯度下降算法控制。\n\n使用梯度下降法对权重向量 $\\mathbf{w}$ 的更新规则如下：\n$$ \\mathbf{w}[n+1] = \\mathbf{w}[n] - \\mu \\nabla_{\\mathbf{w}} J[n] $$\n在这个问题中，权重向量是 DFE 反馈抽头向量 $\\mathbf{b} = [b_1, b_2, \\dots, b_M]^T$。因此，在时刻 $n_0$ 的更新规则是：\n$$ \\mathbf{b}^{+} = \\mathbf{b}[n_0] - \\mu \\nabla_{\\mathbf{b}} J[n_0] $$\n其中 $\\mathbf{b}[n_0]$ 是更新前的抽头向量，$\\nabla_{\\mathbf{b}} J[n_0]$ 是代价函数关于 $\\mathbf{b}$ 在时刻 $n_0$ 的梯度。LMS 算法使用瞬时值来近似真实梯度（一个期望值）。\n\n梯度 $\\nabla_{\\mathbf{b}} J[n_0]$ 是一个向量，其分量是偏导数 $\\frac{\\partial J[n_0]}{\\partial b_k}$，其中 $k=1, 2, \\dots, M$。我们使用链式法则来推导这个偏导数：\n$$ \\frac{\\partial J[n_0]}{\\partial b_k} = \\frac{\\partial}{\\partial b_k} \\left( \\frac{1}{2} e[n_0]^2 \\right) = e[n_0] \\frac{\\partial e[n_0]}{\\partial b_k} $$\n接下来，我们求误差 $e[n_0]$ 关于 $b_k$ 的导数。将 $y[n_0]$ 的表达式代入误差定义中：\n$$ e[n_0] = a[n_0] - y[n_0] = a[n_0] - \\left( y_{\\mathrm{ff}}[n_0] - \\sum_{i=1}^{M} b_i d[n_0-i] \\right) = a[n_0] - y_{\\mathrm{ff}}[n_0] + \\sum_{i=1}^{M} b_i d[n_0-i] $$\n项 $a[n_0]$ 和 $y_{\\mathrm{ff}}[n_0]$ 不依赖于反馈系数 $b_k$。求和项关于 $b_k$ 的导数就是 $b_k$ 的系数，即 $d[n_0-k]$。\n$$ \\frac{\\partial e[n_0]}{\\partial b_k} = \\frac{\\partial}{\\partial b_k} \\left( a[n_0] - y_{\\mathrm{ff}}[n_0] + \\sum_{i=1}^{M} b_i d[n_0-i] \\right) = d[n_0-k] $$\n将此结果代回梯度分量的表达式中：\n$$ \\frac{\\partial J[n_0]}{\\partial b_k} = e[n_0] d[n_0-k] $$\n因此，完整的梯度向量是：\n$$ \\nabla_{\\mathbf{b}} J[n_0] = \\begin{pmatrix} e[n_0]d[n_0-1] \\\\ e[n_0]d[n_0-2] \\\\ \\vdots \\\\ e[n_0]d[n_0-M] \\end{pmatrix} = e[n_0] \\mathbf{d}[n_0] $$\n其中 $\\mathbf{d}[n_0] = [d[n_0-1], d[n_0-2], \\dots, d[n_0-M]]^T$。\n\nDFE 反馈系数的最终 LMS 更新方程是：\n$$ \\mathbf{b}^{+} = \\mathbf{b}[n_0] - \\mu e[n_0] \\mathbf{d}[n_0] $$\n现在，我们代入给定的数值来计算更新后的向量 $\\mathbf{b}^{+}$。\n\n首先，计算瞬时误差 $e[n_0]$：\n$$ e[n_0] = a[n_0] - y[n_0] = 1 - 0.85 = 0.15 $$\n\n给定的值为：\n-   $\\mathbf{b}[n_0] = [\\,0.04,\\, -0.015,\\, 0.02\\,]^T$\n-   $\\mu = 0.01$\n-   $e[n_0] = 0.15$\n-   $\\mathbf{d}[n_0] = [\\,+1,\\, -1,\\, -1\\,]^T$\n\n现在，计算更新项 $\\mu e[n_0] \\mathbf{d}[n_0]$：\n$$ \\mu e[n_0] \\mathbf{d}[n_0] = (0.01)(0.15) \\begin{pmatrix} +1 \\\\ -1 \\\\ -1 \\end{pmatrix} = 0.0015 \\begin{pmatrix} +1 \\\\ -1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0.0015 \\\\ -0.0015 \\\\ -0.0015 \\end{pmatrix} $$\n最后，计算更新后的系数向量 $\\mathbf{b}^{+}$：\n$$ \\mathbf{b}^{+} = \\mathbf{b}[n_0] - \\mu e[n_0] \\mathbf{d}[n_0] = \\begin{pmatrix} 0.04 \\\\ -0.015 \\\\ 0.02 \\end{pmatrix} - \\begin{pmatrix} 0.0015 \\\\ -0.0015 \\\\ -0.0015 \\end{pmatrix} $$\n$$ \\mathbf{b}^{+} = \\begin{pmatrix} 0.04 - 0.0015 \\\\ -0.015 - (-0.0015) \\\\ 0.02 - (-0.0015) \\end{pmatrix} = \\begin{pmatrix} 0.0385 \\\\ -0.015 + 0.0015 \\\\ 0.02 + 0.0015 \\end{pmatrix} = \\begin{pmatrix} 0.0385 \\\\ -0.0135 \\\\ 0.0215 \\end{pmatrix} $$\n问题要求答案以无量纲行矩阵的形式表示，并四舍五入到六位有效数字。\n-   $b_1^{+} = 0.0385000$\n-   $b_2^{+} = -0.0135000$\n-   $b_3^{+} = 0.0215000$\n更新后的反馈抽头向量是 $[\\,0.0385000, -0.0135000, 0.0215000\\,]$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.0385000  -0.0135000  0.0215000 \\end{pmatrix} } $$"
        }
    ]
}