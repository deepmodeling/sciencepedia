{
    "hands_on_practices": [
        {
            "introduction": "能量效率是存内计算的核心驱动力之一，我们的第一个实践将聚焦于此。我们将为一个电阻式交叉阵列构建一个“自下而上”的能量模型，该模型会涵盖数模转换器（DAC）、模数转换器（ADC）以及存储阵列本身等关键组件。通过这个练习，你将理解并行计算如何分摊外围电路的能量开销，这正是大规模存内计算架构实现高能效的关键原理 。",
            "id": "4276912",
            "problem": "考虑一个电阻交叉阵列存内计算宏单元，它沿一列执行点积运算，该列有 $N$ 行。每一行以电导的形式存储一个 $8$ 位权重，并由一个编码为电压的 $8$ 位输入驱动。一个数模转换器（DAC）从数字输入生成行电压，阵列通过欧姆传导和列上的电流求和来执行模拟乘积累加（MAC）操作，并且每个点积运算由一个模数转换器（ADC）将列电流数字化。外围电路（例如，字线驱动器、采样保持电路、参考生成电路）在每次列操作中会产生能量成本。\n\n使用以下数据，所有数据均针对 $8$ 位分辨率指定：\n- 每个输入元件激活的 DAC 能量：$E_{\\text{DAC}} = 0.2\\ \\text{pJ}$。\n- 每个模拟 MAC 的阵列传导能量：$E_{\\text{array}} = 0.05\\ \\text{pJ}/\\text{MAC}$。\n- 每次列转换的 ADC 能量：$E_{\\text{ADC}} = 1\\ \\text{pJ}/\\text{conv}$。\n- 每次列操作的外围电路能量：$E_{\\text{periph}} = 0.1\\ \\text{pJ}$。\n- 每列的行数：$N = 256$。\n\n从总能量是独立子操作能量之和，并且列级能量被点积并行产生的 MAC 数量分摊的原理出发，推导沿一列的每个有效 $8$ 位 MAC 的总能量表达式，并根据给定参数计算其值。将你的最终答案以皮焦耳（$\\text{pJ}$）为单位表示，并将结果四舍五入到六位有效数字。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于集成电路能耗原理，特别是针对存内计算架构。问题提法清晰，提供了所有必要的参数和明确的目标。数据在量纲上一致，并且对于现代半导体技术而言是物理上现实的。\n\n目标是推导电阻交叉阵列中每次有效 $8$ 位乘积累加（MAC）操作的总能量表达式，并计算其数值。\n\n如问题所述，基本原理是单次列操作的总能量（表示为 $E_{\\text{total\\_col}}$）是其组成部分所消耗能量的总和。所讨论的操作是向量-矩阵乘法，具体来说是输入电压向量与阵列一列上存储的电导向量之间的点积。\n\n一次完整列操作的总能量的组成部分如下：\n\n$1$. 数模转换器（DAC）能量：$N$ 行中的每一行都由一个 DAC 生成的输入电压驱动。由于所有 $N$ 行都被激活以计算点积，DAC 消耗的总能量是每次 DAC 激活的能量 $E_{\\text{DAC}}$ 乘以行数 $N$。\n$$ E_{\\text{DAC\\_total}} = N \\cdot E_{\\text{DAC}} $$\n\n$2$. 阵列传导能量：核心的乘积累加操作发生在电阻阵列内部。对于列中的 $N$ 个单元中的每一个，都会执行一次乘法运算（欧姆定律：$I = V \\cdot G$）。问题给出了每个模拟 MAC 的能量 $E_{\\text{array}}$。由于 $N$ 个这样的操作并行发生，总的阵列能量是：\n$$ E_{\\text{array\\_total}} = N \\cdot E_{\\text{array}} $$\n\n$3$. 模数转换器（ADC）能量：来自列中所有 $N$ 个单元的电流在列线的底部被求和（基尔霍夫电流定律）。这个单一的、加总后的模拟电流随后由一个 ADC 转换回数字值。这是每次列操作的固定能量成本。\n$$ E_{\\text{ADC\\_total}} = E_{\\text{ADC}} $$\n\n$4$. 外围电路能量：列操作需要额外的电路，如字线驱动器、参考电压生成器和采样保持电路。它们的总能量成本作为每次列操作的单个值给出。\n$$ E_{\\text{periph\\_total}} = E_{\\text{periph}} $$\n\n单次列操作的总能量是这些组成部分的总和：\n$$ E_{\\text{total\\_col}} = E_{\\text{DAC\\_total}} + E_{\\text{array\\_total}} + E_{\\text{ADC\\_total}} + E_{\\text{periph\\_total}} $$\n$$ E_{\\text{total\\_col}} = N \\cdot E_{\\text{DAC}} + N \\cdot E_{\\text{array}} + E_{\\text{ADC}} + E_{\\text{periph}} $$\n\n问题要求计算每个有效 $8$ 位 MAC 的能量，我们将其表示为 $E_{\\text{MAC\\_eff}}$。单次列操作执行 $N$ 个并行的 $8$ 位 $\\times$ $8$ 位乘积累加操作。因此，为了求得每次 MAC 的有效能量，我们必须将总的列能量分摊到所执行的 $N$ 个操作上。\n$$ E_{\\text{MAC\\_eff}} = \\frac{E_{\\text{total\\_col}}}{N} $$\n代入 $E_{\\text{total\\_col}}$ 的表达式：\n$$ E_{\\text{MAC\\_eff}} = \\frac{N \\cdot E_{\\text{DAC}} + N \\cdot E_{\\text{array}} + E_{\\text{ADC}} + E_{\\text{periph}}}{N} $$\n这个表达式可以通过将除以 $N$ 分配给各项来简化：\n$$ E_{\\text{MAC\\_eff}} = E_{\\text{DAC}} + E_{\\text{array}} + \\frac{E_{\\text{ADC}} + E_{\\text{periph}}}{N} $$\n这个最终的符号表达式表明，DAC 和阵列的每次 MAC 能量是直接成本，而 ADC 和外围设备的共享、列级开销则被分摊到 $N$ 个并行操作中。\n\n现在，我们代入给定的数值：\n- 每列的行数：$N = 256$\n- 每次激活的 DAC 能量：$E_{\\text{DAC}} = 0.2\\ \\text{pJ}$\n- 每个 MAC 的阵列能量：$E_{\\text{array}} = 0.05\\ \\text{pJ}$\n- 每次转换的 ADC 能量：$E_{\\text{ADC}} = 1\\ \\text{pJ}$\n- 每次列操作的外围电路能量：$E_{\\text{periph}} = 0.1\\ \\text{pJ}$\n\n将这些值代入推导出的 $E_{\\text{MAC\\_eff}}$ 公式中：\n$$ E_{\\text{MAC\\_eff}} = 0.2 + 0.05 + \\frac{1 + 0.1}{256} $$\n$$ E_{\\text{MAC\\_eff}} = 0.25 + \\frac{1.1}{256} $$\n执行除法：\n$$ \\frac{1.1}{256} = 0.004296875 $$\n现在，完成求和：\n$$ E_{\\text{MAC\\_eff}} = 0.25 + 0.004296875 = 0.254296875\\ \\text{pJ} $$\n问题要求将最终答案四舍五入到六位有效数字。前六位有效数字是 $2, 5, 4, 2, 9, 6$。第七位数字是 $8$，大于或等于 $5$，所以我们将第六位数字向上取整。\n$$ E_{\\text{MAC\\_eff}} \\approx 0.254297\\ \\text{pJ} $$",
            "answer": "$$\\boxed{0.254297}$$"
        },
        {
            "introduction": "在理想模型之外，我们现在要面对一个关键的非理想效应：器件非线性。尽管我们常将存储单元建模为完美的线性电阻，但诸如忆阻器（RRAM）等真实器件展现出的复杂 $I-V$ 特性会扭曲计算结果。本练习将引导你分析这种非线性对点积运算精度的影响，并推导出一个保证线性运算的“小信号”条件 。",
            "id": "4276860",
            "problem": "考虑一个用于存内计算（IMC）的电阻交叉阵列，在集成电路和电子设计自动化（EDA）的背景下实现点积运算。在第 $i$ 行和第 $j$ 列的每个交叉点都是一个可编程的灯丝型忆阻器（RRAM）器件，其标称电导为 $G_{ij}$，并由施加的列电压 $V_{j}$ 驱动。行电流由一个跨阻放大器收集，该放大器在行输出端强制实现虚拟地，并且互连寄生参数可以忽略不计。在理想情况下，根据欧姆定律（Ohm's law）$I=GV$ 和在行求和节点处的基尔霍夫电流定律 (KCL)，第 $i$ 行的点积输出是线性求和 $I_{i}^{\\mathrm{ideal}}=\\sum_{j=1}^{N}G_{ij}V_{j}$。然而，即使在编程到固定电导状态时，灯丝型 RRAM 器件的电流-电压特性也表现出非线性，其在 $V_{j}=0$ 附近的奇对称小信号展开式由下式给出\n$$\nI_{ij}(V_{j})=G_{ij}V_{j}+\\kappa_{ij}V_{j}^{3}+\\mathcal{O}(V_{j}^{5}),\n$$\n其中 $\\kappa_{ij}>0$ 量化了器件 $(i,j)$ 的灯丝传导的三阶非线性强度，并且在感兴趣的电压范围内，高阶项可以忽略不计。\n\n仅使用欧姆定律（Ohm's law）、基尔霍夫电流定律（KCL）和器件特性的小信号展开这些基本原理，完成以下任务：\n1. 从第一性原理出发，解释当行电流 $I_{i}=\\sum_{j=1}^{N}I_{ij}(V_{j})$ 用作计算输出时，三次项 $\\kappa_{ij}V_{j}^{3}$ 的存在为何从根本上使基于交叉阵列的点积中的线性求和变得复杂。\n2. 将第 $i$ 行的相对点积误差定义为\n$$\n\\varepsilon_{i}=\\frac{\\left|I_{i}-\\sum_{j=1}^{N}G_{ij}V_{j}\\right|}{\\left|\\sum_{j=1}^{N}G_{ij}V_{j}\\right|},\n$$\n并将其特殊化到最坏情况下的等幅同极性驱动条件 $V_{j}=v$（对于所有 $j\\in\\{1,\\dots,N\\}$，$v\\ge 0$）。推导出一个关于 $v$ 的显式符号上界，以保证对于给定的容差 $\\delta>0$，有 $\\varepsilon_{i}\\le\\delta$ 成立，该上界仅用 $\\delta$、$\\{G_{ij}\\}$ 和 $\\{\\kappa_{ij}\\}$ 表示。\n3. 根据相同的分析，陈述一个小信号线性化条件，该条件描述了在何时三次非线性相对于每个器件和行级的线性项可以忽略不计。\n\n你的最终答案必须是在所述最坏情况下，强制 $\\varepsilon_{i}\\le\\delta$ 的最大允许共同幅值 $v_{\\max}$ 的单一闭式解析表达式。以伏特为单位表示 $v_{\\max}$。不要近似或四舍五入；提供精确的符号表达式。",
            "solution": "首先根据指定标准验证问题陈述。\n\n### 第 1 步：提取已知条件\n- 系统：用于存内计算（IMC）的电阻交叉阵列。\n- 运算：点积。\n- 器件：位于交叉点 $(i,j)$ 的可编程灯丝型忆阻器（RRAM）。\n- 标称电导：$G_{ij}$。\n- 输入：列电压 $V_{j}$。\n- 输出：在虚拟地收集的行电流 $I_{i}$。\n- 寄生参数：互连寄生参数可忽略不计。\n- 理想输出电流：$I_{i}^{\\mathrm{ideal}}=\\sum_{j=1}^{N}G_{ij}V_{j}$。\n- 基本原理：欧姆定律（Ohm's law）$I=GV$ 和基尔霍夫电流定律（KCL）。\n- 非线性器件模型：$I_{ij}(V_{j})=G_{ij}V_{j}+\\kappa_{ij}V_{j}^{3}+\\mathcal{O}(V_{j}^{5})$，高阶项可忽略不计。\n- 非线性参数：$\\kappa_{ij}>0$。\n- 实际输出电流：$I_{i}=\\sum_{j=1}^{N}I_{ij}(V_{j})$。\n- 相对误差定义：$\\varepsilon_{i}=\\frac{\\left|I_{i}-\\sum_{j=1}^{N}G_{ij}V_{j}\\right|}{\\left|\\sum_{j=1}^{N}G_{ij}V_{j}\\right|}$。\n- 分析的最坏情况条件：$V_{j}=v$ 对于所有 $j\\in\\{1,\\dots,N\\}$，其中 $v\\ge 0$。\n- 误差容差：$\\varepsilon_{i}\\le\\delta$ 对于给定的 $\\delta>0$。\n\n### 第 2 步：使用提取的已知条件进行验证\n根据验证清单评估该问题。\n- **科学基础：** 问题陈述基于电气工程和固态物理的既定原理。RRAM 基交叉阵列的模型、欧姆定律（Ohm's law）和基尔霍夫电流定律（KCL）的应用，以及器件 I-V 特性的泰勒级数展开（特别是奇对称非线性）是集成电路和新兴存储技术领域的标准且科学上合理的概念。\n- **适定性：** 问题定义清晰。它提供了一个特定的器件模型、一个电路配置、一个精确的误差定义以及一个特定的工作条件。任务是明确的，并导出一个唯一的、可确定的符号表达式。\n- **客观性：** 问题使用精确、定量的语言表述。它没有主观论断、推测或歧义。\n\n该问题没有表现出任何列出的缺陷。它不是科学上不合理、不可形式化、不完整、不切实际、不适定或琐碎的。它代表了模拟计算硬件中非理想效应分析的一个标准的、有意义的问题。\n\n### 第 3 步：结论和行动\n该问题是**有效的**。将提供一个完整的、有理有据的解决方案。\n\n---\n\n按照要求，解决方案分三部分阐述。所有数学实体都按要求使用 LaTeX 渲染。\n\n### 1. 三次非线性对线性求和的影响\n\n交叉阵列的基本目标是计算一行中的器件电导向量 $\\mathbf{G}_i = (G_{i1}, G_{i2}, \\dots, G_{iN})$ 与施加的列电压向量 $\\mathbf{V} = (V_1, V_2, \\dots, V_N)$ 之间的点积。理想输出是输入电压的线性组合：\n$$\nI_{i}^{\\mathrm{ideal}} = \\sum_{j=1}^{N} G_{ij} V_j\n$$\n该运算依赖于两个原理：每个器件交叉点处的欧姆定律（$I_{ij} = G_{ij}V_j$）和行求和节点处的基尔霍夫电流定律 (KCL)，后者强制要求总输出电流是单个器件电流的总和（$I_i = \\sum_j I_{ij}$）。\n\n当考虑器件非线性时，位置 $(i,j)$ 处流过器件的电流不再与电压成线性关系，而是由所提供的小信号展开式给出：\n$$\nI_{ij}(V_{j}) = G_{ij}V_{j}+\\kappa_{ij}V_{j}^{3}\n$$\n其中 $\\mathcal{O}(V_{j}^{5})$ 和更高阶的项被认为可以忽略不计。\n\n根据 KCL，第 $i$ 行的总电流是这些单个非线性电流的总和：\n$$\nI_i = \\sum_{j=1}^{N} I_{ij}(V_j) = \\sum_{j=1}^{N} \\left( G_{ij}V_{j}+\\kappa_{ij}V_{j}^{3} \\right)\n$$\n通过分配求和，我们可以将表达式分离为理想的线性部分和一个误差项：\n$$\nI_i = \\underbrace{\\sum_{j=1}^{N} G_{ij}V_{j}}_{I_{i}^{\\mathrm{ideal}}} + \\underbrace{\\sum_{j=1}^{N} \\kappa_{ij}V_{j}^{3}}_{I_{i}^{\\mathrm{error}}}\n$$\n三次项的存在从根本上使线性求和变得复杂，因为由此产生的误差项 $I_{i}^{\\mathrm{error}} = \\sum_{j=1}^{N} \\kappa_{ij}V_{j}^{3}$ 不是输入电压 $V_j$ 的线性函数。作为线性系统数学基础的叠加原理被违反了。输出 $I_i$ 不再是输入 $V_j$ 的线性加权和。每列的误差贡献 $\\kappa_{ij}V_j^3$ 取决于该列输入电压的立方，总误差是这些三次项的总和。这与线性运算有根本的不同。例如，将输入电压向量 $\\mathbf{V}$ 加倍并不会使输出电流 $I_i$ 加倍；相反，它会引入一个与 $V_j^3$ 成比例的、不成比例增大的误差分量。这种非线性会扭曲计算结果，使得电流的物理求和不能准确地表示所期望的数学点积。\n\n### 2. 最大电压幅值 $v_{\\max}$ 的推导\n\n第 $i$ 行的相对点积误差定义为：\n$$\n\\varepsilon_{i}=\\frac{\\left|I_{i}-\\sum_{j=1}^{N}G_{ij}V_{j}\\right|}{\\left|\\sum_{j=1}^{N}G_{ij}V_{j}\\right|}\n$$\n根据前面的分析，分子中的项是误差电流的绝对值：\n$$\n\\left|I_{i}-\\sum_{j=1}^{N}G_{ij}V_{j}\\right| = \\left| I_{i}^{\\mathrm{error}} \\right| = \\left|\\sum_{j=1}^{N} \\kappa_{ij}V_{j}^{3}\\right|\n$$\n问题指定在 $V_{j}=v$（对于所有 $j \\in \\{1,\\dots,N\\}$，其中 $v \\ge 0$）的条件下进行最坏情况分析。将此条件代入误差表达式：\n$$\n\\varepsilon_{i} = \\frac{\\left|\\sum_{j=1}^{N} \\kappa_{ij}v^{3}\\right|}{\\left|\\sum_{j=1}^{N}G_{ij}v\\right|}\n$$\n由于 $v \\ge 0$，我们可以将 $v^3$ 和 $v$ 从求和中提取出来：\n$$\n\\varepsilon_{i} = \\frac{\\left|v^{3} \\sum_{j=1}^{N} \\kappa_{ij}\\right|}{\\left|v \\sum_{j=1}^{N}G_{ij}\\right|}\n$$\n鉴于 $\\kappa_{ij} > 0$ 且物理电导 $G_{ij}$ 是非负的，和 $\\sum_{j=1}^{N} \\kappa_{ij}$ 与 $\\sum_{j=1}^{N} G_{ij}$ 也是非负的。在 $v \\ge 0$ 的情况下，我们可以去掉绝对值符号。我们假设一个非平凡的点积，意味着并非所有的 $G_{ij}$ 都为零，因此 $\\sum_{j=1}^{N}G_{ij} > 0$。对于 $v>0$，表达式简化为：\n$$\n\\varepsilon_{i} = \\frac{v^{3} \\sum_{j=1}^{N} \\kappa_{ij}}{v \\sum_{j=1}^{N}G_{ij}} = v^{2} \\frac{\\sum_{j=1}^{N} \\kappa_{ij}}{\\sum_{j=1}^{N}G_{ij}}\n$$\n我们要求这个误差受容差 $\\delta$ 的限制，即 $\\varepsilon_{i} \\le \\delta$。\n$$\nv^{2} \\frac{\\sum_{j=1}^{N} \\kappa_{ij}}{\\sum_{j=1}^{N}G_{ij}} \\le \\delta\n$$\n对这个不等式求解 $v^{2}$：\n$$\nv^{2} \\le \\delta \\frac{\\sum_{j=1}^{N}G_{ij}}{\\sum_{j=1}^{N} \\kappa_{ij}}\n$$\n由于 $v \\ge 0$，我们可以对两边取主平方根来求 $v$ 的上界：\n$$\nv \\le \\sqrt{\\delta \\frac{\\sum_{j=1}^{N}G_{ij}}{\\sum_{j=1}^{N} \\kappa_{ij}}}\n$$\n最大允许共同幅值 $v_{\\max}$ 是使该不等式饱和的值。\n$$\nv_{\\max} = \\sqrt{\\delta \\frac{\\sum_{j=1}^{N}G_{ij}}{\\sum_{j=1}^{N} \\kappa_{ij}}}\n$$\n此表达式提供了在指定的最坏情况下保证 $\\varepsilon_{i} \\le \\delta$ 的关于 $v$ 的显式符号上界。\n\n### 3. 小信号线性化条件\n\n如果一个系统或器件的非线性项的贡献与其线性项相比可以忽略不计，则可以认为它在线性区工作。这个观点可以同时应用于器件级和行级。\n\n**器件级条件：** 对于单个 RRAM 器件 $(i,j)$，当三次电流项的量值远小于线性（欧姆）电流项的量值时，其行为近似线性。\n$$\n\\left|\\kappa_{ij}V_{j}^{3}\\right| \\ll \\left|G_{ij}V_{j}\\right|\n$$\n对于非零电压 $V_j \\ne 0$ 并假设非零电导 $G_{ij} > 0$，我们可以将其简化为：\n$$\n\\kappa_{ij}|V_j|^2 \\ll G_{ij} \\quad \\implies \\quad |V_j|^2 \\ll \\frac{G_{ij}}{\\kappa_{ij}}\n$$\n这意味着，要使任何单个器件表现为线性，施加电压的量值必须远小于其线性电导与其非线性系数之比的平方根。\n\n**行级条件：** 对于第 $i$ 行的整个点积运算，如果总误差电流量值远小于总理想电流量值，则该计算近似是线性的。\n$$\n\\left|\\sum_{j=1}^{N} \\kappa_{ij}V_{j}^{3}\\right| \\ll \\left|\\sum_{j=1}^{N} G_{ij}V_{j}\\right|\n$$\n这正是相对误差 $\\varepsilon_i \\ll 1$ 的条件。根据第 2 部分的推导，在 $V_j = v \\ge 0$ 的条件下，这变成：\n$$\nv^{2} \\frac{\\sum_{j=1}^{N} \\kappa_{ij}}{\\sum_{j=1}^{N}G_{ij}} \\ll 1 \\quad \\implies \\quad v^{2} \\ll \\frac{\\sum_{j=1}^{N}G_{ij}}{\\sum_{j=1}^{N} \\kappa_{ij}}\n$$\n这给出了对共同输入幅值 $v$ 的一个线性化条件：它必须远小于总行电导与总行非线性系数之比的平方根。这个条件确保了整行的聚合非线性行为保持可忽略不计，从而保持了点积计算的完整性。",
            "answer": "$$\n\\boxed{\\sqrt{\\delta \\frac{\\sum_{j=1}^{N}G_{ij}}{\\sum_{j=1}^{N} \\kappa_{ij}}}}\n$$"
        },
        {
            "introduction": "除了器件的非理想特性，交叉阵列的物理互连结构本身也会引入误差。最后一个实践将运用基础的节点分析法，来建模导线电阻这一常见的寄生效应。通过建立并求解电路的线性方程组，你将亲眼看到互连电阻如何导致电压下降（即 $IR$ 压降效应），从而降低模拟计算的精度 。",
            "id": "4276914",
            "problem": "考虑一个用于内存计算的电阻性交叉阵列，该阵列具有$4$行和$4$列。每个交叉点是一个存储设备，其模型为第$i$行导线和第$j$列导线之间的线性电导$G_{i,j}$。列导线是电阻性的：它们被串联的相同电阻$R_{c}$分段，这些电阻位于连续的交叉点之间，以及最低的交叉点与读出放大器节点之间。读出放大器将每列的底端保持在$0\\,\\text{V}$，并测量流入地的稳态直流电流。行导线由具有可忽略线路电阻的理想电压源驱动。假设导线和器件在线性区域工作，并且所有元件都是时不变的。\n\n要求您使用基尔霍夫电流定律 (KCL) 和节点分析来构建线性系统，该系统将给定列上的$4$个输入行电压映射到其对应的列电流，并明确体现列线路电阻的影响。然后，当所有行都被相同地驱动时，求解读出放大器在指定列上看到的有效电导。\n\n对一个特定的$4 \\times 4$交叉阵列使用以下数据：\n- 列分段电阻：$R_{c} = 5\\,\\text{k}\\Omega$（每段都相同）。\n- 器件的电导（单位为西门子）为：\n  $$G = \\begin{pmatrix}\n  0.0006  0.0004  0.0005  0.0003 \\\\\n  0.0002  0.0007  0.0001  0.0006 \\\\\n  0.0009  0.0001  0.0008  0.0004 \\\\\n  0.0003  0.0005  0.0002  0.0002\n  \\end{pmatrix}.$$\n\n任务：\n1. 对于单列 $j$，将四个交叉点处的列导线电压定义为节点未知数，$\\mathbf{v}^{(j)} = \\big(v^{(j)}_{1}, v^{(j)}_{2}, v^{(j)}_{3}, v^{(j)}_{4}\\big)^{\\top}$，其中 $v^{(j)}_{4}$ 是最低交叉点处的电压（该点通过最后一个 $R_{c}$ 电阻段连接到读出放大器的 $0\\,\\text{V}$ 节点）。从基尔霍夫电流定律和电导定义 $G = 1/R$ 出发，写出将 $\\mathbf{v}^{(j)}$ 与列 $j$ 上的 $4$ 个行输入电压 $\\mathbf{V} = \\big(V_{1}, V_{2}, V_{3}, V_{4}\\big)^{\\top}$ 相关联的 $4 \\times 4$ 线性系统，并明确显示由列串联电阻引入的三对角结构。\n2. 专门针对列 $j=3$，并假设所有行都由相同的标量输入 $V_{\\text{in}}$ 驱动，因此 $V_{1} = V_{2} = V_{3} = V_{4} = V_{\\text{in}}$。使用所提供的数值，求解该线性系统，并计算读出放大器看到的有效电导，其定义为\n   $$G_{\\text{eff}} \\triangleq \\frac{I_{\\text{col}}}{V_{\\text{in}}},$$\n   其中 $I_{\\text{col}}$ 是在指定列的读出放大器节点处流入地的稳态电流。以西门子 (S) 为单位表示最终答案。将答案四舍五入到四位有效数字。",
            "solution": "该问题被认为是有效的，因为它在科学上基于电路理论，问题定义清晰，并提供了一套完整且一致的数据和目标。给定的数值对于纳米级器件阵列是物理上合理的。\n\n按要求，分析分两部分进行。\n\n**第1部分：线性系统的推导**\n\n我们分析 $4 \\times 4$ 交叉阵列的通用列 $j$。该列由一根带有四个节点的导线组成，从上到下标记为 $n_1, n_2, n_3, n_4$，分别对应与行 $1, 2, 3, 4$ 的交叉点。这些节点上的电压是未知数，用向量 $\\mathbf{v}^{(j)} = (v^{(j)}_{1}, v^{(j)}_{2}, v^{(j)}_{3}, v^{(j)}_{4})^{\\top}$ 表示。各行由理想电压源驱动，提供电压 $\\mathbf{V} = (V_{1}, V_{2}, V_{3}, V_{4})^{\\top}$。\n\n列导线被建模为电阻段，每段的电阻为 $R_c$。每个相邻节点对 $(n_i, n_{i+1})$ 之间都有一个电阻 $R_c$，最后一个节点 $n_4$ 与保持在 $0\\,\\text{V}$ 接地电位的读出放大器之间也有一个电阻 $R_c$。令 $G_c = 1/R_c$ 为列导线段的电导。\n\n我们在四个节点中的每一个节点上应用基尔霍夫电流定律 (KCL)。KCL 指出，流入一个节点的电流总和必须为零。\n\n**节点 $n_1$ (电压 $v^{(j)}_1$):**\n流入节点 $n_1$ 的电流有：\n- 从行 $1$ 电压源 $V_1$ 通过交叉点电导 $G_{1,j}$ 的电流：$I_{1} = (V_{1} - v^{(j)}_{1}) G_{1,j}$。\n- 从节点 $n_2$ 通过列段电阻 $R_c$ 的电流：$I_{2 \\to 1} = (v^{(j)}_{2} - v^{(j)}_{1}) / R_c = (v^{(j)}_{2} - v^{(j)}_{1}) G_c$。\n节点 $n_1$ 上方没有列段。\n在 $n_1$ 处的 KCL：$(V_{1} - v^{(j)}_{1}) G_{1,j} + (v^{(j)}_{2} - v^{(j)}_{1}) G_c = 0$。\n整理得：$(G_{1,j} + G_c) v^{(j)}_{1} - G_c v^{(j)}_{2} = G_{1,j} V_{1}$。\n\n**节点 $n_2$ (电压 $v^{(j)}_2$):**\n流入节点 $n_2$ 的电流有：\n- 从行 $2$ 电压源 $V_2$ 通过 $G_{2,j}$ 的电流：$I_{2} = (V_{2} - v^{(j)}_{2}) G_{2,j}$。\n- 从节点 $n_1$ 通过 $R_c$ 的电流：$I_{1 \\to 2} = (v^{(j)}_{1} - v^{(j)}_{2}) G_c$。\n- 从节点 $n_3$ 通过 $R_c$ 的电流：$I_{3 \\to 2} = (v^{(j)}_{3} - v^{(j)}_{2}) G_c$。\n在 $n_2$ 处的 KCL：$(V_{2} - v^{(j)}_{2}) G_{2,j} + (v^{(j)}_{1} - v^{(j)}_{2}) G_c + (v^{(j)}_{3} - v^{(j)}_{2}) G_c = 0$。\n整理得：$-G_c v^{(j)}_{1} + (G_{2,j} + 2G_c) v^{(j)}_{2} - G_c v^{(j)}_{3} = G_{2,j} V_{2}$。\n\n**节点 $n_3$ (电压 $v^{(j)}_3$):**\n流入节点 $n_3$ 的电流有：\n- 从行 $3$ 电压源 $V_3$ 通过 $G_{3,j}$ 的电流：$I_{3} = (V_{3} - v^{(j)}_{3}) G_{3,j}$。\n- 从节点 $n_2$ 通过 $R_c$ 的电流：$I_{2 \\to 3} = (v^{(j)}_{2} - v^{(j)}_{3}) G_c$。\n- 从节点 $n_4$ 通过 $R_c$ 的电流：$I_{4 \\to 3} = (v^{(j)}_{4} - v^{(j)}_{3}) G_c$。\n在 $n_3$ 处的 KCL：$(V_{3} - v^{(j)}_{3}) G_{3,j} + (v^{(j)}_{2} - v^{(j)}_{3}) G_c + (v^{(j)}_{4} - v^{(j)}_{3}) G_c = 0$。\n整理得：$-G_c v^{(j)}_{2} + (G_{3,j} + 2G_c) v^{(j)}_{3} - G_c v^{(j)}_{4} = G_{3,j} V_{3}$。\n\n**节点 $n_4$ (电压 $v^{(j)}_4$):**\n流入节点 $n_4$ 的电流有：\n- 从行 $4$ 电压源 $V_4$ 通过 $G_{4,j}$ 的电流：$I_{4} = (V_{4} - v^{(j)}_{4}) G_{4,j}$。\n- 从节点 $n_3$ 通过 $R_c$ 的电流：$I_{3 \\to 4} = (v^{(j)}_{3} - v^{(j)}_{4}) G_c$。\n- 从读出放大器地 ($0\\,\\text{V}$) 通过 $R_c$ 的电流：$I_{\\text{gnd} \\to 4} = (0 - v^{(j)}_{4}) G_c$。\n在 $n_4$ 处的 KCL：$(V_{4} - v^{(j)}_{4}) G_{4,j} + (v^{(j)}_{3} - v^{(j)}_{4}) G_c - v^{(j)}_{4} G_c = 0$。\n整理得：$-G_c v^{(j)}_{3} + (G_{4,j} + 2G_c) v^{(j)}_{4} = G_{4,j} V_{4}$。\n\n这四个线性方程可以表示为矩阵形式 $\\mathbf{Y}^{(j)} \\mathbf{v}^{(j)} = \\mathbf{b}^{(j)}$，其中 $\\mathbf{Y}^{(j)}$ 是列节点的节点导纳矩阵，$\\mathbf{b}^{(j)}$ 是电流源向量。\n\n该系统为：\n$$\n\\begin{pmatrix}\nG_{1,j} + G_c  -G_c  0  0 \\\\\n-G_c  G_{2,j} + 2G_c  -G_c  0 \\\\\n0  -G_c  G_{3,j} + 2G_c  -G_c \\\\\n0  0  -G_c  G_{4,j} + 2G_c\n\\end{pmatrix}\n\\begin{pmatrix}\nv^{(j)}_{1} \\\\\nv^{(j)}_{2} \\\\\nv^{(j)}_{3} \\\\\nv^{(j)}_{4}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nG_{1,j} V_{1} \\\\\nG_{2,j} V_{2} \\\\\nG_{3,j} V_{3} \\\\\nG_{4,j} V_{4}\n\\end{pmatrix}\n$$\n左侧的矩阵 $\\mathbf{Y}^{(j)}$ 是一个对称三对角矩阵，明确地体现了列串联电阻的影响。非零的非对角元素耦合了相邻节点，这是线路电阻的直接结果。\n\n**第2部分：有效电导的计算**\n\n我们现在专门研究列 $j=3$ 的情况，所有行电压都等于 $V_{\\text{in}}$，即 $V_1=V_2=V_3=V_4=V_{\\text{in}}$。\n\n给定的数值如下：\n- 列段电阻：$R_c = 5\\,\\text{k}\\Omega = 5000\\,\\Omega$。相应的电导是 $G_c = 1/R_c = 1/5000\\,\\text{S} = 0.0002\\,\\text{S}$。\n- 列 $j=3$ 的交叉点电导为：\n  $G_{1,3} = 0.0005\\,\\text{S}$\n  $G_{2,3} = 0.0001\\,\\text{S}$\n  $G_{3,3} = 0.0008\\,\\text{S}$\n  $G_{4,3} = 0.0002\\,\\text{S}$\n\n我们构建数值方程组。矩阵 $\\mathbf{Y}^{(3)}$ 的元素为：\n$Y_{11} = G_{1,3} + G_c = 0.0005 + 0.0002 = 0.0007\\,\\text{S}$\n$Y_{22} = G_{2,3} + 2G_c = 0.0001 + 2(0.0002) = 0.0005\\,\\text{S}$\n$Y_{33} = G_{3,3} + 2G_c = 0.0008 + 2(0.0002) = 0.0012\\,\\text{S}$\n$Y_{44} = G_{4,3} + 2G_c = 0.0002 + 2(0.0002) = 0.0006\\,\\text{S}$\n非对角元素为 $-G_c = -0.0002\\,\\text{S}$。\n\n线性系统变为：\n$$\n\\begin{pmatrix}\n0.0007  -0.0002  0  0 \\\\\n-0.0002  0.0005  -0.0002  0 \\\\\n0  -0.0002  0.0012  -0.0002 \\\\\n0  0  -0.0002  0.0006\n\\end{pmatrix}\n\\begin{pmatrix}\nv^{(3)}_{1} \\\\\nv^{(3)}_{2} \\\\\nv^{(3)}_{3} \\\\\nv^{(3)}_{4}\n\\end{pmatrix}\n=\nV_{\\text{in}}\n\\begin{pmatrix}\n0.0005 \\\\\n0.0001 \\\\\n0.0008 \\\\\n0.0002\n\\end{pmatrix}\n$$\n读出放大器看到的有效电导是 $G_{\\text{eff}} \\triangleq I_{\\text{col}} / V_{\\text{in}}$。列电流 $I_{\\text{col}}$ 是从最后一个节点 $n_4$ 流向地的电流，由 $I_{\\text{col}} = (v^{(3)}_{4} - 0) / R_c = v^{(3)}_{4} G_c$ 给出。\n因此，$G_{\\text{eff}} = (v^{(3)}_{4} / V_{\\text{in}}) G_c$。\n令 $\\tilde{v}_i = v^{(3)}_i / V_{\\text{in}}$ 为归一化节点电压。我们可以求解向量 $\\tilde{\\mathbf{v}} = (\\tilde{v}_1, \\tilde{v}_2, \\tilde{v}_3, \\tilde{v}_4)^{\\top}$：\n$$\n\\begin{pmatrix}\n0.0007  -0.0002  0  0 \\\\\n-0.0002  0.0005  -0.0002  0 \\\\\n0  -0.0002  0.0012  -0.0002 \\\\\n0  0  -0.0002  0.0006\n\\end{pmatrix}\n\\begin{pmatrix}\n\\tilde{v}_{1} \\\\\n\\tilde{v}_{2} \\\\\n\\tilde{v}_{3} \\\\\n\\tilde{v}_{4}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.0005 \\\\\n0.0001 \\\\\n0.0008 \\\\\n0.0002\n\\end{pmatrix}\n$$\n为简化计算，我们可以将整个方程乘以 $10000$：\n$$\n\\begin{pmatrix}\n7  -2  0  0 \\\\\n-2  5  -2  0 \\\\\n0  -2  12  -2 \\\\\n0  0  -2  6\n\\end{pmatrix}\n\\begin{pmatrix}\n\\tilde{v}_{1} \\\\\n\\tilde{v}_{2} \\\\\n\\tilde{v}_{3} \\\\\n\\tilde{v}_{4}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n5 \\\\\n1 \\\\\n8 \\\\\n2\n\\end{pmatrix}\n$$\n求解这个线性方程组（例如，使用高斯消元法或矩阵求逆），我们得到最后一个分量 $\\tilde{v}_{4}$ 的值：\n$\\tilde{v}_{4} = \\frac{313}{485}$。\n\n现在我们可以计算有效电导：\n$G_{\\text{eff}} = \\tilde{v}_{4} G_c = \\frac{313}{485} \\times 0.0002\\,\\text{S}$。\n$G_{\\text{eff}} \\approx 0.6453608247... \\times 0.0002\\,\\text{S} \\approx 0.00012907216...\\,\\text{S}$。\n\n将结果四舍五入到四位有效数字，我们得到：\n$G_{\\text{eff}} \\approx 0.0001291\\,\\text{S}$。\n这个值远低于理想电导（当 $R_c=0$ 时），理想电导将是交叉点电导的简单总和：$G_{\\text{ideal}} = \\sum_{i=1}^4 G_{i,3} = 0.0016\\,\\text{S}$。较大的线路电阻 $R_c$ 导致沿列的显著电压降，提高了节点电压 $v_i^{(3)}$，从而减少了从行中汲取的电流。",
            "answer": "$$\n\\boxed{0.0001291}\n$$"
        }
    ]
}