{
    "hands_on_practices": [
        {
            "introduction": "本练习通过探索由 $k_1$ 因子推广的瑞利判据，深入探讨了光刻技术的极限。通过计算可实现的最小特征尺寸，您将对为何分辨率增强技术（RET）不仅是可选项，而且是制造现代集成电路的必需品，获得切实的理解。这项练习将基础光学理论与当今半导体工厂面临的实际挑战联系起来 ()。",
            "id": "4286963",
            "problem": "在波长为$\\lambda$、物镜数值孔径为$\\mathrm{NA}$的条件下，浸没式光刻通常在阿贝–瑞利成像框架下使用标量傅里叶光学进行分析。考虑一个周期性的线-空间光栅，其最小可印刷半节距由投影系统能传输的最高空间频率决定，而照明相干性、掩模设计、光刻胶及工艺流程的影响则由一个工艺因子$k_1$概括，该因子对理论极限进行线性缩放。从阿贝衍射极限和周期性线-空间对象的空间频率定义出发，请从第一性原理推导最小可分辨半节距的表达式，用$\\lambda$、$\\mathrm{NA}$和$k_1$表示。然后，对$\\lambda=193\\,\\mathrm{nm}$、$\\mathrm{NA}=1.35$和$k_1=0.28$的情况，计算这个最小半节距。最后，简要推断在此$k_1$下操作对光源-掩模协同优化（SMO）、基于模型的光学邻近效应矫正（OPC）、亚分辨率辅助图形（SRAF）和相移掩模（PSM）等光源和掩模优化策略的影响，重点关注常规的轴上照明是否足够，以及是否需要激进的光源整形和反演掩模合成。最终的数值半节距以纳米为单位表示，并将您的答案四舍五入至四位有效数字。",
            "solution": "该问题要求分三部分作答：首先，推导光刻中最小可分辨半节距的表达式；其次，对给定参数进行数值计算；第三，推断其对分辨率增强技术（RET）的影响。\n\n### 第1部分：最小可分辨半节距的推导\n\n投影光学系统中的成像原理由傅里叶光学描述。如果光学系统能够捕获并干涉掩模上对象的至少两个衍射级，那么该对象就能在晶圆上被分辨。\n\n掩模上的周期性线-空间光栅，其重复周期为$P$，可以用傅里叶级数表示。周期$P$是半节距$HP$的两倍，即$P = 2 \\cdot HP$。这样的对象会将入射的照明波衍射成一系列离散的衍射级（衍射图样），这些衍射级位于物镜的傅里叶平面中。光栅基频分量的空间频率为$f_{\\text{obj}} = 1/P = 1/(2 \\cdot HP)$。衍射级位于该基频的整数倍处，即$m \\cdot f_{\\text{obj}}$，其中$m = 0, \\pm 1, \\pm 2, \\dots$。\n\n投影系统的物镜充当一个低通空间滤波器。它有一个有限的入射光瞳，只能收集特定最大角度内的衍射光。这个角度接收范围由数值孔径$\\mathrm{NA}$定义。在空间频率域中，光瞳允许所有频率$f$通过，只要其大小小于或等于一个截止频率$f_{\\text{cutoff}}$。该截止频率由$f_{\\text{cutoff}} = \\mathrm{NA}/\\lambda$给出，其中$\\lambda$是光的波长。\n\n根据阿贝成像理论，要重建光栅的周期性图案，物镜光瞳必须至少收集到两个衍射级。能够形成光栅图像的最简单情况是0级衍射光与其中一个1级衍射光（$m = +1$或$m = -1$）之间的干涉。\n\n我们来分析极限条件。当系统配置为捕获可能最高的空间频率时，可以分辨出最小的节距（以及半节距）。这可以通过离轴照明（OAI）实现，即照明光不垂直于掩模，而是以一定角度入射。为了产生最精细的图案，两束光束必须在晶圆平面上以可能的最大角度干涉。这对应于捕获源自单个离轴照明光源、并穿过物镜光瞳相对边缘的两个衍射级。\n\n考虑傅里叶平面中位于空间频率$f_{\\text{illum}}$处的单个照明光源点。来自光栅的衍射级被平移，出现在空间频率$f_m = f_{\\text{illum}} + m \\cdot f_{\\text{obj}}$处。为了达到极限分辨率，我们可以将照明光源放置在光瞳的边缘，例如，在$f_{\\text{illum}} = -\\mathrm{NA}/\\lambda$处。此时，0级衍射光在光瞳的一个边缘被收集（$f_0 = -\\mathrm{NA}/\\lambda$）。为了形成图像，+1级衍射光也必须被收集。其空间频率为$f_{+1} = f_{\\text{illum}} + f_{\\text{obj}} = -\\mathrm{NA}/\\lambda + 1/P$。要使这一级被捕获，它必须位于光瞳内部，即$f_{+1} \\le +\\mathrm{NA}/\\lambda$。\n$$\n-\\frac{\\mathrm{NA}}{\\lambda} + \\frac{1}{P} \\le \\frac{\\mathrm{NA}}{\\lambda}\n$$\n这个不等式得出了可以形成的最大空间频率：\n$$\n\\frac{1}{P} \\le \\frac{2 \\cdot \\mathrm{NA}}{\\lambda}\n$$\n因此，最小可能周期$P_{\\text{min}}$为：\n$$\nP_{\\text{min}} = \\frac{\\lambda}{2 \\cdot \\mathrm{NA}}\n$$\n最小半节距是最小周期的一半，$HP_{\\text{min}} = P_{\\text{min}}/2$。这给出了半节距的绝对物理极限：\n$$\nHP_{\\text{min, theory}} = \\frac{\\lambda}{4 \\cdot \\mathrm{NA}}\n$$\n此推导建立了基本的缩放关系：最小可分辨特征尺寸与波长$\\lambda$成正比，与数值孔径$\\mathrm{NA}$成反比。\n\n在实践中，由于多种因素，如光源的部分相干性、掩模制造缺陷、光刻胶化学和工艺限制，以及对非零工艺窗口（焦深和曝光容差）的需求，达到这一理论极限是不可能的。题目引入了一个综合工艺因子$k_1$来解释所有这些影响。该因子对理论关系进行缩放，从而得到广泛使用的最小半节距经验公式：\n$$\nHP_{\\text{min}} = k_1 \\frac{\\lambda}{\\mathrm{NA}}\n$$\n这个方程是光刻领域的标准表达式。因子$k_1$是整个光刻工艺的品质因数；较小的$k_1$表示更先进和更激进的工艺。$HP_{\\text{min}} = \\lambda/(4\\mathrm{NA})$的理论极限对应于$k_1$的理论最小值为0.25。\n\n### 第2部分：数值计算\n\n给定数值：\n- 波长 $\\lambda = 193 \\ \\mathrm{nm}$\n- 数值孔径 $\\mathrm{NA} = 1.35$\n- 工艺因子 $k_1 = 0.28$\n\n我们将这些值代入推导出的最小半节距表达式中：\n$$\nHP_{\\text{min}} = k_1 \\frac{\\lambda}{\\mathrm{NA}} = 0.28 \\times \\frac{193 \\ \\mathrm{nm}}{1.35}\n$$\n$$\nHP_{\\text{min}} = \\frac{54.04 \\ \\mathrm{nm}}{1.35} \\approx 40.0296... \\ \\mathrm{nm}\n$$\n按要求将结果四舍五入至四位有效数字：\n$$\nHP_{\\text{min}} \\approx 40.03 \\ \\mathrm{nm}\n$$\n\n### 第3部分：对分辨率增强技术（RET）的影响\n\n$k_1 = 0.28$的工艺因子是极其激进的，因为它非常接近$k_1 = 0.25$的绝对理论极限。在这样的“低$k_1$”区间操作，对光刻策略具有深远的影响。\n\n首先，常规的轴上照明是完全不足的。轴上相干照明的理论极限对应于$k_1 = 0.5$。$k_1$值为0.28远低于此，表明简单的照明方案无法分辨此半节距的图案。\n\n因此，激进的RET不仅是有益的，而且是绝对强制性的。\n- **光源整形和离轴照明（OAI）**：为了将$k_1$推至0.5以下，OAI至关重要。然而，对于$k_1=0.28$，简单的OAI形状（如环形或四极）是不够的。需要高度定制的、复杂的、且针对特定图案的照明光源形状，通常称为自由形状光源。\n- **光源-掩模协同优化（SMO）**：光源和掩模图案不能再独立设计。必须采用计算光刻技术SMO，来同时协同优化光源形状和掩模图案，从而为特定的器件版图最大化工艺窗口。\n- **反演光刻技术（ILT）和高级OPC**：由于严重的光学邻近效应，掩模图案与晶圆上的最终目标图案几乎没有相似之处。基于规则的或简单的基于模型的的光学邻近效应矫正（OPC）是不够的。需要ILT。这种技术将掩模视为像素画布，并通过计算反演光刻工艺模型来找到能够印刷出所需晶圆图案的最佳掩模。这是最先进的基于模型的OPC形式。\n- **亚分辨率辅助图形（SRAF）**：密集且精心放置的SRAF至关重要。这些掩模上的非印刷图形对于使孤立或半密集图形表现得更像密集周期性图形至关重要，从而改善其工艺窗口。SRAF的放置是一个复杂的优化问题，通常作为ILT/SMO流程的一部分来解决。\n- **相移掩模（PSM）**：为了实现如此低的$k_1$值，强相移技术是必需的。通常需要交替相移掩模（Alternating PSM），它在相邻图形之间引入$180^\\circ$（$\\pi$）的相移以产生相消干涉并增强图像对比度。强OAI（如偶极照明）与强PSM的结合是达到低于$0.3$的$k_1$值的基本促成因素。\n\n总而言之，$k_1$值为0.28意味着光刻工艺被推向了其物理极限。这要求采用一种整体方法，即使用像SMO和ILT这样复杂的计算技术来协同优化光源、掩模图案和工艺条件，并依赖于像高级PSM这样的全套硬件RET。",
            "answer": "$$\n\\boxed{40.03}\n$$"
        },
        {
            "introduction": "在理解了分辨率增强技术（RET）的必要性之后，本练习将聚焦于其中最强大的技术之一：交替相移掩模（ALT PSM）。您将从第一性原理出发，推导如何通过调控光的相位来消除不需要的衍射级，从而显著提高图像对比度。这项练习提供了一个深刻的、基于物理学的视角，让您了解工程师如何利用巧妙的波动光学设计，实现亚波长尺寸特征的印刷 ()。",
            "id": "4287131",
            "problem": "在标量相干成像条件下，使用交替相移掩模 (ALT PSM) 对一维周期性线空间光栅进行成像。晶圆上的标称光栅周期为 $p$，在使用常规二元掩模时，占空比为 $0.5$（即线宽等于空间宽度）。在 ALT PSM 实现方案中，每隔一个空间被一个相移衰减的开口所取代，其复透射振幅为 $\\alpha \\exp(i \\phi)$，其中 $0  \\alpha  1$ 是一个实数衰减因子，$\\phi$ 是相对于未相移的透明空间的相移。考虑一个跨越两个周期的单元，它包含两条等宽的线和两个空间：一个宽度为 $w_{n}$ 的未相移空间和一个宽度为 $w_{s}$ 的相移空间。\n\n从标量衍射中的波叠加原理和周期性掩模透过率的傅里叶级数表示出发，推导出在空中成像的线边界处产生相长边缘对比度时 $\\phi$ 应满足的相位条件。对于本问题，将相长边缘对比度解释为通过抑制平均（零级）掩模光谱，同时保持强的一级分量，从而实现边缘斜率的最大化。利用此条件，确定 $w_{s}$ 和 $w_{n}$ 之间为实现最佳对比度所需满足的关系，该关系应以 $\\alpha$ 和 $\\phi$ 表示。\n\n然后，对于给定的晶圆周期 $p = 120\\,\\text{nm}$ 和衰减因子 $\\alpha = 0.3$，并满足一个双周期单元内的总空间宽度等于原始占空比为0.5的光栅中相应空间宽度的约束条件，计算晶圆上最佳的相移空间宽度 $w_{s}$。最终数值以纳米为单位表示，并将答案四舍五入到四位有效数字。最终答案必须是一个实数值。",
            "solution": "该问题要求我们分析用于周期性光栅的交替相移掩模 (ALT PSM)。ALT PSM 的核心原理是在掩模的交替开口中引入一个相位移 $\\phi$（理想情况下为 $\\pi$）。这会导致零级衍射光发生相消干涉，从而有效去除空中成像的直流分量，进而提高图像对比度。我们使用掩模透射函数的傅里叶级数分析来对此建模。\n\nALT PSM 的单元周期为 $T = 2p$。我们可以定义一个周期内的复掩模透过率函数 $t(x)$。为方便起见，我们设置原点。一个功能布局是 `| 线 | 未相移空间 | 线 | 相移空间 |`。它们的宽度分别为 $p/2$、$w_n$、$p/2$ 和 $w_s$。总周期为 $p/2 + w_n + p/2 + w_s = p + w_n + w_s$。问题指出单元跨越两个周期，因此 $T=2p$。关于总空间宽度的约束是，ALT PSM 中的 $w_n+w_s$ 等于原始二元掩模在两个周期内的总空间宽度。原始掩模每个周期 $p$ 的空间宽度为 $p/2$，因此在两个周期（$2p$）内，总空间宽度为 $2 \\times (p/2) = p$。因此，我们有约束条件 $w_n + w_s = p$。这也意味着总周期为 $p + (w_n+w_s) = p+p=2p$，这是自洽的。\n\n让我们在一个周期 $[0, 2p]$ 内定义透过率函数 $t(x)$：\n-   未相移空间：$t(x) = 1$，对于 $x \\in [0, w_n]$\n-   第一条线：$t(x) = 0$，对于 $x \\in (w_n, w_n + p/2]$\n-   相移空间：$t(x) = \\alpha \\exp(i\\phi)$，对于 $x \\in (w_n + p/2, w_n + p/2 + w_s]$\n-   第二条线：$t(x) = 0$，对于 $x \\in (w_n + p/2 + w_s, 2p]$\n\n周期函数 $t(x)$ 可以用傅里叶级数表示：\n$$t(x) = \\sum_{k=-\\infty}^{\\infty} c_k \\exp\\left(i \\frac{2\\pi k x}{T}\\right) = \\sum_{k=-\\infty}^{\\infty} c_k \\exp\\left(i \\frac{\\pi k x}{p}\\right)$$\n其中傅里叶系数 $c_k$ 由下式给出：\n$$c_k = \\frac{1}{T} \\int_0^T t(x) \\exp\\left(-i \\frac{2\\pi k x}{T}\\right) dx = \\frac{1}{2p} \\int_0^{2p} t(x) \\exp\\left(-i \\frac{\\pi k x}{p}\\right) dx$$\n\n问题指出，最佳对比度是通过抑制平均（零级）掩模光谱来实现的。这对应于 $k=0$ 的傅里叶系数 $c_0$。我们必须将 $c_0$ 设置为零。\n$$c_0 = \\frac{1}{2p} \\int_0^{2p} t(x) dx$$\n该积分是复透过率函数在一个周期内的面积。\n$$c_0 = \\frac{1}{2p} \\left[ \\int_0^{w_n} 1 \\, dx + \\int_{w_n+p/2}^{w_n+p/2+w_s} \\alpha \\exp(i\\phi) \\, dx \\right]$$\n$$c_0 = \\frac{1}{2p} \\left[ (w_n - 0) \\cdot 1 + ((w_n + p/2 + w_s) - (w_n + p/2)) \\cdot \\alpha \\exp(i\\phi) \\right]$$\n$$c_0 = \\frac{1}{2p} \\left[ w_n + w_s \\alpha \\exp(i\\phi) \\right]$$\n\n为抑制零级项，我们设置 $c_0 = 0$：\n$$w_n + w_s \\alpha \\exp(i\\phi) = 0$$\n将 $\\exp(i\\phi)$ 表示为 $\\cos(\\phi) + i\\sin(\\phi)$：\n$$w_n + w_s \\alpha \\cos(\\phi) + i(w_s \\alpha \\sin(\\phi)) = 0$$\n要使一个复数为零，其实部和虚部都必须为零。\n$$\n\\begin{cases}\nw_s \\alpha \\sin(\\phi) = 0  \\text{(虚部)} \\\\\nw_n + w_s \\alpha \\cos(\\phi) = 0  \\text{(实部)}\n\\end{cases}\n$$\n从虚部来看，由于 $w_s > 0$ 和 $\\alpha > 0$，我们必须有 $\\sin(\\phi) = 0$。这意味着对于某个整数 $m$，$\\phi = m\\pi$。\n\n我们现在使用 $\\phi$ 的可能值来分析实部。\n-   如果 $\\phi = 2m\\pi$，则 $\\cos(\\phi) = 1$。方程变为 $w_n + w_s \\alpha = 0$。由于 $w_n$、$w_s$ 和 $\\alpha$ 都是正实数，它们的和不可能为零。所以这种情况在物理上是不可能的。\n-   如果 $\\phi = (2m+1)\\pi$，则 $\\cos(\\phi) = -1$。方程变为 $w_n - w_s \\alpha = 0$。\n\n这导出了两个关键结果：\n1.  **相位条件**：相移必须是 $\\pi$ 的奇数倍。基本的选择是 $\\phi = \\pi$（一个 $180^\\circ$ 的相移）。这是抑制零级光的 $\\phi$ 的条件。\n2.  **宽度关系**：实现这种抑制的空间宽度之间的关系是 $w_n = \\alpha w_s$。这是强度平衡条件：来自未相移区域的总透射振幅（面积 $w_n \\times 1$）必须抵消来自相移区域的总透射振幅（面积 $w_s \\times \\alpha \\exp(i\\pi) = -w_s \\alpha$）。\n\n现在，我们求解 $w_s$ 的具体值。我们有一个包含两个未知数 $w_n$ 和 $w_s$ 的二元线性方程组：\n1.  $w_n = \\alpha w_s$（来自 $c_0=0$ 条件）\n2.  $w_n + w_s = p$（来自问题的几何约束）\n\n将第一个方程代入第二个方程：\n$$\\alpha w_s + w_s = p$$\n$$w_s(1 + \\alpha) = p$$\n$$w_s = \\frac{p}{1+\\alpha}$$\n这是最佳相移空间宽度 $w_s$ 的通用表达式。\n\n最后，我们代入给定的数值：$p = 120\\,\\text{nm}$ 和 $\\alpha = 0.3$。\n$$w_s = \\frac{120}{1 + 0.3} = \\frac{120}{1.3}$$\n$$w_s \\approx 92.3076923... \\,\\text{nm}$$\n问题要求答案四舍五入到四位有效数字。\n$$w_s \\approx 92.31\\,\\text{nm}$$\n\n对应的未相移空间宽度将是 $w_n = p - w_s = 120 - 92.30769... = 27.692307... \\,\\text{nm}$。我们可以检验 $w_n = \\alpha w_s$ 是否满足：$0.3 \\times 92.30769... = 27.692307...$，这证实了计算的正确性。最终答案是 $w_s$ 的值。",
            "answer": "$$\\boxed{92.31}$$"
        },
        {
            "introduction": "最后的这项练习将从解析理论过渡到现代电子设计自动化（EDA）在制造领域中的计算核心。您将构建一个仿真程序来执行光源-掩模协同优化（SMO），这是一项关键的计算光刻技术。通过同时优化光源和辅助图形，您将亲身体验算法如何为复杂的光学问题找到实际解决方案，从而最大化工艺窗口并确保可制造性 ()。",
            "id": "4286958",
            "problem": "您的任务是构建一个计算实验，从第一性原理出发，推导出一个最优的照明光源配置和亚分辨率辅助图形排布，该方案能在避免辅助图形显影的同时，最大化接触孔显影后边缘的陡度。该任务的背景是集成电路和电子设计自动化 (EDA) 中的光学邻近效应校正 (OPC) 和分辨率增强技术 (RET)，并使用标量傅里叶光学成像模型。您必须生成一个完整的、可运行的程序，以实现以下模型和优化目标。\n\n请使用以下基于物理的建模假设，所有量纲均采用无量纲归一化单位，以避免对特定波长或数值孔径值的依赖：\n- 令 $x$ 表示像平面空间坐标。距离和空间频率均为无量纲，并经过归一化，使得光瞳截止频率为 $k_c = 1$。\n- 令 $m(x)$ 为穿过一个接触孔中心和两个对称亚分辨率辅助狭缝的一维横截面的实数、非负掩模振幅透射率。具体定义如下：\n  1. 宽度为 `W` 的主接触孔开口：当 $|x| \\leq W/2$ 时，$m(x) = 1$；在其他位置（如果没有辅助图形），$m(x) = 0$。\n  2. 两个宽度为 `w` 的对称辅助图形，中心位于 $x = \\pm (W/2 + d)$，其透射率在 $|(x - (W/2 + d))| \\leq w/2$ 和 $|(x + (W/2 + d))| \\leq w/2$ 区域内为 $m(x) = 1$，在已定义开口之外的其他位置为 $m(x) = 0$。\n- 令相干光瞳振幅 $P(k)$ 在 $|k| \\leq k_c$ 时等于 $1$，在其他位置等于 $0$。使用针对离散离轴光源点的阿贝成像 (Abbe imaging) 理论，定义一个双光束偶极子光源，其包含相对于光轴具有空间频率偏移 $\\pm s$ 的等权重平面波，其中 $s \\in [0,1]$ 为无量纲。对于给定的光源偏移 `s`，由该光源产生的像平面复场为\n  $$E_s(x) = \\mathcal{F}^{-1}\\left\\{ M(k)\\, P(k - s) \\right\\},$$\n  其中 $M(k) = \\mathcal{F}\\{m(x)\\}$, $\\mathcal{F}$ 表示傅里叶变换，$\\mathcal{F}^{-1}$ 表示其逆变换。在该双光束部分相干光源下的空中像强度为\n  $$I(x) = \\frac{1}{2}\\, \\left|E_{+s}(x)\\right|^2 + \\frac{1}{2}\\, \\left|E_{-s}(x)\\right|^2.$$\n- 假设采用正性光刻胶阈值模型：当 $I(x) \\geq T$ 时发生显影，其中 `T` $\\in (0,1)$ 是一个无量纲阈值。\n\n目标函数和约束定义如下：\n- 边缘陡度度量：令 $x_L$ 和 $x_R$ 分别表示最接近 $-W/2$ 和 $+W/2$ 的左右阈值交叉位置。将这些交叉点处的边缘陡度定义为强度空间导数的绝对值，\n  $$S_L = \\left|\\frac{d I}{d x}\\Big|_{x = x_L}\\right|,\\quad S_R = \\left|\\frac{d I}{d x}\\Big|_{x = x_R}\\right|.$$\n  优化目标是最大化\n  $$\\Phi = \\min\\left(S_L, S_R\\right).$$\n- 辅助图形不显影约束：令 $x_{a,L} = -\\left(W/2 + d\\right)$ 和 $x_{a,R} = +\\left(W/2 + d\\right)$ 为辅助图形的中心。强制要求\n  $$I(x_{a,L})  T \\quad \\text{and} \\quad I(x_{a,R})  T.$$\n\n您的程序必须：\n1. 对上述标量傅里叶光学模型使用离散数值近似。在长度为 `L` 的空间窗口上，使用 `N` 个样本的均匀网格来表示 $m(x)$。使用离散傅里叶变换计算 $M(k)$。对于每个光源偏移 `s`，利用已知的光瞳截止频率 $k_c = 1$，直接在离散频率网格上实现 $P(k - s)$，然后通过傅里叶逆变换计算 $E_s(x)$。将来自两个对称光源的强度相加得到 $I(x)$。使用一致的离散空间导数计算 $\\frac{dI}{dx}$。\n2. 在提供的离散参数网格 $\\{s\\} \\times \\{d\\} \\times \\{w\\}$ (所有参数均为指定的无量纲单位) 上进行搜索，以找出在满足辅助图形不显影约束的条件下能最大化 $\\Phi$ 的配置。在确定 $x_L$ 和 $x_R$ 时，选择局部邻域内最接近 $\\pm W/2$ 附近阈值交叉点的网格点；使用在这些最近点上评估的导数。\n3. 如果没有参数三元组满足辅助图形不显影约束，您必须为该测试用例输出标记配置 $[-1.0,-1.0,-1.0,-1.0]$。\n\n测试套件：\n- 使用以下三个测试用例，每个用例由 $(L,N,W,T,\\{s\\},\\{d\\},\\{w\\})$ 指定：\n  1. $L = 8$, $N = 4096$, $W = 0.5$, $T = 0.5$, $\\{s\\} = [0.2,0.5,0.8]$, $\\{d\\} = [0.1,0.3,0.6]$, $\\{w\\} = [0.02,0.06,0.1]$。\n  2. $L = 8$, $N = 4096$, $W = 0.2$, $T = 0.4$, $\\{s\\} = [0.4,0.6,0.9]$, $\\{d\\} = [0.05,0.2,0.4]$, $\\{w\\} = [0.02,0.05,0.08]$。\n  3. $L = 8$, $N = 4096$, $W = 0.7$, $T = 0.5$, $\\{s\\} = [0.1,0.3,0.5]$, $\\{d\\} = [0.02,0.05,0.08]$, $\\{w\\} = [0.01,0.02,0.03]$。\n\n最终输出规范：\n- 对于每个测试用例，您的程序必须输出一个包含最优元组 $[s^{\\star}, d^{\\star}, w^{\\star}, \\Phi^{\\star}]$ 的列表，其中 $s^{\\star}$、$d^{\\star}$ 和 $w^{\\star}$ 是选定的参数，$\\Phi^{\\star}$ 是相应的最大化边缘陡度。如果不存在可行配置，则输出 $[-1.0,-1.0,-1.0,-1.0]$。\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。该行必须按顺序包含三个测试用例的三个列表，例如： \"[[s1,d1,w1,phi1],[s2,d2,w2,phi2],[s3,d3,w3,phi3]]\"。\n- 所有量均为无量纲，无需进行物理单位转换。不使用角度；所有光源规格都是归一化单位下的空间频率偏移。",
            "solution": "该问题RFE是有效的。它提出了一个在光学光刻模拟领域中定义明确、有科学依据的计算问题，专门针对分辨率增强技术 (RET) 和光学邻近效应校正 (OPC)。所有必要的参数、模型和约束都以清晰一致的方式提供，从而可以直接、明确地进行数值实现。\n\n解决方案是一个计算实验，旨在找到一组最优的光刻参数——照明光源配置 ($s$) 和亚分辨率辅助图形 (SRAF) 几何形状 ($d, w$)——以最大化打印接触孔的成像质量。成像质量通过特征边缘处强度剖面的陡度来量化。该方法涉及在离散参数网格上进行系统性搜索，为每个候选配置模拟光学成像过程，并根据指定的目标和约束对其进行评估。整个模型基于标量傅里叶光学。\n\n该方法按以下步骤实现：\n\n1.  **离散化和网格设置：**\n    为了进行数值计算，将连续的一维空间域 $x$ 和频域 $k$ 进行离散化。空间域由一个长度为 $L$、以零为中心的区间上的 $N$ 个点组成的网格表示。空间步长为 $\\Delta x = L/N$。相应的空间频率网格 $k$ 根据离散傅里叶变换 (DFT) 的性质确定，由 `numpy.fft.fftfreq` 提供。单位是无量纲的，经过归一化，使得相干光瞳截止频率 $k_c$ 为 $1$。\n\n2.  **参数搜索和模拟循环：**\n    对所提供的离散参数的所有组合进行搜索：光源偏移 $s$、SRAF与接触孔的间距 $d$ 以及SRAF的宽度 $w$。对每个三元组 $(s, d, w)$，执行一次完整的空中像形成模拟。\n\n3.  **掩模函数构建：**\n    对于给定的几何参数 ($W, d, w$)，在离散空间网格上构建一维掩模振幅透射函数 $m(x)$。它被定义为三个矩形函数之和：一个用于宽度为 $W$ 的主接触孔开口，另外两个用于宽度为 $w$ 的SRAF，它们对称地放置在距主特征中心为 $W/2 + d$ 的中心到中心距离处。\n    $$m(x) =\n    \\begin{cases}\n        1  \\text{if } |x| \\leq W/2 \\\\\n        1  \\text{if } |x - (W/2+d)| \\leq w/2 \\\\\n        1  \\text{if } |x + (W/2+d)| \\leq w/2 \\\\\n        0  \\text{otherwise}\n    \\end{cases}\n    $$\n\n4.  **空中像计算：**\n    使用傅里叶光学原理计算部分相干成像的空中像强度 $I(x)$，并为两个相干偶极子光源点的非相干叠加进行离散化。\n    \n    a.  使用快速傅里叶变换 (FFT) 计算掩模的复频谱 $M(k) = \\mathcal{F}\\{m(x)\\}$。\n    \n    b.  成像系统由相干光瞳函数 $P(k)$ 来表征，它是一个半径为 $k_c=1$ 的圆形孔径。对于空间频率偏移为 $+s$ 的离轴光源点，有效光瞳移动到 $P(k-s)$。这被建模为一个滤波器，它通过频率范围在 $[s-k_c, s+k_c]$ 内的频率 $k$。对于位于 $-s$ 的对称光源点，使用类似的滤波器 $P(k+s)$。\n    \n    c.  通过用相应的移位光瞳对掩模频谱进行滤波，然后执行逆 FFT，计算来自每个光源点的像平面中的复电场：\n        $$E_{+s}(x) = \\mathcal{F}^{-1}\\left\\{ M(k)\\, P(k - s) \\right\\}$$\n        $$E_{-s}(x) = \\mathcal{F}^{-1}\\left\\{ M(k)\\, P(k + s) \\right\\}$$\n    \n    d.  总强度 $I(x)$ 是来自两个光源点的强度的非相干叠加，假设权重相等：\n        $$I(x) = \\frac{1}{2}\\, \\left|E_{+s}(x)\\right|^2 + \\frac{1}{2}\\, \\left|E_{-s}(x)\\right|^2$$\n    该模型的构建方式使得对于一个大的、开放的特征，在指定的光源偏移 ($|s| \\leq k_c$) 下，强度归一化为 $1$，因此计算出的 $I(x)$ 可以直接与光刻胶阈值 $T$ 进行比较。\n\n5.  **约束和目标函数的评估：**\n    对每个模拟的强度剖面 $I(x)$ 进行评估，以确定参数集 $(s, d, w)$ 是否可行，如果可行，则量化其性能。\n    \n    a.  **辅助图形不显影约束：** 仅当SRAF不显影时，模拟才被视为有效。这是通过检查每个辅助图形中心 $x_{a,L} = -(W/2 + d)$ 和 $x_{a,R} = +(W/2 + d)$ 的强度是否低于光刻胶阈值 $T$ 来强制执行的。由于问题的对称性，我们只需要检查一个。如果 $I(x_{a,R}) \\geq T$，则该参数集被拒绝。\n    \n    b.  **边缘陡度计算：** 对于有效的参数集，计算目标函数 $\\Phi = \\min(S_L, S_R)$。这需要几个子步骤：\n        i.  使用二阶精确的有限差分法（如 `numpy.gradient` 中实现的）在整个网格上数值计算强度的空间导数 $dI/dx$。\n        ii. 确定打印特征边缘的位置 $x_L$ 和 $x_R$。首先，识别出强度剖面 $I(x)$ 穿过阈值 $T$ 的所有点。从这组交叉点中，我们选择特征左右两侧最接近理想边缘位置 $-W/2$ 和 $+W/2$ 的点。\n        iii. 问题指定使用最接近阈值交叉的网格点。对于每个已识别的交叉（发生在两个网格点之间），选择强度值 $|I(x) - T|$ 较小的网格点作为评估陡度的位置。将这些最终的网格索引表示为 $idx_L$ 和 $idx_R$。\n        iv. 左右边缘陡度值计算为这些位置处导数的绝对值：$S_L = |dI/dx|_{x=x[idx_L]}|$ 和 $S_R = |dI/dx|_{x=x[idx_R]}|$。\n        v. 该参数集的最终分数为 $\\Phi = \\min(S_L, S_R)$。\n\n6.  **优化和最终输出：**\n    算法记录在所有有效参数集中找到的最高 $\\Phi$ 值以及产生它的相应 $(s, d, w)$。在遍历所有组合后，返回最优元组 $[s^{\\star}, d^{\\star}, w^{\\star}, \\Phi^{\\star}]$。如果没有参数组合满足不显影约束，则返回哨兵值 $[-1.0, -1.0, -1.0, -1.0]$，表示未找到可行解。对提供的三个测试用例中的每一个都重复此整个过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the optimization for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (L, N, W, T, {s}, {d}, {w})\n        (8, 4096, 0.5, 0.5, [0.2, 0.5, 0.8], [0.1, 0.3, 0.6], [0.02, 0.06, 0.1]),\n        (8, 4096, 0.2, 0.4, [0.4, 0.6, 0.9], [0.05, 0.2, 0.4], [0.02, 0.05, 0.08]),\n        (8, 4096, 0.7, 0.5, [0.1, 0.3, 0.5], [0.02, 0.05, 0.08], [0.01, 0.02, 0.03]),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = find_optimal_params(*case)\n        results.append(result)\n\n    # Format the output string as per the problem specification.\n    # Example: \"[[s1,d1,w1,phi1],[s2,d2,w2,phi2],[s3,d3,w3,phi3]]\"\n    result_str = \",\".join([f\"[{v[0]},{v[1]},{v[2]},{v[3]}]\" for v in results])\n    print(f\"[{result_str}]\")\n\ndef find_optimal_params(L, N, W, T, s_list, d_list, w_list):\n    \"\"\"\n    Solves for the optimal lithography parameters for a single test case.\n    \n    It searches over the grid of (s, d, w) to find the configuration that\n    maximizes edge steepness while satisfying the assist non-printing constraint.\n    \"\"\"\n    # 1. Setup spatial and frequency grids\n    dx = L / N\n    x = np.arange(N) * dx - L / 2\n    k_grid = np.fft.fftfreq(N, d=dx)\n    \n    best_phi = -1.0\n    best_params = [-1.0, -1.0, -1.0, -1.0]\n\n    for s in s_list:\n        # Pupil functions depend only on s, can be pre-calculated\n        k_c = 1.0\n        pupil_plus_s = (k_grid >= s - k_c)  (k_grid = s + k_c)\n        pupil_minus_s = (k_grid >= -s - k_c)  (k_grid = -s + k_c)\n\n        for d in d_list:\n            for w in w_list:\n                # 2. Construct mask m(x)\n                m_x = (np.abs(x) = W / 2).astype(float)\n                assist_pos_R = W / 2 + d\n                m_x += (np.abs(x - assist_pos_R) = w / 2).astype(float)\n                m_x += (np.abs(x + assist_pos_R) = w / 2).astype(float)\n                \n                # 3. Compute M(k)\n                M_k = np.fft.fft(m_x)\n                \n                # 4. Compute E-fields and Intensity I(x)\n                E_plus_s = np.fft.ifft(M_k * pupil_plus_s)\n                E_minus_s = np.fft.ifft(M_k * pupil_minus_s)\n                I_x = 0.5 * (np.abs(E_plus_s)**2 + np.abs(E_minus_s)**2)\n\n                # 5. Check assist non-printing constraint\n                idx_assist_R = np.argmin(np.abs(x - assist_pos_R))\n                if I_x[idx_assist_R] >= T:\n                    continue  # Constraint violated, next!\n\n                # 6. Calculate objective function Phi if constraint is met\n                dI_dx = np.gradient(I_x, dx)\n                \n                # Find threshold crossings nearest to +/- W/2\n                crossing_indices_pre = np.where(np.diff(np.sign(I_x - T)) != 0)[0]\n                if crossing_indices_pre.size  2:\n                    continue # Not enough crossings for two edges\n\n                # Find right edge\n                right_candidates = crossing_indices_pre[x[crossing_indices_pre] > 0]\n                if right_candidates.size == 0: continue\n                idx_R_pre_list = np.argmin(np.abs(x[right_candidates] - W/2))\n                idx_R_pre = right_candidates[idx_R_pre_list]\n                \n                # Find left edge\n                left_candidates = crossing_indices_pre[x[crossing_indices_pre] = 0]\n                if left_candidates.size == 0: continue\n                idx_L_pre_list = np.argmin(np.abs(x[left_candidates] - (-W/2)))\n                idx_L_pre = left_candidates[idx_L_pre_list]\n\n                # Choose grid point with intensity closer to T\n                if np.abs(I_x[idx_R_pre] - T)  np.abs(I_x[idx_R_pre + 1] - T):\n                    idx_R_final = idx_R_pre\n                else:\n                    idx_R_final = idx_R_pre + 1\n\n                if np.abs(I_x[idx_L_pre] - T)  np.abs(I_x[idx_L_pre + 1] - T):\n                    idx_L_final = idx_L_pre\n                else:\n                    idx_L_final = idx_L_pre + 1\n\n                S_L = np.abs(dI_dx[idx_L_final])\n                S_R = np.abs(dI_dx[idx_R_final])\n                phi = min(S_L, S_R)\n\n                # 7. Update best result\n                if phi > best_phi:\n                    best_phi = phi\n                    best_params = [s, d, w, phi]\n    \n    return best_params\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}