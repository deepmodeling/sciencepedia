{
    "hands_on_practices": [
        {
            "introduction": "在构建零偏移时钟树之前，我们必须首先建立一个精确的信号延迟数学模型。本练习将引导你从基本原理出发，推导在EDA领域广泛应用的埃尔莫尔延迟（Elmore delay）公式，它是分析RC网络时延的基础。通过这个过程，你将深刻理解路径延迟是如何计算的，以及时钟偏移（skew）是如何因不同路径的延迟差异而产生的。",
            "id": "4263397",
            "problem": "考虑一个在电子设计自动化（EDA）中由延迟合并嵌入（Deferred-Merge Embedding, DME）方法合成的时钟分配网络。该互连被建模为一个阻容树：每段长度为 $L$ 的导线段具有单位长度电阻 $r$ 和单位长度电容 $c$，因此其集总电阻为 $rL$，集总电容为 $cL$。每个接收端（sink）在其引脚处被建模为一个集总负载电容。源是一个输出电阻可忽略的理想阶跃信号源。该网络有两个接收端，标记为 $A$ 和 $B$，它们从一个单一的合并点分叉。从源到合并点的路径（主干）是直线型的，由 $m$ 个连续的线段组成，其长度为 $\\{T_{1}, T_{2}, \\dots, T_{m}\\}$。从合并点开始，到接收端 $A$ 的分支由 $n$ 个连续的线段组成，其长度为 $\\{A_{1}, A_{2}, \\dots, A_{n}\\}$，并终止于一个集总接收端电容 $C_{A}$。类似地，到接收端 $B$ 的分支由 $p$ 个连续的线段组成，其长度为 $\\{B_{1}, B_{2}, \\dots, B_{p}\\}$，并终止于一个集总接收端电容 $C_{B}$。\n\n从线性时不变阻容网络的第一性原理以及 Elmore 延迟作为树状网络脉冲响应一阶矩的定义出发，完成以下任务：\n\n- 在 Elmore 延迟模型下，将接收端 $A$ 和 $B$ 之间的时钟偏斜（clock skew）形式化为它们到达时间的差值。\n- 对于一条由长度为 $\\{L_{1}, L_{2}, \\dots, L_{N}\\}$ 的连续线段组成、末端带有一个集总负载电容 $C_{\\text{sink}}$ 的单一路径，推导其末端的 Elmore 到达时间的通用解析表达式，该表达式应以 $r$、$c$ 和各线段长度表示。\n\n假设除了在合并点外，各分支之间没有耦合，并且导线参数 $r$ 和 $c$ 在空间上是均匀的。将您的最终答案表示为两个闭式表达式：一个是针对序列 $\\{L_{i}\\}$ 的路径到达时间，另一个是由它们的分支序列 $\\{A_{i}\\}$ 和 $\\{B_{i}\\}$ 以及负载 $C_{A}$ 和 $C_{B}$ 构建的接收端 $A$ 和 $B$ 之间的偏斜。不需要进行数值评估。如果您选择在中间推理中包含主干部分，请确保在最终表达式中正确处理任何不影响偏斜的共模贡献。最终答案必须是单个解析表达式或由解析表达式组成的单行矩阵，不附加任何单位。",
            "solution": "用户提供的问题是有效的，因为它科学地基于电路理论的既定原理（RC 网络，Elmore 延迟），问题阐述清晰，目标明确，数据充分，并使用客观、正式的语言表述。该问题是 VLSI 时序分析中的一个标准的、非平凡的练习。我们将进行推导。\n\n在阻容（RC）树中，特定节点 $i$ 的 Elmore 延迟 $\\tau_D$ 是该节点处脉冲响应的一阶矩。对于一个在根节点（节点 $0$）由阶跃电压源驱动的树状网络，节点 $i$ 的 Elmore 延迟由以下表达式给出：\n$$ \\tau_i = \\sum_{k} R_k C_{downstream(k)} $$\n其中，求和遍历从源到节点 $i$ 的唯一路径上的所有电阻 $R_k$，而 $C_{downstream(k)}$ 是连接在电阻 $R_k$ 下游的子树的总电容。\n\n首先，我们推导单一路径末端的 Elmore 到达时间的通用表达式。\n考虑一条由 $N$ 个连续线段组成的单一路径，其长度为 $\\{L_{1}, L_{2}, \\dots, L_{N}\\}$，单位长度电阻为 $r$，单位长度电容为 $c$，并在其终端有一个集总负载电容 $C_{\\text{sink}}$。我们将每个线段 $k$（对于 $k=1, \\dots, N$）建模为一个 L 型模型，该模型由一个串联电阻 $R_k = rL_k$ 和一个紧随其后的对地并联电容 $C_k = cL_k$ 组成。该路径是这些 L 型节组成的梯形网络。设节点编号为 $v_0, v_1, \\dots, v_N$，其中 $v_0$ 是源， $v_N$ 是接收端。电阻 $R_k$ 连接节点 $v_{k-1}$ 和节点 $v_k$，电容 $C_k$ 连接在节点 $v_k$。负载 $C_{\\text{sink}}$ 也位于节点 $v_N$。\n\n从源 $v_0$ 到接收端 $v_N$ 的唯一路径包含电阻 $R_1, R_2, \\dots, R_N$。在接收端的 Elmore 到达时间，我们记为 $T_{\\text{path}}$，是：\n$$ T_{\\text{path}} = \\sum_{k=1}^{N} R_k C_{downstream(k)} $$\n电阻 $R_k$ 位于连接 $v_{k-1}$ 到 $v_k$ 的线段上。其下游电容 $C_{downstream(k)}$ 是连接在节点 $v_k$ 或其后的所有电容之和。这包括线段 $k, k+1, \\dots, N$ 的导线电容以及最终的负载电容 $C_{\\text{sink}}$。\n$$ C_{downstream(k)} = \\left(\\sum_{j=k}^{N} C_j\\right) + C_{\\text{sink}} = \\left(\\sum_{j=k}^{N} cL_j\\right) + C_{\\text{sink}} $$\n将 $R_k$ 和 $C_{downstream(k)}$ 的表达式代入延迟公式：\n$$ T_{\\text{path}} = \\sum_{k=1}^{N} (rL_k) \\left( c\\sum_{j=k}^{N} L_j + C_{\\text{sink}} \\right) $$\n我们可以将其分成两项：\n$$ T_{\\text{path}} = \\sum_{k=1}^{N} rcL_k \\left(\\sum_{j=k}^{N} L_j\\right) + \\sum_{k=1}^{N} rL_k C_{\\text{sink}} $$\n第一项代表路径本身的分布式 RC 特性所贡献的延迟。第二项代表通过总路径电阻对最终负载电容 $C_{\\text{sink}}$ 充电所产生的延迟。\n将常数 $r$、$c$ 和 $C_{\\text{sink}}$ 提取出来，得到路径到达时间的最终表达式：\n$$ T_{\\text{path}}(\\{L_k\\}_{k=1}^N, C_{\\text{sink}}) = r C_{\\text{sink}} \\sum_{k=1}^{N} L_k + rc \\sum_{k=1}^{N} L_k \\sum_{j=k}^{N} L_j $$\n这是第一个要求的表达式。\n\n接下来，我们推导接收端 $A$ 和 $B$ 之间的时钟偏斜。偏斜 $S_{AB}$ 是它们到达时间的差值，即 $\\tau_A - \\tau_B$。\n到接收端 $A$ 的路径由主干线段 $\\{T_1, \\dots, T_m\\}$ 和随后的分支 $A$ 线段 $\\{A_1, \\dots, A_n\\}$ 组成。类似地，到接收端 $B$ 的路径由相同的主干线段和随后的分支 $B$ 线段 $\\{B_1, \\dots, B_p\\}$ 组成。合并点是分支 $A$ 和 $B$ 分叉的公共节点。\n\n接收端 $A$ 的到达时间 $\\tau_A$ 是从源到该接收端的路径上所有电阻的延迟贡献之和：\n$$ \\tau_A = \\sum_{k=1}^{m} R_{T,k} C_{downstream(T,k)} + \\sum_{i=1}^{n} R_{A,i} C_{downstream(A,i)} $$\n类似地，对于接收端 $B$：\n$$ \\tau_B = \\sum_{k=1}^{m} R_{T,k} C_{downstream(T,k)} + \\sum_{j=1}^{p} R_{B,j} C_{downstream(B,j)} $$\n第一项 $\\tau_{\\text{Trunk}} = \\sum_{k=1}^{m} R_{T,k} C_{downstream(T,k)}$ 是主干电阻的延迟贡献。对于主干路径上的任何电阻 $R_{T,k}$，其下游电容包括主干剩余部分的电容，加上分支 $A$ 的全部电容（导线和接收端负载 $C_A$），再加上分支 $B$ 的全部电容（导线和接收端负载 $C_B$）。无论我们是计算到接收端 $A$ 还是接收端 $B$ 的延迟，这个下游电容都是相同的。因此，主干贡献 $\\tau_{\\text{Trunk}}$ 对 $\\tau_A$ 和 $\\tau_B$ 来说是共有的。\n\n那么，偏斜为：\n$$ S_{AB} = \\tau_A - \\tau_B = \\left(\\tau_{\\text{Trunk}} + \\sum_{i=1}^{n} R_{A,i} C_{downstream(A,i)}\\right) - \\left(\\tau_{\\text{Trunk}} + \\sum_{j=1}^{p} R_{B,j} C_{downstream(B,j)}\\right) $$\n$$ S_{AB} = \\sum_{i=1}^{n} R_{A,i} C_{downstream(A,i)} - \\sum_{j=1}^{p} R_{B,j} C_{downstream(B,j)} $$\n项 $\\sum_{i=1}^{n} R_{A,i} C_{downstream(A,i)}$ 代表从合并点到接收端 $A$ 的 Elmore 延迟。对于分支 $A$ 上的一个电阻 $R_{A,i}$，其下游电容仅由分支 $A$ 的后续部分和负载 $C_A$ 组成。这等效于将合并点作为源，计算分支 $A$ 作为一个孤立路径的延迟。\n\n因此，我们可以对每个分支使用前面推导的路径到达时间表达式。设 $\\tau_{\\text{branchA}}$ 为分支 A 的延迟，$\\tau_{\\text{branchB}}$ 为分支 B 的延迟，两者都从合并点开始计算。\n$$ \\tau_{\\text{branchA}} = T_{\\text{path}}(\\{A_k\\}_{k=1}^n, C_A) = r C_A \\sum_{k=1}^{n} A_k + rc \\sum_{k=1}^{n} A_k \\sum_{j=k}^{n} A_j $$\n$$ \\tau_{\\text{branchB}} = T_{\\text{path}}(\\{B_k\\}_{k=1}^p, C_B) = r C_B \\sum_{k=1}^{p} B_k + rc \\sum_{k=1}^{p} B_k \\sum_{j=k}^{p} B_j $$\n偏斜是这两个分支延迟的差值：\n$$ S_{AB} = \\tau_{\\text{branchA}} - \\tau_{\\text{branchB}} $$\n$$ S_{AB} = \\left(r C_A \\sum_{k=1}^{n} A_k + rc \\sum_{k=1}^{n} A_k \\sum_{j=k}^{n} A_j\\right) - \\left(r C_B \\sum_{k=1}^{p} B_k + rc \\sum_{k=1}^{p} B_k \\sum_{j=k}^{p} B_j\\right) $$\n这是第二个要求的表达式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nr C_{\\text{sink}} \\sum_{k=1}^{N} L_k + rc \\sum_{k=1}^{N} L_k \\sum_{j=k}^{N} L_j \\\\\n\\left(r C_A \\sum_{k=1}^{n} A_k + rc \\sum_{k=1}^{n} A_k \\sum_{j=k}^{n} A_j\\right) - \\left(r C_B \\sum_{k=1}^{p} B_k + rc \\sum_{k=1}^{p} B_k \\sum_{j=k}^{p} B_j\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "建立了延迟模型之后，我们便可以将DME算法的几何原理付诸实践。本练习提供了一个具体的布局场景，要求你运用几何匹配来确定合并顺序，并为每一级合并计算出确保零偏移的“合并区域”（merging segment）。通过这个自底向上的构建过程，你将亲手体验DME算法如何巧妙地在几何空间中规划布线，以实现时钟信号的同步到达。",
            "id": "4263407",
            "problem": "考虑一个在电子设计自动化（EDA）领域中使用延迟合并嵌入（DME）方法论，在均匀互连延迟模型下的零偏斜时钟树构建问题。有四个具有相同负载电容的汇点，其坐标（单位：微米）分别为：汇点 $s_{1}$ 位于 $(0, 0)$，汇点 $s_{2}$ 位于 $(4, 0)$，汇点 $s_{3}$ 位于 $(9, 1)$，以及汇点 $s_{4}$ 位于 $(9, 5)$。假设采用直角（曼哈顿）布线几何结构和均匀单位延迟模型，其中路径的 Elmore 延迟与其总曼哈顿长度成正比。目标是构建一个零偏斜树，使得从根节点到所有汇点的路径延迟相等，并且总线长最小化。\n\n任务：\n1. 使用几何匹配，为四个汇点提出一个二元合并顺序。\n2. 对于每次合并，计算相应的合并段（可行的斯坦纳父节点位置集合），该合并段是使得到达两个被合并子节点的直角路径长度相等的点的轨迹，并受限于被合并对的轴对齐边界框内。用其方程和端点表示该合并段。\n3. 在最终合并段上嵌入根节点，以最小化总直角线长，并计算得到的零偏斜树的最小总线长。\n\n最终线长以微米表示，并将您的答案四舍五入到四位有效数字。最终答案必须是一个实数值。",
            "solution": "我们从适用于均匀互连延迟模型下延迟合并嵌入（DME）的核心定义开始。在此模型下，当所有汇点的负载电容相等且所有导线上的单位电阻电容参数相同时，从根节点到任意汇点的 Elmore 延迟与总直角（曼哈顿）路径长度成正比。零偏斜树要求从根节点到所有汇点的路径长度相等。DME 方法为斯坦纳点构建可行区域（合并段），这些区域使得从一个父节点到两个子节点的路径长度相等，同时延迟确切的嵌入位置以优化总线长。\n\n直角距离的定义：对于两点 $(x_{a}, y_{a})$ 和 $(x_{b}, y_{b})$，曼哈顿距离为 $|x_{a} - x_{b}| + |y_{a} - y_{b}|$。\n\n步骤 1：使用几何匹配确定合并顺序。\n我们计算成对的直角距离，并选择最近邻对以形成第一级合并。\n\n- $s_{1} = (0, 0)$ 和 $s_{2} = (4, 0)$ 之间的距离：\n$$d_{12} = |0 - 4| + |0 - 0| = 4.$$\n\n- $s_{3} = (9, 1)$ 和 $s_{4} = (9, 5)$ 之间的距离：\n$$d_{34} = |9 - 9| + |1 - 5| = 4.$$\n\n我们简要检查交叉对的距离，以确认这些确实是最近邻匹配：\n- $d(s_{1}, s_{3}) = |0 - 9| + |0 - 1| = 10.$\n- $d(s_{1}, s_{4}) = |0 - 9| + |0 - 5| = 14.$\n- $d(s_{2}, s_{3}) = |4 - 9| + |0 - 1| = 6.$\n- $d(s_{2}, s_{4}) = |4 - 9| + |0 - 5| = 10.$\n\n因此，几何匹配产生的第一级合并对为 $(s_{1}, s_{2})$ 和 $(s_{3}, s_{4})$。\n\n步骤 2：计算每个第一级合并对的合并段。\n对于位于 $(x_{1}, y_{1})$ 和 $(x_{2}, y_{2})$ 的两个子节点，其轴对齐边界框内部的零偏斜轨迹是满足以下条件的点 $(x, y)$ 的集合\n$$|x - x_{1}| + |y - y_{1}| = |x - x_{2}| + |y - y_{2}|.$$\n当 $(x, y)$ 位于边界框 $[\\min(x_{1}, x_{2}), \\max(x_{1}, x_{2})] \\times [\\min(y_{1}, y_{2}), \\max(y_{1}, y_{2})]$ 内时，绝对值可以线性化，等式简化为\n$$x + y = \\frac{x_{1} + y_{1} + x_{2} + y_{2}}{2}.$$\n合并段是该直线在边界框内的部分，当边界框在任一轴上的维度为零时，它可能退化为一个点。\n\n- 对 $(s_{1}, s_{2})$：$(x_{1}, y_{1}) = (0, 0)$ 和 $(x_{2}, y_{2}) = (4, 0)$。边界框为 $x \\in [0, 4], y \\in [0, 0]$。平分线是\n$$x + y = \\frac{0 + 0 + 4 + 0}{2} = 2.$$\n与 $y = 0$ 相交得到 $x = 2$。因此，合并段退化为单点\n$$p_{12} = (2, 0).$$\n\n- 对 $(s_{3}, s_{4})$：$(x_{1}, y_{1}) = (9, 1)$ 和 $(x_{2}, y_{2}) = (9, 5)$。边界框为 $x \\in [9, 9], y \\in [1, 5]$。平分线是\n$$x + y = \\frac{9 + 1 + 9 + 5}{2} = 12.$$\n与 $x = 9$ 相交得到 $y = 3$。因此，该合并段也退化为单点\n$$p_{34} = (9, 3).$$\n\n步骤 3：计算第二级合并中点 $p_{12}$ 和 $p_{34}$ 的合并段。\n我们现在合并位于 $p_{12} = (2, 0)$ 和 $p_{34} = (9, 3)$ 的两个斯坦纳子节点。边界框为 $x \\in [2, 9], y \\in [0, 3]$。框内的零偏斜平分线是\n$$x + y = 7.$$\n框内可行段的端点是与边界框边缘的交点：\n- 当 $y = 0$ 时，我们得到 $x = 7$，给出端点 $(7, 0)$。\n- 当 $y = 3$ 时，我们得到 $x = 4$，给出端点 $(4, 3)$。\n因此，根节点的最终合并段是线段\n$$x + y = 7 \\quad \\text{其端点为 } (7, 0) \\text{ 和 } (4, 3).$$\n\n步骤 4：嵌入根节点以最小化总线长，并计算最小总直角线长。\n在直角度量下，对于第一级合并，我们可以计算每对到其合并点的贡献线长：\n- 对于 $(s_{1}, s_{2})$ 到 $p_{12}$：\n$$d(s_{1}, p_{12}) + d(s_{2}, p_{12}) = |0 - 2| + |0 - 0| + |4 - 2| + |0 - 0| = 2 + 0 + 2 + 0 = 4.$$\n- 对于 $(s_{3}, s_{4})$ 到 $p_{34}$：\n$$d(s_{3}, p_{34}) + d(s_{4}, p_{34}) = |9 - 9| + |1 - 3| + |9 - 9| + |5 - 3| = 0 + 2 + 0 + 2 = 4.$$\n\n对于第二级合并，设根节点为最终合并段 $x + y = 7$ 上、边界框 $[2, 9] \\times [0, 3]$ 内的任意一点 $(x, y)$。直角路径的一个基本性质是，对于 $p_{12}$ 和 $p_{34}$ 边界框内平分线上的任意点 $(x, y)$，其到这两点的直角距离相等，且它们的和等于 $p_{12}$ 和 $p_{34}$ 之间的直角距离：\n$$d(p_{12}, (x, y)) = d((x, y), p_{34}), \\quad d(p_{12}, (x, y)) + d((x, y), p_{34}) = d(p_{12}, p_{34}).$$\n我们通过计算来验证这个恒定的和\n$$d(p_{12}, p_{34}) = |2 - 9| + |0 - 3| = 7 + 3 = 10.$$\n因此，无论根节点放置在边界框内可行段 $x + y = 7$ 上的哪个位置，第二级连接的贡献都是\n$$d(p_{12}, \\text{root}) + d(\\text{root}, p_{34}) = 10.$$\n\n将所有贡献相加，最小总直角线长为\n$$L_{\\text{total}} = 4 + 4 + 10 = 18.$$\n\n因为坐标以微米为单位，所以这个总线长也以微米为单位。题目要求四舍五入到四位有效数字；精确值 $18$ 变为 $18.00$。",
            "answer": "$$\\boxed{18.00}$$"
        },
        {
            "introduction": "在真实的芯片设计中，我们常常需要在满足时序目标的同时，兼顾其他设计约束，例如遵循一个预先规划好的布线拓扑。本项高级练习模拟了这样一个场景：一个为最小化线长而设计的布线结构，在DME框架下却导致了不可行的合并。你将学会如何诊断这种不可行性，并掌握一种实用的解决方法——通过增加“绕线”（wire detouring）来恢复合并的可行性，从而解决设计中的实际挑战。",
            "id": "4263413",
            "problem": "考虑一个电子设计自动化（EDA）中的时钟树综合实例，该实例使用延迟合并嵌入（DME）方法，在一个固定的 rectilinear Steiner 最小树（RSMT）拓扑上实现零时钟偏斜（zero-skew）布线。导线在阻容（RC）Elmore 延迟近似模型下建模，其单位参数是均匀的，因此到达时间与 rectilinear（曼哈顿）路径长度成正比。零时钟偏斜定义为到达所有汇点（sink）的时间相等，在此模型下，这等同于从源点到每个汇点的总 rectilinear 路径长度相等。\n\n假设有四个汇点，其坐标分别为 $p_{1}=(0,0)$、$p_{2}=(4,0)$、$p_{3}=(10,1)$ 和 $p_{4}=(10,5)$，单位均为微米。给定的 RSMT 拓扑将 $\\{p_{1},p_{2}\\}$ 合并到子树 $\\mathcal{A}$，将 $\\{p_{3},p_{4}\\}$ 合并到子树 $\\mathcal{B}$，然后在一个顶层父节点处合并 $\\mathcal{A}$ 和 $\\mathcal{B}$。在每个子树内部，使用最小化 rectilinear 导线长度的 Steiner 嵌入：对于 $\\mathcal{A}$，将其 Steiner 点置于 $(2,0)$，连接 $p_{1}$ 和 $p_{2}$；对于 $\\mathcal{B}$，将其 Steiner 点置于 $(10,3)$，连接 $p_{3}$ 和 $p_{4}$。在这种嵌入下，子树 $\\mathcal{A}$ 内部从其根节点到每个汇点的内部长度为 $2$ 微米，同样地，子树 $\\mathcal{B}$ 内部的该长度也为 $2$ 微米。设要求的从源点到汇点的相等总 rectilinear 路径长度为 $L_{\\mathrm{req}}=12$ 微米，且上游从源点到父节点的 rectilinear 路径长度固定为 $L_{\\mathrm{up}}=5$ 微米。\n\n使用曼哈顿几何的第一性原理以及 RC Elmore 模型下的零时钟偏斜均衡，通过建立适当的必要几何条件并对上述数据进行数值评估，证明应用于此 RSMT 拓扑的 DME 方法在顶层产生了一个不可行的合并（即父节点的合并区域为空）。然后，为了在保持拓扑不变的情况下恢复可行性，假设您向两个父节点到子树的连接上都添加了长度为 $s$ 的相等 rectilinear 绕路（detour）（一个绕路在从父节点到 $(2,0)$ 的连接上，另一个在从父节点到 $(10,3)$ 的连接上），使得从父节点到每个子树根节点的距离增加相同的量。计算能保证顶层合并区域非空同时保持汇点处零时钟偏斜的最小 $s$ 值（以微米为单位）。最终答案以微米表示。",
            "solution": "该问题要求我们使用延迟合并嵌入（DME）方法，在 rectilinear 路径长度延迟模型下，分析一个时钟树布线实例。我们必须首先证明给定配置的不可行性，然后计算恢复可行性所需的最小绕路长度。\n\nDME 方法将根植于节点 $v_a$ 和 $v_b$ 的两个子树合并于一个父节点 $p$ 的核心原理，是基于满足路径长度约束。在给定的模型中，延迟与 rectilinear（曼哈顿）路径长度成正比，零时钟偏斜布线要求从源点到所有汇点的路径长度相等。\n\n设 $v_a$ 和 $v_b$ 是待合并的两个子树根节点的坐标。设 $l_{p,a}$ 和 $l_{p,b}$ 分别是从父节点 $p$ 到 $v_a$ 和 $v_b$ 的连接所需的路径长度（延迟预算）。满足对 $v_a$ 的预算的所有可能的父节点 $p$ 的位置集合，称为 $v_a$ 的合并区域，记作 $MR_a$。该区域由一组点 $p$ 定义，这些点到 $v_a$ 的曼哈顿距离 $d_M(p, v_a)$ 小于或等于预算 $l_{p,a}$。任何路径长度的不足，即 $l_{p,a} - d_M(p, v_a)$，都假定通过导线绕路（snaking）来补偿。\n$$MR_a = \\{ p \\mid d_M(p, v_a) \\leq l_{p,a} \\}$$\n$$MR_b = \\{ p \\mid d_M(p, v_b) \\leq l_{p,b} \\}$$\n一个可行的合并点 $p$ 必须位于这两个区域的交集内，$p \\in MR_a \\cap MR_b$。当且仅当两个子节点 $v_a$ 和 $v_b$ 之间的曼哈顿距离不大于它们路径长度预算之和时，才存在非空交集，从而实现可行合并。这是曼哈顿距离三角不等式的直接推论。\n$$d_M(v_a, v_b) \\leq l_{p,a} + l_{p,b}$$\n这是可行合并的必要几何条件。\n\n首先，我们证明初始配置的不可行性。问题提供了以下数据：\n- 子树 $\\mathcal{A}$ 的根节点：$v_{\\mathcal{A}} = (2,0)$。\n- 子树 $\\mathcal{B}$ 的根节点：$v_{\\mathcal{B}} = (10,3)$。\n- 子树 $\\mathcal{A}$ 内部从 $v_{\\mathcal{A}}$ 到其汇点的路径长度为 $l_{\\mathcal{A}} = 2$。\n- 子树 $\\mathcal{B}$ 内部从 $v_{\\mathcal{B}}$ 到其汇点的路径长度为 $l_{\\mathcal{B}} = 2$。\n- 要求的总源点到汇点路径长度：$L_{\\mathrm{req}} = 12$。\n- 上游源点到父节点路径长度：$L_{\\mathrm{up}} = 5$。\n\n从父节点 $p$ 到任何汇点的连接的路径长度预算必须是 $L_{\\mathrm{req}} - L_{\\mathrm{up}} = 12 - 5 = 7$。这个预算进一步分配给父到子连接和子树内部路径。\n对于子树 $\\mathcal{A}$，从父节点 $p$ 到 $v_{\\mathcal{A}}$ 的连接的路径长度预算是：\n$$l_{p,\\mathcal{A}} = (L_{\\mathrm{req}} - L_{\\mathrm{up}}) - l_{\\mathcal{A}} = 7 - 2 = 5 \\text{ 微米}$$\n对于子树 $\\mathcal{B}$，从父节点 $p$ 到 $v_{\\mathcal{B}}$ 的连接的路径长度预算是：\n$$l_{p,\\mathcal{B}} = (L_{\\mathrm{req}} - L_{\\mathrm{up}}) - l_{\\mathcal{B}} = 7 - 2 = 5 \\text{ 微米}$$\n子树根节点之间的曼哈顿距离是：\n$$d_M(v_{\\mathcal{A}}, v_{\\mathcal{B}}) = |10 - 2| + |3 - 0| = |8| + |3| = 11 \\text{ 微米}$$\n现在我们评估可行性条件：\n$$d_M(v_{\\mathcal{A}}, v_{\\mathcal{B}}) \\leq l_{p,\\mathcal{A}} + l_{p,\\mathcal{B}}$$\n$$11 \\leq 5 + 5$$\n$$11 \\leq 10$$\n这个不等式不成立。由于子节点之间的曼哈顿距离（$11 \\mu\\text{m}$）大于可用连接路径长度预算之和（$10 \\mu\\text{m}$），合并区域不相交。因此，顶层合并是不可行的。\n\n接下来，我们计算恢复可行性所需的最小绕路长度 $s$。问题陈述，在两个父节点到子树的连接上都增加了长度为 $s$ 的相等 rectilinear 绕路。最直接的解释是，每个父到子连接的路径长度预算增加了 $s$。这是因为原始预算不足，而增加一个长度为 $s$ 的绕路会使从源点到汇点的总路径长度增加 $s$，这反过来又为父到子连接的预算分配了额外的长度 $s$。\n\n到 $v_{\\mathcal{A}}$ 的连接的新路径长度预算变为：\n$$l'_{p,\\mathcal{A}} = l_{p,\\mathcal{A}} + s = 5 + s$$\n同样地，到 $v_{\\mathcal{B}}$ 的连接为：\n$$l'_{p,\\mathcal{B}} = l_{p,\\mathcal{B}} + s = 5 + s$$\n为了实现非空的合并区域（可行性），必须用这些新的预算满足几何条件：\n$$d_M(v_{\\mathcal{A}}, v_{\\mathcal{B}}) \\leq l'_{p,\\mathcal{A}} + l'_{p,\\mathcal{B}}$$\n代入已知值：\n$$11 \\leq (5 + s) + (5 + s)$$\n$$11 \\leq 10 + 2s$$\n为了找到 $s$ 的最小值，我们解这个不等式：\n$$1 \\leq 2s$$\n$$s \\geq \\frac{1}{2}$$\n$$s \\geq 0.5$$\n绕路长度 $s$ 必须是一个非负值。保证合并区域非空的最小 $s$ 值为 $0.5$。这意味着每个父到子连接需要额外 $0.5$ 微米的路径长度预算，使得新的所需连接长度为 $5.5$ 微米。这些新预算的总和 $5.5 + 5.5 = 11$，现在等于子节点之间的曼哈顿距离，满足了可行性条件（在这种最小情况下，合并区域将是一个单点）。\n\n所需的最小绕路长度 $s$ 为 $0.5$ 微米。",
            "answer": "$$\\boxed{0.5}$$"
        }
    ]
}