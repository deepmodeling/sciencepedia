{
    "hands_on_practices": [
        {
            "introduction": "Before creating a schedule, it is essential to establish a baseline for performance. This practice demonstrates how to determine the theoretical minimum latency by calculating lower bounds based on two independent constraints: data dependencies (the critical path) and finite resource capacities . Mastering this analysis allows you to quantify the 'optimality gap' of any given schedule, providing a crucial metric for evaluating its quality.",
            "id": "4275683",
            "problem": "Consider a dataflow directed acyclic graph (DAG) to be scheduled in High-Level Synthesis (HLS) within the domain of Electronic Design Automation (EDA). The scheduling objective is to minimize total latency (makespan) in integer time steps, under precedence and resource capacity constraints. All operations are non-preemptible, use integer-cycle durations, and occupy their required resource exclusively over their execution interval. There is no chaining within a cycle, no pipelining of multi-cycle operators, and communication delays are negligible. Inputs are available at time $0$. Latency is measured in cycles, defined as the maximum finish time over all operations.\n\nResources and capacities:\n- One multiplier unit ($1$ multiplier),\n- Two adder units ($2$ adders),\n- One divider unit ($1$ divider).\n\nOperation types and durations:\n- Multiplier operations take $3$ cycles,\n- Adder operations take $1$ cycle,\n- Divider operations take $5$ cycles.\n\nThe DAG consists of the following operations with precedence constraints:\n\n- $O_{1}$: multiplier, duration $3$, no predecessors.\n- $O_{2}$: adder, duration $1$, no predecessors.\n- $O_{3}$: multiplier, duration $3$, predecessor $O_{2}$.\n- $O_{4}$: adder, duration $1$, predecessors $O_{1}$ and $O_{3}$.\n- $O_{5}$: divider, duration $5$, predecessor $O_{4}$.\n- $O_{6}$: adder, duration $1$, predecessor $O_{5}$.\n- $O_{7}$: multiplier, duration $3$, predecessor $O_{6}$.\n- $O_{8}$: adder, duration $1$, predecessor $O_{7}$.\n- $O_{9}$: multiplier, duration $3$, predecessors $O_{1}$ and $O_{8}$.\n- $O_{10}$: adder, duration $1$, predecessors $O_{9}$ and $O_{3}$.\n\nTasks:\n1. Using the precedence constraints only, derive the minimal latency lower bound implied by the longest dependency path in the DAG.\n2. Using the resource capacity constraints only, derive the minimal latency lower bound implied by the total mandatory occupancy of each resource type.\n3. Combine these to obtain the tightest lower bound achievable by these two considerations.\n4. A heuristic list schedule (under the stated resource limits) produced the following start times (each operation $O_{i}$ starts at time $s_{i}$ and runs for its duration, occupying its resource over the interval $[s_{i}, s_{i} + \\text{duration})$):\n   - $O_{1}$: $s_{1} = 0$,\n   - $O_{2}$: $s_{2} = 0$,\n   - $O_{3}$: $s_{3} = 3$,\n   - $O_{4}$: $s_{4} = 6$,\n   - $O_{5}$: $s_{5} = 7$,\n   - $O_{6}$: $s_{6} = 12$,\n   - $O_{7}$: $s_{7} = 13$,\n   - $O_{8}$: $s_{8} = 16$,\n   - $O_{9}$: $s_{9} = 17$,\n   - $O_{10}$: $s_{10} = 20$.\n   Compute the latency of this heuristic schedule and compare it to the tight lower bound from Parts $1$–$3$.\n5. Report the optimality gap as the difference between the heuristic schedule latency and the tight lower bound, expressed in cycles. Provide your final answer as a single number. No rounding is required.",
            "solution": "The problem statement is first validated for correctness and completeness.\n\n**Step 1: Extract Givens**\n- **Objective**: Minimize total latency (makespan) in integer time steps.\n- **Resources and Capacities**: One multiplier unit ($N_{\\text{mult}} = 1$), two adder units ($N_{\\text{add}} = 2$), one divider unit ($N_{\\text{div}} = 1$).\n- **Operation Types and Durations**: Multiplier operations take $d_{\\text{mult}} = 3$ cycles, Adder operations take $d_{\\text{add}} = 1$ cycle, Divider operations take $d_{\\text{div}} = 5$ cycles.\n- **Operations and Precedence Constraints**:\n  - $O_{1}$: multiplier, duration $3$, no predecessors.\n  - $O_{2}$: adder, duration $1$, no predecessors.\n  - $O_{3}$: multiplier, duration $3$, predecessor $O_{2}$.\n  - $O_{4}$: adder, duration $1$, predecessors $O_{1}$ and $O_{3}$.\n  - $O_{5}$: divider, duration $5$, predecessor $O_{4}$.\n  - $O_{6}$: adder, duration $1$, predecessor $O_{5}$.\n  - $O_{7}$: multiplier, duration $3$, predecessor $O_{6}$.\n  - $O_{8}$: adder, duration $1$, predecessor $O_{7}$.\n  - $O_{9}$: multiplier, duration $3$, predecessors $O_{1}$ and $O_{8}$.\n  - $O_{10}$: adder, duration $1$, predecessors $O_{9}$ and $O_{3}$.\n- **Heuristic Schedule Start Times**: $s_{1} = 0$, $s_{2} = 0$, $s_{3} = 3$, $s_{4} = 6$, $s_{5} = 7$, $s_{6} = 12$, $s_{7} = 13$, $s_{8} = 16$, $s_{9} = 17$, $s_{10} = 20$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a classic resource-constrained scheduling problem from the domain of High-Level Synthesis (HLS) in Electronic Design Automation (EDA).\n- **Scientifically Grounded**: The problem is based on established, fundamental principles of digital circuit design, scheduling theory, and computer architecture.\n- **Well-Posed**: All necessary information—resource capacities, operation durations, and precedence constraints—is provided. The objective is clearly stated, ensuring a unique solution can be derived for each part.\n- **Objective**: The problem is described using precise, unambiguous, and standard terminology of the field.\nThe problem is complete, consistent, and scientifically sound. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be derived.\n\n**Solution Derivation**\n\nThe solution proceeds by addressing each of the five tasks in order.\n\n**1. Precedence-Based Latency Lower Bound (Critical Path)**\nThe minimal latency of any schedule is constrained by the longest path through the Dataflow Graph (DAG), known as the critical path. The length of this path is the sum of the durations of its constituent operations. We can find this by calculating the Earliest Start Time ($EST$) and Earliest Finish Time ($EF$) for each operation. For an operation $O_i$ with duration $d_i$ and set of predecessors $\\text{preds}(O_i)$:\n$$EST(O_i) = \\max_{O_j \\in \\text{preds}(O_i)} \\{EF(O_j)\\}$$\n$$EF(O_i) = EST(O_i) + d_i$$\nFor operations with no predecessors, $EST = 0$. The durations are $d_1=3, d_2=1, d_3=3, d_4=1, d_5=5, d_6=1, d_7=3, d_8=1, d_9=3, d_{10}=1$.\n\n- $O_1$: $EST(O_1) = 0$, so $EF(O_1) = 0 + 3 = 3$.\n- $O_2$: $EST(O_2) = 0$, so $EF(O_2) = 0 + 1 = 1$.\n- $O_3$ (pred $O_2$): $EST(O_3) = EF(O_2) = 1$, so $EF(O_3) = 1 + 3 = 4$.\n- $O_4$ (preds $O_1, O_3$): $EST(O_4) = \\max(EF(O_1), EF(O_3)) = \\max(3, 4) = 4$, so $EF(O_4) = 4 + 1 = 5$.\n- $O_5$ (pred $O_4$): $EST(O_5) = EF(O_4) = 5$, so $EF(O_5) = 5 + 5 = 10$.\n- $O_6$ (pred $O_5$): $EST(O_6) = EF(O_5) = 10$, so $EF(O_6) = 10 + 1 = 11$.\n- $O_7$ (pred $O_6$): $EST(O_7) = EF(O_6) = 11$, so $EF(O_7) = 11 + 3 = 14$.\n- $O_8$ (pred $O_7$): $EST(O_8) = EF(O_7) = 14$, so $EF(O_8) = 14 + 1 = 15$.\n- $O_9$ (preds $O_1, O_8$): $EST(O_9) = \\max(EF(O_1), EF(O_8)) = \\max(3, 15) = 15$, so $EF(O_9) = 15 + 3 = 18$.\n- $O_{10}$ (preds $O_9, O_3$): $EST(O_{10}) = \\max(EF(O_9), EF(O_3)) = \\max(18, 4) = 18$, so $EF(O_{10}) = 18 + 1 = 19$.\n\nThe critical path length is the maximum earliest finish time over all operations. This determines the precedence-based lower bound on latency, $L_{\\text{precedence}}$.\n$$L_{\\text{precedence}} = \\max(3, 1, 4, 5, 10, 11, 14, 15, 18, 19) = 19 \\text{ cycles.}$$\n\n**2. Resource-Based Latency Lower Bound**\nThe latency is also limited by the total execution demand on each resource type. For each resource type $k$ with $N_k$ units, the lower bound is the total duration of all operations of that type, divided by $N_k$, and rounded up to the nearest integer (ceiling function).\n$$L_{\\text{resource}, k} = \\left\\lceil \\frac{\\sum_{i \\in \\text{ops of type } k} d_i}{N_k} \\right\\rceil$$\n\n- **Multipliers**: There are $4$ multiplications ($O_1, O_3, O_7, O_9$), each taking $3$ cycles. There is $N_{\\text{mult}} = 1$ multiplier.\n$$L_{\\text{mult}} = \\left\\lceil \\frac{4 \\times 3}{1} \\right\\rceil = \\lceil 12 \\rceil = 12 \\text{ cycles.}$$\n- **Adders**: There are $5$ additions ($O_2, O_4, O_6, O_8, O_{10}$), each taking $1$ cycle. There are $N_{\\text{add}} = 2$ adders.\n$$L_{\\text{add}} = \\left\\lceil \\frac{5 \\times 1}{2} \\right\\rceil = \\lceil 2.5 \\rceil = 3 \\text{ cycles.}$$\n- **Dividers**: There is $1$ division ($O_5$) taking $5$ cycles. There is $N_{\\text{div}} = 1$ divider.\n$$L_{\\text{div}} = \\left\\lceil \\frac{1 \\times 5}{1} \\right\\rceil = \\lceil 5 \\rceil = 5 \\text{ cycles.}$$\nThe overall resource-based lower bound, $L_{\\text{resource}}$, is the maximum of these.\n$$L_{\\text{resource}} = \\max(L_{\\text{mult}}, L_{\\text{add}}, L_{\\text{div}}) = \\max(12, 3, 5) = 12 \\text{ cycles.}$$\n\n**3. Tightest Lower Bound**\nThe true minimum latency must satisfy both precedence and resource constraints. The tightest lower bound, $L_{\\text{lower\\_bound}}$, is therefore the maximum of the bounds derived from these two independent considerations.\n$$L_{\\text{lower\\_bound}} = \\max(L_{\\text{precedence}}, L_{\\text{resource}}) = \\max(19, 12) = 19 \\text{ cycles.}$$\n\n**4. Heuristic Schedule Latency**\nThe latency of the given heuristic schedule is its makespan, which is the maximum finish time among all operations. The finish time $f_i$ for operation $O_i$ is its start time $s_i$ plus its duration $d_i$.\n- $f_1 = s_1 + d_1 = 0 + 3 = 3$.\n- $f_2 = s_2 + d_2 = 0 + 1 = 1$.\n- $f_3 = s_3 + d_3 = 3 + 3 = 6$.\n- $f_4 = s_4 + d_4 = 6 + 1 = 7$.\n- $f_5 = s_5 + d_5 = 7 + 5 = 12$.\n- $f_6 = s_6 + d_6 = 12 + 1 = 13$.\n- $f_7 = s_7 + d_7 = 13 + 3 = 16$.\n- $f_8 = s_8 + d_8 = 16 + 1 = 17$.\n- $f_9 = s_9 + d_9 = 17 + 3 = 20$.\n- $f_{10} = s_{10} + d_{10} = 20 + 1 = 21$.\nThe latency of this schedule, $L_{\\text{heuristic}}$, is the maximum of these finish times.\n$$L_{\\text{heuristic}} = \\max(3, 1, 6, 7, 12, 13, 16, 17, 20, 21) = 21 \\text{ cycles.}$$\nComparing this to the lower bound, $L_{\\text{heuristic}} = 21 > L_{\\text{lower\\_bound}} = 19$, confirms the schedule is not proven to be optimal.\n\n**5. Optimality Gap**\nThe optimality gap is the difference between the latency of the heuristic schedule and the tightest lower bound.\n$$\\text{Optimality Gap} = L_{\\text{heuristic}} - L_{\\text{lower\\_bound}} = 21 - 19 = 2 \\text{ cycles.}$$\nThis value represents the number of cycles by which the heuristic solution exceeds the theoretical minimum possible latency.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "Since finding an optimal schedule is computationally intractable for most real-world problems, designers rely on effective heuristics. This exercise provides a hands-on walk-through of Force-Directed Scheduling (FDS), a classic algorithm that intelligently balances resource usage over time . By manually calculating the 'forces' acting on an operation, you will gain a deep understanding of how FDS minimizes resource contention to produce high-quality schedules.",
            "id": "4275720",
            "problem": "Consider a synchronous Data-Flow Graph (DFG) used in High-Level Synthesis (HLS) under the following assumptions and definitions, which form the fundamental base for scheduling: a DFG is a directed acyclic graph with nodes representing operations and edges representing precedence constraints; for each node, an As Soon As Possible (ASAP) time and an As Late As Possible (ALAP) time are defined based on a global latency bound; a node’s feasible time steps form its mobility window from ASAP to ALAP, inclusive; a probability distribution $P_{i}(t)$ is assigned to each unscheduled node $i$ across its mobility window such that $P_{i}(t)$ is uniform on its feasible time steps and zero elsewhere; for each resource type $k$, the resource usage distribution is $R_{k}(t) = \\sum_{i \\in \\mathcal{I}_{k}} P_{i}(t)$ where $\\mathcal{I}_{k}$ is the set of nodes of type $k$; and the schedule-quality cost is the time-summed squared resource usage across resource types, $C = \\sum_{k} \\sum_{t=1}^{L} R_{k}(t)^{2}$. Force-Directed Scheduling (FDS) selects a node-time assignment that decreases $C$ the most, using the gradient of $C$ with respect to the induced changes in distributions from assigning a node at a particular time, including effects on that node itself and on its immediate predecessors and immediate successors via mobility-window tightening induced by precedence.\n\nYou are given a small DFG with two resource types (adder and multiplier), unit latencies, and a global latency bound $L = 6$ time steps. The nodes are:\n- $n_{1}$: multiply, predecessors none, successors $n_{3}$.\n- $n_{2}$: add, predecessors none, successors $n_{3}$.\n- $n_{3}$: add, predecessors $n_{1}, n_{2}$, successors $n_{4}$.\n- $n_{4}$: multiply, predecessors $n_{3}$, successors none.\n\nAll operation latencies are $1$ time step. At the beginning of the iteration, no nodes are scheduled; every node’s initial $P_{i}(t)$ is uniform over its ASAP–ALAP window induced by the bound $L$. Treat resource distributions as the sum of node distributions per resource type, as defined above. In evaluating a candidate assignment of $n_{3}$ at time $t$, model the induced changes as: the self-change of $n_{3}$’s distribution from uniform over its window to a unit impulse at $t$; tightening the predecessors’ windows so their ALAP becomes $t-1$ (if this is tighter than their current ALAP), and tightening the successor’s window so its ASAP becomes $t+1$ (if this is tighter than its current ASAP); and taking these tightened windows to induce updated uniform distributions for the predecessors and successor without fully scheduling them. Compute the total force at each feasible $t$ for $n_{3}$ as the inner product between the vector of changes in resource distributions and the gradient of $C$ with respect to those distributions at the current iteration.\n\nExecute exactly one iteration of Force-Directed Scheduling by hand for node $n_{3}$: compute its ASAP and ALAP, derive the initial $P_{i}(t)$ and $R_{k}(t)$, evaluate the total force for each feasible $t$, choose the time $t^{\\ast}$ that minimizes the total force, and update the distributions accordingly. Report only the chosen time step $t^{\\ast}$ for $n_{3}$. No rounding is required; provide $t^{\\ast}$ as an integer.",
            "solution": "The problem statement is a valid, well-posed exercise in High-Level Synthesis scheduling, specifically focusing on the Force-Directed Scheduling (FDS) algorithm. It provides a complete Data-Flow Graph (DFG) specification, latency constraints, and a clear definition of the cost function and the computational steps to be performed. The problem is scientifically grounded in the principles of electronic design automation and is free from any contradictions or ambiguities.\n\nWe will execute one iteration of the FDS algorithm to determine the optimal time step to schedule operation $n_{3}$. This involves the following steps:\n1.  Compute the initial As-Soon-As-Possible (ASAP) and As-Late-As-Possible (ALAP) schedules for all nodes.\n2.  Determine the initial probability distributions $P_{i}(t)$ for each node $i$ and the corresponding resource usage distributions $R_{k}(t)$ for each resource type $k$.\n3.  For each feasible time step $t$ in the mobility window of node $n_{3}$, calculate the \"total force\" associated with tentatively scheduling $n_{3}$ at time $t$. The total force is a measure of the expected change in the cost function $C = \\sum_{k} \\sum_{t=1}^{L} R_{k}(t)^{2}$. As specified, we calculate this force using the first-order approximation of the change in $C$, which is the inner product of the gradient of $C$ and the vector of changes in the resource distributions. The force for an assignment of $n_3$ to time $t$ is given by $F(t) = \\sum_{k} \\sum_{t_j=1}^{L} \\frac{\\partial C} {\\partial R_k(t_j)} \\Delta R_k(t_j) = \\sum_{k} \\sum_{t_j=1}^{L} 2R_k(t_j) \\Delta R_k(t_j)$.\n4.  Select the time step $t^{\\ast}$ that minimizes the total force.\n\nFirst, we calculate the initial ASAP and ALAP times. All operations have a latency of $d_i=1$. The global latency bound is $L=6$.\n\nASAP times are computed via a forward pass from sources:\n- $ASAP(n_{1}) = 1$\n- $ASAP(n_{2}) = 1$\n- $ASAP(n_{3}) = \\max(ASAP(n_{1}) + d(n_{1}), ASAP(n_{2}) + d(n_{2})) = \\max(1+1, 1+1) = 2$\n- $ASAP(n_{4}) = ASAP(n_{3}) + d(n_{3}) = 2+1 = 3$\n\nALAP times are computed via a backward pass from sinks. An operation $i$ must complete by time $L$, so its start time $t$ must satisfy $t+d(i)-1 \\le L$, which means $t \\le L-d(i)+1$.\n- $ALAP(n_{4}) = L - d(n_{4}) + 1 = 6-1+1 = 6$\n- $ALAP(n_{3}) = ALAP(n_{4}) - d(n_{3}) = 6 - 1 = 5$\n- $ALAP(n_{1}) = ALAP(n_{3}) - d(n_{1}) = 5 - 1 = 4$\n- $ALAP(n_{2}) = ALAP(n_{3}) - d(n_{2}) = 5 - 1 = 4$\n\nThe initial mobility windows $[ASAP_i, ALAP_i]$ are:\n- $n_{1}$ (multiplier): $[1, 4]$, mobility $4$\n- $n_{2}$ (adder): $[1, 4]$, mobility $4$\n- $n_{3}$ (adder): $[2, 5]$, mobility $4$\n- $n_{4}$ (multiplier): $[3, 6]$, mobility $4$\n\nThe initial probability distributions $P_{i}(t)$ are uniform over these windows:\n- $P_{1}(t) = 1/4$ for $t \\in [1, 4]$; $0$ otherwise.\n- $P_{2}(t) = 1/4$ for $t \\in [1, 4]$; $0$ otherwise.\n- $P_{3}(t) = 1/4$ for $t \\in [2, 5]$; $0$ otherwise.\n- $P_{4}(t) = 1/4$ for $t \\in [3, 6]$; $0$ otherwise.\n\nThe initial resource distributions $R_{k}(t)$ are:\n- For multipliers ($\\mathcal{I}_{mult} = \\{n_1, n_4\\}$): $R_{mult}(t) = P_{1}(t) + P_{4}(t)$.\n  - $R_{mult}(1) = 1/4$, $R_{mult}(2) = 1/4$, $R_{mult}(3) = 1/4+1/4=1/2$, $R_{mult}(4) = 1/4+1/4=1/2$, $R_{mult}(5) = 1/4$, $R_{mult}(6) = 1/4$.\n- For adders ($\\mathcal{I}_{add} = \\{n_2, n_3\\}$): $R_{add}(t) = P_{2}(t) + P_{3}(t)$.\n  - $R_{add}(1) = 1/4$, $R_{add}(2) = 1/4+1/4=1/2$, $R_{add}(3) = 1/4+1/4=1/2$, $R_{add}(4) = 1/4+1/4=1/2$, $R_{add}(5) = 1/4$, $R_{add}(6) = 0$.\n\nNow, we evaluate the force for each feasible time step $t$ for $n_{3}$, which are $t \\in [2, 5]$.\n\nCase 1: Tentative assignment $n_{3} \\to t=2$\n- $n_3$ is assigned to $t=2$.\n- Predecessors $n_1, n_2$: ALAP becomes $t-1=1$. New window: $[1,1]$.\n- Successor $n_4$: ASAP becomes $t+1=3$. New window: $[3,6]$ (no change).\n- Changes in distributions $\\Delta P_i = P'_i - P_i$:\n  - $\\Delta P_{1}(1)=1-1/4=3/4$; $\\Delta P_{1}(t)=-1/4$ for $t \\in \\{2,3,4\\}$.\n  - $\\Delta P_{2}(1)=1-1/4=3/4$; $\\Delta P_{2}(t)=-1/4$ for $t \\in \\{2,3,4\\}$.\n  - $\\Delta P_{3}(2)=1-1/4=3/4$; $\\Delta P_{3}(t)=-1/4$ for $t \\in \\{3,4,5\\}$.\n  - $\\Delta P_{4}(t)=0$ for all $t$.\n- Changes in resource distributions $\\Delta R_k = \\sum_{i \\in \\mathcal{I}_k} \\Delta P_i$:\n  - $\\Delta R_{mult}(t) = \\Delta P_{1}(t)$: $\\Delta R_{mult}(1)=3/4$; $\\Delta R_{mult}(t)=-1/4$ for $t \\in \\{2,3,4\\}$.\n  - $\\Delta R_{add}(t) = \\Delta P_{2}(t) + \\Delta P_{3}(t)$: $\\Delta R_{add}(1)=3/4$; $\\Delta R_{add}(2)=-1/4+3/4=1/2$; $\\Delta R_{add}(3)=-1/4-1/4=-1/2$; $\\Delta R_{add}(4)=-1/4-1/4=-1/2$; $\\Delta R_{add}(5)=-1/4$.\n- Force calculation:\n  - $F_{mult}(2) = 2 \\sum_{t_j} R_{mult}(t_j)\\Delta R_{mult}(t_j) = 2[ (1/4)(3/4) + (1/4)(-1/4) + (1/2)(-1/4) + (1/2)(-1/4) ] = 2[3/16 - 1/16 - 1/8 - 1/8] = 2[-1/8] = -1/4$.\n  - $F_{add}(2) = 2 \\sum_{t_j} R_{add}(t_j)\\Delta R_{add}(t_j) = 2[ (1/4)(3/4) + (1/2)(1/2) + (1/2)(-1/2) + (1/2)(-1/2) + (1/4)(-1/4) ] = 2[3/16 + 1/4 - 1/4 - 1/4 - 1/16] = 2[-1/8] = -1/4$.\n  - Total Force $F(2) = -1/4 - 1/4 = -1/2$.\n\nCase 2: Tentative assignment $n_{3} \\to t=3$\n- $n_1, n_2$: ALAP becomes $t-1=2$. New window: $[1,2]$, $P'_{1,2}(t)=1/2$.\n- $n_4$: ASAP becomes $t+1=4$. New window: $[4,6]$, $P'_4(t)=1/3$.\n- $\\Delta P_{1,2}(t)=1/2-1/4=1/4$ for $t \\in \\{1,2\\}$; $\\Delta P_{1,2}(t)=-1/4$ for $t \\in \\{3,4\\}$.\n- $\\Delta P_{3}(2)=-1/4$; $\\Delta P_{3}(3)=3/4$; $\\Delta P_{3}(t)=-1/4$ for $t \\in \\{4,5\\}$.\n- $\\Delta P_{4}(3)=-1/4$; $\\Delta P_{4}(t)=1/3-1/4=1/12$ for $t \\in \\{4,5,6\\}$.\n- $\\Delta R_{mult}(t) = \\Delta P_{1}(t) + \\Delta P_{4}(t)$: $\\Delta R_{mult}(1)=1/4$, $\\Delta R_{mult}(2)=1/4$, $\\Delta R_{mult}(3)=-1/4-1/4=-1/2$, $\\Delta R_{mult}(4)=-1/4+1/12=-1/6$, $\\Delta R_{mult}(t)=1/12$ for $t \\in \\{5,6\\}$.\n- $\\Delta R_{add}(t) = \\Delta P_{2}(t) + \\Delta P_{3}(t)$: $\\Delta R_{add}(1)=1/4$, $\\Delta R_{add}(2)=1/4-1/4=0$, $\\Delta R_{add}(3)=-1/4+3/4=1/2$, $\\Delta R_{add}(4)=-1/4-1/4=-1/2$, $\\Delta R_{add}(5)=-1/4$.\n- Force calculation:\n  - $F_{mult}(3) = 2[ (1/4)(1/4) + (1/4)(1/4) + (1/2)(-1/2) + (1/2)(-1/6) + (1/4)(1/12) + (1/4)(1/12) ] = 2[1/8 - 1/4 - 1/12 + 1/24] = 2[-4/24] = -1/3$.\n  - $F_{add}(3) = 2[ (1/4)(1/4) + (1/2)(0) + (1/2)(1/2) + (1/2)(-1/2) + (1/4)(-1/4) ] = 2[1/16 + 0 + 1/4 - 1/4 - 1/16] = 0$.\n  - Total Force $F(3) = -1/3 + 0 = -1/3$.\n\nCase 3: Tentative assignment $n_{3} \\to t=4$\n- $n_1, n_2$: ALAP becomes $t-1=3$. New window: $[1,3]$, $P'_{1,2}(t)=1/3$.\n- $n_4$: ASAP becomes $t+1=5$. New window: $[5,6]$, $P'_4(t)=1/2$.\n- $\\Delta P_{1,2}(t)=1/3-1/4=1/12$ for $t \\in \\{1,2,3\\}$; $\\Delta P_{1,2}(4)=-1/4$.\n- $\\Delta P_{3}(t)=-1/4$ for $t \\in \\{2,3,5\\}$; $\\Delta P_{3}(4)=3/4$.\n- $\\Delta P_{4}(t)=-1/4$ for $t \\in \\{3,4\\}$; $\\Delta P_{4}(t)=1/2-1/4=1/4$ for $t \\in \\{5,6\\}$.\n- $\\Delta R_{mult}(t) = \\Delta P_{1}(t) + \\Delta P_{4}(t)$: $\\Delta R_{mult}(t)=1/12$ for $t \\in \\{1,2\\}$, $\\Delta R_{mult}(3)=1/12-1/4=-1/6$, $\\Delta R_{mult}(4)=-1/4-1/4=-1/2$, $\\Delta R_{mult}(t)=1/4$ for $t \\in \\{5,6\\}$.\n- $\\Delta R_{add}(t) = \\Delta P_{2}(t) + \\Delta P_{3}(t)$: $\\Delta R_{add}(1)=1/12$, $\\Delta R_{add}(2)=1/12-1/4=-1/6$, $\\Delta R_{add}(3)=1/12-1/4=-1/6$, $\\Delta R_{add}(4)=-1/4+3/4=1/2$, $\\Delta R_{add}(5)=-1/4$.\n- Force calculation:\n  - $F_{mult}(4) = 2[ (1/4)(1/12) + (1/4)(1/12) + (1/2)(-1/6) + (1/2)(-1/2) + (1/4)(1/4) + (1/4)(1/4) ] = 2[1/24 - 1/12 - 1/4 + 1/8] = 2[-4/24] = -1/3$.\n  - $F_{add}(4) = 2[ (1/4)(1/12) + (1/2)(-1/6) + (1/2)(-1/6) + (1/2)(1/2) + (1/4)(-1/4) ] = 2[ 1/48 - 1/12 - 1/12 + 1/4 - 1/16] = 2[(1-4-4+12-3)/48] = 2[2/48] = 1/12$.\n  - Total Force $F(4) = -1/3 + 1/12 = -3/12 = -1/4$.\n\nCase 4: Tentative assignment $n_{3} \\to t=5$\n- $n_1, n_2$: ALAP becomes $t-1=4$. New window: $[1,4]$ (no change).\n- $n_4$: ASAP becomes $t+1=6$. New window: $[6,6]$.\n- $\\Delta P_{1}=0$, $\\Delta P_{2}=0$.\n- $\\Delta P_3(t)=-1/4$ for $t \\in \\{2,3,4\\}$; $\\Delta P_3(5)=3/4$.\n- $\\Delta P_4(t)=-1/4$ for $t \\in \\{3,4,5\\}$; $\\Delta P_4(6)=3/4$.\n- $\\Delta R_{mult}(t) = \\Delta P_{4}(t)$: $\\Delta R_{mult}(t)=-1/4$ for $t \\in \\{3,4,5\\}$; $\\Delta R_{mult}(6)=3/4$.\n- $\\Delta R_{add}(t) = \\Delta P_{3}(t)$: $\\Delta R_{add}(t)=-1/4$ for $t \\in \\{2,3,4\\}$; $\\Delta R_{add}(5)=3/4$.\n- Force calculation:\n  - $F_{mult}(5) = 2[ (1/2)(-1/4) + (1/2)(-1/4) + (1/4)(-1/4) + (1/4)(3/4) ] = 2[-1/8-1/8-1/16+3/16] = 2[-1/4+1/8] = 2[-1/8] = -1/4$.\n  - $F_{add}(5) = 2[ (1/2)(-1/4) + (1/2)(-1/4) + (1/2)(-1/4) + (1/4)(3/4) ] = 2[-1/8-1/8-1/8+3/16] = 2[-3/8+3/16] = 2[-3/16] = -3/8$.\n  - Total Force $F(5) = -1/4 - 3/8 = -5/8$.\n\nSummary of forces:\n- $F(2) = -1/2 = -0.5$\n- $F(3) = -1/3 \\approx -0.333$\n- $F(4) = -1/4 = -0.25$\n- $F(5) = -5/8 = -0.625$\n\nComparing the values:\n$-0.625  -0.5  -0.333  -0.25$.\nThe minimum force is $F(5) = -5/8$.\nThe FDS algorithm selects the assignment that causes the largest decrease in the cost function, which corresponds to the most negative force. The minimal force is $-5/8$, occurring at $t=5$.\n\nTherefore, the chosen time step for node $n_{3}$ is $t^{\\ast}=5$.",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "Loops are frequently the most performance-critical parts of a design, and scheduling them efficiently is paramount for high-throughput hardware. This practice introduces modulo scheduling, a powerful software pipelining technique for overlapping loop iterations . You will learn to determine the minimum Initiation Interval ($II$) by analyzing both resource and recurrence constraints, and then construct a valid, compact schedule that achieves this maximum throughput.",
            "id": "4275730",
            "problem": "You are given a single-basic-block loop kernel for High-Level Synthesis (HLS), to be scheduled using software pipelining with modulo scheduling. The loop body consists of the following operations per iteration index $i$:\n- One multiply operation $M_i$ using one multiplier with latency $L_{\\mathrm{mul}}=2$.\n- Two add operations $A1_i$ and $A2_i$ using one adder with latency $L_{\\mathrm{add}}=1$.\n- One shift operation $S_i$ using one shifter with latency $L_{\\mathrm{shf}}=1$.\n\nAvailable resources per cycle are one multiplier, one adder, and one shifter. The dependence graph of the loop has the following edges with distances measured in loop iterations:\n- Intra-iteration dependences with distance $0$: $M_i \\to A1_i$, $A1_i \\to S_i$, $S_i \\to A2_i$.\n- A loop-carried dependence with distance $1$: $A2_i \\to M_{i+1}$.\n\nUsing only the foundational definitions that:\n- The Initiation Interval (II) is the number of cycles between the start times of consecutive loop iterations in a modulo schedule.\n- The resource-constrained lower bound is set by the per-iteration demand of each resource relative to its availability per cycle.\n- The recurrence-constrained lower bound is set by the longest data-dependence recurrence measured as total latency per iteration distance along any dependence cycle.\n- Modulo schedule constraints require that for every dependence edge $u \\to v$ with distance $d$, the modulo start times $s(u)$ and $s(v)$ satisfy $s(v) - s(u) \\geq \\text{latency}(u) - II \\cdot d$, and that at any residue class modulo $II$ the number of operations using a given resource does not exceed its available instances,\n\ndo the following:\n1. Determine the smallest theoretically attainable Initiation Interval by computing both the resource-constrained and recurrence-constrained lower bounds and taking the dominating one.\n2. Construct a valid modulo schedule at this Initiation Interval by assigning residue-class start times $s(M)$, $s(A1)$, $s(S)$, $s(A2)$ in $\\{0,1,\\dots, II-1\\}$ that satisfy all modulo dependence constraints and do not violate resource usage per residue class.\n3. Verify the constraints explicitly for your chosen residue-class start times.\n\nReport as your final answer the minimal feasible Initiation Interval $II$ as a single integer. No intermediate steps are required in the final answer. No rounding is needed.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of high-level synthesis, well-posed with sufficient and consistent data, and expressed in objective, formal language. The problem is a standard exercise in modulo scheduling and contains no apparent flaws. We may therefore proceed with the solution.\n\nThe task is to determine the smallest theoretically attainable Initiation Interval ($II$) for the given loop kernel, construct a valid modulo schedule for this $II$, and verify its correctness. The minimal $II$ is determined by the most stringent of two lower bounds: the resource-constrained lower bound ($ResII$) and the recurrence-constrained lower bound ($RecII$). The minimal feasible $II$ is given by $II_{\\min} = \\max(ResII, RecII)$.\n\n1.  **Determination of the Smallest Initiation Interval ($II$)**\n\n    a. **Resource-Constrained Lower Bound ($ResII$)**\n    The $ResII$ is determined by the resource that is most heavily used. For each resource type $R$, the lower bound is the ceiling of the ratio of the number of operations requiring that resource ($N_R$) to the number of available functional units of that type ($C_R$).\n    $ResII_R = \\lceil \\frac{N_R}{C_R} \\rceil$\n\n    -   **Multiplier**: There is one multiply operation ($M_i$), so $N_{\\mathrm{mul}} = 1$. There is one multiplier unit available, so $C_{\\mathrm{mul}} = 1$.\n        $ResII_{\\mathrm{mul}} = \\lceil \\frac{1}{1} \\rceil = 1$\n    -   **Adder**: There are two add operations ($A1_i$ and $A2_i$), so $N_{\\mathrm{add}} = 2$. There is one adder unit available, so $C_{\\mathrm{add}} = 1$.\n        $ResII_{\\mathrm{add}} = \\lceil \\frac{2}{1} \\rceil = 2$\n    -   **Shifter**: There is one shift operation ($S_i$), so $N_{\\mathrm{shf}} = 1$. There is one shifter unit available, so $C_{\\mathrm{shf}} = 1$.\n        $ResII_{\\mathrm{shf}} = \\lceil \\frac{1}{1} \\rceil = 1$\n\n    The overall resource-constrained lower bound is the maximum of these individual bounds:\n    $ResII = \\max(ResII_{\\mathrm{mul}}, ResII_{\\mathrm{add}}, ResII_{\\mathrm{shf}}) = \\max(1, 2, 1) = 2$.\n\n    b. **Recurrence-Constrained Lower Bound ($RecII$)**\n    The $RecII$ is determined by the data dependencies that form cycles in the dependence graph. For any recurrence cycle, the $II$ must be large enough to accommodate the total latency of the operations in the cycle, distributed over the total iteration distance of the cycle. The formula is $RecII = \\max_{\\text{cycles } c} \\left( \\lceil \\frac{\\sum_{u \\in c} \\text{latency}(u)}{\\sum_{e \\in c} \\text{distance}(e)} \\rceil \\right)$.\n\n    The problem describes a single recurrence cycle: $M_i \\to A1_i \\to S_i \\to A2_i \\to M_{i+1}$.\n    Let's analyze the properties of this cycle:\n    -   Dependence edges in the cycle: $M \\to A1$, $A1 \\to S$, $S \\to A2$, $A2 \\to M$.\n    -   The total latency is the sum of the latencies of the operations in the cycle:\n        $L_{\\text{cycle}} = \\text{latency}(M) + \\text{latency}(A1) + \\text{latency}(S) + \\text{latency}(A2)$.\n        -   The operation $M$ has latency $L_{\\mathrm{mul}} = 2$.\n        -   The operation $A1$ has latency $L_{\\mathrm{add}} = 1$.\n        -   The operation $S$ has latency $L_{\\mathrm{shf}} = 1$.\n        -   The operation $A2$ has latency $L_{\\mathrm{add}} = 1$.\n        Total Latency: $L_{\\text{cycle}} = 2 + 1 + 1 + 1 = 5$.\n    -   The total distance is the sum of the iteration distances of each edge in the cycle:\n        $D_{\\text{cycle}} = d(M \\to A1) + d(A1 \\to S) + d(S \\to A2) + d(A2 \\to M)$.\n        -   $d(M \\to A1) = 0$ (intra-iteration).\n        -   $d(A1 \\to S) = 0$ (intra-iteration).\n        -   $d(S \\to A2) = 0$ (intra-iteration).\n        -   $d(A2_i \\to M_{i+1}) = 1$ (loop-carried).\n        Total Distance: $D_{\\text{cycle}} = 0 + 0 + 0 + 1 = 1$.\n\n    The recurrence-constrained lower bound for this cycle is:\n    $RecII = \\lceil \\frac{L_{\\text{cycle}}}{D_{\\text{cycle}}} \\rceil = \\lceil \\frac{5}{1} \\rceil = 5$.\n\n    c. **Minimal Initiation Interval**\n    The minimum theoretical $II$ is the maximum of the two bounds:\n    $II_{\\min} = \\max(ResII, RecII) = \\max(2, 5) = 5$.\n    We will now attempt to find a valid schedule for $II=5$.\n\n2.  **Modulo Schedule Construction for $II=5$**\n\n    We must find residue-class start times $s(M)$, $s(A1)$, $s(S)$, $s(A2)$ in the set $\\{0, 1, 2, 3, 4\\}$. These times must satisfy both dependence and resource constraints.\n\n    a. **Dependence Constraints**\n    For each dependence edge $u \\to v$ with distance $d$, the modulo start times must satisfy $s(v) - s(u) \\geq \\text{latency}(u) - II \\cdot d$. With $II=5$:\n    -   $M \\to A1$: $d=0$, $\\text{latency}(M)=2 \\implies s(A1) - s(M) \\geq 2$.\n    -   $A1 \\to S$: $d=0$, $\\text{latency}(A1)=1 \\implies s(S) - s(A1) \\geq 1$.\n    -   $S \\to A2$: $d=0$, $\\text{latency}(S)=1 \\implies s(A2) - s(S) \\geq 1$.\n    -   $A2 \\to M$: $d=1$, $\\text{latency}(A2)=1 \\implies s(M) - s(A2) \\geq 1 - 5 \\cdot 1 = -4$.\n\n    b. **Resource Constraints**\n    Within any residue class modulo $5$, the number of operations using a resource must not exceed its capacity.\n    -   Multiplier (capacity $1$): $s(M)$ must be unique among multiplier operations. Trivial, as there's only one.\n    -   Adder (capacity $1$): The two add operations $A1$ and $A2$ must be scheduled in different residue classes. $s(A1) \\neq s(A2)$.\n    -   Shifter (capacity $1$): $s(S)$ must be unique among shifter operations. Trivial.\n\n    c. **Finding a Schedule**\n    Let's attempt to schedule the operations by assigning a start time to $M$ and propagating the constraints. A common heuristic is to schedule operations as early as possible. Let $s(M)=0$.\n    -   From $s(A1) - s(M) \\geq 2$, we have $s(A1) \\geq 0 + 2 = 2$. Let's try the earliest possible time, $s(A1)=2$.\n    -   From $s(S) - s(A1) \\geq 1$, we have $s(S) \\geq 2 + 1 = 3$. Let's try $s(S)=3$.\n    -   From $s(A2) - s(S) \\geq 1$, we have $s(A2) \\geq 3 + 1 = 4$. Let's try $s(A2)=4$.\n\n    Our candidate schedule is: $s(M)=0$, $s(A1)=2$, $s(S)=3$, $s(A2)=4$.\n\n3.  **Verification of the Schedule**\n\n    We verify this candidate schedule against all constraints for $II=5$.\n    \n    a. **Dependence Constraints Verification**:\n    -   $M \\to A1$: $s(A1) - s(M) = 2 - 0 = 2$. The constraint is $2 \\geq 2$. **Satisfied.**\n    -   $A1 \\to S$: $s(S) - s(A1) = 3 - 2 = 1$. The constraint is $1 \\geq 1$. **Satisfied.**\n    -   $S \\to A2$: $s(A2) - s(S) = 4 - 3 = 1$. The constraint is $1 \\geq 1$. **Satisfied.**\n    -   $A2 \\to M$: $s(M) - s(A2) = 0 - 4 = -4$. The constraint is $-4 \\geq -4$. **Satisfied.**\n\n    b. **Resource Constraints Verification**:\n    -   Multiplier: Operation $M$ is scheduled at time $0$. No conflict.\n    -   Adder: Operation $A1$ is at time $2$, and $A2$ is at time $4$. Since $s(A1) \\neq s(A2)$ ($2 \\neq 4$), there is no resource conflict for the adder. **Satisfied.**\n    -   Shifter: Operation $S$ is scheduled at time $3$. No conflict.\n\n    Since a valid schedule exists for $II=5$, and it has been shown that $II$ cannot be smaller than $5$, the minimal feasible Initiation Interval is indeed $5$.",
            "answer": "$$\\boxed{5}$$"
        }
    ]
}