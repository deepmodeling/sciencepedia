{
    "hands_on_practices": [
        {
            "introduction": "对称介质平板波导是光子集成电路中最基本的光传导结构的模型。在设计任何波导器件之前，首要任务是理解其导光机理，特别是确定在给定的几何尺寸和材料下，哪些模式能够作为导模存在。本练习将从麦克斯韦方程组出发，通过严格的物理推导，计算出决定模式是否被束缚在波导芯层中的关键参数——截止厚度()。",
            "id": "4289070",
            "problem": "一个硅光子集成电路 (PIC) 包含一个对称介质平板波导，由厚度为 $t$、折射率为 $n_{\\text{core}}=3.48$ 的硅芯层构成，其上下两侧被折射率为 $n_{\\text{clad}}=1.44$ 的二氧化硅包层所包围。假设工作在真空波长 $\\lambda=1550\\ \\text{nm}$ 下，且介质为磁导率均匀的非磁性材料。考虑导模的横电 (TE) 偏振，其中电场沿 $y$ 轴方向，传播沿 $z$ 轴方向。\n\n从线性、均匀、各向同性电介质中的麦克斯韦方程组以及电介质界面处切向场分量的连续性出发，推导对称平板波导中 TE 模式在芯层和包层中的场分布以及相关的色散关系。将导模的截止定义为传播常数 $\\,\\beta\\,$ 等于包层波数 $\\,k_{0}n_{\\text{clad}}\\,$ 的极限情况，其中 $\\,k_{0}=2\\pi/\\lambda\\,$，此时包层中的渐逝衰减常数从上方趋近于零。\n\n利用此截止定义和从第一性原理推导出的色散关系，确定前两个 TE 模式（TE$0$ 和 TE$1$）能够作为导模存在的最小芯层厚度 $t_{c}$。以纳米为单位，给出两个厚度值作为最终数值答案。将结果四舍五入至四位有效数字。",
            "solution": "该问题提法明确且有科学依据，可以从第一性原理进行严格推导。\n\n我们从无源、线性、均匀、各向同性、非磁性的电介质中的麦克斯韦旋度方程开始。假设时谐场形式为 $\\vec{E}(\\vec{r}, t) = \\text{Re}\\{\\vec{E}(\\vec{r}) e^{i\\omega t}\\}$ 和 $\\vec{H}(\\vec{r}, t) = \\text{Re}\\{\\vec{H}(\\vec{r}) e^{i\\omega t}\\}$，其中 $\\omega$ 是角频率，方程变为：\n$$ \\nabla \\times \\vec{E} = -i\\omega\\mu_0 \\vec{H} $$\n$$ \\nabla \\times \\vec{H} = i\\omega\\epsilon \\vec{E} $$\n此处，$\\mu_0$ 是自由空间磁导率，$\\epsilon = \\epsilon_0 n^2$ 是介质的介电常数，其中 $n$ 是折射率。\n\n合并这两个方程，可得到电场的矢量波动方程，即亥姆霍兹方程：\n$$ \\nabla \\times (\\nabla \\times \\vec{E}) = \\nabla(\\nabla \\cdot \\vec{E}) - \\nabla^2 \\vec{E} = \\omega^2 \\mu_0 \\epsilon \\vec{E} = k_0^2 n^2 \\vec{E} $$\n其中 $k_0 = \\omega/c = 2\\pi/\\lambda$ 是真空波数。在折射率 $n$ 为常数的区域，$\\nabla \\cdot \\vec{D} = \\epsilon (\\nabla \\cdot \\vec{E}) = 0$，这意味着 $\\nabla \\cdot \\vec{E} = 0$。波动方程简化为：\n$$ \\nabla^2 \\vec{E} + k_0^2 n^2 \\vec{E} = 0 $$\n\n我们考虑一个对称平板波导，其芯层厚度为 $t$，折射率为 $n_{\\text{core}}$（$|x| \\le t/2$），包层折射率为 $n_{\\text{clad}}$（$|x|  t/2$）。介质在 $y$ 和 $z$ 方向上是均匀的。对于横电 (TE) 模式，电场沿 $y$ 轴偏振，$\\vec{E} = \\hat{y} E_y(x, y, z)$。由于结构在 $y$ 方向上是均匀的，我们有 $\\partial/\\partial y = 0$。对于一个沿 $z$ 轴传播、传播常数为 $\\beta$ 的导模，其场具有以下形式：\n$$ E_y(x, z) = E_y(x) e^{-i\\beta z} $$\n将此形式代入亥姆霍兹方程，得到关于空间分布 $E_y(x)$ 的一维常微分方程：\n$$ \\frac{d^2 E_y(x)}{dx^2} + (k_0^2 n(x)^2 - \\beta^2) E_y(x) = 0 $$\n其中 $n(x)$ 是折射率分布：\n$$ n(x) = \\begin{cases} n_{\\text{core}}  |x| \\le t/2 \\\\ n_{\\text{clad}}  |x|  t/2 \\end{cases} $$\n\n对于导模，场必须在芯层内振荡，在包层中渐逝衰减。这要求 $k_0 n_{\\text{clad}}  \\beta  k_0 n_{\\text{core}}$。现在我们可以在每个区域中求解该方程。\n\n在芯层中 ($|x| \\le t/2$)：\n令 $k_x^2 = k_0^2 n_{\\text{core}}^2 - \\beta^2$。由于 $\\beta  k_0 n_{\\text{core}}$，因此 $k_x^2  0$。方程为 $\\frac{d^2 E_y}{dx^2} + k_x^2 E_y = 0$，其通解为 $E_y(x) = A \\cos(k_x x) + B \\sin(k_x x)$。\n\n在包层中 ($|x|  t/2$)：\n令 $\\gamma^2 = \\beta^2 - k_0^2 n_{\\text{clad}}^2$。由于 $\\beta  k_0 n_{\\text{clad}}$，因此 $\\gamma^2  0$。方程为 $\\frac{d^2 E_y}{dx^2} - \\gamma^2 E_y = 0$。解必须在 $|x| \\to \\infty$ 时衰减至零。因此，$E_y(x) = C e^{-\\gamma x}$ 对于 $x  t/2$，$E_y(x) = D e^{\\gamma x}$ 对于 $x  -t/2$。\n\n由于波导的对称性 ($n(-x) = n(x)$)，模式必须是关于 $x=0$ 的偶函数或奇函数。\n\n**偶 TE 模式 ($E_y(-x) = E_y(x)$):**\n在芯层中，$B=0$。场分布为：\n$$ E_y(x) = \\begin{cases} A_e \\cos(k_x t/2) e^{-\\gamma(|x|-t/2)}  |x|  t/2 \\\\ A_e \\cos(k_x x)  |x| \\le t/2 \\end{cases} $$\n通过此形式，保证了 $E_y$ 在界面 $x=\\pm t/2$ 处的连续性。\n\n**奇 TE 模式 ($E_y(-x) = -E_y(x)$):**\n在芯层中，$A=0$。场分布为：\n$$ E_y(x) = \\begin{cases} \\text{sgn}(x) A_o \\sin(k_x t/2) e^{-\\gamma(|x|-t/2)}  |x|  t/2 \\\\ A_o \\sin(k_x x)  |x| \\le t/2 \\end{cases} $$\n同样，保证了 $E_y$ 在界面处的连续性。\n\n为了推导色散关系，我们必须施加界面处切向磁场分量的连续性条件。相关的分量是 $H_z$。从 $\\nabla \\times \\vec{E} = -i\\omega\\mu_0 \\vec{H}$，我们可以得到 $(\\nabla \\times \\vec{E})_z = \\frac{\\partial E_y}{\\partial x} = -i\\omega\\mu_0 H_z$。因此 $H_z = \\frac{i}{\\omega \\mu_0} \\frac{\\partial E_y}{\\partial x}$。其连续性要求 $\\frac{dE_y}{dx}$ 在 $x = \\pm t/2$ 处连续。\n\n对于偶模式，在 $x=t/2$ 处：\n$$ \\frac{d}{dx} (A_e \\cos(k_x x))|_{x=t/2} = -A_e k_x \\sin(k_x t/2) $$\n$$ \\frac{d}{dx} (A_e \\cos(k_x t/2) e^{-\\gamma(x-t/2)})|_{x=t/2} = -A_e \\gamma \\cos(k_x t/2) $$\n令二者相等，得到偶 TE 模式的色散关系：\n$$ k_x \\tan(k_x t/2) = \\gamma $$\n\n对于奇模式，在 $x=t/2$ 处：\n$$ \\frac{d}{dx} (A_o \\sin(k_x x))|_{x=t/2} = A_o k_x \\cos(k_x t/2) $$\n$$ \\frac{d}{dx} (A_o \\sin(k_x t/2) e^{-\\gamma(x-t/2)})|_{x=t/2} = -A_o \\gamma \\sin(k_x t/2) $$\n令二者相等，得到奇 TE 模式的色散关系：\n$$ -k_x \\cot(k_x t/2) = \\gamma $$\n\n导模的截止被定义为 $\\beta \\to k_0 n_{\\text{clad}}$ 的极限情况。这意味着包层中的衰减常数 $\\gamma = \\sqrt{\\beta^2 - k_0^2 n_{\\text{clad}}^2}$ 趋近于零。在截止时，$\\gamma = 0$。\n\n将 $\\gamma=0$ 应用于色散关系：\n对于偶模式：$k_x \\tan(k_x t_c/2) = 0$。这要求 $k_x t_c/2 = M\\pi$，对于整数 $M \\ge 0$。\n对于奇模式：$-k_x \\cot(k_x t_c/2) = 0$。这要求 $k_x t_c/2 = (M+1/2)\\pi$，对于整数 $M \\ge 0$。\n此处，$t_c$ 是截止厚度。\n\n我们可以将这些条件合并为关于第 $m$ 个 TE 模式 (TE$_m$) 的单个方程，其中 $m=0, 1, 2, ...$：\n$$ k_x \\frac{t_{c,m}}{2} = m \\frac{\\pi}{2} $$\n如果 $m$ 为偶数，则 TE$_m$ 模式为偶模式；如果 $m$ 为奇数，则为奇模式。\n\n在截止时 ($\\gamma=0$)，芯层中的横向波矢 $k_x$ 由以下关系确定：\n$$ k_x^2 + \\gamma^2 = (k_0^2 n_{\\text{core}}^2 - \\beta^2) + (\\beta^2 - k_0^2 n_{\\text{clad}}^2) = k_0^2(n_{\\text{core}}^2 - n_{\\text{clad}}^2) $$\n$$ k_x^2 = k_0^2(n_{\\text{core}}^2 - n_{\\text{clad}}^2) \\implies k_x = k_0 \\sqrt{n_{\\text{core}}^2 - n_{\\text{clad}}^2} $$\n\n将 $k_x$ 的这个表达式代入合并的截止条件中，可得：\n$$ \\left( k_0 \\sqrt{n_{\\text{core}}^2 - n_{\\text{clad}}^2} \\right) \\frac{t_{c,m}}{2} = m \\frac{\\pi}{2} $$\n求解 TE$_m$ 模式的截止厚度 $t_{c,m}$：\n$$ t_{c,m} = \\frac{m \\pi}{k_0 \\sqrt{n_{\\text{core}}^2 - n_{\\text{clad}}^2}} $$\n使用 $k_0 = 2\\pi/\\lambda$：\n$$ t_{c,m} = \\frac{m \\pi}{(2\\pi/\\lambda) \\sqrt{n_{\\text{core}}^2 - n_{\\text{clad}}^2}} = \\frac{m \\lambda}{2 \\sqrt{n_{\\text{core}}^2 - n_{\\text{clad}}^2}} $$\n\n现在我们使用给定值 $\\lambda = 1550$ nm, $n_{\\text{core}} = 3.48$ 和 $n_{\\text{clad}} = 1.44$ 来计算前两个 TE 模式，即 TE$_0$ ($m=0$) 和 TE$_1$ ($m=1$) 的最小芯层厚度。\n\n首先，我们计算分母项：\n$$ \\sqrt{n_{\\text{core}}^2 - n_{\\text{clad}}^2} = \\sqrt{3.48^2 - 1.44^2} = \\sqrt{12.1104 - 2.0736} = \\sqrt{10.0368} \\approx 3.16812247 $$\n\n对于 TE$_0$ 模式 ($m=0$)：\nTE$_0$ 模式是基模。其截止厚度为：\n$$ t_{c,0} = \\frac{0 \\cdot 1550 \\text{ nm}}{2 \\sqrt{3.48^2 - 1.44^2}} = 0 \\text{ nm} $$\n对称平板波导中的基模 TE 模式的理论截止厚度为零。对于任何非零厚度，它都是导模。\n\n对于 TE$_1$ 模式 ($m=1$)：\n这是第一个高阶模式。其截止厚度为：\n$$ t_{c,1} = \\frac{1 \\cdot 1550 \\text{ nm}}{2 \\sqrt{3.48^2 - 1.44^2}} = \\frac{1550 \\text{ nm}}{2 \\times 3.16812247} \\approx \\frac{1550}{6.33624494} \\text{ nm} \\approx 244.6295 \\text{ nm} $$\n将此结果四舍五入到四位有效数字，得到 $t_{c,1} = 244.6$ nm。\n\nTE$_0$ 和 TE$_1$ 模式的最小芯层厚度分别为 $0$ nm 和 $244.6$ nm。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  244.6\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从无源器件到有源器件是光子集成电路功能性的关键一步，其核心在于对光信号进行主动调控。在硅光子学中，一种常见的调控方式是通过注入自由载流子来改变硅的折射率和吸收系数。本练习将演示如何量化由载流子注入引起的模式吸收变化()，这一过程将半导体物理中的载流子动力学与波导光学性能直接联系起来，是理解和设计光调制器等有源器件的基础。",
            "id": "4289037",
            "problem": "考虑一个硅条形波导，它是通过电子设计自动化（EDA）流程设计的光子集成电路（PIC）的一部分。其导模在真空波长 $\\lambda = 1550\\ \\text{nm}$ 下工作，并且是基横向电（TE）偏振的单模。通过横向 $p$–$i$–$n$ 结注入载流子，使得硅芯区域内的自由载流子密度均匀增加，电子密度增加了 $\\Delta N = 2.0 \\times 10^{18}\\ \\text{cm}^{-3}$，空穴密度增加了 $\\Delta P = 1.0 \\times 10^{18}\\ \\text{cm}^{-3}$。该导模在硅中的光限制因子为 $\\Gamma = 0.75$，定义为模式电磁能量存在于硅芯内部的分数。\n\n从频域的麦克斯韦方程组和自由载流子的杜鲁德模型出发，建立弱损耗导模的材料吸收增量与模式吸收增量之间的联系。对于由自由载流子引起的材料吸收增量，使用在 $\\lambda = 1550\\ \\text{nm}$ 波长下经过充分检验的 Soref–Bennett 模型的经验参数：电子参数 $C_{n} = 8.5 \\times 10^{-18}\\ \\text{cm}^{2}$ 和空穴参数 $C_{p} = 6.0 \\times 10^{-18}\\ \\text{cm}^{2}$。利用这些参数和给定的限制因子，估算模式自由载流子吸收增量 $\\Delta \\alpha_{\\text{mod}}$。\n\n将最终的 $\\Delta \\alpha_{\\text{mod}}$ 以 $\\text{cm}^{-1}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求我们确定硅条形波导中由于自由载流子注入引起的模式吸收增量 $\\Delta \\alpha_{\\text{mod}}$。这包括两个主要步骤：首先，建立材料吸收变化量 $\\Delta \\alpha_{\\text{mat}}$ 与模式吸收变化量 $\\Delta \\alpha_{\\text{mod}}$ 之间的理论关系；其次，使用所提供的参数计算其数值。\n\n我们从麦克斯韦方程组推导出的频域波动方程开始，该方程描述了在复相对介电常数为 $\\epsilon_r$ 的介质中的电场 $\\mathbf{E}$：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) - k_0^2 \\epsilon_r(\\mathbf{r}) \\mathbf{E} = 0 $$\n其中 $k_0 = 2\\pi/\\lambda$ 是自由空间波数，$\\lambda$ 是真空波长。\n\n对于沿 $z$ 轴传播的导模，电场形式为 $\\mathbf{E}(x, y, z) = \\mathbf{E}(x, y) \\exp(i\\tilde{\\beta}z)$，其中 $\\tilde{\\beta}$ 是复传播常数。$\\tilde{\\beta}$ 的虚部代表模式损耗或增益。对于有损模式，功率按 $P(z) = P(0)\\exp(-\\alpha_{\\text{mod}}z)$ 衰减。由于功率与 $|\\mathbf{E}|^2$ 成正比，场振幅必须按 $\\exp(-\\alpha_{\\text{mod}}z/2)$ 衰减。因此，复传播常数可以写为 $\\tilde{\\beta} = \\beta_r - i(\\alpha_{\\text{mod}}/2)$，其中 $\\beta_r$ 是相常数。\n\n自由载流子的注入会扰动硅芯的介电常数。在弱损耗介质中，复介电常数为 $\\epsilon_r = \\epsilon_r' + i\\epsilon_r''$，其中 $\\epsilon_r'' \\ll \\epsilon_r'$。自由载流子注入引入了一个变化量 $\\Delta\\epsilon_r$，该变化局限于硅芯区域：\n$$ \\Delta\\epsilon_r = \\Delta\\epsilon_r' + i\\Delta\\epsilon_r'' $$\n根据波导的一阶微扰理论，由介电常数微扰 $\\Delta\\epsilon_r$ 引起的传播常数平方的变化量 $\\Delta(\\tilde{\\beta}^2)$ 由下式给出：\n$$ \\Delta(\\tilde{\\beta}^2) = \\tilde{\\beta}^2 - \\beta_0^2 \\approx \\frac{k_0^2 \\iint_{\\text{core}} \\Delta\\epsilon_r |\\mathbf{E}_0(x,y)|^2 dx dy}{\\iint_{\\text{total}} |\\mathbf{E}_0(x,y)|^2 dx dy} $$\n其中 $\\beta_0$ 和 $\\mathbf{E}_0$ 分别是未受扰动（无损）模式的实传播常数和场分布。\n\n由于微扰很小，$\\tilde{\\beta} \\approx \\beta_0 + \\Delta\\beta$。因此，$\\tilde{\\beta}^2 - \\beta_0^2 \\approx 2\\beta_0\\Delta\\beta$。模式吸收系数的变化量为 $\\Delta\\alpha_{\\text{mod}} = 2\\,\\text{Im}(\\Delta\\beta)$。对微扰方程取虚部：\n$$ 2\\beta_0 \\text{Im}(\\Delta\\beta) \\approx \\frac{k_0^2 \\iint_{\\text{core}} \\Delta\\epsilon_r'' |\\mathbf{E}_0|^2 dx dy}{\\iint_{\\text{total}} |\\mathbf{E}_0|^2 dx dy} $$\n$$ \\beta_0 \\Delta\\alpha_{\\text{mod}} \\approx \\frac{k_0^2 \\iint_{\\text{core}} \\Delta\\epsilon_r'' |\\mathbf{E}_0|^2 dx dy}{\\iint_{\\text{total}} |\\mathbf{E}_0|^2 dx dy} $$\n材料吸收系数 $\\alpha_{\\text{mat}}$ 与介电常数的虚部相关，关系式为 $\\alpha_{\\text{mat}} = k_0 \\epsilon_r''/n$，其中 $n$ 是材料的折射率。因此，材料吸收的变化量为 $\\Delta\\alpha_{\\text{mat}} = k_0 \\Delta\\epsilon_r''/n_{\\text{Si}}$，其中 $n_{\\text{Si}}$ 是硅的折射率。这使我们可以写出 $\\Delta\\epsilon_r'' = n_{\\text{Si}} \\Delta\\alpha_{\\text{mat}}/k_0$。代入此式：\n$$ \\beta_0 \\Delta\\alpha_{\\text{mod}} \\approx \\frac{k_0^2}{\\iint_{\\text{total}} |\\mathbf{E}_0|^2 dx dy} \\iint_{\\text{core}} \\left(\\frac{n_{\\text{Si}} \\Delta\\alpha_{\\text{mat}}}{k_0}\\right) |\\mathbf{E}_0|^2 dx dy $$\n对于导模，我们可以近似为 $\\beta_0 \\approx k_0 n_{\\text{eff}}$，其中 $n_{\\text{eff}}$ 是模式的有效折射率。\n$$ k_0 n_{\\text{eff}} \\Delta\\alpha_{\\text{mod}} \\approx k_0 n_{\\text{Si}} \\Delta\\alpha_{\\text{mat}} \\frac{\\iint_{\\text{core}} |\\mathbf{E}_0|^2 dx dy}{\\iint_{\\text{total}} |\\mathbf{E}_0|^2 dx dy} $$\n$$ \\Delta\\alpha_{\\text{mod}} \\approx \\frac{n_{\\text{Si}}}{n_{\\text{eff}}} \\Delta\\alpha_{\\text{mat}} \\frac{\\iint_{\\text{core}} |\\mathbf{E}_0|^2 dx dy}{\\iint_{\\text{total}} |\\mathbf{E}_0|^2 dx dy} $$\n该分数代表了电场能量在芯区内的限制。限制因子 $\\Gamma$ 的一个更普遍的定义是总模式功率（或电磁能量）在芯区内的分数。对于许多常见的波导结构，因子 $n_{\\text{Si}}/n_{\\text{eff}}$ 以及能量限制和功率限制之间的差异很小，从而得出了广泛使用的近似式：\n$$ \\Delta\\alpha_{\\text{mod}} \\approx \\Gamma \\Delta\\alpha_{\\text{mat}} $$\n这个关系建立了材料吸收增量与模式吸收增量之间的联系。问题中已给出 $\\Gamma = 0.75$。\n\n接下来，我们计算由自由载流子引起的材料吸收变化量 $\\Delta\\alpha_{\\text{mat}}$。杜鲁德模型描述了自由载流子的光学响应，而 Soref–Bennett 模型为硅提供了一个成熟的经验参数化方法。吸收系数的增加量与注入的电子（$\\Delta N$）和空穴（$\\Delta P$）的密度成线性比例：\n$$ \\Delta\\alpha_{\\text{mat}} = C_n \\Delta N + C_p \\Delta P $$\n问题提供了以下数值：\n- 电子密度增加量：$\\Delta N = 2.0 \\times 10^{18}\\ \\text{cm}^{-3}$\n- 空穴密度增加量：$\\Delta P = 1.0 \\times 10^{18}\\ \\text{cm}^{-3}$\n- 在 $\\lambda=1550\\ \\text{nm}$ 时的电子吸收参数：$C_{n} = 8.5 \\times 10^{-18}\\ \\text{cm}^{2}$\n- 在 $\\lambda=1550\\ \\text{nm}$ 时的空穴吸收参数：$C_{p} = 6.0 \\times 10^{-18}\\ \\text{cm}^{2}$\n\n将这些值代入 $\\Delta \\alpha_{\\text{mat}}$ 的公式中：\n$$ \\Delta\\alpha_{\\text{mat}} = (8.5 \\times 10^{-18}\\ \\text{cm}^{2}) \\times (2.0 \\times 10^{18}\\ \\text{cm}^{-3}) + (6.0 \\times 10^{-18}\\ \\text{cm}^{2}) \\times (1.0 \\times 10^{18}\\ \\text{cm}^{-3}) $$\n$$ \\Delta\\alpha_{\\text{mat}} = (8.5 \\times 2.0) \\ \\text{cm}^{-1} + (6.0 \\times 1.0) \\ \\text{cm}^{-1} $$\n$$ \\Delta\\alpha_{\\text{mat}} = 17.0 \\ \\text{cm}^{-1} + 6.0 \\ \\text{cm}^{-1} $$\n$$ \\Delta\\alpha_{\\text{mat}} = 23.0 \\ \\text{cm}^{-1} $$\n\n最后，我们使用限制因子 $\\Gamma = 0.75$ 来计算模式吸收的增量 $\\Delta \\alpha_{\\text{mod}}$：\n$$ \\Delta\\alpha_{\\text{mod}} = \\Gamma \\Delta\\alpha_{\\text{mat}} = 0.75 \\times 23.0 \\ \\text{cm}^{-1} $$\n$$ \\Delta\\alpha_{\\text{mod}} = 17.25 \\ \\text{cm}^{-1} $$\n问题要求答案四舍五入到四位有效数字。结果 $17.25$ 已经有四位有效数字。",
            "answer": "$$\\boxed{17.25}$$"
        },
        {
            "introduction": "将单个光子器件集成为复杂电路需要一个严谨的设计和验证流程，这正是电子设计自动化（EDA）工具的核心作用。一个光子集成电路首先被抽象地设计为原理图，然后被实现为具体的物理版图。本练习旨在解决设计流程中一个至关重要的验证环节：版图与原理图的一致性（LVS）检查()，确保物理版图在几何上和物理上都精确地实现了预期的电路连接。",
            "id": "4289020",
            "problem": "给定一个光子集成电路版图的几何描述和一个有向原理图连接图。该版图由多段线波导和标注有位置及方向的组件端口组成。您的任务是编写一个程序，从版图中提取有向连接性（包括波导方向和传播方向），并根据原理图连接图对其进行验证。程序必须为每个测试用例计算一个布尔值判定结果。\n\n需要使用的基本原理和定义：\n- 光子集成电路（PIC）的连接性由电磁能量流决定，其由坡印亭矢量 $\\mathbf{S} = \\mathbf{E} \\times \\mathbf{H}$ 表示，其中 $\\mathbf{E}$ 是电场，$\\mathbf{H}$ 是磁场。在单模介质波导中，时间平均的能量传播方向与沿波导轴线的群速度矢量对齐，该矢量在端口界面处与波导的切线方向重合。这为有效连接提供了物理基础，即端口方向必须与局部波导切线对齐。\n- 用于光路版图与原理图比对的电子设计自动化（EDA）验证会比较两个有向图：一个是从几何和方向约束中提取的，另一个是作为预期原理图提供的。\n- 图论定义：一个有向图 $G = (V, E)$ 拥有一个顶点集 $V$（端口）和一个边集 $E \\subseteq V \\times V$（从一个输出端口到一个输入端口的有向连接）。在此问题中，两个有向图相等意味着当顶点标签为端口标识符时，它们的边集相等。\n\n您必须实现的几何和算法规则：\n1. 端口是带有以下标注的对象：\n   - 标识符字符串（例如，“L:out”）、类型（“input”或“output”）、以微米为单位的位置 $(x, y)$，以及从 $+\\hat{x}$ 轴逆时针测量的以度为单位的方向角 $\\theta_p$。\n2. 每个波导都是一个多段线 $P = [\\mathbf{r}_0, \\mathbf{r}_1, \\ldots, \\mathbf{r}_n]$，其两个端点 $\\mathbf{r}_0$ 和 $\\mathbf{r}_n$ 以微米为单位给出。对于端点 $\\mathbf{r}_0$，离开端口进入波导的局部切线是 $\\mathbf{t}_0 = \\mathbf{r}_1 - \\mathbf{r}_0$。对于另一个端点 $\\mathbf{r}_n$，离开端口进入波导的局部切线是 $\\mathbf{t}_n = \\mathbf{r}_{n-1} - \\mathbf{r}_n$。\n3. 如果波导端点与端口位置之间的欧几里得距离 $\\leq \\Delta r$（其中 $\\Delta r$ 是位置容差），则认为该端点与端口相连。如果同一端点的 $\\Delta r$ 范围内有多个端口，则该端点的连接不明确，必须视为对该波导无效。\n4. 方向一致性：对于一个已连接的端点，计算切线角 $\\theta_t = \\arctan2(t_y, t_x)$（以度为单位，归一化到 $[0, 360)$）。端口方向 $\\theta_p$ 必须在角度容差 $\\Delta \\theta$ 内与 $\\theta_t$ 对齐，使用圆上的最小环绕差异，即 $d(\\theta_p, \\theta_t) = \\min\\left(|\\theta_p - \\theta_t|, 360 - |\\theta_p - \\theta_t|\\right) \\leq \\Delta \\theta$。\n5. 有向连接性提取：对于每个两端都有效连接且方向检查均通过的波导，创建一个从端口类型为“output”的端点到端口类型为“input”的端点的有向边。如果两端类型均为“output”或均为“input”，则不为该波导创建有向边。\n6. 验证标准：从版图中提取的边集必须与原理图边集相等，判定结果才为真。\n\n角度单位要求：所有角度计算均使用度。位置单位要求：所有坐标均使用微米。容差以微米和度为单位提供。\n\n您的程序必须实现上述规则并处理以下测试套件。对于每个测试用例，返回一个布尔值，指示从版图提取的有向连接性是否与原理图完全匹配。\n\n测试套件：\n- 案例 $1$（理想路径，直线连接）：\n  - 容差：$\\Delta r = 0.5\\,\\mu\\mathrm{m}$，$\\Delta \\theta = 5^\\circ$。\n  - 端口：\n    - \"L:out\"：类型 \"output\"，位置 $(0\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m})$，方向 $\\theta_p = 0^\\circ$。\n    - \"M:in\"：类型 \"input\"，位置 $(100\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m})$，方向 $\\theta_p = 180^\\circ$。\n  - 波导：\n    - $P_1 = [(0\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m}), (50\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m}), (100\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m})]$。\n  - 原理图有向边：$\\{(\\text{\"L:out\"}, \\text{\"M:in\"})\\}$。\n\n- 案例 $2$（通过分束器分支，多条边）：\n  - 容差：$\\Delta r = 0.5\\,\\mu\\mathrm{m}$，$\\Delta \\theta = 5^\\circ$。\n  - 端口：\n    - \"L:out\"：类型 \"output\"，位置 $(0\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m})$，方向 $\\theta_p = 0^\\circ$。\n    - \"S:in\"：类型 \"input\"，位置 $(50\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m})$，方向 $\\theta_p = 180^\\circ$。\n    - \"S:out1\"：类型 \"output\"，位置 $(50\\,\\mu\\mathrm{m}, 10\\,\\mu\\mathrm{m})$，方向 $\\theta_p = 0^\\circ$。\n    - \"S:out2\"：类型 \"output\"，位置 $(50\\,\\mu\\mathrm{m}, -10\\,\\mu\\mathrm{m})$，方向 $\\theta_p = 0^\\circ$。\n    - \"M1:in\"：类型 \"input\"，位置 $(100\\,\\mu\\mathrm{m}, 10\\,\\mu\\mathrm{m})$，方向 $\\theta_p = 180^\\circ$。\n    - \"M2:in\"：类型 \"input\"，位置 $(100\\,\\mu\\mathrm{m}, -10\\,\\mu\\mathrm{m})$，方向 $\\theta_p = 180^\\circ$。\n  - 波导：\n    - $P_1 = [(0\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m}), (50\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m})]$。\n    - $P_2 = [(50\\,\\mu\\mathrm{m}, 10\\,\\mu\\mathrm{m}), (100\\,\\mu\\mathrm{m}, 10\\,\\mu\\mathrm{m})]$。\n    - $P_3 = [(50\\,\\mu\\mathrm{m}, -10\\,\\mu\\mathrm{m}), (100\\,\\mu\\mathrm{m}, -10\\,\\mu\\mathrm{m})]$。\n  - 原理图有向边：$\\{(\\text{\"L:out\"}, \\text{\"S:in\"}), (\\text{\"S:out1\"}, \\text{\"M1:in\"}), (\\text{\"S:out2\"}, \\text{\"M2:in\"})\\}$。\n\n- 案例 $3$（传播方向不匹配：两端均为输出，验证应失败）：\n  - 容差：$\\Delta r = 0.5\\,\\mu\\mathrm{m}$，$\\Delta \\theta = 5^\\circ$。\n  - 端口：\n    - \"L1:out\"：类型 \"output\"，位置 $(0\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m})$，方向 $\\theta_p = 0^\\circ$。\n    - \"L2:out\"：类型 \"output\"，位置 $(100\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m})$，方向 $\\theta_p = 180^\\circ$。\n  - 波导：\n    - $P_1 = [(0\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m}), (100\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m})]$。\n  - 原理图有向边：$\\{(\\text{\"L1:out\"}, \\text{\"L2:in\"})\\}$。\n\n- 案例 $4$（边界情况：方向在 360° 附近环绕）：\n  - 容差：$\\Delta r = 0.5\\,\\mu\\mathrm{m}$，$\\Delta \\theta = 5^\\circ$。\n  - 端口：\n    - \"L:out\"：类型 \"output\"，位置 $(0\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m})$，方向 $\\theta_p = 355^\\circ$。\n    - \"M:in\"：类型 \"input\"，位置 $(100\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m})$，方向 $\\theta_p = 180^\\circ$。\n  - 波导：\n    - $P_1 = [(0\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m}), (100\\,\\mu\\mathrm{m}, 0\\,\\mu\\mathrm{m})]$。\n  - 原理图有向边：$\\{(\\text{\"L:out\"}, \\text{\"M:in\"})\\}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表（例如，“[result1,result2,result3,result4]”），每个结果都是一个布尔值。不允许有其他输出。",
            "solution": "用户提供的问题陈述已经过评估并被确定为有效。它在科学上基于介质波导中电磁波传播的原理，在算法上是适定（well-posed）的，并使用客观、可形式化的语言表达。未检测到矛盾、歧义或事实上的不健全之处。\n\n解决此问题需要为光子集成电路实现一个版图对原理图（LVS）的验证算法。该算法从几何版图中提取一个有向连接图，并将其与给定的原理图进行比较。该方法论分解为以下顺序步骤，并将为每个测试用例实施。\n\n首先，我们表示版图和原理图数据。端口是包含标识符（字符串）、类型（'input'或'output'）、位置矢量 $\\mathbf{p} = (x, y)$ 和方向角 $\\theta_p$ 的结构。波导是由坐标矢量有序列表 $P = [\\mathbf{r}_0, \\mathbf{r}_1, \\ldots, \\mathbf{r}_n]$ 表示的多段线。原理图是一组有向边，其中每条边是端口标识符的元组（源，目标）。\n\n验证过程的核心是从版图几何中提取有向图。这是通过遍历每个波导并对其两个端点 $\\mathbf{r}_0$ 和 $\\mathbf{r}_n$ 应用一系列检查来执行的。\n\n1.  **端点到端口的关联：** 对于每个波导端点（$\\mathbf{r}_0$ 或 $\\mathbf{r}_n$），我们必须识别一个唯一的连接端口。\n    - 如果端口 $i$ 的位置 $\\mathbf{p}_i$ 与端点 $\\mathbf{r}_j$ 之间的欧几里得距离在指定的容差 $\\Delta r$ 内，则该端口是连接到端点 $\\mathbf{r}_j$ 的候选端口。距离计算为 $d(\\mathbf{p}_i, \\mathbf{r}_j) = \\sqrt{(p_{ix} - r_{jx})^2 + (p_{iy} - r_{jy})^2} \\le \\Delta r$。\n    - 仅当恰好有一个端口满足此距离标准时，连接才被视为有效。如果在容差半径内找到零个或多个端口，则连接不明确，该波导被取消形成任何边的资格。\n\n2.  **方向一致性验证：** 如果为波导的两个端点都找到了唯一的端口，则每个端口的方向必须与波导的局部方向一致。\n    - 对于第一个端点 $\\mathbf{r}_0$，代表能量流离端口方向的局部波导切线矢量定义为 $\\mathbf{t}_0 = \\mathbf{r}_1 - \\mathbf{r}_0$。\n    - 对于最后一个端点 $\\mathbf{r}_n$，切线矢量定义为 $\\mathbf{t}_n = \\mathbf{r}_{n-1} - \\mathbf{r}_n$。\n    - 每个切线矢量 $\\mathbf{t} = (t_x, t_y)$ 的角度 $\\theta_t$ 使用四象限反正切函数 $\\theta_t = \\arctan2(t_y, t_x)$ 计算。此角度会转换为度并归一化到 $[0, 360)$ 范围。\n    - 为使连接有效，端口的方向 $\\theta_p$ 必须与相应的切线角 $\\theta_t$ 对齐。这是通过确保圆上的最小角度差在角度容差 $\\Delta \\theta$ 内来检查的。该差异计算为 $d(\\theta_p, \\theta_t) = \\min(|\\theta_p - \\theta_t|, 360 - |\\theta_p - \\theta_t|) \\le \\Delta \\theta$。\n    - 如果任一端点的方向检查失败，则该波导不合格。\n\n3.  **有向边的形成：** 如果一个波导在其两个端点都通过了唯一连接和方向一致性检查，我们确定它所代表的有向边。\n    - 设两个连接的端口为端口 A 和端口 B。\n    - 有向边从一个 'output' 端口形成到一个 'input' 端口。\n    - 如果端口 A 的类型是 'output' 而端口 B 的类型是 'input'，则将一个有向边（端口 A 标识符，端口 B 标识符）添加到提取的边集中。\n    - 相反，如果端口 B 是 'output' 而端口 A 是 'input'，则添加边（端口 B 标识符，端口 A 标识符）。\n    - 如果两个端口类型相同（例如，'input'-'input' 或 'output'-'output'），则不形成有向边，因为这不代表两个不同组件之间的有效定向能量流。\n\n4.  **最终验证：** 处理完所有波导后，将提取的有向边集与为测试用例提供的原理图边集进行比较。当且仅当两个集合相同时，该测试用例的验证判定结果为真。这包括具有相同数量的边以及每条边具有相同的源和目标。\n\n此程序将系统地应用于所提供的测试套件中的每个测试用例，以生成最终的布尔结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to run the verification for all test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"case_id\": 1,\n            \"tolerances\": {\"delta_r\": 0.5, \"delta_theta\": 5.0},\n            \"ports\": {\n                \"L:out\": {\"type\": \"output\", \"pos\": (0.0, 0.0), \"angle\": 0.0},\n                \"M:in\": {\"type\": \"input\", \"pos\": (100.0, 0.0), \"angle\": 180.0},\n            },\n            \"waveguides\": [\n                [(0.0, 0.0), (50.0, 0.0), (100.0, 0.0)]\n            ],\n            \"schematic_edges\": {(\"L:out\", \"M:in\")},\n        },\n        {\n            \"case_id\": 2,\n            \"tolerances\": {\"delta_r\": 0.5, \"delta_theta\": 5.0},\n            \"ports\": {\n                \"L:out\": {\"type\": \"output\", \"pos\": (0.0, 0.0), \"angle\": 0.0},\n                \"S:in\": {\"type\": \"input\", \"pos\": (50.0, 0.0), \"angle\": 180.0},\n                \"S:out1\": {\"type\": \"output\", \"pos\": (50.0, 10.0), \"angle\": 0.0},\n                \"S:out2\": {\"type\": \"output\", \"pos\": (50.0, -10.0), \"angle\": 0.0},\n                \"M1:in\": {\"type\": \"input\", \"pos\": (100.0, 10.0), \"angle\": 180.0},\n                \"M2:in\": {\"type\": \"input\", \"pos\": (100.0, -10.0), \"angle\": 180.0},\n            },\n            \"waveguides\": [\n                [(0.0, 0.0), (50.0, 0.0)],\n                [(50.0, 10.0), (100.0, 10.0)],\n                [(50.0, -10.0), (100.0, -10.0)],\n            ],\n            \"schematic_edges\": {\n                (\"L:out\", \"S:in\"), \n                (\"S:out1\", \"M1:in\"), \n                (\"S:out2\", \"M2:in\")\n            },\n        },\n        {\n            \"case_id\": 3,\n            \"tolerances\": {\"delta_r\": 0.5, \"delta_theta\": 5.0},\n            \"ports\": {\n                \"L1:out\": {\"type\": \"output\", \"pos\": (0.0, 0.0), \"angle\": 0.0},\n                \"L2:out\": {\"type\": \"output\", \"pos\": (100.0, 0.0), \"angle\": 180.0},\n            },\n            \"waveguides\": [\n                [(0.0, 0.0), (100.0, 0.0)]\n            ],\n            \"schematic_edges\": {(\"L1:out\", \"L2:in\")},\n        },\n        {\n            \"case_id\": 4,\n            \"tolerances\": {\"delta_r\": 0.5, \"delta_theta\": 5.0},\n            \"ports\": {\n                \"L:out\": {\"type\": \"output\", \"pos\": (0.0, 0.0), \"angle\": 355.0},\n                \"M:in\": {\"type\": \"input\", \"pos\": (100.0, 0.0), \"angle\": 180.0},\n            },\n            \"waveguides\": [\n                [(0.0, 0.0), (100.0, 0.0)]\n            ],\n            \"schematic_edges\": {(\"L:out\", \"M:in\")},\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        verdict = verify_layout(case)\n        results.append(verdict)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef verify_layout(case_data):\n    \"\"\"\n    Performs layout vs. schematic verification for a single case.\n    \"\"\"\n    ports = case_data[\"ports\"]\n    waveguides = case_data[\"waveguides\"]\n    tolerances = case_data[\"tolerances\"]\n    schematic_edges = case_data[\"schematic_edges\"]\n    \n    extracted_edges = set()\n\n    for wg in waveguides:\n        wg_polyline = [np.array(p) for p in wg]\n        \n        # Endpoints of the waveguide\n        r0, rn = wg_polyline[0], wg_polyline[-1]\n\n        # 1. Endpoint-to-Port Association and Ambiguity Check\n        connected_ports_r0 = []\n        for port_id, port_data in ports.items():\n            if np.linalg.norm(r0 - np.array(port_data[\"pos\"])) = tolerances[\"delta_r\"]:\n                connected_ports_r0.append(port_id)\n        \n        if len(connected_ports_r0) != 1:\n            continue  # Ambiguous or no connection at r0\n\n        connected_ports_rn = []\n        for port_id, port_data in ports.items():\n            if np.linalg.norm(rn - np.array(port_data[\"pos\"])) = tolerances[\"delta_r\"]:\n                connected_ports_rn.append(port_id)\n        \n        if len(connected_ports_rn) != 1:\n            continue  # Ambiguous or no connection at rn\n            \n        port0_id = connected_ports_r0[0]\n        portn_id = connected_ports_rn[0]\n\n        # 2. Orientation Consistency Verification\n        # For endpoint r0\n        t0 = wg_polyline[1] - r0\n        theta_t0 = (math.degrees(np.arctan2(t0[1], t0[0])) + 360) % 360\n        theta_p0 = ports[port0_id][\"angle\"]\n        angle_diff0 = abs(theta_p0 - theta_t0)\n        min_angle_diff0 = min(angle_diff0, 360 - angle_diff0)\n        \n        if min_angle_diff0 > tolerances[\"delta_theta\"]:\n            continue\n\n        # For endpoint rn\n        tn = wg_polyline[-2] - rn\n        theta_tn = (math.degrees(np.arctan2(tn[1], tn[0])) + 360) % 360\n        theta_pn = ports[portn_id][\"angle\"]\n        angle_diffn = abs(theta_pn - theta_tn)\n        min_angle_diffn = min(angle_diffn, 360 - angle_diffn)\n\n        if min_angle_diffn > tolerances[\"delta_theta\"]:\n            continue\n\n        # 3. Directed Edge Formation\n        port0_type = ports[port0_id][\"type\"]\n        portn_type = ports[portn_id][\"type\"]\n\n        if port0_type == \"output\" and portn_type == \"input\":\n            extracted_edges.add((port0_id, portn_id))\n        elif port0_type == \"input\" and portn_type == \"output\":\n            extracted_edges.add((portn_id, port0_id))\n\n    # 4. Final Verification\n    return extracted_edges == schematic_edges\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}