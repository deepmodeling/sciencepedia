{
    "hands_on_practices": [
        {
            "introduction": "All electronic components at a temperature above absolute zero are sources of random fluctuations. This exercise focuses on the most ubiquitous of these: thermal noise in a resistor, as described by the Johnson-Nyquist theorem. By calculating the root-mean-square (RMS) noise voltage over a specified bandwidth , you will practice the fundamental skill of converting a noise power spectral density, given by $S_v(f) = 4k_BTR$, into a tangible, measurable voltage.",
            "id": "4304678",
            "problem": "A passive resistor operating at thermal equilibrium exhibits random voltage fluctuations due to the thermal agitation of charge carriers. Consider a resistor of value $R=1\\,\\text{k}\\Omega$ held at temperature $T=300\\,\\text{K}$. Its voltage is observed through an ideal linear time-invariant brick-wall filter whose magnitude response is unity over the one-sided frequency interval $0 \\le f \\le B$ and zero elsewhere, where $B=100\\,\\text{kHz}$ is the flat measurement bandwidth. Assume the classical regime where $h f \\ll k_B T$ over the band of interest, treat the resistor’s thermal noise as white within the band, and use a one-sided description of power spectral densities.\n\nStarting from the Johnson–Nyquist theorem and the definition of voltage noise power spectral density, and from the relationship between mean-square noise and spectral integration through a linear time-invariant system, derive the root-mean-square output noise voltage at the filter output. Use the value $k_B=1.380649\\times 10^{-23}\\,\\text{J}/\\text{K}$ for the Boltzmann constant, and neglect any loading or additional noise sources.\n\nCompute the final numerical value and express it in microvolts. Round your answer to four significant figures.",
            "solution": "The problem asks for the root-mean-square (RMS) noise voltage at the output of an ideal filter connected to a resistor at thermal equilibrium. The derivation begins with the Johnson–Nyquist theorem, which describes the thermal noise generated by a resistor.\n\nFirst, let us validate the problem statement.\nThe givens are:\n- Resistor value: $R = 1\\,\\text{k}\\Omega = 1000\\,\\Omega$\n- Temperature: $T = 300\\,\\text{K}$\n- Filter type: Ideal linear time-invariant (LTI) brick-wall filter\n- Filter magnitude response: $|H(f)| = 1$ for $0 \\le f \\le B$ and $|H(f)| = 0$ for $f > B$\n- Measurement bandwidth: $B = 100\\,\\text{kHz} = 10^5\\,\\text{Hz}$\n- Physical constant: Boltzmann constant, $k_B=1.380649\\times 10^{-23}\\,\\text{J}/\\text{K}$\n- Assumption: The system is in the classical regime, where $hf \\ll k_B T$.\n- Assumption: The resistor's thermal noise is white within the band of interest.\n- Assumption: A one-sided description of power spectral densities is to be used.\n- Objective: Derive and compute the numerical value of the RMS output noise voltage, $v_{\\text{rms}}$, in microvolts, rounded to four significant figures.\n\nThe problem is scientifically grounded, well-posed, and objective. The physical parameters are realistic, and the classical approximation is valid for the given temperature and frequency range. The problem statement is complete and internally consistent. Therefore, the problem is valid, and we may proceed with the solution.\n\nAccording to the Johnson–Nyquist theorem, the thermal noise of a resistor $R$ at absolute temperature $T$ can be modeled as a noise voltage source. The problem specifies the use of a one-sided power spectral density (PSD), which describes the noise power distribution over positive frequencies. For a resistor in the classical regime, the one-sided voltage noise PSD, denoted $S_v(f)$, is white (i.e., constant with frequency) and is given by:\n$$ S_v(f) = 4 k_B T R $$\nThe units of $S_v(f)$ are volts-squared per hertz ($\\text{V}^2/\\text{Hz}$).\n\nThis noise voltage is passed through an ideal LTI filter with a frequency response $H(f)$. The PSD of the output voltage, $S_{out}(f)$, is related to the input PSD, $S_v(f)$, by the equation:\n$$ S_{out}(f) = |H(f)|^2 S_v(f) $$\n\nThe mean-square voltage at the output, $\\langle v_{out}^2 \\rangle$, is obtained by integrating the output PSD over all frequencies. Since we are using a one-sided PSD, the integration is performed from $f=0$ to $f=\\infty$:\n$$ \\langle v_{out}^2 \\rangle = \\int_{0}^{\\infty} S_{out}(f) \\, df = \\int_{0}^{\\infty} |H(f)|^2 S_v(f) \\, df $$\n\nNow, we substitute the expressions for $S_v(f)$ and $|H(f)|$. The noise PSD is $S_v(f) = 4 k_B T R$. The filter is an ideal brick-wall filter with magnitude response $|H(f)| = 1$ for $0 \\le f \\le B$ and $|H(f)| = 0$ for $f > B$. Therefore, $|H(f)|^2$ is a rectangular function:\n$$\n|H(f)|^2 =\n\\begin{cases}\n1 & \\text{for } 0 \\le f \\le B \\\\\n0 & \\text{for } f > B\n\\end{cases}\n$$\n\nSubstituting these into the integral for the mean-square output voltage:\n$$ \\langle v_{out}^2 \\rangle = \\int_{0}^{\\infty} |H(f)|^2 (4 k_B T R) \\, df $$\nSince $4 k_B T R$ is a constant, we can pull it out of the integral:\n$$ \\langle v_{out}^2 \\rangle = 4 k_B T R \\int_{0}^{\\infty} |H(f)|^2 \\, df $$\nWe now use the definition of the filter response to evaluate the integral:\n$$ \\langle v_{out}^2 \\rangle = 4 k_B T R \\left( \\int_{0}^{B} 1 \\, df + \\int_{B}^{\\infty} 0 \\, df \\right) $$\nThe second integral is zero. The first integral evaluates to:\n$$ \\int_{0}^{B} 1 \\, df = [f]_{0}^{B} = B - 0 = B $$\nThus, the mean-square output noise voltage is:\n$$ \\langle v_{out}^2 \\rangle = 4 k_B T R B $$\n\nThe problem asks for the root-mean-square (RMS) output noise voltage, $v_{\\text{rms}}$, which is the square root of the mean-square voltage:\n$$ v_{\\text{rms}} = \\sqrt{\\langle v_{out}^2 \\rangle} = \\sqrt{4 k_B T R B} $$\n\nNow, we substitute the given numerical values into this expression:\n- $k_B = 1.380649 \\times 10^{-23}\\,\\text{J}/\\text{K}$\n- $T = 300\\,\\text{K}$\n- $R = 1000\\,\\Omega$\n- $B = 100\\,\\text{kHz} = 10^5\\,\\text{Hz}$\n\n$$ v_{\\text{rms}} = \\sqrt{4 \\times (1.380649 \\times 10^{-23}) \\times 300 \\times 1000 \\times 10^5} $$\nLet's compute the value inside the square root:\n$$ 4 \\times (1.380649 \\times 10^{-23}) \\times 300 \\times 1000 \\times 10^5 = 4 \\times 1.380649 \\times 3 \\times 10^{-23} \\times 10^2 \\times 10^3 \\times 10^5 $$\n$$ = 12 \\times 1.380649 \\times 10^{-23+2+3+5} = 16.567788 \\times 10^{-13} $$\nThis can be written in a more convenient form for taking the square root:\n$$ 1.6567788 \\times 10^{-12} \\,\\text{V}^2 $$\nNow we take the square root:\n$$ v_{\\text{rms}} = \\sqrt{1.6567788 \\times 10^{-12}} \\,\\text{V} $$\n$$ v_{\\text{rms}} = \\sqrt{1.6567788} \\times \\sqrt{10^{-12}} \\,\\text{V} $$\n$$ v_{\\text{rms}} \\approx 1.28715919 \\times 10^{-6} \\,\\text{V} $$\n\nThe problem asks for the result to be expressed in microvolts ($\\mu\\text{V}$), where $1\\,\\mu\\text{V} = 10^{-6}\\,\\text{V}$.\n$$ v_{\\text{rms}} \\approx 1.28715919 \\,\\mu\\text{V} $$\nFinally, we round the result to four significant figures. The fifth significant figure is $1$, so we round down.\n$$ v_{\\text{rms}} \\approx 1.287 \\,\\mu\\text{V} $$\nThis is the final numerical answer.",
            "answer": "$$\n\\boxed{1.287}\n$$"
        },
        {
            "introduction": "Real-world circuits often contain multiple noise sources, and a key design task is to determine which one is dominant. This problem contrasts thermal noise, which arises from equilibrium fluctuations in passive elements, with shot noise, which is due to the discrete nature of charge carriers in a current-carrying junction. By determining the crossover point where a diode's shot noise surpasses a resistor's thermal noise , you will develop insight into how operating conditions like bias current and temperature dictate a circuit's overall noise performance.",
            "id": "4304701",
            "problem": "A silicon diode is biased in direct current by an ideal voltage source through a series resistance $R_{s}$ at a uniform temperature $T$. The direct current through the diode is $I$. In the context of Electronic Design Automation (EDA) and noise-aware circuit design, consider the intrinsic random fluctuations associated with discrete carrier transport in the diode and the equilibrium thermal agitation in the series resistance. Assume the measurement is performed over a frequency band where low-frequency excess noise due to material or process nonidealities is negligible, so that the near-dc behavior can be characterized by stationary white noise contributions from carrier discreteness and thermal agitation. Starting from first principles—specifically, Poisson statistics for independent charge transport events and the fluctuation-dissipation viewpoint for equilibrium thermal agitation—derive the condition under which the diode’s current fluctuations due to carrier discreteness dominate over the current fluctuations attributable to the thermal agitation of the series resistance $R_{s}$. Determine, in closed form, the exact bias current $I_{\\star}(T,R_{s})$ at which the diode’s discreteness-induced current fluctuations just equal the series resistance’s thermal current fluctuations, so that for $I>I_{\\star}$ the discreteness-induced fluctuations exceed the thermal fluctuations. Express your final answer as a single analytic expression in terms of the Boltzmann constant $k_{B}$, the elementary charge $q$, the absolute temperature $T$, and the series resistance $R_{s}$.",
            "solution": "The problem requires the derivation of the bias current $I_{\\star}$ at which the magnitude of current fluctuations from a forward-biased diode equals that from a series resistor $R_s$ at temperature $T$. The problem specifies that for currents $I > I_{\\star}$, the diode's fluctuations should dominate. We are instructed to start from first principles for both noise mechanisms.\n\nFirst, let us formalize the noise sources. Since the problem states to consider stationary white noise contributions, we can compare the one-sided Power Spectral Densities (PSDs) of the current fluctuations, denoted by $S_i(f)$. The mean-square current fluctuation in a frequency bandwidth $\\Delta f$ is given by $\\langle i_n^2 \\rangle = S_i(f) \\Delta f$.\n\n1.  **Diode Shot Noise Current Fluctuations**\n\nThe direct current $I$ flowing through a p-n junction is the result of a large number of discrete charge carriers (electrons and holes), each with charge $q$, crossing the junction potential barrier at random intervals. As stated in the problem, this process can be modeled using Poisson statistics for independent events. The current is not a smooth flow but a sequence of charge impulses. This inherent granularity gives rise to fluctuations around the average current $I$. This phenomenon is known as shot noise.\n\nFrom the first principle of Poisson statistics for charge transport, the one-sided power spectral density of the shot noise current, $S_{i, \\text{shot}}(f)$, is given by the Schottky formula:\n$$\nS_{i, \\text{shot}}(f) = 2qI\n$$\nThis PSD is constant over a wide range of frequencies, hence it is a white noise source. The magnitude of the shot noise current fluctuations is directly proportional to the average DC current $I$.\n\n2.  **Resistor Thermal Noise Current Fluctuations**\n\nThe thermal agitation of charge carriers within a conductor in thermal equilibrium at a temperature $T$ gives rise to random voltage fluctuations across its terminals. This is known as thermal noise or Johnson-Nyquist noise. The fluctuation-dissipation theorem provides the rigorous basis for this phenomenon. For a resistance $R_s$, the one-sided PSD of the noise voltage source, $S_{v, \\text{th}}(f)$, is given by:\n$$\nS_{v, \\text{th}}(f) = 4k_{B}TR_{s}\n$$\nwhere $k_{B}$ is the Boltzmann constant. This noise source is modeled as an ideal voltage source in series with a noiseless resistor $R_s$.\n\nTo compare this with the diode's noise, which is inherently a current source, it is convenient to represent the resistor's thermal noise by its Norton equivalent. The Norton equivalent consists of a noise current source in parallel with the noiseless resistor $R_s$. The PSD of this equivalent noise current source, $S_{i, \\text{th}}(f)$, is found by dividing the voltage PSD by $R_{s}^2$:\n$$\nS_{i, \\text{th}}(f) = \\frac{S_{v, \\text{th}}(f)}{R_{s}^2} = \\frac{4k_{B}TR_{s}}{R_{s}^2} = \\frac{4k_{B}T}{R_{s}}\n$$\nUnlike shot noise, the magnitude of the thermal noise current fluctuations is independent of the DC current $I$ but depends on the temperature $T$ and the resistance $R_s$.\n\n3.  **Condition for Equality of Fluctuations**\n\nThe problem asks for the specific bias current $I_{\\star}$ where the diode's current fluctuations just equal the series resistance's thermal current fluctuations. This implies a direct comparison of the fundamental noise source strengths, as represented by their respective current PSDs. The problem states that for $I > I_{\\star}$, the shot noise should dominate, which confirms this interpretation, as $S_{i, \\text{shot}}(f)$ is proportional to $I$ while $S_{i, \\text{th}}(f)$ is constant with respect to $I$.\n\nWe set the two PSDs equal to find the crossover current $I_{\\star}$:\n$$\nS_{i, \\text{shot}}(f) \\Big|_{I=I_{\\star}} = S_{i, \\text{th}}(f)\n$$\nSubstituting the expressions for the PSDs:\n$$\n2qI_{\\star} = \\frac{4k_{B}T}{R_{s}}\n$$\n\n4.  **Derivation of the Bias Current $I_{\\star}$**\n\nSolving the equation for $I_{\\star}$ yields:\n$$\nI_{\\star} = \\frac{4k_{B}T}{2qR_{s}}\n$$\n$$\nI_{\\star} = \\frac{2k_{B}T}{qR_{s}}\n$$\nThis expression gives the exact bias current at which the magnitude of the shot noise current source equals the magnitude of the Norton equivalent thermal noise current source of the resistor. For any current $I > I_{\\star}$, the inequality $2qI > \\frac{4k_{B}T}{R_{s}}$ holds, meaning the shot noise fluctuations from the diode will indeed exceed the thermal noise fluctuations attributable to the resistor, consistent with the problem statement. The expression is in terms of the fundamental constants $k_B$, $q$, the temperature $T$, and the resistance $R_s$, as required.",
            "answer": "$$\n\\boxed{\\frac{2k_{B}T}{qR_{s}}}\n$$"
        },
        {
            "introduction": "This final practice integrates thermal, shot, and flicker noise into the comprehensive analysis of a simple amplifier, mirroring the process used by professional EDA tools. The exercise requires you to systematically sum the contributions of each independent noise source and apply the crucial technique of referring the total output noise back to the amplifier's input . Mastering the calculation of input-referred noise density is essential, as it provides a standardized figure of merit for comparing the intrinsic noisiness of different amplifier topologies.",
            "id": "4304691",
            "problem": "You are tasked to formalize and validate an input-referred noise computation for a simple amplifier consistent with an alternating current (AC) noise analysis performed in Simulation Program with Integrated Circuit Emphasis (SPICE). Consider a linear time-invariant common-source Metal-Oxide-Semiconductor (MOS) amplifier whose output node is loaded by a single resistor. The amplifier has small-signal transconductance $g_m$, drain load resistance $R_D$, and exhibits intrinsic channel thermal noise characterized by a coefficient $\\gamma$. A bias branch contributes shot noise due to a direct current $I_{\\text{bias}}$, and the device exhibits flicker noise with a coefficient $K_f$ that is inversely proportional to frequency. The ambient temperature is $T$. The midband small-signal voltage gain magnitude from input to output is $|A_v|$, and the amplifier is operated far from any poles so that frequency dependence arises only from flicker noise.\n\nFoundational base and assumptions:\n- The amplifier is linear and time-invariant, and the output node is dominated by a resistive load $R_D$ so that small-signal voltage gain magnitude is $|A_v|$ and the current-to-voltage conversion at the output is governed by $R_D$.\n- Resistive thermal noise is modeled by an equivalent voltage source with one-sided Power Spectral Density (PSD) given by $$S_{v,R} = 4 k_{\\mathrm{B}} T R$$ where $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the absolute temperature, and $R$ is the resistance value in ohms.\n- MOS channel thermal noise is modeled by a drain current noise source with one-sided PSD $$S_{i,\\mathrm{th}} = 4 k_{\\mathrm{B}} T \\gamma g_m$$ where $\\gamma$ is the excess noise factor and $g_m$ is the transconductance.\n- Shot noise is modeled by a Poisson process with one-sided current PSD $$S_{i,\\mathrm{sh}} = 2 q I_{\\mathrm{bias}}$$ where $q$ is the elementary charge and $I_{\\mathrm{bias}}$ is the direct current causing carrier injection.\n- Flicker noise (one-over-$f$ noise) is modeled here by a drain current noise source with one-sided PSD $$S_{i,\\mathrm{f}}(f) = \\frac{K_f}{f}$$ where $K_f$ is a device-dependent coefficient and $f$ is frequency in hertz.\n\nYour goals:\n1. Express how to compute the output-referred voltage noise PSD at the amplifier output by appropriately combining the independent noise sources listed above under the assumption that the current noise sources convert to output voltage noise through the load resistance.\n2. From the output-referred voltage noise PSD and the small-signal gain magnitude $|A_v|$, derive the input-referred voltage noise PSD and its square-root spectral density (voltage noise density).\n3. Provide an algorithm to numerically compute the input-referred voltage noise density at a specified frequency $f$ for given parameters $(g_m, R_D, \\gamma, T, I_{\\mathrm{bias}}, K_f)$.\n4. Validate the expression against hand calculations by computing numerical results for the following test suite. For each case, compute the input-referred voltage noise density and express the final numeric answer in nanovolts per square root hertz (nV/$\\sqrt{\\mathrm{Hz}}$), rounded to six decimal places.\n\nUse the following constants in all calculations:\n- Boltzmann constant: $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$.\n- Elementary charge: $q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$.\n\nTest suite (each tuple is $(g_m\\ \\mathrm{[S]}, R_D\\ \\mathrm{[\\Omega]}, \\gamma, T\\ \\mathrm{[K]}, I_{\\mathrm{bias}}\\ \\mathrm{[A]}, K_f\\ \\mathrm{[A^2]}, f\\ \\mathrm{[Hz]})$):\n- Case 1 (balanced midband, nonzero shot): $(5.0\\times 10^{-3}, 2000, 0.7, 300, 100.0\\times 10^{-6}, 1.0\\times 10^{-22}, 10.0\\times 10^{3})$.\n- Case 2 (low frequency, flicker-dominated): $(5.0\\times 10^{-3}, 2000, 0.7, 300, 0.0, 1.0\\times 10^{-18}, 1.0)$.\n- Case 3 (high frequency, negligible flicker, zero shot): $(5.0\\times 10^{-3}, 2000, 0.7, 300, 0.0, 1.0\\times 10^{-22}, 100.0\\times 10^{6})$.\n- Case 4 (resistor-dominated edge, small load, zero shot and flicker): $(5.0\\times 10^{-3}, 500, 0.7, 300, 0.0, 0.0, 10.0\\times 10^{3})$.\n\nOutput specification:\n- Your program should produce a single line of output containing the input-referred voltage noise densities for the four cases as a comma-separated list enclosed in square brackets, in units of nV/$\\sqrt{\\mathrm{Hz}}$, each rounded to six decimal places (for example, $$[x_1,x_2,x_3,x_4]$$ where each $x_i$ is a float).",
            "solution": "The problem as stated will first be subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\nThe problem provides the following data, definitions, and conditions for a common-source MOS amplifier:\n- Small-signal transconductance: $g_m$\n- Drain load resistance: $R_D$\n- MOS channel thermal noise coefficient: $\\gamma$\n- Ambient temperature: $T$\n- Bias branch direct current: $I_{\\text{bias}}$\n- Flicker noise coefficient: $K_f$\n- Small-signal voltage gain magnitude: $|A_v|$\n- Frequency of interest: $f$\n- Boltzmann constant: $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$\n- Elementary charge: $q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n\nThe one-sided Power Spectral Densities (PSDs) for the noise sources are defined as:\n- Resistive thermal noise (voltage): $S_{v,R} = 4 k_{\\mathrm{B}} T R$\n- MOS channel thermal noise (current): $S_{i,\\mathrm{th}} = 4 k_{\\mathrm{B}} T \\gamma g_m$\n- Shot noise (current): $S_{i,\\mathrm{sh}} = 2 q I_{\\text{bias}}$\n- Flicker noise (current): $S_{i,\\mathrm{f}}(f) = \\frac{K_f}{f}$\n\nThe test suite parameters for $(g_m, R_D, \\gamma, T, I_{\\text{bias}}, K_f, f)$ are:\n- Case 1: $(5.0\\times 10^{-3}\\ \\mathrm{S}, 2000\\ \\mathrm{\\Omega}, 0.7, 300\\ \\mathrm{K}, 100.0\\times 10^{-6}\\ \\mathrm{A}, 1.0\\times 10^{-22}\\ \\mathrm{A^2}, 10.0\\times 10^{3}\\ \\mathrm{Hz})$\n- Case 2: $(5.0\\times 10^{-3}\\ \\mathrm{S}, 2000\\ \\mathrm{\\Omega}, 0.7, 300\\ \\mathrm{K}, 0.0\\ \\mathrm{A}, 1.0\\times 10^{-18}\\ \\mathrm{A^2}, 1.0\\ \\mathrm{Hz})$\n- Case 3: $(5.0\\times 10^{-3}\\ \\mathrm{S}, 2000\\ \\mathrm{\\Omega}, 0.7, 300\\ \\mathrm{K}, 0.0\\ \\mathrm{A}, 1.0\\times 10^{-22}\\ \\mathrm{A^2}, 100.0\\times 10^{6}\\ \\mathrm{Hz})$\n- Case 4: $(5.0\\times 10^{-3}\\ \\mathrm{S}, 500\\ \\mathrm{\\Omega}, 0.7, 300\\ \\mathrm{K}, 0.0\\ \\mathrm{A}, 0.0\\ \\mathrm{A^2}, 10.0\\times 10^{3}\\ \\mathrm{Hz})$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is validated against the required criteria.\n- **Scientifically Grounded**: The problem is founded on the standard, universally accepted models for thermal, shot, and flicker noise in semiconductor devices. The provided formulae for the Power Spectral Densities are correct and form the basis of noise analysis in tools like SPICE.\n- **Well-Posed**: The problem is well-posed. It provides all necessary parameters and physical constants to compute a unique numerical answer for each test case. The small-signal gain $|A_v|$ is mentioned, and its value for a common-source amplifier with a resistive load $R_D$ is implicitly defined by the context as $|A_v| = g_m R_D$. This is a standard simplification and is consistent with the problem statement that \"the current-to-voltage conversion at the output is governed by $R_D$.\"\n- **Objective**: The problem is stated in precise, objective, and unambiguous scientific language.\n- **Completeness and Consistency**: The problem is self-contained and free of contradictions. The given parameters and definitions are sufficient for a complete solution.\n- **Realism**: The numerical values in the test suite are physically realistic for MOS transistors under various operating conditions.\n- **Conclusion**: The problem is free of any of the invalidating flaws.\n\n### Step 3: Verdict and Action\nThe problem is\n**valid**. A complete, reasoned solution will be provided.\n\n### Solution Derivation\n\nThe total input-referred noise of an amplifier is determined by calculating the contribution of each noise source at the output and then referring this total output noise back to the input. We assume all noise sources are statistically independent (uncorrelated), and thus their power spectral densities sum.\n\n**1. Output-Referred Voltage Noise Power Spectral Density ($S_{v, \\text{out}}(f)$)**\n\nThe total voltage noise PSD at the output, $S_{v, \\text{out}}(f)$, is the linear sum of the PSDs from each noise source.\n\n- **Load Resistor Thermal Noise**: The resistor $R_D$ at the output contributes voltage noise directly. Its PSD is given as:\n$$ S_{v, R_D}(f) = 4 k_{\\mathrm{B}} T R_D $$\n- **MOS Channel Thermal Noise**: The MOS transistor's channel thermal noise is modeled as a current source with PSD $S_{i,\\mathrm{th}} = 4 k_{\\mathrm{B}} T \\gamma g_m$. This noise current flows through the output resistance $R_D$, producing an output voltage noise. The resulting voltage PSD is:\n$$ S_{v, \\text{out, th}}(f) = S_{i,\\mathrm{th}} \\cdot R_D^2 = (4 k_{\\mathrm{B}} T \\gamma g_m) R_D^2 $$\n- **Shot Noise**: The bias current $I_{\\text{bias}}$ contributes shot noise, modeled as a current source with PSD $S_{i,\\mathrm{sh}} = 2 q I_{\\text{bias}}$. This noise current also passes through $R_D$, contributing a voltage PSD at the output of:\n$$ S_{v, \\text{out, sh}}(f) = S_{i,\\mathrm{sh}} \\cdot R_D^2 = (2 q I_{\\text{bias}}) R_D^2 $$\n- **Flicker Noise**: The transistor's flicker noise is a frequency-dependent current source with PSD $S_{i,\\mathrm{f}}(f) = K_f/f$. Its contribution to the output voltage PSD is:\n$$ S_{v, \\text{out, f}}(f) = S_{i,\\mathrm{f}}(f) \\cdot R_D^2 = \\frac{K_f}{f} R_D^2 $$\n\nThe total output-referred voltage noise PSD is the sum of these components:\n$$ S_{v, \\text{out}}(f) = S_{v, R_D}(f) + S_{v, \\text{out, th}}(f) + S_{v, \\text{out, sh}}(f) + S_{v, \\text{out, f}}(f) $$\n$$ S_{v, \\text{out}}(f) = 4 k_{\\mathrm{B}} T R_D + (4 k_{\\mathrm{B}} T \\gamma g_m) R_D^2 + (2 q I_{\\text{bias}}) R_D^2 + \\frac{K_f}{f} R_D^2 $$\n\n**2. Input-Referred Voltage Noise Power Spectral Density ($S_{v, \\text{in}}(f)$)**\n\nTo refer the total output noise PSD to the input, we divide by the square of the amplifier's small-signal voltage gain magnitude, $|A_v|^2$. For a common-source amplifier with a load resistor $R_D$ and negligible transistor output resistance, the gain is given by $|A_v| = g_m R_D$. Therefore, $|A_v|^2 = (g_m R_D)^2 = g_m^2 R_D^2$.\n\nThe input-referred voltage noise PSD, $S_{v, \\text{in}}(f)$, is:\n$$ S_{v, \\text{in}}(f) = \\frac{S_{v, \\text{out}}(f)}{|A_v|^2} = \\frac{4 k_{\\mathrm{B}} T R_D + (4 k_{\\mathrm{B}} T \\gamma g_m) R_D^2 + (2 q I_{\\text{bias}}) R_D^2 + \\frac{K_f}{f} R_D^2}{g_m^2 R_D^2} $$\nDividing each term in the numerator by the denominator $g_m^2 R_D^2$ yields the individual input-referred contributions:\n$$ S_{v, \\text{in}}(f) = \\frac{4 k_{\\mathrm{B}} T R_D}{g_m^2 R_D^2} + \\frac{4 k_{\\mathrm{B}} T \\gamma g_m R_D^2}{g_m^2 R_D^2} + \\frac{2 q I_{\\text{bias}} R_D^2}{g_m^2 R_D^2} + \\frac{K_f R_D^2}{f \\cdot g_m^2 R_D^2} $$\nSimplifying this expression gives the final formula for the total input-referred voltage noise PSD:\n$$ S_{v, \\text{in}}(f) = \\frac{4 k_{\\mathrm{B}} T \\gamma}{g_m} + \\frac{4 k_{\\mathrm{B}} T}{g_m^2 R_D} + \\frac{2 q I_{\\text{bias}}}{g_m^2} + \\frac{K_f}{f \\cdot g_m^2} $$\nThe terms correspond to the input-referred noise from: channel thermal, load resistor thermal, shot, and flicker noise, respectively.\n\n**3. Input-Referred Voltage Noise Density ($v_{n, \\text{in}}(f)$)**\n\nThe input-referred voltage noise density, typically expressed in units of $\\mathrm{V}/\\sqrt{\\mathrm{Hz}}$, is the square root of the PSD:\n$$ v_{n, \\text{in}}(f) = \\sqrt{S_{v, \\text{in}}(f)} = \\sqrt{\\frac{4 k_{\\mathrm{B}} T \\gamma}{g_m} + \\frac{4 k_{\\mathrm{B}} T}{g_m^2 R_D} + \\frac{2 q I_{\\text{bias}}}{g_m^2} + \\frac{K_f}{f \\cdot g_m^2}} $$\n\nThis final expression provides a complete algorithm for computing the required value. The following program implements this formula to calculate the numerical results for the provided test suite. The final answer is converted to nanovolts per square root hertz ($\\mathrm{nV}/\\sqrt{\\mathrm{Hz}}$) by multiplying the result in $\\mathrm{V}/\\sqrt{\\mathrm{Hz}}$ by $10^9$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the noise analysis problem for the given test cases.\n    \"\"\"\n\n    # Define physical constants as specified in the problem.\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n    Q = 1.602176634e-19  # Elementary charge in C\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (gm [S], RD [Ohm], gamma, T [K], Ibias [A], Kf [A^2], f [Hz])\n    test_cases = [\n        (5.0e-3, 2000, 0.7, 300, 100.0e-6, 1.0e-22, 10.0e3),\n        (5.0e-3, 2000, 0.7, 300, 0.0, 1.0e-18, 1.0),\n        (5.0e-3, 2000, 0.7, 300, 0.0, 1.0e-22, 100.0e6),\n        (5.0e-3, 500, 0.7, 300, 0.0, 0.0, 10.0e3),\n    ]\n\n    def calculate_noise_density(gm, rd, gamma, temp, ibias, kf, freq):\n        \"\"\"\n        Computes the input-referred voltage noise density.\n\n        The total input-referred voltage noise Power Spectral Density (PSD) is the\n        sum of the individual contributions from each noise source:\n        S_v_in(f) = S_channel_th + S_load_th + S_shot + S_flicker\n\n        where:\n        S_channel_th = (4 * KB * T * gamma) / gm\n        S_load_th    = (4 * KB * T) / (gm^2 * rd)\n        S_shot       = (2 * Q * ibias) / gm^2\n        S_flicker    = Kf / (f * gm^2)\n        \n        The noise density is the square root of the total PSD.\n        \"\"\"\n        gm_sq = gm**2\n        four_kb_t = 4 * KB * temp\n\n        # Calculate each component of the input-referred noise PSD\n        s_channel_th = (four_kb_t * gamma) / gm\n        s_load_th = four_kb_t / (gm_sq * rd)\n        s_shot = (2 * Q * ibias) / gm_sq\n        s_flicker = kf / (freq * gm_sq)\n        \n        # Total input-referred voltage noise PSD (V^2/Hz)\n        s_v_in_total = s_channel_th + s_load_th + s_flicker\n\n        # Input-referred voltage noise density (V/sqrt(Hz))\n        v_n_in = np.sqrt(s_v_in_total)\n\n        # Convert to nV/sqrt(Hz)\n        v_n_in_nanovolts = v_n_in * 1e9\n\n        return v_n_in_nanovolts\n\n    results = []\n    for case in test_cases:\n        gm, rd, gamma, temp, ibias, kf, freq = case\n        result = calculate_noise_density(gm, rd, gamma, temp, ibias, kf, freq)\n        # Round to six decimal places as required\n        results.append(round(result, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}