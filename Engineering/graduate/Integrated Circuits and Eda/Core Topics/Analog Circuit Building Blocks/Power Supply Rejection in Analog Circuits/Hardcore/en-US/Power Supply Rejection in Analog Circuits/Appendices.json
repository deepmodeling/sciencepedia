{
    "hands_on_practices": [
        {
            "introduction": "Understanding Power Supply Rejection Ratio (PSRR) begins with a firm grasp of how to model and analyze the propagation of supply noise. This first exercise provides a foundational practice in translating a physical, small-signal model of an amplifier's output stage into a mathematical transfer function, $H_{V_{DD}\\to V_{out}}(j\\omega)$. By applying Kirchhoff's Current Law (KCL) and the principles of linear circuit analysis, you will derive and compute the frequency-dependent nature of supply noise coupling, a core skill for any analog designer .",
            "id": "4290942",
            "problem": "You are tasked with formalizing and simulating an alternating current (AC) testbench to measure the power supply rejection transfer function from the positive supply node to an analog circuit output node, denoted as $H_{V_{DD}\\to V_{out}}(j\\omega)$, under the framework of Integrated Circuit design and Electronic Design Automation (EDA). The testbench must maintain correct direct current (DC) bias by using an AC source with zero DC offset superimposed on a fixed DC supply. The small-signal model to be simulated should be fully derived from first principles using Kirchhoff’s laws and linear sinusoidal steady-state analysis.\n\nUse the following physically plausible and self-consistent small-signal model of the output node:\n\n- The output node $V_{out}$ is connected to ground through an effective load resistance $R_L$, an internal output resistance $r_o$, and a load capacitance $C_L$, all in parallel. This defines the output admittance to ground $Y_o(j\\omega)$.\n- Finite power supply rejection is represented by a feedthrough path between the supply node $V_{DD}$ and the output node $V_{out}$ consisting of a resistive element $R_{ps}$ in parallel with a capacitive element $C_{ps}$. This defines the coupling admittance $Y_{ps}(j\\omega)$ between $V_{DD}$ and $V_{out}$.\n- An ideal small-signal AC source is injected at $V_{DD}$ with zero DC value on top of a fixed DC bias $V_{DD0}$, which does not enter the small-signal equations (superposition principle).\n\nStarting only from fundamental definitions and laws appropriate for analog circuits:\n- Kirchhoff’s Current Law (KCL) at a node,\n- Sinusoidal steady-state for linear time-invariant systems with $s=j\\omega$,\n- Complex impedance of a resistor $Z_R=R$ and a capacitor $Z_C=1/(j\\omega C)$, and admittance $Y=1/Z$,\n\nderive the expression for $H_{V_{DD}\\to V_{out}}(j\\omega)$ and implement a program that computes its magnitude $\\lvert H_{V_{DD}\\to V_{out}}(j\\omega)\\rvert$ for each test case. You must treat any parameter equal to $+\\infty$ as the corresponding admittance equal to $0$.\n\nUse the following definitions:\n- Output admittance to ground: $Y_o(j\\omega)=\\dfrac{1}{R_L}+\\dfrac{1}{r_o}+j\\omega C_L$.\n- Coupling admittance between $V_{DD}$ and $V_{out}$: $Y_{ps}(j\\omega)=\\dfrac{1}{R_{ps}}+j\\omega C_{ps}$.\n\nYour program must evaluate the magnitude $\\lvert H_{V_{DD}\\to V_{out}}(j\\omega)\\rvert$ at the specified frequencies and parameter sets given below. All resistances must be in ohms, all capacitances must be in farads, all frequencies must be in hertz, and $V_{DD0}$ in volts. The transfer function magnitude is dimensionless in volts-per-volt ($\\mathrm{V}/\\mathrm{V}$). Angles are not part of the requested output, so no angle unit is needed.\n\nTest suite (each case is $(R_L,r_o,C_L,R_{ps},C_{ps},f)$):\n- Case $1$ (general midband behavior): ($10000$, $20000$, $10\\times 10^{-12}$, $200000$, $0.2\\times 10^{-12}$, $10000$).\n- Case $2$ (near-DC boundary): ($10000$, $20000$, $10\\times 10^{-12}$, $200000$, $0.2\\times 10^{-12}$, $0.1$).\n- Case $3$ (high-frequency feedthrough): ($10000$, $20000$, $10\\times 10^{-12}$, $200000$, $0.2\\times 10^{-12}$, $100000000$).\n- Case $4$ (no resistive feedthrough): ($10000$, $20000$, $10\\times 10^{-12}$, $+\\infty$, $0.2\\times 10^{-12}$, $0.1$).\n- Case $5$ (no capacitive feedthrough): ($10000$, $20000$, $10\\times 10^{-12}$, $200000$, $0$, $1000000$).\n- Case $6$ (nearly open output, purely resistive feedthrough): ($+\\infty$, $+\\infty$, $0$, $1000$, $0$, $1000$).\n\nAssume a fixed DC supply $V_{DD0}=$1.8$ volts and zero DC perturbation for the AC source.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,\\dots]$), where each $result_k$ is the magnitude $\\lvert H_{V_{DD}\\to V_{out}}(j\\omega_k)\\rvert$ for the corresponding test case, expressed as a decimal in $\\mathrm{V}/\\mathrm{V}$ with no unit symbol.",
            "solution": "The problem statement is valid. It is scientifically grounded in the principles of linear circuit analysis, well-posed with a complete and consistent set of parameters, and objective in its formulation. The task is to derive the power supply rejection transfer function for a given small-signal model and compute its magnitude for several test cases.\n\nThe derivation of the transfer function $H_{V_{DD}\\to V_{out}}(j\\omega) = v_{out}(j\\omega)/v_{dd}(j\\omega)$ proceeds from first principles, specifically Kirchhoff's Current Law (KCL), applied to the small-signal model of the circuit in the frequency domain.\n\nThe small-signal model consists of three nodes: the supply node $V_{DD}$ (where the small-signal input $v_{dd}$ is applied), the output node $V_{out}$ (where the small-signal output $v_{out}$ is measured), and the ground reference node, which is at a potential of $0$ V.\n\nThe components are modeled by their admittances in the sinusoidal steady-state, where the complex frequency is $s = j\\omega$. The angular frequency $\\omega$ is related to the frequency $f$ in hertz by $\\omega = 2\\pi f$.\n\nThe model specifies two composite admittances:\n1.  The coupling admittance, $Y_{ps}(j\\omega)$, is connected between the supply node $V_{DD}$ and the output node $V_{out}$. It is composed of a resistor $R_{ps}$ in parallel with a capacitor $C_{ps}$. The admittance of a parallel combination is the sum of the individual admittances.\n    $$Y_{ps}(j\\omega) = \\frac{1}{R_{ps}} + \\frac{1}{Z_{C_{ps}}} = \\frac{1}{R_{ps}} + j\\omega C_{ps}$$\n    The problem statement provides this definition explicitly. Cases where a resistance is infinite, e.g., $R_{ps} = +\\infty$, correspond to a zero conductance term, $\\frac{1}{R_{ps}} = 0$.\n\n2.  The output admittance to ground, $Y_o(j\\omega)$, is connected between the output node $V_{out}$ and ground. It is composed of a load resistor $R_L$, an internal output resistance $r_o$, and a load capacitor $C_L$, all in parallel.\n    $$Y_o(j\\omega) = \\frac{1}{R_L} + \\frac{1}{r_o} + \\frac{1}{Z_{C_L}} = \\frac{1}{R_L} + \\frac{1}{r_o} + j\\omega C_L$$\n    This definition is also provided explicitly in the problem statement.\n\nTo find the transfer function, we apply KCL at the output node, $V_{out}$. The sum of all currents leaving the node must be zero. Let the small-signal phasor voltages at the supply and output nodes be $v_{dd}$ and $v_{out}$, respectively.\n\nThe current flowing from the output node $V_{out}$ to the supply node $V_{DD}$ through the admittance $Y_{ps}(j\\omega)$ is given by Ohm's law in admittance form:\n$$I_{out \\to dd} = (v_{out} - v_{dd}) Y_{ps}(j\\omega)$$\n\nThe current flowing from the output node $V_{out}$ to ground through the admittance $Y_o(j\\omega)$ is:\n$$I_{out \\to gnd} = (v_{out} - 0) Y_o(j\\omega) = v_{out} Y_o(j\\omega)$$\n\nAssuming no other connections to the output node, the KCL equation at node $V_{out}$ is:\n$$I_{out \\to dd} + I_{out \\to gnd} = 0$$\n$$(v_{out} - v_{dd}) Y_{ps}(j\\omega) + v_{out} Y_o(j\\omega) = 0$$\n\nTo derive the transfer function $H_{V_{DD}\\to V_{out}}(j\\omega) = v_{out}/v_{dd}$, we rearrange the equation to solve for this ratio:\n$$v_{out} Y_{ps}(j\\omega) - v_{dd} Y_{ps}(j\\omega) + v_{out} Y_o(j\\omega) = 0$$\n$$v_{out} (Y_{ps}(j\\omega) + Y_o(j\\omega)) = v_{dd} Y_{ps}(j\\omega)$$\n$$\\frac{v_{out}}{v_{dd}} = \\frac{Y_{ps}(j\\omega)}{Y_{ps}(j\\omega) + Y_o(j\\omega)}$$\n\nThis gives the expression for the complex transfer function $H_{V_{DD}\\to V_{out}}(j\\omega)$. The structure is that of an admittance divider.\n\nNow, we substitute the expressions for $Y_{ps}(j\\omega)$ and $Y_o(j\\omega)$:\n$$H_{V_{DD}\\to V_{out}}(j\\omega) = \\frac{\\frac{1}{R_{ps}} + j\\omega C_{ps}}{(\\frac{1}{R_{ps}} + j\\omega C_{ps}) + (\\frac{1}{R_L} + \\frac{1}{r_o} + j\\omega C_L)}$$\nCombining real and imaginary parts in the denominator:\n$$H_{V_{DD}\\to V_{out}}(j\\omega) = \\frac{\\frac{1}{R_{ps}} + j\\omega C_{ps}}{\\left(\\frac{1}{R_{ps}} + \\frac{1}{R_L} + \\frac{1}{r_o}\\right) + j\\omega (C_{ps} + C_L)}$$\n\nTo simplify the notation, let's define the following aggregate parameters:\n-   Power supply feedthrough conductance: $G_{ps} = \\frac{1}{R_{ps}}$\n-   Total output conductance: $G_{out} = \\frac{1}{R_L} + \\frac{1}{r_o}$\n-   Total conductance at the output node: $G_{total} = G_{ps} + G_{out} = \\frac{1}{R_{ps}} + \\frac{1}{R_L} + \\frac{1}{r_o}$\n-   Total capacitance at the output node: $C_{total} = C_{ps} + C_L$\n\nThe transfer function can then be written in a more compact form:\n$$H(j\\omega) = \\frac{G_{ps} + j\\omega C_{ps}}{G_{total} + j\\omega C_{total}}$$\n\nThe problem requires calculating the magnitude of this transfer function, $\\lvert H(j\\omega) \\rvert$. The magnitude of a complex number $z = x + iy$ is $\\lvert z \\rvert = \\sqrt{x^2 + y^2}$. Applying this to the ratio of two complex numbers, $\\lvert z_1/z_2 \\rvert = \\lvert z_1 \\rvert / \\lvert z_2 \\rvert$:\n$$\\lvert H(j\\omega) \\rvert = \\frac{\\lvert G_{ps} + j\\omega C_{ps} \\rvert}{\\lvert G_{total} + j\\omega C_{total} \\rvert}$$\n$$\\lvert H(j\\omega) \\rvert = \\frac{\\sqrt{G_{ps}^2 + (\\omega C_{ps})^2}}{\\sqrt{G_{total}^2 + (\\omega C_{total})^2}}$$\n\nThis is the final expression used for the computation. For each test case, the parameters $(R_L, r_o, C_L, R_{ps}, C_{ps}, f)$ are used to calculate $G_{ps}$, $G_{total}$, $C_{total}$, and $\\omega = 2\\pi f$, which are then substituted into this formula to find the magnitude of the transfer function. The DC supply voltage $V_{DD0} = 1.8$ V is irrelevant for this small-signal AC analysis, as confirmed by the derivation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the magnitude of the power supply rejection transfer function\n    for a given set of circuit parameters and frequencies.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (R_L, r_o, C_L, R_ps, C_ps, f)\n    # R in Ohms, C in Farads, f in Hertz.\n    test_cases = [\n        # Case 1 (general midband behavior)\n        (10000, 20000, 10e-12, 200000, 0.2e-12, 10000),\n        # Case 2 (near-DC boundary)\n        (10000, 20000, 10e-12, 200000, 0.2e-12, 0.1),\n        # Case 3 (high-frequency feedthrough)\n        (10000, 20000, 10e-12, 200000, 0.2e-12, 100000000),\n        # Case 4 (no resistive feedthrough)\n        (10000, 20000, 10e-12, np.inf, 0.2e-12, 0.1),\n        # Case 5 (no capacitive feedthrough)\n        (10000, 20000, 10e-12, 200000, 0, 1000000),\n        # Case 6 (nearly open output, purely resistive feedthrough)\n        (np.inf, np.inf, 0, 1000, 0, 1000),\n    ]\n\n    results = []\n    for case in test_cases:\n        R_L, r_o, C_L, R_ps, C_ps, f = case\n\n        # Calculate angular frequency omega from frequency f\n        omega = 2 * np.pi * f\n\n        # Calculate admittances (conductances and susceptances)\n        # Handle infinite resistance cases, which result in zero conductance.\n        # Python's float division `1 / np.inf` correctly yields `0.0`.\n        G_ps = 1 / R_ps\n        G_out = (1 / R_L) + (1 / r_o)\n        \n        # Total conductance and capacitance at the output node\n        G_total = G_ps + G_out\n        C_total = C_ps + C_L\n\n        # The transfer function is H(jw) = (G_ps + jw*C_ps) / (G_total + jw*C_total).\n        # We can use numpy's complex number handling to simplify the calculation\n        # of the magnitude.\n        \n        # Numerator of the transfer function\n        numerator_complex = G_ps + 1j * omega * C_ps\n        \n        # Denominator of the transfer function\n        denominator_complex = G_total + 1j * omega * C_total\n\n        # The magnitude of the transfer function |H(jw)|\n        # Check for denominator becoming zero to avoid division by zero.\n        # This shouldn't happen with passive networks unless all components\n        # have zero admittance.\n        if np.abs(denominator_complex) == 0.0:\n            # For the special case where the denominator is zero,\n            # this implies the output is not connected to anything.\n            # If the numerator is also zero, H is undefined (e.g., 0/0).\n            # If numerator is non-zero, H is infinite.\n            # In this problem's context with passive components, a zero\n            # denominator only happens if G_total=0 and C_total=0 (or omega=0).\n            # Case 6: Y_o = 0. H = Y_ps / (Y_ps + 0) = 1. Denominator is not 0.\n            # This path is unlikely to be taken by the given test cases.\n            # We'll assign a value based on physical limits.\n            if np.abs(numerator_complex) == 0.0:\n                # Corresponds to 0/0. Physical interpretation can be ambiguous.\n                # A value of 0 is a reasonable default.\n                magnitude = 0.0 \n            else:\n                magnitude = np.inf\n        else:\n            magnitude = np.abs(numerator_complex) / np.abs(denominator_complex)\n        \n        results.append(magnitude)\n\n    # Final print statement in the exact required format.\n    # The results are formatted to avoid ambiguity in representation.\n    # Using a general representation that avoids scientific notation for\n    # small differences in magnitude representation.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While direct analysis is fundamental, the power of negative feedback in suppressing disturbances is a more general and insightful concept. This practice moves from a specific circuit model to a generalized feedback system, demonstrating how to derive the supply-to-output transfer function in terms of loop transmission, $L(s)$. This exercise solidifies the critical relationship $H(s) = \\frac{\\alpha}{1 + L(s)}$, revealing that high loop gain is the primary mechanism for achieving high PSRR, a cornerstone of robust analog design .",
            "id": "4290935",
            "problem": "Consider a linear negative-feedback analog amplifier modeled at small signal as a two-port with a single summing junction and a single forward controlled source. The forward path is a voltage-controlled voltage source with open-loop transfer function $A(s)$, and the feedback path is an ideal passive voltage divider with feedback factor $\\beta$. The reference input is nulled to zero so that only the power-supply ripple appears as a disturbance. The power-supply ripple is modeled as a small-signal source $v_{s}$ that couples additively into the amplifier output node through a dimensionless feedthrough coefficient $\\alpha$, so that the small-signal output voltage is the sum of the forward-path controlled-source contribution and the coupled power-supply ripple. Assume the load is sufficiently large that it does not perturb $A(s)$.\n\nYou are given the following parameterization:\n- The forward-path open-loop transfer is a dominant-pole model $A(s) = \\dfrac{A_{0}}{1 + s/\\omega_{p}}$ with $A_{0} = 10^{5}$ and $\\omega_{p} = 2\\pi \\times 10^{2}$.\n- The feedback network is a resistive divider with $R_{1} = 9~\\mathrm{k}\\Omega$ from the output to the summing node and $R_{2} = 1~\\mathrm{k}\\Omega$ from the summing node to ground, so that $\\beta = \\dfrac{R_{2}}{R_{1} + R_{2}}$.\n- The output coupling of the power-supply ripple is $v_{\\text{out}}(s) = A(s)\\,v_{e}(s) + \\alpha\\,v_{s}(s)$ with $\\alpha = 10^{-2}$, where $v_{e}(s)$ is the error signal at the summing node.\n\nStarting only from the fundamental two-port feedback definitions for the summing junction and the superposition of sources, and without assuming any pre-known sensitivity-function identities, derive the closed-form analytic expression for the power-supply disturbance-to-output transfer $H_{V_{s}\\to V_{\\text{out}}}(s) \\triangleq \\dfrac{v_{\\text{out}}(s)}{v_{s}(s)}$.\n\nThen, using the Middlebrook injection method (series test-source injection with the loop maintained) to compute the loop transmission, determine the loop transmission $L(s)$ for this two-port and validate that your derived $H_{V_{s}\\to V_{\\text{out}}}(s)$ is consistent with the relationship implied by the loop transmission. Express your final answer as a single simplified analytic expression for $H_{V_{s}\\to V_{\\text{out}}}(s)$ in terms of $s$. No rounding is required, and no physical units should be included in the final expression.\n\nFor context, Power Supply Rejection Ratio (PSRR) is defined as the reciprocal magnitude of $H_{V_{s}\\to V_{\\text{out}}}(j\\omega)$, and Middlebrook injection is a standard technique in Electronic Design Automation (EDA) for measuring loop transmission in feedback systems without disturbing the operating point.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- **Model**: A linear negative-feedback analog amplifier.\n- **Topology**: Two-port with a single summing junction and a single forward controlled source.\n- **Forward Path**: Voltage-controlled voltage source with transfer function $A(s) = \\dfrac{A_{0}}{1 + s/\\omega_{p}}$.\n- **Feedback Path**: Ideal passive voltage divider with feedback factor $\\beta = \\dfrac{R_{2}}{R_{1} + R_{2}}$.\n- **Input**: The reference input is nulled to zero, $v_{ref}(s) = 0$.\n- **Disturbance Model**: A small-signal power-supply ripple source $v_{s}(s)$ couples to the output.\n- **Output Equation**: The small-signal output voltage is given by the superposition $v_{\\text{out}}(s) = A(s)\\,v_{e}(s) + \\alpha\\,v_{s}(s)$, where $v_{e}(s)$ is the error signal at the summing node.\n- **Load Assumption**: The load is large enough to not affect $A(s)$.\n- **Parameters**:\n  - $A_{0} = 10^{5}$\n  - $\\omega_{p} = 2\\pi \\times 10^{2}$\n  - $R_{1} = 9~\\mathrm{k}\\Omega$\n  - $R_{2} = 1~\\mathrm{k}\\Omega$\n  - $\\alpha = 10^{-2}$\n- **Task 1**: Derive the closed-form analytic expression for the power-supply disturbance-to-output transfer function $H_{V_{s}\\to V_{\\text{out}}}(s) \\triangleq \\dfrac{v_{\\text{out}}(s)}{v_{s}(s)}$ from fundamental definitions.\n- **Task 2**: Determine the loop transmission $L(s)$ using the Middlebrook injection method concept.\n- **Task 3**: Validate that the derived $H_{V_{s}\\to V_{\\text{out}}}(s)$ is consistent with the standard feedback theory relationship involving $L(s)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n- **Scientific Grounding**: The problem describes a standard textbook model for a negative-feedback amplifier subject to power-supply noise. The concepts of loop gain, transfer functions, and sensitivity are fundamental to analog circuit design and control theory. All models and parameters are scientifically sound.\n- **Well-Posedness**: The problem is clearly defined with all necessary parameters provided. It asks for the derivation of a specific transfer function, which leads to a unique solution.\n- **Objectivity**: The problem is stated using precise, objective technical language, free from ambiguity or subjective claims.\n\nThe problem does not exhibit any of the listed flaws (e.g., scientific unsoundness, incompleteness, contradiction, or infeasibility). The component values are realistic for a standard operational amplifier circuit.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be provided.\n\n### Solution Derivation\nThe primary goal is to derive the transfer function $H_{V_{s}\\to V_{\\text{out}}}(s) = \\dfrac{v_{\\text{out}}(s)}{v_{s}(s)}$. This will be done in three parts as requested: direct derivation, determination of loop transmission, and validation.\n\n**Part 1: Direct Derivation of the Transfer Function**\n\nWe begin with the fundamental equations describing the system, as provided in the problem statement.\nThe output voltage $v_{\\text{out}}(s)$ is given by the superposition of the amplified error signal and the coupled supply noise:\n$$v_{\\text{out}}(s) = A(s)\\,v_{e}(s) + \\alpha\\,v_{s}(s)$$\nThe error signal $v_{e}(s)$ is the output of the summing junction. In a negative feedback configuration, the error signal is the difference between the reference input $v_{ref}(s)$ and the feedback signal $v_{f}(s)$:\n$$v_{e}(s) = v_{ref}(s) - v_{f}(s)$$\nThe problem states that the reference input is nulled, so $v_{ref}(s) = 0$.\n$$v_{e}(s) = - v_{f}(s)$$\nThe feedback signal $v_{f}(s)$ is generated by the feedback network, which samples the output voltage $v_{\\text{out}}(s)$. The transfer function of the feedback network is the feedback factor $\\beta$.\n$$v_{f}(s) = \\beta\\,v_{\\text{out}}(s)$$\nSubstituting this into the equation for the error signal gives:\n$$v_{e}(s) = -\\beta\\,v_{\\text{out}}(s)$$\nNow, we substitute this expression for $v_{e}(s)$ back into the original equation for the output voltage:\n$$v_{\\text{out}}(s) = A(s)\\,(-\\beta\\,v_{\\text{out}}(s)) + \\alpha\\,v_{s}(s)$$\nOur goal is to find the ratio $\\dfrac{v_{\\text{out}}(s)}{v_{s}(s)}$. To do this, we rearrange the equation to group the $v_{\\text{out}}(s)$ terms:\n$$v_{\\text{out}}(s) + A(s)\\beta\\,v_{\\text{out}}(s) = \\alpha\\,v_{s}(s)$$\nFactoring out $v_{\\text{out}}(s)$ on the left side:\n$$v_{\\text{out}}(s)(1 + A(s)\\beta) = \\alpha\\,v_{s}(s)$$\nFinally, dividing by $v_{s}(s)$ and by $(1 + A(s)\\beta)$ yields the desired transfer function:\n$$H_{V_{s}\\to V_{\\text{out}}}(s) = \\dfrac{v_{\\text{out}}(s)}{v_{s}(s)} = \\dfrac{\\alpha}{1 + A(s)\\beta}$$\n\n**Part 2: Loop Transmission and Validation**\n\nThe problem requires using the Middlebrook injection method to determine the loop transmission, $L(s)$. For a single-loop feedback system represented by this block diagram, the loop transmission (or loop gain) is the total transfer function around the loop. It is found by breaking the loop at an arbitrary point, injecting a test signal, and measuring the signal that returns to the other side of the break. The loop transmission is the negative of this ratio (the negative sign accounts for the inversion at the summing junction).\n\nIn our block diagram, the signal path around the loop is from the summing junction output $v_{e}(s)$, through the forward amplifier $A(s)$, and then through the feedback network $\\beta$ back to the inverting input of the summing junction. The product of the transfer functions in the loop is $A(s)\\beta$. Therefore, the loop transmission is:\n$$L(s) = A(s)\\beta$$\nThe Middlebrook injection method is a practical technique to measure this quantity in a real circuit without disturbing its DC operating point, and for this idealized model, it yields the same result, $L(s) = A(s)\\beta$.\n\nNow, we validate the consistency of our derived transfer function from Part 1 with this definition of loop transmission. Substituting $L(s) = A(s)\\beta$ into our expression for $H_{V_{s}\\to V_{\\text{out}}}(s)$:\n$$H_{V_{s}\\to V_{\\text{out}}}(s) = \\dfrac{\\alpha}{1 + L(s)}$$\nThis is a standard result from feedback control theory. It states that the closed-loop transfer function from a disturbance injected at the plant output to the system output is equal to the open-loop transfer function from the disturbance to the output (here, $\\alpha$) divided by the quantity $(1 + L(s))$, often called the sensitivity function. The consistency is thus validated.\n\n**Part 3: Final Analytic Expression**\n\nWe now substitute the given parameterizations and values to obtain the final simplified expression for $H_{V_{s}\\to V_{\\text{out}}}(s)$.\n\nFirst, calculate the feedback factor $\\beta$ from the given resistor values, $R_{1} = 9 \\times 10^{3}~\\Omega$ and $R_{2} = 1 \\times 10^{3}~\\Omega$:\n$$\\beta = \\dfrac{R_{2}}{R_{1} + R_{2}} = \\dfrac{1 \\times 10^{3}}{9 \\times 10^{3} + 1 \\times 10^{3}} = \\dfrac{1 \\times 10^{3}}{10 \\times 10^{3}} = \\dfrac{1}{10} = 0.1$$\nNext, substitute the expression for $A(s)$ into the formula for $H_{V_{s}\\to V_{\\text{out}}}(s)$:\n$$H_{V_{s}\\to V_{\\text{out}}}(s) = \\dfrac{\\alpha}{1 + \\left(\\dfrac{A_{0}}{1 + s/\\omega_{p}}\\right)\\beta}$$\nTo simplify, multiply the numerator and denominator by $(1 + s/\\omega_{p})$:\n$$H_{V_{s}\\to V_{\\text{out}}}(s) = \\dfrac{\\alpha(1 + s/\\omega_{p})}{(1 + s/\\omega_{p}) + A_{0}\\beta} = \\dfrac{\\alpha(1 + s/\\omega_{p})}{1 + A_{0}\\beta + s/\\omega_{p}}$$\nFor a cleaner polynomial form, multiply the numerator and denominator by $\\omega_{p}$:\n$$H_{V_{s}\\to V_{\\text{out}}}(s) = \\dfrac{\\alpha(\\omega_{p} + s)}{(1 + A_{0}\\beta)\\omega_{p} + s}$$\nNow, we substitute the numerical values:\n- $\\alpha = 10^{-2}$\n- $A_{0} = 10^{5}$\n- $\\omega_{p} = 2\\pi \\times 10^{2} = 200\\pi$\n- $\\beta = 0.1$\n\nCalculate the terms:\n- The DC loop gain is $A_{0}\\beta = 10^{5} \\times 0.1 = 10^{4}$.\n- The term $1 + A_{0}\\beta = 1 + 10^{4} = 10001$.\n- Numerator: $\\alpha(\\omega_{p} + s) = 10^{-2}(200\\pi + s) = 2\\pi + 10^{-2}s$.\n- Denominator: $(1 + A_{0}\\beta)\\omega_{p} + s = (10001)(200\\pi) + s = 2000200\\pi + s$.\n\nCombining these gives the final simplified analytic expression:\n$$H_{V_{s}\\to V_{\\text{out}}}(s) = \\dfrac{2\\pi + 10^{-2}s}{2000200\\pi + s}$$\nThis is a rational function in $s$ representing a first-order low-pass filter characteristic for the noise, with an additional zero. At low frequencies ($s \\to 0$), the transfer function approaches $\\dfrac{2\\pi}{2000200\\pi} = \\dfrac{1}{1000100}$, showing high rejection. At high frequencies ($s \\to \\infty$), the transfer function approaches $\\dfrac{10^{-2}s}{s} = 10^{-2} = \\alpha$, as the feedback loop has diminishing gain and can no longer reject the disturbance.",
            "answer": "$$\\boxed{\\frac{2\\pi + 10^{-2}s}{2000200\\pi + s}}$$"
        },
        {
            "introduction": "Theoretical models gain their power when applied to real-world circuits with their inherent non-idealities. This final practice explores the PSRR of a Low-Dropout Regulator (LDO), where a parasitic element—the Equivalent Series Resistance ($R_{\\mathrm{ESR}}$) of the output capacitor—plays a crucial role. You will analyze how this seemingly small detail creates a zero in the PSRR transfer function, leading to a degradation of supply rejection at higher frequencies, a classic and vital consideration in the design of high-performance regulators .",
            "id": "4290960",
            "problem": "A low-dropout regulator (LDO) uses a pass device to provide a regulated output. Assume a single-loop feedback design in which the pass device presents a small-signal output resistance $r_o$ from the supply node to the output node, the error amplifier and pass device together form a loop with open-loop gain $L(s)$, and the output network is dominated by an output capacitor $C_o$ whose Equivalent Series Resistance (ESR) $R_{\\mathrm{ESR}}$ is in series with $C_o$ to ground. The load is large enough that its resistance can be treated as infinite in small-signal analysis. Power Supply Rejection Ratio (PSRR) is defined here via the supply-to-output transfer function $H_{V_s \\to V_{\\mathrm{out}}}(j\\omega) \\equiv V_{\\mathrm{out}}(j\\omega)/V_s(j\\omega)$, where $V_s$ is the small-signal perturbation at the supply.\n\nStarting only from linear time-invariant small-signal circuit theory, the definition of closed-loop output impedance reduction by negative feedback, and series/parallel impedance combination rules, derive the form of $H_{V_s \\to V_{\\mathrm{out}}}(s)$ that captures how the finite $r_o$ and the output impedance seen at the regulated node together determine the divider between $V_s$ and $V_{\\mathrm{out}}$. In particular, use the fact that the closed-loop output impedance is reduced by the factor $\\left(1+L(s)\\right)$ relative to the open-loop output impedance, and that the output network impedance is $Z_C(s)=R_{\\mathrm{ESR}}+\\dfrac{1}{s C_o}$.\n\nBased on the derived form, identify how the Equivalent Series Resistance (ESR) of the output capacitor gives rise to a zero in $H_{V_s \\to V_{\\mathrm{out}}}(j\\omega)$ and explain how this zero shapes the magnitude and phase of the supply-to-output transfer function as frequency increases. Choose the option that correctly states the origin, location, and qualitative impact of this zero.\n\nA. In a single-loop LDO with output capacitor $C_o$ having ESR $R_{\\mathrm{ESR}}$, the transfer $H_{V_s \\to V_{\\mathrm{out}}}(j\\omega)$ contains a left-half-plane zero at $\\omega_z=\\dfrac{1}{R_{\\mathrm{ESR}} C_o}$ arising from the factorization $Z_C(s)=R_{\\mathrm{ESR}}+\\dfrac{1}{s C_o}=\\dfrac{1+s R_{\\mathrm{ESR}} C_o}{s C_o}$. Above $\\omega_z$, the magnitude of $H_{V_s \\to V_{\\mathrm{out}}}(j\\omega)$ increases with slope $+20\\,\\mathrm{dB/dec}$ (until limited by other poles), and the phase exhibits a lead approaching $+90^\\circ$ in the vicinity of the zero.\n\nB. The ESR of $C_o$ introduces a right-half-plane zero whose frequency is $\\omega_z=\\dfrac{g_m}{R_{\\mathrm{ESR}}}$, producing additional phase lag and peaking in $H_{V_{s} \\to V_{\\mathrm{out}}}(j\\omega)$; this zero inherently degrades closed-loop stability but improves PSRR magnitude at high frequency.\n\nC. The ESR of $C_o$ creates a real pole at $\\omega_p=\\dfrac{1}{R_{\\mathrm{ESR}} C_o}$ in $H_{V_{s} \\to V_{\\mathrm{out}}}(j\\omega)$, causing the magnitude to fall with slope $-20\\,\\mathrm{dB/dec}$ beyond $\\omega_p$ and the phase to lag toward $-90^\\circ$, thereby improving suppression of supply ripple at higher frequencies.\n\nD. The ESR zero contributed by $C_o$ cancels the dominant pole of the feedback loop $L(s)$ exactly, flattening $H_{V_{s} \\to V_{\\mathrm{out}}}(j\\omega)$ at all higher frequencies regardless of the value of $r_o$ or the specific form of $L(s)$, and therefore cannot degrade PSRR.",
            "solution": "The problem statement is evaluated for validity before proceeding with a solution.\n\n### Step 1: Extract Givens\n- The system is a low-dropout regulator (LDO) with a single-loop feedback design.\n- The pass device has a small-signal output resistance $r_o$ from the supply node to the output node.\n- The open-loop gain of the error amplifier and pass device is $L(s)$.\n- The output network consists of a capacitor $C_o$ in series with an Equivalent Series Resistance (ESR) $R_{\\mathrm{ESR}}$.\n- The impedance of the output network is $Z_C(s) = R_{\\mathrm{ESR}} + \\dfrac{1}{s C_o}$.\n- The load resistance is considered infinite.\n- The supply-to-output transfer function is $H_{V_s \\to V_{\\mathrm{out}}}(j\\omega) \\equiv V_{\\mathrm{out}}(j\\omega)/V_s(j\\omega)$, where $V_s$ is the small-signal supply perturbation.\n- A key instruction is to use the fact that the closed-loop output impedance is reduced by the factor $(1+L(s))$ relative to the open-loop output impedance.\n- The goal is to derive the form of $H_{V_s \\to V_{\\mathrm{out}}}(s)$ and analyze the zero introduced by the ESR.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a standard, simplified small-signal model for analyzing the Power Supply Rejection Ratio (PSRR) of an LDO. All terms used—$L(s)$, $r_o$, $C_o$, $R_{\\mathrm{ESR}}$, PSRR—are standard in analog circuit theory. The provided relationship for closed-loop output impedance, $Z_{\\mathrm{out,cl}} = Z_{\\mathrm{out,ol}}/(1+L(s))$, is a fundamental result from negative feedback theory. The model is scientifically grounded, well-posed, objective, and contains sufficient information to derive the requested transfer function and analyze its properties. There are no contradictions, ambiguities, or scientifically unsound premises.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A solution will be derived.\n\n### Derivation and Analysis\n\nThe problem asks for the supply-to-output transfer function, $H_{V_s \\to V_{\\mathrm{out}}}(s) = V_{\\mathrm{out}}(s) / V_s(s)$. We can model the effect of the supply perturbation $V_s$ by considering the paths through which it reaches the output node $V_{\\mathrm{out}}$. A robust model for an LDO's PSRR considers that the supply noise is suppressed by the feedback loop. The closed-loop transfer function can often be expressed in terms of the open-loop transfer function and the loop gain.\n\nLet us first determine the open-loop gain from the supply to the output, assuming the feedback loop is broken. In such a scenario, the active regulation is disabled. The supply perturbation $V_s$ propagates to the output through the pass device, which is modeled as having a resistance $r_o$. This resistance forms a voltage divider with the output impedance network $Z_C(s)$. The open-loop transfer function from supply to output is thus:\n$$ A_{\\mathrm{OL,psrr}}(s) = \\frac{Z_C(s)}{r_o + Z_C(s)} $$\nNegative feedback acts to suppress this disturbance by a factor of $(1+L(s))$. Therefore, the closed-loop transfer function from supply to output is:\n$$ H_{V_s \\to V_{\\mathrm{out}}}(s) = \\frac{A_{\\mathrm{OL,psrr}}(s)}{1 + L(s)} = \\frac{1}{1+L(s)} \\frac{Z_C(s)}{r_o + Z_C(s)} $$\nAn alternative and more rigorous derivation using KCL at the output node leads to a slightly different but more common expression:\n$$ H_{V_s \\to V_{\\mathrm{out}}}(s) = \\frac{Z_C(s)}{r_o + Z_C(s)(1+L(s))} $$\nThis expression correctly predicts the DC PSRR (where $Z_C \\to \\infty$ and $H \\to 1/(1+L(0))$) and the high-frequency PSRR (where $L(s) \\to 0$, $Z_C \\to R_{\\mathrm{ESR}}$ and $H \\to R_{\\mathrm{ESR}}/(r_o + R_{\\mathrm{ESR}})$).\n\nBoth models share a critical feature: the numerator of the transfer function is proportional to $Z_C(s)$. The question focuses on the zero created by the ESR, which is a feature of $Z_C(s)$ itself. Let us analyze $Z_C(s)$:\n$$ Z_C(s) = R_{\\mathrm{ESR}} + \\frac{1}{s C_o} $$\nTo find the zeros of this impedance, we can write it as a rational function:\n$$ Z_C(s) = \\frac{s R_{\\mathrm{ESR}} C_o + 1}{s C_o} $$\nThe numerator of $Z_C(s)$ is $(1 + s R_{\\mathrm{ESR}} C_o)$. This term becomes a numerator term in the overall transfer function $H_{V_s \\to V_{\\mathrm{out}}}(s)$. A zero of the transfer function occurs at the value of $s$ for which the numerator is zero.\n$$ 1 + s R_{\\mathrm{ESR}} C_o = 0 \\implies s_z = -\\frac{1}{R_{\\mathrm{ESR}} C_o} $$\nSince $R_{\\mathrm{ESR}}$ and $C_o$ are positive physical quantities, the zero $s_z$ is a real, negative number. This corresponds to a zero in the left-half of the complex s-plane (a left-half-plane or LHP zero). The angular frequency of this zero is:\n$$ \\omega_z = \\frac{1}{R_{\\mathrm{ESR}} C_o} $$\nNow, let's analyze the impact of this LHP zero on the frequency response $H_{V_s \\to V_{\\mathrm{out}}}(j\\omega)$. The zero contributes a factor of $(1 + j\\omega/\\omega_z)$ to the transfer function.\n-   **Magnitude Impact**: For frequencies $\\omega \\gg \\omega_z$, the magnitude of this term is approximately $|\\omega/\\omega_z|$. On a log-log plot (Bode plot), this corresponds to a line with a slope of $+20\\,\\mathrm{dB/decade}$. This means the zero causes the magnitude of the supply-to-output gain to increase at high frequencies, which degrades the PSRR. This rise will of course be counteracted or modified by poles in the transfer function at higher frequencies.\n-   **Phase Impact**: The phase contribution of this term is $\\phi_z(\\omega) = \\arctan(\\omega/\\omega_z)$. This phase starts at $0^\\circ$ for $\\omega \\ll \\omega_z$, passes through $+45^\\circ$ at $\\omega = \\omega_z$, and approaches $+90^\\circ$ for $\\omega \\gg \\omega_z$. This is a phase lead.\n\n### Option-by-Option Analysis\n\n**A. In a single-loop LDO with output capacitor $C_o$ having ESR $R_{\\mathrm{ESR}}$, the transfer $H_{V_s \\to V_{\\mathrm{out}}}(j\\omega)$ contains a left-half-plane zero at $\\omega_z=\\dfrac{1}{R_{\\mathrm{ESR}} C_o}$ arising from the factorization $Z_C(s)=R_{\\mathrm{ESR}}+\\dfrac{1}{s C_o}=\\dfrac{1+s R_{\\mathrm{ESR}} C_o}{s C_o}$. Above $\\omega_z$, the magnitude of $H_{V_s \\to V_{\\mathrm{out}}}(j\\omega)$ increases with slope $+20\\,\\mathrm{dB/dec}$ (until limited by other poles), and the phase exhibits a lead approaching $+90^\\circ$ in the vicinity of the zero.**\n-   **Verdict: Correct.** This statement accurately identifies the origin of the zero (the numerator of $Z_C(s)$), its location ($\\omega_z = 1/(R_{\\mathrm{ESR}} C_o)$), its type (left-half-plane), and its qualitative impact on the magnitude (slope increases by $+20\\,\\mathrm{dB/dec}$) and phase (lead up to $+90^\\circ$). The qualification \"until limited by other poles\" is also correct.\n\n**B. The ESR of $C_o$ introduces a right-half-plane zero whose frequency is $\\omega_z=\\dfrac{g_m}{R_{\\mathrm{ESR}}}$, producing additional phase lag and peaking in $H_{V_{s} \\to V_{\\mathrm{out}}}(j\\omega)$; this zero inherently degrades closed-loop stability but improves PSRR magnitude at high frequency.**\n-   **Verdict: Incorrect.** The zero is in the left-half-plane, not the right-half-plane. A LHP zero produces phase lead, not lag. The zero location is incorrect; it should be $1/(R_{\\mathrm{ESR}} C_o)$, not involving the pass device's transconductance $g_m$ in this manner. A rising magnitude for $H_{V_s \\to V_{\\mathrm{out}}}(j\\omega)$ degrades, not improves, PSRR.\n\n**C. The ESR of $C_o$ creates a real pole at $\\omega_p=\\dfrac{1}{R_{\\mathrm{ESR}} C_o}$ in $H_{V_{s} \\to V_{\\mathrm{out}}}(j\\omega)$, causing the magnitude to fall with slope $-20\\,\\mathrm{dB/dec}$ beyond $\\omega_p$ and the phase to lag toward $-90^\\circ$, thereby improving suppression of supply ripple at higher frequencies.**\n-   **Verdict: Incorrect.** The factorization of $Z_C(s)$ shows that the term $(1+sR_{\\mathrm{ESR}}C_o)$ appears in the numerator of the transfer function, creating a zero, not a pole. The described effects (magnitude falling, phase lag) are characteristic of a pole, not the ESR zero.\n\n**D. The ESR zero contributed by $C_o$ cancels the dominant pole of the feedback loop $L(s)$ exactly, flattening $H_{V_{s} \\to V_{\\mathrm{out}}}(j\\omega)$ at all higher frequencies regardless of the value of $r_o$ or the specific form of $L(s)$, and therefore cannot degrade PSRR.**\n-   **Verdict: Incorrect.** There is no physical principle that guarantees an exact cancellation between the ESR zero ($\\omega_z = 1/(R_{\\mathrm{ESR}}C_o)$) and the loop's dominant pole. Such cancellation would be a matter of specific component choice and design, not a general property. The claim that the response is flat \"regardless\" of other parameters is false. The ESR zero generally occurs at a frequency higher than the loop's unity-gain bandwidth and degrades PSRR by increasing the supply-to-output gain.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}