## 引言
在高性能[模拟集成电路设计](@entry_id:277019)中，一个纯净、稳定的电源是实现高精度和高[信噪比](@entry_id:271861)的基石。然而，现实世界中的电源轨不可避免地会受到来自[稳压](@entry_id:272092)器、[数字电路](@entry_id:268512)开关以及外部环境的噪声干扰。这些不期望的电压波动会通过各种路径耦合到敏感的模拟电路中，直接降低其性能，表现为噪声、失真或时序不确定性。因此，如何量化并提升电路对电源噪声的免疫力——即[电源抑制](@entry_id:1130064)（Power Supply Rejection）能力，成为模[拟设](@entry_id:184384)计师必须掌握的核心技能。本文旨在系统性地解决这一挑战，为读者构建一个从理论到实践的完整知识框架。

为实现这一目标，本文将分为三个核心部分。我们将在第一章 **“原理与机制”** 中，建立分析PSRR的数学模型，深入剖析噪声在低频和高频下的耦合路径，并探讨差分结构和非理想因素如何影响PSRR。随后，在第二章 **“应用与跨学科连接”** 中，我们将把这些理论应用于实际电路设计，探索如[运算放大器](@entry_id:263966)、LDO等模块的PSRR[优化技术](@entry_id:635438)，进行系统级的[噪声预算](@entry_id:1128750)，并讨论物理版图对[电源完整性](@entry_id:1130047)的影响。最后，第三章 **“动手实践”** 将通过一系列精心设计的问题，巩固您对关键概念的理解。

让我们从构建坚实的理论基础开始，深入探讨[电源抑制](@entry_id:1130064)的基本原理与核心机制。

## 原理与机制

在理想化的[电路分析](@entry_id:261116)中，我们通常假设电源电压是恒定且无噪声的。然而，在现实世界中，为[模拟电路](@entry_id:274672)供电的电源轨不可避免地会受到各种干扰，包括来自稳压器的噪声、[数字电路](@entry_id:268512)切换引起的瞬态波动，以及通过封装和电路板布线拾取的外部噪声。这些不期望的电源电压变化，或称为**[电源纹波](@entry_id:271017)**，可以耦合到电路的输出端，表现为噪声或失真，从而降低电路的整体性能。**[电源抑制](@entry_id:1130064) (Power Supply Rejection)** 的研究旨在量化和改善模拟电路对这些电源扰动的免疫力。本章将深入探讨[电源抑制](@entry_id:1130064)的基本原理和关键机制。

### 定义电源敏感度

要系统地分析电路对电源噪声的敏感度，我们必须首先建立一个严谨的数学框架。核心工具是从电源到输出的**小信号传递函数 (small-signal transfer function)**。

#### 电源-输出传递函数

考虑一个由标称值为 $V_{S0}$ 的电源供电的通用模拟电路模块。当电源电压受到一个小的、时变的扰动 $v_s(t)$ 时，即 $V_S(t) = V_{S0} + v_s(t)$，电路的输出电压也会在其[静态工作点](@entry_id:264648) $V_{\text{out0}}$ 附近产生一个相应的扰动 $v_{\text{out}}(t)$，即 $V_{\text{out}}(t) = V_{\text{out0}} + v_{\text{out}}(t)$。在小信号假设下，扰动量之间的关系是线性的。我们将所有其他信号输入置于其小信号零值（例如，电压输入接地），并保持输出负载不变。

在此条件下，我们可以定义一个从电源端口到输出端口的[线性时不变](@entry_id:276287) (LTI) 传递函数。在频域中，这个函数被定义为输出信号的[相量](@entry_id:270266) $V_{\text{out}}(j\omega)$ 与输入电源扰动的相量 $V_s(j\omega)$ 之比。这个传递函数，记为 $H_{V_s \to V_{\text{out}}}(j\omega)$，精确地描述了电源噪声如何作为频率的函数耦合到输出 。

$$
H_{V_s \to V_{\text{out}}}(j\omega) \triangleq \frac{V_{\text{out}}(j\omega)}{V_s(j\omega)}
$$

这是一个复数函数，其**幅值** $|H_{V_s \to V_{\text{out}}}(j\omega)|$ 表示在特定频率下[电源纹波](@entry_id:271017)传递到输出的增益，而其**相位**则描述了输出响应相对于电源扰动的延迟。需要注意的是，这个定义中没有预设的负号；电路拓扑本身决定了响应是同相还是反相，这完全由传递函数的相位来体现 。

#### [电源抑制比](@entry_id:268797) (PSRR) 及其相关指标

虽然传递函数提供了完整的描述，但在工程实践中，我们更常用一个更直观的性能指标：**[电源抑制比](@entry_id:268797) (Power Supply Rejection Ratio, PSRR)**。PSRR被定义为传递函数幅值的倒数。

$$
\text{PSRR}(\omega) \triangleq \frac{1}{|H_{V_s \to V_{\text{out}}}(j\omega)|} = \left| \frac{V_s(j\omega)}{V_{\text{out}}(j\omega)} \right|
$$

这个定义直观地衡量了电路抑制电源噪声的能力：一个高的PSRR值意味着一个大的电源扰动只会在输出端产生一个小的响应。PSRR是一个无量纲的比值，通常以**分贝 (decibels, dB)** 为单位表示，计算公式为 $20\log_{10}(\text{PSRR})$。

除了随频率变化的PSRR之外，还有几个相关的指标用于描述电路对电源变化的敏感度 ：

*   **[线性调整率](@entry_id:267089) (Line Regulation)**：这是PSRR在直流（即 $\omega \to 0$）时的特殊情况。它量化了输出直流电压随电源直流电压变化的程度，定义为 $LR \triangleq \left. \frac{dV_{\text{out}}}{dV_s} \right|_{\omega \to 0}$。其单位通常为 $\text{mV/V}$ 或 $\text{μV/V}$。它本质上是传递函数 $H_{V_s \to V_{\text{out}}}(0)$ 的值。

*   **电源调制比 (Power Supply Modulation Ratio, PSMR)**：这个指标更为通用，它量化了电路的某个特定参数 $p$（如增益、失调电压或振荡频率）对电源电压的相对敏感度。其定义为 $\text{PSMR}_p \triangleq \frac{1}{p} \frac{\partial p}{\partial V_s}$，单位是 $1/\text{V}$，常以 $\%/\text{V}$ 报告。

### 低频电源噪声耦合机制

为了设计具有高PSRR的电路，我们必须首先理解电源噪声通过哪些物理路径耦合到输出。在低频下，主要的耦合机制可以分为无源路径和有源路径。

#### 无源[分压](@entry_id:168927)机制

最直接的噪声耦合路径是通过连接到电源轨的负载元件。考虑一个简单的[共源放大器](@entry_id:265648)，其漏极通过负载电阻 $R_D$ 连接到电源 $V_{DD}$。晶体管本身具有有限的输出电阻 $r_o$。为了分析电源噪声的影响，我们将输入栅极置于交流地。

在这种情况下，晶体管的受控[电流源](@entry_id:275668) $g_m v_{gs}$ 由于 $v_{gs}=0$ 而不起作用。电路的小信号模型简化为一个由[电源纹波](@entry_id:271017)电压 $v_{DD}$ 驱动的简单[分压器](@entry_id:275531)。$v_{DD}$ 施加在 $R_D$ 和 $r_o$ 的串联组合上，而输出电压 $v_{\text{out}}$ 是在 $r_o$ 两端测得的。因此，从电源到输出的传递函数为 ：

$$
H_{V_{DD} \to V_{\text{out}}}(0) = \frac{v_{\text{out}}}{v_{DD}} = \frac{r_o}{R_D + r_o}
$$

这个结果表明，即使在没有有源器件参与的情况下，电源噪声也会通过负载网络直接泄漏到输出。PSRR在这种情况下为 $(R_D + r_o) / r_o = 1 + R_D/r_o$。为了提高PSRR，需要使 $r_o$ 远大于 $R_D$，或者，更常见的是，使用具有极高[动态电阻](@entry_id:268111)的[有源负载](@entry_id:262691)来代替 $R_D$。

#### 有源器件耦合机制

在更实际的情况下，晶体管的偏置网络可能也与电源轨相连，导致[电源纹波](@entry_id:271017)被耦合到晶体管的栅极和体端，从而通过晶体管的放大作用影响输出。

我们再次考察[共源放大器](@entry_id:265648)，但现在假设由于[偏置电路](@entry_id:1121543)不完美，一小部分[电源纹波](@entry_id:271017) $\tilde{V}_{DD}$ 分别以系数 $\alpha_g$ 和 $\alpha_b$ 耦合到栅极和体端。即小信号栅压 $\tilde{v}_g = \alpha_g \tilde{V}_{DD}$，小[信号体](@entry_id:152001)偏压 $\tilde{v}_b = \alpha_b \tilde{V}_{DD}$。通过在输出节点应用[基尔霍夫电流定律](@entry_id:270632) (KCL)，我们可以推导出包含所有路径的总传递函数 ：

$$
H = \frac{\tilde{v}_{\text{out}}}{\tilde{V}_{DD}} = \frac{r_o - (g_m \alpha_g + g_{mb} \alpha_b) R_D r_o}{R_D + r_o}
$$

这个表达式可以分解为两个部分：

1.  **无源路径**：项 $\frac{r_o}{R_D + r_o}$，与我们之前推导的简单[分压](@entry_id:168927)模型完全相同。
2.  **有源路径**：项 $-(g_m \alpha_g + g_{mb} \alpha_b) \frac{R_D r_o}{R_D + r_o}$。这一项代表了通过晶体管的有源耦合。耦合到栅极和体端的[电源纹波](@entry_id:271017)被晶体管的[跨导](@entry_id:274251) $g_m$ 和体跨导 $g_{mb}$ 转换为漏极电流，该电流流过输出总阻抗 $R_D || r_o$ 产生输出电压。

值得注意的是，有源路径的贡献通常带有一个负号。这意味着通过有源路径耦合的噪声可能与通过无源负载路径耦合的噪声异相。在某些设计中，可以巧妙地利用这种相位关系，通过调整[耦合系数](@entry_id:273384) $\alpha_g$ 和 $\alpha_b$ 来实现路径之间的**噪声抵消**，从而在特定频率下显著提高PSRR。

### 高频电源噪声耦合机制

随着频率的升高，电路中的[寄生电容](@entry_id:270891)开始主导噪声耦合路径，通常会导致PSRR性能下降。即使是高阻抗节点，也容易通过微小的[寄生电容](@entry_id:270891)从电源轨拾取噪声。

考虑一个由PMOS[电流源](@entry_id:275668)作为负载的共源级。输出节点是一个高阻抗节点。在小信号模型中，我们关注从该节点连接到电源 $V_{DD}$ 或地的主要[寄生电容](@entry_id:270891)。假设PMOS的源极和[体偏置](@entry_id:1121730)都连接到 $V_{DD}$，栅极通过[旁路电容](@entry_id:273909)在交流上接地到 $V_{DD}$。与输出节点相关的主要电容包括：PMOS的[栅-漏电容](@entry_id:1125509) $C_{gd}$，漏-体电容 $C_{db}$，以及所有对地的电容总和 $C_L$（包括NMOS的[寄生电容](@entry_id:270891)和外部负载电容）。

在这种情况下，[电源纹波](@entry_id:271017) $v_{dd}$ 通过 $C_{gd}$ 和 $C_{db}$ 耦合到输出节点。整个[网络形成](@entry_id:145543)一个**容性[分压器](@entry_id:275531)**。在输出节点应用KCL可以推导出高频传递函数 ：

$$
H_{V_{DD} \to x}(j\omega) = \frac{V_x(j\omega)}{V_{dd}(j\omega)} = \frac{C_{gd} + C_{db}}{C_{gd} + C_{db} + C_L}
$$

这个结果表明，在高频极限下，电源到输出的增益趋于一个由电容比决定的常数值。这个值通常被称为**PSRR的“高频平台”**。为了在高频下获得良好的PSRR，设计目标是最小化从电源轨到高阻抗节点的[耦合电容](@entry_id:272721)（$C_{gd}$ 和 $C_{db}$），同时最大化该节点到地的总电容 $C_L$。这一基本原理是电源和地平面设计以及版图布局中“星型接地”和“[电源去耦](@entry_id:275079)”等实践的理论基础。

### 差分电路中的PSRR

差分电路结构是模拟设计中抑制[共模噪声](@entry_id:269684)（包括电源噪声）的最强大技术之一。其有效性的关键在于**对称性**。

在一个理想的、完全对称的差分对中，[电源纹波](@entry_id:271017)作为一个**共模**扰动，会通过完全相同的路径耦合到两个对称的输出端。例如，在带有匹配[负载电阻](@entry_id:267991) $R_L$ 的差分对中，[电源纹波](@entry_id:271017) $v_{DD}$ 会通过两个相同的 $R_L$ 馈入两个输出节点。由于电路的对称性，两个输出节点产生的扰动 $v_{o1}(t)$ 和 $v_{o2}(t)$ 将完全相同，即 $v_{o1}(t) = v_{o2}(t)$ 。

差分电路的信号输出是两个单端输出之差，$v_{\text{out,dm}}(t) = v_{o1}(t) - v_{o2}(t)$。由于 $v_{o1}(t)$ 和 $v_{o2}(t)$ 相等，差分输出理想情况下为零。这意味着，理想对称的差分电路能够完美地抑制共模电源噪声，从而实现无限高的**差分PSRR**。

为了更精确地表征[全差分放大器](@entry_id:268611) (FDA)，我们定义两种PSRR ：
*   **差分PSRR ($PSRR_{dm}$)**：衡量电路抑制电源共模纹波在其**差分输出**上产生分量的能力。
    $$
    PSRR_{dm} = \left| \frac{\tilde{V}_{s,cm}(\omega)}{\tilde{V}_{\text{out,dm}}(\omega)} \right|
    $$
*   **共模PSRR ($PSRR_{cm}$)**：衡量电路抑制电源共模纹波在其**共模输出**上产生分量的能力。
    $$
    PSRR_{cm} = \left| \frac{\tilde{V}_{s,cm}(\omega)}{\tilde{V}_{\text{out,cm}}(\omega)} \right|
    $$
其中 $\tilde{V}_{s,cm}$ 是电源共模纹波的[相量](@entry_id:270266)，$\tilde{V}_{\text{out,dm}}$ 和 $\tilde{V}_{\text{out,cm}}$ 分别是差分和共模输出纹波的相量。

在实际电路中，由于器件和负载的**失配 (mismatch)**，完美的对称性无法实现。这些失配会破坏平衡，导致一部分共模电源噪声被转换为差模输出信号，从而使差分PSRR降至有限值。因此，改善差分PSRR的关键在于通过精心的版图设计和器件尺寸选择来最小化失配。

### PSRR的非对称性与可[变性](@entry_id:165583)

在更深入的分析中，我们发现PSRR不仅随频率变化，还可能因为电路拓扑和工艺变化而表现出非对称性和统计可变性。

#### 拓扑非对称性

许多电路拓扑在结构上对正负电源轨是不对称的，这直接导致了对正[电源纹波](@entry_id:271017) ($PSRR_+$) 和对负[电源纹波](@entry_id:271017) ($PSRR_-$) 的抑制能力不同。一个典型的例子是使用PMOS共源共栅[电流源](@entry_id:275668)作为上拉负载、NMOS共源管作为下拉驱动的CMOS[运放输出级](@entry_id:265978) 。

在这种结构中，从输出节点“向上看”到 $V_{DD}$ 的等效电阻 $r_p$ 是[共源共栅结构](@entry_id:273974)的输出电阻，其值非常高，约为 $r_p \approx g_{m3}r_{o2}r_{o3}$。而“向下看”到 $V_{SS}$ 的等效电阻 $r_n$ 只是下拉管的输出电阻 $r_{o1}$。因此，$r_p \gg r_n$。

当 $V_{DD}$ 产生纹波时，输出电压是 $r_p$ 和 $r_n$ [分压](@entry_id:168927)的结果，传递[函数近似](@entry_id:141329)为 $r_n / (r_p+r_n)$，因此 $PSRR_+ = (r_p+r_n)/r_n \approx r_p/r_n$，非常大。相反，当 $V_{SS}$ 产生纹波时，传递[函数近似](@entry_id:141329)为 $r_p / (r_p+r_n)$，因此 $PSRR_- = (r_p+r_n)/r_p \approx 1$。PSRR的非对称性 $\mathcal{A} = PSRR_+ / PSRR_-$ 近似为 $r_p/r_n$，这个比值可能高达数百倍。这种分析揭示了电路拓扑如何从根本上决定了其对不同电源轨噪声的敏感度。

#### 工艺失配引起的统计可[变性](@entry_id:165583)

即使对于名义上对称的电路，制造过程中的随机变化也会导致器件参数（如阈值电压 $V_T$、跨导系数 $\beta$）的失配，进而引起PSRR的[统计分布](@entry_id:182030)。我们可以使用[一阶微扰理论](@entry_id:153242)来量化这种影响 。

考虑一个由NMOS驱动管和PMOS[有源负载](@entry_id:262691)组成的简单反相器。其低频电源-输出传递函数为 $H = r_{o\text{N}} / (r_{o\text{N}} + r_{o\text{P}})$。$H$ 的方差 $\operatorname{Var}\{H\}$ 可以通过其对 $r_{o\text{N}}$ 和 $r_{o\text{P}}$ 的灵敏度以及这两个电阻本身的方差来计算。$r_{oX}$ 的方差又可以追溯到更基本的工艺参数（如 $V_T, \beta, \lambda$）的方差，这些参数的方差通常遵循[Pelgrom定律](@entry_id:1129488)，即与器件面积 $W \times L$ 成反比。

最终推导出的 $\operatorname{Var}\{H\}$ 表达式形式复杂，但它清晰地表明，PSRR的统计变化由以下因素决定：
1.  **电路灵敏度**：由 $(r_{o\text{N}}^2 r_{o\text{P}}^2) / (r_{o\text{N}} + r_{o\text{P}})^4$ 项表示，取决于电路的[工作点](@entry_id:173374)和拓扑结构。
2.  **[器件失配](@entry_id:1123618)**：由Pelgrom系数 $A_{V_T}, A_\beta$ 等决定，是工艺技术的固有属性。
3.  **设计选择**：器件尺寸 $W, L$ 和[过驱动电压](@entry_id:272139) $V_{OV}$。增加器件面积和[过驱动电压](@entry_id:272139)可以减小参数变化，从而降低PSRR的统计离散性。

这种分析将电路性能与底层工艺[统计模型](@entry_id:165873)联系起来，是现代高良率[模拟集成电路设计](@entry_id:277019)的基石。

### 系统级考量：电源分配网络（PDN）的影响

最后，我们必须将视野从芯片本身扩展到整个**电源分配网络 (Power Delivery Network, PDN)**。PDN包括从远端[稳压](@entry_id:272092)器到芯片上晶体管的整条路径，其中包含了电路板走线、封装引脚和键合线等元件，这些元件在高频下表现出显著的**[寄生电感](@entry_id:268392)** $L_s$。为了稳定片上电源，通常会在芯片的电源引脚处放置**去耦电容** $C$。

这个由稳压器输出电阻 $R_s$、[寄生电感](@entry_id:268392) $L_s$ 和[去耦电容](@entry_id:1123466) $C$ 组成的系统构成了一个[二阶RLC电路](@entry_id:260751)。这个电路具有一个[谐振频率](@entry_id:265742) ：

$$
f_0 = \frac{1}{2\pi\sqrt{L_s C}}
$$

在谐振频率 $f_0$ 处，电感和电容的电抗相互抵消，PDN的总阻抗达到最小值，仅为 $R_s$。这会导致流向芯片的电流在该频率下急剧增大，从而在片上电源 $V_{DD}$ 上产生一个电压尖峰。换言之，从外部稳压器噪声源 $v_s$ 到片上电源 $V_{DD}$ 的传递函数 $|V_{DD}/V_s|$ 在 $f_0$ 处达到峰值。

由于电路的PSRR是针对片上电源 $V_{DD}$ 定义的，这个在 $f_0$ 处的电压尖峰将直接恶化整个系统的[电源抑制](@entry_id:1130064)性能。从系统角度看，在[谐振频率](@entry_id:265742) $f_0$ 处，总的PSRR（从 $v_s$ 到 $v_{\text{out}}$）会表现出一个明显的**凹陷 (dip)**，即PSRR最差的点。这个PSRR凹陷是[电源完整性](@entry_id:1130047)设计中一个至关重要的问题，设计者必须通过控制 $L_s$ 和 $C$ 的值，并引入适当的阻尼，来抑制[谐振峰](@entry_id:271281)值，以确保电路在所有工作频率下都具有足够的电源[噪声抑制](@entry_id:276557)能力。