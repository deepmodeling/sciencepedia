{
    "hands_on_practices": [
        {
            "introduction": "A solid understanding of comparator design begins with mastering its most fundamental non-ideality: input-referred offset. In an ideal world, a static comparator trips precisely when its differential inputs are equal, but in reality, unavoidable mismatches in transistor properties shift this threshold. This first exercise provides a foundational analysis of how a physical device-level mismatch, specifically in the threshold voltage ($V_t$), translates directly into the critical circuit-level specification of input-referred offset ($V_{\\mathrm{os}}$), a cornerstone of analog design .",
            "id": "4300753",
            "problem": "Consider a static Metal–Oxide–Semiconductor Field-Effect Transistor (MOSFET) differential comparator front-end implemented with an N-channel MOSFET (NMOS) differential pair. The pair is biased by a constant tail current source of value $I_{T}$ and drives a single-ended resistive load $R_{L}$ at one drain. Assume device operation in strong inversion and saturation, negligible channel-length modulation, and symmetric geometry except for a threshold voltage mismatch. Let the two input devices have threshold voltages $V_{t1}$ and $V_{t2}$, with a mismatch $\\Delta V_{t} \\equiv V_{t1} - V_{t2}$. Define the differential input $v_{id} \\equiv v_{G1} - v_{G2}$ and the common-mode input $v_{CM} \\equiv (v_{G1} + v_{G2})/2$. Let $g_{m}$ denote the effective small-signal differential transconductance of the pair from $v_{id}$ to the single-ended branch current at the output node, so that for small $|v_{id}|$ the branch current perturbation satisfies $i_{o} \\approx g_{m}\\,v_{id}$.\n\nIn the context of Integrated Circuits and Electronic Design Automation (EDA), input-referred offset for comparators is defined as the differential input voltage that must be applied to counterbalance mismatches so that the output indicates exact balance. Starting from the monotonic dependence of the drain current on the overdrive voltage in saturation, and from the definition of transconductance $g_{m} \\equiv \\partial I_{D}/\\partial V_{GS}$, derive the input-referred offset $V_{\\mathrm{os}}$ needed to equalize the two branch currents in the presence of the threshold mismatch $\\Delta V_{t}$. Use the physically justified approximation that equality of branch currents implies equality of the effective overdrive voltages of the two transistors.\n\nSeparately, the single-ended output voltage of the resistively loaded pair can be approximated by the smooth-limiter relation\n$$\nV_{\\mathrm{out}} \\approx I_{T}\\,R_{L}\\,\\tanh\\!\\left(\\frac{g_{m}\\,v_{id}}{I_{T}}\\right),\n$$\nwhich captures current steering saturation at $\\pm I_{T}$ and is widely used as a behavioral representation for differential pairs. Using first principles and a formal series expansion, verify the small-signal behavior of this relation near $v_{id} = 0$ by computing the small-signal gain $\\left.\\frac{d V_{\\mathrm{out}}}{d v_{id}}\\right|_{v_{id}=0}$.\n\nProvide your final answer as a row matrix containing two symbolic entries:\n$V_{\\mathrm{os}}$ and $\\left.\\frac{d V_{\\mathrm{out}}}{d v_{id}}\\right|_{v_{id}=0}$.\nNo numerical evaluation is required, and no units should be included in the final boxed expression.",
            "solution": "The user has presented a two-part problem concerning a static NMOS differential comparator. The first part requires the derivation of the input-referred offset voltage, $V_{\\mathrm{os}}$, due to a threshold voltage mismatch, $\\Delta V_{t}$. The second part requires the calculation of the small-signal voltage gain at zero differential input for a given behavioral model of the comparator's output stage.\n\nThe problem has been validated and found to be scientifically sound, well-posed, and objective, representing a standard analysis in the field of analog integrated circuit design.\n\n**Part 1: Derivation of the Input-Referred Offset Voltage ($V_{\\mathrm{os}}$)**\n\nThe input-referred offset voltage, $V_{\\mathrm{os}}$, is defined as the differential input voltage, $v_{id} = v_{G1} - v_{G2}$, required to bring the differential pair into a balanced state, nullifying any output offset caused by device mismatches. In this context, balance is achieved when the drain currents of the two transistors in the differential pair are equal, i.e., $I_{D1} = I_{D2}$.\n\nThe problem states that the transistors operate in strong inversion and saturation. In this regime, the drain current $I_D$ of a MOSFET is a monotonically increasing function of its overdrive voltage, $V_{OV} = V_{GS} - V_t$, where $V_{GS}$ is the gate-to-source voltage and $V_t$ is the threshold voltage. Since the two transistors, M1 and M2, are stated to have symmetric geometry, they share the same functional form relating drain current to overdrive voltage. We can express this as $I_D = F(V_{OV})$, where the function $F$ is identical for both devices.\n\nThe condition for balance is $I_{D1} = I_{D2}$. This implies:\n$$\nF(V_{OV1}) = F(V_{OV2})\n$$\nwhere $V_{OV1}$ and $V_{OV2}$ are the overdrive voltages for transistors M1 and M2, respectively.\n\nAs stated in the problem, the drain current has a monotonic dependence on the overdrive voltage. For a monotonic function $F$, the equality $F(x) = F(y)$ holds if and only if $x = y$. This validates the problem's approximation that equality of branch currents implies equality of overdrive voltages. Thus, the balance condition $I_{D1} = I_{D2}$ simplifies to:\n$$\nV_{OV1} = V_{OV2}\n$$\nThe overdrive voltages are defined in terms of the terminal voltages:\n$$\nV_{OV1} = V_{G1} - V_S - V_{t1}\n$$\n$$\nV_{OV2} = V_{G2} - V_S - V_{t2}\n$$\nHere, $V_{G1}$ and $V_{G2}$ are the gate voltages, $V_S$ is the common source voltage for the differential pair, and $V_{t1}$ and $V_{t2}$ are the respective threshold voltages.\n\nEquating the overdrive voltages gives:\n$$\nV_{G1} - V_S - V_{t1} = V_{G2} - V_S - V_{t2}\n$$\nThe common source voltage $V_S$ cancels out from both sides of the equation:\n$$\nV_{G1} - V_{t1} = V_{G2} - V_{t2}\n$$\nRearranging this equation to solve for the differential gate voltage $V_{G1} - V_{G2}$:\n$$\nV_{G1} - V_{G2} = V_{t1} - V_{t2}\n$$\nBy definition, the input-referred offset $V_{\\mathrm{os}}$ is the value of the differential input $v_{id} = V_{G1} - V_{G2}$ that satisfies this balance condition. The problem also defines the threshold voltage mismatch as $\\Delta V_t \\equiv V_{t1} - V_{t2}$. Therefore, we find:\n$$\nV_{\\mathrm{os}} = \\Delta V_t\n$$\n\n**Part 2: Verification of Small-Signal Gain**\n\nThe second part of the problem asks to compute the small-signal gain of a behavioral model for the single-ended output voltage, given by the relation:\n$$\nV_{\\mathrm{out}} \\approx I_{T}\\,R_{L}\\,\\tanh\\!\\left(\\frac{g_{m}\\,v_{id}}{I_{T}}\\right)\n$$\nThe small-signal gain at zero differential input is defined as the derivative of $V_{\\mathrm{out}}$ with respect to $v_{id}$, evaluated at $v_{id} = 0$.\n$$\nA_v = \\left.\\frac{d V_{\\mathrm{out}}}{d v_{id}}\\right|_{v_{id}=0}\n$$\nTo compute this derivative, we apply the chain rule. Let $u(v_{id}) = \\frac{g_{m}\\,v_{id}}{I_{T}}$. Then $V_{\\mathrm{out}} = I_T R_L \\tanh(u)$.\n$$\n\\frac{d V_{\\mathrm{out}}}{d v_{id}} = \\frac{d}{d v_{id}} \\left[ I_{T}\\,R_{L}\\,\\tanh(u(v_{id})) \\right] = I_{T}\\,R_{L} \\cdot \\frac{d(\\tanh(u))}{du} \\cdot \\frac{du}{dv_{id}}\n$$\nThe derivative of the hyperbolic tangent function is $\\frac{d}{du}(\\tanh(u)) = \\text{sech}^2(u)$.\nThe derivative of $u$ with respect to $v_{id}$ is $\\frac{du}{dv_{id}} = \\frac{d}{d v_{id}}\\left(\\frac{g_{m}\\,v_{id}}{I_{T}}\\right) = \\frac{g_{m}}{I_{T}}$.\n\nSubstituting these derivatives into the expression for the gain:\n$$\n\\frac{d V_{\\mathrm{out}}}{d v_{id}} = I_{T}\\,R_{L} \\cdot \\text{sech}^2(u) \\cdot \\frac{g_{m}}{I_{T}}\n$$\nSubstituting back $u = \\frac{g_{m}\\,v_{id}}{I_{T}}$:\n$$\n\\frac{d V_{\\mathrm{out}}}{d v_{id}} = I_{T}\\,R_{L} \\cdot \\text{sech}^2\\left(\\frac{g_{m}\\,v_{id}}{I_{T}}\\right) \\cdot \\frac{g_{m}}{I_{T}} = g_{m} R_{L} \\text{sech}^2\\left(\\frac{g_{m}\\,v_{id}}{I_{T}}\\right)\n$$\nNow, we evaluate this expression at $v_{id} = 0$:\n$$\n\\left.\\frac{d V_{\\mathrm{out}}}{d v_{id}}\\right|_{v_{id}=0} = g_{m} R_{L} \\text{sech}^2\\left(\\frac{g_{m} \\cdot 0}{I_{T}}\\right) = g_{m} R_{L} \\text{sech}^2(0)\n$$\nThe hyperbolic secant is defined as $\\text{sech}(x) = 1/\\cosh(x)$. The hyperbolic cosine at $x=0$ is $\\cosh(0) = 1$.\nTherefore, $\\text{sech}(0) = 1$, and $\\text{sech}^2(0) = 1^2 = 1$.\n\nThe small-signal gain at $v_{id}=0$ is:\n$$\n\\left.\\frac{d V_{\\mathrm{out}}}{d v_{id}}\\right|_{v_{id}=0} = g_{m} R_{L} \\cdot 1 = g_{m} R_{L}\n$$\nThis result is consistent with the standard analysis of a resistively loaded differential pair, where the small-signal gain is the product of the differential transconductance and the load resistance.\n\nAlternatively, using the formal series expansion for $\\tanh(x)$ around $x=0$, which is $\\tanh(x) = x - \\frac{x^3}{3} + O(x^5)$. For small $v_{id}$, the argument $\\frac{g_{m}\\,v_{id}}{I_{T}}$ is also small, so we can use the first-order approximation $\\tanh(x) \\approx x$.\n$$\nV_{\\mathrm{out}} \\approx I_{T}\\,R_{L}\\,\\left(\\frac{g_{m}\\,v_{id}}{I_{T}}\\right) = g_m R_L v_{id}\n$$\nFor small signals, the gain is the ratio $V_{\\mathrm{out}}/v_{id}$, which is $g_m R_L$. This confirms the result from the differentiation.\n\nThe two requested symbolic entries are $V_{\\mathrm{os}} = \\Delta V_t$ and the small-signal gain $\\left.\\frac{d V_{\\mathrm{out}}}{d v_{id}}\\right|_{v_{id}=0} = g_m R_L$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\Delta V_{t} & g_{m} R_{L}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While static comparators are robust, many high-speed applications rely on dynamic comparators to achieve faster decisions with lower power consumption. These circuits employ positive feedback, or regeneration, to rapidly amplify a small initial voltage. This practice delves into the core dynamics of this process, exploring how thermal noise at the input interacts with the regeneration time constant ($\\tau$) to produce timing jitter—an uncertainty in the decision time that can limit the performance of high-frequency systems .",
            "id": "4300776",
            "problem": "A regenerative dynamic comparator based on a cross-coupled differential pair exhibits exponential growth of its differential output voltage during the decision phase. Near the metastable point, the small-signal differential output voltage can be modeled by the linear time-invariant ordinary differential equation $\\,\\frac{d v_{o}(t)}{d t} = \\frac{1}{\\tau} v_{o}(t)\\,$, where $\\,\\tau\\,$ is the regeneration time constant determined by device transconductances and the effective load capacitance. Let the initial condition at the start of regeneration be $\\,v_{o}(0) = v_{id} + n_{in}\\,$, where $\\,v_{id}\\,$ is a deterministic input differential voltage and $\\,n_{in}\\,$ is a zero-mean stochastic input-referred noise with Root Mean Square (RMS) $\\,\\sigma_{n,\\mathrm{in}}\\,$. Assume the comparator declares a decision when the magnitude of the differential output reaches a fixed threshold $\\,V_{\\mathrm{th}}\\,$, i.e., the decision time $\\,t_{d}\\,$ satisfies $\\,|v_{o}(t_{d})| = V_{\\mathrm{th}}\\,$. Under the small-noise assumption $\\,|n_{in}| \\ll |v_{id}|\\,$ so that a first-order linearization is valid, derive the approximate standard deviation of the decision-time fluctuation $\\,\\sigma_{t}\\,$ induced by $\\,n_{in}\\,$ in terms of $\\,\\tau\\,$, $\\,v_{id}\\,$, and $\\,\\sigma_{n,\\mathrm{in}}\\,$.\n\nThen, numerically evaluate $\\,\\sigma_{t}\\,$ for $\\,\\tau = 17.3\\,\\mathrm{ps}\\,$, $\\,v_{id} = 8.7\\,\\mathrm{mV}\\,$, and $\\,\\sigma_{n,\\mathrm{in}} = 0.42\\,\\mathrm{mV}\\,$. Round your answer to three significant figures. Express the final timing jitter in picoseconds.",
            "solution": "The problem will first be validated by extracting the given information and assessing its scientific and logical consistency.\n\n### Step 1: Extract Givens\n- The differential output voltage $v_o(t)$ is governed by the ordinary differential equation: $\\frac{d v_{o}(t)}{d t} = \\frac{1}{\\tau} v_{o}(t)$.\n- $\\tau$ is the regeneration time constant.\n- The initial condition at time $t=0$ is $v_{o}(0) = v_{id} + n_{in}$.\n- $v_{id}$ is a deterministic input differential voltage.\n- $n_{in}$ is a zero-mean stochastic input-referred noise with Root Mean Square (RMS) $\\sigma_{n,\\mathrm{in}}$.\n- A decision is made at time $t_d$ when $|v_{o}(t_{d})| = V_{\\mathrm{th}}$, where $V_{\\mathrm{th}}$ is a fixed threshold.\n- A small-noise assumption, $|n_{in}| \\ll |v_{id}|$, is provided, which validates linearization.\n- The objective is to derive the approximate standard deviation of the decision-time fluctuation, $\\sigma_t$, in terms of $\\tau$, $v_{id}$, and $\\sigma_{n,\\mathrm{in}}$.\n- Numerical values for evaluation are: $\\tau = 17.3\\,\\mathrm{ps}$, $v_{id} = 8.7\\,\\mathrm{mV}$, and $\\sigma_{n,\\mathrm{in}} = 0.42\\,\\mathrm{mV}$.\n- The final numerical answer must be in picoseconds and rounded to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it uses a standard first-order linear model for the regenerative phase of a dynamic comparator, a widely accepted simplification in integrated circuit analysis. The concepts of regeneration time constant, input-referred noise, and decision threshold are fundamental to comparator theory. The problem is well-posed, providing a differential equation, an initial condition, and a boundary condition for the decision time. The variables are clearly defined, and the task is specific. The small-noise assumption is explicitly stated, providing a clear path for approximation. The problem contains no scientific fallacies, contradictions, or ambiguities.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation of the Decision-Time Jitter\nThe dynamic behavior of the differential output voltage $v_o(t)$ is described by the linear time-invariant ordinary differential equation:\n$$\n\\frac{d v_{o}(t)}{d t} = \\frac{1}{\\tau} v_{o}(t)\n$$\nThis is a separable first-order differential equation, and its solution is an exponential function of time:\n$$\nv_{o}(t) = A \\exp\\left(\\frac{t}{\\tau}\\right)\n$$\nwhere $A$ is a constant of integration. We determine $A$ using the initial condition at the start of regeneration, $t=0$:\n$$\nv_{o}(0) = v_{id} + n_{in}\n$$\nSubstituting this into the general solution at $t=0$:\n$$\nv_{o}(0) = A \\exp(0) = A\n$$\nThus, the constant $A$ is equal to the initial differential voltage, and the specific solution for $v_o(t)$ is:\n$$\nv_{o}(t) = (v_{id} + n_{in}) \\exp\\left(\\frac{t}{\\tau}\\right)\n$$\nThe comparator reaches a decision at a time $t_d$ when the magnitude of the output voltage reaches a threshold $V_{\\mathrm{th}}$:\n$$\n|v_{o}(t_d)| = V_{\\mathrm{th}}\n$$\nSubstituting the expression for $v_o(t)$:\n$$\n\\left|(v_{id} + n_{in}) \\exp\\left(\\frac{t_d}{\\tau}\\right)\\right| = V_{\\mathrm{th}}\n$$\nSince $\\exp(t_d/\\tau)$ is always positive, we can write:\n$$\n|v_{id} + n_{in}| \\exp\\left(\\frac{t_d}{\\tau}\\right) = V_{\\mathrm{th}}\n$$\nThe problem states the small-noise condition $|n_{in}| \\ll |v_{id}|$. This implies that the sign of the term $(v_{id} + n_{in})$ is determined by the sign of $v_{id}$. Without loss of generality, let us assume $v_{id} > 0$ (and thus $v_{id} + n_{in} > 0$) and $V_{\\mathrm{th}} > 0$. The derivation for $v_{id} < 0$ yields an identical final result for the standard deviation.\nWith this assumption, the equation becomes:\n$$\n(v_{id} + n_{in}) \\exp\\left(\\frac{t_d}{\\tau}\\right) = V_{\\mathrm{th}}\n$$\nWe now solve for the decision time $t_d$:\n$$\n\\exp\\left(\\frac{t_d}{\\tau}\\right) = \\frac{V_{\\mathrm{th}}}{v_{id} + n_{in}}\n$$\nTaking the natural logarithm of both sides:\n$$\n\\frac{t_d}{\\tau} = \\ln\\left(\\frac{V_{\\mathrm{th}}}{v_{id} + n_{in}}\\right) = \\ln(V_{\\mathrm{th}}) - \\ln(v_{id} + n_{in})\n$$\nSo, the decision time $t_d$ is a function of the random noise variable $n_{in}$:\n$$\nt_d(n_{in}) = \\tau \\left[ \\ln(V_{\\mathrm{th}}) - \\ln(v_{id} + n_{in}) \\right]\n$$\nTo find the standard deviation of the fluctuation in $t_d$ due to $n_{in}$, we use a first-order Taylor series expansion of $t_d(n_{in})$ around $n_{in}=0$. This is justified by the small-noise assumption.\n$$\nt_d(n_{in}) \\approx t_d(0) + \\left. \\frac{d t_d}{d n_{in}} \\right|_{n_{in}=0} \\cdot n_{in}\n$$\nThe fluctuation in decision time, $\\Delta t_d$, is the difference between the noisy time and the nominal time:\n$$\n\\Delta t_d = t_d(n_{in}) - t_d(0) \\approx \\left. \\frac{d t_d}{d n_{in}} \\right|_{n_{in}=0} \\cdot n_{in}\n$$\nWe compute the derivative of $t_d$ with respect to $n_{in}$:\n$$\n\\frac{d t_d}{d n_{in}} = \\frac{d}{d n_{in}} \\left( \\tau \\left[ \\ln(V_{\\mathrm{th}}) - \\ln(v_{id} + n_{in}) \\right] \\right) = -\\tau \\frac{1}{v_{id} + n_{in}}\n$$\nEvaluating the derivative at $n_{in}=0$:\n$$\n\\left. \\frac{d t_d}{d n_{in}} \\right|_{n_{in}=0} = -\\frac{\\tau}{v_{id}}\n$$\nThe fluctuation $\\Delta t_d$ is therefore approximately:\n$$\n\\Delta t_d \\approx -\\frac{\\tau}{v_{id}} n_{in}\n$$\nThe standard deviation of the decision time, $\\sigma_t$, is the root mean square of this fluctuation. Since $n_{in}$ is a zero-mean random variable, $\\Delta t_d$ is also zero-mean. The variance $\\sigma_t^2$ is the expected value of $(\\Delta t_d)^2$:\n$$\n\\sigma_t^2 = E[(\\Delta t_d)^2] \\approx E\\left[\\left(-\\frac{\\tau}{v_{id}} n_{in}\\right)^2\\right] = \\frac{\\tau^2}{v_{id}^2} E[n_{in}^2]\n$$\nThe problem states that the RMS of the input noise is $\\sigma_{n,\\mathrm{in}}$. For a zero-mean variable, the variance is the square of the RMS value, so $E[n_{in}^2] = \\sigma_{n,\\mathrm{in}}^2$. Substituting this into the equation for $\\sigma_t^2$:\n$$\n\\sigma_t^2 = \\frac{\\tau^2 \\sigma_{n,\\mathrm{in}}^2}{v_{id}^2}\n$$\nTaking the square root gives the standard deviation $\\sigma_t$. Since standard deviations are non-negative, we use the absolute value for $v_{id}$:\n$$\n\\sigma_t = \\frac{\\tau \\sigma_{n,\\mathrm{in}}}{|v_{id}|}\n$$\n\n### Numerical Evaluation\nWe are given the following values:\n- $\\tau = 17.3\\,\\mathrm{ps} = 17.3 \\times 10^{-12}\\,\\mathrm{s}$\n- $v_{id} = 8.7\\,\\mathrm{mV} = 8.7 \\times 10^{-3}\\,\\mathrm{V}$\n- $\\sigma_{n,\\mathrm{in}} = 0.42\\,\\mathrm{mV} = 0.42 \\times 10^{-3}\\,\\mathrm{V}$\n\nWe substitute these values into the derived expression for $\\sigma_t$:\n$$\n\\sigma_t = \\frac{(17.3\\,\\mathrm{ps}) (0.42\\,\\mathrm{mV})}{8.7\\,\\mathrm{mV}}\n$$\nThe voltage units $(\\mathrm{mV})$ cancel out, leaving the result in picoseconds $(\\mathrm{ps})$:\n$$\n\\sigma_t = 17.3 \\times \\frac{0.42}{8.7}\\,\\mathrm{ps}\n$$\n$$\n\\sigma_t = 17.3 \\times 0.04827586... \\,\\mathrm{ps}\n$$\n$$\n\\sigma_t \\approx 0.8351724... \\,\\mathrm{ps}\n$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\n\\sigma_t \\approx 0.835\\,\\mathrm{ps}\n$$",
            "answer": "$$\n\\boxed{0.835}\n$$"
        },
        {
            "introduction": "Connecting circuit-level imperfections to system-level yield is the hallmark of modern integrated circuit design. In a complex system like an Analog-to-Digital Converter (ADC), the offset of each internal comparator must be tightly controlled to ensure the converter's resolution and linearity. This final practice moves from simple analysis to a comprehensive design-for-yield problem, asking you to determine the physical transistor dimensions needed to guarantee that, despite random manufacturing variations and across all operating corners, the comparator offset remains within the tight bounds required by the ADC specification .",
            "id": "4300798",
            "problem": "Consider the design of input-referred offset for comparators used inside an Analog-to-Digital Converter (ADC). Using the definition of quantization and decision levels, derive the constraint on the input-referred offset voltage $V_{\\mathrm{os}}$ necessary to preserve correct bit decisions and monotonic code transitions: show that the requirement is $|V_{\\mathrm{os}}|\\le \\tfrac{1}{2}\\mathrm{LSB}$, where $\\mathrm{LSB}=\\dfrac{V_{\\mathrm{FS}}}{2^{N}}$ for an $N$-bit ADC with full-scale input range $V_{\\mathrm{FS}}$. Therefore, conclude that the offset bound becomes $|V_{\\mathrm{os}}|\\le \\dfrac{V_{\\mathrm{FS}}}{2^{N+1}}$.\n\nNext, model random mismatch using the Pelgrom mismatch law. Assume the threshold-voltage mismatch of identically sized transistors has standard deviation $\\sigma(\\Delta V_{\\mathrm{t}})=\\dfrac{A_{V_{\\mathrm{t}}}}{\\sqrt{W L}}$, and the current factor mismatch has standard deviation $\\sigma\\!\\left(\\dfrac{\\Delta \\beta}{\\beta}\\right)=\\dfrac{A_{\\beta}}{\\sqrt{W L}}$, where $W$ is transistor width, $L$ is transistor length, $A_{V_{\\mathrm{t}}}$ and $A_{\\beta}$ are Pelgrom coefficients, and $\\beta$ is the transconductance parameter. Consider a symmetric differential input pair comparator (static) and a dynamic regenerative comparator; in both, the input-referred offset across Process, Voltage, Temperature (PVT) corners is dominated by the input pair mismatch and can be parameterized by architecture-dependent sensitivity coefficients. Specifically, under a given Process, Voltage, Temperature (PVT) corner characterized by input pair overdrive $V_{\\mathrm{ov}}$, the input-referred offset is modeled as a linear combination of mismatch contributions, with architecture-dependent sensitivity coefficients supplied in the test suite.\n\nYour task is to write a complete program that, for several test cases, computes the minimum transistor width $W$ (in $\\mu\\mathrm{m}$) for the input transistors (assume identical sizing) that achieves a target yield across all PVT corners. Yield is defined as the probability, under Monte Carlo mismatch sampling, that for a given $W$ the input-referred offset magnitude $|V_{\\mathrm{os}}|$ is less than or equal to $\\tfrac{1}{2}\\mathrm{LSB}$ simultaneously for all PVT corners. Use a fixed pseudo-random seed so that results are deterministic.\n\nFundamental base to be used:\n- Quantization of an $N$-bit ADC: $\\mathrm{LSB}=\\dfrac{V_{\\mathrm{FS}}}{2^{N}}$.\n- Decision correctness condition: comparator decision boundaries must not be shifted by more than $\\tfrac{1}{2}\\mathrm{LSB}$ due to input-referred offset to maintain correct coding.\n- Pelgrom mismatch law: $\\sigma(\\Delta V_{\\mathrm{t}})=\\dfrac{A_{V_{\\mathrm{t}}}}{\\sqrt{W L}}$ and $\\sigma\\!\\left(\\dfrac{\\Delta \\beta}{\\beta}\\right)=\\dfrac{A_{\\beta}}{\\sqrt{W L}}$.\n- Gaussian mismatch: $\\Delta V_{\\mathrm{t}}$ and $\\dfrac{\\Delta \\beta}{\\beta}$ are independent, zero-mean Gaussian random variables with the above standard deviations.\n\nProgram design requirements:\n- Implement a Monte Carlo estimator with a fixed pseudo-random seed to evaluate the yield as the fraction of samples that satisfy $|V_{\\mathrm{os}}|\\le \\tfrac{1}{2}\\mathrm{LSB}$ for all corners, given $W$.\n- For each architecture, use the input-referred offset mapping specified by sensitivity coefficients in the test case. Let $k_{V_{\\mathrm{t}}}$ and $k_{\\beta}$ denote the sensitivity coefficients; then in a corner with overdrive $V_{\\mathrm{ov}}$, model the input-referred offset for a Monte Carlo sample as\n  $$V_{\\mathrm{os}}=k_{V_{\\mathrm{t}}}\\,\\Delta V_{\\mathrm{t}}+k_{\\beta}\\,\\frac{V_{\\mathrm{ov}}}{2}\\,\\frac{\\Delta \\beta}{\\beta}.$$\n- Search for the minimum $W$ within specified bounds that achieves at least the target yield across all corners. Use a monotone search such as binary search over $W$.\n- Use the same Monte Carlo standard normal draws for all $W$ in a search to reduce variance during binary search by scaling with $\\dfrac{1}{\\sqrt{W L}}$.\n\nPhysical and numerical units:\n- Express $V_{\\mathrm{FS}}$ and $V_{\\mathrm{ov}}$ in $\\mathrm{V}$.\n- Express $W$ and $L$ in $\\mu\\mathrm{m}$.\n- The final widths must be reported in $\\mu\\mathrm{m}$ rounded to three decimal places.\n\nAngle units do not apply. Percentages must be expressed as decimals.\n\nTest suite:\nEach test case is a tuple containing\n$(\\text{architecture}, N, V_{\\mathrm{FS}}, \\text{yield}, L, W_{\\min}, W_{\\max}, A_{V_{\\mathrm{t}}}, A_{\\beta}, [V_{\\mathrm{ov},i}], k_{V_{\\mathrm{t}}}, k_{\\beta})$,\ninterpreted as described above. Use the following test cases:\n- Case $1$: $(\\text{static},\\,10,\\,1.8,\\,0.9973,\\,0.18,\\,0.5,\\,200.0,\\,0.003,\\,0.02,\\,[0.18,\\,0.14,\\,0.22],\\,1.0,\\,1.0)$.\n- Case $2$: $(\\text{dynamic},\\,12,\\,1.2,\\,0.99,\\,0.16,\\,0.3,\\,300.0,\\,0.002,\\,0.015,\\,[0.16,\\,0.12,\\,0.20],\\,0.7,\\,0.5)$.\n- Case $3$: $(\\text{static},\\,16,\\,1.0,\\,0.999,\\,0.09,\\,0.2,\\,1000.0,\\,0.0025,\\,0.01,\\,[0.10,\\,0.08,\\,0.12],\\,1.0,\\,1.0)$.\n- Case $4$: $(\\text{dynamic},\\,8,\\,0.5,\\,0.95,\\,0.07,\\,0.2,\\,100.0,\\,0.003,\\,0.02,\\,[0.08,\\,0.06,\\,0.10],\\,0.7,\\,0.6)$.\n\nAlgorithmic specifications:\n- Use a fixed pseudo-random seed $12345$.\n- Use at least $20000$ Monte Carlo samples per case.\n- If the target yield is not achievable at $W_{\\max}$, return $W_{\\max}$ for that case.\n\nFinal output format:\nYour program should produce a single line of output containing the resulting minimum widths for the four test cases, as a comma-separated list enclosed in square brackets, with each width rounded to three decimal places in $\\mu\\mathrm{m}$ (for example, $[w_1,w_2,w_3,w_4]$).",
            "solution": "The problem requires us to determine the minimum transistor width $W$ for a comparator's input pair to satisfy a given yield criterion, which is based on the input-referred offset voltage $V_{\\mathrm{os}}$. The solution involves three main parts: first, a theoretical derivation of the constraint on $V_{\\mathrm{os}}$ for correct Analog-to-Digital Converter (ADC) operation; second, the formulation of a statistical model for $V_{\\mathrm{os}}$ based on device mismatch; and third, the development of a numerical algorithm to find the minimum required $W$.\n\n### 1. Derivation of the Input-Referred Offset Constraint\n\nAn $N$-bit ADC quantizes a continuous analog input voltage $V_{\\mathrm{in}}$ within a full-scale range $V_{\\mathrm{FS}}$ into $2^N$ discrete digital levels. The resolution of the quantizer is defined by the Least Significant Bit (LSB), given by:\n$$\n\\mathrm{LSB} = \\frac{V_{\\mathrm{FS}}}{2^N}\n$$\nThe ideal decision levels, or thresholds, $V_{\\mathrm{d},k}$, are the input voltages at which the ADC output transitions from one digital code $k$ to the next, $k+1$. For a uniform quantizer, these levels are located halfway between the nominal quantization levels. The ideal decision levels are given by:\n$$\nV_{\\mathrm{d},k} = (k + \\frac{1}{2}) \\mathrm{LSB}, \\quad \\text{for } k = 0, 1, \\dots, 2^N - 2\n$$\nA comparator is the core component that performs the comparison of $V_{\\mathrm{in}}$ against these decision levels. An ideal comparator with inputs $V_+$ and $V_-$ transitions when $V_+ = V_-$. However, a real comparator has a non-zero input-referred offset voltage, $V_{\\mathrm{os}}$, due to manufacturing imperfections. The comparator transitions when $V_+ - V_- = V_{\\mathrm{os}}$. This means the effective decision level, $V'_{\\mathrm{d},k}$, is shifted from the ideal level by $V_{\\mathrm{os}}$:\n$$\nV'_{\\mathrm{d},k} = V_{\\mathrm{d},k} + V_{\\mathrm{os}}\n$$\nTo ensure that the ADC maintains monotonic behavior (i.e., the output code does not decrease as the input voltage increases) and has no missing codes, the shifted decision levels must not cross over their adjacent ideal neighbors. The \"quantization bin\" for a code $k$ is the voltage range $[V_{\\mathrm{d},k-1}, V_{\\mathrm{d},k}]$, which has a width of $\\mathrm{LSB}$. For correct quantization, the actual decision level $V'_{\\mathrm{d},k}$ must remain closer to its own ideal position $V_{\\mathrm{d},k}$ than to any other. The boundary of tolerance for the shift is halfway to the next ideal decision level. The distance between adjacent ideal decision levels is $\\mathrm{LSB}$. Therefore, the magnitude of the shift, $|V_{\\mathrm{os}}|$, must be less than half of this distance:\n$$\n|V_{\\mathrm{os}}| \\le \\frac{1}{2} \\mathrm{LSB}\n$$\nSubstituting the expression for the $\\mathrm{LSB}$, we arrive at the final constraint on the input-referred offset:\n$$\n|V_{\\mathrm{os}}| \\le \\frac{1}{2} \\left( \\frac{V_{\\mathrm{FS}}}{2^N} \\right) = \\frac{V_{\\mathrm{FS}}}{2^{N+1}}\n$$\nThis inequality is the fundamental requirement that must be met to guarantee correct ADC operation in the presence of comparator offset.\n\n### 2. Statistical Mismatch Model for Input-Referred Offset\n\nThe input-referred offset $V_{\\mathrm{os}}$ is primarily caused by random mismatches in the physical and electrical properties of the transistors in the comparator's input differential pair. The problem provides a linearized model for $V_{\\mathrm{os}}$ based on the two dominant mismatch sources: threshold voltage mismatch, $\\Delta V_{\\mathrm{t}}$, and current factor mismatch, $\\frac{\\Delta \\beta}{\\beta}$.\n$$\nV_{\\mathrm{os}} = k_{V_{\\mathrm{t}}}\\,\\Delta V_{\\mathrm{t}} + k_{\\beta}\\,\\frac{V_{\\mathrm{ov}}}{2}\\,\\frac{\\Delta \\beta}{\\beta}\n$$\nHere, $k_{V_{\\mathrm{t}}}$ and $k_{\\beta}$ are architecture-dependent sensitivity coefficients, and $V_{\\mathrm{ov}}$ is the overdrive voltage of the input pair, which depends on the Process, Voltage, and Temperature (PVT) corner.\n\nThe random mismatch effects are modeled by the Pelgrom law, which states that the standard deviation of a mismatch parameter is inversely proportional to the square root of the transistor area, $W L$.\n$$\n\\sigma(\\Delta V_{\\mathrm{t}}) = \\frac{A_{V_{\\mathrm{t}}}}{\\sqrt{W L}} \\quad \\text{and} \\quad \\sigma\\left(\\frac{\\Delta \\beta}{\\beta}\\right) = \\frac{A_{\\beta}}{\\sqrt{W L}}\n$$\nwhere $A_{V_{\\mathrm{t}}}$ and $A_{\\beta}$ are technology-specific Pelgrom coefficients, $W$ is the transistor gate width, and $L$ is the gate length.\n\nSince $\\Delta V_{\\mathrm{t}}$ and $\\frac{\\Delta \\beta}{\\beta}$ are modeled as independent, zero-mean Gaussian random variables, $V_{\\mathrm{os}}$ is also a zero-mean Gaussian random variable. Its variance, $\\sigma_{V_{\\mathrm{os}}}^2$, for a given PVT corner (characterized by $V_{\\mathrm{ov}}$), is the sum of the variances of the individual terms:\n$$\n\\sigma_{V_{\\mathrm{os}}}^2(V_{\\mathrm{ov}}) = \\left(k_{V_{\\mathrm{t}}}\\right)^2 \\sigma^2(\\Delta V_{\\mathrm{t}}) + \\left(k_{\\beta} \\frac{V_{\\mathrm{ov}}}{2}\\right)^2 \\sigma^2\\left(\\frac{\\Delta \\beta}{\\beta}\\right)\n$$\nSubstituting the Pelgrom models for the standard deviations:\n$$\n\\sigma_{V_{\\mathrm{os}}}^2(V_{\\mathrm{ov}}) = \\left(k_{V_{\\mathrm{t}}}\\right)^2 \\frac{A_{V_{\\mathrm{t}}}^2}{W L} + \\left(k_{\\beta} \\frac{V_{\\mathrm{ov}}}{2}\\right)^2 \\frac{A_{\\beta}^2}{W L} = \\frac{1}{W L} \\left[ (k_{V_{\\mathrm{t}}} A_{V_{\\mathrm{t}}})^2 + \\left(k_{\\beta} \\frac{V_{\\mathrm{ov}}}{2} A_{\\beta}\\right)^2 \\right]\n$$\nThis equation shows that the standard deviation of the offset, $\\sigma_{V_{\\mathrm{os}}}$, is proportional to $\\frac{1}{\\sqrt{W}}$. Increasing the transistor width $W$ reduces the mismatch and thus decreases the offset voltage standard deviation, leading to a higher probability of meeting the constraint $|V_{\\mathrm{os}}| \\le \\frac{V_{\\mathrm{FS}}}{2^{N+1}}$.\n\n### 3. Algorithmic Approach for Minimum Width Calculation\n\nThe objective is to find the minimum width $W$ in a given range $[W_{\\min}, W_{\\max}]$ such that the yield is at least a target value. Yield is defined as the probability that the offset constraint is met simultaneously for all specified PVT corners. A manufactured device has a single realization of physical mismatch ($\\Delta V_{\\mathrm{t}}$, $\\frac{\\Delta \\beta}{\\beta}$), but its offset voltage $V_{\\mathrm{os}}$ will vary with operating conditions ($V_{\\mathrm{ov}}$). Therefore, for a single Monte Carlo sample, we must verify the condition for all corners.\n\nThe algorithm proceeds as follows:\n\n1.  **Monte Carlo Setup**: For each test case, we generate a large number, $M=20000$, of random samples. To improve efficiency and reduce variance during the search for $W$, we generate $M$ pairs of standard normal random variates, $(z_{V_{\\mathrm{t}}, j}, z_{\\beta, j})$ for $j=1, \\dots, M$. These are then used to create \"base\" mismatch samples that are independent of geometry:\n    $$\n    \\Delta V_{\\mathrm{t}, j, \\text{base}} = z_{V_{\\mathrm{t}}, j} \\cdot A_{V_{\\mathrm{t}}} \\quad \\text{and} \\quad \\left(\\frac{\\Delta \\beta}{\\beta}\\right)_{j, \\text{base}} = z_{\\beta, j} \\cdot A_{\\beta}\n    $$\n    For any geometry $(W, L)$, the actual mismatch for sample $j$ can be found by scaling:\n    $$\n    \\Delta V_{\\mathrm{t}, j} = \\frac{\\Delta V_{\\mathrm{t}, j, \\text{base}}}{\\sqrt{W L}} \\quad \\text{and} \\quad \\left(\\frac{\\Delta \\beta}{\\beta}\\right)_{j} = \\frac{\\left(\\frac{\\Delta \\beta}{\\beta}\\right)_{j, \\text{base}}}{\\sqrt{W L}}\n    $$\n2.  **Yield Evaluation Function `Yield(W)`**: A function is created to compute the yield for a given width $W$.\n    - For each of the $M$ base mismatch samples, it calculates the geometry-scaled mismatch values.\n    - For each scaled mismatch sample, it computes the offset voltage $V_{\\mathrm{os},i}$ for every PVT corner $i$ (with its corresponding $V_{\\mathrm{ov},i}$).\n    - A sample is considered 'good' only if $|V_{\\mathrm{os},i}| \\le \\frac{V_{\\mathrm{FS}}}{2^{N+1}}$ for all corners $i$.\n    - The yield is the total number of 'good' samples divided by $M$.\n\n3.  **Binary Search**: Since yield is a monotonically non-decreasing function of $W$, we can efficiently find the minimum required $W$ using a binary search algorithm over the interval $[W_{\\min}, W_{\\max}]$.\n    - Initialize `low = W_min`, `high = W_max`, and a candidate answer `ans = W_max`.\n    - First, we check if the target yield is achievable even with the largest possible width, $W_{\\max}$. If `Yield(W_max)` is less than the target yield, no solution within the bounds exists, and we return $W_{\\max}$ as per the problem specification.\n    - Otherwise, we iterate a sufficient number of times:\n        a. Set `mid = (low + high) / 2`.\n        b. Evaluate `Yield(mid)`.\n        c. If `Yield(mid)` is greater than or equal to the target yield, `mid` is a potential solution. We record it (`ans = mid`) and try to find a smaller valid width by setting `high = mid`.\n        d. If `Yield(mid)` is less than the target yield, `mid` is too small. We must increase the width by setting `low = mid`.\n    - After the search converges, `ans` holds the minimum width that meets the criterion. This value is then rounded to three decimal places.\n\nThis combination of theoretical modeling, statistical simulation, and numerical optimization provides a robust method for designing comparator input stages to meet stringent performance and yield requirements.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimum transistor width W for comparator input pairs to meet\n    a specified yield target for input-referred offset voltage.\n    \"\"\"\n    \n    # Test cases defined in the problem statement\n    test_cases = [\n        # (architecture, N, V_FS, yield, L, W_min, W_max, A_Vt, A_beta, [V_ov_i], k_Vt, k_beta)\n        ('static', 10, 1.8, 0.9973, 0.18, 0.5, 200.0, 0.003, 0.02, [0.18, 0.14, 0.22], 1.0, 1.0),\n        ('dynamic', 12, 1.2, 0.99, 0.16, 0.3, 300.0, 0.002, 0.015, [0.16, 0.12, 0.20], 0.7, 0.5),\n        ('static', 16, 1.0, 0.999, 0.09, 0.2, 1000.0, 0.0025, 0.01, [0.10, 0.08, 0.12], 1.0, 1.0),\n        ('dynamic', 8, 0.5, 0.95, 0.07, 0.2, 100.0, 0.003, 0.02, [0.08, 0.06, 0.10], 0.7, 0.6),\n    ]\n\n    # Algorithmic specifications\n    NUM_SAMPLES = 20000\n    RANDOM_SEED = 12345\n    BINARY_SEARCH_ITERATIONS = 100\n\n    results = []\n    \n    # Initialize random number generator with a fixed seed for reproducibility\n    rng = np.random.default_rng(RANDOM_SEED)\n    \n    # Generate standard normal random variables once for all test cases and simulations\n    # This ensures consistency and fairness in comparison.\n    # Generate two sets, one for dVt and one for dbeta/beta\n    z_vt_samples = rng.standard_normal(NUM_SAMPLES)\n    z_beta_samples = rng.standard_normal(NUM_SAMPLES)\n\n    for case in test_cases:\n        (arch, N, V_FS, target_yield, L, W_min, W_max, \n         A_Vt, A_beta, V_ov_corners, k_Vt, k_beta) = case\n\n        # Calculate the maximum allowed input-referred offset\n        V_os_max = V_FS / (2**(N + 1))\n\n        # Generate base mismatch samples, independent of geometry (W, L)\n        delta_vt_base = z_vt_samples * A_Vt\n        delta_beta_base = z_beta_samples * A_beta\n        \n        # Pre-calculate offset terms for each corner that depend on V_ov\n        vov_corners_np = np.array(V_ov_corners)\n        \n        # The offset contribution from beta mismatch for each corner. Shape (num_corners, num_samples)\n        # This is V_os = k_vt * dVt + (k_beta * Vov/2) * (dbeta/beta)\n        # dVt and (dbeta/beta) will be scaled by 1/sqrt(WL)\n        term_k_vt = k_Vt * delta_vt_base\n        # The Vov dependent part is k_beta * V_ov/2\n        beta_coeffs = k_beta * vov_corners_np[:, np.newaxis] / 2\n        term_k_beta = beta_coeffs * delta_beta_base\n\n        def calculate_yield(W):\n            \"\"\"\n            Calculates the yield for a given transistor width W using Monte Carlo simulation.\n            \"\"\"\n            if W <= 0:\n                return 0.0\n                \n            # Scale factor for mismatch standard deviation\n            scale_factor = 1.0 / np.sqrt(W * L)\n            \n            # Calculate scaled mismatch samples\n            delta_vt = term_k_vt * scale_factor\n            delta_beta = term_k_beta * scale_factor\n            \n            # V_os for all samples and all corners. Shape (num_corners, num_samples)\n            V_os_samples = delta_vt + delta_beta\n            \n            # Check if |V_os| <= V_os_max for all corners\n            # max() along axis 0 finds the max absolute offset over all corners for each sample\n            max_abs_vos_per_sample = np.max(np.abs(V_os_samples), axis=0)\n            \n            # Count how many samples pass the criterion\n            passed_samples = np.sum(max_abs_vos_per_sample <= V_os_max)\n            \n            return passed_samples / NUM_SAMPLES\n\n        # Check if the target yield is achievable at W_max\n        if calculate_yield(W_max) < target_yield:\n            results.append(round(W_max, 3))\n            continue\n\n        # Binary search for the minimum W\n        low = W_min\n        high = W_max\n        ans = W_max\n        \n        for _ in range(BINARY_SEARCH_ITERATIONS):\n            mid = (low + high) / 2\n            if mid == low or mid == high: # Avoid getting stuck\n                break\n                \n            current_yield = calculate_yield(mid)\n            \n            if current_yield >= target_yield:\n                # Met the target, try for a smaller W\n                ans = mid\n                high = mid\n            else:\n                # Did not meet the target, need a larger W\n                low = mid\n        \n        results.append(round(ans, 3))\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}