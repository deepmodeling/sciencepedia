{
    "hands_on_practices": [
        {
            "introduction": "等价性检查的核心是比较两个电路的功能是否相同。本练习将从最基本的组合逻辑等价性检查（CEC）入手，介绍构建“比较器”（miter）电路的标准方法。通过在一个被称为“关心集”（care set）的特定输入子集上进行分析，你将亲手运用布尔代数来确定两个设计在何种条件下不等价，从而掌握在受限环境中进行验证的核心技能。",
            "id": "4270275",
            "problem": "考虑两个组合电路 $C_{A}$ 和 $C_{B}$，它们都作用于布尔输入 $a$、$b$、$c$、$d$、$e \\in \\{0,1\\}$，并各自产生两个输出。电路 $C_{A}$ 的输出为\n- $o_{1}^{A} = a \\oplus b \\oplus (c \\wedge d) \\oplus e$，\n- $o_{2}^{A} = (a \\wedge c) \\oplus (b \\wedge d) \\oplus e$，\n而电路 $C_{B}$ 的输出为\n- $o_{1}^{B} = a \\oplus b \\oplus (c \\wedge \\neg d) \\oplus e$，\n- $o_{2}^{B} = (a \\wedge c) \\oplus (b \\wedge \\neg d) \\oplus e$，\n其中 $\\oplus$ 表示异或 (XOR)，$\\wedge$ 表示逻辑与 (AND)，$\\vee$ 表示逻辑或 (OR)，$\\neg$ 表示逻辑非 (NOT)。\n\n您将在一个受限的输入环境（称为关心集）下检查等价性。关心集 $\\mathcal{C}$ 由以下输入约束定义：\n- 在变量 $\\{a,b,c,d,e\\}$ 中，恰好有 $3$ 个变量等于 $1$。\n- 输入 $d$ 受到函数约束 $d = a \\oplus e$。\n\n仅使用组合等价性检查 (CEC) 的基本定义和布尔代数中的规范 Miter 结构，确定在关心集 $\\mathcal{C}$ 中，使得 $C_{A}$ 和 $C_{B}$ 不等价的输入赋值的确切数量。请以单个整数形式提供您的最终答案。无需四舍五入，也无物理单位。",
            "solution": "用户要求我解决一个组合等价性检查的问题。\n\n### 步骤 1：提取已知信息\n-   **电路 $C_A$**：\n    -   输入：$a, b, c, d, e \\in \\{0,1\\}$\n    -   输出：\n        -   $o_{1}^{A} = a \\oplus b \\oplus (c \\wedge d) \\oplus e$\n        -   $o_{2}^{A} = (a \\wedge c) \\oplus (b \\wedge d) \\oplus e$\n-   **电路 $C_B$**：\n    -   输入：$a, b, c, d, e \\in \\{0,1\\}$\n    -   输出：\n        -   $o_{1}^{B} = a \\oplus b \\oplus (c \\wedge \\neg d) \\oplus e$\n        -   $o_{2}^{B} = (a \\wedge c) \\oplus (b \\wedge \\neg d) \\oplus e$\n-   **运算符**：\n    -   $\\oplus$：异或 (XOR)\n    -   $\\wedge$：逻辑与 (AND)\n    -   $\\vee$：逻辑或 (OR)\n    -   $\\neg$：逻辑非 (NOT)\n-   **关心集 $\\mathcal{C}$**：由输入 $\\{a,b,c,d,e\\}$ 上的两个约束定义。\n    1.  恰好有 3 个变量等于 1。\n    2.  输入 $d$ 受到函数约束 $d = a \\oplus e$。\n-   **任务**：\n    -   使用规范 Miter 结构确定在关心集 $\\mathcal{C}$ 中使 $C_{A}$ 和 $C_{B}$ 不等价的输入赋值的确切数量。\n    -   以单个整数形式提供答案。\n\n### 步骤 2：使用提取的已知信息进行验证\n该问题定义明确，在数字逻辑设计和电子设计自动化 (EDA) 领域具有科学依据。\n-   **科学依据**：该问题使用标准的布尔代数和组合逻辑概念，这些是计算机工程和数学的基础。所有定义和运算都是标准的。\n-   **适定性**：该问题指明了电路、输入、约束（关心集）以及不等价的条件。它要求一个特定的量（输入向量的数量），对此应该存在唯一解。\n-   **客观性**：语言精确，没有歧义或主观性。约束条件是形式化指定的。\n-   该问题是自包含的，并提供了得出解决方案所需的所有必要信息。所提供的数据中没有矛盾之处。\n\n### 步骤 3：结论与行动\n问题有效。我将继续进行求解。\n\n为了确定两个电路 $C_{A}$ 和 $C_{B}$ 何时不等价，我们使用规范 Miter 结构。两个组合电路等价，当且仅当在关心集内的所有可能输入赋值下，它们对应的输出都相同。如果至少有一对对应的输出不同，那么对于一个特定的输入赋值，它们就是不等价的。\n\nMiter 电路的输出（我们称之为 $M$）是一个布尔函数，如果电路不等价，其值为 $1$，如果等价，则为 $0$。对于具有多个输出的电路，Miter 输出是每对相应输出的异或差值的逻辑或。\n在本例中，每个电路有两个输出，Miter 函数为：\n$$M = (o_{1}^{A} \\oplus o_{1}^{B}) \\vee (o_{2}^{A} \\oplus o_{2}^{B})$$\n我们需要找到在关心集 $\\mathcal{C}$ 中使得 $M=1$ 的输入赋值 $(a,b,c,d,e)$ 的数量。\n\n首先，我们来简化 $M$ 表达式中的两个异或项。\n对于第一对输出：\n$$o_{1}^{A} \\oplus o_{1}^{B} = (a \\oplus b \\oplus (c \\wedge d) \\oplus e) \\oplus (a \\oplus b \\oplus (c \\wedge \\neg d) \\oplus e)$$\n使用异或的结合律和交换律，以及恒等式 $x \\oplus x = 0$：\n$$o_{1}^{A} \\oplus o_{1}^{B} = (a \\oplus a) \\oplus (b \\oplus b) \\oplus (e \\oplus e) \\oplus (c \\wedge d) \\oplus (c \\wedge \\neg d)$$\n$$o_{1}^{A} \\oplus o_{1}^{B} = 0 \\oplus 0 \\oplus 0 \\oplus (c \\wedge d) \\oplus (c \\wedge \\neg d)$$\n$$o_{1}^{A} \\oplus o_{1}^{B} = c \\wedge (d \\oplus \\neg d)$$\n因为对于任何布尔变量 $x$，都有 $x \\oplus \\neg x = 1$，所以我们有 $d \\oplus \\neg d = 1$。\n$$o_{1}^{A} \\oplus o_{1}^{B} = c \\wedge 1 = c$$\n\n对于第二对输出：\n$$o_{2}^{A} \\oplus o_{2}^{B} = ((a \\wedge c) \\oplus (b \\wedge d) \\oplus e) \\oplus ((a \\wedge c) \\oplus (b \\wedge \\neg d) \\oplus e)$$\n类似地，\n$$o_{2}^{A} \\oplus o_{2}^{B} = ((a \\wedge c) \\oplus (a \\wedge c)) \\oplus (e \\oplus e) \\oplus (b \\wedge d) \\oplus (b \\wedge \\neg d)$$\n$$o_{2}^{A} \\oplus o_{2}^{B} = 0 \\oplus 0 \\oplus (b \\wedge d) \\oplus (b \\wedge \\neg d)$$\n$$o_{2}^{A} \\oplus o_{2}^{B} = b \\wedge (d \\oplus \\neg d)$$\n$$o_{2}^{A} \\oplus o_{2}^{B} = b \\wedge 1 = b$$\n\n将这些简化后的表达式代回 Miter 函数 $M$：\n$$M = c \\vee b$$\n因此，对于给定的输入赋值，电路 $C_A$ 和 $C_B$ 不等价，当且仅当条件 $b \\vee c = 1$ 满足。这等价于声明变量 $b$ 或 $c$ 中至少有一个必须等于 $1$。\n\n问题现在简化为计算满足关心集 $\\mathcal{C}$ 约束条件和不等价条件 $b \\vee c = 1$ 的输入向量 $(a,b,c,d,e)$ 的数量。关心集 $\\mathcal{C}$ 由以下条件定义：\n1.  输入向量的汉明权重为 $3$。也就是说，算术和 $a+b+c+d+e = 3$。\n2.  函数约束 $d = a \\oplus e$。\n\n我们需要找到满足以下条件的向量 $(a,b,c,d,e)$ 集合的大小：\n1.  $a+b+c+d+e = 3$\n2.  $d = a \\oplus e$\n3.  $b \\vee c = 1$\n\n我们首先分析关心集 $\\mathcal{C}$ 的约束。我们可以通过考虑对 $(a,e)$ 的可能取值来枚举有效的赋值，这反过来又决定了 $d$ 的值。\n\n情况 1：$(a,e) = (0,0)$。\n根据函数约束， $d = a \\oplus e = 0 \\oplus 0 = 0$。\n这三个变量的值是 $(a,d,e) = (0,0,0)$。它们对汉明权重的贡献是 $0$。\n汉明权重约束变为 $a+b+c+d+e = 0+b+c+0+0 = 3$，所以 $b+c = 3$。\n由于 $b,c \\in \\{0,1\\}$， $b+c$ 的最大值为 $2$。因此，$b+c=3$ 是不可能的。在这种情况下有 $0$ 个赋值。\n\n情况 2：$(a,e) = (0,1)$。\n根据函数约束， $d = a \\oplus e = 0 \\oplus 1 = 1$。\n这三个变量的值是 $(a,d,e) = (0,1,1)$。它们对汉明权重的贡献是 $2$。\n汉明权重约束变为 $a+b+c+d+e = 0+b+c+1+1 = 3$，所以 $b+c = 1$。\n这个条件被两对 $(b,c)$ 的值满足：$(1,0)$ 和 $(0,1)$。\n这给了我们关心集中的两个有效输入向量：\n-   $(a,b,c,d,e) = (0,1,0,1,1)$\n-   $(a,b,c,d,e) = (0,0,1,1,1)$\n有 $2$ 个这样的赋值。\n\n情况 3：$(a,e) = (1,0)$。\n根据函数约束， $d = a \\oplus e = 1 \\oplus 0 = 1$。\n这三个变量的值是 $(a,d,e) = (1,1,0)$。它们对汉明权重的贡献是 $2$。\n汉明权重约束变为 $a+b+c+d+e = 1+b+c+1+0 = 3$，所以 $b+c = 1$。\n这被 $(b,c)=(1,0)$ 和 $(b,c)=(0,1)$ 满足。\n这给了我们关心集中的两个有效输入向量：\n-   $(a,b,c,d,e) = (1,1,0,1,0)$\n-   $(a,b,c,d,e) = (1,0,1,1,0)$\n有 $2$ 个这样的赋值。\n\n情况 4：$(a,e) = (1,1)$。\n根据函数约束， $d = a \\oplus e = 1 \\oplus 1 = 0$。\n这三个变量的值是 $(a,d,e) = (1,0,1)$。它们对汉明权重的贡献是 $2$。\n汉明权重约束变为 $a+b+c+d+e = 1+b+c+0+1 = 3$，所以 $b+c = 1$。\n这被 $(b,c)=(1,0)$ 和 $(b,c)=(0,1)$ 满足。\n这给了我们关心集中的两个有效输入向量：\n-   $(a,b,c,d,e) = (1,1,0,0,1)$\n-   $(a,b,c,d,e) = (1,0,1,0,1)$\n有 $2$ 个这样的赋值。\n\n总而言之，关心集 $\\mathcal{C}$ 中的输入赋值数量是每种情况计数之和：$0+2+2+2 = 6$。\n关心集为 $\\mathcal{C} = \\{(0,1,0,1,1), (0,0,1,1,1), (1,1,0,1,0), (1,0,1,1,0), (1,1,0,0,1), (1,0,1,0,1)\\}$。\n\n现在我们必须检查这 $6$ 个赋值中有多少个满足不等价条件 $M = b \\vee c = 1$。\n回顾我们的案例分析，关心集中的每一个有效赋值都是从条件 $b+c=1$ 推导出来的。\n如果 $b+c=1$（其中 $b, c$ 是布尔变量），那么必然是一个变量为 $1$ 而另一个为 $0$。\n对于任何这样的值对，条件 $b \\vee c = 1$ 都被满足。\n例如，如果 $(b,c)=(1,0)$，那么 $b \\vee c = 1 \\vee 0 = 1$。\n如果 $(b,c)=(0,1)$，那么 $b \\vee c = 0 \\vee 1 = 1$。\n因此，对于构成关心集 $\\mathcal{C}$ 的所有 $6$ 个输入赋值，不等价条件 $b \\vee c = 1$ 都得到满足。\n\n这意味着对于关心集中的每一个输入向量，电路 $C_A$ 和 $C_B$ 都是不等价的。\n此类输入赋值的数量是关心集的总大小，即 $6$。\n\n或者，我们可以确定 $\\mathcal{C}$ 中的任何向量都必须满足 $b \\vee c = 1$。为了反证，假设存在一个向量 $(a,b,c,d,e) \\in \\mathcal{C}$ 使得 $b \\vee c = 0$。这意味着 $b=0$ 且 $c=0$。那么汉明权重约束 $a+b+c+d+e=3$ 简化为 $a+d+e=3$。对于布尔变量，这要求 $a=1, d=1, e=1$。然而，这些值与第二个关心集约束 $d=a \\oplus e$ 相矛盾，因为 $1 \\oplus 1 = 0 \\neq 1$。因此，$\\mathcal{C}$ 中没有任何向量可以有 $b=0$ 和 $c=0$。由此可知，$\\mathcal{C}$ 中的所有向量都必须满足 $b \\vee c=1$。问题因此等价于求 $\\mathcal{C}$ 的大小，我们已经计算出其大小为 $6$。",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "现实世界中的硬件系统大多是时序逻辑，并通过复杂的协议进行通信。本练习将带领你从组合逻辑迈向更具挑战性的时序系统验证，重点探讨在带有“就绪/有效”（ready/valid）握手协议的设计中，如何正确定义“环境”与“等价”标准。理解基于事务（transaction-based）的等价性是验证现代片上系统（SoC）的关键，它要求我们关注数据流的宏观正确性，而非简单地逐周期比较信号。",
            "id": "4270279",
            "problem": "考虑两个同步硬件模块，它们在就绪/有效握手协议下，作为有限状态机实现了相同的流处理规范。设 $M_1$ 表示寄存器传输级 (RTL) 设计，$M_2$ 表示通过重定时获得的门级网表，该重定时引入了一个额外的流水线阶段。两台机器都由一个单一的全局时钟驱动，其可观测的 I/O 包括时间索引的输入信号 $(r_t, v_t, d_t)$ 和输出信号 $o^{(1)}_t$ 和 $o^{(2)}_t$，其中 $t \\in \\mathbb{N}$ 是时钟索引，$r_t \\in \\{0,1\\}$ 是消费者就绪信号，$v_t \\in \\{0,1\\}$ 是生产者有效信号，$d_t \\in \\{0,1\\}^w$ 是位宽为 $w \\in \\mathbb{N}$ 的数据向量。这些机器在传输的数据项上实现了一个纯函数 $f:\\{0,1\\}^w \\to \\{0,1\\}^{w'}$。RTL 设计 $M_1$ 和网表 $M_2$ 相差一个流水线阶段，因此 $M_2$ 相对于 $M_1$ 的输出延迟恰好增加 $1$，但它们在其他方面功能上是相同的。\n\n定义事务时间为满足 $r_t \\land v_t = 1$ 的任何时钟索引 $t$。设事务时间序列为 $(t_i)_{i \\in \\mathbb{N}}$（按递增顺序排列），相应的传输数据序列为 $x_i = d_{t_i}$，对所有 $i \\in \\mathbb{N}$ 成立。该规范要求在某些输出时间 $(u^{(1)}_i)_{i \\in \\mathbb{N}}$ 和 $(u^{(2)}_i)_{i \\in \\mathbb{N}}$ 的输出满足 $o^{(1)}_{u^{(1)}_i} = f(x_i)$ 和 $o^{(2)}_{u^{(2)}_i} = f(x_i)$，且具有固定的延迟差 $\\ell_2 - \\ell_1 = 1$，即对于所有 $i \\in \\mathbb{N}$，有 $u^{(2)}_i = u^{(1)}_i + 1$。\n\n等价性检查是通过在特定环境下比较 $M_1$ 和 $M_2$ 来执行的，该环境将输入序列约束为与握手协议一致的序列。一个环境由一组容许的输入迹线 $(r_t, v_t, d_t)_{t \\in \\mathbb{N}}$ 来表征。以下核心定义和事实适用：\n\n- 一个同步有限状态机 $M$ 在输入 $I_t$ 的作用下，通过状态转移 $s_{t+1} = T(s_t, I_t)$ 和输出 $O_t = H(s_t, I_t)$ (Mealy) 或 $O_t = G(s_t)$ (Moore) 来生成输出 $O_t$，其中 $T$ 是某个转移函数，$H$ 或 $G$ 是输出函数，初始状态 $s_0$ 由复位决定。\n- 在就绪/有效语义下，事务恰好在 $r_t \\land v_t = 1$ 时发生，与该事务相关的数据 $d_t$ 必须是消费者将作为 $x_i$ 处理的数据项。\n- 为了实现有意义的基于事务的等价性，环境必须确保事务的活性和在待处理握手期间数据的稳定性，从而使序列 $(x_i)_{i \\in \\mathbb{N}}$ 是良定义的，并且两台机器看到相同的有序数据项。\n\n你需要决定哪组假设和约束能使等价性证明在事务语义和所述延迟偏移方面既充分又可靠。选择一个选项，该选项正确地描述了一个合适的环境和比较关系，使得对于所有容许的迹线，$M_1$ 和 $M_2$ 的输出在以下意义上是可证明等价的：它们在相差恰好 1 个周期的输出时间点上，产生相同的序列 $(f(x_i))_{i \\in \\mathbb{N}}$。\n\n哪个选项是正确的？\n\nA. 约束环境，使得对所有 $t \\in \\mathbb{N}$ 都有 $v_t \\Rightarrow r_t$，即仅当 ready 被置位时才置位 valid；要求对所有 $t \\in \\mathbb{N}$ 都有 $o^{(2)}_{t+1} = o^{(1)}_t$。\n\nB. 仅通过置位一个公共同步复位来约束环境，该复位将 $M_1$ 和 $M_2$ 设置为已知的等价初始状态；要求逐周期相等（允许一个统一的移位），即对所有 $t \\in \\mathbb{N}$ 都有 $o^{(2)}_{t+1} = o^{(1)}_t$，而不对 $(r_t, v_t, d_t)$ 施加任何与握手相关的约束。\n\nC. 通过标准的握手稳定性和活性条件来约束环境：对所有 $t \\in \\mathbb{N}$，如果 $v_t = 1$ 且 $r_t = 0$，则 $v_{t+1} = 1$ 且 $d_{t+1} = d_t$；并且对所有 $t \\in \\mathbb{N}$，如果 $v_t = 1$，则存在 $t' \\ge t$ 使得 $r_{t'} = 1$ (最终握手)。此外，仅在具有已知延迟差的事务索引处对齐输出，即存在输出时间 $(u^{(1)}_i)_{i \\in \\mathbb{N}}$ 和 $(u^{(2)}_i)_{i \\in \\mathbb{N}}$，使得 $o^{(1)}_{u^{(1)}_i} = f(x_i)$ 和 $o^{(2)}_{u^{(2)}_i} = f(x_i)$，并且对于所有 $i \\in \\mathbb{N}$ 都有 $u^{(2)}_i = u^{(1)}_i + 1$。\n\nD. 通过将 $M_2$ 中的任何未知或未初始化的信号声明为“无关”值来约束环境，并忽略 $r_t \\land v_t = 0$ 的周期；仅在每个周期 $t \\in \\mathbb{N}$ 比较组合输出 $o^{(1)}_t$ 和 $o^{(2)}_t$，而不进行对齐。",
            "solution": "我们从同步机器、握手语义和环境约束下的观测等价性的基本定义开始。一个同步硬件模块被建模为一个有限状态机，其转移函数和输出函数由时钟同步的输入驱动。在就绪/有效协议下，一个事务由合取式 $r_t \\land v_t = 1$ 精确定义。在第 $i$ 次事务中处理的数据项 $x_i$ 是在第 $i$ 个事务时间 $t_i$ 时的值 $d_{t_i}$。功能规范指出，两台机器在每个传输的数据项上都实现了相同的纯函数 $f$。由于 $M_2$ 相对于 $M_1$ 恰好增加了一个流水线阶段，与给定事务相关的输出会晚一个周期出现，我们将其形式化为 $u^{(2)}_i = u^{(1)}_i + 1$。\n\n为了在特定环境下证明 $M_1$ 和 $M_2$ 的等价性，该环境必须确保以下几点：\n\n- 对于感兴趣的输入迹线，事务时间序列 $(t_i)_{i \\in \\mathbb{N}}$ 存在且是良定义的。这是一个活性要求：如果生产者置位了 $v_t = 1$，那么消费者最终必须在某个 $t' \\ge t$ 时置位 $r_{t'} = 1$，从而使事务完成并成为数据流中可观测的一部分。否则，由于缺少事务，与事务相关的输出比较将变得毫无意义，等价性可能变为空洞。\n- 与待处理事务相关的数据必须保持稳定直到握手完成，并且有效信号必须保持置位以表明数据项处于待处理状态。形式上，如果 $v_t = 1$ 且 $r_t = 0$，则必须约束环境使得 $v_{t+1} = 1$ 且 $d_{t+1} = d_t$。这保证了无论内部缓冲或反压如何，两台机器在 $t_i$ 时刻都能看到相同的、良定义的 $x_i$，因此函数映射 $f(x_i)$ 是可比较的。\n- 比较关系应反映事务语义和已知的延迟差异，而不是原始的周期对齐。具体来说，应该在按事务索引的输出时间点比较 $o^{(1)}_{u^{(1)}_i}$ 和 $o^{(2)}_{u^{(2)}_i}$，并强制要求 $u^{(2)}_i = u^{(1)}_i + 1$。\n\n这些条件根植于就绪/有效协议下的事务定义和同步有限状态机的行为，它们避免了对环境的过度约束（这可能掩盖真实差异并导致不可靠的集成证明）和约束不足（这可能产生虚假的反例或无意义的比较）。\n\n现在我们分析每个选项：\n\n选项 A: 约束环境，使得对所有 $t \\in \\mathbb{N}$ 都有 $v_t \\Rightarrow r_t$，并要求对所有 $t \\in \\mathbb{N}$ 都有 $o^{(2)}_{t+1} = o^{(1)}_t$。这个假设强制要求仅当 ready 被置位时才置位 valid，这意味着生产者不能提供数据项，除非消费者也同时就绪。这违反了标准的就绪/有效语义，其中 $v_t$ 可以独立置位，并且必须持续到握手完成。约束 $v_t \\Rightarrow r_t$ 消除了存在反压（当 $v_t = 1$ 时 $r_t = 0$）的合法行为，实际上排除了容许的迹线，并可能掩盖在合法反压下会出现的差异。此外，对所有周期 $t$ 进行 $o^{(2)}_{t+1} = o^{(1)}_t$ 的比较忽略了事务语义，并假定即使在空闲周期也存在逐周期的统一移位，而当输出在事务之间可能被门控或停顿时，这是无法保证的。因此，选项 A 是不正确的。\n\n选项 B: 仅通过复位对齐来约束，并要求逐周期相等（允许一个移位），即对所有 $t \\in \\mathbb{N}$ 都有 $o^{(2)}_{t+1} = o^{(1)}_t$，不施加任何与握手相关的约束。这移除了关键的环境约束，并在每个周期都比较输出，而不管是否有事务发生，从而混淆了空闲行为、内部的门控和事务输出。在有反压和缓冲的情况下，$M_1$ 和 $M_2$ 可以在事务输出上功能等价的同时，表现出不同的空闲周期输出行为。没有对 $(r_t, v_t, d_t)$ 的稳定性和活性约束，即使对于等价的设计，等式 $o^{(2)}_{t+1} = o^{(1)}_t$ 对所有 $t$ 而言通常也是不成立的，这会导致虚假的非等价性。因此，选项 B 是不正确的。\n\n选项 C: 通过握手稳定性和活性来约束环境：如果 $v_t = 1$ 且 $r_t = 0$，则 $v_{t+1} = 1$ 且 $d_{t+1} = d_t$（有效保持和数据稳定），并且如果 $v_t = 1$，则存在 $t' \\ge t$ 使得 $r_{t'} = 1$（最终握手）。此外，仅在具有已知延迟差的事务索引处比较输出，即存在输出时间 $(u^{(1)}_i)_{i \\in \\mathbb{N}}$ 和 $(u^{(2)}_i)_{i \\in \\mathbb{N}}$，使得 $o^{(1)}_{u^{(1)}_i} = f(x_i)$ 和 $o^{(2)}_{u^{(2)}_i} = f(x_i)$，并且对于所有 $i \\in \\mathbb{N}$ 都有 $u^{(2)}_i = u^{(1)}_i + 1$。这些条件正是标准的就绪/有效环境要求，确保了序列 $(x_i)_{i \\in \\mathbb{N}}$ 是良定义的，并且两台机器以相同顺序观察到相同的事务。比较关系遵循了事务语义和已知的流水线偏移。在这些约束下，根据两台机器中 $f$ 的功能同一性以及输出延迟 $\\ell_2 - \\ell_1 = 1$ 的定义，可以得出结论：对于所有容许的迹线，都有 $o^{(1)}_{u^{(1)}_i} = o^{(2)}_{u^{(1)}_i + 1}$ 且两者都等于 $f(x_i)$，从而建立了等价性。选项 C 是正确的。\n\n选项 D: 通过将 $M_2$ 中的未知值视为“无关”来约束，并在忽略 $r_t \\land v_t = 0$ 的周期的情况下，每个周期比较组合输出。将未知值声明为“无关”移除了对正确初始化的有意义的责任，并可能掩盖真实的失配，从而产生潜在的假阳性结果。在没有事务对齐的情况下每个周期比较组合输出，仍然混淆了空闲周期和事务周期，并忽略了已确定的延迟差异，使得该检查对于事务语义而言既不充分也不可靠。因此，选项 D 是不正确的。\n\n总之，只有选项 C 中的环境和比较关系既遵循了就绪/有效协议语义，又恰当地考虑了已知的延迟差异，从而为 $M_1$ 和 $M_2$ 之间的等价性检查提供了充分且可靠的基础。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "虽然物理电路只处理0和1，但验证工具为了处理未初始化状态或进行抽象，常常引入额外的逻辑值，如“X”（未知态）。本练习探讨了硬件实现的二值逻辑与仿真工具中使用的多值逻辑之间的形式化关系。理解这种关系——特别是“X态”的传播行为——对于正确解释验证结果、避免因“X态”的悲观或乐观传播而导致的错误结论至关重要。",
            "id": "4270282",
            "problem": "考虑两个门级组合网表，记为 $C_1$ 和 $C_2$，每个都实现了一个从 $n$ 个主输入到 $m$ 个主输出的向量布尔函数。令底层二值域为 $B = \\{0,1\\}$，四值域为 $V = \\{0,1,X,Z\\}$。在四值求值中，将高阻态值 $Z$ 视为未知，也就是说，对于逻辑求值，将 $Z$ 等同于 $X$。假设所有门都根据电子设计自动化 (EDA) 仿真中用于硬件描述语言中按位逻辑的标准四值语义进行求值：例如，对于按位 $\\land$ (与)，$0 \\land v = 0$, $1 \\land v = v$, $X \\land 0 = 0$, $X \\land 1 = X$, 以及 $X \\land X = X$；对于按位 $\\lor$ (或)，$1 \\lor v = 1$, $0 \\lor v = v$, $X \\lor 0 = X$, $X \\lor 1 = 1$, 以及 $X \\lor X = X$；对于按位 $\\oplus$ (异或)，$0 \\oplus v = v$, $1 \\oplus v = \\neg v$, 以及每当 $v \\in \\{0,1,X\\}$ 时 $X \\oplus v = X$；对于按位取反，$\\neg 0 = 1$, $\\neg 1 = 0$, 以及 $\\neg X = X$。\n\n定义 Miter 电路 $M$，它通过计算一个单位输出来比较 $C_1$ 和 $C_2$：\n$$\nM(u) \\;=\\; \\bigvee_{i=1}^{m} \\left( y_{1,i}(u) \\oplus y_{2,i}(u) \\right),\n$$\n其中 $y_{1,i}(u)$ 和 $y_{2,i}(u)$ 分别表示 $C_1$ 和 $C_2$ 在输入向量 $u$ 上求值得到的第 $i$ 个输出。标准的二值等价性概念是，如果对于所有 $b \\in B^n$，在二值求值下 $M(b) = 0$，那么 $C_1$ 和 $C_2$ 是等价的。\n\n为了关联四值语义和二值语义，通过 $\\gamma(0) = \\{0\\}$，$\\gamma(1) = \\{1\\}$ 和 $\\gamma(X) = \\gamma(Z) = \\{0,1\\}$ 定义具体化函数 $\\gamma: V \\to \\mathcal{P}(B)$。将 $\\gamma$ 逐点地扩展到向量，从而对于 $u \\in V^n$，$\\gamma(u) \\subseteq B^n$ 是与 $u$ 一致的所有二值补全的集合。在单元素集合上通过 $\\alpha(\\{0\\}) = 0$，$\\alpha(\\{1\\}) = 1$ 以及在集合 $\\{0,1\\}$ 上通过 $\\alpha(\\{0,1\\}) = X$ 定义抽象化函数 $\\alpha: \\mathcal{P}(B) \\to V$，并将其逐点地扩展到向量。假设门的语义关于信息序是单调的，在该序中 $X$（和 $Z$）表示比 $0$ 或 $1$ 更少的信息，因此四值求值是所有二值补全的一个过近似：对于由上述门组成的任何表达式 $E$ 和任何 $u \\in V^n$，每个 $b \\in \\gamma(u)$ 都满足 $E(b) \\in \\gamma(E(u))$。\n\n在这些假设下，考虑以下关于使用四值求值来推断 $C_1$ 和 $C_2$ 的二值等价性的陈述：\n\nA. 如果对于所有 $u \\in V^n$，四值 Miter 求值为 $M(u) = 0$，那么对于所有 $b \\in B^n$，二值 Miter 求值为 $M(b) = 0$。因此，$C_1$ 和 $C_2$ 在二值语义下是等价的。\n\nB. 如果 $C_1$ 和 $C_2$ 在二值语义下是等价的（也就是说，对于所有 $b \\in B^n$，$M(b) = 0$），那么对于所有 $u \\in V^n$，四值 Miter 求值为 $M(u) = 0$。\n\nC. 为了证明 $C_1$ 和 $C_2$ 是不等价的，只需要找到一个 $u \\in V^n$，使得在四值求值下 $M(u) = 1$；这意味着对于所有 $b \\in \\gamma(u)$，二值 Miter 求值为 $M(b) = 1$，因此 $C_1$ 和 $C_2$ 是不等价的。\n\nD. 对于在时间 $t = 0$ 时将未初始化寄存器建模为 $X$ 的时序网表，将在时间 $t = 0$ 时的每个 $X$ 输入替换为 $0$，并随时间检查二值等价性，这种方法可以证明等价性，并且对于所有未初始化行为是健全且完备的。\n\n在给定的语义和假设下，就从四值求值得出关于二值等价性或不等价性的有效推论而言，上述哪些陈述是健全的？选择所有适用的选项。",
            "solution": "问题陈述描述了一个形式化框架，用于将硬件仿真中常用的四值逻辑与定义电路功能正确性的标准二值布尔逻辑关联起来。这种关系的核心是单调性假设，该假设指出，对于任何电路（表达式）$E$ 和任何四值输入向量 $u \\in V^n$，在任何具体化 $b \\in \\gamma(u)$ 上的二值求值结果都与在 $u$ 上的四值求值结果一致。形式上，对于所有 $b \\in \\gamma(u)$，$E(b) \\in \\gamma(E(u))$ 成立。\n\n具体化函数 $\\gamma$ 定义为 $\\gamma(0) = \\{0\\}$, $\\gamma(1) = \\{1\\}$ 和 $\\gamma(X) = \\gamma(Z) = \\{0,1\\}$。这对表达式 $E$ 意味着以下关键属性：\n1. 如果 $E(u)$ 在四值域中求值为 $0$，那么对于所有相应的二值输入向量 $b \\in \\gamma(u)$，表达式 $E(b)$ 必须求值为 $0$。这是因为 $\\gamma(0) = \\{0\\}$。\n2. 如果 $E(u)$ 在四值域中求值为 $1$，那么对于所有 $b \\in \\gamma(u)$，$E(b)$ 必须求值为 $1$。这是因为 $\\gamma(1) = \\{1\\}$。\n3. 如果 $E(u)$ 在四值域中求值为 $X$，那么对于任何 $b \\in \\gamma(u)$，$E(b)$ 可能求值为 $0$ 或 $1$。这是因为 $\\gamma(X) = \\{0,1\\}$。这种情况不提供关于二值行为的确定信息。\n\nMiter 电路 $M$ 的定义使其输出为 $M(u) = \\bigvee_{i=1}^{m} (y_{1,i}(u) \\oplus y_{2,i}(u))$。电路 $C_1$ 和 $C_2$ 的二值等价性被定义为对于所有 $b \\in B^n$，$M(b) = 0$。\n\n让我们基于这些原则来评估每个陈述。\n\nA. 如果对于所有 $u \\in V^n$，四值 Miter 求值为 $M(u) = 0$，那么对于所有 $b \\in B^n$，二值 Miter 求值为 $M(b) = 0$。因此，$C_1$ 和 $C_2$ 在二值语义下是等价的。\n\n这个陈述描述了一个用于证明等价性的健全条件，尽管这个条件在实践中过于苛刻。\n让我们假设前提为真：对于所有 $u \\in V^n$，$M(u)=0$。我们想要证明对于所有 $b \\in B^n$，$M(b)=0$。\n考虑一个特定的输入向量 $u_X \\in V^n$，其每个分量都是 $X$。所有可能的二值输入向量的集合 $B^n$ 是该向量的具体化：$\\gamma(u_X) = B^n$。\n根据前提，对于这个特定的向量 $u_X$，在四值求值中我们必须有 $M(u_X)=0$。\n现在，我们令 $E=M$ 和 $u=u_X$ 来应用给定的单调性属性。该属性指出，对于每个 $b \\in \\gamma(u_X)$，必须有 $M(b) \\in \\gamma(M(u_X))$。\n代入我们的值，对于每个 $b \\in B^n$，必须有 $M(b) \\in \\gamma(0)$。\n因为 $\\gamma(0) = \\{0\\}$，这意味着对于每个 $b \\in B^n$，$M(b)$ 必须为 $0$。\n这恰好是 $C_1$ 和 $C_2$ 的二值等价性的定义。因此，该推论是有效的。\n\n结论：**正确**。\n\nB. 如果 $C_1$ 和 $C_2$ 在二值语义下是等价的（也就是说，对于所有 $b \\in B^n$，$M(b) = 0$），那么对于所有 $u \\in V^n$，四值 Miter 求值为 $M(u) = 0$。\n\n这个陈述是陈述 A 的逆命题。它声称二值等价性意味着四值 Miter 输出总是 $0$。这通常是错误的，因为当四值逻辑无法确定一个明确的 $0$ 或 $1$ 时，它可能会产生 $X$。\n考虑一个简单的反例。令 $n=1, m=1$。令 $C_1$ 实现函数 $y_1(a) = a$，$C_2$ 实现函数 $y_2(a) = \\neg(\\neg a)$。\n在二值逻辑中（$a \\in B$），$\\neg(\\neg a) = a$，所以这两个电路是等价的。Miter 输出 $M(b) = b \\oplus (\\neg(\\neg b)) = b \\oplus b = 0$ 对所有 $b \\in B^1$ 成立。前提成立。\n现在，让我们为四值输入 $u=X$ 求值 Miter。\n$C_1$ 的输出是 $y_1(X) = X$。\n$C_2$ 的输出是 $y_2(X) = \\neg(\\neg X)$。根据给定的语义，$\\neg X = X$，所以 $y_2(X) = \\neg X = X$。\nMiter 输出是 $M(X) = y_1(X) \\oplus y_2(X) = X \\oplus X$。\n异或的语义规定 $X \\oplus v = X$。因此，$X \\oplus X = X$。\n由于 $M(X) = X \\neq 0$，结论“对于所有 $u \\in V^n$，$M(u)=0$”是错误的。因此，该蕴含关系是无效的。这说明了四值求值可能丢失信息，即使对于等价电路也会导致 $X$ 输出。\n\n结论：**不正确**。\n\nC. 为了证明 $C_1$ 和 $C_2$ 是不等价的，只需要找到一个 $u \\in V^n$，使得在四值求值下 $M(u) = 1$；这意味着对于所有 $b \\in \\gamma(u)$，二值 Miter 求值为 $M(b) = 1$，因此 $C_1$ 和 $C_2$ 是不等价的。\n\n这个陈述描述了使用四值求值来寻找等价性的反例。\n让我们假设我们找到了一个 $u \\in V^n$ 使得 $M(u) = 1$。\n我们再次使用单调性属性：对于每个 $b \\in \\gamma(u)$，我们必须有 $M(b) \\in \\gamma(M(u))$。\n由于 $M(u)=1$，我们有 $\\gamma(M(u)) = \\gamma(1) = \\{1\\}$。\n这意味着对于每个 $b \\in \\gamma(u)$，二值求值必须得到 $M(b) = 1$ 的结果。\n由于 $u \\in V^n$，集合 $\\gamma(u)$ 是非空的。因此，至少存在一个二值输入向量 $b$ 使得 $M(b)=1$。\n存在这样一个 $M(b) \\neq 0$ 的 $b$ 是二值不等价性的定义。\n因此，找到一个使 $M(u) = 1$ 的 $u \\in V^n$ 是一个不等价性的健全证明。该陈述中提出的逻辑是完全正确的。\n\n结论：**正确**。\n\nD. 对于在时间 $t = 0$ 时将未初始化寄存器建模为 $X$ 的时序网表，将在时间 $t = 0$ 时的每个 $X$ 输入替换为 $0$，并随时间检查二值等价性，这种方法可以证明等价性，并且对于所有未初始化行为是健全且完备的。\n\n这个陈述将讨论扩展到时序电路。 “所有未初始化行为”的等价性意味着电路对于寄存器的每个可能的初始状态都必须是等价的。用 $X$ 值对未初始化状态进行建模正确地捕捉了这种不确定性。\n所提出的方法是仅对一个特定的初始状态，即全零状态，检查等价性。该陈述声称这是一种用于证明对所有初始状态都等价的“健全且完备”的方法。\n\n让我们分析健全性。一个等价性证明方法是健全的，如果它从不将不等价的电路宣称为等价。\n考虑两个时序电路 $C_1$ 和 $C_2$，每个都有一个寄存器 $Q$。输出是寄存器值。令次态逻辑为：\n- $C_1$: $Q_{next} = 0$\n- $C_2$: $Q_{next} = Q_{current}$\n所提出的方法从两个电路的初始状态 $Q(0)=0$ 开始检查。\n- 在 $t=0$ 时，输出为 $Q_1(0)=0$ 和 $Q_2(0)=0$。它们匹配。\n- 在 $t=1$ 时，$Q_1(1)=0$ 并且 $Q_2(1)=Q_2(0)=0$。它们匹配。\n- 在所有后续时间步中，两个寄存器都将保持为 $0$。因此，通过这种方法，电路被认为是等价的。\n\n现在，让我们考虑一个不同的初始状态，$Q(0)=1$。\n- 在 $t=0$ 时，输出为 $Q_1(0)=1$ 和 $Q_2(0)=1$。它们匹配。\n- 在 $t=1$ 时，$Q_1(1)=0$ 并且 $Q_2(1)=Q_2(0)=1$。现在输出不同了（$0$ 对 $1$）。\n这两个电路对于所有未初始化行为而言是不等价的。然而，所提出的方法却宣布它们等价。这是一个假阳性。因此，该方法是**不健全的**。\n\n一个不健全的方法不是一个有效的证明方法。声称它是“健全且完备的”是错误的，因为它不健全。\n\n结论：**不正确**。",
            "answer": "$$\\boxed{AC}$$"
        }
    ]
}