{
    "hands_on_practices": [
        {
            "introduction": "对 Delta-Sigma 调制器的分析通常始于一个关于量化误差的简化模型。本练习旨在探索广泛使用的量化器“白噪声”假设。通过基于此模型进行计算，然后批判性地评估其局限性 ，您将更深刻地理解为何这种简化既有用又依赖于具体情境，特别是突显了 ΔΣ ADC 中反馈环路的关键作用。",
            "id": "4264036",
            "problem": "Delta-Sigma模数转换器 (ADC) 的分析通常将量化器误差近似为一个独立的、平稳的、白色的、均匀分布的随机过程。考虑一个步长为 $\\Delta = 2$ 的独立 $1$ 位量化器。施加一个幅度为 $A = 0.25$ 满量程 (FS)、频率为 $f_{in} = 0.01 f_{s}$ 的正弦输入。在白噪声假设下，将量化误差建模为一个离散时间白噪声过程，并估计在宽度为 $B = 0.2 f_{s}$ 的基带上积分得到的带内量化噪声功率。从量化误差统计的核心定义以及离散时间白噪声方差与其在奈奎斯特频带上的功率谱密度之间的关系出发，通过在指定带宽上对适当的频谱进行积分来计算带内功率。将您的最终答案表示为归一化到满量程幅度平方的无量纲比率（即，以 $\\mathrm{FS}^{2}$ 为单位）。将您的答案四舍五入到四位有效数字。此外，在Delta-Sigma ADC架构和噪声整形的背景下，定性地讨论对于给定输入幅度和频率的这种 $1$ 位情况，白噪声假设可能产生的误差。",
            "solution": "问题验证如下。\n\n**步骤1：提取已知条件**\n- 量化器类型: $1$ 位\n- 量化器步长: $\\Delta = 2$\n- 输入信号: 正弦波\n- 输入幅度: $A = 0.25$ 满量程 (FS)\n- 输入频率: $f_{in} = 0.01 f_{s}$\n- 假设的误差模型: 量化误差是一个独立的、平稳的、白色的、均匀分布的随机过程。\n- 积分带宽: $B = 0.2 f_{s}$\n- 要求的归一化: 归一化到满量程幅度的平方 ($\\mathrm{FS}^{2}$)。\n- 要求的精度: 四舍五入到四位有效数字。\n- 附加任务: 定性讨论白噪声假设的误差。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题使用了一个标准的（尽管是简化的）量化误差模型（白噪声模型），这是ADC（特别是Delta-Sigma调制器）入门分析的基础。它明确要求基于该模型进行计算，然后对模型的局限性进行评述，这是一种合理的教学方法。\n- **良构性：** 问题是良构的。它提供了所有必要的参数（$\\Delta$, $B$, $f_s$）来计算指定假设下的带内噪声功率。虽然“满量程（FS）”一词可能存在歧义，但在步长为 $\\Delta=2$ 的 $1$ 位量化器的背景下，可以有一致的解释，即输出电平为 $-1$ 和 $+1$，从而得到满量程幅度为 $1$。在白噪声假设下，噪声功率的计算与输入信号的幅度无关，因此其定义中的任何歧义都不会使问题的定量部分无法解决。\n- **客观性：** 该问题使用了信号处理和数据转换器领域的清晰、客观和标准的术语进行陈述。\n\n**步骤3：结论与行动**\n该问题被认为是有效的，因为它具有科学依据、良构性和客观性。将提供一个完整的解决方案。\n\n**定量分析：带内量化噪声功率**\n\n计算过程首先根据给定的统计模型确定量化误差的总功率，然后求出其功率谱密度（PSD），最后在指定带宽上对PSD进行积分。\n\n一个 $1$ 位量化器有两个输出电平。这两个电平之间的步长为 $\\Delta = 2$，对于对称实现，这意味着输出电平为 $y_{out} = -1$ 和 $y_{out} = +1$。判决阈值在 $0$。这样的量化器可以处理 $[-1, 1]$ 范围内的输入信号而不会过载。这样一个系统的“满量程幅度”是最大不削波输入幅度，即 $A_{FS} = 1$。分析将以这些归一化单位进行。\n\n问题要求我们将量化误差 $e[n]$ 建模为一个在宽度为 $\\Delta$ 的区间上均匀分布的平稳随机过程。标准模型假设该区间为 $[-\\Delta/2, \\Delta/2]$。\n给定 $\\Delta = 2$，误差 $e$ 的概率密度函数（PDF）为：\n$$\np(e) = \\begin{cases} \\frac{1}{\\Delta} = \\frac{1}{2}  \\text{for } -1 \\le e \\le 1 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n这个零均值量化误差过程的总功率等于其方差 $\\sigma_e^2$。\n$$\nP_e = \\sigma_e^2 = E[e^2] = \\int_{-\\infty}^{\\infty} e^2 p(e) de = \\int_{-1}^{1} e^2 \\left(\\frac{1}{2}\\right) de\n$$\n$$\nP_e = \\frac{1}{2} \\left[ \\frac{e^3}{3} \\right]_{-1}^{1} = \\frac{1}{2} \\left( \\frac{1^3}{3} - \\frac{(-1)^3}{3} \\right) = \\frac{1}{2} \\left( \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) \\right) = \\frac{1}{2} \\left( \\frac{2}{3} \\right) = \\frac{1}{3}\n$$\n这个结果与著名的量化噪声功率公式 $P_e = \\frac{\\Delta^2}{12} = \\frac{2^2}{12} = \\frac{4}{12} = \\frac{1}{3}$ 一致。\n\n问题指出噪声是“白”的。对于以频率 $f_s$ 采样的离散时间信号，这意味着总功率 $P_e$ 均匀分布在从 $-f_s/2$ 到 $f_s/2$ 的奈奎斯特频带上。设 $S_e(f)$ 为误差的双边功率谱密度。那么：\n$$\nP_e = \\int_{-f_s/2}^{f_s/2} S_e(f) df\n$$\n由于对于白噪声源，$S_e(f)$ 是一个常数，设 $S_e(f) = S_0$。\n$$\nP_e = S_0 \\cdot \\left(\\frac{f_s}{2} - \\left(-\\frac{f_s}{2}\\right)\\right) = S_0 \\cdot f_s\n$$\n因此，PSD的水平是：\n$$\nS_0 = \\frac{P_e}{f_s} = \\frac{1}{3f_s}\n$$\n带内噪声功率 $P_{in-band}$ 是包含在宽度为 $B = 0.2 f_s$ 的基带内的功率。这对应于频率区间 $[-B, B]$。我们通过在此区间上对PSD进行积分来求得：\n$$\nP_{in-band} = \\int_{-B}^{B} S_e(f) df = \\int_{-B}^{B} S_0 df = S_0 \\cdot (B - (-B)) = 2BS_0\n$$\n代入 $B$ 和 $S_0$ 的表达式：\n$$\nP_{in-band} = 2(0.2 f_s) \\left(\\frac{1}{3f_s}\\right) = 0.4 f_s \\cdot \\frac{1}{3f_s} = \\frac{0.4}{3} = \\frac{4/10}{3} = \\frac{4}{30} = \\frac{2}{15}\n$$\n问题要求将此功率归一化到“满量程幅度的平方”。如前所述，此量化器的满量程幅度为 $A_{FS} = 1$。满量程幅度的平方为 $A_{FS}^2 = 1^2 = 1$。\n归一化后的带内噪声功率 $P_{norm}$ 为：\n$$\nP_{norm} = \\frac{P_{in-band}}{A_{FS}^2} = \\frac{2/15}{1} = \\frac{2}{15}\n$$\n最后，我们将这个分数转换为小数，并四舍五入到四位有效数字：\n$$\nP_{norm} = \\frac{2}{15} \\approx 0.133333... \\approx 0.1333\n$$\n\n**定性讨论：白噪声假设的有效性**\n\n白噪声假设虽然在数学上为前面的计算提供了便利，但对于所描述的特定系统——一个具有低频正弦输入的独立 $1$ 位量化器——来说，它是非常不准确的。\n\n对于一个独立的量化器，量化误差 $e[n]=y[n]-x[n]$ 与输入 $x[n]$ 具有确定性的关系。对于正弦输入 $x[n] = A \\sin(2\\pi \\frac{f_{in}}{f_s} n)$，其中 $A=0.25 \\, \\text{FS}$ 且 $f_{in} = 0.01 f_s$，量化器输出 $y[n]$ 将是一个与输入具有相同基频 $f_{in}$ 的简单方波。误差信号 $e[n]$ 是该方波与输入正弦波之间的差值。这个误差是周期性的、高度结构化的，而不是随机的。其功率谱不是平坦的（“白色”的）；相反，它由位于输入频率奇次谐波（即 $3f_{in}, 5f_{in}, 7f_{in}, \\dots$）处的强离散音调组成，这些谐波落在奈奎斯特频带内。这种现象被称为音调行为或模式噪声，是粗量化器在简单输入下的一个严重限制。\n\n然而，问题陈述将此分析置于“Delta-Sigma ADC架构和噪声整形的背景下”。在一个完整的Delta-Sigma调制器中，量化器被嵌入一个反馈环路中。量化器的输入不再仅仅是信号 $x[n]$，而是 $x[n]$ 与过去量化误差的滤波版本的组合。这个反馈信号起到高频抖动的作用。抖动信号使量化器的输入成为一个“繁忙的”、快速变化的信号，无论外部输入 $x[n]$ 的特性如何，它都会不断地穿过量化阈值。这个过程有效地将量化误差随机化，使其与输入信号去相关，并使其频谱更加均匀和类似噪声。\n\n因此，白噪声模型成为分析*整个Delta-Sigma调制器环路*性能的一个相当有效和有用的近似，即使对于 $1$ 位量化器也是如此。反馈环路还利用噪声传递函数（NTF）对这个现在已白化的噪声的功率谱进行整形，将噪声功率从低频信号带推向更高频率，在更高频率处可以通过数字抽取滤波器将其移除。因此，所执行的计算，虽然对于独立的量化器在技术上是不正确的，但它代表了对完整Delta-Sigma ADC进行标准简化分析的一个基础步骤，在该分析中，反馈环路的作用使该假设变得合理。",
            "answer": "$$\n\\boxed{0.1333}\n$$"
        },
        {
            "introduction": "在理解了基本的噪声模型之后，我们可以分析一个完整调制器的性能。本实践专注于计算信号与噪声加失真比 (SNDR) 这一关键性能指标，考虑了两个主要的噪声源：经过噪声整形的量化噪声和采样时钟抖动。此问题  提供了从第一性原理推导这两种噪声源的带内噪声功率，并确定哪一种是限制 ADC 整体性能的瓶颈，这是 ADC 设计与评估中的一项常见任务。",
            "id": "4264038",
            "problem": "考虑一个低通、离散时间的二阶 delta-sigma 模数转换器 (ADC)，其过采样率 (OSR) $=128$，采样频率 $f_{s}=50$ MHz。输入信号为频率 $f_{in}=100$ kHz、峰值幅度 $A=0.5$ 满量程 (FS) 的单音正弦波。采样时钟具有均方根 (RMS) 定时抖动 $\\sigma_{t}=1$ ps。假设采用单位中置式量化器，其归一化输出电平为 $\\pm 1$，因此量化步长为 $\\Delta=2$。假设环路是理想的，失真可忽略不计，量化噪声是白噪声且与信号不相关，并且二阶调制器的噪声传递函数 (NTF) 是 $L=2$ 的低通形式。使用适用于带内区域且物理上合理的小角度近似，并从第一性原理出发，推导由抖动限制的信噪失真比 (SNDR) 和由量化噪声限制的 SNDR。\n\n从均匀量化器的量化噪声功率定义和 NTF 施加的频谱整形出发，推导二阶 delta-sigma 调制器的带内量化噪声功率关于 $\\Delta$ 和 $\\mathrm{OSR}$ 的解析表达式，然后根据给定的 $A$ 和 $\\mathrm{OSR}$ 计算相应的量化噪声受限的 SNDR。另外，从正弦输入的采样时间误差模型出发，推导抖动引起的误差，并根据给定的 $f_{in}$ 和 $\\sigma_{t}$ 计算抖动受限的 SNDR。\n\n最后，报告极限 SNDR，其定义为抖动受限的 SNDR 和量化噪声受限的 SNDR 中的较小值，并以单个数值形式给出。将最终答案四舍五入到四位有效数字，并以分贝 (dB) 表示。",
            "solution": "该问题要求确定一个二阶 delta-sigma 模数转换器 (ADC) 的极限信噪失真比 (SNDR)。这通过计算两个主要的性能限制因素来实现：带内量化噪声和由采样时钟抖动引入的噪声。两个计算出的 SNDR 值中较小的一个将决定整体性能极限。整个分析将按要求从第一性原理出发进行。\n\n给定的参数如下：\n-   ADC 阶数：$L=2$\n-   过采样率：$\\mathrm{OSR} = 128$\n-   采样频率：$f_s = 50 \\times 10^6$ Hz\n-   输入信号频率：$f_{in} = 100 \\times 10^3$ Hz\n-   输入信号峰值幅度：$A = 0.5$ (归一化至满量程)\n-   均方根时钟抖动：$\\sigma_t = 1 \\times 10^{-12}$ s\n-   量化步长：$\\Delta = 2$\n\n首先，我们计算信号功率 $P_S$。输入是一个单音正弦波 $x(t) = A\\sin(2\\pi f_{in} t)$，其峰值幅度为 $A = 0.5$。该信号的均方根 (RMS) 值为 $A_{rms} = A/\\sqrt{2}$。信号功率是 RMS 值的平方：\n$$P_S = A_{rms}^2 = \\left(\\frac{A}{\\sqrt{2}}\\right)^2 = \\frac{A^2}{2}$$\n代入 $A=0.5$：\n$$P_S = \\frac{(0.5)^2}{2} = \\frac{0.25}{2} = 0.125$$\n\n**1. 量化噪声受限的 SNDR ($\\mathrm{SNDR}_Q$)**\n\n我们将量化误差 $e(n)$ 建模为一个平稳白噪声过程，其在 $-\\Delta/2$ 和 $+\\Delta/2$ 之间均匀分布。其概率密度函数为 $p(e) = 1/\\Delta$（对于 $e \\in [-\\Delta/2, \\Delta/2]$）。这种未经整形的量化噪声的总功率是其方差 $\\sigma_e^2$：\n$$\\sigma_e^2 = \\int_{-\\Delta/2}^{\\Delta/2} e^2 p(e) de = \\frac{1}{\\Delta} \\int_{-\\Delta/2}^{\\Delta/2} e^2 de = \\frac{1}{\\Delta} \\left[ \\frac{e^3}{3} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{\\Delta^2}{12}$$\n对于给定的电平为 $\\pm 1$ 的单位量化器，步长为 $\\Delta = 1 - (-1) = 2$。总噪声功率为：\n$$\\sigma_e^2 = \\frac{2^2}{12} = \\frac{4}{12} = \\frac{1}{3}$$\n该噪声功率在奈奎斯特频带 $[-f_s/2, f_s/2]$ 内的频率上是均匀分布的。未经整形的量化噪声的双边功率谱密度 (PSD) 是一个常数：\n$$S_e(f) = \\frac{\\sigma_e^2}{f_s} = \\frac{\\Delta^2}{12f_s}$$\n在 delta-sigma 调制器中，该噪声由噪声传递函数 (NTF) 进行整形。对于二阶 ($L=2$) 调制器，NTF 为 $H_{NTF}(z) = (1-z^{-1})^2$。其频率响应为 $H_{NTF}(e^{j\\omega}) = (1-e^{-j\\omega})^2$，其中 $\\omega = 2\\pi f/f_s$ 是归一化角频率。NTF 的幅度平方为：\n$$|H_{NTF}(e^{j\\omega})|^2 = |(1-e^{-j\\omega})^2|^2 = |1-e^{-j\\omega}|^4 = \\left( (1-\\cos\\omega)^2 + \\sin^2\\omega \\right)^2 = (2 - 2\\cos\\omega)^2 = \\left( 4\\sin^2\\left(\\frac{\\omega}{2}\\right) \\right)^2$$\n我们感兴趣的信号频带是从 $0$ 到带宽 $f_b = f_s / (2 \\cdot \\mathrm{OSR})$。对于高 $\\mathrm{OSR}$，有 $f_b \\ll f_s/2$，这对应于小的 $\\omega$。我们可以使用小角度近似 $\\sin(x) \\approx x$。\n$$|H_{NTF}(e^{j\\omega})|^2 \\approx \\left( 4\\left(\\frac{\\omega}{2}\\right)^2 \\right)^2 = (\\omega^2)^2 = \\omega^4 = \\left(\\frac{2\\pi f}{f_s}\\right)^4$$\n输出端整形后的量化噪声的 PSD 为 $S_Q(f) = S_e(f) |H_{NTF}(e^{j2\\pi f/f_s})|^2$。带内量化噪声功率 $P_Q$ 是该 PSD 在信号带宽 $[-f_b, f_b]$ 上的积分：\n$$P_Q = \\int_{-f_b}^{f_b} S_Q(f) df = \\int_{-f_s/(2\\cdot\\mathrm{OSR})}^{f_s/(2\\cdot\\mathrm{OSR})} \\frac{\\Delta^2}{12 f_s} |H_{NTF}(e^{j2\\pi f/f_s})|^2 df$$\n使用 NTF 的近似，并注意到被积函数是偶函数：\n$$P_Q \\approx 2 \\int_{0}^{f_s/(2\\cdot\\mathrm{OSR})} \\frac{\\Delta^2}{12 f_s} \\left(\\frac{2\\pi f}{f_s}\\right)^4 df$$\n$$P_Q = \\frac{2\\Delta^2}{12 f_s} \\left(\\frac{2\\pi}{f_s}\\right)^4 \\int_{0}^{f_s/(2\\cdot\\mathrm{OSR})} f^4 df = \\frac{\\Delta^2}{6 f_s} \\frac{16\\pi^4}{f_s^4} \\left[ \\frac{f^5}{5} \\right]_{0}^{f_s/(2\\cdot\\mathrm{OSR})}$$\n$$P_Q = \\frac{8\\pi^4\\Delta^2}{15 f_s^5} \\left( \\frac{f_s}{2\\cdot\\mathrm{OSR}} \\right)^5 = \\frac{8\\pi^4\\Delta^2}{15 f_s^5} \\frac{f_s^5}{32 \\cdot \\mathrm{OSR}^5} = \\frac{\\pi^4 \\Delta^2}{60 \\cdot \\mathrm{OSR}^5}$$\n现在，我们可以计算量化噪声受限的 SNDR, $\\mathrm{SNDR}_Q$：\n$$\\mathrm{SNDR}_Q = \\frac{P_S}{P_Q} = \\frac{A^2/2}{\\frac{\\pi^4 \\Delta^2}{60 \\cdot \\mathrm{OSR}^5}} = \\frac{30 A^2 (\\mathrm{OSR})^5}{\\pi^4 \\Delta^2}$$\n代入给定值：$A=0.5$, $\\Delta=2$ 和 $\\mathrm{OSR}=128$：\n$$\\mathrm{SNDR}_Q = \\frac{30 \\cdot (0.5)^2 \\cdot (128)^5}{\\pi^4 \\cdot (2)^2} = \\frac{30 \\cdot 0.25 \\cdot (128)^5}{4\\pi^4} = \\frac{1.875 \\cdot (128)^5}{\\pi^4} \\approx 6.6206 \\times 10^8$$\n以分贝 (dB) 表示，即为：\n$$\\mathrm{SNDR}_Q \\text{ [dB]} = 10\\log_{10}(\\mathrm{SNDR}_Q) = 10\\log_{10}(6.6206 \\times 10^8) \\approx 88.2045 \\text{ dB}$$\n\n**2. 抖动受限的 SNDR ($\\mathrm{SNDR}_J$)**\n\n抖动会引入采样时间误差。对于输入信号 $x(t) = A\\sin(2\\pi f_{in} t)$，由于定时误差 $\\delta_t$ 引起的采样值误差，对于小的 $\\delta_t$ 可以使用一阶泰勒展开来近似：\n$$e_j(t) = x(t+\\delta_t) - x(t) \\approx \\delta_t \\cdot \\frac{dx}{dt}$$\n输入信号的导数为 $\\frac{dx}{dt} = 2\\pi f_{in} A \\cos(2\\pi f_{in} t)$。瞬时误差为：\n$$e_j(t) \\approx \\delta_t \\cdot 2\\pi f_{in} A \\cos(2\\pi f_{in} t)$$\n抖动噪声功率 $P_J$ 是该误差的均方值。我们假设抖动 $\\delta_t$ 是一个零均值、方差为 $\\sigma_t^2$ 的随机过程，并且与信号不相关。\n$$P_J = E[e_j(t)^2] \\approx E[(\\delta_t \\cdot 2\\pi f_{in} A \\cos(2\\pi f_{in} t))^2]$$\n$$P_J = E[\\delta_t^2] \\cdot (2\\pi f_{in} A)^2 \\cdot E[\\cos^2(2\\pi f_{in} t)]$$\n项 $E[\\delta_t^2]$ 是抖动方差 $\\sigma_t^2$。$\\cos^2(\\theta)$ 的时间平均值（或对随机相位的期望值）是 $1/2$。因此：\n$$P_J = \\sigma_t^2 \\cdot (2\\pi f_{in} A)^2 \\cdot \\frac{1}{2} = 2\\pi^2 f_{in}^2 A^2 \\sigma_t^2$$\n抖动受限的 SNDR, $\\mathrm{SNDR}_J$，是信号功率与抖动噪声功率之比。值得注意的是，幅度项 $A$ 被消掉了。\n$$\\mathrm{SNDR}_J = \\frac{P_S}{P_J} = \\frac{A^2/2}{2\\pi^2 f_{in}^2 A^2 \\sigma_t^2} = \\frac{1}{4\\pi^2 f_{in}^2 \\sigma_t^2}$$\n代入给定值：$f_{in} = 10^5$ Hz 和 $\\sigma_t = 10^{-12}$ s：\n$$\\mathrm{SNDR}_J = \\frac{1}{4\\pi^2 (10^5)^2 (10^{-12})^2} = \\frac{1}{4\\pi^2 (10^{10}) (10^{-24})} = \\frac{10^{14}}{4\\pi^2} \\approx 2.5330 \\times 10^{12}$$\n以分贝表示，即为：\n$$\\mathrm{SNDR}_J \\text{ [dB]} = 10\\log_{10}(\\mathrm{SNDR}_J) = 10\\log_{10}\\left(\\frac{10^{14}}{4\\pi^2}\\right) = 140 - 10\\log_{10}(4\\pi^2) \\approx 124.0364 \\text{ dB}$$\n\n**3. 极限 SNDR**\n\nADC 的整体性能受主要噪声源的限制。我们比较两个计算出的 SNDR 值：\n$$\\mathrm{SNDR}_Q \\approx 88.20 \\text{ dB}$$\n$$\\mathrm{SNDR}_J \\approx 124.04 \\text{ dB}$$\n较低的 SNDR 值对应于相对于信号更高的噪声功率。因此，量化噪声是该系统中的主要噪声源。题目要求的是极限 SNDR，即两个值中的较小者。\n$$\\text{Limiting SNDR} = \\min(\\mathrm{SNDR}_Q, \\mathrm{SNDR}_J) \\approx 88.2045 \\text{ dB}$$\n将结果四舍五入到四位有效数字，得到 $88.20$ dB。",
            "answer": "$$\\boxed{88.20}$$"
        },
        {
            "introduction": "除了噪声性能，确保 Delta-Sigma 调制器的稳定性是一项至关重要的设计挑战，特别是对于高阶环路。本练习介绍了一个广泛使用的经验性稳定性准则，即 Lee 准则，它将单位元量化器调制器的稳定性与其噪声传递函数 (NTF) 的峰值增益联系起来。通过数值计算 NTF 的峰值增益 ($|NTF|_{\\infty}$) 并应用此准则 ，您将在理论上的 NTF 多项式与设计稳健调制器的实际问题之间建立起一座桥梁。",
            "id": "4263969",
            "problem": "考虑一个单环路ΔΣ (Delta-Sigma) 模数转换器 (ADC)，其噪声传递函数 (NTF) 由下式给定：$NTF(z) = \\dfrac{(1 - z^{-1})^{p}}{(1 - a z^{-1})}$，其中 $p$ 是一个正整数，$a$ 是一个满足 $0 < a < 1$ 的实标量。我们感兴趣的量是 NTF 在单位圆上的无穷范数，定义为 $|NTF|_{\\infty} = \\sup_{\\omega \\in [0, 2\\pi)} \\left|NTF\\left(e^{j\\omega}\\right)\\right|$。您的任务是针对给定的参数集数值计算 $|NTF|_{\\infty}$，然后评估在-6 dBFS正弦输入下，使用1位量化器的相应ΔΣ调制器的可能稳定性。\n\n基本原理和定义：\n- 单位圆上的Z变换评估使用 $z = e^{j\\omega}$，其中 $\\omega$ 是以弧度为单位的数字角频率，幅频响应为 $\\left|NTF\\left(e^{j\\omega}\\right)\\right|$。\n- 无穷范数 $|NTF|_{\\infty}$ 是幅频响应在单位圆上的上确界，即 $\\left|NTF\\left(e^{j\\omega}\\right)\\right|$ 在 $\\omega \\in [0, 2\\pi)$ 上的最大值。\n- 一个广泛用于单位ΔΣ调制器的经验设计准则（李氏准则，Lee criterion）指出，为保证在各种输入幅度下的鲁棒稳定性，峰值NTF增益应满足 $|NTF|_{\\infty} < 1.5$。虽然这是一种启发式规则而非稳定性的证明，但在集成电路实践中它是一条经过充分检验的指导原则。\n\n数值计算要求：\n- 角度必须以弧度为单位。\n- 在 $[0, 2\\pi)$ 范围内，使用 $N = 131072$ 个样本点对 $\\omega$ 进行均匀网格采样，计算 $\\left|NTF\\left(e^{j\\omega}\\right)\\right|$，并使用采样的最大值来近似 $|NTF|_{\\infty}$。\n- 使用以下对应于-6 dBFS的固定正弦输入幅度：$A_{\\mathrm{in}} = 10^{-6/20}$（无量纲）。该值必须计算，但仅用于为稳定性评估提供背景信息（李氏准则阈值本身并不明确依赖于 $A_{\\mathrm{in}}$）。\n\n稳定性评估规则：\n- 如果 $|NTF|_{\\infty} < 1.5$，则声明调制器“可能稳定”，否则声明为“可能不稳定”。以布尔值形式报告，其中 $True$ 表示可能稳定，$False$ 表示可能不稳定。\n\n测试套件：\n评估以下五组参数集 $(p, a)$：\n- 情况 1：$(p, a) = (2, 0.5)$。\n- 情况 2：$(p, a) = (2, 0.9)$。\n- 情况 3：$(p, a) = (2, 0.1)$。\n- 情况 4：$(p, a) = (1, 0.5)$。\n- 情况 5：$(p, a) = (2, 0.99)$。\n\n输出规格：\n- 对于每种情况，产生两个结果：浮点数值 $|NTF|_{\\infty}$（四舍五入到6位小数），后跟根据李氏准则的布尔稳定性评估。\n- 您的程序应生成单行输出，其中包含按顺序聚合的结果，形式为方括号括起来的逗号分隔列表，即 $[|NTF|_{\\infty}^{(1)}, \\text{stable}^{(1)}, |NTF|_{\\infty}^{(2)}, \\text{stable}^{(2)}, \\dots, |NTF|_{\\infty}^{(5)}, \\text{stable}^{(5)}]$，其中 $|NTF|_{\\infty}^{(k)}$ 是一个四舍五入到6位小数的浮点数，$\\text{stable}^{(k)}$ 是一个布尔值。",
            "solution": "该问题是有效的，因为它科学地基于应用于ΔΣ (Delta-Sigma) 转换器的数字信号处理和控制理论原理，问题阐述清晰、客观，并包含了得出唯一解所需的所有信息。\n\n主要目标是计算给定噪声传递函数 (NTF) 的无穷范数 $|NTF|_{\\infty}$，并基于该结果评估调制器的稳定性。NTF 定义为：\n$$NTF(z) = \\dfrac{(1 - z^{-1})^{p}}{(1 - a z^{-1})}$$\n其中 $p$ 是表示噪声整形阶数的正整数，$a$ 是一个实标量极点位置，受限于 $0 < a < 1$。\n\n无穷范数 $|NTF|_{\\infty}$ 是 NTF 在z平面单位圆上的峰值幅度。其正式定义为：\n$$|NTF|_{\\infty} = \\sup_{\\omega \\in [0, 2\\pi)} \\left|NTF\\left(e^{j\\omega}\\right)\\right|$$\n其中 $z = e^{j\\omega}$，$\\omega$ 是归一化数字角频率。\n\n该问题要求对这个上确界进行数值近似。步骤如下：\n1.  将频率范围 $\\omega \\in [0, 2\\pi)$ 离散化为一个包含 $N = 131072$ 个点的均匀网格。\n2.  在此网格的每个点上评估NTF的幅度 $\\left|NTF\\left(e^{j\\omega}\\right)\\right|$。\n3.  从该评估中获得的最大值作为 $|NTF|_{\\infty}$ 的数值近似。\n\n给定频率 $\\omega$ 下的NTF幅度通过代入 $z = e^{j\\omega}$ 导出：\n$$\\left|NTF\\left(e^{j\\omega}\\right)\\right| = \\left|\\dfrac{\\left(1 - e^{-j\\omega}\\right)^{p}}{1 - a e^{-j\\omega}}\\right| = \\dfrac{\\left|\\left(1 - e^{-j\\omega}\\right)^{p}\\right|}{\\left|1 - a e^{-j\\omega}\\right|} = \\dfrac{\\left|1 - e^{-j\\omega}\\right|^{p}}{\\left|1 - a e^{-j\\omega}\\right|}$$\n此计算最好使用复数算术执行，因为它既计算高效又数值稳健。对于 $\\omega \\in [0, 2\\pi)$，分母 $\\left|1 - a e^{-j\\omega}\\right|$ 永远不为零，因为条件 $0 < a < 1$ 确保了极点 $z=a$ 严格位于单位圆内部。\n\n数值算法流程如下：\n- 在区间 $[0, 2\\pi)$ 上生成一个包含 $N=131072$ 个等间距角频率 $\\omega_k$ 的向量。\n- 构建一个相应的复数值向量 $z_k^{-1} = e^{-j\\omega_k}$。\n- 对于给定的参数集 $(p, a)$，逐元素计算幅频响应向量：\n  - 分子项计算为 $\\left(\\left|1 - z_k^{-1}\\right|\\right)^p$。\n  - 分母项计算为 $\\left|1 - a z_k^{-1}\\right|$。\n  - NTF幅度是这两项的比值。\n- 所得幅度向量中的最大值即为 $|NTF|_{\\infty}$。\n\n最后，使用经验性的李氏准则 (Lee criterion) 评估ΔΣ调制器的稳定性。这个启发式规则指出，对于使用1位量化器的鲁棒稳定性，峰值NTF增益应小于某个阈值。本问题将此阈值指定为 $1.5$。\n- 如果 $|NTF|_{\\infty} < 1.5$，调制器被视为“可能稳定”，报告为布尔值 `True`。\n- 如果 $|NTF|_{\\infty} \\ge 1.5$，调制器被视为“可能不稳定”，报告为布尔值 `False`。\n\n对五个指定的 $(p, a)$ 参数集中的每一个都重复此完整过程。最终输出包括计算出的 $|NTF|_{\\infty}$（四舍五入到6位小数）和每种情况下相应的稳定性评估。提供正弦输入幅度 $A_{\\mathrm{in}} = 10^{-6/20}$ 是为了提供有关典型操作条件的背景信息，但它不参与 $|NTF|_{\\infty}$ 的计算或稳定性评估，这两者仅基于NTF自身的属性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the infinity norm of a given NTF for several parameter sets\n    and assesses modulator stability using the Lee criterion.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (p, a)\n        (2, 0.5),\n        (2, 0.9),\n        (2, 0.1),\n        (1, 0.5),\n        (2, 0.99),\n    ]\n\n    # Numerical computation parameters\n    N = 131072\n    \n    # Stability criterion threshold\n    LEE_CRITERION_THRESHOLD = 1.5\n\n    # The problem specifies a -6 dBFS sinusoidal input amplitude for context.\n    # A_in = 10**(-6 / 20)\n    # This value is not used in the NTF norm calculation.\n\n    # Pre-compute the vector of complex exponentials on the unit circle.\n    # This is more efficient than re-computing for each test case.\n    # The range is [0, 2*pi) as specified.\n    omega = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    z_inv = np.exp(-1j * omega)\n\n    results = []\n    \n    for p, a in test_cases:\n        # Calculate the magnitude of the NTF numerator |(1 - z^-1)^p|\n        # This is more numerically stable as |1 - z^-1|^p\n        mag_num_base = np.abs(1.0 - z_inv)\n        numerator_mag = mag_num_base ** p\n        \n        # Calculate the magnitude of the NTF denominator |1 - a*z^-1|\n        denominator_mag = np.abs(1.0 - a * z_inv)\n        \n        # Compute the NTF magnitude response.\n        # The denominator is guaranteed to be non-zero since |a|  1.\n        ntf_mag_response = numerator_mag / denominator_mag\n        \n        # Approximate the infinity norm by finding the maximum on the grid.\n        ntf_inf = np.max(ntf_mag_response)\n        \n        # Assess stability using the Lee criterion.\n        is_stable = ntf_inf  LEE_CRITERION_THRESHOLD\n        \n        # Append the rounded float and boolean to the results list.\n        results.append(round(ntf_inf, 6))\n        results.append(is_stable)\n\n    # Final print statement in the exact required format.\n    # Convert booleans to their string representations ('True', 'False').\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}