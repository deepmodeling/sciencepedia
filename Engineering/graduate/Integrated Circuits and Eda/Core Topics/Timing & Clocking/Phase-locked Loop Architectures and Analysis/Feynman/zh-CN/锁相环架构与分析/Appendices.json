{
    "hands_on_practices": [
        {
            "introduction": "瞬态响应是衡量控制系统性能的首要指标之一。对于锁相环而言，锁定时间量化了其对输入信号变化进行同步的速度，这在频率合成器和时钟恢复电路中是至关重要的参数。本练习  将引导您基于经典的二阶模型推导锁定时间，从而帮助您对锁相环的动态行为建立基础性的理解。",
            "id": "4288887",
            "problem": "考虑一个在锁定点附近线性化的锁相环 (PLL)，其输入相位到输出相位的闭环传递函数被建模为一个标准的二阶线性时不变 (LTI) 系统。该闭环系统的特征在于自然频率 $\\,\\omega_{n}\\,$ 和阻尼比 $\\,\\zeta\\,$，其中 $\\,0  \\zeta  1\\,$。在时间 $\\,t=0\\,$ 时，输入相位经历一个单位幅值（一个弧度）的小阶跃。定义锁定时间 $\\,t_{L}(\\epsilon)\\,$ 为这样一个最小时间，在此时间之后，输出相位与其最终值之间的偏差的绝对值在所有后续时间内都受限于一个预定的、相对于阶跃幅度的分数误差带 $\\,\\epsilon\\,$，即，对于所有 $\\,t\\geq t_{L}(\\epsilon)\\,$, 都有 $\\,|\\phi_{\\text{out}}(t)-1|\\leq \\epsilon\\,$，其中 $\\,0  \\epsilon  1\\,$。从标准的二阶闭环描述和精确的单位阶跃响应出发，通过确保所有后续振荡都通过自然响应包络线被包含在规定的频带内，推导出一个关于 $\\,\\omega_{n}\\,$、$\\,\\zeta\\,$ 和 $\\,\\epsilon\\,$ 的保守的 $\\,t_{L}(\\epsilon)\\,$ 闭式表达式。陈述使该表达式严格为正所需满足的关于 $\\,\\epsilon\\,$ 的任何必要条件。你的最终答案必须是 $\\,t_{L}(\\epsilon)\\,$ 的单个符号表达式。不要使用任何数值近似。",
            "solution": "该问题要求为一个承受单位相位阶跃输入的标准二阶锁相环 (PLL) 推导其锁定时间 $t_{L}(\\epsilon)$ 的一个保守的闭式表达式。推导必须基于自然响应的包络线。\n\n对于一个标准的二阶系统，从输入相位 $\\Phi_{\\text{in}}(s)$ 到输出相位 $\\Phi_{\\text{out}}(s)$ 的闭环传递函数 $H(s)$ 由下式给出：\n$$ H(s) = \\frac{\\Phi_{\\text{out}}(s)}{\\Phi_{\\text{in}}(s)} = \\frac{\\omega_{n}^2}{s^2 + 2\\zeta\\omega_{n}s + \\omega_{n}^2} $$\n这里，$\\omega_{n}$ 是自然频率，$\\zeta$ 是阻尼比。问题指定了一个欠阻尼系统，其中 $0  \\zeta  1$。\n\n输入是在时间 $t=0$ 时施加的单位相位阶跃，其在拉普拉斯域中表示为：\n$$ \\Phi_{\\text{in}}(s) = \\mathcal{L}\\{u(t)\\} = \\frac{1}{s} $$\n其中 $u(t)$ 是单位阶跃函数。\n\n因此，拉普拉斯域中的输出相位为：\n$$ \\Phi_{\\text{out}}(s) = H(s)\\Phi_{\\text{in}}(s) = \\frac{\\omega_{n}^2}{s(s^2 + 2\\zeta\\omega_{n}s + \\omega_{n}^2)} $$\n\n为了找到时域响应 $\\phi_{\\text{out}}(t)$，我们计算 $\\Phi_{\\text{out}}(s)$ 的拉普拉斯逆变换。对于欠阻尼系统 ($0  \\zeta  1$)，单位阶跃响应的标准结果是：\n$$ \\phi_{\\text{out}}(t) = 1 - \\exp(-\\zeta\\omega_{n}t) \\left( \\cos(\\omega_{d}t) + \\frac{\\zeta}{\\sqrt{1-\\zeta^2}} \\sin(\\omega_{d}t) \\right) $$\n其中 $\\omega_{d} = \\omega_{n}\\sqrt{1-\\zeta^2}$ 是阻尼自然频率。输出相位的最终值是 $\\lim_{t \\to \\infty} \\phi_{\\text{out}}(t) = 1$ 弧度，这对于一个响应单位阶跃且具有单位直流增益的系统来说是符合预期的。\n\n问题基于输出相位与其最终值的偏差来定义锁定时间 $t_{L}(\\epsilon)$。设此偏差为 $\\Delta\\phi(t) = \\phi_{\\text{out}}(t) - 1$。\n$$ \\Delta\\phi(t) = - \\exp(-\\zeta\\omega_{n}t) \\left( \\cos(\\omega_{d}t) + \\frac{\\zeta}{\\sqrt{1-\\zeta^2}} \\sin(\\omega_{d}t) \\right) $$\n\n为了确定该偏差的包络线，我们将正弦项表示为单个相移正弦形式 $A\\sin(\\theta + \\psi)$。括号中表达式的振幅 $A$ 是：\n$$ A = \\sqrt{1^2 + \\left(\\frac{\\zeta}{\\sqrt{1-\\zeta^2}}\\right)^2} = \\sqrt{1 + \\frac{\\zeta^2}{1-\\zeta^2}} = \\sqrt{\\frac{1-\\zeta^2+\\zeta^2}{1-\\zeta^2}} = \\frac{1}{\\sqrt{1-\\zeta^2}} $$\n因此，偏差可以写为：\n$$ \\Delta\\phi(t) = - \\frac{\\exp(-\\zeta\\omega_{n}t)}{\\sqrt{1-\\zeta^2}} \\sin(\\omega_{d}t + \\psi) $$\n其中 $\\psi = \\arctan\\left(\\frac{\\sqrt{1-\\zeta^2}}{\\zeta}\\right)$。偏差的绝对值为：\n$$ |\\phi_{\\text{out}}(t) - 1| = \\left| - \\frac{\\exp(-\\zeta\\omega_{n}t)}{\\sqrt{1-\\zeta^2}} \\sin(\\omega_{d}t + \\psi) \\right| = \\frac{\\exp(-\\zeta\\omega_{n}t)}{\\sqrt{1-\\zeta^2}} |\\sin(\\omega_{d}t + \\psi)| $$\n\n问题要求通过使用自然响应的包络线来保守估计锁定时间。$|\\phi_{\\text{out}}(t) - 1|$ 的包络线是通过将其中的振荡项 $|\\sin(\\omega_{d}t + \\psi)|$ 替换为其最大可能值 $1$ 来找到的。设此包络线为 $E(t)$。\n$$ E(t) = \\frac{\\exp(-\\zeta\\omega_{n}t)}{\\sqrt{1-\\zeta^2}} $$\n锁定时间的条件是对于所有 $t \\geq t_{L}(\\epsilon)$，都有 $|\\phi_{\\text{out}}(t) - 1| \\leq \\epsilon$。为了获得 $t_{L}(\\epsilon)$ 的一个保守值，我们施加一个更严格的条件，即包络线 $E(t)$ 必须小于或等于 $\\epsilon$。锁定时间 $t_{L}(\\epsilon)$ 是包络线首次进入并随后保持在该界限内的时间。这发生在包络线的值等于 $\\epsilon$ 时。\n$$ E(t_{L}(\\epsilon)) = \\frac{\\exp(-\\zeta\\omega_{n}t_{L}(\\epsilon))}{\\sqrt{1-\\zeta^2}} = \\epsilon $$\n\n我们现在求解这个方程以得到 $t_{L}(\\epsilon)$：\n$$ \\exp(-\\zeta\\omega_{n}t_{L}(\\epsilon)) = \\epsilon\\sqrt{1-\\zeta^2} $$\n对两边取自然对数，得到：\n$$ -\\zeta\\omega_{n}t_{L}(\\epsilon) = \\ln\\left(\\epsilon\\sqrt{1-\\zeta^2}\\right) $$\n求解 $t_{L}(\\epsilon)$：\n$$ t_{L}(\\epsilon) = -\\frac{1}{\\zeta\\omega_{n}} \\ln\\left(\\epsilon\\sqrt{1-\\zeta^2}\\right) $$\n利用对数性质 $\\ln(x^{-1}) = -\\ln(x)$，这个表达式可以写为：\n$$ t_{L}(\\epsilon) = \\frac{1}{\\zeta\\omega_{n}} \\ln\\left(\\frac{1}{\\epsilon\\sqrt{1-\\zeta^2}}\\right) $$\n这就是所求的锁定时间的闭式表达式。\n\n最后，我们确定使 $t_{L}(\\epsilon)$ 严格为正时 $\\epsilon$ 需满足的条件。已知 $\\omega_{n} > 0$ 且 $0  \\zeta  1$，前置因子 $\\frac{1}{\\zeta\\omega_{n}}$ 总是正的。因此，要使 $t_{L}(\\epsilon) > 0$，对数的参数必须大于 $1$：\n$$ \\frac{1}{\\epsilon\\sqrt{1-\\zeta^2}} > 1 $$\n$$ 1 > \\epsilon\\sqrt{1-\\zeta^2} $$\n$$ \\epsilon  \\frac{1}{\\sqrt{1-\\zeta^2}} $$\n问题指定 $0  \\epsilon  1$。对于给定的 $\\zeta$ 范围 $0  \\zeta  1$，项 $\\sqrt{1-\\zeta^2}$ 在范围 $(0, 1)$ 内。因此，$\\frac{1}{\\sqrt{1-\\zeta^2}}$ 总是大于 $1$。由于 $\\epsilon  1$，在问题的约束条件下，条件 $\\epsilon  \\frac{1}{\\sqrt{1-\\zeta^2}}$ 总是满足的。其物理意义是，所要求的误差界限 $\\epsilon$ 必须小于响应包络线在 $t=0$ 时的初始值，即 $E(0) = (\\sqrt{1-\\zeta^2})^{-1}$，这样锁定时间才是一个正值。",
            "answer": "$$\\boxed{\\frac{1}{\\zeta\\omega_{n}}\\ln\\left(\\frac{1}{\\epsilon\\sqrt{1-\\zeta^2}}\\right)}$$"
        },
        {
            "introduction": "当锁相环进入锁定状态后，其稳态性能主要受到随机噪声的限制，这些噪声最终表现为输出信号的时序抖动（jitter）。均方根（RMS）抖动是衡量锁相环性能的关键指标，尤其在高速通信应用中。本练习  将演示如何通过对来自不同内部噪声源的贡献进行适当的滤波和积分，来计算总输出抖动，这是低噪声锁相环设计中的一项核心技能。",
            "id": "4288869",
            "problem": "考虑一个一阶锁相环 (PLL) 的线性化小信号相位域模型，其输出载波频率为 $f_{0}$，环路转角频率为 $f_{c}$。假设所有角度都以弧度为单位，所有噪声源都是广义平稳且相互不相关的，并且所有谱都是单边功率谱密度 (PSD)。设从输入相位到输出相位的闭环幅值平方传递函数，对于相对于载波的频率偏移 $f$，指定如下：\n- 从参考输入到输出：$\\left|H_{\\mathrm{ref}}(f)\\right|^{2} = \\dfrac{1}{1 + \\left(\\dfrac{f}{f_{c}}\\right)^{2}}$。\n- 从压控振荡器 (VCO) 内在相位噪声到输出：$\\left|H_{\\mathrm{vco}}(f)\\right|^{2} = \\dfrac{\\left(\\dfrac{f}{f_{c}}\\right)^{2}}{1 + \\left(\\dfrac{f}{f_{c}}\\right)^{2}}$。\n\n在偏移频带 $f \\in [f_{1}, f_{2}]$ 内，唯一的非零源PSD是恒定（白）相位噪声基底，由下式给出：\n- 参考相位噪声PSD：$S_{\\phi,\\mathrm{ref}}(f) = S_{r0}$，对于 $f \\in [f_{1}, f_{2}]$，其他情况下 $S_{\\phi,\\mathrm{ref}}(f) = 0$。\n- VCO相位噪声PSD：$S_{\\phi,\\mathrm{vco}}(f) = S_{v0}$，对于 $f \\in [f_{1}, f_{2}]$，其他情况下 $S_{\\phi,\\mathrm{vco}}(f) = 0$。\n\n使用以下参数：$f_{0} = 2.5\\,\\mathrm{GHz}$，$f_{c} = 100\\,\\mathrm{kHz}$，$f_{1} = 1\\,\\mathrm{kHz}$，$f_{2} = 100\\,\\mathrm{MHz}$，$S_{r0} = 1.0 \\times 10^{-10}\\,\\mathrm{rad}^{2}/\\mathrm{Hz}$，以及 $S_{v0} = 1.0 \\times 10^{-12}\\,\\mathrm{rad}^{2}/\\mathrm{Hz}$。\n\n仅从线性时不变 (LTI) 系统通过幅值平方频率响应将输入PSD与输出PSD关联的基本性质出发，并从正弦载波的相位波动与时间波动之间的运动学关系出发，完成以下任务：\n1. 构建在 $f \\in [f_{1}, f_{2}]$ 上的总输出相位噪声PSD $S_{\\phi,\\mathrm{out}}(f)$。\n2. 将 $S_{\\phi,\\mathrm{out}}(f)$ 在 $[f_{1}, f_{2}]$ 上积分，以获得输出相位方差，然后将其转换为PLL输出端的均方根 (RMS) 时间抖动。\n\n以飞秒 (fs) 为单位表示最终的RMS抖动，并将您的答案四舍五入至三位有效数字。最终的数值答案必须是单个数字。不要报告中间结果。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n问题陈述中提供的数据、变量和条件如下：\n- 输出载波频率：$f_{0} = 2.5\\,\\mathrm{GHz}$\n- 环路转角频率：$f_{c} = 100\\,\\mathrm{kHz}$\n- 积分频带下限：$f_{1} = 1\\,\\mathrm{kHz}$\n- 积分频带上限：$f_{2} = 100\\,\\mathrm{MHz}$\n- 从参考到输出的闭环幅值平方传递函数：$\\left|H_{\\mathrm{ref}}(f)\\right|^{2} = \\dfrac{1}{1 + \\left(\\dfrac{f}{f_{c}}\\right)^{2}}$\n- 从VCO到输出的闭环幅值平方传递函数：$\\left|H_{\\mathrm{vco}}(f)\\right|^{2} = \\dfrac{\\left(\\dfrac{f}{f_{c}}\\right)^{2}}{1 + \\left(\\dfrac{f}{f_{c}}\\right)^{2}}$\n- 参考相位噪声功率谱密度 (PSD)：$S_{\\phi,\\mathrm{ref}}(f) = S_{r0} = 1.0 \\times 10^{-10}\\,\\mathrm{rad}^{2}/\\mathrm{Hz}$，对于 $f \\in [f_{1}, f_{2}]$，其他情况下为0。\n- VCO相位噪声功率谱密度 (PSD)：$S_{\\phi,\\mathrm{vco}}(f) = S_{v0} = 1.0 \\times 10^{-12}\\,\\mathrm{rad}^{2}/\\mathrm{Hz}$，对于 $f \\in [f_{1}, f_{2}]$，其他情况下为0。\n- 所有噪声源都是广义平稳且相互不相关的。\n- 所有谱都是单边功率谱密度。\n- 所有角度都以弧度为单位。\n\n**步骤2：使用提取的已知条件进行验证**\n\n- **科学依据：** 该问题陈述基于标准且被广泛接受的锁相环 (PLL) 线性化相位域模型。所提供的传递函数对应于一阶PLL响应。线性时不变 (LTI) 系统的输入和输出功率谱密度 (PSD) 之间的关系，以及从相位方差到时间抖动的转换，都是信号处理和通信工程中的基本概念。频率和噪声水平的数值对于现代集成PLL是现实的。该问题具有科学合理性。\n- **适定性：** 计算最终结果所需的所有必要参数和定义均已提供。问题要求一个唯一的数值，并且指定的计算过程是明确的。\n- **客观性：** 问题使用精确、客观的数学和工程术语进行描述。没有主观或基于观点的陈述。\n\n所有其他验证检查（不完整/矛盾的设置、不现实/不可行、不适定等）均已通过。问题是自洽、一致且可解的。\n\n**步骤3：结论与行动**\n\n该问题被判定为**有效**。将提供解答。\n\n### 解答推导\n\n根据问题陈述的要求，解答过程分为两个主要部分。首先，我们构建总输出相位噪声PSD，$S_{\\phi,\\mathrm{out}}(f)$。其次，我们对该PSD进行积分，求出总输出相位方差，并由此推导出RMS时间抖动。\n\n**1. 总输出相位噪声PSD**\n\n对于线性时不变 (LTI) 系统，输出功率谱密度 $S_{\\text{out}}(f)$ 通过系统的频率响应的幅值平方 $|H(f)|^2$ 与输入功率谱密度 $S_{\\text{in}}(f)$ 相关，如下所示：\n$$S_{\\text{out}}(f) = S_{\\text{in}}(f) \\left|H(f)\\right|^2$$\n问题陈述指出噪声源（参考源和VCO）是不相关的。因此，它们对总输出噪声功率的贡献是线性相加的。总输出相位噪声PSD，$S_{\\phi,\\mathrm{out}}(f)$，是参考噪声贡献和VCO噪声贡献之和。\n\n来自参考相位噪声的贡献是：\n$$S_{\\phi,\\mathrm{out,ref}}(f) = S_{\\phi,\\mathrm{ref}}(f) \\left|H_{\\mathrm{ref}}(f)\\right|^2$$\n来自VCO相位噪声的贡献是：\n$$S_{\\phi,\\mathrm{out,vco}}(f) = S_{\\phi,\\mathrm{vco}}(f) \\left|H_{\\mathrm{vco}}(f)\\right|^2$$\n总输出相位噪声PSD是它们的和：\n$$S_{\\phi,\\mathrm{out}}(f) = S_{\\phi,\\mathrm{out,ref}}(f) + S_{\\phi,\\mathrm{out,vco}}(f)$$\n在指定的频带 $f \\in [f_{1}, f_{2}]$ 内，输入PSD是恒定的基底，$S_{\\phi,\\mathrm{ref}}(f) = S_{r0}$ 和 $S_{\\phi,\\mathrm{vco}}(f) = S_{v0}$。代入给定的表达式：\n$$S_{\\phi,\\mathrm{out}}(f) = S_{r0} \\left(\\dfrac{1}{1 + \\left(\\frac{f}{f_{c}}\\right)^{2}}\\right) + S_{v0} \\left(\\dfrac{\\left(\\frac{f}{f_{c}}\\right)^{2}}{1 + \\left(\\frac{f}{f_{c}}\\right)^{2}}\\right)$$\n该表达式可以通分合并：\n$$S_{\\phi,\\mathrm{out}}(f) = \\dfrac{S_{r0} + S_{v0}\\left(\\frac{f}{f_{c}}\\right)^{2}}{1 + \\left(\\frac{f}{f_{c}}\\right)^{2}}$$\n这就是在 $f \\in [f_{1}, f_{2}]$ 内的总输出相位噪声PSD。\n\n**2. 积分求相位方差并转换为时间抖动**\n\n总积分相位方差 $\\sigma_{\\phi}^2$ 是单边PSD $S_{\\phi,\\mathrm{out}}(f)$ 在目标频率区间 $[f_{1}, f_{2}]$ 上的积分。\n$$\\sigma_{\\phi}^2 = \\int_{f_{1}}^{f_{2}} S_{\\phi,\\mathrm{out}}(f) \\, df$$\n为简化积分，通过代数变换对被积函数进行重排：\n$$S_{\\phi,\\mathrm{out}}(f) = \\dfrac{S_{r0} + S_{v0}\\left(\\frac{f}{f_{c}}\\right)^{2}}{1 + \\left(\\frac{f}{f_{c}}\\right)^{2}} = \\dfrac{S_{r0} - S_{v0} + S_{v0} + S_{v0}\\left(\\frac{f}{f_{c}}\\right)^{2}}{1 + \\left(\\frac{f}{f_{c}}\\right)^{2}}$$\n$$S_{\\phi,\\mathrm{out}}(f) = \\dfrac{S_{r0} - S_{v0}}{1 + \\left(\\frac{f}{f_{c}}\\right)^{2}} + \\dfrac{S_{v0}\\left(1 + \\left(\\frac{f}{f_{c}}\\right)^{2}\\right)}{1 + \\left(\\frac{f}{f_{c}}\\right)^{2}} = \\dfrac{S_{r0} - S_{v0}}{1 + \\left(\\frac{f}{f_{c}}\\right)^{2}} + S_{v0}$$\n这种形式更便于积分。相位方差积分变为：\n$$\\sigma_{\\phi}^2 = \\int_{f_{1}}^{f_{2}} \\left( \\dfrac{S_{r0} - S_{v0}}{1 + \\left(\\frac{f}{f_{c}}\\right)^{2}} + S_{v0} \\right) df$$\n$$\\sigma_{\\phi}^2 = (S_{r0} - S_{v0}) \\int_{f_{1}}^{f_{2}} \\dfrac{1}{1 + \\left(\\frac{f}{f_{c}}\\right)^{2}} df + S_{v0} \\int_{f_{1}}^{f_{2}} df$$\n第二个积分是平凡的：$S_{v0}(f_{2} - f_{1})$。对于第一个积分，$\\left(1 + (f/f_c)^2\\right)^{-1}$ 关于 $f$ 的原函数是 $f_{c}\\arctan(f/f_{c})$。\n$$\\int_{f_{1}}^{f_{2}} \\dfrac{1}{1 + \\left(\\frac{f}{f_{c}}\\right)^{2}} df = \\left[ f_{c}\\arctan\\left(\\frac{f}{f_{c}}\\right) \\right]_{f_{1}}^{f_{2}} = f_{c} \\left( \\arctan\\left(\\frac{f_{2}}{f_{c}}\\right) - \\arctan\\left(\\frac{f_{1}}{f_{c}}\\right) \\right)$$\n合并结果，总相位方差为：\n$$\\sigma_{\\phi}^2 = (S_{r0} - S_{v0}) f_{c} \\left[ \\arctan\\left(\\frac{f_{2}}{f_{c}}\\right) - \\arctan\\left(\\frac{f_{1}}{f_{c}}\\right) \\right] + S_{v0}(f_{2} - f_{1})$$\n均方根 (RMS) 相位抖动是 $\\sigma_{\\phi} = \\sqrt{\\sigma_{\\phi}^2}$。对于频率为 $f_0$ 的正弦载波，微小相位波动 $\\Delta\\phi$（以弧度为单位）与相应的时间波动 $\\Delta t$ 之间的运动学关系是 $\\Delta\\phi = 2\\pi f_0 \\Delta t$。因此，RMS时间抖动 $\\sigma_t$ 是：\n$$\\sigma_{t} = \\dfrac{\\sigma_{\\phi}}{2\\pi f_{0}} = \\dfrac{1}{2\\pi f_{0}} \\sqrt{(S_{r0} - S_{v0}) f_{c} \\left[ \\arctan\\left(\\frac{f_{2}}{f_{c}}\\right) - \\arctan\\left(\\frac{f_{1}}{f_{c}}\\right) \\right] + S_{v0}(f_{2} - f_{1})}$$\n现在，我们代入给定的数值：\n- $f_{0} = 2.5 \\times 10^{9}\\,\\mathrm{Hz}$\n- $f_{c} = 100 \\times 10^{3}\\,\\mathrm{Hz} = 10^{5}\\,\\mathrm{Hz}$\n- $f_{1} = 1 \\times 10^{3}\\,\\mathrm{Hz}$\n- $f_{2} = 100 \\times 10^{6}\\,\\mathrm{Hz} = 10^{8}\\,\\mathrm{Hz}$\n- $S_{r0} = 1.0 \\times 10^{-10}\\,\\mathrm{rad}^{2}/\\mathrm{Hz}$\n- $S_{v0} = 1.0 \\times 10^{-12}\\,\\mathrm{rad}^{2}/\\mathrm{Hz}$\n\n首先，计算反正切函数的参数：\n- $\\frac{f_{2}}{f_{c}} = \\frac{10^{8}}{10^{5}} = 1000$\n- $\\frac{f_{1}}{f_{c}} = \\frac{10^{3}}{10^{5}} = 0.01$\n\n接下来，计算平方根内的各项：\n- $S_{r0} - S_{v0} = 1.0 \\times 10^{-10} - 1.0 \\times 10^{-12} = 100 \\times 10^{-12} - 1 \\times 10^{-12} = 99 \\times 10^{-12}\\,\\mathrm{rad}^{2}/\\mathrm{Hz}$\n- $f_{2} - f_{1} = 10^{8} - 10^{3} = 99,999,000\\,\\mathrm{Hz}$\n\n$\\sigma_{\\phi}^2$ 的第一项：\n$$T_{1} = (99 \\times 10^{-12}) \\times 10^{5} \\times [\\arctan(1000) - \\arctan(0.01)]$$\n$$T_{1} \\approx (9.9 \\times 10^{-6}) \\times (1.5707963 - 0.00999967) = (9.9 \\times 10^{-6}) \\times (1.56079663) \\approx 1.5451887 \\times 10^{-5}\\,\\mathrm{rad}^{2}$$\n$\\sigma_{\\phi}^2$ 的第二项：\n$$T_{2} = (1.0 \\times 10^{-12}) \\times (99,999,000) = 9.9999 \\times 10^{-5}\\,\\mathrm{rad}^{2}$$\n总相位方差是：\n$$\\sigma_{\\phi}^2 = T_{1} + T_{2} \\approx 1.5451887 \\times 10^{-5} + 9.9999 \\times 10^{-5} = 11.5450887 \\times 10^{-5} \\approx 1.15451 \\times 10^{-4}\\,\\mathrm{rad}^{2}$$\nRMS相位抖动是：\n$$\\sigma_{\\phi} = \\sqrt{1.15451 \\times 10^{-4}} \\approx 0.0107448\\,\\mathrm{rad}$$\n最后，我们计算RMS时间抖动 $\\sigma_t$：\n$$\\sigma_{t} = \\dfrac{\\sigma_{\\phi}}{2\\pi f_{0}} \\approx \\dfrac{0.0107448}{2\\pi \\times (2.5 \\times 10^{9})} = \\dfrac{0.0107448}{5\\pi \\times 10^{9}} \\approx \\dfrac{0.0107448}{1.570796 \\times 10^{10}} \\approx 6.83909 \\times 10^{-13}\\,\\mathrm{s}$$\n问题要求结果以飞秒 ($1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$) 为单位。\n$$\\sigma_{t} \\approx 6.83909 \\times 10^{-13}\\,\\mathrm{s} = 683.909 \\times 10^{-15}\\,\\mathrm{s} = 683.909\\,\\mathrm{fs}$$\n四舍五入到三位有效数字，我们得到 $684\\,\\mathrm{fs}$。",
            "answer": "$$\n\\boxed{684}\n$$"
        },
        {
            "introduction": "系统级的噪声分析固然重要，但一个真正的设计者还必须理解噪声的物理来源。环路滤波器虽然看似简单，但其内部的耗能元件是总噪声预算的重要贡献者。本练习  将深入到元件层面，展示如何运用热噪声的基本原理来计算环路滤波器的相位噪声贡献，从而将器件的物理特性与系统级性能联系起来。",
            "id": "4288886",
            "problem": "一个电荷泵锁相环 (CP-PLL) 通过位于压控振荡器 (VCO) 控制节点处的无源并联环路滤波器来控制该 VCO。该环路滤波器由一个阻值为 $R$ 的电阻器与一个容值为 $C$ 的非理想电容器并联组成，该电容器的介质损耗角正切为 $\\tan\\delta$。工作温度为 $T$。假设电荷泵和所有其他环路模块都是无噪声的，并忽略任何闪烁噪声。将电容器损耗处理为等效的并联电导。VCO 的增益为 $K_{\\mathrm{vco}}$，单位为 $\\mathrm{rad}\\,\\mathrm{s}^{-1}\\,\\mathrm{V}^{-1}$。考虑在指定偏置频率 $f_{0}$ 处的单边带相位噪声，在该频率下，反馈抑制的幅度可以忽略不计（因此在 $f_{0}$ 处闭环抑制因子可以近似为1）。仅使用基本热噪声原理和线性时不变网络分析，计算由环路滤波器电阻和电容器损耗引起的输出单边带相位噪声谱密度 $S_{\\varphi}(f_{0})$，单位为 $\\mathrm{rad}^{2}/\\mathrm{Hz}$。\n\n使用以下数值：\n- $R = 10{,}000\\,\\Omega$，\n- $C = 100\\,\\mathrm{nF}$，\n- $\\tan\\delta = 2.0\\times 10^{-3}$，\n- $T = 300\\,\\mathrm{K}$，\n- $K_{\\mathrm{vco}} = 2\\pi\\times 5.0\\times 10^{6}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}\\,\\mathrm{V}^{-1}$，\n- $f_{0} = 1.0\\times 10^{5}\\,\\mathrm{Hz}$。\n\n将 $S_{\\varphi}(f_{0})$ 的最终答案以 $\\mathrm{rad}^{2}/\\mathrm{Hz}$ 为单位表示，并将您的答案四舍五入到三位有效数字。相位使用弧度。",
            "solution": "该问题要求计算电荷泵锁相环 (CP-PLL) 输出端的单边带相位噪声谱密度 $S_{\\varphi}(f_{0})$。指定的噪声源是源自压控振荡器 (VCO) 控制节点处的无源并联环路滤波器元件的热噪声。\n\n首先，我们对环路滤波器及其内在噪声源进行建模。该滤波器由一个电阻 $R$ 与一个非理想电容器 $C$ 并联组成。一个有损电容器可以建模为一个理想电容器 $C$ 与一个代表介质损耗的电导 $G_C$ 并联。问题中说明了要使用这个模型。在角频率 $\\omega$ 下，非理想电容器的导纳由 $Y_C(j\\omega) = G_C + j\\omega C$ 给出。损耗角正切 $\\tan\\delta$ 定义为导纳的实部与虚部的比值：\n$$\n\\tan\\delta = \\frac{\\mathrm{Re}\\{Y_C(j\\omega)\\}}{\\mathrm{Im}\\{Y_C(j\\omega)\\}} = \\frac{G_C}{\\omega C}\n$$\n由此，我们可以将等效并联电导 $G_C$ 表示为频率的函数：\n$$\nG_C(\\omega) = \\omega C \\tan\\delta\n$$\n整个环路滤波器是电阻 $R$、理想电容器 $C$ 和损耗电导 $G_C$ 的并联组合。环路滤波器的总导纳 $Y_{LF}(j\\omega)$ 是各个导纳之和：\n$$\nY_{LF}(j\\omega) = \\frac{1}{R} + G_C(\\omega) + j\\omega C = \\left(\\frac{1}{R} + \\omega C \\tan\\delta\\right) + j\\omega C\n$$\n噪声源是电阻 $R$ 和损耗电导 $G_C$。根据涨落-耗散定理，任何耗散元件（即阻抗或导纳的实部）都会产生热噪声。在温度 $T$ 下处于热平衡状态的单端口网络，其阻抗为 $Z(j\\omega)$，其两端的单边带电压噪声谱密度 $S_v(f)$ 由下式给出：\n$$\nS_v(f) = 4 k_B T \\mathrm{Re}\\{Z(j\\omega)\\}\n$$\n其中 $k_B$ 是玻尔兹曼常数，且 $\\omega = 2\\pi f$。环路滤波器的阻抗是其导纳的倒数：\n$$\nZ_{LF}(j\\omega) = \\frac{1}{Y_{LF}(j\\omega)} = \\frac{1}{\\left(\\frac{1}{R} + \\omega C \\tan\\delta\\right) + j\\omega C}\n$$\n为了求出实部，我们将分子和分母同乘以分母的复共轭：\n$$\nZ_{LF}(j\\omega) = \\frac{\\left(\\frac{1}{R} + \\omega C \\tan\\delta\\right) - j\\omega C}{\\left(\\frac{1}{R} + \\omega C \\tan\\delta\\right)^2 + (\\omega C)^2}\n$$\n因此，阻抗的实部为：\n$$\n\\mathrm{Re}\\{Z_{LF}(j\\omega)\\} = \\frac{\\frac{1}{R} + \\omega C \\tan\\delta}{\\left(\\frac{1}{R} + \\omega C \\tan\\delta\\right)^2 + (\\omega C)^2}\n$$\n在指定偏置频率 $f_0$ (其中 $\\omega_0 = 2\\pi f_0$) 时，VCO 控制节点处的电压噪声谱密度 $S_{v,VCOctrl}(f_0)$ 为：\n$$\nS_{v,VCOctrl}(f_0) = 4 k_B T \\mathrm{Re}\\{Z_{LF}(j\\omega_0)\\} = 4 k_B T \\frac{\\frac{1}{R} + \\omega_0 C \\tan\\delta}{\\left(\\frac{1}{R} + \\omega_0 C \\tan\\delta\\right)^2 + (\\omega_0 C)^2}\n$$\nVCO 控制输入端的这种电压噪声会调制 VCO 的频率，从而在输出端产生相位噪声。VCO 输出相位 $\\varphi_{out}(t)$ 和控制电压 $v_{ctrl}(t)$ 之间的关系是 $\\frac{d\\varphi_{out}}{dt} = K_{\\mathrm{vco}} v_{ctrl}(t)$。在频域中，这对应于 $\\Phi_{out}(j\\omega) = \\frac{K_{\\mathrm{vco}}}{j\\omega} V_{ctrl}(j\\omega)$。对于单边带功率谱密度的相应关系是：\n$$\nS_{\\varphi}(f) = \\left|\\frac{K_{\\mathrm{vco}}}{j\\omega}\\right|^2 S_v(f) = \\frac{K_{\\mathrm{vco}}^2}{\\omega^2} S_v(f) = \\left(\\frac{K_{\\mathrm{vco}}}{2\\pi f}\\right)^2 S_v(f)\n$$\n问题中指出，在偏置频率 $f_0$ 处，闭环抑制可以忽略不计，这证明了使用这种开环关系来计算来自滤波器的输出相位噪声贡献是合理的。\n结合这些表达式，我们得到输出相位噪声谱密度的最终公式：\n$$\nS_{\\varphi}(f_0) = \\left(\\frac{K_{\\mathrm{vco}}}{2\\pi f_0}\\right)^2 \\left( 4 k_B T \\frac{\\frac{1}{R} + (2\\pi f_0) C \\tan\\delta}{\\left(\\frac{1}{R} + (2\\pi f_0) C \\tan\\delta\\right)^2 + ((2\\pi f_0) C)^2} \\right)\n$$\n现在，我们代入给定的数值：\n- $R = 10{,}000\\,\\Omega = 10^4\\,\\Omega$\n- $C = 100\\,\\mathrm{nF} = 10^{-7}\\,\\mathrm{F}$\n- $\\tan\\delta = 2.0\\times 10^{-3}$\n- $T = 300\\,\\mathrm{K}$\n- $K_{\\mathrm{vco}} = 2\\pi\\times 5.0\\times 10^{6}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}\\,\\mathrm{V}^{-1}$\n- $f_{0} = 1.0\\times 10^{5}\\,\\mathrm{Hz}$\n- $k_B \\approx 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$\n\n首先，计算角频率 $\\omega_0 = 2\\pi f_0 = 2\\pi \\times 1.0 \\times 10^5\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$。\n项 $\\frac{K_{\\mathrm{vco}}}{2\\pi f_0}$ 简化为：\n$$\n\\frac{K_{\\mathrm{vco}}}{2\\pi f_0} = \\frac{2\\pi\\times 5.0\\times 10^{6}}{2\\pi \\times 1.0\\times 10^{5}} = 50\n$$\n所以，$\\left(\\frac{K_{\\mathrm{vco}}}{2\\pi f_0}\\right)^2 = 50^2 = 2500$。\n\n接下来，我们计算噪声表达式的各个组成部分：\n电阻的电导为 $\\frac{1}{R} = \\frac{1}{10^4} = 10^{-4}\\,\\mathrm{S}$。\n电纳项为 $\\omega_0 C = (2\\pi \\times 10^5) \\times 10^{-7} = 2\\pi \\times 10^{-2}\\,\\mathrm{S} \\approx 0.062832\\,\\mathrm{S}$。\n来自电容器损耗的等效并联电导为 $G_C = \\omega_0 C \\tan\\delta = (2\\pi \\times 10^{-2}) \\times (2.0 \\times 10^{-3}) = 4\\pi \\times 10^{-5}\\,\\mathrm{S} \\approx 1.2566 \\times 10^{-4}\\,\\mathrm{S}$。\n总耗散电导为 $G_{total_n} = \\frac{1}{R} + G_C = 10^{-4} + 4\\pi \\times 10^{-5} = (1 + 0.4\\pi) \\times 10^{-4}\\,\\mathrm{S} \\approx 2.2566 \\times 10^{-4}\\,\\mathrm{S}$。\n\n现在我们可以计算 $S_{v,VCOctrl}(f_0)$。热能项为 $4 k_B T = 4 \\times (1.380649 \\times 10^{-23}) \\times 300 \\approx 1.6568 \\times 10^{-20}\\,\\mathrm{J}$。\n噪声项的分母为：\n$$\n(\\frac{1}{R} + \\omega_0 C \\tan\\delta)^2 + (\\omega_0 C)^2 = (2.2566 \\times 10^{-4})^2 + (2\\pi \\times 10^{-2})^2 \\approx 5.092 \\times 10^{-8} + 3.9478 \\times 10^{-3} \\approx 3.9479 \\times 10^{-3}\\,\\mathrm{S}^2\n$$\n电压噪声谱密度为：\n$$\nS_{v,VCOctrl}(f_0) = \\frac{1.6568 \\times 10^{-20} \\times (2.2566 \\times 10^{-4})}{3.9479 \\times 10^{-3}} \\approx \\frac{3.738 \\times 10^{-24}}{3.9479 \\times 10^{-3}} \\approx 9.468 \\times 10^{-22}\\,\\mathrm{V}^2/\\mathrm{Hz}\n$$\n最后，我们计算输出相位噪声谱密度：\n$$\nS_{\\varphi}(f_0) = \\left(\\frac{K_{\\mathrm{vco}}}{2\\pi f_0}\\right)^2 S_{v,VCOctrl}(f_0) = 2500 \\times (9.468 \\times 10^{-22}) \\approx 2.367 \\times 10^{-18}\\,\\mathrm{rad}^2/\\mathrm{Hz}\n$$\n将结果四舍五入到三位有效数字，得到 $2.37 \\times 10^{-18}\\,\\mathrm{rad}^2/\\mathrm{Hz}$。",
            "answer": "$$\n\\boxed{2.37 \\times 10^{-18}}\n$$"
        }
    ]
}