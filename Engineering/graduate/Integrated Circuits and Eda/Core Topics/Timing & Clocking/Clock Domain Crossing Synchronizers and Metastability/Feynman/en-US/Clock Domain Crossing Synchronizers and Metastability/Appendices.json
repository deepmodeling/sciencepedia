{
    "hands_on_practices": [
        {
            "introduction": "The two-stage flip-flop synchronizer is the fundamental building block for handling clock domain crossings. While simple in structure, its reliability is governed by the probabilistic nature of metastability. This first practice guides you through the essential derivation of its Mean Time Between Failures (MTBF), starting from basic timing parameters. By calculating the available resolution time and applying the exponential model for metastability, you will build a foundational quantitative understanding of what makes a synchronizer robust .",
            "id": "4259927",
            "problem": "A two-stage flip-flop synchronizer is used to transfer an asynchronous binary signal into a destination clock domain in an integrated circuit designed under the methods of Electronic Design Automation (EDA). The synchronizer consists of two positive-edge-triggered D flip-flops in series, both clocked by the destination clock. The first stage ($\\text{FF1}$) samples the asynchronous input, and the second stage ($\\text{FF2}$) samples the output of $\\text{FF1}$ one destination clock cycle later. Let the destination clock period be $T_{clk}$. Let the clock arrival times at $\\text{FF1}$ and $\\text{FF2}$ differ by a clock skew $skew$, defined as the time by which the clock at $\\text{FF2}$ is advanced with respect to the clock at $\\text{FF1}$; a positive $skew$ reduces the time available between the two sampling events. The first-stage clock-to-$Q$ delay is $t_{cq1}$, and the second-stage setup time requirement is $t_{setup2}$. \n\nUnder the standard metastability model for bistable circuits, once a sampling event drives the first-stage latch into a metastable state, the probability that the metastable state persists longer than a time $t$ decays approximately exponentially with characteristic time constant $\\tau>0$, and a device- and process-dependent parameter $T_{0}>0$ captures the effective width of the vulnerable timing aperture and the gain factors of the latch. Assume the asynchronous input transitions at an average rate equal to the destination clock frequency and that sampling occurs every destination clock, i.e., both the input transition rate and the sampling rate equal $1/T_{clk}$.\n\nStarting only from these definitions and assumptions, and the behavior of exponential decay of metastability resolution with time constant $\\tau$, perform the following:\n\n1. Derive the available metastability resolution time $T_{res}$ between the sampling edge at $\\text{FF1}$ and the next sampling edge at $\\text{FF2}$, expressed in terms of $T_{clk}$, $t_{cq1}$, $t_{setup2}$, and $skew$. Clearly justify each term in your expression based on timing requirements and causality.\n\n2. Using the exponential resolution model and the stated event and sampling rates, derive a closed-form analytic expression for the Mean Time Between Failures (MTBF) of this two-flop synchronizer in seconds as a function of $T_{clk}$, $t_{cq1}$, $t_{setup2}$, $skew$, $\\tau$, and $T_{0}$. Express your final MTBF as a single closed-form expression in seconds. Do not evaluate numerically; no rounding is required.",
            "solution": "The goal is to derive the available resolution time for metastability and then, using a well-supported stochastic model of metastability resolution, derive the failure rate and the Mean Time Between Failures (MTBF).\n\nWe begin with the timing structure of a two-stage synchronizer in the destination clock domain. The two flip-flops are clocked by the destination clock. Let the clock period be $T_{clk}$, and let the clock arrival time at the second flip-flop $\\text{FF2}$ be advanced by $skew$ relative to the arrival time at the first flip-flop $\\text{FF1}$. A positive $skew$ thus reduces the time between the sampling edges of $\\text{FF1}$ and $\\text{FF2}$ from $T_{clk}$ to $T_{clk}-skew$.\n\nThe first flip-flop $\\text{FF1}$ samples the asynchronous input at a rising edge. If that sampling violates aperture timing (arriving sufficiently close to the sampling instant), $\\text{FF1}$ can enter a metastable state and only resolve after some random resolution time. The earliest time at which the output of $\\text{FF1}$ ($Q_1$) can become valid and start propagating toward $\\text{FF2}$ is the clock edge time at $\\text{FF1}$ plus the clock-to-$Q$ delay $t_{cq1}$, plus the random additional time the state takes to move sufficiently close to a stable rail. The input of $\\text{FF2}$ must be stable for $t_{setup2}$ before the sampling edge at $\\text{FF2}$ to ensure correct capture. Therefore, the available time for the metastable state at $\\text{FF1}$ to resolve must fit before the instant $(\\text{FF2 clock edge}) - t_{setup2}$.\n\nLet the pertinent edges be synchronized as follows: A sampling event occurs at $\\text{FF1}$ at time $t=0$. The next sampling edge at $\\text{FF2}$ occurs at time $t=T_{clk}-skew$ (because of the assumed positive $skew$ advancing $\\text{FF2}$). For correct capture, $Q_1$ must have stabilized and reached $\\text{FF2}$ input at least $t_{setup2}$ before this $\\text{FF2}$ edge. Also, $Q_1$ does not begin to change until after the deterministic delay $t_{cq1}$ from the $\\text{FF1}$ edge. These timing requirements yield the available resolution time from the $\\text{FF1}$ sampling instant to the latest allowed arrival at $\\text{FF2}$ input as\n$$\nT_{res} \\;=\\; (\\text{time from }\\text{FF1}\\text{ edge to }\\text{FF2}\\text{ edge}) \\;-\\; t_{cq1} \\;-\\; t_{setup2} \\;=\\; T_{clk} - skew - t_{cq1} - t_{setup2}.\n$$\nThis expression subtracts the deterministic time budgets $t_{cq1}$ and $t_{setup2}$ and the effective reduction in edge spacing $skew$ from the nominal one-period separation $T_{clk}$, leaving the interval available for the metastable state in $\\text{FF1}$ to resolve such that $\\text{FF2}$ samples a valid level.\n\nNext we turn to the metastability resolution statistics. For a bistable element driven into metastability by a violating input arriving near a sampling edge, the distribution of the time it takes to resolve sufficiently close to a stable rail obeys an exponential tail beyond a small offset. A widely used form models the probability that the resolution time exceeds $t$ as proportional to $\\exp(-t/\\tau)$, where $\\tau$ is the latch’s time constant. The constant of proportionality is not a pure probability but emerges in failure rate calculations as a factor with units of time, customarily denoted $T_{0}$, which incorporates the effective width of the vulnerable aperture and gain-related parameters. When combining this decay with independent input transition events and independent sampling events, the failure rate per unit time is modeled as the product of (i) the rate of opportunities for a violating arrival relative to a sampling edge and (ii) the probability that the resulting metastability persists longer than the available resolution time:\n$$\n\\lambda \\;=\\; f_{\\text{clk}} \\, f_{\\text{data}} \\, T_{0} \\, \\exp\\!\\left(-\\frac{T_{res}}{\\tau}\\right),\n$$\nwhere $f_{\\text{clk}}$ is the destination sampling rate and $f_{\\text{data}}$ is the average input transition rate into the synchronizer. Under the stated assumption, both rates equal the destination clock frequency: $f_{\\text{clk}}=f_{\\text{data}}=\\frac{1}{T_{clk}}$. Substituting these and our derived $T_{res}$ gives\n$$\n\\lambda \\;=\\; \\left(\\frac{1}{T_{clk}}\\right)\\left(\\frac{1}{T_{clk}}\\right) T_{0} \\, \\exp\\!\\left(-\\frac{T_{clk}-t_{cq1}-t_{setup2}-skew}{\\tau}\\right)\n\\;=\\; \\frac{T_{0}}{T_{clk}^{2}} \\, \\exp\\!\\left(-\\frac{T_{clk}-t_{cq1}-t_{setup2}-skew}{\\tau}\\right).\n$$\nThe Mean Time Between Failures (MTBF) is the reciprocal of the failure rate,\n$$\n\\text{MTBF} \\;=\\; \\frac{1}{\\lambda} \\;=\\; \\frac{T_{clk}^{2}}{T_{0}} \\, \\exp\\!\\left(\\frac{T_{clk}-t_{cq1}-t_{setup2}-skew}{\\tau}\\right),\n$$\nwhich is in seconds because $T_{clk}^{2}/T_{0}$ has dimensions of time and the exponential is dimensionless.\n\nIn summary, the derived available resolution time is\n$$\nT_{res} \\;=\\; T_{clk} - t_{cq1} - t_{setup2} - skew,\n$$\nand, under the stated rates and metastability model, the MTBF in seconds is\n$$\n\\text{MTBF} \\;=\\; \\frac{T_{clk}^{2}}{T_{0}} \\, \\exp\\!\\left(\\frac{T_{clk}-t_{cq1}-t_{setup2}-skew}{\\tau}\\right).\n$$",
            "answer": "$$\\boxed{\\frac{T_{clk}^{2}}{T_{0}} \\exp\\!\\left(\\frac{T_{clk}-t_{cq1}-t_{setup2}-skew}{\\tau}\\right)}$$"
        },
        {
            "introduction": "Moving from theoretical analysis to practical engineering, designers often work backward from a system-level reliability target. A modern System-on-Chip (SoC) may contain thousands of clock domain crossing paths, and the entire system must meet a stringent MTBF goal, often measured in decades. This exercise challenges you to perform this reverse calculation: given a target system MTBF, you will determine the minimum necessary metastability resolution time, $T_{\\text{res}}$, and the corresponding timing budget for the circuit implementation. This problem highlights the critical link between high-level system requirements and low-level physical design constraints .",
            "id": "4259955",
            "problem": "A two-stage clock domain crossing synchronizer is used to capture an asynchronous data stream into a destination clock domain. The first flip-flop may enter a metastable state if the asynchronous data transition occurs within a small aperture window around a destination clock edge. Assume the following fundamental base for metastability and event modeling:\n- Asynchronous data transitions are modeled as a Poisson process with average rate $f_{\\mathrm{data}}$.\n- Destination clock sampling edges occur with average rate $f_{\\mathrm{clk}}$.\n- A setup/hold aperture window of width $T_{w}$ around a sampling edge defines when the first flip-flop can be excited into a metastable state.\n- Once excited, the probability that the metastable state persists longer than a resolution time $t$ decays exponentially as $\\exp(-t/\\tau)$, where $\\tau$ is the metastability time constant of the first flip-flop.\n- There are $M$ independent and identical synchronizer instances in the chip, and failures across instances are statistically independent.\n\nDefine the resolution time available between the first and second flip-flops as\n$$\nT_{\\mathrm{res}} = T_{\\mathrm{clk}} - \\left(t_{\\mathrm{cq1}} + t_{\\mathrm{setup2}} + \\mathrm{skew}\\right),\n$$\nwhere $T_{\\mathrm{clk}} = 1/f_{\\mathrm{clk}}$ is the destination clock period, $t_{\\mathrm{cq1}}$ is the clock-to-$Q$ delay of the first flip-flop, $t_{\\mathrm{setup2}}$ is the setup time of the second flip-flop, and $\\mathrm{skew}$ is the clock or routing skew between the first and second flip-flops. A system-level failure occurs if any synchronizer instance presents a metastable output to its second-stage sampling edge, that is, if the first stage remains metastable beyond $T_{\\mathrm{res}}$.\n\nStarting only from the assumptions above and standard properties of Poisson processes and exponential survival for metastability, derive a closed-form expression for the minimum $T_{\\mathrm{res}}$ that guarantees a specified system-level mean time between failures (MTBF) target, $\\mathrm{MTBF}_{\\mathrm{sys}}$. Then evaluate it numerically for the following parameters:\n- $f_{\\mathrm{clk}} = 1.2\\ \\text{GHz}$,\n- $f_{\\mathrm{data}} = 0.5\\ \\text{GHz}$,\n- $T_{w} = 20\\ \\text{ps}$,\n- $\\tau = 8\\ \\text{ps}$,\n- $M = 4000$,\n- $\\mathrm{MTBF}_{\\mathrm{sys}} = 50\\ \\text{years}$, with $1\\ \\text{year} = 365.25\\ \\text{days}$.\n\nUsing your derived $T_{\\mathrm{res}}$, compute the maximum allowable budget for the sum $t_{\\mathrm{cq1}} + t_{\\mathrm{setup2}} + \\mathrm{skew}}$.\n\nExpress both the minimum $T_{\\mathrm{res}}$ and the maximum allowable $t_{\\mathrm{cq1}} + t_{\\mathrm{setup2}} + \\mathrm{skew}$ in nanoseconds, and round your answers to four significant figures. The final answer must be a pair written as a single row matrix $\\begin{pmatrix} \\cdot & \\cdot \\end{pmatrix}$.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the standard model of synchronizer metastability, is well-posed with sufficient and consistent data, and is directly relevant to the field of digital integrated circuit design.\n\nThe solution proceeds by first deriving the system-level Mean Time Between Failures ($\\mathrm{MTBF}_{\\mathrm{sys}}$) and then inverting the resulting expression to solve for the required minimum resolution time, $T_{\\mathrm{res}}$.\n\nThe rate of system failures, $R_{\\mathrm{fail\\_sys}}$, is the reciprocal of the system MTBF, assuming failures are rare events that can be modeled as a Poisson process.\n$$ \\mathrm{MTBF}_{\\mathrm{sys}} = \\frac{1}{R_{\\mathrm{fail\\_sys}}} $$\nThe total system failure rate is the sum of the failure rates of the $M$ independent and identical synchronizer instances.\n$$ R_{\\mathrm{fail\\_sys}} = M \\cdot R_{\\mathrm{fail\\_single}} $$\nwhere $R_{\\mathrm{fail\\_single}}$ is the failure rate of a single synchronizer.\n\nThe failure rate of a single synchronizer is the product of two factors: the rate at which its first flip-flop is excited into a metastable state, $R_{\\mathrm{exc}}$, and the probability that, once excited, the flip-flop fails to resolve to a stable state within the allotted time $T_{\\mathrm{res}}$, denoted $P_{\\mathrm{fail|exc}}$.\n$$ R_{\\mathrm{fail\\_single}} = R_{\\mathrm{exc}} \\cdot P_{\\mathrm{fail|exc}} $$\nA metastable excitation occurs when an asynchronous data transition arrives within the setup-hold aperture window $T_w$ of a destination clock edge. The asynchronous data transitions are modeled as a Poisson process with an average rate of $f_{\\mathrm{data}}$. The destination clock provides sampling opportunities at an average rate of $f_{\\mathrm{clk}}$. The total duration of the vulnerable aperture windows per unit time is $f_{\\mathrm{clk}} \\cdot T_w$. For a Poisson process of data transitions, the rate of events (transitions) occurring within these windows is the product of the data transition rate and the fraction of time the windows are open.\n$$ R_{\\mathrm{exc}} = f_{\\mathrm{data}} \\cdot (f_{\\mathrm{clk}} \\cdot T_w) $$\nThis expression is a standard and accurate approximation when the duration of the aperture window $T_w$ is much smaller than the average time between data transitions, $1/f_{\\mathrm{data}}$, and clock periods, $1/f_{\\mathrm{clk}}$.\n\nThe probability that a metastable state persists for a time longer than $t$ is given as an exponential survival function, $\\exp(-t/\\tau)$. A failure occurs if the state persists beyond the available resolution time, $T_{\\mathrm{res}}$. Thus, the conditional probability of failure upon excitation is:\n$$ P_{\\mathrm{fail|exc}} = \\exp\\left(-\\frac{T_{\\mathrm{res}}}{\\tau}\\right) $$\nCombining these expressions, the failure rate for a single synchronizer is:\n$$ R_{\\mathrm{fail\\_single}} = (f_{\\mathrm{clk}} f_{\\mathrm{data}} T_w) \\exp\\left(-\\frac{T_{\\mathrm{res}}}{\\tau}\\right) $$\nThe system-level MTBF can now be expressed as:\n$$ \\mathrm{MTBF}_{\\mathrm{sys}} = \\frac{1}{M \\cdot R_{\\mathrm{fail\\_single}}} = \\frac{1}{M f_{\\mathrm{clk}} f_{\\mathrm{data}} T_w \\exp\\left(-\\frac{T_{\\mathrm{res}}}{\\tau}\\right)} = \\frac{\\exp\\left(\\frac{T_{\\mathrm{res}}}{\\tau}\\right)}{M f_{\\mathrm{clk}} f_{\\mathrm{data}} T_w} $$\nTo find the minimum $T_{\\mathrm{res}}$ that guarantees a target $\\mathrm{MTBF}_{\\mathrm{sys}}$, we solve this equation for $T_{\\mathrm{res}}$:\n$$ \\exp\\left(\\frac{T_{\\mathrm{res}}}{\\tau}\\right) = \\mathrm{MTBF}_{\\mathrm{sys}} \\cdot M \\cdot f_{\\mathrm{clk}} \\cdot f_{\\mathrm{data}} \\cdot T_w $$\nTaking the natural logarithm of both sides:\n$$ \\frac{T_{\\mathrm{res}}}{\\tau} = \\ln\\left(\\mathrm{MTBF}_{\\mathrm{sys}} \\cdot M \\cdot f_{\\mathrm{clk}} \\cdot f_{\\mathrm{data}} \\cdot T_w\\right) $$\nThis yields the closed-form expression for the minimum required resolution time:\n$$ T_{\\mathrm{res}} = \\tau \\ln\\left(M \\cdot f_{\\mathrm{clk}} \\cdot f_{\\mathrm{data}} \\cdot T_w \\cdot \\mathrm{MTBF}_{\\mathrm{sys}}\\right) $$\nNow, we substitute the given numerical values:\n- $f_{\\mathrm{clk}} = 1.2\\ \\text{GHz} = 1.2 \\times 10^9\\ \\text{s}^{-1}$\n- $f_{\\mathrm{data}} = 0.5\\ \\text{GHz} = 0.5 \\times 10^9\\ \\text{s}^{-1}$\n- $T_{w} = 20\\ \\text{ps} = 20 \\times 10^{-12}\\ \\text{s}$\n- $\\tau = 8\\ \\text{ps} = 8 \\times 10^{-12}\\ \\text{s}$\n- $M = 4000$\n- $\\mathrm{MTBF}_{\\mathrm{sys}} = 50\\ \\text{years}$\n\nFirst, we convert $\\mathrm{MTBF}_{\\mathrm{sys}}$ to seconds:\n$$ \\mathrm{MTBF}_{\\mathrm{sys}} = 50\\ \\text{years} \\times 365.25\\ \\frac{\\text{days}}{\\text{year}} \\times 24\\ \\frac{\\text{hours}}{\\text{day}} \\times 3600\\ \\frac{\\text{s}}{\\text{hour}} = 1,577,880,000\\ \\text{s} $$\nNext, we compute the argument of the logarithm:\n$$ \\text{Arg} = M \\cdot f_{\\mathrm{clk}} \\cdot f_{\\mathrm{data}} \\cdot T_w \\cdot \\mathrm{MTBF}_{\\mathrm{sys}} $$\n$$ \\text{Arg} = (4000) \\cdot (1.2 \\times 10^9) \\cdot (0.5 \\times 10^9) \\cdot (20 \\times 10^{-12}) \\cdot (1.57788 \\times 10^9) $$\n$$ \\text{Arg} = (4 \\times 10^3) \\cdot (1.2 \\times 10^9) \\cdot (0.5 \\times 10^9) \\cdot (2 \\times 10^{-11}) \\cdot (1.57788 \\times 10^9) $$\n$$ \\text{Arg} = (4 \\cdot 1.2 \\cdot 0.5 \\cdot 2 \\cdot 1.57788) \\times 10^{(3+9+9-11+9)} = 7.573824 \\times 10^{19} $$\nNow we can calculate $T_{\\mathrm{res}}$:\n$$ T_{\\mathrm{res}} = (8 \\times 10^{-12}\\ \\text{s}) \\cdot \\ln(7.573824 \\times 10^{19}) $$\n$$ T_{\\mathrm{res}} \\approx (8 \\times 10^{-12}) \\cdot 45.773815 = 3.6619052 \\times 10^{-10}\\ \\text{s} $$\nConverting to nanoseconds and rounding to four significant figures:\n$$ T_{\\mathrm{res}} \\approx 0.3662\\ \\text{ns} $$\nThe second part of the problem is to find the maximum allowable budget for the sum $t_{\\mathrm{cq1}} + t_{\\mathrm{setup2}} + \\mathrm{skew}$. This budget is derived from the definition of $T_{\\mathrm{res}}$:\n$$ T_{\\mathrm{res}} = T_{\\mathrm{clk}} - \\left(t_{\\mathrm{cq1}} + t_{\\mathrm{setup2}} + \\mathrm{skew}\\right) $$\nLet $T_{\\mathrm{budget}} = t_{\\mathrm{cq1}} + t_{\\mathrm{setup2}} + \\mathrm{skew}$. To maximize $T_{\\mathrm{budget}}$, we must use the minimum required $T_{\\mathrm{res}}$.\n$$ T_{\\mathrm{budget, max}} = T_{\\mathrm{clk}} - T_{\\mathrm{res, min}} $$\nFirst, we calculate the destination clock period $T_{\\mathrm{clk}}$:\n$$ T_{\\mathrm{clk}} = \\frac{1}{f_{\\mathrm{clk}}} = \\frac{1}{1.2 \\times 10^9\\ \\text{s}^{-1}} = \\frac{5}{6} \\times 10^{-9}\\ \\text{s} \\approx 0.833333...\\ \\text{ns} $$\nNow, we compute the maximum budget:\n$$ T_{\\mathrm{budget, max}} = (0.833333... - 0.36619052...)\\ \\text{ns} = 0.46714281...\\ \\text{ns} $$\nRounding to four significant figures:\n$$ T_{\\mathrm{budget, max}} \\approx 0.4671\\ \\text{ns} $$\nThe two requested values are the minimum $T_{\\mathrm{res}}$ and the maximum timing budget.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.3662 & 0.4671 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Synchronizing a single bit is a solved problem, but transferring multi-bit data, such as a state machine's value or a counter, introduces the new challenge of data coherency. Due to minute skews in signal paths, a receiver might sample a mix of \"old\" and \"new\" data, resulting in an invalid or unintended state. This practice explores this critical failure mode by having you calculate the probability of such a decoding error for a standard binary-encoded bus. It then provides the opportunity to reason from first principles why Gray coding, where only one bit changes between adjacent states, elegantly eliminates this entire class of errors .",
            "id": "4259963",
            "problem": "A digital system employs clock domain crossing from a source clock domain to a receiving clock domain. The source domain drives a two-bit state bus that is binary encoded with states $\\{00,01,10,11\\}$. The receiving domain uses two independent two-stage flip-flop synchronizers, one per bit, to sample the bus. The receiving domain clock has period $T_{r}$, and the phase offset of any data transition relative to a given receiving clock edge is modeled as uniformly distributed on $[0,T_{r})$. All transitions on the bus are driven by source-domain logic that causes the two bits to change nominally at the same source clock edge when moving between certain states; however, due to path differences, the arrival times of the two bit transitions at the inputs of the first-stage synchronizers differ by a random skew $S$ with magnitude uniformly distributed on $[0,S_{\\max}]$. Assume $S_{\\max} < T_{r}$ and that $S$ is independent of the receiving clock phase.\n\nA decoding error within the receiving domain is said to occur if, during a single receiving clock edge, one synchronizer captures the “old” value of its bit while the other captures the “new” value of its bit, producing a mixed two-bit code that equals a valid but unintended binary state and is therefore misinterpreted by downstream logic for one receiving cycle. Treat metastability in the synchronizers as resolved within one cycle so that the only error mechanism considered is misdecoding caused by reconvergent mixed states when both bits transition.\n\nLet the fraction of state transitions that involve both bits toggling in the binary encoding be $\\alpha$. For the parameters $T_{r} = 5\\,\\text{ns}$, $S_{\\max} = 0.45\\,\\text{ns}$, and $\\alpha = 0.30$, compute the average probability of decoding error per source-domain state transition. Round your final numerical probability to four significant figures.\n\nFinally, explain, starting from the defining property of Gray coding (only one bit changes between adjacent states), why this particular mixed-code misdecode error mode is eliminated if the state bus is Gray coded and only adjacent Gray transitions are permitted. You must justify the elimination without invoking any shortcut formulas, by reasoning directly from the stated stochastic sampling model and the one-bit-change property.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. It is based on established principles of digital logic design, specifically clock domain crossing synchronization. The probabilistic model is a standard and appropriate simplification used in the analysis of such systems. Therefore, the problem is deemed valid.\n\nThe solution is divided into two parts as requested: first, the computation of the decoding error probability, and second, a conceptual explanation regarding Gray coding.\n\n### Part 1: Calculation of Average Error Probability\n\nThe average probability of a decoding error per source-domain state transition, denoted $P_{\\text{error}}$, is the product of two probabilities:\n$1$. The probability that a state transition involves both bits toggling.\n$2$. The conditional probability that a decoding error occurs, given that both bits are toggling.\n\nThe problem states that the fraction of state transitions involving both bits toggling is $\\alpha$. Thus,\n$$P(\\text{2-bit transition}) = \\alpha$$\nA decoding error, as defined, can only occur during such a 2-bit transition. Our task reduces to finding the conditional probability, $P(\\text{error} | \\text{2-bit transition})$, and then computing the total probability as $P_{\\text{error}} = \\alpha \\times P(\\text{error} | \\text{2-bit transition})$.\n\nLet us analyze the condition for a decoding error. An error occurs when the receiving clock's sampling edge arrives in the time interval between the first bit's transition and the second bit's transition. This interval is the \"danger window\". During this window, one bit has its \"new\" value while the other still has its \"old\" value.\n\nLet the duration of this danger window be defined by the skew, $S$. The skew $S$ is the magnitude of the difference in arrival times of the two transitioning bits. The problem specifies that $S$ is a random variable, uniformly distributed over the interval $[0, S_{\\max}]$. The probability density function (PDF) of $S$ is:\n$$f_S(s) = \\begin{cases} \\frac{1}{S_{\\max}} & \\text{for } 0 \\le s \\le S_{\\max} \\\\ 0 & \\text otherwise \\end{cases}$$\nThe problem also states that the phase offset of a data transition relative to a receiving clock edge is uniformly distributed on $[0, T_r)$. This is equivalent to stating that for a data bus with changing signals, the probability of a random sampling clock edge falling within any specific time interval of duration $\\Delta t$ is given by $\\frac{\\Delta t}{T_r}$, provided $\\Delta t < T_r$.\n\nFor a specific instance of a 2-bit transition with a given skew value $s$, the duration of the danger window is $s$. The probability that the sampling clock edge falls within this window is:\n$$P(\\text{error} | S=s) = \\frac{s}{T_r}$$\nThis is valid because the problem specifies $S_{\\max} < T_r$, which implies $s < T_r$ for all possible values of $s$.\n\nTo find the average probability of error given a 2-bit transition, we must average this conditional probability over all possible values of the skew $S$, weighted by the PDF of $S$. This is calculated by finding the expected value of $P(\\text{error} | S)$.\n$$P(\\text{error} | \\text{2-bit transition}) = E[P(\\text{error} | S)] = E\\left[\\frac{S}{T_r}\\right] = \\frac{1}{T_r} E[S]$$\nThe expected value of a random variable $S$ uniformly distributed on $[0, S_{\\max}]$ is:\n$$E[S] = \\int_{-\\infty}^{\\infty} s f_S(s) ds = \\int_{0}^{S_{\\max}} s \\left(\\frac{1}{S_{\\max}}\\right) ds = \\frac{1}{S_{\\max}} \\left[ \\frac{s^2}{2} \\right]_0^{S_{\\max}} = \\frac{1}{S_{\\max}} \\left( \\frac{S_{\\max}^2}{2} - 0 \\right) = \\frac{S_{\\max}}{2}$$\nSubstituting this result back, we get the conditional probability of error:\n$$P(\\text{error} | \\text{2-bit transition}) = \\frac{1}{T_r} \\left( \\frac{S_{\\max}}{2} \\right) = \\frac{S_{\\max}}{2T_r}$$\nFinally, the average probability of decoding error per source-domain state transition is:\n$$P_{\\text{error}} = \\alpha \\times P(\\text{error} | \\text{2-bit transition}) = \\alpha \\frac{S_{\\max}}{2T_r}$$\nWe are given the numerical values: $T_r = 5\\,\\text{ns}$, $S_{\\max} = 0.45\\,\\text{ns}$, and $\\alpha = 0.30$. Substituting these into the expression:\n$$P_{\\text{error}} = 0.30 \\times \\frac{0.45\\,\\text{ns}}{2 \\times 5\\,\\text{ns}} = 0.30 \\times \\frac{0.45}{10} = 0.30 \\times 0.045 = 0.0135$$\nThe problem requires the answer to be rounded to four significant figures.\n$$P_{\\text{error}} = 0.01350$$\n\n### Part 2: Justification for Gray Coding\n\nThe problem asks for an explanation of why the specified error mode is eliminated if the state bus is Gray coded and only adjacent state transitions are permitted. The justification must be based on first principles.\n\n$1$. **Definition of the Error Mode**: The error is defined as a \"mixed-code misdecode\". This occurs when, for a multi-bit bus, the receiving synchronizers sample the bits during the interval of skew between them. This results in a captured state vector composed of a mix of \"old\" and \"new\" bit values, which happens to form a valid but unintended state. The necessary precondition for this error is that *at least two bits must change their value* during the state transition.\n\n$2$. **Defining Property of Gray Codes**: The fundamental property of a Gray code is that any two adjacent code words in the sequence differ by only a single bit. The problem constrains the system to only permit \"adjacent Gray transitions\".\n\n$3$. **Analysis of a Transition**: Consider a state transition from a State $A$ to an adjacent State $B$ on a Gray-coded bus. Let the state be represented by a vector of bits. Due to the Gray code property, State $A$ and State $B$ differ in value at exactly one bit position. Let's say bit $k$ is the one that changes, while all other bits $i \\neq k$ remain constant.\n\n$4$. **Sampling of Constant Bits**: For any bit $i \\neq k$, its value is stable and does not change during the transition. The synchronizer for each of these bits receives a constant input. Consequently, regardless of the timing of the receiving clock edge, it will correctly and unambiguously sample the constant value of its corresponding bit.\n\n$5$. **Sampling of the Changing Bit**: The single bit $k$ that is changing will transition from its old value, $B_k^{\\text{old}}$, to its new value, $B_k^{\\text{new}}$. The synchronizer for bit $k$ will sample the data line at some point. Depending on whether the sampling clock edge arrives before or after the transition of bit $k$, the synchronizer will capture either $B_k^{\\text{old}}$ or $B_k^{\\text{new}}$. (Under the problem's simplifying assumption, we ignore the case where it becomes metastable and fails to resolve).\n\n$6$. **Resulting Sampled States**: Combining these outcomes, the complete state vector captured by the receiving domain logic has two and only two possibilities:\n    - All bits are captured with their old values (if bit $k$ is captured before its transition). This reconstructs the original State $A$.\n    - All stable bits are captured with their constant value, and the single changing bit $k$ is captured with its new value. This reconstructs the final State $B$.\n\n$7$. **Elimination of the Error**: Since the only possible states that the receiving logic can sample are the correct initial state ($A$) or the correct final state ($B$), it is structurally impossible to form any other state. The \"mixed-code misdecode\" error, which is defined by the creation of a valid but *unintended* state, cannot occur. The concept of an inter-bit skew \"danger window\" is not applicable, as there is only one changing bit; there are no multiple, concurrent transitions between which a skew could manifest. Therefore, the use of a Gray code for adjacent state transitions entirely eliminates this specific error mechanism by its very nature.",
            "answer": "$$\n\\boxed{0.01350}\n$$"
        }
    ]
}