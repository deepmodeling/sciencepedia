{
    "hands_on_practices": [
        {
            "introduction": "在我们开始优化线长之前，我们必须首先能够定义和衡量它。本练习将介绍三种基本的线长模型：简单的半周长线长（HPWL）、基于图的最小生成树（MST）和真正最优的直线斯坦纳最小树（RSMT）。通过为一个简单的网络计算并比较这些值，您将对它们的准确性、计算复杂度和相互关系建立直观的认识 。",
            "id": "4289794",
            "problem": "考虑一个具有三个引脚的单一网络，其笛卡尔坐标（单位：微米）分别为：$p_{1}=(2,1)$、$p_{2}=(2,5)$ 和 $p_{3}=(9,3)$。假设所有互连均为直线（曼哈顿）形式，且布线仅限于水平和垂直段。使用标准的布局线长指标：\n\n- 通过考虑包围所有引脚的边界框，计算该网络的半周长线长 (HPWL)。\n- 在连接三个引脚的直线（曼哈顿）度量下，计算最小生成树 (MST) 的长度。\n- 使用适用于 $n=3$ 个引脚的、基于快速查找表的直线斯坦纳近似（类似 FLUTE）方法，计算直线斯坦纳最小树 (RSMT) 的长度。该方法在 Hanan 网格上确定一个最优斯坦纳点。\n- 提供有序三元组 $(\\text{HPWL}, \\text{MST}, \\text{RSMT})$，并对这三个量进行定量比较。\n\n所有三个长度均以微米表示。如果选择四舍五入，请将最终值保留到四位有效数字。",
            "solution": "该问题要求计算和比较一个具有三个引脚的单一网络的三个标准线长指标。引脚坐标（单位：微米）为 $p_1=(2,1)$、$p_2=(2,5)$ 和 $p_3=(9,3)$。布线是直线的，意味着所有互连都由水平和垂直段组成。距离度量是曼哈顿距离，对于两个点 $p_i=(x_i, y_i)$ 和 $p_j=(x_j, y_j)$，其定义为 $d(p_i, p_j) = |x_i - x_j| + |y_i - y_j|$。\n\n**1. 半周长线长 (HPWL)**\n\n半周长线长 (HPWL) 是一种广泛使用的线长估算方法，其计算方式为包围网络所有引脚的最小轴对齐边界框的半周长。\n\n首先，我们从引脚集合 $P = \\{p_1, p_2, p_3\\}$ 中找出 x 和 y 坐标的最小值和最大值。\n引脚的 x 坐标为 $\\{2, 2, 9\\}$。\n引脚的 y 坐标为 $\\{1, 5, 3\\}$。\n\n极值坐标为：\n$$x_{\\min} = \\min(2, 2, 9) = 2$$\n$$x_{\\max} = \\max(2, 2, 9) = 9$$\n$$y_{\\min} = \\min(1, 5, 3) = 1$$\n$$y_{\\max} = \\max(1, 5, 3) = 5$$\n\n边界框的宽度是 x 坐标的跨度，即 $W = x_{\\max} - x_{\\min} = 9 - 2 = 7 \\, \\mu m$。\n边界框的高度是 y 坐标的跨度，即 $H = y_{\\max} - y_{\\min} = 5 - 1 = 4 \\, \\mu m$。\n\nHPWL 是宽度和高度之和：\n$$\\text{HPWL} = W + H = (x_{\\max} - x_{\\min}) + (y_{\\max} - y_{\\min})$$\n$$\\text{HPWL} = 7 + 4 = 11 \\, \\mu m$$\n\n**2. 最小生成树 (MST) 长度**\n\n最小生成树 (MST) 以可能的最小总线长连接所有引脚，仅使用引脚之间的边，而不添加任何新的中间点。该问题等效于在一个以引脚为顶点、以曼哈顿距离为边权重的完全图中寻找 MST。\n\n我们计算每对引脚之间的曼哈顿距离：\n-   $p_1=(2,1)$ 和 $p_2=(2,5)$ 之间的距离：\n    $$d(p_1, p_2) = |2-2| + |1-5| = 0 + 4 = 4$$\n-   $p_1=(2,1)$ 和 $p_3=(9,3)$ 之间的距离：\n    $$d(p_1, p_3) = |2-9| + |1-3| = 7 + 2 = 9$$\n-   $p_2=(2,5)$ 和 $p_3=(9,3)$ 之间的距离：\n    $$d(p_2, p_3) = |2-9| + |5-3| = 7 + 2 = 9$$\n\n边权重的集合是 $\\{4, 9, 9\\}$。要在 3 个顶点上构建一个 MST，我们必须选择权重最小且不形成环的两条边（$3-1=2$）。应用 Kruskal 算法：\n1.  选择权重最小的边，即 $(p_1, p_2)$，长度为 4。\n2.  选择次小权重的边。这里存在权重相同的边，$(p_1, p_3)$ 和 $(p_2, p_3)$ 的长度均为 9。选择其中任意一条都可以将最后一个引脚 $p_3$ 连接到现有网络。例如，选择 $(p_1, p_3)$ 会得到树边 $(p_1, p_2)$ 和 $(p_1, p_3)$。\n\nMST 的总长度是所选边权重之和：\n$$\\text{MST} = d(p_1, p_2) + d(p_1, p_3) = 4 + 9 = 13 \\, \\mu m$$\n\n**3. 直线斯坦纳最小树 (RSMT) 长度**\n\n直线斯坦纳最小树 (RSMT) 是连接所有引脚的最短直线网络。它可能会引入新的连接点，称为斯坦纳点 (Steiner points)，以减少总长度。对于一个引脚集合，RSMT 的最优斯坦纳点位于 Hanan 网格上，该网格由穿过每个引脚的水平线和垂直线构成。\n\n对于一个有 $n=3$ 个引脚的网络，RSMT 最多有一个最优斯坦纳点 $s = (x_s, y_s)$，其坐标是引脚坐标的中位数。\nx 坐标的集合是 $\\{2, 2, 9\\}$。中位数是 $x_s = 2$。\ny 坐标的集合是 $\\{1, 3, 5\\}$（排序后）。中位数是 $y_s = 3$。\n因此，最优斯坦纳点是 $s=(2,3)$。\n\n生成的斯坦纳树的几何结构是通过将三个引脚连接到此斯坦纳点而形成的。从 $s$ 到每个引脚的直线路径的并集构成了这棵树。\n-   从 $p_1=(2,1)$ 到 $s=(2,3)$ 的路径和从 $p_2=(2,5)$ 到 $s=(2,3)$ 的路径合并成一条位于直线 $x=2$ 上的垂直干线，其范围从 $y=1$ 延伸到 $y=5$。该干线的长度为 $|5-1|=4$。\n-   从 $p_3=(9,3)$ 到 $s=(2,3)$ 的路径是一条位于直线 $y=3$ 上的水平分支，其范围从 $x=2$ 延伸到 $x=9$。该分支的长度为 $|9-2|=7$。\nRSMT 的总长度是这两个正交线段的长度之和：\n$$\\text{RSMT} = 4 + 7 = 11 \\, \\mu m$$\n\n一个已知的定理指出，对于引脚数 $n \\le 3$ 的网络，HPWL 是 RSMT 长度的精确计算。我们的结果 $\\text{HPWL}=11$ 和 $\\text{RSMT}=11$ 与该定理一致。\n\n**4. 总结与定量比较**\n\n计算出的线长为：\n-   $\\text{HPWL} = 11 \\, \\mu m$\n-   $\\text{MST} = 13 \\, \\mu m$\n-   $\\text{RSMT} = 11 \\, \\mu m$\n\n有序三元组 $(\\text{HPWL}, \\text{MST}, \\text{RSMT})$ 是 $(11, 13, 11)$。\n\n在线长估算中，一个关键的关系是 $\\text{RSMT} \\le \\text{MST}$。RSMT 代表了真实的最小线长，而 MST 提供了一个计算上简单的上界。在我们的例子中，$\\text{RSMT} = 11 \\, \\mu m$ 而 $\\text{MST} = 13 \\, \\mu m$。引入一个斯坦纳点带来了 $2 \\, \\mu m$ 的长度缩减，这相对于 MST 长度而言是 $15.4\\%$ 的改进 $(\\frac{13-11}{13} \\approx 0.154)$。比率 $\\frac{\\text{MST}}{\\text{RSMT}} = \\frac{13}{11} \\approx 1.1818$，这完全在直线斯坦纳比的理论最大值 $\\frac{3}{2}=1.5$ 的范围内。HPWL 指标在计算上最简单，在 $n=3$ 个引脚的情况下，它为 RSMT 提供了精确值。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n11  13  11\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理解了如何衡量线长之后，下一步自然是将其最小化。本练习将深入探讨二次布局，这是一种经典且强大的分析技术。您将看到一个看似复杂的几何优化问题如何转化为一个可解的线性方程组，从而为二次线长目标函数找到全局最优解 。",
            "id": "4289739",
            "problem": "考虑一个用于集成电路（IC）布局的电子设计自动化（EDA）中的二次布局模型，其中网表由一个带权无向图表示，权重为 $w_{ij}$，且输入/输出（IO）引脚的坐标是固定的。设二次线长（quadratic wirelength）度量定义在无向边集合上，其形式为\n$$\nE \\;=\\; \\sum_{(i,j)\\in \\mathcal{E}} w_{ij}\\left[(x_i - x_j)^{2} + (y_i - y_j)^{2}\\right],\n$$\n其中 $(x_i,y_i)$ 是节点 $i$ 的坐标，求和时每条无向边只计算一次。\n\n设顶点集为 $\\mathcal{V} = \\{1,2,3,4,5\\}$，其中内部（自由）节点为 $\\{1,2,3\\}$，固定 IO 节点为 $\\{4,5\\}$。固定的 IO 坐标为：\n- 节点 $4$：$(x_4,y_4) = (0,0)$，\n- 节点 $5$：$(x_5,y_5) = (8,4)$。\n\n无向边及其对称权重 $w_{ij} = w_{ji}$ 如下：\n- 边 $(1,4)$，权重 $w_{14} = 2$，\n- 边 $(1,2)$，权重 $w_{12} = 1$，\n- 边 $(1,3)$，权重 $w_{13} = 1$，\n- 边 $(2,3)$，权重 $w_{23} = 1$，\n- 边 $(2,5)$，权重 $w_{25} = 1$，\n- 边 $(3,5)$，权重 $w_{35} = 2$。\n\n仅从给定的二次线长定义出发，并利用自由坐标上的最小值点满足通过对内部节点的 $(x_i,y_i)$ 求导得到的一阶最优性条件的原理，完成以下任务：\n\n- 推导出自由节点坐标必须满足的线性系统，并构建内部系数矩阵以及考虑了固定 IO 贡献的右侧项。\n- 使用您选择的直接法（例如，Gaussian elimination）求解该线性系统，得到 $(x_1,y_1)$、$(x_2,y_2)$ 和 $(x_3,y_3)$。\n- 计算最终的二次线长 $E$。\n\n只需报告 $E$ 的最终值，以一个精确的实数表示。如果选择化简为单个分数，请表示为最简分数。无需四舍五入，也无需报告单位。",
            "solution": "用户希望解决一个二次布局问题，该问题涉及最小化二次线长度量，以确定电路布局中自由节点的最优坐标。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n\n- **目标函数：** 需要最小化的二次线长为 $E = \\sum_{(i,j)\\in \\mathcal{E}} w_{ij}\\left[(x_i - x_j)^{2} + (y_i - y_j)^{2}\\right]$。\n- **顶点集：** $\\mathcal{V} = \\{1,2,3,4,5\\}$。\n- **内部（自由）节点：** $\\mathcal{F} = \\{1,2,3\\}$。其坐标 $(x_1,y_1), (x_2,y_2), (x_3,y_3)$ 待定。\n- **固定（IO）节点：** $\\mathcal{P} = \\{4,5\\}$。\n- **固定坐标：**\n  - 节点 $4$：$(x_4,y_4) = (0,0)$。\n  - 节点 $5$：$(x_5,y_5) = (8,4)$。\n- **边集 $\\mathcal{E}$ 和权重 $w_{ij}$：**\n  - $w_{14} = 2$。\n  - $w_{12} = 1$。\n  - $w_{13} = 1$。\n  - $w_{23} = 1$。\n  - $w_{25} = 1$。\n  - $w_{35} = 2$。\n  所有其他未列出边的权重 $w_{ij}$ 均为 0。权重是对称的，$w_{ij}=w_{ji}$。\n\n**1.2. 使用提取的已知条件进行验证**\n\n- **科学依据：** 该问题描述了二次布局，这是超大规模集成（VLSI）电路设计的电子设计自动化（EDA）领域中一种标准且基础的技术。使用二次目标函数并通过求解由一阶最优性条件导出的一阶线性系统来最小化该函数，是基于微积分和线性代数的核心、成熟方法。该方法在科学上是合理的。\n- **适定性：** 该问题指定了一个要最小化的凸二次目标函数。由于自由节点与固定节点之间存在连接，这确保了相应的线性系统具有唯一且稳定的解。所有必要数据（图结构、权重、固定坐标）均已提供。该问题是适定的。\n- **客观性：** 该问题使用精确的数学定义和数值进行陈述，没有任何主观或模糊的语言。\n\n**1.3. 结论与行动**\n\n该问题是有效的，因为它具有科学依据、适定、客观且完整。可以着手求解。\n\n### 步骤 2：推导与求解\n\n总线长 $E$ 可以分解为两个独立的求和项，一项针对 x 坐标（$E_x$），另一项针对 y 坐标（$E_y$）：\n$$ E_x = \\sum_{(i,j)\\in \\mathcal{E}} w_{ij}(x_i - x_j)^2 $$\n$$ E_y = \\sum_{(i,j)\\in \\mathcal{E}} w_{ij}(y_i - y_j)^2 $$\n$$ E = E_x + E_y $$\n为了找到最小化 $E$ 的坐标 $(x_1, x_2, x_3)$ 和 $(y_1, y_2, y_3)$，我们必须满足一阶最优性条件。这意味着将 $E$ 对每个自由坐标的偏导数设为零。由于 $E_x$ 仅依赖于 x 坐标，$E_y$ 仅依赖于 y 坐标，我们可以对每个维度独立求解。\n\n**2.1. x 坐标的方程组**\n\nx 坐标的最优性条件是，对于每个自由节点 $k \\in \\{1,2,3\\}$，都有 $\\frac{\\partial E_x}{\\partial x_k} = 0$。偏导数的一般形式是：\n$$ \\frac{\\partial E_x}{\\partial x_k} = \\frac{\\partial}{\\partial x_k} \\sum_{(i,j)\\in \\mathcal{E}} w_{ij}(x_i - x_j)^2 = \\sum_{j \\text{ s.t. } (k,j)\\in\\mathcal{E}} 2 w_{kj}(x_k - x_j) = 0 $$\n这可以简化为：\n$$ \\left(\\sum_{j \\text{ s.t. } (k,j)\\in\\mathcal{E}} w_{kj}\\right)x_k - \\sum_{j \\text{ s.t. } (k,j)\\in\\mathcal{E}} w_{kj}x_j = 0 $$\n我们将此应用于每个自由节点：\n- 对于 $k=1$：邻居节点是 $\\{2,3,4\\}$。\n  $ (w_{12}+w_{13}+w_{14})x_1 - w_{12}x_2 - w_{13}x_3 = w_{14}x_4 $\n  $ (1+1+2)x_1 - 1 \\cdot x_2 - 1 \\cdot x_3 = 2 \\cdot x_4 \\implies 4x_1 - x_2 - x_3 = 2x_4 $\n- 对于 $k=2$：邻居节点是 $\\{1,3,5\\}$。\n  $ (w_{21}+w_{23}+w_{25})x_2 - w_{21}x_1 - w_{23}x_3 = w_{25}x_5 $\n  $ (1+1+1)x_2 - 1 \\cdot x_1 - 1 \\cdot x_3 = 1 \\cdot x_5 \\implies -x_1 + 3x_2 - x_3 = x_5 $\n- 对于 $k=3$：邻居节点是 $\\{1,2,5\\}$。\n  $ (w_{31}+w_{32}+w_{35})x_3 - w_{31}x_1 - w_{32}x_2 = w_{35}x_5 $\n  $ (1+1+2)x_3 - 1 \\cdot x_1 - 1 \\cdot x_2 = 2 \\cdot x_5 \\implies -x_1 - x_2 + 4x_3 = 2x_5 $\n\n代入固定坐标 $x_4=0$ 和 $x_5=8$：\n$$\n\\begin{cases}\n4x_1 - x_2 - x_3 = 2(0) = 0 \\\\\n-x_1 + 3x_2 - x_3 = 8 \\\\\n-x_1 - x_2 + 4x_3 = 2(8) = 16\n\\end{cases}\n$$\n写成矩阵形式，$A\\mathbf{x} = \\mathbf{b}_x$：\n$$\n\\begin{pmatrix} 4  -1  -1 \\\\ -1  3  -1 \\\\ -1  -1  4 \\end{pmatrix}\n\\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 8 \\\\ 16 \\end{pmatrix}\n$$\n内部系数矩阵为 $A = \\begin{pmatrix} 4  -1  -1 \\\\ -1  3  -1 \\\\ -1  -1  4 \\end{pmatrix}$，右侧项为 $\\mathbf{b}_x = \\begin{pmatrix} 0 \\\\ 8 \\\\ 16 \\end{pmatrix}$。\n\n**2.2. y 坐标的方程组**\n\ny 坐标的方程结构是相同的。线性系统为 $A\\mathbf{y} = \\mathbf{b}_y$。矩阵 $A$ 相同。右侧项 $\\mathbf{b}_y$ 使用固定的 y 坐标 $y_4=0$ 和 $y_5=4$ 构成：\n$$ \\mathbf{b}_y = \\begin{pmatrix} w_{14}y_4 \\\\ w_{25}y_5 \\\\ w_{35}y_5 \\end{pmatrix} = \\begin{pmatrix} 2(0) \\\\ 1(4) \\\\ 2(4) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 4 \\\\ 8 \\end{pmatrix} $$\n所以 y 的系统是：\n$$\n\\begin{pmatrix} 4  -1  -1 \\\\ -1  3  -1 \\\\ -1  -1  4 \\end{pmatrix}\n\\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 4 \\\\ 8 \\end{pmatrix}\n$$\n\n**2.3. 求解线性系统**\n\n我们使用 Gaussian elimination 方法求解 $\\mathbf{x}$ 的系统。其增广矩阵为：\n$$ \\left[ \\begin{array}{ccc|c} 4  -1  -1  0 \\\\ -1  3  -1  8 \\\\ -1  -1  4  16 \\end{array} \\right] $$\n执行行变换：$R_2 \\to 4R_2 + R_1$ 和 $R_3 \\to 4R_3 + R_1$。\n$$ \\left[ \\begin{array}{ccc|c} 4  -1  -1  0 \\\\ 0  11  -5  32 \\\\ 0  -5  15  64 \\end{array} \\right] $$\n执行行变换：$R_3 \\to 11R_3 + 5R_2$。\n$$ \\left[ \\begin{array}{ccc|c} 4  -1  -1  0 \\\\ 0  11  -5  32 \\\\ 0  0  140  864 \\end{array} \\right] $$\n使用回代法求解：\n$140x_3 = 864 \\implies x_3 = \\frac{864}{140} = \\frac{216}{35}$。\n$11x_2 - 5x_3 = 32 \\implies 11x_2 = 32 + 5(\\frac{216}{35}) = 32 + \\frac{216}{7} = \\frac{224+216}{7} = \\frac{440}{7} \\implies x_2 = \\frac{40}{7}$。\n$4x_1 - x_2 - x_3 = 0 \\implies 4x_1 = x_2 + x_3 = \\frac{40}{7} + \\frac{216}{35} = \\frac{200+216}{35} = \\frac{416}{35} \\implies x_1 = \\frac{104}{35}$。\n所以，$(x_1, x_2, x_3) = (\\frac{104}{35}, \\frac{40}{7}, \\frac{216}{35})$。\n\n对于 y 坐标，我们观察到 $\\mathbf{b}_y = \\frac{1}{2}\\mathbf{b}_x$。由于系统的线性性，解将是 $\\mathbf{y} = \\frac{1}{2}\\mathbf{x}$。\n$(y_1, y_2, y_3) = (\\frac{1}{2}\\frac{104}{35}, \\frac{1}{2}\\frac{40}{7}, \\frac{1}{2}\\frac{216}{35}) = (\\frac{52}{35}, \\frac{20}{7}, \\frac{108}{35})$。\n\n**2.4. 计算最终线长 E**\n\n最小值点的线长值可以计算出来。我们可以证明 $E_x = \\sum_{i \\in \\text{fixed}} x_i \\sum_{j \\text{ s.t. } (i,j)\\in\\mathcal{E}} w_{ij}(x_i-x_j)$。\n固定节点是 $4$ 和 $5$。节点 $4$ 连接到 $1$，节点 $5$ 连接到 $2$ 和 $3$。\n$$ E_x = x_4 \\cdot w_{41}(x_4 - x_1) + x_5 \\cdot \\left[ w_{52}(x_5-x_2) + w_{53}(x_5-x_3) \\right] $$\n当 $x_4=0$ 且 $x_5=8$ 时：\n$$ E_x = 0 + 8 \\cdot \\left[ 1(8-x_2) + 2(8-x_3) \\right] = 8 \\cdot (8 - x_2 + 16 - 2x_3) = 8 \\cdot (24 - x_2 - 2x_3) $$\n代入 $x_2$ 和 $x_3$ 的值：\n$$ E_x = 8 \\left( 24 - \\frac{40}{7} - 2\\frac{216}{35} \\right) = 8 \\left( \\frac{24 \\cdot 35}{35} - \\frac{40 \\cdot 5}{35} - \\frac{432}{35} \\right) $$\n$$ E_x = 8 \\left( \\frac{840 - 200 - 432}{35} \\right) = 8 \\left( \\frac{208}{35} \\right) = \\frac{1664}{35} $$\n类似地，对于 $E_y$，当 $y_4=0$ 且 $y_5=4$ 时：\n$$ E_y = 0 + 4 \\cdot \\left[ 1(4-y_2) + 2(4-y_3) \\right] = 4 \\cdot (12 - y_2 - 2y_3) $$\n代入 $y_2$ 和 $y_3$ 的值：\n$$ E_y = 4 \\left( 12 - \\frac{20}{7} - 2\\frac{108}{35} \\right) = 4 \\left( \\frac{12 \\cdot 35}{35} - \\frac{20 \\cdot 5}{35} - \\frac{216}{35} \\right) $$\n$$ E_y = 4 \\left( \\frac{420 - 100 - 216}{35} \\right) = 4 \\left( \\frac{104}{35} \\right) = \\frac{416}{35} $$\n总二次线长是两者之和：\n$$ E = E_x + E_y = \\frac{1664}{35} + \\frac{416}{35} = \\frac{2080}{35} $$\n将分子和分母除以它们的最大公约数 $5$ 来化简分数：\n$$ E = \\frac{2080 \\div 5}{35 \\div 5} = \\frac{416}{7} $$\n该分数为不可约分数，因为 $416 = 2^5 \\cdot 13$。",
            "answer": "$$\n\\boxed{\\frac{416}{7}}\n$$"
        },
        {
            "introduction": "现实世界中的芯片布局不仅仅是最小化线长；我们还必须防止单元过度聚集，以确保可布线性。本练习引入了一个多目标优化场景，将一个平滑的线长成本与一个基于单元密度的惩罚项相结合。通过执行一步梯度下降，您将亲身体验布局算法如何在连通性（线长）和物理空间（密度）这一基本权衡之间进行导航 。",
            "id": "4289534",
            "problem": "考虑集成电路电子设计自动化（EDA）中的一个解析布局子问题。两个一维标准单元，其位置分别为 $x_1$ 和 $x_2$（单位为微米），由单个网络连接。布局目标包括一个线长项和一个密度项。线长项被表述为引脚绝对距离的光滑替代函数，密度项则利用单元面积到区间的光滑高斯分配来惩罚区间溢出。\n\n使用以下定义和参数：\n\n- 软绝对值线长替代函数：对于 $\\Delta = x_1 - x_2$ 和平滑参数 $\\alpha$，定义\n$$\nW(x_1, x_2) = \\alpha \\ln\\!\\big(2 \\cosh(\\Delta/\\alpha)\\big).\n$$\n\n- 两个区间，中心分别为 $c_1$ 和 $c_2$，容量为 $C_b$。每个单元的面积为 $A_i$。归一化区间占用率为\n$$\nr_b(x_1, x_2) = \\frac{1}{C_b}\\sum_{i=1}^{2} A_i \\exp\\!\\left(-\\frac{(x_i - c_b)^2}{2 h^2}\\right),\n$$\n其中高斯核宽度为 $h$。密度惩罚项为\n$$\nD(x_1, x_2) = \\frac{1}{2}\\sum_{b=1}^{2}\\big(r_b(x_1, x_2) - r^\\star\\big)^2,\n$$\n其中 $r^\\star$ 是目标占用率。\n\n- 组合目标函数为\n$$\nF(x_1, x_2) = w_{\\mathrm{wl}}\\, W(x_1, x_2) + w_{\\mathrm{den}}\\, D(x_1, x_2),\n$$\n其中 $w_{\\mathrm{wl}}$ 的单位是逆微米，以使 $F$ 无量纲，而 $w_{\\mathrm{den}}$ 是无量纲的。\n\n给定参数\n- 初始位置 $x_1^{(0)} = 2$ 和 $x_2^{(0)} = 8$ 微米，\n- $\\alpha = 0.5$ 微米，\n- $c_1 = 3$ 和 $c_2 = 7$ 微米，\n- $h = 1$ 微米，\n- $A_1 = A_2 = 1$ 平方微米，\n- $C_b = 1$ 平方微米，\n- $r^\\star = 0.65$，\n- $w_{\\mathrm{wl}} = 0.3$ 逆微米，\n- $w_{\\mathrm{den}} = 0.7$，\n- 梯度下降步长 $\\eta = 0.1$ 平方微米，\n\n执行以下任务：\n1. 使用上述定义计算组合目标函数值 $F(x_1^{(0)}, x_2^{(0)})$。\n2. 从第一性原理计算关于 $(x_1, x_2)$ 的梯度 $\\nabla F(x_1^{(0)}, x_2^{(0)})$，并执行一步显式梯度下降\n$$\n\\begin{pmatrix}\nx_1^{(1)} \\\\\nx_2^{(1)}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nx_1^{(0)} \\\\\nx_2^{(0)}\n\\end{pmatrix}\n-\\eta \\, \\nabla F(x_1^{(0)}, x_2^{(0)}).\n$$\n\n以微米为单位表示最终更新后的位置。将最终数值答案四舍五入到四位有效数字。",
            "solution": "首先验证该问题，以确保其具有科学依据、良态且客观。所给的问题陈述是电子设计自动化（EDA）中解析布局子问题的标准表述，使用了光滑的线长替代函数和基于高斯函数的密度模型。所有参数都给出了统一的单位，且函数定义明确、可微。因此，该问题被认为是有效的。我们继续进行求解，求解过程包括两个任务：计算初始目标函数值和执行一步梯度下降。\n\n给定参数如下：\n-   初始位置：$x_1^{(0)} = 2$， $x_2^{(0)} = 8$\n-   平滑参数：$\\alpha = 0.5$\n-   区间中心：$c_1 = 3$， $c_2 = 7$\n-   高斯核宽度：$h = 1$\n-   单元面积：$A_1 = 1$， $A_2 = 1$\n-   区间容量：$C_b = 1$\n-   目标占用率：$r^\\star = 0.65$\n-   权重：$w_{\\mathrm{wl}} = 0.3$， $w_{\\mathrm{den}} = 0.7$\n-   步长：$\\eta = 0.1$\n\n所有长度和位置单位均为微米（$\\mu$m），面积单位为 $\\mu$m$^2$，$w_{\\mathrm{wl}}$ 的单位为 $\\mu$m$^{-1}$，$\\eta$ 的单位为 $\\mu$m$^2$。目标函数 $F$ 是无量纲的。\n\n**任务1：计算组合目标函数值 $F(x_1^{(0)}, x_2^{(0)})$。**\n\n首先，我们计算线长项 $W(x_1, x_2) = \\alpha \\ln(2 \\cosh((x_1 - x_2)/\\alpha))$。\n在初始位置，$\\Delta^{(0)} = x_1^{(0)} - x_2^{(0)} = 2 - 8 = -6$。\n双曲余弦函数的参数是 $\\Delta^{(0)}/\\alpha = -6 / 0.5 = -12$。\n$$\nW(x_1^{(0)}, x_2^{(0)}) = 0.5 \\ln(2 \\cosh(-12)) = 0.5 \\ln(2 \\cosh(12))\n$$\n因为 $\\cosh(z) = (e^z + e^{-z})/2$，对于大的 $z$，$\\cosh(z) \\approx e^z/2$。因此，$2\\cosh(12) \\approx e^{12}$，并且 $\\ln(2\\cosh(12)) \\approx 12$。线长项约等于 $|\\Delta^{(0)}|=6$。\n更精确地， $2\\cosh(12) \\approx 162754.79$，且 $\\ln(162754.79) \\approx 11.9999939$。\n$$\nW^{(0)} = W(x_1^{(0)}, x_2^{(0)}) = 0.5 \\times 11.9999939 = 5.99999695\n$$\n\n接下来，我们计算密度项 $D(x_1, x_2) = \\frac{1}{2}\\sum_{b=1}^{2}(r_b(x_1, x_2) - r^\\star)^2$。这需要计算区间占用率 $r_b(x_1, x_2) = \\frac{1}{C_b}\\sum_{i=1}^{2} A_i \\exp(-\\frac{(x_i - c_b)^2}{2 h^2})$。\n当 $A_1=A_2=1$，$C_b=1$ 且 $h=1$ 时，公式简化为 $r_b(x_1, x_2) = \\sum_{i=1}^{2} \\exp(-\\frac{(x_i - c_b)^2}{2})$。\n\n对于中心为 $c_1=3$ 的区间 $b=1$：\n$$\nr_1^{(0)} = r_1(2, 8) = \\exp\\left(-\\frac{(2 - 3)^2}{2}\\right) + \\exp\\left(-\\frac{(8 - 3)^2}{2}\\right) = \\exp(-0.5) + \\exp(-12.5)\n$$\n$$\nr_1^{(0)} \\approx 0.60653066 + 0.00000373 \\approx 0.60653439\n$$\n对于中心为 $c_2=7$ 的区间 $b=2$：\n$$\nr_2^{(0)} = r_2(2, 8) = \\exp\\left(-\\frac{(2 - 7)^2}{2}\\right) + \\exp\\left(-\\frac{(8 - 7)^2}{2}\\right) = \\exp(-12.5) + \\exp(-0.5)\n$$\n$$\nr_2^{(0)} \\approx 0.00000373 + 0.60653066 \\approx 0.60653439\n$$\n现在，我们用 $r^\\star=0.65$ 计算密度惩罚项 $D^{(0)}$：\n$$\nD^{(0)} = D(2, 8) = \\frac{1}{2}\\left[ (0.60653439 - 0.65)^2 + (0.60653439 - 0.65)^2 \\right]\n$$\n$$\nD^{(0)} = (0.60653439 - 0.65)^2 = (-0.04346561)^2 \\approx 0.00188926\n$$\n\n最后，我们计算总目标函数值 $F^{(0)}$：\n$$\nF^{(0)} = F(2, 8) = w_{\\mathrm{wl}} W^{(0)} + w_{\\mathrm{den}} D^{(0)} = 0.3 \\times 5.99999695 + 0.7 \\times 0.00188926\n$$\n$$\nF^{(0)} \\approx 1.79999909 + 0.00132248 = 1.80132157\n$$\n\n**任务2：计算梯度 $\\nabla F(x_1^{(0)}, x_2^{(0)})$ 并执行一步梯度下降。**\n\n首先，我们求线长项的梯度 $\\nabla W$。令 $\\Delta = x_1 - x_2$。\n$$\n\\frac{\\partial W}{\\partial x_1} = \\frac{\\partial}{\\partial x_1} \\left[ \\alpha \\ln(2 \\cosh(\\Delta/\\alpha)) \\right] = \\alpha \\frac{1}{2 \\cosh(\\Delta/\\alpha)} \\cdot 2 \\sinh(\\Delta/\\alpha) \\cdot \\frac{1}{\\alpha} = \\tanh(\\Delta/\\alpha)\n$$\n$$\n\\frac{\\partial W}{\\partial x_2} = \\frac{\\partial}{\\partial x_2} \\left[ \\alpha \\ln(2 \\cosh(\\Delta/\\alpha)) \\right] = \\alpha \\frac{1}{2 \\cosh(\\Delta/\\alpha)} \\cdot 2 \\sinh(\\Delta/\\alpha) \\cdot \\left(-\\frac{1}{\\alpha}\\right) = -\\tanh(\\Delta/\\alpha)\n$$\n接下来，我们求密度项的梯度 $\\nabla D$。\n$$\n\\frac{\\partial D}{\\partial x_i} = \\sum_{b=1}^{2} (r_b - r^\\star) \\frac{\\partial r_b}{\\partial x_i}\n$$\n$r_b$ 关于 $x_i$ 的偏导数为：\n$$\n\\frac{\\partial r_b}{\\partial x_i} = \\frac{\\partial}{\\partial x_i} \\left[ \\frac{1}{C_b} \\sum_{j=1}^{2} A_j \\exp\\left(-\\frac{(x_j - c_b)^2}{2 h^2}\\right) \\right] = \\frac{A_i}{C_b} \\exp\\left(-\\frac{(x_i - c_b)^2}{2 h^2}\\right) \\cdot \\left(-\\frac{2(x_i - c_b)}{2 h^2}\\right)\n$$\n$$\n\\frac{\\partial r_b}{\\partial x_i} = -\\frac{A_i(x_i - c_b)}{C_b h^2} \\exp\\left(-\\frac{(x_i - c_b)^2}{2 h^2}\\right)\n$$\n目标函数的完整梯度为 $\\nabla F(x_1, x_2) = w_{\\mathrm{wl}} \\nabla W(x_1, x_2) + w_{\\mathrm{den}} \\nabla D(x_1, x_2)$。\n\n现在，我们在点 $(x_1^{(0)}, x_2^{(0)}) = (2, 8)$ 处计算梯度：\n对于线长部分，其中 $\\Delta^{(0)}/\\alpha = -12$：\n$$\n\\frac{\\partial W}{\\partial x_1}\\bigg|_{(x_1^{(0)}, x_2^{(0)})} = \\tanh(-12) \\approx -0.999999999925\n$$\n$$\n\\frac{\\partial W}{\\partial x_2}\\bigg|_{(x_1^{(0)}, x_2^{(0)})} = -\\tanh(-12) \\approx 0.999999999925\n$$\n对于密度部分，使用 $A_i=1, C_b=1, h=1$：\n$$ \\frac{\\partial D}{\\partial x_i}\\bigg|_{(0)} = - \\sum_{b=1}^{2} (r_b^{(0)} - r^\\star) (x_i^{(0)} - c_b) \\exp\\left(-\\frac{(x_i^{(0)} - c_b)^2}{2}\\right) $$\n其中 $r_1^{(0)} - r^\\star = r_2^{(0)} - r^\\star \\approx -0.04346561$，我们称之为 $\\delta r$。\n对于 $x_1$：\n$$\n\\frac{\\partial D}{\\partial x_1}\\bigg|_{(0)} \\approx -(\\delta r) \\left[ (2-3)\\exp\\left(-\\frac{(2-3)^2}{2}\\right) + (2-7)\\exp\\left(-\\frac{(2-7)^2}{2}\\right) \\right]\n$$\n$$\n\\frac{\\partial D}{\\partial x_1}\\bigg|_{(0)} \\approx -(-0.04346561) \\left[ (-1)\\exp(-0.5) + (-5)\\exp(-12.5) \\right]\n$$\n$$\n\\frac{\\partial D}{\\partial x_1}\\bigg|_{(0)} \\approx 0.04346561 [ -0.60653066 - 0.00001863 ] = 0.04346561 \\times (-0.60654929) \\approx -0.026369\n$$\n对于 $x_2$：\n$$\n\\frac{\\partial D}{\\partial x_2}\\bigg|_{(0)} \\approx -(\\delta r) \\left[ (8-3)\\exp\\left(-\\frac{(8-3)^2}{2}\\right) + (8-7)\\exp\\left(-\\frac{(8-7)^2}{2}\\right) \\right]\n$$\n$$\n\\frac{\\partial D}{\\partial x_2}\\bigg|_{(0)} \\approx -(-0.04346561) \\left[ (5)\\exp(-12.5) + (1)\\exp(-0.5) \\right]\n$$\n$$\n\\frac{\\partial D}{\\partial x_2}\\bigg|_{(0)} \\approx 0.04346561 [ 0.00001863 + 0.60653066 ] = 0.04346561 \\times (0.60654929) \\approx 0.026369\n$$\n现在，组合起来求 $\\nabla F$：\n$$\n\\frac{\\partial F}{\\partial x_1}\\bigg|_{(0)} \\approx 0.3 \\times (-1.0) + 0.7 \\times (-0.026369) = -0.3 - 0.0184583 = -0.3184583\n$$\n$$\n\\frac{\\partial F}{\\partial x_2}\\bigg|_{(0)} \\approx 0.3 \\times (1.0) + 0.7 \\times (0.026369) = 0.3 + 0.0184583 = 0.3184583\n$$\n梯度为 $\\nabla F(2, 8) \\approx \\begin{pmatrix} -0.3184583 \\\\ 0.3184583 \\end{pmatrix}$。\n\n最后，使用步长 $\\eta=0.1$ 执行一步梯度下降：\n$$\n\\begin{pmatrix} x_1^{(1)} \\\\ x_2^{(1)} \\end{pmatrix} = \\begin{pmatrix} x_1^{(0)} \\\\ x_2^{(0)} \\end{pmatrix} - \\eta \\nabla F(x_1^{(0)}, x_2^{(0)})\n$$\n$$\nx_1^{(1)} = 2 - 0.1 \\times (-0.3184583) = 2 + 0.03184583 = 2.03184583\n$$\n$$\nx_2^{(1)} = 8 - 0.1 \\times (0.3184583) = 8 - 0.03184583 = 7.96815417\n$$\n将最终结果四舍五入到四位有效数字：\n$x_1^{(1)} \\approx 2.032$\n$x_2^{(1)} \\approx 7.968$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.032  7.968\n\\end{pmatrix}\n}\n$$"
        }
    ]
}