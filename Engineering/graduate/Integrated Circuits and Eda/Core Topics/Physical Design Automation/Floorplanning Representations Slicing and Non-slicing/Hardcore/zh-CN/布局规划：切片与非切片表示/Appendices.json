{
    "hands_on_practices": [
        {
            "introduction": "波兰表达式为表示可切分树提供了一种紧凑的无括号符号。本练习将引导你将这种抽象的后序表达式解码为一个具体的几何布局，这是可视化和评估可切分布图的一项关键技能。通过这个练习，你将实践从表达式构建切分树，并自底向上计算尺寸、自顶向下确定坐标的过程 。",
            "id": "4272863",
            "problem": "考虑一个使用规范化波兰表达式的切割式布局表示。规范化波兰表达式是二叉切割树的后缀编码，其中操作数是模块标识符，操作符是切割指令。垂直切割操作符将左右子布局并排布置，水平切割操作符将底部和顶部子布局垂直堆叠。将以下规范化波兰表达式解码为其切割树，并用它来为硬矩形模块推导出一个具体的布局：\n$$M_1\\ M_2\\ V\\ M_3\\ H\\ M_4\\ M_5\\ V\\ H.$$\n每个模块 $M_i$ 是一个具有固定宽度和高度的硬模块：\n- $M_1$：宽度 $w_1=3$，高度 $h_1=2$，\n- $M_2$：宽度 $w_2=2$，高度 $h_2=3$，\n- $M_3$：宽度 $w_3=4$，高度 $h_3=1$，\n- $M_4$：宽度 $w_4=1$，高度 $h_4=5$，\n- $M_5$：宽度 $w_5=2$，高度 $h_5=2$。\n\n使用最终布局左下角作为原点，在每次切割操作时，通过将子布局与底部或左侧边缘对齐来放置子布局，这与垂直和水平切割的语义一致。演示规范化波兰表达式中操作符 $V$ 和 $H$ 的位置与切割树中推导出的子布局分区之间的对应关系。\n\n设总成本定义为\n$$C=\\alpha \\cdot A + \\beta \\cdot L,$$\n其中 $A$ 是布局的最终边界矩形的面积，$L$ 是总加权曼哈顿线长，其计算方法为：对所有连线，将连线权重乘以所连接模块中心之间的曼哈顿距离，然后求和。两点 $(x_a,y_a)$ 和 $(x_b,y_b)$ 之间的曼哈顿距离是 $|x_a-x_b|+|y_a-y_b|$。权重和双引脚连线如下：\n- $M_1$ 和 $M_2$ 之间，权重为 $1$，\n- $M_2$ 和 $M_3$ 之间，权重为 $2$，\n- $M_3$ 和 $M_4$ 之间，权重为 $3$，\n- $M_1$ 和 $M_5$ 之间，权重为 $1.5$。\n\n使用 $\\alpha=0.05$ 和 $\\beta=1$。为解码后的切割树和推导出的布局计算最终成本 $C$。将最终成本表示为一个无量纲值，并将答案四舍五入到四位有效数字。",
            "solution": "问题陈述已经过验证，被认为是合理、适定且完整的。我们进行分步解答。\n\n该问题要求解码一个规范化波兰表达式，以确定切割式布局中模块的几何位置，然后根据得到的面积和线长计算成本函数。\n\n### 步骤1：将规范化波兰表达式解码为切割树\n\n规范化波兰表达式表示二叉切割树的后序遍历。我们可以使用基于堆栈的算法来构建该树。待解析的表达式为 $$M_1\\ M_2\\ V\\ M_3\\ H\\ M_4\\ M_5\\ V\\ H.$$\n\n1.  **$M_1$**：将 $M_1$ 压入堆栈。堆栈：$[M_1]$。\n2.  **$M_2$**：将 $M_2$ 压入堆栈。堆栈：$[M_1, M_2]$。\n3.  **$V$**：弹出 $M_2$（右子节点）和 $M_1$（左子节点）。创建一个内部节点 $N_1 = V(M_1, M_2)$。将 $N_1$ 压入堆栈。堆栈：$[N_1]$。这个首个操作符 $V$ 对应于分割包含 $M_1$ 和 $M_2$ 的子布局的垂直切割。\n4.  **$M_3$**：将 $M_3$ 压入堆栈。堆栈：$[N_1, M_3]$。\n5.  **$H$**：弹出 $M_3$（上子节点）和 $N_1$（下子节点）。创建一个内部节点 $N_2 = H(N_1, M_3)$。将 $N_2$ 压入堆栈。堆栈：$[N_2]$。这个操作符 $H$ 对应于分割由 $N_1$ 和模块 $M_3$ 定义的子布局的水平切割。\n6.  **$M_4$**：将 $M_4$ 压入堆栈。堆栈：$[N_2, M_4]$。\n7.  **$M_5$**：将 $M_5$ 压入堆栈。堆栈：$[N_2, M_4, M_5]$。\n8.  **$V$**：弹出 $M_5$（右子节点）和 $M_4$（左子节点）。创建一个内部节点 $N_3 = V(M_4, M_5)$。将 $N_3$ 压入堆栈。堆栈：$[N_2, N_3]$。这个操作符 $V$ 对应于分割包含 $M_4$ 和 $M_5$ 的子布局的垂直切割。\n9.  **$H$**：弹出 $N_3$（上子节点）和 $N_2$（下子节点）。创建根节点 $R = H(N_2, N_3)$。将 $R$ 压入堆栈。堆栈：$[R]$。这个最后的操作符 $H$ 对应于将整个布局分割成两个主要子布局 $N_2$ 和 $N_3$ 的主水平切割。\n\n最终得到的切割树以 $R$ 为根，其结构为 $R = H(H(V(M_1, M_2), M_3), V(M_4, M_5))$。\n\n### 步骤2：计算边界框尺寸和模块坐标\n\n我们对切割树进行自底向上的遍历，以计算每个子布局的尺寸 $(w, h)$。设模块 $M_i$ 的尺寸为 $(w_i, h_i)$。\n对于垂直切割 $V(A, B)$，得到的尺寸为 $(w_A+w_B, \\max(h_A, h_B))$。\n对于水平切割 $H(A, B)$，得到的尺寸为 $(\\max(w_A, w_B), h_A+h_B)$。\n\n- **叶节点（模块）**：\n    - $M_1$: $(w_1, h_1) = (3, 2)$\n    - $M_2$: $(w_2, h_2) = (2, 3)$\n    - $M_3$: $(w_3, h_3) = (4, 1)$\n    - $M_4$: $(w_4, h_4) = (1, 5)$\n    - $M_5$: $(w_5, h_5) = (2, 2)$\n\n- **内部节点 $N_1 = V(M_1, M_2)$**：\n    - $w_{N1} = w_1 + w_2 = 3 + 2 = 5$\n    - $h_{N1} = \\max(h_1, h_2) = \\max(2, 3) = 3$\n\n- **内部节点 $N_2 = H(N_1, M_3)$**：\n    - $w_{N2} = \\max(w_{N1}, w_3) = \\max(5, 4) = 5$\n    - $h_{N2} = h_{N1} + h_3 = 3 + 1 = 4$\n\n- **内部节点 $N_3 = V(M_4, M_5)$**：\n    - $w_{N3} = w_4 + w_5 = 1 + 2 = 3$\n    - $h_{N3} = \\max(h_4, h_5) = \\max(5, 2) = 5$\n\n- **根节点 $R = H(N_2, N_3)$**：\n    - $W_{total} = w_R = \\max(w_{N2}, w_{N3}) = \\max(5, 3) = 5$\n    - $H_{total} = h_R = h_{N2} + h_{N3} = 4 + 5 = 9$\n\n最终布局的边界框宽度为 $5$，高度为 $9$。\n\n接下来，我们进行自顶向下的遍历，以确定每个模块左下角的绝对坐标 $(x, y)$，其中整个布局的左下角为原点 $(0,0)$。\n\n- **根节点 $R$**：放置在 $(0,0)$。\n- **$R = H(N_2, N_3)$ 的子节点**：\n    - $N_2$（底部）放置在 $(0,0)$。\n    - $N_3$（顶部）放置在 $(0, h_{N2}) = (0, 4)$。\n- **$N_2 = H(N_1, M_3)$ 的子节点**（相对于 $N_2$ 的原点 $(0,0)$）：\n    - $N_1$（底部）放置在 $(0,0)$。它的绝对坐标是 $(0,0)$。\n    - $M_3$（顶部）放置在 $(0, h_{N1}) = (0, 3)$。它的绝对坐标是 $(0,3)$。\n- **$N_1 = V(M_1, M_2)$ 的子节点**（相对于 $N_1$ 的原点 $(0,0)$）：\n    - $M_1$（左侧）放置在 $(0,0)$。它的绝对坐标是 $(0,0)$。\n    - $M_2$（右侧）放置在 $(w_1, 0) = (3, 0)$。它的绝对坐标是 $(3,0)$。\n- **$N_3 = V(M_4, M_5)$ 的子节点**（相对于 $N_3$ 的原点 $(0,4)$）：\n    - $M_4$（左侧）放置在 $(0,0)$（相对于 $N_3$）。它的绝对坐标是 $(0, 4)$。\n    - $M_5$（右侧）放置在 $(w_4, 0) = (1, 0)$（相对于 $N_3$）。它的绝对坐标是 $(0+1, 4+0) = (1, 4)$。\n\n模块布局总结（坐标 $(x_i, y_i)$ 和尺寸 $(w_i, h_i)$）：\n- $M_1$: $(x_1, y_1)=(0,0)$, $(w_1, h_1)=(3,2)$\n- $M_2$: $(x_2, y_2)=(3,0)$, $(w_2, h_2)=(2,3)$\n- $M_3$: $(x_3, y_3)=(0,3)$, $(w_3, h_3)=(4,1)$\n- $M_4$: $(x_4, y_4)=(0,4)$, $(w_4, h_4)=(1,5)$\n- $M_5$: $(x_5, y_5)=(1,4)$, $(w_5, h_5)=(2,2)$\n\n### 步骤3：计算总成本\n\n总成本为 $C=\\alpha \\cdot A + \\beta \\cdot L$，其中 $\\alpha=0.05$ 且 $\\beta=1$。\n\n**3.1. 面积计算**\n最终边界矩形的面积 $A$ 为：\n$$A = W_{total} \\times H_{total} = 5 \\times 9 = 45.$$\n\n**3.2. 线长计算**\n首先，我们计算每个模块的中心坐标 $(x_{ci}, y_{ci}) = (x_i + w_i/2, y_i + h_i/2)$：\n- $M_1$: $(x_{c1}, y_{c1}) = (0 + 3/2, 0 + 2/2) = (1.5, 1)$\n- $M_2$: $(x_{c2}, y_{c2}) = (3 + 2/2, 0 + 3/2) = (4, 1.5)$\n- $M_3$: $(x_{c3}, y_{c3}) = (0 + 4/2, 3 + 1/2) = (2, 3.5)$\n- $M_4$: $(x_{c4}, y_{c4}) = (0 + 1/2, 4 + 5/2) = (0.5, 6.5)$\n- $M_5$: $(x_{c5}, y_{c5}) = (1 + 2/2, 4 + 2/2) = (2, 5)$\n\n接下来，我们计算每条连线的加权曼哈顿线长：\n- **连线 $M_1-M_2$（权重 $1$）**：\n$L_{12} = 1 \\times (|x_{c1}-x_{c2}| + |y_{c1}-y_{c2}|) = 1 \\times (|1.5-4| + |1-1.5|) = 1 \\times (2.5 + 0.5) = 3$\n- **连线 $M_2-M_3$（权重 $2$）**：\n$L_{23} = 2 \\times (|x_{c2}-x_{c3}| + |y_{c2}-y_{c3}|) = 2 \\times (|4-2| + |1.5-3.5|) = 2 \\times (2 + 2) = 8$\n- **连线 $M_3-M_4$（权重 $3$）**：\n$L_{34} = 3 \\times (|x_{c3}-x_{c4}| + |y_{c3}-y_{c4}|) = 3 \\times (|2-0.5| + |3.5-6.5|) = 3 \\times (1.5 + 3) = 3 \\times 4.5 = 13.5$\n- **连线 $M_1-M_5$（权重 $1.5$）**：\n$L_{15} = 1.5 \\times (|x_{c1}-x_{c5}| + |y_{c1}-y_{c5}|) = 1.5 \\times (|1.5-2| + |1-5|) = 1.5 \\times (0.5 + 4) = 1.5 \\times 4.5 = 6.75$\n\n总线长 $L$ 是各个加权长度的总和：\n$$L = L_{12} + L_{23} + L_{34} + L_{15} = 3 + 8 + 13.5 + 6.75 = 31.25.$$\n\n**3.3. 最终成本计算**\n现在我们计算总成本 $C$：\n$$C = \\alpha \\cdot A + \\beta \\cdot L = (0.05 \\times 45) + (1 \\times 31.25)$$\n$$C = 2.25 + 31.25 = 33.5$$\n问题要求答案四舍五入到四位有效数字。值 $33.5$ 可以表示为 $33.50$ 以满足此要求。",
            "answer": "$$\\boxed{33.50}$$"
        },
        {
            "introduction": "与可切分布图相比，不可切分布图提供了更大的灵活性，但这需要一种更强大的表示方法，如序列对。本练习将重点介绍序列对方法，演示如何从两个模块序列中推导出几何约束（“左于”和“下于”），并利用约束图来确定最终的模块位置 。这个过程揭示了在电子设计自动化中基于图的算法在解决复杂空间关系问题时的核心作用。",
            "id": "4272827",
            "problem": "考虑电子设计自动化（EDA）中使用序列对表示的标准非切片布局规划（non-slicing floorplanning）公式。给定五个硬矩形模块 $\\{A,B,C,D,E\\}$，其宽度和高度固定（不允许旋转）。所有坐标均以微米为单位，且布局坐标系的原点位于左下角。对于任意两个分别具有左于（left-of）或下于（below-of）关系的模块，必须强制施加统一的最小水平间距 $s_{x}$ 和统一的最小垂直间距 $s_{y}$。序列对由有序序列 $\\pi^{+}$ 和 $\\pi^{-}$ 给出，其中 $\\pi^{+}=(C,A,E,B,D)$ 且 $\\pi^{-}=(A,C,B,D,E)$。模块尺寸和间距如下：\n- $w_{A}=30$, $h_{A}=20$; $w_{B}=25$, $h_{B}=35$; $w_{C}=40$, $h_{C}=15$; $w_{D}=20$, $h_{D}=30$; $w_{E}=15$, $h_{E}=25$。\n- $s_{x}=5$, $s_{y}=10$。\n\n从序列对的基本定义、导出的水平和垂直优先关系，以及相应约束图（作为有向无环图，即DAG）的构建出发，完成以下任务：\n1. 推导由序列对所隐含的左于（left-of）和下于（below-of）关系，并构建水平和垂直约束DAG。\n2. 在每个DAG上使用最长路径计算，并配合适当的节点权重（水平图使用模块宽度，垂直图使用模块高度，并加上所需间距），计算每个模块 $i \\in \\{A,B,C,D,E\\}$ 的紧凑布局坐标 $(x_{i},y_{i})$，该布局满足所有优先约束和间距要求。\n3. 计算轮廓宽度 $W=\\max_{i}(x_{i}+w_{i})$ 和轮廓高度 $H=\\max_{i}(y_{i}+h_{i})$，然后计算总轮廓面积 $A=W \\times H$。\n\n将最终面积 $A$ 以平方微米表示，并四舍五入到四位有效数字，使用科学记数法。最终答案必须是单个实数值。",
            "solution": "我们从非切片布局规划的序列对方法的基本定义开始。给定模块集合上的一个置换对 $(\\pi^{+},\\pi^{-})$，对于任意两个模块 $i$ 和 $j$：\n- 如果 $i$ 在 $\\pi^{+}$ 和 $\\pi^{-}$ 中都排在 $j$ 前面，则 $i$ 必须放置在 $j$ 的左边。\n- 如果 $i$ 在 $\\pi^{+}$ 中排在 $j$ 前面，而 $j$ 在 $\\pi^{-}$ 中排在 $i$ 前面，则 $i$ 必须放置在 $j$ 的下面。\n\n这些关系导出了两个优先关系有向无环图（DAG）：一个捕获左于关系的水平约束图 $\\mathcal{H}$ 和一个捕获下于关系的垂直约束图 $\\mathcal{V}$。在紧凑布局中，对于 $\\mathcal{H}$ 中的每条有向边 $i \\rightarrow j$，坐标必须满足 $x_{j} \\ge x_{i} + w_{i} + s_{x}$；对于 $\\mathcal{V}$ 中的每条边 $i \\rightarrow j$，坐标必须满足 $y_{j} \\ge y_{i} + h_{i} + s_{y}$。通过引入一个超级源点，并用零权重边连接到所有模块，紧凑解可以通过计算每个DAG中的最长路径距离来获得，其中 $\\mathcal{H}$ 中的每条边 $i \\rightarrow j$ 的权重为 $w_{i} + s_{x}$，而 $\\mathcal{V}$ 中的每条边 $i \\rightarrow j$ 的权重为 $h_{i} + s_{y}$。等效地，可以将节点权重分别视为 $w_{i}$ 或 $h_{i}$，并为每个优先约束边添加 $s_{x}$ 或 $s_{y}$ 作为最小间隔要求。\n\n现在我们将这些定义应用于给定的序列对 $\\pi^{+}=(C,A,E,B,D)$ 和 $\\pi^{-}=(A,C,B,D,E)$。首先，我们列举出左于关系，即满足 $i$ 在 $\\pi^{+}$ 和 $\\pi^{-}$ 中都排在 $j$ 前面的模块对 $(i,j)$。\n\n在 $\\pi^{+}$ 中的位置是：$C:1$, $A:2$, $E:3$, $B:4$, $D:5$。在 $\\pi^{-}$ 中的位置是：$A:1$, $C:2$, $B:3$, $D:4$, $E:5$。\n\n检查所有模块对：\n- 对于 $C$，我们有 $C$ 在两个序列中都排在 $B$ 和 $D$ 前面，所以 $C$ 在 $B$ 和 $D$ 的左边。\n- 对于 $A$，我们有 $A$ 在两个序列中都排在 $B$ 和 $D$ 前面，所以 $A$ 在 $B$ 和 $D$ 的左边。\n- 对于 $E$，$C$ 在 $\\pi^+$ 和 $\\pi^-$ 中都排在 $E$ 前面，所以 $C$ 在 $E$ 左边。$A$ 在 $\\pi^+$ 中排在 $E$ 前面，但在 $\\pi^-$ 中排在 $E$ 后面，所以 $A$ 在 $E$ 下面。\n- 对于 $B$，它在两个序列中都排在 $D$ 前面，所以 $B$ 在 $D$ 的左边。\n- $D$ 没有后继者。\n\n更正后的检查：\n- A 在 $\\pi^+$ 和 $\\pi^-$ 中都排在 B 和 D 之前。所以 A 在 B 左边，A 在 D 左边。\n- C 在 $\\pi^+$ 和 $\\pi^-$ 中都排在 B, D, E 之前。所以 C 在 B 左边， C 在 D 左边， C 在 E 左边。\n- B 在 $\\pi^+$ 和 $\\pi^-$ 中都排在 D 之前。所以 B 在 D 左边。\n\n因此，水平约束图 $\\mathcal{H}$ 具有以下边\n$$\nA \\rightarrow B,\\quad A \\rightarrow D,\\quad\nC \\rightarrow B,\\quad C \\rightarrow D,\\quad C \\rightarrow E,\\quad\nB \\rightarrow D.\n$$\n$\\mathcal{H}$ 中的每条边 $i \\rightarrow j$ 强制要求 $x_{j} \\ge x_{i} + w_{i} + s_{x}$，其中 $s_{x}=5$。\n\n接下来，我们列举出下于关系，即满足 $i$ 在 $\\pi^{+}$ 中排在 $j$ 前面且 $j$ 在 $\\pi^{-}$ 中排在 $i$ 前面的模块对 $(i,j)$：\n- 对于 $C$ 和 $A$，$C$ 在 $\\pi^{+}$ 中排在 $A$ 前面，而 $A$ 在 $\\pi^{-}$ 中排在 $C$ 前面，所以 $C$ 在 $A$ 的下面（在 $\\mathcal{V}$ 中为 $C \\rightarrow A$）。\n- 对于 $A$ 和 $E$，$A$ 在 $\\pi^{+}$ 中排在 $E$ 前面，而 $E$ 在 $\\pi^{-}$ 中排在 $A$ 后面。不满足。\n- 对于 $E$ 和 $B$，$E$ 在 $\\pi^{+}$ 中排在 $B$ 前面，而 $B$ 在 $\\pi^{-}$ 中排在 $E$ 前面，所以 $E$ 在 $B$ 的下面（$E \\rightarrow B$）。\n- 对于 $E$ 和 $D$，$E$ 在 $\\pi^{+}$ 中排在 $D$ 前面，而 $D$ 在 $\\pi^{-}$ 中排在 $E$ 前面，所以 $E$ 在 $D$ 的下面（$E \\rightarrow D$）。\n- 对于 $A$ 和 $E$，$A$ 在 $\\pi^{+}$ 中排在 $E$ 前面，而 $A$ 在 $\\pi^{-}$ 中排在 $E$ 之前。不满足。\n\n因此，垂直约束图 $\\mathcal{V}$ 具有以下边\n$$\nC \\rightarrow A,\\quad E \\rightarrow B,\\quad E \\rightarrow D,\n$$\n并且每条边 $i \\rightarrow j$ 强制要求 $y_{j} \\ge y_{i} + h_{i} + s_{y}$，其中 $s_{y}=10$。\n\n我们现在通过计算每个DAG中的最长路径来计算紧凑坐标。假设一个超级源点通过零权重边连接到所有模块，并将 $x_{i}$ 和 $y_{i}$ 设置为最长路径距离。\n\n对于 $\\mathcal{H}$，我们将每个节点 $i$ 的权重视为 $w_i$，每条边的权重视为 $s_x$。\n$x_A=0$, $x_C=0$ (没有入边)。\n$x_E = x_C + w_C + s_x = 0 + 40 + 5 = 45$。\n$x_B = \\max(x_A+w_A+s_x, x_C+w_C+s_x) = \\max(0+30+5, 0+40+5) = \\max(35, 45) = 45$。\n$x_D = \\max(x_A+w_A+s_x, x_C+w_C+s_x, x_B+w_B+s_x) = \\max(35, 45, 45+25+5) = \\max(35, 45, 75) = 75$。\n因此，水平坐标为\n$$\nx_{A}=0,\\quad x_{C}=0,\\quad x_{E}=45,\\quad x_{B}=45,\\quad x_{D}=75.\n$$\n\n对于 $\\mathcal{V}$，我们将每个节点 $i$ 的权重视为 $h_i$，每条边的权重视为 $s_y$。\n$y_C=0$, $y_E=0$ (没有入边)。\n$y_A = y_C + h_C + s_y = 0 + 15 + 10 = 25$。\n$y_B = y_E + h_E + s_y = 0 + 25 + 10 = 35$。\n$y_D = y_E + h_E + s_y = 0 + 25 + 10 = 35$。\n因此，垂直坐标为\n$$\ny_{C}=0,\\quad y_{E}=0,\\quad y_{A}=25,\\quad y_{B}=35,\\quad y_{D}=35.\n$$\n\n我们验证可行性：通过最长路径的构建方法，每个左于和下于约束都满足了至少为 $s_{x}$ 或 $s_{y}$ 的所需间距。紧凑性源于在具有这些边权重的DAG中，最长路径距离的最优性，它在遵守优先约束的同时最小化了最大范围。\n\n我们现在计算轮廓宽度 $W$ 和高度 $H$：\n$$\nW=\\max_{i}(x_{i}+w_{i})=\\max\\{x_{A}+w_{A},\\,x_{B}+w_{B},\\,x_{C}+w_{C},\\,x_{D}+w_{D},\\,x_{E}+w_{E}\\} \\\\\n=\\max\\{0+30,\\,45+25,\\,0+40,\\,75+20,\\,45+15\\}=\\max\\{30,\\,70,\\,40,\\,95,\\,60\\}=95.\n$$\n$$\nH=\\max_{i}(y_{i}+h_{i})=\\max\\{y_{A}+h_{A},\\,y_{B}+h_{B},\\,y_{C}+h_{C},\\,y_{D}+h_{D},\\,y_{E}+h_{E}\\} \\\\\n=\\max\\{25+20,\\,35+35,\\,0+15,\\,35+30,\\,0+25\\}=\\max\\{45,\\,70,\\,15,\\,65,\\,25\\}=70.\n$$\n因此，总轮廓面积为\n$$\nA=W \\times H=95 \\times 70=6650.\n$$\n\n用科学记数法表示并四舍五入到四位有效数字，结果是\n$$\nA=6.650 \\times 10^{3}.\n$$",
            "answer": "$$\\boxed{6.650 \\times 10^{3}}$$"
        },
        {
            "introduction": "掌握解码之后，下一步是学习如何编码。实际的芯片设计通常始于一系列约束（例如，模块A必须在模块B的左侧）。本练习将解决逆向问题：如何构建一个有效的序列对来满足给定的几何先后关系约束 。这个练习不仅能加深你对序列对编码规则的理解，还将引导你进行组合学方面的思考，这对于开发高效的布图规划搜索算法至关重要。",
            "id": "4272840",
            "problem": "在电子设计自动化（EDA）的物理设计中，一个非剖分式布局规划可以通过一个序列对进行编码。一个模块集合的序列对是模块标签上的一个排列有序对 $(\\pi, \\sigma)$，其语义如下：对于任意两个不同的模块 $i$ 和 $j$，$i$ 在 $\\pi$ 和 $\\sigma$ 中都排在 $j$ 之前，则 $i$ 在 $j$ 的左边；如果 $i$ 在 $\\pi$ 中排在 $j$ 之前而 $j$ 在 $\\sigma$ 中排在 $i$ 之前，则 $i$ 在 $j$ 的下方；如果 $j$ 在 $\\pi$ 中排在 $i$ 之前而 $i$ 在 $\\sigma$ 中排在 $j$ 之前，则 $i$ 在 $j$ 的上方；如果 $j$ 在 $\\pi$ 和 $\\sigma$ 中都排在 $i$ 之前，则 $i$ 在 $j$ 的右边。这些关系强制了模块不重叠，并捕获了非剖分式布局中允许的先后次序约束。\n\n考虑四个硬矩形模块 $\\{A, B, C, D\\}$，其尺寸分别为 $(w_{A}, h_{A}) = (2, 3)$，$(w_{B}, h_{B}) = (1, 2)$，$(w_{C}, h_{C}) = (3, 1)$ 和 $(w_{D}, h_{D}) = (2, 2)$。假设设计者施加了两个必须由该非剖分式表示满足的先后次序约束：\n- $A$ 在 $B$ 的左边，\n- $C$ 在 $D$ 的下方。\n\n没有对相对位置施加其他约束。仅使用序列对表示的基本定义和排列计数的基本原理，完成以下任务：\n1. 在 $\\{A, B, C, D\\}$ 上构建一个有效的序列对 $(\\pi, \\sigma)$，使其精确地编码这两个先后次序约束，并证明你所给出的特定排列如何强制 $A$ 在 $B$ 的左边以及 $C$ 在 $D$ 的下方。\n2. 确定在 $\\{A, B, C, D\\}$ 上满足这两个先后次序约束的不同序列对 $(\\pi, \\sigma)$ 的总数。在计数时，将 $(\\pi, \\sigma)$ 和 $(\\sigma, \\pi)$ 视为不同的，除非它们作为有序对完全相同。将最终计数表示为整数。",
            "solution": "问题要求我们处理四个模块 $\\{A, B, C, D\\}$ 集合的序列对表示。我们必须首先构建一个满足两个给定几何约束的有效序列对 $(\\pi, \\sigma)$，然后确定此类对的总数。模块尺寸 $(w_{i}, h_{i})$ 是为提供背景而给出的，但对于本问题的组合计数部分并非必需。\n\n设排列的有序对为 $(\\pi, \\sigma)$。我们使用符号 $i \\prec_{\\pi} j$ 来表示模块 $i$ 在排列 $\\pi$ 中位于模块 $j$ 之前。两个不同模块 $i$ 和 $j$ 的相对布局规则如下：\n1.  ($i \\prec_{\\pi} j$ 且 $i \\prec_{\\sigma} j$) $\\implies$ $i$ 在 $j$ 的左边。\n2.  ($i \\prec_{\\pi} j$ 且 $j \\prec_{\\sigma} i$) $\\implies$ $i$ 在 $j$ 的下方。\n3.  ($j \\prec_{\\pi} i$ 且 $i \\prec_{\\sigma} j$) $\\implies$ $i$ 在 $j$ 的上方。\n4.  ($j \\prec_{\\pi} i$ 且 $j \\prec_{\\sigma} i$) $\\implies$ $i$ 在 $j$ 的右边。\n\n必须满足的两个特定先后次序约束是：\n- 约束1: $A$ 在 $B$ 的左边。\n- 约束2: $C$ 在 $D$ 的下方。\n\n根据定义，我们可以将这些几何约束转换为对排列 $\\pi$ 和 $\\sigma$ 的约束。\n- 对于“$A$ 在 $B$ 左边”，我们必须满足第一条规则，其中 $i=A$，$j=B$。这意味着我们必须有 $A \\prec_{\\pi} B$ 和 $A \\prec_{\\sigma} B$。\n- 对于“$C$ 在 $D$ 下方”，我们必须满足第二条规则，其中 $i=C$，$j=D$。这意味着我们必须有 $C \\prec_{\\pi} D$ 和 $D \\prec_{\\sigma} C$。\n\n因此，该问题分为两部分：构建一个有效的对和枚举所有有效的对。\n\n第1部分：构建一个有效的序列对 $(\\pi, \\sigma)$。\n\n我们需要找到一个 $\\{A, B, C, D\\}$ 的排列 $\\pi$，它同时满足 $A \\prec_{\\pi} B$ 和 $C \\prec_{\\pi} D$。我们还需要找到一个 $\\{A, B, C, D\\}$ 的排列 $\\sigma$，它同时满足 $A \\prec_{\\sigma} B$ 和 $D \\prec_{\\sigma} C$。\n\n对于 $\\pi$：我们需要 $A$ 出现在 $B$ 之前，并且 $C$ 出现在 $D$ 之前。此类排列的一个例子是 $\\pi = (A, C, D, B)$。在这个排列中，$A$ 在第一个位置，$B$ 在第四个位置，所以 $A \\prec_{\\pi} B$。$C$ 在第二个位置，$D$ 在第三个位置，所以 $C \\prec_{\\pi} D$。两个条件都满足了。\n\n对于 $\\sigma$：我们需要 $A$ 出现在 $B$ 之前，并且 $D$ 出现在 $C$ 之前。此类排列的一个例子是 $\\sigma = (A, D, C, B)$。在这个排列中，$A$ 在第一个位置，$B$ 在第四个位置，所以 $A \\prec_{\\sigma} B$。$D$ 在第二个位置，$C$ 在第三个位置，所以 $D \\prec_{\\sigma} C$。两个条件都满足了。\n\n因此，一个有效的序列对是 $(\\pi, \\sigma) = ((A, C, D, B), (A, D, C, B))$。\n\n证明：\n- 对于模块对 $\\{A, B\\}$，我们有 $A \\prec_{\\pi} B$ (来自 $\\pi=(A,C,D,B)$) 和 $A \\prec_{\\sigma} B$ (来自 $\\sigma=(A,D,C,B)$)。根据规则1，这正确地编码了约束“$A$ 在 $B$ 的左边”。\n- 对于模块对 $\\{C, D\\}$，我们有 $C \\prec_{\\pi} D$ (来自 $\\pi=(A,C,D,B)$) 和 $D \\prec_{\\sigma} C$ (来自 $\\sigma=(A,D,C,B)$)。根据规则2，这正确地编码了约束“$C$ 在 $D$ 的下方”。\n\n第2部分：确定不同序列对的总数。\n\n有效序列对 $(\\pi, \\sigma)$ 的总数是 $\\pi$ 的有效排列数和 $\\sigma$ 的有效排列数的乘积，因为 $\\pi$ 和 $\\sigma$ 的选择是相互独立的。\n设 $N_{\\pi}$ 是满足对 $\\pi$ 约束的排列数。\n设 $N_{\\sigma}$ 是满足对 $\\sigma$ 约束的排列数。\n总对数是 $N = N_{\\pi} \\times N_{\\sigma}$。\n\n计算 $N_{\\pi}$：\n我们需要计算 $4$ 个模块 $\\{A, B, C, D\\}$ 的排列中同时满足 $A \\prec_{\\pi} B$ 和 $C \\prec_{\\pi} D$ 的数量。\n$4$ 个不同项的全排列总数为 $4! = 24$。\n约束 $A \\prec_{\\pi} B$ 固定了 $A$ 和 $B$ 的相对顺序。对于一个排列集合中的任意一对元素，恰好有一半的排列中一个元素在另一个之前。所以，满足 $A \\prec_{\\pi} B$ 的排列数是 $\\frac{4!}{2} = 12$。\n两个约束 $A \\prec_{\\pi} B$ 和 $C \\prec_{\\pi} D$ 作用于不相交的模块集合，即 $\\{A, B\\}$ 和 $\\{C, D\\}$。因此，这两个条件是独立的。\n满足 $A \\prec_{\\pi} B$ 的排列所占的比例是 $\\frac{1}{2}$。\n满足 $C \\prec_{\\pi} D$ 的排列所占的比例是 $\\frac{1}{2}$。\n同时满足这两个独立条件的排列所占的比例是它们比例的乘积：$\\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$。\n所以，$\\pi$ 的有效排列数是 $N_{\\pi} = 4! \\times \\frac{1}{4} = 24 \\times \\frac{1}{4} = 6$。\n\n或者，我们可以使用构造性组合论证。排列中有 $4$ 个位置。我们必须放置 $A, B, C, D$。\n首先，为模块 $A$ 和 $B$ 选择 $2$ 个位置。这有 $\\binom{4}{2}$ 种方法。一旦位置被选定，为了满足 $A \\prec_{\\pi} B$，$A$ 必须放在这两个位置的第一个，$B$ 放在第二个。所以只有 $1$ 种放置方式。\n剩下的 $2$ 个位置必须由 $C$ 和 $D$ 填充。为了满足 $C \\prec_{\\pi} D$，$C$ 必须放在剩余位置的第一个，$D$ 放在第二个。也只有 $1$ 种方式。\n因此，总方法数就是为模块对 $\\{A, B\\}$ 选择位置的方法数，即 $\\binom{4}{2} = \\frac{4 \\times 3}{2} = 6$。\n所以，$N_{\\pi} = 6$。\n\n计算 $N_{\\sigma}$：\n我们需要计算 $\\{A, B, C, D\\}$ 的排列中同时满足 $A \\prec_{\\sigma} B$ 和 $D \\prec_{\\sigma} C$ 的数量。\n这个问题与 $\\pi$ 的问题具有完全相同的结构。我们有两对模块，$\\{A, B\\}$ 和 $\\{D, C\\}$，它们的相对顺序是固定的。这两对是不相交的。\n使用相同的逻辑，$\\sigma$ 的有效排列数也是 $N_{\\sigma} = 4! \\times \\frac{1}{4} = 6$，或者等价地 $\\binom{4}{2} = 6$。\n\n有效序列对的总数：\n满足给定约束的不同对 $(\\pi, \\sigma)$ 的总数是 $\\pi$ 的选择数和 $\\sigma$ 的选择数的乘积。\n$N = N_{\\pi} \\times N_{\\sigma} = 6 \\times 6 = 36$。",
            "answer": "$$\n\\boxed{36}\n$$"
        }
    ]
}