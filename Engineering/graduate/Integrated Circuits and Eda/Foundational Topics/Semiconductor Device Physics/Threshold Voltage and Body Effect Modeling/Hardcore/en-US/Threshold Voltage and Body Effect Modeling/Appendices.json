{
    "hands_on_practices": [
        {
            "introduction": "The body-effect coefficient, $\\gamma$, is a cornerstone parameter in MOSFET modeling that quantifies the influence of substrate bias on the threshold voltage. This exercise guides you from first principles of electrostatics to derive the physical origins of $\\gamma$, revealing its direct relationship with fundamental device properties like substrate doping ($N_A$) and oxide capacitance ($C_{ox}$). By completing this practice , you will gain a deeper intuition for how process choices directly translate into a key electrical characteristic.",
            "id": "4305448",
            "problem": "A planar long-channel n-channel Metal–Oxide–Semiconductor Field-Effect Transistor (MOSFET) is fabricated on a uniformly doped p-type silicon substrate. Assume the one-dimensional depletion approximation, negligible fixed oxide charge and interface traps, and operation at room temperature such that the onset of strong inversion is set by the electrostatic condition at the silicon surface. The oxide is a linear, homogeneous dielectric, so that the oxide capacitance per unit area equals the parallel-plate capacitance.\n\nStarting from the fundamental electrostatics of the depletion region in a uniformly doped semiconductor and the definition of capacitance for a parallel-plate dielectric, provide a first-principles justification for how the body-effect coefficient (body factor) $\\,\\gamma\\,$ depends on the oxide capacitance per unit area $\\,C_{ox}\\,$. In particular, derive the normalized sensitivity\n$$\nS \\equiv \\frac{d \\ln \\gamma}{d \\ln C_{ox}}\n$$\nwithout invoking any pre-memorized form for $\\,\\gamma\\,$.\n\nThen, using your derived relationship, compute the numerical value of $\\,\\gamma\\,$ for the following technologically realistic parameters:\n- Substrate acceptor concentration: $\\,N_{A} = 8.0 \\times 10^{16}\\ \\mathrm{cm^{-3}}$.\n- Elementary charge: $\\,q = 1.602\\,176\\,634 \\times 10^{-19}\\ \\mathrm{C}$.\n- Vacuum permittivity: $\\,\\varepsilon_{0} = 8.854\\,187\\,817 \\times 10^{-12}\\ \\mathrm{F/m}$.\n- Silicon permittivity: $\\,\\varepsilon_{si} = 11.7\\,\\varepsilon_{0}$.\n- Oxide permittivity: $\\,\\varepsilon_{ox} = 3.9\\,\\varepsilon_{0}$.\n- Oxide thickness: $\\,t_{ox} = 1.4\\ \\mathrm{nm}$.\n\nUse the parallel-plate definition $\\,C_{ox} = \\varepsilon_{ox}/t_{ox}\\,$. Express the final numeric value of $\\,\\gamma\\,$ in $\\,\\mathrm{V^{1/2}}\\,$ and round your answer to four significant figures.",
            "solution": "The problem requires a first-principles derivation of the relationship between the body-effect coefficient, $\\gamma$, and the oxide capacitance per unit area, $C_{ox}$, for a long-channel nMOSFET. Subsequently, we are to derive the normalized sensitivity of $\\gamma$ with respect to $C_{ox}$ and compute a numerical value for $\\gamma$ given a set of parameters.\n\nFirst, we derive the expression for the body-effect coefficient $\\gamma$. This coefficient characterizes the change in threshold voltage $V_T$ with an applied source-to-body reverse bias, $V_{SB}$. The threshold voltage $V_T(V_{SB})$ is given by:\n$$\nV_T(V_{SB}) = V_{FB} + 2\\phi_F + \\frac{\\sqrt{2 q \\varepsilon_{si} N_A (2\\phi_F + V_{SB})}}{C_{ox}}\n$$\nwhere $V_{FB}$ is the flat-band voltage, $\\phi_F$ is the bulk Fermi potential, $q$ is the elementary charge, $\\varepsilon_{si}$ is the silicon permittivity, $N_A$ is the acceptor concentration, and $C_{ox}$ is the gate oxide capacitance per unit area.\n\nThe body-effect coefficient, $\\gamma$, is the prefactor of the term that describes the influence of the body bias. By inspecting the equation, we can identify $\\gamma$ as the term multiplying the square-root dependency:\n$$\n\\gamma = \\frac{\\sqrt{2 q \\varepsilon_{si} N_A}}{C_{ox}}\n$$\nThis expression, derived from first principles of MOS electrostatics, provides the justification for the dependence of $\\gamma$ on $C_{ox}$. It shows that $\\gamma$ is inversely proportional to the oxide capacitance per unit area.\n\nNext, we derive the normalized sensitivity, $S \\equiv \\frac{d \\ln \\gamma}{d \\ln C_{ox}}$.\nTaking the natural logarithm of the expression for $\\gamma$:\n$$\n\\ln \\gamma = \\ln\\left(\\frac{\\sqrt{2 q \\varepsilon_{si} N_A}}{C_{ox}}\\right) = \\ln(\\sqrt{2 q \\varepsilon_{si} N_A}) - \\ln(C_{ox})\n$$\nThe term $\\sqrt{2 q \\varepsilon_{si} N_A}$ is independent of $C_{ox}$. Differentiating $\\ln \\gamma$ with respect to $\\ln(C_{ox})$ gives:\n$$\nS = \\frac{d}{d \\ln C_{ox}} \\left( \\ln(\\sqrt{2 q \\varepsilon_{si} N_A}) - \\ln(C_{ox}) \\right) = 0 - 1 = -1\n$$\nThus, the normalized sensitivity is $S = -1$. This confirms that $\\gamma$ is inversely proportional to $C_{ox}$.\n\nFinally, we compute the numerical value of $\\gamma$ using the provided parameters. We must use a consistent set of units, specifically the MKS system.\nThe given substrate acceptor concentration is $N_A = 8.0 \\times 10^{16}\\ \\mathrm{cm^{-3}}$. We convert this to $\\mathrm{m^{-3}}$:\n$N_A = (8.0 \\times 10^{16}\\ \\mathrm{cm^{-3}}) \\times (100\\ \\mathrm{cm/m})^3 = 8.0 \\times 10^{22}\\ \\mathrm{m^{-3}}$.\nThe other parameters in MKS units are:\n$q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n$\\varepsilon_{si} = 11.7\\,\\varepsilon_{0} = 11.7 \\times (8.854187817 \\times 10^{-12}\\ \\mathrm{F/m}) = 1.03594 \\times 10^{-10}\\ \\mathrm{F/m}$\n$\\varepsilon_{ox} = 3.9\\,\\varepsilon_{0} = 3.9 \\times (8.854187817 \\times 10^{-12}\\ \\mathrm{F/m}) = 3.4531 \\times 10^{-11}\\ \\mathrm{F/m}$\n$t_{ox} = 1.4\\ \\mathrm{nm} = 1.4 \\times 10^{-9}\\ \\mathrm{m}$\n\nWe calculate the numerator and denominator of the $\\gamma$ expression separately.\nFirst, the numerator term:\n$$\n\\sqrt{2 q \\varepsilon_{si} N_A} = \\sqrt{2 \\cdot (1.60217... \\times 10^{-19}) \\cdot (1.03594 \\times 10^{-10}) \\cdot (8.0 \\times 10^{22})}\n$$\n$$\n= \\sqrt{2.6563 \\times 10^{-6}} \\approx 0.0016298\\ \\mathrm{C/m^2}\n$$\nNext, the denominator term, which is the oxide capacitance per unit area:\n$$\nC_{ox} = \\frac{\\varepsilon_{ox}}{t_{ox}} = \\frac{3.4531 \\times 10^{-11}\\ \\mathrm{F/m}}{1.4 \\times 10^{-9}\\ \\mathrm{m}} \\approx 0.024665\\ \\mathrm{F/m^2}\n$$\nNow, we can compute $\\gamma$:\n$$\n\\gamma = \\frac{\\sqrt{2 q \\varepsilon_{si} N_A}}{C_{ox}} = \\frac{0.0016298\\ \\mathrm{C/m^2}}{0.024665\\ \\mathrm{F/m^2}} \\approx 0.06607\\ \\mathrm{V^{1/2}}\n$$\nThe units are correct, since $(\\mathrm{C/m^2}) / (\\mathrm{F/m^2}) = \\mathrm{C/F} = \\mathrm{V}$, but the numerator is actually $\\sqrt{\\mathrm{C \\cdot (F/m) \\cdot m^{-3}}} = \\sqrt{\\mathrm{C \\cdot F / m^4}} = \\sqrt{\\mathrm{V^2 \\cdot F^2 / m^4}} = \\mathrm{V \\cdot F / m^2}$. So $\\gamma$ has units of $(\\mathrm{V \\cdot F / m^2}) / (\\mathrm{F/m^2}) = \\mathrm{V}$. Wait, that's not right. The units of the numerator are $\\sqrt{q \\varepsilon_{si} N_A} = \\sqrt{\\mathrm{C \\cdot (F/m) \\cdot m^{-3}}} = \\sqrt{\\mathrm{C \\cdot F / m^4}}$. Let's use $Q=CV \\implies F=C/V$. $\\sqrt{\\mathrm{C^2 / (V \\cdot m^4)}} = \\mathrm{C} / (\\mathrm{V^{1/2} m^2})$. Then $\\gamma$ has units of $(\\mathrm{C} / (\\mathrm{V^{1/2} m^2})) / (\\mathrm{F/m^2}) = (\\mathrm{C} / (\\mathrm{V^{1/2} m^2})) / ((\\mathrm{C/V}) / \\mathrm{m^2}) = \\mathrm{V^{1/2}}$. The units are indeed $\\mathrm{V^{1/2}}$.\n\nRounding the result to four significant figures, we get:\n$$\n\\gamma \\approx 0.06607\\ \\mathrm{V^{1/2}}\n$$",
            "answer": "$$\n\\boxed{0.06607}\n$$"
        },
        {
            "introduction": "With a solid understanding of the body-effect coefficient, the next step is to apply it in a practical calculation. This problem  demonstrates how to use the full body-effect equation to compute the precise shift in threshold voltage ($V_T$) caused by a specific source-to-body reverse bias ($V_{SB}$). Mastering this calculation is essential for predicting device behavior in circuits where the source potential is not tied to the substrate, such as in stacked transistors or pass-gate logic.",
            "id": "4305512",
            "problem": "In an Electronic Design Automation (EDA) compact model for a long-channel n-channel Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET), the threshold condition is defined by the onset of strong inversion when the surface potential attains twice the bulk Fermi potential. Under the depletion approximation with a uniformly doped $p$-type substrate, use the following extracted parameters: the body-effect coefficient $\\gamma$, the bulk Fermi potential $\\phi_{F}$ (taken as a positive magnitude for a $p$-type substrate), the source-to-body bias $V_{SB}$ (positive for reverse bias in an n-channel device), and the baseline zero-bias threshold $V_{T0}$ obtained at $V_{SB} = 0$. Starting from first principles of the MOS capacitor, derive the threshold voltage $V_{T}$ at nonzero $V_{SB}$ and then evaluate it numerically for the device described below. Finally, qualitatively compare the computed $V_{T}$ to $V_{T0}$ in terms of increase or decrease due to body bias.\n\nDevice and modeling assumptions:\n- Long-channel, quasi-static operation; ignore short-channel effects, Drain-Induced Barrier Lowering, quantum confinement, interface traps, and polysilicon depletion.\n- Strong inversion is defined at surface potential equal to $2\\phi_{F}$.\n- The depletion approximation is valid in the substrate.\n- The body-effect coefficient $\\gamma$ is treated as a constant parameter extracted from process and geometry.\n\nGiven extracted/model parameters:\n- $\\gamma = 0.70$ $\\text{volt}^{1/2}$,\n- $\\phi_{F} = 0.35$ volts,\n- $V_{SB} = 0.50$ volts,\n- $V_{T0} = 0.45$ volts.\n\nCompute the threshold voltage $V_{T}$ for the given $V_{SB}$, and state whether it is higher or lower than the un-biased threshold $V_{T0}$. Express the final threshold voltage in volts. Round your final numeric answer to four significant figures.",
            "solution": "**Derivation of Threshold Voltage with Body Effect**\n\nThe threshold voltage $V_T$ of a MOSFET is the gate-source voltage $V_{GS}$ required to form an inversion layer at the silicon surface. This voltage must overcome the flat-band voltage $V_{FB}$, provide the necessary band bending in the silicon (surface potential $\\phi_s$), and support the voltage drop across the gate oxide ($V_{ox}$) due to charge in the silicon. The fundamental MOS voltage balance equation, with all voltages referenced to the body (substrate), is:\n$$V_{GB} = V_{FB} + \\phi_s + V_{ox}$$\nwhere $V_{GB}$ is the gate-to-body voltage.\n\nFirst, consider the case with zero source-to-body bias, $V_{SB} = 0$. Here, the source and body are at the same potential, so $V_{GB} = V_{GS}$. The threshold voltage is denoted $V_{T0}$. At the onset of strong inversion, the surface potential required is $\\phi_s = 2\\phi_F$.\nThe charge in the depletion region per unit area is given by the depletion approximation:\n$$Q_{dep,0} = -\\sqrt{2 q \\epsilon_{si} N_A (2\\phi_F)}$$\nwhere $q$ is the elementary charge, $\\epsilon_{si}$ is the permittivity of silicon, and $N_A$ is the acceptor doping concentration. The voltage across the oxide is $V_{ox,0} = -Q_{dep,0}/C_{ox}$, where $C_{ox}$ is the gate oxide capacitance per unit area.\nThe threshold voltage is then:\n$$V_{T0} = V_{GS}|_{inv} = V_{GB}|_{inv} = V_{FB} + 2\\phi_F - \\frac{Q_{dep,0}}{C_{ox}}$$\n$$V_{T0} = V_{FB} + 2\\phi_F + \\frac{\\sqrt{2 q \\epsilon_{si} N_A (2\\phi_F)}}{C_{ox}}$$\nIntroducing the body-effect coefficient $\\gamma = \\frac{\\sqrt{2 q \\epsilon_{si} N_A}}{C_{ox}}$, the expression simplifies to:\n$$V_{T0} = V_{FB} + 2\\phi_F + \\gamma\\sqrt{2\\phi_F} \\quad \\quad (1)$$\n\nNext, consider the case with a positive source-to-body bias, $V_{SB} > 0$. The source terminal is now at a potential $V_{SB}$ higher than the body. To form an inversion channel that connects to the source, the surface potential at the source end must be brought to $2\\phi_F$ *relative to the source potential*. Since the source itself is at $+V_{SB}$ relative to the body, the total surface potential $\\phi_s$ required *relative to the body* is:\n$$\\phi_s = 2\\phi_F + V_{SB}$$\nThe depletion charge now corresponds to this larger potential drop:\n$$Q_{dep} = -\\sqrt{2 q \\epsilon_{si} N_A (2\\phi_F + V_{SB})}$$\nThe gate-to-body voltage required for threshold is $V_{GB} = V_{FB} + \\phi_s - Q_{dep}/C_{ox}$.\nThe threshold voltage $V_T$ is defined as the gate-to-source voltage, $V_T = V_{GS}$. The relationship between gate-source and gate-body voltage is $V_{GB} = V_{GS} - V_{BS} = V_T - (-V_{SB}) = V_T + V_{SB}$.\nSubstituting these into the voltage balance equation:\n$$V_T + V_{SB} = V_{FB} + (2\\phi_F + V_{SB}) + \\frac{\\sqrt{2 q \\epsilon_{si} N_A (2\\phi_F + V_{SB})}}{C_{ox}}$$\nThe $V_{SB}$ terms on both sides cancel, yielding the expression for $V_T$:\n$$V_T = V_{FB} + 2\\phi_F + \\gamma\\sqrt{2\\phi_F + V_{SB}} \\quad \\quad (2)$$\nTo express $V_T$ in terms of $V_{T0}$, we rearrange equation $(1)$ to find $V_{FB} + 2\\phi_F = V_{T0} - \\gamma\\sqrt{2\\phi_F}$. Substituting this into equation $(2)$:\n$$V_T = \\left( V_{T0} - \\gamma\\sqrt{2\\phi_F} \\right) + \\gamma\\sqrt{2\\phi_F + V_{SB}}$$\nThis rearranges to the final derived form for the threshold voltage with body effect:\n$$V_T = V_{T0} + \\gamma \\left( \\sqrt{2\\phi_F + V_{SB}} - \\sqrt{2\\phi_F} \\right)$$\n\n**Numerical Evaluation**\nWe are given the following parameters:\n-   $V_{T0} = 0.45$ V\n-   $\\gamma = 0.70$ V$^{1/2}$\n-   $\\phi_F = 0.35$ V\n-   $V_{SB} = 0.50$ V\n\nSubstitute these values into the derived equation:\n$$V_T = 0.45 + 0.70 \\left( \\sqrt{2(0.35) + 0.50} - \\sqrt{2(0.35)} \\right)$$\nFirst, calculate the terms inside the square roots:\n$$2\\phi_F = 2 \\times 0.35 = 0.70 \\text{ V}$$\n$$2\\phi_F + V_{SB} = 0.70 + 0.50 = 1.20 \\text{ V}$$\nNow substitute these into the equation for $V_T$:\n$$V_T = 0.45 + 0.70 \\left( \\sqrt{1.20} - \\sqrt{0.70} \\right)$$\nEvaluating the square roots:\n$$\\sqrt{1.20} \\approx 1.095445 \\text{ V}^{1/2}$$\n$$\\sqrt{0.70} \\approx 0.836660 \\text{ V}^{1/2}$$\nNow, compute the value of $V_T$:\n$$V_T \\approx 0.45 + 0.70 \\times (1.095445 - 0.836660)$$\n$$V_T \\approx 0.45 + 0.70 \\times (0.258785)$$\n$$V_T \\approx 0.45 + 0.1811495$$\n$$V_T \\approx 0.6311495 \\text{ V}$$\nRounding the final numeric answer to four significant figures, we get:\n$$V_T = 0.6311 \\text{ V}$$\n\n**Qualitative Comparison**\nThe computed threshold voltage is $V_T \\approx 0.6311$ V. The un-biased threshold voltage is given as $V_{T0} = 0.45$ V.\nComparing the two values, $V_T > V_{T0}$.\nThe threshold voltage is higher with the application of a source-to-body reverse bias. This is the characteristic known as the \"body effect\" or \"back-gate effect\". The reverse bias $V_{SB}$ widens the depletion region under the gate, which means a larger portion of the gate voltage is required to support the increased depletion charge. Consequently, a higher gate voltage is needed to reach the strong inversion condition, resulting in an increased threshold voltage. The derived formula shows that for any $V_{SB} > 0$, the term $\\sqrt{2\\phi_F + V_{SB}}$ will be greater than $\\sqrt{2\\phi_F}$, leading to a positive change in $V_T$.",
            "answer": "$$\n\\boxed{0.6311}\n$$"
        },
        {
            "introduction": "The ultimate test of a physical model is its ability to match real-world data, a process central to Electronic Design Automation (EDA). This final practice  bridges theory and application by guiding you through the extraction of the body-effect parameter, known as $K1$ in the BSIM compact model, from simulated \"measured\" data. You will implement a linear regression technique to fit the theoretical model to data points, mirroring the standard industry procedure for device characterization and model parameter extraction.",
            "id": "4305460",
            "problem": "You are modeling the threshold voltage body effect of a long-channel Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET) within the Berkeley Short-channel Insulated Gate Field-Effect Transistor Model (BSIM). The parameter $K1$ in BSIM captures the first-order sensitivity of the threshold voltage to body bias. Starting only from a fundamental electrostatics base, derive the linear dependence of the threshold voltage on the square root of the combined surface potential and source-to-body bias, and identify how $K1$ depends on the gate-oxide capacitance per unit area and substrate doping.\n\nUse the following fundamental bases and definitions without introducing any shortcut models beyond what is derived:\n- Depletion approximation for a uniformly doped $p$-type substrate: the magnitude of the depletion charge per unit area at the onset of strong inversion is $|Q_d|$.\n- Strong inversion threshold condition: the surface potential at threshold equals twice the Fermi potential, i.e., $\\psi_s = 2\\phi_F$.\n- Gate electrostatics: the gate voltage at threshold equals the sum of an electrostatic constant offset and the voltage drop across the gate oxide caused by the depletion charge.\n- Fermi potential of a $p$-type substrate at temperature $T$: $\\phi_F$ is a function of substrate acceptor concentration and intrinsic carrier concentration.\n\nFrom these, establish the linear relation between the threshold voltage $V_T$ and the transformed variable $x = \\sqrt{2\\phi_F + V_{SB}}$ for source-to-body bias $V_{SB} \\ge 0$, and clearly express the dependence of the slope $K1$ on substrate doping and gate-oxide capacitance per unit area.\n\nThen, propose an extraction method to obtain $K1$ from measured pairs $\\{(V_{SB,i}, V_{T,i})\\}$ collected at fixed temperature. Your extraction method must be implementable as a robust algorithm on numerical data, without relying on shortcut formulas that bypass the fundamental derivation.\n\nImplementation requirements:\n- Compute the Fermi potential $\\phi_F$ using $p$-type substrate acceptor concentration $N_A$ and intrinsic carrier concentration $n_i$ via $\\phi_F = \\frac{k_B T}{q}\\ln\\left(\\frac{N_A}{n_i}\\right)$, where $q$ is the elementary charge and $k_B$ is the Boltzmann constant. Use $T = 300 \\ \\mathrm{K}$ and $n_i = 10^{16} \\ \\mathrm{m}^{-3}$.\n- For each test case, construct the regressor $x_i = \\sqrt{2\\phi_F + V_{SB,i}}$ and perform a least-squares linear fit of $V_{T,i} = m x_i + b$; return the slope $m$ as the estimate of $K1$.\n- Express the final extracted $K1$ values in $\\sqrt{\\mathrm{V}}$, each rounded to six decimal places.\n\nPhysical constants to use in the derivation and any internal consistency checks:\n- Elementary charge: $q = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$.\n- Vacuum permittivity: $\\varepsilon_0 = 8.854187817 \\times 10^{-12} \\ \\mathrm{F/m}$.\n- Silicon permittivity: $\\varepsilon_{\\mathrm{Si}} = 11.7 \\varepsilon_0$.\n- Silicon dioxide permittivity: $\\varepsilon_{\\mathrm{ox}} = 3.9 \\varepsilon_0$.\n- Boltzmann constant: $k_B = 1.380649 \\times 10^{-23} \\ \\mathrm{J/K}$.\n\nUnits:\n- Substrate doping $N_A$ in $\\mathrm{m}^{-3}$.\n- Oxide thickness $t_{\\mathrm{ox}}$ in $\\mathrm{m}$.\n- Gate-oxide capacitance per unit area $C_{ox}$ in $\\mathrm{F/m^2}$ via $C_{ox} = \\frac{\\varepsilon_{\\mathrm{ox}}}{t_{\\mathrm{ox}}}$.\n- $V_{SB}$ and $V_T$ in $\\mathrm{V}$.\n- $K1$ in $\\sqrt{\\mathrm{V}}$.\n\nTest suite:\nProvide a program that uses the following test cases. For each case, compute $\\phi_F$ from $N_A$ and use the given measured pairs $\\{(V_{SB,i}, V_{T,i})\\}$ to extract $K1$ via least squares. Do not modify the provided data.\n\n- Case A (happy path, typical doping and oxide thickness):\n  - $N_A = 1.0 \\times 10^{23} \\ \\mathrm{m}^{-3}$, $t_{\\mathrm{ox}} = 3.0 \\times 10^{-9} \\ \\mathrm{m}$.\n  - $V_{SB}$ values: $[0.0, 0.2, 0.4, 0.6, 0.8] \\ \\mathrm{V}$.\n  - Measured $V_T$ values: $[0.5000, 0.5164, 0.5313, 0.5450, 0.5580] \\ \\mathrm{V}$.\n\n- Case B (boundary condition: very thin oxide, smaller body effect):\n  - $N_A = 1.0 \\times 10^{23} \\ \\mathrm{m}^{-3}$, $t_{\\mathrm{ox}} = 1.0 \\times 10^{-9} \\ \\mathrm{m}$.\n  - $V_{SB}$ values: $[0.0, 0.3, 0.6, 0.9] \\ \\mathrm{V}$.\n  - Measured $V_T$ values: $[0.4500, 0.4580, 0.4650, 0.4714] \\ \\mathrm{V}$.\n\n- Case C (edge case: low substrate doping, weak body effect):\n  - $N_A = 5.0 \\times 10^{21} \\ \\mathrm{m}^{-3}$, $t_{\\mathrm{ox}} = 3.0 \\times 10^{-9} \\ \\mathrm{m}$.\n  - $V_{SB}$ values: $[0.0, 0.2, 0.4, 0.6] \\ \\mathrm{V}$.\n  - Measured $V_T$ values: $[0.4000, 0.4040, 0.4076, 0.4109] \\ \\mathrm{V}$.\n\n- Case D (edge case: high substrate doping and thicker oxide, strong body effect):\n  - $N_A = 5.0 \\times 10^{24} \\ \\mathrm{m}^{-3}$, $t_{\\mathrm{ox}} = 5.0 \\times 10^{-9} \\ \\mathrm{m}$.\n  - $V_{SB}$ values: $[0.0, 0.1, 0.2, 0.3] \\ \\mathrm{V}$.\n  - Measured $V_T$ values: $[0.7000, 0.7886, 0.8748, 0.9571] \\ \\mathrm{V}$.\n\n- Case E (minimal data points: two-point fit robustness):\n  - $N_A = 1.0 \\times 10^{23} \\ \\mathrm{m}^{-3}$, $t_{\\mathrm{ox}} = 3.0 \\times 10^{-9} \\ \\mathrm{m}$.\n  - $V_{SB}$ values: $[0.0, 0.5] \\ \\mathrm{V}$.\n  - Measured $V_T$ values: $[0.5000, 0.5382] \\ \\mathrm{V}$.\n\nFinal output format:\nYour program should produce a single line of output containing the extracted $K1$ results for the five cases as a comma-separated list enclosed in square brackets (e.g., $[k1\\_A,k1\\_B,k1\\_C,k1\\_D,k1\\_E]$), where each $k1$ is a float in $\\sqrt{\\mathrm{V}}$, rounded to six decimal places.",
            "solution": "The solution involves two stages: first, a theoretical derivation of the threshold voltage body effect from first principles, and second, the implementation of a numerical algorithm to extract the body effect parameter $K1$ from measured data.\n\nFirst, we derive the relationship between the threshold voltage $V_T$ and the source-to-body bias $V_{SB}$. The foundation of this derivation lies in the electrostatics of the MOS capacitor structure.\n\nWe begin with the depletion approximation for a uniformly doped $p$-type semiconductor substrate with an acceptor concentration of $N_A$. Solving the one-dimensional Poisson equation yields the magnitude of the total depletion charge per unit area, $|Q_d|$, as a function of the total potential drop across the depletion region, $\\psi_{total}$:\n$$\n|Q_d| = \\sqrt{2q\\varepsilon_{\\mathrm{Si}}N_A \\psi_{total}}\n$$\nAt the threshold of strong inversion, this total potential drop must account for both the band bending required for inversion ($2\\phi_F$) and the applied source-to-body reverse bias ($V_{SB}$). Thus, $\\psi_{total} = 2\\phi_F + V_{SB}$. The Fermi potential $\\phi_F$ for a $p$-type substrate is given by $\\phi_F = \\frac{k_B T}{q}\\ln\\left(\\frac{N_A}{n_i}\\right)$.\n\nAt the threshold of strong inversion, the depletion charge magnitude is therefore:\n$$ |Q_{d,th}| = \\sqrt{2q\\varepsilon_{\\mathrm{Si}}N_A(2\\phi_F + V_{SB})} $$\nThe threshold voltage $V_T$ is the gate voltage $V_G$ required to achieve this condition. The gate voltage must balance the work function difference (accounted for in the flat-band voltage $V_{FB}$), establish the surface potential $2\\phi_F$, and counteract the depletion charge $Q_{d,th}$ (which is negative). The gate voltage equation, with all voltages relative to the body, is:\n$$ V_{GB} = V_{FB} + (2\\phi_F + V_{SB}) + \\frac{|Q_{d,th}|}{C_{ox}} $$\nwhere $C_{ox} = \\frac{\\varepsilon_{ox}}{t_{ox}}$ is the gate-oxide capacitance per unit area. Since $V_T = V_{GS}$ and $V_{GB} = V_{GS} + V_{SB} = V_T + V_{SB}$, we can substitute and cancel the $V_{SB}$ terms to find:\n$$ V_T = V_{FB} + 2\\phi_F + \\frac{|Q_{d,th}|}{C_{ox}} $$\nSubstituting the expression for $|Q_{d,th}|$:\n$$ V_T = V_{FB} + 2\\phi_F + \\frac{\\sqrt{2q\\varepsilon_{\\mathrm{Si}}N_A(2\\phi_F + V_{SB})}}{C_{ox}} $$\nThis equation can be rearranged to highlight the linear relationship requested in the problem statement. We can write:\n$$ V_T = \\left( V_{FB} + 2\\phi_F \\right) + \\left( \\frac{\\sqrt{2q\\varepsilon_{\\mathrm{Si}}N_A}}{C_{ox}} \\right) \\sqrt{2\\phi_F + V_{SB}} $$\nThis is a linear equation of the form $V_T = b + m x$, where the independent variable is $x = \\sqrt{2\\phi_F + V_{SB}}$, the intercept is $b = V_{FB} + 2\\phi_F$, and the slope is $m$. The problem identifies this slope as the BSIM parameter $K1$.\n$$ K1 = \\frac{\\sqrt{2q\\varepsilon_{\\mathrm{Si}}N_A}}{C_{ox}} $$\nThis expression explicitly demonstrates that $K1$ depends on the square root of the substrate doping $N_A$ and is inversely proportional to the gate-oxide capacitance per unit area $C_{ox}$.\n\nThe extraction method follows directly from this derived linear relationship. Given a set of measured data pairs $\\{(V_{SB,i}, V_{T,i})\\}$, we aim to find the best-fit slope of the line relating $V_{T,i}$ to $\\sqrt{2\\phi_F + V_{SB,i}}$.\n\nThe algorithm is as follows:\n1.  For a given test case with substrate doping $N_A$, first calculate the Fermi potential $\\phi_F$. The thermal voltage $V_{th} = \\frac{k_B T}{q}$ is computed using the given constants at $T = 300 \\ \\mathrm{K}$. Then, $\\phi_F = V_{th} \\ln\\left(\\frac{N_A}{n_i}\\right)$.\n2.  Construct the regressor data set $x_i$ and the response data set $y_i$. For each measured pair $(V_{SB,i}, V_{T,i})$:\n    -   $y_i = V_{T,i}$\n    -   $x_i = \\sqrt{2\\phi_F + V_{SB,i}}$\n3.  Perform a simple linear regression on the points $(x_i, y_i)$ to find the slope $m$ that minimizes the sum of squared errors.\n4.  The slope of this best-fit line, $m$, is the extracted value for the parameter $K1$. This can be found using the formula for the slope of a simple linear regression on $n$ data points:\n$$ m = \\frac{n \\sum(x_i y_i) - (\\sum x_i)(\\sum y_i)}{n \\sum(x_i^2) - (\\sum x_i)^2} $$\nThe extracted parameter of interest is the slope $m$, which represents $K1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the body effect parameter K1 for several MOSFET test cases.\n    The solution involves deriving the theoretical relationship for threshold voltage\n    and then using linear regression on provided data to extract K1.\n    \"\"\"\n    \n    # Physical constants\n    Q = 1.602176634e-19  # Elementary charge in C\n    EPSILON_0 = 8.854187817e-12  # Vacuum permittivity in F/m\n    EPSILON_SI = 11.7 * EPSILON_0  # Silicon permittivity in F/m\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    \n    # Problem-specific constants\n    T = 300.0  # Temperature in K\n    N_I = 1.0e16  # Intrinsic carrier concentration in m^-3\n\n    # Test suite definition\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"N_A\": 1.0e23,  # Substrate doping in m^-3\n            \"t_ox\": 3.0e-9,  # Oxide thickness in m\n            \"V_SB\": np.array([0.0, 0.2, 0.4, 0.6, 0.8]),  # V\n            \"V_T\": np.array([0.5000, 0.5164, 0.5313, 0.5450, 0.5580]),  # V\n        },\n        {\n            \"name\": \"Case B\",\n            \"N_A\": 1.0e23,  # m^-3\n            \"t_ox\": 1.0e-9,  # m\n            \"V_SB\": np.array([0.0, 0.3, 0.6, 0.9]),  # V\n            \"V_T\": np.array([0.4500, 0.4580, 0.4650, 0.4714]),  # V\n        },\n        {\n            \"name\": \"Case C\",\n            \"N_A\": 5.0e21,  # m^-3\n            \"t_ox\": 3.0e-9,  # m\n            \"V_SB\": np.array([0.0, 0.2, 0.4, 0.6]),  # V\n            \"V_T\": np.array([0.4000, 0.4040, 0.4076, 0.4109]),  # V\n        },\n        {\n            \"name\": \"Case D\",\n            \"N_A\": 5.0e24,  # m^-3\n            \"t_ox\": 5.0e-9,  # m\n            \"V_SB\": np.array([0.0, 0.1, 0.2, 0.3]),  # V\n            \"V_T\": np.array([0.7000, 0.7886, 0.8748, 0.9571]),  # V\n        },\n        {\n            \"name\": \"Case E\",\n            \"N_A\": 1.0e23,  # m^-3\n            \"t_ox\": 3.0e-9,  # m\n            \"V_SB\": np.array([0.0, 0.5]),  # V\n            \"V_T\": np.array([0.5000, 0.5382]),  # V\n        },\n    ]\n\n    results = []\n    \n    # Calculate thermal voltage (constant for all cases)\n    v_th = (K_B * T) / Q\n\n    for case in test_cases:\n        n_a = case[\"N_A\"]\n        vsb_values = case[\"V_SB\"]\n        vt_values = case[\"V_T\"]\n\n        # Step 1: Calculate the Fermi potential\n        phi_f = v_th * np.log(n_a / N_I)\n\n        # Step 2: Construct the regressor x and response y variables\n        # x = sqrt(2 * phi_F + V_SB)\n        # y = V_T\n        x_regressor = np.sqrt(2 * phi_f + vsb_values)\n        y_response = vt_values\n\n        # Step 3: Perform linear least-squares regression\n        # np.polyfit(x, y, deg) with deg=1 returns [slope, intercept]\n        # The slope is the extracted K1 parameter\n        slope, intercept = np.polyfit(x_regressor, y_response, 1)\n        \n        k1_extracted = slope\n        results.append(k1_extracted)\n\n    # Format the final output as specified\n    formatted_results = [f\"{round(r, 6):.6f}\" for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}