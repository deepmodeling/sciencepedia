{
    "hands_on_practices": [
        {
            "introduction": "The most fundamental model for an electrical interconnect is a simple, non-branching chain of resistors and capacitors, known as an RC ladder. Before tackling more complex tree structures, it's essential to master the delay calculation for this basic case. This first exercise  guides you through deriving and calculating the Elmore delay for a three-segment RC ladder, reinforcing the core principles of path resistance and capacitance.",
            "id": "4269413",
            "problem": "In Electronic Design Automation (EDA), interconnects on integrated circuits are frequently modeled as Resistive-Capacitive (RC) trees to predict signal propagation timing. Consider a linear RC tree (a series ladder) driven by an ideal step voltage source with negligible Thevenin resistance. The tree consists of three series resistors and three shunt capacitors to ground: resistor $R_1$ connects the source to node $1$, resistor $R_2$ connects node $1$ to node $2$, and resistor $R_3$ connects node $2$ to node $3$ (the far leaf output). A capacitor $C_1$ is connected from node $1$ to ground, a capacitor $C_2$ is connected from node $2$ to ground, and a capacitor $C_3$ is connected from node $3$ to ground. Assume no other loads and that the DC gain from input to the far leaf output is unity so that the output asymptotically reaches the input voltage.\n\nStarting from the definition of the impulse response $h(t)$ of a linear time-invariant RC network and the moment definition $m_1 = \\int_{0}^{\\infty} t\\,h(t)\\,dt$, derive an expression for the far leaf output delay as the first moment of the impulse response for this RC tree, expressed in terms of the resistors and capacitors of the network. Then, evaluate this delay for the parameter values $R_1 = 100\\,\\Omega$, $R_2 = 150\\,\\Omega$, $R_3 = 200\\,\\Omega$, $C_1 = 10\\,\\text{fF}$, $C_2 = 20\\,\\text{fF}$, and $C_3 = 30\\,\\text{fF}$.\n\nExpress your final numerical answer in picoseconds and round your answer to four significant figures.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a unique solution. The model of an RC tree and the Elmore delay are standard, fundamental concepts in the analysis of integrated circuits. Therefore, the problem is valid.\n\nThe goal is to derive an expression for the far leaf output delay of the given three-stage RC ladder network and then calculate its numerical value. The delay is defined as the first moment, $m_1$, of the impulse response, $h(t)$.\n\nLet $H(s)$ be the transfer function of the linear time-invariant (LTI) network, which is the Laplace transform of the impulse response $h(t)$:\n$$H(s) = \\mathcal{L}\\{h(t)\\} = \\int_{0}^{\\infty} h(t) e^{-st} \\,dt$$\nThe moments $m_k$ of the impulse response are defined as $m_k = \\int_{0}^{\\infty} t^k h(t) \\,dt$. The transfer function $H(s)$ can be expanded as a Maclaurin series around $s=0$:\n$$H(s) = \\sum_{k=0}^{\\infty} \\frac{1}{k!} \\frac{d^k H(s)}{ds^k}\\bigg|_{s=0} s^k$$\nBy differentiating $H(s)$ with respect to $s$, we find the relation between its derivatives at $s=0$ and the moments:\n$$\\frac{d^k H(s)}{ds^k} = \\int_{0}^{\\infty} (-t)^k h(t) e^{-st} \\,dt$$\n$$\\frac{d^k H(s)}{ds^k}\\bigg|_{s=0} = (-1)^k \\int_{0}^{\\infty} t^k h(t) \\,dt = (-1)^k m_k$$\nSubstituting this back into the Maclaurin series gives the moment expansion of the transfer function:\n$$H(s) = m_0 - m_1 s + \\frac{m_2}{2} s^2 - \\dots$$\nThe problem states that the DC gain is unity, which means $H(0)=1$. From the expansion, $H(0) = m_0$. Thus, $m_0 = \\int_{0}^{\\infty} h(t) \\,dt = 1$.\nThe delay is defined as the first moment, $m_1$. From the series, we can see that for small $s$, $H(s) \\approx 1 - m_1 s$. This implies that $m_1 = - \\frac{dH(s)}{ds}\\big|_{s=0}$.\n\nTo find $m_1$, we must first determine the transfer function $H(s) = V_3(s) / V_{in}(s)$ for the given RC ladder. We can use nodal analysis in the Laplace domain. Let $V_1(s)$, $V_2(s)$, and $V_3(s)$ be the node voltages. The impedances of the capacitors are $1/(sC_1)$, $1/(sC_2)$, and $1/(sC_3)$.\n\nThe nodal equations are:\nAt node 1: $\\frac{V_1(s) - V_{in}(s)}{R_1} + \\frac{V_1(s) - V_2(s)}{R_2} + sC_1 V_1(s) = 0$\nAt node 2: $\\frac{V_2(s) - V_1(s)}{R_2} + \\frac{V_2(s) - V_3(s)}{R_3} + sC_2 V_2(s) = 0$\nAt node 3: $\\frac{V_3(s) - V_2(s)}{R_3} + sC_3 V_3(s) = 0$\n\nWe can find the first-order approximation of $H(s)$ for small $s$ without solving this system completely.\nFrom the node 3 equation:\n$V_3(s) \\left(\\frac{1}{R_3} + sC_3\\right) = \\frac{V_2(s)}{R_3} \\implies V_3(s) = V_2(s) \\frac{1}{1+sR_3C_3}$\nFor small $s$, using the approximation $(1+x)^{-1} \\approx 1-x$:\n$V_3(s) \\approx V_2(s) (1 - sR_3C_3)$\n\nSubstitute this into the node 2 equation:\n$\\frac{V_2(s) - V_1(s)}{R_2} + \\frac{V_2(s) - V_2(s)(1 - sR_3C_3)}{R_3} + sC_2 V_2(s) = 0$\n$\\frac{V_2(s)}{R_2} - \\frac{V_1(s)}{R_2} + \\frac{sR_3C_3 V_2(s)}{R_3} + sC_2 V_2(s) = 0$\n$V_2(s) \\left(\\frac{1}{R_2} + sC_3 + sC_2\\right) = \\frac{V_1(s)}{R_2}$\n$V_2(s) = V_1(s) \\frac{1/R_2}{1/R_2 + s(C_2+C_3)} = V_1(s) \\frac{1}{1+sR_2(C_2+C_3)}$\nFor small $s$:\n$V_2(s) \\approx V_1(s) (1 - sR_2(C_2+C_3))$\n\nSubstitute this into the node 1 equation:\n$\\frac{V_1(s) - V_{in}(s)}{R_1} + \\frac{V_1(s) - V_1(s)(1 - sR_2(C_2+C_3))}{R_2} + sC_1 V_1(s) = 0$\n$\\frac{V_1(s)}{R_1} - \\frac{V_{in}(s)}{R_1} + \\frac{sR_2(C_2+C_3)V_1(s)}{R_2} + sC_1 V_1(s) = 0$\n$V_1(s) \\left(\\frac{1}{R_1} + s(C_2+C_3) + sC_1\\right) = \\frac{V_{in}(s)}{R_1}$\n$V_1(s) = V_{in}(s) \\frac{1/R_1}{1/R_1 + s(C_1+C_2+C_3)} = V_{in}(s) \\frac{1}{1+sR_1(C_1+C_2+C_3)}$\nFor small $s$:\n$V_1(s) \\approx V_{in}(s) (1-sR_1(C_1+C_2+C_3))$\n\nNow, combine the approximations to find $H(s) = V_3(s) / V_{in}(s)$:\n$V_3(s) \\approx V_2(s)(1-sR_3C_3) \\approx [V_1(s)(1-sR_2(C_2+C_3))](1-sR_3C_3)$\n$V_3(s) \\approx [V_{in}(s)(1-sR_1(C_1+C_2+C_3))](1-sR_2(C_2+C_3))(1-sR_3C_3)$\nExpanding and keeping terms up to the first order in $s$:\n$H(s) = \\frac{V_3(s)}{V_{in}(s)} \\approx 1 - sR_1(C_1+C_2+C_3) - sR_2(C_2+C_3) - sR_3C_3$\n$H(s) \\approx 1 - s [R_1(C_1+C_2+C_3) + R_2(C_2+C_3) + R_3C_3]$\nBy grouping terms by capacitors, we obtain the Elmore delay expression:\n$H(s) \\approx 1 - s [R_1C_1 + (R_1+R_2)C_2 + (R_1+R_2+R_3)C_3]$\nComparing this to $H(s) \\approx 1 - m_1 s$, the delay $m_1$, which we denote $\\tau_{D3}$, is:\n$$\\tau_{D3} = R_1C_1 + (R_1+R_2)C_2 + (R_1+R_2+R_3)C_3$$\nThis formula represents the Elmore delay at node $3$. Each term is the product of a capacitance $C_k$ and the total resistance $R_{3k}$ in the unique path from the source that is common to both node $3$ and node $k$.\n\nNow, we evaluate this expression for the given parameter values:\n$R_1 = 100\\,\\Omega$\n$R_2 = 150\\,\\Omega$\n$R_3 = 200\\,\\Omega$\n$C_1 = 10\\,\\text{fF} = 10 \\times 10^{-15}\\,\\text{F}$\n$C_2 = 20\\,\\text{fF} = 20 \\times 10^{-15}\\,\\text{F}$\n$C_3 = 30\\,\\text{fF} = 30 \\times 10^{-15}\\,\\text{F}$\n\nCalculate the resistance sums:\n$R_1 = 100\\,\\Omega$\n$R_1 + R_2 = 100\\,\\Omega + 150\\,\\Omega = 250\\,\\Omega$\n$R_1 + R_2 + R_3 = 100\\,\\Omega + 150\\,\\Omega + 200\\,\\Omega = 450\\,\\Omega$\n\nSubstitute these values into the delay expression:\n$\\tau_{D3} = (100\\,\\Omega)(10 \\times 10^{-15}\\,\\text{F}) + (250\\,\\Omega)(20 \\times 10^{-15}\\,\\text{F}) + (450\\,\\Omega)(30 \\times 10^{-15}\\,\\text{F})$\n$\\tau_{D3} = (1000 \\times 10^{-15})\\,\\text{s} + (5000 \\times 10^{-15})\\,\\text{s} + (13500 \\times 10^{-15})\\,\\text{s}$\n$\\tau_{D3} = (1000 + 5000 + 13500) \\times 10^{-15}\\,\\text{s}$\n$\\tau_{D3} = 19500 \\times 10^{-15}\\,\\text{s}$\n$\\tau_{D3} = 19.5 \\times 10^{-12}\\,\\text{s}$\nSince $1$ picosecond (ps) is $10^{-12}$ seconds, the delay is:\n$\\tau_{D3} = 19.5\\,\\text{ps}$\n\nThe problem requires the answer to be rounded to four significant figures.\n$19.50\\,\\text{ps}$",
            "answer": "$$\\boxed{19.50}$$"
        },
        {
            "introduction": "Real-world interconnects rarely follow a simple linear path; they branch out to connect with multiple components. This second practice  introduces a branching node, transforming the RC ladder into a true RC tree. By working through this problem, you will develop a deeper intuition for how current splits and how the capacitance of one branch influences the delay on a sibling branch through their shared resistive path.",
            "id": "4269384",
            "problem": "A single input resistive-capacitive tree is driven by an ideal voltage step source of amplitude $V_{\\text{DD}}$ and zero source resistance. The source connects through a series resistor $R_{0}$ to an internal node $0$. From node $0$, two branches split: one branch connects through a resistor $R_{a}$ to leaf node $a$, and the other branch connects through a resistor $R_{b}$ to leaf node $b$. Each node $i \\in \\{0,a,b\\}$ has a lumped capacitance $C_{i}$ to ground. There are no other resistances to ground, no coupling capacitances, and all interconnect capacitances are lumped into $C_{0}$, $C_{a}$, and $C_{b}$. Assume linear time-invariant behavior and that the graph of resistors is a tree. Using only Kirchhoff’s laws, conservation of charge, and the definition of the first time moment of the impulse response for a linear resistive-capacitive tree, derive from first principles an expression for the Elmore delay to leaf node $a$ and then evaluate it for the following parameter values: $R_{0}=50\\,\\Omega$, $R_{a}=100\\,\\Omega$, $R_{b}=200\\,\\Omega$, $C_{0}=5\\,\\text{fF}$, $C_{a}=15\\,\\text{fF}$, and $C_{b}=25\\,\\text{fF}$. Express the final delay at node $a$ in picoseconds and round your result to three significant figures.",
            "solution": "The problem requires the derivation of the Elmore delay to leaf node $a$ from first principles, followed by a numerical evaluation. The derivation must be based on Kirchhoff’s laws, conservation of charge, and the definition of the first time moment of the impulse response.\n\nFirst, let us define the Elmore delay. For a linear time-invariant (LTI) system, the delay at an output node $i$ can be characterized by the first moment of the impulse response at that node, $h_i(t)$. The Elmore delay, $\\tau_{Di}$, is defined as:\n$$ \\tau_{Di} = \\int_{0}^{\\infty} t h_i(t) \\,dt $$\nwhere the impulse response is normalized such that its integral over all time is unity, $\\int_{0}^{\\infty} h_i(t) \\,dt = 1$.\n\nThe problem describes a voltage step input of amplitude $V_{\\text{DD}}$. Let $v_i(t)$ be the voltage response at node $i$ to this step input, $v_{\\text{in}}(t) = V_{\\text{DD}} u(t)$, where $u(t)$ is the Heaviside step function. For an LTI system, the impulse response is the time derivative of the step response, scaled by the input step amplitude. For our circuit, which is an RC tree, the final steady-state voltage at any node $i$ is $V_{\\text{DD}}$. Therefore, the normalized impulse response is $h_i(t) = \\frac{1}{V_{\\text{DD}}} \\frac{d v_i(t)}{dt}$.\n\nSubstituting this into the definition of Elmore delay for node $a$:\n$$ \\tau_{Da} = \\int_{0}^{\\infty} t \\left( \\frac{1}{V_{\\text{DD}}} \\frac{d v_a(t)}{dt} \\right) \\,dt = \\frac{1}{V_{\\text{DD}}} \\int_{0}^{\\infty} t \\frac{d v_a(t)}{dt} \\,dt $$\nWe can evaluate the integral using integration by parts, $\\int u \\,dv = uv - \\int v \\,du$. Let $u=t$ and $dv = \\frac{d v_a(t)}{dt} \\,dt$. Then $du=\\,dt$ and $v=v_a(t)$.\n$$ \\int_{0}^{\\infty} t \\frac{d v_a(t)}{dt} \\,dt = \\left[ t v_a(t) \\right]_{0}^{\\infty} - \\int_{0}^{\\infty} v_a(t) \\,dt $$\nThe boundary term $\\left[ t v_a(t) \\right]_{0}^{\\infty}$ needs careful evaluation. At $t=0$, the term is $0$. As $t \\rightarrow \\infty$, $v_a(t)$ approaches its steady-state value $V_{\\text{DD}}$. The transient response of a stable RC circuit decays exponentially, so we can write $v_a(t) = V_{\\text{DD}} - f(t)$, where $f(t)$ contains terms like $e^{-t/\\tau_{\\text{pole}}}$ that approach zero faster than $1/t$. Therefore, $\\lim_{t\\to\\infty} t(V_{\\text{DD}} - v_a(t)) = 0$.\nThe integral identity can be established as:\n$$ \\int_{0}^{\\infty} (V_{\\text{DD}} - v_a(t)) \\,dt = \\int_{0}^{\\infty} t \\frac{d v_a(t)}{dt} \\,dt $$\nThis formulation connects the first moment of the impulse response to the area over the step response transient. The Elmore delay can thus be expressed as:\n$$ \\tau_{Da} = \\frac{1}{V_{\\text{DD}}} \\int_{0}^{\\infty} (V_{\\text{DD}} - v_a(t)) \\,dt $$\nNow, we apply Kirchhoff's Voltage Law (KVL). The voltage difference $V_{\\text{DD}} - v_a(t)$ is the total voltage drop along the unique resistive path from the input source to node $a$. The circuit topology is as follows: Source $\\rightarrow R_0 \\rightarrow$ node $0 \\rightarrow R_a \\rightarrow$ node $a$.\nLet $I_{R0}(t)$ be the current through $R_0$ (from source to node $0$) and $I_{Ra}(t)$ be the current through $R_a$ (from node $0$ to node $a$). The voltage drops are given by Ohm's law.\nFor $t>0$, $v_{\\text{in}}(t) = V_{\\text{DD}}$.\n$$ V_{\\text{DD}} - v_a(t) = (V_{\\text{DD}} - v_0(t)) + (v_0(t) - v_a(t)) = I_{R0}(t)R_0 + I_{Ra}(t)R_a $$\nSubstituting this into the integral expression for $\\tau_{Da}$:\n$$ \\tau_{Da} = \\frac{1}{V_{\\text{DD}}} \\int_{0}^{\\infty} \\left( I_{R0}(t)R_0 + I_{Ra}(t)R_a \\right) \\,dt $$\n$$ \\tau_{Da} = \\frac{1}{V_{\\text{DD}}} \\left( R_0 \\int_{0}^{\\infty} I_{R0}(t) \\,dt + R_a \\int_{0}^{\\infty} I_{Ra}(t) \\,dt \\right) $$\nNext, we invoke the principle of conservation of charge. The integral of current over time, $\\int_{0}^{\\infty} I(t) \\,dt$, represents the total charge, $Q$, that has flowed. This charge must be accumulated on the capacitors to change their voltage from the initial state ($0$) to the final state ($V_{\\text{DD}}$). The charge on a capacitor is $Q=CV$.\n\nThe current $I_{R0}(t)$ through the resistor $R_0$ supplies the charge required to charge all capacitors in the tree: $C_0$, $C_a$, and $C_b$. The total charge supplied is:\n$$ \\int_{0}^{\\infty} I_{R0}(t) \\,dt = Q_{\\text{total}} = C_0 \\Delta V_0 + C_a \\Delta V_a + C_b \\Delta V_b $$\nSince $\\Delta V_0 = \\Delta V_a = \\Delta V_b = V_{\\text{DD}} - 0 = V_{\\text{DD}}$, we have:\n$$ \\int_{0}^{\\infty} I_{R0}(t) \\,dt = (C_0 + C_a + C_b) V_{\\text{DD}} $$\nThe current $I_{Ra}(t)$ through the resistor $R_a$ supplies charge only to the capacitor at node $a$, as it is a leaf node.\n$$ \\int_{0}^{\\infty} I_{Ra}(t) \\,dt = C_a \\Delta V_a = C_a V_{\\text{DD}} $$\nNow, we substitute these charge expressions back into the equation for $\\tau_{Da}$:\n$$ \\tau_{Da} = \\frac{1}{V_{\\text{DD}}} \\left[ R_0 (C_0 + C_a + C_b) V_{\\text{DD}} + R_a (C_a V_{\\text{DD}}) \\right] $$\nThe $V_{\\text{DD}}$ terms cancel, yielding the final expression for the Elmore delay at node $a$:\n$$ \\tau_{Da} = R_0 (C_0 + C_a + C_b) + R_a C_a $$\nThis completes the derivation from first principles.\n\nNow, we evaluate this expression using the given parameter values:\n$R_{0}=50\\,\\Omega$\n$R_{a}=100\\,\\Omega$\n$C_{0}=5\\,\\text{fF} = 5 \\times 10^{-15}\\,\\text{F}$\n$C_{a}=15\\,\\text{fF} = 15 \\times 10^{-15}\\,\\text{F}$\n$C_{b}=25\\,\\text{fF} = 25 \\times 10^{-15}\\,\\text{F}$\n\nSubstitute the values into the derived formula:\n$$ \\tau_{Da} = (50\\,\\Omega) (5 \\times 10^{-15}\\,\\text{F} + 15 \\times 10^{-15}\\,\\text{F} + 25 \\times 10^{-15}\\,\\text{F}) + (100\\,\\Omega) (15 \\times 10^{-15}\\,\\text{F}) $$\n$$ \\tau_{Da} = (50\\,\\Omega) (45 \\times 10^{-15}\\,\\text{F}) + (100\\,\\Omega) (15 \\times 10^{-15}\\,\\text{F}) $$\nThe product of Ohms and Farads gives seconds ($\\Omega \\cdot \\text{F} = \\frac{V}{I} \\cdot \\frac{Q}{V} = \\frac{Q}{I} = \\frac{I \\cdot t}{I} = t$).\n$$ \\tau_{Da} = (50 \\times 45 \\times 10^{-15})\\,\\text{s} + (100 \\times 15 \\times 10^{-15})\\,\\text{s} $$\n$$ \\tau_{Da} = (2250 \\times 10^{-15})\\,\\text{s} + (1500 \\times 10^{-15})\\,\\text{s} $$\n$$ \\tau_{Da} = 3750 \\times 10^{-15}\\,\\text{s} $$\nThe problem asks for the answer in picoseconds ($1\\,\\text{ps} = 10^{-12}\\,\\text{s}$) and rounded to three significant figures.\n$$ \\tau_{Da} = 3750 \\times 10^{-15}\\,\\text{s} = 3.750 \\times 10^{-12}\\,\\text{s} = 3.75\\,\\text{ps} $$\nThe result $3.75$ already has three significant figures.",
            "answer": "$$\\boxed{3.75}$$"
        },
        {
            "introduction": "While manual calculation is instructive for small circuits, modern integrated circuits contain millions of interconnects, demanding efficient, automated analysis. This final exercise  challenges you to transition from case-by-case formulas to a general, scalable algorithm. Designing a linear-time algorithm to compute Elmore delays for any arbitrary RC tree structure mirrors the core task of timing analysis engines in real-world Electronic Design Automation (EDA) tools.",
            "id": "4269394",
            "problem": "A resistive-capacitive (RC) tree models an interconnect in integrated circuits within Electronic Design Automation (EDA). The tree is rooted at a driver node and consists of edges that are resistors and nodes that are capacitors to ground. For a unit step excitation at the root, the step response at a leaf is approximated by the Elmore delay, which is the first moment of the impulse response of the corresponding linear time-invariant system. Starting from Kirchhoff’s Current Law (KCL), Kirchhoff’s Voltage Law (KVL), and linear time-invariance, the Elmore delay can be derived as the path-wise accumulation of contributions that combine upstream resistance with downstream capacitance. The goal is to compute the Elmore delay to each leaf efficiently.\n\nDesign a linear-time algorithm, based on a single Depth-First Search (DFS), that computes the delay $t_{d}$ at all leaves. The algorithm must traverse the tree once, accumulating upstream resistance information and downstream capacitance sums per edge in a way that ensures each edge and node is processed a constant number of times. Your approach must begin from the principle that the first moment of the impulse response determines an effective delay and must explain why aggregating upstream resistance and downstream capacitance on edges suffices to compute $t_{d}$ at leaves without re-traversing the tree.\n\nYour program must implement this algorithm and apply it to the following test suite. In each case, treat the given structure as a rooted tree, with the specified root node index, edge resistances, and node capacitances. Express all delays in seconds (s). The output should be a single line containing a list of lists; each inner list should contain the leaf delays for that test case, ordered by ascending leaf node index. All numeric results must be expressed as floating-point numbers in seconds. No units should appear in the printed output; the unit specification here is binding for interpretation.\n\nTest Suite:\n\n- Case $1$ (balanced branching):\n  - Nodes: indices $0$ to $6$, root at node $0$.\n  - Edges with resistances in ohms ($\\Omega$): $(0\\rightarrow 1, R=100)$, $(0\\rightarrow 2, R=80)$, $(1\\rightarrow 3, R=50)$, $(1\\rightarrow 4, R=70)$, $(2\\rightarrow 5, R=60)$, $(2\\rightarrow 6, R=90)$.\n  - Node capacitances in farads ($\\mathrm{F}$): $C_0=0.2\\times 10^{-12}$, $C_1=0.3\\times 10^{-12}$, $C_2=0.25\\times 10^{-12}$, $C_3=1.0\\times 10^{-12}$, $C_4=0.6\\times 10^{-12}$, $C_5=0.9\\times 10^{-12}$, $C_6=0.5\\times 10^{-12}$.\n  - Leaves: nodes $3,4,5,6$.\n\n- Case $2$ (single chain boundary):\n  - Nodes: indices $0$ to $2$, root at node $0$.\n  - Edges with resistances in $\\Omega$: $(0\\rightarrow 1, R=120)$, $(1\\rightarrow 2, R=130)$.\n  - Node capacitances in $\\mathrm{F}$: $C_0=0.1\\times 10^{-12}$, $C_1=0.2\\times 10^{-12}$, $C_2=1.5\\times 10^{-12}$.\n  - Leaves: node $2$.\n\n- Case $3$ (internal zero capacitance edge case):\n  - Nodes: indices $0$ to $3$, root at node $0$.\n  - Edges with resistances in $\\Omega$: $(0\\rightarrow 1, R=200)$, $(1\\rightarrow 2, R=50)$, $(1\\rightarrow 3, R=60)$.\n  - Node capacitances in $\\mathrm{F}$: $C_0=0.2\\times 10^{-12}$, $C_1=0.0\\times 10^{-12}$, $C_2=0.8\\times 10^{-12}$, $C_3=0.4\\times 10^{-12}$.\n  - Leaves: nodes $2,3$.\n\n- Case $4$ (heterogeneous branching and depth):\n  - Nodes: indices $0$ to $9$, root at node $0$.\n  - Edges with resistances in $\\Omega$: $(0\\rightarrow 1, R=75)$, $(1\\rightarrow 2, R=40)$, $(2\\rightarrow 3, R=30)$, $(1\\rightarrow 4, R=55)$, $(0\\rightarrow 5, R=65)$, $(5\\rightarrow 6, R=45)$, $(5\\rightarrow 7, R=35)$, $(7\\rightarrow 8, R=25)$, $(7\\rightarrow 9, R=20)$.\n  - Node capacitances in $\\mathrm{F}$: $C_0=0.15\\times 10^{-12}$, $C_1=0.2\\times 10^{-12}$, $C_2=0.05\\times 10^{-12}$, $C_3=1.2\\times 10^{-12}$, $C_4=0.7\\times 10^{-12}$, $C_5=0.25\\times 10^{-12}$, $C_6=0.9\\times 10^{-12}$, $C_7=0.1\\times 10^{-12}$, $C_8=0.4\\times 10^{-12}$, $C_9=0.3\\times 10^{-12}$.\n  - Leaves: nodes $3,4,6,8,9$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets, for example, $[\\,[d_{1,1},d_{1,2},\\dots],\\,[d_{2,1},\\dots],\\dots\\,]$, where each $d_{i,j}$ is a floating-point number in seconds corresponding to the Elmore delay at the $j$-th leaf of the $i$-th test case. The results for each test case must list leaf delays in ascending order of leaf node indices.",
            "solution": "The problem of computing the Elmore delay at the leaves of a resistive-capacitive (RC) tree is a well-defined problem in electrical engineering, specifically in the analysis of interconnects in integrated circuits. The problem statement is scientifically grounded, self-contained, and objective. We can therefore proceed with a formal solution.\n\n**1. Theoretical Foundation of Elmore Delay**\n\nThe Elmore delay is a first-order approximation for the delay of an RC circuit. For a linear time-invariant (LTI) system, the response to a unit step input at time $t=0$ is related to its impulse response. The Elmore delay $t_{Di}$ at a node $i$ is defined as the first moment of the impulse response $h_i(t)$ at that node:\n$$ t_{Di} = \\int_0^\\infty t h_i(t) \\,dt $$\nThis definition can be shown to be equivalent to the expression derived from circuit analysis. For an RC tree rooted at node $0$ and driven by a voltage source, the Elmore delay at any node $i$ is given by:\n$$ t_{Di} = \\sum_{k=0}^{N-1} R_{ik} C_k $$\nwhere $N$ is the number of nodes in the tree, $C_k$ is the capacitance at node $k$, and $R_{ik}$ is the resistance of the path from the root that is common to both the path to node $i$ and the path to node $k$. We can express $R_{ik}$ as the sum of resistances of edges $e_j$ on the shared path:\n$$ R_{ik} = \\sum_{e_j \\in \\text{path}(0,i) \\cap \\text{path}(0,k)} R_j $$\nwhere $R_j$ is the resistance of edge $e_j$.\n\n**2. Derivation of the Linear-Time Algorithm**\n\nThe quadratic complexity of computing the sum over all pairs of nodes $(i, k)$ makes the above formula inefficient for large circuits. A more efficient, linear-time algorithm can be derived by restructuring the summation. By swapping the order of summation, we can group terms by resistance instead of capacitance:\n$$ t_{Di} = \\sum_{k=0}^{N-1} C_k \\left( \\sum_{e_j \\in \\text{path}(0,i) \\cap \\text{path}(0,k)} R_j \\right) = \\sum_{e_j} R_j \\left( \\sum_{k \\text{ s.t. } e_j \\in \\text{path}(0,i) \\cap \\text{path}(0,k)} C_k \\right) $$\nLet an edge $e_j$ connect a parent node $u_j$ to a child node $v_j$. The condition $e_j \\in \\text{path}(0, i) \\cap \\text{path}(0, k)$ means two things:\n1.  The edge $e_j$ must be on the path from the root to node $i$.\n2.  The edge $e_j$ must also be on the path from the root to node $k$. This implies that node $k$ must be in the subtree rooted at $v_j$.\n\nTherefore, for a given edge $e_j=(u_j, v_j)$ on the path to node $i$, the inner sum accumulates the capacitance of all nodes $k$ in the subtree of its child node $v_j$. This sum is precisely the \"downstream capacitance\" of node $v_j$, which we denote as $C_{\\text{down}}(v_j)$.\n$$ C_{\\text{down}}(v_j) = \\sum_{k \\in \\text{subtree}(v_j)} C_k $$\nSubstituting this back, the Elmore delay at node $i$ is the sum of products of each edge resistance on the path from the root to $i$ and the total capacitance downstream of that edge:\n$$ t_{Di} = \\sum_{e_j=(u_j,v_j) \\in \\text{path}(0,i)} R_j \\cdot C_{\\text{down}}(v_j) $$\nThis expression is the core of the linear-time algorithm. It directly corresponds to the problem's description of \"path-wise accumulation of contributions that combine upstream resistance with downstream capacitance.\"\n\n**3. Algorithmic Design**\n\nThe formula for $t_{Di}$ reveals a clear computational dependency. To calculate the delay at any node, we need:\n1.  The downstream capacitance $C_{\\text{down}}(v)$ for various nodes $v$ on the path.\n2.  The path structure itself.\n\nThis suggests a two-pass algorithm executed over a single traversal of the tree's data structure, which is consistent with the problem's requirement for a \"single Depth-First Search\" that processes each edge a constant number of times.\n\n**Pass 1: Post-Order Traversal to Compute Downstream Capacitance**\nA post-order traversal (a form of DFS) naturally facilitates the bottom-up computation of downstream capacitances. When visiting a node $u$, we first recursively visit all its children. Upon returning from the recursive calls, the downstream capacitances for all children are known. The downstream capacitance of $u$ can then be computed as its own capacitance plus the sum of the downstream capacitances of its children:\n$$ C_{\\text{down}}(u) = C_u + \\sum_{v \\in \\text{children}(u)} C_{\\text{down}}(v) $$\nThis pass starts from the leaves and moves up to the root, populating an array of $C_{\\text{down}}$ values for every node in the tree.\n\n**Pass 2: Pre-Order Traversal to Compute Elmore Delay**\nWith all $C_{\\text{down}}$ values pre-computed, a pre-order traversal (another form of DFS) can compute the delays in a top-down manner. The Elmore delay $t_{Di}$ can be expressed recursively. The delay at the root, $t_{D0}$, is $0$. For any other node $i$ with parent $p$, the path to $i$ is the path to $p$ extended by the edge $(p,i)$. Therefore:\n$$ t_{Di} = t_{Dp} + R_{pi} \\cdot C_{\\text{down}}(i) $$\nwhere $R_{pi}$ is the resistance of the edge from $p$ to $i$. This recursive formula allows us to compute the delay for each node by taking its parent's delay and adding the new contribution from the connecting edge. A pre-order traversal starting from the root with an initial delay of $0$ perfectly implements this top-down accumulation.\n\n**Summary of the Algorithm**\n1.  Represent the RC tree using an adjacency list, where for each parent node, we store a list of its children and the corresponding edge resistances.\n2.  Perform a post-order DFS traversal starting from the root to compute and store the downstream capacitance $C_{\\text{down}}(u)$ for every node $u$.\n3.  Perform a pre-order DFS traversal starting from the root to compute and store the Elmore delay $t_{Du}$ for every node $u$, using the recursive delay formula and the pre-computed $C_{\\text{down}}$ values.\n4.  For each test case, extract the computed delays for the specified leaf nodes and order them by ascending node index.\n\nEach pass visits every node and edge once. The total time complexity is $O(N+E)$, where $N$ is the number of nodes and $E$ is the number of edges. For a tree, $E=N-1$, so the complexity is $O(N)$, fulfilling the linear-time requirement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the solving of all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (balanced branching)\n        {\n            \"num_nodes\": 7,\n            \"root\": 0,\n            \"edges\": [(0, 1, 100), (0, 2, 80), (1, 3, 50), (1, 4, 70), (2, 5, 60), (2, 6, 90)],\n            \"capacitances\": [0.2e-12, 0.3e-12, 0.25e-12, 1.0e-12, 0.6e-12, 0.9e-12, 0.5e-12],\n            \"leaves\": [3, 4, 5, 6]\n        },\n        # Case 2 (single chain boundary)\n        {\n            \"num_nodes\": 3,\n            \"root\": 0,\n            \"edges\": [(0, 1, 120), (1, 2, 130)],\n            \"capacitances\": [0.1e-12, 0.2e-12, 1.5e-12],\n            \"leaves\": [2]\n        },\n        # Case 3 (internal zero capacitance edge case)\n        {\n            \"num_nodes\": 4,\n            \"root\": 0,\n            \"edges\": [(0, 1, 200), (1, 2, 50), (1, 3, 60)],\n            \"capacitances\": [0.2e-12, 0.0, 0.8e-12, 0.4e-12],\n            \"leaves\": [2, 3]\n        },\n        # Case 4 (heterogeneous branching and depth)\n        {\n            \"num_nodes\": 10,\n            \"root\": 0,\n            \"edges\": [(0, 1, 75), (1, 2, 40), (2, 3, 30), (1, 4, 55), (0, 5, 65), (5, 6, 45), (5, 7, 35), (7, 8, 25), (7, 9, 20)],\n            \"capacitances\": [0.15e-12, 0.2e-12, 0.05e-12, 1.2e-12, 0.7e-12, 0.25e-12, 0.9e-12, 0.1e-12, 0.4e-12, 0.3e-12],\n            \"leaves\": [3, 4, 6, 8, 9]\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        delays = calculate_elmore_delays(\n            case[\"num_nodes\"],\n            case[\"edges\"],\n            case[\"capacitances\"],\n            case[\"root\"],\n            case[\"leaves\"]\n        )\n        all_results.append(delays)\n\n    # Format the final output string as specified\n    formatted_results = [f\"[{','.join(f'{d:.16g}' for d in res)}]\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_elmore_delays(num_nodes, edges, capacitances_list, root, leaves):\n    \"\"\"\n    Computes Elmore delays for specified a RC tree and its leaf nodes.\n    \n    The algorithm uses a two-pass DFS approach:\n    1. A post-order DFS to calculate the downstream capacitance for each node.\n    2. A pre-order DFS to calculate the Elmore delay for each node.\n    \n    Args:\n        num_nodes (int): The number of nodes in the tree (indexed 0 to num_nodes-1).\n        edges (list of tuples): Each tuple represents an edge (parent, child, resistance).\n        capacitances_list (list of float): Capacitance value for each node.\n        root (int): The index of the root node.\n        leaves (list of int): A list of indices of the leaf nodes.\n\n    Returns:\n        list of float: The Elmore delays for the leaf nodes, sorted by node index.\n    \"\"\"\n    # Adjacency list representation: adj[parent] = [(child, resistance), ...]\n    adj = [[] for _ in range(num_nodes)]\n    for parent, child, resistance in edges:\n        adj[parent].append((child, resistance))\n    \n    capacitances = np.array(capacitances_list, dtype=float)\n    downstream_capacitances = np.zeros(num_nodes, dtype=float)\n    elmore_delays = np.zeros(num_nodes, dtype=float)\n\n    # --- Pass 1: Post-order DFS to compute downstream capacitances ---\n    # Stack for iterative DFS to avoid deep recursion issues (though not critical here)\n    # The order of nodes pushed ensures post-order processing\n    visited_capacitance = [False] * num_nodes\n    dfs_order = []\n    stack = [root]\n    while stack:\n        u = stack.pop()\n        if not visited_capacitance[u]:\n            visited_capacitance[u] = True\n            dfs_order.append(u)\n            for v, _ in adj[u]:\n                stack.append(v)\n    \n    # Process nodes in reverse order of discovery (post-order traversal)\n    for u in reversed(dfs_order):\n        cap_sum = capacitances[u]\n        for v, _ in adj[u]:\n            cap_sum += downstream_capacitances[v]\n        downstream_capacitances[u] = cap_sum\n\n    # --- Pass 2: Pre-order DFS to compute Elmore delays ---\n    # The recursive formulation t_d(i) = t_d(parent(i)) + R_edge * C_down(i) is what we implement.\n    # Note that the delay at a node `u` is the sum of R*C_down terms on the path from the root.\n    # The delay up to the parent is t_d(p). The delay of the child is t_d(c) = t_d(p) + R_pc * C_down(c).\n    # The delay at the root is typically defined from the point of view of the root's own RC segment.\n    # The Elmore delay formula is t_Di = sum_k R_ik C_k.\n    # For the root node (0), the shared path resistance R_0k is 0 unless k=0. So t_D0 = R_00 * C_0 = 0.\n    \n    stack = [(root, 0.0)]\n    \n    while stack:\n        u, parent_path_delay = stack.pop()\n        \n        # Contribution from parent's edge already included in parent_path_delay\n        elmore_delays[u] = parent_path_delay\n        \n        # Add children to stack for next iteration.\n        for v, resistance in adj[u]:\n            # The delay at child v is the delay at parent u, plus the term for edge (u,v).\n            # The term is R_uv * C_down(v).\n            child_path_delay = elmore_delays[u] + resistance * downstream_capacitances[v]\n            stack.append((v, child_path_delay))\n\n    # Extract delays for leaf nodes, ordered by ascending leaf index\n    leaf_delays = [elmore_delays[leaf_idx] for leaf_idx in sorted(leaves)]\n    \n    return leaf_delays\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}