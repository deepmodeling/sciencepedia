{
    "hands_on_practices": [
        {
            "introduction": "在现代集成电路中，互连电阻的精确建模至关重要。本练习超越了理想导线的简单计算，探讨了实际制造工艺（如双镶嵌工艺）中引入的阻挡层如何影响电阻。通过计算存在非导电衬垫层时电阻的增加，您将亲身体会到工艺细节对电气性能的直接影响，这是进行精确寄生参数提取所必需的一项核心技能。",
            "id": "4277454",
            "problem": "在电子设计自动化（EDA）框架下设计的集成电路中，一条双大马士革铜互连线被图案化，其标称金属宽度为 $W$，厚度为 $t$，并在沟槽的侧壁和底部包含一层厚度为 $t_{\\mathrm{liner}}$ 的保形阻挡层/衬垫。假设衬垫材料对直流电完全阻断（即不导电），并且铜的电阻率 $\\rho$ 在给定值上保持均匀。该互连线段长度为 $L$，且沿其长度均匀。\n\n仅从均匀介质中稳态导电的基本本构关系和几何推理出发，确定：\n- 没有衬垫时互连线的电阻，以及\n- 存在衬垫时（减小了侧壁和底部的有效铜横截面积）互连线的电阻，\n然后量化由衬垫引起的电阻分数增加量，以单个小数表示（不使用百分号）。\n\n使用以下参数：\n- 铜电阻率 $\\rho = 3.0 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}$，\n- 标称宽度 $W = 40\\,\\mathrm{nm}$，\n- 标称厚度 $t = 80\\,\\mathrm{nm}$，\n- 段长度 $L = 1.0\\,\\mathrm{mm}$，\n- 衬垫厚度 $t_{\\mathrm{liner}} = 5.0\\,\\mathrm{nm}$。\n\n对于有衬垫的情况，将有效铜宽度建模为 $W - 2\\,t_{\\mathrm{liner}}$，将有效铜厚度建模为 $t - t_{\\mathrm{liner}}$。以 $\\Omega$ 为单位表示电阻，分数增加量以小数表示。将这两个量都四舍五入到四位有效数字。最终答案必须按顺序包含带衬垫的电阻和分数增加量，作为一个复合响应。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **物理系统**：一条长度为 $L$、标称宽度为 $W$、标称厚度为 $t$ 的双大马士革铜互连线。\n- **材料**：电阻率均匀为 $\\rho$ 的铜。在侧壁和底部有一层厚度为 $t_{\\mathrm{liner}}$ 的保形阻挡层/衬垫。\n- **假设**：衬垫材料是完美的电绝缘体。\n- **本构关系**：问题要求从稳态导电的基本本构关系和几何推理出发。\n- **有衬垫情况的建模**：\n    - 有效铜宽度定义为 $W_{\\mathrm{eff}} = W - 2t_{\\mathrm{liner}}$。\n    - 有效铜厚度定义为 $t_{\\mathrm{eff}} = t - t_{\\mathrm{liner}}$。\n- **参数**：\n    - 铜电阻率，$\\rho = 3.0 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}$。\n    - 标称宽度，$W = 40\\,\\mathrm{nm}$。\n    - 标称厚度，$t = 80\\,\\mathrm{nm}$。\n    - 段长度，$L = 1.0\\,\\mathrm{mm}$。\n    - 衬垫厚度，$t_{\\mathrm{liner}} = 5.0\\,\\mathrm{nm}$。\n- **要求输出**：\n    - 带衬垫的互连线电阻，单位为 $\\Omega$，四舍五入到四位有效数字。\n    - 由衬垫引起的电阻分数增加量，以小数表示，四舍五入到四位有效数字。\n    - 最终答案必须是按顺序包含这两个值的复合响应。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题在电传导原理方面有充分的依据。电阻公式 $R = \\rho L/A$ 是一个基本的本构关系。衬垫减小互连线导电横截面积的情景是现代集成电路设计和EDA中的一个标准且关键的概念。\n- **适定性**：该问题是适定的。它提供了一个清晰的物理模型、所有必要的参数，以及对带衬垫导体几何形状的明确定义，从而可以得到唯一解。\n- **客观性**：该问题以客观的技术语言陈述，没有歧义或主观断言。\n- **完整性和一致性**：该问题是自洽的。计算所需的所有变量都已提供。计算有效面积的模型已明确给出，避免了歧义。所提供的数据或假设中没有矛盾。\n- **真实性和可行性**：给定的尺寸（$40\\,\\mathrm{nm}$ 宽度，$5\\,\\mathrm{nm}$ 衬垫）代表了半导体制造业中的先进技术节点。电阻率值对于薄膜铜是现实的，由于电子散射效应，薄膜铜的电阻率通常高于其块体对应物。问题设置是一个在工程实践中使用的标准（尽管简化了的）模型。\n\n### 步骤3：结论与行动\n该问题在科学上是合理的、适定的和完整的。它代表了一个有效且相关的工程问题。因此，将提供完整的解答。\n\n### 解题推导\n对于一个长度为 $L$、均匀横截面积为 $A$、均匀电阻率为 $\\rho$ 的棱柱形导体，其电阻 $R$ 的基本本构关系为：\n$$ R = \\frac{\\rho L}{A} $$\n\n我们将按规定分析两种情况：无衬垫时的电阻和有衬垫时的电阻。\n\n**情况1：无衬垫的互连线**\n设 $R_0$ 为无衬垫时互连线的电阻。其横截面为宽度为 $W$、厚度为 $t$ 的矩形。横截面积 $A_0$ 为：\n$$ A_0 = Wt $$\n因此，电阻为：\n$$ R_0 = \\frac{\\rho L}{A_0} = \\frac{\\rho L}{Wt} $$\n\n**情况2：有衬垫的互连线**\n设 $R_{\\mathrm{liner}}$ 为有衬垫时互连线的电阻。问题陈述指出，衬垫位于沟槽的底部和两个侧壁上。因此，导电铜芯的尺寸减小。问题为铜的有效尺寸提供了一个特定模型：\n- 有效宽度因两侧的衬垫而减小：$W_{\\mathrm{eff}} = W - 2t_{\\mathrm{liner}}$。\n- 有效厚度因底部的衬垫而减小：$t_{\\mathrm{eff}} = t - t_{\\mathrm{liner}}$。\n\n铜的有效横截面积 $A_{\\mathrm{eff}}$ 为：\n$$ A_{\\mathrm{eff}} = W_{\\mathrm{eff}} t_{\\mathrm{eff}} = (W - 2t_{\\mathrm{liner}})(t - t_{\\mathrm{liner}}) $$\n带衬垫的互连线电阻为：\n$$ R_{\\mathrm{liner}} = \\frac{\\rho L}{A_{\\mathrm{eff}}} = \\frac{\\rho L}{(W - 2t_{\\mathrm{liner}})(t - t_{\\mathrm{liner}})} $$\n这是要计算的第一个量。\n\n**电阻的分数增加量**\n电阻的分数增加量 $\\Delta_R$ 定义为电阻变化量与原始电阻 $R_0$ 的比值。\n$$ \\Delta_R = \\frac{R_{\\mathrm{liner}} - R_0}{R_0} = \\frac{R_{\\mathrm{liner}}}{R_0} - 1 $$\n代入 $R_{\\mathrm{liner}}$ 和 $R_0$ 的表达式：\n$$ \\Delta_R = \\frac{\\frac{\\rho L}{(W - 2t_{\\mathrm{liner}})(t - t_{\\mathrm{liner}})}}{\\frac{\\rho L}{Wt}} - 1 $$\n项 $\\rho$ 和 $L$ 被消去，得到一个纯粹的几何比率：\n$$ \\Delta_R = \\frac{Wt}{(W - 2t_{\\mathrm{liner}})(t - t_{\\mathrm{liner}})} - 1 $$\n这是要计算的第二个量。\n\n**数值计算**\n首先，我们将所有给定参数转换为国际单位制基本单位（米）。\n- $\\rho = 3.0 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}$\n- $L = 1.0\\,\\mathrm{mm} = 1.0 \\times 10^{-3}\\,\\mathrm{m}$\n- $W = 40\\,\\mathrm{nm} = 40 \\times 10^{-9}\\,\\mathrm{m}$\n- $t = 80\\,\\mathrm{nm} = 80 \\times 10^{-9}\\,\\mathrm{m}$\n- $t_{\\mathrm{liner}} = 5.0\\,\\mathrm{nm} = 5.0 \\times 10^{-9}\\,\\mathrm{m}$\n\n现在，我们计算有效尺寸和面积：\n- $W_{\\mathrm{eff}} = 40 \\times 10^{-9}\\,\\mathrm{m} - 2 \\times (5.0 \\times 10^{-9}\\,\\mathrm{m}) = 30 \\times 10^{-9}\\,\\mathrm{m}$\n- $t_{\\mathrm{eff}} = 80 \\times 10^{-9}\\,\\mathrm{m} - 5.0 \\times 10^{-9}\\,\\mathrm{m} = 75 \\times 10^{-9}\\,\\mathrm{m}$\n- $A_{\\mathrm{eff}} = (30 \\times 10^{-9}\\,\\mathrm{m}) \\times (75 \\times 10^{-9}\\,\\mathrm{m}) = 2250 \\times 10^{-18}\\,\\mathrm{m}^2 = 2.25 \\times 10^{-15}\\,\\mathrm{m}^2$\n\n接下来，我们计算 $R_{\\mathrm{liner}}$：\n$$ R_{\\mathrm{liner}} = \\frac{(3.0 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}) \\times (1.0 \\times 10^{-3}\\,\\mathrm{m})}{2.25 \\times 10^{-15}\\,\\mathrm{m}^2} = \\frac{3.0 \\times 10^{-11}}{2.25 \\times 10^{-15}}\\,\\Omega $$\n$$ R_{\\mathrm{liner}} = \\frac{3.0}{2.25} \\times 10^4\\,\\Omega = 1.3333... \\times 10^4\\,\\Omega = 13333.3... \\,\\Omega $$\n四舍五入到四位有效数字，我们得到 $R_{\\mathrm{liner}} = 13330\\,\\Omega$。\n\n最后，我们计算分数增加量 $\\Delta_R$。我们可以使用简化的符号表达式。\n- 首先，计算原始面积 $A_0$：\n  $A_0 = Wt = (40 \\times 10^{-9}\\,\\mathrm{m}) \\times (80 \\times 10^{-9}\\,\\mathrm{m}) = 3200 \\times 10^{-18}\\,\\mathrm{m}^2 = 3.2 \\times 10^{-15}\\,\\mathrm{m}^2$。\n$$ \\Delta_R = \\frac{A_0}{A_{\\mathrm{eff}}} - 1 = \\frac{3200 \\times 10^{-18}}{2250 \\times 10^{-18}} - 1 = \\frac{3200}{2250} - 1 = \\frac{320}{225} - 1 $$\n$$ \\Delta_R = \\frac{64}{45} - 1 = 1.4222... - 1 = 0.4222... $$\n四舍五入到四位有效数字，分数增加量为 $\\Delta_R = 0.4222$。\n\n两个要求的值分别是带衬垫的电阻 $13330\\,\\Omega$ 和电阻的分数增加量 $0.4222$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n13330 & 0.4222\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然平行板电容公式 $C = \\varepsilon A/d$ 是教科书中的基础，但在深亚微米技术节点中，其预测能力常常会失效。本练习通过将简单的平行板模型计算结果与高精度场求解器的“真实”值进行比较，量化了模型的误差。这个过程将促使您深入思考误差的物理根源，即在窄导线中占主导地位的边缘场（fringing field）和侧壁电容效应。",
            "id": "4277425",
            "problem": "一条二氧化硅中的互连线被建模为一个直的、理想导电的矩形条带，其宽度 $w = 0.10~\\mu\\mathrm{m}$、厚度 $t = 0.05~\\mu\\mathrm{m}$、长度 $L = 1.00~\\mathrm{mm}$，与一个无限大接地平面之间由厚度为 $d = 0.20~\\mu\\mathrm{m}$ 的电介质隔开。该电介质是均匀的二氧化硅，相对介电常数 $\\varepsilon_r = 3.9$。一个高保真电磁场求解器预测，对于此几何结构，到接地平面的总电容为 $C_{\\mathrm{fs}} = 2.87 \\times 10^{-14}~\\mathrm{F}$。\n\n使用第一性原理，并假设在面积为 $w \\times L$、间距为 $d$ 的相对表面之间存在空间均匀电场（即忽略边缘效应和侧壁效应的平行板近似），计算平行板电容 $C_{\\mathrm{pp}}$，然后计算相对误差\n$$\\delta = \\frac{C_{\\mathrm{pp}} - C_{\\mathrm{fs}}}{C_{\\mathrm{fs}}}.$$\n取真空介电常数 $\\varepsilon_0 = 8.854 \\times 10^{-12}~\\mathrm{F/m}$。将 $\\delta$ 的最终答案表示为无单位的小数，并四舍五入到四位有效数字。\n\n此外，请在窄宽度互连线的背景下，解释平行板近似与场求解器结果之间差异的物理来源。\n\n最终数值答案不带单位表示。",
            "solution": "该问题陈述经核实具有科学依据、提法明确且客观。所有必要数据均已提供，该任务是电磁学和半导体器件物理学中的一个标准练习，重点在于互连电容的基本原理。因此，该问题被认定为有效。\n\n求解过程分为两部分：首先，计算相对误差；其次，对平行板模型与场求解器结果之间的差异进行物理解释。\n\n首先，我们基于平行板近似计算电容，记为 $C_{\\mathrm{pp}}$。平行板电容器的公式为：\n$$C_{\\mathrm{pp}} = \\frac{\\varepsilon A}{d_{\\text{sep}}}$$\n其中 $\\varepsilon$ 是电介质材料的介电常数， $A$ 是极板的面积， $d_{\\text{sep}}$ 是极板间的间隔距离。\n\n对于给定的互连线，电介质是二氧化硅，相对介电常数 $\\varepsilon_r = 3.9$。绝对介电常数为 $\\varepsilon = \\varepsilon_r \\varepsilon_0$。题目假设电容形成于互连线的底面与接地平面之间。因此，面积 $A$ 是互连线宽度 $w$ 和长度 $L$ 的乘积，即 $A = w L$。间隔距离是电介质厚度 $d$。\n\n将这些代入公式，我们得到：\n$$C_{\\mathrm{pp}} = \\frac{\\varepsilon_r \\varepsilon_0 w L}{d}$$\n\n给定值必须转换为国际单位制（SI）基本单位（米）。\n宽度为 $w = 0.10~\\mu\\mathrm{m} = 0.10 \\times 10^{-6}~\\mathrm{m}$。\n长度为 $L = 1.00~\\mathrm{mm} = 1.00 \\times 10^{-3}~\\mathrm{m}$。\n电介质厚度为 $d = 0.20~\\mu\\mathrm{m} = 0.20 \\times 10^{-6}~\\mathrm{m}$。\n常数为 $\\varepsilon_r = 3.9$ 和 $\\varepsilon_0 = 8.854 \\times 10^{-12}~\\mathrm{F/m}$。\n\n将这些值代入$C_{\\mathrm{pp}}$的表达式中：\n$$C_{\\mathrm{pp}} = \\frac{(3.9)(8.854 \\times 10^{-12}~\\mathrm{F/m})(0.10 \\times 10^{-6}~\\mathrm{m})(1.00 \\times 10^{-3}~\\mathrm{m})}{0.20 \\times 10^{-6}~\\mathrm{m}}$$\n$$C_{\\mathrm{pp}} = \\frac{3.9 \\times 8.854 \\times 0.10 \\times 1.00}{0.20} \\times \\frac{10^{-12} \\times 10^{-6} \\times 10^{-3}}{10^{-6}}~\\mathrm{F}$$\n$$C_{\\mathrm{pp}} = 17.2653 \\times 10^{-15}~\\mathrm{F} = 1.72653 \\times 10^{-14}~\\mathrm{F}$$\n\n接下来，我们使用给定的公式和高保真场求解器电容 $C_{\\mathrm{fs}} = 2.87 \\times 10^{-14}~\\mathrm{F}$ 来计算相对误差 $\\delta$。\n$$\\delta = \\frac{C_{\\mathrm{pp}} - C_{\\mathrm{fs}}}{C_{\\mathrm{fs}}}$$\n$$\\delta = \\frac{1.72653 \\times 10^{-14}~\\mathrm{F} - 2.87 \\times 10^{-14}~\\mathrm{F}}{2.87 \\times 10^{-14}~\\mathrm{F}}$$\n$$\\delta = \\frac{1.72653 - 2.87}{2.87} = \\frac{-1.14347}{2.87} \\approx -0.3984216$$\n\n将结果四舍五入到四位有效数字，我们得到：\n$$\\delta \\approx -0.3984$$\n\n平行板电容 $C_{\\mathrm{pp}}$ 与场求解器电容 $C_{\\mathrm{fs}}$ 之间的物理差异源于平行板模型是一种过度简化。它只考虑了源于导体底面并垂直终止于接地平面的电场线，并假设电场完全均匀。实际上，电场更为复杂。总电容 $C_{\\mathrm{fs}}$ 包括了额外的贡献，统称为边缘电容 ($C_{\\text{fringe}}$)，因此 $C_{\\mathrm{total}} = C_{\\mathrm{pp}} + C_{\\text{fringe}}$。\n\n这种边缘电容的来源是：\n$1$. **边缘效应：** 导体底面边缘处的电场线不是笔直向下，而是向外“发散”进入电介质中。这种向外的弯曲有效地增加了电场与接地平面相互作用的面积，从而使电容超出了简单的 $w \\times L$ 面积所考虑的范围。\n$2$. **侧壁电容：** 平行板模型完全忽略了互连线的厚度 $t = 0.05~\\mu\\mathrm{m}$。导体的垂直侧壁（每侧面积为 $t \\times L$）也储存电荷，并有电场线终止于接地平面。这种侧壁到地的电容是总电容的一个重要组成部分，尤其对于窄互连线而言。\n$3$. **角/顶面效应：** 电场线也可以从顶角，以及在较小程度上从导体的顶面发出，绕回并终止于接地平面。\n\n术语“窄宽度互连线”是关键。平行板近似的有效性取决于宽度 $w$ 远大于间距 $d$（即 $w/d \\gg 1$）和厚度 $t$（即 $w/t \\gg 1$）的假设。在这个问题中，宽度与间距之比为 $w/d = (0.10~\\mu\\mathrm{m}) / (0.20~\\mu\\mathrm{m}) = 0.5$，宽度与厚度之比为 $w/t = (0.10~\\mu\\mathrm{m}) / (0.05~\\mu\\mathrm{m}) = 2$。由于 $w$ 并不显著大于 $d$ 或 $t$，边缘和侧壁电容分量不可忽略；实际上，它们相当可观。\n\n计算出的误差 $\\delta \\approx -0.3984$ 表明，平行板模型的值 $C_{\\mathrm{pp}}$ 比更精确的场求解器值 $C_{\\mathrm{fs}}$ 低约 $40\\%$。这个大的负误差定量地证实了平行板模型通过忽略在这种窄宽度几何结构中占主导地位的边缘和侧壁效应，严重低估了总电容。",
            "answer": "$$\n\\boxed{-0.3984}\n$$"
        },
        {
            "introduction": "为了在电子设计自动化（EDA）工具中实现最高的预测精度，寄生参数模型必须根据实际的芯片测试数据进行校准。这项高级实践将指导您完成一个专业的校准流程：利用一组具有不同几何尺寸的测试结构的电阻和电容测量数据，反向提取出由化学机械抛光（CMP）和等离子体刻蚀等工艺引入的系统性尺寸偏差。您将学习如何应用模型线性化和最小二乘法等关键技术，将物理模型与实验数据联系起来，这是连接设计与制造的桥梁。",
            "id": "4277479",
            "problem": "集成电路 (Integrated Circuits) 与电子设计自动化 (Electronic Design Automation, EDA) 中的一个高级校准问题：化学机械平坦化 (Chemical Mechanical Planarization, CMP) 和等离子刻蚀 (plasma etch) 工艺会在互连线的横截面和电介质尺寸中引入系统性偏差。这些偏差会改变用于寄生参数建模的提取电阻值和电容值。仅从基本定义出发，推导并实现一种校准策略，以利用测试芯片结构来估计系统性偏差。\n\n使用的基本原理：\n- 欧姆定律 (Ohm’s law) 和电阻的定义：对于长度为 $L$、宽度为 $w$、厚度为 $t$、电阻率为 $\\rho$ 的均匀导体，其直流电阻为 $R = \\rho L / A$，其中 $A = w t$。\n- 参考平面上方导体的电容定义：对于长度为 $L$、介电常数为 $\\varepsilon = \\varepsilon_0 \\varepsilon_r$、电介质厚度为 $d$ 的导体，其静电电容可建模为平行板项和系统性边缘项之和，单位长度电容为 $c = \\varepsilon \\left( w / d + k \\right)$，其中 $k$ 是一个无量纲的边缘常数。总电容为 $C = c L$。\n- 系统性工艺偏差被建模为绘制尺寸或标称尺寸的加性偏移量：$w \\mapsto w + b_w$，$t \\mapsto t_{\\mathrm{nom}} + b_t$，$d \\mapsto d_{\\mathrm{nom}} + b_d$，其中 $b_w$、$b_t$ 和 $b_d$ 分别是宽度、厚度和电介质厚度偏差。\n\n校准目标：\n- 给定一组针对绘制宽度为 $w_i$、长度为 $L_i$ 的直线导线的测量电阻 $R_i$ 和测量电容 $C_i$，以及已知的材料参数 $\\rho$、$\\varepsilon_0$、$\\varepsilon_r$、标称厚度 $t_{\\mathrm{nom}}$、标称电介质厚度 $d_{\\mathrm{nom}}$ 和边缘常数 $k$，估计偏差 $b_w$、$b_t$ 和 $b_d$。\n- 围绕零偏差点使用一阶泰勒展开，以获得线性化的残差方程，该方程将测量预测值与标称预测值之间的偏差与 $b_w$、$b_t$ 和 $b_d$ 关联起来。\n- 通过适当归一化残差，构建一个无量纲的最小二乘问题，使得电阻和电容数据能够做出相当的贡献，而无需引入额外的权重。\n\n实现细节要求：\n- 从所述基本原理中推导出线性化残差。构建一个聚合所有结构电阻和电容残差的单一线性系统，并使用最小二乘法求解 $b_w$、$b_t$ 和 $b_d$。\n- 以纳米为单位表示最终估计的偏差，并四舍五入到三位小数。\n\n单位：\n- 电阻率 $\\rho$ 的单位为 $\\Omega \\cdot \\mathrm{m}$。\n- 真空介电常数 $\\varepsilon_0$ 的单位为 $\\mathrm{F}/\\mathrm{m}$。\n- 相对介电常数 $\\varepsilon_r$ 是无量纲的。\n- 几何尺寸 $w$、$t_{\\mathrm{nom}}$、$d_{\\mathrm{nom}}$ 和 $L$ 的单位为 $\\mathrm{m}$。\n- 电阻 $R$ 的单位为 $\\Omega$。\n- 电容 $C$ 的单位为 $\\mathrm{F}$。\n- 输出偏差 $b_w$、$b_t$、$b_d$ 的单位为纳米。\n\n测试套件：\n为三个测试用例实现校准，其合成的“测量”数据是使用隐藏的真实偏差通过精确表达式生成的。每个用例提供材料和几何参数，以及一组导线结构 $(w_i, L_i)$。测量数据将在程序内部使用给定的真实偏差和基本原理中陈述的精确电阻和电容公式生成。\n\n- 用例 $1$（一般情况，多种宽度和长度）：\n  - $\\rho = 1.68 \\times 10^{-8}\\ \\Omega\\cdot\\mathrm{m}$，$\\varepsilon_0 = 8.854187817 \\times 10^{-12}\\ \\mathrm{F}/\\mathrm{m}$，$\\varepsilon_r = 2.7$，$t_{\\mathrm{nom}} = 0.9 \\times 10^{-6}\\ \\mathrm{m}$，$d_{\\mathrm{nom}} = 3.2 \\times 10^{-7}\\ \\mathrm{m}$，$k = 0.8$。\n  - 结构 $(w_i, L_i)$，单位为米：$(2.0 \\times 10^{-7}, 1.0 \\times 10^{-4})$，$(5.0 \\times 10^{-7}, 1.0 \\times 10^{-4})$，$(1.0 \\times 10^{-6}, 2.0 \\times 10^{-4})$，$(2.0 \\times 10^{-6}, 2.0 \\times 10^{-4})$，$(1.0 \\times 10^{-6}, 5.0 \\times 10^{-4})$，$(2.0 \\times 10^{-7}, 5.0 \\times 10^{-4})$，$(5.0 \\times 10^{-7}, 2.0 \\times 10^{-4})$，$(2.0 \\times 10^{-6}, 5.0 \\times 10^{-4})$。\n  - 真实偏差：$b_w = -1.0 \\times 10^{-8}\\ \\mathrm{m}$，$b_t = -2.0 \\times 10^{-8}\\ \\mathrm{m}$，$b_d = +1.5 \\times 10^{-8}\\ \\mathrm{m}$。\n\n- 用例 $2$（边缘情况，线宽非常窄）：\n  - $\\rho = 2.10 \\times 10^{-8}\\ \\Omega\\cdot\\mathrm{m}$，$\\varepsilon_0 = 8.854187817 \\times 10^{-12}\\ \\mathrm{F}/\\mathrm{m}$，$\\varepsilon_r = 2.3$，$t_{\\mathrm{nom}} = 0.6 \\times 10^{-6}\\ \\mathrm{m}$，$d_{\\mathrm{nom}} = 2.8 \\times 10^{-7}\\ \\mathrm{m}$，$k = 1.1$。\n  - 结构 $(w_i, L_i)$，单位为米：$(1.0 \\times 10^{-7}, 5.0 \\times 10^{-5})$，$(1.5 \\times 10^{-7}, 1.0 \\times 10^{-4})$，$(2.0 \\times 10^{-7}, 1.5 \\times 10^{-4})$，$(1.0 \\times 10^{-7}, 1.5 \\times 10^{-4})$，$(2.0 \\times 10^{-7}, 5.0 \\times 10^{-5})$。\n  - 真实偏差：$b_w = -5.0 \\times 10^{-9}\\ \\mathrm{m}$，$b_t = -5.0 \\times 10^{-9}\\ \\mathrm{m}$，$b_d = +5.0 \\times 10^{-9}\\ \\mathrm{m}$。\n\n- 用例 $3$（边界情况，零偏差用于验证）：\n  - $\\rho = 1.72 \\times 10^{-8}\\ \\Omega\\cdot\\mathrm{m}$，$\\varepsilon_0 = 8.854187817 \\times 10^{-12}\\ \\mathrm{F}/\\mathrm{m}$，$\\varepsilon_r = 2.5$，$t_{\\mathrm{nom}} = 1.3 \\times 10^{-6}\\ \\mathrm{m}$，$d_{\\mathrm{nom}} = 3.0 \\times 10^{-7}\\ \\mathrm{m}$，$k = 0.9$。\n  - 结构 $(w_i, L_i)$，单位为米：$(5.0 \\times 10^{-7}, 1.0 \\times 10^{-4})$，$(1.0 \\times 10^{-6}, 1.0 \\times 10^{-4})$，$(5.0 \\times 10^{-7}, 3.0 \\times 10^{-4})$，$(1.0 \\times 10^{-6}, 3.0 \\times 10^{-4})$。\n  - 真实偏差：$b_w = 0.0\\ \\mathrm{m}$，$b_t = 0.0\\ \\mathrm{m}$，$b_d = 0.0\\ \\mathrm{m}$。\n\n输出要求：\n- 您的程序应生成单行输出，其中包含结果，格式为方括号内逗号分隔的列表。\n- 每个测试用例贡献一个包含三个浮点数 $[b_w, b_t, b_d]$ 的子列表，单位为纳米，四舍五入到三位小数。\n- 最终输出格式必须严格符合 $[[b_{w,1},b_{t,1},b_{d,1}],[b_{w,2},b_{t,2},b_{d,2}],[b_{w,3},b_{t,3},b_{d,3}]]$ 的形式。\n\n不需要用户输入；所有参数都将在程序内部定义。解决方案必须从上述基本原理出发，论证线性化方法和拟合方法的合理性，并且代码必须实现该方法以生成指定的输出。",
            "solution": "该问题旨在通过分析来自测试结构的电学测量数据，确定影响互连线尺寸——导体宽度 ($w$)、导体厚度 ($t$) 和电介质厚度 ($d$)——的系统性工艺偏差。我们得到了一组针对 $N$ 个具有不同绘制宽度 ($w_i$) 和长度 ($L_i$) 的导线结构的电阻 ($R_i$) 和电容 ($C_i$) 测量值。材料属性（电阻率 $\\rho$、介电常数 $\\varepsilon$）和标称尺寸 ($t_{\\mathrm{nom}}$, $d_{\\mathrm{nom}}$) 是已知的。目标是通过将数据拟合到物理模型中，来估计宽度偏差 ($b_w$)、厚度偏差 ($b_t$) 和电介质厚度偏差 ($b_d$)。问题指定了采用线性化最小二乘法。\n\n首先，我们建立将电学测量值与包括偏差在内的物理尺寸关联起来的物理模型。真实尺寸被建模为标称（绘制）尺寸的加性偏移量：\n- 实际宽度：$w_{\\mathrm{act}} = w_i + b_w$\n- 实际厚度：$t_{\\mathrm{act}} = t_{\\mathrm{nom}} + b_t$\n- 实际电介质厚度：$d_{\\mathrm{act}} = d_{\\mathrm{nom}} + b_d$\n\n第 $i$ 个结构的电阻和电容的精确非线性模型由以下基本关系给出：\n$$ R_i(b_w, b_t) = \\frac{\\rho L_i}{(w_i + b_w)(t_{\\mathrm{nom}} + b_t)} $$\n$$ C_i(b_w, b_d) = \\varepsilon L_i \\left( \\frac{w_i + b_w}{d_{\\mathrm{nom}} + b_d} + k \\right) $$\n其中 $\\varepsilon = \\varepsilon_0 \\varepsilon_r$ 是介电常数。\n\n电阻 ($R_{i, \\mathrm{nom}}$) 和电容 ($C_{i, \\mathrm{nom}}$) 的标称预测值是在零偏差 ($b_w=0$, $b_t=0$, $b_d=0$) 条件下计算的值：\n$$ R_{i, \\mathrm{nom}} = \\frac{\\rho L_i}{w_i t_{\\mathrm{nom}}} $$\n$$ C_{i, \\mathrm{nom}} = \\varepsilon L_i \\left( \\frac{w_i}{d_{\\mathrm{nom}}} + k \\right) $$\n\n校准策略的核心是将测量值与偏差之间的关系线性化。我们围绕零偏差点对 $R_i$ 和 $C_i$ 进行一阶泰勒级数展开。这假设偏差相对于标称尺寸很小。\n\n对于电阻，展开式为：\n$$ R_i \\approx R_{i, \\mathrm{nom}} + \\left. \\frac{\\partial R_i}{\\partial b_w} \\right|_{\\mathbf{b}=0} b_w + \\left. \\frac{\\partial R_i}{\\partial b_t} \\right|_{\\mathbf{b}=0} b_t $$\n在零偏差处计算的偏导数为：\n$$ \\left. \\frac{\\partial R_i}{\\partial b_w} \\right|_{\\mathbf{b}=0} = \\left. -\\frac{\\rho L_i}{(w_i+b_w)^2(t_{\\mathrm{nom}}+b_t)} \\right|_{\\mathbf{b}=0} = -\\frac{\\rho L_i}{w_i^2 t_{\\mathrm{nom}}} = -R_{i, \\mathrm{nom}} \\frac{1}{w_i} $$\n$$ \\left. \\frac{\\partial R_i}{\\partial b_t} \\right|_{\\mathbf{b}=0} = \\left. -\\frac{\\rho L_i}{(w_i+b_w)(t_{\\mathrm{nom}}+b_t)^2} \\right|_{\\mathbf{b}=0} = -\\frac{\\rho L_i}{w_i t_{\\mathrm{nom}}^2} = -R_{i, \\mathrm{nom}} \\frac{1}{t_{\\mathrm{nom}}} $$\n残差方程为 $R_i^{\\mathrm{meas}} - R_{i, \\mathrm{nom}} \\approx -R_{i, \\mathrm{nom}} \\frac{b_w}{w_i} - R_{i, \\mathrm{nom}} \\frac{b_t}{t_{\\mathrm{nom}}}$。为了按要求创建无量纲残差，我们除以 $R_{i, \\mathrm{nom}}$：\n$$ y_{R,i} = \\frac{R_i^{\\mathrm{meas}} - R_{i, \\mathrm{nom}}}{R_{i, \\mathrm{nom}}} \\approx -\\frac{1}{w_i} b_w - \\frac{1}{t_{\\mathrm{nom}}} b_t $$\n\n类似地，对于电容，展开式为：\n$$ C_i \\approx C_{i, \\mathrm{nom}} + \\left. \\frac{\\partial C_i}{\\partial b_w} \\right|_{\\mathbf{b}=0} b_w + \\left. \\frac{\\partial C_i}{\\partial b_d} \\right|_{\\mathbf{b}=0} b_d $$\n在零偏差处计算的偏导数为：\n$$ \\left. \\frac{\\partial C_i}{\\partial b_w} \\right|_{\\mathbf{b}=0} = \\left. \\frac{\\varepsilon L_i}{d_{\\mathrm{nom}}+b_d} \\right|_{\\mathbf{b}=0} = \\frac{\\varepsilon L_i}{d_{\\mathrm{nom}}} $$\n$$ \\left. \\frac{\\partial C_i}{\\partial b_d} \\right|_{\\mathbf{b}=0} = \\left. -\\frac{\\varepsilon L_i (w_i+b_w)}{(d_{\\mathrm{nom}}+b_d)^2} \\right|_{\\mathbf{b}=0} = -\\frac{\\varepsilon L_i w_i}{d_{\\mathrm{nom}}^2} $$\n我们通过除以 $C_{i, \\mathrm{nom}} = \\varepsilon L_i (\\frac{w_i}{d_{\\text{nom}}} + k) = \\varepsilon L_i \\frac{w_i + k d_{\\text{nom}}}{d_{\\text{nom}}}$ 来构成无量纲残差：\n$$ y_{C,i} = \\frac{C_i^{\\mathrm{meas}} - C_{i, \\mathrm{nom}}}{C_{i, \\mathrm{nom}}} \\approx \\frac{1}{C_{i, \\mathrm{nom}}} \\left( \\frac{\\varepsilon L_i}{d_{\\mathrm{nom}}} b_w - \\frac{\\varepsilon L_i w_i}{d_{\\mathrm{nom}}^2} b_d \\right) $$\n代入 $C_{i, \\mathrm{nom}}$ 的表达式并简化系数可得：\n$$ y_{C,i} \\approx \\left(\\frac{1}{w_i+k d_{\\mathrm{nom}}}\\right) b_w - \\left(\\frac{w_i}{d_{\\mathrm{nom}}(w_i+k d_{\\mathrm{nom}})}\\right) b_d $$\n\n利用这些线性化的无量纲残差，我们可以为所有 $N$ 个结构构建一个单一的线性系统。设未知偏差向量为 $\\mathbf{x} = [b_w, b_t, b_d]^T$。我们有 $2N$ 个测量值（$N$ 个电阻值和 $N$ 个电容值），这导出一个超定线性方程组 $A\\mathbf{x} \\approx \\mathbf{y}$，其中：\n- $\\mathbf{y}$ 是一个 $2N \\times 1$ 的观测无量纲残差向量：\n$$ \\mathbf{y} = [y_{R,1}, \\dots, y_{R,N}, y_{C,1}, \\dots, y_{C,N}]^T $$\n- $A$ 是包含灵敏度系数的 $2N \\times 3$ 雅可比矩阵 (Jacobian matrix)：\n$$ A = \\begin{bmatrix}\n-\\frac{1}{w_1} & -\\frac{1}{t_{\\mathrm{nom}}} & 0 \\\\\n\\vdots & \\vdots & \\vdots \\\\\n-\\frac{1}{w_N} & -\\frac{1}{t_{\\mathrm{nom}}} & 0 \\\\\n\\frac{1}{w_1+k d_{\\mathrm{nom}}} & 0 & -\\frac{w_1}{d_{\\mathrm{nom}}(w_1+k d_{\\mathrm{nom}})} \\\\\n\\vdots & \\vdots & \\vdots \\\\\n\\frac{1}{w_N+k d_{\\mathrm{nom}}} & 0 & -\\frac{w_N}{d_{\\mathrm{nom}}(w_N+k d_{\\mathrm{nom}})}\n\\end{bmatrix} $$\n偏差向量 $\\mathbf{x}$ 的最小二乘估计是使误差的欧几里得范数平方 $\\|A\\mathbf{x} - \\mathbf{y}\\|_2^2$ 最小化的解。该解的正式形式为 $\\mathbf{x}_{\\mathrm{est}} = (A^T A)^{-1} A^T \\mathbf{y}$。\n\n该实现将首先使用精确的非线性公式和提供的“真实”偏差来生成合成的“测量”数据。然后，它将使用标称参数构建矩阵 $A$ 和向量 $\\mathbf{y}$，并求解线性最小二乘问题以找到估计的偏差 $\\mathbf{x}_{\\mathrm{est}}$。最后，将结果从米转换为纳米，并按要求进行四舍五入。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for systematic process biases using a linearized least-squares approach.\n    \"\"\"\n    # Define physical constants\n    EPSILON_0 = 8.854187817e-12  # F/m\n\n    # Test cases as provided in the problem statement\n    test_cases = [\n        {\n            \"params\": {\n                \"rho\": 1.68e-8, \"eps_r\": 2.7, \"t_nom\": 0.9e-6, \n                \"d_nom\": 3.2e-7, \"k\": 0.8\n            },\n            \"structures\": [\n                (2.0e-7, 1.0e-4), (5.0e-7, 1.0e-4), (1.0e-6, 2.0e-4),\n                (2.0e-6, 2.0e-4), (1.0e-6, 5.0e-4), (2.0e-7, 5.0e-4),\n                (5.0e-7, 2.0e-4), (2.0e-6, 5.0e-4)\n            ],\n            \"true_biases\": {\"bw\": -1.0e-8, \"bt\": -2.0e-8, \"bd\": 1.5e-8}\n        },\n        {\n            \"params\": {\n                \"rho\": 2.10e-8, \"eps_r\": 2.3, \"t_nom\": 0.6e-6, \n                \"d_nom\": 2.8e-7, \"k\": 1.1\n            },\n            \"structures\": [\n                (1.0e-7, 5.0e-5), (1.5e-7, 1.0e-4), (2.0e-7, 1.5e-4),\n                (1.0e-7, 1.5e-4), (2.0e-7, 5.0e-5)\n            ],\n            \"true_biases\": {\"bw\": -5.0e-9, \"bt\": -5.0e-9, \"bd\": 5.0e-9}\n        },\n        {\n            \"params\": {\n                \"rho\": 1.72e-8, \"eps_r\": 2.5, \"t_nom\": 1.3e-6, \n                \"d_nom\": 3.0e-7, \"k\": 0.9},\n            \"structures\": [\n                (5.0e-7, 1.0e-4), (1.0e-6, 1.0e-4), \n                (5.0e-7, 3.0e-4), (1.0e-6, 3.0e-4)\n            ],\n            \"true_biases\": {\"bw\": 0.0, \"bt\": 0.0, \"bd\": 0.0}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        params = case[\"params\"]\n        structures = case[\"structures\"]\n        true_biases = case[\"true_biases\"]\n        \n        rho = params[\"rho\"]\n        eps_r = params[\"eps_r\"]\n        t_nom = params[\"t_nom\"]\n        d_nom = params[\"d_nom\"]\n        k = params[\"k\"]\n        \n        b_w_true = true_biases[\"bw\"]\n        b_t_true = true_biases[\"bt\"]\n        b_d_true = true_biases[\"bd\"]\n        \n        epsilon = EPSILON_0 * eps_r\n        num_structures = len(structures)\n        \n        # A is the Jacobian matrix, y is the observation vector\n        A_matrix = np.zeros((2 * num_structures, 3))\n        y_vector = np.zeros(2 * num_structures)\n\n        for i, (w_i, L_i) in enumerate(structures):\n            # Generate synthetic \"measured\" data using exact models and true biases\n            w_act = w_i + b_w_true\n            t_act = t_nom + b_t_true\n            d_act = d_nom + b_d_true\n            \n            # Avoid division by zero for ill-posed cases\n            if w_act == 0 or t_act == 0 or d_act == 0:\n                raise ValueError(\"Biases result in non-physical dimensions.\")\n\n            R_meas = (rho * L_i) / (w_act * t_act)\n            C_meas = epsilon * L_i * ((w_act / d_act) + k)\n            \n            # Calculate nominal values (zero bias)\n            R_nom = (rho * L_i) / (w_i * t_nom)\n            C_nom = epsilon * L_i * ((w_i / d_nom) + k)\n\n            # Calculate dimensionless residuals\n            y_r = (R_meas - R_nom) / R_nom\n            y_c = (C_meas - C_nom) / C_nom\n            \n            y_vector[i] = y_r\n            y_vector[i + num_structures] = y_c\n            \n            # Populate the Jacobian matrix A based on the derived linearized model\n            # Resistance row\n            A_matrix[i, 0] = -1.0 / w_i\n            A_matrix[i, 1] = -1.0 / t_nom\n            A_matrix[i, 2] = 0.0\n            \n            # Capacitance row\n            cap_denom = w_i + k * d_nom\n            A_matrix[i + num_structures, 0] = 1.0 / cap_denom\n            A_matrix[i + num_structures, 1] = 0.0\n            A_matrix[i + num_structures, 2] = -w_i / (d_nom * cap_denom)\n\n        # Solve the linear least-squares problem Ax = y for x = [bw, bt, bd]\n        # x is the vector of estimated biases in meters\n        x, residuals, rank, s = np.linalg.lstsq(A_matrix, y_vector, rcond=None)\n        \n        # Convert biases from meters to nanometers and round to 3 decimal places\n        b_w_est_nm = np.round(x[0] * 1e9, 3)\n        b_t_est_nm = np.round(x[1] * 1e9, 3)\n        b_d_est_nm = np.round(x[2] * 1e9, 3)\n        \n        all_results.append([b_w_est_nm, b_t_est_nm, b_d_est_nm])\n\n    # Format the final output string exactly as required\n    formatted_sublists = [f\"[{','.join(map(str, sub))}]\" for sub in all_results]\n    final_output = f\"[{','.join(formatted_sublists)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}