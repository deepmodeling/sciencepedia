{
    "hands_on_practices": [
        {
            "introduction": "静态时序分析中的参数，如建立时间（setup time），并非凭空产生，而是源于电路底层的物理行为。本练习将带您从第一性原理出发，通过分析一个简化的CMOS传输门锁存器模型，来推导建立时间的表达式 。通过此练习，您将把电路的$RC$充电过程与关键时序参数直接联系起来，从而加深对时序约束物理本质的理解。",
            "id": "4301282",
            "problem": "考虑一个用于寄存器设计的电子设计自动化(EDA)流程中的静态互补金属氧化物半导体(CMOS)传输门锁存器。在透明阶段，数据输入通过一个具有恒定导通电阻 $R_{on}$ 的传输门驱动内部存储节点。该存储节点被建模为对地的单个集总电容 $C$，并且是下游反相器的输入。假设数据在时间 $t=0$ 时经历一个从 $0$ 到高逻辑电平 $V_{H}$ 的上升沿，该上升沿被建模为理想阶跃；当存储节点电压首次达到其输入阈值 $V_{T}$ 时，反相器发生翻转，其中 $0  V_{T}  V_{H}$。在其他方面，该锁存器是理想的：忽略漏电、再生、体效应以及 $R_{on}$ 或 $C$ 的任何电压依赖性。\n\n仅使用电阻和电容的基本关系以及存储节点的电荷守恒，从第一性原理推导出一个解析表达式，用于表示在非透明沿之前所需的最小数据建立时间 $t_{setup}$，此处该时间定义为从 $t=0$ 开始直到存储节点电压越过反相器阈值 $V_{T}$ 的时间。你的推导必须从关系式 $i_{R} = \\frac{v_{s}-v(t)}{R_{on}}$、$i_{C} = C \\frac{dv(t)}{dt}$ 以及存储节点处的基尔霍夫电流定律开始，其中 $v_{s}$ 是驱动源电压，在 $t \\geq 0$ 时等于 $V_{H}$，而 $v(t)$ 是存储节点电压。假设初始条件为 $v(0)=0$。\n\n将 $t_{setup}$ 的最终答案表示为由 $R_{on}$、$C$、$V_{T}$ 和 $V_{H}$ 构成的闭式解析表达式。如果你之后对该表达式进行数值计算，时间单位请使用秒。对于解析表达式，不需要进行近似或四舍五入。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据、是良定的、客观的，并包含推导出唯一且有意义解所需的所有信息。该问题描述了一个经典的一阶RC电路，这是集成电路分析中的一个基本模型。\n\n任务是推导静态CMOS锁存器的建立时间 $t_{setup}$ 的表达式。该时间定义为：当通过电阻 $R_{on}$ 由一个从 $0$ 到 $V_{H}$ 的阶跃输入驱动时，存储电容上的电压 $v(t)$ 从初始值 $v(0)=0$ 上升到阈值电压 $V_{T}$ 所需的时长。推导将从所提供的第一性原理开始。\n\n该电路可以建模为一个串联RC电路，其中输入电压源 $v_s$ 连接到一个电阻 $R_{on}$，该电阻又连接到一个电容 $C$。输出电压 $v(t)$ 是电容两端的电压。\n\n问题提供了以下基本关系：\n1.  通过电阻的电流 $i_{R}$ 由欧姆定律给出：$i_{R} = \\frac{v_{s}-v(t)}{R_{on}}$。对于 $t \\geq 0$，源电压恒为 $v_{s} = V_{H}$，因此表达式变为 $i_{R} = \\frac{V_{H}-v(t)}{R_{on}}$。\n2.  通过电容的电流 $i_{C}$ 由基本电容I-V关系给出：$i_{C} = C \\frac{dv(t)}{dt}$。\n\n我们在存储节点（即电阻和电容之间的节点）应用基尔霍夫电流定律 (KCL)。根据KCL，流入节点的电流总和必须等于流出节点的电流总和。在这个简单电路中，从电阻流出的电流必须等于流入电容的电流。\n$$i_{R} = i_{C}$$\n代入给定的 $i_{R}$ 和 $i_{C}$ 表达式：\n$$\\frac{V_{H}-v(t)}{R_{on}} = C \\frac{dv(t)}{dt}$$\n这是一个描述存储节点电压 $v(t)$ 随时间变化行为的一阶线性常微分方程 (ODE)。为了求解 $v(t)$，我们将方程重新整理成标准形式：\n$$\\frac{dv(t)}{dt} + \\frac{1}{R_{on}C} v(t) = \\frac{V_{H}}{R_{on}C}$$\n形式为 $\\frac{dy}{dt} + P(t)y = Q(t)$ 的常微分方程的通解可以通过将齐次解和特解相加得到。齐次方程为：\n$$\\frac{dv_{h}(t)}{dt} + \\frac{1}{R_{on}C} v_{h}(t) = 0$$\n该齐次方程的解的形式为 $v_{h}(t) = A \\exp(-t/\\tau)$，其中 $\\tau = R_{on}C$ 是电路的时间常数，A 是一个积分常数。\n$$v_{h}(t) = A \\exp\\left(-\\frac{t}{R_{on}C}\\right)$$\n特解，或称稳态解，对应于 $t \\to \\infty$ 时电路的状态。在此极限下，电容器完全充电，电流停止流动，因此 $\\frac{dv(t)}{dt} = 0$。将此代入常微分方程得到：\n$$0 + \\frac{1}{R_{on}C} v_{ss}(t) = \\frac{V_{H}}{R_{on}C}$$\n其中 $v_{ss}(t)$ 是稳态电压。这可以简化为：\n$$v_{ss}(t) = V_{H}$$\n$v(t)$ 的完全解是齐次解和特解之和：\n$$v(t) = v_{h}(t) + v_{ss}(t) = A \\exp\\left(-\\frac{t}{R_{on}C}\\right) + V_{H}$$\n我们使用问题陈述中提供的初始条件 $v(0)=0$ 来确定常数 $A$。\n$$v(0) = A \\exp(0) + V_{H} = A + V_{H} = 0$$\n解出 $A$，我们得到 $A = -V_{H}$。\n\n将这个 $A$ 的值代回通解，得到 $t \\geq 0$ 时存储节点电压的特解：\n$$v(t) = V_{H} - V_{H} \\exp\\left(-\\frac{t}{R_{on}C}\\right)$$\n这可以因式分解为：\n$$v(t) = V_{H} \\left(1 - \\exp\\left(-\\frac{t}{R_{on}C}\\right)\\right)$$\n这个方程描述了充电电容两端的电压随时间变化的函数。\n\n问题将建立时间 $t_{setup}$ 定义为存储节点电压 $v(t)$ 达到反相器阈值电压 $V_{T}$ 所需的时间。我们通过设 $v(t) = V_{T}$ 并求解 $t = t_{setup}$ 来找到这个时间。\n$$V_{T} = V_{H} \\left(1 - \\exp\\left(-\\frac{t_{setup}}{R_{on}C}\\right)\\right)$$\n为了分离出 $t_{setup}$，我们首先两边同除以 $V_{H}$：\n$$\\frac{V_{T}}{V_{H}} = 1 - \\exp\\left(-\\frac{t_{setup}}{R_{on}C}\\right)$$\n接下来，我们重新整理各项以分离出指数函数：\n$$\\exp\\left(-\\frac{t_{setup}}{R_{on}C}\\right) = 1 - \\frac{V_{T}}{V_{H}}$$\n为了求解指数，我们对两边取自然对数 ($\\ln$)：\n$$-\\frac{t_{setup}}{R_{on}C} = \\ln\\left(1 - \\frac{V_{T}}{V_{H}}\\right)$$\n最后，我们通过乘以 $-R_{on}C$ 来解出 $t_{setup}$：\n$$t_{setup} = -R_{on}C \\ln\\left(1 - \\frac{V_{T}}{V_{H}}\\right)$$\n条件 $0  V_{T}  V_{H}$ 确保了对数的自变量 $1 - \\frac{V_{T}}{V_{H}}$ 在 $0$ 和 $1$ 之间。这个范围内数字的自然对数是负数，这会与前面的负号相抵消，从而得到一个预期的正值 $t_{setup}$。\n\n使用对数性质 $-\\ln(x) = \\ln(1/x)$，可以推导出另一种等价形式：\n$$t_{setup} = R_{on}C \\ln\\left(\\frac{1}{1 - \\frac{V_{T}}{V_{H}}}\\right)$$\n简化对数内的分数，得到最终的闭式解析表达式：\n$$t_{setup} = R_{on}C \\ln\\left(\\frac{V_{H}}{V_{H} - V_{T}}\\right)$$\n这就是数据被锁存器可靠地捕获所需的最小建立时间。",
            "answer": "$$\\boxed{R_{on}C \\ln\\left(\\frac{V_{H}}{V_{H} - V_{T}}\\right)}$$"
        },
        {
            "introduction": "在理想模型之外，实际的锁存器设计必须考虑各种非理想效应，电荷共享（charge sharing）便是其中之一。当两个具有不同电压的电容性节点被传输门连接时，电荷会重新分配，可能导致存储节点电压发生非预期的变化，甚至引发逻辑错误。本练习将引导您应用电荷守恒基本定律，来量化分析电荷共享对节点电压的影响 ，这是确保电路鲁棒性设计的关键一步。",
            "id": "4301299",
            "problem": "考虑一个使用传输门（Transmission Gate, TG）实现的互补金属氧化物半导体（Complementary Metal–Oxide–Semiconductor, CMOS）静态透明锁存器前端。当其控制信号被置为有效时，该传输门将输入节点连接到存储节点。在保持阶段，两个节点电气隔离，表现为浮空的电容节点。当传输门开启时，两个节点被短接在一起，电荷在它们的电容之间重新分配。这种电荷共享可能导致存储节点上的电压下降或上升，这对于集成电路和电子设计自动化（Electronic Design Automation, EDA）中的静态锁存器和寄存器电路设计至关重要。\n\n存储节点是一个逆变器的栅极，其对地有三个主要的寄生电容：栅电容 $C_{g} = 23\\,\\mathrm{fF}$、扩散电容 $C_{d} = 5\\,\\mathrm{fF}$ 和互连电容 $C_{i} = 2\\,\\mathrm{fF}$。输入节点对地有两个主要的寄生电容：驱动器输出电容 $C_{\\mathrm{drv}} = 11\\,\\mathrm{fF}$ 和金属互连电容 $C_{m} = 9\\,\\mathrm{fF}$。在传输门开启之前，存储节点电压为 $V_{S}(0^{-}) = 0.9\\,\\mathrm{V}$，输入节点电压为 $V_{I}(0^{-}) = 0.2\\,\\mathrm{V}$。\n\n假设如下：\n- 在 $t = 0$ 时开启的传输门，在所关心的时间段内，表现为两个节点之间的理想短路。\n- 在所考虑的短暂瞬态期间，没有到电源轨的导电路径（两个节点除了对地电容外，实际上是浮空的）。\n- 对于此事件，沟道电荷注入和时钟馈通可以忽略不计。\n- 唯一相关的原理是电荷守恒，并且电容关系 $Q = C V$ 在线性和时不变电容的情况下成立。\n\n应用电荷守恒定律于此双节点系统，计算电荷共享完成后瞬间的最终公共节点电压 $V_{f}$。答案以 $\\mathrm{V}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "我们从基本电容关系 $Q = C V$ 和电荷守恒定律开始。当两个隔离的电容节点理想地短接在一起时，由于在短暂的瞬態过程中没有到外部电源的路径，闭合系统（双节点集群）中的总电荷是守恒的。\n\n定义存储节点的总电容为\n$$\nC_{S} = C_{g} + C_{d} + C_{i} = 23\\,\\mathrm{fF} + 5\\,\\mathrm{fF} + 2\\,\\mathrm{fF} = 30\\,\\mathrm{fF}.\n$$\n定义输入节点的总电容为\n$$\nC_{I} = C_{\\mathrm{drv}} + C_{m} = 11\\,\\mathrm{fF} + 9\\,\\mathrm{fF} = 20\\,\\mathrm{fF}.\n$$\n\n设初始电压为 $V_{S}(0^{-}) = 0.9\\,\\mathrm{V}$ 和 $V_{I}(0^{-}) = 0.2\\,\\mathrm{V}$。在传输门开启且电荷共享完成后，由于理想短路，两个节点处于相同的电压 $V_{f}$。\n\n根据电荷守恒定律，之前的总电荷等于之后的总电荷：\n$$\nC_{S} \\, V_{S}(0^{-}) + C_{I} \\, V_{I}(0^{-}) = (C_{S} + C_{I}) \\, V_{f}.\n$$\n求解 $V_{f}$ 得\n$$\nV_{f} = \\frac{C_{S} \\, V_{S}(0^{-}) + C_{I} \\, V_{I}(0^{-})}{C_{S} + C_{I}}.\n$$\n\n代入数值：\n$$\nV_{f} = \\frac{(30\\,\\mathrm{fF}) \\cdot (0.9\\,\\mathrm{V}) + (20\\,\\mathrm{fF}) \\cdot (0.2\\,\\mathrm{V})}{30\\,\\mathrm{fF} + 20\\,\\mathrm{fF}}.\n$$\n计算分子：\n$$\n(30\\,\\mathrm{fF}) \\cdot (0.9\\,\\mathrm{V}) = 27\\,\\mathrm{fF}\\cdot\\mathrm{V}, \\quad (20\\,\\mathrm{fF}) \\cdot (0.2\\,\\mathrm{V}) = 4\\,\\mathrm{fF}\\cdot\\mathrm{V},\n$$\n所以\n$$\n\\text{分子} = 27\\,\\mathrm{fF}\\cdot\\mathrm{V} + 4\\,\\mathrm{fF}\\cdot\\mathrm{V} = 31\\,\\mathrm{fF}\\cdot\\mathrm{V}.\n$$\n分母为\n$$\n30\\,\\mathrm{fF} + 20\\,\\mathrm{fF} = 50\\,\\mathrm{fF}.\n$$\n因此，\n$$\nV_{f} = \\frac{31\\,\\mathrm{fF}\\cdot\\mathrm{V}}{50\\,\\mathrm{fF}} = 0.62\\,\\mathrm{V}.\n$$\n\n四舍五入到四位有效数字并以伏特表示，最终的公共节点电压为 $0.6200\\,\\mathrm{V}$。",
            "answer": "$$\\boxed{0.6200}$$"
        },
        {
            "introduction": "单个锁存器的特性是基础，但实际系统中我们通常使用由多个锁存器构成的寄存器，例如主从寄存器（master-slave register）。本练习将从组件层面上升到系统层面，分析如何根据主、从锁存器各自的时序参数，推导出整个边沿触发寄存器的有效建立时间、保持时间（hold time）和时钟到输出延迟（clock-to-Q delay） 。这个过程将揭示时钟方案（如非交叠时钟）在确保寄存器功能正确性中的核心作用。",
            "id": "4301260",
            "problem": "在用于集成电路的电子设计自动化 (EDA) 领域中，考虑一个由一对电平敏感锁存器构成的主从结构实现的上升沿触发寄存器。当时钟输入 $CLK$ 为低电平时，主锁存器透明；当 $CLK$ 为高电平时，从锁存器透明。为防止透明重叠和组合馈通，时钟方案在上升沿周围引入了非重叠窗口。设寄存器处 $CLK$ 的上升沿为参考时间 $t=0$。主锁存器在时间 $t=-t_{\\text{gap}}^{-}$（一个上升沿前的非重叠裕量）变为不透明，从锁存器在时间 $t=+t_{\\text{gap}}^{+}$（一个上升沿后的非重叠裕量）变为透明。假设理想的单源时钟，并忽略寄存器内部的时钟分配偏斜。\n\n每个锁存器 $L$ 的时序定义如下，以 $L$ 从透明转换到不透明的瞬间为基准：建立时间 $t_{\\text{setup},L}$ 是闭合事件前数据输入必须保持稳定的最小时间间隔，保持时间 $t_{\\text{hold},L}$ 是闭合事件后数据输入必须保持稳定以保证正确捕获的最小时间间隔。当锁存器透明时，其数据端口上的稳定输入以数据到输出传播时间 $t_{\\text{pd},L}$ 传播到其输出端。\n\n给定以下参数：\n- 主锁存器建立时间 $t_{\\text{setup},M} = 24\\,\\text{ps}$ 和保持时间 $t_{\\text{hold},M} = 16\\,\\text{ps}$。\n- 从锁存器建立时间 $t_{\\text{setup},S} = 20\\,\\text{ps}$ 和保持时间 $t_{\\text{hold},S} = 15\\,\\text{ps}$。\n- 从锁存器在透明状态下的数据到输出传播延迟 $t_{\\text{pd},S} = 70\\,\\text{ps}$。\n- 上升沿前非重叠裕量 $t_{\\text{gap}}^{-} = 35\\,\\text{ps}$ 和上升沿后非重叠裕量 $t_{\\text{gap}}^{+} = 45\\,\\text{ps}$。\n\n从上述锁存器时序定义和所描述的非重叠时钟方案明确出发，且不使用任何预先记忆的复合寄存器公式，推导相对于 $t=0$ 处上升沿的有效寄存器级建立时间 $t_{\\text{setup,reg}}$ 和保持时间 $t_{\\text{hold,reg}}$，以及相对于同一上升沿的有效寄存器时钟到输出延迟 $t_{\\text{CQ,reg}}$ 的表达式。然后使用所提供的数值计算这些表达式的值。\n\n用皮秒表示您的最终数值结果。将您的答案四舍五入到三位有效数字。以包含 $\\left(t_{\\text{setup,reg}},\\,t_{\\text{hold,reg}},\\,t_{\\text{CQ,reg}}\\right)$ 的行矩阵形式提供您的最终答案。",
            "solution": "该问题是有效的，因为它科学地基于数字集成电路时序的原理，问题陈述清晰且信息充分，可得到唯一解，并且陈述客观。我们将根据所提供的组成锁存器的基本定义和指定的时钟方案，来推导寄存器级的时序参数。\n\n该寄存器是一个上升沿触发的主从触发器。有效时钟沿是外部时钟 $CLK$ 的上升沿，发生在参考时间 $t=0$。主锁存器在 $CLK$ 为低电平时透明，从锁存器在 $CLK$ 为高电平时透明。使用了一种非重叠时钟方案：\n1.  主锁存器在时间 $t_M = -t_{\\text{gap}}^{-}$ 关闭（变为不透明），这在 $CLK$ 上升沿之前。这是主锁存器的闭合事件。\n2.  从锁存器在时间 $t_S = +t_{\\text{gap}}^{+}$ 开启（变为透明），这在 $CLK$ 上升沿之后。\n\n所有锁存器级的时序参数（$t_{\\text{setup},L}$，$t_{\\text{hold},L}$）都是相对于锁存器的闭合事件来定义的。\n\n**1. 寄存器建立时间 ($t_{\\text{setup,reg}}$) 的推导**\n\n寄存器建立时间 $t_{\\text{setup,reg}}$ 是有效时钟沿（$t=0$）之前寄存器数据输入 $D$ 必须保持稳定的最小时间间隔。这一要求是由主锁存器可靠捕获数据的需求决定的。\n\n主锁存器的闭合事件发生在 $t = -t_{\\text{gap}}^{-}$。根据其定义，主锁存器的建立时间 $t_{\\text{setup},M}$ 要求其输入（即寄存器的输入 $D$）在此闭合事件*之前*必须稳定至少 $t_{\\text{setup},M}$ 的时长。\n\n因此，数据 $D$ 必须在时间 $t_{\\text{stable}}$ 或之前稳定：\n$$t_{\\text{stable}} = (\\text{master closing time}) - t_{\\text{setup},M} = -t_{\\text{gap}}^{-} - t_{\\text{setup},M}$$\n寄存器建立时间 $t_{\\text{setup,reg}}$ 是从 $t_{\\text{stable}}$ 到参考时钟沿 $t=0$ 这段稳定要求的时长。\n$$t_{\\text{setup,reg}} = 0 - t_{\\text{stable}} = 0 - (-t_{\\text{gap}}^{-} - t_{\\text{setup},M})$$\n$$t_{\\text{setup,reg}} = t_{\\text{gap}}^{-} + t_{\\text{setup},M}$$\n\n**2. 寄存器保持时间 ($t_{\\text{hold,reg}}$) 的推导**\n\n寄存器保持时间 $t_{\\text{hold,reg}}$ 是在有效时钟沿（$t=0$）*之后*寄存器数据输入 $D$ 必须保持稳定的最小时间间隔。该约束确保时钟沿之后的数据变化不会破坏主锁存器正在锁存的值。\n\n主锁存器的保持时间 $t_{\\text{hold},M}$ 要求其输入 $D$ 在其闭合事件 $t=-t_{\\text{gap}}^{-}$ *之后*保持稳定至少 $t_{\\text{hold},M}$ 的时长。\n\n因此，数据 $D$ 必须至少保持稳定到时间 $t_{\\text{hold\\_until}}$：\n$$t_{\\text{hold\\_until}} = (\\text{master closing time}) + t_{\\text{hold},M} = -t_{\\text{gap}}^{-} + t_{\\text{hold},M}$$\n寄存器保持时间 $t_{\\text{hold,reg}}$ 是相对于参考时钟沿 $t=0$ 的这个时间点。正值表示数据必须在时钟沿之后保持，而负值表示数据可以在时钟沿之前改变。\n$$t_{\\text{hold,reg}} = t_{\\text{hold\\_until}} - 0 = -t_{\\text{gap}}^{-} + t_{\\text{hold},M}$$\n$$t_{\\text{hold,reg}} = t_{\\text{hold},M} - t_{\\text{gap}}^{-}$$\n\n**3. 寄存器时钟到输出延迟 ($t_{\\text{CQ,reg}}$) 的推导**\n\n寄存器时钟到输出延迟 $t_{\\text{CQ,reg}}$ 是从有效时钟沿（$t=0$）到新数据出现在寄存器输出 $Q$ 的时间。输出 $Q$ 是从锁存器的输出。\n\n从锁存器在时间 $t = +t_{\\text{gap}}^{+}$ 变为透明。此时，主锁存器的稳定输出被呈现给从锁存器的输入。然后数据通过透明的从锁存器传播。此传播所需的时间是从锁存器的数据到输出传播延迟 $t_{\\text{pd},S}$。\n\n寄存器输出 $Q$ 在等于从锁存器开启时间与其传播延迟之和的时间点变为有效：\n$$t_{Q\\_\\text{valid}} = (\\text{slave opening time}) + t_{\\text{pd},S} = +t_{\\text{gap}}^{+} + t_{\\text{pd},S}$$\n寄存器的时钟到输出延迟是从参考时钟沿 $t=0$ 测量的这个时间间隔。\n$$t_{\\text{CQ,reg}} = t_{Q\\_\\text{valid}} - 0 = t_{\\text{gap}}^{+} + t_{\\text{pd},S}$$\n\n**数值计算**\n\n我们给定以下参数值：\n- $t_{\\text{setup},M} = 24\\,\\text{ps}$\n- $t_{\\text{hold},M} = 16\\,\\text{ps}$\n- $t_{\\text{pd},S} = 70\\,\\text{ps}$\n- $t_{\\text{gap}}^{-} = 35\\,\\text{ps}$\n- $t_{\\text{gap}}^{+} = 45\\,\\text{ps}$\n\n将这些值代入推导出的表达式中：\n\n对于建立时间：\n$$t_{\\text{setup,reg}} = 35\\,\\text{ps} + 24\\,\\text{ps} = 59\\,\\text{ps}$$\n\n对于保持时间：\n$$t_{\\text{hold,reg}} = 16\\,\\text{ps} - 35\\,\\text{ps} = -19\\,\\text{ps}$$\n负保持时间是一个有效的结果，表示输入数据可以在时钟沿之前 $19\\,\\text{ps}$ 改变而不会影响捕获的值。\n\n对于时钟到输出延迟：\n$$t_{\\text{CQ,reg}} = 45\\,\\text{ps} + 70\\,\\text{ps} = 115\\,\\text{ps}$$\n\n问题要求将最终数值结果四舍五入到三位有效数字。\n- $t_{\\text{setup,reg}} = 59\\,\\text{ps} \\rightarrow 59.0\\,\\text{ps}$\n- $t_{\\text{hold,reg}} = -19\\,\\text{ps} \\rightarrow -19.0\\,\\text{ps}$\n- $t_{\\text{CQ,reg}} = 115\\,\\text{ps}$（已经是三位有效数字）\n\n最终答案是三元组 ($t_{\\text{setup,reg}},\\,t_{\\text{hold,reg}},\\,t_{\\text{CQ,reg}}$)。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n59.0  -19.0  115\n\\end{pmatrix}\n}\n$$"
        }
    ]
}