{
    "hands_on_practices": [
        {
            "introduction": "While a simple Gaussian profile is a good first approximation for ion implantation, real-world dopant distributions exhibit significant asymmetry. This exercise introduces the more accurate Pearson family of statistical distributions, which are essential for predictive Technology Computer-Aided Design (TCAD) simulations. You will gain hands-on practice constructing these advanced profiles by linking fundamental ion stopping physics to higher-order statistical moments like skewness and kurtosis. ",
            "id": "4273856",
            "problem": "Consider monoenergetic ion implantation of arsenic into crystalline silicon under front-end-of-line conditions. In the continuous slowing down approximation (CSDA), the stopping power is defined as $S(E) = -\\mathrm{d}E/\\mathrm{d}x$, where $E$ is the ion kinetic energy and $x$ is the depth coordinate. A composite, energy-dependent stopping model intended to capture the electronic and nuclear contributions in the sub-relativistic, keV regime is adopted:\n$$\nS(E) = a + \\frac{b}{\\sqrt{E}},\n$$\nwhere $a$ and $b$ are positive constants. For arsenic in silicon, use $a = 1.0 \\, \\mathrm{keV}/\\mathrm{nm}$ and $b = 0.5 \\, \\mathrm{keV}^{1/2}/\\mathrm{nm}$. The projected range $R_p$ (mean depth) and longitudinal straggle $\\Delta R_p$ (standard deviation of the depth) in the CSDA are defined by the integrals\n$$\nR_p(E_0) = \\int_{0}^{E_0} \\frac{\\mathrm{d}E}{S(E)},\n\\quad\n\\Delta R_p^2(E_0) = c \\int_{0}^{E_0} \\frac{\\mathrm{d}E}{S(E)^2},\n$$\nwith $E_0$ the implant energy and $c$ a constant that aggregates the microscopic scattering power into an effective variance coefficient. Use $c = 0.5 \\, \\mathrm{keV}$.\n\nTo create a Technology Computer-Aided Design (TCAD) ready statistical depth profile, assume the normalized depth distribution can be modeled by a Pearson Type IV probability density function,\n$$\nf(x; \\mu, \\sigma, m, \\nu) \\propto \\left[1 + \\left(\\frac{x - \\mu}{\\sigma}\\right)^2\\right]^{-m} \\exp\\left(\\nu \\arctan\\left(\\frac{x - \\mu}{\\sigma}\\right)\\right),\n$$\nwith shape parameter $m > 2.5$ and skew parameter $\\nu \\in \\mathbb{R}$. Let $z = (x - \\mu)/\\sigma$ denote the standardized variable. The Pearson Type IV distribution has a finite mean, variance, skewness, and kurtosis for $m > 2.5$. The standardized skewness $\\gamma_1$ and kurtosis $\\gamma_2$ are defined by\n$$\n\\gamma_1 = \\frac{\\mathbb{E}\\left[(z - \\mathbb{E}[z])^3\\right]}{\\left(\\mathbb{V}[z]\\right)^{3/2}},\n\\quad\n\\gamma_2 = \\frac{\\mathbb{E}\\left[(z - \\mathbb{E}[z])^4\\right]}{\\left(\\mathbb{V}[z]\\right)^{2}},\n$$\nwhere $\\mathbb{E}[\\cdot]$ and $\\mathbb{V}[\\cdot]$ denote expectation and variance, respectively, under $f$ with $\\mu = 0$ and $\\sigma = 1$. To capture energy-dependent asymmetry and tail weight driven by the nuclear-to-total stopping fraction, set target standardized skewness and kurtosis at implant energy $E_0$ as\n$$\n\\phi(E_0) = \\frac{\\frac{b}{\\sqrt{E_0}}}{a + \\frac{b}{\\sqrt{E_0}}},\n\\quad\n\\gamma_1^{\\star}(E_0) = \\gamma_{10}\\ \\phi(E_0),\n\\quad\n\\gamma_2^{\\star}(E_0) = 3 + \\delta\\ \\phi(E_0),\n$$\nwith $\\gamma_{10} = 1.2$ and $\\delta = 2.0$. For each $E_0$, fit $(m,\\nu)$ so that the Pearson Type IV distribution standardized skewness and kurtosis equal $\\gamma_1^{\\star}(E_0)$ and $\\gamma_2^{\\star}(E_0)$, respectively. Then, use the fitted $(m,\\nu)$ to compute the standardized mean $\\mathbb{E}[z]$ and standardized standard deviation $\\sqrt{\\mathbb{V}[z]}$, and set the physical Pearson IV parameters $(\\mu,\\sigma)$ to match the CSDA $R_p(E_0)$ and $\\Delta R_p(E_0)$ via\n$$\n\\sigma(E_0) = \\frac{\\Delta R_p(E_0)}{\\sqrt{\\mathbb{V}[z]}},\n\\quad\n\\mu(E_0) = R_p(E_0) - \\sigma(E_0)\\ \\mathbb{E}[z].\n$$\n\nYour program must:\n- Implement the above definitions and compute $R_p(E_0)$ in nanometers and $\\Delta R_p(E_0)$ in nanometers for the specified $E_0$ values.\n- Fit $(m,\\nu)$ for each $E_0$ by matching the standardized skewness and kurtosis using numerical integration and a root-finding method over $(m,\\nu)$ with the constraints $m > 2.5$ and $\\nu \\in \\mathbb{R}$. The numerical integration must evaluate the normalization constant and moments of the Pearson Type IV using the substitution $z = \\tan(\\theta)$, $\\theta \\in (-\\pi/2, \\pi/2)$, and the identities $\\arctan(z) = \\theta$ and $1 + z^2 = 1/\\cos^2(\\theta)$.\n- Determine $(\\mu,\\sigma)$ to ensure the Pearson IV distribution has mean $R_p(E_0)$ and standard deviation $\\Delta R_p(E_0)$.\n\nPhysical units:\n- Report $R_p$ in nanometers and $\\Delta R_p$ in nanometers, each rounded to six decimal places.\n- The parameters $m$ and $\\nu$ are dimensionless and must be reported as floats rounded to six decimal places.\n- Report $\\mu$ in nanometers and $\\sigma$ in nanometers, each rounded to six decimal places.\n\nTest suite:\n- Use implant energies $E_0$ in $\\mathrm{keV}$: $E_0 \\in \\{2, 5, 10, 20, 40\\}$, covering shallow, intermediate, and deeper implants.\n- The program must handle the boundary behavior near $\\theta = \\pm \\pi/2$ in the Pearson Type IV integrals.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one $E_0$ and must be a list in the order $[R_p,\\Delta R_p,m,\\nu,\\mu,\\sigma]$. For example, an output could look like\n$$\n[\\,[R_{p,2},\\Delta R_{p,2},m_2,\\nu_2,\\mu_2,\\sigma_2],\\,[R_{p,5},\\Delta R_{p,5},m_5,\\nu_5,\\mu_5,\\sigma_5],\\,\\dots\\,],\n$$\nwith all numeric entries formatted as floats rounded to six decimal places and with $R_p$, $\\Delta R_p$, $\\mu$, and $\\sigma$ in nanometers.",
            "solution": "The user-provided problem is a valid, well-posed, and scientifically grounded exercise in computational physics and statistics, relevant to the field of integrated circuit process modeling. The problem asks for the calculation of ion implantation profile parameters by combining analytical solutions, numerical integration, and numerical root-finding. All necessary constants, formulas, and constraints are provided, and the units are consistent. The problem is free of any of the invalidity criteria. We may therefore proceed with a full solution.\n\nThe solution is implemented in a step-by-step fashion for each implant energy $E_0$:\n\n1.  **Calculation of Projected Range ($R_p$) and Straggle ($\\Delta R_p$)**:\n    The stopping power is given by $S(E) = a + b/\\sqrt{E}$. The projected range $R_p(E_0)$ and squared longitudinal straggle $\\Delta R_p^2(E_0)$ are defined by integrals over the energy $E$:\n    $$\n    R_p(E_0) = \\int_{0}^{E_0} \\frac{\\mathrm{d}E}{a + b/\\sqrt{E}}\n    $$\n    $$\n    \\Delta R_p^2(E_0) = c \\int_{0}^{E_0} \\frac{\\mathrm{d}E}{(a + b/\\sqrt{E})^2}\n    $$\n    These integrals can be solved analytically using the substitution $u = \\sqrt{E}$, which implies $\\mathrm{d}E = 2u\\,\\mathrm{d}u$. The resulting integrals of rational functions in $u$ yield the following closed-form expressions:\n    $$\n    R_p(E_0) = \\frac{1}{a^3} \\left[ a^2 E_0 - 2ab\\sqrt{E_0} + 2b^2 \\ln\\left(\\frac{a\\sqrt{E_0}}{b} + 1\\right) \\right]\n    $$\n    $$\n    \\Delta R_p^2(E_0) = \\frac{2c}{a^4} \\left[ \\frac{a^2 E_0}{2} - 2ab\\sqrt{E_0} - b^2 + \\frac{b^3}{a\\sqrt{E_0}+b} + 3b^2\\ln\\left(\\frac{a\\sqrt{E_0}}{b}+1\\right) \\right]\n    $$\n    These formulas are implemented directly to compute $R_p(E_0)$ and $\\Delta R_p(E_0) = \\sqrt{\\Delta R_p^2(E_0)}$ for each given energy $E_0$.\n\n2.  **Calculation of Target Skewness and Kurtosis**:\n    The target standardized skewness $\\gamma_1^{\\star}$ and kurtosis $\\gamma_2^{\\star}$ are functions of the implant energy $E_0$ through the proxy variable $\\phi(E_0)$, which represents the fraction of nuclear stopping to total stopping power.\n    $$\n    \\phi(E_0) = \\frac{b/\\sqrt{E_0}}{a + b/\\sqrt{E_0}}, \\quad \\gamma_1^{\\star}(E_0) = \\gamma_{10}\\ \\phi(E_0), \\quad \\gamma_2^{\\star}(E_0) = 3 + \\delta\\ \\phi(E_0)\n    $$\n    With the given constants $\\gamma_{10} = 1.2$ and $\\delta = 2.0$, these target values are computed for each $E_0$.\n\n3.  **Fitting of Pearson Type IV Parameters $(m, \\nu)$**:\n    The core of the problem is to find the Pearson IV shape parameters $(m, \\nu)$ such that its theoretical skewness and kurtosis match the target values $(\\gamma_1^{\\star}, \\gamma_2^{\\star})$. The standardized Pearson IV probability density function (unnormalized) is $g(z; m, \\nu) \\propto (1+z^2)^{-m} \\exp(\\nu \\arctan z)$. To find its moments, we use the substitution $z = \\tan\\theta$, as specified. The $k$-th raw moment $M_k = \\int_{-\\infty}^{\\infty} z^k g(z)\\,\\mathrm{d}z$ becomes:\n    $$\n    M_k(m, \\nu) = \\int_{-\\pi/2}^{\\pi/2} (\\tan\\theta)^k (\\cos\\theta)^{2m-2} e^{\\nu\\theta} \\mathrm{d}\\theta\n    $$\n    These integrals are computed numerically for $k=0, 1, 2, 3, 4$ using `scipy.integrate.quad`. The constraint $m > 2.5$ ensures these integrals converge. From these raw moments, the standardized mean $\\mu_z = M_1/M_0$ and variance $\\sigma_z^2 = M_2/M_0 - \\mu_z^2$ are found. Then, the centered moments $\\mu_3' = \\mathbb{E}[(z-\\mu_z)^3]$ and $\\mu_4' = \\mathbb{E}[(z-\\mu_z)^4]$ are calculated, leading to the skewness $\\gamma_1 = \\mu_3'/\\sigma_z^3$ and kurtosis $\\gamma_2 = \\mu_4'/\\sigma_z^4$.\n\n    We then define a system of two nonlinear equations:\n    $$\n    f_1(m, \\nu) = \\gamma_1(m, \\nu) - \\gamma_1^{\\star}(E_0) = 0\n    $$\n    $$\n    f_2(m, \\nu) = \\gamma_2(m, \\nu) - \\gamma_2^{\\star}(E_0) = 0\n    $$\n    This system is solved for $(m, \\nu)$ using a numerical root-finding algorithm, `scipy.optimize.root`. An initial guess for the solver is derived from approximate relations between moments and Pearson parameters. To improve performance, the computationally intensive moment calculation is memoized using `@functools.lru_cache`.\n\n4.  **Determination of Physical Profile Parameters $(\\mu, \\sigma)$**:\n    Once the optimal $(m_{\\text{fit}}, \\nu_{\\text{fit}})$ are found, the corresponding standardized mean $\\mu_z^{\\text{fit}}$ and standard deviation $\\sigma_z^{\\text{fit}} = \\sqrt{\\mathbb{V}[z]}$ are computed. The physical location parameter $\\mu$ and scale parameter $\\sigma$ of the final Pearson IV distribution are then set to match the previously calculated $R_p(E_0)$ and $\\Delta R_p(E_0)$:\n    $$\n    \\mathbb{E}[x] = \\mu + \\sigma \\mu_z^{\\text{fit}} = R_p(E_0)\n    $$\n    $$\n    \\sqrt{\\mathbb{V}[x]} = \\sigma \\sigma_z^{\\text{fit}} = \\Delta R_p(E_0)\n    $$\n    Solving this system gives:\n    $$\n    \\sigma(E_0) = \\frac{\\Delta R_p(E_0)}{\\sigma_z^{\\text{fit}}}\n    $$\n    $$\n    \\mu(E_0) = R_p(E_0) - \\sigma(E_0)\\ \\mu_z^{\\text{fit}}\n    $$\n    This procedure yields all six required parameters ($R_p, \\Delta R_p, m, \\nu, \\mu, \\sigma$) for each implant energy. The final output is formatted as a list of lists, with all numerical values rounded to six decimal places.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate, optimize\nimport functools\n\ndef solve():\n    \"\"\"\n    Main function to solve the ion implantation problem for the given test cases.\n    \"\"\"\n    # Physical and model constants\n    a = 1.0  # keV/nm\n    b = 0.5  # keV^(1/2)/nm\n    c = 0.5  # keV\n    gamma10 = 1.2  # dimensionless\n    delta = 2.0  # dimensionless\n\n    def calculate_Rp_DeltaRp(E0: float) - tuple[float, float]:\n        \"\"\"Calculates Rp and Delta_Rp using analytical formulas.\"\"\"\n        sqrt_E0 = np.sqrt(E0)\n        \n        # R_p calculation based on the analytical integral solution\n        # R_p(E_0) = (1/a^3) * [a^2*E_0 - 2*a*b*sqrt(E_0) + 2*b^2*ln(a*sqrt(E_0)/b + 1)]\n        term1_Rp = a**2 * E0\n        term2_Rp = -2 * a * b * sqrt_E0\n        term3_Rp = 2 * b**2 * np.log((a * sqrt_E0 / b) + 1)\n        Rp = (1 / a**3) * (term1_Rp + term2_Rp + term3_Rp)\n\n        # Delta_Rp^2 calculation based on the analytical integral solution\n        # Delta_Rp^2(E0) = (2c/a^4) * [a^2*E0/2 - 2ab*sqrt(E0) - b^2 + b^3/(a*sqrt(E0)+b) + 3b^2*ln(a*sqrt(E0)/b+1)]\n        term1_DRp2 = a**2 * E0 / 2\n        term2_DRp2 = -2 * a * b * sqrt_E0\n        term3_DRp2 = -b**2\n        term4_DRp2 = b**3 / (a * sqrt_E0 + b)\n        term5_DRp2 = 3 * b**2 * np.log((a * sqrt_E0 / b) + 1)\n        Delta_Rp2 = (2 * c / a**4) * (term1_DRp2 + term2_DRp2 + term3_DRp2 + term4_DRp2 + term5_DRp2)\n        \n        Delta_Rp = np.sqrt(Delta_Rp2)\n        return Rp, Delta_Rp\n\n    def calculate_target_skew_kurt(E0: float) - tuple[float, float]:\n        \"\"\"Calculates target skewness and kurtosis for a given energy E0.\"\"\"\n        sqrt_E0 = np.sqrt(E0)\n        phi_E0 = (b / sqrt_E0) / (a + b / sqrt_E0)\n        gamma1_star = gamma10 * phi_E0\n        gamma2_star = 3.0 + delta * phi_E0\n        return gamma1_star, gamma2_star\n\n    def pearson_integrand(theta: float, k: int, m: float, nu: float) - float:\n        \"\"\"Integrand for the k-th moment of the standardized Pearson IV distribution after z=tan(theta) transform.\"\"\"\n        cos_theta = np.cos(theta)\n        # The term cos(theta) is zero at the boundaries, making the integrand zero if 2m-2  0.\n        if np.isclose(cos_theta, 0.0):\n            return 0.0\n        \n        # integrand is (tan(theta))^k * (cos(theta))^(2m-2) * exp(nu*theta)\n        # = sin(theta)^k * cos(theta)^(2m-2-k) * exp(nu*theta) for stability\n        base_term = (np.sin(theta)**k) * (cos_theta**(2*m - 2 - k))\n        return base_term * np.exp(nu * theta)\n\n    @functools.lru_cache(maxsize=256)\n    def get_pearson_shape_params(m: float, nu: float) - tuple[float, float, float, float] | tuple[None, None, float, float]:\n        \"\"\"Computes standardized mean, std dev, skewness, and kurtosis for given m and nu.\"\"\"\n        if m = 2.5:\n            return None, None, 1e6, 1e6 # Return large error for invalid m\n\n        try:\n            moments_raw = [integrate.quad(pearson_integrand, -np.pi/2, np.pi/2, args=(k, m, nu))[0] for k in range(5)]\n        except Exception:\n            return None, None, 1e6, 1e6\n\n        M0, M1, M2, M3, M4 = moments_raw\n        if M0  1e-9: return None, None, 1e6, 1e6\n\n        mu_z = M1 / M0\n        var_z = (M2 / M0) - mu_z**2\n        \n        if var_z = 0: return None, None, 1e6, 1e6\n        std_z = np.sqrt(var_z)\n\n        mu3_c = (M3 / M0) - 3 * mu_z * (M2 / M0) + 2 * mu_z**3\n        mu4_c = (M4 / M0) - 4 * mu_z * (M3 / M0) + 6 * mu_z**2 * (M2 / M0) - 3 * mu_z**4\n        \n        gamma1 = mu3_c / (std_z**3)\n        gamma2 = mu4_c / (std_z**4)\n        \n        return mu_z, std_z, gamma1, gamma2\n\n    def solve_for_one_energy(E0: float) - list[float]:\n        \"\"\"Performs all calculations for a single energy value.\"\"\"\n        Rp, Delta_Rp = calculate_Rp_DeltaRp(E0)\n        gamma1_star, gamma2_star = calculate_target_skew_kurt(E0)\n        \n        # Initial guess for (m, nu)\n        excess_kurtosis = gamma2_star - 3.0\n        m0 = 2.5 + 3.0 / excess_kurtosis if excess_kurtosis  1e-6 else 50.0\n        nu0 = -gamma1_star * (2 * m0 - 3) / 2.0\n        initial_guess = [m0, nu0]\n        \n        def objective_func(x):\n            m, nu = x[0], x[1]\n            _, _, gamma1, gamma2 = get_pearson_shape_params(m, nu)\n            if gamma1  1e5: return [1e6, 1e6]\n            return [gamma1 - gamma1_star, gamma2 - gamma2_star]\n\n        sol = optimize.root(objective_func, initial_guess, method='hybr', tol=1e-9)\n        m_fit, nu_fit = sol.x\n\n        mu_z_fit, std_z_fit, _, _ = get_pearson_shape_params(m_fit, nu_fit)\n        \n        sigma = Delta_Rp / std_z_fit\n        mu = Rp - sigma * mu_z_fit\n        \n        return [Rp, Delta_Rp, m_fit, nu_fit, mu, sigma]\n\n    test_cases_E0 = [2.0, 5.0, 10.0, 20.0, 40.0]\n    results = [solve_for_one_energy(E0) for E0 in test_cases_E0]\n        \n    sublist_strs = [f\"[{','.join(f'{x:.6f}' for x in sublist)}]\" for sublist in results]\n    final_output = f\"[{','.join(sublist_strs)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Following implantation, thermal annealing activates dopants but also causes them to diffuse, redrawing the junctions. This practice explores how the choice of annealing ambient—inert gas versus an oxidizing one—critically alters the final dopant profile. By modeling the interplay between diffusion, silicon consumption, and Oxidation-Enhanced Diffusion (OED), you will quantify competing effects that are fundamental to modern process integration. ",
            "id": "4273844",
            "problem": "You are given a one-dimensional planar silicon substrate undergoing front-end-of-line (FEOL) processing within Integrated Circuits and Electronic Design Automation (EDA). A phosphorus ion implantation produces an initial dopant profile that is well-approximated by a Gaussian distribution in depth. The wafer is then annealed at a fixed temperature of $1000\\,^{\\circ}\\mathrm{C}$ for $30\\ \\mathrm{min}$, either in an inert ambient (no oxidation) or in an oxidizing ambient (simultaneous oxidation). Your task is to compute the change in junction depth caused by oxidation relative to the inert ambient anneal.\n\nFundamental base and modeling assumptions:\n- The phosphorus concentration $C(x,t)$ evolves under isothermal diffusion governed by Fick's second law with constant diffusivity $D$: $\\displaystyle \\frac{\\partial C}{\\partial t} = D \\frac{\\partial^2 C}{\\partial x^2}$.\n- The initial phosphorus profile after ion implantation is Gaussian with total implanted dose $Q$ (sheet density), projected range $R_p$, and straggle $\\Delta R_p$: $$C(x,0) = \\frac{Q}{\\sqrt{2\\pi}\\,\\Delta R_p}\\exp\\left(-\\frac{(x-R_p)^2}{2\\Delta R_p^2}\\right).$$\n- For a constant $D$, the solution remains Gaussian with increasing variance: $$C(x,t) = \\frac{Q}{\\sqrt{2\\pi}\\,\\sigma(t)}\\exp\\left(-\\frac{(x-R_p)^2}{2\\sigma(t)^2}\\right),\\quad \\sigma(t) = \\sqrt{\\Delta R_p^2 + 2 D t}.$$\n- The junction depth $x_j(t)$ is defined as the position where the phosphorus concentration equals the background acceptor concentration $N_A$ (i.e., $C(x_j,t) = N_A$), assuming $C(x,t)$ represents electrically active dopant.\n- Under simultaneous oxidation, the oxidized thickness $x_{\\mathrm{ox}}(t)$ obeys the Deal–Grove model (neglecting initial oxide): $$x_{\\mathrm{ox}}^2 + A\\,x_{\\mathrm{ox}} = B\\,t,$$ where $A$ is the linear rate constant and $B$ is the parabolic rate constant, with $t$ in minutes and $x_{\\mathrm{ox}}$ in micrometers. The oxidation rate at time $t$ is $$v_{\\mathrm{ox}}(t) = \\frac{d x_{\\mathrm{ox}}}{dt} = \\frac{B}{2 x_{\\mathrm{ox}} + A}.$$\n- Oxidation-Enhanced Diffusion (OED) is modeled via an effective diffusivity $D_{\\mathrm{ox}} = D_{\\mathrm{inert}} M$, where $M = 1 + \\gamma\\,v_{\\mathrm{ox}}(t)$ and $\\gamma$ is a proportionality constant capturing the interstitial supersaturation effect induced by oxidation (simplified surrogate model).\n- Silicon consumption by oxidation moves the silicon surface inward. The consumed silicon thickness is $\\eta\\,x_{\\mathrm{ox}}$, where $\\eta = 0.44$ relates silicon consumption to oxide growth. The measured junction depth after oxidation is the chemically diffused junction depth referenced to the original surface minus the consumed silicon thickness.\n- If $C(x,t)$ never equals $N_A$ for $x \\ge 0$, the junction depth does not exist; return a sentinel value of $-1$ for that test case.\n\nConstants and units:\n- Temperature: $T = 1000\\,^{\\circ}\\mathrm{C} = 1273.15\\ \\mathrm{K}$.\n- Anneal duration: $t = 30\\ \\mathrm{min} = 1800\\ \\mathrm{s}$.\n- Boltzmann constant: $k_{\\mathrm{B}} = 8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}$.\n- Phosphorus intrinsic diffusivity Arrhenius parameters in silicon: $D_0 = 10.5\\ \\mathrm{cm}^2/\\mathrm{s}$, $E_a = 3.69\\ \\mathrm{eV}$, so $D_{\\mathrm{inert}} = D_0 \\exp\\!\\left(-\\frac{E_a}{k_{\\mathrm{B}} T}\\right)$.\n- Deal–Grove constants at $1000\\,^{\\circ}\\mathrm{C}$:\n  - Dry oxidation: $A_{\\mathrm{dry}} = 0.04\\ \\mu\\mathrm{m}$, $B_{\\mathrm{dry}} = 2.0\\times 10^{-4}\\ \\mu\\mathrm{m}^2/\\mathrm{min}$.\n  - Wet oxidation: $A_{\\mathrm{wet}} = 0.02\\ \\mu\\mathrm{m}$, $B_{\\mathrm{wet}} = 1.0\\times 10^{-2}\\ \\mu\\mathrm{m}^2/\\mathrm{min}$.\n- OED proportionality: $\\gamma = 50\\ \\mathrm{min}/\\mu\\mathrm{m}$.\n- Silicon consumption factor: $\\eta = 0.44$.\n- Spatial unit consistency: lengths for diffusion are computed in $\\mathrm{cm}$ internally; output junction depth changes must be in micrometers.\n\nComputation steps for each test case:\n1. Compute $D_{\\mathrm{inert}}$ from the Arrhenius model.\n2. Compute $\\sigma_{\\mathrm{inert}} = \\sqrt{\\Delta R_p^2 + 2 D_{\\mathrm{inert}} t}$ using $\\Delta R_p$ in $\\mathrm{cm}$ and $t$ in $\\mathrm{s}$.\n3. Compute the inert-ambient junction depth $x_{j,\\mathrm{inert}}$ by solving $$\\frac{Q}{\\sqrt{2\\pi}\\,\\sigma_{\\mathrm{inert}}}\\exp\\left(-\\frac{(x-R_p)^2}{2\\sigma_{\\mathrm{inert}}^2}\\right) = N_A.$$ This yields the deeper solution $$x_{j,\\mathrm{inert}} = R_p + \\sigma_{\\mathrm{inert}}\\sqrt{2\\ln\\!\\left(\\frac{Q}{\\sqrt{2\\pi}\\,\\sigma_{\\mathrm{inert}}\\,N_A}\\right)}$$ when $\\frac{Q}{\\sqrt{2\\pi}\\,\\sigma_{\\mathrm{inert}}} > N_A$; otherwise no junction exists.\n4. For oxidation, compute $x_{\\mathrm{ox}}$ by solving $x_{\\mathrm{ox}}^2 + A x_{\\mathrm{ox}} = B t$ with $t$ in $\\mathrm{min}$ to obtain $$x_{\\mathrm{ox}} = \\frac{-A + \\sqrt{A^2 + 4 B t}}{2}.$$ Then compute $v_{\\mathrm{ox}} = B/(2 x_{\\mathrm{ox}} + A)$ and the OED multiplier $M = 1 + \\gamma v_{\\mathrm{ox}}$.\n5. Compute $\\sigma_{\\mathrm{ox}} = \\sqrt{\\Delta R_p^2 + 2 D_{\\mathrm{inert}} M t}$ and $x_{j,\\mathrm{ox,orig}}$ using the same Gaussian crossing formula at $N_A$ as in step 3 but with $\\sigma_{\\mathrm{ox}}$.\n6. Adjust for surface consumption to get the measured junction depth after oxidation: $$x_{j,\\mathrm{ox,meas}} = x_{j,\\mathrm{ox,orig}} - \\eta\\,x_{\\mathrm{ox}},$$ where $x_{\\mathrm{ox}}$ is converted to $\\mathrm{cm}$ before subtraction.\n7. Compute the change in junction depth in micrometers: $$\\Delta x_j = \\left(x_{j,\\mathrm{ox,meas}} - x_{j,\\mathrm{inert}}\\right)\\times 10^{4}.$$ If either inert or oxidation case has no valid junction depth, return $-1$.\n8. Express the final answers in micrometers as floats.\n\nTest suite:\nProvide the following four parameter sets to test coverage including typical conditions, strong oxidation, and edge cases:\n- Case 1 (typical dry oxidation): ambient $=$ dry; $Q = 2.0\\times 10^{14}\\ \\mathrm{cm}^{-2}$; $R_p = 0.08\\ \\mu\\mathrm{m}$; $\\Delta R_p = 0.03\\ \\mu\\mathrm{m}$; $N_A = 1.0\\times 10^{15}\\ \\mathrm{cm}^{-3}$.\n- Case 2 (typical wet oxidation): ambient $=$ wet; $Q = 2.0\\times 10^{14}\\ \\mathrm{cm}^{-2}$; $R_p = 0.08\\ \\mu\\mathrm{m}$; $\\Delta R_p = 0.03\\ \\mu\\mathrm{m}$; $N_A = 1.0\\times 10^{15}\\ \\mathrm{cm}^{-3}$.\n- Case 3 (edge: no junction due to high background doping and low dose): ambient $=$ dry; $Q = 5.0\\times 10^{12}\\ \\mathrm{cm}^{-2}$; $R_p = 0.05\\ \\mu\\mathrm{m}$; $\\Delta R_p = 0.02\\ \\mu\\mathrm{m}$; $N_A = 5.0\\times 10^{18}\\ \\mathrm{cm}^{-3}$.\n- Case 4 (wet oxidation with large straggle): ambient $=$ wet; $Q = 1.0\\times 10^{14}\\ \\mathrm{cm}^{-2}$; $R_p = 0.04\\ \\mu\\mathrm{m}$; $\\Delta R_p = 0.08\\ \\mu\\mathrm{m}$; $N_A = 5.0\\times 10^{15}\\ \\mathrm{cm}^{-3}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$). Each $result_i$ must be either a float in micrometers (for valid junction depth changes) or the integer $-1$ (for invalid/no-junction cases). No additional text should be printed.",
            "solution": "The problem presents a well-defined, scientifically grounded exercise in modeling front-end-of-line (FEOL) semiconductor processes. It combines models for ion implantation, thermal diffusion, and thermal oxidation to determine the effect of an oxidizing ambient on dopant profiles and junction depths. The models provided, including the Gaussian approximation for dopant profiles, Fick's second law for diffusion, the Deal-Grove model for oxidation, and a simplified model for Oxidation-Enhanced Diffusion (OED), are standard, albeit simplified, representations used in process simulation. All necessary physical constants, material parameters, and process conditions are provided, and the computational steps are explicitly outlined. The problem is self-contained, logically consistent, and free of scientific or factual unsoundness. We may therefore proceed with a formal solution.\n\nThe objective is to calculate the change in junction depth, $\\Delta x_j$, when an anneal is performed in an oxidizing ambient compared to an inert ambient. This requires computing the junction depth for two scenarios and finding their difference. The junction depth, $x_j$, is the location where the dopant concentration, $C(x,t)$, equals the background substrate doping, $N_A$. All length calculations will be performed in units of centimeters ($\\mathrm{cm}$) and converted to micrometers ($\\mu\\mathrm{m}$) for the final output.\n\nThe initial dopant profile after ion implantation is given as a Gaussian function:\n$$C(x,0) = \\frac{Q}{\\sqrt{2\\pi}\\,\\Delta R_p}\\exp\\left(-\\frac{(x-R_p)^2}{2\\Delta R_p^2}\\right)$$\nwhere $Q$ is the implanted dose, $R_p$ is the projected range, and $\\Delta R_p$ is the straggle.\n\nDuring a subsequent thermal anneal of duration $t$ at temperature $T$, the dopants diffuse. Assuming constant diffusivity $D$, the concentration profile remains Gaussian, but its standard deviation increases:\n$$C(x,t) = \\frac{Q}{\\sqrt{2\\pi}\\,\\sigma(t)}\\exp\\left(-\\frac{(x-R_p)^2}{2\\sigma(t)^2}\\right)$$\nThe time-dependent standard deviation, $\\sigma(t)$, is given by the convolution of the initial Gaussian profile with the Gaussian Green's function for diffusion, resulting in:\n$$\\sigma(t) = \\sqrt{\\Delta R_p^2 + 2 D t}$$\nThis quantity, $2Dt$, is often referred to as the diffusion length squared.\n\nFirst, we establish a baseline by calculating the junction depth for an anneal in an inert ambient.\n1.  **Compute Inert Diffusivity ($D_{\\mathrm{inert}}$)**: The diffusivity of phosphorus in silicon is temperature-dependent and follows an Arrhenius relationship:\n    $$D_{\\mathrm{inert}} = D_0 \\exp\\left(-\\frac{E_a}{k_{\\mathrm{B}} T}\\right)$$\n    Using the provided constants $D_0 = 10.5\\ \\mathrm{cm}^2/\\mathrm{s}$, $E_a = 3.69\\ \\mathrm{eV}$, $k_{\\mathrm{B}} = 8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}$, and $T = 1273.15\\ \\mathrm{K}$, we calculate the intrinsic diffusivity a priori.\n\n2.  **Compute Inert Junction Depth ($x_{j,\\mathrm{inert}}$)**: We first determine the diffused profile standard deviation $\\sigma_{\\mathrm{inert}}$ using $D = D_{\\mathrm{inert}}$, the anneal time $t = 1800\\ \\mathrm{s}$, and the initial straggle $\\Delta R_p$ (converted from $\\mu\\mathrm{m}$ to $\\mathrm{cm}$).\n    $$\\sigma_{\\mathrm{inert}} = \\sqrt{\\Delta R_p^2 + 2 D_{\\mathrm{inert}} t}$$\n    The junction depth $x_{j,\\mathrm{inert}}$ is found by setting $C(x,t) = N_A$ and solving for $x$. This requires the peak concentration $C_{peak} = \\frac{Q}{\\sqrt{2\\pi}\\,\\sigma_{\\mathrm{inert}}}$ to be greater than the background concentration $N_A$. If $C_{peak} \\le N_A$, no junction is formed, and the analysis for that test case terminates with a sentinel value of $-1$. Otherwise, rearranging the concentration equation yields two solutions for $x$; we take the deeper one:\n    $$x_{j,\\mathrm{inert}} = R_p + \\sigma_{\\mathrm{inert}}\\sqrt{2\\ln\\left(\\frac{Q}{\\sqrt{2\\pi}\\,\\sigma_{\\mathrm{inert}} N_A}\\right)}$$\n    Both $R_p$ and $\\Delta R_p$ are converted to $\\mathrm{cm}$ for this calculation.\n\nNext, we analyze the case of annealing in an oxidizing ambient, which introduces two competing effects: Oxidation-Enhanced Diffusion (OED) and silicon consumption at the surface.\n\n3.  **Model Oxidation**: The thickness of the grown oxide, $x_{\\mathrm{ox}}$, is calculated using the Deal-Grove model for the full anneal duration $t = 30\\ \\mathrm{min}$. We solve the quadratic equation $x_{\\mathrm{ox}}^2 + A\\,x_{\\mathrm{ox}} - B\\,t = 0$ for $x_{\\mathrm{ox}}$:\n    $$x_{\\mathrm{ox}} = \\frac{-A + \\sqrt{A^2 + 4 B t}}{2}$$\n    The constants $A$ and $B$ depend on the ambient (dry or wet).\n    The OED effect is linked to the oxidation rate. The problem specifies a simplified model where the diffusivity enhancement is proportional to the oxidation rate at the end of the process, $t = 30\\ \\mathrm{min}$.\n    $$v_{\\mathrm{ox}} = \\frac{B}{2 x_{\\mathrm{ox}} + A}$$\n    Using this rate, we compute the OED multiplier $M$:\n    $$M = 1 + \\gamma v_{\\mathrm{ox}}$$\n    where $\\gamma = 50\\ \\mathrm{min}/\\mu\\mathrm{m}$. The enhanced diffusivity is then $D_{\\mathrm{ox}} = D_{\\mathrm{inert}} M$.\n\n4.  **Compute Oxidizing-Ambient Junction Depth ($x_{j,\\mathrm{ox,meas}}$)**: The calculation proceeds similarly to the inert case, but with the enhanced diffusivity. The standard deviation of the profile is now:\n    $$\\sigma_{\\mathrm{ox}} = \\sqrt{\\Delta R_p^2 + 2 D_{\\mathrm{inert}} M t}$$\n    This gives the junction depth relative to the original silicon surface, $x_{j,\\mathrm{ox,orig}}$:\n    $$x_{j,\\mathrm{ox,orig}} = R_p + \\sigma_{\\mathrm{ox}}\\sqrt{2\\ln\\left(\\frac{Q}{\\sqrt{2\\pi}\\,\\sigma_{\\mathrm{ox}} N_A}\\right)}$$\n    Again, this calculation is only valid if a junction is formed (i.e., peak concentration exceeds $N_A$). If not, the case is invalid.\n    As silicon is oxidized, the silicon surface recedes. For an oxide thickness of $x_{\\mathrm{ox}}$, a thickness of $\\eta\\,x_{\\mathrm{ox}}$ of silicon is consumed, where $\\eta=0.44$. The measured junction depth is referenced from the *new* silicon surface.\n    $$x_{j,\\mathrm{ox,meas}} = x_{j,\\mathrm{ox,orig}} - \\eta\\,x_{\\mathrm{ox}}$$\n    Here, $x_{\\mathrm{ox}}$ must be converted from $\\mu\\mathrm{m}$ into $\\mathrm{cm}$ before the subtraction.\n\n5.  **Calculate Junction Depth Change ($\\Delta x_j$)**: The final step is to compute the difference between the measured junction depths in the two scenarios and convert the result to micrometers.\n    $$\\Delta x_j = (x_{j,\\mathrm{ox,meas}} - x_{j,\\mathrm{inert}}) \\times 10^4$$\n    If either the inert or oxidizing case failed to produce a junction, the result for that entire test case is $-1$.\n\nBy implementing these steps for each test case provided, we can systematically determine the impact of oxidation on the final dopant profile.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the FEOL processing problem for all test cases.\n    \"\"\"\n\n    # --- Constants and Physical Parameters ---\n    T_K = 1273.15  # Temperature in Kelvin (1000 C)\n    t_sec = 1800.0  # Anneal duration in seconds (30 min)\n    t_min = 30.0    # Anneal duration in minutes\n    k_B = 8.617333262145e-5  # Boltzmann constant in eV/K\n    \n    # Phosphorus intrinsic diffusivity parameters\n    D0 = 10.5  # cm^2/s\n    Ea = 3.69  # eV\n    \n    # Deal-Grove constants at 1000 C\n    A_dry = 0.04  # um\n    B_dry = 2.0e-4 # um^2/min\n    A_wet = 0.02  # um\n    B_wet = 1.0e-2 # um^2/min\n    \n    # OED and Si consumption parameters\n    gamma = 50.0  # min/um\n    eta = 0.44    # Dimensionless Si consumption factor\n\n    # Store constants in a dictionary for easy passing\n    constants = {\n        'T_K': T_K, 't_sec': t_sec, 't_min': t_min, 'k_B': k_B,\n        'D0': D0, 'Ea': Ea, 'A_dry': A_dry, 'B_dry': B_dry,\n        'A_wet': A_wet, 'B_wet': B_wet, 'gamma': gamma, 'eta': eta\n    }\n\n    # --- Test Cases ---\n    test_cases = [\n        # (ambient, Q [cm^-2], Rp [um], dRp [um], NA [cm^-3])\n        ('dry', 2.0e14, 0.08, 0.03, 1.0e15),\n        ('wet', 2.0e14, 0.08, 0.03, 1.0e15),\n        ('dry', 5.0e12, 0.05, 0.02, 5.0e18),\n        ('wet', 1.0e14, 0.04, 0.08, 5.0e15),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_delta_xj(case, constants)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_delta_xj(case_params, constants):\n    \"\"\"\n    Calculates the change in junction depth for a single test case.\n    \"\"\"\n    ambient, Q, Rp_um, dRp_um, NA = case_params\n    c = constants\n\n    # --- Unit Conversions ---\n    Rp_cm = Rp_um * 1e-4\n    dRp_cm = dRp_um * 1e-4\n\n    # --- Step 1: Compute Inert Diffusivity (D_inert) ---\n    D_inert = c['D0'] * np.exp(-c['Ea'] / (c['k_B'] * c['T_K']))\n\n    # --- Steps 2  3: Inert Anneal Case ---\n    sigma_inert_sq = dRp_cm**2 + 2 * D_inert * c['t_sec']\n    sigma_inert_cm = np.sqrt(sigma_inert_sq)\n    \n    peak_conc_inert = Q / (np.sqrt(2 * np.pi) * sigma_inert_cm)\n    \n    xj_inert_cm = -1.0\n    if peak_conc_inert  NA:\n        log_arg = peak_conc_inert / NA\n        xj_inert_cm = Rp_cm + sigma_inert_cm * np.sqrt(2 * np.log(log_arg))\n\n    # If no inert junction, the difference is invalid.\n    if xj_inert_cm == -1.0:\n        return -1\n\n    # --- Steps 4, 5,  6: Oxidizing Anneal Case ---\n    # Select Deal-Grove parameters\n    A = c['A_dry'] if ambient == 'dry' else c['A_wet']\n    B = c['B_dry'] if ambient == 'dry' else c['B_wet']\n\n    # Compute oxide thickness x_ox\n    x_ox_um = (-A + np.sqrt(A**2 + 4 * B * c['t_min'])) / 2\n    \n    # Compute final oxidation rate v_ox\n    v_ox_um_per_min = B / (2 * x_ox_um + A)\n    \n    # Compute OED multiplier M\n    M = 1 + c['gamma'] * v_ox_um_per_min\n\n    # Compute diffused profile standard deviation with OED\n    sigma_ox_sq = dRp_cm**2 + 2 * D_inert * M * c['t_sec']\n    sigma_ox_cm = np.sqrt(sigma_ox_sq)\n    \n    peak_conc_ox = Q / (np.sqrt(2 * np.pi) * sigma_ox_cm)\n\n    xj_ox_orig_cm = -1.0\n    if peak_conc_ox  NA:\n        log_arg = peak_conc_ox / NA\n        xj_ox_orig_cm = Rp_cm + sigma_ox_cm * np.sqrt(2 * np.log(log_arg))\n        \n    # If no oxidized junction, the difference is invalid.\n    if xj_ox_orig_cm == -1.0:\n        return -1\n\n    # Adjust for silicon consumption\n    x_ox_cm = x_ox_um * 1e-4\n    xj_ox_meas_cm = xj_ox_orig_cm - c['eta'] * x_ox_cm\n\n    # --- Step 7: Compute final delta_xj ---\n    delta_xj_cm = xj_ox_meas_cm - xj_inert_cm\n    delta_xj_um = delta_xj_cm * 1e4\n    \n    return delta_xj_um\n\nsolve()\n```"
        },
        {
            "introduction": "Predictive process simulation is impossible without physical models that are calibrated to experimental reality. This exercise bridges the gap between theory and measurement by showing how to extract a critical physical parameter—the interstitial supersaturation $S_I(t)$—from empirical data. This \"reverse-engineering\" approach is key to understanding and quantitatively modeling transient diffusion phenomena that dominate in advanced technologies. ",
            "id": "4273842",
            "problem": "A one-dimensional Technology Computer-Aided Design (TCAD) diffusion simulation is to be set up for boron in crystalline silicon in the front-end-of-line. The diffusion is governed by a boron–interstitial pair model, in which substitutional boron $B_s$ forms mobile boron–interstitial pairs $BI$ by the mass-action reaction $B_s + I \\rightleftharpoons BI$, where $I$ denotes silicon self-interstitials. The mobile species $BI$ is the primary diffusing entity. Oxidation-Enhanced Diffusion (OED) and Transient-Enhanced Diffusion (TED) are represented through a time-dependent interstitial supersaturation $S_I(t)$, which is assumed spatially uniform but varies in time. Under the quasi-steady-state approximation for pair formation and dissociation, the effective diffusivity entering Fick's second law may be written as $D_{\\text{eff}}(t) = D_0 \\, S_I(t)$, where $D_0$ is the baseline pair-mediated boron diffusivity at the process temperature under equilibrium self-interstitial conditions.\n\nThe fundamental base is Fick's second law and mass conservation for the one-dimensional concentration $C(x,t)$ of substitutional boron:\n- Fick's second law: $\\dfrac{\\partial C(x,t)}{\\partial t} = \\dfrac{\\partial}{\\partial x}\\left(D_{\\text{eff}}(t)\\,\\dfrac{\\partial C(x,t)}{\\partial x}\\right)$ for $x \\in [0,L]$, $t \\ge 0$, $L>0$.\n- Conservation of total dose per unit area: $N_{\\text{tot}} = \\int_0^L C(x,t)\\,dx$ remains constant in time in the absence of reactions that change boron count.\n\nAssume the initial condition at $t=0$ is a Gaussian profile $C(x,0) = A_0 \\exp\\!\\left(-\\dfrac{(x-\\mu)^2}{2\\sigma_0^2}\\right)$ with mean depth $\\mu$, standard deviation $\\sigma_0$, and amplitude $A_0$ chosen to match the total dose $N_{\\text{tot}}$. For spatially uniform $D_{\\text{eff}}(t)$, the shape remains Gaussian under diffusion, and Secondary Ion Mass Spectrometry (SIMS) fitting yields a Gaussian standard deviation $\\sigma(t)$ at measurement times. Using only the foundational laws stated above, derive how to compute the interstitial supersaturation $S_I(t)$ from SIMS-extracted $\\sigma(t)$, the known $\\sigma_0$, and the known $D_0$, and implement this computation algorithmically.\n\nYour program must take the following test suite as embedded constants and produce the requested outputs. All lengths must be treated in micrometers, all times in seconds, and all diffusivities in square micrometers per second. The supersaturation $S_I(t)$ is dimensionless. For each case, compute the interval-averaged interstitial supersaturation over $[0,t_1]$ and over $[t_1,t_2]$, where $t_1$ and $t_2$ are the given measurement times.\n\nCommon parameters for all cases:\n- Baseline pair diffusivity: $D_0 = 3 \\times 10^{-7} \\, \\mu\\mathrm{m}^2/\\mathrm{s}$.\n- Initial Gaussian standard deviation: $\\sigma_0 = 0.02 \\, \\mu\\mathrm{m}$.\n- Initial Gaussian mean depth (used only to define the initial profile in the physical setup): $\\mu = 0.10 \\, \\mu\\mathrm{m}$.\n- Total dose per unit area (used only to define the initial profile in the physical setup): $N_{\\text{tot}} = 1 \\times 10^{14} \\, \\mathrm{cm}^{-2}$.\n\nSIMS-extracted Gaussian standard deviations for each case:\n- Case $1$ (oxidizing ambient with OED dominance):\n  - Measurement times: $t_1 = 1800 \\, \\text{s}$, $t_2 = 3600 \\, \\text{s}$.\n  - SIMS-fitted standard deviations: $\\sigma(t_1) = 0.055677 \\, \\mu\\mathrm{m}$, $\\sigma(t_2) = 0.076157 \\, \\mu\\mathrm{m}$.\n- Case $2$ (post-implant TED in inert ambient):\n  - Measurement times: $t_1 = 600 \\, \\text{s}$, $t_2 = 2400 \\, \\text{s}$.\n  - SIMS-fitted standard deviations: $\\sigma(t_1) = 0.057490 \\, \\mu\\mathrm{m}$, $\\sigma(t_2) = 0.086310 \\, \\mu\\mathrm{m}$.\n- Case $3$ (nearly intrinsic diffusion, minimal enhancement):\n  - Measurement times: $t_1 = 1800 \\, \\text{s}$, $t_2 = 7200 \\, \\text{s}$.\n  - SIMS-fitted standard deviations: $\\sigma(t_1) = 0.038490 \\, \\mu\\mathrm{m}$, $\\sigma(t_2) = 0.068675 \\, \\mu\\mathrm{m}$.\n\nYour program should compute, for each case, two floating-point numbers: the interval-averaged interstitial supersaturation over $[0,t_1]$ and over $[t_1,t_2]$. Express the output values as decimal numbers with exactly six digits after the decimal point, dimensionless. Your program should produce a single line of output containing the results as a comma-separated list of lists with the three cases in order, for example: $[\\,[s_{1,1},s_{1,2}],\\,[s_{2,1},s_{2,2}],\\,[s_{3,1},s_{3,2}]]$ where $s_{i,j}$ denotes the $j$-th interval-averaged supersaturation of case $i$. No other text should be printed.",
            "solution": "The problem statement has been validated and is determined to be sound. It is scientifically grounded in the principles of diffusion physics as applied to semiconductor manufacturing, well-posed, and contains sufficient information for a unique solution.\n\nThe objective is to derive a method for calculating the time-dependent interstitial supersaturation, $S_I(t)$, from experimental measurements of dopant profile broadening. Specifically, we will find the interval-averaged supersaturation from Secondary Ion Mass Spectrometry (SIMS) data, which provides the standard deviation $\\sigma(t)$ of the boron profile at different times.\n\nThe analysis begins with the governing partial differential equation, Fick's second law, for the one-dimensional boron concentration $C(x, t)$:\n$$\n\\dfrac{\\partial C(x,t)}{\\partial t} = \\dfrac{\\partial}{\\partial x}\\left(D_{\\text{eff}}(t)\\,\\dfrac{\\partial C(x,t)}{\\partial x}\\right)\n$$\nThe problem states that the effective diffusivity, $D_{\\text{eff}}(t)$, is spatially uniform. This allows simplification of the equation to:\n$$\n\\dfrac{\\partial C(x,t)}{\\partial t} = D_{\\text{eff}}(t)\\,\\dfrac{\\partial^2 C(x,t)}{\\partial x^2}\n$$\nThe initial condition at time $t=0$ is a Gaussian profile:\n$$\nC(x,0) = A_0 \\exp\\!\\left(-\\dfrac{(x-\\mu)^2}{2\\sigma_0^2}\\right)\n$$\nwhere $A_0$ is the initial amplitude, $\\mu$ is the mean depth, and $\\sigma_0$ is the initial standard deviation.\n\nFor a time-dependent but spatially uniform diffusivity, the solution to this diffusion equation with a Gaussian initial condition remains a Gaussian. The concentration profile at any time $t0$ can be written as:\n$$\nC(x,t) = A(t) \\exp\\!\\left(-\\dfrac{(x-\\mu)^2}{2\\sigma(t)^2}\\right)\n$$\nDue to the symmetry of the diffusion process (no drift term), the mean $\\mu$ does not change with time. The amplitude $A(t)$ and the standard deviation $\\sigma(t)$ are functions of time. The total dose, $N_{\\text{tot}} = \\int_{-\\infty}^{\\infty} C(x,t)\\,dx$, must be conserved. For a Gaussian profile, this integral evaluates to $A(t)\\sigma(t)\\sqrt{2\\pi}$. Since $N_{\\text{tot}}$ is constant, $A(t)$ is inversely proportional to $\\sigma(t)$.\n\nTo find the evolution of $\\sigma(t)$, we substitute the Gaussian ansatz into the simplified diffusion equation. The required partial derivatives are:\n$$\n\\dfrac{\\partial C}{\\partial t} = C(x,t) \\left( -\\frac{1}{\\sigma(t)}\\frac{d\\sigma(t)}{dt} + \\frac{(x-\\mu)^2}{\\sigma(t)^3}\\frac{d\\sigma(t)}{dt} \\right)\n$$\n$$\n\\dfrac{\\partial^2 C}{\\partial x^2} = C(x,t) \\left( \\frac{(x-\\mu)^2}{\\sigma(t)^4} - \\frac{1}{\\sigma(t)^2} \\right)\n$$\nSubstituting these into the diffusion equation and dividing by the common factor $C(x,t)$ yields:\n$$\n-\\frac{1}{\\sigma(t)}\\frac{d\\sigma(t)}{dt} + \\frac{(x-\\mu)^2}{\\sigma(t)^3}\\frac{d\\sigma(t)}{dt} = D_{\\text{eff}}(t) \\left( \\frac{(x-\\mu)^2}{\\sigma(t)^4} - \\frac{1}{\\sigma(t)^2} \\right)\n$$\nFor this equality to hold for all values of $x$, the coefficients of the powers of $(x-\\mu)$ on both sides must be equal. Equating the coefficients of the $(x-\\mu)^2$ term gives:\n$$\n\\frac{1}{\\sigma(t)^3}\\frac{d\\sigma(t)}{dt} = \\frac{D_{\\text{eff}}(t)}{\\sigma(t)^4} \\implies \\sigma(t)\\frac{d\\sigma(t)}{dt} = D_{\\text{eff}}(t)\n$$\nEquating the constant terms (independent of $x$) gives the same result. The left-hand side can be rewritten as $\\frac{1}{2}\\frac{d}{dt}(\\sigma(t)^2)$. Thus, we arrive at the ordinary differential equation for the evolution of the variance, $\\sigma(t)^2$:\n$$\n\\frac{d}{dt}\\left(\\sigma(t)^2\\right) = 2 D_{\\text{eff}}(t)\n$$\nIntegrating this equation from a time $t_a$ to a time $t_b$ gives:\n$$\n\\sigma(t_b)^2 - \\sigma(t_a)^2 = 2 \\int_{t_a}^{t_b} D_{\\text{eff}}(\\tau)\\,d\\tau\n$$\nThe problem specifies the model for the effective diffusivity in terms of the baseline diffusivity $D_0$ and the interstitial supersaturation $S_I(t)$ as $D_{\\text{eff}}(t) = D_0 S_I(t)$. Substituting this into the integrated equation:\n$$\n\\sigma(t_b)^2 - \\sigma(t_a)^2 = 2 D_0 \\int_{t_a}^{t_b} S_I(\\tau)\\,d\\tau\n$$\nThe interval-averaged interstitial supersaturation over the interval $[t_a, t_b]$ is defined as:\n$$\n\\langle S_I \\rangle_{[t_a, t_b]} = \\frac{1}{t_b - t_a} \\int_{t_a}^{t_b} S_I(\\tau)\\,d\\tau\n$$\nBy rearranging the previous equation, we can express the integral of $S_I(\\tau)$ in terms of the measured standard deviations:\n$$\n\\int_{t_a}^{t_b} S_I(\\tau)\\,d\\tau = \\frac{\\sigma(t_b)^2 - \\sigma(t_a)^2}{2 D_0}\n$$\nCombining these two expressions yields the final formula for the interval-averaged supersaturation:\n$$\n\\langle S_I \\rangle_{[t_a, t_b]} = \\frac{\\sigma(t_b)^2 - \\sigma(t_a)^2}{2 D_0 (t_b - t_a)}\n$$\nWe apply this formula to the specific intervals required by the problem.\n\nFor the first interval, $[0, t_1]$: $t_a = 0$ and $t_b = t_1$. The standard deviation at time $0$ is $\\sigma(0) = \\sigma_0$.\n$$\n\\langle S_I \\rangle_{[0, t_1]} = \\frac{\\sigma(t_1)^2 - \\sigma_0^2}{2 D_0 t_1}\n$$\n\nFor the second interval, $[t_1, t_2]$: $t_a = t_1$ and $t_b = t_2$.\n$$\n\\langle S_I \\rangle_{[t_1, t_2]} = \\frac{\\sigma(t_2)^2 - \\sigma(t_1)^2}{2 D_0 (t_2 - t_1)}\n$$\nThese derived formulas provide the algorithm to be implemented. The parameters $\\mu$ and $N_{\\text{tot}}$ are part of the physical problem definition but are not required for this particular calculation, which relies solely on the change in the profile's standard deviation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes interval-averaged interstitial supersaturation for boron diffusion\n    in silicon based on SIMS measurements of profile broadening.\n    \"\"\"\n\n    # Common parameters for all cases\n    D0 = 3.0e-7  # Baseline pair diffusivity (μm^2/s)\n    sigma0 = 0.02  # Initial Gaussian standard deviation (μm)\n\n    # Test cases with SIMS-extracted data\n    test_cases = [\n        # Case 1: OED dominance\n        {'t1': 1800.0, 't2': 3600.0, 'sigma_t1': 0.055677, 'sigma_t2': 0.076157},\n        # Case 2: Post-implant TED\n        {'t1': 600.0, 't2': 2400.0, 'sigma_t1': 0.057490, 'sigma_t2': 0.086310},\n        # Case 3: Nearly intrinsic diffusion\n        {'t1': 1800.0, 't2': 7200.0, 'sigma_t1': 0.038490, 'sigma_t2': 0.068675},\n    ]\n\n    results = []\n    \n    # Pre-calculate squared initial standard deviation\n    sigma0_sq = sigma0**2\n    two_D0 = 2.0 * D0\n\n    for case in test_cases:\n        t1 = case['t1']\n        t2 = case['t2']\n        sigma_t1 = case['sigma_t1']\n        sigma_t2 = case['sigma_t2']\n\n        # Square the measured standard deviations\n        sigma_t1_sq = sigma_t1**2\n        sigma_t2_sq = sigma_t2**2\n\n        # Calculate interval-averaged supersaturation for the first interval [0, t1]\n        # Formula: S_I = (sigma(t1)^2 - sigma_0^2) / (2 * D0 * t1)\n        avg_S_I_0_t1 = (sigma_t1_sq - sigma0_sq) / (two_D0 * t1)\n\n        # Calculate interval-averaged supersaturation for the second interval [t1, t2]\n        # Formula: S_I = (sigma(t2)^2 - sigma(t1)^2) / (2 * D0 * (t2 - t1))\n        avg_S_I_t1_t2 = (sigma_t2_sq - sigma_t1_sq) / (two_D0 * (t2 - t1))\n        \n        results.append([avg_S_I_0_t1, avg_S_I_t1_t2])\n\n    # Format the results into the required string format\n    # Example: [[s_11,s_12],[s_21,s_22],[s_31,s_32]]\n    # Numbers must have exactly six digits after the decimal point.\n    \n    formatted_results = []\n    for pair in results:\n        formatted_pair = [f\"{val:.6f}\" for val in pair]\n        formatted_results.append(f\"[{','.join(formatted_pair)}]\")\n        \n    final_output_string = f\"[{','.join(formatted_results)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}