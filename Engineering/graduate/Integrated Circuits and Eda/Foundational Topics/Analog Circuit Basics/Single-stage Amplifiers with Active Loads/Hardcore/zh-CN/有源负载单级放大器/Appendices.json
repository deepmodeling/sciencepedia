{
    "hands_on_practices": [
        {
            "introduction": "要掌握有源负载单级放大器，第一步是理解其核心功能——电压增益。本练习将通过一个具体的数值计算，带你估算一个典型的CMOS共源放大器的关键小信号参数，包括跨导 $g_m$ 和输出电阻 $r_o$。通过亲手计算由这些参数决定的放大器本征增益 $A_v$ ，你将深刻理解器件的物理参数和工艺特性是如何直接转化为电路宏观性能的。",
            "id": "4298294",
            "problem": "一个单级共源放大器采用互补金属氧化物半导体（CMOS）技术实现，并在电子设计自动化（EDA）的框架内进行分析。放大器件是一个n沟道金属氧化物半导体场效应晶体管（MOSFET）$M_1$，一个p沟道MOSFET $M_2$通过一个确保漏极电流相等的电流镜偏置作为有源负载。两个晶体管都工作在强反型区，并在选定的偏置点上保持饱和状态。体效应可以忽略不计，垂直场迁移率降低效应也被忽略；沟道长度调制通过基于厄利电压的参数化模型来包含。\n\n给定偏置和工艺参数如下：\n- 漏极电流 $I_D = 100\\,\\mu\\mathrm{A}$ 由偏置网络建立，并流经 $M_1$ 和 $M_2$。\n- 工艺跨导参数为 $k_n' = \\mu_n C_{\\mathrm{ox}} = 350\\,\\mu\\mathrm{A}/\\mathrm{V}^2$ 和 $k_p' = \\mu_p C_{\\mathrm{ox}} = 80\\,\\mu\\mathrm{A}/\\mathrm{V}^2$。\n- 沟道长度调制通过厄利电压 $V_A$ 建模，该电压与沟道长度 $L$ 线性相关：$V_A = V_{A0}\\,(L/L_0)$，其中 $L_0 = 1\\,\\mu\\mathrm{m}$，$M_1$ 的 $V_{A0,n} = 20\\,\\mathrm{V}$，$M_2$ 的 $V_{A0,p} = 15\\,\\mathrm{V}$。\n- 器件几何尺寸：$M_1$ 的 $W_1 = 20\\,\\mu\\mathrm{m}$ 和 $L_1 = 0.18\\,\\mu\\mathrm{m}$；$M_2$ 的 $W_2 = 40\\,\\mu\\mathrm{m}$ 和 $L_2 = 0.50\\,\\mu\\mathrm{m}$。\n\n从基于漂移-扩散的MOSFET饱和模型以及小信号定义 $g_m = \\partial I_D/\\partial V_{GS}$（$V_{DS}$ 固定）和 $r_o = (\\partial I_D/\\partial V_{DS})^{-1}$（$V_{GS}$ 固定）出发，计算：\n1. $M_1$ 的跨导 $g_m$。\n2. 放大器输出节点的小信号输出电阻 $r_o$（$M_1$ 的 $r_{o,n}$ 和 $M_2$ 的 $r_{o,p}$ 的并联组合）。\n3. 本征增益 $A_v = g_m\\,r_o$。\n\n将 $g_m$ 以 $\\mathrm{mS}$ 为单位，将 $r_o$ 以 $\\mathrm{k}\\Omega$ 为单位，$A_v$ 以无量纲比值表示。将所有要求的值四舍五入至四位有效数字。判断是否达到了至少为 $60$（单位 $\\mathrm{V}/\\mathrm{V}$）的目标本征增益，但最终报告的答案必须只包含所要求的数值。",
            "solution": "问题陈述已经过验证，并且被认为是合理的。它在科学上基于成熟的MOSFET理论，所有必要参数均已提供，问题表述清晰，并且客观陈述。不存在矛盾、歧义或不切实际的条件。因此，我们可以着手求解。\n\n该问题要求计算共源放大器的三个小信号参数：输入晶体管 $M_1$ 的跨导 $g_m$，该级的总小信号输出电阻 $r_o$，以及本征电压增益 $A_v$。\n\n1.  **计算 $M_1$ 的跨导 $g_m$**\n\n晶体管 $M_1$ 工作在饱和区。跨导 $g_m$ 可以用几个等效公式计算。给定漏极电流 $I_D$、工艺跨导参数 $k_n'$ 和器件几何尺寸 $(W/L)$，最直接的公式是：\n$$g_{m1} = \\sqrt{2 k_n' \\left(\\frac{W_1}{L_1}\\right) I_D}$$\n$M_1$ 的给定参数是：\n- 漏极电流：$I_D = 100\\,\\mu\\mathrm{A} = 1 \\times 10^{-4}\\,\\mathrm{A}$\n- 工艺跨导参数：$k_n' = 350\\,\\mu\\mathrm{A}/\\mathrm{V}^2 = 3.5 \\times 10^{-4}\\,\\mathrm{A}/\\mathrm{V}^2$\n- 器件几何尺寸：$W_1 = 20\\,\\mu\\mathrm{m}$，$L_1 = 0.18\\,\\mu\\mathrm{m}$，所以宽长比为 $\\frac{W_1}{L_1} = \\frac{20\\,\\mu\\mathrm{m}}{0.18\\,\\mu\\mathrm{m}} = \\frac{20}{0.18}$。\n\n将这些值代入 $g_{m1}$ 的方程中：\n$$g_{m1} = \\sqrt{2 \\left(3.5 \\times 10^{-4}\\,\\frac{\\mathrm{A}}{\\mathrm{V}^2}\\right) \\left(\\frac{20}{0.18}\\right) \\left(1 \\times 10^{-4}\\,\\mathrm{A}\\right)}$$\n$$g_{m1} = \\sqrt{2 \\times 3.5 \\times \\frac{20}{0.18} \\times 10^{-8}}\\,\\mathrm{S} = \\sqrt{\\frac{140}{0.18} \\times 10^{-8}}\\,\\mathrm{S} \\approx \\sqrt{777.77... \\times 10^{-8}}\\,\\mathrm{S}$$\n$$g_{m1} \\approx 2.788866 \\times 10^{-3}\\,\\mathrm{S}$$\n问题要求以毫西门子（$\\mathrm{mS}$）为单位，并四舍五入到四位有效数字。\n$$g_m \\approx 2.789\\,\\mathrm{mS}$$\n\n2.  **计算小信号输出电阻 $r_o$**\n\n总输出电阻 $r_o$ 是 NMOS 驱动晶体管 $M_1$ 的输出电阻（$r_{o1}$）和 PMOS 有源负载晶体管 $M_2$ 的输出电阻（$r_{o2}$）的并联组合：\n$$r_o = r_{o1} \\parallel r_{o2} = \\frac{r_{o1} r_{o2}}{r_{o1} + r_{o2}}$$\n饱和区 MOSFET 的输出电阻由公式 $r_o = \\frac{V_A}{I_D}$ 给出，其中 $V_A$ 是厄利电压。问题指明 $V_A$ 与沟道长度 $L$ 线性相关：$V_A = V_{A0} \\frac{L}{L_0}$。\n\n首先，我们必须计算每个晶体管的厄利电压。\n对于 $M_1$ (NMOS)：\n- $V_{A0,n} = 20\\,\\mathrm{V}$\n- $L_1 = 0.18\\,\\mu\\mathrm{m}$\n- $L_0 = 1\\,\\mu\\mathrm{m}$\n$$V_{A1} = V_{A0,n} \\frac{L_1}{L_0} = (20\\,\\mathrm{V}) \\frac{0.18\\,\\mu\\mathrm{m}}{1\\,\\mu\\mathrm{m}} = 3.6\\,\\mathrm{V}$$\n\n对于 $M_2$ (PMOS)：\n- $V_{A0,p} = 15\\,\\mathrm{V}$\n- $L_2 = 0.50\\,\\mu\\mathrm{m}$\n- $L_0 = 1\\,\\mu\\mathrm{m}$\n$$V_{A2} = V_{A0,p} \\frac{L_2}{L_0} = (15\\,\\mathrm{V}) \\frac{0.50\\,\\mu\\mathrm{m}}{1\\,\\mu\\mathrm{m}} = 7.5\\,\\mathrm{V}$$\n\n现在，我们可以使用 $I_D = 1 \\times 10^{-4}\\,\\mathrm{A}$ 计算各个输出电阻：\n$$r_{o1} = \\frac{V_{A1}}{I_D} = \\frac{3.6\\,\\mathrm{V}}{1 \\times 10^{-4}\\,\\mathrm{A}} = 36000\\,\\Omega = 36\\,\\mathrm{k}\\Omega$$\n$$r_{o2} = \\frac{V_{A2}}{I_D} = \\frac{7.5\\,\\mathrm{V}}{1 \\times 10^{-4}\\,\\mathrm{A}} = 75000\\,\\Omega = 75\\,\\mathrm{k}\\Omega$$\n\n最后，我们计算总的并联电阻：\n$$r_o = \\frac{(36\\,\\mathrm{k}\\Omega) \\times (75\\,\\mathrm{k}\\Omega)}{36\\,\\mathrm{k}\\Omega + 75\\,\\mathrm{k}\\Omega} = \\frac{2700}{111}\\,\\mathrm{k}\\Omega \\approx 24.324324\\,\\mathrm{k}\\Omega$$\n四舍五入到四位有效数字，我们得到：\n$$r_o \\approx 24.32\\,\\mathrm{k}\\Omega$$\n\n3.  **计算本征增益 $A_v$**\n\n本征电压增益在问题中定义为 $A_v = g_m r_o$。请注意，由于共源级的反相特性，实际电压增益为 $A_v = -g_m r_o$，但问题要求的是其幅值，这是本征增益的常见约定。\n在最终四舍五入之前使用未舍入的值以获得更好的精度：\n$$A_v = g_{m1} r_o = (2.788866 \\times 10^{-3}\\,\\mathrm{S}) \\times (24324.324\\,\\Omega)$$\n$$A_v \\approx 67.8422$$\n这是一个无量纲量（V/V）。四舍五入到四位有效数字：\n$$A_v \\approx 67.84$$\n\n问题还要求判断是否达到了至少为 $60$ 的目标本征增益。由于我们计算出的增益为 $67.84$，大于 $60$，因此目标已达到。\n\n最终要求的数值答案是 $g_m$（以 $\\mathrm{mS}$ 为单位）、$r_o$（以 $\\mathrm{k}\\Omega$ 为单位）和 $A_v$（无量纲比值），所有值均四舍五入到四位有效数字。\n- $g_m = 2.789$\n- $r_o = 24.32$\n- $A_v = 67.84$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.789  24.32  67.84\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在了解了放大器的基本增益之后，我们必须考虑其性能的边界条件，其中最重要的一个就是输出电压摆幅。与具体的数值计算不同，本练习  要求你进行符号推导，得出一个决定最大对称输出摆幅的通用表达式。这项练习旨在让你掌握电源电压 $V_{DD}$ 和晶体管的过驱动电压 $V_{OV}$ 如何共同设定输出信号的理论极限，从而确保放大器在线性工作区内运行，这对于电路设计中的权衡与优化至关重要。",
            "id": "4298358",
            "problem": "考虑一个单级互补金属氧化物半导体（CMOS）共源放大器，其有源负载由一个饱和的p沟道金属氧化物半导体场效应晶体管（MOSFET）实现。该放大器由一个n沟道MOSFET $M_{N}$（驱动管）和一个p沟道MOSFET $M_{P}$（有源负载管）组成。$M_{N}$的源极接地（$0$），漏极连接到输出节点$v_{o}$。$M_{P}$的源极连接到$V_{DD}$，漏极也连接到$v_{o}$。栅极电压保持固定，使得两个晶体管在静态工作点都偏置在强反型饱和区。设n沟道过驱动电压为 $V_{OVN} = V_{GS,N} - V_{TN}$，p沟道过驱动电压为 $V_{OVP} = V_{SG,P} - |V_{TP}|$，其中$V_{TN}$和$V_{TP}$分别是n沟道和p沟道器件的阈值电压。假设为长沟道行为，因此每个器件的饱和条件由其瞬时漏源电压相对于其过驱动电压的大小决定。\n\n要求您从第一性原理和强反型工作的饱和标准出发，推导出在某个静态电压$V_{OQ}$附近，可以施加于$v_{o}(t)$的最大峰峰值对称输出摆幅，同时保证$M_{N}$和$M_{P}$在整个摆幅期间始终保持在饱和区。请将您的最终结果表示为包含$V_{DD}$、$V_{OVN}$和$V_{OVP}$的单个闭式解析表达式。使用伏特作为单位。不需要进行数值计算，仅提供符号表达式。",
            "solution": "问题陈述经过验证。\n\n### 步骤 1：提取已知条件\n- **系统**：一个单级互补金属氧化物半导体（CMOS）共源放大器，具有有源负载。\n- **驱动晶体管 ($M_{N}$)**：n沟道MOSFET。源极连接到$0$伏特。漏极连接到输出节点$v_{o}$。\n- **有源负载晶体管 ($M_{P}$)**：p沟道MOSFET。源极连接到电源电压$V_{DD}$。漏极连接到输出节点$v_{o}$。\n- **偏置**：两个晶体管$M_{N}$和$M_{P}$在静态工作点都偏置在强反型饱和区。栅极电压保持固定。\n- **定义**：\n    - N沟道过驱动电压：$V_{OVN} = V_{GS,N} - V_{TN}$。\n    - P沟道过驱动电压：$V_{OVP} = V_{SG,P} - |V_{TP}|$。\n- **模型**：假设为长沟道行为。\n- **饱和条件**：每个器件的饱和条件由其瞬时漏源电压相对于其过驱动电压的大小决定。\n- **目标**：推导在静态电压$V_{OQ}$附近，$v_{o}(t)$的最大峰峰值对称输出摆幅，使得$M_{N}$和$M_{P}$都保持在饱和区。结果必须是关于$V_{DD}$、$V_{OVN}$和$V_{OVP}$的单个闭式解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题坚实地建立在模拟集成电路设计的原理之上，特别是MOSFET放大器的分析。其组件、配置和参数（$V_{DD}$、$V_{OVN}$、$V_{OVP}$）在该领域是标准的。长沟道模型和饱和条件是MOSFET理论中的基本概念。\n- **适定性**：该问题是适定的。它提供了所有必要的信息（$V_{DD}$、$V_{OVN}$、$V_{OVP}$以及电路拓扑）来唯一确定输出电压摆幅的边界。目标陈述清晰，并且存在唯一的解析解。\n- **客观性**：问题使用精确、客观和标准的技术术语进行陈述。没有主观或含糊的陈述。\n\n### 步骤 3：结论与行动\n该问题有效。它在科学上是合理的，是适定的，并且是客观的。没有不一致之处、缺失数据或逻辑缺陷。可以进行求解过程。\n\n### 推导\n目标是找到最大的峰峰值对称输出电压摆幅，记为$V_{pp,symm}$，在此摆幅下，n沟道驱动晶体管$M_{N}$和p沟道负载晶体管$M_{P}$都保持在饱和工作区。\n\n分析首先基于长沟道模型，为每个晶体管建立饱和条件。\n\n对于n沟道MOSFET $M_{N}$，要使其处于饱和区，其漏源电压$V_{DS,N}$必须大于或等于其栅源电压减去阈值电压。这个差值被定义为过驱动电压$V_{OVN}$。\n$$V_{DS,N} \\geq V_{GS,N} - V_{TN}$$\n使用所给的定义，该条件为：\n$$V_{DS,N} \\geq V_{OVN}$$\n在给定的电路配置中，$M_{N}$的源极接地（$V_{S,N} = 0$），其漏极连接到输出节点$v_{o}$。因此，瞬时漏源电压为$V_{DS,N} = v_{o} - V_{S,N} = v_{o}$。$M_{N}$保持饱和的条件设定了输出电压的下限：\n$$v_{o} \\geq V_{OVN}$$\n这定义了最小允许输出电压$v_{o,min}$：\n$$v_{o,min} = V_{OVN}$$\n\n对于p沟道MOSFET $M_{P}$，要使其处于饱和区，其源漏电压$V_{SD,P}$必须大于或等于其源栅电压减去其阈值电压的绝对值。这个差值被定义为过驱动电压$V_{OVP}$。\n$$V_{SD,P} \\geq V_{SG,P} - |V_{TP}|$$\n使用所给的定义，该条件为：\n$$V_{SD,P} \\geq V_{OVP}$$\n在给定的电路配置中，$M_{P}$的源极连接到正电源电压$V_{DD}$（$V_{S,P} = V_{DD}$），其漏极连接到输出节点$v_{o}$。因此，瞬时源漏电压为$V_{SD,P} = V_{S,P} - v_{o} = V_{DD} - v_{o}$。$M_{P}$保持饱和的条件设定了输出电压的上限：\n$$V_{DD} - v_{o} \\geq V_{OVP}$$\n重新整理该不等式以求解$v_{o}$：\n$$v_{o} \\leq V_{DD} - V_{OVP}$$\n这定义了最大允许输出电压$v_{o,max}$：\n$$v_{o,max} = V_{DD} - V_{OVP}$$\n\n两个晶体管都保持饱和的输出电压总范围是区间$[v_{o,min}, v_{o,max}]$。总可用电压摆幅是这两个极限值之差：\n$$\\text{Total Swing} = v_{o,max} - v_{o,min} = (V_{DD} - V_{OVP}) - V_{OVN}$$\n\n问题要求的是最大*对称*峰峰值摆幅。对称摆幅意味着输出电压$v_{o}(t)$在静态点$V_{OQ}$上下变化相等。为了最大化此对称摆幅，$V_{OQ}$必须选择在有效电压范围的中点：\n$$V_{OQ} = \\frac{v_{o,max} + v_{o,min}}{2} = \\frac{(V_{DD} - V_{OVP}) + V_{OVN}}{2}$$\n通过$V_{OQ}$的这个最优选择，输出可以在$v_{o,min}$到$v_{o,max}$之间摆动。因此，最大峰峰值对称摆幅$V_{pp,symm}$等于总可用摆幅。\n$$V_{pp,symm} = v_{o,max} - v_{o,min}$$\n代入推导出的$v_{o,max}$和$v_{o,min}$的表达式：\n$$V_{pp,symm} = (V_{DD} - V_{OVP}) - V_{OVN}$$\n$$V_{pp,symm} = V_{DD} - V_{OVN} - V_{OVP}$$\n这是根据给定参数得出的最大峰峰值对称输出摆幅的最终闭式表达式。此摆幅确保在所有时间$t$，输出电压$v_{o}(t)$满足$V_{OVN} \\leq v_{o}(t) \\leq V_{DD} - V_{OVP}$，从而保证$M_{N}$和$M_{P}$都保持在饱和区。",
            "answer": "$$\n\\boxed{V_{DD} - V_{OVN} - V_{OVP}}\n$$"
        },
        {
            "introduction": "一个完整的放大器分析不仅包括静态增益和输出摆幅，还必须考虑其动态特性，即频率响应。本练习  将引导你分析放大器在不同频率下的行为，重点关注主极点和增益带宽积（GBW）等关键概念。通过将放大器建模为单极点系统，你将学会如何分析寄生电容与电路电阻相互作用，从而限制放大器的高频性能，这对于设计满足特定速度要求的放大器是不可或缺的技能。",
            "id": "4298376",
            "problem": "您需要在电子设计自动化 (EDA) 框架内，对一个采用有源负载的单级反相放大器进行交流 (AC) 分析的形式化和实现。该放大器是一个采用直流 (DC) 电流源有源负载的金属氧化物半导体场效应晶体管 (MOSFET) 共源级。目标是从第一性原理出发，推导出一个小信号传递函数，从而得出复电压增益 $A_v(j\\omega)$、增益带宽积 (GBW) 和主极点频率。该分析必须以纯数学术语表达和实现，不得引用任何特定的电路模拟器。\n\n假设与建模：\n- MOSFET 的小信号模型由其跨导 $g_{m,n}$ 和输出电阻 $r_{o,n}$ 表示。有源负载由一个输出电阻 $r_{o,p}$ 表示。沟道长度调制和其他输出电导效应均包含在这些电阻中。体效应和衬底-源极耦合被忽略。\n- 放大器的输出节点由器件寄生电容和显式负载电容的并联组合加载。为估算主极点，这些电容被建模为 $C_{L}$、$C_{db,n}$、$C_{db,p}$ 和 $C_{gd}$，全部连接到输出节点。该近似假设源极驱动阻抗较低，因此米勒再分配效应将 $C_{gd}$ 的大部分影响置于输入端，而不是在已将其计入输出节点电容的基础上进一步重塑输出极点。您必须陈述并使用此近似。\n- AC 分析的输入激励是在栅极节点施加一个幅度为 $1$ V、源电阻为零的交流电压源。源极和衬底节点处于交流地。输出在漏极节点相对于交流地进行测量。\n- 输出节点的输出电阻是并联组合 $R_{\\text{out}} = \\left(\\frac{1}{r_{o,n}} + \\frac{1}{r_{o,p}}\\right)^{-1}$。在所述近似下，总输出电容为 $C_{\\text{out}} = C_{L} + C_{db,n} + C_{db,p} + C_{gd}$。\n- 仅从基尔霍夫电流定律 (KCL)、线性时不变 (LTI) 系统理论和小信号线性化出发，您必须推导出该单极点级的传递函数可以由直流 (DC) 增益 $A_v(0)$ 和极点角频率 $\\omega_p$ 参数化，并随后用于在指定频率下评估 $A_v(j\\omega)$。角度和角频率必须以弧度处理。\n\n要求的输出和单位：\n- 计算直流增益 $A_v(0)$，作为一个无量纲量。\n- 计算主极点频率 $f_p$，单位为赫兹。\n- 计算增益带宽积 GBW $= \\lvert A_v(0) \\rvert \\cdot f_p$，单位为赫兹。\n- 在指定的评估频率 $f_{\\text{eval}}$ (其中 $\\omega_{\\text{eval}} = 2\\pi f_{\\text{eval}}$) 下评估复增益 $A_v(j\\omega_{\\text{eval}})$，并将其作为无量纲量报告其实部和虚部。\n\n您的程序必须使用以下根据所述的第一性原理推导出的放大器单极点表示法：\n- 直流增益为 $A_v(0) = -g_{m,n} R_{\\text{out}}$。\n- 极点为 $\\omega_p = \\dfrac{1}{R_{\\text{out}} C_{\\text{out}}}$ 且 $f_p = \\dfrac{\\omega_p}{2\\pi}$。\n- 频率响应为 $A_v(j\\omega) = \\dfrac{A_v(0)}{1 + j \\dfrac{\\omega}{\\omega_p}}$。\n- 增益带宽积为 $\\text{GBW} = \\lvert A_v(0) \\rvert \\cdot f_p$。\n\n要求的小信号激励和测量节点：\n- 在输入栅极节点施加一个幅度为 $1$ V、源电阻为零的交流电压源。\n- 保持源极和衬底节点处于交流地。\n- 测量漏极处的输出节点电压（相对于交流地）以获得 $A_v(j\\omega) = \\dfrac{v_{\\text{out}}(j\\omega)}{v_{\\text{in}}(j\\omega)}$。\n\n测试套件：\n为以下参数集实现计算。每个参数集是一个元组 $(g_{m,n}, r_{o,n}, r_{o,p}, C_L, C_{db,n}, C_{db,p}, C_{gd}, f_{\\text{eval}})$，单位分别为西门子、欧姆、欧姆、法拉、法拉、法拉、法拉和赫兹。所有与频率相关的计算必须使用弧度作为角频率单位。\n\n- 情况 $1$ (具有显著增益和轻负载的通用反相级): $g_{m,n} = 2\\times 10^{-3}$, $r_{o,n} = 5.0\\times 10^{4}$, $r_{o,p} = 1.0\\times 10^{5}$, $C_{L} = 1.0\\times 10^{-13}$, $C_{db,n} = 2.0\\times 10^{-14}$, $C_{db,p} = 2.0\\times 10^{-14}$, $C_{gd} = 1.0\\times 10^{-14}$, $f_{\\text{eval}} = 1.0\\times 10^{7}$。\n- 情况 $2$ (低跨导导致亚单位增益的边界情况): $g_{m,n} = 2.0\\times 10^{-5}$, $r_{o,n} = 4.0\\times 10^{4}$, $r_{o,p} = 4.0\\times 10^{4}$, $C_{L} = 1.0\\times 10^{-12}$, $C_{db,n} = 5.0\\times 10^{-14}$, $C_{db,p} = 5.0\\times 10^{-14}$, $C_{gd} = 2.0\\times 10^{-14}$, $f_{\\text{eval}} = 5.0\\times 10^{6}$。\n- 情况 $3$ (重负载和近理想电流源负载导致主极点被推向低频): $g_{m,n} = 4.0\\times 10^{-3}$, $r_{o,n} = 2.5\\times 10^{4}$, $r_{o,p} = 1.0\\times 10^{9}$, $C_{L} = 1.0\\times 10^{-11}$, $C_{db,n} = 2.0\\times 10^{-13}$, $C_{db,p} = 1.5\\times 10^{-13}$, $C_{gd} = 2.0\\times 10^{-13}$, $f_{\\text{eval}} = 1.0\\times 10^{6}$。\n\n输出规格：\n对于每个测试用例，计算并返回列表 $[A_v(0), \\text{GBW}, f_p, \\Re\\{A_v(j\\omega_{\\text{eval}})\\}, \\Im\\{A_v(j\\omega_{\\text{eval}})\\}]$。您的程序应生成单行输出，其中包含所有测试用例的结果，格式为由方括号括起来的、每个用例列表组成的逗号分隔列表。例如，一个有效的输出格式是 $[[a_1,b_1,c_1,d_1,e_1],[a_2,b_2,c_2,d_2,e_2],[a_3,b_3,c_3,d_3,e_3]]$，其中所有条目都是浮点数。报告 $A_v(0)$ 为无量纲量，GBW 和 $f_p$ 的单位为赫兹，以及 $A_v(j\\omega_{\\text{eval}})$ 的实部和虚部为无量纲量。",
            "solution": "该问题是有效的。它提出了一个在模拟集成电路分析中标准的、适定的问题，该问题具有科学依据且内部一致。我们将从第一性原理出发，推导所要求的传递函数及相关参数。\n\n目标是确定一个带有源电流源负载的共源 MOSFET 放大器的小信号交流特性。分析始于在指定假设下构建小信号等效电路。输入 n 沟道 MOSFET ($M_n$) 由其跨导 $g_{m,n}$ 和输出电阻 $r_{o,n}$ 建模。p 沟道 MOSFET 有源负载 ($M_p$) 由其输出电阻 $r_{o,p}$ 建模。输入信号 $v_{in}$ 施加在 $M_n$ 的栅极上。其源极和衬底连接到交流地，这意味着栅源电压为 $v_{gs} = v_{in}$。输出电压 $v_{out}$ 在 $M_n$ 和 $M_p$ 的公共漏极节点处测量。直流电源电压 ($V_{DD}$) 是一个交流地。\n\n总输出电阻 $R_{out}$ 是 NMOS 输出电阻 $r_{o,n}$ 和 PMOS 输出电阻 $r_{o,p}$ 的并联组合。\n$$R_{out} = r_{o,n} \\parallel r_{o,p} = \\left(\\frac{1}{r_{o,n}} + \\frac{1}{r_{o,p}}\\right)^{-1}$$\n总输出电容 $C_{out}$ 是连接到输出节点的所有电容的总和，如问题的主极点近似所规定。\n$$C_{out} = C_{L} + C_{db,n} + C_{db,p} + C_{gd}$$\n\n小信号等效电路由连接到输出节点（漏极）的以下组件组成：\n$1$. NMOS 晶体管的受控电流源，从输出节点到地吸取电流 $g_{m,n}v_{gs} = g_{m,n}v_{in}$。\n$2$. 从输出节点到地的 NMOS 输出电阻 $r_{o,n}$。\n$3$. 从输出节点到地的 PMOS 输出电阻 $r_{o,p}$（因为 PMOS 的源极连接到 $V_{DD}$，即交流地）。\n$4$. 从输出节点到地的总输出电容 $C_{out}$。\n\n为了求得传递函数 $A_v(s) = V_{out}(s) / V_{in}(s)$，其中 $s$ 是复频率变量，我们在输出节点应用基尔霍夫电流定律 (KCL)。离开节点的电流之和为零。在 s 域（相量域）中，这表示为：\n$$g_{m,n}V_{in}(s) + \\frac{V_{out}(s)}{r_{o,n}} + \\frac{V_{out}(s)}{r_{o,p}} + s C_{out} V_{out}(s) = 0$$\n我们可以将包含 $V_{out}(s)$ 的项组合在一起：\n$$V_{out}(s) \\left( \\frac{1}{r_{o,n}} + \\frac{1}{r_{o,p}} + s C_{out} \\right) = -g_{m,n}V_{in}(s)$$\n使用 $R_{out}$ 的定义，括号中的表达式变为 $\\frac{1}{R_{out}} + s C_{out}$。\n$$V_{out}(s) \\left( \\frac{1}{R_{out}} + s C_{out} \\right) = -g_{m,n}V_{in}(s)$$\n现在，我们求解电压增益 $A_v(s) = V_{out}(s) / V_{in}(s)$：\n$$A_v(s) = \\frac{-g_{m,n}}{\\frac{1}{R_{out}} + s C_{out}}$$\n为了将其表示为标准的单极点传递函数形式 $A_v(s) = \\frac{A_v(0)}{1+s/\\omega_p}$，我们将分子和分母同乘以 $R_{out}$：\n$$A_v(s) = \\frac{-g_{m,n}R_{out}}{1 + s R_{out}C_{out}}$$\n通过将此推导表达式与标准形式进行比较，我们可以确定直流增益 $A_v(0)$ 和极点角频率 $\\omega_p$。\n\n$1$. 直流增益，在 $s=0$ (或 $\\omega=0$) 处求值，为：\n$$A_v(0) = -g_{m,n}R_{out}$$\n这代表放大器在低频时的增益。负号表示该放大器是反相的，这与共源构型预期一致。\n\n$2$. 主极点角频率 $\\omega_p$ 可从分母项 $1 + sR_{out}C_{out} = 1 + s/\\omega_p$ 中找到。这得出：\n$$\\omega_p = \\frac{1}{R_{out}C_{out}}$$\n极点频率（单位赫兹）$f_p$ 与角频率的关系为 $f_p = \\omega_p / (2\\pi)$。\n$$f_p = \\frac{1}{2\\pi R_{out}C_{out}}$$\n\n$3$. 增益带宽积 (GBW) 定义为直流增益幅值与极点频率的乘积。对于单极点系统，这也约等于单位增益频率。\n$$\\text{GBW} = |A_v(0)| \\cdot f_p = |-g_{m,n}R_{out}| \\cdot \\frac{1}{2\\pi R_{out}C_{out}} = \\frac{g_{m,n}}{2\\pi C_{out}}$$\n\n$4$. 在特定评估频率 $f_{\\text{eval}}$ 处的复增益可以通过将 $s = j\\omega_{\\text{eval}} = j2\\pi f_{\\text{eval}}$ 代入传递函数求得：\n$$A_v(j\\omega_{\\text{eval}}) = \\frac{A_v(0)}{1 + j\\frac{\\omega_{\\text{eval}}}{\\omega_p}}$$\n为了求出实部和虚部，我们对分母进行有理化：\n$$A_v(j\\omega_{\\text{eval}}) = \\frac{A_v(0)}{1 + j\\frac{\\omega_{\\text{eval}}}{\\omega_p}} \\cdot \\frac{1 - j\\frac{\\omega_{\\text{eval}}}{\\omega_p}}{1 - j\\frac{\\omega_{\\text{eval}}}{\\omega_p}} = \\frac{A_v(0)\\left(1 - j\\frac{\\omega_{\\text{eval}}}{\\omega_p}\\right)}{1 + \\left(\\frac{\\omega_{\\text{eval}}}{\\omega_p}\\right)^2}$$\n由此，实部和虚部分量为：\n$$\\Re\\{A_v(j\\omega_{\\text{eval}})\\} = \\frac{A_v(0)}{1 + \\left(\\frac{\\omega_{\\text{eval}}}{\\omega_p}\\right)^2}$$\n$$\\Im\\{A_v(j\\omega_{\\text{eval}})\\} = \\frac{-A_v(0) \\cdot \\frac{\\omega_{\\text{eval}}}{\\omega_p}}{1 + \\left(\\frac{\\omega_{\\text{eval}}}{\\omega_p}\\right)^2}$$\n\n实现将通过为测试套件中提供的每个参数集计算这些量来进行。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the AC analysis characteristics for a single-stage common-source\n    amplifier with an active load for a given set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple:\n    # (g_m_n, r_o_n, r_o_p, C_L, C_db_n, C_db_p, C_gd, f_eval)\n    # Units: (S, Ohm, Ohm, F, F, F, F, Hz)\n    test_cases = [\n        (2e-3, 5e4, 1e5, 1e-13, 2e-14, 2e-14, 1e-14, 1e7),\n        (2e-5, 4e4, 4e4, 1e-12, 5e-14, 5e-14, 2e-14, 5e6),\n        (4e-3, 2.5e4, 1e9, 1e-11, 2e-13, 1.5e-13, 2e-13, 1e6)\n    ]\n\n    results = []\n    for case in test_cases:\n        g_m_n, r_o_n, r_o_p, C_L, C_db_n, C_db_p, C_gd, f_eval = case\n\n        # 1. Calculate total output resistance R_out\n        # R_out = r_o_n || r_o_p\n        if r_o_n + r_o_p == 0:\n            R_out = 0.0\n        else:\n            R_out = (r_o_n * r_o_p) / (r_o_n + r_o_p)\n        \n        # 2. Calculate total output capacitance C_out\n        C_out = C_L + C_db_n + C_db_p + C_gd\n        \n        # 3. Compute DC gain A_v(0)\n        A_v_0 = -g_m_n * R_out\n        \n        # 4. Compute the dominant pole frequency (omega_p and f_p)\n        # Avoid division by zero if R_out or C_out is zero\n        if R_out == 0 or C_out == 0:\n            omega_p = float('inf')\n            f_p = float('inf')\n        else:\n            omega_p = 1 / (R_out * C_out)\n            f_p = omega_p / (2 * np.pi)\n            \n        # 5. Compute the gain-bandwidth product (GBW)\n        # The relationship GBW = g_m_n / (2*pi*C_out) is more numerically stable\n        if C_out == 0:\n            GBW = float('inf')\n        else:\n            GBW = g_m_n / (2 * np.pi * C_out)\n        # Alternatively, using the derived relation GBW = |A_v(0)| * f_p \n        # GBW_alt = abs(A_v_0) * f_p \n        # Both should be equivalent; we use the more stable form.\n        \n        # 6. Evaluate the complex gain at f_eval\n        omega_eval = 2 * np.pi * f_eval\n        \n        # Using complex numbers for straightforward calculation\n        # A_v(jw) = A_v(0) / (1 + j * w / w_p)\n        if omega_p == float('inf'): # Corresponds to zero RC time constant\n             A_v_jw_eval = A_v_0 + 0j\n        else:\n             A_v_jw_eval = A_v_0 / (1 + 1j * (omega_eval / omega_p))\n        \n        real_part = A_v_jw_eval.real\n        imag_part = A_v_jw_eval.imag\n        \n        # Append the list of results for the current case\n        results.append([A_v_0, GBW, f_p, real_part, imag_part])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}