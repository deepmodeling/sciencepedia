{
    "hands_on_practices": [
        {
            "introduction": "At the heart of the Polynomial Expansion Nodal Method (PENM) is the transformation of the continuous, intra-nodal diffusion equation into a small, discrete matrix system. This is accomplished through a Galerkin procedure, where the governing equation is projected onto a space of local polynomial basis functions. This exercise provides fundamental practice in deriving this local system matrix, giving you direct experience in translating the differential operators of physics into the algebraic forms used in computation. ",
            "id": "4241293",
            "problem": "In a one-group steady-state neutron diffusion model for a homogeneous one-dimensional node of physical width $h$, with constant diffusion coefficient $D$ and constant macroscopic removal cross section $\\Sigma_{r}$, consider the Polynomial Expansion Nodal Method (PENM), a Galerkin nodal method that expands the scalar neutron flux $\\phi(x)$ locally in a polynomial basis. Map the node $x \\in [x_{L}, x_{R}]$ to the reference coordinate $\\xi \\in [-1,1]$ via the affine mapping $x(\\xi) = \\frac{h}{2}\\,\\xi + x_{c}$, where $x_{c}$ is the node center. Use the first three Legendre polynomials on $[-1,1]$ as the local basis functions:\n$$\n\\varphi_{0}(\\xi) = P_{0}(\\xi) = 1,\\quad \\varphi_{1}(\\xi) = P_{1}(\\xi) = \\xi,\\quad \\varphi_{2}(\\xi) = P_{2}(\\xi) = \\frac{3\\xi^{2}-1}{2}.\n$$\nAssume homogeneous Neumann boundary conditions (zero net current) at the node faces so that boundary terms vanish in the symmetric weak form. Using a standard Galerkin procedure with the same polynomials as test functions, the local coefficient matrix $\\mathbf{A}$ for the modal amplitudes $\\mathbf{a} = [a_{0}, a_{1}, a_{2}]^{\\mathsf{T}}$ has entries\n$$\nA_{ij} \\equiv \\int_{x_{L}}^{x_{R}} D\\,\\frac{d\\varphi_{i}}{dx}\\,\\frac{d\\varphi_{j}}{dx}\\,dx \\;+\\; \\int_{x_{L}}^{x_{R}} \\Sigma_{r}\\,\\varphi_{i}\\,\\varphi_{j}\\,dx,\\quad i,j\\in\\{0,1,2\\}.\n$$\nDerive the expressions for $A_{ij}$ in terms of $D$, $\\Sigma_{r}$, and $h$ by mapping these integrals to the reference domain and evaluating the polynomial inner products exactly. Then, assemble the resulting $3\\times 3$ matrix $\\mathbf{A}$.\n\nFinally, compute the determinant $\\det(\\mathbf{A})$ in closed form, expressed only in terms of $D$, $\\Sigma_{r}$, and $h$. Provide your final answer as a single closed-form analytic expression. No numerical approximation is required and no units should be included in the final answer.",
            "solution": "The problem requires the derivation of the coefficient matrix $\\mathbf{A}$ for a Polynomial Expansion Nodal Method (PENM) formulation of the one-dimensional, one-group neutron diffusion equation, and the subsequent calculation of its determinant. The validation of the problem statement precedes the solution.\n\n### Step 1: Extract Givens\n- **Model**: One-group, steady-state, homogeneous neutron diffusion.\n- **Node geometry**: One-dimensional, physical width $h$.\n- **Physical constants**: Diffusion coefficient $D$ (constant), macroscopic removal cross section $\\Sigma_r$ (constant).\n- **Method**: Galerkin nodal method (PENM).\n- **Coordinate mapping**: $x(\\xi) = \\frac{h}{2}\\xi + x_{c}$ for $x \\in [x_L, x_R]$ and $\\xi \\in [-1, 1]$.\n- **Basis and test functions**: $\\varphi_{0}(\\xi) = P_{0}(\\xi) = 1$, $\\varphi_{1}(\\xi) = P_{1}(\\xi) = \\xi$, $\\varphi_{2}(\\xi) = P_{2}(\\xi) = \\frac{3\\xi^{2}-1}{2}$.\n- **Boundary conditions**: Homogeneous Neumann (zero net current) at node faces, leading to vanishing boundary terms.\n- **Matrix element definition**: $A_{ij} \\equiv \\int_{x_{L}}^{x_{R}} D\\,\\frac{d\\varphi_{i}}{dx}\\,\\frac{d\\varphi_{j}}{dx}\\,dx \\;+\\; \\int_{x_{L}}^{x_{R}} \\Sigma_{r}\\,\\varphi_{i}\\,\\varphi_{j}\\,dx$, for $i,j\\in\\{0,1,2\\}$.\n- **Objective**: Derive the $3\\times3$ matrix $\\mathbf{A}$ and compute its determinant, $\\det(\\mathbf{A})$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the standard neutron diffusion equation and the Galerkin finite element method, which are fundamental concepts in nuclear engineering and computational physics. The use of Legendre polynomials as basis functions is a standard choice for PENM.\n- **Well-Posed**: The problem is clearly stated with all necessary definitions, constants, and functions provided to uniquely determine the matrix $\\mathbf{A}$ and its determinant.\n- **Objective**: The problem is formulated with precise mathematical and physical terminology, free from subjective or ambiguous language.\n- **Completeness and Consistency**: The problem is self-contained. The definition of $A_{ij}$ is consistent with the weak form of the diffusion operator $-D\\frac{d^2}{dx^2} + \\Sigma_r$, and the assumption of vanishing boundary terms is consistent with the specified Neumann conditions.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically sound, well-posed, and complete. A rigorous solution can be constructed.\n\n### Solution Derivation\nThe matrix elements $A_{ij}$ are defined by integrals over the physical domain $x \\in [x_L, x_R]$. To evaluate these, we transform the integrals to the reference domain $\\xi \\in [-1, 1]$.\n\nFirst, we establish the relationship between the differentials $dx$ and $d\\xi$, and the derivatives $\\frac{d}{dx}$ and $\\frac{d}{d\\xi}$.\nFrom the mapping $x(\\xi) = \\frac{h}{2}\\xi + x_c$, we find the Jacobian of the transformation:\n$$\n\\frac{dx}{d\\xi} = \\frac{h}{2} \\implies dx = \\frac{h}{2} d\\xi\n$$\nUsing the chain rule for derivatives:\n$$\n\\frac{d}{d\\xi} = \\frac{dx}{d\\xi}\\frac{d}{dx} = \\frac{h}{2}\\frac{d}{dx} \\implies \\frac{d}{dx} = \\frac{2}{h}\\frac{d}{d\\xi}\n$$\nWe substitute these into the definition of $A_{ij}$:\n$$\nA_{ij} = \\int_{-1}^{1} D\\left(\\frac{2}{h}\\frac{d\\varphi_{i}}{d\\xi}\\right)\\left(\\frac{2}{h}\\frac{d\\varphi_{j}}{d\\xi}\\right)\\left(\\frac{h}{2}d\\xi\\right) + \\int_{-1}^{1} \\Sigma_{r}\\,\\varphi_{i}(\\xi)\\,\\varphi_{j}(\\xi)\\left(\\frac{h}{2}d\\xi\\right)\n$$\nSimplifying the constants outside the integrals gives:\n$$\nA_{ij} = \\frac{2D}{h} \\int_{-1}^{1} \\frac{d\\varphi_{i}}{d\\xi}\\frac{d\\varphi_{j}}{d\\xi}\\,d\\xi + \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} \\varphi_{i}(\\xi)\\varphi_{j}(\\xi)\\,d\\xi\n$$\nThis expression can be viewed as the sum of a \"stiffness\" matrix component $\\mathbf{K}$ and a \"mass\" matrix component $\\mathbf{M}$, where $A_{ij} = K_{ij} + M_{ij}$.\n\nLet's compute the integrals for each component. We need the derivatives of the basis functions with respect to $\\xi$:\n$$\n\\frac{d\\varphi_{0}}{d\\xi} = \\frac{d}{d\\xi}(1) = 0\n$$\n$$\n\\frac{d\\varphi_{1}}{d\\xi} = \\frac{d}{d\\xi}(\\xi) = 1\n$$\n$$\n\\frac{d\\varphi_{2}}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{3\\xi^2 - 1}{2}\\right) = 3\\xi\n$$\n\n**1. Calculation of the Stiffness Matrix, $\\mathbf{K}$**\n$$\nK_{ij} = \\frac{2D}{h} \\int_{-1}^{1} \\frac{d\\varphi_{i}}{d\\xi}\\frac{d\\varphi_{j}}{d\\xi}\\,d\\xi\n$$\n- Since $\\frac{d\\varphi_0}{d\\xi} = 0$, all elements in the first row and column are zero: $K_{00} = K_{01} = K_{10} = K_{02} = K_{20} = 0$.\n- For $K_{11}$:\n$$\nK_{11} = \\frac{2D}{h} \\int_{-1}^{1} (1)(1)\\,d\\xi = \\frac{2D}{h} [\\xi]_{-1}^{1} = \\frac{2D}{h}(2) = \\frac{4D}{h}\n$$\n- For $K_{22}$:\n$$\nK_{22} = \\frac{2D}{h} \\int_{-1}^{1} (3\\xi)(3\\xi)\\,d\\xi = \\frac{18D}{h} \\int_{-1}^{1} \\xi^2\\,d\\xi = \\frac{18D}{h} \\left[\\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\frac{18D}{h}\\left(\\frac{2}{3}\\right) = \\frac{12D}{h}\n$$\n- For the off-diagonal terms $K_{12}$ and $K_{21}$:\n$$\nK_{12} = K_{21} = \\frac{2D}{h} \\int_{-1}^{1} (1)(3\\xi)\\,d\\xi = \\frac{6D}{h} \\int_{-1}^{1} \\xi\\,d\\xi = \\frac{6D}{h} \\left[\\frac{\\xi^2}{2}\\right]_{-1}^{1} = 0\n$$\nThus, the stiffness matrix $\\mathbf{K}$ is diagonal:\n$$\n\\mathbf{K} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & \\frac{4D}{h} & 0 \\\\ 0 & 0 & \\frac{12D}{h} \\end{pmatrix}\n$$\n\n**2. Calculation of the Mass Matrix, $\\mathbf{M}$**\n$$\nM_{ij} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} \\varphi_{i}(\\xi)\\varphi_{j}(\\xi)\\,d\\xi\n$$\nThe basis functions $\\varphi_i = P_i$ are Legendre polynomials, which are orthogonal over $[-1, 1]$. Their orthogonality relation is:\n$$\n\\int_{-1}^{1} P_{i}(\\xi)P_{j}(\\xi)\\,d\\xi = \\frac{2}{2i+1}\\delta_{ij}\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta. This implies that the mass matrix $\\mathbf{M}$ is diagonal. We compute the diagonal elements:\n- For $M_{00}$:\n$$\nM_{00} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} P_0(\\xi)P_0(\\xi)\\,d\\xi = \\frac{h\\Sigma_{r}}{2} \\left(\\frac{2}{2(0)+1}\\right) = h\\Sigma_r\n$$\n- For $M_{11}$:\n$$\nM_{11} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} P_1(\\xi)P_1(\\xi)\\,d\\xi = \\frac{h\\Sigma_{r}}{2} \\left(\\frac{2}{2(1)+1}\\right) = \\frac{h\\Sigma_r}{3}\n$$\n- For $M_{22}$:\n$$\nM_{22} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} P_2(\\xi)P_2(\\xi)\\,d\\xi = \\frac{h\\Sigma_{r}}{2} \\left(\\frac{2}{2(2)+1}\\right) = \\frac{h\\Sigma_r}{5}\n$$\nThus, the mass matrix $\\mathbf{M}$ is:\n$$\n\\mathbf{M} = \\begin{pmatrix} h\\Sigma_r & 0 & 0 \\\\ 0 & \\frac{h\\Sigma_r}{3} & 0 \\\\ 0 & 0 & \\frac{h\\Sigma_r}{5} \\end{pmatrix}\n$$\n\n**3. Assembling the Matrix $\\mathbf{A}$ and Computing its Determinant**\nThe final matrix $\\mathbf{A}$ is the sum $\\mathbf{A} = \\mathbf{K} + \\mathbf{M}$. Since both $\\mathbf{K}$ and $\\mathbf{M}$ are diagonal, $\\mathbf{A}$ is also diagonal.\n$$\n\\mathbf{A} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & \\frac{4D}{h} & 0 \\\\ 0 & 0 & \\frac{12D}{h} \\end{pmatrix} + \\begin{pmatrix} h\\Sigma_r & 0 & 0 \\\\ 0 & \\frac{h\\Sigma_r}{3} & 0 \\\\ 0 & 0 & \\frac{h\\Sigma_r}{5} \\end{pmatrix} = \\begin{pmatrix} h\\Sigma_r & 0 & 0 \\\\ 0 & \\frac{4D}{h} + \\frac{h\\Sigma_r}{3} & 0 \\\\ 0 & 0 & \\frac{12D}{h} + \\frac{h\\Sigma_r}{5} \\end{pmatrix}\n$$\nThe determinant of a diagonal matrix is the product of its diagonal elements:\n$$\n\\det(\\mathbf{A}) = A_{00} \\cdot A_{11} \\cdot A_{22}\n$$\n$$\n\\det(\\mathbf{A}) = (h\\Sigma_r) \\left( \\frac{4D}{h} + \\frac{h\\Sigma_r}{3} \\right) \\left( \\frac{12D}{h} + \\frac{h\\Sigma_r}{5} \\right)\n$$\nTo obtain the required closed-form expression, we simplify the terms in the parentheses:\n$$\n\\frac{4D}{h} + \\frac{h\\Sigma_r}{3} = \\frac{3 \\cdot 4D + h \\cdot h\\Sigma_r}{3h} = \\frac{12D + h^2\\Sigma_r}{3h}\n$$\n$$\n\\frac{12D}{h} + \\frac{h\\Sigma_r}{5} = \\frac{5 \\cdot 12D + h \\cdot h\\Sigma_r}{5h} = \\frac{60D + h^2\\Sigma_r}{5h}\n$$\nSubstituting these back into the expression for the determinant:\n$$\n\\det(\\mathbf{A}) = (h\\Sigma_r) \\left( \\frac{12D + h^2\\Sigma_r}{3h} \\right) \\left( \\frac{60D + h^2\\Sigma_r}{5h} \\right)\n$$\n$$\n\\det(\\mathbf{A}) = \\frac{h\\Sigma_r}{15h^2} (12D + h^2\\Sigma_r)(60D + h^2\\Sigma_r)\n$$\n$$\n\\det(\\mathbf{A}) = \\frac{\\Sigma_r}{15h} (12D + h^2\\Sigma_r)(60D + h^2\\Sigma_r)\n$$\nThis is the final closed-form expression for the determinant of the matrix $\\mathbf{A}$.",
            "answer": "$$\\boxed{\\frac{\\Sigma_{r}}{15h}(12D + h^{2}\\Sigma_{r})(60D + h^{2}\\Sigma_{r})}$$"
        },
        {
            "introduction": "A critical step in developing any numerical code is verification—a rigorous process to ensure the implementation correctly solves the mathematical model. The Method of Manufactured Solutions (MMS) is a powerful technique for this, where we invent a problem with a known, exact analytical solution to serve as a benchmark. This practice guides you through creating such a benchmark, allowing you to derive the exact nodal average fluxes that a PENM code should reproduce, thereby providing a clear standard for assessing its accuracy. ",
            "id": "4241268",
            "problem": "Consider a one-dimensional, steady-state slab reactor benchmark designed for verification of Polynomial Expansion Nodal Methods (PENM). Let the slab occupy the interval $x \\in [0,L]$ and be homogeneous with constant diffusion coefficient $D$ and macroscopic absorption cross section $\\Sigma_{a}$. The driving term is a manufactured sinusoidal volumetric source $S(x) = S_{0} \\sin(\\kappa x)$ with $\\kappa = \\frac{n \\pi}{L}$ for a positive integer $n$. Impose vacuum boundary conditions at both ends, $ \\phi(0) = 0 $ and $ \\phi(L) = 0 $, where $ \\phi(x) $ is the scalar neutron flux.\n\nStarting from the steady one-group neutron diffusion equation in one dimension,\n$ -\\frac{d}{dx} \\left( D \\frac{d \\phi}{dx} \\right) + \\Sigma_{a} \\phi = S(x) $,\nderive the exact closed-form solution $ \\phi(x) $ for the case defined above. Then, partition the domain into $M$ equal nodes of width $h = \\frac{L}{M}$, and derive the exact analytic expression for the nodal average flux in node $j$, defined by\n$ \\bar{\\phi}_{j} = \\frac{1}{h} \\int_{(j-1)h}^{jh} \\phi(x) \\, dx $.\nFinally, evaluate $ \\bar{\\phi}_{3} $ numerically for the parameters $ L = 60 \\, \\mathrm{cm} $, $ M = 5 $, $ n = 3 $, $ D = 1.00 \\, \\mathrm{cm} $, $ \\Sigma_{a} = 0.10 \\, \\mathrm{cm}^{-1} $, and $ S_{0} = 1.00 \\times 10^{6} \\, \\mathrm{n} \\, \\mathrm{cm}^{-3} \\, \\mathrm{s}^{-1} $. Express the final value of $ \\bar{\\phi}_{3} $ in $ \\mathrm{cm}^{-2} \\, \\mathrm{s}^{-1} $ and round your answer to four significant figures.",
            "solution": "The problem statement is critically validated and found to be valid. It is a well-posed problem grounded in the established principles of nuclear reactor physics, specifically one-group neutron diffusion theory. The use of a manufactured sinusoidal source, which can take on negative values, is a standard and acceptable practice for creating benchmark problems designed to verify numerical methods. Although a negative source and the resulting negative flux are not physically realized in a fission-driven reactor, they are mathematically sound within the framework of the diffusion equation, where a negative source represents a spatially dependent sink term. The problem is self-contained, objective, and all provided parameters are consistent.\n\nThe one-dimensional, steady-state, one-group neutron diffusion equation for a homogeneous medium is given by:\n$$-\\frac{d}{dx} \\left( D \\frac{d \\phi}{dx} \\right) + \\Sigma_{a} \\phi(x) = S(x)$$\nGiven that the diffusion coefficient $D$ and the macroscopic absorption cross section $\\Sigma_{a}$ are constant, the equation simplifies to:\n$$-D \\frac{d^2 \\phi}{dx^2} + \\Sigma_{a} \\phi(x) = S(x)$$\nThe source term is specified as $S(x) = S_{0} \\sin(\\kappa x)$, with $\\kappa = \\frac{n \\pi}{L}$. The domain is $x \\in [0,L]$, and vacuum boundary conditions are imposed as $\\phi(0) = 0$ and $\\phi(L) = 0$.\n\nFirst, we derive the exact closed-form solution $\\phi(x)$.\nThe problem is set up such that the source term, $\\sin(\\kappa x)$, is an eigenfunction of the diffusion operator $-\\frac{d^2}{dx^2}$ on the domain $[0,L]$ with zero boundary conditions. This suggests seeking a solution of the form $\\phi(x) = A \\sin(\\kappa x)$, where $A$ is a constant to be determined.\nLet's verify the boundary conditions with this assumed form:\nAt $x=0$: $\\phi(0) = A \\sin(\\kappa \\cdot 0) = A \\sin(0) = 0$. This condition is satisfied.\nAt $x=L$: $\\phi(L) = A \\sin(\\kappa L)$. Since $\\kappa = \\frac{n \\pi}{L}$, we have $\\phi(L) = A \\sin\\left(\\frac{n \\pi}{L} \\cdot L\\right) = A \\sin(n \\pi) = 0$ for any integer $n$. This condition is also satisfied.\n\nNow, we substitute the proposed solution into the diffusion equation. The derivatives of $\\phi(x)$ are:\n$$\\frac{d \\phi}{dx} = A \\kappa \\cos(\\kappa x)$$\n$$\\frac{d^2 \\phi}{dx^2} = -A \\kappa^2 \\sin(\\kappa x)$$\nSubstituting into the diffusion equation:\n$$-D (-A \\kappa^2 \\sin(\\kappa x)) + \\Sigma_{a} (A \\sin(\\kappa x)) = S_{0} \\sin(\\kappa x)$$\n$$A (D \\kappa^2 + \\Sigma_{a}) \\sin(\\kappa x) = S_{0} \\sin(\\kappa x)$$\nFor this equality to hold for all $x \\in [0,L]$, the coefficients must be equal:\n$$A (D \\kappa^2 + \\Sigma_{a}) = S_{0}$$\nSolving for the constant $A$:\n$$A = \\frac{S_{0}}{D \\kappa^2 + \\Sigma_{a}}$$\nThus, the exact analytical solution for the neutron flux is:\n$$\\phi(x) = \\frac{S_{0}}{D \\kappa^2 + \\Sigma_{a}} \\sin(\\kappa x)$$\n\nNext, we derive the expression for the nodal average flux, $\\bar{\\phi}_{j}$, for node $j$. The domain $[0,L]$ is partitioned into $M$ equal nodes, each of width $h = \\frac{L}{M}$. Node $j$ spans the interval $[(j-1)h, jh]$. The average flux is defined as:\n$$\\bar{\\phi}_{j} = \\frac{1}{h} \\int_{(j-1)h}^{jh} \\phi(x) \\, dx$$\nSubstituting the expression for $\\phi(x)$:\n$$\\bar{\\phi}_{j} = \\frac{1}{h} \\int_{(j-1)h}^{jh} \\frac{S_{0}}{D \\kappa^2 + \\Sigma_{a}} \\sin(\\kappa x) \\, dx$$\nThe constant term can be moved outside the integral:\n$$\\bar{\\phi}_{j} = \\frac{S_{0}}{h (D \\kappa^2 + \\Sigma_{a})} \\int_{(j-1)h}^{jh} \\sin(\\kappa x) \\, dx$$\nThe integral of $\\sin(\\kappa x)$ is $-\\frac{1}{\\kappa}\\cos(\\kappa x)$. Evaluating the definite integral:\n$$\\int_{(j-1)h}^{jh} \\sin(\\kappa x) \\, dx = \\left[ -\\frac{1}{\\kappa} \\cos(\\kappa x) \\right]_{(j-1)h}^{jh} = -\\frac{1}{\\kappa} (\\cos(\\kappa jh) - \\cos(\\kappa (j-1)h))$$\n$$= \\frac{1}{\\kappa} (\\cos(\\kappa(j-1)h) - \\cos(\\kappa jh))$$\nSubstituting this result back into the expression for $\\bar{\\phi}_{j}$:\n$$\\bar{\\phi}_{j} = \\frac{S_{0}}{h \\kappa (D \\kappa^2 + \\Sigma_{a})} (\\cos(\\kappa(j-1)h) - \\cos(\\kappa jh))$$\nThis is the exact analytic expression for the nodal average flux in node $j$.\n\nFinally, we evaluate $\\bar{\\phi}_{3}$ for the given parameters:\n$L = 60 \\, \\mathrm{cm}$\n$M = 5$\n$n = 3$\n$D = 1.00 \\, \\mathrm{cm}$\n$\\Sigma_{a} = 0.10 \\, \\mathrm{cm}^{-1}$\n$S_{0} = 1.00 \\times 10^{6} \\, \\mathrm{n} \\, \\mathrm{cm}^{-3} \\, \\mathrm{s}^{-1}$\nThe target node is $j=3$.\n\nFirst, we calculate the derived parameters $h$ and $\\kappa$:\nNode width: $h = \\frac{L}{M} = \\frac{60}{5} = 12 \\, \\mathrm{cm}$\nWave number: $\\kappa = \\frac{n \\pi}{L} = \\frac{3 \\pi}{60} = \\frac{\\pi}{20} \\, \\mathrm{cm}^{-1}$\n\nNow, we evaluate the expression for $\\bar{\\phi}_{3}$:\n$$\\bar{\\phi}_{3} = \\frac{S_{0}}{h \\kappa (D \\kappa^2 + \\Sigma_{a})} (\\cos(\\kappa(2h)) - \\cos(\\kappa(3h)))$$\nThe arguments for the cosine functions are:\n$\\kappa (2h) = \\frac{\\pi}{20} \\cdot (2 \\cdot 12) = \\frac{24\\pi}{20} = \\frac{6\\pi}{5}$\n$\\kappa (3h) = \\frac{\\pi}{20} \\cdot (3 \\cdot 12) = \\frac{36\\pi}{20} = \\frac{9\\pi}{5}$\nThe cosine terms are:\n$\\cos\\left(\\frac{6\\pi}{5}\\right) = \\cos\\left(\\pi + \\frac{\\pi}{5}\\right) = -\\cos\\left(\\frac{\\pi}{5}\\right)$\n$\\cos\\left(\\frac{9\\pi}{5}\\right) = \\cos\\left(2\\pi - \\frac{\\pi}{5}\\right) = \\cos\\left(\\frac{\\pi}{5}\\right)$\nThe difference is:\n$\\cos\\left(\\frac{6\\pi}{5}\\right) - \\cos\\left(\\frac{9\\pi}{5}\\right) = -\\cos\\left(\\frac{\\pi}{5}\\right) - \\cos\\left(\\frac{\\pi}{5}\\right) = -2\\cos\\left(\\frac{\\pi}{5}\\right)$\nThe exact value of $\\cos(\\frac{\\pi}{5})$ is $\\frac{1+\\sqrt{5}}{4}$. So, the difference is $-2\\left(\\frac{1+\\sqrt{5}}{4}\\right) = -\\frac{1+\\sqrt{5}}{2}$.\n\nNow, let's assemble the full expression for $\\bar{\\phi}_{3}$ with numerical values:\nThe denominator term $(D \\kappa^2 + \\Sigma_{a})$ is:\n$D \\kappa^2 + \\Sigma_{a} = (1.00) \\left(\\frac{\\pi}{20}\\right)^2 + 0.10 = \\frac{\\pi^2}{400} + 0.10 \\, \\mathrm{cm}^{-1}$\nThe denominator $h \\kappa (D \\kappa^2 + \\Sigma_{a})$ is:\n$12 \\cdot \\frac{\\pi}{20} \\left(\\frac{\\pi^2}{400} + 0.10\\right) = \\frac{3\\pi}{5} \\left(\\frac{\\pi^2+40}{400}\\right) = \\frac{3\\pi(\\pi^2+40)}{2000}$\nThe numerator $S_0 (\\cos(\\kappa(2h)) - \\cos(\\kappa(3h)))$ is:\n$(1.00 \\times 10^6) \\left(-\\frac{1+\\sqrt{5}}{2}\\right)$\nSo, we have:\n$$\\bar{\\phi}_{3} = \\frac{(1.00 \\times 10^6) \\left(-\\frac{1+\\sqrt{5}}{2}\\right)}{\\frac{3\\pi(\\pi^2+40)}{2000}} = \\frac{-1000 \\cdot (1.00 \\times 10^6) (1+\\sqrt{5})}{3\\pi(\\pi^2+40)}$$\n$$\\bar{\\phi}_{3} = \\frac{-10^9 (1+\\sqrt{5})}{3\\pi(\\pi^2+40)}$$\nNow, we compute the numerical value:\n$1+\\sqrt{5} \\approx 3.236068$\n$\\pi^2+40 \\approx 9.869604 + 40 = 49.869604$\n$3\\pi \\approx 9.424778$\n$$\\bar{\\phi}_{3} \\approx \\frac{-10^9 \\times 3.236068}{9.424778 \\times 49.869604} \\approx \\frac{-3.236068 \\times 10^9}{470.0035} \\approx -6.88522 \\times 10^6$$\nThe units are $\\mathrm{cm}^{-2} \\, \\mathrm{s}^{-1}$.\nRounding the result to four significant figures gives $-6.885 \\times 10^6$. The negative value is the correct mathematical result, as the source term $S(x)$ is negative over the interval corresponding to node $3$, i.e., $x \\in [24, 36]$.",
            "answer": "$$\\boxed{-6.885 \\times 10^{6}}$$"
        },
        {
            "introduction": "The practical efficiency of high-order methods like PENM hinges on tailoring the computational effort to the problem's needs, particularly by adapting the polynomial degree to the local solution behavior. In realistic geometries, computational cells (nodes) are often stretched, creating anisotropy that requires different approximation strategies in each direction. This exercise explores how to quantify the relationship between a node's aspect ratio and the required polynomial order, teaching you how to maintain uniform accuracy across anisotropic domains, a key skill for advanced reactor analysis. ",
            "id": "4241251",
            "problem": "Consider a single-group neutron diffusion model in a homogeneous rectangular node with sides aligned to the Cartesian axes. In a Polynomial Expansion Nodal Method (PENM), the within-node scalar flux is approximated by a tensor-product of one-dimensional polynomial expansions in each coordinate, and transverse integration is applied to obtain one-dimensional balance equations whose sources are the transverse leakage terms. Assume the exact within-node flux is smooth and, to leading order within the node, is separable and modal, given by $\\phi(x,y)=\\cos(\\kappa x)\\cos(\\kappa y)$, where $\\kappa$ is a real, positive constant determined by material and global spectral properties. The node is centered at the origin and spans $[-h_x/2,h_x/2]\\times[-h_y/2,h_y/2]$.\n\nYou will use the following context-appropriate fundamentals:\n- The single-group diffusion operator is linear and the transverse leakage term is the averaged second derivative in the transverse direction, so its relative error is bounded (up to a direction-independent constant) by the best uniform approximation error of the corresponding one-dimensional shape $\\cos(\\kappa s)$ on $s\\in[-h_s/2,h_s/2]$, where $s\\in\\{x,y\\}$.\n- For an analytic function on a symmetric interval, Taylor’s theorem about the remainder around the interval center implies that the degree-$p$ polynomial approximation yields a uniform approximation error bounded by the magnitude of the first neglected Taylor term. Consequently, for $f(s)=\\cos(\\kappa s)$ on $[-h_s/2,h_s/2]$, there exists a constant-independent bound of the form $\\left(\\kappa h_s/2\\right)^{p+1}/(p+1)!$ for the best uniform polynomial approximation error of degree $p$.\n\nLet the aspect ratio be $a=h_x/h_y$, and assume the following data:\n- $\\kappa=6\\,\\mathrm{m}^{-1}$,\n- $h_y=0.06\\,\\mathrm{m}$,\n- $a=5$ (so $h_x=a\\,h_y$),\n- a target bound on the total relative error in the transverse leakage modeling of $\\varepsilon=10^{-6}$.\n\nAdopt a conservative decoupled allocation in which the total error bound is enforced by bounding each directional contribution by $\\varepsilon/2$. Using only the principles stated above, determine the minimal degrees $p_x$ and $p_y$ in the $x$ and $y$ directions, respectively, such that the bound $\\left(\\kappa h_s/2\\right)^{p_s+1}/(p_s+1)!\\le \\varepsilon/2$ holds for $s\\in\\{x,y\\}$, and then report the anisotropic degree requirement as the single integer $\\Delta p=p_x-p_y$.",
            "solution": "The problem requires the determination of the minimal polynomial expansion degrees, $p_x$ and $p_y$, for the $x$ and $y$ spatial directions, respectively, to meet a specified error tolerance in the context of a Polynomial Expansion Nodal Method (PENM). The final result is the anisotropic degree requirement, defined as $\\Delta p = p_x - p_y$.\n\nThe validation of the problem statement proceeds as follows.\nGivens are extracted verbatim:\n- The within-node scalar flux is approximated by $\\phi(x,y)=\\cos(\\kappa x)\\cos(\\kappa y)$.\n- The node spans $[-h_x/2,h_x/2]\\times[-h_y/2,h_y/2]$.\n- The uniform polynomial approximation error of degree $p$ for $\\cos(\\kappa s)$ on $[-h_s/2,h_s/2]$ is bounded by $\\frac{(\\kappa h_s/2)^{p+1}}{(p+1)!}$.\n- The aspect ratio is $a=h_x/h_y$.\n- $\\kappa=6\\,\\mathrm{m}^{-1}$.\n- $h_y=0.06\\,\\mathrm{m}$.\n- $a=5$.\n- Target total relative error bound is $\\varepsilon=10^{-6}$.\n- The total error bound is allocated such that each directional contribution is bounded by $\\varepsilon/2$.\n- The specific constraints to be solved are $\\frac{(\\kappa h_s/2)^{p_s+1}}{(p_s+1)!}\\le \\frac{\\varepsilon}{2}$ for $s\\in\\{x,y\\}$.\n- The quantity to be reported is $\\Delta p=p_x-p_y$.\n\nThe problem is scientifically grounded in the fields of nuclear reactor physics and numerical analysis, specifically concerning nodal diffusion methods. The use of Taylor's theorem to bound the error of a polynomial approximation of an analytic function is a standard mathematical technique. The problem is well-posed, as it provides all necessary data and a clear objective to find the minimal integers satisfying a set of inequalities. All terms are defined objectively and precisely. The parameters are physically plausible. Therefore, the problem is deemed valid and a solution can be pursued.\n\nThe task is to find the smallest integers $p_x$ and $p_y$ that satisfy the following inequalities:\n$$\n\\frac{(\\frac{\\kappa h_x}{2})^{p_x+1}}{(p_x+1)!} \\le \\frac{\\varepsilon}{2}\n$$\n$$\n\\frac{(\\frac{\\kappa h_y}{2})^{p_y+1}}{(p_y+1)!} \\le \\frac{\\varepsilon}{2}\n$$\n\nFirst, we calculate the physical dimensions and the arguments of the numerical terms.\nThe node width in the $y$-direction is given as $h_y = 0.06\\,\\mathrm{m}$.\nThe aspect ratio is $a = 5$, so the node width in the $x$-direction is $h_x = a \\cdot h_y = 5 \\times 0.06\\,\\mathrm{m} = 0.3\\,\\mathrm{m}$.\nThe material-geometric parameter $\\kappa$ is given as $6\\,\\mathrm{m}^{-1}$.\nThe target error bound for each direction is $\\frac{\\varepsilon}{2} = \\frac{10^{-6}}{2} = 5 \\times 10^{-7}$.\n\nLet's define the dimensionless arguments $B_x$ and $B_y$:\n$$\nB_x = \\frac{\\kappa h_x}{2} = \\frac{(6\\,\\mathrm{m}^{-1}) \\times (0.3\\,\\mathrm{m})}{2} = \\frac{1.8}{2} = 0.9\n$$\n$$\nB_y = \\frac{\\kappa h_y}{2} = \\frac{(6\\,\\mathrm{m}^{-1}) \\times (0.06\\,\\mathrm{m})}{2} = \\frac{0.36}{2} = 0.18\n$$\n\nThe inequalities to be solved become:\n$$\n\\frac{(0.9)^{p_x+1}}{(p_x+1)!} \\le 5 \\times 10^{-7}\n$$\n$$\n\\frac{(0.18)^{p_y+1}}{(p_y+1)!} \\le 5 \\times 10^{-7}\n$$\n\nWe will find the minimal integer $p_y$ first. Let's evaluate the expression $E_y(p_y) = \\frac{(0.18)^{p_y+1}}{(p_y+1)!}$ for increasing integer values of $p_y$:\n- For $p_y=0$: $E_y(0) = \\frac{0.18^1}{1!} = 0.18$\n- For $p_y=1$: $E_y(1) = \\frac{0.18^2}{2!} = \\frac{0.0324}{2} = 0.0162$\n- For $p_y=2$: $E_y(2) = \\frac{0.18^3}{3!} = \\frac{0.005832}{6} = 9.72 \\times 10^{-4}$\n- For $p_y=3$: $E_y(3) = \\frac{0.18^4}{4!} = \\frac{1.04976 \\times 10^{-3}}{24} \\approx 4.374 \\times 10^{-5}$\n- For $p_y=4$: $E_y(4) = \\frac{0.18^5}{5!} = \\frac{1.889568 \\times 10^{-4}}{120} \\approx 1.575 \\times 10^{-6}$\n- For $p_y=5$: $E_y(5) = \\frac{0.18^6}{6!} = \\frac{3.4012224 \\times 10^{-5}}{720} \\approx 4.724 \\times 10^{-8}$\n\nThe value for $p_y=4$ gives an error bound of $1.575 \\times 10^{-6}$, which is greater than the required $5 \\times 10^{-7}$. The value for $p_y=5$ gives $4.724 \\times 10^{-8}$, which is less than $5 \\times 10^{-7}$. Therefore, the minimal polynomial degree required in the $y$-direction is $p_y=5$.\n\nNext, we find the minimal integer $p_x$. Let's evaluate the expression $E_x(p_x) = \\frac{(0.9)^{p_x+1}}{(p_x+1)!}$ for increasing integer values of $p_x$:\n- For $p_x=5$: $E_x(5) = \\frac{0.9^6}{6!} = \\frac{0.531441}{720} \\approx 7.381 \\times 10^{-4}$\n- For $p_x=6$: $E_x(6) = \\frac{0.9^7}{7!} = \\frac{0.4782969}{5040} \\approx 9.490 \\times 10^{-5}$\n- For $p_x=7$: $E_x(7) = \\frac{0.9^8}{8!} = \\frac{0.43046721}{40320} \\approx 1.068 \\times 10^{-5}$\n- For $p_x=8$: $E_x(8) = \\frac{0.9^9}{9!} = \\frac{0.387420489}{362880} \\approx 1.068 \\times 10^{-6}$\n- For $p_x=9$: $E_x(9) = \\frac{0.9^{10}}{10!} = \\frac{0.3486784401}{3628800} \\approx 9.609 \\times 10^{-8}$\n\nThe value for $p_x=8$ gives an error bound of approximately $1.068 \\times 10^{-6}$, which is greater than the required $5 \\times 10^{-7}$. The value for $p_x=9$ gives approximately $9.609 \\times 10^{-8}$, which is less than $5 \\times 10^{-7}$. Therefore, the minimal polynomial degree required in the $x$-direction is $p_x=9$.\n\nThe problem asks for the anisotropic degree requirement, $\\Delta p$.\n$$\n\\Delta p = p_x - p_y = 9 - 5 = 4\n$$\nThe difference in the required polynomial orders is a direct consequence of the node's large aspect ratio, which makes the flux shape vary much more rapidly with respect to the dimensionless coordinate in the longer direction.",
            "answer": "$$\\boxed{4}$$"
        }
    ]
}