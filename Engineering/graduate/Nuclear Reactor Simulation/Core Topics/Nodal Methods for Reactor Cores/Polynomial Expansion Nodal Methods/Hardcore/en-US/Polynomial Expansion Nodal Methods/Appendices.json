{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any nodal method lies in correctly formulating the discrete equations for a single computational cell, or node. This practice guides you through the essential mechanics of the Polynomial Expansion Nodal Method (PENM) by having you construct the local coefficient matrix from first principles . By applying the Galerkin procedure with Legendre polynomial basis functions, you will gain a concrete understanding of how the physical properties of the system, such as the diffusion coefficient $D$ and removal cross-section $\\Sigma_{r}$, translate into a numerical 'stiffness' and 'mass' matrix.",
            "id": "4241293",
            "problem": "In a one-group steady-state neutron diffusion model for a homogeneous one-dimensional node of physical width $h$, with constant diffusion coefficient $D$ and constant macroscopic removal cross section $\\Sigma_{r}$, consider the Polynomial Expansion Nodal Method (PENM), a Galerkin nodal method that expands the scalar neutron flux $\\phi(x)$ locally in a polynomial basis. Map the node $x \\in [x_{L}, x_{R}]$ to the reference coordinate $\\xi \\in [-1,1]$ via the affine mapping $x(\\xi) = \\frac{h}{2}\\,\\xi + x_{c}$, where $x_{c}$ is the node center. Use the first three Legendre polynomials on $[-1,1]$ as the local basis functions:\n$$\n\\varphi_{0}(\\xi) = P_{0}(\\xi) = 1,\\quad \\varphi_{1}(\\xi) = P_{1}(\\xi) = \\xi,\\quad \\varphi_{2}(\\xi) = P_{2}(\\xi) = \\frac{3\\xi^{2}-1}{2}.\n$$\nAssume homogeneous Neumann boundary conditions (zero net current) at the node faces so that boundary terms vanish in the symmetric weak form. Using a standard Galerkin procedure with the same polynomials as test functions, the local coefficient matrix $\\mathbf{A}$ for the modal amplitudes $\\mathbf{a} = [a_{0}, a_{1}, a_{2}]^{\\mathsf{T}}$ has entries\n$$\nA_{ij} \\equiv \\int_{x_{L}}^{x_{R}} D\\,\\frac{d\\varphi_{i}}{dx}\\,\\frac{d\\varphi_{j}}{dx}\\,dx \\;+\\; \\int_{x_{L}}^{x_{R}} \\Sigma_{r}\\,\\varphi_{i}\\,\\varphi_{j}\\,dx,\\quad i,j\\in\\{0,1,2\\}.\n$$\nDerive the expressions for $A_{ij}$ in terms of $D$, $\\Sigma_{r}$, and $h$ by mapping these integrals to the reference domain and evaluating the polynomial inner products exactly. Then, assemble the resulting $3\\times 3$ matrix $\\mathbf{A}$.\n\nFinally, compute the determinant $\\det(\\mathbf{A})$ in closed form, expressed only in terms of $D$, $\\Sigma_{r}$, and $h$. Provide your final answer as a single closed-form analytic expression. No numerical approximation is required and no units should be included in the final answer.",
            "solution": "The problem requires the derivation of the coefficient matrix $\\mathbf{A}$ for a Polynomial Expansion Nodal Method (PENM) formulation of the one-dimensional, one-group neutron diffusion equation, and the subsequent calculation of its determinant. The validation of the problem statement precedes the solution.\n\n### Step 1: Extract Givens\n- **Model**: One-group, steady-state, homogeneous neutron diffusion.\n- **Node geometry**: One-dimensional, physical width $h$.\n- **Physical constants**: Diffusion coefficient $D$ (constant), macroscopic removal cross section $\\Sigma_r$ (constant).\n- **Method**: Galerkin nodal method (PENM).\n- **Coordinate mapping**: $x(\\xi) = \\frac{h}{2}\\xi + x_{c}$ for $x \\in [x_L, x_R]$ and $\\xi \\in [-1, 1]$.\n- **Basis and test functions**: $\\varphi_{0}(\\xi) = P_{0}(\\xi) = 1$, $\\varphi_{1}(\\xi) = P_{1}(\\xi) = \\xi$, $\\varphi_{2}(\\xi) = P_{2}(\\xi) = \\frac{3\\xi^{2}-1}{2}$.\n- **Boundary conditions**: Homogeneous Neumann (zero net current) at node faces, leading to vanishing boundary terms.\n- **Matrix element definition**: $A_{ij} \\equiv \\int_{x_{L}}^{x_{R}} D\\,\\frac{d\\varphi_{i}}{dx}\\,\\frac{d\\varphi_{j}}{dx}\\,dx \\;+\\; \\int_{x_{L}}^{x_{R}} \\Sigma_{r}\\,\\varphi_{i}\\,\\varphi_{j}\\,dx$, for $i,j\\in\\{0,1,2\\}$.\n- **Objective**: Derive the $3\\times3$ matrix $\\mathbf{A}$ and compute its determinant, $\\det(\\mathbf{A})$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the standard neutron diffusion equation and the Galerkin finite element method, which are fundamental concepts in nuclear engineering and computational physics. The use of Legendre polynomials as basis functions is a standard choice for PENM.\n- **Well-Posed**: The problem is clearly stated with all necessary definitions, constants, and functions provided to uniquely determine the matrix $\\mathbf{A}$ and its determinant.\n- **Objective**: The problem is formulated with precise mathematical and physical terminology, free from subjective or ambiguous language.\n- **Completeness and Consistency**: The problem is self-contained. The definition of $A_{ij}$ is consistent with the weak form of the diffusion operator $-D\\frac{d^2}{dx^2} + \\Sigma_r$, and the assumption of vanishing boundary terms is consistent with the specified Neumann conditions.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically sound, well-posed, and complete. A rigorous solution can be constructed.\n\n### Solution Derivation\nThe matrix elements $A_{ij}$ are defined by integrals over the physical domain $x \\in [x_L, x_R]$. To evaluate these, we transform the integrals to the reference domain $\\xi \\in [-1, 1]$.\n\nFirst, we establish the relationship between the differentials $dx$ and $d\\xi$, and the derivatives $\\frac{d}{dx}$ and $\\frac{d}{d\\xi}$.\nFrom the mapping $x(\\xi) = \\frac{h}{2}\\xi + x_c$, we find the Jacobian of the transformation:\n$$\n\\frac{dx}{d\\xi} = \\frac{h}{2} \\implies dx = \\frac{h}{2} d\\xi\n$$\nUsing the chain rule for derivatives:\n$$\n\\frac{d}{d\\xi} = \\frac{dx}{d\\xi}\\frac{d}{dx} = \\frac{h}{2}\\frac{d}{dx} \\implies \\frac{d}{dx} = \\frac{2}{h}\\frac{d}{d\\xi}\n$$\nWe substitute these into the definition of $A_{ij}$:\n$$\nA_{ij} = \\int_{-1}^{1} D\\left(\\frac{2}{h}\\frac{d\\varphi_{i}}{d\\xi}\\right)\\left(\\frac{2}{h}\\frac{d\\varphi_{j}}{d\\xi}\\right)\\left(\\frac{h}{2}d\\xi\\right) + \\int_{-1}^{1} \\Sigma_{r}\\,\\varphi_{i}(\\xi)\\,\\varphi_{j}(\\xi)\\left(\\frac{h}{2}d\\xi\\right)\n$$\nSimplifying the constants outside the integrals gives:\n$$\nA_{ij} = \\frac{2D}{h} \\int_{-1}^{1} \\frac{d\\varphi_{i}}{d\\xi}\\frac{d\\varphi_{j}}{d\\xi}\\,d\\xi + \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} \\varphi_{i}(\\xi)\\varphi_{j}(\\xi)\\,d\\xi\n$$\nThis expression can be viewed as the sum of a \"stiffness\" matrix component $\\mathbf{K}$ and a \"mass\" matrix component $\\mathbf{M}$, where $A_{ij} = K_{ij} + M_{ij}$.\n\nLet's compute the integrals for each component. We need the derivatives of the basis functions with respect to $\\xi$:\n$$\n\\frac{d\\varphi_{0}}{d\\xi} = \\frac{d}{d\\xi}(1) = 0\n$$\n$$\n\\frac{d\\varphi_{1}}{d\\xi} = \\frac{d}{d\\xi}(\\xi) = 1\n$$\n$$\n\\frac{d\\varphi_{2}}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{3\\xi^2 - 1}{2}\\right) = 3\\xi\n$$\n\n**1. Calculation of the Stiffness Matrix, $\\mathbf{K}$**\n$$\nK_{ij} = \\frac{2D}{h} \\int_{-1}^{1} \\frac{d\\varphi_{i}}{d\\xi}\\frac{d\\varphi_{j}}{d\\xi}\\,d\\xi\n$$\n- Since $\\frac{d\\varphi_0}{d\\xi} = 0$, all elements in the first row and column are zero: $K_{00} = K_{01} = K_{10} = K_{02} = K_{20} = 0$.\n- For $K_{11}$:\n$$\nK_{11} = \\frac{2D}{h} \\int_{-1}^{1} (1)(1)\\,d\\xi = \\frac{2D}{h} [\\xi]_{-1}^{1} = \\frac{2D}{h}(2) = \\frac{4D}{h}\n$$\n- For $K_{22}$:\n$$\nK_{22} = \\frac{2D}{h} \\int_{-1}^{1} (3\\xi)(3\\xi)\\,d\\xi = \\frac{18D}{h} \\int_{-1}^{1} \\xi^2\\,d\\xi = \\frac{18D}{h} \\left[\\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\frac{18D}{h}\\left(\\frac{2}{3}\\right) = \\frac{12D}{h}\n$$\n- For the off-diagonal terms $K_{12}$ and $K_{21}$:\n$$\nK_{12} = K_{21} = \\frac{2D}{h} \\int_{-1}^{1} (1)(3\\xi)\\,d\\xi = \\frac{6D}{h} \\int_{-1}^{1} \\xi\\,d\\xi = \\frac{6D}{h} \\left[\\frac{\\xi^2}{2}\\right]_{-1}^{1} = 0\n$$\nThus, the stiffness matrix $\\mathbf{K}$ is diagonal:\n$$\n\\mathbf{K} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & \\frac{4D}{h} & 0 \\\\ 0 & 0 & \\frac{12D}{h} \\end{pmatrix}\n$$\n\n**2. Calculation of the Mass Matrix, $\\mathbf{M}$**\n$$\nM_{ij} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} \\varphi_{i}(\\xi)\\varphi_{j}(\\xi)\\,d\\xi\n$$\nThe basis functions $\\varphi_i = P_i$ are Legendre polynomials, which are orthogonal over $[-1, 1]$. Their orthogonality relation is:\n$$\n\\int_{-1}^{1} P_{i}(\\xi)P_{j}(\\xi)\\,d\\xi = \\frac{2}{2i+1}\\delta_{ij}\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta. This implies that the mass matrix $\\mathbf{M}$ is diagonal. We compute the diagonal elements:\n- For $M_{00}$:\n$$\nM_{00} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} P_0(\\xi)P_0(\\xi)\\,d\\xi = \\frac{h\\Sigma_{r}}{2} \\left(\\frac{2}{2(0)+1}\\right) = h\\Sigma_r\n$$\n- For $M_{11}$:\n$$\nM_{11} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} P_1(\\xi)P_1(\\xi)\\,d\\xi = \\frac{h\\Sigma_{r}}{2} \\left(\\frac{2}{2(1)+1}\\right) = \\frac{h\\Sigma_r}{3}\n$$\n- For $M_{22}$:\n$$\nM_{22} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} P_2(\\xi)P_2(\\xi)\\,d\\xi = \\frac{h\\Sigma_{r}}{2} \\left(\\frac{2}{2(2)+1}\\right) = \\frac{h\\Sigma_r}{5}\n$$\nThus, the mass matrix $\\mathbf{M}$ is:\n$$\n\\mathbf{M} = \\begin{pmatrix} h\\Sigma_r & 0 & 0 \\\\ 0 & \\frac{h\\Sigma_r}{3} & 0 \\\\ 0 & 0 & \\frac{h\\Sigma_r}{5} \\end{pmatrix}\n$$\n\n**3. Assembling the Matrix $\\mathbf{A}$ and a Computing its Determinant**\nThe final matrix $\\mathbf{A}$ is the sum $\\mathbf{A} = \\mathbf{K} + \\mathbf{M}$. Since both $\\mathbf{K}$ and $\\mathbf{M}$ are diagonal, $\\mathbf{A}$ is also diagonal.\n$$\n\\mathbf{A} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & \\frac{4D}{h} & 0 \\\\ 0 & 0 & \\frac{12D}{h} \\end{pmatrix} + \\begin{pmatrix} h\\Sigma_r & 0 & 0 \\\\ 0 & \\frac{h\\Sigma_r}{3} & 0 \\\\ 0 & 0 & \\frac{h\\Sigma_r}{5} \\end{pmatrix} = \\begin{pmatrix} h\\Sigma_r & 0 & 0 \\\\ 0 & \\frac{4D}{h} + \\frac{h\\Sigma_r}{3} & 0 \\\\ 0 & 0 & \\frac{12D}{h} + \\frac{h\\Sigma_r}{5} \\end{pmatrix}\n$$\nThe determinant of a diagonal matrix is the product of its diagonal elements:\n$$\n\\det(\\mathbf{A}) = A_{00} \\cdot A_{11} \\cdot A_{22}\n$$\n$$\n\\det(\\mathbf{A}) = (h\\Sigma_r) \\left( \\frac{4D}{h} + \\frac{h\\Sigma_r}{3} \\right) \\left( \\frac{12D}{h} + \\frac{h\\Sigma_r}{5} \\right)\n$$\nTo obtain the required closed-form expression, we simplify the terms in the parentheses:\n$$\n\\frac{4D}{h} + \\frac{h\\Sigma_r}{3} = \\frac{3 \\cdot 4D + h \\cdot h\\Sigma_r}{3h} = \\frac{12D + h^2\\Sigma_r}{3h}\n$$\n$$\n\\frac{12D}{h} + \\frac{h\\Sigma_r}{5} = \\frac{5 \\cdot 12D + h \\cdot h\\Sigma_r}{5h} = \\frac{60D + h^2\\Sigma_r}{5h}\n$$\nSubstituting these back into the expression for the determinant:\n$$\n\\det(\\mathbf{A}) = (h\\Sigma_r) \\left( \\frac{12D + h^2\\Sigma_r}{3h} \\right) \\left( \\frac{60D + h^2\\Sigma_r}{5h} \\right)\n$$\n$$\n\\det(\\mathbf{A}) = \\frac{h\\Sigma_r}{15h^2} (12D + h^2\\Sigma_r)(60D + h^2\\Sigma_r)\n$$\n$$\n\\det(\\mathbf{A}) = \\frac{\\Sigma_r}{15h} (12D + h^2\\Sigma_r)(60D + h^2\\Sigma_r)\n$$\nThis is the final closed-form expression for the determinant of the matrix $\\mathbf{A}$.",
            "answer": "$$\\boxed{\\frac{\\Sigma_{r}}{15h}(12D + h^{2}\\Sigma_{r})(60D + h^{2}\\Sigma_{r})}$$"
        },
        {
            "introduction": "While understanding a single node is crucial, a reactor simulation requires coupling many nodes together to model the entire domain. This exercise demonstrates how to build a global system matrix by enforcing physical continuity conditions for flux and current at the interfaces between nodes . You will derive the response matrix that connects the flux values at node boundaries, see how this forms a global linear system, and analyze its properties to make informed choices about iterative solvers and preconditioning.",
            "id": "4241267",
            "problem": "Consider a one-dimensional slab reactor of length $2h$ partitioned into two equal nodes $[0,h]$ and $[h,2h]$. Assume a single-group, steady-state neutron diffusion model with constant diffusion coefficient $D$ and zero absorption, governed by the diffusion equation $-\\frac{d}{dx}\\left(D \\frac{d \\phi}{dx}\\right) = q(x)$ with net fixed source $q(x)$ that is constant within each node. The left and right physical boundaries at $x=0$ and $x=2h$ satisfy the Marshak vacuum boundary condition $\\phi + 2 D \\,\\partial \\phi/\\partial n = 0$. Within each node, approximate the scalar flux $\\phi(x)$ using a polynomial expansion nodal method of degree at most two and employ the standard elimination of intra-nodal coefficients to couple only the face (interface) flux unknowns. Let the interface-flux unknown vector be $\\boldsymbol{\\varphi} = \\begin{pmatrix} \\phi_0 & \\phi_1 & \\phi_2 \\end{pmatrix}^{\\mathsf{T}}$, where $\\phi_0=\\phi(0)$, $\\phi_1=\\phi(h)$, and $\\phi_2=\\phi(2h)$.\n\nUsing only fundamental definitions and conservation statements (the diffusion equation, Fickâ€™s law $J=-D\\,d\\phi/dx$, continuity of net current at the internal interface, and the Marshak boundary conditions expressed in terms of $J$ and $\\phi$), construct the global sparse linear system for $\\boldsymbol{\\varphi}$ of the form $A\\,\\boldsymbol{\\varphi}=\\boldsymbol{b}$ by eliminating any intra-nodal expansion coefficients. Then analyze the sparsity and block structure of $A$ to justify a specific Krylov subspace method and a natural preconditioner choice.\n\nSpecialize to the data $D=1$ and $h=1$ and retain the Marshak coefficient $2D$ explicitly in the boundary conditions. With this specialization, form the Jacobi preconditioner $P=\\mathrm{diag}(A)$ and the symmetrically preconditioned operator $M=P^{-1/2} A P^{-1/2}$. Compute the exact condition number $\\kappa(M)$, defined as the ratio of the largest to the smallest eigenvalue of $M$, as a closed-form analytic expression. Express your final answer as an exact expression; do not approximate or round. No physical units are required in the final answer.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Governing Equation**: One-dimensional ($1$D), single-group, steady-state neutron diffusion equation: $-\\frac{d}{dx}\\left(D \\frac{d \\phi}{dx}\\right) = q(x)$.\n- **Domain**: A slab of length $2h$, partitioned into two equal nodes: node $1$ on $[0,h]$ and node $2$ on $[h,2h]$.\n- **Parameters**: The diffusion coefficient $D$ is constant. The absorption cross-section is zero. The net fixed source $q(x)$ is constant within each node, denoted as $q_1$ for node $1$ and $q_2$ for node $2$.\n- **Boundary Conditions (BCs)**: Marshak vacuum boundary conditions at the external surfaces $x=0$ and $x=2h$: $\\phi + 2 D \\,\\partial \\phi/\\partial n = 0$, where $\\partial \\phi/\\partial n$ is the derivative along the outward normal.\n- **Numerical Method**: Polynomial expansion nodal method (PENM) of degree at most two for the scalar flux $\\phi(x)$ within each node.\n- **Unknowns**: The vector of interface fluxes $\\boldsymbol{\\varphi} = \\begin{pmatrix} \\phi_0 & \\phi_1 & \\phi_2 \\end{pmatrix}^{\\mathsf{T}}$, where $\\phi_0=\\phi(0)$, $\\phi_1=\\phi(h)$, and $\\phi_2=\\phi(2h)$.\n- **System Form**: A sparse linear system for $\\boldsymbol{\\varphi}$ of the form $A\\,\\boldsymbol{\\varphi}=\\boldsymbol{b}$, derived by eliminating intra-nodal coefficients.\n- **Supporting Definitions**: Fick's law, $J=-D\\,d\\phi/dx$; continuity of net current $J$ at the internal interface $x=h$.\n- **Task 1**: Construct the system $A\\,\\boldsymbol{\\varphi}=\\boldsymbol{b}$.\n- **Task 2**: Analyze the structure of $A$ to justify a Krylov subspace method and a preconditioner.\n- **Task 3**: Specialize to $D=1$ and $h=1$. Form the Jacobi preconditioner $P=\\mathrm{diag}(A)$ and the symmetrically preconditioned operator $M=P^{-1/2} A P^{-1/2}$. Compute the exact condition number $\\kappa(M)$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the neutron diffusion equation, Fick's law, and Marshak boundary conditions, which are cornerstone principles in nuclear reactor physics. The specified numerical method (PENM) is a standard and well-established technique for solving the diffusion equation. The setup is scientifically and mathematically sound.\n- **Well-Posed**: The problem sets up a second-order linear ordinary differential equation with Robin-type boundary conditions. Such a boundary value problem is well-posed, admitting a unique solution. The numerical discretization scheme is clearly defined and leads to a solvable linear system.\n- **Objective**: The problem is stated using precise, unambiguous technical language. It is free of subjective or opinion-based content.\n- **Completeness and Consistency**: The problem provides all necessary information to construct the linear system. While the source terms $q_1$ and $q_2$ are symbolic, this is appropriate for deriving the system matrix $A$ and the general form of the source vector $\\boldsymbol{b}$. There are no internal contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Part 1: Construction of the Linear System\nWe analyze the flux and current within each node to establish relationships between the boundary fluxes ($\\phi_0, \\phi_1, \\phi_2$) and the boundary currents.\n\nFor a generic node $k$ of width $h_k$ with constant source $q_k$, the diffusion equation is $-D \\frac{d^2\\phi_k}{dx^2} = q_k$. Integrating twice gives the general quadratic flux shape:\n$\\phi_k(x) = -\\frac{q_k}{2D}x^2 + c_1 x + c_2$.\n\nIt is convenient to work in a canonical local coordinate system $\\xi \\in [-1, 1]$ for each node.\nFor Node $1$ on $[0, h]$, the coordinate transformation is $x = \\frac{h}{2}(1+\\xi)$, and $\\frac{d}{dx} = \\frac{2}{h}\\frac{d}{d\\xi}$. The diffusion equation becomes $-D (\\frac{2}{h})^2 \\frac{d^2\\phi_1}{d\\xi^2} = q_1$, which integrates to:\n$\\phi_1(\\xi) = -\\frac{q_1 h^2}{8D}\\xi^2 + C_1\\xi + C_2$.\nThe flux values at the node boundaries $\\xi=-1$ ($x=0$) and $\\xi=1$ ($x=h$) are $\\phi_0$ and $\\phi_1$, respectively.\n$\\phi_1(-1) = \\phi_0 = -\\frac{q_1 h^2}{8D} - C_1 + C_2$\n$\\phi_1(1) = \\phi_1 = -\\frac{q_1 h^2}{8D} + C_1 + C_2$\nSolving for $C_1$ and $C_2$ yields $C_1 = \\frac{\\phi_1-\\phi_0}{2}$ and $C_2 = \\frac{\\phi_1+\\phi_0}{2} + \\frac{q_1 h^2}{8D}$.\nSubstituting back gives the flux in terms of the boundary values:\n$\\phi_1(\\xi) = \\frac{q_1h^2}{8D}(1-\\xi^2) + \\frac{1+\\xi}{2}\\phi_1 + \\frac{1-\\xi}{2}\\phi_0$.\n\nThe net current is given by Fick's Law, $J = -D \\frac{d\\phi}{dx}$:\n$J_1(\\xi) = -D \\frac{2}{h} \\frac{d\\phi_1}{d\\xi} = -D\\frac{2}{h}\\left(-\\frac{q_1 h^2}{4D}\\xi + \\frac{\\phi_1 - \\phi_0}{2}\\right) = \\frac{q_1 h}{2}\\xi - \\frac{D}{h}(\\phi_1 - \\phi_0)$.\nThe currents at the boundaries of Node $1$ are:\n$J_0 = J_1(\\xi=-1) = -\\frac{q_1 h}{2} - \\frac{D}{h}(\\phi_1 - \\phi_0)$ (at $x=0$)\n$J_{1,R} = J_1(\\xi=1) = \\frac{q_1 h}{2} - \\frac{D}{h}(\\phi_1 - \\phi_0)$ (at $x=h$, leaving Node $1$)\n\nFor Node $2$ on $[h, 2h]$, a similar analysis replacing $(\\phi_0, \\phi_1, q_1)$ with $(\\phi_1, \\phi_2, q_2)$ yields the current leaving Node $2$ at $x=h$. Let's call it $J_{2,L}$ (current on the Left face of node 2). Its expression is analogous to $J_0$ for node $1$:\n$J_{2,L} = -\\frac{q_2 h}{2} - \\frac{D}{h}(\\phi_2 - \\phi_1)$ (at $x=h$, entering Node $2$)\nAnd the current at $x=2h$ is:\n$J_2 = \\frac{q_2 h}{2} - \\frac{D}{h}(\\phi_2 - \\phi_1)$ (at $x=2h$)\n\nWe now assemble a $3 \\times 3$ system using the boundary conditions and interface continuity.\n\n1.  **Boundary Condition at $x=0$**: The outward normal is in the $-x$ direction. The Marshak BC $\\phi + 2 D \\,\\partial \\phi/\\partial n = 0$ becomes $\\phi(0) + 2D(-\\frac{d\\phi}{dx}|_0) = 0$. Since $J = -D \\frac{d\\phi}{dx}$, this is $\\phi_0 + 2J_0 = 0$.\n    $\\phi_0 + 2\\left(-\\frac{q_1 h}{2} - \\frac{D}{h}(\\phi_1 - \\phi_0)\\right) = 0$\n    $\\phi_0 - q_1 h - \\frac{2D}{h}\\phi_1 + \\frac{2D}{h}\\phi_0 = 0$\n    $\\left(1 + \\frac{2D}{h}\\right)\\phi_0 - \\frac{2D}{h}\\phi_1 = q_1 h$\n\n2.  **Interface Continuity at $x=h$**: Continuity of net current requires $J_{1,R} = J_{2,L}$.\n    $\\frac{q_1 h}{2} - \\frac{D}{h}(\\phi_1 - \\phi_0) = -\\frac{q_2 h}{2} - \\frac{D}{h}(\\phi_2 - \\phi_1)$\n    $\\frac{D}{h}\\phi_0 - \\frac{D}{h}\\phi_1 = -\\frac{h}{2}(q_1+q_2) - \\frac{D}{h}\\phi_2 + \\frac{D}{h}\\phi_1$\n    $\\frac{D}{h}\\phi_0 - \\frac{2D}{h}\\phi_1 + \\frac{D}{h}\\phi_2 = -\\frac{h}{2}(q_1+q_2)$\n\n3.  **Boundary Condition at $x=2h$**: The outward normal is in the $+x$ direction. The Marshak BC is $\\phi(2h) + 2D(\\frac{d\\phi}{dx}|_{2h}) = 0$, which is $\\phi_2 - 2J_2 = 0$.\n    $\\phi_2 - 2\\left(\\frac{q_2 h}{2} - \\frac{D}{h}(\\phi_2 - \\phi_1)\\right) = 0$\n    $\\phi_2 - q_2 h + \\frac{2D}{h}\\phi_2 - \\frac{2D}{h}\\phi_1 = 0$\n    $-\\frac{2D}{h}\\phi_1 + \\left(1 + \\frac{2D}{h}\\right)\\phi_2 = q_2 h$\n\nThe linear system $A\\boldsymbol{\\varphi} = \\boldsymbol{b}$ is therefore:\n$$\nA = \\begin{pmatrix}\n1 + \\frac{2D}{h} & -\\frac{2D}{h} & 0 \\\\\n\\frac{D}{h} & -\\frac{2D}{h} & \\frac{D}{h} \\\\\n0 & -\\frac{2D}{h} & 1 + \\frac{2D}{h}\n\\end{pmatrix}, \\quad\n\\boldsymbol{b} = \\begin{pmatrix}\nq_1 h \\\\\n-\\frac{h}{2}(q_1+q_2) \\\\\nq_2 h\n\\end{pmatrix}\n$$\n\n### Part 2: Analysis of the System\nFor a general problem with many nodes, this method generates a large, sparse linear system. The matrix $A$ for this $1$D problem is **tridiagonal**. In higher dimensions ($2$D or $3$D), it would have a block-tridiagonal or more complex sparse structure reflecting nearest-neighbor coupling.\nA key property of $A$ is that it is **non-symmetric** (e.g., $A_{12} \\neq A_{21}$). This is a critical factor in choosing a numerical solver.\nFor large-scale systems, iterative methods are preferred over direct solvers. Because $A$ is non-symmetric, the standard Conjugate Gradient (CG) method is not applicable. Suitable **Krylov subspace methods** include the **Generalized Minimal Residual method (GMRES)** or the **Biconjugate Gradient Stabilized method (BiCGSTAB)**.\nThe convergence rate of these methods relies heavily on the conditioning of the matrix. A **preconditioner** is almost always necessary for practical performance. A natural and robust choice for systems arising from discretized PDEs is an **Incomplete LU (ILU) factorization**. ILU preconditioners, particularly ILU($k$) with a small level of fill-in $k$, provide a good balance between effectiveness and computational cost. Simpler alternatives include the **Jacobi** or **Gauss-Seidel** preconditioners, which are less powerful but easier to implement.\n\n### Part 3: Specialization and Condition Number Calculation\nWe specialize the system with $D=1$ and $h=1$. The matrix $A$ becomes:\n$$ A = \\begin{pmatrix}\n1 + 2 & -2 & 0 \\\\\n1 & -2 & 1 \\\\\n0 & -2 & 1 + 2\n\\end{pmatrix} = \\begin{pmatrix}\n3 & -2 & 0 \\\\\n1 & -2 & 1 \\\\\n0 & -2 & 3\n\\end{pmatrix} $$\nThe Jacobi preconditioner is $P=\\mathrm{diag}(A)$:\n$$ P = \\begin{pmatrix}\n3 & 0 & 0 \\\\\n0 & -2 & 0 \\\\\n0 & 0 & 3\n\\end{pmatrix} $$\nNote that $P$ is not positive definite due to the entry $P_{22}=-2$. The operator $P^{-1/2}$ will involve complex numbers.\n$$ P^{-1/2} = \\begin{pmatrix}\n\\frac{1}{\\sqrt{3}} & 0 & 0 \\\\\n0 & \\frac{1}{\\sqrt{-2}} & 0 \\\\\n0 & 0 & \\frac{1}{\\sqrt{3}}\n\\end{pmatrix} = \\begin{pmatrix}\n\\frac{1}{\\sqrt{3}} & 0 & 0 \\\\\n0 & -\\frac{i}{\\sqrt{2}} & 0 \\\\\n0 & 0 & \\frac{1}{\\sqrt{3}}\n\\end{pmatrix} $$\nNow we form the symmetrically preconditioned operator $M=P^{-1/2} A P^{-1/2}$:\n$$ M = \\begin{pmatrix} \\frac{1}{\\sqrt{3}} & 0 & 0 \\\\ 0 & -\\frac{i}{\\sqrt{2}} & 0 \\\\ 0 & 0 & \\frac{1}{\\sqrt{3}} \\end{pmatrix}\n\\begin{pmatrix} 3 & -2 & 0 \\\\ 1 & -2 & 1 \\\\ 0 & -2 & 3 \\end{pmatrix}\n\\begin{pmatrix} \\frac{1}{\\sqrt{3}} & 0 & 0 \\\\ 0 & -\\frac{i}{\\sqrt{2}} & 0 \\\\ 0 & 0 & \\frac{1}{\\sqrt{3}} \\end{pmatrix} $$\nPerforming the matrix multiplication gives:\n$$ M = \\begin{pmatrix}\n1 & \\frac{2i}{\\sqrt{6}} & 0 \\\\\n-\\frac{i}{\\sqrt{6}} & 1 & -\\frac{i}{\\sqrt{6}} \\\\\n0 & \\frac{2i}{\\sqrt{6}} & 1\n\\end{pmatrix} $$\nAlthough $M$ is not Hermitian, it is a tridiagonal matrix where the product of off-diagonal pairs $M_{k,k+1}M_{k+1,k}$ is positive and real: $M_{12}M_{21} = (\\frac{2i}{\\sqrt{6}})(-\\frac{i}{\\sqrt{6}}) = \\frac{2}{6} = \\frac{1}{3} > 0$ and $M_{23}M_{32} = (-\\frac{i}{\\sqrt{6}})(\\frac{2i}{\\sqrt{6}}) = \\frac{2}{6} = \\frac{1}{3} > 0$. Such a matrix is similar to a real symmetric matrix, and thus its eigenvalues are all real.\nTo find the eigenvalues $\\lambda$, we solve the characteristic equation $\\det(M - \\lambda I)=0$. Let $\\mu = 1-\\lambda$:\n$$ \\det \\begin{pmatrix}\n\\mu & \\frac{2i}{\\sqrt{6}} & 0 \\\\\n-\\frac{i}{\\sqrt{6}} & \\mu & -\\frac{i}{\\sqrt{6}} \\\\\n0 & \\frac{2i}{\\sqrt{6}} & \\mu\n\\end{pmatrix} = 0 $$\nThe determinant is $\\mu\\left(\\mu^2 - (-\\frac{i}{\\sqrt{6}})(\\frac{2i}{\\sqrt{6}})\\right) - \\frac{2i}{\\sqrt{6}}\\left((-\\frac{i}{\\sqrt{6}})\\mu\\right) = 0$.\n$\\mu(\\mu^2 - \\frac{2}{6}) - (\\frac{2}{6})\\mu = 0$\n$\\mu(\\mu^2 - \\frac{1}{3} - \\frac{1}{3}) = 0 \\implies \\mu(\\mu^2 - \\frac{2}{3}) = 0$.\nThe solutions for $\\mu$ are $\\mu=0$ and $\\mu = \\pm\\sqrt{\\frac{2}{3}}$.\nSince $\\lambda = 1 - \\mu$, the eigenvalues of $M$ are:\n$\\lambda_1 = 1 - \\sqrt{\\frac{2}{3}}$\n$\\lambda_2 = 1 - 0 = 1$\n$\\lambda_3 = 1 + \\sqrt{\\frac{2}{3}}$\nAll eigenvalues are positive. The largest and smallest eigenvalues by magnitude are:\n$\\lambda_{\\max} = 1 + \\sqrt{\\frac{2}{3}}$\n$\\lambda_{\\min} = 1 - \\sqrt{\\frac{2}{3}}$\nThe condition number $\\kappa(M)$ is the ratio $|\\lambda_{\\max}| / |\\lambda_{\\min}|$:\n$$ \\kappa(M) = \\frac{1 + \\sqrt{\\frac{2}{3}}}{1 - \\sqrt{\\frac{2}{3}}} $$\nTo simplify, we rationalize the denominator:\n$$ \\kappa(M) = \\frac{1 + \\frac{\\sqrt{2}}{\\sqrt{3}}}{1 - \\frac{\\sqrt{2}}{\\sqrt{3}}} = \\frac{\\sqrt{3}+\\sqrt{2}}{\\sqrt{3}-\\sqrt{2}} = \\frac{(\\sqrt{3}+\\sqrt{2})(\\sqrt{3}+\\sqrt{2})}{(\\sqrt{3}-\\sqrt{2})(\\sqrt{3}+\\sqrt{2})} = \\frac{(\\sqrt{3})^2 + 2\\sqrt{3}\\sqrt{2} + (\\sqrt{2})^2}{(\\sqrt{3})^2 - (\\sqrt{2})^2} $$\n$$ \\kappa(M) = \\frac{3 + 2\\sqrt{6} + 2}{3 - 2} = 5 + 2\\sqrt{6} $$\nThis is the final exact analytical expression for the condition number.",
            "answer": "$$\\boxed{5 + 2\\sqrt{6}}$$"
        },
        {
            "introduction": "After implementing a numerical method, a critical step is to verify its correctness. This practice introduces the 'method of manufactured solutions,' a standard technique for creating benchmark problems with known exact answers, which are indispensable for debugging and validating simulation codes . You will derive the exact analytical flux profile for a diffusion problem with a specially designed sinusoidal source, providing a gold standard against which the accuracy of a PENM implementation can be precisely measured.",
            "id": "4241268",
            "problem": "Consider a one-dimensional, steady-state slab reactor benchmark designed for verification of Polynomial Expansion Nodal Methods (PENM). Let the slab occupy the interval $x \\in [0,L]$ and be homogeneous with constant diffusion coefficient $D$ and macroscopic absorption cross section $\\Sigma_{a}$. The driving term is a manufactured sinusoidal volumetric source $S(x) = S_{0} \\sin(\\kappa x)$ with $\\kappa = \\frac{n \\pi}{L}$ for a positive integer $n$. Impose vacuum boundary conditions at both ends, $ \\phi(0) = 0 $ and $ \\phi(L) = 0 $, where $ \\phi(x) $ is the scalar neutron flux.\n\nStarting from the steady one-group neutron diffusion equation in one dimension,\n$ -\\frac{d}{dx} \\left( D \\frac{d \\phi}{dx} \\right) + \\Sigma_{a} \\phi = S(x) $,\nderive the exact closed-form solution $ \\phi(x) $ for the case defined above. Then, partition the domain into $M$ equal nodes of width $h = \\frac{L}{M}$, and derive the exact analytic expression for the nodal average flux in node $j$, defined by\n$ \\bar{\\phi}_{j} = \\frac{1}{h} \\int_{(j-1)h}^{jh} \\phi(x) \\, dx $.\nFinally, evaluate $ \\bar{\\phi}_{3} $ numerically for the parameters $ L = 60 \\, \\mathrm{cm} $, $ M = 5 $, $ n = 3 $, $ D = 1.00 \\, \\mathrm{cm} $, $ \\Sigma_{a} = 0.10 \\, \\mathrm{cm}^{-1} $, and $ S_{0} = 1.00 \\times 10^{6} \\, \\mathrm{n} \\, \\mathrm{cm}^{-3} \\, \\mathrm{s}^{-1} $. Express the final value of $ \\bar{\\phi}_{3} $ in $ \\mathrm{cm}^{-2} \\, \\mathrm{s}^{-1} $ and round your answer to four significant figures.",
            "solution": "The problem statement is critically validated and found to be valid. It is a well-posed problem grounded in the established principles of nuclear reactor physics, specifically one-group neutron diffusion theory. The use of a manufactured sinusoidal source, which can take on negative values, is a standard and acceptable practice for creating benchmark problems designed to verify numerical methods. Although a negative source and the resulting negative flux are not physically realized in a fission-driven reactor, they are mathematically sound within the framework of the diffusion equation, where a negative source represents a spatially dependent sink term. The problem is self-contained, objective, and all provided parameters are consistent.\n\nThe one-dimensional, steady-state, one-group neutron diffusion equation for a homogeneous medium is given by:\n$$-\\frac{d}{dx} \\left( D \\frac{d \\phi}{dx} \\right) + \\Sigma_{a} \\phi(x) = S(x)$$\nGiven that the diffusion coefficient $D$ and the macroscopic absorption cross section $\\Sigma_{a}$ are constant, the equation simplifies to:\n$$-D \\frac{d^2 \\phi}{dx^2} + \\Sigma_{a} \\phi(x) = S(x)$$\nThe source term is specified as $S(x) = S_{0} \\sin(\\kappa x)$, with $\\kappa = \\frac{n \\pi}{L}$. The domain is $x \\in [0,L]$, and vacuum boundary conditions are imposed as $\\phi(0) = 0$ and $\\phi(L) = 0$.\n\nFirst, we derive the exact closed-form solution $\\phi(x)$.\nThe problem is set up such that the source term, $\\sin(\\kappa x)$, is an eigenfunction of the diffusion operator $-\\frac{d^2}{dx^2}$ on the domain $[0,L]$ with zero boundary conditions. This suggests seeking a solution of the form $\\phi(x) = A \\sin(\\kappa x)$, where $A$ is a constant to be determined.\nLet's verify the boundary conditions with this assumed form:\nAt $x=0$: $\\phi(0) = A \\sin(\\kappa \\cdot 0) = A \\sin(0) = 0$. This condition is satisfied.\nAt $x=L$: $\\phi(L) = A \\sin(\\kappa L)$. Since $\\kappa = \\frac{n \\pi}{L}$, we have $\\phi(L) = A \\sin\\left(\\frac{n \\pi}{L} \\cdot L\\right) = A \\sin(n \\pi) = 0$ for any integer $n$. This condition is also satisfied.\n\nNow, we substitute the proposed solution into the diffusion equation. The derivatives of $\\phi(x)$ are:\n$$\\frac{d \\phi}{dx} = A \\kappa \\cos(\\kappa x)$$\n$$\\frac{d^2 \\phi}{dx^2} = -A \\kappa^2 \\sin(\\kappa x)$$\nSubstituting into the diffusion equation:\n$$-D (-A \\kappa^2 \\sin(\\kappa x)) + \\Sigma_{a} (A \\sin(\\kappa x)) = S_{0} \\sin(\\kappa x)$$\n$$A (D \\kappa^2 + \\Sigma_{a}) \\sin(\\kappa x) = S_{0} \\sin(\\kappa x)$$\nFor this equality to hold for all $x \\in [0,L]$, the coefficients must be equal:\n$$A (D \\kappa^2 + \\Sigma_{a}) = S_{0}$$\nSolving for the constant $A$:\n$$A = \\frac{S_{0}}{D \\kappa^2 + \\Sigma_{a}}$$\nThus, the exact analytical solution for the neutron flux is:\n$$\\phi(x) = \\frac{S_{0}}{D \\kappa^2 + \\Sigma_{a}} \\sin(\\kappa x)$$\n\nNext, we derive the expression for the nodal average flux, $\\bar{\\phi}_{j}$, for node $j$. The domain $[0,L]$ is partitioned into $M$ equal nodes, each of width $h = \\frac{L}{M}$. Node $j$ spans the interval $[(j-1)h, jh]$. The average flux is defined as:\n$$\\bar{\\phi}_{j} = \\frac{1}{h} \\int_{(j-1)h}^{jh} \\phi(x) \\, dx$$\nSubstituting the expression for $\\phi(x)$:\n$$\\bar{\\phi}_{j} = \\frac{1}{h} \\int_{(j-1)h}^{jh} \\frac{S_{0}}{D \\kappa^2 + \\Sigma_{a}} \\sin(\\kappa x) \\, dx$$\nThe constant term can be moved outside the integral:\n$$\\bar{\\phi}_{j} = \\frac{S_{0}}{h (D \\kappa^2 + \\Sigma_{a})} \\int_{(j-1)h}^{jh} \\sin(\\kappa x) \\, dx$$\nThe integral of $\\sin(\\kappa x)$ is $-\\frac{1}{\\kappa}\\cos(\\kappa x)$. Evaluating the definite integral:\n$$\\int_{(j-1)h}^{jh} \\sin(\\kappa x) \\, dx = \\left[ -\\frac{1}{\\kappa} \\cos(\\kappa x) \\right]_{(j-1)h}^{jh} = -\\frac{1}{\\kappa} (\\cos(\\kappa jh) - \\cos(\\kappa (j-1)h))$$\n$$= \\frac{1}{\\kappa} (\\cos(\\kappa(j-1)h) - \\cos(\\kappa jh))$$\nSubstituting this result back into the expression for $\\bar{\\phi}_{j}$:\n$$\\bar{\\phi}_{j} = \\frac{S_{0}}{h \\kappa (D \\kappa^2 + \\Sigma_{a})} (\\cos(\\kappa(j-1)h) - \\cos(\\kappa jh))$$\nThis is the exact analytic expression for the nodal average flux in node $j$.\n\nFinally, we evaluate $\\bar{\\phi}_{3}$ for the given parameters:\n$L = 60 \\, \\mathrm{cm}$\n$M = 5$\n$n = 3$\n$D = 1.00 \\, \\mathrm{cm}$\n$\\Sigma_{a} = 0.10 \\, \\mathrm{cm}^{-1}$\n$S_{0} = 1.00 \\times 10^{6} \\, \\mathrm{n} \\, \\mathrm{cm}^{-3} \\, \\mathrm{s}^{-1}$\nThe target node is $j=3$.\n\nFirst, we calculate the derived parameters $h$ and $\\kappa$:\nNode width: $h = \\frac{L}{M} = \\frac{60}{5} = 12 \\, \\mathrm{cm}$\nWave number: $\\kappa = \\frac{n \\pi}{L} = \\frac{3 \\pi}{60} = \\frac{\\pi}{20} \\, \\mathrm{cm}^{-1}$\n\nNow, we evaluate the expression for $\\bar{\\phi}_{3}$:\n$$\\bar{\\phi}_{3} = \\frac{S_{0}}{h \\kappa (D \\kappa^2 + \\Sigma_{a})} (\\cos(\\kappa(2h)) - \\cos(\\kappa(3h)))$$\nThe arguments for the cosine functions are:\n$\\kappa (2h) = \\frac{\\pi}{20} \\cdot (2 \\cdot 12) = \\frac{24\\pi}{20} = \\frac{6\\pi}{5}$\n$\\kappa (3h) = \\frac{\\pi}{20} \\cdot (3 \\cdot 12) = \\frac{36\\pi}{20} = \\frac{9\\pi}{5}$\nThe cosine terms are:\n$\\cos\\left(\\frac{6\\pi}{5}\\right) = \\cos\\left(\\pi + \\frac{\\pi}{5}\\right) = -\\cos\\left(\\frac{\\pi}{5}\\right)$\n$\\cos\\left(\\frac{9\\pi}{5}\\right) = \\cos\\left(2\\pi - \\frac{\\pi}{5}\\right) = \\cos\\left(\\frac{\\pi}{5}\\right)$\nThe difference is:\n$\\cos\\left(\\frac{6\\pi}{5}\\right) - \\cos\\left(\\frac{9\\pi}{5}\\right) = -\\cos\\left(\\frac{\\pi}{5}\\right) - \\cos\\left(\\frac{\\pi}{5}\\right) = -2\\cos\\left(\\frac{\\pi}{5}\\right)$\nThe exact value of $\\cos(\\frac{\\pi}{5})$ is $\\frac{1+\\sqrt{5}}{4}$. So, the difference is $-2\\left(\\frac{1+\\sqrt{5}}{4}\\right) = -\\frac{1+\\sqrt{5}}{2}$.\n\nNow, let's assemble the full expression for $\\bar{\\phi}_{3}$ with numerical values:\nThe denominator term $(D \\kappa^2 + \\Sigma_{a})$ is:\n$D \\kappa^2 + \\Sigma_{a} = (1.00) \\left(\\frac{\\pi}{20}\\right)^2 + 0.10 = \\frac{\\pi^2}{400} + 0.10 \\, \\mathrm{cm}^{-1}$\nThe denominator $h \\kappa (D \\kappa^2 + \\Sigma_{a})$ is:\n$12 \\cdot \\frac{\\pi}{20} \\left(\\frac{\\pi^2}{400} + 0.10\\right) = \\frac{3\\pi}{5} \\left(\\frac{\\pi^2+40}{400}\\right) = \\frac{3\\pi(\\pi^2+40)}{2000}$\nThe numerator $S_0 (\\cos(\\kappa(2h)) - \\cos(\\kappa(3h)))$ is:\n$(1.00 \\times 10^6) \\left(-\\frac{1+\\sqrt{5}}{2}\\right)$\nSo, we have:\n$$\\bar{\\phi}_{3} = \\frac{(1.00 \\times 10^6) \\left(-\\frac{1+\\sqrt{5}}{2}\\right)}{\\frac{3\\pi(\\pi^2+40)}{2000}} = \\frac{-1000 \\cdot (1.00 \\times 10^6) (1+\\sqrt{5})}{3\\pi(\\pi^2+40)}$$\n$$\\bar{\\phi}_{3} = \\frac{-10^9 (1+\\sqrt{5})}{3\\pi(\\pi^2+40)}$$\nNow, we compute the numerical value:\n$1+\\sqrt{5} \\approx 3.236068$\n$\\pi^2+40 \\approx 9.869604 + 40 = 49.869604$\n$3\\pi \\approx 9.424778$\n$$\\bar{\\phi}_{3} \\approx \\frac{-10^9 \\times 3.236068}{9.424778 \\times 49.869604} \\approx \\frac{-3.236068 \\times 10^9}{470.0035} \\approx -6.88522 \\times 10^6$$\nThe units are $\\mathrm{cm}^{-2} \\, \\mathrm{s}^{-1}$.\nRounding the result to four significant figures gives $-6.885 \\times 10^6$. The negative value is the correct mathematical result, as the source term $S(x)$ is negative over the interval corresponding to node $3$, i.e., $x \\in [24, 36]$.",
            "answer": "$$\\boxed{-6.885 \\times 10^{6}}$$"
        }
    ]
}