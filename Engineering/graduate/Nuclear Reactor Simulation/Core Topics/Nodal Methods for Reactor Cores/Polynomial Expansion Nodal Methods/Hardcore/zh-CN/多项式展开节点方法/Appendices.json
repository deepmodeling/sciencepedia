{
    "hands_on_practices": [
        {
            "introduction": "多项式展开节块法（PENM）的核心在于如何在单个计算单元（即“节块”）内精确地表示物理过程。本练习将引导您体验这一核心过程：使用强大的伽辽金法和勒让德多项式，将连续的中子扩散方程转化为一个离散的代数方程组。掌握这一过程是理解这些高级数值方法内部工作原理的基础。",
            "id": "4241293",
            "problem": "在一个均匀一维节点中，考虑一个单群稳态中子扩散模型。该节点的物理宽度为 $h$，具有常数扩散系数 $D$ 和常数宏观移出截面 $\\Sigma_{r}$。考虑多项式展开节点法（Polynomial Expansion Nodal Method, PENM），这是一种 Galerkin 节点法，它将标量中子通量 $\\phi(x)$ 在多项式基中进行局域展开。通过仿射映射 $x(\\xi) = \\frac{h}{2}\\,\\xi + x_{c}$ 将节点 $x \\in [x_{L}, x_{R}]$ 映射到参考坐标 $\\xi \\in [-1,1]$，其中 $x_{c}$ 是节点中心。使用 $[-1,1]$ 上的前三个 Legendre 多项式作为局域基函数：\n$$\n\\varphi_{0}(\\xi) = P_{0}(\\xi) = 1,\\quad \\varphi_{1}(\\xi) = P_{1}(\\xi) = \\xi,\\quad \\varphi_{2}(\\xi) = P_{2}(\\xi) = \\frac{3\\xi^{2}-1}{2}.\n$$\n假设在节点表面处为齐次 Neumann 边界条件（净流为零），因此在对称弱形式中边界项消失。使用标准的 Galerkin 程序，以相同的多项式作为检验函数，模态振幅 $\\mathbf{a} = [a_{0}, a_{1}, a_{2}]^{\\mathsf{T}}$ 的局域系数矩阵 $\\mathbf{A}$ 的元素为\n$$\nA_{ij} \\equiv \\int_{x_{L}}^{x_{R}} D\\,\\frac{d\\varphi_{i}}{dx}\\,\\frac{d\\varphi_{j}}{dx}\\,dx \\;+\\; \\int_{x_{L}}^{x_{R}} \\Sigma_{r}\\,\\varphi_{i}\\,\\varphi_{j}\\,dx,\\quad i,j\\in\\{0,1,2\\}.\n$$\n通过将这些积分映射到参考域并精确计算多项式内积，推导用 $D$、$\\Sigma_{r}$ 和 $h$ 表示的 $A_{ij}$ 的表达式。然后，组装得到的 $3\\times 3$ 矩阵 $\\mathbf{A}$。\n\n最后，以闭合形式计算行列式 $\\det(\\mathbf{A})$，仅用 $D$、$\\Sigma_{r}$ 和 $h$ 表示。请以单个闭合形式解析表达式提供您的最终答案。不需要数值近似，最终答案中也不应包含任何单位。",
            "solution": "该问题要求推导一维单群中子扩散方程的多项式展开节点法（PENM）公式的系数矩阵 $\\mathbf{A}$，并随后计算其行列式。在求解之前，先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **模型**：单群、稳态、均匀中子扩散。\n- **节点几何**：一维，物理宽度 $h$。\n- **物理常数**：扩散系数 $D$ (常数)，宏观移出截面 $\\Sigma_r$ (常数)。\n- **方法**：Galerkin 节点法 (PENM)。\n- **坐标映射**：对于 $x \\in [x_L, x_R]$ 和 $\\xi \\in [-1, 1]$，有 $x(\\xi) = \\frac{h}{2}\\xi + x_{c}$。\n- **基函数和检验函数**：$\\varphi_{0}(\\xi) = P_{0}(\\xi) = 1$，$\\varphi_{1}(\\xi) = P_{1}(\\xi) = \\xi$，$\\varphi_{2}(\\xi) = P_{2}(\\xi) = \\frac{3\\xi^{2}-1}{2}$。\n- **边界条件**：节点表面的齐次 Neumann 条件（净流为零），导致边界项消失。\n- **矩阵元定义**：$A_{ij} \\equiv \\int_{x_{L}}^{x_{R}} D\\,\\frac{d\\varphi_{i}}{dx}\\,\\frac{d\\varphi_{j}}{dx}\\,dx \\;+\\; \\int_{x_{L}}^{x_{R}} \\Sigma_{r}\\,\\varphi_{i}\\,\\varphi_{j}\\,dx$，对于 $i,j\\in\\{0,1,2\\}$。\n- **目标**：推导 $3\\times3$ 矩阵 $\\mathbf{A}$ 并计算其行列式 $\\det(\\mathbf{A})$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于标准的中子扩散方程和 Galerkin 有限元方法，这些是核工程和计算物理中的基本概念。使用 Legendre 多项式作为基函数是 PENM 的标准选择。\n- **适定性**：问题陈述清晰，提供了所有必要的定义、常数和函数，以唯一确定矩阵 $\\mathbf{A}$ 及其行列式。\n- **客观性**：问题使用精确的数学和物理术语表述，没有主观或模糊的语言。\n- **完整性和一致性**：问题是自洽的。$A_{ij}$ 的定义与扩散算符 $-D\\frac{d^2}{dx^2} + \\Sigma_r$ 的弱形式一致，边界项消失的假设与指定的 Neumann 条件一致。\n\n### 步骤 3：结论与行动\n该问题是有效的。它在科学上是合理的、适定的和完整的。可以构建一个严谨的解。\n\n### 解题推导\n矩阵元 $A_{ij}$ 由物理域 $x \\in [x_L, x_R]$ 上的积分定义。为了计算这些积分，我们将其转换到参考域 $\\xi \\in [-1, 1]$ 上。\n\n首先，我们建立微分 $dx$ 和 $d\\xi$ 以及导数 $\\frac{d}{dx}$ 和 $\\frac{d}{d\\xi}$ 之间的关系。\n从映射 $x(\\xi) = \\frac{h}{2}\\xi + x_c$，我们找到变换的雅可比因子：\n$$\n\\frac{dx}{d\\xi} = \\frac{h}{2} \\implies dx = \\frac{h}{2} d\\xi\n$$\n使用链式法则求导：\n$$\n\\frac{d}{d\\xi} = \\frac{dx}{d\\xi}\\frac{d}{dx} = \\frac{h}{2}\\frac{d}{dx} \\implies \\frac{d}{dx} = \\frac{2}{h}\\frac{d}{d\\xi}\n$$\n我们将这些代入 $A_{ij}$ 的定义中：\n$$\nA_{ij} = \\int_{-1}^{1} D\\left(\\frac{2}{h}\\frac{d\\varphi_{i}}{d\\xi}\\right)\\left(\\frac{2}{h}\\frac{d\\varphi_{j}}{d\\xi}\\right)\\left(\\frac{h}{2}d\\xi\\right) + \\int_{-1}^{1} \\Sigma_{r}\\,\\varphi_{i}(\\xi)\\,\\varphi_{j}(\\xi)\\left(\\frac{h}{2}d\\xi\\right)\n$$\n将积分外的常数化简得到：\n$$\nA_{ij} = \\frac{2D}{h} \\int_{-1}^{1} \\frac{d\\varphi_{i}}{d\\xi}\\frac{d\\varphi_{j}}{d\\xi}\\,d\\xi + \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} \\varphi_{i}(\\xi)\\varphi_{j}(\\xi)\\,d\\xi\n$$\n这个表达式可以看作是“刚度”矩阵分量 $\\mathbf{K}$ 和“质量”矩阵分量 $\\mathbf{M}$ 的和，其中 $A_{ij} = K_{ij} + M_{ij}$。\n\n让我们计算每个分量的积分。我们需要基函数关于 $\\xi$ 的导数：\n$$\n\\frac{d\\varphi_{0}}{d\\xi} = \\frac{d}{d\\xi}(1) = 0\n$$\n$$\n\\frac{d\\varphi_{1}}{d\\xi} = \\frac{d}{d\\xi}(\\xi) = 1\n$$\n$$\n\\frac{d\\varphi_{2}}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{3\\xi^2 - 1}{2}\\right) = 3\\xi\n$$\n\n**1. 刚度矩阵 $\\mathbf{K}$ 的计算**\n$$\nK_{ij} = \\frac{2D}{h} \\int_{-1}^{1} \\frac{d\\varphi_{i}}{d\\xi}\\frac{d\\varphi_{j}}{d\\xi}\\,d\\xi\n$$\n- 由于 $\\frac{d\\varphi_0}{d\\xi} = 0$，第一行和第一列的所有元素都为零：$K_{00} = K_{01} = K_{10} = K_{02} = K_{20} = 0$。\n- 对于 $K_{11}$：\n$$\nK_{11} = \\frac{2D}{h} \\int_{-1}^{1} (1)(1)\\,d\\xi = \\frac{2D}{h} [\\xi]_{-1}^{1} = \\frac{2D}{h}(2) = \\frac{4D}{h}\n$$\n- 对于 $K_{22}$：\n$$\nK_{22} = \\frac{2D}{h} \\int_{-1}^{1} (3\\xi)(3\\xi)\\,d\\xi = \\frac{18D}{h} \\int_{-1}^{1} \\xi^2\\,d\\xi = \\frac{18D}{h} \\left[\\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\frac{18D}{h}\\left(\\frac{2}{3}\\right) = \\frac{12D}{h}\n$$\n- 对于非对角项 $K_{12}$ 和 $K_{21}$：\n$$\nK_{12} = K_{21} = \\frac{2D}{h} \\int_{-1}^{1} (1)(3\\xi)\\,d\\xi = \\frac{6D}{h} \\int_{-1}^{1} \\xi\\,d\\xi = \\frac{6D}{h} \\left[\\frac{\\xi^2}{2}\\right]_{-1}^{1} = 0\n$$\n因此，刚度矩阵 $\\mathbf{K}$ 是对角矩阵：\n$$\n\\mathbf{K} = \\begin{pmatrix} 0  0  0 \\\\ 0  \\frac{4D}{h}  0 \\\\ 0  0  \\frac{12D}{h} \\end{pmatrix}\n$$\n\n**2. 质量矩阵 $\\mathbf{M}$ 的计算**\n$$\nM_{ij} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} \\varphi_{i}(\\xi)\\varphi_{j}(\\xi)\\,d\\xi\n$$\n基函数 $\\varphi_i = P_i$ 是 Legendre 多项式，它们在 $[-1, 1]$ 上是正交的。其正交关系为：\n$$\n\\int_{-1}^{1} P_{i}(\\xi)P_{j}(\\xi)\\,d\\xi = \\frac{2}{2i+1}\\delta_{ij}\n$$\n其中 $\\delta_{ij}$ 是克罗内克 δ。这意味着质量矩阵 $\\mathbf{M}$ 是对角矩阵。我们计算对角元素：\n- 对于 $M_{00}$：\n$$\nM_{00} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} P_0(\\xi)P_0(\\xi)\\,d\\xi = \\frac{h\\Sigma_{r}}{2} \\left(\\frac{2}{2(0)+1}\\right) = h\\Sigma_r\n$$\n- 对于 $M_{11}$：\n$$\nM_{11} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} P_1(\\xi)P_1(\\xi)\\,d\\xi = \\frac{h\\Sigma_{r}}{2} \\left(\\frac{2}{2(1)+1}\\right) = \\frac{h\\Sigma_r}{3}\n$$\n- 对于 $M_{22}$：\n$$\nM_{22} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} P_2(\\xi)P_2(\\xi)\\,d\\xi = \\frac{h\\Sigma_{r}}{2} \\left(\\frac{2}{2(2)+1}\\right) = \\frac{h\\Sigma_r}{5}\n$$\n因此，质量矩阵 $\\mathbf{M}$ 为：\n$$\n\\mathbf{M} = \\begin{pmatrix} h\\Sigma_r  0  0 \\\\ 0  \\frac{h\\Sigma_r}{3}  0 \\\\ 0  0  \\frac{h\\Sigma_r}{5} \\end{pmatrix}\n$$\n\n**3. 组装矩阵 $\\mathbf{A}$ 并计算其行列式**\n最终矩阵 $\\mathbf{A}$ 是 $\\mathbf{K}$ 和 $\\mathbf{M}$ 的和，即 $\\mathbf{A} = \\mathbf{K} + \\mathbf{M}$。由于 $\\mathbf{K}$ 和 $\\mathbf{M}$ 都是对角矩阵，所以 $\\mathbf{A}$ 也是对角矩阵。\n$$\n\\mathbf{A} = \\begin{pmatrix} 0  0  0 \\\\ 0  \\frac{4D}{h}  0 \\\\ 0  0  \\frac{12D}{h} \\end{pmatrix} + \\begin{pmatrix} h\\Sigma_r  0  0 \\\\ 0  \\frac{h\\Sigma_r}{3}  0 \\\\ 0  0  \\frac{h\\Sigma_r}{5} \\end{pmatrix} = \\begin{pmatrix} h\\Sigma_r  0  0 \\\\ 0  \\frac{4D}{h} + \\frac{h\\Sigma_r}{3}  0 \\\\ 0  0  \\frac{12D}{h} + \\frac{h\\Sigma_r}{5} \\end{pmatrix}\n$$\n对角矩阵的行列式是其对角元素的乘积：\n$$\n\\det(\\mathbf{A}) = A_{00} \\cdot A_{11} \\cdot A_{22}\n$$\n$$\n\\det(\\mathbf{A}) = (h\\Sigma_r) \\left( \\frac{4D}{h} + \\frac{h\\Sigma_r}{3} \\right) \\left( \\frac{12D}{h} + \\frac{h\\Sigma_r}{5} \\right)\n$$\n为了得到所需的闭合形式表达式，我们化简括号中的项：\n$$\n\\frac{4D}{h} + \\frac{h\\Sigma_r}{3} = \\frac{3 \\cdot 4D + h \\cdot h\\Sigma_r}{3h} = \\frac{12D + h^2\\Sigma_r}{3h}\n$$\n$$\n\\frac{12D}{h} + \\frac{h\\Sigma_r}{5} = \\frac{5 \\cdot 12D + h \\cdot h\\Sigma_r}{5h} = \\frac{60D + h^2\\Sigma_r}{5h}\n$$\n将这些代回行列式的表达式中：\n$$\n\\det(\\mathbf{A}) = (h\\Sigma_r) \\left( \\frac{12D + h^2\\Sigma_r}{3h} \\right) \\left( \\frac{60D + h^2\\Sigma_r}{5h} \\right)\n$$\n$$\n\\det(\\mathbf{A}) = \\frac{h\\Sigma_r}{15h^2} (12D + h^2\\Sigma_r)(60D + h^2\\Sigma_r)\n$$\n$$\n\\det(\\mathbf{A}) = \\frac{\\Sigma_r}{15h} (12D + h^2\\Sigma_r)(60D + h^2\\Sigma_r)\n$$\n这就是矩阵 $\\mathbf{A}$ 的行列式的最终闭合形式表达式。",
            "answer": "$$\\boxed{\\frac{\\Sigma_{r}}{15h}(12D + h^{2}\\Sigma_{r})(60D + h^{2}\\Sigma_{r})}$$"
        },
        {
            "introduction": "反应堆堆芯由成千上万个节块组成，因此，在建立了单个节块的模型后，下一步自然是学习如何将它们连接起来。本练习将演示如何通过在节块交界面上施加物理上的连续性条件（中子通量和中子流密度连续），来组装一个描述整个系统的全局线性方程组。这个练习搭建了从单个节块的局部物理到整个系统宏观行为的桥梁，并引入了数值线性代数中的关键概念。",
            "id": "4241267",
            "problem": "考虑一个长度为 $2h$ 的一维板式反应堆，它被划分为两个相等的节点 $[0,h]$ 和 $[h,2h]$。假设采用单群、稳态中子扩散模型，其扩散系数 $D$ 为常数，吸收为零，由扩散方程 $-\\frac{d}{dx}\\left(D \\frac{d \\phi}{dx}\\right) = q(x)$ 控制。其中，净固定源 $q(x)$ 在每个节点内为常数。位于 $x=0$ 和 $x=2h$ 的左右物理边界满足 Marshak 真空边界条件 $\\phi + 2 D \\,\\partial \\phi/\\partial n = 0$。在每个节点内，使用最高二次的多项式展开节点法来近似标量通量 $\\phi(x)$，并采用标准的节点内系数消去法，仅耦合面（界面）上的通量未知数。令界面通量未知向量为 $\\boldsymbol{\\varphi} = \\begin{pmatrix} \\phi_0 & \\phi_1 & \\phi_2 \\end{pmatrix}^{\\mathsf{T}}$，其中 $\\phi_0=\\phi(0)$，$\\phi_1=\\phi(h)$，$\\phi_2=\\phi(2h)$。\n\n仅使用基本定义和守恒声明（扩散方程、Fick 定律 $J=-D\\,d\\phi/dx$、内部界面处净流的连续性，以及用 $J$ 和 $\\phi$ 表示的 Marshak 边界条件），通过消去所有节点内展开系数，为 $\\boldsymbol{\\varphi}$ 构建形式为 $A\\,\\boldsymbol{\\varphi}=\\boldsymbol{b}$ 的全局稀疏线性系统。然后分析 $A$ 的稀疏性和块结构，以证明选择某个特定的 Krylov 子空间方法和一种自然的预条件子是合理的。\n\n将数据特定为 $D=1$ 和 $h=1$，并在边界条件中明确保留 Marshak 系数 $2D$。在此特定条件下，构建 Jacobi 预条件子 $P=\\mathrm{diag}(A)$ 和对称预处理算子 $M=P^{-1/2} A P^{-1/2}$。计算 $M$ 的精确条件数 $\\kappa(M)$，定义为 $M$ 的最大特征值与最小特征值之比，并以闭式解析表达式给出。最终答案需表示为精确表达式；不要近似或四舍五入。最终答案无需物理单位。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **控制方程**：一维（$1$D）、单群、稳态中子扩散方程：$-\\frac{d}{dx}\\left(D \\frac{d \\phi}{dx}\\right) = q(x)$。\n- **区域**：一个长度为 $2h$ 的板，划分为两个相等的节点：节点 1 位于 $[0,h]$，节点 2 位于 $[h,2h]$。\n- **参数**：扩散系数 $D$ 是常数。吸收截面为零。净固定源 $q(x)$ 在每个节点内为常数，节点 1 内记为 $q_1$，节点 2 内记为 $q_2$。\n- **边界条件 (BCs)**：在外部表面 $x=0$ 和 $x=2h$ 处的 Marshak 真空边界条件：$\\phi + 2 D \\,\\partial \\phi/\\partial n = 0$，其中 $\\partial \\phi/\\partial n$ 是沿外法线方向的导数。\n- **数值方法**：在每个节点内对标量通量 $\\phi(x)$ 采用最高二次的多项式展开节点法 (PENM)。\n- **未知数**：界面通量向量 $\\boldsymbol{\\varphi} = \\begin{pmatrix} \\phi_0 & \\phi_1 & \\phi_2 \\end{pmatrix}^{\\mathsf{T}}$，其中 $\\phi_0=\\phi(0)$，$\\phi_1=\\phi(h)$，$\\phi_2=\\phi(2h)$。\n- **系统形式**：通过消去节点内系数，得到关于 $\\boldsymbol{\\varphi}$ 的稀疏线性系统，形式为 $A\\,\\boldsymbol{\\varphi}=\\boldsymbol{b}$。\n- **辅助定义**：Fick 定律，$J=-D\\,d\\phi/dx$；在内部界面 $x=h$ 处净流 $J$ 的连续性。\n- **任务 1**：构建系统 $A\\,\\boldsymbol{\\varphi}=\\boldsymbol{b}$。\n- **任务 2**：分析 $A$ 的结构，以证明选择一种 Krylov 子空间方法和预条件子是合理的。\n- **任务 3**：将参数特定为 $D=1$ 和 $h=1$。构建 Jacobi 预条件子 $P=\\mathrm{diag}(A)$ 和对称预处理算子 $M=P^{-1/2} A P^{-1/2}$。计算精确条件数 $\\kappa(M)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于中子扩散方程、Fick 定律和 Marshak 边界条件，这些都是核反应堆物理学的基石原理。所指定的多项式展开节点法 (PENM) 是一种求解扩散方程的标准且成熟的技术。整个设置在科学上和数学上都是合理的。\n- **适定性**：该问题建立了一个带有 Robin 型边界条件的二阶线性常微分方程。此类边值问题是适定的，存在唯一解。数值离散格式定义清晰，可导出一个可解的线性系统。\n- **客观性**：该问题使用精确、无歧义的技术语言陈述。它不包含任何主观或基于观点的内容。\n- **完整性与一致性**：该问题提供了构建线性系统所需的所有信息。虽然源项 $q_1$ 和 $q_2$ 是符号形式，但这对于推导系统矩阵 $A$ 和源向量 $\\boldsymbol{b}$ 的一般形式是合适的。问题内部没有矛盾。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整解答。\n\n### 第一部分：线性系统的构建\n我们分析每个节点内的通量和流，以建立边界通量（$\\phi_0, \\phi_1, \\phi_2$）与边界流之间的关系。\n\n对于一个宽度为 $h_k$、常数源为 $q_k$ 的通用节点 $k$，扩散方程为 $-D \\frac{d^2\\phi_k}{dx^2} = q_k$。积分两次得到一般的二次通量形式：\n$\\phi_k(x) = -\\frac{q_k}{2D}x^2 + c_1 x + c_2$。\n\n为方便起见，对每个节点使用一个规范的局部坐标系 $\\xi \\in [-1, 1]$。\n对于 $[0, h]$ 上的节点 1，坐标变换为 $x = \\frac{h}{2}(1+\\xi)$，且 $\\frac{d}{dx} = \\frac{2}{h}\\frac{d}{d\\xi}$。扩散方程变为 $-D (\\frac{2}{h})^2 \\frac{d^2\\phi_1}{d\\xi^2} = q_1$，积分得到：\n$\\phi_1(\\xi) = -\\frac{q_1 h^2}{8D}\\xi^2 + C_1\\xi + C_2$。\n在节点边界 $\\xi=-1$（$x=0$）和 $\\xi=1$（$x=h$）处的通量值分别为 $\\phi_0$ 和 $\\phi_1$。\n$\\phi_1(-1) = \\phi_0 = -\\frac{q_1 h^2}{8D} - C_1 + C_2$\n$\\phi_1(1) = \\phi_1 = -\\frac{q_1 h^2}{8D} + C_1 + C_2$\n求解 $C_1$ 和 $C_2$ 可得 $C_1 = \\frac{\\phi_1-\\phi_0}{2}$ 和 $C_2 = \\frac{\\phi_1+\\phi_0}{2} + \\frac{q_1 h^2}{8D}$。\n代回可得用边值表示的通量：\n$\\phi_1(\\xi) = \\frac{q_1h^2}{8D}(1-\\xi^2) + \\frac{1+\\xi}{2}\\phi_1 + \\frac{1-\\xi}{2}\\phi_0$。\n\n根据 Fick 定律，$J = -D \\frac{d\\phi}{dx}$，净流为：\n$J_1(\\xi) = -D \\frac{2}{h} \\frac{d\\phi_1}{d\\xi} = -D\\frac{2}{h}\\left(-\\frac{q_1 h^2}{4D}\\xi + \\frac{\\phi_1 - \\phi_0}{2}\\right) = \\frac{q_1 h}{2}\\xi - \\frac{D}{h}(\\phi_1 - \\phi_0)$。\n节点 1 边界处的流为：\n$J_0 = J_1(\\xi=-1) = -\\frac{q_1 h}{2} - \\frac{D}{h}(\\phi_1 - \\phi_0)$（在 $x=0$ 处）\n$J_{1,R} = J_1(\\xi=1) = \\frac{q_1 h}{2} - \\frac{D}{h}(\\phi_1 - \\phi_0)$（在 $x=h$ 处，离开节点 1）\n\n对于 $[h, 2h]$ 上的节点 2，进行类似分析，将 $(\\phi_0, \\phi_1, q_1)$ 替换为 $(\\phi_1, \\phi_2, q_2)$，可以得到在 $x=h$ 处离开节点 2 的流。我们称之为 $J_{2,L}$（节点 2 左侧面上的流）。其表达式与节点 1 的 $J_0$ 类似：\n$J_{2,L} = -\\frac{q_2 h}{2} - \\frac{D}{h}(\\phi_2 - \\phi_1)$（在 $x=h$ 处，进入节点 2）\n在 $x=2h$ 处的流为：\n$J_2 = \\frac{q_2 h}{2} - \\frac{D}{h}(\\phi_2 - \\phi_1)$（在 $x=2h$ 处）\n\n现在我们利用边界条件和界面连续性来组装一个 $3 \\times 3$ 的系统。\n\n1.  **在 $x=0$ 处的边界条件**：外法线方向为 $-x$ 方向。Marshak 边界条件 $\\phi + 2 D \\,\\partial \\phi/\\partial n = 0$ 变为 $\\phi(0) + 2D(-\\frac{d\\phi}{dx}|_0) = 0$。由于 $J = -D \\frac{d\\phi}{dx}$，这等价于 $\\phi_0 + 2J_0 = 0$。\n    $\\phi_0 + 2\\left(-\\frac{q_1 h}{2} - \\frac{D}{h}(\\phi_1 - \\phi_0)\\right) = 0$\n    $\\phi_0 - q_1 h - \\frac{2D}{h}\\phi_1 + \\frac{2D}{h}\\phi_0 = 0$\n    $\\left(1 + \\frac{2D}{h}\\right)\\phi_0 - \\frac{2D}{h}\\phi_1 = q_1 h$\n\n2.  **在 $x=h$ 处的界面连续性**：净流的连续性要求 $J_{1,R} = J_{2,L}$。\n    $\\frac{q_1 h}{2} - \\frac{D}{h}(\\phi_1 - \\phi_0) = -\\frac{q_2 h}{2} - \\frac{D}{h}(\\phi_2 - \\phi_1)$\n    $\\frac{D}{h}\\phi_0 - \\frac{D}{h}\\phi_1 = -\\frac{h}{2}(q_1+q_2) - \\frac{D}{h}\\phi_2 + \\frac{D}{h}\\phi_1$\n    $\\frac{D}{h}\\phi_0 - \\frac{2D}{h}\\phi_1 + \\frac{D}{h}\\phi_2 = -\\frac{h}{2}(q_1+q_2)$\n\n3.  **在 $x=2h$ 处的边界条件**：外法线方向为 $+x$ 方向。Marshak 边界条件为 $\\phi(2h) + 2D(\\frac{d\\phi}{dx}|_{2h}) = 0$，即 $\\phi_2 - 2J_2 = 0$。\n    $\\phi_2 - 2\\left(\\frac{q_2 h}{2} - \\frac{D}{h}(\\phi_2 - \\phi_1)\\right) = 0$\n    $\\phi_2 - q_2 h + \\frac{2D}{h}\\phi_2 - \\frac{2D}{h}\\phi_1 = 0$\n    $-\\frac{2D}{h}\\phi_1 + \\left(1 + \\frac{2D}{h}\\right)\\phi_2 = q_2 h$\n\n因此，线性系统 $A\\boldsymbol{\\varphi} = \\boldsymbol{b}$ 为：\n$$\nA = \\begin{pmatrix}\n1 + \\frac{2D}{h} & -\\frac{2D}{h} & 0 \\\\\n\\frac{D}{h} & -\\frac{2D}{h} & \\frac{D}{h} \\\\\n0 & -\\frac{2D}{h} & 1 + \\frac{2D}{h}\n\\end{pmatrix}, \\quad\n\\boldsymbol{b} = \\begin{pmatrix}\nq_1 h \\\\\n-\\frac{h}{2}(q_1+q_2) \\\\\nq_2 h\n\\end{pmatrix}\n$$\n\n### 第二部分：系统分析\n对于一个包含许多节点的普遍问题，此方法会生成一个大型稀疏线性系统。对于这个一维问题，矩阵 $A$ 是**三对角**的。在更高维度（二维或三维）中，它将具有块三对角或更复杂的稀疏结构，以反映最近邻耦合。\n$A$ 的一个关键性质是它是**非对称**的（例如，$A_{12} \\neq A_{21}$）。这是选择数值求解器时的关键因素。\n对于大规模系统，迭代法优于直接法。由于 $A$ 是非对称的，标准的共轭梯度法 (CG) 不适用。合适的 **Krylov 子空间方法**包括**广义最小残差法 (GMRES)** 或**双共轭梯度稳定法 (BiCGSTAB)**。\n这些方法的收敛速度在很大程度上依赖于矩阵的条件数。为了获得实际性能，几乎总是需要一个**预条件子**。对于由离散化偏微分方程产生的系统，一个自然而稳健的选择是**不完全 LU (ILU) 分解**。ILU 预条件子，特别是具有少量填充 $k$ 的 ILU($k$)，在有效性和计算成本之间提供了良好的平衡。更简单的替代方案包括 **Jacobi** 或 **Gauss-Seidel** 预条件子，它们功能较弱但更易于实现。\n\n### 第三部分：特定化与条件数计算\n我们将系统特定化为 $D=1$ 和 $h=1$。矩阵 $A$ 变为：\n$$ A = \\begin{pmatrix}\n1 + 2 & -2 & 0 \\\\\n1 & -2 & 1 \\\\\n0 & -2 & 1 + 2\n\\end{pmatrix} = \\begin{pmatrix}\n3 & -2 & 0 \\\\\n1 & -2 & 1 \\\\\n0 & -2 & 3\n\\end{pmatrix} $$\nJacobi 预条件子为 $P=\\mathrm{diag}(A)$：\n$$ P = \\begin{pmatrix}\n3 & 0 & 0 \\\\\n0 & -2 & 0 \\\\\n0 & 0 & 3\n\\end{pmatrix} $$\n请注意，由于元素 $P_{22}=-2$，$P$ 不是正定的。算子 $P^{-1/2}$ 将涉及复数。\n$$ P^{-1/2} = \\begin{pmatrix}\n\\frac{1}{\\sqrt{3}} & 0 & 0 \\\\\n0 & \\frac{1}{\\sqrt{-2}} & 0 \\\\\n0 & 0 & \\frac{1}{\\sqrt{3}}\n\\end{pmatrix} = \\begin{pmatrix}\n\\frac{1}{\\sqrt{3}} & 0 & 0 \\\\\n0 & -\\frac{i}{\\sqrt{2}} & 0 \\\\\n0 & 0 & \\frac{1}{\\sqrt{3}}\n\\end{pmatrix} $$\n现在我们构建对称预处理算子 $M=P^{-1/2} A P^{-1/2}$：\n$$ M = \\begin{pmatrix} \\frac{1}{\\sqrt{3}} & 0 & 0 \\\\ 0 & -\\frac{i}{\\sqrt{2}} & 0 \\\\ 0 & 0 & \\frac{1}{\\sqrt{3}} \\end{pmatrix}\n\\begin{pmatrix} 3 & -2 & 0 \\\\ 1 & -2 & 1 \\\\ 0 & -2 & 3 \\end{pmatrix}\n\\begin{pmatrix} \\frac{1}{\\sqrt{3}} & 0 & 0 \\\\ 0 & -\\frac{i}{\\sqrt{2}} & 0 \\\\ 0 & 0 & \\frac{1}{\\sqrt{3}} \\end{pmatrix} $$\n执行矩阵乘法得到：\n$$ M = \\begin{pmatrix}\n1 & \\frac{2i}{\\sqrt{6}} & 0 \\\\\n-\\frac{i}{\\sqrt{6}} & 1 & -\\frac{i}{\\sqrt{6}} \\\\\n0 & \\frac{2i}{\\sqrt{6}} & 1\n\\end{pmatrix} $$\n尽管 $M$ 不是 Hermitian 矩阵，但它是一个三对角矩阵，其中非对角元素对的乘积 $M_{k,k+1}M_{k+1,k}$ 是正实数：$M_{12}M_{21} = (\\frac{2i}{\\sqrt{6}})(-\\frac{i}{\\sqrt{6}}) = \\frac{2}{6} = \\frac{1}{3} > 0$ 且 $M_{23}M_{32} = (-\\frac{i}{\\sqrt{6}})(\\frac{2i}{\\sqrt{6}}) = \\frac{2}{6} = \\frac{1}{3} > 0$。这样的矩阵与一个实对称矩阵相似，因此其所有特征值都是实数。\n为求特征值 $\\lambda$，我们求解特征方程 $\\det(M - \\lambda I)=0$。令 $\\mu = 1-\\lambda$：\n$$ \\det \\begin{pmatrix}\n\\mu & \\frac{2i}{\\sqrt{6}} & 0 \\\\\n-\\frac{i}{\\sqrt{6}} & \\mu & -\\frac{i}{\\sqrt{6}} \\\\\n0 & \\frac{2i}{\\sqrt{6}} & \\mu\n\\end{pmatrix} = 0 $$\n行列式为 $\\mu\\left(\\mu^2 - (-\\frac{i}{\\sqrt{6}})(\\frac{2i}{\\sqrt{6}})\\right) - \\frac{2i}{\\sqrt{6}}\\left((-\\frac{i}{\\sqrt{6}})\\mu\\right) = 0$。\n$\\mu(\\mu^2 - \\frac{2}{6}) - (\\frac{2}{6})\\mu = 0$\n$\\mu(\\mu^2 - \\frac{1}{3} - \\frac{1}{3}) = 0 \\implies \\mu(\\mu^2 - \\frac{2}{3}) = 0$。\n$\\mu$ 的解为 $\\mu=0$ 和 $\\mu = \\pm\\sqrt{\\frac{2}{3}}$。\n由于 $\\lambda = 1 - \\mu$，$M$ 的特征值为：\n$\\lambda_1 = 1 - \\sqrt{\\frac{2}{3}}$\n$\\lambda_2 = 1 - 0 = 1$\n$\\lambda_3 = 1 + \\sqrt{\\frac{2}{3}}$\n所有特征值均为正数。按大小排列的最大和最小特征值为：\n$\\lambda_{\\max} = 1 + \\sqrt{\\frac{2}{3}}$\n$\\lambda_{\\min} = 1 - \\sqrt{\\frac{2}{3}}$\n条件数 $\\kappa(M)$ 是比值 $|\\lambda_{\\max}| / |\\lambda_{\\min}|$：\n$$ \\kappa(M) = \\frac{1 + \\sqrt{\\frac{2}{3}}}{1 - \\sqrt{\\frac{2}{3}}} $$\n为了简化，我们将分母有理化：\n$$ \\kappa(M) = \\frac{1 + \\frac{\\sqrt{2}}{\\sqrt{3}}}{1 - \\frac{\\sqrt{2}}{\\sqrt{3}}} = \\frac{\\sqrt{3}+\\sqrt{2}}{\\sqrt{3}-\\sqrt{2}} = \\frac{(\\sqrt{3}+\\sqrt{2})(\\sqrt{3}+\\sqrt{2})}{(\\sqrt{3}-\\sqrt{2})(\\sqrt{3}+\\sqrt{2})} = \\frac{(\\sqrt{3})^2 + 2\\sqrt{3}\\sqrt{2} + (\\sqrt{2})^2}{(\\sqrt{3})^2 - (\\sqrt{2})^2} $$\n$$ \\kappa(M) = \\frac{3 + 2\\sqrt{6} + 2}{3 - 2} = 5 + 2\\sqrt{6} $$\n这就是条件数的最终精确解析表达式。",
            "answer": "$$\\boxed{5 + 2\\sqrt{6}}$$"
        },
        {
            "introduction": "任何数值方法的开发，如果缺少严格的验证过程，都是不完整的。本练习将介绍一种标准的验证技术——“人造解方法”（method of manufactured solutions），它被广泛用于创建具有已知精确解的基准问题。通过为一个特定的测试案例推导出精确的解析解，您将为自己建立一个“黄金标准”，用以验证数值程序的正确性并量化其计算精度。",
            "id": "4241268",
            "problem": "考虑一个一维稳态板式反应堆基准问题，该问题设计用于验证多项式展开节点方法（PENM）。设该板占据区间 $x \\in [0,L]$，且为均匀介质，具有恒定的扩散系数 $D$ 和宏观吸收截面 $\\Sigma_{a}$。驱动项是一个人为构造的正弦体积源 $S(x) = S_{0} \\sin(\\kappa x)$，其中 $\\kappa = \\frac{n \\pi}{L}$，$n$ 为正整数。在两端施加真空边界条件 $ \\phi(0) = 0 $ 和 $ \\phi(L) = 0 $，其中 $ \\phi(x) $ 是标量中子通量。\n\n从一维稳态单群中子扩散方程出发：\n$ -\\frac{d}{dx} \\left( D \\frac{d \\phi}{dx} \\right) + \\Sigma_{a} \\phi = S(x) $,\n推导上述情况下的精确解析解 $ \\phi(x) $。然后，将区域划分为 $M$ 个宽度为 $h = \\frac{L}{M}$ 的相等节点，并推导节点 $j$ 中节点平均通量的精确解析表达式，其定义为\n$ \\bar{\\phi}_{j} = \\frac{1}{h} \\int_{(j-1)h}^{jh} \\phi(x) \\, dx $。\n最后，使用参数 $ L = 60 \\, \\mathrm{cm} $、$ M = 5 $、$ n = 3 $、$ D = 1.00 \\, \\mathrm{cm} $、$ \\Sigma_{a} = 0.10 \\, \\mathrm{cm}^{-1} $ 和 $ S_{0} = 1.00 \\times 10^{6} \\, \\mathrm{n} \\, \\mathrm{cm}^{-3} \\, \\mathrm{s}^{-1} $，数值计算 $ \\bar{\\phi}_{3} $ 的值。以 $ \\mathrm{cm}^{-2} \\, \\mathrm{s}^{-1} $ 为单位表示 $ \\bar{\\phi}_{3} $ 的最终值，并将答案四舍五入到四位有效数字。",
            "solution": "问题陈述经过严格验证，确认有效。这是一个适定问题，其基础是核反应堆物理的既定原理，具体来说是单群中子扩散理论。使用人为构造的正弦源（该源可以取负值）是一种标准且可接受的做法，用于创建旨在验证数值方法的基准问题。尽管在裂变驱动的反应堆中不会物理实现负源及由此产生的负通量，但在扩散方程的数学框架内，它们是合理的，其中负源代表一个空间依赖的汇项。该问题是自洽、客观的，且所有给定参数均一致。\n\n一维、稳态、单群中子在均匀介质中的扩散方程为：\n$$-\\frac{d}{dx} \\left( D \\frac{d \\phi}{dx} \\right) + \\Sigma_{a} \\phi(x) = S(x)$$\n鉴于扩散系数 $D$ 和宏观吸收截面 $\\Sigma_{a}$ 是常数，方程简化为：\n$$-D \\frac{d^2 \\phi}{dx^2} + \\Sigma_{a} \\phi(x) = S(x)$$\n源项指定为 $S(x) = S_{0} \\sin(\\kappa x)$，其中 $\\kappa = \\frac{n \\pi}{L}$。区域为 $x \\in [0,L]$，并施加真空边界条件 $\\phi(0) = 0$ 和 $\\phi(L) = 0$。\n\n首先，我们推导精确的解析解 $\\phi(x)$。\n问题的设置使得源项 $\\sin(\\kappa x)$ 是扩散算符 $-\\frac{d^2}{dx^2}$ 在区域 $[0,L]$ 上且带有零边界条件的本征函数。这提示我们寻求形式为 $\\phi(x) = A \\sin(\\kappa x)$ 的解，其中 $A$ 是一个待定常数。\n我们用这个假设的形式来验证边界条件：\n在 $x=0$ 处：$\\phi(0) = A \\sin(\\kappa \\cdot 0) = A \\sin(0) = 0$。此条件满足。\n在 $x=L$ 处：$\\phi(L) = A \\sin(\\kappa L)$。由于 $\\kappa = \\frac{n \\pi}{L}$，我们有 $\\phi(L) = A \\sin\\left(\\frac{n \\pi}{L} \\cdot L\\right) = A \\sin(n \\pi) = 0$，对于任何整数 $n$ 都成立。此条件也满足。\n\n现在，我们将假设解代入扩散方程。$\\phi(x)$ 的导数为：\n$$\\frac{d \\phi}{dx} = A \\kappa \\cos(\\kappa x)$$\n$$\\frac{d^2 \\phi}{dx^2} = -A \\kappa^2 \\sin(\\kappa x)$$\n代入扩散方程：\n$$-D (-A \\kappa^2 \\sin(\\kappa x)) + \\Sigma_{a} (A \\sin(\\kappa x)) = S_{0} \\sin(\\kappa x)$$\n$$A (D \\kappa^2 + \\Sigma_{a}) \\sin(\\kappa x) = S_{0} \\sin(\\kappa x)$$\n为了使此等式对所有 $x \\in [0,L]$ 均成立，系数必须相等：\n$$A (D \\kappa^2 + \\Sigma_{a}) = S_{0}$$\n求解常数 $A$：\n$$A = \\frac{S_{0}}{D \\kappa^2 + \\Sigma_{a}}$$\n因此，中子通量的精确解析解为：\n$$\\phi(x) = \\frac{S_{0}}{D \\kappa^2 + \\Sigma_{a}} \\sin(\\kappa x)$$\n\n接下来，我们推导节点 $j$ 的节点平均通量 $\\bar{\\phi}_{j}$ 的表达式。区域 $[0,L]$ 被划分为 $M$ 个相等的节点，每个节点的宽度为 $h = \\frac{L}{M}$。节点 $j$ 覆盖区间 $[(j-1)h, jh]$。平均通量定义为：\n$$\\bar{\\phi}_{j} = \\frac{1}{h} \\int_{(j-1)h}^{jh} \\phi(x) \\, dx$$\n代入 $\\phi(x)$ 的表达式：\n$$\\bar{\\phi}_{j} = \\frac{1}{h} \\int_{(j-1)h}^{jh} \\frac{S_{0}}{D \\kappa^2 + \\Sigma_{a}} \\sin(\\kappa x) \\, dx$$\n常数项可以移到积分外：\n$$\\bar{\\phi}_{j} = \\frac{S_{0}}{h (D \\kappa^2 + \\Sigma_{a})} \\int_{(j-1)h}^{jh} \\sin(\\kappa x) \\, dx$$\n$\\sin(\\kappa x)$ 的积分为 $-\\frac{1}{\\kappa}\\cos(\\kappa x)$。计算定积分：\n$$\\int_{(j-1)h}^{jh} \\sin(\\kappa x) \\, dx = \\left[ -\\frac{1}{\\kappa} \\cos(\\kappa x) \\right]_{(j-1)h}^{jh} = -\\frac{1}{\\kappa} (\\cos(\\kappa jh) - \\cos(\\kappa (j-1)h))$$\n$$= \\frac{1}{\\kappa} (\\cos(\\kappa(j-1)h) - \\cos(\\kappa jh))$$\n将此结果代回 $\\bar{\\phi}_{j}$ 的表达式：\n$$\\bar{\\phi}_{j} = \\frac{S_{0}}{h \\kappa (D \\kappa^2 + \\Sigma_{a})} (\\cos(\\kappa(j-1)h) - \\cos(\\kappa jh))$$\n这就是节点 $j$ 中节点平均通量的精确解析表达式。\n\n最后，我们使用给定的参数计算 $\\bar{\\phi}_{3}$：\n$L = 60 \\, \\mathrm{cm}$\n$M = 5$\n$n = 3$\n$D = 1.00 \\, \\mathrm{cm}$\n$\\Sigma_{a} = 0.10 \\, \\mathrm{cm}^{-1}$\n$S_{0} = 1.00 \\times 10^{6} \\, \\mathrm{n} \\, \\mathrm{cm}^{-3} \\, \\mathrm{s}^{-1}$\n目标节点是 $j=3$。\n\n首先，我们计算派生参数 $h$ 和 $\\kappa$：\n节点宽度：$h = \\frac{L}{M} = \\frac{60}{5} = 12 \\, \\mathrm{cm}$\n波数：$\\kappa = \\frac{n \\pi}{L} = \\frac{3 \\pi}{60} = \\frac{\\pi}{20} \\, \\mathrm{cm}^{-1}$\n\n现在，我们计算 $\\bar{\\phi}_{3}$ 的表达式的值：\n$$\\bar{\\phi}_{3} = \\frac{S_{0}}{h \\kappa (D \\kappa^2 + \\Sigma_{a})} (\\cos(\\kappa(2h)) - \\cos(\\kappa(3h)))$$\n余弦函数的自变量为：\n$\\kappa (2h) = \\frac{\\pi}{20} \\cdot (2 \\cdot 12) = \\frac{24\\pi}{20} = \\frac{6\\pi}{5}$\n$\\kappa (3h) = \\frac{\\pi}{20} \\cdot (3 \\cdot 12) = \\frac{36\\pi}{20} = \\frac{9\\pi}{5}$\n余弦项为：\n$\\cos\\left(\\frac{6\\pi}{5}\\right) = \\cos\\left(\\pi + \\frac{\\pi}{5}\\right) = -\\cos\\left(\\frac{\\pi}{5}\\right)$\n$\\cos\\left(\\frac{9\\pi}{5}\\right) = \\cos\\left(2\\pi - \\frac{\\pi}{5}\\right) = \\cos\\left(\\frac{\\pi}{5}\\right)$\n差值为：\n$\\cos\\left(\\frac{6\\pi}{5}\\right) - \\cos\\left(\\frac{9\\pi}{5}\\right) = -\\cos\\left(\\frac{\\pi}{5}\\right) - \\cos\\left(\\frac{\\pi}{5}\\right) = -2\\cos\\left(\\frac{\\pi}{5}\\right)$\n$\\cos(\\frac{\\pi}{5})$ 的精确值为 $\\frac{1+\\sqrt{5}}{4}$。所以，差值为 $-2\\left(\\frac{1+\\sqrt{5}}{4}\\right) = -\\frac{1+\\sqrt{5}}{2}$。\n\n现在，我们将数值代入 $\\bar{\\phi}_{3}$ 的完整表达式：\n分母项 $(D \\kappa^2 + \\Sigma_{a})$ 为：\n$D \\kappa^2 + \\Sigma_{a} = (1.00) \\left(\\frac{\\pi}{20}\\right)^2 + 0.10 = \\frac{\\pi^2}{400} + 0.10 \\, \\mathrm{cm}^{-1}$\n分母 $h \\kappa (D \\kappa^2 + \\Sigma_{a})$ 为：\n$12 \\cdot \\frac{\\pi}{20} \\left(\\frac{\\pi^2}{400} + 0.10\\right) = \\frac{3\\pi}{5} \\left(\\frac{\\pi^2+40}{400}\\right) = \\frac{3\\pi(\\pi^2+40)}{2000}$\n分子 $S_0 (\\cos(\\kappa(2h)) - \\cos(\\kappa(3h)))$ 为：\n$(1.00 \\times 10^6) \\left(-\\frac{1+\\sqrt{5}}{2}\\right)$\n所以，我们有：\n$$\\bar{\\phi}_{3} = \\frac{(1.00 \\times 10^6) \\left(-\\frac{1+\\sqrt{5}}{2}\\right)}{\\frac{3\\pi(\\pi^2+40)}{2000}} = \\frac{-1000 \\cdot (1.00 \\times 10^6) (1+\\sqrt{5})}{3\\pi(\\pi^2+40)}$$\n$$\\bar{\\phi}_{3} = \\frac{-10^9 (1+\\sqrt{5})}{3\\pi(\\pi^2+40)}$$\n现在，我们计算数值：\n$1+\\sqrt{5} \\approx 3.236068$\n$\\pi^2+40 \\approx 9.869604 + 40 = 49.869604$\n$3\\pi \\approx 9.424778$\n$$\\bar{\\phi}_{3} \\approx \\frac{-10^9 \\times 3.236068}{9.424778 \\times 49.869604} \\approx \\frac{-3.236068 \\times 10^9}{470.0035} \\approx -6.88522 \\times 10^6$$\n单位是 $\\mathrm{cm}^{-2} \\, \\mathrm{s}^{-1}$。\n将结果四舍五入到四位有效数字得到 $-6.885 \\times 10^6$。负值是正确的数学结果，因为在对应于节点3的区间，即 $x \\in [24, 36]$，源项 $S(x)$ 是负的。",
            "answer": "$$\\boxed{-6.885 \\times 10^{6}}$$"
        }
    ]
}