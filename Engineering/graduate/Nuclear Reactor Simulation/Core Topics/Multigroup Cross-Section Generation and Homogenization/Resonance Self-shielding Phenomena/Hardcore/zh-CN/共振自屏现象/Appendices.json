{
    "hands_on_practices": [
        {
            "introduction": "要准确模拟共振自屏效应，首先必须掌握单个共振的物理特性。这个实践从量子散射理论和单能级 Breit-Wigner 公式出发，要求推导共振吸收截面的峰值和能量积分面积。通过这个基于第一性原理的练习 ，您将加深对共振宽度、分支比等核心参数如何决定共振峰形状和强度的理解，为后续更复杂的自屏效应分析奠定坚实的理论基础。",
            "id": "4246019",
            "problem": "在用于研究核反应堆模拟中子共振自屏的均匀化、无限稀释的吸收剂-慢化剂混合物中，考虑一个与能量为$E_r$的s波（轨道角动量$\\ell = 0$）复合核能级相关的孤立单一共振。该共振的总宽度为$\\,\\Gamma\\,$，自旋统计因子为$\\,g\\,$。总宽度分解为中子入射道部分宽度$\\,\\Gamma_{n}\\,$和吸收出射道部分宽度$\\,\\Gamma_{a}\\,$（此处的吸收包括所有非弹性道，如辐射俘获以及可能发生的裂变），因此有$\\,\\Gamma = \\Gamma_{n} + \\Gamma_{a}\\,$。定义分支比$\\,b_{n} \\equiv \\Gamma_{n}/\\Gamma\\,$和$\\,b_{a} \\equiv \\Gamma_{a}/\\Gamma\\,$，且$\\,b_{n} + b_{a} = 1\\,$。设中子在$E=E_{r}$处的德布罗意波长为$\\,\\lambda\\,$，并定义相应的波数为$\\,k_{r} = 2\\pi/\\lambda\\,$。假设共振是孤立的（无干涉或背景势散射），忽略多普勒展宽和仪器分辨率，并将$\\,k\\,$在窄共振范围内视为常数（等于$\\,k_{r}$）。\n\n从复合核形成中的共振散射和单能级共振图像的第一性原理出发，推导并计算：\n- 在$E=E_r$处的峰值吸收截面$\\,\\sigma_{a}^{\\text{peak}}\\,$，以及\n- 能量积分面积$\\,\\int_{-\\infty}^{+\\infty} \\sigma_{a}(E)\\, \\mathrm{d}E\\,$。\n\n将两个结果表示为以$\\,\\lambda\\,$, $\\,\\Gamma\\,$, $\\,g\\,$, $\\,b_{n}\\,$和$\\,b_{a}\\,$表示的闭合形式解析表达式。截面使用平方米单位，能量使用电子伏特单位，因此积分面积的单位为平方米-电子伏特。不要代入数值；无需四舍五入。请将您的最终答案以两个表达式的形式单行给出，顺序如上所述。",
            "solution": "该问题是有效的，因为它科学地基于核共振理论的原理，具有完整且一致的参数集，问题本身是适定的，并且表述客观。因此，我们可以进行推导。\n\n推导从吸收截面$\\sigma_a(E)$的单能级Breit-Wigner公式开始。对于由入射粒子引发、在孤立共振处形成复合核的反应，从一个入射道（此处为中子，用下标“n”表示）到一个特定出射道（此处为吸收，用下标“a”表示）的截面由量子散射理论给出如下：\n$$\n\\sigma_a(E) = g \\frac{\\pi}{k^2} \\frac{\\Gamma_n \\Gamma_a}{(E - E_r)^2 + (\\Gamma/2)^2}\n$$\n其中：\n- $E$ 是入射中子的能量。\n- $k$ 是中子波数，与其动能相关。\n- $g$ 是自旋统计因子，它考虑了中子、靶核和复合核态的自旋。\n- $E_r$ 是共振能量。\n- $\\Gamma$ 是共振能级的总宽度，是所有部分宽度之和。\n- $\\Gamma_n$ 是中子入射道（弹性散射）的部分宽度。\n- $\\Gamma_a$ 是所有吸收出射道（例如辐射俘获、裂变）的部分宽度。\n- 我们已知 $\\Gamma = \\Gamma_n + \\Gamma_a$。\n\n问题陈述了几个简化假设。该共振是针对s波中子（$\\ell=0$）。中子波数$k$在窄共振范围内被视为常数，等于其在共振峰值处的值$k_r$。中子在$E=E_r$处的德布罗意波长为$\\lambda$，相应的波数定义为$k_r = 2\\pi/\\lambda$。我们用它来替换公式中依赖于$k$的项：\n$$\n\\frac{\\pi}{k^2} \\approx \\frac{\\pi}{k_r^2} = \\frac{\\pi}{(2\\pi/\\lambda)^2} = \\frac{\\pi \\lambda^2}{4\\pi^2} = \\frac{\\lambda^2}{4\\pi}\n$$\n将此代入Breit-Wigner公式，得到在给定假设下作为能量函数的吸收截面：\n$$\n\\sigma_a(E) = g \\frac{\\lambda^2}{4\\pi} \\frac{\\Gamma_n \\Gamma_a}{(E - E_r)^2 + (\\Gamma/2)^2}\n$$\n\n首先，我们计算峰值吸收截面$\\sigma_a^{\\text{peak}}$。这是截面在共振能量$E=E_r$处的值。在此能量下，洛伦兹项$(E - E_r)^2 + (\\Gamma/2)^2$的分母达到最小值：\n$$\n(E_r - E_r)^2 + (\\Gamma/2)^2 = 0^2 + (\\Gamma/2)^2 = \\frac{\\Gamma^2}{4}\n$$\n将此代入$\\sigma_a(E)$的表达式中：\n$$\n\\sigma_a^{\\text{peak}} = \\sigma_a(E=E_r) = g \\frac{\\lambda^2}{4\\pi} \\frac{\\Gamma_n \\Gamma_a}{(\\Gamma/2)^2} = g \\frac{\\lambda^2}{4\\pi} \\frac{4 \\Gamma_n \\Gamma_a}{\\Gamma^2} = \\frac{g \\lambda^2}{\\pi} \\frac{\\Gamma_n \\Gamma_a}{\\Gamma^2}\n$$\n问题要求结果用分支比$b_n \\equiv \\Gamma_n/\\Gamma$和$b_a \\equiv \\Gamma_a/\\Gamma$来表示。我们可以将依赖于宽度的项重写为：\n$$\n\\frac{\\Gamma_n \\Gamma_a}{\\Gamma^2} = \\left(\\frac{\\Gamma_n}{\\Gamma}\\right) \\left(\\frac{\\Gamma_a}{\\Gamma}\\right) = b_n b_a\n$$\n因此，峰值吸收截面为：\n$$\n\\sigma_a^{\\text{peak}} = \\frac{g \\lambda^2}{\\pi} b_n b_a\n$$\n\n其次，我们计算吸收截面的能量积分面积$\\int_{-\\infty}^{+\\infty} \\sigma_a(E)\\, \\mathrm{d}E$。问题陈述忽略多普勒展宽，因此我们对上面推导出的$\\sigma_a(E)$的纯洛伦兹形式进行积分。将积分限扩展到$\\pm\\infty$是对于远离零能量的窄共振的标准近似。\n$$\n\\int_{-\\infty}^{+\\infty} \\sigma_a(E)\\, \\mathrm{d}E = \\int_{-\\infty}^{+\\infty} g \\frac{\\lambda^2}{4\\pi} \\frac{\\Gamma_n \\Gamma_a}{(E - E_r)^2 + (\\Gamma/2)^2} \\, \\mathrm{d}E\n$$\n不依赖于积分变量$E$的项可以从积分中提出：\n$$\n\\int_{-\\infty}^{+\\infty} \\sigma_a(E)\\, \\mathrm{d}E = g \\frac{\\lambda^2 \\Gamma_n \\Gamma_a}{4\\pi} \\int_{-\\infty}^{+\\infty} \\frac{1}{(E - E_r)^2 + (\\Gamma/2)^2} \\, \\mathrm{d}E\n$$\n为了求解该积分，我们进行换元。令$x = E - E_r$，则$\\mathrm{d}x = \\mathrm{d}E$。积分限保持从$-\\infty$到$+\\infty$。令$c = \\Gamma/2$。积分变为：\n$$\n\\int_{-\\infty}^{+\\infty} \\frac{1}{x^2 + c^2} \\, \\mathrm{d}x = \\left[ \\frac{1}{c} \\arctan\\left(\\frac{x}{c}\\right) \\right]_{-\\infty}^{+\\infty}\n$$\n在积分限处计算表达式的值：\n$$\n\\frac{1}{c} \\left( \\lim_{x\\to\\infty} \\arctan\\left(\\frac{x}{c}\\right) - \\lim_{x\\to-\\infty} \\arctan\\left(\\frac{x}{c}\\right) \\right) = \\frac{1}{c} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{\\pi}{c}\n$$\n代回$c = \\Gamma/2$，积分的值为$\\frac{\\pi}{\\Gamma/2} = \\frac{2\\pi}{\\Gamma}$。\n现在，我们将此结果代回到积分面积的表达式中：\n$$\n\\int_{-\\infty}^{+\\infty} \\sigma_a(E)\\, \\mathrm{d}E = g \\frac{\\lambda^2 \\Gamma_n \\Gamma_a}{4\\pi} \\left( \\frac{2\\pi}{\\Gamma} \\right) = \\frac{g \\lambda^2 \\Gamma_n \\Gamma_a}{2\\Gamma}\n$$\n最后，我们用所需的变量$\\lambda$, $\\Gamma$, $g$, $b_n$和$b_a$来表示这个结果。我们使用定义$\\Gamma_n = \\Gamma b_n$和$\\Gamma_a = \\Gamma b_a$：\n$$\n\\frac{g \\lambda^2 \\Gamma_n \\Gamma_a}{2\\Gamma} = \\frac{g \\lambda^2 (\\Gamma b_n)(\\Gamma b_a)}{2\\Gamma} = \\frac{g \\lambda^2 \\Gamma^2 b_n b_a}{2\\Gamma} = \\frac{g \\lambda^2 \\Gamma}{2} b_n b_a\n$$\n这就是能量积分吸收截面的最终表达式。\n\n所求的两个量是：\n1. 峰值吸收截面：$\\sigma_a^{\\text{peak}} = \\frac{g \\lambda^2}{\\pi} b_n b_a$\n2. 能量积分面积：$\\int_{-\\infty}^{+\\infty} \\sigma_a(E)\\, \\mathrm{d}E = \\frac{g \\lambda^2 \\Gamma}{2} b_n b_a$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{g \\lambda^2}{\\pi} b_n b_a  \\frac{g \\lambda^2 \\Gamma}{2} b_n b_a \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在真实的反应堆环境中，靶核的热运动会改变中子感受到的相对能量，导致共振峰发生“多普勒展宽”。这个实践  引导您通过数值计算，量化比较理想的洛伦兹线型与经过多普勒展宽的福格特线型在自屏效应计算中的差异。通过编写代码来评估窄共振近似 (NRA) 带来的误差，您将直观地理解温度如何影响有效截面，以及为何在精确的反应堆分析中必须考虑多普勒效应。",
            "id": "4245987",
            "problem": "题目要求您在慢化剂-吸收剂混合物中单个孤立吸收共振的共振自屏背景下，评估窄共振近似的影响。请在能量域中以电子伏特为单位进行计算，并使用以下物理上合理的建模假设和定义。\n\n从以下基础出发，这在慢化理论和单能级共振模型中被广泛使用：\n\n- 单能级共振吸收截面可以用一个以能量 $E_0$ 为中心、半高全宽为 $\\Gamma$、中心峰高为 $\\sigma_{\\text{peak}}$（以靶为单位）的洛伦兹函数来近似。记 $\\gamma = \\Gamma/2$，未展宽的共振吸收截面为\n$$\n\\sigma_{\\text{L}}(E) = \\sigma_{\\text{peak}} \\frac{\\gamma^2}{(E - E_0)^2 + \\gamma^2}.\n$$\n\n- 靶核的热运动会引入多普勒展宽。将多普勒核函数建模为能量上标准差为 $\\sigma_{\\text{D}}$ 的高斯函数，通过洛伦兹函数与高斯函数的卷积，得到多普勒展宽后的共振。其结果线型是伏伊特函数。令 $x = E - E_0$。面积归一化的伏伊特函数为\n$$\nV(x; \\sigma, \\gamma) = \\frac{\\Re\\!\\left[w\\!\\left(\\frac{x + i \\gamma}{\\sigma \\sqrt{2}}\\right)\\right]}{\\sigma \\sqrt{2\\pi}},\n$$\n其中 $w(z)$ 是法捷耶娃函数，$\\Re[\\cdot]$ 表示实部。为保持共振面积不变，定义展宽后的吸收截面为\n$$\n\\sigma_{\\text{V}}(E) = A_{\\text{L}}\\, V(E - E_0; \\sigma_{\\text{D}}, \\gamma),\n\\quad\\text{其中}\\quad\nA_{\\text{L}} = \\pi \\gamma \\sigma_{\\text{peak}}.\n$$\n根据此构造，$\\int_{-\\infty}^{\\infty} \\sigma_{\\text{V}}(E)\\, dE = \\int_{-\\infty}^{\\infty} \\sigma_{\\text{L}}(E)\\, dE$ 成立，且在极限情况 $\\sigma_{\\text{D}} \\to 0$ 下，有 $\\sigma_{\\text{V}}(E) \\to \\sigma_{\\text{L}}(E)$。\n\n- 在一个简化的慢化机制中，包含共振的窄能量窗内的本底截面 $\\sigma_{\\text{b}}$（靶）为常数，此时局部中子通量与总截面成反比。在共振窗内，将总截面近似为 $\\sigma_{\\text{b}} + \\sigma(E)$，则能量区间 $[E_{\\text{low}}, E_{\\text{high}}]$ 上的自屏的、通量加权的有效共振吸收截面定义为\n$$\n\\sigma_{\\text{eff}} = \\frac{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\sigma(E)\\, \\phi(E)\\, dE}{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\phi(E)\\, dE},\n\\quad\\text{其中}\\quad\n\\phi(E) \\propto \\frac{1}{\\sigma_{\\text{b}} + \\sigma(E)}.\n$$\n任何比例常数在比值中都会被消去。这为共振能区的自屏现象提供了一个基于第一性原理的、有物理基础的模型。\n\n为本问题之目的，将窄共振近似 (NRA) 定义为忽略多普勒展宽的近似，即使用 $\\sigma(E) = \\sigma_{\\text{L}}(E)$ 来计算 $\\sigma_{\\text{eff}}$。参考的“数值展宽自屏”结果使用 $\\sigma(E) = \\sigma_{\\text{V}}(E)$ 和给定的多普勒宽度 $\\sigma_{\\text{D}}$。\n\n对于下方的每个测试用例，计算窄共振近似相对于展宽参考值的相对误差，定义为无量纲量\n$$\n\\varepsilon = \\frac{\\sigma_{\\text{eff}}^{\\text{NRA}} - \\sigma_{\\text{eff}}^{\\text{broadened}}}{\\sigma_{\\text{eff}}^{\\text{broadened}}}.\n$$\n\n所有能量必须以电子伏特 ($\\mathrm{eV}$) 为单位处理。所有截面必须以靶 (barns) 为单位处理。温度以开尔文 ($\\mathrm{K}$) 给出，仅为提供背景信息；多普勒宽度 $\\sigma_{\\text{D}}$ 对每个用例都直接以 $\\mathrm{eV}$ 为单位提供，且必须按给定值使用。本问题不涉及角度。您的程序必须对所需的能量积分进行数值计算。\n\n测试组（每个元组为 $(E_0, \\Gamma, \\sigma_{\\text{peak}}, \\sigma_{\\text{b}}, \\sigma_{\\text{D}}, E_{\\text{low}}, E_{\\text{high}}, T)$，单位如指定）：\n- 用例 1（中等自屏，可分辨共振）：$(6.67, 0.025, 5000.0, 2.0, 0.15, 6.0, 7.5, 900)$。\n- 用例 2（大本底截面，自屏效应减弱）：$(6.67, 0.025, 5000.0, 100.0, 0.15, 6.0, 7.5, 900)$。\n- 用例 3（无多普勒展宽，检查极限行为）：$(20.0, 0.2, 800.0, 5.0, 0.0, 18.0, 22.0, 300)$。\n- 用例 4（极窄的热共振，强自屏）：$(0.3, 0.001, 12000.0, 0.5, 0.05, 0.1, 0.5, 600)$。\n\n您的程序应生成单行输出，其中包含这四个用例的相对误差，形式为方括号括起来的逗号分隔列表，每个浮点数四舍五入到六位小数（例如，$[0.123456,-0.000001,0.000000,0.987654]$）。最终答案是如上文 $\\varepsilon$ 定义的无单位小数值。",
            "solution": "该问题已经过验证，是计算核反应堆物理学中一个适定的、有科学依据的练习。它要求数值评估多普勒展宽对共振自屏的影响。\n\n### 1. 理论框架\n\n问题的核心在于比较两种有效共振吸收截面 $\\sigma_{\\text{eff}}$ 的模型。这个量代表在指定能量范围内的通量加权平均截面，它考虑了自屏现象。\n\n**a. 共振截面线型**\n\n- **洛伦兹（自然）线型：** 对于单个孤立共振，其固有的、依赖能量的吸收截面由单能级布莱特-维格纳公式描述，该公式具有洛伦兹形状。其形式为：\n$$\n\\sigma_{\\text{L}}(E) = \\sigma_{\\text{peak}} \\frac{\\gamma^2}{(E - E_0)^2 + \\gamma^2}\n$$\n其中 $E_0$ 是共振能量，$\\sigma_{\\text{peak}}$ 是截面峰值，$\\gamma = \\Gamma/2$ 是半高半宽。\n\n- **伏伊特（多普勒展宽）线型：** 在有限温度的物理介质中，靶核处于热运动状态。这种运动会引起入射中子在原子核看来表观能量上的多普勒频移。对原子核速度的麦克斯韦分布进行平均，会将洛伦兹线型与一个高斯函数进行卷积。最终得到的形状是伏伊特线型。问题提供了面积守恒的公式：\n$$\n\\sigma_{\\text{V}}(E) = A_{\\text{L}}\\, V(E - E_0; \\sigma_{\\text{D}}, \\gamma)\n$$\n这里，$A_{\\text{L}} = \\pi \\gamma \\sigma_{\\text{peak}}$ 是洛伦兹曲线下的面积，在展宽过程中保持守恒。$\\sigma_{\\text{D}}$ 项是高斯多普勒核函数的标准差，$V(x; \\sigma_{\\text{D}}, \\gamma)$ 是面积归一化的伏伊特函数，使用法捷耶娃函数 $w(z)$ 定义：\n$$\nV(x; \\sigma, \\gamma) = \\frac{\\Re\\!\\left[w\\!\\left(\\frac{x + i \\gamma}{\\sigma \\sqrt{2}}\\right)\\right]}{\\sigma \\sqrt{2\\pi}}\n$$\n在多普勒宽度趋于零 ($\\sigma_{\\text{D}} \\to 0$) 的极限下，伏伊特线型 $\\sigma_{\\text{V}}(E)$ 收敛于洛伦兹线型 $\\sigma_{\\text{L}}(E)$。\n\n**b. 自屏与有效截面**\n\n共振自屏是通量凹陷的结果。在吸收截面 $\\sigma(E)$ 很大的能量处，中子被优先吸收，导致局部中子通量 $\\phi(E)$ 出现凹陷。对于均匀混合物中此效应的一个标准模型是：\n$$\n\\phi(E) \\propto \\frac{1}{\\sigma_{\\text{total}}(E)} \\approx \\frac{1}{\\sigma_{\\text{b}} + \\sigma(E)}\n$$\n其中 $\\sigma_{\\text{b}}$ 是每个吸收剂原子的恒定本底截面。\n\n有效截面 $\\sigma_{\\text{eff}}$ 是 $\\sigma(E)$ 以此凹陷的通量为权重的平均值，以确保总反应率守恒。它通过两个积分的比值计算得出：\n$$\n\\sigma_{\\text{eff}} = \\frac{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\sigma(E) \\phi(E) dE}{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\phi(E) dE} = \\frac{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\frac{\\sigma(E)}{\\sigma_{\\text{b}} + \\sigma(E)} dE}{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\frac{1}{\\sigma_{\\text{b}} + \\sigma(E)} dE}\n$$\n这些积分通常没有闭合形式的解析解，必须进行数值计算。\n\n### 2. 计算步骤\n\n为求得相对误差 $\\varepsilon$，我们必须使用近似和参考两种截面模型来计算 $\\sigma_{\\text{eff}}$。\n\n**a. 展宽后的有效截面 ($\\sigma_{\\text{eff}}^{\\text{broadened}}$)**\n这是参考计算，它使用物理上精确的多普勒展宽截面 $\\sigma(E) = \\sigma_{\\text{V}}(E)$。该计算需要数值计算：\n$$\n\\sigma_{\\text{eff}}^{\\text{broadened}} = \\frac{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\frac{\\sigma_{\\text{V}}(E)}{\\sigma_{\\text{b}} + \\sigma_{\\text{V}}(E)} dE}{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\frac{1}{\\sigma_{\\text{b}} + \\sigma_{\\text{V}}(E)} dE}\n$$\n对于 $\\sigma_{\\text{D}} = 0$ 的特殊情况，我们设定 $\\sigma_{\\text{V}}(E) = \\sigma_{\\text{L}}(E)$。\n\n**b. 窄共振近似 ($\\sigma_{\\text{eff}}^{\\text{NRA}}$)**\n此近似（如问题所定义）忽略了多普勒展宽，因此我们使用自然线型 $\\sigma(E) = \\sigma_{\\text{L}}(E)$。计算如下：\n$$\n\\sigma_{\\text{eff}}^{\\text{NRA}} = \\frac{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\frac{\\sigma_{\\text{L}}(E)}{\\sigma_{\\text{b}} + \\sigma_{\\text{L}}(E)} dE}{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\frac{1}{\\sigma_{\\text{b}} + \\sigma_{\\text{L}}(E)} dE}\n$$\n\n**c. 相对误差 ($\\varepsilon$)**\n最后一步是使用所提供的定义计算相对误差：\n$$\n\\varepsilon = \\frac{\\sigma_{\\text{eff}}^{\\text{NRA}} - \\sigma_{\\text{eff}}^{\\text{broadened}}}{\\sigma_{\\text{eff}}^{\\text{broadened}}}\n$$\n多普勒展宽会降低共振的峰值并加宽其底部。在自屏情景下（低 $\\sigma_{\\text{b}}$），峰值处的吸收已经饱和。展宽使得共振更宽的翼部暴露在更高、凹陷程度较低的通量中，这通常会增加总体的有效吸收。因此，我们预期 $\\sigma_{\\text{eff}}^{\\text{broadened}} > \\sigma_{\\text{eff}}^{\\text{NRA}}$，这将导致一个负误差 $\\varepsilon$。\n\n### 3. 实现细节\n\n该解答将用 Python 实现。\n- 数值积分将使用 `scipy.integrate` 中的 `quad` 函数执行，该函数提供稳健且准确的数值积分。\n- 伏伊特线型所需的法捷耶娃函数 $w(z)$ 将使用 `scipy.special` 中的 `wofz` 函数进行计算。\n- 将设计一个通用函数来计算 $\\sigma_{\\text{eff}}$，该函数接受适当的截面函数（$\\sigma_{\\text{L}}$ 或 $\\sigma_{\\text{V}}$）作为参数。\n- 主程序将遍历每个测试用例，执行 $\\sigma_{\\text{eff}}$ 的两种计算，计算相对误差，并存储结果。\n- 对于 $\\sigma_{\\text{D}} = 0$ 的情况将进行明确处理，以确保 $\\varepsilon = 0$ 并避免如除以零之类的数值问题。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import wofz\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the resonance self-shielding problem by calculating the relative\n    error of the Narrow Resonance Approximation (NRA) with respect to a\n    Doppler-broadened reference calculation.\n    \"\"\"\n\n    # Test suite from the problem statement.\n    # Format: (E0, Gamma, sigma_peak, sigma_b, sigma_D, E_low, E_high, T)\n    test_cases = [\n        (6.67, 0.025, 5000.0, 2.0, 0.15, 6.0, 7.5, 900),\n        (6.67, 0.025, 5000.0, 100.0, 0.15, 6.0, 7.5, 900),\n        (20.0, 0.2, 800.0, 5.0, 0.0, 18.0, 22.0, 300),\n        (0.3, 0.001, 12000.0, 0.5, 0.05, 0.1, 0.5, 600),\n    ]\n\n    def sigma_lorentzian(E, E0, gamma, sigma_peak):\n        \"\"\"Calculates the Lorentzian (unbroadened) cross section.\"\"\"\n        return sigma_peak * (gamma**2) / ((E - E0)**2 + gamma**2)\n\n    def sigma_voigt(E, E0, gamma, sigma_peak, sigma_D):\n        \"\"\"Calculates the Voigt (Doppler-broadened) cross section.\"\"\"\n        # Calculate the resonance area to preserve it.\n        area_L = np.pi * gamma * sigma_peak\n        \n        # Argument for the Fadeeva function.\n        z = (E - E0 + 1j * gamma) / (sigma_D * np.sqrt(2.0))\n        \n        # Area-normalized Voigt function V(E-E0; sigma_D, gamma).\n        # V = Re[w(z)] / (sigma_D * sqrt(2*pi))\n        voigt_func_val = np.real(wofz(z)) / (sigma_D * np.sqrt(2.0 * np.pi))\n        \n        return area_L * voigt_func_val\n\n    def calculate_effective_xs(xs_func, E_low, E_high, sigma_b, *xs_args):\n        \"\"\"\n        Calculates the self-shielded effective cross section for a given\n        cross section function (xs_func) over an energy interval.\n        \"\"\"\n        # Define the integrand for the numerator of the sigma_eff expression.\n        def numerator_integrand(E):\n            xs_val = xs_func(E, *xs_args)\n            return xs_val / (sigma_b + xs_val)\n\n        # Define the integrand for the denominator of the sigma_eff expression.\n        def denominator_integrand(E):\n            xs_val = xs_func(E, *xs_args)\n            return 1.0 / (sigma_b + xs_val)\n\n        # Use high-precision numerical integration.\n        num_integral, _ = quad(numerator_integrand, E_low, E_high, epsabs=1.49e-12, epsrel=1.49e-12)\n        den_integral, _ = quad(denominator_integrand, E_low, E_high, epsabs=1.49e-12, epsrel=1.49e-12)\n\n        # Avoid division by zero, although physically unlikely for this problem.\n        if abs(den_integral)  1e-15:\n            return 0.0\n        \n        return num_integral / den_integral\n\n    results = []\n    for case in test_cases:\n        E0, Gamma, sigma_peak, sigma_b, sigma_D, E_low, E_high, _ = case\n        gamma = Gamma / 2.0\n\n        # --- 1. Calculate the NRA effective cross section ---\n        xs_args_lor = (E0, gamma, sigma_peak)\n        sigma_eff_nra = calculate_effective_xs(\n            sigma_lorentzian, E_low, E_high, sigma_b, *xs_args_lor\n        )\n\n        # --- 2. Calculate the Broadened effective cross section ---\n        # Handle the limiting case of zero Doppler broadening.\n        # In this limit, the Voigt profile becomes the Lorentzian profile.\n        if sigma_D  1e-9:\n            sigma_eff_broadened = sigma_eff_nra\n        else:\n            xs_args_voigt = (E0, gamma, sigma_peak, sigma_D)\n            sigma_eff_broadened = calculate_effective_xs(\n                sigma_voigt, E_low, E_high, sigma_b, *xs_args_voigt\n            )\n\n        # --- 3. Calculate the relative error ---\n        if abs(sigma_eff_broadened)  1e-12:\n            # If the broadened result is effectively zero, the NRA result\n            # should also be zero, so the error is zero.\n            epsilon = 0.0\n        else:\n            epsilon = (sigma_eff_nra - sigma_eff_broadened) / sigma_eff_broadened\n        \n        results.append(epsilon)\n\n    # Format the final output string as specified.\n    output_str = f\"[{','.join([f'{r:.6f}' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "从连续能量的核数据到多群常数库是反应堆确定论计算的关键步骤，而共振自屏效应的处理正是其中的核心挑战。这个实践  聚焦于 Bondarenko 因子方法，它是在多群框架下处理自屏效应的工业标准。您将通过编程实现，研究不同参考能谱（如 UOX 与 MOX 反应堆的能谱）对 Bondarenko 因子的影响，并量化由此产生的群截面偏差，从而深刻理解在生成和应用多群数据库时谱失配问题的实际重要性。",
            "id": "4246007",
            "problem": "您的任务是量化参考中子谱 $\\phi_{0}(E)$ 的选择对单个吸收体核素的邦达连科自屏方法因子的影响，并计算当真实系统谱与参考谱不同时，自屏多群吸收截面 $\\sigma_{g}$ 中产生的偏差。此任务必须从第一性原理出发，按如下方式解决。\n\n从以下两个基本依据出发：\n- 群平均截面在能量 $E$ 上的定义，\n$$\n\\sigma_{g} \\equiv \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi(E)\\,\\sigma(E)\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi(E)\\,dE},\n$$\n其中 $\\phi(E)$ 是中子通量形状，$\\sigma(E)$ 是微观吸收截面。\n- 背景截面窄共振通量形状模型（共振自屏中的一个标准方法），该模型将稀释截面 $D$（单位为靶恩）下的能量相关通量视为与以下表达式成正比：\n$$\n\\phi(E;D) \\propto \\frac{\\phi_{0}(E)}{\\sigma(E)+D}.\n$$\n\n基于这些，推导在给定 $D$ 和参考谱 $\\phi_{0}(E)$ 下的一致性自屏群截面，\n$$\n\\sigma_{g}^{\\text{ref}}(D) = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,\\dfrac{\\sigma(E)}{\\sigma(E)+D}\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,\\dfrac{1}{\\sigma(E)+D}\\,dE},\n$$\n以及使用相同参考谱的无限稀释群截面，\n$$\n\\sigma_{g}^{\\infty,\\text{ref}} = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,\\sigma(E)\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,dE}.\n$$\n将邦达连科自屏因子定义为\n$$\nB_{g}^{\\text{ref}}(D) \\equiv \\frac{\\sigma_{g}^{\\text{ref}}(D)}{\\sigma_{g}^{\\infty,\\text{ref}}}.\n$$\n\n为量化谱失配偏差，定义一个真实系统谱 $\\phi_{\\text{true}}(E)$，并计算相应的一致性自屏群截面\n$$\n\\sigma_{g}^{\\text{true}}(D) = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{\\text{true}}(E)\\,\\dfrac{\\sigma(E)}{\\sigma(E)+D}\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{\\text{true}}(E)\\,\\dfrac{1}{\\sigma(E)+D}\\,dE}.\n$$\n对于任何选定的参考谱 $\\phi_{0}(E)$，以靶恩为单位的绝对偏差为\n$$\n\\Delta\\sigma_{g}^{\\text{ref}}(D) \\equiv \\sigma_{g}^{\\text{ref}}(D) - \\sigma_{g}^{\\text{true}}(D).\n$$\n\n实现一个程序，使用以下科学上合理且完全指定的输入来近似单个吸收体的可分辨共振能区：\n\n- 能量网格：在 $E_{\\min} = 10^{0}\\,\\text{eV}$ 到 $E_{\\max} = 10^{4}\\,\\text{eV}$ 之间对数等距分布，使用 $N = 20000$ 个点。\n\n- 吸收截面模型（单位为靶恩），为一个 $1/v$ 尾部和几个洛伦兹共振峰之和，\n$$\n\\sigma(E) = \\frac{A_{v}}{\\sqrt{E}} + \\sum_{i=1}^{5} A_{i}\\,\\frac{\\left(\\dfrac{\\Gamma_{i}}{2}\\right)^{2}}{(E - E_{i})^{2} + \\left(\\dfrac{\\Gamma_{i}}{2}\\right)^{2}},\n$$\n系数如下\n$\nA_{v} = 2.0,\n$\n$\n\\{E_{i}\\}_{i=1}^{5} = \\{6.67,\\,20.9,\\,36.7,\\,66.0,\\,96.7\\}\\,\\text{eV},\n$\n$\n\\{\\Gamma_{i}\\}_{i=1}^{5} = \\{0.30,\\,0.50,\\,1.00,\\,2.00,\\,3.00\\}\\,\\text{eV},\n$\n$\n\\{A_{i}\\}_{i=1}^{5} = \\{2000,\\,800,\\,500,\\,300,\\,200\\}\\,\\text{barns}.\n$\n\n- 参考谱（非归一化形状是可接受的，因为归一化因子在比率中会抵消）：\n  - 类似氧化铀（UOX）的超热中子参考谱：$\\phi_{0}^{\\text{UOX}}(E) \\propto E^{-1.0}$。\n  - 类似混合氧化物（MOX）的更硬的超热中子参考谱：$\\phi_{0}^{\\text{MOX}}(E) \\propto E^{-0.8}$。\n\n- 用于偏差量化的真实系统谱：$\\phi_{\\text{true}}(E) \\propto E^{-0.9}$。\n\n- 测试套件（稀释截面，单位为靶恩），以覆盖不同的屏蔽区域：\n  - 强自屏：$D_{1} = 1.0$。\n  - 中等自屏：$D_{2} = 100.0$。\n  - 接近无限稀释：$D_{3} = 10^{6}$。\n\n数值积分必须使用一致的求积规则在指定的网格上完成。所有截面必须以靶恩为单位计算。不使用角度。对于每个稀释度 $D_{k}$（其中 $k \\in \\{1,2,3\\}$），程序必须计算：\n- MOX 和 UOX 参考谱下的邦达连科因子之差，\n$\n\\Delta B(D_{k}) \\equiv B_{g}^{\\text{MOX}}(D_{k}) - B_{g}^{\\text{UOX}}(D_{k}),\n$\n无量纲。\n- 使用 UOX 参考谱相对于真实谱时，群吸收截面的绝对偏差（单位为靶恩），\n$\n\\Delta\\sigma_{g}^{\\text{UOX}}(D_{k}),\n$\n单位为靶恩。\n- 使用 MOX 参考谱相对于真实谱时，群吸收截面的绝对偏差（单位为靶恩），\n$\n\\Delta\\sigma_{g}^{\\text{MOX}}(D_{k}),\n$\n单位为靶恩。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，顺序如下：\n$\n[\\Delta B(D_{1}),\\,\\Delta\\sigma_{g}^{\\text{UOX}}(D_{1}),\\,\\Delta\\sigma_{g}^{\\text{MOX}}(D_{1}),\\,\\Delta B(D_{2}),\\,\\Delta\\sigma_{g}^{\\text{UOX}}(D_{2}),\\,\\Delta\\sigma_{g}^{\\text{MOX}}(D_{2}),\\,\\Delta B(D_{3}),\\,\\Delta\\sigma_{g}^{\\text{UOX}}(D_{3}),\\,\\Delta\\sigma_{g}^{\\text{MOX}}(D_{3})].\n$\n- 将 $\\Delta B(D_{k})$ 表示为无量纲浮点数，保留六位小数；将 $\\Delta\\sigma_{g}^{\\text{UOX}}(D_{k})$ 和 $\\Delta\\sigma_{g}^{\\text{MOX}}(D_{k})$ 以靶恩为单位表示，保留六位小数。\n- 输出中不允许有多余的文本。\n\n您的实现必须是自包含的，且不需要外部输入。仅使用所提供的参数。所有涉及截面的物理量必须以靶恩处理，所有能量必须以电子伏特（eV）处理。积分必须遵守给定的能量界限（以 eV 为单位）。程序必须用通用的现代语言编写，并且可以使用标准的数值库进行积分和数组操作，前提是最终输出格式与上述规定完全一致。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于核反应堆物理学原理，特别是共振自屏理论。该问题定义明确、客观、自包含且计算上可行。所有定义、参数和目标都已足够清晰和精确地指定，可以得出一个唯一且有意义的解。\n\n任务是量化在邦达连科自屏因子方法中因选择参考谱而产生的多群截面偏差。这将通过从第一性原理推导必要的公式，然后针对指定的测试案例进行数值实现来完成。\n\n我们从提供的两个基本定义开始。首先，对于暴露于中子通量 $\\phi(E)$ 中、微观截面为 $\\sigma(E)$ 的材料，其在能量群 $[E_{\\min}, E_{\\max}]$ 上的群平均截面 $\\sigma_g$ 的定义为：\n$$\n\\sigma_{g} \\equiv \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi(E)\\,\\sigma(E)\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi(E)\\,dE}\n$$\n该方程将群截面定义为每个原子的反应率，对能量相关的中子通量进行平均。\n\n其次，我们对包含共振吸收体的燃料块内的通量形状使用窄共振（NR）近似。该模型指出，在吸收截面 $\\sigma(E)$ 高的能量处，通量 $\\phi(E; D)$ 会被“压低”。它被给定为与一个平滑的背景通量 $\\phi_0(E)$ 成正比，除以总截面，总截面近似为 $\\sigma(E) + D$，其中 $D$ 是一个有效稀释截面，代表与吸收体混合的所有其他材料。\n$$\n\\phi(E;D) \\propto \\frac{\\phi_{0}(E)}{\\sigma(E)+D}\n$$\n设比例常数为 $C$。将此通量形状 $\\phi(E;D) = C \\frac{\\phi_{0}(E)}{\\sigma(E)+D}$ 代入 $\\sigma_g$ 的定义，得到给定参考谱 $\\phi_0(E)$ 的自屏群截面 $\\sigma_g^{\\text{ref}}(D)$：\n$$\n\\sigma_{g}^{\\text{ref}}(D) = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\left( C \\frac{\\phi_{0}(E)}{\\sigma(E)+D} \\right) \\sigma(E)\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\left( C \\frac{\\phi_{0}(E)}{\\sigma(E)+D} \\right) dE}\n$$\n常数 $C$ 被消去，得到与 NR 模型一致的自屏群截面表达式：\n$$\n\\sigma_{g}^{\\text{ref}}(D) = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,\\dfrac{\\sigma(E)}{\\sigma(E)+D}\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,\\dfrac{1}{\\sigma(E)+D}\\,dE}\n$$\n无限稀释群截面 $\\sigma_{g}^{\\infty,\\text{ref}}$ 代表吸收体非常稀疏（$D \\to \\infty$）以至于不扰动背景通量的情况。在此极限下，通量形状 $\\phi(E; D)$ 简化为参考通量 $\\phi_0(E)$。将此应用于 $\\sigma_g$ 的基本定义可得：\n$$\n\\sigma_{g}^{\\infty,\\text{ref}} = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,\\sigma(E)\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,dE}\n$$\n邦达连科自屏因子 $B_{g}^{\\text{ref}}(D)$ 定义为自屏截面与无限稀释截面之比。它量化了由于通量压低而导致的有效截面减小。\n$$\nB_{g}^{\\text{ref}}(D) \\equiv \\frac{\\sigma_{g}^{\\text{ref}}(D)}{\\sigma_{g}^{\\infty,\\text{ref}}}\n$$\n为了评估因参考谱选择不当而引入的误差，我们假设一个“真实”的系统谱 $\\phi_{\\text{true}}(E)$，它将产生真实的自屏截面 $\\sigma_{g}^{\\text{true}}(D)$：\n$$\n\\sigma_{g}^{\\text{true}}(D) = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{\\text{true}}(E)\\,\\dfrac{\\sigma(E)}{\\sigma(E)+D}\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{\\text{true}}(E)\\,\\dfrac{1}{\\sigma(E)+D}\\,dE}\n$$\n当使用参考谱 $\\phi_0(E)$ 而不是真实谱时，绝对偏差为以下差值：\n$$\n\\Delta\\sigma_{g}^{\\text{ref}}(D) \\equiv \\sigma_{g}^{\\text{ref}}(D) - \\sigma_{g}^{\\text{true}}(D)\n$$\n计算过程是数值地评估这些量。\n首先，我们将能量域从 $E_{\\min} = 10^0\\,\\text{eV}$ 到 $E_{\\max} = 10^4\\,\\text{eV}$ 离散化为对数网格上的 $N = 20000$ 个点，这在指定的共振峰所在的较低能量处提供了更高的分辨率。设此网格为 $\\{E_j\\}$。\n\n接下来，我们使用提供的模型在每个网格点上评估吸收截面 $\\sigma(E_j)$，该模型是一个 $1/v$ 分量和五个 Breit-Wigner（洛伦兹）共振峰之和：\n$$\n\\sigma(E) = \\frac{A_{v}}{\\sqrt{E}} + \\sum_{i=1}^{5} A_{i}\\,\\frac{\\left(\\dfrac{\\Gamma_{i}}{2}\\right)^{2}}{(E - E_{i})^{2} + \\left(\\dfrac{\\Gamma_{i}}{2}\\right)^{2}}\n$$\n参数为 $A_v = 2.0$，$\\{E_i\\} = \\{6.67, 20.9, 36.7, 66.0, 96.7\\}\\,\\text{eV}$，$\\{\\Gamma_i\\} = \\{0.30, 0.50, 1.00, 2.00, 3.00\\}\\,\\text{eV}$，以及 $\\{A_i\\} = \\{2000, 800, 500, 300, 200\\}\\,\\text{barns}$。\n\n类似地，我们在相同的能量网格上评估三个通量谱：\n-   $\\phi_0^{\\text{UOX}}(E_j) = E_j^{-1.0}$\n-   $\\phi_0^{\\text{MOX}}(E_j) = E_j^{-0.8}$\n-   $\\phi_{\\text{true}}(E_j) = E_j^{-0.9}$\n\n所有积分随后都使用梯形法则（对于精细间隔的网格，这是一种一致且稳健的求积方法）近似为网格 $\\{E_j\\}$ 上的离散和。对于任意被积函数 $f(E)$，积分为 $\\int f(E) dE \\approx \\sum_{j=1}^{N-1} \\frac{1}{2}(f(E_{j+1}) + f(E_j))(E_{j+1} - E_j)$。\n\n对于每个稀释值 $D_k \\in \\{1.0, 100.0, 10^6\\}$ 靶恩，计算以下各项：\n1.  无限稀释截面 $\\sigma_{g}^{\\infty,\\text{UOX}}$ 和 $\\sigma_{g}^{\\infty,\\text{MOX}}$。这些对所有 $D_k$ 都是常数。\n2.  自屏截面 $\\sigma_{g}^{\\text{UOX}}(D_k)$、$\\sigma_{g}^{\\text{MOX}}(D_k)$ 和 $\\sigma_{g}^{\\text{true}}(D_k)$。\n3.  邦达连科因子 $B_{g}^{\\text{UOX}}(D_k)$ 和 $B_{g}^{\\text{MOX}}(D_k)$。\n4.  最终关心的量：$\\Delta B(D_k) = B_{g}^{\\text{MOX}}(D_k) - B_{g}^{\\text{UOX}}(D_k)$，$\\Delta\\sigma_{g}^{\\text{UOX}}(D_k) = \\sigma_{g}^{\\text{UOX}}(D_k) - \\sigma_{g}^{\\text{true}}(D_k)$，以及 $\\Delta\\sigma_{g}^{\\text{MOX}}(D_k) = \\sigma_{g}^{\\text{MOX}}(D_k) - \\sigma_{g}^{\\text{true}}(D_k)$。\n\n这个系统化的过程允许直接定量比较在不同自屏区域下，使用不同标准参考谱（UOX 和 MOX）相对于已知“真实”谱所产生的影响。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes biases in Bondarenko factors and self-shielded cross sections\n    due to reference spectrum mismatch.\n    \"\"\"\n    \n    # 1. Define physical constants and problem parameters\n    E_min = 1.0  # eV\n    E_max = 1e4  # eV\n    N = 20000    # Number of grid points\n\n    # Cross section parameters\n    A_v = 2.0\n    E_resonances = np.array([6.67, 20.9, 36.7, 66.0, 96.7])      # eV\n    Gamma_widths = np.array([0.30, 0.50, 1.00, 2.00, 3.00])      # eV\n    A_amplitudes = np.array([2000.0, 800.0, 500.0, 300.0, 200.0]) # barns\n\n    # Test cases for dilution cross section D (barns)\n    test_cases = [1.0, 100.0, 1e6]\n\n    # 2. Set up energy grid and evaluate functions on the grid\n    # Logarithmic grid for better resolution at lower energies\n    E_grid = np.logspace(np.log10(E_min), np.log10(E_max), N)\n\n    # Calculate absorption cross section sigma(E) on the grid\n    sigma_E = A_v / np.sqrt(E_grid)\n    for i in range(len(E_resonances)):\n        lorentzian = A_amplitudes[i] * ((Gamma_widths[i] / 2.0)**2) / \\\n                     ((E_grid - E_resonances[i])**2 + (Gamma_widths[i] / 2.0)**2)\n        sigma_E += lorentzian\n\n    # Evaluate flux spectra phi(E) on the grid\n    phi_uox_E = E_grid**(-1.0)\n    phi_mox_E = E_grid**(-0.8)\n    phi_true_E = E_grid**(-0.9)\n\n    # 3. Define helper functions for physical quantities using numerical integration\n    def trapz_integrate(integrand, grid):\n        return np.trapz(integrand, grid)\n\n    def calculate_sigma_g(D, phi_E, sigma_E_grid, E_grid):\n        \"\"\"Calculates the self-shielded group cross section.\"\"\"\n        integrand_num = phi_E * (sigma_E_grid / (sigma_E_grid + D))\n        integrand_den = phi_E * (1.0 / (sigma_E_grid + D))\n        \n        integral_num = trapz_integrate(integrand_num, E_grid)\n        integral_den = trapz_integrate(integrand_den, E_grid)\n        \n        # Denominator will be non-zero for physical inputs\n        return integral_num / integral_den\n\n    def calculate_sigma_g_inf(phi_E, sigma_E_grid, E_grid):\n        \"\"\"Calculates the infinite-dilution group cross section.\"\"\"\n        integral_num = trapz_integrate(phi_E * sigma_E_grid, E_grid)\n        integral_den = trapz_integrate(phi_E, E_grid)\n        \n        return integral_num / integral_den\n\n    # 4. Pre-calculate quantities that do not depend on dilution D\n    sigma_g_inf_uox = calculate_sigma_g_inf(phi_uox_E, sigma_E, E_grid)\n    sigma_g_inf_mox = calculate_sigma_g_inf(phi_mox_E, sigma_E, E_grid)\n\n    # 5. Loop over test cases and compute the required quantities\n    results = []\n    for Dk in test_cases:\n        # Calculate self-shielded cross sections for current Dk\n        sigma_g_uox_Dk = calculate_sigma_g(Dk, phi_uox_E, sigma_E, E_grid)\n        sigma_g_mox_Dk = calculate_sigma_g(Dk, phi_mox_E, sigma_E, E_grid)\n        sigma_g_true_Dk = calculate_sigma_g(Dk, phi_true_E, sigma_E, E_grid)\n\n        # Calculate Bondarenko factors\n        B_g_uox_Dk = sigma_g_uox_Dk / sigma_g_inf_uox\n        B_g_mox_Dk = sigma_g_mox_Dk / sigma_g_inf_mox\n        \n        # Calculate difference in Bondarenko factors\n        delta_B_Dk = B_g_mox_Dk - B_g_uox_Dk\n        \n        # Calculate absolute biases in group cross section\n        delta_sigma_uox_Dk = sigma_g_uox_Dk - sigma_g_true_Dk\n        delta_sigma_mox_Dk = sigma_g_mox_Dk - sigma_g_true_Dk\n        \n        results.extend([delta_B_Dk, delta_sigma_uox_Dk, delta_sigma_mox_Dk])\n        \n    # 6. Format and print the final output as a single line\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}