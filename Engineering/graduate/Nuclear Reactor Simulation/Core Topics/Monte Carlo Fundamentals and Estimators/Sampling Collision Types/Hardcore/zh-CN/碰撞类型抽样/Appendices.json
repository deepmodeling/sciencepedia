{
    "hands_on_practices": [
        {
            "introduction": "在蒙特卡罗模拟中，当一个中子结束其自由飞行并发生碰撞时，我们面临的第一个基本问题是：究竟发生了哪种类型的相互作用？这个基础练习将引导你从宏观截面 $\\Sigma$ 作为单位路径长度碰撞率这第一性原理出发，推导出决定散射、俘获或裂变等不同碰撞类型的归一化概率的公式。 掌握这一核心关系，即碰撞类型 $i$ 的概率 $p_i = \\frac{\\Sigma_i}{\\Sigma_t}$，是理解和实现任何中子输运模拟的关键第一步。",
            "id": "4246721",
            "problem": "一个中子在空间均匀的材料中以固定能量输运，因此单位路径长度上的反应率是恒定的。设宏观散射截面为 $\\Sigma_{s}$，宏观俘获（非裂变吸收）截面为 $\\Sigma_{c}$，宏观裂变截面为 $\\Sigma_{f}$。宏观总截面定义为 $\\Sigma_{t}=\\Sigma_{s}+\\Sigma_{c}+\\Sigma_{f}$。在中子输运的蒙特卡罗方法中，对自由飞行结束时的碰撞类型进行抽样，是通过从散射、俘获和裂变的归一化概率中抽取样本来完成的。\n\n从宏观截面 $\\Sigma$ 代表单位路径长度上的碰撞率这一定义出发，并基于一个经过充分验证的事实，即在均匀介质中以固定能量运动时，自由飞行路径长度 $L$ 服从指数分布，其概率密度函数为 $f_{L}(\\ell)=\\Sigma_{t}\\exp(-\\Sigma_{t}\\ell)$（对于 $\\ell\\ge 0$），推导下一次碰撞类型为 $i\\in\\{s,c,f\\}$ 的归一化概率 $p_{i}$（用 $\\Sigma_{i}$ 和 $\\Sigma_{t}$ 表示）。然后，使用 $\\Sigma_{s}=0.8\\ \\mathrm{cm^{-1}}$，$\\Sigma_{c}=0.1\\ \\mathrm{cm^{-1}}$ 和 $\\Sigma_{f}=0.1\\ \\mathrm{cm^{-1}}$，计算三元组 $(p_{s},p_{c},p_{f})$ 并验证 $p_{s}+p_{c}+p_{f}=1$。将每个概率表示为小数，并将最终报告值四舍五入到四位有效数字。",
            "solution": "### 碰撞概率的推导\n基本前提是，类型为 $i$ 的反应的宏观截面 $\\Sigma_{i}$ 代表中子引起该反应的单位路径长度上的概率。这是一个率的概念。对于一个无穷小的路径长度 $d\\ell$，发生类型为 $i$ 的反应的概率 $dP_{i}$ 由下式给出：\n$$dP_{i} = \\Sigma_{i} \\, d\\ell$$\n该关系对任何反应类型 $i \\in \\{s, c, f\\}$ 都有效，其中 $s$ 表示散射，$c$ 表示俘获，$f$ 表示裂变。\n\n假设这些反应是互斥事件。发生*任何*相互作用的单位路径长度上的总概率是各个单位路径长度上概率的总和。这定义了宏观总截面 $\\Sigma_t$：\n$$\\Sigma_{t} = \\Sigma_{s} + \\Sigma_{c} + \\Sigma_{f}$$\n因此，在无穷小路径长度 $d\\ell$ 内发生*任何*相互作用的概率 $dP_{t}$ 是：\n$$dP_{t} = \\Sigma_{t} \\, d\\ell$$\n问题要求的是，在已知发生了一次碰撞的情况下，该碰撞是类型 $i$ 的归一化概率 $p_i$。这是一个条件概率。设 $A$ 为在 $d\\ell$ 内发生类型为 $i$ 的碰撞的事件，设 $B$ 为在 $d\\ell$ 内发生*任何*碰撞的事件。我们寻求概率 $p_i = P(A|B)$。\n$$p_{i} = \\frac{P(A \\cap B)}{P(B)}$$\n事件“发生类型为 $i$ 的碰撞”（$A$）是事件“发生任何碰撞”（$B$）的子集。因此，交集 $A \\cap B$ 就是事件 $A$。\n$$p_{i} = \\frac{P(A)}{P(B)} = \\frac{dP_{i}}{dP_{t}}$$\n代入用截面表示的表达式：\n$$p_{i} = \\frac{\\Sigma_{i} \\, d\\ell}{\\Sigma_{t} \\, d\\ell}$$\n微分路径长度元 $d\\ell$ 被约去，得到碰撞类型抽样概率的通用公式：\n$$p_{i} = \\frac{\\Sigma_{i}}{\\Sigma_{t}}$$\n这个结果与路径长度 $\\ell$ 无关。路径长度的指数分布 $f_{L}(\\ell)=\\Sigma_{t}\\exp(-\\Sigma_{t}\\ell)$ 是由单位长度上恒定的总相互作用概率 $\\Sigma_{t}$ 产生的。当确定在抽样路径长度的末端发生碰撞事件时，该碰撞的类型由分截面的相对大小决定，正如推导出的概率 $p_i$ 所表示的那样。\n\n### 数值计算\n给定的宏观截面数值为：\n- $\\Sigma_{s} = 0.8\\ \\mathrm{cm^{-1}}$\n- $\\Sigma_{c} = 0.1\\ \\mathrm{cm^{-1}}$\n- $\\Sigma_{f} = 0.1\\ \\mathrm{cm^{-1}}$\n\n首先，我们计算宏观总截面 $\\Sigma_{t}$：\n$$\\Sigma_{t} = \\Sigma_{s} + \\Sigma_{c} + \\Sigma_{f} = 0.8\\ \\mathrm{cm^{-1}} + 0.1\\ \\mathrm{cm^{-1}} + 0.1\\ \\mathrm{cm^{-1}} = 1.0\\ \\mathrm{cm^{-1}}$$\n现在，我们可以计算每种碰撞类型的归一化概率 $p_{s}$、$p_{c}$ 和 $p_{f}$。\n\n散射概率：\n$$p_{s} = \\frac{\\Sigma_{s}}{\\Sigma_{t}} = \\frac{0.8}{1.0} = 0.8$$\n俘获概率：\n$$p_{c} = \\frac{\\Sigma_{c}}{\\Sigma_{t}} = \\frac{0.1}{1.0} = 0.1$$\n裂变概率：\n$$p_{f} = \\frac{\\Sigma_{f}}{\\Sigma_{t}} = \\frac{0.1}{1.0} = 0.1$$\n问题要求将这些值表示为小数，并四舍五入到四位有效数字。\n- $p_{s} = 0.8000$\n- $p_{c} = 0.1000$\n- $p_{f} = 0.1000$\n\n### 验证\n最后，我们验证这些概率之和等于 $1$，这对于一个完备的概率分布是必需的。\n$$p_{s} + p_{c} + p_{f} = 0.8000 + 0.1000 + 0.1000 = 1.0000$$\n总和确实为 $1$，这证实了计算的正确性。最终得到的概率三元组是 $(p_{s}, p_{c}, p_{f}) = (0.8000, 0.1000, 0.1000)$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.8000  0.1000  0.1000 \\end{pmatrix}}$$"
        },
        {
            "introduction": "真实世界的反应堆材料，如燃料或慢化剂，几乎总是由多种核素混合而成。本练习将单核素模型扩展到更实际的二元混合物场景，你将需要推导在一次碰撞中，如何首先确定与哪种核素发生相互作用，然后进一步确定具体的反应类型。 这个过程阐明了在复杂介质中处理竞争性相互作用的通用蒙特卡罗方法，即通过各组分宏观截面在总截面中所占的比例来分配概率。",
            "id": "4246716",
            "problem": "考虑一个由两种核素混合物组成的均匀、等温的无限介质，其中一个单能中子经历自由飞行，期间穿插着瞬时碰撞。核素 $i$ 的宏观总截面定义为 $N_i\\sigma_{t,i}$，其中 $N_i$ 是核素的数密度，$\\sigma_{t,i}$ 是微观总截面。在这种介质中，由于碰撞的无记忆性，碰撞过程可以被建模为一个具有指数分布自由程的更新过程，核素 $i$ 的单位路径碰撞风险为 $N_i\\sigma_{t,i}$。在混合物中，总的碰撞风险是各个风险之和。\n\n给定一个双核素混合物，其 $N_1\\sigma_{t,1}=0.3\\ \\mathrm{cm^{-1}}$ 和 $N_2\\sigma_{t,2}=0.7\\ \\mathrm{cm^{-1}}$。对于每种核素，有两种反应道：散射和吸收，其宏观贡献满足 $N_i\\sigma_{t,i}=N_i\\sigma_{s,i}+N_i\\sigma_{a,i}$ (其中 $i\\in\\{1,2\\}$)。反应道分配如下：\n- 对于核素 $1$：$N_1\\sigma_{s,1}=0.2\\ \\mathrm{cm^{-1}}$ 和 $N_1\\sigma_{a,1}=0.1\\ \\mathrm{cm^{-1}}$。\n- 对于核素 $2$：$N_2\\sigma_{s,2}=0.5\\ \\mathrm{cm^{-1}}$ 和 $N_2\\sigma_{a,2}=0.2\\ \\mathrm{cm^{-1}}$。\n\n从混合介质中指数自由程分布的基本定义以及将宏观截面解释为单位路径碰撞风险出发，推导首次碰撞的核素选择概率以及与蒙特卡罗 (MC) 抽样一致的反应道映射。利用竞争风险的第一性原理来论证每一步。然后计算以下数值：\n1. 首次碰撞时选择核素 $1$ 和核素 $2$ 的概率。\n2. 按以下顺序，每个反应道结果的无条件概率：在核素 $1$ 上发生散射，在核素 $1$ 上发生吸收，在核素 $2$ 上发生散射，在核素 $2$ 上发生吸收。\n\n将最终答案表示为一个无量纲的行向量，其中概率按顺序排列为 $\\left(P(\\text{核素 }1),\\ P(\\text{核素 }2),\\ P(\\text{在 }1\\text{ 上散射}),\\ P(\\text{在 }1\\text{ 上吸收}),\\ P(\\text{在 }2\\text{ 上散射}),\\ P(\\text{在 }2\\text{ 上吸收})\\right)$。无需四舍五入。",
            "solution": "我们首先使用输运理论中的标准符号来形式化所提供的信息。对于核素 $i$ 的 $x$ 类型反应，其宏观截面表示为 $\\Sigma_{x,i} = N_i\\sigma_{x,i}$，其中 $N_i$ 是核素 $i$ 的数密度，$\\sigma_{x,i}$ 是相应的微观截面。反应类型包括总反应 ($t$)、散射 ($s$) 和吸收 ($a$) 。\n\n给定的数值如下：\n对于核素 $1$：\n$\\Sigma_{t,1} = 0.3\\ \\mathrm{cm^{-1}}$\n$\\Sigma_{s,1} = 0.2\\ \\mathrm{cm^{-1}}$\n$\\Sigma_{a,1} = 0.1\\ \\mathrm{cm^{-1}}$\n\n对于核素 $2$：\n$\\Sigma_{t,2} = 0.7\\ \\mathrm{cm^{-1}}$\n$\\Sigma_{s,2} = 0.5\\ \\mathrm{cm^{-1}}$\n$\\Sigma_{a,2} = 0.2\\ \\mathrm{cm^{-1}}$\n\n问题正确地指出，对于核素混合物，单位路径长度上的总相互作用概率（即混合物的总宏观截面 $\\Sigma_t$）是各独立相互作用概率之和。这是独立竞争风险可加性的直接结果。\n$$\n\\Sigma_t = \\Sigma_{t,1} + \\Sigma_{t,2}\n$$\n宏观截面 $\\Sigma_x$ 代表中子每行进单位距离发生 $x$ 类型相互作用的概率密度。在混合物中，一个中子面临多种竞争性的碰撞过程：与核素 1 碰撞，与核素 2 碰撞等。竞争风险的基本原理指出，在*某个*事件已发生的前提下，某个特定事件发生的概率是该特定事件的风险率与所有风险率之和的比值。\n\n首先，我们计算该双核素混合物的总宏观截面：\n$$\n\\Sigma_t = \\Sigma_{t,1} + \\Sigma_{t,2} = 0.3\\ \\mathrm{cm^{-1}} + 0.7\\ \\mathrm{cm^{-1}} = 1.0\\ \\mathrm{cm^{-1}}\n$$\n\n1.  **核素选择概率**\n\n与核素 $i$ 发生碰撞的事件是竞争性结果之一。此事件的风险率为 $\\Sigma_{t,i}$。任何碰撞的总风险率为 $\\Sigma_t$。因此，一次碰撞（已经发生）是与核素 $1$ 发生的概率，记为 $P(\\text{核素 }1)$，是其特定风险率与总风险率的比值：\n$$\nP(\\text{核素 }1) = \\frac{\\Sigma_{t,1}}{\\Sigma_t} = \\frac{0.3}{1.0} = 0.3\n$$\n同理，碰撞是与核素 $2$ 发生的概率为：\n$$\nP(\\text{核素 }2) = \\frac{\\Sigma_{t,2}}{\\Sigma_t} = \\frac{0.7}{1.0} = 0.7\n$$\n作为检验，这些概率之和必须为 1，而 $0.3 + 0.7 = 1$ 正是如此。这个过程是在蒙特卡罗模拟中确定碰撞位置后选择核素的基础。\n\n2.  **无条件反应道概率**\n\n接下来，我们推导四种可能的反应道结果（在核素 1 上散射、在核素 1 上吸收、在核素 2 上散射、在核素 2 上吸收）各自的无条件概率。无条件概率是指在碰撞点该事件发生的总概率，没有任何关于撞击到哪个核素的先决条件。\n\n让我们考虑“在核素 $1$ 上散射”这一事件。这是一个复合事件，代表了两个事件的交集：(A) 碰撞发生在核素 $1$ 上，以及 (B) 反应是散射。其概率由链式法则给出：\n$$\nP(\\text{在 }1\\text{ 上散射}) = P(\\text{散射} | \\text{核素 }1) \\times P(\\text{核素 }1)\n$$\n在与核素 $1$ 发生碰撞的条件下，发生散射的条件概率是核素 $1$ 的散射截面与其总截面之比。这代表了与核素 $1$ 的相互作用中导致散射的部分。\n$$\nP(\\text{散射} | \\text{核素 }1) = \\frac{\\Sigma_{s,1}}{\\Sigma_{t,1}}\n$$\n将此式以及先前推导的 $P(\\text{核素 }1)$ 表达式代入，得到：\n$$\nP(\\text{在 }1\\text{ 上散射}) = \\frac{\\Sigma_{s,1}}{\\Sigma_{t,1}} \\times \\frac{\\Sigma_{t,1}}{\\Sigma_t} = \\frac{\\Sigma_{s,1}}{\\Sigma_t}\n$$\n这个简洁的结果表明，任何特定反应道的无条件概率就是该反应道的宏观截面与混合物总宏观截面之比。蒙特卡罗程序通常就是这样直接对碰撞物理进行抽样的：生成一个随机数，并与一个由所有分截面与总截面之比构成的累积概率列表进行比较。\n\n利用这一原理，我们可以计算所有四个无条件概率：\n-   在核素 $1$ 上散射的概率：\n    $$\n    P(\\text{在 }1\\text{ 上散射}) = \\frac{\\Sigma_{s,1}}{\\Sigma_t} = \\frac{0.2}{1.0} = 0.2\n    $$\n-   在核素 $1$ 上吸收的概率：\n    $$\n    P(\\text{在 }1\\text{ 上吸收}) = \\frac{\\Sigma_{a,1}}{\\Sigma_t} = \\frac{0.1}{1.0} = 0.1\n    $$\n-   在核素 $2$ 上散射的概率：\n    $$\n    P(\\text{在 }2\\text{ 上散射}) = \\frac{\\Sigma_{s,2}}{\\Sigma_t} = \\frac{0.5}{1.0} = 0.5\n    $$\n-   在核素 $2$ 上吸收的概率：\n    $$\n    P(\\text{在 }2\\text{ 上吸收}) = \\frac{\\Sigma_{a,2}}{\\Sigma_t} = \\frac{0.2}{1.0} = 0.2\n    $$\n为了验证，这些无条件概率之和必须为 1，代表了碰撞的所有可能结果：\n$$\n\\sum P(\\text{结果}) = 0.2 + 0.1 + 0.5 + 0.2 = 1.0\n$$\n结果是一致的。\n\n最终要求的输出是按指定顺序排列的这六个概率的行向量：\n$\\left(P(\\text{核素 }1),\\ P(\\text{核素 }2),\\ P(\\text{在 }1\\text{ 上散射}),\\ P(\\text{在 }1\\text{ 上吸收}),\\ P(\\text{在 }2\\text{ 上散射}),\\ P(\\text{在 }2\\text{ 上吸收})\\right)$。\n\n数值为：\n$(0.3, 0.7, 0.2, 0.1, 0.5, 0.2)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.3  0.7  0.2  0.1  0.5  0.2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "直接模拟物理过程的“模拟”蒙特卡罗方法虽然直观，但在某些情况下效率低下，例如当粒子因吸收而大量损失时会导致统计结果不佳。为了解决这个问题，我们引入了“存活偏倚”（Survival Biasing）这一重要的方差缩减技术，本练习将探讨其核心机制。 你将推导粒子在经历多次“强制存活”的碰撞后其统计权重 $w$ 如何演变，从而理解如何在不牺牲模拟结果无偏性的前提下，通过调整权重来显著提高计算的效率和统计质量。",
            "id": "4246709",
            "problem": "考虑一个能量固定的中性粒子在无限均匀介质中的历史，其中宏观总截面为常数，且每次碰撞为吸收（俘获）的概率为常数分数 $p_{a} \\in (0,1)$。在模拟蒙特卡罗（MC）中子输运模拟中，一次碰撞有 $p_{a}$ 的概率是吸收（粒子随之终止），有 $1-p_{a}$ 的概率是非吸收碰撞（粒子以不变的统计权重继续运动）。\n\n现在，假设模拟对吸收碰撞类型使用存活偏倚（也称隐式俘获）。在每个碰撞点，存活偏倚的规则如下：\n- 通过在碰撞位置记录一个等于当前粒子权重乘以 $p_{a}$ 的分数，使得吸收反应率的估计量是无偏的。\n- 粒子历史总是作为非吸收碰撞继续，其出射权重 $w'$ 的选择应确保估计量保持无偏且粒子权重保持非负。\n\n设 $w_{0}  0$ 为任何碰撞发生前的初始粒子权重，并设 $w_{n}$ 表示在经过 $n$ 个用存活偏倚处理的碰撞点后的粒子权重，假设 $p_{a}$ 在各个碰撞点保持不变，并且没有其他方差缩减技术改变权重。仅使用无偏计分和每个碰撞点权重守恒的定义，推导期望权重 $\\mathbb{E}[w_{n}]$ 作为 $w_{0}$、$p_{a}$ 和整数 $n \\geq 1$ 的函数的闭式表达式。\n\n请以单个简化的解析表达式形式给出最终答案。无需进行数值取整。",
            "solution": "### 求解推导\n\n设 $w_{k-1}$ 表示粒子在其第 $k$ 次碰撞（$k \\geq 1$）之前的权重。粒子在第一次碰撞之前的初始权重为 $w_{0}$。\n\n存活偏倚技术的核心原则是确保所有估计量保持无偏。这意味着在偏倚模拟中任何统计量的期望值必须等于其在相应模拟（即物理上直接的）模拟中的期望值。这一原则至关重要地适用于粒子总体本身。从碰撞事件中出现的粒子的期望权重在偏倚博弈和模拟博弈中必须相同。\n\n首先，考虑模拟模拟。在第 $k$ 次碰撞时，一个入射权重为 $w_{k-1}$ 的粒子有 $p_{a}$ 的概率被吸收（从而其权重变为 $0$），有 $1-p_{a}$ 的概率存活（散射）并保持其权重 $w_{k-1}$。因此，碰撞决策后粒子的期望权重（我们称之为 $\\mathbb{E}[w_{k}^{\\text{analog}}]$）为：\n$$ \\mathbb{E}[w_{k}^{\\text{analog}}] = (w_{k-1}) \\cdot (1 - p_{a}) + (0) \\cdot p_{a} = w_{k-1}(1 - p_{a}) $$\n\n接下来，考虑所述的存活偏倚模拟。在第 $k$ 次碰撞时，入射权重为 $w_{k-1}$ 的粒子被迫存活。其权重被调整为新值 $w_{k}$。在这个偏倚博弈中，粒子以概率 $1$ 存活。此事件后粒子的期望权重 $\\mathbb{E}[w_{k}^{\\text{biased}}]$ 为：\n$$ \\mathbb{E}[w_{k}^{\\text{biased}}] = w_{k} \\cdot 1 = w_{k} $$\n\n为使模拟无偏，从碰撞中出现的期望权重必须守恒。因此，我们必须使模拟博弈和偏倚博弈的期望相等：\n$$ \\mathbb{E}[w_{k}^{\\text{biased}}] = \\mathbb{E}[w_{k}^{\\text{analog}}] $$\n$$ w_{k} = w_{k-1}(1 - p_{a}) $$\n\n这个方程提供了在仅使用存活偏倚的模拟中，每次碰撞时更新粒子权重的确定性规则。它是一个递推关系。我们可以使用此关系，从初始权重 $w_{0}$ 开始，找到经过 $n$ 次碰撞后的权重 $w_{n}$。\n\n对于第一次碰撞 ($n=1$)：\n$$ w_{1} = w_{0}(1 - p_{a}) $$\n对于第二次碰撞 ($n=2$)：\n$$ w_{2} = w_{1}(1 - p_{a}) = \\left[w_{0}(1 - p_{a})\\right](1 - p_{a}) = w_{0}(1 - p_{a})^{2} $$\n对于第三次碰撞 ($n=3$)：\n$$ w_{3} = w_{2}(1 - p_{a}) = \\left[w_{0}(1 - p_{a})^{2}\\right](1 - p_{a}) = w_{0}(1 - p_{a})^{3} $$\n\n通过归纳法，粒子在经历恰好 $n$ 次碰撞后的权重由以下闭式表达式给出：\n$$ w_{n} = w_{0}(1 - p_{a})^{n} $$\n\n问题要求的是期望权重 $\\mathbb{E}[w_{n}]$。根据问题的约束（仅使用存活偏倚，$p_a$ 是常数），一个完成了恰好 $n$ 次碰撞的粒子的权重 $w_n$ 是一个确定性量，而不是一个随机变量。它的值由 $w_{0}$、$p_{a}$ 和 $n$ 唯一确定。一个常量值的期望就是该值本身。\n\n因此，经过 $n$ 次碰撞后的期望权重为：\n$$ \\mathbb{E}[w_{n}] = w_{n} = w_{0}(1 - p_{a})^{n} $$\n此表达式即为简化的解析答案。",
            "answer": "$$\n\\boxed{w_{0}(1 - p_{a})^{n}}\n$$"
        }
    ]
}