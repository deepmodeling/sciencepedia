{
    "hands_on_practices": [
        {
            "introduction": "In a Monte Carlo simulation, after determining that a particle has collided, the next crucial step is to decide the nature of that collision. This fundamental decision is governed by the relative probabilities of competing reaction types, which are directly proportional to their respective macroscopic cross sections. This exercise solidifies the core principle of converting cross-section data into a discrete probability distribution, $p_{i} = \\Sigma_{i} / \\Sigma_{t}$, for sampling the collision outcome .",
            "id": "4246721",
            "problem": "A neutron is transported in a spatially homogeneous material at fixed energy, so that reaction rates per unit path length are constant. Let the macroscopic scattering cross section be $\\Sigma_{s}$, the macroscopic capture (non-fission absorption) cross section be $\\Sigma_{c}$, and the macroscopic fission cross section be $\\Sigma_{f}$. The total macroscopic cross section is defined by $\\Sigma_{t}=\\Sigma_{s}+\\Sigma_{c}+\\Sigma_{f}$. In the Monte Carlo method for neutron transport, sampling the collision type at the end of a free flight is performed by drawing from the normalized probabilities for scattering, capture, and fission.\n\nStarting from the definition that a macroscopic cross section $\\Sigma$ represents the collision rate per unit path length, and from the well-tested fact that, in a homogeneous medium at fixed energy, the free-flight path length $L$ is exponentially distributed with probability density function $f_{L}(\\ell)=\\Sigma_{t}\\exp(-\\Sigma_{t}\\ell)$ for $\\ell\\ge 0$, derive the normalized probability $p_{i}$ that the next collision is of type $i\\in\\{s,c,f\\}$ in terms of $\\Sigma_{i}$ and $\\Sigma_{t}$. Then, using $\\Sigma_{s}=0.8\\ \\mathrm{cm^{-1}}$, $\\Sigma_{c}=0.1\\ \\mathrm{cm^{-1}}$, and $\\Sigma_{f}=0.1\\ \\mathrm{cm^{-1}}$, compute the triple $(p_{s},p_{c},p_{f})$ and verify that $p_{s}+p_{c}+p_{f}=1$. Express each probability as a decimal fraction and round your final reported values to four significant figures.",
            "solution": "The problem statement is critically validated before attempting a solution.\n\n### Step 1: Extract Givens\n- Macroscopic scattering cross section: $\\Sigma_{s}$\n- Macroscopic capture cross section: $\\Sigma_{c}$\n- Macroscopic fission cross section: $\\Sigma_{f}$\n- Total macroscopic cross section definition: $\\Sigma_{t}=\\Sigma_{s}+\\Sigma_{c}+\\Sigma_{f}$\n- Definition of a macroscopic cross section $\\Sigma$: collision rate per unit path length. This is equivalent to the probability of interaction per unit path length.\n- Distribution of free-flight path length $L$: exponential, with probability density function $f_{L}(\\ell)=\\Sigma_{t}\\exp(-\\Sigma_{t}\\ell)$ for $\\ell\\ge 0$.\n- Numerical values for calculation: $\\Sigma_{s}=0.8\\ \\mathrm{cm^{-1}}$, $\\Sigma_{c}=0.1\\ \\mathrm{cm^{-1}}$, and $\\Sigma_{f}=0.1\\ \\mathrm{cm^{-1}}$.\n- Required tasks:\n    1. Derive the normalized probability $p_{i}$ for a collision of type $i\\in\\{s,c,f\\}$ in terms of $\\Sigma_{i}$ and $\\Sigma_{t}$.\n    2. Compute the triple $(p_{s},p_{c},p_{f})$ using the given numerical values.\n    3. Verify that the sum of probabilities is $1$.\n    4. Express the probabilities as decimal fractions rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It is based on fundamental principles of neutron transport theory, a core topic in nuclear engineering and physics. The definitions of macroscopic cross sections, their additivity to form a total cross section, and the resulting exponential distribution for free-flight path lengths in a homogeneous medium are standard and correct assumptions in this field. The problem is self-contained, with all necessary data and definitions provided. There are no contradictions or ambiguities. The numerical values are physically reasonable.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\n### Derivation of Collision Probabilities\nThe fundamental premise is that a macroscopic cross section $\\Sigma_{i}$ for a reaction of type $i$ represents the probability per unit path length of a neutron inducing that reaction. This is a rate concept. For an infinitesimally small path length $d\\ell$, the probability $dP_{i}$ of a type-$i$ reaction occurring is given by:\n$$dP_{i} = \\Sigma_{i} \\, d\\ell$$\nThis relationship is valid for any reaction type $i \\in \\{s, c, f\\}$, where $s$ denotes scattering, $c$ denotes capture, and $f$ denotes fission.\n\nThe reactions are assumed to be mutually exclusive events. The total probability per unit path length of *any* interaction occurring is the sum of the individual probabilities per unit path length. This defines the total macroscopic cross section $\\Sigma_t$:\n$$\\Sigma_{t} = \\Sigma_{s} + \\Sigma_{c} + \\Sigma_{f}$$\nConsequently, the probability $dP_{t}$ of *any* interaction occurring within the infinitesimal path length $d\\ell$ is:\n$$dP_{t} = \\Sigma_{t} \\, d\\ell$$\nThe problem asks for the normalized probability $p_i$ that, given a collision has occurred, it is of type $i$. This is a conditional probability. Let $A$ be the event that a collision of type $i$ occurs in $d\\ell$, and let $B$ be the event that *any* collision occurs in $d\\ell$. We seek the probability $p_i = P(A|B)$.\n$$p_{i} = \\frac{P(A \\cap B)}{P(B)}$$\nThe event \"a collision of type $i$ occurs\" ($A$) is a subset of the event \"any collision occurs\" ($B$). Therefore, the intersection $A \\cap B$ is simply the event $A$.\n$$p_{i} = \\frac{P(A)}{P(B)} = \\frac{dP_{i}}{dP_{t}}$$\nSubstituting the expressions in terms of cross sections:\n$$p_{i} = \\frac{\\Sigma_{i} \\, d\\ell}{\\Sigma_{t} \\, d\\ell}$$\nThe differential path length element $d\\ell$ cancels, yielding the general formula for the collision type sampling probability:\n$$p_{i} = \\frac{\\Sigma_{i}}{\\Sigma_{t}}$$\nThis result is independent of the path length $\\ell$. The exponential distribution for the path length, $f_{L}(\\ell)=\\Sigma_{t}\\exp(-\\Sigma_{t}\\ell)$, arises from the constant total interaction probability per unit length, $\\Sigma_{t}$. When a collision event is determined to happen at the end of a sampled path length, the type of that collision is determined by the relative magnitudes of the partial cross sections, as expressed by the derived probabilities $p_i$.\n\n### Numerical Calculation\nThe given numerical values for the macroscopic cross sections are:\n- $\\Sigma_{s} = 0.8\\ \\mathrm{cm^{-1}}$\n- $\\Sigma_{c} = 0.1\\ \\mathrm{cm^{-1}}$\n- $\\Sigma_{f} = 0.1\\ \\mathrm{cm^{-1}}$\n\nFirst, we calculate the total macroscopic cross section $\\Sigma_{t}$:\n$$\\Sigma_{t} = \\Sigma_{s} + \\Sigma_{c} + \\Sigma_{f} = 0.8\\ \\mathrm{cm^{-1}} + 0.1\\ \\mathrm{cm^{-1}} + 0.1\\ \\mathrm{cm^{-1}} = 1.0\\ \\mathrm{cm^{-1}}$$\nNow, we can compute the normalized probabilities for each collision type, $p_{s}$, $p_{c}$, and $p_{f}$.\n\nProbability of scattering:\n$$p_{s} = \\frac{\\Sigma_{s}}{\\Sigma_{t}} = \\frac{0.8}{1.0} = 0.8$$\nProbability of capture:\n$$p_{c} = \\frac{\\Sigma_{c}}{\\Sigma_{t}} = \\frac{0.1}{1.0} = 0.1$$\nProbability of fission:\n$$p_{f} = \\frac{\\Sigma_{f}}{\\Sigma_{t}} = \\frac{0.1}{1.0} = 0.1$$\nThe problem requires these values to be expressed as decimal fractions rounded to four significant figures.\n- $p_{s} = 0.8000$\n- $p_{c} = 0.1000$\n- $p_{f} = 0.1000$\n\n### Verification\nFinally, we verify that the sum of these probabilities equals $1$, as required for a complete probability distribution.\n$$p_{s} + p_{c} + p_{f} = 0.8000 + 0.1000 + 0.1000 = 1.0000$$\nThe sum is indeed $1$, which confirms the correctness of the calculation. The resulting triple of probabilities is $(p_{s}, p_{c}, p_{f}) = (0.8000, 0.1000, 0.1000)$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.8000  0.1000  0.1000 \\end{pmatrix}}$$"
        },
        {
            "introduction": "A particle's journey through a medium is a sequence of free flights and interactions, forming the basis of the transport loop. This practice moves beyond the isolated collision event and places it within the dynamic context of the full transport algorithm. You will develop the logic to answer the primary question at each step: does the particle collide within the current geometric region, or does it reach a boundary first? This challenge integrates the concepts of path length sampling with the determination of subsequent events, forming the core of any Monte Carlo transport code .",
            "id": "4246698",
            "problem": "Consider a monoenergetic neutron traveling in a homogeneous, isotropic medium bounded by planar surfaces. Along any straight path segment, collisions are modeled as a homogeneous Poisson process with constant rate equal to the macroscopic total cross section, denoted by $\\Sigma_{t}$, where $\\Sigma_{t}$ is the sum of reaction-specific macroscopic cross sections $\\Sigma_{s}$ (scattering), $\\Sigma_{a}$ (absorption), and $\\Sigma_{f}$ (fission). The algorithmic decision rule in Monte Carlo (MC) particle transport is as follows: sample a free path length $s$ from the distance-to-collision distribution implied by the Poisson process, compare $s$ to the distance $d_{b}$ to the nearest boundary along the particle direction, and declare a collision if and only if $s$ is smaller than $d_{b}$. If a collision occurs, sample the collision type by drawing from a categorical distribution whose event probabilities are proportional to the respective reaction macroscopic cross sections $\\Sigma_{s}$, $\\Sigma_{a}$, and $\\Sigma_{f}$.\n\nStarting only from the fundamental assumptions of a homogeneous Poisson process for interactions and the definitions of macroscopic cross sections, implement a program that computes, for each test case, the unconditional probability that the next event before boundary crossing is of each reaction type. The required outputs for a single case are the three dimensionless probabilities for the events \"scattering before boundary,\" \"absorption before boundary,\" and \"fission before boundary,\" each expressed as a decimal (not a percentage). All distances must be expressed in centimeters (cm), and all macroscopic cross sections must be expressed in inverse centimeters ($\\mathrm{cm}^{-1}$). The medium is homogeneous, and the neutron direction is fixed so that $d_{b}$ is well-defined.\n\nYour implementation must:\n- Use only the fundamental base described above to reason about the sampling and decision process.\n- Correctly handle edge conditions such as $d_{b} = 0$ and $\\Sigma_{t} = 0$ without numerical instability or undefined operations.\n- Produce results strictly as dimensionless decimals.\n\nTest Suite:\nFor each case below, use the given reaction macroscopic cross sections and boundary distance. The medium is homogeneous with $\\Sigma_{t} = \\Sigma_{s} + \\Sigma_{a} + \\Sigma_{f}$.\n\n- Case $1$: $\\Sigma_{s} = 0.2\\,\\mathrm{cm}^{-1}$, $\\Sigma_{a} = 0.1\\,\\mathrm{cm}^{-1}$, $\\Sigma_{f} = 0.3\\,\\mathrm{cm}^{-1}$, $d_{b} = 10\\,\\mathrm{cm}$.\n- Case $2$: $\\Sigma_{s} = 0.2\\,\\mathrm{cm}^{-1}$, $\\Sigma_{a} = 0.1\\,\\mathrm{cm}^{-1}$, $\\Sigma_{f} = 0.3\\,\\mathrm{cm}^{-1}$, $d_{b} = 0\\,\\mathrm{cm}$.\n- Case $3$: $\\Sigma_{s} = 1\\times 10^{-6}\\,\\mathrm{cm}^{-1}$, $\\Sigma_{a} = 0.0\\,\\mathrm{cm}^{-1}$, $\\Sigma_{f} = 0.0\\,\\mathrm{cm}^{-1}$, $d_{b} = 1\\times 10^{6}\\,\\mathrm{cm}$.\n- Case $4$: $\\Sigma_{s} = 0.0\\,\\mathrm{cm}^{-1}$, $\\Sigma_{a} = 0.0\\,\\mathrm{cm}^{-1}$, $\\Sigma_{f} = 0.0\\,\\mathrm{cm}^{-1}$, $d_{b} = 100.0\\,\\mathrm{cm}$.\n- Case $5$: $\\Sigma_{s} = 7.0\\,\\mathrm{cm}^{-1}$, $\\Sigma_{a} = 3.0\\,\\mathrm{cm}^{-1}$, $\\Sigma_{f} = 0.0\\,\\mathrm{cm}^{-1}$, $d_{b} = 0.05\\,\\mathrm{cm}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist of the three unconditional probabilities in the order $[\\text{scatter}, \\text{absorb}, \\text{fission}]$. For example, the output must be of the form $[[x_{1},y_{1},z_{1}],[x_{2},y_{2},z_{2}],\\dots]$, with all $x_{i}$, $y_{i}$, and $z_{i}$ provided as decimals.",
            "solution": "The problem requires the calculation of the unconditional probabilities for a neutron to undergo a scattering, absorption, or fission event before crossing a boundary. We must derive these probabilities from the fundamental principles provided: a homogeneous Poisson process for collisions and the definitions of macroscopic cross sections.\n\nLet us define the operative events:\n- $C$: A collision occurs before the neutron reaches the boundary. This corresponds to the sampled path length, $s$, being less than the distance to the boundary, $d_b$.\n- $R_s$: The collision type is scattering.\n- $R_a$: The collision type is absorption.\n- $R_f$: The collision type is fission.\n\nThe objective is to find the unconditional probabilities $P(C \\cap R_s)$, $P(C \\cap R_a)$, and $P(C \\cap R_f)$. Using the definition of conditional probability, for any reaction type $i \\in \\{s, a, f\\}$, this can be expressed as:\n$$P(C \\cap R_i) = P(R_i | C) \\cdot P(C)$$\n\nOur derivation proceeds in two parts: first, we calculate $P(C)$, the probability of any collision occurring before reaching the boundary; second, we determine $P(R_i | C)$, the conditional probability of the collision being of type $i$, given that a collision has occurred.\n\n**1. Probability of Collision Before Boundary, $P(C)$**\n\nThe problem states that collisions are governed by a homogeneous Poisson process with a constant rate equal to the macroscopic total cross section, $\\Sigma_t$. In this context, the rate is spatial, not temporal. The distance a particle travels before an interaction, the free path length $S$, is a random variable. The probability that no collision occurs over a distance $x$ is given by the survival probability $e^{-\\Sigma_t x}$. The cumulative distribution function (CDF) for the distance to the first collision is therefore $F_S(s) = P(S \\le s) = 1 - e^{-\\Sigma_t s}$. The corresponding probability density function (PDF) is $f_S(s) = \\frac{d}{ds}F_S(s) = \\Sigma_t e^{-\\Sigma_t s}$, which is the exponential distribution with rate parameter $\\Sigma_t$.\n\nThe event $C$ occurs if the sampled path length $s$ is less than the distance to the boundary, $d_b$. The probability of this event is:\n$$P(C) = P(S  d_b) = \\int_0^{d_b} f_S(s) \\,ds = \\int_0^{d_b} \\Sigma_t e^{-\\Sigma_t s} \\,ds$$\nEvaluating this integral, we find:\n$$P(C) = \\left[ -e^{-\\Sigma_t s} \\right]_0^{d_b} = (-e^{-\\Sigma_t d_b}) - (-e^0) = 1 - e^{-\\Sigma_t d_b}$$\nThis is the total probability that a neutron interacts with the medium at any point along the path of length $d_b$.\n\n**2. Conditional Probability of Reaction Type, $P(R_i | C)$**\n\nThe problem statement specifies that if a collision occurs, the type of reaction is sampled from a categorical distribution whose event probabilities are proportional to the respective reaction macroscopic cross sections. This means the probability of a reaction being of type $i$, given that a collision has happened, is the ratio of the partial cross section for that reaction to the total cross section. The total macroscopic cross section is defined as $\\Sigma_t = \\Sigma_s + \\Sigma_a + \\Sigma_f$.\n\nThus, the conditional probabilities are:\n- For scattering: $P(R_s | C) = \\frac{\\Sigma_s}{\\Sigma_t}$\n- For absorption: $P(R_a | C) = \\frac{\\Sigma_a}{\\Sigma_t}$\n- For fission: $P(R_f | C) = \\frac{\\Sigma_f}{\\Sigma_t}$\n\nThese expressions are valid only if $\\Sigma_t  0$. The case where $\\Sigma_t = 0$ will be handled separately.\n\n**3. Unconditional Probability of Each Reaction Type**\n\nBy combining the results from the previous two steps, we obtain the final expression for the unconditional probability of a reaction of type $i$ occurring before the boundary crossing:\n$$P(C \\cap R_i) = P(R_i | C) \\cdot P(C) = \\frac{\\Sigma_i}{\\Sigma_t} \\left( 1 - e^{-\\Sigma_t d_b} \\right)$$\nThis formula applies to $i \\in \\{s, a, f\\}$.\n\n**4. Analysis of Edge Conditions**\n\nA rigorous solution must correctly handle the edge conditions specified in the problem.\n\n- **Case 1: $d_b = 0$**\nIf the particle starts at the boundary, $d_b = 0$. The probability of a collision before crossing is intuitively $0$. Our formula confirms this:\n$$P(C) = 1 - e^{-\\Sigma_t \\cdot 0} = 1 - e^0 = 1 - 1 = 0$$\nSince $P(C) = 0$, the unconditional probability for any reaction type $i$, $P(C \\cap R_i)$, is also $0$.\n\n- **Case 2: $\\Sigma_t = 0$**\nIf the total macroscopic cross section $\\Sigma_t = 0$, it implies that $\\Sigma_s = \\Sigma_a = \\Sigma_f = 0$ since cross sections are non-negative. This models a vacuum, where no interactions can occur. The probability of any collision is $0$. Our formula leads to an indeterminate form $\\frac{0}{0}$ for the conditional probability term. To resolve this, we must return to the physics. If $\\Sigma_t=0$, the interaction rate is zero, meaning the path length to the next collision is infinite. Therefore, the probability $P(S  d_b)$ is $0$ for any finite $d_b$. Consequently, the probability of any specific reaction type before boundary crossing is also $0$. In an implementation, if $\\Sigma_t$ is found to be $0$, the final probabilities for all reaction types should be set directly to $0$ to avoid a division-by-zero error and correctly reflect the physical reality.\n\nThe final algorithm is as follows:\n1. For a given set of parameters $\\{\\Sigma_s, \\Sigma_a, \\Sigma_f, d_b\\}$, calculate the total cross section $\\Sigma_t = \\Sigma_s + \\Sigma_a + \\Sigma_f$.\n2. Check for edge conditions:\n   - If $\\Sigma_t = 0$ or $d_b = 0$, the probabilities for all three reaction types are $0$.\n3. If neither edge condition is met, proceed with the general formula:\n   - Calculate the probability of collision before boundary: $P_{\\text{coll}} = 1 - e^{-\\Sigma_t d_b}$.\n   - Calculate the unconditional probabilities for scattering, absorption, and fission, respectively:\n     - $P_s = \\frac{\\Sigma_s}{\\Sigma_t} \\cdot P_{\\text{coll}}$\n     - $P_a = \\frac{\\Sigma_a}{\\Sigma_t} \\cdot P_{\\text{coll}}$\n     - $P_f = \\frac{\\Sigma_f}{\\Sigma_t} \\cdot P_{\\text{coll}}$\n4. The result for one case is the triplet of probabilities $[P_s, P_a, P_f]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the unconditional probability of scattering, absorption, and\n    fission events before a particle crosses a boundary.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Standard case\n        {'sigma_s': 0.2, 'sigma_a': 0.1, 'sigma_f': 0.3, 'd_b': 10.0},\n        # Case 2: Zero distance to boundary\n        {'sigma_s': 0.2, 'sigma_a': 0.1, 'sigma_f': 0.3, 'd_b': 0.0},\n        # Case 3: Very transparent medium, long distance\n        {'sigma_s': 1e-6, 'sigma_a': 0.0, 'sigma_f': 0.0, 'd_b': 1e6},\n        # Case 4: Vacuum (zero total cross section)\n        {'sigma_s': 0.0, 'sigma_a': 0.0, 'sigma_f': 0.0, 'd_b': 100.0},\n        # Case 5: Highly interactive medium, short distance\n        {'sigma_s': 7.0, 'sigma_a': 3.0, 'sigma_f': 0.0, 'd_b': 0.05},\n    ]\n\n    results = []\n    for case in test_cases:\n        sigma_s = case['sigma_s']\n        sigma_a = case['sigma_a']\n        sigma_f = case['sigma_f']\n        d_b = case['d_b']\n\n        # Calculate the total macroscopic cross section\n        sigma_t = sigma_s + sigma_a + sigma_f\n\n        # Handle edge conditions\n        # If sigma_t is 0 (vacuum) or d_b is 0 (at boundary), no collision\n        # can happen before crossing the boundary.\n        if sigma_t == 0.0 or d_b == 0.0:\n            prob_s, prob_a, prob_f = 0.0, 0.0, 0.0\n        else:\n            # Probability of any collision occurring before reaching the boundary\n            # P(collision) = 1 - exp(-sigma_t * d_b)\n            prob_collision = 1.0 - np.exp(-sigma_t * d_b)\n\n            # The unconditional probability for a reaction of type 'i' is:\n            # P(i) = P(i | collision) * P(collision)\n            # where P(i | collision) = sigma_i / sigma_t\n            \n            prob_s = (sigma_s / sigma_t) * prob_collision\n            prob_a = (sigma_a / sigma_t) * prob_collision\n            prob_f = (sigma_f / sigma_t) * prob_collision\n            \n        results.append([prob_s, prob_a, prob_f])\n\n    # Format the final output string exactly as specified.\n    # e.g., [[x1,y1,z1],[x2,y2,z2],...]\n    output_str = '[' + ','.join(f'[{r[0]},{r[1]},{r[2]}]' for r in results) + ']'\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Implementing a probabilistic algorithm is only the first step; verifying its correctness is essential for a reliable simulation. This exercise introduces a powerful statistical tool, the chi-square ($\\chi^2$) goodness-of-fit test, to validate your collision-type sampler. By comparing the frequencies of simulated outcomes against their theoretical probabilities, you can quantitatively assess whether your code is sampling correctly and build confidence in your simulation results .",
            "id": "4246723",
            "problem": "A researcher is simulating neutron histories in a homogeneous nuclear reactor medium where collision types are classified into categories such as elastic scattering, absorption, and fission. In a homogeneous medium, the sampling of collision type is governed by fixed probabilities for each type, and the simulated outcomes over many histories can be compared to expectations using a chi-square goodness-of-fit test. Your task is to write a program that, for several specified test scenarios, samples collision types according to given category probabilities and then evaluates whether the observed frequencies are statistically consistent with the expected frequencies.\n\nUse the following rules to design your program:\n- Treat the simulated neutron collisions as independent category draws according to given category probabilities. Each simulation consists of a fixed number of draws.\n- For each scenario, form observed counts for each category and compare to the expected counts implied by the category probabilities and the total number of draws using a chi-square goodness-of-fit test. Use the conventional formulation with chi-square statistic compared to the chi-square distribution with degrees of freedom equal to one less than the number of categories.\n- Use a fixed pseudo-random seed of value $12345$ to ensure reproducibility for all scenarios.\n\nThe test suite consists of four scenarios, each specified by a tuple $([p_1,\\dots,p_k], N, \\alpha)$:\n- Scenario $1$: category probabilities $[0.6, 0.3, 0.1]$, number of draws $10000$, significance level $\\alpha = 0.05$.\n- Scenario $2$: category probabilities $[0.25, 0.25, 0.25, 0.25]$, number of draws $20$, significance level $\\alpha = 0.05$.\n- Scenario $3$: category probabilities $[0.01, 0.49, 0.5]$, number of draws $1000$, significance level $\\alpha = 0.01$.\n- Scenario $4$: category probabilities $[0.05, 0.15, 0.5, 0.2, 0.1]$, number of draws $200$, significance level $\\alpha = 0.1$.\n\nFor each scenario, compute the chi-square goodness-of-fit test and produce a boolean decision indicating whether the null hypothesis that the observed frequencies match the expected frequencies should be rejected at the given significance level. A value of $\\texttt{True}$ indicates that the null hypothesis is rejected, and a value of $\\texttt{False}$ indicates that the null hypothesis is not rejected.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$). There are no physical units involved in the output, and no angles. All four results must be booleans in the order of the scenarios listed above.",
            "solution": "The problem statement has been rigorously validated and is determined to be valid. It is scientifically grounded in the principles of Monte Carlo simulation and statistical hypothesis testing, specifically the chi-square goodness-of-fit test, which are standard methods in computational physics and data analysis. The problem is well-posed, providing all necessary parameters—category probabilities ($p_i$), total number of draws ($N$), and significance levels ($\\alpha$)—for each of the four scenarios. The specified probabilities for each scenario correctly sum to $1$. The objective is clear and the terminology is unambiguous. Therefore, a reasoned solution can be constructed.\n\nThe core task is to perform a Pearson's chi-square ($\\chi^2$) goodness-of-fit test for each of the four specified scenarios. This statistical test is used to determine if a set of observed categorical frequencies differs significantly from a set of expected frequencies.\n\nThe null hypothesis, $H_0$, for each test is that the observed collision counts are drawn from a categorical distribution with the specified probabilities $\\{p_1, p_2, \\dots, p_k\\}$. The alternative hypothesis, $H_a$, is that the observed counts are not drawn from this distribution. The test is conducted at a given significance level $\\alpha$, which represents the probability of rejecting the null hypothesis when it is, in fact, true (a Type I error).\n\nThe procedure for each scenario is as follows:\n\n1.  **Simulation of Observed Frequencies**: For a given scenario with $k$ categories, a vector of probabilities $\\mathbf{p} = [p_1, p_2, \\dots, p_k]$, and a total number of draws $N$, we simulate the experiment. This involves generating $N$ independent random samples from the specified categorical distribution. The result is a set of observed counts, $\\mathbf{O} = [O_1, O_2, \\dots, O_k]$, where $\\sum_{i=1}^{k} O_i = N$. These counts are generated using a pseudo-random number generator initialized with a fixed seed of $12345$ to ensure the results are reproducible. The joint distribution of these counts is multinomial.\n\n2.  **Calculation of Expected Frequencies**: Under the assumption that the null hypothesis $H_0$ is true, the expected frequency for each category $i$ is calculated as $E_i = N \\times p_i$. This gives the vector of expected counts, $\\mathbf{E} = [E_1, E_2, \\dots, E_k]$. These are the theoretical average counts expected if the sampling process perfectly follows the given probabilities.\n\n3.  **Calculation of the Chi-Square Test Statistic**: The discrepancy between the observed counts $\\mathbf{O}$ and the expected counts $\\mathbf{E}$ is quantified by the chi-square test statistic, denoted $\\chi^2_{stat}$. It is calculated using the formula:\n    $$\n    \\chi^2_{stat} = \\sum_{i=1}^{k} \\frac{(O_i - E_i)^2}{E_i}\n    $$\n    A larger value of $\\chi^2_{stat}$ indicates a greater deviation of the observed data from the expected model.\n\n4.  **Determination of the Critical Value and Decision**: The calculated $\\chi^2_{stat}$ is compared against a critical value, $\\chi^2_{crit}$, obtained from the chi-square distribution. If $H_0$ is true, the test statistic $\\chi^2_{stat}$ approximately follows a chi-square distribution with $\\nu = k - 1$ degrees of freedom. The degrees of freedom represent the number of independent categories; since the total count $N$ is fixed, knowing the counts of $k-1$ categories determines the count of the last one. The critical value $\\chi^2_{crit}$ is the value for which the probability of exceeding it is equal to the significance level $\\alpha$, that is, $P(\\chi^2_{\\nu}  \\chi^2_{crit}) = \\alpha$. This value is found using the inverse cumulative distribution function (or percent-point function) of the $\\chi^2$ distribution, such that $\\chi^2_{crit} = \\chi^2_{\\nu, 1-\\alpha}$.\n\n    The decision rule is:\n    - If $\\chi^2_{stat}  \\chi^2_{crit}$, we reject the null hypothesis $H_0$. The result for the scenario is $\\texttt{True}$.\n    - If $\\chi^2_{stat} \\le \\chi^2_{crit}$, we do not reject the null hypothesis $H_0$. The result for the scenario is $\\texttt{False}$.\n\nThis algorithm is applied sequentially to each of the four scenarios provided in the problem statement. The use of a fixed random seed ensures that the generated observed counts are identical upon every execution, leading to a single, deterministic set of outcomes for the hypothesis tests.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2\n\ndef solve():\n    \"\"\"\n    Performs a chi-square goodness-of-fit test for four scenarios\n    related to simulated neutron collision types.\n    \"\"\"\n    # Set the pseudo-random seed for reproducibility as specified.\n    np.random.seed(12345)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (category_probabilities, number_of_draws, alpha_significance)\n    test_cases = [\n        ([0.6, 0.3, 0.1], 10000, 0.05),\n        ([0.25, 0.25, 0.25, 0.25], 20, 0.05),\n        ([0.01, 0.49, 0.5], 1000, 0.01),\n        ([0.05, 0.15, 0.5, 0.2, 0.1], 200, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        p_vals, N, alpha = case\n        p_vals = np.array(p_vals)\n        k = len(p_vals)\n\n        # 1. Simulate the experiment to get observed frequencies.\n        #    np.random.multinomial generates the counts for N trials,\n        #    each falling into one of k categories with probabilities p_vals.\n        #    The result is a 2D array of shape (1, k), so we select the first row.\n        observed_counts = np.random.multinomial(n=N, pvals=p_vals, size=1)[0]\n\n        # 2. Calculate the expected frequencies under the null hypothesis.\n        expected_counts = N * p_vals\n\n        # 3. Calculate the chi-square test statistic.\n        #    chi_square_stat = sum([(O_i - E_i)^2 / E_i for all i])\n        #    We can be certain E_i  0 since N  0 and all p_i  0.\n        chi_square_stat = np.sum((observed_counts - expected_counts)**2 / expected_counts)\n\n        # 4. Determine the degrees of freedom for the chi-square distribution.\n        degrees_of_freedom = k - 1\n\n        # 5. Find the critical value from the chi-square distribution.\n        #    The critical value is the point on the distribution for which the\n        #    area to its right is equal to the significance level alpha.\n        #    This is found using the percent-point function (inverse CDF) at 1 - alpha.\n        critical_value = chi2.ppf(1 - alpha, degrees_of_freedom)\n\n        # 6. Make the decision: reject H0 if the statistic exceeds the critical value.\n        #    The result is True if rejected, False otherwise.\n        reject_H0 = chi_square_stat  critical_value\n        results.append(reject_H0)\n\n    # Final print statement in the exact required format.\n    # The map function converts each boolean in the list to its string representation (\"True\" or \"False\").\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}