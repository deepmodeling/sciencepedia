{
    "hands_on_practices": [
        {
            "introduction": "Before delving into sophisticated estimation techniques, it is essential to ground our understanding in the fundamentals. This first practice exercise challenges you to derive the expected value of the simplest possible absorption estimator—the collision estimator—directly from first principles. By formally proving that the expected score per collision is the ratio of the absorption cross section, $\\Sigma_{a}$, to the total cross section, $\\Sigma_{t}$, you will solidify the connection between physical data and the statistical outcomes of a Monte Carlo random walk.",
            "id": "4212910",
            "problem": "Consider a monoenergetic neutron population in an infinite, homogeneous, isotropic medium characterized by constant macroscopic total cross section $\\Sigma_{t}$ and constant macroscopic absorption cross section $\\Sigma_{a}$, with $\\Sigma_{t} > 0$ and $0 \\leq \\Sigma_{a} \\leq \\Sigma_{t}$. Let the steady-state neutron angular flux be $\\psi(\\mathbf{r}, \\hat{\\boldsymbol{\\Omega}})$ and the corresponding scalar flux be $\\phi(\\mathbf{r}) = \\int_{4\\pi} \\psi(\\mathbf{r}, \\hat{\\boldsymbol{\\Omega}}) \\,d\\hat{\\boldsymbol{\\Omega}}$. In a Monte Carlo (MC) neutron transport simulation, collisions occur as a consequence of the exponential free-flight law in this homogeneous medium, and the reaction channel at a collision is sampled from the set of available reactions according to their macroscopic cross sections.\n\nDefine the collision-based absorption estimator as follows: at each collision, assign a score $S$ equal to $1$ if the sampled reaction channel is absorption and $0$ otherwise. Assume that the free-flight distances are exponentially distributed with parameter $\\Sigma_{t}$ and that, conditional on a collision occurring, the reaction channel is sampled independently according to its macroscopic cross section. Using only foundational definitions from neutron transport theory (namely, that reaction rate densities are given by the product of the corresponding macroscopic cross section and the flux, and that the free-flight distribution in a homogeneous medium is exponential with parameter $\\Sigma_{t}$), derive the expected per-collision score $\\mathbb{E}[S]$ for the absorption estimator in closed form.\n\nExpress your final answer as a single dimensionless analytical expression. No numerical rounding is required.",
            "solution": "The objective is to derive the expected per-collision score, $\\mathbb{E}[S]$, for the specified absorption estimator. The score $S$ is a random variable associated with a collision event. By definition, $S$ takes the value $1$ if the collision results in an absorption reaction and $0$ otherwise.\n\nThe random variable $S$ is a Bernoulli random variable. Its probability mass function is given by:\n$$ P(S=s) = \\begin{cases} p & \\text{if } s=1 \\\\ 1-p & \\text{if } s=0 \\end{cases} $$\nwhere $p = P(S=1)$ is the probability that a collision event results in an absorption.\n\nThe expected value of a Bernoulli random variable is given by the probability of success. In this context, \"success\" is defined as an absorption event.\n$$ \\mathbb{E}[S] = (1) \\cdot P(S=1) + (0) \\cdot P(S=0) = P(S=1) $$\nTherefore, the task reduces to finding the probability that a randomly chosen collision event is an absorption. This is the \"per-collision\" probability of absorption.\n\nThe problem states that the derivation should be based on foundational definitions from neutron transport theory. The two primary definitions to be used are the expressions for reaction rate densities and the nature of the collision process.\n\nLet $\\phi(\\mathbf{r})$ be the scalar neutron flux at position $\\mathbf{r}$. The reaction rate density for a reaction of type $x$ at position $\\mathbf{r}$ is given by the product of the macroscopic cross section for that reaction, $\\Sigma_x$, and the scalar flux $\\phi(\\mathbf{r})$.\nThe total collision rate density at $\\mathbf{r}$ is:\n$$ R_{t}(\\mathbf{r}) = \\Sigma_{t} \\phi(\\mathbf{r}) $$\nThe absorption rate density at $\\mathbf{r}$ is:\n$$ R_{a}(\\mathbf{r}) = \\Sigma_{a} \\phi(\\mathbf{r}) $$\nThese rate densities represent the number of events per unit volume per unit time.\n\nThe probability of a particular reaction type occurring, given that a collision has taken place at a point $\\mathbf{r}$, is the ratio of the rate density for that specific reaction to the total collision rate density at that same point. This follows from the fact that the total macroscopic cross section $\\Sigma_t$ is the sum of all partial macroscopic cross sections, i.e., $\\Sigma_t = \\Sigma_a + \\Sigma_s + \\dots$, where $\\Sigma_s$ represents scattering. The likelihood of any one channel being selected is proportional to its cross section.\n\nThus, the conditional probability of an absorption event, given a collision at position $\\mathbf{r}$, is:\n$$ P(\\text{absorption at } \\mathbf{r} | \\text{collision at } \\mathbf{r}) = \\frac{R_{a}(\\mathbf{r})}{R_{t}(\\mathbf{r})} $$\nSubstituting the expressions for the rate densities, we get:\n$$ P(\\text{absorption at } \\mathbf{r} | \\text{collision at } \\mathbf{r}) = \\frac{\\Sigma_{a} \\phi(\\mathbf{r})}{\\Sigma_{t} \\phi(\\mathbf{r})} $$\nThe problem specifies a steady-state neutron population, which implies the existence of a non-zero neutron flux, $\\phi(\\mathbf{r}) \\neq 0$, in the regions where collisions can occur. The constraint $\\Sigma_{t} > 0$ ensures that collisions are possible. Therefore, we can cancel the scalar flux $\\phi(\\mathbf{r})$ from the numerator and denominator.\n$$ P(\\text{absorption at } \\mathbf{r} | \\text{collision at } \\mathbf{r}) = \\frac{\\Sigma_{a}}{\\Sigma_{t}} $$\nThe medium is defined as homogeneous, meaning $\\Sigma_{a}$ and $\\Sigma_{t}$ are constants, independent of position $\\mathbf{r}$. Consequently, the probability of a collision resulting in an absorption is constant throughout the entire medium.\n\nThe probability $P(S=1)$ is precisely this per-collision probability of absorption:\n$$ P(S=1) = \\frac{\\Sigma_{a}}{\\Sigma_{t}} $$\nTherefore, the expected score per collision is:\n$$ \\mathbb{E}[S] = \\frac{\\Sigma_{a}}{\\Sigma_{t}} $$\nThis result is consistent with the problem's premise that the reaction channel is sampled \"according to its macroscopic cross section\". In a Monte Carlo simulation, after a collision site is determined, a random number $\\xi \\in [0, 1)$ is typically drawn to decide the reaction type. If $\\xi < \\Sigma_a / \\Sigma_t$, the reaction is absorption; otherwise, it is some other type of reaction (e.g., scattering). The probability of the former outcome is exactly $\\Sigma_a / \\Sigma_t$. The information about the exponential free-flight law dictates the spatial distribution of collisions but does not alter the probabilities of the outcomes at a given collision. The final expression is dimensionless, as required, since both $\\Sigma_{a}$ and $\\Sigma_{t}$ have units of inverse length.",
            "answer": "$$ \\boxed{\\frac{\\Sigma_{a}}{\\Sigma_{t}}} $$"
        },
        {
            "introduction": "A core challenge in Monte Carlo methods is not just obtaining the correct answer on average, but doing so with minimal statistical uncertainty for a given computational effort. This exercise introduces a classic and powerful variance reduction technique by comparing a straightforward 'analog' absorption estimator with a more abstract 'implicit capture' estimator. By deriving the variance for each and analyzing their ratio, you will gain direct insight into how replacing a stochastic event with its weighted expectation can dramatically improve simulation efficiency, a foundational concept in advanced Monte Carlo practice.",
            "id": "4212931",
            "problem": "A monoenergetic, normally incident neutron beam enters a homogeneous plane-parallel slab of thickness $L$ with vacuum boundaries. The medium has spatially uniform macroscopic total cross section $\\Sigma_{t}$ and macroscopic absorption cross section $\\Sigma_{a}$, with $\\Sigma_{a} \\le \\Sigma_{t}$ and macroscopic scattering cross section $\\Sigma_{s} = \\Sigma_{t} - \\Sigma_{a} \\ge 0$. Consider a Monte Carlo (MC) simulation in which each neutron history begins at the entrance face and travels initially normal to the slab. Focus on the single uncollided flight segment from the source to the first potential collision or to leakage at the exit face, and disregard any post-scatter transport (this isolates single-flight estimator behavior).\n\nDefine two absorption estimators for this single flight segment:\n- Analog absorption count: record $1$ if an absorption occurs at the first interaction before the neutron exits, and record $0$ otherwise.\n- Implicit capture fractional score: if a collision occurs within the slab, record the fractional score $c = \\Sigma_{a}/\\Sigma_{t}$ at that collision; if no collision occurs before exit, record $0$.\n\nStarting only from fundamental properties of homogeneous media transport (the exponential free-path law with rate $\\Sigma_{t}$ and selection of reaction type by relative macroscopic cross sections) and basic probability, derive:\n1. The expected number of analog absorptions per history for this single flight segment, expressed in closed form in terms of $\\Sigma_{a}$, $\\Sigma_{t}$, and $L$.\n2. The closed-form expression for the ratio of the analog absorption count variance to the implicit capture fractional-score variance for this single flight segment.\n\nProvide your final answer as a single analytic expression containing both quantities as a row vector $\\bigl[\\mathbb{E}[\\text{analog}],\\; R\\bigr]$, where $R$ is the variance ratio. No numerical evaluation is required, and no units should be included in the final expression.",
            "solution": "The problem asks for the expected value of an analog absorption estimator and the ratio of its variance to that of an implicit capture estimator for a single, uncollided neutron flight in a slab. The foundation of this analysis is the exponential probability law for particle transport in a homogeneous medium.\n\nThe probability density function (PDF) for the distance $x$ to the first collision is given by $p(x) = \\Sigma_{t} \\exp(-\\Sigma_{t} x)$ for $x \\ge 0$, where $\\Sigma_{t}$ is the macroscopic total cross section.\n\nFor a neutron starting at $x=0$ in a slab of thickness $L$, two mutually exclusive events can occur on its first flight:\n1.  A collision occurs within the slab, i.e., at a position $x \\in [0, L]$.\n2.  The neutron leaks from the slab without interaction, meaning its first collision distance is $x > L$.\n\nThe probability of a collision occurring within the slab, $P_{\\text{coll}}$, is the integral of the PDF from $x=0$ to $x=L$:\n$$P_{\\text{coll}} = \\int_{0}^{L} \\Sigma_{t} \\exp(-\\Sigma_{t} x) \\, dx = \\left[-\\exp(-\\Sigma_{t} x)\\right]_{0}^{L} = 1 - \\exp(-\\Sigma_{t} L)$$\nThe probability of leaking without a collision, $P_{\\text{leak}}$, is the survival probability over the distance $L$:\n$$P_{\\text{leak}} = \\int_{L}^{\\infty} \\Sigma_{t} \\exp(-\\Sigma_{t} x) \\, dx = \\left[-\\exp(-\\Sigma_{t} x)\\right]_{L}^{\\infty} = \\exp(-\\Sigma_{t} L)$$\nAs a necessary check, $P_{\\text{coll}} + P_{\\text{leak}} = \\left(1 - \\exp(-\\Sigma_{t} L)\\right) + \\exp(-\\Sigma_{t} L) = 1$.\n\nGiven that a collision occurs, the probability that this collision is an absorption event is the ratio of the macroscopic absorption cross section $\\Sigma_{a}$ to the total cross section $\\Sigma_{t}$. Let this conditional probability be $c = \\frac{\\Sigma_{a}}{\\Sigma_{t}}$.\n\n**1. Analog Absorption Estimator**\nLet $S_{an}$ be the random variable for the score of the analog absorption estimator. Per the problem definition:\n- $S_{an} = 1$ if an absorption occurs within the slab. This requires both a collision in the slab and that the collision is an absorption.\n- $S_{an} = 0$ otherwise (i.e., if there is a scattering collision or leakage).\n\nThe probability of scoring $1$ is:\n$$P(S_{an} = 1) = P(\\text{collision in slab}) \\times P(\\text{absorption} | \\text{collision}) = P_{\\text{coll}} \\times c$$\n$$P(S_{an} = 1) = \\left(1 - \\exp(-\\Sigma_{t} L)\\right) \\frac{\\Sigma_{a}}{\\Sigma_{t}}$$\nThe probability of scoring $0$ is $P(S_{an} = 0) = 1 - P(S_{an} = 1)$.\n\nThe expected value of the analog score, denoted $\\mathbb{E}[\\text{analog}]$, is:\n$$\\mathbb{E}[\\text{analog}] = 1 \\cdot P(S_{an} = 1) + 0 \\cdot P(S_{an} = 0) = P(S_{an} = 1)$$\n$$\\mathbb{E}[\\text{analog}] = \\frac{\\Sigma_{a}}{\\Sigma_{t}} \\left(1 - \\exp(-\\Sigma_{t} L)\\right)$$\nThis is the first quantity to be derived.\n\n**2. Ratio of Variances**\n\nTo find the ratio, we must first derive the variance for each estimator.\n\n**Variance of the Analog Estimator ($\\text{Var}[S_{an}]$)**\nThe analog score $S_{an}$ is a Bernoulli random variable with \"success\" probability $p = P(S_{an}=1)$. The variance of a Bernoulli variable is $p(1-p)$.\nLet $p_{an} = \\frac{\\Sigma_{a}}{\\Sigma_{t}} \\left(1 - \\exp(-\\Sigma_{t} L)\\right)$.\n$$\\text{Var}[S_{an}] = p_{an}(1-p_{an}) = \\frac{\\Sigma_{a}}{\\Sigma_{t}} \\left(1 - \\exp(-\\Sigma_{t} L)\\right) \\left[1 - \\frac{\\Sigma_{a}}{\\Sigma_{t}} \\left(1 - \\exp(-\\Sigma_{t} L)\\right)\\right]$$\n\n**Variance of the Implicit Capture Estimator ($\\text{Var}[S_{im}]$)**\nLet $S_{im}$ be the random variable for the score of the implicit capture estimator. Per the problem definition:\n- $S_{im} = c = \\frac{\\Sigma_{a}}{\\Sigma_{t}}$ if a collision occurs within the slab (probability $P_{\\text{coll}}$).\n- $S_{im} = 0$ if the neutron leaks (probability $P_{\\text{leak}}$).\n\nThe expected value of the implicit score is:\n$$\\mathbb{E}[S_{im}] = c \\cdot P_{\\text{coll}} + 0 \\cdot P_{\\text{leak}} = \\frac{\\Sigma_{a}}{\\Sigma_{t}} \\left(1 - \\exp(-\\Sigma_{t} L)\\right)$$\nNote that $\\mathbb{E}[S_{im}] = \\mathbb{E}[S_{an}]$, as expected for two unbiased estimators of the same quantity.\n\nTo find the variance, we use the formula $\\text{Var}[S_{im}] = \\mathbb{E}[S_{im}^2] - (\\mathbb{E}[S_{im}])^2$. First we calculate the expectation of the square of the score:\n$$\\mathbb{E}[S_{im}^2] = c^2 \\cdot P_{\\text{coll}} + 0^2 \\cdot P_{\\text{leak}} = \\left(\\frac{\\Sigma_{a}}{\\Sigma_{t}}\\right)^2 \\left(1 - \\exp(-\\Sigma_{t} L)\\right)$$\nNow, substituting into the variance formula:\n$$\\text{Var}[S_{im}] = \\left(\\frac{\\Sigma_{a}}{\\Sigma_{t}}\\right)^2 \\left(1 - \\exp(-\\Sigma_{t} L)\\right) - \\left[\\frac{\\Sigma_{a}}{\\Sigma_{t}} \\left(1 - \\exp(-\\Sigma_{t} L)\\right)\\right]^2$$\nFactoring out common terms yields:\n$$\\text{Var}[S_{im}] = \\left(\\frac{\\Sigma_{a}}{\\Sigma_{t}}\\right)^2 \\left(1 - \\exp(-\\Sigma_{t} L)\\right) \\left[1 - \\left(1 - \\exp(-\\Sigma_{t} L)\\right)\\right]$$\n$$\\text{Var}[S_{im}] = \\left(\\frac{\\Sigma_{a}}{\\Sigma_{t}}\\right)^2 \\left(1 - \\exp(-\\Sigma_{t} L)\\right) \\exp(-\\Sigma_{t} L)$$\n\n**Ratio of the Variances ($R$)**\nThe required ratio is $R = \\frac{\\text{Var}[S_{an}]}{\\text{Var}[S_{im}]}$.\n$$R = \\frac{\\frac{\\Sigma_{a}}{\\Sigma_{t}} \\left(1 - \\exp(-\\Sigma_{t} L)\\right) \\left[1 - \\frac{\\Sigma_{a}}{\\Sigma_{t}} \\left(1 - \\exp(-\\Sigma_{t} L)\\right)\\right]}{\\left(\\frac{\\Sigma_{a}}{\\Sigma_{t}}\\right)^2 \\left(1 - \\exp(-\\Sigma_{t} L)\\right) \\exp(-\\Sigma_{t} L)}$$\nAssuming $\\Sigma_{a} > 0$ and $L > 0$, we can cancel the common factor $\\frac{\\Sigma_{a}}{\\Sigma_{t}} \\left(1 - \\exp(-\\Sigma_{t} L)\\right)$ from the numerator and denominator:\n$$R = \\frac{1 - \\frac{\\Sigma_{a}}{\\Sigma_{t}} \\left(1 - \\exp(-\\Sigma_{t} L)\\right)}{\\frac{\\Sigma_{a}}{\\Sigma_{t}} \\exp(-\\Sigma_{t} L)}$$\nTo simplify, we multiply the numerator and the denominator by $\\Sigma_{t}$:\n$$R = \\frac{\\Sigma_{t} - \\Sigma_{a} \\left(1 - \\exp(-\\Sigma_{t} L)\\right)}{\\Sigma_{a} \\exp(-\\Sigma_{t} L)} = \\frac{\\Sigma_{t} - \\Sigma_{a} + \\Sigma_{a} \\exp(-\\Sigma_{t} L)}{\\Sigma_{a} \\exp(-\\Sigma_{t} L)}$$\nUsing the definition of the macroscopic scattering cross section $\\Sigma_{s} = \\Sigma_{t} - \\Sigma_{a}$:\n$$R = \\frac{\\Sigma_{s} + \\Sigma_{a} \\exp(-\\Sigma_{t} L)}{\\Sigma_{a} \\exp(-\\Sigma_{t} L)} = \\frac{\\Sigma_{s}}{\\Sigma_{a} \\exp(-\\Sigma_{t} L)} + 1$$\nRewritten to use only the originally specified variables $\\Sigma_a$, $\\Sigma_t$, and $L$:\n$$R = 1 + \\frac{\\Sigma_{t} - \\Sigma_{a}}{\\Sigma_{a}} \\exp(\\Sigma_{t} L)$$\n\nThe two derived quantities are thus:\n1. $\\mathbb{E}[\\text{analog}] = \\frac{\\Sigma_{a}}{\\Sigma_{t}} \\left(1 - \\exp(-\\Sigma_{t} L)\\right)$\n2. $R = 1 + \\frac{\\Sigma_{t} - \\Sigma_{a}}{\\Sigma_{a}} \\exp(\\Sigma_{t} L)$\nThese are to be presented as a single row vector.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\Sigma_{a}}{\\Sigma_{t}}\\left(1 - \\exp(-\\Sigma_{t}L)\\right) & 1 + \\frac{\\Sigma_{t} - \\Sigma_{a}}{\\Sigma_{a}}\\exp(\\Sigma_{t}L) \\end{pmatrix}}$$"
        },
        {
            "introduction": "Practical reactor simulations must discretize continuous physical variables like neutron energy, a process that can introduce numerical bias if not handled carefully. This advanced practice confronts this issue head-on by analyzing the error that arises when a continuous, energy-dependent fission cross section is approximated by a single value within an energy group. You will use Taylor series analysis to derive the leading-order bias and, more importantly, construct a corrective weighting function to restore accuracy, demonstrating a sophisticated technique used to ensure the fidelity of modern production-level simulation codes.",
            "id": "4212935",
            "problem": "Consider a homogeneous medium with a stationary, continuous-energy neutron flux $ \\phi(E) $ and continuous-energy microscopic fission cross section $ \\sigma_{f}(E) $. Let $ \\nu(E) $ denote the average number of neutrons emitted per fission at energy $ E $. The fission production rate per unit volume in an energy interval $ \\mathcal{B} = [E_{0} - \\Delta E/2,\\, E_{0} + \\Delta E/2] $ is defined from first principles as\n$$\nR_{\\text{true}} \\equiv \\int_{\\mathcal{B}} \\nu(E)\\,\\sigma_{f}(E)\\,\\phi(E)\\,dE.\n$$\nIn a commonly used discrete-energy approximation, one replaces the energy dependence of $ \\nu(E)\\sigma_{f}(E) $ within $ \\mathcal{B} $ by its mid-bin value at the bin center $ E_{0} $. Defining $ g(E) \\equiv \\nu(E)\\sigma_{f}(E) $ and $ g_{0} \\equiv g(E_{0}) $, the mid-bin fission production estimator reads\n$$\nR_{\\text{mid}} \\equiv g_{0} \\int_{\\mathcal{B}} \\phi(E)\\,dE.\n$$\nAssume $ g(E) $ and $ \\phi(E) $ are twice continuously differentiable over $ \\mathcal{B} $ and that $ \\Delta E $ is sufficiently small so that a Taylor expansion about $ E_{0} $ is valid through second order. Define the flux-weighted raw moments over $ \\mathcal{B} $ by\n$$\nM_{n} \\equiv \\int_{\\mathcal{B}} \\phi(E)\\,\\big(E - E_{0}\\big)^{n}\\,dE,\\quad n \\in \\{0,1,2\\},\n$$\nand the derivatives of $ g $ at $ E_{0} $ by $ g_{k} \\equiv \\left.\\frac{d^{k}g}{dE^{k}}\\right|_{E=E_{0}} $ for $ k \\in \\{0,1,2\\} $. \n\nStarting only from these definitions and smoothness assumptions, and without invoking any pre-derived bias formulas, do the following:\n\n1) Derive the leading-order expression (through second order in $ \\Delta E $) for the bias \n$$\nB \\equiv R_{\\text{mid}} - R_{\\text{true}},\n$$\nexpressed explicitly in terms of $ g_{1} $, $ g_{2} $, $ M_{1} $, and $ M_{2} $.\n\n2) Propose a corrective, dimensionless weighting function $ w(E) $ such that the corrected mid-bin estimator\n$$\nR_{\\text{corr}} \\equiv g_{0}\\int_{\\mathcal{B}}\\phi(E)\\,w(E)\\,dE\n$$\nmatches $ R_{\\text{true}} $ through second order in $ \\Delta E $, and give $ w(E) $ explicitly through quadratic order in $ \\big(E - E_{0}\\big) $ in terms of $ g_{0} $, $ g_{1} $, and $ g_{2} $ evaluated at $ E_{0} $. \n\nYour final answer must consist of the pair of analytic expressions for $ B $ and $ w(E) $. No numerical evaluation is required. Express your final answer as a single row matrix containing these two expressions. No units are required.",
            "solution": "The problem asks for two derivations related to the discretization error, or bias, in estimating a fission reaction rate in a nuclear system. First, we derive the leading-order expression for the bias of a mid-bin estimator. Second, we derive a corrective weighting function to eliminate this bias up to second order.\n\nPart 1: Derivation of the bias $B$\n\nThe bias is defined as $B \\equiv R_{\\text{mid}} - R_{\\text{true}}$. We are given the definitions:\n$$\nR_{\\text{true}} = \\int_{\\mathcal{B}} g(E)\\,\\phi(E)\\,dE\n$$\n$$\nR_{\\text{mid}} = g_{0} \\int_{\\mathcal{B}} \\phi(E)\\,dE\n$$\nwhere $g(E) \\equiv \\nu(E)\\sigma_{f}(E)$ and $g_{0} \\equiv g(E_{0})$. The energy bin is $ \\mathcal{B} = [E_{0} - \\Delta E/2,\\, E_{0} + \\Delta E/2] $.\n\nThe core of the derivation is to relate $R_{\\text{true}}$ to $R_{\\text{mid}}$. We can achieve this by expanding the function $g(E)$ in a Taylor series around the bin center $E_{0}$. The problem states that $g(E)$ is twice continuously differentiable and that $\\Delta E$ is small enough to validate a second-order expansion. The Taylor expansion of $g(E)$ around $E_{0}$ is:\n$$\ng(E) = g(E_{0}) + (E - E_{0}) \\left.\\frac{dg}{dE}\\right|_{E=E_{0}} + \\frac{(E - E_{0})^{2}}{2!} \\left.\\frac{d^{2}g}{dE^{2}}\\right|_{E=E_{0}} + O\\left((E-E_0)^3\\right)\n$$\nUsing the provided notation $g_{k} \\equiv \\left.\\frac{d^{k}g}{dE^{k}}\\right|_{E=E_{0}}$, this becomes:\n$$\ng(E) = g_{0} + g_{1}(E - E_{0}) + \\frac{g_{2}}{2}(E - E_{0})^{2} + \\dots\n$$\nWe substitute this expansion into the definition of $R_{\\text{true}}$ and integrate over the bin $\\mathcal{B}$, truncating at the second-order term as specified:\n$$\nR_{\\text{true}} \\approx \\int_{\\mathcal{B}} \\left[ g_{0} + g_{1}(E - E_{0}) + \\frac{g_{2}}{2}(E - E_{0})^{2} \\right] \\phi(E) \\,dE\n$$\nBy linearity of the integral, we can separate the terms:\n$$\nR_{\\text{true}} \\approx g_{0} \\int_{\\mathcal{B}} \\phi(E) \\,dE + g_{1} \\int_{\\mathcal{B}} (E - E_{0})\\phi(E) \\,dE + \\frac{g_{2}}{2} \\int_{\\mathcal{B}} (E - E_{0})^{2}\\phi(E) \\,dE\n$$\nNow, we use the definition of the flux-weighted raw moments, $M_{n} \\equiv \\int_{\\mathcal{B}} \\phi(E)\\,\\big(E - E_{0}\\big)^{n}\\,dE$:\n$$\n\\int_{\\mathcal{B}} \\phi(E) \\,dE = M_{0}\n$$\n$$\n\\int_{\\mathcal{B}} (E - E_{0})\\phi(E) \\,dE = M_{1}\n$$\n$$\n\\int_{\\mathcal{B}} (E - E_{0})^{2}\\phi(E) \\,dE = M_{2}\n$$\nSubstituting these moment definitions into our expression for $R_{\\text{true}}$ yields the second-order approximation:\n$$\nR_{\\text{true}} \\approx g_{0} M_{0} + g_{1} M_{1} + \\frac{g_{2}}{2} M_{2}\n$$\nThe mid-bin estimator can also be expressed in terms of the zeroth moment:\n$$\nR_{\\text{mid}} = g_{0} \\int_{\\mathcal{B}} \\phi(E)\\,dE = g_{0} M_{0}\n$$\nNow we can compute the bias $B = R_{\\text{mid}} - R_{\\text{true}}$ by substituting the expressions we have found:\n$$\nB \\approx (g_{0} M_{0}) - \\left(g_{0} M_{0} + g_{1} M_{1} + \\frac{g_{2}}{2} M_{2}\\right)\n$$\n$$\nB \\approx -g_{1} M_{1} - \\frac{g_{2}}{2} M_{2}\n$$\nThis is the leading-order expression for the bias, expressed in terms of the requested quantities.\n\nPart 2: Derivation of the corrective weighting function $w(E)$\n\nWe are asked to find a dimensionless weighting function $w(E)$ such that the corrected estimator, $R_{\\text{corr}} \\equiv g_{0}\\int_{\\mathcal{B}}\\phi(E)\\,w(E)\\,dE$, matches $R_{\\text{true}}$ through second order. This means we require $R_{\\text{corr}} \\approx R_{\\text{true}}$ to the order we considered previously.\n$$\ng_{0}\\int_{\\mathcal{B}}\\phi(E)\\,w(E)\\,dE = \\int_{\\mathcal{B}} g(E)\\,\\phi(E)\\,dE\n$$\nThis equality is most directly satisfied if the integrands are equal for all $E \\in \\mathcal{B}$. Assuming $\\phi(E)$ is not identically zero in the bin, we can posit:\n$$\ng_{0}\\phi(E)\\,w(E) = g(E)\\,\\phi(E)\n$$\nThis simplifies to:\n$$\nw(E) = \\frac{g(E)}{g_{0}}\n$$\nThe problem asks for $w(E)$ explicitly through quadratic order in $(E - E_{0})$. To obtain this, we again use the Taylor expansion of $g(E)$ around $E_{0}$:\n$$\ng(E) \\approx g_{0} + g_{1}(E - E_{0}) + \\frac{g_{2}}{2}(E - E_{0})^{2}\n$$\nSubstituting this into our expression for $w(E)$:\n$$\nw(E) \\approx \\frac{1}{g_{0}} \\left[ g_{0} + g_{1}(E - E_{0}) + \\frac{g_{2}}{2}(E - E_{0})^{2} \\right]\n$$\nDistributing the $1/g_{0}$ term, we obtain the final expression for the weighting function, which is a quadratic polynomial in $(E-E_{0})$:\n$$\nw(E) \\approx 1 + \\frac{g_{1}}{g_{0}}(E - E_{0}) + \\frac{g_{2}}{2g_{0}}(E - E_{0})^{2}\n$$\nThis function, when used in the corrected estimator definition, effectively re-incorporates the first- and second-order variations of the cross section $g(E)$ across the energy bin, thus canceling the leading-order bias terms derived in Part 1. The resulting corrected estimator $R_{\\text{corr}}$ matches $R_{\\text{true}}$ to second order.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-g_{1} M_1 - \\frac{1}{2} g_{2} M_2 & 1 + \\frac{g_{1}}{g_{0}}(E - E_{0}) + \\frac{g_{2}}{2g_{0}}(E - E_{0})^{2}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}