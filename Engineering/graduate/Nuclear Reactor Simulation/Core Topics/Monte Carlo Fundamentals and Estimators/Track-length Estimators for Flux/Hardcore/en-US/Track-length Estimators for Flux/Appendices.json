{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a concrete application of the track-length estimator by using it to calculate a total reaction rate in a simple geometry. By comparing the result to both a collision-based estimate and a precise analytical solution, you will gain a tangible understanding of how Monte Carlo tallies relate to physical quantities. This practice is fundamental for appreciating the statistical nature of the results and for building confidence in the physical meaning of the track-length tally .",
            "id": "4246745",
            "problem": "A one-speed, steady-state Monte Carlo (MC) neutron transport simulation is performed for a plane-parallel slab of homogeneous material with area $A$ and thickness $L$. The slab has uniform macroscopic absorption cross section $\\Sigma_{a}$ and macroscopic scattering cross section $\\Sigma_{s}$, and is irradiated from one face such that the scalar neutron flux field inside the slab is prescribed and non-uniform, given by $\\phi(x)$ for $x \\in [0,L]$. Consider the absorption reaction type $i = a$. The simulation records both the total track-length traversed by all neutron histories within the slab during a fixed accumulation time and the number of absorption collisions that occurred within the slab during the same time. The objective is to compute the absorption reaction rate for the slab using two estimators and to reconcile any differences attributable to finite sampling.\n\nFundamental base:\n- The reaction rate density for reaction type $i$ is $r_{i}(\\mathbf{r}) = \\Sigma_{i}(\\mathbf{r}) \\,\\phi(\\mathbf{r})$, and the total reaction rate in a volume $V$ is $R_{i} = \\int_{V} \\Sigma_{i}(\\mathbf{r}) \\,\\phi(\\mathbf{r}) \\, \\mathrm{d}V$.\n- In a track-length tally, the volume integral of flux satisfies $\\int_{V} \\phi(\\mathbf{r}) \\,\\mathrm{d}V = \\lim_{\\Delta t \\to \\infty} \\left[ \\text{total track-length in }V \\text{ per unit time} \\right]$ for stationary transport with unit-normalized particle weights.\n- In an analog collision tally, the reaction rate $R_{i}$ equals the expected number of collisions of type $i$ per unit time in $V$.\n\nScenario data:\n- Geometry: $A = 200$ cm$^{2}$, $L = 15$ cm, so $V = A L$.\n- Cross sections: $\\Sigma_{a} = 0.06$ cm$^{-1}$ and $\\Sigma_{s} = 0.14$ cm$^{-1}$ (all spatially constant).\n- Flux field: $\\phi(x) = \\phi_{0} \\,\\exp(-\\alpha x)$ with $\\phi_{0} = 1.5 \\times 10^{12}$ cm$^{-2}$ s$^{-1}$ and $\\alpha = 0.08$ cm$^{-1}$.\n- MC tallies over $\\Delta t = 1$ s within the slab: total track-length $L_{\\text{obs}} = 2.598 \\times 10^{15}$ cm and absorption-collision count $C_{\\text{obs}} = 1.548 \\times 10^{14}$.\n\nTasks:\n1) Starting from the fundamental definitions above, construct the track-length estimator for the total absorption reaction rate in the slab, and compute its numerical value from the given MC track-length tally.\n2) Construct the collision estimator for the total absorption reaction rate in the slab, and compute its numerical value from the given MC collision tally.\n3) Using the given flux field $\\phi(x)$ and $\\Sigma_{a}$, compute the physics-constrained absorption reaction rate by direct integration over the slab.\n4) Reconcile differences between the two MC estimators and the physics-constrained value by taking the physics-constrained value as the reconciled estimate of the absorption reaction rate.\n\nExpress the reconciled absorption reaction rate in s$^{-1}$. Round your final answer to four significant figures.",
            "solution": "The problem requires the calculation of the total absorption reaction rate in a slab using three different methods: a track-length estimator from Monte Carlo (MC) data, a collision estimator from MC data, and direct analytical integration using a prescribed flux profile. The final answer is to be the reconciled value, defined as the result from the direct integration, rounded to four significant figures.\n\nThe fundamental definition for the total reaction rate of type $i$ in a volume $V$ is given by:\n$$R_{i} = \\int_{V} \\Sigma_{i}(\\mathbf{r}) \\phi(\\mathbf{r}) \\mathrm{d}V$$\nFor this problem, the reaction type is absorption ($i=a$), so we are interested in the total absorption rate $R_a$. The geometry is a plane-parallel slab of area $A$ and thickness $L$. The volume element is $\\mathrm{d}V = A \\mathrm{d}x$. The macroscopic absorption cross section $\\Sigma_a$ is spatially constant, and the scalar flux $\\phi$ depends only on the spatial coordinate $x$. The integral simplifies to:\n$$R_{a} = \\int_{0}^{L} \\Sigma_{a} \\phi(x) (A \\mathrm{d}x) = A \\Sigma_{a} \\int_{0}^{L} \\phi(x) \\mathrm{d}x$$\n\n**1. Track-Length Estimator for the Absorption Reaction Rate**\n\nThe track-length estimator for a reaction rate is derived from the fact that the volume-integrated scalar flux, $\\int_V \\phi(\\mathbf{r}) \\mathrm{d}V$, is equal to the total path length traversed by all particles per unit time. For an MC simulation run over a time interval $\\Delta t$, the expected total track length, $\\langle L_{\\text{total}} \\rangle$, is:\n$$\\langle L_{\\text{total}} \\rangle = \\Delta t \\int_{V} \\phi(\\mathbf{r}) \\mathrm{d}V$$\nThe observed total track-length, $L_{\\text{obs}}$, is a statistical sample of $\\langle L_{\\text{total}} \\rangle$. Therefore, we can estimate the volume-integrated flux as:\n$$\\int_{V} \\phi(\\mathbf{r}) \\mathrm{d}V \\approx \\frac{L_{\\text{obs}}}{\\Delta t}$$\nThe track-length estimator for the total absorption rate, $R_{a, \\text{TL}}$, is obtained by substituting this into the definition of $R_a$ (for constant $\\Sigma_a$):\n$$R_{a, \\text{TL}} = \\Sigma_{a} \\left( \\int_{V} \\phi(\\mathbf{r}) \\mathrm{d}V \\right) \\approx \\Sigma_{a} \\left( \\frac{L_{\\text{obs}}}{\\Delta t} \\right)$$\nUsing the given MC tally data:\n$\\Sigma_{a} = 0.06 \\text{ cm}^{-1}$\n$L_{\\text{obs}} = 2.598 \\times 10^{15} \\text{ cm}$\n$\\Delta t = 1 \\text{ s}$\n\nThe numerical value is:\n$$R_{a, \\text{TL}} = (0.06 \\text{ cm}^{-1}) \\left( \\frac{2.598 \\times 10^{15} \\text{ cm}}{1 \\text{ s}} \\right) = 1.5588 \\times 10^{14} \\text{ s}^{-1}$$\n\n**2. Collision Estimator for the Absorption Reaction Rate**\n\nThe collision estimator is based on the direct physical meaning of the reaction rate. The total reaction rate $R_i$ is, by definition, the expected number of reactions of type $i$ occurring per unit time. If an MC simulation tallies $C_{\\text{obs}}$ absorption collisions over a time $\\Delta t$, this count is a statistical sample of the expected number of absorptions, $\\langle N_a \\rangle = R_a \\Delta t$.\nThus, the collision estimator for the absorption rate, $R_{a, \\text{C}}$, is:\n$$R_{a, \\text{C}} = \\frac{C_{\\text{obs}}}{\\Delta t}$$\nUsing the given MC tally data:\n$C_{\\text{obs}} = 1.548 \\times 10^{14}$\n$\\Delta t = 1 \\text{ s}$\n\nThe numerical value is:\n$$R_{a, \\text{C}} = \\frac{1.548 \\times 10^{14}}{1 \\text{ s}} = 1.548 \\times 10^{14} \\text{ s}^{-1}$$\n\n**3. Physics-Constrained Absorption Reaction Rate (Direct Integration)**\n\nThe physics-constrained value is the exact theoretical reaction rate, calculated by direct integration using the prescribed analytical form of the flux. Let this be $R_{a, \\text{exact}}$.\n$$R_{a, \\text{exact}} = A \\Sigma_{a} \\int_{0}^{L} \\phi(x) \\mathrm{d}x$$\nWe substitute the given flux profile, $\\phi(x) = \\phi_0 \\exp(-\\alpha x)$:\n$$R_{a, \\text{exact}} = A \\Sigma_{a} \\phi_0 \\int_{0}^{L} \\exp(-\\alpha x) \\mathrm{d}x$$\nThe integral is elementary:\n$$\\int_{0}^{L} \\exp(-\\alpha x) \\mathrm{d}x = \\left[ -\\frac{1}{\\alpha} \\exp(-\\alpha x) \\right]_{0}^{L} = -\\frac{1}{\\alpha} (\\exp(-\\alpha L) - \\exp(0)) = \\frac{1 - \\exp(-\\alpha L)}{\\alpha}$$\nSubstituting this result back gives the full analytical expression:\n$$R_{a, \\text{exact}} = \\frac{A \\Sigma_{a} \\phi_0}{\\alpha} (1 - \\exp(-\\alpha L))$$\nNow, we substitute the provided numerical values:\n$A = 200 \\text{ cm}^2$\n$L = 15 \\text{ cm}$\n$\\Sigma_{a} = 0.06 \\text{ cm}^{-1}$\n$\\phi_{0} = 1.5 \\times 10^{12} \\text{ cm}^{-2}\\text{s}^{-1}$\n$\\alpha = 0.08 \\text{ cm}^{-1}$\n\nFirst, calculate the argument of the exponential:\n$\\alpha L = (0.08 \\text{ cm}^{-1})(15 \\text{ cm}) = 1.2$\n\nNext, calculate the pre-factor:\n$$\\frac{A \\Sigma_{a} \\phi_0}{\\alpha} = \\frac{(200 \\text{ cm}^2)(0.06 \\text{ cm}^{-1})(1.5 \\times 10^{12} \\text{ cm}^{-2}\\text{s}^{-1})}{0.08 \\text{ cm}^{-1}} = \\frac{1.8 \\times 10^{13} \\text{ s}^{-1}}{0.08} = 2.25 \\times 10^{14} \\text{ s}^{-1}$$\nFinally, we compute $R_{a, \\text{exact}}$:\n$$R_{a, \\text{exact}} = (2.25 \\times 10^{14} \\text{ s}^{-1}) (1 - \\exp(-1.2))$$\n$$R_{a, \\text{exact}} \\approx (2.25 \\times 10^{14} \\text{ s}^{-1}) (1 - 0.3011942) = (2.25 \\times 10^{14} \\text{ s}^{-1}) (0.6988058)$$\n$$R_{a, \\text{exact}} \\approx 1.572313 \\times 10^{14} \\text{ s}^{-1}$$\n\n**4. Reconciliation of Values**\n\nThe three computed values for the total absorption reaction rate are:\n- Track-Length Estimate: $R_{a, \\text{TL}} \\approx 1.559 \\times 10^{14} \\text{ s}^{-1}$\n- Collision Estimate: $R_{a, \\text{C}} = 1.548 \\times 10^{14} \\text{ s}^{-1}$\n- Physics-Constrained (Exact): $R_{a, \\text{exact}} \\approx 1.572 \\times 10^{14} \\text{ s}^{-1}$\n\nThe track-length and collision estimators are results from a single realization of a stochastic Monte Carlo simulation. As such, they are subject to statistical fluctuations (\"finite sampling\" error). The physics-constrained value, derived from direct integration of the given analytical flux profile, represents the true expected value that the Monte Carlo estimators would converge to in the limit of an infinite number of particle histories. The small discrepancies between the MC estimates and the exact value are consistent with this statistical interpretation.\n\nThe problem states that the reconciled estimate is the physics-constrained value. Therefore, the final answer is $R_{a, \\text{exact}}$, rounded to four significant figures.\n$$R_{a, \\text{reconciled}} = 1.572 \\times 10^{14} \\text{ s}^{-1}$$",
            "answer": "$$\\boxed{1.572 \\times 10^{14}}$$"
        },
        {
            "introduction": "Building upon the concept of a global tally, this practice explores the creation of spatially resolved flux maps, a core task in reactor analysis. You will implement a mesh-based track-length tally and, in doing so, confront the important distinction between two sources of error: statistical uncertainty from the Monte Carlo sampling and discretization error from representing a continuous field with a finite mesh. This exercise develops essential practical skills for interpreting and assessing the quality of spatially dependent simulation results .",
            "id": "4258089",
            "problem": "You are asked to formalize and compute mesh-based spatial tallies of the scalar flux using the track-length idea in a one-dimensional slab, and to quantify the discretization error that arises from representing a continuous field by piecewise-constant cell averages. The setting is a one-dimensional slab domain with spatial coordinate $x \\in [0, L]$ and unit cross-sectional area $A = 1$ so that volumes coincide with lengths in centimeters. The continuous scalar flux field is given by an exponential profile $ \\phi(x) = \\phi_0 \\exp(-\\alpha x) $ for $x \\in [0, L]$, with $ \\phi_0 > 0 $ and $ \\alpha > 0 $ constants. You will be provided deterministic straight-line tracks along $x$ with positive or zero weights. Each track is specified by its endpoints $(x_0, x_1)$ in centimeters and a dimensionless weight $w$, and represents a particle path segment. Assume the tracks are the ones available to you for tallying; do not generate new tracks.\n\nThe mesh tally should produce the cell-averaged flux values using the track-length concept: for a uniform mesh of $M$ cells over $[0,L]$, the $i$-th cell has bounds $[x_{i-1}, x_i]$ with $ x_0 = 0 $, $ x_M = L $, and $ x_i = i \\, \\Delta x $, where $ \\Delta x = L / M $. To score the track-length in a cell, intersect each track segment with the cell interval and accumulate the overlap length. The estimated cell-averaged flux is the appropriately normalized track-length sum divided by the cell volume (length). Separately, compute the exact cell-averaged flux as the volume integral of $ \\phi(x) $ over the cell divided by the cell length. Using these two sets of cell averages, compute the following two error metrics:\n\n- The root-mean-square relative deviation between the track-length estimated cell averages and the exact cell averages, defined as\n$$ e_{\\text{RMS}} = \\sqrt{ \\frac{1}{M} \\sum_{i=1}^{M} \\left( \\frac{ \\hat{\\bar{\\phi}}_i - \\bar{\\phi}_i }{ \\bar{\\phi}_i } \\right)^2 } \\;, $$\nwhere $ \\hat{\\bar{\\phi}}_i $ is the estimated cell-averaged flux in cell $i$ computed from the track-length tally and $ \\bar{\\phi}_i $ is the exact cell-averaged flux in the same cell.\n\n- The discretization error associated with representing the continuous field $ \\phi(x) $ by a piecewise-constant approximation equal to the exact cell averages, measured by the $L^2$ relative error:\n$$ E_{\\text{disc}} = \\sqrt{ \\frac{ \\int_{0}^{L} \\left( \\phi_h(x) - \\phi(x) \\right)^2 \\, dx }{ \\int_{0}^{L} \\phi(x)^2 \\, dx } } \\;, $$\nwhere $ \\phi_h(x) = \\bar{\\phi}_i $ for $ x \\in [x_{i-1}, x_i] $.\n\nAll lengths must be treated in centimeters, and all final answers should be dimensionless decimals. Angles are not used. The algorithm must be deterministic, based solely on the provided parameters.\n\nTest Suite. For each test case below, compute $ e_{\\text{RMS}} $ and $ E_{\\text{disc}} $ and produce them in order. The program must produce a single line containing the six results as a comma-separated list enclosed in square brackets, specifically $[e_{\\text{RMS}}^{(1)}, E_{\\text{disc}}^{(1)}, e_{\\text{RMS}}^{(2)}, E_{\\text{disc}}^{(2)}, e_{\\text{RMS}}^{(3)}, E_{\\text{disc}}^{(3)}]$.\n\n- Test Case $1$ (general case):\n  - Domain length $L = 10$ $\\text{cm}$.\n  - Mesh cell count $M = 5$.\n  - Flux parameters $ \\phi_0 = 2.0 $ (in neutrons per square centimeter per second) and $ \\alpha = 0.2 $ $\\text{cm}^{-1}$.\n  - Tracks $[(x_0, x_1, w)]$:\n    - $(0.0, 3.5, 1.0)$,\n    - $(1.2, 9.8, 1.0)$,\n    - $(2.0, 6.1, 1.0)$,\n    - $(4.0, 10.0, 1.0)$.\n\n- Test Case $2$ (boundary and zero-length segments):\n  - Domain length $L = 10$ $\\text{cm}$.\n  - Mesh cell count $M = 10$.\n  - Flux parameters $ \\phi_0 = 1.0 $ (in neutrons per square centimeter per second) and $ \\alpha = 0.5 $ $\\text{cm}^{-1}$.\n  - Tracks $[(x_0, x_1, w)]$:\n    - $(-1.0, 2.0, 0.5)$,\n    - $(9.0, 12.0, 2.0)$,\n    - $(5.0, 5.0, 1.0)$,\n    - $(10.0, 10.0, 3.0)$,\n    - $(3.0, 7.5, 1.5)$.\n\n- Test Case $3$ (coarse mesh and mixed directions):\n  - Domain length $L = 10$ $\\text{cm}$.\n  - Mesh cell count $M = 1$.\n  - Flux parameters $ \\phi_0 = 5.0 $ (in neutrons per square centimeter per second) and $ \\alpha = 0.05 $ $\\text{cm}^{-1}$.\n  - Tracks $[(x_0, x_1, w)]$:\n    - $(0.0, 10.0, 1.0)$,\n    - $(2.5, 2.0, 0.7)$.\n\nAlgorithmic Requirements:\n- For each track $(x_0, x_1, w)$, clamp the segment to the domain $[0, L]$: let $a = \\max(0, \\min(x_0, x_1))$ and $b = \\min(L, \\max(x_0, x_1))$. If $b \\le a$, the segment contributes zero length to all cells.\n- For each cell $i$, compute the overlap length $ \\ell_{i} $ between $[a, b]$ and the cell interval $[x_{i-1}, x_i]$. Accumulate $ w \\, \\ell_{i} $ over all tracks to get $S_i$, the total weight-length in cell $i$. Let $W$ be the sum of all weights. Compute the track-length estimated cell-averaged flux as $ \\hat{\\bar{\\phi}}_i = S_i / ( W \\, \\Delta x ) $.\n- Compute exact cell-averaged flux $ \\bar{\\phi}_i $ by integrating $ \\phi(x) $ over the cell and dividing by $ \\Delta x $.\n- Compute $ e_{\\text{RMS}} $ across all $M$ cells, and compute $ E_{\\text{disc}} $ using the integral definition above.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the six results as a comma-separated list enclosed in square brackets, in the order $[e_{\\text{RMS}}^{(1)}, E_{\\text{disc}}^{(1)}, e_{\\text{RMS}}^{(2)}, E_{\\text{disc}}^{(2)}, e_{\\text{RMS}}^{(3)}, E_{\\text{disc}}^{(3)}]$.",
            "solution": "We start from the definition of scalar flux. In stationary neutron transport, the scalar flux at position $ \\mathbf{r} $ is defined as\n$$ \\phi(\\mathbf{r}) = \\int_{4\\pi} \\psi(\\mathbf{r}, \\hat{\\Omega}) \\, d\\Omega \\;, $$\nwhere $ \\psi(\\mathbf{r}, \\hat{\\Omega}) $ is the angular flux, the rate at which particles stream through $ \\mathbf{r} $ in direction $ \\hat{\\Omega} $ per unit solid angle per unit area. The volume average of the scalar flux over a region $ V $ is\n$$ \\bar{\\phi}_V = \\frac{1}{V} \\int_V \\phi(\\mathbf{r}) \\, dV \\;. $$\n\nThe track-length concept follows from interpreting $ \\phi(\\mathbf{r}) $ as a pathlength density. The expected total particle pathlength inside a volume $ V $ per source particle is equal to $ \\int_V \\phi(\\mathbf{r}) \\, dV $. In Monte Carlo, if we run $ N $ source particles and record the total track length $ \\ell_k $ contributed by particle $k$ within $ V $, then under analog sampling and weights $ w_k $, the unbiased estimator of $ \\int_V \\phi \\, dV $ per unit source particle weight is\n$$ \\widehat{ \\int_V \\phi \\, dV } = \\frac{1}{ \\sum_{k=1}^N w_k } \\sum_{k=1}^{N} w_k \\, \\ell_k \\;. $$\nDividing by the volume $V$ yields an estimator for the volume-averaged flux:\n$$ \\hat{\\bar{\\phi}}_V = \\frac{1}{V} \\cdot \\frac{1}{ \\sum_{k=1}^N w_k } \\sum_{k=1}^{N} w_k \\, \\ell_k \\;. $$\n\nFor a one-dimensional slab with unit cross-sectional area $A = 1$ and a uniform mesh of $M$ cells over $[0, L]$, the $i$-th cell is the interval $[x_{i-1}, x_i]$ with $ x_i = i \\, \\Delta x $ and $ \\Delta x = L / M $. The volume equals the length $ \\Delta x $. Given a track with endpoints $(x_0, x_1)$ and weight $w$, we clamp it to the domain by sorting endpoints and intersecting with $[0, L]$ to get $[a, b]$, where $ a = \\max(0, \\min(x_0, x_1)) $ and $ b = \\min(L, \\max(x_0, x_1)) $. If $ b \\le a $, the segment is fully outside the domain or zero-length and contributes nothing. The overlap length with cell $ i $ is\n$$ \\ell_{i} = \\max\\left( 0, \\min(b, x_i) - \\max(a, x_{i-1}) \\right) \\;. $$\nSumming $ w \\, \\ell_{i} $ over tracks yields $ S_i $. Let $ W = \\sum_k w_k $ be the total weight. The track-length estimated cell-averaged flux is\n$$ \\hat{\\bar{\\phi}}_i = \\frac{S_i}{ W \\, \\Delta x } \\;. $$\n\nThe exact cell-averaged flux for the exponential profile $ \\phi(x) = \\phi_0 \\exp(-\\alpha x) $ over $[x_{i-1}, x_i]$ is\n$$ \\bar{\\phi}_i = \\frac{1}{\\Delta x} \\int_{x_{i-1}}^{x_i} \\phi_0 \\, e^{ -\\alpha x } \\, dx = \\frac{\\phi_0}{\\alpha \\, \\Delta x} \\left( e^{ -\\alpha x_{i-1} } - e^{ -\\alpha x_i } \\right) \\;. $$\n\nWith both $ \\hat{\\bar{\\phi}}_i $ and $ \\bar{\\phi}_i $ in hand, we compute the root-mean-square relative deviation as\n$$ e_{\\text{RMS}} = \\sqrt{ \\frac{1}{M} \\sum_{i=1}^{M} \\left( \\frac{ \\hat{\\bar{\\phi}}_i - \\bar{\\phi}_i }{ \\bar{\\phi}_i } \\right)^2 } \\;. $$\n\nTo quantify discretization error associated with mesh tallies and spatial averaging, consider the piecewise-constant reconstruction $ \\phi_h(x) $ that equals the exact cell average in each cell: $ \\phi_h(x) = \\bar{\\phi}_i $ for $ x \\in [x_{i-1}, x_i] $. The $L^2$ relative error is\n$$ E_{\\text{disc}} = \\sqrt{ \\frac{ \\int_{0}^{L} \\left( \\phi_h(x) - \\phi(x) \\right)^2 \\, dx }{ \\int_{0}^{L} \\phi(x)^2 \\, dx } } \\;. $$\nThe denominator integral is straightforward:\n$$ \\int_{0}^{L} \\phi(x)^2 \\, dx = \\int_{0}^{L} \\phi_0^2 \\, e^{-2\\alpha x} \\, dx = \\frac{ \\phi_0^2 }{ 2 \\alpha } \\left( 1 - e^{-2\\alpha L} \\right) \\;. $$\nThe numerator decomposes over cells:\n$$ \\int_{0}^{L} \\left( \\phi_h(x) - \\phi(x) \\right)^2 \\, dx = \\sum_{i=1}^{M} \\int_{x_{i-1}}^{x_i} \\left( \\bar{\\phi}_i - \\phi_0 e^{ -\\alpha x } \\right)^2 dx \\;. $$\nExpanding the square yields, for each cell,\n\\begin{align*}\n\\int_{x_{i-1}}^{x_i} \\left( \\bar{\\phi}_i - \\phi_0 e^{ -\\alpha x } \\right)^2 dx\n&= \\int_{x_{i-1}}^{x_i} \\left( \\phi_0^2 e^{-2\\alpha x} - 2 \\bar{\\phi}_i \\phi_0 e^{ -\\alpha x } + \\bar{\\phi}_i^2 \\right) dx \\\\\n&= \\frac{ \\phi_0^2 }{ 2 \\alpha } \\left( e^{ -2\\alpha x_{i-1} } - e^{ -2\\alpha x_i } \\right)\n- \\frac{ 2 \\bar{\\phi}_i \\phi_0 }{ \\alpha } \\left( e^{ -\\alpha x_{i-1} } - e^{ -\\alpha x_i } \\right)\n+ \\bar{\\phi}_i^2 \\, \\Delta x \\;.\n\\end{align*}\nNoting that $ \\bar{\\phi}_i = \\frac{\\phi_0}{ \\alpha \\, \\Delta x } \\left( e^{ -\\alpha x_{i-1} } - e^{ -\\alpha x_i } \\right) $, the middle term will cancel part of the first term, but for implementation we can compute all terms exactly and sum.\n\nAlgorithmic plan:\n- For each test case, build the cell edges $ x_i $ and $ \\Delta x $.\n- Compute $ S_i $ via track overlap lengths and weights, and $ W $ via sum of weights.\n- Compute $ \\hat{\\bar{\\phi}}_i = S_i / ( W \\, \\Delta x ) $.\n- Compute $ \\bar{\\phi}_i = \\frac{\\phi_0}{\\alpha \\, \\Delta x} \\left( e^{ -\\alpha x_{i-1} } - e^{ -\\alpha x_i } \\right) $.\n- Compute $ e_{\\text{RMS}} $.\n- Compute $ E_{\\text{disc}} $ by summing the per-cell numerator integral and dividing by the exact denominator integral, and taking the square root.\n\nAll computations are deterministic and rely only on the provided inputs. The outputs are dimensionless decimals representing errors. The final program prints a single line $[e_{\\text{RMS}}^{(1)}, E_{\\text{disc}}^{(1)}, e_{\\text{RMS}}^{(2)}, E_{\\text{disc}}^{(2)}, e_{\\text{RMS}}^{(3)}, E_{\\text{disc}}^{(3)}]$ in that exact order.",
            "answer": "[0.0717208170889218,0.1136423497672202,0.17882255799781896,0.08208753239564883,0.003923508681329244,0.02875150085444855]"
        },
        {
            "introduction": "Effective simulation requires not just using estimators, but choosing the right one for the job. This exercise moves into the critical domain of estimator evaluation, presenting a scenario where a choice must be made between a biased and an unbiased estimator. By analyzing the trade-off between bias and variance through the lens of Mean Squared Error, you will learn how to make informed decisions that minimize total error, a more nuanced goal than simply maximizing the Figure of Merit (FOM) .",
            "id": "4251786",
            "problem": "A two-region, one-dimensional slab representation of a heterogeneous nuclear reactor core is simulated with Monte Carlo (MC) neutron transport to estimate the regionwise, energy-integrated scalar flux. Region $\\mathcal{F}$ represents fuel and region $\\mathcal{M}$ represents moderator. Two tallies are used for the flux: a track-length estimator and a collision estimator. The collision estimator implementation uses delta-tracking with a single majorant total cross section across the slab and scores with regionwise, group-homogenized total cross sections. An independent high-order reference provides the true flux in each region. The track-length estimator is expected to be unbiased under correct particle tracking, while the collision estimator can exhibit systematic bias in strongly heterogeneous media due to the cross section treatment.\n\nYou are given the following MC results for the same number of particle histories $N$, with wall-clock time per $10^5$ histories for each estimator reported as the computational cost. The reported standard deviations are the estimated standard deviations of the sample mean of the flux tally in each region.\n\nReference fluxes:\n- Region $\\mathcal{F}$ (fuel): $\\phi_{\\mathrm{ref},\\mathcal{F}} = 0.0500$.\n- Region $\\mathcal{M}$ (moderator): $\\phi_{\\mathrm{ref},\\mathcal{M}} = 0.1200$.\n\nTrack-length estimator:\n- Region $\\mathcal{F}$: sample mean $\\hat{\\phi}_{\\mathrm{TL},\\mathcal{F}} = 0.0496$, standard deviation $\\sigma_{\\mathrm{TL},\\mathcal{F}} = 0.0018$, wall-clock time per $10^5$ histories $t_{\\mathrm{TL}} = 12\\,\\mathrm{s}$.\n- Region $\\mathcal{M}$: sample mean $\\hat{\\phi}_{\\mathrm{TL},\\mathcal{M}} = 0.1189$, standard deviation $\\sigma_{\\mathrm{TL},\\mathcal{M}} = 0.0038$, wall-clock time per $10^5$ histories $t_{\\mathrm{TL}} = 12\\,\\mathrm{s}$.\n\nCollision estimator:\n- Region $\\mathcal{F}$: sample mean $\\hat{\\phi}_{\\mathrm{C},\\mathcal{F}} = 0.0515$, standard deviation $\\sigma_{\\mathrm{C},\\mathcal{F}} = 0.0011$, wall-clock time per $10^5$ histories $t_{\\mathrm{C}} = 16\\,\\mathrm{s}$.\n- Region $\\mathcal{M}$: sample mean $\\hat{\\phi}_{\\mathrm{C},\\mathcal{M}} = 0.1209$, standard deviation $\\sigma_{\\mathrm{C},\\mathcal{M}} = 0.0017$, wall-clock time per $10^5$ histories $t_{\\mathrm{C}} = 16\\,\\mathrm{s}$.\n\nAssume the track-length estimator is unbiased in both regions and the collision estimator biases arise only from the cross section treatment described. Based on first principles definitions of statistical uncertainty and error, determine the estimator selection in each region that minimizes expected squared error of the flux estimates, and contrast this with a selection that would be made purely by the Figure of Merit (FOM). Choose the option that best reflects the correct estimator choice per region under the objective of minimizing expected squared error, together with the correct interpretation of why an FOM-only choice could differ.\n\nOptions:\n\nA. Use the track-length estimator in both regions because it is unbiased; ignoring variance is acceptable when minimizing error.\n\nB. Use the collision estimator in both regions because it has lower variance and higher FOM; bias is negligible in heterogeneous cores.\n\nC. Use the track-length estimator in fuel and the collision estimator in moderator; in fuel the collision bias raises the expected squared error despite lower variance, whereas in moderator the collision estimator reduces expected squared error because its bias is small and its variance is much lower.\n\nD. Use the estimator with the higher FOM in each region regardless of bias; the FOM is the correct metric for minimizing expected squared error.",
            "solution": "The goal is to select the estimator that minimizes the Expected Squared Error (ESE) for the scalar flux $\\phi$ in each region. The ESE is defined by the bias-variance decomposition:\n$$ ESE(\\hat{\\phi}) = E[(\\hat{\\phi} - \\phi_{\\mathrm{ref}})^2] = (\\text{Bias})^2 + \\text{Variance} = B^2 + \\sigma^2 $$\nwhere the bias $B$ is the systematic error ($B \\approx \\hat{\\phi} - \\phi_{\\mathrm{ref}}$) and the variance $\\sigma^2$ is the square of the standard deviation of the mean.\n\nWe also consider the Figure of Merit (FOM), a metric for computational efficiency, defined as $\\mathrm{FOM} = 1/(\\sigma^2 T)$, where $T$ is the computation time. The FOM measures efficiency in reducing variance but does not account for bias.\n\nWe calculate the ESE for each estimator in each region. The track-length (TL) estimator is assumed to be unbiased ($B=0$).\n\n#### Region $\\mathcal{F}$ (Fuel)\n- Reference flux: $\\phi_{\\mathrm{ref},\\mathcal{F}} = 0.0500$\n\n**Track-Length Estimator (TL):**\n- Bias: $B_{\\mathrm{TL},\\mathcal{F}} = 0$.\n- Variance: $\\sigma^2_{\\mathrm{TL},\\mathcal{F}} = (0.0018)^2 = 3.24 \\times 10^{-6}$.\n- Expected Squared Error: $ESE_{\\mathrm{TL},\\mathcal{F}} = 0^2 + 3.24 \\times 10^{-6} = 3.24 \\times 10^{-6}$.\n\n**Collision Estimator (C):**\n- Bias: $B_{\\mathrm{C},\\mathcal{F}} = \\hat{\\phi}_{\\mathrm{C},\\mathcal{F}} - \\phi_{\\mathrm{ref},\\mathcal{F}} = 0.0515 - 0.0500 = 0.0015$.\n- Variance: $\\sigma^2_{\\mathrm{C},\\mathcal{F}} = (0.0011)^2 = 1.21 \\times 10^{-6}$.\n- Expected Squared Error: $ESE_{\\mathrm{C},\\mathcal{F}} = (0.0015)^2 + (0.0011)^2 = 2.25 \\times 10^{-6} + 1.21 \\times 10^{-6} = 3.46 \\times 10^{-6}$.\n\n**Comparison for Region $\\mathcal{F}$:**\n- $ESE_{\\mathrm{TL},\\mathcal{F}} (3.24 \\times 10^{-6})  ESE_{\\mathrm{C},\\mathcal{F}} (3.46 \\times 10^{-6})$.\n- To minimize total error, the **track-length estimator** is the better choice for the fuel region. Note that the collision estimator has a lower variance and thus a higher FOM, but its bias is large enough to make its total error greater.\n\n#### Region $\\mathcal{M}$ (Moderator)\n- Reference flux: $\\phi_{\\mathrm{ref},\\mathcal{M}} = 0.1200$\n\n**Track-Length Estimator (TL):**\n- Bias: $B_{\\mathrm{TL},\\mathcal{M}} = 0$.\n- Variance: $\\sigma^2_{\\mathrm{TL},\\mathcal{M}} = (0.0038)^2 = 1.444 \\times 10^{-5}$.\n- Expected Squared Error: $ESE_{\\mathrm{TL},\\mathcal{M}} = 0^2 + 1.444 \\times 10^{-5} = 1.444 \\times 10^{-5}$.\n\n**Collision Estimator (C):**\n- Bias: $B_{\\mathrm{C},\\mathcal{M}} = \\hat{\\phi}_{\\mathrm{C},\\mathcal{M}} - \\phi_{\\mathrm{ref},\\mathcal{M}} = 0.1209 - 0.1200 = 0.0009$.\n- Variance: $\\sigma^2_{\\mathrm{C},\\mathcal{M}} = (0.0017)^2 = 2.89 \\times 10^{-6}$.\n- Expected Squared Error: $ESE_{\\mathrm{C},\\mathcal{M}} = (0.0009)^2 + (0.0017)^2 = 0.81 \\times 10^{-6} + 2.89 \\times 10^{-6} = 3.70 \\times 10^{-6}$.\n\n**Comparison for Region $\\mathcal{M}$:**\n- $ESE_{\\mathrm{C},\\mathcal{M}} (3.70 \\times 10^{-6})  ESE_{\\mathrm{TL},\\mathcal{M}} (1.444 \\times 10^{-5})$.\n- To minimize total error, the **collision estimator** is the better choice for the moderator region. Here, the large reduction in variance offered by the collision estimator far outweighs the small error introduced by its bias.\n\n**Conclusion:**\nThe optimal strategy to minimize ESE is to use the track-length estimator in the fuel region and the collision estimator in the moderator region. This corresponds to option C, which correctly identifies the trade-off between bias and variance in each region.",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}