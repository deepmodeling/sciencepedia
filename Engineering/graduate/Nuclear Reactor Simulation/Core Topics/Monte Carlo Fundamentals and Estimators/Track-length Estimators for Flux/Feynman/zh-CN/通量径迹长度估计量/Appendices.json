{
    "hands_on_practices": [
        {
            "introduction": "通量的一个主要用途是计算反应率，这是反应堆物理中的一个核心量。本练习提供了一个具体的例子，说明如何使用径迹长度估计子来计算吸收反应率。通过将其与碰撞估计子和精确解析解进行比较，本练习旨在加深您对蒙特卡罗模拟中统计不确定性概念的理解 。",
            "id": "4246745",
            "problem": "对一块面积为 $A$、厚度为 $L$ 的均匀材料平行平面板，进行了一次单能、稳态的蒙特卡罗 (MC) 中子输运模拟。该板具有均匀的宏观吸收截面 $\\Sigma_{a}$ 和宏观散射截面 $\\Sigma_{s}$，并从一个面受到辐照，使得板内的标量中子通量场是给定的非均匀场，对于 $x \\in [0,L]$，由 $\\phi(x)$ 给出。考虑吸收反应类型 $i = a$。该模拟在固定的累积时间内，记录了所有中子历史在板内走过的总径迹长度，以及在同一时间内板内发生的吸收碰撞次数。目标是使用两种估计量计算该板的吸收反应率，并协调由有限取样引起的任何差异。\n\n基本原理：\n- 反应类型 $i$ 的反应率密度为 $r_{i}(\\mathbf{r}) = \\Sigma_{i}(\\mathbf{r}) \\,\\phi(\\mathbf{r})$，在体积 $V$ 内的总反应率为 $R_{i} = \\int_{V} \\Sigma_{i}(\\mathbf{r}) \\,\\phi(\\mathbf{r}) \\, \\mathrm{d}V$。\n- 在径迹长度统计中，对于单位归一化粒子权重的稳态输运，通量的体积积分满足 $\\int_{V} \\phi(\\mathbf{r}) \\,\\mathrm{d}V = \\lim_{\\Delta t \\to \\infty} \\left[ \\text{total track-length in }V \\text{ per unit time} \\right]$。\n- 在模拟碰撞统计中，反应率 $R_{i}$ 等于在 $V$ 内单位时间内 $i$ 类碰撞的期望次数。\n\n场景数据：\n- 几何：$A = 200$ cm$^{2}$，$L = 15$ cm，所以 $V = A L$。\n- 截面：$\\Sigma_{a} = 0.06$ cm$^{-1}$ 和 $\\Sigma_{s} = 0.14$ cm$^{-1}$ (均为空间常数)。\n- 通量场：$\\phi(x) = \\phi_{0} \\,\\exp(-\\alpha x)$，其中 $\\phi_{0} = 1.5 \\times 10^{12}$ cm$^{-2}$ s$^{-1}$ 且 $\\alpha = 0.08$ cm$^{-1}$。\n- 在 $\\Delta t = 1$ s 内对板的 MC 统计值：总径迹长度 $L_{\\text{obs}} = 2.598 \\times 10^{15}$ cm 和吸收碰撞计数 $C_{\\text{obs}} = 1.548 \\times 10^{14}$。\n\n任务：\n1) 从上述基本定义出发，构建板中总吸收反应率的径迹长度估计量，并根据给定的 MC 径迹长度统计值计算其数值。\n2) 构建板中总吸收反应率的碰撞估计量，并根据给定的 MC 碰撞统计值计算其数值。\n3) 使用给定的通量场 $\\phi(x)$ 和 $\\Sigma_{a}$，通过对板进行直接积分来计算物理约束的吸收反应率。\n4) 将物理约束值作为吸收反应率的协调估计值，以协调两种 MC 估计量与物理约束值之间的差异。\n\n以 s$^{-1}$ 为单位表示协调后的吸收反应率。将最终答案四舍五入至四位有效数字。",
            "solution": "该问题要求使用三种不同的方法计算板中的总吸收反应率：基于蒙特卡罗 (MC) 数据的径迹长度估计量、基于 MC 数据的碰撞估计量，以及使用给定的通量剖面进行的直接解析积分。最终答案应为协调值，该值定义为直接积分的结果，并四舍五入至四位有效数字。\n\n在体积 $V$ 中，类型为 $i$ 的总反应率的基本定义由下式给出：\n$$R_{i} = \\int_{V} \\Sigma_{i}(\\mathbf{r}) \\phi(\\mathbf{r}) \\mathrm{d}V$$\n对于此问题，反应类型为吸收 ($i=a$)，因此我们关心的是总吸收率 $R_a$。几何形状是面积为 $A$、厚度为 $L$ 的平行平面板。体积元为 $\\mathrm{d}V = A \\mathrm{d}x$。宏观吸收截面 $\\Sigma_a$ 在空间上是常数，标量通量 $\\phi$ 仅依赖于空间坐标 $x$。积分简化为：\n$$R_{a} = \\int_{0}^{L} \\Sigma_{a} \\phi(x) (A \\mathrm{d}x) = A \\Sigma_{a} \\int_{0}^{L} \\phi(x) \\mathrm{d}x$$\n\n**1. 吸收反应率的径迹长度估计量**\n\n反应率的径迹长度估计量源于这样一个事实：标量通量的体积积分 $\\int_V \\phi(\\mathbf{r}) \\mathrm{d}V$ 等于所有粒子在单位时间内走过的总路径长度。对于在时间间隔 $\\Delta t$ 内运行的 MC 模拟，期望总径迹长度 $\\langle L_{\\text{total}} \\rangle$ 为：\n$$\\langle L_{\\text{total}} \\rangle = \\Delta t \\int_{V} \\phi(\\mathbf{r}) \\mathrm{d}V$$\n观测到的总径迹长度 $L_{\\text{obs}}$ 是 $\\langle L_{\\text{total}} \\rangle$ 的一个统计样本。因此，我们可以将通量的体积积分估计为：\n$$\\int_{V} \\phi(\\mathbf{r}) \\mathrm{d}V \\approx \\frac{L_{\\text{obs}}}{\\Delta t}$$\n总吸收率的径迹长度估计量 $R_{a, \\text{TL}}$ 是通过将此式代入 $R_a$ 的定义（对于常数 $\\Sigma_a$）得到的：\n$$R_{a, \\text{TL}} = \\Sigma_{a} \\left( \\int_{V} \\phi(\\mathbf{r}) \\mathrm{d}V \\right) \\approx \\Sigma_{a} \\left( \\frac{L_{\\text{obs}}}{\\Delta t} \\right)$$\n使用给定的 MC 统计数据：\n$\\Sigma_{a} = 0.06 \\text{ cm}^{-1}$\n$L_{\\text{obs}} = 2.598 \\times 10^{15} \\text{ cm}$\n$\\Delta t = 1 \\text{ s}$\n\n其数值为：\n$$R_{a, \\text{TL}} = (0.06 \\text{ cm}^{-1}) \\left( \\frac{2.598 \\times 10^{15} \\text{ cm}}{1 \\text{ s}} \\right) = 1.5588 \\times 10^{14} \\text{ s}^{-1}$$\n\n**2. 吸收反应率的碰撞估计量**\n\n碰撞估计量基于反应率的直接物理意义。根据定义，总反应率 $R_i$ 是单位时间内发生的 $i$ 类型反应的期望次数。如果一次 MC 模拟在时间 $\\Delta t$ 内统计到 $C_{\\text{obs}}$ 次吸收碰撞，那么这个计数是期望吸收次数 $\\langle N_a \\rangle = R_a \\Delta t$ 的一个统计样本。\n因此，吸收率的碰撞估计量 $R_{a, \\text{C}}$ 为：\n$$R_{a, \\text{C}} = \\frac{C_{\\text{obs}}}{\\Delta t}$$\n使用给定的 MC 统计数据：\n$C_{\\text{obs}} = 1.548 \\times 10^{14}$\n$\\Delta t = 1 \\text{ s}$\n\n其数值为：\n$$R_{a, \\text{C}} = \\frac{1.548 \\times 10^{14}}{1 \\text{ s}} = 1.548 \\times 10^{14} \\text{ s}^{-1}$$\n\n**3. 物理约束的吸收反应率（直接积分）**\n\n物理约束值是精确的理论反应率，通过使用给定的通量解析形式进行直接积分计算得出。我们将其记为 $R_{a, \\text{exact}}$。\n$$R_{a, \\text{exact}} = A \\Sigma_{a} \\int_{0}^{L} \\phi(x) \\mathrm{d}x$$\n我们代入给定的通量剖面 $\\phi(x) = \\phi_0 \\exp(-\\alpha x)$：\n$$R_{a, \\text{exact}} = A \\Sigma_{a} \\phi_0 \\int_{0}^{L} \\exp(-\\alpha x) \\mathrm{d}x$$\n该积分为初等积分：\n$$\\int_{0}^{L} \\exp(-\\alpha x) \\mathrm{d}x = \\left[ -\\frac{1}{\\alpha} \\exp(-\\alpha x) \\right]_{0}^{L} = -\\frac{1}{\\alpha} (\\exp(-\\alpha L) - \\exp(0)) = \\frac{1 - \\exp(-\\alpha L)}{\\alpha}$$\n将此结果代回，得到完整的解析表达式：\n$$R_{a, \\text{exact}} = \\frac{A \\Sigma_{a} \\phi_0}{\\alpha} (1 - \\exp(-\\alpha L))$$\n现在，我们代入给定的数值：\n$A = 200 \\text{ cm}^2$\n$L = 15 \\text{ cm}$\n$\\Sigma_{a} = 0.06 \\text{ cm}^{-1}$\n$\\phi_{0} = 1.5 \\times 10^{12} \\text{ cm}^{-2}\\text{s}^{-1}$\n$\\alpha = 0.08 \\text{ cm}^{-1}$\n\n首先，计算指数的参数：\n$\\alpha L = (0.08 \\text{ cm}^{-1})(15 \\text{ cm}) = 1.2$\n\n接下来，计算前置因子：\n$$\\frac{A \\Sigma_{a} \\phi_0}{\\alpha} = \\frac{(200 \\text{ cm}^2)(0.06 \\text{ cm}^{-1})(1.5 \\times 10^{12} \\text{ cm}^{-2}\\text{s}^{-1})}{0.08 \\text{ cm}^{-1}} = \\frac{1.8 \\times 10^{13} \\text{ s}^{-1}}{0.08} = 2.25 \\times 10^{14} \\text{ s}^{-1}$$\n最后，我们计算 $R_{a, \\text{exact}}$：\n$$R_{a, \\text{exact}} = (2.25 \\times 10^{14} \\text{ s}^{-1}) (1 - \\exp(-1.2))$$\n$$R_{a, \\text{exact}} \\approx (2.25 \\times 10^{14} \\text{ s}^{-1}) (1 - 0.3011942) = (2.25 \\times 10^{14} \\text{ s}^{-1}) (0.6988058)$$\n$$R_{a, \\text{exact}} \\approx 1.572313 \\times 10^{14} \\text{ s}^{-1}$$\n\n**4. 值的协调**\n\n计算得到的总吸收反应率的三个值是：\n- 径迹长度估计值：$R_{a, \\text{TL}} \\approx 1.559 \\times 10^{14} \\text{ s}^{-1}$\n- 碰撞估计值：$R_{a, \\text{C}} = 1.548 \\times 10^{14} \\text{ s}^{-1}$\n- 物理约束值 (精确值)：$R_{a, \\text{exact}} \\approx 1.572 \\times 10^{14} \\text{ s}^{-1}$\n\n径迹长度和碰撞估计量是随机蒙特卡罗模拟的单次实现结果。因此，它们会受到统计涨落（“有限取样”误差）的影响。通过对给定的解析通量剖面进行直接积分得到的物理约束值，代表了蒙特卡罗估计量在粒子历史数无限的极限情况下将收敛到的真实期望值。MC 估计值与精确值之间的微小差异与这种统计解释是一致的。\n\n问题陈述，协调后的估计值是物理约束值。因此，最终答案是 $R_{a, \\text{exact}}$，四舍五入到四位有效数字。\n$$R_{a, \\text{reconciled}} = 1.572 \\times 10^{14} \\text{ s}^{-1}$$",
            "answer": "$$\\boxed{1.572 \\times 10^{14}}$$"
        },
        {
            "introduction": "虽然计算单个体积平均值很有用，但实际应用通常需要了解通量在空间上的变化。本实践练习演示了如何实现基于网格的径迹长度统计，以获得空间分辨的通量分布。它还引入了蒙特卡罗估计的统计误差与用离散单元平均值表示连续场所产生的离散化误差之间的关键区别 。",
            "id": "4258089",
            "problem": "要求您在一维平板中，利用径迹长度思想，形式化并计算基于网格的标量通量空间统计，并量化因使用分段常数的单元平均值表示连续场而产生的离散化误差。设定为一个一维平板区域，空间坐标为 $x \\in [0, L]$，单位横截面积为 $A = 1$，因此体积在数值上与以厘米为单位的长度相同。连续标量通量场由指数剖面 $ \\phi(x) = \\phi_0 \\exp(-\\alpha x) $ 给出，其中 $x \\in [0, L]$，且 $ \\phi_0 > 0 $ 和 $ \\alpha > 0 $ 为常数。您将获得沿 $x$ 轴的、具有正权重或零权重的确定性直线径迹。每条径迹由其端点 $(x_0, x_1)$（单位为厘米）和一个无量纲权重 $w$ 指定，代表一个粒子路径段。假定这些是您可用于统计的径迹；不要生成新的径迹。\n\n网格统计应使用径迹长度概念产生单元平均通量值：对于 $[0,L]$ 上的一个包含 $M$ 个单元的均匀网格，第 $i$ 个单元的边界为 $[x_{i-1}, x_i]$，其中 $ x_0 = 0 $，$ x_M = L $，且 $ x_i = i \\, \\Delta x $，其中 $ \\Delta x = L / M $。为了在一个单元中记录径迹长度，将每个径迹段与单元区间相交，并累加重叠长度。估算的单元平均通量是经过适当归一化的径迹长度总和除以单元体积（长度）。另外，通过计算 $ \\phi(x) $ 在单元上的体积分再除以单元长度，来计算精确的单元平均通量。使用这两组单元平均值，计算以下两个误差度量：\n\n- 径迹长度估算的单元平均值与精确单元平均值之间的均方根相对偏差，定义为\n$$ e_{\\text{RMS}} = \\sqrt{ \\frac{1}{M} \\sum_{i=1}^{M} \\left( \\frac{ \\hat{\\bar{\\phi}}_i - \\bar{\\phi}_i }{ \\bar{\\phi}_i } \\right)^2 } \\;, $$\n其中 $ \\hat{\\bar{\\phi}}_i $ 是通过径迹长度统计计算出的单元 $i$ 中的估算单元平均通量，而 $ \\bar{\\phi}_i $ 是同一单元中的精确单元平均通量。\n\n- 将连续场 $ \\phi(x) $ 表示为等于精确单元平均值的分段常数近似所关联的离散化误差，通过 $L^2$ 相对误差来衡量：\n$$ E_{\\text{disc}} = \\sqrt{ \\frac{ \\int_{0}^{L} \\left( \\phi_h(x) - \\phi(x) \\right)^2 \\, dx }{ \\int_{0}^{L} \\phi(x)^2 \\, dx } } \\;, $$\n其中对于 $ x \\in [x_{i-1}, x_i] $，$ \\phi_h(x) = \\bar{\\phi}_i $。\n\n所有长度必须以厘米为单位处理，所有最终答案应为无量纲小数。不使用角度。算法必须是确定性的，仅基于所提供的参数。\n\n测试套件。对于下面的每个测试用例，按顺序计算 $ e_{\\text{RMS}} $ 和 $ E_{\\text{disc}} $ 并输出。程序必须生成一行输出，包含六个结果，格式为用方括号括起来的逗号分隔列表，具体为 $[e_{\\text{RMS}}^{(1)}, E_{\\text{disc}}^{(1)}, e_{\\text{RMS}}^{(2)}, E_{\\text{disc}}^{(2)}, e_{\\text{RMS}}^{(3)}, E_{\\text{disc}}^{(3)}]$。\n\n- 测试用例 $1$ (一般情况)：\n  - 区域长度 $L = 10$ $\\text{cm}$。\n  - 网格单元数 $M = 5$。\n  - 通量参数 $ \\phi_0 = 2.0 $ (单位：中子/平方厘米/秒) 和 $ \\alpha = 0.2 $ $\\text{cm}^{-1}$。\n  - 径迹 $[(x_0, x_1, w)]$:\n    - $(0.0, 3.5, 1.0)$，\n    - $(1.2, 9.8, 1.0)$，\n    - $(2.0, 6.1, 1.0)$，\n    - $(4.0, 10.0, 1.0)$。\n\n- 测试用例 $2$ (边界和零长度段)：\n  - 区域长度 $L = 10$ $\\text{cm}$。\n  - 网格单元数 $M = 10$。\n  - 通量参数 $ \\phi_0 = 1.0 $ (单位：中子/平方厘米/秒) 和 $ \\alpha = 0.5 $ $\\text{cm}^{-1}$。\n  - 径迹 $[(x_0, x_1, w)]$:\n    - $(-1.0, 2.0, 0.5)$，\n    - $(9.0, 12.0, 2.0)$，\n    - $(5.0, 5.0, 1.0)$，\n    - $(10.0, 10.0, 3.0)$，\n    - $(3.0, 7.5, 1.5)$。\n\n- 测试用例 $3$ (粗网格和混合方向)：\n  - 区域长度 $L = 10$ $\\text{cm}$。\n  - 网格单元数 $M = 1$。\n  - 通量参数 $ \\phi_0 = 5.0 $ (单位：中子/平方厘米/秒) 和 $ \\alpha = 0.05 $ $\\text{cm}^{-1}$。\n  - 径迹 $[(x_0, x_1, w)]$:\n    - $(0.0, 10.0, 1.0)$，\n    - $(2.5, 2.0, 0.7)$。\n\n算法要求：\n- 对于每条径迹 $(x_0, x_1, w)$，将线段限制在区域 $[0, L]$ 内：令 $a = \\max(0, \\min(x_0, x_1))$ 且 $b = \\min(L, \\max(x_0, x_1))$。如果 $b \\le a$，则该线段对所有单元的贡献长度为零。\n- 对于每个单元 $i$，计算 $[a, b]$ 与单元区间 $[x_{i-1}, x_i]$ 之间的重叠长度 $ \\ell_{i} $。对所有径迹累加 $ w \\, \\ell_{i} $ 得到 $S_i$，即单元 $i$ 中的总加权长度。设 $W$ 为所有权重的总和。计算径迹长度估算的单元平均通量为 $ \\hat{\\bar{\\phi}}_i = S_i / ( W \\, \\Delta x ) $。\n- 通过对 $ \\phi(x) $ 在单元上积分并除以 $ \\Delta x $ 来计算精确的单元平均通量 $ \\bar{\\phi}_i $。\n- 计算所有 $M$ 个单元的 $ e_{\\text{RMS}} $，并使用上述积分定义计算 $ E_{\\text{disc}} $。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含六个结果，格式为用方括号括起来的逗号分隔列表，顺序为 $[e_{\\text{RMS}}^{(1)}, E_{\\text{disc}}^{(1)}, e_{\\text{RMS}}^{(2)}, E_{\\text{disc}}^{(2)}, e_{\\text{RMS}}^{(3)}, E_{\\text{disc}}^{(3)}]$。",
            "solution": "我们从标量通量的定义开始。在稳态中子输运中，位置 $ \\mathbf{r} $ 处的标量通量定义为\n$$ \\phi(\\mathbf{r}) = \\int_{4\\pi} \\psi(\\mathbf{r}, \\hat{\\Omega}) \\, d\\Omega \\;, $$\n其中 $ \\psi(\\mathbf{r}, \\hat{\\Omega}) $ 是角通量，即粒子沿方向 $ \\hat{\\Omega} $ 流过 $ \\mathbf{r} $ 的速率，单位为每单位立体角每单位面积。区域 $ V $ 上标量通量的体平均值为\n$$ \\bar{\\phi}_V = \\frac{1}{V} \\int_V \\phi(\\mathbf{r}) \\, dV \\;. $$\n\n径迹长度概念源于将 $ \\phi(\\mathbf{r}) $ 解释为径程密度。在体积 $ V $ 内，每个源粒子的期望总粒子径程等于 $ \\int_V \\phi(\\mathbf{r}) \\, dV $。在蒙特卡罗方法中，如果我们运行 $ N $ 个源粒子，并记录粒子 $k$ 在 $ V $ 内贡献的总径迹长度 $ \\ell_k $，那么在模拟抽样和权重 $ w_k $ 的情况下，每单位源粒子权重的 $ \\int_V \\phi \\, dV $ 的无偏估计量是\n$$ \\widehat{ \\int_V \\phi \\, dV } = \\frac{1}{ \\sum_{k=1}^N w_k } \\sum_{k=1}^{N} w_k \\, \\ell_k \\;. $$\n除以体积 $V$ 得到体平均通量的一个估计量：\n$$ \\hat{\\bar{\\phi}}_V = \\frac{1}{V} \\cdot \\frac{1}{ \\sum_{k=1}^N w_k } \\sum_{k=1}^{N} w_k \\, \\ell_k \\;. $$\n\n对于一个单位横截面积 $A=1$、在 $[0, L]$ 上有 $M$ 个单元的均匀网格的一维平板，第 $i$ 个单元是区间 $[x_{i-1}, x_i]$，其中 $ x_i = i \\, \\Delta x $ 且 $ \\Delta x = L / M $。体积等于长度 $ \\Delta x $。给定一个端点为 $(x_0, x_1)$、权重为 $w$ 的径迹，我们通过对端点排序并与 $[0, L]$ 求交集，将其限制在区域内得到 $[a, b]$，其中 $ a = \\max(0, \\min(x_0, x_1)) $ 且 $ b = \\min(L, \\max(x_0, x_1)) $。如果 $ b \\le a $，则该线段完全在区域之外或是零长度的，贡献为零。与单元 $i$ 的重叠长度为\n$$ \\ell_{i} = \\max\\left( 0, \\min(b, x_i) - \\max(a, x_{i-1}) \\right) \\;. $$\n对所有径迹求和 $ w \\, \\ell_{i} $ 得到 $ S_i $。设 $ W = \\sum_k w_k $ 为总权重。径迹长度估算的单元平均通量为\n$$ \\hat{\\bar{\\phi}}_i = \\frac{S_i}{ W \\, \\Delta x } \\;. $$\n\n对于指数剖面 $ \\phi(x) = \\phi_0 \\exp(-\\alpha x) $，在 $[x_{i-1}, x_i]$ 上的精确单元平均通量为\n$$ \\bar{\\phi}_i = \\frac{1}{\\Delta x} \\int_{x_{i-1}}^{x_i} \\phi_0 \\, e^{-\\alpha x} \\, dx = \\frac{\\phi_0}{\\alpha \\, \\Delta x} \\left( e^{-\\alpha x_{i-1}} - e^{-\\alpha x_i} \\right) \\;. $$\n\n在得到 $ \\hat{\\bar{\\phi}}_i $ 和 $ \\bar{\\phi}_i $ 后，我们计算均方根相对偏差为\n$$ e_{\\text{RMS}} = \\sqrt{ \\frac{1}{M} \\sum_{i=1}^{M} \\left( \\frac{ \\hat{\\bar{\\phi}}_i - \\bar{\\phi}_i }{ \\bar{\\phi}_i } \\right)^2 } \\;. $$\n\n为了量化与网格统计和空间平均相关的离散化误差，我们考虑分段常数重构 $ \\phi_h(x) $，它在每个单元内等于精确的单元平均值：对于 $ x \\in [x_{i-1}, x_i] $，$ \\phi_h(x) = \\bar{\\phi}_i $。$L^2$ 相对误差为\n$$ E_{\\text{disc}} = \\sqrt{ \\frac{ \\int_{0}^{L} \\left( \\phi_h(x) - \\phi(x) \\right)^2 \\, dx }{ \\int_{0}^{L} \\phi(x)^2 \\, dx } } \\;. $$\n分母积分很简单：\n$$ \\int_{0}^{L} \\phi(x)^2 \\, dx = \\int_{0}^{L} \\phi_0^2 \\, e^{-2\\alpha x} \\, dx = \\frac{ \\phi_0^2 }{ 2 \\alpha } \\left( 1 - e^{-2\\alpha L} \\right) \\;. $$\n分子可以分解到各个单元上：\n$$ \\int_{0}^{L} \\left( \\phi_h(x) - \\phi(x) \\right)^2 \\, dx = \\sum_{i=1}^{M} \\int_{x_{i-1}}^{x_i} \\left( \\bar{\\phi}_i - \\phi_0 e^{-\\alpha x} \\right)^2 dx \\;. $$\n对每个单元展开平方项，得到\n\\begin{align*}\n\\int_{x_{i-1}}^{x_i} \\left( \\bar{\\phi}_i - \\phi_0 e^{-\\alpha x} \\right)^2 dx\n= \\int_{x_{i-1}}^{x_i} \\left( \\phi_0^2 e^{-2\\alpha x} - 2 \\bar{\\phi}_i \\phi_0 e^{-\\alpha x} + \\bar{\\phi}_i^2 \\right) dx \\\\\n= \\frac{ \\phi_0^2 }{ 2 \\alpha } \\left( e^{-2\\alpha x_{i-1}} - e^{-2\\alpha x_i} \\right)\n- \\frac{ 2 \\bar{\\phi}_i \\phi_0 }{ \\alpha } \\left( e^{-\\alpha x_{i-1}} - e^{-\\alpha x_i} \\right)\n+ \\bar{\\phi}_i^2 \\, \\Delta x \\;.\n\\end{align*}\n注意到 $ \\bar{\\phi}_i = \\frac{\\phi_0}{ \\alpha \\, \\Delta x } \\left( e^{-\\alpha x_{i-1}} - e^{-\\alpha x_i} \\right) $，中间项会与第一项的一部分相消，但为了实现，我们可以精确计算所有项然后求和。\n\n算法规划：\n- 对于每个测试用例，构建单元边界 $ x_i $ 和 $ \\Delta x $。\n- 通过径迹重叠长度和权重计算 $ S_i $，通过权重总和计算 $ W $。\n- 计算 $ \\hat{\\bar{\\phi}}_i = S_i / ( W \\, \\Delta x ) $。\n- 计算 $ \\bar{\\phi}_i = \\frac{\\phi_0}{\\alpha \\, \\Delta x} \\left( e^{-\\alpha x_{i-1}} - e^{-\\alpha x_i} \\right) $。\n- 计算 $ e_{\\text{RMS}} $。\n- 通过对每个单元的分子积分求和，除以精确的分母积分，然后取平方根来计算 $ E_{\\text{disc}} $。\n\n所有计算都是确定性的，并且仅依赖于所提供的输入。输出是代表误差的无量纲小数。最终程序按该确切顺序打印单行 $[e_{\\text{RMS}}^{(1)}, E_{\\text{disc}}^{(1)}, e_{\\text{RMS}}^{(2)}, E_{\\text{disc}}^{(2)}, e_{\\text{RMS}}^{(3)}, E_{\\text{disc}}^{(3)}]$。",
            "answer": "[0.12456455115263228,0.05771578762512108,0.2505505705353164,0.1442127821634354,0.03845927503463466,0.08200673468531063]"
        },
        {
            "introduction": "在实践中，通常有多种估计子可用于计算相同的物理量，选择最优估计子是一项关键技能。本问题提出了一个真实场景，您必须在无偏的径迹长度估计子和可能存在偏差但方差较小的碰撞估计子之间做出选择。通过引入均方误差（$MSE$）和品质因数（$FOM$）的概念来指导决策，本练习强调了在偏差、方差和计算成本之间进行权衡的重要性 。",
            "id": "4251786",
            "problem": "一个非均匀核反应堆堆芯的双区一维板模型通过蒙特卡洛（MC）中子输运方法进行模拟，以估计分区、能量积分的标量通量。区域 $\\mathcal{F}$ 代表燃料，区域 $\\mathcal{M}$ 代表慢化剂。通量计算使用了两种统计量：径迹长度估计量和碰撞估计量。碰撞估计量的实现采用了在整个板中使用单一优势总截面的δ径迹法，并使用分区、群均匀化的总截面进行评分。一个独立的高阶参考解提供了每个区域的真实通量。在正确的粒子追踪下，径迹长度估计量预计是无偏的，而由于截面处理的原因，碰撞估计量在强非均匀介质中可能表现出系统偏差。\n\n给定相同粒子历史数 $N$ 下的以下MC结果，其中每个估计量每 $10^5$ 个历史的挂钟时间作为计算成本报告。报告的标准差是每个区域通量统计量样本均值的估计标准差。\n\n参考通量：\n- 区域 $\\mathcal{F}$ （燃料）：$\\phi_{\\mathrm{ref},\\mathcal{F}} = 0.0500$。\n- 区域 $\\mathcal{M}$ （慢化剂）：$\\phi_{\\mathrm{ref},\\mathcal{M}} = 0.1200$。\n\n径迹长度估计量：\n- 区域 $\\mathcal{F}$：样本均值 $\\hat{\\phi}_{\\mathrm{TL},\\mathcal{F}} = 0.0496$，标准差 $\\sigma_{\\mathrm{TL},\\mathcal{F}} = 0.0018$，每 $10^5$ 个历史的挂钟时间 $t_{\\mathrm{TL}} = 12\\,\\mathrm{s}$。\n- 区域 $\\mathcal{M}$：样本均值 $\\hat{\\phi}_{\\mathrm{TL},\\mathcal{M}} = 0.1189$，标准差 $\\sigma_{\\mathrm{TL},\\mathcal{M}} = 0.0038$，每 $10^5$ 个历史的挂钟时间 $t_{\\mathrm{TL}} = 12\\,\\mathrm{s}$。\n\n碰撞估计量：\n- 区域 $\\mathcal{F}$：样本均值 $\\hat{\\phi}_{\\mathrm{C},\\mathcal{F}} = 0.0515$，标准差 $\\sigma_{\\mathrm{C},\\mathcal{F}} = 0.0011$，每 $10^5$ 个历史的挂钟时间 $t_{\\mathrm{C}} = 16\\,\\mathrm{s}$。\n- 区域 $\\mathcal{M}$：样本均值 $\\hat{\\phi}_{\\mathrm{C},\\mathcal{M}} = 0.1209$，标准差 $\\sigma_{\\mathrm{C},\\mathcal{M}} = 0.0017$，每 $10^5$ 个历史的挂钟时间 $t_{\\mathrm{C}} = 16\\,\\mathrm{s}$。\n\n假设径迹长度估计量在两个区域都是无偏的，而碰撞估计量的偏差仅由所述的截面处理引起。基于统计不确定性和误差的第一性原理定义，确定在每个区域中能够最小化通量估计的期望平方误差的估计量选择，并将其与纯粹基于品质因数（FOM）做出的选择进行对比。选择最能反映在最小化期望平方误差目标下每个区域的正确估计量选择的选项，并附带对为什么仅基于FOM的选择可能不同的正确解释。\n\n选项：\n\nA. 在两个区域都使用径迹长度估计量，因为它是无偏的；在最小化误差时，忽略方差是可以接受的。\n\nB. 在两个区域都使用碰撞估计量，因为它具有较低的方差和较高的FOM；在非均匀堆芯中，偏差可以忽略不计。\n\nC. 在燃料区使用径迹长度估计量，在慢化剂区使用碰撞估计量；在燃料区，尽管碰撞估计量的方差较低，但其偏差增大了期望平方误差，而在慢化剂区，碰撞估计量减小了期望平方误差，因为它的偏差很小且方差低得多。\n\nD. 在每个区域都使用具有较高FOM的估计量，而不管偏差如何；FOM是最小化期望平方误差的正确度量标准。",
            "solution": "在进行求解之前，对问题陈述进行严格验证。\n\n### 步骤 1：提取已知条件\n- **系统：** 一个非均匀核反应堆堆芯的双区（$\\mathcal{F}$：燃料，$\\mathcal{M}$：慢化剂）一维板模型。\n- **目标：** 估计分区、能量积分的标量通量。\n- **方法：** 使用两种蒙特卡洛（MC）估计量：径迹长度（TL）和碰撞（C）。\n- **估计量属性：**\n    - 径迹长度估计量被假设为无偏的。\n    - 碰撞估计量使用在整个板上采用单一优势总截面的δ径迹法，并使用分区、群均匀化总截面进行评分，这可能引入系统偏差。\n- **参考通量（真值）：**\n    - 区域 $\\mathcal{F}$：$\\phi_{\\mathrm{ref},\\mathcal{F}} = 0.0500$\n    - 区域 $\\mathcal{M}$：$\\phi_{\\mathrm{ref},\\mathcal{M}} = 0.1200$\n- **径迹长度（TL）估计量数据（对于 $N$ 个历史）：**\n    - 区域 $\\mathcal{F}$：样本均值 $\\hat{\\phi}_{\\mathrm{TL},\\mathcal{F}} = 0.0496$，均值的标准差 $\\sigma_{\\mathrm{TL},\\mathcal{F}} = 0.0018$。\n    - 区域 $\\mathcal{M}$：样本均值 $\\hat{\\phi}_{\\mathrm{TL},\\mathcal{M}} = 0.1189$，均值的标准差 $\\sigma_{\\mathrm{TL},\\mathcal{M}} = 0.0038$。\n    - 计算成本：$t_{\\mathrm{TL}} = 12\\,\\mathrm{s}$ 每 $10^5$ 个历史。\n- **碰撞（C）估计量数据（对于 $N$ 个历史）：**\n    - 区域 $\\mathcal{F}$：样本均值 $\\hat{\\phi}_{\\mathrm{C},\\mathcal{F}} = 0.0515$，均值的标准差 $\\sigma_{\\mathrm{C},\\mathcal{F}} = 0.0011$。\n    - 区域 $\\mathcal{M}$：样本均值 $\\hat{\\phi}_{\\mathrm{C},\\mathcal{M}} = 0.1209$，均值的标准差 $\\sigma_{\\mathrm{C},\\mathcal{M}} = 0.0017$。\n    - 计算成本：$t_{\\mathrm{C}} = 16\\,\\mathrm{s}$ 每 $10^5$ 个历史。\n- **问题：** 确定在每个区域中能够最小化通量估计的期望平方误差（ESE）的估计量选择，并将其与纯粹基于品质因数（FOM）做出的选择进行对比。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上植根于成熟的粒子输运蒙特卡洛方法领域，这是核反应堆分析的基石。径迹长度和碰撞估计量、偏差、方差、期望平方误差和品质因数的概念是标准的理论和实践工具。关于碰撞估计量中潜在偏差来源（使用单一优势截面和均匀化截面）的描述，在非均匀介质问题中是一个被充分理解的现象。所提供的数值数据对于一个简化的反应堆物理模拟是物理上合理的。问题提法清晰，目标明确，并有足够的数据进行所需计算。语言精确客观。没有矛盾、歧义或依赖伪科学。该问题是对统计估计基本概念的有效检验。\n\n### 步骤 3：结论与行动\n问题陈述有效。将进行定量分析。\n\n### 解题过程\n\n主要目标是选择在每个区域中最小化通量 $\\phi$ 的期望平方误差（ESE）的估计量。对于真值 $\\phi_{\\mathrm{ref}}$，估计量 $\\hat{\\phi}$ 的ESE由偏差-方差分解定义：\n$$ ESE(\\hat{\\phi}) = E[(\\hat{\\phi} - \\phi_{\\mathrm{ref}})^2] = (E[\\hat{\\phi}] - \\phi_{\\mathrm{ref}})^2 + \\text{Var}(\\hat{\\phi}) $$\n这可以写成：\n$$ ESE = (\\text{Bias})^2 + \\text{Variance} = B^2 + \\sigma^2 $$\n这里，偏差 $B$ 是系统误差，我们将其估计为样本均值与参考值之差，$B \\approx \\hat{\\phi} - \\phi_{\\mathrm{ref}}$。方差 $\\sigma^2$ 是给定均值标准差的平方。\n\n品质因数（FOM）是计算效率的度量，通常定义为与方差和计算时间 $T$ 的乘积成反比：\n$$ \\mathrm{FOM} = \\frac{1}{\\sigma^2 T} $$\n更高的FOM表示在给定的计算量下，在减少统计不确定性（方差）方面具有更高的效率。关键的是，FOM没有考虑系统误差（偏差）。\n\n我们现在将计算每个区域中每个估计量的ESE和FOM。时间 $t_{\\mathrm{TL}} = 12\\,\\mathrm{s}$ 和 $t_{\\mathrm{C}} = 16\\,\\mathrm{s}$ 将用作成比例的计算成本 $T$。\n\n#### 区域 $\\mathcal{F}$ （燃料）\n- 参考通量：$\\phi_{\\mathrm{ref},\\mathcal{F}} = 0.0500$\n\n**径迹长度估计量（TL）：**\n- 如前所述，该估计量是无偏的，因此 $B_{\\mathrm{TL},\\mathcal{F}} = 0$。其样本均值 $\\hat{\\phi}_{\\mathrm{TL},\\mathcal{F}} = 0.0496$ 与参考值的偏差是统计噪声。\n- 方差：$\\sigma^2_{\\mathrm{TL},\\mathcal{F}} = (0.0018)^2 = 3.24 \\times 10^{-6}$。\n- 期望平方误差：$ESE_{\\mathrm{TL},\\mathcal{F}} = B_{\\mathrm{TL},\\mathcal{F}}^2 + \\sigma^2_{\\mathrm{TL},\\mathcal{F}} = 0^2 + 3.24 \\times 10^{-6} = 3.24 \\times 10^{-6}$。\n- 品质因数：$\\mathrm{FOM}_{\\mathrm{TL},\\mathcal{F}} \\propto \\frac{1}{\\sigma^2_{\\mathrm{TL},\\mathcal{F}} \\cdot t_{\\mathrm{TL}}} = \\frac{1}{(3.24 \\times 10^{-6})(12)} \\approx 25720$。\n\n**碰撞估计量（C）：**\n- 估计偏差：$B_{\\mathrm{C},\\mathcal{F}} = \\hat{\\phi}_{\\mathrm{C},\\mathcal{F}} - \\phi_{\\mathrm{ref},\\mathcal{F}} = 0.0515 - 0.0500 = 0.0015$。\n- 方差：$\\sigma^2_{\\mathrm{C},\\mathcal{F}} = (0.0011)^2 = 1.21 \\times 10^{-6}$。\n- 期望平方误差：$ESE_{\\mathrm{C},\\mathcal{F}} = B_{\\mathrm{C},\\mathcal{F}}^2 + \\sigma^2_{\\mathrm{C},\\mathcal{F}} = (0.0015)^2 + (0.0011)^2 = 2.25 \\times 10^{-6} + 1.21 \\times 10^{-6} = 3.46 \\times 10^{-6}$。\n- 品质因数：$\\mathrm{FOM}_{\\mathrm{C},\\mathcal{F}} \\propto \\frac{1}{\\sigma^2_{\\mathrm{C},\\mathcal{F}} \\cdot t_{\\mathrm{C}}} = \\frac{1}{(1.21 \\times 10^{-6})(16)} \\approx 51653$。\n\n**区域 $\\mathcal{F}$ 的比较：**\n- 最小化ESE：$ESE_{\\mathrm{TL},\\mathcal{F}} (3.24 \\times 10^{-6})  ESE_{\\mathrm{C},\\mathcal{F}} (3.46 \\times 10^{-6})$。**径迹长度估计量**更优。\n- 最大化FOM：$\\mathrm{FOM}_{\\mathrm{C},\\mathcal{F}} (51653)  \\mathrm{FOM}_{\\mathrm{TL},\\mathcal{F}} (25720)$。如果仅基于FOM，将选择**碰撞估计量**。\n- 差异的产生是因为碰撞估计量的偏差是显著的。偏差平方项（$2.25 \\times 10^{-6}$）大于其方差（$1.21 \\times 10^{-6}$），并且足够大，使其总ESE大于无偏但方差较高的径迹长度估计量的ESE。\n\n#### 区域 $\\mathcal{M}$ （慢化剂）\n- 参考通量：$\\phi_{\\mathrm{ref},\\mathcal{M}} = 0.1200$\n\n**径迹长度估计量（TL）：**\n- 无偏：$B_{\\mathrm{TL},\\mathcal{M}} = 0$。\n- 方差：$\\sigma^2_{\\mathrm{TL},\\mathcal{M}} = (0.0038)^2 = 1.444 \\times 10^{-5}$。\n- 期望平方误差：$ESE_{\\mathrm{TL},\\mathcal{M}} = 0^2 + 1.444 \\times 10^{-5} = 1.444 \\times 10^{-5}$。\n- 品质因数：$\\mathrm{FOM}_{\\mathrm{TL},\\mathcal{M}} \\propto \\frac{1}{\\sigma^2_{\\mathrm{TL},\\mathcal{M}} \\cdot t_{\\mathrm{TL}}} = \\frac{1}{(1.444 \\times 10^{-5})(12)} \\approx 5771$。\n\n**碰撞估计量（C）：**\n- 估计偏差：$B_{\\mathrm{C},\\mathcal{M}} = \\hat{\\phi}_{\\mathrm{C},\\mathcal{M}} - \\phi_{\\mathrm{ref},\\mathcal{M}} = 0.1209 - 0.1200 = 0.0009$。\n- 方差：$\\sigma^2_{\\mathrm{C},\\mathcal{M}} = (0.0017)^2 = 2.89 \\times 10^{-6}$。\n- 期望平方误差：$ESE_{\\mathrm{C},\\mathcal{M}} = B_{\\mathrm{C},\\mathcal{M}}^2 + \\sigma^2_{\\mathrm{C},\\mathcal{M}} = (0.0009)^2 + (0.0017)^2 = 0.81 \\times 10^{-6} + 2.89 \\times 10^{-6} = 3.70 \\times 10^{-6}$。\n- 品质因数：$\\mathrm{FOM}_{\\mathrm{C},\\mathcal{M}} \\propto \\frac{1}{\\sigma^2_{\\mathrm{C},\\mathcal{M}} \\cdot t_{\\mathrm{C}}} = \\frac{1}{(2.89 \\times 10^{-6})(16)} \\approx 21626$。\n\n**区域 $\\mathcal{M}$ 的比较：**\n- 最小化ESE：$ESE_{\\mathrm{C},\\mathcal{M}} (3.70 \\times 10^{-6})  ESE_{\\mathrm{TL},\\mathcal{M}} (1.444 \\times 10^{-5})$。**碰撞估计量**明显更优。\n- 最大化FOM：$\\mathrm{FOM}_{\\mathrm{C},\\mathcal{M}} (21626)  \\mathrm{FOM}_{\\mathrm{TL},\\mathcal{M}} (5771)$。如果仅基于FOM，也将选择**碰撞估计量**。\n- 在这个区域，两个度量标准达成一致。碰撞估计量的方variance远低于径迹长度估计量的方差（大约低了 $\\sim 5$ 倍）。方差的这种大幅度减少远超过其偏差平方带来的微小贡献，从而导致总ESE低得多。\n\n**最优选择总结：**\n- 为最小化期望平方误差：\n    - 区域 $\\mathcal{F}$ （燃料）：径迹长度估计量。\n    - 区域 $\\mathcal{M}$ （慢化剂）：碰撞估计量。\n- 纯粹基于最大化FOM的选择会在两个区域都选择碰撞估计量。\n\n### 逐项分析\n\n**A. 在两个区域都使用径迹长度估计量，因为它是无偏的；在最小化误差时，忽略方差是可以接受的。**\n这个建议对于慢化剂区域是错误的，在该区域，由于方差很高，径迹长度估计量的ESE远大于碰撞估计量。声称在最小化误差时忽略方差是可以接受的，这从根本上是错误的，因为方差是ESE的主要组成部分。\n**结论：错误**\n\n**B. 在两个区域都使用碰撞估计量，因为它具有较低的方差和较高的FOM；在非均匀堆芯中，偏差可以忽略不计。**\n这反映了纯粹基于FOM的选择。然而，它未能在燃料区域最小化ESE，在该区域，碰撞估计量的偏差不可忽略，并导致比径迹长度估计量更高的ESE。“在非均匀堆芯中偏差可以忽略不计”这一笼统的说法是一个错误的概括，与数据相矛盾。\n**结论：错误**\n\n**C. 在燃料区使用径迹长度估计量，在慢化剂区使用碰撞估计量；在燃料区，尽管碰撞估计量的方差较低，但其偏差增大了期望平方误差，而在慢化剂区，碰撞估计量减小了期望平方误差，因为它的偏差很小且方差低得多。**\n这个陈述与从ESE计算中得出的结论完全匹配。它正确地确定了基于最小化总误差的每个区域的最优估计量。此外，它通过在两种情况下正确评估偏差和方差之间的权衡，准确地解释了每个选择的理由。在燃料区，偏差是打破平衡的主导因素；在慢化剂区，方差的减少是主导因素。\n**结论：正确**\n\n**D. 在每个区域都使用具有较高FOM的估计量，而不管偏差如何；FOM是最小化期望平方误差的正确度量标准。**\n这在根本上是错误的。FOM是衡量减少统计不确定性（方差）的计算效率的指标，并明确忽略了系统误差（偏差）。最小化总误差的正确度量标准是ESE（或MSE），它同时包含了偏差和方差。正如在燃料区域所展示的，具有较高FOM的估计量不一定具有较低的ESE。\n**结论：错误**",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}