{
    "hands_on_practices": [
        {
            "introduction": "在粒子输运追踪中，最基本的任务是确定粒子沿直线路径在何时何地与几何表面相交。这个过程需要联立求解代表粒子路径的线性方程和定义表面的方程。这项练习  通过将此原理应用于简单而常见的球形几何体，从第一性原理出发推导交点距离，从而培养一项基本技能。",
            "id": "4240397",
            "problem": "在核反应堆模拟的蒙特卡洛中子输运（MCNT）中，组合几何中的粒子追踪将空间查询简化为解析相交问题。考虑一个球形燃料微粒，其中心位置矢量为 $\\mathbf{c}$，半径为 $R$。一个中子位于位置 $\\mathbf{r}_{0}$，并沿单位方向矢量 $\\mathbf{\\Omega}$ 直线运动，因此其参数路径为 $\\mathbf{r}(s) = \\mathbf{r}_{0} + s \\mathbf{\\Omega}$，其中 $s$ 是待求的路径长度。该球体是满足 $\\|\\mathbf{r} - \\mathbf{c}\\|^{2} = R^{2}$ 的点集。\n\n从第一性原理出发，使用欧几里得几何以及点积和范数的定义，将相交条件表述为关于 $s$ 的二次方程，求解该方程以获得两个代数根，限定于对应沿 $\\mathbf{\\Omega}$ 方向物理前向相交的正根，并选择最近的相交距离（即入射点）。\n\n使用以下代表球床微观几何结构中燃料核芯的物理一致参数：$\\mathbf{c} = (2, -1, 3)$ 厘米， $R = 4$ 厘米， $\\mathbf{r}_{0} = (10, 1, 3)$ 厘米，以及中子的单位方向指定为从 $\\mathbf{r}_{0}$ 指向 $\\mathbf{c}$ 的归一化矢量，即 $\\mathbf{\\Omega} = -(\\mathbf{r}_{0} - \\mathbf{c}) / \\|\\mathbf{r}_{0} - \\mathbf{c}\\|$。\n\n推导并求解关于 $s$ 的二次方程，确定两个代数根，选择最近的正相交距离，并以厘米为单位报告此 $s$ 值。将您的最终数值答案四舍五入到四位有效数字。以厘米（cm）为单位表示最终距离。",
            "solution": "所述问题具有科学依据、适定、明确无误且内部一致。它提出了一个应用于粒子输运的解析几何标准问题，这是计算物理和核工程领域的核心课题。因此，该问题被认为是有效的，可以构建一个形式解。\n\n任务是找到中子从初始位置 $\\mathbf{r}_{0}$ 沿其路径到与以 $\\mathbf{c}$ 为中心、半径为 $R$ 的球体的第一个交点处的距离 $s$。\n\n中子在任意路径长度 $s$ 处的位置由直线的参数方程给出：\n$$\n\\mathbf{r}(s) = \\mathbf{r}_{0} + s \\mathbf{\\Omega}\n$$\n其中 $\\mathbf{r}_{0}$ 是初始位置，$\\mathbf{\\Omega}$ 是运动的单位方向矢量，$s$ 是行进的距离。为了在运动正方向上发生物理相交，必须有 $s > 0$。\n\n球体表面由所有满足以下条件的点 $\\mathbf{r}$ 定义：\n$$\n\\|\\mathbf{r} - \\mathbf{c}\\|^{2} = R^{2}\n$$\n其中 $\\|\\cdot\\|$ 表示欧几里得范数。\n\n为求交点，我们将中子的路径方程代入球体方程：\n$$\n\\|(\\mathbf{r}_{0} + s \\mathbf{\\Omega}) - \\mathbf{c}\\|^{2} = R^{2}\n$$\n我们可以重新排列范数内的项：\n$$\n\\|(\\mathbf{r}_{0} - \\mathbf{c}) + s \\mathbf{\\Omega}\\|^{2} = R^{2}\n$$\n范数的平方等于矢量与自身的点积。令矢量 $\\mathbf{v} = \\mathbf{r}_{0} - \\mathbf{c}$。方程变为：\n$$\n(\\mathbf{v} + s \\mathbf{\\Omega}) \\cdot (\\mathbf{v} + s \\mathbf{\\Omega}) = R^{2}\n$$\n利用点积的分配律展开：\n$$\n\\mathbf{v} \\cdot \\mathbf{v} + 2s(\\mathbf{v} \\cdot \\mathbf{\\Omega}) + s^{2}(\\mathbf{\\Omega} \\cdot \\mathbf{\\Omega}) = R^{2}\n$$\n根据定义，$\\mathbf{v} \\cdot \\mathbf{v} = \\|\\mathbf{v}\\|^{2}$，并且由于 $\\mathbf{\\Omega}$ 是单位矢量，$\\mathbf{\\Omega} \\cdot \\mathbf{\\Omega} = \\|\\mathbf{\\Omega}\\|^{2} = 1$。将这些代入方程，得到：\n$$\n\\|\\mathbf{v}\\|^{2} + 2s(\\mathbf{v} \\cdot \\mathbf{\\Omega}) + s^{2} = R^{2}\n$$\n将其整理成关于变量 $s$ 的标准二次方程形式 $as^2+bs+c=0$：\n$$\ns^{2} + \\left(2(\\mathbf{v} \\cdot \\mathbf{\\Omega})\\right)s + \\left(\\|\\mathbf{v}\\|^{2} - R^{2}\\right) = 0\n$$\n这就是求相交距离 $s$ 的一般二次方程。\n\n现在，我们使用问题陈述中给出的具体参数来计算系数：\n$\\mathbf{c} = (2, -1, 3)$\n$R = 4$\n$\\mathbf{r}_{0} = (10, 1, 3)$\n\n首先，我们计算矢量 $\\mathbf{v} = \\mathbf{r}_{0} - \\mathbf{c}$：\n$$\n\\mathbf{v} = (10 - 2, 1 - (-1), 3 - 3) = (8, 2, 0)\n$$\n接下来，我们计算其范数，即中子初始位置到球体中心的距离：\n$$\n\\|\\mathbf{v}\\| = \\|\\mathbf{r}_{0} - \\mathbf{c}\\| = \\sqrt{8^{2} + 2^{2} + 0^{2}} = \\sqrt{64 + 4} = \\sqrt{68}\n$$\n问题指定中子的方向矢量 $\\mathbf{\\Omega}$ 是从 $\\mathbf{r}_{0}$ 指向 $\\mathbf{c}$ 的归一化矢量：\n$$\n\\mathbf{\\Omega} = \\frac{\\mathbf{c} - \\mathbf{r}_{0}}{\\|\\mathbf{c} - \\mathbf{r}_{0}\\|} = -\\frac{\\mathbf{r}_{0} - \\mathbf{c}}{\\|\\mathbf{r}_{0} - \\mathbf{c}\\|} = -\\frac{\\mathbf{v}}{\\|\\mathbf{v}\\|}\n$$\n现在我们可以确定二次方程的系数。$s$ 的一次项系数是 $2(\\mathbf{v} \\cdot \\mathbf{\\Omega})$：\n$$\n2(\\mathbf{v} \\cdot \\mathbf{\\Omega}) = 2\\left(\\mathbf{v} \\cdot \\left(-\\frac{\\mathbf{v}}{\\|\\mathbf{v}\\|}\\right)\\right) = -2\\frac{\\mathbf{v} \\cdot \\mathbf{v}}{\\|\\mathbf{v}\\|} = -2\\frac{\\|\\mathbf{v}\\|^{2}}{\\|\\mathbf{v}\\|} = -2\\|\\mathbf{v}\\|\n$$\n代入 $\\|\\mathbf{v}\\| = \\sqrt{68}$ 的值，我们得到：\n$$\n2(\\mathbf{v} \\cdot \\mathbf{\\Omega}) = -2\\sqrt{68}\n$$\n常数项是 $(\\|\\mathbf{v}\\|^{2} - R^{2})$：\n$$\n\\|\\mathbf{v}\\|^{2} - R^{2} = (\\sqrt{68})^{2} - 4^{2} = 68 - 16 = 52\n$$\n代入这些系数，关于 $s$ 的具体二次方程是：\n$$\ns^{2} - (2\\sqrt{68})s + 52 = 0\n$$\n我们使用求根公式 $s = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 来解这个关于 $s$ 的方程，其中 $a=1$, $b=-2\\sqrt{68}$, $c=52$：\n$$\ns = \\frac{-(-2\\sqrt{68}) \\pm \\sqrt{(-2\\sqrt{68})^{2} - 4(1)(52)}}{2(1)}\n$$\n$$\ns = \\frac{2\\sqrt{68} \\pm \\sqrt{4 \\times 68 - 208}}{2}\n$$\n$$\ns = \\frac{2\\sqrt{68} \\pm \\sqrt{272 - 208}}{2}\n$$\n$$\ns = \\frac{2\\sqrt{68} \\pm \\sqrt{64}}{2}\n$$\n$$\ns = \\frac{2\\sqrt{68} \\pm 8}{2}\n$$\n$$\ns = \\sqrt{68} \\pm 4\n$$\n这给出了相交距离的两个代数根：\n$s_{1} = \\sqrt{68} - 4$\n$s_{2} = \\sqrt{68} + 4$\n\n由于初始位置 $\\mathbf{r}_{0}$ 在球体外部（因为 $\\|\\mathbf{r}_{0} - \\mathbf{c}\\| = \\sqrt{68} > R = 4$），并且中子正朝着球心方向运动，所以两个相交距离都将是正的。\n$s_1$ 代表到较近交点（入射点）的距离，而 $s_2$ 代表到较远交点（出射点）的距离。问题要求的是最近的正相交距离，即两个根中较小的那个，$s_{1}$。\n\n最近的相交距离是 $s = \\sqrt{68} - 4$。\n为了获得最终的数值答案，我们计算该值并将其四舍五入到四位有效数字。\n$$\ns = \\sqrt{68} - 4 \\approx 8.24621125... - 4 = 4.24621125...\n$$\n四舍五入到四位有效数字，我们得到：\n$$\ns \\approx 4.246\n$$\n该距离的单位是厘米（cm），与输入参数一致。",
            "answer": "$$\n\\boxed{4.246}\n$$"
        },
        {
            "introduction": "像核反应堆这样的实际系统通常具有重复结构，例如燃料棒晶格。在这些周期性几何结构中高效地追踪粒子至关重要。这可以通过使用通常由底函数实现的模运算，将粒子的全局位置映射到单个标准“单元”或“栅元”内的局部位置来实现。这项实践  旨在培养实现这种坐标变换的技能，这对于处理大规模重复几何结构而无需对每个组件进行显式建模至关重要。",
            "id": "4240383",
            "problem": "在使用组合几何的蒙特卡洛（MC）核反应堆模拟中，诸如燃料组件瓦片之类的重复结构由一个无限矩形晶格表示，其对称群由沿两个正交方向的固定节距平移组成。考虑一个二维无限矩形晶格，它模拟了反应堆水平面中瓦片的周期性布置，其沿 $\\hat{x}$ 和 $\\hat{y}$ 轴的节距分别为 $p_{x}$ 和 $p_{y}$。该晶格的平移群由向量 $p_{x}\\hat{x}$ 和 $p_{y}\\hat{y}$ 生成，每个瓦片内的材料描述定义在一个基本域中，该基本域通过 $p_{x}\\hat{x}$ 和 $p_{y}\\hat{y}$ 的整数倍进行平移。假设对于所有全局位置，瓦片的分配必须是唯一的，并且径迹到单元的映射必须确保局部位置位于单个规范基本域内，在共享边界上没有歧义。\n\n从平移不变性出发，通过严格选择一个避免边界点重复计算的半开基本域，推导一个从全局位置 $\\mathbf{r}=(x,y)$ 到整数瓦片索引 $(i,j)\\in\\mathbb{Z}^{2}$ 以及位于规范域内的局部位置 $\\mathbf{r}_{\\mathrm{local}}$ 的数学上一致的映射。然后，对于一个节距为 $p_{x}=12.5$ cm 和 $p_{y}=9.7$ cm 的矩形晶格，计算全局位置 $\\mathbf{r}=\\big(-20.345, 47.816\\big)$ cm 的索引和局部位置。所有距离以厘米表示。将局部位置的分量四舍五入到四位有效数字。以单行矩阵的形式提供最终答案，按顺序包含 $i$、$j$、$x_{\\mathrm{local}}$ 和 $y_{\\mathrm{local}}$。",
            "solution": "该问题要求推导一个从二维矩形晶格中的全局位置到一个唯一的整数瓦片索引集和规范基本域内局部位置的数学上一致的映射。这是计算几何学中模拟周期性系统（例如在蒙特卡洛粒子输运程序中）的一项基础任务。\n\n一个二维无限矩形晶格由两个正交的节距定义，即沿 $\\hat{x}$ 轴的 $p_x$ 和沿 $\\hat{y}$ 轴的 $p_y$。晶格点本身是瓦片网格的顶点。该系统的对称性由向量 $p_x \\hat{x}$ 和 $p_y \\hat{y}$ 生成的平移群描述。晶格中的任何瓦片都可以通过平移向量 $\\mathbf{T}_{i,j} = i p_x \\hat{x} + j p_y \\hat{y}$ 从位于原点的规范瓦片到达，其中索引 $(i,j)$ 是一个有序整数对，即 $(i, j) \\in \\mathbb{Z}^2$。\n\n任何全局位置向量 $\\mathbf{r} = x\\hat{x} + y\\hat{y}$ 都可以唯一地分解为一个晶格平移向量和一个位于特定基本域内的局部位置向量 $\\mathbf{r}_{\\mathrm{local}}$ 的和。该关系表示为：\n$$ \\mathbf{r} = \\mathbf{T}_{i,j} + \\mathbf{r}_{\\mathrm{local}} $$\n为确保从 $\\mathbf{r}$到 $(i, j)$ 和 $\\mathbf{r}_{\\mathrm{local}}$ 的映射是唯一的，必须选择基本域，使其在通过所有可能的晶格向量 $\\mathbf{T}_{i,j}$ 平移时，能够无间隙、无重叠地铺满整个平面 $\\mathbb{R}^2$。对于这个规范基本域，一个严格且标准的选择（我们将其表示为 $D_0$）是一个半开矩形，定义如下：\n$$ D_0 = \\{ (x, y) \\in \\mathbb{R}^2 \\mid 0 \\le x  p_x \\text{ and } 0 \\le y  p_y \\} $$\n这种选择确保了任何边界上的每个点都只被分配给一个瓦片。\n\n将该向量方程用其标量分量表示，我们得到：\n$x = i p_x + x_{\\mathrm{local}}$\n$y = j p_y + y_{\\mathrm{local}}$\n在此，局部位置的分量 $x_{\\mathrm{local}}$ 和 $y_{\\mathrm{local}}$ 必须满足由 $D_0$ 定义所施加的约束条件：\n$0 \\le x_{\\mathrm{local}}  p_x$\n$0 \\le y_{\\mathrm{local}}  p_y$\n\n为了确定整数索引 $i$ 和 $j$，我们可以重新排列分量方程。由于节距 $p_x$ 和 $p_y$ 是正距离，我们可以用它们相除：\n$\\frac{x}{p_x} = i + \\frac{x_{\\mathrm{local}}}{p_x}$\n$\\frac{y}{p_y} = j + \\frac{y_{\\mathrm{local}}}{p_y}$\n\n从对 $x_{\\mathrm{local}}$ 和 $y_{\\mathrm{local}}$ 的约束中，我们可以推导出分数项的范围：\n$0 \\le \\frac{x_{\\mathrm{local}}}{p_x}  1$\n$0 \\le \\frac{y_{\\mathrm{local}}}{p_y}  1$\n\n这些不等式意味着 $i$ 是比值 $x/p_x$ 的整数部分，而 $j$ 是比值 $y/p_y$ 的整数部分。这正是向下取整函数 $\\lfloor z \\rfloor$ 的定义，它给出小于或等于 $z$ 的最大整数。因此，瓦片索引的公式为：\n$$ i = \\left\\lfloor \\frac{x}{p_x} \\right\\rfloor $$\n$$ j = \\left\\lfloor \\frac{y}{p_y} \\right\\rfloor $$\n一旦索引 $(i,j)$ 已知，局部位置向量 $\\mathbf{r}_{\\mathrm{local}}$ 的分量可以通过简单的重新排列找到：\n$$ x_{\\mathrm{local}} = x - i p_x = x - p_x \\left\\lfloor \\frac{x}{p_x} \\right\\rfloor $$\n$$ y_{\\mathrm{local}} = y - j p_y = y - p_y \\left\\lfloor \\frac{y}{p_y} \\right\\rfloor $$\n这组方程提供了所需的一般映射。\n\n我们现在将此映射应用于问题中提供的具体数值。\n晶格节距为 $p_x = 12.5 \\, \\text{cm}$ 和 $p_y = 9.7 \\, \\text{cm}$。\n全局位置为 $\\mathbf{r} = (x,y) = (-20.345, 47.816) \\, \\text{cm}$。\n\n首先，我们计算整数瓦片索引 $(i,j)$：\n对于 $x$ 分量：\n$$ i = \\left\\lfloor \\frac{-20.345}{12.5} \\right\\rfloor = \\lfloor -1.6276 \\rfloor = -2 $$\n对于 $y$ 分量：\n$$ j = \\left\\lfloor \\frac{47.816}{9.7} \\right\\rfloor = \\lfloor 4.9294845... \\rfloor = 4 $$\n因此，该全局位置位于由索引 $(i,j) = (-2, 4)$ 标识的瓦片内。\n\n接下来，我们计算局部位置 $\\mathbf{r}_{\\mathrm{local}} = (x_{\\mathrm{local}}, y_{\\mathrm{local}})$：\n对于 $x$ 分量：\n$$ x_{\\mathrm{local}} = x - i p_x = -20.345 - (-2)(12.5) = -20.345 + 25.0 = 4.655 \\, \\text{cm} $$\n对于 $y$ 分量：\n$$ y_{\\mathrm{local}} = y - j p_y = 47.816 - (4)(9.7) = 47.816 - 38.8 = 9.016 \\, \\text{cm} $$\n得到的局部位置为 $\\mathbf{r}_{\\mathrm{local}} = (4.655, 9.016) \\, \\text{cm}$。这些值满足问题中要求四舍五入到四位有效数字的要求。\n\n作为验证，我们检查局部位置是否位于所选的基本域 $D_0 = [0, 12.5) \\times [0, 9.7)$ 内：\n$0 \\le 4.655  12.5$ 为真。\n$0 \\le 9.016  9.7$ 为真。\n该映射是一致的。最终答案按要求组合了索引和局部位置分量。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} -2  4  4.655  9.016 \\end{pmatrix} } $$"
        },
        {
            "introduction": "虽然标准的相交事件很常见，但一个稳健的追踪算法还必须正确处理特殊的“掠射”或相切事件，即粒子路径恰好接触到一个表面。在数学上，相切交点对应于一种退化情况，其中射线与表面的相交方程只有一个解（一个重根）。这项高级练习  探讨了相切的解析条件，并帮助您理解这些事件在实际追踪程序中对数值稳定性构成的挑战。",
            "id": "4240375",
            "problem": "在核反应堆模型的组合几何表示中，考虑一个半径为 $R$ 的无限长正圆柱体，其轴与 $z$ 轴重合。一个中性粒子在 $z=0$ 平面内被追踪，其轨迹为一条直线射线，起始位置向量为 $\\mathbf{r}_{0}=(R+a, 0, 0)$，方向向量为 $\\mathbf{\\hat{v}}=(\\cos\\theta, \\sin\\theta, 0)$，其中 $|\\mathbf{\\hat{v}}|=1$。圆柱体表面由 $x^2+y^2=R^2$ 隐式定义。粒子的路径为 $\\mathbf{r}(t)=\\mathbf{r}_{0}+t\\mathbf{\\hat{v}}$，$t\\ge 0$。\n\n从圆柱体和射线的定义以及求解多项式方程的基本代数出发，将相交条件表述为关于 $t$ 的二次方程，并通过要求该二次方程有唯一实数根来构造一个解析的掠射（相切）检验。由此，确定第二象限内的入射掠射角 $\\theta_{g}$（射线朝向 $x$ 减小的方向）以及到达接触点的相应路径长度 $t_{g}$。\n\n为了评估数值追踪的结果，假设追踪代码引入了一个微小的方向偏差，使得计算中使用的方向角为 $\\theta=\\theta_{g}+\\delta\\theta$，其中 $\\delta\\theta0$ 很小。该代码求解该二次方程，并报告较小的正根作为相交距离 $t_{-}$。使用对小 $\\delta\\theta$ 有效的渐近展开，确定 $t_{-}$ 相对于解析掠射值 $t_{g}$ 的主阶偏差，并计算在特定参数 $R=1.000\\,\\mathrm{m}$、$a=0.500\\,\\mathrm{m}$ 和 $\\delta\\theta=1.0\\times 10^{-12}\\,\\mathrm{rad}$ 下报告的 $t_{-}$。\n\n将最终答案表示为 $t_{-}$ 的单个值，单位为米，并四舍五入到七位有效数字。",
            "solution": "用户提供了一个与粒子追踪相关的组合几何问题。\n\n### 步骤1：提取已知条件\n-   几何：一个半径为 $R$ 的无限长正圆柱体，其轴沿 $z$ 轴。表面由 $x^{2}+y^{2}=R^{2}$ 定义。\n-   粒子运动：限制在 $z=0$ 平面内。\n-   初始位置：$\\mathbf{r}_{0}=(R+a, 0, 0)$。\n-   初始方向：$\\mathbf{\\hat{v}}=(\\cos\\theta, \\sin\\theta, 0)$，其中 $|\\mathbf{\\hat{v}}|=1$。\n-   路径方程：$\\mathbf{r}(t)=\\mathbf{r}_{0}+t\\mathbf{\\hat{v}}$，路径长度 $t\\ge 0$。\n-   任务1：将相交条件表述为关于 $t$ 的二次方程。\n-   任务2：通过要求 $t$ 有唯一实数根来构造解析的掠射检验。\n-   任务3：确定第二象限内的入射掠射角 $\\theta_{g}$ 和到达接触点的路径长度 $t_{g}$。\n-   任务4：分析方向偏差 $\\theta=\\theta_{g}+\\delta\\theta$（其中 $\\delta\\theta > 0$）的影响。\n-   任务5：求出所得二次方程的较小正根 $t_{-}$。\n-   任务6：使用渐近展开确定 $t_{-}$ 相对于 $t_{g}$ 的主阶偏差。\n-   任务7：在给定 $R=1.000\\,\\mathrm{m}$、$a=0.500\\,\\mathrm{m}$ 和 $\\delta\\theta=1.0\\times 10^{-12}\\,\\mathrm{rad}$ 的情况下，计算 $t_{-}$ 的数值。\n-   要求输出：$t_{-}$ 的值，单位为米，四舍五入到七位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，提法得当且客观。这是一个解析几何和射线追踪中的标准问题，这两者是蒙特卡洛粒子输运模拟代码的核心组成部分。其前提在物理上和数学上都是合理的。问题是自洽的，并提供了推导唯一解所需的所有信息。没有发现任何缺陷。\n\n### 步骤3：结论与行动\n问题有效。将提供完整的解答。\n\n### 解答推导\n\n粒子的路径由向量函数 $\\mathbf{r}(t) = \\mathbf{r}_{0} + t\\mathbf{\\hat{v}}$ 给出。以分量形式表示，粒子在路径长度为 $t$ 时的坐标是：\n$x(t) = R+a+t\\cos\\theta$\n$y(t) = t\\sin\\theta$\n\n当粒子的坐标满足圆柱体方程时，与圆柱体 $x^{2}+y^{2}=R^{2}$ 发生相交。将 $x(t)$ 和 $y(t)$ 代入圆柱体方程，得到：\n$$(R+a+t\\cos\\theta)^{2} + (t\\sin\\theta)^{2} = R^{2}$$\n展开各项：\n$$(R+a)^{2} + 2t(R+a)\\cos\\theta + t^{2}\\cos^{2}\\theta + t^{2}\\sin^{2}\\theta = R^{2}$$\n使用三角恒等式 $\\cos^{2}\\theta + \\sin^{2}\\theta = 1$，我们可以简化该方程：\n$$t^{2}(\\cos^{2}\\theta + \\sin^{2}\\theta) + 2(R+a)\\cos\\theta \\cdot t + (R+a)^{2} - R^{2} = 0$$\n这简化为关于路径长度 $t$ 的以下二次方程：\n$$t^{2} + \\left(2(R+a)\\cos\\theta\\right) t + \\left((R+a)^{2} - R^{2}\\right) = 0$$\n让我们简化常数项：$(R+a)^{2} - R^{2} = R^2 + 2Ra + a^2 - R^2 = 2Ra + a^2 = a(2R+a)$。\n该二次方程为：\n$$t^{2} + 2(R+a)\\cos\\theta \\cdot t + a(2R+a) = 0$$\n这是 $At^{2}+Bt+C=0$ 的形式，其中 $A=1$，$B=2(R+a)\\cos\\theta$，$C=a(2R+a)$。\n\n掠射（相切）相交对应于此二次方程只有一个实数根的情况。这在判别式 $\\Delta = B^{2}-4AC$ 为零时发生。\n$$\\Delta = (2(R+a)\\cos\\theta)^{2} - 4(1)(a(2R+a)) = 0$$\n$$4(R+a)^{2}\\cos^{2}\\theta = 4a(2R+a)$$\n$$\\cos^{2}\\theta_{g} = \\frac{a(2R+a)}{(R+a)^{2}}$$\n问题指定了入射射线朝向 $x$ 减小的方向，这要求 $\\cos\\theta  0$，并且掠射角 $\\theta_g$ 在第二象限。因此，我们取负根：\n$$\\cos\\theta_{g} = -\\frac{\\sqrt{a(2R+a)}}{R+a}$$\n对于第二象限，我们还必须有 $\\sin\\theta_g > 0$。我们可以验证这一点：\n$$\\sin^{2}\\theta_{g} = 1 - \\cos^{2}\\theta_{g} = 1 - \\frac{a(2R+a)}{(R+a)^{2}} = \\frac{(R+a)^{2} - (2Ra+a^{2})}{(R+a)^{2}} = \\frac{R^{2}+2Ra+a^{2}-2Ra-a^{2}}{(R+a)^{2}} = \\frac{R^{2}}{(R+a)^{2}}$$\n因此，$\\sin\\theta_{g} = \\frac{R}{R+a}$。由于 $R>0$ 且 $a>0$，$\\sin\\theta_g > 0$ 符合要求。\n\n在掠射角下的 $t$ 的唯一根 $t_g$ 由 $t = -B/(2A)$ 给出：\n$$t_{g} = -\\frac{2(R+a)\\cos\\theta_{g}}{2} = -(R+a)\\cos\\theta_{g}$$\n代入 $\\cos\\theta_{g}$ 的表达式：\n$$t_{g} = -(R+a) \\left(-\\frac{\\sqrt{a(2R+a)}}{R+a}\\right) = \\sqrt{a(2R+a)}$$\n\n现在，我们考虑受扰动的角度 $\\theta = \\theta_{g}+\\delta\\theta$，其中 $\\delta\\theta > 0$ 很小。关于 $t$ 的二次方程的根由二次公式给出：\n$$t_{\\pm} = \\frac{-B \\pm \\sqrt{B^{2}-4AC}}{2A} = -(R+a)\\cos\\theta \\pm \\sqrt{((R+a)\\cos\\theta)^{2} - a(2R+a)}$$\n较小的正根是 $t_{-}$：\n$$t_{-} = -(R+a)\\cos\\theta - \\sqrt{((R+a)\\cos\\theta)^{2} - a(2R+a)}$$\n我们对小的 $\\delta\\theta$ 进行渐近展开。首先，我们展开 $\\cos\\theta$：\n$$\\cos\\theta = \\cos(\\theta_{g}+\\delta\\theta) = \\cos\\theta_{g}\\cos(\\delta\\theta)-\\sin\\theta_{g}\\sin(\\delta\\theta) \\approx \\cos\\theta_{g} - \\delta\\theta\\sin\\theta_{g}$$\n$t_{-}$ 表达式中的第一项变为：\n$$-(R+a)\\cos\\theta \\approx -(R+a)(\\cos\\theta_{g} - \\delta\\theta\\sin\\theta_{g}) = -(R+a)\\cos\\theta_{g} + \\delta\\theta(R+a)\\sin\\theta_{g}$$\n使用 $t_{g} = -(R+a)\\cos\\theta_{g}$ 和 $\\sin\\theta_{g} = R/(R+a)$，该项为：\n$$t_{g} + \\delta\\theta(R+a)\\frac{R}{R+a} = t_g + R\\delta\\theta$$\n接下来，我们展开平方根下的项，即判别式 $\\Delta(\\theta)$：\n$$\\Delta(\\theta) = ((R+a)\\cos\\theta)^{2} - a(2R+a) \\approx (R+a)^{2}(\\cos\\theta_{g}-\\delta\\theta\\sin\\theta_{g})^{2} - a(2R+a)$$\n$$\\Delta(\\theta) \\approx (R+a)^{2}(\\cos^{2}\\theta_{g} - 2\\delta\\theta\\cos\\theta_{g}\\sin\\theta_{g}) - a(2R+a)$$\n我们使用 $(R+a)^{2}\\cos^{2}\\theta_g = a(2R+a)$。\n$$\\Delta(\\theta) \\approx a(2R+a) - 2\\delta\\theta(R+a)^{2}\\cos\\theta_{g}\\sin\\theta_{g} - a(2R+a)$$\n$$\\Delta(\\theta) \\approx -2\\delta\\theta(R+a)^{2}\\cos\\theta_{g}\\sin\\theta_{g}$$\n代入 $\\cos\\theta_{g}$ 和 $\\sin\\theta_{g}$ 的表达式：\n$$\\Delta(\\theta) \\approx -2\\delta\\theta(R+a)^{2}\\left(-\\frac{\\sqrt{a(2R+a)}}{R+a}\\right)\\left(\\frac{R}{R+a}\\right) = 2R\\delta\\theta\\sqrt{a(2R+a)} = 2R t_{g} \\delta\\theta$$\n$t_{-}$ 中的平方根项为 $\\sqrt{\\Delta(\\theta)} \\approx \\sqrt{2Rt_{g}\\delta\\theta}$。\n组合各项以求得 $t_{-}$：\n$$t_{-} \\approx (t_{g}+R\\delta\\theta) - \\sqrt{2Rt_{g}\\delta\\theta}$$\n与 $t_{g}$ 的主阶偏差是与 $\\sqrt{\\delta\\theta}$ 成正比的项，因为它比 $\\delta\\theta$ 项的阶数更低。\n偏差为 $t_{-} - t_{g} \\approx -\\sqrt{2Rt_{g}\\delta\\theta}$。\n对于 $t_-$ 本身的数值计算，我们使用表达式 $t_{-} \\approx t_{g} - \\sqrt{2Rt_{g}\\delta\\theta} + R\\delta\\theta$。\n\n给定 $R=1.000\\,\\mathrm{m}$、$a=0.500\\,\\mathrm{m}$ 和 $\\delta\\theta=1.0\\times 10^{-12}\\,\\mathrm{rad}$。\n首先，我们计算掠射距离 $t_{g}$：\n$$t_{g} = \\sqrt{a(2R+a)} = \\sqrt{0.500(2(1.000)+0.500)} = \\sqrt{0.500(2.500)} = \\sqrt{1.25}\\,\\mathrm{m}$$\n现在，我们计算 $t_{-}$ 展开式中的各项：\n主要修正项是：\n$$\\sqrt{2Rt_{g}\\delta\\theta} = \\sqrt{2(1.000)\\sqrt{1.25}(1.0\\times 10^{-12})} = \\sqrt{2\\sqrt{1.25}} \\times 10^{-6}\\,\\mathrm{m}$$\n$$2\\sqrt{1.25} = 2 \\times 1.1180339887... = 2.236067977... = \\sqrt{5}$$\n$$\\sqrt{2Rt_{g}\\delta\\theta} = \\sqrt{\\sqrt{5}} \\times 10^{-6} = (5^{1/4})\\times 10^{-6} \\approx 1.495348781 \\times 10^{-6} \\,\\mathrm{m}$$\n高阶修正项是：\n$$R\\delta\\theta = 1.000 \\times 1.0 \\times 10^{-12} = 1.0 \\times 10^{-12} \\,\\mathrm{m}$$\n现在，我们计算 $t_{-}$：\n$$t_{-} \\approx t_{g} - \\sqrt{2Rt_{g}\\delta\\theta} + R\\delta\\theta$$\n$$t_{-} \\approx \\sqrt{1.25} - 1.495348781 \\times 10^{-6} + 1.0 \\times 10^{-12}$$\n$$t_{-} \\approx 1.1180339887 - 0.000001495348781 + 0.000000000001$$\n$$t_{-} \\approx 1.118032493351$$\n将此结果四舍五入到七位有效数字，我们得到：\n$$t_{-} \\approx 1.118032\\,\\mathrm{m}$$\n项 $R\\delta\\theta$ 远小于主阶修正项，并且在此精度水平上不影响结果，但包含它可以提供更准确的估计。\n主阶偏差 $t_{-} - t_{g}$ 约为 $-1.495 \\times 10^{-6}\\,\\mathrm{m}$。\n所要求的值是 $t_{-}$。\n$t_{-} \\approx 1.118032493 \\dots \\,\\mathrm{m}$。\n四舍五入到七位有效数字：$1.118032$。",
            "answer": "$$\\boxed{1.118032}$$"
        }
    ]
}