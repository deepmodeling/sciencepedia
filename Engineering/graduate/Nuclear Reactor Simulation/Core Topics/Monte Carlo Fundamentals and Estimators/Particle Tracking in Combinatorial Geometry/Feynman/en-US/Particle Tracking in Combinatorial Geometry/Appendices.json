{
    "hands_on_practices": [
        {
            "introduction": "The most fundamental operation in particle tracking is determining the distance from a particle's current position to the nearest surface along its path. This practice guides you through the first-principles derivation of the intersection distance for a ray and a sphere. By solving this foundational problem in analytic geometry , you will build the essential mathematical skills needed to track particles through any complex environment defined by quadratic surfaces.",
            "id": "4240397",
            "problem": "In Monte Carlo Neutron Transport (MCNT) within nuclear reactor simulation, particle tracking in combinatorial geometry reduces spatial queries to analytic intersection problems. Consider a spherical fuel micro-particle with center at position vector $\\mathbf{c}$ and radius $R$. A neutron is at position $\\mathbf{r}_{0}$ and moves in a straight line along a unit direction vector $\\mathbf{\\Omega}$, so that its parametric path is $\\mathbf{r}(s) = \\mathbf{r}_{0} + s \\mathbf{\\Omega}$, where $s$ is the path length to be determined. The sphere is the set of points satisfying $\\|\\mathbf{r} - \\mathbf{c}\\|^{2} = R^{2}$.\n\nFrom first principles, using Euclidean geometry and the definitions of dot product and norm, formulate the condition for intersection as a quadratic equation in $s$, solve it to obtain the two algebraic roots, restrict to the positive roots that correspond to physically forward intersections along $\\mathbf{\\Omega}$, and select the nearest such intersection distance (the entry point).\n\nUse the following physically consistent parameters representative of a fuel kernel in a pebble-bed micro-geometry: $\\mathbf{c} = (2, -1, 3)$ in centimeters, $R = 4$ in centimeters, $\\mathbf{r}_{0} = (10, 1, 3)$ in centimeters, and the neutron’s unit direction specified as the normalized vector pointing from $\\mathbf{r}_{0}$ to $\\mathbf{c}$, i.e., $\\mathbf{\\Omega} = -(\\mathbf{r}_{0} - \\mathbf{c}) / \\|\\mathbf{r}_{0} - \\mathbf{c}\\|$.\n\nDerive and solve the quadratic for $s$, identify both algebraic roots, select the nearest positive intersection distance, and report this $s$ in centimeters. Round your final numerical answer to four significant figures. Express the final distance in centimeters (cm).",
            "solution": "The problem as stated is scientifically grounded, well-posed, unambiguous, and internally consistent. It poses a standard problem in analytic geometry applied to particle transport, a core topic in computational physics and nuclear engineering. Consequently, the problem is deemed valid and a formal solution can be constructed.\n\nThe task is to find the distance $s$ along a neutron's path from an initial position $\\mathbf{r}_{0}$ to the first point of intersection with a sphere of radius $R$ centered at $\\mathbf{c}$.\n\nThe position of the neutron at any path length $s$ is given by the parametric equation of a line:\n$$\n\\mathbf{r}(s) = \\mathbf{r}_{0} + s \\mathbf{\\Omega}\n$$\nwhere $\\mathbf{r}_{0}$ is the initial position, $\\mathbf{\\Omega}$ is the unit direction vector of motion, and $s$ is the distance travelled. For a physical intersection to occur in the forward direction of motion, we must have $s > 0$.\n\nThe surface of the sphere is defined by the set of all points $\\mathbf{r}$ that satisfy:\n$$\n\\|\\mathbf{r} - \\mathbf{c}\\|^{2} = R^{2}\n$$\nwhere $\\|\\cdot\\|$ denotes the Euclidean norm.\n\nTo find the intersection points, we substitute the neutron's path equation into the sphere equation:\n$$\n\\|(\\mathbf{r}_{0} + s \\mathbf{\\Omega}) - \\mathbf{c}\\|^{2} = R^{2}\n$$\nWe can rearrange the terms inside the norm:\n$$\n\\|(\\mathbf{r}_{0} - \\mathbf{c}) + s \\mathbf{\\Omega}\\|^{2} = R^{2}\n$$\nThe squared norm is equivalent to the dot product of the vector with itself. Let the vector $\\mathbf{v} = \\mathbf{r}_{0} - \\mathbf{c}$. The equation becomes:\n$$\n(\\mathbf{v} + s \\mathbf{\\Omega}) \\cdot (\\mathbf{v} + s \\mathbf{\\Omega}) = R^{2}\n$$\nExpanding the dot product using its distributive property:\n$$\n\\mathbf{v} \\cdot \\mathbf{v} + 2s(\\mathbf{v} \\cdot \\mathbf{\\Omega}) + s^{2}(\\mathbf{\\Omega} \\cdot \\mathbf{\\Omega}) = R^{2}\n$$\nBy definition, $\\mathbf{v} \\cdot \\mathbf{v} = \\|\\mathbf{v}\\|^{2}$, and since $\\mathbf{\\Omega}$ is a unit vector, $\\mathbf{\\Omega} \\cdot \\mathbf{\\Omega} = \\|\\mathbf{\\Omega}\\|^{2} = 1$. Substituting these into the equation yields:\n$$\n\\|\\mathbf{v}\\|^{2} + 2s(\\mathbf{v} \\cdot \\mathbf{\\Omega}) + s^{2} = R^{2}\n$$\nRearranging this into the standard quadratic form $as^2+bs+c=0$ for the variable $s$:\n$$\ns^{2} + \\left(2(\\mathbf{v} \\cdot \\mathbf{\\Omega})\\right)s + \\left(\\|\\mathbf{v}\\|^{2} - R^{2}\\right) = 0\n$$\nThis is the general quadratic equation for the intersection distance $s$.\n\nNow, we will evaluate the coefficients using the specific parameters given in the problem statement:\n$\\mathbf{c} = (2, -1, 3)$\n$R = 4$\n$\\mathbf{r}_{0} = (10, 1, 3)$\n\nFirst, we compute the vector $\\mathbf{v} = \\mathbf{r}_{0} - \\mathbf{c}$:\n$$\n\\mathbf{v} = (10 - 2, 1 - (-1), 3 - 3) = (8, 2, 0)\n$$\nNext, we compute its norm, which is the distance from the neutron's initial position to the center of the sphere:\n$$\n\\|\\mathbf{v}\\| = \\|\\mathbf{r}_{0} - \\mathbf{c}\\| = \\sqrt{8^{2} + 2^{2} + 0^{2}} = \\sqrt{64 + 4} = \\sqrt{68}\n$$\nThe problem specifies the neutron's direction vector $\\mathbf{\\Omega}$ as the normalized vector pointing from $\\mathbf{r}_{0}$ to $\\mathbf{c}$:\n$$\n\\mathbf{\\Omega} = \\frac{\\mathbf{c} - \\mathbf{r}_{0}}{\\|\\mathbf{c} - \\mathbf{r}_{0}\\|} = -\\frac{\\mathbf{r}_{0} - \\mathbf{c}}{\\|\\mathbf{r}_{0} - \\mathbf{c}\\|} = -\\frac{\\mathbf{v}}{\\|\\mathbf{v}\\|}\n$$\nNow we can determine the coefficients of the quadratic equation. The coefficient of the linear term in $s$ is $2(\\mathbf{v} \\cdot \\mathbf{\\Omega})$:\n$$\n2(\\mathbf{v} \\cdot \\mathbf{\\Omega}) = 2\\left(\\mathbf{v} \\cdot \\left(-\\frac{\\mathbf{v}}{\\|\\mathbf{v}\\|}\\right)\\right) = -2\\frac{\\mathbf{v} \\cdot \\mathbf{v}}{\\|\\mathbf{v}\\|} = -2\\frac{\\|\\mathbf{v}\\|^{2}}{\\|\\mathbf{v}\\|} = -2\\|\\mathbf{v}\\|\n$$\nSubstituting the value of $\\|\\mathbf{v}\\| = \\sqrt{68}$, we get:\n$$\n2(\\mathbf{v} \\cdot \\mathbf{\\Omega}) = -2\\sqrt{68}\n$$\nThe constant term is $(\\|\\mathbf{v}\\|^{2} - R^{2})$:\n$$\n\\|\\mathbf{v}\\|^{2} - R^{2} = (\\sqrt{68})^{2} - 4^{2} = 68 - 16 = 52\n$$\nSubstituting these coefficients, the specific quadratic equation for $s$ is:\n$$\ns^{2} - (2\\sqrt{68})s + 52 = 0\n$$\nWe solve this equation for $s$ using the quadratic formula, $s = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a=1$, $b=-2\\sqrt{68}$, and $c=52$:\n$$\ns = \\frac{-(-2\\sqrt{68}) \\pm \\sqrt{(-2\\sqrt{68})^{2} - 4(1)(52)}}{2(1)}\n$$\n$$\ns = \\frac{2\\sqrt{68} \\pm \\sqrt{4 \\times 68 - 208}}{2}\n$$\n$$\ns = \\frac{2\\sqrt{68} \\pm \\sqrt{272 - 208}}{2}\n$$\n$$\ns = \\frac{2\\sqrt{68} \\pm \\sqrt{64}}{2}\n$$\n$$\ns = \\frac{2\\sqrt{68} \\pm 8}{2}\n$$\n$$\ns = \\sqrt{68} \\pm 4\n$$\nThis gives two algebraic roots for the intersection distance:\n$s_{1} = \\sqrt{68} - 4$\n$s_{2} = \\sqrt{68} + 4$\n\nSince the initial position $\\mathbf{r}_{0}$ is outside the sphere (because $\\|\\mathbf{r}_{0} - \\mathbf{c}\\| = \\sqrt{68} > R = 4$), and the neutron is traveling towards the sphere's center, both intersection distances will be positive.\n$s_1$ represents the distance to the closer intersection point (the entry point), and $s_2$ represents the distance to the farther intersection point (the exit point). The problem asks for the nearest positive intersection distance, which is the smaller of the two roots, $s_{1}$.\n\nThe nearest intersection distance is $s = \\sqrt{68} - 4$.\nTo obtain the final numerical answer, we compute this value and round it to four significant figures.\n$$\ns = \\sqrt{68} - 4 \\approx 8.24621125... - 4 = 4.24621125...\n$$\nRounding to four significant figures, we get:\n$$\ns \\approx 4.246\n$$\nThe units for this distance are centimeters (cm), consistent with the input parameters.",
            "answer": "$$\n\\boxed{4.246}\n$$"
        },
        {
            "introduction": "Realistic reactor models are often composed of repeating structures, such as a lattice of fuel pins. This exercise  focuses on the critical algorithm for navigating these periodic geometries by mapping a particle's global coordinates to a unique lattice index and a local position within the corresponding cell. Mastering this technique is a cornerstone of building efficient, large-scale simulations that can exploit geometric periodicity.",
            "id": "4240383",
            "problem": "In Monte Carlo (MC) nuclear reactor simulation using combinatorial geometry, repeated structures such as fuel assembly tiles are represented by an infinite rectangular lattice whose symmetry group consists of translations by fixed pitch distances along two orthogonal directions. Consider a two-dimensional, infinite rectangular lattice that models the periodic placement of tiles in the reactor’s horizontal plane, with pitch distances $p_{x}$ and $p_{y}$ along the $\\hat{x}$ and $\\hat{y}$ axes, respectively. The lattice translation group is generated by vectors $p_{x}\\hat{x}$ and $p_{y}\\hat{y}$, and the material description within each tile is defined in a fundamental domain that is translated by integer multiples of $p_{x}\\hat{x}$ and $p_{y}\\hat{y}$. Assume the tile assignment must be unique for all global positions and that track-to-cell mapping must ensure the local position lies inside a single canonical fundamental domain without ambiguity at shared boundaries.\n\nStarting from translational invariance and a rigorous choice of a half-open fundamental domain that avoids double-counting of boundary points, derive a mathematically consistent mapping from a global position $\\mathbf{r}=(x,y)$ to integer tile indices $(i,j)\\in\\mathbb{Z}^{2}$ and a local position $\\mathbf{r}_{\\mathrm{local}}$ that lies inside the canonical domain. Then, for a rectangular lattice with pitches $p_{x}=12.5$ cm and $p_{y}=9.7$ cm, compute the indices and local position for the global position $\\mathbf{r}=(-20.345, 47.816)$ cm. Express any distances in centimeters. Round the components of the local position to four significant figures. Provide your final answer as a single row matrix containing $i$, $j$, $x_{\\mathrm{local}}$, and $y_{\\mathrm{local}}$ in that order.",
            "solution": "The problem requires the derivation of a mathematically consistent mapping from a global position in a two-dimensional rectangular lattice to a unique set of integer tile indices and a local position within a canonical fundamental domain. This is a foundational task in computational geometry for simulating periodic systems, such as in Monte Carlo particle transport codes.\n\nA two-dimensional infinite rectangular lattice is defined by two orthogonal pitch distances, $p_x$ along the $\\hat{x}$-axis and $p_y$ along the $\\hat{y}$-axis. The lattice points themselves are the vertices of the grid of tiles. The symmetry of the system is described by a translation group generated by vectors $p_x \\hat{x}$ and $p_y \\hat{y}$. Any tile in the lattice can be reached from a canonical tile at the origin by a translation vector $\\mathbf{T}_{i,j} = i p_x \\hat{x} + j p_y \\hat{y}$, where the indices $(i,j)$ are an ordered pair of integers, i.e., $(i, j) \\in \\mathbb{Z}^2$.\n\nAny global position vector $\\mathbf{r} = x\\hat{x} + y\\hat{y}$ can be uniquely decomposed into a sum of a lattice translation vector and a local position vector $\\mathbf{r}_{\\mathrm{local}}$ that lies within a specific fundamental domain. This relationship is expressed as:\n$$ \\mathbf{r} = \\mathbf{T}_{i,j} + \\mathbf{r}_{\\mathrm{local}} $$\nTo ensure that the mapping from $\\mathbf{r}$ to $(i, j)$ and $\\mathbf{r}_{\\mathrm{local}}$ is unique, the fundamental domain must be chosen such that it tiles the entire plane $\\mathbb{R}^2$ without gaps or overlaps when translated by all possible lattice vectors $\\mathbf{T}_{i,j}$. A rigorous and standard choice for this canonical fundamental domain, which we shall denote $D_0$, is a half-open rectangle defined as:\n$$ D_0 = \\{ (x, y) \\in \\mathbb{R}^2 \\mid 0 \\le x  p_x \\text{ and } 0 \\le y  p_y \\} $$\nThis choice ensures that every point on any boundary is assigned to exactly one tile.\n\nExpressing the vector equation in its scalar components, we have:\n$x = i p_x + x_{\\mathrm{local}}$\n$y = j p_y + y_{\\mathrm{local}}$\nHere, the components of the local position, $x_{\\mathrm{local}}$ and $y_{\\mathrm{local}}$, must satisfy the constraints imposed by the definition of $D_0$:\n$0 \\le x_{\\mathrm{local}}  p_x$\n$0 \\le y_{\\mathrm{local}}  p_y$\n\nTo determine the integer indices $i$ and $j$, we can rearrange the component equations. Since the pitches $p_x$ and $p_y$ are positive distances, we can divide by them:\n$\\frac{x}{p_x} = i + \\frac{x_{\\mathrm{local}}}{p_x}$\n$\\frac{y}{p_y} = j + \\frac{y_{\\mathrm{local}}}{p_y}$\n\nFrom the constraints on $x_{\\mathrm{local}}$ and $y_{\\mathrm{local}}$, we can deduce the ranges for the fractional terms:\n$0 \\le \\frac{x_{\\mathrm{local}}}{p_x}  1$\n$0 \\le \\frac{y_{\\mathrm{local}}}{p_y}  1$\n\nThese inequalities imply that $i$ is the integer part of the ratio $x/p_x$, and $j$ is the integer part of $y/p_y$. This is precisely the definition of the floor function, $\\lfloor z \\rfloor$, which yields the greatest integer less than or equal to $z$. Therefore, the formulas for the tile indices are:\n$$ i = \\left\\lfloor \\frac{x}{p_x} \\right\\rfloor $$\n$$ j = \\left\\lfloor \\frac{y}{p_y} \\right\\rfloor $$\nOnce the indices $(i,j)$ are known, the components of the local position vector $\\mathbf{r}_{\\mathrm{local}}$ are found by simple rearrangement:\n$$ x_{\\mathrm{local}} = x - i p_x = x - p_x \\left\\lfloor \\frac{x}{p_x} \\right\\rfloor $$\n$$ y_{\\mathrm{local}} = y - j p_y = y - p_y \\left\\lfloor \\frac{y}{p_y} \\right\\rfloor $$\nThis set of equations provides the required general mapping.\n\nWe now apply this mapping to the specific numerical values provided in the problem.\nThe lattice pitches are $p_x = 12.5 \\, \\text{cm}$ and $p_y = 9.7 \\, \\text{cm}$.\nThe global position is $\\mathbf{r} = (x,y) = (-20.345, 47.816) \\, \\text{cm}$.\n\nFirst, we compute the integer tile indices $(i,j)$:\nFor the $x$-component:\n$$ i = \\left\\lfloor \\frac{-20.345}{12.5} \\right\\rfloor = \\lfloor -1.6276 \\rfloor = -2 $$\nFor the $y$-component:\n$$ j = \\left\\lfloor \\frac{47.816}{9.7} \\right\\rfloor = \\lfloor 4.9294845... \\rfloor = 4 $$\nThus, the global position lies within the tile identified by indices $(i,j) = (-2, 4)$.\n\nNext, we compute the local position $\\mathbf{r}_{\\mathrm{local}} = (x_{\\mathrm{local}}, y_{\\mathrm{local}})$:\nFor the $x$-component:\n$$ x_{\\mathrm{local}} = x - i p_x = -20.345 - (-2)(12.5) = -20.345 + 25.0 = 4.655 \\, \\text{cm} $$\nFor the $y$-component:\n$$ y_{\\mathrm{local}} = y - j p_y = 47.816 - (4)(9.7) = 47.816 - 38.8 = 9.016 \\, \\text{cm} $$\nThe resulting local position is $\\mathbf{r}_{\\mathrm{local}} = (4.655, 9.016) \\, \\text{cm}$. These values satisfy the problem's requirement for rounding to four significant figures.\n\nAs a verification, we check if the local position lies within the chosen fundamental domain $D_0 = [0, 12.5) \\times [0, 9.7)$:\n$0 \\le 4.655  12.5$ is true.\n$0 \\le 9.016  9.7$ is true.\nThe mapping is consistent. The final answer combines the indices and local position components as requested.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} -2  4  4.655  9.016 \\end{pmatrix} } $$"
        },
        {
            "introduction": "While the basic mathematics of ray-surface intersection seems straightforward, floating-point arithmetic and geometric edge cases present significant challenges for robust implementation. This problem explores the important case of a 'grazing' trajectory, where a particle's path is nearly tangent to a surface. By analyzing the discriminant of the intersection quadratic and the resulting numerical behavior , you will learn to diagnose and handle a common source of instability in particle tracking codes.",
            "id": "4240375",
            "problem": "In a combinatorial geometry representation of a nuclear reactor model, consider a single infinite right circular cylinder of radius $R$ whose axis coincides with the $z$-axis. A neutral particle is tracked as a straight ray in the plane $z=0$ from an initial position vector $\\mathbf{r}_{0}=(R+a, 0, 0)$ with direction vector $\\hat{\\mathbf{v}}=(\\cos\\theta, \\sin\\theta, 0)$, where $\\|\\hat{\\mathbf{v}}\\|=1$. The cylinder surface is defined implicitly by $x^{2}+y^{2}=R^{2}$. The path of the particle is $\\mathbf{r}(t)=\\mathbf{r}_{0}+t\\,\\hat{\\mathbf{v}}$, $t\\ge 0$.\n\nStarting from the definitions of the cylinder and the ray, and basic algebra of solving polynomial equations, formulate the intersection condition as a quadratic in $t$, and construct an analytic grazing (tangential) test by requiring that this quadratic have a single real root. From this, determine the incoming grazing angle $\\theta_{g}$ in the second quadrant (the ray heads toward decreasing $x$) and the corresponding path length to point of contact $t_{g}$.\n\nTo assess numerical tracking outcomes, suppose the tracking code introduces a tiny directional bias such that the direction angle used in the computation is $\\theta=\\theta_{g}+\\delta\\theta$ with $\\delta\\theta0$ small. The code solves the quadratic and reports the smaller positive root as the intersection distance $t_{-}$. Using an asymptotic expansion valid for small $\\delta\\theta$, determine the leading-order departure of $t_{-}$ from the analytic grazing value $t_{g}$ and compute the reported $t_{-}$ for the specific parameters $R=1.000\\,\\mathrm{m}$, $a=0.500\\,\\mathrm{m}$, and $\\delta\\theta=1.0\\times 10^{-12}\\,\\mathrm{rad}$.\n\nExpress the final answer as the single value of $t_{-}$ in meters, rounded to seven significant figures.",
            "solution": "The user has provided a problem in combinatorial geometry related to particle tracking.\n\n### Step 1: Extract Givens\n-   Geometry: An infinite right circular cylinder with radius $R$ and axis along the $z$-axis. The surface is defined by $x^{2}+y^{2}=R^{2}$.\n-   Particle motion: Confined to the plane $z=0$.\n-   Initial position: $\\mathbf{r}_{0}=(R+a, 0, 0)$.\n-   Initial direction: $\\hat{\\mathbf{v}}=(\\cos\\theta, \\sin\\theta, 0)$, where $\\|\\hat{\\mathbf{v}}\\|=1$.\n-   Path equation: $\\mathbf{r}(t)=\\mathbf{r}_{0}+t\\,\\hat{\\mathbf{v}}$ for path length $t\\ge 0$.\n-   Task 1: Formulate the intersection condition as a quadratic equation in $t$.\n-   Task 2: Construct an analytic grazing test by requiring a single real root for $t$.\n-   Task 3: Determine the incoming grazing angle $\\theta_{g}$ in the second quadrant and the path length to the point of contact $t_{g}$.\n-   Task 4: Analyze the effect of a directional bias $\\theta=\\theta_{g}+\\delta\\theta$ with $\\delta\\theta  0$.\n-   Task 5: Find the smaller positive root $t_{-}$ of the resulting quadratic.\n-   Task 6: Use an asymptotic expansion to determine the leading-order departure of $t_{-}$ from $t_{g}$.\n-   Task 7: Compute a numerical value for $t_{-}$ given $R=1.000\\,\\mathrm{m}$, $a=0.500\\,\\mathrm{m}$, and $\\delta\\theta=1.0\\times 10^{-12}\\,\\mathrm{rad}$.\n-   Required Output: The value of $t_{-}$ in meters, rounded to seven significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It is a standard problem in analytic geometry and ray tracing, which are core components of Monte Carlo particle transport simulation codes. The premises are physically and mathematically sound. The problem is self-contained and provides all necessary information to derive a unique solution. No flaws are identified.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\n\nThe path of the particle is given by the vector function $\\mathbf{r}(t) = \\mathbf{r}_{0} + t\\,\\hat{\\mathbf{v}}$. In component form, the coordinates of the particle at a path length $t$ are:\n$x(t) = R+a+t\\cos\\theta$\n$y(t) = t\\sin\\theta$\n\nAn intersection with the cylinder $x^{2}+y^{2}=R^{2}$ occurs when the particle's coordinates satisfy the cylinder's equation. Substituting $x(t)$ and $y(t)$ into the cylinder equation yields:\n$$(R+a+t\\cos\\theta)^{2} + (t\\sin\\theta)^{2} = R^{2}$$\nExpanding the terms:\n$$(R+a)^{2} + 2t(R+a)\\cos\\theta + t^{2}\\cos^{2}\\theta + t^{2}\\sin^{2}\\theta = R^{2}$$\nUsing the trigonometric identity $\\cos^{2}\\theta + \\sin^{2}\\theta = 1$, we can simplify the equation:\n$$t^{2}(\\cos^{2}\\theta + \\sin^{2}\\theta) + 2(R+a)\\cos\\theta \\cdot t + (R+a)^{2} - R^{2} = 0$$\nThis simplifies to the following quadratic equation for the path length $t$:\n$$t^{2} + \\left(2(R+a)\\cos\\theta\\right) t + \\left((R+a)^{2} - R^{2}\\right) = 0$$\nLet's simplify the constant term: $(R+a)^{2} - R^{2} = R^2 + 2Ra + a^2 - R^2 = 2Ra + a^2 = a(2R+a)$.\nThe quadratic equation is:\n$$t^{2} + 2(R+a)\\cos\\theta \\cdot t + a(2R+a) = 0$$\nThis is of the form $At^{2}+Bt+C=0$ with $A=1$, $B=2(R+a)\\cos\\theta$, and $C=a(2R+a)$.\n\nA grazing (tangential) intersection corresponds to the case where this quadratic equation has exactly one real root. This occurs when the discriminant, $\\Delta = B^{2}-4AC$, is zero.\n$$\\Delta = (2(R+a)\\cos\\theta)^{2} - 4(1)(a(2R+a)) = 0$$\n$$4(R+a)^{2}\\cos^{2}\\theta = 4a(2R+a)$$\n$$\\cos^{2}\\theta_{g} = \\frac{a(2R+a)}{(R+a)^{2}}$$\nThe problem specifies an incoming ray heading toward decreasing $x$, which requires $\\cos\\theta  0$, and that the grazing angle $\\theta_g$ is in the second quadrant. Therefore, we take the negative root:\n$$\\cos\\theta_{g} = -\\frac{\\sqrt{a(2R+a)}}{R+a}$$\nFor the second quadrant, we must also have $\\sin\\theta_g  0$. We can verify this:\n$$\\sin^{2}\\theta_{g} = 1 - \\cos^{2}\\theta_{g} = 1 - \\frac{a(2R+a)}{(R+a)^{2}} = \\frac{(R+a)^{2} - (2Ra+a^{2})}{(R+a)^{2}} = \\frac{R^{2}+2Ra+a^{2}-2Ra-a^{2}}{(R+a)^{2}} = \\frac{R^{2}}{(R+a)^{2}}$$\nThus, $\\sin\\theta_{g} = \\frac{R}{R+a}$. Since $R0$ and $a0$, $\\sin\\theta_g  0$ as required.\n\nThe single root for $t$ at the grazing angle, $t_g$, is given by $t = -B/(2A)$:\n$$t_{g} = -\\frac{2(R+a)\\cos\\theta_{g}}{2} = -(R+a)\\cos\\theta_{g}$$\nSubstituting the expression for $\\cos\\theta_{g}$:\n$$t_{g} = -(R+a) \\left(-\\frac{\\sqrt{a(2R+a)}}{R+a}\\right) = \\sqrt{a(2R+a)}$$\n\nNow, we consider the perturbed angle $\\theta = \\theta_{g}+\\delta\\theta$, where $\\delta\\theta  0$ is small. The roots of the quadratic equation for $t$ are given by the quadratic formula:\n$$t_{\\pm} = \\frac{-B \\pm \\sqrt{B^{2}-4AC}}{2A} = -(R+a)\\cos\\theta \\pm \\sqrt{((R+a)\\cos\\theta)^{2} - a(2R+a)}$$\nThe smaller positive root is $t_{-}$:\n$$t_{-} = -(R+a)\\cos\\theta - \\sqrt{((R+a)\\cos\\theta)^{2} - a(2R+a)}$$\nWe perform an asymptotic expansion for small $\\delta\\theta$. First, we expand $\\cos\\theta$:\n$$\\cos\\theta = \\cos(\\theta_{g}+\\delta\\theta) = \\cos\\theta_{g}\\cos(\\delta\\theta)-\\sin\\theta_{g}\\sin(\\delta\\theta) \\approx \\cos\\theta_{g} - \\delta\\theta\\sin\\theta_{g}$$\nThe first term in the expression for $t_{-}$ becomes:\n$$-(R+a)\\cos\\theta \\approx -(R+a)(\\cos\\theta_{g} - \\delta\\theta\\sin\\theta_{g}) = -(R+a)\\cos\\theta_{g} + \\delta\\theta(R+a)\\sin\\theta_{g}$$\nUsing $t_{g} = -(R+a)\\cos\\theta_{g}$ and $\\sin\\theta_{g} = R/(R+a)$, this term is:\n$$t_{g} + \\delta\\theta(R+a)\\frac{R}{R+a} = t_g + R\\delta\\theta$$\nNext, we expand the term under the square root, which is the discriminant $\\Delta(\\theta)$:\n$$\\Delta(\\theta) = ((R+a)\\cos\\theta)^{2} - a(2R+a) \\approx (R+a)^{2}(\\cos\\theta_{g}-\\delta\\theta\\sin\\theta_{g})^{2} - a(2R+a)$$\n$$\\Delta(\\theta) \\approx (R+a)^{2}(\\cos^{2}\\theta_{g} - 2\\delta\\theta\\cos\\theta_{g}\\sin\\theta_{g}) - a(2R+a)$$\nWe use $(R+a)^{2}\\cos^{2}\\theta_g = a(2R+a)$.\n$$\\Delta(\\theta) \\approx a(2R+a) - 2\\delta\\theta(R+a)^{2}\\cos\\theta_{g}\\sin\\theta_{g} - a(2R+a)$$\n$$\\Delta(\\theta) \\approx -2\\delta\\theta(R+a)^{2}\\cos\\theta_{g}\\sin\\theta_{g}$$\nSubstituting the expressions for $\\cos\\theta_{g}$ and $\\sin\\theta_{g}$:\n$$\\Delta(\\theta) \\approx -2\\delta\\theta(R+a)^{2}\\left(-\\frac{\\sqrt{a(2R+a)}}{R+a}\\right)\\left(\\frac{R}{R+a}\\right) = 2R\\delta\\theta\\sqrt{a(2R+a)} = 2R t_{g} \\delta\\theta$$\nThe square root term in $t_{-}$ is $\\sqrt{\\Delta(\\theta)} \\approx \\sqrt{2Rt_{g}\\delta\\theta}$.\nCombining the terms to find $t_{-}$:\n$$t_{-} \\approx (t_{g}+R\\delta\\theta) - \\sqrt{2Rt_{g}\\delta\\theta}$$\nThe leading-order departure from $t_{g}$ is the term proportional to $\\sqrt{\\delta\\theta}$, as it is of lower order than the $\\delta\\theta$ term.\nThe departure is $t_{-} - t_{g} \\approx -\\sqrt{2Rt_{g}\\delta\\theta}$.\nFor the numerical calculation of $t_-$ itself, we use the expression $t_{-} \\approx t_{g} - \\sqrt{2Rt_{g}\\delta\\theta} + R\\delta\\theta$.\n\nWe are given $R=1.000\\,\\mathrm{m}$, $a=0.500\\,\\mathrm{m}$, and $\\delta\\theta=1.0\\times 10^{-12}\\,\\mathrm{rad}$.\nFirst, we compute the grazing distance $t_{g}$:\n$$t_{g} = \\sqrt{a(2R+a)} = \\sqrt{0.500(2(1.000)+0.500)} = \\sqrt{0.500(2.500)} = \\sqrt{1.25}\\,\\mathrm{m}$$\nNow, we compute the terms in the expansion for $t_{-}$:\nThe principal correction term is:\n$$\\sqrt{2Rt_{g}\\delta\\theta} = \\sqrt{2(1.000)\\sqrt{1.25}(1.0\\times 10^{-12})} = \\sqrt{2\\sqrt{1.25}} \\times 10^{-6}\\,\\mathrm{m}$$\n$$2\\sqrt{1.25} = 2 \\times 1.1180339887... = 2.236067977... = \\sqrt{5}$$\n$$\\sqrt{2Rt_{g}\\delta\\theta} = \\sqrt{\\sqrt{5}} \\times 10^{-6} = (5^{1/4})\\times 10^{-6} \\approx 1.495348781 \\times 10^{-6} \\,\\mathrm{m}$$\nThe higher-order correction term is:\n$$R\\delta\\theta = 1.000 \\times 1.0 \\times 10^{-12} = 1.0 \\times 10^{-12} \\,\\mathrm{m}$$\nNow, we compute $t_{-}$:\n$$t_{-} \\approx t_{g} - \\sqrt{2Rt_{g}\\delta\\theta} + R\\delta\\theta$$\n$$t_{-} \\approx \\sqrt{1.25} - 1.495348781 \\times 10^{-6} + 1.0 \\times 10^{-12}$$\n$$t_{-} \\approx 1.1180339887 - 0.000001495348781 + 0.000000000001$$\n$$t_{-} \\approx 1.118032493351$$\nRounding this result to seven significant figures, we get:\n$$t_{-} \\approx 1.118032\\,\\mathrm{m}$$\nThe term $R\\delta\\theta$ is much smaller than the leading-order correction and does not affect the result at this level of precision, but including it provides a more accurate estimate.\nThe leading-order departure $t_{-} - t_{g}$ is approximately $-1.495 \\times 10^{-6}\\,\\mathrm{m}$.\nThe requested value is $t_{-}$.\n$t_{-} \\approx 1.118032493 \\dots \\,\\mathrm{m}$.\nRounding to seven significant figures: $1.118032$.",
            "answer": "$$\\boxed{1.118032}$$"
        }
    ]
}