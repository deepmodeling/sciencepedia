{
    "hands_on_practices": [
        {
            "introduction": "任何角向求积集最基本的属性是其能够准确计算各向同性辐射场下的标通量。本练习将通过一个假设场景，展示当求积权重之和不等于 $4\\pi$ 时所产生的直接后果，从而将数学要求（即精确积分常数函数）与一个可量化的物理误差联系起来，这有助于阐明零阶矩守恒的重要性。",
            "id": "4248029",
            "problem": "在三维核反应堆模拟的中子输运中，某一点的标量通量定义为角通量在单位球面上的积分，即 $\\phi(\\mathbf{r}) = \\int_{4\\pi} \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\Omega$。在离散纵标法 (DOM) 中，该积分通过求积和 $\\phi_{Q}(\\mathbf{r}) = \\sum_{i=1}^{N} w_{i} \\, \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}_{i})$ 来近似，其中 $w_{i}$ 是非负权重，$\\boldsymbol{\\Omega}_{i}$ 是离散方向。对于常数函数的精确性，一个基本要求是该求积能够精确地积分球面上的一个常数。\n\n考虑一个候选的能级对称求积，其权重满足 $\\sum_{i=1}^{N} w_{i} = 12.50$ 球面度（即，该和不等于 $4\\pi$）。在一个固定点 $\\mathbf{r}$，假设角通量对所有角度 $\\boldsymbol{\\Omega}$ 都是常数，即 $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) = \\psi_{0}$，其中 $\\psi_{0} = 2.00 \\times 10^{5}$ 中子$\\cdot$cm$^{-2}\\cdot$s$^{-1}\\cdot$sr$^{-1}$。\n\n将偏差 $B$ 定义为求积估计的标量通量与精确标量通量之差，即 $B \\equiv \\phi_{Q} - \\phi$。仅使用上述核心定义和给定数据，计算 $B$。将最终偏差以中子$\\cdot$cm$^{-2}\\cdot$s$^{-1}$为单位表示，并将您的答案四舍五入到四位有效数字。",
            "solution": "在尝试解答之前，对问题进行验证。\n\n### 第1步：提取已知条件\n- 标量通量的定义: $\\phi(\\mathbf{r}) = \\int_{4\\pi} \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\Omega$\n- 离散纵标法 (DOM) 对标量通量的近似定义: $\\phi_{Q}(\\mathbf{r}) = \\sum_{i=1}^{N} w_{i} \\, \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}_{i})$\n- 权重的非负性: $w_{i} \\ge 0$\n- 候选求积组的权重之和: $\\sum_{i=1}^{N} w_{i} = 12.50$ sr\n- 角通量的条件: 在固定点 $\\mathbf{r}$，角通量是常数，对所有方向 $\\boldsymbol{\\Omega}$ 均为 $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) = \\psi_{0}$。\n- 恒定角通量的值: $\\psi_{0} = 2.00 \\times 10^{5}$ 中子$\\cdot$cm$^{-2}\\cdot$s$^{-1}\\cdot$sr$^{-1}$\n- 偏差的定义: $B \\equiv \\phi_{Q} - \\phi$\n- 要求计算: 计算 $B$ 的值并四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，是良定的、客观的。它基于中子输运理论和数值方法领域的标准定义。核心任务是在特定、明确定义的条件下，量化一种数值近似（一种求积法则）的误差，即偏差。问题中提到的“精确性的基本要求”强调了，要使一个求积对于常数函数是正确的，其权重之和必须等于积分区域的面积，对于单位球面来说即为 $4\\pi$。该问题提供了一个不满足此条件的候选求积（$\\sum w_i = 12.50 \\neq 4\\pi$），并要求计算对于一个常数被积函数，这个缺陷导致的具体误差。这是分析数值方法精度的有效且标准的程序。所有必要的信息都已提供，问题没有矛盾或歧义。\n\n### 第3步：结论与行动\n问题有效。将提供解答。\n\n### 解题推导\n偏差 $B$ 定义为求积估计的标量通量 $\\phi_{Q}$ 与精确标量通量 $\\phi$ 之差。我们分别计算每一项。\n\n首先，我们计算精确标量通量 $\\phi$。根据定义，它是角通量 $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega})$ 在单位球面的整个立体角上的积分。\n$$\n\\phi = \\int_{4\\pi} \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\Omega\n$$\n问题指出角通量对所有角度是常数，$\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) = \\psi_{0}$。由于 $\\psi_{0}$ 不依赖于积分变量 $\\boldsymbol{\\Omega}$，可以将其移到积分符号之外。\n$$\n\\phi = \\psi_{0} \\int_{4\\pi} \\mathrm{d}\\Omega\n$$\n积分 $\\int_{4\\pi} \\mathrm{d}\\Omega$ 代表球体的总立体角，等于 $4\\pi$ 球面度。\n$$\n\\phi = 4\\pi\\psi_{0}\n$$\n\n接下来，我们使用离散纵标法的求积和计算近似标量通量 $\\phi_{Q}$。\n$$\n\\phi_{Q} = \\sum_{i=1}^{N} w_{i} \\, \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}_{i})\n$$\n因为角通量是常数，所以对所有离散方向 $\\boldsymbol{\\Omega}_{i}$ 都有 $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}_{i}) = \\psi_{0}$。\n$$\n\\phi_{Q} = \\sum_{i=1}^{N} w_{i} \\, \\psi_{0}\n$$\n常数项 $\\psi_{0}$ 可以从求和中提出来。\n$$\n\\phi_{Q} = \\psi_{0} \\sum_{i=1}^{N} w_{i}\n$$\n问题指明这个特定求积组的权重之和为 $\\sum_{i=1}^{N} w_{i} = 12.50$ sr。\n$$\n\\phi_{Q} = \\psi_{0} \\times 12.50\n$$\n\n现在，我们可以使用其定义来计算偏差 $B$。\n$$\nB = \\phi_{Q} - \\phi\n$$\n代入 $\\phi_{Q}$ 和 $\\phi$ 的表达式：\n$$\nB = ( \\psi_{0} \\times 12.50 ) - (4\\pi\\psi_{0})\n$$\n我们可以提出常数角通量 $\\psi_{0}$。\n$$\nB = \\psi_{0} (12.50 - 4\\pi)\n$$\n给定值为 $\\psi_{0} = 2.00 \\times 10^{5}$ 中子$\\cdot$cm$^{-2}\\cdot$s$^{-1}\\cdot$sr$^{-1}$。项 $(12.50 - 4\\pi)$ 的单位将是球面度 (sr)，因此得到的偏差 $B$ 的单位将是中子$\\cdot$cm$^{-2}\\cdot$s$^{-1}$，符合要求。\n使用 $\\pi \\approx 3.14159265...$ 的值，我们计算出 $4\\pi \\approx 12.56637061...$\n$$\nB = (2.00 \\times 10^{5}) \\times (12.50 - 12.56637061...)\n$$\n$$\nB = (2.00 \\times 10^{5}) \\times (-0.06637061...)\n$$\n$$\nB \\approx -13274.1228\n$$\n问题要求将最终答案四舍五入到四位有效数字。\n$$\nB \\approx -13270\n$$\n用标准科学记数法表示为：\n$$\nB = -1.327 \\times 10^{4}\n$$\n偏差的单位是中子$\\cdot$cm$^{-2}\\cdot$s$^{-1}$。",
            "answer": "$$\n\\boxed{-1.327 \\times 10^{4}}\n$$"
        },
        {
            "introduction": "在掌握了基本原则之后，我们将转向实际的构建过程。实用的求积集还必须能精确处理各向异性的辐射场，这要求它们匹配输运方程的更高阶矩。本练习将引导你完成一个广泛使用的水平对称（Level-Symmetric, $LS$）求积集参数的解析推导，让你深入体验矩匹配法的核心技术。",
            "id": "4248055",
            "problem": "在三维稳态中子输运中，角通量密度遵循一阶线性玻尔兹曼输运方程，并且需要对单位球面进行角度积分，以形成用于类扩散封闭关系式的矩并计算反应率。为了近似这些角度积分，离散纵标法选择一组有限的方向及其相关权重，这些方向和权重可以精确地积分低阶球矩。一种在球面上广泛使用的角度求积方法是能级对称族，其中在每个卦限中，节点排列在多个能级上，这些能级在坐标轴的排列下是对称的。\n\n考虑为所谓的 $LS_4$ 求积组构建一个在第一卦限中具有两个极向能级的能级对称集。在第一卦限中，对于每个能级 $l \\in \\{1,2\\}$，定义三个方向作为三元组 $(u_l, v_l, v_l)$ 的排列，其中 $u_l \\in (0,1)$ 和 $v_l \\in (0,1)$ 是方向余弦，使得方向矢量具有单位长度。第一卦限中能级 $l$ 的三个方向共享一个共同的权重 $w_l$（单位为球面度），而完整的 $4\\pi$ 集合则是通过坐标平面对称地将这些方向反射到所有八个卦限中形成的。单位矢量方向余弦的基本几何约束是\n$$\nu_l^{2} + v_l^{2} + v_l^{2} \\;=\\; 1,\n$$\n因此\n$$\nv_l^{2} \\;=\\; \\frac{1 - u_l^{2}}{2}.\n$$\n令 $x_l \\equiv u_l^{2}$，其中 $l=1,2$。\n\n为确保低阶球矩的精确性，要求该求积能精确积分单位球面上的以下函数：\n- 常数函数, $\\int_{4\\pi} 1 \\,\\mathrm{d}\\Omega = 4\\pi$。\n- 四阶矩 $\\int_{4\\pi} \\mu^{4} \\,\\mathrm{d}\\Omega = \\frac{4\\pi}{5}$。\n- 混合四阶矩 $\\int_{4\\pi} \\mu^{2} \\eta^{2} \\,\\mathrm{d}\\Omega = \\frac{4\\pi}{15}$。\n\n在这里，$\\mu$、$\\eta$ 和 $\\xi$ 表示单位矢量相对于 $x$、$y$ 和 $z$ 轴的方向余弦。由于每个能级内的排列对称性和跨卦限的反射对称性，这些矩在所有方向上的求积和可以简化为 $u_l$ 和 $v_l$ 与权重 $w_l$ 的组合。\n\n仅使用常数矩和 $\\mu^{4}$ 矩条件以及上述几何单位矢量约束，推导并简化一个关于第一卦限中能级 $l=1$ 的每个方向权重 $w_1$ 的闭式解析表达式，该表达式是 $x_1$ 和 $x_2$ 的函数。请用球面度表示最终答案。不需要数值近似或四舍五入；请提供精确的符号表达式。",
            "solution": "该问题要求推导求积权重 $w_1$ 作为方向余弦平方参数 $x_1$ 和 $x_2$ 的函数的闭式解析表达式。推导过程必须使用常数函数和四阶矩 $\\mu^4$ 的积分矩条件。\n\n角度求积通过对一组离散方向 $\\Omega_m = (\\mu_m, \\eta_m, \\xi_m)$ 及其相应权重 $w_m$ 进行加权求和来近似单位球面上的积分 $\\int_{4\\pi} f(\\Omega) \\,\\mathrm{d}\\Omega$：\n$$\n\\int_{4\\pi} f(\\Omega) \\,\\mathrm{d}\\Omega \\approx \\sum_m w_m f(\\Omega_m)\n$$\n问题定义了一个在第一卦限中有两个能级 $l \\in \\{1,2\\}$ 的能级对称求积组。\n对于能级 $l$，方向是三元组 $(u_l, v_l, v_l)$ 的 3 个排列。第一卦限中的这三个方向，以及它们在其他七个卦限中的对称反射，都共享相同的权重，我们记为 $w_l$。\n单位方向矢量的几何约束是 $u_l^2 + 2v_l^2 = 1$。根据定义 $x_l \\equiv u_l^2$，可得 $v_l^2 = \\frac{1-x_l}{2}$。由于 $u_l, v_l \\in (0,1)$，这意味着 $x_l \\in (0,1)$。\n\n完整的求积组是通过对称性形成的。第一卦限中的方向是 $(u_l, v_l, v_l)$, $(v_l, u_l, v_l)$ 和 $(v_l, v_l, u_l)$，其中 $l=1,2$。由于 $u_l, v_l > 0$，这些方向不在任何坐标平面上。假设 $u_l \\neq v_l$，对于每个能级 $l$，在第一卦限中有 3 个不同的方向。能级 $l$ 的完整方向集是通过排列和符号变化生成的，从而产生 $8 \\times 3 = 24$ 个不同的方向。因此，总的求积组由 24 个权重为 $w_1$ 的 $l=1$ 型方向和 24 个权重为 $w_2$ 的 $l=2$ 型方向组成。\n\n我们现在强制执行所给的两个矩条件。\n\n1.  **常数矩条件：** 求积必须能精确积分常数函数 $f(\\Omega) = 1$。\n    精确积分为 $\\int_{4\\pi} 1 \\,\\mathrm{d}\\Omega = 4\\pi$。\n    求积和是所有权重的总和。对于 24 个权重为 $w_1$ 的方向和 24 个权重为 $w_2$ 的方向，该和为：\n    $$\n    \\sum_m w_m = 24w_1 + 24w_2\n    $$\n    将求积和与精确积分相等可得：\n    $$\n    24w_1 + 24w_2 = 4\\pi\n    $$\n    两边除以 24，我们得到第一个方程：\n    $$\n    w_1 + w_2 = \\frac{\\pi}{6} \\quad \\text{(方程 1)}\n    $$\n\n2.  **四阶矩 ($\\mu^4$) 条件：** 求积必须能精确积分 $f(\\Omega) = \\mu^4$。\n    精确积分为 $\\int_{4\\pi} \\mu^4 \\,\\mathrm{d}\\Omega = \\frac{4\\pi}{5}$。\n    求积和为 $\\sum_m w_m \\mu_m^4$。我们可以按能级对各项进行分组。\n    对于能级 $l$，计算其 24 个方向上的 $\\mu_m^4$ 之和。这些方向是 $(\\pm u_l, \\pm v_l, \\pm v_l)$ 的排列。\n    -   形式为 $(\\pm u_l, \\cdot, \\cdot)$ 的 8 个方向的 $\\mu = \\pm u_l$。它们对 $\\mu^4$ 之和的贡献是 $8 \\times u_l^4$。\n    -   形式为 $(\\pm v_l, \\cdot, \\cdot)$ 且 $u_l$ 在第二个位置的 8 个方向的 $\\mu = \\pm v_l$。它们的贡献是 $8 \\times v_l^4$。\n    -   形式为 $(\\pm v_l, \\cdot, \\cdot)$ 且 $u_l$ 在第三个位置的 8 个方向的 $\\mu = \\pm v_l$。它们的贡献是 $8 \\times v_l^4$。\n    能级 $l$ 的所有 24 个方向上 $\\mu_m^4$ 的总和是 $8(u_l^4 + 2v_l^4)$。\n    总求积和为：\n    $$\n    \\sum_m w_m \\mu_m^4 = w_1 \\left[ 8(u_1^4 + 2v_1^4) \\right] + w_2 \\left[ 8(u_2^4 + 2v_2^4) \\right]\n    $$\n    将其与精确积分相等：\n    $$\n    8w_1(u_1^4 + 2v_1^4) + 8w_2(u_2^4 + 2v_2^4) = \\frac{4\\pi}{5}\n    $$\n    我们定义一个中间量 $S_l = u_l^4 + 2v_l^4$。使用 $x_l = u_l^2$ 和 $v_l^2 = \\frac{1-x_l}{2}$，我们有 $u_l^4 = x_l^2$ 和 $v_l^4 = \\left(\\frac{1-x_l}{2}\\right)^2 = \\frac{1-2x_l+x_l^2}{4}$。\n    $$\n    S_l = x_l^2 + 2\\left(\\frac{1-2x_l+x_l^2}{4}\\right) = x_l^2 + \\frac{1-2x_l+x_l^2}{2} = \\frac{2x_l^2 + 1-2x_l+x_l^2}{2} = \\frac{3x_l^2 - 2x_l + 1}{2}\n    $$\n    将 $S_l$ 代入矩方程并除以 8：\n    $$\n    w_1 S_1 + w_2 S_2 = \\frac{\\pi}{10} \\quad \\text{(方程 2)}\n    $$\n\n现在我们得到了一个关于 $w_1$ 和 $w_2$ 的二元线性方程组：\n1.  $w_1 + w_2 = \\frac{\\pi}{6}$\n2.  $w_1 S_1 + w_2 S_2 = \\frac{\\pi}{10}$\n\n我们求解 $w_1$。从方程 1，可得 $w_2 = \\frac{\\pi}{6} - w_1$。将其代入方程 2：\n$$\nw_1 S_1 + \\left(\\frac{\\pi}{6} - w_1\\right) S_2 = \\frac{\\pi}{10}\n$$\n$$\nw_1 S_1 + \\frac{\\pi}{6} S_2 - w_1 S_2 = \\frac{\\pi}{10}\n$$\n$$\nw_1 (S_1 - S_2) = \\frac{\\pi}{10} - \\frac{\\pi}{6} S_2\n$$\n$$\nw_1 (S_1 - S_2) = \\pi \\left(\\frac{1}{10} - \\frac{S_2}{6}\\right) = \\pi \\frac{3 - 5S_2}{30}\n$$\n$$\nw_1 = \\frac{\\pi}{30} \\frac{3 - 5S_2}{S_1 - S_2}\n$$\n为了得到以 $x_1$ 和 $x_2$ 表示的最终表达式，我们代入 $S_1$ 和 $S_2$ 的表达式。\n分子是：\n$$\n3 - 5S_2 = 3 - 5\\left(\\frac{3x_2^2 - 2x_2 + 1}{2}\\right) = \\frac{6 - 5(3x_2^2 - 2x_2 + 1)}{2} = \\frac{6 - 15x_2^2 + 10x_2 - 5}{2} = \\frac{-15x_2^2 + 10x_2 + 1}{2}\n$$\n分母是：\n$$\nS_1 - S_2 = \\frac{3x_1^2 - 2x_1 + 1}{2} - \\frac{3x_2^2 - 2x_2 + 1}{2} = \\frac{1}{2} \\left( 3(x_1^2 - x_2^2) - 2(x_1 - x_2) \\right)\n$$\n$$\nS_1 - S_2 = \\frac{1}{2} (x_1 - x_2) \\left( 3(x_1 + x_2) - 2 \\right)\n$$\n最后，将这些代入 $w_1$ 的表达式中：\n$$\nw_1 = \\frac{\\pi}{30} \\frac{\\frac{-15x_2^2 + 10x_2 + 1}{2}}{\\frac{1}{2} (x_1 - x_2) (3(x_1 + x_2) - 2)}\n$$\n$\\frac{1}{2}$ 因子消去，得到 $w_1$ 的简化闭式表达式：\n$$\nw_1 = \\frac{\\pi}{30} \\frac{-15x_2^2 + 10x_2 + 1}{(x_1 - x_2)(3x_1 + 3x_2 - 2)}\n$$\n该表达式给出了能级 $l=1$ 时任意方向的权重，作为 $x_1$ 和 $x_2$ 的函数。",
            "answer": "$$\n\\boxed{\\frac{\\pi}{30} \\frac{-15x_2^2 + 10x_2 + 1}{(x_1 - x_2)(3x_1 + 3x_2 - 2)}}\n$$"
        },
        {
            "introduction": "学习了如何构建求积集后，评估其在实际场景中的性能至关重要。本计算练习通过一个专门设计的、能够暴露诸如方位角混叠等常见问题的角通量函数，比较了一个低阶方位角乘积求积集与一个高阶乘积求积集的性能，并展示了前者如何产生与水平对称求积集类似的混叠误差。这个练习将为你提供宝贵的实践经验，让你了解不同的求积方案如何处理复杂的各向异性，以及如何量化它们的精度。",
            "id": "4248099",
            "problem": "考虑不依赖能量的稳态中子输运，其中角通量表示为 $\\psi(\\boldsymbol{\\Omega})$，$\\boldsymbol{\\Omega}$ 是球面上的单位方向。标量通量 $\\phi$ 由立体角积分定义为 $\\phi = \\int_{4\\pi} \\psi(\\boldsymbol{\\Omega}) \\, \\mathrm{d}\\boldsymbol{\\Omega}$。在离散纵标 ($S_N$) 方法中，角积分通过在一组离散方向和相关权重（角求积组）上的有限和来近似。这里我们考虑两种乘积型求积组，它们的极向部分相同，但方位角部分不同。\n\n您的任务是，对于 $L_s = 3$ 的情况，在使用两种不同求积时，计算由于角通量中的各向异性导致的标量通量近似的绝对误差。为此，您将使用以下模型角通量，该通量以球坐标表示，其中 $\\mu = \\cos\\theta \\in [-1,1]$ 且 $\\varphi \\in [0,2\\pi)$（以弧度为单位）：\n$$\n\\psi(\\mu,\\varphi) = a_0 \\;+\\; a_1 \\, \\mu \\;+\\; a_2 \\, P_2(\\mu) \\;+\\; b \\, \\mu^{p} \\cos(m \\varphi) \\;+\\; c \\, \\mu^{6},\n$$\n其中 $P_2(\\mu) = \\frac{1}{2}(3\\mu^2 - 1)$ 是二阶勒让德多项式。标量通量定义为\n$$\n\\phi = \\int_{0}^{2\\pi} \\int_{-1}^{1} \\psi(\\mu,\\varphi) \\, \\mathrm{d}\\mu \\, \\mathrm{d}\\varphi.\n$$\n\n精确标量通量 $\\phi_{\\text{exact}}$ 必须从第一性原理出发，利用三角函数和勒让德多项式的正交性获得：\n- 对于任何整数 $m \\neq 0$，$\\int_{0}^{2\\pi} \\cos(m\\varphi) \\, \\mathrm{d}\\varphi = 0$\n- $\\int_{-1}^{1} \\mu \\, \\mathrm{d}\\mu = 0$\n- 对于任何整数 $\\ell \\ge 1$，$\\int_{-1}^{1} P_{\\ell}(\\mu) \\, \\mathrm{d}\\mu = 0$\n- $\\int_{-1}^{1} \\mu^{6} \\, \\mathrm{d}\\mu = \\frac{2}{7}$\n\n因此，精确标量通量为\n$$\n\\phi_{\\text{exact}} = 4\\pi a_0 + \\frac{4\\pi}{7} c.\n$$\n\n对于 $L_s = 3$ 的情况，构建两种求积近似：\n1. **标记为 LS$_N$ 的求积**：为模拟特定混叠效应，我们使用一个乘积求积，并标记为 'LS'。它在 $\\mu \\in [-1,1]$ 上使用3阶高斯-勒让德节点和权重，并对方位角使用具有 $M_{\\text{LS}} = 8$ 个点的梯形法则，$\\varphi_j = \\frac{2\\pi j}{M_{\\text{LS}}}$，以及均匀权重 $\\Delta\\varphi_{\\text{LS}} = \\frac{2\\pi}{M_{\\text{LS}}}$。\n2. **乘积求积**：在 $\\mu \\in [-1,1]$ 上使用相同的3阶高斯-勒让德节点和权重，并对方位角使用具有 $M_{\\text{P}} = 24$ 个点的梯形法则，$\\varphi_j = \\frac{2\\pi j}{M_{\\text{P}}}$，以及均匀权重 $\\Delta\\varphi_{\\text{P}} = \\frac{2\\pi}{M_{\\text{P}}}$。\n\n对于任一种求积，标量通量的近似值为\n$$\n\\phi_{\\text{quad}} = \\sum_{i=1}^{N_\\mu} w_i \\sum_{j=0}^{M-1} \\psi(\\mu_i, \\varphi_j) \\, \\Delta\\varphi,\n$$\n其中 $(\\mu_i, w_i)$ 是在 $[-1,1]$ 上的3阶高斯-勒让德节点和权重，$M$ 是所选求积的方位角点数，$\\Delta\\varphi = \\frac{2\\pi}{M}$ 是均匀方位角权重。绝对误差为\n$$\n\\varepsilon = \\left| \\phi_{\\text{quad}} - \\phi_{\\text{exact}} \\right|.\n$$\n\n您必须实现一个程序，为每个测试用例计算与标记为 LS$_N$ 和乘积的求积相对应的误差对 $(\\varepsilon_{\\text{LS}}, \\varepsilon_{\\text{P}})$。\n\n请使用以下测试套件，其中角度以弧度为单位，所有量均为无量纲量：\n- 测试用例 A（具有方位谐波的一般各向异性，该谐波会对 $M_{\\text{LS}}=8$ 的求积产生混叠，但不会对 $M_{\\text{P}}=24$ 的求积产生混叠）：$\\{a_0 = 1.0,\\; a_1 = 0.1,\\; a_2 = 0.05,\\; b = 0.4,\\; p = 2,\\; m = 8,\\; c = 0.0\\}$。\n- 测试用例 B（挑战 $L_s=3$ 极向精度的纯极向高阶各向异性）：$\\{a_0 = 1.0,\\; a_1 = 0.0,\\; a_2 = 0.0,\\; b = 0.0,\\; p = 2,\\; m = 8,\\; c = 1.0\\}$。\n- 测试用例 C（两种求积均会产生方位混叠的最差情况）：$\\{a_0 = 1.0,\\; a_1 = 0.1,\\; a_2 = 0.05,\\; b = 0.3,\\; p = 2,\\; m = 24,\\; c = 0.0\\}$。\n- 测试用例 D（具有非常弱各向异性的近各向同性边界条件）：$\\{a_0 = 1.0,\\; a_1 = 0.0,\\; a_2 = 0.0,\\; b = 10^{-6},\\; p = 2,\\; m = 8,\\; c = 0.0\\}$。\n\n您的程序必须：\n- 使用弧度制角度。\n- 对每个测试用例，计算如上定义的 $(\\varepsilon_{\\text{LS}}, \\varepsilon_{\\text{P}})$。\n- 生成单行输出，包含一个由四个元素组成的逗号分隔列表，每个元素都是一个包含两个条目 $[\\varepsilon_{\\text{LS}}, \\varepsilon_{\\text{P}}]$ 的十进制形式列表。例如：“[[eA_LS,eA_P],[eB_LS,eB_P],[eC_LS,eC_P],[eD_LS,eD_P]]”。",
            "solution": "该问题是有效的，因为它具有科学依据、适定、客观且内部一致。它是在中子输运理论领域应用数值分析的一个标准练习。\n\n目标是计算两种角求积方案在近似标量通量 $\\phi$ 时的绝对误差。角通量由以下模型函数给出：\n$$\n\\psi(\\mu,\\varphi) = a_0 \\;+\\; a_1 \\, \\mu \\;+\\; a_2 \\, P_2(\\mu) \\;+\\; b \\, \\mu^{p} \\cos(m \\varphi) \\;+\\; c \\, \\mu^{6}\n$$\n其中 $P_2(\\mu) = \\frac{1}{2}(3\\mu^2 - 1)$。精确标量通量 $\\phi_{\\text{exact}}$ 通过在单位球面上对 $\\psi(\\mu,\\varphi)$ 进行解析积分得到：\n$$\n\\phi_{\\text{exact}} = \\int_{0}^{2\\pi} \\int_{-1}^{1} \\psi(\\mu,\\varphi) \\, \\mathrm{d}\\mu \\, \\mathrm{d}\\varphi\n$$\n利用所提供的积分恒等式，即勒让德多项式（对于 $\\ell \\ge 1$，$\\int_{-1}^{1} P_{\\ell}(\\mu) \\, \\mathrm{d}\\mu = 0$）和三角函数（对于整数 $m \\neq 0$，$\\int_{0}^{2\\pi} \\cos(m\\varphi) \\, \\mathrm{d}\\varphi = 0$）的正交性，精确通量简化为：\n$$\n\\phi_{\\text{exact}} = \\int_{0}^{2\\pi} \\int_{-1}^{1} (a_0 + c \\, \\mu^6) \\, \\mathrm{d}\\mu \\, \\mathrm{d}\\varphi = 2\\pi \\left[ a_0\\mu + c \\frac{\\mu^7}{7} \\right]_{-1}^{1} = 2\\pi \\left( 2a_0 + \\frac{2c}{7} \\right) = 4\\pi a_0 + \\frac{4\\pi}{7}c\n$$\n这与问题描述中给出的公式相符。\n\n标量通量通过求积和进行数值近似：\n$$\n\\phi_{\\text{quad}} = \\sum_{i=1}^{N_\\mu} w_i \\sum_{j=0}^{M-1} \\psi(\\mu_i, \\varphi_j) \\, \\Delta\\varphi\n$$\n近似误差 $\\varepsilon = \\left| \\phi_{\\text{quad}} - \\phi_{\\text{exact}} \\right|$ 源于有限求积组无法精确积分角通量函数的每一项。我们分析每一项对误差的贡献。\n\n两种求积方案都对极向变量 $\\mu \\in [-1,1]$ 使用3点高斯-勒让德法则。这样的法则，有 $N_\\mu=3$ 个点，可以精确积分次数最高为 $2N_\\mu - 1 = 5$ 的 $\\mu$ 多项式。方位角积分通过一个具有均匀权重 $\\Delta\\varphi = \\frac{2\\pi}{M}$ 的M点梯形法则来近似，该法则对三角多项式的精确度取决于 $M$ 的值。\n\n1.  **项 $a_0$、$a_1\\mu$ 和 $a_2P_2(\\mu)$**：\n    函数 $1$、$\\mu$ 和 $P_2(\\mu)$ 分别是关于 $\\mu$ 的0次、1次和2次多项式。由于所有次数都小于或等于5，高斯-勒让德求积可以精确地对它们在 $\\mu$ 上进行积分。方位角依赖性是常数，梯形法则也能精确积分。因此，对于两种方案，这些项在 $\\phi_{\\text{quad}}$ 中不引入误差。\n    $$\n    \\int_{0}^{2\\pi} \\int_{-1}^{1} (a_0 + a_1\\mu + a_2P_2(\\mu)) \\, \\mathrm{d}\\mu \\, \\mathrm{d}\\varphi = 4\\pi a_0\n    $$\n    $$\n    \\sum_{i=1}^{3} w_i \\sum_{j=0}^{M-1} (a_0 + a_1\\mu_i + a_2P_2(\\mu_i)) \\frac{2\\pi}{M} = M \\frac{2\\pi}{M} \\sum_{i=1}^{3} w_i (a_0 + a_1\\mu_i + a_2P_2(\\mu_i)) = 2\\pi (2a_0 + 0 + 0) = 4\\pi a_0\n    $$\n\n2.  **项 $c\\mu^6$**：\n    该项在 $\\mu$ 中的多项式次数为6，大于5。3点高斯-勒让德法则无法精确积分它。由于该项不依赖于 $\\varphi$，误差与方位角求积无关。\n    精确积分为 $\\frac{4\\pi}{7}c$。求积近似值为 $2\\pi c \\sum_{i=1}^3 w_i \\mu_i^6$。对于 $N_\\mu=3$ 的高斯-勒让德节点 $(\\mu_i)$ 和权重 $(w_i)$ 分别是 $\\mu_i \\in \\{-\\sqrt{3/5}, 0, \\sqrt{3/5}\\}$ 和 $w_i \\in \\{5/9, 8/9, 5/9\\}$。\n    和为 $\\sum w_i \\mu_i^6 = \\frac{5}{9}(-\\sqrt{3/5})^6 + \\frac{8}{9}(0)^6 + \\frac{5}{9}(\\sqrt{3/5})^6 = 2 \\cdot \\frac{5}{9} \\cdot (\\frac{3}{5})^3 = \\frac{10}{9} \\cdot \\frac{27}{125} = \\frac{6}{25}$。\n    求积值为 $2\\pi c (\\frac{6}{25}) = \\frac{12\\pi c}{25}$。\n    该项产生的误差为 $\\left| \\frac{12\\pi c}{25} - \\frac{4\\pi c}{7} \\right| = \\left| 4\\pi c \\left( \\frac{3}{25} - \\frac{1}{7} \\right) \\right| = \\left| 4\\pi c \\frac{21-25}{175} \\right| = \\frac{16\\pi |c|}{175}$。此误差分量对于LS型求积和乘积求积是相同的。\n\n3.  **项 $b\\mu^p\\cos(m\\varphi)$**：\n    对于所有测试用例，极向指数为 $p=2$。函数 $\\mu^2$ 是一个2次多项式，可以被3点GL法则精确积分。误差（如果有的话）必定来自方位角积分。\n    精确积分为 $\\int_{-1}^1 b\\mu^2 d\\mu \\int_0^{2\\pi} \\cos(m\\varphi) d\\varphi = \\frac{2b}{3} \\cdot 0 = 0$（因为 $m \\ge 8$）。\n    求积近似值为 $b (\\sum_i w_i \\mu_i^2) (\\sum_j \\cos(m\\varphi_j) \\Delta\\varphi)$。极向和是精确的：$\\sum_i w_i \\mu_i^2 = \\int_{-1}^1 \\mu^2 d\\mu = 2/3$。\n    方位和 $\\sum_{j=0}^{M-1} \\cos(m \\varphi_j) = \\sum_{j=0}^{M-1} \\cos(m j \\frac{2\\pi}{M})$ 会发生混叠。如果 $m$ 是 $M$ 的非零整数倍，则该和等于 $M$，否则为 $0$。\n    如果和为 $M$，该项的求积值为 $b (\\frac{2}{3}) (M \\cdot \\frac{2\\pi}{M}) = \\frac{4\\pi b}{3}$。如果和为 $0$，则值为 $0$。\n    因此，如果 $m$ 是 $M$ 的倍数，该项产生的误差为 $\\frac{4\\pi |b|}{3}$，否则为 $0$。\n\n综合这些对每个测试用例的分析：\n\n-   **测试用例 A**：$\\{a_0 = 1, b = 0.4, m = 8, c = 0\\}$。\n    唯一的误差来源是方位项。\n    -   LS$_N$ 型 ($M_{\\text{LS}}=8$)：$m/M_{\\text{LS}} = 8/8 = 1$，是整数。$\\varepsilon_{\\text{LS}} = \\frac{4\\pi(0.4)}{3} = \\frac{1.6\\pi}{3}$。\n    -   乘积 ($M_{\\text{P}}=24$)：$m/M_{\\text{P}} = 8/24 = 1/3$，不是整数。$\\varepsilon_{\\text{P}} = 0$。\n\n-   **测试用例 B**：$\\{a_0 = 1, b = 0, c = 1.0\\}$。\n    唯一的误差来源是对 $c\\mu^6$ 项的极向积分。\n    -   $\\varepsilon_{\\text{LS}} = \\varepsilon_{\\text{P}} = \\frac{16\\pi(1.0)}{175} = \\frac{16\\pi}{175}$。\n\n-   **测试用例 C**：$\\{a_0 = 1, b = 0.3, m = 24, c = 0\\}$。\n    唯一的误差来源是方位项。\n    -   LS$_N$ 型 ($M_{\\text{LS}}=8$)：$m/M_{\\text{LS}} = 24/8 = 3$，是整数。$\\varepsilon_{\\text{LS}} = \\frac{4\\pi(0.3)}{3} = 0.4\\pi$。\n    -   乘积 ($M_{\\text{P}}=24$)：$m/M_{\\text{P}} = 24/24 = 1$，是整数。$\\varepsilon_{\\text{P}} = \\frac{4\\pi(0.3)}{3} = 0.4\\pi$。\n\n-   **测试用例 D**：$\\{a_0 = 1, b = 10^{-6}, m = 8, c = 0\\}$。\n    此情况与A类似，但 $b$ 的值很小。\n    -   LS$_N$ 型 ($M_{\\text{LS}}=8$)：$m/M_{\\text{LS}} = 8/8 = 1$，是整数。$\\varepsilon_{\\text{LS}} = \\frac{4\\pi(10^{-6})}{3}$。\n    -   乘积 ($M_{\\text{P}}=24$)：$m/M_{\\text{P}} = 8/24 = 1/3$，不是整数。$\\varepsilon_{\\text{P}} = 0$。\n\n以下程序实现了问题中指定的完整数值求和，以数值方式计算这些误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Computes absolute errors in scalar flux for different quadrature sets.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case A\n        {'a0': 1.0, 'a1': 0.1, 'a2': 0.05, 'b': 0.4, 'p': 2, 'm': 8, 'c': 0.0},\n        # Test case B\n        {'a0': 1.0, 'a1': 0.0, 'a2': 0.0, 'b': 0.0, 'p': 2, 'm': 8, 'c': 1.0},\n        # Test case C\n        {'a0': 1.0, 'a1': 0.1, 'a2': 0.05, 'b': 0.3, 'p': 2, 'm': 24, 'c': 0.0},\n        # Test case D\n        {'a0': 1.0, 'a1': 0.0, 'a2': 0.0, 'b': 1e-6, 'p': 2, 'm': 8, 'c': 0.0}\n    ]\n\n    # Get Gauss-Legendre nodes and weights for N=3\n    # These are for the interval [-1, 1]\n    mu_nodes, mu_weights = roots_legendre(3)\n\n    results = []\n    \n    for case in test_cases:\n        a0, a1, a2, b, p, m, c = case['a0'], case['a1'], case['a2'], case['b'], case['p'], case['m'], case['c']\n\n        # Define the angular flux function psi(mu, phi)\n        def P2(mu):\n            return 0.5 * (3 * mu**2 - 1)\n\n        def psi(mu, phi):\n            return a0 + a1 * mu + a2 * P2(mu) + b * (mu**p) * np.cos(m * phi) + c * (mu**6)\n\n        # Calculate the exact scalar flux\n        phi_exact = 4 * np.pi * a0 + (4 * np.pi / 7) * c\n\n        errors = []\n        quad_configs = [\n            {'name': 'LS', 'M': 8},\n            {'name': 'Product', 'M': 24}\n        ]\n\n        for config in quad_configs:\n            M = config['M']\n            delta_phi = 2 * np.pi / M\n            \n            # Azimuthal points (trapezoidal rule)\n            phi_points = np.linspace(0, 2 * np.pi, M, endpoint=False)\n\n            phi_quad = 0.0\n            # Sum over polar nodes\n            for i in range(len(mu_nodes)):\n                mu_i = mu_nodes[i]\n                w_i = mu_weights[i]\n                \n                # Sum over azimuthal angles\n                azimuthal_sum = 0.0\n                for j in range(M):\n                    phi_j = phi_points[j]\n                    azimuthal_sum += psi(mu_i, phi_j)\n                \n                phi_quad += w_i * azimuthal_sum * delta_phi\n            \n            # Compute absolute error\n            error = abs(phi_quad - phi_exact)\n            errors.append(error)\n\n        results.append(errors)\n\n    # Format the final output string as specified in the problem\n    # e.g., \"[[eA_LS,eA_P],[eB_LS,eB_P],[eC_LS,eC_P],[eD_LS,eD_P]]\"\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}