{
    "hands_on_practices": [
        {
            "introduction": "任何求积组最基本的要求是能够精确积分常数函数。在辐射输运理论中，这对应于从各向同性角通量中正确计算标量通量的能力。这个练习  提供了一个直接的计算，用以量化当这个基本规则被违反时所产生的误差（偏差），从而将求积权重之和与一个具有物理意义的量直接联系起来。",
            "id": "4248029",
            "problem": "在用于核反应堆模拟的三维中子输运中，某一点的标量通量定义为角通量在单位球面上的积分，即 $\\phi(\\mathbf{r}) = \\int_{4\\pi} \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\Omega$。在离散纵标法 (DOM) 中，此积分通过求积和 $\\phi_{Q}(\\mathbf{r}) = \\sum_{i=1}^{N} w_{i} \\, \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}_{i})$ 来近似，其中 $w_{i}$ 是非负权重，$\\boldsymbol{\\Omega}_{i}$ 是离散方向。对于常数函数而言，求积能够精确的一个基本要求是该求积能精确地对一个常数在球面上积分。\n\n考虑一个候选的水平对称求积，其权重满足 $\\sum_{i=1}^{N} w_{i} = 12.50$ 球面度（即，其和不等于 $4\\pi$）。假设在固定点 $\\mathbf{r}$，角通量对所有角度 $\\boldsymbol{\\Omega}$ 都是常数，$\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) = \\psi_{0}$，且 $\\psi_{0} = 2.00 \\times 10^{5}$ 中子$\\cdot$厘米$^{-2}\\cdot$秒$^{-1}\\cdot$球面度$^{-1}$。\n\n将偏差 $B$ 定义为求积估计的标量通量与精确标量通量之差，$B \\equiv \\phi_{Q} - \\phi$。仅使用上述核心定义和给定数据，计算 $B$。以 中子$\\cdot$厘米$^{-2}\\cdot$秒$^{-1}$ 为单位表示最终偏差，并将答案四舍五入到四位有效数字。",
            "solution": "在尝试解答之前，对问题进行验证。\n\n### 第 1 步：提取已知条件\n- 标量通量的定义：$\\phi(\\mathbf{r}) = \\int_{4\\pi} \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\Omega$\n- 离散纵标法 (DOM) 对标量通量的近似定义：$\\phi_{Q}(\\mathbf{r}) = \\sum_{i=1}^{N} w_{i} \\, \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}_{i})$\n- 权重的非负性：$w_{i} \\ge 0$\n- 候选求积组的权重之和：$\\sum_{i=1}^{N} w_{i} = 12.50$ sr\n- 角通量的条件：在固定点 $\\mathbf{r}$，角通量是常数，$\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) = \\psi_{0}$ 对所有方向 $\\boldsymbol{\\Omega}$ 成立。\n- 恒定角通量的值：$\\psi_{0} = 2.00 \\times 10^{5}$ 中子$\\cdot$厘米$^{-2}\\cdot$秒$^{-1}\\cdot$球面度$^{-1}$\n- 偏差的定义：$B \\equiv \\phi_{Q} - \\phi$\n- 要求计算：计算 $B$ 的值，并四舍五入到四位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据，提法恰当且客观。它基于中子输运理论和数值方法领域的标准定义。核心任务是在特定且明确定义的条件下，量化数值近似（一种求积法则）的误差或偏差。问题中提到的“精确性的基本要求”强调了，要使一个求积对于常数函数是正确的，其权重之和必须等于积分区域的面积，对于单位球面而言即为 $4\\pi$。该问题提供了一个候选求积，其中此条件被违反（$\\sum w_i = 12.50 \\neq 4\\pi$），并要求计算对于一个常数被积函数，由该缺陷导致的具体误差。这是分析数值方法准确性的一个有效且标准的程序。所有必要信息都已提供，问题没有矛盾或含糊之处。\n\n### 第 3 步：结论与行动\n问题有效。将提供解答。\n\n### 解题推导\n偏差 $B$ 定义为求积估计的标量通量 $\\phi_{Q}$ 与精确标量通量 $\\phi$ 之差。我们分别计算每一项。\n\n首先，我们计算精确标量通量 $\\phi$。根据定义，它是角通量 $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega})$ 在整个单位球面立体角上的积分。\n$$\n\\phi = \\int_{4\\pi} \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\Omega\n$$\n问题指出，角通量对所有角度都是常数，$\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) = \\psi_{0}$。由于 $\\psi_{0}$不依赖于积分变量 $\\boldsymbol{\\Omega}$，因此可以将其移到积分符号之外。\n$$\n\\phi = \\psi_{0} \\int_{4\\pi} \\mathrm{d}\\Omega\n$$\n积分 $\\int_{4\\pi} \\mathrm{d}\\Omega$ 代表球体的总立体角，等于 $4\\pi$ 球面度。\n$$\n\\phi = 4\\pi\\psi_{0}\n$$\n\n接下来，我们使用离散纵标法的求积和计算近似标量通量 $\\phi_{Q}$。\n$$\n\\phi_{Q} = \\sum_{i=1}^{N} w_{i} \\, \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}_{i})\n$$\n由于角通量是常数，对于所有离散方向 $\\boldsymbol{\\Omega}_{i}$，都有 $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}_{i}) = \\psi_{0}$。\n$$\n\\phi_{Q} = \\sum_{i=1}^{N} w_{i} \\, \\psi_{0}\n$$\n常数项 $\\psi_{0}$ 可以从求和中提取出来。\n$$\n\\phi_{Q} = \\psi_{0} \\sum_{i=1}^{N} w_{i}\n$$\n问题指明，该特定求积组的权重之和为 $\\sum_{i=1}^{N} w_{i} = 12.50$ sr。\n$$\n\\phi_{Q} = \\psi_{0} \\times 12.50\n$$\n\n现在，我们可以使用偏差 $B$ 的定义来计算它。\n$$\nB = \\phi_{Q} - \\phi\n$$\n代入 $\\phi_{Q}$ 和 $\\phi$ 的表达式：\n$$\nB = ( \\psi_{0} \\times 12.50 ) - (4\\pi\\psi_{0})\n$$\n我们可以将恒定角通量 $\\psi_{0}$ 提取出来。\n$$\nB = \\psi_{0} (12.50 - 4\\pi)\n$$\n给定值为 $\\psi_{0} = 2.00 \\times 10^{5}$ 中子$\\cdot$厘米$^{-2}\\cdot$秒$^{-1}\\cdot$球面度$^{-1}$。项 $(12.50 - 4\\pi)$ 的单位将是球面度 (sr)，因此得到的偏差 $B$ 的单位将是 中子$\\cdot$厘米$^{-2}\\cdot$秒$^{-1}$，符合要求。\n使用 $\\pi \\approx 3.14159265...$ 的值，我们计算出 $4\\pi \\approx 12.56637061...$\n$$\nB = (2.00 \\times 10^{5}) \\times (12.50 - 12.56637061...)\n$$\n$$\nB = (2.00 \\times 10^{5}) \\times (-0.06637061...)\n$$\n$$\nB \\approx -13274.1228\n$$\n问题要求最终答案四舍五入到四位有效数字。\n$$\nB \\approx -13270\n$$\n用标准科学记数法表示为：\n$$\nB = -1.327 \\times 10^{4}\n$$\n偏差的单位是 中子$\\cdot$厘米$^{-2}\\cdot$秒$^{-1}$。",
            "answer": "$$\n\\boxed{-1.327 \\times 10^{4}}\n$$"
        },
        {
            "introduction": "在确定了零阶矩的重要性之后，我们自然会转向更高阶的矩，因为它们对于精确描述各向异性问题至关重要。这些矩的精确积分确保了中子分布的不同角分量能够被正确输运。此练习  将引导您完成推导关键四阶矩精确解析值的基本演算过程，这些值是构建和验证高级求积组的“基准事实”。",
            "id": "4248105",
            "problem": "在核反应堆模拟的离散纵标(SN)方法中，选择角求积组时，需要精确再现方向余弦的低阶多项式的连续角动量矩，以确保旋转不变性和各向异性通量分量的精确输运。考虑一个单位球面，其通过球面坐标进行参数化，其中极角 $\\theta \\in [0,\\pi]$ 从 $z$ 轴开始测量，方位角 $\\phi \\in [0,2\\pi)$ 从 $x$ 轴开始测量，立体角元为 $d\\Omega=\\sin\\theta\\,d\\theta\\,d\\phi$。定义相对于笛卡尔坐标轴的方向余弦为 $\\mu=\\sin\\theta\\cos\\phi$，$\\eta=\\sin\\theta\\sin\\phi$ 和 $\\xi=\\cos\\theta$。\n\n从这些定义出发，仅使用基本三角恒等式和球面积分的性质，推导下列积分的精确闭式值。这些积分是四阶精确角求积必须匹配的连续球面矩：\n$$I_{1}=\\int_{4\\pi}\\mu^{4}\\,d\\Omega,\\qquad I_{2}=\\int_{4\\pi}\\mu^{2}\\eta^{2}\\,d\\Omega.$$\n\n对所有角度变量使用弧度，并将所有量视为无量纲。以精确形式将最终答案表示为一个二元行矩阵 $\\begin{pmatrix}I_{1}  I_{2}\\end{pmatrix}$。无需四舍五入。",
            "solution": "问题陈述经核实具有科学依据、适定、客观且完整。所有条件和定义在中子输运理论和数学物理领域均为标准。我们可以开始求解。\n\n目标是计算以下两个积分：\n$$I_{1}=\\int_{4\\pi}\\mu^{4}\\,d\\Omega$$\n$$I_{2}=\\int_{4\\pi}\\mu^{2}\\eta^{2}\\,d\\Omega$$\n\n方向余弦在球面坐标中定义为 $\\mu=\\sin\\theta\\cos\\phi$，$\\eta=\\sin\\theta\\sin\\phi$ 和 $\\xi=\\cos\\theta$。立体角元为 $d\\Omega=\\sin\\theta\\,d\\theta\\,d\\phi$，其中极角 $\\theta$ 的范围从 $0$ 到 $\\pi$，方位角 $\\phi$ 的范围从 $0$ 到 $2\\pi$。\n\n我们将通过将其表示为球面坐标形式并分离变量来计算每个积分。\n\n首先，我们将 $I_{1}$ 表示为二重积分：\n$$I_{1} = \\int_{0}^{2\\pi} \\int_{0}^{\\pi} (\\sin\\theta\\cos\\phi)^{4} \\sin\\theta\\,d\\theta\\,d\\phi$$\n被积函数是一个关于 $\\theta$ 的函数与一个关于 $\\phi$ 的函数的乘积，因此该积分是可分离的：\n$$I_{1} = \\left( \\int_{0}^{\\pi} \\sin^{4}\\theta \\sin\\theta \\,d\\theta \\right) \\left( \\int_{0}^{2\\pi} \\cos^{4}\\phi \\,d\\phi \\right) = \\left( \\int_{0}^{\\pi} \\sin^{5}\\theta \\,d\\theta \\right) \\left( \\int_{0}^{2\\pi} \\cos^{4}\\phi \\,d\\phi \\right)$$\n\n类似地，对于 $I_{2}$：\n$$I_{2} = \\int_{0}^{2\\pi} \\int_{0}^{\\pi} (\\sin\\theta\\cos\\phi)^{2} (\\sin\\theta\\sin\\phi)^{2} \\sin\\theta\\,d\\theta\\,d\\phi$$\n$$I_{2} = \\int_{0}^{2\\pi} \\int_{0}^{\\pi} \\sin^{4}\\theta \\cos^{2}\\phi \\sin^{2}\\phi \\sin\\theta\\,d\\theta\\,d\\phi$$\n这个积分也是可分离的：\n$$I_{2} = \\left( \\int_{0}^{\\pi} \\sin^{5}\\theta \\,d\\theta \\right) \\left( \\int_{0}^{2\\pi} \\cos^{2}\\phi \\sin^{2}\\phi \\,d\\phi \\right)$$\n\n我们观察到两个表达式都包含相同的关于 $\\theta$ 的积分。让我们定义以下分量：\n$$I_{\\theta} = \\int_{0}^{\\pi} \\sin^{5}\\theta \\,d\\theta$$\n$$I_{\\phi,1} = \\int_{0}^{2\\pi} \\cos^{4}\\phi \\,d\\phi$$\n$$I_{\\phi,2} = \\int_{0}^{2\\pi} \\cos^{2}\\phi \\sin^{2}\\phi \\,d\\phi$$\n于是，$I_{1} = I_{\\theta} I_{\\phi,1}$ 且 $I_{2} = I_{\\theta} I_{\\phi,2}$。我们将计算这三个积分中的每一个。\n\n$I_{\\theta}$ 的计算：\n为计算 $I_{\\theta} = \\int_{0}^{\\pi} \\sin^{5}\\theta \\,d\\theta$，我们使用换元法，令 $u = \\cos\\theta$，这意味着 $du = -\\sin\\theta \\,d\\theta$。积分限从 $\\theta=0$ 变为 $u=\\cos(0)=1$，从 $\\theta=\\pi$ 变为 $u=\\cos(\\pi)=-1$。我们将被积函数重写为 $\\sin^{5}\\theta = \\sin^{4}\\theta \\sin\\theta = (\\sin^{2}\\theta)^{2} \\sin\\theta = (1-\\cos^{2}\\theta)^{2} \\sin\\theta$。\n$$I_{\\theta} = \\int_{1}^{-1} (1-u^{2})^{2} (-du) = \\int_{-1}^{1} (1-u^{2})^{2} \\,du$$\n展开多项式：\n$$I_{\\theta} = \\int_{-1}^{1} (1 - 2u^{2} + u^{4}) \\,du$$\n逐项积分：\n$$I_{\\theta} = \\left[ u - \\frac{2}{3}u^{3} + \\frac{1}{5}u^{5} \\right]_{-1}^{1}$$\n$$I_{\\theta} = \\left(1 - \\frac{2}{3} + \\frac{1}{5}\\right) - \\left(-1 - \\frac{2}{3}(-1)^{3} + \\frac{1}{5}(-1)^{5}\\right) = \\left(1 - \\frac{2}{3} + \\frac{1}{5}\\right) - \\left(-1 + \\frac{2}{3} - \\frac{1}{5}\\right)$$\n$$I_{\\theta} = 2 \\left(1 - \\frac{2}{3} + \\frac{1}{5}\\right) = 2 \\left(\\frac{15 - 10 + 3}{15}\\right) = 2 \\left(\\frac{8}{15}\\right) = \\frac{16}{15}$$\n\n$I_{\\phi,1}$ 的计算：\n为计算 $I_{\\phi,1} = \\int_{0}^{2\\pi} \\cos^{4}\\phi \\,d\\phi$，我们使用降幂恒等式 $\\cos^{2}x = \\frac{1+\\cos(2x)}{2}$。\n$$\\cos^{4}\\phi = (\\cos^{2}\\phi)^{2} = \\left(\\frac{1+\\cos(2\\phi)}{2}\\right)^{2} = \\frac{1}{4}(1 + 2\\cos(2\\phi) + \\cos^{2}(2\\phi))$$\n我们对 $\\cos^{2}(2\\phi) = \\frac{1+\\cos(4\\phi)}{2}$ 再次应用该恒等式：\n$$\\cos^{4}\\phi = \\frac{1}{4}\\left(1 + 2\\cos(2\\phi) + \\frac{1+\\cos(4\\phi)}{2}\\right) = \\frac{1}{4}\\left(\\frac{3}{2} + 2\\cos(2\\phi) + \\frac{1}{2}\\cos(4\\phi)\\right) = \\frac{3}{8} + \\frac{1}{2}\\cos(2\\phi) + \\frac{1}{8}\\cos(4\\phi)$$\n现在，我们进行积分：\n$$I_{\\phi,1} = \\int_{0}^{2\\pi} \\left(\\frac{3}{8} + \\frac{1}{2}\\cos(2\\phi) + \\frac{1}{8}\\cos(4\\phi)\\right)d\\phi$$\n$\\cos(2\\phi)$ 和 $\\cos(4\\phi)$ 在区间 $[0, 2\\pi]$ 上的积分为零，因为它们是周期函数在整数个周期上的积分。\n$$\\int_{0}^{2\\pi}\\cos(k\\phi)d\\phi = \\left[\\frac{\\sin(k\\phi)}{k}\\right]_{0}^{2\\pi} = 0 \\quad \\text{对整数 } k \\ne 0$$\n因此，我们剩下：\n$$I_{\\phi,1} = \\int_{0}^{2\\pi} \\frac{3}{8} \\,d\\phi = \\frac{3}{8} [\\phi]_{0}^{2\\pi} = \\frac{3}{8}(2\\pi) = \\frac{3\\pi}{4}$$\n\n$I_{\\phi,2}$ 的计算：\n为计算 $I_{\\phi,2} = \\int_{0}^{2\\pi} \\cos^{2}\\phi \\sin^{2}\\phi \\,d\\phi$，我们使用二倍角恒等式 $\\sin(2x) = 2\\sin x \\cos x$。\n$$\\cos^{2}\\phi \\sin^{2}\\phi = (\\cos\\phi\\sin\\phi)^{2} = \\left(\\frac{\\sin(2\\phi)}{2}\\right)^{2} = \\frac{1}{4}\\sin^{2}(2\\phi)$$\n接着，我们使用降幂恒等式 $\\sin^{2}x = \\frac{1-\\cos(2x)}{2}$：\n$$\\frac{1}{4}\\sin^{2}(2\\phi) = \\frac{1}{4}\\left(\\frac{1-\\cos(4\\phi)}{2}\\right) = \\frac{1}{8}(1-\\cos(4\\phi))$$\n现在，我们进行积分：\n$$I_{\\phi,2} = \\int_{0}^{2\\pi} \\frac{1}{8}(1-\\cos(4\\phi)) \\,d\\phi$$\n如前所述，$\\cos(4\\phi)$ 在 $[0, 2\\pi]$ 上的积分为零。\n$$I_{\\phi,2} = \\int_{0}^{2\\pi} \\frac{1}{8} \\,d\\phi = \\frac{1}{8}[\\phi]_{0}^{2\\pi} = \\frac{1}{8}(2\\pi) = \\frac{\\pi}{4}$$\n\n最后，我们综合结果求得 $I_{1}$ 和 $I_{2}$。\n$$I_{1} = I_{\\theta} I_{\\phi,1} = \\left(\\frac{16}{15}\\right) \\left(\\frac{3\\pi}{4}\\right) = \\frac{48\\pi}{60} = \\frac{4\\pi}{5}$$\n$$I_{2} = I_{\\theta} I_{\\phi,2} = \\left(\\frac{16}{15}\\right) \\left(\\frac{\\pi}{4}\\right) = \\frac{16\\pi}{60} = \\frac{4\\pi}{15}$$\n\n计算出的值为 $I_{1} = \\frac{4\\pi}{5}$ 和 $I_{2} = \\frac{4\\pi}{15}$。最终答案应表示为一个二元行矩阵。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{4\\pi}{5}  \\frac{4\\pi}{15} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "我们已经探讨了零阶和高阶矩的重要性，但如何系统地测试一个求积组的整体精度呢？一个有效的方法是使用一组完备的基函数——球谐函数 ($Y_l^m$)——作为通用测试集。这个最终的计算练习  要求您构建一个评分工具，通过系统地检查求积组对直至特定阶数的所有球谐函数的积分精确度，从而为其性能提供一个全面的量化指标。",
            "id": "4248085",
            "problem": "考虑复球谐函数 $Y_{l}^{m}(\\theta,\\phi)$ 在单位球面上的角积分，其中 $l$ 是阶，$m$ 是次。单位球面面元测度为 $d\\Omega = \\sin\\theta\\,d\\theta\\,d\\phi$，其中极角 $\\theta \\in [0,\\pi]$，方位角 $\\phi \\in [0,2\\pi)$。采用广泛接受的科学计算库中使用的 Condon–Shortley 球谐函数归一化方法，其在内积 $\\int_{S^{2}} Y_{l}^{m}(\\theta,\\phi)\\, \\overline{Y_{l'}^{m'}(\\theta,\\phi)}\\, d\\Omega = \\delta_{ll'}\\delta_{mm'}$ 下具有正交归一性，适用于所有整数 $l \\ge 0$ 和整数 $-l \\le m \\le l$。此处 $\\overline{(\\cdot)}$ 表示复共轭，$\\delta_{ab}$ 是克罗内克 δ。\n\n您需要评估一种在核反应堆分析的输运模拟中常用的、特定的球面积分乘积求积法的精确性。该求积法由 $[-1,1]$ 上关于 $\\mu = \\cos\\theta$ 的高斯-勒让德法则与 $[0,2\\pi)$ 上关于 $\\phi$ 的梯形法则的张量积定义。具体而言，对于选定的极向点数 $N_{\\theta}$ 和方位向点数 $N_{\\phi}$：\n- 令 $(\\mu_{i}, w^{\\mu}_{i})$（$i=1,\\dots,N_{\\theta}$）为 $[-1,1]$ 上的高斯-勒让德求积的节点和权重，该求积对次数最高为 $2N_{\\theta}-1$ 的 $\\mu$ 多项式是精确的，并满足 $\\sum_{i=1}^{N_{\\theta}} w^{\\mu}_{i} = 2$。\n- 令 $\\phi_{j} = 2\\pi j / N_{\\phi}$（$j=0,\\dots,N_{\\phi}-1$）为等间距方位角节点，其梯形权重为 $w^{\\phi} = 2\\pi / N_{\\phi}$，使得 $\\sum_{j=0}^{N_{\\phi}-1} w^{\\phi} = 2\\pi$。\n- 张量积节点 $(\\mu_{i}, \\phi_{j})$ 的总权重为 $w_{ij} = w^{\\mu}_{i}\\, w^{\\phi}$，对应的极角为 $\\theta_{i} = \\arccos(\\mu_{i})$。\n\n对于给定的非负整数 $L$，考虑集合 $\\mathcal{H}_{L} = \\{Y_{l}^{m} : 0 \\le l \\le L,\\ -l \\le m \\le l\\}$。定义解析积分\n$$\nI_{l,m} = \\int_{S^{2}} Y_{l}^{m}(\\theta,\\phi)\\, d\\Omega,\n$$\n和求积近似\n$$\nQ_{l,m} = \\sum_{i=1}^{N_{\\theta}} \\sum_{j=0}^{N_{\\phi}-1} w_{ij}\\, Y_{l}^{m}(\\theta_{i},\\phi_{j}).\n$$\n使用所述的归一化方法，一个经过充分检验的基本事实是，$I_{0,0} = \\sqrt{4\\pi}$ 且对于所有 $(l,m) \\ne (0,0)$ 都有 $I_{l,m} = 0$。您必须计算精确性得分\n$$\nS(L, N_{\\theta}, N_{\\phi}, \\tau) = \\frac{1}{|\\mathcal{H}_{L}|}\\sum_{l=0}^{L}\\ \\sum_{m=-l}^{l} \\mathbf{1}\\left( \\left|Q_{l,m} - I_{l,m}\\right| \\le \\tau \\right),\n$$\n其中 $|\\mathcal{H}_{L}| = \\sum_{l=0}^{L} (2l+1)$ 是集合的基数，$\\mathbf{1}(\\cdot)$ 是指示函数。角度 $\\theta$ 和 $\\phi$ 必须以弧度处理。最终得分 $S$ 必须以 $[0,1]$ 区间内的小数形式报告。\n\n仅从球坐标、球面测度以及所述的高斯-勒让德法则和梯形法则的归一化与性质等基本定义出发，为给定的元组 $(L, N_{\\theta}, N_{\\phi}, \\tau)$ 推导一个计算 $S(L, N_{\\theta}, N_{\\phi}, \\tau)$ 的算法，并在指定的编程语言环境中实现它。确保求积权重满足 $\\sum_{i,j} w_{ij} = 4\\pi$，从而使常数函数能够被精确积分。在整个过程中，所有角度均使用弧度制。\n\n设计您的程序，以评估以下参数元组 $(L, N_{\\theta}, N_{\\phi}, \\tau)$ 测试套件的精确性得分：\n- 案例 1：$(L, N_{\\theta}, N_{\\phi}, \\tau) = (5, 4, 8, 10^{-12})$。\n- 案例 2：$(L, N_{\\theta}, N_{\\phi}, \\tau) = (7, 3, 6, 10^{-9})$。\n- 案例 3：$(L, N_{\\theta}, N_{\\phi}, \\tau) = (9, 2, 4, 10^{-6})$。\n- 案例 4：$(L, N_{\\theta}, N_{\\phi}, \\tau) = (3, 1, 1, 10^{-12})$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[s_{1},s_{2},s_{3},s_{4}]$，其中每个 $s_{k}$ 是对应测试案例计算出的十进制得分 $S$。不允许使用度数角度或百分号；所有角度均以弧度表示，所有得分均以小数表示。",
            "solution": "问题陈述已经过严格验证，并被认为是可靠的。它具有科学依据，是良定的，并为数值分析中的一个可形式化问题（具体涉及用于积分球谐函数的求积组的精确性）提供了一套完整且一致的定义和数据。\n\n目标是计算单位球面上张量积求积方案的精确性得分 $S(L, N_{\\theta}, N_{\\phi}, \\tau)$。该得分量化了最高阶为 $L$ 的球谐函数 $Y_{l}^{m}$ 中，积分结果在给定容差 $\\tau$ 内的比例。\n\n球谐函数 $Y_{l}^{m}$ 在单位球面 $S^2$ 上的解析积分由下式给出：\n$$\nI_{l,m} = \\int_{S^{2}} Y_{l}^{m}(\\theta,\\phi)\\, d\\Omega = \\int_{0}^{2\\pi} \\int_{0}^{\\pi} Y_{l}^{m}(\\theta,\\phi) \\sin\\theta\\,d\\theta\\,d\\phi\n$$\n对于 $l=0, m=0$ 的球谐函数是一个常数，$Y_{0}^{0}(\\theta,\\phi) = 1/\\sqrt{4\\pi}$。利用这一点，我们可以将积分写成内积形式：\n$$\nI_{l,m} = \\int_{S^{2}} Y_{l}^{m}(\\theta,\\phi) \\cdot \\sqrt{4\\pi} Y_{0}^{0}(\\theta,\\phi) \\, d\\Omega = \\sqrt{4\\pi} \\int_{S^{2}} Y_{l}^{m}(\\theta,\\phi) \\overline{Y_{0}^{0}(\\theta,\\phi)} \\, d\\Omega\n$$\n其中 $\\overline{(\\cdot)}$ 表示复共轭。调用所给出的正交归一性 $\\int_{S^{2}} Y_{l}^{m} \\overline{Y_{l'}^{m'}} d\\Omega = \\delta_{ll'}\\delta_{mm'}$，我们得到：\n$$\nI_{l,m} = \\sqrt{4\\pi} \\delta_{l0}\\delta_{m0}\n$$\n这证实了问题陈述中的结论：$I_{0,0} = \\sqrt{4\\pi}$ 且对于所有其他的 $(l,m)$，$I_{l,m} = 0$。\n\n该积分的数值求积近似为：\n$$\nQ_{l,m} = \\sum_{i=1}^{N_{\\theta}} \\sum_{j=0}^{N_{\\phi}-1} w_{ij}\\, Y_{l}^{m}(\\theta_{i},\\phi_{j})\n$$\n其中权重为 $w_{ij} = w^{\\mu}_{i}\\, w^{\\phi}$。节点为 $(\\theta_i, \\phi_j)$，且 $\\theta_i = \\arccos(\\mu_i)$。点对 $(\\mu_i, w^{\\mu}_{i})$ 是 $[-1,1]$ 上 $N_{\\theta}$ 点高斯-勒让德求积的节点和权重，而方位角节点和权重则分别为 $\\phi_j = 2\\pi j / N_{\\phi}$ 和 $w^{\\phi} = 2\\pi / N_{\\phi}$。\n\n计算精确性得分 $S$ 的算法如下：\n\n1.  **初始化参数**：对于每个测试案例，给定一个元组 $(L, N_{\\theta}, N_{\\phi}, \\tau)$。\n2.  **生成求积组**：\n    a.  计算区间 $[-1,1]$ 上的 $N_{\\theta}$ 个高斯-勒让德节点 $\\mu_i$ 和权重 $w^{\\mu}_{i}$。这些可以通过标准数值库（如 `numpy.polynomial.legendre.leggauss`）获得。\n    b.  将极向节点转换为弧度：$\\theta_i = \\arccos(\\mu_i)$。\n    c.  计算 $N_{\\phi}$ 个等间距梯形节点 $\\phi_j = 2\\pi j / N_{\\phi}$（$j=0, \\dots, N_{\\phi}-1$）和恒定权重 $w^{\\phi} = 2\\pi / N_{\\phi}$。\n3.  **迭代与评估**：我们遍历所有满足 $0 \\le l \\le L$ 和 $-l \\le m \\le l$ 的球谐函数 $Y_{l}^{m}$。对于每个谐波：\n    a.  确定精确的解析积分 $I_{l,m}$，当 $(l,m)=(0,0)$ 时为 $\\sqrt{4\\pi}$，否则为 $0$。\n    b.  计算数值积分 $Q_{l,m}$。这通过在每个求积点上评估 $Y_{l}^{m}(\\theta_i, \\phi_j)$，乘以相应的权重 $w_{ij} = w^{\\mu}_{i} w^{\\phi}$，然后对结果求和来完成。复球谐函数 $Y_{l}^{m}$ 使用标准科学库函数（如 `scipy.special.sph_harm`）进行评估。\n4.  **比较与计数**：对于每个 $(l,m)$，我们计算绝对误差 $|Q_{l,m} - I_{l,m}|$，并检查其是否小于或等于指定的容差 $\\tau$。如果条件满足，则一个初始化为零的计数器会递增。\n5.  **计算最终得分**：在检查完集合 $\\mathcal{H}_L$ 中所有 $(L+1)^2$ 个谐波后，最终得分计算为计数器与谐波总数的比率：\n    $$\n    S = \\frac{\\text{number of exactly integrated harmonics}}{|\\mathcal{H}_{L}|} = \\frac{\\text{counter}}{(L+1)^2}\n    $$\n\n对每个提供的测试案例实施此过程，以确定相应的精确性得分。该实现应利用向量化计算以提高效率，尤其是在评估 $Q_{l,m}$ 的求和时。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import sph_harm\n\ndef solve():\n    \"\"\"\n    Evaluates the exactness score for a tensor-product quadrature on the sphere\n    for integrating spherical harmonics, based on a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, N_theta, N_phi, tau)\n        (5, 4, 8, 10**-12),\n        (7, 3, 6, 10**-9),\n        (9, 2, 4, 10**-6),\n        (3, 1, 1, 10**-12),\n    ]\n\n    results = []\n    for L, N_theta, N_phi, tau in test_cases:\n        # Step 1: Generate Quadrature Set\n        # Gauss-Legendre quadrature nodes (mu) and weights for the polar angle\n        mu_nodes, mu_weights = np.polynomial.legendre.leggauss(N_theta)\n        \n        # Convert mu nodes to polar angle theta nodes in radians\n        theta_nodes = np.arccos(mu_nodes)\n\n        # Trapezoidal rule nodes and weight for the azimuthal angle\n        phi_nodes = np.arange(N_phi, dtype=float) * (2.0 * np.pi / N_phi)\n        phi_weight = 2.0 * np.pi / N_phi\n        \n        # Initialize counters\n        total_harmonics = (L + 1)**2\n        exact_count = 0\n        \n        # Combine weights for tensor product\n        # weights_grid is an (N_theta, N_phi) array\n        weights_grid = np.outer(mu_weights, np.full(N_phi, phi_weight))\n\n        # Create meshgrid of angles for vectorized evaluation\n        # theta_grid and phi_grid are (N_theta, N_phi) arrays\n        # Note: 'ij' indexing ensures theta corresponds to the first axis\n        theta_grid, phi_grid = np.meshgrid(theta_nodes, phi_nodes, indexing='ij')\n\n        # Step 2: Iterate over all spherical harmonics up to degree L\n        for l in range(L + 1):\n            for m in range(-l, l + 1):\n                # Step 3a: Determine analytic integral I_l,m\n                if l == 0 and m == 0:\n                    I_lm = np.sqrt(4.0 * np.pi)\n                else:\n                    I_lm = 0.0\n\n                # Step 3b: Compute numerical quadrature Q_l,m\n                # Evaluate Y_l^m at all quadrature points (vectorized)\n                # sph_harm arguments are (m, l, azimuth_phi, polar_theta)\n                y_lm_values = sph_harm(m, l, phi_grid, theta_grid)\n\n                # Compute the sum over all points\n                Q_lm = np.sum(weights_grid * y_lm_values)\n\n                # Step 4: Compare and Count\n                # np.abs handles complex numbers correctly (computes magnitude)\n                if np.abs(Q_lm - I_lm) = tau:\n                    exact_count += 1\n        \n        # Step 5: Calculate Final Score\n        score = exact_count / total_harmonics\n        results.append(score)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}