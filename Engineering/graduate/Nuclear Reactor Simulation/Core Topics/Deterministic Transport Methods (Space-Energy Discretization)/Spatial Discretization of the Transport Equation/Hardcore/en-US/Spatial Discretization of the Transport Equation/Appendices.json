{
    "hands_on_practices": [
        {
            "introduction": "Applying a numerical method begins with translating the continuous differential operators of a partial differential equation into discrete algebraic forms. This exercise guides you through this fundamental process for the transport equation's streaming term, $\\boldsymbol{\\Omega} \\cdot \\nabla \\psi$, using the finite volume method on an unstructured triangular mesh. By applying the divergence theorem and an upwind closure, you will derive the net leakage from a computational cell, providing a concrete understanding of how particle advection is modeled in modern transport codes. ",
            "id": "4251181",
            "problem": "Consider a steady-state, monoenergetic neutron transport problem in two spatial dimensions, discretized in angle by the discrete ordinates method (SN). Let $\\boldsymbol{\\Omega}_{m}$ be one of the discrete directions. For a triangular control volume $\\mathcal{T} \\subset \\mathbb{R}^{2}$ with edges indexed by $e \\in \\{1,2,3\\}$, let $\\mathbf{n}_{e}$ denote the outward unit normal on edge $e$, and let $\\ell_{e}$ denote the length of edge $e$. Let $\\psi_{m}(\\mathbf{x})$ be the angular flux for direction $\\boldsymbol{\\Omega}_{m}$. Assume a piecewise-constant approximation in a standard finite-volume sense: the cell-averaged angular flux inside $\\mathcal{T}$ is $\\,\\psi_{\\mathcal{T},m}\\,$ and the edge-averaged angular flux on edge $e$ is $\\psi_{e,m}$, taken as the upwind value with respect to $\\boldsymbol{\\Omega}_{m}$ (i.e., inflow edges use the neighboring cellâ€™s average, outflow edges use the interior cell average). \n\nStarting from the streaming term of the steady-state linear Boltzmann transport equation, $\\,\\boldsymbol{\\Omega}_{m} \\cdot \\nabla \\psi_{m}\\,$, and using only fundamental principles (including the divergence theorem and the finite-volume control-volume balance), derive the expression for the net leakage from $\\mathcal{T}$ in direction $\\boldsymbol{\\Omega}_{m}$ as a sum over the edges of $\\mathcal{T}$ employing the outward edge normals. Explicitly demonstrate how the sign of $\\,\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}\\,$ determines inflow versus outflow and incorporate an upwind selection into a single closed-form expression by using the positive and negative parts of a scalar. You may define, for any scalar $a$, the positive part $a^{+} \\equiv \\max(a,0)$ and the negative part $a^{-} \\equiv \\min(a,0)$.\n\nProvide your final expression for the net leakage $L_{m}(\\mathcal{T})$ as an analytic expression in terms of $\\,\\boldsymbol{\\Omega}_{m}$, $\\,\\mathbf{n}_{e}$, $\\,\\ell_{e}$, $\\,\\psi_{\\mathcal{T},m}\\,$, and the neighboring cell averages $\\,\\psi_{N(e),m}\\,$ for each inflow edge $e$. The final answer must be a single closed-form analytic expression. No numerical evaluation is required.",
            "solution": "The net leakage, $L_{m}(\\mathcal{T})$, from a control volume $\\mathcal{T}$ for a given discrete direction $\\boldsymbol{\\Omega}_{m}$ is the volume integral of the streaming term from the steady-state Boltzmann transport equation.\n\nWe begin with the streaming term, $\\boldsymbol{\\Omega}_{m} \\cdot \\nabla \\psi_{m}$, and integrate it over the two-dimensional triangular control volume $\\mathcal{T}$:\n$$\nL_{m}(\\mathcal{T}) = \\int_{\\mathcal{T}} (\\boldsymbol{\\Omega}_{m} \\cdot \\nabla \\psi_{m}) \\, dA\n$$\nSince the discrete direction $\\boldsymbol{\\Omega}_{m}$ is a constant vector, we can use the vector identity $\\nabla \\cdot (f \\mathbf{v}) = f(\\nabla \\cdot \\mathbf{v}) + \\mathbf{v} \\cdot \\nabla f$. With $f = \\psi_m$ and $\\mathbf{v} = \\boldsymbol{\\Omega}_m$, and noting that $\\nabla \\cdot \\boldsymbol{\\Omega}_m = 0$, we have $\\boldsymbol{\\Omega}_{m} \\cdot \\nabla \\psi_{m} = \\nabla \\cdot (\\psi_{m} \\boldsymbol{\\Omega}_{m})$. The leakage integral becomes:\n$$\nL_{m}(\\mathcal{T}) = \\int_{\\mathcal{T}} \\nabla \\cdot (\\psi_{m} \\boldsymbol{\\Omega}_{m}) \\, dA\n$$\nWe apply the divergence theorem, which in two dimensions relates the integral of a divergence over an area to a line integral over its boundary $\\partial \\mathcal{T}$:\n$$\nL_{m}(\\mathcal{T}) = \\oint_{\\partial \\mathcal{T}} (\\psi_{m} \\boldsymbol{\\Omega}_{m}) \\cdot \\mathbf{n} \\, ds\n$$\nwhere $\\mathbf{n}$ is the outward unit normal vector on the boundary $\\partial \\mathcal{T}$.\n\nThe boundary $\\partial \\mathcal{T}$ of the triangular control volume is composed of three straight edges, indexed by $e \\in \\{1, 2, 3\\}$. The boundary integral can be expressed as a sum of integrals over these edges:\n$$\nL_{m}(\\mathcal{T}) = \\sum_{e=1}^{3} \\int_{e} (\\psi_{m} \\boldsymbol{\\Omega}_{m}) \\cdot \\mathbf{n}_{e} \\, ds\n$$\nwhere $\\mathbf{n}_{e}$ is the constant outward unit normal on edge $e$. As $\\boldsymbol{\\Omega}_{m}$ and $\\mathbf{n}_{e}$ are constant along each edge, their dot product can be taken outside the integral:\n$$\nL_{m}(\\mathcal{T}) = \\sum_{e=1}^{3} (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}) \\int_{e} \\psi_{m}(\\mathbf{x}) \\, ds\n$$\nIn a finite-volume method, we use the edge-averaged angular flux, $\\psi_{e,m}$, defined as:\n$$\n\\psi_{e,m} = \\frac{1}{\\ell_{e}} \\int_{e} \\psi_{m}(\\mathbf{x}) \\, ds\n$$\nwhere $\\ell_{e}$ is the length of edge $e$. Substituting this into the leakage expression, we obtain the discretized form of the net leakage:\n$$\nL_{m}(\\mathcal{T}) = \\sum_{e=1}^{3} (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}) \\ell_{e} \\psi_{e,m}\n$$\nThe problem specifies a first-order upwind scheme. The value of the edge-averaged flux $\\psi_{e,m}$ is determined by the direction of neutron flow relative to the edge. The sign of the scalar product $\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}$ determines whether an edge is an inflow or outflow boundary for the control volume $\\mathcal{T}$:\n- If $\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e} > 0$, the component of neutron velocity normal to the edge is directed outwards. This is an **outflow** edge. The upwind approximation dictates that the flux on the edge is determined by the \"upstream\" value, which is the interior cell-averaged flux, $\\psi_{\\mathcal{T},m}$. Thus, $\\psi_{e,m} = \\psi_{\\mathcal{T},m}$.\n- If $\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}  0$, the component of neutron velocity normal to the edge is directed inwards. This is an **inflow** edge. The upwind approximation takes the flux from the neighboring cell, $\\psi_{N(e),m}$. Thus, $\\psi_{e,m} = \\psi_{N(e),m}$.\n- If $\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e} = 0$, the flow is parallel to the edge, and this edge makes no contribution to the net leakage.\n\nWe can express this upwind scheme as a single expression using the defined positive part, $a^{+} \\equiv \\max(a,0)$, and negative part, $a^{-} \\equiv \\min(a,0)$, of a scalar $a$.\nLet $C_e = \\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}$. The contribution to net leakage from edge $e$ is $C_e \\ell_e \\psi_{e,m}$.\nFor an outflow edge ($C_e > 0$), the contribution is $C_e \\ell_e \\psi_{\\mathcal{T},m}$. This can be written as $C_e^{+} \\ell_e \\psi_{\\mathcal{T},m}$ since $C_e > 0 \\implies C_e^{+} = C_e$ and $C_e^{-} = 0$.\nFor an inflow edge ($C_e  0$), the contribution is $C_e \\ell_e \\psi_{N(e),m}$. This can be written as $C_e^{-} \\ell_e \\psi_{N(e),m}$ since $C_e  0 \\implies C_e^{-} = C_e$ and $C_e^{+} = 0$.\nThe total net leakage is the sum of these contributions over all edges:\n$$\nL_{m}(\\mathcal{T}) = \\sum_{e=1}^{3} \\left[ (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})^{+} \\ell_{e} \\psi_{\\mathcal{T},m} + (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})^{-} \\ell_{e} \\psi_{N(e),m} \\right]\n$$\nThis is a valid closed-form expression. However, we can simplify it further. We use the identity $a^{+} = a - a^{-}$ where $a = \\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}$. Substituting this into the expression:\n$$\nL_{m}(\\mathcal{T}) = \\sum_{e=1}^{3} \\left[ \\left((\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}) - (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})^{-}\\right) \\ell_{e} \\psi_{\\mathcal{T},m} + (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})^{-} \\ell_{e} \\psi_{N(e),m} \\right]\n$$\nRearranging the terms:\n$$\nL_{m}(\\mathcal{T}) = \\sum_{e=1}^{3} (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})\\ell_{e}\\psi_{\\mathcal{T},m} + \\sum_{e=1}^{3} (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})^{-} \\ell_{e} \\left( \\psi_{N(e),m} - \\psi_{\\mathcal{T},m} \\right)\n$$\nWe examine the first term. Since $\\psi_{\\mathcal{T},m}$ and $\\boldsymbol{\\Omega}_{m}$ are constant for the control volume, we can write:\n$$\n\\sum_{e=1}^{3} (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})\\ell_{e}\\psi_{\\mathcal{T},m} = \\psi_{\\mathcal{T},m} \\left( \\boldsymbol{\\Omega}_{m} \\cdot \\sum_{e=1}^{3} \\mathbf{n}_{e}\\ell_{e} \\right)\n$$\nFor any closed volume (or area in 2D), the vector sum of the outward normals scaled by the surface area (or edge length in 2D) is zero. This is a consequence of the divergence theorem applied to a constant vector field. That is, $\\sum_{e=1}^{3} \\mathbf{n}_{e}\\ell_{e} = \\oint_{\\partial\\mathcal{T}} \\mathbf{n} \\, ds = \\mathbf{0}$.\nTherefore, the first term vanishes:\n$$\n\\psi_{\\mathcal{T},m} \\left( \\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{0} \\right) = 0\n$$\nThis leaves us with the simplified and final expression for the net leakage:\n$$\nL_{m}(\\mathcal{T}) = \\sum_{e=1}^{3} (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})^{-} \\ell_{e} (\\psi_{N(e),m} - \\psi_{\\mathcal{T},m})\n$$\nThis elegant form shows that the net leakage from the cell is driven by the difference between the cell-averaged flux and the upwind fluxes on the inflow faces, weighted by the projected inflow area.",
            "answer": "$$\n\\boxed{\\sum_{e=1}^{3} (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})^{-} \\ell_{e} (\\psi_{N(e),m} - \\psi_{\\mathcal{T},m})}\n$$"
        },
        {
            "introduction": "While many discretization schemes are mathematically consistent, their behavior can be non-physical under certain conditions, a critical consideration for practical simulations. The Diamond Difference scheme, for example, is simple and often used but is known to fail in optically thick media. This problem provides a hands-on demonstration of this failure by having you calculate an unphysical negative angular flux, illustrating the trade-offs between accuracy, simplicity, and robustness in numerical methods. ",
            "id": "4251235",
            "problem": "Consider a one-dimensional homogeneous slab cell in the discrete ordinates method (discrete ordinates (SN)) for a single ordinate direction cosine $\\,\\mu0\\,$. The steady-state, monoenergetic transport equation for the angular flux $\\,\\psi(x,\\mu)\\,$ is\n$$\n\\mu\\,\\frac{d\\psi}{dx} + \\Sigma_{t}\\,\\psi = q,\n$$\nwhere $\\,\\Sigma_{t}\\,$ is the total macroscopic cross section and $\\,q\\,$ is a constant volumetric angular source within the cell. Let the spatial cell width be $\\,\\Delta x\\,$, the left edge be at $\\,x=0\\,$ with prescribed incoming angular flux $\\,\\psi_{L}=\\psi(0,\\mu)\\,$, and the right edge be at $\\,x=\\Delta x\\,$ with unknown outgoing angular flux $\\,\\psi_{R}=\\psi(\\Delta x,\\mu)\\,$. Let the optical thickness of the cell in direction $\\,\\mu\\,$ be $\\,\\tau \\equiv \\Sigma_{t}\\Delta x/\\mu\\,$.\n\nUsing the diamond difference spatial discretization applied to the transport equation over the cell, compute the right-edge angular flux $\\,\\psi_{R}\\,$ and the cell-center angular flux $\\,\\psi_{c}\\,$ for the following optically thick case:\n- $\\,\\Sigma_{t} = 1\\,\\text{cm}^{-1}\\,$,\n- $\\,\\mu = 0.1\\,$,\n- $\\,\\tau = 20\\,$,\n- $\\,q = 0.2\\,\\text{neutrons}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}\\,$,\n- $\\,\\psi_{L} = 1\\,\\text{neutrons}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}\\,$.\n\nProvide the values of $\\,\\psi_{R}\\,$ and $\\,\\psi_{c}\\,$ computed by diamond difference for this cell. Express each angular flux in the unit neutrons cm$^{-2}$ s$^{-1}$ sr$^{-1}$ and round your answers to four significant figures. Report the two values in the order $\\,\\psi_{R}\\,$ then $\\,\\psi_{c}\\,$.",
            "solution": "The problem requires the computation of the outgoing angular flux, $\\psi_{R}$, and the cell-center angular flux, $\\psi_{c}$, for a one-dimensional slab cell using the diamond difference (DD) spatial discretization scheme. The governing equation is the steady-state, monoenergetic transport equation for a single direction cosine $\\mu > 0$:\n$$\n\\mu\\,\\frac{d\\psi}{dx} + \\Sigma_{t}\\,\\psi = q\n$$\nwhere $\\psi(x,\\mu)$ is the angular flux, $\\Sigma_t$ is the constant total macroscopic cross section, and $q$ is the constant volumetric angular source.\n\nThe diamond difference scheme is defined by two fundamental equations for a spatial cell of width $\\Delta x$ with left edge flux $\\psi_L$ and right edge flux $\\psi_R$.\n\nThe first equation is derived by integrating the transport equation over the cell width, from $x=0$ to $x=\\Delta x$:\n$$\n\\int_{0}^{\\Delta x} \\left( \\mu\\,\\frac{d\\psi}{dx} + \\Sigma_{t}\\,\\psi \\right) dx = \\int_{0}^{\\Delta x} q \\, dx\n$$\nPerforming the integration yields the cell balance equation:\n$$\n\\mu\\,[\\psi(\\Delta x) - \\psi(0)] + \\Sigma_{t} \\int_{0}^{\\Delta x} \\psi(x) \\, dx = q\\,\\Delta x\n$$\nIn the diamond difference scheme, the cell-average flux, $\\bar{\\psi} = \\frac{1}{\\Delta x} \\int_{0}^{\\Delta x} \\psi(x) \\, dx$, is approximated by the cell-center flux, $\\psi_{c}$. Using the notation $\\psi_L = \\psi(0)$ and $\\psi_R = \\psi(\\Delta x)$, the balance equation becomes:\n$$\n\\mu\\,(\\psi_R - \\psi_L) + \\Sigma_{t}\\,\\psi_{c}\\,\\Delta x = q\\,\\Delta x\n$$\n\nThe second equation is the auxiliary diamond difference relation, which algebraically links the cell-center flux to the cell-edge fluxes by assuming a linear flux profile within the cell:\n$$\n\\psi_{c} = \\frac{\\psi_L + \\psi_R}{2}\n$$\n\nWe now have a system of two linear equations for the two unknowns, $\\psi_R$ and $\\psi_c$. We can solve this system by substituting the auxiliary relation into the balance equation:\n$$\n\\mu\\,(\\psi_R - \\psi_L) + \\Sigma_{t}\\,\\left( \\frac{\\psi_L + \\psi_R}{2} \\right)\\,\\Delta x = q\\,\\Delta x\n$$\nTo solve for $\\psi_R$, we group terms containing $\\psi_R$:\n$$\n\\mu\\,\\psi_R + \\frac{\\Sigma_{t}\\,\\Delta x}{2}\\,\\psi_R = q\\,\\Delta x + \\mu\\,\\psi_L - \\frac{\\Sigma_{t}\\,\\Delta x}{2}\\,\\psi_L\n$$\n$$\n\\psi_R\\,\\left( \\mu + \\frac{\\Sigma_{t}\\,\\Delta x}{2} \\right) = q\\,\\Delta x + \\psi_L\\,\\left( \\mu - \\frac{\\Sigma_{t}\\,\\Delta x}{2} \\right)\n$$\nIsolating $\\psi_R$ gives:\n$$\n\\psi_R = \\frac{q\\,\\Delta x + \\psi_L\\,\\left( \\mu - \\frac{\\Sigma_{t}\\,\\Delta x}{2} \\right)}{\\mu + \\frac{\\Sigma_{t}\\,\\Delta x}{2}}\n$$\nThis expression can be simplified by dividing the numerator and denominator by $\\mu$:\n$$\n\\psi_R = \\frac{\\frac{q\\,\\Delta x}{\\mu} + \\psi_L\\,\\left( 1 - \\frac{\\Sigma_t\\,\\Delta x}{2\\mu} \\right)}{1 + \\frac{\\Sigma_t\\,\\Delta x}{2\\mu}}\n$$\nThe problem defines the optical thickness of the cell as $\\tau \\equiv \\Sigma_{t}\\Delta x/\\mu$. Substituting $\\tau$ into the expression for $\\psi_R$:\n$$\n\\psi_R = \\frac{\\frac{q}{\\Sigma_t}\\,\\tau + \\psi_L\\,\\left( 1 - \\frac{\\tau}{2} \\right)}{1 + \\frac{\\tau}{2}}\n$$\nThe given values are:\n- $\\Sigma_{t} = 1\\,\\text{cm}^{-1}$\n- $\\mu = 0.1$\n- $\\tau = 20$\n- $q = 0.2\\,\\text{neutrons}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$\n- $\\psi_{L} = 1\\,\\text{neutrons}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$\n\nFirst, we calculate the source-to-cross-section ratio, $S = q/\\Sigma_t$:\n$$\nS = \\frac{0.2}{1} = 0.2\\,\\text{neutrons}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}\n$$\nNow we substitute the numerical values into the expression for $\\psi_R$:\n$$\n\\psi_R = \\frac{(0.2)\\,(20) + (1)\\,\\left( 1 - \\frac{20}{2} \\right)}{1 + \\frac{20}{2}} = \\frac{4 + (1 - 10)}{1 + 10} = \\frac{4 - 9}{11} = -\\frac{5}{11}\n$$\nSo, the outgoing angular flux is $\\psi_R = -5/11$. Rounding to four significant figures gives:\n$$\n\\psi_R \\approx -0.4545\\,\\text{neutrons}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}\n$$\nThe negative value for the angular flux is an unphysical result but is the mathematically correct outcome of applying the diamond difference scheme to this optically thick problem. This phenomenon is a known deficiency of the method, and correcting it in practical codes requires a procedure often termed a \"diamond difference flux fixup\".\n\nNext, we compute the cell-center flux, $\\psi_c$, using the auxiliary relation:\n$$\n\\psi_c = \\frac{\\psi_L + \\psi_R}{2} = \\frac{1 + (-\\frac{5}{11})}{2} = \\frac{\\frac{11}{11} - \\frac{5}{11}}{2} = \\frac{\\frac{6}{11}}{2} = \\frac{3}{11}\n$$\nSo, the cell-center angular flux is $\\psi_c = 3/11$. Rounding to four significant figures gives:\n$$\n\\psi_c \\approx 0.2727\\,\\text{neutrons}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}\n$$\nThe requested values, rounded to four significant figures, are $\\psi_R = -0.4545$ and $\\psi_c = 0.2727$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.4545  0.2727 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "After selecting a discretization scheme, ensuring its correct implementation in a simulation code is paramount. The Method of Manufactured Solutions (MMS) is a rigorous verification technique where an exact solution to the transport equation is 'manufactured' by designing a corresponding source term. This exercise will have you perform the core step of an MMS test: deriving the analytical source term required to satisfy the transport equation for a chosen smooth solution, a foundational skill for developing reliable scientific software. ",
            "id": "4251202",
            "problem": "Consider the one-dimensional steady-state monoenergetic neutron transport equation in slab geometry for the angular flux $\\,\\psi(x,\\mu)\\,$, where $\\,x\\,$ is the spatial coordinate and $\\,\\mu \\in [-1,1]\\,$ is the cosine of the particle flight angle relative to the $\\,x\\,$-axis. The governing equation is the balance of streaming, removal, scattering, and external source, given by\n$$\n\\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_{t}\\,\\psi(x,\\mu) \\;=\\; \\frac{\\Sigma_{s}}{2}\\,\\int_{-1}^{1}\\psi(x,\\mu')\\,\\mathrm{d}\\mu' \\;+\\; Q(x,\\mu),\n$$\nwhere $\\,\\Sigma_{t}  0\\,$ is the constant total macroscopic cross section, $\\,\\Sigma_{s} \\ge 0\\,$ is the constant isotropic scattering macroscopic cross section satisfying $\\,\\Sigma_{s} \\le \\Sigma_{t}\\,$, and $\\,Q(x,\\mu)\\,$ is an externally imposed source. The scalar flux is defined as\n$$\n\\phi(x) \\;=\\; \\int_{-1}^{1}\\psi(x,\\mu')\\,\\mathrm{d}\\mu'.\n$$\nIn the Method of Manufactured Solutions (MMS), one selects a smooth, nontrivial solution $\\,\\psi(x,\\mu)\\,$ and derives the corresponding source term $\\,Q(x,\\mu)\\,$ that makes the chosen $\\,\\psi(x,\\mu)\\,$ satisfy the transport equation exactly. This approach is used to design verification tests for spatial discretization schemes in nuclear reactor simulation.\n\nLet the manufactured angular flux be\n$$\n\\psi(x,\\mu) \\;=\\; \\exp(-a\\,x)\\,\\bigl(1 + b\\,\\mu\\bigr),\n$$\nwith fixed constants $\\,a  0\\,$ and real $\\,b\\,$. Using only the fundamental definitions stated above, derive the closed-form expression for the source term $\\,Q(x,\\mu)\\,$ that must be added so that the transport equation is satisfied exactly for all $\\,x \\in \\mathbb{R}\\,$ and $\\,\\mu \\in [-1,1]\\,$. Express your final answer as a single analytic expression in terms of $\\,a\\,$, $\\,b\\,$, $\\,\\Sigma_{t}\\,$, $\\,\\Sigma_{s}\\,$, $\\,x\\,$, and $\\,\\mu\\,$. Do not include units and do not round; provide the exact expression.",
            "solution": "The problem requires the derivation of a source term, $Q(x,\\mu)$, for the one-dimensional steady-state monoenergetic neutron transport equation, such that a given manufactured solution for the angular flux, $\\psi(x,\\mu)$, is an exact solution. This is a standard procedure in the Method of Manufactured Solutions (MMS).\n\nThe governing transport equation is provided as:\n$$\n\\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_{t}\\,\\psi(x,\\mu) \\;=\\; \\frac{\\Sigma_{s}}{2}\\,\\int_{-1}^{1}\\psi(x,\\mu')\\,\\mathrm{d}\\mu' \\;+\\; Q(x,\\mu)\n$$\nThe scalar flux, $\\phi(x)$, is defined as:\n$$\n\\phi(x) \\;=\\; \\int_{-1}^{1}\\psi(x,\\mu')\\,\\mathrm{d}\\mu'\n$$\nUsing this definition, the transport equation can be written as:\n$$\n\\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_{t}\\,\\psi(x,\\mu) \\;=\\; \\frac{\\Sigma_{s}}{2}\\,\\phi(x) \\;+\\; Q(x,\\mu)\n$$\nTo find the source term $Q(x,\\mu)$, we rearrange the equation:\n$$\nQ(x,\\mu) \\;=\\; \\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_{t}\\,\\psi(x,\\mu) - \\frac{\\Sigma_{s}}{2}\\,\\phi(x)\n$$\nThe manufactured angular flux is given as:\n$$\n\\psi(x,\\mu) \\;=\\; \\exp(-a\\,x)\\,\\bigl(1 + b\\,\\mu\\bigr)\n$$\nwhere $a > 0$ and $b$ are real constants.\n\nOur derivation proceeds by calculating each term on the right-hand side of the expression for $Q(x,\\mu)$ based on the given $\\psi(x,\\mu)$.\n\nFirst, we compute the partial derivative of $\\psi(x,\\mu)$ with respect to the spatial variable $x$:\n$$\n\\frac{\\partial \\psi(x,\\mu)}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\exp(-a\\,x)\\,(1 + b\\,\\mu) \\right]\n$$\nSince $(1 + b\\,\\mu)$ does not depend on $x$, we have:\n$$\n\\frac{\\partial \\psi(x,\\mu)}{\\partial x} = (1 + b\\,\\mu)\\,\\frac{d}{dx}\\left[\\exp(-a\\,x)\\right] = (1 + b\\,\\mu)\\,(-a\\,\\exp(-a\\,x))\n$$\n$$\n\\frac{\\partial \\psi(x,\\mu)}{\\partial x} = -a\\,\\exp(-a\\,x)\\,(1 + b\\,\\mu)\n$$\nTherefore, the streaming term is:\n$$\n\\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} = -a\\,\\mu\\,\\exp(-a\\,x)\\,(1 + b\\,\\mu)\n$$\n\nSecond, the total removal term, $\\Sigma_{t}\\,\\psi(x,\\mu)$, is directly obtained by multiplying the manufactured solution by $\\Sigma_{t}$:\n$$\n\\Sigma_{t}\\,\\psi(x,\\mu) = \\Sigma_{t}\\,\\exp(-a\\,x)\\,(1 + b\\,\\mu)\n$$\n\nThird, we calculate the scalar flux $\\phi(x)$ by integrating $\\psi(x,\\mu')$ over $\\mu' \\in [-1,1]$:\n$$\n\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu')\\,\\mathrm{d}\\mu' = \\int_{-1}^{1} \\exp(-a\\,x)\\,(1 + b\\,\\mu')\\,\\mathrm{d}\\mu'\n$$\nThe term $\\exp(-a\\,x)$ is constant with respect to the integration variable $\\mu'$ and can be factored out:\n$$\n\\phi(x) = \\exp(-a\\,x) \\int_{-1}^{1} (1 + b\\,\\mu')\\,\\mathrm{d}\\mu'\n$$\nEvaluating the integral:\n$$\n\\int_{-1}^{1} (1 + b\\,\\mu')\\,\\mathrm{d}\\mu' = \\left[ \\mu' + \\frac{b\\,(\\mu')^2}{2} \\right]_{-1}^{1} = \\left( 1 + \\frac{b}{2} \\right) - \\left( -1 + \\frac{b}{2} \\right) = 1 + \\frac{b}{2} + 1 - \\frac{b}{2} = 2\n$$\nThus, the scalar flux is:\n$$\n\\phi(x) = 2\\,\\exp(-a\\,x)\n$$\nThe scattering term is then $\\frac{\\Sigma_{s}}{2}\\,\\phi(x)$:\n$$\n\\frac{\\Sigma_{s}}{2}\\,\\phi(x) = \\frac{\\Sigma_{s}}{2}\\,(2\\,\\exp(-a\\,x)) = \\Sigma_{s}\\,\\exp(-a\\,x)\n$$\n\nFinally, we substitute these three components back into the expression for $Q(x,\\mu)$:\n$$\nQ(x,\\mu) = \\left( -a\\,\\mu\\,\\exp(-a\\,x)\\,(1 + b\\,\\mu) \\right) + \\left( \\Sigma_{t}\\,\\exp(-a\\,x)\\,(1 + b\\,\\mu) \\right) - \\left( \\Sigma_{s}\\,\\exp(-a\\,x) \\right)\n$$\nWe can factor out the common term $\\exp(-a\\,x)$:\n$$\nQ(x,\\mu) = \\exp(-a\\,x) \\left[ -a\\,\\mu\\,(1 + b\\,\\mu) + \\Sigma_{t}\\,(1 + b\\,\\mu) - \\Sigma_{s} \\right]\n$$\nExpanding the terms within the brackets:\n$$\nQ(x,\\mu) = \\exp(-a\\,x) \\left[ -a\\,\\mu - a\\,b\\,\\mu^2 + \\Sigma_{t} + \\Sigma_{t}\\,b\\,\\mu - \\Sigma_{s} \\right]\n$$\nGrouping the terms by powers of $\\mu$ provides the final, simplified expression for the source term:\n$$\nQ(x,\\mu) = \\exp(-a\\,x) \\left[ (\\Sigma_{t} - \\Sigma_{s}) + (\\Sigma_{t}\\,b - a)\\,\\mu - a\\,b\\,\\mu^2 \\right]\n$$\nThis is the closed-form expression for the source $Q(x,\\mu)$ that ensures the manufactured flux $\\psi(x,\\mu) = \\exp(-a\\,x)(1 + b\\mu)$ is an exact solution to the transport equation.",
            "answer": "$$\\boxed{\\exp(-a\\,x)\\,\\left[ (\\Sigma_{t} - \\Sigma_{s}) + (\\Sigma_{t}\\,b - a)\\,\\mu - a\\,b\\,\\mu^2 \\right]}$$"
        }
    ]
}