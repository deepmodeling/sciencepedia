{
    "hands_on_practices": [
        {
            "introduction": "将连续的中子输运方程转化为离散的代数方程组是数值求解的核心。有限体积法通过对每个空间网格建立中子平衡方程来实现这一点，确保了粒子守恒。本练习将从第一性原理（高斯散度定理）出发，推导离散形式的泄漏项，并引入迎风格式这一关键概念，这是构建稳定数值格式的基石。",
            "id": "4251181",
            "problem": "考虑一个二维空间中的稳态单能中子输运问题，其角度变量通过离散纵标法（SN）进行离散。令 $\\boldsymbol{\\Omega}_{m}$ 为其中一个离散方向。对于一个三角形控制体 $\\mathcal{T} \\subset \\mathbb{R}^{2}$，其边索引为 $e \\in \\{1,2,3\\}$，令 $\\mathbf{n}_{e}$ 表示边 $e$ 上的单位外法线向量，令 $\\ell_{e}$ 表示边 $e$ 的长度。令 $\\psi_{m}(\\mathbf{x})$ 为方向 $\\boldsymbol{\\Omega}_{m}$ 上的角通量。在标准有限体积法的意义下，假设采用分片常数近似：$\\mathcal{T}$ 内部的单元平均角通量为 $\\,\\psi_{\\mathcal{T},m}\\,$，边 $e$ 上的边平均角通量为 $\\psi_{e,m}$，其值根据相对于 $\\boldsymbol{\\Omega}_{m}$ 的上游值（upwind value）确定（即，流入边使用相邻单元的平均值，流出边使用内部单元的平均值）。\n\n从稳态线性玻尔兹曼输运方程的流项 $\\,\\boldsymbol{\\Omega}_{m} \\cdot \\nabla \\psi_{m}\\,$ 出发，仅使用基本原理（包括散度定理和有限体积控制体平衡），推导在方向 $\\boldsymbol{\\Omega}_{m}$ 上离开 $\\mathcal{T}$ 的净泄漏率的表达式，该表达式应为利用各边的外法线向量对 $\\mathcal{T}$ 的所有边求和的形式。明确展示 $\\,\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}\\,$ 的符号如何决定流入与流出，并通过使用一个标量的正部和负部，将上游选择（upwind selection）整合到一个单一的闭式表达式中。对于任意标量 $a$，你可以定义其正部 $a^{+} \\equiv \\max(a,0)$ 和负部 $a^{-} \\equiv \\min(a,0)$。\n\n请给出净泄漏率 $L_{m}(\\mathcal{T})$ 的最终表达式，该表达式应为一个解析表达式，用 $\\,\\boldsymbol{\\Omega}_{m}$、$\\,\\mathbf{n}_{e}$、$\\,\\ell_{e}$、$\\,\\psi_{\\mathcal{T},m}\\,$ 以及每个流入边 $e$ 的相邻单元平均值 $\\,\\psi_{N(e),m}\\,$ 来表示。最终答案必须是单一的闭式解析表达式。不需要进行数值计算。",
            "solution": "该问题是有效的，因为它具有科学依据、问题明确且客观，代表了数值中子输运理论领域的一个标准推导过程。\n\n对于一个给定的离散方向 $\\boldsymbol{\\Omega}_{m}$，从控制体 $\\mathcal{T}$ 的净泄漏率 $L_{m}(\\mathcal{T})$ 是稳态玻尔兹曼输运方程中流项的体积积分。\n\n我们从流项 $\\boldsymbol{\\Omega}_{m} \\cdot \\nabla \\psi_{m}$ 开始，并将其在二维三角形控制体 $\\mathcal{T}$ 上积分：\n$$\nL_{m}(\\mathcal{T}) = \\int_{\\mathcal{T}} (\\boldsymbol{\\Omega}_{m} \\cdot \\nabla \\psi_{m}) \\, dA\n$$\n由于离散方向 $\\boldsymbol{\\Omega}_{m}$ 是一个常向量，我们可以使用向量恒等式 $\\nabla \\cdot (f \\mathbf{v}) = f(\\nabla \\cdot \\mathbf{v}) + \\mathbf{v} \\cdot \\nabla f$。设 $f = \\psi_m$ 和 $\\mathbf{v} = \\boldsymbol{\\Omega}_m$，并注意到 $\\nabla \\cdot \\boldsymbol{\\Omega}_m = 0$，我们有 $\\boldsymbol{\\Omega}_{m} \\cdot \\nabla \\psi_{m} = \\nabla \\cdot (\\psi_{m} \\boldsymbol{\\Omega}_{m})$。泄漏率积分变为：\n$$\nL_{m}(\\mathcal{T}) = \\int_{\\mathcal{T}} \\nabla \\cdot (\\psi_{m} \\boldsymbol{\\Omega}_{m}) \\, dA\n$$\n我们应用散度定理，在二维情况下，该定理将一个区域上散度的积分与其边界 $\\partial \\mathcal{T}$ 上的线积分联系起来：\n$$\nL_{m}(\\mathcal{T}) = \\oint_{\\partial \\mathcal{T}} (\\psi_{m} \\boldsymbol{\\Omega}_{m}) \\cdot \\mathbf{n} \\, ds\n$$\n其中 $\\mathbf{n}$ 是边界 $\\partial \\mathcal{T}$ 上的单位外法线向量。\n\n三角形控制体的边界 $\\partial \\mathcal{T}$ 由三条直边组成，索引为 $e \\in \\{1, 2, 3\\}$。边界积分可以表示为在这些边上的积分之和：\n$$\nL_{m}(\\mathcal{T}) = \\sum_{e=1}^{3} \\int_{e} (\\psi_{m} \\boldsymbol{\\Omega}_{m}) \\cdot \\mathbf{n}_{e} \\, ds\n$$\n其中 $\\mathbf{n}_{e}$ 是边 $e$ 上的常数单位外法线向量。由于 $\\boldsymbol{\\Omega}_{m}$ 和 $\\mathbf{n}_{e}$ 在每条边上都是常数，它们的点积可以从积分中提出：\n$$\nL_{m}(\\mathcal{T}) = \\sum_{e=1}^{3} (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}) \\int_{e} \\psi_{m}(\\mathbf{x}) \\, ds\n$$\n在有限体积法中，我们使用边平均角通量 $\\psi_{e,m}$，其定义为：\n$$\n\\psi_{e,m} = \\frac{1}{\\ell_{e}} \\int_{e} \\psi_{m}(\\mathbf{x}) \\, ds\n$$\n其中 $\\ell_{e}$ 是边 $e$ 的长度。将此代入泄漏率表达式，我们得到净泄漏率的离散形式：\n$$\nL_{m}(\\mathcal{T}) = \\sum_{e=1}^{3} (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}) \\ell_{e} \\psi_{e,m}\n$$\n问题指定了使用一阶上游格式。边平均通量 $\\psi_{e,m}$ 的值由中子流相对于边的方向决定。标量积 $\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}$ 的符号决定了某条边对于控制体 $\\mathcal{T}$ 是流入边界还是流出边界：\n- 如果 $\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e} > 0$，则中子速度垂直于边的分量朝外。这是一条 **流出** 边。上游近似要求边上的通量由“上游”值决定，即内部单元的平均通量 $\\psi_{\\mathcal{T},m}$。因此，$\\psi_{e,m} = \\psi_{\\mathcal{T},m}$。\n- 如果 $\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}  0$，则中子速度垂直于边的分量朝内。这是一条 **流入** 边。上游近似取自相邻单元的通量 $\\psi_{N(e),m}$。因此，$\\psi_{e,m} = \\psi_{N(e),m}$。\n- 如果 $\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e} = 0$，则流动方向与边平行，该边对净泄漏率没有贡献。\n\n我们可以使用定义的标量 $a$ 的正部 $a^{+} \\equiv \\max(a,0)$ 和负部 $a^{-} \\equiv \\min(a,0)$，将这种上游格式表示为单个表达式。\n令 $C_e = \\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}$。来自边 $e$ 对净泄漏率的贡献是 $C_e \\ell_e \\psi_{e,m}$。\n对于流出边（$C_e > 0$），贡献为 $C_e \\ell_e \\psi_{\\mathcal{T},m}$。这可以写成 $C_e^{+} \\ell_e \\psi_{\\mathcal{T},m}$，因为 $C_e > 0 \\implies C_e^{+} = C_e$ 且 $C_e^{-} = 0$。\n对于流入边（$C_e  0$），贡献为 $C_e \\ell_e \\psi_{N(e),m}$。这可以写成 $C_e^{-} \\ell_e \\psi_{N(e),m}$，因为 $C_e  0 \\implies C_e^{-} = C_e$ 且 $C_e^{+} = 0$。\n总净泄漏率是所有边上这些贡献的总和：\n$$\nL_{m}(\\mathcal{T}) = \\sum_{e=1}^{3} \\left[ (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})^{+} \\ell_{e} \\psi_{\\mathcal{T},m} + (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})^{-} \\ell_{e} \\psi_{N(e),m} \\right]\n$$\n这是一个有效的闭式表达式。然而，我们可以进一步简化它。我们使用恒等式 $a^{+} = a - a^{-}$，其中 $a = \\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}$。将此代入表达式中：\n$$\nL_{m}(\\mathcal{T}) = \\sum_{e=1}^{3} \\left[ \\left((\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e}) - (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})^{-}\\right) \\ell_{e} \\psi_{\\mathcal{T},m} + (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})^{-} \\ell_{e} \\psi_{N(e),m} \\right]\n$$\n重新整理各项：\n$$\nL_{m}(\\mathcal{T}) = \\sum_{e=1}^{3} (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})\\ell_{e}\\psi_{\\mathcal{T},m} + \\sum_{e=1}^{3} (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})^{-} \\ell_{e} \\left( \\psi_{N(e),m} - \\psi_{\\mathcal{T},m} \\right)\n$$\n我们来考察第一项。由于 $\\psi_{\\mathcal{T},m}$ 和 $\\boldsymbol{\\Omega}_{m}$ 对于控制体是常数，我们可以写成：\n$$\n\\sum_{e=1}^{3} (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})\\ell_{e}\\psi_{\\mathcal{T},m} = \\psi_{\\mathcal{T},m} \\left( \\boldsymbol{\\Omega}_{m} \\cdot \\sum_{e=1}^{3} \\mathbf{n}_{e}\\ell_{e} \\right)\n$$\n对于任何闭合体积（在二维中为面积），由表面积（在二维中为边长）缩放的向外法向量的矢量和为零。这是散度定理应用于常数向量场的结果。即 $\\sum_{e=1}^{3} \\mathbf{n}_{e}\\ell_{e} = \\oint_{\\partial\\mathcal{T}} \\mathbf{n} \\, ds = \\mathbf{0}$。\n因此，第一项为零：\n$$\n\\psi_{\\mathcal{T},m} \\left( \\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{0} \\right) = 0\n$$\n这就给我们留下了净泄漏率的简化最终表达式：\n$$\nL_{m}(\\mathcal{T}) = \\sum_{e=1}^{3} (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})^{-} \\ell_{e} (\\psi_{N(e),m} - \\psi_{\\mathcal{T},m})\n$$\n这个简洁的形式表明，单元的净泄漏率是由单元平均通量与流入面上的上游通量之差驱动的，并由投影的流入面积加权。",
            "answer": "$$\n\\boxed{\\sum_{e=1}^{3} (\\boldsymbol{\\Omega}_{m} \\cdot \\mathbf{n}_{e})^{-} \\ell_{e} (\\psi_{N(e),m} - \\psi_{\\mathcal{T},m})}\n$$"
        },
        {
            "introduction": "选择一种空间离散格式后，我们必须深入了解其数值特性和潜在缺陷。菱形差分 (Diamond Difference) 格式因其简洁性和相较于基本格式更高阶的精度而被广泛使用，但它在特定条件下可能产生非物理的结果。本练习将通过一个具体的计算，展示菱形差分格式如何在光学厚度较大的网格中产生负的中子角通量，这对于理解和应用数值方法至关重要。",
            "id": "4251235",
            "problem": "考虑离散纵标法（SN法）中，对于单一纵标方向余弦 $\\,\\mu0\\,$ 的一维均匀板元。角通量 $\\,\\psi(x,\\mu)\\,$ 的稳态、单能输运方程为\n$$\n\\mu\\,\\frac{d\\psi}{dx} + \\Sigma_{t}\\,\\psi = q,\n$$\n其中 $\\,\\Sigma_{t}\\,$ 是总宏观截面，$\\,q\\,$ 是元内的恒定体积角源。设空间元宽度为 $\\,\\Delta x\\,$，左边界位于 $\\,x=0\\,$，具有给定的入射角通量 $\\,\\psi_{L}=\\psi(0,\\mu)\\,$，右边界位于 $\\,x=\\Delta x\\,$，具有未知的出射角通量 $\\,\\psi_{R}=\\psi(\\Delta x,\\mu)\\,$。设元在方向 $\\,\\mu\\,$ 上的光学厚度为 $\\,\\tau \\equiv \\Sigma_{t}\\Delta x/\\mu\\,$。\n\n使用应用于该元上输运方程的菱形差分空间离散格式，计算以下光学厚情形的右边界角通量 $\\,\\psi_{R}\\,$ 和元中心角通量 $\\,\\psi_{c}\\,$：\n- $\\,\\Sigma_{t} = 1\\,\\text{cm}^{-1}\\,$,\n- $\\,\\mu = 0.1\\,$,\n- $\\,\\tau = 20\\,$,\n- $\\,q = 0.2\\,\\text{中子}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}\\,$,\n- $\\,\\psi_{L} = 1\\,\\text{中子}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}\\,$.\n\n给出由菱形差分法计算得到的该元的 $\\,\\psi_{R}\\,$ 和 $\\,\\psi_{c}\\,$ 的值。将每个角通量以 中子 cm$^{-2}$ s$^{-1}$ sr$^{-1}$ 为单位表示，并将您的答案四舍五入到四位有效数字。按 $\\,\\psi_{R}\\,$ 然后 $\\,\\psi_{c}\\,$ 的顺序报告这两个值。",
            "solution": "问题陈述已经过验证，被认为是中子输运数值方法领域中一个适定的、有科学依据的问题。我们可以着手求解。\n\n该问题要求使用菱形差分（DD）空间离散格式，计算一维板元的出射角通量 $\\psi_{R}$ 和元中心角通量 $\\psi_{c}$。控制方程是针对单一方向余弦 $\\mu > 0$ 的稳态、单能输运方程：\n$$\n\\mu\\,\\frac{d\\psi}{dx} + \\Sigma_{t}\\,\\psi = q\n$$\n其中 $\\psi(x,\\mu)$ 是角通量，$\\Sigma_t$ 是恒定的总宏观截面，$\\,q\\,$ 是恒定的体积角源。\n\n菱形差分格式由两个基本方程定义，这两个方程描述了一个宽度为 $\\Delta x$、左边界通量为 $\\psi_L$、右边界通量为 $\\psi_R$ 的空间元。\n\n第一个方程通过对输运方程在元宽度上（从 $x=0$ 到 $x=\\Delta x$）进行积分得到：\n$$\n\\int_{0}^{\\Delta x} \\left( \\mu\\,\\frac{d\\psi}{dx} + \\Sigma_{t}\\,\\psi \\right) dx = \\int_{0}^{\\Delta x} q \\, dx\n$$\n执行积分得到元守恒方程：\n$$\n\\mu\\,[\\psi(\\Delta x) - \\psi(0)] + \\Sigma_{t} \\int_{0}^{\\Delta x} \\psi(x) \\, dx = q\\,\\Delta x\n$$\n在菱形差分格式中，元平均通量 $\\bar{\\psi} = \\frac{1}{\\Delta x} \\int_{0}^{\\Delta x} \\psi(x) \\, dx$ 由元中心通量 $\\psi_{c}$ 近似。使用记法 $\\psi_L = \\psi(0)$ 和 $\\psi_R = \\psi(\\Delta x)$，守恒方程变为：\n$$\n\\mu\\,(\\psi_R - \\psi_L) + \\Sigma_{t}\\,\\psi_{c}\\,\\Delta x = q\\,\\Delta x\n$$\n\n第二个方程是辅助菱形差分关系式，它通过假设元内通量呈线性分布，在代数上将元中心通量与元边界通量联系起来：\n$$\n\\psi_{c} = \\frac{\\psi_L + \\psi_R}{2}\n$$\n\n现在我们得到了一个关于两个未知数 $\\psi_R$ 和 $\\psi_c$ 的线性方程组。我们可以通过将辅助关系式代入守恒方程来求解此方程组：\n$$\n\\mu\\,(\\psi_R - \\psi_L) + \\Sigma_{t}\\,\\left( \\frac{\\psi_L + \\psi_R}{2} \\right)\\,\\Delta x = q\\,\\Delta x\n$$\n为了求解 $\\psi_R$，我们将含有 $\\psi_R$ 的项归并到一起：\n$$\n\\mu\\,\\psi_R + \\frac{\\Sigma_{t}\\,\\Delta x}{2}\\,\\psi_R = q\\,\\Delta x + \\mu\\,\\psi_L - \\frac{\\Sigma_{t}\\,\\Delta x}{2}\\,\\psi_L\n$$\n$$\n\\psi_R\\,\\left( \\mu + \\frac{\\Sigma_{t}\\,\\Delta x}{2} \\right) = q\\,\\Delta x + \\psi_L\\,\\left( \\mu - \\frac{\\Sigma_{t}\\,\\Delta x}{2} \\right)\n$$\n分离出 $\\psi_R$ 得到：\n$$\n\\psi_R = \\frac{q\\,\\Delta x + \\psi_L\\,\\left( \\mu - \\frac{\\Sigma_{t}\\,\\Delta x}{2} \\right)}{\\mu + \\frac{\\Sigma_{t}\\,\\Delta x}{2}}\n$$\n该表达式可以通过将分子和分母同除以 $\\mu$ 来简化：\n$$\n\\psi_R = \\frac{\\frac{q\\,\\Delta x}{\\mu} + \\psi_L\\,\\left( 1 - \\frac{\\Sigma_t\\,\\Delta x}{2\\mu} \\right)}{1 + \\frac{\\Sigma_t\\,\\Delta x}{2\\mu}}\n$$\n问题定义了元的光学厚度为 $\\tau \\equiv \\Sigma_{t}\\Delta x/\\mu$。将 $\\tau$ 代入 $\\psi_R$ 的表达式中：\n$$\n\\psi_R = \\frac{\\frac{q}{\\Sigma_t}\\,\\tau + \\psi_L\\,\\left( 1 - \\frac{\\tau}{2} \\right)}{1 + \\frac{\\tau}{2}}\n$$\n给定值为：\n- $\\Sigma_{t} = 1\\,\\text{cm}^{-1}$\n- $\\mu = 0.1$\n- $\\tau = 20$\n- $q = 0.2\\,\\text{中子}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$\n- $\\psi_{L} = 1\\,\\text{中子}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$\n\n首先，我们计算源与截面之比，$S = q/\\Sigma_t$：\n$$\nS = \\frac{0.2}{1} = 0.2\\,\\text{中子}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}\n$$\n现在我们将数值代入 $\\psi_R$ 的表达式中：\n$$\n\\psi_R = \\frac{(0.2)\\,(20) + (1)\\,\\left( 1 - \\frac{20}{2} \\right)}{1 + \\frac{20}{2}} = \\frac{4 + (1 - 10)}{1 + 10} = \\frac{4 - 9}{11} = -\\frac{5}{11}\n$$\n因此，出射角通量为 $\\psi_R = -5/11$。四舍五入到四位有效数字得到：\n$$\n\\psi_R \\approx -0.4545\\,\\text{中子}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}\n$$\n角通量的负值是一个非物理的结果，但这是将菱形差分格式应用于此光学厚问题时数学上正确的结果。这种现象是该方法的一个已知缺陷，在实际的程序中需要所谓的“菱形差分通量修正”来纠正它。\n\n接下来，我们使用辅助关系式计算元中心通量 $\\psi_c$：\n$$\n\\psi_c = \\frac{\\psi_L + \\psi_R}{2} = \\frac{1 + (-\\frac{5}{11})}{2} = \\frac{\\frac{11}{11} - \\frac{5}{11}}{2} = \\frac{\\frac{6}{11}}{2} = \\frac{3}{11}\n$$\n因此，元中心角通量为 $\\psi_c = 3/11$。四舍五入到四位有效数字得到：\n$$\n\\psi_c \\approx 0.2727\\,\\text{中子}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}\n$$\n所要求的值，四舍五入到四位有效数字后，为 $\\psi_R = -0.4545$ 和 $\\psi_c = 0.2727$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.4545  0.2727 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在将复杂的数值方案编写为计算机程序后，严格的验证是确保其正确性的必要步骤。人造解方法 (Method of Manufactured Solutions, MMS) 是一种强大的代码验证技术。该方法的核心思想是先“制造”一个解析解，将其代入控制方程以反解出相应的源项，然后用此源项运行程序，检查其计算结果是否能精确地复现我们所制造的解。本练习将带你完成MMS中最关键的第一步：为给定的人造解推导必需的源项。",
            "id": "4251202",
            "problem": "考虑平板几何中的一维稳态单能中子输运方程，用于描述角通量 $\\,\\psi(x,\\mu)\\,$，其中 $\\,x\\,$ 是空间坐标，$\\,\\mu \\in [-1,1]\\,$ 是粒子飞行方向相对于 $\\,x\\,$ 轴夹角的余弦。该控制方程是流射、移出、散射和外源的平衡，由下式给出：\n$$\n\\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_{t}\\,\\psi(x,\\mu) \\;=\\; \\frac{\\Sigma_{s}}{2}\\,\\int_{-1}^{1}\\psi(x,\\mu')\\,\\mathrm{d}\\mu' \\;+\\; Q(x,\\mu),\n$$\n其中 $\\,\\Sigma_{t}  0\\,$ 是常数总宏观截面，$\\,\\Sigma_{s} \\ge 0\\,$ 是满足 $\\,\\Sigma_{s} \\le \\Sigma_{t}\\,$ 的常数各向同性散射宏观截面，$\\,Q(x,\\mu)\\,$ 是一个外部施加的源。标量通量定义为\n$$\n\\phi(x) \\;=\\; \\int_{-1}^{1}\\psi(x,\\mu')\\,\\mathrm{d}\\mu'.\n$$\n在人工解方法（Method of Manufactured Solutions, MMS）中，人们选择一个光滑的非平凡解 $\\,\\psi(x,\\mu)\\,$，并推导出相应的源项 $\\,Q(x,\\mu)\\,$，使得所选的 $\\,\\psi(x,\\mu)\\,$ 能精确满足输运方程。这种方法被用于为核反应堆模拟中的空间离散格式设计验证测试。\n\n设人工角通量为\n$$\n\\psi(x,\\mu) \\;=\\; \\exp(-a\\,x)\\,\\bigl(1 + b\\,\\mu\\bigr),\n$$\n其中 $\\,a  0\\,$ 为正常数，$\\,b\\,$ 为实常数。仅使用上述基本定义，推导必须添加的源项 $\\,Q(x,\\mu)\\,$ 的闭式表达式，以使输运方程对所有 $\\,x \\in \\mathbb{R}\\,$ 和 $\\,\\mu \\in [-1,1]\\,$ 都精确满足。请将最终答案表示为关于 $\\,a\\,$、$\\,b\\,$、$\\,\\Sigma_{t}\\,$、$\\,\\Sigma_{s}\\,$、$\\,x\\,$ 和 $\\,\\mu\\,$ 的单个解析表达式。不包含单位，也不要四舍五入；请提供精确表达式。",
            "solution": "该问题要求为一维稳态单能中子输运方程推导一个源项 $Q(x,\\mu)$，使得给定的人工角通量解 $\\psi(x,\\mu)$ 是一个精确解。这是人工解方法（MMS）中的一个标准流程。\n\n给出的控制输运方程为：\n$$\n\\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_{t}\\,\\psi(x,\\mu) \\;=\\; \\frac{\\Sigma_{s}}{2}\\,\\int_{-1}^{1}\\psi(x,\\mu')\\,\\mathrm{d}\\mu' \\;+\\; Q(x,\\mu)\n$$\n标量通量 $\\phi(x)$ 定义为：\n$$\n\\phi(x) \\;=\\; \\int_{-1}^{1}\\psi(x,\\mu')\\,\\mathrm{d}\\mu'\n$$\n使用此定义，输运方程可以写为：\n$$\n\\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_{t}\\,\\psi(x,\\mu) \\;=\\; \\frac{\\Sigma_{s}}{2}\\,\\phi(x) \\;+\\; Q(x,\\mu)\n$$\n为了求出源项 $Q(x,\\mu)$，我们整理该方程：\n$$\nQ(x,\\mu) \\;=\\; \\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_{t}\\,\\psi(x,\\mu) - \\frac{\\Sigma_{s}}{2}\\,\\phi(x)\n$$\n给出的人工角通量为：\n$$\n\\psi(x,\\mu) \\;=\\; \\exp(-a\\,x)\\,\\bigl(1 + b\\,\\mu\\bigr)\n$$\n其中 $a > 0$ 且 $b$ 为实常数。\n\n我们的推导过程是基于给定的 $\\psi(x,\\mu)$，计算 $Q(x,\\mu)$ 表达式右侧的每一项。\n\n首先，我们计算 $\\psi(x,\\mu)$ 对空间变量 $x$ 的偏导数：\n$$\n\\frac{\\partial \\psi(x,\\mu)}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\exp(-a\\,x)\\,(1 + b\\,\\mu) \\right]\n$$\n由于 $(1 + b\\,\\mu)$ 不依赖于 $x$，我们有：\n$$\n\\frac{\\partial \\psi(x,\\mu)}{\\partial x} = (1 + b\\,\\mu)\\,\\frac{d}{dx}\\left[\\exp(-a\\,x)\\right] = (1 + b\\,\\mu)\\,(-a\\,\\exp(-a\\,x))\n$$\n$$\n\\frac{\\partial \\psi(x,\\mu)}{\\partial x} = -a\\,\\exp(-a\\,x)\\,(1 + b\\,\\mu)\n$$\n因此，流射项为：\n$$\n\\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} = -a\\,\\mu\\,\\exp(-a\\,x)\\,(1 + b\\,\\mu)\n$$\n\n其次，总移出项 $\\Sigma_{t}\\,\\psi(x,\\mu)$ 可以通过将人工解乘以 $\\Sigma_{t}$ 直接得到：\n$$\n\\Sigma_{t}\\,\\psi(x,\\mu) = \\Sigma_{t}\\,\\exp(-a\\,x)\\,(1 + b\\,\\mu)\n$$\n\n第三，我们通过将 $\\psi(x,\\mu')$ 在 $\\mu' \\in [-1,1]$ 上积分来计算标量通量 $\\phi(x)$：\n$$\n\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu')\\,\\mathrm{d}\\mu' = \\int_{-1}^{1} \\exp(-a\\,x)\\,(1 + b\\,\\mu')\\,\\mathrm{d}\\mu'\n$$\n项 $\\exp(-a\\,x)$ 相对于积分变量 $\\mu'$ 是常数，可以提出：\n$$\n\\phi(x) = \\exp(-a\\,x) \\int_{-1}^{1} (1 + b\\,\\mu')\\,\\mathrm{d}\\mu'\n$$\n计算该积分：\n$$\n\\int_{-1}^{1} (1 + b\\,\\mu')\\,\\mathrm{d}\\mu' = \\left[ \\mu' + \\frac{b\\,(\\mu')^2}{2} \\right]_{-1}^{1} = \\left( 1 + \\frac{b}{2} \\right) - \\left( -1 + \\frac{b}{2} \\right) = 1 + \\frac{b}{2} + 1 - \\frac{b}{2} = 2\n$$\n因此，标量通量为：\n$$\n\\phi(x) = 2\\,\\exp(-a\\,x)\n$$\n于是散射项为 $\\frac{\\Sigma_{s}}{2}\\,\\phi(x)$：\n$$\n\\frac{\\Sigma_{s}}{2}\\,\\phi(x) = \\frac{\\Sigma_{s}}{2}\\,(2\\,\\exp(-a\\,x)) = \\Sigma_{s}\\,\\exp(-a\\,x)\n$$\n\n最后，我们将这三个分量代回 $Q(x,\\mu)$ 的表达式中：\n$$\nQ(x,\\mu) = \\left( -a\\,\\mu\\,\\exp(-a\\,x)\\,(1 + b\\,\\mu) \\right) + \\left( \\Sigma_{t}\\,\\exp(-a\\,x)\\,(1 + b\\,\\mu) \\right) - \\left( \\Sigma_{s}\\,\\exp(-a\\,x) \\right)\n$$\n我们可以提出公因子 $\\exp(-a\\,x)$：\n$$\nQ(x,\\mu) = \\exp(-a\\,x) \\left[ -a\\,\\mu\\,(1 + b\\,\\mu) + \\Sigma_{t}\\,(1 + b\\,\\mu) - \\Sigma_{s} \\right]\n$$\n展开括号内的各项：\n$$\nQ(x,\\mu) = \\exp(-a\\,x) \\left[ -a\\,\\mu - a\\,b\\,\\mu^2 + \\Sigma_{t} + \\Sigma_{t}\\,b\\,\\mu - \\Sigma_{s} \\right]\n$$\n按 $\\mu$ 的幂次合并各项，得到源项的最终简化表达式：\n$$\nQ(x,\\mu) = \\exp(-a\\,x) \\left[ (\\Sigma_{t} - \\Sigma_{s}) + (\\Sigma_{t}\\,b - a)\\,\\mu - a\\,b\\,\\mu^2 \\right]\n$$\n这就是源 $Q(x,\\mu)$ 的闭式表达式，它确保了人工通量 $\\psi(x,\\mu) = \\exp(-a\\,x)(1 + b\\mu)$ 是输运方程的精确解。",
            "answer": "$$\\boxed{\\exp(-a\\,x)\\,\\left[ (\\Sigma_{t} - \\Sigma_{s}) + (\\Sigma_{t}\\,b - a)\\,\\mu - a\\,b\\,\\mu^2 \\right]}$$"
        }
    ]
}