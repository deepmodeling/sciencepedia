{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个实践旨在奠定理论基础，它在精确的玻尔兹曼输运方程和更具应用价值的 $P_1$ 近似之间架起了一座桥梁。通过从第一性原理推导矩方程，您将巩固对吸收截面 $\\Sigma_a$、输运截面 $\\Sigma_{tr}$ 和扩散系数 $D$ 等关键参数如何从理论中自然产生的理解。这个练习是掌握 $P_1$ 理论与扩散理论关系的第一步 。",
            "id": "4245720",
            "problem": "在一种均匀、无限的单能反应堆材料中，中子遵循稳态玻尔兹曼输运方程，其中角通量 $ \\psi(\\mathbf{r}, \\mathbf{\\Omega}) $ 满足流动、碰撞和散射平衡。微分散射截面展开为勒让德多项式形式 $ \\Sigma_{s}(\\mu) = \\sum_{\\ell=0}^{\\infty} (2\\ell+1)\\,\\Sigma_{s\\ell}\\,P_{\\ell}(\\mu) $，其中 $ \\mu $ 是散射角的余弦，$ \\Sigma_{s\\ell} $ 是散射截面的勒让德矩。定义标量通量 $ \\phi(\\mathbf{r}) = \\int_{4\\pi} \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\, \\mathrm{d}\\mathbf{\\Omega} $ 和中子流 $ \\mathbf{J}(\\mathbf{r}) = \\int_{4\\pi} \\mathbf{\\Omega}\\,\\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\, \\mathrm{d}\\mathbf{\\Omega} $。使用一阶球谐函数(P₁)近似，该近似保留了零阶和一阶角矩，并通过在 $ \\ell = 1 $ 处截断来闭合方程组，请从第一性原理推导输运方程的零阶矩和一阶矩方程，用 $ \\Sigma_{t} $、$ \\Sigma_{s0} $ 和 $ \\Sigma_{s1} $ 表示吸收截面 $ \\Sigma_{a} $ 和输运截面 $ \\Sigma_{tr} $，并说明扩散系数 $ D $ 是如何作为连接 $ \\mathbf{J} $ 和 $ \\nabla \\phi $ 的本构参数出现的。\n\n然后，对于一种特定材料，其总截面 $ \\Sigma_{t} = 1.5\\,\\mathrm{cm}^{-1} $，各向同性散射矩 $ \\Sigma_{s0} = 1.4\\,\\mathrm{cm}^{-1} $，一阶勒让德散射矩 $ \\Sigma_{s1} = 0.7\\,\\mathrm{cm}^{-1} $，计算：\n- 吸收截面 $ \\Sigma_{a} $，\n- 输运截面 $ \\Sigma_{tr} $，以及\n- 基于 P₁ 扩散理论所蕴含的扩散系数 $ D $。\n\n将 $ \\Sigma_{a} $ 和 $ \\Sigma_{tr} $ 以 $ \\mathrm{cm}^{-1} $ 为单位表示，$ D $ 以 $ \\mathrm{cm} $ 为单位表示。将每个量表示为精确值（不要四舍五入）。最终答案必须是一个单一实体，并按 $ (\\Sigma_{a}, \\Sigma_{tr}, D) $ 的顺序列出这三个值。",
            "solution": "该问题要求从玻尔兹曼输运方程的一阶球谐函数($\\mathrm{P}_{1}$)近似推导出单能中子扩散方程，确定关键参数，并随后对特定材料进行计算。\n\n出发点是稳态、单能、无外部源的均匀介质中的中子输运方程，可写为：\n$$\n\\mathbf{\\Omega} \\cdot \\nabla \\psi(\\mathbf{r}, \\mathbf{\\Omega}) + \\Sigma_t \\psi(\\mathbf{r}, \\mathbf{\\Omega}) = \\int_{4\\pi} \\Sigma_s(\\mathbf{\\Omega}' \\to \\mathbf{\\Omega}) \\psi(\\mathbf{r}, \\mathbf{\\Omega}') \\, \\mathrm{d}\\mathbf{\\Omega}'\n$$\n此处，$\\psi(\\mathbf{r}, \\mathbf{\\Omega})$ 是角中子通量，$\\mathbf{\\Omega}$ 是中子运动方向，$\\Sigma_t$ 是宏观总截面，$\\Sigma_s(\\mathbf{\\Omega}' \\to \\mathbf{\\Omega})$ 是从中子方向 $\\mathbf{\\Omega}'$ 散射到 $\\mathbf{\\Omega}$ 的微分散射截面。对于均匀介质，散射核仅取决于散射角的余弦 $\\mu_{0} = \\mathbf{\\Omega} \\cdot \\mathbf{\\Omega}'$。问题给出了其勒让德多项式展开式：\n$$\n\\Sigma_{s}(\\mu_{0}) = \\sum_{\\ell=0}^{\\infty} \\frac{2\\ell+1}{4\\pi} \\Sigma_{s\\ell} P_{\\ell}(\\mu_{0})\n$$\n因子 $1/(4\\pi)$ 是标准的归一化因子。问题陈述中的形式 $\\sum (2\\ell+1)\\Sigma_{s\\ell}P_{\\ell}(\\mu)$ 是对最终方位角积分后的散射核，二者是一致的。\n\n$\\mathrm{P}_{1}$ 近似涉及将角通量展开为球谐函数，并在 $\\ell=1$ 项后截断。这导致了一个关于 $\\mathbf{\\Omega}$ 的线性近似：\n$$\n\\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\approx \\frac{1}{4\\pi} \\phi(\\mathbf{r}) + \\frac{3}{4\\pi} \\mathbf{\\Omega} \\cdot \\mathbf{J}(\\mathbf{r})\n$$\n其中 $\\phi(\\mathbf{r})$ 是标量通量，$\\mathbf{J}(\\mathbf{r})$ 是中子流，它们分别定义为 $\\psi$ 的零阶和一阶角矩：\n$$\n\\phi(\\mathbf{r}) = \\int_{4\\pi} \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\, \\mathrm{d}\\mathbf{\\Omega}\n$$\n$$\n\\mathbf{J}(\\mathbf{r}) = \\int_{4\\pi} \\mathbf{\\Omega} \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\, \\mathrm{d}\\mathbf{\\Omega}\n$$\n\n为了推导矩方程，我们对输运方程取角矩。\n\n**零阶矩方程**\n\n我们将输运方程对所有立体角 $\\mathrm{d}\\mathbf{\\Omega}$ 积分：\n$$\n\\int_{4\\pi} \\mathbf{\\Omega} \\cdot \\nabla \\psi \\, \\mathrm{d}\\mathbf{\\Omega} + \\int_{4\\pi} \\Sigma_t \\psi \\, \\mathrm{d}\\mathbf{\\Omega} = \\int_{4\\pi} \\mathrm{d}\\mathbf{\\Omega} \\int_{4\\pi} \\Sigma_s(\\mu_0) \\psi(\\mathbf{r}, \\mathbf{\\Omega}') \\, \\mathrm{d}\\mathbf{\\Omega}'\n$$\n我们来逐项计算：\n1.  流动项：使用散度定理，$\\int \\mathbf{\\Omega} \\cdot \\nabla \\psi \\, \\mathrm{d}\\mathbf{\\Omega} = \\nabla \\cdot \\int \\mathbf{\\Omega} \\psi \\, \\mathrm{d}\\mathbf{\\Omega} = \\nabla \\cdot \\mathbf{J}(\\mathbf{r})$。\n2.  碰撞项：$\\int \\Sigma_t \\psi \\, \\mathrm{d}\\mathbf{\\Omega} = \\Sigma_t \\int \\psi \\, \\mathrm{d}\\mathbf{\\Omega} = \\Sigma_t \\phi(\\mathbf{r})$。\n3.  散射源项：我们交换积分顺序。\n    $$\n    \\int_{4\\pi} \\psi(\\mathbf{r}, \\mathbf{\\Omega}') \\left( \\int_{4\\pi} \\Sigma_s(\\mu_0) \\, \\mathrm{d}\\mathbf{\\Omega} \\right) \\mathrm{d}\\mathbf{\\Omega}'\n    $$\n    内部积分是 $\\int \\sum_{\\ell=0}^{\\infty} \\frac{2\\ell+1}{4\\pi} \\Sigma_{s\\ell} P_{\\ell}(\\mu_0) \\, \\mathrm{d}\\mathbf{\\Omega}$。由于勒让德多项式的正交性，$\\int_{-1}^{1} P_{\\ell}(\\mu_0) \\mathrm{d}\\mu_0 = 2\\delta_{\\ell 0}$，只有 $\\ell=0$ 的项在积分后保留下来，得到 $\\Sigma_{s0}$。因此，散射源为 $\\int \\psi(\\mathbf{r}, \\mathbf{\\Omega}') \\Sigma_{s0} \\, \\mathrm{d}\\mathbf{\\Omega}' = \\Sigma_{s0} \\phi(\\mathbf{r})$。\n\n合并这些项得到零阶矩方程：\n$$\n\\nabla \\cdot \\mathbf{J}(\\mathbf{r}) + \\Sigma_t \\phi(\\mathbf{r}) = \\Sigma_{s0} \\phi(\\mathbf{r})\n$$\n整理后得到中子平衡方程：\n$$\n\\nabla \\cdot \\mathbf{J}(\\mathbf{r}) + (\\Sigma_t - \\Sigma_{s0}) \\phi(\\mathbf{r}) = 0\n$$\n吸收截面 $\\Sigma_a$ 定义为总截面与总散射截面($\\Sigma_{s0}$)之差。\n$$\n\\Sigma_a = \\Sigma_t - \\Sigma_{s0}\n$$\n因此方程变为 $\\nabla \\cdot \\mathbf{J}(\\mathbf{r}) + \\Sigma_a \\phi(\\mathbf{r}) = 0$。\n\n**一阶矩方程**\n\n我们将输运方程乘以 $\\mathbf{\\Omega}$ 并对所有立体角积分：\n$$\n\\int_{4\\pi} \\mathbf{\\Omega} (\\mathbf{\\Omega} \\cdot \\nabla \\psi) \\, \\mathrm{d}\\mathbf{\\Omega} + \\int_{4\\pi} \\mathbf{\\Omega} (\\Sigma_t \\psi) \\, \\mathrm{d}\\mathbf{\\Omega} = \\int_{4\\pi} \\mathbf{\\Omega} \\left( \\int_{4\\pi} \\Sigma_s(\\mu_0) \\psi(\\mathbf{r}, \\mathbf{\\Omega}') \\, \\mathrm{d}\\mathbf{\\Omega}' \\right) \\mathrm{d}\\mathbf{\\Omega}\n$$\n1.  流动项：$\\int \\mathbf{\\Omega} (\\mathbf{\\Omega} \\cdot \\nabla \\psi) \\, \\mathrm{d}\\mathbf{\\Omega} = \\nabla \\cdot \\int (\\mathbf{\\Omega} \\otimes \\mathbf{\\Omega}) \\psi \\, \\mathrm{d}\\mathbf{\\Omega}$。$\\mathrm{P}_1$ 近似的闭合关系将通量的二阶矩设为各向同性：$\\int (\\mathbf{\\Omega} \\otimes \\mathbf{\\Omega}) \\psi \\, \\mathrm{d}\\mathbf{\\Omega} \\approx \\frac{1}{3}\\phi(\\mathbf{r}) \\mathbf{I}$，其中 $\\mathbf{I}$ 是单位张量。这是将 $\\psi$ 的 $\\mathrm{P}_1$ 展开式代入并使用正交积分 $\\int \\Omega_i \\Omega_j d\\Omega = \\frac{4\\pi}{3}\\delta_{ij}$ 和 $\\int \\Omega_i \\Omega_j \\Omega_k d\\Omega = 0$ 得到的结果。因此，该项变为 $\\nabla \\cdot (\\frac{1}{3}\\phi\\mathbf{I}) = \\frac{1}{3}\\nabla\\phi(\\mathbf{r})$。\n2.  碰撞项：$\\int \\mathbf{\\Omega} (\\Sigma_t \\psi) \\, \\mathrm{d}\\mathbf{\\Omega} = \\Sigma_t \\int \\mathbf{\\Omega} \\psi \\, \\mathrm{d}\\mathbf{\\Omega} = \\Sigma_t \\mathbf{J}(\\mathbf{r})$。\n3.  散射源项：\n    $$\n    \\int_{4\\pi} \\psi(\\mathbf{r}, \\mathbf{\\Omega}') \\left( \\int_{4\\pi} \\mathbf{\\Omega} \\Sigma_s(\\mu_0) \\, \\mathrm{d}\\mathbf{\\Omega} \\right) \\mathrm{d}\\mathbf{\\Omega}'\n    $$\n    内部积分可以通过将 $\\mathbf{\\Omega}'$ 与z轴对齐来计算。其计算结果为 $\\Sigma_{s1}\\mathbf{\\Omega}'$。这是一个由勒让德多项式性质得出的标准结果，其中 $\\int \\mu P_\\ell(\\mu) d\\mu$ 仅在 $\\ell=1$ 时非零。散射项于是变为 $\\int \\psi(\\mathbf{r}, \\mathbf{\\Omega}') \\Sigma_{s1}\\mathbf{\\Omega}' \\, \\mathrm{d}\\mathbf{\\Omega}' = \\Sigma_{s1} \\mathbf{J}(\\mathbf{r})$。\n\n合并这些项得到一阶矩方程：\n$$\n\\frac{1}{3} \\nabla\\phi(\\mathbf{r}) + \\Sigma_t \\mathbf{J}(\\mathbf{r}) = \\Sigma_{s1} \\mathbf{J}(\\mathbf{r})\n$$\n整理以解出中子流 $\\mathbf{J}(\\mathbf{r})$：\n$$\n(\\Sigma_t - \\Sigma_{s1}) \\mathbf{J}(\\mathbf{r}) = -\\frac{1}{3} \\nabla\\phi(\\mathbf{r})\n$$\n$$\n\\mathbf{J}(\\mathbf{r}) = -\\frac{1}{3(\\Sigma_t - \\Sigma_{s1})} \\nabla\\phi(\\mathbf{r})\n$$\n该方程是斐克定律（Fick's Law），一个将中子流 $\\mathbf{J}$ 与标量通量的梯度 $\\nabla\\phi$ 联系起来的本构关系。比例系数就是扩散系数 $D$。\n\n从此推导中，我们确定输运截面 $\\Sigma_{tr}$ 为：\n$$\n\\Sigma_{tr} = \\Sigma_t - \\Sigma_{s1}\n$$\n因此，扩散系数 $D$ 定义为：\n$$\nD = \\frac{1}{3\\Sigma_{tr}} = \\frac{1}{3(\\Sigma_t - \\Sigma_{s1})}\n$$\n\n**数值计算**\n\n问题给出了以下材料属性：\n- 总截面：$\\Sigma_t = 1.5\\,\\mathrm{cm}^{-1}$\n- 各向同性散射矩：$\\Sigma_{s0} = 1.4\\,\\mathrm{cm}^{-1}$\n- 一阶勒让德散射矩：$\\Sigma_{s1} = 0.7\\,\\mathrm{cm}^{-1}$\n\n使用推导出的表达式，我们可以计算所需的量。\n\n1.  **吸收截面 $\\Sigma_a$**：\n    $$\n    \\Sigma_a = \\Sigma_t - \\Sigma_{s0} = 1.5 - 1.4 = 0.1\\,\\mathrm{cm}^{-1}\n    $$\n2.  **输运截面 $\\Sigma_{tr}$**：\n    $$\n    \\Sigma_{tr} = \\Sigma_t - \\Sigma_{s1} = 1.5 - 0.7 = 0.8\\,\\mathrm{cm}^{-1}\n    $$\n3.  **扩散系数 $D$**：\n    $$\n    D = \\frac{1}{3\\Sigma_{tr}} = \\frac{1}{3 \\times 0.8} = \\frac{1}{2.4} = \\frac{1}{24/10} = \\frac{10}{24} = \\frac{5}{12}\\,\\mathrm{cm}\n    $$\n\n精确值为 $\\Sigma_a = 0.1\\,\\mathrm{cm}^{-1}$，$\\Sigma_{tr} = 0.8\\,\\mathrm{cm}^{-1}$，以及 $D = \\frac{5}{12}\\,\\mathrm{cm}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1  0.8  \\frac{5}{12} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理解了介质内部的控制方程之后，正确地模拟边界行为至关重要。本练习聚焦于真空边界——反应堆物理中的一种常见情景 。通过推导作为 $P_1$ 近似基石的马萨克 (Marshak) 边界条件，您将阐明它与扩散理论中更为人熟知的外推边界条件之间的深刻联系。",
            "id": "4245708",
            "problem": "考虑一维平面几何中的稳态单能中子输运，其中空间域 $x \\ge 0$ 被均匀、各向同性散射介质占据，而 $x  0$ 为真空。令 $\\mu$ 表示相对于正 $x$ 轴的方向余弦。在 $x=0$ 处的精确真空输运边界条件规定，从真空进入介质的入射角通量为零，即对于 $\\mu  0$，有 $\\psi(0,\\mu) = 0$。假设在边界处，介质内的角通量在出射到真空的半球上是各向同性的，因此对于 $\\mu  0$，有 $\\psi(0,\\mu) = \\psi_{0}$，其中 $\\psi_{0}$ 是一个正常数。定义标量通量 $\\phi(0) = \\int_{-1}^{1} \\psi(0,\\mu)\\,\\mathrm{d}\\mu$ 和净流 $J(0) = \\int_{-1}^{1} \\mu\\,\\psi(0,\\mu)\\,\\mathrm{d}\\mu$，取 $+x$ 方向为正电流方向。\n\n从角输运边界条件和角矩的定义出发，并仅在边界处使用一阶球谐函数（$P_{1}$）理论闭合关系 $\\psi(0,\\mu) \\approx \\tfrac{1}{2}\\phi(0) + \\tfrac{3}{2}\\mu\\,J(0)$，通过强制要求在此近似下从真空入射的分流为零，来推导 Marshak 真空边界条件。然后，计算此 Marshak 边界条件预测的净流，并将其与根据所述各向同性出射分布得到的精确输运净流进行比较。最后，对于给定的在边界处具有各向同性出射的半空间，表示净流的相对误差，\n$$\\epsilon \\equiv \\frac{J_{\\mathrm{Marshak}}(0) - J_{\\mathrm{exact}}(0)}{J_{\\mathrm{exact}}(0)},$$\n你的最终答案必须是一个实数。不需要四舍五入。在你的推理过程中，通过阐述 Marshak 条件如何通过菲克定律 $J(0) = -D\\,\\frac{\\partial \\phi}{\\partial x}\\big|_{x=0}$（其中 $D$ 是扩散系数）转换为扩散理论的边界条件，来将 $P_{1}$ 理论与扩散理论联系起来，但除了已声明的定义和闭合关系外，不要使用任何快捷公式。",
            "solution": "我们首先陈述在 $x=0$ 处的精确输运真空边界条件：\n$$\\psi(0,\\mu) = 0 \\quad \\text{for} \\quad \\mu  0.$$\n根据假设，在边界处，内部角通量在出射半球（$\\mu  0$）上是各向同性的，且等于一个常数 $\\psi_{0}$。因此，边界角通量为\n$$\\psi(0,\\mu) = \\begin{cases}\n\\psi_{0},  \\mu  0, \\\\\n0,  \\mu  0.\n\\end{cases}$$\n使用此条件，由精确输运理论得到的边界处的标量通量和净流为\n$$\\phi(0) = \\int_{-1}^{1} \\psi(0,\\mu)\\,\\mathrm{d}\\mu = \\int_{-1}^{0} \\psi_{0}\\,\\mathrm{d}\\mu + \\int_{0}^{1} 0\\,\\mathrm{d}\\mu = \\psi_{0}\\,(0 - (-1)) = \\psi_{0},$$\n和\n\\begin{align*}\nJ_{\\mathrm{exact}}(0) = \\int_{-1}^{1} \\mu\\,\\psi(0,\\mu)\\,\\mathrm{d}\\mu = \\int_{-1}^{0} \\mu\\,\\psi_{0}\\,\\mathrm{d}\\mu + \\int_{0}^{1} \\mu\\cdot 0\\,\\mathrm{d}\\mu \\\\\n= \\psi_{0}\\,\\left[\\frac{\\mu^{2}}{2}\\right]_{-1}^{0} = \\psi_{0}\\,\\left(0 - \\frac{1}{2}\\right) = -\\frac{1}{2}\\,\\psi_{0}.\n\\end{align*}\n因此，在所述的各向同性出射条件下，就标量通量而言，边界处的精确关系为\n$$J_{\\mathrm{exact}}(0) = -\\frac{1}{2}\\,\\phi(0).$$\n\n我们现在转向边界角通量的一阶球谐函数（$P_{1}$）近似。$P_{1}$ 闭合关系将角通量写为\n$$\\psi(0,\\mu) \\approx \\frac{1}{2}\\,\\phi(0) + \\frac{3}{2}\\,\\mu\\,J(0),$$\n其中 $\\phi(0) = \\int_{-1}^{1}\\psi(0,\\mu)\\,\\mathrm{d}\\mu$ 和 $J(0) = \\int_{-1}^{1}\\mu\\,\\psi(0,\\mu)\\,\\mathrm{d}\\mu$ 分别是零阶和一阶角矩。为了在此近似下推导 Marshak 真空边界条件，我们强制要求从真空入射的分流为零。相对于 $x=0$ 处的介质，入射半球为 $\\mu  0$，因此入射分流为\n$$J^{+}(0) \\equiv \\int_{0}^{1} \\mu\\,\\psi(0,\\mu)\\,\\mathrm{d}\\mu.$$\n真空边界条件意味着 $J^{+}(0) = 0$。代入 $P_{1}$ 表示式，\n\\begin{align*}\nJ^{+}(0) = \\int_{0}^{1} \\mu\\,\\left(\\frac{1}{2}\\,\\phi(0) + \\frac{3}{2}\\,\\mu\\,J(0)\\right)\\,\\mathrm{d}\\mu \\\\\n= \\frac{1}{2}\\,\\phi(0)\\,\\int_{0}^{1}\\mu\\,\\mathrm{d}\\mu + \\frac{3}{2}\\,J(0)\\,\\int_{0}^{1}\\mu^{2}\\,\\mathrm{d}\\mu \\\\\n= \\frac{1}{2}\\,\\phi(0)\\,\\left[\\frac{\\mu^{2}}{2}\\right]_{0}^{1} + \\frac{3}{2}\\,J(0)\\,\\left[\\frac{\\mu^{3}}{3}\\right]_{0}^{1} \\\\\n= \\frac{1}{2}\\,\\phi(0)\\,\\left(\\frac{1}{2}\\right) + \\frac{3}{2}\\,J(0)\\,\\left(\\frac{1}{3}\\right) \\\\\n= \\frac{1}{4}\\,\\phi(0) + \\frac{1}{2}\\,J(0).\n\\end{align*}\n令 $J^{+}(0) = 0$ 得到 Marshak 真空边界条件：\n$$\\frac{1}{4}\\,\\phi(0) + \\frac{1}{2}\\,J(0) = 0 \\quad \\Longrightarrow \\quad J_{\\mathrm{Marshak}}(0) = -\\frac{1}{2}\\,\\phi(0).$$\n\n因此，在所述的各向同性出射分布下，我们有\n$$J_{\\mathrm{Marshak}}(0) = -\\frac{1}{2}\\,\\phi(0) = -\\frac{1}{2}\\,\\psi_{0}, \\quad J_{\\mathrm{exact}}(0) = -\\frac{1}{2}\\,\\psi_{0}.$$\n因此，净流的相对误差为\n\\begin{align*}\n\\epsilon = \\frac{J_{\\mathrm{Marshak}}(0) - J_{\\mathrm{exact}}(0)}{J_{\\mathrm{exact}}(0)} = \\frac{\\left(-\\frac{1}{2}\\,\\psi_{0}\\right) - \\left(-\\frac{1}{2}\\,\\psi_{0}\\right)}{-\\frac{1}{2}\\,\\psi_{0}} = \\frac{0}{-\\frac{1}{2}\\,\\psi_{0}} = 0.\n\\end{align*}\n\n最后，我们将 $P_{1}$ 理论与扩散理论联系起来。在扩散近似中，菲克定律将净流与标量通量的梯度联系起来：\n$$J(0) = -D\\,\\frac{\\partial \\phi}{\\partial x}\\Big|_{x=0},$$\n其中 $D$ 是扩散系数。将 Marshak 关系 $J(0) = -\\frac{1}{2}\\,\\phi(0)$ 代入菲克定律，得到平面上的标准扩散理论真空边界条件：\n$$-\\frac{1}{2}\\,\\phi(0) = -D\\,\\frac{\\partial \\phi}{\\partial x}\\Big|_{x=0} \\quad \\Longrightarrow \\quad \\phi(0) + 2D\\,\\frac{\\partial \\phi}{\\partial x}\\Big|_{x=0} = 0.$$\n这表明了基于 $P_{1}$ 的 Marshak 边界条件如何引出经典的扩散边界条件，并且对于边界处指定的各向同性出射分布，它以零误差再现了精确的输运净流。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "我们最后的实践将从理想化情景转向更真实的工程应用。通过分析一个由两种不同材料（例如慢化剂和燃料）组成的非均匀系统，您将能够量化各向异性散射对中子行为的实际影响 。这个计算练习突显了 $P_1$ 模型与简化扩散模型之间的差异，并强调了在何种情况下，$P_1$ 理论所增加的复杂性对于获得精确预测是必不可少的。",
            "id": "4245721",
            "problem": "考虑一个由两个相邻均匀区域组成的稳态、单能、一维（$1$-D）平板：一个慢化剂（$x \\in [-L_1,0]$）和一个燃料区（$x \\in [0,L_2]$）。中子输运采用一阶球谐函数（P$_1$）近似，并考虑相应的扩散理论。目标是比较 P$_1$ 理论预测的界面（$x=0$）处的中子流与忽略散射各向异性的扩散理论的预测结果，并针对给定的截面量化其差异。\n\n基本原理和建模假设：\n- 从稳态中子输运方程及其针对各向同性外源和潜在的各向异性散射的 P$_1$（一阶球谐函数）矩截断出发。标准的矩方程为：\n  $$\\nabla \\cdot \\mathbf{J} + \\Sigma_a \\,\\phi = S,$$\n  $$\\frac{1}{3}\\nabla \\phi + \\Sigma_{\\text{tr}}\\,\\mathbf{J} = \\mathbf{0},$$\n  其中，$S$ 是均匀体源，$\\phi$ 是标量通量，$\\mathbf{J}$ 是中子流密度，$\\Sigma_a$ 是吸收截面，$\\Sigma_{\\text{tr}}$ 是输运截面。对于一维平板几何，$\\nabla \\to \\frac{d}{dx}$。在 P$_1$ 近似下，得到菲克定律：\n  $$\\mathbf{J} = -D_{\\text{P1}}\\,\\nabla \\phi, \\quad D_{\\text{P1}} = \\frac{1}{3\\,\\Sigma_{\\text{tr}}}, \\quad \\Sigma_{\\text{tr}} = \\Sigma_t - \\Sigma_{s,1},$$\n  其中 $\\Sigma_t$ 是总截面，$\\Sigma_{s,1}$ 是散射截面的一阶勒让德矩。吸收截面为\n  $$\\Sigma_a = \\Sigma_t - \\Sigma_{s,0},$$\n  其中 $\\Sigma_{s,0}$ 是散射截面的零阶勒让德矩。\n- 为了揭示 P$_1$ 和扩散理论之间的关系，还考虑一个忽略散射各向异性的扩散模型，其使用\n  $$D_{\\text{diff}} = \\frac{1}{3\\,\\Sigma_t}.$$\n- 在每个均匀区域 $i \\in \\{1,2\\}$ 中，最终的控制扩散方程为\n  $$-D_i\\,\\frac{d^2 \\phi_i}{dx^2} + \\Sigma_{a,i}\\,\\phi_i = S_i,$$\n  在外部边界上采用 Marshak 真空边界条件：\n  $$\\phi_1(-L_1) + 2\\,D_1\\,\\frac{d\\phi_1}{dx}\\bigg|_{x=-L_1} = 0,\\quad \\phi_2(L_2) - 2\\,D_2\\,\\frac{d\\phi_2}{dx}\\bigg|_{x=L_2} = 0,$$\n  以及在 $x=0$ 处的界面条件：\n  $$\\phi_1(0) = \\phi_2(0),\\quad J_1(0) = J_2(0),\\quad \\text{其中 } J_i(x) = -D_i\\,\\frac{d\\phi_i}{dx}.$$\n\n需要实现的解析结构：\n- 在每个区域 $i$ 中，对于常数 $D_i$、$\\Sigma_{a,i}$ 和 $S_i$，定义\n  $$k_i = \\sqrt{\\frac{\\Sigma_{a,i}}{D_i}},\\quad \\phi_{p,i} = \\frac{S_i}{\\Sigma_{a,i}},$$\n  并将以界面 $x=0$ 为中心的通解写为\n  $$\\phi_i(x) = A_i\\,\\cosh(k_i x) + B_i\\,\\sinh(k_i x) + \\phi_{p,i}.$$\n- 界面条件意味着\n  $$A_2 = A_1 + (\\phi_{p,1} - \\phi_{p,2}),\\quad B_2 = \\frac{D_1\\,k_1}{D_2\\,k_2}\\,B_1.$$\n- 边界条件产生一个关于 $A_1$ 和 $B_1$ 的线性系统：\n  $$\\big[c_1 - 2 D_1 k_1 s_1\\big]\\,A_1 + \\big[-s_1 + 2 D_1 k_1 c_1\\big]\\,B_1 + \\phi_{p,1} = 0,$$\n  $$\\big[c_2 - 2 D_2 k_2 s_2\\big]\\,(A_1 + \\Delta \\phi_p) + \\left[s_2 - 2 D_2 k_2 c_2\\right]\\left(\\frac{D_1 k_1}{D_2 k_2} B_1\\right) + \\phi_{p,2} = 0,$$\n  其中 $c_i = \\cosh(k_i L_i)$，$s_i = \\sinh(k_i L_i)$，以及 $\\Delta \\phi_p = \\phi_{p,1} - \\phi_{p,2}$。\n- 求解 $A_1$ 和 $B_1$；则界面流为\n  $$J(0) = -D_1\\,\\frac{d\\phi_1}{dx}\\bigg|_{x=0} = -D_1\\,k_1\\,B_1.$$\n\n您必须实现两种界面流的预测：\n- P$_1$ 预测，使用 $D_{\\text{P1},i} = \\frac{1}{3(\\Sigma_{t,i} - \\Sigma_{s,1,i})}$。\n- 忽略各向异性的扩散预测，使用 $D_{\\text{diff},i} = \\frac{1}{3\\Sigma_{t,i}}$。\n\n对于下面的每个测试用例，计算差值\n$$\\Delta J = J_{\\text{P1}}(0) - J_{\\text{diff}}(0),$$\n以中子数/平方厘米/秒（$\\mathrm{n}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$）为单位表示，并四舍五入到 $6$ 位小数。\n\n测试套件（所有截面单位为 $\\mathrm{cm}^{-1}$，长度单位为 $\\mathrm{cm}$，源单位为 $\\mathrm{n}\\,\\mathrm{cm}^{-3}\\,\\mathrm{s}^{-1}$）：\n- 用例 1（慢化剂具有大 $D$ 值，燃料具有小 $D$ 值，慢化剂中的各向异性散射显著）：\n  - 慢化剂：$\\Sigma_{t,1} = 1.2$，$\\Sigma_{s,0,1} = 1.1$，$\\Sigma_{s,1,1} = 0.7$，$S_1 = 0.5$，$L_1 = 10$。\n  - 燃料：$\\Sigma_{t,2} = 2.5$，$\\Sigma_{s,0,2} = 2.2$，$\\Sigma_{s,1,2} = 0.1$，$S_2 = 0.0$，$L_2 = 5$。\n- 用例 2（两个区域中均为近各向同性散射；作为两种预测重合时的边界条件检查）：\n  - 慢化剂：$\\Sigma_{t,1} = 1.5$，$\\Sigma_{s,0,1} = 1.3$，$\\Sigma_{s,1,1} = 0.0$，$S_1 = 0.4$，$L_1 = 8$。\n  - 燃料：$\\Sigma_{t,2} = 2.0$，$\\Sigma_{s,0,2} = 1.8$，$\\Sigma_{s,1,2} = 0.0$，$S_2 = 0.0$，$L_2 = 6$。\n- 用例 3（慢化剂中存在极端各向异性，燃料层较薄；$D$ 值对比强烈）：\n  - 慢化剂：$\\Sigma_{t,1} = 0.8$，$\\Sigma_{s,0,1} = 0.75$，$\\Sigma_{s,1,1} = 0.74$，$S_1 = 0.1$，$L_1 = 20$。\n  - 燃料：$\\Sigma_{t,2} = 3.0$，$\\Sigma_{s,0,2} = 2.7$，$\\Sigma_{s,1,2} = 0.2$，$S_2 = 0.0$，$L_2 = 2$。\n- 用例 4（中等各向异性，两个区域均有源；检查双向驱动）：\n  - 慢化剂：$\\Sigma_{t,1} = 1.0$，$\\Sigma_{s,0,1} = 0.9$，$\\Sigma_{s,1,1} = 0.2$，$S_1 = 0.2$，$L_1 = 12$。\n  - 燃料：$\\Sigma_{t,2} = 2.2$，$\\Sigma_{s,0,2} = 2.0$，$\\Sigma_{s,1,2} = 0.15$，$S_2 = 0.1$，$L_2 = 7$。\n\n验证目标：\n- 科学真实性：截面确保 $\\Sigma_{a,i} = \\Sigma_{t,i} - \\Sigma_{s,0,i}  0$。\n- 两种模型具有相同的控制方程形式，但在 $D_i$ 上有所不同，这揭示了各向异性散射如何影响扩散系数，并因此影响界面流。\n- 输出单位必须是 $\\mathrm{n}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$，并四舍五入到 $6$ 位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 是用例 $i$ 的 $\\Delta J$ 值。",
            "solution": "所述问题在科学上是合理的、自洽的且适定的。它基于中子输运和扩散理论的既定原理，提供了构建和求解所需量所需的所有数据和方程。参数是物理上现实的，问题设置构成了反应堆物理中一个标准的双区域边值问题。因此，该问题是有效的，并且可以推导出解。\n\n问题的核心是在双区域平板几何中求解一维稳态中子扩散方程，然后比较两种不同扩散系数模型预测的界面中子流。\n\n每个均匀区域 $i \\in \\{1, 2\\}$ 中的控制方程是带常数源项 $S_i$ 的一维扩散方程：\n$$ -D_i\\,\\frac{d^2 \\phi_i}{dx^2} + \\Sigma_{a,i}\\,\\phi_i = S_i $$\n其中 $\\phi_i(x)$ 是标量中子通量，$D_i$ 是扩散系数，$\\Sigma_{a,i}$ 是宏观吸收截面。吸收截面由 $\\Sigma_{a,i} = \\Sigma_{t,i} - \\Sigma_{s,0,i}$ 给出，其中 $\\Sigma_{t,i}$ 是总截面，$\\Sigma_{s,0,i}$ 是散射截面的零阶勒让德矩（即总散射截面）。\n\n该问题要求比较两种关于扩散系数 $D_i$ 的模型：\n1.  P$_1$（一阶球谐函数）模型，该模型考虑了线性各向异性散射：\n    $$ D_{\\text{P1},i} = \\frac{1}{3\\Sigma_{\\text{tr},i}} = \\frac{1}{3(\\Sigma_{t,i} - \\Sigma_{s,1,i})} $$\n    其中 $\\Sigma_{s,1,i}$ 是散射截面的一阶勒让德矩。\n\n2.  一个简化的扩散模型，该模型忽略了散射的各向异性，实际上是假设在实验室坐标系中散射是各向同性的：\n    $$ D_{\\text{diff},i} = \\frac{1}{3\\Sigma_{t,i}} $$\n\n控制微分方程在区域 $i$ 的通解可以写成齐次解和特解之和。将方程重排为 $\\frac{d^2 \\phi_i}{dx^2} - \\frac{\\Sigma_{a,i}}{D_i}\\phi_i = -\\frac{S_i}{D_i}$，我们定义扩散长度 $L_{D,i} = 1/k_i = \\sqrt{D_i/\\Sigma_{a,i}}$。对于常数源，特解为 $\\phi_{p,i} = S_i/\\Sigma_{a,i}$。通解为：\n$$ \\phi_i(x) = C_{i,1} e^{k_i x} + C_{i,2} e^{-k_i x} + \\phi_{p,i} $$\n其中 $k_i = \\sqrt{\\Sigma_{a,i}/D_i}$。对于界面在 $x=0$ 的双区域问题，为了代数上的方便，将解表示为以界面为中心的双曲函数形式：\n$$ \\phi_i(x) = A_i \\cosh(k_i x) + B_i \\sinh(k_i x) + \\phi_{p,i} $$\n\n四个未知系数（$A_1, B_1, A_2, B_2$）由一组四个边界和界面条件确定。\n\n在 $x=0$ 处的界面条件强制标量通量和中子流 $J(x) = -D\\frac{d\\phi}{dx}$ 的连续性：\n1.  $\\phi_1(0) = \\phi_2(0) \\implies A_1 + \\phi_{p,1} = A_2 + \\phi_{p,2} \\implies A_2 = A_1 + (\\phi_{p,1} - \\phi_{p,2})$\n2.  $J_1(0) = J_2(0) \\implies -D_1 \\frac{d\\phi_1}{dx}\\bigg|_{x=0} = -D_2 \\frac{d\\phi_2}{dx}\\bigg|_{x=0}$\n    由于 $\\frac{d\\phi_i}{dx}\\big|_{x=0} = B_i k_i$，这给出 $-D_1 B_1 k_1 = -D_2 B_2 k_2 \\implies B_2 = \\frac{D_1 k_1}{D_2 k_2} B_1$。\n\n在 $x=-L_1$ 和 $x=L_2$ 处的外部边界与真空相邻，对此问题指定了 Marshak 边界条件：\n3.  在 $x=-L_1$ 处：$\\phi_1(-L_1) + 2D_1 \\frac{d\\phi_1}{dx}\\big|_{x=-L_1} = 0$。\n    代入 $\\phi_1(x)$ 的解：\n    $$ A_1 \\cosh(-k_1 L_1) + B_1 \\sinh(-k_1 L_1) + \\phi_{p,1} + 2D_1 (A_1 k_1 \\sinh(-k_1 L_1) + B_1 k_1 \\cosh(-k_1 L_1)) = 0 $$\n    使用 $\\cosh(-z)=\\cosh(z)$ 和 $\\sinh(-z)=-\\sinh(z)$，并定义 $c_1=\\cosh(k_1 L_1)$ 和 $s_1=\\sinh(k_1 L_1)$：\n    $$ (c_1 - 2D_1 k_1 s_1)A_1 + (-s_1 + 2D_1 k_1 c_1)B_1 + \\phi_{p,1} = 0 $$\n\n4.  在 $x=L_2$ 处：$\\phi_2(L_2) - 2D_2 \\frac{d\\phi_2}{dx}\\big|_{x=L_2} = 0$。\n    代入 $\\phi_2(x)$ 的解：\n    $$ A_2 \\cosh(k_2 L_2) + B_2 \\sinh(k_2 L_2) + \\phi_{p,2} - 2D_2 (A_2 k_2 \\sinh(k_2 L_2) + B_2 k_2 \\cosh(k_2 L_2)) = 0 $$\n    设 $c_2=\\cosh(k_2 L_2)$ 和 $s_2=\\sinh(k_2 L_2)$：\n    $$ (c_2 - 2D_2 k_2 s_2)A_2 + (s_2 - 2D_2 k_2 c_2)B_2 + \\phi_{p,2} = 0 $$\n\n我们将 $A_2$ 和 $B_2$ 的表达式代入第四个方程：\n$$ (c_2 - 2D_2 k_2 s_2)(A_1 + \\phi_{p,1} - \\phi_{p,2}) + (s_2 - 2D_2 k_2 c_2)\\left(\\frac{D_1 k_1}{D_2 k_2} B_1\\right) + \\phi_{p,2} = 0 $$\n\n这产生了一个关于系数 $A_1$ 和 $B_1$ 的 $2 \\times 2$ 线性系统：\n$$ \\mathbf{M} \\begin{pmatrix} A_1 \\\\ B_1 \\end{pmatrix} = \\mathbf{R} $$\n其中矩阵 $\\mathbf{M}$ 和向量 $\\mathbf{R}$ 定义为：\n$$\nM_{11} = c_1 - 2D_1 k_1 s_1 \\\\\nM_{12} = -s_1 + 2D_1 k_1 c_1 \\\\\nM_{21} = c_2 - 2D_2 k_2 s_2 \\\\\nM_{22} = \\left(\\frac{D_1 k_1}{D_2 k_2}\\right) (s_2 - 2D_2 k_2 c_2)\n$$\n$$\nR_1 = -\\phi_{p,1} \\\\\nR_2 = -(c_2 - 2D_2 k_2 s_2)(\\phi_{p,1} - \\phi_{p,2}) - \\phi_{p,2}\n$$\n可以求解这个线性系统得到 $A_1$ 和 $B_1$。我们感兴趣的量是界面处的中子流 $J(0)$，它由系数 $B_1$ 决定：\n$$ J(0) = J_1(0) = -D_1 \\frac{d\\phi_1}{dx}\\bigg|_{x=0} = -D_1 (B_1 k_1 \\cosh(0)) = -D_1 k_1 B_1 $$\n\n计算步骤如下：\n对于每个测试用例和两种模型（P$_1$ 和简化扩散）中的每一种：\n1.  计算每个区域 $i$ 的材料属性：$\\Sigma_{a,i}$、$D_i$、$k_i$ 和 $\\phi_{p,i}$。\n2.  组装矩阵 $\\mathbf{M}$ 和向量 $\\mathbf{R}$ 的分量。\n3.  求解线性系统 $\\mathbf{M} \\mathbf{x} = \\mathbf{R}$ 以得到 $\\mathbf{x} = [A_1, B_1]^T$。\n4.  提取系数 $B_1$。\n5.  计算界面流 $J(0) = -D_1 k_1 B_1$。\n\n此过程产生界面流 $J_{\\text{P1}}(0)$ 和 $J_{\\text{diff}}(0)$。要求的输出是它们的差值 $\\Delta J = J_{\\text{P1}}(0) - J_{\\text{diff}}(0)$。实现将遵循此已确立的解析解。",
            "answer": "[0.038481,0.000000,-0.000490,-0.001648]"
        }
    ]
}