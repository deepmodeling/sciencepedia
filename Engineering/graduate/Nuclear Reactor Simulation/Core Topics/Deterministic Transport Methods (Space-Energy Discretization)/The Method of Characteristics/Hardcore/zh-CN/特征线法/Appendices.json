{
    "hands_on_practices": [
        {
            "introduction": "特征线法（Method of Characteristics, MOC）将复杂的积分-微分形式的输运方程，简化为沿特定粒子路径（即“特征线”）的一组常微分方程。此方法中的一个基本概念是光学厚度 $\\tau$，它量化了粒子沿某路径段发生相互作用的总概率。本练习将通过追踪一条穿过多介质区域的特征线，训练计算光学厚度的基本技能，这是任何MOC程序实现都不可或缺的核心步骤。",
            "id": "4255876",
            "problem": "在使用特征线法 (MOC) 进行的稳态、单能中子输运模拟中，一个二维矩形区域的范围为 $x \\in [0, 4] \\, \\mathrm{cm}$ 和 $y \\in [0, 3] \\, \\mathrm{cm}$。该区域在 $x = 1.25 \\, \\mathrm{cm}$ 处被一个垂直界面划分为两种材料。在区域 $x  1.25 \\, \\mathrm{cm}$ 内的材料的总宏观截面为 $\\Sigma_{t,1} = 0.8 \\, \\mathrm{cm}^{-1}$，而在区域 $x \\ge 1.25 \\, \\mathrm{cm}$ 内的材料的总宏观截面为 $\\Sigma_{t,2} = 2.2 \\, \\mathrm{cm}^{-1}$。\n\n考虑一条特征线，它从左边界点 $(x_0, y_0) = (0, 0.6) \\, \\mathrm{cm}$ 进入该区域，其单位方向矢量为 $\\boldsymbol{\\Omega} = \\left( \\frac{3}{5}, \\frac{4}{5} \\right)$。该特征线继续行进，直至离开该区域。\n\n使用沿特征线投影的稳态、单能线性玻尔兹曼方程 (LBE) 以及光学厚度定义为总宏观截面沿特征线路径的积分，确定该特征线从进入到离开所累积的总光学厚度。假设材料是分区均匀的，并且特征线与材料界面相交后，在边界处离开，期间没有发生反射或散射引起的路径改变。\n\n将最终答案表示为一个无量纲值，并四舍五入到五位有效数字。",
            "solution": "该问题要求计算一个中子射线穿过一个二维、双材料区域时所累积的总光学厚度。光学厚度 $\\tau$ 定义为总宏观截面 $\\Sigma_t$ 沿着该射线特征路径的路径积分。对于由路径长度 $s$ 参数化的路径，其表达式为：\n$$\n\\tau = \\int_{path} \\Sigma_t(\\mathbf{r}(s)) \\, ds\n$$\n其中 $\\mathbf{r}(s)$ 是沿射线路径的位置矢量。\n\n首先，我们建立该射线路径的参数方程。该射线从初始点 $\\mathbf{r}_0 = (x_0, y_0) = (0, 0.6) \\, \\mathrm{cm}$ 进入，并沿着单位矢量 $\\boldsymbol{\\Omega} = (\\Omega_x, \\Omega_y) = \\left( \\frac{3}{5}, \\frac{4}{5} \\right)$ 的方向行进。距离入口点路径长度为 $s$ 时的位置矢量 $\\mathbf{r}(s) = (x(s), y(s))$ 由下式给出：\n$$\n\\mathbf{r}(s) = \\mathbf{r}_0 + s \\boldsymbol{\\Omega}\n$$\n其分量方程为：\n$$\nx(s) = x_0 + s \\Omega_x = 0 + s \\left(\\frac{3}{5}\\right) = \\frac{3}{5}s\n$$\n$$\ny(s) = y_0 + s \\Omega_y = 0.6 + s \\left(\\frac{4}{5}\\right) = \\frac{3}{5} + \\frac{4}{5}s\n$$\n该区域是一个由 $x \\in [0, 4]$ 和 $y \\in [0, 3]$ 定义的矩形。它被 $x_I = 1.25 \\, \\mathrm{cm}$ 处的垂直界面分为两个材料区域。\n区域 1：$0 \\le x  1.25 \\, \\mathrm{cm}$，总截面为 $\\Sigma_{t,1} = 0.8 \\, \\mathrm{cm}^{-1}$。\n区域 2：$1.25 \\le x \\le 4 \\, \\mathrm{cm}$，总截面为 $\\Sigma_{t,2} = 2.2 \\, \\mathrm{cm}^{-1}$。\n\n由于截面是分段常数，光学厚度的积分可以分解为在每个材料区域中路径段的求和：\n$$\n\\tau = \\tau_1 + \\tau_2 = \\Sigma_{t,1} \\Delta s_1 + \\Sigma_{t,2} \\Delta s_2\n$$\n其中 $\\Delta s_1$ 和 $\\Delta s_2$ 分别是射线在区域 1 和区域 2 中的路径长度。\n\n我们必须通过找到射线与材料界面和区域边界的交点来确定其路径。\n\n1.  找到与材料界面 $x_I = 1.25 \\, \\mathrm{cm}$ 的交点。\n    设 $s_1$ 为从入口点到该界面的路径长度。我们令 $x(s_1) = 1.25$：\n    $$\n    \\frac{3}{5}s_1 = 1.25 = \\frac{5}{4}\n    $$\n    解出 $s_1$：\n    $$\n    s_1 = \\frac{5}{4} \\times \\frac{5}{3} = \\frac{25}{12} \\, \\mathrm{cm}\n    $$\n    区域 1 中的路径长度为 $\\Delta s_1 = s_1 - 0 = \\frac{25}{12} \\, \\mathrm{cm}$。我们检查该点的 $y$ 坐标，以确保交点发生在区域的垂直边界 $[0, 3]$ 内：\n    $$\n    y(s_1) = \\frac{3}{5} + \\frac{4}{5}s_1 = \\frac{3}{5} + \\frac{4}{5}\\left(\\frac{25}{12}\\right) = \\frac{3}{5} + \\frac{5}{3} = \\frac{9+25}{15} = \\frac{34}{15} \\, \\mathrm{cm}\n    $$\n    由于 $0 \\le \\frac{34}{15} \\approx 2.267 \\le 3$，射线在区域内部与材料界面相交。\n\n2.  找到离开区域的出射点。\n    穿过界面后，射线进入区域 2。由于 $\\boldsymbol{\\Omega}$ 的两个分量都为正，射线将从上边界 ($y=3$) 或右边界 ($x=4$) 离开。设 $s_{exit}$ 为从进入到离开的总路径长度。我们计算到达每个边界所需的路径长度，并取最小值。\n    到达上边界 ($y=3$) 的路径长度：\n    $$\n    y(s_{exit}) = 3 \\implies \\frac{3}{5} + \\frac{4}{5}s_{exit} = 3 \\implies \\frac{4}{5}s_{exit} = 3 - \\frac{3}{5} = \\frac{12}{5} \\implies s_{exit} = \\frac{12}{5} \\times \\frac{5}{4} = 3 \\, \\mathrm{cm}\n    $$\n    到达右边界 ($x=4$) 的路径长度：\n    $$\n    x(s_{exit}) = 4 \\implies \\frac{3}{5}s_{exit} = 4 \\implies s_{exit} = \\frac{20}{3} \\approx 6.67 \\, \\mathrm{cm}\n    $$\n    比较这两个路径长度，较小的值对应于实际的出射事件。由于 $3  \\frac{20}{3}$，射线从上边界 $y=3$ 离开。在区域内的总路径长度为 $L = 3 \\, \\mathrm{cm}$。出射点为 $(x(3), y(3)) = (\\frac{3}{5}(3), 3) = (1.8, 3)$，该点在边界上。\n\n3.  计算在区域 2 中的路径长度。\n    射线在路径长度为 $s_1 = \\frac{25}{12} \\, \\mathrm{cm}$ 时进入区域 2，并在路径长度为 $L = 3 \\, \\mathrm{cm}$ 时离开区域。在区域 2 中的路径长度为：\n    $$\n    \\Delta s_2 = L - s_1 = 3 - \\frac{25}{12} = \\frac{36-25}{12} = \\frac{11}{12} \\, \\mathrm{cm}\n    $$\n\n4.  计算总光学厚度。\n    现在我们可以将两段路径的光学厚度相加：\n    $$\n    \\tau = \\Sigma_{t,1} \\Delta s_1 + \\Sigma_{t,2} \\Delta s_2\n    $$\n    代入给定值和计算出的路径长度：\n    $$\n    \\tau = (0.8 \\, \\mathrm{cm}^{-1}) \\left(\\frac{25}{12} \\, \\mathrm{cm}\\right) + (2.2 \\, \\mathrm{cm}^{-1}) \\left(\\frac{11}{12} \\, \\mathrm{cm}\\right)\n    $$\n    使用分数形式表示截面，$\\Sigma_{t,1} = \\frac{4}{5}$ 和 $\\Sigma_{t,2} = \\frac{22}{10} = \\frac{11}{5}$：\n    $$\n    \\tau = \\left(\\frac{4}{5}\\right) \\left(\\frac{25}{12}\\right) + \\left(\\frac{11}{5}\\right) \\left(\\frac{11}{12}\\right)\n    $$\n    $$\n    \\tau = \\frac{100}{60} + \\frac{121}{60} = \\frac{221}{60}\n    $$\n    总光学厚度是一个无量纲量。将分数转换为小数：\n    $$\n    \\tau = \\frac{221}{60} \\approx 3.683333...\n    $$\n    问题要求将结果四舍五入到五位有效数字。\n    $$\n    \\tau \\approx 3.6833\n    $$",
            "answer": "$$\n\\boxed{3.6833}\n$$"
        },
        {
            "introduction": "在实际的MOC计算中，中子通量连续的角度分布被一组离散的方向所近似。尽管这在计算上是必需的，但这种离散化可能导致中子通量解出现非物理性的空间振荡，即所谓的“射线效应”（ray effects）。本练习提供了一个深刻的理论分析，旨在揭示这种效应的根源。通过一个简化的模型，它清晰地展示了离散角度数量不足时，为何会无法准确重现中子泄漏的真实角度依赖性，从而导致混叠误差（aliasing errors）。",
            "id": "4255832",
            "problem": "考虑一个二维稳态中子输运问题，该问题代表方形栅格中的一个栅元，并采用特征线法（MOC）进行处理。在子午面（或称方位角平面）中，设角坐标为方位角 $\\phi \\in [0, 2\\pi)$，中子角通量 $\\psi(\\mathbf{r}, \\phi)$ 满足稳态中子输运方程\n$$\\boldsymbol{\\Omega}(\\phi) \\cdot \\nabla \\psi(\\mathbf{r}, \\phi) + \\Sigma_{t}(\\mathbf{r}) \\psi(\\mathbf{r}, \\phi) = \\int_{0}^{2\\pi} \\Sigma_{s}(\\mathbf{r}; \\phi' \\to \\phi) \\psi(\\mathbf{r}, \\phi') \\, d\\phi' + q(\\mathbf{r}, \\phi),$$\n其中 $\\boldsymbol{\\Omega}(\\phi)$ 是单位方向矢量，$\\Sigma_{t}$ 是总宏观截面，$\\Sigma_{s}$ 是宏观散射核，$q$ 是外部源或裂变源。在特征线法（MOC）中，解通过沿特征线方向的线积分表示，角积分则由一组有限的方位角方向来近似。当方位角离散不充分时，MOC中会出现射线效应，由于流与泄漏的角谱发生混叠，从而导致伪各向异性。\n\n对于嵌入方形栅格中的栅元，穿过其边界的出射流表现出四重对称性。用一个受此对称性约束的傅里叶级数来模拟角度依赖的栅元泄漏泛函：\n$$J(\\phi) = J_{0}\\Big(1 + \\epsilon_{4} \\cos(4\\phi) + \\epsilon_{8} \\cos(8\\phi) + \\epsilon_{12} \\cos(12\\phi)\\Big),$$\n其中 $J_{0}  0$，且各向异性振幅 $\\epsilon_{4}$、$\\epsilon_{8}$ 和 $\\epsilon_{12}$ 很小，满足 $|\\epsilon_{m}| \\ll 1$。我们关心的物理量是角积分泄漏\n$$L \\equiv \\int_{0}^{2\\pi} J(\\phi)\\, d\\phi.$$\n\n假设特征线法采用具有 $N_{\\phi}$ 个方向的等权重、等间距方位角离散，其中角度集合为 $\\{\\phi_{j} = 2\\pi j / N_{\\phi}\\}_{j=0}^{N_{\\phi}-1}$。通过将连续角积分替换为在这些方向上的相应等角求积，定义 $L$ 的离散角近似 $L_{N_{\\phi}}$。角离散误差（用于表征射线效应）由相对误差量化：\n$$\\mathcal{E}(N_{\\phi}) \\equiv \\frac{L_{N_{\\phi}} - L}{L}.$$\n\n给定 $N_{\\phi} = 8$，$J_{0}$ 为任意正数，各向异性振幅 $\\epsilon_{4} = 0.03$，$\\epsilon_{8} = 0.06$，$\\epsilon_{12} = 0.02$。从中子输运方程和MOC角离散的定义出发，推导 $\\mathcal{E}(N_{\\phi})$ 关于 $N_{\\phi}$ 和傅里叶振幅的闭式表达式。对给定的参数值，计算 $\\mathcal{E}(8)$。将 $\\mathcal{E}(8)$ 的最终数值答案表示为小数，并四舍五入到四位有效数字。$\\mathcal{E}(8)$ 无需物理单位。",
            "solution": "该问题要求推导角离散误差 $\\mathcal{E}(N_{\\phi})$ 的闭式表达式，并对特定情况进行数值计算。该问题是在求解中子输运方程的特征线法（MOC）背景下提出的，但其核心任务是分析给定角度依赖函数的数值求积误差。\n\n角度依赖的栅元泄漏泛函 $J(\\phi)$ 以具有四重对称性的傅里叶级数形式给出：\n$$J(\\phi) = J_{0}\\Big(1 + \\epsilon_{4} \\cos(4\\phi) + \\epsilon_{8} \\cos(8\\phi) + \\epsilon_{12} \\cos(12\\phi)\\Big)$$\n关心的物理量是总角积分泄漏 $L$，定义为：\n$$L \\equiv \\int_{0}^{2\\pi} J(\\phi)\\, d\\phi$$\n其近似值 $L_{N_{\\phi}}$ 采用具有 $N_{\\phi}$ 个方向的等权重、等间距方位角求积。相对误差定义为 $\\mathcal{E}(N_{\\phi}) \\equiv \\frac{L_{N_{\\phi}} - L}{L}$。\n\n首先，我们计算精确的总泄漏 $L$。这需要将 $J(\\phi)$ 的表达式在区间 $[0, 2\\pi)$ 上积分。\n$$L = \\int_{0}^{2\\pi} J_{0}\\Big(1 + \\epsilon_{4} \\cos(4\\phi) + \\epsilon_{8} \\cos(8\\phi) + \\epsilon_{12} \\cos(12\\phi)\\Big) \\, d\\phi$$\n我们可以分配积分：\n$$L = J_{0} \\left( \\int_{0}^{2\\pi} 1 \\, d\\phi + \\epsilon_{4} \\int_{0}^{2\\pi} \\cos(4\\phi) \\, d\\phi + \\epsilon_{8} \\int_{0}^{2\\pi} \\cos(8\\phi) \\, d\\phi + \\epsilon_{12} \\int_{0}^{2\\pi} \\cos(12\\phi) \\, d\\phi \\right)$$\n对于任意非零整数 $m$，$\\cos(m\\phi)$ 在一个完整周期 $[0, 2\\pi]$ 上的定积分为零：\n$$\\int_{0}^{2\\pi} \\cos(m\\phi) \\, d\\phi = \\left[ \\frac{\\sin(m\\phi)}{m} \\right]_{0}^{2\\pi} = \\frac{\\sin(2\\pi m) - \\sin(0)}{m} = 0$$\n由于谐波指数 $m=4$、$m=8$ 和 $m=12$ 都是非零整数，它们对应的积分都为零。唯一非零的贡献来自常数项。\n$$L = J_{0} \\left( [\\phi]_{0}^{2\\pi} + 0 + 0 + 0 \\right) = J_{0} (2\\pi - 0) = 2\\pi J_{0}$$\n\n接下来，我们构建离散角近似 $L_{N_{\\phi}}$。问题指定了在 $N_{\\phi}$ 个角度 $\\phi_{j} = 2\\pi j / N_{\\phi}$（$j = 0, 1, \\dots, N_{\\phi}-1$）上进行等权重、等间距的求积。对于长度为 $2\\pi$ 的区间上的积分， $N_{\\phi}$ 个点中每个点的等权重为 $w_j = \\frac{2\\pi}{N_{\\phi}}$。\n$$L_{N_{\\phi}} = \\sum_{j=0}^{N_{\\phi}-1} w_j J(\\phi_j) = \\frac{2\\pi}{N_{\\phi}} \\sum_{j=0}^{N_{\\phi}-1} J(\\phi_j)$$\n代入 $J(\\phi_j)$ 的表达式：\n$$L_{N_{\\phi}} = \\frac{2\\pi J_{0}}{N_{\\phi}} \\sum_{j=0}^{N_{\\phi}-1} \\Big(1 + \\epsilon_{4} \\cos(4\\phi_j) + \\epsilon_{8} \\cos(8\\phi_j) + \\epsilon_{12} \\cos(12\\phi_j)\\Big)$$\n我们分配求和：\n$$L_{N_{\\phi}} = \\frac{2\\pi J_{0}}{N_{\\phi}} \\left( \\sum_{j=0}^{N_{\\phi}-1} 1 + \\epsilon_{4} \\sum_{j=0}^{N_{\\phi}-1} \\cos(4\\phi_j) + \\epsilon_{8} \\sum_{j=0}^{N_{\\phi}-1} \\cos(8\\phi_j) + \\epsilon_{12} \\sum_{j=0}^{N_{\\phi}-1} \\cos(12\\phi_j) \\right)$$\n第一个和是 $\\sum_{j=0}^{N_{\\phi}-1} 1 = N_{\\phi}$。对于余弦和，我们使用在等间距点上的余弦离散和的性质。形式为 $S_m = \\sum_{j=0}^{N-1} \\cos(m \\frac{2\\pi j}{N})$ 的和，如果 $m$ 是 $N$ 的整数倍（即，对于某个整数 $k$，$m=kN$），其值为 $N$；否则为 $0$。这源于复指数的几何级数和 $\\sum_{j=0}^{N-1} (e^{i 2\\pi m/N})^j$。\n\n将此性质应用于我们的和，其中 $N=N_{\\phi}$：\n$$ \\sum_{j=0}^{N_{\\phi}-1} \\cos(m\\phi_j) = \\begin{cases} N_{\\phi}  \\text{若 } m \\text{ 是 } N_{\\phi} \\text{ 的非零倍数} \\\\ 0  \\text{否则} \\end{cases} $$\n我们用 $m \\equiv 0 \\pmod{N_{\\phi}}$ 表示“$m$ 是 $N_{\\phi}$ 的倍数”这一条件。$L_{N_{\\phi}}$ 的表达式变为：\n$$L_{N_{\\phi}} = 2\\pi J_{0} \\left( 1 + \\sum_{m \\in \\{4, 8, 12\\}} \\epsilon_m \\cdot \\delta_{m \\pmod{N_{\\phi}}, 0} \\right)$$\n其中 $\\delta_{i,j}$ 是克罗内克δ函数。\n\n现在，我们推导相对误差 $\\mathcal{E}(N_{\\phi})$ 的闭式表达式：\n$$\\mathcal{E}(N_{\\phi}) = \\frac{L_{N_{\\phi}} - L}{L} = \\frac{2\\pi J_{0} \\left( 1 + \\sum_{m \\in \\{4, 8, 12\\}} \\epsilon_m \\delta_{m \\pmod{N_{\\phi}}, 0} \\right) - 2\\pi J_{0}}{2\\pi J_{0}}$$\n$2\\pi J_{0}$ 项被消去，得到离散误差的通用表达式：\n$$\\mathcal{E}(N_{\\phi}) = \\sum_{m \\in \\{4, 8, 12\\}} \\epsilon_m \\delta_{m \\pmod{N_{\\phi}}, 0}$$\n该表达式表明，误差是由混叠效应引起的：傅里叶模的指数 $m$ 若是离散角数量 $N_{\\phi}$ 的倍数，则该模会被错误地求和为一个非零值（而不是积分为零），从而直接对误差产生贡献。\n\n最后，我们对给定参数计算 $\\mathcal{E}(N_{\\phi})$：$N_{\\phi} = 8$，$\\epsilon_{4} = 0.03$，$\\epsilon_{8} = 0.06$ 和 $\\epsilon_{12} = 0.02$。\n我们对每个谐波指数 $m$ 检查条件 $m \\pmod{8} = 0$：\n- 对于 $m=4$：$4 \\pmod{8} = 4 \\ne 0$。贡献为 $0$。\n- 对于 $m=8$：$8 \\pmod{8} = 0$。贡献为 $\\epsilon_{8}$。\n- 对于 $m=12$：$12 \\pmod{8} = 4 \\ne 0$。贡献为 $0$。\n\n因此，总相对误差就是这些贡献项的总和：\n$$\\mathcal{E}(8) = 0 + \\epsilon_{8} + 0 = \\epsilon_{8}$$\n代入给定值 $\\epsilon_{8} = 0.06$：\n$$\\mathcal{E}(8) = 0.06$$\n问题要求将此答案表示为小数，并四舍五入到四位有效数字。数字 $0.06$ 为了用四位有效数字表示，我们添加尾随零。\n$$\\mathcal{E}(8) = 0.06000$$",
            "answer": "$$\\boxed{0.06000}$$"
        },
        {
            "introduction": "现实世界中的核反应堆组件（如燃料棒）通常包含弯曲的边界。MOC程序普遍采用多边形来近似这些曲线，但这会引入几何离散误差。这个编程实践旨在直面这一实际问题，通过量化几何近似对一个关键物理量——反应率——的影响。通过推导并实现一个评估此误差的模型，您将更深入地理解在MOC模拟中，几何保真度与计算精度之间的权衡关系。",
            "id": "4255848",
            "problem": "考虑燃料棒栅元中均匀包壳区内的二维、稳态、单能中子输运方程，其中包含各向同性内部源。包壳被建模为一个内径为 $r_i$、外径为 $r_o$ 的环形区域，其空间上均匀的总宏观截面为 $\\Sigma_t$，吸收宏观截面为 $\\Sigma_a$。内部各向同性源密度为 $q$（单位：中子/立方厘米·秒）。在此背景下，特征线法（MOC）定义为沿直线轨迹（特征线）在均匀区域内对输运方程进行积分的方法。\n\n假设在均匀包壳区域内采用平坦源近似，并且由外部边界产生的泄漏项对于体平均通量而言在主导阶上可以忽略不计，因此对区域边界的微小几何扰动的一阶影响主要通过区域的度量（在二维中为面积，每单位轴向长度）的变化来体现。在这些假设下，包壳区域的反应率统计值可一阶近似为区域面积、区域平均标量通量与 $\\Sigma_a$ 的乘积。\n\n为研究 MOC 中直线边界近似引入的几何离散化误差，将内外圆形边界替换为具有 $N$ 个等距顶点的正多边形。考虑两种近似策略：\n- 内接策略：内外边界圆均由其顶点位于圆上的正多边形来近似。\n- 外切策略：内外边界圆均由外切于这些圆的正多边形来近似（即圆与多边形的边相切）。\n\n任何三角关系式中的角度均应以弧度处理。所有长度单位为厘米，截面单位为厘米的倒数，源密度单位为中子/立方厘米·秒。反应率应以“反应数/秒·单位轴向长度（厘米）”表示。\n\n任务：\n- 从基本输运理论和输运方程的特征线形式出发，推导因使用具有 $N$ 条边的正多边形进行边界离散化而引起的包壳反应率统计值变化的一阶估计。仅使用以下假设：在平坦源近似下，均匀区域中的体平均标量通量在主导阶上与 $q/\\Sigma_t$ 成正比，并且几何替换的主导阶影响通过区域面积线性引入。\n- 实现一个程序，为每个测试用例计算：\n  1. 内接近似下反应率统计值的绝对误差 $\\Delta R_{\\text{in}}$。\n  2. 外切近似下反应率统计值的绝对误差 $\\Delta R_{\\text{out}}$。\n  3. 内接近似下反应率统计值的相对误差，定义为小数形式 $\\Delta R_{\\text{in}} / R_{\\text{circle}}$。\n  4. 外切近似下反应率统计值的相对误差，定义为小数形式 $\\Delta R_{\\text{out}} / R_{\\text{circle}}$。\n  \n此处 $R_{\\text{circle}}$ 是当包壳由内径为 $r_i$、外径为 $r_o$ 的精确圆形环区建模时的反应率统计值。\n\n测试套件：\n为以下参数集 $(r_i, r_o, \\Sigma_t, \\Sigma_a, q, N)$ 提供结果：\n- 案例 A：$(0.40, 0.45, 3.0, 0.3, 1.5, 16)$。\n- 案例 B：$(0.40, 0.45, 3.0, 0.3, 1.5, 64)$。\n- 案例 C（薄包壳）：$(0.495, 0.50, 3.0, 0.3, 1.5, 8)$。\n- 案例 D（粗糙多边形）：$(0.40, 0.45, 3.0, 0.3, 1.5, 3)$。\n- 案例 E（厚包壳，强衰减）：$(0.20, 0.50, 10.0, 0.9, 4.0, 32)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是一个包含四项的列表，顺序为 $[\\Delta R_{\\text{in}}, \\Delta R_{\\text{out}}, \\Delta R_{\\text{in}} / R_{\\text{circle}}, \\Delta R_{\\text{out}} / R_{\\text{circle}}]$。所有绝对误差的单位必须是“反应数/秒·单位轴向长度”，所有相对误差必须是小数形式。例如，总体格式为 $[[r_{1,1}, r_{1,2}, r_{1,3}, r_{1,4}],[r_{2,1}, r_{2,2}, r_{2,3}, r_{2,4}],\\dots]$。\n\n问题陈述中未提供中间公式；您的推导必须从输运方程和特征线解结构开始，然后推导量化圆形环区和多边形环区之间面积差异所需的几何关系。",
            "solution": "本问题要求推导当包壳的圆形边界被具有 $N$ 条边的正多边形近似时，包壳吸收反应率变化的一阶估计。此推导需从输运理论的基本原理出发。\n\n对于一个面积为 $A$ 的二维区域，给定类型 $x$ 反应的总反应率 $R_x$ 定义为宏观截面 $\\Sigma_x(\\mathbf{r})$ 与标量中子通量 $\\phi(\\mathbf{r})$ 的乘积在该面积上的积分：\n$$\nR = \\int_A \\Sigma_x(\\mathbf{r}) \\phi(\\mathbf{r}) \\, dA\n$$\n在本问题中，我们关心的是包壳区域内的吸收反应率，因此相关截面是吸收截面 $\\Sigma_a$。由于包壳是均匀区域，$\\Sigma_a$ 在空间上是常数，反应率的表达式简化为：\n$$\nR = \\Sigma_a \\int_A \\phi(\\mathbf{r}) \\, dA\n$$\n我们引入区域平均标量通量 $\\bar{\\phi}$，其定义为：\n$$\n\\bar{\\phi} = \\frac{1}{A} \\int_A \\phi(\\mathbf{r}) \\, dA\n$$\n将此定义代入 $R$ 的表达式，我们得到反应率、材料性质、几何形状和平均通量之间的关系：\n$$\nR = \\Sigma_a \\bar{\\phi} A\n$$\n问题陈述中的核心假设是，几何扰动（用多边形替换圆形边界）对反应率的一阶影响主要通过区域面积 $A$ 的变化来体现。这意味着对于精确几何和离散化几何，平均标量通量 $\\bar{\\phi}$ 可近似为常数。\n\n为了量化 $R$，我们需要一个对 $\\bar{\\phi}$ 的估计。问题给出的另一个关键假设是，在平源近似下，体平均标量通量在主导阶上与 $q/\\Sigma_t$ 成正比。我们采用这个物理模型的最简单形式：\n$$\n\\bar{\\phi} \\approx \\frac{q}{\\Sigma_t}\n$$\n其中 $q$ 是均匀内部源密度，$\\Sigma_t$ 是总截面。将这个 $\\bar{\\phi}$ 的近似值代入 $R$ 的方程，得到面积为 $A$ 的区域中反应率的一阶估计：\n$$\nR \\approx \\frac{q \\Sigma_a}{\\Sigma_t} A\n$$\n此模型将反应率与区域面积直接关联。因此，由于用多边形近似几何（面积 $A_{\\text{poly}}$）替换精确圆形环区几何（面积 $A_{\\text{circle}}$）而产生的反应率绝对误差 $\\Delta R$ 为：\n$$\n\\Delta R = R_{\\text{poly}} - R_{\\text{circle}} = \\frac{q \\Sigma_a}{\\Sigma_t} (A_{\\text{poly}} - A_{\\text{circle}}) = \\frac{q \\Sigma_a}{\\Sigma_t} \\Delta A\n$$\n相对误差则定义为相对于精确反应率 $R_{\\text{circle}}$：\n$$\n\\frac{\\Delta R}{R_{\\text{circle}}} = \\frac{\\frac{q \\Sigma_a}{\\Sigma_t} \\Delta A}{\\frac{q \\Sigma_a}{\\Sigma_t} A_{\\text{circle}}} = \\frac{\\Delta A}{A_{\\text{circle}}}\n$$\n因此，问题简化为计算精确环形区域和两种多边形近似环形区域的面积。\n\n首先，内径为 $r_i$、外径为 $r_o$ 的精确圆形环区的面积是：\n$$\nA_{\\text{circle}} = \\pi r_o^2 - \\pi r_i^2 = \\pi (r_o^2 - r_i^2)\n$$\n接下来，我们推导一个半径为 $r$ 的圆的正 $N$ 边多边形近似的面积。\n对于**内接策略**，多边形的 $N$ 个顶点位于半径为 $r$ 的圆上。该多边形可分解为 $N$ 个相同的等腰三角形，每个三角形有两条边长为 $r$，夹角为 $2\\pi/N$。单个三角形的面积是 $\\frac{1}{2}r^2\\sin(2\\pi/N)$。因此，内接多边形的总面积是：\n$$\nA_{\\text{insc}}(r, N) = \\frac{N}{2} r^2 \\sin\\left(\\frac{2\\pi}{N}\\right)\n$$\n对于**外切策略**，多边形的 $N$ 条边与半径为 $r$ 的圆相切。该多边形也可分解为 $N$ 个相同的等腰三角形，其中半径 $r$ 是三角形的高（边心距）。每个三角形的顶角为 $2\\pi/N$。其面积为 $r^2 \\tan(\\pi/N)$。因此，外切多边形的总面积是：\n$$\nA_{\\text{circ}}(r, N) = N r^2 \\tan\\left(\\frac{\\pi}{N}\\right)\n$$\n多边形环区的面积是外多边形和内多边形面积之差。\n对于内接策略：\n$$\nA_{\\text{in}} = A_{\\text{insc}}(r_o, N) - A_{\\text{insc}}(r_i, N) = \\frac{N}{2} \\sin\\left(\\frac{2\\pi}{N}\\right) (r_o^2 - r_i^2)\n$$\n对于外切策略：\n$$\nA_{\\text{out}} = A_{\\text{circ}}(r_o, N) - A_{\\text{circ}}(r_i, N) = N \\tan\\left(\\frac{\\pi}{N}\\right) (r_o^2 - r_i^2)\n$$\n现在我们可以写出绝对误差和相对误差的最终表达式。设物理因子 $K_{\\text{phys}} = q \\Sigma_a / \\Sigma_t$。\n内接情况的绝对误差 $\\Delta R_{\\text{in}}$ 为：\n$$\n\\Delta R_{\\text{in}} = K_{\\text{phys}} (A_{\\text{in}} - A_{\\text{circle}}) = \\frac{q \\Sigma_a}{\\Sigma_t} (r_o^2 - r_i^2) \\left[ \\frac{N}{2} \\sin\\left(\\frac{2\\pi}{N}\\right) - \\pi \\right]\n$$\n外切情况的绝对误差 $\\Delta R_{\\text{out}}$ 为：\n$$\n\\Delta R_{\\text{out}} = K_{\\text{phys}} (A_{\\text{out}} - A_{\\text{circle}}) = \\frac{q \\Sigma_a}{\\Sigma_t} (r_o^2 - r_i^2) \\left[ N \\tan\\left(\\frac{\\pi}{N}\\right) - \\pi \\right]\n$$\n相应的相对误差为：\n$$\n\\frac{\\Delta R_{\\text{in}}}{R_{\\text{circle}}} = \\frac{A_{\\text{in}} - A_{\\text{circle}}}{A_{\\text{circle}}} = \\frac{\\frac{N}{2} \\sin\\left(\\frac{2\\pi}{N}\\right)}{\\pi} - 1\n$$\n$$\n\\frac{\\Delta R_{\\text{out}}}{R_{\\text{circle}}} = \\frac{A_{\\text{out}} - A_{\\text{circle}}}{A_{\\text{circle}}} = \\frac{N \\tan\\left(\\frac{\\pi}{N}\\right)}{\\pi} - 1\n$$\n这些公式被用于实现程序，以计算每个测试用例所需的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the absolute and relative errors in reaction rate tallies\n    for a cladding region when its circular boundaries are approximated\n    by regular polygons using inscribed and circumscribed strategies.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (r_i, r_o, Sigma_t, Sigma_a, q, N)\n    test_cases = [\n        (0.40, 0.45, 3.0, 0.3, 1.5, 16),\n        (0.40, 0.45, 3.0, 0.3, 1.5, 64),\n        (0.495, 0.50, 3.0, 0.3, 1.5, 8),\n        (0.40, 0.45, 3.0, 0.3, 1.5, 3),\n        (0.20, 0.50, 10.0, 0.9, 4.0, 32),\n    ]\n\n    results = []\n    for case in test_cases:\n        r_i, r_o, sigma_t, sigma_a, q, N = case\n\n        # Physical scaling factor for reaction rate, derived as (q * Sigma_a) / Sigma_t.\n        # Units: (n/cm^3/s) * (cm^-1) / (cm^-1) = n/cm^3/s\n        k_phys = (q * sigma_a) / sigma_t\n\n        # Common geometric factor from the annulus area formula.\n        # Units: cm^2\n        k_geom = r_o**2 - r_i**2\n        \n        # The term multiplying k_geom in the area formulas.\n        # For a circle, this is pi.\n        # For inscribed polygon: (N/2) * sin(2*pi/N)\n        # For circumscribed polygon: N * tan(pi/N)\n        \n        # Calculate area factors for polygonal approximations\n        area_factor_in = (N / 2.0) * np.sin(2.0 * np.pi / N)\n        area_factor_out = N * np.tan(np.pi / N)\n\n        # 1. Absolute error for inscribed approximation, Delta_R_in\n        # Delta_R = k_phys * (A_poly - A_circle) = k_phys * k_geom * (area_factor - pi)\n        # Units: (n/cm^3/s) * (cm^2) = n/cm/s, which is reactions per second per unit axial length.\n        delta_R_in = k_phys * k_geom * (area_factor_in - np.pi)\n\n        # 2. Absolute error for circumscribed approximation, Delta_R_out\n        delta_R_out = k_phys * k_geom * (area_factor_out - np.pi)\n        \n        # 3. Relative error for inscribed approximation\n        # Rel_Err = (A_poly - A_circle) / A_circle = (area_factor - pi) / pi\n        # This is a dimensionless decimal fraction.\n        rel_err_in = (area_factor_in / np.pi) - 1.0\n\n        # 4. Relative error for circumscribed approximation\n        rel_err_out = (area_factor_out / np.pi) - 1.0\n\n        results.append([delta_R_in, delta_R_out, rel_err_in, rel_err_out])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, represented as a string.\n    # e.g., [[val1, val2, ...], [val1, val2, ...]]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}