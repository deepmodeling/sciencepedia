{
    "hands_on_practices": [
        {
            "introduction": "特征线法（Method of Characteristics, MOC）的核心是将输运方程沿中子运动的直线轨迹（即特征线）进行积分。此过程的关键一步是计算光学厚度，它量化了中子沿特定路径与材料发生相互作用的总概率。这个练习  为您提供了在包含多种材料的复杂几何区域中，进行射线追踪并计算这一关键物理量的基础实践，是掌握 MOC 方法的基石。",
            "id": "4255876",
            "problem": "一个用于稳态、单能中子输运特征线法(MOC)建模的二维矩形区域，其范围为 $x \\in [0, 4] \\ \\mathrm{cm}$ 和 $y \\in [0, 3] \\ \\mathrm{cm}$。该区域在 $x = 1.25 \\ \\mathrm{cm}$ 处被一个垂直界面划分为两种材料。在区域 $x  1.25 \\ \\mathrm{cm}$ 内的材料总宏观截面为 $\\Sigma_{t,1} = 0.8 \\ \\mathrm{cm}^{-1}$，而在区域 $x \\ge 1.25 \\ \\mathrm{cm}$ 内的材料总宏观截面为 $\\Sigma_{t,2} = 2.2 \\ \\mathrm{cm}^{-1}$。\n\n考虑一条特征射线，它从左边界点 $(x_0, y_0) = (0, 0.6) \\ \\mathrm{cm}$ 进入该区域，其单位方向向量为 $\\boldsymbol{\\Omega} = \\left( \\frac{3}{5}, \\frac{4}{5} \\right)$。该射线一直行进，直到离开该区域。\n\n使用沿特征线投影的稳态、单能线性玻尔兹曼方程(LBE)，以及光学厚度定义为总宏观截面沿射线路径的路径积分，确定该射线从进入到离开所累积的总光学厚度。假设材料是分块均匀的，并且射线穿过材料界面，然后在没有反射或散射引起的路径改变的情况下在边界处离开。\n\n请将最终答案表示为一个无量纲值，并四舍五入到五位有效数字。",
            "solution": "本题要求计算当中子射线穿过一个二维、双材料区域时所累积的总光学厚度。光学厚度 $\\tau$ 定义为总宏观截面 $\\Sigma_t$ 沿射线特征路径的路径积分。对于由路径长度 $s$ 参数化的路径，其表达式为：\n$$\n\\tau = \\int_{path} \\Sigma_t(\\mathbf{r}(s)) \\, ds\n$$\n其中 $\\mathbf{r}(s)$ 是沿射线路径的位置向量。\n\n首先，我们建立射线路径的参数方程。射线从初始点 $\\mathbf{r}_0 = (x_0, y_0) = (0, 0.6) \\ \\mathrm{cm}$ 进入，并沿着单位向量 $\\boldsymbol{\\Omega} = (\\Omega_x, \\Omega_y) = \\left( \\frac{3}{5}, \\frac{4}{5} \\right)$ 的方向行进。距离入射点路径长度为 $s$ 处的位置向量 $\\mathbf{r}(s) = (x(s), y(s))$ 由下式给出：\n$$\n\\mathbf{r}(s) = \\mathbf{r}_0 + s \\boldsymbol{\\Omega}\n$$\n其分量方程为：\n$$\nx(s) = x_0 + s \\Omega_x = 0 + s \\left(\\frac{3}{5}\\right) = \\frac{3}{5}s\n$$\n$$\ny(s) = y_0 + s \\Omega_y = 0.6 + s \\left(\\frac{4}{5}\\right) = \\frac{3}{5} + \\frac{4}{5}s\n$$\n该区域是一个由 $x \\in [0, 4]$ 和 $y \\in [0, 3]$ 定义的矩形。它被位于 $x_I = 1.25 \\ \\mathrm{cm}$ 的垂直界面分为两个材料区域。\n区域1：$0 \\le x  1.25 \\ \\mathrm{cm}$，总截面为 $\\Sigma_{t,1} = 0.8 \\ \\mathrm{cm}^{-1}$。\n区域2：$1.25 \\le x \\le 4 \\ \\mathrm{cm}$，总截面为 $\\Sigma_{t,2} = 2.2 \\ \\mathrm{cm}^{-1}$。\n\n由于截面是分段常数，光学厚度的积分可以分解为在每个材料区域中路径段上的和：\n$$\n\\tau = \\tau_1 + \\tau_2 = \\Sigma_{t,1} \\Delta s_1 + \\Sigma_{t,2} \\Delta s_2\n$$\n其中 $\\Delta s_1$ 和 $\\Delta s_2$ 分别是区域1和区域2中的路径长度。\n\n我们必须通过找到射线与材料界面和区域边界的交点来确定射线的路径。\n\n1.  找到与位于 $x_I = 1.25 \\ \\mathrm{cm}$ 的材料界面的交点。\n    设 $s_1$ 是从入射点到界面的路径长度。我们令 $x(s_1) = 1.25$：\n    $$\n    \\frac{3}{5}s_1 = 1.25 = \\frac{5}{4}\n    $$\n    解得 $s_1$：\n    $$\n    s_1 = \\frac{5}{4} \\times \\frac{5}{3} = \\frac{25}{12} \\ \\mathrm{cm}\n    $$\n    区域1中的路径长度为 $\\Delta s_1 = s_1 - 0 = \\frac{25}{12} \\ \\mathrm{cm}$。我们检查该点的 $y$ 坐标，以确保交点发生在区域的垂直边界 $[0, 3]$ 内：\n    $$\n    y(s_1) = \\frac{3}{5} + \\frac{4}{5}s_1 = \\frac{3}{5} + \\frac{4}{5}\\left(\\frac{25}{12}\\right) = \\frac{3}{5} + \\frac{5}{3} = \\frac{9+25}{15} = \\frac{34}{15} \\ \\mathrm{cm}\n    $$\n    由于 $0 \\le \\frac{34}{15} \\approx 2.267 \\le 3$，射线在区域内部与材料界面相交。\n\n2.  找到离开区域的出射点。\n    穿过界面后，射线进入区域2。由于 $\\boldsymbol{\\Omega}$ 的两个分量都为正，射线将从上边界（$y=3$）或右边界（$x=4$）离开。设 $s_{exit}$ 为从进入到离开的总路径长度。我们计算到达每个边界所需的路径长度，并取最小值。\n    到达上边界（$y=3$）的路径长度：\n    $$\n    y(s_{exit}) = 3 \\implies \\frac{3}{5} + \\frac{4}{5}s_{exit} = 3 \\implies \\frac{4}{5}s_{exit} = 3 - \\frac{3}{5} = \\frac{12}{5} \\implies s_{exit} = \\frac{12}{5} \\times \\frac{5}{4} = 3 \\ \\mathrm{cm}\n    $$\n    到达右边界（$x=4$）的路径长度：\n    $$\n    x(s_{exit}) = 4 \\implies \\frac{3}{5}s_{exit} = 4 \\implies s_{exit} = \\frac{20}{3} \\approx 6.67 \\ \\mathrm{cm}\n    $$\n    比较这两个路径长度，较小的值对应于实际的出射事件。由于 $3  \\frac{20}{3}$，射线从上边界 $y=3$ 处离开。在区域内的总路径长度为 $L = 3 \\ \\mathrm{cm}$。出射点为 $(x(3), y(3)) = (\\frac{3}{5}(3), 3) = (1.8, 3)$，该点位于边界上。\n\n3.  计算区域2中的路径长度。\n    射线在路径长度为 $s_1 = \\frac{25}{12} \\ \\mathrm{cm}$ 时进入区域2，并在路径长度为 $L = 3 \\ \\mathrm{cm}$ 时离开区域。区域2中的路径长度为：\n    $$\n    \\Delta s_2 = L - s_1 = 3 - \\frac{25}{12} = \\frac{36-25}{12} = \\frac{11}{12} \\ \\mathrm{cm}\n    $$\n\n4.  计算总光学厚度。\n    现在我们可以将两段的光学厚度相加：\n    $$\n    \\tau = \\Sigma_{t,1} \\Delta s_1 + \\Sigma_{t,2} \\Delta s_2\n    $$\n    代入给定值和计算出的路径长度：\n    $$\n    \\tau = (0.8 \\ \\mathrm{cm}^{-1}) \\left(\\frac{25}{12} \\ \\mathrm{cm}\\right) + (2.2 \\ \\mathrm{cm}^{-1}) \\left(\\frac{11}{12} \\ \\mathrm{cm}\\right)\n    $$\n    使用分数表示截面，$\\Sigma_{t,1} = \\frac{4}{5}$ 和 $\\Sigma_{t,2} = \\frac{22}{10} = \\frac{11}{5}$：\n    $$\n    \\tau = \\left(\\frac{4}{5}\\right) \\left(\\frac{25}{12}\\right) + \\left(\\frac{11}{5}\\right) \\left(\\frac{11}{12}\\right)\n    $$\n    $$\n    \\tau = \\frac{100}{60} + \\frac{121}{60} = \\frac{221}{60}\n    $$\n    总光学厚度是一个无量纲量。将分数转换为小数：\n    $$\n    \\tau = \\frac{221}{60} \\approx 3.683333...\n    $$\n    题目要求将结果四舍五入到五位有效数字。\n    $$\n    \\tau \\approx 3.6833\n    $$",
            "answer": "$$\n\\boxed{3.6833}\n$$"
        },
        {
            "introduction": "在真实的反应堆物理问题中，散射现象普遍存在，它将各个方向的中子角通量耦合在一起，使得直接求解变得困难。特征线法通常采用一种称为源迭代（Source Iteration, SI）的迭代算法来处理散射源。这个练习  旨在探索源迭代方法的收敛行为，让您能够预估求解过程的计算成本，并理解材料属性（特别是散射比 $c = \\Sigma_s / \\Sigma_t$）如何主导收敛速度。",
            "id": "4255835",
            "problem": "考虑一个一维平板中的单能、稳态中子输运问题，其两端为真空边界，使用特征线法 (MOC) 求解。该平板由两个相邻的均匀区域组成，分别表示为区域 1 和区域 2。中子角通量表示为 $\\psi(\\mathbf{r}, \\mathbf{\\Omega})$，标量通量表示为 $\\phi(\\mathbf{r}) = \\int_{4\\pi} \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\,\\mathrm{d}\\Omega$，区域 $i \\in \\{1,2\\}$ 中的总宏观截面和散射宏观截面分别表示为 $\\Sigma_{t,i}$ 和 $\\Sigma_{s,i}$。假设散射是各向同性的，并且没有裂变。真空边界条件意味着任何离开计算区域的特征线携带的入射通量为零。该问题采用直线特征线径迹和与特征线法 (MOC) 一致的区域内平源进行离散化。\n\n材料属性如下：\n- 区域 1：$\\Sigma_{t,1} = 1.2\\,\\mathrm{cm}^{-1}$，$\\Sigma_{s,1} = 1.08\\,\\mathrm{cm}^{-1}$。\n- 区域 2：$\\Sigma_{t,2} = 0.8\\,\\mathrm{cm}^{-1}$，$\\Sigma_{s,2} = 0.56\\,\\mathrm{cm}^{-1}$。\n\n定义区域 $i$ 的散射比为 $c_i = \\Sigma_{s,i}/\\Sigma_{t,i}$。假设采用源迭代 (SI) 法来收敛群内散射源，并令 $R^{(m)}$ 表示第 $m$ 次迭代时散射源残差的 $L^{\\infty}$-范数。迭代从零通量初始猜测开始，因此 $R^{(0)}$ 等于由外部固定源驱动的初始散射源的 $L^{\\infty}$-范数（为估计收敛性，将此初始残差归一化为 $R^{(0)} = 1$）。\n\n使用根据真空边界条件下输运扫描和散射算子的基本性质推导出的谱半径估计，确定为确保 $R^{(n)}  \\varepsilon$（容差 $\\varepsilon = 10^{-8}$）所需的最少源迭代次数 $n$。将最终答案表示为单个整数。由于迭代次数本身就是整数，因此无需按有效数字进行四舍五入。",
            "solution": "该问题要求计算将散射源残差减小到给定容差所需的最少源迭代 (SI) 次数。SI 方法的收敛率由迭代算子的谱半径决定。\n\n在无裂变介质中，具有各向同性散射和固定外部源 $Q(\\mathbf{r})$ 的单能、稳态中子输运方程如下所示：\n$$ \\mathbf{\\Omega} \\cdot \\nabla \\psi(\\mathbf{r}, \\mathbf{\\Omega}) + \\Sigma_t(\\mathbf{r}) \\psi(\\mathbf{r}, \\mathbf{\\Omega}) = \\frac{\\Sigma_s(\\mathbf{r})}{4\\pi} \\phi(\\mathbf{r}) + \\frac{Q(\\mathbf{r})}{4\\pi} $$\n其中 $\\psi(\\mathbf{r}, \\mathbf{\\Omega})$ 是角中子通量，$\\phi(\\mathbf{r})$ 是标量中子通量，$\\Sigma_t(\\mathbf{r})$ 是总宏观截面，$\\Sigma_s(\\mathbf{r})$ 是散射宏观截面。\n\n源迭代法通过迭代求解此方程。设 $m$ 为迭代指数。迭代格式定义为：\n$$ \\mathbf{\\Omega} \\cdot \\nabla \\psi^{(m+1)}(\\mathbf{r}, \\mathbf{\\Omega}) + \\Sigma_t(\\mathbf{r}) \\psi^{(m+1)}(\\mathbf{r}, \\mathbf{\\Omega}) = \\frac{\\Sigma_s(\\mathbf{r})}{4\\pi} \\phi^{(m)}(\\mathbf{r}) + \\frac{Q(\\mathbf{r})}{4\\pi} $$\n其中 $\\phi^{(m)}(\\mathbf{r})$ 是上一次迭代的标量通量。通过对立体角 $\\mathbf{\\Omega}$ 积分，我们可以用一个作用于标量通量的算子 $\\mathcal{L}$ 来表示迭代：\n$$ \\phi^{(m+1)} = \\mathcal{L} \\phi^{(m)} + S_Q $$\n其中迭代算子 $\\mathcal{L}$ 表示对由前一次通量迭代产生的散射源进行输运扫描的作用，而 $S_Q$ 是由外部源 $Q$ 产生的通量。\n\n此迭代过程的渐近收敛率由迭代算子 $\\mathcal{L}$ 的谱半径 $\\rho(\\mathcal{L})$ 控制。第 $m$ 次迭代时残差（或误差）的范数，记为 $R^{(m)}$，按以下关系减小：\n$$ R^{(m)} \\approx [\\rho(\\mathcal{L})]^m R^{(0)} $$\n对于稳态、单能、无裂变且具有真空边界条件的输运方程，输运理论的一个基本结果指出，SI 算子的谱半径等于问题域上散射比 $c(\\mathbf{r})$ 的上确界。\n散射比定义为：\n$$ c(\\mathbf{r}) = \\frac{\\Sigma_s(\\mathbf{r})}{\\Sigma_t(\\mathbf{r})} $$\n因此，谱半径由下式给出：\n$$ \\rho(\\mathcal{L}) = \\sup_{\\mathbf{r}} c(\\mathbf{r}) $$\n问题描述了一个包含两个均匀区域的计算域。散射比在每个区域内是恒定的。我们必须计算每个区域的散射比，并找出最大值。\n\n对于区域 1：\n给定的截面为 $\\Sigma_{t,1} = 1.2\\,\\mathrm{cm}^{-1}$ 和 $\\Sigma_{s,1} = 1.08\\,\\mathrm{cm}^{-1}$。\n散射比 $c_1$ 为：\n$$ c_1 = \\frac{\\Sigma_{s,1}}{\\Sigma_{t,1}} = \\frac{1.08}{1.2} = 0.9 $$\n\n对于区域 2：\n给定的截面为 $\\Sigma_{t,2} = 0.8\\,\\mathrm{cm}^{-1}$ 和 $\\Sigma_{s,2} = 0.56\\,\\mathrm{cm}^{-1}$。\n散射比 $c_2$ 为：\n$$ c_2 = \\frac{\\Sigma_{s,2}}{\\Sigma_{t,2}} = \\frac{0.56}{0.8} = 0.7 $$\n\n整个系统的谱半径是这些值的最大值：\n$$ \\rho(\\mathcal{L}) = \\max(c_1, c_2) = \\max(0.9, 0.7) = 0.9 $$\n这个值 $\\rho(\\mathcal{L}) = 0.9$ 是每次迭代中残差减小的因子。\n\n我们需要找到最小迭代次数 $n$，使得残差 $R^{(n)}$ 小于容差 $\\varepsilon = 10^{-8}$。给定初始残差归一化为 $R^{(0)} = 1$。条件是：\n$$ R^{(n)}  \\varepsilon $$\n使用收敛关系：\n$$ [\\rho(\\mathcal{L})]^n R^{(0)}  \\varepsilon $$\n代入已知值 $\\rho(\\mathcal{L})=0.9$，$R^{(0)}=1$ 和 $\\varepsilon=10^{-8}$：\n$$ (0.9)^n \\cdot 1  10^{-8} $$\n为了求解 $n$，我们对不等式两边取自然对数：\n$$ \\ln\\left((0.9)^n\\right)  \\ln(10^{-8}) $$\n$$ n \\ln(0.9)  -8 \\ln(10) $$\n由于 $\\ln(0.9)$ 是一个负数（因为 $0.9  1$），我们在两边同除以它时必须反转不等号：\n$$ n > \\frac{-8 \\ln(10)}{\\ln(0.9)} $$\n现在我们对这个表达式进行数值计算：\n$$ n > \\frac{-8 \\times 2.302585...}{-0.105360...} \\approx \\frac{18.42068}{0.105360} \\approx 174.8356 $$\n由于迭代次数 $n$ 必须是整数，我们必须找到严格大于 $174.8356$ 的最小整数。\n$$ n = \\lceil 174.8356 \\rceil = 175 $$\n因此，为达到所需容差，至少需要 $175$ 次迭代。",
            "answer": "$$\\boxed{175}$$"
        },
        {
            "introduction": "将特征线法的直线路径应用于具有弯曲边界的几何结构（如圆柱形燃料棒）是一个实际挑战。工程实践中，一种常见的技术是用多边形分段来近似曲线边界。本编程练习  允许您亲手量化由这种几何近似引入的离散化误差，从而深入理解在实际 MOC 模拟中，模型保真度与计算复杂度之间的权衡。",
            "id": "4255848",
            "problem": "考虑在燃料棒栅元的均匀包壳区中，存在各向同性内部源的二维、稳态、单能中子输运方程。该包壳被建模为一个内半径为 $r_i$、外半径为 $r_o$ 的环形区域，其空间均匀的总宏观截面为 $\\Sigma_t$，吸收宏观截面为 $\\Sigma_a$。内部各向同性源的密度为 $q$（单位：中子数/立方厘米/秒）。我们关注特征线法 (Method of Characteristics, MOC)，此处定义为沿着穿过均匀区域的直线轨迹（特征线）对输运方程进行积分的方法。\n\n假设在均匀包壳区内采用平源近似，并且在体积平均通量的主导阶上，由外部边界产生的泄漏项可以忽略不计，因此区域边界的微小几何扰动对一阶的影响主要通过区域的度量（在二维中为面积，每单位轴向长度）变化来体现。在这些假设下，包壳区中的反应率计数可一阶近似为该区域的面积、区域平均标量通量和 $\\Sigma_a$ 的乘积。\n\n为了研究 MOC 中由直线边界近似引入的几何离散化误差，我们将内外圆形边界替换为具有 $N$ 个等距顶点的正多边形。考虑两种近似策略：\n- 内接策略：内边界圆和外边界圆都由顶点位于圆上的正多边形来近似。\n- 外切策略：内边界圆和外边界圆都由外切于圆的正多边形来近似（即圆与多边形的边相切）。\n\n任何三角关系中的角度都应以弧度处理。所有长度单位为厘米，截面单位为厘米的倒数，源密度单位为中子数/立方厘米/秒。反应率应表示为反应次数/秒/单位轴向长度（厘米）。\n\n任务：\n- 从基本输运理论和输运方程的特征线形式出发，推导由于用 $N$ 边正多边形进行边界离散化而导致的包壳反应率计数变化的一阶估计。仅使用以下假设：在平源近似下，均匀区域中的体积平均标量通量在主导阶上与 $q/\\Sigma_t$ 成正比，并且几何替换的主导阶影响通过区域面积呈线性关系进入。\n- 实现一个程序，对每个测试用例计算：\n  1. 内接近似下反应率计数的绝对误差，$\\Delta R_{\\text{in}}$。\n  2. 外切近似下反应率计数的绝对误差，$\\Delta R_{\\text{out}}$。\n  3. 内接近似下反应率计数的相对误差，定义为小数形式 $\\Delta R_{\\text{in}} / R_{\\text{circle}}$。\n  4. 外切近似下反应率计数的相对误差，定义为小数形式 $\\Delta R_{\\text{out}} / R_{\\text{circle}}$。\n  \n此处，$R_{\\text{circle}}$ 是当包壳由内半径为 $r_i$ 和外半径为 $r_o$ 的精确圆形环面建模时的反应率计数。\n\n测试套件：\n为以下参数集 $(r_i, r_o, \\Sigma_t, \\Sigma_a, q, N)$ 提供结果：\n- 案例 A: $(0.40, 0.45, 3.0, 0.3, 1.5, 16)$。\n- 案例 B: $(0.40, 0.45, 3.0, 0.3, 1.5, 64)$。\n- 案例 C (薄包壳): $(0.495, 0.50, 3.0, 0.3, 1.5, 8)$。\n- 案例 D (粗糙多边形): $(0.40, 0.45, 3.0, 0.3, 1.5, 3)$。\n- 案例 E (厚包壳，强衰减): $(0.20, 0.50, 10.0, 0.9, 4.0, 32)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是一个包含四项的列表，顺序为 $[\\Delta R_{\\text{in}}, \\Delta R_{\\text{out}}, \\Delta R_{\\text{in}} / R_{\\text{circle}}, \\Delta R_{\\text{out}} / R_{\\text{circle}}]$。所有绝对误差的单位必须是反应次数/秒/单位轴向长度，所有相对误差必须是小数。例如，总体格式为 $[[r_{1,1}, r_{1,2}, r_{1,3}, r_{1,4}],[r_{2,1}, r_{2,2}, r_{2,3}, r_{2,4}],\\dots]$。\n\n问题陈述中未提供中间公式；您的推导必须从输运方程和特征线解结构开始，然后推导出量化圆形环面和多边形环面之间面积差异所需的几何关系。",
            "solution": "该问题是有效的。它在科学上基于中子输运理论的原理，问题设定良好、客观，并包含了推导出唯一解所需的所有必要信息和假设。问题的核心在于应用一组特定的简化方法于输运方程，以估计特征线法 (MOC) 中的几何离散化误差。\n\n任务是推导当包壳的圆形边界被具有 $N$ 条边的正多边形近似时，包壳吸收反应率变化的一阶估计。此推导必须从输运理论的基本原理开始。\n\n在面积为 $A$ 的二维区域中，给定反应类型的总反应率 $R$ 定义为宏观截面 $\\Sigma_x(\\vec{r})$ 与标量中子通量 $\\phi(\\vec{r})$ 的乘积在该面积上的积分：\n$$\nR = \\int_A \\Sigma_x(\\vec{r}) \\phi(\\vec{r}) dA\n$$\n对于本问题，我们关心的是包壳中的吸收反应率，因此相关截面是吸收截面 $\\Sigma_a$。包壳是一个均匀区域，意味着 $\\Sigma_a$ 在空间上是常数。反应率的表达式简化为：\n$$\nR = \\Sigma_a \\int_A \\phi(\\vec{r}) dA\n$$\n我们引入区域平均标量通量 $\\bar{\\phi}$，定义为：\n$$\n\\bar{\\phi} = \\frac{1}{A} \\int_A \\phi(\\vec{r}) dA\n$$\n将此定义代入 $R$ 的表达式中，得到反应率、材料性质、几何形状和平均通量之间的简单关系：\n$$\nR = \\Sigma_a \\bar{\\phi} A\n$$\n问题指出，对于误差的一阶估计，几何微扰（用多边形替换圆形边界）的影响主要通过区域面积 $A$ 的变化进入。这意味着对于精确几何和离散化几何，平均标量通量 $\\bar{\\phi}$ 可被视为近似恒定。\n\n为了量化 $R$，我们需要一个对 $\\bar{\\phi}$ 的估计。问题提供了一个关键假设，即体积平均标量通量在主导阶上与 $q/\\Sigma_t$ 成正比：$\\bar{\\phi} \\propto q/\\Sigma_t$。我们将其作为问题的既定物理模型，这在平均自由程 $1/\\Sigma_t$ 设定了通量衰减空间尺度的输运问题中是一个合理的简化。这种比例关系的最简单形式是等式，我们将采用此形式：\n$$\n\\bar{\\phi} \\approx \\frac{q}{\\Sigma_t}\n$$\n其中 $q$ 是均匀内部源密度，$\\Sigma_t$ 是总截面。将这个 $\\bar{\\phi}$ 的近似值代入我们的 $R$ 方程，我们得到面积为 $A$ 的区域中反应率的一阶估计：\n$$\nR \\approx \\frac{q \\Sigma_a}{\\Sigma_t} A\n$$\n这个模型将反应率直接与区域的面积联系起来。因此，由于用多边形近似 ($A_{\\text{poly}}$) 替换精确圆形环面几何 ($A_{\\text{circle}}$) 而产生的反应率绝对误差 $\\Delta R$ 为：\n$$\n\\Delta R = R_{\\text{poly}} - R_{\\text{circle}} = \\frac{q \\Sigma_a}{\\Sigma_t} (A_{\\text{poly}} - A_{\\text{circle}}) = \\frac{q \\Sigma_a}{\\Sigma_t} \\Delta A\n$$\n相对误差是相对于精确反应率 $R_{\\text{circle}}$ 定义的：\n$$\n\\frac{\\Delta R}{R_{\\text{circle}}} = \\frac{\\frac{q \\Sigma_a}{\\Sigma_t} \\Delta A}{\\frac{q \\Sigma_a}{\\Sigma_t} A_{\\text{circle}}} = \\frac{\\Delta A}{A_{\\text{circle}}}\n$$\n问题现在简化为计算精确环面和近似环面的面积。\n\n首先，内半径为 $r_i$、外半径为 $r_o$ 的精确圆形环面的面积是：\n$$\nA_{\\text{circle}} = \\pi r_o^2 - \\pi r_i^2 = \\pi (r_o^2 - r_i^2)\n$$\n接下来，我们确定正 $N$ 边多边形的面积，作为相关圆半径 $r$ 的函数。\n对于内接策略，多边形的 $N$ 个顶点位于半径为 $r$ 的圆上。该多边形可以分解为 $N$ 个相同的等腰三角形，每个三角形有两条长度为 $r$ 的边，夹角为 $2\\pi/N$。这样一个三角形的面积是 $\\frac{1}{2}r^2\\sin(2\\pi/N)$。内接多边形的总面积是：\n$$\nA_{\\text{insc}}(r, N) = \\frac{N}{2} r^2 \\sin\\left(\\frac{2\\pi}{N}\\right)\n$$\n对于外切策略，多边形的 $N$ 条边与半径为 $r$ 的圆相切。该多边形可以分解为 $N$ 个相同的等腰三角形，其中半径 $r$ 是边心距。每个三角形的顶角是 $2\\pi/N$。将其分成两个直角三角形，中心的角度是 $\\pi/N$。该角对的边是多边形边长的一半，邻边是边心距 $r$。因此，边长的一半是 $r \\tan(\\pi/N)$。这 $N$ 个等腰三角形中一个的面积是 $r \\times (r \\tan(\\pi/N)) = r^2 \\tan(\\pi/N)$。外切多边形的总面积是：\n$$\nA_{\\text{circ}}(r, N) = N r^2 \\tan\\left(\\frac{\\pi}{N}\\right)\n$$\n多边形环面的面积是外多边形和内多边形面积之差。\n对于内接策略：\n$$\nA_{\\text{in}} = A_{\\text{insc}}(r_o, N) - A_{\\text{insc}}(r_i, N) = \\frac{N}{2} \\sin\\left(\\frac{2\\pi}{N}\\right) (r_o^2 - r_i^2)\n$$\n对于外切策略：\n$$\nA_{\\text{out}} = A_{\\text{circ}}(r_o, N) - A_{\\text{circ}}(r_i, N) = N \\tan\\left(\\frac{\\pi}{N}\\right) (r_o^2 - r_i^2)\n$$\n现在我们可以写出绝对误差和相对误差的最终表达式。设公共物理因子为 $K_{\\text{phys}} = q \\Sigma_a / \\Sigma_t$，公共几何因子为 $K_{\\text{geom}} = r_o^2 - r_i^2$。\n内接情况下的绝对误差 $\\Delta R_{\\text{in}}$ 为：\n$$\n\\Delta R_{\\text{in}} = K_{\\text{phys}} (A_{\\text{in}} - A_{\\text{circle}}) = \\frac{q \\Sigma_a}{\\Sigma_t} (r_o^2 - r_i^2) \\left[ \\frac{N}{2} \\sin\\left(\\frac{2\\pi}{N}\\right) - \\pi \\right]\n$$\n外切情况下的绝对误差 $\\Delta R_{\\text{out}}$ 为：\n$$\n\\Delta R_{\\text{out}} = K_{\\text{phys}} (A_{\\text{out}} - A_{\\text{circle}}) = \\frac{q \\Sigma_a}{\\Sigma_t} (r_o^2 - r_i^2) \\left[ N \\tan\\left(\\frac{\\pi}{N}\\right) - \\pi \\right]\n$$\n内接情况下的相对误差为：\n$$\n\\frac{\\Delta R_{\\text{in}}}{R_{\\text{circle}}} = \\frac{A_{\\text{in}} - A_{\\text{circle}}}{A_{\\text{circle}}} = \\frac{\\frac{N}{2} \\sin\\left(\\frac{2\\pi}{N}\\right) (r_o^2 - r_i^2) - \\pi(r_o^2 - r_i^2)}{\\pi(r_o^2 - r_i^2)} = \\frac{\\frac{N}{2} \\sin\\left(\\frac{2\\pi}{N}\\right)}{\\pi} - 1\n$$\n外切情况下的相对误差为：\n$$\n\\frac{\\Delta R_{\\text{out}}}{R_{\\text{circle}}} = \\frac{A_{\\text{out}} - A_{\\text{circle}}}{A_{\\text{circle}}} = \\frac{N \\tan\\left(\\frac{\\pi}{N}\\right) (r_o^2 - r_i^2) - \\pi(r_o^2 - r_i^2)}{\\pi(r_o^2 - r_i^2)} = \\frac{N \\tan\\left(\\frac{\\pi}{N}\\right)}{\\pi} - 1\n$$\n这些公式被实现用来为每个测试用例计算所需的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the absolute and relative errors in reaction rate tallies\n    for a cladding region when its circular boundaries are approximated\n    by regular polygons using inscribed and circumscribed strategies.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (r_i, r_o, Sigma_t, Sigma_a, q, N)\n    test_cases = [\n        (0.40, 0.45, 3.0, 0.3, 1.5, 16),\n        (0.40, 0.45, 3.0, 0.3, 1.5, 64),\n        (0.495, 0.50, 3.0, 0.3, 1.5, 8),\n        (0.40, 0.45, 3.0, 0.3, 1.5, 3),\n        (0.20, 0.50, 10.0, 0.9, 4.0, 32),\n    ]\n\n    results = []\n    for case in test_cases:\n        r_i, r_o, sigma_t, sigma_a, q, N = case\n\n        # Physical scaling factor for reaction rate, derived as (q * Sigma_a) / Sigma_t.\n        # Units: (n/cm^3/s) * (cm^-1) / (cm^-1) = n/cm^3/s\n        k_phys = (q * sigma_a) / sigma_t\n\n        # Common geometric factor from the annulus area formula.\n        # Units: cm^2\n        k_geom = r_o**2 - r_i**2\n        \n        # The term multiplying k_geom in the area formulas.\n        # For a circle, this is pi.\n        # For inscribed polygon: (N/2) * sin(2*pi/N)\n        # For circumscribed polygon: N * tan(pi/N)\n        \n        # Calculate area factors for polygonal approximations\n        area_factor_in = (N / 2.0) * np.sin(2.0 * np.pi / N)\n        area_factor_out = N * np.tan(np.pi / N)\n\n        # 1. Absolute error for inscribed approximation, Delta_R_in\n        # Delta_R = k_phys * (A_poly - A_circle) = k_phys * k_geom * (area_factor - pi)\n        # Units: (n/cm^3/s) * (cm^2) = n/cm/s, which is reactions per second per unit axial length.\n        delta_R_in = k_phys * k_geom * (area_factor_in - np.pi)\n\n        # 2. Absolute error for circumscribed approximation, Delta_R_out\n        delta_R_out = k_phys * k_geom * (area_factor_out - np.pi)\n        \n        # 3. Relative error for inscribed approximation\n        # Rel_Err = (A_poly - A_circle) / A_circle = (area_factor - pi) / pi\n        # This is a dimensionless decimal fraction.\n        rel_err_in = (area_factor_in / np.pi) - 1.0\n\n        # 4. Relative error for circumscribed approximation\n        rel_err_out = (area_factor_out / np.pi) - 1.0\n\n        results.append([delta_R_in, delta_R_out, rel_err_in, rel_err_out])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, represented as a string.\n    # e.g., [[val1, val2, ...], [val1, val2, ...]]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}