{
    "hands_on_practices": [
        {
            "introduction": "在选择空间离散格式时，理解其基本属性至关重要。金刚石差分 (Diamond Difference, DD) 格式因其简洁直观而具有吸引力，但在某些情况下，尤其是在光学厚度较大的区域，它可能会产生非物理的负通量。本练习通过一个具体的反例，直接揭示了 DD 格式的这一缺陷，并将其与阶梯特征线 (Step Characteristic, SC) 方法进行对比，后者因其构造方式而内在地保证了解的正性，从而突显了 SC 方法在辐射输运计算中的一个关键优势 。",
            "id": "4252019",
            "problem": "考虑一个宽度为 $\\Delta x$ 的一维平板几何，在稳态、单能的离散纵标法 (DOM) 计算中。对于方向余弦为 $\\mu \\in (0,1]$ 的单个纵标方向，网格内的角通量 $\\psi(x)$ 满足一阶线性输运方程\n$$\n\\mu \\frac{d \\psi(x)}{dx} + \\Sigma_{t} \\psi(x) = Q,\n$$\n其中，总宏观截面 $\\Sigma_{t}  0$，且网格内有一个常数体源 $Q \\ge 0$。设入射面位于 $x = x_{i-1/2}$，其入射角通量已知为 $\\psi_{i-1/2} \\equiv \\psi(x_{i-1/2})$；出射面位于 $x = x_{i+1/2}$，其出射角通量未知为 $\\psi_{i+1/2} \\equiv \\psi(x_{i+1/2})$。定义该纵标方向上的光学厚度为\n$$\n\\tau \\equiv \\frac{\\Sigma_{t} \\Delta x}{\\mu}。\n$$\n从输运方程出发，推导：\n- 菱形差分 (DD) 的面与面更新关系，通过对网格平衡方程进行积分，并使用线性平均 $\\bar{\\psi} = (\\psi_{i-1/2} + \\psi_{i+1/2})/2$ 作为封闭关系。\n- 阶梯特征线法 (SC) 的面与面更新关系，通过在常系数条件下精确求解网格上的微分方程得到。\n\n使用这两种更新关系，分析在相同的光学厚度和源条件下，产生负的出射通量的可能性。给出一个反例，设体源为零，$Q = 0$，光学厚度 $\\tau = 3$，入射通量为正值 $\\psi_{i-1/2}  0$。\n\n计算 SC 和 DD 方法得到的出射面通量之间的归一化差异，\n$$\nD \\equiv \\frac{\\psi_{i+1/2}^{\\mathrm{SC}} - \\psi_{i+1/2}^{\\mathrm{DD}}}{\\psi_{i-1/2}},\n$$\n在指定条件下，并给出其数值结果，保留五位有效数字。你的最终答案应表示为一个无量纲的数字（没有单位）。",
            "solution": "我们从单个纵标方向（方向余弦 $\\mu \\in (0,1]$）的一维稳态单能输运方程开始：\n$$\n\\mu \\frac{d \\psi(x)}{dx} + \\Sigma_{t} \\psi(x) = Q,\n$$\n其中 $\\Sigma_{t}  0$，且源 $Q \\ge 0$ 在网格内为常数。\n\n定义左（入射）面角通量为 $\\psi_{i-1/2} = \\psi(x_{i-1/2})$，右（出射）面角通量为 $\\psi_{i+1/2} = \\psi(x_{i+1/2})$，网格宽度为 $\\Delta x = x_{i+1/2} - x_{i-1/2}$。沿方向 $\\mu$ 的光学厚度为\n$$\n\\tau \\equiv \\frac{\\Sigma_{t} \\Delta x}{\\mu}。\n$$\n\n菱形差分 (DD) 更新。我们从积分后的网格平衡方程推导 DD。将输运方程在 $x \\in [x_{i-1/2}, x_{i+1/2}]$ 上积分，\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\mu \\frac{d \\psi}{dx} + \\Sigma_{t} \\psi \\right) \\, dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} Q \\, dx.\n$$\n左侧展开为\n$$\n\\mu \\left[ \\psi_{i+1/2} - \\psi_{i-1/2} \\right] + \\Sigma_{t} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\psi(x) \\, dx = Q \\Delta x.\n$$\n引入网格平均角通量\n$$\n\\bar{\\psi} \\equiv \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\psi(x) \\, dx,\n$$\n得到精确的网格平衡方程\n$$\n\\mu \\left( \\psi_{i+1/2} - \\psi_{i-1/2} \\right) + \\Sigma_{t} \\Delta x \\, \\bar{\\psi} = Q \\Delta x.\n$$\n菱形差分封闭关系假设通量呈线性变化，并设\n$$\n\\bar{\\psi} = \\frac{\\psi_{i-1/2} + \\psi_{i+1/2}}{2}。\n$$\n将此关系代入平衡方程，并除以 $\\mu$：\n$$\n\\left( \\psi_{i+1/2} - \\psi_{i-1/2} \\right) + \\frac{\\Sigma_{t} \\Delta x}{2 \\mu} \\left( \\psi_{i+1/2} + \\psi_{i-1/2} \\right) = \\frac{Q \\Delta x}{\\mu}。\n$$\n使用 $\\tau = \\Sigma_{t} \\Delta x / \\mu$，上式变为\n$$\n\\left( 1 + \\frac{\\tau}{2} \\right) \\psi_{i+1/2} + \\left( -1 + \\frac{\\tau}{2} \\right) \\psi_{i-1/2} = \\frac{Q \\Delta x}{\\mu}。\n$$\n求解出射面通量，\n$$\n\\psi_{i+1/2}^{\\mathrm{DD}} = \\frac{ \\dfrac{Q \\Delta x}{\\mu} + \\left( 1 - \\dfrac{\\tau}{2} \\right) \\psi_{i-1/2} }{ 1 + \\dfrac{\\tau}{2} }。\n$$\n这就是关联了面通量和网格源的 DD 更新关系。\n\n阶梯特征线法 (SC) 更新。SC 在均匀网格中精确求解微分方程。将输运方程重写为\n$$\n\\frac{d \\psi}{dx} + \\frac{\\Sigma_{t}}{\\mu} \\psi = \\frac{Q}{\\mu}。\n$$\n这是一个系数为常数的一阶线性常微分方程。其积分因子为\n$$\nI(x) = \\exp\\!\\left( \\frac{\\Sigma_{t}}{\\mu} x \\right).\n$$\n两边同乘以积分因子，并从 $x_{i-1/2}$ 积分到 $x$ 得到\n$$\n\\psi(x) \\, \\exp\\!\\left( \\frac{\\Sigma_{t}}{\\mu} x \\right) - \\psi_{i-1/2} \\, \\exp\\!\\left( \\frac{\\Sigma_{t}}{\\mu} x_{i-1/2} \\right) = \\int_{x_{i-1/2}}^{x} \\frac{Q}{\\mu} \\exp\\!\\left( \\frac{\\Sigma_{t}}{\\mu} s \\right) ds.\n$$\n求解 $\\psi(x)$ 并在 $x = x_{i+1/2}$ 处取值，得到\n$$\n\\psi_{i+1/2}^{\\mathrm{SC}} = \\psi_{i-1/2} \\exp(-\\tau) + \\frac{Q}{\\Sigma_{t}} \\left( 1 - \\exp(-\\tau) \\right),\n$$\n其中我们使用了 $\\tau = \\Sigma_{t} \\Delta x / \\mu$ 以及指数源项的精确积分。\n\nDD 方法中负值问题的反例分析。考虑无体源 ($Q = 0$)、光学厚度 $\\tau = 3$、入射通量为正值 ($\\psi_{i-1/2}  0$) 的情况。在这些条件下，DD 更新关系简化为\n$$\n\\psi_{i+1/2}^{\\mathrm{DD}} = \\frac{ \\left( 1 - \\dfrac{\\tau}{2} \\right) \\psi_{i-1/2} }{ 1 + \\dfrac{\\tau}{2} }。\n$$\n当 $\\tau = 3$ 时，我们有\n$$\n1 - \\frac{\\tau}{2} = 1 - \\frac{3}{2} = -\\frac{1}{2}, \\quad 1 + \\frac{\\tau}{2} = 1 + \\frac{3}{2} = \\frac{5}{2},\n$$\n因此\n$$\n\\psi_{i+1/2}^{\\mathrm{DD}} = \\frac{ -\\dfrac{1}{2} }{ \\dfrac{5}{2} } \\, \\psi_{i-1/2} = -\\frac{1}{5} \\, \\psi_{i-1/2}。\n$$\n因此，即使 $\\psi_{i-1/2}  0$ 且 $Q = 0$，$\\psi_{i+1/2}^{\\mathrm{DD}}$ 也是负值。在无源网格中，只要 $\\tau  2$，就会出现这种负值问题，因为系数 $(1 - \\tau/2)$ 变为负数，而分母 $(1 + \\tau/2)$ 仍为正数。\n\n相比之下，当 $Q = 0$ 时，SC 更新关系通过精确的衰减保证了正定性：\n$$\n\\psi_{i+1/2}^{\\mathrm{SC}} = \\psi_{i-1/2} \\exp(-\\tau),\n$$\n当 $\\psi_{i-1/2}  0$ 时，对于任何有限的 $\\tau$，该值都严格为正。\n\n归一化差异。所要求的量是\n$$\nD \\equiv \\frac{ \\psi_{i+1/2}^{\\mathrm{SC}} - \\psi_{i+1/2}^{\\mathrm{DD}} }{ \\psi_{i-1/2} }。\n$$\n代入 $Q = 0$ 和 $\\tau = 3$ 的表达式，\n$$\nD = \\exp(-3) - \\left( \\frac{ 1 - \\dfrac{3}{2} }{ 1 + \\dfrac{3}{2} } \\right) = \\exp(-3) - \\left( \\frac{ -\\dfrac{1}{2} }{ \\dfrac{5}{2} } \\right) = \\exp(-3) + \\frac{1}{5}。\n$$\n符号上计算 $\\exp(-3)$，然后求其数值：\n$$\n\\exp(-3) \\approx 0.049787068367863944.\n$$\n因此，\n$$\nD \\approx 0.049787068367863944 + 0.2 = 0.24978706836786394.\n$$\n保留五位有效数字，归一化差异为\n$$\nD \\approx 0.24979.\n$$\n这量化了在指定的光学厚度和无源条件下，阶梯特征线法相对于菱形差分法结果所提供的正向修正。在此反例中，菱形差分法的结果为负值。",
            "answer": "$$\\boxed{0.24979}$$"
        },
        {
            "introduction": "掌握了一维问题的基本原理后，下一步是将其扩展到更符合实际反应堆几何的多维情况。本练习将阶梯特征线法应用于一个二维笛卡尔网格，这要求我们不仅要沿特征线方向求解输运方程，还必须仔细进行几何分析，以确定出射边界的不同部分是由哪个入射边界“照亮”的。通过解决这个问题，您将亲身体验二维 SC 方法的核心扫描机制，这是理解和开发现代中子输运程序的基础 。",
            "id": "4251992",
            "problem": "考虑在均匀吸收介质中的稳态单能中子输运，其中存在一个网格内恒定的体积角源 $q$（单位为：中子/立方厘米·秒·球面度）。几何形状为一个矩形笛卡尔网格，其在 $x$ 方向的宽度为 $\\Delta x$，在 $y$ 方向的高度为 $\\Delta y$。考虑单个离散纵标方向，其在 $x$ 和 $y$ 方向的方向余弦分别为 $\\mu$ 和 $\\eta$，其中 $\\mu  0$ 且 $\\eta  0$。总宏观截面为 $\\Sigma_{t}$，假定在网格内空间上是恒定的。除了给定的固定源 $q$ 之外，没有散射源。\n\n沿方向 $\\Omega$ 的角通量 $\\psi(\\mathbf{r}, \\Omega)$ 的稳态线性 Boltzmann 输运控制方程为\n$$\n\\Omega \\cdot \\nabla \\psi(\\mathbf{r}, \\Omega) + \\Sigma_{t} \\, \\psi(\\mathbf{r}, \\Omega) = q,\n$$\n在阶梯特征线假设下，$q$ 和 $\\Sigma_{t}$ 在网格内是常数。\n\n在两个入流面上，边界入流角通量是均匀的：\n- 在西面 ($x = 0$)，对于 $0 \\le y \\le \\Delta y$，有 $\\psi(0,y;\\Omega) = \\psi_{W}$。\n- 在南面 ($y = 0$)，对于 $0 \\le x \\le \\Delta x$，有 $\\psi(x,0;\\Omega) = \\psi_{S}$。\n\n你需要通过从相应的入流边界沿平行于 $\\Omega$ 的直线对输运方程的特征线解进行积分，来计算在东面 ($x = \\Delta x$) 和北面 ($y = \\Delta y$) 的出射面平均角通量：\n$$\n\\bar{\\psi}_{E} = \\frac{1}{\\Delta y} \\int_{0}^{\\Delta y} \\psi(\\Delta x, y; \\Omega) \\, dy, \\qquad\n\\bar{\\psi}_{N} = \\frac{1}{\\Delta x} \\int_{0}^{\\Delta x} \\psi(x, \\Delta y; \\Omega) \\, dx,\n$$\n\n使用以下物理上一致的参数：\n- $\\Delta x = 2.0$ 厘米，\n- $\\Delta y = 3.0$ 厘米，\n- $\\mu = 0.6$，\n- $\\eta = 0.4$，\n- $\\Sigma_{t} = 0.8$ 厘米$^{-1}$，\n- $q = 0.3$ 中子/立方厘米·秒·球面度，\n- $\\psi_{W} = 1.1$ 中子/平方厘米·秒·球面度，\n- $\\psi_{S} = 0.9$ 中子/平方厘米·秒·球面度。\n\n将 $\\bar{\\psi}_{E}$ 和 $\\bar{\\psi}_{N}$ 以（中子/平方厘米·秒·球面度）为单位表示。将最终数值结果四舍五入到 $4$ 位有效数字。将最终答案以二元行矩阵 $\\begin{pmatrix} \\bar{\\psi}_{E}  \\bar{\\psi}_{N} \\end{pmatrix}$ 的形式报告。",
            "solution": "该问题是适定的，有科学依据，并包含了推导唯一解所需的所有信息。参数在物理上是一致的。验证成功，解题过程如下。\n\n在二维笛卡尔坐标系中，对于具有方向余弦 $\\mu$ 和 $\\eta$ 的单个离散方向，其稳态单能线性 Boltzmann 输运控制方程为：\n$$\n\\mu \\frac{\\partial \\psi}{\\partial x} + \\eta \\frac{\\partial \\psi}{\\partial y} + \\Sigma_t \\psi = q\n$$\n此处，$\\psi(x, y)$ 是角通量，$\\Sigma_t$ 是恒定的总宏观截面，$q$ 是恒定的体积角源。给定 $\\mu  0$ 和 $\\eta  0$，这表示粒子从 $x$ 和 $y$ 的负方向朝正 $x$ 和正 $y$ 方向流动。因此，西面 ($x=0$) 和南面 ($y=0$) 是入流边界，东面 ($x=\\Delta x$) 和北面 ($y=\\Delta y$) 是出流边界。\n\n该方程是一个一阶线性偏微分方程，可以用特征线法求解。特征线是平行于方向向量 $\\Omega = (\\mu, \\eta, ...)$ 的直线路径。该方程可以改写为方向导数的形式：\n$$\n\\frac{d\\psi}{ds} + \\Sigma_t \\psi = q\n$$\n其中 $s$ 是沿方向 $\\Omega$ 的路径长度。这是一个关于 $\\psi$ 作为 $s$ 的函数的一阶线性常微分方程。其解为：\n$$\n\\psi(s) = \\psi(0) \\exp(-\\Sigma_t s) + \\frac{q}{\\Sigma_t} \\left(1 - \\exp(-\\Sigma_t s)\\right)\n$$\n其中 $\\psi(0)$ 是在入流边界上特征线起点（$s=0$）处的角通量，$\\psi(s)$ 是在网格内穿行距离 $s$ 后的通量。\n\n一个关键步骤是确定出流边界的哪些部分由入流边界的哪些部分到达。从左下角 $(0,0)$ 出发的特征线方程为 $y = (\\eta/\\mu)x$。我们必须确定这条线从尺寸为 $\\Delta x \\times \\Delta y$ 的网格的何处穿出。\n\n这条线与东面 ($x=\\Delta x$) 相交的位置在 $y_{cross} = (\\eta/\\mu) \\Delta x$。\n这条线与北面 ($y=\\Delta y$) 相交的位置在 $x_{cross} = (\\mu/\\eta) \\Delta y$。\n\n使用给定值：\n- $\\Delta x = 2.0$ 厘米, $\\Delta y = 3.0$ 厘米, $\\mu = 0.6$, $\\eta = 0.4$。\n- $y_{cross} = \\frac{0.4}{0.6} \\times 2.0 = \\frac{2}{3} \\times 2.0 = \\frac{4}{3} \\approx 1.333$ 厘米。\n由于 $0  y_{cross}  \\Delta y$，从 $(0,0)$ 出发的特征线从东面穿出。这有两个重要的推论：\n1.  东面 ($x=\\Delta x$) 被分为两段。下半段 ($0 \\le y \\le y_{cross}$) 由从南面 ($y=0$) 出发的特征线到达。上半段 ($y_{cross} \\le y \\le \\Delta y$) 由从西面 ($x=0$) 出发的特征线到达。\n2.  整个北面 ($y=\\Delta y, 0 \\le x \\le \\Delta x$) 仅由从西面 ($x=0$) 出发的特征线到达。这是因为任何到达北面的特征线都必须在网格内部穿过直线 $y=y_{cross}$，这意味着它必定来自西面。\n\n首先，我们计算北面上的平均角通量 $\\bar{\\psi}_{N}$。\n到达北面上一点 $(x, \\Delta y)$ 的特征线始于西面上的一点 $(0, y_{in})$。路径长度 $s$ 由 $y = \\eta s$ 给出，因此 $s = \\Delta y/\\eta$。然而，这是不正确的，因为特征线同时在 $x$ 和 $y$ 方向移动。正确的路径长度为 $s = x/\\mu$ (如果从西面出发) 或 $s = y/\\eta$ (如果从南面出发)。到达北面 $(x, \\Delta y)$ 的特征线从西面 $(0, y_{in})$ 出发，其路径长度为 $s = \\Delta y / \\eta$ 吗？不，到达点 $(x, \\Delta y)$ 的特征线从 $(0, \\Delta y - (\\eta/\\mu)x)$ 出发，路径长度是 $s = x/\\mu$。\n因此，在 $(x, \\Delta y)$ 处的通量为：\n$$\n\\psi(x, \\Delta y) = \\psi_W \\exp\\left(-\\frac{\\Sigma_t x}{\\mu}\\right) + \\frac{q}{\\Sigma_t}\\left(1 - \\exp\\left(-\\frac{\\Sigma_t x}{\\mu}\\right)\\right)\n$$\n北面上的平均通量为：\n$$\n\\bar{\\psi}_{N} = \\frac{1}{\\Delta x} \\int_{0}^{\\Delta x} \\psi(x, \\Delta y) \\, dx = \\frac{1}{\\Delta x} \\int_{0}^{\\Delta x} \\left[ \\left(\\psi_W - \\frac{q}{\\Sigma_t}\\right)\\exp\\left(-\\frac{\\Sigma_t x}{\\mu}\\right) + \\frac{q}{\\Sigma_t} \\right] dx\n$$\n令 $\\tau_x = \\frac{\\Sigma_t \\Delta x}{\\mu}$ 为 $x$ 方向的光学厚度。积分得出：\n$$\n\\bar{\\psi}_{N} = \\frac{1}{\\Delta x} \\left[ \\left(\\psi_W - \\frac{q}{\\Sigma_t}\\right) \\left(-\\frac{\\mu}{\\Sigma_t}\\right) \\left( \\exp(-\\tau_x) - 1 \\right) + \\frac{q}{\\Sigma_t}\\Delta x \\right]\n$$\n$$\n\\bar{\\psi}_{N} = \\left(\\psi_W - \\frac{q}{\\Sigma_t}\\right) \\frac{\\mu}{\\Sigma_t \\Delta x} (1 - \\exp(-\\tau_x)) + \\frac{q}{\\Sigma_t} = \\left(\\psi_W - \\frac{q}{\\Sigma_t}\\right) \\frac{1 - \\exp(-\\tau_x)}{\\tau_x} + \\frac{q}{\\Sigma_t}\n$$\n\n接下来，我们计算东面上的平均角通量 $\\bar{\\psi}_{E}$。我们将积分分为两部分：\n$$\n\\bar{\\psi}_{E} = \\frac{1}{\\Delta y} \\left[ \\int_{0}^{y_{cross}} \\psi(\\Delta x, y) \\, dy + \\int_{y_{cross}}^{\\Delta y} \\psi(\\Delta x, y) \\, dy \\right]\n$$\n对于下半段 ($0 \\le y \\le y_{cross}$)，特征线从通量为 $\\psi_S$ 的南面出发。对于点 $(\\Delta x, y)$，特征线从南面的 $( \\Delta x - (\\mu/\\eta)y, 0)$ 出发，路径长度为 $s = y/\\eta$。通量为 $\\psi(\\Delta x, y) = \\psi_S \\exp(-\\Sigma_t y/\\eta) + \\frac{q}{\\Sigma_t}(1 - \\exp(-\\Sigma_t y/\\eta))$。该段上的平均通量 $\\bar{\\psi}_{E,S}$ 的计算方法与 $\\bar{\\psi}_N$ 类似：\n$$\n\\bar{\\psi}_{E,S} = \\frac{1}{y_{cross}} \\int_{0}^{y_{cross}} \\psi(\\Delta x, y) \\, dy = \\left(\\psi_S - \\frac{q}{\\Sigma_t}\\right) \\frac{1 - \\exp(-\\tau_{cross})}{\\tau_{cross}} + \\frac{q}{\\Sigma_t}\n$$\n其中 $\\tau_{cross} = \\frac{\\Sigma_t y_{cross}}{\\eta} = \\frac{\\Sigma_t (\\eta/\\mu)\\Delta x}{\\eta} = \\frac{\\Sigma_t \\Delta x}{\\mu} = \\tau_x$。因此：\n$$\n\\bar{\\psi}_{E,S} = \\left(\\psi_S - \\frac{q}{\\Sigma_t}\\right) \\frac{1 - \\exp(-\\tau_x)}{\\tau_x} + \\frac{q}{\\Sigma_t}\n$$\n对于上半段 ($y_{cross} \\le y \\le \\Delta y$)，特征线从通量为 $\\psi_W$ 的西面出发。所有这些特征线的路径长度是恒定的，$s = \\Delta x / \\mu$。因此，通量在该段上是恒定的：\n$$\n\\psi(\\Delta x, y) = \\bar{\\psi}_{E,W} = \\psi_W \\exp(-\\tau_x) + \\frac{q}{\\Sigma_t}(1-\\exp(-\\tau_x))\n$$\n东面上的总平均通量是这两段上通量的加权平均值：\n$$\n\\bar{\\psi}_{E} = \\frac{y_{cross}}{\\Delta y} \\bar{\\psi}_{E,S} + \\frac{\\Delta y - y_{cross}}{\\Delta y} \\bar{\\psi}_{E,W}\n$$\n\n现在，我们代入数值：\n- $\\Sigma_t = 0.8$, $q = 0.3 \\implies q/\\Sigma_t = 0.3/0.8 = 0.375$。\n- $\\psi_W = 1.1$, $\\psi_S = 0.9$。\n- $\\tau_x = \\frac{\\Sigma_t \\Delta x}{\\mu} = \\frac{0.8 \\times 2.0}{0.6} = \\frac{1.6}{0.6} = \\frac{8}{3}$。\n- $\\exp(-\\tau_x) = \\exp(-8/3) \\approx 0.069477$。\n- $\\frac{1 - \\exp(-\\tau_x)}{\\tau_x} = \\frac{1 - \\exp(-8/3)}{8/3} \\approx \\frac{1 - 0.069477}{2.6666...} \\approx 0.348946$。\n\n$\\bar{\\psi}_N$ 的计算：\n$$\n\\bar{\\psi}_N \\approx (1.1 - 0.375) \\times 0.348946 + 0.375 = 0.725 \\times 0.348946 + 0.375\n$$\n$$\n\\bar{\\psi}_N \\approx 0.252986 + 0.375 = 0.627986 \\approx 0.6280\n$$\n\n$\\bar{\\psi}_E$ 的计算：\n- $y_{cross} = 4/3$ 厘米。$\\Delta y = 3$ 厘米。\n- 权重因子：$\\frac{y_{cross}}{\\Delta y} = \\frac{4/3}{3} = \\frac{4}{9}$，以及 $\\frac{\\Delta y - y_{cross}}{\\Delta y} = \\frac{3-4/3}{3} = \\frac{5/3}{3} = \\frac{5}{9}$。\n- 来自南面部分的平均通量：\n$$\n\\bar{\\psi}_{E,S} \\approx (0.9 - 0.375) \\times 0.348946 + 0.375 = 0.525 \\times 0.348946 + 0.375\n$$\n$$\n\\bar{\\psi}_{E,S} \\approx 0.183197 + 0.375 = 0.558197\n$$\n- 来自西面部分的通量：\n$$\n\\bar{\\psi}_{E,W} \\approx 1.1 \\times 0.069477 + 0.375 \\times (1 - 0.069477) = 0.076425 + 0.348946\n$$\n$$\n\\bar{\\psi}_{E,W} \\approx 0.425371\n$$\n- 东面上的总平均通量：\n$$\n\\bar{\\psi}_E \\approx \\frac{4}{9} \\times 0.558197 + \\frac{5}{9} \\times 0.425371 \\approx 0.248088 + 0.236317\n$$\n$$\n\\bar{\\psi}_E \\approx 0.484405 \\approx 0.4844\n$$\n将所求值四舍五入到 $4$ 位有效数字，得到 $\\bar{\\psi}_{E} = 0.4844$ 和 $\\bar{\\psi}_{N} = 0.6280$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4844  0.6280\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在包含高阶各向异性散射的复杂输运问题中，源项迭代过程有时会因数值近似而产生小的负值，这威胁到解的物理实在性。一个稳健的数值方法不仅要准确，还必须能够优雅地处理这类异常情况，以维持解的正定性。本练习探讨了修正负源项的几种“修复”策略，迫使我们深入思考守恒性、精度和数值稳定性之间的权衡，从而揭示了在开发实用级计算程序时为保证物理解的可靠性所采用的精密技术 。",
            "id": "4252046",
            "problem": "在离散纵标法（DO，也称为 $S_N$）框架下，考虑一个均匀平板中的一维稳态输运问题。沿方向余弦 $\\,\\mu \\in (0,1]\\,$ 的角通量 $\\,\\psi(x,\\mu)\\,$ 满足线性玻尔兹曼输运方程\n$$\n\\mu \\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\,\\psi(x,\\mu) \\;=\\; Q(x,\\mu),\n$$\n其中 $\\,\\Sigma_t0\\,$ 是常数总宏观截面，$\\,Q(x,\\mu)\\,$ 是在源迭代中由散射和裂变贡献构建的网格内各向同性等效源。在宽度为 $\\,h\\,$ 的网格上，阶梯特征线法（SC）空间离散化的过程是：假设每个纵标的源在网格上是常数，即 $\\,Q(x,\\mu) \\equiv Q_c(\\mu)\\,$，然后沿特征线从 $\\,x=0\\,$ 处的入射边界扫描到 $\\,x=h\\,$ 处的出射边界。已知如果入射角通量 $\\,\\psi_{\\mathrm{in}}(\\mu) \\ge 0\\,$ 和源 $\\,Q_c(\\mu) \\ge 0\\,$ 均为非负，则网格内的 SC 解处处非负。然而，在高阶各向异性散射设置或迭代滞后情况下，计算出的网格源 $\\,Q_c(\\mu)\\,$ 对于某些纵标可能会变为轻微的负值，即使真实的物理源是非负的。这会威胁到网格解的正性。\n\n对于一个特定的纵标 $\\,\\mu0\\,$，假设以下设定：\n- 入射角通量 $\\,\\psi_{\\mathrm{in}} \\ge 0\\,$ 是给定的。\n- SC 方法使用上一次迭代得到的滞后角通量 $\\,\\hat{\\psi}(x,\\mu) \\ge 0\\,$，它在网格内是分段常数，因此其网格值 $\\,\\hat{\\psi}_c\\ge 0\\,$ 是可用的。\n- 计算出的网格源 $\\,Q_c  0\\,$ 是负的但数值很小，当 $\\,h \\to 0\\,$ 时，有 $\\,|Q_c| = \\mathcal{O}(h)\\,$。\n\n要求您为 $\\,Q_c\\,$ 选择一种保正修复策略，并严格地根据第一性原理和公认事实（线性玻尔兹曼输运方程和 SC 方法的网格常数源假设），论证其对网格守恒性和精度的影响。考虑以下四种候选策略，每种策略都在网格内对所考虑的纵标独立应用：\n- A) 源截断：定义 $\\,Q_c^\\star = \\max(Q_c,0)\\,$，并保持 $\\,\\Sigma_t\\,$ 不变。\n- B) 带滞后通量补偿的非负源分裂：选择最小的 $\\,\\alpha \\ge 0\\,$ 使得 $\\,Q_c + \\alpha\\,\\hat{\\psi}_c \\ge 0\\,$，设置 $\\,Q_c^\\star = Q_c + \\alpha\\,\\hat{\\psi}_c\\,$，并同时在网格内设置一个修正的移出项 $\\,\\Sigma_t^\\star = \\Sigma_t + \\alpha\\,$。\n- C) 源的斜率限制线性重构：重构一个分段线性源 $\\,Q(x) = Q_c + s(x - h/2)\\,$，通过对 $\\,s\\,$ 使用限制器使其边界值非负，同时保持网格平均值 $\\,Q_c\\,$ 不变；保持 $\\,\\Sigma_t\\,$ 不变。\n- D) 均匀加性偏置：选择一个全局常数 $\\,\\beta\\,$（与方向和网格无关），使得对所有网格和纵标都有 $\\,Q_c^\\star = Q_c + \\beta \\ge 0\\,$；保持 $\\,\\Sigma_t\\,$ 不变。\n\n在所述假设下，哪种策略在网格内应用时，能对所有光学厚度值 $\\,\\tau = \\Sigma_t h\\,$ 保证 SC 解的非负性，在 SC 扫描中对修正后的系数保持精确的局部离散守恒，并且仅对角通量引入一个高阶微扰（特别地，在小网格极限下，当 $\\,|Q_c|=\\mathcal{O}(h)\\,$ 时，微扰为 $\\,\\mathcal{O}(\\tau^2)\\,$），从而不降低 SC 的形式一阶精度？\n\n选择唯一的最佳选项。\n\nA) 源截断保证角通量非负；它是局部守恒的，其精度影响为 $\\,\\mathcal{O}(\\tau^2)\\,$。\n\nB) 带滞后通量补偿的非负源分裂保证角通量非负；它对于修正后的算子是局部守恒的，其精度影响为 $\\,\\mathcal{O}(\\tau^2)\\,$。\n\nC) 斜率限制线性重构即使在 $\\,Q_c  0\\,$ 时也保证角通量非负；它是局部守恒的，其精度影响为 $\\,\\mathcal{O}(\\tau^2)\\,$。\n\nD) 均匀加性偏置保证角通量非负；它是局部守恒的，其精度影响为 $\\,\\mathcal{O}(\\tau^2)\\,$。",
            "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于成熟的粒子输运数值方法理论，问题提法得当、客观，并包含足够的信息以进行严格的分析。\n\n分析将首先推导阶梯特征线法（SC）的基本方程，然后根据三个要求准则对四种提出的修复策略进行评估：\n1.  在给定非负入射 $\\psi_{\\text{in}} \\ge 0$ 的条件下，对任何光学厚度 $\\tau  0$ 都能保证解的非负性。\n2.  对修正后的系数保持精确的局部离散守恒。\n3.  在小网格极限（$h \\to 0$）下，对角通量引入的微扰为 $\\mathcal{O}(\\tau^2)$ 阶，其中 $\\tau = \\Sigma_t h / \\mu$ 且 $|Q_c| = \\mathcal{O}(h)$。\n\n对于给定的纵标 $\\mu  0$，一维稳态输运方程为\n$$ \\mu \\frac{d\\psi}{dx} + \\Sigma_t \\psi = Q(x) $$\nSC 方法假设在宽度为 $h$ 的网格上源 $Q_c$ 是常数。给定 $x=0$ 处的入射通量 $\\psi_{\\text{in}}$，在 $x=h$ 处的出射通量 $\\psi_{\\text{out}}$ 的精确解为：\n$$ \\psi_{\\text{out}} = \\psi_{\\text{in}} e^{-\\Sigma_t h / \\mu} + \\frac{Q_c}{\\Sigma_t} (1 - e^{-\\Sigma_t h / \\mu}) $$\n令 $\\tau_0 = \\Sigma_t h / \\mu$ 为光学程。方程变为：\n$$ \\psi_{\\text{out}} = \\psi_{\\text{in}} e^{-\\tau_0} + \\frac{Q_c}{\\Sigma_t} (1 - e^{-\\tau_0}) $$\n对于一个非负解（$\\psi_{\\text{out}} \\ge 0$），给定 $\\psi_{\\text{in}} \\ge 0$，并且由于 $e^{-\\tau_0} \\in (0, 1]$ 和 $(1-e^{-\\tau_0}) \\ge 0$，必须有 $Q_c \\ge 0$。问题在于 $Q_c  0$。\n\n网格的 SC 离散平衡方程是：\n$$ \\frac{\\mu}{h} (\\psi_{\\text{out}} - \\psi_{\\text{in}}) + \\Sigma_t \\bar{\\psi} = Q_c $$\n其中 $\\bar{\\psi}$ 是网格平均角通量。如果使用修正系数 $Q_c^\\star$ 和 $\\Sigma_t^\\star$ 的修复策略得到的通量 $\\psi_{\\text{out}}^\\star$ 和 $\\bar{\\psi}^\\star$ 满足使用这些新系数的平衡方程，则认为该策略“对于修正后的系数是局部守恒的”：\n$$ \\frac{\\mu}{h} (\\psi_{\\text{out}}^\\star - \\psi_{\\text{in}}) + \\Sigma_t^\\star \\bar{\\psi}^\\star = Q_c^\\star $$\n只要扫描过程与修正后的系数一致，SC 格式的定义就保证了这一点。我们将要考虑的一种更严格且物理意义更强的守恒形式是，该格式是否相对于原始的、未修正的输运算子守恒粒子。\n\n我们现在评估每种策略。\n\n**A) 源截断：$Q_c^\\star = \\max(Q_c, 0)$, $\\Sigma_t^\\star = \\Sigma_t$**\n由于 $Q_c  0$，修复为 $Q_c^\\star = 0$。\n1.  **正性**：修正后的出射通量为 $\\psi_{\\text{out}}^\\star = \\psi_{\\text{in}} e^{-\\tau_0} + \\frac{0}{\\Sigma_t}(1-e^{-\\tau_0}) = \\psi_{\\text{in}} e^{-\\tau_0}$。给定 $\\psi_{\\text{in}} \\ge 0$，$\\psi_{\\text{out}}^\\star$ 保证是非负的。\n2.  **守恒性**：该格式对于修正后的系数 $(\\Sigma_t, 0)$ 是守恒的。然而，选项 A 中的说法是“它是局部守恒的”。这个陈述是含糊的。如果按标准的、强烈的意义来解释，它意味着相对于原始源 $Q_c$ 的守恒。修正后的平衡方程是 $\\frac{\\mu}{h}(\\psi_{\\text{out}}^\\star - \\psi_{\\text{in}}) + \\Sigma_t \\bar{\\psi}^\\star = 0$。而原始的平衡方程要求右侧是 $Q_c$。通过将源设置为零，单位体积单位时间内 $Q_c$ 数量的粒子从平衡中丢失了。这违反了粒子数守恒，并且已知对源迭代的收敛是有害的。因此，未经限定的“它是局部守恒的”这一说法是错误的。\n3.  **精度**：对出射通量的微扰是 $\\Delta\\psi_{\\text{out}} = \\psi_{\\text{out}}^\\star - \\psi_{\\text{out}} = -\\frac{Q_c}{\\Sigma_t}(1 - e^{-\\tau_0})$。在小网格极限下（$h \\to 0$），$\\tau_0 = \\mathcal{O}(h)$ 且 $1-e^{-\\tau_0} \\approx \\tau_0 = \\mathcal{O}(h)$。给定 $|Q_c|=\\mathcal{O}(h)$，微扰为 $|\\Delta\\psi_{\\text{out}}| \\approx |-\\frac{Q_c}{\\Sigma_t} \\tau_0| = |-\\frac{Q_c}{\\Sigma_t} \\frac{\\Sigma_t h}{\\mu}| = \\frac{|Q_c|h}{\\mu} = \\mathcal{O}(h) \\cdot \\mathcal{O}(h) = \\mathcal{O}(h^2)$。由于 $\\tau_0 = \\mathcal{O}(h)$，$\\mathcal{O}(h^2)$ 等价于 $\\mathcal{O}(\\tau_0^2)$。精度条件得到满足。\n尽管满足了两个准则，但“局部守恒”的说法在其物理意义上是错误的，这使得选项 A 不正确。\n\n**B) 带滞后通量补偿的非负源分裂**\n该策略设置 $Q_c^\\star = Q_c + \\alpha\\hat{\\psi}_c$ 和 $\\Sigma_t^\\star = \\Sigma_t + \\alpha$，其中 $\\alpha \\ge 0$ 是为使 $Q_c^\\star \\ge 0$ 而选择的最小值。\n假设 $\\hat{\\psi}_c  0$，则最小的 $\\alpha$ 是 $\\alpha = -Q_c / \\hat{\\psi}_c$，这使得 $Q_c^\\star = 0$。问题背景涉及“散射和裂变贡献”，强烈暗示这是一个物理介质，其中的通量 $\\hat{\\psi}_c$ 不为零；在 $Q_c \\neq 0$ 的区域中，$\\hat{\\psi}_c=0$ 的情况是不符合物理实际的。\n1.  **正性**：当 $\\alpha = -Q_c/\\hat{\\psi}_c  0$ 时，我们有 $Q_c^\\star=0$ 和 $\\Sigma_t^\\star = \\Sigma_t - Q_c/\\hat{\\psi}_c  \\Sigma_t  0$。修正后的出射通量为 $\\psi_{\\text{out}}^\\star = \\psi_{\\text{in}} e^{-\\tau^\\star}$，其中 $\\tau^\\star = \\Sigma_t^\\star h/\\mu$。由于 $\\psi_{\\text{in}} \\ge 0$，正性得到保证。\n2.  **守恒性**：声称“对于修正后的算子是局部守恒的”，根据 SC 方法的构造，这是正确的。更重要的是，该方法是通过将输运方程重写为 $\\mu\\psi' + (\\Sigma_t+\\alpha)\\psi = Q_c + \\alpha\\psi$ 并用滞后通量 $\\hat{\\psi}_c$ 近似右侧项而推导出来的。此过程相对于原始算子是粒子守恒的，误差为滞后误差 $\\alpha(\\psi-\\hat{\\psi}_c)$。这是一种远优于简单截断的守恒性质。\n3.  **精度**：微扰为 $\\Delta\\psi_{\\text{out}} = \\psi_{\\text{out}}^\\star - \\psi_{\\text{out}} = \\psi_{\\text{in}}e^{-\\tau^\\star} - (\\psi_{\\text{in}}e^{-\\tau_0} + \\frac{Q_c}{\\Sigma_t}(1 - e^{-\\tau_0}))$。对于小的 $h$，$\\alpha = -Q_c/\\hat{\\psi}_c = \\mathcal{O}(h)$。光学厚度的变化是 $\\tau^\\star - \\tau_0 = \\alpha h/\\mu = \\mathcal{O}(h^2)$。所以，$e^{-\\tau^\\star} - e^{-\\tau_0} = e^{-\\tau_0}(e^{-(\\tau^\\star-\\tau_0)} - 1) \\approx (1-\\tau_0)(1 - (\\tau^\\star-\\tau_0) - 1) = -(1-\\tau_0)(\\tau^\\star-\\tau_0) = \\mathcal{O}(h^2)$。$\\psi_{\\text{in}}$ 项的变化是 $\\psi_{\\text{in}}(e^{-\\tau^\\star}-e^{-\\tau_0}) = \\mathcal{O}(h^2)$。另一项是 $-\\frac{Q_c}{\\Sigma_t}(1 - e^{-\\tau_0}) = \\mathcal{O}(h) \\cdot \\mathcal{O}(h) = \\mathcal{O}(h^2)$。总微扰为 $\\Delta\\psi_{\\text{out}} = \\mathcal{O}(h^2) = \\mathcal{O}(\\tau_0^2)$。因此，所有三个条件都得到满足。\n\n**C) 源的斜率限制线性重构**\n该策略建议使用一个线性源 $Q(x) = Q_c + s(x-h/2)$，它必须是非负的，即对于 $x \\in [0,h]$ 有 $Q(x) \\ge 0$，同时保持网格平均值 $Q_c  0$ 不变。一个非负函数的平均值本身也必须是非负的。由于平均值是 $Q_c$，我们必须有 $Q_c \\ge 0$。这与给定条件 $Q_c  0$ 相矛盾。因此，所提出的源重构在数学上是不可能的。选项 C 不正确。\n\n**D) 均匀加性偏置：$Q_c^\\star = Q_c+\\beta$, $\\Sigma_t^\\star=\\Sigma_t$**\n这里，$\\beta$ 是一个与网格或方向无关的全局常数，选择它的目的是使所有源都非负。这意味着 $\\beta \\ge -\\min_{c,\\mu} Q_c(c,\\mu)$。\n1.  **正性**：当 $Q_c^\\star = Q_c+\\beta \\ge 0$ 时，修正后的出射通量 $\\psi_{\\text{out}}^\\star = \\psi_{\\text{in}} e^{-\\tau_0} + \\frac{Q_c+\\beta}{\\Sigma_t}(1-e^{-\\tau_0})$ 保证是非负的。\n2.  **守恒性**：与截断法类似，该方法相对于原始物理过程是不守恒的。它在整个计算域内增加了一个伪源 $\\beta$。\n3.  **精度**：微扰是 $\\Delta\\psi_{\\text{out}} = \\frac{\\beta}{\\Sigma_t}(1-e^{-\\tau_0})$。参数 $\\beta$ 是一个全局常数，由整个问题中最小的负源决定。它不随局部网格尺寸 $h$ 缩放。在小网格极限下，$1-e^{-\\tau_0} \\approx \\tau_0 = \\Sigma_t h/\\mu = \\mathcal{O}(h)$。因此，$\\Delta\\psi_{\\text{out}} \\approx \\frac{\\beta}{\\Sigma_t} (\\frac{\\Sigma_t h}{\\mu}) = \\frac{\\beta h}{\\mu} = \\mathcal{O}(h)$。这是一个一阶微扰，而不是二阶微扰。它的阶数与方法本身的内在误差相同，这是不可接受的并且会降低精度。精度要求 $\\mathcal{O}(\\tau^2)$ 未被满足。选项 D 不正确。\n\n结论：在对问题陈述进行物理上合理的解释下，策略 B 是唯一满足所有三个准则的策略。它保证了正性，以一种明确定义且具有物理意义的方式守恒（与 A 和 D 不同），并且只对解引入了高阶微扰。\n\n对每个选项陈述的最终裁定：\n- A) 不正确。“它是局部守恒的”这一说法在强意义上是错误的。\n- B) 正确。所有说法都是正确的，前提是假设需要进行修复的物理必要条件是 $\\hat{\\psi}_c  0$。\n- C) 不正确。所描述的策略在数学上是不可能的。\n- D) 不正确。精度影响是 $\\mathcal{O}(\\tau)$，而不是 $\\mathcal{O}(\\tau^2)$。\n\n因此，选项 B 是唯一的最佳选项。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}