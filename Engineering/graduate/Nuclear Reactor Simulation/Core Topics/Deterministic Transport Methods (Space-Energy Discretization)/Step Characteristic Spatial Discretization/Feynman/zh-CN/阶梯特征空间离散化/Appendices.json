{
    "hands_on_practices": [
        {
            "introduction": "数值方法有时会产生非物理的结果，例如负的中子通量。本练习将步进特征线 (Step Characteristic, SC) 方法与广为人知的菱形差分 (Diamond Difference, DD) 方法进行对比，以展示 SC 的一个关键优势：在特定条件下其固有的正定性。通过这个具体的反例 ，您将深刻理解为何 SC 是求解粒子输运问题时的一个稳健选择。",
            "id": "4252019",
            "problem": "考虑一个宽度为 $\\Delta x$ 的一维平板单元，在稳态、单能的离散纵标方法 (DOM) 计算中。对于方向余弦为 $\\mu \\in (0,1]$ 的单个离散方向，单元内的角通量 $\\psi(x)$ 满足一阶线性输运方程\n$$\n\\mu \\frac{d \\psi(x)}{dx} + \\Sigma_{t} \\psi(x) = Q,\n$$\n其中总宏观截面 $\\Sigma_{t} > 0$，且整个单元内有常数体源 $Q \\ge 0$。设入射面位于 $x = x_{i-1/2}$，其入射角通量已知为 $\\psi_{i-1/2} \\equiv \\psi(x_{i-1/2})$；出射面位于 $x = x_{i+1/2}$，其出射角通量未知为 $\\psi_{i+1/2} \\equiv \\psi(x_{i+1/2})$。定义离散方向上的光学厚度为\n$$\n\\tau \\equiv \\frac{\\Sigma_{t} \\Delta x}{\\mu}.\n$$\n从输运方程出发，推导：\n- 菱形差分 (DD) 的面-面更新关系式，通过对单元守恒方程积分并使用线性平均 $\\bar{\\psi} = (\\psi_{i-1/2} + \\psi_{i+1/2})/2$ 进行封闭。\n- 步进特征线 (SC) 的面-面更新关系式，通过在常系数条件下精确求解单元内的微分方程。\n\n使用这两种更新关系式，在相同的光学厚度和源条件下，分析产生负出射通量的可能性。以一个无体源 $Q=0$、光学厚度 $\\tau=3$ 且入射通量为正值 $\\psi_{i-1/2} > 0$ 的反例进行分析。\n\n计算 SC 和 DD 出射面通量之间的归一化差异，\n$$\nD \\equiv \\frac{\\psi_{i+1/2}^{\\mathrm{SC}} - \\psi_{i+1/2}^{\\mathrm{DD}}}{\\psi_{i-1/2}},\n$$\n在指定条件下，并给出其数值，保留五位有效数字。将最终答案表示为一个无量纲数（无单位）。",
            "solution": "我们从一维稳态单能输运方程开始，该方程描述了方向余弦为 $\\mu \\in (0,1]$ 的单个离散方向：\n$$\n\\mu \\frac{d \\psi(x)}{dx} + \\Sigma_{t} \\psi(x) = Q,\n$$\n其中 $\\Sigma_{t} > 0$ 且源 $Q \\ge 0$ 在单元内为常数。\n\n定义左（入射）面角通量为 $\\psi_{i-1/2} = \\psi(x_{i-1/2})$，右（出射）面角通量为 $\\psi_{i+1/2} = \\psi(x_{i+1/2})$，单元宽度为 $\\Delta x = x_{i+1/2} - x_{i-1/2}$。沿方向 $\\mu$ 的光学厚度为\n$$\n\\tau \\equiv \\frac{\\Sigma_{t} \\Delta x}{\\mu}.\n$$\n\n菱形差分 (DD) 更新。我们从积分形式的单元守恒方程推导 DD。将输运方程在 $x \\in [x_{i-1/2}, x_{i+1/2}]$ 上积分，\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\mu \\frac{d \\psi}{dx} + \\Sigma_{t} \\psi \\right) \\, dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} Q \\, dx.\n$$\n左边可以分为\n$$\n\\mu \\left[ \\psi_{i+1/2} - \\psi_{i-1/2} \\right] + \\Sigma_{t} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\psi(x) \\, dx = Q \\Delta x.\n$$\n引入单元平均角通量\n$$\n\\bar{\\psi} \\equiv \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\psi(x) \\, dx,\n$$\n得到精确的单元守恒方程\n$$\n\\mu \\left( \\psi_{i+1/2} - \\psi_{i-1/2} \\right) + \\Sigma_{t} \\Delta x \\, \\bar{\\psi} = Q \\Delta x.\n$$\n菱形差分封闭关系假设通量呈线性变化，并设定\n$$\n\\bar{\\psi} = \\frac{\\psi_{i-1/2} + \\psi_{i+1/2}}{2}.\n$$\n将此关系代入守恒方程并除以 $\\mu$：\n$$\n\\left( \\psi_{i+1/2} - \\psi_{i-1/2} \\right) + \\frac{\\Sigma_{t} \\Delta x}{2 \\mu} \\left( \\psi_{i+1/2} + \\psi_{i-1/2} \\right) = \\frac{Q \\Delta x}{\\mu}.\n$$\n使用 $\\tau = \\Sigma_{t} \\Delta x / \\mu$，上式变为\n$$\n\\left( 1 + \\frac{\\tau}{2} \\right) \\psi_{i+1/2} + \\left( -1 + \\frac{\\tau}{2} \\right) \\psi_{i-1/2} = \\frac{Q \\Delta x}{\\mu}.\n$$\n求解出射面通量，\n$$\n\\psi_{i+1/2}^{\\mathrm{DD}} = \\frac{ \\dfrac{Q \\Delta x}{\\mu} + \\left( 1 - \\dfrac{\\tau}{2} \\right) \\psi_{i-1/2} }{ 1 + \\dfrac{\\tau}{2} }.\n$$\n这就是关联面通量和单元源的 DD 更新关系式。\n\n步进特征线 (SC) 更新。SC 在均匀单元内精确求解微分方程。将输运方程重写为\n$$\n\\frac{d \\psi}{dx} + \\frac{\\Sigma_{t}}{\\mu} \\psi = \\frac{Q}{\\mu}.\n$$\n这是一个系数为常数的一阶线性常微分方程。其积分因子为\n$$\nI(x) = \\exp\\!\\left( \\frac{\\Sigma_{t}}{\\mu} x \\right).\n$$\n两边同乘以积分因子并从 $x_{i-1/2}$ 积分到 $x$ 得到\n$$\n\\psi(x) \\, \\exp\\!\\left( \\frac{\\Sigma_{t}}{\\mu} x \\right) - \\psi_{i-1/2} \\, \\exp\\!\\left( \\frac{\\Sigma_{t}}{\\mu} x_{i-1/2} \\right) = \\int_{x_{i-1/2}}^{x} \\frac{Q}{\\mu} \\exp\\!\\left( \\frac{\\Sigma_{t}}{\\mu} s \\right) ds.\n$$\n求解 $\\psi(x)$ 并在 $x = x_{i+1/2}$ 处取值，得到\n$$\n\\psi_{i+1/2}^{\\mathrm{SC}} = \\psi_{i-1/2} \\exp(-\\tau) + \\frac{Q}{\\Sigma_{t}} \\left( 1 - \\exp(-\\tau) \\right),\n$$\n这里我们使用了 $\\tau = \\Sigma_{t} \\Delta x / \\mu$ 以及指数源项的精确积分结果。\n\nDD 方法中负值问题的反例分析。考虑无体源 $Q=0$、光学厚度 $\\tau=3$ 且入射通量为正值 $\\psi_{i-1/2} > 0$ 的情况。在这些条件下，DD 更新关系式简化为\n$$\n\\psi_{i+1/2}^{\\mathrm{DD}} = \\frac{ \\left( 1 - \\dfrac{\\tau}{2} \\right) \\psi_{i-1/2} }{ 1 + \\dfrac{\\tau}{2} }.\n$$\n当 $\\tau = 3$ 时，我们有\n$$\n1 - \\frac{\\tau}{2} = 1 - \\frac{3}{2} = -\\frac{1}{2}, \\quad 1 + \\frac{\\tau}{2} = 1 + \\frac{3}{2} = \\frac{5}{2},\n$$\n所以\n$$\n\\psi_{i+1/2}^{\\mathrm{DD}} = \\frac{ -\\dfrac{1}{2} }{ \\dfrac{5}{2} } \\, \\psi_{i-1/2} = -\\frac{1}{5} \\, \\psi_{i-1/2}.\n$$\n因此，尽管 $\\psi_{i-1/2} > 0$ 且 $Q=0$，$\\psi_{i+1/2}^{\\mathrm{DD}}$ 却是负值。在无源单元中，只要 $\\tau > 2$，就会出现这种负值问题，因为系数 $(1 - \\tau/2)$ 变为负数，而分母 $(1 + \\tau/2)$ 仍为正数。\n\n相比之下，当 $Q=0$ 时，SC 更新关系式通过精确的衰减保证了正值性：\n$$\n\\psi_{i+1/2}^{\\mathrm{SC}} = \\psi_{i-1/2} \\exp(-\\tau),\n$$\n当 $\\psi_{i-1/2} > 0$ 时，对于任何有限的 $\\tau$，该值都严格为正。\n\n归一化差异。所要求的量是\n$$\nD \\equiv \\frac{ \\psi_{i+1/2}^{\\mathrm{SC}} - \\psi_{i+1/2}^{\\mathrm{DD}} }{ \\psi_{i-1/2} }.\n$$\n代入 $Q = 0$ 和 $\\tau = 3$ 时的表达式，\n$$\nD = \\exp(-3) - \\left( \\frac{ 1 - \\dfrac{3}{2} }{ 1 + \\dfrac{3}{2} } \\right) = \\exp(-3) - \\left( \\frac{ -\\dfrac{1}{2} }{ \\dfrac{5}{2} } \\right) = \\exp(-3) + \\frac{1}{5}.\n$$\n先符号计算 $\\exp(-3)$，然后进行数值计算：\n$$\n\\exp(-3) \\approx 0.049787068367863944.\n$$\n因此，\n$$\nD \\approx 0.049787068367863944 + 0.2 = 0.24978706836786394.\n$$\n保留五位有效数字，归一化差异为\n$$\nD \\approx 0.24979.\n$$\n这对于指定的光学厚度和无源条件，量化了步进特征线法相对于菱形差分法结果所提供的正修正。在本反例中，菱形差分法的结果为负值。",
            "answer": "$$\\boxed{0.24979}$$"
        },
        {
            "introduction": "在掌握了一维的基本原理后，我们将 SC 方法的应用扩展到一个二维空间单元。这个练习  要求仔细的几何推理，以追踪从入流边界到出流边界的特征线路径，从而揭示该方法如何处理多维输运扫描。这是理解 SC 方法在实际多维计算程序中如何应用的一项基本功。",
            "id": "4251992",
            "problem": "考虑在均匀吸收介质中的稳态单能中子输运，该介质内有一个恒定的栅元内体角源 $q$ (单位：中子/立方厘米·秒·球面度)。几何形状为一个矩形笛卡尔栅元，其在 $x$ 方向的宽度为 $\\Delta x$，在 $y$ 方向的高度为 $\\Delta y$。考虑一个单一的离散纵标方向，其在 $x$ 和 $y$ 方向的方向余弦分别为 $\\mu$ 和 $\\eta$，其中 $\\mu > 0$ 且 $\\eta > 0$。总宏观截面为 $\\Sigma_{t}$，在栅元内被认为是空间常数。除了给定的固定源 $q$ 之外，没有散射源。\n\n描述沿方向 $\\Omega$ 的角通量 $\\psi(\\mathbf{r}, \\Omega)$ 的稳态线性玻尔兹曼输运控制方程为\n$$\n\\Omega \\cdot \\nabla \\psi(\\mathbf{r}, \\Omega) + \\Sigma_{t} \\, \\psi(\\mathbf{r}, \\Omega) = q,\n$$\n在步进特征线假设下，$q$ 和 $\\Sigma_{t}$ 在栅元内是常数。\n\n在两个流入边界上，边界入射角通量是均匀的：\n- 在西面（$x = 0$），对于 $0 \\le y \\le \\Delta y$，有 $\\psi(0,y;\\Omega) = \\psi_{W}$。\n- 在南面（$y = 0$），对于 $0 \\le x \\le \\Delta x$，有 $\\psi(x,0;\\Omega) = \\psi_{S}$。\n\n你需要计算东面（$x = \\Delta x$）和北面（$y = \\Delta y$）的出射面平均角通量：\n$$\n\\bar{\\psi}_{E} = \\frac{1}{\\Delta y} \\int_{0}^{\\Delta y} \\psi(\\Delta x, y; \\Omega) \\, dy, \\qquad\n\\bar{\\psi}_{N} = \\frac{1}{\\Delta x} \\int_{0}^{\\Delta x} \\psi(x, \\Delta y; \\Omega) \\, dx,\n$$\n通过从适当的流入边界沿平行于 $\\Omega$ 的直线对输运方程的特征线解进行积分。\n\n使用以下物理上一致的参数：\n- $\\Delta x = 2.0$ 厘米，\n- $\\Delta y = 3.0$ 厘米，\n- $\\mu = 0.6$，\n- $\\eta = 0.4$，\n- $\\Sigma_{t} = 0.8$ 逆厘米，\n- $q = 0.3$ 中子/立方厘米·秒·球面度，\n- $\\psi_{W} = 1.1$ 中子/平方厘米·秒·球面度，\n- $\\psi_{S} = 0.9$ 中子/平方厘米·秒·球面度。\n\n将 $\\bar{\\psi}_{E}$ 和 $\\bar{\\psi}_{N}$ 以“中子/平方厘米·秒·球面度”为单位表示。将最终数值四舍五入到 $4$ 位有效数字。将你的最终答案以一个二元行矩阵 $\\begin{pmatrix} \\bar{\\psi}_{E}  \\bar{\\psi}_{N} \\end{pmatrix}$ 的形式报告。",
            "solution": "该问题提法恰当，有科学依据，并包含推导唯一解所需的所有信息。参数在物理上是一致的。验证成功，继续求解。\n\n在二维笛卡尔坐标系中，对于具有方向余弦 $\\mu$ 和 $\\eta$ 的单个离散方向，其稳态单能线性玻尔兹曼输运控制方程为：\n$$\n\\mu \\frac{\\partial \\psi}{\\partial x} + \\eta \\frac{\\partial \\psi}{\\partial y} + \\Sigma_t \\psi = q\n$$\n此处，$\\psi(x, y)$ 是角通量，$\\Sigma_t$ 是恒定的总宏观截面，$q$ 是恒定的体角源。给定 $\\mu > 0$ 和 $\\eta > 0$，这表示粒子从 $x$ 和 $y$ 的负方向朝正方向流动。因此，西面（$x=0$）和南面（$y=0$）是流入边界，而东面（$x=\\Delta x$）和北面（$y=\\Delta y$）是流出边界。\n\n该方程是一阶线性偏微分方程，可以使用特征线法求解。特征线是平行于方向向量 $\\Omega = (\\mu, \\eta, ...)$ 的直线路径。该方程可以重写为方向导数的形式：\n$$\n\\frac{d\\psi}{ds} + \\Sigma_t \\psi = q\n$$\n其中 $s$ 是沿方向 $\\Omega$ 的径长。这是一个关于 $s$ 的函数 $\\psi$ 的一阶线性常微分方程。其解为：\n$$\n\\psi(s) = \\psi(0) \\exp(-\\Sigma_t s) + \\frac{q}{\\Sigma_t} \\left(1 - \\exp(-\\Sigma_t s)\\right)\n$$\n其中 $\\psi(0)$ 是特征线在流入边界上的起始点（$s=0$）处的角通量，$\\psi(s)$ 是在栅元内行进距离 $s$ 后的通量。\n\n一个关键步骤是确定流出边界的哪些部分由流入边界的哪些部分所照亮。从左下角 $(0,0)$ 出发的特征线方程为 $y = (\\eta/\\mu)x$。我们必须确定这条线从尺寸为 $\\Delta x \\times \\Delta y$ 的栅元的何处穿出。\n\n这条线与东面（$x=\\Delta x$）相交的位置在 $y_{cross} = (\\eta/\\mu) \\Delta x$。\n这条线与北面（$y=\\Delta y$）相交的位置在 $x_{cross} = (\\mu/\\eta) \\Delta y$。\n\n使用给定值：\n- $\\Delta x = 2.0$ 厘米, $\\Delta y = 3.0$ 厘米, $\\mu = 0.6$, $\\eta = 0.4$。\n- $y_{cross} = \\frac{0.4}{0.6} \\times 2.0 = \\frac{2}{3} \\times 2.0 = \\frac{4}{3} \\approx 1.333$ 厘米。\n由于 $0  y_{cross}  \\Delta y$，从 $(0,0)$ 出发的特征线从东面穿出。这有两个重要后果：\n1.  东面（$x=\\Delta x$）被分为两段。下段（$0 \\le y \\le y_{cross}$）由源于南面（$y=0$）的特征线到达。上段（$y_{cross} \\le y \\le \\Delta y$）由源于西面（$x=0$）的特征线到达。\n2.  整个北面（$y=\\Delta y, 0 \\le x \\le \\Delta x$）仅由源于西面（$x=0$）的特征线到达。这是因为任何到达北面的特征线都必须在栅元内部穿过直线 $y=y_{cross}$，这意味着它必定来自西面。\n\n首先，我们计算北面上的平均角通量 $\\bar{\\psi}_{N}$。\n到达北面上一点 $(x, \\Delta y)$ 的特征线源于西面上的一点 $(0, y_{in})$。径长 $s$ 由 $x = \\mu s$ 给出，因此 $s = x/\\mu$。入射通量为 $\\psi(0, y_{in}) = \\psi_W$。\n因此，在 $(x, \\Delta y)$ 处的通量为：\n$$\n\\psi(x, \\Delta y) = \\psi_W \\exp\\left(-\\frac{\\Sigma_t x}{\\mu}\\right) + \\frac{q}{\\Sigma_t}\\left(1 - \\exp\\left(-\\frac{\\Sigma_t x}{\\mu}\\right)\\right)\n$$\n北面上的平均通量为：\n$$\n\\bar{\\psi}_{N} = \\frac{1}{\\Delta x} \\int_{0}^{\\Delta x} \\psi(x, \\Delta y) \\, dx = \\frac{1}{\\Delta x} \\int_{0}^{\\Delta x} \\left[ \\left(\\psi_W - \\frac{q}{\\Sigma_t}\\right)\\exp\\left(-\\frac{\\Sigma_t x}{\\mu}\\right) + \\frac{q}{\\Sigma_t} \\right] dx\n$$\n令 $\\tau_x = \\frac{\\Sigma_t \\Delta x}{\\mu}$ 为 $x$ 方向上的光学厚度。积分得出：\n$$\n\\bar{\\psi}_{N} = \\frac{1}{\\Delta x} \\left[ \\left(\\psi_W - \\frac{q}{\\Sigma_t}\\right) \\left(-\\frac{\\mu}{\\Sigma_t}\\right) \\left( \\exp(-\\tau_x) - 1 \\right) + \\frac{q}{\\Sigma_t}\\Delta x \\right]\n$$\n$$\n\\bar{\\psi}_{N} = \\left(\\psi_W - \\frac{q}{\\Sigma_t}\\right) \\frac{\\mu}{\\Sigma_t \\Delta x} (1 - \\exp(-\\tau_x)) + \\frac{q}{\\Sigma_t} = \\left(\\psi_W - \\frac{q}{\\Sigma_t}\\right) \\frac{1 - \\exp(-\\tau_x)}{\\tau_x} + \\frac{q}{\\Sigma_t}\n$$\n\n接下来，我们计算东面上的平均角通量 $\\bar{\\psi}_{E}$。我们将积分分成两部分：\n$$\n\\bar{\\psi}_{E} = \\frac{1}{\\Delta y} \\left[ \\int_{0}^{y_{cross}} \\psi(\\Delta x, y) \\, dy + \\int_{y_{cross}}^{\\Delta y} \\psi(\\Delta x, y) \\, dy \\right]\n$$\n对于下段（$0 \\le y \\le y_{cross}$），特征线源于南面，其通量为 $\\psi_S$。对于点 $(\\Delta x, y)$，径长为 $s = y/\\eta$。通量为 $\\psi(\\Delta x, y) = \\psi_S \\exp(-\\Sigma_t y/\\eta) + \\frac{q}{\\Sigma_t}(1 - \\exp(-\\Sigma_t y/\\eta))$。该段上的平均通量 $\\bar{\\psi}_{E,S}$ 的求解方式与 $\\bar{\\psi}_N$ 类似：\n$$\n\\bar{\\psi}_{E,S} = \\frac{1}{y_{cross}} \\int_{0}^{y_{cross}} \\psi(\\Delta x, y) \\, dy = \\left(\\psi_S - \\frac{q}{\\Sigma_t}\\right) \\frac{1 - \\exp(-\\tau_{cross})}{\\tau_{cross}} + \\frac{q}{\\Sigma_t}\n$$\n其中 $\\tau_{cross} = \\frac{\\Sigma_t y_{cross}}{\\eta} = \\frac{\\Sigma_t (\\eta/\\mu)\\Delta x}{\\eta} = \\frac{\\Sigma_t \\Delta x}{\\mu} = \\tau_x$。因此：\n$$\n\\bar{\\psi}_{E,S} = \\left(\\psi_S - \\frac{q}{\\Sigma_t}\\right) \\frac{1 - \\exp(-\\tau_x)}{\\tau_x} + \\frac{q}{\\Sigma_t}\n$$\n对于上段（$y_{cross} \\le y \\le \\Delta y$），特征线源于西面，其通量为 $\\psi_W$。所有这些特征线的径长是恒定的，为 $s = \\Delta x / \\mu$。因此，该段上的通量是恒定的：\n$$\n\\psi(\\Delta x, y) = \\bar{\\psi}_{E,W} = \\psi_W \\exp(-\\tau_x) + \\frac{q}{\\Sigma_t}(1-\\exp(-\\tau_x))\n$$\n东面上的总平均通量是这两段上通量的加权平均：\n$$\n\\bar{\\psi}_{E} = \\frac{y_{cross}}{\\Delta y} \\bar{\\psi}_{E,S} + \\frac{\\Delta y - y_{cross}}{\\Delta y} \\bar{\\psi}_{E,W}\n$$\n\n现在，我们代入数值：\n- $\\Sigma_t = 0.8$, $q = 0.3 \\implies q/\\Sigma_t = 0.3/0.8 = 0.375$。\n- $\\psi_W = 1.1$, $\\psi_S = 0.9$。\n- $\\tau_x = \\frac{\\Sigma_t \\Delta x}{\\mu} = \\frac{0.8 \\times 2.0}{0.6} = \\frac{1.6}{0.6} = \\frac{8}{3}$。\n- $\\exp(-\\tau_x) = \\exp(-8/3) \\approx 0.069477$。\n- $\\frac{1 - \\exp(-\\tau_x)}{\\tau_x} = \\frac{1 - \\exp(-8/3)}{8/3} \\approx \\frac{1 - 0.069477}{2.6666...} \\approx 0.348946$。\n\n$\\bar{\\psi}_N$ 的计算：\n$$\n\\bar{\\psi}_N \\approx (1.1 - 0.375) \\times 0.348946 + 0.375 = 0.725 \\times 0.348946 + 0.375\n$$\n$$\n\\bar{\\psi}_N \\approx 0.252986 + 0.375 = 0.627986 \\approx 0.6280\n$$\n\n$\\bar{\\psi}_E$ 的计算：\n- $y_{cross} = 4/3$ 厘米。$\\Delta y = 3$ 厘米。\n- 权重因子：$\\frac{y_{cross}}{\\Delta y} = \\frac{4/3}{3} = \\frac{4}{9}$，以及 $\\frac{\\Delta y - y_{cross}}{\\Delta y} = \\frac{3-4/3}{3} = \\frac{5/3}{3} = \\frac{5}{9}$。\n- 来自南面供给部分的平均通量：\n$$\n\\bar{\\psi}_{E,S} \\approx (0.9 - 0.375) \\times 0.348946 + 0.375 = 0.525 \\times 0.348946 + 0.375\n$$\n$$\n\\bar{\\psi}_{E,S} \\approx 0.183197 + 0.375 = 0.558197\n$$\n- 来自西面供给部分的通量：\n$$\n\\bar{\\psi}_{E,W} \\approx 1.1 \\times 0.069477 + 0.375 \\times (1 - 0.069477) = 0.076425 + 0.348946\n$$\n$$\n\\bar{\\psi}_{E,W} \\approx 0.425371\n$$\n- 东面上的总平均通量：\n$$\n\\bar{\\psi}_E \\approx \\frac{4}{9} \\times 0.558197 + \\frac{5}{9} \\times 0.425371 \\approx 0.248088 + 0.236317\n$$\n$$\n\\bar{\\psi}_E \\approx 0.484405 \\approx 0.4844\n$$\n要求的值四舍五入到 4 位有效数字为 $\\bar{\\psi}_{E} = 0.4844$ 和 $\\bar{\\psi}_{N} = 0.6280$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4844  0.6280\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后的练习将引导您从理论计算走向实际编程。您将使用“人造解方法” (Method of Manufactured Solutions, MMS)，这是一种在科学计算领域用于代码验证的强大技术。通过这个练习 ，您将亲手实现并验证一个 SC 求解器，确认其数值精度是否达到理论预期的一阶，从而掌握程序验证的关键技能。",
            "id": "4251998",
            "problem": "考虑平板几何中的稳态、单能、一维中子输运方程，其角通量为 $\\psi(x,\\mu)$，其中 $x \\in [0,L]$ 是以厘米 (cm) 为单位的空间坐标，$\\mu \\in [-1,1]$ 是方向余弦。其控制平衡方程为基本定律\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t(x) \\psi(x,\\mu) = Q(x,\\mu),\n$$\n其中 $\\Sigma_t(x)$ 是总宏观截面，单位为逆厘米 ($\\mathrm{cm}^{-1}$)，$Q(x,\\mu)$ 是一个已知源项，其单位与方程一致。假设真空边界条件被替换为从下述人造解推导得出的一致性流入边界条件，从而使边界值与所选的 $\\psi(x,\\mu)$ 精确兼容。\n\n您必须按以下方式设计一个人造解 (MS)：\n- 选择一个形式如下的光滑、严格为正的角通量\n$$\n\\psi_{\\text{MS}}(x,\\mu) = \\exp(\\alpha x) \\left(1 + \\beta \\mu + \\gamma \\sin\\left(\\frac{\\pi x}{L}\\right) \\mu^2\\right),\n$$\n其中常数 $\\alpha$ 的单位为 $\\mathrm{cm}^{-1}$，$\\beta$ 和 $\\gamma$ 为无量纲。\n- 选择一个空间变化的宏观总截面\n$$\n\\Sigma_t(x) = \\Sigma_0 \\left(1 + c \\sin\\left(\\frac{2\\pi x}{L}\\right)\\right),\n$$\n其中 $\\Sigma_0$ 的单位为 $\\mathrm{cm}^{-1}$，$c$ 是一个无量纲数，满足 $0  c  1$ 以确保 $\\Sigma_t(x)  0$。\n- 通过要求 $\\psi_{\\text{MS}}(x,\\mu)$ 精确满足输运方程来定义源项 $Q(x,\\mu)$，即：\n$$\nQ(x,\\mu) = \\mu \\frac{\\partial \\psi_{\\text{MS}}(x,\\mu)}{\\partial x} + \\Sigma_t(x)\\,\\psi_{\\text{MS}}(x,\\mu).\n$$\n\n您的任务是实现一个步进特征线 (SC) 空间离散方法，在 $x \\in [0,L]$ 上的一个包含 $N$ 个单元的均匀网格上近似求解 $\\psi(x,\\mu)$。在 SC 方法中，在每个单元 $[x_i, x_{i+1}]$ 内，将 $\\Sigma_t(x)$ 和 $Q(x,\\mu)$ 视为等于其单元平均值的常数，并对于每个离散纵标 $\\mu$，沿特征线从流入边界到流出边界推进求解。对于 $\\mu0$，在 $x=0$ 处使用流入边界值 $\\psi$；对于 $\\mu0$，在 $x=L$ 处使用流入边界值 $\\psi$。这些值设置为相应边界上对应 $\\mu$ 的 $\\psi_{\\text{MS}}$ 值，以确保人造边界条件的一致性。\n\n您必须：\n- 使用具有 $S_N$ 个点的离散纵标求积（例如 Gauss-Legendre）来表示 $\\mu$ 的角度依赖性。将求积点表示为 $\\{\\mu_k\\}$，相应权重表示为 $\\{w_k\\}$，其中 $k=1,\\dots,S_N$，且在 $\\mu \\in [-1,1]$ 上满足 $\\sum_k w_k = 2$。\n- 在单元中心 $x_i+\\Delta x/2$ 处（其中 $i=0,\\dots,N-1$）为所有 $k$ 计算数值 SC 近似解 $\\psi_{\\text{SC}}(x_i+\\Delta x/2, \\mu_k)$。\n- 在相同的点上计算精确人造解 $\\psi_{\\text{MS}}(x_i+\\Delta x/2, \\mu_k)$。\n- 测量空间和角度上的归一化均方根 ($L^2$) 误差，公式如下\n$$\nE_h = \\left[\\frac{1}{2L}\\sum_{k=1}^{S_N} w_k \\sum_{i=0}^{N-1} \\left(\\psi_{\\text{SC}}(x_i+\\tfrac{\\Delta x}{2},\\mu_k) - \\psi_{\\text{MS}}(x_i+\\tfrac{\\Delta x}{2},\\mu_k)\\right)^2 \\Delta x \\right]^{1/2},\n$$\n其中 $\\Delta x = L/N$。\n\n通过在均匀网格上当单元数量加倍时，计算观测到的精度阶来验证一阶空间收敛性\n$$\np_{\\mathrm{obs}} = \\frac{\\log\\left(E_{h}/E_{h/2}\\right)}{\\log(2)},\n$$\n\n所有空间量以厘米 (cm) 表示，所有截面以逆厘米 ($\\mathrm{cm}^{-1}$) 表示，最终的观测精度阶 $p_{\\mathrm{obs}}$ 以无量纲浮点数表示。\n\n使用以下参数集的测试套件实施上述内容，这些参数必须硬编码到程序中：\n\n- 测试用例 1 (中等光学厚度):\n    - $L = 10$ cm,\n    - $\\Sigma_0 = 0.8$ $\\mathrm{cm}^{-1}$,\n    - $c = 0.3$,\n    - $\\alpha = 0.05$ $\\mathrm{cm}^{-1}$,\n    - $\\beta = 0.3$,\n    - $\\gamma = 0.6$,\n    - $S_N = 8$,\n    - 网格数量 $N = 40$ 和 $N = 80$。\n\n- 测试用例 2 (光学薄):\n    - $L = 10$ cm,\n    - $\\Sigma_0 = 0.1$ $\\mathrm{cm}^{-1}$,\n    - $c = 0.2$,\n    - $\\alpha = 0.05$ $\\mathrm{cm}^{-1}$,\n    - $\\beta = 0.3$,\n    - $\\gamma = 0.6$,\n    - $S_N = 8$,\n    - 网格数量 $N = 40$ 和 $N = 80$。\n\n- 测试用例 3 (光学厚):\n    - $L = 10$ cm,\n    - $\\Sigma_0 = 3.0$ $\\mathrm{cm}^{-1}$,\n    - $c = 0.2$,\n    - $\\alpha = 0.05$ $\\mathrm{cm}^{-1}$,\n    - $\\beta = 0.3$,\n    - $\\gamma = 0.6$,\n    - $S_N = 8$,\n    - 网格数量 $N = 40$ 和 $N = 80$。\n\n您的程序应生成单行输出，其中包含三个测试用例的观测精度阶 $p_{\\mathrm{obs}}$，格式为方括号括起来的逗号分隔列表，例如 $[\\text{p1},\\text{p2},\\text{p3}]$，其中每个条目都是一个浮点数。不得打印任何其他输出。",
            "solution": "该问题是有效的，因为它具有科学依据、是适定的，并包含获得唯一解所需的所有必要信息。它描述了在输运理论中，使用人造解方法对数值方法进行验证的标准程序。\n\n### 1. 理论框架\n\n该问题要求数值求解平板几何中的一维、稳态、单能中子输运方程：\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t(x) \\psi(x,\\mu) = Q(x,\\mu)\n$$\n此处，$\\psi(x,\\mu)$ 是在空间位置 $x \\in [0, L]$ 和方向余弦 $\\mu \\in [-1, 1]$ 处的中子角通量。$\\Sigma_t(x)$ 是总宏观截面，$Q(x,\\mu)$ 是一个外部源。\n\n采用人造解方法 (MMS) 来验证数值求解器的实现。这包括为解 $\\psi_{\\text{MS}}(x,\\mu)$ 选择一个期望的解析形式，并将其代入输运方程以推导出相应的源项 $Q(x,\\mu)$。然后使用数值方法求解带有该源项的方程，并通过测量数值解与精确人造解之间的误差来验证代码的准确性和收敛阶。\n\n### 2. 人造解与源项\n\n人造角通量由以下公式给出：\n$$\n\\psi_{\\text{MS}}(x,\\mu) = \\exp(\\alpha x) \\left(1 + \\beta \\mu + \\gamma \\sin\\left(\\frac{\\pi x}{L}\\right) \\mu^2\\right)\n$$\n空间变化的总截面为：\n$$\n\\Sigma_t(x) = \\Sigma_0 \\left(1 + c \\sin\\left(\\frac{2\\pi x}{L}\\right)\\right)\n$$\n为了找到人造源 $Q(x,\\mu)$，我们计算 $\\psi_{\\text{MS}}(x,\\mu)$ 对 $x$ 的导数：\n$$\n\\frac{\\partial \\psi_{\\text{MS}}}{\\partial x} = \\alpha \\exp(\\alpha x) \\left(1 + \\beta \\mu + \\gamma \\sin\\left(\\frac{\\pi x}{L}\\right) \\mu^2\\right) + \\exp(\\alpha x) \\left(\\gamma \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x}{L}\\right) \\mu^2\\right)\n$$\n注意到第一项包含 $\\psi_{\\text{MS}}(x,\\mu)$，可以简化为：\n$$\n\\frac{\\partial \\psi_{\\text{MS}}}{\\partial x} = \\alpha \\psi_{\\text{MS}}(x,\\mu) + \\exp(\\alpha x) \\left(\\gamma \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x}{L}\\right) \\mu^2\\right)\n$$\n然后通过将 $\\psi_{\\text{MS}}$ 代入输运方程来定义源 $Q(x,\\mu)$：\n$$\nQ(x,\\mu) = \\mu \\frac{\\partial \\psi_{\\text{MS}}}{\\partial x} + \\Sigma_t(x) \\psi_{\\text{MS}}(x,\\mu)\n$$\n$$\nQ(x,\\mu) = \\mu \\left[\\alpha \\psi_{\\text{MS}}(x,\\mu) + \\exp(\\alpha x) \\gamma \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x}{L}\\right) \\mu^2\\right] + \\Sigma_t(x) \\psi_{\\text{MS}}(x,\\mu)\n$$\n$$\nQ(x,\\mu) = \\left(\\mu \\alpha + \\Sigma_t(x)\\right) \\psi_{\\text{MS}}(x,\\mu) + \\mu^3 \\gamma \\frac{\\pi}{L} \\exp(\\alpha x) \\cos\\left(\\frac{\\pi x}{L}\\right)\n$$\n此表达式提供了使 $\\psi_{\\text{MS}}(x,\\mu)$ 成为真解所需的精确源项。\n\n### 3. 数值离散\n\n#### 3.1. 角度离散（离散纵标法）\n角度域 $\\mu \\in [-1, 1]$ 被离散为一组包含 $S_N$ 个离散方向（纵标） $\\{\\mu_k\\}$ 和相应权重 $\\{w_k\\}$ 的集合，其中 $k=1, \\dots, S_N$。使用 Gauss-Legendre 求积组，满足归一化条件 $\\sum_{k=1}^{S_N} w_k = 2$。然后对每个离散纵标 $\\mu_k$ 求解输运方程。\n\n#### 3.2. 空间离散与步进特征线法\n空间域 $x \\in [0, L]$ 被划分为 $N$ 个均匀单元，每个单元的宽度为 $\\Delta x = L/N$。单元边界为 $x_i = i \\Delta x$，其中 $i=0, \\dots, N$。第 $i$ 个单元覆盖区间 $[x_i, x_{i+1}]$。\n\n步进特征线 (SC) 方法假设在每个单元 $i$ 内，截面 $\\Sigma_t(x)$ 和源项 $Q(x,\\mu_k)$ 是常数，且等于它们的单元平均值：\n$$\n\\Sigma_{t,i} = \\frac{1}{\\Delta x} \\int_{x_i}^{x_{i+1}} \\Sigma_t(x) dx\n$$\n$$\nQ_{i,k} = \\frac{1}{\\Delta x} \\int_{x_i}^{x_{i+1}} Q(x, \\mu_k) dx\n$$\n这些积分以高精度进行数值计算，以避免引入会破坏收敛性分析的额外误差。在单元 $i$ 内，对于每个纵标 $\\mu_k$，输运方程变成一个简单的常微分方程：\n$$\n\\mu_k \\frac{d\\psi_k(x)}{dx} + \\Sigma_{t,i} \\psi_k(x) = Q_{i,k}\n$$\n其中 $\\psi_k(x) \\equiv \\psi(x, \\mu_k)$。\n\n此常微分方程在一个单元内的解是通过沿特征线方向推进得到的。设 $\\psi_{k, \\text{in}}$ 为单元流入边界处的已知角通量。从流入边界沿特征线路径行进距离 $s$ 处的通量为：\n$$\n\\psi_k(s) = \\psi_{k, \\text{in}} \\exp\\left(-\\frac{\\Sigma_{t,i} s}{|\\mu_k|}\\right) + \\frac{Q_{i,k}}{\\Sigma_{t,i}} \\left(1 - \\exp\\left(-\\frac{\\Sigma_{t,i} s}{|\\mu_k|}\\right)\\right)\n$$\n求解过程通过输运扫描进行：\n- **正向扫描 ($\\mu_k  0$)**: 扫描从左 ($x=0$) 向右 ($x=L$) 进行。对于单元 $i$，流入边界位于 $x_i$，流入通量为 $\\psi_k(x_i)$。在 $x_{i+1}$ 处的流出通量成为单元 $i+1$ 的流入通量。区域边界上的流入由人造解给出：$\\psi_k(0) = \\psi_{\\text{MS}}(0, \\mu_k)$。\n- **反向扫描 ($\\mu_k  0$)**: 扫描从右 ($x=L$) 向左 ($x=0$) 进行。对于单元 $i$，流入边界位于 $x_{i+1}$，流入通量为 $\\psi_k(x_{i+1})$。在 $x_i$ 处的流出通量成为单元 $i-1$ 的流入通量。区域边界上的流入为 $\\psi_k(L) = \\psi_{\\text{MS}}(L, \\mu_k)$。\n\n该问题要求在单元中心 $x_{i,c} = x_i + \\Delta x/2$ 计算数值解。从任何单元的流入边界到其中心的距离是 $s = \\Delta x/2$。因此，单元中心通量计算如下：\n$$\n\\psi_{\\text{SC}}(x_{i,c}, \\mu_k) = \\psi_{k, \\text{in}} \\exp\\left(-\\frac{\\Sigma_{t,i} \\Delta x}{2|\\mu_k|}\\right) + \\frac{Q_{i,k}}{\\Sigma_{t,i}} \\left(1 - \\exp\\left(-\\frac{\\Sigma_{t,i} \\Delta x}{2|\\mu_k|}\\right)\\right)\n$$\n其中，当 $\\mu_k  0$ 时，$\\psi_{k, \\text{in}}$ 为 $\\psi_k(x_i)$；当 $\\mu_k  0$ 时，$\\psi_{k, \\text{in}}$ 为 $\\psi_k(x_{i+1})$。\n\n### 4. 误差分析与收敛性\n数值解的精度由离散、归一化的 $L^2$ 误差范数来量化：\n$$\nE_h = \\left[\\frac{1}{2L}\\sum_{k=1}^{S_N} w_k \\sum_{i=0}^{N-1} \\left(\\psi_{\\text{SC}}(x_{i,c},\\mu_k) - \\psi_{\\text{MS}}(x_{i,c},\\mu_k)\\right)^2 \\Delta x \\right]^{1/2}\n$$\n分母中的项 $2L$ 通过相空间域的测度 $(\\int_{-1}^1 d\\mu \\int_0^L dx = 2L)$ 对误差进行归一化。参数 $h$ 代表网格间距，$h=\\Delta x=L/N$。\n\n观测到的精度阶 $p_{\\mathrm{obs}}$ 是通过比较两种不同网格分辨率下的误差来计算的，即间距为 $h$ 的粗网格（$N$ 个单元）和间距为 $h/2$ 的细网格（$2N$ 个单元）。\n$$\np_{\\mathrm{obs}} = \\frac{\\log\\left(E_{h}/E_{h/2}\\right)}{\\log(2)}\n$$\n对于步进特征线法，这是一种空间上一阶精度的方法，其 $p_{\\mathrm{obs}}$ 的期望值约为 1。实现中将为每个指定的测试用例计算此值。",
            "answer": "$$\\boxed{[0.99962,0.99982,0.99849]}$$"
        }
    ]
}