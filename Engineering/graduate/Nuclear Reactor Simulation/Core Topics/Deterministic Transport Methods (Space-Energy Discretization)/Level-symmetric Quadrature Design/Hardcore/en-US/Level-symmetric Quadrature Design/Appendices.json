{
    "hands_on_practices": [
        {
            "introduction": "We begin with a direct application of a simple level-symmetric quadrature. This exercise provides a concrete calculation of the numerical error that arises when approximating an integral of a polynomial whose order exceeds the quadrature's guaranteed order of exactness . Understanding how to perform this comparison between the discrete sum and the exact analytic integral is a fundamental skill in validating and characterizing the performance of any quadrature set.",
            "id": "4233286",
            "problem": "In three-dimensional neutron transport for nuclear reactor simulation, angular integrals over the unit sphere are approximated by pointwise sums using level-symmetric quadrature. Let the function of direction be defined as $f(\\vec{\\Omega}) = \\mu^{4} + \\eta^{4} + \\xi^{4}$, where $\\mu$, $\\eta$, and $\\xi$ are the direction cosines of $\\vec{\\Omega}$ with respect to the Cartesian coordinate axes. Consider a one-level, level-symmetric (LS) quadrature constructed as follows: use the eight directions corresponding to all sign combinations of the vector of direction cosines $(\\mu,\\eta,\\xi) = \\left(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)$, and assign an equal weight $w$ to each direction such that the quadrature is exact for the integral of a constant over the full solid angle.\n\nUsing this quadrature, compute the discrete quadrature sum\n$$\nQ \\equiv \\sum_{i=1}^{8} w\\, f(\\vec{\\Omega}_{i}),\n$$\nand the analytic integral\n$$\nI \\equiv \\int_{4\\pi} f(\\vec{\\Omega})\\, d\\Omega,\n$$\nover the full sphere. Then, compute the difference\n$$\nD \\equiv Q - I.\n$$\nBase your derivation on fundamental definitions of solid-angle integration and the definition of direction cosines. Express the final value of $D$ in steradians. No rounding is required; report the exact value.",
            "solution": "The problem requires the computation of the difference, $D$, between a discrete quadrature sum, $Q$, and an analytic integral, $I$, for the function $f(\\vec{\\Omega}) = \\mu^{4} + \\eta^{4} + \\xi^{4}$ over the unit sphere. The total quantity to be computed is $D \\equiv Q - I$.\n\nFirst, we determine the value of the quadrature weight, $w$. The quadrature is constructed with $8$ directions, each having an equal weight $w$. The quadrature is exact for the integral of a constant function (e.g., $g(\\vec{\\Omega}) = 1$) over the full solid angle of $4\\pi$ steradians.\nThe analytic integral is $\\int_{4\\pi} 1 \\, d\\Omega = 4\\pi$.\nThe corresponding quadrature sum is $\\sum_{i=1}^{8} w_{i} g(\\vec{\\Omega}_{i}) = \\sum_{i=1}^{8} w \\cdot 1 = 8w$.\nEquating the integral and the sum gives $8w = 4\\pi$, so the weight for each quadrature point is $w = \\frac{\\pi}{2}$.\n\nNext, we compute the discrete quadrature sum, $Q$.\n$$ Q \\equiv \\sum_{i=1}^{8} w f(\\vec{\\Omega}_{i}) $$\nThe quadrature points $\\vec{\\Omega}_{i}$ are the $8$ directions corresponding to all sign combinations of $(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}})$. For any of these directions, the function value is the same, since the direction cosines are raised to an even power:\n$$ f(\\vec{\\Omega}_{i}) = \\left(\\pm\\frac{1}{\\sqrt{3}}\\right)^{4} + \\left(\\pm\\frac{1}{\\sqrt{3}}\\right)^{4} + \\left(\\pm\\frac{1}{\\sqrt{3}}\\right)^{4} = 3 \\cdot \\left(\\frac{1}{\\sqrt{3}}\\right)^{4} = 3 \\cdot \\frac{1}{9} = \\frac{1}{3} $$\nThe function value is constant for all $8$ quadrature directions. We can now compute $Q$:\n$$ Q = \\sum_{i=1}^{8} w f(\\vec{\\Omega}_{i}) = 8 \\cdot w \\cdot f(\\vec{\\Omega}_{i}) = 8 \\cdot \\left(\\frac{\\pi}{2}\\right) \\cdot \\left(\\frac{1}{3}\\right) = \\frac{4\\pi}{3} $$\n\nNow, we compute the analytic integral, $I$.\n$$ I \\equiv \\int_{4\\pi} f(\\vec{\\Omega}) \\, d\\Omega = \\int_ {4\\pi} (\\mu^{4} + \\eta^{4} + \\xi^{4}) \\, d\\Omega $$\nDue to the symmetry of the sphere, the integrals of $\\mu^4$, $\\eta^4$, and $\\xi^4$ over the full solid angle are identical.\n$$ \\int_{4\\pi} \\mu^{4} \\, d\\Omega = \\int_{4\\pi} \\eta^{4} \\, d\\Omega = \\int_{4\\pi} \\xi^{4} \\, d\\Omega $$\nTherefore, the integral $I$ can be written as $I = 3 \\int_{4\\pi} \\mu^{4} \\, d\\Omega$.\nTo evaluate this integral, we use spherical coordinates, where $d\\Omega = \\sin\\theta \\, d\\theta \\, d\\phi$ and $\\mu = \\cos\\theta$.\n$$ \\int_{4\\pi} \\mu^{4} \\, d\\Omega = \\int_{0}^{2\\pi} \\int_{0}^{\\pi} (\\cos\\theta)^{4} \\sin\\theta \\, d\\theta \\, d\\phi = 2\\pi \\int_{0}^{\\pi} \\cos^{4}\\theta \\sin\\theta \\, d\\theta $$\nUsing the substitution $u = \\cos\\theta$ (so $du = -\\sin\\theta \\, d\\theta$), the integral becomes:\n$$ 2\\pi \\int_{1}^{-1} u^{4} (-du) = 2\\pi \\int_{-1}^{1} u^{4} \\, du = 2\\pi \\left[ \\frac{u^{5}}{5} \\right]_{-1}^{1} = 2\\pi \\left( \\frac{1}{5} - \\frac{-1}{5} \\right) = \\frac{4\\pi}{5} $$\nNow we can compute $I$:\n$$ I = 3 \\cdot \\left(\\frac{4\\pi}{5}\\right) = \\frac{12\\pi}{5} $$\n\nFinally, we compute the difference $D = Q - I$.\n$$ D = \\frac{4\\pi}{3} - \\frac{12\\pi}{5} = \\frac{5 \\cdot 4\\pi}{15} - \\frac{3 \\cdot 12\\pi}{15} = \\frac{20\\pi - 36\\pi}{15} = -\\frac{16\\pi}{15} $$\nThe units of $D$ are steradians, as the integral and the sum are over the solid angle and $f(\\vec{\\Omega})$ is dimensionless.",
            "answer": "$$\n\\boxed{-\\frac{16\\pi}{15}}\n$$"
        },
        {
            "introduction": "Building on the concept of quadrature error, this next practice explores a crucial subtlety. We will investigate why a level-symmetric quadrature, by its very design, can exactly integrate certain higher-order polynomials for which one might naively expect an error . This exercise highlights the profound consequences of symmetry, demonstrating that it automatically guarantees exactness for a broad class of functions, a property central to the efficiency and accuracy of these numerical tools.",
            "id": "4233302",
            "problem": "In three-dimensional neutron transport analysis for nuclear reactor simulation, many quantities reduce to angular integrals over the unit sphere, denoted by $S^{2}$, with the surface measure $d\\Omega$. Consider the test integrand $f(\\vec{\\Omega}) = \\mu^{3} + \\eta^{3} + \\xi^{3}$, where $(\\mu,\\eta,\\xi)$ are the direction cosines of $\\vec{\\Omega}$ with respect to a fixed Cartesian coordinate system and satisfy $\\mu^{2} + \\eta^{2} + \\xi^{2} = 1$. The exact continuous integral of interest is\n$$\nI \\equiv \\int_{S^{2}} f(\\vec{\\Omega})\\,d\\Omega.\n$$\nA discrete angular quadrature approximates $I$ by\n$$\nI_{Q} \\equiv \\sum_{i=1}^{N} w_{i}\\,f(\\vec{\\Omega}_{i}),\n$$\nwhere $\\{w_{i}\\}_{i=1}^{N}$ are nonnegative weights and $\\{\\vec{\\Omega}_{i} = (\\mu_{i},\\eta_{i},\\xi_{i})\\}_{i=1}^{N}$ are unit directions. Assume the quadrature is exact up to total polynomial order $2$ (that is, it integrates every monomial $\\mu^{p}\\eta^{q}\\xi^{r}$ with $p+q+r \\leq 2$ exactly over $S^{2}$), and the point set is level-symmetric: for every node $(\\mu_{i},\\eta_{i},\\xi_{i})$ in one octant, all $8$ sign permutations appear in the full set with equal weight $w_{i}$. \n\nStarting from first principles of symmetry of the unit sphere and the definition of level-symmetric quadratures, derive $I$ and quantify the quadrature error\n$$\nE \\equiv I_{Q} - I\n$$\nfor the given $f(\\vec{\\Omega})$ in terms of the discrete odd third moments. Then, using only the level-symmetric property and the assumption of exactness to order $2$, evaluate $E$. Your final answer must be a single real number. No rounding is required.",
            "solution": "The problem asks for the quadrature error $E \\equiv I_{Q} - I$. We will compute the exact integral $I$ and the discrete sum $I_Q$ separately.\n\n**Step 1: Evaluation of the Exact Integral $I$**\nThe integral is $I = \\int_{S^{2}} (\\mu^{3} + \\eta^{3} + \\xi^{3})\\,d\\Omega$. By linearity, this is the sum of three integrals:\n$$\nI = \\int_{S^{2}} \\mu^{3}\\,d\\Omega + \\int_{S^{2}} \\eta^{3}\\,d\\Omega + \\int_{S^{2}} \\xi^{3}\\,d\\Omega\n$$\nConsider the term $\\int_{S^{2}} \\mu^{3}\\,d\\Omega$. The integrand $g(\\mu, \\eta, \\xi) = \\mu^{3}$ is an odd function with respect to the variable $\\mu$. The domain of integration, the unit sphere $S^2$, is symmetric under the reflection $\\mu \\to -\\mu$. The integral of an odd function over a symmetric domain is zero. Therefore, $\\int_{S^{2}} \\mu^{3}\\,d\\Omega = 0$.\nBy the geometric symmetry of the sphere, the direction cosine axes are interchangeable. Thus, the integrals of $\\eta^3$ and $\\xi^3$ are also zero:\n$$\n\\int_{S^{2}} \\eta^{3}\\,d\\Omega = 0 \\quad \\text{and} \\quad \\int_{S^{2}} \\xi^{3}\\,d\\Omega = 0\n$$\nSumming the three terms, we find the exact value of the integral is $I = 0 + 0 + 0 = 0$.\n\n**Step 2: Evaluation of the Discrete Quadrature Sum $I_Q$**\nThe discrete sum is $I_{Q} = \\sum_{i=1}^{N} w_{i} f(\\vec{\\Omega}_{i}) = \\sum_{i=1}^{N} w_{i} (\\mu_{i}^{3} + \\eta_{i}^{3} + \\xi_{i}^{3})$. By linearity, this is:\n$$\nI_{Q} = \\sum_{i=1}^{N} w_{i}\\mu_{i}^{3} + \\sum_{i=1}^{N} w_{i}\\eta_{i}^{3} + \\sum_{i=1}^{N} w_{i}\\xi_{i}^{3}\n$$\nThese three sums are the discrete odd third moments. Now we use the level-symmetric property of the quadrature. This property guarantees that for any direction $(\\mu_k, \\eta_k, \\xi_k)$ in the set with weight $w_k$, its reflection across a coordinate plane, e.g., $(-\\mu_k, \\eta_k, \\xi_k)$, is also in the set with the same weight $w_k$.\nConsider the sum $\\sum_{i=1}^{N} w_{i}\\mu_{i}^{3}$. The entire set of directions $\\{\\vec{\\Omega}_i\\}$ can be partitioned into pairs of points $(\\vec{\\Omega}_k, \\vec{\\Omega}_j)$ such that $\\vec{\\Omega}_k = (\\mu_k, \\eta_k, \\xi_k)$ and $\\vec{\\Omega}_j = (-\\mu_k, \\eta_k, \\xi_k)$, with weights $w_k = w_j$. The contribution of this pair to the sum is:\n$$\nw_k \\mu_k^3 + w_j (-\\mu_k)^3 = w_k \\mu_k^3 - w_k \\mu_k^3 = 0\n$$\nSince the entire set can be so partitioned (points with $\\mu_i=0$ contribute nothing), the total sum is zero.\n$$\n\\sum_{i=1}^{N} w_{i}\\mu_{i}^{3} = 0\n$$\nBy symmetry, the same argument holds for the other two sums:\n$$\n\\sum_{i=1}^{N} w_{i}\\eta_{i}^{3} = 0 \\quad \\text{and} \\quad \\sum_{i=1}^{N} w_{i}\\xi_{i}^{3} = 0\n$$\nTherefore, the discrete quadrature sum is $I_Q = 0 + 0 + 0 = 0$.\n\n**Step 3: Calculation of the Quadrature Error $E$**\nThe quadrature error is $E = I_Q - I$.\nThe error expressed in terms of the discrete odd third moments is $E = \\left(\\sum w_{i}\\mu_{i}^{3} + \\sum w_{i}\\eta_{i}^{3} + \\sum w_{i}\\xi_{i}^{3}\\right) - 0$.\nAs shown in Step 2, the level-symmetric property forces each of these discrete moments to be zero.\n$$\nE = 0 - 0 = 0\n$$\nThus, the quadrature error is exactly zero. The level-symmetric property alone guarantees that the quadrature is exact for any polynomial containing only odd powers of the direction cosines. The additional information that the quadrature is exact to order 2 is not needed for this specific integrand.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Our final practice bridges the gap between the mathematical construction of a quadrature and its physical application in transport theory. This problem challenges you to verify one of the most important properties of a level-symmetric quadrature: its ability to preserve isotropy for second-order angular moments . Completing this exercise will solidify your understanding of why the structural symmetry of the quadrature is not merely an elegant design choice, but a necessary condition for correctly modeling fundamental physical phenomena like isotropic scattering.",
            "id": "4248060",
            "problem": "In three-dimensional neutron transport for nuclear reactor simulation, the discrete ordinates method selects a finite set of directions on the unit sphere with associated nonnegative weights to approximate angular integrals. For an angular quadrature to correctly transmit isotropic scattering, the discrete second-moment tensor of the direction cosines must reproduce the continuous isotropic second moment. Consider a candidate Level-Symmetric order-eight set (LS$_8$) constructed per octant from ten directions grouped by symmetry type, with identical weights within each symmetry type and across all octants:\n\n- Type A (one per octant): the direction with equal direction cosines $\\left(p,p,p\\right)$ where $p>0$ and $3p^{2}=1$.\n\n- Type B (three per octant): the three permutations of $\\left(u,u,v\\right)$ with $u>0$, $v>0$ and $2u^{2}+v^{2}=1$. For definiteness, take $u=\\sqrt{\\frac{1}{5}}$ and $v=\\sqrt{\\frac{3}{5}}$.\n\n- Type C (six per octant): the six permutations of $\\left(a,b,c\\right)$ with $a>0$, $b>0$, $c>0$ and $a^{2}+b^{2}+c^{2}=1$. For definiteness, take $a=\\sqrt{\\frac{1}{10}}$, $b=\\sqrt{\\frac{3}{10}}$, and $c=\\sqrt{\\frac{6}{10}}$.\n\nLet the associated nonnegative weights per direction be $w_{A}$ for Type A, $w_{B}$ for Type B, and $w_{C}$ for Type C. The full-sphere weight normalization is imposed by\n$$\n\\sum_{i} w_{i} \\;=\\; 8\\left(w_{A}+3w_{B}+6w_{C}\\right)\\;=\\;4\\pi,\n$$\nwhere the factor $8$ accounts for the eight octants.\n\nDefine the discrete second-moment tensor by\n$$\n\\mathbf{T} \\;=\\; \\sum_{i} w_{i}\\,\\vec{\\Omega}_{i}\\,\\vec{\\Omega}_{i},\n$$\nwhere $\\vec{\\Omega}_{i}$ is the unit direction vector for the $i$-th quadrature direction and $\\vec{\\Omega}_{i}\\,\\vec{\\Omega}_{i}$ denotes the dyadic (outer) product. Using only the constraints stated above and symmetry arguments, compute $\\mathbf{T}$ and evaluate the isotropy error tensor\n$$\n\\Delta \\;=\\; \\mathbf{T} - \\frac{4\\pi}{3}\\,\\mathbf{I},\n$$\nwhere $\\mathbf{I}$ is the identity tensor. Report the Frobenius norm of the error,\n$$\n\\|\\Delta\\|_{F} \\;=\\; \\sqrt{\\mathrm{tr}\\!\\left(\\Delta^{\\mathsf{T}}\\Delta\\right)},\n$$\nas a single real number. No rounding is required for the final answer.",
            "solution": "The problem asks for the Frobenius norm of the isotropy error tensor, $\\|\\Delta\\|_{F}$. This requires computing the discrete second-moment tensor $\\mathbf{T}$.\n\nThe components of the tensor $\\mathbf{T}$ are given by $T_{jk} = \\sum_{i} w_{i} \\mu_{ij} \\mu_{ik}$ for $j, k \\in \\{x, y, z\\}$, where $\\vec{\\Omega}_i = (\\mu_{ix}, \\mu_{iy}, \\mu_{iz})$.\n\n**1. Off-Diagonal Components of $\\mathbf{T}$**\nConsider an off-diagonal component, such as $T_{xy} = \\sum_{i} w_{i} \\mu_{ix} \\mu_{iy}$. The quadrature set is level-symmetric, which means for any direction $(\\mu_x, \\mu_y, \\mu_z)$ in the set with weight $w$, its reflection across a coordinate plane, such as $(-\\mu_x, \\mu_y, \\mu_z)$, is also in the set with the same weight $w$. The contribution of this pair to the sum is $w(\\mu_x \\mu_y) + w(-\\mu_x \\mu_y) = 0$. Since the entire set of directions can be partitioned into such canceling pairs, the total sum is zero. The same argument holds for all other off-diagonal components.\n$$\nT_{xy} = T_{yx} = T_{xz} = T_{zx} = T_{yz} = T_{zy} = 0\n$$\nTherefore, $\\mathbf{T}$ is a diagonal matrix.\n\n**2. Diagonal Components of $\\mathbf{T}$**\nNow consider the diagonal components: $T_{xx} = \\sum_{i} w_{i} \\mu_{ix}^{2}$, $T_{yy} = \\sum_{i} w_{i} \\mu_{iy}^{2}$, and $T_{zz} = \\sum_{i} w_{i} \\mu_{iz}^{2}$.\nThe quadrature set is constructed to be invariant under permutation of the coordinate axes. For example, if we swap the $x$ and $y$ axes, the set of all direction vectors $\\{\\vec{\\Omega}_i\\}$ and their associated weights $\\{w_i\\}$ remains unchanged. This means the value computed for the sum $\\sum_i w_i \\mu_{ix}^2$ must be identical to the value computed for $\\sum_i w_i \\mu_{iy}^2$. Thus, all diagonal components are equal:\n$$\nT_{xx} = T_{yy} = T_{zz} = k\n$$\nThe tensor $\\mathbf{T}$ must be of the form $\\mathbf{T} = k \\mathbf{I}$, where $\\mathbf{I}$ is the identity tensor.\n\n**3. Determining the Value of $k$**\nTo find the value of $k$, we compute the trace of $\\mathbf{T}$.\n$$ \\mathrm{tr}(\\mathbf{T}) = T_{xx} + T_{yy} + T_{zz} = 3k $$\nAlternatively, we can compute the trace from its definition:\n$$ \\mathrm{tr}(\\mathbf{T}) = \\mathrm{tr}\\left(\\sum_{i} w_{i}\\,\\vec{\\Omega}_{i}\\,\\vec{\\Omega}_{i}\\right) = \\sum_i w_i \\mathrm{tr}(\\vec{\\Omega}_{i}\\,\\vec{\\Omega}_{i}) = \\sum_i w_i |\\vec{\\Omega}_i|^2 $$\nSince each $\\vec{\\Omega}_i$ is a unit vector, $|\\vec{\\Omega}_i|^2 = 1$. The trace becomes the sum of the weights:\n$$ \\mathrm{tr}(\\mathbf{T}) = \\sum_i w_i $$\nThe problem provides the weight normalization condition $\\sum_i w_i = 4\\pi$. Equating the two expressions for the trace gives:\n$$ 3k = 4\\pi \\implies k = \\frac{4\\pi}{3} $$\nTherefore, the discrete second-moment tensor is exactly $\\mathbf{T} = \\frac{4\\pi}{3}\\mathbf{I}$. This result is a direct consequence of the specified level-symmetric structure and holds regardless of the specific values of the direction cosines or weights.\n\n**4. Isotropy Error and Frobenius Norm**\nThe isotropy error tensor is defined as $\\Delta = \\mathbf{T} - \\frac{4\\pi}{3}\\,\\mathbf{I}$. Substituting our result for $\\mathbf{T}$:\n$$ \\Delta = \\frac{4\\pi}{3}\\mathbf{I} - \\frac{4\\pi}{3}\\mathbf{I} = \\mathbf{0} $$\nwhere $\\mathbf{0}$ is the zero tensor. The Frobenius norm of the zero tensor is:\n$$ \\|\\Delta\\|_{F} = \\sqrt{\\mathrm{tr}(\\mathbf{0}^{\\mathsf{T}}\\mathbf{0})} = \\sqrt{0} = 0 $$\nThe error is zero, confirming that any quadrature with a level-symmetric design automatically preserves the isotropy of the second angular moment.",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}