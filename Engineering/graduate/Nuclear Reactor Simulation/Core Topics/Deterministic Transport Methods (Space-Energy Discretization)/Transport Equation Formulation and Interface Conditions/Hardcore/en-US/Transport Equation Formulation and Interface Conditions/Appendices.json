{
    "hands_on_practices": [
        {
            "introduction": "To accurately simulate neutron behavior in a reactor, we must track their journey through various materials. The foundation of many advanced simulation tools, such as the Method of Characteristics (MOC), is built upon solving the transport equation along straight-line paths. This practice guides you through the fundamental process of building a solution from first principles, demonstrating how to analytically solve for the neutron flux across a single material region and then chain these solutions together to model a complex, multi-region geometry like a fuel pin . By implementing this algorithm, you will gain a hands-on understanding of how neutron populations are attenuated by materials and augmented by sources along their line of flight.",
            "id": "4258245",
            "problem": "Consider a straight characteristic line-of-flight through a one-dimensional multi-region pin cell in a nuclear reactor simulation. Along a single ray, the steady-state angular neutron flux $ \\psi(s) $ satisfies the first-order ordinary differential equation\n$$\n\\frac{d\\psi(s)}{ds} + \\Sigma_t(s)\\,\\psi(s) = q(s),\n$$\nwhere $ s $ is the path-length coordinate along the ray, $ \\Sigma_t(s) $ is the total macroscopic cross section, and $ q(s) $ is the in-direction source per unit solid angle. Assume a piecewise-constant material model: within each region indexed by $ k $, $ \\Sigma_t(s) = \\Sigma_{t,k} $ and $ q(s) = q_k $ are constant over a segment of length $ L_k $. The interface conditions between regions enforce continuity of the angular flux $ \\psi(s) $ across interfaces. There are no singular interface sources, and the ray direction does not change at interfaces.\n\nStarting from the governing equation and these interface conditions, assemble the piecewise segment contributions to obtain the outgoing angular flux at the boundary after traversing a sequence of regions. The propagation through one segment must be based only on first principles and must be scientifically sound. Then, design and implement an algorithm that computes the outgoing angular flux at the end of the final segment given an incident angular flux at the beginning of the first segment.\n\nPhysical units must be explicitly respected. Let $ \\Sigma_{t,k} $ be specified in $ \\text{cm}^{-1} $, segment lengths $ L_k $ be in $ \\text{cm} $, the source $ q_k $ be in $ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, and the angular flux $ \\psi $ be in $ \\text{neutrons}\\ \\text{cm}^{-2}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $. Express all final answers for the outgoing angular flux in $ \\text{neutrons}\\ \\text{cm}^{-2}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $ as floating-point numbers. No angles are required; all distances $ L_k $ are given directly along the ray in $ \\text{cm} $.\n\nYour program must implement the following scientifically grounded segment mapping: for a single segment with constant $ \\Sigma_t $ and $ q $ over length $ L $, the mapping from incident angular flux $ \\psi_{\\text{in}} $ at the segment entrance to outgoing angular flux $ \\psi_{\\text{out}} $ at the segment exit is\n$$\n\\psi_{\\text{out}} = \\psi_{\\text{in}}\\,e^{-\\Sigma_t L} + \\frac{q}{\\Sigma_t}\\left(1 - e^{-\\Sigma_t L}\\right),\n$$\nand in the special limiting case $ \\Sigma_t \\to 0 $ with finite $ q $, the mapping reduces to\n$$\n\\psi_{\\text{out}} = \\psi_{\\text{in}} + q\\,L,\n$$\nwhich must be used to avoid division by zero and to remain consistent with $ \\frac{d\\psi}{ds} = q $ when $ \\Sigma_t = 0 $.\n\nThe multi-region pin cell along the ray is defined by an ordered list of segments $ \\{(\\Sigma_{t,k}, q_k, L_k)\\}_{k=1}^N $. The algorithm must apply the single-segment mapping sequentially for $ k = 1 $ to $ k = N $, enforcing continuity of $ \\psi $ at each interface by setting the incident flux of segment $ k $ equal to the outgoing flux from segment $ k-1 $.\n\nImplement the algorithm and evaluate it on the following test suite, each case defined by an incident angular flux $ \\psi_{\\text{in}} $ and an ordered list of segments $ (\\Sigma_{t,k}, q_k, L_k) $:\n\nCase $ 1 $ (happy path, three-region pin cell with internal source in fuel, thin gap, and cladding):\n- Incident flux $ \\psi_{\\text{in}} = 0.1\\ \\text{neutrons}\\ \\text{cm}^{-2}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $.\n- Segments:\n  - Fuel: $ \\Sigma_{t,1} = 0.7\\ \\text{cm}^{-1} $, $ q_1 = 0.05\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_1 = 0.2\\ \\text{cm} $.\n  - Gap: $ \\Sigma_{t,2} = 0.001\\ \\text{cm}^{-1} $, $ q_2 = 0.0\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_2 = 0.05\\ \\text{cm} $.\n  - Cladding: $ \\Sigma_{t,3} = 0.2\\ \\text{cm}^{-1} $, $ q_3 = 0.0\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_3 = 0.08\\ \\text{cm} $.\n\nCase $ 2 $ (pure attenuation, single region, no source):\n- Incident flux $ \\psi_{\\text{in}} = 1.0\\ \\text{neutrons}\\ \\text{cm}^{-2}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $.\n- Segments:\n  - Region $ 1 $: $ \\Sigma_{t,1} = 1.3\\ \\text{cm}^{-1} $, $ q_1 = 0.0\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_1 = 0.5\\ \\text{cm} $.\n\nCase $ 3 $ (edge case, zero cross section segment with source followed by attenuation):\n- Incident flux $ \\psi_{\\text{in}} = 0.0\\ \\text{neutrons}\\ \\text{cm}^{-2}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $.\n- Segments:\n  - Vacuum-like: $ \\Sigma_{t,1} = 0.0\\ \\text{cm}^{-1} $, $ q_1 = 0.02\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_1 = 1.0\\ \\text{cm} $.\n  - Attenuating: $ \\Sigma_{t,2} = 0.4\\ \\text{cm}^{-1} $, $ q_2 = 0.0\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_2 = 0.25\\ \\text{cm} $.\n\nCase $ 4 $ (boundary condition, zero-thickness segment followed by attenuation):\n- Incident flux $ \\psi_{\\text{in}} = 0.5\\ \\text{neutrons}\\ \\text{cm}^{-2}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $.\n- Segments:\n  - Degenerate: $ \\Sigma_{t,1} = 0.8\\ \\text{cm}^{-1} $, $ q_1 = 0.1\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_1 = 0.0\\ \\text{cm} $.\n  - Attenuating: $ \\Sigma_{t,2} = 0.3\\ \\text{cm}^{-1} $, $ q_2 = 0.0\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_2 = 0.1\\ \\text{cm} $.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $ [\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4] $), where each $ \\text{result}_i $ is the outgoing angular flux at the boundary for the corresponding case, expressed in $ \\text{neutrons}\\ \\text{cm}^{-2}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $ as a floating-point number.",
            "solution": "The problem posed is to compute the outgoing angular neutron flux after traversing a sequence of one-dimensional material regions, starting from a given incident flux. This is a fundamental problem in the method of characteristics, a common technique for solving the neutron transport equation in nuclear reactor analysis.\n\nFirst, a validation of the problem statement is required. The givens are:\n- The governing equation for the steady-state angular flux $\\psi(s)$ along a characteristic line-of-flight with path-length coordinate $s$:\n$$ \\frac{d\\psi(s)}{ds} + \\Sigma_t(s)\\,\\psi(s) = q(s) $$\n- The material properties $\\Sigma_t(s)$ (total macroscopic cross section) and $q(s)$ (in-direction source) are piecewise constant. For a region $k$ of length $L_k$, $\\Sigma_t(s) = \\Sigma_{t,k}$ and $q(s) = q_k$.\n- Interface conditions mandate continuity of $\\psi(s)$.\n- The single-segment mapping from incident flux $\\psi_{\\text{in}}$ to outgoing flux $\\psi_{\\text{out}}$ over a length $L$ is given by:\n$$ \\psi_{\\text{out}} = \\psi_{\\text{in}}\\,e^{-\\Sigma_t L} + \\frac{q}{\\Sigma_t}\\left(1 - e^{-\\Sigma_t L}\\right) \\quad (\\text{for } \\Sigma_t \\neq 0) $$\n$$ \\psi_{\\text{out}} = \\psi_{\\text{in}} + q\\,L \\quad (\\text{for } \\Sigma_t = 0) $$\n- The problem specifies units for all physical quantities, which are internally consistent.\n- Four specific test cases are provided, defining the initial incident flux and the sequence of material segments.\n\nThe problem is scientifically grounded, as it is based on the standard linear Boltzmann transport equation in one spatial dimension. The provided analytical solution for a homogeneous segment is correct and can be derived from first principles. The problem is well-posed, providing a clear initial condition and a well-defined sequence of operations that guarantees a unique solution. The language is objective and precise. All required data are provided, and there are no contradictions. The structure is formal and directly translatable to an algorithm. Therefore, the problem is deemed valid and a solution can be constructed.\n\nThe core principle is the analytical integration of the transport equation over a single, homogeneous spatial segment. Within a segment $k$ extending from a local coordinate $s=0$ to $s=L_k$, the equation becomes a first-order linear ordinary differential equation with constant coefficients:\n$$ \\frac{d\\psi(s)}{ds} + \\Sigma_{t,k}\\,\\psi(s) = q_k $$\nThis equation can be solved using an integrating factor, $I(s) = \\exp(\\int \\Sigma_{t,k} \\, ds) = \\exp(\\Sigma_{t,k} s)$. Multiplying the differential equation by $I(s)$ yields:\n$$ \\exp(\\Sigma_{t,k} s) \\frac{d\\psi(s)}{ds} + \\Sigma_{t,k} \\exp(\\Sigma_{t,k} s) \\psi(s) = q_k \\exp(\\Sigma_{t,k} s) $$\nThe left-hand side is the derivative of a product, by the chain rule:\n$$ \\frac{d}{ds} \\left( \\psi(s) \\exp(\\Sigma_{t,k} s) \\right) = q_k \\exp(\\Sigma_{t,k} s) $$\nIntegrating this expression over the segment length, from $s=0$ to $s=L_k$:\n$$ \\int_{0}^{L_k} \\frac{d}{ds} \\left( \\psi(s) \\exp(\\Sigma_{t,k} s) \\right) ds = \\int_{0}^{L_k} q_k \\exp(\\Sigma_{t,k} s) ds $$\n$$ \\left[ \\psi(s) \\exp(\\Sigma_{t,k} s) \\right]_{0}^{L_k} = \\left[ \\frac{q_k}{\\Sigma_{t,k}} \\exp(\\Sigma_{t,k} s) \\right]_{0}^{L_k} $$\nThis step assumes $\\Sigma_{t,k} \\neq 0$. Evaluating at the limits gives:\n$$ \\psi(L_k) \\exp(\\Sigma_{t,k} L_k) - \\psi(0) \\exp(0) = \\frac{q_k}{\\Sigma_{t,k}} (\\exp(\\Sigma_{t,k} L_k) - \\exp(0)) $$\n$$ \\psi(L_k) \\exp(\\Sigma_{t,k} L_k) - \\psi(0) = \\frac{q_k}{\\Sigma_{t,k}} (\\exp(\\Sigma_{t,k} L_k) - 1) $$\nLetting the incident flux at $s=0$ be $\\psi_{\\text{in},k} = \\psi(0)$ and the outgoing flux at $s=L_k$ be $\\psi_{\\text{out},k} = \\psi(L_k)$, we solve for $\\psi_{\\text{out},k}$:\n$$ \\psi_{\\text{out},k} = \\psi_{\\text{in},k} \\exp(-\\Sigma_{t,k} L_k) + \\frac{q_k}{\\Sigma_{t,k}}(1 - \\exp(-\\Sigma_{t,k} L_k)) $$\nThis derivation validates the formula provided in the problem statement for the case where $\\Sigma_{t,k} \\neq 0$. The first term, $\\psi_{\\text{in},k} \\exp(-\\Sigma_{t,k} L_k)$, represents the attenuation of the incident flux as it traverses the material. The second term represents the contribution from the internal source $q_k$, which is also attenuated. The quantity $\\tau_k = \\Sigma_{t,k} L_k$ is the optical thickness of the segment.\n\nFor the special case where $\\Sigma_{t,k} = 0$, the governing equation simplifies to:\n$$ \\frac{d\\psi(s)}{ds} = q_k $$\nIntegrating this from $s=0$ to $s=L_k$:\n$$ \\int_{0}^{L_k} \\frac{d\\psi(s)}{ds} ds = \\int_{0}^{L_k} q_k ds $$\n$$ \\psi(L_k) - \\psi(0) = q_k L_k $$\n$$ \\psi_{\\text{out},k} = \\psi_{\\text{in},k} + q_k L_k $$\nThis confirms the second formula provided. This case corresponds to particles streaming through a vacuum (or a non-interacting medium), with the flux increasing linearly due to the source.\n\nThe algorithm for a multi-region problem is a sequential application of this single-segment solution. The principle of flux continuity at interfaces means that the outgoing flux from segment $k-1$ becomes the incident flux for segment $k$. Let $\\psi_{k}$ be the outgoing flux from segment $k$. The process is iterative:\n1. Initialize with the incident flux at the start of the first segment: $\\psi_{\\text{in},1} = \\psi_{\\text{incident}}$.\n2. For each segment $k = 1, 2, \\dots, N$:\n   - The incident flux for the current segment is the outgoing flux from the previous one: $\\psi_{\\text{in},k} = \\psi_{k-1}$ (with $\\psi_0 = \\psi_{\\text{incident}}$).\n   - Compute the outgoing flux $\\psi_k$ using the appropriate formula based on whether $\\Sigma_{t,k}$ is zero or non-zero.\n3. The final result is the outgoing flux from the last segment, $\\psi_N$.\n\nThis sequential procedure correctly models the transport of particles along the characteristic ray through the entire heterogeneous medium.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the neutron transport problem for the given test cases.\n    \"\"\"\n    \n    # Each case is: (incident_flux, [(sigma_t, q, L), ...])\n    test_cases = [\n        # Case 1 (happy path, three-region pin cell)\n        (0.1, [\n            (0.7, 0.05, 0.2),  # Fuel\n            (0.001, 0.0, 0.05), # Gap\n            (0.2, 0.0, 0.08)   # Cladding\n        ]),\n        \n        # Case 2 (pure attenuation, single region)\n        (1.0, [\n            (1.3, 0.0, 0.5)\n        ]),\n        \n        # Case 3 (edge case, zero cross section)\n        (0.0, [\n            (0.0, 0.02, 1.0),   # Vacuum-like with source\n            (0.4, 0.0, 0.25)   # Attenuating\n        ]),\n        \n        # Case 4 (boundary condition, zero-thickness segment)\n        (0.5, [\n            (0.8, 0.1, 0.0),   # Degenerate segment\n            (0.3, 0.0, 0.1)    # Attenuating\n        ])\n    ]\n\n    results = []\n    for initial_flux, segments in test_cases:\n        current_flux = initial_flux\n        \n        for sigma_t, q, L in segments:\n            # sigma_t is given in cm^-1\n            # q is given in neutrons cm^-3 s^-1 sr^-1\n            # L is given in cm\n            # current_flux is in neutrons cm^-2 s^-1 sr^-1\n            \n            # Use a small tolerance for floating point comparison to zero\n            if abs(sigma_t)  1e-12:\n                # Special case for sigma_t = 0\n                # psi_out = psi_in + q * L\n                current_flux = current_flux + q * L\n            else:\n                # Standard case for sigma_t > 0\n                # The optical thickness (tau) is dimensionless\n                tau = sigma_t * L\n                \n                # Attenuation factor is dimensionless\n                attenuation = np.exp(-tau)\n                \n                # psi_out = psi_in * exp(-sigma_t*L) + (q/sigma_t) * (1 - exp(-sigma_t*L))\n                source_contribution = (q / sigma_t) * (1.0 - attenuation)\n                current_flux = current_flux * attenuation + source_contribution\n        \n        results.append(current_flux)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While isotropic scattering provides a useful simplification, in reality, neutron scattering is often anisotropic, meaning neutrons are preferentially scattered in certain directions. This exercise delves into the physical consequences of such anisotropy, particularly at material interfaces where the angular distribution of neutron flux can change dramatically . By analytically deriving the relationship between an incoming anisotropic flux and the resulting partial currents emerging from a scattering interaction, you will explore how the fundamental properties of the scattering medium, described by moments like $\\Sigma_{s,0}$ and $\\Sigma_{s,1}$, directly shape the flow of neutrons across boundaries.",
            "id": "4258252",
            "problem": "Consider steady-state, monoenergetic neutron transport in a homogeneous half-space occupying $x0$, adjacent to a vacuum region for $x0$. The interface is the plane $x=0$. The material in $x0$ has total cross section $\\Sigma_{t}$ and anisotropically scattering characterized by the first two Legendre moments $\\Sigma_{s,0}$ and $\\Sigma_{s,1}$ of the differential scattering cross section. Assume linearly anisotropic scattering (truncation at first order in the spherical harmonics (P$_1$) expansion), so that the scattering kernel in slab geometry can be represented as\n$$\n\\Sigma_{s}(\\mu,\\mu') \\;=\\; \\frac{1}{2}\\,\\Sigma_{s,0} \\;+\\; \\frac{3}{2}\\,\\Sigma_{s,1}\\,\\mu\\,\\mu' \\,,\n$$\nwhere $\\mu=\\cos\\theta$ is the direction cosine with respect to the $x$-axis and $\\mu'$ is the incoming direction cosine.\n\nIn a thin layer just inside the interface on the $x0$ side, before a collision occurs, the angular flux is known and given by\n$$\n\\psi^{\\mathrm{inc}}(\\mu') \\;=\\; \\psi_{0}\\,\\big(1 + \\alpha\\,\\mu'\\big) \\quad \\text{for} \\quad -1 \\le \\mu' \\le 1 \\,,\n$$\nwith $|\\alpha|1$ and $\\psi_{0}0$ constants. Assume that scattering within this thin layer produces a source of neutrons with angular distribution\n$$\nS(\\mu) \\;=\\; \\int_{-1}^{1} \\Sigma_{s}(\\mu,\\mu')\\,\\psi^{\\mathrm{inc}}(\\mu')\\,d\\mu' \\,,\n$$\nand that these scattered neutrons then free-stream across the interface into the vacuum with negligible attenuation or reflection at $x=0$. Under this assumption, the partial currents crossing the interface due to this scattered source are proportional to the half-range first moments of $S(\\mu)$:\n$$\nJ^{+} \\;=\\; \\int_{0}^{1} \\mu\\,S(\\mu)\\,d\\mu \\,, \\qquad\nJ^{-} \\;=\\; \\int_{-1}^{0} (-\\mu)\\,S(\\mu)\\,d\\mu \\,.\n$$\nDefine the anisotropy in partial currents at the interface by\n$$\nA \\;=\\; \\frac{J^{+}-J^{-}}{J^{+}+J^{-}} \\,.\n$$\n\nStarting from the linear Boltzmann transport equation and the definition of the scattering source term, derive $A$ in closed form in terms of $\\alpha$, $\\Sigma_{s,0}$, and $\\Sigma_{s,1}$, under the assumptions and geometry specified above. Express your final answer as a single analytic expression. No rounding is required.",
            "solution": "The problem is deemed valid as it is scientifically grounded in linear transport theory, well-posed with sufficient information for a unique solution, and expressed in objective, formal language. We can therefore proceed with the derivation.\n\nThe objective is to derive an expression for the anisotropy in partial currents, $A$, defined as $A = \\frac{J^{+}-J^{-}}{J^{+}+J^{-}}$. The derivation proceeds in three main steps: first, determining the scattering source term $S(\\mu)$; second, calculating the partial currents $J^{+}$ and $J^{-}$; and third, substituting these into the expression for $A$ to obtain the final result.\n\nStep 1: Calculation of the scattering source $S(\\mu)$.\n\nThe scattering source is defined by the integral over all incoming directions $\\mu'$:\n$$\nS(\\mu) = \\int_{-1}^{1} \\Sigma_{s}(\\mu,\\mu')\\,\\psi^{\\mathrm{inc}}(\\mu')\\,d\\mu'\n$$\nThe problem provides the linearly anisotropic scattering kernel and the incident angular flux:\n$$\n\\Sigma_{s}(\\mu,\\mu') = \\frac{1}{2}\\Sigma_{s,0} + \\frac{3}{2}\\Sigma_{s,1}\\mu\\mu'\n$$\n$$\n\\psi^{\\mathrm{inc}}(\\mu') = \\psi_{0}(1 + \\alpha\\mu')\n$$\nwhere $\\Sigma_{s,0}$ and $\\Sigma_{s,1}$ are the zeroth and first Legendre moments of the scattering cross section, respectively, and $\\psi_{0}  0$ and $|\\alpha|1$ are constants.\n\nSubstituting these into the integral for $S(\\mu)$:\n$$\nS(\\mu) = \\int_{-1}^{1} \\left( \\frac{1}{2}\\Sigma_{s,0} + \\frac{3}{2}\\Sigma_{s,1}\\mu\\mu' \\right) \\left( \\psi_{0}(1 + \\alpha\\mu') \\right) \\,d\\mu'\n$$\nWe can factor out the constant $\\psi_0$ and expand the terms in the integrand:\n$$\nS(\\mu) = \\frac{\\psi_{0}}{2} \\int_{-1}^{1} (\\Sigma_{s,0} + 3\\Sigma_{s,1}\\mu\\mu')(1 + \\alpha\\mu') \\,d\\mu'\n$$\n$$\nS(\\mu) = \\frac{\\psi_{0}}{2} \\int_{-1}^{1} (\\Sigma_{s,0} + \\alpha\\Sigma_{s,0}\\mu' + 3\\Sigma_{s,1}\\mu\\mu' + 3\\alpha\\Sigma_{s,1}\\mu(\\mu')^2) \\,d\\mu'\n$$\nWe evaluate the integral term by term, using the following definite integrals which result from the orthogonality of Legendre polynomials over the interval $[-1, 1]$:\n$$\n\\int_{-1}^{1} 1 \\,d\\mu' = 2\n$$\n$$\n\\int_{-1}^{1} \\mu' \\,d\\mu' = 0\n$$\n$$\n\\int_{-1}^{1} (\\mu')^2 \\,d\\mu' = \\frac{2}{3}\n$$\nApplying these to the expression for $S(\\mu)$:\n$$\nS(\\mu) = \\frac{\\psi_{0}}{2} \\left( \\Sigma_{s,0}\\int_{-1}^{1} 1\\,d\\mu' + \\alpha\\Sigma_{s,0}\\int_{-1}^{1}\\mu'\\,d\\mu' + 3\\Sigma_{s,1}\\mu\\int_{-1}^{1}\\mu'\\,d\\mu' + 3\\alpha\\Sigma_{s,1}\\mu\\int_{-1}^{1}(\\mu')^2\\,d\\mu' \\right)\n$$\n$$\nS(\\mu) = \\frac{\\psi_{0}}{2} \\left( \\Sigma_{s,0}(2) + \\alpha\\Sigma_{s,0}(0) + 3\\Sigma_{s,1}\\mu(0) + 3\\alpha\\Sigma_{s,1}\\mu\\left(\\frac{2}{3}\\right) \\right)\n$$\n$$\nS(\\mu) = \\frac{\\psi_{0}}{2} \\left( 2\\Sigma_{s,0} + 2\\alpha\\Sigma_{s,1}\\mu \\right)\n$$\nThis simplifies to the final expression for the scattering source:\n$$\nS(\\mu) = \\psi_{0}(\\Sigma_{s,0} + \\alpha\\Sigma_{s,1}\\mu)\n$$\nAs expected for a P$_1$ flux and a P$_1$ kernel, the resulting source is also linear in $\\mu$.\n\nStep 2: Calculation of the partial currents $J^{+}$ and $J^{-}$.\n\nThe partial currents are defined as follows:\n$$\nJ^{+} = \\int_{0}^{1} \\mu\\,S(\\mu)\\,d\\mu\n$$\n$$\nJ^{-} = \\int_{-1}^{0} (-\\mu)\\,S(\\mu)\\,d\\mu\n$$\nWe substitute our derived expression for $S(\\mu)$ into these integrals.\nFor $J^{+}$:\n$$\nJ^{+} = \\int_{0}^{1} \\mu \\left( \\psi_{0}(\\Sigma_{s,0} + \\alpha\\Sigma_{s,1}\\mu) \\right) \\,d\\mu\n$$\n$$\nJ^{+} = \\psi_{0} \\int_{0}^{1} (\\Sigma_{s,0}\\mu + \\alpha\\Sigma_{s,1}\\mu^2) \\,d\\mu\n$$\n$$\nJ^{+} = \\psi_{0} \\left[ \\Sigma_{s,0}\\frac{\\mu^2}{2} + \\alpha\\Sigma_{s,1}\\frac{\\mu^3}{3} \\right]_{0}^{1} = \\psi_{0} \\left( \\frac{\\Sigma_{s,0}}{2} + \\frac{\\alpha\\Sigma_{s,1}}{3} - 0 \\right)\n$$\n$$\nJ^{+} = \\psi_{0} \\left( \\frac{\\Sigma_{s,0}}{2} + \\frac{\\alpha\\Sigma_{s,1}}{3} \\right)\n$$\nFor $J^{-}$:\n$$\nJ^{-} = \\int_{-1}^{0} (-\\mu) \\left( \\psi_{0}(\\Sigma_{s,0} + \\alpha\\Sigma_{s,1}\\mu) \\right) \\,d\\mu\n$$\n$$\nJ^{-} = -\\psi_{0} \\int_{-1}^{0} (\\Sigma_{s,0}\\mu + \\alpha\\Sigma_{s,1}\\mu^2) \\,d\\mu\n$$\n$$\nJ^{-} = -\\psi_{0} \\left[ \\Sigma_{s,0}\\frac{\\mu^2}{2} + \\alpha\\Sigma_{s,1}\\frac{\\mu^3}{3} \\right]_{-1}^{0} = -\\psi_{0} \\left( 0 - \\left( \\Sigma_{s,0}\\frac{(-1)^2}{2} + \\alpha\\Sigma_{s,1}\\frac{(-1)^3}{3} \\right) \\right)\n$$\n$$\nJ^{-} = -\\psi_{0} \\left( -\\left( \\frac{\\Sigma_{s,0}}{2} - \\frac{\\alpha\\Sigma_{s,1}}{3} \\right) \\right) = \\psi_{0} \\left( \\frac{\\Sigma_{s,0}}{2} - \\frac{\\alpha\\Sigma_{s,1}}{3} \\right)\n$$\n\nStep 3: Calculation of the anisotropy $A$.\n\nThe anisotropy is defined as $A = \\frac{J^{+}-J^{-}}{J^{+}+J^{-}}$. We compute the numerator and denominator separately.\nNumerator:\n$$\nJ^{+} - J^{-} = \\psi_{0} \\left( \\frac{\\Sigma_{s,0}}{2} + \\frac{\\alpha\\Sigma_{s,1}}{3} \\right) - \\psi_{0} \\left( \\frac{\\Sigma_{s,0}}{2} - \\frac{\\alpha\\Sigma_{s,1}}{3} \\right) = \\psi_{0} \\left( \\frac{2\\alpha\\Sigma_{s,1}}{3} \\right)\n$$\nDenominator:\n$$\nJ^{+} + J^{-} = \\psi_{0} \\left( \\frac{\\Sigma_{s,0}}{2} + \\frac{\\alpha\\Sigma_{s,1}}{3} \\right) + \\psi_{0} \\left( \\frac{\\Sigma_{s,0}}{2} - \\frac{\\alpha\\Sigma_{s,1}}{3} \\right) = \\psi_{0} \\left( \\frac{2\\Sigma_{s,0}}{2} \\right) = \\psi_{0}\\Sigma_{s,0}\n$$\nFinally, we compute the ratio $A$:\n$$\nA = \\frac{\\psi_{0} \\left( \\frac{2\\alpha\\Sigma_{s,1}}{3} \\right)}{\\psi_{0}\\Sigma_{s,0}}\n$$\nProvided $\\psi_{0} \\ne 0$ and $\\Sigma_{s,0} \\ne 0$, which are physically necessary conditions, we can cancel $\\psi_{0}$ to obtain the final expression:\n$$\nA = \\frac{2\\alpha\\Sigma_{s,1}}{3\\Sigma_{s,0}}\n$$\nThis expression gives the anisotropy of the partial currents at the interface due to the scattered source, in terms of the initial flux anisotropy $\\alpha$ and the scattering cross-section moments $\\Sigma_{s,0}$ and $\\Sigma_{s,1}$.",
            "answer": "$$\\boxed{\\frac{2\\alpha\\Sigma_{s,1}}{3\\Sigma_{s,0}}}$$"
        },
        {
            "introduction": "Translating the continuous transport equation into a robust numerical algorithm for a computer simulation requires careful treatment of interfaces between discrete computational cells. A critical requirement for any valid numerical scheme is that it must conserve particles, ensuring that neutrons are not artificially lost or created as they cross these internal boundaries. This exercise introduces key concepts from the Finite Volume Method, including upwinding and flux reconstruction, to demonstrate how conservation is rigorously maintained at a shared face between two cells . Verifying this property is a crucial step in building confidence in the physical fidelity of a transport code.",
            "id": "4258233",
            "problem": "Consider the steady-state, monoenergetic linear Boltzmann transport equation for the angular flux $\\psi(\\mathbf{x},\\mathbf{\\Omega})$ in a source-free, isotropic, homogeneous region. The streaming term is $\\mathbf{\\Omega}\\cdot\\nabla \\psi$, where $\\mathbf{\\Omega}$ is the unit direction vector. In a finite-volume discretization over a control volume $V$ with boundary $\\partial V$ composed of planar faces, the streaming term integrates to a sum of face fluxes by the divergence theorem:\n$$\n\\int_{V} \\mathbf{\\Omega}\\cdot\\nabla \\psi \\, dV \\;=\\; \\sum_{f\\in\\partial V} \\int_{S_f} \\mathbf{\\Omega}\\cdot\\mathbf{n}_f \\, \\psi \\, dS,\n$$\nwhere $S_f$ is a face, $\\mathbf{n}_f$ is the outward unit normal of that face, and $dS$ is the surface measure. For interface consistency, the angular flux at an internal face is continuous along characteristics, and for discrete ordinates the upwind value of $\\psi$ must be used at the face. In a first-order linear reconstruction within each cell $i$, the face value is approximated as\n$$\n\\psi(\\mathbf{x}_f,\\mathbf{\\Omega}) \\approx \\psi_i(\\mathbf{\\Omega}) + \\nabla\\psi_i(\\mathbf{\\Omega})\\cdot(\\mathbf{x}_f - \\mathbf{x}_i),\n$$\nwhere $\\mathbf{x}_i$ is the cell centroid, $\\mathbf{x}_f$ is the face centroid, and $\\nabla\\psi_i(\\mathbf{\\Omega})$ is a prescribed gradient for the reconstruction. For an internal face shared by a left cell $L$ and a right cell $R$, with $\\mathbf{n}_f$ pointing from $L$ to $R$, the upwind cell for direction $\\mathbf{\\Omega}$ is $L$ if $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f0$, otherwise it is $R$ if $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f0$. If $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f=0$, the contribution is zero. The face flux is defined by\n$$\nF_f(\\mathbf{\\Omega}) \\equiv \\int_{S_f} \\mathbf{\\Omega}\\cdot\\mathbf{n}_f \\, \\psi(\\mathbf{x}_f,\\mathbf{\\Omega}) \\, dS \\approx \\left(\\mathbf{\\Omega}\\cdot\\mathbf{n}_f\\right) \\, A_f \\, \\psi_\\text{up}(\\mathbf{x}_f,\\mathbf{\\Omega}),\n$$\nwhere $A_f$ is the face area and $\\psi_\\text{up}$ is the reconstructed upwind face value. Conservation across the interface requires that the contributions of this face to the left and right cell balances be equal in magnitude and opposite in sign:\n$$\nF_f^{(L)}(\\mathbf{\\Omega}) = +F_f(\\mathbf{\\Omega}), \\quad F_f^{(R)}(\\mathbf{\\Omega}) = -F_f(\\mathbf{\\Omega}),\n$$\nso that $F_f^{(L)}(\\mathbf{\\Omega}) + F_f^{(R)}(\\mathbf{\\Omega}) = 0$ for each direction $\\mathbf{\\Omega}$.\n\nYour task is to implement this face-flux computation for a simple two-cell geometry and verify interface conservation. The geometry is two adjacent unit square cells in two dimensions that share a vertical internal face:\n- Cell indices: $i=0$ is the left cell and $i=1$ is the right cell.\n- Cell centroids: $\\mathbf{x}_0=(0.5,0.5)$ and $\\mathbf{x}_1=(1.5,0.5)$.\n- Internal face centroid: $\\mathbf{x}_f=(1.0,0.5)$.\n- Internal face normal: $\\mathbf{n}_f=(1,0)$ pointing from left to right.\n- Internal face area: $A_f=1$.\n\nFor each test case below, you are given:\n- A list of discrete directions $\\{\\mathbf{\\Omega}_m\\}_{m=1}^M$ (each is a unit vector).\n- Cell-centered angular flux values $\\psi_i(\\mathbf{\\Omega}_m)$ for $i\\in\\{0,1\\}$ and $m\\in\\{1,\\dots,M\\}$.\n- Cell-centered reconstruction gradients $\\nabla\\psi_i(\\mathbf{\\Omega}_m)$ for $i\\in\\{0,1\\}$ and $m\\in\\{1,\\dots,M\\}$.\n\nImplement the upwind linear reconstruction described above to compute the internal face flux $F_f(\\mathbf{\\Omega}_m)$ for each direction. Use the same $F_f(\\mathbf{\\Omega}_m)$ with opposite signs to form the left and right cell contributions for the shared face. For each test, return a boolean indicating whether the conservation condition across the internal interface holds to within a numerical tolerance of $10^{-12}$, that is, whether $|F_f^{(L)}(\\mathbf{\\Omega}_m) + F_f^{(R)}(\\mathbf{\\Omega}_m)| \\le 10^{-12}$ for all directions in the test. In one test you must also verify aggregated conservation by checking that the sum over directions of left and right contributions cancels to within the tolerance.\n\nNo physical units are required; treat all quantities as dimensionless.\n\nTest Suite:\n- Test 1 (right-going flow, piecewise constant reconstruction):\n  - Directions: $\\mathbf{\\Omega}_1=(1,0)$.\n  - $\\psi_0(\\mathbf{\\Omega}_1)=2.0$, $\\psi_1(\\mathbf{\\Omega}_1)=0.5$.\n  - $\\nabla\\psi_0(\\mathbf{\\Omega}_1)=(0.0,0.0)$, $\\nabla\\psi_1(\\mathbf{\\Omega}_1)=(0.0,0.0)$.\n- Test 2 (left-going flow, piecewise constant reconstruction):\n  - Directions: $\\mathbf{\\Omega}_1=(-1,0)$.\n  - $\\psi_0(\\mathbf{\\Omega}_1)=1.2$, $\\psi_1(\\mathbf{\\Omega}_1)=3.0$.\n  - $\\nabla\\psi_0(\\mathbf{\\Omega}_1)=(0.0,0.0)$, $\\nabla\\psi_1(\\mathbf{\\Omega}_1)=(0.0,0.0)$.\n- Test 3 (flow parallel to interface, zero normal component):\n  - Directions: $\\mathbf{\\Omega}_1=(0,1)$.\n  - $\\psi_0(\\mathbf{\\Omega}_1)=5.0$, $\\psi_1(\\mathbf{\\Omega}_1)=7.0$.\n  - $\\nabla\\psi_0(\\mathbf{\\Omega}_1)=(0.0,0.0)$, $\\nabla\\psi_1(\\mathbf{\\Omega}_1)=(0.0,0.0)$.\n- Test 4 (diagonal flow, linear reconstruction in upwind cell):\n  - Directions: $\\mathbf{\\Omega}_1=\\left(\\frac{\\sqrt{2}}{2},\\frac{\\sqrt{2}}{2}\\right)$.\n  - $\\psi_0(\\mathbf{\\Omega}_1)=1.0$, $\\psi_1(\\mathbf{\\Omega}_1)=4.0$.\n  - $\\nabla\\psi_0(\\mathbf{\\Omega}_1)=(1.0,0.0)$, $\\nabla\\psi_1(\\mathbf{\\Omega}_1)=(0.0,0.0)$.\n- Test 5 (aggregated conservation over multiple directions):\n  - Directions: $\\mathbf{\\Omega}_1=(1,0)$ and $\\mathbf{\\Omega}_2=\\left(\\frac{\\sqrt{2}}{2},\\frac{\\sqrt{2}}{2}\\right)$.\n  - $\\psi_0(\\mathbf{\\Omega}_1)=2.0$, $\\psi_1(\\mathbf{\\Omega}_1)=0.5$, $\\psi_0(\\mathbf{\\Omega}_2)=1.0$, $\\psi_1(\\mathbf{\\Omega}_2)=4.0$.\n  - $\\nabla\\psi_0(\\mathbf{\\Omega}_1)=(0.0,0.0)$, $\\nabla\\psi_1(\\mathbf{\\Omega}_1)=(0.0,0.0)$, $\\nabla\\psi_0(\\mathbf{\\Omega}_2)=(1.0,0.0)$, $\\nabla\\psi_1(\\mathbf{\\Omega}_2)=(0.0,0.0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"). Each result must be a boolean indicating conservation for the test as specified.",
            "solution": "The problem requires the implementation and verification of a face flux calculation for a first-order finite-volume discretization of the steady-state, monoenergetic linear Boltzmann transport equation. The central task is to verify that the implemented numerical scheme for the face flux is conservative at the interface between two computational cells.\n\nThe problem describes a specific numerical method known as a linear discontinuous scheme. The flux at a face is determined by selecting the \"upwind\" cell based on the particle direction $\\mathbf{\\Omega}$ relative to the face normal $\\mathbf{n}_f$, and then evaluating a linear reconstruction of the flux from that upwind cell's data at the face's centroid.\n\nThe conservation property is defined by the requirement that the flux contribution from a shared face to the balance equation of the left cell, $F_f^{(L)}(\\mathbf{\\Omega})$, must be equal in magnitude and opposite in sign to the contribution to the right cell, $F_f^{(R)}(\\mathbf{\\Omega})$. The problem defines these contributions as $F_f^{(L)}(\\mathbf{\\Omega}) = +F_f(\\mathbf{\\Omega})$ and $F_f^{(R)}(\\mathbf{\\Omega}) = -F_f(\\mathbf{\\Omega})$, where $F_f(\\mathbf{\\Omega})$ is the net flux across the face. By this construction, the sum $F_f^{(L)}(\\mathbf{\\Omega}) + F_f^{(R)}(\\mathbf{\\Omega})$ is analytically zero. The verification task, therefore, is to implement the calculation of $F_f(\\mathbf{\\Omega})$ correctly and confirm that $|F_f^{(L)}(\\mathbf{\\Omega}) + F_f^{(R)}(\\mathbf{\\Omega})| \\le 10^{-12}$, which will hold true if the implementation correctly computes $F_f(\\mathbf{\\Omega})$ and applies the definitions for $F_f^{(L)}$ and $F_f^{(R)}$.\n\nThe geometric and physical setup is as follows:\n- Left cell ($i=0$): centroid $\\mathbf{x}_0 = (0.5, 0.5)$.\n- Right cell ($i=1$): centroid $\\mathbf{x}_1 = (1.5, 0.5)$.\n- Internal face: centroid $\\mathbf{x}_f = (1.0, 0.5)$, area $A_f=1$, and outward normal from left to right $\\mathbf{n}_f = (1, 0)$.\n\nThe algorithm to compute the face flux $F_f(\\mathbf{\\Omega})$ and check conservation for a single direction $\\mathbf{\\Omega}$ is:\n1.  **Determine the upwind cell.** We calculate the dot product $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f$.\n    - If $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0$, particles flow from left to right. The upwind cell is the left cell, index $u=0$.\n    - If $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0$, particles flow from right to left. The upwind cell is the right cell, index $u=1$.\n    - If $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f = 0$, there is no net flow across the face, so $F_f(\\mathbf{\\Omega})=0$.\n\n2.  **Evaluate the reconstructed upwind flux at the face.** The linear reconstruction formula is used:\n    $$ \\psi_{\\text{up}}(\\mathbf{x}_f, \\mathbf{\\Omega}) = \\psi_u(\\mathbf{\\Omega}) + \\nabla\\psi_u(\\mathbf{\\Omega}) \\cdot (\\mathbf{x}_f - \\mathbf{x}_u) $$\n    where $\\psi_u(\\mathbf{\\Omega})$ and $\\nabla\\psi_u(\\mathbf{\\Omega})$ are the given cell-centered angular flux and its gradient for the upwind cell $u$.\n\n3.  **Compute the net face flux.** The flux is given by:\n    $$ F_f(\\mathbf{\\Omega}) = (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f) A_f \\psi_{\\text{up}}(\\mathbf{x}_f, \\mathbf{\\Omega}) $$\n\n4.  **Verify conservation.** We check if $|F_f(\\mathbf{\\Omega}) + (-F_f(\\mathbf{\\Omega}))| \\le 10^{-12}$. This simplifies to $|0| \\le 10^{-12}$, which is always true. The test thus validates the correct computation of $F_f(\\mathbf{\\Omega})$ as the cornerstone of the conservation property.\n\nWe now apply this procedure to each test case.\n\n**Test 1: Right-going flow, piecewise constant reconstruction**\n- Direction: $\\mathbf{\\Omega}_1 = (1, 0)$.\n- Data: $\\psi_0(\\mathbf{\\Omega}_1)=2.0$, $\\nabla\\psi_0(\\mathbf{\\Omega}_1)=(0.0, 0.0)$.\n- Upwind check: $\\mathbf{\\Omega}_1 \\cdot \\mathbf{n}_f = (1, 0) \\cdot (1, 0) = 1  0$. The upwind cell is $u=0$ (left).\n- Reconstruction: The gradient is zero, so this is a piecewise constant or \"step\" scheme. $\\psi_{\\text{up}}(\\mathbf{x}_f, \\mathbf{\\Omega}_1) = \\psi_0(\\mathbf{\\Omega}_1) = 2.0$.\n- Face flux: $F_f(\\mathbf{\\Omega}_1) = (1)(1)(2.0) = 2.0$.\n- Conservation: $F_f^{(L)} = 2.0$, $F_f^{(R)} = -2.0$. $|2.0 + (-2.0)| = 0 \\le 10^{-12}$. The condition holds.\n\n**Test 2: Left-going flow, piecewise constant reconstruction**\n- Direction: $\\mathbf{\\Omega}_1 = (-1, 0)$.\n- Data: $\\psi_1(\\mathbf{\\Omega}_1)=3.0$, $\\nabla\\psi_1(\\mathbf{\\Omega}_1)=(0.0, 0.0)$.\n- Upwind check: $\\mathbf{\\Omega}_1 \\cdot \\mathbf{n}_f = (-1, 0) \\cdot (1, 0) = -1  0$. The upwind cell is $u=1$ (right).\n- Reconstruction: $\\psi_{\\text{up}}(\\mathbf{x}_f, \\mathbf{\\Omega}_1) = \\psi_1(\\mathbf{\\Omega}_1) = 3.0$.\n- Face flux: $F_f(\\mathbf{\\Omega}_1) = (-1)(1)(3.0) = -3.0$.\n- Conservation: $F_f^{(L)} = -3.0$, $F_f^{(R)} = -(-3.0) = 3.0$. $|-3.0 + 3.0| = 0 \\le 10^{-12}$. The condition holds.\n\n**Test 3: Flow parallel to interface**\n- Direction: $\\mathbf{\\Omega}_1 = (0, 1)$.\n- Data: Not needed for flux calculation, but given as $\\psi_0(\\mathbf{\\Omega}_1)=5.0$, $\\psi_1(\\mathbf{\\Omega}_1)=7.0$.\n- Upwind check: $\\mathbf{\\Omega}_1 \\cdot \\mathbf{n}_f = (0, 1) \\cdot (1, 0) = 0$.\n- Face flux: Since the dot product is zero, $F_f(\\mathbf{\\Omega}_1) = 0$.\n- Conservation: $F_f^{(L)} = 0$, $F_f^{(R)} = 0$. $|0 + 0| = 0 \\le 10^{-12}$. The condition holds.\n\n**Test 4: Diagonal flow, linear reconstruction**\n- Direction: $\\mathbf{\\Omega}_1 = (\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2})$.\n- Data: $\\psi_0(\\mathbf{\\Omega}_1)=1.0$, $\\nabla\\psi_0(\\mathbf{\\Omega}_1)=(1.0, 0.0)$.\n- Upwind check: $\\mathbf{\\Omega}_1 \\cdot \\mathbf{n}_f = (\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}) \\cdot (1, 0) = \\frac{\\sqrt{2}}{2}  0$. The upwind cell is $u=0$ (left).\n- Reconstruction:\n  - Displacement vector: $\\mathbf{x}_f - \\mathbf{x}_0 = (1.0, 0.5) - (0.5, 0.5) = (0.5, 0.0)$.\n  - Reconstructed value: $\\psi_{\\text{up}}(\\mathbf{x}_f, \\mathbf{\\Omega}_1) = \\psi_0(\\mathbf{\\Omega}_1) + \\nabla\\psi_0(\\mathbf{\\Omega}_1) \\cdot (\\mathbf{x}_f - \\mathbf{x}_0) = 1.0 + (1.0, 0.0) \\cdot (0.5, 0.0) = 1.0 + 0.5 = 1.5$.\n- Face flux: $F_f(\\mathbf{\\Omega}_1) = (\\frac{\\sqrt{2}}{2})(1)(1.5) = \\frac{1.5\\sqrt{2}}{2} = 0.75\\sqrt{2}$.\n- Conservation: $F_f^{(L)} = 0.75\\sqrt{2}$, $F_f^{(R)} = -0.75\\sqrt{2}$. $|0.75\\sqrt{2} - 0.75\\sqrt{2}| = 0 \\le 10^{-12}$. The condition holds.\n\n**Test 5: Aggregated conservation over multiple directions**\nThis test requires checking conservation for each direction individually and then checking the conservation of the sum of fluxes over all directions.\n\n- **Direction 1:** $\\mathbf{\\Omega}_1 = (1, 0)$. This is identical to Test 1.\n  - $F_f(\\mathbf{\\Omega}_1) = 2.0$.\n  - $F_f^{(L)}(\\mathbf{\\Omega}_1) = 2.0$, $F_f^{(R)}(\\mathbf{\\Omega}_1) = -2.0$.\n  - Conservation check 1: $|2.0 - 2.0| = 0 \\le 10^{-12}$. This holds.\n\n- **Direction 2:** $\\mathbf{\\Omega}_2 = (\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2})$. This is identical to Test 4.\n  - $F_f(\\mathbf{\\Omega}_2) = 0.75\\sqrt{2}$.\n  - $F_f^{(L)}(\\mathbf{\\Omega}_2) = 0.75\\sqrt{2}$, $F_f^{(R)}(\\mathbf{\\Omega}_2) = -0.75\\sqrt{2}$.\n  - Conservation check 2: $|0.75\\sqrt{2} - 0.75\\sqrt{2}| = 0 \\le 10^{-12}$. This holds.\n\n- **Aggregated Conservation:** We check the sum of contributions to the left and right cells.\n  - Total contribution to left cell: $\\sum_m F_f^{(L)}(\\mathbf{\\Omega}_m) = F_f^{(L)}(\\mathbf{\\Omega}_1) + F_f^{(L)}(\\mathbf{\\Omega}_2) = 2.0 + 0.75\\sqrt{2}$.\n  - Total contribution to right cell: $\\sum_m F_f^{(R)}(\\mathbf{\\Omega}_m) = F_f^{(R)}(\\mathbf{\\Omega}_1) + F_f^{(R)}(\\mathbf{\\Omega}_2) = -2.0 - 0.75\\sqrt{2}$.\n  - Aggregated check: $|\\left( \\sum_m F_f^{(L)}(\\mathbf{\\Omega}_m) \\right) + \\left( \\sum_m F_f^{(R)}(\\mathbf{\\Omega}_m) \\right)| = |(2.0 + 0.75\\sqrt{2}) + (-2.0 - 0.75\\sqrt{2})| = 0 \\le 10^{-12}$. This holds.\n\nSince all individual and aggregated conservation checks pass, the result for Test 5 is true. As demonstrated, the conservation condition is satisfied for all test cases due to the definitional nature of the flux contributions $F_f^{(L)}$ and $F_f^{(R)}$. The implementation simply needs to correctly calculate the underlying face flux $F_f(\\mathbf{\\Omega})$ for this property to be numerically verified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and verifies the face-flux conservation for a finite-volume\n    discretization of the linear transport equation.\n    \"\"\"\n    \n    # Define geometry\n    x0 = np.array([0.5, 0.5])  # Centroid of left cell (i=0)\n    x1 = np.array([1.5, 0.5])  # Centroid of right cell (i=1)\n    xf = np.array([1.0, 0.5])  # Centroid of internal face\n    nf = np.array([1.0, 0.0])  # Normal vector of internal face\n    Af = 1.0                      # Area of internal face\n    \n    # Tolerance for conservation check\n    tolerance = 1e-12\n\n    test_cases = [\n        # Test 1: Right-going flow, piecewise constant\n        {\n            'directions': [np.array([1.0, 0.0])],\n            'psi_vals': {0: [2.0], 1: [0.5]},\n            'grad_psi_vals': {0: [np.array([0.0, 0.0])], 1: [np.array([0.0, 0.0])]}\n        },\n        # Test 2: Left-going flow, piecewise constant\n        {\n            'directions': [np.array([-1.0, 0.0])],\n            'psi_vals': {0: [1.2], 1: [3.0]},\n            'grad_psi_vals': {0: [np.array([0.0, 0.0])], 1: [np.array([0.0, 0.0])]}\n        },\n        # Test 3: Flow parallel to interface\n        {\n            'directions': [np.array([0.0, 1.0])],\n            'psi_vals': {0: [5.0], 1: [7.0]},\n            'grad_psi_vals': {0: [np.array([0.0, 0.0])], 1: [np.array([0.0, 0.0])]}\n        },\n        # Test 4: Diagonal flow, linear reconstruction\n        {\n            'directions': [np.array([np.sqrt(2)/2, np.sqrt(2)/2])],\n            'psi_vals': {0: [1.0], 1: [4.0]},\n            'grad_psi_vals': {0: [np.array([1.0, 0.0])], 1: [np.array([0.0, 0.0])]}\n        },\n        # Test 5: Aggregated conservation\n        {\n            'directions': [np.array([1.0, 0.0]), np.array([np.sqrt(2)/2, np.sqrt(2)/2])],\n            'psi_vals': {0: [2.0, 1.0], 1: [0.5, 4.0]},\n            'grad_psi_vals': {\n                0: [np.array([0.0, 0.0]), np.array([1.0, 0.0])],\n                1: [np.array([0.0, 0.0]), np.array([0.0, 0.0])]\n            }\n        },\n    ]\n\n    results = []\n    \n    for i, case in enumerate(test_cases):\n        all_conserved = True\n        total_F_L = 0.0\n        total_F_R = 0.0\n        \n        for m, omega in enumerate(case['directions']):\n            # 1. Determine upwind cell\n            dot_product = np.dot(omega, nf)\n            \n            if dot_product > 0:\n                u = 0  # upwind is left cell\n                psi_u = case['psi_vals'][u][m]\n                grad_psi_u = case['grad_psi_vals'][u][m]\n                xu = x0\n            elif dot_product  0:\n                u = 1  # upwind is right cell\n                psi_u = case['psi_vals'][u][m]\n                grad_psi_u = case['grad_psi_vals'][u][m]\n                xu = x1\n            else: # dot_product is zero\n                psi_up_f = 0.0\n                F_f = 0.0\n\n            if dot_product != 0:\n                # 2. Evaluate reconstructed upwind flux at the face\n                displacement = xf - xu\n                psi_up_f = psi_u + np.dot(grad_psi_u, displacement)\n                \n                # 3. Compute net face flux\n                F_f = dot_product * Af * psi_up_f\n            \n            # 4. Define cell contributions\n            F_f_L = F_f\n            F_f_R = -F_f\n            \n            total_F_L += F_f_L\n            total_F_R += F_f_R\n\n            # 5. Verify conservation for this direction\n            if abs(F_f_L + F_f_R) > tolerance:\n                all_conserved = False\n                break\n        \n        if not all_conserved:\n            results.append(False)\n            continue\n            \n        # For Test 5 (index 4), also check aggregated conservation\n        if i == 4:\n            if abs(total_F_L + total_F_R) > tolerance:\n                all_conserved = False\n\n        results.append(all_conserved)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}