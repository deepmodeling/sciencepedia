{
    "hands_on_practices": [
        {
            "introduction": "在两相流中，由于相变（如沸腾）引起的流体密度变化会导致流体加速，从而产生压降。这个加速压降（accelerational pressure drop）分量是总压降的重要组成部分，尤其是在高热流密度或显著的质量含气率变化的系统中。本练习旨在通过均相流平衡模型（Homogeneous Equilibrium Model, HEM）这一简化但极具启发性的框架，引导你从第一性原理出发，推导并计算加速压降，从而建立对这一物理现象的核心理解。",
            "id": "4259268",
            "problem": "一根长度为 $L = 4.0\\,\\mathrm{m}$ 的垂直、均匀加热、恒定截面积的圆形管道中，饱和水正在进行两相沸腾。饱和压力近似均匀，因此液相和气相密度可视为常数，分别为 $\\rho_{\\ell} = 700\\,\\mathrm{kg/m^3}$ 和 $\\rho_{g} = 35\\,\\mathrm{kg/m^3}$。质量通量是均匀的，等于 $G = 1.50 \\times 10^{3}\\,\\mathrm{kg/(m^2\\,s)}$。入口 $z=0$ 处的干度为 $x(0) = 0.05$，轴向干度分布由下式给出\n$$\nx(z) = 0.05 + 0.20\\,\\frac{z}{L} + 0.05\\,\\frac{z}{L}\\left(1 - \\frac{z}{L}\\right), \\quad 0 \\le z \\le L.\n$$\n使用滑移比 $S=1$ 且处于热/机械平衡状态的均匀平衡模型（HEM）对流动进行建模。在HEM下，混合物的比容为 $v_{m}(x) = \\frac{1}{\\rho_{m}(x)} = \\frac{x}{\\rho_{g}} + \\frac{1-x}{\\rho_{\\ell}}$，混合物速度为 $V_{m}(z) = G\\,v_{m}(x(z))$。忽略壁面摩擦和重力贡献，仅计算压力变化的加速分量。\n\n从管道微分控制体的一维稳态动量平衡和HEM混合物描述出发，推导沿管道长度的加速压降表达式，并用给定数据进行计算。\n\n最终答案以 $\\mathrm{kPa}$ 为单位，并四舍五入到 $4$ 位有效数字。",
            "solution": "分析始于对恒定截面积管道的微分控制体进行的一维稳态动量平衡。总压降梯度的通用方程是三个分量之和：摩擦、重力和加速。\n$$\n\\left(-\\frac{dp}{dz}\\right)_{total} = \\left(-\\frac{dp}{dz}\\right)_{fric} + \\left(-\\frac{dp}{dz}\\right)_{grav} + \\left(-\\frac{dp}{dz}\\right)_{accel}\n$$\n题目明确要求忽略壁面摩擦和重力贡献。因此，我们只考虑加速分量。\n$$\n-\\frac{dp}{dz} = \\left(-\\frac{dp}{dz}\\right)_{accel}\n$$\n加速压降梯度是由流体轴向动量通量的变化引起的。对于一个截面积为 $A$、长度为 $dz$ 的控制体，由压力产生的净力等于动量通量的变化率。动量通量由 $(\\text{质量流量}) \\times (\\text{速度})$ 给出，即 $(\\dot{m})(V_m)$。单位面积的动量通量为 $(\\dot{m}/A)V_m = G V_m$。在长度 $dz$ 上的动量通量变化为 $d(A G V_m)$。\n动量平衡为：\n$$\npA - (p+dp)A = d(\\dot{m}V_m) = d(G A V_m)\n$$\n由于质量通量 $G$ 和截面积 $A$ 是常数，上式简化为：\n$$\n-A dp = A G dV_m\n$$\n两边同除以 $A dz$，我们得到加速压降梯度的表达式：\n$$\n-\\frac{dp}{dz} = G \\frac{dV_m}{dz}\n$$\n题目指定使用均匀平衡模型（HEM）。在此模型中，假定两相以相同的速度运动，即滑移比 $S=1$。混合物速度 $V_m$ 通过 $V_m(z) = G v_m(z)$ 与恒定的质量通量 $G$ 和混合物比容 $v_m(z)$ 相关。混合物比容是当地干度 $x(z)$ 以及恒定的液相比容 ($v_\\ell = 1/\\rho_\\ell$) 和气相比容 ($v_g = 1/\\rho_g$) 的函数：\n$$\nv_m(x) = x v_g + (1-x) v_\\ell = x \\frac{1}{\\rho_g} + (1-x) \\frac{1}{\\rho_\\ell}\n$$\n我们可以将其重新排列为：\n$$\nv_m(x) = \\frac{1}{\\rho_\\ell} + x \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell}\\right)\n$$\n将 $V_m(z) = G v_m(x(z))$ 代入压降梯度方程：\n$$\n-\\frac{dp}{dz} = G \\frac{d}{dz}\\left[ G \\left(\\frac{1}{\\rho_\\ell} + x(z) \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell}\\right)\\right) \\right]\n$$\n由于 $G$、$\\rho_\\ell$ 和 $\\rho_g$ 是常数，导数仅作用于干度 $x(z)$：\n$$\n-\\frac{dp}{dz} = G^2 \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell}\\right) \\frac{dx}{dz}\n$$\n为了求得总加速压降 $\\Delta p_{accel} = p_{in} - p_{out} = p(0) - p(L)$，我们将此表达式沿管道长度从 $z=0$ 到 $z=L$ 进行积分：\n$$\n\\Delta p_{accel} = \\int_{0}^{L} \\left(-\\frac{dp}{dz}\\right) dz = \\int_{0}^{L} G^2 \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell}\\right) \\frac{dx}{dz} dz\n$$\n由于 $G$、$\\rho_g$ 和 $\\rho_\\ell$ 是常数，我们可以将它们移出积分：\n$$\n\\Delta p_{accel} = G^2 \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell}\\right) \\int_{0}^{L} \\frac{dx}{dz} dz\n$$\n根据微积分基本定理，导数 $dx/dz$ 的积分就是 $x$ 在该区间上的变化量：\n$$\n\\int_{0}^{L} \\frac{dx}{dz} dz = x(L) - x(0)\n$$\n因此，加速压降的最终表达式为：\n$$\n\\Delta p_{accel} = G^2 [x(L) - x(0)] \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell}\\right)\n$$\n这个结果表明，对于具有恒定流体性质的HEM模型，加速压降仅取决于入口和出口之间的干度变化，而与具体的轴向干度分布无关。\n\n现在我们使用给定数据来计算此表达式的值。\n给定数据如下：\n$G = 1.50 \\times 10^{3}\\,\\mathrm{kg/(m^2\\,s)}$\n$\\rho_\\ell = 700\\,\\mathrm{kg/m^3}$\n$\\rho_g = 35\\,\\mathrm{kg/m^3}$\n$L = 4.0\\,\\mathrm{m}$\n入口干度为 $x(0) = 0.05$。\n出口干度 $x(L)$ 通过将 $z=L$ 代入给定的干度分布公式计算得出：\n$$\nx(L) = 0.05 + 0.20\\,\\frac{L}{L} + 0.05\\,\\frac{L}{L}\\left(1 - \\frac{L}{L}\\right) = 0.05 + 0.20 \\times 1 + 0.05 \\times 1 \\times (1-1) = 0.25\n$$\n干度变化为 $x(L) - x(0) = 0.25 - 0.05 = 0.20$。\n\n现在，我们将数值代入推导出的公式中：\n$$\n\\Delta p_{accel} = (1.50 \\times 10^{3})^2 [0.25 - 0.05] \\left(\\frac{1}{35} - \\frac{1}{700}\\right)\n$$\n首先，计算各项：\n$G^2 = (1.50 \\times 10^{3})^2 = 2.25 \\times 10^6 \\, (\\mathrm{kg/(m^2 s)})^2$\n$x(L) - x(0) = 0.20$\n$\\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell} = \\frac{1}{35} - \\frac{1}{700} = \\frac{20}{700} - \\frac{1}{700} = \\frac{19}{700} \\, \\mathrm{m^3/kg}$\n将这些值代入 $\\Delta p_{accel}$ 的方程中：\n$$\n\\Delta p_{accel} = (2.25 \\times 10^6) \\times (0.20) \\times \\left(\\frac{19}{700}\\right)\n$$\n$$\n\\Delta p_{accel} = (0.45 \\times 10^6) \\times \\left(\\frac{19}{700}\\right) = \\frac{0.45 \\times 19 \\times 10^6}{700} = \\frac{8.55 \\times 10^6}{700} = \\frac{8.55}{7} \\times 10^4\n$$\n$$\n\\Delta p_{accel} \\approx 1.22142857 \\times 10^4 \\, \\mathrm{Pa}\n$$\n单位是 $\\mathrm{Pa}$，因为 $(\\mathrm{kg/(m^2 s)})^2 \\times (\\mathrm{m^3/kg}) = (\\mathrm{kg}^2 / (\\mathrm{m}^4 \\mathrm{s}^2)) \\times (\\mathrm{m}^3/\\mathrm{kg}) = \\mathrm{kg}/(\\mathrm{m} \\mathrm{s}^2) = \\mathrm{N/m^2} = \\mathrm{Pa}$。\n题目要求答案以千帕（$\\mathrm{kPa}$）为单位。\n$$\n\\Delta p_{accel} = 12.2142857 \\, \\mathrm{kPa}\n$$\n四舍五入到 $4$ 位有效数字，我们得到：\n$$\n\\Delta p_{accel} \\approx 12.21 \\, \\mathrm{kPa}\n$$",
            "answer": "$$\\boxed{12.21}$$"
        },
        {
            "introduction": "真实的工程分析要求我们将多个物理现象整合到一个统一的模型中。本实践将引导你超越对单个压降分量的分析，构建一个更完整的一维两相流压降计算模型。你将从能量守恒方程出发，把输入的热流密度与沿程的蒸汽质量含气率分布联系起来，并以此为基础计算加速压降和摩擦压降，后者还需要你运用数值积分的方法来求解。",
            "id": "4259269",
            "problem": "考虑在水力直径为 $D_h$、长度为 $L$ 的均匀圆形通道中的一维稳态饱和沸腾流。质量通量为 $G$（定义为单位横截面积的质量流率，单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$），流入流体的有效轴向热通量分布为 $q''(z)$（定义为单位质量的能量平衡方程为 $d(h)/dz = q''(z)/G$，其中 $q''$ 的单位为 $\\mathrm{W}\\,\\mathrm{m}^{-2}$）。假设采用均匀平衡模型（Homogeneous Equilibrium Model, HEM）：液相和气相以相同的速度运动（滑移比等于1），流动在固定压力下处于饱和状态，因此饱和性质为常数，并且轴向热传导以及轴向功均可忽略不计。设饱和沸腾段的入口位于 $z = 0$，入口干度为 $x(0) = 0$。\n\n从基本能量平衡方程 $d(h)/dz = q''(z)/G$ 和饱和状态下混合物焓的定义出发，推导沿通道的气相干度 $x(z)$ 的表达式，该表达式是 $q''(z)$、质量通量 $G$ 和汽化潜热 $h_{fg}$ 的函数。然后，使用适用于恒定截面积流动的一维稳态动量方程，在HEM假设下计算沿通道长度 $L$ 的加速压降 $\\Delta P_a$ 和摩擦压降 $\\Delta P_f$。\n\n使用以下基于物理的定义和模型选择：\n- 饱和混合物焓为 $h(z) = h_f + x(z)\\,h_{fg}$，其中 $h_f$ 是饱和液体焓（在固定压力假设下为常数），$h_{fg}$ 是汽化潜热。\n- HEM下的混合物密度为 $\\rho_m(x) = \\left(\\dfrac{x}{\\rho_g} + \\dfrac{1-x}{\\rho_\\ell}\\right)^{-1}$，其中 $\\rho_\\ell$ 和 $\\rho_g$ 分别是饱和液体和饱和蒸汽的密度。\n- 混合物粘度模型为线性质量分数混合模型 $\\mu_m(x) = x\\,\\mu_g + (1-x)\\,\\mu_\\ell$，其中 $\\mu_\\ell$ 和 $\\mu_g$ 分别是饱和液体和饱和蒸汽的粘度。\n- 范宁（Fanning）摩擦因子 $f_F$ 根据在混合物雷诺数 $\\mathrm{Re}_m = \\dfrac{G\\,D_h}{\\mu_m}$ 下评估的广泛使用的单相流关联式进行分段建模：\n  - 层流区（对于 $\\mathrm{Re}_m \\le 2300$）：$f_F = \\dfrac{16}{\\mathrm{Re}_m}$。\n  - 湍流区（对于 $\\mathrm{Re}_m > 2300$）：$f_F = 0.0791\\,\\mathrm{Re}_m^{-0.25}$。\n- 圆形通道中完全发展流动的摩擦压力梯度为 $dP_f/dz = \\dfrac{2\\,f_F\\,G^2}{D_h\\,\\rho_m(x(z))}$。\n- 通道上的加速压降由动量方程项 $\\Delta P_a = G^2\\left(\\dfrac{1}{\\rho_m(L)} - \\dfrac{1}{\\rho_m(0)}\\right)$ 计算得出。\n\n假设如果计算出的 $x(z)$ 超过 $1$（干涸），则对于所有后续的 $z$，将其限制为 $x(z) = 1$，并且在干涸位置之后的物性（$\\rho_m, \\mu_m$）将与 $x=1$ 一致地进行评估。\n\n为以下测试案例集实现推导并计算数值结果。在所有案例中，使用恒定的饱和物性：$\\rho_\\ell = 700\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$\\rho_g = 35\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$\\mu_\\ell = 1.0\\times 10^{-4}\\,\\mathrm{Pa}\\,\\mathrm{s}$，$\\mu_g = 1.2\\times 10^{-5}\\,\\mathrm{Pa}\\,\\mathrm{s}$，以及 $h_{fg} = 1.2\\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$。热通量函数 $q''(z)$ 在 $z \\in [0,L]$ 上定义：\n\n- 案例1（基准恒定热通量）：\n  - $L = 3.0\\,\\mathrm{m}$, $D_h = 0.012\\,\\mathrm{m}$, $G = 900\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$,\n  - $q''(z) = 2.5\\times 10^{5}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$ for all $z$.\n\n- 案例2（导致早期干涸的高热通量）：\n  - $L = 4.0\\,\\mathrm{m}$, $D_h = 0.010\\,\\mathrm{m}$, $G = 600\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$,\n  - $q''(z) = 6.0\\times 10^{5}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$ for all $z$.\n\n- 案例3（零热量输入）：\n  - $L = 2.0\\,\\mathrm{m}$, $D_h = 0.015\\,\\mathrm{m}$, $G = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$,\n  - $q''(z) = 0\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$ for all $z$.\n\n- 案例4（空间变化的热通量）：\n  - $L = 3.5\\,\\mathrm{m}$, $D_h = 0.011\\,\\mathrm{m}$, $G = 1100\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$,\n  - $q''(z) = 3.0\\times 10^{5}\\left(1 + 0.2\\,\\sin\\left(\\dfrac{\\pi\\,z}{L}\\right)\\right)\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$。\n\n您的程序必须：\n- 从能量平衡中推导 $x(z)$，并将其饱和到区间 $[0,1]$。\n- 使用在 $z=0$ 和 $z=L$ 处的HEM混合物密度计算 $\\Delta P_a$（单位为 $\\mathrm{Pa}$）。\n- 通过使用指定的摩擦因子和混合物性，沿 $z \\in [0,L]$ 对 $dP_f/dz$ 进行数值积分，计算 $\\Delta P_f$（单位为 $\\mathrm{Pa}$）。\n- 将每个案例的最终输出表示为一个包含三个浮点数的列表 $[x_{\\text{out}}, \\Delta P_a, \\Delta P_f]$，其中 $x_{\\text{out}} = x(L)$ 是无量纲的，压降单位为 $\\mathrm{Pa}$。\n- 将每个报告的数字四舍五入到 $6$ 位小数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个案例的结果按从案例1到案例4的顺序作为子列表出现。例如，输出结构必须是 $[[x_1,\\Delta P_{a,1},\\Delta P_{f,1}],[x_2,\\Delta P_{a,2},\\Delta P_{f,2}],\\dots]$ 的形式，不打印任何额外文本。",
            "solution": "该问题要求基于均匀平衡模型（HEM）推导和计算加热通道中两相流的气相干度和压降分量。解决方案包括三个主要步骤：推导轴向气相干度分布 $x(z)$，计算加速压降 $\\Delta P_a$，以及通过数值积分计算摩擦压降 $\\Delta P_f$。\n\n### 步骤1：气相干度分布 $x(z)$ 的推导\n\n分析始于流体元的稳态一维能量平衡方程，表示为：\n$$\n\\frac{dh}{dz} = \\frac{q''(z)}{G}\n$$\n此处，$h$ 是混合物比焓，$z$ 是轴向坐标，$q''(z)$ 是有效轴向热通量分布，$G$ 是质量通量。\n\n在恒定压力下饱和流动的假设下，饱和性质是恒定的。混合物焓 $h(z)$ 定义为饱和液体焓 $h_f$ 和饱和蒸汽焓 $h_g$ 的质量分数加权平均值：\n$$\nh(z) = (1-x(z))h_f + x(z)h_g = h_f + x(z)(h_g-h_f) = h_f + x(z)h_{fg}\n$$\n其中 $x(z)$ 是气相干度，$h_{fg}$ 是汽化潜热。\n\n由于 $h_f$ 和 $h_{fg}$ 是常数，对焓表达式关于 $z$求导可得：\n$$\n\\frac{dh}{dz} = \\frac{d}{dz}(h_f + x(z)h_{fg}) = h_{fg}\\frac{dx}{dz}\n$$\n令两个 $\\frac{dh}{dz}$ 表达式相等：\n$$\nh_{fg}\\frac{dx}{dz} = \\frac{q''(z)}{G} \\implies \\frac{dx}{dz} = \\frac{q''(z)}{G h_{fg}}\n$$\n这个常微分方程描述了沿通道的气相干度变化。为了求得 $x(z)$，我们从通道入口 $z=0$ 积分到一个任意位置 $z$。根据给定的入口条件 $x(0)=0$：\n$$\n\\int_{x(0)}^{x(z)} dx' = \\int_0^z \\frac{q''(z')}{G h_{fg}} dz'\n$$\n$$\nx(z) - 0 = \\frac{1}{G h_{fg}} \\int_0^z q''(z') dz'\n$$\n问题指明，如果干度超过 $1$（干涸），则应将其限制为 $1$。因此，物理上可实现的气相干度 $x(z)$ 为：\n$$\nx(z) = \\min\\left(1, \\frac{1}{G h_{fg}} \\int_0^z q''(z') dz'\\right)\n$$\n此表达式将用于确定沿通道任意点 $z$ 处的干度，包括出口干度 $x_{out} = x(L)$。\n\n### 步骤2：加速压降 $\\Delta P_a$ 的计算\n\n加速压降 $\\Delta P_a$ 是由于沿通道的密度变化引起的流体动量变化所导致的。对于HEM下的恒定截面积通道，其表达式为：\n$$\n\\Delta P_a = G^2 \\left( \\frac{1}{\\rho_m(L)} - \\frac{1}{\\rho_m(0)} \\right)\n$$\n其中 $\\rho_m(z)$ 是位置 $z$ 处的HEM混合物密度。混合物密度是混合物比容的倒数，而混合物比容是各相比容（$v_\\ell = 1/\\rho_\\ell$, $v_g=1/\\rho_g$）的质量分数加权平均值：\n$$\n\\frac{1}{\\rho_m(x)} = \\frac{1-x}{\\rho_\\ell} + \\frac{x}{\\rho_g}\n$$\n在入口处，$z=0$，干度为 $x(0)=0$。混合物密度纯粹是液体密度：\n$$\n\\frac{1}{\\rho_m(0)} = \\frac{1-0}{\\rho_\\ell} + \\frac{0}{\\rho_g} = \\frac{1}{\\rho_\\ell}\n$$\n在出口处，$z=L$，干度为 $x_{out}=x(L)$。混合物密度为 $\\rho_m(L)$。将这些代入 $\\Delta P_a$ 公式：\n$$\n\\Delta P_a = G^2 \\left( \\left(\\frac{1-x_{out}}{\\rho_\\ell} + \\frac{x_{out}}{\\rho_g}\\right) - \\frac{1}{\\rho_\\ell} \\right) = G^2 \\left( \\frac{1}{\\rho_\\ell} - \\frac{x_{out}}{\\rho_\\ell} + \\frac{x_{out}}{\\rho_g} - \\frac{1}{\\rho_\\ell} \\right)\n$$\n简化此表达式可得到用于计算的最终公式：\n$$\n\\Delta P_a = G^2 x_{out} \\left( \\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell} \\right)\n$$\n\n### 步骤3：摩擦压降 $\\Delta P_f$ 的计算\n\n摩擦压降 $\\Delta P_f$ 是局部摩擦压力梯度 $\\frac{dP_f}{dz}$ 在通道长度 $L$ 上的积分：\n$$\n\\Delta P_f = \\int_0^L \\frac{dP_f}{dz} dz\n$$\n问题给出了摩擦压力梯度的表达式：\n$$\n\\frac{dP_f}{dz} = \\frac{2 f_F G^2}{D_h \\rho_m(x(z))}\n$$\n该被积函数的求值取决于局部气相干度 $x(z)$。对于任意给定的 $z$，执行以下计算序列：\n1.  **气相干度 $x(z)$**：使用步骤1中推导的公式计算。\n2.  **混合物粘度 $\\mu_m(z)$**：使用线性质量分数混合模型计算：\n    $$\n    \\mu_m(x(z)) = x(z)\\mu_g + (1-x(z))\\mu_\\ell\n    $$\n3.  **混合物雷诺数 $\\mathrm{Re}_m(z)$**：使用混合物粘度计算：\n    $$\n    \\mathrm{Re}_m(z) = \\frac{G D_h}{\\mu_m(x(z))}\n    $$\n4.  **范宁（Fanning）摩擦因子 $f_F(z)$**：由基于局部雷诺数的分段关联式确定：\n    $$\n    f_F = \\begin{cases} 16 / \\mathrm{Re}_m  \\text{if } \\mathrm{Re}_m \\le 2300 \\\\ 0.0791 \\mathrm{Re}_m^{-0.25}  \\text{if } \\mathrm{Re}_m > 2300 \\end{cases}\n    $$\n5.  **混合物密度 $\\rho_m(z)$**：使用HEM定义计算：\n    $$\n    \\rho_m(x(z)) = \\left(\\frac{x(z)}{\\rho_g} + \\frac{1-x(z)}{\\rho_\\ell}\\right)^{-1}\n    $$\n由于被积函数 $\\frac{dP_f}{dz}$ 是一个关于 $z$ 的复杂的非线性函数，$\\Delta P_f$ 的积分必须进行数值计算。实现将使用SciPy库中的标准数值积分算法来执行此积分。\n\n每个测试案例的计算过程如下：\n- 首先，为特定案例定义积分热通量的解析函数 $\\int_0^z q''(z') dz'$。\n- 其次，为 $x(z)$ 创建一个函数，该函数实现此积分以及在 $x=1$ 处的截断。\n- 第三，计算 $x_{out} = x(L)$，然后计算 $\\Delta P_a$。\n- 第四，定义封装了上述逻辑的被积函数 $\\frac{dP_f}{dz}$，并将其从 $z=0$到 $z=L$进行数值积分以求得 $\\Delta P_f$。\n- 最后，将结果 $[x_{out}, \\Delta P_a, \\Delta P_f]$ 进行汇总和四舍五入。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the two-phase flow pressure drop problem for four specified cases.\n    \"\"\"\n    \n    # Constant saturated fluid properties\n    PROPS = {\n        'rho_l': 700.0,      # kg/m^3\n        'rho_g': 35.0,       # kg/m^3\n        'mu_l': 1.0e-4,      # Pa.s\n        'mu_g': 1.2e-5,      # Pa.s\n        'h_fg': 1.2e6,       # J/kg\n    }\n    \n    # Test case parameters\n    test_cases = [\n        {\n            'case_id': 1, 'L': 3.0, 'Dh': 0.012, 'G': 900.0,\n            'q_type': 'constant', 'q_params': [2.5e5]\n        },\n        {\n            'case_id': 2, 'L': 4.0, 'Dh': 0.010, 'G': 600.0,\n            'q_type': 'constant', 'q_params': [6.0e5]\n        },\n        {\n            'case_id': 3, 'L': 2.0, 'Dh': 0.015, 'G': 1000.0,\n            'q_type': 'constant', 'q_params': [0.0]\n        },\n        {\n            'case_id': 4, 'L': 3.5, 'Dh': 0.011, 'G': 1100.0,\n            'q_type': 'sinusoidal', 'q_params': [3.0e5, 0.2]\n        },\n    ]\n\n    results = []\n\n    for params in test_cases:\n        result = compute_case_pressure_drop(params, PROPS)\n        results.append(result)\n    \n    # Format the final output string as a list of lists.\n    # str(list) automatically creates the '[...]' formatting.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_case_pressure_drop(params, props):\n    \"\"\"\n    Computes [x_out, Delta_Pa, Delta_Pf] for a single case.\n    \"\"\"\n    L, Dh, G = params['L'], params['Dh'], params['G']\n    q_type, q_params = params['q_type'], params['q_params']\n    \n    rho_l, rho_g = props['rho_l'], props['rho_g']\n    mu_l, mu_g = props['mu_l'], props['mu_g']\n    h_fg = props['h_fg']\n\n    # 1. Define function for integrated heat flux: integral_q(z) = integral from 0 to z of q''(z')dz'\n    if q_type == 'constant':\n        q0 = q_params[0]\n        def integrated_q_pp(z):\n            return q0 * z\n    elif q_type == 'sinusoidal':\n        q0, A = q_params\n        def integrated_q_pp(z):\n            return q0 * (z + A * L / np.pi * (1.0 - np.cos(np.pi * z / L)))\n\n    # 2. Define quality function x(z) with clipping\n    def quality(z):\n        if z == 0:\n            return 0.0\n        # Prevent division by zero if G or h_fg were zero.\n        if G == 0 or h_fg == 0:\n            return 0.0\n        x_unclipped = integrated_q_pp(z) / (G * h_fg)\n        return min(1.0, x_unclipped)\n\n    # 3. Calculate outlet quality\n    x_out = quality(L)\n\n    # 4. Calculate acceleration pressure drop\n    delta_Pa = G**2 * x_out * (1.0 / rho_g - 1.0 / rho_l)\n\n    # 5. Define helper functions for frictional pressure drop calculation\n    def rho_m(x):\n        return (x / rho_g + (1.0 - x) / rho_l)**-1.0\n    \n    def mu_m(x):\n        return x * mu_g + (1.0 - x) * mu_l\n\n    def fanning_friction_factor(Re_m):\n        if Re_m = 2300:\n            # Handle potential division by zero if Re_m is 0 (though G>0 implies Re_m>0)\n            return 16.0 / Re_m if Re_m > 0 else np.inf\n        else:\n            return 0.0791 * Re_m**-0.25\n\n    # 6. Define the integrand for frictional pressure drop\n    def dpf_dz_integrand(z):\n        x_z = quality(z)\n        if x_z  0: x_z = 0 # Safety for numerical stability at z=0\n\n        mu_m_z = mu_m(x_z)\n        \n        # G must be > 0 for Re_m to be meaningful.\n        Re_m_z = G * Dh / mu_m_z if mu_m_z > 0 else np.inf\n        \n        f_F_z = fanning_friction_factor(Re_m_z)\n        rho_m_z = rho_m(x_z)\n        \n        return (2.0 * f_F_z * G**2) / (Dh * rho_m_z)\n\n    # 7. Numerically integrate to find frictional pressure drop\n    # Set tolerance for better accuracy.\n    delta_Pf, _ = quad(dpf_dz_integrand, 0, L, epsabs=1e-9, epsrel=1e-9)\n\n    return [round(x_out, 6), round(delta_Pa, 6), round(delta_Pf, 6)]\n\nsolve()\n```"
        },
        {
            "introduction": "虽然简化模型常假设流体物性恒定，但在实际系统中，蒸汽密度等关键物性是压力的强函数。这种耦合效应使得压降方程变为隐式非线性方程，必须采用迭代方法求解。本练习将深入探讨这种耦合带来的数值挑战，要求你设计一个牛顿-拉弗森（Newton-Raphson）迭代算法来求解由此产生的隐式摩擦压降方程，掌握这种技术对于理解和开发先进的模拟程序至关重要。",
            "id": "4259243",
            "problem": "要求您为一个核反应堆通道中水平、稳态、绝热、一维两相控制容积内的摩擦压降，形式化并实现一个牛顿-拉夫逊（Newton–Raphson）求解器。目标是阐释为何两相摩擦因子和空泡份额的非线性封闭关系将未知压降与流体性质耦合在一起，从而需要迭代求解器，并设计一个牛顿-拉夫逊更新来计算该控制容积上的摩擦压降。\n\n从稳态、绝热、水平流动的一维积分动量平衡方程出发，该流动加速度可忽略，无外部体力，此方程可简化为壁面剪切力平衡流向动量损失的陈述。在将两相视为以相同速度运动并忽略加速度和高程项的均匀混合物模型下，控制容积上的摩擦压降可以写成达西-魏斯巴赫（Darcy–Weisbach）形式，用混合物性质和达西摩擦因子表示。令质量通量表示为 $G$，达西摩擦因子表示为 $f$。控制容积的长度为 $L$，水力直径为 $D$。摩擦压降则通过以下形式的方程与这些参数相关联\n$$\n\\Delta p \\;=\\; f\\;\\frac{L}{D}\\;\\frac{G^2}{2\\,\\rho_m},\n$$\n其中 $\\rho_m$ 表示混合物密度。混合物密度和粘度通过空泡份额模型进行封闭。令质量含气率为 $x$，空泡份额为 $\\alpha$，液体密度为 $\\rho_\\ell$，气体密度为 $\\rho_g$。在滑移比等于 $1$ 的均匀模型下，空泡份额为\n$$\n\\alpha \\;=\\; \\frac{1}{1 \\;+\\; \\frac{1-x}{x}\\;\\frac{\\rho_g}{\\rho_\\ell}},\n$$\n混合物密度为\n$$\n\\rho_m \\;=\\; \\alpha\\,\\rho_g \\;+\\; \\left(1-\\alpha\\right)\\,\\rho_\\ell.\n$$\n假设混合物粘度为体积分数加权\n$$\n\\mu_m \\;=\\; \\alpha\\,\\mu_g \\;+\\; \\left(1-\\alpha\\right)\\,\\mu_\\ell,\n$$\n其中相粘度 $\\mu_g$ 和 $\\mu_\\ell$ 在给定温度下取为常数。定义混合物雷诺数\n$$\n\\mathrm{Re}_m \\;=\\; \\frac{G\\,D}{\\mu_m}.\n$$\n摩擦因子取自一个连续可微、广泛使用的单相流关​​联式，该关联式覆盖了从层流到完全粗糙湍流的范围；使用 Churchill 关联式：\n$$\nf \\;=\\; 8\\;\\left[\\left(\\frac{8}{\\mathrm{Re}_m}\\right)^{12} \\;+\\; \\frac{1}{\\left(A \\;+\\; B\\right)^{3/2}}\\right]^{1/12},\n$$\n其中\n$$\nA \\;=\\; \\left\\{2.457\\,\\ln\\!\\left[\\left(\\frac{7}{\\mathrm{Re}_m}\\right)^{0.9} \\;+\\; 0.27\\,\\frac{\\varepsilon}{D}\\right]\\right\\}^{16},\\qquad\nB \\;=\\; \\left(\\frac{37530}{\\mathrm{Re}_m}\\right)^{16},\n$$\n其中 $\\varepsilon$ 是绝对粗糙度。气体密度在恒定温度 $T$ 下被建模为理想气体，使用水蒸气的比气体常数 $R_v$，并在控制容积上的平均压力下进行评估：\n$$\np_{\\mathrm{avg}} \\;=\\; p_{\\mathrm{in}} \\;-\\; \\frac{\\Delta p}{2},\\qquad \\rho_g \\;=\\; \\frac{p_{\\mathrm{avg}}}{R_v\\,T}.\n$$\n液体密度 $\\rho_\\ell$ 在给定温度下被视为常数（不可压缩近似）。\n\n$p_{\\mathrm{avg}}$ 在 $\\rho_g$ 中的存在，并因此在 $\\alpha$、$\\mu_m$、$\\mathrm{Re}_m$、$f$ 和 $\\rho_m$ 中的存在，使得摩擦压降方程对于 $\\Delta p$ 是非线性的。定义标量残差\n$$\n\\mathcal{F}(\\Delta p) \\;=\\; \\Delta p \\;-\\; f(\\Delta p)\\;\\frac{L}{D}\\;\\frac{G^2}{2\\,\\rho_m(\\Delta p)}.\n$$\n物理上允许的根满足 $\\mathcal{F}(\\Delta p^\\star)=0$ 且 $0  \\Delta p^\\star  p_{\\mathrm{in}}$。\n\n您的任务是：\n- 基于基本的稳态动量平衡和上述封闭关系，解释为何 $\\rho_g(\\Delta p)$ 的依赖性在 $\\mathcal{F}(\\Delta p)$ 中引入了非线性，从而需要迭代求解方法。\n- 为此标量方程设计一个牛顿-拉夫逊更新，即指定迭代\n$$\n\\Delta p^{(k+1)} \\;=\\; \\Delta p^{(k)} \\;-\\; \\frac{\\mathcal{F}\\!\\left(\\Delta p^{(k)}\\right)}{\\mathcal{F}'\\!\\left(\\Delta p^{(k)}\\right)},\n$$\n并讨论当显式解析导数计算繁琐时如何评估或近似 $\\mathcal{F}'$。您的算法应强制执行可行区间 $0  \\Delta p  \\eta\\,p_{\\mathrm{in}}$，其中 $\\eta$ 为某个固定的安全系数，满足 $0  \\eta  1$。\n\n实现要求：\n- 实现一个完整的程序，对下面测试套件中的每个测试用例，通过求解 $\\mathcal{F}(\\Delta p)=0$ 来计算摩擦压降 $\\Delta p$。求解方法采用带阻尼的牛顿-拉夫逊法，雅可比矩阵 $\\mathcal{F}'$ 可以使用解析形式或数值近似导数。如果您不解析推导 $\\mathcal{F}'$，请使用中心有限差分近似。\n- 在所有情况下使用以下常数和封闭关系：\n  - 理想气体蒸汽密度，$R_v = 461.5\\ \\mathrm{J/(kg\\cdot K)}$，即 $\\rho_g = p_{\\mathrm{avg}}/(R_v T)$。\n  - 如上所述的均匀空泡份额 $\\alpha$，滑移比等于 $1$。\n  - 混合物粘度 $\\mu_m = \\alpha\\,\\mu_g + (1-\\alpha)\\,\\mu_\\ell$。\n  - Churchill 摩擦因子，绝对粗糙度 $\\varepsilon$ 按各用例给定。\n- 收敛准则：当 $|\\mathcal{F}(\\Delta p)| \\le \\tau_{\\mathrm{abs}}$（其中 $\\tau_{\\mathrm{abs}} = 10^{-6}\\ \\mathrm{Pa}$）时，或当相对更新满足 $|\\Delta p^{(k+1)} - \\Delta p^{(k)}|/\\max(1,\\Delta p^{(k)}) \\le \\tau_{\\mathrm{rel}}$（其中 $\\tau_{\\mathrm{rel}} = 10^{-10}$）时终止。将迭代次数限制为 $N_{\\max} = 50$，并使用带有几何阻尼因子 $\\beta = 0.5$ 的回溯线搜索来维持 $0  \\Delta p  \\eta\\,p_{\\mathrm{in}}$ 并减小残差范数。使用 $\\eta = 0.9$。\n- 输出规范：对于每个测试用例，返回收敛的 $\\Delta p$，单位为帕斯卡（Pa），四舍五入到最近的整数。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\ldots\\right]$。\n\n测试套件（每个元组为 $\\left(L,\\ D,\\ \\varepsilon,\\ G,\\ x,\\ p_{\\mathrm{in}},\\ T,\\ \\mu_\\ell,\\ \\mu_g,\\ \\rho_\\ell\\right)$，单位为 $\\left(\\mathrm{m},\\ \\mathrm{m},\\ \\mathrm{m},\\ \\mathrm{kg/m^2/s},\\ \\text{无量纲},\\ \\mathrm{Pa},\\ \\mathrm{K},\\ \\mathrm{Pa\\cdot s},\\ \\mathrm{Pa\\cdot s},\\ \\mathrm{kg/m^3}\\right)$）：\n- 案例 $1$ (代表性的混合含气率、光滑通道)：$\\left(4.0,\\ 0.012,\\ 1.0\\times 10^{-5},\\ 800.0,\\ 0.2,\\ 4.0\\times 10^{6},\\ 550.0,\\ 1.2\\times 10^{-4},\\ 2.5\\times 10^{-5},\\ 750.0\\right)$。\n- 案例 $2$ (高含气率、中等质量通量)：$\\left(4.0,\\ 0.012,\\ 1.0\\times 10^{-5},\\ 600.0,\\ 0.8,\\ 4.0\\times 10^{6},\\ 550.0,\\ 1.2\\times 10^{-4},\\ 2.5\\times 10^{-5},\\ 750.0\\right)$。\n- 案例 $3$ (低质量通量、中等含气率、较短长度)：$\\left(2.0,\\ 0.012,\\ 1.0\\times 10^{-5},\\ 50.0,\\ 0.5,\\ 4.0\\times 10^{6},\\ 550.0,\\ 1.2\\times 10^{-4},\\ 2.5\\times 10^{-5},\\ 750.0\\right)$。\n- 案例 $4$ (高质量通量、较粗糙通道、较长长度、低含气率)：$\\left(10.0,\\ 0.012,\\ 1.0\\times 10^{-4},\\ 1000.0,\\ 0.1,\\ 4.0\\times 10^{6},\\ 550.0,\\ 1.2\\times 10^{-4},\\ 2.5\\times 10^{-5},\\ 750.0\\right)$。\n\n您的程序必须使用上述物理和数值规范计算所有案例的摩擦压降，并以精确格式 $\\left[\\cdot,\\cdot,\\cdot,\\cdot\\right]$ 打印一行四舍五入为整数的帕斯卡单位的结果。",
            "solution": "我们从轴向站之间控制容积的一维、稳态、水平、绝热积分动量平衡方程出发，该流动无外部体力，加速度可忽略。壁面剪切力平衡动量通量损失，从而得到单相流摩擦压降的经典达西-魏斯巴赫（Darcy–Weisbach）形式，\n$$\n\\Delta p \\;=\\; f\\,\\frac{L}{D}\\,\\frac{\\rho\\,u^2}{2}.\n$$\n引入质量通量 $G=\\rho\\,u$，使得 $u=G/\\rho$，我们将单相流表达式重写为\n$$\n\\Delta p \\;=\\; f\\,\\frac{L}{D}\\,\\frac{G^2}{2\\,\\rho}.\n$$\n对于滑移比等于1的均匀混合物模型下的两相流，各相被认为具有相同的速度，混合物性质 $\\rho_m$ 和 $\\mu_m$ 通过体积分数加权的封闭关系定义。相同的动量平衡结构得以保留，只需将 $\\rho$ 替换为 $\\rho_m$，并将摩擦因子 $f$ 在混合物雷诺数 $\\mathrm{Re}_m=G\\,D/\\mu_m$ 下求值。这给出了摩擦压降模型\n$$\n\\Delta p \\;=\\; f(\\mathrm{Re}_m,\\varepsilon/D)\\,\\frac{L}{D}\\,\\frac{G^2}{2\\,\\rho_m}.\n$$\n\n为了封闭 $\\rho_m$ 和 $\\mu_m$，我们引入空泡份额 $\\alpha$。对于均匀模型（滑移比等于1），$\\alpha$ 是质量含气率 $x$ 和相密度的函数，通过以下方式表示\n$$\n\\alpha \\;=\\; \\frac{1}{1 + \\frac{1-x}{x}\\,\\frac{\\rho_g}{\\rho_\\ell}}.\n$$\n混合物密度和粘度为\n$$\n\\rho_m \\;=\\; \\alpha\\,\\rho_g + (1-\\alpha)\\,\\rho_\\ell,\\qquad\n\\mu_m \\;=\\; \\alpha\\,\\mu_g + (1-\\alpha)\\,\\mu_\\ell.\n$$\n我们采用 Churchill 关​​联式作为达西摩擦因子的封闭关系，这是一个经过充分检验的关联式，对所有雷诺数和粗糙度都有效：\n$$\nf \\;=\\; 8\\;\\left[\\left(\\frac{8}{\\mathrm{Re}_m}\\right)^{12} \\;+\\; \\frac{1}{\\left(A \\;+\\; B\\right)^{3/2}}\\right]^{1/12},\n$$\n其中\n$$\nA \\;=\\; \\left\\{2.457\\,\\ln\\!\\left[\\left(\\frac{7}{\\mathrm{Re}_m}\\right)^{0.9} \\;+\\; 0.27\\,\\frac{\\varepsilon}{D}\\right]\\right\\}^{16},\\qquad\nB \\;=\\; \\left(\\frac{37530}{\\mathrm{Re}_m}\\right)^{16}.\n$$\n\n非线性源于蒸汽密度对平均压力的依赖性。令 $p_{\\mathrm{in}}$ 表示入口压力，$\\Delta p$ 表示控制容积上的摩擦压降。平均压力为 $p_{\\mathrm{avg}} = p_{\\mathrm{in}} - \\Delta p/2$。我们通过理想气体定律在固定温度 $T$ 下对蒸汽密度进行建模：\n$$\n\\rho_g(\\Delta p) \\;=\\; \\frac{p_{\\mathrm{avg}}}{R_v\\,T} \\;=\\; \\frac{p_{\\mathrm{in}} - \\Delta p/2}{R_v\\,T}.\n$$\n因此，$\\alpha(\\Delta p)$ 依赖于 $\\rho_g(\\Delta p)$，从而 $\\rho_m(\\Delta p)$ 和 $\\mu_m(\\Delta p)$ 依赖于 $\\Delta p$，$\\mathrm{Re}_m(\\Delta p)=G\\,D/\\mu_m(\\Delta p)$ 同样如此。通过 Churchill 关联式，$f(\\Delta p)$ 依赖于 $\\mathrm{Re}_m(\\Delta p)$。因此，摩擦压降方程成为关于 $\\Delta p$ 的一个隐式标量方程：\n$$\n\\mathcal{F}(\\Delta p) \\;=\\; \\Delta p \\;-\\; f(\\Delta p)\\,\\frac{L}{D}\\,\\frac{G^2}{2\\,\\rho_m(\\Delta p)} \\;=\\; 0.\n$$\n由于 $f$ 和 $\\rho_m$ 通过上述依赖链是 $\\Delta p$ 的函数，因此不存在 $\\Delta p$ 的显式闭合解，这使得必须使用如牛顿-拉夫逊法之类的迭代求解器。\n\n为了设计牛顿-拉夫逊更新，定义迭代序列\n$$\n\\Delta p^{(k+1)} \\;=\\; \\Delta p^{(k)} \\;-\\; \\frac{\\mathcal{F}\\!\\left(\\Delta p^{(k)}\\right)}{\\mathcal{F}'\\!\\left(\\Delta p^{(k)}\\right)}.\n$$\n导数 $\\mathcal{F}'$ 为\n$$\n\\mathcal{F}'(\\Delta p) \\;=\\; 1 \\;-\\; \\frac{L}{D}\\,\\frac{G^2}{2}\\,\\frac{d}{d\\,\\Delta p}\\left(\\frac{f(\\Delta p)}{\\rho_m(\\Delta p)}\\right).\n$$\n根据商法则和乘积法则，\n$$\n\\frac{d}{d\\,\\Delta p}\\left(\\frac{f}{\\rho_m}\\right) \\;=\\; \\frac{f'}{\\rho_m} \\;-\\; \\frac{f\\,\\rho_m'}{\\rho_m^2},\n$$\n其中 $f' = \\frac{d f}{d\\,\\Delta p}$ 且 $\\rho_m' = \\frac{d \\rho_m}{d\\,\\Delta p}$。导数 $f'$ 和 $\\rho_m'$ 可以通过链式法则展开。例如，\n$$\n\\rho_m' \\;=\\; \\alpha'\\,\\rho_g \\;+\\; \\alpha\\,\\rho_g' \\;-\\; \\alpha'\\,\\rho_\\ell,\n$$\n其中\n$$\n\\alpha' \\;=\\; \\frac{d\\alpha}{d\\rho_g}\\,\\rho_g',\\qquad \\rho_g' \\;=\\; \\frac{d}{d\\,\\Delta p}\\left(\\frac{p_{\\mathrm{in}} - \\Delta p/2}{R_v T}\\right) \\;=\\; -\\frac{1}{2\\,R_v\\,T}.\n$$\n类似地，$f'$ 通过链式法则依赖于 $\\mathrm{Re}_m'$。然而，由于 $f$ 对 $\\mathrm{Re}_m$ 和 $\\mu_m$ 的嵌套依赖，以及 $\\mu_m$ 对 $\\alpha$ 和 $\\rho_g$ 的嵌套依赖，$\\mathcal{F}'$ 的完整解析表达式在代数上变得非常繁琐。因此，一种稳健且标准的方法是用中心有限差分来近似 $\\mathcal{F}'$：\n$$\n\\mathcal{F}'(\\Delta p) \\;\\approx\\; \\frac{\\mathcal{F}(\\Delta p + h) - \\mathcal{F}(\\Delta p - h)}{2\\,h},\n$$\n其中 $h$ 是自适应选择的，例如 $h = \\max\\!\\left(h_{\\min}, \\epsilon\\,\\max(1,|\\Delta p|)\\right)$，其中 $h_{\\min}$ 和 $\\epsilon$ 是小常数，如 $h_{\\min}=10^{-3}\\ \\mathrm{Pa}$ 和 $\\epsilon=10^{-6}$，以平衡截断误差和舍入误差。\n\n为了确保物理上的可接受性和收敛的稳健性，我们将 $\\Delta p$ 约束在 $0  \\Delta p  \\eta\\,p_{\\mathrm{in}}$ 范围内，其中安全系数 $\\eta$（例如，$\\eta=0.9$），并使用几何阻尼因子 $\\beta$（例如，$\\beta=0.5$）执行回溯线搜索：如果一个完整的牛顿步长导致不可接受的 $\\Delta p$ 或未能减小 $|\\mathcal{F}|$，则通过连续乘以 $\\beta$ 来减小步长，直到步长可接受且结果有所改善。当绝对残差低于容差 $\\tau_{\\mathrm{abs}}$ 或相对更新低于 $\\tau_{\\mathrm{rel}}$，或在达到最大迭代次数 $N_{\\max}$ 后，迭代终止。\n\n每个测试用例的算法摘要：\n- 给定 $L$、$D$、$\\varepsilon$、$G$、$x$、$p_{\\mathrm{in}}$、$T$、$\\mu_\\ell$、$\\mu_g$、$\\rho_\\ell$，设置 $R_v=461.5\\ \\mathrm{J/(kg\\cdot K)}$、$\\eta=0.9$、$\\beta=0.5$、$\\tau_{\\mathrm{abs}}=10^{-6}\\ \\mathrm{Pa}$、$\\tau_{\\mathrm{rel}}=10^{-10}$、$N_{\\max}=50$。\n- 定义 $\\rho_g(\\Delta p)=\\left(p_{\\mathrm{in}}-\\Delta p/2\\right)/(R_v T)$、$\\alpha(\\Delta p)=1/\\left[1+\\frac{1-x}{x}\\frac{\\rho_g(\\Delta p)}{\\rho_\\ell}\\right]$、$\\mu_m(\\Delta p)=\\alpha(\\Delta p)\\mu_g+\\left[1-\\alpha(\\Delta p)\\right]\\mu_\\ell$、$\\mathrm{Re}_m(\\Delta p)=G D/\\mu_m(\\Delta p)$、$f(\\Delta p)$（通过 Churchill 公式）、$\\rho_m(\\Delta p)=\\alpha(\\Delta p)\\rho_g(\\Delta p)+\\left[1-\\alpha(\\Delta p)\\right]\\rho_\\ell$ 以及残差 $\\mathcal{F}(\\Delta p)=\\Delta p - f(\\Delta p)\\frac{L}{D}\\frac{G^2}{2\\rho_m(\\Delta p)}$。\n- 通过在 $p_{\\mathrm{avg}}=p_{\\mathrm{in}}$ (即 $\\Delta p=0$) 处评估 $f$ 和 $\\rho_m$ 来初始化 $\\Delta p^{(0)}$，并计算 $\\Delta p^{(0)}=f\\frac{L}{D}\\frac{G^2}{2\\rho_m}$，然后将其限制在 $(0,\\eta\\,p_{\\mathrm{in}})$ 范围内。\n- 对于迭代 $k=0,1,\\ldots$：\n  - 计算 $\\mathcal{F}(\\Delta p^{(k)})$ 并通过自适应步长 $h$ 的中心有限差分近似 $\\mathcal{F}'(\\Delta p^{(k)})$。\n  - 形成牛顿步长 $s = -\\mathcal{F}/\\mathcal{F}'$。\n  - 回溯：设置步长乘子 $\\lambda=1$，当 $\\Delta p^{(k)}+\\lambda s$ 不在 $(0,\\eta\\,p_{\\mathrm{in}})$ 范围内或 $|\\mathcal{F}(\\Delta p^{(k)}+\\lambda s)| \\ge |\\mathcal{F}(\\Delta p^{(k)})|$ 时，设置 $\\lambda \\leftarrow \\beta\\,\\lambda$；接受 $\\Delta p^{(k+1)}=\\Delta p^{(k)}+\\lambda s$。\n  - 检查收敛性：如果 $|\\mathcal{F}(\\Delta p^{(k+1)})| \\le \\tau_{\\mathrm{abs}}$ 或 $|\\Delta p^{(k+1)}-\\Delta p^{(k)}|/\\max(1,|\\Delta p^{(k)}|) \\le \\tau_{\\mathrm{rel}}$，则停止并返回 $\\Delta p^{(k+1)}$。\n- 报告收敛的 $\\Delta p$，单位为帕斯卡，四舍五入到最近的整数。\n\n所提供的程序实现了此算法，并为指定的测试套件计算结果，以所需的确切列表格式打印单行输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Constants\nR_V = 461.5  # J/(kg*K), specific gas constant for water vapor\n\ndef churchill_f(Re, eps, D):\n    \"\"\"\n    Compute Darcy friction factor using Churchill (1977) correlation.\n    Valid across all Re and roughness.\n    \"\"\"\n    Re = max(Re, 1e-12)  # avoid divide by zero / negative\n    A = (2.457 * np.log((7.0 / Re) ** 0.9 + 0.27 * (eps / D))) ** 16.0\n    B = (37530.0 / Re) ** 16.0\n    f = 8.0 * ((8.0 / Re) ** 12.0 + 1.0 / ((A + B) ** 1.5)) ** (1.0 / 12.0)\n    return f\n\ndef mixture_properties(dp, params):\n    \"\"\"\n    Given current pressure drop dp, return mixture properties:\n    rho_g, alpha, mu_m, Re_m, f, rho_m\n    \"\"\"\n    L, D, eps, G, x, p_in, T, mu_l, mu_g, rho_l = params\n    p_avg = p_in - 0.5 * dp\n    # Enforce positive average pressure\n    p_avg = max(p_avg, 1.0)  # Pa, avoid zero/negative density\n    rho_g = p_avg / (R_V * T)\n    # Homogeneous void fraction\n    # Prevent division by zero for x close to 0 or 1\n    x_clamped = min(max(x, 1e-9), 1.0 - 1e-9)\n    alpha = 1.0 / (1.0 + (1.0 - x_clamped) / x_clamped * (rho_g / rho_l))\n    # Mixture viscosity (volume-fraction-weighted)\n    mu_m = alpha * mu_g + (1.0 - alpha) * mu_l\n    mu_m = max(mu_m, 1e-12)\n    # Mixture Reynolds\n    Re_m = G * D / mu_m\n    # Friction factor\n    f = churchill_f(Re_m, eps, D)\n    # Mixture density\n    rho_m = alpha * rho_g + (1.0 - alpha) * rho_l\n    rho_m = max(rho_m, 1e-12)\n    return rho_g, alpha, mu_m, Re_m, f, rho_m\n\ndef residual(dp, params):\n    \"\"\"\n    Residual F(dp) = dp - f(dp) * (L/D) * G^2/(2 rho_m(dp))\n    \"\"\"\n    L, D, eps, G, x, p_in, T, mu_l, mu_g, rho_l = params\n    _, _, _, _, f, rho_m = mixture_properties(dp, params)\n    model_dp = f * (L / D) * (G ** 2) / (2.0 * rho_m)\n    return dp - model_dp\n\ndef newton_solve(params, eta=0.9, beta=0.5, tol_abs=1e-6, tol_rel=1e-10, max_iter=50):\n    \"\"\"\n    Solve F(dp)=0 with damped Newton-Raphson and central finite-difference derivative.\n    Enforce 0  dp  eta * p_in.\n    \"\"\"\n    L, D, eps, G, x, p_in, T, mu_l, mu_g, rho_l = params\n\n    # Initial guess: evaluate at dp=0 (i.e., p_avg ~ p_in)\n    _, _, _, _, f0, rho_m0 = mixture_properties(0.0, params)\n    dp0 = f0 * (L / D) * (G ** 2) / (2.0 * rho_m0)\n    # Clamp initial guess\n    dp = min(max(dp0, 1e-12), eta * p_in * 0.9)\n\n    # Newton iterations\n    for _ in range(max_iter):\n        F = residual(dp, params)\n        if abs(F) = tol_abs:\n            return dp\n        # Central finite-difference derivative\n        h = max(1e-3, 1e-6 * max(1.0, abs(dp)))\n        F_plus = residual(dp + h, params)\n        F_minus = residual(dp - h, params)\n        dF = (F_plus - F_minus) / (2.0 * h)\n        # Guard against tiny derivative\n        if dF == 0.0 or not np.isfinite(dF):\n            dF = 1e-12\n        step = -F / dF\n\n        # Backtracking line search to enforce admissible interval and reduce |F|\n        lam = 1.0\n        dp_new = dp + lam * step\n        # Target admissible interval\n        dp_min = 1e-12\n        dp_max = eta * p_in\n        # Precompute current |F|\n        F_abs = abs(F)\n        # Backtrack\n        attempts = 0\n        while (dp_new = dp_min or dp_new >= dp_max) or not np.isfinite(dp_new) or abs(residual(dp_new, params)) >= F_abs:\n            lam *= beta\n            attempts += 1\n            if lam  1e-12 or attempts > 50:\n                # Fall back to bisection-like safe step to mid-interval around current dp\n                dp_new = min(max(0.5 * (dp + min(max(dp, dp_min), dp_max)), dp_min), dp_max)\n                break\n            dp_new = dp + lam * step\n\n        # Check relative update\n        if abs(dp_new - dp) / max(1.0, abs(dp)) = tol_rel:\n            dp = dp_new\n            return dp\n        dp = dp_new\n\n    return dp  # Return best effort if not converged\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (L, D, eps, G, x, p_in, T, mu_l, mu_g, rho_l)\n    test_cases = [\n        (4.0, 0.012, 1.0e-5, 800.0, 0.2, 4.0e6, 550.0, 1.2e-4, 2.5e-5, 750.0),\n        (4.0, 0.012, 1.0e-5, 600.0, 0.8, 4.0e6, 550.0, 1.2e-4, 2.5e-5, 750.0),\n        (2.0, 0.012, 1.0e-5, 50.0, 0.5, 4.0e6, 550.0, 1.2e-4, 2.5e-5, 750.0),\n        (10.0, 0.012, 1.0e-4, 1000.0, 0.1, 4.0e6, 550.0, 1.2e-4, 2.5e-5, 750.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        dp = newton_solve(params)\n        # Round to nearest integer Pa as per problem statement\n        dp_int = int(np.rint(dp))\n        results.append(dp_int)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}