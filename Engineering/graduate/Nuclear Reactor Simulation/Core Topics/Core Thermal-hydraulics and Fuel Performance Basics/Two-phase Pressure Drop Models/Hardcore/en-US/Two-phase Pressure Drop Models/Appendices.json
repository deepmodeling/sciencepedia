{
    "hands_on_practices": [
        {
            "introduction": "This first practice guides you through a foundational derivation of the accelerational pressure drop, a critical but often misunderstood component in boiling flows. By applying the Homogeneous Equilibrium Model (HEM) to a heated pipe, you will see from first principles how phase change and the resulting decrease in mixture density cause the flow to accelerate, contributing significantly to the total pressure drop . This exercise builds a strong conceptual and analytical base for understanding the momentum balance in two-phase systems.",
            "id": "4259268",
            "problem": "A vertical, uniformly heated, constant-area circular pipe of length $L = 4.0\\,\\mathrm{m}$ carries saturated water undergoing two-phase boiling at a nearly uniform saturation pressure such that the liquid and vapor densities may be treated as constants equal to $\\rho_{\\ell} = 700\\,\\mathrm{kg/m^3}$ and $\\rho_{g} = 35\\,\\mathrm{kg/m^3}$, respectively. The mass flux is uniform and equal to $G = 1.50 \\times 10^{3}\\,\\mathrm{kg/(m^2\\,s)}$. The inlet quality at $z=0$ is $x(0) = 0.05$, and the axial quality profile is given by\n$$\nx(z) = 0.05 + 0.20\\,\\frac{z}{L} + 0.05\\,\\frac{z}{L}\\left(1 - \\frac{z}{L}\\right), \\quad 0 \\le z \\le L.\n$$\nModel the flow using the Homogeneous Equilibrium Model (HEM) with slip ratio $S=1$ and thermal/mechanical equilibrium. Under HEM, the mixture specific volume is $v_{m}(x) = \\frac{1}{\\rho_{m}(x)} = \\frac{x}{\\rho_{g}} + \\frac{1-x}{\\rho_{\\ell}}$, and the mixture velocity is $V_{m}(z) = G\\,v_{m}(x(z))$. Neglect wall friction and gravitational contributions and compute only the accelerational component of the pressure drop.\n\nStarting from a one-dimensional steady momentum balance for a differential control volume of the pipe and the HEM mixture description, derive an expression for the accelerational pressure drop across the length and evaluate it for the given data.\n\nExpress your final answer in $\\mathrm{kPa}$ and round to $4$ significant figures.",
            "solution": "The analysis begins with the one-dimensional, steady-state momentum balance for a differential control volume of a constant-area pipe. The general equation for the total pressure gradient is the sum of three components: frictional, gravitational, and accelerational.\n$$\n\\left(-\\frac{dP}{dz}\\right)_{total} = \\left(-\\frac{dP}{dz}\\right)_{fric} + \\left(-\\frac{dP}{dz}\\right)_{grav} + \\left(-\\frac{dP}{dz}\\right)_{accel}\n$$\nThe problem statement explicitly requires neglecting the wall friction and gravitational contributions. Therefore, we only consider the accelerational component.\n$$\n-\\frac{dP}{dz} = \\left(-\\frac{dP}{dz}\\right)_{accel}\n$$\nThe accelerational pressure gradient is caused by the change in the axial momentum flux of the fluid. For a control volume with cross-sectional area $A$ and length $dz$, the net force due to pressure is equal to the rate of change of momentum flux. The momentum flux is given by $(\\text{mass flow rate}) \\times (\\text{velocity})$, which is $(\\dot{m})(V_m)$. The momentum flux per unit area is $(\\dot{m}/A)V_m = G V_m$. The change in momentum flux over the length $dz$ is $d(A G V_m)$.\nThe momentum balance is:\n$$\nPA - (P+dP)A = d(\\dot{m}V_m) = d(G A V_m)\n$$\nSince the mass flux $G$ and the area $A$ are constant, this simplifies to:\n$$\n-A dP = A G dV_m\n$$\nDividing by $A dz$, we obtain the expression for the accelerational pressure gradient:\n$$\n-\\frac{dP}{dz} = G \\frac{dV_m}{dz}\n$$\nThe problem specifies the use of the Homogeneous Equilibrium Model (HEM). In this model, the two phases are assumed to travel at the same velocity, i.e., the slip ratio $S=1$. The mixture velocity $V_m$ is related to the constant mass flux $G$ and the mixture specific volume $v_m(z)$ by $V_m(z) = G v_m(z)$. The mixture specific volume is a function of the local quality $x(z)$ and the constant liquid and vapor specific volumes ($v_\\ell = 1/\\rho_\\ell$, $v_g = 1/\\rho_g$):\n$$\nv_m(x) = x v_g + (1-x) v_\\ell = x \\frac{1}{\\rho_g} + (1-x) \\frac{1}{\\rho_\\ell}\n$$\nWe can rearrange this as:\n$$\nv_m(x) = \\frac{1}{\\rho_\\ell} + x \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell}\\right)\n$$\nSubstituting $V_m(z) = G v_m(x(z))$ into the pressure gradient equation:\n$$\n-\\frac{dP}{dz} = G \\frac{d}{dz}\\left[ G \\left(\\frac{1}{\\rho_\\ell} + x(z) \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell}\\right)\\right) \\right]\n$$\nSince $G$, $\\rho_\\ell$, and $\\rho_g$ are constants, the derivative applies only to the quality $x(z)$:\n$$\n-\\frac{dP}{dz} = G^2 \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell}\\right) \\frac{dx}{dz}\n$$\nTo find the total accelerational pressure drop, $\\Delta P_{accel} = P_{in} - P_{out} = P(0) - P(L)$, we integrate this expression over the length of the pipe from $z=0$ to $z=L$:\n$$\n\\Delta P_{accel} = \\int_{0}^{L} \\left(-\\frac{dP}{dz}\\right) dz = \\int_{0}^{L} G^2 \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell}\\right) \\frac{dx}{dz} dz\n$$\nSince $G$, $\\rho_g$, and $\\rho_\\ell$ are constant, we can take them out of the integral:\n$$\n\\Delta P_{accel} = G^2 \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell}\\right) \\int_{0}^{L} \\frac{dx}{dz} dz\n$$\nBy the fundamental theorem of calculus, the integral of the derivative $dx/dz$ is simply the change in $x$ over the interval:\n$$\n\\int_{0}^{L} \\frac{dx}{dz} dz = x(L) - x(0)\n$$\nThus, the final expression for the accelerational pressure drop is:\n$$\n\\Delta P_{accel} = G^2 [x(L) - x(0)] \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell}\\right)\n$$\nThis result shows that for the HEM model with constant fluid properties, the accelerational pressure drop depends only on the change in quality between the inlet and outlet, not on the specific axial quality profile.\n\nWe now evaluate this expression using the given data.\nThe givens are:\n$G = 1.50 \\times 10^{3}\\,\\mathrm{kg/(m^2\\,s)}$\n$\\rho_\\ell = 700\\,\\mathrm{kg/m^3}$\n$\\rho_g = 35\\,\\mathrm{kg/m^3}$\n$L = 4.0\\,\\mathrm{m}$\nThe inlet quality is $x(0) = 0.05$.\nThe outlet quality $x(L)$ is found by evaluating the given quality profile at $z=L$:\n$$\nx(L) = 0.05 + 0.20\\,\\frac{L}{L} + 0.05\\,\\frac{L}{L}\\left(1 - \\frac{L}{L}\\right) = 0.05 + 0.20 \\times 1 + 0.05 \\times 1 \\times (1-1) = 0.25\n$$\nThe change in quality is $x(L) - x(0) = 0.25 - 0.05 = 0.20$.\n\nNow, we substitute the numerical values into the derived formula:\n$$\n\\Delta P_{accel} = (1.50 \\times 10^{3})^2 [0.25 - 0.05] \\left(\\frac{1}{35} - \\frac{1}{700}\\right)\n$$\nFirst, calculate the terms:\n$G^2 = (1.50 \\times 10^{3})^2 = 2.25 \\times 10^6 \\, (\\mathrm{kg/(m^2 s)})^2$\n$x(L) - x(0) = 0.20$\n$\\frac{1}{\\rho_g} - \\frac{1}{\\rho_\\ell} = \\frac{1}{35} - \\frac{1}{700} = \\frac{20}{700} - \\frac{1}{700} = \\frac{19}{700} \\, \\mathrm{m^3/kg}$\nSubstituting these into the equation for $\\Delta P_{accel}$:\n$$\n\\Delta P_{accel} = (2.25 \\times 10^6) \\times (0.20) \\times \\left(\\frac{19}{700}\\right)\n$$\n$$\n\\Delta P_{accel} = (0.45 \\times 10^6) \\times \\left(\\frac{19}{700}\\right) = \\frac{0.45 \\times 19 \\times 10^6}{700} = \\frac{8.55 \\times 10^6}{700} = \\frac{8.55}{7} \\times 10^4\n$$\n$$\n\\Delta P_{accel} \\approx 1.22142857 \\times 10^4 \\, \\mathrm{Pa}\n$$\nThe unit is $\\mathrm{Pa}$ since $(\\mathrm{kg/(m^2 s)})^2 \\times (\\mathrm{m^3/kg}) = (\\mathrm{kg}^2 / (\\mathrm{m}^4 \\mathrm{s}^2)) \\times (\\mathrm{m}^3/\\mathrm{kg}) = \\mathrm{kg}/(\\mathrm{m} \\mathrm{s}^2) = \\mathrm{N/m^2} = \\mathrm{Pa}$.\nThe problem asks for the answer in kilopascals ($\\mathrm{kPa}$).\n$$\n\\Delta P_{accel} = 12.2142857 \\, \\mathrm{kPa}\n$$\nRounding to $4$ significant figures, we get:\n$$\n\\Delta P_{accel} \\approx 12.21 \\, \\mathrm{kPa}\n$$",
            "answer": "$$\\boxed{12.21}$$"
        },
        {
            "introduction": "Building on the analytical derivation of the accelerational pressure drop, this exercise demonstrates its practical importance in the context of experimental analysis. You will quantify the significant error that arises when the acceleration term is neglected in interpreting pressure drop data from a heated test section, a common pitfall in post-processing . This practice highlights why a complete momentum balance is essential for accurately attributing pressure losses to friction versus acceleration, which is crucial for developing and validating friction models.",
            "id": "4259263",
            "problem": "A short, horizontal, uniformly heated test section is used to generate benchmark data for two-phase pressure drop in a nuclear thermal–hydraulics loop. The inlet is saturated liquid and the outlet has a prescribed thermodynamic quality. The measurement provides the total axial pressure drop across the heated section. An analyst post-processes the data under the Homogeneous Equilibrium Model (HEM), which assumes one common velocity for both phases and local thermodynamic equilibrium.\n\nStarting from the one-dimensional, steady, constant-area momentum balance for a variable-density mixture and the definition of mixture specific volume, derive from first principles an expression for the axial acceleration contribution to the pressure drop, $\\Delta P_{a}$, over the heated length. Use this to explain qualitatively why neglecting $\\Delta P_{a}$ leads to a bias in the inferred “frictional” pressure drop when the heated length is short and horizontal.\n\nThen, for a specific short heated test section operated under the following conditions:\n- Inlet quality $x_{\\text{in}} = 0$ and outlet quality $x_{\\text{out}} = 0.20$.\n- Mass flux $G = 1500\\ \\text{kg}\\ \\text{m}^{-2}\\ \\text{s}^{-1}$.\n- Saturated liquid density $\\rho_{\\ell} = 760\\ \\text{kg}\\ \\text{m}^{-3}$ and saturated vapor density $\\rho_{g} = 38\\ \\text{kg}\\ \\text{m}^{-3}$ (so that $\\rho_{\\ell}/\\rho_{g} = 20$).\n- The heated section is horizontal so that gravitational head is negligible, and the measured total pressure drop across the section is $\\Delta P_{\\text{tot}} = 18.00\\ \\text{kPa}$.\n\nCompute the fraction of the measured total pressure drop that would be erroneously attributed to “friction” if the acceleration component were neglected, defined as\n$$\nf_{\\text{err}} \\equiv \\frac{\\Delta P_{a}}{\\Delta P_{\\text{tot}}}.\n$$\n\nRound your final numerical answer for $f_{\\text{err}}$ to four significant figures. Express the final answer as a decimal number with no units.",
            "solution": "The appropriate starting point is the one-dimensional, steady, constant-area momentum balance for a single control volume of the two-phase mixture. For a cross-sectional area $A$ that is constant in the axial coordinate $z$, and mixture mean properties, the axial momentum balance can be written as\n$$\n\\frac{dP}{dz} + \\frac{d}{dz}\\left(\\frac{G^{2}}{\\rho_{m}}\\right) + \\frac{4\\tau_{w}}{D} + \\rho_{m} g \\sin\\theta = 0,\n$$\nwhere $P$ is the pressure, $G$ is the mass flux, $\\rho_{m}$ is the mixture density, $\\tau_{w}$ is the wall shear stress, $D$ is the hydraulic diameter, $g$ is the gravitational acceleration, and $\\theta$ is the inclination angle measured from horizontal. This form results from writing the axial momentum balance in differential form with constant $A$, using $G \\equiv \\rho_{m} u_{m}$ with $u_{m}$ the mixture mean velocity, and collecting the streamwise variation of momentum flux into $d(G^{2}/\\rho_{m})/dz$.\n\nRearranging the above equation, the total axial pressure gradient decomposes into contributions from acceleration, wall friction, and gravity:\n$$\n\\frac{dP}{dz} = -\\underbrace{\\frac{d}{dz}\\left(\\frac{G^{2}}{\\rho_{m}}\\right)}_{\\text{acceleration}} - \\underbrace{\\frac{4\\tau_{w}}{D}}_{\\text{friction}} - \\underbrace{\\rho_{m} g \\sin\\theta}_{\\text{gravity}}.\n$$\nUpon integrating over the heated length from inlet to outlet, the acceleration contribution to the pressure drop is\n$$\n\\Delta P_{a} \\equiv \\int_{\\text{in}}^{\\text{out}} \\left[-\\frac{d}{dz}\\left(\\frac{G^{2}}{\\rho_{m}}\\right)\\right] dz = G^{2}\\left(\\frac{1}{\\rho_{m,\\text{out}}} - \\frac{1}{\\rho_{m,\\text{in}}}\\right),\n$$\nwhere the mass flux $G$ is constant along $z$ for a constant-area duct without crossflow.\n\nUnder the Homogeneous Equilibrium Model (HEM), the phases share a common velocity and are in local thermodynamic equilibrium, so the mixture specific volume is the mass-fraction-weighted sum of phase specific volumes. With quality $x$ defined as the mass fraction of vapor, the mixture specific volume $v_{m}$ and density $\\rho_{m}$ satisfy\n$$\nv_{m} \\equiv \\frac{1}{\\rho_{m}} = \\frac{x}{\\rho_{g}} + \\frac{1 - x}{\\rho_{\\ell}}.\n$$\nTherefore, for $x_{in}=0$,\n$$\n\\Delta P_{a} = G^{2}\\left[v_{m,\\text{out}} - v_{m,\\text{in}}\\right] = G^{2}\\left(\\frac{x_{\\text{out}}}{\\rho_{g}} + \\frac{1 - x_{\\text{out}}}{\\rho_{\\ell}} - \\frac{1}{\\rho_{\\ell}}\\right) = G^{2}\\, x_{\\text{out}} \\left(\\frac{1}{\\rho_{g}} - \\frac{1}{\\rho_{\\ell}}\\right).\n$$\nThe sign is positive because $v_{m}$ increases in the direction of flow when vapor is generated, which requires a pressure decrease to accelerate the mixture; by convention, $\\Delta P_{a} > 0$ contributes to the overall pressure drop.\n\nIn a short, horizontal section, the gravitational term is negligible, and the wall friction term can be modest. If one neglects $\\Delta P_{a}$ in interpreting a measured total pressure drop $\\Delta P_{\\text{tot}}$, then one would incorrectly attribute $\\Delta P_{a}$ to “friction.” The fractional bias in the inferred “frictional” component is thus\n$$\nf_{\\text{err}} \\equiv \\frac{\\Delta P_{a}}{\\Delta P_{\\text{tot}}}.\n$$\n\nNumerical evaluation for the given conditions:\n- Given $x_{\\text{in}} = 0$, $x_{\\text{out}} = 0.20$, $G = 1500\\ \\text{kg}\\ \\text{m}^{-2}\\ \\text{s}^{-1}$, $\\rho_{\\ell} = 760\\ \\text{kg}\\ \\text{m}^{-3}$, $\\rho_{g} = 38\\ \\text{kg}\\ \\text{m}^{-3}$.\n- Compute the specific volume difference:\n$$\n\\frac{1}{\\rho_{g}} - \\frac{1}{\\rho_{\\ell}} = \\frac{1}{38\\ \\text{kg}\\ \\text{m}^{-3}} - \\frac{1}{760\\ \\text{kg}\\ \\text{m}^{-3}} = 0.026315789\\ \\text{m}^{3}\\ \\text{kg}^{-1} - 0.001315789\\ \\text{m}^{3}\\ \\text{kg}^{-1} = 0.025\\ \\text{m}^{3}\\ \\text{kg}^{-1}.\n$$\n- Compute the acceleration pressure drop:\n$$\n\\Delta P_{a} = \\left(1500\\ \\text{kg}\\ \\text{m}^{-2}\\ \\text{s}^{-1}\\right)^{2}\\,\\left(0.20\\right)\\,\\left(0.025\\ \\text{m}^{3}\\ \\text{kg}^{-1}\\right) = 2.25\\times 10^{6}\\ \\text{kg}^{2}\\ \\text{m}^{-4}\\ \\text{s}^{-2} \\times 0.005\\ \\text{m}^{3}\\ \\text{kg}^{-1} = 11250\\ \\text{Pa}.\n$$\n- With the measured total pressure drop $\\Delta P_{\\text{tot}} = 18.00\\ \\text{kPa} = 18000\\ \\text{Pa}$, the fractional bias is\n$$\nf_{\\text{err}} = \\frac{11250\\ \\text{Pa}}{18000\\ \\text{Pa}} = 0.625.\n$$\n\nRounding to four significant figures, the requested fraction is $0.6250$.",
            "answer": "$$\\boxed{0.6250}$$"
        },
        {
            "introduction": "This final practice advances from simplified analytical models to the more realistic challenges encountered in simulation codes, where fluid properties are themselves functions of the local pressure. You will confront this nonlinearity by designing and implementing a Newton-Raphson iterative solver to determine the frictional pressure drop when vapor density is pressure-dependent . This exercise provides essential hands-on experience with the numerical methods that are indispensable for solving the coupled, nonlinear equations governing real-world two-phase flow systems.",
            "id": "4259243",
            "problem": "You are asked to formalize and implement a Newton–Raphson solver for the frictional pressure drop in a horizontal, steady, adiabatic, one-dimensional two-phase control volume in a nuclear reactor channel. The objective is to demonstrate why nonlinear closures for the two-phase friction factor and void fraction couple the unknown pressure drop to fluid properties, necessitating an iterative solver, and to design a Newton–Raphson update to compute the frictional pressure drop across the control volume.\n\nStart from the one-dimensional integral momentum balance for steady, adiabatic, horizontal flow with negligible acceleration and no external body forces, which reduces to the statement that the wall shear force balances the streamwise momentum loss. Under a homogeneous-mixture model that treats the two phases as moving at the same speed and neglects acceleration and elevation terms, the frictional pressure drop across a control volume can be written in a Darcy–Weisbach form in terms of the mixture properties and a Darcy friction factor. Let the mass flux be denoted by $G$ and the Darcy friction factor by $f$. The control volume has length $L$ and hydraulic diameter $D$. The frictional pressure drop is then related to these parameters by an equation of the form\n$$\n\\Delta P \\;=\\; f\\;\\frac{L}{D}\\;\\frac{G^2}{2\\,\\rho_m},\n$$\nwhere $\\rho_m$ denotes the mixture density. The mixture density and viscosity are closed by a void fraction model. Let the mass quality be $x$, the void fraction be $\\alpha$, the liquid density be $\\rho_\\ell$, and the gas density be $\\rho_g$. Under the homogeneous model with slip ratio equal to $1$, the void fraction is\n$$\n\\alpha \\;=\\; \\frac{1}{1 \\;+\\; \\frac{1-x}{x}\\;\\frac{\\rho_g}{\\rho_\\ell}},\n$$\nand the mixture density is\n$$\n\\rho_m \\;=\\; \\alpha\\,\\rho_g \\;+\\; \\left(1-\\alpha\\right)\\,\\rho_\\ell.\n$$\nAssume a volume-fraction-weighted mixture viscosity\n$$\n\\mu_m \\;=\\; \\alpha\\,\\mu_g \\;+\\; \\left(1-\\alpha\\right)\\,\\mu_\\ell,\n$$\nwith phase viscosities $\\mu_g$ and $\\mu_\\ell$ taken as constants at the given temperature. Define the mixture Reynolds number\n$$\n\\mathrm{Re}_m \\;=\\; \\frac{G\\,D}{\\mu_m}.\n$$\nThe friction factor is taken from a continuously differentiable, widely used single-phase correlation that covers laminar to fully rough turbulent regimes; use the Churchill correlation:\n$$\nf \\;=\\; 8\\;\\left[\\left(\\frac{8}{\\mathrm{Re}_m}\\right)^{12} \\;+\\; \\frac{1}{\\left(A \\;+\\; B\\right)^{3/2}}\\right]^{1/12},\n$$\nwith\n$$\nA \\;=\\; \\left\\{2.457\\,\\ln\\!\\left[\\left(\\frac{7}{\\mathrm{Re}_m}\\right)^{0.9} \\;+\\; 0.27\\,\\frac{\\varepsilon}{D}\\right]\\right\\}^{16},\\qquad\nB \\;=\\; \\left(\\frac{37530}{\\mathrm{Re}_m}\\right)^{16},\n$$\nwhere $\\varepsilon$ is the absolute roughness. The gas density is modeled as an ideal gas at a constant temperature $T$, using the specific gas constant for water vapor $R_v$, and evaluated at the mean pressure across the control volume:\n$$\nP_{\\mathrm{avg}} \\;=\\; P_{\\mathrm{in}} \\;-\\; \\frac{\\Delta P}{2},\\qquad \\rho_g \\;=\\; \\frac{P_{\\mathrm{avg}}}{R_v\\,T}.\n$$\nThe liquid density $\\rho_\\ell$ is taken as a constant (incompressible approximation) at the given temperature.\n\nThe presence of $P_{\\mathrm{avg}}$ in $\\rho_g$, and hence in $\\alpha$, $\\mu_m$, $\\mathrm{Re}_m$, $f$, and $\\rho_m$, renders the frictional pressure drop equation nonlinear in $\\Delta P$. Define the scalar residual\n$$\n\\mathcal{F}(\\Delta P) \\;=\\; \\Delta P \\;-\\; f(\\Delta P)\\;\\frac{L}{D}\\;\\frac{G^2}{2\\,\\rho_m(\\Delta P)}.\n$$\nThe physically admissible root satisfies $\\mathcal{F}(\\Delta P^\\star)=0$ with $0  \\Delta P^\\star  P_{\\mathrm{in}}$.\n\nYour tasks are:\n- From the fundamental steady momentum balance and the above closures, explain why the dependence $\\rho_g(\\Delta P)$ induces nonlinearity in $\\mathcal{F}(\\Delta P)$, thus necessitating an iterative solution method.\n- Design a Newton–Raphson update for this scalar equation, i.e., specify the iteration\n$$\n\\Delta P^{(k+1)} \\;=\\; \\Delta P^{(k)} \\;-\\; \\frac{\\mathcal{F}\\!\\left(\\Delta P^{(k)}\\right)}{\\mathcal{F}'\\!\\left(\\Delta P^{(k)}\\right)},\n$$\nand discuss how to evaluate or approximate $\\mathcal{F}'$ when an explicit analytic derivative is cumbersome. Your algorithm should enforce the admissible interval $0  \\Delta P  \\eta\\,P_{\\mathrm{in}}$ for some fixed safety factor $\\eta$ with $0  \\eta  1$.\n\nImplementation requirements:\n- Implement a complete program that, for each test case in the suite below, computes the frictional pressure drop $\\Delta P$ by solving $\\mathcal{F}(\\Delta P)=0$ with a damped Newton–Raphson method using either an analytic Jacobian $\\mathcal{F}'$ or a numerically approximated derivative. Use a central finite-difference approximation to $\\mathcal{F}'$ if you do not derive it analytically.\n- Use the following constants and closures in all cases:\n  - Ideal-gas vapor density with $R_v = 461.5\\ \\mathrm{J/(kg\\cdot K)}$, i.e., $\\rho_g = P_{\\mathrm{avg}}/(R_v T)$.\n  - Homogeneous void fraction $\\alpha$ as above, slip ratio equal to $1$.\n  - Mixture viscosity $\\mu_m = \\alpha\\,\\mu_g + (1-\\alpha)\\,\\mu_\\ell$.\n  - Churchill friction factor with absolute roughness $\\varepsilon$ as given per case.\n- Convergence criteria: terminate when $\\left|\\mathcal{F}(\\Delta P)\\right| \\le \\tau_{\\mathrm{abs}}$ with $\\tau_{\\mathrm{abs}} = 10^{-6}\\ \\mathrm{Pa}$ or when the relative update satisfies $\\left|\\Delta P^{(k+1)} - \\Delta P^{(k)}\\right|/\\max(1,\\Delta P^{(k)}) \\le \\tau_{\\mathrm{rel}}$ with $\\tau_{\\mathrm{rel}} = 10^{-10}$. Limit the iteration count to $N_{\\max} = 50$ and use a backtracking line search with geometric damping factor $\\beta = 0.5$ to maintain $0  \\Delta P  \\eta\\,P_{\\mathrm{in}}$ and to reduce the residual norm. Use $\\eta = 0.9$.\n- Output specification: For each test case, return the converged $\\Delta P$ expressed in pascals, rounded to the nearest integer. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, e.g., $\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\ldots\\right]$.\n\nTest suite (each tuple is $\\left(L,\\ D,\\ \\varepsilon,\\ G,\\ x,\\ P_{\\mathrm{in}},\\ T,\\ \\mu_\\ell,\\ \\mu_g,\\ \\rho_\\ell\\right)$ with units $\\left(\\mathrm{m},\\ \\mathrm{m},\\ \\mathrm{m},\\ \\mathrm{kg/m^2/s},\\ \\text{dimensionless},\\ \\mathrm{Pa},\\ \\mathrm{K},\\ \\mathrm{Pa\\cdot s},\\ \\mathrm{Pa\\cdot s},\\ \\mathrm{kg/m^3}\\right)$):\n- Case $1$ (representative mixed-quality, smooth channel): $\\left(4.0,\\ 0.012,\\ 1.0\\times 10^{-5},\\ 800.0,\\ 0.2,\\ 4.0\\times 10^{6},\\ 550.0,\\ 1.2\\times 10^{-4},\\ 2.5\\times 10^{-5},\\ 750.0\\right)$.\n- Case $2$ (high quality, moderate mass flux): $\\left(4.0,\\ 0.012,\\ 1.0\\times 10^{-5},\\ 600.0,\\ 0.8,\\ 4.0\\times 10^{6},\\ 550.0,\\ 1.2\\times 10^{-4},\\ 2.5\\times 10^{-5},\\ 750.0\\right)$.\n- Case $3$ (low mass flux, mid quality, shorter length): $\\left(2.0,\\ 0.012,\\ 1.0\\times 10^{-5},\\ 50.0,\\ 0.5,\\ 4.0\\times 10^{6},\\ 550.0,\\ 1.2\\times 10^{-4},\\ 2.5\\times 10^{-5},\\ 750.0\\right)$.\n- Case $4$ (high mass flux, rougher channel, longer length, low quality): $\\left(10.0,\\ 0.012,\\ 1.0\\times 10^{-4},\\ 1000.0,\\ 0.1,\\ 4.0\\times 10^{6},\\ 550.0,\\ 1.2\\times 10^{-4},\\ 2.5\\times 10^{-5},\\ 750.0\\right)$.\n\nYour program must compute the frictional pressure drops for all cases using the above physical and numerical specifications and print a single line with the rounded integer results in pascals in the exact format $\\left[\\cdot,\\cdot,\\cdot,\\cdot\\right]$.",
            "solution": "We begin from the one-dimensional steady, horizontal, adiabatic integral momentum balance for a control volume between axial stations with no external body forces and negligible acceleration. The wall shear force balances the momentum flux loss, yielding the classical Darcy–Weisbach form for frictional pressure drop for a single-phase flow,\n$$\n\\Delta P \\;=\\; f\\,\\frac{L}{D}\\,\\frac{\\rho\\,u^2}{2}.\n$$\nIntroducing the mass flux $G=\\rho\\,u$ so that $u=G/\\rho$, we rewrite the single-phase expression as\n$$\n\\Delta P \\;=\\; f\\,\\frac{L}{D}\\,\\frac{G^2}{2\\,\\rho}.\n$$\nFor two-phase flow under the homogeneous-mixture model with slip ratio equal to $1$, the phases are taken to have the same velocity, and the mixture properties $\\rho_m$ and $\\mu_m$ are defined through volume-fraction-weighted closures. The same momentum balance structure carries over with the replacement of $\\rho$ by $\\rho_m$ and the friction factor $f$ evaluated at the mixture Reynolds number $\\mathrm{Re}_m=G\\,D/\\mu_m$. This gives the frictional pressure drop model\n$$\n\\Delta P \\;=\\; f(\\mathrm{Re}_m,\\varepsilon/D)\\,\\frac{L}{D}\\,\\frac{G^2}{2\\,\\rho_m}.\n$$\n\nTo close $\\rho_m$ and $\\mu_m$, we introduce the void fraction $\\alpha$, which for the homogeneous model (slip ratio equal to $1$) is a function of mass quality $x$ and phase densities through\n$$\n\\alpha \\;=\\; \\frac{1}{1 + \\frac{1-x}{x}\\,\\frac{\\rho_g}{\\rho_\\ell}}.\n$$\nThe mixture density and viscosity are\n$$\n\\rho_m \\;=\\; \\alpha\\,\\rho_g + (1-\\alpha)\\,\\rho_\\ell,\\qquad\n\\mu_m \\;=\\; \\alpha\\,\\mu_g + (1-\\alpha)\\,\\mu_\\ell.\n$$\nWe adopt the Churchill correlation for the Darcy friction factor as a well-tested closure valid for all Reynolds numbers and roughness:\n$$\nf \\;=\\; 8\\;\\left[\\left(\\frac{8}{\\mathrm{Re}_m}\\right)^{12} \\;+\\; \\frac{1}{\\left(A \\;+\\; B\\right)^{3/2}}\\right]^{1/12},\n$$\nwith\n$$\nA \\;=\\; \\left\\{2.457\\,\\ln\\!\\left[\\left(\\frac{7}{\\mathrm{Re}_m}\\right)^{0.9} \\;+\\; 0.27\\,\\frac{\\varepsilon}{D}\\right]\\right\\}^{16},\\qquad\nB \\;=\\; \\left(\\frac{37530}{\\mathrm{Re}_m}\\right)^{16}.\n$$\n\nThe nonlinearity arises through the dependence of the vapor density on the mean pressure. Let $P_{\\mathrm{in}}$ denote the inlet pressure and $\\Delta P$ the frictional drop across the control volume. The mean pressure is $P_{\\mathrm{avg}} = P_{\\mathrm{in}} - \\Delta P/2$. We model the vapor density via the ideal gas law at a fixed temperature $T$:\n$$\n\\rho_g(\\Delta P) \\;=\\; \\frac{P_{\\mathrm{avg}}}{R_v\\,T} \\;=\\; \\frac{P_{\\mathrm{in}} - \\Delta P/2}{R_v\\,T}.\n$$\nConsequently, $\\alpha(\\Delta P)$ depends on $\\rho_g(\\Delta P)$, hence $\\rho_m(\\Delta P)$ and $\\mu_m(\\Delta P)$ depend on $\\Delta P$, as does $\\mathrm{Re}_m(\\Delta P)=G\\,D/\\mu_m(\\Delta P)$. Through the Churchill correlation, $f(\\Delta P)$ depends on $\\mathrm{Re}_m(\\Delta P)$. Therefore, the frictional pressure drop equation becomes an implicit scalar equation for $\\Delta P$:\n$$\n\\mathcal{F}(\\Delta P) \\;=\\; \\Delta P \\;-\\; f(\\Delta P)\\,\\frac{L}{D}\\,\\frac{G^2}{2\\,\\rho_m(\\Delta P)} \\;=\\; 0.\n$$\nBecause $f$ and $\\rho_m$ are functions of $\\Delta P$ via the chain of dependencies above, an explicit, closed-form solution for $\\Delta P$ is not available, which necessitates an iterative solver such as the Newton–Raphson method.\n\nTo design the Newton–Raphson update, define the iterative sequence\n$$\n\\Delta P^{(k+1)} \\;=\\; \\Delta P^{(k)} \\;-\\; \\frac{\\mathcal{F}\\!\\left(\\Delta P^{(k)}\\right)}{\\mathcal{F}'\\!\\left(\\Delta P^{(k)}\\right)}.\n$$\nThe derivative $\\mathcal{F}'$ is\n$$\n\\mathcal{F}'(\\Delta P) \\;=\\; 1 \\;-\\; \\frac{L}{D}\\,\\frac{G^2}{2}\\,\\frac{d}{d\\,\\Delta P}\\left(\\frac{f(\\Delta P)}{\\rho_m(\\Delta P)}\\right).\n$$\nBy the quotient and product rules,\n$$\n\\frac{d}{d\\,\\Delta P}\\left(\\frac{f}{\\rho_m}\\right) \\;=\\; \\frac{f'}{\\rho_m} \\;-\\; \\frac{f\\,\\rho_m'}{\\rho_m^2},\n$$\nwhere $f' = \\frac{d f}{d\\,\\Delta P}$ and $\\rho_m' = \\frac{d \\rho_m}{d\\,\\Delta P}$. The derivatives $f'$ and $\\rho_m'$ can be expanded via the chain rule. For example,\n$$\n\\rho_m' \\;=\\; \\alpha'\\,\\rho_g \\;+\\; \\alpha\\,\\rho_g' \\;-\\; \\alpha'\\,\\rho_\\ell,\n$$\nwith\n$$\n\\alpha' \\;=\\; \\frac{d\\alpha}{d\\rho_g}\\,\\rho_g',\\qquad \\rho_g' \\;=\\; \\frac{d}{d\\,\\Delta P}\\left(\\frac{P_{\\mathrm{in}} - \\Delta P/2}{R_v T}\\right) \\;=\\; -\\frac{1}{2\\,R_v\\,T}.\n$$\nSimilarly, $f'$ depends on $\\mathrm{Re}_m'$ via the chain rule. However, the full analytic expression for $\\mathcal{F}'$ becomes algebraically cumbersome due to the nested dependencies of $f$ on $\\mathrm{Re}_m$ and $\\mu_m$, and of $\\mu_m$ on $\\alpha$ and $\\rho_g$. A robust and standard approach is therefore to approximate $\\mathcal{F}'$ with a central finite difference:\n$$\n\\mathcal{F}'(\\Delta P) \\;\\approx\\; \\frac{\\mathcal{F}(\\Delta P + h) - \\mathcal{F}(\\Delta P - h)}{2\\,h},\n$$\nwhere $h$ is chosen adaptively, for example $h = \\max\\!\\left(h_{\\min}, \\epsilon\\,\\max(1,|\\Delta P|)\\right)$, with small constants $h_{\\min}$ and $\\epsilon$ such as $h_{\\min}=10^{-3}\\ \\mathrm{Pa}$ and $\\epsilon=10^{-6}$, to balance truncation and round-off errors.\n\nTo ensure physical admissibility and convergence robustness, we constrain $\\Delta P$ to $0  \\Delta P  \\eta\\,P_{\\mathrm{in}}$ with a safety factor $\\eta$ (e.g., $\\eta=0.9$), and perform backtracking line search with geometric damping factor $\\beta$ (e.g., $\\beta=0.5$): if a full Newton step yields an inadmissible $\\Delta P$ or does not reduce $|\\mathcal{F}|$, reduce the step by successive multiplication by $\\beta$ until admissible and improving. The iteration terminates when the absolute residual is below a tolerance $\\tau_{\\mathrm{abs}}$ or the relative update is below $\\tau_{\\mathrm{rel}}$, or after a maximum number of iterations $N_{\\max}$.\n\nAlgorithm summary for each test case:\n- Given $L$, $D$, $\\varepsilon$, $G$, $x$, $P_{\\mathrm{in}}$, $T$, $\\mu_\\ell$, $\\mu_g$, $\\rho_\\ell$, set $R_v=461.5\\ \\mathrm{J/(kg\\cdot K)}$, $\\eta=0.9$, $\\beta=0.5$, $\\tau_{\\mathrm{abs}}=10^{-6}\\ \\mathrm{Pa}$, $\\tau_{\\mathrm{rel}}=10^{-10}$, $N_{\\max}=50$.\n- Define $\\rho_g(\\Delta P)=\\left(P_{\\mathrm{in}}-\\Delta P/2\\right)/(R_v T)$, $\\alpha(\\Delta P)=1/\\left[1+\\frac{1-x}{x}\\frac{\\rho_g(\\Delta P)}{\\rho_\\ell}\\right]$, $\\mu_m(\\Delta P)=\\alpha(\\Delta P)\\mu_g+\\left[1-\\alpha(\\Delta P)\\right]\\mu_\\ell$, $\\mathrm{Re}_m(\\Delta P)=G D/\\mu_m(\\Delta P)$, $f(\\Delta P)$ via Churchill formula, $\\rho_m(\\Delta P)=\\alpha(\\Delta P)\\rho_g(\\Delta P)+\\left[1-\\alpha(\\Delta P)\\right]\\rho_\\ell$, and residual $\\mathcal{F}(\\Delta P)=\\Delta P - f(\\Delta P)\\frac{L}{D}\\frac{G^2}{2\\rho_m(\\Delta P)}$.\n- Initialize $\\Delta P^{(0)}$ by evaluating $f$ and $\\rho_m$ at $P_{\\mathrm{avg}}=P_{\\mathrm{in}}$ (i.e., $\\Delta P=0$) and computing $\\Delta P^{(0)}=f\\frac{L}{D}\\frac{G^2}{2\\rho_m}$, then clamp to $(0,\\eta\\,P_{\\mathrm{in}})$.\n- For iterations $k=0,1,\\ldots$:\n  - Compute $\\mathcal{F}(\\Delta P^{(k)})$ and approximate $\\mathcal{F}'(\\Delta P^{(k)})$ by central finite differences with adaptive $h$.\n  - Form the Newton step $s = -\\mathcal{F}/\\mathcal{F}'$.\n  - Backtrack: set step multiplier $\\lambda=1$, and while $\\Delta P^{(k)}+\\lambda s$ is not in $(0,\\eta\\,P_{\\mathrm{in}})$ or $|\\mathcal{F}(\\Delta P^{(k)}+\\lambda s)| \\ge |\\mathcal{F}(\\Delta P^{(k)})|$, set $\\lambda \\leftarrow \\beta\\,\\lambda$; accept $\\Delta P^{(k+1)}=\\Delta P^{(k)}+\\lambda s$.\n  - Check convergence: if $|\\mathcal{F}(\\Delta P^{(k+1)})| \\le \\tau_{\\mathrm{abs}}$ or $|\\Delta P^{(k+1)}-\\Delta P^{(k)}|/\\max(1,|\\Delta P^{(k)}|) \\le \\tau_{\\mathrm{rel}}$, stop and return $\\Delta P^{(k+1)}$.\n- Report the converged $\\Delta P$ rounded to the nearest integer in pascals.\n\nThe provided program implements this algorithm and computes results for the specified test suite, printing a single line in the exact list format required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Constants\nR_V = 461.5  # J/(kg*K), specific gas constant for water vapor\n\ndef churchill_f(Re, eps, D):\n    \"\"\"\n    Compute Darcy friction factor using Churchill (1977) correlation.\n    Valid across all Re and roughness.\n    \"\"\"\n    Re = max(Re, 1e-12)  # avoid divide by zero / negative\n    A = (2.457 * np.log((7.0 / Re) ** 0.9 + 0.27 * (eps / D))) ** 16.0\n    B = (37530.0 / Re) ** 16.0\n    f = 8.0 * ((8.0 / Re) ** 12.0 + 1.0 / ((A + B) ** 1.5)) ** (1.0 / 12.0)\n    return f\n\ndef mixture_properties(dp, params):\n    \"\"\"\n    Given current pressure drop dp, return mixture properties:\n    rho_g, alpha, mu_m, Re_m, f, rho_m\n    \"\"\"\n    L, D, eps, G, x, p_in, T, mu_l, mu_g, rho_l = params\n    p_avg = p_in - 0.5 * dp\n    # Enforce positive average pressure\n    p_avg = max(p_avg, 1.0)  # Pa, avoid zero/negative density\n    rho_g = p_avg / (R_V * T)\n    # Homogeneous void fraction\n    # Prevent division by zero for x close to 0 or 1\n    x_clamped = min(max(x, 1e-9), 1.0 - 1e-9)\n    alpha = 1.0 / (1.0 + (1.0 - x_clamped) / x_clamped * (rho_g / rho_l))\n    # Mixture viscosity (volume-fraction-weighted)\n    mu_m = alpha * mu_g + (1.0 - alpha) * mu_l\n    mu_m = max(mu_m, 1e-12)\n    # Mixture Reynolds\n    Re_m = G * D / mu_m\n    # Friction factor\n    f = churchill_f(Re_m, eps, D)\n    # Mixture density\n    rho_m = alpha * rho_g + (1.0 - alpha) * rho_l\n    rho_m = max(rho_m, 1e-12)\n    return rho_g, alpha, mu_m, Re_m, f, rho_m\n\ndef residual(dp, params):\n    \"\"\"\n    Residual F(dp) = dp - f(dp) * (L/D) * G^2/(2 rho_m(dp))\n    \"\"\"\n    L, D, eps, G, x, p_in, T, mu_l, mu_g, rho_l = params\n    _, _, _, _, f, rho_m = mixture_properties(dp, params)\n    model_dp = f * (L / D) * (G ** 2) / (2.0 * rho_m)\n    return dp - model_dp\n\ndef newton_solve(params, eta=0.9, beta=0.5, tol_abs=1e-6, tol_rel=1e-10, max_iter=50):\n    \"\"\"\n    Solve F(dp)=0 with damped Newton-Raphson and central finite-difference derivative.\n    Enforce 0  dp  eta * p_in.\n    \"\"\"\n    L, D, eps, G, x, p_in, T, mu_l, mu_g, rho_l = params\n\n    # Initial guess: evaluate at dp=0 (i.e., p_avg ~ p_in)\n    _, _, _, _, f0, rho_m0 = mixture_properties(0.0, params)\n    dp0 = f0 * (L / D) * (G ** 2) / (2.0 * rho_m0)\n    # Clamp initial guess\n    dp = min(max(dp0, 1e-12), eta * p_in * 0.9)\n\n    # Newton iterations\n    for _ in range(max_iter):\n        F = residual(dp, params)\n        if abs(F) = tol_abs:\n            return dp\n        # Central finite-difference derivative\n        h = max(1e-3, 1e-6 * max(1.0, abs(dp)))\n        F_plus = residual(dp + h, params)\n        F_minus = residual(dp - h, params)\n        dF = (F_plus - F_minus) / (2.0 * h)\n        # Guard against tiny derivative\n        if dF == 0.0 or not np.isfinite(dF):\n            dF = 1e-12\n        step = -F / dF\n\n        # Backtracking line search to enforce admissible interval and reduce |F|\n        lam = 1.0\n        dp_new = dp + lam * step\n        # Target admissible interval\n        dp_min = 1e-12\n        dp_max = eta * p_in\n        # Precompute current |F|\n        F_abs = abs(F)\n        # Backtrack\n        attempts = 0\n        while (dp_new = dp_min or dp_new = dp_max) or not np.isfinite(dp_new) or abs(residual(dp_new, params)) = F_abs:\n            lam *= beta\n            attempts += 1\n            if lam  1e-12 or attempts  50:\n                # Fall back to bisection-like safe step to mid-interval around current dp\n                dp_new = min(max(0.5 * (dp + min(max(dp, dp_min), dp_max)), dp_min), dp_max)\n                break\n            dp_new = dp + lam * step\n\n        # Check relative update\n        if abs(dp_new - dp) / max(1.0, abs(dp)) = tol_rel:\n            dp = dp_new\n            return dp\n        dp = dp_new\n\n    return dp  # Return best effort if not converged\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (L, D, eps, G, x, p_in, T, mu_l, mu_g, rho_l)\n    test_cases = [\n        (4.0, 0.012, 1.0e-5, 800.0, 0.2, 4.0e6, 550.0, 1.2e-4, 2.5e-5, 750.0),\n        (4.0, 0.012, 1.0e-5, 600.0, 0.8, 4.0e6, 550.0, 1.2e-4, 2.5e-5, 750.0),\n        (2.0, 0.012, 1.0e-5, 50.0, 0.5, 4.0e6, 550.0, 1.2e-4, 2.5e-5, 750.0),\n        (10.0, 0.012, 1.0e-4, 1000.0, 0.1, 4.0e6, 550.0, 1.2e-4, 2.5e-5, 750.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        dp = newton_solve(params)\n        # Round to nearest integer Pa as per problem statement\n        dp_int = int(np.rint(dp))\n        results.append(dp_int)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}