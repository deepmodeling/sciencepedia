{
    "hands_on_practices": [
        {
            "introduction": "Before solving complex transport equations, a critical skill for a simulation engineer is to determine which physical phenomena are dominant and which can be safely neglected. This practice introduces the powerful technique of scaling analysis to compare advective heat transport with axial heat conduction, leading to the definition of the PÃ©clet number, $Pe$ . By working through this problem, you will establish from first principles the criterion under which axial conduction is negligible, a cornerstone assumption in the analysis of most reactor coolant channels.",
            "id": "4249898",
            "problem": "A vertical coolant channel in a Pressurized Water Reactor (PWR) of uniform cross section and hydraulic diameter much smaller than its length conveys single-phase, subcooled light water upward. Let the axial coordinate be $z$ along the channel of length $L = 4.00\\ \\mathrm{m}$, and let the bulk temperature be the cross-section-averaged value $T_{b}(z)$. The coolant properties at operating conditions ($300^{\\circ}\\mathrm{C}$, $15\\ \\mathrm{MPa}$) may be taken as constant: density $\\rho = 710\\ \\mathrm{kg/m^3}$, isobaric specific heat $c_{p} = 5.1 \\times 10^{3}\\ \\mathrm{J/(kg\\cdot K)}$, and thermal conductivity $k = 0.67\\ \\mathrm{W/(m\\cdot K)}$. Assume a steady, incompressible flow with negligible viscous dissipation and no axial variation in cross-sectional area.\n\nStarting from the differential statement of energy conservation for a Newtonian fluid and specializing to one-dimensional axial transport, use physically consistent scaling to compare the magnitude of axial conduction $k\\,d^{2}T_{b}/dz^{2}$ to advective enthalpy transport $\\rho c_{p} u\\,dT_{b}/dz$. Identify the dimensionless group that quantifies this comparison, known as the Peclet number ($Pe$), and from first principles establish a criterion under which axial conduction may be neglected in reactor coolant analysis.\n\nFinally, imposing the requirement that axial conduction contribute no more than a fraction $\\varepsilon = 0.01$ of the advective term in magnitude at the scale of axial variation $L$, determine the minimum mean coolant speed $u_{\\min}$ that satisfies this criterion for the channel described. Express your final answer for $u_{\\min}$ in $\\mathrm{m/s}$ and round to four significant figures.",
            "solution": "The problem requires a first-principles derivation and scaling analysis to establish a criterion for neglecting axial heat conduction in a reactor coolant channel, followed by a calculation of the minimum coolant speed that satisfies a specific quantitative version of this criterion.\n\nThe analysis begins with the differential statement of energy conservation. For an incompressible fluid with constant properties, under steady-state conditions, the energy equation is:\n$$\n\\rho c_{p} (\\mathbf{u} \\cdot \\nabla T) = \\nabla \\cdot (k \\nabla T) + \\Phi_{v} + S\n$$\nwhere $\\rho$ is the density, $c_{p}$ is the isobaric specific heat, $\\mathbf{u}$ is the velocity field, $T$ is the temperature, $k$ is the thermal conductivity, $\\Phi_{v}$ is the viscous dissipation term, and $S$ is a volumetric heat source term.\n\nAccording to the problem statement, we make the following specializations:\n1.  The flow is one-dimensional in the axial direction $z$, so the velocity vector is $\\mathbf{u} = u \\mathbf{\\hat{k}}$, where $u$ is the mean coolant speed.\n2.  The temperature is the cross-section-averaged bulk temperature $T_{b}(z)$, which varies only with $z$.\n3.  Viscous dissipation is negligible, so $\\Phi_{v} = 0$.\n4.  The properties $\\rho$, $c_{p}$, and $k$ are constant.\n\nUnder these conditions, the operators simplify for the one-dimensional case:\n- Advection term: $\\mathbf{u} \\cdot \\nabla T \\rightarrow u \\frac{dT_{b}}{dz}$\n- Conduction term: $\\nabla \\cdot (k \\nabla T) \\rightarrow \\frac{d}{dz} \\left( k \\frac{dT_{b}}{dz} \\right) + \\text{radial terms}$. The problem specifically directs us to compare the axial component of conduction, which is $k \\frac{d^{2}T_{b}}{dz^{2}}$, to the advection term.\n\nThe one-dimensional steady-state energy balance on a differential fluid element of length $dz$ and cross-sectional area $A_{c}$ is:\n$$\n\\rho u A_{c} c_{p} \\frac{dT_{b}}{dz} dz = k A_{c} \\frac{d^{2}T_{b}}{dz^{2}} dz + q'' P dz\n$$\nwhere $q''$ is the heat flux from the channel wall and $P$ is the wetted perimeter. This can be written as:\n$$\n\\underbrace{\\rho c_{p} u \\frac{dT_{b}}{dz}}_{\\text{Advective Transport}} = \\underbrace{k \\frac{d^{2}T_{b}}{dz^{2}}}_{\\text{Axial Conduction}} + \\frac{q''P}{A_{c}}\n$$\nThe problem asks for a comparison of the magnitudes of the advective enthalpy transport term and the axial conduction term. Let us denote the advection term by $\\mathcal{A}$ and the axial conduction term by $\\mathcal{C}$.\n$$\n\\mathcal{A} = \\rho c_{p} u \\frac{dT_{b}}{dz}\n$$\n$$\n\\mathcal{C} = k \\frac{d^{2}T_{b}}{dz^{2}}\n$$\nTo compare their magnitudes, we perform a scaling analysis. We use the characteristic length scale of the system, the channel length $L$, to estimate the order of magnitude of the derivatives. Let $\\Delta T$ be the characteristic temperature change over the length $L$.\nThe first derivative scales as:\n$$\n\\frac{dT_{b}}{dz} \\sim \\frac{\\Delta T}{L}\n$$\nThe second derivative scales as:\n$$\n\\frac{d^{2}T_{b}}{dz^{2}} = \\frac{d}{dz}\\left(\\frac{dT_{b}}{dz}\\right) \\sim \\frac{\\Delta T/L}{L} = \\frac{\\Delta T}{L^{2}}\n$$\nSubstituting these scales into the expressions for $\\mathcal{A}$ and $\\mathcal{C}$:\n$$\n|\\mathcal{A}| \\sim \\rho c_{p} u \\frac{\\Delta T}{L}\n$$\n$$\n|\\mathcal{C}| \\sim k \\frac{\\Delta T}{L^{2}}\n$$\nThe ratio of the magnitude of axial conduction to advective transport is therefore:\n$$\n\\frac{|\\mathcal{C}|}{|\\mathcal{A}|} \\sim \\frac{k \\frac{\\Delta T}{L^{2}}}{\\rho c_{p} u \\frac{\\Delta T}{L}} = \\frac{k}{\\rho c_{p} u L}\n$$\nThis dimensionless ratio quantifies the relative importance of axial conduction. The Peclet number, $Pe$, is defined as the ratio of advective to diffusive (conduction) heat transport:\n$$\nPe = \\frac{\\text{Advective Transport}}{\\text{Diffusive Transport}} = \\frac{|\\mathcal{A}|}{|\\mathcal{C}|} \\sim \\frac{\\rho c_{p} u L}{k}\n$$\nThus, the ratio we derived is the inverse of the Peclet number, $1/Pe$.\nFrom first principles, axial conduction may be neglected if its contribution is significantly smaller than that of advection, i.e., $|\\mathcal{C}| \\ll |\\mathcal{A}|$. This translates to the criterion:\n$$\n\\frac{k}{\\rho c_{p} u L} \\ll 1 \\quad \\text{or} \\quad Pe \\gg 1\n$$\nThis establishes the general criterion for neglecting axial conduction in reactor coolant analysis.\n\nThe problem then imposes a specific quantitative requirement: the magnitude of the axial conduction term must be no more than a fraction $\\varepsilon = 0.01$ of the advective term.\n$$\n\\frac{|\\mathcal{C}|}{|\\mathcal{A}|} \\leq \\varepsilon\n$$\nUsing our scaling result, this condition becomes:\n$$\n\\frac{k}{\\rho c_{p} u L} \\leq \\varepsilon\n$$\nWe want to find the minimum mean coolant speed, $u_{\\min}$, that satisfies this criterion. The minimum speed corresponds to the equality:\n$$\n\\frac{k}{\\rho c_{p} u_{\\min} L} = \\varepsilon\n$$\nSolving for $u_{\\min}$:\n$$\nu_{\\min} = \\frac{k}{\\rho c_{p} L \\varepsilon}\n$$\nWe are given the following values:\n- Thermal conductivity, $k = 0.67\\ \\mathrm{W/(m\\cdot K)}$\n- Density, $\\rho = 710\\ \\mathrm{kg/m^3}$\n- Specific heat, $c_{p} = 5.1 \\times 10^{3}\\ \\mathrm{J/(kg\\cdot K)}$\n- Channel length, $L = 4.00\\ \\mathrm{m}$\n- Tolerance fraction, $\\varepsilon = 0.01$\n\nSubstituting these values into the expression for $u_{\\min}$:\n$$\nu_{\\min} = \\frac{0.67}{ (710) \\cdot (5.1 \\times 10^{3}) \\cdot (4.00) \\cdot (0.01) }\n$$\nFirst, we calculate the denominator:\n$$\n\\text{Denominator} = 710 \\times 5100 \\times 4.00 \\times 0.01 = 710 \\times 5100 \\times 0.04 = 144840\n$$\nThe units of the denominator are $(\\mathrm{kg/m^3}) \\cdot (\\mathrm{J/(kg\\cdot K)}) \\cdot (\\mathrm{m}) = \\mathrm{J/(m^2 \\cdot K)}$. Since $\\mathrm{W} = \\mathrm{J/s}$, the units of $k$ are $\\mathrm{J/(s \\cdot m \\cdot K)}$.\nThe units of $u_{\\min}$ are $\\frac{\\mathrm{J/(s \\cdot m \\cdot K)}}{\\mathrm{J/(m^2 \\cdot K)}} = \\frac{\\mathrm{J}}{\\mathrm{s \\cdot m \\cdot K}} \\cdot \\frac{\\mathrm{m^2 \\cdot K}}{\\mathrm{J}} = \\mathrm{m/s}$, which is correct.\n\nNow, we compute the numerical value:\n$$\nu_{\\min} = \\frac{0.67}{144840} \\approx 4.6258285 \\times 10^{-6}\\ \\mathrm{m/s}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nu_{\\min} \\approx 4.626 \\times 10^{-6}\\ \\mathrm{m/s}\n$$\nThis extremely low speed highlights that for any practical flow velocity in a reactor (typically several meters per second), the Peclet number is very large, and axial conduction is justifiably neglected in comparison to advection.",
            "answer": "$$\\boxed{4.626 \\times 10^{-6}}$$"
        },
        {
            "introduction": "Having established the conditions under which the energy equation can be simplified, we now apply this insight to derive a complete analytical solution for a fundamental heat transfer scenario. This exercise guides you through the first-principles derivation of the temperature distribution in a coolant channel experiencing fully developed laminar flow with constant wall heating . Mastering this classic solution provides a deep, quantitative understanding of the interplay between fluid velocity and the resulting temperature field, forming an essential baseline for analyzing more complex turbulent or two-phase flows.",
            "id": "4249941",
            "problem": "A straight circular coolant channel representative of a nuclear reactor subchannel has inner radius $R$ and length $L$, with a single-phase, incompressible, Newtonian coolant flowing steadily in the axial $z$-direction at mean speed $v_{m}$. The flow is laminar and fully developed hydrodynamically. The wall supplies a spatially uniform and axially uniform heat flux $q''$ into the fluid along a long heated section, and the fluid properties are constant: thermal conductivity $k$, density $\\rho$, and specific heat at constant pressure $c_{p}$. Axial conduction in the fluid and viscous dissipation are negligible. Using conservation of energy as the fundamental starting point, and cylindrical coordinates $(r,\\theta,z)$ under axisymmetry, do the following:\n\n1. Starting from the steady energy conservation for a Newtonian fluid and the stated assumptions, derive the thermal energy equation governing the temperature field $T(r,z)$ in the tube. Your derivation must explicitly justify all simplifications from the general conservation law to the reduced form applicable here.\n\n2. Under thermally fully developed conditions with constant wall heat flux $q''$, argue from first principles whether $\\partial T/\\partial z$ can depend on $r$, and obtain the appropriate axial temperature gradient $dT_{b}/dz$ of the bulk mean temperature $T_{b}(z)$ defined by\n$$\nT_{b}(z) \\equiv \\frac{\\int_{0}^{R} v_{z}(r)\\,T(r,z)\\,2\\pi r\\,dr}{\\int_{0}^{R} v_{z}(r)\\,2\\pi r\\,dr},\n$$\nwhere $v_{z}(r)$ is the axial velocity profile for fully developed laminar flow in a circular tube.\n\n3. Using the reduced thermal energy equation, the laminar velocity profile $v_{z}(r)$ that follows from fully developed Poiseuille flow, and the boundary conditions of constant wall heat flux $q''$ and symmetry at $r=0$, solve for the dimensionless temperature field\n$$\n\\theta(r) \\equiv \\frac{T_{w}(z) - T(r,z)}{T_{w}(z) - T_{b}(z)},\n$$\nwhere $T_{w}(z) \\equiv T(R,z)$ is the wall temperature. Express $\\theta(r)$ in closed form as a function of the dimensionless radius $r/R$.\n\nYour final answer must be a single closed-form analytic expression for $\\theta(r)$, with no units. If any intermediate numerical constants arise, keep them in exact fractional form in your derivation; no rounding is required for the final expression.",
            "solution": "We begin from the steady conservation of energy for a single-phase, incompressible, Newtonian fluid with constant properties and negligible volumetric heat generation, written for axisymmetric flow in cylindrical coordinates. The general steady energy equation (without viscous dissipation and with constant thermal conductivity) is\n$$\n\\rho c_{p} \\left( v_{r} \\frac{\\partial T}{\\partial r} + v_{\\theta} \\frac{\\partial T}{\\partial \\theta} + v_{z} \\frac{\\partial T}{\\partial z} \\right) = k \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial T}{\\partial r}\\right) + \\frac{1}{r^{2}} \\frac{\\partial^{2} T}{\\partial \\theta^{2}} + \\frac{\\partial^{2} T}{\\partial z^{2}} \\right].\n$$\nUnder axisymmetry, $\\partial T/\\partial \\theta = 0$ and $v_{\\theta} = 0$. For fully developed laminar flow in a circular tube, the radial velocity $v_{r}$ is zero and the axial velocity depends only on $r$, so $v_{z} = v_{z}(r)$ and is independent of $z$. The thermal Peclet number in typical reactor coolant channels is large, and for long heated lengths the axial conduction term $k\\,\\partial^{2} T/\\partial z^{2}$ is negligible relative to axial convection $\\rho c_{p} v_{z} \\partial T/\\partial z$; we explicitly invoke that assumption. With these simplifications, the energy equation reduces to\n$$\n\\rho c_{p}\\, v_{z}(r) \\frac{\\partial T}{\\partial z} = k\\, \\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{d T}{dr}\\right).\n$$\nThis is the governing thermal energy equation sought in step $1$.\n\nThe hydrodynamically fully developed laminar velocity profile in a circular tube (Poiseuille flow) is a well-tested result that follows from the balance of pressure gradient and viscous stresses:\n$$\nv_{z}(r) = 2 v_{m} \\left( 1 - \\left(\\frac{r}{R}\\right)^{2} \\right),\n$$\nwhere $v_{m}$ is the mean axial velocity. This result is used as foundational input for heat transfer in laminar internal flows.\n\nFor step $2$, we consider the nature of the thermally fully developed state under constant wall heat flux. In the thermally fully developed regime, the shape of the radial temperature distribution, when measured relative to an appropriate reference (commonly the bulk mean temperature), does not change with axial position. That is, the difference $T(r,z) - T_{b}(z)$ has an $r$-dependence that is independent of $z$. Equivalently,\n$$\n\\frac{\\partial}{\\partial z}\\left[ T(r,z) - T_{b}(z) \\right] = 0 \\quad \\Rightarrow \\quad \\frac{\\partial T}{\\partial z} = \\frac{d T_{b}}{d z} \\equiv G,\n$$\nwhere $G$ is a constant with respect to $r$ at fixed $z$ in the fully developed region. Physically, for a constant wall heat flux $q''$, the bulk mean temperature increases linearly with $z$ and the wall-to-bulk temperature difference becomes $z$-independent. An axial energy balance over a differential slice of length $dz$ gives the bulk temperature gradient,\n$$\n\\rho c_{p} v_{m} \\left( \\pi R^{2} \\right) \\frac{d T_{b}}{d z} = \\left( 2 \\pi R \\right) q'',\n$$\nwhich yields\n$$\n\\frac{d T_{b}}{d z} = \\frac{2 q''}{\\rho c_{p} v_{m} R}.\n$$\nTherefore, in the fully developed regime under the stated assumptions,\n$$\n\\frac{\\partial T}{\\partial z} = \\frac{d T_{b}}{d z} = \\frac{2 q''}{\\rho c_{p} v_{m} R} \\equiv G,\n$$\nand this axial gradient does not depend on $r$.\n\nFor step $3$, substitute $\\partial T/\\partial z = G$ into the reduced thermal energy equation:\n$$\n\\rho c_{p}\\, v_{z}(r)\\, G = k\\, \\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{d T}{dr}\\right).\n$$\nDefine the constant\n$$\nS \\equiv \\frac{\\rho c_{p} G\\, 2 v_{m}}{k} = \\frac{\\rho c_{p}}{k}\\left( \\frac{2 q''}{\\rho c_{p} v_{m} R} \\right) 2 v_{m} = \\frac{4 q''}{k R}.\n$$\nUsing $v_{z}(r) = 2 v_{m} \\left( 1 - (r/R)^{2} \\right)$, the equation becomes\n$$\n\\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{d T}{dr}\\right) = S \\left( 1 - \\left(\\frac{r}{R}\\right)^{2} \\right).\n$$\nIntegrate once with respect to $r$:\n$$\n\\frac{d}{dr}\\left(r \\frac{d T}{dr}\\right) = S \\left( r - \\frac{r^{3}}{R^{2}} \\right),\n$$\nwhich yields\n$$\nr \\frac{d T}{dr} = S \\left( \\frac{r^{2}}{2} - \\frac{r^{4}}{4 R^{2}} \\right) + C_{1}.\n$$\nRegularity at the axis $r=0$ requires $C_{1} = 0$ (to avoid a singular $C_{1}/r$ term in $dT/dr$). Thus,\n$$\n\\frac{d T}{dr} = S \\left( \\frac{r}{2} - \\frac{r^{3}}{4 R^{2}} \\right).\n$$\nIntegrate again to obtain $T(r)$ up to an additive constant (which may depend on $z$ through $T_{b}(z)$):\n$$\nT(r) = S \\left( \\frac{r^{2}}{4} - \\frac{r^{4}}{16 R^{2}} \\right) + C_{2}.\n$$\nApply the constant wall heat flux boundary condition expressed with the inward normal into the fluid: the conductive heat flux into the fluid equals $q''$, which in cylindrical coordinates at $r=R$ is\n$$\nq'' = k \\left. \\frac{d T}{dr} \\right|_{r=R}.\n$$\nEvaluating $\\left. dT/dr \\right|_{r=R}$ from the expression above gives\n$$\n\\left. \\frac{d T}{dr} \\right|_{r=R} = S \\left( \\frac{R}{2} - \\frac{R}{4} \\right) = S \\frac{R}{4}.\n$$\nHence $k \\left( S R / 4 \\right) = q''$, which is consistent with $S = 4 q''/(k R)$ derived earlier.\n\nTo construct the dimensionless temperature field $\\theta(r) \\equiv \\left[T_{w}(z) - T(r,z)\\right]/\\left[T_{w}(z) - T_{b}(z)\\right]$, we write the thermally fully developed temperature as\n$$\nT(r,z) = G z + \\varphi(r),\n$$\nwith\n$$\n\\varphi(r) = S \\left( \\frac{r^{2}}{4} - \\frac{r^{4}}{16 R^{2}} \\right),\n$$\nwhere any additive constant absorbed into $\\varphi$ cancels in $\\theta(r)$ and is thus set to zero without loss of generality. The wall temperature is $T_{w}(z) = T(R,z) = G z + \\varphi(R)$, and the bulk mean temperature is\n$$\nT_{b}(z) = G z + \\frac{2}{R^{2} v_{m}} \\int_{0}^{R} v_{z}(r)\\, \\varphi(r)\\, r\\, dr.\n$$\nUsing $v_{z}(r) = 2 v_{m}\\left( 1 - (r/R)^{2} \\right)$, we obtain\n$$\nT_{b}(z) = G z + \\frac{4}{R^{2}} \\int_{0}^{R} \\left( 1 - \\left(\\frac{r}{R}\\right)^{2} \\right) \\varphi(r)\\, r\\, dr.\n$$\nIntroduce the dimensionless radius $x \\equiv r/R$, so $r = x R$, $dr = R\\, dx$, and $r\\, dr = x R^{2}\\, dx$. With $\\varphi(r) = S R^{2}\\left( \\frac{x^{2}}{4} - \\frac{x^{4}}{16} \\right)$, the integral becomes\n$$\n\\int_{0}^{R} \\left( 1 - x^{2} \\right) \\varphi(r)\\, r\\, dr = S R^{4} \\int_{0}^{1} \\left( 1 - x^{2} \\right) \\left( \\frac{x^{3}}{4} - \\frac{x^{5}}{16} \\right) dx.\n$$\nCompute the integral exactly:\n$$\n\\int_{0}^{1} \\left( 1 - x^{2} \\right) \\left( \\frac{x^{3}}{4} - \\frac{x^{5}}{16} \\right) dx = \\int_{0}^{1} \\left( \\frac{x^{3}}{4} - \\frac{5 x^{5}}{16} + \\frac{x^{7}}{16} \\right) dx = \\frac{1}{16} - \\frac{5}{96} + \\frac{1}{128} = \\frac{7}{384}.\n$$\nTherefore,\n$$\nT_{b}(z) = G z + \\frac{4}{R^{2}} \\left( S R^{4} \\cdot \\frac{7}{384} \\right) = G z + S R^{2} \\cdot \\frac{7}{96}.\n$$\nThe wall temperature is\n$$\nT_{w}(z) = G z + \\varphi(R) = G z + S R^{2} \\left( \\frac{1}{4} - \\frac{1}{16} \\right) = G z + S R^{2} \\cdot \\frac{3}{16}.\n$$\nHence the wall-to-bulk difference is\n$$\nT_{w}(z) - T_{b}(z) = S R^{2} \\left( \\frac{3}{16} - \\frac{7}{96} \\right) = S R^{2} \\cdot \\frac{11}{96}.\n$$\nThe wall-to-local difference is\n$$\nT_{w}(z) - T(r,z) = \\left[ G z + S R^{2} \\cdot \\frac{3}{16} \\right] - \\left[ G z + S \\left( \\frac{r^{2}}{4} - \\frac{r^{4}}{16 R^{2}} \\right) \\right] = S \\left( R^{2} \\cdot \\frac{3}{16} - \\frac{r^{2}}{4} + \\frac{r^{4}}{16 R^{2}} \\right).\n$$\nTherefore, the dimensionless temperature field is\n$$\n\\theta(r) = \\frac{T_{w}(z) - T(r,z)}{T_{w}(z) - T_{b}(z)} = \\frac{S \\left( R^{2} \\cdot \\frac{3}{16} - \\frac{r^{2}}{4} + \\frac{r^{4}}{16 R^{2}} \\right)}{S R^{2} \\cdot \\frac{11}{96}} = \\frac{96}{11} \\left( \\frac{3}{16} - \\frac{1}{4} \\left( \\frac{r}{R} \\right)^{2} + \\frac{1}{16} \\left( \\frac{r}{R} \\right)^{4} \\right).\n$$\nCollecting terms,\n$$\n\\theta(r) = \\frac{6}{11} \\left( 3 - 4 \\left( \\frac{r}{R} \\right)^{2} + \\left( \\frac{r}{R} \\right)^{4} \\right).\n$$\nThis expression is independent of $z$ and depends only on the dimensionless radius $r/R$, as required for thermally fully developed conditions under constant wall heat flux. It also satisfies the boundary requirements $\\theta(R) = 0$ and yields the known fully developed constant heat flux Nusselt number $\\mathrm{Nu} = \\frac{q'' (2R)}{k \\left( T_{w} - T_{b} \\right)} = \\frac{48}{11}$ consistently when relating $T_{w} - T_{b}$ to $q''$.\n\nThus the closed-form dimensionless temperature field is\n$$\n\\theta(r) = \\frac{6}{11} \\left( 3 - 4 \\left( \\frac{r}{R} \\right)^{2} + \\left( \\frac{r}{R} \\right)^{4} \\right).\n$$",
            "answer": "$$\\boxed{\\frac{6}{11}\\left(3-4\\left(\\frac{r}{R}\\right)^{2}+\\left(\\frac{r}{R}\\right)^{4}\\right)}$$"
        },
        {
            "introduction": "Modern reactor analysis relies on computational methods to handle complex phenomena like boiling. This final practice bridges the gap from analytical theory to practical numerical implementation by tasking you with the design of a robust algorithm for a finite volume method (FVM) code . You will develop the logic to partition wall heat flux into sensible heating of the liquid and latent heat for evaporation, a critical step for accurately simulating the onset of boiling while strictly conserving energy within a computational cell.",
            "id": "4249882",
            "problem": "You are to implement a wall heat flux partitioning algorithm within a Finite Volume Method (FVM) liquid coolant cell adjacent to a heated wall. The goal is to guarantee conservation of energy between the wall and the fluid cell in the presence of evaporation sources, using only first principles. Assume a single computational cell with uniform properties and a single wall face through which heat enters the cell. The liquid coolant may boil when it reaches a saturation temperature, at which point any additional wall heat causes phase change.\n\nStart from the First Law of Thermodynamics for a control volume: the net rate of change of internal energy equals the rate of heat addition minus the rate of work done and plus/minus the net enthalpy carried by mass transfer. For this problem, neglect shaft work and pressure-volume work across the control surface and all convective exchange with neighboring cells, so the only energy input is the wall heat flux. The wall heat input in a timestep is determined by the wall heat flux and wall area. Assume constant liquid properties and an incompressible liquid. Treat evaporation as a source of vapor mass and an energy sink from the liquid equal to the latent heat per unit mass times the evaporated mass. You will derive the logic needed to partition wall heat between sensible heating of the liquid up to saturation and latent heating for evaporation, while ensuring the liquid temperature does not exceed saturation and the evaporated mass does not exceed the available liquid.\n\nDefinitions and assumptions:\n- Finite Volume Method (FVM): The control volume is the liquid cell of volume $V$ with liquid density $\\rho$, so the initial liquid mass is $m^n = \\rho V$.\n- The wall face area is $A$, and the uniform wall heat flux is $q_w$.\n- The timestep size is $\\Delta t$.\n- The liquid has constant specific heat capacity $c_p$.\n- The saturation temperature at the operating pressure is $T_{\\mathrm{sat}}$.\n- The latent heat of vaporization is $h_{\\mathrm{fg}}$.\n- The liquid temperature is uniform in the cell; at the beginning of the step it is $T^n$. The updated liquid temperature is $T^{n+1}$, which must satisfy $T^{n+1} \\le T_{\\mathrm{sat}}$.\n- The mass of liquid evaporated over the timestep is $m_{\\mathrm{evap}} \\ge 0$, and it must satisfy $m_{\\mathrm{evap}} \\le m^n$.\n- The wall energy addition over the timestep is $Q_w = q_w A \\Delta t$.\n- Any energy that cannot be absorbed by the liquid as sensible heating to $T_{\\mathrm{sat}}$ or as latent heat to evaporate the available liquid is an energy residual that must be assigned to the vapor energy equation to keep the global energy balance consistent. Denote this as $R$.\n\nFrom these principles, construct an algorithm that computes $T^{n+1}$, $m_{\\mathrm{evap}}$, and $R$, such that the liquid energy balance holds as\n$$\nQ_w = m^n c_p \\left( T^{n+1} - T^n \\right) + h_{\\mathrm{fg}}\\, m_{\\mathrm{evap}} + R,\n$$\nwith constraints $T^{n+1} \\le T_{\\mathrm{sat}}$, $m_{\\mathrm{evap}} \\le m^n$, and $R \\ge 0$. Explain how your algorithm enforces these constraints and adheres to the First Law of Thermodynamics.\n\nYour program must implement this algorithm and apply it to the following five test cases. Use the given physical units, and produce outputs in the units specified.\n\nCommon parameters for all test cases:\n- Liquid density $\\rho = 950\\,\\mathrm{kg/m^3}$.\n- Cell volume $V = 0.01\\,\\mathrm{m^3}$.\n- Specific heat capacity $c_p = 4200\\,\\mathrm{J/(kg\\cdot K)}$.\n- Latent heat of vaporization $h_{\\mathrm{fg}} = 1.0\\times 10^6\\,\\mathrm{J/kg}$.\n- Saturation temperature $T_{\\mathrm{sat}} = 611\\,\\mathrm{K}$.\n- Wall area $A = 0.5\\,\\mathrm{m^2}$.\n\nTest suite:\n1. Single-phase heating below saturation: $T^n = 580\\,\\mathrm{K}$, $q_w = 1.0\\times 10^5\\,\\mathrm{W/m^2}$, $\\Delta t = 1.0\\,\\mathrm{s}$.\n2. Onset of boiling with partial evaporation: $T^n = 580\\,\\mathrm{K}$, $q_w = 3.0\\times 10^6\\,\\mathrm{W/m^2}$, $\\Delta t = 1.0\\,\\mathrm{s}$.\n3. Evaporation limited by available liquid mass: $T^n = 580\\,\\mathrm{K}$, $q_w = 2.0\\times 10^6\\,\\mathrm{W/m^2}$, $\\Delta t = 12.0\\,\\mathrm{s}$.\n4. Saturated liquid with pure evaporation: $T^n = 611\\,\\mathrm{K}$, $q_w = 1.0\\times 10^6\\,\\mathrm{W/m^2}$, $\\Delta t = 1.0\\,\\mathrm{s}$.\n5. Zero heat flux edge case: $T^n = 590\\,\\mathrm{K}$, $q_w = 0.0\\,\\mathrm{W/m^2}$, $\\Delta t = 1.0\\,\\mathrm{s}$.\n\nFor each test case, compute:\n- Updated liquid temperature $T^{n+1}$ in $\\mathrm{K}$.\n- Evaporated mass $m_{\\mathrm{evap}}$ in $\\mathrm{kg}$.\n- Energy residual $R$ in $\\mathrm{J}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a list of three floats $[T^{n+1}, m_{\\mathrm{evap}}, R]$ in the order of the test suite. For example: $[[T_1,m_{\\mathrm{evap},1},R_1],[T_2,m_{\\mathrm{evap},2},R_2],\\dots]$.",
            "solution": "The problem statement is a well-posed and scientifically sound exercise in applying the First Law of Thermodynamics to a control volume undergoing potential phase change. It is grounded in the fundamental principles of heat transfer and is directly relevant to the modeling of two-phase flows in engineering applications, such as nuclear reactor thermal-hydraulics. The problem provides a complete set of data and constraints to derive a unique and verifiable solution. Therefore, we proceed with the derivation and implementation of the required algorithm.\n\nThe core of the problem is to partition the total heat energy added from the wall, $Q_w$, into three components: sensible heat gain in the liquid, latent heat of vaporization, and a residual energy term. This partitioning must adhere to a set of physical constraints. The governing energy balance for the liquid control volume over a timestep $\\Delta t$ is given as:\n$$\nQ_w = m^n c_p \\left( T^{n+1} - T^n \\right) + h_{\\mathrm{fg}}\\, m_{\\mathrm{evap}} + R\n$$\nThis equation is a statement of the First Law of Thermodynamics, where the energy input $Q_w$ equals the change in the liquid's internal energy (represented by the sensible heat term), plus the energy consumed for phase change, plus any residual energy $R$ that the liquid phase cannot absorb. The algorithm must determine the values of the updated temperature $T^{n+1}$, the evaporated mass $m_{\\mathrm{evap}}$, and the residual $R$ subject to the following constraints:\n1.  The final liquid temperature cannot exceed the saturation temperature: $T^{n+1} \\le T_{\\mathrm{sat}}$.\n2.  The evaporated mass must be non-negative and cannot exceed the initial liquid mass: $0 \\le m_{\\mathrm{evap}} \\le m^n$.\n3.  The residual energy, which would be transferred to the vapor phase, must be non-negative: $R \\ge 0$.\n\nTo satisfy these constraints, the algorithm must distribute the available energy $Q_w$ in a prioritized, sequential manner. The energy is first allocated to raising the liquid temperature (sensible heat), then to evaporating the liquid at a constant temperature (latent heat), and any remainder is assigned to the residual.\n\nFirst, we calculate the constant parameters for the system:\n-   Initial liquid mass: $m^n = \\rho V = (950\\,\\mathrm{kg/m^3}) \\times (0.01\\,\\mathrm{m^3}) = 9.5\\,\\mathrm{kg}$.\n-   The total heat energy input during the timestep: $Q_w = q_w A \\Delta t$.\n\nThe algorithm then proceeds as follows:\n\n**Step 1: Sensible Heat Partitioning**\nThe first priority is to heat the liquid from its initial temperature $T^n$ up to the saturation temperature $T_{\\mathrm{sat}}$.\n-   Calculate the maximum energy the liquid can absorb as sensible heat before boiling begins. This is possible only if the liquid is subcooled ($T^n  T_{\\mathrm{sat}}$).\n    $$\n    Q_{\\mathrm{sens,max}} = m^n c_p (T_{\\mathrm{sat}} - T^n)\n    $$\n    If the liquid is already at saturation ($T^n = T_{\\mathrm{sat}}$), then $Q_{\\mathrm{sens,max}} = 0$.\n-   Compare the total energy input $Q_w$ with $Q_{\\mathrm{sens,max}}$.\n    -   **Case 1a (Sub-saturation heating):** If $Q_w \\le Q_{\\mathrm{sens,max}}$, the entire energy input is absorbed as sensible heat. The liquid temperature increases but does not exceed $T_{\\mathrm{sat}}$. The temperature change is $\\Delta T = Q_w / (m^n c_p)$, so the final temperature is $T^{n+1} = T^n + \\Delta T$. In this case, no boiling occurs, so $m_{\\mathrm{evap}} = 0$, and all energy is accounted for, so $R = 0$. The process is complete.\n    -   **Case 1b (Reaching saturation):** If $Q_w  Q_{\\mathrm{sens,max}}$, the liquid has enough energy to reach $T_{\\mathrm{sat}}$. The final liquid temperature is set to $T^{n+1} = T_{\\mathrm{sat}}$. An amount of energy equal to $Q_{\\mathrm{sens,max}}$ is consumed in this process. The remaining energy, $Q'_{\\text{avail}} = Q_w - Q_{\\mathrm{sens,max}}$, is available for phase change. We proceed to Step 2 with this remaining energy.\n\n**Step 2: Latent Heat Partitioning**\nThis step is executed only if there is energy remaining after the liquid has reached saturation (Case 1b). The available energy, $Q'_{\\text{avail}}$, is now used to evaporate the liquid.\n-   Calculate the maximum energy that can be absorbed as latent heat, which corresponds to the evaporation of the entire liquid mass $m^n$:\n    $$\n    Q_{\\mathrm{lat,max}} = m^n h_{\\mathrm{fg}}\n    $$\n-   Compare the available energy for evaporation, $Q'_{\\text{avail}}$, with $Q_{\\mathrm{lat,max}}$.\n    -   **Case 2a (Partial boiling):** If $Q'_{\\text{avail}} \\le Q_{\\mathrm{lat,max}}$, the remaining energy is entirely consumed by phase change. The mass of evaporated liquid is given by $m_{\\mathrm{evap}} = Q'_{\\text{avail}} / h_{\\mathrm{fg}}$. Since all available energy is used, the residual is $R=0$. The process is complete. The liquid temperature remains $T^{n+1} = T_{\\mathrm{sat}}$.\n    -   **Case 2b (Complete boiling):** If $Q'_{\\text{avail}}  Q_{\\mathrm{lat,max}}$, there is more than enough energy to evaporate all the liquid. The evaporated mass is thus limited by the available liquid: $m_{\\mathrm{evap}} = m^n$. The energy consumed in this step is $Q_{\\mathrm{lat,max}}$. The remaining energy is passed to the residual. We proceed to Step 3.\n\n**Step 3: Residual Energy Calculation**\nThis step is executed only if the input energy is sufficient to heat the liquid to saturation and then evaporate it completely (Case 2b).\n-   The residual energy $R$ is the amount of energy left after accounting for maximum sensible and latent heat absorption:\n    $$\n    R = Q'_{\\text{avail}} - Q_{\\mathrm{lat,max}} = (Q_w - Q_{\\mathrm{sens,max}}) - Q_{\\mathrm{lat,max}}\n    $$\nThis residual $R$ is not absorbed by the liquid phase. In a complete multiphase simulation code, this energy would serve as a source term for the vapor phase energy equation, thus ensuring global energy conservation for the entire system.\n\nThis hierarchical algorithm rigorously enforces the physical constraints by construction. The temperature $T^{n+1}$ is clamped at $T_{\\mathrm{sat}}$, mass evaporation $m_{\\mathrm{evap}}$ is clamped at $m^n$, and the residual $R$ is by definition non-negative, correctly implementing the First Law for an FVM cell with phase change.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the wall heat flux partitioning algorithm for a single FVM cell.\n    \"\"\"\n\n    # Common parameters for all test cases\n    rho = 950.0   # kg/m^3\n    V = 0.01      # m^3\n    c_p = 4200.0  # J/(kg.K)\n    h_fg = 1.0e6  # J/kg\n    T_sat = 611.0 # K\n    A = 0.5       # m^2\n\n    # Calculate initial liquid mass\n    m_initial = rho * V\n\n    # Test suite\n    test_cases = [\n        # (T^n [K], q_w [W/m^2], delta_t [s])\n        (580.0, 1.0e5, 1.0),\n        (580.0, 3.0e6, 1.0),\n        (580.0, 2.0e6, 12.0),\n        (611.0, 1.0e6, 1.0),\n        (590.0, 0.0, 1.0),\n    ]\n\n    results = []\n    for T_n, q_w, delta_t in test_cases:\n        # Initialize outputs for the current timestep\n        T_np1 = T_n\n        m_evap = 0.0\n        R = 0.0\n        \n        # Total energy input from the wall\n        Q_w = q_w * A * delta_t\n        \n        # Energy available for partitioning\n        Q_avail = Q_w\n\n        # --- Step 1: Sensible Heat Partitioning ---\n        if T_n  T_sat:\n            # Maximum energy that can be absorbed as sensible heat\n            Q_sens_max = m_initial * c_p * (T_sat - T_n)\n\n            if Q_avail = Q_sens_max:\n                # Case 1a: All energy goes to sensible heat, liquid does not reach saturation\n                # or just reaches it.\n                delta_T = Q_avail / (m_initial * c_p)\n                T_np1 = T_n + delta_T\n                # m_evap and R remain 0.0\n                Q_avail = 0.0 # All energy consumed\n            else:\n                # Case 1b: Liquid reaches saturation temperature.\n                T_np1 = T_sat\n                # Energy is consumed to heat liquid to saturation.\n                Q_avail -= Q_sens_max\n        # If T_n was already at T_sat, Q_sens_max is 0 and all Q_w is available for boiling.\n\n        # --- Step 2: Latent Heat Partitioning ---\n        if Q_avail > 0:\n            # Maximum energy that can be absorbed as latent heat (all liquid evaporates)\n            Q_lat_max = m_initial * h_fg\n\n            if Q_avail = Q_lat_max:\n                # Case 2a: Partial boiling. Remaining energy is consumed by evaporation.\n                m_evap = Q_avail / h_fg\n                # R remains 0.0\n                Q_avail = 0.0 # All remaining energy consumed\n            else:\n                # Case 2b: Complete boiling. All liquid evaporates.\n                m_evap = m_initial\n                # Energy is consumed to evaporate all liquid.\n                Q_avail -= Q_lat_max\n\n        # --- Step 3: Energy Residual ---\n        if Q_avail > 0:\n            # Any remaining energy is assigned to the residual.\n            R = Q_avail\n\n        results.append([T_np1, m_evap, R])\n\n    # Format the output string as specified, without extra spaces\n    sub_results_str = []\n    for res_list in results:\n        # Format each list [T, m, R] into a string \"[T,m,R]\"\n        sub_results_str.append(f\"[{res_list[0]},{res_list[1]},{res_list[2]}]\")\n    \n    # Join the sub-strings with commas and enclose in brackets\n    final_output_str = f\"[{','.join(sub_results_str)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}