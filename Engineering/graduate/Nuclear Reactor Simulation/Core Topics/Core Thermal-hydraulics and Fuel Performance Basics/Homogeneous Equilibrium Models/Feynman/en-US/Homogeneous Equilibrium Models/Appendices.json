{
    "hands_on_practices": [
        {
            "introduction": "The Homogeneous Equilibrium Model (HEM) simplifies two-phase flow by treating the mixture as a single pseudo-fluid with effective properties. This exercise provides fundamental practice in applying the HEM mixing rules to calculate key thermodynamic properties such as mixture density $\\rho_m$, specific enthalpy $h_m$, and isobaric specific heat $c_{p,m}$ from the properties of the individual phases . Mastering this calculation is the first step toward applying the HEM to larger system-level analyses.",
            "id": "4230552",
            "problem": "Consider a one-dimensional, steady, saturated two-phase water-steam flow representative of a coolant channel segment in a pressurized water reactor under the Homogeneous Equilibrium Model (HEM) assumptions: both phases share a common velocity and are in thermodynamic equilibrium. Let the system pressure be $p=7$ MPa and the mass quality be $x=0.2$, defined as $x = m_{\\text{vapor}}/m_{\\text{total}}$. Use a water-steam Equation of State (EOS), specifically the International Association for the Properties of Water and Steam (IAPWS) Industrial Formulation 1997 (IAPWS-IF97), to obtain saturated properties at $p=7$ MPa.\n\nFundamental base: Under HEM and equilibrium, the mixture specific enthalpy $h_m$ is the mass-weighted average of the phase enthalpies, and the mixture specific volume $v_m$ is the mass-weighted average of the phase specific volumes. The mixture density is $\\rho_m = 1/v_m$. For a property like specific heat at constant pressure $c_p$, adopt the common HEM mixing rule at the saturation temperature: the mixture $c_{p,m}$ is the mass-weighted average of the phase $c_p$ values.\n\nUse the following saturated properties at $p=7$ MPa from the EOS:\n- Saturation temperature $T_{\\text{sat}}=560$ K,\n- Saturated liquid density $\\rho_f=730$ kg/m$^3$,\n- Saturated vapor density $\\rho_g=35$ kg/m$^3$,\n- Saturated liquid specific enthalpy $h_f=1250$ kJ/kg,\n- Saturated vapor specific enthalpy $h_g=3060$ kJ/kg,\n- Saturated liquid isobaric specific heat $c_{p,f}=4.70$ kJ/(kg·K),\n- Saturated vapor isobaric specific heat $c_{p,g}=2.08$ kJ/(kg·K).\n\nAssume typical EOS uncertainties at these conditions are small and independent: relative uncertainty of $\\pm 1\\%$ in densities, $\\pm 0.5\\%$ in enthalpies, and $\\pm 2\\%$ in specific heats. Starting only from the HEM definitions and the provided EOS values, compute the mixture density $\\rho_m$, mixture specific enthalpy $h_m$, and mixture isobaric specific heat $c_{p,m}$ at $p=7$ MPa and $x=0.2$ under saturated conditions. Then, discuss—qualitatively and via first-order linearized sensitivity—how the stated EOS uncertainties influence $\\rho_m$, $h_m$, and $c_{p,m}$.\n\nRound your numerical results to four significant figures. Express $\\rho_m$ in kg/m$^3$, $h_m$ in kJ/kg, and $c_{p,m}$ in kJ/(kg·K). The final answer must be the triple $\\rho_m$, $h_m$, $c_{p,m}$.",
            "solution": "The Homogeneous Equilibrium Model (HEM) provides mixture property definitions grounded in mass-weighted averages for extensive properties and mass-weighted averages of specific volume for density. The mass quality $x$ is defined as $x = m_{\\text{vapor}}/m_{\\text{total}}$. We proceed using the fundamental definitions.\n\nFor the mixture specific enthalpy $h_m$, the HEM definition is\n$$\nh_m = x\\,h_g + (1-x)\\,h_f,\n$$\nwhere $h_f$ and $h_g$ are the saturated liquid and saturated vapor specific enthalpies at the given saturation state.\n\nFor the mixture specific volume $v_m$, the HEM definition is\n$$\nv_m = x\\,v_g + (1-x)\\,v_f = x\\,\\frac{1}{\\rho_g} + (1-x)\\,\\frac{1}{\\rho_f},\n$$\nwhere $\\rho_f$ and $\\rho_g$ are the saturated liquid and saturated vapor densities. The mixture density is then\n$$\n\\rho_m = \\frac{1}{v_m} = \\frac{1}{x/\\rho_g + (1-x)/\\rho_f}.\n$$\n\nFor the mixture isobaric specific heat $c_{p,m}$ at the saturation temperature, we adopt the common HEM mixing rule\n$$\nc_{p,m} = x\\,c_{p,g} + (1-x)\\,c_{p,f},\n$$\nwith $c_{p,f}$ and $c_{p,g}$ the saturated liquid and saturated vapor isobaric specific heats.\n\nNow, insert the provided EOS values at $p=7$ MPa and $x=0.2$:\n- $x = 0.2$,\n- $\\rho_f = 730$ kg/m$^3$,\n- $\\rho_g = 35$ kg/m$^3$,\n- $h_f = 1250$ kJ/kg,\n- $h_g = 3060$ kJ/kg,\n- $c_{p,f} = 4.70$ kJ/(kg·K),\n- $c_{p,g} = 2.08$ kJ/(kg·K).\n\nCompute $h_m$:\n$$\nh_m = x\\,h_g + (1-x)\\,h_f = 0.2 \\times 3060 + 0.8 \\times 1250.\n$$\nEvaluate each term:\n$$\n0.2 \\times 3060 = 612,\\quad 0.8 \\times 1250 = 1000,\n$$\nso\n$$\nh_m = 612 + 1000 = 1612.\n$$\n\nCompute $v_m$:\n$$\nv_m = x\\,\\frac{1}{\\rho_g} + (1-x)\\,\\frac{1}{\\rho_f} = 0.2 \\times \\frac{1}{35} + 0.8 \\times \\frac{1}{730}.\n$$\nEvaluate the reciprocals:\n$$\n\\frac{1}{35} \\approx 0.0285714286,\\quad \\frac{1}{730} \\approx 0.0013698630,\n$$\nso\n$$\nv_m \\approx 0.2 \\times 0.0285714286 + 0.8 \\times 0.0013698630 = 0.0057142857 + 0.0010958904 = 0.0068101761.\n$$\nThen\n$$\n\\rho_m = \\frac{1}{v_m} \\approx \\frac{1}{0.0068101761} \\approx 146.83.\n$$\n\nCompute $c_{p,m}$:\n$$\nc_{p,m} = x\\,c_{p,g} + (1-x)\\,c_{p,f} = 0.2 \\times 2.08 + 0.8 \\times 4.70.\n$$\nEvaluate each term:\n$$\n0.2 \\times 2.08 = 0.416,\\quad 0.8 \\times 4.70 = 3.76,\n$$\nso\n$$\nc_{p,m} = 0.416 + 3.76 = 4.176.\n$$\n\nRound all three results to four significant figures:\n- $\\rho_m \\approx 146.8$ kg/m$^3$,\n- $h_m = 1612$ kJ/kg,\n- $c_{p,m} = 4.176$ kJ/(kg·K).\n\nSensitivity discussion using first-order (linearized) propagation:\n\n1. Enthalpy sensitivity. Since $h_m = x\\,h_g + (1-x)\\,h_f$,\n$$\n\\frac{\\partial h_m}{\\partial h_g} = x,\\quad \\frac{\\partial h_m}{\\partial h_f} = 1-x.\n$$\nFor relative uncertainties $\\delta h_g/h_g$ and $\\delta h_f/h_f$,\n$$\n\\delta h_m \\approx x\\,\\delta h_g + (1-x)\\,\\delta h_f.\n$$\nWith $\\pm 0.5\\%$ on both $h_g$ and $h_f$, a representative change is\n$$\n\\delta h_g = 0.005\\,h_g = 15.3,\\quad \\delta h_f = 0.005\\,h_f = 6.25,\n$$\nyielding\n$$\n\\delta h_m \\approx 0.2 \\times 15.3 + 0.8 \\times 6.25 = 3.06 + 5.00 = 8.06,\n$$\nso a relative change\n$$\n\\frac{\\delta h_m}{h_m} \\approx \\frac{8.06}{1612} \\approx 0.0050,\n$$\nthat is, about $0.5$ percent, reflecting the linearity of $h_m$ in $h_f$ and $h_g$.\n\n2. Specific heat sensitivity. Since $c_{p,m} = x\\,c_{p,g} + (1-x)\\,c_{p,f}$,\n$$\n\\frac{\\partial c_{p,m}}{\\partial c_{p,g}} = x,\\quad \\frac{\\partial c_{p,m}}{\\partial c_{p,f}} = 1-x.\n$$\nWith $\\pm 2\\%$ uncertainties,\n$$\n\\delta c_{p,g} = 0.02 \\times 2.08 = 0.0416,\\quad \\delta c_{p,f} = 0.02 \\times 4.70 = 0.0940,\n$$\nthen\n$$\n\\delta c_{p,m} \\approx 0.2 \\times 0.0416 + 0.8 \\times 0.0940 = 0.00832 + 0.07520 = 0.08352,\n$$\nso\n$$\n\\frac{\\delta c_{p,m}}{c_{p,m}} \\approx \\frac{0.08352}{4.176} \\approx 0.0200,\n$$\nthat is, about $2$ percent.\n\n3. Density sensitivity. Write $\\rho_m = 1/v_m$ with $v_m = x/\\rho_g + (1-x)/\\rho_f$. Differentiate:\n$$\nd v_m = x\\,d\\!\\left(\\frac{1}{\\rho_g}\\right) + (1-x)\\,d\\!\\left(\\frac{1}{\\rho_f}\\right) = -x\\,\\frac{d\\rho_g}{\\rho_g^{2}} - (1-x)\\,\\frac{d\\rho_f}{\\rho_f^{2}}.\n$$\nSince $d\\rho_m = -\\rho_m^{2}\\,d v_m$, we have\n$$\n\\frac{d\\rho_m}{\\rho_m} = -\\frac{d v_m}{v_m}.\n$$\nFor $\\pm 1\\%$ uncertainties,\n$$\nd\\rho_g = 0.01\\,\\rho_g = 0.35,\\quad d\\rho_f = 0.01\\,\\rho_f = 7.30,\n$$\ngiving\n$$\n\\frac{\\partial v_m}{\\partial \\rho_g} = -\\frac{x}{\\rho_g^{2}} = -\\frac{0.2}{35^{2}} \\approx -1.63265 \\times 10^{-4},\n$$\n$$\n\\frac{\\partial v_m}{\\partial \\rho_f} = -\\frac{1-x}{\\rho_f^{2}} = -\\frac{0.8}{730^{2}} \\approx -1.50113 \\times 10^{-6}.\n$$\nThus\n$$\nd v_m \\approx \\left(-1.63265 \\times 10^{-4}\\right)\\times 0.35 + \\left(-1.50113 \\times 10^{-6}\\right)\\times 7.30 \\approx -5.7143 \\times 10^{-5} - 1.0958 \\times 10^{-5} = -6.8101 \\times 10^{-5}.\n$$\nWith $v_m \\approx 0.0068102$, the relative change is\n$$\n-\\frac{d v_m}{v_m} \\approx -\\frac{-6.8101 \\times 10^{-5}}{0.0068102} \\approx 0.0100,\n$$\nso\n$$\n\\frac{d\\rho_m}{\\rho_m} \\approx 0.0100,\n$$\nthat is, about $1$ percent. The contribution from the vapor density dominates because $|\\partial v_m / \\partial \\rho_g| \\gg |\\partial v_m / \\partial \\rho_f|$, reflecting the much larger specific volume of the vapor.\n\nIn summary, under the HEM mixing rules, the mixture properties $\\rho_m$, $h_m$, and $c_{p,m}$ inherit uncertainties from the EOS in a predictable linear fashion: $h_m$ and $c_{p,m}$ follow the mass-weighted averages directly, while $\\rho_m$ is most sensitive to the vapor density due to the harmonic-mean-like dependence on phase densities through specific volumes.\n\nNumerical results rounded to four significant figures:\n- $\\rho_m \\approx 146.8$ kg/m$^3$,\n- $h_m = 1612$ kJ/kg,\n- $c_{p,m} = 4.176$ kJ/(kg·K).",
            "answer": "$$\\boxed{\\begin{pmatrix}146.8 & 1612 & 4.176\\end{pmatrix}}$$"
        },
        {
            "introduction": "While the HEM is a powerful tool, its core assumption of instantaneous thermodynamic equilibrium breaks down during rapid transients, a critical consideration in reactor safety analysis. This practice explores the concept of acoustic wave propagation in a two-phase mixture, contrasting the very low sonic speed predicted by the HEM with the much higher \"frozen\" sonic speed that occurs when phase change cannot keep pace . By quantifying this discrepancy, you will gain a deeper understanding of the physical limitations of equilibrium models and the importance of timescales in transient simulations.",
            "id": "4230566",
            "problem": "A saturated water–steam mixture in a pressurized water reactor downcomer undergoes a rapid depressurization transient. The mixture is well-described by a Homogeneous Equilibrium Model (HEM), in which both phases share a common pressure, velocity, and temperature, and phase change is assumed to occur instantaneously to maintain thermodynamic equilibrium. However, for sufficiently rapid transients, finite-rate phase change and thermal non-equilibrium render the equilibrium assumption invalid on the acoustic timescale.\n\nAssume the following physically consistent properties at the initial state:\n- Saturated liquid density $\\rho_{l} = 700\\,\\mathrm{kg/m^{3}}$,\n- Saturated vapor density $\\rho_{g} = 35\\,\\mathrm{kg/m^{3}}$,\n- Isentropic single-phase speed of sound in liquid $c_{l} = 1450\\,\\mathrm{m/s}$,\n- Isentropic single-phase speed of sound in vapor $c_{g} = 480\\,\\mathrm{m/s}$,\n- Initial void fraction (gas volume fraction) $\\alpha_{0} = 0.5$,\n- Equilibrium isentropic mixture compressibility (under HEM) $\\kappa_{e} = 1.0 \\times 10^{-4}\\,\\mathrm{Pa^{-1}}$,\n- Effective phase-change and thermal relaxation time $\\tau = 5.0 \\times 10^{-3}\\,\\mathrm{s}$.\n\nThe depressurization is initiated over a characteristic timescale $\\Delta t = 1.0 \\times 10^{-4}\\,\\mathrm{s}$.\n\nStarting from the fundamental definition of acoustic speed $c^{2} = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$ and the mixture kinematics for small isentropic perturbations, perform the following:\n\n1. Derive and compute the HEM sonic speed $c_{\\mathrm{HEM}}$ for the stated mixture using the given equilibrium isentropic compressibility $\\kappa_{e}$ and the mixture density $\\rho_{m}$ formed from the initial void fraction $\\alpha_{0}$.\n2. Under the non-equilibrium “frozen” approximation (no phase change on the acoustic timescale and no interfacial heat transfer), derive and compute the frozen sonic speed $c_{f}$ by combining the single-phase isentropic responses of each phase to obtain the effective small-signal mixture compressibility.\n3. Evaluate the applicability of HEM to this transient by forming a dimensionless non-equilibrium parameter using $\\omega \\approx \\frac{1}{\\Delta t}$ and $\\omega \\tau$.\n4. Quantify the error introduced by using HEM for this rapid transient by computing the relative deviation $\\varepsilon = \\frac{c_{f} - c_{\\mathrm{HEM}}}{c_{f}}$, expressed as a decimal.\n\nRound your final answer for $\\varepsilon$ to four significant figures. The final answer must be unitless and given as a decimal.",
            "solution": "The problem statement is subjected to validation prior to attempting a solution.\n\n### Step 1: Extract Givens\n- Saturated liquid density: $\\rho_{l} = 700\\,\\mathrm{kg/m^{3}}$\n- Saturated vapor density: $\\rho_{g} = 35\\,\\mathrm{kg/m^{3}}$\n- Isentropic single-phase speed of sound in liquid: $c_{l} = 1450\\,\\mathrm{m/s}$\n- Isentropic single-phase speed of sound in vapor: $c_{g} = 480\\,\\mathrm{m/s}$\n- Initial void fraction (gas volume fraction): $\\alpha_{0} = 0.5$\n- Equilibrium isentropic mixture compressibility (HEM): $\\kappa_{e} = 1.0 \\times 10^{-4}\\,\\mathrm{Pa^{-1}}$\n- Effective phase-change and thermal relaxation time: $\\tau = 5.0 \\times 10^{-3}\\,\\mathrm{s}$\n- Characteristic timescale of depressurization: $\\Delta t = 1.0 \\times 10^{-4}\\,\\mathrm{s}$\n- Definition of acoustic speed: $c^{2} = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the established principles of two-phase fluid dynamics and acoustics, specifically contrasting the Homogeneous Equilibrium Model (HEM) with the non-equilibrium frozen flow model. These are standard, well-documented models in thermal-hydraulics. The problem is well-posed, providing all necessary data for the calculations requested. The given physical properties are consistent and realistic for a high-pressure water-steam system. The problem is objective and free of ambiguity. It does not violate any of the specified criteria for invalidity.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A full solution will be provided.\n\nThe solution proceeds by addressing the four required tasks in sequence.\n\nFirst, we calculate the initial mixture density, $\\rho_{m}$. The mixture density is the weighted average of the phase densities based on their volume fractions.\n$$\n\\rho_{m} = (1 - \\alpha_{0})\\rho_{l} + \\alpha_{0}\\rho_{g}\n$$\nSubstituting the given values $\\alpha_{0} = 0.5$, $\\rho_{l} = 700\\,\\mathrm{kg/m^{3}}$, and $\\rho_{g} = 35\\,\\mathrm{kg/m^{3}}$:\n$$\n\\rho_{m} = (1 - 0.5)(700) + (0.5)(35) = 0.5 \\times 700 + 0.5 \\times 35 = 350 + 17.5 = 367.5\\,\\mathrm{kg/m^{3}}\n$$\n\n**1. Derivation and Computation of the HEM Sonic Speed, $c_{\\mathrm{HEM}}$**\n\nThe isentropic speed of sound, $c$, is defined by $c^{2} = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$. The isentropic compressibility, $\\kappa_s$, is defined as $\\kappa_{s} = \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial p}\\right)_{s}$. Combining these definitions yields the relationship:\n$$\nc^{2} = \\frac{1}{\\rho \\kappa_{s}}\n$$\nFor the Homogeneous Equilibrium Model (HEM), the acoustic speed $c_{\\mathrm{HEM}}$ is determined using the mixture density $\\rho_{m}$ and the given equilibrium isentropic compressibility of the mixture, $\\kappa_{e}$.\n$$\nc_{\\mathrm{HEM}}^{2} = \\frac{1}{\\rho_{m} \\kappa_{e}}\n$$\nSubstituting the calculated value for $\\rho_{m}$ and the given value for $\\kappa_{e} = 1.0 \\times 10^{-4}\\,\\mathrm{Pa^{-1}}$:\n$$\nc_{\\mathrm{HEM}}^{2} = \\frac{1}{(367.5\\,\\mathrm{kg/m^{3}}) (1.0 \\times 10^{-4}\\,\\mathrm{Pa^{-1}})} = \\frac{1}{0.03675}\\,\\mathrm{m^{2}/s^{2}} \\approx 27.21088\\,\\mathrm{m^{2}/s^{2}}\n$$\n$$\nc_{\\mathrm{HEM}} = \\sqrt{27.21088...} \\approx 5.2164\\,\\mathrm{m/s}\n$$\nThis extremely low value is a well-known characteristic of the HEM sound speed in two-phase mixtures with significant void fraction, arising from the combination of high mixture inertia (dominated by the liquid) and high mixture compressibility (dominated by the vapor).\n\n**2. Derivation and Computation of the Frozen Sonic Speed, $c_{f}$**\n\nIn the \"frozen\" approximation, no mass is exchanged between the phases during the acoustic wave propagation. The effective compressibility of the mixture, $\\kappa_{f}$, is a volume-weighted average of the individual phase compressibilities.\n$$\n\\kappa_{f} = (1 - \\alpha_{0})\\kappa_{l} + \\alpha_{0}\\kappa_{g}\n$$\nThe single-phase isentropic compressibilities, $\\kappa_l$ and $\\kappa_g$, can be determined from their respective speeds of sound, $c_l$ and $c_g$, and densities, $\\rho_l$ and $\\rho_g$.\n$$\n\\kappa_{l} = \\frac{1}{\\rho_{l} c_{l}^{2}} \\quad \\text{and} \\quad \\kappa_{g} = \\frac{1}{\\rho_{g} c_{g}^{2}}\n$$\nSubstituting the given values:\n$$\n\\kappa_{l} = \\frac{1}{(700\\,\\mathrm{kg/m^{3}}) (1450\\,\\mathrm{m/s})^{2}} = \\frac{1}{700 \\times 2102500} = \\frac{1}{1.47175 \\times 10^{9}}\\,\\mathrm{Pa^{-1}}\n$$\n$$\n\\kappa_{g} = \\frac{1}{(35\\,\\mathrm{kg/m^{3}}) (480\\,\\mathrm{m/s})^{2}} = \\frac{1}{35 \\times 230400} = \\frac{1}{8.064 \\times 10^{6}}\\,\\mathrm{Pa^{-1}}\n$$\nNow we compute the frozen mixture compressibility with $\\alpha_{0} = 0.5$:\n$$\n\\kappa_{f} = 0.5 \\left( \\frac{1}{1.47175 \\times 10^{9}} + \\frac{1}{8.064 \\times 10^{6}} \\right)\\,\\mathrm{Pa^{-1}}\n$$\n$$\n\\kappa_{f} \\approx 0.5 (6.7946 \\times 10^{-10} + 1.2401 \\times 10^{-7})\\,\\mathrm{Pa^{-1}} \\approx 6.2344 \\times 10^{-8}\\,\\mathrm{Pa^{-1}}\n$$\nThe frozen sonic speed, $c_{f}$, is then found using this frozen compressibility and the mixture density:\n$$\nc_{f}^{2} = \\frac{1}{\\rho_{m} \\kappa_{f}}\n$$\n$$\nc_{f}^{2} = \\frac{1}{(367.5\\,\\mathrm{kg/m^{3}}) (6.2344 \\times 10^{-8}\\,\\mathrm{Pa^{-1}})} \\approx \\frac{1}{2.2909 \\times 10^{-5}}\\,\\mathrm{m^{2}/s^{2}} \\approx 43650.14\\,\\mathrm{m^{2}/s^{2}}\n$$\n$$\nc_{f} = \\sqrt{43650.14...} \\approx 208.926\\,\\mathrm{m/s}\n$$\n\n**3. Evaluation of HEM Applicability**\n\nThe applicability of the HEM is assessed by comparing the transient timescale with the phase-change relaxation time. A dimensionless parameter is formed using the characteristic frequency of the transient, $\\omega \\approx 1/\\Delta t$, and the relaxation time $\\tau$.\n$$\n\\omega \\approx \\frac{1}{\\Delta t} = \\frac{1}{1.0 \\times 10^{-4}\\,\\mathrm{s}} = 10000\\,\\mathrm{s^{-1}}\n$$\nThe dimensionless group is $\\omega \\tau$:\n$$\n\\omega \\tau = (10000\\,\\mathrm{s^{-1}}) (5.0 \\times 10^{-3}\\,\\mathrm{s}) = 50\n$$\nSince $\\omega \\tau = 50 \\gg 1$, the transient is extremely rapid compared to the time required for the system to achieve thermodynamic equilibrium. Phase change and interfacial heat transfer are effectively \"frozen\" on this acoustic timescale. Therefore, the Homogeneous Equilibrium Model is not applicable for this transient, and the frozen model provides a more accurate description of the acoustic behavior.\n\n**4. Quantification of Error**\n\nThe relative deviation, $\\varepsilon$, introduced by using the invalid HEM model instead of the more appropriate frozen model is computed as:\n$$\n\\varepsilon = \\frac{c_{f} - c_{\\mathrm{HEM}}}{c_{f}} = 1 - \\frac{c_{\\mathrm{HEM}}}{c_{f}}\n$$\nUsing the computed values for the sonic speeds:\n$$\nc_{\\mathrm{HEM}} \\approx 5.216405\\,\\mathrm{m/s}\n$$\n$$\nc_{f} \\approx 208.926155\\,\\mathrm{m/s}\n$$\n$$\n\\varepsilon = 1 - \\frac{5.216405}{208.926155} \\approx 1 - 0.02496838 \\approx 0.97503162\n$$\nThe large error highlights the dramatic failure of the equilibrium assumption for such a rapid transient. Rounding the result to four significant figures as requested gives:\n$$\n\\varepsilon \\approx 0.9750\n$$",
            "answer": "$$\\boxed{0.9750}$$"
        },
        {
            "introduction": "The ultimate application of the Homogeneous Equilibrium Model in modern reactor analysis is through numerical simulation, which requires translating the continuous governing equations into a discrete form. This exercise provides hands-on practice in constructing a numerical solver by implementing the Rusanov flux scheme, a common method for solving the conservative HEM equations . This task bridges the gap between theoretical understanding and the practical implementation of computational fluid dynamics (CFD) for two-phase flow.",
            "id": "4230569",
            "problem": "A homogeneous equilibrium model (HEM) for two-phase mixture flow in one spatial dimension assumes a single common velocity and a single common pressure for the mixture, with mechanical and thermal equilibrium between the phases. Consider the conservative variable vector $\\mathbf{U} = (\\rho_m, \\rho_m u, \\rho_m E)$, where $\\rho_m$ is the mixture density, $u$ is the mixture velocity, and $E$ is the mixture total specific energy. Starting from the fundamental conservation laws of mass, momentum, and energy and the definition of inviscid fluxes for a compressible mixture, construct a finite volume discretization of the one-dimensional HEM on a uniform mesh with cell width $\\Delta x$ and time step $\\Delta t$, ignoring external source terms. Assume that the mixture obeys a compressible closure consistent with homogeneous equilibrium thermodynamics modeled by a stiffened-gas mixture equation of state (EOS): the mixture pressure $p$ is given by $p = (\\gamma_m - 1)\\rho_m e - \\gamma_m p_{\\infty,m}$, where $\\gamma_m$ is the mixture ratio of specific heats, $p_{\\infty,m}$ is the mixture stiffening pressure, and $e$ is the mixture specific internal energy. The total specific energy satisfies $E = e + \\frac{1}{2}u^2$. The mixture speed of sound is defined by $c = \\sqrt{\\gamma_m \\frac{p + p_{\\infty,m}}{\\rho_m}}$, which is consistent with the stiffened-gas thermodynamics under homogeneous equilibrium.\n\nYour tasks are:\n- Derive the conservative inviscid flux vector $\\mathbf{F}(\\mathbf{U})$ from the conservation laws and the thermodynamic closure and provide a consistent numerical flux at cell interfaces suitable for finite volume discretization.\n- Implement the Rusanov (local Lax–Friedrichs) numerical flux at an interface $i+\\frac{1}{2}$ using left and right states $\\mathbf{U}_L$ and $\\mathbf{U}_R$, with the interface wave speed $s_{\\max} = \\max(|u_L| + c_L, |u_R| + c_R)$, where $u_L$, $c_L$ and $u_R$, $c_R$ are computed from $\\mathbf{U}_L$ and $\\mathbf{U}_R$ via the specified thermodynamic closure.\n\nYou must produce a complete, runnable program that, for a given set of interface states and EOS parameters, computes the Rusanov numerical flux vector $\\mathbf{F}_{\\text{num}}$ for each interface test case. The physical units are as follows: $\\rho_m$ in $\\mathrm{kg/m^3}$, $u$ in $\\mathrm{m/s}$, $E$ in $\\mathrm{J/kg}$, $p$ in $\\mathrm{Pa}$, $c$ in $\\mathrm{m/s}$, mass flux in $\\mathrm{kg/(m^2\\cdot s)}$, momentum flux in $\\mathrm{N/m^2}$, and energy flux in $\\mathrm{W/m^2}$. Express all computed flux components in these $\\mathrm{SI}$ units. Angles are not used in this problem. Express any fractions or ratios as decimal numbers.\n\nDefine the following test suite of interface states, each as a tuple specifying $(\\rho_{L}, \\rho_{L}u_{L}, \\rho_{L}E_{L}, \\rho_{R}, \\rho_{R}u_{R}, \\rho_{R}E_{R}, \\gamma_m, p_{\\infty,m})$:\n- Test case $1$ (moderate, vapor-dominated mixture): $(\\rho_{L}, \\rho_{L}u_{L}, \\rho_{L}E_{L}) = (\\,5.0,\\,50.0,\\,500250.0\\,)$ and $(\\rho_{R}, \\rho_{R}u_{R}, \\rho_{R}E_{R}) = (\\,4.0,\\,0.0,\\,320000.0\\,)$ with $(\\gamma_m, p_{\\infty,m}) = (\\,1.30,\\,0.0\\,)$.\n- Test case $2$ (near-vacuum, supersonic left state): $(\\rho_{L}, \\rho_{L}u_{L}, \\rho_{L}E_{L}) = (\\,0.2,\\,60.0,\\,9600.0\\,)$ and $(\\rho_{R}, \\rho_{R}u_{R}, \\rho_{R}E_{R}) = (\\,0.1,\\,10.0,\\,700.0\\,)$ with $(\\gamma_m, p_{\\infty,m}) = (\\,1.33,\\,0.0\\,)$.\n- Test case $3$ (stiffened-gas mixture, liquid-dominated): $(\\rho_{L}, \\rho_{L}u_{L}, \\rho_{L}E_{L}) = (\\,100.0,\\,500.0,\\,10001250.0\\,)$ and $(\\rho_{R}, \\rho_{R}u_{R}, \\rho_{R}E_{R}) = (\\,120.0,\\,-600.0,\\,14401500.0\\,)$ with $(\\gamma_m, p_{\\infty,m}) = (\\,2.0,\\,1000000.0\\,)$.\n- Test case $4$ (symmetric equilibrium, zero velocity): $(\\rho_{L}, \\rho_{L}u_{L}, \\rho_{L}E_{L}) = (\\,1.0,\\,0.0,\\,100000.0\\,)$ and $(\\rho_{R}, \\rho_{R}u_{R}, \\rho_{R}E_{R}) = (\\,1.0,\\,0.0,\\,100000.0\\,)$ with $(\\gamma_m, p_{\\infty,m}) = (\\,1.30,\\,0.0\\,)$.\n\nYour program must compute, for each of the above test cases, the Rusanov numerical flux vector $\\mathbf{F}_{\\text{num}}$ at the interface, using the following steps for each side of the interface:\n1. Recover primitive variables from the conservative variables: $u = \\frac{\\rho u}{\\rho}$, $E = \\frac{\\rho E}{\\rho}$, $e = E - \\frac{1}{2}u^2$.\n2. Compute the pressure via the stiffened-gas mixture EOS: $p = (\\gamma_m - 1)\\rho e - \\gamma_m p_{\\infty,m}$.\n3. Compute the speed of sound: $c = \\sqrt{\\gamma_m \\frac{p + p_{\\infty,m}}{\\rho}}$.\n4. Compute the physical inviscid flux vector $\\mathbf{F}(\\mathbf{U}) = \\left(\\rho u,\\ \\rho u^2 + p,\\ u (\\rho E + p)\\right)$.\n5. Assemble the Rusanov flux: $\\mathbf{F}_{\\text{num}} = \\frac{1}{2}\\left(\\mathbf{F}(\\mathbf{U}_L) + \\mathbf{F}(\\mathbf{U}_R)\\right) - \\frac{1}{2}s_{\\max}\\left(\\mathbf{U}_R - \\mathbf{U}_L\\right)$, where $s_{\\max} = \\max\\left(|u_L| + c_L,\\ |u_R| + c_R\\right)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is itself a list of three decimal numbers corresponding to the mass, momentum, and energy components of $\\mathbf{F}_{\\text{num}}$ for the respective test case, in the order of test cases $1$ through $4$. For example, the output must have the form $[\\,[f_{1,1},f_{1,2},f_{1,3}],\\,[f_{2,1},f_{2,2},f_{2,3}],\\,[f_{3,1},f_{3,2},f_{3,3}],\\,[f_{4,1},f_{4,2},f_{4,3}]\\,]$, where each $f_{i,j}$ is a float in $\\mathrm{SI}$ units.",
            "solution": "The user has requested a solution to a computational fluid dynamics problem involving the implementation of a numerical flux for a homogeneous equilibrium model (HEM). The problem is deemed valid as it is scientifically grounded, well-posed, and complete.\n\n### 1. Theoretical Framework: Conservation Laws and Flux Vector\n\nThe foundation of the problem lies in the one-dimensional Euler equations, which express the conservation of mass, momentum, and energy for an inviscid, compressible fluid. For a homogeneous two-phase mixture treated as a single fluid, these equations are written in conservative form as:\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = \\mathbf{0}\n$$\nHere, $\\mathbf{U}$ is the vector of conserved variables and $\\mathbf{F}(\\mathbf{U})$ is the vector of corresponding physical fluxes.\n\nThe vector of conserved variables, $\\mathbf{U}$, is defined for the mixture as:\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho_m \\\\ \\rho_m u \\\\ \\rho_m E \\end{pmatrix}\n$$\nwhere $\\rho_m$ is the mixture density, $u$ is the mixture velocity, and $E$ is the mixture total specific energy.\n\nThe physical flux vector, $\\mathbf{F}(\\mathbf{U})$, is derived from the integral form of the conservation laws:\n1.  **Mass Conservation**: The flux of mass is the mass density multiplied by velocity, giving the mass flow rate per unit area.\n    $$F_1 = \\rho_m u$$\n2.  **Momentum Conservation**: The flux of momentum consists of two terms: the advective transport of momentum ($\\rho_m u^2$) and the force exerted by pressure ($p$).\n    $$F_2 = \\rho_m u^2 + p$$\n3.  **Energy Conservation**: The flux of total energy is the sum of the advective transport of total energy ($\\rho_m E u$) and the rate of work done by pressure forces ($p u$).\n    $$F_3 = (\\rho_m E) u + p u = u(\\rho_m E + p)$$\n\nCombining these components yields the complete inviscid flux vector:\n$$\n\\mathbf{F}(\\mathbf{U}) = \\begin{pmatrix} \\rho_m u \\\\ \\rho_m u^2 + p \\\\ u(\\rho_m E + p) \\end{pmatrix}\n$$\nThis matches the vector provided in the problem statement. The first component is the mass flux, the second is the momentum flux (pressure plus momentum transport), and the third is the energy flux.\n\n### 2. Thermodynamic Closure: Stiffened-Gas Equation of State\n\nTo solve the system, a closure relation is needed to connect the pressure $p$ to the conserved variables in $\\mathbf{U}$. The problem specifies a stiffened-gas mixture equation of state (EOS):\n$$\np = (\\gamma_m - 1)\\rho_m e - \\gamma_m p_{\\infty,m}\n$$\nwhere $e$ is the specific internal energy, $\\gamma_m$ is the mixture's ratio of specific heats, and $p_{\\infty,m}$ is the mixture's stiffening pressure constant. The total specific energy $E$ is the sum of the specific internal energy $e$ and the specific kinetic energy $\\frac{1}{2}u^2$:\n$$\nE = e + \\frac{1}{2}u^2 \\implies e = E - \\frac{1}{2}u^2\n$$\nThe speed of sound, $c$, consistent with this EOS, is given by:\n$$\nc = \\sqrt{\\gamma_m \\frac{p + p_{\\infty,m}}{\\rho_m}}\n$$\nThis thermodynamic closure allows all primitive variables ($u, p, e, c$) and the flux vector $\\mathbf{F}(\\mathbf{U})$ to be calculated from the conservative state vector $\\mathbf{U}$.\n\n### 3. Numerical Flux: The Rusanov Scheme\n\nIn a finite volume method, the continuous flux function $\\mathbf{F}(\\mathbf{U})$ at a cell interface (e.g., $x_{i+1/2}$) is replaced by a numerical flux function, $\\mathbf{F}_{\\text{num}}$, which depends on the states to the left ($\\mathbf{U}_L$) and right ($\\mathbf{U}_R$) of the interface. The problem specifies the Rusanov (or local Lax-Friedrichs) flux:\n$$\n\\mathbf{F}_{\\text{num}}(\\mathbf{U}_L, \\mathbf{U}_R) = \\frac{1}{2}\\left(\\mathbf{F}(\\mathbf{U}_L) + \\mathbf{F}(\\mathbf{U}_R)\\right) - \\frac{1}{2}s_{\\max}\\left(\\mathbf{U}_R - \\mathbf{U}_L\\right)\n$$\nThis scheme consists of an averaged flux term and a numerical dissipation term. The dissipation is scaled by $s_{\\max}$, the maximum characteristic wave speed at the interface. For the Euler equations, the characteristic speeds are $u-c$, $u$, and $u+c$. The maximum signal velocity propagating from the left and right states is given by:\n$$\ns_{\\max} = \\max\\left(|u_L| + c_L, |u_R| + c_R\\right)\n$$\n\n### 4. Algorithmic Procedure\n\nFor each test case, the Rusanov numerical flux is computed by following a precise sequence of steps:\n\n1.  **State Decomposition**: For each state (left and right), represented by the conservative vector $\\mathbf{U} = (U_1, U_2, U_3)^T$, the primitive variables are recovered:\n    *   $\\rho_m = U_1$\n    *   $u = U_2 / U_1$\n    *   $E = U_3 / U_1$\n\n2.  **Thermodynamic Calculation**: The thermodynamic properties are computed for each state:\n    *   Specific internal energy: $e = E - \\frac{1}{2}u^2$\n    *   Pressure: $p = (\\gamma_m - 1)\\rho_m e - \\gamma_m p_{\\infty,m}$\n    *   Speed of sound: $c = \\sqrt{\\gamma_m (p + p_{\\infty,m}) / \\rho_m}$\n\n3.  **Physical Flux Calculation**: The physical flux vector $\\mathbf{F}(\\mathbf{U})$ is computed for each state using the recovered variables:\n    *   $F_1 = \\rho_m u = U_2$\n    *   $F_2 = \\rho_m u^2 + p = U_2^2/U_1 + p$\n    *   $F_3 = u(\\rho_m E + p) = (U_2/U_1)(U_3 + p)$\n\n4.  **Rusanov Flux Assembly**: After computing properties for both left $(\\cdot)_L$ and right $(\\cdot)_R$ states:\n    *   The maximum wave speed $s_{\\max} = \\max\\left(|u_L| + c_L, |u_R| + c_R\\right)$ is determined.\n    *   The final numerical flux vector $\\mathbf{F}_{\\text{num}}$ is assembled using its definition, combining the physical fluxes $\\mathbf{F}_L$, $\\mathbf{F}_R$, conservative states $\\mathbf{U}_L$, $\\mathbf{U}_R$, and the wave speed $s_{\\max}$.\n\nThis procedure is implemented for each of the provided test cases to yield the required numerical flux vectors.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It computes the Rusanov numerical flux for each interface state and\n    prints the results in the specified format.\n    \"\"\"\n\n    # Test cases defined as tuples of:\n    # (rho_L, rhou_L, rhoE_L, rho_R, rhou_R, rhoE_R, gamma_m, p_inf_m)\n    test_cases = [\n        # Case 1: moderate, vapor-dominated mixture\n        (5.0, 50.0, 500250.0, 4.0, 0.0, 320000.0, 1.30, 0.0),\n        # Case 2: near-vacuum, supersonic left state\n        (0.2, 60.0, 9600.0, 0.1, 10.0, 700.0, 1.33, 0.0),\n        # Case 3: stiffened-gas mixture, liquid-dominated\n        (100.0, 500.0, 10001250.0, 120.0, -600.0, 14401500.0, 2.0, 1000000.0),\n        # Case 4: symmetric equilibrium, zero velocity\n        (1.0, 0.0, 100000.0, 1.0, 0.0, 100000.0, 1.30, 0.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        U_L = np.array([case[0], case[1], case[2]])\n        U_R = np.array([case[3], case[4], case[5]])\n        gamma_m = case[6]\n        p_inf_m = case[7]\n        \n        flux_vector = compute_rusanov_flux(U_L, U_R, gamma_m, p_inf_m)\n        results.append(flux_vector.tolist())\n\n    # Format the output string to match the required format \"[[...],[...],...]\"\n    # by converting the list of lists to a string and removing spaces.\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\ndef compute_state_properties(U, gamma_m, p_inf_m):\n    \"\"\"\n    Computes primitive variables, thermodynamic properties, and the physical flux\n    vector from a given conservative state vector U.\n\n    Args:\n        U (np.ndarray): Conservative state vector [rho, rho*u, rho*E].\n        gamma_m (float): Mixture ratio of specific heats.\n        p_inf_m (float): Mixture stiffening pressure.\n\n    Returns:\n        tuple: A tuple containing velocity (u), speed of sound (c), and\n               the physical flux vector F.\n    \"\"\"\n    rho = U[0]\n    rho_u = U[1]\n    rho_E = U[2]\n\n    # Avoid division by zero, although not expected for the given test cases.\n    if rho <= 0:\n        return 0.0, 0.0, np.zeros(3)\n\n    # 1. Recover primitive variables\n    u = rho_u / rho\n    E = rho_E / rho\n    e = E - 0.5 * u**2\n\n    # 2. Compute pressure from stiffened-gas EOS\n    p = (gamma_m - 1) * rho * e - gamma_m * p_inf_m\n\n    # 3. Compute speed of sound\n    # Ensure the argument of sqrt is non-negative\n    p_plus_pinf = p + p_inf_m\n    if p_plus_pinf < 0 or rho <= 0:\n        # This case indicates unphysical data\n        c = 0.0\n    else:\n        c = np.sqrt(gamma_m * p_plus_pinf / rho)\n\n    # 4. Compute physical inviscid flux vector F(U)\n    F = np.array([\n        rho_u,\n        rho_u * u + p,\n        u * (rho_E + p)\n    ])\n\n    return u, c, F\n\ndef compute_rusanov_flux(U_L, U_R, gamma_m, p_inf_m):\n    \"\"\"\n    Computes the Rusanov (local Lax-Friedrichs) numerical flux.\n\n    Args:\n        U_L (np.ndarray): Left conservative state vector.\n        U_R (np.ndarray): Right conservative state vector.\n        gamma_m (float): Mixture ratio of specific heats.\n        p_inf_m (float): Mixture stiffening pressure.\n\n    Returns:\n        np.ndarray: The Rusanov numerical flux vector.\n    \"\"\"\n    # Compute properties for left and right states\n    u_L, c_L, F_L = compute_state_properties(U_L, gamma_m, p_inf_m)\n    u_R, c_R, F_R = compute_state_properties(U_R, gamma_m, p_inf_m)\n\n    # 5. Assemble the Rusanov flux\n    # Compute maximum wave speed s_max\n    s_max = max(np.abs(u_L) + c_L, np.abs(u_R) + c_R)\n\n    # Compute Rusanov flux\n    F_num = 0.5 * (F_L + F_R) - 0.5 * s_max * (U_R - U_L)\n\n    return F_num\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}