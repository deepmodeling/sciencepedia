{
    "hands_on_practices": [
        {
            "introduction": "This first exercise grounds our understanding in the fundamental heat diffusion equation, exploring how to infer physical parameters from experimental data. You will practice deriving the temperature profile from the governing equation and then use a hypothetical set of measurements to back-calculate the heat generation rate, a common task in relating reactor power to fuel temperatures. Crucially, this practice  highlights the importance of material property models by having you analyze the bias introduced when assuming a constant thermal conductivity versus a more realistic temperature-dependent one.",
            "id": "4229728",
            "problem": "A solid cylindrical uranium dioxide (UO$_2$) fuel pellet of radius $R = 4.1 \\,\\mathrm{mm}$ operates under steady-state conditions with azimuthal symmetry and negligible axial gradients. The pellet experiences spatially uniform volumetric heat generation $\\;q'''$ due to fission. Instrumentation provides a measured centerline temperature $T_c = 1673 \\,\\mathrm{K}$ and a measured outer surface temperature $T_s = 1073 \\,\\mathrm{K}$ at the pellet radius $r = R$. Assume for the purpose of back-calculation that the thermal conductivity is constant and equal to $k_* = 4.0 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}}$ throughout the pellet.\n\nUsing the steady-state energy conservation in cylindrical coordinates and Fourier’s law of heat conduction, and enforcing symmetry at $r=0$ and the measured boundary condition at $r=R$, determine the effective volumetric heat generation $\\;q'''$ consistent with the measured temperatures under the constant-$k_*$ assumption. Express your final numerical answer in $\\mathrm{W\\, m^{-3}}$ and round to four significant figures.\n\nThen, discuss the bias introduced by the constant-$k_*$ back-calculation if the actual thermal conductivity depends on temperature according to $k(T) = A/T$ with $A = 4.0 \\times 10^3 \\,\\mathrm{W\\, m^{-1}}$. Starting from the same governing principles, show analytically how the value of $\\;q'''$ consistent with this $k(T)$ depends on $T_c$ and $T_s$, and compare it to the constant-$k_*$ inference by deriving a ratio that indicates the direction of bias for the given data. Do not provide an additional rounded numerical answer for this part; focus on the analytical relationship and its qualitative interpretation.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective. The givens are: a solid cylindrical fuel pellet of radius $R = 4.1 \\,\\mathrm{mm}$; steady-state, azimuthally symmetric heat transfer with negligible axial gradients, implying temperature $T$ is a function of radius $r$ only, $T(r)$; uniform volumetric heat generation $q'''$; a measured centerline temperature $T(0) = T_c = 1673 \\,\\mathrm{K}$; and a measured surface temperature $T(R) = T_s = 1073 \\,\\mathrm{K}$. For the first part of the problem, the thermal conductivity is assumed constant, $k_* = 4.0 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}}$. For the second part, it is given as temperature-dependent, $k(T) = A/T$ with $A = 4.0 \\times 10^3 \\,\\mathrm{W\\, m^{-1}}$. The problem is a standard exercise in heat conduction, employing established physical laws and providing consistent, physically plausible data. The problem is therefore deemed valid.\n\nWe proceed with the solution in two parts as requested.\n\nPart 1: Calculation of $q'''$ with Constant Thermal Conductivity\n\nThe governing equation for steady-state heat conduction in a cylinder with volumetric heat generation $q'''$ and constant thermal conductivity $k_*$ is the heat diffusion equation, which simplifies under the given symmetries to:\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dT}{dr} \\right) + \\frac{q'''}{k_*} = 0 $$\nThis is a second-order ordinary differential equation for the temperature profile $T(r)$. We can rearrange and integrate it with respect to the radius $r$:\n$$ \\frac{d}{dr} \\left( r \\frac{dT}{dr} \\right) = -\\frac{q''' r}{k_*} $$\nA first integration yields:\n$$ r \\frac{dT}{dr} = -\\frac{q''' r^2}{2k_*} + C_1 $$\nwhere $C_1$ is an integration constant. A physical boundary condition at the centerline ($r=0$) is that of symmetry, which implies the temperature gradient must be zero, $\\frac{dT}{dr}|_{r=0} = 0$. Applying this condition to the equation reveals that $C_1$ must be zero to avoid a singularity in the temperature gradient. The equation for the temperature gradient thus becomes:\n$$ \\frac{dT}{dr} = -\\frac{q''' r}{2k_*} $$\nIntegrating a second time with respect to $r$ gives the temperature profile:\n$$ T(r) = -\\frac{q''' r^2}{4k_*} + C_2 $$\nThe constant $C_2$ is determined using the measured centerline temperature, $T(0) = T_c$. At $r=0$, the equation gives $T(0) = C_2$, so $C_2 = T_c$. The temperature profile is therefore:\n$$ T(r) = T_c - \\frac{q''' r^2}{4k_*} $$\nThis parabolic temperature profile is characteristic of one-dimensional conduction with uniform heat generation. We now use the second measured temperature, at the pellet's outer surface, $T(R) = T_s$, to determine the unknown volumetric heat generation rate $q'''$:\n$$ T_s = T_c - \\frac{q''' R^2}{4k_*} $$\nSolving for $q'''$, we obtain the analytical expression for the heat generation rate under the constant-conductivity assumption, which we denote as $q'''_{const}$:\n$$ q'''_{const} = \\frac{4k_*(T_c - T_s)}{R^2} $$\nWe now substitute the provided numerical values into this expression. The radius must be converted to SI units: $R = 4.1 \\,\\mathrm{mm} = 4.1 \\times 10^{-3} \\,\\mathrm{m}$.\n$$ q'''_{const} = \\frac{4 (4.0 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}})(1673 \\,\\mathrm{K} - 1073 \\,\\mathrm{K})}{(4.1 \\times 10^{-3} \\,\\mathrm{m})^2} $$\n$$ q'''_{const} = \\frac{(16.0)(600)}{1.681 \\times 10^{-5}} \\,\\mathrm{W\\, m^{-3}} $$\n$$ q'''_{const} = \\frac{9600}{1.681 \\times 10^{-5}} \\,\\mathrm{W\\, m^{-3}} \\approx 5.710886 \\times 10^8 \\,\\mathrm{W\\, m^{-3}} $$\nRounding to four significant figures as required, the effective volumetric heat generation is $5.711 \\times 10^8 \\,\\mathrm{W\\, m^{-3}}$.\n\nPart 2: Bias Analysis with Temperature-Dependent Thermal Conductivity\n\nFor this part, the thermal conductivity $k(T)$ is a function of temperature. The steady-state heat diffusion equation must be written with the conductivity term inside the derivative:\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r k(T) \\frac{dT}{dr} \\right) + q''' = 0 $$\nIntegrating once with respect to $r$ gives:\n$$ r k(T) \\frac{dT}{dr} = -\\frac{q''' r^2}{2} + C_1 $$\nThe symmetry condition at $r=0$ requires the heat flux, $-k(T(0))\\frac{dT}{dr}|_{r=0}$, to be zero. As $k(T_c)$ is finite and non-zero, this again requires $\\frac{dT}{dr}|_{r=0}=0$, which sets the integration constant $C_1=0$. The equation becomes:\n$$ k(T) \\frac{dT}{dr} = -\\frac{q''' r}{2} $$\nThis is a separable differential equation. We rearrange and integrate from the centerline ($r=0$, $T=T_c$) to the pellet surface ($r=R$, $T=T_s$):\n$$ \\int_{T_c}^{T_s} k(T) dT = \\int_0^R -\\frac{q''' r}{2} dr $$\n$$ \\int_{T_c}^{T_s} k(T) dT = -\\frac{q''' R^2}{4} $$\nSolving for $q'''$, which we now denote $q'''_{var}$ to distinguish it from the constant-conductivity case:\n$$ q'''_{var} = \\frac{4}{R^2} \\int_{T_s}^{T_c} k(T) dT $$\nSubstituting the given form $k(T) = A/T$:\n$$ q'''_{var} = \\frac{4}{R^2} \\int_{T_s}^{T_c} \\frac{A}{T} dT = \\frac{4A}{R^2} [\\ln(T)]_{T_s}^{T_c} $$\n$$ q'''_{var} = \\frac{4A}{R^2} (\\ln(T_c) - \\ln(T_s)) = \\frac{4A}{R^2} \\ln\\left(\\frac{T_c}{T_s}\\right) $$\nThis is the analytical expression for the heat generation rate consistent with the temperature-dependent conductivity $k(T)$.\n\nTo assess the bias of the constant-$k_*$ assumption, we derive the ratio of the more-realistic $q'''_{var}$ to the simplified $q'''_{const}$:\n$$ \\frac{q'''_{var}}{q'''_{const}} = \\frac{\\frac{4A}{R^2} \\ln\\left(\\frac{T_c}{T_s}\\right)}{\\frac{4k_*(T_c - T_s)}{R^2}} = \\frac{A \\ln(T_c/T_s)}{k_*(T_c - T_s)} $$\nThis ratio determines the direction and magnitude of the bias. The bias is understood by comparing the assumed constant conductivity $k_*$ with the true effective average conductivity over the temperature range, $\\bar{k}$. The total heat conducted is proportional to the conductivity integral $\\int k(T) dT$. We have:\n$$ q'''_{var} \\propto \\int_{T_s}^{T_c} k(T) dT \\quad \\text{and} \\quad q'''_{const} \\propto k_*(T_c-T_s) = \\int_{T_s}^{T_c} k_* dT $$\nThe ratio simplifies to:\n$$ \\frac{q'''_{var}}{q'''_{const}} = \\frac{\\frac{1}{T_c-T_s}\\int_{T_s}^{T_c} k(T) dT}{k_*} = \\frac{\\bar{k}}{k_*} $$\nwhere $\\bar{k} = \\frac{1}{T_c-T_s}\\int_{T_s}^{T_c} k(T) dT$ is the mean thermal conductivity in the interval $[T_s, T_c]$.\nWith $k(T) = A/T$, the conductivity is a monotonically decreasing function of temperature. The actual conductivity is highest at the coolest point ($r=R$) and lowest at the hottest point ($r=0$). Let us evaluate the conductivity at the boundaries using $A = 4.0 \\times 10^3 \\,\\mathrm{W\\, m^{-1}}$:\n$$ k(T_s) = k(1073\\,\\mathrm{K}) = \\frac{4.0 \\times 10^3}{1073} \\approx 3.73 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}} $$\n$$ k(T_c) = k(1673\\,\\mathrm{K}) = \\frac{4.0 \\times 10^3}{1673} \\approx 2.39 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}} $$\nThe average conductivity $\\bar{k}$ must lie between these two values: $2.39 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}}  \\bar{k}  3.73 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}}$.\nThe constant conductivity used for the back-calculation was $k_* = 4.0 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}}$. This value is higher than the actual conductivity at any point within the fuel pellet, since $k_* > k(T_s) > k(T)$ for all $T \\in [T_s, T_c]$. Consequently, the assumed constant conductivity $k_*$ is greater than the true average conductivity $\\bar{k}$.\nSince $k_* > \\bar{k}$, the ratio $\\frac{\\bar{k}}{k_*}$ is less than $1$. This implies:\n$$ \\frac{q'''_{var}}{q'''_{const}}  1 \\implies q'''_{const} > q'''_{var} $$\nTherefore, the back-calculation using a constant thermal conductivity $k_*$ that is higher than the actual average conductivity results in an **overestimation** of the true volumetric heat generation rate. The model compensates for the assumed higher-than-actual thermal conductance by inferring a larger heat source $q'''$ to account for the observed large temperature difference ($T_c - T_s$).",
            "answer": "$$\\boxed{5.711 \\times 10^{8}}$$"
        },
        {
            "introduction": "Complex simulations are often made tractable by justifying the neglect of certain physical processes. This practice  introduces the powerful technique of time-scale analysis to assess the validity of a common simplification in fuel rod modeling: neglecting axial heat conduction during fast transients. By deriving and comparing the characteristic times for heat diffusion within the fuel and heat removal by coolant advection, you will develop the physical intuition required to construct efficient yet accurate reactor models.",
            "id": "4229762",
            "problem": "A fuel rod in a Light Water Reactor (LWR) undergoes a fast power ramp. To decide whether axial temperature transients inside the fuel can be neglected during this ramp, compare the characteristic time scale for axial heat conduction in the uranium dioxide fuel to the characteristic time scale for the coolant’s bulk thermal response dominated by advection through the heated core length. Treat properties as constant at the ramp conditions, and use physically plausible data.\n\nStarting from conservation of energy in the fuel and Fourier heat conduction, model axial heat transport in the fuel by the one-dimensional heat equation along the axial coordinate $z$:\n$$\n\\rho_{f} c_{p,f} \\frac{\\partial T_{f}}{\\partial t} = k_{f} \\frac{\\partial^{2} T_{f}}{\\partial z^{2}} + \\dot{q}'''(z,t),\n$$\nwhere $T_{f}$ is the fuel temperature, $\\rho_{f}$ is the fuel density, $c_{p,f}$ is the fuel specific heat capacity, $k_{f}$ is the fuel thermal conductivity, and $\\dot{q}'''$ is the volumetric heat generation rate. By introducing characteristic axial length scale $L_{z}$ and temperature scale $\\Delta T$, perform a time-scale (order-of-magnitude) analysis to obtain the axial conductive relaxation time in the fuel. For the coolant, start from conservation of energy for a control volume of flowing fluid in the heated length and use an advection-dominated approximation to obtain the coolant bulk thermal response time across the heated core length.\n\nUse the following data, which are representative of ramp conditions in pressurized water reactor fuel:\n- Fuel (uranium dioxide) thermal conductivity: $k_{f} = 2.5\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$.\n- Fuel density: $\\rho_{f} = 1.05 \\times 10^{4}\\ \\mathrm{kg\\,m^{-3}}$.\n- Fuel specific heat capacity: $c_{p,f} = 3.00 \\times 10^{2}\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$.\n- Axial characteristic length over which the power shape changes appreciably: $L_{z} = 0.30\\ \\mathrm{m}$.\n- Heated core length: $L_{\\text{core}} = 3.60\\ \\mathrm{m}$.\n- Coolant mean bulk speed in the channel: $u_{c} = 4.50\\ \\mathrm{m\\,s^{-1}}$.\n\nAssume axial heat conduction occurs within the fuel matrix only and neglect axial conduction in the cladding and across pellet interfaces. Also assume the coolant’s thermal response is dominated by axial advection and neglect axial heat diffusion in the fluid.\n\nCompute the dimensionless ratio $R$ of the axial fuel conduction time scale to the coolant thermal response time scale. Based on the magnitude of $R$, one can argue whether axial fuel transients are negligible during a fast ramp, but for this problem report only the ratio value. Round your answer to three significant figures and express it as a dimensionless number.",
            "solution": "The problem asks for the ratio of the characteristic time for axial heat conduction in a nuclear fuel rod to the characteristic time for coolant advection through the reactor core. This ratio is a crucial dimensionless parameter for assessing the importance of axial heat transport within the fuel during transients.\n\nFirst, we determine the characteristic time scale for axial heat conduction in the fuel, which we denote as $\\tau_{\\text{cond}}$. The problem provides the one-dimensional heat equation for the fuel temperature $T_{f}(z,t)$ along the axial coordinate $z$:\n$$\n\\rho_{f} c_{p,f} \\frac{\\partial T_{f}}{\\partial t} = k_{f} \\frac{\\partial^{2} T_{f}}{\\partial z^{2}} + \\dot{q}'''(z,t)\n$$\nHere, $\\rho_{f}$ is the fuel density, $c_{p,f}$ is the fuel specific heat capacity, $k_{f}$ is the fuel thermal conductivity, and $\\dot{q}'''$ is the volumetric heat generation rate.\n\nTo find the characteristic time for conductive relaxation, we perform an order-of-magnitude analysis on the terms governing thermal diffusion. We are interested in the time it takes for heat to conductively smooth out a temperature variation over a characteristic length. This process is described by the balance between the transient term (energy storage) and the conduction term (energy diffusion). The source term $\\dot{q}'''$ sets up the temperature profile but does not determine the rate of its relaxation via conduction.\n\nLet's introduce characteristic scales for the variables:\n-   Time: $t \\sim \\tau_{\\text{cond}}$\n-   Axial length: $z \\sim L_{z}$\n-   Temperature: $T_{f} \\sim \\Delta T$ (a characteristic temperature difference)\n\nThe terms in the heat equation can be approximated by their order of magnitude:\n-   Transient term: $\\rho_{f} c_{p,f} \\frac{\\partial T_{f}}{\\partial t} \\sim \\rho_{f} c_{p,f} \\frac{\\Delta T}{\\tau_{\\text{cond}}}$\n-   Conduction term: $k_{f} \\frac{\\partial^{2} T_{f}}{\\partial z^{2}} \\sim k_{f} \\frac{\\Delta T}{L_{z}^{2}}$\n\nThe conductive relaxation time, $\\tau_{\\text{cond}}$, is the time scale on which these two terms are of the same order of magnitude. Equating them gives:\n$$\n\\rho_{f} c_{p,f} \\frac{\\Delta T}{\\tau_{\\text{cond}}} \\sim k_{f} \\frac{\\Delta T}{L_{z}^{2}}\n$$\nSolving for $\\tau_{\\text{cond}}$ yields the expression for the axial conduction time scale:\n$$\n\\tau_{\\text{cond}} = \\frac{\\rho_{f} c_{p,f} L_{z}^{2}}{k_{f}}\n$$\nThis expression is characteristic of a diffusion process, often expressed in terms of the thermal diffusivity $\\alpha_{f} = k_{f} / (\\rho_{f} c_{p,f})$, such that $\\tau_{\\text{cond}} = L_{z}^{2} / \\alpha_{f}$.\n\nNext, we determine the characteristic time scale for the coolant's bulk thermal response, $\\tau_{\\text{adv}}$. The problem states that this response is dominated by advection. Advection is the transport of a substance or quantity, in this case thermal energy, by bulk fluid motion. The characteristic time is the time it takes for a fluid parcel to travel the relevant length of the system. For the bulk thermal response of the coolant as it flows through the core, the relevant length is the heated core length, $L_{\\text{core}}$, and the characteristic speed is the coolant's mean bulk speed, $u_{c}$.\nThus, the advection time scale is given by the simple kinematic relation:\n$$\n\\tau_{\\text{adv}} = \\frac{L_{\\text{core}}}{u_{c}}\n$$\n\nFinally, we compute the required dimensionless ratio, $R$, which is the ratio of the axial fuel conduction time scale to the coolant thermal response time scale:\n$$\nR = \\frac{\\tau_{\\text{cond}}}{\\tau_{\\text{adv}}}\n$$\nSubstituting the expressions for $\\tau_{\\text{cond}}$ and $\\tau_{\\text{adv}}$:\n$$\nR = \\frac{\\left(\\frac{\\rho_{f} c_{p,f} L_{z}^{2}}{k_{f}}\\right)}{\\left(\\frac{L_{\\text{core}}}{u_{c}}\\right)} = \\frac{\\rho_{f} c_{p,f} u_{c} L_{z}^{2}}{k_{f} L_{\\text{core}}}\n$$\n\nNow, we substitute the given numerical values into this expression for $R$:\n-   $\\rho_{f} = 1.05 \\times 10^{4}\\ \\mathrm{kg\\,m^{-3}}$\n-   $c_{p,f} = 3.00 \\times 10^{2}\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n-   $u_{c} = 4.50\\ \\mathrm{m\\,s^{-1}}$\n-   $L_{z} = 0.30\\ \\mathrm{m}$\n-   $k_{f} = 2.5\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n-   $L_{\\text{core}} = 3.60\\ \\mathrm{m}$\n\n$$\nR = \\frac{(1.05 \\times 10^{4}) \\times (3.00 \\times 10^{2}) \\times (4.50) \\times (0.30)^{2}}{(2.5) \\times (3.60)}\n$$\nLet's evaluate the numerator and denominator separately.\nNumerator:\n$$\n(1.05 \\times 10^{4}) \\times (300) \\times (4.50) \\times (0.09) = (1.05 \\times 3.00 \\times 4.50 \\times 0.09) \\times 10^{6} = 1.27575 \\times 10^{6}\n$$\nDenominator:\n$$\n2.5 \\times 3.60 = 9.0\n$$\nNow, we compute the ratio:\n$$\nR = \\frac{1.27575 \\times 10^{6}}{9.0} = 0.14175 \\times 10^{6} = 141750\n$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\nR \\approx 142000\n$$\nIn scientific notation, this is $1.42 \\times 10^{5}$.",
            "answer": "$$\\boxed{1.42 \\times 10^{5}}$$"
        },
        {
            "introduction": "This final capstone practice moves from analysis to implementation, challenging you to build a transient simulation that models the coupled thermo-mechanical behavior at the fuel-cladding interface. This phenomenon, where thermal expansion changes the gap size and contact pressure, is critical for predicting fuel performance and integrity. In this exercise , you will implement a nonlinear solver with an implicit time-stepping scheme and verify the code's energy conservation, bridging the gap between theoretical models and practical simulation tools.",
            "id": "4229721",
            "problem": "Consider a simplified, yet scientifically realistic, transient heat conduction model for a fuel pellet and cladding interface within a nuclear reactor fuel element. The interface contact area and the thermal contact conductance must evolve in time due to thermal expansion and changing mechanical interference. Starting from fundamental principles, derive and implement an algorithm that updates the contact area fraction and the contact conductance at each time step, solves the thermal state with an implicit scheme, and verifies energy conservation. Then use the algorithm to simulate the provided test suite and report the energy imbalance per case.\n\nUse the following context-appropriate fundamental base:\n- The local energy conservation statement for a lumped node: $C \\,\\dfrac{dT}{dt} = \\dot{Q}_{\\text{in}} - \\dot{Q}_{\\text{out}}$, where $C$ is the lumped heat capacity and $T$ is temperature in $\\mathrm{K}$.\n- Fourier’s law of conduction in a gap modeled as a plane layer: $\\dot{q} = k_g \\,\\dfrac{T_1 - T_2}{g}$, where $k_g$ is gas thermal conductivity in $\\mathrm{W/(m\\cdot K)}$ and $g$ is gap thickness in $\\mathrm{m}$.\n- Newton’s law of cooling for convective boundary: $\\dot{q} = h_{\\text{cool}}\\,(T - T_{\\text{cool}})$, with $h_{\\text{cool}}$ in $\\mathrm{W/(m^2\\cdot K)}$ and $T_{\\text{cool}}$ in $\\mathrm{K}$.\n- Linear thermal expansion for radii: $r_f(T_f) = r_{f0}\\,\\big(1 + \\alpha_f\\,(T_f - T_{\\text{ref}})\\big)$ and $r_{ci}(T_c) = r_{ci0}\\,\\big(1 + \\alpha_c\\,(T_c - T_{\\text{ref}})\\big)$, where $r_{f0}$ and $r_{ci0}$ are initial fuel and cladding inner radii in $\\mathrm{m}$, $\\alpha_f$ and $\\alpha_c$ are thermal expansion coefficients in $\\mathrm{K^{-1}}$, and $T_{\\text{ref}}$ is a reference temperature in $\\mathrm{K}$.\n- A plausible contact mechanics-inspired relation for Thermal Contact Conductance (TCC): $h_c = h_0\\,\\left(\\dfrac{p}{p_0}\\right)^m$ for $p  0$, and $h_c = 0$ for $p \\le 0$, where $p$ is an effective contact pressure in $\\mathrm{Pa}$, $h_0$ in $\\mathrm{W/(m^2\\cdot K)}$, $p_0$ in $\\mathrm{Pa}$, and $m$ is a dimensionless exponent. Use the simple pressure estimate $p = E_{\\text{eff}}\\,\\dfrac{\\delta}{r_{ci0}}$ for $\\delta  0$, with $\\delta = r_f - r_{ci}$ and $E_{\\text{eff}}$ an effective modulus in $\\mathrm{Pa}$; otherwise, $p = 0$.\n\nYou must not use any shortcut formulas beyond these fundamentals. The algorithmic derivation must start from the energy conservation and the constitutive laws stated above.\n\nSystem model:\n- Two thermal lumps represent the fuel near the interface and the cladding inner surface, with temperatures $T_f$ and $T_c$, and lumped heat capacities $C_f$ and $C_c$ in $\\mathrm{J/K}$.\n- The fuel experiences uniform internal power $\\dot{Q}_f$ in $\\mathrm{W}$.\n- The cladding loses heat to coolant at fixed temperature $T_{\\text{cool}}$ through convection with $h_{\\text{cool}}$ and exposed area $A_{\\text{cool}}$.\n- Heat transfer across the fuel–cladding interface is modeled by an effective interface coefficient $h_{\\text{int}}$ acting over a nominal cylindrical contact area $A$. The effective coefficient must reflect the evolving contact fraction and gap conduction:\n  $$h_{\\text{int}} = f_c\\,h_c + (1 - f_c)\\,h_{\\text{gap}},$$\n  where:\n  - $f_c$ is the contact area fraction, defined by the linearized closure rule $f_c = \\mathrm{clip}\\!\\left(\\dfrac{\\delta}{\\delta_0},\\,0,\\,1\\right)$, with $\\delta_0$ a roughness scale in $\\mathrm{m}$ and $\\mathrm{clip}(x,0,1)$ truncating $x$ to the interval $[0,1]$.\n  - $h_{\\text{gap}} = \\dfrac{k_g}{\\max(g,\\,g_{\\min})}$ with $g = \\max(r_{ci} - r_f,\\,0)$ the gap thickness in $\\mathrm{m}$ and $g_{\\min}$ a small regularization length in $\\mathrm{m}$.\n\nTime integration requirement:\n- Use backward (implicit) Euler with time step $\\Delta t$, updating $h_{\\text{int}}$ and $f_c$ self-consistently at each step via fixed-point iteration until convergence in temperatures.\n- The discrete equations for the fuel and cladding nodes must be solved simultaneously at each iteration using the current $h_{\\text{int}}$ estimate. Denote $n$ the time index, then:\n  $$C_f\\,\\dfrac{T_f^{n+1} - T_f^{n}}{\\Delta t} = \\dot{Q}_f^{n+1} - h_{\\text{int}}^{n+1}\\,A\\,(T_f^{n+1} - T_c^{n+1}),$$\n  $$C_c\\,\\dfrac{T_c^{n+1} - T_c^{n}}{\\Delta t} = h_{\\text{int}}^{n+1}\\,A\\,(T_f^{n+1} - T_c^{n+1}) - h_{\\text{cool}}\\,A_{\\text{cool}}\\,(T_c^{n+1} - T_{\\text{cool}}^{n+1}).$$\n\nEnergy balance verification:\n- For each time step, compute the scalar energy residual in $\\mathrm{J}$:\n  $$R^{n+1} = \\left|\\dot{Q}_f^{n+1}\\,\\Delta t - h_{\\text{cool}}\\,A_{\\text{cool}}\\,(T_c^{n+1} - T_{\\text{cool}}^{n+1})\\,\\Delta t - \\big(C_f\\,(T_f^{n+1} - T_f^{n}) + C_c\\,(T_c^{n+1} - T_c^{n})\\big)\\right|.$$\n- Report, for each test case, the maximum absolute energy residual over all time steps, in $\\mathrm{J}$.\n\nImplement a complete, runnable program that:\n- Iteratively updates $f_c$ and $h_c$ per the rules above, solves the implicit system at each time step, and verifies energy balance.\n- Uses the four test cases below and outputs their results in the exact required format.\n\nTest suite:\n- Case $1$ (moderate heating, evolving partial contact):\n  - $r_{f0} = 0.004\\,\\mathrm{m}$, $r_{ci0} = 0.0042\\,\\mathrm{m}$, $L = 0.01\\,\\mathrm{m}$, $A = 2\\pi\\,r_{f0}\\,L$.\n  - $C_f = 1500\\,\\mathrm{J/K}$, $C_c = 800\\,\\mathrm{J/K}$.\n  - $\\alpha_f = 1.0\\times 10^{-5}\\,\\mathrm{K^{-1}}$, $\\alpha_c = 1.2\\times 10^{-5}\\,\\mathrm{K^{-1}}$, $T_{\\text{ref}} = 300\\,\\mathrm{K}$.\n  - $T_{\\text{cool}} = 600\\,\\mathrm{K}$, $h_{\\text{cool}} = 4000\\,\\mathrm{W/(m^2\\cdot K)}$, $r_{co} = 0.00475\\,\\mathrm{m}$, $A_{\\text{cool}} = 2\\pi\\,r_{co}\\,L = 2.985\\times 10^{-4}\\,\\mathrm{m^2}$.\n  - $k_g = 0.1\\,\\mathrm{W/(m\\cdot K)}$, $\\delta_0 = 5.0\\times 10^{-5}\\,\\mathrm{m}$, $g_{\\min} = 1.0\\times 10^{-6}\\,\\mathrm{m}$.\n  - $E_{\\text{eff}} = 5.0\\times 10^{10}\\,\\mathrm{Pa}$, $h_0 = 1.0\\times 10^{4}\\,\\mathrm{W/(m^2\\cdot K)}$, $p_0 = 1.0\\times 10^{6}\\,\\mathrm{Pa}$, $m = 0.5$.\n  - $\\dot{Q}_f = 600\\,\\mathrm{W}$, $\\Delta t = 0.1\\,\\mathrm{s}$, $N = 50$ steps, initial $T_f^0 = 300\\,\\mathrm{K}$, $T_c^0 = 300\\,\\mathrm{K}$.\n- Case $2$ (large gap, no contact):\n  - Same as Case $1$ except $r_{ci0} = 0.005\\,\\mathrm{m}$ and $\\delta_0 = 1.0\\times 10^{-4}\\,\\mathrm{m}$.\n  - $\\dot{Q}_f = 600\\,\\mathrm{W}$, $\\Delta t = 0.1\\,\\mathrm{s}$, $N = 50$ steps, initial $T_f^0 = 300\\,\\mathrm{K}$, $T_c^0 = 300\\,\\mathrm{K}$.\n- Case $3$ (near-touch geometry, rapid full contact):\n  - $r_{f0} = 0.0042\\,\\mathrm{m}$, $r_{ci0} = 0.00422\\,\\mathrm{m}$, $L = 0.01\\,\\mathrm{m}$, $A = 2\\pi\\,r_{f0}\\,L$.\n  - $C_f = 1500\\,\\mathrm{J/K}$, $C_c = 800\\,\\mathrm{J/K}$.\n  - $\\alpha_f = 1.0\\times 10^{-5}\\,\\mathrm{K^{-1}}$, $\\alpha_c = 1.2\\times 10^{-5}\\,\\mathrm{K^{-1}}$, $T_{\\text{ref}} = 300\\,\\mathrm{K}$.\n  - $T_{\\text{cool}} = 600\\,\\mathrm{K}$, $h_{\\text{cool}} = 4000\\,\\mathrm{W/(m^2\\cdot K)}$, $r_{co} = 0.00475\\,\\mathrm{m}$, $A_{\\text{cool}} = 2.985\\times 10^{-4}\\,\\mathrm{m^2}$.\n  - $k_g = 0.1\\,\\mathrm{W/(m\\cdot K)}$, $\\delta_0 = 2.0\\times 10^{-5}\\,\\mathrm{m}$, $g_{\\min} = 1.0\\times 10^{-6}\\,\\mathrm{m}$.\n  - $E_{\\text{eff}} = 5.0\\times 10^{10}\\,\\mathrm{Pa}$, $h_0 = 1.0\\times 10^{4}\\,\\mathrm{W/(m^2\\cdot K)}$, $p_0 = 1.0\\times 10^{6}\\,\\mathrm{Pa}$, $m = 0.5$.\n  - $\\dot{Q}_f = 800\\,\\mathrm{W}$, $\\Delta t = 0.05\\,\\mathrm{s}$, $N = 100$ steps, initial $T_f^0 = 300\\,\\mathrm{K}$, $T_c^0 = 300\\,\\mathrm{K}$.\n- Case $4$ (small time step boundary check):\n  - Same geometry and properties as Case $1$.\n  - $\\dot{Q}_f = 300\\,\\mathrm{W}$, $\\Delta t = 1.0\\times 10^{-3}\\,\\mathrm{s}$, $N = 2000$ steps, initial $T_f^0 = 300\\,\\mathrm{K}$, $T_c^0 = 300\\,\\mathrm{K}$.\n\nFinal output format specification:\n- Your program should produce a single line of output containing the maximum absolute energy imbalance per test case, expressed in $\\mathrm{J}$, as a comma-separated list enclosed in square brackets. For example: $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$.",
            "solution": "The problem statement has been critically examined and is determined to be **valid**. It is a self-contained, scientifically grounded, and well-posed problem in computational heat transfer and contact mechanics, representative of simplified models used in nuclear reactor analysis. All necessary physical laws, constitutive models, parameters, and numerical requirements are provided. There are no internal contradictions or violations of fundamental principles. We may therefore proceed with the derivation and solution.\n\n### 1. Mathematical Model Formulation\n\nThe system consists of two lumped thermal masses: a fuel node ($f$) and a cladding node ($c$). Their thermal evolution is governed by a system of two coupled ordinary differential equations (ODEs) derived from the principle of local energy conservation, $C \\frac{dT}{dt} = \\dot{Q}_{\\text{in}} - \\dot{Q}_{\\text{out}}$.\n\nFor the fuel node, the energy balance is:\n$$C_f \\frac{dT_f}{dt} = \\dot{Q}_f - \\dot{Q}_{\\text{int}}$$\nwhere $C_f$ is the fuel heat capacity, $T_f$ is the fuel temperature, $\\dot{Q}_f$ is the internal heat generation rate, and $\\dot{Q}_{\\text{int}}$ is the rate of heat transfer across the fuel-cladding interface.\n\nFor the cladding node, the energy balance is:\n$$C_c \\frac{dT_c}{dt} = \\dot{Q}_{\\text{int}} - \\dot{Q}_{\\text{cool}}$$\nwhere $C_c$ is the cladding heat capacity, $T_c$ is the cladding temperature, and $\\dot{Q}_{\\text{cool}}$ is the rate of heat transfer from the cladding to the coolant.\n\nThe heat transfer rates are defined by the provided constitutive laws:\n- Interface heat transfer: $\\dot{Q}_{\\text{int}} = h_{\\text{int}} A (T_f - T_c)$, where $A$ is the nominal interface area and $h_{\\text{int}}$ is the effective interface heat transfer coefficient.\n- Coolant heat transfer: $\\dot{Q}_{\\text{cool}} = h_{\\text{cool}} A_{\\text{cool}} (T_c - T_{\\text{cool}})$, where $h_{\\text{cool}}$ is the convective heat transfer coefficient, $A_{\\text{cool}}$ is the cladding outer surface area, and $T_{\\text{cool}}$ is the bulk coolant temperature.\n\nSubstituting these into the energy balance equations yields the coupled system of ODEs:\n$$C_f \\frac{dT_f}{dt} = \\dot{Q}_f - h_{\\text{int}} A (T_f - T_c)$$\n$$C_c \\frac{dT_c}{dt} = h_{\\text{int}} A (T_f - T_c) - h_{\\text{cool}} A_{\\text{cool}} (T_c - T_{\\text{cool}})$$\n\n### 2. Numerical Discretization and Solution Scheme\n\nTo solve this system numerically, we employ the backward (implicit) Euler method with a time step $\\Delta t$. The time derivative is approximated as $\\frac{dT}{dt} \\approx \\frac{T^{n+1} - T^n}{\\Delta t}$, where superscripts denote the time step index. All other terms on the right-hand side are evaluated at the future time step, $n+1$, rendering the scheme implicit.\n\nThe discretized equations are:\n$$C_f \\frac{T_f^{n+1} - T_f^n}{\\Delta t} = \\dot{Q}_f - h_{\\text{int}}^{n+1} A (T_f^{n+1} - T_c^{n+1})$$\n$$C_c \\frac{T_c^{n+1} - T_c^n}{\\Delta t} = h_{\\text{int}}^{n+1} A (T_f^{n+1} - T_c^{n+1}) - h_{\\text{cool}} A_{\\text{cool}} (T_c^{n+1} - T_{\\text{cool}})$$\nNote that $\\dot{Q}_f$ and $T_{\\text{cool}}$ are assumed to be constant in time.\n\nTo solve for the unknown temperatures $T_f^{n+1}$ and $T_c^{n+1}$, we rearrange the equations into a linear system of the form $\\mathbf{M} \\mathbf{T}^{n+1} = \\mathbf{b}$.\n\nFrom the fuel equation:\n$$ \\left(\\frac{C_f}{\\Delta t} + h_{\\text{int}}^{n+1} A\\right) T_f^{n+1} - (h_{\\text{int}}^{n+1} A) T_c^{n+1} = \\frac{C_f}{\\Delta t} T_f^n + \\dot{Q}_f $$\n\nFrom the cladding equation:\n$$ -(h_{\\text{int}}^{n+1} A) T_f^{n+1} + \\left(\\frac{C_c}{\\Delta t} + h_{\\text{int}}^{n+1} A + h_{\\text{cool}} A_{\\text{cool}}\\right) T_c^{n+1} = \\frac{C_c}{\\Delta t} T_c^n + h_{\\text{cool}} A_{\\text{cool}} T_{\\text{cool}} $$\n\nThis can be written in matrix form as:\n$$\n\\begin{pmatrix}\n\\frac{C_f}{\\Delta t} + h_{\\text{int}}^{n+1} A  -h_{\\text{int}}^{n+1} A \\\\\n-h_{\\text{int}}^{n+1} A  \\frac{C_c}{\\Delta t} + h_{\\text{int}}^{n+1} A + h_{\\text{cool}} A_{\\text{cool}}\n\\end{pmatrix}\n\\begin{pmatrix} T_f^{n+1} \\\\ T_c^{n+1} \\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{C_f}{\\Delta t} T_f^n + \\dot{Q}_f \\\\\n\\frac{C_c}{\\Delta t} T_c^n + h_{\\text{cool}} A_{\\text{cool}} T_{\\text{cool}}\n\\end{pmatrix}\n$$\n\n### 3. Non-Linear Coupling and Fixed-Point Iteration\n\nThe system is non-linear because the interface conductance, $h_{\\text{int}}^{n+1}$, is a complex function of the unknown temperatures, $T_f^{n+1}$ and $T_c^{n+1}$. This dependency arises from thermal expansion, which modifies the geometry of the fuel-cladding gap and determines the state of mechanical contact.\n\nTo solve this non-linear system at each time step, we use a fixed-point iteration scheme. Let $k$ be the iteration index within a single time step.\n\n**Algorithm for Time Step $n+1$:**\n\n1.  **Initialization**: Set iteration counter $k = 0$. Initialize temperature guesses with values from the previous time step: $T_f^{(k)} = T_f^n$ and $T_c^{(k)} = T_c^n$.\n2.  **Iteration Loop**:\n    a.  **Update Geometry and Contact State**: Calculate all temperature-dependent quantities using $T_f^{(k)}$ and $T_c^{(k)}$:\n        -   Fuel outer radius: $r_f^{(k)} = r_{f0}(1 + \\alpha_f(T_f^{(k)} - T_{\\text{ref}}))$\n        -   Cladding inner radius: $r_{ci}^{(k)} = r_{ci0}(1 + \\alpha_c(T_c^{(k)} - T_{\\text{ref}}))$\n        -   Interference: $\\delta^{(k)} = r_f^{(k)} - r_{ci}^{(k)}$\n        -   Gap size: $g^{(k)} = \\max(r_{ci}^{(k)} - r_f^{(k)}, 0)$\n    b.  **Update Interface Conductance**: Based on the geometry, calculate the components of $h_{\\text{int}}$:\n        -   Gap conductance: $h_{\\text{gap}}^{(k)} = k_g / \\max(g^{(k)}, g_{\\min})$\n        -   Contact area fraction: $f_c^{(k)} = \\max(0, \\min(\\delta^{(k)} / \\delta_0, 1))$\n        -   If $\\delta^{(k)}  0$:\n            - Contact pressure: $p^{(k)} = E_{\\text{eff}} \\delta^{(k)} / r_{ci0}$\n            - Thermal contact conductance: $h_c^{(k)} = h_0 (p^{(k)}/p_0)^m$\n        -   Else:\n            - $h_c^{(k)} = 0$\n        -   Effective interface conductance: $h_{\\text{int}}^{(k)} = f_c^{(k)} h_c^{(k)} + (1 - f_c^{(k)}) h_{\\text{gap}}^{(k)}$\n    c.  **Solve Linear System**: Assemble the matrix $\\mathbf{M}$ using $h_{\\text{int}}^{(k)}$ and the constant vector $\\mathbf{b}$. Solve the linear system $\\mathbf{M} \\mathbf{T}^{(k+1)} = \\mathbf{b}$ for the next temperature iterates, $T_f^{(k+1)}$ and $T_c^{(k+1)}$.\n    d.  **Check for Convergence**: Compare the new temperatures with the previous ones. If $\\max(|T_f^{(k+1)} - T_f^{(k)}|, |T_c^{(k+1)} - T_c^{(k)}|)  \\epsilon_{\\text{tol}}$, where $\\epsilon_{\\text{tol}}$ is a small tolerance (e.g., $10^{-6}$), the iteration has converged. Set $T_f^{n+1} = T_f^{(k+1)}$, $T_c^{n+1} = T_c^{(k+1)}$, and exit the loop.\n    e.  **Continue Iteration**: If not converged, update the temperatures for the next iteration, $T_f^{(k+1)} \\to T_f^{(k)}$ and $T_c^{(k+1)} \\to T_c^{(k)}$, increment $k$, and return to step 2a. A maximum number of iterations is enforced to prevent infinite loops.\n\nThis entire process is repeated for each time step from $n=0$ to $N-1$.\n\n### 4. Energy Conservation Verification\n\nTo verify the correctness of the numerical implementation, we check the global energy balance at each time step. The net energy supplied to the system over $\\Delta t$ must equal the change in stored thermal energy. The energy residual, $R^{n+1}$, is defined as:\n$$ R^{n+1} = \\left| (\\dot{Q}_f \\Delta t) - (h_{\\text{cool}} A_{\\text{cool}} (T_c^{n+1} - T_{\\text{cool}}) \\Delta t) - (C_f (T_f^{n+1} - T_f^n) + C_c (T_c^{n+1} - T_c^n)) \\right| $$\nThis can be interpreted as $|\\text{Source} - \\text{Sink} - \\text{Storage}|$. By summing the two discretized governing equations, we can show that this residual should be analytically zero if the temperatures $(T_f^{n+1}, T_c^{n+1})$ are exact solutions. Any non-zero value arises from floating-point arithmetic errors in the numerical solver. Therefore, a small residual approaching machine precision provides strong evidence that the code correctly implements the discretized equations. The final reported value for each case will be the maximum value of $R^{n+1}$ observed throughout the simulation.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to define, run, and report results for all test cases.\n    \"\"\"\n\n    # Define test cases as a list of dictionaries.\n    test_cases = [\n        {\n            # Case 1: moderate heating, evolving partial contact\n            'r_f0': 0.004, 'r_ci0': 0.0042, 'L': 0.01,\n            'C_f': 1500.0, 'C_c': 800.0,\n            'alpha_f': 1.0e-5, 'alpha_c': 1.2e-5, 'T_ref': 300.0,\n            'T_cool': 600.0, 'h_cool': 4000.0, 'r_co': 0.00475, 'A_cool': 2.985e-4,\n            'k_g': 0.1, 'delta_0': 5.0e-5, 'g_min': 1.0e-6,\n            'E_eff': 5.0e10, 'h_0': 1.0e4, 'p_0': 1.0e6, 'm': 0.5,\n            'Q_f': 600.0, 'dt': 0.1, 'N': 50, 'T_f0': 300.0, 'T_c0': 300.0\n        },\n        {\n            # Case 2: large gap, no contact\n            'r_f0': 0.004, 'r_ci0': 0.005, 'L': 0.01, # Changed from Case 1\n            'C_f': 1500.0, 'C_c': 800.0,\n            'alpha_f': 1.0e-5, 'alpha_c': 1.2e-5, 'T_ref': 300.0,\n            'T_cool': 600.0, 'h_cool': 4000.0, 'r_co': 0.00475, 'A_cool': 2.985e-4,\n            'k_g': 0.1, 'delta_0': 1.0e-4, 'g_min': 1.0e-6, # Changed from Case 1\n            'E_eff': 5.0e10, 'h_0': 1.0e4, 'p_0': 1.0e6, 'm': 0.5,\n            'Q_f': 600.0, 'dt': 0.1, 'N': 50, 'T_f0': 300.0, 'T_c0': 300.0\n        },\n        {\n            # Case 3: near-touch geometry, rapid full contact\n            'r_f0': 0.0042, 'r_ci0': 0.00422, 'L': 0.01, # Changed\n            'C_f': 1500.0, 'C_c': 800.0,\n            'alpha_f': 1.0e-5, 'alpha_c': 1.2e-5, 'T_ref': 300.0,\n            'T_cool': 600.0, 'h_cool': 4000.0, 'r_co': 0.00475, 'A_cool': 2.985e-4,\n            'k_g': 0.1, 'delta_0': 2.0e-5, 'g_min': 1.0e-6, # Changed\n            'E_eff': 5.0e10, 'h_0': 1.0e4, 'p_0': 1.0e6, 'm': 0.5,\n            'Q_f': 800.0, 'dt': 0.05, 'N': 100, 'T_f0': 300.0, 'T_c0': 300.0 # Changed\n        },\n        {\n            # Case 4: small time step boundary check (same geometry as Case 1)\n            'r_f0': 0.004, 'r_ci0': 0.0042, 'L': 0.01,\n            'C_f': 1500.0, 'C_c': 800.0,\n            'alpha_f': 1.0e-5, 'alpha_c': 1.2e-5, 'T_ref': 300.0,\n            'T_cool': 600.0, 'h_cool': 4000.0, 'r_co': 0.00475, 'A_cool': 2.985e-4,\n            'k_g': 0.1, 'delta_0': 5.0e-5, 'g_min': 1.0e-6,\n            'E_eff': 5.0e10, 'h_0': 1.0e4, 'p_0': 1.0e6, 'm': 0.5,\n            'Q_f': 300.0, 'dt': 1.0e-3, 'N': 2000, 'T_f0': 300.0, 'T_c0': 300.0 # Changed\n        }\n    ]\n\n    results = [run_simulation(case) for case in test_cases]\n    \n    # Format the final output as specified.\n    print(f\"[{','.join(f'{r:.12e}' for r in results)}]\")\n\ndef run_simulation(params):\n    \"\"\"\n    Runs a single simulation case and returns the maximum energy residual.\n    \"\"\"\n    # Unpack parameters for clarity\n    r_f0, r_ci0, L = params['r_f0'], params['r_ci0'], params['L']\n    C_f, C_c = params['C_f'], params['C_c']\n    alpha_f, alpha_c, T_ref = params['alpha_f'], params['alpha_c'], params['T_ref']\n    T_cool, h_cool, A_cool = params['T_cool'], params['h_cool'], params['A_cool']\n    k_g, delta_0, g_min = params['k_g'], params['delta_0'], params['g_min']\n    E_eff, h_0, p_0, m = params['E_eff'], params['h_0'], params['p_0'], params['m']\n    Q_f, dt, N = params['Q_f'], params['dt'], params['N']\n    \n    # Calculate nominal interface area\n    A = 2.0 * np.pi * r_f0 * L\n\n    # Set up initial conditions and tracking variables\n    T_f, T_c = params['T_f0'], params['T_c0']\n    max_energy_residual = 0.0\n    \n    # Fixed-point iteration settings\n    tol = 1e-8\n    max_iter = 100\n\n    # Main time-stepping loop\n    for _ in range(N):\n        T_f_prev, T_c_prev = T_f, T_c\n        \n        # Fixed-point iteration for the current time step\n        T_f_k, T_c_k = T_f_prev, T_c_prev\n        \n        for k_iter in range(max_iter):\n            # 1. Update geometry and contact state based on T_k\n            r_f_k = r_f0 * (1.0 + alpha_f * (T_f_k - T_ref))\n            r_ci_k = r_ci0 * (1.0 + alpha_c * (T_c_k - T_ref))\n            \n            delta_k = r_f_k - r_ci_k\n            g_k = max(r_ci_k - r_f_k, 0.0)\n\n            # 2. Update interface conductance h_int\n            h_gap_k = k_g / max(g_k, g_min)\n            f_c_k = max(0.0, min(delta_k / delta_0, 1.0))\n            \n            if delta_k  0:\n                p_k = E_eff * delta_k / r_ci0\n                h_c_k = h_0 * (p_k / p_0)**m\n            else:\n                h_c_k = 0.0\n            \n            h_int_k = f_c_k * h_c_k + (1.0 - f_c_k) * h_gap_k\n\n            # 3. Assemble and solve the linear system M*T_k+1 = b\n            M = np.zeros((2, 2))\n            M[0, 0] = C_f / dt + h_int_k * A\n            M[0, 1] = -h_int_k * A\n            M[1, 0] = -h_int_k * A\n            M[1, 1] = C_c / dt + h_int_k * A + h_cool * A_cool\n            \n            b = np.zeros(2)\n            b[0] = C_f / dt * T_f_prev + Q_f\n            b[1] = C_c / dt * T_c_prev + h_cool * A_cool * T_cool\n\n            T_next = np.linalg.solve(M, b)\n            T_f_kp1, T_c_kp1 = T_next[0], T_next[1]\n            \n            # 4. Check for convergence\n            err_f = abs(T_f_kp1 - T_f_k)\n            err_c = abs(T_c_kp1 - T_c_k)\n            \n            T_f_k, T_c_k = T_f_kp1, T_c_kp1\n            \n            if max(err_f, err_c)  tol:\n                break\n        \n        # Update temperatures for the next time step\n        T_f, T_c = T_f_k, T_c_k\n        \n        # 5. Energy balance verification\n        energy_source = Q_f * dt\n        energy_sink = h_cool * A_cool * (T_c - T_cool) * dt\n        energy_storage = C_f * (T_f - T_f_prev) + C_c * (T_c - T_c_prev)\n        \n        residual = abs(energy_source - energy_sink - energy_storage)\n        if residual  max_energy_residual:\n            max_energy_residual = residual\n            \n    return max_energy_residual\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}