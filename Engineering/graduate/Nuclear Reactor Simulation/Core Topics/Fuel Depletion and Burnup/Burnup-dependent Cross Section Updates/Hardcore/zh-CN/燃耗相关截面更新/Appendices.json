{
    "hands_on_practices": [
        {
            "introduction": "燃耗相关截面更新的核心在于反应堆内同位素组分的动态演化。本练习将引导你从第一性原理出发，推导一个关键物理过程：裂变产物的累积如何改变宏观吸收截面。通过求解核素平衡方程，你将得出一个解析解，它量化了特定裂变产物（即反应堆“毒物”）对中子吸收的影响随燃耗的变化规律 。",
            "id": "4216435",
            "problem": "一个均匀的无限轻水反应堆(LWR)栅格在恒定的体积功率密度 $p_{0}$ 下运行，并且初始时不含稀土裂变产物。考虑一组指定的稀土裂变产物 $\\{i=1,\\dots,m\\}$，这些产物由裂变直接产生，每次裂变的独立产额为 $y_{i}$。每种产物 $i$ 的衰变常数为 $\\lambda_{i} \\ge 0$，在能量群 $g$ 中的分群微观吸收截面为 $\\sigma_{a,i,g}$，其中 $g$ 是固定的。假设如下：\n- 重金属质量密度为 $\\rho_{\\mathrm{HM}}$。\n- 每次裂变释放的能量为 $E_{f}$。\n- 稀土裂变产物仅由裂变直接产生，并且仅通过放射性衰变损耗（没有中子吸收移除或化学移除）。\n- 反应堆是均匀的，并且在所考虑的时间尺度上中子场是稳态的，因此产物生成在空间上是均匀的，且与 $p_{0}$ 成正比。\n- 在燃耗 $B=0$ 时，每种稀土产物 $i$ 的初始数密度为零。\n\n燃耗 $B$ 定义为 $B = \\int_{0}^{t} p(t') \\, dt' / \\rho_{\\mathrm{HM}}$，在恒定功率密度的假设下，这等于 $B = p_{0} t / \\rho_{\\mathrm{HM}}$。利用将裂变率密度与 $p_{0}$ 相关联的基本速率定义 $f = p_{0}/E_{f}$、第 $i$ 种产物的数量平衡方程，以及宏观吸收截面定义为各核素 $i$ 的数密度与微观截面之积的总和，推导仅由这些稀土裂变产物的累积引起的、依赖于燃耗的能量群 $g$ 中宏观吸收截面的变化量 $\\Delta \\Sigma_{a,g}(B)$ 的精确闭式表达式。\n\n将您的最终解析答案表示为 $B$ 和参数 $\\{y_{i}\\}$, $\\{\\lambda_{i}\\}$, $\\{\\sigma_{a,i,g}\\}$, $p_{0}$, $\\rho_{\\mathrm{HM}}$ 和 $E_{f}$ 的函数，通过在适当时解释表达式在 $\\lambda_{i} \\to 0$ 极限下的情况，使其适用于所有 $\\lambda_{i} \\ge 0$。不需要进行数值计算。结果以 $m^{-1}$ 为单位表示。最终答案必须是单一的闭式表达式。",
            "solution": "首先根据指定标准对问题进行验证。\n\n**步骤1：提取已知条件**\n- 系统：一个均匀的无限轻水反应堆(LWR)栅格。\n- 运行条件：恒定的体积功率密度，$p_{0}$。\n- 裂变产物：一组 $m$ 种稀土产物，由 $i=1,\\dots,m$ 索引。\n- 初始条件：在燃耗 $B=0$（对应于时间 $t=0$）时，每种产物 $i$ 的数密度为零。\n- 生成机制：产物由裂变直接产生，每次裂变的独立产额为 $y_{i}$。\n- 损耗机制：产物仅通过放射性衰变损耗，衰变常数为 $\\lambda_{i} \\ge 0$。明确排除了中子吸收移除。\n- 材料属性：重金属质量密度为 $\\rho_{\\mathrm{HM}}$。\n- 物理常数：每次裂变释放的能量为 $E_{f}$。\n- 截面：产物 $i$ 在能量群 $g$ 中的微观吸收截面为 $\\sigma_{a,i,g}$，其中 $g$ 是固定的。\n- 反应堆模型：反应堆是均匀的，且中子场是稳态的，这意味着产物生成速率在空间上是均匀且恒定的。\n- 定义：\n    - 燃耗：$B = \\int_{0}^{t} p(t') \\, dt' / \\rho_{\\mathrm{HM}}$。对于恒定功率 $p_0$，这简化为 $B = p_{0} t / \\rho_{\\mathrm{HM}}$。\n    - 裂变率密度：$f = p_{0}/E_{f}$。\n    - 宏观吸收截面：各核素 $i$ 的数密度 $N_i$ 和微观截面 $\\sigma_{a,i,g}$ 乘积的总和。\n- 目标：推导能量群 $g$ 中宏观吸收截面的依赖于燃耗的变化量 $\\Delta \\Sigma_{a,g}(B)$ 的精确闭式表达式。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于核反应堆物理学原理，特别是裂变产物中毒和反应堆动力学理论。所有术语、变量和概念都是该领域的标准用法。\n- **适定性：** 这是一个适定问题。它提供了明确的目标、一组完整的初始条件（$N_i(t=0)=0$），以及求解每个核素的数密度并随后计算宏观截面变化所需的所有物理量和关系。恒定功率和仅通过衰变损耗等假设使问题在解析上易于处理，并且没有引入模糊性。存在唯一解。\n- **客观性：** 问题陈述使用精确、客观和定量的语言，没有任何主观或偏见的成分。\n\n该问题没有表现出任何列出的缺陷（例如，科学上不健全、不完整、矛盾等）。这是反应堆物理学中一个标准的可解问题。\n\n**步骤3：结论与行动**\n问题有效。将推导解答。\n\n**推导**\n\n问题的核心是确定每种稀土裂变产物 $i$ 的数密度 $N_i(t)$ 作为时间 $t$ 的函数，然后将其表示为燃耗 $B$ 的函数，以计算宏观吸收截面的变化。\n\n核素 $i$ 的数量平衡由一个一阶常微分方程描述：\n$$ \\frac{dN_i(t)}{dt} = (\\text{Rate of production of } i) - (\\text{Rate of loss of } i) $$\n\n单位体积的生成速率是裂变率密度 $f$ 和核素 $i$ 的裂变产额 $y_i$ 的乘积。问题陈述，裂变率密度通过 $f = p_0 / E_f$ 与恒定的体积功率密度 $p_0$ 和每次裂变能量 $E_f$ 相关。因此，生成速率是一个常数，即 $y_i p_0 / E_f$。\n\n单位体积的损耗速率仅由放射性衰变引起。这由衰变常数 $\\lambda_i$ 和数密度 $N_i(t)$ 的乘积给出。\n\n结合这些项，核素 $i$ 的数密度微分方程为：\n$$ \\frac{dN_i(t)}{dt} = \\frac{y_i p_0}{E_f} - \\lambda_i N_i(t) $$\n这是一个线性一阶微分方程。我们可以将其重新排列为标准形式：\n$$ \\frac{dN_i(t)}{dt} + \\lambda_i N_i(t) = \\frac{y_i p_0}{E_f} $$\n问题中陈述的初始条件是 $N_i(t=0) = 0$。\n\n我们考虑衰变常数 $\\lambda_i$ 的两种情况。\n\n情况1：$\\lambda_i > 0$。\n该微分方程的通解可以使用积分因子 $I(t) = \\exp(\\int \\lambda_i dt) = \\exp(\\lambda_i t)$ 求得。将方程乘以 $I(t)$ 得到：\n$$ \\exp(\\lambda_i t) \\frac{dN_i(t)}{dt} + \\lambda_i \\exp(\\lambda_i t) N_i(t) = \\frac{y_i p_0}{E_f} \\exp(\\lambda_i t) $$\n左边是乘积的导数：\n$$ \\frac{d}{dt} \\left( N_i(t) \\exp(\\lambda_i t) \\right) = \\frac{y_i p_0}{E_f} \\exp(\\lambda_i t) $$\n对两边关于 $t$ 积分：\n$$ N_i(t) \\exp(\\lambda_i t) = \\int \\frac{y_i p_0}{E_f} \\exp(\\lambda_i t) dt = \\frac{y_i p_0}{E_f \\lambda_i} \\exp(\\lambda_i t) + C $$\n其中 $C$ 是积分常数。求解 $N_i(t)$：\n$$ N_i(t) = \\frac{y_i p_0}{E_f \\lambda_i} + C \\exp(-\\lambda_i t) $$\n使用初始条件 $N_i(0)=0$：\n$$ N_i(0) = 0 = \\frac{y_i p_0}{E_f \\lambda_i} + C \\exp(0) \\implies C = -\\frac{y_i p_0}{E_f \\lambda_i} $$\n将 $C$ 的值代回 $N_i(t)$ 的解中：\n$$ N_i(t) = \\frac{y_i p_0}{E_f \\lambda_i} - \\frac{y_i p_0}{E_f \\lambda_i} \\exp(-\\lambda_i t) = \\frac{y_i p_0}{E_f \\lambda_i} \\left( 1 - \\exp(-\\lambda_i t) \\right) $$\n\n情况2：$\\lambda_i = 0$（稳定核素）。\n微分方程简化为：\n$$ \\frac{dN_i(t)}{dt} = \\frac{y_i p_0}{E_f} $$\n对 $t$ 积分并应用初始条件 $N_i(0)=0$：\n$$ N_i(t) = \\int_{0}^{t} \\frac{y_i p_0}{E_f} dt' = \\frac{y_i p_0}{E_f} t $$\n值得注意的是，$\\lambda_i=0$ 情况的解可以通过对 $\\lambda_i > 0$ 的解取 $\\lambda_i \\to 0$ 的极限得到，使用对小 $x$ 的泰勒展开 $\\exp(-x) \\approx 1-x$ 或 L'Hôpital's rule。\n$$ \\lim_{\\lambda_i \\to 0} \\frac{y_i p_0}{E_f} \\frac{1 - \\exp(-\\lambda_i t)}{\\lambda_i} = \\frac{y_i p_0}{E_f} \\lim_{\\lambda_i \\to 0} \\frac{t \\exp(-\\lambda_i t)}{1} = \\frac{y_i p_0}{E_f} t $$\n因此，当对 $\\lambda_i=0$ 取极限时，$\\lambda_i>0$ 的表达式适用于所有 $\\lambda_i \\ge 0$。\n\n接下来，我们将时间变量 $t$ 表示为燃耗 $B$ 的函数。问题定义了 $B = p_0 t / \\rho_{\\mathrm{HM}}$。重新整理求解 $t$ 可得：\n$$ t = \\frac{B \\rho_{\\mathrm{HM}}}{p_0} $$\n将此代入 $N_i(t)$ 的通式中得到 $N_i(B)$：\n$$ N_i(B) = \\frac{y_i p_0}{E_f \\lambda_i} \\left( 1 - \\exp\\left(-\\lambda_i \\frac{B \\rho_{\\mathrm{HM}}}{p_0}\\right) \\right) $$\n\n能量群 $g$ 中宏观吸收截面的变化量 $\\Delta \\Sigma_{a,g}(B)$ 是燃耗为 $B$ 时的宏观截面与燃耗为 $B=0$ 时的宏观截面之差。\n$$ \\Delta \\Sigma_{a,g}(B) = \\Sigma_{a,g}(B) - \\Sigma_{a,g}(0) $$\n任意燃耗下的宏观截面是所有 $m$ 种裂变产物贡献的总和：\n$$ \\Sigma_{a,g}(B) = \\sum_{i=1}^{m} N_i(B) \\sigma_{a,i,g} $$\n在燃耗 $B=0$ 时，数密度为 $N_i(0)=0$，所以 $\\Sigma_{a,g}(0) = 0$。\n因此，变化量就是 $\\Delta \\Sigma_{a,g}(B) = \\Sigma_{a,g}(B)$。\n$$ \\Delta \\Sigma_{a,g}(B) = \\sum_{i=1}^{m} N_i(B) \\sigma_{a,i,g} $$\n代入 $N_i(B)$ 的表达式：\n$$ \\Delta \\Sigma_{a,g}(B) = \\sum_{i=1}^{m} \\sigma_{a,i,g} \\left[ \\frac{y_i p_0}{E_f \\lambda_i} \\left( 1 - \\exp\\left(-\\lambda_i \\frac{B \\rho_{\\mathrm{HM}}}{p_0}\\right) \\right) \\right] $$\n重新整理各项以组合常数，得到最终的闭式表达式：\n$$ \\Delta \\Sigma_{a,g}(B) = \\frac{p_0}{E_f} \\sum_{i=1}^{m} \\frac{y_i \\sigma_{a,i,g}}{\\lambda_i} \\left( 1 - \\exp\\left(-\\frac{\\lambda_i \\rho_{\\mathrm{HM}}}{p_0} B \\right) \\right) $$\n此表达式对所有 $\\lambda_i \\ge 0$ 均有效，但需要理解的是，对于任何 $\\lambda_i = 0$ 的项，表达式 $\\frac{1}{\\lambda_i} \\left( 1 - \\exp\\left(-\\frac{\\lambda_i \\rho_{\\mathrm{HM}}}{p_0} B \\right) \\right)$ 应被其极限值 $\\frac{\\rho_{\\mathrm{HM}}}{p_0} B$ 替代。\n这给出了稳定核素的贡献为 $\\frac{p_0}{E_f} y_i \\sigma_{a,i,g} \\frac{\\rho_{\\mathrm{HM}}}{p_0} B = \\frac{y_i \\sigma_{a,i,g} \\rho_{\\mathrm{HM}}}{E_f} B$，这与从 $N_i(B) = \\frac{y_i B \\rho_{\\mathrm{HM}}}{E_f}$ 直接计算的结果相匹配。\n根据要求，给出了最终的单一表达式，其中隐含了对任何 $\\lambda_i=0$ 情况的极限解释。",
            "answer": "$$ \\boxed{ \\frac{p_0}{E_f} \\sum_{i=1}^{m} \\frac{y_i \\sigma_{a,i,g}}{\\lambda_i} \\left( 1 - \\exp\\left(-\\frac{\\lambda_i \\rho_{\\mathrm{HM}}}{p_0} B \\right) \\right) } $$"
        },
        {
            "introduction": "在认识到截面会随燃耗变化后，一个核心的实际问题是如何在数值模拟中有效处理这种变化。本练习聚焦于燃耗步长的自适应控制，这是平衡计算精度与效率的关键技术。你将基于截面相对于燃耗的变化率，构建一个准则来确定最大允许的燃耗增量，以确保关键反应截面的相对变化保持在预设的容差范围内 。",
            "id": "4216393",
            "problem": "考虑一个用于燃耗相关输运计算的双能群、无限均匀反应堆模型。设燃耗（定义为每单位重金属质量产生的能量）为 $B(t)$，其基本定义为 $B(t) = \\int_{0}^{t} P_{\\mathrm{th}}(\\tau)/M_{\\mathrm{HM}} \\, \\mathrm{d}\\tau$，其中 $P_{\\mathrm{th}}$ 是热功率，$M_{\\mathrm{HM}}$ 是重金属(HM)质量。能群 $g$ 中反应类型 $x$ 的宏观截面 $\\Sigma_{x,g}(B)$ 是燃耗的函数，因为核素密度会根据嬗变和损耗而演化。对于一个小的燃耗增量 $\\Delta B$，假设每个截面的一阶线性化为 $\\Delta \\Sigma_{x,g} \\approx \\left(\\partial \\Sigma_{x,g}/\\partial B\\right) \\Delta B$。\n\n为了在自适应时间步长（燃耗步长）方案中确保数值稳定性和物理保真度，需要将每个燃耗步中各关键宏观截面的相对变化约束在指定的容差以下。具体而言，对受监测的反应集合 $x \\in \\{a, f, s\\}$ （吸收、裂变和散射）和能群集合 $g \\in \\{1,2\\}$ 施加约束 $|\\Delta \\Sigma_{x,g}|/\\Sigma_{x,g} \\leq \\varepsilon_{x,g}$，容差为 $\\varepsilon_{a,1}=\\varepsilon_{a,2}=\\varepsilon_{f,2}=0.010$ 和 $\\varepsilon_{s,1\\rightarrow 2}=0.005$。\n\n在当前燃耗 $B_{0}$ 处，测量得到以下宏观截面及其燃耗导数（在 $B_{0}$ 处计算）：\n- 快能群吸收：$\\Sigma_{a,1}(B_{0}) = 0.015 \\ \\mathrm{cm}^{-1}$ 且 $\\partial \\Sigma_{a,1}/\\partial B \\big|_{B_{0}} = 1.2 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$。\n- 热能群吸收：$\\Sigma_{a,2}(B_{0}) = 0.095 \\ \\mathrm{cm}^{-1}$ 且 $\\partial \\Sigma_{a,2}/\\partial B \\big|_{B_{0}} = 3.5 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$。\n- 热能群裂变：$\\Sigma_{f,2}(B_{0}) = 0.025 \\ \\mathrm{cm}^{-1}$ 且 $\\partial \\Sigma_{f,2}/\\partial B \\big|_{B_{0}} = -2.0 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$。\n- 从快能群到热能群的降散射：$\\Sigma_{s,1\\rightarrow 2}(B_{0}) = 0.200 \\ \\mathrm{cm}^{-1}$ 且 $\\partial \\Sigma_{s,1\\rightarrow 2}/\\partial B \\big|_{B_{0}} = -1.0 \\times 10^{-5} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$。\n\n从上述基本定义出发，推导一个自适应燃耗步长准则，以保证在单个步长内，所有受监测的 $x,g$ 都满足 $|\\Delta \\Sigma_{x,g}|/\\Sigma_{x,g} \\leq \\varepsilon_{x,g}$。使用此准则，根据给定数据计算在 $B_{0}$ 处的最大允许燃耗增量 $\\Delta B_{\\max}$。\n\n将最终的 $\\Delta B_{\\max}$ 四舍五入至四位有效数字。以 $\\mathrm{MWd}/\\mathrm{kgHM}$ 为单位表示 $\\Delta B_{\\max}$。",
            "solution": "首先验证问题，以确保其内容完整、有科学依据且适定。\n\n**第1步：提取已知条件**\n- 燃耗定义：$B(t) = \\int_{0}^{t} \\frac{P_{\\mathrm{th}}(\\tau)}{M_{\\mathrm{HM}}} \\, \\mathrm{d}\\tau$\n- 截面变化线性化：$\\Delta \\Sigma_{x,g} \\approx \\left(\\frac{\\partial \\Sigma_{x,g}}{\\partial B}\\right) \\Delta B$\n- 约束条件：$\\frac{|\\Delta \\Sigma_{x,g}|}{\\Sigma_{x,g}} \\leq \\varepsilon_{x,g}$，针对受监测的反应。\n- 容差：$\\varepsilon_{a,1}=0.010$, $\\varepsilon_{a,2}=0.010$, $\\varepsilon_{f,2}=0.010$, $\\varepsilon_{s,1\\rightarrow 2}=0.005$。\n- 燃耗 $B_0$ 处的数据：\n  - $\\Sigma_{a,1}(B_{0}) = 0.015 \\ \\mathrm{cm}^{-1}$\n  - $\\frac{\\partial \\Sigma_{a,1}}{\\partial B} \\big|_{B_{0}} = 1.2 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$\n  - $\\Sigma_{a,2}(B_{0}) = 0.095 \\ \\mathrm{cm}^{-1}$\n  - $\\frac{\\partial \\Sigma_{a,2}}{\\partial B} \\big|_{B_{0}} = 3.5 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$\n  - $\\Sigma_{f,2}(B_{0}) = 0.025 \\ \\mathrm{cm}^{-1}$\n  - $\\frac{\\partial \\Sigma_{f,2}}{\\partial B} \\big|_{B_{0}} = -2.0 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$\n  - $\\Sigma_{s,1\\rightarrow 2}(B_{0}) = 0.200 \\ \\mathrm{cm}^{-1}$\n  - $\\frac{\\partial \\Sigma_{s,1\\rightarrow 2}}{\\partial B} \\big|_{B_{0}} = -1.0 \\times 10^{-5} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$\n\n**第2步：验证**\n- 该问题具有科学依据，描述了反应堆物理中用于燃耗计算的一种标准数值技术。\n- 该问题是适定的，目标明确，且有足够信息来确定唯一解。\n- 数据在物理上是合理的，量纲上也是一致的。\n- 不存在逻辑矛盾、歧义或事实错误。\n\n**第3步：结论**\n该问题有效。下面将进行推导求解。\n\n**推导与求解**\n核心要求是在一个燃耗步长 $\\Delta B$ 内，限制每个受监测的宏观截面 $\\Sigma_{x,g}$ 的相对变化。对于能群 $g$ 中的每种反应类型 $x$，约束条件如下：\n$$\n\\frac{|\\Delta \\Sigma_{x,g}|}{\\Sigma_{x,g}(B_0)} \\leq \\varepsilon_{x,g}\n$$\n问题指定使用一阶泰勒展开来近似小燃耗增量 $\\Delta B$ 内的变化 $\\Delta \\Sigma_{x,g}$：\n$$\n\\Delta \\Sigma_{x,g} \\approx \\left. \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\right|_{B_0} \\Delta B\n$$\n将此近似代入约束不等式，可得：\n$$\n\\frac{\\left| \\left. \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\right|_{B_0} \\Delta B \\right|}{\\Sigma_{x,g}(B_0)} \\leq \\varepsilon_{x,g}\n$$\n由于燃耗增量 $\\Delta B$ 必须为正，我们可以写成 $|\\Delta B| = \\Delta B$。然后可以重新整理该不等式，以求解该特定截面所允许的最大 $\\Delta B$，我们将其记为 $\\Delta B_{x,g}$：\n$$\n\\Delta B \\frac{\\left| \\left. \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\right|_{B_0} \\right|}{\\Sigma_{x,g}(B_0)} \\leq \\varepsilon_{x,g} \\implies \\Delta B \\leq \\frac{\\varepsilon_{x,g} \\Sigma_{x,g}(B_0)}{\\left| \\left. \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\right|_{B_0} \\right|}\n$$\n因此，对于每个受监测的截面 $(x,g)$，最大允许燃耗步长由下式给出：\n$$\n\\Delta B_{x,g} = \\frac{\\varepsilon_{x,g} \\Sigma_{x,g}(B_0)}{\\left| \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\Big|_{B_0} \\right|}\n$$\n这是单个截面的自适应燃耗步长准则。为确保所有约束同时得到满足，总体的最大允许燃耗增量 $\\Delta B_{\\max}$ 必须是为所有受监测反应计算出的各个步长中的最小值。\n$$\n\\Delta B_{\\max} = \\min_{x,g \\in \\text{monitored}} \\left\\{ \\Delta B_{x,g} \\right\\}\n$$\n现在我们使用所提供的数据，为四种指定情况分别计算 $\\Delta B_{x,g}$。$\\Sigma$ 的单位（$\\mathrm{cm}^{-1}$）与导数中分子部分的单位（$\\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})$）相消，最终得到 $\\Delta B$ 的单位为 $\\mathrm{MWd}/\\mathrm{kgHM}$，符合要求。\n\n1.  快能群吸收 ($x=a, g=1$):\n    $$\n    \\Delta B_{a,1} = \\frac{\\varepsilon_{a,1} \\Sigma_{a,1}(B_0)}{\\left| \\frac{\\partial \\Sigma_{a,1}}{\\partial B} \\big|_{B_0} \\right|} = \\frac{0.010 \\times 0.015 \\ \\mathrm{cm}^{-1}}{|1.2 \\times 10^{-4} \\ \\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})|} = \\frac{1.5 \\times 10^{-4}}{1.2 \\times 10^{-4}} \\ \\mathrm{MWd}/\\mathrm{kgHM} = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n    $$\n2.  热能群吸收 ($x=a, g=2$):\n    $$\n    \\Delta B_{a,2} = \\frac{\\varepsilon_{a,2} \\Sigma_{a,2}(B_0)}{\\left| \\frac{\\partial \\Sigma_{a,2}}{\\partial B} \\big|_{B_0} \\right|} = \\frac{0.010 \\times 0.095 \\ \\mathrm{cm}^{-1}}{|3.5 \\times 10^{-4} \\ \\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})|} = \\frac{9.5 \\times 10^{-4}}{3.5 \\times 10^{-4}} \\ \\mathrm{MWd}/\\mathrm{kgHM} \\approx 2.7143 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n    $$\n3.  热能群裂变 ($x=f, g=2$):\n    $$\n    \\Delta B_{f,2} = \\frac{\\varepsilon_{f,2} \\Sigma_{f,2}(B_0)}{\\left| \\frac{\\partial \\Sigma_{f,2}}{\\partial B} \\big|_{B_0} \\right|} = \\frac{0.010 \\times 0.025 \\ \\mathrm{cm}^{-1}}{|-2.0 \\times 10^{-4} \\ \\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})|} = \\frac{2.5 \\times 10^{-4}}{2.0 \\times 10^{-4}} \\ \\mathrm{MWd}/\\mathrm{kgHM} = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n    $$\n4.  从快能群到热能群的降散射 ($x=s, g=1\\rightarrow 2$):\n    $$\n    \\Delta B_{s,1\\rightarrow 2} = \\frac{\\varepsilon_{s,1\\rightarrow 2} \\Sigma_{s,1\\rightarrow 2}(B_0)}{\\left| \\frac{\\partial \\Sigma_{s,1\\rightarrow 2}}{\\partial B} \\big|_{B_0} \\right|} = \\frac{0.005 \\times 0.200 \\ \\mathrm{cm}^{-1}}{|-1.0 \\times 10^{-5} \\ \\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})|} = \\frac{1.0 \\times 10^{-3}}{1.0 \\times 10^{-5}} \\ \\mathrm{MWd}/\\mathrm{kgHM} = 100 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n    $$\n计算出的步长限制为：\n- $\\Delta B_{a,1} = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}$\n- $\\Delta B_{a,2} \\approx 2.7143 \\ \\mathrm{MWd}/\\mathrm{kgHM}$\n- $\\Delta B_{f,2} = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}$\n- $\\Delta B_{s,1\\rightarrow 2} = 100 \\ \\mathrm{MWd}/\\mathrm{kgHM}$\n\n最严格（最小）的限制将决定下一步的最大允许燃耗增量。\n$$\n\\Delta B_{\\max} = \\min(1.25, 2.7143..., 1.25, 100) = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n$$\n问题要求最终答案四舍五入至四位有效数字。因此，$\\Delta B_{\\max} = 1.250 \\ \\mathrm{MWd}/\\mathrm{kgHM}$。\n这个结果表明，在当前燃耗 $B_0$ 下，快能群吸收截面和热能群裂变截面是相对于其容差变化最快的，因此限制了燃耗步长。",
            "answer": "$$\n\\boxed{1.250}\n$$"
        },
        {
            "introduction": "即便选定了合适的燃耗步长，我们仍面临一个挑战：如何在一个有限的步长内准确地表示连续变化的截面。本练习深入探讨了耗散计算中时间平均方法的数学原理。通过严谨的推导，你将证明为何采用通量加权的步平均截面能够精确保持功率守恒，并从截断误差的角度，揭示其相对于简单端点近似法的优越性 。",
            "id": "4216385",
            "problem": "考虑一个体积为 $V$ 的单一均匀反应堆区域，在一个时长为 $h$ 的燃耗步长内运行。假设为单能群、固定的空间通量形状，以及在 $[0,h]$ 上平滑的时间相关振幅 $\\phi(t)$。设宏观裂变截面与燃耗相关，为 $\\Sigma_f(B(t))$，其中燃耗 $B(t)$ 根据 $\\frac{dB}{dt} = c\\, P(t)$ 演化，$c$ 是一个已知的转换常数，瞬时功率 $P(t) = \\kappa\\, V\\, \\Sigma_f(B(t))\\, \\phi(t)$，其中 $\\kappa$ 是每次裂变释放的能量。定义时间平均通量振幅为 $\\bar{\\phi} = \\frac{1}{h}\\int_{0}^{h} \\phi(t)\\, dt$，时间平均功率为 $\\bar{P} = \\frac{1}{h}\\int_{0}^{h} P(t)\\, dt$。步长平均裂变截面定义为\n$$\n\\bar{\\Sigma}_f \\equiv \\frac{\\int_{0}^{h} \\Sigma_f(B(t))\\, \\phi(t)\\, dt}{\\int_{0}^{h} \\phi(t)\\, dt}.\n$$\n第(i)部分：从 $P(t)$、$\\bar{P}$ 和 $\\bar{\\Sigma}_f$ 的定义出发，证明使用 $\\bar{\\Sigma}_f$ 和 $\\bar{\\phi}$ 可以保证功率一致性，即 $\\kappa\\, V\\, \\bar{\\Sigma}_f\\, \\bar{\\phi} = \\bar{P}$。\n\n第(ii)部分：为了评估相对于终点值的准确性，考虑一种近似方法，该方法用步长末端值 $\\Sigma_f(B(h))$ 替换 $\\Sigma_f(B(t))$，并将其与 $\\bar{\\phi}$ 配对来估算平均反应率。引入 $\\Sigma_f(B(t))$ 和 $\\phi(t)$ 在 $t=0$ 附近的 Taylor 展开，直到 $t$ 的二阶项：\n$$\n\\Sigma_f(B(t)) = \\Sigma_0 + \\Sigma_1\\, t + \\frac{\\Sigma_2}{2}\\, t^2 + \\mathcal{O}(t^3),\n\\qquad\n\\phi(t) = \\phi_0 + \\phi_1\\, t + \\frac{\\phi_2}{2}\\, t^2 + \\mathcal{O}(t^3),\n$$\n其中 $\\Sigma_i = \\left.\\frac{d^i \\Sigma_f(B(t))}{dt^i}\\right|_{t=0}$ 且 $\\phi_i = \\left.\\frac{d^i \\phi(t)}{dt^i}\\right|_{t=0}$。将基于终点值的平均反应率估算值定义为 $\\widehat{R}_{\\mathrm{end}} \\equiv \\Sigma_f(B(h))\\, \\bar{\\phi}$，真实平均反应率定义为 $R_{\\mathrm{avg}} \\equiv \\frac{1}{h}\\int_{0}^{h} \\Sigma_f(B(t))\\, \\phi(t)\\, dt$。使用上述展开式，推导截至 $h^2$ 阶的主阶截断误差差值\n$$\n\\Delta \\equiv \\widehat{R}_{\\mathrm{end}} - R_{\\mathrm{avg}}\n$$\n并完全用 $\\Sigma_0$、$\\Sigma_1$、$\\Sigma_2$、$\\phi_0$ 和 $\\phi_1$ 表示（不要引入新变量）。根据 $\\Delta$ 中各项的符号和阶数，总结出步长平均截面相比终点值能提高准确性的条件，并用 $\\Sigma_f(B(t))$ 和 $\\phi(t)$ 的平滑性和非零时间导数来表述。你的最终答案必须是截断到 $\\mathcal{O}(h^2)$ 的 $\\Delta$ 的闭式表达式，并且除了所要求的表达式外，不得包含任何不等式或方程。不需要四舍五入，最终表达式中也不应包含任何单位。",
            "solution": "该问题经核实具有科学依据，问题设定良好、客观且完整。它描述了反应堆物理学中一个关于燃耗计算过程中不同截面时间平均方法准确性的标准分析。\n\n第(i)部分：功率一致性验证\n\n目标是证明步长平均裂变截面 $\\bar{\\Sigma}_f$ 和时间平均通量振幅 $\\bar{\\phi}$ 的定义能保持功率一致性，即 $\\kappa\\, V\\, \\bar{\\Sigma}_f\\, \\bar{\\phi} = \\bar{P}$。\n\n我们从方程的左侧 $\\kappa\\, V\\, \\bar{\\Sigma}_f\\, \\bar{\\phi}$ 开始，并代入给定的定义。\n步长平均裂变截面定义为：\n$$\n\\bar{\\Sigma}_f \\equiv \\frac{\\int_{0}^{h} \\Sigma_f(B(t))\\, \\phi(t)\\, dt}{\\int_{0}^{h} \\phi(t)\\, dt}\n$$\n时间平均通量振幅定义为：\n$$\n\\bar{\\phi} = \\frac{1}{h}\\int_{0}^{h} \\phi(t)\\, dt\n$$\n将这些代入左侧可得：\n$$\n\\kappa\\, V\\, \\bar{\\Sigma}_f\\, \\bar{\\phi} = \\kappa\\, V\\, \\left( \\frac{\\int_{0}^{h} \\Sigma_f(B(t))\\, \\phi(t)\\, dt}{\\int_{0}^{h} \\phi(t)\\, dt} \\right) \\left( \\frac{1}{h}\\int_{0}^{h} \\phi(t)\\, dt \\right)\n$$\n项 $\\int_{0}^{h} \\phi(t)\\, dt$ 同时出现在分子和分母中，因此可以消去：\n$$\n\\kappa\\, V\\, \\bar{\\Sigma}_f\\, \\bar{\\phi} = \\frac{\\kappa\\, V}{h} \\int_{0}^{h} \\Sigma_f(B(t))\\, \\phi(t)\\, dt\n$$\n我们可以将常数 $\\kappa$ 和 $V$ 移到积分内部：\n$$\n\\kappa\\, V\\, \\bar{\\Sigma}_f\\, \\bar{\\phi} = \\frac{1}{h} \\int_{0}^{h} \\left( \\kappa\\, V\\, \\Sigma_f(B(t))\\, \\phi(t) \\right) dt\n$$\n根据定义，被积函数是瞬时功率 $P(t) = \\kappa\\, V\\, \\Sigma_f(B(t))\\, \\phi(t)$。代入此定义可得：\n$$\n\\kappa\\, V\\, \\bar{\\Sigma}_f\\, \\bar{\\phi} = \\frac{1}{h} \\int_{0}^{h} P(t)\\, dt\n$$\n右侧的最终表达式是时间平均功率 $\\bar{P}$ 的定义。因此，我们证明了：\n$$\n\\kappa\\, V\\, \\bar{\\Sigma}_f\\, \\bar{\\phi} = \\bar{P}\n$$\n这表明，使用通量加权的平均截面 $\\bar{\\Sigma}_f$ 和时间平均通量 $\\bar{\\phi}$ 可以正确地再现时间平均功率 $\\bar{P}$。\n\n第(ii)部分：截断误差分析\n\n目标是推导截至 $h^2$ 阶的主阶截断误差差值 $\\Delta \\equiv \\widehat{R}_{\\mathrm{end}} - R_{\\mathrm{avg}}$。\n\n首先，我们使用给定的 Taylor 级数展开 $\\Delta$ 的各个组成部分。\n时间平均通量振幅 $\\bar{\\phi}$ 为：\n$$\n\\bar{\\phi} = \\frac{1}{h}\\int_{0}^{h} \\phi(t)\\, dt = \\frac{1}{h}\\int_{0}^{h} \\left(\\phi_0 + \\phi_1\\, t + \\frac{\\phi_2}{2}\\, t^2 + \\mathcal{O}(t^3)\\right) dt\n$$\n$$\n\\bar{\\phi} = \\frac{1}{h} \\left[ \\phi_0 t + \\frac{\\phi_1}{2} t^2 + \\frac{\\phi_2}{6} t^3 \\right]_{0}^{h} + \\mathcal{O}(h^3) = \\phi_0 + \\frac{\\phi_1}{2} h + \\frac{\\phi_2}{6} h^2 + \\mathcal{O}(h^3)\n$$\n步长末端截面 $\\Sigma_f(B(h))$ 通过计算其在 $t=h$ 处的 Taylor 级数值得到：\n$$\n\\Sigma_f(B(h)) = \\Sigma_0 + \\Sigma_1\\, h + \\frac{\\Sigma_2}{2}\\, h^2 + \\mathcal{O}(h^3)\n$$\n现在，我们计算基于终点值的平均反应率估算值 $\\widehat{R}_{\\mathrm{end}} \\equiv \\Sigma_f(B(h))\\, \\bar{\\phi}$，方法是将两个展开式相乘并保留到 $h^2$ 阶的项：\n$$\n\\widehat{R}_{\\mathrm{end}} = \\left(\\Sigma_0 + \\Sigma_1\\, h + \\frac{\\Sigma_2}{2}\\, h^2\\right) \\left(\\phi_0 + \\frac{\\phi_1}{2} h + \\frac{\\phi_2}{6} h^2\\right) + \\mathcal{O}(h^3)\n$$\n$$\n\\widehat{R}_{\\mathrm{end}} = \\Sigma_0 \\phi_0 + \\left(\\frac{1}{2}\\Sigma_0\\phi_1 + \\Sigma_1\\phi_0\\right)h + \\left(\\frac{1}{6}\\Sigma_0\\phi_2 + \\frac{1}{2}\\Sigma_1\\phi_1 + \\frac{1}{2}\\Sigma_2\\phi_0\\right)h^2 + \\mathcal{O}(h^3)\n$$\n接下来，我们计算真实平均反应率 $R_{\\mathrm{avg}} \\equiv \\frac{1}{h}\\int_{0}^{h} \\Sigma_f(B(t))\\, \\phi(t)\\, dt$。我们首先求出 $\\Sigma_f(B(t))$ 和 $\\phi(t)$ 级数的乘积：\n$$\n\\Sigma_f(B(t)) \\phi(t) = \\left(\\Sigma_0 + \\Sigma_1 t + \\frac{\\Sigma_2}{2} t^2\\right) \\left(\\phi_0 + \\phi_1 t + \\frac{\\phi_2}{2} t^2\\right) + \\mathcal{O}(t^3)\n$$\n$$\n\\Sigma_f(B(t)) \\phi(t) = \\Sigma_0\\phi_0 + (\\Sigma_0\\phi_1 + \\Sigma_1\\phi_0)t + \\left(\\frac{1}{2}\\Sigma_0\\phi_2 + \\Sigma_1\\phi_1 + \\frac{1}{2}\\Sigma_2\\phi_0\\right)t^2 + \\mathcal{O}(t^3)\n$$\n将此乘积从 $0$ 积分到 $h$，然后除以 $h$：\n$$\nR_{\\mathrm{avg}} = \\frac{1}{h}\\int_{0}^{h} \\left[ \\Sigma_0\\phi_0 + (\\Sigma_0\\phi_1 + \\Sigma_1\\phi_0)t + \\left(\\frac{1}{2}\\Sigma_0\\phi_2 + \\Sigma_1\\phi_1 + \\frac{1}{2}\\Sigma_2\\phi_0\\right)t^2 \\right] dt + \\mathcal{O}(h^3)\n$$\n$$\nR_{\\mathrm{avg}} = \\left[ \\Sigma_0\\phi_0 t + \\frac{1}{2}(\\Sigma_0\\phi_1 + \\Sigma_1\\phi_0)t^2 + \\frac{1}{3}\\left(\\frac{1}{2}\\Sigma_0\\phi_2 + \\Sigma_1\\phi_1 + \\frac{1}{2}\\Sigma_2\\phi_0\\right)t^3 \\right]_{0}^{h} \\frac{1}{h} + \\mathcal{O}(h^3)\n$$\n$$\nR_{\\mathrm{avg}} = \\Sigma_0\\phi_0 + \\frac{1}{2}(\\Sigma_0\\phi_1 + \\Sigma_1\\phi_0)h + \\frac{1}{3}\\left(\\frac{1}{2}\\Sigma_0\\phi_2 + \\Sigma_1\\phi_1 + \\frac{1}{2}\\Sigma_2\\phi_0\\right)h^2 + \\mathcal{O}(h^3)\n$$\n$$\nR_{\\mathrm{avg}} = \\Sigma_0\\phi_0 + \\left(\\frac{1}{2}\\Sigma_0\\phi_1 + \\frac{1}{2}\\Sigma_1\\phi_0\\right)h + \\left(\\frac{1}{6}\\Sigma_0\\phi_2 + \\frac{1}{3}\\Sigma_1\\phi_1 + \\frac{1}{6}\\Sigma_2\\phi_0\\right)h^2 + \\mathcal{O}(h^3)\n$$\n最后，我们通过从 $\\widehat{R}_{\\mathrm{end}}$ 的级数中减去 $R_{\\mathrm{avg}}$ 的级数来计算差值 $\\Delta = \\widehat{R}_{\\mathrm{end}} - R_{\\mathrm{avg}}$。$\\mathcal{O}(h^0)$ 阶项相互抵消。\n$h$ 阶项：\n$$\n\\left(\\frac{1}{2}\\Sigma_0\\phi_1 + \\Sigma_1\\phi_0\\right)h - \\left(\\frac{1}{2}\\Sigma_0\\phi_1 + \\frac{1}{2}\\Sigma_1\\phi_0\\right)h = \\frac{1}{2}\\Sigma_1\\phi_0 h\n$$\n$h^2$ 阶项：\n$$\n\\left(\\frac{1}{6}\\Sigma_0\\phi_2 + \\frac{1}{2}\\Sigma_1\\phi_1 + \\frac{1}{2}\\Sigma_2\\phi_0\\right)h^2 - \\left(\\frac{1}{6}\\Sigma_0\\phi_2 + \\frac{1}{3}\\Sigma_1\\phi_1 + \\frac{1}{6}\\Sigma_2\\phi_0\\right)h^2\n$$\n$$\n= \\left[\\left(\\frac{1}{2} - \\frac{1}{3}\\right)\\Sigma_1\\phi_1 + \\left(\\frac{1}{2} - \\frac{1}{6}\\right)\\Sigma_2\\phi_0\\right]h^2 = \\left(\\frac{1}{6}\\Sigma_1\\phi_1 + \\frac{1}{3}\\Sigma_2\\phi_0\\right)h^2\n$$\n包含 $\\phi_2$ 的项按要求抵消了。合并各项，$\\Delta$ 截至 $h^2$ 阶的表达式为：\n$$\n\\Delta = \\frac{1}{2} \\Sigma_1 \\phi_0 h + \\left( \\frac{1}{6} \\Sigma_1 \\phi_1 + \\frac{1}{3} \\Sigma_2 \\phi_0 \\right) h^2\n$$\n\n关于准确性改进的结论：\n使用步长平均截面计算的平均反应率 $R_{\\text{step-avg}} = \\bar{\\Sigma}_f \\bar{\\phi}$ 与真实平均反应率 $R_{\\mathrm{avg}}$ 完全相同。这是因为 $\\bar{\\Sigma}_f \\bar{\\phi} = \\frac{\\int \\Sigma_f \\phi dt}{\\int \\phi dt} \\frac{\\int \\phi dt}{h} = \\frac{1}{h} \\int \\Sigma_f \\phi dt = R_{\\mathrm{avg}}$。因此，步长平均法根据其定义是精确的，误差为零。\n终点值方法 $\\widehat{R}_{\\mathrm{end}}$ 的截断误差为 $\\Delta$，其主项为 $\\frac{1}{2} \\Sigma_1 \\phi_0 h$。此误差是步长 $h$ 的一阶项，意味着该方法的准确度为零阶。只要 $\\Delta \\neq 0$，步长平均截面法就比终点值法更准确。对于一个非平凡的反应堆状态（$\\phi_0 > 0$）和有限的时间步长（$h > 0$），当 $\\Sigma_1 \\neq 0$ 时，此条件成立。系数 $\\Sigma_1 = \\left.\\frac{d\\Sigma_f}{dt}\\right|_{t=0}$ 代表裂变截面的初始变化率。因此，只要截面不是随时间恒定的，即其一阶时间导数不为零，使用步长平均截面就能带来改进。这是经历燃料燃耗的系统的基本特征。终点值方法中的误差大小，以及因此带来的改进的显著性，与该变化率成正比。",
            "answer": "$$\n\\boxed{\\frac{1}{2} \\Sigma_1 \\phi_0 h + \\left( \\frac{1}{6} \\Sigma_1 \\phi_1 + \\frac{1}{3} \\Sigma_2 \\phi_0 \\right) h^2}\n$$"
        }
    ]
}