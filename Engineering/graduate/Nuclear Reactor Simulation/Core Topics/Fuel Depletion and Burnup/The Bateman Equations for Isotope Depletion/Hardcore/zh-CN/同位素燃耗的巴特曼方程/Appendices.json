{
    "hands_on_practices": [
        {
            "introduction": "在实际的反应堆物理模拟中，核素的嬗变网络很少是简单的线性链。它们通常涉及分支路径，即一个核素可以通过不同的衰变或反应模式转化为多种产物。本练习旨在探讨如何利用贝特曼方程的线性特性来求解此类复杂网络，通过叠加原理，我们可以将各个独立生成路径的贡献相加，从而计算出最终产物核素的浓度。掌握这种方法对于精确模拟燃料燃耗和放射性废物清单至关重要，因为在这些情景中，多种同位素常常会共同生成某一种特定的产物。",
            "id": "4254320",
            "problem": "在一次核反应堆模拟中，考虑一个由四个核素组成的网络，该网络在恒定条件下遵循一级动力学：核素 $1$ 以总去除速率常数 $\\lambda_{1}$ 发生转变，每次转变事件中，它会以分数 $b_{1\\to 2}$ 分支产生核素 $2$，以分数 $b_{1\\to 3}$ 分支产生核素 $3$。核素 $2$ 以速率常数 $\\lambda_{2}$ 被去除，并在去除时以分支比 $b_{2\\to 4}$ 产生核素 $4$；类似地，核素 $3$ 以速率常数 $\\lambda_{3}$ 被去除，并以分支比 $b_{3\\to 4}$ 产生核素 $4$。核素 $4$ 以速率常数 $\\lambda_{4}$ 被去除（对于稳定核素，该值可以为零）。所有速率常数都是不随时间变化的，并代表有效的一级速率，这些速率可能结合了放射性衰变和中子俘获，适用于稳态辐照条件。假设速率常数 $\\lambda_{1},\\lambda_{2},\\lambda_{3},\\lambda_{4}$ 均为正值且两两不同，分支比满足 $0 \\le b_{1\\to 2}, b_{1\\to 3}, b_{2\\to 4}, b_{3\\to 4} \\le 1$。\n\n系统在时间 $t=0$ 时始于纯的核素 $1$ 库存：有 $N_{1}(0)$ 个核素 $1$ 的原子，其他核素的原子数为零，即 $N_{2}(0)=0$，$N_{3}(0)=0$，$N_{4}(0)=0$。仅使用一级过程的指数动力学基本定律以及沿分支的转变守恒，推导一个关于在时间 $t$ 的核素 $4$ 原子数（记为 $N_{4}(t)$）的闭式符号表达式，该表达式应明确地用 $N_{1}(0)$、$b_{1\\to 2}$、$b_{1\\to 3}$、$b_{2\\to 4}$、$b_{3\\to 4}$ 以及速率常数 $\\lambda_{1},\\lambda_{2},\\lambda_{3},\\lambda_{4}$ 表示。请用符号表达最终结果；无需进行数值计算或四舍五入。",
            "solution": "问题陈述被解析和验证。\n\n### 步骤 1：提取已知条件\n- **系统：** 一个由四个核素组成的网络，标记为 $1, 2, 3, 4$。\n- **动力学：** 在恒定物理条件下（例如，恒定中子通量），遵循一级过程。\n- **转变和速率：**\n    - 核素 $1$ 以总速率常数 $\\lambda_{1}$ 被去除。\n    - 从核素 $1$ 分支：以分数 $b_{1\\to 2}$ 到核素 $2$，以分数 $b_{1\\to 3}$ 到核素 $3$。\n    - 核素 $2$ 以速率常数 $\\lambda_{2}$ 被去除。\n    - 从核素 $2$ 分支：以分数 $b_{2\\to 4}$ 到核素 $4$。\n    - 核素 $3$ 以速率常数 $\\lambda_{3}$ 被去除。\n    - 从核素 $3$ 分支：以分数 $b_{3\\to 4}$ 到核素 $4$。\n    - 核素 $4$ 以速率常数 $\\lambda_{4}$ 被去除。\n- **速率常数属性：** $\\lambda_{1}, \\lambda_{2}, \\lambda_{3}, \\lambda_{4}$ 为正且两两不同。\n- **分支比属性：** $0 \\le b_{1\\to 2}, b_{1\\to 3}, b_{2\\to 4}, b_{3\\to 4} \\le 1$。\n- **初始条件 ($t=0$)：**\n    - 核素 $1$ 的原子数为 $N_{1}(0)$。\n    - $N_{2}(0) = 0$。\n    - $N_{3}(0) = 0$。\n    - $N_{4}(0) = 0$。\n- **目标：** 推导 $N_{4}(t)$ 的闭式符号表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n评估问题的有效性。\n- **科学依据：** 该问题描述了一个简化但标准的嬗变链，由贝特曼方程（Bateman equations）控制。这是核反应堆物理和放射性衰变分析中的一个基本概念。使用有效一级速率常数是在恒定中子通量下模拟行为的标准做法。该模型在科学上是合理的。\n- **适定性：** 该问题是一个具有指定初始条件的线性一阶常微分方程组。所有速率常数 $\\lambda_{i}$ 均不相同的条件确保了解是唯一的，且不包含共振项，因此问题是适定的。\n- **目标：** 问题使用精确的数学和物理术语陈述，没有歧义或主观内容。\n- **完整性：** 为获得完整的符号解，提供了所有必要的参数（$N_1(0)$、分支比和速率常数）。\n\n### 步骤 3：结论和行动\n问题是**有效的**。将推导解答。\n\n### 解答的推导\n每个核素的原子数 $N_i(t)$ 随时间的演化由一个一阶线性常微分方程（ODE）组控制。根据一级动力学的质量作用定律，变化率如下：\n\n$$\n\\frac{dN_{1}(t)}{dt} = -\\lambda_{1} N_{1}(t)\n$$\n$$\n\\frac{dN_{2}(t)}{dt} = \\lambda_{1} b_{1\\to 2} N_{1}(t) - \\lambda_{2} N_{2}(t)\n$$\n$$\n\\frac{dN_{3}(t)}{dt} = \\lambda_{1} b_{1\\to 3} N_{1}(t) - \\lambda_{3} N_{3}(t)\n$$\n$$\n\\frac{dN_{4}(t)}{dt} = \\lambda_{2} b_{2\\to 4} N_{2}(t) + \\lambda_{3} b_{3\\to 4} N_{3}(t) - \\lambda_{4} N_{4}(t)\n$$\n\n我们使用指定的初始条件 $N_{1}(0)$，$N_{2}(0)=0$，$N_{3}(0)=0$ 和 $N_{4}(0)=0$ 顺序求解该方程组。\n\n**1. $N_{1}(t)$ 的解**\n第一个方程是一个简单的指数衰减。在初始条件 $N_{1}(0)$ 下，解为：\n$$\nN_{1}(t) = N_{1}(0) \\exp(-\\lambda_{1} t)\n$$\n\n**2. $N_{2}(t)$ 和 $N_{3}(t)$ 的解**\n将 $N_{1}(t)$ 代入 $N_{2}(t)$ 和 $N_{3}(t)$ 的方程，得到两个形式为 $\\frac{dy}{dt} + py = q(t)$ 的独立线性一阶常微分方程。这些方程可使用积分因子求解。所得解是双核素链的贝特曼方程的实例。\n\n对于 $N_{2}(t)$，在 $N_{2}(0)=0$ 的条件下：\n$$\nN_{2}(t) = \\frac{\\lambda_{1} b_{1\\to 2} N_{1}(0)}{\\lambda_{2} - \\lambda_{1}} \\left( \\exp(-\\lambda_{1} t) - \\exp(-\\lambda_{2} t) \\right)\n$$\n此解有效，因为给定条件为 $\\lambda_{1} \\neq \\lambda_{2}$。\n\n同理，对于 $N_{3}(t)$，在 $N_{3}(0)=0$ 的条件下：\n$$\nN_{3}(t) = \\frac{\\lambda_{1} b_{1\\to 3} N_{1}(0)}{\\lambda_{3} - \\lambda_{1}} \\left( \\exp(-\\lambda_{1} t) - \\exp(-\\lambda_{3} t) \\right)\n$$\n此解有效，因为给定条件为 $\\lambda_{1} \\neq \\lambda_{3}$。\n\n**3. $N_{4}(t)$ 的解**\n$N_{4}(t)$ 的方程是线性的。因此，根据叠加原理，解 $N_{4}(t)$ 可以通过对两个独立产生路径的贡献求和得到：路径 A ($1 \\to 2 \\to 4$) 和路径 B ($1 \\to 3 \\to 4$) 。\n设 $N_{4}(t) = N_{4,A}(t) + N_{4,B}(t)$，其中 $N_{4,A}(t)$ 是通过核素 $2$ 产生的核素 $4$ 的数量，而 $N_{4,B}(t)$ 是通过核素 $3$ 产生的数量。\n\n**路径 A ($1 \\to 2 \\to 4$) 的贡献**\n这对应于一个三核素链。对于一个以 $N_A(0)$ 开始、速率常数为 $\\lambda_A, \\lambda_B, \\lambda_C$ 的通用链 $A \\to B \\to C$，第三个核素的解由贝特曼方程给出：\n$$\nN_C(t) = N_A(0) \\lambda_A \\lambda_B \\left( \\frac{\\exp(-\\lambda_A t)}{(\\lambda_B-\\lambda_A)(\\lambda_C-\\lambda_A)} + \\frac{\\exp(-\\lambda_B t)}{(\\lambda_A-\\lambda_B)(\\lambda_C-\\lambda_B)} + \\frac{\\exp(-\\lambda_C t)}{(\\lambda_A-\\lambda_C)(\\lambda_B-\\lambda_C)} \\right)\n$$\n对于我们的路径 $1 \\to 2 \\to 4$，我们认定 $\\lambda_A \\to \\lambda_1$, $\\lambda_B \\to \\lambda_2$, $\\lambda_C \\to \\lambda_4$。我们还必须包括分支比。从 $1$ 产生核素 $2$ 的有效生成速率为 $\\lambda_{1} b_{1\\to 2}$，从 $2$ 产生核素 $4$ 的有效生成速率为 $\\lambda_{2} b_{2\\to 4}$。\n因此，贡献 $N_{4,A}(t)$ 为：\n$$\nN_{4,A}(t) = N_{1}(0) (\\lambda_{1} b_{1\\to 2}) (\\lambda_{2} b_{2\\to 4}) \\left[ \\frac{\\exp(-\\lambda_{1} t)}{(\\lambda_{2}-\\lambda_{1})(\\lambda_{4}-\\lambda_{1})} + \\frac{\\exp(-\\lambda_{2} t)}{(\\lambda_{1}-\\lambda_{2})(\\lambda_{4}-\\lambda_{2})} + \\frac{\\exp(-\\lambda_{4} t)}{(\\lambda_{1}-\\lambda_{4})(\\lambda_{2}-\\lambda_{4})} \\right]\n$$\n\n**路径 B ($1 \\to 3 \\to 4$) 的贡献**\n类似地，对于路径 $1 \\to 3 \\to 4$，我们确定核素为 $\\{1, 3, 4\\}$，它们各自的速率为 $\\{\\lambda_1, \\lambda_3, \\lambda_4\\}$。贡献 $N_{4,B}(t)$ 为：\n$$\nN_{4,B}(t) = N_{1}(0) (\\lambda_{1} b_{1\\to 3}) (\\lambda_{3} b_{3\\to 4}) \\left[ \\frac{\\exp(-\\lambda_{1} t)}{(\\lambda_{3}-\\lambda_{1})(\\lambda_{4}-\\lambda_{1})} + \\frac{\\exp(-\\lambda_{3} t)}{(\\lambda_{1}-\\lambda_{3})(\\lambda_{4}-\\lambda_{3})} + \\frac{\\exp(-\\lambda_{4} t)}{(\\lambda_{1}-\\lambda_{4})(\\lambda_{3}-\\lambda_{4})} \\right]\n$$\n\n**核素 4 的总量**\n在时间 $t$ 的核素 $4$ 的总量是 $N_{4}(t) = N_{4,A}(t) + N_{4,B}(t)$ 的和。为了以合并的形式呈现最终表达式，我们按指数因子 $\\exp(-\\lambda_i t)$ 对各项进行分组。\n\n$N_{4}(t) = N_{1}(0) \\lambda_{1} b_{1\\to 2} \\lambda_{2} b_{2\\to 4} \\left[ \\dots \\right] + N_{1}(0) \\lambda_{1} b_{1\\to 3} \\lambda_{3} b_{3\\to 4} \\left[ \\dots \\right]$\n\n$\\exp(-\\lambda_{1} t)$ 的系数：\n$$\nN_{1}(0) \\lambda_{1} \\left( \\frac{b_{1\\to 2} \\lambda_{2} b_{2\\to 4}}{(\\lambda_{2}-\\lambda_{1})(\\lambda_{4}-\\lambda_{1})} + \\frac{b_{1\\to 3} \\lambda_{3} b_{3\\to 4}}{(\\lambda_{3}-\\lambda_{1})(\\lambda_{4}-\\lambda_{1})} \\right)\n$$\n$\\exp(-\\lambda_{2} t)$ 的系数：\n$$\nN_{1}(0) \\lambda_{1} \\frac{b_{1\\to 2} \\lambda_{2} b_{2\\to 4}}{(\\lambda_{1}-\\lambda_{2})(\\lambda_{4}-\\lambda_{2})}\n$$\n$\\exp(-\\lambda_{3} t)$ 的系数：\n$$\nN_{1}(0) \\lambda_{1} \\frac{b_{1\\to 3} \\lambda_{3} b_{3\\to 4}}{(\\lambda_{1}-\\lambda_{3})(\\lambda_{4}-\\lambda_{3})}\n$$\n$\\exp(-\\lambda_{4} t)$ 的系数：\n$$\nN_{1}(0) \\lambda_{1} \\left( \\frac{b_{1\\to 2} \\lambda_{2} b_{2\\to 4}}{(\\lambda_{1}-\\lambda_{4})(\\lambda_{2}-\\lambda_{4})} + \\frac{b_{1\\to 3} \\lambda_{3} b_{3\\to 4}}{(\\lambda_{1}-\\lambda_{4})(\\lambda_{3}-\\lambda_{4})} \\right)\n$$\n合并这些项，得到 $N_{4}(t)$ 的最终表达式。",
            "answer": "$$\n\\boxed{\nN_{1}(0) \\lambda_{1} \\left( \\frac{\\exp(-\\lambda_{1} t)}{\\lambda_{4}-\\lambda_{1}} \\left( \\frac{b_{1\\to 2} \\lambda_{2} b_{2\\to 4}}{\\lambda_{2}-\\lambda_{1}} + \\frac{b_{1\\to 3} \\lambda_{3} b_{3\\to 4}}{\\lambda_{3}-\\lambda_{1}} \\right) + \\frac{b_{1\\to 2} \\lambda_{2} b_{2\\to 4} \\exp(-\\lambda_{2} t)}{(\\lambda_{1}-\\lambda_{2})(\\lambda_{4}-\\lambda_{2})} + \\frac{b_{1\\to 3} \\lambda_{3} b_{3\\to 4} \\exp(-\\lambda_{3} t)}{(\\lambda_{1}-\\lambda_{3})(\\lambda_{4}-\\lambda_{3})} + \\frac{\\exp(-\\lambda_{4} t)}{\\lambda_{1}-\\lambda_{4}} \\left( \\frac{b_{1\\to 2} \\lambda_{2} b_{2\\to 4}}{\\lambda_{2}-\\lambda_{4}} + \\frac{b_{1\\to 3} \\lambda_{3} b_{3\\to 4}}{\\lambda_{3}-\\lambda_{4}} \\right) \\right)\n}\n$$"
        },
        {
            "introduction": "虽然标准的贝特曼方程解假设所有有效移除常数都是互不相同的，但在某些情况下，尤其是在特定中子通量下对嬗变过程建模时，可能会出现两个或多个常数相等的情况，这被称为“共振”或“简并”条件。本练习将引导您推导这种简并情况下的解析解，并揭示形如 $t \\exp(-\\lambda t)$ 的多项式-指数项的出现。通过直接求解和对非简并解取极限这两种方法，您将对该系统的数学结构获得更深刻的理解。理解这一特殊情况对于开发能够处理任意速率常数组合而不会遇到除零错误的稳健数值求解器至关重要。",
            "id": "4254339",
            "problem": "考虑核反应堆中稳定中子场内的两成员核素嬗变链。核素 $1$ 以分支比 $b$（其中 $0 \\leq b \\leq 1$）嬗变为核素 $2$，两种核素都通过一个由有效移除常数表征的有效一级过程从系统中移除。在此背景下，一个核素的有效移除常数 $\\lambda^{\\mathrm{eff}}$ 是其放射性衰变常数与在稳定中子通量下的中子诱发反应率之和，并被视为与时间无关。设核素 $1$ 和核素 $2$ 的有效移除常数分别表示为 $\\lambda_{1}^{\\mathrm{eff}}$ 和 $\\lambda_{2}^{\\mathrm{eff}}$。\n\n您必须使用的基本依据是，在一级动力学下控制此类链中同位素损耗的线性常微分方程（ODE）组，以及求解线性常微分方程和计算极限的标准方法。\n\n假设初始库存量为通用值 $N_{1}(0)=N_{10}$ 和 $N_{2}(0)=N_{20}$。对于有效移除常数相同的特殊情况，即 $\\lambda_{1}^{\\mathrm{eff}}=\\lambda_{2}^{\\mathrm{eff}}=\\lambda$，请从第一性原理出发，通过求解控制性常微分方程，推导核素 $2$ 的含时库存量 $N_{2}(t)$ 的闭式表达式。作为基于相同基本依据的一致性检验，请从非简并情况 $\\lambda_{1}^{\\mathrm{eff}} \\neq \\lambda_{2}^{\\mathrm{eff}}$ 出发，通过取极限 $\\lambda_{2}^{\\mathrm{eff}} \\to \\lambda_{1}^{\\mathrm{eff}}$ 来恢复此表达式，并明确验证 $t \\exp(-\\lambda t)$ 项的出现。\n\n请提供 $N_{2}(t)$ 关于 $N_{10}$、$N_{20}$、$b$、$\\lambda$ 和 $t$ 的单个闭式解析表达式作为最终答案。无需进行数值计算；无需取整。最终答案中不要包含单位。",
            "solution": "经评估，问题陈述有效。其科学依据是核反应动力学原理，特别是用于同位素嬗变和损耗的 Bateman 方程。该问题是适定的，提供了一个具有指定初始条件的线性常微分方程组，确保存在唯一且有意义的解。语言客观、精确，设定内部一致且完整。\n\n该问题描述了一个由一级动力学控制的两核素嬗变链 $1 \\to 2$。核素 $1$ 的浓度 $N_1(t)$ 和核素 $2$ 的浓度 $N_2(t)$ 作为时间 $t$ 的函数，由以下线性常微分方程（ODE）组描述：\n$$\n\\frac{dN_1(t)}{dt} = -\\lambda_{1}^{\\mathrm{eff}} N_1(t)\n$$\n$$\n\\frac{dN_2(t)}{dt} = b \\lambda_{1}^{\\mathrm{eff}} N_1(t) - \\lambda_{2}^{\\mathrm{eff}} N_2(t)\n$$\n此处，$\\lambda_{1}^{\\mathrm{eff}}$ 和 $\\lambda_{2}^{\\mathrm{eff}}$ 分别是核素 $1$ 和核素 $2$ 的有效移除常数，而 $b$ 是核素 $1$ 嬗变为核素 $2$ 的分支比。核素 $2$ 的生成速率是核素 $1$ 总移除速率的一部分，比例为 $b$。初始条件为 $N_1(0) = N_{10}$ 和 $N_2(0) = N_{20}$。\n\n关于 $N_1(t)$ 的第一个常微分方程是一个简单的可分离方程。其解可通过直接积分求得：\n$$\n\\int_{N_{10}}^{N_1(t)} \\frac{dN_1}{N_1} = -\\int_0^t \\lambda_{1}^{\\mathrm{eff}} dt'\n$$\n$$\n\\ln\\left(\\frac{N_1(t)}{N_{10}}\\right) = -\\lambda_{1}^{\\mathrm{eff}} t\n$$\n$$\nN_1(t) = N_{10} \\exp(-\\lambda_{1}^{\\mathrm{eff}} t)\n$$\n\n题目要求我们求解有效移除常数相同的特殊情况下 $N_2(t)$ 的解，即 $\\lambda_{1}^{\\mathrm{eff}} = \\lambda_{2}^{\\mathrm{eff}} = \\lambda$。\n\n**方法一：直接求解简并情况（$\\lambda_{1}^{\\mathrm{eff}} = \\lambda_{2}^{\\mathrm{eff}} = \\lambda$）**\n\n对于这种情况，方程组变为：\n$$\nN_1(t) = N_{10} \\exp(-\\lambda t)\n$$\n$$\n\\frac{dN_2(t)}{dt} = b \\lambda N_1(t) - \\lambda N_2(t)\n$$\n将 $N_1(t)$ 的表达式代入第二个方程，得到：\n$$\n\\frac{dN_2(t)}{dt} + \\lambda N_2(t) = b \\lambda N_{10} \\exp(-\\lambda t)\n$$\n这是一个形式为 $y' + P(t)y = Q(t)$ 的一阶线性非齐次常微分方程。我们可以使用积分因子法来求解。积分因子 $I(t)$ 由下式给出：\n$$\nI(t) = \\exp\\left(\\int \\lambda dt\\right) = \\exp(\\lambda t)\n$$\n将常微分方程乘以积分因子，我们得到：\n$$\n\\exp(\\lambda t) \\frac{dN_2}{dt} + \\lambda \\exp(\\lambda t) N_2(t) = \\exp(\\lambda t) \\left[ b \\lambda N_{10} \\exp(-\\lambda t) \\right]\n$$\n左边是乘积 $N_2(t)I(t)$ 的导数：\n$$\n\\frac{d}{dt} \\left[ N_2(t) \\exp(\\lambda t) \\right] = b \\lambda N_{10}\n$$\n我们对两边关于时间从 $0$ 到 $t$ 进行积分：\n$$\n\\int_0^t \\frac{d}{d\\tau} \\left[ N_2(\\tau) \\exp(\\lambda \\tau) \\right] d\\tau = \\int_0^t b \\lambda N_{10} d\\tau\n$$\n$$\n\\left[ N_2(\\tau) \\exp(\\lambda \\tau) \\right]_0^t = \\left[ b \\lambda N_{10} \\tau \\right]_0^t\n$$\n$$\nN_2(t) \\exp(\\lambda t) - N_2(0) \\exp(0) = b \\lambda N_{10} t - 0\n$$\n使用初始条件 $N_2(0) = N_{20}$：\n$$\nN_2(t) \\exp(\\lambda t) = N_{20} + b \\lambda N_{10} t\n$$\n最后，通过乘以 $\\exp(-\\lambda t)$ 来求解 $N_2(t)$：\n$$\nN_2(t) = (N_{20} + b \\lambda N_{10} t) \\exp(-\\lambda t)\n$$\n\n**方法二：通过取极限 $\\lambda_{2}^{\\mathrm{eff}} \\to \\lambda_{1}^{\\mathrm{eff}}$ 进行验证**\n\n作为一致性检验，我们首先推导非简并情况（$\\lambda_{1}^{\\mathrm{eff}} \\neq \\lambda_{2}^{\\mathrm{eff}}$）的解，然后取极限。$N_2(t)$ 的常微分方程为：\n$$\n\\frac{dN_2(t)}{dt} + \\lambda_{2}^{\\mathrm{eff}} N_2(t) = b \\lambda_{1}^{\\mathrm{eff}} N_{10} \\exp(-\\lambda_{1}^{\\mathrm{eff}} t)\n$$\n积分因子是 $I(t) = \\exp(\\lambda_{2}^{\\mathrm{eff}} t)$。将常微分方程乘以 $I(t)$ 得到：\n$$\n\\frac{d}{dt} \\left[ N_2(t) \\exp(\\lambda_{2}^{\\mathrm{eff}} t) \\right] = b \\lambda_{1}^{\\mathrm{eff}} N_{10} \\exp(-\\lambda_{1}^{\\mathrm{eff}} t) \\exp(\\lambda_{2}^{\\mathrm{eff}} t) = b \\lambda_{1}^{\\mathrm{eff}} N_{10} \\exp((\\lambda_{2}^{\\mathrm{eff}} - \\lambda_{1}^{\\mathrm{eff}}) t)\n$$\n从 $0$ 到 $t$ 积分：\n$$\nN_2(t) \\exp(\\lambda_{2}^{\\mathrm{eff}} t) - N_{20} = \\int_0^t b \\lambda_{1}^{\\mathrm{eff}} N_{10} \\exp((\\lambda_{2}^{\\mathrm{eff}} - \\lambda_{1}^{\\mathrm{eff}}) \\tau) d\\tau\n$$\n$$\nN_2(t) \\exp(\\lambda_{2}^{\\mathrm{eff}} t) - N_{20} = b \\lambda_{1}^{\\mathrm{eff}} N_{10} \\left[ \\frac{\\exp((\\lambda_{2}^{\\mathrm{eff}} - \\lambda_{1}^{\\mathrm{eff}}) t) - 1}{\\lambda_{2}^{\\mathrm{eff}} - \\lambda_{1}^{\\mathrm{eff}}} \\right]\n$$\n求解 $N_2(t)$：\n$$\nN_2(t) = N_{20} \\exp(-\\lambda_{2}^{\\mathrm{eff}} t) + b \\lambda_{1}^{\\mathrm{eff}} N_{10} \\frac{\\exp(-\\lambda_{1}^{\\mathrm{eff}} t) - \\exp(-\\lambda_{2}^{\\mathrm{eff}} t)}{\\lambda_{2}^{\\mathrm{eff}} - \\lambda_{1}^{\\mathrm{eff}}}\n$$\n现在，我们计算当 $\\lambda_{2}^{\\mathrm{eff}} \\to \\lambda_{1}^{\\mathrm{eff}}$ 时此表达式的极限。令 $\\lambda_{1}^{\\mathrm{eff}} = \\lambda$ 且 $\\lambda_{2}^{\\mathrm{eff}} = \\lambda + \\epsilon$，其中 $\\epsilon \\to 0$。\n$$\nN_2(t) = N_{20} \\exp(-(\\lambda+\\epsilon) t) + b \\lambda N_{10} \\frac{\\exp(-\\lambda t) - \\exp(-(\\lambda+\\epsilon) t)}{\\epsilon}\n$$\n当 $\\epsilon \\to 0$ 时，第一项变为 $N_{20} \\exp(-\\lambda t)$。第二项需要仔细计算极限：\n$$\n\\lim_{\\epsilon \\to 0} \\left[ b \\lambda N_{10} \\frac{\\exp(-\\lambda t) - \\exp(-\\lambda t)\\exp(-\\epsilon t)}{\\epsilon} \\right] = b \\lambda N_{10} \\exp(-\\lambda t) \\lim_{\\epsilon \\to 0} \\left[ \\frac{1 - \\exp(-\\epsilon t)}{\\epsilon} \\right]\n$$\n该极限是 $\\frac{0}{0}$ 的不定形式。我们通过对分数的分子和分母关于 $\\epsilon$ 求导来应用洛必达法则：\n$$\n\\lim_{\\epsilon \\to 0} \\frac{\\frac{d}{d\\epsilon}(1 - \\exp(-\\epsilon t))}{\\frac{d}{d\\epsilon}(\\epsilon)} = \\lim_{\\epsilon \\to 0} \\frac{-(-t)\\exp(-\\epsilon t)}{1} = \\lim_{\\epsilon \\to 0} t \\exp(-\\epsilon t) = t\n$$\n这一步明确地展示了线性因子 $t$ 的出现。将此结果代回 $N_2(t)$ 的表达式中：\n$$\n\\lim_{\\lambda_{2}^{\\mathrm{eff}} \\to \\lambda_{1}^{\\mathrm{eff}}} N_2(t) = N_{20} \\exp(-\\lambda t) + b \\lambda N_{10} \\exp(-\\lambda t) \\cdot t\n$$\n合并各项，我们得到：\n$$\nN_2(t) = (N_{20} + b \\lambda N_{10} t) \\exp(-\\lambda t)\n$$\n这个结果与方法一中直接求解得到的结果完全相同，证实了该数学框架的一致性。作为线性系统中谐振现象特征的 $t \\exp(-\\lambda t)$ 项，是在相等特征值（移除常数）的极限下，通过解决不定式而自然产生的。",
            "answer": "$$\n\\boxed{(N_{20} + b \\lambda N_{10} t) \\exp(-\\lambda t)}\n$$"
        },
        {
            "introduction": "除了计算单个同位素的浓度，验证我们的模拟模型是否遵循基本物理定律（如物质守恒）也同样至关重要。对于一个没有外部源或汇的封闭嬗变网络，原子核的总数必须保持不变。本练习将燃耗矩阵 $\\mathbf{A}$ 的数学结构与粒子数守恒这一定律联系起来。您将从解析上证明，如果网络是封闭的（即矩阵 $\\mathbf{A}$ 的每一列之和为零），那么原子总数必然是守恒的。这项动手实践强化了抽象线性代数与物理现实之间的联系，而其中的数值验证部分则介绍了计算科学中的一项关键技能：编写单元测试来验证模拟代码的物理一致性。",
            "id": "4254316",
            "problem": "考虑一个用于核反应堆模拟的闭合同位素嬗变网络，该网络被建模为一个关于数密度的一阶常微分方程（ODE）系统。设数密度向量为 $\\mathbf{N}(t) \\in \\mathbb{R}^{n}$，其中每个分量 $N_{i}(t)$ 表示同位素 $i$ 在时间 $t$ 的数密度。假设跃迁是线性的，具有恒定的速率，并且网络内核素总数守恒（没有外部损失或增益）。定义跃迁矩阵 $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$，其约定为 $\\mathbf{A}_{ij}$ 是从同位素 $j$ 到同位素 $i$ 的转移速率系数。根据一个没有损失项的闭合网络的构造，$\\mathbf{A}$ 的每一列之和为零：对于每个同位素 $j$，$\\sum_{i=1}^{n} \\mathbf{A}_{ij} = 0$，这意味着从同位素 $j$ 的总流出量等于流入其他同位素的总量。\n\n动力学系统由以下基本燃耗模型给出\n$$\n\\frac{d\\mathbf{N}}{dt} = \\mathbf{A}\\,\\mathbf{N}\\,,\n$$\n其中 $t$ 是以秒为单位的时间，速率系数的单位是 $\\text{s}^{-1}$。每个测试都指定了初始条件 $\\mathbf{N}(0)$。\n\n任务1（解析）：从给定的ODE和表示为 $\\mathbf{1}^{\\top}\\mathbf{A}=\\mathbf{0}^{\\top}$ 的闭合网络性质出发（其中 $\\mathbf{1}$ 是全1向量，$\\mathbf{0}$ 是零向量），证明核素守恒定律成立；具体来说，证明总数密度 $\\mathbf{1}^{\\top}\\mathbf{N}(t)$ 对所有 $t \\geq 0$ 都是时间上的常数。您的推导必须从给定的ODE和$\\mathbf{A}$的既定结构性质开始，并使用经过充分检验的线性代数事实进行。不要引入任何外部损失项，也不要假设任何捷径解公式作为起点。\n\n任务2（数值验证）：实现一个程序，对以下每个测试用例，通过矩阵指数计算 $\\mathbf{N}(t)$，并数值验证核素守恒成立。对于每个测试用例，您必须返回两个布尔结果：\n- 首先，在数值容差 $\\epsilon = 10^{-10}$ 内验证结构性质 $\\mathbf{1}^{\\top}\\mathbf{A}=\\mathbf{0}^{\\top}$。\n- 其次，在相同的容差 $\\epsilon = 10^{-10}$ 内验证 $\\mathbf{1}^{\\top}\\mathbf{N}(t) = \\mathbf{1}^{\\top}\\mathbf{N}(0)$。\n\n使用 $\\mathbf{N}(t) = \\exp(\\mathbf{A} t)\\,\\mathbf{N}(0)$ 和标准浮点算术。数值容差意味着绝对差必须小于或等于 $\\epsilon \\cdot \\max\\{1, |\\mathbf{1}^{\\top}\\mathbf{N}(0)|\\}$。\n\n测试套件（单位：时间 $t$ 为秒，速率为 $\\text{s}^{-1}$，数密度为任意一致单位）：\n- 用例1（三同位素线性链，末端同位素稳定）：\n  $$\n  \\mathbf{A} = \n  \\begin{bmatrix}\n  -0.1  0  0 \\\\\n  0.1  -0.2  0 \\\\\n  0  0.2  0\n  \\end{bmatrix},\\quad\n  \\mathbf{N}(0) = \n  \\begin{bmatrix}\n  1.0 \\\\ 0.0 \\\\ 0.0\n  \\end{bmatrix},\\quad\n  t = 10.0.\n  $$\n- 用例2（五同位素分支网络，末端同位素稳定）：\n  $$\n  \\mathbf{A} =\n  \\begin{bmatrix}\n  -0.4  0  0  0  0 \\\\\n  0.28  -0.5  0  0  0 \\\\\n  0.12  0  -0.25  0  0 \\\\\n  0  0.5  0.25  -0.3  0 \\\\\n  0  0  0  0.3  0\n  \\end{bmatrix},\\quad\n  \\mathbf{N}(0) =\n  \\begin{bmatrix}\n  1.0 \\\\ 0.0 \\\\ 0.0 \\\\ 0.0 \\\\ 0.0\n  \\end{bmatrix},\\quad\n  t = 4.0.\n  $$\n- 用例3（三同位素循环网络，无稳定末端同位素，闭合循环）：\n  $$\n  \\mathbf{A} =\n  \\begin{bmatrix}\n  -5.0  0  3.0 \\\\\n  5.0  -7.0  0 \\\\\n  0  7.0  -3.0\n  \\end{bmatrix},\\quad\n  \\mathbf{N}(0) =\n  \\begin{bmatrix}\n  0.2 \\\\ 0.3 \\\\ 0.5\n  \\end{bmatrix},\\quad\n  t = 1.0.\n  $$\n- 用例4（零速率边界情况，恒等演化）：\n  $$\n  \\mathbf{A} =\n  \\begin{bmatrix}\n  0  0  0  0 \\\\\n  0  0  0  0 \\\\\n  0  0  0  0 \\\\\n  0  0  0  0\n  \\end{bmatrix},\\quad\n  \\mathbf{N}(0) =\n  \\begin{bmatrix}\n  0.1 \\\\ 0.2 \\\\ 0.3 \\\\ 0.4\n  \\end{bmatrix},\\quad\n  t = 123.0.\n  $$\n- 用例5（刚性四同位素线性链，快速跃迁）：\n  $$\n  \\mathbf{A} =\n  \\begin{bmatrix}\n  -100.0  0  0  0 \\\\\n  100.0  -200.0  0  0 \\\\\n  0  200.0  -50.0  0 \\\\\n  0  0  50.0  0\n  \\end{bmatrix},\\quad\n  \\mathbf{N}(0) =\n  \\begin{bmatrix}\n  1.0 \\\\ 0.0 \\\\ 0.0 \\\\ 0.0\n  \\end{bmatrix},\\quad\n  t = 0.1.\n  $$\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个用例，按顺序输出两个布尔值：首先是 $\\mathbf{1}^{\\top}\\mathbf{A}=\\mathbf{0}^{\\top}$ 的结构验证，然后是 $\\mathbf{1}^{\\top}\\mathbf{N}(t) = \\mathbf{1}^{\\top}\\mathbf{N}(0)$ 的守恒验证。最终输出必须按用例顺序将所有用例的结果聚合成一个扁平列表，例如 $\\left[\\text{result}_{1,1},\\text{result}_{1,2},\\text{result}_{2,1},\\text{result}_{2,2},\\ldots\\right]$。",
            "solution": "该问题是有效的，因为它具有科学依据、问题明确且客观。它提出了一个用于同位素嬗变网络的标准模型，并要求进行标准的解析证明和相应的数值验证。所有数据和条件均已提供且一致。\n\n**任务1：核素守恒的解析证明**\n\n系统中所有同位素在时间 $t$ 的总数密度由总和 $S(t) = \\sum_{i=1}^{n} N_{i}(t)$ 给出。这可以用向量表示法表示为全1向量 $\\mathbf{1} \\in \\mathbb{R}^{n}$ 与数密度向量 $\\mathbf{N}(t) \\in \\mathbb{R}^{n}$ 的点积：\n$$\nS(t) = \\mathbf{1}^{\\top}\\mathbf{N}(t)\n$$\n为了证明总数密度在时间上是恒定的，我们必须证明其时间导数对于所有 $t \\geq 0$ 都为零。我们计算 $S(t)$ 对时间 $t$ 的导数：\n$$\n\\frac{dS}{dt} = \\frac{d}{dt} \\left( \\mathbf{1}^{\\top}\\mathbf{N}(t) \\right)\n$$\n由于向量 $\\mathbf{1}$ 的分量是常数，我们可以将微分算子移到点积内部，仅作用于 $\\mathbf{N}(t)$：\n$$\n\\frac{dS}{dt} = \\mathbf{1}^{\\top} \\frac{d\\mathbf{N}}{dt}\n$$\n问题陈述提供了该网络的控制常微分方程（ODE）系统：\n$$\n\\frac{d\\mathbf{N}}{dt} = \\mathbf{A}\\,\\mathbf{N}\n$$\n将 $\\mathbf{N}$ 的时间导数表达式代入我们关于 $\\frac{dS}{dt}$ 的方程中，得到：\n$$\n\\frac{dS}{dt} = \\mathbf{1}^{\\top} (\\mathbf{A}\\,\\mathbf{N})\n$$\n利用矩阵-向量乘法的结合律，我们可以将各项重新组合为：\n$$\n\\frac{dS}{dt} = (\\mathbf{1}^{\\top}\\mathbf{A})\\,\\mathbf{N}\n$$\n问题陈述定义了一个闭合网络，其中核素总数是守恒的。这个性质在数学上表示为跃迁矩阵 $\\mathbf{A}$ 的每一列之和为零。在向量表示法中，这表示为 $\\mathbf{1}^{\\top}\\mathbf{A} = \\mathbf{0}^{\\top}$，其中 $\\mathbf{0}^{\\top}$ 是零行向量。将这个条件代入我们的方程中，得到：\n$$\n\\frac{dS}{dt} = \\mathbf{0}^{\\top} \\mathbf{N}\n$$\n零向量与任何向量 $\\mathbf{N}$ 的点积是标量零：\n$$\n\\frac{dS}{dt} = 0\n$$\n由于 $S(t)$ 的时间导数对于所有 $t \\geq 0$ 都为零，函数 $S(t)$ 必定是一个常数。这个常数的值由 $t=0$ 时的初始条件决定。因此，对于所有 $t \\geq 0$：\n$$\nS(t) = S(0)\n$$\n在向量表示法中，这正是核素守恒定律：\n$$\n\\mathbf{1}^{\\top}\\mathbf{N}(t) = \\mathbf{1}^{\\top}\\mathbf{N}(0)\n$$\n至此，解析证明完成。\n\n**任务2：数值验证程序**\n\n数值验证包括对每个测试用例进行两次检查，使用标准浮点算术。所有比较的容差为 $\\epsilon = 10^{-10}$。\n\n1.  **结构性质验证**：必须验证条件 $\\mathbf{1}^{\\top}\\mathbf{A} = \\mathbf{0}^{\\top}$。这等同于检查矩阵 $\\mathbf{A}$ 的每一列之和是否为零。对于从 $1$ 到 $n$ 的每一列 $j$，我们计算其和 $c_j = \\sum_{i=1}^{n} \\mathbf{A}_{ij}$。如果每一列和的绝对值小于或等于绝对容差 $\\epsilon$，则验证测试成功：\n    $$\n    |c_j| \\le \\epsilon \\quad \\text{对于所有 } j \\in \\{1, 2, \\ldots, n\\}\n    $$\n\n2.  **核素守恒验证**：必须验证守恒定律 $\\mathbf{1}^{\\top}\\mathbf{N}(t) = \\mathbf{1}^{\\top}\\mathbf{N}(0)$。这包括以下步骤：\n    a.  计算初始总数密度 $S_0 = \\mathbf{1}^{\\top}\\mathbf{N}(0) = \\sum_{i=1}^{n} N_i(0)$。\n    b.  线性ODE系统的解由 $\\mathbf{N}(t) = \\exp(\\mathbf{A}t)\\mathbf{N}(0)$ 给出，其中 $\\exp(\\cdot)$ 是矩阵指数。首先计算矩阵 $\\mathbf{A}t$，然后计算其指数，这将使用 `scipy.linalg.expm` 函数来完成。\n    c.  将得到的矩阵 $\\exp(\\mathbf{A}t)$ 与初始条件向量 $\\mathbf{N}(0)$ 相乘，计算出时间 $t$ 的数密度向量 $\\mathbf{N}(t)$。\n    d.  计算最终总数密度 $S_t = \\mathbf{1}^{\\top}\\mathbf{N}(t) = \\sum_{i=1}^{n} N_i(t)$。\n    e.  如果 $S_t$ 和 $S_0$ 之间的绝对差在指定的容差范围内，则验证测试成功。容差规则定义为：\n    $$\n    |S_t - S_0| \\le \\epsilon \\cdot \\max\\{1, |S_0|\\}\n    $$\n这个混合绝对-相对容差准则能恰当地处理初始总和 $S_0$ 可能很小或为零的情况。\n\n以下Python实现将对所有指定的测试用例执行这两项验证，并报告布尔结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the isotope transmutation problem by performing an analytical proof\n    and numerical verification for several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (three-isotope linear chain, stable terminal isotope)\n        (\n            np.array([\n                [-0.1, 0.0, 0.0],\n                [0.1, -0.2, 0.0],\n                [0.0, 0.2, 0.0]\n            ]),\n            np.array([1.0, 0.0, 0.0]),\n            10.0\n        ),\n        # Case 2 (five-isotope branching network, stable terminal isotope)\n        (\n            np.array([\n                [-0.4, 0.0, 0.0, 0.0, 0.0],\n                [0.28, -0.5, 0.0, 0.0, 0.0],\n                [0.12, 0.0, -0.25, 0.0, 0.0],\n                [0.0, 0.5, 0.25, -0.3, 0.0],\n                [0.0, 0.0, 0.0, 0.3, 0.0]\n            ]),\n            np.array([1.0, 0.0, 0.0, 0.0, 0.0]),\n            4.0\n        ),\n        # Case 3 (three-isotope cyclic network, no stable terminal isotope)\n        (\n            np.array([\n                [-5.0, 0.0, 3.0],\n                [5.0, -7.0, 0.0],\n                [0.0, 7.0, -3.0]\n            ]),\n            np.array([0.2, 0.3, 0.5]),\n            1.0\n        ),\n        # Case 4 (zero-rate boundary case, identity evolution)\n        (\n            np.array([\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0]\n            ]),\n            np.array([0.1, 0.2, 0.3, 0.4]),\n            123.0\n        ),\n        # Case 5 (stiff four-isotope linear chain, fast transitions)\n        (\n            np.array([\n                [-100.0, 0.0, 0.0, 0.0],\n                [100.0, -200.0, 0.0, 0.0],\n                [0.0, 200.0, -50.0, 0.0],\n                [0.0, 0.0, 50.0, 0.0]\n            ]),\n            np.array([1.0, 0.0, 0.0, 0.0]),\n            0.1\n        ),\n    ]\n\n    results = []\n    epsilon = 1e-10\n\n    for A, N0, t in test_cases:\n        # 1. Structural Verification: Check if 1^T * A = 0^T\n        # This is equivalent to checking if the sum of each column is zero.\n        column_sums = np.sum(A, axis=0)\n        # The check is against an absolute tolerance epsilon, as the target is 0.\n        structural_property_holds = np.all(np.abs(column_sums) = epsilon)\n        results.append(structural_property_holds)\n\n        # 2. Species Conservation Verification: Check if 1^T * N(t) = 1^T * N(0)\n        # Calculate initial total number density\n        S0 = np.sum(N0)\n\n        # Calculate N(t) = exp(A*t) * N(0)\n        At = A * t\n        exp_At = expm(At)\n        Nt = exp_At @ N0\n\n        # Calculate final total number density\n        St = np.sum(Nt)\n\n        # Define the tolerance based on the problem specification\n        tolerance = epsilon * max(1.0, abs(S0))\n        \n        conservation_holds = np.abs(St - S0) = tolerance\n        results.append(conservation_holds)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}