{
    "hands_on_practices": [
        {
            "introduction": "多重网格方法的核心在于有效组件的协同工作，而光滑子是第一个关键组件。本练习旨在通过局部傅里叶分析（LFA）来剖析加权雅可比光滑子，这是一种用于分析迭代法性能的基础工具。您将推导最佳的光滑化参数，并特别关注边界附近格式发生变化时的情况，这是设计稳健求解器时必须考虑的实际问题。",
            "id": "4236918",
            "problem": "考虑长度为 $L$ 的均匀平板中的一维、稳态、单群中子扩散方程，其真空边界条件施加于外推边界位置，使得标量通量在第一个和最后一个网格点上满足$\\phi = 0$。控制方程为\n$$\n- \\frac{d}{dx} \\left( D \\frac{d \\phi}{dx} \\right) + \\Sigma_a \\phi = q,\n$$\n其中 $D$ 是扩散系数，$\\Sigma_a$ 是宏观吸收截面，$q$ 是源项。在间距为 $h$ 的均匀网格上离散化该平板，节点未知数为 $\\{ \\phi_i \\}_{i=1}^{N}$，并施加狄利克雷值$\\phi_0 = 0$ 和$\\phi_{N+1} = 0$来表示外推边界位置上的真空边界。假设 $D$ 和 $\\Sigma_a$ 是常数。\n\n对内部点使用二阶中心有限差分格式进行离散，得到的线性系统可以写成 $A \\phi = b$ 的形式，其中 $A$ 在内部具有标准的三点格式。采用加权雅可比松弛进行多重网格光滑，但允许内部点和邻近边界点（由于真空边界，这些点只有一个未知邻点）使用不同的松弛权重。具体来说，对$i = 2, 3, \\dots, N-1$使用内部权重$\\omega$，对$i = 1$和$i = N$使用邻近边界权重$\\omega_b$。\n\n从离散方程和加权雅可比的定义出发，使用傅里叶误差模式 $e_i = \\exp( \\mathrm{i} \\theta i )$ 对内部的误差传播算子进行局域傅里叶分析 (LFA)。推导内部误差放大因子 $r_{\\mathrm{int}}(\\theta)$，并在高频段 $\\theta \\in [\\pi/2, \\pi]$ 上，通过在频段端点强制等波振荡来选择 $\\omega$ 以最小化最坏情况下的幅值 $\\max_{\\theta \\in [\\pi/2, \\pi]} | r_{\\mathrm{int}}(\\theta) |$。然后，对于邻近边界点，推导交替模式 $\\theta = \\pi$ 下的单边格式误差放大因子，并选择 $\\omega_b$ 使得邻近边界的放大幅值与内部的最坏情况幅值相匹配，从而使光滑子具有边界感知能力。\n\n将你的最终答案报告为由邻近边界权重 $\\omega_b$ 和所选内部权重实现的最坏情况光滑因子 $\\rho^\\star$ 组成的数对。将这两个量表示为以 $D$、$ \\Sigma_a $ 和 $h$ 表示的精确闭式解析表达式。不需要数值。",
            "solution": "用户要求我解决一个关于多重网格方法的问题。我将首先验证该问题。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n\n- **控制方程：** 一维、稳态、单群中子扩散方程：$- \\frac{d}{dx} \\left( D \\frac{d \\phi}{dx} \\right) + \\Sigma_a \\phi = q$。\n- **区域与参数：** 均匀平板，均匀网格间距 $h$，常数扩散系数 $D$，常数宏观吸收截面 $\\Sigma_a$。\n- **离散化：** 节点未知数 $\\{ \\phi_i \\}_{i=1}^{N}$。对内部点采用二阶中心有限差分格式。\n- **边界条件：** 狄利克雷值 $\\phi_0 = 0$ 和 $\\phi_{N+1} = 0$。\n- **线性系统：** 离散系统为 $A \\phi = b$。\n- **光滑子：** 加权雅可比松弛。\n- **松弛权重：** 内部权重 $\\omega$ (用于 $i \\in \\{2, \\dots, N-1\\}$) 和邻近边界权重 $\\omega_b$ (用于 $i \\in \\{1, N\\}$)。\n- **分析方法：** 使用误差模式 $e_i = \\exp(\\mathrm{i} \\theta i)$ 的局域傅里叶分析 (LFA)。\n- **内部权重优化：** 推导内部误差放大因子 $r_{\\mathrm{int}}(\\theta)$。通过强制等波振荡 $|r_{\\mathrm{int}}(\\pi/2)| = |r_{\\mathrm{int}}(\\pi)|$ 来选择 $\\omega$，以最小化 $\\max_{\\theta \\in [\\pi/2, \\pi]} |r_{\\mathrm{int}}(\\theta)|$。\n- **边界权重选择：** 推导模式 $\\theta = \\pi$ 下的单边格式误差放大因子。选择 $\\omega_b$ 以使其幅值与优化后的内部最坏情况幅值相匹配。\n- **要求输出：** 一个数对 $(\\omega_b, \\rho^\\star)$，其中 $\\rho^\\star$ 是最坏情况下的内部光滑因子，表示为关于 $D$、$ \\Sigma_a $ 和 $h$ 的闭式解析表达式。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n- **科学依据：** 该问题具有坚实的科学基础。中子扩散方程是反应堆物理的基石。有限差分法、加权雅可比迭代和局域傅里叶分析是偏微分方程数值分析中的标准和基本技术。\n- **适定性：** 该问题是适定的。给定偏微分方程的离散化是标准的，从而得到一个定义明确的线性系统。雅可比迭代子的 LFA 是一个标准过程，可以产生唯一的放大因子。$\\omega$ 的优化准则（等波振荡）是明确的，可以得到唯一的最佳值和相应的光滑因子。$\\omega_b$ 的条件也是明确的，可以唯一地确定其值。\n- **客观性：** 问题的陈述语言精确、客观、技术性强，没有歧义或主观看法。\n\n**第 3 步：结论与行动**\n该问题在科学上是合理的，是适定的、客观的。它包含了所有必要的信息，没有矛盾或缺陷。因此，该问题是**有效的**。我将继续进行详细求解。\n\n### 详细求解\n\n一维稳态中子扩散方程为：\n$$\n-D \\frac{d^2 \\phi}{dx^2} + \\Sigma_a \\phi = q\n$$\n对于常数 $D$ 和 $\\Sigma_a$。在间距为 $h$ 的均匀网格上，使用二阶中心有限差分格式，内部节点 $x_i$ 处的二阶导数近似为：\n$$\n\\frac{d^2 \\phi}{dx^2} \\bigg|_{x_i} \\approx \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2}\n$$\n将此代入扩散方程，得到内部节点 $i \\in \\{2, \\dots, N-1\\}$ 的离散方程：\n$$\n-D \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2} + \\Sigma_a \\phi_i = q_i\n$$\n整理该方程可得标准的三点格式：\n$$\n-\\frac{D}{h^2} \\phi_{i-1} + \\left(\\frac{2D}{h^2} + \\Sigma_a\\right) \\phi_i - \\frac{D}{h^2} \\phi_{i+1} = q_i\n$$\n这对应于系统 $A\\phi=b$ 中矩阵 $A$ 的一行。内部行的对角线元素为 $A_{ii} = \\frac{2D}{h^2} + \\Sigma_a$。\n\n用于更新解向量 $\\phi$ 的加权雅可比迭代由 $\\phi^{(k+1)} = \\phi^{(k)} - \\omega D_A^{-1} (A\\phi^{(k)} - b)$ 给出，其中 $D_A$ 是 $A$ 的对角部分。误差 $e^{(k)} = \\phi - \\phi^{(k)}$ 根据方程 $e^{(k+1)} = (I - \\omega D_A^{-1} A) e^{(k)}$ 进行传播。对于单个分量 $i$，误差更新为：\n$$\ne_i^{(k+1)} = (1-\\omega) e_i^{(k)} + \\frac{\\omega}{A_{ii}} \\sum_{j \\ne i} (-A_{ij}) e_j^{(k)}\n$$\n对于一个内部点 $i$，这变为：\n$$\ne_i^{(k+1)} = (1-\\omega) e_i^{(k)} + \\frac{\\omega}{\\frac{2D}{h^2} + \\Sigma_a} \\left( \\frac{D}{h^2} e_{i-1}^{(k)} + \\frac{D}{h^2} e_{i+1}^{(k)} \\right)\n$$\n为了进行局域傅里叶分析 (LFA)，我们考察单个傅里叶模式 $e_j^{(k)} = [r_{\\mathrm{int}}(\\theta)]^{k} \\exp(\\mathrm{i} \\theta j)$ 的放大情况。将此代入误差传播方程，并除以 $[r_{\\mathrm{int}}(\\theta)]^{k} \\exp(\\mathrm{i} \\theta i)$，得到放大因子 $r_{\\mathrm{int}}(\\theta)$：\n$$\nr_{\\mathrm{int}}(\\theta) = 1-\\omega + \\frac{\\omega \\frac{D}{h^2}}{\\frac{2D}{h^2} + \\Sigma_a} \\left( \\exp(-\\mathrm{i} \\theta) + \\exp(\\mathrm{i} \\theta) \\right)\n$$\n$$\nr_{\\mathrm{int}}(\\theta) = 1-\\omega + \\frac{2\\omega D/h^2}{2D/h^2 + \\Sigma_a} \\cos(\\theta)\n$$\n为简化表达式，我们定义无量纲参数 $\\alpha = \\frac{\\Sigma_a h^2}{2D}$。该参数表示一个网格单元上中子吸收与扩散的比率。\n放大因子可以重写为：\n$$\nr_{\\mathrm{int}}(\\theta) = 1-\\omega + \\frac{\\omega}{1 + \\frac{\\Sigma_a h^2}{2D}} \\cos(\\theta) = 1-\\omega + \\frac{\\omega}{1+\\alpha} \\cos(\\theta) = 1 - \\omega \\left(1 - \\frac{\\cos(\\theta)}{1+\\alpha}\\right)\n$$\n问题要求优化内部权重 $\\omega$ 以最小化光滑因子，其定义为 $\\rho = \\max_{\\theta \\in [\\pi/2, \\pi]} |r_{\\mathrm{int}}(\\theta)|$。最优值通过强制执行等波振荡条件 $|r_{\\mathrm{int}}(\\pi/2)| = |r_{\\mathrm{int}}(\\pi)|$ 来找到。\n我们在高频段的端点处计算 $r_{\\mathrm{int}}(\\theta)$ 的值：\n在 $\\theta = \\pi/2$ 处，$\\cos(\\pi/2) = 0$，所以 $r_{\\mathrm{int}}(\\pi/2) = 1-\\omega$。\n在 $\\theta = \\pi$ 处，$\\cos(\\pi) = -1$，所以 $r_{\\mathrm{int}}(\\pi) = 1 - \\omega\\left(1 - \\frac{-1}{1+\\alpha}\\right) = 1 - \\omega\\left(\\frac{2+\\alpha}{1+\\alpha}\\right)$。\n最优光滑子通常具有在 $0$ 附近振荡的放大因子。因此我们设 $r_{\\mathrm{int}}(\\pi/2) = -r_{\\mathrm{int}}(\\pi)$：\n$$\n1-\\omega = - \\left[ 1 - \\omega\\left(\\frac{2+\\alpha}{1+\\alpha}\\right) \\right]\n$$\n$$\n1-\\omega = -1 + \\omega\\left(\\frac{2+\\alpha}{1+\\alpha}\\right)\n$$\n$$\n2 = \\omega \\left( 1 + \\frac{2+\\alpha}{1+\\alpha} \\right) = \\omega \\left( \\frac{1+\\alpha+2+\\alpha}{1+\\alpha} \\right) = \\omega \\left( \\frac{3+2\\alpha}{1+\\alpha} \\right)\n$$\n求解最优内部权重 $\\omega$：\n$$\n\\omega = \\frac{2(1+\\alpha)}{3+2\\alpha}\n$$\n相应的最坏情况光滑因子 $\\rho^\\star$ 是频段端点处放大的幅值：\n$$\n\\rho^\\star = |r_{\\mathrm{int}}(\\pi/2)| = |1-\\omega| = \\left| 1 - \\frac{2(1+\\alpha)}{3+2\\alpha} \\right| = \\left| \\frac{3+2\\alpha - 2-2\\alpha}{3+2\\alpha} \\right| = \\left| \\frac{1}{3+2\\alpha} \\right|\n$$\n因为 $\\Sigma_a, D, h^2$ 是非负的，所以 $\\alpha \\ge 0$，因此 $3+2\\alpha > 0$。\n$$\n\\rho^\\star = \\frac{1}{3+2\\alpha}\n$$\n代入 $\\alpha = \\frac{\\Sigma_a h^2}{2D}$ 得到第一个所需量：\n$$\n\\rho^\\star = \\frac{1}{3 + 2\\left(\\frac{\\Sigma_a h^2}{2D}\\right)} = \\frac{1}{3 + \\frac{\\Sigma_a h^2}{D}} = \\frac{D}{3D + \\Sigma_a h^2}\n$$\n接下来，我们分析邻近边界的点，例如 $i=1$。利用边界条件 $\\phi_0 = 0$ 推导离散方程：\n$$\n-D \\frac{0 - 2\\phi_1 + \\phi_2}{h^2} + \\Sigma_a \\phi_1 = q_1 \\implies \\left(\\frac{2D}{h^2} + \\Sigma_a\\right)\\phi_1 - \\frac{D}{h^2}\\phi_2 = q_1\n$$\n对角元素 $A_{11}$ 与内部点相同。$i=1$ 处的加权雅可比误差更新使用邻近边界权重 $\\omega_b$：\n$$\ne_1^{(k+1)} = (1-\\omega_b) e_1^{(k)} + \\frac{\\omega_b}{\\frac{2D}{h^2} + \\Sigma_a} \\left( \\frac{D}{h^2} e_2^{(k)} \\right)\n$$\n我们针对最高频率模式 $\\theta = \\pi$ 进行分析，该模式下 $e_j = C(-1)^j$。设放大因子为 $r_b(\\pi)$。代入 $e_j^{(k)} = [r_b(\\pi)]^k C(-1)^j$ 得：\n$$\n[r_b(\\pi)]^{k+1} C(-1)^1 = (1-\\omega_b)[r_b(\\pi)]^k C(-1)^1 + \\frac{\\omega_b \\frac{D}{h^2}}{\\frac{2D}{h^2} + \\Sigma_a} [r_b(\\pi)]^k C(-1)^2\n$$\n除以 $[r_b(\\pi)]^k C$：\n$$\n-r_b(\\pi) = -(1-\\omega_b) + \\frac{\\omega_b \\frac{D}{h^2}}{\\frac{2D}{h^2} + \\Sigma_a}\n$$\n$$\nr_b(\\pi) = 1-\\omega_b - \\frac{\\omega_b}{2(1+\\alpha)} = 1 - \\omega_b\\left(1+\\frac{1}{2(1+\\alpha)}\\right) = 1 - \\omega_b\\left(\\frac{3+2\\alpha}{2(1+\\alpha)}\\right)\n$$\n问题要求选择 $\\omega_b$ 使得 $|r_b(\\pi)| = \\rho^\\star$。为保持一致性，我们强制最高频率模式在边界和内部的行为相似。内部的分析得出 $r_{\\mathrm{int}}(\\pi) = -\\rho^\\star$。因此，我们设 $r_b(\\pi) = -\\rho^\\star$：\n$$\n1 - \\omega_b\\left(\\frac{3+2\\alpha}{2(1+\\alpha)}\\right) = -\\rho^\\star = -\\frac{1}{3+2\\alpha}\n$$\n求解 $\\omega_b$：\n$$\n1 + \\frac{1}{3+2\\alpha} = \\omega_b\\left(\\frac{3+2\\alpha}{2(1+\\alpha)}\\right)\n$$\n$$\n\\frac{3+2\\alpha+1}{3+2\\alpha} = \\frac{4+2\\alpha}{3+2\\alpha} = \\omega_b\\left(\\frac{3+2\\alpha}{2(1+\\alpha)}\\right)\n$$\n$$\n\\omega_b = \\frac{2(2+\\alpha)}{3+2\\alpha} \\cdot \\frac{2(1+\\alpha)}{3+2\\alpha} = \\frac{4(1+\\alpha)(2+\\alpha)}{(3+2\\alpha)^2}\n$$\n最后，我们代入 $\\alpha = \\frac{\\Sigma_a h^2}{2D}$，用原始参数表示 $\\omega_b$：\n$$\n\\omega_b = \\frac{4\\left(1+\\frac{\\Sigma_a h^2}{2D}\\right)\\left(2+\\frac{\\Sigma_a h^2}{2D}\\right)}{\\left(3+2\\frac{\\Sigma_a h^2}{2D}\\right)^2} = \\frac{4\\left(\\frac{2D+\\Sigma_a h^2}{2D}\\right)\\left(\\frac{4D+\\Sigma_a h^2}{2D}\\right)}{\\left(\\frac{3D+\\Sigma_a h^2}{D}\\right)^2}\n$$\n$$\n\\omega_b = \\frac{\\frac{(2D+\\Sigma_a h^2)(4D+\\Sigma_a h^2)}{D^2}}{\\frac{(3D+\\Sigma_a h^2)^2}{D^2}} = \\frac{(2D + \\Sigma_a h^2)(4D + \\Sigma_a h^2)}{(3D + \\Sigma_a h^2)^2}\n$$\n最终答案是数对 $(\\omega_b, \\rho^\\star)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{(2D + \\Sigma_a h^2)(4D + \\Sigma_a h^2)}{(3D + \\Sigma_a h^2)^2} & \\frac{D}{3D + \\Sigma_a h^2} \\end{pmatrix} } $$"
        },
        {
            "introduction": "在光滑子处理高频误差后，粗网格校正负责消除顽固的低频误差，这是多重网格的第二个关键。对于反应堆物理中常见的非均匀介质问题，如何构建粗网格算子至关重要。本练习将引导您从第一性原理出发，推导并比较朴素的“再离散化”算子与更精确的伽辽金算子，从而深刻理解为何后者在处理材料属性剧烈变化时是必不可少的。",
            "id": "4236904",
            "problem": "考虑笛卡尔几何中的单群稳态中子扩散方程，其标量中子通量 $\\,\\phi(x,y)\\,$ 的表达式为 $-\\nabla \\cdot (D(x,y)\\,\\nabla \\phi) = 0$，其中 $D(x,y)$ 是扩散系数。假设在一个均匀的 $2 \\times 2$ 细网格上进行保守的单元中心有限体积离散化，该网格由边长为 $h$ 的方形单元组成，单元中心位于通常的中点，面中心的扩散通量通过Fick定律和法向流的连续性计算。扩散系数 $D(x,y)$ 以棋盘状模式非均匀分布：左上角细单元的 $D = D_{A}$，右上角为 $D = D_{B}$，左下角为 $D = D_{B}$，右下角为 $D = D_{A}$，其中 $D_{A} > 0$ 且 $D_{B} > 0$。\n\n通过将两个左侧细单元聚合为单个粗单元 $L$，并将两个右侧细单元聚合为单个粗单元 $R$，形成一个双单元粗网格。通过Galerkin投影定义多重网格粗化算子，其中限制算子 $R = P^{\\top}$，延拓算子 $P$ 在聚合体上是分片常数：一个粗网格自由度将其常数值注入其所有组成的细单元中，而在其他地方为零。作为比较，通过在双单元粗网格上离散化相同的扩散方程来定义一个重新离散化的粗化算子，使用相同的有限体积格式，其中粗单元扩散系数由每个聚合体内的体积平均值给出，即 $D_{L}^{c} = (D_{A} + D_{B})/2$ 和 $D_{R}^{c} = (D_{A} + D_{B})/2$。\n\n令粗网格上 $L$ 和 $R$ 之间的非对角元分别表示为 $A_{H}^{\\text{Gal}}(L,R)$（对于Galerkin算子）和 $A_{H}^{\\text{Red}}(L,R)$（对于重新离散化算子）。仅使用上述基本定义（Fick定律计算扩散通量、跨面法向流的连续性以及保守有限体积平衡），从第一性原理推导每个非对角元。然后计算其幅值之比\n$$\\mathcal{R} = \\frac{|A_{H}^{\\text{Red}}(L,R)|}{|A_{H}^{\\text{Gal}}(L,R)|}$$\n作为一个关于 $D_{A}$ 和 $D_{B}$ 的闭式解析表达式。\n\n最后，根据您的推导，简要解释对于给定的棋盘状非均匀性，哪种构造能更好地捕捉穿过粗化界面的细尺度物理。将最终比率 $\\mathcal{R}$ 作为您的答案。不需要四舍五入，最终表达式中不应包含单位。",
            "solution": "该问题要求推导两种多重网格粗化算子（Galerkin算子和重新离散化算子）的非对角元，并计算它们的幅值之比。分析基于在一个特定的 $2 \\times 2$ 非均匀网格上对稳态中子扩散方程 $-\\nabla \\cdot (D(x,y)\\,\\nabla \\phi) = 0$ 进行的单元中心有限体积离散化。\n\n首先，我们建立细网格离散化。区域是一个 $2 \\times 2$ 的方形单元网格，每个单元的边长为 $h$。单元编号如下：\n- 单元 $1$：左上角，扩散系数 $D_1 = D_A$。\n- 单元 $2$：右上角，扩散系数 $D_2 = D_B$。\n- 单元 $3$：左下角，扩散系数 $D_3 = D_B$。\n- 单元 $4$：右下角，扩散系数 $D_4 = D_A$。\n\n单元中心有限体积法得到一个线性方程组 $A_h \\phi_h = f_h$，其中 $\\phi_h = [\\phi_1, \\phi_2, \\phi_3, \\phi_4]^{\\top}$ 是单元平均通量的向量。单元 $i$ 的方程由保守平衡定律导出，该定律指出，离开单元的面电流之和为零（对于无源问题）。\n单元 $i$ 和单元 $j$ 之间面的电流由Fick定律给出。对于长度为 $h$ 的面和单元中心距离为 $h$ 的情况，积分电流（或通量）为 $F_{ij} = C_{ij}(\\phi_i - \\phi_j)$，其中 $C_{ij}$ 是传导系数。当 $i \\neq j$ 时，矩阵元 $A_{ij}$ 由 $A_{ij} = -C_{ij}$ 给出。传导系数定义为 $C_{ij} = \\frac{D_{ij} \\cdot (\\text{面面积})}{(\\text{单元距离})}$，其中 $D_{ij}$ 是界面处的扩散系数。\n对于边长为 $h$ 的方形网格上的二维问题，面面积为 $h$（单位深度），单元中心之间的距离为 $h$。因此，$C_{ij} = D_{ij}$。问题指定了法向流的连续性，这意味着界面扩散系数 $D_{ij}$ 应该是相邻单元扩散系数的调和平均值：$D_{ij} = \\frac{2 D_i D_j}{D_i + D_j}$。\n\n让我们计算相邻细单元之间的传导系数：\n- 界面 $1$-$2$：$C_{12} = \\frac{2 D_1 D_2}{D_1 + D_2} = \\frac{2 D_A D_B}{D_A + D_B}$。\n- 界面 $1$-$3$：$C_{13} = \\frac{2 D_1 D_3}{D_1 + D_3} = \\frac{2 D_A D_B}{D_A + D_B}$。\n- 界面 $2$-$4$：$C_{24} = \\frac{2 D_2 D_4}{D_2 + D_4} = \\frac{2 D_B D_A}{D_B + D_A}$。\n- 界面 $3$-$4$：$C_{34} = \\frac{2 D_3 D_4}{D_3 + D_4} = \\frac{2 D_B D_A}{D_B + D_A}$。\n所有四个传导系数都相同。我们用 $K = \\frac{2 D_A D_B}{D_A + D_B}$ 表示这个值。细网格矩阵 $A_h$ 的非对角元是 $A_{ij} = -K$（如果单元 $i$ 和 $j$ 相邻），否则为 $0$。对角元是 $A_{ii} = -\\sum_{j \\neq i} A_{ij}$。这给出了细网格算子矩阵：\n$$\nA_h = \\begin{pmatrix}\nC_{12}+C_{13} & -C_{12} & -C_{13} & 0 \\\\\n-C_{21} & C_{21}+C_{24} & 0 & -C_{24} \\\\\n-C_{31} & 0 & C_{31}+C_{34} & -C_{34} \\\\\n0 & -C_{42} & -C_{43} & C_{42}+C_{43}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2K & -K & -K & 0 \\\\\n-K & 2K & 0 & -K \\\\\n-K & 0 & 2K & -K \\\\\n0 & -K & -K & 2K\n\\end{pmatrix}\n$$\n\n接下来，我们构建Galerkin粗化算子 $A_{H}^{\\text{Gal}} = R A_h P$。粗网格由两个单元组成：$L$（聚合了细单元 $1$ 和 $3$）和 $R$（聚合了细单元 $2$ 和 $4$）。延拓算子 $P$ 通过分片常数注入将粗通量向量 $\\phi_H = [\\phi_L, \\phi_R]^{\\top}$ 映射到细通量向量 $\\phi_h$：$\\phi_1 = \\phi_L$，$\\phi_3 = \\phi_L$，$\\phi_2 = \\phi_R$，$\\phi_4 = \\phi_R$。以矩阵形式表示：\n$$\nP = \\begin{pmatrix}\n1 & 0 \\\\\n0 & 1 \\\\\n1 & 0 \\\\\n0 & 1\n\\end{pmatrix}\n$$\n限制算子 $R$ 是 $P$ 的转置：\n$$\nR = P^{\\top} = \\begin{pmatrix}\n1 & 0 & 1 & 0 \\\\\n0 & 1 & 0 & 1\n\\end{pmatrix}\n$$\n现在我们计算 $A_{H}^{\\text{Gal}} = R A_h P$：\n$$\nA_h P = \\begin{pmatrix}\n2K & -K & -K & 0 \\\\\n-K & 2K & 0 & -K \\\\\n-K & 0 & 2K & -K \\\\\n0 & -K & -K & 2K\n\\end{pmatrix}\n\\begin{pmatrix}\n1 & 0 \\\\\n0 & 1 \\\\\n1 & 0 \\\\\n0 & 1\n\\end{pmatrix} = \\begin{pmatrix}\n(2K-K) & -K \\\\\n-K & (2K-K) \\\\\n(-K+2K) & -K \\\\\n-K & (-K+2K)\n\\end{pmatrix} = \\begin{pmatrix}\nK & -K \\\\\n-K & K \\\\\nK & -K \\\\\n-K & K\n\\end{pmatrix}\n$$\n$$\nA_{H}^{\\text{Gal}} = R (A_h P) = \\begin{pmatrix}\n1 & 0 & 1 & 0 \\\\\n0 & 1 & 0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nK & -K \\\\\n-K & K \\\\\nK & -K \\\\\n-K & K\n\\end{pmatrix} = \\begin{pmatrix}\n(K+K) & (-K-K) \\\\\n(-K-K) & (K+K)\n\\end{pmatrix} = \\begin{pmatrix}\n2K & -2K \\\\\n-2K & 2K\n\\end{pmatrix}\n$$\nGalerkin算子的非对角元是 $A_{H}^{\\text{Gal}}(L,R) = -2K$。代入 $K$ 的表达式：\n$$A_{H}^{\\text{Gal}}(L,R) = -2 \\left( \\frac{2 D_A D_B}{D_A + D_B} \\right) = -\\frac{4 D_A D_B}{D_A + D_B}$$\n\n接下来，我们推导重新离散化的粗化算子 $A_{H}^{\\text{Red}}$。这涉及到在粗网格本身上离散化扩散方程。每个粗单元的尺寸为 $h \\times 2h$。粗单元的扩散系数是组成细单元的体积平均值。由于每个细单元的面积为 $h^2$：\n- $D_{L}^{c} = \\frac{D_A \\cdot h^2 + D_B \\cdot h^2}{h^2 + h^2} = \\frac{D_A + D_B}{2}$。\n- $D_{R}^{c} = \\frac{D_B \\cdot h^2 + D_A \\cdot h^2}{h^2 + h^2} = \\frac{D_A + D_B}{2}$。\n我们对这个双单元粗网格应用相同的有限体积格式。非对角元 $A_{H}^{\\text{Red}}(L,R)$ 是粗单元 $L$ 和 $R$ 之间传导系数 $C_{LR}$ 的负值。\n$$C_{LR} = \\frac{D_{\\text{int}} \\cdot (\\text{面面积})}{(\\text{单元距离})}$$\n单元 $L$ 和 $R$ 之间的界面面积（长度）为 $2h$。粗单元中心之间的距离是 $h$。界面扩散系数 $D_{\\text{int}}$ 是 $D_L^c$ 和 $D_R^c$ 的调和平均值：\n$$D_{\\text{int}} = \\frac{2 D_L^c D_R^c}{D_L^c + D_R^c} = \\frac{2 \\left(\\frac{D_A+D_B}{2}\\right) \\left(\\frac{D_A+D_B}{2}\\right)}{\\left(\\frac{D_A+D_B}{2}\\right) + \\left(\\frac{D_A+D_B}{2}\\right)} = \\frac{D_A+D_B}{2}$$\n因此，粗网格传导系数为：\n$$C_{LR} = \\frac{\\left(\\frac{D_A+D_B}{2}\\right) \\cdot (2h)}{h} = D_A + D_B$$\n重新离散化算子的非对角元是 $A_{H}^{\\text{Red}}(L,R) = -C_{LR} = -(D_A + D_B)$。\n\n最后，我们计算比率 $\\mathcal{R}$：\n$$\\mathcal{R} = \\frac{|A_{H}^{\\text{Red}}(L,R)|}{|A_{H}^{\\text{Gal}}(L,R)|} = \\frac{|-(D_A + D_B)|}{\\left|-\\frac{4 D_A D_B}{D_A + D_B}\\right|} = \\frac{D_A + D_B}{\\frac{4 D_A D_B}{D_A + D_B}}$$\n$$\\mathcal{R} = \\frac{(D_A + D_B)^2}{4 D_A D_B}$$\n\n基于此推导，我们可以评估哪种构造更优越。Galerkin算子的非对角项 $A_{H}^{\\text{Gal}}(L,R) = -2K$ 代表连接聚合体 $L$ 和 $R$ 的所有细尺度传导系数总和的负值。穿过粗化界面的总传导系数是构成它的两个细尺度界面（$1$-$2$ 和 $3$-$4$）的传导系数之和。这在物理上对应于两条平行的扩散路径，将其各自的传导系数相加（$K+K=2K$）正确地得到了总传导系数。因此，Galerkin算子准确地保留了穿过粗单元边界的总细尺度通量。\n相比之下，重新离散化算子首先计算每个粗单元内扩散系数的算术平均值，$D_L^c=D_R^c=(D_A+D_B)/2$。这个均匀化步骤平滑了关键的棋盘状非均匀性，从而创建了一个等效介质。随后在这个均匀化介质上的离散化得到的传导系数为 $D_A+D_B$。这个值与交替的高低电导率路径的物理扩散现实不符。比率 $\\mathcal{R}$ 是这种差异的度量。根据算术-几何均值不等式，$(D_A+D_B)^2 \\ge 4 D_A D_B$，因此 $\\mathcal{R} \\ge 1$。这表明，只要 $D_A \\neq D_B$，重新离散化的粗化算子就会高估粗单元之间的耦合（传导系数）。对于具有高对比度（$D_A \\gg D_B$ 或 $D_B \\gg D_A$）的问题，这种高估可能很严重，导致多重网格求解器的收敛性差。Galerkin构造通过正确地对物理路径求和，更好地捕捉了细尺度物理，是解决此类问题的首选方法。",
            "answer": "$$\\boxed{\\frac{(D_A + D_B)^2}{4 D_A D_B}}$$"
        },
        {
            "introduction": "掌握了有效的光滑子和稳健的粗网格算子后，最后的挑战是将它们组合成一个高效的整体循环。本练习引入了一个性能模型，用于探索每个多重网格循环的计算工作量与收敛速度之间的权衡。通过这个模型，您将学习如何优化 V-循环的关键参数，例如光滑步数和粗网格求解迭代次数，以实现最快的求解时间。",
            "id": "4236968",
            "problem": "考虑在三维反应堆堆芯网格上离散化的稳态多群中子扩散方程。为了加速定常源迭代，使用了一个双网格多重网格(MG)循环，该循环包括细网格光滑、限制到粗网格、不精确的粗网格求解、延长回细网格，以及随后的细网格后光滑。目标是选择循环参数，以便在指定的残差减少量下，最小化总求解时间。\n\n对双网格MG循环采用以下工作单元模型。每次细网格光滑扫描（类雅可比）的成本为 $c_s$ 个工作单元，单次从细网格到粗网格的转移（限制）成本为 $c_r$ 个工作单元，单次从粗网格到细网格的转移（延长）成本为 $c_p$ 个工作单元，每次粗网格内迭代的成本为 $c_c$ 个工作单元。设前光滑扫描次数为 $m$，后光滑扫描次数也为 $m$（即总共 $2m$ 次细网格光滑），并设粗网格内迭代次数为 $\\gamma$。每循环成本建模为\n$$\nW(m,\\gamma) \\;=\\; 2 m\\, c_s \\;+\\; c_r \\;+\\; c_p \\;+\\; \\gamma \\, c_c.\n$$\n\n假设一个循环后的误差可分解为一个主要由光滑衰减的高频分量和一个主要由粗网格校正衰减的低频分量。如果初始误差能量分为高频模式中的一部分 $\\alpha$ 和低频模式中的 $1-\\alpha$，并且单次细网格光滑扫描将高频模式减少一个因子 $\\sigma$，而单次粗网格内迭代将低频模式减少一个因子 $\\tau$，则每循环误差收缩因子建模为\n$$\nq(m,\\gamma) \\;=\\; \\sqrt{ \\alpha \\, \\sigma^{2m} \\;+\\; (1-\\alpha) \\, \\tau^{2\\gamma} }.\n$$\n\n为达到残差减少因子 $r_{\\mathrm{target}}$ 所需的循环次数是最小整数\n$$\nk(m,\\gamma) \\;=\\; \\left\\lceil \\frac{\\ln\\!\\big(r_{\\mathrm{target}}\\big)}{\\ln\\!\\big(q(m,\\gamma)\\big)} \\right\\rceil,\n$$\n那么总求解时间为\n$$\nT(m,\\gamma) \\;=\\; W(m,\\gamma)\\, k(m,\\gamma).\n$$\n\n对于一个代表性的压水反应堆(PWR)堆芯问题，测量得到的常数为：$c_s = 4.0$ ms, $c_r = 1.2$ ms, $c_p = 1.5$ ms, $c_c = 7.0$ ms, $\\alpha = 0.6$, $\\sigma = 0.5$, $\\tau = 0.3$，以及 $r_{\\mathrm{target}} = 10^{-8}$。将注意力限制在 $m \\in \\{\\,1,\\,2,\\,3\\,\\}$ 和 $\\gamma \\in \\{\\,1,\\,2,\\,3\\,\\}$。\n\n使用上述工作单元模型和收缩模型，确定在指定的 $m$ 和 $\\gamma$ 离散选择范围内，可能的最小总求解时间 $T_{\\min}$。请以秒为单位表示您的最终答案，并四舍五入到四位有效数字。",
            "solution": "首先将根据指定标准对问题进行验证。\n\n### 步骤1：提取已知条件\n问题提供了以下数据、定义和关系：\n-   **每循环工作成本模型：**\n    $$\n    W(m,\\gamma) \\;=\\; 2 m\\, c_s \\;+\\; c_r \\;+\\; c_p \\;+\\; \\gamma \\, c_c\n    $$\n-   **每循环误差收缩因子模型：**\n    $$\n    q(m,\\gamma) \\;=\\; \\sqrt{ \\alpha \\, \\sigma^{2m} \\;+\\; (1-\\alpha) \\, \\tau^{2\\gamma} }\n    $$\n-   **循环次数模型：**\n    $$\n    k(m,\\gamma) \\;=\\; \\left\\lceil \\frac{\\ln\\!\\big(r_{\\mathrm{target}}\\big)}{\\ln\\!\\big(q(m,\\gamma)\\big)} \\right\\rceil\n    $$\n-   **总求解时间模型：**\n    $$\n    T(m,\\gamma) \\;=\\; W(m,\\gamma)\\, k(m,\\gamma)\n    $$\n-   **待优化的变量：**\n    -   前/后光滑扫描次数: $m$\n    -   粗网格内迭代次数: $\\gamma$\n-   **变量的定义域：**\n    -   $m \\in \\{\\,1,\\,2,\\,3\\,\\}$\n    -   $\\gamma \\in \\{\\,1,\\,2,\\,3\\,\\}$\n-   **数值常数：**\n    -   细网格光滑成本: $c_s = 4.0$ ms\n    -   限制成本: $c_r = 1.2$ ms\n    -   延长成本: $c_p = 1.5$ ms\n    -   粗网格迭代成本: $c_c = 7.0$ ms\n    -   高频误差部分: $\\alpha = 0.6$\n    -   光滑因子: $\\sigma = 0.5$\n    -   粗网格求解因子: $\\tau = 0.3$\n    -   目标残差减少量: $r_{\\mathrm{target}} = 10^{-8}$\n\n### 步骤2：使用提取的已知条件进行验证\n对问题陈述进行严格审查：\n-   **科学依据：** 该问题描述了一个多重网格迭代求解器的简化性能模型。这种模型在每次迭代的计算工作量与收敛速度之间取得平衡，是数值分析中用于优化算法参数的标准且有效的工具。其基本概念（光滑、粗网格校正、误差模式）是多重网格理论的基础。该问题在科学上是合理的。\n-   **适定性：** 这是一个适定的离散优化任务。目标函数 $T(m, \\gamma)$ 定义明确，自变量 $(m, \\gamma)$ 的定义域是一个有限的离散集合。这保证了在指定集合内存在最小值并且可以达到。\n-   **客观性：** 问题使用精确的数学定义和客观的数值数据进行陈述。没有主观或模糊的术语。\n-   **完整性和一致性：** 提供了所有必要的参数和公式，并且没有内部矛盾。\n\n### 步骤3：结论与行动\n问题有效。将制定严谨的解决方案。\n\n目标是通过对离散域 $m \\in \\{1, 2, 3\\}$ 和 $\\gamma \\in \\{1, 2, 3\\}$ 中的所有对 $(m, \\gamma)$ 计算函数 $T(m,\\gamma)$，来找到可能的最小总求解时间 $T_{\\min}$。\n\n给定的参数是：\n$c_s = 4.0$, $c_r = 1.2$, $c_p = 1.5$, $c_c = 7.0$ (单位均为ms)。\n$\\alpha = 0.6$, $\\sigma = 0.5$, $\\tau = 0.3$，以及 $r_{\\mathrm{target}} = 10^{-8}$。\n\n首先，我们计算常数项。每次循环中限制和延长的组合成本为 $c_r + c_p = 1.2 + 1.5 = 2.7$ ms。$k(m,\\gamma)$ 表达式中的分子是 $\\ln(r_{\\mathrm{target}}) = \\ln(10^{-8}) = -8 \\ln(10) \\approx -18.42068$。\n\n我们现在为 $3 \\times 3 = 9$ 对 $(m, \\gamma)$ 中的每一对系统地计算 $T(m,\\gamma)$。所有时间计算最初都以毫秒 (ms) 为单位。\n\n**情况1：$m=1$**\n-   对于 $(m, \\gamma) = (1, 1)$：\n    $W(1,1) = 2(1)(4.0) + 2.7 + 1(7.0) = 8.0 + 2.7 + 7.0 = 17.7$ ms。\n    $q(1,1) = \\sqrt{0.6(0.5)^{2(1)} + (1-0.6)(0.3)^{2(1)}} = \\sqrt{0.6(0.25) + 0.4(0.09)} = \\sqrt{0.186} \\approx 0.43128$。\n    $k(1,1) = \\left\\lceil \\frac{-18.42068}{\\ln(0.43128)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-0.84095} \\right\\rceil = \\lceil 21.905 \\rceil = 22$。\n    $T(1,1) = 17.7 \\times 22 = 389.4$ ms。\n\n-   对于 $(m, \\gamma) = (1, 2)$：\n    $W(1,2) = 2(1)(4.0) + 2.7 + 2(7.0) = 8.0 + 2.7 + 14.0 = 24.7$ ms。\n    $q(1,2) = \\sqrt{0.6(0.5)^2 + 0.4(0.3)^4} = \\sqrt{0.15 + 0.4(0.0081)} = \\sqrt{0.15324} \\approx 0.39146$。\n    $k(1,2) = \\left\\lceil \\frac{-18.42068}{\\ln(0.39146)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-0.93796} \\right\\rceil = \\lceil 19.639 \\rceil = 20$。\n    $T(1,2) = 24.7 \\times 20 = 494.0$ ms。\n\n-   对于 $(m, \\gamma) = (1, 3)$：\n    $W(1,3) = 2(1)(4.0) + 2.7 + 3(7.0) = 8.0 + 2.7 + 21.0 = 31.7$ ms。\n    $q(1,3) = \\sqrt{0.6(0.5)^2 + 0.4(0.3)^6} = \\sqrt{0.15 + 0.4(0.000729)} = \\sqrt{0.1502916} \\approx 0.38767$。\n    $k(1,3) = \\left\\lceil \\frac{-18.42068}{\\ln(0.38767)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-0.94759} \\right\\rceil = \\lceil 19.439 \\rceil = 20$。\n    $T(1,3) = 31.7 \\times 20 = 634.0$ ms。\n\n**情况2：$m=2$**\n-   对于 $(m, \\gamma) = (2, 1)$：\n    $W(2,1) = 2(2)(4.0) + 2.7 + 1(7.0) = 16.0 + 2.7 + 7.0 = 25.7$ ms。\n    $q(2,1) = \\sqrt{0.6(0.5)^{2(2)} + 0.4(0.3)^{2(1)}} = \\sqrt{0.6(0.0625) + 0.4(0.09)} = \\sqrt{0.0735} \\approx 0.27111$。\n    $k(2,1) = \\left\\lceil \\frac{-18.42068}{\\ln(0.27111)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-1.30521} \\right\\rceil = \\lceil 14.113 \\rceil = 15$。\n    $T(2,1) = 25.7 \\times 15 = 385.5$ ms。\n\n-   对于 $(m, \\gamma) = (2, 2)$：\n    $W(2,2) = 2(2)(4.0) + 2.7 + 2(7.0) = 16.0 + 2.7 + 14.0 = 32.7$ ms。\n    $q(2,2) = \\sqrt{0.6(0.5)^4 + 0.4(0.3)^4} = \\sqrt{0.0375 + 0.00324} = \\sqrt{0.04074} \\approx 0.20184$。\n    $k(2,2) = \\left\\lceil \\frac{-18.42068}{\\ln(0.20184)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-1.60023} \\right\\rceil = \\lceil 11.511 \\rceil = 12$。\n    $T(2,2) = 32.7 \\times 12 = 392.4$ ms。\n\n-   对于 $(m, \\gamma) = (2, 3)$：\n    $W(2,3) = 2(2)(4.0) + 2.7 + 3(7.0) = 16.0 + 2.7 + 21.0 = 39.7$ ms。\n    $q(2,3) = \\sqrt{0.6(0.5)^4 + 0.4(0.3)^6} = \\sqrt{0.0375 + 0.0002916} = \\sqrt{0.0377916} \\approx 0.19440$。\n    $k(2,3) = \\left\\lceil \\frac{-18.42068}{\\ln(0.19440)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-1.63783} \\right\\rceil = \\lceil 11.247 \\rceil = 12$。\n    $T(2,3) = 39.7 \\times 12 = 476.4$ ms。\n\n**情况3：$m=3$**\n-   对于 $(m, \\gamma) = (3, 1)$：\n    $W(3,1) = 2(3)(4.0) + 2.7 + 1(7.0) = 24.0 + 2.7 + 7.0 = 33.7$ ms。\n    $q(3,1) = \\sqrt{0.6(0.5)^{2(3)} + 0.4(0.3)^{2(1)}} = \\sqrt{0.6(0.015625) + 0.4(0.09)} = \\sqrt{0.045375} \\approx 0.21299$。\n    $k(3,1) = \\left\\lceil \\frac{-18.42068}{\\ln(0.21299)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-1.54649} \\right\\rceil = \\lceil 11.911 \\rceil = 12$。\n    $T(3,1) = 33.7 \\times 12 = 404.4$ ms。\n\n-   对于 $(m, \\gamma) = (3, 2)$：\n    $W(3,2) = 2(3)(4.0) + 2.7 + 2(7.0) = 24.0 + 2.7 + 14.0 = 40.7$ ms。\n    $q(3,2) = \\sqrt{0.6(0.5)^6 + 0.4(0.3)^4} = \\sqrt{0.009375 + 0.00324} = \\sqrt{0.012615} \\approx 0.11232$。\n    $k(3,2) = \\left\\lceil \\frac{-18.42068}{\\ln(0.11232)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-2.18651} \\right\\rceil = \\lceil 8.425 \\rceil = 9$。\n    $T(3,2) = 40.7 \\times 9 = 366.3$ ms。\n\n-   对于 $(m, \\gamma) = (3, 3)$：\n    $W(3,3) = 2(3)(4.0) + 2.7 + 3(7.0) = 24.0 + 2.7 + 21.0 = 47.7$ ms。\n    $q(3,3) = \\sqrt{0.6(0.5)^6 + 0.4(0.3)^6} = \\sqrt{0.009375 + 0.0002916} = \\sqrt{0.0096666} \\approx 0.09832$。\n    $k(3,3) = \\left\\lceil \\frac{-18.42068}{\\ln(0.09832)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-2.32000} \\right\\rceil = \\lceil 7.940 \\rceil = 8$。\n    $T(3,3) = 47.7 \\times 8 = 381.6$ ms。\n\n**结论**\n通过比较所有九个计算出的 $T(m,\\gamma)$ 值：\n$T(1,1)=389.4$ ms, $T(1,2)=494.0$ ms, $T(1,3)=634.0$ ms\n$T(2,1)=385.5$ ms, $T(2,2)=392.4$ ms, $T(2,3)=476.4$ ms\n$T(3,1)=404.4$ ms, $T(3,2)=366.3$ ms, $T(3,3)=381.6$ ms\n\n最小值为 $T_{\\min} = 366.3$ ms，对应于参数 $(m, \\gamma) = (3, 2)$。题目要求以秒为单位，并四舍五入到四位有效数字来表示此结果。\n$$\nT_{\\min} = 366.3 \\text{ ms} = 0.3663 \\text{ s}\n$$\n这个值已经表示为四位有效数字。",
            "answer": "$$\n\\boxed{0.3663}\n$$"
        }
    ]
}