{
    "hands_on_practices": [
        {
            "introduction": "粗网格算子是多重网格方法能够高效消除低频误差的核心。然而，在处理非均匀介质问题时，如何构建一个既能保持计算效率又能准确反映细网格物理特性的粗网格算子，是一个关键的挑战。本练习  将引导您通过第一性原理推导，对比理论上稳健的伽辽金 (Galerkin) 算子与一种简化的“朴素”再离散化算子，从而深刻理解为何伽辽金方法对于捕捉非均匀问题中的多尺度物理现象至关重要。",
            "id": "4236904",
            "problem": "考虑笛卡尔坐标系中的单群稳态中子扩散方程，其标量中子通量 $\\,\\phi(x,y)\\,$ 表达式为 $-\\nabla \\cdot (D(x,y)\\,\\nabla \\phi) = 0$，其中 $D(x,y)$ 是扩散系数。假设在一个边长为 $h$ 的均匀 $2 \\times 2$ 方形单元细网格上进行保守的单元中心有限体积离散，单元中心位于通常的中点位置，面心的扩散通量通过菲克定律和法向流的连续性计算。扩散系数 $D(x,y)$ 呈棋盘格模式非均匀分布：左上角细单元的 $D = D_{A}$，右上角的 $D = D_{B}$，左下角的 $D = D_{B}$，右下角的 $D = D_{A}$，其中 $D_{A}  0$ 且 $D_{B}  0$。\n\n将左侧的两个细单元聚合成一个粗单元 $L$，并将右侧的两个细单元聚合成一个粗单元 $R$，从而形成一个双单元粗网格。通过伽辽金投影定义多重网格粗化算子，其中限制算子 $R = P^{\\top}$，延长算子 $P$ 在聚合体上是分片常数：一个粗网格自由度将其常数值注入其所有组成的细网格单元中，而在其他地方为零。作为对比，通过在双单元粗网格上使用相同的有限体积格式离散相同的扩散方程来定义一个再离散化粗化算子，其中粗单元扩散系数由每个聚合体内的体积平均值给出，即 $D_{L}^{c} = (D_{A} + D_{B})/2$ 和 $D_{R}^{c} = (D_{A} + D_{B})/2$。\n\n设伽辽金算子的粗网格非对角元（$L$ 和 $R$ 之间）表示为 $A_{H}^{\\text{Gal}}(L,R)$，再离散化算子的表示为 $A_{H}^{\\text{Red}}(L,R)$。仅使用上述基本定义（菲克定律计算扩散通量、跨面法向流的连续性以及保守有限体积平衡），从第一性原理推导每个非对角元。然后计算幅值之比\n$$\\mathcal{R} = \\frac{|A_{H}^{\\text{Red}}(L,R)|}{|A_{H}^{\\text{Gal}}(L,R)|}$$\n并用 $D_{A}$ 和 $D_{B}$ 表示为一个闭式解析表达式。\n\n最后，根据您的推导，简要解释对于给定的棋盘格非均匀性，哪种构造能更好地捕捉粗糙界面上的细尺度物理。将最终比率 $\\mathcal{R}$ 作为您的答案。无需四舍五入，最终表达式中不应包含单位。",
            "solution": "该问题要求推导两种多重网格粗化算子（伽辽金算子和再离散化算子）的非对角元，并计算它们的幅值之比。该分析基于在特定的 $2 \\times 2$ 非均匀网格上对稳态中子扩散方程 $-\\nabla \\cdot (D(x,y)\\,\\nabla \\phi) = 0$ 进行的单元中心有限体积离散。\n\n首先，我们建立细网格离散。区域是一个由边长为 $h$ 的方形单元组成的 $2 \\times 2$ 网格。我们将单元编号如下：\n- 单元 $1$：左上角，扩散系数为 $D_1 = D_A$。\n- 单元 $2$：右上角，扩散系数为 $D_2 = D_B$。\n- 单元 $3$：左下角，扩散系数为 $D_3 = D_B$。\n- 单元 $4$：右下角，扩散系数为 $D_4 = D_A$。\n\n单元中心有限体积法产生一个线性方程组 $A_h \\phi_h = f_h$，其中 $\\phi_h = [\\phi_1, \\phi_2, \\phi_3, \\phi_4]^{\\top}$ 是单元平均通量向量。单元 $i$ 的方程源于守恒平衡定律，该定律指出，离开单元各面的流之和为零（对于无源问题）。\n单元 $i$ 和单元 $j$ 之间面上的流由菲克定律给出。对于长度为 $h$ 的面和单元中心距为 $h$ 的情况，积分流（或通量）为 $F_{ij} = C_{ij}(\\phi_i - \\phi_j)$，其中 $C_{ij}$ 是传导率。当 $i \\neq j$ 时，矩阵元 $A_{ij}$ 由 $A_{ij} = -C_{ij}$ 给出。传导率定义为 $C_{ij} = \\frac{D_{ij} \\cdot (\\text{面面积})}{(\\text{单元距离})}$，其中 $D_{ij}$ 是界面处的扩散系数。\n对于边长为 $h$ 的方形网格上的二维问题，面面积为 $h$（单位深度），单元中心之间的距离为 $h$。因此，$C_{ij} = D_{ij}$。问题规定了法向流的连续性，这意味着界面扩散系数 $D_{ij}$ 应该是相邻单元扩散系数的调和平均值：$D_{ij} = \\frac{2 D_i D_j}{D_i + D_j}$。\n\n让我们计算相邻细单元之间的传导率：\n- 界面 $1$-$2$：$C_{12} = \\frac{2 D_1 D_2}{D_1 + D_2} = \\frac{2 D_A D_B}{D_A + D_B}$。\n- 界面 $1$-$3$：$C_{13} = \\frac{2 D_1 D_3}{D_1 + D_3} = \\frac{2 D_A D_B}{D_A + D_B}$。\n- 界面 $2$-$4$：$C_{24} = \\frac{2 D_2 D_4}{D_2 + D_4} = \\frac{2 D_B D_A}{D_B + D_A}$。\n- 界面 $3$-$4$：$C_{34} = \\frac{2 D_3 D_4}{D_3 + D_4} = \\frac{2 D_B D_A}{D_B + D_A}$。\n四个传导率都相同。我们用 $K = \\frac{2 D_A D_B}{D_A + D_B}$ 来表示这个值。细网格矩阵 $A_h$ 的非对角元在单元 $i$ 和 $j$ 相邻时为 $A_{ij} = -K$，否则为 $0$。对角元为 $A_{ii} = -\\sum_{j \\neq i} A_{ij}$。这样得到细网格算子矩阵：\n$$\nA_h = \\begin{pmatrix}\nC_{12}+C_{13}   -C_{12}   -C_{13}   0 \\\\\n-C_{21}   C_{21}+C_{24}   0   -C_{24} \\\\\n-C_{31}   0   C_{31}+C_{34}   -C_{34} \\\\\n0   -C_{42}   -C_{43}   C_{42}+C_{43}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2K   -K   -K   0 \\\\\n-K   2K   0   -K \\\\\n-K   0   2K   -K \\\\\n0   -K   -K   2K\n\\end{pmatrix}\n$$\n\n接下来，我们构造伽辽金粗化算子 $A_{H}^{\\text{Gal}} = R A_h P$。粗网格由两个单元组成：$L$（聚合了细单元 1 和 3）和 $R$（聚合了细单元 2 和 4）。延长算子 $P$ 通过分片常数注入将粗网格通量向量 $\\phi_H = [\\phi_L, \\phi_R]^{\\top}$ 映射到细网格通量向量 $\\phi_h$：$\\phi_1 = \\phi_L$, $\\phi_3 = \\phi_L$, $\\phi_2 = \\phi_R$, $\\phi_4 = \\phi_R$。其矩阵形式为：\n$$\nP = \\begin{pmatrix}\n1   0 \\\\\n0   1 \\\\\n1   0 \\\\\n0   1\n\\end{pmatrix}\n$$\n限制算子 $R$ 是 $P$ 的转置：\n$$\nR = P^{\\top} = \\begin{pmatrix}\n1   0   1   0 \\\\\n0   1   0   1\n\\end{pmatrix}\n$$\n现在我们计算 $A_{H}^{\\text{Gal}} = R A_h P$：\n$$\nA_h P = \\begin{pmatrix}\n2K   -K   -K   0 \\\\\n-K   2K   0   -K \\\\\n-K   0   2K   -K \\\\\n0   -K   -K   2K\n\\end{pmatrix}\n\\begin{pmatrix}\n1   0 \\\\\n0   1 \\\\\n1   0 \\\\\n0   1\n\\end{pmatrix} = \\begin{pmatrix}\n(2K-K)   -K \\\\\n-K   (2K-K) \\\\\n(-K+2K)   -K \\\\\n-K   (-K+2K)\n\\end{pmatrix} = \\begin{pmatrix}\nK   -K \\\\\n-K   K \\\\\nK   -K \\\\\n-K   K\n\\end{pmatrix}\n$$\n$$\nA_{H}^{\\text{Gal}} = R (A_h P) = \\begin{pmatrix}\n1   0   1   0 \\\\\n0   1   0   1\n\\end{pmatrix}\n\\begin{pmatrix}\nK   -K \\\\\n-K   K \\\\\nK   -K \\\\\n-K   K\n\\end{pmatrix} = \\begin{pmatrix}\n(K+K)   (-K-K) \\\\\n(-K-K)   (K+K)\n\\end{pmatrix} = \\begin{pmatrix}\n2K   -2K \\\\\n-2K   2K\n\\end{pmatrix}\n$$\n伽辽金算子的非对角元是 $A_{H}^{\\text{Gal}}(L,R) = -2K$。代入 $K$ 的表达式：\n$$A_{H}^{\\text{Gal}}(L,R) = -2 \\left( \\frac{2 D_A D_B}{D_A + D_B} \\right) = -\\frac{4 D_A D_B}{D_A + D_B}$$\n\n接下来，我们推导再离散化粗化算子 $A_{H}^{\\text{Red}}$。这涉及在粗网格本身上离散扩散方程。每个粗单元的尺寸为 $h \\times 2h$。粗单元的扩散系数是其组成的细单元的体积平均值。由于每个细单元的面积为 $h^2$：\n- $D_{L}^{c} = \\frac{D_A \\cdot h^2 + D_B \\cdot h^2}{h^2 + h^2} = \\frac{D_A + D_B}{2}$。\n- $D_{R}^{c} = \\frac{D_B \\cdot h^2 + D_A \\cdot h^2}{h^2 + h^2} = \\frac{D_A + D_B}{2}$。\n我们对这个双单元粗网格应用相同的有限体积格式。非对角元 $A_{H}^{\\text{Red}}(L,R)$ 是粗单元 $L$ 和 $R$ 之间传导率 $C_{LR}$ 的负值。\n$$C_{LR} = \\frac{D_{\\text{int}} \\cdot (\\text{面面积})}{(\\text{单元距离})}$$\n单元 $L$ 和 $R$ 之间的界面面积（长度）为 $2h$。粗单元中心之间的距离为 $h$。界面扩散系数 $D_{\\text{int}}$ 是 $D_L^c$ 和 $D_R^c$ 的调和平均值：\n$$D_{\\text{int}} = \\frac{2 D_L^c D_R^c}{D_L^c + D_R^c} = \\frac{2 \\left(\\frac{D_A+D_B}{2}\\right) \\left(\\frac{D_A+D_B}{2}\\right)}{\\left(\\frac{D_A+D_B}{2}\\right) + \\left(\\frac{D_A+D_B}{2}\\right)} = \\frac{D_A+D_B}{2}$$\n因此，粗网格传导率为：\n$$C_{LR} = \\frac{\\left(\\frac{D_A+D_B}{2}\\right) \\cdot (2h)}{h} = D_A + D_B$$\n再离散化算子的非对角元是 $A_{H}^{\\text{Red}}(L,R) = -C_{LR} = -(D_A + D_B)$。\n\n最后，我们计算比率 $\\mathcal{R}$：\n$$\\mathcal{R} = \\frac{|A_{H}^{\\text{Red}}(L,R)|}{|A_{H}^{\\text{Gal}}(L,R)|} = \\frac{|-(D_A + D_B)|}{\\left|-\\frac{4 D_A D_B}{D_A + D_B}\\right|} = \\frac{D_A + D_B}{\\frac{4 D_A D_B}{D_A + D_B}}$$\n$$\\mathcal{R} = \\frac{(D_A + D_B)^2}{4 D_A D_B}$$\n\n基于此推导，我们可以评估哪种构造更优越。伽辽金算子的非对角项 $A_{H}^{\\text{Gal}}(L,R) = -2K$ 表示连接聚合体 $L$ 和 $R$ 的所有细尺度传导率的总和的负值。穿过粗糙界面的总传导率是构成该界面的两个细尺度界面（1-2 和 3-4）的传导率之和。这在物理上对应于两个并行的扩散路径，将其各自的传导率相加（$K+K=2K$）可以正确地得到总传导率。因此，伽辽金算子精确地保持了穿过粗单元边界的总细尺度通量。\n相比之下，再离散化算子首先计算每个粗单元内扩散系数的算术平均值，$D_L^c=D_R^c=(D_A+D_B)/2$。这个均匀化步骤平滑了关键的棋盘格非均匀性，从而创建了一个有效介质。随后在这个均匀化介质上进行的离散化得出的传导率为 $D_A+D_B$。这个值与交替的高、低传导率路径上的物理扩散现实不符。比率 $\\mathcal{R}$ 是这种差异的度量。根据算术-几何平均不等式，$(D_A+D_B)^2 \\ge 4 D_A D_B$，因此 $\\mathcal{R} \\ge 1$。这表明，只要 $D_A \\neq D_B$，再离散化粗化算子就会高估粗单元之间的耦合（传导率）。对于高对比度问题（$D_A \\gg D_B$ 或 $D_B \\gg D_A$），这种高估可能非常严重，导致多重网格求解器收敛性差。伽辽金构造通过正确地对物理路径求和，能更好地捕捉细尺度物理，是处理此类问题的首选方法。",
            "answer": "$$\\boxed{\\frac{(D_A + D_B)^2}{4 D_A D_B}}$$"
        },
        {
            "introduction": "在掌握了粗网格校正的构建之后，我们转向多重网格的另一个关键组成部分：光滑子。光滑子的主要职责是衰减高频误差，但其性能可能会受到诸如区域边界等特殊条件的影响而下降。本练习  运用局部傅里叶分析 (Local Fourier Analysis, LFA) 这一强大工具，推导适用于边界附近单边格式的最优雅可比 (Jacobi) 松弛权重，展示了如何精细调节光滑子参数以确保其在整个计算域内的高效性。",
            "id": "4236918",
            "problem": "考虑一个长度为 $L$ 的均匀板中的一维、稳态、单群中子扩散方程，其真空边界在通过外推边界位置实现，使得标量通量在第一个和最后一个网格点处满足 $ \\phi = 0 $。其控制方程为\n$$\n- \\frac{d}{dx} \\left( D \\frac{d \\phi}{dx} \\right) + \\Sigma_a \\phi = q,\n$$\n其中 $D$ 是扩散系数，$\\Sigma_a$ 是宏观吸收截面，$q$ 是源项。在间距为 $h$ 的均匀网格上对该板进行离散化，节点未知数为 $\\{ \\phi_i \\}_{i=1}^{N}$，并施加狄利克雷值 $ \\phi_0 = 0 $ 和 $ \\phi_{N+1} = 0 $ 来表示外推边界位置处的真空边界。假设 $D$ 和 $\\Sigma_a$ 是常数。\n\n对内部点使用二阶中心有限差分格式进行离散化，得到的线性系统可以写成 $A \\phi = b$ 的形式，其中 $A$ 在内部具有标准的三点模板。采用加权雅可比松弛进行多重网格平滑，但允许内部点和边界邻近点（由于真空边界，这些点只有一个未知邻居）使用不同的松弛权重。具体来说，对 $ i = 2, 3, \\dots, N-1 $ 使用内部权重 $ \\omega $，对 $ i = 1 $ 和 $ i = N $ 使用边界邻近权重 $ \\omega_b $。\n\n从离散方程和加权雅可比的定义出发，使用傅里叶误差模式 $ e_i = \\exp( \\mathrm{i} \\theta i ) $ 对内部的误差传播算子进行局部傅里叶分析（LFA）。推导内部误差放大因子 $ r_{\\mathrm{int}}(\\theta) $，并在高频带 $ \\theta \\in [\\pi/2, \\pi] $ 上，通过在频带端点强制等振荡来选择 $ \\omega $ 以最小化最坏情况下的幅值 $ \\max_{\\theta \\in [\\pi/2, \\pi]} | r_{\\mathrm{int}}(\\theta) | $。然后，对于边界邻近点，推导交替模式 $ \\theta = \\pi $ 的单边模板误差放大因子，并选择 $ \\omega_b $ 使得边界邻近放大幅值与内部最坏情况下的幅值相匹配，从而使平滑器具有边界感知能力。\n\n将你的最终答案报告为由边界邻近权重 $ \\omega_b $ 和由所选内部权重实现的最坏情况平滑因子 $ \\rho^\\star $ 组成的数对。将这两个量表示为关于 $ D $、$ \\Sigma_a $ 和 $ h $ 的精确闭式解析表达式。不需要数值。",
            "solution": "一维稳态中子扩散方程如下：\n$$\n-D \\frac{d^2 \\phi}{dx^2} + \\Sigma_a \\phi = q\n$$\n对于常数 $D$ 和 $\\Sigma_a$。在间距为 $h$ 的均匀网格上，使用二阶中心有限差分格式，内部节点 $x_i$ 处的二阶导数近似为：\n$$\n\\frac{d^2 \\phi}{dx^2} \\bigg|_{x_i} \\approx \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2}\n$$\n将此代入扩散方程，得到内部节点 $i \\in \\{2, \\dots, N-1\\}$ 的离散方程：\n$$\n-D \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2} + \\Sigma_a \\phi_i = q_i\n$$\n重新整理此方程，得到标准的三点模板形式：\n$$\n-\\frac{D}{h^2} \\phi_{i-1} + \\left(\\frac{2D}{h^2} + \\Sigma_a\\right) \\phi_i - \\frac{D}{h^2} \\phi_{i+1} = q_i\n$$\n这对应于系统 $A\\phi=b$ 中矩阵 $A$ 的一行。内部行的对角线元素为 $A_{ii} = \\frac{2D}{h^2} + \\Sigma_a$。\n\n用于更新解向量 $\\phi$ 的加权雅可比迭代由 $\\phi^{(k+1)} = \\phi^{(k)} - \\omega D_A^{-1} (A\\phi^{(k)} - b)$ 给出，其中 $D_A$ 是 $A$ 的对角部分。误差 $e^{(k)} = \\phi - \\phi^{(k)}$ 根据方程 $e^{(k+1)} = (I - \\omega D_A^{-1} A) e^{(k)}$ 进行传播。对于单个分量 $i$，误差更新为：\n$$\ne_i^{(k+1)} = (1-\\omega) e_i^{(k)} + \\frac{\\omega}{A_{ii}} \\sum_{j \\ne i} (-A_{ij}) e_j^{(k)}\n$$\n对于一个内部点 $i$，这变为：\n$$\ne_i^{(k+1)} = (1-\\omega) e_i^{(k)} + \\frac{\\omega}{\\frac{2D}{h^2} + \\Sigma_a} \\left( \\frac{D}{h^2} e_{i-1}^{(k)} + \\frac{D}{h^2} e_{i+1}^{(k)} \\right)\n$$\n为了进行局部傅里叶分析（LFA），我们考察单个傅里叶模式 $e_j^{(k)} = [r_{\\mathrm{int}}(\\theta)]^{k} \\exp(\\mathrm{i} \\theta j)$ 的放大情况。将此代入误差传播方程，并除以 $[r_{\\mathrm{int}}(\\theta)]^{k} \\exp(\\mathrm{i} \\theta i)$，得到放大因子 $r_{\\mathrm{int}}(\\theta)$：\n$$\nr_{\\mathrm{int}}(\\theta) = 1-\\omega + \\frac{\\omega \\frac{D}{h^2}}{\\frac{2D}{h^2} + \\Sigma_a} \\left( \\exp(-\\mathrm{i} \\theta) + \\exp(\\mathrm{i} \\theta) \\right)\n$$\n$$\nr_{\\mathrm{int}}(\\theta) = 1-\\omega + \\frac{2\\omega D/h^2}{2D/h^2 + \\Sigma_a} \\cos(\\theta)\n$$\n为简化表达式，我们定义无量纲参数 $\\alpha = \\frac{\\Sigma_a h^2}{2D}$。该参数表示一个网格单元上中子吸收与扩散的比率。\n放大因子可以重写为：\n$$\nr_{\\mathrm{int}}(\\theta) = 1-\\omega + \\frac{\\omega}{1 + \\frac{\\Sigma_a h^2}{2D}} \\cos(\\theta) = 1-\\omega + \\frac{\\omega}{1+\\alpha} \\cos(\\theta) = 1 - \\omega \\left(1 - \\frac{\\cos(\\theta)}{1+\\alpha}\\right)\n$$\n问题要求优化内部权重 $\\omega$ 以最小化平滑因子，定义为 $\\rho = \\max_{\\theta \\in [\\pi/2, \\pi]} |r_{\\mathrm{int}}(\\theta)|$。最优值通过强制执行等振荡条件 $|r_{\\mathrm{int}}(\\pi/2)| = |r_{\\mathrm{int}}(\\pi)|$ 来找到。\n我们在高频带的端点处计算 $r_{\\mathrm{int}}(\\theta)$：\n当 $\\theta = \\pi/2$ 时，$\\cos(\\pi/2) = 0$，所以 $r_{\\mathrm{int}}(\\pi/2) = 1-\\omega$。\n当 $\\theta = \\pi$ 时，$\\cos(\\pi) = -1$，所以 $r_{\\mathrm{int}}(\\pi) = 1 - \\omega\\left(1 - \\frac{-1}{1+\\alpha}\\right) = 1 - \\omega\\left(\\frac{2+\\alpha}{1+\\alpha}\\right)$。\n最优平滑器的放大因子通常在 $0$ 附近振荡。因此，我们设置 $r_{\\mathrm{int}}(\\pi/2) = -r_{\\mathrm{int}}(\\pi)$：\n$$\n1-\\omega = - \\left[ 1 - \\omega\\left(\\frac{2+\\alpha}{1+\\alpha}\\right) \\right]\n$$\n$$\n1-\\omega = -1 + \\omega\\left(\\frac{2+\\alpha}{1+\\alpha}\\right)\n$$\n$$\n2 = \\omega \\left( 1 + \\frac{2+\\alpha}{1+\\alpha} \\right) = \\omega \\left( \\frac{1+\\alpha+2+\\alpha}{1+\\alpha} \\right) = \\omega \\left( \\frac{3+2\\alpha}{1+\\alpha} \\right)\n$$\n求解最优内部权重 $\\omega$：\n$$\n\\omega = \\frac{2(1+\\alpha)}{3+2\\alpha}\n$$\n相应的最坏情况平滑因子 $\\rho^\\star$ 是频带端点处放大的幅值：\n$$\n\\rho^\\star = |r_{\\mathrm{int}}(\\pi/2)| = |1-\\omega| = \\left| 1 - \\frac{2(1+\\alpha)}{3+2\\alpha} \\right| = \\left| \\frac{3+2\\alpha - 2-2\\alpha}{3+2\\alpha} \\right| = \\left| \\frac{1}{3+2\\alpha} \\right|\n$$\n由于 $\\Sigma_a, D, h^2$ 是非负的，所以 $\\alpha \\ge 0$，因此 $3+2\\alpha  0$。\n$$\n\\rho^\\star = \\frac{1}{3+2\\alpha}\n$$\n代入 $\\alpha = \\frac{\\Sigma_a h^2}{2D}$ 得到第一个所需的量：\n$$\n\\rho^\\star = \\frac{1}{3 + 2\\left(\\frac{\\Sigma_a h^2}{2D}\\right)} = \\frac{1}{3 + \\frac{\\Sigma_a h^2}{D}} = \\frac{D}{3D + \\Sigma_a h^2}\n$$\n接下来，我们分析边界邻近点，例如 $i=1$。使用边界条件 $\\phi_0 = 0$ 推导离散方程：\n$$\n-D \\frac{0 - 2\\phi_1 + \\phi_2}{h^2} + \\Sigma_a \\phi_1 = q_1 \\implies \\left(\\frac{2D}{h^2} + \\Sigma_a\\right)\\phi_1 - \\frac{D}{h^2}\\phi_2 = q_1\n$$\n对角元素 $A_{11}$ 与内部点相同。$i=1$ 的加权雅可比误差更新使用边界邻近权重 $\\omega_b$：\n$$\ne_1^{(k+1)} = (1-\\omega_b) e_1^{(k)} + \\frac{\\omega_b}{\\frac{2D}{h^2} + \\Sigma_a} \\left( \\frac{D}{h^2} e_2^{(k)} \\right)\n$$\n我们针对最高频率模式 $\\theta = \\pi$ 对此进行分析，对于该模式 $e_j = C(-1)^j$。设放大因子为 $r_b(\\pi)$。代入 $e_j^{(k)} = [r_b(\\pi)]^k C(-1)^j$ 得到：\n$$\n[r_b(\\pi)]^{k+1} C(-1)^1 = (1-\\omega_b)[r_b(\\pi)]^k C(-1)^1 + \\frac{\\omega_b \\frac{D}{h^2}}{\\frac{2D}{h^2} + \\Sigma_a} [r_b(\\pi)]^k C(-1)^2\n$$\n除以 $[r_b(\\pi)]^k C$：\n$$\n-r_b(\\pi) = -(1-\\omega_b) + \\frac{\\omega_b \\frac{D}{h^2}}{\\frac{2D}{h^2} + \\Sigma_a}\n$$\n$$\nr_b(\\pi) = 1-\\omega_b - \\frac{\\omega_b}{2(1+\\alpha)} = 1 - \\omega_b\\left(1+\\frac{1}{2(1+\\alpha)}\\right) = 1 - \\omega_b\\left(\\frac{3+2\\alpha}{2(1+\\alpha)}\\right)\n$$\n问题要求选择 $\\omega_b$ 使得 $|r_b(\\pi)| = \\rho^\\star$。为保持一致性，我们强制最高频率模式在边界和内部的行为相似。内部分析得到 $r_{\\mathrm{int}}(\\pi) = -\\rho^\\star$。因此，我们设置 $r_b(\\pi) = -\\rho^\\star$：\n$$\n1 - \\omega_b\\left(\\frac{3+2\\alpha}{2(1+\\alpha)}\\right) = -\\rho^\\star = -\\frac{1}{3+2\\alpha}\n$$\n求解 $\\omega_b$：\n$$\n1 + \\frac{1}{3+2\\alpha} = \\omega_b\\left(\\frac{3+2\\alpha}{2(1+\\alpha)}\\right)\n$$\n$$\n\\frac{3+2\\alpha+1}{3+2\\alpha} = \\frac{4+2\\alpha}{3+2\\alpha} = \\omega_b\\left(\\frac{3+2\\alpha}{2(1+\\alpha)}\\right)\n$$\n$$\n\\omega_b = \\frac{2(2+\\alpha)}{3+2\\alpha} \\cdot \\frac{2(1+\\alpha)}{3+2\\alpha} = \\frac{4(1+\\alpha)(2+\\alpha)}{(3+2\\alpha)^2}\n$$\n最后，我们代入 $\\alpha = \\frac{\\Sigma_a h^2}{2D}$ 以用原始参数表示 $\\omega_b$：\n$$\n\\omega_b = \\frac{4\\left(1+\\frac{\\Sigma_a h^2}{2D}\\right)\\left(2+\\frac{\\Sigma_a h^2}{2D}\\right)}{\\left(3+2\\frac{\\Sigma_a h^2}{2D}\\right)^2} = \\frac{4\\left(\\frac{2D+\\Sigma_a h^2}{2D}\\right)\\left(\\frac{4D+\\Sigma_a h^2}{2D}\\right)}{\\left(\\frac{3D+\\Sigma_a h^2}{D}\\right)^2}\n$$\n$$\n\\omega_b = \\frac{\\frac{(2D+\\Sigma_a h^2)(4D+\\Sigma_a h^2)}{D^2}}{\\frac{(3D+\\Sigma_a h^2)^2}{D^2}} = \\frac{(2D + \\Sigma_a h^2)(4D + \\Sigma_a h^2)}{(3D + \\Sigma_a h^2)^2}\n$$\n最终答案是数对 $(\\omega_b, \\rho^\\star)$。",
            "answer": "$$ \\boxed{\\left(\\frac{(2D + \\Sigma_a h^2)(4D + \\Sigma_a h^2)}{(3D + \\Sigma_a h^2)^2}, \\frac{D}{3D + \\Sigma_a h^2}\\right)} $$"
        },
        {
            "introduction": "理解了各个独立组件的设计原理后，最后一步是高效地将它们整合在多重网格循环中。一个多重网格方法的最终求解时间，取决于“每个循环的计算量”与“收敛速度”之间的权衡。本练习  建立了一个实用的性能模型，旨在通过优化光滑步和粗网格求解的次数来最小化总求解时间，它清晰地揭示了在实际应用中如何“调参”以达到最佳性能的艺术。",
            "id": "4236968",
            "problem": "考虑在三维反应堆堆芯网格上离散化的稳态多群中子扩散方程。为了加速定常源迭代，使用了一个双网格多重网格 (MG) 循环，该循环包括细网格光滑、限制到粗网格、非精确粗网格求解、延长回细网格，以及随后的细网格后光滑。目标是选择循环参数，以在给定的残差减少要求下，最小化总求解时间。\n\n对双网格 MG 循环采用以下工作单元模型。每次细网格光滑扫描（类雅可比）的成本为 $c_s$ 个工作单元，单次从细网格到粗网格的转移（限制）成本为 $c_r$ 个工作单元，单次从粗网格到细网格的转移（延长）成本为 $c_p$ 个工作单元，每次粗网格内迭代的成本为 $c_c$ 个工作单元。设前光滑扫描次数为 $m$，后光滑扫描次数也为 $m$（即总共 $2m$ 次细网格光滑），并设粗网格内迭代次数为 $\\gamma$。每个循环的成本模型为\n$$\nW(m,\\gamma) \\;=\\; 2 m\\, c_s \\;+\\; c_r \\;+\\; c_p \\;+\\; \\gamma \\, c_c.\n$$\n\n假设一个循环后的误差可分解为一个主要由光滑衰减的高频分量和一个主要由粗网格校正衰减的低频分量。如果初始误差能量按比例 $\\alpha$ 分布于高频模式，按比例 $1-\\alpha$ 分布于低频模式，并且单次细网格光滑扫描将高频模式减少一个因子 $\\sigma$，而单次粗网格内迭代将低频模式减少一个因子 $\\tau$，则每个循环的误差收缩因子模型为\n$$\nq(m,\\gamma) \\;=\\; \\sqrt{ \\alpha \\, \\sigma^{2m} \\;+\\; (1-\\alpha) \\, \\tau^{2\\gamma} }.\n$$\n\n为达到残差减少因子 $r_{\\mathrm{target}}$ 所需的循环次数是最小的整数\n$$\nk(m,\\gamma) \\;=\\; \\left\\lceil \\frac{\\ln\\!\\big(r_{\\mathrm{target}}\\big)}{\\ln\\!\\big(q(m,\\gamma)\\big)} \\right\\rceil,\n$$\n那么总求解时间为\n$$\nT(m,\\gamma) \\;=\\; W(m,\\gamma)\\, k(m,\\gamma).\n$$\n\n对于一个典型的压水反应堆 (PWR) 堆芯问题，测得的常数为：$c_s = 4.0$ ms，$c_r = 1.2$ ms，$c_p = 1.5$ ms，$c_c = 7.0$ ms，$\\alpha = 0.6$，$\\sigma = 0.5$，$\\tau = 0.3$ 和 $r_{\\mathrm{target}} = 10^{-8}$。将注意力限制在 $m \\in \\{\\,1,\\,2,\\,3\\,\\}$ 和 $\\gamma \\in \\{\\,1,\\,2,\\,3\\,\\}$ 的范围内。\n\n使用上述工作单元模型和收缩模型，在给定的 $m$ 和 $\\gamma$ 的离散选择范围内，确定最小可能总求解时间 $T_{\\min}$。用秒表示你的最终答案，并四舍五入到四位有效数字。",
            "solution": "目标是通过在离散域 $m \\in \\{1, 2, 3\\}$ 和 $\\gamma \\in \\{1, 2, 3\\}$ 中评估所有 $(m, \\gamma)$ 对的函数 $T(m,\\gamma)$，找到最小可能总求解时间 $T_{\\min}$。\n\n给定的参数是：\n$c_s = 4.0$，$c_r = 1.2$，$c_p = 1.5$，$c_c = 7.0$（单位均为 ms）。\n$\\alpha = 0.6$，$\\sigma = 0.5$，$\\tau = 0.3$ 和 $r_{\\mathrm{target}} = 10^{-8}$。\n\n首先，我们计算常数项。每个循环中限制和延长的组合成本为 $c_r + c_p = 1.2 + 1.5 = 2.7$ ms。$k(m,\\gamma)$ 表达式中的分子是 $\\ln(r_{\\mathrm{target}}) = \\ln(10^{-8}) = -8 \\ln(10) \\approx -18.42068$。\n\n我们现在为 $3 \\times 3 = 9$ 对 $(m, \\gamma)$ 中的每一对系统地评估 $T(m,\\gamma)$。所有时间计算最初都以毫秒 (ms) 为单位。\n\n**情况 1：$m=1$**\n-   对于 $(m, \\gamma) = (1, 1)$:\n    $W(1,1) = 2(1)(4.0) + 2.7 + 1(7.0) = 8.0 + 2.7 + 7.0 = 17.7$ ms。\n    $q(1,1) = \\sqrt{0.6(0.5)^{2(1)} + (1-0.6)(0.3)^{2(1)}} = \\sqrt{0.6(0.25) + 0.4(0.09)} = \\sqrt{0.186} \\approx 0.43128$。\n    $k(1,1) = \\left\\lceil \\frac{-18.42068}{\\ln(0.43128)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-0.84095} \\right\\rceil = \\lceil 21.905 \\rceil = 22$。\n    $T(1,1) = 17.7 \\times 22 = 389.4$ ms。\n\n-   对于 $(m, \\gamma) = (1, 2)$:\n    $W(1,2) = 2(1)(4.0) + 2.7 + 2(7.0) = 8.0 + 2.7 + 14.0 = 24.7$ ms。\n    $q(1,2) = \\sqrt{0.6(0.5)^2 + 0.4(0.3)^4} = \\sqrt{0.15 + 0.4(0.0081)} = \\sqrt{0.15324} \\approx 0.39146$。\n    $k(1,2) = \\left\\lceil \\frac{-18.42068}{\\ln(0.39146)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-0.93796} \\right\\rceil = \\lceil 19.639 \\rceil = 20$。\n    $T(1,2) = 24.7 \\times 20 = 494.0$ ms。\n\n-   对于 $(m, \\gamma) = (1, 3)$:\n    $W(1,3) = 2(1)(4.0) + 2.7 + 3(7.0) = 8.0 + 2.7 + 21.0 = 31.7$ ms。\n    $q(1,3) = \\sqrt{0.6(0.5)^2 + 0.4(0.3)^6} = \\sqrt{0.15 + 0.4(0.000729)} = \\sqrt{0.1502916} \\approx 0.38767$。\n    $k(1,3) = \\left\\lceil \\frac{-18.42068}{\\ln(0.38767)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-0.94759} \\right\\rceil = \\lceil 19.439 \\rceil = 20$。\n    $T(1,3) = 31.7 \\times 20 = 634.0$ ms。\n\n**情况 2：$m=2$**\n-   对于 $(m, \\gamma) = (2, 1)$:\n    $W(2,1) = 2(2)(4.0) + 2.7 + 1(7.0) = 16.0 + 2.7 + 7.0 = 25.7$ ms。\n    $q(2,1) = \\sqrt{0.6(0.5)^{2(2)} + 0.4(0.3)^{2(1)}} = \\sqrt{0.6(0.0625) + 0.4(0.09)} = \\sqrt{0.0735} \\approx 0.27111$。\n    $k(2,1) = \\left\\lceil \\frac{-18.42068}{\\ln(0.27111)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-1.30521} \\right\\rceil = \\lceil 14.113 \\rceil = 15$。\n    $T(2,1) = 25.7 \\times 15 = 385.5$ ms。\n\n-   对于 $(m, \\gamma) = (2, 2)$:\n    $W(2,2) = 2(2)(4.0) + 2.7 + 2(7.0) = 16.0 + 2.7 + 14.0 = 32.7$ ms。\n    $q(2,2) = \\sqrt{0.6(0.5)^4 + 0.4(0.3)^4} = \\sqrt{0.0375 + 0.00324} = \\sqrt{0.04074} \\approx 0.20184$。\n    $k(2,2) = \\left\\lceil \\frac{-18.42068}{\\ln(0.20184)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-1.60023} \\right\\rceil = \\lceil 11.511 \\rceil = 12$。\n    $T(2,2) = 32.7 \\times 12 = 392.4$ ms。\n\n-   对于 $(m, \\gamma) = (2, 3)$:\n    $W(2,3) = 2(2)(4.0) + 2.7 + 3(7.0) = 16.0 + 2.7 + 21.0 = 39.7$ ms。\n    $q(2,3) = \\sqrt{0.6(0.5)^4 + 0.4(0.3)^6} = \\sqrt{0.0375 + 0.0002916} = \\sqrt{0.0377916} \\approx 0.19440$。\n    $k(2,3) = \\left\\lceil \\frac{-18.42068}{\\ln(0.19440)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-1.63783} \\right\\rceil = \\lceil 11.247 \\rceil = 12$。\n    $T(2,3) = 39.7 \\times 12 = 476.4$ ms。\n\n**情况 3：$m=3$**\n-   对于 $(m, \\gamma) = (3, 1)$:\n    $W(3,1) = 2(3)(4.0) + 2.7 + 1(7.0) = 24.0 + 2.7 + 7.0 = 33.7$ ms。\n    $q(3,1) = \\sqrt{0.6(0.5)^{2(3)} + 0.4(0.3)^{2(1)}} = \\sqrt{0.6(0.015625) + 0.4(0.09)} = \\sqrt{0.045375} \\approx 0.21299$。\n    $k(3,1) = \\left\\lceil \\frac{-18.42068}{\\ln(0.21299)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-1.54649} \\right\\rceil = \\lceil 11.911 \\rceil = 12$。\n    $T(3,1) = 33.7 \\times 12 = 404.4$ ms。\n\n-   对于 $(m, \\gamma) = (3, 2)$:\n    $W(3,2) = 2(3)(4.0) + 2.7 + 2(7.0) = 24.0 + 2.7 + 14.0 = 40.7$ ms。\n    $q(3,2) = \\sqrt{0.6(0.5)^6 + 0.4(0.3)^4} = \\sqrt{0.009375 + 0.00324} = \\sqrt{0.012615} \\approx 0.11232$。\n    $k(3,2) = \\left\\lceil \\frac{-18.42068}{\\ln(0.11232)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-2.18651} \\right\\rceil = \\lceil 8.425 \\rceil = 9$。\n    $T(3,2) = 40.7 \\times 9 = 366.3$ ms。\n\n-   对于 $(m, \\gamma) = (3, 3)$:\n    $W(3,3) = 2(3)(4.0) + 2.7 + 3(7.0) = 24.0 + 2.7 + 21.0 = 47.7$ ms。\n    $q(3,3) = \\sqrt{0.6(0.5)^6 + 0.4(0.3)^6} = \\sqrt{0.009375 + 0.0002916} = \\sqrt{0.0096666} \\approx 0.09832$。\n    $k(3,3) = \\left\\lceil \\frac{-18.42068}{\\ln(0.09832)} \\right\\rceil = \\left\\lceil \\frac{-18.42068}{-2.32000} \\right\\rceil = \\lceil 7.940 \\rceil = 8$。\n    $T(3,3) = 47.7 \\times 8 = 381.6$ ms。\n\n**结论**\n通过比较所有九个计算出的 $T(m,\\gamma)$ 值：\n$T(1,1)=389.4$ ms, $T(1,2)=494.0$ ms, $T(1,3)=634.0$ ms\n$T(2,1)=385.5$ ms, $T(2,2)=392.4$ ms, $T(2,3)=476.4$ ms\n$T(3,1)=404.4$ ms, $T(3,2)=366.3$ ms, $T(3,3)=381.6$ ms\n\n最小值为 $T_{\\min} = 366.3$ ms，对应于参数 $(m, \\gamma) = (3, 2)$。问题要求结果以秒为单位，并四舍五入到四位有效数字。\n$$\nT_{\\min} = 366.3 \\text{ ms} = 0.3663 \\text{ s}\n$$\n该值已经表示为四位有效数字。",
            "answer": "$$\n\\boxed{0.3663}\n$$"
        }
    ]
}