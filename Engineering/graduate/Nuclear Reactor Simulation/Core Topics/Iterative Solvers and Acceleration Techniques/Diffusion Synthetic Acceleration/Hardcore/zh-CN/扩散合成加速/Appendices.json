{
    "hands_on_practices": [
        {
            "introduction": "在我们深入研究高级加速方法之前，首先必须理解它旨在改进的基本迭代格式的局限性。第一个实践练习将带您深入标准源迭代（SI）方法的核心。通过推导一个简化但富有洞察力的场景下源迭代的收敛因子，您将揭示其在散射主导问题中收敛缓慢的根本原因，从而明确建立对扩散合成加速（DSA）这类技术的需求。",
            "id": "4221984",
            "problem": "考虑一维平板几何中具有各向同性散射的稳态、单能线性玻尔兹曼输运方程，其角通量为 $\\psi(x,\\mu)$，其中 $x\\in\\mathbb{R}$ 是空间坐标，$\\mu\\in[-1,1]$ 是方向余弦，$\\Sigma_{t}$ 是总宏观截面，$\\Sigma_{s}$ 是各向同性散射宏观截面。设 $q(x)$ 表示一个固定的、各向同性的外源。标量通量定义为角通量对所有方向的角积分。使用离散纵标法（也称为 $S_{N}$ 方法，即 Discrete Ordinates Method (DOM)）对角变量进行离散化，其方向为 $\\{\\mu_{n}\\}_{n=1}^{N}$，正的求积权重为 $\\{w_{n}\\}_{n=1}^{N}$，这些权重用于近似 $\\mu\\in[-1,1]$ 上的积分。\n\n从基本输运理论出发，完成以下任务：\n\n- 推导方向未知数 $\\psi_{n}(x) = \\psi(x,\\mu_{n})$ 的离散纵标 $S_{N}$ 方程。\n- 用方向通量和求积权重给出标量通量 $\\phi(x)$ 的离散定义。\n- 明确陈述标量通量 $\\phi(x)$ 的源迭代更新式，其中右侧使用的散射源由上一次迭代的 $\\phi(x)$ 构造。\n\n然后，考虑一个无限均匀介质，其中 $\\Sigma_{t}$ 和 $\\Sigma_{s}$ 在空间上是常数，且 $q(x) = 0$。分析空间均匀误差模式下源迭代的渐进收敛性。定义散射比 $c = \\Sigma_{s}/\\Sigma_{t}$。在这些假设下，确定标量通量误差的渐进源迭代收敛因子 $\\rho_{\\mathrm{SI}}$，用 $c$ 表示。\n\n你的最终答案必须是 $\\rho_{\\mathrm{SI}}$ 的单个闭式解析表达式。不要求四舍五入，也不包含单位。",
            "solution": "用户提供的问题是核反应堆物理与输运理论领域中一个有效且适定的问题。所有给定条件在科学上都是合理的，且目标陈述清晰。我现在开始解答。\n\n问题始于一维平板几何中具有各向同性散射和一个固定各向同性外源的稳态、单能线性玻尔兹曼输运方程。该角通量 $\\psi(x,\\mu)$ 方程为：\n$$ \\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_{t}\\psi(x,\\mu) = \\frac{\\Sigma_{s}}{2}\\phi(x) + \\frac{q(x)}{2} $$\n其中 $x \\in \\mathbb{R}$ 是空间坐标，$\\mu \\in [-1,1]$ 是与 $x$ 轴夹角的方向余弦，$\\Sigma_{t}$ 是总宏观截面，$\\Sigma_{s}$ 是各向同性散射宏观截面， $q(x)$ 是各向同性外源密度。$\\phi(x)$ 项代表标量通量，定义为角通量在所有方向上的积分：\n$$ \\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu') \\, d\\mu' $$\n\n第一个任务是使用离散纵标法（$S_N$）将此方程离散化。该方法用一组离散方向 $\\{\\mu_{n}\\}_{n=1}^{N}$ 和相关的正求积权重 $\\{w_{n}\\}_{n=1}^{N}$ 替换连续的角变量 $\\mu$。在每个离散方向 $\\mu_{n}$ 处计算输运方程，得到一个包含 $N$ 个耦合常微分方程的系统，称为 $S_N$ 方程：\n$$ \\mu_{n} \\frac{d\\psi_{n}(x)}{dx} + \\Sigma_{t}\\psi_{n}(x) = \\frac{\\Sigma_{s}}{2}\\phi(x) + \\frac{q(x)}{2}, \\quad \\text{for } n=1, 2, \\ldots, N $$\n其中 $\\psi_{n}(x)$ 是 $\\psi(x,\\mu_{n})$ 的简写。\n\n第二个任务是提供标量通量 $\\phi(x)$ 的离散定义。在 $S_N$ 方法中，标量通量的积分由相应的求积和来近似：\n$$ \\phi(x) = \\sum_{m=1}^{N} w_{m} \\psi_{m}(x) $$\n将此离散定义代入 $S_N$ 方程，得到完全离散化的系统：\n$$ \\mu_{n} \\frac{d\\psi_{n}(x)}{dx} + \\Sigma_{t}\\psi_{n}(x) = \\frac{\\Sigma_{s}}{2} \\sum_{m=1}^{N} w_{m} \\psi_{m}(x) + \\frac{q(x)}{2}, \\quad \\text{for } n=1, 2, \\ldots, N $$\n\n第三个任务是陈述标量通量的源迭代更新。源迭代是一种不动点迭代法，其中散射源项使用前一次迭代的标量通量来计算。设 $k$ 为迭代指数。源迭代方案如下进行：\n1. 给定前一次迭代的标量通量 $\\phi^{(k)}(x)$，通过求解以下方程对每个方向 $n$ 求解下一次迭代的角通量 $\\psi_{n}^{(k+1)}(x)$：\n$$ \\mu_{n} \\frac{d\\psi_{n}^{(k+1)}(x)}{dx} + \\Sigma_{t}\\psi_{n}^{(k+1)}(x) = \\frac{\\Sigma_{s}}{2}\\phi^{(k)}(x) + \\frac{q(x)}{2} $$\n2. 然后使用新计算出的角通量更新标量通量：\n$$ \\phi^{(k+1)}(x) = \\sum_{n=1}^{N} w_{n} \\psi_{n}^{(k+1)}(x) $$\n这个两步过程定义了从 $\\phi^{(k)}$ 到 $\\phi^{(k+1)}$ 的迭代映射。\n\n最后一个任务是确定在特定情景下的渐进源迭代收敛因子 $\\rho_{\\mathrm{SI}}$：一个无限均匀介质，其中 $\\Sigma_{t}$ 和 $\\Sigma_{s}$ 是常数，无外源（$q(x)=0$），并且针对空间均匀的误差模式。\n\n设 $\\phi(x)$ 是输运问题的精确解，$\\phi^{(k)}(x)$ 是第 $k$ 次迭代的解。第 $k$ 次迭代中标量通量的误差定义为 $\\epsilon_{\\phi}^{(k)}(x) = \\phi^{(k)}(x) - \\phi(x)$。类似地，角通量的误差为 $\\epsilon_{\\psi,n}^{(k)}(x) = \\psi_{n}^{(k)}(x) - \\psi_{n}(x)$。由于输运方程是线性的，误差传播遵循相同的迭代方案，但去除了源项 $q(x)$：\n$$ \\mu_{n} \\frac{d\\epsilon_{\\psi,n}^{(k+1)}(x)}{dx} + \\Sigma_{t}\\epsilon_{\\psi,n}^{(k+1)}(x) = \\frac{\\Sigma_{s}}{2}\\epsilon_{\\phi}^{(k)}(x) $$\n标量通量误差的更新为：\n$$ \\epsilon_{\\phi}^{(k+1)}(x) = \\sum_{n=1}^{N} w_{n} \\epsilon_{\\psi,n}^{(k+1)}(x) $$\n我们被要求分析一个“空间均匀误差模式”。这意味着误差在空间上是恒定的，即 $\\epsilon_{\\phi}^{(k)}(x) = E_{\\phi}^{(k)}$ 和 $\\epsilon_{\\psi,n}^{(k+1)}(x) = E_{\\psi,n}^{(k+1)}$，其中 $E_{\\phi}^{(k)}$ 和 $E_{\\psi,n}^{(k+1)}$ 是常数。对于空间均匀的误差，导数项 $\\frac{d}{dx}$ 为零。角通量误差的方程简化为一个代数方程：\n$$ \\Sigma_{t} E_{\\psi,n}^{(k+1)} = \\frac{\\Sigma_{s}}{2}E_{\\phi}^{(k)} $$\n求解角通量误差分量，我们得到：\n$$ E_{\\psi,n}^{(k+1)} = \\frac{\\Sigma_{s}}{2\\Sigma_{t}}E_{\\phi}^{(k)} $$\n注意，角通量误差 $E_{\\psi,n}^{(k+1)}$ 与方向 $n$ 无关。现在，我们通过将此结果代入其定义来更新标量通量误差：\n$$ E_{\\phi}^{(k+1)} = \\sum_{n=1}^{N} w_{n} E_{\\psi,n}^{(k+1)} = \\sum_{n=1}^{N} w_{n} \\left( \\frac{\\Sigma_{s}}{2\\Sigma_{t}}E_{\\phi}^{(k)} \\right) = \\left( \\frac{\\Sigma_{s}}{2\\Sigma_{t}}E_{\\phi}^{(k)} \\right) \\sum_{n=1}^{N} w_{n} $$\n$S_N$ 方法中使用的求积组（如高斯-勒让德求积）的一个标准性质是，它们能精确地积分低阶多项式。对于常数函数 $f(\\mu)=1$，求积是精确的：\n$$ \\sum_{n=1}^{N} w_{n} = \\int_{-1}^{1} 1 \\, d\\mu = 2 $$\n将此性质代入 $E_{\\phi}^{(k+1)}$ 的表达式中，得到：\n$$ E_{\\phi}^{(k+1)} = \\left( \\frac{\\Sigma_{s}}{2\\Sigma_{t}} \\right) E_{\\phi}^{(k)} \\cdot (2) = \\frac{\\Sigma_{s}}{\\Sigma_{t}} E_{\\phi}^{(k)} $$\n问题将散射比定义为 $c = \\Sigma_{s}/\\Sigma_{t}$。因此，连续误差之间的关系是：\n$$ E_{\\phi}^{(k+1)} = c \\, E_{\\phi}^{(k)} $$\n渐进源迭代收敛因子 $\\rho_{\\mathrm{SI}}$ 是每次迭代中误差幅度减小的因子。对于这种简单的误差模式，它是连续误差的比值：\n$$ \\rho_{\\mathrm{SI}} = \\left| \\frac{E_{\\phi}^{(k+1)}}{E_{\\phi}^{(k)}} \\right| = |c| $$\n由于 $\\Sigma_{s}$ 和 $\\Sigma_{t}$ 是截面，它们是非负的，这意味着 $c \\ge 0$。因此， $|c| = c$。此分析对应于最平坦的，即 $\\lambda=0$ 的傅里叶模式，已知该模式决定了源迭代的渐进收敛速率。\n因此，渐进收敛因子等于散射比。\n$$ \\rho_{\\mathrm{SI}} = c $$",
            "answer": "$$\\boxed{c}$$"
        },
        {
            "introduction": "“综合”加速法的一个关键原则是，低阶算子必须忠实地模拟高阶算子的低频行为，这种一致性必须延伸到问题域的边界。本练习将直面一个在实现DSA时常见且关键的陷阱：边界条件不匹配。您将分析为何朴素的扩散边界条件会导致整个加速方案失效，并推导出能确保稳健收敛的、物理上一致的正确条件。",
            "id": "4222008",
            "problem": "考虑一个一维平板区域 $x \\in [0,L]$，其中充满了均匀的各向同性散射介质，其特征为总截面 $\\Sigma_t$、散射截面 $\\Sigma_s$ 和吸收截面 $\\Sigma_a = \\Sigma_t - \\Sigma_s$。在平板几何中，关于角通量 $\\psi(x,\\mu)$ 的稳态线性Boltzmann输运方程为\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\psi(x,\\mu) = \\frac{\\Sigma_s}{2} \\phi(x) + Q(x),\n$$\n其中标量通量为 $\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu) \\, d\\mu$，$Q(x)$ 是一个给定的各向同性源。高阶输运求解的真空边界条件是在两端施加零入射角通量：\n$$\n\\psi(0,\\mu) = 0 \\quad \\text{for} \\quad \\mu > 0, \\qquad \\psi(L,\\mu) = 0 \\quad \\text{for} \\quad \\mu  0.\n$$\n\n一种常见的迭代方法是源迭代，其中散射源使用前一次迭代的结果进行更新。扩散综合加速 (Diffusion Synthetic Acceleration, DSA) 通过求解一个关于误差修正场 $e(x)$ 的低阶扩散方程来增强源迭代，该方程近似地消除了高阶迭代中慢收敛的误差模式。在扩散极限下，修正量 $e(x)$ 满足一个类似扩散的方程，形式如下\n$$\n- \\frac{d}{dx} \\left( D \\frac{d e}{dx} \\right) + \\Sigma_a e = r(x),\n$$\n其中 $D$ 是扩散系数，$r(x)$ 是一个为表示散射源中输运迭代误差而构造的残差。对于各向同性介质，一个标准的选择是 $D = \\frac{1}{3} \\Sigma_t^{-1}$，这与一阶球谐函数闭合一致。DSA步骤使用 $e(x)$ 来更新输运扫描中的标量通量和散射源。\n\n假设高阶输运扫描使用上述精确的真空边界条件，而低阶扩散求解使用齐次Neumann边界条件，\n$$\n\\frac{de}{dx}(0) = 0, \\qquad \\frac{de}{dx}(L) = 0,\n$$\n这并未反映输运问题的半程真空条件。要求您从第一性原理出发，分析这种边界通量处理之间的不匹配对DSA加速的源迭代收敛性的影响。\n\n使用上述控制方程和边界定义，以及边界附近的一阶球谐函数 (P1) 表示，\n$$\n\\psi(x,\\mu) \\approx a(x) + b(x)\\mu, \\quad \\phi(x) = 2 a(x), \\quad J(x) = \\int_{-1}^{1} \\mu \\psi(x,\\mu)\\, d\\mu = \\frac{2}{3} b(x),\n$$\n和Fick定律 $J(x) = - D \\, \\frac{d \\phi}{dx}(x)$，推导扩散方程为与高阶真空边界保持一致所必须满足的边界条件，并推断在扩散求解中应用不匹配的边界条件对预处理迭代算子谱半径的影响。特别是，论证边界层误差模式是否会持续不衰减并导致非收敛加速。\n\n以下哪个陈述正确地指出了高阶输运扫描和低阶扩散求解之间边界通量处理不匹配导致非收敛加速的机制，并给出了适当的修正方法？\n\nA. 这种不匹配引入了一个内部扩散算子中未表示的边界层误差模式。由于齐次Neumann条件在边界上强制法向修正流为零，入射分流误差未得到修正，从而在预处理迭代中产生一个单位特征值模式，并可能导致发散。修正方法是对扩散求解施加源于输运方程真空条件的半程一致的Robin (Marshak)边界条件，即在真空边界处为 $\\frac{1}{2} e + D \\, \\hat{n} \\cdot \\nabla e = 0$，在全反射边界处为 $\\hat{n} \\cdot \\nabla e = 0$，并使用相同的离散纵标求积法计算边界残差。\n\nB. 这种不匹配仅影响标量通量守恒，但不会影响收敛性，因为扩散算子是椭圆的。修正方法是在边界表面将扩散系数 $D$ 乘以 $\\Sigma_t$ 以恢复守恒。\n\nC. 这种不匹配源于在输运中使用Robin条件。修正方法是在所有真空边界上为扩散求解设置Dirichlet边界条件 $\\phi = 0$，而不管输运边界条件如何，这保证了所有误差模式的衰减。\n\nD. 非收敛行为是由于瞬态问题中的时间步长误差。修正方法是减小时间步长直到DSA方案收敛，这使得边界条件与加速无关。\n\n选择正确的选项。",
            "solution": "我们从平板几何中的稳态线性Boltzmann输运方程开始，\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\psi(x,\\mu) = \\frac{\\Sigma_s}{2} \\phi(x) + Q(x),\n$$\n其真空边界条件为\n$$\n\\psi(0,\\mu) = 0 \\ \\text{for} \\ \\mu > 0, \\qquad \\psi(L,\\mu) = 0 \\ \\text{for} \\ \\mu  0.\n$$\n源迭代使用前一次迭代的结果更新散射源 $\\frac{\\Sigma_s}{2} \\phi(x)$，而扩散综合加速 (DSA) 旨在通过求解一个关于误差修正量 $e(x)$ 的扩散方程来消除误差中慢收敛的分量，\n$$\n- \\frac{d}{dx} \\left( D \\frac{d e}{dx} \\right) + \\Sigma_a e = r(x),\n$$\n对于各向同性散射，$D = \\frac{1}{3} \\Sigma_t^{-1}$，这与一阶球谐函数 (P1) 闭合一致，$r(x)$ 是一个近似表示散射源中输运误差的残差。\n\n分析的关键在于扩散求解中边界条件的处理。为与高阶真空边界保持一致，扩散方程必须在平均意义上再现零入射通量条件。我们使用边界附近的P1表示来将其形式化：\n$$\n\\psi(x,\\mu) \\approx a(x) + b(x)\\mu, \\qquad \\phi(x) = \\int_{-1}^{1} \\psi \\, d\\mu = 2 a(x), \\qquad J(x) = \\int_{-1}^{1} \\mu \\psi \\, d\\mu = \\frac{2}{3} b(x),\n$$\n和Fick定律（P1闭合下一个经过充分检验的近似），\n$$\nJ(x) = - D \\frac{d \\phi}{dx}(x).\n$$\n\n在左边界 ($x = 0$)，进入区域的入射分流为\n$$\nJ^{\\text{in}}(0) = \\int_{0}^{1} \\mu \\psi(0,\\mu) \\, d\\mu.\n$$\n在真空边界条件下，$J^{\\text{in}}(0) = 0$。在 $x=0$ 处使用P1近似，\n$$\nJ^{\\text{in}}(0) = \\int_0^1 \\mu \\left[a(0) + b(0)\\mu\\right] \\, d\\mu = \\frac{a(0)}{2} + \\frac{b(0)}{3}.\n$$\n用 $\\phi$ 和 $J$ 表示 $a$ 和 $b$：\n$$\na(0) = \\frac{\\phi(0)}{2}, \\qquad b(0) = \\frac{3}{2} J(0).\n$$\n因此，\n$$\nJ^{\\text{in}}(0) = \\frac{\\phi(0)}{4} + \\frac{J(0)}{2}.\n$$\n施加 $J^{\\text{in}}(0) = 0$ 可得\n$$\n\\frac{\\phi(0)}{4} + \\frac{J(0)}{2} = 0 \\quad \\Rightarrow \\quad J(0) = - \\frac{\\phi(0)}{2}.\n$$\n使用Fick定律并注意到在左边界，外向单位法向量 $\\hat{n}$ 指向负 $x$ 方向，$\\hat{n} \\cdot \\nabla \\phi = - \\frac{d \\phi}{dx}$，我们有\n$$\nJ(0) = - D \\frac{d \\phi}{dx}(0) = D \\, \\hat{n} \\cdot \\nabla \\phi(0).\n$$\n将其与 $J(0) = - \\frac{\\phi(0)}{2}$ 结合，得到在真空边界处扩散的经典Marshak (半程一致) Robin边界条件：\n$$\n\\frac{1}{2} \\phi(0) + D \\, \\hat{n} \\cdot \\nabla \\phi(0) = 0.\n$$\n在 $x=L$ 处进行相同的推导可得\n$$\n\\frac{1}{2} \\phi(L) + D \\, \\hat{n} \\cdot \\nabla \\phi(L) = 0,\n$$\n其中在 $x=L$ 处 $\\hat{n}$ 指向正 $x$ 方向。对于反射边界，输运条件强制净法向流为零；在P1/Fick定律下，一致的扩散边界变为\n$$\n\\hat{n} \\cdot \\nabla \\phi = 0 \\quad \\text{(Neumann)}.\n$$\n\n现在，考虑DSA修正量 $e(x)$，它遵循相同的算子，但由迭代残差 $r(x)$ 驱动。一致性要求 $e$ 的扩散边界条件以同样的方式从误差的入射分流上的半程输运边界条件导出。如果反之，在真空边界上施加齐次Neumann条件，\n$$\n\\frac{de}{dx}(0) = 0, \\qquad \\frac{de}{dx}(L) = 0,\n$$\n那么法向修正流 $J_e = - D \\frac{d e}{dx}$ 满足 $J_e(0) = 0$ 和 $J_e(L) = 0$。然而，每当高阶扫描的散射源不完美时，输运迭代误差就会在真空边界产生一个非零的入射分流误差 $J_e^{\\text{in}}$。Neumann条件禁止扩散求解生成必要的法向修正流来抵消这个入射分流误差。换句话说，扩散预处理器不对误差的边界层分量起作用。\n\n通过检查预处理迭代算子可以使这一点更精确。将输运源迭代误差表示为 $e^k(x)$，并将DSA修正解释为将预处理器 $P^{-1}$ 应用于与散射源更新相关的残差算子 $M$。预处理后的误差传播形式为\n$$\ne^{k+1} = \\left( I - P^{-1} M \\right) e^k.\n$$\n在内部，$P^{-1}$ 在谱上等价于扩散算子，并有效地衰减低频误差模式。在真空边界附近，入射分流分量定义了一个边界层模式，其特征是半程角结构和陡峭的空间衰减。在扩散求解使用不匹配的Neumann边界的情况下，$P^{-1}$ 对此模式没有作用，因为它在边界处强制 $J_e = 0$，而输运算子 $M$ 继续重新生成相同的入射误差。因此，复合算子 $I - P^{-1} M$ 使边界层模式保持不变，从而为该模式产生一个单位特征值：\n$$\n\\rho\\left( I - P^{-1} M \\right) \\ge 1 \\quad \\text{(boundary-layer mode)},\n$$\n并且DSA不对该分量提供加速；由于未衰减的模式污染了迭代，整个方案可能会停滞或发散。\n\n相反，如果扩散边界以上述推导的半程一致的Robin形式施加，扩散修正将在边界处提供适当的法向流以抵消入射分流误差，从而衰减边界层模式。更一般地，对于具有反射率参数 $\\alpha \\in [0,1)$ 且满足 $J^{\\text{in}} = \\alpha J^{\\text{out}}$ 的反照率边界，基于P1的一致扩散边界变为\n$$\n\\frac{1}{2} (1 - \\alpha) \\phi + D \\, \\hat{n} \\cdot \\nabla \\phi = 0,\n$$\n并且对DSA修正量 $e$ 也应使用相同的形式。将低阶边界条件与高阶半程物理相匹配，确保 $P^{-1}$ 对所有慢误差模式（包括边界层）起作用，并将谱半径驱动到单位一以下。\n\n逐个选项分析：\n\nA. 该选项正确地指出，不匹配使得一个边界层误差模式未被处理，导致预处理迭代中出现单位特征值并可能导致非收敛。它给出了适当的修正方法：在真空边界上对扩散求解施加半程一致的Robin (Marshak)边界条件，\n$$\n\\frac{1}{2} e + D \\, \\hat{n} \\cdot \\nabla e = 0,\n$$\n在反射边界上施加Neumann条件，并与离散纵标求积法一致地计算边界残差。这与上述推导相符。结论：正确。\n\nB. 该选项声称仅凭椭圆性就可保证收敛，这是错误的，因为存在未被预处理器耦合的边界层模式；内部算子的椭圆性不能解决不匹配的边界问题。在边界上将 $D$ 乘以 $\\Sigma_t$ 是一个特设的方法，并不能恢复半程一致性。结论：不正确。\n\nC. 该选项建议在真空边界上对扩散施加Dirichlet条件 $\\phi = 0$。虽然外推边界条件有时可以通过在偏移位置的Dirichlet条件来近似，但在物理边界上施加 $\\phi = 0$ 与半程输运真空不一致，并且不能保证边界层误差的衰减；它可能会过度约束和扭曲修正，从而可能损害收敛。结论：不正确。\n\nD. 该选项将问题归因于瞬态问题中的时间步长误差，但该情景是稳态的，即使在瞬态问题中，边界条件不匹配也会破坏DSA。减小时间步长并不能解决高阶和低阶边界处理之间的根本不匹配。结论：不正确。\n\n因此，正确的陈述和修正方法在选项A中给出。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "现实世界中的反应堆物理问题很少是单能的。这项实践将我们的分析扩展到多群情况，其中能群之间的能量耦合带来了新的挑战，特别是上散射现象。通过傅里叶分析，您将量化如果低阶扩散求解器在能量群之间不进行耦合，上散射会如何降低甚至破坏DSA的有效性，从而证明在高阶物理和低阶预条件子之间保持一致性的必要性——不仅在空间上，在能量上也是如此。",
            "id": "4221991",
            "problem": "考虑一个在扩散综合加速（DSA）背景下分析的一维、均匀、双能群中子输运问题，该问题具有各向同性散射和周期性边界条件。令群通量矢量为 $\\boldsymbol{\\phi} = [\\phi_1,\\phi_2]^T$，散射截面矩阵记为\n$$\n\\mathbf{S} = \\begin{bmatrix}\n\\Sigma_{s,11}  \\Sigma_{s,12} \\\\\n\\Sigma_{s,21}  \\Sigma_{s,22}\n\\end{bmatrix},\n$$\n其中 $\\Sigma_{s,12}  0$ 表示从群 $2$ 到群 $1$ 的上散射。令移出截面为 $\\Sigma_{r,1}  0$ 和 $\\Sigma_{r,2}  0$。对于波数为 $k$（单位为 $\\mathrm{cm}^{-1}$）的空间傅里叶模式，群 $g \\in \\{1,2\\}$ 的高阶输运扫描算子的傅里叶符号由以下模型给出\n$$\nQ^{\\mathrm{HO}}_g(k) = \\frac{1}{\\Sigma_{r,g} + v_g |k|},\n$$\n其中 $v_g  0$ 的单位为 $\\mathrm{cm}$，反映了高阶输运扫描的有效流漏尺度。由此可得源迭代（SI）误差传播矩阵\n$$\n\\mathbf{G}(k) = \\begin{bmatrix}\nQ^{\\mathrm{HO}}_1(k)  0 \\\\\n0  Q^{\\mathrm{HO}}_2(k)\n\\end{bmatrix} \\mathbf{S}.\n$$\n定义群 $g$ 的低阶扩散算子的傅里叶符号为\n$$\nQ^{\\mathrm{LO}}_g(k) = \\frac{1}{\\Sigma_{r,g} + D_g k^2},\n$$\n其中 $D_g  0$ 是扩散系数，单位为 $\\mathrm{cm}$。在 DSA 中使用的低阶（LO）矩阵 $\\mathbf{G}_d(k)$ 可通过以下任一方式构建：\n- 非耦合低阶（Uncoupled LO）：$\\mathbf{S}_d = \\mathrm{diag}(\\Sigma_{s,11},\\Sigma_{s,22})$，因此\n$$\n\\mathbf{G}_d^{\\mathrm{unc}}(k) = \\begin{bmatrix}\nQ^{\\mathrm{LO}}_1(k)  0 \\\\\n0  Q^{\\mathrm{LO}}_2(k)\n\\end{bmatrix} \\mathrm{diag}(\\Sigma_{s,11},\\Sigma_{s,22}).\n$$\n- 耦合低阶（Coupled LO）：$\\mathbf{S}_d = \\mathbf{S}$，因此\n$$\n\\mathbf{G}_d^{\\mathrm{cpl}}(k) = \\begin{bmatrix}\nQ^{\\mathrm{LO}}_1(k)  0 \\\\\n0  Q^{\\mathrm{LO}}_2(k)\n\\end{bmatrix} \\mathbf{S}.\n$$\n用于 DSA 的预处理 Richardson 更新使用低阶算子作为误差方程的预处理器，从而得到误差传播矩阵\n$$\n\\mathbf{M}_{\\mathrm{DSA}}(k) = \\mathbf{I} - \\left(\\mathbf{I} - \\mathbf{G}_d(k)\\right)^{-1} \\left(\\mathbf{I} - \\mathbf{G}(k)\\right),\n$$\n其中 $\\mathbf{I}$ 是 $2 \\times 2$ 单位矩阵，而 $\\mathbf{G}_d(k)$ 是 $\\mathbf{G}_d^{\\mathrm{unc}}(k)$ 或 $\\mathbf{G}_d^{\\mathrm{cpl}}(k)$，具体取决于低阶求解是采用非耦合还是耦合方式。矩阵的谱半径 $\\rho(\\cdot)$ 定义为其特征值绝对值的最大值。\n\n您的任务是为每个提供的参数集计算以下三个量：\n1. 不使用 DSA 的源迭代的谱半径 $\\rho\\left(\\mathbf{G}(k)\\right)$。\n2. 使用非耦合低阶求解的 DSA 的谱半径 $\\rho\\left(\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{unc}}(k)\\right)$。\n3. 使用耦合低阶求解的 DSA 的谱半径 $\\rho\\left(\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{cpl}}(k)\\right)$。\n\n所有输入在物理上都是合理的，并使用一致的单位，但每个谱半径都是无量纲的。将每个返回的值表示为浮点数。您的程序必须为下面的测试套件计算这些量，并将所有情况的结果作为单行输出，其格式为逗号分隔的列表的列表，每个内部列表按以下顺序排列\n$$\n\\left[\\rho\\left(\\mathbf{G}(k)\\right), \\ \\rho\\left(\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{unc}}(k)\\right), \\ \\rho\\left(\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{cpl}}(k)\\right)\\right].\n$$\n将每个浮点结果四舍五入到六位小数。\n\n测试套件（四个案例）：\n- 案例 A（中等上散射，中等波数）：\n    - $k = 1.0 \\ \\mathrm{cm}^{-1}$,\n    - $\\Sigma_{r,1} = 1.0 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{r,2} = 0.8 \\ \\mathrm{cm}^{-1}$,\n    - $v_1 = 1.0 \\ \\mathrm{cm}$, $v_2 = 0.6 \\ \\mathrm{cm}$,\n    - $D_1 = 1.0 \\ \\mathrm{cm}$, $D_2 = 0.5 \\ \\mathrm{cm}$,\n    - $\\Sigma_{s,11} = 0.7 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,22} = 0.6 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,12} = 0.15 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,21} = 0.10 \\ \\mathrm{cm}^{-1}$。\n- 案例 B（无上散射情况，较低波数）：\n    - $k = 0.5 \\ \\mathrm{cm}^{-1}$,\n    - $\\Sigma_{r,1} = 1.0 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{r,2} = 0.8 \\ \\mathrm{cm}^{-1}$,\n    - $v_1 = 1.0 \\ \\mathrm{cm}$, $v_2 = 0.6 \\ \\mathrm{cm}$,\n    - $D_1 = 0.8 \\ \\mathrm{cm}$, $D_2 = 0.4 \\ \\mathrm{cm}$,\n    - $\\Sigma_{s,11} = 0.6 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,22} = 0.55 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,12} = 0.00 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,21} = 0.12 \\ \\mathrm{cm}^{-1}$。\n- 案例 C（强上散射，长波模式）：\n    - $k = 0.2 \\ \\mathrm{cm}^{-1}$,\n    - $\\Sigma_{r,1} = 1.0 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{r,2} = 0.8 \\ \\mathrm{cm}^{-1}$,\n    - $v_1 = 1.0 \\ \\mathrm{cm}$, $v_2 = 1.2 \\ \\mathrm{cm}$,\n    - $D_1 = 1.2 \\ \\mathrm{cm}$, $D_2 = 0.7 \\ \\mathrm{cm}$,\n    - $\\Sigma_{s,11} = 0.6 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,22} = 0.5 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,12} = 0.30 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,21} = 0.05 \\ \\mathrm{cm}^{-1}$。\n- 案例 D（较高波数，群 2 中有更强的移出）：\n    - $k = 3.0 \\ \\mathrm{cm}^{-1}$,\n    - $\\Sigma_{r,1} = 0.9 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{r,2} = 1.1 \\ \\mathrm{cm}^{-1}$,\n    - $v_1 = 1.0 \\ \\mathrm{cm}$, $v_2 = 0.7 \\ \\mathrm{cm}$,\n    - $D_1 = 1.3 \\ \\mathrm{cm}$, $D_2 = 0.6 \\ \\mathrm{cm}$,\n    - $\\Sigma_{s,11} = 0.7 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,22} = 0.6 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,12} = 0.25 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,21} = 0.10 \\ \\mathrm{cm}^{-1}$。\n\n您的程序应生成单行输出，包含四个内部列表的结果，格式为逗号分隔的列表，每个内部列表如上所述排序，并四舍五入到六位小数。例如，输出应如下所示：`[[0.123456, 0.123456, 0.123456],...]`，其中每个案例的数值均已填入。",
            "solution": "问题陈述经评估有效。它在数值中子输运理论中扩散综合加速（DSA）的傅里叶分析既定框架内，提出了一个适定的、有科学依据的、客观的计算任务。所有必要的参数、定义和方程均已提供，构成一个自洽的问题，没有矛盾、歧义或不成立的前提。\n\n目标是为四个不同的参数集计算三个谱半径，以表征源迭代（SI）以及非耦合和耦合 DSA 方法在一个双能群、一维输运问题中的收敛行为。迭代矩阵 $\\mathbf{A}$ 的谱半径 $\\rho(\\mathbf{A})$ 控制着迭代方法的渐近误差缩减率；谱半径越小意味着收敛越快。\n\n问题的核心是针对给定的波数为 $k$ 的空间傅里叶模式，构建并分析三个 $2 \\times 2$ 的迭代矩阵。方法如下：\n\n首先，我们根据每个案例提供的参数定义主要矩阵：$k$、群移出截面 $\\Sigma_{r,g}$、有效流漏尺度 $v_g$、扩散系数 $D_g$ 以及群 $g, i, j \\in \\{1,2\\}$ 的散射截面 $\\Sigma_{s,ij}$。\n\n散射矩阵 $\\mathbf{S}$ 由下式给出：\n$$\n\\mathbf{S} = \\begin{bmatrix}\n\\Sigma_{s,11}  \\Sigma_{s,12} \\\\\n\\Sigma_{s,21}  \\Sigma_{s,22}\n\\end{bmatrix}\n$$\n\n高阶（HO）输运扫描算子和低阶（LO）扩散算子的傅里叶符号是群空间中的对角矩阵。\n高阶算子的符号为 $\\mathbf{Q}^{\\mathrm{HO}}(k) = \\mathrm{diag}(Q^{\\mathrm{HO}}_1(k), Q^{\\mathrm{HO}}_2(k))$，其中：\n$$\nQ^{\\mathrm{HO}}_g(k) = \\frac{1}{\\Sigma_{r,g} + v_g |k|}\n$$\n低阶算子的符号为 $\\mathbf{Q}^{\\mathrm{LO}}(k) = \\mathrm{diag}(Q^{\\mathrm{LO}}_1(k), Q^{\\mathrm{LO}}_2(k))$，其中：\n$$\nQ^{\\mathrm{LO}}_g(k) = \\frac{1}{\\Sigma_{r,g} + D_g k^2}\n$$\n\n利用这些，我们构建迭代矩阵。\n\n1.  **源迭代（SI）矩阵：**\n    SI 误差传播矩阵 $\\mathbf{G}(k)$ 是高阶算子符号与散射矩阵的乘积：\n    $$\n    \\mathbf{G}(k) = \\mathbf{Q}^{\\mathrm{HO}}(k) \\mathbf{S} = \\begin{bmatrix}\n    Q^{\\mathrm{HO}}_1(k) \\Sigma_{s,11}  Q^{\\mathrm{HO}}_1(k) \\Sigma_{s,12} \\\\\n    Q^{\\mathrm{HO}}_2(k) \\Sigma_{s,21}  Q^{\\mathrm{HO}}_2(k) \\Sigma_{s,22}\n    \\end{bmatrix}\n    $$\n    计算谱半径 $\\rho(\\mathbf{G}(k))$。一个接近 1 的值表示收敛缓慢，这在光学厚、散射主导的区域中是 SI 的典型特征。\n\n2.  **非耦合 DSA 矩阵：**\n    对于非耦合 DSA，低阶问题忽略了群间散射。相应的低阶迭代矩阵 $\\mathbf{G}_d^{\\mathrm{unc}}(k)$ 使用一个对角化的散射矩阵 $\\mathbf{S}_d = \\mathrm{diag}(\\Sigma_{s,11}, \\Sigma_{s,22})$：\n    $$\n    \\mathbf{G}_d^{\\mathrm{unc}}(k) = \\mathbf{Q}^{\\mathrm{LO}}(k) \\mathbf{S}_d = \\begin{bmatrix}\n    Q^{\\mathrm{LO}}_1(k) \\Sigma_{s,11}  0 \\\\\n    0  Q^{\\mathrm{LO}}_2(k) \\Sigma_{s,22}\n    \\end{bmatrix}\n    $$\n    然后，非耦合 DSA 迭代矩阵 $\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{unc}}(k)$ 为：\n    $$\n    \\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{unc}}(k) = \\mathbf{I} - \\left(\\mathbf{I} - \\mathbf{G}_d^{\\mathrm{unc}}(k)\\right)^{-1} \\left(\\mathbf{I} - \\mathbf{G}(k)\\right)\n    $$\n    计算其谱半径 $\\rho(\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{unc}}(k))$。\n\n3.  **耦合 DSA 矩阵：**\n    对于耦合 DSA，低阶问题保留了完整的散射矩阵 $\\mathbf{S}$。低阶迭代矩阵 $\\mathbf{G}_d^{\\mathrm{cpl}}(k)$ 为：\n    $$\n    \\mathbf{G}_d^{\\mathrm{cpl}}(k) = \\mathbf{Q}^{\\mathrm{LO}}(k) \\mathbf{S} = \\begin{bmatrix}\n    Q^{\\mathrm{LO}}_1(k) \\Sigma_{s,11}  Q^{\\mathrm{LO}}_1(k) \\Sigma_{s,12} \\\\\n    Q^{\\mathrm{LO}}_2(k) \\Sigma_{s,21}  Q^{\\mathrm{LO}}_2(k) \\Sigma_{s,22}\n    \\end{bmatrix}\n    $$\n    耦合 DSA 迭代矩阵 $\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{cpl}}(k)$ 为：\n    $$\n    \\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{cpl}}(k) = \\mathbf{I} - \\left(\\mathbf{I} - \\mathbf{G}_d^{\\mathrm{cpl}}(k)\\right)^{-1} \\left(\\mathbf{I} - \\mathbf{G}(k)\\right)\n    $$\n    计算其谱半径 $\\rho(\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{cpl}}(k))$。\n\n对于每个 $2 \\times 2$ 矩阵 $\\mathbf{A}$，其谱半径通过首先求解特征方程 $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$ 计算其两个特征值 $\\lambda_1$ 和 $\\lambda_2$ 来找到。然后谱半径为 $\\rho(\\mathbf{A}) = \\max(|\\lambda_1|, |\\lambda_2|)$。该过程将对四个测试案例中的每一个进行数值实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes spectral radii for Source Iteration and Diffusion Synthetic Acceleration\n    for four different test cases in a two-group neutron transport problem.\n    \"\"\"\n    # Test suite cases:\n    # (k, Sr1, Sr2, v1, v2, D1, D2, Ss11, Ss22, Ss12, Ss21)\n    test_cases = [\n        # Case A\n        (1.0, 1.0, 0.8, 1.0, 0.6, 1.0, 0.5, 0.7, 0.6, 0.15, 0.10),\n        # Case B\n        (0.5, 1.0, 0.8, 1.0, 0.6, 0.8, 0.4, 0.6, 0.55, 0.00, 0.12),\n        # Case C\n        (0.2, 1.0, 0.8, 1.0, 1.2, 1.2, 0.7, 0.6, 0.5, 0.30, 0.05),\n        # Case D\n        (3.0, 0.9, 1.1, 1.0, 0.7, 1.3, 0.6, 0.7, 0.6, 0.25, 0.10),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        k, Sr1, Sr2, v1, v2, D1, D2, Ss11, Ss22, Ss12, Ss21 = case\n\n        # Identity matrix\n        I = np.identity(2)\n\n        # Scattering matrix S\n        S = np.array([[Ss11, Ss12], [Ss21, Ss22]])\n\n        # High-order operator symbols\n        Q_ho_1 = 1.0 / (Sr1 + v1 * abs(k))\n        Q_ho_2 = 1.0 / (Sr2 + v2 * abs(k))\n        \n        # Source Iteration matrix G(k)\n        G_k = np.array([[Q_ho_1 * Ss11, Q_ho_1 * Ss12],\n                        [Q_ho_2 * Ss21, Q_ho_2 * Ss22]])\n\n        # Low-order operator symbols\n        Q_lo_1 = 1.0 / (Sr1 + D1 * k**2)\n        Q_lo_2 = 1.0 / (Sr2 + D2 * k**2)\n\n        # Uncoupled low-order matrix G_d_unc(k)\n        G_d_unc = np.array([[Q_lo_1 * Ss11, 0.0],\n                            [0.0, Q_lo_2 * Ss22]])\n\n        # Coupled low-order matrix G_d_cpl(k)\n        G_d_cpl = np.array([[Q_lo_1 * Ss11, Q_lo_1 * Ss12],\n                            [Q_lo_2 * Ss21, Q_lo_2 * Ss22]])\n\n        # --- 1. Spectral radius of Source Iteration ---\n        eigvals_G = np.linalg.eigvals(G_k)\n        rho_G = np.max(np.abs(eigvals_G))\n\n        # --- 2. Spectral radius of Uncoupled DSA ---\n        # M_unc = I - (I - G_d_unc)^-1 * (I - G_k)\n        try:\n            inv_I_m_Gd_unc = np.linalg.inv(I - G_d_unc)\n            M_dsa_unc = I - inv_I_m_Gd_unc @ (I - G_k)\n            eigvals_M_unc = np.linalg.eigvals(M_dsa_unc)\n            rho_M_unc = np.max(np.abs(eigvals_M_unc))\n        except np.linalg.LinAlgError:\n            rho_M_unc = np.inf\n\n        # --- 3. Spectral radius of Coupled DSA ---\n        # M_cpl = I - (I - G_d_cpl)^-1 * (I - G_k)\n        try:\n            inv_I_m_Gd_cpl = np.linalg.inv(I - G_d_cpl)\n            M_dsa_cpl = I - inv_I_m_Gd_cpl @ (I - G_k)\n            eigvals_M_cpl = np.linalg.eigvals(M_dsa_cpl)\n            rho_M_cpl = np.max(np.abs(eigvals_M_cpl))\n        except np.linalg.LinAlgError:\n            rho_M_cpl = np.inf\n\n        all_results.append([rho_G, rho_M_unc, rho_M_cpl])\n\n    # Format the final output string as specified\n    output_parts = []\n    for result_list in all_results:\n        # Format each float to 6 decimal places and create the inner list string\n        inner_str = f\"[{result_list[0]:.6f},{result_list[1]:.6f},{result_list[2]:.6f}]\"\n        output_parts.append(inner_str)\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}