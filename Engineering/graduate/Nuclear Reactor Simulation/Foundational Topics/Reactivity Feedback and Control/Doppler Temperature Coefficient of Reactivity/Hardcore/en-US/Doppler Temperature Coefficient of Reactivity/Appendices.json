{
    "hands_on_practices": [
        {
            "introduction": "This first exercise goes to the heart of the Doppler effect by modeling a single, isolated resonance. By working through a simplified but physically representative model, you will derive how temperature-induced broadening alters the resonance absorption rate, providing a quantitative basis for understanding this key feedback mechanism. This practice develops the analytical skills needed to connect microscopic cross-section changes to macroscopic reactor behavior .",
            "id": "4222973",
            "problem": "Consider an infinite, homogeneous reactor system in which fuel nuclei experience Doppler broadening of isolated absorption resonances in the epithermal range. Assume a simple slowing-down model in which the scalar neutron flux is proportional to $1/E$ between the thermal cut-off energy $E_{th}$ and the fission source upper boundary $E_{f}$. Focus on a single, isolated $s$-wave resonance of uranium-238, centered at energy $E_{r}$ in the epithermal interval $\\left[E_{th}, E_{f}\\right]$.\n\nModel the microscopic absorption cross section near the resonance as a rectangular (boxcar) function with height $h(T_{f})$ and width $w(T_{f})$, such that the energy-integrated resonance area $S_{r} = h(T_{f})\\,w(T_{f})$ is independent of fuel temperature $T_{f}$, but the Doppler broadening modifies the shape according to $w(T_{f}) \\propto \\sqrt{T_{f}}$ and $h(T_{f}) \\propto 1/\\sqrt{T_{f}}$. Let the fuel number density be $N_{f}$ (in atoms per cubic centimeter), and take the background macroscopic cross section of the non-resonant medium (moderator plus structure), which causes self-shielding, to be a constant $\\Sigma_{b}$ (in inverse centimeters) independent of $T_{f}$ in the considered interval. Assume one barn equals $1 \\times 10^{-24}\\,\\mathrm{cm}^{2}$.\n\nWithin the narrow resonance approximation, treat the factor $1/E$ as approximately constant across the resonance width and equal to $1/E_{r}$, and represent epithermal self-shielding by a local flux depression factor proportional to $\\Sigma_{b}\\big/\\big(\\Sigma_{b} + \\Sigma_{a}(E,T_{f})\\big)$, where $\\Sigma_{a}(E,T_{f}) = N_{f}\\,\\sigma_{a}(E,T_{f}) \\times 10^{-24}$ is the macroscopic absorption cross section in the resonance region.\n\nStarting from the definition of reaction rate per unit volume,\n$$\nR(T_{f}) = N_{f}\\,\\int_{E_{th}}^{E_{f}} \\sigma_{a}(E,T_{f})\\,\\phi(E)\\,dE,\n$$\nderive a closed-form expression for the resonance contribution to $R(T_{f})$ under the above assumptions, and use it to compute the dimensionless ratio $R(T_{1})/R(T_{0})$ for the following data:\n- $N_{f} = 2.4 \\times 10^{22}\\,\\mathrm{cm}^{-3}$,\n- $\\Sigma_{b} = 0.5\\,\\mathrm{cm}^{-1}$,\n- $h(T_{0}) = 4000\\,\\mathrm{barns}$ at $T_{0} = 900\\,\\mathrm{K}$,\n- $T_{1} = 1100\\,\\mathrm{K}$,\n- $E_{r}$ lies strictly between $E_{th}$ and $E_{f}$.\n\nExpress your final result as the dimensionless ratio $R(T_{1})/R(T_{0})$, rounded to four significant figures.",
            "solution": "The resonance absorption reaction rate per unit volume, $R(T_f)$, is the integral of the macroscopic absorption cross section $\\Sigma_a(E,T_f)$ multiplied by the neutron flux $\\phi(E,T_f)$ over the energy range of interest.\n$$ R(T_{f}) = \\int_{res} \\Sigma_{a}(E,T_{f})\\,\\phi(E,T_f)\\,dE $$\nThe problem specifies a self-shielded flux model where the unperturbed $1/E$ flux is depressed by a factor proportional to $\\Sigma_b / (\\Sigma_b + \\Sigma_a(E,T_f))$. Assuming the proportionality constant is unity (as it cancels in the final ratio), and applying the narrow resonance approximation ($1/E \\approx 1/E_r$), the flux within the resonance is:\n$$ \\phi(E,T_f) \\approx \\frac{C}{E_r} \\frac{\\Sigma_b}{\\Sigma_b + \\Sigma_a(E,T_f)} $$\nwhere $C$ is a constant related to the source strength. The reaction rate is then:\n$$ R(T_{f}) \\approx \\frac{C}{E_r} \\int_{res} \\Sigma_{a}(E,T_{f}) \\frac{\\Sigma_b}{\\Sigma_b + \\Sigma_a(E,T_f)} dE $$\nThe cross section is modeled as a rectangular function of width $w(T_f)$ and height $h(T_f)$. Inside the resonance, $\\Sigma_a(E,T_f)$ is constant and equals $\\Sigma_{a,peak}(T_f) = N_f h(T_f) \\times 10^{-24}$. The integral becomes multiplication by the width $w(T_f)$:\n$$ R(T_{f}) \\approx \\frac{C}{E_r} \\left( \\frac{\\Sigma_{a,peak}(T_f) \\Sigma_b}{\\Sigma_b + \\Sigma_{a,peak}(T_f)} \\right) w(T_f) $$\nWe are interested in the ratio $R(T_1)/R(T_0)$. The constant term $C/E_r$ cancels. Using the given temperature dependencies, $w(T_f) = w(T_0)\\sqrt{T_f/T_0}$ and $\\Sigma_{a,peak}(T_f) = \\Sigma_{a,peak}(T_0)\\sqrt{T_0/T_f}$, we can express the ratio in terms of dimensionless parameters $\\gamma = \\sqrt{T_1/T_0}$ and $\\beta_0 = \\Sigma_{a,peak}(T_0) / \\Sigma_b$. The final expression for the ratio is:\n$$ \\frac{R(T_1)}{R(T_0)} = \\frac{\\gamma(1 + \\beta_0)}{\\gamma + \\beta_0} $$\nFirst, we calculate the numerical values of the parameters:\n- $\\Sigma_{a,peak}(T_0) = N_f h(T_0) \\times 10^{-24} = (2.4 \\times 10^{22}\\,\\mathrm{cm}^{-3}) (4000\\,\\mathrm{barns}) (10^{-24}\\,\\mathrm{cm}^2/\\mathrm{barn}) = 96\\,\\mathrm{cm}^{-1}$.\n- $\\beta_0 = \\Sigma_{a,peak}(T_0) / \\Sigma_b = 96\\,\\mathrm{cm}^{-1} / 0.5\\,\\mathrm{cm}^{-1} = 192$.\n- $\\gamma = \\sqrt{T_1/T_0} = \\sqrt{1100\\,\\mathrm{K} / 900\\,\\mathrm{K}} = \\sqrt{11/9}$.\nSubstituting these values into the ratio expression:\n$$ \\frac{R(T_1)}{R(T_0)} = \\frac{\\sqrt{11/9}(1 + 192)}{\\sqrt{11/9} + 192} = \\frac{193 \\sqrt{11}}{576 + \\sqrt{11}} \\approx 1.104936 $$\nRounded to four significant figures, the result is 1.105. This demonstrates that as temperature increases, the total resonance absorption rate also increases due to the interplay of Doppler broadening and self-shielding.",
            "answer": "$$\\boxed{1.105}$$"
        },
        {
            "introduction": "In a real reactor, multiple temperature feedback mechanisms operate simultaneously, and isolating their individual effects is a critical task in safety analysis. This numerical experiment  introduces a powerful technique used in modern simulation codes to disentangle the Doppler effect from moderator density effects. By manipulating the temperatures used for nuclear data and material properties separately, you will learn how to design a computational study to quantify individual feedback coefficients.",
            "id": "4223028",
            "problem": "You are to construct and implement a self-contained numerical experiment that isolates the Doppler temperature effect in fuel from the moderator density effect in a simplified infinite-medium reactor model. The objective is to emulate how a Monte Carlo calculation could separate the two effects by selectively varying nuclear data temperatures and material temperatures, and to specify diagnostics that confirm isolation. The program must produce deterministic floating-point and boolean outputs as specified below.\n\nFundamental base to use:\n- Begin from the infinite-medium neutron balance and the four-factor formulation. In an infinite, homogeneous mixture with negligible neutron leakage, the infinite-medium multiplication factor is modeled by the four-factor decomposition. The four factors are:\n  - The reproduction factor $\\eta$, the average number of neutrons produced per thermal absorption in fuel.\n  - The thermal utilization factor $f$, the fraction of thermal absorptions occurring in fuel.\n  - The resonance escape probability $p$, the probability that a neutron slows to thermal energies without being absorbed in resonance absorbers, which is influenced by Doppler broadening of resonances.\n  - The fast fission factor $\\varepsilon$, the ratio accounting for additional neutrons from fast fission.\n- In this simplified model, define the infinite-medium multiplication factor as\n  $$k_{\\infty}(T_{\\mathrm{fuel\\_data}},T_{\\mathrm{mod\\_mat}}) = \\eta \\, \\varepsilon \\, f(T_{\\mathrm{mod\\_mat}}) \\, p(T_{\\mathrm{fuel\\_data}}),$$\n  where $T_{\\mathrm{fuel\\_data}}$ is the temperature used in the fuel nuclear data (cross sections) controlling Doppler broadening, and $T_{\\mathrm{mod\\_mat}}$ is the physical moderator material temperature controlling density.\n\nDefine the model functions with physically motivated dependencies:\n- Let the thermal utilization factor $f$ be\n  $$f(T_{\\mathrm{mod\\_mat}}) = \\frac{\\Sigma_{a,\\mathrm{fuel}}^{\\mathrm{th}}}{\\Sigma_{a,\\mathrm{fuel}}^{\\mathrm{th}} + \\Sigma_{a,\\mathrm{mod}}^{\\mathrm{th}}(T_{\\mathrm{mod\\_mat}})},$$\n  where $\\Sigma_{a,\\mathrm{fuel}}^{\\mathrm{th}}$ is the thermal macroscopic absorption cross section of fuel (assumed temperature-independent for this isolation experiment), and $\\Sigma_{a,\\mathrm{mod}}^{\\mathrm{th}}(T)$ scales linearly with moderator number density as\n  $$\\Sigma_{a,\\mathrm{mod}}^{\\mathrm{th}}(T) = \\Sigma_{a,\\mathrm{mod},0}^{\\mathrm{th}} \\, \\frac{\\rho_{\\mathrm{mod}}(T)}{\\rho_{\\mathrm{mod}}(T_0)},$$\n  with moderator density modeled by a linear thermal expansion law\n  $$\\rho_{\\mathrm{mod}}(T) = \\rho_{\\mathrm{mod}}(T_0)\\,\\left[1 - \\beta \\,(T - T_0)\\right],$$\n  valid for small to moderate temperature excursions $|T - T_0|$, where $\\beta$ is the volumetric thermal expansion coefficient and $T_0$ is a reference temperature.\n- Let the resonance escape probability $p$ be a decreasing function of the square-root temperature ratio to reflect Doppler broadening, for example\n  $$p(T_{\\mathrm{fuel\\_data}}) = p_0 \\, \\exp\\!\\left(-a_D \\left[\\sqrt{\\frac{T_{\\mathrm{fuel\\_data}}}{T_0}} - 1\\right]\\right),$$\n  where $p_0$ is the base resonance escape probability at $T_0$, and $a_D$ controls the strength of Doppler broadening impact.\n\nFrom $k_{\\infty}$, define reactivity $\\rho$ by\n$$\\rho = \\frac{k_{\\infty} - 1}{k_{\\infty}},$$\nand define temperature coefficients (diagnostics) by finite differences:\n- Doppler temperature coefficient (fuel data temperature coefficient),\n  $$\\alpha_D = \\frac{\\rho(T_{\\mathrm{fuel\\_data}}+ \\Delta T_{\\mathrm{fuel\\_data}}, \\, T_{\\mathrm{mod\\_mat}}) - \\rho(T_{\\mathrm{fuel\\_data}}, \\, T_{\\mathrm{mod\\_mat}})}{\\Delta T_{\\mathrm{fuel\\_data}}},$$\n- Moderator temperature coefficient (moderator material temperature coefficient),\n  $$\\alpha_M = \\frac{\\rho(T_{\\mathrm{fuel\\_data}}, \\, T_{\\mathrm{mod\\_mat}}+ \\Delta T_{\\mathrm{mod\\_mat}}) - \\rho(T_{\\mathrm{fuel\\_data}}, \\, T_{\\mathrm{mod\\_mat}})}{\\Delta T_{\\mathrm{mod\\_mat}}}.$$\nExpress $\\alpha_D$ and $\\alpha_M$ in per cent mille per Kelvin (pcm/K), i.e., multiply the dimensionless ratio by $10^5$ and divide by Kelvin.\n\nDesign the isolation diagnostics:\n- Compute the individual changes in $k_{\\infty}$ due to Doppler-only and moderator-density-only perturbations:\n  $$\\Delta k_D = k_{\\infty}(T_{\\mathrm{fuel\\_data}}+\\Delta T_{\\mathrm{fuel\\_data}}, T_{\\mathrm{mod\\_mat}}) - k_{\\infty}(T_{\\mathrm{fuel\\_data}}, T_{\\mathrm{mod\\_mat}}),$$\n  $$\\Delta k_M = k_{\\infty}(T_{\\mathrm{fuel\\_data}}, T_{\\mathrm{mod\\_mat}}+\\Delta T_{\\mathrm{mod\\_mat}}) - k_{\\infty}(T_{\\mathrm{fuel\\_data}}, T_{\\mathrm{mod\\_mat}}).$$\n- Compute the combined change and the non-additive cross-term diagnostic:\n  $$\\Delta k_{\\mathrm{both}} = k_{\\infty}(T_{\\mathrm{fuel\\_data}}+\\Delta T_{\\mathrm{fuel\\_data}}, T_{\\mathrm{mod\\_mat}}+\\Delta T_{\\mathrm{mod\\_mat}}) - k_{\\infty}(T_{\\mathrm{fuel\\_data}}, T_{\\mathrm{mod\\_mat}}),$$\n  $$X = \\left|\\Delta k_{\\mathrm{both}} - \\left(\\Delta k_D + \\Delta k_M\\right)\\right|.$$\n- Define an isolation success boolean by an absolute threshold $\\tau$:\n  $$\\text{isolation\\_ok} = \\left(X  \\tau \\right).$$\nChoose a reasonable threshold $\\tau$, for example $\\tau = 10^{-4}$.\n\nImplement the above in code and compute diagnostics for the following test suite. All temperatures must be in Kelvin, all densities in grams per cubic centimeter, and cross sections in inverse centimeters. The final program output must be a single line containing a comma-separated Python list of results, flattened across test cases, in the exact order described below.\n\nConstants common to all tests:\n- $\\eta = 2.05$,\n- $\\varepsilon = 1.03$,\n- $\\Sigma_{a,\\mathrm{fuel}}^{\\mathrm{th}} = 0.60\\,\\mathrm{cm}^{-1}$,\n- $\\Sigma_{a,\\mathrm{mod},0}^{\\mathrm{th}} = 0.05\\,\\mathrm{cm}^{-1}$,\n- $p_0 = 0.85$,\n- $a_D = 0.08$,\n- $\\tau = 10^{-4}$.\n\nTest suite parameter sets:\n- Case A (general case):\n  - $T_0 = 600\\,\\mathrm{K}$,\n  - $T_{\\mathrm{fuel\\_data}} = 900\\,\\mathrm{K}$,\n  - $T_{\\mathrm{mod\\_mat}} = 600\\,\\mathrm{K}$,\n  - $\\Delta T_{\\mathrm{fuel\\_data}} = 100\\,\\mathrm{K}$,\n  - $\\Delta T_{\\mathrm{mod\\_mat}} = 100\\,\\mathrm{K}$,\n  - $\\rho_{\\mathrm{mod}}(T_0) = 0.70\\,\\mathrm{g/cm}^3$,\n  - $\\beta = 3\\times 10^{-4}\\,\\mathrm{K}^{-1}$.\n- Case B (boundary small perturbations):\n  - $T_0 = 300\\,\\mathrm{K}$,\n  - $T_{\\mathrm{fuel\\_data}} = 300\\,\\mathrm{K}$,\n  - $T_{\\mathrm{mod\\_mat}} = 300\\,\\mathrm{K}$,\n  - $\\Delta T_{\\mathrm{fuel\\_data}} = 1\\,\\mathrm{K}$,\n  - $\\Delta T_{\\mathrm{mod\\_mat}} = 1\\,\\mathrm{K}$,\n  - $\\rho_{\\mathrm{mod}}(T_0) = 1.00\\,\\mathrm{g/cm}^3$,\n  - $\\beta = 2\\times 10^{-4}\\,\\mathrm{K}^{-1}$.\n- Case C (edge large perturbations):\n  - $T_0 = 650\\,\\mathrm{K}$,\n  - $T_{\\mathrm{fuel\\_data}} = 1200\\,\\mathrm{K}$,\n  - $T_{\\mathrm{mod\\_mat}} = 650\\,\\mathrm{K}$,\n  - $\\Delta T_{\\mathrm{fuel\\_data}} = 300\\,\\mathrm{K}$,\n  - $\\Delta T_{\\mathrm{mod\\_mat}} = 200\\,\\mathrm{K}$,\n  - $\\rho_{\\mathrm{mod}}(T_0) = 0.75\\,\\mathrm{g/cm}^3$,\n  - $\\beta = 3.5\\times 10^{-4}\\,\\mathrm{K}^{-1}$.\n\nRequired outputs per case, in order and units:\n1. $\\alpha_D$ in pcm/K (float),\n2. $\\alpha_M$ in pcm/K (float),\n3. $\\Delta k_D$ (float, dimensionless),\n4. $\\Delta k_M$ (float, dimensionless),\n5. $X$ (float, dimensionless),\n6. $\\text{isolation\\_ok}$ (boolean).\n\nFinal output format:\n- Your program should produce a single line of output containing the concatenated results from Case A, Case B, and Case C, flattened into one Python list in the order above for each case (for example, $[\\alpha_D^A,\\alpha_M^A,\\Delta k_D^A,\\Delta k_M^A,X^A,\\text{iso}^A,\\alpha_D^B,\\dots]$). There must be no additional text printed.",
            "solution": "The objective is to construct and implement a self-contained numerical experiment to isolate the Doppler temperature feedback effect in fuel from the moderator density feedback effect in a simplified infinite-medium reactor model. This experiment emulates a common technique in advanced reactor simulation codes, where the effects of different physical phenomena are separated by selectively perturbing temperatures in the nuclear data versus the material properties. The analysis relies on the four-factor formula for an infinite, homogeneous medium.\n\nThe infinite-medium multiplication factor, $k_{\\infty}$, is given by the product of four factors:\n$$k_{\\infty} = \\eta \\, \\varepsilon \\, p \\, f$$\nwhere $\\eta$ is the reproduction factor, $\\varepsilon$ is the fast fission factor, $p$ is the resonance escape probability, and $f$ is the thermal utilization factor. Within this problem's framework, $\\eta$ and $\\varepsilon$ are treated as constants. The temperature dependence is isolated into $p$, which depends on the fuel's nuclear data temperature $T_{\\mathrm{fuel\\_data}}$, and $f$, which depends on the moderator's physical material temperature $T_{\\mathrm{mod\\_mat}}$. This separation is the key to the numerical experiment:\n$$k_{\\infty}(T_{\\mathrm{fuel\\_data}}, T_{\\mathrm{mod\\_mat}}) = \\eta \\, \\varepsilon \\, p(T_{\\mathrm{fuel\\_data}}) \\, f(T_{\\mathrm{mod\\_mat}})$$\n\nThe algorithm is structured as follows:\nFirst, we define a set of functions that model the physical behavior of each component according to the problem statement.\n\nThe resonance escape probability, $p$, is modeled as a function of the fuel data temperature $T_{\\mathrm{fuel\\_data}}$. An increase in fuel temperature broadens the resonant absorption peaks in fuel isotopes like $^{238}\\mathrm{U}$ (Doppler broadening), which increases the likelihood that a neutron is captured while slowing down, thereby decreasing the probability of it reaching thermal energies. This is modeled by:\n$$p(T_{\\mathrm{fuel\\_data}}) = p_0 \\, \\exp\\!\\left(-a_D \\left[\\sqrt{\\frac{T_{\\mathrm{fuel\\_data}}}{T_0}} - 1\\right]\\right)$$\nwhere $p_0$ is the resonance escape probability at a reference temperature $T_0$, and $a_D$ is a coefficient controlling the strength of this effect.\n\nThe thermal utilization factor, $f$, is the fraction of thermal neutrons absorbed in the fuel versus the total thermal absorptions in the reactor core. It depends on the macroscopic absorption cross sections, $\\Sigma_a$, of the fuel and moderator. While the fuel's cross section $\\Sigma_{a,\\mathrm{fuel}}^{\\mathrm{th}}$ is assumed constant, the moderator's cross section $\\Sigma_{a,\\mathrm{mod}}^{\\mathrm{th}}$ varies with temperature due to density changes. The model is:\n$$f(T_{\\mathrm{mod\\_mat}}) = \\frac{\\Sigma_{a,\\mathrm{fuel}}^{\\mathrm{th}}}{\\Sigma_{a,\\mathrm{fuel}}^{\\mathrm{th}} + \\Sigma_{a,\\mathrm{mod}}^{\\mathrm{th}}(T_{\\mathrm{mod\\_mat}})}$$\nThe moderator's macroscopic cross section is proportional to its number density, which is modeled using a linear thermal expansion law:\n$$\\rho_{\\mathrm{mod}}(T) = \\rho_{\\mathrm{mod}}(T_0)\\,\\left[1 - \\beta \\,(T - T_0)\\right]$$\n$$\\Sigma_{a,\\mathrm{mod}}^{\\mathrm{th}}(T) = \\Sigma_{a,\\mathrm{mod},0}^{\\mathrm{th}} \\, \\frac{\\rho_{\\mathrm{mod}}(T)}{\\rho_{\\mathrm{mod}}(T_0)}$$\nwhere $\\beta$ is the volumetric thermal expansion coefficient and $T_0$ is the reference temperature.\n\nWith these components, we can compute $k_{\\infty}$ for any pair of $(T_{\\mathrm{fuel\\_data}}, T_{\\mathrm{mod\\_mat}})$. Reactivity, $\\rho$, is subsequently calculated from $k_{\\infty}$:\n$$\\rho = \\frac{k_{\\infty} - 1}{k_{\\infty}}$$\nThe temperature coefficients of reactivity are then computed using finite differences. The Doppler coefficient $\\alpha_D$ is found by perturbing only $T_{\\mathrm{fuel\\_data}}$ by $\\Delta T_{\\mathrm{fuel\\_data}}$ while keeping $T_{\\mathrm{mod\\_mat}}$ constant. The moderator coefficient $\\alpha_M$ is found by perturbing only $T_{\\mathrm{mod\\_mat}}$ by $\\Delta T_{\\mathrm{mod\\_mat}}$ while keeping $T_{\\mathrm{fuel\\_data}}$ constant. The results are converted to units of per cent mille per Kelvin (pcm/K) by multiplying by $10^5$.\n$$\\alpha_D = \\frac{\\rho(T_{\\mathrm{fuel\\_data}}+ \\Delta T_{\\mathrm{fuel\\_data}}, \\, T_{\\mathrm{mod\\_mat}}) - \\rho(T_{\\mathrm{fuel\\_data}}, \\, T_{\\mathrm{mod\\_mat}})}{\\Delta T_{\\mathrm{fuel\\_data}}} \\times 10^5$$\n$$\\alpha_M = \\frac{\\rho(T_{\\mathrm{fuel\\_data}}, \\, T_{\\mathrm{mod\\_mat}}+ \\Delta T_{\\mathrm{mod\\_mat}}) - \\rho(T_{\\mathrm{fuel\\_data}}, \\, T_{\\mathrm{mod\\_mat}})}{\\Delta T_{\\mathrm{mod\\_mat}}} \\times 10^5$$\n\nTo verify the isolation of effects, we compute the changes in $k_{\\infty}$ from individual and combined perturbations. The change from only the Doppler effect is $\\Delta k_D$, and from only the moderator effect is $\\Delta k_M$:\n$$\\Delta k_D = k_{\\infty}(T_{\\mathrm{fuel\\_data}}+\\Delta T_{\\mathrm{fuel\\_data}}, T_{\\mathrm{mod\\_mat}}) - k_{\\infty}(T_{\\mathrm{fuel\\_data}}, T_{\\mathrm{mod\\_mat}})$$\n$$\\Delta k_M = k_{\\infty}(T_{\\mathrm{fuel\\_data}}, T_{\\mathrm{mod\\_mat}}+\\Delta T_{\\mathrm{mod\\_mat}}) - k_{\\infty}(T_{\\mathrm{fuel\\_data}}, T_{\\mathrm{mod\\_mat}})$$\nThe total change when both temperatures are perturbed is $\\Delta k_{\\mathrm{both}}$. A key diagnostic is the non-additive cross-term, $X$, which measures the degree of coupling or non-linearity in the system's response:\n$$\\Delta k_{\\mathrm{both}} = k_{\\infty}(T_{\\mathrm{fuel\\_data}}+\\Delta T_{\\mathrm{fuel\\_data}}, T_{\\mathrm{mod\\_mat}}+\\Delta T_{\\mathrm{mod\\_mat}}) - k_{\\infty}(T_{\\mathrm{fuel\\_data}}, T_{\\mathrm{mod\\_mat}})$$\n$$X = \\left|\\Delta k_{\\mathrm{both}} - \\left(\\Delta k_D + \\Delta k_M\\right)\\right|$$\nSince $k_{\\infty}$ is a product of functions of the two temperatures, $k_{\\infty} \\propto p(T_{\\mathrm{fuel\\_data}}) \\cdot f(T_{\\mathrm{mod\\_mat}})$, the combined effect is not purely additive. The term $X$ quantifies this non-additivity. Analytically, one can show that $X = |\\eta \\varepsilon \\cdot \\Delta p \\cdot \\Delta f|$, where $\\Delta p$ and $\\Delta f$ are the changes in the respective factors. The isolation is considered successful if $X$ is below a small threshold $\\tau$, indicating that for the given perturbations, the total effect is well approximated by the sum of individual effects. This condition, $X  \\tau$, defines the boolean diagnostic $\\text{isolation\\_ok}$.\n\nThis entire procedure is implemented in the provided code, which systematically evaluates the model for three distinct test cases, calculates the six specified diagnostic quantities for each, and reports the flattened list of results.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the reactor physics problem for isolating temperature effects.\n    \"\"\"\n\n    # Common constants provided in the problem statement.\n    CONSTANTS = {\n        'eta': 2.05,\n        'epsilon': 1.03,\n        'Sigma_a_fuel_th': 0.60,\n        'Sigma_a_mod_0_th': 0.05,\n        'p0': 0.85,\n        'a_D': 0.08,\n        'tau': 1.0e-4,\n    }\n\n    # Test suite parameter sets.\n    test_cases = [\n        # Case A (general case)\n        {\n            'T0': 600.0, 'T_fuel_data': 900.0, 'T_mod_mat': 600.0,\n            'Delta_T_fuel_data': 100.0, 'Delta_T_mod_mat': 100.0,\n            'rho_mod_T0': 0.70, 'beta': 3.0e-4\n        },\n        # Case B (boundary small perturbations)\n        {\n            'T0': 300.0, 'T_fuel_data': 300.0, 'T_mod_mat': 300.0,\n            'Delta_T_fuel_data': 1.0, 'Delta_T_mod_mat': 1.0,\n            'rho_mod_T0': 1.00, 'beta': 2.0e-4\n        },\n        # Case C (edge large perturbations)\n        {\n            'T0': 650.0, 'T_fuel_data': 1200.0, 'T_mod_mat': 650.0,\n            'Delta_T_fuel_data': 300.0, 'Delta_T_mod_mat': 200.0,\n            'rho_mod_T0': 0.75, 'beta': 3.5e-4\n        }\n    ]\n\n    def calculate_f(T_mod_mat, p_case, p_const):\n        \"\"\"Calculates thermal utilization factor.\"\"\"\n        rho_mod_at_T = p_case['rho_mod_T0'] * (1.0 - p_case['beta'] * (T_mod_mat - p_case['T0']))\n        Sigma_a_mod_th = p_const['Sigma_a_mod_0_th'] * (rho_mod_at_T / p_case['rho_mod_T0'])\n        return p_const['Sigma_a_fuel_th'] / (p_const['Sigma_a_fuel_th'] + Sigma_a_mod_th)\n\n    def calculate_p(T_fuel_data, p_case, p_const):\n        \"\"\"Calculates resonance escape probability.\"\"\"\n        return p_const['p0'] * np.exp(-p_const['a_D'] * (np.sqrt(T_fuel_data / p_case['T0']) - 1.0))\n\n    def calculate_k_inf(T_fuel_data, T_mod_mat, p_case, p_const):\n        \"\"\"Calculates the infinite multiplication factor k_infinity.\"\"\"\n        f = calculate_f(T_mod_mat, p_case, p_const)\n        p = calculate_p(T_fuel_data, p_case, p_const)\n        return p_const['eta'] * p_const['epsilon'] * p * f\n\n    def calculate_reactivity(k_inf):\n        \"\"\"Calculates reactivity rho.\"\"\"\n        if k_inf == 0: return -np.inf\n        return (k_inf - 1.0) / k_inf\n\n    def calculate_diagnostics(case_params, consts):\n        \"\"\"\n        Calculates all required outputs for a single test case.\n        \"\"\"\n        Tf = case_params['T_fuel_data']\n        Tm = case_params['T_mod_mat']\n        dTf = case_params['Delta_T_fuel_data']\n        dTm = case_params['Delta_T_mod_mat']\n\n        # Calculate k_inf at the four state points\n        k_base = calculate_k_inf(Tf, Tm, case_params, consts)\n        k_D_pert = calculate_k_inf(Tf + dTf, Tm, case_params, consts)\n        k_M_pert = calculate_k_inf(Tf, Tm + dTm, case_params, consts)\n        k_both = calculate_k_inf(Tf + dTf, Tm + dTm, case_params, consts)\n\n        # Calculate corresponding reactivities\n        rho_base = calculate_reactivity(k_base)\n        rho_D_pert = calculate_reactivity(k_D_pert)\n        rho_M_pert = calculate_reactivity(k_M_pert)\n        \n        # 1. Doppler temperature coefficient (alpha_D)\n        alpha_D = ((rho_D_pert - rho_base) / dTf) * 1e5  # in pcm/K\n\n        # 2. Moderator temperature coefficient (alpha_M)\n        alpha_M = ((rho_M_pert - rho_base) / dTm) * 1e5  # in pcm/K\n\n        # 3. Doppler-only change in k_inf (Delta_k_D)\n        Delta_k_D = k_D_pert - k_base\n\n        # 4. Moderator-only change in k_inf (Delta_k_M)\n        Delta_k_M = k_M_pert - k_base\n\n        # 5. Non-additive cross-term diagnostic (X)\n        Delta_k_both = k_both - k_base\n        X = abs(Delta_k_both - (Delta_k_D + Delta_k_M))\n\n        # 6. Isolation success boolean (isolation_ok)\n        isolation_ok = X  consts['tau']\n\n        return [alpha_D, alpha_M, Delta_k_D, Delta_k_M, X, isolation_ok]\n\n    results = []\n    for case in test_cases:\n        case_results = calculate_diagnostics(case, CONSTANTS)\n        results.extend(case_results)\n\n    # Format the final output to match the specification.\n    print(f\"[{','.join(f'{x:.7g}' if isinstance(x, float) else str(x) for x in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The overall Doppler coefficient of reactivity is a composite value arising from the contributions of various isotopes in the fuel. This exercise  challenges you to derive and compute this isotopic breakdown using a simplified one-group reactor model. This analysis reveals the dominant negative feedback contribution from nuclides like $^{238}\\mathrm{U}$ and provides insight into how changes in fuel composition affect reactor dynamics and safety.",
            "id": "4223015",
            "problem": "Consider a representative Pressurized Water Reactor (PWR) lattice modeled as an infinite, homogeneous, one-energy-group medium in steady state. Neutron balance in such an infinite medium can be written in terms of macroscopic cross sections and the effective neutron multiplication factor $k$, where reactivity is defined as $\\rho = (k - 1)/k$. Assume a fixed, temperature-independent neutron production term $\\nu \\Sigma_f$ and that leakage is negligible. Let the total macroscopic absorption cross section be $\\Sigma_a(T) = \\sum_i \\Sigma_{a,i}(T) + \\Sigma_{a,\\text{const}}$, where the sum runs over temperature-sensitive isotopes $i$, and $\\Sigma_{a,\\text{const}}$ is temperature-independent absorption (e.g., moderator and poisons without significant resonance Doppler sensitivity). The system is exactly critical at a reference fuel temperature $T_0$, meaning $$\\nu \\Sigma_f = \\Sigma_a(T_0).$$ Each temperature-sensitive isotope $i$ has a macroscopic absorption cross section that follows a temperature power law $$\\Sigma_{a,i}(T) = \\Sigma_{a,i0} \\left(\\frac{T}{T_0}\\right)^{b_i},$$ where $\\Sigma_{a,i0}$ is the value at $T_0$, and $b_i$ is a real exponent representing the net effect of Doppler broadening and self-shielding in the chosen energy group.\n\nTask: Derive, from these bases, the isotopic breakdown of the Doppler temperature coefficient of reactivity, meaning the partial derivatives $\\partial \\rho / \\partial T$ at $T_0$ attributable to each isotope $i$â€™s absorption cross section temperature dependence, holding $\\nu \\Sigma_f$, scattering, and $\\Sigma_{a,\\text{const}}$ fixed. Report the quantity for each isotope $i$ and the total $\\alpha_D = \\sum_i \\left(\\partial \\rho/\\partial T\\right)_i$. You must express all answers in $1/\\mathrm{K}$ as decimal numbers.\n\nUse the following test suite with the isotopes ordered as $[$U-238, U-235, Pu-239, B-10$]$. For each case, compute and return a list $[$$\\alpha_{\\text{U-238}}$, $\\alpha_{\\text{U-235}}$, $\\alpha_{\\text{Pu-239}}$, $\\alpha_{\\text{B-10}}$, $\\alpha_D$$]$ in $1/\\mathrm{K}$. The temperature-independent absorption is denoted $\\Sigma_{a,\\text{const}}$. The system is critical at $T_0$ (so $\\nu \\Sigma_f = \\Sigma_a(T_0)$) in each case.\n\nCase 1 (typical UO$_2$ PWR lattice):\n- $T_0 = 900\\,\\mathrm{K}$\n- $\\Sigma_{a,\\text{U-238},0} = 0.045\\,\\mathrm{cm^{-1}}$, $b_{\\text{U-238}} = 0.5$\n- $\\Sigma_{a,\\text{U-235},0} = 0.006\\,\\mathrm{cm^{-1}}$, $b_{\\text{U-235}} = 0.1$\n- $\\Sigma_{a,\\text{Pu-239},0} = 0.003\\,\\mathrm{cm^{-1}}$, $b_{\\text{Pu-239}} = 0.3$\n- $\\Sigma_{a,\\text{B-10},0} = 0.015\\,\\mathrm{cm^{-1}}$, $b_{\\text{B-10}} = 0.0$\n- $\\Sigma_{a,\\text{const}} = 0.031\\,\\mathrm{cm^{-1}}$\n\nCase 2 (edge case: no Doppler-sensitive isotopes):\n- $T_0 = 900\\,\\mathrm{K}$\n- $\\Sigma_{a,\\text{U-238},0} = 0.040\\,\\mathrm{cm^{-1}}$, $b_{\\text{U-238}} = 0.0$\n- $\\Sigma_{a,\\text{U-235},0} = 0.007\\,\\mathrm{cm^{-1}}$, $b_{\\text{U-235}} = 0.0$\n- $\\Sigma_{a,\\text{Pu-239},0} = 0.002\\,\\mathrm{cm^{-1}}$, $b_{\\text{Pu-239}} = 0.0$\n- $\\Sigma_{a,\\text{B-10},0} = 0.018\\,\\mathrm{cm^{-1}}$, $b_{\\text{B-10}} = 0.0$\n- $\\Sigma_{a,\\text{const}} = 0.033\\,\\mathrm{cm^{-1}}$\n\nCase 3 (mixed-oxide-like spectrum with reduced U-238 and increased Pu-239 absorption):\n- $T_0 = 900\\,\\mathrm{K}$\n- $\\Sigma_{a,\\text{U-238},0} = 0.010\\,\\mathrm{cm^{-1}}$, $b_{\\text{U-238}} = 0.5$\n- $\\Sigma_{a,\\text{U-235},0} = 0.004\\,\\mathrm{cm^{-1}}$, $b_{\\text{U-235}} = 0.1$\n- $\\Sigma_{a,\\text{Pu-239},0} = 0.009\\,\\mathrm{cm^{-1}}$, $b_{\\text{Pu-239}} = 0.3$\n- $\\Sigma_{a,\\text{B-10},0} = 0.012\\,\\mathrm{cm^{-1}}$, $b_{\\text{B-10}} = 0.0$\n- $\\Sigma_{a,\\text{const}} = 0.065\\,\\mathrm{cm^{-1}}$\n\nYour program should produce a single line of output containing the results as a comma-separated list of the three case-results, each itself a comma-separated list, with no spaces, enclosed in square brackets. For example: \"[[case1_list],[case2_list],[case3_list]]\". All listed values must be floats in $1/\\mathrm{K}$.",
            "solution": "The temperature coefficient of reactivity, $\\alpha = d\\rho/dT$, is derived from the one-group model definitions. Reactivity is $\\rho = 1 - 1/k$, where $k = \\nu\\Sigma_f / \\Sigma_a(T)$. Since the reactor is critical at the reference temperature $T_0$, we have $\\nu\\Sigma_f = \\Sigma_a(T_0)$. Substituting this gives:\n$$ \\rho(T) = 1 - \\frac{\\Sigma_a(T)}{\\Sigma_a(T_0)} $$\nDifferentiating with respect to temperature $T$:\n$$ \\frac{d\\rho}{dT} = -\\frac{1}{\\Sigma_a(T_0)} \\frac{d\\Sigma_a(T)}{dT} $$\nThe derivative of the total absorption cross section, $\\Sigma_a(T) = \\sum_i \\Sigma_{a,i0} (T/T_0)^{b_i} + \\Sigma_{a,\\text{const}}$, is:\n$$ \\frac{d\\Sigma_a(T)}{dT} = \\sum_i \\Sigma_{a,i0} \\frac{d}{dT} \\left(\\frac{T}{T_0}\\right)^{b_i} = \\sum_i \\Sigma_{a,i0} \\frac{b_i}{T_0} \\left(\\frac{T}{T_0}\\right)^{b_i-1} $$\nEvaluating this derivative at the reference temperature $T = T_0$ simplifies the expression:\n$$ \\left. \\frac{d\\Sigma_a(T)}{dT} \\right|_{T=T_0} = \\sum_i \\frac{\\Sigma_{a,i0} b_i}{T_0} $$\nThe problem requires the contribution of each isotope $i$ to the total coefficient. By distributing the sum, we can define the isotopic contribution $\\alpha_i$ as:\n$$ \\alpha_i = -\\frac{1}{\\Sigma_a(T_0)} \\left( \\frac{\\Sigma_{a,i0} b_i}{T_0} \\right) $$\nwhere $\\Sigma_a(T_0) = \\sum_j \\Sigma_{a,j0} + \\Sigma_{a,\\text{const}}$. The total Doppler coefficient is then $\\alpha_D = \\sum_i \\alpha_i$.\nThe provided code implements this formula for each of the three test cases. It first calculates the total absorption at $T_0$, then computes each isotopic contribution $\\alpha_i$, and finally sums them to get the total coefficient $\\alpha_D$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating the isotopic breakdown of the Doppler\n    temperature coefficient of reactivity for three nuclear reactor lattice cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (typical UO2 PWR lattice)\n        {\n            \"T0\": 900.0,\n            \"isotopes\": [\n                # (Sigma_a0, b)\n                (0.045, 0.5),  # U-238\n                (0.006, 0.1),  # U-235\n                (0.003, 0.3),  # Pu-239\n                (0.015, 0.0),  # B-10\n            ],\n            \"Sigma_a_const\": 0.031,\n        },\n        # Case 2 (edge case: no Doppler-sensitive isotopes)\n        {\n            \"T0\": 900.0,\n            \"isotopes\": [\n                (0.040, 0.0),  # U-238\n                (0.007, 0.0),  # U-235\n                (0.002, 0.0),  # Pu-239\n                (0.018, 0.0),  # B-10\n            ],\n            \"Sigma_a_const\": 0.033,\n        },\n        # Case 3 (mixed-oxide-like spectrum)\n        {\n            \"T0\": 900.0,\n            \"isotopes\": [\n                (0.010, 0.5),  # U-238\n                (0.004, 0.1),  # U-235\n                (0.009, 0.3),  # Pu-239\n                (0.012, 0.0),  # B-10\n            ],\n            \"Sigma_a_const\": 0.065,\n        },\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        T0 = case[\"T0\"]\n        isotopes = case[\"isotopes\"]\n        Sigma_a_const = case[\"Sigma_a_const\"]\n\n        # Step 1: Calculate total absorption at T0.\n        sum_Sigma_a0_i = sum(iso[0] for iso in isotopes)\n        Sigma_a_T0 = sum_Sigma_a0_i + Sigma_a_const\n        \n        # Step 2: Calculate the denominator which is common for all alpha_i calculations.\n        denominator = T0 * Sigma_a_T0\n        \n        alpha_isotopes = []\n        # Step 3: For each isotope, calculate its contribution to the coefficient.\n        for Sigma_a_i0, b_i in isotopes:\n            # The formula derived is alpha_i = - (Sigma_a_i0 * b_i) / (T0 * Sigma_a(T0))\n            if denominator == 0:\n                alpha_i = 0.0\n            else:\n                numerator = -Sigma_a_i0 * b_i\n                alpha_i = numerator / denominator\n            alpha_isotopes.append(alpha_i)\n\n        # Step 4: Calculate the total Doppler coefficient by summing isotopic contributions.\n        alpha_D = sum(alpha_isotopes)\n\n        # Step 5: Assemble the final list for the case.\n        case_result = alpha_isotopes + [alpha_D]\n        all_results.append(case_result)\n\n    # Final print statement in the exact required format.\n    case_strings = [f\"[{','.join(map(str, r))}]\" for r in all_results]\n    print(f\"[{','.join(case_strings)}]\")\n\nsolve()\n```"
        }
    ]
}