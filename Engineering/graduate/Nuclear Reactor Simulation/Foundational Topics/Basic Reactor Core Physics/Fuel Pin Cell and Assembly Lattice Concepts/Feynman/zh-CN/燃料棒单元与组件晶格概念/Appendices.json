{
    "hands_on_practices": [
        {
            "introduction": "在反应堆分析中，为了简化计算，我们常常需要将复杂的几何结构（如带中心孔的环形燃料芯块）等效为一个简单的均匀区域。这个练习将指导你通过保持燃料质量守恒的原则，推导环形燃料的“涂抹”有效密度，这是空间均匀化方法的一个基本应用。通过这个过程，你将能更好地理解均匀化对共振自屏效应等关键物理现象的影响。",
            "id": "4228069",
            "problem": "在轻水反应堆的棒状元件胞元中，一个圆柱形燃料芯块具有一个半径为 $R_{h}$ 的中心轴向孔和一个半径为 $R_{f}$ 的燃料外半径，其中 $R_h  R_f$。该固体燃料材料具有一个块体质量密度 $\\rho_{\\text{bulk}}$，这是在材料填充整个无孔圆柱体时所能达到的密度。为了在组件栅格中进行中子学均匀化，通常会将环形燃料区替换为占据整个半径 $R_{f}$ 的均匀“弥散”燃料，其选择方式应保证单位长度的燃料总质量守恒。\n\n从单位长度质量守恒和圆盘与圆环面积的基本几何关系出发，推导有效弥散燃料密度 $\\rho_{\\text{eff}}$ 关于 $\\rho_{\\text{bulk}}$、$R_{h}$ 和 $R_{f}$ 的闭式解析表达式。在您的推理中，请明确地将均匀化步骤描述为将实际圆环的单位长度质量与密度为 $\\rho_{\\text{eff}}$ 的均匀圆盘的单位长度质量相等同。\n\n然后，运用中子输运和宏观截面的第一性原理，定性地解释当棒状元件胞元嵌入组件栅格中时，用密度为 $\\rho_{\\text{eff}}$ 的弥散燃料替换环形燃料将如何改变其共振自屏效应，重点关注数密度和光学厚度的作用。此讨论无需进行数值评估。\n\n请以 $\\rho_{\\text{eff}}$ 的单个闭式解析表达式的形式提供最终答案。最终答案框中不要包含单位。无需四舍五入。",
            "solution": "该问题要求两部分内容：首先，推导环形燃料芯块的有效弥散燃料密度 $\\rho_{\\text{eff}}$；其次，定性解释这种均匀化如何影响共振自屏效应。\n\n首先，我们来推导有效弥散燃料密度 $\\rho_{\\text{eff}}$。指导这种均匀化的基本原理是单位长度燃料总质量守恒。\n\n让我们考虑一段单位长度的燃料棒。实际燃料呈环形，内半径为 $R_{h}$，外半径为 $R_{f}$。燃料材料本身具有均匀的块体质量密度，记为 $\\rho_{\\text{bulk}}$。该环形燃料区单位长度的体积等于其横截面积 $A_{\\text{annulus}}$。圆环的面积是外圆盘的面积减去内圆盘的面积。\n$$A_{\\text{annulus}} = \\pi R_{f}^{2} - \\pi R_{h}^{2} = \\pi (R_{f}^{2} - R_{h}^{2})$$\n圆环中单位长度的燃料质量 $m_{\\text{annulus}}$ 是其单位长度的体积与其密度的乘积。\n$$m_{\\text{annulus}} = \\rho_{\\text{bulk}} \\times A_{\\text{annulus}} = \\rho_{\\text{bulk}} \\pi (R_{f}^{2} - R_{h}^{2})$$\n\n接下来，我们考虑均匀化模型。在此模型中，环形燃料被替换为具有相同外半径 $R_{f}$ 的均匀实心圆柱形燃料盘。中心孔被这种“弥散”燃料材料填充。这个均匀化的燃料盘具有一个我们需要确定的有效弥散密度 $\\rho_{\\text{eff}}$。这个均匀化燃料盘单位长度的体积是其横截面积 $A_{\\text{smeared}}$。\n$$A_{\\text{smeared}} = \\pi R_{f}^{2}$$\n这个均匀化燃料盘中单位长度的燃料质量 $m_{\\text{smeared}}$ 是其单位长度的体积与其有效密度的乘积。\n$$m_{\\text{smeared}} = \\rho_{\\text{eff}} \\times A_{\\text{smeared}} = \\rho_{\\text{eff}} \\pi R_{f}^{2}$$\n\n均匀化的核心要求是单位长度的燃料总质量守恒。因此，我们必须使实际圆环的单位长度质量与弥散盘的单位长度质量相等。\n$$m_{\\text{annulus}} = m_{\\text{smeared}}$$\n代入上面推导出的表达式：\n$$\\rho_{\\text{bulk}} \\pi (R_{f}^{2} - R_{h}^{2}) = \\rho_{\\text{eff}} \\pi R_{f}^{2}$$\n现在我们可以通过分离变量来求解有效弥散密度 $\\rho_{\\text{eff}}$。两边的因子 $\\pi$ 可以消去。\n$$\\rho_{\\text{eff}} = \\rho_{\\text{bulk}} \\frac{R_{f}^{2} - R_{h}^{2}}{R_{f}^{2}}$$\n该表达式可以简化为其最终形式：\n$$\\rho_{\\text{eff}} = \\rho_{\\text{bulk}} \\left(1 - \\frac{R_{h}^{2}}{R_{f}^{2}}\\right) = \\rho_{\\text{bulk}} \\left(1 - \\left(\\frac{R_{h}}{R_{f}}\\right)^{2}\\right)$$\n这个结果在物理上是直观的。由于弥散体积大于实际燃料体积，有效密度 $\\rho_{\\text{eff}}$ 必须小于块体材料密度 $\\rho_{\\text{bulk}}$，这与当 $R_{h}  0$ 时因子 $\\left(1 - (R_{h}/R_{f})^2\\right)$ 小于 1 的情况相符。\n\n其次，我们定性地解释这种均匀化如何改变共振自屏效应。共振自屏效应是核反应堆中一个关键的非均匀效应。在被称为共振的特定中子能量下，像 $^{238}\\text{U}$ 这样的燃料同位素的吸收截面 $\\sigma_{a}$ 会变得非常大。\n\n在实际的环形几何结构中，燃料材料具有很高的块体数密度 $N_{\\text{bulk}}$，它与质量密度 $\\rho_{\\text{bulk}}$ 成正比。因此，燃料中的宏观吸收截面 $\\Sigma_{a, \\text{bulk}} = N_{\\text{bulk}} \\sigma_{a}$ 在共振能量处非常高。这使得燃料环在光学上是厚的。从中子慢化剂或中心孔进入燃料的中子在非常靠近燃料区表面的地方被吸收。这在燃料块体内部的这些共振能量处造成了中子通量的显著凹陷。燃料内部的原子核被表面的原子核“屏蔽”，从而免受共振能量中子的影响。与通量均匀的情况相比，这降低了总的有效吸收率。\n\n当我们用弥散模型替换环形燃料时，会发生两个关键变化。首先，正如我们所推导的，有效密度降低了：$\\rho_{\\text{eff}}  \\rho_{\\text{bulk}}$。这直接意味着燃料原子的有效数密度也降低了：$N_{\\text{eff}}  N_{\\text{bulk}}$。其次，几何形状从空心环变为实心盘；先前允许中子流注的中心空隙现在被稀释的燃料-慢化剂混合物（实际上）填充。\n\n数密度的降低导致更小的有效宏观截面，$\\Sigma_{a, \\text{eff}} = N_{\\text{eff}} \\sigma_{a}  \\Sigma_{a, \\text{bulk}}$。较低的宏观截面意味着中子的平均自由程更长，燃料介质在光学上变得更加透明。因此，燃料表面的严重通量凹陷得以减轻。中子在被吸收前可以更深地穿透到燃料区域。均匀化过程本质上是用一个较弱、更弥散的吸收体取代了一个强的、空间局域的吸收体。\n\n通过降低光学厚度和使材料分布平滑化，均匀化过程内在地削弱了自屏效应。该模型不再能捕捉到非均匀系统特有的强表面吸收和内部通量凹陷。结果是，在弥散燃料模型中计算出的共振吸收率将高于环形棒状元件胞元中的实际吸收率，因为该模型低估了自屏效应。从实践的角度来看，使用此类均匀化模型的反应堆分析程序必须应用修正因子来弥补对共振自屏效应的这种低估。",
            "answer": "$$\n\\boxed{\\rho_{\\text{bulk}} \\left(1 - \\left(\\frac{R_{h}}{R_{f}}\\right)^{2}\\right)}\n$$"
        },
        {
            "introduction": "中子截面随能量的变化极为复杂，直接求解非常耗时。因此，将成百上千个精细能量群的数据“压缩”成几个宽能量群的常数是晶格物理计算的标准流程。本练习将让你亲手实践这一能量群压缩过程，并探索不同加权谱（如无限介质谱与考虑泄漏的谱）对最终群常数的影响，从而揭示选择加权谱的重要性。",
            "id": "4228080",
            "problem": "给定一个核反应堆模拟中燃料棒栅元分辨率下的细能量群数据，其代表了组件栅格内的单个燃料棒。目标是将 $G=70$ 个能量群的细群宏观反应数据缩聚到 $2$ 个群，并量化在使用两种不同权重谱（无限栅格权重谱和泄漏调整权重谱）时，得到的缩聚群常数的方差。\n\n从以下基本定义开始：\n- 对于宏观截面为 $\\Sigma_{X,g}$ 和标量通量为 $\\phi_g$ 的宏观反应，在群 $g$ 中的反应率密度为 $R_{X,g}=\\Sigma_{X,g}\\,\\phi_g$。这里 $X$ 表示特定的反应类型，具体指吸收和裂变产生。\n- 一个缩聚的 $H$ 群宏观常数 $\\overline{\\Sigma}_{X,H}$ 是一个唯一的常数，当乘以群 $H$ 中经过适当加权的平均通量时，能够再现所有属于 $H$ 的细群上的总反应率积分。在离散多群设置中，这是通过使用谱 $w_g$ 进行加权并强制保持反应率来实现的，这导出了离散的通量加权平均定义 $\\overline{\\Sigma}_{X,H}=\\dfrac{\\sum_{g\\in H}\\Sigma_{X,g}\\,w_g}{\\sum_{g\\in H}w_g}$。\n\n将使用两种权重谱：\n1. 无限栅格权重，定义为 $w_g=\\phi_g$。\n2. 泄漏调整权重，定义为 $w_g=\\tilde{\\phi}_g$，其中 $\\tilde{\\phi}_g=\\max\\left(\\phi_g-\\lambda\\,L_g,\\epsilon\\right)$，$\\epsilon$ 是一个小的正数下限以防止除以零，而 $L_g$ 是一个泄漏谱估计。泄漏项模拟了由有限组件环境中的净流引起的谱的软化或硬化。\n\n将 $G=70$ 个细群划分为 $2$ 个缩聚群，如下所示：\n- 群 $H=1$ (快/超热)：索引 $g=0,1,\\dots,29$。\n- 群 $H=2$ (热群)：索引 $g=30,31,\\dots,69$。\n\n通过参数化生成器为您提供了合成但物理上合理的燃料棒分辨细群数据，包括标量通量 $\\phi_g$、吸收反应率密度 $R_{a,g}$、裂变产生反应率密度 $R_{p,g}$，以及一个泄漏谱 $L_g$。对于每个测试案例，必须使用以下构造和参数值来生成输入：\n\n所有测试案例的通用构造：\n- 设群索引为 $g\\in\\{0,1,\\dots,69\\}$，其中 $g=0$ 是最高能量群，$g=69$ 是最低能量（热）群。\n- 通量分解为一个超热尾部和一个热峰：\n  $$\\phi_g=\\frac{A}{g+1}+B\\,\\exp\\!\\left(-\\frac{(g-g_t)^2}{2\\,s^2}\\right)。$$\n- 吸收宏观截面形状：\n  $$\\Sigma_{a,g}=\\sigma_{a,0}+\\sigma_{a,1}\\,\\exp\\!\\left(-\\frac{(g-g_t)^2}{2\\,s_a^2}\\right)+\\frac{\\sigma_{a,2}}{g+1}。$$\n- 宏观裂变产生项：\n  $$\\nu\\Sigma_{f,g}=\\sigma_{p,0}\\,\\exp\\!\\left(-\\frac{(g-g_t)^2}{2\\,s_f^2}\\right)+\\frac{\\sigma_{p,1}}{\\sqrt{g+1}}。$$\n- 反应率密度：\n  $$R_{a,g}=\\Sigma_{a,g}\\,\\phi_g,\\qquad R_{p,g}=\\nu\\Sigma_{f,g}\\,\\phi_g。$$\n- 泄漏谱估计量（燃料棒内谱梯度的有限差分幅度）：\n  $$L_g=c_{\\ell}\\,\\left|\\phi_g-\\phi_{g+1}\\right|,\\quad\\text{其中}\\quad \\phi_{70}\\equiv\\phi_{69}\\ \\text{用于边界}，$$\n  以及泄漏调整下限 $\\epsilon=10^{-12}$ 以在所有除法中保持数值稳定性。\n- 单位：$\\phi_g$ 的单位是 $\\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}$，$R_{a,g}$ 和 $R_{p,g}$ 的单位是 $\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}$，$\\Sigma_{a,g}$ 和 $\\nu\\Sigma_{f,g}$ 的单位是 $\\text{cm}^{-1}$，$L_g$ 的单位是 $\\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}$。所有缩聚的宏观常数 $\\overline{\\Sigma}_{a,H}$ 和 $\\overline{\\nu\\Sigma}_{f,H}$ 的单位是 $\\text{cm}^{-1}$。\n\n通过选择一个非负参数 $\\lambda$ 并计算来定义泄漏调整谱\n$$\\tilde{\\phi}_g=\\max\\left(\\phi_g-\\lambda\\,L_g,\\,\\epsilon\\right)。$$\n\n对于每个测试案例，使用无限栅格权重和泄漏调整权重计算缩聚的两群宏观吸收和裂变产生常数。然后，对于每个缩聚群 $H\\in\\{1,2\\}$ 和每个反应类型 $X\\in\\{a,\\,p\\}$（其中 $p$ 表示裂变产生），计算两种权重结果之间的方差，\n$$\\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{X,H}\\right)=\\frac{1}{2}\\sum_{k\\in\\{\\text{inf},\\text{leak}\\}}\\left(\\overline{\\Sigma}_{X,H}^{(k)}-\\overline{\\Sigma}_{X,H}^{\\text{mean}}\\right)^2,\\quad \\overline{\\Sigma}_{X,H}^{\\text{mean}}=\\frac{\\overline{\\Sigma}_{X,H}^{(\\text{inf})}+\\overline{\\Sigma}_{X,H}^{(\\text{leak})}}{2}。$$\n方差的单位是 $\\left(\\text{cm}^{-1}\\right)^2$。\n\n包含三个测试案例的测试套件，用于探测不同的谱和泄漏状态：\n- 案例 1（热化燃料棒，中等泄漏）：\n  - $A=1.0$, $B=5.0$, $g_t=65$, $s=3.0$,\n  - $\\sigma_{a,0}=0.02$, $\\sigma_{a,1}=0.5$, $s_a=5.0$, $\\sigma_{a,2}=0.01$,\n  - $\\sigma_{p,0}=0.7$, $s_f=4.0$, $\\sigma_{p,1}=0.02$,\n  - $c_{\\ell}=1.0$, $\\lambda=0.05$。\n- 案例 2（较硬谱燃料棒，较强泄漏）：\n  - $A=3.0$, $B=0.5$, $g_t=60$, $s=5.0$,\n  - $\\sigma_{a,0}=0.01$, $\\sigma_{a,1}=0.2$, $s_a=7.0$, $\\sigma_{a,2}=0.03$,\n  - $\\sigma_{p,0}=0.2$, $s_f=6.0$, $\\sigma_{p,1}=0.05$,\n  - $c_{\\ell}=2.0$, $\\lambda=0.10$。\n- 案例 3（热化燃料棒，无泄漏调整的边界情况）：\n  - $A=1.0$, $B=5.0$, $g_t=65$, $s=3.0$,\n  - $\\sigma_{a,0}=0.02$, $\\sigma_{a,1}=0.5$, $s_a=5.0$, $\\sigma_{a,2}=0.01$,\n  - $\\sigma_{p,0}=0.7$, $s_f=4.0$, $\\sigma_{p,1}=0.02$,\n  - $c_{\\ell}=1.0$, $\\lambda=0.00$。\n\n您的程序必须：\n- 对于每个测试案例，使用上述公式和参数构造细群数组 $\\phi_g$、$\\Sigma_{a,g}$、$\\nu\\Sigma_{f,g}$、$R_{a,g}$、$R_{p,g}$ 和 $L_g$。\n- 计算两种权重谱下的缩聚两群宏观吸收和裂变产生常数。\n- 对于每个测试案例，计算四个方差 $\\left[\\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{a,1}\\right),\\ \\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{a,2}\\right),\\ \\mathrm{Var}\\!\\left(\\overline{\\nu\\Sigma}_{f,1}\\right),\\ \\mathrm{Var}\\!\\left(\\overline{\\nu\\Sigma}_{f,2}\\right)\\right]$，单位为 $\\left(\\text{cm}^{-1}\\right)^2$。\n\n最终输出格式要求：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，按测试案例排序，并在每个测试案例内按上面列出的顺序排列。具体来说，输出必须是 $$\\left[\\text{case}_1\\ \\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{a,1}\\right),\\ \\text{case}_1\\ \\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{a,2}\\right),\\ \\text{case}_1\\ \\mathrm{Var}\\!\\left(\\overline{\\nu\\Sigma}_{f,1}\\right),\\ \\text{case}_1\\ \\mathrm{Var}\\!\\left(\\overline{\\nu\\Sigma}_{f,2}\\right),\\ \\text{case}_2\\ \\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{a,1}\\right),\\dots,\\ \\text{case}_3\\ \\mathrm{Var}\\!\\left(\\overline{\\nu\\Sigma}_{f,2}\\right)\\right],$$ 其中每个条目都是一个单位为 $\\left(\\text{cm}^{-1}\\right)^2$ 的浮点数。",
            "solution": "问题陈述已经过严格验证，并被确定为有效。它在科学上植根于核反应堆物理学原理，特别是多群中子输运理论。该问题定义明确，所有必要的数据、公式和约束都清晰界定，确保了唯一且可计算的解。语言客观，设置自洽且数学上合理。\n\n核心任务是执行宏观截面的能量群缩聚，这是反应堆分析中的一种标准技术，用于在保持基本物理特性的同时降低计算复杂性。其基本原理是保持反应率。一个粗能量群 $H$ 中的总反应率必须等于构成群 $H$ 的所有细能量群 $g$ 的反应率之和。\n给定类型为 $X$ 的反应，粗群 $H$ 中的总反应率为 $\\sum_{g \\in H} R_{X,g} = \\sum_{g \\in H} \\Sigma_{X,g}\\,\\phi_g$。我们寻求一个缩聚截面 $\\overline{\\Sigma}_{X,H}$，使得该反应率可以通过 $\\overline{\\Sigma}_{X,H}\\,\\overline{\\phi}_H$ 再现，其中 $\\overline{\\phi}_H$ 是群 $H$ 中的总通量，定义为 $\\overline{\\phi}_H = \\sum_{g \\in H} \\phi_g$。令两者相等可得：\n$$\n\\overline{\\Sigma}_{X,H} \\left( \\sum_{g \\in H} \\phi_g \\right) = \\sum_{g \\in H} \\Sigma_{X,g}\\,\\phi_g \\implies \\overline{\\Sigma}_{X,H} = \\frac{\\sum_{g \\in H} \\Sigma_{X,g}\\,\\phi_g}{\\sum_{g \\in H} \\phi_g}\n$$\n这正是问题陈述中针对权重谱 $w_g$ 为标量通量 $\\phi_g$ 本身情况所提供的公式。该问题通过引入任意权重谱 $w_g$ 来推广这一概念，从而得出了离散的通量加权平均定义：\n$$\n\\overline{\\Sigma}_{X,H} = \\frac{\\sum_{g\\in H}\\Sigma_{X,g}\\,w_g}{\\sum_{g\\in H}w_g}\n$$\n该计算必须针对权重谱 $w_g$ 的两种不同选择来执行：\n1.  **无限栅格权重**：$w_g = \\phi_g$。该谱是在一个概念上无限、周期性的燃料棒栅格中子学环境的特征，远离任何边界或材料不连续性。\n2.  **泄漏调整权重**：$w_g = \\tilde{\\phi}_g = \\max(\\phi_g - \\lambda L_g, \\epsilon)$。该谱是对无限栅格通量的修正，旨在近似模拟有限尺寸燃料组件中中子泄漏（净流）的影响。参数 $\\lambda$ 控制此调整的幅度，而下限 $\\epsilon$ 确保数值稳定性。\n\n解决方案是通过对所提供的三个测试案例执行直接的计算程序来获得的。\n\n**步骤 1：生成细群数据**\n对于每个测试案例，我们首先生成必要的 $G=70$ 个细群中子学数据。群索引范围从 $g=0$ 到 $g=69$。\n标量通量 $\\phi_g$、吸收截面 $\\Sigma_{a,g}$ 和裂变产生项 $\\nu\\Sigma_{f,g}$ 使用给定的参数化公式和该案例的特定参数进行计算：\n$$\n\\phi_g = \\frac{A}{g+1} + B\\,\\exp\\!\\left(-\\frac{(g-g_t)^2}{2\\,s^2}\\right)\n$$\n$$\n\\Sigma_{a,g} = \\sigma_{a,0} + \\sigma_{a,1}\\,\\exp\\!\\left(-\\frac{(g-g_t)^2}{2\\,s_a^2}\\right) + \\frac{\\sigma_{a,2}}{g+1}\n$$\n$$\n\\nu\\Sigma_{f,g} = \\sigma_{p,0}\\,\\exp\\!\\left(-\\frac{(g-g_t)^2}{2\\,s_f^2}\\right) + \\frac{\\sigma_{p,1}}{\\sqrt{g+1}}\n$$\n泄漏谱估计量 $L_g$ 计算为通量谱的有限差分幅度。对于 $g \\in \\{0, 1, \\dots, 68\\}$，$L_g = c_{\\ell}|\\phi_g - \\phi_{g+1}|$。对于边界群 $g=69$，问题规定 $\\phi_{70} \\equiv \\phi_{69}$，这意味着 $L_{69} = c_{\\ell}|\\phi_{69} - \\phi_{69}| = 0$。还构造了所要求的反应率 $R_{a,g}=\\Sigma_{a,g}\\phi_g$ 和 $R_{p,g}=\\nu\\Sigma_{f,g}\\phi_g$。\n\n**步骤 2：群缩聚**\n将 70 个细群划分为 2 个粗群：群 $H=1$（快/超热群，$g \\in \\{0, \\dots, 29\\}$）和群 $H=2$（热群，$g \\in \\{30, \\dots, 69\\}$）。对于每种反应类型（$X=a$ 表示吸收，$X=p$ 表示裂变产生）和每个粗群（$H=1, 2$），我们使用两种权重方案计算缩聚常数。\n\n对于**无限栅格权重**，我们使用 $w_g = \\phi_g$。例如，群 1 中吸收的缩聚截面为：\n$$\n\\overline{\\Sigma}_{a,1}^{(\\text{inf})} = \\frac{\\sum_{g=0}^{29} \\Sigma_{a,g}\\,\\phi_g}{\\sum_{g=0}^{29} \\phi_g}\n$$\n其他三个常数 $\\overline{\\Sigma}_{a,2}^{(\\text{inf})}$、$\\overline{\\nu\\Sigma}_{f,1}^{(\\text{inf})}$ 和 $\\overline{\\nu\\Sigma}_{f,2}^{(\\text{inf})}$，通过将公式应用于相应的截面数据和群索引，以类似方式计算。\n\n对于**泄漏调整权重**，我们首先计算权重谱 $w_g = \\tilde{\\phi}_g = \\max(\\phi_g - \\lambda L_g, \\epsilon)$，其中 $\\epsilon = 10^{-12}$。然后，群 1 中吸收的缩聚截面为：\n$$\n\\overline{\\Sigma}_{a,1}^{(\\text{leak})} = \\frac{\\sum_{g=0}^{29} \\Sigma_{a,g}\\,\\tilde{\\phi}_g}{\\sum_{g=0}^{29} \\tilde{\\phi}_g}\n$$\n同样，我们计算 $\\overline{\\Sigma}_{a,2}^{(\\text{leak})}$、$\\overline{\\nu\\Sigma}_{f,1}^{(\\text{leak})}$ 和 $\\overline{\\nu\\Sigma}_{f,2}^{(\\text{leak})}$。\n\n**步骤 3：方差计算**\n最后一步是量化两种权重方案结果之间的差异。对于每对缩聚常数（$\\overline{\\Sigma}_{X,H}^{(\\text{inf})}$ 和 $\\overline{\\Sigma}_{X,H}^{(\\text{leak})}$），计算其方差。所提供的公式 $\\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{X,H}\\right)=\\frac{1}{2}\\sum_{k}\\left(\\overline{\\Sigma}_{X,H}^{(k)}-\\overline{\\Sigma}_{X,H}^{\\text{mean}}\\right)^2$ 对于一个包含两个值的总体，可以简化为半差的平方：\n$$\n\\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{X,H}\\right) = \\left( \\frac{\\overline{\\Sigma}_{X,H}^{(\\text{inf})} - \\overline{\\Sigma}_{X,H}^{(\\text{leak})}}{2} \\right)^2\n$$\n对三个测试案例中的所有四对常数（$X \\in \\{a, p\\}$，$H \\in \\{1, 2\\}$）执行此计算。对于案例 3，其中泄漏调整参数 $\\lambda=0$，泄漏调整谱 $\\tilde{\\phi}_g$ 变得与无限栅格通量 $\\phi_g$ 相同（因为 $\\phi_g \\gg \\epsilon$），这导致期望 $\\overline{\\Sigma}_{X,H}^{(\\text{inf})} = \\overline{\\Sigma}_{X,H}^{(\\text{leak})}$ 并且所有产生的方差都为零。这可以作为数值实现的一个重要验证检查。\n\n整个过程是使用 Python 和 `numpy` 库实现的，该库非常适合所需的向量化数值计算。三个测试案例的结果按照输出格式要求汇总到一个列表中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves the group condensation problem for three test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: thermalized pin, moderate leakage\n        {\n            \"A\": 1.0, \"B\": 5.0, \"g_t\": 65.0, \"s\": 3.0,\n            \"sigma_a_0\": 0.02, \"sigma_a_1\": 0.5, \"s_a\": 5.0, \"sigma_a_2\": 0.01,\n            \"sigma_p_0\": 0.7, \"s_f\": 4.0, \"sigma_p_1\": 0.02,\n            \"c_l\": 1.0, \"lambda\": 0.05\n        },\n        # Case 2: harder spectrum pin, stronger leakage\n        {\n            \"A\": 3.0, \"B\": 0.5, \"g_t\": 60.0, \"s\": 5.0,\n            \"sigma_a_0\": 0.01, \"sigma_a_1\": 0.2, \"s_a\": 7.0, \"sigma_a_2\": 0.03,\n            \"sigma_p_0\": 0.2, \"s_f\": 6.0, \"sigma_p_1\": 0.05,\n            \"c_l\": 2.0, \"lambda\": 0.10\n        },\n        # Case 3: thermalized pin, no leakage adjustment\n        {\n            \"A\": 1.0, \"B\": 5.0, \"g_t\": 65.0, \"s\": 3.0,\n            \"sigma_a_0\": 0.02, \"sigma_a_1\": 0.5, \"s_a\": 5.0, \"sigma_a_2\": 0.01,\n            \"sigma_p_0\": 0.7, \"s_f\": 4.0, \"sigma_p_1\": 0.02,\n            \"c_l\": 1.0, \"lambda\": 0.00\n        }\n    ]\n\n    epsilon = 1.0e-12\n    num_groups = 70\n    g = np.arange(num_groups, dtype=np.float64)\n\n    group1_indices = slice(0, 30)\n    group2_indices = slice(30, num_groups)\n\n    all_results = []\n\n    for params in test_cases:\n        # Step 1: Generate fine-group data\n        phi_g = (params[\"A\"] / (g + 1.0) +\n                 params[\"B\"] * np.exp(-(g - params[\"g_t\"])**2 / (2.0 * params[\"s\"]**2)))\n\n        Sigma_a_g = (params[\"sigma_a_0\"] +\n                     params[\"sigma_a_1\"] * np.exp(-(g - params[\"g_t\"])**2 / (2.0 * params[\"s_a\"]**2)) +\n                     params[\"sigma_a_2\"] / (g + 1.0))\n\n        nuSigma_f_g = (params[\"sigma_p_0\"] * np.exp(-(g - params[\"g_t\"])**2 / (2.0 * params[\"s_f\"]**2)) +\n                       params[\"sigma_p_1\"] / np.sqrt(g + 1.0))\n\n        # These are requested but not used in the final variance calculation\n        # R_a_g = Sigma_a_g * phi_g\n        # R_p_g = nuSigma_f_g * phi_g\n\n        # Calculate L_g with boundary condition phi_70 = phi_69\n        phi_g_plus_1 = np.append(phi_g[1:], phi_g[-1])\n        L_g = params[\"c_l\"] * np.abs(phi_g - phi_g_plus_1)\n\n        # Step 2: Group Condensation\n        # Define weighting spectra\n        w_inf = phi_g\n        w_leak = np.maximum(phi_g - params[\"lambda\"] * L_g, epsilon)\n\n        def condense(sigma_fine, weight_fine, group_slice):\n            \"\"\"Performs group condensation for a single coarse group.\"\"\"\n            numerator = np.sum(sigma_fine[group_slice] * weight_fine[group_slice])\n            denominator = np.sum(weight_fine[group_slice])\n            return numerator / denominator if denominator != 0.0 else 0.0\n\n        # Condense using infinite-lattice weighting\n        Sigma_a1_inf = condense(Sigma_a_g, w_inf, group1_indices)\n        Sigma_a2_inf = condense(Sigma_a_g, w_inf, group2_indices)\n        nuSigma_f1_inf = condense(nuSigma_f_g, w_inf, group1_indices)\n        nuSigma_f2_inf = condense(nuSigma_f_g, w_inf, group2_indices)\n\n        # Condense using leakage-adjusted weighting\n        Sigma_a1_leak = condense(Sigma_a_g, w_leak, group1_indices)\n        Sigma_a2_leak = condense(Sigma_a_g, w_leak, group2_indices)\n        nuSigma_f1_leak = condense(nuSigma_f_g, w_leak, group1_indices)\n        nuSigma_f2_leak = condense(nuSigma_f_g, w_leak, group2_indices)\n\n        # Step 3: Variance Calculation\n        def calculate_variance(val_inf, val_leak):\n            \"\"\"Calculates variance for a population of two values.\"\"\"\n            return ((val_inf - val_leak) / 2.0)**2\n\n        var_a1 = calculate_variance(Sigma_a1_inf, Sigma_a1_leak)\n        var_a2 = calculate_variance(Sigma_a2_inf, Sigma_a2_leak)\n        var_p1 = calculate_variance(nuSigma_f1_inf, nuSigma_f1_leak)\n        var_p2 = calculate_variance(nuSigma_f2_inf, nuSigma_f2_leak)\n\n        all_results.extend([var_a1, var_a2, var_p1, var_p2])\n\n    # Final print statement in the exact required format.\n    # Using scientific notation to handle potentially very small numbers.\n    print(f\"[{','.join(f'{r:.12e}' for r in all_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "我们通常在无限大的周期性晶格假设下生成均匀化群常数，但实际反应堆堆芯是有限的，存在中子泄漏。本练习旨在量化这种理论与实际之间的差异所引入的计算偏差，并让你实现两种实用的修正方法。通过这个练习，你将深入理解从晶格计算到全堆芯分析的过渡，以及为什么需要“等效”均匀化技术来保证计算的准确性。",
            "id": "4228084",
            "problem": "要求您实现并分析一个简化的单区、单群扩散模型，以量化在使用无限栅格谱生成均匀化截面，然后应用于有泄漏的有限堆芯时，在有效中子增殖因数 $k_{\\text{eff}}$ 中引入的偏差。您还必须实现两种修正策略：超均匀化 (Superhomogenization, SPH) 缩放和反照率调整加权模型。\n\n使用以下基本原理。均匀介质中的稳态单群扩散方程可以写为\n$$\n\\nabla \\cdot \\left( D \\nabla \\phi \\right) + \\Sigma_a \\phi = \\frac{\\nu \\Sigma_f}{k_{\\text{eff}}} \\phi,\n$$\n其中 $D$ 是扩散系数（单位为 $\\text{cm}$），$\\Sigma_a$ 是宏观吸收截面（单位为 $\\text{cm}^{-1}$），$\\nu \\Sigma_f$ 是产生截面（单位为 $\\text{cm}^{-1}$），$\\phi$ 是中子标量通量。在无限均匀介质中，几何曲率 $B^2$ 为零，无限增殖因数为\n$$\nk_{\\infty} = \\frac{\\nu \\Sigma_f}{\\Sigma_a}。\n$$\n对于一个有限均匀堆芯，其通量形状产生的几何曲率为 $B^2$（单位为 $\\text{cm}^{-2}$），单能不泄漏概率近似为\n$$\nP_{\\text{NL}} = \\frac{1}{1 + B^2 L^2},\n$$\n其中扩散长度 $L^2 = \\frac{D}{\\Sigma_a}$ 的单位为 $\\text{cm}^2$。因此，\n$$\nk_{\\text{eff}} = k_{\\infty} P_{\\text{NL}} = \\frac{\\nu \\Sigma_f / \\Sigma_a}{1 + B^2 \\frac{D}{\\Sigma_a}}。\n$$\n\n在实践中，当使用无限栅格谱生成均匀化截面时，它们忽略了有限堆芯中由泄漏引起的谱移。当这类截面被用于有限堆芯的扩散计算时，会在 $k_{\\text{eff}}$ 中产生计算偏差。为了评估这种偏差，我们提供一个参数化的参考值 $k_{\\text{true}}$，它通过一个因子 $\\beta  1$ 增强泄漏效应来模拟更精确的计算（例如，输运或多群计算）：\n$$\nk_{\\text{true}} = \\frac{k_{\\infty}}{1 + \\beta B^2 L^2}。\n$$\n\n您必须实现两种修正策略：\n\n1. 超均匀化 (SPH) 缩放：将 $\\Sigma_a$ 和 $\\nu \\Sigma_f$ 同乘以一个因子 $s$（无量纲），而 $D$ 保持不变。这会保持 $k_{\\infty}$ 不变，但会将 $L^2$ 修改为 $L^2_s = \\frac{D}{\\Sigma_a s}$，从而得到\n$$\nk_{\\text{eff}}^{\\text{SPH}} = \\frac{k_{\\infty}}{1 + B^2 \\frac{D}{\\Sigma_a s}}。\n$$\n选择 $s$ 使得 $k_{\\text{eff}}^{\\text{SPH}} = k_{\\text{true}}$。\n\n2. 反照率调整加权：引入一个边界反照率 $a \\in [0,1]$（无量纲），它表示返回到系统中的出射中子流的比例。假设均匀化截面对泄漏分数 $(1-a)$ 存在一阶微扰依赖性，通过系数 $\\gamma_a \\ge 0$ 和 $\\gamma_f \\ge 0$（无量纲）产生调整后的截面\n$$\n\\Sigma_a^{\\text{alb}} = \\Sigma_a \\left(1 + \\gamma_a (1-a) \\right), \\quad \\nu \\Sigma_f^{\\text{alb}} = \\nu \\Sigma_f \\left(1 - \\gamma_f (1-a) \\right)。\n$$\n使用这些调整后的截面计算\n$$\nk_{\\text{eff}}^{\\text{alb}} = \\frac{\\nu \\Sigma_f^{\\text{alb}} / \\Sigma_a^{\\text{alb}}}{1 + B^2 \\frac{D}{\\Sigma_a^{\\text{alb}}}}。\n$$\n\n对于每个测试用例，计算：\n- 使用应用于有限堆芯的无限栅格截面计算出的 $k_{\\text{eff}}$，记为 $k_{\\text{calc}}$。\n- 偏差 $\\Delta k = k_{\\text{calc}} - k_{\\text{true}}$。\n- SPH 缩放因子 $s$ 和修正后的 $k_{\\text{eff}}^{\\text{SPH}}$。\n- 经反照率调整修正后的 $k_{\\text{eff}}^{\\text{alb}}$ 及其残差 $\\Delta k_{\\text{alb}} = k_{\\text{eff}}^{\\text{alb}} - k_{\\text{true}}$。\n\n单位：\n- $\\Sigma_a$ 单位为 $\\text{cm}^{-1}$。\n- $\\nu \\Sigma_f$ 单位为 $\\text{cm}^{-1}$。\n- $D$ 单位为 $\\text{cm}$。\n- $B^2$ 单位为 $\\text{cm}^{-2}$。\n- $k_{\\text{eff}}$ 是无量纲的。\n- $a$、$\\beta$、$\\gamma_a$ 和 $\\gamma_f$ 是无量纲的。\n\n角度单位不适用。所有比率输出必须是十进制数。将数值结果表示为浮点小数。\n\n测试套件：\n- 用例 $1$（标准情况）：$\\Sigma_a = 0.08 \\,\\text{cm}^{-1}$，$\\nu \\Sigma_f = 0.10 \\,\\text{cm}^{-1}$，$D = 1.2 \\,\\text{cm}$，$B^2 = 0.00044 \\,\\text{cm}^{-2}$，$a = 0.70$，$\\beta = 1.10$，$\\gamma_a = 0.02$，$\\gamma_f = 0.015$。\n- 用例 $2$（强泄漏，真空边界）：$\\Sigma_a = 0.10 \\,\\text{cm}^{-1}$，$\\nu \\Sigma_f = 0.115 \\,\\text{cm}^{-1}$，$D = 1.0 \\,\\text{cm}$，$B^2 = 0.00090 \\,\\text{cm}^{-2}$，$a = 0.00$，$\\beta = 1.20$，$\\gamma_a = 0.02$，$\\gamma_f = 0.015$。\n- 用例 $3$（近临界无限介质，弱泄漏）：$\\Sigma_a = 0.095 \\,\\text{cm}^{-1}$，$\\nu \\Sigma_f = 0.095 \\,\\text{cm}^{-1}$，$D = 1.0 \\,\\text{cm}$，$B^2 = 0.00020 \\,\\text{cm}^{-2}$，$a = 0.90$，$\\beta = 1.05$，$\\gamma_a = 0.01$，$\\gamma_f = 0.005$。\n\n程序要求：\n- 对所有测试用例，完全按照上述描述实现计算。\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个测试用例，并且本身是一个列表，顺序为 $[k_{\\text{calc}}, \\Delta k, k_{\\text{eff}}^{\\text{SPH}}, s, k_{\\text{eff}}^{\\text{alb}}, \\Delta k_{\\text{alb}}]$。",
            "solution": "用户提供了一个有效的问题陈述。\n\n该问题要求对有效中子增殖因数 $k_{\\text{eff}}$ 中的计算偏差进行定量分析，该偏差源于将无限栅格模型得到的均匀化截面应用于有限反应堆堆芯。该分析基于单群、单区中子扩散方程。此外，还需要实现并评估两种用于修正此偏差的方法：超均匀化 (SPH) 和反照率调整截面模型。\n\n基本模型是均匀介质中的稳态单群扩散方程：\n$$\n\\nabla \\cdot (D \\nabla \\phi) + \\Sigma_a \\phi = \\frac{\\nu\\Sigma_f}{k_{\\text{eff}}} \\phi\n$$\n通过应用曲率近似 $\\nabla^2\\phi = -B^2\\phi$，这可以被重写为特征方程：\n$$\n-D B^2 \\phi + \\Sigma_a \\phi = \\frac{\\nu \\Sigma_f}{k_{\\text{eff}}} \\phi\n$$\n解出 $k_{\\text{eff}}$ 并整理，得到有限堆芯的标准表达式：\n$$\nk_{\\text{eff}} = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D B^2} = \\frac{\\nu \\Sigma_f / \\Sigma_a}{1 + B^2 (D/\\Sigma_a)}\n$$\n这可以表示为无限增殖因数 $k_{\\infty} = \\frac{\\nu \\Sigma_f}{\\Sigma_a}$ 和不泄漏概率 $P_{\\text{NL}} = \\frac{1}{1+B^2 L^2}$ 的形式，其中 $L^2 = \\frac{D}{\\Sigma_a}$ 是扩散长度的平方。因此，$k_{\\text{eff}} = k_{\\infty} P_{\\text{NL}}$。\n\n每个测试用例的计算流程如下：\n\n1.  **基础计算与偏差评估**：\n    首先，我们使用提供的无限栅格截面（$\\Sigma_a$, $\\nu \\Sigma_f$）和扩散系数（$D$），应用于由曲率 $B^2$ 代表的有限堆芯几何，计算朴素的或“计算的”$k_{\\text{eff}}$，记为 $k_{\\text{calc}}$。\n    $$\n    k_{\\text{calc}} = \\frac{\\nu \\Sigma_f / \\Sigma_a}{1 + B^2 \\frac{D}{\\Sigma_a}}\n    $$\n    问题提供了一个参考值或“真实”值 $k_{\\text{true}}$，它通过一个增强因子 $\\beta  1$ 来增强泄漏项，从而模拟泄漏导致谱硬化的物理效应。这种硬化通常会增加有效扩散长度并改变反应率，而这些现象是单群无限栅格模型无法捕捉的。\n    $$\n    k_{\\text{true}} = \\frac{k_{\\infty}}{1 + \\beta B^2 L^2} = \\frac{\\nu \\Sigma_f / \\Sigma_a}{1 + \\beta B^2 \\frac{D}{\\Sigma_a}}\n    $$\n    计算偏差就是直接的差值：\n    $$\n    \\Delta k = k_{\\text{calc}} - k_{\\text{true}}\n    $$\n    正的 $\\Delta k$ 表明未修正的模型通过低估中子泄漏而高估了堆芯的反应性。\n\n2.  **超均匀化 (SPH) 修正**：\n    SPH 方法旨在修正扩散参数，使得简化的扩散计算能够复现已知的高保真结果，在此即为 $k_{\\text{true}}$。这里，我们用一个因子 $s$ 来缩放吸收截面和产生截面，而 $D$ 保持不变。修正后的有效增殖因数为：\n    $$\n    k_{\\text{eff}}^{\\text{SPH}} = \\frac{(\\nu \\Sigma_f s) / (\\Sigma_a s)}{1 + B^2 \\frac{D}{\\Sigma_a s}} = \\frac{k_{\\infty}}{1 + \\frac{B^2 L^2}{s}}\n    $$\n    注意 $k_{\\infty}$ 在此缩放下是不变的。我们通过强制条件 $k_{\\text{eff}}^{\\text{SPH}} = k_{\\text{true}}$ 来找到 $s$：\n    $$\n    \\frac{k_{\\infty}}{1 + \\frac{B^2 L^2}{s}} = \\frac{k_{\\infty}}{1 + \\beta B^2 L^2}\n    $$\n    这意味着 $1 + \\frac{B^2 L^2}{s} = 1 + \\beta B^2 L^2$，对于 $B^2 \\neq 0$ 和 $L^2 \\neq 0$，可以简化为 $\\frac{1}{s} = \\beta$，即 $s = \\frac{1}{\\beta}$。\n    由于 $\\beta  1$（为了模拟增强的泄漏），SPH 因子 $s$ 将小于 1。这正确地放大了泄漏项 $\\frac{B^2 L^2}{s}$，以匹配参考模型中的增强泄漏。我们使用这个 $s$ 值显式计算 $k_{\\text{eff}}^{\\text{SPH}}$，以确认它等于 $k_{\\text{true}}$。\n\n3.  **反照率调整加权修正**：\n    该方法基于边界反照率 $a$ 对截面引入唯象修正。反照率量化了在堆芯边界被反射的中子比例，因此泄漏分数与 $(1-a)$ 成正比。截面按如下方式调整：\n    $$\n    \\Sigma_a^{\\text{alb}} = \\Sigma_a \\left(1 + \\gamma_a (1-a) \\right)\n    $$\n    $$\n    \\nu \\Sigma_f^{\\text{alb}} = \\nu \\Sigma_f \\left(1 - \\gamma_f (1-a) \\right)\n    $$\n    这里，$\\gamma_a$ 和 $\\gamma_f$ 是非负的经验系数。该模型捕捉了物理趋势，即增加的泄漏（较低的 $a$）会使中子谱变硬，这倾向于增加 $\\Sigma_a$（因为能谱移到热吸收共振峰之上）并减少 $\\nu \\Sigma_f$（因为对某些同位素而言，能谱移到了裂变性较低的能量区域）。然后使用这些调整后的截面计算修正后的 $k_{\\text{eff}}$：\n    $$\n    k_{\\text{eff}}^{\\text{alb}} = \\frac{\\nu \\Sigma_f^{\\text{alb}} / \\Sigma_a^{\\text{alb}}}{1 + B^2 \\frac{D}{\\Sigma_a^{\\text{alb}}}}\n    $$\n    该模型的性能通过其相对于参考值的残差来评估：\n    $$\n    \\Delta k_{\\text{alb}} = k_{\\text{eff}}^{\\text{alb}} - k_{\\text{true}}\n    $$\n    一个小的残差表明，这种基于物理动机和反照率的修正，对于由 $\\beta$ 因子建模的复杂泄漏效应是一个很好的近似。\n\n实现将处理每个测试用例，顺序应用这些公式来计算所需的六个量：$k_{\\text{calc}}$、$\\Delta k$、$k_{\\text{eff}}^{\\text{SPH}}$、$s$、$k_{\\text{eff}}^{\\text{alb}}$ 和 $\\Delta k_{\\text{alb}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries outside the Python standard library are permitted.\n\ndef solve():\n    \"\"\"\n    Implements and analyzes a single-region, one-group diffusion model to quantify\n    and correct the bias in k_eff from using infinite-lattice cross sections.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Sa, nuSf, D, B2, a, beta, gamma_a, gamma_f)\n        (0.08, 0.10, 1.2, 0.00044, 0.70, 1.10, 0.02, 0.015),\n        (0.10, 0.115, 1.0, 0.00090, 0.00, 1.20, 0.02, 0.015),\n        (0.095, 0.095, 1.0, 0.00020, 0.90, 1.05, 0.01, 0.005),\n    ]\n\n    results = []\n    for case in test_cases:\n        Sigma_a, nuSigma_f, D, B2, a, beta, gamma_a, gamma_f = case\n\n        # --- Intermediate Quantities ---\n        # Infinite multiplication factor\n        k_inf = nuSigma_f / Sigma_a\n        # Squared diffusion length\n        L2 = D / Sigma_a\n\n        # --- Base Calculation and Bias Assessment ---\n        \n        # 1. Calculational k_eff using infinite-lattice cross sections\n        # k_eff = (nuSf/Sa) / (1 + B^2 * D/Sa)\n        k_calc = k_inf / (1.0 + B2 * L2)\n\n        # 2. Reference k_true with leakage enhancement factor beta\n        # k_true = k_inf / (1 + beta * B^2 * L^2)\n        k_true = k_inf / (1.0 + beta * B2 * L2)\n        \n        # 3. Bias Delta_k\n        delta_k = k_calc - k_true\n\n        # --- Correction Strategy 1: Superhomogenization (SPH) ---\n\n        # 4. SPH scaling factor s\n        # The derivation k_eff_sph = k_true leads to s = 1/beta\n        s = 1.0 / beta\n        \n        # 5. Corrected k_eff_sph\n        # Calculated explicitly as a verification, though by definition it equals k_true.\n        # k_eff_sph = k_inf / (1 + B^2 * (D / (Sigma_a * s)))\n        k_eff_sph = k_inf / (1.0 + B2 * (D / (Sigma_a * s)))\n\n        # --- Correction Strategy 2: Albedo-Adjusted Weighting ---\n        \n        # 6. Albedo-adjusted cross sections\n        leakage_fraction = 1.0 - a\n        Sigma_a_alb = Sigma_a * (1.0 + gamma_a * leakage_fraction)\n        nuSigma_f_alb = nuSigma_f * (1.0 - gamma_f * leakage_fraction)\n\n        # 7. Corrected k_eff_alb\n        # k_eff_alb = (nuSf_alb / Sa_alb) / (1 + B^2 * D / Sa_alb)\n        if Sigma_a_alb == 0:\n            # Avoid division by zero, although not expected with given constraints\n            k_eff_alb = float('inf') if nuSigma_f_alb > 0 else 0\n        else:\n            k_inf_alb = nuSigma_f_alb / Sigma_a_alb\n            k_eff_alb = k_inf_alb / (1.0 + B2 * D / Sigma_a_alb)\n\n        # 8. Residual error for albedo model\n        delta_k_alb = k_eff_alb - k_true\n        \n        # Assemble the results for the current case\n        case_results = [\n            k_calc,\n            delta_k,\n            k_eff_sph,\n            s,\n            k_eff_alb,\n            delta_k_alb\n        ]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The map(str, results) will convert each inner list to its string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}