{
    "hands_on_practices": [
        {
            "introduction": "The double heterogeneity problem begins at the micro-scale, with fuel grains embedded within a matrix. This exercise develops the foundational concept of the micro-Dancoff factor, $C_{\\mu}$, which quantifies the probability of a neutron traversing the moderator between grains without interaction. By folding a statistical chord-length distribution with the principle of exponential attenuation, you will derive a key parameter that governs micro-level self-shielding .",
            "id": "4254734",
            "problem": "Consider the micro-scale of a doubly heterogeneous fuel compact used in high-temperature gas-cooled reactors, where microscopic fuel grains (e.g., spherical kernels) are embedded in a graphite moderator matrix. Focus only on the micro-heterogeneity: the binary mixture of fuel and moderator is assumed statistically homogeneous and isotropic, with interfacial specific surface area per unit volume $S$ and moderator volume fraction $\\phi_{m}$. In the dilute, Markov two-phase limit, the chord-length distribution within the moderator phase is taken to be exponential with mean chord length $\\bar{\\ell}_{m}$ given by Miles' relation $\\bar{\\ell}_{m} = 4 \\phi_{m}/S$. At a fixed neutron energy in the slowing-down range, model the moderator as purely absorbing with macroscopic absorption cross section $\\Sigma_{m}$, and neglect scattering and energy change over a single moderator traversal.\n\nA neutron emerging from the surface of a fuel grain into the moderator travels a random moderator chord of length $s$ before re-entering the fuel phase. Under the exponential attenuation law $I(s) = I_{0}\\exp(-\\Sigma_{m} s)$ for survival without collision over a distance $s$ in the moderator, define the micro-Dancoff factor $C_{\\mu}$ as the probability that such a neutron reaches the next fuel region without any interaction in the moderator. Starting from the stated assumptions and fundamental transport attenuation, set up the integral expression that folds the moderator chord-length probability density with the exponential survival, and evaluate it to a closed-form analytic expression. Express your final answer in terms of $\\Sigma_{m}$, $S$, and $\\phi_{m}$. The final answer must be a single closed-form expression. No numerical approximation is required.",
            "solution": "The problem is deemed valid as it is scientifically grounded, well-posed, and objective. It describes a standard problem in nuclear reactor physics, specifically the calculation of the Dancoff factor in a doubly heterogeneous medium, using established models and principles from transport theory and statistical geometry. All necessary information and definitions are provided to derive a unique, meaningful solution.\n\nThe problem asks for the micro-Dancoff factor, $C_{\\mu}$, which is defined as the probability that a neutron emerging from a fuel grain travels through the moderator and reaches another fuel region without any interaction. This is an average probability, where the averaging is performed over all possible path lengths (chords) in the moderator.\n\nLet $s$ be the length of a random chord in the moderator. The problem states that the probability of a neutron traversing this distance $s$ without interaction is governed by the exponential attenuation law. This survival probability, $P_{\\text{surv}}(s)$, is given by:\n$$ P_{\\text{surv}}(s) = \\exp(-\\Sigma_{m} s) $$\nwhere $\\Sigma_{m}$ is the macroscopic absorption cross section of the moderator.\n\nThe problem also states that the distribution of chord lengths, $s$, within the moderator phase follows an exponential probability distribution. The probability density function (PDF) for an exponential distribution with a mean value $\\bar{\\lambda}$ is $p(x) = \\frac{1}{\\bar{\\lambda}} \\exp(-x/\\bar{\\lambda})$. In our case, the random variable is the chord length $s$, and its mean is given as $\\bar{\\ell}_{m}$. Therefore, the PDF for the chord length $s$, denoted as $p(s)$, is:\n$$ p(s) = \\frac{1}{\\bar{\\ell}_{m}} \\exp\\left(-\\frac{s}{\\bar{\\ell}_{m}}\\right) $$\nfor $s \\ge 0$. The probability that a chord has a length between $s$ and $s+ds$ is $p(s)ds$.\n\nThe micro-Dancoff factor, $C_{\\mu}$, is the total probability of survival, which is obtained by integrating the survival probability for a specific chord length, $P_{\\text{surv}}(s)$, weighted by the probability of that chord length occurring, $p(s)ds$, over all possible non-negative chord lengths from $0$ to $\\infty$. This constitutes the folding of the two distributions as requested.\nThe integral expression for $C_{\\mu}$ is therefore:\n$$ C_{\\mu} = \\int_{0}^{\\infty} P_{\\text{surv}}(s) \\, p(s) \\, ds $$\n\nSubstituting the expressions for $P_{\\text{surv}}(s)$ and $p(s)$:\n$$ C_{\\mu} = \\int_{0}^{\\infty} \\left[ \\exp(-\\Sigma_{m} s) \\right] \\left[ \\frac{1}{\\bar{\\ell}_{m}} \\exp\\left(-\\frac{s}{\\bar{\\ell}_{m}}\\right) \\right] ds $$\n\nWe can combine the exponential terms and factor out the constant $\\frac{1}{\\bar{\\ell}_{m}}$ from the integral:\n$$ C_{\\mu} = \\frac{1}{\\bar{\\ell}_{m}} \\int_{0}^{\\infty} \\exp\\left(-\\Sigma_{m} s - \\frac{s}{\\bar{\\ell}_{m}}\\right) ds $$\n$$ C_{\\mu} = \\frac{1}{\\bar{\\ell}_{m}} \\int_{0}^{\\infty} \\exp\\left(-s \\left(\\Sigma_{m} + \\frac{1}{\\bar{\\ell}_{m}}\\right)\\right) ds $$\n\nThis is a standard definite integral of an exponential function. Let the constant in the exponent be $k = \\Sigma_{m} + \\frac{1}{\\bar{\\ell}_{m}}$. The integral becomes:\n$$ \\int_{0}^{\\infty} \\exp(-ks) \\, ds = \\left[ -\\frac{1}{k} \\exp(-ks) \\right]_{0}^{\\infty} $$\nEvaluating the limits:\n$$ \\left( \\lim_{s \\to \\infty} -\\frac{1}{k} \\exp(-ks) \\right) - \\left( -\\frac{1}{k} \\exp(-k \\cdot 0) \\right) $$\nSince $k = \\Sigma_{m} + \\frac{1}{\\bar{\\ell}_{m}}$ is positive (physical cross sections and lengths are non-negative, and $\\Sigma_m0$ for an absorbing medium), the limit as $s \\to \\infty$ of $\\exp(-ks)$ is $0$. The expression simplifies to:\n$$ (0) - \\left( -\\frac{1}{k} \\exp(0) \\right) = \\frac{1}{k} $$\n\nSubstituting this result back into the expression for $C_{\\mu}$:\n$$ C_{\\mu} = \\frac{1}{\\bar{\\ell}_{m}} \\cdot \\frac{1}{k} = \\frac{1}{\\bar{\\ell}_{m}} \\cdot \\frac{1}{\\Sigma_{m} + \\frac{1}{\\bar{\\ell}_{m}}} $$\n\nTo simplify, we multiply the numerator and denominator by $\\bar{\\ell}_{m}$:\n$$ C_{\\mu} = \\frac{1}{\\bar{\\ell}_{m}\\left(\\Sigma_{m} + \\frac{1}{\\bar{\\ell}_{m}}\\right)} = \\frac{1}{\\bar{\\ell}_{m}\\Sigma_{m} + 1} $$\nThis expression is known as the Wigner rational approximation for the escape probability from a convex body, generalized here for a random medium.\n\nThe final step is to express the result in terms of the given parameters $\\Sigma_{m}$, $S$ (interfacial specific surface area), and $\\phi_{m}$ (moderator volume fraction). The problem provides Miles' relation for the mean chord length in the moderator:\n$$ \\bar{\\ell}_{m} = \\frac{4 \\phi_{m}}{S} $$\n\nSubstituting this expression for $\\bar{\\ell}_{m}$ into our result for $C_{\\mu}$:\n$$ C_{\\mu} = \\frac{1}{\\left(\\frac{4 \\phi_{m}}{S}\\right)\\Sigma_{m} + 1} $$\n\nThis can be rewritten into a more compact form by finding a common denominator in the denominator:\n$$ C_{\\mu} = \\frac{1}{\\frac{4 \\phi_{m} \\Sigma_{m} + S}{S}} $$\n$$ C_{\\mu} = \\frac{S}{S + 4 \\phi_{m} \\Sigma_{m}} $$\n\nThis is the final closed-form analytic expression for the micro-Dancoff factor $C_{\\mu}$ under the stated assumptions.",
            "answer": "$$\\boxed{\\frac{S}{S + 4 \\phi_{m} \\Sigma_{m}}}$$"
        },
        {
            "introduction": "While statistical models provide valuable insight, practical analysis requires deterministic methods for specific geometries. This practice introduces the powerful Collision Probability (CP) method, a cornerstone of lattice physics calculations for solving the transport equation in heterogeneous systems. You will calculate the probability of a neutron born in a fuel lump having its first collision in the surrounding matrix, directly modeling the crucial link between micro-scale escape and macro-scale transport .",
            "id": "4254690",
            "problem": "Consider a one-speed neutron transport model for a representative pin cell treated by an equivalent spherical cell. A spherical absorber lump (region $1$) of radius $a$ is centered inside a surrounding matrix shell (region $2$) that extends to an outer vacuum boundary at radius $R_{p}$. The macroscopic total cross section is $\\Sigma_{t,1}$ in the absorber lump and $\\Sigma_{t,2}$ in the matrix shell. Assume isotropic, uniform volumetric neutron sources in each finite region, straight-line attenuation between collisions, and a vacuum boundary at $r=R_{p}$. The interface crossing angular distribution is taken to be cosine-law (Lambertian) for an isotropic interior source.\n\nDefine the collision probability matrix $\\mathbf{P}$ for the finite regions $1$ and $2$, where $P_{ij}$ is the probability that a neutron born in region $i$ undergoes its \\emph{first} collision in region $j$. Let $L_{i}$ denote the probability that a neutron born in region $i$ leaks to the vacuum boundary at $r=R_{p}$ without ever colliding. Thus, for each source region $i$, conservation requires $P_{i1}+P_{i2}+L_{i}=1$.\n\nStarting from the linear Boltzmann equation and the definition of first-collision probabilities as path-integrals of exponential attenuation over the appropriate chord-length distributions, set up the structure of $\\mathbf{P}$ and the leakage vector $\\mathbf{L}$ in terms of regionwise escape and transmission probabilities. Then, using:\n- the chord-length distribution for a sphere of radius $a$ for an isotropic source inside region $1$, and\n- a cosine-law incidence across a planar slab of thickness $t=R_{p}-a$ to approximate outward streaming through the matrix shell (region $2$) from the inner interface,\n\nderive a closed-form analytic expression for $P_{12}$, the probability that a neutron born in the absorber lump (region $1$) experiences its first collision in the matrix shell (region $2$), expressed in terms of $a$, $R_{p}$, $\\Sigma_{t,1}$, $\\Sigma_{t,2}$, and the exponential integral function $E_{3}(x)$ defined by\n$$\nE_{3}(x) \\equiv \\int_{1}^{\\infty} \\exp(-x t)\\, t^{-3}\\, dt.\n$$\n\nYour final answer must be a single closed-form analytic expression for $P_{12}$. No numerical evaluation is required.",
            "solution": "The problem is first validated against the required criteria.\n\n### Problem Validation\n**Step 1: Extract Givens**\n- **Model:** One-speed neutron transport in a spherical cell geometry.\n- **Region 1:** Sphere of radius $a$, macroscopic total cross section $\\Sigma_{t,1}$.\n- **Region 2:** Spherical shell from radius $a$ to $R_p$, macroscopic total cross section $\\Sigma_{t,2}$.\n- **Boundary:** Vacuum boundary at $r=R_p$.\n- **Source:** Isotropic, uniform volumetric neutron source in each region.\n- **Transport:** Straight-line attenuation.\n- **Definitions:**\n    - $P_{ij}$: Probability a neutron born in region $i$ has its first collision in region $j$.\n    - $L_{i}$: Probability a neutron born in region $i$ leaks to vacuum.\n    - Conservation: $P_{i1} + P_{i2} + L_{i} = 1$ for $i \\in \\{1, 2\\}$.\n- **Approximations for Derivation:**\n    1. The chord-length distribution for a sphere of radius $a$ is to be used for the source in region $1$.\n    2. The outward streaming through the matrix shell (region $2$) is modeled as a cosine-law (Lambertian) incidence on a planar slab of thickness $t=R_{p}-a$.\n- **Function Definition:** $E_{3}(x) \\equiv \\int_{1}^{\\infty} \\exp(-x t)\\, t^{-3}\\, dt$.\n- **Objective:** Derive a closed-form analytic expression for $P_{12}$ in terms of $a$, $R_p$, $\\Sigma_{t,1}$, $\\Sigma_{t,2}$, and $E_3(x)$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a classic idealization in nuclear reactor physics, used to study self-shielding and interaction rates in heterogeneous media (the double heterogeneity problem). All concepts—collision probabilities, one-speed transport, cross sections, spherical cell models, and path-integral formulations—are fundamental to neutron transport theory. The specified approximations, while simplifying, are common pedagogical tools. The problem is scientifically sound.\n- **Well-Posed:** The problem is well-posed. It asks for a specific quantity, $P_{12}$, and provides a complete and consistent set of definitions, regions, and, crucially, a set of simplifying assumptions that make an analytical solution tractable.\n- **Objective:** The problem is stated in precise, objective, and technical language, free of any subjective or non-scientific content.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. It is a standard, well-defined problem in transport theory that tests the application of first-collision probability methods. I will now proceed with the derivation.\n\n### Derivation of $P_{12}$\nThe quantity $P_{12}$ is the probability that a neutron born uniformly and isotropically in region $1$ (the central sphere) undergoes its first collision in region $2$ (the surrounding shell). This physical process can be decomposed into two sequential, independent events:\n1.  The neutron must escape region $1$ without having a collision.\n2.  After entering region $2$, the neutron must collide within region $2$ before leaking out to the vacuum boundary.\n\nWe can express $P_{12}$ as the product of the probabilities of these two events:\n$$P_{12} = P_{1\\to S} \\times P_{S\\to 2}$$\nwhere:\n- $P_{1\\to S}$ is the first-flight escape probability for a neutron born in region $1$ to reach its surface $S$ (at $r=a$).\n- $P_{S\\to 2}$ is the conditional probability that a neutron, having just entered region $2$ from region $1$ through the surface $S$, will collide in region $2$.\n\nWe will derive each of these probabilities in turn, following the instructions in the problem statement.\n\n**1. Calculation of the Escape Probability from Region 1, $P_{1\\to S}$**\n\nThe problem states to use the \"chord-length distribution for a sphere of radius $a$ for an isotropic source inside region $1$\". This is the standard method for deriving the escape probability from a uniform, isotropic source within a convex body. The derivation involves integrating the escape probability for each possible chord length, weighted by the probability distribution of those chord lengths. The established result for a sphere of radius $a$ with a uniform macroscopic total cross section $\\Sigma_{t,1}$ is given by the formula of Case, de Hoffmann, and Placzek:\n$$P_{1\\to S} = \\frac{3}{8 (\\Sigma_{t,1} a)^3} \\left[ 2(\\Sigma_{t,1} a)^2 - 1 + (1+2\\Sigma_{t,1} a)\\exp(-2\\Sigma_{t,1} a) \\right]$$\nThis is the exact analytical expression for the escape probability from a sphere. For convenience, let the optical radius of region $1$ be $x_1 = \\Sigma_{t,1} a$. The expression is:\n$$P_{1\\to S} = \\frac{3}{8 x_1^3} \\left[ 2x_1^2 - 1 + (1+2x_1)\\exp(-2x_1) \\right]$$\n\n**2. Calculation of the Collision Probability in Region 2, $P_{S\\to 2}$**\n\nTo calculate $P_{S\\to 2}$, the problem instructs us to use two critical approximations:\n(a) The angular distribution of the neutron current escaping region $1$ and entering region $2$ is a cosine-law (Lambertian) distribution.\n(b) The spherical shell of region $2$ can be treated as a planar slab of thickness $t = R_p - a$ and uniform macroscopic total cross section $\\Sigma_{t,2}$.\n\nThe collision probability $P_{S\\to 2}$ is complementary to the transmission probability $T_2$ through this effective slab, i.e., $P_{S\\to 2} = 1 - T_2$. We first calculate $T_2$.\n\nFor a cosine-law source on the surface of a slab, the normalized angular distribution of neutrons entering the slab is given by $f(\\mu) = 2\\mu$ for $\\mu \\in [0, 1]$, where $\\mu = \\cos\\theta$ and $\\theta$ is the angle with respect to the normal of the slab surface.\n\nA neutron entering the slab at an angle corresponding to $\\mu$ travels a path length of $s = t/\\mu$ to cross the slab. The probability of transmission (no collision) for this specific neutron is $\\exp(-\\Sigma_{t,2} s) = \\exp(-\\Sigma_{t,2} t / \\mu)$.\n\nTo find the total transmission probability $T_2$, we must average this over the angular distribution $f(\\mu)$:\n$$T_2 = \\int_0^1 \\exp\\left(-\\frac{\\Sigma_{t,2} t}{\\mu}\\right) f(\\mu) \\,d\\mu = \\int_0^1 \\exp\\left(-\\frac{\\Sigma_{t,2} t}{\\mu}\\right) (2\\mu) \\,d\\mu$$\nLet the optical thickness of the slab be $\\tau_2 = \\Sigma_{t,2} t = \\Sigma_{t,2}(R_p-a)$. The integral becomes:\n$$T_2 = 2 \\int_0^1 \\mu \\exp(-\\tau_2/\\mu) \\,d\\mu$$\nTo solve this integral, we perform a substitution. Let $u = 1/\\mu$, so $d\\mu = -1/u^2 \\,du$. The limits of integration change from $\\mu=0$ to $u=\\infty$ and $\\mu=1$ to $u=1$.\n$$T_2 = 2 \\int_\\infty^1 \\frac{1}{u} \\exp(-\\tau_2 u) \\left(-\\frac{1}{u^2}\\right) \\,du = 2 \\int_1^\\infty \\frac{\\exp(-\\tau_2 u)}{u^3} \\,du$$\nThis integral is, by the definition provided in the problem, precisely $2$ times the third-order exponential integral function, $E_3(\\tau_2)$.\n$$T_2 = 2 E_3(\\tau_2) = 2 E_3(\\Sigma_{t,2}(R_p-a))$$\nThe probability of collision in the slab, $P_{S\\to 2}$, is therefore:\n$$P_{S\\to 2} = 1 - T_2 = 1 - 2 E_3(\\Sigma_{t,2}(R_p-a))$$\n\n**3. Assembling the Final Expression for $P_{12}$**\n\nFinally, we combine the expressions for $P_{1\\to S}$ and $P_{S\\to 2}$ to obtain the final expression for $P_{12}$:\n$$P_{12} = P_{1\\to S} \\times P_{S\\to 2}$$\n$$P_{12} = \\left( \\frac{3}{8 (\\Sigma_{t,1} a)^3} \\left[ 2(\\Sigma_{t,1} a)^2 - 1 + (1+2\\Sigma_{t,1} a)\\exp(-2\\Sigma_{t,1} a) \\right] \\right) \\times \\left( 1 - 2 E_3(\\Sigma_{t,2}(R_p-a)) \\right)$$\nThis is the closed-form analytic expression for the probability that a neutron born in the central absorber lump has its first collision in the surrounding matrix shell, under the specified model and approximations.",
            "answer": "$$\\boxed{\\left( \\frac{3}{8 (\\Sigma_{t,1} a)^3} \\left( 2(\\Sigma_{t,1} a)^2 - 1 + (1+2\\Sigma_{t,1} a)\\exp(-2\\Sigma_{t,1} a) \\right) \\right) \\left( 1 - 2 E_3(\\Sigma_{t,2}(R_p-a)) \\right)}$$"
        },
        {
            "introduction": "Understanding the theoretical basis of self-shielding and Dancoff corrections is essential, but their true significance lies in their impact on overall reactor behavior. This computational exercise provides a direct, quantitative measure of how double heterogeneity affects the infinite multiplication factor, $k_{\\infty}$. By implementing a simplified two-group model and selectively toggling micro- and macro-scale corrections, you will gain practical experience in sensitivity analysis and learn to prioritize modeling efforts based on the physical regime of the reactor system .",
            "id": "4254731",
            "problem": "Consider an infinite-medium, two-energy-group neutron balance for a homogenized representation of a doubly heterogeneous fuel-moderator system. The double heterogeneity arises from microscopic fuel grains embedded in a fuel compact (micro-scale) and the spatial arrangement of fuel lumps within a moderator matrix (macro-scale). The objective is to isolate and quantify the contribution of micro-escape compared to macro Dancoff coupling on reaction rates and the infinite-medium multiplication factor. You are asked to implement a program that toggles each correction in turn and measures the changes in reaction rates and the infinite-medium multiplication factor to prioritize modeling effort.\n\nFundamental base:\n- Neutron balance in an infinite medium can be represented in multigroup form as a generalized eigenvalue problem. Let $\\phi_1$ be the fast-group flux and $\\phi_2$ be the thermal/resonance-group flux. Define the removal operator matrix $A$ and the fission production operator matrix $F$ as follows:\n$$\nA = \\begin{bmatrix}\n\\Sigma_{r,1}  0 \\\\\n-\\Sigma_{s,1\\to 2}  \\Sigma_{a,2}^{\\text{eff}}\n\\end{bmatrix}, \\quad\nF = \\begin{bmatrix}\n\\chi_1 \\nu \\Sigma_{f,1}  \\chi_1 \\nu \\Sigma_{f,2} \\\\\n\\chi_2 \\nu \\Sigma_{f,1}  \\chi_2 \\nu \\Sigma_{f,2}\n\\end{bmatrix},\n$$\nwhere $\\Sigma_{r,1} = \\Sigma_{a,1} + \\Sigma_{s,1\\to 2}$, $\\Sigma_{a,2}^{\\text{eff}}$ is the effective absorption cross section in group $2$, $\\nu$ is the average number of neutrons per fission, and $\\chi_1$, $\\chi_2$ are the fission spectrum fractions to groups $1$ and $2$, respectively. The infinite-medium multiplication factor $k_\\infty$ is obtained as the dominant eigenvalue of $A^{-1} F$:\n$$\nA^{-1} F \\, \\Phi = k_\\infty \\, \\Phi, \\quad \\Phi = \\begin{bmatrix}\\phi_1 \\\\ \\phi_2\\end{bmatrix}.\n$$\n- The reaction rate in group $2$ for absorption is $R_{a,2} = \\Sigma_{a,2}^{\\text{eff}} \\, \\phi_2$, with flux normalization chosen such that $\\phi_1 + \\phi_2 = 1$.\n\nMicro-escape and macro Dancoff modeling assumptions:\n- Micro-escape captures the reduction in effective resonance absorption due to the finite optical thickness of microscopic fuel grains. For spherical grains of radius $r_g$, let the optical thickness be $\\tau_g = \\Sigma_{t,\\text{fuel}} \\, r_g$, where $\\Sigma_{t,\\text{fuel}}$ is the total cross section of the fuel in group $2$. A linearized self-shielding correction factor is used:\n$$\n\\Sigma_{a,2}^{\\text{eff}} = \\frac{\\Sigma_{a,2}^{\\text{base}}}{1 + \\alpha_0 \\, \\tau_g \\, T_{\\text{micro}} + \\beta_0 \\, \\left(\\frac{1}{\\Sigma_{t,\\text{mod}} \\, s}\\right) \\, C \\, T_{\\text{macro}}},\n$$\nwhere $\\Sigma_{a,2}^{\\text{base}}$ is the baseline absorption cross section for group $2$, $\\alpha_0$ and $\\beta_0$ are dimensionless correction coefficients for micro-escape and macro coupling, $\\Sigma_{t,\\text{mod}}$ is the moderator total cross section in group $2$, $s$ is a characteristic fuel lump spacing, and $C \\in [0,1]$ is the macro Dancoff factor, and $T_{\\text{micro}}, T_{\\text{macro}} \\in \\{0,1\\}$ are toggles enabling the corresponding correction. The macro-Dancoff factor $C$ quantifies mutual shadowing between lumps. A higher value of $C$ implies stronger shadowing, which increases resonance self-shielding. This is modeled by a correction term proportional to $C \\cdot T_{\\text{macro}}$ in the denominator.\n- This simplified model is scientifically plausible for isolating trends: increasing $r_g$ increases $\\tau_g$, which increases micro-escape correction magnitude; increasing $C$ increases the macro correction magnitude; decreasing $s$ increases the macro correction magnitude by increasing the moderator coupling factor.\n\nNumerical data:\n- Use fixed material and spectrum parameters common to all test cases:\n  - $\\nu = 2.43$.\n  - $\\chi_1 = 0.95$, $\\chi_2 = 0.05$.\n  - $\\Sigma_{f,1} = 0.001$ $\\text{cm}^{-1}$, $\\Sigma_{f,2} = 0.06$ $\\text{cm}^{-1}$.\n  - $\\Sigma_{a,1} = 0.005$ $\\text{cm}^{-1}$.\n  - $\\Sigma_{s,1\\to 2} = 0.08$ $\\text{cm}^{-1}$.\n  - $\\Sigma_{a,2}^{\\text{base}} = 0.12$ $\\text{cm}^{-1}$.\n  - $\\Sigma_{t,\\text{fuel}} = 0.6$ $\\text{cm}^{-1}$.\n  - $\\Sigma_{t,\\text{mod}} = 0.2$ $\\text{cm}^{-1}$.\n  - $\\alpha_0 = 0.8$, $\\beta_0 = 0.2$.\n- Define toggling scenarios for each test case:\n  - None: $T_{\\text{micro}} = 0$, $T_{\\text{macro}} = 0$.\n  - Micro only: $T_{\\text{micro}} = 1$, $T_{\\text{macro}} = 0$.\n  - Macro only: $T_{\\text{micro}} = 0$, $T_{\\text{macro}} = 1$.\n  - Both: $T_{\\text{micro}} = 1$, $T_{\\text{macro}} = 1$.\n\nTest suite:\n- Each test case specifies $(r_g, C, s)$ with units in centimeters for $r_g$ and $s$.\n  1. Happy path: $r_g = 0.05$ $\\text{cm}$, $C = 0.5$, $s = 1.0$ $\\text{cm}$.\n  2. Micro negligible: $r_g = 0.001$ $\\text{cm}$, $C = 0.4$, $s = 2.0$ $\\text{cm}$.\n  3. Macro dominant: $r_g = 0.05$ $\\text{cm}$, $C = 0.0$, $s = 0.5$ $\\text{cm}$.\n  4. Macro negligible, micro dominant: $r_g = 0.2$ $\\text{cm}$, $C = 0.95$, $s = 5.0$ $\\text{cm}$.\n\nYour tasks:\n- For each test case, compute $k_\\infty$ and the group $2$ absorption reaction rate $R_{a,2}$ under the four toggling scenarios: None, Micro only, Macro only, Both.\n- Normalize the flux vector $\\Phi$ so that $\\phi_1 + \\phi_2 = 1$ before computing $R_{a,2}$.\n- Produce the following outputs per test case:\n  - The four values of $k_\\infty$ in the order [None, Micro only, Macro only, Both].\n  - The changes in group $2$ absorption reaction rate with respect to the \"None\" scenario: $\\Delta R_{a,2}^{\\text{micro}} = R_{a,2}^{\\text{micro}} - R_{a,2}^{\\text{none}}$ and $\\Delta R_{a,2}^{\\text{macro}} = R_{a,2}^{\\text{macro}} - R_{a,2}^{\\text{none}}$. Reaction rates are in flux-normalized units constructed as cross section times normalized flux and therefore do not carry physical units.\n  - Two integer flags indicating modeling priority based on magnitude of changes:\n    - $P_k = 0$ if $\\left|k_\\infty^{\\text{macro}} - k_\\infty^{\\text{none}}\\right|  \\left|k_\\infty^{\\text{micro}} - k_\\infty^{\\text{none}}\\right|$, else $P_k = 1$.\n    - $P_R = 0$ if $\\left|\\Delta R_{a,2}^{\\text{macro}}\\right|  \\left|\\Delta R_{a,2}^{\\text{micro}}\\right|$, else $P_R = 1$.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of per-test-case results, where each test case result is a sublist formatted as:\n$$\n[\\;k_\\infty^{\\text{none}},\\;k_\\infty^{\\text{micro}},\\;k_\\infty^{\\text{macro}},\\;k_\\infty^{\\text{both}},\\;\\Delta R_{a,2}^{\\text{micro}},\\;\\Delta R_{a,2}^{\\text{macro}},\\;P_k,\\;P_R\\;].\n$$\n- The entire output should be printed exactly as a comma-separated list of these sublists enclosed in square brackets, for example: $[[\\dots],[\\dots],[\\dots],[\\dots]]$.\n\nImplementation constraints:\n- The final answer must be a complete, runnable program.\n- Language: Python, version $3.12$.\n- Libraries: NumPy (version $1.23.5$) and SciPy (version $1.11.4$) are available, but use only the Python standard library and NumPy for this task.\n- No user input or external files are permitted.",
            "solution": "## Problem Validation\n\n### Step 1: Extract Givens\n\n**Governing Equations:**\n- The two-group neutron balance is represented by the generalized eigenvalue problem $A^{-1} F \\, \\Phi = k_\\infty \\, \\Phi$, where $\\Phi = \\begin{bmatrix}\\phi_1 \\\\ \\phi_2\\end{bmatrix}$.\n- The removal operator matrix $A$ is:\n$$\nA = \\begin{bmatrix}\n\\Sigma_{r,1}  0 \\\\\n-\\Sigma_{s,1\\to 2}  \\Sigma_{a,2}^{\\text{eff}}\n\\end{bmatrix}\n$$\n- The fission production operator matrix $F$ is:\n$$\nF = \\begin{bmatrix}\n\\chi_1 \\nu \\Sigma_{f,1}  \\chi_1 \\nu \\Sigma_{f,2} \\\\\n\\chi_2 \\nu \\Sigma_{f,1}  \\chi_2 \\nu \\Sigma_{f,2}\n\\end{bmatrix}\n$$\n- The group $1$ removal cross section is $\\Sigma_{r,1} = \\Sigma_{a,1} + \\Sigma_{s,1\\to 2}$.\n- The group $2$ absorption reaction rate is $R_{a,2} = \\Sigma_{a,2}^{\\text{eff}} \\, \\phi_2$.\n- The flux normalization is $\\phi_1 + \\phi_2 = 1$.\n\n**Self-Shielding Model for $\\Sigma_{a,2}^{\\text{eff}}$:**\n- The effective group $2$ absorption cross section is given by the physically corrected formula:\n$$\n\\Sigma_{a,2}^{\\text{eff}} = \\frac{\\Sigma_{a,2}^{\\text{base}}}{1 + \\alpha_0 \\, \\tau_g \\, T_{\\text{micro}} + \\beta_0 \\, \\left(\\frac{1}{\\Sigma_{t,\\text{mod}} \\, s}\\right) \\, C \\, T_{\\text{macro}}}\n$$\n- The optical thickness of fuel grains is $\\tau_g = \\Sigma_{t,\\text{fuel}} \\, r_g$.\n- Toggles for corrections are $T_{\\text{micro}}, T_{\\text{macro}} \\in \\{0,1\\}$.\n\n**Numerical Data:**\n- $\\nu = 2.43$\n- $\\chi_1 = 0.95$, $\\chi_2 = 0.05$\n- $\\Sigma_{f,1} = 0.001$ $\\text{cm}^{-1}$\n- $\\Sigma_{f,2} = 0.06$ $\\text{cm}^{-1}$\n- $\\Sigma_{a,1} = 0.005$ $\\text{cm}^{-1}$\n- $\\Sigma_{s,1\\to 2} = 0.08$ $\\text{cm}^{-1}$\n- $\\Sigma_{a,2}^{\\text{base}} = 0.12$ $\\text{cm}^{-1}$\n- $\\Sigma_{t,\\text{fuel}} = 0.6$ $\\text{cm}^{-1}$\n- $\\Sigma_{t,\\text{mod}} = 0.2$ $\\text{cm}^{-1}$\n- $\\alpha_0 = 0.8$\n- $\\beta_0 = 0.2$\n\n**Toggling Scenarios:**\n- None: $T_{\\text{micro}} = 0$, $T_{\\text{macro}} = 0$\n- Micro only: $T_{\\text{micro}} = 1$, $T_{\\text{macro}} = 0$\n- Macro only: $T_{\\text{micro}} = 0$, $T_{\\text{macro}} = 1$\n- Both: $T_{\\text{micro}} = 1$, $T_{\\text{macro}} = 1$\n\n**Test Suite:**\n1.  $r_g = 0.05$ cm, $C = 0.5$, $s = 1.0$ cm.\n2.  $r_g = 0.001$ cm, $C = 0.4$, $s = 2.0$ cm.\n3.  $r_g = 0.05$ cm, $C = 0.0$, $s = 0.5$ cm.\n4.  $r_g = 0.2$ cm, $C = 0.95$, $s = 5.0$ cm.\n\n**Required Outputs per Test Case:**\n- Four values of $k_\\infty$: $[k_\\infty^{\\text{none}}, k_\\infty^{\\text{micro}}, k_\\infty^{\\text{macro}}, k_\\infty^{\\text{both}}]$.\n- Two reaction rate changes: $\\Delta R_{a,2}^{\\text{micro}} = R_{a,2}^{\\text{micro}} - R_{a,2}^{\\text{none}}$ and $\\Delta R_{a,2}^{\\text{macro}} = R_{a,2}^{\\text{macro}} - R_{a,2}^{\\text{none}}$.\n- Two priority flags:\n  - $P_k = 0$ if $|k_\\infty^{\\text{macro}} - k_\\infty^{\\text{none}}|  |k_\\infty^{\\text{micro}} - k_\\infty^{\\text{none}}|$, else $P_k = 1$.\n  - $P_R = 0$ if $|\\Delta R_{a,2}^{\\text{macro}}|  |\\Delta R_{a,2}^{\\text{micro}}|$, else $P_R = 1$.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is assessed against the validation criteria.\n\n1.  **Scientifically Grounded**: The problem is well-grounded in nuclear reactor physics. The two-group diffusion model is a standard method. The formulation of $k_\\infty$ as the dominant eigenvalue of $A^{-1}F$ is correct. The model for $\\Sigma_{a,2}^{\\text{eff}}$ is a phenomenological representation of resonance self-shielding. The original model contained a physical inconsistency regarding the effect of the Dancoff factor $C$; this has been corrected by replacing the term $(1-C)$ with $C$. With this correction, the model is physically plausible: increasing grain size ($r_g$) or Dancoff factor ($C$) now correctly increases the self-shielding effect (larger denominator), leading to a lower effective absorption cross section.\n2.  **Well-Posed**: The problem is mathematically well-posed. It requires solving a $2 \\times 2$ matrix eigenvalue problem. All parameters are provided. The procedure for calculating all required outputs is explicitly defined. A dominant, positive, real eigenvalue ($k_\\infty$) is expected.\n3.  **Objective**: The problem is stated in an entirely objective and quantitative manner.\n4.  **Complete and Consistent**: The problem is self-contained. All necessary data, equations, and conditions are provided.\n5.  **Not Trivial or Pseudo-Profound**: The problem requires a non-trivial sequence of calculations and correctly isolates a key conceptual trade-off in reactor modeling.\n\n### Step 3: Verdict and Action\n\nThe problem, with the noted correction to its physical model, is valid. It is a well-posed, scientifically sound, and computationally concrete problem. A full solution implementing the corrected model is provided.\n\n## Solution\n\nThe solution proceeds by implementing the corrected physical model for each test case and for each of the four specified toggling scenarios. The core of the problem is the computation of the infinite-medium multiplication factor $k_\\infty$ and the corresponding neutron flux distribution $\\Phi$.\n\n**Step 1: Evaluation of the Effective Group $2$ Absorption Cross Section**\n\nFor each test case $(r_g, C, s)$ and toggling scenario $(T_{\\text{micro}}, T_{\\text{macro}})$, we compute $\\Sigma_{a,2}^{\\text{eff}}$ using the corrected formula:\n$$\n\\Sigma_{a,2}^{\\text{eff}} = \\frac{\\Sigma_{a,2}^{\\text{base}}}{1 + \\alpha_0 \\, (\\Sigma_{t,\\text{fuel}} \\, r_g) \\, T_{\\text{micro}} + \\beta_0 \\, \\left(\\frac{1}{\\Sigma_{t,\\text{mod}} \\, s}\\right) \\, C \\, T_{\\text{macro}}}\n$$\nThis formula now correctly models that self-shielding increases (denominator increases, $\\Sigma_{a,2}^{\\text{eff}}$ decreases) with both micro-scale optical thickness and macro-scale shadowing.\n\n**Step 2: Construction of the System Matrices**\n\nThe constant group 1 removal cross section is $\\Sigma_{r,1} = 0.085 \\, \\text{cm}^{-1}$. The removal matrix $A$ is constructed using the scenario-dependent $\\Sigma_{a,2}^{\\text{eff}}$. The fission matrix $F$ is constant.\n\n**Step 3: Solving the Eigenvalue Problem**\n\nThe infinite-medium multiplication factor $k_\\infty$ is the dominant (largest positive real) eigenvalue of the iteration matrix $M = A^{-1}F$. We solve the eigenvalue problem $M \\Phi = \\lambda \\Phi$.\n\n**Step 4: Flux Normalization**\n\nThe resulting eigenvector $\\Phi_{raw}$ is normalized such that the sum of its components is 1, yielding the normalized flux vector $\\Phi = [\\phi_1, \\phi_2]^T$.\n\n**Step 5: Calculation of Reaction Rate**\n\nThe group $2$ absorption reaction rate $R_{a,2}$ is calculated using the normalized thermal flux $\\phi_2$ and the effective cross section $\\Sigma_{a,2}^{\\text{eff}}$.\n\n**Step 6: Computation of Final Output Quantities**\n\nAfter computing $k_\\infty$ and $R_{a,2}$ for all four scenarios, the final output quantities (the list of four $k_\\infty$ values, the two $\\Delta R_{a,2}$ values, and the two priority flags $P_k, P_R$) are assembled as per the problem specification. This process is repeated for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the double heterogeneity problem for the given test cases.\n    \"\"\"\n\n    # Define fixed material and spectrum parameters.\n    nu = 2.43\n    chi1, chi2 = 0.95, 0.05\n    Sigma_f1, Sigma_f2 = 0.001, 0.06\n    Sigma_a1 = 0.005\n    Sigma_s12 = 0.08\n    Sigma_a2_base = 0.12\n    Sigma_t_fuel = 0.6\n    Sigma_t_mod = 0.2\n    alpha0 = 0.8\n    beta0 = 0.2\n\n    # Construct the constant fission production matrix F.\n    F = np.array([\n        [chi1 * nu * Sigma_f1, chi1 * nu * Sigma_f2],\n        [chi2 * nu * Sigma_f1, chi2 * nu * Sigma_f2]\n    ])\n\n    # Define the test cases.\n    test_cases = [\n        (0.05, 0.5, 1.0),   # 1. Happy path\n        (0.001, 0.4, 2.0),  # 2. Micro negligible\n        (0.05, 0.0, 0.5),   # 3. Macro dominant (but C=0, so macro effect is zero)\n        (0.2, 0.95, 5.0)    # 4. Macro negligible, micro dominant\n    ]\n    \n    # Define toggling scenarios: (T_micro, T_macro)\n    scenarios = {\n        \"none\": (0, 0),\n        \"micro\": (1, 0),\n        \"macro\": (0, 1),\n        \"both\": (1, 1)\n    }\n\n    all_results = []\n\n    def calculate_physics(case_params, toggles):\n        \"\"\"\n        Calculates k_inf and R_a2 for a given case and scenario.\n        \"\"\"\n        r_g, C, s = case_params\n        T_micro, T_macro = toggles\n\n        # Step 1: Calculate effective group 2 absorption cross section.\n        tau_g = Sigma_t_fuel * r_g\n        micro_term = alpha0 * tau_g * T_micro\n        # CORRECTED FORMULA: The macro correction term is now proportional to C, not (1-C).\n        # This ensures that increased shadowing (larger C) increases self-shielding.\n        macro_term = beta0 * (1 / (Sigma_t_mod * s)) * C * T_macro\n        Sigma_a2_eff = Sigma_a2_base / (1 + micro_term + macro_term)\n\n        # Step 2: Construct the removal matrix A.\n        Sigma_r1 = Sigma_a1 + Sigma_s12\n        A = np.array([\n            [Sigma_r1, 0],\n            [-Sigma_s12, Sigma_a2_eff]\n        ])\n\n        # Step 3: Solve the eigenvalue problem.\n        # M * Phi = k_inf * Phi, where M = inv(A) * F.\n        if np.linalg.det(A) == 0:\n            return np.nan, np.nan\n        \n        M = np.linalg.inv(A) @ F\n        eigenvalues, eigenvectors = np.linalg.eig(M)\n\n        # Find the dominant eigenvalue (k_inf) and its corresponding eigenvector.\n        # k_inf is the largest positive real eigenvalue.\n        dominant_idx = np.argmax(eigenvalues.real)\n        k_inf = eigenvalues[dominant_idx].real\n        flux_vector = eigenvectors[:, dominant_idx].real\n\n        # Step 4: Normalize the flux vector.\n        # Physical flux must be positive, so we use absolute values for robustness.\n        normalized_flux = flux_vector / np.sum(np.abs(flux_vector))\n        phi1, phi2 = normalized_flux\n        \n        # Enforce positive fluxes convention.\n        if phi2  0:\n            phi2 = -phi2\n\n        # Step 5: Calculate the reaction rate.\n        R_a2 = Sigma_a2_eff * phi2\n\n        return k_inf, R_a2\n\n    for case in test_cases:\n        results = {}\n        # Calculate k_inf and R_a2 for each of the four scenarios.\n        for name, toggles in scenarios.items():\n            k_inf, R_a2 = calculate_physics(case, toggles)\n            results[name] = {\"k_inf\": k_inf, \"R_a2\": R_a2}\n        \n        # Step 6: Compute final output quantities.\n        k_none = results[\"none\"][\"k_inf\"]\n        k_micro = results[\"micro\"][\"k_inf\"]\n        k_macro = results[\"macro\"][\"k_inf\"]\n        k_both = results[\"both\"][\"k_inf\"]\n\n        R_none = results[\"none\"][\"R_a2\"]\n        R_micro = results[\"micro\"][\"R_a2\"]\n        R_macro = results[\"macro\"][\"R_a2\"]\n\n        delta_R_micro = R_micro - R_none\n        delta_R_macro = R_macro - R_none\n        \n        # Determine priority flags.\n        # Pk = 0 if macro > micro, else 1\n        # PR = 0 if macro > micro, else 1\n        delta_k_micro_abs = abs(k_micro - k_none)\n        delta_k_macro_abs = abs(k_macro - k_none)\n        P_k = 0 if delta_k_macro_abs > delta_k_micro_abs else 1\n\n        delta_R_micro_abs = abs(delta_R_micro)\n        delta_R_macro_abs = abs(delta_R_macro)\n        P_R = 0 if delta_R_macro_abs > delta_R_micro_abs else 1\n        \n        # Assemble the results for the current test case.\n        case_results = [\n            k_none, k_micro, k_macro, k_both,\n            delta_R_micro, delta_R_macro,\n            P_k, P_R\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string.\n    # The map(str, ...) converts each inner list to its string representation.\n    # The join then combines these strings with commas.\n    output_str = f\"[{','.join(map(str, all_results))}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}