{
    "hands_on_practices": [
        {
            "introduction": "The inhour equation provides a direct mapping from the reactor period $T$ to the corresponding reactivity $\\rho$. However, in predictive analysis and simulation, the inverse problem is equally important: determining the stable period that will result from a planned reactivity insertion. This practice challenges you to develop a robust numerical procedure to invert this fundamental relationship. Mastering this task strengthens your computational skills in solving the implicit, non-linear equations common in reactor physics and deepens your understanding of the inhour equation's mathematical structure, including its singularities and physically relevant solution branches. ",
            "id": "4240819",
            "problem": "You are given scientifically plausible delayed neutron data and a prompt neutron generation time for a homogeneous point reactor model. The task is to build a numerical procedure that, assuming constant reactivity, reliably inverts the period–reactivity relationship to obtain the reactor period $T$ as a function of specified reactivity $\\rho$ near criticality. The starting point is the point kinetics equations for neutron population $n(t)$ and delayed neutron precursor concentrations $C_i(t)$, together with the definition of reactor period and standard delayed neutron group data. You must not use any closed-form inversion; instead, construct an algorithm that solves the implicit mapping from $T$ to $\\rho$ by robust numerical root finding.\n\nFundamental base to use:\n- Point kinetics equations with constant reactivity and no external source:\n  - $\\dfrac{d n(t)}{d t} = \\dfrac{\\rho - \\beta}{\\Lambda} n(t) + \\sum_{i=1}^m \\lambda_i C_i(t)$\n  - $\\dfrac{d C_i(t)}{d t} = \\dfrac{\\beta_i}{\\Lambda} n(t) - \\lambda_i C_i(t)$\n- Assume exponential behavior of the neutron population $n(t) \\propto e^{\\omega t}$ defining growth rate $\\omega$ and reactor period $T$ via $\\omega = 1/T$.\n\nYour program must:\n1. For a specified set of delayed neutron parameters $\\{\\beta_i,\\lambda_i\\}$, prompt neutron generation time $\\Lambda$, and target reactivity $\\rho$ (expressed as a decimal, not with a percentage sign), construct a function of $T$ representing the residual between the model reactivity and the target $\\rho$, then find the principal reactor period $T$ that solves the residual equation $g(T)=0$.\n2. Select the physically relevant principal branch near criticality: as $\\rho \\to 0^+$, $T \\to +\\infty$; as $\\rho \\to 0^-$, $T \\to -\\infty$. Your solver must avoid singularities at $T = -1/\\lambda_i$ and must bracket the root on a monotonic interval separated from these poles.\n3. Handle the exact critical case $\\rho = 0$ by returning an infinite period.\n4. Express all returned periods in seconds, rounded to six decimal places.\n\nInput data for the test suite:\n- Use units of seconds for $T$ and $\\Lambda$, and seconds$^{-1}$ for $\\lambda_i$. Reactivity $\\rho$ is dimensionless in decimal form.\n- Test Suite A (six-group uranium-235 thermal data representative of Keepin-type values), with $\\Lambda = 1\\times 10^{-5}\\ \\mathrm{s}$:\n  - $\\beta$ values: $\\{0.000215, 0.001424, 0.001274, 0.002568, 0.000748, 0.000273\\}$\n  - $\\lambda$ values: $\\{0.0124, 0.0305, 0.111, 0.301, 0.911, 2.98\\}$\n  - Target reactivities $\\rho$: $\\{0, 0.0005, -0.0005, 0.002\\}$\n- Test Suite B (same six-group data but different prompt generation time), with $\\Lambda = 5\\times 10^{-5}\\ \\mathrm{s}$:\n  - $\\beta$ values: $\\{0.000215, 0.001424, 0.001274, 0.002568, 0.000748, 0.000273\\}$\n  - $\\lambda$ values: $\\{0.0124, 0.0305, 0.111, 0.301, 0.911, 2.98\\}$\n  - Target reactivity $\\rho$: $\\{0.0005\\}$\n- Test Suite C (two-group aggregated data), with $\\Lambda = 1.5\\times 10^{-5}\\ \\mathrm{s}$:\n  - $\\beta$ values: $\\{0.0015, 0.0050\\}$\n  - $\\lambda$ values: $\\{0.08, 0.30\\}$\n  - Target reactivity $\\rho$: $\\{-0.0001\\}$\n\nAlgorithmic constraints:\n- Implement a bracketing-based root-finding method that is guaranteed to converge on the principal branch for the given $\\rho$ near criticality. Suggest using a safeguarded bisection on a bracket where the residual changes sign and the function is monotonic.\n- Explicitly avoid the singularities at $T = -1/\\lambda_i$ by constructing brackets that lie entirely within monotonic intervals: $(0,+\\infty)$ for $\\rho>0$ and $(-\\infty, -1/\\lambda_{\\min})$ for $\\rho0$, where $\\lambda_{\\min}$ is the smallest decay constant.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one test case in the order they are listed above and must be a float in seconds rounded to six decimal places. If the period is infinite, print it as the string \"inf\". For example: \"[1.234567,-12.345679,inf]\".\n\nNo user input is required; all parameters are embedded in the program.",
            "solution": "The problem is valid as it is scientifically grounded in the well-established theory of nuclear reactor point kinetics, is mathematically well-posed, and is presented in an objective and unambiguous manner. All necessary data and constraints are provided to formulate and solve the problem numerically.\n\nThe core of the problem lies in the inversion of the period-reactivity relationship, which is derived from the point kinetics equations for a reactor with constant reactivity $\\rho$ and no external source. The governing equations for the neutron population $n(t)$ and the concentration of the $i$-th group of delayed neutron precursors $C_i(t)$ are:\n$$\n\\frac{d n(t)}{d t} = \\frac{\\rho - \\beta}{\\Lambda} n(t) + \\sum_{i=1}^m \\lambda_i C_i(t)\n$$\n$$\n\\frac{d C_i(t)}{d t} = \\frac{\\beta_i}{\\Lambda} n(t) - \\lambda_i C_i(t)\n$$\nHere, $\\Lambda$ is the prompt neutron generation time, $\\beta_i$ is the delayed neutron fraction for group $i$, $\\beta = \\sum_{i=1}^m \\beta_i$ is the total delayed neutron fraction, $\\lambda_i$ is the decay constant for precursor group $i$, and $m$ is the number of delayed neutron groups.\n\nWhen the reactivity $\\rho$ is constant, the neutron population and precursor concentrations exhibit an asymptotic exponential behavior, $n(t) = n_0 e^{\\omega t}$ and $C_i(t) = C_{i0} e^{\\omega t}$, where $\\omega$ is the inverse reactor period, $\\omega = 1/T$. Substituting these forms into the precursor equation yields an algebraic relationship for the asymptotic state:\n$$\n\\omega C_{i0} e^{\\omega t} = \\frac{\\beta_i}{\\Lambda} n_0 e^{\\omega t} - \\lambda_i C_{i0} e^{\\omega t}\n$$\nSolving for $C_{i0}$ gives:\n$$\nC_{i0} = \\frac{\\beta_i n_0}{\\Lambda(\\omega + \\lambda_i)} \\quad \\implies \\quad C_i(t) = \\frac{\\beta_i n(t)}{\\Lambda(\\omega + \\lambda_i)}\n$$\nSubstituting this result along with $\\frac{d n(t)}{d t} = \\omega n(t)$ into the neutron population equation, we obtain:\n$$\n\\omega n(t) = \\frac{\\rho - \\beta}{\\Lambda} n(t) + \\sum_{i=1}^m \\lambda_i \\left( \\frac{\\beta_i n(t)}{\\Lambda(\\omega + \\lambda_i)} \\right)\n$$\nDividing by $n(t)$ and multiplying by $\\Lambda$ gives the well-known inhour equation relating reactivity to the inverse period $\\omega$:\n$$\n\\Lambda \\omega = \\rho - \\beta + \\sum_{i=1}^m \\frac{\\lambda_i \\beta_i}{\\omega + \\lambda_i}\n$$\nRearranging to express $\\rho$ as a function of $\\omega$ yields:\n$$\n\\rho(\\omega) = \\Lambda \\omega + \\sum_{i=1}^m \\beta_i - \\sum_{i=1}^m \\frac{\\lambda_i \\beta_i}{\\omega + \\lambda_i} = \\Lambda \\omega + \\sum_{i=1}^m \\frac{\\omega \\beta_i}{\\omega + \\lambda_i}\n$$\nThe problem is stated in terms of the reactor period $T$, so we substitute $\\omega = 1/T$:\n$$\n\\rho(T) = \\frac{\\Lambda}{T} + \\sum_{i=1}^m \\frac{\\beta_i / T}{1/T + \\lambda_i} = \\frac{\\Lambda}{T} + \\sum_{i=1}^m \\frac{\\beta_i}{1 + \\lambda_i T}\n$$\nOur task is to find the period $T$ that corresponds to a given target reactivity $\\rho_{target}$. This is a root-finding problem for the residual function $g(T)$:\n$$\ng(T) = \\rho(T) - \\rho_{target} = \\left( \\frac{\\Lambda}{T} + \\sum_{i=1}^m \\frac{\\beta_i}{1 + \\lambda_i T} \\right) - \\rho_{target} = 0\n$$\nWe will solve this equation numerically using a robust bracketing method, as required. The choice of the bracket depends on the sign of $\\rho_{target}$. The function $\\rho(T)$ has poles at $T_i = -1/\\lambda_i$ for each delayed neutron group. The principal branch of the solution, which is physically relevant for states near critical, is the one with the largest algebraic value of $T$.\n\nCase 1: Critical Reactor ($\\rho_{target} = 0$)\nWhen the reactivity is zero, the reactor is exactly critical. In the point kinetics model, this corresponds to a stable neutron population, which is equivalent to an infinite period. This can be seen from the equation for $\\rho(T)$, where $\\rho(T) \\to 0$ as $|T| \\to \\infty$. The algorithm will handle this as a special case and return an infinite period.\n\nCase 2: Supercritical Reactor ($\\rho_{target} > 0$)\nFor positive reactivity, the neutron population grows, corresponding to a positive period $T > 0$. In the interval $T \\in (0, \\infty)$, the function $\\rho(T)$ is continuous and monotonically decreases from $\\rho(T) \\to +\\infty$ as $T \\to 0^+$ to $\\rho(T) \\to 0$ as $T \\to +\\infty$. Therefore, for any $\\rho_{target} > 0$, a unique positive root $T$ exists. We can establish a search bracket $[a, b]$ where $a$ is a small positive number (e.g., $10^{-9}\\ \\mathrm{s}$) and $b$ is a large positive number (e.g., $10^9\\ \\mathrm{s}$). For such a bracket, $g(a) = \\rho(a) - \\rho_{target} > 0$ and $g(b) = \\rho(b) - \\rho_{target}  0$, guaranteeing a root within the interval.\n\nCase 3: Subcritical Reactor ($\\rho_{target}  0$)\nFor negative reactivity, the neutron population decays, corresponding to a negative period $T  0$. The principal root for $T$ lies in the interval $(-\\infty, -1/\\lambda_{min})$, where $\\lambda_{min}$ is the smallest of all decay constants $\\lambda_i$. In this interval, $\\rho(T)$ is continuous and monotonically decreases from $\\rho(T) \\to 0$ as $T \\to -\\infty$ to $\\rho(T) \\to -\\infty$ as $T$ approaches the pole at $-1/\\lambda_{min}$ from below. For any $\\rho_{target}  0$, a unique root exists in this interval. A suitable search bracket $[a, b]$ can be constructed where $a$ is a large-magnitude negative number (e.g., $-10^9\\ \\mathrm{s}$) and $b$ is a value slightly smaller than the first pole (e.g., $-1/\\lambda_{min} - 10^{-9}\\ \\mathrm{s}$). For this bracket, $g(a) \\approx -\\rho_{target} > 0$ and $g(b)$ is a large negative value, so $g(b)  0$, which again guarantees a root.\n\nThe implementation will use the `scipy.optimize.brentq` function, a highly efficient and robust bracketing-based root-finder. It combines bisection, secant, and inverse quadratic interpolation methods to find a root, satisfying the problem's algorithmic constraints. The procedure will first determine the appropriate bracket based on the sign of $\\rho_{target}$ and then invoke `brentq` to find the period $T$. Results will be formatted to six decimal places as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the reactor period T given delayed neutron data and reactivity rho.\n    \"\"\"\n\n    # Define the six-group U-235 thermal data\n    betas_6group = np.array([0.000215, 0.001424, 0.001274, 0.002568, 0.000748, 0.000273])\n    lambdas_6group = np.array([0.0124, 0.0305, 0.111, 0.301, 0.911, 2.98])\n\n    # Define the two-group aggregated data\n    betas_2group = np.array([0.0015, 0.0050])\n    lambdas_2group = np.array([0.08, 0.30])\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (Lambda, betas, lambdas, rho)\n    test_cases = [\n        # Test Suite A\n        (1e-5, betas_6group, lambdas_6group, 0.0),\n        (1e-5, betas_6group, lambdas_6group, 0.0005),\n        (1e-5, betas_6group, lambdas_6group, -0.0005),\n        (1e-5, betas_6group, lambdas_6group, 0.0020),\n        # Test Suite B\n        (5e-5, betas_6group, lambdas_6group, 0.0005),\n        # Test Suite C\n        (1.5e-5, betas_2group, lambdas_2group, -0.0001),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Lambda, betas, lambdas, rho_target = case\n\n        # Handle the special case for critical reactivity\n        if rho_target == 0.0:\n            results.append(\"inf\")\n            continue\n\n        # Define the residual function g(T) = rho(T) - rho_target = 0\n        # rho(T) = (Lambda / T) + sum(beta_i / (1 + lambda_i * T))\n        def residual_function(T):\n            if T == 0:\n                # Based on the limit T-0+, rho(T) is positive infinity.\n                # This should only be approached from one side in the root-finder.\n                return np.inf if T > 0 else -np.inf\n            \n            rho_T = (Lambda / T) + np.sum(betas / (1.0 + lambdas * T))\n            return rho_T - rho_target\n\n        try:\n            # Set up the bracket and solve based on the sign of rho_target\n            if rho_target > 0:\n                # For positive reactivity, the period T is positive.\n                # Bracket the root in the interval (0, infinity).\n                # Lower bound a: small positive T, giving large positive rho(T)\n                # Upper bound b: large positive T, giving rho(T) near 0\n                a = 1e-9  # Small positive number\n                b = 1e9   # Large positive number\n                period = brentq(residual_function, a, b, xtol=1e-12, rtol=1e-12)\n\n            else:  # rho_target  0\n                # For negative reactivity, the principal period T is negative.\n                # The root is in (-infinity, -1/lambda_min).\n                lambda_min = np.min(lambdas)\n                pole = -1.0 / lambda_min\n                \n                # Lower bound a: large negative T, giving rho(T) near 0\n                # Upper bound b: a value just below the first pole, giving large negative rho(T)\n                a = -1e9  # Large-magnitude negative number\n                b = pole - 1e-9 # T approaches the pole from the left.\n\n                period = brentq(residual_function, a, b, xtol=1e-12, rtol=1e-12)\n            \n            results.append(f\"{period:.6f}\")\n\n        except ValueError:\n            # This can happen if the bracket is not valid (f(a)*f(b) >= 0)\n            # or if the search interval is non-finite.\n            # This code's bracketing strategy is robust and should not fail.\n            results.append(\"solver_error\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Inferring reactivity from a measured reactor period is a cornerstone of experimental reactor physics, but the reliability of such an inference is limited by the precision of the underlying nuclear data. This exercise guides you through a formal uncertainty propagation for the inhour equation, a crucial step in validating any model-based measurement. By deriving and applying the expression for reactivity variance, you will quantify how uncertainties in parameters like the delayed neutron fractions $\\beta_i$ and prompt neutron generation time $\\Lambda$ affect the final result, highlighting which data are most critical for accurate reactor characterization. ",
            "id": "4240799",
            "problem": "A thermal nuclear reactor operated near criticality is well represented by reactor point kinetics with $m$ delayed neutron groups. The neutron population $n(t)$ and the delayed neutron precursor concentrations $C_i(t)$ evolve according to the neutron balance and precursor production/decay laws. In a calibration experiment, a small, constant positive reactivity is inserted and the reactor settles into an exponential mode with a measured period $T$, so that the neutron population satisfies $n(t) \\propto \\exp(t/T)$.\n\nStarting from the point kinetics framework and the exponential-mode assumption, derive the period–reactivity relationship that links the inferred reactivity $\\rho$ to the measured inverse period $s = 1/T$ and the kinetic parameters $\\{\\beta_i\\}_{i=1}^{m}$, $\\{\\lambda_i\\}_{i=1}^{m}$, and the prompt neutron generation time $\\Lambda$. Then, using first-order total differential (linear) uncertainty propagation under the assumption that $\\{\\beta_i\\}$, $\\{\\lambda_i\\}$, and $\\Lambda$ have mutually independent Gaussian uncertainties, derive a closed-form expression for the variance of the inferred $\\rho$ in terms of partial derivatives and the parameter variances.\n\nEvaluate numerically for the following scientifically realistic data for a six-group ($m=6$) thermal reactor:\n- Measured period: $T = 20\\,\\text{s}$.\n- Prompt neutron generation time: $\\Lambda = 5.0 \\times 10^{-5}\\,\\text{s}$ with one-standard-deviation uncertainty $\\sigma_{\\Lambda} = 1.0 \\times 10^{-5}\\,\\text{s}$.\n- Delayed neutron fractions and decay constants (central values):\n  - $i=1$: $\\beta_1 = 2.50 \\times 10^{-4}$, $\\lambda_1 = 1.24 \\times 10^{-2}\\,\\text{s}^{-1}$.\n  - $i=2$: $\\beta_2 = 1.25 \\times 10^{-3}$, $\\lambda_2 = 3.05 \\times 10^{-2}\\,\\text{s}^{-1}$.\n  - $i=3$: $\\beta_3 = 1.25 \\times 10^{-3}$, $\\lambda_3 = 1.11 \\times 10^{-1}\\,\\text{s}^{-1}$.\n  - $i=4$: $\\beta_4 = 2.50 \\times 10^{-3}$, $\\lambda_4 = 3.01 \\times 10^{-1}\\,\\text{s}^{-1}$.\n  - $i=5$: $\\beta_5 = 7.50 \\times 10^{-4}$, $\\lambda_5 = 1.14\\,\\text{s}^{-1}$.\n  - $i=6$: $\\beta_6 = 2.50 \\times 10^{-4}$, $\\lambda_6 = 3.01\\,\\text{s}^{-1}$.\n- One-standard-deviation uncertainties: $\\sigma_{\\beta_i} = 0.03\\,\\beta_i$ for each $i$, and $\\sigma_{\\lambda_i} = 0.02\\,\\lambda_i$ for each $i$.\n\nCompute the standard uncertainty $\\sigma_{\\rho}$ of the inferred reactivity. Round your final numerical result to three significant figures. Express the final uncertainty in reactivity in per cent mille (pcm), where $1\\,\\text{pcm} = 10^{-5}$ (i.e., reactivity is dimensionless and $1\\,\\text{pcm}$ corresponds to a change of $10^{-5}$). Also, interpret which parameters are the dominant contributors to the variance in $\\rho$ and explain why in terms of sensitivities and magnitudes. Your final reported answer must be only the numerical value of $\\sigma_{\\rho}$ in pcm.",
            "solution": "The user-provided problem is first subjected to a validation procedure.\n\n### Step 1: Extract Givens\n- **Model**: Reactor point kinetics with $m$ delayed neutron groups.\n- **System**: A thermal nuclear reactor operated near criticality.\n- **Process**: A small, constant positive reactivity is inserted.\n- **Observation**: The reactor settles into an exponential mode with a measured period $T$, such that the neutron population is $n(t) \\propto \\exp(t/T)$.\n- **Definitions**: Inverse period $s = 1/T$. Inferred reactivity is $\\rho$. Kinetic parameters are $\\{\\beta_i\\}_{i=1}^{m}$, $\\{\\lambda_i\\}_{i=1}^{m}$, and prompt neutron generation time $\\Lambda$.\n- **Task 1**: Derive the period–reactivity relationship linking $\\rho$ to $s$ and the kinetic parameters.\n- **Task 2**: Derive a closed-form expression for the variance of the inferred $\\rho$, $\\sigma_\\rho^2$, using first-order uncertainty propagation, assuming mutually independent Gaussian uncertainties for $\\{\\beta_i\\}$, $\\{\\lambda_i\\}$, and $\\Lambda$.\n- **Task 3**: Evaluate numerically the standard uncertainty $\\sigma_\\rho$ for the given data.\n- **Task 4**: Interpret the dominant contributors to the variance of $\\rho$.\n- **Numerical Data ($m=6$):**\n  - Measured period: $T = 20\\,\\text{s}$.\n  - Prompt neutron generation time: $\\Lambda = 5.0 \\times 10^{-5}\\,\\text{s}$.\n  - Uncertainty in $\\Lambda$: $\\sigma_{\\Lambda} = 1.0 \\times 10^{-5}\\,\\text{s}$ (one standard deviation).\n  - Delayed neutron fractions and decay constants (central values):\n    - $i=1$: $\\beta_1 = 2.50 \\times 10^{-4}$, $\\lambda_1 = 1.24 \\times 10^{-2}\\,\\text{s}^{-1}$.\n    - $i=2$: $\\beta_2 = 1.25 \\times 10^{-3}$, $\\lambda_2 = 3.05 \\times 10^{-2}\\,\\text{s}^{-1}$.\n    - $i=3$: $\\beta_3 = 1.25 \\times 10^{-3}$, $\\lambda_3 = 1.11 \\times 10^{-1}\\,\\text{s}^{-1}$.\n    - $i=4$: $\\beta_4 = 2.50 \\times 10^{-3}$, $\\lambda_4 = 3.01 \\times 10^{-1}\\,\\text{s}^{-1}$.\n    - $i=5$: $\\beta_5 = 7.50 \\times 10^{-4}$, $\\lambda_5 = 1.14\\,\\text{s}^{-1}$.\n    - $i=6$: $\\beta_6 = 2.50 \\times 10^{-4}$, $\\lambda_6 = 3.01\\,\\text{s}^{-1}$.\n  - Uncertainties in $\\beta_i$ and $\\lambda_i$: $\\sigma_{\\beta_i} = 0.03\\,\\beta_i$ and $\\sigma_{\\lambda_i} = 0.02\\,\\lambda_i$ for each group $i$.\n- **Output requirements**:\n  - Round the final numerical result for $\\sigma_\\rho$ to three significant figures.\n  - Express the final uncertainty in reactivity in per cent mille (pcm), where $1\\,\\text{pcm} = 10^{-5}$.\n  - The final reported answer must be only the numerical value of $\\sigma_\\rho$ in pcm.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is based on the standard point kinetics model of nuclear reactor dynamics, a cornerstone of reactor physics. The provided data for a thermal reactor, including $\\Lambda$ and the six-group delayed neutron parameters for $^{235}$U, are scientifically realistic. The scenario of a period measurement to infer reactivity is a standard experimental technique. The problem is free of pseudoscience or speculation.\n2.  **Well-Posed**: The problem is clearly stated and contains all necessary information to derive the required expressions and compute the numerical result. A unique and stable solution exists.\n3.  **Objective**: The problem is expressed in precise, quantitative, and unbiased language.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, self-contained, and well-posed. No flaws are detected. The solution process may proceed.\n\n### Solution Derivation\nThe problem requires the derivation of the period-reactivity relationship, the formulation of its uncertainty, and a numerical evaluation.\n\n**1. Derivation of the Period–Reactivity Relationship**\n\nThe point kinetics equations for the neutron population $n(t)$ and the concentration of the $i$-th group of delayed neutron precursors $C_i(t)$ are:\n$$\n\\frac{dn(t)}{dt} = \\frac{\\rho - \\beta}{\\Lambda} n(t) + \\sum_{i=1}^{m} \\lambda_i C_i(t)\n$$\n$$\n\\frac{dC_i(t)}{dt} = \\frac{\\beta_i}{\\Lambda} n(t) - \\lambda_i C_i(t), \\quad i = 1, \\dots, m\n$$\nwhere $\\beta = \\sum_{i=1}^{m} \\beta_i$ is the total delayed neutron fraction.\n\nThe problem states that the reactor is on a stable exponential period $T$, so the neutron population and precursor concentrations have the form:\n$$\nn(t) = n_0 \\exp(st), \\quad C_i(t) = C_{i0} \\exp(st)\n$$\nwhere $s = 1/T$ is the inverse period. The time derivatives are $\\frac{dn}{dt} = sn(t)$ and $\\frac{dC_i}{dt} = sC_i(t)$.\n\nSubstituting these forms into the precursor equation yields:\n$$\nsC_i(t) = \\frac{\\beta_i}{\\Lambda} n(t) - \\lambda_i C_i(t)\n$$\n$$\n(s + \\lambda_i) C_i(t) = \\frac{\\beta_i}{\\Lambda} n(t) \\implies C_i(t) = \\frac{\\beta_i}{\\Lambda(s + \\lambda_i)} n(t)\n$$\nNext, substitute the derivative $\\frac{dn}{dt}$ and the expression for $C_i(t)$ into the neutron balance equation:\n$$\nsn(t) = \\frac{\\rho - \\beta}{\\Lambda} n(t) + \\sum_{i=1}^{m} \\lambda_i \\left( \\frac{\\beta_i}{\\Lambda(s + \\lambda_i)} n(t) \\right)\n$$\nDividing by $n(t)$ (which is non-zero) and multiplying by $\\Lambda$:\n$$\ns\\Lambda = \\rho - \\beta + \\sum_{i=1}^{m} \\frac{\\lambda_i \\beta_i}{s + \\lambda_i}\n$$\nSolving for the reactivity $\\rho$:\n$$\n\\rho = s\\Lambda + \\beta - \\sum_{i=1}^{m} \\frac{\\lambda_i \\beta_i}{s + \\lambda_i}\n$$\nSubstituting $\\beta = \\sum_{i=1}^{m} \\beta_i$ and combining the sums:\n$$\n\\rho = s\\Lambda + \\sum_{i=1}^{m} \\left( \\beta_i - \\frac{\\lambda_i \\beta_i}{s + \\lambda_i} \\right) = s\\Lambda + \\sum_{i=1}^{m} \\beta_i \\left( \\frac{s + \\lambda_i - \\lambda_i}{s + \\lambda_i} \\right)\n$$\nThis simplifies to the standard in-hour equation, which is the required period-reactivity relationship:\n$$\n\\rho(s, \\Lambda, \\{\\beta_i\\}, \\{\\lambda_i\\}) = s\\Lambda + \\sum_{i=1}^{m} \\frac{s \\beta_i}{s + \\lambda_i}\n$$\n\n**2. Derivation of the Reactivity Variance**\n\nThe reactivity $\\rho$ is a function of the parameters $\\Lambda$, $\\{\\beta_i\\}_{i=1}^m$, and $\\{\\lambda_i\\}_{i=1}^m$. The measurement of the period $T$ provides a fixed value for $s=1/T$. The problem states that the uncertainties in the kinetic parameters are mutually independent. Under this assumption, the variance of $\\rho$, denoted $\\sigma_\\rho^2$, can be calculated using the first-order linear uncertainty propagation formula:\n$$\n\\sigma_\\rho^2 = \\left(\\frac{\\partial \\rho}{\\partial \\Lambda}\\right)^2 \\sigma_\\Lambda^2 + \\sum_{i=1}^{m} \\left(\\frac{\\partial \\rho}{\\partial \\beta_i}\\right)^2 \\sigma_{\\beta_i}^2 + \\sum_{i=1}^{m} \\left(\\frac{\\partial \\rho}{\\partial \\lambda_i}\\right)^2 \\sigma_{\\lambda_i}^2\n$$\nThe required partial derivatives (sensitivities) are:\n-   With respect to $\\Lambda$:\n    $$\n    \\frac{\\partial \\rho}{\\partial \\Lambda} = s\n    $$\n-   With respect to $\\beta_i$ for a specific group $i$:\n    $$\n    \\frac{\\partial \\rho}{\\partial \\beta_i} = \\frac{s}{s + \\lambda_i}\n    $$\n-   With respect to $\\lambda_i$ for a specific group $i$:\n    $$\n    \\frac{\\partial \\rho}{\\partial \\lambda_i} = \\frac{\\partial}{\\partial \\lambda_i} \\left( \\frac{s \\beta_i}{s + \\lambda_i} \\right) = s \\beta_i (-1)(s + \\lambda_i)^{-2} = -\\frac{s \\beta_i}{(s + \\lambda_i)^2}\n    $$\nSubstituting these derivatives into the variance formula gives the closed-form expression:\n$$\n\\sigma_\\rho^2 = s^2 \\sigma_\\Lambda^2 + \\sum_{i=1}^{m} \\left(\\frac{s}{s + \\lambda_i}\\right)^2 \\sigma_{\\beta_i}^2 + \\sum_{i=1}^{m} \\left(-\\frac{s \\beta_i}{(s + \\lambda_i)^2}\\right)^2 \\sigma_{\\lambda_i}^2\n$$\n$$\n\\sigma_\\rho^2 = s^2 \\sigma_\\Lambda^2 + s^2 \\sum_{i=1}^{m} \\frac{\\sigma_{\\beta_i}^2}{(s + \\lambda_i)^2} + s^2 \\sum_{i=1}^{m} \\frac{\\beta_i^2 \\sigma_{\\lambda_i}^2}{(s + \\lambda_i)^4}\n$$\n\n**3. Numerical Evaluation**\n\nThe problem provides $T = 20\\,\\text{s}$, so the inverse period is $s = 1/20\\,\\text{s}^{-1} = 0.05\\,\\text{s}^{-1}$. The uncertainties are given as $\\sigma_\\Lambda = 1.0 \\times 10^{-5}\\,\\text{s}$, $\\sigma_{\\beta_i} = 0.03\\,\\beta_i$, and $\\sigma_{\\lambda_i} = 0.02\\,\\lambda_i$. The number of groups is $m=6$.\n\nThe three terms contributing to the variance $\\sigma_\\rho^2$ are calculated separately.\n\n-   **Contribution from $\\Lambda$ uncertainty ($V_\\Lambda$)**:\n    $$\n    V_\\Lambda = s^2 \\sigma_\\Lambda^2 = (0.05\\,\\text{s}^{-1})^2 (1.0 \\times 10^{-5}\\,\\text{s})^2 = (2.5 \\times 10^{-3}\\,\\text{s}^{-2})(1.0 \\times 10^{-10}\\,\\text{s}^2) = 2.5 \\times 10^{-13}\n    $$\n-   **Contribution from $\\{\\beta_i\\}$ uncertainties ($V_\\beta$)**:\n    $$\n    V_\\beta = s^2 \\sum_{i=1}^{6} \\frac{(0.03 \\beta_i)^2}{(s + \\lambda_i)^2} = s^2 (0.03)^2 \\sum_{i=1}^{6} \\left(\\frac{\\beta_i}{s + \\lambda_i}\\right)^2\n    $$\n    The term $(\\frac{\\beta_i}{s+\\lambda_i})^2$ for each group is:\n    $i=1: 1.6051 \\times 10^{-5}$, $i=2: 2.4112 \\times 10^{-4}$, $i=3: 6.0279 \\times 10^{-5}$, $i=4: 5.0729 \\times 10^{-5}$, $i=5: 3.9722 \\times 10^{-7}$, $i=6: 6.6747 \\times 10^{-9}$.\n    The sum is $\\sum_{i=1}^{6} (\\dots) \\approx 3.6858 \\times 10^{-4}$.\n    $$\n    V_\\beta = (0.05)^2 (0.03)^2 (3.6858 \\times 10^{-4}) = (2.5 \\times 10^{-3})(9 \\times 10^{-4})(3.6858 \\times 10^{-4}) \\approx 8.293 \\times 10^{-10}\n    $$\n-   **Contribution from $\\{\\lambda_i\\}$ uncertainties ($V_\\lambda$)**:\n    $$\n    V_\\lambda = s^2 \\sum_{i=1}^{6} \\frac{\\beta_i^2 (0.02 \\lambda_i)^2}{(s + \\lambda_i)^4} = s^2 (0.02)^2 \\sum_{i=1}^{6} \\left(\\frac{\\beta_i \\lambda_i}{(s + \\lambda_i)^2}\\right)^2\n    $$\n    The term $(\\frac{\\beta_i \\lambda_i}{(s+\\lambda_i)^2})^2$ for each group is:\n    $i=1: 6.3384 \\times 10^{-7}$, $i=2: 3.4613 \\times 10^{-5}$, $i=3: 2.8652 \\times 10^{-5}$, $i=4: 3.7306 \\times 10^{-5}$, $i=5: 3.6454 \\times 10^{-7}$, $i=6: 6.4587 \\times 10^{-9}$.\n    The sum is $\\sum_{i=1}^{6} (\\dots) \\approx 1.0158 \\times 10^{-4}$.\n    $$\n    V_\\lambda = (0.05)^2 (0.02)^2 (1.0158 \\times 10^{-4}) = (2.5 \\times 10^{-3})(4 \\times 10^{-4})(1.0158 \\times 10^{-4}) \\approx 1.016 \\times 10^{-10}\n    $$\n-   **Total Variance and Standard Uncertainty**:\n    The total variance is the sum of the individual contributions:\n    $$\n    \\sigma_\\rho^2 = V_\\Lambda + V_\\beta + V_\\lambda = (2.5 \\times 10^{-13}) + (8.293 \\times 10^{-10}) + (1.016 \\times 10^{-10}) \\approx 9.3115 \\times 10^{-10}\n    $$\n    The standard uncertainty is the square root of the variance:\n    $$\n    \\sigma_\\rho = \\sqrt{9.3115 \\times 10^{-10}} \\approx 3.0515 \\times 10^{-5}\n    $$\nThe problem specifies the result in units of per cent mille (pcm), where $1\\,\\text{pcm} = 10^{-5}$.\n$$\n\\sigma_\\rho \\approx 3.0515 \\,\\text{pcm}\n$$\nRounding to three significant figures, the standard uncertainty is $3.05\\,\\text{pcm}$.\n\n**4. Interpretation of Dominant Uncertainty Contributors**\n\nTo understand which parameters dominate the uncertainty in the inferred reactivity $\\rho$, we compare the magnitudes of their contributions to the total variance $\\sigma_\\rho^2 \\approx 9.31 \\times 10^{-10}$:\n-   Contribution from $\\Lambda$: $V_\\Lambda = 2.5 \\times 10^{-13}$ ($\\approx 0.03\\%$).\n-   Contribution from $\\{\\beta_i\\}$: $V_\\beta = 8.29 \\times 10^{-10}$ ($\\approx 89.0\\%$).\n-   Contribution from $\\{\\lambda_i\\}$: $V_\\lambda = 1.02 \\times 10^{-10}$ ($\\approx 10.9\\%$).\n\nThe analysis clearly shows that the uncertainty in the inferred reactivity $\\rho$ is overwhelmingly dominated by the uncertainties in the delayed neutron fractions, $\\{\\beta_i\\}$. The uncertainties in the decay constants, $\\{\\lambda_i\\}$, contribute significantly less, and the contribution from the prompt neutron generation time, $\\Lambda$, is negligible. The reasons are rooted in the sensitivities and magnitudes of the terms in the in-hour equation for the given long period ($T=20\\,\\text{s}$).\n\n1.  **Dominance of $\\beta_i$ Uncertainties**: For a long period, $s = 0.05\\,\\text{s}^{-1}$ is small. The reactivity is dominated by the delayed neutron term, $\\rho \\approx \\sum_i \\frac{s \\beta_i}{s + \\lambda_i}$. This term is linearly proportional to $\\beta_i$. The sensitivity, $\\frac{\\partial\\rho}{\\partial\\beta_i} = \\frac{s}{s+\\lambda_i}$, is of order unity for the longer-lived precursor groups (small $\\lambda_i$). Consequently, the $3\\%$ relative uncertainty in $\\beta_i$ propagates almost directly to a significant uncertainty in $\\rho$.\n\n2.  **Lesser Impact of $\\lambda_i$ Uncertainties**: The sensitivity of $\\rho$ to $\\lambda_i$ is $\\frac{\\partial\\rho}{\\partial\\lambda_i} = -\\frac{s \\beta_i}{(s+\\lambda_i)^2}$. Compared to the sensitivity to $\\beta_i$, this contains an additional factor of $-\\frac{\\lambda_i}{s+\\lambda_i}$. Since this factor's magnitude is always less than $1$, the sensitivity to $\\lambda_i$ is inherently smaller than to $\\beta_i$. This physical suppression of sensitivity, combined with a slightly smaller relative uncertainty ($2\\%$ for $\\lambda_i$ vs. $3\\%$ for $\\beta_i$), results in a much smaller contribution to the total variance.\n\n3.  **Negligible Impact of $\\Lambda$ Uncertainty**: The contribution of the prompt neutron lifetime is through the term $s\\Lambda$. For a long period, $s$ is small, making the prompt term $s\\Lambda = (0.05)(5 \\times 10^{-5}) = 2.5 \\times 10^{-6}$ a tiny fraction of the total reactivity $\\rho \\approx 1.76 \\times 10^{-3}$. The sensitivity $\\frac{\\partial\\rho}{\\partial\\Lambda} = s$ is small, and thus even a large relative uncertainty in $\\Lambda$ ($20\\%$ in this case) translates into a minuscule absolute uncertainty in $\\rho$.\n\nIn summary, for reactivity measurements based on long reactor periods, the accuracy is primarily limited by the accuracy of the nuclear data for delayed neutron fractions.",
            "answer": "$$\n\\boxed{3.05}\n$$"
        },
        {
            "introduction": "Beyond analyzing existing data, an expert reactor physicist must be able to design experiments that are both effective and precise. This advanced practice asks you to synthesize your knowledge of reactor kinetics and uncertainty analysis to simulate and optimize a control rod calibration procedure. You will construct a simulation to predict the reactor period for various reactivity steps and, most importantly, identify the optimal step size that minimizes the uncertainty in the inferred rod worth. This exercise bridges the gap between theoretical calculation and practical experimental design, a vital skill in advanced nuclear engineering. ",
            "id": "4240828",
            "problem": "A reactor physics laboratory plans a control rod calibration sequence in which the rod will be moved in discrete steps of physical distance to produce corresponding changes in reactivity. The goal is to predict the reactor period for each candidate rod step using a first-principles point kinetics model and to choose an optimal step size that minimizes the absolute uncertainty in the inferred reactivity from period measurements. Your task is to write a complete, runnable program that implements this simulation, grounded in the physics of the point kinetics equations and delayed neutron groups. All mathematical entities must be written in LaTeX.\n\nThe fundamental base for this problem is the point kinetics model with delayed neutron precursors. The neutron population dynamics are described by the linear ordinary differential equations for the neutron population and the precursor concentrations. These equations, together with the assumption of exponential solutions, lead to a relationship between reactivity and the reactor period without giving the explicit form in this statement. You must start from the point kinetics definitions and derive the necessary relationships in your solution.\n\nYou will implement the following simulation logic using scientifically sound assumptions:\n\n- Model the reactor with multiple delayed neutron groups. For each group, parameters are given: the effective delayed neutron fraction for group $i$, denoted $\\beta_i$, and the precursor decay constant $\\lambda_i$ with units of $\\mathrm{s}^{-1}$. Let the total delayed neutron fraction be $\\beta = \\sum_i \\beta_i$ and the prompt neutron generation time be $\\Lambda$ in $\\mathrm{s}$.\n- When the control rod is moved by a distance $\\Delta x$ in $\\mathrm{cm}$, the reactivity increases by $\\rho = w \\Delta x$, where $w$ is a constant rod worth slope in units of decimal fraction per centimeter. All reactivities must be treated as decimal fractions (i.e., not written with a percent sign).\n- For a given positive reactivity $\\rho$ less than $\\beta$, the reactor achieves a positive growth rate $s$ in $\\mathrm{s}^{-1}$, and the reactor period $\\tau$ in $\\mathrm{s}$ satisfies $\\tau = 1/s$. The relationship between $\\rho$ and $s$ that arises from the point kinetics equations must be solved numerically for $s$.\n- A measurement model is used in which the observed inverse period $1/\\tau$ is estimated from a linear fit to $\\ln P(t)$ over a measurement window of duration $T_m$ in $\\mathrm{s}$. Let the initial count rate at the beginning of the measurement be $C_0$ in counts per second. The total counts observed during the window, assuming exponential growth, are modeled as\n$$\nN = \\int_0^{T_m} C_0 e^{t/\\tau} dt = C_0 \\tau \\left(e^{T_m/\\tau} - 1\\right).\n$$\nAssume that the standard deviation of the measured inverse period is\n$$\n\\sigma_{(1/\\tau)} = \\frac{\\gamma}{\\sqrt{N}},\n$$\nwhere $\\gamma$ is a dimensionless noise parameter that encapsulates the estimator and instrument characteristics.\n- The uncertainty in the inferred reactivity $\\rho$ due to the measurement uncertainty in $s = 1/\\tau$ must be obtained by first principles uncertainty propagation using the sensitivity $\\frac{d\\rho}{ds}$ that follows from the $\\rho-s$ relationship implied by the point kinetics equations. The absolute standard deviation in $\\rho$ is\n$$\n\\sigma_\\rho = \\left| \\frac{d\\rho}{ds} \\right| \\sigma_s,\n$$\nwith $\\sigma_s = \\sigma_{(1/\\tau)}$.\n- For a given test case, the optimal rod step size $\\Delta x_{\\mathrm{opt}}$ is the value in a specified range $[\\Delta x_{\\min}, \\Delta x_{\\max}]$ that minimizes $\\sigma_\\rho$, subject to the physical constraint $0  \\rho  \\beta$.\n\nYou must implement the above simulation to handle multiple test cases. For each test case, the program must compute the optimal step size and the corresponding period and uncertainty. All answers must be expressed in the specified units and rounded to six decimal places.\n\nUnits:\n- Time must be expressed in $\\mathrm{s}$.\n- Reactivity must be expressed as a decimal fraction.\n- Rod step sizes must be expressed in $\\mathrm{cm}$.\n- All angles, if any, must be in radians. No angles are used in this problem.\n\nTest Suite:\nProvide the results for the following four parameter sets. In each case, use an evenly spaced grid of $101$ candidate step sizes between the minimum and maximum. If a candidate step produces $\\rho \\ge \\beta$, it must be excluded from consideration. The program must search the valid candidates for the minimum $\\sigma_\\rho$.\n\n1. Thermal reactor, typical delayed neutron data:\n   - $\\beta_i = [0.000215, 0.001424, 0.001274, 0.002568, 0.000748, 0.000273]$,\n   - $\\lambda_i = [0.0124, 0.0305, 0.111, 0.301, 1.140, 3.010]\\,\\mathrm{s}^{-1}$,\n   - $\\Lambda = 1.0 \\times 10^{-5}\\,\\mathrm{s}$,\n   - $w = 1.6 \\times 10^{-4}\\,\\text{per cm}$,\n   - $\\Delta x_{\\min} = 0.2\\,\\mathrm{cm}$, $\\Delta x_{\\max} = 25.0\\,\\mathrm{cm}$,\n   - $T_m = 30.0\\,\\mathrm{s}$, $C_0 = 2000.0\\,\\text{counts/s}$, $\\gamma = 1.0$.\n\n2. Fast reactor, reduced delayed neutron fraction:\n   - $\\beta = 0.0021$, with group fractions equal to those of the thermal case scaled so that $\\sum_i \\beta_i = \\beta$,\n   - $\\lambda_i$ as in Case 1,\n   - $\\Lambda = 5.0 \\times 10^{-7}\\,\\mathrm{s}$,\n   - $w = 3.2 \\times 10^{-4}\\,\\text{per cm}$,\n   - $\\Delta x_{\\min} = 0.05\\,\\mathrm{cm}$, $\\Delta x_{\\max} = 10.0\\,\\mathrm{cm}$,\n   - $T_m = 10.0\\,\\mathrm{s}$, $C_0 = 5000.0\\,\\text{counts/s}$, $\\gamma = 1.0$.\n\n3. Thermal reactor, aggressive worth slope near the prompt critical limit:\n   - $\\beta_i$ and $\\lambda_i$ as in Case 1,\n   - $\\Lambda = 1.0 \\times 10^{-5}\\,\\mathrm{s}$,\n   - $w = 5.0 \\times 10^{-4}\\,\\text{per cm}$,\n   - $\\Delta x_{\\min} = 0.1\\,\\mathrm{cm}$, $\\Delta x_{\\max} = 40.0\\,\\mathrm{cm}$,\n   - $T_m = 15.0\\,\\mathrm{s}$, $C_0 = 1500.0\\,\\text{counts/s}$, $\\gamma = 1.0$.\n\n4. Thermal reactor, very small worth slope for long periods:\n   - $\\beta_i$ and $\\lambda_i$ as in Case 1,\n   - $\\Lambda = 1.0 \\times 10^{-5}\\,\\mathrm{s}$,\n   - $w = 2.0 \\times 10^{-5}\\,\\text{per cm}$,\n   - $\\Delta x_{\\min} = 0.1\\,\\mathrm{cm}$, $\\Delta x_{\\max} = 20.0\\,\\mathrm{cm}$,\n   - $T_m = 60.0\\,\\mathrm{s}$, $C_0 = 800.0\\,\\text{counts/s}$, $\\gamma = 1.0$.\n\nFor each test case, your program must compute:\n- The optimal rod step size $\\Delta x_{\\mathrm{opt}}$ in $\\mathrm{cm}$,\n- The predicted period $\\tau_{\\mathrm{opt}}$ in $\\mathrm{s}$ at that step,\n- The corresponding absolute standard deviation $\\sigma_\\rho$ in the inferred reactivity.\n\nFinal Output Format:\nYour program should produce a single line of output containing a comma-separated list of four sublists, each sublist formatted as $[\\tau_{\\mathrm{opt}}, \\Delta x_{\\mathrm{opt}}, \\sigma_\\rho]$ and with each numeric entry rounded to six decimal places. Example format (with placeholder values):\n$[[0.123456,1.234567,0.000001],[...],[...],[...]]$.",
            "solution": "The user has provided a valid problem.\n### Step 1: Extract Givens\n\nThe problem provides the following data, definitions, relationships, and constraints.\n\n**Model Definitions:**\n- The reactor is modeled using point kinetics with multiple delayed neutron groups.\n- For each group $i$: effective delayed neutron fraction $\\beta_i$, precursor decay constant $\\lambda_i$ ($\\mathrm{s}^{-1}$).\n- Total delayed neutron fraction: $\\beta = \\sum_i \\beta_i$.\n- Prompt neutron generation time: $\\Lambda$ ($\\mathrm{s}$).\n- Reactivity insertion from rod movement: $\\rho = w \\cdot \\Delta x$, where $w$ is the rod worth slope (per $\\mathrm{cm}$) and $\\Delta x$ is the step size ($\\mathrm{cm}$).\n- Reactor period $\\tau$ ($\\mathrm{s}$) and growth rate $s$ ($\\mathrm{s}^{-1}$) are related by $\\tau = 1/s$.\n- The relationship between a positive reactivity $\\rho  \\beta$ and the growth rate $s$ arises from the point kinetics equations and must be solved numerically.\n\n**Measurement and Uncertainty Model:**\n- Measurement window duration: $T_m$ ($\\mathrm{s}$).\n- Initial count rate: $C_0$ (counts/s).\n- Total observed counts: $N = \\int_0^{T_m} C_0\\, e^{t/\\tau}\\, dt = C_0\\, \\tau (e^{T_m/\\tau} - 1)$.\n- Standard deviation of the measured inverse period: $\\sigma_{(1/\\tau)} = \\frac{\\gamma}{\\sqrt{N}}$, where $\\gamma$ is a dimensionless noise parameter.\n- The standard deviation in reactivity is obtained via first-order uncertainty propagation: $\\sigma_\\rho = \\left| \\frac{d\\rho}{ds} \\right| \\sigma_s$, with $\\sigma_s = \\sigma_{(1/\\tau)}$.\n\n**Optimization Task:**\n- For a given range $[\\Delta x_{\\min}, \\Delta x_{\\max}]$, find the optimal step size $\\Delta x_\\mathrm{opt}$ that minimizes $\\sigma_\\rho$.\n- The search is performed on an evenly spaced grid of $101$ candidate step sizes.\n- A physical constraint is imposed: $0  \\rho  \\beta$. Any candidate step for which $\\rho \\ge \\beta$ must be excluded.\n\n**Test Case 1: Thermal Reactor**\n- $\\beta_i = [0.000215, 0.001424, 0.001274, 0.002568, 0.000748, 0.000273]$.\n- $\\lambda_i = [0.0124, 0.0305, 0.111, 0.301, 1.140, 3.010]\\,\\mathrm{s}^{-1}$.\n- $\\Lambda = 1.0 \\times 10^{-5}\\,\\mathrm{s}$.\n- $w = 1.6 \\times 10^{-4}\\,\\text{per cm}$.\n- $\\Delta x_{\\min} = 0.2\\,\\mathrm{cm}$, $\\Delta x_{\\max} = 25.0\\,\\mathrm{cm}$.\n- $T_m = 30.0\\,\\mathrm{s}$, $C_0 = 2000.0\\,\\text{counts/s}$, $\\gamma = 1.0$.\n\n**Test Case 2: Fast Reactor**\n- $\\beta = 0.0021$. Group fractions $\\beta_i/\\beta$ are the same as in Case 1.\n- $\\lambda_i$ as in Case 1.\n- $\\Lambda = 5.0 \\times 10^{-7}\\,\\mathrm{s}$.\n- $w = 3.2 \\times 10^{-4}\\,\\text{per cm}$.\n- $\\Delta x_{\\min} = 0.05\\,\\mathrm{cm}$, $\\Delta x_{\\max} = 10.0\\,\\mathrm{cm}$.\n- $T_m = 10.0\\,\\mathrm{s}$, $C_0 = 5000.0\\,\\text{counts/s}$, $\\gamma = 1.0$.\n\n**Test Case 3: Thermal Reactor, Aggressive Worth**\n- $\\beta_i$ and $\\lambda_i$ as in Case 1.\n- $\\Lambda = 1.0 \\times 10^{-5}\\,\\mathrm{s}$.\n- $w = 5.0 \\times 10^{-4}\\,\\text{per cm}$.\n- $\\Delta x_{\\min} = 0.1\\,\\mathrm{cm}$, $\\Delta x_{\\max} = 40.0\\,\\mathrm{cm}$.\n- $T_m = 15.0\\,\\mathrm{s}$, $C_0 = 1500.0\\,\\text{counts/s}$, $\\gamma = 1.0$.\n\n**Test Case 4: Thermal Reactor, Small Worth**\n- $\\beta_i$ and $\\lambda_i$ as in Case 1.\n- $\\Lambda = 1.0 \\times 10^{-5}\\,\\mathrm{s}$.\n- $w = 2.0 \\times 10^{-5}\\,\\text{per cm}$.\n- $\\Delta x_{\\min} = 0.1\\,\\mathrm{cm}$, $\\Delta x_{\\max} = 20.0\\,\\mathrm{cm}$.\n- $T_m = 60.0\\,\\mathrm{s}$, $C_0 = 800.0\\,\\text{counts/s}$, $\\gamma = 1.0$.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded:** The problem is firmly based on the standard point kinetics model of nuclear reactor dynamics, a cornerstone of reactor physics. The models for measurement and uncertainty are plausible and well-defined for the purposes of this simulation.\n- **Well-Posed:** The problem requires the minimization of a well-defined function ($\\sigma_\\rho$) over a specified set of candidates. All necessary parameters and constraints are provided. The existence of a solution is guaranteed as long as the set of valid candidates is not empty, which is true for the given test cases.\n- **Objective:** The problem is stated in precise, quantitative, and unbiased scientific language.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, contradiction, or ambiguity. The physical parameters are realistic for the specified reactor types.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Principle-Based Solution\nThe objective is to determine the optimal control rod step size, $\\Delta x_{\\mathrm{opt}}$, that minimizes the uncertainty, $\\sigma_\\rho$, in the reactivity inferred from a measurement of the reactor period. This requires a multi-step derivation and numerical implementation based on the principles of reactor kinetics and uncertainty analysis.\n\n**1. The In-Hour Equation**\nThe point kinetics equations describe the time evolution of the neutron population, $n(t)$, and the concentration of delayed neutron precursors of group $i$, $C_i(t)$:\n$$\n\\frac{dn(t)}{dt} = \\frac{\\rho(t) - \\beta}{\\Lambda} n(t) + \\sum_{i} \\lambda_i C_i(t)\n$$\n$$\n\\frac{dC_i(t)}{dt} = \\frac{\\beta_i}{\\Lambda} n(t) - \\lambda_i C_i(t)\n$$\nFor a step insertion of constant positive reactivity $\\rho$, the system eventually reaches a stable exponential growth characterized by a constant inverse period $s > 0$. We assume solutions of the form $n(t) = n_0 e^{st}$ and $C_i(t) = C_{i,0} e^{st}$. Substituting these into the precursor equation gives:\n$$\ns C_{i,0} e^{st} = \\frac{\\beta_i}{\\Lambda} n_0 e^{st} - \\lambda_i C_{i,0} e^{st} \\implies C_{i,0} = \\frac{\\beta_i n_0}{\\Lambda(s + \\lambda_i)}\n$$\nSubstituting this and the exponential form for $n(t)$ into the neutron population equation yields:\n$$\ns n_0 e^{st} = \\frac{\\rho - \\beta}{\\Lambda} n_0 e^{st} + \\sum_{i} \\lambda_i \\frac{\\beta_i n_0}{\\Lambda(s + \\lambda_i)} e^{st}\n$$\nDividing by $n_0 e^{st}$ and multiplying by $\\Lambda$, and recalling $\\beta = \\sum_i \\beta_i$, we get:\n$$\ns \\Lambda = \\rho - \\sum_i \\beta_i + \\sum_{i} \\frac{\\lambda_i \\beta_i}{s + \\lambda_i} = \\rho + \\sum_i \\left( \\frac{\\lambda_i \\beta_i}{s + \\lambda_i} - \\beta_i \\right) = \\rho + \\sum_i \\frac{\\lambda_i \\beta_i - \\beta_i(s+\\lambda_i)}{s + \\lambda_i} = \\rho - \\sum_i \\frac{s \\beta_i}{s + \\lambda_i}\n$$\nRearranging for $\\rho$ gives the **in-hour equation**, which relates reactivity to the inverse period $s$:\n$$\n\\rho(s) = s\\Lambda + \\sum_{i} \\frac{s \\beta_i}{s+\\lambda_i}\n$$\nFor any given reactivity $\\rho$ such that $0  \\rho  \\beta$, this equation has a unique positive root $s$, which must be found numerically.\n\n**2. Uncertainty Propagation**\nThe uncertainty in the inferred reactivity, $\\sigma_\\rho$, is determined by propagating the measurement uncertainty of the inverse period, $\\sigma_s = \\sigma_{(1/\\tau)}$, through the in-hour relation. The first-order approximation is given by:\n$$\n\\sigma_\\rho = \\left| \\frac{d\\rho}{ds} \\right| \\sigma_s\n$$\nWe must derive expressions for both terms on the right-hand side.\n\n**2.1. Sensitivity Term, $\\frac{d\\rho}{ds}$**\nWe differentiate the in-hour equation with respect to $s$:\n$$\n\\frac{d\\rho}{ds} = \\frac{d}{ds} \\left( s\\Lambda + \\sum_{i} \\frac{s \\beta_i}{s+\\lambda_i} \\right) = \\Lambda + \\sum_{i} \\beta_i \\frac{d}{ds} \\left( \\frac{s}{s+\\lambda_i} \\right)\n$$\nUsing the quotient rule, $\\frac{d}{dx} \\frac{u}{v} = \\frac{u'v - uv'}{v^2}$, we find:\n$$\n\\frac{d}{ds} \\left( \\frac{s}{s+\\lambda_i} \\right) = \\frac{(1)(s+\\lambda_i) - (s)(1)}{(s+\\lambda_i)^2} = \\frac{\\lambda_i}{(s+\\lambda_i)^2}\n$$\nThus, the sensitivity term is:\n$$\n\\frac{d\\rho}{ds} = \\Lambda + \\sum_{i} \\frac{\\beta_i \\lambda_i}{(s+\\lambda_i)^2}\n$$\nSince $\\Lambda, \\beta_i, \\lambda_i$ are all positive, $\\frac{d\\rho}{ds}$ is always positive, so $\\left| \\frac{d\\rho}{ds} \\right| = \\frac{d\\rho}{ds}$.\n\n**2.2. Measurement Uncertainty, $\\sigma_s$**\nThe standard deviation of the inverse period is given as $\\sigma_s = \\gamma / \\sqrt{N}$. The total counts $N$ are:\n$$\nN = \\int_0^{T_m} C_0 e^{t/\\tau} dt = C_0 \\left[ \\tau e^{t/\\tau} \\right]_0^{T_m} = C_0 \\tau (e^{T_m/\\tau} - 1)\n$$\nSubstituting $\\tau = 1/s$, we have:\n$$\nN(s) = C_0 \\frac{1}{s} (e^{sT_m} - 1)\n$$\nThe measurement uncertainty is therefore a function of $s$:\n$$\n\\sigma_s(s) = \\frac{\\gamma}{\\sqrt{C_0 \\frac{1}{s} (e^{sT_m} - 1)}} = \\gamma \\sqrt{\\frac{s}{C_0(e^{sT_m} - 1)}}\n$$\n\n**2.3. Total Reactivity Uncertainty, $\\sigma_\\rho(s)$**\nCombining the terms, the total uncertainty in reactivity as a function of the inverse period $s$ is:\n$$\n\\sigma_\\rho(s) = \\left( \\Lambda + \\sum_{i} \\frac{\\beta_i \\lambda_i}{(s+\\lambda_i)^2} \\right) \\left( \\gamma \\sqrt{\\frac{s}{C_0(e^{sT_m} - 1)}} \\right)\n$$\n\n**3. Optimization Procedure**\nThe goal is to find the rod step $\\Delta x$ that minimizes $\\sigma_\\rho$. The procedure is as follows:\n1.  **Discretize Search Space:** Create a grid of $101$ equally spaced candidate values for $\\Delta x$ in the range $[\\Delta x_{\\min}, \\Delta x_{\\max}]$.\n2.  **Iterate and Evaluate:** For each candidate $\\Delta x$ in the grid:\n    a. Calculate the corresponding reactivity $\\rho = w \\cdot \\Delta x$.\n    b. Check the validity constraint: if $\\rho \\ge \\beta = \\sum_i \\beta_i$, the candidate is invalid and is excluded from consideration.\n    c. For a valid $\\rho$, solve the in-hour equation $f(s) = s\\Lambda + \\sum_i \\frac{s \\beta_i}{s+\\lambda_i} - \\rho = 0$ for the unique positive root $s$. This is accomplished using a numerical root-finding algorithm, such as Brent's method.\n    d. Using the found value of $s$, calculate the uncertainty $\\sigma_\\rho(s)$ using the expression derived above.\n3.  **Identify Optimum:** After evaluating all valid candidates, search the results to find the minimum value of $\\sigma_\\rho$. The corresponding step size $\\Delta x_{\\mathrm{opt}}$, period $\\tau_{\\mathrm{opt}} = 1/s_{\\mathrm{opt}}$, and uncertainty $\\sigma_{\\rho, \\mathrm{opt}}$ are the solution for the test case.\n\nIt is worth noting that for $s > 0$, both the sensitivity term $\\frac{d\\rho}{ds}$ and the measurement uncertainty term $\\sigma_s(s)$ are positive, monotonically decreasing functions of $s$. Therefore, their product, $\\sigma_\\rho(s)$, is also a monotonically decreasing function of $s$. Since $s$ is a monotonically increasing function of $\\rho$ (and thus of $\\Delta x$), it follows that $\\sigma_\\rho$ is a monotonically decreasing function of $\\Delta x$. Consequently, the minimum uncertainty will always occur at the largest valid candidate step size $\\Delta x$ in the specified grid. The implemented program will nonetheless perform the full search as instructed.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the reactor control rod calibration optimization problem.\n\n    For each test case, the program finds the optimal rod step size that minimizes\n    the uncertainty in inferred reactivity, based on the point kinetics model.\n    \"\"\"\n\n    # --- Test Case Definitions ---\n    beta_i_base = np.array([0.000215, 0.001424, 0.001274, 0.002568, 0.000748, 0.000273])\n    lambda_i_base = np.array([0.0124, 0.0305, 0.111, 0.301, 1.140, 3.010])\n    beta_base_total = np.sum(beta_i_base)\n\n    beta_i_case2 = beta_i_base * (0.0021 / beta_base_total)\n    \n    test_cases = [\n        {\n            \"name\": \"Thermal reactor, typical\",\n            \"beta_i\": beta_i_base,\n            \"lambda_i\": lambda_i_base,\n            \"Lambda\": 1.0e-5,\n            \"w\": 1.6e-4,\n            \"dx_min\": 0.2, \"dx_max\": 25.0,\n            \"Tm\": 30.0, \"C0\": 2000.0, \"gamma\": 1.0\n        },\n        {\n            \"name\": \"Fast reactor, reduced beta\",\n            \"beta_i\": beta_i_case2,\n            \"lambda_i\": lambda_i_base,\n            \"Lambda\": 5.0e-7,\n            \"w\": 3.2e-4,\n            \"dx_min\": 0.05, \"dx_max\": 10.0,\n            \"Tm\": 10.0, \"C0\": 5000.0, \"gamma\": 1.0\n        },\n        {\n            \"name\": \"Thermal reactor, aggressive worth\",\n            \"beta_i\": beta_i_base,\n            \"lambda_i\": lambda_i_base,\n            \"Lambda\": 1.0e-5,\n            \"w\": 5.0e-4,\n            \"dx_min\": 0.1, \"dx_max\": 40.0,\n            \"Tm\": 15.0, \"C0\": 1500.0, \"gamma\": 1.0\n        },\n        {\n            \"name\": \"Thermal reactor, very small worth\",\n            \"beta_i\": beta_i_base,\n            \"lambda_i\": lambda_i_base,\n            \"Lambda\": 1.0e-5,\n            \"w\": 2.0e-5,\n            \"dx_min\": 0.1, \"dx_max\": 20.0,\n            \"Tm\": 60.0, \"C0\": 800.0, \"gamma\": 1.0\n        }\n    ]\n\n    final_results = []\n    \n    # --- Main Calculation Loop ---\n    for params in test_cases:\n        beta_i = params[\"beta_i\"]\n        lambda_i = params[\"lambda_i\"]\n        Lambda = params[\"Lambda\"]\n        w = params[\"w\"]\n        Tm = params[\"Tm\"]\n        C0 = params[\"C0\"]\n        gamma = params[\"gamma\"]\n        total_beta = np.sum(beta_i)\n        \n        dx_grid = np.linspace(params[\"dx_min\"], params[\"dx_max\"], 101)\n        \n        valid_steps = []\n\n        def in_hour_residual(s, rho_target, Lambda_p, beta_i_p, lambda_i_p):\n            \"\"\"Residual of the in-hour equation: f(s) = rho(s) - rho_target.\"\"\"\n            rho_s = s * Lambda_p + np.sum(s * beta_i_p / (s + lambda_i_p))\n            return rho_s - rho_target\n\n        for dx in dx_grid:\n            rho = w * dx\n            \n            # Constraint: 0  rho  beta. The lower bound dx_min > 0 ensures rho > 0.\n            if rho >= total_beta:\n                continue\n\n            # Solve for inverse period 's' using Brent's method\n            try:\n                # A wide bracket for s is safe, as rho is constrained below beta.\n                s = brentq(in_hour_residual, 1e-9, 2000.0, args=(rho, Lambda, beta_i, lambda_i))\n            except ValueError:\n                # Should not happen for rho  beta\n                continue\n            \n            # Calculate sensitivity d(rho)/ds\n            d_rho_ds = Lambda + np.sum(beta_i * lambda_i / (s + lambda_i)**2)\n            \n            # Calculate measurement uncertainty sigma_s\n            tau = 1.0 / s\n            \n            # Use np.expm1 for better precision with small s*Tm\n            N = C0 * tau * np.expm1(s * Tm)\n            \n            if N = 0:\n                sigma_s = np.inf\n            else:\n                sigma_s = gamma / np.sqrt(N)\n                \n            # Calculate total reactivity uncertainty sigma_rho\n            sigma_rho = d_rho_ds * sigma_s\n            \n            valid_steps.append({'dx': dx, 'tau': tau, 'sigma_rho': sigma_rho})\n            \n        # Find the step with the minimum uncertainty among valid candidates\n        if not valid_steps:\n             # This case should not occur with the given problem parameters.\n             # If it did, it would imply no solution exists in the specified range.\n             # For robustness, handle this, although it's not expected.\n            raise ValueError(f\"No valid steps found for case: {params['name']}\")\n\n        optimal_step = min(valid_steps, key=lambda x: x['sigma_rho'])\n        \n        dx_opt = optimal_step['dx']\n        tau_opt = optimal_step['tau']\n        sigma_rho_opt = optimal_step['sigma_rho']\n\n        # Format result string for this case\n        result_str = f\"[{tau_opt:.6f},{dx_opt:.6f},{sigma_rho_opt:.6f}]\"\n        final_results.append(result_str)\n\n    # --- Final Output ---\n    # Print the final result string in the required format\n    print(f\"[{','.join(final_results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}