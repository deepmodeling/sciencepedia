{
    "hands_on_practices": [
        {
            "introduction": "掌握印时方程的第一步是理解其基本结构和物理含义。本练习将引导你从点动力学方程出发，推导出印时方程，然后通过数值计算来剖析和比较瞬发中子与缓发中子的贡献。通过这项实践，你将量化地理解为何缓发中子对于反应堆控制至关重要，即使在功率快速变化的瞬态过程中也是如此 。",
            "id": "4255337",
            "problem": "考虑一个由点式反应堆动力学方程（PRKE）建模的均匀单区反应堆，该反应堆有六组缓发中子，无外源，且参数恒定。设中子布居为 $n(t)$，第 $i$ 组先驱核浓度为 $C_{i}(t)$（$i=1,\\dots,6$）。PRKE 方程如下：\n$$\n\\frac{d n(t)}{d t} = \\frac{\\rho - \\beta}{\\Lambda} \\, n(t) + \\sum_{i=1}^{6} \\lambda_{i} \\, C_{i}(t),\n\\qquad\n\\frac{d C_{i}(t)}{d t} = \\frac{\\beta_{i}}{\\Lambda} \\, n(t) - \\lambda_{i} \\, C_{i}(t),\n$$\n其中 $\\rho$ 是反应性，$\\beta = \\sum_{i=1}^{6} \\beta_{i}$ 是总缓发中子份额，$\\Lambda$ 是瞬发中子代时间，$\\lambda_{i}$ 和 $\\beta_{i}$ 分别是第 $i$ 组缓发中子的衰变常数和份额。假设存在一个指数模式 $n(t) = n_{0} \\exp(\\omega t)$ 和 $C_{i}(t) = C_{i,0} \\exp(\\omega t)$，其中 $\\omega$ 为实频率。从PRKE和指数拟设出发，推导 $\\rho$ 与参数 $\\omega$、$\\Lambda$、$\\beta_{i}$ 和 $\\lambda_{i}$ 之间的关系，并识别出线性依赖于 $\\omega \\Lambda$ 的贡献以及来自缓发中子群组的贡献。\n\n然后，使用以下科学上公认的铀-235热裂变六组参数，在 $\\omega = 1\\,\\mathrm{s}^{-1}$ 和 $\\Lambda = 1.0 \\times 10^{-5}\\,\\mathrm{s}$ 的条件下，数值计算瞬发项与缓发贡献之比：\n- 第1组：$\\beta_{1} = 2.60 \\times 10^{-4}$，$\\lambda_{1} = 1.24 \\times 10^{-2}\\,\\mathrm{s}^{-1}$。\n- 第2组：$\\beta_{2} = 1.26 \\times 10^{-3}$，$\\lambda_{2} = 3.05 \\times 10^{-2}\\,\\mathrm{s}^{-1}$。\n- 第3组：$\\beta_{3} = 1.27 \\times 10^{-3}$，$\\lambda_{3} = 1.11 \\times 10^{-1}\\,\\mathrm{s}^{-1}$。\n- 第4组：$\\beta_{4} = 2.58 \\times 10^{-3}$，$\\lambda_{4} = 3.01 \\times 10^{-1}\\,\\mathrm{s}^{-1}$。\n- 第5组：$\\beta_{5} = 7.40 \\times 10^{-4}$，$\\lambda_{5} = 1.14\\,\\mathrm{s}^{-1}$。\n- 第6组：$\\beta_{6} = 2.70 \\times 10^{-4}$，$\\lambda_{6} = 3.01\\,\\mathrm{s}^{-1}$。\n\n将缓发贡献定义为您推导的表达式中由缓发中子动力学产生的六组项之和。计算瞬发项与缓发贡献的比值 $R$，并将最终结果四舍五入至四位有效数字。最终答案以纯数字（无量纲）形式表示。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 第一步：提取已知条件\n物理系统是一个无外源的均匀单区反应堆，由包含六组缓发中子的点式反应堆动力学方程（PRKE）描述。\n- 中子布居：$n(t)$\n- 先驱核浓度：$C_{i}(t)$，$i=1, \\dots, 6$\n- PRKE 方程：\n$$\n\\frac{d n(t)}{d t} = \\frac{\\rho - \\beta}{\\Lambda} \\, n(t) + \\sum_{i=1}^{6} \\lambda_{i} \\, C_{i}(t)\n$$\n$$\n\\frac{d C_{i}(t)}{d t} = \\frac{\\beta_{i}}{\\Lambda} \\, n(t) - \\lambda_{i} \\, C_{i}(t)\n$$\n- 定义：\n  - $\\rho$：反应性\n  - $\\beta = \\sum_{i=1}^{6} \\beta_{i}$：总缓发中子份额\n  - $\\Lambda$：瞬发中子代时间\n  - $\\lambda_{i}$：第 $i$ 组缓发中子的衰变常数\n  - $\\beta_{i}$：第 $i$ 组缓发中子的份额\n- 假设的解形式（拟设）：$n(t) = n_{0} \\exp(\\omega t)$ 和 $C_{i}(t) = C_{i,0} \\exp(\\omega t)$，其中 $\\omega$ 是实频率。\n- 铀-235热裂变的数值参数：\n  - 第1组：$\\beta_{1} = 2.60 \\times 10^{-4}$，$\\lambda_{1} = 1.24 \\times 10^{-2}\\,\\mathrm{s}^{-1}$\n  - 第2组：$\\beta_{2} = 1.26 \\times 10^{-3}$，$\\lambda_{2} = 3.05 \\times 10^{-2}\\,\\mathrm{s}^{-1}$\n  - 第3组：$\\beta_{3} = 1.27 \\times 10^{-3}$，$\\lambda_{3} = 1.11 \\times 10^{-1}\\,\\mathrm{s}^{-1}$\n  - 第4组：$\\beta_{4} = 2.58 \\times 10^{-3}$，$\\lambda_{4} = 3.01 \\times 10^{-1}\\,\\mathrm{s}^{-1}$\n  - 第5组：$\\beta_{5} = 7.40 \\times 10^{-4}$，$\\lambda_{5} = 1.14\\,\\mathrm{s}^{-1}$\n  - 第6组：$\\beta_{6} = 2.70 \\times 10^{-4}$，$\\lambda_{6} = 3.01\\,\\mathrm{s}^{-1}$\n- 用于数值计算的值：\n  - $\\omega = 1\\,\\mathrm{s}^{-1}$\n  - $\\Lambda = 1.0 \\times 10^{-5}\\,\\mathrm{s}$\n- 任务：\n  1. 推导 $\\rho$ 与其他参数（$\\omega$, $\\Lambda$, $\\beta_{i}$, $\\lambda_{i}$）之间的关系。\n  2. 识别此关系中的瞬发贡献和缓发贡献。\n  3. 数值计算瞬发项与缓发贡献之比 $R$。\n  4. 将最终结果四舍五入到四位有效数字。\n\n### 第二步：使用提取的已知条件进行验证\n该问题是核反应堆物理学中的一个标准练习。\n- **科学依据**：点式反应堆动力学方程是反应堆动力学的一个基础但简化的模型。所提供的六组缓发中子数据是公认的铀-235热裂变标准值。整个问题都牢固地建立在反应堆物理的既定原则之上。\n- **适定性**：问题陈述清晰，提供了推导唯一解析表达式和计算唯一数值结果所需的所有方程、参数和定义。从PRKE推导反应性-周期关系式是一个经典的、明确定义的过程。\n- **客观性**：语言精确且无偏见。所有术语均为该领域的标准术语。没有主观或基于观点的陈述。\n- 该问题没有验证标准中列出的任何缺陷。它不是科学上不合理、不可形式化、不完整、不切实际、不适定或微不足道的。\n\n### 第三步：结论与行动\n问题陈述是**有效的**。将提供解答。\n\n### 反应性-周期关系式（逆时方程）的推导\n我们从点式反应堆动力学方程开始：\n$$\n\\frac{d n(t)}{d t} = \\frac{\\rho - \\beta}{\\Lambda} n(t) + \\sum_{i=1}^{6} \\lambda_{i} C_{i}(t) \\quad (1)\n$$\n$$\n\\frac{d C_{i}(t)}{d t} = \\frac{\\beta_{i}}{\\Lambda} n(t) - \\lambda_{i} C_{i}(t) \\quad \\text{for } i=1, \\dots, 6 \\quad (2)\n$$\n我们将指数拟设 $n(t) = n_{0} \\exp(\\omega t)$ 和 $C_{i}(t) = C_{i,0} \\exp(\\omega t)$ 代入这些方程。导数变为 $\\frac{dn}{dt} = \\omega n(t)$ 和 $\\frac{dC_i}{dt} = \\omega C_i(t)$。\n\n将以上关系代入方程(2)对每一组 $i$：\n$$\n\\omega C_{i}(t) = \\frac{\\beta_{i}}{\\Lambda} n(t) - \\lambda_{i} C_{i}(t)\n$$\n我们重排此式，用 $n(t)$ 表示 $C_{i}(t)$：\n$$\n(\\omega + \\lambda_{i}) C_{i}(t) = \\frac{\\beta_{i}}{\\Lambda} n(t)\n$$\n假设 $\\omega + \\lambda_i \\neq 0$，对于真实的反应堆周期和非负的衰变常数，这是成立的：\n$$\nC_{i}(t) = \\frac{\\beta_{i}}{\\Lambda(\\omega + \\lambda_{i})} n(t) \\quad (3)\n$$\n这表明，对于指数功率变化，先驱核浓度与中子布居处于平衡状态。\n\n接下来，我们将导数 $\\frac{dn}{dt} = \\omega n(t)$ 和来自(3)的 $C_i(t)$ 表达式代入方程(1)：\n$$\n\\omega n(t) = \\frac{\\rho - \\beta}{\\Lambda} n(t) + \\sum_{i=1}^{6} \\lambda_{i} \\left( \\frac{\\beta_{i}}{\\Lambda(\\omega + \\lambda_{i})} n(t) \\right)\n$$\n由于 $n(t) = n_0 \\exp(\\omega t)$ 不恒为零，我们可以将整个方程除以 $n(t)$：\n$$\n\\omega = \\frac{\\rho - \\beta}{\\Lambda} + \\sum_{i=1}^{6} \\frac{\\lambda_{i} \\beta_{i}}{\\Lambda(\\omega + \\lambda_{i})}\n$$\n为了求解反应性 $\\rho$，我们将方程乘以瞬发中子代时间 $\\Lambda$：\n$$\n\\omega \\Lambda = \\rho - \\beta + \\sum_{i=1}^{6} \\frac{\\lambda_{i} \\beta_{i}}{\\omega + \\lambda_{i}}\n$$\n分离出 $\\rho$：\n$$\n\\rho = \\omega \\Lambda + \\beta - \\sum_{i=1}^{6} \\frac{\\lambda_{i} \\beta_{i}}{\\omega + \\lambda_{i}}\n$$\n回顾总缓发中子份额为 $\\beta = \\sum_{i=1}^{6} \\beta_{i}$，我们可以将其代入方程：\n$$\n\\rho = \\omega \\Lambda + \\sum_{i=1}^{6} \\beta_{i} - \\sum_{i=1}^{6} \\frac{\\lambda_{i} \\beta_{i}}{\\omega + \\lambda_{i}}\n$$\n合并求和项：\n$$\n\\rho = \\omega \\Lambda + \\sum_{i=1}^{6} \\left( \\beta_{i} - \\frac{\\lambda_{i} \\beta_{i}}{\\omega + \\lambda_{i}} \\right)\n$$\n通过通分来简化求和内的项：\n$$\n\\beta_{i} - \\frac{\\lambda_{i} \\beta_{i}}{\\omega + \\lambda_{i}} = \\frac{\\beta_{i}(\\omega + \\lambda_{i}) - \\lambda_{i} \\beta_{i}}{\\omega + \\lambda_{i}} = \\frac{\\beta_{i}\\omega + \\beta_{i}\\lambda_{i} - \\lambda_{i}\\beta_{i}}{\\omega + \\lambda_{i}} = \\frac{\\omega \\beta_{i}}{\\omega + \\lambda_{i}}\n$$\n将此结果代回，得到最终的关系式，即反应性-周期关系式（逆时方程）：\n$$\n\\rho(\\omega) = \\omega \\Lambda + \\sum_{i=1}^{6} \\frac{\\omega \\beta_{i}}{\\omega + \\lambda_{i}}\n$$\n该方程给出了产生稳定反应堆周期 $T = 1/\\omega$ 所需的反应性 $\\rho$。\n\n问题要求识别瞬发和缓发贡献。\n- 瞬发项是由瞬发中子引起的贡献，即 $\\rho_{prompt} = \\omega \\Lambda$。\n- 缓发贡献来自缓发中子先驱核的动力学，即 $\\rho_{delayed} = \\sum_{i=1}^{6} \\frac{\\omega \\beta_{i}}{\\omega + \\lambda_{i}}$。\n\n### 数值计算\n我们被要求计算在给定参数下，比值 $R = \\frac{\\rho_{prompt}}{\\rho_{delayed}}$：\n- $\\omega = 1\\,\\mathrm{s}^{-1}$\n- $\\Lambda = 1.0 \\times 10^{-5}\\,\\mathrm{s}$\n- 铀-235的六组数据。\n\n首先，我们计算瞬发贡献：\n$$\n\\rho_{prompt} = \\omega \\Lambda = (1\\,\\mathrm{s}^{-1})(1.0 \\times 10^{-5}\\,\\mathrm{s}) = 1.0 \\times 10^{-5}\n$$\n接下来，我们计算缓发贡献。由于 $\\omega=1\\,\\mathrm{s}^{-1}$：\n$$\n\\rho_{delayed} = \\sum_{i=1}^{6} \\frac{1 \\cdot \\beta_{i}}{1 + \\lambda_{i}}\n$$\n- 第1组：$\\frac{\\beta_{1}}{1 + \\lambda_{1}} = \\frac{2.60 \\times 10^{-4}}{1 + 1.24 \\times 10^{-2}} = \\frac{2.60 \\times 10^{-4}}{1.0124} \\approx 2.568155 \\times 10^{-4}$\n- 第2组：$\\frac{\\beta_{2}}{1 + \\lambda_{2}} = \\frac{1.26 \\times 10^{-3}}{1 + 3.05 \\times 10^{-2}} = \\frac{1.26 \\times 10^{-3}}{1.0305} \\approx 1.222707 \\times 10^{-3}$\n- 第3组：$\\frac{\\beta_{3}}{1 + \\lambda_{3}} = \\frac{1.27 \\times 10^{-3}}{1 + 1.11 \\times 10^{-1}} = \\frac{1.27 \\times 10^{-3}}{1.111} \\approx 1.143114 \\times 10^{-3}$\n- 第4组：$\\frac{\\beta_{4}}{1 + \\lambda_{4}} = \\frac{2.58 \\times 10^{-3}}{1 + 3.01 \\times 10^{-1}} = \\frac{2.58 \\times 10^{-3}}{1.301} \\approx 1.983090 \\times 10^{-3}$\n- 第5组：$\\frac{\\beta_{5}}{1 + \\lambda_{5}} = \\frac{7.40 \\times 10^{-4}}{1 + 1.14} = \\frac{7.40 \\times 10^{-4}}{2.14} \\approx 3.457944 \\times 10^{-4}$\n- 第6组：$\\frac{\\beta_{6}}{1 + \\lambda_{6}} = \\frac{2.70 \\times 10^{-4}}{1 + 3.01} = \\frac{2.70 \\times 10^{-4}}{4.01} \\approx 6.733167 \\times 10^{-5}$\n\n将这些贡献相加：\n$$\n\\rho_{delayed} \\approx (2.568155 + 12.227074 + 11.431143 + 19.830899 + 3.457944 + 0.673317) \\times 10^{-4}\n$$\n$$\n\\rho_{delayed} \\approx 50.18853 \\times 10^{-4} = 5.018853 \\times 10^{-3}\n$$\n使用更高精度的总和为 $\\rho_{delayed} \\approx 5.0188532 \\times 10^{-3}$。\n\n最后，我们计算比值 $R$：\n$$\nR = \\frac{\\rho_{prompt}}{\\rho_{delayed}} = \\frac{1.0 \\times 10^{-5}}{5.0188532 \\times 10^{-3}} \\approx 0.001992487\n$$\n问题要求将最终结果四舍五入到四位有效数字。\n$$\nR \\approx 0.001992\n$$\n该比值代表了在1秒这个非常短的反应堆周期下，决定反应性时瞬发中子项与缓发中子项的相对重要性。$R$ 的值很小，表明对于这个周期，缓发中子对总反应性的影响远大于瞬发中子。",
            "answer": "$$\n\\boxed{0.001992}\n$$"
        },
        {
            "introduction": "理论模型的准确性依赖于其中各项参数的精确度，而在实际应用中，这些参数往往伴随着不确定性。本练习旨在探讨这种不确定性带来的实际影响，特别是针对瞬发中子代时间 $\\Lambda$ 的不确定性。通过计算由 $\\Lambda$ 的不确定性导致的推算反应性偏差，你将深入了解基于周期的反应性测量方法的稳健性，尤其是在接近瞬发临界的状态下 。",
            "id": "4255322",
            "problem": "一个均匀的热中子反应堆正在经历一次恒定的阶跃反应性引入 $\\,\\rho\\,$，这导致其功率呈渐近指数上升，测量到的周期为 $\\,T\\,$，使得中子布居数满足 $\\,n(t) = n_{0}\\exp(\\alpha t)\\,$，其中 $\\,\\alpha = 1/T\\,$。使用单组有效缓发中子群的点动力学方程对堆芯进行建模，该缓发中子群的特征是有效缓发中子份额 $\\,\\beta_{\\mathrm{eff}}\\,$ 和有效先驱核衰变常数 $\\,\\lambda\\,$，并包含瞬发中子代时间 $\\,\\Lambda\\,$。从点动力学方程出发，推导在这些条件下联系 $\\,\\alpha\\,$ 和 $\\,\\rho\\,$ 的关系式，并用它从测量到的周期推断 $\\,\\rho\\,$。\n\n对于一个近瞬发临界的热中子系统，假设以下科学上合理的参数：\n- $\\,\\beta_{\\mathrm{eff}} = 6.5\\times 10^{-3}\\,$,\n- $\\,\\lambda = 8.0\\times 10^{-2}\\,\\mathrm{s}^{-1}\\,$,\n- $\\,T = 2.0\\times 10^{-1}\\,\\mathrm{s}\\,$, 所以 $\\,\\alpha = 5.0\\,\\mathrm{s}^{-1}\\,$,\n- 标称 $\\,\\Lambda = 4.0\\times 10^{-5}\\,\\mathrm{s}\\,$.\n\n为了评估在近瞬发临界条件下 $\\,\\Lambda\\,$ 的不确定性对基于周期的反应性推断的影响，定义相对跨度\n$$S \\equiv \\frac{\\rho(2\\Lambda) - \\rho(\\Lambda/2)}{\\rho(\\Lambda)}.$$\n使用上述参数数值计算 $\\,S\\,$。将最终结果表示为无量纲的小数，并四舍五入到四位有效数字。",
            "solution": "该问题陈述是有效的，因为它基于核反应堆物理学的科学原理，问题设定良好且提供了所有必要信息，并以客观、正式的语言表述。我们可以开始求解。\n\n反应堆的动态行为由点动力学方程描述。对于单组有效缓发中子群，这些方程为：\n$$\n\\frac{dn(t)}{dt} = \\frac{\\rho - \\beta_{\\mathrm{eff}}}{\\Lambda} n(t) + \\lambda C(t)\n$$\n$$\n\\frac{dC(t)}{dt} = \\frac{\\beta_{\\mathrm{eff}}}{\\Lambda} n(t) - \\lambda C(t)\n$$\n其中 $n(t)$ 是中子布居数，$C(t)$ 是有效先驱核浓度，$\\rho$ 是反应性，$\\beta_{\\mathrm{eff}}$ 是有效缓发中子份额，$\\Lambda$ 是瞬发中子代时间，$\\lambda$ 是有效先驱核衰变常数。\n\n问题陈述指出，在一次阶跃反应性引入后，系统表现出渐近指数功率上升，这意味着中子布居数具有 $n(t) = n_{0}\\exp(\\alpha t)$ 的形式，其中 $\\alpha = 1/T$ 是逆周期。为了使线性微分方程组成立，先驱核浓度也必须具有相同的时间指数依赖关系，$C(t) = C_{0}\\exp(\\alpha t)$。\n\n将这些形式代入点动力学方程，我们得到一个关于振幅 $n_0$ 和 $C_0$ 的代数方程组：\n$$\n\\alpha n_{0}\\exp(\\alpha t) = \\frac{\\rho - \\beta_{\\mathrm{eff}}}{\\Lambda} n_{0}\\exp(\\alpha t) + \\lambda C_{0}\\exp(\\alpha t)\n$$\n$$\n\\alpha C_{0}\\exp(\\alpha t) = \\frac{\\beta_{\\mathrm{eff}}}{\\Lambda} n_{0}\\exp(\\alpha t) - \\lambda C_{0}\\exp(\\alpha t)\n$$\n两边同除以公因式 $\\exp(\\alpha t)$ 得：\n$$\n\\alpha n_{0} = \\frac{\\rho - \\beta_{\\mathrm{eff}}}{\\Lambda} n_{0} + \\lambda C_{0}\n$$\n$$\n\\alpha C_{0} = \\frac{\\beta_{\\mathrm{eff}}}{\\Lambda} n_{0} - \\lambda C_{0}\n$$\n从第二个方程，我们可以用 $n_0$ 表示 $C_0$：\n$$\n(\\alpha + \\lambda) C_{0} = \\frac{\\beta_{\\mathrm{eff}}}{\\Lambda} n_{0} \\implies C_{0} = \\frac{\\beta_{\\mathrm{eff}}}{\\Lambda(\\alpha + \\lambda)} n_{0}\n$$\n由于对于非平凡解，$n_0$ 必须不为零，我们将这个 $C_0$ 的表达式代入第一个方程，并两边同除以 $n_0$：\n$$\n\\alpha = \\frac{\\rho - \\beta_{\\mathrm{eff}}}{\\Lambda} + \\lambda \\left( \\frac{\\beta_{\\mathrm{eff}}}{\\Lambda(\\alpha + \\lambda)} \\right)\n$$\n现在我们可以求解反应性 $\\rho$。两边乘以 $\\Lambda$ 得：\n$$\n\\Lambda \\alpha = \\rho - \\beta_{\\mathrm{eff}} + \\frac{\\lambda \\beta_{\\mathrm{eff}}}{\\alpha + \\lambda}\n$$\n$$\n\\rho = \\Lambda \\alpha + \\beta_{\\mathrm{eff}} - \\frac{\\lambda \\beta_{\\mathrm{eff}}}{\\alpha + \\lambda} = \\Lambda \\alpha + \\beta_{\\mathrm{eff}} \\left( 1 - \\frac{\\lambda}{\\alpha + \\lambda} \\right)\n$$\n简化括号中的项：\n$$\n\\rho = \\Lambda \\alpha + \\beta_{\\mathrm{eff}} \\left( \\frac{\\alpha + \\lambda - \\lambda}{\\alpha + \\lambda} \\right)\n$$\n这就得到了所求的关系式，称为单组缓发中子的固有时方程：\n$$\n\\rho(\\alpha) = \\Lambda \\alpha + \\frac{\\beta_{\\mathrm{eff}} \\alpha}{\\alpha + \\lambda}\n$$\n这个公式允许从测得的逆周期 $\\alpha$ 推断出反应性 $\\rho$。\n\n问题要求计算相对跨度 $S$，定义为：\n$$\nS \\equiv \\frac{\\rho(2\\Lambda) - \\rho(\\Lambda/2)}{\\rho(\\Lambda)}\n$$\n这个量衡量了所推断的反应性对瞬发中子代时间 $\\Lambda$ 假设值四倍变化的敏感度。其他参数（$\\beta_{\\mathrm{eff}}$、$\\lambda$、$\\alpha$）保持不变。\n让我们用固有时方程来表示 $S$ 的分子和分母。\n反应性 $\\rho$ 是 $\\Lambda$ 的函数。我们将固有时方程中的两项分别表示为瞬发项贡献 $\\rho_p(\\Lambda) = \\Lambda \\alpha$ 和缓发项贡献 $\\rho_d = \\frac{\\beta_{\\mathrm{eff}} \\alpha}{\\alpha + \\lambda}$，后者与 $\\Lambda$ 无关。\n$$\n\\rho(\\Lambda) = \\rho_p(\\Lambda) + \\rho_d = \\Lambda \\alpha + \\rho_d\n$$\n那么，$S$ 表达式中的各项为：\n$$\n\\rho(2\\Lambda) = (2\\Lambda)\\alpha + \\rho_d = 2\\rho_p(\\Lambda) + \\rho_d\n$$\n$$\n\\rho(\\Lambda/2) = (\\Lambda/2)\\alpha + \\rho_d = \\frac{1}{2}\\rho_p(\\Lambda) + \\rho_d\n$$\n将这些代入 $S$ 的定义中：\n$$\nS = \\frac{(2\\rho_p(\\Lambda) + \\rho_d) - (\\frac{1}{2}\\rho_p(\\Lambda) + \\rho_d)}{\\rho_p(\\Lambda) + \\rho_d} = \\frac{\\frac{3}{2}\\rho_p(\\Lambda)}{\\rho_p(\\Lambda) + \\rho_d}\n$$\n将 $\\rho_p(\\Lambda) = \\Lambda\\alpha$ 和 $\\rho_d = \\frac{\\beta_{\\mathrm{eff}}\\alpha}{\\alpha + \\lambda}$ 代回：\n$$\nS = \\frac{\\frac{3}{2}\\Lambda\\alpha}{\\Lambda\\alpha + \\frac{\\beta_{\\mathrm{eff}}\\alpha}{\\alpha+\\lambda}}\n$$\n我们已知以下数值参数：\n$\\beta_{\\mathrm{eff}} = 6.5 \\times 10^{-3}$\n$\\lambda = 8.0 \\times 10^{-2}\\,\\mathrm{s}^{-1}$\n$T = 2.0 \\times 10^{-1}\\,\\mathrm{s}$，得出 $\\alpha = 1/T = 5.0\\,\\mathrm{s}^{-1}$\n标称 $\\Lambda = 4.0 \\times 10^{-5}\\,\\mathrm{s}$\n\n首先，我们计算反应性的瞬发项和缓发项贡献的数值。\n在标称 $\\Lambda$ 下的瞬发项贡献为：\n$$\n\\rho_p(\\Lambda) = \\Lambda\\alpha = (4.0 \\times 10^{-5}\\,\\mathrm{s})(5.0\\,\\mathrm{s}^{-1}) = 20.0 \\times 10^{-5} = 2.0 \\times 10^{-4}\n$$\n缓发项贡献为：\n$$\n\\rho_d = \\frac{\\beta_{\\mathrm{eff}}\\alpha}{\\alpha+\\lambda} = \\frac{(6.5 \\times 10^{-3})(5.0\\,\\mathrm{s}^{-1})}{5.0\\,\\mathrm{s}^{-1} + 8.0 \\times 10^{-2}\\,\\mathrm{s}^{-1}} = \\frac{3.25 \\times 10^{-2}}{5.08} \\approx 6.3976378 \\times 10^{-3}\n$$\n现在我们计算 $S$ 的分子和分母。\n分子为：\n$$\n\\frac{3}{2}\\rho_p(\\Lambda) = \\frac{3}{2}(2.0 \\times 10^{-4}) = 3.0 \\times 10^{-4}\n$$\n分母是在标称 $\\Lambda$ 下的总反应性：\n$$\n\\rho(\\Lambda) = \\rho_p(\\Lambda) + \\rho_d = 2.0 \\times 10^{-4} + 6.3976378 \\times 10^{-3} = 6.5976378 \\times 10^{-3}\n$$\n最后，我们计算 $S$ 的值：\n$$\nS = \\frac{3.0 \\times 10^{-4}}{6.5976378 \\times 10^{-3}} \\approx 0.04547083\n$$\n问题要求结果四舍五入到四位有效数字。\n$$\nS \\approx 0.04547\n$$",
            "answer": "$$\n\\boxed{0.04547}\n$$"
        },
        {
            "introduction": "这项综合性练习旨在连接理论与实验实践。真实世界的测量数据从非完美——它们包含噪声，甚至可能存在离群值。本练习要求你开发一个完整的计算流程，从多组带有噪声的周期测量数据中推断反应性。这不仅需要应用物理模型，还要求你采用稳健的统计技术来处理不完美的数据，以确保最终结果的可靠性 。",
            "id": "4255245",
            "problem": "给定一个以纯数学术语表述的反应堆动力学建模任务。起点是具有 $M$ 个缓发中子组的均匀单点反应堆模型的点动力学方程 (PKE)，该方程控制中子布居和缓发中子先驱核浓度的时间演化。该问题的基本要素包括以下广为接受的定义：瞬发中子代时间 $\\Lambda$、总缓发中子份额 $\\beta = \\sum_{i=1}^{M} \\beta_{i}$、各组缓发中子份额 $\\beta_{i}$ 以及先驱核衰变常数 $\\lambda_{i}$。假设引入一个恒定且不随时间变化的反应性 $\\rho$，它产生以恒定反应堆周期为特征的指数功率变化。您的任务是：从第一性原理出发，推导连接反应性 $\\rho$ 和反应堆周期的关系；并实现一个数值稳健的算法，通过使用一阶灵敏度传播测量不确定度，从带噪声的周期测量值中推断 $\\rho$。该算法还必须能稳健地聚合多个独立测量值，以得出一个带有不确定度的 $\\rho$ 的单一最佳估计。\n\n您的推导必须从点动力学方程 (PKE) 开始，其对中子布居 $n(t)$ 和缓发中子先驱核浓度 $C_{i}(t)$ 的表达式如下：\n$$\\frac{d n(t)}{d t} = \\frac{\\rho - \\beta}{\\Lambda} n(t) + \\sum_{i=1}^{M} \\lambda_{i} C_{i}(t),$$\n$$\\frac{d C_{i}(t)}{d t} = \\frac{\\beta_{i}}{\\Lambda} n(t) - \\lambda_{i} C_{i}(t), \\quad i=1,\\dots,M.$$\n假设反应堆以指数模式响应，$n(t) = n_{0} e^{\\alpha t}$ 且 $C_{i}(t) = K_{i} e^{\\alpha t}$，推导连接反应性 $\\rho$ 和基本特征值 $\\alpha$ 的特征关系。通过 $\\alpha = 1/T$ 定义反应堆周期 $T$，并将 $\\rho$ 表示为 $T$、瞬发中子代时间 $\\Lambda$、缓发中子份额 $\\beta_{i}$ 和衰变常数 $\\lambda_{i}$ 的函数。然后，计算一阶导数 $\\frac{d\\rho}{dT}$，以获得反应性相对于周期的的一阶灵敏度。利用此灵敏度传播测量不确定度：对于周期测量值 $T_{j}$ 及其标准差 $\\sigma_{T_{j}}$（假设其足够小以使线性化成立），反应性不确定度 $\\sigma_{\\rho_{j}}$ 可近似为 $\\sigma_{\\rho_{j}} \\approx \\left|\\frac{d \\rho}{d T}\\big|_{T_{j}}\\right| \\sigma_{T_{j}}$。\n\n设计并实现一个稳健的聚合方法，将多个独立测量值 $\\{(T_{j}, \\sigma_{T_{j}})\\}_{j=1}^{N}$ 合并为单一的反应性估计及其不确定度。从使用权重 $w_{j}^{(0)} = 1/\\sigma_{\\rho_{j}}^{2}$ 的逆方差加权平均开始，然后通过应用Huber型重加权来提高对离群值的稳健性：令标准化残差为 $r_{j} = (\\rho_{j} - \\mu)/\\sigma_{\\rho_{j}}$，其中 $\\mu$ 是当前的加权平均值；定义Huber权重 $h_{j} = \\min\\left(1, \\frac{k}{|r_{j}|}\\right)$，其中阈值参数 $k$ 的选择旨在平衡效率和稳健性；将有效权重更新为 $w_{j} = h_{j}^{2}/\\sigma_{\\rho_{j}}^{2}$ 并迭代直至 $\\mu$ 收敛。将最终的组合不确定度报告为 $\\sigma_{\\mathrm{comb}} = \\sqrt{1/\\sum_{j} w_{j}}$。除了无量纲反应性 $\\rho$ 之外，还需通过除以总缓发中子份额 $\\beta$ 来计算以美元为单位的反应性，即 $\\rho_{\\$} = \\rho/\\beta$，及其不确定度 $\\sigma_{\\rho_{\\$}} = \\sigma_{\\mathrm{comb}}/\\beta$。\n\n单位：周期 $T$ 以秒（$\\mathrm{s}$）为单位，瞬发中子代时间 $\\Lambda$ 以秒（$\\mathrm{s}$）为单位，衰变常数 $\\lambda_{i}$ 以秒的倒数（$\\mathrm{s}^{-1}$）为单位，缓发中子份额 $\\beta_{i}$ 和反应性 $\\rho$ 为无量纲量，以美元为单位的反应性 $\\rho_{\\$}$ 也为无量纲量。角度单位在此不适用。所有类似百分比的量必须表示为小数（不使用百分号）。\n\n测试套件：使用以下参数集。对于每种情况，均给定了瞬发中子代时间 $\\Lambda$、缓发中子份额 $\\beta_{i}$ 和衰变常数 $\\lambda_{i}$，以及多个独立的周期测量值 $T_{j}$ 及其标准差 $\\sigma_{T_{j}}$。所有测量值均假定为独立的。\n\n- 情况 1（典型热中子反应堆，存在离群值）：\n  - $\\Lambda = 1.0 \\times 10^{-5}\\,\\mathrm{s}$。\n  - 六组缓发中子数据（类似Keepin）：\n    - $\\lambda = [0.0124, 0.0305, 0.111, 0.301, 1.14, 3.01]\\,\\mathrm{s}^{-1}$，\n    - $\\beta = [0.000215, 0.001424, 0.001274, 0.002568, 0.000748, 0.000273]$。\n  - 周期测量值（秒）： $T = [12.0, 9.0, 40.0, 11.5]$，\n    - 标准差（秒）： $\\sigma_{T} = [0.6, 0.45, 0.3, 0.5]$。\n- 情况 2（接近缓发临界，周期非常长）：\n  - $\\Lambda = 1.0 \\times 10^{-5}\\,\\mathrm{s}$。\n  - 缓发中子数据与情况1相同。\n  - 周期测量值（秒）： $T = [800.0, 1000.0, 1200.0]$，\n    - 标准差（秒）： $\\sigma_{T} = [20.0, 25.0, 30.0]$。\n- 情况 3（接近瞬发超临界，周期非常短）：\n  - $\\Lambda = 1.0 \\times 10^{-5}\\,\\mathrm{s}$。\n  - 缓发中子数据与情况1相同。\n  - 周期测量值（秒）： $T = [0.030, 0.028, 0.035]$，\n    - 标准差（秒）： $\\sigma_{T} = [0.0020, 0.0020, 0.0030]$。\n\n您的程序必须：\n- 从点动力学方程推导 $\\rho$ 和 $T$ 之间的关系，不得依赖捷径公式。\n- 实现 $\\rho(T)$ 及其导数 $\\frac{d\\rho}{dT}$ 的计算。\n- 使用一阶灵敏度将不确定度 $\\sigma_{T_{j}}$ 传播到 $\\sigma_{\\rho_{j}}$。\n- 在每种情况下，使用经Huber重加权（采用合理的阈值 $k$）改进的逆方差加权法来组合多个测量值（为 $k$ 选择一个固定的数值，并在您的解答中证明其合理性）。\n- 为每种情况生成最终输出，形式为四个浮点数：组合的无量纲反应性平均值 $\\rho$、其标准差 $\\sigma_{\\rho}$、组合的以美元为单位的反应性 $\\rho_{\\$}$ 及其标准差 $\\sigma_{\\rho_{\\$}}$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表形式的结果，每个内部列表对应一种情况，并按 $[\\rho, \\sigma_{\\rho}, \\rho_{\\$}, \\sigma_{\\rho_{\\$}}]$ 的顺序包含四个浮点数。例如： “[[r1,s1,d1,sd1],[r2,s2,d2,sd2],[r3,s3,d3,sd3]]”。所有数值均采用上述指定单位；不要包含任何附加文本。",
            "solution": "用户提供了一个问题，要求从反应堆物理学中推导并应用倒时方程，并结合一种稳健的统计方法进行数据聚合。\n\n### **问题验证**\n\n**步骤 1：提取已知条件**\n\n*   **控制方程（点动力学方程，PKE）：**\n    对于中子布居 $n(t)$ 和 $M$ 个缓发中子先驱核浓度 $C_i(t)$：\n    $$ \\frac{d n(t)}{d t} = \\frac{\\rho - \\beta}{\\Lambda} n(t) + \\sum_{i=1}^{M} \\lambda_{i} C_{i}(t) $$\n    $$ \\frac{d C_{i}(t)}{d t} = \\frac{\\beta_{i}}{\\Lambda} n(t) - \\lambda_{i} C_{i}(t), \\quad i=1,\\dots,M $$\n*   **定义：** $\\Lambda$ (瞬发中子代时间)，$\\beta = \\sum_{i=1}^{M} \\beta_{i}$ (总缓发中子份额)，$\\beta_i$ (各组缓发中子份额)，$\\lambda_i$ (先驱核衰变常数)，$\\rho$ (反应性)。\n*   **假设：** 反应堆以指数模式响应，$n(t) = n_{0} e^{\\alpha t}$ 且 $C_{i}(t) = K_{i} e^{\\alpha t}$，其中 $\\alpha = 1/T$ 且 $T$ 为稳定反应堆周期。\n*   **不确定度传播：** $\\sigma_{\\rho_{j}} \\approx \\left|\\frac{d \\rho}{d T}\\big|_{T_{j}}\\right| \\sigma_{T_{j}}$。\n*   **聚合方法：** 使用权重 $w_{j} = h_{j}^{2}/\\sigma_{\\rho_{j}}^{2}$ 的迭代Huber重加权逆方差平均，其中 $h_{j} = \\min\\left(1, \\frac{k}{|r_{j}|}\\right)$ 且 $r_{j} = (\\rho_{j} - \\mu)/\\sigma_{\\rho_{j}}$。\n*   **最终不确定度：** $\\sigma_{\\mathrm{comb}} = \\sqrt{1/\\sum_{j} w_{j}}$。\n*   **以美元为单位的反应性：** $\\rho_{\\$} = \\rho/\\beta$ 及 $\\sigma_{\\rho_{\\$}} = \\sigma_{\\mathrm{comb}}/\\beta$。\n*   **测试用例数据：** 提供了三种情况，每种情况都有一组周期测量值 $(T_j, \\sigma_{T_j})$ 和固定的动力学参数：\n    *   $\\Lambda = 1.0 \\times 10^{-5}\\,\\mathrm{s}$。\n    *   $\\lambda = [0.0124, 0.0305, 0.111, 0.301, 1.14, 3.01]\\,\\mathrm{s}^{-1}$。\n    *   $\\beta = [0.000215, 0.001424, 0.001274, 0.002568, 0.000748, 0.000273]$。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n该问题在科学上基于反应堆物理学中的标准点动力学模型。倒时方程的推导是该领域的一项基本练习。参数值（$\\Lambda$, $\\beta_i$, $\\lambda_i$）对于热中子反应堆是符合实际的。使用稳健统计学（Huber重加权）进行数据聚合是一种可靠且成熟的计量学实践。该问题是自洽的，提供了所有必要的数据和方程。要求选择并论证Huber参数 $k$ 是应用该方法的标准部分，并非疏漏。该问题是适定的、客观的且可通过计算验证的。验证清单中列出的缺陷均不存在。\n\n**步骤 3：结论与行动**\n\n该问题是**有效的**。将提供一个完整的、有理有据的解决方案。\n\n---\n\n### **基于原理的解决方案**\n\n目标是通过首先从点动力学方程 (PKE) 推导理论关系，然后应用稳健的统计方法来聚合多个带噪声的测量值，从而根据反应堆周期测量值 $T$ 确定反应性 $\\rho$。\n\n**1. 逆时方程的推导**\n\n逆时方程是关联反应性与稳定反应堆周期的特征代数方程。我们首先将假设的指数解 $n(t) = n_0 e^{\\alpha t}$ 和 $C_i(t) = K_i e^{\\alpha t}$ 代入PKE。\n\n时间导数为 $\\frac{dn}{dt} = \\alpha n_0 e^{\\alpha t} = \\alpha n(t)$ 和 $\\frac{dC_i}{dt} = \\alpha K_i e^{\\alpha t} = \\alpha C_i(t)$。\n\n代入先驱核方程：\n$$ \\alpha C_i(t) = \\frac{\\beta_i}{\\Lambda} n(t) - \\lambda_i C_i(t) $$\n我们求解先驱核浓度 $C_i(t)$，用中子布居 $n(t)$ 表示：\n$$ (\\alpha + \\lambda_i) C_i(t) = \\frac{\\beta_i}{\\Lambda} n(t) \\implies C_i(t) = \\frac{\\beta_i}{\\Lambda(\\alpha + \\lambda_i)} n(t) $$\n这表明，在稳定的指数增长期间，先驱核浓度与中子布居处于平衡状态。\n\n接下来，我们将此结果和 $n(t)$ 的导数代入中子布居方程：\n$$ \\alpha n(t) = \\frac{\\rho - \\beta}{\\Lambda} n(t) + \\sum_{i=1}^{M} \\lambda_i \\left( \\frac{\\beta_i}{\\Lambda(\\alpha + \\lambda_i)} n(t) \\right) $$\n由于 $n(t)$ 非零，我们可以将整个方程除以 $n(t)$ 并乘以 $\\Lambda$：\n$$ \\alpha \\Lambda = (\\rho - \\beta) + \\sum_{i=1}^{M} \\frac{\\lambda_i \\beta_i}{\\alpha + \\lambda_i} $$\n求解反应性 $\\rho$：\n$$ \\rho = \\alpha \\Lambda + \\beta - \\sum_{i=1}^{M} \\frac{\\lambda_i \\beta_i}{\\alpha + \\lambda_i} $$\n使用恒等式 $\\beta = \\sum_{i=1}^{M} \\beta_i$，我们可以合并求和项：\n$$ \\rho = \\alpha \\Lambda + \\sum_{i=1}^{M} \\beta_i - \\sum_{i=1}^{M} \\frac{\\lambda_i \\beta_i}{\\alpha + \\lambda_i} = \\alpha \\Lambda + \\sum_{i=1}^{M} \\left( \\beta_i - \\frac{\\lambda_i \\beta_i}{\\alpha + \\lambda_i} \\right) $$\n$$ \\rho = \\alpha \\Lambda + \\sum_{i=1}^{M} \\frac{\\beta_i(\\alpha + \\lambda_i) - \\lambda_i \\beta_i}{\\alpha + \\lambda_i} = \\alpha \\Lambda + \\sum_{i=1}^{M} \\frac{\\alpha \\beta_i}{\\alpha + \\lambda_i} $$\n这就是关联 $\\rho$ 与逆周期 $\\alpha$ 的逆时方程。为用周期 $T$ 表示，我们代入 $\\alpha = 1/T$：\n$$ \\rho(T) = \\frac{\\Lambda}{T} + \\sum_{i=1}^{M} \\frac{(1/T) \\beta_i}{(1/T) + \\lambda_i} = \\frac{\\Lambda}{T} + \\sum_{i=1}^{M} \\frac{\\beta_i}{1 + \\lambda_i T} $$\n这就是从反应堆周期计算反应性所需的函数。\n\n**2. 反应性对周期的灵敏度**\n\n为了传播不确定度，我们需要反应性相对于周期的一阶灵敏度 $\\frac{d\\rho}{dT}$。我们将 $\\rho(T)$ 的表达式对 $T$ 求导：\n$$ \\frac{d\\rho}{dT} = \\frac{d}{dT} \\left( \\frac{\\Lambda}{T} + \\sum_{i=1}^{M} \\frac{\\beta_i}{1 + \\lambda_i T} \\right) $$\n$$ \\frac{d\\rho}{dT} = -\\frac{\\Lambda}{T^2} + \\sum_{i=1}^{M} \\beta_i \\left( -1 \\cdot (1 + \\lambda_i T)^{-2} \\cdot \\lambda_i \\right) $$\n$$ \\frac{d\\rho}{dT} = -\\frac{\\Lambda}{T^2} - \\sum_{i=1}^{M} \\frac{\\lambda_i \\beta_i}{(1 + \\lambda_i T)^2} $$\n对于任何正周期 $T > 0$，两项都为负，因此 $\\frac{d\\rho}{dT}  0$。这证实了物理直觉：更长（更大）的周期对应于更小（正值更小）的反应性引入。\n\n**3. 不确定度传播与稳健聚合**\n\n给定一组 $N$ 个独立的反应堆周期测量值 $\\{(T_j, \\sigma_{T_j})\\}_{j=1}^{N}$，其中 $\\sigma_{T_j}$ 是第 $j$ 次测量的标准差，我们执行以下步骤：\n\n*   **单个反应性计算：** 对于每个测量值 $j$，我们计算相应的反应性 $\\rho_j = \\rho(T_j)$。\n*   **不确定度传播：** 假设不确定度 $\\sigma_{T_j}$ 很小，我们使用一阶泰勒展开来近似计算出的反应性的不确定度：\n    $$ \\sigma_{\\rho_j} \\approx \\left| \\frac{d\\rho}{dT}\\bigg|_{T=T_j} \\right| \\sigma_{T_j} $$\n*   **稳健聚合：** 虽然组合独立测量值的最优方法是逆方差加权平均，但该方法对离群值高度敏感。单个错误测量值的存在会显著扭曲结果。为缓解此问题，我们采用使用Huber型权重的迭代稳健估计程序。\n    1.  **初始化：** 该过程从标准的逆方差加权平均开始。初始权重为 $w_j^{(0)} = 1/\\sigma_{\\rho_j}^2$，平均反应性的初始估计值为 $\\mu^{(0)} = \\frac{\\sum_j w_j^{(0)} \\rho_j}{\\sum_j w_j^{(0)}}$。\n    2.  **迭代：** 对于迭代 $k=1, 2, \\dots$：\n        a. 计算每个测量值的标准化残差：$r_j = (\\rho_j - \\mu^{(k-1)})/\\sigma_{\\rho_j}$。\n        b. 计算Huber权重 $h_j = \\min\\left(1, \\frac{C}{|r_j|}\\right)$。对于接近均值的测量值（$|r_j| \\le C$），此权重等于 $1$，对于远离均值的测量值（$|r_j| > C$），此权重会减小。常数 $C$ 是一个调整参数。我们选择 $C=k=1.345$，这是一个标准值，它在数据服从正态分布时能提供95%的渐近效率，同时保证对离群值的稳健性。\n        c. 更新有效权重：$w_j^{(k)} = h_j^2 / \\sigma_{\\rho_j}^2$。Huber权重被平方，因为它们修改了分子中的均值，而方差（位于权重的分母中）受 $h^2$ 的影响。这是M估计量的一个特征。\n        d. 更新均值：$\\mu^{(k)} = \\frac{\\sum_j w_j^{(k)} \\rho_j}{\\sum_j w_j^{(k)}}$。\n        e. 迭代持续进行，直到 $\\mu$ 的变化小于一个很小的容差，例如 $|\\mu^{(k)} - \\mu^{(k-1)}|  10^{-12}$。\n*   **最终结果：** 收敛后的平均值 $\\rho_{\\mathrm{comb}} = \\mu_{\\mathrm{final}}$ 是反应性的稳健估计。此组合估计的不确定度由 $\\sigma_{\\mathrm{comb}} = \\sqrt{1/\\sum_j w_j^{\\mathrm{final}}}$ 给出。\n*   **以美元为单位的反应性：** 反应性通常以“美元”（$\\$$）表示，这是一个用总缓发中子份额 $\\beta$ 归一化的单位。$1\\$$ 的反应性（$\\rho = \\beta$）是瞬发临界的阈值。最终的反应性及其不确定度被转换为美元单位：\n    $$ \\rho_{\\$} = \\frac{\\rho_{\\mathrm{comb}}}{\\beta}, \\quad \\sigma_{\\rho_{\\$}} = \\frac{\\sigma_{\\mathrm{comb}}}{\\beta} $$\n\n这就完成了解决该问题所需的理论和算法框架。具体实现将遵循这些推导出的公式和程序。\n```python\n#\n# Execution Environment:\n# language: Python\n# version: 3.12\n# libraries:\n#     - name: numpy\n#       version: 1.23.5\n#     - name: scipy\n#       version: 1.11.4 (although only numpy is used)\n#\nimport numpy as np\n\n# Global constants for reactor kinetics based on the problem statement.\n# These values are typical for a U-235 fueled thermal reactor.\nLAMBDA_G = 1.0e-5  # Prompt neutron generation time in seconds.\nDECAY_CONSTANTS = np.array([0.0124, 0.0305, 0.111, 0.301, 1.14, 3.01])  # Decay constants (s^-1).\nDELAYED_FRACTIONS = np.array([0.000215, 0.001424, 0.001274, 0.002568, 0.000748, 0.000273])  # Delayed neutron group fractions.\nBETA_TOTAL = np.sum(DELAYED_FRACTIONS)  # Total delayed neutron fraction.\n\n# Huber reweighting tuning parameter.\n# k=1.345 provides 95% efficiency for normally distributed data while ensuring robustness.\nHUBER_K = 1.345\n\ndef rho_from_T(T, lambda_g, beta_i, lambda_i):\n    \"\"\"\n    Calculates reactivity (rho) from the reactor period (T) using the inhour equation.\n    rho(T) = Lambda/T + sum(beta_i / (1 + lambda_i * T))\n    \"\"\"\n    # Ensure T is a numpy array for vectorized operations\n    T = np.asarray(T)\n    # The first term is from the prompt neutrons\n    term1 = lambda_g / T\n    # The second term is the sum over all delayed neutron groups\n    # Broadcasting T and lambda_i: (M,) * (N,) -> (M, N) where N is number of T values\n    term2 = np.sum(beta_i[:, np.newaxis] / (1.0 + lambda_i[:, np.newaxis] * T), axis=0)\n    return term1 + term2\n\ndef d_rho_d_T(T, lambda_g, beta_i, lambda_i):\n    \"\"\"\n    Calculates the sensitivity of reactivity to the period (d(rho)/dT).\n    d(rho)/dT = -Lambda/T^2 - sum(lambda_i * beta_i / (1 + lambda_i * T)^2)\n    \"\"\"\n    T = np.asarray(T)\n    term1 = -lambda_g / (T**2)\n    # Broadcasting for the sum over delayed groups\n    term2 = -np.sum((lambda_i * beta_i)[:, np.newaxis] / (1.0 + lambda_i[:, np.newaxis] * T)**2, axis=0)\n    return term1 + term2\n\ndef process_case(T_meas, sigma_T_meas):\n    \"\"\"\n    Processes a set of period measurements to find the combined reactivity estimate and its uncertainty.\n    \"\"\"\n    T_meas = np.array(T_meas, dtype=float)\n    sigma_T_meas = np.array(sigma_T_meas, dtype=float)\n\n    # 1. Calculate individual reactivity values and their uncertainties\n    rho_j = rho_from_T(T_meas, LAMBDA_G, DELAYED_FRACTIONS, DECAY_CONSTANTS)\n    sensitivity_j = d_rho_d_T(T_meas, LAMBDA_G, DELAYED_FRACTIONS, DECAY_CONSTANTS)\n    sigma_rho_j = np.abs(sensitivity_j) * sigma_T_meas\n\n    # 2. Perform iterative Huber reweighting for robust aggregation\n    # Initial guess using standard inverse-variance weighting\n    w_j = 1.0 / sigma_rho_j**2\n    mu = np.sum(w_j * rho_j) / np.sum(w_j)\n\n    max_iter = 100\n    tolerance = 1.0e-12  # Convergence criterion\n\n    for _ in range(max_iter):\n        mu_old = mu\n        \n        # Calculate standardized residuals. Handle mu == rho_j case.\n        residuals = (rho_j - mu) / sigma_rho_j\n        \n        # Calculate Huber weights. Use errstate to handle potential division by zero\n        # if a residual is exactly zero. In that case, the weight should be 1.\n        with np.errstate(divide='ignore'):\n            # k/|r| will be 'inf' if r is 0. np.minimum(1.0, np.inf) correctly yields 1.0.\n            huber_weights = np.minimum(1.0, HUBER_K / np.abs(residuals))\n        \n        # Update effective weights\n        w_j = huber_weights**2 / sigma_rho_j**2\n        \n        # Update mean\n        mu = np.sum(w_j * rho_j) / np.sum(w_j)\n        \n        if np.abs(mu - mu_old)  tolerance:\n            break\n\n    # 3. Calculate final combined results\n    rho_comb = mu\n    sigma_comb = np.sqrt(1.0 / np.sum(w_j))\n    \n    # Convert to reactivity in dollars\n    rho_dollars = rho_comb / BETA_TOTAL\n    sigma_dollars = sigma_comb / BETA_TOTAL\n    \n    return [rho_comb, sigma_comb, rho_dollars, sigma_dollars]\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and generate the final output.\n    \"\"\"\n    test_cases = [\n        # Case 1: Typical thermal reactor, outlier present\n        (\n            [12.0, 9.0, 40.0, 11.5],\n            [0.6, 0.45, 0.3, 0.5]\n        ),\n        # Case 2: Near delayed critical, very long periods\n        (\n            [800.0, 1000.0, 1200.0],\n            [20.0, 25.0, 30.0]\n        ),\n        # Case 3: Near prompt supercritical, very short periods\n        (\n            [0.030, 0.028, 0.035],\n            [0.0020, 0.0020, 0.0030]\n        ),\n    ]\n\n    results = []\n    for t_meas, sigma_t_meas in test_cases:\n        result = process_case(t_meas, sigma_t_meas)\n        results.append(result)\n\n    # Format the final output string exactly as required, without extra spaces.\n    case_strings = []\n    for res in results:\n        case_strings.append(f\"[{','.join(map(str, res))}]\")\n    \n    final_output = f\"[{','.join(case_strings)}]\"\n    # print(final_output) # Suppress print for library usage\n    return final_output\n\n# This is for execution in a context where the output is captured.\n# In a simple script, print(solve()) would be used.\n# result_string = solve()\n```",
            "answer": "[[0.00346399121175782,8.814272895689115e-05,0.5329217248858185,0.013560419839521715],[0.0001089279589337033,1.353343169055856e-05,0.016758147528262047,0.002082066413932086],[0.005221086055106187,0.0003052601264858902,0.803244008477875,0.04696309638244464]]"
        }
    ]
}