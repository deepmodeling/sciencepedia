{
    "hands_on_practices": [
        {
            "introduction": "这项实践是您从计算层面掌握多普勒展宽的基石。它要求您实现将一个共振截面与热运动原子核进行卷积，并将结果与简单的线性插值方法进行对比，后者是反应堆程序中常用的近似技术。这项练习不仅在于计算出精确的数值，更在于揭示在反应堆模拟中，精确性与计算成本之间的权衡关系。",
            "id": "4239879",
            "problem": "当请求的温度在列表库中不存在时，核反应堆模拟必须实时计算中子截面的温度展宽。考虑一个在零温度下由单能级 Breit-Wigner (SLBW) 形式描述的孤立共振。目标是计算在请求温度下的多普勒展宽截面，并将其与两个列表温度之间的朴素线性插值进行比较。制定并实现一个程序，对于给定测试套件中的每个案例，使用自由气体多普勒核计算共振能量处的展宽截面，并量化其与线性插值的偏差。\n\n起点和定义：\n- SLBW 零温度共振截面被建模为洛伦兹函数\n$$\n\\sigma_0(E) = \\sigma_\\text{peak} \\frac{(\\Gamma/2)^2}{(E - E_r)^2 + (\\Gamma/2)^2},\n$$\n其中，$E$ 是能量，单位为电子伏特 (eV)，$E_r$ 是共振能量，单位为 eV，$\\Gamma$ 是总宽度，单位为 eV，$\\sigma_\\text{peak}$ 是在 $E = E_r$ 处的峰值截面，单位为靶恩。\n- 假设靶核的热运动服从麦克斯韦-玻尔兹曼分布，导致多普勒展宽，其在能量平方根（也称为 $u$）空间中表示为高斯卷积。定义 $u = \\sqrt{E}$，以及自由气体多普勒核\n$$\nG(u,u';T,A) = \\frac{1}{\\sqrt{\\pi}\\,\\mu(T,A)} \\exp\\!\\left(-\\frac{(u'-u)^2}{\\mu(T,A)^2}\\right),\n$$\n其中，$u$ 空间中的核宽度参数为\n$$\n\\mu(T,A) = \\sqrt{\\frac{\\theta(T)}{A}},\n\\quad\n\\theta(T) = k_B T \\text{ in eV},\n$$\n$k_B$ 是玻尔兹曼常数，$A$ 是靶核与中子的质量比（无量纲）。温度 $T$ 下的展宽截面为\n$$\n\\sigma(E,T) = \\int_0^\\infty \\sigma_0(u'^2)\\, G(u,u';T,A)\\, \\mathrm{d}u'.\n$$\n- 所考虑的温度为 $T_1 = 800$ 开尔文 (K)，$T = 873$ K，以及 $T_2 = 900$ K。玻尔兹曼常数必须使用电子伏特每开尔文单位，即 $k_B = 8.617333262145\\times 10^{-5}$ eV/K。\n- 对于每个测试案例，截面待求值的能量为 $E = E_r$。\n\n需实现的任务：\n1. 使用上述基本原理，通过实时多普勒展宽（$u$ 空间中的高斯卷积）计算 $\\sigma(E_r, T)$。\n2. 类似地计算 $\\sigma(E_r, T_1)$ 和 $\\sigma(E_r, T_2)$。\n3. 计算在 $T$ 处，两个列表温度之间的线性插值：\n$$\n\\sigma_\\text{lin}(E_r, T) = \\sigma(E_r, T_1) + \\frac{T - T_1}{T_2 - T_1}\\left[\\sigma(E_r, T_2) - \\sigma(E_r, T_1)\\right].\n$$\n4. 使用以下公式量化在 $E = E_r$ 处实时展宽值与线性插值之间的差异：\n   - 绝对差，单位为靶恩，\n   $$\n   \\Delta_\\text{abs} = \\sigma(E_r, T) - \\sigma_\\text{lin}(E_r, T),\n   $$\n   - 相对差，以小数表示，\n   $$\n   \\Delta_\\text{frac} = \\frac{\\Delta_\\text{abs}}{\\sigma(E_r, T)}.\n   $$\n\n物理单位和数值报告：\n- 能量 $E$、$E_r$ 和宽度 $\\Gamma$ 的单位是电子伏特 (eV)。\n- 温度 $T$ 的单位是开尔文 (K)。\n- 截面和差异 $\\Delta_\\text{abs}$ 的单位是靶恩。\n- 相对差 $\\Delta_\\text{frac}$ 必须报告为小数（无百分号）。\n- 报告所有浮点输出，四舍五入到六位小数。\n\n测试套件：\n对于每个参数集，使用指定的 $A$、$\\Gamma$ 和 $\\sigma_\\text{peak}$，在 $E = E_r$ 处进行评估：\n- 案例 1 (重核素，窄共振，高峰值): $A = 238$, $E_r = 6.670$ eV, $\\Gamma = 0.030$ eV, $\\sigma_\\text{peak} = 3000.0$ 靶恩。\n- 案例 2 (中等质量，中等宽度): $A = 56$, $E_r = 2.000$ eV, $\\Gamma = 0.300$ eV, $\\sigma_\\text{peak} = 100.0$ 靶恩。\n- 案例 3 (轻核素，宽共振): $A = 1$, $E_r = 1.000$ eV, $\\Gamma = 0.500$ eV, $\\sigma_\\text{peak} = 20.0$ 靶恩。\n- 案例 4 (重核素，极窄共振，非常高峰值): $A = 238$, $E_r = 0.500$ eV, $\\Gamma = 0.001$ eV, $\\sigma_\\text{peak} = 10000.0$ 靶恩。\n\n算法要求：\n- 在 $u$ 空间中实现高斯卷积积分，其中 $u = \\sqrt{E}$ 和 $\\mu(T,A) = \\sqrt{\\theta(T)/A}$，$\\theta(T) = k_B T$（单位 eV）。积分范围为 $u' \\in [0,\\infty)$；为保证数值稳定性和效率，可将积分范围截断为 $u' \\in [\\max(0,u-8\\mu), u+8\\mu]$，因为高斯函数在 $\\pm 8\\mu$ 之外的尾部可以忽略不计。\n- 使用适合平滑高斯加权洛伦兹函数的稳健数值积分方法。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔的结果列表。每个测试案例贡献一个双元素列表 $[\\Delta_\\text{abs}, \\Delta_\\text{frac}]$，顺序如此。例如，\n$[[\\Delta_\\text{abs,1},\\Delta_\\text{frac,1}],[\\Delta_\\text{abs,2},\\Delta_\\text{frac,2}],\\dots]$。",
            "solution": "该问题要求计算单个共振的中子多普勒展宽截面，并与线性温度插值进行比较。该过程基于核反应堆物理的既定原理。\n\n计算的基础是孤立共振在绝对零度（$T=0$ K）下的单能级 Breit-Wigner (SLBW) 公式，由一个洛伦兹函数给出：\n$$\n\\sigma_0(E) = \\sigma_\\text{peak} \\frac{(\\Gamma/2)^2}{(E - E_r)^2 + (\\Gamma/2)^2}\n$$\n在这里，$E$ 是中子能量，$E_r$ 是共振中心的能量，$\\Gamma$ 是总共振宽度，$\\sigma_\\text{peak}$ 是在 $E = E_r$ 处出现的最大截面值。所有能量单位均为电子伏特 (eV)，截面单位为靶恩。\n\n在有限温度下，靶核处于热运动中。在自由气体模型中，这种运动由速度的麦克斯韦-玻尔兹曼分布描述。其对观测截面的影响是一种展宽现象，数学上表示为零温截面与多普勒核的卷积。这种卷积最方便地在能量平方根空间（或称 $u$ 空间）中表示，其中 $u = \\sqrt{E}$。在温度 $T$ 下的展宽截面 $\\sigma(E,T)$ 由以下公式给出：\n$$\n\\sigma(E,T) = \\int_0^\\infty \\sigma_0(u'^2)\\, G(u,u';T,A)\\, \\mathrm{d}u'\n$$\n函数 $G(u,u';T,A)$ 是自由气体多普勒核，它在 $u$ 空间中是一个高斯函数：\n$$\nG(u,u';T,A) = \\frac{1}{\\sqrt{\\pi}\\,\\mu(T,A)} \\exp\\!\\left(-\\frac{(u'-u)^2}{\\mu(T,A)^2}\\right)\n$$\n高斯核的宽度参数 $\\mu(T,A)$ 包含了热运动的物理学：\n$$\n\\mu(T,A) = \\sqrt{\\frac{\\theta(T)}{A}}\n$$\n其中 $\\theta(T) = k_B T$ 是热能，单位为 eV，$k_B$ 是玻尔兹曼常数 ($8.617333262145\\times 10^{-5}$ eV/K)，$A$ 是靶核质量与中子质量之比。核中的变量 $u$ 对应于评估能量 $E$（即 $u=\\sqrt{E}$），而 $u'$ 是积分变量，代表进行卷积的整个能量谱。\n\n问题要求在共振能量 $E = E_r$ 处进行评估。因此，我们设置 $u = u_r = \\sqrt{E_r}$。对于给定温度 $T$，需要计算的积分为：\n$$\n\\sigma(E_r,T) = \\int_0^\\infty \\sigma_0(u'^2)\\, G(u_r,u';T,A)\\, \\mathrm{d}u'\n$$\n代入 $\\sigma_0$ 和 $G$ 的表达式，被积函数变为：\n$$\n\\text{Integrand}(u') = \\left( \\sigma_\\text{peak} \\frac{(\\Gamma/2)^2}{(u'^2 - E_r)^2 + (\\Gamma/2)^2} \\right) \\left( \\frac{1}{\\sqrt{\\pi}\\,\\mu(T,A)} \\exp\\!\\left(-\\frac{(u'-u_r)^2}{\\mu(T,A)^2}\\right) \\right)\n$$\n这个定积分必须进行数值计算。像 Python 中 `scipy.integrate.quad` 提供的自适应求积等稳健方法适合此任务。积分在 $u'$ 从 $0$ 到 $\\infty$ 的范围内进行。为了数值效率，问题允许将积分范围截断为 $[\\max(0, u_r - 8\\mu), u_r + 8\\mu]$，因为高斯核在此区间外的贡献可以忽略不计。\n\n对于每个测试案例，整体算法流程如下：\n1.  对于三个温度 $T_1 = 800$ K、$T = 873$ K 和 $T_2 = 900$ K 中的每一个，通过数值求解上面定义的卷积积分，计算共振峰值处的相应展宽截面 $\\sigma(E_r, T_1)$、$\\sigma(E_r, T)$ 和 $\\sigma(E_r, T_2)$。\n\n2.  使用在包围温度 $T_1$ 和 $T_2$ 处计算的值，计算在 $T=873$ K 处的线性插值截面：\n$$\n\\sigma_\\text{lin}(E_r, T) = \\sigma(E_r, T_1) + \\frac{T - T_1}{T_2 - T_1}\\left[\\sigma(E_r, T_2) - \\sigma(E_r, T_1)\\right]\n$$\n\n3.  通过计算精确展宽值与插值之间的绝对差和相对差，来量化这种线性近似引入的误差：\n    -   绝对差: $\\Delta_\\text{abs} = \\sigma(E_r, T) - \\sigma_\\text{lin}(E_r, T)$\n    -   相对差: $\\Delta_\\text{frac} = \\frac{\\Delta_\\text{abs}}{\\sigma(E_r, T)}$\n\n4.  对于每个测试案例，收集最终结果 $\\Delta_\\text{abs}$ 和 $\\Delta_\\text{frac}$，并以六位小数的精度报告。此分析展示了截面对温度的非线性依赖关系，以及某些核模拟情境中使用的简单插值方案可能存在的不准确性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the Doppler broadening problem for the given test cases.\n    \"\"\"\n    \n    # Define constants and fixed temperatures\n    KB = 8.617333262145e-5  # Boltzmann constant in eV/K\n    T1 = 800.0  # K\n    T = 873.0   # K\n    T2 = 900.0  # K\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (A, Er, Gamma, sigma_peak)\n        (238.0, 6.670, 0.030, 3000.0),\n        (56.0, 2.000, 0.300, 100.0),\n        (1.0, 1.000, 0.500, 20.0),\n        (238.0, 0.500, 0.001, 10000.0),\n    ]\n\n    # List to store the results for all cases\n    all_results = []\n\n    def zero_temp_xs(u_prime_sq, Er, Gamma, sigma_peak):\n        \"\"\"\n        Calculates the zero-temperature SLBW cross section.\n        u_prime_sq is u'^2, which is the energy E.\n        \"\"\"\n        half_gamma_sq = (Gamma / 2.0)**2\n        return sigma_peak * half_gamma_sq / ((u_prime_sq - Er)**2 + half_gamma_sq)\n\n    def calculate_broadened_xs(Er, Gamma, sigma_peak, A, temp):\n        \"\"\"\n        Computes the Doppler-broadened cross section at E=Er for a given temperature.\n        \"\"\"\n        # Thermal energy theta\n        theta = KB * temp\n        \n        # Kernel width parameter mu\n        mu = np.sqrt(theta / A)\n        \n        # u-space evaluation point\n        u_r = np.sqrt(Er)\n        \n        # Define the integrand for the convolution\n        def integrand(u_prime):\n            # Gaussian kernel G(u_r, u_prime; T, A)\n            gaussian_kernel = (1.0 / (np.sqrt(np.pi) * mu)) * np.exp(-((u_prime - u_r)**2) / mu**2)\n            \n            # Zero-temperature cross section sigma_0(u_prime^2)\n            sigma_0_val = zero_temp_xs(u_prime**2, Er, Gamma, sigma_peak)\n            \n            return sigma_0_val * gaussian_kernel\n\n        # Integration limits\n        u_min = max(0.0, u_r - 8.0 * mu)\n        u_max = u_r + 8.0 * mu\n        \n        # Perform numerical integration\n        result, _ = integrate.quad(integrand, u_min, u_max, epsabs=1e-12, epsrel=1e-12)\n        \n        return result\n\n    for case in test_cases:\n        A, Er, Gamma, sigma_peak = case\n        \n        # 1. Compute on-the-fly broadened cross section at T\n        sigma_T = calculate_broadened_xs(Er, Gamma, sigma_peak, A, T)\n        \n        # 2. Compute broadened cross sections at T1 and T2\n        sigma_T1 = calculate_broadened_xs(Er, Gamma, sigma_peak, A, T1)\n        sigma_T2 = calculate_broadened_xs(Er, Gamma, sigma_peak, A, T2)\n        \n        # 3. Compute the linearly interpolated value\n        sigma_lin = sigma_T1 + (T - T1) / (T2 - T1) * (sigma_T2 - sigma_T1)\n        \n        # 4. Quantify the differences\n        delta_abs = sigma_T - sigma_lin\n        delta_frac = delta_abs / sigma_T if sigma_T != 0 else 0.0\n        \n        # Store results rounded to six decimal places\n        all_results.append(f\"[{delta_abs:.6f},{delta_frac:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在卷积概念的基础上，这个解析练习将深入探讨多普勒展宽中一个更微妙的方面。展宽核仁的宽度并非恒定，而是依赖于中子能量本身。这项实践将挑战您推导这种能量依赖性如何导致观测到的共振峰发生移动，从而揭示一个非直观的物理效应，并加深您对自由气体模型中各项假设的理解。",
            "id": "4239877",
            "problem": "在许多反应堆物理程序中，在线多普勒展宽是通过将内禀单能级共振线形与一个从靶核的 Maxwell–Boltzmann 速度分布推导出的、与温度相关的核进行卷积来模拟的。考虑一个以能量 $E_r$ 为中心的单个孤立共振，其内禀（零温）线形由一个半高全宽的一半 (HWHM) 为 $\\gamma$ 的洛伦兹函数模拟，\n$$\nS(E) \\propto \\frac{1}{(E - E_r)^2 + \\gamma^2}.\n$$\n温度为 $T$ 时的多普勒展宽截面被模拟为卷积\n$$\n\\sigma_b(E;T) \\;=\\; \\int_{-\\infty}^{\\infty} S(E')\\,K_T(E,E')\\,\\mathrm{d}E',\n$$\n其中自由气体核由一个以能量为中心、标准差为 $\\sigma(E)$ 的高斯函数近似，\n$$\nK_T(E,E') \\;=\\; \\frac{1}{\\sqrt{2\\pi}\\,\\sigma(E)} \\exp\\!\\left(-\\frac{(E' - E)^2}{2\\,\\sigma(E)^2}\\right),\n$$\n其方差与能量相关\n$$\n\\sigma(E)^2 \\;=\\; \\frac{2\\,k_B\\,T}{A}\\,E.\n$$\n这里，$k_B$ 是 Boltzmann 常数，$A$ 是靶核与中子的无量纲质量比（$A = M/m_n$）。假设在渐近区域中，$\\gamma \\ll E_r$ 且 $\\sigma(E_r) \\ll E_r$，因此 $S(E)$ 在 $E_r$ 的能量尺度上是局域对称且缓变的，并只保留由 $\\sigma(E)$ 的能量依赖性引起的首个非零贡献。\n\n计算由上述卷积引起的 $\\sigma_b(E;T)$ 的表观峰值能量 $E_{\\text{peak}}$ 相对于 $E_r$ 的位移 $\\delta E_{\\text{peak}} = E_{\\text{peak}} - E_r$ 的领头阶，用 $k_B$、$T$ 和 $A$ 表示。此外，确定在此设置下 Voigt 峰（洛伦兹函数和高斯函数的卷积）与 $E_r$ 精确对齐的条件。请提供 $\\delta E_{\\text{peak}}$ 关于 $k_B$、$T$ 和 $A$ 的闭式解析表达式作为最终答案。您无需代入数值；将 $k_B T$ 视为一个能量单位。",
            "solution": "该问题的目标是推导由能量依赖的多普勒展宽核引起的共振峰位移。峰值能量 $E_{\\text{peak}}$ 是展宽截面 $\\sigma_b(E;T)$ 取极大值时的能量点，即满足条件 $\\frac{d\\sigma_b}{dE}\\big|_{E=E_{\\text{peak}}} = 0$。\n\n展宽截面由卷积积分定义：\n$$ \\sigma_b(E;T) = \\int_{-\\infty}^{\\infty} S(E') \\, K_T(E, E') \\, \\mathrm{d}E' $$\n其中 $S(E')$ 是以 $E_r$ 为中心的对称洛伦兹线型，而核 $K_T(E, E')$ 是一个高斯函数，其方差 $\\sigma(E)^2 = \\frac{2k_B T}{A}E$ 随能量 $E$ 变化。\n\n为了找到峰值，我们对 $\\sigma_b(E;T)$ 关于 $E$ 求导。由于积分核依赖于 $E$，我们必须在积分号下求导：\n$$ \\frac{d\\sigma_b}{dE} = \\int_{-\\infty}^{\\infty} S(E') \\frac{\\partial K_T(E, E')}{\\partial E} \\mathrm{d}E' $$\n核的导数可以通过链式法则求得：\n$$ \\frac{\\partial K_T(E, E')}{\\partial E} = K_T(E, E') \\left[ \\frac{E' - E}{\\sigma(E)^2} + \\left( \\frac{(E' - E)^2}{\\sigma(E)^2} - 1 \\right) \\frac{d\\ln\\sigma}{dE} \\right] $$\n其中 $\\frac{d\\ln\\sigma}{dE} = \\frac{1}{2E}$。\n\n假设峰值位移 $\\delta E_{\\text{peak}} = E_{\\text{peak}} - E_r$ 很小，我们可以对导数条件在 $E=E_r$ 附近进行一阶泰勒展开：\n$$ \\frac{d\\sigma_b}{dE}\\bigg|_{E_r + \\delta E_{\\text{peak}}} \\approx \\frac{d\\sigma_b}{dE}\\bigg|_{E_r} + \\delta E_{\\text{peak}} \\frac{d^2\\sigma_b}{dE^2}\\bigg|_{E_r} = 0 $$\n由此解出位移的领头阶近似：\n$$ \\delta E_{\\text{peak}} \\approx - \\frac{(d\\sigma_b/dE)|_{E=E_r}}{(d^2\\sigma_b/dE^2)|_{E=E_r}} $$\n我们分别计算分子和分母。\n\n**分子：一阶导数**\n在 $E=E_r$ 处计算一阶导数，其中 $\\sigma_r = \\sigma(E_r)$：\n$$ \\frac{d\\sigma_b}{dE}\\bigg|_{E=E_r} = \\int S(E') K_T(E_r, E') \\left[ \\frac{E' - E_r}{\\sigma_r^2} + \\left( \\frac{(E' - E_r)^2}{\\sigma_r^2} - 1 \\right) \\frac{1}{2E_r} \\right] \\mathrm{d}E' $$\n由于 $S(E')$ 和 $K_T(E_r, E')$ 相对于 $E_r$ 都是对称（偶）函数，方括号中第一项（奇函数）的积分为零。因此，只有第二项有贡献。利用高斯函数二阶导数的性质，我们可将积分重写为：\n$$ \\frac{d\\sigma_b}{dE}\\bigg|_{E=E_r} = \\frac{1}{2E_r} \\int S(E_r+x') K_T(E_r, E_r+x') \\left( \\frac{x'^2}{\\sigma_r^2} - 1 \\right) \\mathrm{d}x' = \\frac{\\sigma_r^2}{2E_r} \\int \\frac{d^2S(E_r+x')}{dx'^2} K_T(E_r, E_r+x') \\mathrm{d}x' $$\n我们将这个积命名为 $I_2$。于是，分子为 $\\frac{\\sigma_r^2}{2E_r}I_2$。\n\n**分母：二阶导数**\n分母是二阶导数 $\\frac{d^2\\sigma_b}{dE^2}\\big|_{E_r}$。问题要求的是位移的领头阶，而位移本身是由核的能量依赖性引起的一阶效应。因此，峰的曲率（二阶导数）应在零阶近似下计算，即假设核宽度为常数 $\\sigma_r$。在这种情况下，$\\sigma_b(E)$ 是一个标准的卷积，其二阶导数在 $E_r$ 处为：\n$$ \\frac{d^2\\sigma_b}{dE^2}\\bigg|_{E_r} = \\int \\frac{d^2S(E_r+x')}{dx'^2} K_T(E_r, E_r+x') \\mathrm{d}x' = I_2 $$\n分母恰好就是积分 $I_2$。\n\n**峰值位移**\n将分子和分母代入位移表达式中，积分项 $I_2$ 被消去：\n$$ \\delta E_{\\text{peak}} \\approx - \\frac{(\\sigma_r^2 / (2E_r)) I_2}{I_2} = - \\frac{\\sigma_r^2}{2E_r} $$\n这个结果表明，位移与洛伦兹线型的具体宽度 $\\gamma$ 无关。\n\n最后，代入给定的方差表达式 $\\sigma(E)^2 = \\frac{2k_B T}{A}E$，在 $E=E_r$ 处有 $\\sigma_r^2 = \\frac{2k_B T}{A} E_r$。代入位移公式：\n$$ \\delta E_{\\text{peak}} = - \\frac{1}{2E_r} \\left( \\frac{2k_B T}{A} E_r \\right) = - \\frac{k_B T}{A} $$\n这就是所求的峰值位移的闭式解析表达式。位移是负值，意味着由于多普勒核的宽度随能量增加，展宽峰的峰值向较低能量移动。\n\n关于第二个问题，峰与 $E_r$ 精确对齐的条件是位移 $\\delta E_{\\text{peak}} = 0$。从我们的最终表达式来看，由于 $k_B$ 和 $A$ 均为正值常数，位移为零的唯一条件是绝对温度 $T=0$。在物理上，这意味着没有热运动，因此没有多普勒展宽，也就没有相关的峰值位移。",
            "answer": "$$\\boxed{-\\frac{k_B T}{A}}$$"
        },
        {
            "introduction": "在掌握了多普勒展宽的计算方法及其物理细节之后，我们转向一个关键应用：不确定性量化。来自核数据库的基本共振参数（如 $E_r$, $\\Gamma$, $\\Gamma_\\gamma$）并非完美精确。本练习将指导您进行敏感性分析，以确定这些参数的不确定性如何通过多普勒展宽过程传播并最终影响截面数值，这项技能对于评估反应堆物理计算的可靠性至关重要。",
            "id": "4222810",
            "problem": "在可分辨共振区，单个孤立的中子辐射俘获共振由单能级Breit–Wigner形式建模。设未展宽的俘获截面为\n$$\n\\sigma_{\\text{bare}}(E) \\;=\\; C\\,\\frac{\\Gamma_{n}\\,\\Gamma_{\\gamma}}{(E-E_{0})^{2}+\\left(\\frac{\\Gamma}{2}\\right)^{2}},\n$$\n其中 $C$ 是一个随能量变化的预因子，在共振峰附近变化缓慢（包含了运动学和统计学因子），$E$ 是中子能量，$E_{0}$ 是共振能量，$\\Gamma$ 是总宽度，$\\Gamma_{n}$ 是中子宽度（假定在所关注的极窄能量区间内为常数），$\\Gamma_{\\gamma}$ 是辐射俘获宽度。温度为 $T$ 时的多普勒展宽截面由能量上的高斯卷积定义，\n$$\n\\sigma_{D}(E,T) \\;=\\; \\int_{-\\infty}^{\\infty} \\sigma_{\\text{bare}}(E')\\, \\frac{1}{\\sqrt{\\pi}\\,\\Delta}\\,\\exp\\!\\left(-\\frac{(E'-E)^{2}}{\\Delta^{2}}\\right)\\, \\mathrm{d}E',\n$$\n其中 $\\Delta=\\Delta(T,E)$ 是以能量为单位的多普勒宽度，此处在窄线型上视为给定的正常数。考虑 $\\sigma_{D}(E,T)$ 相对于参数 $p$ 的局部无量纲（对数）灵敏度，\n$$\nS_{p}(E,T) \\;=\\; \\frac{p}{\\sigma_{D}(E,T)}\\,\\frac{\\partial \\sigma_{D}(E,T)}{\\partial p}.\n$$\n假设 $C$ 和 $\\Gamma_{n}$ 已知且固定，并将 $\\Gamma$ 和 $\\Gamma_{\\gamma}$ 视为独立的不确定性输入。\n\n仅从上述定义以及高斯-洛伦兹卷积的标准性质出发，推导在共振峰 $E=E_{0}$ 处求值的 $S_{E_{0}}(E_{0},T)$、$S_{\\Gamma}(E_{0},T)$ 和 $S_{\\Gamma_{\\gamma}}(E_{0},T)$ 的闭式表达式，并用 $\\Gamma$ 和 $\\Delta$ 表示。然后，对于数值算例\n$$\nE_{0}=6.670~\\text{eV},\\quad \\Gamma=0.0250~\\text{eV},\\quad \\Gamma_{\\gamma}=0.0230~\\text{eV},\\quad \\Delta=0.1000~\\text{eV},\n$$\n计算 $S_{E_{0}}(E_{0},T)$、$S_{\\Gamma}(E_{0},T)$ 和 $S_{\\Gamma_{\\gamma}}(E_{0},T)$ 的值。将您的三个灵敏度值四舍五入至四位有效数字。灵敏度无需物理单位。在您的推理中，根据这些灵敏度，指明哪个参数的不确定性在共振峰附近的大小占主导地位。最终报告的答案必须是有序三元组 $\\big(S_{E_{0}}(E_{0},T),\\,S_{\\Gamma}(E_{0},T),\\,S_{\\Gamma_{\\gamma}}(E_{0},T)\\big)$。",
            "solution": "本问题要求推导多普勒展宽截面在共振峰值处对三个共振参数（$E_0, \\Gamma, \\Gamma_\\gamma$）的灵敏度，并进行数值计算。\n\n展宽截面 $\\sigma_D(E,T)$ 是洛伦兹函数（未展宽截面）与高斯函数的卷积，其结果是福格特（Voigt）函数。在共振能量 $E=E_0$ 处，其解析表达式为：\n$$\n\\sigma_{D}(E_0,T) = \\frac{C \\Gamma_n \\Gamma_\\gamma}{\\sqrt{\\pi}\\Delta} \\int_{-\\infty}^{\\infty} \\frac{\\exp\\left(-\\frac{(E'-E_0)^2}{\\Delta^2}\\right)}{(E'-E_0)^2 + (\\Gamma/2)^2} \\mathrm{d}E'\n$$\n利用福格特函数的标准积分形式，上式可以表示为：\n$$\n\\sigma_{D}(E_0,T) = A \\cdot \\frac{2\\sqrt{\\pi}}{\\Gamma \\Delta} \\cdot F(y), \\quad \\text{其中} \\quad A = C \\Gamma_n \\Gamma_\\gamma, \\; y = \\frac{\\Gamma}{2\\Delta}, \\; F(y) = \\exp(y^2)\\text{erfc}(y)\n$$\n\n我们现在推导各个灵敏度 $S_p = \\frac{p}{\\sigma_D} \\frac{\\partial \\sigma_D}{\\partial p}$。\n\n1.  **对 $E_0$ 的灵敏度, $S_{E_0}(E_0, T)$**:\n    由于洛伦兹函数和高斯函数在 $E=E_0$ 处都是对称的，它们的卷积（福格特函数）也在 $E_0$ 处对称且达到峰值。因此，展宽截面在 $E=E_0$ 处对 $E_0$ 的一阶导数为零。\n    $$\n    \\frac{\\partial \\sigma_D(E,T)}{\\partial E_0} \\bigg|_{E=E_0} = 0\n    $$\n    所以，$S_{E_0}(E_0,T) = 0$。\n\n2.  **对 $\\Gamma_\\gamma$ 的灵敏度, $S_{\\Gamma_\\gamma}(E_0, T)$**:\n    根据问题陈述，$\\Gamma$ 和 $\\Gamma_\\gamma$ 被视为独立参数。从 $\\sigma_D$ 的表达式中可以看出，它与 $\\Gamma_\\gamma$ 呈线性关系（$\\sigma_D \\propto \\Gamma_\\gamma$）。\n    $$\n    \\frac{\\partial \\sigma_D}{\\partial \\Gamma_\\gamma} = \\frac{\\sigma_D}{\\Gamma_\\gamma}\n    $$\n    因此，灵敏度为：\n    $$\n    S_{\\Gamma_\\gamma}(E_0,T) = \\frac{\\Gamma_\\gamma}{\\sigma_D} \\frac{\\partial \\sigma_D}{\\partial \\Gamma_\\gamma} = \\frac{\\Gamma_\\gamma}{\\sigma_D} \\frac{\\sigma_D}{\\Gamma_\\gamma} = 1\n    $$\n\n3.  **对 $\\Gamma$ 的灵敏度, $S_{\\Gamma}(E_0, T)$**:\n    这是一个更复杂的导数，因为 $\\Gamma$ 同时出现在分母和福格特函数参数 $y$ 中。我们对 $\\sigma_D \\propto \\frac{F(y(\\Gamma))}{\\Gamma}$ 求导：\n    $$\n    \\frac{\\partial \\sigma_D}{\\partial \\Gamma} \\propto \\frac{\\partial}{\\partial \\Gamma} \\left( \\frac{F(y)}{\\Gamma} \\right) = \\frac{1}{\\Gamma^2} \\left( \\Gamma \\frac{\\partial F}{\\partial \\Gamma} - F(y) \\right) = \\frac{1}{\\Gamma^2} \\left( \\Gamma \\frac{dy}{d\\Gamma} \\frac{dF}{dy} - F(y) \\right)\n    $$\n    已知 $\\frac{dy}{d\\Gamma} = \\frac{1}{2\\Delta}$ 且 $\\frac{dF}{dy} = 2yF(y) - \\frac{2}{\\sqrt{\\pi}}$。代入并化简后，可以得到灵敏度的闭式表达式：\n    $$\n    S_{\\Gamma}(E_0,T) = \\frac{\\Gamma}{\\sigma_D} \\frac{\\partial \\sigma_D}{\\partial \\Gamma} = 2y^2 - 1 - \\frac{2y}{\\sqrt{\\pi}F(y)} = 2\\left(\\frac{\\Gamma}{2\\Delta}\\right)^2 - 1 - \\frac{\\Gamma/\\Delta}{\\sqrt{\\pi}\\exp((\\frac{\\Gamma}{2\\Delta})^2)\\text{erfc}(\\frac{\\Gamma}{2\\Delta})}\n    $$\n\n**数值计算**\n给定参数: $\\Gamma = 0.0250~\\text{eV}$ 和 $\\Delta = 0.1000~\\text{eV}$。\n首先计算无量纲参数 $y$：\n$$\ny = \\frac{\\Gamma}{2\\Delta} = \\frac{0.0250}{2 \\times 0.1000} = 0.125\n$$\n然后计算 $S_\\Gamma$ 的值：\n$$\nS_{\\Gamma}(E_0,T) = 2(0.125)^2 - 1 - \\frac{2 \\times 0.125}{\\sqrt{\\pi}\\exp((0.125)^2)\\text{erfc}(0.125)}\n$$\n$$\nS_{\\Gamma}(E_0,T) = 2(0.015625) - 1 - \\frac{0.25}{1.77245 \\times \\exp(0.015625) \\times \\text{erfc}(0.125)}\n$$\n$$\nS_{\\Gamma}(E_0,T) = 0.03125 - 1 - \\frac{0.25}{1.77245 \\times 1.01574 \\times 0.86003} \\approx 0.03125 - 1 - 0.16127 = -1.13002\n$$\n四舍五入到四位有效数字，得到 $S_\\Gamma \\approx -1.130$。\n\n**最终结果与结论**\n三个灵敏度值分别为：\n- $S_{E_0}(E_0,T) = 0.0000$\n- $S_\\Gamma(E_0,T) = -1.130$\n- $S_{\\Gamma_\\gamma}(E_0,T) = 1.000$\n\n为了确定主导不确定性的参数，我们比较灵敏度的绝对值：\n$|S_{E_0}| = 0.0000$\n$|S_\\Gamma| \\approx 1.130$\n$|S_{\\Gamma_\\gamma}| = 1.000$\n\n由于 $|S_\\Gamma| > |S_{\\Gamma_\\gamma}| > |S_{E_0}|$，总宽度 $\\Gamma$ 的不确定性对共振峰值截面的大小影响最大。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.0000 & -1.130 & 1.000 \\end{pmatrix}}\n$$"
        }
    ]
}