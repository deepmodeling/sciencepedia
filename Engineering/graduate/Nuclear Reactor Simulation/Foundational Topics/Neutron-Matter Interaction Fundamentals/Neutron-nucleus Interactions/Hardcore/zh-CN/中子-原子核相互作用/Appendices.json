{
    "hands_on_practices": [
        {
            "introduction": "要理解中子散射，我们通常需要在两个不同的参考系中进行分析：简化理论的质心（CM）参考系和进行测量的实验室（Lab）参考系。本练习旨在建立理论与观测之间的桥梁。您将推导弹性散射在这两个参考系之间的运动学关系，并计算平均散射余弦 $\\bar{\\mu}$，这是一个衡量实验室参考系中前向散射程度的关键参数 。",
            "id": "4238288",
            "problem": "考虑一个质量为 $m_n$、入射动能为 $E$ 的中子与一个静止的原子核发生弹性散射，该原子核的质量为 $M = A m_n$，其中 $A$ 是质量比。假设在质心 (CM) 坐标系中，散射是各向同性的，即微分截面在质心坐标系的立体角上是均匀的。由于从质心坐标系到实验室坐标系的运动学变换，实验室 (lab) 坐标系中观察到各向异性。利用线动量守恒和动能守恒，推导出出射中子的质心散射极角 $\\theta_{\\mathrm{CM}}$ (其中 $\\mu_{\\mathrm{CM}} \\equiv \\cos\\theta_{\\mathrm{CM}}$) 到实验室散射极角 $\\theta_{\\mathrm{lab}}$ (其中 $\\mu \\equiv \\cos\\theta_{\\mathrm{lab}}$) 的映射关系。然后，利用质心坐标系和实验室坐标系中立体角之间的雅可比变换，从质心坐标系的各向同性出发，求出以 $A$ 和 $\\mu_{\\mathrm{CM}}$ 表示的实验室坐标系微分截面 $d\\sigma/d\\Omega_{\\mathrm{lab}}$。最后，计算实验室坐标系中散射角余弦的平均值，\n$$\n\\bar{\\mu} \\equiv \\frac{1}{\\sigma}\\int \\mu \\,\\frac{d\\sigma}{d\\Omega_{\\mathrm{lab}}}\\,d\\Omega_{\\mathrm{lab}},\n$$\n对于入射能量为 $E = 1.5\\,\\mathrm{MeV}$ 的中子在铁 ($A=56$) 上的弹性散射。将您的 $\\bar{\\mu}$ 数值答案四舍五入到四位有效数字。以无量纲值的形式表示 $\\bar{\\mu}$ 的最终结果，不带任何单位。",
            "solution": "用户提供了一个问题，要求在中子-原子核弹性散射的背景下进行多步推导，然后进行数值计算。\n\n### **问题验证**\n\n**步骤 1：提取已知条件**\n- **碰撞：** 一个中子（质量 $m_n$，入射动能 $E$）与一个静止原子核的弹性散射。\n- **原子核：** 质量 $M = A m_n$，其中 $A$ 是质量比。原子核初始静止。\n- **质心 (CM) 坐标系性质：** 散射是各向同性的，即微分截面 $d\\sigma/d\\Omega_{\\mathrm{CM}}$ 是一个常数。\n- **定义：**\n    - 质心散射极角：$\\theta_{\\mathrm{CM}}$，其中 $\\mu_{\\mathrm{CM}} \\equiv \\cos\\theta_{\\mathrm{CM}}$。\n    - 实验室 (lab) 坐标系散射极角：$\\theta_{\\mathrm{lab}}$，其中 $\\mu \\equiv \\cos\\theta_{\\mathrm{lab}}$。\n- **任务：**\n    1. 推导从 $\\mu_{\\mathrm{CM}}$ 到 $\\mu$ 的映射关系。\n    2. 用 $A$ 和 $\\mu_{\\mathrm{CM}}$ 表示实验室坐标系的微分截面 $d\\sigma/d\\Omega_{\\mathrm{lab}}$。\n    3. 计算实验室坐标系中散射角余弦的平均值：$\\bar{\\mu} \\equiv \\frac{1}{\\sigma}\\int \\mu \\,\\frac{d\\sigma}{d\\Omega_{\\mathrm{lab}}}\\,d\\Omega_{\\mathrm{lab}}$。\n- **最终计算的数值数据：**\n    - 中子在铁上的散射。\n    - 质量比 $A = 56$。\n    - 入射能量 $E = 1.5\\,\\mathrm{MeV}$。\n- **要求的输出精度：** 将 $\\bar{\\mu}$ 的数值答案四舍五入到四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 这个问题是非相对论性散射理论中的一个经典练习，是核物理和反应堆理论的基石。弹性散射、实验室和质心坐标系以及截面的概念都是基础性的。假设质心坐标系中的散射是各向同性是一种标准且有用的近似，尤其适用于低能中子散射。\n- **良态问题：** 这个问题是自洽的，为所有要求的推导和计算提供了足够的信息。任务的进展是合乎逻辑的。物理模型保证了唯一、稳定解的存在。\n- **客观性：** 问题使用精确、标准且无偏见的物理学术语进行陈述。\n- **缺陷分析：**\n    - 问题没有科学或事实错误。非相对论性处理是合适的，因为中子的动能 ($1.5\\,\\mathrm{MeV}$) 远小于其静止质量能 ($\\approx 939.6\\,\\mathrm{MeV}$)。\n    - 问题是可形式化的，并与中子-原子核相互作用的指定主题直接相关。\n    - 设置是完整的且内部一致的。包含入射能量 $E=1.5\\,\\mathrm{MeV}$ 对于计算 $\\bar{\\mu}$（对于各向同性的质心散射，它仅取决于 $A$）可能看起来是多余的，但这不构成矛盾或缺陷。在物理问题中，包含最终结果可能不需要的数据是很常见的，目的是测试学生对基本原理的理解。\n    - 条件和数据在物理上是现实的。\n    - 问题结构良好，并导向一个有意义的物理量 $\\bar{\\mu}$。\n\n**步骤 3：结论与行动**\n该问题在科学上是合理的，属于良态问题，并且是客观的。它被判定为**有效**。我将继续提供完整解答。\n\n### **解题过程**\n\n该问题分三部分解决：推导散射角之间的运动学关系，确定实验室坐标系的微分截面，以及计算实验室散射角的平均余弦。\n\n**第一部分：从质心坐标系到实验室坐标系的运动学映射**\n\n设中子质量为 $m_n$，在实验室坐标系中的初始速度为 $\\vec{v}_n$。其动能为 $E = \\frac{1}{2}m_n v_n^2$。靶核质量为 $M = A m_n$，初始静止。$\\vec{v}_n$ 的方向定义为 z 轴。\n\n质心 (CM) 的速度由下式给出：\n$$\n\\vec{v}_{\\mathrm{CM}} = \\frac{m_n \\vec{v}_n + M \\cdot \\vec{0}}{m_n + M} = \\frac{m_n}{(A+1)m_n} \\vec{v}_n = \\frac{1}{A+1} \\vec{v}_n\n$$\n在质心坐标系中，中子的初始速度为：\n$$\n\\vec{u}_n = \\vec{v}_n - \\vec{v}_{\\mathrm{CM}} = \\vec{v}_n - \\frac{1}{A+1} \\vec{v}_n = \\frac{A}{A+1} \\vec{v}_n\n$$\n对于弹性散射，质心坐标系中每个粒子的速度大小是守恒的。经过极角 $\\theta_{\\mathrm{CM}}$ 和方位角 $\\phi_{\\mathrm{CM}}$ 散射后，中子在质心坐标系中的末速度 $\\vec{u}'_n$ 的大小为 $|\\vec{u}'_n| = |\\vec{u}_n| = \\frac{A}{A+1}v_n$。\n\n为了求出中子在实验室坐标系中的末速度 $\\vec{v}'_n$，我们从质心坐标系变换回来：\n$$\n\\vec{v}'_n = \\vec{u}'_n + \\vec{v}_{\\mathrm{CM}}\n$$\n我们来分析这个矢量方程的分量。z 轴沿着 $\\vec{v}_{\\mathrm{CM}}$ 方向。矢量 $\\vec{u}'_n$ 与此轴成 $\\theta_{\\mathrm{CM}}$ 角。\n$\\vec{v}'_n$ 平行于初始方向 ($\\hat{z}$) 的分量是：\n$$\nv'_{n,z} = u'_n \\cos\\theta_{\\mathrm{CM}} + v_{\\mathrm{CM}} = \\frac{A}{A+1}v_n \\mu_{\\mathrm{CM}} + \\frac{1}{A+1}v_n = \\frac{v_n}{A+1}(1 + A\\mu_{\\mathrm{CM}})\n$$\n垂直于初始方向的分量是：\n$$\nv'_{n,\\perp} = u'_n \\sin\\theta_{\\mathrm{CM}} = \\frac{A}{A+1}v_n \\sin\\theta_{\\mathrm{CM}}\n$$\n实验室散射角的余弦 $\\mu = \\cos\\theta_{\\mathrm{lab}}$ 是平行分量与末速度大小之比：\n$$\n\\mu = \\frac{v'_{n,z}}{|\\vec{v}'_n|}\n$$\n末速度大小的平方是：\n$$\n|\\vec{v}'_n|^2 = (v'_{n,z})^2 + (v'_{n,\\perp})^2 = \\left(\\frac{v_n}{A+1}\\right)^2 \\left[ (1+A\\mu_{\\mathrm{CM}})^2 + (A\\sin\\theta_{\\mathrm{CM}})^2 \\right]\n$$\n简化方括号中的项：\n$$\n(1+2A\\mu_{\\mathrm{CM}}+A^2\\mu_{\\mathrm{CM}}^2) + A^2(1-\\mu_{\\mathrm{CM}}^2) = 1+2A\\mu_{\\mathrm{CM}}+A^2\\mu_{\\mathrm{CM}}^2 + A^2 - A^2\\mu_{\\mathrm{CM}}^2 = 1+A^2+2A\\mu_{\\mathrm{CM}}\n$$\n所以，末速度的大小是：\n$$\n|\\vec{v}'_n| = \\frac{v_n}{A+1}\\sqrt{1+A^2+2A\\mu_{\\mathrm{CM}}}\n$$\n将此结果和 $v'_{n,z}$ 代入 $\\mu$ 的表达式，得到所需的映射关系：\n$$\n\\mu = \\frac{\\frac{v_n}{A+1}(1 + A\\mu_{\\mathrm{CM}})}{\\frac{v_n}{A+1}\\sqrt{1+A^2+2A\\mu_{\\mathrm{CM}}}} = \\frac{1 + A\\mu_{\\mathrm{CM}}}{\\sqrt{1+A^2+2A\\mu_{\\mathrm{CM}}}}\n$$\n\n**第二部分：实验室坐标系微分截面**\n\n散射到微分立体角内的事件数 $d\\sigma$ 是坐标系不变量。\n$$\nd\\sigma = \\frac{d\\sigma}{d\\Omega_{\\mathrm{lab}}} d\\Omega_{\\mathrm{lab}} = \\frac{d\\sigma}{d\\Omega_{\\mathrm{CM}}} d\\Omega_{\\mathrm{CM}}\n$$\n鉴于在质心坐标系中散射是各向同性的，微分截面是常数：\n$$\n\\frac{d\\sigma}{d\\Omega_{\\mathrm{CM}}} = \\frac{\\sigma_s}{4\\pi}\n$$\n其中 $\\sigma_s$ 是总弹性散射截面。\n由于围绕碰撞轴的方位对称性，$\\phi_{\\mathrm{lab}} = \\phi_{\\mathrm{CM}}$，因此 $d\\Omega_{\\mathrm{lab}} = d\\mu \\, d\\phi$ 且 $d\\Omega_{\\mathrm{CM}} = d\\mu_{\\mathrm{CM}} \\, d\\phi$。立体角元的变换由极角余弦之间的变换的雅可比行列式给出：\n$$\n\\frac{d\\sigma}{d\\Omega_{\\mathrm{lab}}} = \\frac{d\\sigma}{d\\Omega_{\\mathrm{CM}}} \\left| \\frac{d\\Omega_{\\mathrm{CM}}}{d\\Omega_{\\mathrm{lab}}} \\right| = \\frac{\\sigma_s}{4\\pi} \\left| \\frac{d\\mu_{\\mathrm{CM}}}{d\\mu} \\right| = \\frac{\\sigma_s}{4\\pi} \\left| \\left( \\frac{d\\mu}{d\\mu_{\\mathrm{CM}}} \\right)^{-1} \\right|\n$$\n我们使用商法则对映射 $\\mu(\\mu_{\\mathrm{CM}})$ 关于 $\\mu_{\\mathrm{CM}}$ 求导：\n$$\n\\frac{d\\mu}{d\\mu_{\\mathrm{CM}}} = \\frac{A\\sqrt{1+A^2+2A\\mu_{\\mathrm{CM}}} - (1+A\\mu_{\\mathrm{CM}})\\frac{A}{\\sqrt{1+A^2+2A\\mu_{\\mathrm{CM}}}}}{1+A^2+2A\\mu_{\\mathrm{CM}}}\n$$\n$$\n\\frac{d\\mu}{d\\mu_{\\mathrm{CM}}} = \\frac{A(1+A^2+2A\\mu_{\\mathrm{CM}}) - A(1+A\\mu_{\\mathrm{CM}})}{(1+A^2+2A\\mu_{\\mathrm{CM}})^{3/2}} = \\frac{A+A^3+2A^2\\mu_{\\mathrm{CM}} - A-A^2\\mu_{\\mathrm{CM}}}{(1+A^2+2A\\mu_{\\mathrm{CM}})^{3/2}}\n$$\n$$\n\\frac{d\\mu}{d\\mu_{\\mathrm{CM}}} = \\frac{A^3+A^2\\mu_{\\mathrm{CM}}}{(1+A^2+2A\\mu_{\\mathrm{CM}})^{3/2}} = \\frac{A^2(A+\\mu_{\\mathrm{CM}})}{(1+A^2+2A\\mu_{\\mathrm{CM}})^{3/2}}\n$$\n对于 $A  1$（例如铁的 $A=56$），该导数恒为正，因此不需要绝对值。雅可比行列式是其倒数：\n$$\n\\frac{d\\mu_{\\mathrm{CM}}}{d\\mu} = \\frac{(1+A^2+2A\\mu_{\\mathrm{CM}})^{3/2}}{A^2(A+\\mu_{\\mathrm{CM}})}\n$$\n将此代入实验室坐标系微分截面的表达式，即可得到按要求用 $A$ 和 $\\mu_{\\mathrm{CM}}$ 表示的结果：\n$$\n\\frac{d\\sigma}{d\\Omega_{\\mathrm{lab}}} = \\frac{\\sigma_s}{4\\pi} \\frac{(1+A^2+2A\\mu_{\\mathrm{CM}})^{3/2}}{A^2(A+\\mu_{\\mathrm{CM}})}\n$$\n\n**第三部分：散射角的平均余弦**\n\n实验室坐标系中散射角的平均余弦 $\\bar{\\mu}$ 定义为：\n$$\n\\bar{\\mu} \\equiv \\frac{1}{\\sigma_s}\\int_{4\\pi} \\mu \\,\\frac{d\\sigma}{d\\Omega_{\\mathrm{lab}}}\\,d\\Omega_{\\mathrm{lab}}\n$$\n一个有效的解决方法是将积分变量从实验室坐标系的立体角 $\\Omega_{\\mathrm{lab}}$ 变换为质心坐标系的立体角 $\\Omega_{\\mathrm{CM}}$。\n$$\n\\bar{\\mu} = \\frac{1}{\\sigma_s}\\int_{4\\pi} \\mu(\\Omega_{\\mathrm{CM}}) \\left( \\frac{d\\sigma}{d\\Omega_{\\mathrm{CM}}} d\\Omega_{\\mathrm{CM}} \\right)\n$$\n代入各向同性的质心截面 $\\frac{d\\sigma}{d\\Omega_{\\mathrm{CM}}} = \\frac{\\sigma_s}{4\\pi}$：\n$$\n\\bar{\\mu} = \\frac{1}{\\sigma_s}\\int_{4\\pi} \\mu(\\Omega_{\\mathrm{CM}}) \\frac{\\sigma_s}{4\\pi} d\\Omega_{\\mathrm{CM}} = \\frac{1}{4\\pi}\\int_{0}^{2\\pi} d\\phi_{\\mathrm{CM}} \\int_{-1}^{1} \\mu(\\mu_{\\mathrm{CM}}) d\\mu_{\\mathrm{CM}}\n$$\n由于 $\\mu$ 与 $\\phi_{\\mathrm{CM}}$ 无关，对 $\\phi_{\\mathrm{CM}}$ 的积分得到一个因子 $2\\pi$。\n$$\n\\bar{\\mu} = \\frac{2\\pi}{4\\pi} \\int_{-1}^{1} \\mu(\\mu_{\\mathrm{CM}}) d\\mu_{\\mathrm{CM}} = \\frac{1}{2} \\int_{-1}^{1} \\frac{1 + A\\mu_{\\mathrm{CM}}}{\\sqrt{1+A^2+2A\\mu_{\\mathrm{CM}}}} d\\mu_{\\mathrm{CM}}\n$$\n为了计算该积分，令 $u = 1+A^2+2A\\mu_{\\mathrm{CM}}$。这得到 $d\\mu_{\\mathrm{CM}} = \\frac{du}{2A}$。分子项 $1+A\\mu_{\\mathrm{CM}}$ 可以用 $u$ 表示：$\\mu_{\\mathrm{CM}} = \\frac{u - (1+A^2)}{2A}$，所以 $1+A\\mu_{\\mathrm{CM}} = 1+A\\left(\\frac{u - 1 - A^2}{2A}\\right) = \\frac{2+u-1-A^2}{2} = \\frac{u+1-A^2}{2}$。\n积分限相应变为：当 $\\mu_{\\mathrm{CM}}=-1$ 时，$u=1+A^2-2A=(A-1)^2$；当 $\\mu_{\\mathrm{CM}}=1$ 时，$u=1+A^2+2A=(A+1)^2$。\n积分变为：\n$$\n\\int_{(A-1)^2}^{(A+1)^2} \\frac{(u+1-A^2)/2}{\\sqrt{u}} \\frac{du}{2A} = \\frac{1}{4A} \\int_{(A-1)^2}^{(A+1)^2} \\left( u^{1/2} + (1-A^2)u^{-1/2} \\right) du\n$$\n$$\n= \\frac{1}{4A} \\left[ \\frac{2}{3}u^{3/2} + 2(1-A^2)u^{1/2} \\right]_{(A-1)^2}^{(A+1)^2}\n$$\n在积分限处计算反导数（对于 $A1$）：\n在 $u=(A+1)^2$ 处：$\\frac{2}{3}(A+1)^3 + 2(1-A)(1+A)(A+1) = \\frac{2}{3}(A+1)^3 - 2(A-1)(A+1)^2 = \\frac{2}{3}(A+1)^2 ( (A+1) - 3(A-1) ) = \\frac{2}{3}(A+1)^2 (4-2A) = \\frac{4}{3}(A+1)^2(2-A)$。\n在 $u=(A-1)^2$ 处：$\\frac{2}{3}(A-1)^3 + 2(1-A^2)(A-1) = \\frac{2}{3}(A-1)^3 - 2(A+1)(A-1)^2 = \\frac{2}{3}(A-1)^2 ( (A-1) - 3(A+1) ) = \\frac{2}{3}(A-1)^2 (-2A-4) = -\\frac{4}{3}(A-1)^2(A+2)$。\n差值为：\n$$\n\\frac{4}{3} \\left[ (A+1)^2(2-A) + (A-1)^2(A+2) \\right] = \\frac{4}{3} \\left[ (A^2+2A+1)(2-A) + (A^2-2A+1)(A+2) \\right]\n$$\n$$\n= \\frac{4}{3} \\left[ (-A^3+3A+2) + (A^3-3A+2) \\right] = \\frac{4}{3} [4] = \\frac{16}{3}\n$$\n积分为 $\\frac{1}{4A} \\times \\frac{16}{3} = \\frac{4}{3A}$。\n最后，我们求得 $\\bar{\\mu}$：\n$$\n\\bar{\\mu} = \\frac{1}{2} \\left( \\frac{4}{3A} \\right) = \\frac{2}{3A}\n$$\n这个非常简洁且重要的结果表明，对于质心坐标系中的各向同性散射，实验室散射角的平均余弦仅取决于质量比 $A$，而与入射中子能量 $E$ 无关。\n\n对于给定的中子在铁上的散射情况，$A=56$：\n$$\n\\bar{\\mu} = \\frac{2}{3 \\times 56} = \\frac{2}{168} = \\frac{1}{84}\n$$\n将其转换为小数并四舍五入到四位有效数字：\n$$\n\\bar{\\mu} \\approx 0.01190476... \\approx 0.01190\n$$",
            "answer": "$$\n\\boxed{0.01190}\n$$"
        },
        {
            "introduction": "在实际情况中，散射中子的角分布通常很复杂并且依赖于能量，并非总是各向同性。本练习将介绍核工程中用于表示这种各向异性的标准方法：勒让德多项式展开。通过将系数与假设的实验数据进行拟合，您将学习如何捕捉散射的角度形态，并计算诸如总截面和平均散射余弦等积分量 。",
            "id": "4238276",
            "problem": "考虑在单一核素上的弹性中子散射，该散射过程的相互作用可以建模为绕入射束轴方位角对称。可测量的量是微分散射截面，记为 $d\\sigma/d\\Omega(\\theta; E, A)$，其中 $\\theta$ 是极向散射角，$E$ 是入射中子动能，$A$ 是靶核的质量数。假设 $d\\sigma/d\\Omega$ 仅依赖于 $\\theta$（不依赖于方位角），并且对于固定的 $(E, A)$，它可以展开为勒让德多项式 $P_\\ell(\\mu)$ 的截断级数，其中 $\\mu = \\cos\\theta$，\n$$\n\\frac{d\\sigma}{d\\Omega}(\\mu; E, A) \\approx \\sum_{\\ell=0}^{L_{\\max}} c_\\ell(E, A)\\, P_\\ell(\\mu),\n$$\n对于某个整数 $L_{\\max} \\ge 0$，其中系数 $c_\\ell(E, A)$ 是实数，$P_\\ell$ 是在 $[-1,1]$ 上的普通勒让德多项式。\n\n给定在多个角度下对几个 $(E, A)$ 对的 $d\\sigma/d\\Omega$ 的离散测量值。您的任务是利用提供的样本通过求解最小二乘问题来拟合勒让德系数 $c_\\ell(E, A)$，然后计算从拟合展开式中导出的各向异性度量。所有角度均以度为单位指定，在进行任何三角计算时必须按弧度处理。所有截面必须以靶（barns）为单位表示，微分截面以靶/球面度（barns per steradian）为单位表示。所有报告的数值结果必须四舍五入到小数点后六位。\n\n使用的基本原理：\n- 微分截面 $d\\sigma/d\\Omega$ 的定义，即单位立体角内经概率归一化的散射率。\n- 勒让德多项式在 $[-1,1]$ 上的完备性和正交性，以及轴对称展开对中心力散射的适用性。\n- 总截面 $\\sigma_{\\text{tot}}$ 的定义，即 $d\\sigma/d\\Omega$ 在所有立体角上的积分。\n- 第一角矩（平均余弦）$\\langle \\mu \\rangle$ 的定义，即以 $d\\sigma/d\\Omega$ 为权重的 $\\mu = \\cos\\theta$ 的立体角加权平均值。\n\n对于下述每个测试用例，执行以下操作：\n1. 通过最小化测量值 $d\\sigma/d\\Omega(\\theta_i)$ 与在 $\\mu_i = \\cos\\theta_i$ 处计算的截断级数之间的残差平方和，拟合 $\\ell = 0, 1, 2, 3, 4$ ($L_{\\max} = 4$) 的系数 $c_\\ell(E, A)$，使用给定的角度样本。角度以度为单位处理，并在计算 $\\mu$ 之前转换为弧度。\n2. 使用拟合级数，计算：\n   - 通过在整个立体角上对 $d\\sigma/d\\Omega(\\mu)$ 进行积分来计算总截面 $\\sigma_{\\text{tot}}(E, A)$。以靶（barns）为单位报告 $\\sigma_{\\text{tot}}$。\n   - 由下式定义的散射角平均余弦 $\\langle \\mu \\rangle(E, A)$\n     $$\n     \\langle \\mu \\rangle = \\frac{\\int \\mu \\,\\frac{d\\sigma}{d\\Omega}(\\mu)\\, d\\Omega}{\\int \\frac{d\\sigma}{d\\Omega}(\\mu)\\, d\\Omega},\n     $$\n     报告为无量纲浮点数。\n   - 由下式定义的前向-后向散射比 $R_{\\mathrm{FB}}(E, A)$\n     $$\n     R_{\\mathrm{FB}} = \\frac{\\left.\\frac{d\\sigma}{d\\Omega}\\right|_{\\mu=+1}}{\\left.\\frac{d\\sigma}{d\\Omega}\\right|_{\\mu=-1}},\n     $$\n     使用拟合级数进行评估。\n3. 对每个测试用例，输出一个列表，包含 $[c_0, c_1, c_2, c_3, c_4, \\sigma_{\\text{tot}}, \\langle \\mu \\rangle, R_{\\mathrm{FB}}]$，所有条目均为四舍五入到小数点后六位的浮点数。\n4. 将所有测试用例的结果聚合到单行中，形式为用方括号括起来的、由逗号分隔的列表的列表，例如 $[[\\cdots],[\\cdots],\\ldots]$。\n\n角度单位说明：输入角度以度为单位。在计算 $\\mu = \\cos\\theta$ 时必须转换为弧度。在报告任何与角度相关的量时，$\\theta$ 以度为单位，$\\mu$ 是无量纲的。\n\n测试套件和数据：\n- 使用 $L_{\\max} = 4$。\n- 所有用例的通用角度网格（度）：$\\theta \\in [\\,0, 30, 60, 90, 120, 150, 180\\,]$。\n- 用例 1（轻核，低能）：$A = 12$, $E = 0.5\\,\\mathrm{MeV}$，在所列角度下测量的 $\\frac{d\\sigma}{d\\Omega}$（靶/球面度）：\n  $[\\,1.30, 1.22, 1.15, 1.10, 1.05, 1.02, 1.00\\,]$。\n- 用例 2（重核，低能）：$A = 238$, $E = 0.5\\,\\mathrm{MeV}$，测量的 $\\frac{d\\sigma}{d\\Omega}$：\n  $[\\,1.50, 1.35, 1.20, 1.10, 1.00, 0.95, 0.90\\,]$。\n- 用例 3（轻核，中能）：$A = 12$, $E = 2.0\\,\\mathrm{MeV}$，测量的 $\\frac{d\\sigma}{d\\Omega}$：\n  $[\\,1.80, 1.60, 1.35, 1.10, 0.90, 0.75, 0.65\\,]$。\n- 用例 4（重核，中能）：$A = 238$, $E = 2.0\\,\\mathrm{MeV}$，测量的 $\\frac{d\\sigma}{d\\Omega}$：\n  $[\\,2.10, 1.80, 1.45, 1.15, 0.85, 0.65, 0.50\\,]$。\n- 用例 5（轻核，高能）：$A = 12$, $E = 10.0\\,\\mathrm{MeV}$，测量的 $\\frac{d\\sigma}{d\\Omega}$：\n  $[\\,2.50, 2.10, 1.60, 1.10, 0.75, 0.55, 0.45\\,]$。\n- 用例 6（重核，高能）：$A = 238$, $E = 10.0\\,\\mathrm{MeV}$，测量的 $\\frac{d\\sigma}{d\\Omega}$：\n  $[\\,3.00, 2.40, 1.80, 1.20, 0.70, 0.50, 0.40\\,]$。\n- 用例 7（边界条件，近各向同性）：$A = 56$, $E = 0.1\\,\\mathrm{MeV}$，测量的 $\\frac{d\\sigma}{d\\Omega}$：\n  $[\\,1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00\\,]$。\n\n覆盖性设计：\n- 用例涵盖了低、中、高能 $E$，以及轻核（$A=12$）、中等质量核（$A=56$）和重核（$A=238$）。\n- 边界用例检查了各向同性极限，在此极限下，高阶系数应可忽略不计。\n- 前向峰化用例测试了拟合和各向异性度量的灵敏度。\n\n您的程序应生成单行输出，其中包含所有用例结果的列表，格式为由逗号分隔的列表组成的列表，并用方括号括起，无额外空格。例如，格式必须类似于 $[[r_{1,1},r_{1,2},\\ldots,r_{1,8}],[r_{2,1},\\ldots],[\\ldots]]$，其中 $r_{i,j}$ 是四舍五入到小数点后六位的浮点数。所有输出的单位必须一致：$c_\\ell$ 的单位是靶/球面度，$\\sigma_{\\text{tot}}$ 的单位是靶，$\\langle \\mu \\rangle$ 和 $R_{\\mathrm{FB}}$ 是无量纲的。",
            "solution": "该问题要求将截断的勒让德多项式级数拟合到弹性中子散射的离散微分截面数据，并随后计算派生的物理量。这是核数据分析中的标准流程。该问题提法明确且科学上合理，因此可以直接求解。\n\n微分截面 $\\frac{d\\sigma}{d\\Omega}$ 由级数展开近似表示：\n$$\n\\frac{d\\sigma}{d\\Omega}(\\mu) = \\sum_{\\ell=0}^{L_{\\max}} c_\\ell P_\\ell(\\mu)\n$$\n其中 $\\mu = \\cos\\theta$，$\\theta$ 是极向散射角，$P_\\ell(\\mu)$ 是普通勒让德多项式，$c_\\ell$ 是待确定的展开系数。问题指定在 $L_{\\max} = 4$ 处截断。\n\n问题的核心是通过对提供的测量数据进行线性最小二乘拟合来确定系数向量 $\\mathbf{c} = [c_0, c_1, c_2, c_3, c_4]^T$。对于一组 $N$ 个测量值 $(y_i, \\theta_i)$，其中 $y_i$ 是在角度 $\\theta_i$ 处测得的 $\\frac{d\\sigma}{d\\Omega}$ 的值，我们旨在最小化残差平方和 $S$：\n$$\nS(\\mathbf{c}) = \\sum_{i=1}^{N} \\left( y_i - \\sum_{\\ell=0}^{L_{\\max}} c_\\ell P_\\ell(\\mu_i) \\right)^2\n$$\n其中 $\\mu_i = \\cos(\\theta_i)$。角度 $\\theta_i$ 以度为单位给出，在计算 $\\cos(\\theta_i)$ 时必须转换为弧度。\n\n该最小化问题可以表示为矩阵形式，即为超定系统 $\\mathbf{A}\\mathbf{c} \\approx \\mathbf{y}$ 寻找最佳解，其中：\n- $\\mathbf{y}$ 是测量截面值 $y_i$ 的 $N \\times 1$ 列向量。对于此问题，$N=7$。\n- $\\mathbf{c}$ 是未知系数 $c_\\ell$ 的 $(L_{\\max}+1) \\times 1$ 列向量。对于此问题，$L_{\\max}+1 = 5$。\n- $\\mathbf{A}$ 是 $N \\times (L_{\\max}+1)$ 的设计矩阵，其元素由 $A_{i\\ell} = P_\\ell(\\mu_i)$ 给出。使用的具体勒让德多项式为 $P_0(\\mu)=1$，$P_1(\\mu)=\\mu$，$P_2(\\mu) = \\frac{1}{2}(3\\mu^2 - 1)$，$P_3(\\mu) = \\frac{1}{2}(5\\mu^3 - 3\\mu)$，以及 $P_4(\\mu) = \\frac{1}{8}(35\\mu^4 - 30\\mu^2 + 3)$。\n\n$\\mathbf{c}$ 的最小二乘解通过求解正规方程 $\\mathbf{A}^T\\mathbf{A}\\mathbf{c} = \\mathbf{A}^T\\mathbf{y}$ 得到。在数值上，这通常使用奇异值分解（SVD）等方法求解，这些方法稳健且在科学计算库中易于获得。\n\n一旦确定了系数 $c_\\ell$，就可以计算以下物理量：\n\n1.  **总截面 ($\\sigma_{\\text{tot}}$)**：这是微分截面在整个立体角 $\\Omega$ 上的积分。对于方位角对称系统，$d\\Omega = 2\\pi \\sin\\theta \\,d\\theta = -2\\pi \\,d\\mu$。\n    $$\n    \\sigma_{\\text{tot}} = \\int_{4\\pi} \\frac{d\\sigma}{d\\Omega}(\\mu) \\,d\\Omega = 2\\pi \\int_{-1}^{1} \\left( \\sum_{\\ell=0}^{4} c_\\ell P_\\ell(\\mu) \\right) d\\mu\n    $$\n    利用勒让德多项式的正交性，$\\int_{-1}^{1} P_\\ell(\\mu) \\,d\\mu = \\int_{-1}^{1} P_\\ell(\\mu) P_0(\\mu) \\,d\\mu = 2\\delta_{\\ell 0}$，其中 $\\delta_{\\ell 0}$ 是克罗内克（Kronecker）δ函数。因此，只有 $\\ell=0$ 项对积分有贡献。\n    $$\n    \\sigma_{\\text{tot}} = 2\\pi \\cdot c_0 \\cdot 2 = 4\\pi c_0\n    $$\n    总截面与各向同性散射系数 $c_0$ 成正比。给定 $c_0$ 的单位为靶/球面度，$\\sigma_{\\text{tot}}$ 的单位将是靶。\n\n2.  **散射角平均余弦 ($\\langle \\mu \\rangle$)**：这个量度量散射的平均前向程度。它定义为 $\\mu = \\cos\\theta$ 的立体角加权平均值。\n    $$\n    \\langle \\mu \\rangle = \\frac{\\int_{\\Omega} \\mu \\,\\frac{d\\sigma}{d\\Omega}(\\mu)\\, d\\Omega}{\\int_{\\Omega} \\frac{d\\sigma}{d\\Omega}(\\mu)\\, d\\Omega}\n    $$\n    分母就是总截面 $\\sigma_{\\text{tot}} = 4\\pi c_0$。分子可以通过注意到 $\\mu=P_1(\\mu)$ 来计算。\n    $$\n    \\text{Numerator} = \\int_{4\\pi} P_1(\\mu) \\left( \\sum_{\\ell=0}^{4} c_\\ell P_\\ell(\\mu) \\right) d\\Omega = 2\\pi \\sum_{\\ell=0}^{4} c_\\ell \\int_{-1}^{1} P_1(\\mu) P_\\ell(\\mu) \\,d\\mu\n    $$\n    利用正交关系 $\\int_{-1}^{1} P_k(\\mu)P_\\ell(\\mu) \\,d\\mu = \\frac{2}{2\\ell+1}\\delta_{k\\ell}$，只有 $\\ell=1$ 项保留下来。\n    $$\n    \\text{Numerator} = 2\\pi \\cdot c_1 \\cdot \\frac{2}{2(1)+1} = \\frac{4\\pi}{3}c_1\n    $$\n    因此，平均余弦是以下比率：\n    $$\n    \\langle \\mu \\rangle = \\frac{(4\\pi/3)c_1}{4\\pi c_0} = \\frac{c_1}{3c_0}\n    $$\n    这是一个表示散射各向异性的无量纲量。\n\n3.  **前向-后向散射比 ($R_{\\mathrm{FB}}$)**：该比率比较了正前向（$\\theta=0^\\circ$, $\\mu=+1$）和正后向（$\\theta=180^\\circ$, $\\mu=-1$）的散射强度。\n    $$\n    R_{\\mathrm{FB}} = \\frac{\\left.\\frac{d\\sigma}{d\\Omega}\\right|_{\\mu=+1}}{\\left.\\frac{d\\sigma}{d\\Omega}\\right|_{\\mu=-1}}\n    $$\n    利用勒让德多项式的性质，$P_\\ell(1)=1$ 和 $P_\\ell(-1)=(-1)^\\ell$ 对所有 $\\ell \\ge 0$ 成立。\n    $$\n    \\left.\\frac{d\\sigma}{d\\Omega}\\right|_{\\mu=+1} = \\sum_{\\ell=0}^{4} c_\\ell P_\\ell(1) = c_0 + c_1 + c_2 + c_3 + c_4\n    $$\n    $$\n    \\left.\\frac{d\\sigma}{d\\Omega}\\right|_{\\mu=-1} = \\sum_{\\ell=0}^{4} c_\\ell P_\\ell(-1) = c_0 - c_1 + c_2 - c_3 + c_4\n    $$\n    因此，该比率为：\n    $$\n    R_{\\mathrm{FB}} = \\frac{c_0 + c_1 + c_2 + c_3 + c_4}{c_0 - c_1 + c_2 - c_3 + c_4}\n    $$\n    这也是一个无量纲量。\n\n每个测试用例的算法流程如下：\n1. 将通用角度网格从度转换为弧度，并计算相应的 $\\mu_i$ 值。\n2. 构建 $7 \\times 5$ 的设计矩阵 $\\mathbf{A}$，其中 $A_{i\\ell} = P_\\ell(\\mu_i)$。该矩阵对所有测试用例都是相同的。\n3. 对每个用例，取测量截面向量 $\\mathbf{y}$ 并求解最小二乘问题 $\\mathbf{A}\\mathbf{c} \\approx \\mathbf{y}$ 以找到系数向量 $\\mathbf{c}$。\n4. 使用获得的系数 $c_0, \\dots, c_4$ 和推导出的公式计算 $\\sigma_{\\text{tot}}$, $\\langle \\mu \\rangle$ 和 $R_{\\mathrm{FB}}$。\n5. 将五个系数和三个派生量收集到一个列表中，并将每个值四舍五入到小数点后六位。\n6. 将所有用例的结果聚合到一个最终的列表的列表中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import eval_legendre\n\ndef solve():\n    \"\"\"\n    Fits Legendre coefficients to differential cross-section data and computes\n    derived physical quantities for several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (light nucleus, low energy)\n        {'A': 12, 'E': 0.5, 'dsdo_data': [1.30, 1.22, 1.15, 1.10, 1.05, 1.02, 1.00]},\n        # Case 2 (heavy nucleus, low energy)\n        {'A': 238, 'E': 0.5, 'dsdo_data': [1.50, 1.35, 1.20, 1.10, 1.00, 0.95, 0.90]},\n        # Case 3 (light nucleus, intermediate energy)\n        {'A': 12, 'E': 2.0, 'dsdo_data': [1.80, 1.60, 1.35, 1.10, 0.90, 0.75, 0.65]},\n        # Case 4 (heavy nucleus, intermediate energy)\n        {'A': 238, 'E': 2.0, 'dsdo_data': [2.10, 1.80, 1.45, 1.15, 0.85, 0.65, 0.50]},\n        # Case 5 (light nucleus, high energy)\n        {'A': 12, 'E': 10.0, 'dsdo_data': [2.50, 2.10, 1.60, 1.10, 0.75, 0.55, 0.45]},\n        # Case 6 (heavy nucleus, high energy)\n        {'A': 238, 'E': 10.0, 'dsdo_data': [3.00, 2.40, 1.80, 1.20, 0.70, 0.50, 0.40]},\n        # Case 7 (boundary condition, nearly isotropic)\n        {'A': 56, 'E': 0.1, 'dsdo_data': [1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00]},\n    ]\n    \n    # Common parameters for all test cases\n    angles_deg = np.array([0, 30, 60, 90, 120, 150, 180])\n    L_max = 4\n    num_coeffs = L_max + 1\n\n    # Prepare the design matrix A, which is common for all cases\n    angles_rad = np.deg2rad(angles_deg)\n    mu_values = np.cos(angles_rad)\n    \n    A = np.zeros((len(mu_values), num_coeffs))\n    for l in range(num_coeffs):\n        A[:, l] = eval_legendre(l, mu_values)\n\n    all_results = []\n    \n    for case in test_cases:\n        # Get the measured differential cross section data\n        y = np.array(case['dsdo_data'])\n\n        # 1. Fit the Legendre coefficients using linear least squares\n        # np.linalg.lstsq solves the equation A @ c = y for c\n        c, residuals, rank, s = np.linalg.lstsq(A, y, rcond=None)\n        \n        c0, c1, c2, c3, c4 = c[0], c[1], c[2], c[3], c[4]\n\n        # 2. Compute derived quantities\n        \n        # Total cross section\n        sigma_tot = 4 * np.pi * c0\n        \n        # Mean cosine of scattering angle\n        # Handle potential division by zero, though unlikely with this data\n        if c0 == 0:\n            mu_avg = np.nan\n        else:\n            mu_avg = c1 / (3 * c0)\n            \n        # Forward-to-backward ratio\n        d_sigma_forward = np.sum(c)\n        alternating_signs = np.array([1, -1, 1, -1, 1])\n        d_sigma_backward = np.sum(c * alternating_signs)\n        \n        # Handle potential division by zero\n        if d_sigma_backward == 0:\n            r_fb = np.inf if d_sigma_forward != 0 else np.nan\n        else:\n            r_fb = d_sigma_forward / d_sigma_backward\n\n        # Format the results for this case\n        case_results = [\n            c0, c1, c2, c3, c4,\n            sigma_tot,\n            mu_avg,\n            r_fb\n        ]\n\n        # Round all results to six decimal places\n        rounded_results = [round(val, 6) for val in case_results]\n        all_results.append(rounded_results)\n\n    # Final print statement in the exact required format.\n    # The format requires a string representation of a list of lists.\n    results_str = ','.join([str(res) for res in all_results])\n    print(f\"[{results_str}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从单次相互作用转向大量中子群体的行为是反应堆模拟的核心。本练习将引导您学习蒙特卡罗方法中的一个基本概念：确定中子在固定时间间隔内的最终命运。您将从基本的截面数据中推导出俘获、裂变和存活的概率，从而一窥强大的模拟工具如何对中子输运进行建模 。",
            "id": "4238295",
            "problem": "考虑一个均匀、无限的介质，其中包含一种核素，在中子动能为 $E$ 时，其微观俘获截面为 $\\sigma_c(E)$，微观裂变截面为 $\\sigma_f(E)$。设微观总反应截面 $\\sigma_R(E)$ 定义为 $\\sigma_R(E) = \\sigma_c(E) + \\sigma_f(E)$。靶核的数密度为 $n$，单位为 $\\mathrm{m}^{-3}$。一个包含 $N_n$ 个中子的群体，所有中子均为能量为 $E$ 的单能中子，在宽度为 $\\Delta t$ 秒的固定时间步内进行追踪。假设中子在两次反应之间沿直线自由飞行，不发生散射，且介质在空间上是均匀的。\n\n仅从以下基本原理出发：\n- 非相对论性中子（质量为 $m_n$）的动能-速度关系：$E = \\tfrac{1}{2} m_n v^2$，因此速度 $v(E)$ 由能量 $E$ 决定。\n- 微观和宏观截面的定义：宏观总反应截面为 $\\Sigma_R(E) = n \\,\\sigma_R(E)$。\n- 在均匀介质中的独立相互作用假说，这意味着沿路径长度发生的反应是路径长度的泊松过程，其速率参数为 $\\Sigma_R(E)$。\n- 全概率定律和条件概率。\n\n基于这些基本原理，推导一种方法用于：\n- 计算一个中子在宽度为 $\\Delta t$ 的时间间隔内经历任何反应的概率。\n- 使用 $\\sigma_c(E)$ 和 $\\sigma_f(E)$ 将该概率分解为俘获和裂变两部分。\n- 计算该时间步内的期望计数：期望俘获数、期望裂变数以及未发生反应而存活的中子数。\n\n所有答案必须表示为计数（无量纲），并四舍五入到六位小数。请统一使用以下物理常数和单位：\n- 中子质量 $m_n$，单位为 $\\mathrm{kg}$。\n- 电子伏特到焦耳的转换关系：$1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$。\n- 截面单位：$1\\,\\mathrm{barn} = 10^{-28}\\,\\mathrm{m}^2$。\n- 速度单位为 $\\mathrm{m/s}$，时间单位为 $\\mathrm{s}$，数密度单位为 $\\mathrm{m}^{-3}$。\n\n你的程序必须实现所推导的方法，并将其应用于以下参数集测试套件。每个参数集是一个元组 $(N_n, E\\ \\mathrm{[eV]}, \\sigma_c\\ \\mathrm{[barn]}, \\sigma_f\\ \\mathrm{[barn]}, n\\ \\mathrm{[m^{-3}]}, \\Delta t\\ \\mathrm{[s]})$：\n- 测试 A（通用，类热中子）：$(N_n = 100000, E = 0.0253, \\sigma_c = 100.0, \\sigma_f = 500.0, n = 1.0\\times 10^{28}, \\Delta t = 1.0\\times 10^{-6})$。\n- 测试 B（快中子能区，小概率）：$(N_n = 50000, E = 1000000.0, \\sigma_c = 1.0, \\sigma_f = 2.0, n = 1.0\\times 10^{28}, \\Delta t = 1.0\\times 10^{-8})$。\n- 测试 C（纯吸收剂，无裂变）：$(N_n = 75000, E = 0.1, \\sigma_c = 20.0, \\sigma_f = 0.0, n = 1.0\\times 10^{27}, \\Delta t = 1.0\\times 10^{-4})$。\n- 测试 D（零能量，有限截面，有限密度）：$(N_n = 12345, E = 0.0, \\sigma_c = 5.0, \\sigma_f = 5.0, n = 1.0\\times 10^{28}, \\Delta t = 1.0\\times 10^{-6})$。\n- 测试 E（极低密度和小截面）：$(N_n = 1000000, E = 2.0, \\sigma_c = 0.01, \\sigma_f = 0.02, n = 1.0\\times 10^{20}, \\Delta t = 1.0\\times 10^{-3})$。\n\n对于每个测试，计算三个期望值：期望俘获数、期望裂变数、期望幸存数。你的程序应生成单行输出，其中包含所有测试的结果，格式为逗号分隔的浮点数列表，并用方括号括起，顺序如下：\n$[C_A,F_A,S_A,C_B,F_B,S_B,C_C,F_C,S_C,C_D,F_D,S_D,C_E,F_E,S_E]$，\n其中 $C_X$ 表示测试 $X$ 的期望俘获数，$F_X$ 表示测试 $X$ 的期望裂变数，$S_X$ 表示测试 $X$ 的期望幸存数。每个值都必须使用标准四舍五入规则保留六位小数。",
            "solution": "该问题要求一种方法，用于计算单能中子群体在均匀、无限介质中，于一小段时间步 $\\Delta t$ 内，发生俘获、裂变以及存活的期望中子数。推导过程必须基于一系列基本原理。让我们进行一个严谨的、分步的推导。\n\n给定场景的参数为：初始中子数 $N_n$，它们的中子动能 $E$，微观俘获和裂变截面 $\\sigma_c(E)$ 和 $\\sigma_f(E)$，核素数密度 $n$，以及时间步宽度 $\\Delta t$。\n\n**第1步：由动能计算中子速度**\n\n问题给出了质量为 $m_n$ 的非相对论性中子的动能关系式：\n$$E = \\frac{1}{2}m_n v^2$$\n能量 $E$ 以电子伏特（$\\mathrm{eV}$）为单位给出，必须将其转换为国际单位制中的焦耳（$\\mathrm{J}$），以便与以千克（$\\mathrm{kg}$）为单位的质量 $m_n$ 保持一致。设 $C_{eJ}$ 为转换因子 $1.602176634\\times 10^{-19}\\,\\mathrm{J/eV}$。以焦耳为单位的能量 $E_J$ 为 $E_J = E \\times C_{eJ}$。\n解出中子速度 $v$：\n$$v(E) = \\sqrt{\\frac{2E_J}{m_n}} = \\sqrt{\\frac{2 E C_{eJ}}{m_n}}$$\n速度 $v$ 的单位将是 $\\mathrm{m/s}$。存在 $E=0$ 的特殊情况，这意味着 $v=0$。一个静止的中子不会移动，因此无法发生相互作用。\n\n**第2步：宏观截面和相互作用率**\n\n微观总反应截面 $\\sigma_R(E)$ 定义为俘获截面和裂变截面之和：\n$$\\sigma_R(E) = \\sigma_c(E) + \\sigma_f(E)$$\n截面以靶恩（$\\mathrm{barn}$）为单位给出，其中 $1\\,\\mathrm{barn} = 10^{-28}\\,\\mathrm{m}^2$。在计算中，它们必须转换为 $\\mathrm{m}^2$。\n\n宏观总反应截面 $\\Sigma_R(E)$ 是数密度 $n$ 和微观总反应截面 $\\sigma_R(E)$ 的乘积。\n$$\\Sigma_R(E) = n \\sigma_R(E)$$\n量 $\\Sigma_R(E)$ 的单位是 $\\mathrm{m}^{-1}$，表示中子每行进单位路径长度发生一次相互作用的概率。\n\n**第3步：在时间间隔 $\\Delta t$ 内发生相互作用的概率**\n\n问题指出，沿中子路径的反应发生是关于路径长度 $s$ 的泊松过程，其速率参数为 $\\Sigma_R(E)$。一个中子在首次相互作用前行进至少距离 $s$ 的概率由指数分布的生存函数给出：\n$$P(\\text{路径长度}  s) = e^{-\\Sigma_R(E) s}$$\n假设直线飞行，速度为 $v(E)$ 的中子在时间间隔 $\\Delta t$ 内行进的距离为 $L = v(E) \\Delta t$。当且仅当一个中子的首次相互作用距离大于 $L$ 时，它才能在时间间隔 $\\Delta t$ 内未发生反应而存活下来。\n\n因此，单个中子在时间间隔 $\\Delta t$ 内存活的概率，记为 $P_{\\text{survive}}$，是：\n$$P_{\\text{survive}} = P(\\text{路径长度}  L) = e^{-\\Sigma_R(E) L} = e^{-\\Sigma_R(E) v(E) \\Delta t}$$\n指数 $\\lambda = \\Sigma_R(E) v(E) \\Delta t$ 是一个无量纲量，表示单个中子在时间 $\\Delta t$ 内发生相互作用的期望次数。\n\n一个中子在时间间隔 $\\Delta t$ 内经历任何反应的概率，记为 $P_{\\text{react}}$，是存活概率的补集：\n$$P_{\\text{react}} = 1 - P_{\\text{survive}} = 1 - e^{-\\Sigma_R(E) v(E) \\Delta t}$$\n\n**第4步：将反应概率分解为俘获和裂变**\n\n给定已发生一次反应，反应的类型（俘获或裂变）由它们各自微观截面的相对大小决定。问题假设没有散射，因此总反应截面就是 $\\sigma_R(E) = \\sigma_c(E) + \\sigma_f(E)$。\n\n使用条件概率定律，我们可以找到在发生反应的条件下，该反应是俘获的概率：\n$$P(\\text{俘获} | \\text{反应}) = \\frac{\\sigma_c(E)}{\\sigma_c(E) + \\sigma_f(E)} = \\frac{\\sigma_c(E)}{\\sigma_R(E)}$$\n类似地，对于裂变：\n$$P(\\text{裂变} | \\text{反应}) = \\frac{\\sigma_f(E)}{\\sigma_c(E) + \\sigma_f(E)} = \\frac{\\sigma_f(E)}{\\sigma_R(E)}$$\n一个中子在时间间隔 $\\Delta t$ 内被俘获的无条件概率 $P_{\\text{capture}}$，是任何反应发生的概率与该反应是俘获的条件概率的乘积：\n$$P_{\\text{capture}} = P(\\text{俘获} | \\text{反应}) \\times P_{\\text{react}} = \\frac{\\sigma_c(E)}{\\sigma_R(E)} \\left(1 - e^{-\\Sigma_R(E) v(E) \\Delta t}\\right)$$\n类似地，裂变的无条件概率 $P_{\\text{fission}}$ 是：\n$$P_{\\text{fission}} = P(\\text{裂变} | \\text{反应}) \\times P_{\\text{react}} = \\frac{\\sigma_f(E)}{\\sigma_R(E)} \\left(1 - e^{-\\Sigma_R(E) v(E) \\Delta t}\\right)$$\n注意，$P_{\\text{capture}} + P_{\\text{fission}} + P_{\\text{survive}} = 1$，符合要求。\n\n**第5步：计算期望计数**\n\n对于一个包含 $N_n$ 个独立中子的群体，经历特定事件（俘获、裂变或存活）的中子数量遵循二项分布。期望值是试验次数（$N_n$）与事件概率的乘积。\n\n期望俘获数 $\\mathbb{E}[N_c]$：\n$$\\mathbb{E}[N_c] = N_n \\times P_{\\text{capture}} = N_n \\frac{\\sigma_c(E)}{\\sigma_R(E)} \\left(1 - e^{-\\Sigma_R(E) v(E) \\Delta t}\\right)$$\n\n期望裂变数 $\\mathbb{E}[N_f]$：\n$$\\mathbb{E}[N_f] = N_n \\times P_{\\text{fission}} = N_n \\frac{\\sigma_f(E)}{\\sigma_R(E)} \\left(1 - e^{-\\Sigma_R(E) v(E) \\Delta t}\\right)$$\n\n期望存活数 $\\mathbb{E}[N_s]$：\n$$\\mathbb{E}[N_s] = N_n \\times P_{\\text{survive}} = N_n e^{-\\Sigma_R(E) v(E) \\Delta t}$$\n这些期望值之和正确地重构了初始群体大小：$\\mathbb{E}[N_c] + \\mathbb{E}[N_f] + \\mathbb{E}[N_s] = N_n$。\n\n至此，该方法的推导完成。实现将系统地将这些公式应用于每个测试用例，并谨慎处理单位和物理常数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the neutron transport problem for a suite of test cases.\n    \"\"\"\n    # Physical constants\n    EV_TO_J = 1.602176634e-19  # Electronvolt to Joule conversion\n    BARN_TO_M2 = 1e-28         # Barn to square meter conversion\n    M_N = 1.67492749804e-27    # Neutron mass in kg\n\n    # Test cases: (N_n, E [eV], sigma_c [barn], sigma_f [barn], n [m^-3], dt [s])\n    test_cases = [\n        (100000, 0.0253, 100.0, 500.0, 1.0e28, 1.0e-6),      # Test A\n        (50000, 1000000.0, 1.0, 2.0, 1.0e28, 1.0e-8),       # Test B\n        (75000, 0.1, 20.0, 0.0, 1.0e27, 1.0e-4),            # Test C\n        (12345, 0.0, 5.0, 5.0, 1.0e28, 1.0e-6),             # Test D\n        (1000000, 2.0, 0.01, 0.02, 1.0e20, 1.0e-3),         # Test E\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N_n, E_ev, sig_c_b, sig_f_b, n, dt = case\n\n        # Step 1: Neutron Speed\n        if E_ev == 0.0:\n            v = 0.0\n        else:\n            E_j = E_ev * EV_TO_J\n            v = np.sqrt(2 * E_j / M_N)\n\n        # Step 2: Macroscopic Cross Section\n        sig_c_m2 = sig_c_b * BARN_TO_M2\n        sig_f_m2 = sig_f_b * BARN_TO_M2\n        sig_R_m2 = sig_c_m2 + sig_f_m2\n        \n        Sigma_R = n * sig_R_m2\n\n        # Step 3  4: Probabilities\n        lambda_val = Sigma_R * v * dt\n        \n        P_survive = np.exp(-lambda_val)\n        P_react = 1.0 - P_survive\n\n        # Handle division by zero if total cross section is zero\n        if sig_R_m2 == 0.0:\n            P_capture_given_reaction = 0.0\n            P_fission_given_reaction = 0.0\n        else:\n            P_capture_given_reaction = sig_c_m2 / sig_R_m2\n            P_fission_given_reaction = sig_f_m2 / sig_R_m2\n\n        P_capture = P_capture_given_reaction * P_react\n        P_fission = P_fission_given_reaction * P_react\n\n        # Step 5: Expected Tallies\n        expected_captures = N_n * P_capture\n        expected_fissions = N_n * P_fission\n        expected_survivors = N_n * P_survive\n\n        results.extend([expected_captures, expected_fissions, expected_survivors])\n\n    # Format output to six decimal places\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}