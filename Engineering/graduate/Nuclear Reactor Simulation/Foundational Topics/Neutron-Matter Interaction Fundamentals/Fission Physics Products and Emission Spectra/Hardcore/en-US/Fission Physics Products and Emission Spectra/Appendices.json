{
    "hands_on_practices": [
        {
            "introduction": "Understanding the energy partitioning in a fission event is fundamental to reactor physics. This exercise focuses on a key component of this energy budget: the kinetic energy carried away by prompt neutrons. By working from first principles with the widely used Maxwellian spectrum model , you will derive the average neutron energy and apply it to a macroscopic energy balance, providing a crucial link between microscopic emission physics and the total energy release.",
            "id": "4226518",
            "problem": "Consider a single thermal-neutron-induced fission event of uranium-$235$ in a reactor simulation. Let the average prompt neutron multiplicity be $\\bar{\\nu} = 2.43$. The prompt neutron kinetic energy spectrum per emitted neutron is modeled by the Maxwellian evaporation Probability Density Function (PDF)\n$$\nf_{n}(E;T) = \\frac{2}{\\sqrt{\\pi}}\\,\\frac{1}{T^{3/2}}\\,\\sqrt{E}\\,\\exp\\!\\left(-\\frac{E}{T}\\right), \\quad E \\ge 0,\n$$\nwith temperature parameter $T = 1.32~\\text{MeV}$ (here $T$ is in energy units and subsumes Boltzmannâ€™s constant). The total mass-energy release (Q-value) per fission is $Q = 202.36~\\text{MeV}$, the average combined kinetic energy of the fission fragments is $E_{F} = 167.4~\\text{MeV}$, and the average prompt gamma-ray energy is $E_{\\gamma} = 6.6~\\text{MeV}$.\n\nStarting from first principles and core definitions for ensemble averages and energy conservation:\n1. Derive the ensemble-average kinetic energy per prompt neutron, $\\langle \\epsilon_{n} \\rangle$, implied by $f_{n}(E;T)$.\n2. Using the definition of an ensemble average over independent and identically distributed prompt neutrons and the given $\\bar{\\nu}$, obtain the total average prompt neutron energy per fission event.\n3. Enforce energy conservation to determine the residual energy assigned to non-prompt channels, $E_{\\text{res}}$, by subtracting the fragment kinetic energy, the total prompt neutron energy, and the prompt gamma energy from $Q$.\n\nExpress your final result for $E_{\\text{res}}$ in $\\text{MeV}$ and round your answer to four significant figures.",
            "solution": "The problem is evaluated to be scientifically grounded, well-posed, and internally consistent. All provided data and the physical model (Maxwellian spectrum for fission neutrons) are standard in the field of nuclear reactor physics. The problem is therefore valid, and a solution can be formulated.\n\nThe solution proceeds by following the three steps outlined in the problem statement.\n\n**Part 1: Derivation of the ensemble-average kinetic energy per prompt neutron, $\\langle \\epsilon_{n} \\rangle$**\n\nThe ensemble-average kinetic energy, $\\langle \\epsilon_{n} \\rangle$, of a prompt neutron is the expectation value of the energy variable $E$ with respect to its Probability Density Function (PDF), $f_{n}(E;T)$. The definition of the expectation value for a continuous variable distributed over $[0, \\infty)$ is:\n$$\n\\langle \\epsilon_{n} \\rangle = \\int_{0}^{\\infty} E \\cdot f_{n}(E;T) \\, dE\n$$\nSubstituting the given Maxwellian PDF:\n$$\nf_{n}(E;T) = \\frac{2}{\\sqrt{\\pi}}\\,\\frac{1}{T^{3/2}}\\,\\sqrt{E}\\,\\exp\\!\\left(-\\frac{E}{T}\\right)\n$$\nwhere $T$ is the temperature parameter in energy units. The integral for the average energy becomes:\n$$\n\\langle \\epsilon_{n} \\rangle = \\int_{0}^{\\infty} E \\left( \\frac{2}{\\sqrt{\\pi} \\, T^{3/2}} E^{1/2} \\exp\\!\\left(-\\frac{E}{T}\\right) \\right) dE\n$$\nWe can combine the terms involving $E$ and move the constants outside the integral:\n$$\n\\langle \\epsilon_{n} \\rangle = \\frac{2}{\\sqrt{\\pi} \\, T^{3/2}} \\int_{0}^{\\infty} E^{3/2} \\exp\\!\\left(-\\frac{E}{T}\\right) dE\n$$\nTo evaluate this integral, we perform a change of variables. Let $x = E/T$. Then $E = xT$ and $dE = T dx$. The limits of integration remain from $0$ to $\\infty$. Substituting these into the integral:\n$$\n\\langle \\epsilon_{n} \\rangle = \\frac{2}{\\sqrt{\\pi} \\, T^{3/2}} \\int_{0}^{\\infty} (xT)^{3/2} \\exp(-x) \\, (T \\, dx)\n$$\n$$\n\\langle \\epsilon_{n} \\rangle = \\frac{2}{\\sqrt{\\pi} \\, T^{3/2}} \\, T^{3/2} \\, T \\int_{0}^{\\infty} x^{3/2} \\exp(-x) \\, dx\n$$\n$$\n\\langle \\epsilon_{n} \\rangle = \\frac{2T}{\\sqrt{\\pi}} \\int_{0}^{\\infty} x^{3/2} \\exp(-x) \\, dx\n$$\nThe remaining integral is in the form of the Gamma function, $\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1} \\exp(-t) \\, dt$. In our case, the exponent of $x$ is $3/2$, so $z-1 = 3/2$, which implies $z=5/2$. Therefore, the integral is $\\Gamma(5/2)$.\nThe Gamma function has the property $\\Gamma(z+1) = z\\Gamma(z)$. We can use this to evaluate $\\Gamma(5/2)$:\n$$\n\\Gamma(5/2) = \\Gamma(3/2 + 1) = \\frac{3}{2} \\Gamma(3/2) = \\frac{3}{2} \\Gamma(1/2 + 1) = \\frac{3}{2} \\left( \\frac{1}{2} \\Gamma(1/2) \\right)\n$$\nGiven that $\\Gamma(1/2) = \\sqrt{\\pi}$, we have:\n$$\n\\Gamma(5/2) = \\frac{3}{4} \\sqrt{\\pi}\n$$\nSubstituting this result back into the expression for $\\langle \\epsilon_{n} \\rangle$:\n$$\n\\langle \\epsilon_{n} \\rangle = \\frac{2T}{\\sqrt{\\pi}} \\left( \\frac{3\\sqrt{\\pi}}{4} \\right) = \\frac{3}{2}T\n$$\nThis is the analytical expression for the average kinetic energy of a neutron described by the Maxwellian spectrum. With the given temperature parameter $T = 1.32~\\text{MeV}$:\n$$\n\\langle \\epsilon_{n} \\rangle = \\frac{3}{2} (1.32~\\text{MeV}) = 1.98~\\text{MeV}\n$$\n\n**Part 2: Calculation of the total average prompt neutron energy per fission event**\n\nThe total average prompt neutron energy per fission, which we denote as $E_{n, \\text{total}}$, is the product of the average number of prompt neutrons emitted per fission, $\\bar{\\nu}$, and the average kinetic energy per neutron, $\\langle \\epsilon_{n} \\rangle$. The neutrons are treated as independent and identically distributed.\n$$\nE_{n, \\text{total}} = \\bar{\\nu} \\cdot \\langle \\epsilon_{n} \\rangle\n$$\nUsing the given value $\\bar{\\nu} = 2.43$ and the result from Part 1:\n$$\nE_{n, \\text{total}} = 2.43 \\times 1.98~\\text{MeV} = 4.8114~\\text{MeV}\n$$\n\n**Part 3: Determination of the residual energy, $E_{\\text{res}}$**\n\nThe principle of energy conservation dictates that the total energy released in the fission event, the Q-value ($Q$), must be fully accounted for by the energies of all the products. The problem specifies the major prompt energy components: the kinetic energy of the fission fragments ($E_{F}$), the total kinetic energy of the prompt neutrons ($E_{n, \\text{total}}$), and the total energy of prompt gamma rays ($E_{\\gamma}$). The remaining energy is the residual energy, $E_{\\text{res}}$, which primarily includes the decay energy of fission products (beta particles, antineutrinos, and delayed gamma rays).\nThe energy balance equation is:\n$$\nQ = E_{F} + E_{n, \\text{total}} + E_{\\gamma} + E_{\\text{res}}\n$$\nWe can solve for $E_{\\text{res}}$:\n$$\nE_{\\text{res}} = Q - E_{F} - E_{n, \\text{total}} - E_{\\gamma}\n$$\nSubstituting the given and calculated values:\n$Q = 202.36~\\text{MeV}$\n$E_{F} = 167.4~\\text{MeV}$\n$E_{n, \\text{total}} = 4.8114~\\text{MeV}$\n$E_{\\gamma} = 6.6~\\text{MeV}$\n$$\nE_{\\text{res}} = 202.36~\\text{MeV} - 167.4~\\text{MeV} - 4.8114~\\text{MeV} - 6.6~\\text{MeV}\n$$\n$$\nE_{\\text{res}} = 202.36~\\text{MeV} - (167.4 + 4.8114 + 6.6)~\\text{MeV}\n$$\n$$\nE_{\\text{res}} = 202.36~\\text{MeV} - 178.8114~\\text{MeV}\n$$\n$$\nE_{\\text{res}} = 23.5486~\\text{MeV}\n$$\nThe problem requires the final result to be rounded to four significant figures.\n$$\nE_{\\text{res}} \\approx 23.55~\\text{MeV}\n$$\nThis residual energy accounts for channels not included in the prompt energy release, such as the energy carried away by beta particles and antineutrinos from the subsequent decay of the unstable fission fragments, as well as delayed gamma and neutron emissions.",
            "answer": "$$\\boxed{23.55}$$"
        },
        {
            "introduction": "After a fission event, the unstable fission products undergo radioactive decay, releasing a significant amount of energy known as decay heat. This practice moves from the prompt physics of fission to the time-dependent behavior of these products, a critical aspect of reactor safety and operation. In this coding exercise , you will implement a computational model to calculate the decay heat power from a representative set of fission products, translating the fundamental equations of nuclear inventory evolution into a practical simulation tool.",
            "id": "4226484",
            "problem": "You are given a simplified, yet scientifically grounded, modeling task to calculate post-shutdown decay heat power arising from beta decays of selected fission products in a nuclear reactor simulation context. The reactor operates at a constant pre-shutdown thermal power for a specified irradiation time, producing a set of fission products characterized by independent yields, half-lives, and mean beta decay energies. At a prescribed time after shutdown, you will compute the total beta-decay power via a summation over activities.\n\nUse the following foundational bases:\n\n- Number density evolution under production and radioactive decay: for nuclide index $i$, the inventory $N_i(t)$ satisfies the linear first-order ordinary differential equation $dN_i/dt = R_f Y_i - \\lambda_i N_i$, where $R_f$ is the fission rate, $Y_i$ is the per-fission independent yield for the nuclide, and $\\lambda_i$ is the decay constant.\n- Radioactive decay relationship between activity and inventory: $A_i(t) = \\lambda_i N_i(t)$.\n- Pre-shutdown fission rate: $R_f = P_{\\mathrm{th}} / E_f$, where $P_{\\mathrm{th}}$ is the thermal power and $E_f$ is the energy released per fission.\n- Mean energy released per beta decay (electrons only; antineutrino energy is not deposited locally): $E_{\\beta,i}$ is provided per nuclide.\n- Decay constant: $\\lambda_i = \\ln(2) / t_{1/2,i}$, with $t_{1/2,i}$ the half-life.\n\nAssume constant pre-shutdown operation at thermal power $P_{\\mathrm{th}}$ for an irradiation duration $T_{\\mathrm{irr}}$, followed by instantaneous shutdown at time $t=0$. Ignore neutron capture, precursor buildup beyond the provided independent yields, gamma-ray energy deposition, and spatial effects. Calculate the total beta-decay power at time $t=1\\,\\mathrm{s}$ after shutdown via the summation of activities multiplied by their mean beta energies.\n\nConstants and units to use:\n\n- Fission energy per fission: $E_f = 200\\,\\mathrm{MeV}$.\n- Energy unit conversion: $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$, hence $1\\,\\mathrm{MeV} = 1.602176634 \\times 10^{-13}\\,\\mathrm{J}$.\n- Thermal power $P_{\\mathrm{th}}$ is in watts, time in seconds, and energies in megaelectronvolts; express the final decay heat power in watts. Use the International System of Units (SI).\n\nUse the following representative subset of fission products (independent yields for thermal fission of uranium-$235$, mean beta energies are approximate averages of emitted electron kinetic energies per decay):\n\n- Rubidium-$92$: independent yield $Y = 0.060$, half-life $t_{1/2} = 4.50\\,\\mathrm{s}$, mean beta energy $E_{\\beta} = 3.50\\,\\mathrm{MeV}$.\n- Yttrium-$96$: independent yield $Y = 0.045$, half-life $t_{1/2} = 5.35\\,\\mathrm{s}$, mean beta energy $E_{\\beta} = 3.00\\,\\mathrm{MeV}$.\n- Iodine-$137$: independent yield $Y = 0.042$, half-life $t_{1/2} = 24.00\\,\\mathrm{s}$, mean beta energy $E_{\\beta} = 2.00\\,\\mathrm{MeV}$.\n- Tellurium-$135$: independent yield $Y = 0.048$, half-life $t_{1/2} = 19.00\\,\\mathrm{s}$, mean beta energy $E_{\\beta} = 2.50\\,\\mathrm{MeV}$.\n- Rubidium-$94$: independent yield $Y = 0.030$, half-life $t_{1/2} = 2.70\\,\\mathrm{s}$, mean beta energy $E_{\\beta} = 3.80\\,\\mathrm{MeV}$.\n\nYour program must implement the following computation pipeline:\n\n- Compute $R_f = P_{\\mathrm{th}} / (E_f \\times 1.602176634 \\times 10^{-13}\\,\\mathrm{J/MeV})$.\n- For each nuclide $i$, compute $\\lambda_i = \\ln(2) / t_{1/2,i}$.\n- For each nuclide $i$, compute the inventory at shutdown ($t=0$) for constant irradiation from $t=-T_{\\mathrm{irr}}$ to $0$ from the linear model above.\n- At $t=1\\,\\mathrm{s}$ after shutdown, compute $A_i(1)$ and the beta power contribution $P_{\\beta,i}(1) = A_i(1)\\,E_{\\beta,i}$ converted to joules per decay.\n- Sum over nuclides to obtain $P_{\\beta}(1) = \\sum_i P_{\\beta,i}(1)$.\n\nTest suite and required final output:\n\nImplement the calculation for the following five test cases to ensure coverage of typical, short-irradiation, near-saturation, and edge conditions. Use $t = 1\\,\\mathrm{s}$ after shutdown in all cases.\n\n- Case $1$: $P_{\\mathrm{th}} = 3.0 \\times 10^{9}\\,\\mathrm{W}$, $T_{\\mathrm{irr}} = 1.0 \\times 10^{5}\\,\\mathrm{s}$.\n- Case $2$: $P_{\\mathrm{th}} = 1.0 \\times 10^{8}\\,\\mathrm{W}$, $T_{\\mathrm{irr}} = 1.0 \\times 10^{1}\\,\\mathrm{s}$.\n- Case $3$: $P_{\\mathrm{th}} = 3.0 \\times 10^{9}\\,\\mathrm{W}$, $T_{\\mathrm{irr}} = 1.0 \\times 10^{6}\\,\\mathrm{s}$.\n- Case $4$: $P_{\\mathrm{th}} = 0.0\\,\\mathrm{W}$, $T_{\\mathrm{irr}} = 1.0 \\times 10^{5}\\,\\mathrm{s}$.\n- Case $5$: $P_{\\mathrm{th}} = 3.0 \\times 10^{9}\\,\\mathrm{W}$, $T_{\\mathrm{irr}} = 0.0\\,\\mathrm{s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry the computed decay heat power $P_{\\beta}(1)$ in watts for the corresponding case, as floating-point numbers (e.g., $[x_1,x_2,x_3,x_4,x_5]$). No other text should be printed.",
            "solution": "The problem is assessed to be scientifically grounded, well-posed, and objective. It provides a complete and consistent set of data, physical models, and constraints to determine a unique, meaningful solution. The methodology will follow the principles of radioactive decay and reactor physics.\n\nThe primary objective is to calculate the total beta-decay power, $P_{\\beta}$, at a specific time, $t$, after reactor shutdown. This power originates from a given set of fission products. The reactor has operated at a constant thermal power, $P_{\\mathrm{th}}$, for an irradiation time, $T_{\\mathrm{irr}}$.\n\nFirst, we establish the constant fission rate, $R_f$, during the pre-shutdown operational period. The thermal power $P_{\\mathrm{th}}$ (in Watts, or Joules per second) is generated by fissions, each releasing an average energy $E_f$ (in Joules).\nThe energy per fission must be converted from Mega-electronvolts ($MeV$) to Joules ($J$) using the given conversion factor $C_{MeV\\_to\\_J} = 1.602176634 \\times 10^{-13}\\,\\mathrm{J/MeV}$.\n$$E_f [\\mathrm{J}] = E_f [\\mathrm{MeV}] \\times C_{MeV\\_to\\_J}$$\nThe fission rate is then:\n$$R_f = \\frac{P_{\\mathrm{th}}}{E_f [\\mathrm{J}]} = \\frac{P_{\\mathrm{th}}}{E_f [\\mathrm{MeV}] \\times C_{MeV\\_to\\_J}}$$\n\nDuring irradiation, each fission product nuclide $i$ is produced at a constant rate $R_f Y_i$, where $Y_i$ is its independent fission yield. Simultaneously, it decays radioactively. The evolution of the number of atoms (inventory), $N_i$, of nuclide $i$ is described by the first-order linear ordinary differential equation:\n$$\\frac{dN_i}{dt'} = R_f Y_i - \\lambda_i N_i(t')$$\nwhere $\\lambda_i$ is the decay constant, related to the half-life $t_{1/2,i}$ by $\\lambda_i = \\ln(2) / t_{1/2,i}$. We denote the time variable during irradiation as $t'$, which runs from $-T_{\\mathrm{irr}}$ to $0$. Assuming the inventory of each nuclide is zero at the start of irradiation ($N_i(-T_{\\mathrm{irr}}) = 0$), the solution to this differential equation is:\n$$N_i(t') = \\frac{R_f Y_i}{\\lambda_i} \\left( 1 - e^{-\\lambda_i (t' + T_{\\mathrm{irr}})} \\right)$$\nAt the moment of shutdown ($t' = 0$), the inventory of nuclide $i$ is:\n$$N_i(0) = \\frac{R_f Y_i}{\\lambda_i} \\left( 1 - e^{-\\lambda_i T_{\\mathrm{irr}}} \\right)$$\nThis term captures the buildup of the fission product, approaching a saturation level $\\frac{R_f Y_i}{\\lambda_i}$ for very long irradiation times ($T_{\\mathrm{irr}} \\gg 1/\\lambda_i$).\n\nAfter shutdown at $t=0$, the production term $R_f Y_i$ ceases. The inventory of each nuclide $i$ subsequently decreases solely due to radioactive decay, following the equation:\n$$\\frac{dN_i}{dt} = -\\lambda_i N_i(t) \\quad (\\text{for } t > 0)$$\nWith the initial condition $N_i(0)$ determined above, the solution for the post-shutdown inventory at time $t$ is:\n$$N_i(t) = N_i(0) e^{-\\lambda_i t} = \\frac{R_f Y_i}{\\lambda_i} \\left( 1 - e^{-\\lambda_i T_{\\mathrm{irr}}} \\right) e^{-\\lambda_i t}$$\nThe activity of nuclide $i$, $A_i(t)$, which is the number of decays per second, is defined as $A_i(t) = \\lambda_i N_i(t)$.\n$$A_i(t) = \\lambda_i \\left[ \\frac{R_f Y_i}{\\lambda_i} \\left( 1 - e^{-\\lambda_i T_{\\mathrm{irr}}} \\right) e^{-\\lambda_i t} \\right] = R_f Y_i \\left( 1 - e^{-\\lambda_i T_{\\mathrm{irr}}} \\right) e^{-\\lambda_i t}$$\n\nEach beta decay of nuclide $i$ releases an average energy $E_{\\beta,i}$. The power contribution from nuclide $i$, $P_{\\beta,i}(t)$, is the product of its activity and the energy released per decay, converted to Watts.\n$$P_{\\beta,i}(t) [\\mathrm{W}] = A_i(t) [\\mathrm{s}^{-1}] \\times E_{\\beta,i} [\\mathrm{MeV}] \\times C_{MeV\\_to\\_J} [\\mathrm{J/MeV}]$$\nSubstituting the expressions for $A_i(t)$ and $R_f$:\n$$P_{\\beta,i}(t) = \\left[ \\frac{P_{\\mathrm{th}}}{E_f [\\mathrm{MeV}] \\times C_{MeV\\_to\\_J}} \\right] Y_i \\left( 1 - e^{-\\lambda_i T_{\\mathrm{irr}}} \\right) e^{-\\lambda_i t} \\times E_{\\beta,i} [\\mathrm{MeV}] \\times C_{MeV\\_to\\_J}$$\nThe conversion factor $C_{MeV\\_to\\_J}$ cancels out, leading to a simplified expression for the power contribution of nuclide $i$ in Watts:\n$$P_{\\beta,i}(t) = \\frac{P_{\\mathrm{th}}}{E_f} Y_i E_{\\beta,i} \\left( 1 - e^{-\\lambda_i T_{\\mathrm{irr}}} \\right) e^{-\\lambda_i t}$$\nNote that in this final expression, both $E_f$ and $E_{\\beta,i}$ must be in the same units (MeV, as given), and $P_{\\mathrm{th}}$ must be in Watts.\n\nThe total beta-decay power, $P_{\\beta}(t)$, at time $t = 1\\,\\mathrm{s}$ after shutdown is the sum of the contributions from all specified fission products:\n$$P_{\\beta}(t=1\\,\\mathrm{s}) = \\sum_i P_{\\beta,i}(t=1\\,\\mathrm{s})$$\n$$P_{\\beta}(t=1\\,\\mathrm{s}) = \\frac{P_{\\mathrm{th}}}{E_f} \\sum_i \\left[ Y_i E_{\\beta,i} \\left( 1 - e^{-\\lambda_i T_{\\mathrm{irr}}} \\right) e^{-\\lambda_i \\cdot 1} \\right]$$\nThis final formula provides a direct method for calculating the required total decay power for each test case. The formula correctly evaluates to $0$ for the edge cases where $P_{\\mathrm{th}} = 0$ or $T_{\\mathrm{irr}} = 0$.\n\nThe computational procedure is as follows:\n1.  Define the constants $E_f=200\\,\\mathrm{MeV}$ and the cooling time $t=1\\,\\mathrm{s}$.\n2.  For each nuclide, calculate its decay constant $\\lambda_i = \\ln(2)/t_{1/2,i}$.\n3.  For each test case (defined by $P_{\\mathrm{th}}$ and $T_{\\mathrm{irr}}$):\n    a. If $P_{\\mathrm{th}}$ or $T_{\\mathrm{irr}}$ is zero, the result is $0$.\n    b. Otherwise, calculate the summation term $\\sum_i Y_i E_{\\beta,i} (1 - e^{-\\lambda_i T_{\\mathrm{irr}}}) e^{-\\lambda_i t}$.\n    c. Compute the total power $P_{\\beta}(t)$ using the final derived formula.\n4.  Collect the results for all test cases and format the output as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the post-shutdown beta decay heat power from a set of fission products\n    for several test cases, based on a simplified reactor physics model.\n    \"\"\"\n\n    # --- Constants and Units ---\n    # Energy released per fission in MeV\n    E_FISSION_MEV = 200.0\n    # Time after shutdown for which to calculate the power, in seconds\n    T_COOL = 1.0\n\n    # --- Fission Product Data ---\n    # A dictionary holding the properties for each nuclide.\n    # Y: Independent fission yield (dimensionless)\n    # t_half: Half-life (seconds)\n    # E_beta: Mean beta decay energy (MeV)\n    nuclide_data = {\n        'Rb-92': {'Y': 0.060, 't_half': 4.50, 'E_beta': 3.50},\n        'Y-96':  {'Y': 0.045, 't_half': 5.35, 'E_beta': 3.00},\n        'I-137': {'Y': 0.042, 't_half': 24.00, 'E_beta': 2.00},\n        'Te-135':{'Y': 0.048, 't_half': 19.00, 'E_beta': 2.50},\n        'Rb-94': {'Y': 0.030, 't_half': 2.70, 'E_beta': 3.80}\n    }\n\n    # Pre-calculate decay constants (lambda) for each nuclide\n    for nuclide in nuclide_data.values():\n        nuclide['lambda'] = np.log(2) / nuclide['t_half']\n\n    # --- Test Cases ---\n    # A list of tuples, where each tuple is (P_th_W, T_irr_s)\n    # P_th_W: Pre-shutdown thermal power in Watts\n    # T_irr_s: Irradiation duration in seconds\n    test_cases = [\n        (3.0e9, 1.0e5),\n        (1.0e8, 1.0e1),\n        (3.0e9, 1.0e6),\n        (0.0,   1.0e5),\n        (3.0e9, 0.0),\n    ]\n\n    def calculate_decay_power(P_th_W, T_irr_s):\n        \"\"\"\n        Computes the total beta decay power for a given set of operating conditions.\n\n        Args:\n            P_th_W (float): Pre-shutdown thermal power in Watts.\n            T_irr_s (float): Irradiation time in seconds.\n\n        Returns:\n            float: Total beta decay power in Watts at T_COOL after shutdown.\n        \"\"\"\n        # Handle edge cases where power is zero if P_th or T_irr is zero.\n        if P_th_W == 0.0 or T_irr_s == 0.0:\n            return 0.0\n\n        sum_term = 0.0\n        for nuclide in nuclide_data.values():\n            Y = nuclide['Y']\n            E_beta = nuclide['E_beta']\n            lam = nuclide['lambda']\n            \n            # Buildup term: (1 - exp(-lambda * T_irr))\n            # This factor represents the fraction of saturation inventory reached.\n            buildup_factor = 1.0 - np.exp(-lam * T_irr_s)\n            \n            # Decay term: exp(-lambda * t_cool)\n            # This factor represents the decay of the inventory after shutdown.\n            decay_factor = np.exp(-lam * T_COOL)\n            \n            sum_term += Y * E_beta * buildup_factor * decay_factor\n\n        # Final formula: P_decay = (P_th / E_fission) * sum_term\n        total_decay_power_W = (P_th_W / E_FISSION_MEV) * sum_term\n        \n        return total_decay_power_W\n\n    # --- Main Calculation Loop ---\n    results = []\n    for P_th, T_irr in test_cases:\n        decay_power = calculate_decay_power(P_th, T_irr)\n        results.append(decay_power)\n    \n    # --- Output ---\n    # Format the results into the required string format: [r1,r2,r3,r4,r5]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While average quantities provide a useful overview of fission, a detailed understanding for modern simulation requires an event-by-event approach. This capstone practice challenges you to construct a complete, stochastic model of a single fission event from first principles. By sampling fragment properties and emissions from physical distributions and then enforcing the conservation of mass, charge, energy, and momentum , you will develop a powerful tool that mirrors the sophisticated event generators used in advanced research and simulation codes.",
            "id": "4226561",
            "problem": "Consider a single prompt fission event of Uranium-235 absorbing a thermal neutron to form an excited compound nucleus, denoted as Uranium-236 star. The compound nucleus is assumed to be at rest in the center-of-mass frame immediately prior to scission. You will write a program that stochastically samples a physically consistent realization of the event, producing a sequence of quantities $\\left(A,Z,\\mathrm{TKE},\\nu,E_{n,i},E_{\\gamma,j}\\right)$ that obey conservation of energy, momentum, mass number, and charge, and are scientifically plausible given widely accepted empirical characterizations of prompt emissions in nuclear fission.\n\nThe fundamental base for the derivation is:\n\n- Energy conservation: In the center-of-mass frame with the compound nucleus at rest, the total energy available for kinetic and radiation emission is the $Q$-value of fission, $Q = \\left(M_{\\mathrm{in}} - M_{\\mathrm{out}}\\right)c^2$, which is widely observed to be of order $200\\,\\mathrm{MeV}$ in Uranium-235 thermal fission. The available energy is partitioned into fragment kinetic energy, prompt neutron kinetic energy, and prompt gamma-ray energy, satisfying\n$$\nQ = \\mathrm{TKE} + \\sum_{i=1}^{\\nu} E_{n,i} + \\sum_{j=1}^{N_{\\gamma}} E_{\\gamma,j},\n$$\nwhere $\\mathrm{TKE}$ is the Total Kinetic Energy (TKE) of the two fragments after prompt emission, $E_{n,i}$ are the kinetic energies of the $\\nu$ prompt neutrons, and $E_{\\gamma,j}$ are the energies of the $N_{\\gamma}$ prompt gamma rays.\n\n- Momentum conservation: In the center-of-mass frame, the vector sum of all final-state momenta must be zero. Denote the fragment momenta by $\\mathbf{p}_1$ and $\\mathbf{p}_2$, the neutron momenta by $\\mathbf{p}_{n,i}$, and the gamma-ray momenta by $\\mathbf{p}_{\\gamma,j}$; then\n$$\n\\mathbf{p}_1 + \\mathbf{p}_2 + \\sum_{i=1}^{\\nu} \\mathbf{p}_{n,i} + \\sum_{j=1}^{N_{\\gamma}} \\mathbf{p}_{\\gamma,j} = \\mathbf{0}.\n$$\n\n- Charge conservation: The sum of fragment charges equals the charge of the compound nucleus,\n$$\nZ_1 + Z_2 = Z_{\\mathrm{CN}},\n$$\nand the Unchanged Charge Distribution (UCD) approximation assigns fragment charges near the mean $Z_i \\approx \\left( Z_{\\mathrm{CN}} / A_{\\mathrm{CN}} \\right) A_i$, rounded to the nearest integer with a corrective adjustment to enforce exact charge conservation.\n\n- Mass number conservation: The mass numbers satisfy\n$$\nA_1 + A_2 + \\nu = A_{\\mathrm{CN}},\n$$\nsince prompt neutrons carry away one unit of mass number each and have zero charge.\n\n- Relativistic kinematics: For any particle of rest mass $m$ and momentum magnitude $p$, the kinetic energy is\n$$\nK(p,m) = \\sqrt{p^2 c^2 + m^2 c^4} - m c^2,\n$$\nand the inverse relation for a given kinetic energy is\n$$\np(K,m) = \\frac{1}{c} \\sqrt{K^2 + 2 K m c^2}.\n$$\nPhotons have zero rest mass, so $p_{\\gamma} = E_{\\gamma} / c$.\n\nYour program shall sample and construct a consistent event according to the following rules and then verify the conservation laws:\n\n- Center-of-mass nucleus and constants:\n  - Use the compound nucleus Uranium-236 star characterized by $A_{\\mathrm{CN}} = 236$ and $Z_{\\mathrm{CN}} = 92$.\n  - Use the unified atomic mass unit $u$ with $m_u c^2 = 931.49410242\\,\\mathrm{MeV}$, and the neutron rest mass energy $m_n c^2 = 939.5654133\\,\\mathrm{MeV}$. Work in units where $c = 1$, so energies are in $\\mathrm{MeV}$, momenta are in $\\mathrm{MeV}/c$, and masses are in $\\mathrm{MeV}/c^2$.\n\n- Sampling of multiplicities and fragment mass numbers:\n  - Sample the prompt neutron multiplicity $\\nu$ from a Poisson distribution with mean $\\bar{\\nu}$; alternatively, a test case may specify a forced integer value of $\\nu$.\n  - Sample the light fragment mass number $A_1$ from a truncated normal distribution with mean $\\mu_A$ and standard deviation $\\sigma_A$, restricted to integer values in a physically plausible range $\\left[A_{\\min},A_{\\max}\\right]$. Set the heavy fragment mass number to $A_2 = A_{\\mathrm{CN}} - \\nu - A_1$. If $A_2$ falls outside $\\left[A_{\\min},A_{\\max}\\right]$, resample $A_1$ until an acceptable $A_2$ is obtained.\n  - Assign fragment charges using the Unchanged Charge Distribution approximation: $Z_1 = \\mathrm{round}\\left( A_1 Z_{\\mathrm{CN}} / A_{\\mathrm{CN}} \\right)$ and $Z_2 = Z_{\\mathrm{CN}} - Z_1$; if either $Z_i$ falls outside the physically valid range $\\left[1,Z_{\\mathrm{CN}}-1\\right]$, adjust by one unit toward the valid range while preserving $Z_1 + Z_2 = Z_{\\mathrm{CN}}$.\n\n- Sampling of emission energies:\n  - Sample $\\nu$ neutron kinetic energies $E_{n,i}$ independently from a Maxwellian-like spectrum characterized by a temperature parameter $T_n$, with density proportional to $E^{1/2} \\exp(-E/T_n)$; equivalently, sample $E_{n,i}$ from a Gamma distribution with shape parameter $k = 3/2$ and scale parameter $\\theta = T_n$.\n  - Sample the prompt gamma-ray multiplicity $N_{\\gamma}$ from a Poisson distribution with mean $\\bar{N}_{\\gamma}$, and sample $E_{\\gamma,j}$ independently from an exponential distribution with mean $E_{\\gamma,\\mathrm{mean}}$.\n  - Enforce energy conservation by setting the fragment Total Kinetic Energy after prompt emission to $\\mathrm{TKE} = Q - \\sum_i E_{n,i} - \\sum_j E_{\\gamma,j}$. If this would make $\\mathrm{TKE} \\le 0$, scale down the sampled radiation energies proportionally (preferentially scaling gamma-ray energies if present, otherwise scaling neutron energies) so that $0 < \\mathrm{TKE} \\ll Q$. All energies are in $\\mathrm{MeV}$.\n\n- Momentum assignment:\n  - For each neutron, compute momentum magnitude $p_{n,i} = \\sqrt{E_{n,i}\\left(E_{n,i} + 2 m_n\\right)}$ and sample an isotropic direction on the unit sphere to form $\\mathbf{p}_{n,i}$.\n  - For each gamma ray, set $p_{\\gamma,j} = E_{\\gamma,j}$ and sample an isotropic direction to form $\\mathbf{p}_{\\gamma,j}$.\n  - Compute the net emission momentum vector $\\mathbf{P}_{\\mathrm{emit}} = \\sum_i \\mathbf{p}_{n,i} + \\sum_j \\mathbf{p}_{\\gamma,j}$.\n  - Let the fragment rest masses be $m_1 = A_1 m_u$ and $m_2 = A_2 m_u$. Construct fragment momenta $\\mathbf{p}_1$ and $\\mathbf{p}_2$ such that $\\mathbf{p}_1 + \\mathbf{p}_2 = -\\mathbf{P}_{\\mathrm{emit}}$ and $K\\left(\\|\\mathbf{p}_1\\|,m_1\\right) + K\\left(\\|\\mathbf{p}_2\\|,m_2\\right) = \\mathrm{TKE}$. One robust construction is to choose a unit vector $\\hat{\\mathbf{u}}$:\n    - If $\\|\\mathbf{P}_{\\mathrm{emit}}\\| > 0$, set $\\hat{\\mathbf{u}} = -\\mathbf{P}_{\\mathrm{emit}} / \\|\\mathbf{P}_{\\mathrm{emit}}\\|$ and solve for a scalar $s \\ge \\|\\mathbf{P}_{\\mathrm{emit}}\\|$ such that $K\\left(s,m_1\\right) + K\\left(s - \\|\\mathbf{P}_{\\mathrm{emit}}\\|,m_2\\right) = \\mathrm{TKE}$, then set $\\mathbf{p}_1 = s \\hat{\\mathbf{u}}$ and $\\mathbf{p}_2 = -\\left(s - \\|\\mathbf{P}_{\\mathrm{emit}}\\|\\right)\\hat{\\mathbf{u}}$.\n    - If $\\|\\mathbf{P}_{\\mathrm{emit}}\\| = 0$, choose any fixed $\\hat{\\mathbf{u}}$ (for example, the $x$-axis unit vector) and solve for $s \\ge 0$ such that $K\\left(s,m_1\\right) + K\\left(s,m_2\\right) = \\mathrm{TKE}$, then set $\\mathbf{p}_1 = s \\hat{\\mathbf{u}}$ and $\\mathbf{p}_2 = -s \\hat{\\mathbf{u}}$.\n\nYour program must, for each test case, perform the sampling as specified and then verify:\n- Charge conservation: $Z_1 + Z_2 = Z_{\\mathrm{CN}}$ exactly.\n- Mass number conservation: $A_1 + A_2 + \\nu = A_{\\mathrm{CN}}$ exactly.\n- Energy conservation: $\\left| Q - \\left(\\mathrm{TKE} + \\sum_i E_{n,i} + \\sum_j E_{\\gamma,j} \\right) \\right|$ is below a tight numerical tolerance (use $10^{-9}\\,\\mathrm{MeV}$).\n- Momentum conservation: $\\left\\| \\mathbf{p}_1 + \\mathbf{p}_2 + \\sum_i \\mathbf{p}_{n,i} + \\sum_j \\mathbf{p}_{\\gamma,j} \\right\\|$ is below a tight numerical tolerance (use $10^{-9}\\,\\mathrm{MeV}/c$).\n\nPhysical and numerical units:\n- Express all energies in $\\mathrm{MeV}$.\n- Express momenta in $\\mathrm{MeV}/c$.\n- Use radians for any internal angle variables for direction sampling.\n\nTest suite and parameter values:\nImplement the following four test cases, each specified by parameters $\\left(Q,\\bar{\\nu},\\bar{N}_{\\gamma},T_n,E_{\\gamma,\\mathrm{mean}},\\mu_A,\\sigma_A,A_{\\min},A_{\\max},\\mathrm{seed},\\nu_{\\mathrm{force}}\\right)$, where $\\nu_{\\mathrm{force}}$ is either an integer or $\\mathrm{None}$ to indicate sampling:\n\n1. Case 1 (general happy path): $Q = 200.0$, $\\bar{\\nu} = 2.5$, $\\bar{N}_{\\gamma} = 6.0$, $T_n = 1.3$, $E_{\\gamma,\\mathrm{mean}} = 0.85$, $\\mu_A = 96.0$, $\\sigma_A = 5.0$, $A_{\\min} = 70$, $A_{\\max} = 120$, $\\mathrm{seed} = 1234$, $\\nu_{\\mathrm{force}} = \\mathrm{None}$.\n\n2. Case 2 (lower available energy boundary): $Q = 170.0$, $\\bar{\\nu} = 2.5$, $\\bar{N}_{\\gamma} = 5.0$, $T_n = 1.2$, $E_{\\gamma,\\mathrm{mean}} = 0.60$, $\\mu_A = 96.0$, $\\sigma_A = 6.0$, $A_{\\min} = 70$, $A_{\\max} = 120$, $\\mathrm{seed} = 5678$, $\\nu_{\\mathrm{force}} = \\mathrm{None}$.\n\n3. Case 3 (edge case with zero prompt neutrons): $Q = 210.0$, $\\bar{\\nu} = 2.5$, $\\bar{N}_{\\gamma} = 8.0$, $T_n = 1.3$, $E_{\\gamma,\\mathrm{mean}} = 0.90$, $\\mu_A = 96.0$, $\\sigma_A = 5.0$, $A_{\\min} = 70$, $A_{\\max} = 120$, $\\mathrm{seed} = 42$, $\\nu_{\\mathrm{force}} = 0$.\n\n4. Case 4 (higher available energy boundary): $Q = 230.0$, $\\bar{\\nu} = 2.8$, $\\bar{N}_{\\gamma} = 10.0$, $T_n = 1.4$, $E_{\\gamma,\\mathrm{mean}} = 0.95$, $\\mu_A = 97.0$, $\\sigma_A = 5.0$, $A_{\\min} = 70$, $A_{\\max} = 120$, $\\mathrm{seed} = 314159$, $\\nu_{\\mathrm{force}} = \\mathrm{None}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output the three booleans in the order energy, momentum, charge conservation checks. Aggregate all four test cases in sequence, yielding a list of $12$ values, for example, $\\left[\\mathrm{e}_1,\\mathrm{m}_1,\\mathrm{c}_1,\\mathrm{e}_2,\\mathrm{m}_2,\\mathrm{c}_2,\\mathrm{e}_3,\\mathrm{m}_3,\\mathrm{c}_3,\\mathrm{e}_4,\\mathrm{m}_4,\\mathrm{c}_4\\right]$.",
            "solution": "The problem statement provides a detailed specification for a stochastic model of a single prompt fission event of Uranium-235. It requires the implementation of a program to generate a single, physically consistent realization of such an event for a given set of parameters and a random seed. The model must adhere to the fundamental conservation laws of physics: conservation of energy, momentum, charge, and mass number.\n\nThe problem is evaluated to be **valid**. It is scientifically grounded in established principles of nuclear physics, well-posed with a clear, algorithmic procedure, and objective, with all quantities and rules defined formally. The described model, while a simplification of the complex reality of nuclear fission, is a standard phenomenological approach used in scientific simulations. It contains no scientific fallacies, contradictions, or ambiguities that would prevent a rigorous and unique solution for each test case.\n\nThe solution proceeds by implementing the specified stochastic simulation step-by-step. All mathematical quantities are rendered in LaTeX as required.\n\nThe simulation is centered around the compound nucleus $^{236}\\mathrm{U}^*$, characterized by mass number $A_{\\mathrm{CN}} = 236$ and charge number $Z_{\\mathrm{CN}} = 92$. The following physical constants are used: neutron rest mass energy $m_n c^2 = 939.5654133\\,\\mathrm{MeV}$ and the unified atomic mass unit energy equivalent $m_u c^2 = 931.49410242\\,\\mathrm{MeV}$. We work in a system of units where $c=1$, so energies are in $\\mathrm{MeV}$, momenta in $\\mathrm{MeV}/c$, and masses in $\\mathrm{MeV}/c^2$.\n\nFor each test case, defined by a tuple of parameters $\\left(Q,\\bar{\\nu},\\bar{N}_{\\gamma},T_n,E_{\\gamma,\\mathrm{mean}},\\mu_A,\\sigma_A,A_{\\min},A_{\\max},\\mathrm{seed},\\nu_{\\mathrm{force}}\\right)$, the following sequence of operations is performed:\n\n1.  **Stochastic Sampling of Primary Event Characteristics**:\n    *   **Neutron Multiplicity ($\\nu$)**: The number of prompt neutrons, $\\nu$, is either taken from a forced integer value $\\nu_{\\mathrm{force}}$ or sampled from a Poisson distribution with mean $\\bar{\\nu}$, i.e., $\\nu \\sim \\mathrm{Pois}(\\bar{\\nu})$.\n    *   **Fragment Mass Numbers ($A_1, A_2$)**: The light fragment mass number, $A_1$, is sampled from a truncated normal distribution with mean $\\mu_A$ and standard deviation $\\sigma_A$, constrained to the integer range $[A_{\\min}, A_{\\max}]$. A resampling loop ensures that the resulting heavy fragment mass number, calculated as $A_2 = A_{\\mathrm{CN}} - \\nu - A_1$, also falls within the valid range $[A_{\\min}, A_{\\max}]$. This process guarantees mass number conservation by construction: $A_1 + A_2 + \\nu = A_{\\mathrm{CN}}$.\n    *   **Fragment Charges ($Z_1, Z_2$)**: Fragment charges are assigned using the Unchanged Charge Distribution (UCD) approximation. The light fragment charge is $Z_1 = \\mathrm{round}(A_1 Z_{\\mathrm{CN}} / A_{\\mathrm{CN}})$. The heavy fragment charge is then $Z_2 = Z_{\\mathrm{CN}} - Z_1$, ensuring charge conservation. A correction is applied if either $Z_1$ or $Z_2$ falls outside the valid range $[1, Z_{\\mathrm{CN}}-1]$ by adjusting the value to the nearest boundary of this range while preserving the sum.\n\n2.  **Sampling of Emission Energies and TKE Determination**:\n    *   **Neutron Energies ($E_{n,i}$)**: $\\nu$ prompt neutron kinetic energies are sampled independently from a Maxwellian-like spectrum, which is equivalent to a Gamma distribution with shape parameter $k = 3/2$ and scale parameter (temperature) $\\theta = T_n$. So, $E_{n,i} \\sim \\Gamma(k=3/2, \\theta=T_n)$.\n    *   **Gamma-Ray Multiplicity and Energies ($N_{\\gamma}, E_{\\gamma,j}$)**: The number of prompt gamma rays, $N_{\\gamma}$, is sampled from a Poisson distribution with mean $\\bar{N}_{\\gamma}$. Subsequently, $N_{\\gamma}$ gamma-ray energies are sampled independently from an exponential distribution with mean $E_{\\gamma,\\mathrm{mean}}$.\n    *   **Total Kinetic Energy (TKE)**: The total kinetic energy of the two fission fragments, TKE, is determined by the energy conservation law: $\\mathrm{TKE} = Q - \\sum_{i=1}^{\\nu} E_{n,i} - \\sum_{j=1}^{N_{\\gamma}} E_{\\gamma,j}$. If the sum of sampled radiation energies exceeds the available energy $Q$, resulting in $\\mathrm{TKE} \\le 0$, the radiation energies are scaled down. This process preferentially reduces gamma-ray energies first. If the required reduction exceeds the total gamma-ray energy, all gamma energies are set to zero, and the remaining reduction is applied proportionally to the neutron energies. This ensures that the final TKE is a small, positive value.\n\n3.  **Momentum Conservation and Final State Kinematics**:\n    *   **Emission Momenta ($\\mathbf{p}_{n,i}, \\mathbf{p}_{\\gamma,j}$)**: For each emitted particle, a momentum vector is constructed. The magnitude is calculated from its kinetic energy using the relativistic formula $p(K,m) = \\sqrt{K^2 + 2Km c^2}$ (for neutrons) or $p = E/c$ (for gammas). The direction is sampled isotropically from the unit sphere. The vector sum of all emission momenta gives the net recoil momentum imparted to the fragments, $\\mathbf{P}_{\\mathrm{emit}} = \\sum_i \\mathbf{p}_{n,i} + \\sum_j \\mathbf{p}_{\\gamma,j}$.\n    *   **Fragment Momenta ($\\mathbf{p}_1, \\mathbf{p}_2$)**: The fragment momenta must sum to $-\\mathbf{P}_{\\mathrm{emit}}$ to conserve total momentum. The fragments are emitted back-to-back in their own center-of-mass frame, along the direction of $-\\mathbf{P}_{\\mathrm{emit}}$. The partitioning of the TKE between the two fragments is determined by solving a non-linear equation for a scalar momentum magnitude $s$. Letting $m_1 = A_1 m_u$ and $m_2 = A_2 m_u$ be the fragment rest masses (in $\\mathrm{MeV}/c^2$), and $P_{\\mathrm{emit}} = \\|\\mathbf{P}_{\\mathrm{emit}}\\|$, the equation to solve is $K(s, m_1) + K(s - P_{\\mathrm{emit}}, m_2) = \\mathrm{TKE}$, where $K(p,m)=\\sqrt{p^2c^2+m^2c^4}-mc^2$ is the relativistic kinetic energy. A numerical root-finding algorithm (Brent's method) is employed to find $s$. The final fragment momenta are then $\\mathbf{p}_1 = s \\hat{\\mathbf{u}}$ and $\\mathbf{p}_2 = -\\mathbf{P}_{\\mathrm{emit}} - \\mathbf{p}_1$, where $\\hat{\\mathbf{u}} = -\\mathbf{P}_{\\mathrm{emit}}/P_{\\mathrm{emit}}$. If $P_{\\mathrm{emit}}=0$, the equation simplifies and the emission axis $\\hat{\\mathbf{u}}$ is chosen arbitrarily (e.g., along the x-axis).\n\n4.  **Verification**:\n    Finally, the generated event is checked against the physical laws it was designed to obey.\n    *   **Charge Conservation**: The sum $Z_1 + Z_2$ is verified to be exactly equal to $Z_{\\mathrm{CN}}$.\n    *   **Mass Number Conservation**: The sum $A_1 + A_2 + \\nu$ is verified to be exactly equal to $A_{\\mathrm{CN}}$.\n    *   **Energy Conservation**: The total final energy, which is the sum of the final fragment kinetic energies, neutron kinetic energies, and gamma-ray energies, is compared to the initial $Q$-value. The absolute difference must be less than a tolerance of $10^{-9}\\,\\mathrm{MeV}$.\n    *   **Momentum Conservation**: The vector sum of all final-state momenta, $\\mathbf{p}_1 + \\mathbf{p}_2 + \\mathbf{P}_{\\mathrm{emit}}$, is computed. Its magnitude must be less than a tolerance of $10^{-9}\\,\\mathrm{MeV}/c$.\n\nThe results of the energy, momentum, and charge conservation checks (as boolean values) are collected for each test case and formatted into the required final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import truncnorm\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to run the fission event simulation for all test cases.\n    \"\"\"\n    # Define physical constants\n    A_CN = 236\n    Z_CN = 92\n    M_U_C2 = 931.49410242  # MeV/c^2\n    M_N_C2 = 939.5654133  # MeV/c^2\n    ENERGY_TOL = 1e-9  # MeV\n    MOMENTUM_TOL = 1e-9 # MeV/c\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Q, nu_bar, N_gamma_bar, T_n, E_gamma_mean, mu_A, sigma_A, A_min, A_max, seed, nu_force)\n        (200.0, 2.5, 6.0, 1.3, 0.85, 96.0, 5.0, 70, 120, 1234, None),\n        (170.0, 2.5, 5.0, 1.2, 0.60, 96.0, 6.0, 70, 120, 5678, None),\n        (210.0, 2.5, 8.0, 1.3, 0.90, 96.0, 5.0, 70, 120, 42, 0),\n        (230.0, 2.8, 10.0, 1.4, 0.95, 97.0, 5.0, 70, 120, 314159, None),\n    ]\n\n    all_results = []\n    for params in test_cases:\n        Q, nu_bar, N_gamma_bar, T_n, E_gamma_mean, mu_A, sigma_A, A_min, A_max, seed, nu_force = params\n        \n        rng = np.random.default_rng(seed)\n\n        # 1. Sample multiplicities and fragment masses\n        if nu_force is not None:\n            nu = nu_force\n        else:\n            nu = rng.poisson(nu_bar)\n\n        while True:\n            # Sample A1 from a truncated normal distribution\n            a, b = (A_min - mu_A) / sigma_A, (A_max - mu_A) / sigma_A\n            A1_float = truncnorm.rvs(a, b, loc=mu_A, scale=sigma_A, random_state=rng)\n            A1 = int(round(A1_float))\n            \n            # Ensure A1 is within integer bounds after rounding\n            if not(A_min <= A1 <= A_max):\n                continue\n\n            A2 = A_CN - A1 - nu\n            if A_min <= A2 <= A_max:\n                break\n        \n        # 2. Assign fragment charges\n        Z1_raw = int(round(A1 * Z_CN / A_CN))\n        Z1 = np.clip(Z1_raw, 1, Z_CN - 1)\n        Z2 = Z_CN - Z1\n        \n        # 3. Sample emission energies\n        E_n = rng.gamma(shape=1.5, scale=T_n, size=nu) if nu > 0 else np.array([])\n        N_gamma = rng.poisson(N_gamma_bar)\n        E_gamma = rng.exponential(scale=E_gamma_mean, size=N_gamma) if N_gamma > 0 else np.array([])\n        \n        # 4. Enforce energy conservation, determine TKE\n        E_n_total = np.sum(E_n)\n        E_gamma_total = np.sum(E_gamma)\n        TKE = Q - (E_n_total + E_gamma_total)\n\n        if TKE <= 0:\n            TKE_target = 1e-6  # Set a small positive target TKE\n            E_rad_total = E_n_total + E_gamma_total\n            E_reduction_needed = E_rad_total - (Q - TKE_target)\n\n            if E_gamma_total > 0 and E_reduction_needed < E_gamma_total:\n                E_gamma_total_new = E_gamma_total - E_reduction_needed\n                gamma_scale_factor = E_gamma_total_new / E_gamma_total\n                E_gamma *= gamma_scale_factor\n            else:\n                E_reduction_from_gamma = E_gamma_total\n                E_gamma.fill(0.0)\n                E_reduction_still_needed = E_reduction_needed - E_reduction_from_gamma\n                \n                if E_n_total > 0:\n                    E_n_total_new = E_n_total - E_reduction_still_needed\n                    if E_n_total_new > 0:\n                        neutron_scale_factor = E_n_total_new / E_n_total\n                        E_n *= neutron_scale_factor\n                    else: # Failsafe, shouldn't happen with given params\n                        E_n.fill(0)\n\n            # Recalculate totals\n            E_n_total = np.sum(E_n)\n            E_gamma_total = np.sum(E_gamma)\n            TKE = Q - (E_n_total + E_gamma_total)\n        \n        # 5. Momentum assignment\n        def sample_isotropic_direction(rng_gen):\n            phi = rng_gen.uniform(0, 2 * np.pi)\n            cos_theta = rng_gen.uniform(-1, 1)\n            sin_theta = np.sqrt(1 - cos_theta**2)\n            return np.array([sin_theta * np.cos(phi), sin_theta * np.sin(phi), cos_theta])\n\n        # Emission momenta\n        P_emit = np.zeros(3)\n        for e_n in E_n:\n            p_n_mag = np.sqrt(e_n**2 + 2 * e_n * M_N_C2)\n            P_emit += p_n_mag * sample_isotropic_direction(rng)\n        \n        for e_gamma in E_gamma:\n            p_gamma_mag = e_gamma  # c=1\n            P_emit += p_gamma_mag * sample_isotropic_direction(rng)\n        \n        # Fragment momenta\n        m1, m2 = A1 * M_U_C2, A2 * M_U_C2\n        P_emit_mag = np.linalg.norm(P_emit)\n\n        def kinetic_energy_rel(p_mag, mass):\n            return np.sqrt(p_mag**2 + mass**2) - mass\n\n        if P_emit_mag < 1e-12: # Effectively zero\n            def eqn_to_solve(s):\n                return kinetic_energy_rel(s, m1) + kinetic_energy_rel(s, m2) - TKE\n            s_low = 0.0\n            p_approx_nr = np.sqrt(2 * TKE / (1/m1 + 1/m2)) if TKE > 0 else 0\n            s_high = max(1e-9, 2*p_approx_nr) # Avoid bracket of zero size\n            s_sol = brentq(eqn_to_solve, s_low, s_high)\n            u_hat = np.array([1.0, 0.0, 0.0])\n            p1 = s_sol * u_hat\n            p2 = -s_sol * u_hat\n        else:\n            def eqn_to_solve(s):\n                return kinetic_energy_rel(s, m1) + kinetic_energy_rel(s - P_emit_mag, m2) - TKE\n            s_low = P_emit_mag\n            p_approx_rel_1 = np.sqrt(TKE**2 + 2*TKE*m1) if TKE > 0 else 0\n            s_high = p_approx_rel_1 + P_emit_mag\n            s_sol = brentq(eqn_to_solve, s_low, s_high)\n            u_hat = -P_emit / P_emit_mag\n            p1 = s_sol * u_hat\n            p2 = -(s_sol - P_emit_mag) * u_hat\n        \n        # 6. Verification\n        mass_num_ok = (A1 + A2 + nu) == A_CN\n        charge_ok = (Z1 + Z2) == Z_CN\n\n        TKE_final = kinetic_energy_rel(np.linalg.norm(p1), m1) + kinetic_energy_rel(np.linalg.norm(p2), m2)\n        total_final_energy = TKE_final + np.sum(E_n) + np.sum(E_gamma)\n        energy_ok = abs(Q - total_final_energy) < ENERGY_TOL\n\n        total_final_momentum = p1 + p2 + P_emit\n        momentum_ok = np.linalg.norm(total_final_momentum) < MOMENTUM_TOL\n        \n        # Although mass_num_ok is always true by construction, it's good practice.\n        # The problem only asks for energy, momentum, charge.\n        all_results.extend([energy_ok, momentum_ok, charge_ok])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(lambda b: str(b).lower(), all_results))}]\")\n\nsolve()\n```"
        }
    ]
}