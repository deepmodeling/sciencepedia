{
    "hands_on_practices": [
        {
            "introduction": "数值求解微分方程的第一步是离散化。本练习将指导您使用有限差分法，将连续的中子扩散方程转化为矩阵特征值问题，这是计算物理学的基石。通过分析解随网格细化的收敛性，您将学习如何评估数值模型的准确性和可靠性。",
            "id": "4239697",
            "problem": "考虑一个长度为 $L$ 的均匀平板中的一维稳态中子扩散 $k$本征值问题，其边界条件为真空边界条件。该控制模型由中子平衡方程和菲克定律(Fick's law)共同导出，并假设为单能群、隐式处理的各向同性散射以及空间上恒定的材料属性。具体来说，连续模型为\n$$\n- \\nabla \\cdot \\left( D \\nabla \\phi(x) \\right) + \\Sigma_a \\,\\phi(x) = \\frac{1}{k}\\,\\nu \\Sigma_f \\,\\phi(x), \\quad x \\in (0,L),\n$$\n边界条件为\n$$\n\\phi(0) = 0, \\quad \\phi(L) = 0,\n$$\n其中 $D$ 是扩散系数，$\\Sigma_a$ 是宏观吸收截面，$\\nu \\Sigma_f$ 是宏观裂变中子产生项，$k$ 是增殖因子（即本征值）。所有符号和数字必须以厘米和厘米的倒数为单位进行解释：$D$ 的单位是 $\\mathrm{cm}$，$\\Sigma_a$ 的单位是 $\\mathrm{cm}^{-1}$，$\\nu \\Sigma_f$ 的单位是 $\\mathrm{cm}^{-1}$，$L$ 的单位是 $\\mathrm{cm}$。增殖因子 $k$ 是无量纲的。\n\n您的任务是使用中心差分法，在包含 $N$ 个节点（包括两个边界节点）的均匀网格上，构建基态本征值 $k$ 的数值近似。离散化必须与边界条件和模型方程相一致。从第一性原理出发，推导离散算子以及最终的矩阵本征值问题，该问题的最小本征值对应于基态模。计算每个网格的近似增殖因子 $k_h$，并通过将这些值与在相同假设和边界条件下从连续模型获得的解析参考解 $k_{\\text{exact}}$ 进行比较，来分析网格加密的效果。\n\n然后，估计本征值误差的收敛率。将网格尺寸为 $h$ 时的绝对误差定义为\n$$\ne_h = \\left| k_h - k_{\\text{exact}} \\right|,\n$$\n对于网格间距为 $h_1$ 和 $h_2$ 的两次连续加密，通过以下公式估计收敛率 $p$：\n$$\np = \\frac{\\log\\left(e_{h_1}/e_{h_2}\\right)}{\\log\\left(h_1/h_2\\right)}.\n$$\n\n使用以下参数值测试套件，以确保覆盖一般情况和边界情况：\n- 均匀平板长度：$L = 100\\,\\mathrm{cm}$。\n- 扩散系数：$D = 1.0\\,\\mathrm{cm}$。\n- 宏观吸收截面：$\\Sigma_a = 0.01\\,\\mathrm{cm}^{-1}$。\n- 宏观裂变产生项：$\\nu \\Sigma_f = 0.011\\,\\mathrm{cm}^{-1}$。\n- 网格：$N \\in \\{3, 11, 21, 41, 81\\}$ 个节点；对于每个 $N$，将均匀网格尺寸定义为 $h = L/(N-1)$。\n\n对于测试套件中的每个 $N$，计算近似的基态增殖因子 $k_h$ 以及相对于解析参考解 $k_{\\text{exact}}$ 的相应绝对误差 $e_h$。然后，对于网格尺寸为 $(h_i,h_{i+1})$ 的连续对 $(N_i,N_{i+1})$，使用上述公式计算估计的收敛率 $p_i$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，并按以下格式汇总所有测试用例的结果：\n$$\n\\left[\\left[k_{h}(N_1),k_{h}(N_2),k_{h}(N_3),k_{h}(N_4),k_{h}(N_5)\\right],\\left[e_{h}(N_1),e_{h}(N_2),e_{h}(N_3),e_{h}(N_4),e_{h}(N_5)\\right],\\left[p_1,p_2,p_3,p_4\\right]\\right].\n$$\n所有条目必须是实数（浮点数）。最终的增殖因子值 $k_h$ 和误差 $e_h$ 必须以无量纲形式报告，估计的收敛率 $p_i$ 必须报告为无量纲浮点数。此问题不涉及角度。",
            "solution": "我们从稳态条件下均匀单能群介质中的中子平衡和菲克定律(Fick's law)出发。标准扩散近似得到 $k$本征值模型\n$$\n- \\nabla \\cdot \\left( D \\nabla \\phi(x) \\right) + \\Sigma_a \\,\\phi(x) = \\frac{1}{k}\\,\\nu \\Sigma_f \\,\\phi(x), \\quad x \\in (0,L),\n$$\n边界条件为真空边界条件，此处取为狄利克雷(Dirichlet)条件\n$$\n\\phi(0) = 0, \\quad \\phi(L) = 0.\n$$\n所有材料系数均为常数。未知量是中子通量 $\\phi(x)$ 和增殖因子 $k$。其物理释义如下：$D$ 描述通过扩散进行的输运（单位为 $\\mathrm{cm}$），$\\Sigma_a$ 代表吸收（单位为 $\\mathrm{cm}^{-1}$），$\\nu \\Sigma_f$ 是由裂变产生的中子（单位为 $\\mathrm{cm}^{-1}$），而 $k$ 是无量纲本征值，表示产生与损失的比率。\n\n解析参考解。在一维、均匀系数和狄利克雷(Dirichlet)边界条件下，我们寻求分离变量解。在一维情况下，算子 $- \\nabla \\cdot \\left( D \\nabla \\cdot \\right)$ 简化为 $-D \\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}$。假设\n$$\n\\phi''(x) + \\lambda^2 \\phi(x) = 0,\n$$\n这是与狄利克雷(Dirichlet)边界条件一致的亥姆霍兹(Helmholtz)型本征值问题的标准形式。边界条件要求\n$$\n\\phi(0)=0, \\quad \\phi(L)=0 \\implies \\phi(x) \\propto \\sin\\left(\\frac{n\\pi x}{L}\\right), \\quad \\lambda^2 = \\left(\\frac{n\\pi}{L}\\right)^2, \\quad n \\in \\mathbb{N}.\n$$\n将其代入扩散平衡方程，对于这样的一个模式，可得\n$$\n- D \\left(-\\lambda^2 \\phi(x)\\right) + \\Sigma_a \\phi(x) = \\frac{1}{k} \\nu \\Sigma_f \\phi(x) \\implies D \\lambda^2 + \\Sigma_a = \\frac{1}{k}\\nu \\Sigma_f,\n$$\n因此\n$$\nk = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D \\lambda^2}.\n$$\n基态模对应 $n=1$，因此解析参考增殖因子为\n$$\nk_{\\text{exact}} = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D \\left(\\frac{\\pi}{L}\\right)^2}.\n$$\n\n有限差分离散。我们构建一个包含 $N$ 个节点的均匀网格，包括位于 $x=0$ 和 $x=L$ 的边界。网格间距为 $h = L/(N-1)$。我们用索引 $i=1,2,\\dots,M$（其中 $M=N-2$）表示内部节点；这些节点对应于位置 $x_i = i h$。狄利克雷(Dirichlet)边界条件要求 $\\phi_0 = 0$ 和 $\\phi_{N-1} = 0$。在内部节点 $i$ 处，二阶导数的中心差分近似为\n$$\n\\phi''(x_i) \\approx \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2}.\n$$\n应用离散平衡方程，\n$$\n- D \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2} + \\Sigma_a \\phi_i = \\frac{1}{k}\\,\\nu \\Sigma_f \\,\\phi_i,\n$$\n对所有内部节点进行组装，得到一个对称正定（SPD）的三对角矩阵 $\\mathbf{A} \\in \\mathbb{R}^{M \\times M}$，\n$$\n\\mathbf{A} = \\frac{D}{h^2}\\,\\mathrm{tridiag}(-1,2,-1) + \\Sigma_a \\mathbf{I},\n$$\n使得\n$$\n\\mathbf{A}\\,\\boldsymbol{\\phi} = \\frac{1}{k}\\,\\nu \\Sigma_f \\,\\boldsymbol{\\phi},\n$$\n其中 $\\boldsymbol{\\phi}$ 是内部通量未知量向量，$\\mathbf{I}$ 是单位矩阵。这是一个广义本征值问题，其右端算子为标量算子 $\\nu \\Sigma_f \\mathbf{I}$。等价地，这是一个关于 $\\mathbf{A}$ 的普通本征值问题：\n$$\n\\mathbf{A}\\,\\boldsymbol{\\phi} = \\mu \\,\\boldsymbol{\\phi}, \\quad \\mu = \\frac{1}{k}\\,\\nu \\Sigma_f \\implies k_h = \\frac{\\nu \\Sigma_f}{\\mu_{\\min}},\n$$\n其中 $\\mu_{\\min}$ 是 $\\mathbf{A}$ 的最小本征值，对应于与狄利克雷(Dirichlet)边界条件一致的离散基态模。\n\n收敛性分析。对于均匀网格上的中心差分格式，二阶导数的截断误差为 $\\mathcal{O}(h^2)$，离散算子 $\\mathbf{A}$ 在算子范数意义下收敛于连续算子。对于基态本征对（本征值和本征向量），标准的微扰和相容性论证可以证明，本征值误差的行为如下\n$$\n\\left| k_h - k_{\\text{exact}} \\right| = \\mathcal{O}(h^2),\n$$\n对于足够加密的网格。我们通过计算以下公式来经验性地估计收敛率\n$$\ne_h = \\left| k_h - k_{\\text{exact}} \\right|,\n$$\n以及，对于连续对 $(h_1,h_2)$，\n$$\np = \\frac{\\log\\left(e_{h_1}/e_{h_2}\\right)}{\\log\\left(h_1/h_2\\right)}.\n$$\n当 $p$ 的值接近 2 时，证实了二阶收敛性。\n\n算法步骤：\n1. 设置 $L = 100\\,\\mathrm{cm}$，$D = 1.0\\,\\mathrm{cm}$，$\\Sigma_a = 0.01\\,\\mathrm{cm}^{-1}$，$\\nu \\Sigma_f = 0.011\\,\\mathrm{cm}^{-1}$。\n2. 计算解析参考解\n$$\nk_{\\text{exact}} = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D \\left(\\frac{\\pi}{L}\\right)^2}.\n$$\n3. 对于每个 $N \\in \\{3,11,21,41,81\\}$，计算 $h = L/(N-1)$，将 $\\mathbf{A}$ 组装为对角线元素为 $2D/h^2 + \\Sigma_a$、非对角线元素为 $-D/h^2$ 的三对角对称正定矩阵，计算 $\\mathbf{A}$ 的最小本征值 $\\mu_{\\min}$，并设置 $k_h = \\nu \\Sigma_f/\\mu_{\\min}$。\n4. 对每个 $N$ 计算 $e_h = \\left| k_h - k_{\\text{exact}} \\right|$。\n5. 对于连续对，使用上述公式以及相应的 $(h_i,h_{i+1})$ 和 $(e_{h_i}, e_{h_{i+1}})$ 来计算 $p$。\n6. 输出格式为如下的单行：\n$$\n\\left[\\left[k_{h}(N_1),k_{h}(N_2),k_{h}(N_3),k_{h}(N_4),k_{h}(N_5)\\right],\\left[e_{h}(N_1),e_{h}(N_2),e_{h}(N_3),e_{h}(N_4),e_{h}(N_5)\\right],\\left[p_1,p_2,p_3,p_4\\right]\\right].\n$$\n\n此过程在数值上是稳健的，因为对于给定的 $N$ 范围，$\\mathbf{A}$ 是对称正定且良态的，并且它分离出了均匀平板中带真空边界条件的中子扩散 $k$本征值问题的基本物理。随着 $N$ 的增加（即 $h$ 的减小），预期的估计收敛率 $p$ 应趋近于 2，从而验证本征值误差的二阶收敛性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef assemble_diffusion_matrix(M, D, Sigma_a, h):\n    \"\"\"\n    Assemble the SPD tridiagonal matrix A for the 1D diffusion operator with Dirichlet BCs.\n    A = (D/h^2) * tridiag(-1, 2, -1) + Sigma_a * I\n    where M is the number of interior points (N-2).\n    \"\"\"\n    # Diagonal and off-diagonal values\n    main_diag = np.full(M, 2.0 * D / (h**2) + Sigma_a)\n    off_diag = np.full(M - 1, -D / (h**2))\n    # Build full matrix using banded structure\n    A = np.diag(main_diag)\n    if M > 1:\n        A += np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n    return A\n\ndef compute_k_approx(N, L, D, Sigma_a, nuSigmaF):\n    \"\"\"\n    Compute the approximate fundamental multiplication factor k_h for a given N.\n    \"\"\"\n    # Mesh spacing and number of interior points\n    h = L / (N - 1)\n    M = N - 2\n    if M == 0:\n        # Degenerate mesh; return NaN (should not occur for N>=3 in our test suite)\n        return np.nan, h\n    # Assemble SPD matrix A\n    A = assemble_diffusion_matrix(M, D, Sigma_a, h)\n    # Compute the smallest eigenvalue of A (A is symmetric positive definite)\n    # Using numpy.linalg.eigvalsh which is for symmetric/hermitian matrices\n    eigvals = np.linalg.eigvalsh(A)\n    mu_min = eigvals[0]\n    # Fundamental k approximation: k_h = nuSigmaF / mu_min\n    k_h = nuSigmaF / mu_min\n    return k_h, h\n\ndef solve():\n    # Define physical and numerical parameters (units in cm and 1/cm; k is dimensionless)\n    L = 100.0      # cm\n    D = 1.0        # cm\n    Sigma_a = 0.01 # 1/cm\n    nuSigmaF = 0.011 # 1/cm\n\n    # Analytical reference for fundamental mode: k_exact = nuSigmaF / (Sigma_a + D*(pi/L)^2)\n    k_exact = nuSigmaF / (Sigma_a + D * (np.pi / L)**2)\n\n    # Test suite: grid sizes\n    N_values = [3, 11, 21, 41, 81]\n\n    k_list = []\n    e_list = []\n    h_list = []\n\n    # Compute k_h and errors for each grid\n    for N in N_values:\n        k_h, h = compute_k_approx(N, L, D, Sigma_a, nuSigmaF)\n        k_list.append(k_h)\n        h_list.append(h)\n        e_list.append(abs(k_h - k_exact))\n\n    # Estimate convergence rates between successive refinements\n    p_list = []\n    for i in range(len(N_values) - 1):\n        e1, e2 = e_list[i], e_list[i+1]\n        h1, h2 = h_list[i], h_list[i+1]\n        # Guard against division by zero or non-positive errors\n        if e1 > 0 and e2 > 0 and h1 != h2:\n            p = np.log(e1 / e2) / np.log(h1 / h2)\n        else:\n            p = float('nan')\n        p_list.append(p)\n\n    # Format the output as a single line: [[k_list],[e_list],[p_list]] with no spaces\n    def format_list(lst):\n        # Use repr-like formatting for floats to maintain precision without spaces\n        return \"[\" + \",\".join(map(lambda x: (\"{:.12g}\".format(x)), lst)) + \"]\"\n\n    output = \"[\" + \",\".join([format_list(k_list), format_list(e_list), format_list(p_list)]) + \"]\"\n    print(output)\n\nsolve()\n```"
        },
        {
            "introduction": "扩散方程离散化后，我们面临一个大型矩阵特征值问题。功率迭代法是一种经典而稳健的算法，用于寻找最大的特征值及其对应的特征向量，在我们的情况中，它们分别代表有效增殖因数（$k$）和基波中子通量密度分布。本练习将让您亲手实践这一基本迭代求解器的核心机制。",
            "id": "4239708",
            "problem": "考虑一个热中子反应堆的空间均匀、双能群无限介质模型，该模型被表述为一个中子扩散$k$-本征值问题。在无限介质中，稳态多群平衡方程简化为代数本征问题\n$$\nL \\,\\boldsymbol{\\phi} \\;=\\; \\frac{1}{k}\\,F\\,\\boldsymbol{\\phi},\n$$\n其中 $L$ 是移出减入散射算子，$F$ 是裂变产生算子。对于双能群，请用基本截面表示 $L$ 和 $F$：群移出截面 $\\Sigma_{r,1}$ 和 $\\Sigma_{r,2}$，向下散射截面 $\\Sigma_{s,1\\rightarrow 2}$，裂变产生截面 $\\nu\\Sigma_{f,1}$ 和 $\\nu\\Sigma_{f,2}$，以及裂变谱份额 $\\chi_1$ 和 $\\chi_2$（满足 $\\chi_1+\\chi_2=1$）。假设没有向上散射（$\\Sigma_{s,2\\rightarrow 1}=0$）。\n\n给定以下经过数值指定且物理上合理的常数：\n- $\\Sigma_{r,1} = 0.5$, $\\Sigma_{r,2} = 0.7$, $\\Sigma_{s,1\\rightarrow 2} = 0.4$,\n- $\\nu\\Sigma_{f,1} = 0.2$, $\\nu\\Sigma_{f,2} = 0.6$,\n- $\\chi_1 = 0.95$, $\\chi_2 = 0.05$.\n\n采用适合双能群无限介质的裂变源归一化策略，执行幂迭代法。从均匀的初始通量猜测 $\\boldsymbol{\\phi}^{(0)} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 开始，按如下步骤执行三次迭代：\n1. 计算总裂变产生标量 $S^{(n)} = \\sum_{g=1}^{2} \\nu\\Sigma_{f,g}\\,\\phi^{(n)}_g$，并归一化 $\\boldsymbol{\\phi}^{(n)}$ 以使 $S^{(n)}=1$。\n2. 构成裂变源向量 $\\boldsymbol{q}^{(n)} = \\boldsymbol{\\chi}\\, S^{(n)}$，其中 $\\boldsymbol{\\chi} = \\begin{pmatrix} \\chi_1 \\\\ \\chi_2 \\end{pmatrix}$。\n3. 求解线性系统 $L\\,\\boldsymbol{\\phi}^{(n+1)} = \\boldsymbol{q}^{(n)}$ 以获得下一个通量。\n4. 计算 $k^{(n+1)} = \\sum_{g=1}^{2} \\nu\\Sigma_{f,g}\\,\\phi^{(n+1)}_g$。\n\n使用指定的常数，从 $\\boldsymbol{\\phi}^{(0)}$ 开始进行三次迭代，并以单个精确分数的形式报告 $k^{(3)}$ 的值。无需四舍五入，答案是无量纲的。",
            "solution": "首先对该问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n该问题描述了一个由方程 $L \\,\\boldsymbol{\\phi} \\;=\\; \\frac{1}{k}\\,F\\,\\boldsymbol{\\phi}$ 控制的双能群、无限介质中子扩散 $k$-本征值问题。\n给定的物理常数如下：\n- 第1群移出截面: $\\Sigma_{r,1} = 0.5$\n- 第2群移出截面: $\\Sigma_{r,2} = 0.7$\n- 第1群到第2群的向下散射截面: $\\Sigma_{s,1\\rightarrow 2} = 0.4$\n- 第1群裂变产生截面: $\\nu\\Sigma_{f,1} = 0.2$\n- 第2群裂变产生截面: $\\nu\\Sigma_{f,2} = 0.6$\n- 第1群裂变谱份额: $\\chi_1 = 0.95$\n- 第2群裂变谱份额: $\\chi_2 = 0.05$\n- 假设无向上散射: $\\Sigma_{s,2\\rightarrow 1} = 0$\n- 裂变谱是归一化的: $\\chi_1 + \\chi_2 = 1$\n\n幂迭代法的初始条件是均匀的通量猜测：\n- $\\boldsymbol{\\phi}^{(0)} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$\n\n指定的第 $n$ 次迭代的幂迭代算法如下：\n1.  计算总裂变产生标量 $S^{(n)} = \\sum_{g=1}^{2} \\nu\\Sigma_{f,g}\\,\\phi^{(n)}_g$。然后归一化通量向量 $\\boldsymbol{\\phi}^{(n)}$，使得该和等于 $1$。\n2.  构造裂变源向量 $\\boldsymbol{q}^{(n)} = \\boldsymbol{\\chi}\\, S^{(n)}$，其中 $S^{(n)}$ 是归一化后的值 1。\n3.  求解线性系统 $L\\,\\boldsymbol{\\phi}^{(n+1)} = \\boldsymbol{q}^{(n)}$ 以得到下一个通量迭代值 $\\boldsymbol{\\phi}^{(n+1)}$。\n4.  计算下一次迭代的本征值估计，$k^{(n+1)} = \\sum_{g=1}^{2} \\nu\\Sigma_{f,g}\\,\\phi^{(n+1)}_g$。\n\n任务是执行完整的三次迭代，并报告 $k^{(3)}$ 的精确分数值。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于无限介质的标准多群中子扩散理论，这是核反应堆物理学的基石。幂迭代法是解决此类本征值问题的标准数值技术。给定的截面值被说明是物理上合理的，并且对于热中子反应堆中的材料而言，其数量级是合理的。所涉及的所有原理都是公认的。\n- **适定性**：该问题是适定的。它提供了所有必要的数据、一个清晰的初始条件以及一个确定性的、分步的算法。算子 $L$ 是具有非零对角线元的下三角矩阵，这确保了它是可逆的，并且每一步中的线性系统都存在唯一解。\n- **客观性**：该问题以精确、客观的数学语言表述，没有歧义或主观论断。\n\n该问题没有表现出验证标准中列出的任何缺陷（例如，科学上不健全、不完整、有歧义）。所提供的特定算法导致了快速收敛，但这是问题结构的一个特点，而非缺陷。\n\n### 步骤 3：结论与行动\n该问题是有效的。将提供完整的解答。\n\n### 解题推导\n\n首先，我们根据双能群模型建立算子的矩阵和向量形式。控制方程为 $\\Sigma_{r,g} \\phi_g - \\sum_{g' \\ne g} \\Sigma_{s,g' \\rightarrow g} \\phi_{g'} = \\frac{1}{k} \\chi_g \\sum_{g'} \\nu\\Sigma_{f,g'} \\phi_{g'}$。\n代表移出和入散射的左侧项定义了算子 $L$。对于没有向上散射（$\\Sigma_{s,2\\rightarrow 1}=0$）的双能群，其矩阵形式为：\n$$\nL\\boldsymbol{\\phi} = \\begin{pmatrix} \\Sigma_{r,1}\\phi_1 - 0 \\\\ \\Sigma_{r,2}\\phi_2 - \\Sigma_{s,1\\rightarrow 2}\\phi_1 \\end{pmatrix} = \\begin{pmatrix} \\Sigma_{r,1}  0 \\\\ -\\Sigma_{s,1\\rightarrow 2}  \\Sigma_{r,2} \\end{pmatrix} \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix}\n$$\n导出 $\\boldsymbol{q}^{(n)}$ 的裂变源项涉及到裂变产生向量，我们将其定义为 $\\boldsymbol{F_p}^T = \\begin{pmatrix} \\nu\\Sigma_{f,1}  \\nu\\Sigma_{f,2} \\end{pmatrix}$。裂变谱向量为 $\\boldsymbol{\\chi} = \\begin{pmatrix} \\chi_1 \\\\ \\chi_2 \\end{pmatrix}$。\n\n根据要求，我们将在所有计算中使用精确分数。\n- $\\Sigma_{r,1} = \\frac{1}{2}$, $\\Sigma_{r,2} = \\frac{7}{10}$, $\\Sigma_{s,1\\rightarrow 2} = \\frac{4}{10} = \\frac{2}{5}$\n- $\\nu\\Sigma_{f,1} = \\frac{2}{10} = \\frac{1}{5}$, $\\nu\\Sigma_{f,2} = \\frac{6}{10} = \\frac{3}{5}$\n- $\\chi_1 = \\frac{95}{100} = \\frac{19}{20}$, $\\chi_2 = \\frac{5}{100} = \\frac{1}{20}$\n\n算子 $L$ 和向量 $\\boldsymbol{\\chi}$ 为：\n$$\nL = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ -\\frac{2}{5}  \\frac{7}{10} \\end{pmatrix}, \\quad \\boldsymbol{\\chi} = \\begin{pmatrix} \\frac{19}{20} \\\\ \\frac{1}{20} \\end{pmatrix}\n$$\n用于内积的裂变产生向量为 $\\boldsymbol{F_p}^T = \\begin{pmatrix} \\frac{1}{5}  \\frac{3}{5} \\end{pmatrix}$。\n\n我们现在执行指定的迭代方案。\n\n**初始状态 ($n=0$)：**\n给定的初始通量猜测为 $\\boldsymbol{\\phi}^{(0)} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n**第 1 次迭代 (计算 $\\boldsymbol{\\phi}^{(1)}$ 和 $k^{(1)}$)：**\n1.  计算来自 $\\boldsymbol{\\phi}^{(0)}$ 的未归一化裂变产生：\n    $S^{(0)}_{pre-norm} = \\boldsymbol{F_p}^T \\boldsymbol{\\phi}^{(0)} = \\frac{1}{5}(1) + \\frac{3}{5}(1) = \\frac{4}{5}$。\n    问题陈述要求进行归一化，以使裂变源强度为 $1$。归一化后的源强度为 $S^{(0)} = 1$。\n\n2.  构造裂变源向量 $\\boldsymbol{q}^{(0)}$：\n    $\\boldsymbol{q}^{(0)} = \\boldsymbol{\\chi} S^{(0)} = \\begin{pmatrix} 19/20 \\\\ 1/20 \\end{pmatrix} (1) = \\begin{pmatrix} 19/20 \\\\ 1/20 \\end{pmatrix}$。\n\n3.  求解下一个通量迭代值 $\\boldsymbol{\\phi}^{(1)}$：\n    $L \\boldsymbol{\\phi}^{(1)} = \\boldsymbol{q}^{(0)} \\implies \\begin{pmatrix} \\frac{1}{2}  0 \\\\ -\\frac{2}{5}  \\frac{7}{10} \\end{pmatrix} \\begin{pmatrix} \\phi_1^{(1)} \\\\ \\phi_2^{(1)} \\end{pmatrix} = \\begin{pmatrix} \\frac{19}{20} \\\\ \\frac{1}{20} \\end{pmatrix}$。\n    我们使用前向代入法求解这个下三角系统。\n    由第一行：$\\frac{1}{2}\\phi_1^{(1)} = \\frac{19}{20} \\implies \\phi_1^{(1)} = 2 \\times \\frac{19}{20} = \\frac{19}{10}$。\n    由第二行：$-\\frac{2}{5}\\phi_1^{(1)} + \\frac{7}{10}\\phi_2^{(1)} = \\frac{1}{20}$。\n    代入 $\\phi_1^{(1)}$：$-\\frac{2}{5}\\left(\\frac{19}{10}\\right) + \\frac{7}{10}\\phi_2^{(1)} = \\frac{1}{20} \\implies -\\frac{19}{25} + \\frac{7}{10}\\phi_2^{(1)} = \\frac{1}{20}$。\n    $\\frac{7}{10}\\phi_2^{(1)} = \\frac{1}{20} + \\frac{19}{25} = \\frac{5}{100} + \\frac{76}{100} = \\frac{81}{100}$。\n    $\\phi_2^{(1)} = \\frac{81}{100} \\times \\frac{10}{7} = \\frac{81}{70}$。\n    因此，一次迭代后的通量为 $\\boldsymbol{\\phi}^{(1)} = \\begin{pmatrix} \\frac{19}{10} \\\\ \\frac{81}{70} \\end{pmatrix}$。\n\n4.  计算本征值估计 $k^{(1)}$：\n    $k^{(1)} = \\boldsymbol{F_p}^T \\boldsymbol{\\phi}^{(1)} = \\frac{1}{5}\\left(\\frac{19}{10}\\right) + \\frac{3}{5}\\left(\\frac{81}{70}\\right) = \\frac{19}{50} + \\frac{243}{350}$。\n    $k^{(1)} = \\frac{7 \\times 19}{350} + \\frac{243}{350} = \\frac{133 + 243}{350} = \\frac{376}{350} = \\frac{188}{175}$。\n\n**第 2 次迭代 (计算 $\\boldsymbol{\\phi}^{(2)}$ 和 $k^{(2)}$)：**\n我们从上一步的通量向量开始，$\\boldsymbol{\\phi}^{(1)} = \\begin{pmatrix} \\frac{19}{10} \\\\ \\frac{81}{70} \\end{pmatrix}$。\n\n1.  计算来自 $\\boldsymbol{\\phi}^{(1)}$ 的未归一化裂变产生：\n    $S^{(1)}_{pre-norm} = \\boldsymbol{F_p}^T \\boldsymbol{\\phi}^{(1)}$。这与 $k^{(1)}$ 的计算完全相同，因此 $S^{(1)}_{pre-norm} = \\frac{188}{175}$。归一化后的源强度为 $S^{(1)}=1$。\n\n2.  构造裂变源向量 $\\boldsymbol{q}^{(1)}$：\n    $\\boldsymbol{q}^{(1)} = \\boldsymbol{\\chi} S^{(1)} = \\boldsymbol{\\chi} (1) = \\begin{pmatrix} 19/20 \\\\ 1/20 \\end{pmatrix}$。我们观察到 $\\boldsymbol{q}^{(1)} = \\boldsymbol{q}^{(0)}$。\n\n3.  求解下一个通量迭代值 $\\boldsymbol{\\phi}^{(2)}$：\n    $L \\boldsymbol{\\phi}^{(2)} = \\boldsymbol{q}^{(1)}$。由于右侧项与上一次迭代相同，解也必定相同。\n    $\\boldsymbol{\\phi}^{(2)} = \\boldsymbol{\\phi}^{(1)} = \\begin{pmatrix} \\frac{19}{10} \\\\ \\frac{81}{70} \\end{pmatrix}$。\n\n4.  计算本征值估计 $k^{(2)}$：\n    $k^{(2)} = \\boldsymbol{F_p}^T \\boldsymbol{\\phi}^{(2)}$。由于 $\\boldsymbol{\\phi}^{(2)} = \\boldsymbol{\\phi}^{(1)}$，结果必定相同。\n    $k^{(2)} = k^{(1)} = \\frac{188}{175}$。\n\n**第 3 次迭代 (计算 $\\boldsymbol{\\phi}^{(3)}$ 和 $k^{(3)}$)：**\n起始通量为 $\\boldsymbol{\\phi}^{(2)} = \\boldsymbol{\\phi}^{(1)}$。遵循与第 2 次迭代相同的逻辑，所有后续步骤都将产生相同的结果。\n\n1.  $S^{(2)}_{pre-norm} = k^{(2)} = \\frac{188}{175}$。归一化后的源强度为 $S^{(2)}=1$。\n2.  $\\boldsymbol{q}^{(2)} = \\boldsymbol{\\chi} S^{(2)} = \\boldsymbol{q}^{(1)} = \\boldsymbol{q}^{(0)}$。\n3.  求解 $L \\boldsymbol{\\phi}^{(3)} = \\boldsymbol{q}^{(2)}$ 得到 $\\boldsymbol{\\phi}^{(3)} = \\boldsymbol{\\phi}^{(2)} = \\boldsymbol{\\phi}^{(1)}$。\n4.  因此，$k^{(3)} = \\boldsymbol{F_p}^T \\boldsymbol{\\phi}^{(3)} = k^{(2)} = k^{(1)}$。\n\n指定的迭代方案在一步之内收敛，因为由 $\\boldsymbol{\\chi}$ 决定的裂变源形状是固定的。迭代仅用于寻找由该固定源形状产生的通量形状，这在第一步中就已实现。然后根据这个收敛的通量形状确定本征值。\n\n因此，$k^{(3)}$ 的值为 $\\frac{188}{175}$。",
            "answer": "$$\\boxed{\\frac{188}{175}}$$"
        },
        {
            "introduction": "迭代求解器的收敛速度是实际计算中的一个关键因素。功率迭代法的收敛率由系统的谱特性决定，特别是基波特征值与次高特征值之间的分离程度。本练习探讨了优势比的概念，深入解释了反应堆的内在物理特性如何决定其数值模拟的效率。",
            "id": "4239664",
            "problem": "考虑一个均匀、一维裸平板中的单群中子扩散 $k$-本征值问题，平板的外推厚度为 $L$，真空边界模拟为在平板表面通量为零。其控制方程为\n$$\n- D \\frac{d^{2} \\phi(x)}{dx^{2}} + \\Sigma_{a} \\, \\phi(x) \\;=\\; \\frac{1}{k} \\, \\nu \\Sigma_{f} \\, \\phi(x), \\quad 0  x  L,\n$$\n边界条件为\n$$\n\\phi(0) \\;=\\; 0, \\qquad \\phi(L) \\;=\\; 0.\n$$\n此处，$D$ 是扩散系数，$\\Sigma_{a}$ 是宏观吸收截面，$\\nu \\Sigma_{f}$ 是由裂变产生的宏观产生截面。设材料和几何参数为 $D = 1.3\\,\\mathrm{cm}$，$\\Sigma_{a} = 8.0 \\times 10^{-3}\\,\\mathrm{cm}^{-1}$，$\\nu \\Sigma_{f} = 1.0 \\times 10^{-2}\\,\\mathrm{cm}^{-1}$，以及 $L = 100\\,\\mathrm{cm}$。\n\n仅从单群扩散 $k$-本征值方程和给定的边界条件出发，完成以下任务：\n- 确定此平板的第二空间本征模 $\\phi_{2}(x)$ 的函数形式（不计任意非零乘法常数）。\n- 利用此结果，推导前两个 $k$-本征值 $k_{1}$ 和 $k_{2}$ 以及优势比（DR）的表达式，此处定义为 $\\mathrm{DR} = \\left| k_{2} / k_{1} \\right|$。\n- 在应用于相应裂变算子本征问题的经典幂迭代（PI）方法中，与基模正交的渐近误差分量每次迭代会减少一个因子 $\\mathrm{DR}$。计算使该正交误差分量从其初始大小减少 $10^{-6}$ 倍所需的最小迭代次数。仅报告此最小整数值。\n\n给出最终答案，为一个纯数字（无单位）。除了取满足要求的最小整数外，不需要其他取整说明。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n单群中子扩散k本征值问题的控制方程为：\n$$\n- D \\frac{d^{2} \\phi(x)}{dx^{2}} + \\Sigma_{a} \\, \\phi(x) \\;=\\; \\frac{1}{k} \\, \\nu \\Sigma_{f} \\, \\phi(x), \\quad 0  x  L\n$$\n边界条件为：\n$$\n\\phi(0) \\;=\\; 0, \\qquad \\phi(L) \\;=\\; 0\n$$\n材料和几何参数为：\n- 扩散系数, $D = 1.3\\,\\mathrm{cm}$\n- 宏观吸收截面, $\\Sigma_{a} = 8.0 \\times 10^{-3}\\,\\mathrm{cm}^{-1}$\n- 宏观产生截面, $\\nu \\Sigma_{f} = 1.0 \\times 10^{-2}\\,\\mathrm{cm}^{-1}$\n- 外推厚度, $L = 100\\,\\mathrm{cm}$\n任务是：\n1. 确定第二空间本征模 $\\phi_{2}(x)$ 的函数形式。\n2. 推导前两个k本征值 $k_{1}$ 和 $k_{2}$ 以及优势比 $\\mathrm{DR} = |k_2/k_1|$ 的表达式。\n3. 计算将与基模正交的误差分量减少 $10^{-6}$ 倍所需的最小幂迭代次数 $N$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了一个标准的单群、一维中子扩散本征值问题，这是核反应堆物理中的一个基本模型。控制方程是增殖介质中中子平衡的一个成熟的表示方法。给定的参数单位一致，其量级对于热中子反应堆系统是物理上合理的。该问题是适定的，有一个二阶线性齐次常微分方程和两个边界条件，这会导出一组唯一的本征函数和本征值（一个 Sturm-Liouville 问题）。语言客观而精确。问题是自洽的，没有矛盾或歧义。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。将提供解答。\n\n为了解决这个问题，我们首先重新整理控制微分方程。\n$$\n- D \\frac{d^{2} \\phi(x)}{dx^{2}} + \\Sigma_{a} \\, \\phi(x) \\;=\\; \\frac{1}{k} \\, \\nu \\Sigma_{f} \\, \\phi(x)\n$$\n$$\n- D \\frac{d^{2} \\phi(x)}{dx^{2}} \\;=\\; \\left( \\frac{\\nu \\Sigma_{f}}{k} - \\Sigma_{a} \\right) \\phi(x)\n$$\n$$\n\\frac{d^{2} \\phi(x)}{dx^{2}} + \\frac{1}{D} \\left( \\frac{\\nu \\Sigma_{f}}{k} - \\Sigma_{a} \\right) \\phi(x) \\;=\\; 0\n$$\n这是亥姆霍兹方程的标准形式。我们定义材料曲率 $B_m^2$ 为：\n$$\nB_m^2 \\;=\\; \\frac{1}{D} \\left( \\frac{\\nu \\Sigma_{f}}{k} - \\Sigma_{a} \\right)\n$$\n微分方程变为：\n$$\n\\frac{d^{2} \\phi(x)}{dx^{2}} + B_m^2 \\, \\phi(x) \\;=\\; 0\n$$\n这个二阶线性齐次常微分方程的通解是：\n$$\n\\phi(x) \\;=\\; A \\sin(B_m x) + C \\cos(B_m x)\n$$\n其中 $A$ 和 $C$ 是常数。我们应用边界条件来找到这些常数和 $B_m$ 的允许值。\n\n应用第一个边界条件 $\\phi(0) = 0$：\n$$\n\\phi(0) \\;=\\; A \\sin(B_m \\cdot 0) + C \\cos(B_m \\cdot 0) \\;=\\; A \\cdot 0 + C \\cdot 1 \\;=\\; C \\;=\\; 0\n$$\n这将解简化为 $\\phi(x) = A \\sin(B_m x)$ 的形式。\n\n应用第二个边界条件 $\\phi(L) = 0$：\n$$\n\\phi(L) \\;=\\; A \\sin(B_m L) \\;=\\; 0\n$$\n对于非平凡解（即 $\\phi(x)$ 不处处为零），振幅 $A$ 不能为零。因此，我们必须有：\n$$\n\\sin(B_m L) \\;=\\; 0\n$$\n如果正弦函数的宗量是 $\\pi$ 的整数倍，则满足此条件：\n$$\nB_m L \\;=\\; n \\pi, \\quad \\text{for } n = 1, 2, 3, \\ldots\n$$\n$n=0$ 的情况会导致 $B_m=0$，从而得到平凡解 $\\phi(x)=0$，因此被排除。索引 $n$ 标识了不同的本征模。曲率的允许值，现在称为几何曲率 $B_g^2$，是量子化的：\n$$\nB_n^2 \\;=\\; \\left( \\frac{n \\pi}{L} \\right)^2\n$$\n相应的本征函数（或空间模）为：\n$$\n\\phi_n(x) \\;=\\; A_n \\sin\\left(\\frac{n \\pi x}{L}\\right)\n$$\n其中 $A_n$ 是每个模 $n$ 的任意非零常数。\n\n问题的第一部分要求第二空间本征模 $\\phi_2(x)$ 的函数形式，它对应于 $n=2$：\n$$\n\\phi_2(x) \\;=\\; A_2 \\sin\\left(\\frac{2 \\pi x}{L}\\right)\n$$\n在不计任意乘法常数的情况下，函数形式为 $\\sin\\left(\\frac{2 \\pi x}{L}\\right)$。\n\n对于第二部分，我们推导本征值 $k_n$。通过令每个模 $n$ 的材料曲率和几何曲率表达式相等，即 $B_m^2 = B_n^2$，我们得到：\n$$\n\\frac{1}{D} \\left( \\frac{\\nu \\Sigma_{f}}{k_n} - \\Sigma_{a} \\right) \\;=\\; \\left( \\frac{n \\pi}{L} \\right)^2\n$$\n求解本征值 $k_n$：\n$$\n\\frac{\\nu \\Sigma_{f}}{k_n} - \\Sigma_{a} \\;=\\; D \\left( \\frac{n \\pi}{L} \\right)^2\n$$\n$$\n\\frac{\\nu \\Sigma_{f}}{k_n} \\;=\\; D \\left( \\frac{n \\pi}{L} \\right)^2 + \\Sigma_{a}\n$$\n$$\nk_n \\;=\\; \\frac{\\nu \\Sigma_{f}}{D \\left(\\frac{n \\pi}{L}\\right)^2 + \\Sigma_{a}}\n$$\n第一个本征值 $k_1$（对于基模 $n=1$）是：\n$$\nk_1 \\;=\\; \\frac{\\nu \\Sigma_{f}}{D \\left(\\frac{\\pi}{L}\\right)^2 + \\Sigma_{a}}\n$$\n第二个本征值 $k_2$（对于第二模 $n=2$）是：\n$$\nk_2 \\;=\\; \\frac{\\nu \\Sigma_{f}}{D \\left(\\frac{2 \\pi}{L}\\right)^2 + \\Sigma_{a}}\n$$\n优势比 $\\mathrm{DR}$ 定义为 $|k_2/k_1|$。由于所有物理参数（$D, \\Sigma_a, \\nu\\Sigma_f, L$）都是正的，所以 $k_1$ 和 $k_2$ 也都是正的。因此，$\\mathrm{DR} = k_2/k_1$：\n$$\n\\mathrm{DR} \\;=\\; \\frac{k_2}{k_1} \\;=\\; \\frac{\\frac{\\nu \\Sigma_{f}}{D \\left(\\frac{2 \\pi}{L}\\right)^2 + \\Sigma_{a}}}{\\frac{\\nu \\Sigma_{f}}{D \\left(\\frac{\\pi}{L}\\right)^2 + \\Sigma_{a}}} \\;=\\; \\frac{D \\left(\\frac{\\pi}{L}\\right)^2 + \\Sigma_{a}}{D \\left(\\frac{2 \\pi}{L}\\right)^2 + \\Sigma_{a}} \\;=\\; \\frac{D \\frac{\\pi^2}{L^2} + \\Sigma_{a}}{4 D \\frac{\\pi^2}{L^2} + \\Sigma_{a}}\n$$\n\n对于最后一部分，我们必须找到使误差减少 $10^{-6}$ 倍所需的最小迭代次数 $N$。每次迭代的误差减少量由优势比 $\\mathrm{DR}$ 给出。经过 $N$ 次迭代后，初始误差分量减少了 $(\\mathrm{DR})^N$ 倍。我们要求这个因子小于或等于 $10^{-6}$：\n$$\n(\\mathrm{DR})^N \\;\\leq\\; 10^{-6}\n$$\n对两边取自然对数：\n$$\nN \\ln(\\mathrm{DR}) \\;\\leq\\; \\ln(10^{-6}) \\;=\\; -6 \\ln(10)\n$$\n由于 DR 表达式中分母大于分子，所以 $0  \\mathrm{DR}  1$，这意味着 $\\ln(\\mathrm{DR})$ 是负数。除以一个负数会使不等式反向：\n$$\nN \\;\\geq\\; \\frac{-6 \\ln(10)}{\\ln(\\mathrm{DR})}\n$$\n现在我们代入数值：$D = 1.3$，$\\Sigma_{a} = 8.0 \\times 10^{-3} = 0.008$，以及 $L = 100$。\n首先，计算项 $D \\frac{\\pi^2}{L^2}$：\n$$\nD \\frac{\\pi^2}{L^2} \\;=\\; 1.3 \\times \\frac{\\pi^2}{100^2} \\;=\\; 1.3 \\times \\frac{\\pi^2}{10000} \\;\\approx\\; 1.3 \\times 9.8696044 \\times 10^{-4} \\;\\approx\\; 1.2830486 \\times 10^{-3}\n$$\n现在，我们可以计算优势比 $\\mathrm{DR}$：\n$$\n\\mathrm{DR} \\;=\\; \\frac{1.2830486 \\times 10^{-3} + 0.008}{4 \\times (1.2830486 \\times 10^{-3}) + 0.008} \\;=\\; \\frac{0.0092830486}{0.0051321944 + 0.008} \\;=\\; \\frac{0.0092830486}{0.0131321944} \\;\\approx\\; 0.70703816\n$$\n现在，我们计算 $N$ 的下界：\n$$\n\\ln(\\mathrm{DR}) \\;\\approx\\; \\ln(0.70703816) \\;\\approx\\; -0.3466183\n$$\n$$\n\\ln(10) \\;\\approx\\; 2.302585\n$$\n$$\nN \\;\\geq\\; \\frac{-6 \\times 2.302585}{-0.3466183} \\;\\approx\\; \\frac{13.81551}{0.3466183} \\;\\approx\\; 39.857\n$$\n由于迭代次数 $N$ 必须是整数，所以所需的最小迭代次数是大于或等于 $39.857$ 的最小整数。\n$$\nN_{min} \\;=\\; 40\n$$",
            "answer": "$$\\boxed{40}$$"
        }
    ]
}