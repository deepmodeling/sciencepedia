{
    "hands_on_practices": [
        {
            "introduction": "Before developing numerical solvers, it is essential to master the analytical solution for simplified problems. This exercise  provides a foundational test case by asking you to determine the critical size of a bare nuclear reactor slab. Solving this problem reinforces the physical concept of criticality and establishes a direct link between a reactor's material composition and its required physical dimensions, providing an exact benchmark for later numerical verification.",
            "id": "4239672",
            "problem": "Consider a one-dimensional, single-energy-group neutron diffusion $k$-eigenvalue problem for a homogeneous bare slab of extrapolated thickness $L$ in vacuum, modeled on the interval $x \\in [0,L]$ with vacuum boundary conditions approximated by zero flux at the extrapolated boundaries, i.e., $\\phi(0)=0$ and $\\phi(L)=0$. The steady-state $k$-eigenvalue formulation of the single-group diffusion approximation stipulates that the neutron scalar flux $\\phi(x)$ satisfies\n$$\n- D \\frac{d^{2}\\phi}{dx^{2}} + \\Sigma_{a} \\phi = \\frac{\\nu \\Sigma_{f}}{k} \\phi,\n$$\nwhere $D$ is the neutron diffusion coefficient, $\\Sigma_{a}$ is the macroscopic absorption cross section, and $\\nu \\Sigma_{f}$ is the macroscopic neutron production cross section (average neutrons per fission times the macroscopic fission cross section). The effective multiplication factor ($k$-effective, written as $k$) characterizes the balance between production and losses.\n\nStarting from the above governing equation and the boundary conditions, derive the condition that must be satisfied by $L$ at criticality ($k=1$) for the existence of a nontrivial solution, and then solve for the critical slab thickness $L$. Use the material parameters $D = 1.2$ cm, $\\Sigma_{a} = 0.08$ cm$^{-1}$, and $\\nu \\Sigma_{f} = 0.1$ cm$^{-1}$.\n\nExpress the final $L$ in centimeters and round your answer to four significant figures.",
            "solution": "The problem asks for the derivation of the criticality condition and the calculation of the critical slab thickness for a one-dimensional, single-group neutron diffusion problem.\n\nThe governing equation for the neutron scalar flux $\\phi(x)$ is given as:\n$$\n- D \\frac{d^{2}\\phi}{dx^{2}} + \\Sigma_{a} \\phi = \\frac{\\nu \\Sigma_{f}}{k} \\phi\n$$\nThis equation is defined on the domain $x \\in [0,L]$ with homogeneous Dirichlet boundary conditions, $\\phi(0) = 0$ and $\\phi(L) = 0$.\n\nFirst, we rearrange the governing equation into a more standard form. We move all terms involving $\\phi$ to one side:\n$$\n- D \\frac{d^{2}\\phi}{dx^{2}} + \\left( \\Sigma_{a} - \\frac{\\nu \\Sigma_{f}}{k} \\right) \\phi = 0\n$$\nDividing by the diffusion coefficient $D$ (which is non-zero), we get:\n$$\n\\frac{d^{2}\\phi}{dx^{2}} - \\frac{1}{D} \\left( \\Sigma_{a} - \\frac{\\nu \\Sigma_{f}}{k} \\right) \\phi = 0\n$$\n$$\n\\frac{d^{2}\\phi}{dx^{2}} + \\frac{1}{D} \\left( \\frac{\\nu \\Sigma_{f}}{k} - \\Sigma_{a} \\right) \\phi = 0\n$$\nThis is a second-order linear homogeneous ordinary differential equation. For a finite-sized system to be critical or supercritical, the rate of neutron production must exceed the rate of absorption, i.e., $\\nu\\Sigma_f  \\Sigma_a$. This ensures that the term in the parenthesis can be positive. Let's define the material buckling, $B^2$, as:\n$$\nB^2 = \\frac{1}{D} \\left( \\frac{\\nu \\Sigma_{f}}{k} - \\Sigma_{a} \\right)\n$$\nThe differential equation becomes the Helmholtz equation:\n$$\n\\frac{d^{2}\\phi}{dx^{2}} + B^2 \\phi = 0\n$$\nThe problem specifies the condition of criticality, which means the effective multiplication factor $k=1$. At this condition, the material buckling is denoted as $B_m^2$:\n$$\nB_m^2 = \\frac{\\nu \\Sigma_{f} - \\Sigma_{a}}{D}\n$$\nFor a physically meaningful, spatially oscillating solution to exist (which is required to satisfy the zero flux boundary conditions on a finite domain), we must have $B_m^2  0$. This implies $\\nu\\Sigma_f  \\Sigma_a$. Using the given material parameters:\n$D = 1.2 \\text{ cm}$, $\\Sigma_{a} = 0.08 \\text{ cm}^{-1}$, and $\\nu \\Sigma_{f} = 0.1 \\text{ cm}^{-1}$.\n$$\n\\nu \\Sigma_{f} - \\Sigma_{a} = 0.1 - 0.08 = 0.02 \\text{ cm}^{-1}\n$$\nSince this value is positive, $B_m^2  0$, and a non-trivial solution can exist.\n\nThe general solution to the equation $\\frac{d^{2}\\phi}{dx^{2}} + B_m^2 \\phi = 0$ is:\n$$\n\\phi(x) = A \\sin(B_m x) + C \\cos(B_m x)\n$$\nwhere $A$ and $C$ are constants to be determined by the boundary conditions.\n\nApplying the first boundary condition, $\\phi(0) = 0$:\n$$\n\\phi(0) = A \\sin(B_m \\cdot 0) + C \\cos(B_m \\cdot 0) = A \\cdot 0 + C \\cdot 1 = C\n$$\nThus, we must have $C=0$. The solution simplifies to:\n$$\n\\phi(x) = A \\sin(B_m x)\n$$\nApplying the second boundary condition, $\\phi(L) = 0$:\n$$\n\\phi(L) = A \\sin(B_m L) = 0\n$$\nFor a nontrivial solution, the flux cannot be zero everywhere, which means the amplitude $A$ cannot be zero ($A \\neq 0$). Therefore, the condition that must be satisfied is:\n$$\n\\sin(B_m L) = 0\n$$\nThis equation holds true if the argument of the sine function is an integer multiple of $\\pi$:\n$$\nB_m L = n \\pi, \\quad \\text{for } n \\in \\{1, 2, 3, ...\\}\n$$\nThe case $n=0$ is excluded as it would imply $L=0$, a trivial geometry. Negative integers for $n$ are also excluded as they would correspond to a negative, unphysical length $L$. The solutions for $n  1$ represent higher harmonics, where the flux would become negative within the domain $(0, L)$. Since the scalar flux must be non-negative, the only physically acceptable solution is the fundamental mode, corresponding to $n=1$.\n\nTherefore, the condition that must be satisfied by the extrapolated thickness $L$ at criticality for the existence of a nontrivial fundamental-mode solution is:\n$$\nB_m L = \\pi\n$$\nThis relation is often expressed as the equality of the material buckling $B_m^2$ and the geometric buckling $B_g^2 = (\\pi/L)^2$. So, the criticality condition is $B_m^2 = B_g^2$.\n\nNow, we solve for the critical slab thickness $L$:\n$$\nL = \\frac{\\pi}{B_m}\n$$\nSubstituting the definition of $B_m$:\n$$\nL = \\frac{\\pi}{\\sqrt{\\frac{\\nu \\Sigma_{f} - \\Sigma_{a}}{D}}} = \\pi \\sqrt{\\frac{D}{\\nu \\Sigma_{f} - \\Sigma_{a}}}\n$$\nNow, we substitute the given numerical values into this expression:\n$$\nL = \\pi \\sqrt{\\frac{1.2}{0.1 - 0.08}} = \\pi \\sqrt{\\frac{1.2}{0.02}} = \\pi \\sqrt{60}\n$$\nCalculating the numerical value:\n$$\nL = \\pi \\times 7.74596669... \\approx 24.333146... \\text{ cm}\n$$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $2$, $4$, $3$, and $3$. The fifth digit is $3$, so we round down.\n$$\nL \\approx 24.33 \\text{ cm}\n$$",
            "answer": "$$\n\\boxed{24.33}\n$$"
        },
        {
            "introduction": "The power iteration method is the workhorse for solving the fission source eigenvalue problem, but its efficiency is not guaranteed. The rate of convergence is governed by the dominance ratio, which measures the separation between the fundamental eigenvalue, $k_1$, and the first harmonic, $k_2$. This practice  delves into this crucial spectral property, tasking you with calculating the dominance ratio for a slab reactor and using it to predict the number of iterations required to achieve a desired accuracy.",
            "id": "4239664",
            "problem": "Consider a one-group neutron diffusion $k$-eigenvalue problem in a homogeneous, one-dimensional bare slab of extrapolated thickness $L$ with vacuum boundaries modeled as zero flux at the slab faces. The governing equation is\n$$\n- D \\frac{d^{2} \\phi(x)}{dx^{2}} + \\Sigma_{a} \\, \\phi(x) \\;=\\; \\frac{1}{k} \\, \\nu \\Sigma_{f} \\, \\phi(x), \\quad 0  x  L,\n$$\nwith boundary conditions\n$$\n\\phi(0) \\;=\\; 0, \\qquad \\phi(L) \\;=\\; 0.\n$$\nHere $D$ is the diffusion coefficient, $\\Sigma_{a}$ is the macroscopic absorption cross section, and $\\nu \\Sigma_{f}$ is the macroscopic production cross section from fission. Let the material and geometric parameters be $D = 1.3\\,\\mathrm{cm}$, $\\Sigma_{a} = 8.0 \\times 10^{-3}\\,\\mathrm{cm}^{-1}$, $\\nu \\Sigma_{f} = 1.0 \\times 10^{-2}\\,\\mathrm{cm}^{-1}$, and $L = 100\\,\\mathrm{cm}$.\n\nStarting only from the one-group diffusion $k$-eigenvalue equation and the stated boundary conditions, do the following:\n- Determine the functional form of the second spatial eigenmode $\\phi_{2}(x)$ (up to an arbitrary nonzero multiplicative constant) for this slab.\n- Using this result, derive the expressions for the first two $k$-eigenvalues $k_{1}$ and $k_{2}$ and the dominance ratio (DR), defined here as $\\mathrm{DR} = \\left| k_{2} / k_{1} \\right|$.\n- In the context of the classical Power Iteration (PI) applied to the corresponding fission operator eigenproblem, the asymptotic error component orthogonal to the fundamental mode is reduced per iteration by a factor of $\\mathrm{DR}$. Compute the minimum number of iterations required so that this orthogonal error component is reduced by a factor of $10^{-6}$ from its initial magnitude. Report only this minimum integer count.\n\nGive the final answer as a pure number (no units). No rounding instructions are needed beyond taking the minimum integer that satisfies the requirement.",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n**Step 1: Extract Givens**\nThe governing equation for the one-group neutron diffusion k-eigenvalue problem is:\n$$\n- D \\frac{d^{2} \\phi(x)}{dx^{2}} + \\Sigma_{a} \\, \\phi(x) \\;=\\; \\frac{1}{k} \\, \\nu \\Sigma_{f} \\, \\phi(x), \\quad 0  x  L\n$$\nThe boundary conditions are:\n$$\n\\phi(0) \\;=\\; 0, \\qquad \\phi(L) \\;=\\; 0\n$$\nThe material and geometric parameters are:\n- Diffusion coefficient, $D = 1.3\\,\\mathrm{cm}$\n- Macroscopic absorption cross section, $\\Sigma_{a} = 8.0 \\times 10^{-3}\\,\\mathrm{cm}^{-1}$\n- Macroscopic production cross section, $\\nu \\Sigma_{f} = 1.0 \\times 10^{-2}\\,\\mathrm{cm}^{-1}$\n- Extrapolated thickness, $L = 100\\,\\mathrm{cm}$\nThe tasks are to:\n1. Determine the functional form of the second spatial eigenmode $\\phi_{2}(x)$.\n2. Derive the expressions for the first two k-eigenvalues $k_{1}$ and $k_{2}$ and the dominance ratio $\\mathrm{DR} = |k_2/k_1|$.\n3. Compute the minimum number of Power Iteration iterations, $N$, required to reduce the error component orthogonal to the fundamental mode by a factor of $10^{-6}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, describing a standard one-group, one-dimensional neutron diffusion eigenvalue problem, which is a fundamental model in nuclear reactor physics. The governing equation is a well-established representation of neutron balance in a multiplying medium. The parameters are given with consistent units and have physically plausible magnitudes for a thermal reactor system. The problem is well-posed, with a second-order linear homogeneous ordinary differential equation and two boundary conditions, which leads to a unique set of eigenfunctions and eigenvalues (a Sturm-Liouville problem). The language is objective and precise. The problem is self-contained and free of contradictions or ambiguities.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be provided.\n\nTo solve the problem, we first rearrange the governing differential equation.\n$$\n- D \\frac{d^{2} \\phi(x)}{dx^{2}} + \\Sigma_{a} \\, \\phi(x) \\;=\\; \\frac{1}{k} \\, \\nu \\Sigma_{f} \\, \\phi(x)\n$$\n$$\n- D \\frac{d^{2} \\phi(x)}{dx^{2}} \\;=\\; \\left( \\frac{\\nu \\Sigma_{f}}{k} - \\Sigma_{a} \\right) \\phi(x)\n$$\n$$\n\\frac{d^{2} \\phi(x)}{dx^{2}} + \\frac{1}{D} \\left( \\frac{\\nu \\Sigma_{f}}{k} - \\Sigma_{a} \\right) \\phi(x) \\;=\\; 0\n$$\nThis is a standard form of the Helmholtz equation. Let us define the material buckling, $B_m^2$, as:\n$$\nB_m^2 \\;=\\; \\frac{1}{D} \\left( \\frac{\\nu \\Sigma_{f}}{k} - \\Sigma_{a} \\right)\n$$\nThe differential equation becomes:\n$$\n\\frac{d^{2} \\phi(x)}{dx^{2}} + B_m^2 \\, \\phi(x) \\;=\\; 0\n$$\nThe general solution to this second-order linear homogeneous ordinary differential equation is:\n$$\n\\phi(x) \\;=\\; A \\sin(B_m x) + C \\cos(B_m x)\n$$\nwhere $A$ and $C$ are constants. We apply the boundary conditions to find these constants and the allowed values of $B_m$.\n\nApplying the first boundary condition, $\\phi(0) = 0$:\n$$\n\\phi(0) \\;=\\; A \\sin(B_m \\cdot 0) + C \\cos(B_m \\cdot 0) \\;=\\; A \\cdot 0 + C \\cdot 1 \\;=\\; C \\;=\\; 0\n$$\nThis reduces the solution to the form $\\phi(x) = A \\sin(B_m x)$.\n\nApplying the second boundary condition, $\\phi(L) = 0$:\n$$\n\\phi(L) \\;=\\; A \\sin(B_m L) \\;=\\; 0\n$$\nFor a non-trivial solution (i.e., $\\phi(x)$ is not zero everywhere), the amplitude $A$ cannot be zero. Therefore, we must have:\n$$\n\\sin(B_m L) \\;=\\; 0\n$$\nThis condition is satisfied if the argument of the sine function is an integer multiple of $\\pi$:\n$$\nB_m L \\;=\\; n \\pi, \\quad \\text{for } n = 1, 2, 3, \\ldots\n$$\nThe case $n=0$ leads to $B_m=0$ and thus a trivial solution $\\phi(x)=0$, so it is excluded. The index $n$ identifies the different eigenmodes. The allowed values of the buckling, now referred to as the geometric buckling $B_g^2$, are quantized:\n$$\nB_n^2 \\;=\\; \\left( \\frac{n \\pi}{L} \\right)^2\n$$\nThe corresponding eigenfunctions (or spatial modes) are:\n$$\n\\phi_n(x) \\;=\\; A_n \\sin\\left(\\frac{n \\pi x}{L}\\right)\n$$\nwhere $A_n$ is an arbitrary non-zero constant for each mode $n$.\n\nThe first part of the problem asks for the functional form of the second spatial eigenmode, $\\phi_2(x)$, which corresponds to $n=2$:\n$$\n\\phi_2(x) \\;=\\; A_2 \\sin\\left(\\frac{2 \\pi x}{L}\\right)\n$$\nUp to an arbitrary multiplicative constant, the functional form is $\\sin\\left(\\frac{2 \\pi x}{L}\\right)$.\n\nFor the second part, we derive the eigenvalues $k_n$. By equating the material and geometric buckling expressions for each mode $n$, $B_m^2 = B_n^2$, we get:\n$$\n\\frac{1}{D} \\left( \\frac{\\nu \\Sigma_{f}}{k_n} - \\Sigma_{a} \\right) \\;=\\; \\left( \\frac{n \\pi}{L} \\right)^2\n$$\nSolving for the eigenvalue $k_n$:\n$$\n\\frac{\\nu \\Sigma_{f}}{k_n} - \\Sigma_{a} \\;=\\; D \\left( \\frac{n \\pi}{L} \\right)^2\n$$\n$$\n\\frac{\\nu \\Sigma_{f}}{k_n} \\;=\\; D \\left( \\frac{n \\pi}{L} \\right)^2 + \\Sigma_{a}\n$$\n$$\nk_n \\;=\\; \\frac{\\nu \\Sigma_{f}}{D \\left(\\frac{n \\pi}{L}\\right)^2 + \\Sigma_{a}}\n$$\nThe first eigenvalue, $k_1$ (for the fundamental mode $n=1$), is:\n$$\nk_1 \\;=\\; \\frac{\\nu \\Sigma_{f}}{D \\left(\\frac{\\pi}{L}\\right)^2 + \\Sigma_{a}}\n$$\nThe second eigenvalue, $k_2$ (for the second mode $n=2$), is:\n$$\nk_2 \\;=\\; \\frac{\\nu \\Sigma_{f}}{D \\left(\\frac{2 \\pi}{L}\\right)^2 + \\Sigma_{a}}\n$$\nThe dominance ratio, $\\mathrm{DR}$, is defined as $|k_2/k_1|$. Since all physical parameters ($D, \\Sigma_a, \\nu\\Sigma_f, L$) are positive, both $k_1$ and $k_2$ are positive. Thus, $\\mathrm{DR} = k_2/k_1$:\n$$\n\\mathrm{DR} \\;=\\; \\frac{k_2}{k_1} \\;=\\; \\frac{\\frac{\\nu \\Sigma_{f}}{D \\left(\\frac{2 \\pi}{L}\\right)^2 + \\Sigma_{a}}}{\\frac{\\nu \\Sigma_{f}}{D \\left(\\frac{\\pi}{L}\\right)^2 + \\Sigma_{a}}} \\;=\\; \\frac{D \\left(\\frac{\\pi}{L}\\right)^2 + \\Sigma_{a}}{D \\left(\\frac{2 \\pi}{L}\\right)^2 + \\Sigma_{a}} \\;=\\; \\frac{D \\frac{\\pi^2}{L^2} + \\Sigma_{a}}{4 D \\frac{\\pi^2}{L^2} + \\Sigma_{a}}\n$$\n\nFor the final part, we must find the minimum number of iterations, $N$, for the error to be reduced by a factor of $10^{-6}$. The error reduction per iteration is given by the dominance ratio, $\\mathrm{DR}$. After $N$ iterations, the initial error component is reduced by a factor of $(\\mathrm{DR})^N$. We require this factor to be less than or equal to $10^{-6}$:\n$$\n(\\mathrm{DR})^N \\;\\leq\\; 10^{-6}\n$$\nTaking the natural logarithm of both sides:\n$$\nN \\ln(\\mathrm{DR}) \\;\\leq\\; \\ln(10^{-6}) \\;=\\; -6 \\ln(10)\n$$\nSince the denominator in the DR expression is larger than the numerator, $0  \\mathrm{DR}  1$, which means $\\ln(\\mathrm{DR})$ is negative. Dividing by a negative number reverses the inequality:\n$$\nN \\;\\geq\\; \\frac{-6 \\ln(10)}{\\ln(\\mathrm{DR})}\n$$\nNow we substitute the numerical values: $D = 1.3$, $\\Sigma_{a} = 8.0 \\times 10^{-3} = 0.008$, and $L = 100$.\nFirst, calculate the term $D \\frac{\\pi^2}{L^2}$:\n$$\nD \\frac{\\pi^2}{L^2} \\;=\\; 1.3 \\times \\frac{\\pi^2}{100^2} \\;=\\; 1.3 \\times \\frac{\\pi^2}{10000} \\;\\approx\\; 1.3 \\times 9.8696044 \\times 10^{-4} \\;\\approx\\; 1.2830486 \\times 10^{-3}\n$$\nNow, we can compute the dominance ratio $\\mathrm{DR}$:\n$$\n\\mathrm{DR} \\;=\\; \\frac{1.2830486 \\times 10^{-3} + 0.008}{4 \\times (1.2830486 \\times 10^{-3}) + 0.008} \\;=\\; \\frac{0.0092830486}{0.0051321944 + 0.008} \\;=\\; \\frac{0.0092830486}{0.0131321944} \\;\\approx\\; 0.70703816\n$$\nNow, we calculate the lower bound for $N$:\n$$\n\\ln(\\mathrm{DR}) \\;\\approx\\; \\ln(0.70703816) \\;\\approx\\; -0.3466183\n$$\n$$\n\\ln(10) \\;\\approx\\; 2.302585\n$$\n$$\nN \\;\\geq\\; \\frac{-6 \\times 2.302585}{-0.3466183} \\;\\approx\\; \\frac{13.81551}{0.3466183} \\;\\approx\\; 39.857\n$$\nSince the number of iterations $N$ must be an integer, the minimum number of iterations required is the smallest integer greater than or equal to $39.857$.\n$$\nN_{min} \\;=\\; 40\n$$",
            "answer": "$$\\boxed{40}$$"
        },
        {
            "introduction": "Ultimately, most real-world reactor physics problems require computational solutions. This exercise  guides you through the process of translating the continuous diffusion equation into a discrete matrix eigenvalue problem using the finite difference method. By implementing a simple solver and performing a grid refinement study, you will gain hands-on experience in verifying the accuracy and convergence rate of a numerical scheme, a fundamental skill in computational science.",
            "id": "4239697",
            "problem": "Consider the one-dimensional steady-state neutron diffusion $k$-eigenvalue problem in a homogeneous slab of length $L$ with vacuum boundary conditions. The governing model is derived from neutron balance together with Fick's law and assumes one energy group, isotropic scattering treated implicitly, and spatially constant material properties. Specifically, the continuous model is\n$$\n- \\nabla \\cdot \\left( D \\nabla \\phi(x) \\right) + \\Sigma_a \\,\\phi(x) = \\frac{1}{k}\\,\\nu \\Sigma_f \\,\\phi(x), \\quad x \\in (0,L),\n$$\nwith boundary conditions\n$$\n\\phi(0) = 0, \\quad \\phi(L) = 0,\n$$\nwhere $D$ is the diffusion coefficient, $\\Sigma_a$ is the macroscopic absorption cross section, $\\nu \\Sigma_f$ is the macroscopic fission neutron production term, and $k$ is the multiplication factor (the eigenvalue). All symbols and numbers must be interpreted in centimeters and inverse centimeters: $D$ in $\\mathrm{cm}$, $\\Sigma_a$ in $\\mathrm{cm}^{-1}$, $\\nu \\Sigma_f$ in $\\mathrm{cm}^{-1}$, and $L$ in $\\mathrm{cm}$. The multiplication factor $k$ is dimensionless.\n\nYour task is to construct a numerical approximation to the fundamental eigenvalue $k$ using a centered finite difference method on a uniform grid with $N$ nodes (including the two boundary nodes). The discretization must be consistent with the boundary conditions and the model equation. From first principles, derive the discrete operator and the resulting matrix eigenvalue problem whose smallest eigenvalue corresponds to the fundamental mode. Compute the approximate multiplication factor $k_h$ for each mesh and analyze the effect of grid refinement by comparing these values to an analytical reference $k_{\\text{exact}}$ obtained from the continuous model under the same assumptions and boundary conditions.\n\nThen, estimate the convergence rate of the eigenvalue error. Define the absolute error for grid size $h$ by\n$$\ne_h = \\left| k_h - k_{\\text{exact}} \\right|,\n$$\nand for two successive refinements with grid spacings $h_1$ and $h_2$, estimate the rate $p$ by\n$$\np = \\frac{\\log\\left(e_{h_1}/e_{h_2}\\right)}{\\log\\left(h_1/h_2\\right)}.\n$$\n\nUse the following test suite of parameter values to ensure coverage of general and edge cases:\n- Homogeneous slab length: $L = 100\\,\\mathrm{cm}$.\n- Diffusion coefficient: $D = 1.0\\,\\mathrm{cm}$.\n- Macroscopic absorption: $\\Sigma_a = 0.01\\,\\mathrm{cm}^{-1}$.\n- Macroscopic fission production: $\\nu \\Sigma_f = 0.011\\,\\mathrm{cm}^{-1}$.\n- Grids: $N \\in \\{3, 11, 21, 41, 81\\}$ nodes; for each $N$, define the uniform mesh size by $h = L/(N-1)$.\n\nFor each $N$ in the test suite, compute the approximate fundamental multiplication factor $k_h$ and the corresponding absolute error $e_h$ relative to the analytical reference $k_{\\text{exact}}$. Then, for successive pairs $(N_i,N_{i+1})$ with mesh sizes $(h_i,h_{i+1})$, compute the estimated rate $p_i$ using the formula above.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, aggregating all test cases in the following format:\n$$\n\\left[\\left[k_{h}(N_1),k_{h}(N_2),k_{h}(N_3),k_{h}(N_4),k_{h}(N_5)\\right],\\left[e_{h}(N_1),e_{h}(N_2),e_{h}(N_3),e_{h}(N_4),e_{h}(N_5)\\right],\\left[p_1,p_2,p_3,p_4\\right]\\right].\n$$\nAll entries must be real numbers (floats). The final multiplication factor values $k_h$ and the errors $e_h$ must be reported in dimensionless form, and the estimated convergence rates $p_i$ must be reported as dimensionless floats. No angles are involved in this problem.",
            "solution": "We begin from the neutron balance in a homogeneous, one-group medium under steady-state conditions and Fick's law. The standard diffusion approximation yields the $k$-eigenvalue model\n$$\n- \\nabla \\cdot \\left( D \\nabla \\phi(x) \\right) + \\Sigma_a \\,\\phi(x) = \\frac{1}{k}\\,\\nu \\Sigma_f \\,\\phi(x), \\quad x \\in (0,L),\n$$\nwith vacuum boundary conditions, taken here as Dirichlet conditions\n$$\n\\phi(0) = 0, \\quad \\phi(L) = 0.\n$$\nAll material coefficients are constant. The unknowns are the neutron flux $\\phi(x)$ and the multiplication factor $k$. The physical interpretations are as follows: $D$ captures the transport by diffusion (with units $\\mathrm{cm}$), $\\Sigma_a$ represents absorption ($\\mathrm{cm}^{-1}$), $\\nu \\Sigma_f$ is the production of neutrons due to fission ($\\mathrm{cm}^{-1}$), and $k$ is the dimensionless eigenvalue indicating the ratio of production to losses.\n\nAnalytical reference solution. In one dimension with homogeneous coefficients and Dirichlet boundary conditions, we seek separated solutions. The operator $- \\nabla \\cdot \\left( D \\nabla \\cdot \\right)$ reduces to $-D \\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}$ in one dimension. Suppose\n$$\n\\phi''(x) + \\lambda^2 \\phi(x) = 0,\n$$\nwhich is the standard form for a Helmholtz-type eigenvalue problem consistent with Dirichlet boundary conditions. The boundary conditions enforce\n$$\n\\phi(0)=0, \\quad \\phi(L)=0 \\implies \\phi(x) \\propto \\sin\\left(\\frac{n\\pi x}{L}\\right), \\quad \\lambda^2 = \\left(\\frac{n\\pi}{L}\\right)^2, \\quad n \\in \\mathbb{N}.\n$$\nSubstituting into the diffusion balance equation yields, for such a mode,\n$$\n- D \\left(-\\lambda^2 \\phi(x)\\right) + \\Sigma_a \\phi(x) = \\frac{1}{k} \\nu \\Sigma_f \\phi(x) \\implies D \\lambda^2 + \\Sigma_a = \\frac{1}{k}\\nu \\Sigma_f,\n$$\nhence\n$$\nk = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D \\lambda^2}.\n$$\nThe fundamental mode is $n=1$, so the analytical reference multiplication factor is\n$$\nk_{\\text{exact}} = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D \\left(\\frac{\\pi}{L}\\right)^2}.\n$$\n\nFinite difference discretization. We construct a uniform mesh with $N$ nodes including the boundaries at $x=0$ and $x=L$. The mesh spacing is $h = L/(N-1)$. Let us denote the interior nodes by indices $i=1,2,\\dots,M$ where $M=N-2$; these correspond to locations $x_i = i h$. The Dirichlet boundary conditions enforce $\\phi_0 = 0$ and $\\phi_{N-1} = 0$. The centered finite difference approximation to the second derivative at interior node $i$ is\n$$\n\\phi''(x_i) \\approx \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2}.\n$$\nApplying the discrete balance,\n$$\n- D \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2} + \\Sigma_a \\phi_i = \\frac{1}{k}\\,\\nu \\Sigma_f \\,\\phi_i,\n$$\nand assembling for all interior nodes yields a symmetric positive definite (SPD) tridiagonal matrix $\\mathbf{A} \\in \\mathbb{R}^{M \\times M}$,\n$$\n\\mathbf{A} = \\frac{D}{h^2}\\,\\mathrm{tridiag}(-1,2,-1) + \\Sigma_a \\mathbf{I},\n$$\nsuch that\n$$\n\\mathbf{A}\\,\\boldsymbol{\\phi} = \\frac{1}{k}\\,\\nu \\Sigma_f \\,\\boldsymbol{\\phi},\n$$\nwith $\\boldsymbol{\\phi}$ the vector of interior flux unknowns and $\\mathbf{I}$ the identity matrix. This is a generalized eigenvalue problem with scalar right-hand side operator $\\nu \\Sigma_f \\mathbf{I}$. Equivalently, it is an ordinary eigenvalue problem for $\\mathbf{A}$:\n$$\n\\mathbf{A}\\,\\boldsymbol{\\phi} = \\mu \\,\\boldsymbol{\\phi}, \\quad \\mu = \\frac{1}{k}\\,\\nu \\Sigma_f \\implies k_h = \\frac{\\nu \\Sigma_f}{\\mu_{\\min}},\n$$\nwhere $\\mu_{\\min}$ is the smallest eigenvalue of $\\mathbf{A}$, corresponding to the discrete fundamental mode consistent with Dirichlet boundary conditions.\n\nConvergence analysis. For the centered finite difference scheme on a uniform grid, the truncation error of the second derivative is $\\mathcal{O}(h^2)$, and the discrete operator $\\mathbf{A}$ converges in operator norm to the continuous operator. For the fundamental eigenpair (eigenvalue and eigenvector), standard perturbation and consistency arguments establish that the eigenvalue error behaves as\n$$\n\\left| k_h - k_{\\text{exact}} \\right| = \\mathcal{O}(h^2),\n$$\nfor sufficiently refined grids. We estimate the convergence rate empirically by computing\n$$\ne_h = \\left| k_h - k_{\\text{exact}} \\right|,\n$$\nand, for successive pairs $(h_1,h_2)$,\n$$\np = \\frac{\\log\\left(e_{h_1}/e_{h_2}\\right)}{\\log\\left(h_1/h_2\\right)}.\n$$\nA value of $p$ close to $2$ confirms second-order convergence.\n\nAlgorithmic steps:\n1. Set $L = 100\\,\\mathrm{cm}$, $D = 1.0\\,\\mathrm{cm}$, $\\Sigma_a = 0.01\\,\\mathrm{cm}^{-1}$, $\\nu \\Sigma_f = 0.011\\,\\mathrm{cm}^{-1}$.\n2. Compute the analytical reference\n$$\nk_{\\text{exact}} = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D \\left(\\frac{\\pi}{L}\\right)^2}.\n$$\n3. For each $N \\in \\{3,11,21,41,81\\}$, compute $h = L/(N-1)$, assemble $\\mathbf{A}$ as a tridiagonal SPD matrix with diagonal entries $2D/h^2 + \\Sigma_a$ and off-diagonal entries $-D/h^2$, compute $\\mu_{\\min}$ as the smallest eigenvalue of $\\mathbf{A}$, and set $k_h = \\nu \\Sigma_f/\\mu_{\\min}$.\n4. Compute $e_h = \\left| k_h - k_{\\text{exact}} \\right|$ for each $N$.\n5. For successive pairs, compute $p$ using the formula above with the corresponding $(h_i,h_{i+1})$ and $(e_{h_i}, e_{h_{i+1}})$.\n6. Output a single line formatted as\n$$\n\\left[\\left[k_{h}(N_1),k_{h}(N_2),k_{h}(N_3),k_{h}(N_4),k_{h}(N_5)\\right],\\left[e_{h}(N_1),e_{h}(N_2),e_{h}(N_3),e_{h}(N_4),e_{h}(N_5)\\right],\\left[p_1,p_2,p_3,p_4\\right]\\right].\n$$\n\nThis procedure is numerically robust because $\\mathbf{A}$ is SPD and well-conditioned for the given ranges of $N$, and it isolates the fundamental physics of the diffusion $k$-eigenvalue problem in a homogeneous slab with vacuum boundaries. The expected estimated rates $p$ should approach $2$ as $N$ increases (i.e., as $h$ decreases), validating the second-order convergence of the eigenvalue error.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef assemble_diffusion_matrix(M, D, Sigma_a, h):\n    \"\"\"\n    Assemble the SPD tridiagonal matrix A for the 1D diffusion operator with Dirichlet BCs.\n    A = (D/h^2) * tridiag(-1, 2, -1) + Sigma_a * I\n    where M is the number of interior points (N-2).\n    \"\"\"\n    # Diagonal and off-diagonal values\n    main_diag = np.full(M, 2.0 * D / (h**2) + Sigma_a)\n    off_diag = np.full(M - 1, -D / (h**2))\n    # Build full matrix using banded structure\n    A = np.diag(main_diag)\n    if M  1:\n        A += np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n    return A\n\ndef compute_k_approx(N, L, D, Sigma_a, nuSigmaF):\n    \"\"\"\n    Compute the approximate fundamental multiplication factor k_h for a given N.\n    \"\"\"\n    # Mesh spacing and number of interior points\n    h = L / (N - 1)\n    M = N - 2\n    if M = 0:\n        # Degenerate mesh; return NaN (should not occur for N=3 in our test suite)\n        return np.nan, h\n    # Assemble SPD matrix A\n    A = assemble_diffusion_matrix(M, D, Sigma_a, h)\n    # Compute the smallest eigenvalue of A (A is symmetric positive definite)\n    # Using numpy.linalg.eigvalsh which is for symmetric/hermitian matrices\n    eigvals = np.linalg.eigvalsh(A)\n    mu_min = eigvals[0]\n    # Fundamental k approximation: k_h = nuSigmaF / mu_min\n    k_h = nuSigmaF / mu_min\n    return k_h, h\n\ndef solve():\n    # Define physical and numerical parameters (units in cm and 1/cm; k is dimensionless)\n    L = 100.0      # cm\n    D = 1.0        # cm\n    Sigma_a = 0.01 # 1/cm\n    nuSigmaF = 0.011 # 1/cm\n\n    # Analytical reference for fundamental mode: k_exact = nuSigmaF / (Sigma_a + D*(pi/L)^2)\n    k_exact = nuSigmaF / (Sigma_a + D * (np.pi / L)**2)\n\n    # Test suite: grid sizes\n    N_values = [3, 11, 21, 41, 81]\n\n    k_list = []\n    e_list = []\n    h_list = []\n\n    # Compute k_h and errors for each grid\n    for N in N_values:\n        k_h, h = compute_k_approx(N, L, D, Sigma_a, nuSigmaF)\n        k_list.append(k_h)\n        h_list.append(h)\n        e_list.append(abs(k_h - k_exact))\n\n    # Estimate convergence rates between successive refinements\n    p_list = []\n    for i in range(len(N_values) - 1):\n        e1, e2 = e_list[i], e_list[i+1]\n        h1, h2 = h_list[i], h_list[i+1]\n        # Guard against division by zero or non-positive errors\n        if e1  0 and e2  0 and h1 != h2:\n            p = np.log(e1 / e2) / np.log(h1 / h2)\n        else:\n            p = float('nan')\n        p_list.append(p)\n\n    # Format the output as a single line: [[k_list],[e_list],[p_list]] with no spaces\n    def format_list(lst):\n        # Use repr-like formatting for floats to maintain precision without spaces\n        return \"[\" + \",\".join(map(lambda x: (\"{:.12g}\".format(x)), lst)) + \"]\"\n\n    output = \"[\" + \",\".join([format_list(k_list), format_list(e_list), format_list(p_list)]) + \"]\"\n    print(output)\n\nsolve()\n```"
        }
    ]
}