{
    "hands_on_practices": [
        {
            "introduction": "本次实践聚焦于描述中子在介质中迁移的核心参数。通过推导和计算扩散系数、衰减长度和迁移长度，您将对中子散射、慢化和吸收的物理过程获得具体的理解。这些概念构成了分析任何反应堆系统的基本语汇。",
            "id": "4222193",
            "problem": "考虑一个无限、均匀、非增殖介质，使用双能群模型：一个快中子群和一个热中子群。中子在快中子群中产生，并最终在热中子群中被吸收。假设处于稳态，没有外部边界，除了快中子群中中子的初始产生外，没有其他内部源。热中子群中的散射是各向同性的，而快中子群中的散射是各向异性的，具有给定的平均散射余弦。介质参数如下：\n\n- 快中子群宏观吸收截面 $\\Sigma_{a,f} = 0.005 \\ \\text{cm}^{-1}$。\n- 快中子群宏观散射截面 $\\Sigma_{s,f} = 0.200 \\ \\text{cm}^{-1}$。\n- 快中子群散射中将中子移出快群进入热群的部分由宏观转移截面 $\\Sigma_{s,f \\to t} = 0.150 \\ \\text{cm}^{-1}$ 表示。\n- 快中子群中的平均散射余弦 $\\bar{\\mu}_{f} = 0.80$。\n- 热中子群宏观吸收截面 $\\Sigma_{a,t} = 0.020 \\ \\text{cm}^{-1}$。\n- 热中子群宏观散射截面 $\\Sigma_{s,t} = 0.300 \\ \\text{cm}^{-1}$。\n\n从稳态中子平衡和基于 Fick 定律以及一阶球谐函数 (P1) 近似的扩散近似出发，完成以下任务：\n\n1. 推导每个群 $g \\in \\{f, t\\}$ 中的扩散系数 $D_{g}$，用考虑了散射各向异性的输运截面 $\\Sigma_{\\text{tr},g}$ 表示。使用基于散射第一角度矩的输运截面定义。\n2. 使用带有适当移出项的扩散方程，论证并求出快中子群的特征衰减长度 $L_{f}$ 和热中子群的特征衰减长度 $L_{t}$。在快中子群中，移出包括吸收和向热中子群的降能散射。在热中子群中，移出即为吸收。\n3. 基于第一性原理，根据连续迁移阶段（快群迁移直到移出，然后热群迁移直到吸收）的线性和独立性，推导迁移长度 $M$（定义为产生点到吸收点之间距离的均方根）的表达式，用 $L_{f}$ 和 $L_{t}$ 表示。\n\n最后，计算上述介质的迁移长度 $M$ 的数值。最终答案以厘米为单位，并四舍五入到四位有效数字。",
            "solution": "该问题具有科学依据，提法明确且客观。解答所需的所有参数均已提供，并且在双群中子扩散理论的框架内是物理上一致的。问题要求进行该领域的标准推导和计算。因此，该问题是有效的，我们着手进行解答。\n\n解答按要求分为三部分：扩散系数的推导，特征衰减长度的论证，以及迁移长度的推导，最后是数值计算。\n\n首先，我们推导每个群 $g \\in \\{f, t\\}$ 的扩散系数 $D_g$ 的表达式。扩散近似源于角中子通量的一阶球谐函数 (P1) 展开。它导出了 Fick 扩散定律，该定律将中子流密度矢量 $\\vec{J}_g$ 与标量中子通量 $\\phi_g$ 的梯度联系起来：\n$$\n\\vec{J}_g(\\vec{r}) = -D_g \\nabla \\phi_g(\\vec{r})\n$$\n扩散系数 $D_g$ 定义为：\n$$\nD_g = \\frac{1}{3\\Sigma_{\\text{tr},g}}\n$$\n其中 $\\Sigma_{\\text{tr},g}$ 是群 $g$ 的宏观输运截面。输运截面考虑了散射的各向异性。对于非各向同性的散射，前向散射在改变中子飞行方向方面的效果不如各向同性散射。输运截面是一个修正项，它有效地增加了平均自由程。其定义为：\n$$\n\\Sigma_{\\text{tr},g} = \\Sigma_{t,g} - \\Sigma_{s1,g}\n$$\n这里，$\\Sigma_{t,g}$ 是总宏观截面，$\\Sigma_{s1,g}$ 是散射截面的第一勒让德矩。总截面是吸收截面和散射截面之和，$\\Sigma_{t,g} = \\Sigma_{a,g} + \\Sigma_{s,g}$。项 $\\Sigma_{s1,g}$ 由 $\\bar{\\mu}_g \\Sigma_{s,g}$ 给出，其中 $\\bar{\\mu}_g$ 是群 $g$ 在实验室坐标系中散射角的平均余弦。将这些代入 $\\Sigma_{\\text{tr},g}$ 的定义中：\n$$\n\\Sigma_{\\text{tr},g} = (\\Sigma_{a,g} + \\Sigma_{s,g}) - \\bar{\\mu}_g \\Sigma_{s,g} = \\Sigma_{a,g} + (1 - \\bar{\\mu}_g) \\Sigma_{s,g}\n$$\n对于各向同性散射，$\\bar{\\mu}_g = 0$，输运截面简化为总截面，$\\Sigma_{\\text{tr},g} = \\Sigma_{a,g} + \\Sigma_{s,g} = \\Sigma_{t,g}$。\n\n其次，我们论证并求出特征衰减长度 $L_f$ 和 $L_t$。在没有外部源但有来自其他群的源项 $S_g(\\vec{r})$ 的介质中，群 $g$ 的稳态扩散方程为：\n$$\nD_g \\nabla^2 \\phi_g(\\vec{r}) - \\Sigma_{R,g} \\phi_g(\\vec{r}) + S_g(\\vec{r}) = 0\n$$\n其中 $\\Sigma_{R,g}$ 是群 $g$ 的宏观移出截面。特征衰减长度，或称扩散长度 $L_g$，表示中子从进入群 $g$ 的点到它被从该群中移出所行进的典型距离。为了确定这个长度，我们考虑一个在无限介质中位于原点的群 $g$ 的单能点源，$S_g(\\vec{r}) = S_0 \\delta(\\vec{r})$。方程变为（对于 $r > 0$）：\n$$\nD_g \\nabla^2 \\phi_g(\\vec{r}) - \\Sigma_{R,g} \\phi_g(\\vec{r}) = 0\n$$\n两边除以 $D_g$，我们得到亥姆霍兹方程：\n$$\n\\nabla^2 \\phi_g(\\vec{r}) - \\frac{\\Sigma_{R,g}}{D_g} \\phi_g(\\vec{r}) = 0\n$$\n我们将群 $g$ 的扩散面积（或扩散长度的平方）定义为 $L_g^2 = \\frac{D_g}{\\Sigma_{R,g}}$。方程变为 $\\nabla^2 \\phi_g(\\vec{r}) - \\frac{1}{L_g^2} \\phi_g(\\vec{r}) = 0$。在球对称条件下，当 $r \\to \\infty$ 时趋于零的该方程的解为 $\\phi_g(r) \\propto \\frac{\\exp(-r/L_g)}{r}$。量 $L_g$ 是特征 e-折叠距离，因此它是特征衰减长度。\n\n对于快中子群 ($g=f$)，中子通过吸收 ($\\Sigma_{a,f}$) 和向热中子群的降能散射 ($\\Sigma_{s,f \\to t}$) 被移出。因此，快中子移出截面为 $\\Sigma_{R,f} = \\Sigma_{a,f} + \\Sigma_{s,f \\to t}$。快中子衰减长度，在此情境下通常称为慢化长度，是：\n$$\nL_f = \\sqrt{\\frac{D_f}{\\Sigma_{R,f}}} = \\sqrt{\\frac{D_f}{\\Sigma_{a,f} + \\Sigma_{s,f \\to t}}}\n$$\n对于热中子群 ($g=t$)，在这个双群模型中，中子仅通过吸收被移出。因此，热中子移出截面为 $\\Sigma_{R,t} = \\Sigma_{a,t}$。热中子衰减长度，或称热中子扩散长度，是：\n$$\nL_t = \\sqrt{\\frac{D_t}{\\Sigma_{R,t}}} = \\sqrt{\\frac{D_t}{\\Sigma_{a,t}}}\n$$\n\n第三，我们推导迁移长度 $M$ 的表达式。迁移长度与中子从其诞生（作为快中子）到其死亡（作为热中子被吸收）所行进距离的均方根有关。设 $\\vec{r}_f$ 为中子在其快群寿命期间的位移矢量，$\\vec{r}_t$ 为其热群寿命期间的位移矢量。总位移为 $\\vec{r} = \\vec{r}_f + \\vec{r}_t$。位移的平方是 $r^2 = \\vec{r} \\cdot \\vec{r} = (\\vec{r}_f + \\vec{r}_t) \\cdot (\\vec{r}_f + \\vec{r}_t) = r_f^2 + r_t^2 + 2\\vec{r}_f \\cdot \\vec{r}_t$。\n均方位移是 $\\langle r^2 \\rangle = \\langle r_f^2 \\rangle + \\langle r_t^2 \\rangle + 2\\langle\\vec{r}_f \\cdot \\vec{r}_t\\rangle$。控制热中子迁移的过程独立于之前的快中子迁移历史。作为热中子的第一次飞行的方向与作为快中子的最后一次飞行的方向不相关。因此，交叉项的平均值为零：$\\langle\\vec{r}_f \\cdot \\vec{r}_t\\rangle = 0$。这得到：\n$$\n\\langle r^2 \\rangle = \\langle r_f^2 \\rangle + \\langle r_t^2 \\rangle\n$$\n根据定义，慢化面积 ($L_f^2$) 和热扩散面积 ($L_t^2$) 与每个阶段的均方行进距离的关系为 $L_f^2 = \\frac{1}{6}\\langle r_f^2 \\rangle$ 和 $L_t^2 = \\frac{1}{6}\\langle r_t^2 \\rangle$。总迁移面积 $M^2$ 定义为总均方位移的六分之一：$M^2 = \\frac{1}{6}\\langle r^2 \\rangle$。\n将这些定义代入 $\\langle r^2 \\rangle$ 的方程并除以 $6$ 得到：\n$$\nM^2 = L_f^2 + L_t^2\n$$\n迁移长度 $M$ 是迁移面积的平方根：\n$$\nM = \\sqrt{L_f^2 + L_t^2}\n$$\n\n最后，我们计算迁移长度 $M$ 的数值。\n\n1.  计算每个群的输运截面和扩散系数。\n    对于快中子群 ($g=f$)：\n    $\\Sigma_{s,f} = 0.200 \\ \\text{cm}^{-1}$，$\\Sigma_{a,f} = 0.005 \\ \\text{cm}^{-1}$，$\\bar{\\mu}_f = 0.80$。\n    $$\n    \\Sigma_{\\text{tr},f} = \\Sigma_{a,f} + (1 - \\bar{\\mu}_f) \\Sigma_{s,f} = 0.005 + (1 - 0.80)(0.200) = 0.005 + 0.040 = 0.045 \\ \\text{cm}^{-1}\n    $$\n    $$\n    D_f = \\frac{1}{3\\Sigma_{\\text{tr},f}} = \\frac{1}{3(0.045)} = \\frac{1}{0.135} \\ \\text{cm}\n    $$\n    对于热中子群 ($g=t$)：\n    $\\Sigma_{s,t} = 0.300 \\ \\text{cm}^{-1}$，$\\Sigma_{a,t} = 0.020 \\ \\text{cm}^{-1}$。散射是各向同性的，所以 $\\bar{\\mu}_t = 0$。\n    $$\n    \\Sigma_{\\text{tr},t} = \\Sigma_{a,t} + (1 - \\bar{\\mu}_t) \\Sigma_{s,t} = 0.020 + (1 - 0)(0.300) = 0.320 \\ \\text{cm}^{-1}\n    $$\n    $$\n    D_t = \\frac{1}{3\\Sigma_{\\text{tr},t}} = \\frac{1}{3(0.320)} = \\frac{1}{0.960} \\ \\text{cm}\n    $$\n\n2.  计算慢化面积 ($L_f^2$) 和热扩散面积 ($L_t^2$)。\n    对于快中子群：\n    $\\Sigma_{R,f} = \\Sigma_{a,f} + \\Sigma_{s,f \\to t} = 0.005 + 0.150 = 0.155 \\ \\text{cm}^{-1}$。\n    $$\n    L_f^2 = \\frac{D_f}{\\Sigma_{R,f}} = \\frac{1/0.135}{0.155} = \\frac{1}{0.135 \\times 0.155} = \\frac{1}{0.020925} \\ \\text{cm}^2 \\approx 47.789725 \\ \\text{cm}^2\n    $$\n    对于热中子群：\n    $$\n    L_t^2 = \\frac{D_t}{\\Sigma_{a,t}} = \\frac{1/0.960}{0.020} = \\frac{1}{0.960 \\times 0.020} = \\frac{1}{0.0192} \\ \\text{cm}^2 \\approx 52.083333 \\ \\text{cm}^2\n    $$\n\n3.  计算迁移面积 ($M^2$) 和迁移长度 ($M$)。\n    $$\n    M^2 = L_f^2 + L_t^2 = \\frac{1}{0.020925} + \\frac{1}{0.0192} \\approx 47.789725 + 52.083333 = 99.873058 \\ \\text{cm}^2\n    $$\n    $$\n    M = \\sqrt{M^2} = \\sqrt{99.873058} \\approx 9.993651 \\ \\text{cm}\n    $$\n将结果四舍五入到四位有效数字，得到 $M \\approx 9.994 \\ \\text{cm}$。",
            "answer": "$$\n\\boxed{9.994}\n$$"
        },
        {
            "introduction": "真实的反应堆是有限的，并且通常使用称为反射层的非裂变材料来改善中子经济性。本练习通过对一个带反射层的板式反应堆进行建模，弥合了无限介质理论与实际反应堆分析之间的差距。您将应用界面边界条件来推导“反射层节省量”这一关键概念，它是衡量反射层如何有效减小反应堆堆芯所需尺寸的指标。",
            "id": "4222186",
            "problem": "建立一个单能群下的一维对称反射层平板模型。裂变芯区占据 $|x|  a$ 的区域，两侧由半无限厚的非增殖反射层所包围，该反射层占据 $|x|  a$ 的区域。在临界条件下，我们寻求基波（偶对称）通量解。堆芯和反射层的扩散参数如下：\n- 堆芯扩散系数：$D_c = 1.2\\,\\mathrm{cm}$\n- 堆芯宏观吸收截面：$\\Sigma_{a,c} = 8.0 \\times 10^{-3}\\,\\mathrm{cm}^{-1}$\n- 堆芯宏观产生截面：$\\nu \\Sigma_{f,c} = 2.0 \\times 10^{-2}\\,\\mathrm{cm}^{-1}$\n- 反射层扩散系数：$D_r = 1.6\\,\\mathrm{cm}$\n- 反射层宏观吸收截面：$\\Sigma_{a,r} = 2.5 \\times 10^{-3}\\,\\mathrm{cm}^{-1}$\n\n任务：\n1. 分别在堆芯和反射层区域求解稳态中子扩散方程。\n2. 在堆芯-反射层交界面（$x=a$）施加通量和流的连续性条件。\n3. 推导出一个等效的、只涉及堆芯通量 $\\phi_c(x)$ 及其在 $x=a$ 处的导数的边界条件，该条件能够体现反射层的效应。\n4. 推导出反射层节省厚度 $s = \\tilde{a} - a$ 的表达式，其中 $\\tilde{a}$ 是等效裸堆的外推半厚度。\n5. 计算反射层节省厚度 $s$ 的数值（以 $\\mathrm{cm}$ 为单位），并将结果四舍五入到四位有效数字。",
            "solution": "用户提供的问题是单能群中子扩散理论中的一个标准练习题，被认为是有效的。我们将进行完整的推导和解答。\n\n在无源区中，稳态单能群中子扩散方程由下式给出：\n$$\n-D \\frac{d^2 \\phi(x)}{dx^2} + \\Sigma_a \\phi(x) = \\frac{1}{k} \\nu \\Sigma_f \\phi(x)\n$$\n其中 $D$ 是扩散系数，$\\phi(x)$ 是中子标量通量，$\\Sigma_a$ 是宏观吸收截面，$\\nu \\Sigma_f$ 是宏观产生截面，$k$ 是增殖因子。在临界时，$k=1$。该方程可以重新整理为：\n$$\n\\frac{d^2 \\phi(x)}{dx^2} + \\left( \\frac{\\nu \\Sigma_f - \\Sigma_a}{D} \\right) \\phi(x) = 0\n$$\n\n**1. 堆芯区域的解 ($|x|  a$)**\n\n在裂变芯区中，方程为：\n$$\n\\frac{d^2 \\phi_c(x)}{dx^2} + \\left( \\frac{\\nu \\Sigma_{f,c} - \\Sigma_{a,c}}{D_c} \\right) \\phi_c(x) = 0\n$$\n我们将堆芯的材料曲率 $B_c^2$ 定义为：\n$$\nB_c^2 = \\frac{\\nu \\Sigma_{f,c} - \\Sigma_{a,c}}{D_c}\n$$\n题目数据意味着 $\\nu \\Sigma_{f,c} > \\Sigma_{a,c}$，因此 $B_c^2 > 0$。扩散方程简化为：\n$$\n\\frac{d^2 \\phi_c(x)}{dx^2} + B_c^2 \\phi_c(x) = 0\n$$\n其通解为 $\\phi_c(x) = A_1 \\cos(B_c x) + A_2 \\sin(B_c x)$。题目指定了对称平板和基波模，它必须是 $x$ 的偶函数，即 $\\phi_c(x) = \\phi_c(-x)$。这要求奇函数正弦项的系数为零（$A_2=0$）。因此，堆芯通量为：\n$$\n\\phi_c(x) = A \\cos(B_c x)\n$$\n其中 $A$ 是一个任意振幅。\n\n**2. 反射层区域的解 ($|x| > a$)**\n\n在非增殖反射层中，$\\nu \\Sigma_{f,r} = 0$。扩散方程变为：\n$$\n\\frac{d^2 \\phi_r(x)}{dx^2} - \\frac{\\Sigma_{a,r}}{D_r} \\phi_r(x) = 0\n$$\n我们将反射层扩散长度平方的倒数 $\\kappa_r^2$ 定义为：\n$$\n\\kappa_r^2 = \\frac{\\Sigma_{a,r}}{D_r}\n$$\n其中 $\\kappa_r = 1/L_r$ 并且 $L_r = \\sqrt{D_r/\\Sigma_{a,r}}$ 是扩散长度。反射层中的方程为：\n$$\n\\frac{d^2 \\phi_r(x)}{dx^2} - \\kappa_r^2 \\phi_r(x) = 0\n$$\n考虑 $x > a$ 的区域，通解为 $\\phi_r(x) = F_1 e^{-\\kappa_r x} + F_2 e^{\\kappa_r x}$。边界条件规定当 $x \\to \\infty$ 时通量必须保持有限。这要求增长的指数项的系数为零（$F_2=0$）。因此，对于 $x > a$ 的反射层通量为：\n$$\n\\phi_r(x) = F e^{-\\kappa_r x}\n$$\n\n**3. 交界面条件与反射层边界条件**\n\n在堆芯-反射层交界面（$x=a$）处，我们施加标量通量和中子流的连续性条件。\n中子流由菲克定律给出：$J(x) = -D \\frac{d\\phi(x)}{dx}$。\n\n条件1：通量连续，$\\phi_c(a) = \\phi_r(a)$。\n$$\nA \\cos(B_c a) = F e^{-\\kappa_r a} \\quad (1)\n$$\n\n条件2：中子流连续，$J_c(a) = J_r(a)$。\n$$\n-D_c \\frac{d\\phi_c}{dx}\\bigg|_{x=a} = -D_r \\frac{d\\phi_r}{dx}\\bigg|_{x=a}\n$$\n导数分别为 $\\frac{d\\phi_c}{dx} = -A B_c \\sin(B_c x)$ 和 $\\frac{d\\phi_r}{dx} = -F \\kappa_r e^{-\\kappa_r x}$。将它们在 $x=a$ 处代入：\n$$\n-D_c (-A B_c \\sin(B_c a)) = -D_r (-F \\kappa_r e^{-\\kappa_r a})\n$$\n$$\nD_c A B_c \\sin(B_c a) = D_r F \\kappa_r e^{-\\kappa_r a} \\quad (2)\n$$\n\n为了推导能够体现反射层效应的堆芯区域边界条件，我们将方程 $(2)$ 除以方程 $(1)$。未知振幅 $A$ 和 $F$ 会被消去：\n$$\n\\frac{D_c A B_c \\sin(B_c a)}{A \\cos(B_c a)} = \\frac{D_r F \\kappa_r e^{-\\kappa_r a}}{F e^{-\\kappa_r a}}\n$$\n$$\nD_c B_c \\tan(B_c a) = D_r \\kappa_r\n$$\n此方程是带反射层平板的临界条件。我们可以将其表示为在 $x=a$ 处对堆芯通量 $\\phi_c(x)$ 的边界条件。在交界面处堆芯通量的对数导数为：\n$$\n\\frac{1}{\\phi_c(a)} \\frac{d\\phi_c}{dx}\\bigg|_{x=a} = \\frac{-A B_c \\sin(B_c a)}{A \\cos(B_c a)} = -B_c \\tan(B_c a)\n$$\n代入临界条件的结果 $B_c \\tan(B_c a) = \\frac{D_r \\kappa_r}{D_c}$：\n$$\n\\frac{1}{\\phi_c(a)} \\frac{d\\phi_c}{dx}\\bigg|_{x=a} = -\\frac{D_r \\kappa_r}{D_c}\n$$\n这就是所求的边界条件。它可以写成一个罗宾型条件：\n$$\nD_c \\frac{d\\phi_c}{dx}\\bigg|_{x=a} + D_r \\kappa_r \\phi_c(a) = 0\n$$\n\n**4. 反射层节省厚度 $s$ 的推导**\n\n反射层节省厚度 $s$ 定义为 $s = \\tilde{a} - a$，其中 $\\tilde{a}$ 是外推半厚度。这是指如果堆芯被真空包围，堆芯的余弦形状通量将变为零的点。真空边界条件是 $\\phi_c(\\tilde{a})=0$。\n对于堆芯通量 $\\phi_c(x) = A \\cos(B_c x)$，这意味着 $\\cos(B_c \\tilde{a}) = 0$。对于基波（第一个非负）零点，这给出：\n$$\nB_c \\tilde{a} = \\frac{\\pi}{2} \\implies \\tilde{a} = \\frac{\\pi}{2 B_c}\n$$\n根据定义 $s = \\tilde{a} - a$，我们有 $a = \\tilde{a} - s = \\frac{\\pi}{2B_c} - s$。因此，$B_c a = \\frac{\\pi}{2} - B_c s$。\n\n我们将这个关于 $B_c a$ 的表达式代入先前推导的临界条件中：\n$$\nD_c B_c \\tan\\left(\\frac{\\pi}{2} - B_c s\\right) = D_r \\kappa_r\n$$\n使用三角恒等式 $\\tan(\\frac{\\pi}{2} - \\theta) = \\cot(\\theta) = \\frac{1}{\\tan(\\theta)}$，我们得到：\n$$\nD_c B_c \\frac{1}{\\tan(B_c s)} = D_r \\kappa_r\n$$\n重新整理以求解 $\\tan(B_c s)$：\n$$\n\\tan(B_c s) = \\frac{D_c B_c}{D_r \\kappa_r}\n$$\n这给出了反射层节省厚度 $s$ 的一个显式表达式：\n$$\ns = \\frac{1}{B_c} \\arctan\\left(\\frac{D_c B_c}{D_r \\kappa_r}\\right)\n$$\n其中 $B_c = \\sqrt{(\\nu \\Sigma_{f,c} - \\Sigma_{a,c})/D_c}$ 和 $\\kappa_r = \\sqrt{\\Sigma_{a,r}/D_r}$。\n\n**5. $s$ 的数值计算**\n\n题目提供了以下数据：\n$D_c = 1.2\\,\\mathrm{cm}$\n$\\Sigma_{a,c} = 8.0 \\times 10^{-3}\\,\\mathrm{cm}^{-1}$\n$\\nu \\Sigma_{f,c} = 2.0 \\times 10^{-2}\\,\\mathrm{cm}^{-1}$\n$D_r = 1.6\\,\\mathrm{cm}$\n$\\Sigma_{a,r} = 2.5 \\times 10^{-3}\\,\\mathrm{cm}^{-1}$\n\n首先，我们计算堆芯的材料曲率 $B_c$：\n$$\nB_c^2 = \\frac{\\nu \\Sigma_{f,c} - \\Sigma_{a,c}}{D_c} = \\frac{(2.0 \\times 10^{-2} - 8.0 \\times 10^{-3}) \\, \\mathrm{cm}^{-1}}{1.2 \\, \\mathrm{cm}} = \\frac{1.2 \\times 10^{-2} \\, \\mathrm{cm}^{-1}}{1.2 \\, \\mathrm{cm}} = 1.0 \\times 10^{-2} \\, \\mathrm{cm}^{-2}\n$$\n$$\nB_c = \\sqrt{1.0 \\times 10^{-2} \\, \\mathrm{cm}^{-2}} = 0.1 \\, \\mathrm{cm}^{-1}\n$$\n\n接下来，我们计算反射层的逆扩散长度 $\\kappa_r$：\n$$\n\\kappa_r^2 = \\frac{\\Sigma_{a,r}}{D_r} = \\frac{2.5 \\times 10^{-3} \\, \\mathrm{cm}^{-1}}{1.6 \\, \\mathrm{cm}} = 1.5625 \\times 10^{-3} \\, \\mathrm{cm}^{-2}\n$$\n$$\n\\kappa_r = \\sqrt{1.5625 \\times 10^{-3} \\, \\mathrm{cm}^{-2}} \\approx 0.03952847 \\, \\mathrm{cm}^{-1}\n$$\n\n现在，我们计算反正切函数的自变量：\n$$\n\\frac{D_c B_c}{D_r \\kappa_r} = \\frac{(1.2 \\, \\mathrm{cm})(0.1 \\, \\mathrm{cm}^{-1})}{(1.6 \\, \\mathrm{cm})(0.03952847 \\, \\mathrm{cm}^{-1})} = \\frac{0.12}{0.06324555} \\approx 1.8973666\n$$\n\n最后，我们计算反射层节省厚度 $s$。注意，反正切函数的输出值必须是弧度。\n$$\ns = \\frac{1}{0.1 \\, \\mathrm{cm}^{-1}} \\arctan(1.8973666) \\approx (10 \\, \\mathrm{cm}) \\times (1.08588 \\, \\mathrm{rad})\n$$\n$$\ns \\approx 10.8588 \\, \\mathrm{cm}\n$$\n按要求将结果四舍五入到四位有效数字：\n$$\ns \\approx 10.86 \\, \\mathrm{cm}\n$$",
            "answer": "$$\\boxed{10.86}$$"
        },
        {
            "introduction": "尽管解析解功能强大，但由于复杂的几何形状和材料成分，大多数现实世界的反应堆问题都需要使用数值方法。这个动手编程练习将向您介绍节块扩散法，这是现代反应堆堆芯模拟器的基石。通过实施该方法，您将学习如何将连续的扩散方程转化为离散的线性方程组，并以计算方式求解中子通量分布。",
            "id": "4222190",
            "problem": "考虑一个一维、稳态、单能群的中子扩散方程，该方程描述的是一个具有分段常数材料属性且节点不重叠的板状区域。其控制方程是从基本输运理论和菲克定律（Fick's law）推导出的守恒形式：\n$$-D(x)\\frac{d^2\\phi(x)}{dx^2} + \\Sigma_a(x)\\,\\phi(x) = Q(x),$$\n其中 $D(x)$ 是扩散系数，$\\Sigma_a(x)$ 是宏观吸收截面，$\\phi(x)$ 是标量中子通量，$Q(x)$ 是一个固定的体积源。板的两端均为反射边界条件，这强制边界上的净流为零。在一维情况下，中子流 $J(x)$ 满足菲克定律 $J(x) = -D(x)\\,d\\phi(x)/dx$，因此反射边界条件意味着 $J(x_{\\text{left}}) = 0$ 和 $J(x_{\\text{right}}) = 0$。\n\n使用节点扩散法，对每个宽度为 $h_i$ 的节点 $i$ 上的控制方程进行积分，以获得节点平衡方程：\n$$\\Sigma_{a,i}\\,h_i\\,\\bar{\\phi}_i + \\left(J_{i+\\frac{1}{2}} - J_{i-\\frac{1}{2}}\\right) = Q_i\\,h_i,$$\n其中 $\\bar{\\phi}_i$ 是节点平均标量通量，$\\Sigma_{a,i}$、$D_i$ 和 $Q_i$ 是节点 $i$ 中的常数，$J_{i\\pm\\frac{1}{2}}$ 表示节点 $i$ 右侧 ($i+\\frac{1}{2}$) 和左侧 ($i-\\frac{1}{2}$) 界面上的中子流，符号约定为向右为正。对于反射边界，一个有 $N$ 个节点的板，设置 $J_{\\frac{1}{2}} = 0$ 和 $J_{N+\\frac{1}{2}} = 0$。\n\n采用与节点平衡方程一致的粗网格近似，通过使用两点电阻模型（粗网格有限差分法(CMFD)中的一个标准结果）来模拟界面流，该模型源于菲克定律和跨界面的流连续性。定义节点 $i$ 和节点 $i+1$ 之间界面处的半节点电阻为 $r_i = \\frac{h_i}{2\\,D_i}$ 和 $r_{i+1} = \\frac{h_{i+1}}{2\\,D_{i+1}}$，总界面电阻为\n$$R_{i+\\frac{1}{2}} = r_i + r_{i+1} = \\frac{h_i}{2\\,D_i} + \\frac{h_{i+1}}{2\\,D_{i+1}}.$$\n则界面流近似为\n$$J_{i+\\frac{1}{2}} = -\\frac{\\bar{\\phi}_{i+1} - \\bar{\\phi}_i}{R_{i+\\frac{1}{2}}}.$$\n这为未知的节点平均通量 $\\bar{\\phi}_i$ 得到了以下线性系统：\n$$\\left(\\Sigma_{a,i}\\,h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i - \\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} - \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1} = Q_i\\,h_i,$$\n其中约定 $\\frac{1}{R_{\\frac{1}{2}}} = 0$ 和 $\\frac{1}{R_{N+\\frac{1}{2}}} = 0$ 以强制施加反射边界。求解此系统以获得每个节点的 $\\bar{\\phi}_i$。\n\n您的任务是编写一个完整的程序，为一组测试用例构建并求解上述粗网格节点系统。对于每个测试用例，程序必须生成节点平均标量通量 $\\bar{\\phi}_i$ 的列表，单位为中子/平方厘米·秒 ($n/(\\text{cm}^2 \\cdot \\text{s})$)，每个值四舍五入到 $6$ 位小数。所有输入参数均以科学上合理的单位给出：$h_i$ 的单位是 $\\text{cm}$，$D_i$ 的单位是 $\\text{cm}$，$\\Sigma_{a,i}$ 的单位是 $\\text{cm}^{-1}$，$Q_i$ 的单位是 $n/(\\text{cm}^3 \\cdot \\text{s})$。\n\n为以下测试套件实现解决方案：\n- 测试用例 1 (均匀板，均匀源)：$N=3$，$h=[10,10,10]\\,\\text{cm}$，$D=[1.0,1.0,1.0]\\,\\text{cm}$，$\\Sigma_a=[0.1,0.1,0.1]\\,\\text{cm}^{-1}$，$Q=[0.5,0.5,0.5]\\,n/(\\text{cm}^3 \\cdot \\text{s})$。\n- 测试用例 2 (非均匀吸收，均匀源)：$N=3$，$h=[10,10,10]\\,\\text{cm}$，$D=[1.0,1.0,1.0]\\,\\text{cm}$，$\\Sigma_a=[0.1,1.0,0.1]\\,\\text{cm}^{-1}$，$Q=[0.5,0.5,0.5]\\,n/(\\text{cm}^3 \\cdot \\text{s})$。\n- 测试用例 3 (变化的宽度和扩散，局部源)：$N=4$，$h=[5,20,5,20]\\,\\text{cm}$，$D=[1.0,0.5,1.5,1.0]\\,\\text{cm}$，$\\Sigma_a=[0.1,0.2,0.05,0.15]\\,\\text{cm}^{-1}$，$Q=[0.0,2.0,0.0,0.0]\\,n/(\\text{cm}^3 \\cdot \\text{s})$。\n- 测试用例 4 (单节点合理性检查)：$N=1$，$h=[10]\\,\\text{cm}$，$D=[1.0]\\,\\text{cm}$，$\\Sigma_a=[0.1]\\,\\text{cm}^{-1}$，$Q=[0.5]\\,n/(\\text{cm}^3 \\cdot \\text{s})$。\n\n您的程序应生成单行输出，其中包含结果，格式为方括号括起来的逗号分隔列表，其中每个项目是对应一个测试用例的节点平均通量列表，每个值都四舍五入到 $6$ 位小数，单位为 $n/(\\text{cm}^2 \\cdot \\text{s})$。例如，输出格式必须为\n`[[\\bar{\\phi}_1^{(1)},…],[\\bar{\\phi}_1^{(2)},…],[\\bar{\\phi}_1^{(3)},…],[\\bar{\\phi}_1^{(4)},…]]` \n形式，不含任何额外文本。",
            "solution": "用户希望我使用粗网格节点法来求解一个一维、稳态、单能群的中子扩散问题。\n\n这是我的计划：\n1.  **验证问题陈述。**\n    -   提取所有给定信息。\n    -   检查科学合理性、完整性、一致性及其他有效性标准。\n2.  **如果有效，则制定解决方案策略。**\n    -   问题明确提供了待求解的线性方程组：\n        $$A\\bar{\\phi} = b$$\n        其中 $\\bar{\\phi}$ 是未知节点平均通量向量 $[\\bar{\\phi}_1, \\bar{\\phi}_2, \\ldots, \\bar{\\phi}_N]^T$。\n    -   我需要为具有 $N$ 个节点的一般情况构建矩阵 $A$ 和向量 $b$。\n    -   向量 $b$（右侧项）很简单：$b_i = Q_i h_i$。\n    -   矩阵 $A$ 是三对角矩阵。节点 $i$ 的方程是：\n        $$\\left(\\Sigma_{a,i}\\,h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i - \\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} - \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1} = Q_i\\,h_i$$\n    -   所以，矩阵元素是：\n        -   对角项 $A_{i,i} = \\Sigma_{a,i}\\,h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}$。\n        -   上对角项 $A_{i, i+1} = -\\frac{1}{R_{i+\\frac{1}{2}}}$。\n        -   下对角项 $A_{i, i-1} = -\\frac{1}{R_{i-\\frac{1}{2}}}$。\n    -   边界条件（反射）通过设置 $J_{1/2} = 0$ 和 $J_{N+1/2} = 0$ 来处理。这等效于将相应的耦合系数设置为零。问题陈述给出了约定：$\\frac{1}{R_{1/2}} = 0$ 和 $\\frac{1}{R_{N+1/2}} = 0$。\n    -   让我们检查第一个和最后一个节点的方程。\n        -   对于节点 $i=1$：\n            $$(\\Sigma_{a,1} h_1 + \\frac{1}{R_{3/2}} + \\frac{1}{R_{1/2}})\\bar{\\phi}_1 - \\frac{1}{R_{3/2}}\\bar{\\phi}_2 - \\frac{1}{R_{1/2}}\\bar{\\phi}_0 = Q_1 h_1$$\n            使用约定 $\\frac{1}{R_{1/2}}=0$，这简化为：\n            $$(\\Sigma_{a,1} h_1 + \\frac{1}{R_{3/2}})\\bar{\\phi}_1 - \\frac{1}{R_{3/2}}\\bar{\\phi}_2 = Q_1 h_1$$\n            这是正确的。\n            $A_{1,1} = \\Sigma_{a,1} h_1 + \\frac{1}{R_{3/2}}$\n            $A_{1,2} = -\\frac{1}{R_{3/2}}$\n        -   对于节点 $i=N$：\n            $$(\\Sigma_{a,N} h_N + \\frac{1}{R_{N+1/2}} + \\frac{1}{R_{N-1/2}})\\bar{\\phi}_N - \\frac{1}{R_{N+1/2}}\\bar{\\phi}_{N+1} - \\frac{1}{R_{N-1/2}}\\bar{\\phi}_{N-1} = Q_N h_N$$\n            使用约定 $\\frac{1}{R_{N+1/2}}=0$，这简化为：\n            $$(\\Sigma_{a,N} h_N + \\frac{1}{R_{N-1/2}})\\bar{\\phi}_N - \\frac{1}{R_{N-1/2}}\\bar{\\phi}_{N-1} = Q_N h_N$$\n            这也是正确的。\n            $A_{N,N} = \\Sigma_{a,N} h_N + \\frac{1}{R_{N-1/2}}$\n            $A_{N, N-1} = -\\frac{1}{R_{N-1/2}}$\n    -   界面电阻 $R_{i+1/2}$ 定义为：\n        $$R_{i+\\frac{1}{2}} = \\frac{h_i}{2\\,D_i} + \\frac{h_{i+1}}{2\\,D_{i+1}}$$\n        对于 $i = 1, \\dots, N-1$。\n3.  **用 Python 实现解决方案。**\n    -   计划是遍历每个测试用例。\n    -   在循环内部，对于给定的具有 $N$ 个节点和参数 $h, D, \\Sigma_a, Q$ 的测试用例：\n        a.  用零初始化一个 $N \\times N$ 矩阵 `A` 和一个 $N \\times 1$ 向量 `b`。\n        b.  构建右侧向量 `b`：`b[i] = Q[i] * h[i]`。\n        c.  构建矩阵 `A`。这是核心部分。我需要从 `i = 0` 迭代到 `N-1`（使用 Python 的 0-基索引）。\n            -   对于从 `0` 到 `N-1` 的 `i`：\n                -   计算损失项：`A[i, i] += Sigma_a[i] * h[i]`。\n            -   对于从 `0` 到 `N-2` 的界面 `i`（对应于界面 $1+1/2$ 到 $N-1+1/2$）：\n                -   计算 `R_interface = h[i]/(2*D[i]) + h[i+1]/(2*D[i+1])`。\n                -   计算耦合系数 `C = 1 / R_interface`。\n                -   加到对角项上：`A[i, i] += C` 和 `A[i+1, i+1] += C`。\n                -   设置非对角项：`A[i, i+1] = -C` 和 `A[i+1, i] = -C`。\n        d.  求解线性系统 `A @ phi_bar = b` 得到 `phi_bar`。`numpy.linalg.solve(A, b)` 是完成此任务的完美工具。\n        e.  将结果四舍五入到 6 位小数。\n        f.  存储生成的通量列表。\n    -   循环结束后，将收集到的结果格式化为所需的字符串格式。\n\n4.  **仔细检查测试用例。**\n\n    -   **测试用例 1：** $N=3$，均匀。\n        -   $h = [10, 10, 10]$，$D=[1.0, 1.0, 1.0]$，$\\Sigma_a=[0.1, 0.1, 0.1]$，$Q=[0.5, 0.5, 0.5]$。\n        -   $b_1 = 0.5 \\times 10 = 5$。$b_2 = 5$。$b_3 = 5$。所以 $b = [5, 5, 5]^T$。\n        -   界面电阻：\n            -   $R_{1+1/2} = R_{3/2} = \\frac{10}{2 \\times 1} + \\frac{10}{2 \\times 1} = 5 + 5 = 10$。\n            -   $R_{2+1/2} = R_{5/2} = \\frac{10}{2 \\times 1} + \\frac{10}{2 \\times 1} = 5 + 5 = 10$。\n        -   耦合系数：\n            -   $C_{3/2} = 1/10 = 0.1$。\n            -   $C_{5/2} = 1/10 = 0.1$。\n        -   方程组：\n            -   节点 1: $(\\Sigma_{a,1}h_1 + C_{3/2})\\bar{\\phi}_1 - C_{3/2}\\bar{\\phi}_2 = Q_1 h_1$\n                $(0.1 \\times 10 + 0.1)\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5 \\implies 1.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5$。\n            -   节点 2: $(\\Sigma_{a,2}h_2 + C_{3/2} + C_{5/2})\\bar{\\phi}_2 - C_{3/2}\\bar{\\phi}_1 - C_{5/2}\\bar{\\phi}_3 = Q_2 h_2$\n                $(0.1 \\times 10 + 0.1 + 0.1)\\bar{\\phi}_2 - 0.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_3 = 5 \\implies -0.1\\bar{\\phi}_1 + 1.2\\bar{\\phi}_2 - 0.1\\bar{\\phi}_3 = 5$。\n            -   节点 3: $(\\Sigma_{a,3}h_3 + C_{5/2})\\bar{\\phi}_3 - C_{5/2}\\bar{\\phi}_2 = Q_3 h_3$\n                $(0.1 \\times 10 + 0.1)\\bar{\\phi}_3 - 0.1\\bar{\\phi}_2 = 5 \\implies -0.1\\bar{\\phi}_2 + 1.1\\bar{\\phi}_3 = 5$。\n        -   矩阵 `A`：\n            $$\n            \\begin{pmatrix}\n            1.1  -0.1  0 \\\\\n            -0.1  1.2  -0.1 \\\\\n            0  -0.1  1.1\n            \\end{pmatrix}\n            $$\n        -   系统是对称的，这符合预期。\n        -   让我们求解它。根据对称性，$\\bar{\\phi}_1 = \\bar{\\phi}_3$。\n            -   $1.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5 \\implies \\bar{\\phi}_2 = 11\\bar{\\phi}_1 - 50$。\n            -   $-0.1\\bar{\\phi}_1 + 1.2\\bar{\\phi}_2 - 0.1\\bar{\\phi}_1 = 5 \\implies -0.2\\bar{\\phi}_1 + 1.2\\bar{\\phi}_2 = 5$。\n            -   代入 $\\bar{\\phi}_2$：$-0.2\\bar{\\phi}_1 + 1.2(11\\bar{\\phi}_1 - 50) = 5$。\n            -   $-0.2\\bar{\\phi}_1 + 13.2\\bar{\\phi}_1 - 60 = 5$。\n            -   $13.0\\bar{\\phi}_1 = 65 \\implies \\bar{\\phi}_1 = 5$。\n            -   那么 $\\bar{\\phi}_3 = 5$。\n            -   $\\bar{\\phi}_2 = 11(5) - 50 = 55 - 50 = 5$。\n        -   所以，用例 1 的解是 $[\\bar{\\phi}_1, \\bar{\\phi}_2, \\bar{\\phi}_3] = [5.0, 5.0, 5.0]$。这是合理的：一个具有均匀源和反射边界的均匀系统应该有平坦的通量分布。\n\n    -   **测试用例 4：** $N=1$，单节点合理性检查。\n        -   $h=[10]$，$D=[1.0]$，$\\Sigma_a=[0.1]$，$Q=[0.5]$。\n        -   系统是 $1 \\times 1$。\n        -   节点 1 的方程是：\n            $(\\Sigma_{a,1} h_1 + \\frac{1}{R_{3/2}} + \\frac{1}{R_{1/2}})\\bar{\\phi}_1 - \\dots = Q_1 h_1$。\n        -   因为 $N=1$，约定 $\\frac{1}{R_{1/2}}=0$ 和 $\\frac{1}{R_{N+1/2}} = \\frac{1}{R_{3/2}}=0$ 适用。\n        -   方程简化为 $\\Sigma_{a,1} h_1 \\bar{\\phi}_1 = Q_1 h_1$。\n        -   $(0.1 \\times 10) \\bar{\\phi}_1 = 0.5 \\times 10$。\n        -   $1.0 \\bar{\\phi}_1 = 5.0 \\implies \\bar{\\phi}_1 = 5.0$。\n        -   所以，用例 4 的解是 $[5.0]$。这也完全合理。在一个无限介质中（单节点上的反射边界所隐含的），通量就是 $Q/\\Sigma_a$。这里，$\\bar{\\phi} = 0.5 / 0.1 = 5.0$。节点平衡方程正确地再现了这一点。\n\n    - **测试用例 2：** $N=3$，非均匀吸收。\n        - $h = [10, 10, 10]$，$D=[1.0, 1.0, 1.0]$，$\\Sigma_a=[0.1, 1.0, 0.1]$，$Q=[0.5, 0.5, 0.5]$。\n        - $b = [5, 5, 5]^T$。\n        - 界面电阻与用例 1 相同：$R_{3/2} = 10, R_{5/2} = 10$。\n        - 耦合系数也相同：$C_{3/2} = 0.1, C_{5/2} = 0.1$。\n        - 方程组：\n            - 节点 1: $(\\Sigma_{a,1}h_1 + C_{3/2})\\bar{\\phi}_1 - C_{3/2}\\bar{\\phi}_2 = Q_1 h_1$\n                $(0.1 \\times 10 + 0.1)\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5 \\implies 1.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5$。\n            - 节点 2: $(\\Sigma_{a,2}h_2 + C_{3/2} + C_{5/2})\\bar{\\phi}_2 - C_{3/2}\\bar{\\phi}_1 - C_{5/2}\\bar{\\phi}_3 = Q_2 h_2$\n                $(1.0 \\times 10 + 0.1 + 0.1)\\bar{\\phi}_2 - 0.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_3 = 5 \\implies -0.1\\bar{\\phi}_1 + 10.2\\bar{\\phi}_2 - 0.1\\bar{\\phi}_3 = 5$。\n            - 节点 3: $(\\Sigma_{a,3}h_3 + C_{5/2})\\bar{\\phi}_3 - C_{5/2}\\bar{\\phi}_2 = Q_3 h_3$\n                $(0.1 \\times 10 + 0.1)\\bar{\\phi}_3 - 0.1\\bar{\\phi}_2 = 5 \\implies -0.1\\bar{\\phi}_2 + 1.1\\bar{\\phi}_3 = 5$。\n        - 矩阵 A:\n            $$\n            \\begin{pmatrix}\n            1.1  -0.1  0 \\\\\n            -0.1  10.2  -0.1 \\\\\n            0  -0.1  1.1\n            \\end{pmatrix}\n            $$\n        - 根据对称性，$\\bar{\\phi}_1 = \\bar{\\phi}_3$。\n            - $1.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5 \\implies \\bar{\\phi}_2 = 11\\bar{\\phi}_1 - 50$。\n            - $-0.1\\bar{\\phi}_1 + 10.2\\bar{\\phi}_2 - 0.1\\bar{\\phi}_1 = 5 \\implies -0.2\\bar{\\phi}_1 + 10.2\\bar{\\phi}_2 = 5$。\n            - 代入 $\\bar{\\phi}_2$：$-0.2\\bar{\\phi}_1 + 10.2(11\\bar{\\phi}_1 - 50) = 5$。\n            - $-0.2\\bar{\\phi}_1 + 112.2\\bar{\\phi}_1 - 510 = 5$。\n            - $112.0\\bar{\\phi}_1 = 515$。\n            - $\\bar{\\phi}_1 = 515 / 112 \\approx 4.598214...$\n            - $\\bar{\\phi}_3 = \\bar{\\phi}_1 \\approx 4.598214...$\n            - $\\bar{\\phi}_2 = 11(515/112) - 50 = (5665 - 5600)/112 = 65/112 \\approx 0.580357...$\n        - 这在物理上是合理的。中心节点的高吸收率极大地压低了那里的通量，而外部节点的通量则较高。\n\n    - **测试用例 3：** $N=4$，非均匀，局部源。\n        - $h=[5, 20, 5, 20]$，$D=[1.0, 0.5, 1.5, 1.0]$，$\\Sigma_a=[0.1, 0.2, 0.05, 0.15]$，$Q=[0.0, 2.0, 0.0, 0.0]$。\n        - 右侧向量 $b$：\n            - $b_1 = Q_1 h_1 = 0.0 \\times 5 = 0$。\n            - $b_2 = Q_2 h_2 = 2.0 \\times 20 = 40$。\n            - $b_3 = Q_3 h_3 = 0.0 \\times 5 = 0$。\n            - $b_4 = Q_4 h_4 = 0.0 \\times 20 = 0$。\n            - $b = [0, 40, 0, 0]^T$。\n        - 界面电阻：\n            - $R_{3/2} = \\frac{h_1}{2D_1} + \\frac{h_2}{2D_2} = \\frac{5}{2(1.0)} + \\frac{20}{2(0.5)} = 2.5 + 20 = 22.5$。\n            - $R_{5/2} = \\frac{h_2}{2D_2} + \\frac{h_3}{2D_3} = \\frac{20}{2(0.5)} + \\frac{5}{2(1.5)} = 20 + 5/3 \\approx 20 + 1.6666... = 21.6666... = 65/3$。\n            - $R_{7/2} = \\frac{h_3}{2D_3} + \\frac{h_4}{2D_4} = \\frac{5}{2(1.5)} + \\frac{20}{2(1.0)} = 5/3 + 10 \\approx 1.6666... + 10 = 11.6666... = 35/3$。\n        - 耦合系数：\n            - $C_{3/2} = 1 / 22.5 = 1 / (45/2) = 2/45 \\approx 0.0444...$\n            - $C_{5/2} = 1 / (65/3) = 3/65 \\approx 0.04615...$\n            - $C_{7/2} = 1 / (35/3) = 3/35 \\approx 0.08571...$\n        - 矩阵 A 对角线：\n            - $A_{1,1} = \\Sigma_{a,1}h_1 + C_{3/2} = 0.1 \\times 5 + 2/45 = 0.5 + 2/45 = 45/90 + 4/90 = 49/90 \\approx 0.5444...$\n            - $A_{2,2} = \\Sigma_{a,2}h_2 + C_{3/2} + C_{5/2} = 0.2 \\times 20 + 2/45 + 3/65 = 4 + 2/45 + 3/65 = 4 + (26+27)/585 = 4 + 53/585 \\approx 4.0906...$\n            - $A_{3,3} = \\Sigma_{a,3}h_3 + C_{5/2} + C_{7/2} = 0.05 \\times 5 + 3/65 + 3/35 = 0.25 + 3/65 + 3/35 = 1/4 + 3((35+65)/(65 \\times 35)) = 1/4 + 3(100/2275) = 1/4 + 300/2275 = 1/4 + 12/91 = (91+48)/364 = 139/364 \\approx 0.3818...$\n            - $A_{4,4} = \\Sigma_{a,4}h_4 + C_{7/2} = 0.15 \\times 20 + 3/35 = 3 + 3/35 = (105+3)/35 = 108/35 \\approx 3.0857...$\n        - 矩阵 A:\n            $$\n            \\begin{pmatrix}\n            A_{1,1}  -C_{3/2}  0  0 \\\\\n            -C_{3/2}  A_{2,2}  -C_{5/2}  0 \\\\\n            0  -C_{5/2}  A_{3,3}  -C_{7/2} \\\\\n            0  0  -C_{7/2}  A_{4,4}\n            \\end{pmatrix}\n            $$\n            $$\n            \\begin{pmatrix}\n            0.5444...  -0.0444...  0  0 \\\\\n            -0.0444...  4.0906...  -0.04615...  0 \\\\\n            0  -0.04615...  0.3818...  -0.08571... \\\\\n            0  0  -0.08571...  3.0857...\n            \\end{pmatrix}\n            $$\n        - 这将通过 `numpy.linalg.solve` 进行数值求解。手动计算看起来很复杂，但设置是合理的。\n\n逻辑似乎是正确的。我将继续进行实现。\n最终的输出格式是列表的列表。\n`[[...], [...], [...], [...]]`\n我的代码结构应该是：\n```python\ndef solve():\n    test_cases = [ (params1), (params2), ... ]\n    all_results = []\n    for case in test_cases:\n        N, h, D, Sigma_a, Q = case\n        # ... construct A and b as numpy arrays\n        # ... phi_bar = np.linalg.solve(A, b)\n        # ... round results\n        # ... all_results.append(rounded_phi_bar_list)\n    # print final formatted string\n```\n\n等等，`scipy` 被列为可用库。对于三对角系统，`scipy.linalg.solve_banded` 会更有效率，但 `numpy.linalg.solve` 完全可以胜任，而且对于这个问题规模来说可能更容易稳健地实现。鉴于 `N` 非常小（3 或 4），性能差异可以忽略不计。我将坚持使用 `numpy.linalg.solve`。\n\n最终输出需要是一个字符串。我可以在 Python 中构建列表的列表，然后使用 `json.dumps` 或自定义的字符串格式化函数。请求的格式是 `[[],[],[]]`，这正是列表的列表上的 `str()` 会产生的格式，但可能有些间距差异。让我们看看例子：`f\"[{','.join(map(str, results))}]\"` 是针对扁平列表的，但我的结果是列表的列表。我需要一个嵌套的构造。\n问题中的例子：`print(f\"[{','.join(map(str, results))}]\")`\n我的 `results` 将是 `[ [1, 2], [3, 4] ]`。`map(str, results)` 将是 `['[1, 2]', '[3, 4]']`。`','.join(...)` 将是 `[1, 2],[3, 4]`。在前面加上 `[` 并在后面加上 `]` 将得到 `[[1, 2],[3, 4]]`。这看起来是正确的。我需要确保内部列表也被正确地字符串化，但列表上的 `str()` 会自动完成这个工作。\n\n让我们完善实现逻辑。\n```python\ndef solve_system(N, h, D, Sigma_a, Q):\n    # Convert inputs to numpy arrays for easier math\n    h = np.array(h)\n    D = np.array(D)\n    Sigma_a = np.array(Sigma_a)\n    Q = np.array(Q)\n    \n    A = np.zeros((N, N))\n    b = np.zeros(N)\n    \n    # Fill RHS vector b\n    b = Q * h\n    \n    # Fill diagonal terms from absorption\n    np.fill_diagonal(A, Sigma_a * h)\n    \n    # Handle the N=1 case separately to avoid index errors\n    if N == 1:\n        # No coupling, matrix is already correct\n        pass\n    else:\n        # Fill coupling terms (off-diagonals and additions to diagonal)\n        for i in range(N - 1):\n            # i is the index of the left node, i+1 is the right node\n            R_interface = (h[i] / (2 * D[i])) + (h[i+1] / (2 * D[i+1]))\n            C = 1.0 / R_interface\n            \n            # Add to diagonals\n            A[i, i] += C\n            A[i+1, i+1] += C\n            \n            # Set off-diagonals\n            A[i, i+1] = -C\n            A[i+1, i] = -C\n            \n    # Solve the system\n    phi_bar = np.linalg.solve(A, b)\n    \n    # Round and convert to list\n    return [round(x, 6) for x in phi_bar]\n\n# main part\n# loop through test cases\n# call solve_system for each\n# collect results\n# format and print\n```\n这看起来很可靠。该逻辑正确处理了 $N=1$ 的情况。如果 $N=1$，`range(N-1)` 是 `range(0)`，是空的，所以耦合循环被跳过。矩阵 `A` 将是 `[[Sigma_a[0]*h[0]]]`，`b` 将是 `[Q[0]*h[0]]`。解是 `b[0]/A[0,0]`，即 `Q[0]/Sigma_a[0]`。这与我为用例 4 的手动计算相符。\n\n问题陈述要求**每个数学实体**都使用 LaTeX。我应小心遵循这一点。\n\n---\n## 正式流程开始。\n\n### 问题验证\n\n#### 步骤 1：提取给定信息\n\n-   控制方程：$-D(x)\\frac{d^2\\phi(x)}{dx^2} + \\Sigma_a(x)\\,\\phi(x) = Q(x)$\n-   变量：\n    -   $D(x)$：扩散系数 ($\\text{cm}$)\n    -   $\\Sigma_a(x)$：宏观吸收截面 ($\\text{cm}^{-1}$)\n    -   $\\phi(x)$：标量中子通量 ($n/\\left(\\text{cm}^2\\cdot\\text{s}\\right)$)\n    -   $Q(x)$：固定体积源 ($n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$)\n-   边界条件：两端反射，$J(x_{\\text{left}}) = 0$ 和 $J(x_{\\text{right}}) = 0$。\n-   菲克定律：$J(x) = -D(x)\\,d\\phi(x)/dx$。\n-   节点 $i$ 的节点平衡方程：$\\Sigma_{a,i}\\,h_i\\,\\bar{\\phi}_i + \\left(J_{i+\\frac{1}{2}} - J_{i-\\frac{1}{2}}\\right) = Q_i\\,h_i$。\n    -   $h_i$：节点 $i$ 的宽度 ($\\text{cm}$)\n    -   $\\bar{\\phi}_i$：节点 $i$ 的节点平均标量通量\n    -   $\\Sigma_{a,i}, D_i, Q_i$：节点 $i$ 中的常数材料属性\n    -   $J_{i\\pm\\frac{1}{2}}$：界面流\n-   边界流：对于 $N$ 个节点，$J_{\\frac{1}{2}} = 0$ 和 $J_{N+\\frac{1}{2}} = 0$。\n-   界面电阻模型 (CMFD)：\n    -   总界面电阻：$R_{i+\\frac{1}{2}} = \\frac{h_i}{2\\,D_i} + \\frac{h_{i+1}}{2\\,D_{i+1}}$。\n    -   界面流近似：$J_{i+\\frac{1}{2}} = -\\frac{\\bar{\\phi}_{i+1} - \\bar{\\phi}_i}{R_{i+\\frac{1}{2}}}$。\n-   节点平均通量 $\\bar{\\phi}_i$ 的最终线性系统：\n    $$\\left(\\Sigma_{a,i}\\,h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i - \\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} - \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1} = Q_i\\,h_i$$\n-   线性系统的边界约定：$\\frac{1}{R_{\\frac{1}{2}}} = 0$ 和 $\\frac{1}{R_{N+\\frac{1}{2}}} = 0$。\n-   测试用例：\n    1.  $N=3$，$h=[10,10,10]\\,\\text{cm}$，$D=[1.0,1.0,1.0]\\,\\text{cm}$，$\\Sigma_a=[0.1,0.1,0.1]\\,\\text{cm}^{-1}$，$Q=[0.5,0.5,0.5]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$。\n    2.  $N=3$，$h=[10,10,10]\\,\\text{cm}$，$D=[1.0,1.0,1.0]\\,\\text{cm}$，$\\Sigma_a=[0.1,1.0,0.1]\\,\\text{cm}^{-1}$，$Q=[0.5,0.5,0.5]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$。\n    3.  $N=4$，$h=[5,20,5,20]\\,\\text{cm}$，$D=[1.0,0.5,1.5,1.0]\\,\\text{cm}$，$\\Sigma_a=[0.1,0.2,0.05,0.15]\\,\\text{cm}^{-1}$，$Q=[0.0,2.0,0.0,0.0]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$。\n    4.  $N=1`，$h=[10]\\,\\text{cm}$，$D=[1.0]\\,\\text{cm}$，$\\Sigma_a=[0.1]\\,\\text{cm}^{-1}$，$Q=[0.5]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$。\n-   输出要求：单行字符串 `[ [flux_list_1], [flux_list_2], ... ]`，通量值四舍五入到 6 位小数。\n\n#### 步骤 2：使用提取的给定信息进行验证\n\n1.  **科学依据**：该问题基于单群中子扩散方程，这是核反应堆物理学的基石。通过对微分形式积分推导节点平衡方程是标准程序。使用类似 CMFD 的近似来处理界面流是反应堆分析中节点扩散法中一种成熟且广泛使用的技术。物理学是合理的。所有参数及其单位在物理上都是正确和一致的。该问题牢固地植根于反应堆物理学和数值方法。\n2.  **适定性**：问题要求解一个 $A\\bar{\\phi} = b$ 形式的线性方程组。得到的矩阵 $A$ 是一个对称正定矩阵（具体来说，它是一个对角占优的 Stieltjes 矩阵），这保证了唯一且稳定的解。问题是适定的。\n3.  **客观性**：问题以精确的数学和物理术语陈述。任务是实现一种特定的数值方法，并将其应用于明确定义的测试用例。没有主观性或歧义。\n4.  **科学或事实不准确**：没有缺陷。物理和数学是标准且正确的。\n5.  **非形式化或不相关**：没有缺陷。该问题是一个形式化的数值任务，与核反应堆模拟中的扩散理论主题直接相关。\n6.  **不完整或矛盾的设置**：没有缺陷。提供了所有必要的方程、参数、边界条件和测试数据。表述是自洽的。处理边界条件的约定已明确说明。\n7.  **不切实际或不可行**：没有缺陷。参数值对于反应堆材料来说在物理上是合理的。计算是可行的。\n8.  **不适定或结构不良**：没有缺陷。如前所述，得到的线性系统是良态的，并有唯一解。\n9.  **伪深刻、琐碎或同义反复**：没有缺陷。该问题需要对特定数值方案进行非平凡的组装和求解。虽然测试用例很小，但它们具有代表性，足以测试核心逻辑的实现。单节点案例可作为一个有用的合理性检查。\n10. **超出科学可验证范围**：没有缺陷。结果可以通过重新实现算法或使用其他软件手动或自动求解线性系统来独立验证。\n\n#### 步骤 3：结论与行动\n\n问题是**有效的**。我将继续进行求解。\n\n---\n### 解决方案开发\n\n任务是求解一个线性方程组 $A\\bar{\\phi} = b$ 以得到节点平均通量向量 $\\bar{\\phi} = [\\bar{\\phi}_1, \\ldots, \\bar{\\phi}_N]^T$。问题陈述为第 $i$ 个方程提供了模板：\n$$\\left(\\Sigma_{a,i}\\,h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i - \\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} - \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1} = Q_i\\,h_i$$\n\n这里，$\\bar{\\phi}$ 的索引是 1-基的，从 $1$ 到 $N$。矩阵 $A$ 是一个 $N \\times N$ 的三对角矩阵，$b$ 是一个长度为 $N$ 的向量。\n\n让我们使用 0-基索引来定义矩阵元素 $A_{ij}$ 和向量元素 $b_i$ 以便实现，其中 $i, j \\in \\{0, 1, \\dots, N-1\\}$。系统的第 $i$ 行对应于节点 $i+1$ 的平衡方程。\n\n1.  **右侧(RHS)向量, $b$**：\n    对于每个节点 $i \\in \\{0, \\dots, N-1\\}$，右侧是积分源项。\n    $$b_i = Q_{i+1}\\,h_{i+1}$$\n    在数组表示法中，这简单地是 $b_i = Q_i h_i$。\n\n2.  **系统矩阵, $A$**：\n    矩阵 $A$ 由两部分组成：一部分是每个节点内中子移除（吸收）产生的对角项，另一部分是相邻节点间中子泄漏（流）产生的三对角项。\n\n    -   **移除/损失项 (对角线)**：项 $\\Sigma_{a,i}\\,h_i\\,\\bar{\\phi}_i$ 贡献于矩阵的对角线。对于节点 $i+1$（0-基索引 $i$），这是 $\\Sigma_{a,i+1}\\,h_{i+1}$。\n        $$A_{ii}^{\\text{loss}} = \\Sigma_{a,i+1}\\,h_{i+1}$$\n\n    -   **泄漏/耦合项 (三对角)**：与界面流 $J_{i\\pm\\frac{1}{2}}$ 相关的项构成了节点间的耦合。节点 $i$ 和节点 $i+1$ 之间的流是 $J_{i+\\frac{1}{2}} = -\\frac{\\bar{\\phi}_{i+1} - \\bar{\\phi}_i}{R_{i+\\frac{1}{2}}} = C_{i+\\frac{1}{2}}(\\bar{\\phi}_i - \\bar{\\phi}_{i+1})$，其中 $C_{i+\\frac{1}{2}} = 1 / R_{i+\\frac{1}{2}}$ 是耦合系数。\n        节点 $i$（1-基索引）的净泄漏是 $J_{i+\\frac{1}{2}} - J_{i-\\frac{1}{2}}$。\n        此项变为 $C_{i-\\frac{1}{2}}(\\bar{\\phi}_{i-1} - \\bar{\\phi}_i) - C_{i+\\frac{1}{2}}(\\bar{\\phi}_{i} - \\bar{\\phi}_{i+1}) = C_{i-\\frac{1}{2}}\\bar{\\phi}_{i-1} + C_{i+\\frac{1}{2}}\\bar{\\phi}_{i+1} - (C_{i-\\frac{1}{2}} + C_{i+\\frac{1}{2}})\\bar{\\phi}_i$。\n        问题中已将其重新排列为：\n        $-\\left(\\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} + \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1}\\right) + \\left(\\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i$。\n\n    让我们使用 0-基索引（$i, j \\in \\{0, \\dots, N-1\\}$）来组装矩阵元素。\n\n    -   **对角线元素 $A_{ii}$**：\n        对于一个内部节点 $i$（即不在边界上），其平衡方程受泄漏到节点 $i-1$ 和节点 $i+1$ 的影响。\n        节点 $i$ 和 $i+1$ 之间的耦合系数是 $C_{i_L, i_R} = \\frac{1}{R_{i_L, i_R}}$，其中 $R_{i_L, i_R} = \\frac{h_i}{2D_i} + \\frac{h_{i+1}}{2D_{i+1}}$。\n        节点 $i$ 的对角线元素是：\n        $$A_{ii} = \\Sigma_{a,i}\\,h_i + C_{i-1, i} + C_{i, i+1}$$\n        边界条件通过将域外邻居的耦合系数设为零来处理。使用问题的约定，$1/R_{1/2} = 0$ 和 $1/R_{N+1/2} = 0$。这意味着与节点 0“左侧”的耦合（$C_{-1, 0}$）为零，与节点 $N-1$“右侧”的耦合（$C_{N-1, N}$）为零。\n        因此，对角线元素的一般形式是：\n        -   $A_{00} = \\Sigma_{a,0}\\,h_0 + C_{0,1}$\n        -   $A_{ii} = \\Sigma_{a,i}\\,h_i + C_{i-1, i} + C_{i, i+1}$ 对于 $i \\in \\{1, \\dots, N-2\\}$\n        -   $A_{N-1, N-1} = \\Sigma_{a,N-1}\\,h_{N-1} + C_{N-2, N-1}$\n\n    -   **非对角线元素 $A_{i, i+1}$ 和 $A_{i+1, i}$**：\n        节点 $i$ 和 $i+1$ 之间的耦合贡献于非对角线元素。\n        $$A_{i, i+1} = A_{i+1, i} = -C_{i, i+1} = -\\frac{1}{R_{i, i+1}} = -\\frac{1}{\\frac{h_i}{2D_i} + \\frac{h_{i+1}}{2D_{i+1}}}$$\n\n3.  **算法**：\n    对于每个测试用例，将实现以下算法：\n    a.  给定 $N$ 和列表 $h, D, \\Sigma_a, Q$。\n    b.  如果 $N=1$，解就是 $\\bar{\\phi}_0 = Q_0/\\Sigma_{a,0}$。节点平衡方程 $\\Sigma_{a,0}h_0 \\bar{\\phi}_0 = Q_0h_0$ 简化为此。\n    c.  如果 $N1$：\n        i.   创建一个 $N \\times N$ 的 NumPy 数组 `A`，初始化为零。\n        ii.  创建一个 $N \\times 1$ 的 NumPy 数组 `b`。\n        iii. 填充 `b` 使得 $b_i = Q_i h_i$。\n        iv.  用移除项填充 `A` 的对角线：$A_{ii} = \\Sigma_{a,i} h_i$。\n        v.   从 $i = 0$ 迭代到 $N-2$ 来计算每个界面的耦合项：\n             -   计算界面电阻 $R = \\frac{h_i}{2D_i} + \\frac{h_{i+1}}{2D_{i+1}}$。\n             -   计算耦合系数 $C = 1/R$。\n             -   将 $C$ 加到对角线元素上：$A_{ii} \\leftarrow A_{ii} + C$ 和 $A_{i+1, i+1} \\leftarrow A_{i+1, i+1} + C$。\n             -   设置非对角线元素：$A_{i, i+1} = -C$ 和 $A_{i+1, i} = -C$。\n        vi.  使用 `numpy.linalg.solve` 求解线性系统 $A \\bar{\\phi} = b$。\n    d.  将得到的通量向量 $\\bar{\\phi}$ 的元素四舍五入到 6 位小数。\n    e.  收集当前测试用例的四舍五入后的通量列表。\n\n4.  **最终输出**：\n    处理完所有测试用例后，将收集到的列表的列表格式化为所需的字符串 `[[...],[...],...]` 并打印。Python 表达式 `f\"[{','.join(map(str, all_results))}]\"` 将正确地格式化一个列表的列表，因为应用于列表的 `str()` 会产生其标准的字符串表示形式。\n\n这种系统性的方法正确地实现了所描述的物理和数值方法，确保了给定测试用例的准确结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_diffusion_system(N, h, D, Sigma_a, Q):\n    \"\"\"\n    Constructs and solves the coarse-mesh nodal diffusion system.\n\n    Args:\n        N (int): Number of nodes.\n        h (list): List of node widths in cm.\n        D (list): List of diffusion coefficients in cm.\n        Sigma_a (list): List of macroscopic absorption cross sections in cm^-1.\n        Q (list): List of volumetric source strengths in n/(cm^3*s).\n\n    Returns:\n        list: A list of node-average scalar fluxes, rounded to 6 decimal places.\n    \"\"\"\n    # For N=1, the reflective boundary conditions mean no leakage.\n    # The balance equation Sigma_a,1 * h_1 * phi_bar_1 = Q_1 * h_1\n    # simplifies to phi_bar_1 = Q_1 / Sigma_a,1.\n    if N == 1:\n        if Sigma_a[0] == 0:\n            # Physically, this implies infinite flux if Q  0, or any flux if Q = 0.\n            # Mathematically, the matrix would be singular.\n            # For this problem's constraints, we assume Sigma_a  0.\n            return [np.inf if Q[0]  0 else 0.0]\n        flux = Q[0] / Sigma_a[0]\n        return [round(flux, 6)]\n\n    # Convert lists to NumPy arrays for vectorized operations\n    h_arr = np.array(h, dtype=float)\n    D_arr = np.array(D, dtype=float)\n    Sigma_a_arr = np.array(Sigma_a, dtype=float)\n    Q_arr = np.array(Q, dtype=float)\n\n    # Initialize the system matrix A and right-hand side vector b\n    A = np.zeros((N, N))\n    b = Q_arr * h_arr\n\n    # Populate the diagonal of A with the removal term (Sigma_a,i * h_i)\n    np.fill_diagonal(A, Sigma_a_arr * h_arr)\n\n    # Populate the matrix with leakage coupling terms\n    # Iterate over the N-1 interfaces between nodes\n    for i in range(N - 1):\n        # Resistance of the left half-node at the interface\n        r_left = h_arr[i] / (2.0 * D_arr[i])\n        # Resistance of the right half-node at the interface\n        r_right = h_arr[i+1] / (2.0 * D_arr[i+1])\n        \n        # Total interface resistance\n        R_interface = r_left + r_right\n        \n        # Coupling coefficient is the inverse of the resistance\n        C = 1.0 / R_interface\n        \n        # Add to diagonal elements for node i and i+1\n        A[i, i] += C\n        A[i+1, i+1] += C\n        \n        # Set the off-diagonal elements\n        A[i, i+1] = -C\n        A[i+1, i] = -C\n        \n    # Solve the linear system A * phi_bar = b\n    phi_bar = np.linalg.solve(A, b)\n    \n    # Round the results to 6 decimal places and return as a standard list\n    return [round(x, 6) for x in phi_bar.tolist()]\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the final output.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        {'N': 3, 'h': [10.0, 10.0, 10.0], 'D': [1.0, 1.0, 1.0], 'Sigma_a': [0.1, 0.1, 0.1], 'Q': [0.5, 0.5, 0.5]},\n        # Test case 2\n        {'N': 3, 'h': [10.0, 10.0, 10.0], 'D': [1.0, 1.0, 1.0], 'Sigma_a': [0.1, 1.0, 0.1], 'Q': [0.5, 0.5, 0.5]},\n        # Test case 3\n        {'N': 4, 'h': [5.0, 20.0, 5.0, 20.0], 'D': [1.0, 0.5, 1.5, 1.0], 'Sigma_a': [0.1, 0.2, 0.05, 0.15], 'Q': [0.0, 2.0, 0.0, 0.0]},\n        # Test case 4\n        {'N': 1, 'h': [10.0], 'D': [1.0], 'Sigma_a': [0.1], 'Q': [0.5]}\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = solve_diffusion_system(case['N'], case['h'], case['D'], case['Sigma_a'], case['Q'])\n        all_results.append(result)\n\n    # Format the final output string as a list of lists, without spaces.\n    # str() on a list produces a string with spaces. We build it manually.\n    inner_strings = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}