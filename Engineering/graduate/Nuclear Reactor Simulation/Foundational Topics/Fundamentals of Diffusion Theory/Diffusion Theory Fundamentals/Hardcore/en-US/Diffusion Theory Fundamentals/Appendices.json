{
    "hands_on_practices": [
        {
            "introduction": "The diffusion equation simplifies the complex reality of neutron transport using effective, homogenized parameters. This first exercise explores the origin of these parameters, connecting the microscopic world of nuclear cross sections to the macroscopic parameters that govern diffusion theory, such as the diffusion coefficient $D_g$ and the migration length $M$. By deriving these quantities from first principles for a two-group model, you will gain a deeper physical intuition for how a material's composition dictates the average lifecycle of a neutron from birth to absorption .",
            "id": "4222193",
            "problem": "Consider an infinite, homogeneous, nonmultiplying medium modeled with two energy groups: a fast group and a thermal group. Neutrons are born in the fast group and ultimately absorbed in the thermal group. Assume steady state, no external boundaries, and no internal sources other than the initial birth of neutrons in the fast group. Scattering in the thermal group is isotropic, while scattering in the fast group is anisotropic with a given average scattering cosine. The medium parameters are:\n\n- Fast group macroscopic absorption cross section $\\Sigma_{a,f} = 0.005 \\ \\text{cm}^{-1}$.\n- Fast group macroscopic scattering cross section $\\Sigma_{s,f} = 0.200 \\ \\text{cm}^{-1}$.\n- Fraction of fast-group scattering that removes neutrons from the fast group into the thermal group is represented by the macroscopic transfer cross section $\\Sigma_{s,f \\to t} = 0.150 \\ \\text{cm}^{-1}$.\n- Average scattering cosine in the fast group $\\bar{\\mu}_{f} = 0.80$.\n- Thermal group macroscopic absorption cross section $\\Sigma_{a,t} = 0.020 \\ \\text{cm}^{-1}$.\n- Thermal group macroscopic scattering cross section $\\Sigma_{s,t} = 0.300 \\ \\text{cm}^{-1}$.\n\nStarting from the steady-state neutron balance and the diffusion approximation based on Fick’s law and the first-order spherical harmonics (P1) approach, perform the following:\n\n1. Derive the diffusion coefficient $D_{g}$ in each group $g \\in \\{f, t\\}$ in terms of the transport cross section $\\Sigma_{\\text{tr},g}$ that accounts for scattering anisotropy. Use the definition of the transport cross section based on the first angular moment of scattering.\n2. Using the diffusion equation with an appropriate removal term, justify and obtain the characteristic attenuation length $L_{f}$ for the fast group and $L_{t}$ for the thermal group. In the fast group, removal includes both absorption and down-scatter to the thermal group. In the thermal group, removal is absorption.\n3. Using a first-principles argument grounded in linearity and independence of sequential migration stages (fast-group migration until removal, then thermal-group migration until absorption), derive the expression for the migration length $M$ as the root-mean-square distance between birth and absorption in terms of $L_{f}$ and $L_{t}$.\n\nFinally, compute the numerical value of the migration length $M$ for the medium defined above. Express your final answer in centimeters and round your result to four significant figures.",
            "solution": "The problem is scientifically grounded, well-posed, and objective. All parameters required for the solution are provided, and they are physically consistent within the framework of two-group neutron diffusion theory. The problem asks for standard derivations and calculations in this field. Therefore, the problem is valid, and we proceed with the solution.\n\nThe solution is presented in three parts as requested: derivation of the diffusion coefficient, justification of the characteristic attenuation lengths, and derivation of the migration length, followed by the final numerical computation.\n\nFirst, we derive the expression for the diffusion coefficient $D_g$ for each group $g \\in \\{f, t\\}$. The diffusion approximation is derived from the first-order spherical harmonics (P1) expansion of the angular neutron flux. It results in Fick's law of diffusion, which relates the neutron current density vector $\\vec{J}_g$ to the gradient of the scalar neutron flux $\\phi_g$:\n$$\n\\vec{J}_g(\\vec{r}) = -D_g \\nabla \\phi_g(\\vec{r})\n$$\nThe diffusion coefficient, $D_g$, is defined as:\n$$\nD_g = \\frac{1}{3\\Sigma_{\\text{tr},g}}\n$$\nwhere $\\Sigma_{\\text{tr},g}$ is the macroscopic transport cross section for group $g$. The transport cross section accounts for the anisotropy of scattering. For scattering that is not isotropic, forward-peaked scattering is less effective at changing a neutron's direction of flight compared to isotropic scattering. The transport cross section is a correction that effectively increases the mean free path. It is defined as:\n$$\n\\Sigma_{\\text{tr},g} = \\Sigma_{t,g} - \\Sigma_{s1,g}\n$$\nHere, $\\Sigma_{t,g}$ is the total macroscopic cross section, and $\\Sigma_{s1,g}$ is the first Legendre moment of the scattering cross section. The total cross section is the sum of the absorption and scattering cross sections, $\\Sigma_{t,g} = \\Sigma_{a,g} + \\Sigma_{s,g}$. The term $\\Sigma_{s1,g}$ is given by $\\bar{\\mu}_g \\Sigma_{s,g}$, where $\\bar{\\mu}_g$ is the average cosine of the scattering angle in laboratory coordinates for group $g$. Substituting these into the definition of $\\Sigma_{\\text{tr},g}$:\n$$\n\\Sigma_{\\text{tr},g} = (\\Sigma_{a,g} + \\Sigma_{s,g}) - \\bar{\\mu}_g \\Sigma_{s,g} = \\Sigma_{a,g} + (1 - \\bar{\\mu}_g) \\Sigma_{s,g}\n$$\nFor isotropic scattering, $\\bar{\\mu}_g = 0$, and the transport cross section simplifies to the total cross section, $\\Sigma_{\\text{tr},g} = \\Sigma_{a,g} + \\Sigma_{s,g} = \\Sigma_{t,g}$.\n\nSecond, we justify and obtain the characteristic attenuation lengths $L_f$ and $L_t$. The steady-state diffusion equation for group $g$ in a medium without external sources but with a source term $S_g(\\vec{r})$ from other groups is:\n$$\nD_g \\nabla^2 \\phi_g(\\vec{r}) - \\Sigma_{R,g} \\phi_g(\\vec{r}) + S_g(\\vec{r}) = 0\n$$\nwhere $\\Sigma_{R,g}$ is the macroscopic removal cross section for group $g$. The characteristic attenuation length, or diffusion length $L_g$, represents the typical distance a neutron travels from its point of entry into group $g$ until it is removed from that group. To determine this length, we consider a monoenergetic point source of neutrons of group $g$ at the origin, $S_g(\\vec{r}) = S_0 \\delta(\\vec{r})$, in an infinite medium. The equation becomes (for $r > 0$):\n$$\nD_g \\nabla^2 \\phi_g(\\vec{r}) - \\Sigma_{R,g} \\phi_g(\\vec{r}) = 0\n$$\nDividing by $D_g$, we obtain the Helmholtz equation:\n$$\n\\nabla^2 \\phi_g(\\vec{r}) - \\frac{\\Sigma_{R,g}}{D_g} \\phi_g(\\vec{r}) = 0\n$$\nWe define the diffusion area (or squared diffusion length) for group $g$ as $L_g^2 = \\frac{D_g}{\\Sigma_{R,g}}$. The equation becomes $\\nabla^2 \\phi_g(\\vec{r}) - \\frac{1}{L_g^2} \\phi_g(\\vec{r}) = 0$. The solution to this equation in spherical symmetry that vanishes as $r \\to \\infty$ is $\\phi_g(r) \\propto \\frac{\\exp(-r/L_g)}{r}$. The quantity $L_g$ is the characteristic e-folding distance, hence it is the characteristic attenuation length.\n\nFor the fast group ($g=f$), neutrons are removed by absorption ($\\Sigma_{a,f}$) and by down-scattering to the thermal group ($\\Sigma_{s,f \\to t}$). Thus, the fast removal cross section is $\\Sigma_{R,f} = \\Sigma_{a,f} + \\Sigma_{s,f \\to t}$. The fast attenuation length, often called the slowing-down length in this context, is:\n$$\nL_f = \\sqrt{\\frac{D_f}{\\Sigma_{R,f}}} = \\sqrt{\\frac{D_f}{\\Sigma_{a,f} + \\Sigma_{s,f \\to t}}}\n$$\nFor the thermal group ($g=t$), in this two-group model, neutrons are removed only by absorption. Thus, the thermal removal cross section is $\\Sigma_{R,t} = \\Sigma_{a,t}$. The thermal attenuation length, or thermal diffusion length, is:\n$$\nL_t = \\sqrt{\\frac{D_t}{\\Sigma_{R,t}}} = \\sqrt{\\frac{D_t}{\\Sigma_{a,t}}}\n$$\n\nThird, we derive the expression for the migration length $M$. The migration length is related to the root-mean-square distance a neutron travels from its birth (as a fast neutron) to its death (absorption as a thermal neutron). Let $\\vec{r}_f$ be the displacement vector of a neutron during its fast-group lifetime and $\\vec{r}_t$ be its displacement vector during its thermal-group lifetime. The total displacement is $\\vec{r} = \\vec{r}_f + \\vec{r}_t$. The squared displacement is $r^2 = \\vec{r} \\cdot \\vec{r} = (\\vec{r}_f + \\vec{r}_t) \\cdot (\\vec{r}_f + \\vec{r}_t) = r_f^2 + r_t^2 + 2\\vec{r}_f \\cdot \\vec{r}_t$.\nThe mean-square displacement is $\\langle r^2 \\rangle = \\langle r_f^2 \\rangle + \\langle r_t^2 \\rangle + 2\\langle\\vec{r}_f \\cdot \\vec{r}_t\\rangle$. The processes governing thermal migration are independent of the preceding fast migration history. The direction of the first flight as a thermal neutron is uncorrelated with the direction of the final flight as a fast neutron. Therefore, the average of the cross term is zero: $\\langle\\vec{r}_f \\cdot \\vec{r}_t\\rangle = 0$. This gives:\n$$\n\\langle r^2 \\rangle = \\langle r_f^2 \\rangle + \\langle r_t^2 \\rangle\n$$\nBy definition, the slowing-down area ($L_f^2$) and the thermal diffusion area ($L_t^2$) are related to the mean-square travel distances in each stage by $L_f^2 = \\frac{1}{6}\\langle r_f^2 \\rangle$ and $L_t^2 = \\frac{1}{6}\\langle r_t^2 \\rangle$. The total migration area, $M^2$, is defined as one-sixth of the total mean-square displacement: $M^2 = \\frac{1}{6}\\langle r^2 \\rangle$.\nSubstituting these definitions into the equation for $\\langle r^2 \\rangle$ and dividing by $6$ yields:\n$$\nM^2 = L_f^2 + L_t^2\n$$\nThe migration length $M$ is the square root of the migration area:\n$$\nM = \\sqrt{L_f^2 + L_t^2}\n$$\n\nFinally, we compute the numerical value of the migration length $M$.\n\n1.  Calculate the transport cross section and diffusion coefficient for each group.\n    For the fast group ($g=f$):\n    $\\Sigma_{s,f} = 0.200 \\ \\text{cm}^{-1}$, $\\Sigma_{a,f} = 0.005 \\ \\text{cm}^{-1}$, $\\bar{\\mu}_f = 0.80$.\n    $$\n    \\Sigma_{\\text{tr},f} = \\Sigma_{a,f} + (1 - \\bar{\\mu}_f) \\Sigma_{s,f} = 0.005 + (1 - 0.80)(0.200) = 0.005 + 0.040 = 0.045 \\ \\text{cm}^{-1}\n    $$\n    $$\n    D_f = \\frac{1}{3\\Sigma_{\\text{tr},f}} = \\frac{1}{3(0.045)} = \\frac{1}{0.135} \\ \\text{cm}\n    $$\n    For the thermal group ($g=t$):\n    $\\Sigma_{s,t} = 0.300 \\ \\text{cm}^{-1}$, $\\Sigma_{a,t} = 0.020 \\ \\text{cm}^{-1}$. Scattering is isotropic, so $\\bar{\\mu}_t = 0$.\n    $$\n    \\Sigma_{\\text{tr},t} = \\Sigma_{a,t} + (1 - \\bar{\\mu}_t) \\Sigma_{s,t} = 0.020 + (1 - 0)(0.300) = 0.320 \\ \\text{cm}^{-1}\n    $$\n    $$\n    D_t = \\frac{1}{3\\Sigma_{\\text{tr},t}} = \\frac{1}{3(0.320)} = \\frac{1}{0.960} \\ \\text{cm}\n    $$\n\n2.  Calculate the slowing-down area ($L_f^2$) and thermal diffusion area ($L_t^2$).\n    For the fast group:\n    $\\Sigma_{R,f} = \\Sigma_{a,f} + \\Sigma_{s,f \\to t} = 0.005 + 0.150 = 0.155 \\ \\text{cm}^{-1}$.\n    $$\n    L_f^2 = \\frac{D_f}{\\Sigma_{R,f}} = \\frac{1/0.135}{0.155} = \\frac{1}{0.135 \\times 0.155} = \\frac{1}{0.020925} \\ \\text{cm}^2 \\approx 47.789725 \\ \\text{cm}^2\n    $$\n    For the thermal group:\n    $$\n    L_t^2 = \\frac{D_t}{\\Sigma_{a,t}} = \\frac{1/0.960}{0.020} = \\frac{1}{0.960 \\times 0.020} = \\frac{1}{0.0192} \\ \\text{cm}^2 \\approx 52.083333 \\ \\text{cm}^2\n    $$\n\n3.  Calculate the migration area ($M^2$) and migration length ($M$).\n    $$\n    M^2 = L_f^2 + L_t^2 = \\frac{1}{0.020925} + \\frac{1}{0.0192} \\approx 47.789725 + 52.083333 = 99.873058 \\ \\text{cm}^2\n    $$\n    $$\n    M = \\sqrt{M^2} = \\sqrt{99.873058} \\approx 9.993651 \\ \\text{cm}\n    $$\nRounding the result to four significant figures gives $M \\approx 9.994 \\ \\text{cm}$.",
            "answer": "$$\n\\boxed{9.994}\n$$"
        },
        {
            "introduction": "While infinite media provide a useful theoretical starting point, real reactors are finite and cleverly designed to conserve neutrons. This practice moves from theory to a more realistic configuration: a fissile core surrounded by a non-multiplying reflector. You will apply the one-group diffusion equation to this heterogeneous system, using the fundamental physical principles of flux and current continuity to derive the criticality condition and the reflector savings $s$ . This classic problem is a cornerstone of reactor analysis, demonstrating how boundary conditions and material interfaces shape the spatial distribution of neutrons.",
            "id": "4222186",
            "problem": "A one-dimensional, symmetric, reflected slab is modeled in one energy group. The fissile core occupies the region $|x|a$ with homogeneous material properties: diffusion coefficient $D_c$, macroscopic absorption $\\Sigma_{a,c}$, and macroscopic production $\\nu \\Sigma_{f,c}$. On each side of the core, for $|x|a$, there is a semi-infinite nonmultiplying reflector with homogeneous properties: diffusion coefficient $D_r$ and macroscopic absorption $\\Sigma_{a,r}$, with $\\nu \\Sigma_{f,r}=0$. Assume steady state, isotropic scattering, and validity of Fick’s law.\n\nStarting only from the steady-state one-group neutron diffusion equation and Fick’s law, and enforcing continuity of scalar flux and neutron current at the core–reflector interfaces, do the following:\n\n- Derive the form of the core-region boundary condition at $x=\\pm a$ that encapsulates the effect of the semi-infinite reflector.\n- Impose the even fundamental mode at criticality and derive an explicit expression for the reflector savings $s$, defined as the difference between the extrapolated half-size corresponding to a vacuum zero-flux node of the core-region solution and the physical core half-thickness $a$.\n\nThen evaluate $s$ numerically for the following data:\n- Core: $D_c=1.2\\,\\mathrm{cm}$, $\\Sigma_{a,c}=8.0\\times 10^{-3}\\,\\mathrm{cm}^{-1}$, $\\nu \\Sigma_{f,c}=2.0\\times 10^{-2}\\,\\mathrm{cm}^{-1}$.\n- Reflector: $D_r=1.6\\,\\mathrm{cm}$, $\\Sigma_{a,r}=2.5\\times 10^{-3}\\,\\mathrm{cm}^{-1}$.\n\nAssume criticality in the core (i.e., multiplication factor $k=1$) and that the reflector extends to infinity so the scalar flux remains finite as $|x|\\to\\infty$. Round your final result for $s$ to four significant figures. Express the final answer in cm.",
            "solution": "The user-provided problem is a standard exercise in one-group neutron diffusion theory and is deemed valid. We will proceed with a full derivation and solution.\n\nThe steady-state, one-group neutron diffusion equation in a source-free region is given by:\n$$\n-D \\frac{d^2 \\phi(x)}{dx^2} + \\Sigma_a \\phi(x) = \\frac{1}{k} \\nu \\Sigma_f \\phi(x)\n$$\nwhere $D$ is the diffusion coefficient, $\\phi(x)$ is the neutron scalar flux, $\\Sigma_a$ is the macroscopic absorption cross-section, $\\nu \\Sigma_f$ is the macroscopic production cross-section, and $k$ is the multiplication factor. At criticality, $k=1$. The equation can be rearranged to:\n$$\n\\frac{d^2 \\phi(x)}{dx^2} + \\left( \\frac{\\nu \\Sigma_f - \\Sigma_a}{D} \\right) \\phi(x) = 0\n$$\n\n**1. Solution in the Core Region ($|x|  a$)**\n\nIn the fissile core, the equation is:\n$$\n\\frac{d^2 \\phi_c(x)}{dx^2} + \\left( \\frac{\\nu \\Sigma_{f,c} - \\Sigma_{a,c}}{D_c} \\right) \\phi_c(x) = 0\n$$\nWe define the material buckling of the core, $B_c^2$, as:\n$$\nB_c^2 = \\frac{\\nu \\Sigma_{f,c} - \\Sigma_{a,c}}{D_c}\n$$\nThe problem data implies $\\nu \\Sigma_{f,c}  \\Sigma_{a,c}$, so $B_c^2  0$. The diffusion equation simplifies to:\n$$\n\\frac{d^2 \\phi_c(x)}{dx^2} + B_c^2 \\phi_c(x) = 0\n$$\nThe general solution is $\\phi_c(x) = A_1 \\cos(B_c x) + A_2 \\sin(B_c x)$. The problem specifies a symmetric slab and the fundamental mode, which must be an even function of $x$, i.e., $\\phi_c(x) = \\phi_c(-x)$. This requires the coefficient of the odd sine function to be zero ($A_2=0$). Thus, the core flux is:\n$$\n\\phi_c(x) = A \\cos(B_c x)\n$$\nwhere $A$ is an arbitrary amplitude.\n\n**2. Solution in the Reflector Region ($|x|  a$)**\n\nIn the non-multiplying reflector, $\\nu \\Sigma_{f,r} = 0$. The diffusion equation becomes:\n$$\n\\frac{d^2 \\phi_r(x)}{dx^2} - \\frac{\\Sigma_{a,r}}{D_r} \\phi_r(x) = 0\n$$\nWe define the inverse of the reflector diffusion length squared, $\\kappa_r^2$, as:\n$$\n\\kappa_r^2 = \\frac{\\Sigma_{a,r}}{D_r}\n$$\nwhere $\\kappa_r = 1/L_r$ and $L_r = \\sqrt{D_r/\\Sigma_{a,r}}$ is the diffusion length. The equation in the reflector is:\n$$\n\\frac{d^2 \\phi_r(x)}{dx^2} - \\kappa_r^2 \\phi_r(x) = 0\n$$\nConsidering the region $x  a$, the general solution is $\\phi_r(x) = F_1 e^{-\\kappa_r x} + F_2 e^{\\kappa_r x}$. The boundary condition states that the flux must remain finite as $x \\to \\infty$. This requires the coefficient of the growing exponential term to be zero ($F_2=0$). Therefore, the reflector flux for $xa$ is:\n$$\n\\phi_r(x) = F e^{-\\kappa_r x}\n$$\n\n**3. Interface Conditions and Reflector Boundary Condition**\n\nAt the core-reflector interface ($x=a$), we enforce the continuity of scalar flux and neutron current.\nThe neutron current is given by Fick's law: $J(x) = -D \\frac{d\\phi(x)}{dx}$.\n\nCondition 1: Continuity of flux, $\\phi_c(a) = \\phi_r(a)$.\n$$\nA \\cos(B_c a) = F e^{-\\kappa_r a} \\quad (1)\n$$\n\nCondition 2: Continuity of current, $J_c(a) = J_r(a)$.\n$$\n-D_c \\frac{d\\phi_c}{dx}\\bigg|_{x=a} = -D_r \\frac{d\\phi_r}{dx}\\bigg|_{x=a}\n$$\nThe derivatives are $\\frac{d\\phi_c}{dx} = -A B_c \\sin(B_c x)$ and $\\frac{d\\phi_r}{dx} = -F \\kappa_r e^{-\\kappa_r x}$. Substituting these at $x=a$:\n$$\n-D_c (-A B_c \\sin(B_c a)) = -D_r (-F \\kappa_r e^{-\\kappa_r a})\n$$\n$$\nD_c A B_c \\sin(B_c a) = D_r F \\kappa_r e^{-\\kappa_r a} \\quad (2)\n$$\n\nTo derive the boundary condition for the core region that encapsulates the reflector's effect, we divide equation $(2)$ by equation $(1)$. The unknown amplitudes $A$ and $F$ cancel out:\n$$\n\\frac{D_c A B_c \\sin(B_c a)}{A \\cos(B_c a)} = \\frac{D_r F \\kappa_r e^{-\\kappa_r a}}{F e^{-\\kappa_r a}}\n$$\n$$\nD_c B_c \\tan(B_c a) = D_r \\kappa_r\n$$\nThis equation is the criticality condition for the reflected slab. We can express this as a boundary condition on the core flux $\\phi_c(x)$ at $x=a$. The logarithmic derivative of the core flux at the interface is:\n$$\n\\frac{1}{\\phi_c(a)} \\frac{d\\phi_c}{dx}\\bigg|_{x=a} = \\frac{-A B_c \\sin(B_c a)}{A \\cos(B_c a)} = -B_c \\tan(B_c a)\n$$\nSubstituting the result from the criticality condition, $B_c \\tan(B_c a) = \\frac{D_r \\kappa_r}{D_c}$:\n$$\n\\frac{1}{\\phi_c(a)} \\frac{d\\phi_c}{dx}\\bigg|_{x=a} = -\\frac{D_r \\kappa_r}{D_c}\n$$\nThis is the required boundary condition. It can be written as a Robin-type condition:\n$$\nD_c \\frac{d\\phi_c}{dx}\\bigg|_{x=a} + D_r \\kappa_r \\phi_c(a) = 0\n$$\n\n**4. Derivation of the Reflector Savings, $s$**\n\nThe reflector savings, $s$, is defined as $s = \\tilde{a} - a$, where $\\tilde{a}$ is the extrapolated half-thickness. This is the point where the cosine flux shape from the core would become zero if the core were surrounded by a vacuum. The vacuum boundary condition is $\\phi_c(\\tilde{a})=0$.\nFor the core flux $\\phi_c(x) = A \\cos(B_c x)$, this means $\\cos(B_c \\tilde{a}) = 0$. For the fundamental (first non-negative) zero, this gives:\n$$\nB_c \\tilde{a} = \\frac{\\pi}{2} \\implies \\tilde{a} = \\frac{\\pi}{2 B_c}\n$$\nFrom the definition $s = \\tilde{a} - a$, we have $a = \\tilde{a} - s = \\frac{\\pi}{2B_c} - s$. Thus, $B_c a = \\frac{\\pi}{2} - B_c s$.\n\nWe substitute this expression for $B_c a$ into the criticality condition derived earlier:\n$$\nD_c B_c \\tan\\left(\\frac{\\pi}{2} - B_c s\\right) = D_r \\kappa_r\n$$\nUsing the trigonometric identity $\\tan(\\frac{\\pi}{2} - \\theta) = \\cot(\\theta) = \\frac{1}{\\tan(\\theta)}$, we get:\n$$\nD_c B_c \\frac{1}{\\tan(B_c s)} = D_r \\kappa_r\n$$\nRearranging to solve for $\\tan(B_c s)$:\n$$\n\\tan(B_c s) = \\frac{D_c B_c}{D_r \\kappa_r}\n$$\nThis gives an explicit expression for the reflector savings $s$:\n$$\ns = \\frac{1}{B_c} \\arctan\\left(\\frac{D_c B_c}{D_r \\kappa_r}\\right)\n$$\nwhere $B_c = \\sqrt{(\\nu \\Sigma_{f,c} - \\Sigma_{a,c})/D_c}$ and $\\kappa_r = \\sqrt{\\Sigma_{a,r}/D_r}$.\n\n**5. Numerical Evaluation of $s$**\n\nThe problem provides the following data:\n$D_c = 1.2\\,\\mathrm{cm}$\n$\\Sigma_{a,c} = 8.0 \\times 10^{-3}\\,\\mathrm{cm}^{-1}$\n$\\nu \\Sigma_{f,c} = 2.0 \\times 10^{-2}\\,\\mathrm{cm}^{-1}$\n$D_r = 1.6\\,\\mathrm{cm}$\n$\\Sigma_{a,r} = 2.5 \\times 10^{-3}\\,\\mathrm{cm}^{-1}$\n\nFirst, we compute the material buckling $B_c$ for the core:\n$$\nB_c^2 = \\frac{\\nu \\Sigma_{f,c} - \\Sigma_{a,c}}{D_c} = \\frac{(2.0 \\times 10^{-2} - 8.0 \\times 10^{-3}) \\, \\mathrm{cm}^{-1}}{1.2 \\, \\mathrm{cm}} = \\frac{1.2 \\times 10^{-2} \\, \\mathrm{cm}^{-1}}{1.2 \\, \\mathrm{cm}} = 1.0 \\times 10^{-2} \\, \\mathrm{cm}^{-2}\n$$\n$$\nB_c = \\sqrt{1.0 \\times 10^{-2} \\, \\mathrm{cm}^{-2}} = 0.1 \\, \\mathrm{cm}^{-1}\n$$\n\nNext, we compute the inverse diffusion length $\\kappa_r$ for the reflector:\n$$\n\\kappa_r^2 = \\frac{\\Sigma_{a,r}}{D_r} = \\frac{2.5 \\times 10^{-3} \\, \\mathrm{cm}^{-1}}{1.6 \\, \\mathrm{cm}} = 1.5625 \\times 10^{-3} \\, \\mathrm{cm}^{-2}\n$$\n$$\n\\kappa_r = \\sqrt{1.5625 \\times 10^{-3} \\, \\mathrm{cm}^{-2}} \\approx 0.03952847 \\, \\mathrm{cm}^{-1}\n$$\n\nNow, we calculate the argument of the arctangent function:\n$$\n\\frac{D_c B_c}{D_r \\kappa_r} = \\frac{(1.2 \\, \\mathrm{cm})(0.1 \\, \\mathrm{cm}^{-1})}{(1.6 \\, \\mathrm{cm})(0.03952847 \\, \\mathrm{cm}^{-1})} = \\frac{0.12}{0.06324555} \\approx 1.8973666\n$$\n\nFinally, we compute the reflector savings $s$. Note that the output of the arctangent function must be in radians.\n$$\ns = \\frac{1}{0.1 \\, \\mathrm{cm}^{-1}} \\arctan(1.8973666) \\approx (10 \\, \\mathrm{cm}) \\times (1.08588 \\, \\mathrm{rad})\n$$\n$$\ns \\approx 10.8588 \\, \\mathrm{cm}\n$$\nRounding the result to four significant figures as requested:\n$$\ns \\approx 10.86 \\, \\mathrm{cm}\n$$",
            "answer": "$$\\boxed{10.86}$$"
        },
        {
            "introduction": "Analytical solutions to the diffusion equation are elegant but limited to simple, idealized cases. To analyze realistic, complex reactor designs, we must turn to numerical methods, which form the heart of modern reactor simulation codes. This hands-on coding exercise introduces the nodal method, a powerful technique for solving the diffusion equation over a coarse spatial mesh . By implementing a Coarse Mesh Finite Difference (CMFD) scheme to solve for the neutron flux in a heterogeneous slab, you will bridge the gap between continuous-space theory and the discrete computational models used in practical engineering.",
            "id": "4222190",
            "problem": "Consider the one-dimensional, steady-state, single-energy-group neutron diffusion equation in a slab with piecewise-constant material properties over non-overlapping nodes. The governing equation is the conservation form derived from fundamental transport theory and Fick's law:\n$$ -D(x)\\frac{d^2\\phi(x)}{dx^2} + \\Sigma_a(x)\\phi(x) = Q(x), $$\nwhere $D(x)$ is the diffusion coefficient, $\\Sigma_a(x)$ is the macroscopic absorption cross section, $\\phi(x)$ is the scalar neutron flux, and $Q(x)$ is a fixed volumetric source. The boundary conditions are reflective at both ends of the slab, which enforce zero net current at the boundaries. In one dimension, the neutron current $J(x)$ satisfies Fick's law $J(x) = -D(x)\\frac{d\\phi(x)}{dx}$, so the reflective boundary conditions imply $J(x_{\\text{left}}) = 0$ and $J(x_{\\text{right}}) = 0$.\n\nUsing the nodal diffusion approach, integrate the governing equation over each node $i$ of width $h_i$ to obtain a nodal balance:\n$$\\Sigma_{a,i}h_i\\bar{\\phi}_i + \\left(J_{i+\\frac{1}{2}} - J_{i-\\frac{1}{2}}\\right) = Q_ih_i,$$\nwhere $\\bar{\\phi}_i$ is the node-average scalar flux, $\\Sigma_{a,i}$, $D_i$, and $Q_i$ are the constants in node $i$, and $J_{i\\pm\\frac{1}{2}}$ denote interface currents at the right ($i+\\frac{1}{2}$) and left ($i-\\frac{1}{2}$) faces of node $i$ with sign convention positive to the right. For the reflective boundaries, set $J_{\\frac{1}{2}} = 0$ and $J_{N+\\frac{1}{2}} = 0$ for a slab with $N$ nodes.\n\nAdopt a coarse-mesh approximation consistent with the nodal balance by modeling interface currents using the two-point resistance model (a standard result in Coarse Mesh Finite Difference (CMFD) methods), which follows from Fick's law and continuity of current across the interface. Define the half-node resistances at the interface between node $i$ and node $i+1$ as $r_i = \\frac{h_i}{2D_i}$ and $r_{i+1} = \\frac{h_{i+1}}{2D_{i+1}}$, and the total interface resistance as\n$$R_{i+\\frac{1}{2}} = r_i + r_{i+1} = \\frac{h_i}{2D_i} + \\frac{h_{i+1}}{2D_{i+1}}.$$\nThen the interface current is approximated by\n$$J_{i+\\frac{1}{2}} = -\\frac{\\bar{\\phi}_{i+1} - \\bar{\\phi}_i}{R_{i+\\frac{1}{2}}}.$$\nThis yields the following linear system for the unknown node-average fluxes $\\bar{\\phi}_i$:\n$$\\left(\\Sigma_{a,i}h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i - \\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} - \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1} = Q_ih_i,$$\nwith the conventions $\\frac{1}{R_{\\frac{1}{2}}} = 0$ and $\\frac{1}{R_{N+\\frac{1}{2}}} = 0$ to enforce reflective boundaries. Solve this system to obtain $\\bar{\\phi}_i$ for each node.\n\nYour task is to write a complete program that constructs and solves the above coarse-mesh nodal system for a set of test cases. The program must produce, for each test case, the list of node-average scalar fluxes $\\bar{\\phi}_i$ in units of neutrons per square centimeter per second, written as $\\text{n}/(\\text{cm}^2\\cdot\\text{s})$, with each value rounded to $6$ decimal places. All input parameters are given in scientifically sound units: $h_i$ in cm, $D_i$ in cm, $\\Sigma_{a,i}$ in $\\text{cm}^{-1}$, and $Q_i$ in $\\text{n}/(\\text{cm}^3\\cdot\\text{s})$.\n\nImplement the solution for the following test suite:\n- Test case $1$: $h=[10,10,10]\\,\\text{cm}$, $D=[1.0,1.0,1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1,0.1,0.1]\\,\\text{cm}^{-1}$, $Q=[0.5,0.5,0.5]\\,\\text{n}/(\\text{cm}^3\\cdot\\text{s})$.\n- Test case $2$: $h=[10,10,10]\\,\\text{cm}$, $D=[1.0,1.0,1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1,1.0,0.1]\\,\\text{cm}^{-1}$, $Q=[0.5,0.5,0.5]\\,\\text{n}/(\\text{cm}^3\\cdot\\text{s})$.\n- Test case $3$: $h=[5,20,5,20]\\,\\text{cm}$, $D=[1.0,0.5,1.5,1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1,0.2,0.05,0.15]\\,\\text{cm}^{-1}$, $Q=[0.0,2.0,0.0,0.0]\\,\\text{n}/(\\text{cm}^3\\cdot\\text{s})$.\n- Test case $4$: $h=[10]\\,\\text{cm}$, $D=[1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1]\\,\\text{cm}^{-1}$, $Q=[0.5]\\,\\text{n}/(\\text{cm}^3\\cdot\\text{s})$.\n\nFor example, the output format must be of the form `[ [result_case_1], [result_case_2], ... ]`, with no additional text.",
            "solution": "The user wants me to solve a one-dimensional, steady-state, single-energy-group neutron diffusion problem using a coarse-mesh nodal method.\n\nHere's my plan:\n1.  **Validate the problem statement.**\n    -   Extract all the given information.\n    -   Check for scientific soundness, completeness, consistency, and other validity criteria.\n2.  **If valid, develop a solution strategy.**\n    -   The problem explicitly provides the system of linear equations to be solved:\n        $$A\\bar{\\phi} = b$$\n        where $\\bar{\\phi}$ is the vector of unknown node-average fluxes $[\\bar{\\phi}_1, \\bar{\\phi}_2, \\ldots, \\bar{\\phi}_N]^T$.\n    -   I need to construct the matrix $A$ and the vector $b$ for a general case with $N$ nodes.\n    -   The vector $b$ (the right-hand side) is straightforward: $b_i = Q_i h_i$.\n    -   The matrix $A$ is tridiagonal. The equation for node $i$ is:\n        $$\\left(\\Sigma_{a,i}\\,h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i - \\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} - \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1} = Q_i\\,h_i$$\n    -   So, the matrix elements are:\n        -   Diagonal term $A_{i,i} = \\Sigma_{a,i}\\,h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}$.\n        -   Super-diagonal term $A_{i, i+1} = -\\frac{1}{R_{i+\\frac{1}{2}}}$.\n        -   Sub-diagonal term $A_{i, i-1} = -\\frac{1}{R_{i-\\frac{1}{2}}}$.\n    -   The boundary conditions (reflective) are handled by setting $J_{1/2} = 0$ and $J_{N+1/2} = 0$. This is equivalent to setting the corresponding coupling coefficients to zero. The problem statement gives the convention: $\\frac{1}{R_{1/2}} = 0$ and $\\frac{1}{R_{N+1/2}} = 0$.\n    -   Let's check the equations for the first and last nodes.\n        -   For node $i=1$:\n            $$(\\Sigma_{a,1} h_1 + \\frac{1}{R_{3/2}} + \\frac{1}{R_{1/2}})\\bar{\\phi}_1 - \\frac{1}{R_{3/2}}\\bar{\\phi}_2 - \\frac{1}{R_{1/2}}\\bar{\\phi}_0 = Q_1 h_1$$\n            Using the convention $\\frac{1}{R_{1/2}}=0$, this simplifies to:\n            $$(\\Sigma_{a,1} h_1 + \\frac{1}{R_{3/2}})\\bar{\\phi}_1 - \\frac{1}{R_{3/2}}\\bar{\\phi}_2 = Q_1 h_1$$\n            This is correct.\n            $A_{1,1} = \\Sigma_{a,1} h_1 + \\frac{1}{R_{3/2}}$\n            $A_{1,2} = -\\frac{1}{R_{3/2}}$\n        -   For node $i=N$:\n            $$(\\Sigma_{a,N} h_N + \\frac{1}{R_{N+1/2}} + \\frac{1}{R_{N-1/2}})\\bar{\\phi}_N - \\frac{1}{R_{N+1/2}}\\bar{\\phi}_{N+1} - \\frac{1}{R_{N-1/2}}\\bar{\\phi}_{N-1} = Q_N h_N$$\n            Using the convention $\\frac{1}{R_{N+1/2}}=0$, this simplifies to:\n            $$(\\Sigma_{a,N} h_N + \\frac{1}{R_{N-1/2}})\\bar{\\phi}_N - \\frac{1}{R_{N-1/2}}\\bar{\\phi}_{N-1} = Q_N h_N$$\n            This is also correct.\n            $A_{N,N} = \\Sigma_{a,N} h_N + \\frac{1}{R_{N-1/2}}$\n            $A_{N, N-1} = -\\frac{1}{R_{N-1/2}}$\n    -   The interface resistance $R_{i+1/2}$ is defined as:\n        $$R_{i+\\frac{1}{2}} = \\frac{h_i}{2\\,D_i} + \\frac{h_{i+1}}{2\\,D_{i+1}}$$\n        for $i = 1, \\dots, N-1$.\n3.  **Implement the solution in Python.**\n    -   The plan is to loop through each test case.\n    -   Inside the loop, for a given test case with $N$ nodes and parameters $h, D, \\Sigma_a, Q$:\n        a.  Initialize an $N \\times N$ matrix `A` with zeros and an $N \\times 1$ vector `b` with zeros.\n        b.  Construct the right-hand side vector `b`: `b[i] = Q[i] * h[i]`.\n        c.  Construct the matrix `A`. This is the core part. I need to iterate from `i = 0` to `N-1` (using 0-based indexing for Python).\n            -   For `i` from `0` to `N-1`:\n                -   Calculate the loss term: `A[i, i] += Sigma_a[i] * h[i]`.\n            -   For interfaces `i` from `0` to `N-2` (corresponding to interfaces $1+1/2$ to $N-1+1/2$):\n                -   Calculate `R_interface = h[i]/(2*D[i]) + h[i+1]/(2*D[i+1])`.\n                -   Calculate the coupling coefficient `C = 1 / R_interface`.\n                -   Add to diagonal terms: `A[i, i] += C` and `A[i+1, i+1] += C`.\n                -   Set off-diagonal terms: `A[i, i+1] = -C` and `A[i+1, i] = -C`.\n        d.  Solve the linear system `A @ phi_bar = b` for `phi_bar`. `numpy.linalg.solve(A, b)` is the perfect tool for this.\n        e.  Round the results to 6 decimal places.\n        f.  Store the resulting list of fluxes.\n    -   After the loop, format the collected results into the required string format.\n\n4.  **Double-check the test cases.**\n\n    -   **Test Case 1:** $N=3$, homogeneous.\n        -   $h = [10, 10, 10]$, $D=[1.0, 1.0, 1.0]$, $\\Sigma_a=[0.1, 0.1, 0.1]$, $Q=[0.5, 0.5, 0.5]$.\n        -   $b_1 = 0.5 \\times 10 = 5$. $b_2 = 5$. $b_3 = 5$. So $b = [5, 5, 5]^T$.\n        -   Interface resistances:\n            -   $R_{1+1/2} = R_{3/2} = \\frac{10}{2 \\times 1} + \\frac{10}{2 \\times 1} = 5 + 5 = 10$.\n            -   $R_{2+1/2} = R_{5/2} = \\frac{10}{2 \\times 1} + \\frac{10}{2 \\times 1} = 5 + 5 = 10$.\n        -   Coupling coefficients:\n            -   $C_{3/2} = 1/10 = 0.1$.\n            -   $C_{5/2} = 1/10 = 0.1$.\n        -   System of equations:\n            -   Node 1: $(\\Sigma_{a,1}h_1 + C_{3/2})\\bar{\\phi}_1 - C_{3/2}\\bar{\\phi}_2 = Q_1 h_1$\n                $(0.1 \\times 10 + 0.1)\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5 \\implies 1.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5$.\n            -   Node 2: $(\\Sigma_{a,2}h_2 + C_{3/2} + C_{5/2})\\bar{\\phi}_2 - C_{3/2}\\bar{\\phi}_1 - C_{5/2}\\bar{\\phi}_3 = Q_2 h_2$\n                $(0.1 \\times 10 + 0.1 + 0.1)\\bar{\\phi}_2 - 0.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_3 = 5 \\implies -0.1\\bar{\\phi}_1 + 1.2\\bar{\\phi}_2 - 0.1\\bar{\\phi}_3 = 5$.\n            -   Node 3: $(\\Sigma_{a,3}h_3 + C_{5/2})\\bar{\\phi}_3 - C_{5/2}\\bar{\\phi}_2 = Q_3 h_3$\n                $(0.1 \\times 10 + 0.1)\\bar{\\phi}_3 - 0.1\\bar{\\phi}_2 = 5 \\implies -0.1\\bar{\\phi}_2 + 1.1\\bar{\\phi}_3 = 5$.\n        -   Matrix `A`:\n            $$\n            \\begin{pmatrix}\n            1.1  -0.1  0 \\\\\n            -0.1  1.2  -0.1 \\\\\n            0  -0.1  1.1\n            \\end{pmatrix}\n            $$\n        -   The system is symmetric, which is expected.\n        -   Let's solve it. By symmetry, $\\bar{\\phi}_1 = \\bar{\\phi}_3$.\n            -   $1.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5 \\implies \\bar{\\phi}_2 = 11\\bar{\\phi}_1 - 50$.\n            -   $-0.1\\bar{\\phi}_1 + 1.2\\bar{\\phi}_2 - 0.1\\bar{\\phi}_1 = 5 \\implies -0.2\\bar{\\phi}_1 + 1.2\\bar{\\phi}_2 = 5$.\n            -   Substitute $\\bar{\\phi}_2$: $-0.2\\bar{\\phi}_1 + 1.2(11\\bar{\\phi}_1 - 50) = 5$.\n            -   $-0.2\\bar{\\phi}_1 + 13.2\\bar{\\phi}_1 - 60 = 5$.\n            -   $13.0\\bar{\\phi}_1 = 65 \\implies \\bar{\\phi}_1 = 5$.\n            -   Then $\\bar{\\phi}_3 = 5$.\n            -   $\\bar{\\phi}_2 = 11(5) - 50 = 55 - 50 = 5$.\n        -   So, the solution for case 1 is $[\\bar{\\phi}_1, \\bar{\\phi}_2, \\bar{\\phi}_3] = [5.0, 5.0, 5.0]$. This makes sense: a uniform system with uniform source and reflective boundaries should have a flat flux profile.\n\n    -   **Test Case 4:** $N=1$, single node sanity check.\n        -   $h=[10]$, $D=[1.0]$, $\\Sigma_a=[0.1]$, $Q=[0.5]$.\n        -   The system is $1 \\times 1$.\n        -   The equation for node 1 is:\n            $(\\Sigma_{a,1} h_1 + \\frac{1}{R_{3/2}} + \\frac{1}{R_{1/2}})\\bar{\\phi}_1 - \\dots = Q_1 h_1$.\n        -   Since $N=1$, the conventions $\\frac{1}{R_{1/2}}=0$ and $\\frac{1}{R_{N+1/2}} = \\frac{1}{R_{3/2}}=0$ apply.\n        -   The equation simplifies to $\\Sigma_{a,1} h_1 \\bar{\\phi}_1 = Q_1 h_1$.\n        -   $(0.1 \\times 10) \\bar{\\phi}_1 = 0.5 \\times 10$.\n        -   $1.0 \\bar{\\phi}_1 = 5.0 \\implies \\bar{\\phi}_1 = 5.0$.\n        -   So, the solution for case 4 is $[5.0]$. This also makes perfect sense. In an infinite medium (which is what reflective boundaries on a single node imply), the flux is simply $Q/\\Sigma_a$. Here, $\\barphi} = 0.5 / 0.1 = 5.0$. The nodal balance equation correctly reproduces this.\n\n    - **Test Case 2:** $N=3$, heterogeneous absorption.\n        - $h = [10, 10, 10]$, $D=[1.0, 1.0, 1.0]$, $\\Sigma_a=[0.1, 1.0, 0.1]$, $Q=[0.5, 0.5, 0.5]$.\n        - $b = [5, 5, 5]^T$.\n        - Interface resistances are the same as case 1: $R_{3/2} = 10, R_{5/2} = 10$.\n        - Coupling coefficients are the same: $C_{3/2} = 0.1, C_{5/2} = 0.1$.\n        - System of equations:\n            - Node 1: $(\\Sigma_{a,1}h_1 + C_{3/2})\\bar{\\phi}_1 - C_{3/2}\\bar{\\phi}_2 = Q_1 h_1$\n                $(0.1 \\times 10 + 0.1)\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5 \\implies 1.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5$.\n            - Node 2: $(\\Sigma_{a,2}h_2 + C_{3/2} + C_{5/2})\\bar{\\phi}_2 - C_{3/2}\\bar{\\phi}_1 - C_{5/2}\\bar{\\phi}_3 = Q_2 h_2$\n                $(1.0 \\times 10 + 0.1 + 0.1)\\bar{\\phi}_2 - 0.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_3 = 5 \\implies -0.1\\bar{\\phi}_1 + 10.2\\bar{\\phi}_2 - 0.1\\bar{\\phi}_3 = 5$.\n            - Node 3: $(\\Sigma_{a,3}h_3 + C_{5/2})\\bar{\\phi}_3 - C_{5/2}\\bar{\\phi}_2 = Q_3 h_3$\n                $(0.1 \\times 10 + 0.1)\\bar{\\phi}_3 - 0.1\\bar{\\phi}_2 = 5 \\implies -0.1\\bar{\\phi}_2 + 1.1\\bar{\\phi}_3 = 5$.\n        - Matrix A:\n            $$\n            \\begin{pmatrix}\n            1.1  -0.1  0 \\\\\n            -0.1  10.2  -0.1 \\\\\n            0  -0.1  1.1\n            \\end{pmatrix}\n            $$\n        - By symmetry, $\\bar{\\phi}_1 = \\bar{\\phi}_3$.\n            - $1.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5 \\implies \\bar{\\phi}_2 = 11\\bar{\\phi}_1 - 50$.\n            - $-0.1\\bar{\\phi}_1 + 10.2\\bar{\\phi}_2 - 0.1\\bar{\\phi}_1 = 5 \\implies -0.2\\bar{\\phi}_1 + 10.2\\bar{\\phi}_2 = 5$.\n            - Substitute $\\bar{\\phi}_2$: $-0.2\\bar{\\phi}_1 + 10.2(11\\bar{\\phi}_1 - 50) = 5$.\n            - $-0.2\\bar{\\phi}_1 + 112.2\\bar{\\phi}_1 - 510 = 5$.\n            - $112.0\\bar{\\phi}_1 = 515$.\n            - $\\bar{\\phi}_1 = 515 / 112 \\approx 4.598214...$\n            - $\\bar{\\phi}_3 = \\bar{\\phi}_1 \\approx 4.598214...$\n            - $\\bar{\\phi}_2 = 11(515/112) - 50 = (5665 - 5600)/112 = 65/112 \\approx 0.580357...$\n        - This makes physical sense. The high absorption in the center node drastically depresses the flux there, while the flux in the outer nodes is higher.\n\n    - **Test Case 3:** $N=4$, heterogeneous, localized source.\n        - $h=[5, 20, 5, 20]$, $D=[1.0, 0.5, 1.5, 1.0]$, $\\Sigma_a=[0.1, 0.2, 0.05, 0.15]$, $Q=[0.0, 2.0, 0.0, 0.0]$.\n        - RHS vector $b$:\n            - $b_1 = Q_1 h_1 = 0.0 \\times 5 = 0$.\n            - $b_2 = Q_2 h_2 = 2.0 \\times 20 = 40$.\n            - $b_3 = Q_3 h_3 = 0.0 \\times 5 = 0$.\n            - $b_4 = Q_4 h_4 = 0.0 \\times 20 = 0$.\n            - $b = [0, 40, 0, 0]^T$.\n        - Interface resistances:\n            - $R_{3/2} = \\frac{h_1}{2D_1} + \\frac{h_2}{2D_2} = \\frac{5}{2(1.0)} + \\frac{20}{2(0.5)} = 2.5 + 20 = 22.5$.\n            - $R_{5/2} = \\frac{h_2}{2D_2} + \\frac{h_3}{2D_3} = \\frac{20}{2(0.5)} + \\frac{5}{2(1.5)} = 20 + 5/3 \\approx 20 + 1.6666... = 21.6666... = 65/3$.\n            - $R_{7/2} = \\frac{h_3}{2D_3} + \\frac{h_4}{2D_4} = \\frac{5}{2(1.5)} + \\frac{20}{2(1.0)} = 5/3 + 10 \\approx 1.6666... + 10 = 11.6666... = 35/3$.\n        - Coupling coefficients:\n            - $C_{3/2} = 1 / 22.5 = 1 / (45/2) = 2/45 \\approx 0.0444...$\n            - $C_{5/2} = 1 / (65/3) = 3/65 \\approx 0.04615...$\n            - $C_{7/2} = 1 / (35/3) = 3/35 \\approx 0.08571...$\n        - Matrix A diagonals:\n            - $A_{1,1} = \\Sigma_{a,1}h_1 + C_{3/2} = 0.1 \\times 5 + 2/45 = 0.5 + 2/45 = 45/90 + 4/90 = 49/90 \\approx 0.5444...$\n            - $A_{2,2} = \\Sigma_{a,2}h_2 + C_{3/2} + C_{5/2} = 0.2 \\times 20 + 2/45 + 3/65 = 4 + 2/45 + 3/65 = 4 + (26+27)/585 = 4 + 53/585 \\approx 4.0906...$\n            - $A_{3,3} = \\Sigma_{a,3}h_3 + C_{5/2} + C_{7/2} = 0.05 \\times 5 + 3/65 + 3/35 = 0.25 + 3/65 + 3/35 = 1/4 + 3((35+65)/(65 \\times 35)) = 1/4 + 3(100/2275) = 1/4 + 300/2275 = 1/4 + 12/91 = (91+48)/364 = 139/364 \\approx 0.3818...$\n            - $A_{4,4} = \\Sigma_{a,4}h_4 + C_{7/2} = 0.15 \\times 20 + 3/35 = 3 + 3/35 = (105+3)/35 = 108/35 \\approx 3.0857...$\n        - Matrix A:\n            $$\n            \\begin{pmatrix}\n            A_{1,1}  -C_{3/2}  0  0 \\\\\n            -C_{3/2}  A_{2,2}  -C_{5/2}  0 \\\\\n            0  -C_{5/2}  A_{3,3}  -C_{7/2} \\\\\n            0  0  -C_{7/2}  A_{4,4}\n            \\end{pmatrix}\n            $$\n            $$\n            \\begin{pmatrix}\n            0.5444...  -0.0444...  0  0 \\\\\n            -0.0444...  4.0906...  -0.04615...  0 \\\\\n            0  -0.04615...  0.3818...  -0.08571... \\\\\n            0  0  -0.08571...  3.0857...\n            \\end{pmatrix}\n            $$\n        - This will be solved numerically by `numpy.linalg.solve`. It looks complicated to do by hand, but the setup is sound.\n\nThe logic seems correct. I will proceed with the implementation.\nThe final output format is a list of lists.\n`[[...], [...], [...], [...]]`\nMy code structure should be:\n```python\ndef solve():\n    test_cases = [ (params1), (params2), ... ]\n    all_results = []\n    for case in test_cases:\n        N, h, D, Sigma_a, Q = case\n        # ... construct A and b as numpy arrays\n        # ... phi_bar = np.linalg.solve(A, b)\n        # ... round results\n        # ... all_results.append(rounded_phi_bar_list)\n    # print final formatted string\n```\n\nWait, `scipy` is listed as an available library. For a tridiagonal system, `scipy.linalg.solve_banded` would be more efficient, but `numpy.linalg.solve` is perfectly fine and likely simpler to implement robustly for this problem size. Given `N` is very small (3 or 4), the performance difference is negligible. I'll stick with `numpy.linalg.solve`.\n\nThe final output needs to be a string. I can build the list of lists in Python and then use `json.dumps` or a custom string formatting function. The requested format is `[[],[],[]]`, which is exactly what `str()` on a list of lists would produce, but maybe with some spacing differences. Let's look at the example: `[[,...],,[...],...]`. This looks like a typo, with extra commas. The code's output format is much more standard and likely what is intended. I will assume the code's interpretation is correct.\nExample from problem: `print(f\"[{','.join(map(str, results))}]\")`\nMy `results` will be `[ [1, 2], [3, 4] ]`. `map(str, results)` will be `['[1, 2]', '[3, 4]']`. `','.join(...)` will be `[1, 2],[3, 4]`. Prepending `[` and appending `]` will give `[[1, 2],[3, 4]]`. This looks correct. I need to make sure the inner lists are also stringified correctly, but `str()` on a list does that automatically.\n\nLet's refine the implementation logic.\n```python\ndef solve_system(N, h, D, Sigma_a, Q):\n    # Convert inputs to numpy arrays for easier math\n    h = np.array(h)\n    D = np.array(D)\n    Sigma_a = np.array(Sigma_a)\n    Q = np.array(Q)\n    \n    A = np.zeros((N, N))\n    b = np.zeros(N)\n    \n    # Fill RHS vector b\n    b = Q * h\n    \n    # Fill diagonal terms from absorption\n    np.fill_diagonal(A, Sigma_a * h)\n    \n    # Handle the N=1 case separately to avoid index errors\n    if N == 1:\n        # No coupling, matrix is already correct\n        pass\n    else:\n        # Fill coupling terms (off-diagonals and additions to diagonal)\n        for i in range(N - 1):\n            # i is the index of the left node, i+1 is the right node\n            R_interface = (h[i] / (2 * D[i])) + (h[i+1] / (2 * D[i+1]))\n            C = 1.0 / R_interface\n            \n            # Add to diagonals\n            A[i, i] += C\n            A[i+1, i+1] += C\n            \n            # Set off-diagonals\n            A[i, i+1] = -C\n            A[i+1, i] = -C\n            \n    # Solve the system\n    phi_bar = np.linalg.solve(A, b)\n    \n    # Round and convert to list\n    return [round(x, 6) for x in phi_bar]\n\n# main part\n# loop through test cases\n# call solve_system for each\n# collect results\n# format and print\n```\nThis looks solid. The logic handles the $N=1$ case correctly. If $N=1$, the `range(N-1)` is `range(0)`, which is empty, so the coupling loop is skipped. The matrix `A` will be `[[Sigma_a[0]*h[0]]]` and `b` will be `[Q[0]*h[0]]`. The solution is `b[0]/A[0,0]`, which is `Q[0]/Sigma_a[0]`. This matches my manual calculation for case 4.\n\nThe problem statement requires **every mathematical entity** be in LaTeX. I should be careful to follow this.\n\n---\n## Start of formal process.\n\n### Problem Validation\n\n#### Step 1: Extract Givens\n\n-   Governing Equation: $-D(x)\\frac{d^2\\phi(x)}{dx^2} + \\Sigma_a(x)\\,\\phi(x) = Q(x)$\n-   Variables:\n    -   $D(x)$: diffusion coefficient ($\\text{cm}$)\n    -   $\\Sigma_a(x)$: macroscopic absorption cross section ($\\text{cm}^{-1}$)\n    -   $\\phi(x)$: scalar neutron flux ($n/\\left(\\text{cm}^2\\cdot\\text{s}\\right)$)\n    -   $Q(x)$: fixed volumetric source ($n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$)\n-   Boundary Conditions: Reflective at both ends, $J(x_{\\text{left}}) = 0$ and $J(x_{\\text{right}}) = 0$.\n-   Fick's Law: $J(x) = -D(x)\\,d\\phi(x)/dx$.\n-   Nodal Balance Equation for node $i$: $\\Sigma_{a,i}\\,h_i\\,\\bar{\\phi}_i + \\left(J_{i+\\frac{1}{2}} - J_{i-\\frac{1}{2}}\\right) = Q_i\\,h_i$.\n    -   $h_i$: width of node $i$ ($\\text{cm}$)\n    -   $\\bar{\\phi}_i$: node-average scalar flux in node $i$\n    -   $\\Sigma_{a,i}, D_i, Q_i$: constant material properties in node $i$\n    -   $J_{i\\pm\\frac{1}{2}}$: interface currents\n-   Boundary Currents: For $N$ nodes, $J_{\\frac{1}{2}} = 0$ and $J_{N+\\frac{1}{2}} = 0$.\n-   Interface Resistance Model (CMFD):\n    -   Total interface resistance: $R_{i+\\frac{1}{2}} = \\frac{h_i}{2\\,D_i} + \\frac{h_{i+1}}{2\\,D_{i+1}}$.\n    -   Interface current approximation: $J_{i+\\frac{1}{2}} = -\\frac{\\bar{\\phi}_{i+1} - \\bar{\\phi}_i}{R_{i+\\frac{1}{2}}}$.\n-   Final Linear System for node-average fluxes $\\bar{\\phi}_i$:\n    $$\\left(\\Sigma_{a,i}\\,h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i - \\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} - \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1} = Q_i\\,h_i$$\n-   Boundary Conventions for the linear system: $\\frac{1}{R_{\\frac{1}{2}}} = 0$ and $\\frac{1}{R_{N+\\frac{1}{2}}} = 0$.\n-   Test Cases:\n    1.  $N=3$, $h=[10,10,10]\\,\\text{cm}$, $D=[1.0,1.0,1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1,0.1,0.1]\\,\\text{cm}^{-1}$, $Q=[0.5,0.5,0.5]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$.\n    2.  $N=3$, $h=[10,10,10]\\,\\text{cm}$, $D=[1.0,1.0,1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1,1.0,0.1]\\,\\text{cm}^{-1}$, $Q=[0.5,0.5,0.5]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$.\n    3.  $N=4$, $h=[5,20,5,20]\\,\\text{cm}$, $D=[1.0,0.5,1.5,1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1,0.2,0.05,0.15]\\,\\text{cm}^{-1}$, $Q=[0.0,2.0,0.0,0.0]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$.\n    4.  $N=1`, $h=[10]\\,\\text{cm}$, $D=[1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1]\\,\\text{cm}^{-1}$, $Q=[0.5]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$.\n-   Output Requirement: A single line string `[ [flux_list_1], [flux_list_2], ... ]`, with flux values rounded to 6 decimal places.\n\n#### Step 2: Validate Using Extracted Givens\n\n1.  **Scientifically Grounded**: The problem is based on the one-group neutron diffusion equation, a cornerstone of nuclear reactor physics. The derivation of the nodal balance equation by integrating the differential form is a standard procedure. The use of a CMFD-like approximation for interface currents is a well-established and widely used technique in nodal diffusion methods for reactor analysis. The physics is sound. All parameters and their units are physically correct and consistent. The problem is firmly grounded in reactor physics and numerical methods.\n2.  **Well-Posed**: The problem asks to solve a system of linear equations of the form $A\\bar{\\phi} = b$. The resulting matrix $A$ is a symmetric, positive-definite matrix (specifically, it's a diagonally dominant Stieltjes matrix), which guarantees a unique and stable solution. The problem is well-posed.\n3.  **Objective**: The problem is stated in precise mathematical and physical terms. The task is to implement a specific numerical method and apply it to clearly defined test cases. There is no subjectivity or ambiguity.\n4.  **Scientific or Factual Unsoundness**: No flaws. The physics and mathematics are standard and correct.\n5.  **Non-Formalizable or Irrelevant**: No flaws. The problem is a formal numerical task directly relevant to the topic of diffusion theory in nuclear reactor simulation.\n6.  **Incomplete or Contradictory Setup**: No flaws. All necessary equations, parameters, boundary conditions, and test data are provided. The formulation is self-consistent. The convention for handling boundary conditions is explicitly stated.\n7.  **Unrealistic or Infeasible**: No flaws. The parameter values are physically plausible for reactor materials. The computations are feasible.\n8.  **Ill-Posed or Poorly Structured**: No flaws. As discussed, the resulting linear system is well-conditioned and has a unique solution.\n9.  **Pseudo-Profound, Trivial, or Tautological**: No flaws. The problem requires the non-trivial assembly and solution of a specific numerical scheme. While the test cases are small, they are representative and sufficient to test the implementation of the core logic. The single-node case serves as a useful sanity check.\n10. **Outside Scientific Verifiability**: No flaws. The results can be independently verified by re-implementing the algorithm or solving the linear systems manually or with other software.\n\n#### Step 3: Verdict and Action\n\nThe problem is **valid**. I will proceed to the solution.\n\n---\n### Solution Development\n\nThe task is to solve a system of linear equations $A\\bar{\\phi} = b$ for the vector of node-average fluxes $\\bar{\\phi} = [\\bar{\\phi}_1, \\ldots, \\bar{\\phi}_N]^T$. The problem statement provides the stencil for the $i$-th equation:\n$$\\left(\\Sigma_{a,i}\\,h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i - \\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} - \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1} = Q_i\\,h_i$$\n\nHere, the indices for $\\bar{\\phi}$ are 1-based, from $1$ to $N$. The matrix $A$ is an $N \\times N$ tridiagonal matrix, and $b$ is a vector of length $N$.\n\nLet's define the matrix elements $A_{ij}$ and vector elements $b_i$ using 0-based indexing for implementation, where $i, j \\in \\{0, 1, \\dots, N-1\\}$. The $i$-th row of the system corresponds to the balance equation for node $i+1$.\n\n1.  **Right-Hand Side (RHS) Vector, $b$**:\n    For each node $i \\in \\{0, \\dots, N-1\\}$, the RHS is the integrated source term.\n    $$b_i = Q_{i+1}\\,h_{i+1}$$\n    In array notation, this is simply $b_i = Q_i h_i$.\n\n2.  **System Matrix, $A$**:\n    The matrix $A$ is composed of two parts: a diagonal part from neutron removal (absorption) within each node, and a tridiagonal part from neutron leakage (currents) between adjacent nodes.\n\n    -   **Removal/Loss Term (Diagonal)**: The term $\\Sigma_{a,i}\\,h_i\\,\\bar{\\phi}_i$ contributes to the diagonal of the matrix. For node $i+1$ (0-indexed $i$), this is $\\Sigma_{a,i+1}\\,h_{i+1}$.\n        $$A_{ii}^{\\text{loss}} = \\Sigma_{a,i+1}\\,h_{i+1}$$\n\n    -   **Leakage/Coupling Term (Tridiagonal)**: The terms related to interface currents $J_{i\\pm\\frac{1}{2}}$ form the coupling between nodes. The current between node $i$ and node $i+1$ is $J_{i+\\frac{1}{2}} = -\\frac{\\bar{\\phi}_{i+1} - \\bar{\\phi}_i}{R_{i+\\frac{1}{2}}} = C_{i+\\frac{1}{2}}(\\bar{\\phi}_i - \\bar{\\phi}_{i+1})$, where $C_{i+\\frac{1}{2}} = 1 / R_{i+\\frac{1}{2}}$ is the coupling coefficient.\n        The net leakage for node $i$ (1-indexed) is $J_{i+\\frac{1}{2}} - J_{i-\\frac{1}{2}}$.\n        This term becomes $C_{i-\\frac{1}{2}}(\\bar{\\phi}_{i-1} - \\bar{\\phi}_i) - C_{i+\\frac{1}{2}}(\\bar{\\phi}_{i} - \\bar{\\phi}_{i+1}) = C_{i-\\frac{1}{2}}\\bar{\\phi}_{i-1} + C_{i+\\frac{1}{2}}\\bar{\\phi}_{i+1} - (C_{i-\\frac{1}{2}} + C_{i+\\frac{1}{2}})\\bar{\\phi}_i$.\n        The problem has this rearranged as:\n        $-\\left(\\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} + \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1}\\right) + \\left(\\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i$.\n\n    Let's assemble the matrix elements using 0-based indexing ($i, j \\in \\{0, \\dots, N-1\\}$).\n\n    -   **Diagonal entries $A_{ii}$**:\n        For an internal node $i$ (i.e., not at a boundary), its balance equation is affected by leakage to node $i-1$ and node $i+1$.\n        The coupling coefficient between node $i$ and $i+1$ is $C_{i_L, i_R} = \\frac{1}{R_{i_L, i_R}}$ where $R_{i_L, i_R} = \\frac{h_i}{2D_i} + \\frac{h_{i+1}}{2D_{i+1}}$.\n        The diagonal element for node $i$ is:\n        $$A_{ii} = \\Sigma_{a,i}\\,h_i + C_{i-1, i} + C_{i, i+1}$$\n        The boundary conditions are handled by setting coupling coefficients to zero for neighbors outside the domain. Using the problem's convention, $1/R_{1/2} = 0\n        $ and $1/R_{N+1/2} = 0$. This means coupling to the \"left\" of node 0 ($C_{-1, 0}$) is zero, and coupling to the \"right\" of node $N-1$ ($C_{N-1, N}$) is zero.\n        So, the general form for the diagonal elements is:\n        -   $A_{00} = \\Sigma_{a,0}\\,h_0 + C_{0,1}$\n        -   $A_{ii} = \\Sigma_{a,i}\\,h_i + C_{i-1, i} + C_{i, i+1}$ for $i \\in \\{1, \\dots, N-2\\}$\n        -   $A_{N-1, N-1} = \\Sigma_{a,N-1}\\,h_{N-1} + C_{N-2, N-1}$\n\n    -   **Off-diagonal entries $A_{i, i+1}$ and $A_{i+1, i}$**:\n        The coupling between node $i$ and $i+1$ contributes to the off-diagonal elements.\n        $$A_{i, i+1} = A_{i+1, i} = -C_{i, i+1} = -\\frac{1}{R_{i, i+1}} = -\\frac{1}{\\frac{h_i}{2D_i} + \\frac{h_{i+1}}{2D_{i+1}}}$$\n\n3.  **Algorithm**:\n    The algorithm will be implemented as follows for each test case:\n    a.  Given $N$ and lists $h, D, \\Sigma_a, Q$.\n    b.  If $N=1$, the solution is simply $\\bar{\\phi}_0 = Q_0/\\Sigma_{a,0}$. The nodal balance equation gives $\\Sigma_{a,0}h_0 \\bar{\\phi}_0 = Q_0h_0$, which simplifies to this.\n    c.  If $N1$:\n        i.   Create an $N \\times N$ NumPy array `A`, initialized to zeros.\n        ii.  Create an $N \\times 1$ NumPy array `b`.\n        iii. Populate `b` such that $b_i = Q_i h_i$.\n        iv.  Populate the diagonal of `A` with the removal terms: $A_{ii} = \\Sigma_{a,i} h_i$.\n        v.   Iterate from $i = 0$ to $N-2$ to compute coupling terms for each interface:\n             -   Calculate the interface resistance $R = \\frac{h_i}{2D_i} + \\frac{h_{i+1}}{2D_{i+1}}$.\n             -   Calculate the coupling coefficient $C = 1/R$.\n             -   Add $C$ to the diagonal elements: $A_{ii} \\leftarrow A_{ii} + C$ and $A_{i+1, i+1} \\leftarrow A_{i+1, i+1} + C$.\n             -   Set the off-diagonal elements: $A_{i, i+1} = -C$ and $A_{i+1, i} = -C$.\n        vi.  Solve the linear system $A \\bar{\\phi} = b$ using `numpy.linalg.solve`.\n    d.  Round the elements of the resulting flux vector $\\bar{\\phi}$ to 6 decimal places.\n    e.  Collect the list of rounded fluxes for the current test case.\n\n4.  **Final Output**:\n    After processing all test cases, the collected list of lists will be formatted into the required string `[[...],[...],...]` and printed. The Python expression `f\"[{','.join(map(str, all_results))}]\"` will correctly format a list of lists, as `str()` applied to a list produces its standard string representation.\n\nThis systematic approach correctly implements the physics and numerical method described, ensuring accurate results for the given test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_diffusion_system(N, h, D, Sigma_a, Q):\n    \"\"\"\n    Constructs and solves the coarse-mesh nodal diffusion system.\n\n    Args:\n        N (int): Number of nodes.\n        h (list): List of node widths in cm.\n        D (list): List of diffusion coefficients in cm.\n        Sigma_a (list): List of macroscopic absorption cross sections in cm^-1.\n        Q (list): List of volumetric source strengths in n/(cm^3*s).\n\n    Returns:\n        list: A list of node-average scalar fluxes, rounded to 6 decimal places.\n    \"\"\"\n    # For N=1, the reflective boundary conditions mean no leakage.\n    # The balance equation Sigma_a,1 * h_1 * phi_bar_1 = Q_1 * h_1\n    # simplifies to phi_bar_1 = Q_1 / Sigma_a,1.\n    if N == 1:\n        if Sigma_a[0] == 0:\n            # Physically, this implies infinite flux if Q  0, or any flux if Q = 0.\n            # Mathematically, the matrix would be singular.\n            # For this problem's constraints, we assume Sigma_a  0.\n            return [np.inf if Q[0]  0 else 0.0]\n        flux = Q[0] / Sigma_a[0]\n        return [round(flux, 6)]\n\n    # Convert lists to NumPy arrays for vectorized operations\n    h_arr = np.array(h, dtype=float)\n    D_arr = np.array(D, dtype=float)\n    Sigma_a_arr = np.array(Sigma_a, dtype=float)\n    Q_arr = np.array(Q, dtype=float)\n\n    # Initialize the system matrix A and right-hand side vector b\n    A = np.zeros((N, N))\n    b = Q_arr * h_arr\n\n    # Populate the diagonal of A with the removal term (Sigma_a,i * h_i)\n    np.fill_diagonal(A, Sigma_a_arr * h_arr)\n\n    # Populate the matrix with leakage coupling terms\n    # Iterate over the N-1 interfaces between nodes\n    for i in range(N - 1):\n        # Resistance of the left half-node at the interface\n        r_left = h_arr[i] / (2.0 * D_arr[i])\n        # Resistance of the right half-node at the interface\n        r_right = h_arr[i+1] / (2.0 * D_arr[i+1])\n        \n        # Total interface resistance\n        R_interface = r_left + r_right\n        \n        # Coupling coefficient is the inverse of the resistance\n        C = 1.0 / R_interface\n        \n        # Add to diagonal elements for node i and i+1\n        A[i, i] += C\n        A[i+1, i+1] += C\n        \n        # Set the off-diagonal elements\n        A[i, i+1] = -C\n        A[i+1, i] = -C\n        \n    # Solve the linear system A * phi_bar = b\n    phi_bar = np.linalg.solve(A, b)\n    \n    # Round the results to 6 decimal places and return as a standard list\n    return [round(x, 6) for x in phi_bar.tolist()]\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the final output.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        {'N': 3, 'h': [10.0, 10.0, 10.0], 'D': [1.0, 1.0, 1.0], 'Sigma_a': [0.1, 0.1, 0.1], 'Q': [0.5, 0.5, 0.5]},\n        # Test case 2\n        {'N': 3, 'h': [10.0, 10.0, 10.0], 'D': [1.0, 1.0, 1.0], 'Sigma_a': [0.1, 1.0, 0.1], 'Q': [0.5, 0.5, 0.5]},\n        # Test case 3\n        {'N': 4, 'h': [5.0, 20.0, 5.0, 20.0], 'D': [1.0, 0.5, 1.5, 1.0], 'Sigma_a': [0.1, 0.2, 0.05, 0.15], 'Q': [0.0, 2.0, 0.0, 0.0]},\n        # Test case 4\n        {'N': 1, 'h': [10.0], 'D': [1.0], 'Sigma_a': [0.1], 'Q': [0.5]}\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = solve_diffusion_system(case['N'], case['h'], case['D'], case['Sigma_a'], case['Q'])\n        all_results.append(result)\n\n    # Format the final output string as a list of lists, without spaces.\n    # str() on a list produces a string with spaces. We build it manually.\n    inner_strings = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n\n```"
        }
    ]
}