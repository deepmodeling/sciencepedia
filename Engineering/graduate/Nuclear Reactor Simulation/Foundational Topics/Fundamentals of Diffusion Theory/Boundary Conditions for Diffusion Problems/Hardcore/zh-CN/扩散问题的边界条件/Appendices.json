{
    "hands_on_practices": [
        {
            "introduction": "本练习将展示边界条件如何对反应堆系统的关键全局参数——中子增殖系数 $k$ ——产生深远的物理影响。通过比较一个具有理想化全反射边界的模型与一个考虑了中子泄漏的更真实的真空边界模型，您将定量地看到边界条件如何控制中子泄漏，从而决定系统的临界状态。这项实践  将巩固您对几何曲率、材料特性与系统整体中子平衡之间关系的理解。",
            "id": "4215854",
            "problem": "一个物理半厚度为 $a = 50 \\ \\text{cm}$ 的一维均匀二氧化铀燃料板，采用单群中子扩散理论在稳态下进行建模。材料性质在整个区域内是常数：扩散系数 $D = 1.2 \\ \\text{cm}$，宏观吸收截面 $\\Sigma_{a} = 0.010 \\ \\text{cm}^{-1}$，裂变产生项 $\\nu \\Sigma_{f} = 0.0125 \\ \\text{cm}^{-1}$。所建模型的燃料板最初两侧均为完全反射边界。反射边界强制法向中子流为零，这消除了中子泄漏并能限制中子通量，因此相对于有泄漏的系统，会高估中子增殖因子 $k$。\n\n使用扩散近似的第一性原理和适当的边界条件，证明为什么燃料板两面的完全反射边界会消除泄漏，从而使 $k$ 最大化。然后，通过如下方式调整建模区域来修正模型以模拟物理泄漏：在中平面 $x=0$ 处保留一个反射边界（根据对称性），并在位于 $x=a+z_{0}$ 的外推平面上施加真空条件，其中外推距离为 $z_{0} = \\beta L$，$L = \\sqrt{D/\\Sigma_{a}}$ 是扩散长度，$\\beta = 0.7104$ 是扩散理论中各向同性条件下的平面几何对应值。假设燃料板以 $x=0$ 为中心，并且真空边界应用于外推平面（而非物理表面）。\n\n计算此调整后模型的修正基模中子增殖因子 $k$。将 $k$ 报告为一无量纲值，并四舍五入到四位有效数字。",
            "solution": "该问题具有科学依据、是良定的且自洽的。所有必需的物理常数和边界条件都已提供，且没有内部矛盾。它代表了基于单群中子扩散理论的核反应堆物理学中的一个标准问题。因此，该问题是有效的，并且可以推导出解。\n\n分析按要求分两部分进行。首先，我们证明完全反射边界消除了中子泄漏并使中子增殖因子 $k$ 最大化。其次，我们为带有泄漏的物理现实模型计算修正后的 $k$ 值。\n\n均匀增殖介质的单群、稳态中子扩散方程由下式给出：\n$$ -D \\nabla^2 \\phi(\\mathbf{r}) + \\Sigma_a \\phi(\\mathbf{r}) = \\frac{1}{k} \\nu \\Sigma_f \\phi(\\mathbf{r}) $$\n其中 $D$ 是扩散系数，$\\Sigma_a$ 是宏观吸收截面，$\\nu \\Sigma_f$ 是中子产生截面项，$\\phi(\\mathbf{r})$ 是位置 $\\mathbf{r}$ 处的中子通量，$k$ 是有效中子增殖因子。\n\n该方程可以重排为亥姆霍兹方程的形式：\n$$ \\nabla^2 \\phi(\\mathbf{r}) + \\left( \\frac{\\frac{1}{k} \\nu \\Sigma_f - \\Sigma_a}{D} \\right) \\phi(\\mathbf{r}) = 0 $$\n我们将材料曲率 $B_m^2$ 定义为：\n$$ B_m^2 = \\frac{\\frac{1}{k} \\nu \\Sigma_f - \\Sigma_a}{D} $$\n对于处于基模的临界系统，材料曲率必须等于几何曲率 $B_g^2$，后者由系统的几何形状和边界条件决定。令 $B_m^2 = B_g^2$，我们可以解出 $k$：\n$$ D B_g^2 = \\frac{1}{k} \\nu \\Sigma_f - \\Sigma_a \\implies k = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D B_g^2} $$\n使用无限增殖因子 $k_\\infty = \\frac{\\nu \\Sigma_f}{\\Sigma_a}$ 和中子扩散长度的平方 $L^2 = \\frac{D}{\\Sigma_a}$，该表达式可以方便地写成：\n$$ k = \\frac{\\nu \\Sigma_f / \\Sigma_a}{1 + (D/\\Sigma_a) B_g^2} = \\frac{k_\\infty}{1 + L^2 B_g^2} $$\n项 $L^2 B_g^2$ 代表中子泄漏与中子吸收之比。由于 $L^2 > 0$，当几何曲率 $B_g^2$ 最小时，增殖因子 $k$ 最大。几何曲率是亥姆霍兹方程 $\\nabla^2 \\phi + B_g^2 \\phi = 0$ 的满足边界条件并对应于非负通量的最小特征值。作为该算子的特征值，$B_g^2$ 必须为非负。其可能的最小值为 $0$。\n\n现在，我们来分析完全反射边界的影响。反射边界由垂直于表面的净中子流为零的条件定义。根据菲克定律，中子流矢量 $\\mathbf{J}(\\mathbf{r})$ 由 $\\mathbf{J}(\\mathbf{r}) = -D \\nabla \\phi(\\mathbf{r})$ 给出。因此，在具有法向量 $\\mathbf{n}$ 的表面上的反射边界条件是 $\\mathbf{J} \\cdot \\mathbf{n} = -D \\frac{\\partial \\phi}{\\partial n} = 0$。\n\n对于以 $x=0$ 为中心、半厚度为 $a$ 的一维板，区域为 $[-a, a]$。扩散方程变为：\n$$ \\frac{d^2\\phi}{dx^2} + B_g^2 \\phi(x) = 0 $$\n两侧表面的反射边界条件为 $\\frac{d\\phi}{dx}|_{x=-a} = 0$ 和 $\\frac{d\\phi}{dx}|_{x=a} = 0$。由于问题关于 $x=0$ 对称，基模通量必须是偶函数，因此其通解形式为 $\\phi(x) = C \\cos(B_g x)$，其中 $C$ 是某个常数。其导数为 $\\frac{d\\phi}{dx} = -C B_g \\sin(B_g x)$。在 $x=a$ 处应用边界条件：\n$$ -C B_g \\sin(B_g a) = 0 $$\n对于非平凡解（$C \\neq 0$），并假设 $B_g \\neq 0$，我们需要 $\\sin(B_g a) = 0$，这意味着 $B_g a = n\\pi$，其中 $n=1, 2, ...$。然而，$B_g=0$ 也是一个有效的数学解，对应于 $\\phi(x)=C$，它满足两个边界条件。这对应于可能的最低特征值 $B_g^2=0$。这是完全反射系统的基模。当 $B_g^2=0$ 时，泄漏项 $L^2 B_g^2$ 变为 $0$，$k$ 达到其最大值：\n$$ k = \\frac{k_\\infty}{1 + 0} = k_\\infty = \\frac{\\nu\\Sigma_f}{\\Sigma_a} $$\n这证明了完全反射边界消除了所有中子泄漏，导致系统的行为如同无限大一样，并使增殖因子最大化。\n\n接下来，我们修正模型以考虑物理泄漏。问题指定在中平面 $x=0$ 处有一个反射边界（由于对称性），在距物理表面 $x=a$ 的外推距离 $z_0$ 处有一个真空边界条件。真空边界条件意味着中子通量在这个外推边界处变为零。新的边界条件是：\n1. 中平面对称性：$\\frac{d\\phi}{dx}|_{x=0} = 0$。\n2. 外推边界处真空条件：$\\phi(a+z_0) = 0$。\n\n令 $\\tilde{a} = a+z_0$ 为外推半厚度。扩散方程仍然是 $\\frac{d^2\\phi}{dx^2} + B_g^2 \\phi(x) = 0$。对称性条件 $\\frac{d\\phi}{dx}|_{x=0} = 0$ 再次导出一个形式为 $\\phi(x) = C \\cos(B_g x)$ 的解。在 $x=\\tilde{a}$ 处应用真空边界条件：\n$$ \\phi(\\tilde{a}) = C \\cos(B_g \\tilde{a}) = 0 $$\n对于非平凡解，我们必须有 $\\cos(B_g \\tilde{a}) = 0$。基模对应于自变量的最小正值，即 $\\frac{\\pi}{2}$。\n$$ B_g \\tilde{a} = \\frac{\\pi}{2} \\implies B_g = \\frac{\\pi}{2\\tilde{a}} $$\n几何曲率为 $B_g^2 = \\left( \\frac{\\pi}{2\\tilde{a}} \\right)^2 = \\left( \\frac{\\pi}{2(a+z_0)} \\right)^2$。\n\n我们已知以下数值：\n$a = 50 \\ \\text{cm}$\n$D = 1.2 \\ \\text{cm}$\n$\\Sigma_{a} = 0.010 \\ \\text{cm}^{-1}$\n$\\nu \\Sigma_{f} = 0.0125 \\ \\text{cm}^{-1}$\n$\\beta = 0.7104$\n\n首先，我们计算扩散长度 $L$ 和外推距离 $z_0$：\n$$ L = \\sqrt{\\frac{D}{\\Sigma_a}} = \\sqrt{\\frac{1.2 \\ \\text{cm}}{0.010 \\ \\text{cm}^{-1}}} = \\sqrt{120} \\ \\text{cm} $$\n$$ z_0 = \\beta L = 0.7104 \\sqrt{120} \\ \\text{cm} $$\n\n现在，我们计算外推半厚度 $\\tilde{a}$：\n$$ \\tilde{a} = a + z_0 = 50 \\ \\text{cm} + 0.7104 \\sqrt{120} \\ \\text{cm} \\approx 50 + 7.78205 = 57.78205 \\ \\text{cm} $$\n\n接下来，我们计算几何曲率 $B_g^2$：\n$$ B_g^2 = \\left( \\frac{\\pi}{2\\tilde{a}} \\right)^2 = \\left( \\frac{\\pi}{2(50 + 0.7104\\sqrt{120})} \\right)^2 \\ \\text{cm}^{-2} $$\n$$ B_g^2 \\approx \\left( \\frac{\\pi}{2(57.78205)} \\right)^2 \\approx \\left( \\frac{3.14159}{115.5641} \\right)^2 \\approx (0.027183)^2 \\approx 0.00073898 \\ \\text{cm}^{-2} $$\n\n最后，我们使用前面推导的公式计算修正后的增殖因子 $k$：\n$$ k = \\frac{\\nu \\Sigma_f}{D B_g^2 + \\Sigma_a} $$\n代入数值：\n$$ k = \\frac{0.0125}{1.2 \\times 0.00073898 + 0.010} $$\n$$ k = \\frac{0.0125}{0.00088678 + 0.010} = \\frac{0.0125}{0.01088678} \\approx 1.148179 $$\n\n将结果四舍五入到四位有效数字，我们得到：\n$$ k \\approx 1.148 $$\n该值小于 $k_\\infty = \\frac{0.0125}{0.010} = 1.25$，这与有中子泄漏的有限系统的预期相符。",
            "answer": "$$\\boxed{1.148}$$"
        },
        {
            "introduction": "除了影响全局参数，边界条件还从根本上决定了物理问题解的形态和对称性。本练习旨在探究在反应堆堆芯的对称面上施加错误边界条件所带来的严重后果。您将推导正确和错误的基波中子注量率分布（本征模），并计算由此产生的畸变 ，从而具体地衡量模型中的一个局部错误是如何影响整个求解域的。",
            "id": "4215834",
            "problem": "考虑一个用于对称平板反应堆的一维、均匀、单群、稳态中子扩散模型。设计算域为半堆芯区间 $x \\in [0, L]$，其中 $L > 0$ 为有限值，且材料性质为常数。标量中子通量为 $\\phi(x)$，中子流密度为 $\\mathbf{J}(x)$。假设标准的中子输运菲克定律为 $\\mathbf{J}(x) = - D \\nabla \\phi(x)$，其中 $D > 0$ 是扩散系数；在无外部源的情况下，单群中子平衡方程为 $- \\nabla \\cdot \\mathbf{J}(x) + \\Sigma_{a} \\phi(x) = \\nu \\Sigma_{f} \\phi(x)$，其中 $\\Sigma_{a} > 0$ 是宏观吸收截面，$\\nu \\Sigma_{f} \\ge 0$ 是裂变产生的宏观截面，并且由于空间均匀性，这些系数均为常数。位于 $x = L$ 的外边界被理想化为强吸收体，因此标量通量在此处为零：$\\phi(L) = 0$。\n\n在对称面 $x = 0$ 处，物理上正确的边界条件是穿过该平面的净流为零，即 $J_{n}(0) = 0$，其中 $J_{n}$ 表示垂直于平面的流分量。在一维简化（$x$ 方向垂直于平面）中，这意味着 $\\frac{d \\phi}{dx}(0) = 0$。一位分析人员在对称面上错误地施加了狄利克雷条件 $\\phi(0) = 0$。\n\n仅从上述物理定律和定义出发，完成以下任务：\n- 对于正确的对称性条件 $\\frac{d \\phi}{dx}(0) = 0$ 和外边界条件 $\\phi(L) = 0$，以及对于错误的对称性条件 $\\phi(0) = 0$ 和相同的外边界条件 $\\phi(L) = 0$，推导在 $x \\in [0, L]$ 上的基态（最低空间频率）本征模形状。\n- 将每个基态本征模归一化为单位 $L^{2}(0, L)$ 范数。\n- 将由于错误的对称性边界条件导致的基态本征模形状中的无量纲畸变 $\\mathcal{E}$ 定义为两个归一化形状之差的 $L^{2}(0, L)$ 范数除以正确归一化形状的 $L^{2}(0, L)$ 范数。精确计算 $\\mathcal{E}$ 并以闭合形式表示。\n\n最终答案以单个精确解析表达式的形式给出。无需四舍五入。畸变是无量纲的，因此无需报告物理单位。",
            "solution": "分析始于验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **区域**：一维、均匀的平板反应堆，位于半堆芯区间 $x \\in [0, L]$。\n- **变量**：标量中子通量 $\\phi(x)$，中子流密度 $\\mathbf{J}(x)$。\n- **常数**：扩散系数 $D > 0$，宏观吸收截面 $\\Sigma_{a} > 0$，裂变产生的宏观截面 $\\nu \\Sigma_{f} \\ge 0$。这些系数在空间上是常数。\n- **物理定律**：\n  1. 菲克定律：$\\mathbf{J}(x) = - D \\nabla \\phi(x)$。\n  2. 中子平衡（稳态，无外部源）：$- \\nabla \\cdot \\mathbf{J}(x) + \\Sigma_{a} \\phi(x) = \\nu \\Sigma_{f} \\phi(x)$。\n- **边界条件**：\n  - 外边界：$\\phi(L) = 0$。\n  - 正确的对称性边界：$J_{n}(0) = 0$，这意味着 $\\frac{d \\phi}{dx}(0) = 0$。\n  - 错误的对称性边界：$\\phi(0) = 0$。\n- **任务**：\n  1. 推导正确和错误两种情况下的基态本征模形状。\n  2. 将每个本征模归一化为单位 $L^{2}(0, L)$ 范数。\n  3. 计算无量纲畸变 $\\mathcal{E}$，其定义为两个归一化形状之差的 $L^{2}(0, L)$ 范数除以正确形状的 $L^{2}(0, L)$ 范数。给出 $\\mathcal{E}$ 的精确闭合形式表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于单群中子扩散理论，这是核反应堆物理学中一个标准且基础的模型。方程和边界条件对于该模型是标准的。比较正确与错误的边界条件在物理学和数值分析中是一项有效且富有启发性的练习。在模型的框架内，其前提在事实上是合理的。\n- **适定性**：该问题要求推导和比较两个不同边值问题（BVP）的解。每个BVP都是一个标准的斯图姆-刘维尔问题，它是适定的，并具有唯一的本征函数和本征值集合。任务定义清晰，可以得出一个唯一的数学结果。\n- **客观性**：语言精确且量化。所有术语都在反应堆物理学的标准词汇范围内定义。目标是进行一项特定的数学计算，没有主观解释的余地。\n- 该问题是自洽的，提供了所有必要信息。它不是不完整的、矛盾的、不切实际的（在模型的假设范围内）或不适定的。\n\n### 步骤 3：结论与行动\n问题是有效的。将提供一个完整的解答。\n\n第一步是推导标量通量 $\\phi(x)$ 的控制微分方程。我们从其中子平衡方程开始：\n$$\n- \\nabla \\cdot \\mathbf{J}(x) + \\Sigma_{a} \\phi(x) = \\nu \\Sigma_{f} \\phi(x)\n$$\n在一维情况下，散度算子 $\\nabla \\cdot$ 变为 $\\frac{d}{dx}$，梯度算子 $\\nabla$ 变为 $\\frac{d}{dx}$。将菲克定律 $\\mathbf{J}(x) = - D \\frac{d\\phi}{dx}$ 代入平衡方程，得到：\n$$\n- \\frac{d}{dx} \\left(-D \\frac{d\\phi(x)}{dx}\\right) + \\Sigma_{a} \\phi(x) = \\nu \\Sigma_{f} \\phi(x)\n$$\n由于介质是均匀的，扩散系数 $D$ 是一个常数。方程简化为：\n$$\nD \\frac{d^2\\phi(x)}{dx^2} + (\\nu \\Sigma_{f} - \\Sigma_{a}) \\phi(x) = 0\n$$\n这可以改写为标准亥姆霍兹方程的形式：\n$$\n\\frac{d^2\\phi(x)}{dx^2} + B^2 \\phi(x) = 0\n$$\n其中 $B^2 = \\frac{\\nu \\Sigma_{f} - \\Sigma_{a}}{D}$ 是材料曲率。为了存在物理上临界反应堆芯所必需的非平凡振荡解，我们假设 $B^2 > 0$。\n\n接下来，我们针对两组指定的边界条件求解该方程，以找到基态本征模。\n\n**情况 1：正确的边界条件**\n该边值问题由在 $x \\in [0, L]$ 上的微分方程定义，在对称面处有零流（诺伊曼）条件，在外边界处有零通量（狄利克雷）条件：\n$$\n\\frac{d^2\\phi_c(x)}{dx^2} + B_c^2 \\phi_c(x) = 0, \\quad \\frac{d\\phi_c}{dx}(0) = 0, \\quad \\phi_c(L) = 0\n$$\n微分方程的通解为 $\\phi_c(x) = A \\cos(B_c x) + C \\sin(B_c x)$。\n应用第一个边界条件，$\\frac{d\\phi_c}{dx}(x) = -A B_c \\sin(B_c x) + C B_c \\cos(B_c x)$，因此 $\\frac{d\\phi_c}{dx}(0) = C B_c = 0$。对于非平凡解，我们需要 $B_c \\neq 0$，这意味着 $C=0$。因此，解的形式为 $\\phi_c(x) = A \\cos(B_c x)$。\n应用第二个边界条件，$\\phi_c(L) = A \\cos(B_c L) = 0$。对于非平凡解（$A \\neq 0$），我们必须有 $\\cos(B_c L) = 0$。这个条件决定了曲率 $B_c$ 的允许值。解为 $B_c L = \\frac{(2n+1)\\pi}{2}$，其中 $n=0, 1, 2, \\dots$。\n基态本征模对应于最低的空间频率，即 $B_c$ 的最小正值。这在 $n=0$ 时发生，得到 $B_{c,0} = \\frac{\\pi}{2L}$。因此，基态本征模的形状为：\n$$\n\\phi_c(x) = A_c \\cos\\left(\\frac{\\pi x}{2L}\\right)\n$$\n\n**情况 2：错误的边界条件**\n现在的边值问题在两个边界上都定义为零通量（狄利克雷）条件：\n$$\n\\frac{d^2\\phi_e(x)}{dx^2} + B_e^2 \\phi_e(x) = 0, \\quad \\phi_e(0) = 0, \\quad \\phi_e(L) = 0\n$$\n通解为 $\\phi_e(x) = A \\sin(B_e x) + C \\cos(B_e x)$。\n应用第一个边界条件，$\\phi_e(0) = C = 0$。解简化为 $\\phi_e(x) = A \\sin(B_e x)$。\n应用第二个边界条件，$\\phi_e(L) = A \\sin(B_e L) = 0$。对于非平凡解，$\\sin(B_e L) = 0$。曲率的允许值为 $B_e L = n\\pi$，其中 $n=1, 2, 3, \\dots$（$n=0$ 产生平凡解 $\\phi_e(x)=0$）。\n基态本征模对应于最小的正值 $B_e$，这在 $n=1$ 时发生，得到 $B_{e,0} = \\frac{\\pi}{L}$。基态本征模的形状为：\n$$\n\\phi_e(x) = A_e \\sin\\left(\\frac{\\pi x}{L}\\right)\n$$\n\n**本征模的归一化**\n本征模必须归一化以具有单位 $L^{2}(0, L)$ 范数。范数的平方由 $\\|\\psi\\|_{L^2}^2 = \\int_0^L |\\psi(x)|^2 dx$ 给出。\n\n对于正确的本征模 $\\phi_c(x)$，我们将其范数设为 $1$：\n$$\n\\int_0^L \\left(A_c \\cos\\left(\\frac{\\pi x}{2L}\\right)\\right)^2 dx = 1 \\implies A_c^2 \\int_0^L \\cos^2\\left(\\frac{\\pi x}{2L}\\right) dx = 1\n$$\n使用恒等式 $\\cos^2(\\theta) = \\frac{1+\\cos(2\\theta)}{2}$，积分为：\n$$\n\\int_0^L \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{\\pi x}{L}\\right)\\right) dx = \\frac{1}{2} \\left[x + \\frac{L}{\\pi}\\sin\\left(\\frac{\\pi x}{L}\\right)\\right]_0^L = \\frac{1}{2}(L+0 - 0) = \\frac{L}{2}\n$$\n所以，$A_c^2 (\\frac{L}{2}) = 1$，这给出了归一化常数 $A_c = \\sqrt{\\frac{2}{L}}$。归一化后的正确本征模是：\n$$\n\\hat{\\phi}_c(x) = \\sqrt{\\frac{2}{L}} \\cos\\left(\\frac{\\pi x}{2L}\\right)\n$$\n对于错误的本征模 $\\phi_e(x)$，我们执行类似的归一化：\n$$\n\\int_0^L \\left(A_e \\sin\\left(\\frac{\\pi x}{L}\\right)\\right)^2 dx = 1 \\implies A_e^2 \\int_0^L \\sin^2\\left(\\frac{\\pi x}{L}\\right) dx = 1\n$$\n使用恒等式 $\\sin^2(\\theta) = \\frac{1-\\cos(2\\theta)}{2}$，积分为：\n$$\n\\int_0^L \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2\\pi x}{L}\\right)\\right) dx = \\frac{1}{2} \\left[x - \\frac{L}{2\\pi}\\sin\\left(\\frac{2\\pi x}{L}\\right)\\right]_0^L = \\frac{1}{2}(L-0 - 0) = \\frac{L}{2}\n$$\n所以，$A_e^2 (\\frac{L}{2}) = 1$，这给出了归一化常数 $A_e = \\sqrt{\\frac{2}{L}}$。归一化后的错误本征模是：\n$$\n\\hat{\\phi}_e(x) = \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{\\pi x}{L}\\right)\n$$\n\n**畸变 $\\mathcal{E}$ 的计算**\n畸变 $\\mathcal{E}$ 定义为：\n$$\n\\mathcal{E} = \\frac{\\|\\hat{\\phi}_c - \\hat{\\phi}_e\\|_{L^2}}{\\|\\hat{\\phi}_c\\|_{L^2}}\n$$\n由于 $\\hat{\\phi}_c$ 已被归一化，其范数 $\\|\\hat{\\phi}_c\\|_{L^2}$ 为 $1$。因此，$\\mathcal{E} = \\|\\hat{\\phi}_c - \\hat{\\phi}_e\\|_{L^2}$。\n我们计算畸变的平方 $\\mathcal{E}^2$：\n$$\n\\mathcal{E}^2 = \\int_0^L (\\hat{\\phi}_c(x) - \\hat{\\phi}_e(x))^2 dx = \\int_0^L \\hat{\\phi}_c(x)^2 dx + \\int_0^L \\hat{\\phi}_e(x)^2 dx - 2\\int_0^L \\hat{\\phi}_c(x) \\hat{\\phi}_e(x) dx\n$$\n根据归一化，$\\int_0^L \\hat{\\phi}_c(x)^2 dx = \\|\\hat{\\phi}_c\\|_{L^2}^2 = 1$ 并且 $\\int_0^L \\hat{\\phi}_e(x)^2 dx = \\|\\hat{\\phi}_e\\|_{L^2}^2 = 1$。表达式简化为：\n$$\n\\mathcal{E}^2 = 1 + 1 - 2 \\langle \\hat{\\phi}_c, \\hat{\\phi}_e \\rangle_{L^2} = 2 - 2 \\int_0^L \\hat{\\phi}_c(x) \\hat{\\phi}_e(x) dx\n$$\n我们现在计算内积积分：\n$$\n\\int_0^L \\hat{\\phi}_c(x) \\hat{\\phi}_e(x) dx = \\int_0^L \\left(\\sqrt{\\frac{2}{L}} \\cos\\left(\\frac{\\pi x}{2L}\\right)\\right) \\left(\\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{\\pi x}{L}\\right)\\right) dx = \\frac{2}{L} \\int_0^L \\cos\\left(\\frac{\\pi x}{2L}\\right) \\sin\\left(\\frac{\\pi x}{L}\\right) dx\n$$\n使用三角恒等式 $\\sin(2\\theta) = 2\\sin(\\theta)\\cos(\\theta)$，我们可以将 $\\sin(\\frac{\\pi x}{L})$ 写成 $2\\sin(\\frac{\\pi x}{2L})\\cos(\\frac{\\pi x}{2L})$。积分变为：\n$$\n\\frac{2}{L} \\int_0^L \\cos\\left(\\frac{\\pi x}{2L}\\right) \\left(2\\sin\\left(\\frac{\\pi x}{2L}\\right)\\cos\\left(\\frac{\\pi x}{2L}\\right)\\right) dx = \\frac{4}{L} \\int_0^L \\cos^2\\left(\\frac{\\pi x}{2L}\\right)\\sin\\left(\\frac{\\pi x}{2L}\\right) dx\n$$\n让我们通过换元法来计算这个定积分。令 $u = \\cos\\left(\\frac{\\pi x}{2L}\\right)$。那么 $du = -\\frac{\\pi}{2L}\\sin\\left(\\frac{\\pi x}{2L}\\right) dx$。积分限从 $x=0$ 变为 $u=\\cos(0)=1$，从 $x=L$ 变为 $u=\\cos(\\frac{\\pi}{2})=0$。\n$$\n\\frac{4}{L} \\int_1^0 u^2 \\left(-\\frac{2L}{\\pi} du\\right) = -\\frac{8}{\\pi} \\int_1^0 u^2 du = \\frac{8}{\\pi} \\int_0^1 u^2 du = \\frac{8}{\\pi} \\left[\\frac{u^3}{3}\\right]_0^1 = \\frac{8}{3\\pi}\n$$\n内积为 $\\langle \\hat{\\phi}_c, \\hat{\\phi}_e \\rangle_{L^2} = \\frac{8}{3\\pi}$。\n现在，我们将其代回 $\\mathcal{E}^2$ 的表达式中：\n$$\n\\mathcal{E}^2 = 2 - 2 \\left(\\frac{8}{3\\pi}\\right) = 2 - \\frac{16}{3\\pi}\n$$\n最后，畸变 $\\mathcal{E}$ 是这个值的平方根：\n$$\n\\mathcal{E} = \\sqrt{2 - \\frac{16}{3\\pi}}\n$$\n这就是畸变的最终精确解析表达式。",
            "answer": "$$\\boxed{\\sqrt{2 - \\frac{16}{3\\pi}}}$$"
        },
        {
            "introduction": "将连续的数学边界条件转化为可用于数值求解器的离散形式，是计算物理学中的一项基本技能。本实践将聚焦于有限差分法中的一个核心技术：“虚拟点”法（ghost point method）。您将推导在反应堆物理学中两种最常见的边界类型——零流（诺伊曼）和外推（罗宾）条件下，为保证二阶精度所需的外部节点值的表达式 。本练习为实现扩散方程求解器提供了基础。",
            "id": "4215910",
            "problem": "考虑一个标量中子通量场 $\\phi$，它在反应堆区域平面边界附近局部地由扩散近似控制，且在该边界的邻域内扩散系数 $D$ 为常数。中子流密度由菲克定律给出，$\\mathbf{J}=-D \\nabla \\phi$。令 $\\partial_{n} \\phi$ 表示 $\\phi$ 沿边界外法线单位向量 $\\mathbf{n}$ 的方向导数。在边界外法线上施加了两种物理相关的边界条件：\n- 零流（反射）边界：$J_{n} \\equiv \\mathbf{J} \\cdot \\mathbf{n} = 0$，当 $D$ 非零时，这等价于 $\\partial_{n} \\phi = 0$。\n- 外推（罗宾）边界：$\\phi + \\delta \\, \\partial_{n} \\phi = 0$，其中 $\\delta>0$ 是与输运到扩散封闭关系相关的外推长度。\n\n沿局部外法线坐标 $s$ 采用节点中心的有限差分格式，$s$ 在向外方向上增加，边界节点位于 $s=0$，节点间距 $h>0$ 沿 $s$ 均匀。令 $\\phi_{0}=\\phi(0)$ 为边界节点处的未知通量，$\\phi_{-1}=\\phi(-h)$ 为位于区域内一个网格间距处的第一个内部节点的未知通量，并引入一个位于区域外 $s=+h$ 处的单个虚拟节点，其值为 $\\phi_{+1}=\\phi(h)$。仅使用：\n- 菲克定律和上述边界条件的定义，\n- 关于 $s=0$ 的泰勒展开来证明边界处 $\\partial_{n} \\phi$ 的二阶精确中心差分表示的合理性，以及\n- 均匀的节点间距 $h$，\n\n推导有限差分公式，通过在每种边界条件下将 $\\phi_{+1}$ 表示为 $\\phi_{-1}$、$\\phi_{0}$、$h$ 和 $\\delta$ 的函数来消除虚拟节点。您的推导必须从上述定义开始，通过使用位于 $s=\\pm h$ 的节点为 $s=0$ 处的 $\\partial_{n}\\phi$ 构建一个二阶精确的中心差分近似。然后，施加每种边界条件，以获得用 $\\phi_{-1}$、$\\phi_{0}$、$h$ 和 $\\delta$ 表示的 $\\phi_{+1}$。\n\n以双元素行矩阵 $\\begin{pmatrix} \\phi_{+1}\\big|_{\\text{Neumann}}  \\phi_{+1}\\big|_{\\text{Robin}} \\end{pmatrix}$ 的形式提供您的最终答案，该答案应为一个封闭形式的解析表达式。最终表达式中不需要进行数值计算或四舍五入，也不应包含任何单位。",
            "solution": "该问题要求在两种不同的边界条件下推导虚拟节点通量值 $\\phi_{+1}$ 的有限差分公式：零流（诺伊曼）条件和外推（罗宾）条件。推导必须基于边界处中子通量法向导数的二阶精确中心差分近似。沿外法线的坐标用 $s$ 表示，边界位于 $s=0$，第一个内部节点位于 $s=-h$，虚拟节点位于 $s=+h$。对应的通量值分别为 $\\phi_{0}=\\phi(0)$，$\\phi_{-1}=\\phi(-h)$ 和 $\\phi_{+1}=\\phi(h)$。\n\n第一步是为边界 $s=0$ 处的法向导数 $\\partial_{n}\\phi$ 构建一个二阶精确的有限差分近似。在这个一维坐标系中，该导数等价于在 $s=0$ 处计算的 $\\frac{d\\phi}{ds}$。我们使用通量 $\\phi(s)$ 在点 $s=0$ 附近的泰勒级数展开。\n\n$\\phi(s)$ 在 $s=+h$ 处的泰勒展开为：\n$$ \\phi(h) = \\phi(0) + h \\left.\\frac{d\\phi}{ds}\\right|_{s=0} + \\frac{h^2}{2} \\left.\\frac{d^2\\phi}{ds^2}\\right|_{s=0} + \\frac{h^3}{6} \\left.\\frac{d^3\\phi}{ds^3}\\right|_{s=0} + \\mathcal{O}(h^4) $$\n用节点值表示，即为：\n$$ \\phi_{+1} = \\phi_0 + h \\phi'(0) + \\frac{h^2}{2} \\phi''(0) + \\frac{h^3}{6} \\phi'''(0) + \\mathcal{O}(h^4) $$\n\n$\\phi(s)$ 在 $s=-h$ 处的泰勒展开为：\n$$ \\phi(-h) = \\phi(0) - h \\left.\\frac{d\\phi}{ds}\\right|_{s=0} + \\frac{h^2}{2} \\left.\\frac{d^2\\phi}{ds^2}\\right|_{s=0} - \\frac{h^3}{6} \\left.\\frac{d^3\\phi}{ds^3}\\right|_{s=0} + \\mathcal{O}(h^4) $$\n用节点值表示，即为：\n$$ \\phi_{-1} = \\phi_0 - h \\phi'(0) + \\frac{h^2}{2} \\phi''(0) - \\frac{h^3}{6} \\phi'''(0) + \\mathcal{O}(h^4) $$\n\n为了得到一阶导数 $\\phi'(0)$ 的中心差分近似，我们将第二个展开式从第一个展开式中减去：\n$$ \\phi_{+1} - \\phi_{-1} = \\left(\\phi_0 + h \\phi'(0) + \\frac{h^2}{2} \\phi''(0) + \\frac{h^3}{6} \\phi'''(0)\\right) - \\left(\\phi_0 - h \\phi'(0) + \\frac{h^2}{2} \\phi''(0) - \\frac{h^3}{6} \\phi'''(0)\\right) + \\mathcal{O}(h^5) $$\n$$ \\phi_{+1} - \\phi_{-1} = 2h \\phi'(0) + \\frac{h^3}{3} \\phi'''(0) + \\mathcal{O}(h^5) $$\n求解 $\\phi'(0)$，我们得到：\n$$ \\phi'(0) = \\frac{\\phi_{+1} - \\phi_{-1}}{2h} - \\frac{h^2}{6} \\phi'''(0) - \\mathcal{O}(h^4) $$\n截断高阶项，得到边界处导数的二阶精确中心差分近似：\n$$ \\left. \\partial_{n}\\phi \\right|_{s=0} = \\phi'(0) \\approx \\frac{\\phi_{+1} - \\phi_{-1}}{2h} $$\n\n现在，我们将此近似应用于两种指定的边界条件，以求出 $\\phi_{+1}$ 的表达式。\n\n1.  **零流（诺伊曼）边界条件：**\n    该条件给出为 $J_n=0$，对于非零扩散系数 $D$，这等价于在边界处 $\\partial_{n}\\phi = 0$。在 $s=0$ 处应用此条件：\n    $$ \\left. \\partial_{n}\\phi \\right|_{s=0} = 0 $$\n    使用我们的中心差分近似：\n    $$ \\frac{\\phi_{+1} - \\phi_{-1}}{2h} = 0 $$\n    由于 $h>0$，这可简化为：\n    $$ \\phi_{+1} - \\phi_{-1} = 0 $$\n    因此，在零流条件下，虚拟节点值的表达式为：\n    $$ \\phi_{+1} = \\phi_{-1} $$\n\n2.  **外推（罗宾）边界条件：**\n    该条件给出为在边界处 $\\phi + \\delta \\, \\partial_{n}\\phi = 0$，其中 $\\delta > 0$。在边界节点 $s=0$ 处计算此条件：\n    $$ \\phi(0) + \\delta \\left. \\partial_{n}\\phi \\right|_{s=0} = 0 $$\n    代入节点值 $\\phi_0$ 和中心差分近似：\n    $$ \\phi_0 + \\delta \\left(\\frac{\\phi_{+1} - \\phi_{-1}}{2h}\\right) = 0 $$\n    现在我们求解这个关于 $\\phi_{+1}$ 的代数方程：\n    $$ \\delta \\left(\\frac{\\phi_{+1} - \\phi_{-1}}{2h}\\right) = -\\phi_0 $$\n    $$ \\phi_{+1} - \\phi_{-1} = -\\frac{2h}{\\delta}\\phi_0 $$\n    分离 $\\phi_{+1}$，我们得到外推边界条件下虚拟节点值的表达式：\n    $$ \\phi_{+1} = \\phi_{-1} - \\frac{2h}{\\delta}\\phi_0 $$\n\n如要求所述，这两个推导出的公式将虚拟节点通量 $\\phi_{+1}$ 表示为内部通量 $\\phi_{-1}$、边界通量 $\\phi_{0}$、节点间距 $h$ 和外推长度 $\\delta$ 的函数。\n\n最终答案由这两个表达式组成一个行矩阵。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\phi_{-1}  \\phi_{-1} - \\frac{2h}{\\delta}\\phi_{0} \\end{pmatrix}} $$"
        }
    ]
}