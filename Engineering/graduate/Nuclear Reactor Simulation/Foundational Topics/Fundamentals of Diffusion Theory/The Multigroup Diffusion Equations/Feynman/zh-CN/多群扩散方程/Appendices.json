{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，最好的检验方式就是动手实践。第一个练习将带领我们回到多群扩散理论的核心——临界计算。通过分析一个简化的双能群、均匀裸堆模型，我们将推导出有效增殖因子 $k_{\\text{eff}}$ 与反应堆材料及几何尺寸（通过几何曲率 $B^2$ 体现）之间的解析关系，从而深刻理解反应堆是如何达到并维持临界状态的 。",
            "id": "4256040",
            "problem": "考虑一个一维、均匀的裸板反应堆，其物理半厚度为 $a$，在由外推表面 $x=\\pm\\left(a+\\ell\\right)$ 定义的真空边界处，其中 $\\ell$ 是扩散外推距离。假设一个双能群中子模型，高能群的索引为 $1$，低能群的索引为 $2$。该反应堆是无源且稳态的，所有中子都由从中子平衡和Fick定律导出的多群扩散近似所描述。令 $D_1$ 和 $D_2$ 为群扩散系数，$\\Sigma_{r,1}$ 和 $\\Sigma_{r,2}$ 为群移除截面，$\\Sigma_{s,12}$ 为从群1（快中子）到群2（热中子）的散射截面，$\\nu\\Sigma_{f,1}$ 和 $\\nu\\Sigma_{f,2}$ 分别为群1和群2中的裂变产生截面。令裂变谱份额为 $\\chi_1$ 和 $\\chi_2$，且 $\\chi_1+\\chi_2=1$，因此裂变源根据这些份额向群1和群2中增加中子。假设不存在从群2到群1的向上散射（即只有向下散射），并且材料性质在空间上是均匀的。\n\n从不含时的多群扩散方程出发，并施加与板边界条件一致的分离变量法，推导有效增殖因子 $k_{\\text{eff}}$ 对与基波模式相关的几何分离常数（曲率）$B^2$ 的依赖关系。你可以假设在基波模式下，两个群通量具有相同的空间形状，并且在外推表面上的边界匹配将 $B^2$ 确定为板的几何曲率，而无需其明确的数值。\n\n将 $k_{\\text{eff}}$ 的最终结果表示为关于 $B^2$、$D_1$、$D_2$、$\\Sigma_{r,1}$、$\\Sigma_{r,2}$、$\\Sigma_{s,12}$、$\\nu\\Sigma_{f,1}$、$\\nu\\Sigma_{f,2}$、$\\chi_1$ 和 $\\chi_2$ 的单个闭式解析表达式。不需要进行数值计算。答案必须是单个解析表达式。最终的方框答案中不应报告任何单位。",
            "solution": "基本出发点是扩散近似下的稳态、无源多群中子平衡。对于群 $g\\in\\{1,2\\}$，Fick定律和稳态平衡得出\n$$\n- \\nabla \\cdot \\left( D_g \\nabla \\phi_g(\\mathbf{r}) \\right) + \\Sigma_{r,g}\\,\\phi_g(\\mathbf{r}) = \\sum_{h\\neq g} \\Sigma_{s,h \\to g}\\,\\phi_h(\\mathbf{r}) + \\frac{1}{k_{\\text{eff}}}\\,\\chi_g\\sum_{h=1}^{2} \\nu\\Sigma_{f,h}\\,\\phi_h(\\mathbf{r}) ,\n$$\n其中 $\\phi_g(\\mathbf{r})$ 是群 $g$ 的中子通量，$\\Sigma_{r,g}$ 是群 $g$ 的移除截面，$\\Sigma_{s,h \\to g}$ 是从群 $h$ 到群 $g$ 的散射截面。在所述假设下（只有向下散射，即没有从群2到群1的向上散射），我们有 $\\Sigma_{s,21}=0$ 和 $\\Sigma_{s,12}>0$。此外，移除截面为 $\\Sigma_{r,1}=\\Sigma_{a,1}+\\Sigma_{s,12}$ 和 $\\Sigma_{r,2}=\\Sigma_{a,2}$，其中 $\\Sigma_{a,g}$ 是吸收截面，但推导直接使用给定的 $\\Sigma_{r,g}$ 进行。\n\n对于板的一维空间维度（$x$），扩散算符简化为\n$$\n- \\frac{d}{dx}\\left(D_g \\frac{d \\phi_g}{dx}\\right) \\quad \\text{在 } x=\\pm\\left(a+\\ell\\right) \\text{ 处具有真空边界条件}。\n$$\n对于均匀介质（$D_g$ 为常数），泄漏项为 $-D_g \\frac{d^2\\phi_g}{dx^2}$。\n\n我们对基波模式应用分离变量法：假设每个群通量可以写成\n$$\n\\phi_g(x) = \\Phi_g\\,\\psi(x) ,\n$$\n其中 $\\Phi_g$ 是群幅度，$\\psi(x)$ 是一个共同的空间形状。这在均匀反应堆的最低阶本征模式中是合理的，其中耦合的群共享相同的空间依赖性，但相差一个恒定的幅度比。空间函数 $\\psi(x)$ 满足受外推真空边界约束的亥姆霍兹方程，\n$$\n\\frac{d^2\\psi}{dx^2} + B^2\\,\\psi = 0, \\qquad \\psi\\left(\\pm\\left(a+\\ell\\right)\\right)=0 ,\n$$\n其中 $B^2$ 是板的几何分离常数（几何曲率）。基波模式意味着在整个内部区域 $\\frac{d^2\\psi}{dx^2} = -B^2 \\psi$。\n\n将 $\\phi_g(x) = \\Phi_g \\psi(x)$ 和 $\\frac{d^2\\psi}{dx^2} = -B^2 \\psi$ 代入双群扩散方程，得到一个关于幅度 $\\Phi_1$ 和 $\\Phi_2$ 的代数特征值问题。具体地，群方程变为\n$$\n\\begin{aligned}\n- D_1 \\frac{d^2}{dx^2}(\\Phi_1 \\psi) + \\Sigma_{r,1}\\,\\Phi_1 \\psi = \\frac{1}{k_{\\text{eff}}}\\,\\chi_1\\left(\\nu\\Sigma_{f,1}\\,\\Phi_1 \\psi + \\nu\\Sigma_{f,2}\\,\\Phi_2 \\psi\\right), \\\\\n- D_2 \\frac{d^2}{dx^2}(\\Phi_2 \\psi) + \\Sigma_{r,2}\\,\\Phi_2 \\psi - \\Sigma_{s,12}\\,\\Phi_1 \\psi = \\frac{1}{k_{\\text{eff}}}\\,\\chi_2\\left(\\nu\\Sigma_{f,1}\\,\\Phi_1 \\psi + \\nu\\Sigma_{f,2}\\,\\Phi_2 \\psi\\right) .\n\\end{aligned}\n$$\n使用 $\\frac{d^2\\psi}{dx^2} = -B^2 \\psi$ 并在内部区域约去 $\\psi(x)\\neq 0$，我们得到\n$$\n\\begin{aligned}\n\\left(D_1 B^2 + \\Sigma_{r,1}\\right)\\Phi_1 = \\frac{1}{k_{\\text{eff}}}\\,\\chi_1\\left(\\nu\\Sigma_{f,1}\\,\\Phi_1 + \\nu\\Sigma_{f,2}\\,\\Phi_2\\right), \\\\\n-\\Sigma_{s,12}\\,\\Phi_1 + \\left(D_2 B^2 + \\Sigma_{r,2}\\right)\\Phi_2 = \\frac{1}{k_{\\text{eff}}}\\,\\chi_2\\left(\\nu\\Sigma_{f,1}\\,\\Phi_1 + \\nu\\Sigma_{f,2}\\,\\Phi_2\\right) .\n\\end{aligned}\n$$\n定义简写\n$$\n\\alpha_1 \\equiv D_1 B^2 + \\Sigma_{r,1}, \\quad \\alpha_2 \\equiv D_2 B^2 + \\Sigma_{r,2}, \\quad s \\equiv \\Sigma_{s,12}, \\quad n_1 \\equiv \\nu\\Sigma_{f,1}, \\quad n_2 \\equiv \\nu\\Sigma_{f,2}.\n$$\n那么耦合的代数系统变为\n$$\n\\begin{pmatrix}\n\\alpha_1  0 \\\\\n- s  \\alpha_2\n\\end{pmatrix}\n\\begin{pmatrix}\n\\Phi_1 \\\\ \\Phi_2\n\\end{pmatrix}\n=\n\\frac{1}{k_{\\text{eff}}}\n\\begin{pmatrix}\n\\chi_1 n_1  \\chi_1 n_2 \\\\\n\\chi_2 n_1  \\chi_2 n_2\n\\end{pmatrix}\n\\begin{pmatrix}\n\\Phi_1 \\\\ \\Phi_2\n\\end{pmatrix}.\n$$\n非平凡解要求\n$$\n\\det\\!\\left(\n\\begin{pmatrix}\n\\alpha_1  0 \\\\\n- s  \\alpha_2\n\\end{pmatrix}\n-\n\\frac{1}{k_{\\text{eff}}}\n\\begin{pmatrix}\n\\chi_1 n_1  \\chi_1 n_2 \\\\\n\\chi_2 n_1  \\chi_2 n_2\n\\end{pmatrix}\n\\right) = 0 .\n$$\n显式地计算行列式：\n$$\n\\det\\!\\left(\n\\begin{pmatrix}\n\\alpha_1 - \\frac{1}{k_{\\text{eff}}}\\chi_1 n_1  - \\frac{1}{k_{\\text{eff}}}\\chi_1 n_2 \\\\\n- s - \\frac{1}{k_{\\text{eff}}}\\chi_2 n_1  \\alpha_2 - \\frac{1}{k_{\\text{eff}}}\\chi_2 n_2\n\\end{pmatrix}\n\\right) = 0 .\n$$\n展开，\n$$\n\\left(\\alpha_1 - \\frac{1}{k_{\\text{eff}}}\\chi_1 n_1\\right)\\left(\\alpha_2 - \\frac{1}{k_{\\text{eff}}}\\chi_2 n_2\\right)\n- \\left(- \\frac{1}{k_{\\text{eff}}}\\chi_1 n_2\\right)\\left(- s - \\frac{1}{k_{\\text{eff}}}\\chi_2 n_1\\right) = 0 .\n$$\n正比于 $\\left(\\frac{1}{k_{\\text{eff}}}\\right)^2$ 的交叉项相互抵消，得到\n$$\n\\alpha_1 \\alpha_2\n- \\frac{1}{k_{\\text{eff}}}\\left(\\alpha_1 \\chi_2 n_2 + \\alpha_2 \\chi_1 n_1 + \\chi_1 n_2 s\\right) = 0 .\n$$\n解出 $k_{\\text{eff}}$ 可得\n$$\nk_{\\text{eff}}(B^2) = \\frac{\\alpha_1 \\chi_2 n_2 + \\alpha_2 \\chi_1 n_1 + \\chi_1 n_2 s}{\\alpha_1 \\alpha_2}.\n$$\n恢复原始参数，\n$$\nk_{\\text{eff}}(B^2) = \\frac{\\chi_2\\,\\nu\\Sigma_{f,2}\\left(D_1 B^2 + \\Sigma_{r,1}\\right)\n+ \\chi_1\\,\\nu\\Sigma_{f,1}\\left(D_2 B^2 + \\Sigma_{r,2}\\right)\n+ \\chi_1\\,\\nu\\Sigma_{f,2}\\,\\Sigma_{s,12}}\n{\\left(D_1 B^2 + \\Sigma_{r,1}\\right)\\left(D_2 B^2 + \\Sigma_{r,2}\\right)} .\n$$\n这个表达式明确地将有效增殖因子与几何曲率 $B^2$（由板边界条件设定）和材料常数联系起来。在 $\\chi_1=1$ 和 $\\chi_2=0$（所有裂变中子都产生在快中子群）的常见特例中，该式简化为\n$$\nk_{\\text{eff}}(B^2) = \\frac{\\nu\\Sigma_{f,1}\\left(D_2 B^2 + \\Sigma_{r,2}\\right) + \\nu\\Sigma_{f,2}\\,\\Sigma_{s,12}}\n{\\left(D_1 B^2 + \\Sigma_{r,1}\\right)\\left(D_2 B^2 + \\Sigma_{r,2}\\right)} ,\n$$\n而在单群极限下（无向下散射，$\\Sigma_{s,12}=0$，且无热中子群），它进一步简化为熟悉的扩散结果 $k_{\\text{eff}} = \\nu\\Sigma_f/\\left(D B^2 + \\Sigma_r\\right)$。",
            "answer": "$$\\boxed{\\frac{\\chi_{2}\\,\\nu\\Sigma_{f,2}\\left(D_{1}B^{2}+\\Sigma_{r,1}\\right)\\;+\\;\\chi_{1}\\,\\nu\\Sigma_{f,1}\\left(D_{2}B^{2}+\\Sigma_{r,2}\\right)\\;+\\;\\chi_{1}\\,\\nu\\Sigma_{f,2}\\,\\Sigma_{s,12}}{\\left(D_{1}B^{2}+\\Sigma_{r,1}\\right)\\left(D_{2}B^{2}+\\Sigma_{r,2}\\right)}}$$"
        },
        {
            "introduction": "在掌握了临界计算的解析理论后，下一步是将其转化为计算机可以求解的问题。本练习将引导我们将连续的偏微分方程通过有限差分法进行离散化，并分析由此产生的代数方程组的结构。通过计算未知数的总数和系数矩阵的稀疏度，你将对多群扩散问题在计算中所面临的规模和挑战建立起直观认识，这是开发任何数值求解器的基础 。",
            "id": "4256050",
            "problem": "考虑一维空间中的稳态多群中子扩散方程，该问题包含 $G$ 个能量群，建立在具有 $N$ 个网格中心未知量的均匀网格上，并在两端施加狄利克雷边界条件（已知通量）。群 $g \\in \\{1,\\dots,G\\}$ 中标量通量 $\\phi_{g}(x)$ 的控制多群偏微分方程 (PDE) 具有以下形式\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(D_{g}(x)\\,\\frac{\\mathrm{d}\\phi_{g}(x)}{\\mathrm{d}x}\\right) + \\Sigma_{r,g}(x)\\,\\phi_{g}(x) \\;=\\; \\sum_{\\substack{g'=1 \\\\ g'\\neq g}}^{G} \\Sigma_{s,g'\\rightarrow g}(x)\\,\\phi_{g'}(x) + S_{g}(x),\n$$\n其中 $D_{g}(x)$ 是扩散系数，$\\Sigma_{r,g}(x)$ 是移出截面，$\\Sigma_{s,g'\\rightarrow g}(x)$ 是从群 $g'$ 到群 $g$ 的散射截面，$S_{g}(x)$ 是外部源。假设群间耦合是空间局域的（即，散射仅耦合位于同一网格中的未知量），并且对于所有 $g'\\neq g$ 的群对，所有群间散射截面 $\\Sigma_{s,g'\\rightarrow g}(x)$ 均为非零。\n\n使用标准的二阶中心有限差分 (FD) 格式对每个群的 $N$ 个网格中心未知量进行 PDE 离散化，从而为未知向量组装一个全局线性系统：\n$$\n\\boldsymbol{\\Phi} \\;=\\; \\begin{pmatrix}\\phi_{1,1} \\phi_{1,2} \\dots \\phi_{1,N} \\phi_{2,1} \\dots \\phi_{G,N}\\end{pmatrix}^{\\top},\n$$\n其中 $\\phi_{g,i}$ 表示在群 $g$、网格 $i \\in \\{1,\\dots,N\\}$ 处的离散通量。两端的狄利克雷边界条件以常规的有限差分方式施加，导致每个群内部产生最近邻空间耦合（内部行具有三点格式，边界行具有两点格式）。群间散射仅耦合同一空间网格内的通量（即，对于每个 $i$，$\\phi_{g,i}$ 与所有 $g'\\neq g$ 的 $\\phi_{g',i}$ 耦合），并且在这种局域散射之外，不同群之间不存在空间耦合。\n\n从这些基本原理和定义出发，推导组装后的全局系数矩阵的大小和结构。然后，计算：\n- 全局系统中的未知量总数，以及\n- 全局系数矩阵中的非零元总数，只计算唯一的非零位置。\n\n将你的最终答案表示为一个双元素行矩阵 $\\begin{pmatrix}U & Z\\end{pmatrix}$，其中 $U$ 是未知量的数量，$Z$ 是非零元的总数。请仅用 $G$ 和 $N$ 的符号形式给出你的答案。不需要数值，也不需要四舍五入。在最终答案中不要使用单位。",
            "solution": "问题陈述具有科学依据、内容自洽且提法良定。它描述了求解多群中子扩散方程的一种标准数值方法，该方程是核反应堆物理与工程的基石。所提供的数据、定义和约束条件是充分且一致的，足以按要求确定全局系数矩阵的大小和结构。\n\n全局线性系统具有 $\\mathbf{A}\\boldsymbol{\\Phi} = \\mathbf{b}$ 的形式，其中 $\\boldsymbol{\\Phi}$ 是所有未知离散通量值的向量。问题指定了该向量的排序方式，即按能量群分组：\n$$\n\\boldsymbol{\\Phi} \\;=\\; \\begin{pmatrix}\\boldsymbol{\\phi}_{1}^{\\top}  \\boldsymbol{\\phi}_{2}^{\\top}  \\dots  \\boldsymbol{\\phi}_{G}^{\\top}\\end{pmatrix}^{\\top}\n$$\n此处，每个 $\\boldsymbol{\\phi}_{g} = (\\phi_{g,1}, \\phi_{g,2}, \\dots, \\phi_{g,N})^{\\top}$ 是能量群 $g$ 在 $N$ 个空间网格上的 $N$ 个离散通量未知量的向量。\n\n首先，我们确定未知量的总数，记为 $U$。这是向量 $\\boldsymbol{\\Phi}$ 的总长度。因为有 $G$ 个能量群，每个群有 $N$ 个空间未知量，所以未知量的总数是二者的乘积：\n$$\nU = GN\n$$\n\n接下来，我们确定全局系数矩阵 $\\mathbf{A}$ 的结构，并计算其非零元的总数 $Z$。矩阵 $\\mathbf{A}$ 的维度是 $(GN) \\times (GN)$。根据指定的未知量排序，$\\mathbf{A}$ 可以看作一个 $G \\times G$ 的分块矩阵，其中每个分块 $\\mathbf{A}_{g,g'}$ 是一个 $N \\times N$ 的矩阵，描述了从群 $g'$到群 $g$ 的耦合。\n$$\n\\mathbf{A} = \\begin{pmatrix}\n\\mathbf{A}_{11}  \\mathbf{A}_{12}  \\dots  \\mathbf{A}_{1G} \\\\\n\\mathbf{A}_{21}  \\mathbf{A}_{22}  \\dots  \\mathbf{A}_{2G} \\\\\n\\vdots  \\vdots  \\ddots  \\vdots \\\\\n\\mathbf{A}_{G1}  \\mathbf{A}_{G2}  \\dots  \\mathbf{A}_{GG}\n\\end{pmatrix}\n$$\n非零元的总数 $Z$ 是所有这 $G^2$ 个分块中非零元数量的总和。我们分别分析对角分块和非对角分块。\n\n对角分块 $\\mathbf{A}_{gg}$（对于 $g \\in \\{1,\\dots,G\\}$）表示群 $g$ 的群内耦合。这种耦合源于扩散项 $-\\frac{\\mathrm{d}}{\\mathrm{d}x}(D_{g}\\frac{\\mathrm{d}\\phi_{g}}{\\mathrm{d}x})$ 和移出项 $\\Sigma_{r,g}\\phi_{g}$ 的空间离散化。问题指定了二阶中心有限差分格式。对于一个内部网格 $i \\in \\{2, \\dots, N-1\\}$，该格式创建了一个三点格式，将 $\\phi_{g,i}$ 与其相邻的 $\\phi_{g,i-1}$ 和 $\\phi_{g,i+1}$ 耦合起来。这导致分块 $\\mathbf{A}_{gg}$ 的第 $i$ 行中有 $3$ 个非零元。对于边界网格 $i=1$ 和 $i=N$，狄利克雷边界条件意味着区域两端的通量值是已知的，并被移到线性系统的右端项。因此，网格 $1$ 的格式仅耦合 $\\phi_{g,1}$ 和 $\\phi_{g,2}$，而网格 $N$ 的格式仅耦合 $\\phi_{g,N-1}$ 和 $\\phi_{g,N}$。这导致在 $\\mathbf{A}_{gg}$ 的第一行和最后一行中各有 $2$ 个非零元。因此，每个对角分块 $\\mathbf{A}_{gg}$ 都是一个 $N \\times N$ 的三对角矩阵。这样一个分块中的非零元数量为 $(N-2) \\times 3 + 2 \\times 2 = 3N - 6 + 4 = 3N - 2$。该公式对 $N \\geq 1$ 成立。由于有 $G$ 个这样的对角分块，它们对 $Z$ 的总贡献是 $G(3N - 2)$。\n\n对于 $g \\neq g'$ 的非对角分块 $\\mathbf{A}_{g,g'}$ 表示群间耦合，该耦合源于散射项 $\\sum_{g' \\neq g} \\Sigma_{s,g'\\rightarrow g}\\phi_{g'}$。问题陈述此耦合是“空间局域的”，意味着 $\\phi_{g,i}$ 仅与同一网格 $i$ 的 $\\phi_{g',i}$ 耦合。这意味着分块 $\\mathbf{A}_{g,g'}$ 是对角矩阵。问题还指明，对于 $g' \\neq g$，所有的群间散射截面 $\\Sigma_{s,g'\\rightarrow g}$ 都是非零的。因此，$\\mathbf{A}_{g,g'}$ 的 $N$ 个对角元素中的每一个都是非零的。每个非对角分块中的非零元数量恰好是 $N$。共有 $G^2 - G = G(G-1)$ 个这样的非对角分块。它们对 $Z$ 的总贡献是 $G(G-1)N$。\n\n非零元的总数 $Z$ 是所有对角分块和非对角分块贡献的总和：\n$$\nZ = (\\text{对角分块的非零元}) + (\\text{非对角分块的非零元})\n$$\n$$\nZ = G(3N - 2) + G(G-1)N\n$$\n展开并简化该表达式可得：\n$$\nZ = 3GN - 2G + G^2N - GN = G^2N + 2GN - 2G\n$$\n结果也可以表示为因式分解形式 $Z = G(GN + 2N - 2)$。\n\n所求的量是未知量的总数 $U = GN$ 和非零元的总数 $Z = G^2N + 2GN - 2G$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} GN \\quad G^{2}N + 2GN - 2G \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "高效求解离散化后产生的巨型线性方程组是反应堆数值模拟中的一个核心挑战。本练习将我们带入高等数值算法的领域，探讨如何为迭代求解器设计一个高效的“物理预条件子”。你将学习如何利用对中子泄漏、移除、散射和裂变等物理过程的理解，来构建一个能够显著加速计算收敛速度的预条件策略，这充分体现了物理洞察力在设计先进计算方法中的重要作用 。",
            "id": "4256048",
            "problem": "在用于核反应堆模拟的稳态多群中子扩散模型中，从中子守恒和菲克定律出发。对于每个能群 $g$，设中子流密度由 $\\,\\mathbf{J}_g = -D_g \\nabla \\phi_g\\,$ 给出，其中 $D_g$ 是扩散系数，$\\phi_g$ 是标量通量。守恒定律要求，中子的净泄漏加上所有局部损失等于进入能群 $g$ 的所有源项（包括从其他能群散射到 $g$ 群以及裂变产生）。利用这些原理，可以得到一个关于空间离散化后未知多群通量向量 $\\,\\boldsymbol{\\phi} = [\\phi_1,\\dots,\\phi_G]^\\top\\,$ 的线性系统，即\n$$\nA \\boldsymbol{\\phi} = \\boldsymbol{q},\n$$\n其中算子 $A$ 可以分裂为物理上不同的分量\n$$\nA = L + R - S - F.\n$$\n这里，$L$ 代表由 $-\\nabla \\cdot (D_g \\nabla \\,\\cdot\\,)$ 产生的群内泄漏，$R$ 是体现了吸收和迁出散射的局部损失的移出算子（在能群上是对角的，在空间上是局域的），$S$ 是通过从其他能群向某个能群散射来耦合通量的算子，$F$ 是带能谱加权的裂变产生算子。移出截面按群定义为\n$$\n\\Sigma_{r,g} = \\Sigma_{a,g} + \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g \\to g'},\n$$\n并且离散的移出算子 $R$ 在能群上是块对角的，在空间上是对角的，其元素为 $\\,\\Sigma_{r,g}\\,$。散射算子 $S$ 和裂变算子 $F$ 是群间耦合项，在离散化后通常在能量上是非对角的，在空间上是非局域的，而 $L$ 是一个对称椭圆算子，它耦合了每个群内部相邻的空间自由度。\n\n考虑使用Krylov方法（例如广义最小残差法，GMRES）求解 $\\,A \\boldsymbol{\\phi} = \\boldsymbol{q}\\,$。一个基于物理的预处理器 $M$ 应该易于求逆，并且其构建应受到算子分裂为泄漏、移出、散射和裂变部分的启发，优先考虑最局域和刚性的贡献。下面的哪个提案是使用块对角移出算子且由上述算子分裂严格证明的最合适的基于物理的预处理器？\n\nA. 选择 $\\,M = R\\,$，即一个在能群上块对角、在空间上对角的移出算子，因此左预处理得到 $\\,M^{-1}A = R^{-1}L + I - R^{-1}S - R^{-1}F\\,$。这种缩放归一化了主要的局域损失物理，使谱集中在 $\\,1\\,$ 附近，并为Krylov求解保留了耦合结构。\n\nB. 选择 $\\,M = L + R\\,$，即一个在能群上块对角的算子，包括群内泄漏和移出，通过为每个能群求解独立的亥姆霍兹型问题来求逆。这捕捉了空间和局域物理，但忽略了群间散射和裂变。\n\nC. 选择 $\\,M = S + F\\,$，即一个捕捉群间散射和裂变产生的算子，从而直接预处理非对角耦合，而将局域物理留给Krylov方法处理。\n\nD. 选择 $\\,M = \\operatorname{diag}(A)\\,$（雅可比），即 $A$ 的对角线，包括来自 $L$、$R$、$S$ 和 $F$ 的部分贡献，以保持简单性而不遵循任何特定的物理分裂。",
            "solution": "首先通过对其组成部分以及与既定科学原理的一致性进行系统分析，来验证问题陈述的有效性。\n\n### 步骤1：提取已知条件\n问题提供了以下信息：\n- **模型**：用于核反应堆模拟的稳态多群中子扩散。\n- **基本原理**：中子守恒和菲克定律。\n- **中子流密度**：对于每个能群 $g$ 为 $\\mathbf{J}_g = -D_g \\nabla \\phi_g$，其中 $D_g$ 是扩散系数，$\\phi_g$ 是标量通量。\n- **守恒定律**：净泄漏 + 局部损失 = 进入能群 $g$ 的所有源项。\n- **线性系统**：方程的离散形式为 $A \\boldsymbol{\\phi} = \\boldsymbol{q}$，其中 $\\boldsymbol{\\phi} = [\\phi_1, \\dots, \\phi_G]^\\top$ 是多群通量向量。\n- **算子分裂**：算子 $A$ 分解为 $A = L + R - S - F$。\n- **算子定义**：\n    - $L$：来自 $-\\nabla \\cdot (D_g \\nabla \\,\\cdot\\,)$ 的泄漏算子。它是一个对称椭圆算子，耦合每个群内相邻的空间自由度。\n    - $R$：移出算子（来自吸收和迁出散射的局部损失）。它在能群上是块对角的，在空间上是对角的，元素为 $\\Sigma_{r,g}$。\n    - $S$：散射算子，将通量从其他群耦合到一个群中。\n    - $F$：带能谱加权的裂变产生算子。\n    - $S$ 和 $F$ 被指出在离散化后在能量上是非对角的，在空间上是非局域的。\n- **移出截面**：$\\Sigma_{r,g} = \\Sigma_{a,g} + \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g \\to g'}$。\n- **求解方法**：将使用Krylov方法，如GMRES。\n- **预处理器要求**：寻求一个基于物理的预处理器 $M$，它应“易于求逆”， “由算子分裂驱动”，并“优先考虑最局域和刚性的贡献”。它还必须使用“块对角移出算子”。\n\n### 步骤2：使用提取的已知条件进行验证\n根据有效性标准对问题陈述进行评估。\n- **有科学依据**：该问题牢固地植根于核反应堆物理学领域。多群中子扩散方程、菲克定律以及算子分裂为泄漏、移出、散射和裂变分量，都是反应堆分析和模拟中的标准和基本概念。该公式在物理上和数学上都是合理的。\n- **适定的**：问题是适定的。它要求对一个著名线性系统的几种建议预处理策略进行评估。这是数值分析和计算科学中的一个标准课题。基于所述标准，在选项中存在一个“最合适的”选择，这是一个可以通过逻辑和物理推理解决的问题。\n- **客观性**：语言是技术性的、精确的，并且没有主观或模糊的术语。所有算子和概念都用标准的数学和物理术语定义。\n\n### 步骤3：结论与行动\n问题陈述被认为是科学上合理、适定、客观和自洽的。没有矛盾、事实错误或含糊之处。因此，该问题是**有效的**。分析将继续推导解决方案并评估给定的选项。\n\n### 解答与选项分析\n\n任务是为线性系统 $A\\boldsymbol{\\phi} = \\boldsymbol{q}$（其中 $A = L+R-S-F$）确定最合适的预处理器 $M$。理想的预处理器 $M$ 应近似于 $A$（$M \\approx A$），同时求逆代价低。对于Krylov方法，这旨在使预处理后的算子（例如 $M^{-1}A$）的特征值聚集，并加速收敛。问题指明 $M$ 应“易于求逆”，并基于物理算子分裂“优先考虑最局域和刚性的贡献”。\n\n让我们分析 $A$ 的分量：\n- $R$ (移出)：该算子在空间和能群上都是对角的。其元素 $\\Sigma_{r,g}$ 是宏观截面，它们是正的并且可能很大，使其成为一个“刚性”的对角分量。由于是对角的，$R$ 的求逆是平凡的：其逆是一个对角矩阵，元素为 $1 / \\Sigma_{r,g}$。该算子在空间上是纯局域的。\n- $L$ (泄漏)：该算子在能群上是块对角的，但在每个块内（对于单个能群），它耦合相邻的空间节点。它代表一个离散化的拉普拉斯算子。对 $L$ 求逆需要为每个能群求解一个稀疏线性系统，这并非平凡但计算上是可行的。它在空间上是非局域的，尽管具有紧凑的模板。\n- $S$ (散射) 和 $F$ (裂变)：这些算子耦合不同的能群，并导致 $A$ 的块外对角结构。对它们或包含它们的算子求逆通常计算上昂贵且复杂。\n\n基于这些标准：\n1. **“易于求逆”**：这强烈倾向于对角或具有易于求解块的块对角算子。纯对角算子是最容易求逆的。\n2. **“优先考虑最局域和刚性的贡献”**：移出算子 $R$ 既是纯局域的（在空间上是逐点的），又代表了 $A$ 的一个刚性对角贡献。泄漏算子 $L$ 也很刚性，但不是纯局域的。\n\n现在我们评估每个选项：\n\n**A. 选择 $\\,M = R\\,$，即一个在能群上块对角、在空间上对角的移出算子，因此左预处理得到 $\\,M^{-1}A = R^{-1}L + I - R^{-1}S - R^{-1}F\\,$。这种缩放归一化了主要的局域损失物理，使谱集中在 $\\,1\\,$ 附近，并为Krylov求解保留了耦合结构。**\n- **分析**：此选择使用移出算子 $R$ 作为预处理器。如前所述，$R$ 是对角的，其求逆是平凡的（计算开销小），完美满足“易于求逆”的标准。它代表了最局域的物理效应（逐点移出），并且通常是算子 $A$ 的一个主要的、刚性的部分。预处理后的算子 $M^{-1}A = R^{-1}A$ 的对角线上有一个单位矩阵 $I$，这对于预处理器来说是一个极好的性质，因为它倾向于使特征值聚集在 $1$ 附近。这种方法是基于物理的对角缩放的一种形式。该选项中提供的理由完全正确，并与预处理的原则一致。\n- **结论**：**正确**。此选项满足问题陈述中列出的所有要求。\n\n**B. 选择 $\\,M = L + R\\,$，即一个在能群上块对角的算子，包括群内泄漏和移出，通过为每个能群求解独立的亥姆霍兹型问题来求逆。这捕捉了空间和局域物理，但忽略了群间散射和裂变。**\n- **分析**：此选择使用完整的群内算子 $L+R$ 作为预处理器。这是一个非常有效的策略，通常被称为多群方程的块雅可比方法。它比单独使用 $R$ 是对 $A$ 更好的近似。然而，它的求逆需要为 $G$ 个能群中的每一个求解一个偏微分方程组（亥姆霍兹类型，$(-\\nabla \\cdot D_g \\nabla + \\Sigma_{r,g}) \\phi_g = \\text{源}$）。这是一项巨大的计算任务，不能像对角矩阵那样被描述为“易于求逆”。虽然是一种强大的技术，但它比选项A中的预处理器要复杂和昂贵得多。它还包含了非局域的泄漏算子 $L$，因此它不*仅仅*优先考虑最局域的贡献。\n- **结论**：**不正确**。与更简单的选择相比，这个预处理器并非“易于求逆”，也没有优先考虑*最*局域的物理，尽管它本身是一种有效且强大的预处理策略。题干中的标准指向一个更简单的选择。\n\n**C. 选择 $\\,M = S + F\\,$，即一个捕捉群间散射和裂变产生的算子，从而直接预处理非对角耦合，而将局域物理留给Krylov方法处理。**\n- **分析**：此选择建议使用群间耦合算子 $S$ 和 $F$ 进行预处理。算子 $M = S+F$ 将是复杂的，并且计算上求逆非常昂贵，因为它包含了所有的块外对角耦合。这直接违反了“易于求逆”的标准。此外，用算子的非对角部分进行预处理，而将通常占主导地位的对角部分（$L+R$）保留未经预处理，通常是一种不好的做法。这种方法作为 $A$ 的一个易于求逆的良好近似，在物理上是构思不当的。\n- **结论**：**不正确**。这是一个计算上昂贵且物理上构思不当的预处理器。\n\n**D. 选择 $\\,M = \\operatorname{diag}(A)\\,$（雅可比），即 $A$ 的对角线，包括来自 $L$、$R$、$S$ 和 $F$ 的部分贡献，以保持简单性而不遵循任何特定的物理分裂。**\n- **分析**：雅可比预处理器 $M = \\operatorname{diag}(A)$ 确实简单且易于求逆。$A$ 的对角线是 $\\operatorname{diag}(A) = \\operatorname{diag}(L) + R$，因为 $R$ 是对角的，而 $S$ 和 $F$（定义为散射*入*一个群）的对角线为零。虽然这是一个简单的预处理器，但该选项中提供的理由指出，选择它是为了“保持简单性*而*不遵循任何特定的物理分裂”。这明确地与问题的一个关键要求相矛盾，即预处理器必须“由算子分裂驱动”。选项A和B是直接从物理分裂的算子（$R$ 和 $L+R$）构建的。根据其自身的描述，此选项为了纯粹的数值简单性而抛弃了那种动机。\n- **结论**：**不正确**。选项中给出的理由与问题中要求基于算子分裂的物理动机不一致。\n\n### 结论\n\n比较这些选项，选项A提供了一个预处理器 $M=R$，它既极其容易求逆，又直接对应于算子分裂中的一个关键物理分量——局域且刚性的移出项。它完美地匹配了问题描述中为一个合适的、基本的基于物理的预处理器所设定的所有标准。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}