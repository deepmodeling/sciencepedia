{
    "hands_on_practices": [
        {
            "introduction": "扩散方程是反应堆物理分析的基石，但其有效性依赖于准确的宏观参数，例如扩散系数 $D$。本练习旨在揭示这些参数的物理来源，将中子输运理论与扩散近似联系起来。通过从给定的微观截面和散射各向异性数据出发，您将亲手计算宏观输运截面 $\\Sigma_{tr}$ 和扩散系数 $D$，从而深入理解扩散模型如何作为更基本物理原理的实用简化 。",
            "id": "4221762",
            "problem": "一个单能群中的均匀、无源、稳态中子场由扩散近似模型描述，该模型由稳态线性玻尔兹曼输运方程的前两个角矩导出。该材料表现出各向异性散射，由微观微分散射截面的勒让德多项式展开描述。微观勒让德矩 $\\sigma_{s,\\ell}$ 定义为该展开式中的系数，并采用中子输运理论中使用的常规归一化。该区域由单一材料占据，其对于该能群的微观总截面和微观散射勒让德矩由下式给出：\n$$\\sigma_{t} = 6.0\\ \\mathrm{b}, \\quad \\sigma_{s,0} = 5.0\\ \\mathrm{b}, \\quad \\sigma_{s,1} = 0.90\\ \\mathrm{b}, \\quad \\sigma_{s,2} = 0.30\\ \\mathrm{b}, \\quad \\sigma_{s,3} = 0.050\\ \\mathrm{b},$$\n其中 $\\mathrm{b}$ 表示靶恩，且 $1\\ \\mathrm{b} = 10^{-24}\\ \\mathrm{cm}^{2}$。原子核数密度为\n$$N = 8.0 \\times 10^{22}\\ \\mathrm{cm}^{-3}。$$\n从通过角通量密度的 $P_{1}$ 截断及相关的矩方程构建的扩散近似的基本原理出发，确定该能群的宏观输运截面 $\\Sigma_{tr}$ 和扩散系数 $D$。将 $\\Sigma_{tr}$ 以 $\\mathrm{cm}^{-1}$ 为单位表示，将 $D$ 以 $\\mathrm{cm}$ 为单位表示。将您的答案四舍五入到 $4$ 位有效数字。",
            "solution": "该问题要求基于中子输运方程的稳态、单能群 $P_1$ 近似，确定均匀、无源介质的宏观输运截面 $\\Sigma_{tr}$ 和扩散系数 $D$。\n\n$P_1$ 近似将中子角通量密度 $\\psi(\\mathbf{r}, \\mathbf{\\Omega})$ 的勒让德多项式展开在线性项之后截断：\n$$ \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\approx \\frac{1}{4\\pi} \\left[ \\phi(\\mathbf{r}) + 3 \\mathbf{\\Omega} \\cdot \\mathbf{J}(\\mathbf{r}) \\right] $$\n其中 $\\phi(\\mathbf{r})$ 是标量通量密度（零阶角矩），$\\mathbf{J}(\\mathbf{r})$ 是中子流密度（一阶角矩）。\n\n推导从稳态、单能群、无源的线性玻尔兹曼输运方程开始：\n$$ \\mathbf{\\Omega} \\cdot \\nabla \\psi(\\mathbf{r}, \\mathbf{\\Omega}) + \\Sigma_t \\psi(\\mathbf{r}, \\mathbf{\\Omega}) = \\int_{4\\pi} \\Sigma_s(\\mathbf{\\Omega}' \\to \\mathbf{\\Omega}) \\psi(\\mathbf{r}, \\mathbf{\\Omega}') d\\mathbf{\\Omega}' $$\n此处，$\\Sigma_t$ 是宏观总截面，$\\Sigma_s(\\mathbf{\\Omega}' \\to \\mathbf{\\Omega})$ 是微分散射截面。\n\n为了导出扩散近似，我们取该方程的前两个角矩。一阶矩（乘以 $\\mathbf{\\Omega}$ 并对所有立体角 $d\\mathbf{\\Omega}$ 积分）是定义扩散系数的方程。输运项 $\\mathbf{\\Omega} \\cdot \\nabla \\psi$ 的一阶矩为：\n$$ \\int_{4\\pi} \\mathbf{\\Omega} (\\mathbf{\\Omega} \\cdot \\nabla \\psi) d\\mathbf{\\Omega} = \\frac{1}{3} \\nabla \\phi(\\mathbf{r}) $$\n总碰撞项 $\\Sigma_t \\psi$ 的一阶矩为：\n$$ \\int_{4\\pi} \\mathbf{\\Omega} (\\Sigma_t \\psi) d\\mathbf{\\Omega} = \\Sigma_t \\mathbf{J}(\\mathbf{r}) $$\n散射源项的一阶矩为：\n$$ \\int_{4\\pi} \\mathbf{\\Omega} \\left[ \\int_{4\\pi} \\Sigma_s(\\mathbf{\\Omega}' \\to \\mathbf{\\Omega}) \\psi(\\mathbf{r}, \\mathbf{\\Omega}') d\\mathbf{\\Omega}' \\right] d\\mathbf{\\Omega} $$\n对于各向异性散射，微分截面被展开为勒让德多项式：\n$$ \\Sigma_s(\\mathbf{\\Omega}' \\to \\mathbf{\\Omega}) = \\sum_{\\ell=0}^{\\infty} \\frac{2\\ell+1}{4\\pi} \\Sigma_{s,\\ell} P_\\ell(\\mathbf{\\Omega} \\cdot \\mathbf{\\Omega}') $$\n其中 $\\Sigma_{s,\\ell}$ 是散射截面的宏观勒让德矩。将 $\\psi$ 的 $P_1$ 展开式和 $\\Sigma_s$ 的勒让德展开式代入，并利用勒让德多项式和球谐多项式的正交性，散射源的一阶矩简化为：\n$$ \\int_{4\\pi} \\mathbf{\\Omega} \\left[ \\text{Scattering Source} \\right] d\\mathbf{\\Omega} = \\Sigma_{s,1} \\mathbf{J}(\\mathbf{r}) $$\n关键要注意的是，在 $P_1$ 近似中，只有散射截面的 $\\ell=1$ 矩，即 $\\Sigma_{s,1}$，对一阶矩方程有贡献。所有更高阶的矩（$\\ell \\ge 2$）都没有影响。\n\n组合一阶矩方程的各项，得到：\n$$ \\frac{1}{3} \\nabla \\phi(\\mathbf{r}) + \\Sigma_t \\mathbf{J}(\\mathbf{r}) = \\Sigma_{s,1} \\mathbf{J}(\\mathbf{r}) $$\n重排此方程以求解中子流密度 $\\mathbf{J}(\\mathbf{r})$，得到：\n$$ (\\Sigma_t - \\Sigma_{s,1}) \\mathbf{J}(\\mathbf{r}) = - \\frac{1}{3} \\nabla \\phi(\\mathbf{r}) $$\n$$ \\mathbf{J}(\\mathbf{r}) = - \\frac{1}{3(\\Sigma_t - \\Sigma_{s,1})} \\nabla \\phi(\\mathbf{r}) $$\n该方程是菲克扩散定律，$\\mathbf{J}(\\mathbf{r}) = -D \\nabla \\phi(\\mathbf{r})$。通过比较，我们可以确定扩散系数 $D$ 和宏观输运截面 $\\Sigma_{tr}$。\n\n宏观输运截面 $\\Sigma_{tr}$ 定义为：\n$$ \\Sigma_{tr} = \\Sigma_t - \\Sigma_{s,1} $$\n扩散系数 $D$ 则定义为：\n$$ D = \\frac{1}{3 \\Sigma_{tr}} = \\frac{1}{3(\\Sigma_t - \\Sigma_{s,1})} $$\n\n问题给出了微观截面（$\\sigma$）和原子核数密度（$N$）。宏观截面（$\\Sigma$）通过关系式 $\\Sigma_x = N \\sigma_x$ 计算。所需数值为：\n原子核数密度: $N = 8.0 \\times 10^{22}\\ \\mathrm{cm}^{-3}$\n微观总截面: $\\sigma_t = 6.0\\ \\mathrm{b} = 6.0 \\times 10^{-24}\\ \\mathrm{cm}^2$\n微观散射一阶勒让德矩: $\\sigma_{s,1} = 0.90\\ \\mathrm{b} = 0.90 \\times 10^{-24}\\ \\mathrm{cm}^2$\n\n其他给定的值 $\\sigma_{s,0}$、$\\sigma_{s,2}$ 和 $\\sigma_{s,3}$ 在标准的 $P_1$ 框架内计算 $\\Sigma_{tr}$ 和 $D$ 时是不需要的。\n\n首先，我们计算宏观截面：\n$$ \\Sigma_t = N \\sigma_t = (8.0 \\times 10^{22}\\ \\mathrm{cm}^{-3}) \\times (6.0 \\times 10^{-24}\\ \\mathrm{cm}^2) = 0.48\\ \\mathrm{cm}^{-1} $$\n$$ \\Sigma_{s,1} = N \\sigma_{s,1} = (8.0 \\times 10^{22}\\ \\mathrm{cm}^{-3}) \\times (0.90 \\times 10^{-24}\\ \\mathrm{cm}^2) = 0.072\\ \\mathrm{cm}^{-1} $$\n\n现在，我们可以计算 $\\Sigma_{tr}$：\n$$ \\Sigma_{tr} = \\Sigma_t - \\Sigma_{s,1} = 0.48\\ \\mathrm{cm}^{-1} - 0.072\\ \\mathrm{cm}^{-1} = 0.408\\ \\mathrm{cm}^{-1} $$\n\n最后，我们计算 $D$：\n$$ D = \\frac{1}{3 \\Sigma_{tr}} = \\frac{1}{3 \\times 0.408\\ \\mathrm{cm}^{-1}} = \\frac{1}{1.224}\\ \\mathrm{cm} \\approx 0.81699346... \\ \\mathrm{cm} $$\n\n问题要求将答案四舍五入到 $4$ 位有效数字。\n$\\Sigma_{tr} = 0.4080\\ \\mathrm{cm}^{-1}$\n$D = 0.8170\\ \\mathrm{cm}$\n\n因此，宏观输运截面为 $0.4080\\ \\mathrm{cm}^{-1}$，扩散系数为 $0.8170\\ \\mathrm{cm}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4080  0.8170\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "反应堆的临界状态本质上是中子产生与泄漏之间的平衡，而几何形状和边界条件是决定中子泄漏的关键。本练习将通过一个具体的圆柱体反应堆案例，让您实践如何通过分离变量法和应用不同的边界条件（真空与理想反射）来求解几何曲率 $B_g^2$。通过计算边界条件变化对 $B_g^2$ 的影响，您将直观地理解边界在控制中子经济性中的核心作用，并掌握求解亥姆霍兹方程本征值问题的基本技能 。",
            "id": "4221764",
            "problem": "一个半径为 $R$、高度为 $H$ 的均匀、单能、裸露直圆柱体，在临界状态下，采用稳态中子扩散方程进行建模。该方程以齐次亥姆霍兹方程的形式，为具有方位角对称性的标量中子通量 $\\phi(\\mathbf{r})$ 在柱坐标 $(r,\\theta,z)$ 下建立。材料是均匀的，扩散长度为 $L$，所有表面要么是真空，要么是全反射。采用标准的扩散理论表示法，将真空边界表示为物理表面外推距离 $\\delta$ 处的零通量平面，其中 $\\delta=\\beta L$ 且 $\\beta=0.7104$。全反射表面在物理表面上被建模为零法向流（诺伊曼）边界。\n\n考虑两种情况：\n- 情况 V：所有物理表面均为真空边界。\n- 情况 R：弯曲的侧表面是真空，而位于 $z=\\pm H/2$ 的两个平面端面是全反射的。\n\n使用分离变量法和适当的边界条件，确定当从情况 V 过渡到情况 R 时，将轴向维度变为反射如何改变拉普拉斯算子的基本特征值，即基本几何曲率 $B_{g}^{2}$。具体来说，对于一个半径 $R = 0.40\\,\\mathrm{m}$、高度 $H = 1.00\\,\\mathrm{m}$、扩散长度 $L = 0.030\\,\\mathrm{m}$ 的圆柱体，计算其变化量 $\\Delta B_{g}^{2} \\equiv B_{g,\\mathrm{R}}^{2} - B_{g,\\mathrm{V}}^{2}$。将最终结果以 $\\mathrm{m}^{-2}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "本问题旨在计算一个均匀圆柱形反应堆在改变轴向边界条件时，其基本几何曲率 $B_g^2$ 的变化量。我们将分别求解两种情况下的几何曲率，然后计算其差值。\n\n### 理论推导\n\n对于一个临界、均匀的系统，稳态中子扩散方程可以写成亥姆霍兹方程的形式：\n$$\n\\nabla^2 \\phi(\\mathbf{r}) + B_g^2 \\phi(\\mathbf{r}) = 0\n$$\n其中 $\\phi$ 是中子通量，$B_g^2$ 是几何曲率。考虑到方位角对称性，在柱坐标 $(r, z)$ 中，拉普拉斯算子为：\n$$\n\\nabla^2 = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial}{\\partial r}\\right) + \\frac{\\partial^2}{\\partial z^2}\n$$\n我们使用分离变量法，假设解的形式为 $\\phi(r,z) = \\mathcal{R}(r) \\mathcal{Z}(z)$。将其代入亥姆霍兹方程并分离变量，得到两个常微分方程：\n$$\n\\frac{d^2\\mathcal{R}}{dr^2} + \\frac{1}{r}\\frac{d\\mathcal{R}}{dr} + B_r^2 \\mathcal{R} = 0 \\quad (\\text{径向方程})\n$$\n$$\n\\frac{d^2\\mathcal{Z}}{dz^2} + B_z^2 \\mathcal{Z} = 0 \\quad (\\text{轴向方程})\n$$\n总的几何曲率是径向和轴向分量之和：$B_g^2 = B_r^2 + B_z^2$。\n\n对于基模（物理上最可能存在的模式），解的形式为：\n- 径向解是第一类零阶贝塞尔函数：$\\mathcal{R}(r) = A J_0(B_r r)$。\n- 轴向解（中心在 $z=0$ 处对称）是余弦函数：$\\mathcal{Z}(z) = C \\cos(B_z z)$。\n\n边界条件决定了 $B_r^2$ 和 $B_z^2$ 的值。真空边界条件是在外推距离 $\\delta$ 处通量为零。反射边界条件是在物理边界处中子净流为零（即通量梯度为零）。\n\n外推距离为 $\\delta = \\beta L = 0.7104 \\times 0.030\\,\\mathrm{m} = 0.021312\\,\\mathrm{m}$。\n\n### 情况 V：所有表面均为真空边界\n\n在这种情况下，零通量边界条件应用于所有外推表面。\n- **径向**：外推半径为 $\\tilde{R} = R + \\delta$。边界条件为 $\\mathcal{R}(\\tilde{R}) = 0$。\n  $$ A J_0(B_r \\tilde{R}) = 0 $$\n  对于基模，我们取 $J_0$ 函数的第一个零点，记为 $j_{0,1} \\approx 2.4048$。因此，$B_r \\tilde{R} = j_{0,1}$。情况 V 的径向曲率为：\n  $$ B_{r,\\mathrm{V}}^2 = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 $$\n- **轴向**：外推高度为 $\\tilde{H} = H + 2\\delta$。零通量边界条件应用于 $z=\\pm\\tilde{H}/2$，因此 $\\mathcal{Z}(\\pm\\tilde{H}/2) = 0$。\n  $$ C \\cos(B_z \\tilde{H}/2) = 0 $$\n  对于基模，余弦函数的自变量必须为 $\\pi/2$。因此，$B_z \\tilde{H}/2 = \\pi/2$。情况 V 的轴向曲率为：\n  $$ B_{z,\\mathrm{V}}^2 = \\left(\\frac{\\pi}{H+2\\delta}\\right)^2 $$\n情况 V 的总几何曲率为：\n$$ B_{g,\\mathrm{V}}^2 = B_{r,\\mathrm{V}}^2 + B_{z,\\mathrm{V}}^2 = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 + \\left(\\frac{\\pi}{H+2\\delta}\\right)^2 $$\n\n### 情况 R：端面为反射边界\n\n在这种情况下，侧表面是真空边界，但位于 $z=\\pm H/2$ 的端面是全反射的。\n- **径向**：径向边界条件与情况 V 相同，因此径向曲率也相同：\n  $$ B_{r,\\mathrm{R}}^2 = B_{r,\\mathrm{V}}^2 = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 $$\n- **轴向**：轴向边界条件是在物理表面 $z=\\pm H/2$ 处法向流为零，即 $\\frac{d\\mathcal{Z}}{dz}|_{z=\\pm H/2} = 0$。\n  $\\mathcal{Z}(z)$ 的导数为 $\\frac{d\\mathcal{Z}}{dz} = -C B_z \\sin(B_z z)$。应用边界条件：\n  $$ -C B_z \\sin\\left(B_z \\frac{H}{2}\\right) = 0 $$\n  对于非平凡解，基模对应于最低的非负特征值，即 $B_z=0$。因此，情况 R 的轴向曲率为：\n  $$ B_{z,\\mathrm{R}}^2 = 0 $$\n这在物理上表示，由于端面完美反射，轴向没有净中子泄漏。情况 R 的总几何曲率为：\n$$ B_{g,\\mathrm{R}}^2 = B_{r,\\mathrm{R}}^2 + B_{z,\\mathrm{R}}^2 = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 $$\n\n### 计算变化量 $\\Delta B_g^2$\n\n几何曲率的变化量为 $\\Delta B_{g}^{2} = B_{g,\\mathrm{R}}^{2} - B_{g,\\mathrm{V}}^{2}$。\n$$\n\\Delta B_{g}^{2} = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 - \\left[ \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 + \\left(\\frac{\\pi}{H+2\\delta}\\right)^2 \\right]\n$$\n$$\n\\Delta B_{g}^{2} = -\\left(\\frac{\\pi}{H+2\\delta}\\right)^2\n$$\n这个变化量恰好是全真空情况下轴向曲率分量的负值，表示通过引入反射边界消除了轴向泄漏对几何曲率的贡献。\n\n现在我们代入给定的数值：\n$H = 1.00\\,\\mathrm{m}$\n$\\delta = 0.021312\\,\\mathrm{m}$\n$$\n\\Delta B_{g}^{2} = -\\left(\\frac{\\pi}{1.00\\,\\mathrm{m} + 2 \\times 0.021312\\,\\mathrm{m}}\\right)^2\n$$\n$$\n\\Delta B_{g}^{2} = -\\left(\\frac{\\pi}{1.00 + 0.042624}\\right)^2 \\mathrm{m}^{-2} = -\\left(\\frac{\\pi}{1.042624}\\right)^2 \\mathrm{m}^{-2}\n$$\n$$\n\\Delta B_{g}^{2} \\approx -(3.0131484)^2 \\mathrm{m}^{-2} \\approx -9.079061 \\mathrm{m}^{-2}\n$$\n将结果四舍五入到四位有效数字可得：\n$$\n\\Delta B_g^2 \\approx -9.079\\,\\mathrm{m}^{-2}\n$$\n这个负值表明，将端面变为反射会降低总的几何曲率（即减少中子泄漏），这与物理直觉相符。",
            "answer": "$$\\boxed{-9.079}$$"
        },
        {
            "introduction": "在实际反应堆设计中，为了提高中子利用率并减小堆芯尺寸，通常会使用反射层。然而，带反射层的系统分析会引入无法解析求解的超越方程。本练习将引导您完成从理论推导到数值实践的全过程：首先为球形反射堆推导临界条件，然后编写程序数值求解该方程，最终计算出关键工程参数——反射层节省 $\\Delta$ 。这项综合性练习将理论知识与计算技能相结合，是掌握现代反应堆模拟与分析方法的关键一步。",
            "id": "4221755",
            "problem": "一个球对称的双区核系统由一个半径为 $R$ 的均匀增殖堆芯和一个无限大的非增殖反射层包围组成。目标是通过稳态、单群中子扩散方程所蕴含的超越条件，数值求解临界堆芯半径 $R$，并报告反射层节省量 $\\Delta = R_{\\text{bare}} - R_{\\text{ref}}$。分析必须从单群扩散方程和标准界面条件出发，不得假设任何预先推导的几何关系。\n\n本问题的基本依据是每个区域的稳态单群中子扩散方程，以及堆芯-反射层界面处的中子通量和中子流的连续性，和在裸堆参考问题中通过外推长度实现的真空（零通量）边界条件。在一个具有特定材料属性的区域中，单群扩散方程为\n$$\nD \\nabla^2 \\phi(\\mathbf{x}) - \\Sigma_a \\phi(\\mathbf{x}) + S(\\mathbf{x}) = 0,\n$$\n其中 $D$ 是扩散系数，$\\Sigma_a$ 是宏观吸收截面，$S(\\mathbf{x})$ 是由裂变产生的中子源。对于处于临界稳态的增殖堆芯，将源模拟为 $S(\\mathbf{x}) = \\nu \\Sigma_f \\phi(\\mathbf{x})$，其中 $\\nu \\Sigma_f$ 是宏观产生截面。对于非增殖反射层，使用 $S(\\mathbf{x}) = 0$。将堆芯的材料曲率定义为\n$$\nB_m^2 = \\frac{\\nu \\Sigma_f - \\Sigma_a}{D},\n$$\n以及反射层的扩散长度定义为\n$$\nL_r = \\sqrt{\\frac{D_r}{\\Sigma_{a,r}}}.\n$$\n宏观截面和扩散系数在每个区域内均为正常数。在带有真空边界的裸堆参考问题中，于外推边界处施加零通量条件，其外推距离为 $\\delta \\approx 0.7104 \\lambda_{\\text{tr}}$，其中 $\\lambda_{\\text{tr}} = 1/\\Sigma_{\\text{tr}}$ 是输运平均自由程，$\\Sigma_{\\text{tr}}$ 是堆芯的宏观输运截面。简单的球形裸堆临界关系（用几何曲率表示）应从第一性原理推导得出。\n\n您的程序必须实现对由上述基础和边界/界面条件产生的球形带反射层堆超越条件的数值解，并且必须计算带反射层系统的相应临界堆芯半径 $R_{\\text{ref}}$，以及参考系统的裸堆临界半径 $R_{\\text{bare}}$。然后计算反射层节省量\n$$\n\\Delta = R_{\\text{bare}} - R_{\\text{ref}}.\n$$\n\n此问题中所有的物理输入和输出均使用厘米单位。所有长度（包括 $R_{\\text{bare}}$、$R_{\\text{ref}}$ 和 $\\Delta$）都以 $\\mathrm{cm}$ 表示。程序的最终输出必须是单行文本，包含为所提供的测试套件计算出的反射层节省量列表，格式为逗号分隔的列表并用方括号括起，其中每个条目都是一个以 $\\mathrm{cm}$ 为单位的浮点数。\n\n请为以下参数集的测试套件实现您的解决方案。每个测试用例提供堆芯参数 $(D_c, \\Sigma_{a,c}, \\nu \\Sigma_{f,c}, \\Sigma_{\\text{tr},c})$ 和反射层参数 $(D_r, \\Sigma_{a,r})$：\n\n- 测试用例 $1$（中等堆芯，类水反射层）：堆芯 $(D_c = 1.2\\,\\mathrm{cm}, \\Sigma_{a,c} = 0.015\\,\\mathrm{cm}^{-1}, \\nu \\Sigma_{f,c} = 0.045\\,\\mathrm{cm}^{-1}, \\Sigma_{\\text{tr},c} = 0.8\\,\\mathrm{cm}^{-1})$，反射层 $(D_r = 1.6\\,\\mathrm{cm}, \\Sigma_{a,r} = 0.006\\,\\mathrm{cm}^{-1})$。\n- 测试用例 $2$（相同堆芯，不良反射层）：堆芯 $(D_c = 1.0\\,\\mathrm{cm}, \\Sigma_{a,c} = 0.020\\,\\mathrm{cm}^{-1}, \\nu \\Sigma_{f,c} = 0.050\\,\\mathrm{cm}^{-1}, \\Sigma_{\\text{tr},c} = 0.9\\,\\mathrm{cm}^{-1})$，反射层 $(D_r = 0.5\\,\\mathrm{cm}, \\Sigma_{a,r} = 0.200\\,\\mathrm{cm}^{-1})$。\n- 测试用例 $3$（与测试用例2相同的堆芯，强反射层）：堆芯 $(D_c = 1.0\\,\\mathrm{cm}, \\Sigma_{a,c} = 0.020\\,\\mathrm{cm}^{-1}, \\nu \\Sigma_{f,c} = 0.050\\,\\mathrm{cm}^{-1}, \\Sigma_{\\text{tr},c} = 0.9\\,\\mathrm{cm}^{-1})$，反射层 $(D_r = 2.0\\,\\mathrm{cm}, \\Sigma_{a,r} = 0.002\\,\\mathrm{cm}^{-1})$。\n- 测试用例 $4$（弱超临界堆芯，良好反射层）：堆芯 $(D_c = 1.3\\,\\mathrm{cm}, \\Sigma_{a,c} = 0.019\\,\\mathrm{cm}^{-1}, \\nu \\Sigma_{f,c} = 0.021\\,\\mathrm{cm}^{-1}, \\Sigma_{\\text{tr},c} = 0.7\\,\\mathrm{cm}^{-1})$，反射层 $(D_r = 1.8\\,\\mathrm{cm}, \\Sigma_{a,r} = 0.004\\,\\mathrm{cm}^{-1})$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[x_1,x_2,x_3,x_4]$），其中每个 $x_i$ 是对应测试用例计算出的 $\\Delta$（单位为 $\\mathrm{cm}$）。\n\n数值方法必须稳健地找到带反射层堆超越条件的最小正根，该根对应于基波模，并且必须验证堆芯材料曲率为正。如果某个测试用例产生非正的材料曲率，程序应以数学上一致的方式优雅地处理它，即在最终列表中为该用例返回一个非数字的浮点结果（例如，not-a-number）。",
            "solution": "该问题要求确定一个球对称双区核反应堆的反射层节省量 $\\Delta = R_{\\text{bare}} - R_{\\text{ref}}$。这涉及到求解裸堆的临界半径 $R_{\\text{bare}}$ 和被无限大反射层包围的堆芯的临界半径 $R_{\\text{ref}}$。该分析基于单群稳态中子扩散方程。\n\n### 推导与求解方法\n\n求解过程需要推导并解决裸堆和带反射层球形堆芯这两种构型的临界条件。\n\n**1. 球坐标系下扩散方程的通解**\n\n在均匀区域中，单群稳态扩散方程为 $D \\nabla^2 \\phi - \\Sigma_a \\phi + S = 0$。在球对称情况下，$\\phi(\\mathbf{x}) = \\phi(r)$，拉普拉斯算子为 $\\nabla^2 \\phi = \\frac{1}{r} \\frac{d^2}{dr^2}(r\\phi)$。\n进行变量替换 $u(r) = r\\phi(r)$，扩散方程可简化为：\n$$\n\\frac{d^2u}{dr^2} + \\left(\\frac{S/\\phi - \\Sigma_a}{D}\\right)u = 0\n$$\n\n- 在**增殖堆芯**中，$S = \\nu \\Sigma_{f,c} \\phi_c$。方程变为：\n  $$\n  \\frac{d^2u_c}{dr^2} + B_{m,c}^2 u_c = 0 \\quad \\text{其中 } B_{m,c}^2 = \\frac{\\nu \\Sigma_{f,c} - \\Sigma_{a,c}}{D_c}\n  $$\n  $B_{m,c}^2$ 是堆芯的材料曲率。对于临界系统，必须有 $B_{m,c}^2 > 0$。通解为 $u_c(r) = A \\sin(B_{m,c} r) + C \\cos(B_{m,c} r)$。对应的通量为 $\\phi_c(r) = A \\frac{\\sin(B_{m,c} r)}{r} + C \\frac{\\cos(B_{m,c} r)}{r}$。由于通量在堆芯中心($r=0$)必须是有限的，我们必须设置 $C=0$。因此，堆芯中的通量解为：\n  $$\n  \\phi_c(r) = A \\frac{\\sin(B_{m,c} r)}{r}\n  $$\n\n- 在**非增殖反射层**中，$S=0$。方程变为：\n  $$\n  \\frac{d^2u_r}{dr^2} - \\frac{1}{L_r^2} u_r = 0 \\quad \\text{其中 } L_r^2 = \\frac{D_r}{\\Sigma_{a,r}}\n  $$\n  $L_r$ 是反射层中的扩散长度。通解为 $u_r(r) = F e^{-r/L_r} + G e^{r/L_r}$。对应的通量为 $\\phi_r(r) = F \\frac{e^{-r/L_r}}{r} + G \\frac{e^{r/L_r}}{r}$。由于反射层是无限大的，当 $r \\to \\infty$ 时通量必须保持有限，我们必须设置 $G=0$。因此，反射层中的通量解为：\n  $$\n  \\phi_r(r) = F \\frac{e^{-r/L_r}}{r}\n  $$\n\n**2. 裸堆临界条件**\n\n对于半径为 $R_{\\text{bare}}$ 的裸堆，边界条件是通量在外推半径 $\\tilde{R} = R_{\\text{bare}} + \\delta$ 处为零，其中 $\\delta = 0.7104 / \\Sigma_{\\text{tr},c}$。\n$$\n\\phi_c(\\tilde{R}) = A \\frac{\\sin(B_{m,c} \\tilde{R})}{\\tilde{R}} = 0\n$$\n对于非平凡解($A \\neq 0$)，基模解对应于 $B_{m,c} \\tilde{R} = \\pi$。\n这得出了裸堆临界半径的解析表达式：\n$$\nR_{\\text{bare}} = \\frac{\\pi}{B_{m,c}} - \\delta\n$$\n\n**3. 带反射层堆临界条件**\n\n对于半径为 $R_{\\text{ref}}$ 并被无限大反射层包围的堆芯，我们在界面 $r=R_{\\text{ref}}$ 处应用连续性条件：\n1.  **通量连续性：** $\\phi_c(R_{\\text{ref}}) = \\phi_r(R_{\\text{ref}})$。\n    $$\n    A \\frac{\\sin(B_{m,c} R_{\\text{ref}})}{R_{\\text{ref}}} = F \\frac{e^{-R_{\\text{ref}}/L_r}}{R_{\\text{ref}}} \\implies A \\sin(B_{m,c} R_{\\text{ref}}) = F e^{-R_{\\text{ref}}/L_r}\n    $$\n2.  **中子流连续性：** $J(r) = -D \\frac{d\\phi}{dr}$，因此 $-D_c \\frac{d\\phi_c}{dr}|_{R_{\\text{ref}}} = -D_r \\frac{d\\phi_r}{dr}|_{R_{\\text{ref}}}$。\n    计算导数并代入 $r=R_{\\text{ref}}$，可得：\n    $$\n    -D_c A \\left(\\frac{B_{m,c} R_{\\text{ref}} \\cos(B_{m,c} R_{\\text{ref}}) - \\sin(B_{m,c} R_{\\text{ref}})}{R_{\\text{ref}}^2}\\right) = -D_r \\left(-F \\frac{e^{-R_{\\text{ref}}/L_r}}{R_{\\text{ref}}^2} \\left(1 + \\frac{R_{\\text{ref}}}{L_r}\\right)\\right)\n    $$\n    利用通量连续性条件中的关系式消去常数 $A$ 和 $F$，并进行化简，得到关于带反射层临界半径 $R_{\\text{ref}}$ 的超越方程：\n    $$\n    -D_c (B_{m,c} R_{\\text{ref}} \\cot(B_{m,c} R_{\\text{ref}}) - 1) = D_r \\left(1 + \\frac{R_{\\text{ref}}}{L_r}\\right)\n    $$\n    整理后得到一个更常见的形式：\n    $$\n    D_c B_{m,c} \\cot(B_{m,c} R_{\\text{ref}}) - \\frac{D_c - D_r}{R_{\\text{ref}}} + \\frac{D_r}{L_r} = 0\n    $$\n    该方程没有解析解，必须通过数值方法求解 $R_{\\text{ref}}$。基模解对应于最小的正根，其值满足 $0  B_{m,c}R_{\\text{ref}}  \\pi$。\n\n**4. 数值实现算法**\n\n对于每个测试用例，算法如下：\n1.  计算堆芯材料曲率的平方 $B_{m,c}^2 = (\\nu \\Sigma_{f,c} - \\Sigma_{a,c}) / D_c$。如果 $B_{m,c}^2 \\le 0$，系统无法达到临界，为此用例返回非数字（`NaN`）。\n2.  如果 $B_{m,c}^2 > 0$，计算 $B_{m,c} = \\sqrt{B_{m,c}^2}$。\n3.  计算裸堆的外推距离 $\\delta = 0.7104 / \\Sigma_{\\text{tr},c}$。\n4.  计算裸堆临界半径 $R_{\\text{bare}} = \\pi/B_{m,c} - \\delta$。\n5.  计算反射层的扩散长度 $L_r = \\sqrt{D_r / \\Sigma_{a,r}}$。\n6.  使用数值求根算法（如Brent方法）在区间 $(0, \\pi/B_{m,c})$ 内求解超越方程 $f(R) = D_c B_{m,c} \\cot(B_{m,c} R) - \\frac{D_c - D_r}{R} + \\frac{D_r}{L_r} = 0$，得到最小正根 $R_{\\text{ref}}$。\n7.  计算反射层节省量 $\\Delta = R_{\\text{bare}} - R_{\\text{ref}}$。\n8.  对所有测试用例重复此过程，并按要求格式化输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves for the reflector savings in a spherical, one-group diffusion model.\n\n    The program calculates the critical radius for a bare core and a reflected core,\n    then computes the difference (reflector savings). The transcendental equation\n    for the reflected core is solved numerically.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case: (core_params, reflector_params)\n    # core_params: (D_c, Sigma_a_c, nu_Sigma_f_c, Sigma_tr_c)\n    # reflector_params: (D_r, Sigma_a_r)\n    test_cases = [\n        ((1.2, 0.015, 0.045, 0.8), (1.6, 0.006)),  # Test case 1\n        ((1.0, 0.020, 0.050, 0.9), (0.5, 0.200)),  # Test case 2\n        ((1.0, 0.020, 0.050, 0.9), (2.0, 0.002)),  # Test case 3\n        ((1.3, 0.019, 0.021, 0.7), (1.8, 0.004)),  # Test case 4\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        core_params, reflector_params = case\n        D_c, Sigma_a_c, nu_Sigma_f_c, Sigma_tr_c = core_params\n        D_r, Sigma_a_r = reflector_params\n\n        # Step 1: Calculate core material properties\n        # Material buckling squared\n        B_m_sq = (nu_Sigma_f_c - Sigma_a_c) / D_c\n\n        # If buckling is non-positive, core cannot be critical.\n        if B_m_sq = 0:\n            results.append(np.nan)\n            continue\n        \n        B_m = np.sqrt(B_m_sq)\n        \n        # Extrapolation distance for bare core\n        delta = 0.7104 / Sigma_tr_c\n\n        # Step 2: Calculate bare critical radius (R_bare)\n        R_bare = np.pi / B_m - delta\n\n        # Step 3: Calculate reflector properties\n        L_r_sq = D_r / Sigma_a_r\n        L_r = np.sqrt(L_r_sq)\n\n        # Step 4: Numerically solve for reflected critical radius (R_ref)\n        # The transcendental equation is:\n        # f(R) = D_c*B_m*cot(B_m*R) - (D_c - D_r)/R + D_r/L_r = 0\n        def transcendental_eq(R):\n            if R == 0:\n                # Based on limit analysis f(R) -> +inf as R->0+\n                # Return a large positive number to guide the solver\n                return np.inf \n            term1 = D_c * B_m / np.tan(B_m * R)\n            term2 = -(D_c - D_r) / R\n            term3 = D_r / L_r\n            return term1 + term2 + term3\n\n        # The fundamental mode root R_ref satisfies 0  B_m * R_ref  pi.\n        # We bracket the root for the solver.\n        bracket_low = 1e-9\n        bracket_high = np.pi / B_m - 1e-9\n\n        # Use a robust root-finding algorithm\n        try:\n            sol = root_scalar(transcendental_eq, bracket=[bracket_low, bracket_high], method='brentq')\n            R_ref = sol.root\n        except ValueError:\n            # This may happen if function does not have opposite signs at bracket ends,\n            # indicating an issue with problem parameters or the model's applicability.\n            R_ref = np.nan\n        \n        # Step 5: Calculate reflector savings\n        if np.isnan(R_ref):\n            delta_savings = np.nan\n        else:\n            delta_savings = R_bare - R_ref\n        \n        results.append(delta_savings)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}