{
    "hands_on_practices": [
        {
            "introduction": "理解核燃料增殖的潜力，始于对燃料内部中子经济学的牢固掌握。第一个实践练习将引导你使用简化的单群模型进行一项基础计算。通过推导混合铀燃料的关键中子学参数——再生因子 $\\eta$，你将定量地看到增殖性 ${}^{238}\\text{U}$ 的存在如何影响中子吸收和裂变中子产生的整体效率。",
            "id": "4227769",
            "problem": "一个均匀的无限二氧化铀燃料介质，使用单群（谱平均）表示法来模拟中子相互作用。该燃料包含铀，其中 ${}^{235}\\text{U}$ 的富集度为 $4.0$ 原子百分比，其余为 ${}^{238}\\text{U}$。铀原子总数密度为 $N_{\\mathrm{U}} = 2.40 \\times 10^{22} \\ \\mathrm{cm}^{-3}$。假设中子通量是稳态且空间均匀的，并忽略除铀以外的所有吸收剂。在所关注的中子能谱上平均的单群微观截面如下：\n- 对于 ${}^{235}\\text{U}$：裂变截面 $\\,\\sigma_{f,235} = 585 \\ \\mathrm{b}$，辐射俘获截面 $\\,\\sigma_{\\gamma,235} = 100 \\ \\mathrm{b}$。\n- 对于 ${}^{238}\\text{U}$：裂变截面 $\\,\\sigma_{f,238} = 0 \\ \\mathrm{b}$，辐射俘获截面 $\\,\\sigma_{\\gamma,238} = 2.4 \\ \\mathrm{b}$。\n使用 $1 \\ \\mathrm{b} = 10^{-24} \\ \\mathrm{cm}^{2}$。取每次 ${}^{235}\\text{U}$ 裂变产生的平均中子数为 $\\nu_{235} = 2.43$。\n\n仅从反应率的基本定义 $R = \\phi \\, \\Sigma$ 和宏观截面的基本定义 $\\Sigma = \\sum_{i} N_{i} \\sigma_{i}$（其中 $N_{i}$ 和 $\\sigma_{i}$ 分别是反应道 $i$ 的核素数密度和单群微观截面）出发，在代入给定数据之前，以符号形式完成以下任务：\n1. 推导燃料中总宏观吸收截面 $\\Sigma_{a,\\mathrm{fuel}}$ 的表达式，并明确显示可再生核素 ${}^{238}\\text{U}$ 的贡献。\n2. 推导所有燃料吸收中导致裂变的比例 $f_{f} = \\Sigma_{f,\\mathrm{fuel}} / \\Sigma_{a,\\mathrm{fuel}}$ 的表达式，并解释与一个假设的、在相同 ${}^{235}\\text{U}$ 数密度下仅存在 ${}^{235}\\text{U}$ 的情况相比，可再生核素 ${}^{238}\\text{U}$ 的存在如何改变这一比例。\n3. 利用您的结果，为给定的混合物定义并计算有效燃料再生因子 $\\eta_{\\mathrm{fuel}} = \\nu_{235} \\, \\Sigma_{f,235} / \\Sigma_{a,\\mathrm{fuel}}$。\n\n报告 $\\eta_{\\mathrm{fuel}}$ 的数值，四舍五入至四位有效数字。最终答案以无量纲量的形式表示。",
            "solution": "首先评估问题的有效性。所有给定的参数和条件都是核反应堆物理中单群中子学计算的标准参数和条件。截面值在物理上是现实的，富集度水平是典型的，原子数密度对于二氧化铀燃料是正确的。问题陈述是自洽的、逻辑一致的、适定的，要求基于基本原理进行推导和计算。它是科学上合理且客观的。因此，该问题被认为是有效的，可以制定解决方案。\n\n解决方案通过处理问题陈述中概述的三个任务来进行。我们从基于所提供的基本定义的符号推导开始。\n\n设 $e$ 为 ${}^{235}\\text{U}$ 的原子百分比富集度，以分数形式表示。铀同位素的数密度为：\n- ${}^{235}\\text{U}$ 的数密度：$N_{235} = e \\cdot N_{\\mathrm{U}}$\n- ${}^{238}\\text{U}$ 的数密度：$N_{238} = (1-e) \\cdot N_{\\mathrm{U}}$\n\n同位素 $i$ 的微观吸收截面 $\\sigma_{a,i}$ 是其裂变截面和辐射俘获截面之和：$\\sigma_{a,i} = \\sigma_{f,i} + \\sigma_{\\gamma,i}$。\n\n1. 总宏观吸收截面 $\\Sigma_{a,\\mathrm{fuel}}$ 的推导：\n混合物中给定反应的宏观截面是该反应对每种组成核素的宏观截面之和。因此，燃料的总宏观吸收截面 $\\Sigma_{a,\\mathrm{fuel}}$ 是 ${}^{235}\\text{U}$ 和 ${}^{238}\\text{U}$ 的吸收贡献之和。\n$$ \\Sigma_{a,\\mathrm{fuel}} = \\Sigma_{a,235} + \\Sigma_{a,238} $$\n使用定义 $\\Sigma = N \\sigma$，我们展开此表达式：\n$$ \\Sigma_{a,\\mathrm{fuel}} = N_{235} \\sigma_{a,235} + N_{238} \\sigma_{a,238} $$\n代入微观吸收截面的定义：\n$$ \\Sigma_{a,\\mathrm{fuel}} = N_{235} (\\sigma_{f,235} + \\sigma_{\\gamma,235}) + N_{238} (\\sigma_{f,238} + \\sigma_{\\gamma,238}) $$\n来自可再生同位素 ${}^{238}\\text{U}$ 的贡献明确地是第二项 $N_{238} (\\sigma_{f,238} + \\sigma_{\\gamma,238})$。由于问题陈述 $\\sigma_{f,238} = 0 \\ \\mathrm{b}$，该贡献简化为 $N_{238} \\sigma_{\\gamma,238}$，代表通过辐射俘获进行的寄生中子吸收。\n\n2. 裂变比例 $f_{f}$ 的推导与解释：\n所有燃料吸收中导致裂变的比例定义为 $f_{f} = \\Sigma_{f,\\mathrm{fuel}} / \\Sigma_{a,\\mathrm{fuel}}$。\n首先，我们表示总宏观裂变截面 $\\Sigma_{f,\\mathrm{fuel}}$：\n$$ \\Sigma_{f,\\mathrm{fuel}} = \\Sigma_{f,235} + \\Sigma_{f,238} = N_{235} \\sigma_{f,235} + N_{238} \\sigma_{f,238} $$\n鉴于 $\\sigma_{f,238} = 0$，这简化为：\n$$ \\Sigma_{f,\\mathrm{fuel}} = N_{235} \\sigma_{f,235} $$\n现在，我们可以使用第1部分的结果写出 $f_f$ 的表达式：\n$$ f_{f} = \\frac{\\Sigma_{f,\\mathrm{fuel}}}{\\Sigma_{a,\\mathrm{fuel}}} = \\frac{N_{235} \\sigma_{f,235}}{N_{235} (\\sigma_{f,235} + \\sigma_{\\gamma,235}) + N_{238} (\\sigma_{f,238} + \\sigma_{\\gamma,238})} $$\n解释：在一个假设只存在 ${}^{235}\\text{U}$（即 $N_{238}=0$）的情况下，这个比例将是 $f_{f,\\text{pure}} = \\frac{N_{235}\\sigma_{f,235}}{N_{235}(\\sigma_{f,235} + \\sigma_{\\gamma,235})} = \\frac{\\sigma_{f,235}}{\\sigma_{a,235}}$。可再生核素 ${}^{238}\\text{U}$ 的存在为分母增加了一个正项 $N_{238} \\sigma_{\\gamma,238}$。这在不增加裂变率的情况下增加了总吸收率。因此，在铀混合物中，导致裂变的吸收比例 $f_f$ 低于在纯 ${}^{235}\\text{U}$ 中的情况。${}^{238}\\text{U}$ 作为寄生吸收剂，降低了燃料相对于裂变的中子效率。\n\n3. 有效燃料再生因子 $\\eta_{\\mathrm{fuel}}$ 的定义与计算：\n问题定义了 $\\eta_{\\mathrm{fuel}} = \\nu_{235} \\, \\Sigma_{f,235} / \\Sigma_{a,\\mathrm{fuel}}$。注意，$\\Sigma_{f,235} = N_{235}\\sigma_{f,235}$，在本问题中与 $\\Sigma_{f,\\mathrm{fuel}}$ 相同。在物理上，$\\eta_{\\mathrm{fuel}}$ 代表燃料混合物中每吸收一个中子所产生的平均新裂变中子数。使用我们之前的结果：\n$$ \\eta_{\\mathrm{fuel}} = \\frac{\\nu_{235} (N_{235} \\sigma_{f,235})}{N_{235} (\\sigma_{f,235} + \\sigma_{\\gamma,235}) + N_{238} (\\sigma_{\\gamma,238})} $$\n为了计算该值，我们可以用总铀密度 $N_{\\mathrm{U}}$ 和富集度 $e$ 来表示同位素的数密度：\n$$ \\eta_{\\mathrm{fuel}} = \\frac{\\nu_{235} (e N_{\\mathrm{U}}) \\sigma_{f,235}}{(e N_{\\mathrm{U}})(\\sigma_{f,235} + \\sigma_{\\gamma,235}) + ((1-e)N_{\\mathrm{U}})(\\sigma_{\\gamma,238})} $$\n总铀数密度 $N_{\\mathrm{U}}$ 从分子和分母中约去，这是预料之中的，因为 $\\eta_{\\mathrm{fuel}}$ 是燃料材料成分的一个强度性质。\n$$ \\eta_{\\mathrm{fuel}} = \\frac{\\nu_{235} e \\sigma_{f,235}}{e (\\sigma_{f,235} + \\sigma_{\\gamma,235}) + (1-e) \\sigma_{\\gamma,238}} $$\n现在，我们将给定的数值代入这个符号表达式。由于截面出现在一个比率中，可以使用靶（$\\mathrm{b}$）作为单位。\n- $e = 0.040$ （对于 $4.0$ 原子百分比）\n- $\\nu_{235} = 2.43$\n- $\\sigma_{f,235} = 585 \\ \\mathrm{b}$\n- $\\sigma_{\\gamma,235} = 100 \\ \\mathrm{b}$\n- $\\sigma_{\\gamma,238} = 2.4 \\ \\mathrm{b}$\n\n分子：\n$$ \\nu_{235} e \\sigma_{f,235} = 2.43 \\times 0.040 \\times 585 = 56.862 $$\n分母：\n$$ e (\\sigma_{f,235} + \\sigma_{\\gamma,235}) + (1-e) \\sigma_{\\gamma,238} = 0.040 \\times (585 + 100) + (1-0.040) \\times 2.4 $$\n$$ = 0.040 \\times 685 + 0.960 \\times 2.4 $$\n$$ = 27.4 + 2.304 = 29.704 $$\n最后，我们计算 $\\eta_{\\mathrm{fuel}}$ 的比值：\n$$ \\eta_{\\mathrm{fuel}} = \\frac{56.862}{29.704} \\approx 1.914300... $$\n根据要求，四舍五入到四位有效数字，得到 $1.914$。",
            "answer": "$$\n\\boxed{1.914}\n$$"
        },
        {
            "introduction": "真实世界的反应堆燃料是异质的，这一事实引发了简单的均匀模型无法捕捉的复杂中子学现象。本练习深入探讨了共振自屏敝这一关键概念，即燃料的微观结构如何保护增殖性核素在共振能量处免于吸收中子。你将通过推导颗粒燃料的丹科夫因子 (Dancoff factor) 来模拟此效应，从而直接将燃料的物理设计与其有效核截面及整体中子学性能联系起来。",
            "id": "4227799",
            "problem": "考慮一個代表先進高溫氣冷堆（HTGR）燃料元件的非均勻燃料-慢化劑微觀結構，其中包含鈾-238（${}^{238}\\text{U}$）的球形二氧化鈾 $\\text{UO}_2$ 核心隨機嵌入石墨基體中。每個燃料核心的半徑為 $r$，佔據元件的體積分數為 $f$。在能量 $E_{0}$ 處存在一個主要的 ${}^{238}\\text{U}$ 俘獲共振，使用單能級 Breit–Wigner 形式對窄共振進行建模，其峰值微觀吸收截面為 $\\sigma_{0}$，總共振寬度為 $\\Gamma$，因此微觀吸收截面為\n$$\n\\sigma_{a}(E) \\;=\\; \\frac{\\sigma_{0}}{1 + \\left(\\frac{E - E_{0}}{\\Gamma}\\right)^{2}} \\, .\n$$\n假設入射中子能譜在共振寬度內足夠平坦，使得窄共振近似適用，並且穿過基體的輸運可以用能量 $E_{0}$ 附近一個恆定的慢化劑總宏觀截面 $\\Sigma_{t,m}$ 來表示。\n\n將 Dancoff 因子 $C$ 定義為一個剛從燃料核心逃逸到慢化劑中且未發生相互作用的中子，在與慢化劑發生任何相互作用之前進入另一個燃料核心的概率。在一個模型中，核心根據空間泊松過程放置，且慢化劑相互作用過程是無記憶的，將“首先撞擊另一個核心”和“首先在慢化劑中相互作用”之間的競爭視為兩個獨立的指數風險。利用這種競爭關係，推導出 Dancoff 因子 $C$ 作為 $f$、$r$ 和 $\\Sigma_{t,m}$ 的函數。然後，從窄共振近似和代表所有使共振“平坦化”的非共振過程的本底截面 $\\sigma_{b}$ 的定義出發，說明 $C$ 如何修正 ${}^{238}\\text{U}$ 所見的非均勻本底，使得\n$$\n\\sigma_{b} \\;=\\; \\sigma_{b,f} \\;+\\; (1 - C)\\,\\sigma_{b,m}^{(0)} \\, ,\n$$\n其中 $\\sigma_{b,f}$ 是核心內非共振本底（僅燃料）微觀截面，$\\sigma_{b,m}^{(0)}$ 是在沒有核心間耦合的情況下所見的慢化劑對本底的貢獻。最後，利用窄共振的結果，以 $\\sigma_{0}$ 和 $\\sigma_{b}$ 表示共振自屏因數 $g$，並使用以下符合物理實際的參數對 $g$ 進行數值計算：\n- 核心半徑 $r = 0.05 \\,\\mathrm{cm}$，\n- 核心體積分數 $f = 0.05$，\n- 共振能量附近的慢化劑總宏觀截面 $\\Sigma_{t,m} = 0.35 \\,\\mathrm{cm}^{-1}$，\n- ${}^{238}\\text{U}$ 共振峰值微觀截面 $\\sigma_{0} = 1200 \\,\\mathrm{b}$，\n- 燃料本底微觀截面 $\\sigma_{b,f} = 8 \\,\\mathrm{b}$，\n- 零耦合慢化劑本底微觀截面 $\\sigma_{b,m}^{(0)} = 20 \\,\\mathrm{b}$。\n\n將最終答案表示為無量綱的共振自屏因數 $g$。將答案四捨五入到四位有效數字。",
            "solution": "此問題需要在核反應堆物理學領域進行多步推導和計算，特別是關於非均勻介質中的共振自屏。解答將分四個部分進行：首先，推導 Dancoff 因子 $C$；其次，對給定的本底截面 $\\sigma_b$ 公式進行物理上的合理解釋；第三，在窄共振近似下推導共振自屏因數 $g$；第四，使用提供的參數對 $g$ 進行數值計算。\n\n**第一部分：Dancoff 因子 $C$ 的推導**\n\n問題將 Dancoff 因子 $C$ 定義為一個從燃料核心逃逸的中子在與慢化劑相互作用之前進入另一個核心的概率。所規定的模型是兩個獨立指數過程之間的競爭：（1）行進並撞擊另一個燃料核心，以及（2）在慢化劑內發生相互作用。\n\n設中子在慢化劑中行進的路徑長度為 $s$。在一個小路徑 $ds$ 上與慢化劑相互作用的概率是 $\\Sigma_{t,m} ds$，其中 $\\Sigma_{t,m}$ 是慢化劑的總宏觀截面。這意味著單位路徑長度的慢化劑相互作用率為 $\\lambda_m = \\Sigma_{t,m}$。\n\n撞擊另一個燃料核心的率 $\\lambda_h$ 可以被建模為隨機分佈的核心所呈現的宏觀“靶”截面。燃料核心的數密度 $N_k$ 是燃料的總體積分數 $f$ 除以單個球形核心的體積 $V_k = \\frac{4}{3}\\pi r^3$。\n$$N_k = \\frac{f}{V_k} = \\frac{f}{\\frac{4}{3}\\pi r^3}$$\n對於一個穿過慢化劑的中子，每个核心呈現的幾何截面積為 $\\sigma_{\\text{geom}} = \\pi r^2$。宏觀“撞擊”截面則是核心數密度與幾何截面積的乘積：\n$$\\lambda_h = \\Sigma_{\\text{hit}} = N_k \\sigma_{\\text{geom}} = \\left(\\frac{f}{\\frac{4}{3}\\pi r^3}\\right) (\\pi r^2) = \\frac{3f}{4r}$$\n這兩個過程（撞擊核心 vs. 在慢化劑中相互作用）之間的競爭是一個經典問題，涉及率為 $\\lambda_h$ 和 $\\lambda_m$ 的獨立指數分佈。“撞擊”事件在“相互作用”事件之前發生的概率由其發生率與任何事件發生的總率之比給出：\n$$C = \\frac{\\lambda_h}{\\lambda_h + \\lambda_m}$$\n代入率的表達式：\n$$C = \\frac{\\frac{3f}{4r}}{\\frac{3f}{4r} + \\Sigma_{t,m}}$$\n這可以通過代數運算重新整理為：\n$$C = \\frac{1}{1 + \\frac{4r\\Sigma_{t,m}}{3f}}$$\n這就是 Dancoff 因子作為 $f$、$r$ 和 $\\Sigma_{t,m}$ 函數的所求表達式。\n\n**第二部分：本底截面 $\\sigma_b$ 的合理解釋**\n\n每个吸收體原子的本底截面 $\\sigma_b$ 代表共振中子可能經歷的所有非共振散射和吸收過程的有效截面。在非均勻系統中，這由燃料核心本身和周圍慢化劑的貢獻組成。\n\n項 $\\sigma_{b,f}$ 是來自燃料材料內部非共振相互作用的微觀本底截面。任何在燃料核心內的中子都受到这个本底的影響。\n\n一個從燃料核心逃逸的中子進入慢化劑。在這裡，它面臨兩種可能性：它可以重新進入另一個燃料核心（一個由 Dancoff 因子 $C$ 決定的事件），或者它可以在慢化劑中發生相互作用。根據定義，它在撞擊另一個燃料核心之前與慢化劑相互作用的概率是 $1 - C$。\n\n項 $\\sigma_{b,m}^{(0)}$ 被定義為在沒有核心間耦合的極限情況下（即，在無限大慢化劑中的孤立核心，其中 $C=0$），慢化劑對本底截面的貢獻。該項有效地代表了慢化劑的散射截面，經過適當的均勻化並表示為每个燃料吸收體原子的量。\n\n在耦合系統中，只有當中子實際在慢化劑中相互作用時，它才能“看到”完整的慢化劑貢獻 $\\sigma_{b,m}^{(0)}$。由於對於一個已逃逸出核心的中子，此事件以概率 $1-C$ 發生，因此慢化劑對總本底截面的有效貢獻被这个因子所減小。因此，總本底截面是核心內本底和經 Dancoff 修正的慢化劑本底之和：\n$$\\sigma_{b} = \\sigma_{b,f} + (1 - C)\\,\\sigma_{b,m}^{(0)}$$\n因此，这个由問題提供的公式，在非均勻系統的等效理論框架內，通過 Dancoff 因子的概率性解釋得到了物理上的證明。\n\n**第三部分：共振自屏因數 $g$ 的推導**\n\n共振自屏因數 $g$ 量化了由於共振能量處的通量凹陷而導致的有效共振吸收的減少。它被定義為實際（被屏蔽）反應率與在未受擾動通量（無限稀釋情況）下會發生的反應率之比。\n$$g = \\frac{\\text{被屏蔽的反應率}}{\\text{未被屏蔽的反應率}} = \\frac{\\int \\sigma_a(E) \\phi(E) dE}{\\int \\sigma_a(E) \\phi_{\\text{unshielded}} dE}$$\n在具有本底截面 $\\sigma_b$ 的均勻系統的窄共振（NR）近似中，共振區間的通量 $\\phi(E)$ 與未被屏蔽的漸近通量 $\\phi_{\\text{unshielded}}$ 相關，關係式為：\n$$\\phi(E) = \\phi_{\\text{unshielded}} \\frac{\\sigma_b}{\\sigma_t(E)}$$\n其中 $\\sigma_t(E)$ 是每个吸收體原子的總微觀截面。問題陳述提供了俘獲共振的吸收截面 $\\sigma_a(E)$ 的 Breit-Wigner 形式。這意味著共振散射相比共振吸收可以忽略不計，因此我們可以將總微觀截面近似為共振吸收和總本底之和：$\\sigma_t(E) \\approx \\sigma_a(E) + \\sigma_b$。\n將此代入 $g$ 的定義中：\n$$g = \\frac{\\int \\sigma_a(E) \\left(\\phi_{\\text{unshielded}} \\frac{\\sigma_b}{\\sigma_a(E) + \\sigma_b}\\right) dE}{\\int \\sigma_a(E) \\phi_{\\text{unshielded}} dE} = \\frac{\\sigma_b \\int \\frac{\\sigma_a(E)}{\\sigma_a(E) + \\sigma_b} dE}{\\int \\sigma_a(E) dE}$$\n為計算這些積分，我們使用給定的形式 $\\sigma_a(E) = \\frac{\\sigma_0}{1+x^2}$，其中 $x = (E-E_0)/\\Gamma$。那麼 $dE = \\Gamma dx$。積分在共振的整個能量寬度上进行，對應於 $x$ 從 $-\\infty$ 到 $+\\infty$。\n\n分母為：\n$$\\int_{-\\infty}^{\\infty} \\sigma_a(x) \\Gamma dx = \\int_{-\\infty}^{\\infty} \\frac{\\sigma_0 \\Gamma}{1+x^2} dx = \\sigma_0 \\Gamma [\\arctan(x)]_{-\\infty}^{\\infty} = \\sigma_0 \\Gamma \\pi$$\n分子的積分為：\n$$\\int_{-\\infty}^{\\infty} \\frac{\\sigma_a(x)}{\\sigma_a(x) + \\sigma_b} \\Gamma dx = \\Gamma \\int_{-\\infty}^{\\infty} \\frac{\\frac{\\sigma_0}{1+x^2}}{\\frac{\\sigma_0}{1+x^2} + \\sigma_b} dx = \\Gamma \\int_{-\\infty}^{\\infty} \\frac{\\sigma_0}{\\sigma_0 + \\sigma_b(1+x^2)} dx$$\n$$= \\Gamma \\sigma_0 \\int_{-\\infty}^{\\infty} \\frac{1}{(\\sigma_0+\\sigma_b) + \\sigma_b x^2} dx = \\frac{\\Gamma \\sigma_0}{\\sigma_b} \\int_{-\\infty}^{\\infty} \\frac{1}{\\frac{\\sigma_0+\\sigma_b}{\\sigma_b} + x^2} dx$$\n令 $A^2 = \\frac{\\sigma_0+\\sigma_b}{\\sigma_b}$，該積分的形式為 $\\int \\frac{1}{A^2+x^2}dx = \\frac{1}{A}\\arctan(\\frac{x}{A})$。\n$$\\frac{\\Gamma \\sigma_0}{\\sigma_b} \\left[ \\frac{1}{\\sqrt{\\frac{\\sigma_0+\\sigma_b}{\\sigma_b}}} \\arctan\\left(\\frac{x}{\\sqrt{\\frac{\\sigma_0+\\sigma_b}{\\sigma_b}}}\\right) \\right]_{-\\infty}^{\\infty} = \\frac{\\Gamma \\sigma_0}{\\sigma_b} \\sqrt{\\frac{\\sigma_b}{\\sigma_0+\\sigma_b}} \\pi = \\frac{\\Gamma \\sigma_0 \\pi}{\\sqrt{\\sigma_b(\\sigma_0+\\sigma_b)}}$$\n$g$ 表達式的分子是 $\\sigma_b$ 乘以这个結果：\n$$\\text{分子} = \\sigma_b \\cdot \\frac{\\Gamma \\sigma_0 \\pi}{\\sqrt{\\sigma_b(\\sigma_0+\\sigma_b)}} = \\frac{\\Gamma \\sigma_0 \\pi \\sqrt{\\sigma_b}}{\\sqrt{\\sigma_0+\\sigma_b}}$$\n最後，將分子除以分母：\n$$g = \\frac{\\frac{\\Gamma \\sigma_0 \\pi \\sqrt{\\sigma_b}}{\\sqrt{\\sigma_0+\\sigma_b}}}{\\Gamma \\sigma_0 \\pi} = \\sqrt{\\frac{\\sigma_b}{\\sigma_0+\\sigma_b}} = \\frac{1}{\\sqrt{1 + \\sigma_0/\\sigma_b}}$$\n\n**第四部分：數值計算**\n\n問題提供了以下參數：\n- $r = 0.05 \\,\\mathrm{cm}$\n- $f = 0.05$\n- $\\Sigma_{t,m} = 0.35 \\,\\mathrm{cm}^{-1}$\n- $\\sigma_{0} = 1200 \\,\\mathrm{b}$\n- $\\sigma_{b,f} = 8 \\,\\mathrm{b}$\n- $\\sigma_{b,m}^{(0)} = 20 \\,\\mathrm{b}$\n\n首先，我們計算 Dancoff 因子 $C$：\n$$\\frac{4r\\Sigma_{t,m}}{3f} = \\frac{4(0.05)(0.35)}{3(0.05)} = \\frac{4(0.35)}{3} = \\frac{1.4}{3} = \\frac{14}{30} = \\frac{7}{15}$$\n$$C = \\frac{1}{1 + \\frac{7}{15}} = \\frac{1}{\\frac{22}{15}} = \\frac{15}{22}$$\n\n接下來，我們計算總本底截面 $\\sigma_b$：\n$$1-C = 1 - \\frac{15}{22} = \\frac{7}{22}$$\n$$\\sigma_b = \\sigma_{b,f} + (1 - C)\\sigma_{b,m}^{(0)} = 8 \\,\\mathrm{b} + \\left(\\frac{7}{22}\\right)(20 \\,\\mathrm{b}) = 8 + \\frac{140}{22} = 8 + \\frac{70}{11} \\,\\mathrm{b}$$\n$$\\sigma_b = \\frac{88 + 70}{11} \\,\\mathrm{b} = \\frac{158}{11} \\,\\mathrm{b}$$\n數值上，$\\sigma_b \\approx 14.3636 \\,\\mathrm{b}$。\n\n最後，我們計算自屏因數 $g$：\n$$\\frac{\\sigma_0}{\\sigma_b} = \\frac{1200}{158/11} = \\frac{1200 \\times 11}{158} = \\frac{13200}{158} = \\frac{6600}{79}$$\n$$g = \\frac{1}{\\sqrt{1 + \\frac{\\sigma_0}{\\sigma_b}}} = \\frac{1}{\\sqrt{1 + \\frac{6600}{79}}} = \\frac{1}{\\sqrt{\\frac{79+6600}{79}}} = \\sqrt{\\frac{79}{6679}}$$\n$$g \\approx \\sqrt{0.0118281} \\approx 0.1087571$$\n四捨五入到四位有效數字，共振自屏因數為 $0.1088$。",
            "answer": "$$\\boxed{0.1088}$$"
        },
        {
            "introduction": "任何反应堆模拟的预测结果，其可靠性都取决于其所依赖的核数据，而这些数据总是带有固有的不确定性。最后的这个实践练习将挑战你量化这些数据不确定性对增殖比 (Breeding Ratio, BR) 的影响，这是增殖堆的一个关键性能指标。你将实现并比较两种强大的不确定性传播技术——线性化协方差传播和蒙特卡洛抽样，从而在评估模拟结果的稳健性和置信度方面获得实践技能。",
            "id": "4227793",
            "problem": "您的任务是实现一个程序，量化在一个简化的快中子反应堆燃料模型中，多群核数据中截面的不确定性如何传播到增殖比（BR），然后将线性化协方差传播估计与直接蒙特卡罗抽样估计进行比较。重点是燃料材料类型（可增殖核素增殖为易裂变核素，易裂变核素被消耗）与增殖概念在多群设置中的相互作用。\n\n从以下基本模型开始：\n- 能量群 $g$ 中反应类型 $x$ 的反应率是 $R_{x,g} = \\phi_g N \\sigma_{x,g}$，其中 $\\phi_g$ 是群 $g$ 中的中子通量（单位为 $\\mathrm{cm^{-2}\\,s^{-1}}$），$N$ 是数密度（单位为 $\\mathrm{cm^{-3}}$），$\\sigma_{x,g}$ 是群微观截面（单位为 $\\mathrm{cm^{2}}$）。\n- 在可增殖-易裂变燃料混合物中，增殖比 $BR$ 定义为通过可增殖核素中的中子俘获产生新易裂变原子的速率与易裂变原子的消耗速率（总吸收，即裂变加俘获）之比。在一个具有可增殖俘获截面 $\\sigma^{(F)}_{c,g}$ 和易裂变吸收截面 $\\sigma^{(Fi)}_{a,g}$ 的 $G$-群模型中，BR为\n$$\nBR = \\frac{\\sum_{g=1}^{G} \\phi_g N_F \\sigma^{(F)}_{c,g}}{\\sum_{g=1}^{G} \\phi_g N_{Fi} \\sigma^{(Fi)}_{a,g}},\n$$\n此值为无量纲。只有截面被视为不确定量；中子通量和数密度被视为已知常数。\n\n线性化协方差传播应通过对 $BR(\\mathbf{s})$ 在平均截面附近进行一阶泰勒展开来执行，其中 $\\mathbf{s}$ 是一个 $2G$ 维的截面向量，其顺序为 $\\mathbf{s} = [\\sigma^{(F)}_{c,1},\\ldots,\\sigma^{(F)}_{c,G},\\sigma^{(Fi)}_{a,1},\\ldots,\\sigma^{(Fi)}_{a,G}]^\\top$。如果 $\\mathbf{s}$ 的协方差是矩阵 $\\mathbf{C}$，并且 $BR$ 相对于 $\\mathbf{s}$ 在平均值处的梯度（雅可比矩阵）是向量 $\\mathbf{J}$，那么线性化方差为\n$$\n\\mathrm{Var}_{\\mathrm{lin}}(BR) \\approx \\mathbf{J}^\\top \\mathbf{C}\\,\\mathbf{J}.\n$$\n\n此外，使用多元正态抽样实现一个蒙特卡罗估计器，其均值等于名义截面向量，协方差为 $\\mathbf{C}$，并满足以下实际约束：\n- 根据物理原理，截面是非负的；任何抽样得到的负截面值必须被截断为零。\n- 如果某次抽样实现导致 BR 定义中的分母为非正值，则从蒙特卡罗统计中舍弃该样本。\n- 为保证可复现性，使用固定的随机种子 $20231105$。\n- 每个测试用例使用 $50000$ 个样本。\n\n所有通量 $\\phi_g$ 的单位为 $\\mathrm{cm^{-2}\\,s^{-1}}$，数密度 $N$ 的单位为 $\\mathrm{cm^{-3}}$，截面的单位为 $\\mathrm{cm^{2}}$。增殖比 $BR$ 及其不确定性是无量纲的，并且必须以十进制浮点数形式报告。\n\n您的程序必须为每个测试用例计算：\n- 在平均截面处计算的名义 $BR$。\n- 线性化标准差 $\\sigma_{\\mathrm{lin}}(BR) = \\sqrt{\\mathrm{Var}_{\\mathrm{lin}}(BR)}$。\n- 在保留样本上的蒙特卡罗样本均值 $BR_{\\mathrm{MC}}$。\n- 在保留样本上的蒙特卡罗样本标准差 $\\sigma_{\\mathrm{MC}}(BR)$。\n- 平均值的相对差异，定义为 $(BR_{\\mathrm{MC}} - BR_{\\mathrm{nom}})/BR_{\\mathrm{nom}}$。\n- 标准差的相对差异，定义为 $(\\sigma_{\\mathrm{MC}}(BR) - \\sigma_{\\mathrm{lin}}(BR))/\\sigma_{\\mathrm{lin}}(BR)$。\n\n您的程序必须生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，按以下确切顺序将所有测试用例的结果展平：\n$$\n[\\;BR_{\\mathrm{nom}}^{(1)},\\;\\sigma_{\\mathrm{lin}}^{(1)},\\;BR_{\\mathrm{MC}}^{(1)},\\;\\sigma_{\\mathrm{MC}}^{(1)},\\;\\Delta_{\\mathrm{mean}}^{(1)},\\;\\Delta_{\\mathrm{std}}^{(1)},\\;BR_{\\mathrm{nom}}^{(2)},\\;\\sigma_{\\mathrm{lin}}^{(2)},\\;BR_{\\mathrm{MC}}^{(2)},\\;\\sigma_{\\mathrm{MC}}^{(2)},\\;\\Delta_{\\mathrm{mean}}^{(2)},\\;\\Delta_{\\mathrm{std}}^{(2)},\\;BR_{\\mathrm{nom}}^{(3)},\\;\\sigma_{\\mathrm{lin}}^{(3)},\\;BR_{\\mathrm{MC}}^{(3)},\\;\\sigma_{\\mathrm{MC}}^{(3)},\\;\\Delta_{\\mathrm{mean}}^{(3)},\\;\\Delta_{\\mathrm{std}}^{(3)}\\;].\n$$\n\n测试套件：\n- 测试用例 1 ($G=2$)：\n  - $\\phi = [7\\times 10^{14},\\;3\\times 10^{14}]$。\n  - $N_F = 4.5\\times 10^{22}$，$N_{Fi} = 1.0\\times 10^{22}$。\n  - 平均可增殖俘获截面 $\\mu^{(F)}_{c} = [0.25\\times 10^{-24},\\;0.05\\times 10^{-24}]$。\n  - 平均易裂变吸收截面 $\\mu^{(Fi)}_{a} = [1.6\\times 10^{-24},\\;0.9\\times 10^{-24}]$。\n  - 可增殖俘获的标准差 $\\sigma^{(F)}_{c} = [0.025\\times 10^{-24},\\;0.010\\times 10^{-24}]$。\n  - 易裂变吸收的标准差 $\\sigma^{(Fi)}_{a} = [0.080\\times 10^{-24},\\;0.063\\times 10^{-24}]$。\n  - 相关矩阵（分块对角，交叉块为零）：\n    - 可增殖俘获块 $\\mathbf{R}_{cc} = \\begin{bmatrix}1  0.3 \\\\ 0.3  1\\end{bmatrix}$。\n    - 易裂变吸收块 $\\mathbf{R}_{aa} = \\begin{bmatrix}1  0.2 \\\\ 0.2  1\\end{bmatrix}$。\n- 测试用例 2 ($G=3$)：\n  - $\\phi = [4\\times 10^{14},\\;4\\times 10^{14},\\;2\\times 10^{14}]$。\n  - $N_F = 5.0\\times 10^{22}$，$N_{Fi} = 0.8\\times 10^{22}$。\n  - 平均可增殖俘获截面 $\\mu^{(F)}_{c} = [0.35\\times 10^{-24},\\;0.12\\times 10^{-24},\\;0.03\\times 10^{-24}]$。\n  - 平均易裂变吸收截面 $\\mu^{(Fi)}_{a} = [1.0\\times 10^{-24},\\;0.7\\times 10^{-24},\\;0.4\\times 10^{-24}]$。\n  - 可增殖俘获的标准差 $\\sigma^{(F)}_{c} = [0.042\\times 10^{-24},\\;0.018\\times 10^{-24},\\;0.0075\\times 10^{-24}]$。\n  - 易裂变吸收的标准差 $\\sigma^{(Fi)}_{a} = [0.050\\times 10^{-24},\\;0.042\\times 10^{-24},\\;0.032\\times 10^{-24}]$。\n  - 相关矩阵（分块对角，交叉块为零）：\n    - 可增殖俘获块 $\\mathbf{R}_{cc}$ 的对角线元素为1，所有非对角线元素为 $0.4$。\n    - 易裂变吸收块 $\\mathbf{R}_{aa}$ 的对角线元素为1，所有非对角线元素为 $0.5$。\n- 测试用例 3 ($G=2$)：\n  - $\\phi = [1\\times 10^{15},\\;1\\times 10^{14}]$。\n  - $N_F = 4.0\\times 10^{22}$，$N_{Fi} = 0.5\\times 10^{22}$。\n  - 平均可增殖俘获截面 $\\mu^{(F)}_{c} = [0.20\\times 10^{-24},\\;0.06\\times 10^{-24}]$。\n  - 平均易裂变吸收截面 $\\mu^{(Fi)}_{a} = [0.30\\times 10^{-24},\\;0.08\\times 10^{-24}]$。\n  - 可增殖俘获的标准差 $\\sigma^{(F)}_{c} = [0.030\\times 10^{-24},\\;0.009\\times 10^{-24}]$。\n  - 易裂变吸收的标准差 $\\sigma^{(Fi)}_{a} = [0.090\\times 10^{-24},\\;0.024\\times 10^{-24}]$。\n  - 相关矩阵（分块对角，交叉块为零）：\n    - 可增殖俘获块 $\\mathbf{R}_{cc} = \\begin{bmatrix}1  0.1 \\\\ 0.1  1\\end{bmatrix}$。\n    - 易裂变吸收块 $\\mathbf{R}_{aa} = \\begin{bmatrix}1  -0.3 \\\\ -0.3  1\\end{bmatrix}$。\n\n实现要求：\n- 构建协方差矩阵 $\\mathbf{C}$ 为 $\\mathbf{C} = \\mathbf{S}\\,\\mathbf{R}\\,\\mathbf{S}$，其中 $\\mathbf{S}$ 是一个对角矩阵，其对角线元素是与 $\\mathbf{s}$ 顺序匹配的标准差，$\\mathbf{R}$ 是由 $\\mathbf{R}_{cc}$ 和 $\\mathbf{R}_{aa}$ 构建的分块对角相关矩阵。\n- 计算在平均截面处的梯度 $\\mathbf{J}$ 并评估 $\\mathrm{Var}_{\\mathrm{lin}}(BR)$。\n- 使用指定的随机种子和样本数量执行蒙特卡罗抽样。\n- 将小于零的抽样截面截断为零，舍弃分母为非正值的样本，并使用保留的样本来估计 $BR_{\\mathrm{MC}}$ 和 $\\sigma_{\\mathrm{MC}}(BR)$。\n- 按照上面指定的精确展平顺序，以单行形式生成最终输出。\n\n所有最终数值结果必须以十进制浮点数形式输出，并放在一个由方括号括起来的逗号分隔列表中，不含任何附加文本。增殖比和标准差是无量纲的；输出值无需单位转换。",
            "solution": "该问题要求在一个简化的反应堆物理模型中对增殖比（$BR$）的不确定性进行量化。我们需要比较一阶泰勒级数近似（线性化不确定性传播）与更直接的蒙特卡罗（MC）抽样方法。这个问题定义明确，具有科学依据，并为得到唯一解提供了所有必要的数据。\n\n设能量群的数量为 $G$。增殖比定义为：\n$$\nBR = \\frac{\\sum_{g=1}^{G} \\phi_g N_F \\sigma^{(F)}_{c,g}}{\\sum_{g=1}^{G} \\phi_g N_{Fi} \\sigma^{(Fi)}_{a,g}}\n$$\n其中 $\\phi_g$ 是群 $g$ 中的中子通量， $N_F$ 和 $N_{Fi}$ 分别是可增殖核素和易裂变核素的数密度，$\\sigma^{(F)}_{c,g}$ 是群 $g$ 中的可增殖俘获截面，$\\sigma^{(Fi)}_{a,g}$ 是群 $g$ 中的易裂变吸收截面。\n\n为方便起见，我们将分子和分母定义为截面的独立函数：\n$$\nNum(\\boldsymbol{\\sigma}^{(F)}_c) = \\sum_{g=1}^{G} \\phi_g N_F \\sigma^{(F)}_{c,g} = \\mathbf{w}_F^\\top \\boldsymbol{\\sigma}^{(F)}_c\n$$\n$$\nDen(\\boldsymbol{\\sigma}^{(Fi)}_a) = \\sum_{g=1}^{G} \\phi_g N_{Fi} \\sigma^{(Fi)}_{a,g} = \\mathbf{w}_{Fi}^\\top \\boldsymbol{\\sigma}^{(Fi)}_a\n$$\n这里我们引入了权重向量 $\\mathbf{w}_F = [\\phi_1 N_F, \\dots, \\phi_G N_F]^\\top$ 和 $\\mathbf{w}_{Fi} = [\\phi_1 N_{Fi}, \\dots, \\phi_G N_{Fi}]^\\top$，以及截面向量 $\\boldsymbol{\\sigma}^{(F)}_c$ 和 $\\boldsymbol{\\sigma}^{(Fi)}_a$。总截面向量是一个 $2G$ 维向量 $\\mathbf{s} = [\\boldsymbol{\\sigma}^{(F)\\top}_c, \\boldsymbol{\\sigma}^{(Fi)\\top}_a]^\\top$。\n\n名义增殖比 $BR_{\\mathrm{nom}}$ 是使用截面的平均值 $\\boldsymbol{\\mu}_{\\mathbf{s}}$ 计算的：\n$$\nBR_{\\mathrm{nom}} = \\frac{Num(\\boldsymbol{\\mu}^{(F)}_c)}{Den(\\boldsymbol{\\mu}^{(Fi)}_a)} = \\frac{\\sum_{g=1}^{G} \\phi_g N_F \\mu^{(F)}_{c,g}}{\\sum_{g=1}^{G} \\phi_g N_{Fi} \\mu^{(Fi)}_{a,g}}\n$$\n\n### 线性化不确定性传播\n\n$BR$ 的方差可以通过在平均截面值 $\\boldsymbol{\\mu}_{\\mathbf{s}}$ 附近进行一阶泰勒展开来近似。该方差由 $\\mathrm{Var}_{\\mathrm{lin}}(BR) \\approx \\mathbf{J}^\\top \\mathbf{C}\\,\\mathbf{J}$ 给出，其中 $\\mathbf{J}$ 是 $BR$ 相对于截面向量 $\\mathbf{s}$ 的雅可比矩阵（梯度），$\\mathbf{C}$ 是 $\\mathbf{s}$ 的协方差矩阵。梯度和协方差矩阵都在平均值处进行计算。\n\n梯度向量 $\\mathbf{J} = \\nabla_{\\mathbf{s}} BR$ 有 $2G$ 个分量。\n对于可增殖俘获截面（$i=1, \\dots, G$）：\n$$\nJ_i = \\frac{\\partial BR}{\\partial \\sigma^{(F)}_{c,i}} = \\frac{\\partial}{\\partial \\sigma^{(F)}_{c,i}}\\left(\\frac{Num}{Den}\\right) = \\frac{(\\partial Num / \\partial \\sigma^{(F)}_{c,i}) \\cdot Den - Num \\cdot (\\partial Den / \\partial \\sigma^{(F)}_{c,i})}{Den^2}\n$$\n由于 $Den$ 不依赖于 $\\sigma^{(F)}_{c,i}$ 并且 $\\partial Num / \\partial \\sigma^{(F)}_{c,i} = \\phi_i N_F$，这可以简化为：\n$$\nJ_i = \\frac{\\phi_i N_F}{Den}\n$$\n对于易裂变吸收截面（$i=G+1, \\dots, 2G$，对应于能量群 $g=i-G$）：\n$$\nJ_i = \\frac{\\partial BR}{\\partial \\sigma^{(Fi)}_{a,g}} = \\frac{-Num \\cdot (\\partial Den / \\partial \\sigma^{(Fi)}_{a,g})}{Den^2} = -\\frac{Num}{Den} \\frac{\\phi_g N_{Fi}}{Den} = -BR \\frac{\\phi_g N_{Fi}}{Den}\n$$\n梯度 $\\mathbf{J}$ 在平均值处计算，因此我们在表达式中使用 $BR_{\\mathrm{nom}}$ 和 $Den_{\\mathrm{nom}}$。\n\n协方差矩阵 $\\mathbf{C}$ 由标准差和相关矩阵构建，即 $\\mathbf{C} = \\mathbf{S} \\mathbf{R} \\mathbf{S}$。在这里，$\\mathbf{S}$ 是一个对角矩阵，其元素是与 $\\mathbf{s}$ 对应的截面标准差。相关矩阵 $\\mathbf{R}$ 以分块对角形式给出：\n$$\n\\mathbf{R} = \\begin{bmatrix} \\mathbf{R}_{cc}  \\mathbf{0} \\\\ \\mathbf{0}  \\mathbf{R}_{aa} \\end{bmatrix}\n$$\n其中 $\\mathbf{R}_{cc}$ 是可增殖俘获截面的相关矩阵，$\\mathbf{R}_{aa}$ 是易裂变吸收截面的相关矩阵。\n\n计算出 $\\mathbf{J}$ 和 $\\mathbf{C}$ 后，通过矩阵乘法找到线性化方差。线性化标准差为 $\\sigma_{\\mathrm{lin}}(BR) = \\sqrt{\\mathrm{Var}_{\\mathrm{lin}}(BR)}$。\n\n### 蒙特卡罗模拟\n\n蒙特卡罗方法提供了一种直接估计 $BR$ 分布及其矩的方法。步骤如下：\n1.  从多元正态分布 $\\mathcal{N}(\\boldsymbol{\\mu}_{\\mathbf{s}}, \\mathbf{C})$ 中为截面向量 $\\mathbf{s}$ 生成大量样本（$N_{samples} = 50000$）。为保证可复现性，使用固定的随机种子（$20231105$）。\n2.  对于每个抽样向量 $\\mathbf{s}^{(k)}$：\n    a. 将任何负的截面值截断为零。这强制执行了 $\\sigma \\ge 0$ 的物理约束。设截断后的向量为 $\\mathbf{s'}^{(k)}$。\n    b. 使用 $\\mathbf{s'}^{(k)}$ 计算分母 $Den^{(k)}$。如果 $Den^{(k)} \\le 0$，则该样本无效并被舍弃。这避免了除以零或负值，这些在物理上是不可能的，因为总吸收率不能为负。\n    c. 如果样本有效，计算分子 $Num^{(k)}$ 和相应的增殖比 $BR^{(k)} = Num^{(k)}/Den^{(k)}$。\n3.  根据所有有效 $BR$ 样本的集合，计算样本均值 $BR_{\\mathrm{MC}}$ 和样本标准差 $\\sigma_{\\mathrm{MC}}(BR)$（在计算方差时使用 $N_{valid}-1$ 作为分母）。\n\n### 比较指标\n\n最后，使用相对差异来比较两种方法的结果：\n-   平均值的相对差异：$\\Delta_{\\mathrm{mean}} = (BR_{\\mathrm{MC}} - BR_{\\mathrm{nom}}) / BR_{\\mathrm{nom}}$\n-   标准差的相对差异：$\\Delta_{\\mathrm{std}} = (\\sigma_{\\mathrm{MC}}(BR) - \\sigma_{\\mathrm{lin}}(BR)) / \\sigma_{\\mathrm{lin}}(BR)$\n\n对提供的三个测试用例中的每一个都执行这些计算。以下代码实现了这整个过程。",
            "answer": "[1.0858695652,0.0886503893,1.0862025178,0.0888251508,0.0003066224,0.0019713180,1.2187500000,0.0988640078,1.2198083818,0.0991807753,0.0008684158,0.0032043681,1.7222222222,0.4855909249,1.7699321557,0.5097475142,0.0276999252,0.0497470642]"
        }
    ]
}