{
    "hands_on_practices": [
        {
            "introduction": "预处理是加速迭代线性求解器收敛的关键技术，其核心思想是将原始线性系统变换为一个更容易求解的等价系统。本练习提供了一个具体、可动手计算的例子，您将通过分析一个简单的双区域扩散问题来实践这一概念。通过计算和比较应用雅可比（Jacobi）预处理器前后系统矩阵的特征值，您将亲眼见证预处理如何改善谱分布，为加速求解奠定基础。 ",
            "id": "4234539",
            "problem": "考虑一个稳态、单群中子扩散模型，该模型用于一个由两个均匀区域组成的一维平板，其两端均为反射边界。设左侧区域的厚度为 $h_1$，扩散系数为 $D_1$，宏观吸收截面为 $\\Sigma_{a,1}$；右侧区域的厚度为 $h_2$，扩散系数为 $D_2$，宏观吸收截面为 $\\Sigma_{a,2}$。该平板具有恒定的横截面积 $A_c$。使用有限体积格式和基于菲克定律的两点通量近似来计算界面流，两个控制体之间的界面传导系数 $G$ 由串联电阻推导出的调和平均值给出。具体来说，穿过界面的流近似为 $J \\approx -G\\left(\\phi_2 - \\phi_1\\right)$，其中\n$$\nG \\;=\\; \\frac{2\\,A_c}{\\frac{h_1}{D_1} + \\frac{h_2}{D_2}}\\,,\n$$\n并且由于反射边界的存在，没有边界泄漏项。作用于网格平均通量 $(\\phi_1,\\phi_2)$ 的最终得到的对称正定（SPD）$2\\times 2$ 离散算子 $\\mathbf{A}$ 的元素为\n$$\nA_{11} \\;=\\; \\Sigma_{a,1}\\,V_1 + G,\\quad A_{22} \\;=\\; \\Sigma_{a,2}\\,V_2 + G,\\quad A_{12} \\;=\\; A_{21} \\;=\\; -G,\n$$\n其中 $V_i = A_c\\,h_i$ 是控制体的体积。\n\n将块雅可比预条件子 $\\mathbf{M}$ 定义为 $\\mathbf{A}$ 的块对角部分，即 $\\mathbf{M} = \\operatorname{diag}(A_{11},A_{22})$。从单群中子扩散方程 $-\\nabla\\cdot\\left(D\\nabla\\phi\\right) + \\Sigma_a\\,\\phi = q$ 以及每个区域上的有限体积平衡方程出发，推导出预条件算子 $\\mathbf{M}^{-1}\\mathbf{A}$，并使用以下物理上一致的参数计算其特征值的精确形式：\n- $h_1 = 30\\,\\text{cm}$，$h_2 = 20\\,\\text{cm}$，\n- $A_c = 200\\,\\text{cm}^2$，\n- $D_1 = 1.2\\,\\text{cm}$，$D_2 = 0.8\\,\\text{cm}$，\n- $\\Sigma_{a,1} = 0.010\\,\\text{cm}^{-1}$，$\\Sigma_{a,2} = 0.015\\,\\text{cm}^{-1}$。\n\n在你的推导中，请从控制方程以及两点通量近似和界面传导系数的定义开始。然后，构造 $\\mathbf{A}$ 和 $\\mathbf{M}$，形成 $\\mathbf{M}^{-1}\\mathbf{A}$，并解析地计算其特征值。作为背景知识，请在你的解释中也求出未预处理算子 $\\mathbf{A}$ 的特征值，并定性讨论谱的聚集情况；但是，最终需要报告的答案仅为 $\\mathbf{M}^{-1}\\mathbf{A}$ 的特征值。无需四舍五入；请提供精确值。最终答案中不要包含单位。",
            "solution": "用户要求我解决一个问题，该问题涉及分析一个由单群中子扩散方程的有限体积离散化产生的预处理系统矩阵的特征值。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**第1步：提取已知条件**\n\n- **控制方程**：稳态、单群中子扩散方程 $-\\nabla\\cdot\\left(D\\nabla\\phi\\right) + \\Sigma_a\\,\\phi = q$。\n- **几何形状**：具有两个均匀区域的一维平板。\n- **边界**：两端均为反射边界。\n- **区域1参数**：厚度 $h_1 = 30\\,\\text{cm}$，扩散系数 $D_1 = 1.2\\,\\text{cm}$，宏观吸收截面 $\\Sigma_{a,1} = 0.010\\,\\text{cm}^{-1}$。\n- **区域2参数**：厚度 $h_2 = 20\\,\\text{cm}$，扩散系数 $D_2 = 0.8\\,\\text{cm}$，宏观吸收截面 $\\Sigma_{a,2} = 0.015\\,\\text{cm}^{-1}$。\n- **共用参数**：恒定横截面积 $A_c = 200\\,\\text{cm}^2$。\n- **离散化**：有限体积格式，具有与两个区域相对应的两个控制体。网格平均通量表示为 $(\\phi_1, \\phi_2)$。\n- **界面流**：穿过界面的流近似为 $J \\approx -G\\left(\\phi_2 - \\phi_1\\right)$，其中界面传导系数 $G$ 由调和平均值 $G = \\frac{2\\,A_c}{\\frac{h_1}{D_1} + \\frac{h_2}{D_2}}$ 给出。\n- **离散算子 $\\mathbf{A}$**：$2\\times 2$ 对称正定（SPD）矩阵的元素为：\n  - $A_{11} = \\Sigma_{a,1}\\,V_1 + G$\n  - $A_{22} = \\Sigma_{a,2}\\,V_2 + G$\n  - $A_{12} = A_{21} = -G$\n  - 控制体体积为 $V_i = A_c\\,h_i$。\n- **预条件子 $\\mathbf{M}$**：块雅可比预条件子定义为 $\\mathbf{A}$ 的块对角部分，对于这个 $2 \\times 2$ 系统，即 $\\mathbf{M} = \\operatorname{diag}(A_{11}, A_{22})$。\n- **任务**：推导出预条件算子 $\\mathbf{M}^{-1}\\mathbf{A}$，并使用所提供的参数计算其特征值的精确形式。作为背景知识，同时计算 $\\mathbf{A}$ 的特征值并讨论谱的聚集情况。\n\n**第2步：使用提取的已知条件进行验证**\n\n- **科学依据**：该问题在反应堆物理和数值线性代数领域有坚实的基础。单群扩散方程是标准模型。采用两点通量近似和界面属性调和平均的有限体积法是一种标准且稳健的离散化技术。雅可比预条件是求解线性系统的基本概念。\n- **适定性**：问题已完全指定。构造矩阵和求解特征值所需的所有参数、方程和定义均已提供。该结构确保了唯一的数学解。\n- **客观性**：问题以精确的技术语言陈述，没有主观或偏颇的元素。\n- **内部一致性与可行性**：量纲分析证实了公式的一致性。矩阵方程 $\\mathbf{A}\\boldsymbol{\\phi} = \\mathbf{q}$ 中的各项代表中子平衡（速率单位为中子数/秒）。通量 $\\phi$ 的单位是 中子数/(cm² s)。\n  - 平衡方程中的吸收项是 $\\Sigma_{a,i} V_i \\phi_i$，其单位为 (cm⁻¹) $\\times$ (cm³) $\\times$ (中子数/(cm² s)) = 中子数/s。\n  - 网格间的泄漏项是 $G \\phi_i$。传导系数 $G = \\frac{2\\,A_c}{h_1/D_1 + h_2/D_2}$ 的单位是 (cm²) / (cm/cm) = cm²。因此，$G \\phi_i$ 的单位是 (cm²) $\\times$ (中子数/(cm² s)) = 中子数/s。\n- 该公式在量纲上是一致的。提供的数值对于一个核系统是物理上合理的。该问题没有违反任何基本原则，并且没有说明中列出的使问题无效的缺陷。\n\n**第3步：结论与行动**\n\n问题有效。我现在开始求解。\n\n### 推导与求解\n\n问题要求求解雅可比预处理矩阵 $\\mathbf{M}^{-1}\\mathbf{A}$ 的特征值，该矩阵源自中子扩散方程的有限体积离散化。\n\n首先，我们将控制方程 $-\\nabla\\cdot\\left(D\\nabla\\phi\\right) + \\Sigma_a\\,\\phi = q$ 在每个控制体 $V_i$ 上积分。对泄漏项应用散度定理可得：\n$$\n-\\int_{\\partial V_i} (D\\nabla\\phi) \\cdot d\\mathbf{S} + \\int_{V_i} \\Sigma_a \\phi \\,dV = \\int_{V_i} q \\,dV\n$$\n第一项表示离开控制体的净中子流，第二项是控制体内的总吸收率。右侧是总源率。对于我们这个具有反射外边界（零净中子流）的双控制体平板系统，平衡方程为：\n\n对于控制体 $V_1$：\n$$\n-I_{1\\to\\text{右}} + \\Sigma_{a,1}\\phi_1 V_1 = q_1 V_1\n$$\n对于控制体 $V_2$：\n$$\n-I_{2\\to\\text{左}} + \\Sigma_{a,2}\\phi_2 V_2 = q_2 V_2\n$$\n其中 $I$ 表示总中子流（流密度在面积 $A_c$ 上的积分）。这些中子流的关系是 $I_{2\\to\\text{左}} = -I_{1\\to\\text{右}}$。我们定义从网格1到网格2的净中子流为 $J_{12} = I_{1\\to\\text{右}}$。问题给出的近似为 $J_{12} = -G(\\phi_2 - \\phi_1) = G(\\phi_1 - \\phi_2)$。将此代入平衡方程：\n\n对于 $V_1$：$G(\\phi_1 - \\phi_2) + \\Sigma_{a,1}V_1\\phi_1 = q_1 V_1 \\implies (\\Sigma_{a,1}V_1 + G)\\phi_1 - G\\phi_2 = q_1 V_1$\n对于 $V_2$：$-G(\\phi_1 - \\phi_2) + \\Sigma_{a,2}V_2\\phi_2 = q_2 V_2 \\implies -G\\phi_1 + (\\Sigma_{a,2}V_2 + G)\\phi_2 = q_2 V_2$\n\n这两个方程构成了线性系统 $\\mathbf{A}\\boldsymbol{\\phi} = \\mathbf{q}$，其中 $\\boldsymbol{\\phi} = \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix}^T$，矩阵 $\\mathbf{A}$ 由下式给出：\n$$\n\\mathbf{A} = \\begin{pmatrix} \\Sigma_{a,1}V_1 + G  -G \\\\ -G  \\Sigma_{a,2}V_2 + G \\end{pmatrix}\n$$\n这与问题陈述中提供的结构相符。\n\n接下来，我们计算 $\\mathbf{A}$ 的各分量的数值。\n控制体体积为：\n$V_1 = A_c h_1 = (200\\,\\text{cm}^2)(30\\,\\text{cm}) = 6000\\,\\text{cm}^3$\n$V_2 = A_c h_2 = (200\\,\\text{cm}^2)(20\\,\\text{cm}) = 4000\\,\\text{cm}^3$\n\n界面传导系数 $G$ 为：\n$$\nG = \\frac{2\\,A_c}{\\frac{h_1}{D_1} + \\frac{h_2}{D_2}} = \\frac{2(200)}{\\frac{30}{1.2} + \\frac{20}{0.8}} = \\frac{400}{25 + 25} = \\frac{400}{50} = 8\\,\\text{cm}^2\n$$\n\n现在我们求矩阵 $\\mathbf{A}$ 的元素：\n$A_{11} = \\Sigma_{a,1}V_1 + G = (0.010\\,\\text{cm}^{-1})(6000\\,\\text{cm}^3) + 8\\,\\text{cm}^2 = 60\\,\\text{cm}^2 + 8\\,\\text{cm}^2 = 68\\,\\text{cm}^2$\n$A_{22} = \\Sigma_{a,2}V_2 + G = (0.015\\,\\text{cm}^{-1})(4000\\,\\text{cm}^3) + 8\\,\\text{cm}^2 = 60\\,\\text{cm}^2 + 8\\,\\text{cm}^2 = 68\\,\\text{cm}^2$\n$A_{12} = A_{21} = -G = -8\\,\\text{cm}^2$\n\n所以，算子矩阵 $\\mathbf{A}$ 是：\n$$\n\\mathbf{A} = \\begin{pmatrix} 68  -8 \\\\ -8  68 \\end{pmatrix}\n$$\n\n作为背景，我们首先计算未预处理矩阵 $\\mathbf{A}$ 的特征值。特征方程为 $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$：\n$$\n\\det\\begin{pmatrix} 68 - \\lambda  -8 \\\\ -8  68 - \\lambda \\end{pmatrix} = (68 - \\lambda)^2 - (-8)^2 = 0\n$$\n$$\n(68 - \\lambda)^2 = 64 \\implies 68 - \\lambda = \\pm\\sqrt{64} = \\pm 8\n$$\n$$\n\\lambda = 68 \\mp 8\n$$\n$\\mathbf{A}$ 的特征值为 $\\lambda_1(\\mathbf{A}) = 60$ 和 $\\lambda_2(\\mathbf{A}) = 76$。$\\mathbf{A}$ 的谱为 $\\{60, 76\\}$。\n\n现在，我们构造雅可比预条件子 $\\mathbf{M}$，即 $\\mathbf{A}$ 的对角部分：\n$$\n\\mathbf{M} = \\operatorname{diag}(A_{11}, A_{22}) = \\begin{pmatrix} 68  0 \\\\ 0  68 \\end{pmatrix}\n$$\n其逆矩阵为：\n$$\n\\mathbf{M}^{-1} = \\begin{pmatrix} 1/68  0 \\\\ 0  1/68 \\end{pmatrix}\n$$\n预处理矩阵为 $\\mathbf{M}^{-1}\\mathbf{A}$：\n$$\n\\mathbf{M}^{-1}\\mathbf{A} = \\begin{pmatrix} 1/68  0 \\\\ 0  1/68 \\end{pmatrix} \\begin{pmatrix} 68  -8 \\\\ -8  68 \\end{pmatrix} = \\begin{pmatrix} \\frac{68}{68}  \\frac{-8}{68} \\\\ \\frac{-8}{68}  \\frac{68}{68} \\end{pmatrix} = \\begin{pmatrix} 1  -\\frac{2}{17} \\\\ -\\frac{2}{17}  1 \\end{pmatrix}\n$$\n最后，我们计算预处理矩阵 $\\mathbf{M}^{-1}\\mathbf{A}$ 的特征值。设这些特征值为 $\\mu$。特征方程为 $\\det(\\mathbf{M}^{-1}\\mathbf{A} - \\mu\\mathbf{I}) = 0$：\n$$\n\\det\\begin{pmatrix} 1 - \\mu  -2/17 \\\\ -2/17  1 - \\mu \\end{pmatrix} = (1 - \\mu)^2 - \\left(-\\frac{2}{17}\\right)^2 = 0\n$$\n$$\n(1 - \\mu)^2 = \\left(\\frac{2}{17}\\right)^2 \\implies 1 - \\mu = \\pm \\frac{2}{17}\n$$\n$$\n\\mu = 1 \\mp \\frac{2}{17}\n$$\n预处理矩阵 $\\mathbf{M}^{-1}\\mathbf{A}$ 的特征值为：\n$\\mu_1 = 1 - \\frac{2}{17} = \\frac{15}{17}$\n$\\mu_2 = 1 + \\frac{2}{17} = \\frac{19}{17}$\n\n定性地看，雅可比预处理使特征值紧密地聚集在 1 附近。$\\mathbf{A}$ 的原始谱为 $\\{60, 76\\}$，条件数 $\\kappa(\\mathbf{A}) = 76/60 = 19/15$。预处理后的谱为 $\\{15/17, 19/17\\}$，约等于 $\\{0.882, 1.118\\}$。预处理系统的条件数为 $\\kappa(\\mathbf{M}^{-1}\\mathbf{A}) = (19/17)/(15/17) = 19/15$。在这个特殊情况下，由于 $\\mathbf{A}$ 的对角元素相等（$A_{11}=A_{22}$），预条件子 $\\mathbf{M}$ 是单位矩阵的标量倍，即 $\\mathbf{M} = 68\\mathbf{I}$。因此，预处理矩阵 $\\mathbf{M}^{-1}\\mathbf{A}$ 只是 $\\mathbf{A}$ 的一个缩放版本，特征向量保持不变，而特征值被缩放了 $1/68$。这种缩放解释了为什么条件数没有改变。然而，预处理的目标——将特征值聚集在 1 附近以加速迭代求解器的收敛——已明确实现。",
            "answer": "$$\n\\boxed{\\frac{15}{17}, \\frac{19}{17}}\n$$"
        },
        {
            "introduction": "在上一练习的基础上，本实践旨在探索为何谱聚类对求解器性能至关重要。本练习将系统矩阵的条件数与共轭梯度（CG）方法的收敛速度直接联系起来，这在反应堆物理中尤其重要，因为材料属性的巨大差异（高对比度）是常见挑战。您将通过分析估算，量化一个简单的对角缩放预处理器如何显著减少求解具有挑战性的物理问题所需的迭代次数。 ",
            "id": "4234506",
            "problem": "在带有真空边界条件的单群中子扩散的一维板模型中，考虑一个由两种材料构成的分层介质：对于 $x \\in [0,1/2]$，扩散系数为 $D_{1}$；对于 $x \\in (1/2,1]$，扩散系数为 $D_{2}$。稳态扩散方程为 $- \\frac{d}{dx}\\!\\left(D(x)\\,\\frac{d\\phi}{dx}\\right) = q(x)$，且满足 $\\phi(0) = \\phi(1) = 0$，其中 $D(x)$ 如前述为分段常数，$q(x)$ 是一个有界源。使用包含 $N=128$ 个单元、单元宽度为 $h = 1/(N+1)$ 的均匀网格对区间 $[0,1]$ 进行离散化，并通过在单元交界面上对扩散系数进行调和平均的保守有限体积格式，构建对称正定线性系统 $A \\phi = b$。所得的刚度矩阵 $A$ 是一个对称三对角 M 矩阵，其元素由交界面传导系数 $D_{i+1/2}$ 构成，其中 $D_{i+1/2}$ 是相邻单元扩散系数的调和平均值。\n\n令 $M = \\operatorname{diag}(A)$ 表示对角（Jacobi）预处理器。利用有限体积离散化的基本原理、Rayleigh 商界以及均匀网格上离散 Dirichlet 拉普拉斯算子的谱性质，估计条件数 $\\kappa(A)$ 和 $\\kappa(M^{-1}A)$，估计结果可以与不依赖于扩散对比度 $D_{\\max}/D_{\\min}$ 的乘法常数相差一个因子，其中 $D_{\\min} = \\min\\{D_{1},D_{2}\\}$ 且 $D_{\\max} = \\max\\{D_{1},D_{2}\\}$。然后，使用共轭梯度（CG）法的标准能量范数收敛界，该界关联了迭代次数 $m$、条件数 $\\kappa$ 以及在 A-范数下期望的误差缩减因子 $\\varepsilon$，确定预测比率\n$$\nR \\;=\\; \\frac{m_{\\text{unpre}}}{m_{\\text{pre}}},\n$$\n其中 $m_{\\text{unpre}}$ 和 $m_{\\text{pre}}$ 分别是无预处理和带对角预处理时，将误差的 A-范数减小因子 $\\varepsilon = 10^{-8}$ 所需的 CG 迭代次数。取 $D_{1} = 1$ 和 $D_{2} = 100$。将你的最终答案表示为一个实数，并四舍五入到四位有效数字。",
            "solution": "我们首先回顾在一维均匀网格上对含变系数的二阶算子进行的有限体积离散化。令 $x_{i}$ 表示内部单元中心，$i=1,\\dots,N$，网格宽度为 $h = 1/(N+1)$。在交界面上采用调和平均的保守通量平衡法，得到一个对称三对角刚度矩阵 $A$，满足\n$$\nv^{\\top} A v \\;=\\; \\frac{1}{h^{2}} \\sum_{i=0}^{N} D_{i+1/2}\\,\\big(v_{i+1} - v_{i}\\big)^{2},\n$$\n对于任意向量 $v \\in \\mathbb{R}^{N}$，由于 Dirichlet 边界条件，约定 $v_{0}=v_{N+1}=0$，且其中 $D_{i+1/2}$ 是 $D$ 在相邻单元上的调和平均值。对于在 $[0,1/2]$ 上为 $D_1$、在 $(1/2,1]$ 上为 $D_2$ 的分层介质，交界面传导系数对所有 $i$ 满足 $D_{\\min} \\le D_{i+1/2} \\le D_{\\max}$，其中 $D_{\\min} = \\min\\{D_{1},D_{2}\\}$ 且 $D_{\\max} = \\max\\{D_{1},D_{2}\\}$。\n\n定义标准离散 Dirichlet 拉普拉斯算子模板矩阵 $T \\in \\mathbb{R}^{N \\times N}$ 为\n$$\nw^{\\top} \\left(\\frac{1}{h^{2}} T\\right) w \\;=\\; \\frac{1}{h^{2}} \\sum_{i=0}^{N} \\big(w_{i+1} - w_{i}\\big)^{2},\n$$\n因此 $(1/h^{2})T$ 的特征值为\n$$\n\\lambda_{k}\\!\\left(\\frac{1}{h^{2}} T\\right) \\;=\\; \\frac{4}{h^{2}} \\sin^{2}\\!\\left(\\frac{k\\pi}{2(N+1)}\\right), \\quad k=1,\\dots,N.\n$$\n于是\n$$\n\\lambda_{\\min}\\!\\left(\\frac{1}{h^{2}} T\\right) \\;=\\; \\frac{4}{h^{2}} \\sin^{2}\\!\\left(\\frac{\\pi}{2(N+1)}\\right), \n\\quad\n\\lambda_{\\max}\\!\\left(\\frac{1}{h^{2}} T\\right) \\;=\\; \\frac{4}{h^{2}} \\sin^{2}\\!\\left(\\frac{N\\pi}{2(N+1)}\\right).\n$$\n\n我们现在使用 Rayleigh 商比较来界定条件数 $\\kappa(A)$。对于任意 $v \\in \\mathbb{R}^{N}$，\n$$\n\\frac{D_{\\min}}{h^{2}} \\sum_{i=0}^{N} \\big(v_{i+1} - v_{i}\\big)^{2}\n\\;\\le\\;\nv^{\\top} A v\n\\;\\le\\;\n\\frac{D_{\\max}}{h^{2}} \\sum_{i=0}^{N} \\big(v_{i+1} - v_{i}\\big)^{2}.\n$$\n根据 Courant–Fischer 最小-最大特征值定理以及 $(1/h^{2})T$ 的特征对，可得\n$$\n\\lambda_{\\min}(A) \\;\\ge\\; D_{\\min} \\,\\lambda_{\\min}\\!\\left(\\frac{1}{h^{2}} T\\right),\n\\qquad\n\\lambda_{\\max}(A) \\;\\le\\; D_{\\max} \\,\\lambda_{\\max}\\!\\left(\\frac{1}{h^{2}} T\\right),\n$$\n因此\n$$\n\\kappa(A) \\;=\\; \\frac{\\lambda_{\\max}(A)}{\\lambda_{\\min}(A)}\n\\;\\le\\;\n\\frac{D_{\\max}}{D_{\\min}} \\cdot \n\\frac{\\lambda_{\\max}\\!\\left(\\frac{1}{h^{2}} T\\right)}{\\lambda_{\\min}\\!\\left(\\frac{1}{h^{2}} T\\right)}\n\\;=\\;\n\\frac{D_{\\max}}{D_{\\min}} \\cdot\n\\frac{\\sin^{2}\\!\\left(\\frac{N\\pi}{2(N+1)}\\right)}{\\sin^{2}\\!\\left(\\frac{\\pi}{2(N+1)}\\right)}.\n$$\n对于 $N=128$，其渐进行为如同\n$$\n\\kappa(A) \\;\\approx\\; \\frac{D_{\\max}}{D_{\\min}} \\cdot \\frac{4}{4\\sin^{2}\\!\\left(\\frac{\\pi}{2(N+1)}\\right)} \n\\;\\sim\\; \\frac{D_{\\max}}{D_{\\min}} \\cdot \\frac{1}{\\sin^{2}\\!\\left(\\frac{\\pi}{2\\cdot 129}\\right)},\n$$\n其尺度行为如 $\\mathcal{O}\\!\\left(\\frac{D_{\\max}}{D_{\\min}} N^{2}\\right)$。\n\n接下来，考虑对角（Jacobi）预处理 $M = \\operatorname{diag}(A)$ 以及对称预处理矩阵 $H = M^{-1/2} A M^{-1/2}$。其极端特征值允许以下 Rayleigh 商表示\n$$\n\\lambda(H) \\;=\\; \n\\frac{y^{\\top} A y}{y^{\\top} M y}\n\\;=\\;\n\\frac{\\frac{1}{h^{2}} \\sum_{i=0}^{N} D_{i+1/2}\\,(y_{i+1}-y_{i})^{2}}{\\frac{1}{h^{2}} \\sum_{i=1}^{N} (D_{i-1/2}+D_{i+1/2}) \\, y_{i}^{2}}.\n$$\n在每个 $D_{i+1/2}$ 为常数的均匀子区域上，分子和分母以相同的扩散因子进行缩放，因此 $H$ 的局部符号与归一化一维拉普拉斯算子的符号相同，且与 $D_1$ 和 $D_2$ 无关。唯一偏离常系数的情况发生在单一的材料交界面处，它以一种低阶效应扰动谱，对于固定的 $N$，这种效应不会引入对扩散对比度 $D_{\\max}/D_{\\min}$ 的依赖性。因此，$H$ 与同一网格上的归一化 Dirichlet 拉普拉斯算子谱等价，且\n$$\n\\kappa\\!\\big(M^{-1} A\\big) \\;\\approx\\; \n\\frac{\\sin^{2}\\!\\left(\\frac{N\\pi}{2(N+1)}\\right)}{\\sin^{2}\\!\\left(\\frac{\\pi}{2(N+1)}\\right)}\n\\;\\sim\\; \\kappa\\!\\left(\\frac{1}{h^{2}} T\\right),\n$$\n结果与依赖于 $N$ 和网格正则性但不依赖于对比度 $D_{\\max}/D_{\\min}$ 的乘法常数相差一个因子。特别地，对于当前的均匀网格和单个交界面，对角缩放消除了对 $D_{\\max}/D_{\\min}$ 的主阶依赖性。\n\n我们现在将共轭梯度（CG）迭代次数与条件数联系起来。一个标准的、经过充分检验的关于 CG 在 A-范数下的收敛界表明，经过 $m$ 次迭代后的误差满足\n$$\n\\frac{\\|e_{m}\\|_{A}}{\\|e_{0}\\|_{A}} \n\\;\\le\\;\n2 \\left(\\frac{\\sqrt{\\kappa} - 1}{\\sqrt{\\kappa} + 1}\\right)^{m},\n$$\n其中 $\\kappa$ 是（预处理后）系数矩阵在相关内积下的条件数。为了达到目标缩减因子 $\\varepsilon$ 而求解 $m$，可得到估计式\n$$\nm \\;\\ge\\; \\frac{1}{2} \\sqrt{\\kappa} \\,\\ln\\!\\left(\\frac{2}{\\varepsilon}\\right)\n\\quad \\text{for large } \\kappa,\n$$\n该式捕捉了 CG 对 $\\sqrt{\\kappa}$ 的主要依赖关系。因此，对于使用相同网格和容差的无预处理系统和对角预处理系统，其迭代次数的比率可由下式预测\n$$\nR \\;=\\; \\frac{m_{\\text{unpre}}}{m_{\\text{pre}}}\n\\;\\approx\\;\n\\frac{\\sqrt{\\kappa(A)}}{\\sqrt{\\kappa\\!\\big(M^{-1}A\\big)}}.\n$$\n\n根据上面推导的条件数估计，\n$$\n\\sqrt{\\kappa(A)} \\;\\approx\\; \\sqrt{\\frac{D_{\\max}}{D_{\\min}}}\\,\\sqrt{\\kappa\\!\\left(\\frac{1}{h^{2}} T\\right)},\n\\qquad\n\\sqrt{\\kappa\\!\\big(M^{-1}A\\big)} \\;\\approx\\; \\sqrt{\\kappa\\!\\left(\\frac{1}{h^{2}} T\\right)}.\n$$\n因此，对于 $D_{1}=1$ 和 $D_{2}=100$，\n$$\nR \\;\\approx\\; \\sqrt{\\frac{D_{\\max}}{D_{\\min}}} \\;=\\; \\sqrt{100} \\;=\\; 10.\n$$\n\n由于对数因子 $\\ln\\!\\left(2/\\varepsilon\\right)$ 对两次运行是相同的，在比率中被消去，并且由于离散拉普拉斯算子引起的主要的 N-依赖性在对角缩放后也被消去，因此预测的比率由扩散对比度的平方根决定。因此，四舍五入到四位有效数字，所求比率为 $10.00$。",
            "answer": "$$\\boxed{10.00}$$"
        },
        {
            "introduction": "除了简单的对角缩放，还存在更强大的预处理技术，它们能更有效地加速复杂问题的求解。本练习将引导您探索一种更高级的预处理器——不完全LU（ILU）分解。您将深入分析ILU(0)分解在二维问题离散化后产生的稀疏结构，并理解其为何能构成多重网格方法中一种高效的光滑子（smoother），从而近似原矩阵的逆并显著改善收敛性。 ",
            "id": "4234460",
            "problem": "考虑一个均匀矩形反应堆堆芯中的稳态单群中子扩散方程，该方程忽略了各向同性散射，并采用均匀狄利克雷边界条件，其形式为 $-\\nabla \\cdot (D \\nabla \\phi) + \\Sigma_{a} \\phi = q$，其中 $D  0$ 是扩散系数，$\\Sigma_{a} \\ge 0$ 是宏观吸收截面，$\\phi$ 是中子通量，$q$ 是源项。使用单元中心有限体积法，在一个具有网格间距 $h$ 的均匀 $n \\times n$ 内部单元网格上离散化该方程，并对未知量采用自然字典序（行主序）排序。得到的线性系统 $A \\phi = b$ 具有一个对称正定的五点格式，其对角元为 $a_{pp} = \\Sigma_{a} + \\frac{4D}{h^{2}}$，对于任意内部点 $p$ 的四个最近邻点 $q$，其非对角元为 $a_{pq} = -\\frac{D}{h^{2}}$。\n\n为该矩阵 $A$ 在给定排序下定义零填充不完全下上三角分解，记为不完全下上三角分解(ILU(0))，并约定不完全下三角因子 $L$ 是单位下三角矩阵且其单位对角线不被存储，而不完全上三角因子 $U$ 包含对角线。假设通常的限制，即 ILU(0) 只允许在 $A$ 的非零位置出现非零元。\n\n基于这些基础：\n1) 确定在该给定排序下，由此五点格式的 ILU(0) 分解所产生的不完全下三角因子 $L$ 和不完全上三角因子 $U$ 的稀疏（填充）模式。\n2) 计算 $L$ 和 $U$ 中存储的非零元的总数，其中 $U$ 的对角线计算一次，$L$ 的单位对角线不存储。将您的答案表示为关于 $n$ 的闭式解析表达式。\n3) 对同一五点算子的无限周期网格代理使用局部傅里叶分析 (LFA)，描述由标准分裂 $A = L_{A} + D_{A} + U_{A}$ 构成的正向高斯-赛德尔迭代矩阵的特性，其中 $L_{A}$ 和 $U_{A}$ 分别是 $A$ 在相同排序下的严格下三角和严格上三角部分，$D_{A}$ 是 $A$ 的对角部分。推导其误差传播算子的傅里叶符号，并评估当 $\\Sigma_{a} = 0$ 时，在模式 $(\\theta_{x}, \\theta_{y}) = (\\pi, \\pi)$ 处的高频放大因子。在多重网格循环的背景下，简要比较此作用与作为稳态理查森迭代中左预条件子的 ILU(0) 的作用。\n\n您最终记录的答案必须是第 (2) 部分中关于存储非零元总数作为 $n$ 的函数的表达式。最终表达式无需四舍五入，也不应使用单位。",
            "solution": "该问题已被验证，并被确定为反应堆物理数值方法领域中一个适定且有科学依据的问题。问题要求对一个源自 $n \\times n$ 网格上中子扩散方程离散化的五点格式矩阵进行三部分分析。未知数的总数为 $N=n^2$。\n\n### 第 1 部分：ILU(0) 因子的稀疏模式\n\n零填充不完全LU分解（ILU(0)）生成的因子 $\\tilde{L}$ 和 $\\tilde{U}$ 满足 $A \\approx \\tilde{L}\\tilde{U}$，其约束条件是 $\\tilde{L}$ 和 $\\tilde{U}$ 的非零结构必须是原始矩阵 $A$ 非零结构的子集。\n\n对于一个采用自然字典序（行主序）的网格点 $p=(i-1)n+j$（其中 $i,j \\in \\{1,\\dots,n\\}$ 为行和列索引），矩阵 $A$ 的非零项连接到其自身以及其东、西、南、北四个邻居。\n-   西邻居的索引为 $p-1$。\n-   南邻居的索引为 $p-n$。\n-   东邻居的索引为 $p+1$。\n-   北邻居的索引为 $p+n$。\n\n根据LU分解的算法，$\\tilde{L}$ 的非零项对应于 $A$ 中连接到索引更小的节点的那些非零项。因此，$\\tilde{L}$ 的稀疏模式将包含主对角线（单位对角线，不存储）以及连接到西邻居（索引 $p-1$）和南邻居（索引 $p-n$）的下对角线条带。\n类似地，$\\tilde{U}$ 的非零项对应于 $A$ 中连接到索引更大或相等的节点的那些非零项。因此，$\\tilde{U}$ 的稀疏模式将包含主对角线以及连接到东邻居（索引 $p+1$）和北邻居（索引 $p+n$）的上对角线条带。\n\n总结来说，ILU(0)因子的非零模式与 $A$ 的下三角和上三角部分的非零模式完全相同。\n\n### 第 2 部分：非零元的总数\n\n我们计算存储在 $\\tilde{L}$（不含单位对角线）和 $\\tilde{U}$（含对角线）中的非零元总数。\n总未知数 $N=n^2$。\n\n**$\\tilde{L}$ 中的非零元（严格下三角部分）：**\n-   连接西邻居的非零元（主次对角线）：$n^2$ 个节点中，第一列的 $n$ 个节点没有西邻居。因此有 $n^2 - n$ 个这样的连接。\n-   连接南邻居的非零元（第 $n$ 次对角线）：$n^2$ 个节点中，第一行的 $n$ 个节点没有南邻居。因此有 $n^2 - n$ 个这样的连接。\n-   $\\tilde{L}$ 中存储的非零元总数 = $(n^2 - n) + (n^2 - n) = 2n^2 - 2n$。\n\n**$\\tilde{U}$ 中的非零元（上三角及对角线部分）：**\n-   主对角线：每个节点都有一个对角元，共 $n^2$ 个。\n-   连接东邻居的非零元（主超对角线）：$n^2$ 个节点中，最后一列的 $n$ 个节点没有东邻居。因此有 $n^2 - n$ 个这样的连接。\n-   连接北邻居的非零元（第 $n$ 超对角线）：$n^2$ 个节点中，最后一行的 $n$ 个节点没有北邻居。因此有 $n^2 - n$ 个这样的连接。\n-   $\\tilde{U}$ 中存储的非零元总数 = $n^2 + (n^2 - n) + (n^2 - n) = 3n^2 - 2n$。\n\n**存储非零元的总数：**\n总数 = ($\\tilde{L}$中的非零元) + ($\\tilde{U}$中的非零元) = $(2n^2 - 2n) + (3n^2 - 2n) = 5n^2 - 4n$。\n这与原始矩阵 $A$ 的非零元总数相同，符合ILU(0)的定义。\n\n### 第 3 部分：高斯-赛德尔平滑因子的局部傅里叶分析\n\n正向高斯-赛德尔（GS）迭代的误差传播算子是 $E_{GS} = -(L_A+D_A)^{-1}U_A$。我们使用局部傅里叶分析来找到其符号。\n离散算子 $A$ 在傅里叶空间中的符号为：\n$\\hat{A}(\\theta_x, \\theta_y) = \\Sigma_a + \\frac{D}{h^2}(4 - e^{-i\\theta_x} - e^{i\\theta_x} - e^{-i\\theta_y} - e^{i\\theta_y}) = \\Sigma_a + \\frac{2D}{h^2}(2 - \\cos\\theta_x - \\cos\\theta_y)$。\n其各部分的符号为：\n$\\hat{D}_A = \\Sigma_a + \\frac{4D}{h^2}$\n$\\hat{L}_A = -\\frac{D}{h^2}(e^{-i\\theta_x} + e^{-i\\theta_y})$\n$\\hat{U}_A = -\\frac{D}{h^2}(e^{i\\theta_x} + e^{i\\theta_y})$\n\nGS误差传播算子的符号为 $\\hat{E}_{GS}(\\theta) = -\\frac{\\hat{U}_A(\\theta)}{\\hat{L}_A(\\theta) + \\hat{D}_A}$。\n$$\n\\hat{E}_{GS}(\\theta) = - \\frac{-\\frac{D}{h^2}(e^{i\\theta_x} + e^{i\\theta_y})}{\\Sigma_a + \\frac{4D}{h^2} - \\frac{D}{h^2}(e^{-i\\theta_x} + e^{-i\\theta_y})} = \\frac{e^{i\\theta_x} + e^{i\\theta_y}}{(\\Sigma_a h^2/D) + 4 - e^{-i\\theta_x} - e^{-i\\theta_y}}\n$$\n当 $\\Sigma_a=0$ 时，在最高频模式 $(\\theta_x, \\theta_y) = (\\pi, \\pi)$ 处，我们有 $e^{i\\pi}=-1$ 和 $e^{-i\\pi}=-1$。\n$$\n\\hat{E}_{GS}(\\pi, \\pi) = \\frac{-1 + (-1)}{4 - (-1) - (-1)} = \\frac{-2}{6} = -\\frac{1}{3}\n$$\n高频放大因子是其绝对值，即 $|\\hat{E}_{GS}(\\pi, \\pi)| = 1/3$。\n\n**比较：**\n这个 $1/3$ 的放大因子表明，对于自然排序，GS迭代能有效衰减（平滑）最高频的误差分量，这是一个好的平滑器的标志。然而，对于其他高频模式（例如，一个方向高频，另一个方向低频），GS的平滑效果可能不佳。\n作为理查森迭代 $x_{k+1}=x_k+\\omega M^{-1}(b-Ax_k)$ 的左预条件子，ILU(0) ($M=\\tilde{L}\\tilde{U}$) 的作用是使预处理后的矩阵 $M^{-1}A$ 的谱更接近单位矩阵，从而加速收敛。在多重网格中，ILU(0)被用作平滑器，其误差传播算子为 $I-\\omega M^{-1}A$。它的平滑效果通常比GS更鲁棒，因为它能更均匀地衰减所有高频误差模式，这是因为 $\\tilde{L}\\tilde{U}$ 通常是比 $L_A+D_A$ 更好的 $A$ 的近似。因此，ILU(0)平滑器在处理各向异性等难题时表现更佳。",
            "answer": "$$\\boxed{5n^{2} - 4n}$$"
        }
    ]
}