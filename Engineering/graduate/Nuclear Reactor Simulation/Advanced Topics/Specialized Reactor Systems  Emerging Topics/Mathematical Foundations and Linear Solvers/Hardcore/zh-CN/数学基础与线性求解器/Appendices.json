{
    "hands_on_practices": [
        {
            "introduction": "本实践探讨了强制性（coercivity）这一基础数学性质，它对中子扩散模型的稳定性及高效求解器的适用性至关重要。通过构建一个反例，你将研究当该性质被破坏时（例如，在有净中子产生的区域）会发生什么。这项练习强调了确保问题定解形式能够导出对称正定（SPD）系统的关键性，这是使用共轭梯度法等强大方法的前提。",
            "id": "4234489",
            "problem": "考虑在有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^d$ 上带有齐次 Dirichlet 边界条件的稳态中子扩散方程，其强形式写作 $-\\nabla \\cdot (D(x) \\nabla \\phi(x)) + \\Sigma_a(x)\\,\\phi(x) = q(x)$。其在 Sobolev 空间 $H^1_0(\\Omega)$ 上的标准弱形式使用双线性形式 $a(u,v) = \\int_{\\Omega} D(x)\\,\\nabla u(x) \\cdot \\nabla v(x)\\,dx + \\int_{\\Omega} \\Sigma_a(x)\\,u(x)\\,v(x)\\,dx$ 和线性泛函 $l(v) = \\int_{\\Omega} q(x)\\,v(x)\\,dx$。Lax–Milgram 定理保证了弱解的存在性和唯一性，前提是 $a(\\cdot,\\cdot)$ 是有界的和矫顽的，即存在 $\\alpha  0$ 使得对于所有 $u \\in H^1_0(\\Omega)$ 都有 $a(u,u) \\ge \\alpha \\|u\\|_{H^1_0(\\Omega)}^2$。\n\n假设 $D(x) \\equiv D_0$ 是一个正常数，满足 $D_0  0$。令 $\\omega \\subset \\Omega$ 是一个具有 Lipschitz 边界和正常数测度的非平凡开子域。假设宏观吸收截面在 $\\omega$ 上可以为负，具体地，对于 $x \\in \\omega$，$\\Sigma_a(x) = -\\kappa$（其中 $\\kappa  0$），而对于 $x \\in \\Omega \\setminus \\omega$，$\\Sigma_a(x) \\ge 0$。\n\n哪个选项正确地构造了一个反例，证明在上述假设下 $a(\\cdot,\\cdot)$ 在 $H^1_0(\\Omega)$ 上不满足矫顽性，并为核反应堆模拟和线性求解器给出了一个物理上和计算上都合理的推论？\n\nA. 选择支集在 $\\omega$ 内的函数 $u \\in H^1_0(\\Omega)$，使其为拉普拉斯算子在 $\\omega$ 上的第一 Dirichlet 特征函数，即在 $\\omega$ 中 $-\\Delta u = \\lambda_1(\\omega)\\,u$ 且在 $\\partial \\omega$ 上 $u=0$，并通过零延拓到 $\\Omega \\setminus \\omega$。那么 $a(u,u) = D_0 \\int_{\\omega} |\\nabla u|^2\\,dx - \\kappa \\int_{\\omega} u^2\\,dx = (D_0 \\lambda_1(\\omega) - \\kappa)\\int_{\\omega} u^2\\,dx$，当 $\\kappa  D_0 \\lambda_1(\\omega)$ 时，该值为负，与矫顽性矛盾。在物理上，$\\Sigma_a  0$ 代表局部净中子产生，它被不恰当地建模为“负吸收”，这破坏了扩散算子的对称正定（SPD）特性。因此，共轭梯度法（CG）无法应用；必须使用适用于不定系统的方法，例如带有适当预处理的广义最小残差法（GMRES）。并且在建模时，必须将裂变作为一个独立的源项处理，而不是作为负吸收。\n\nB. 取 $u$ 为在 $\\omega$ 上的常数函数，并在其他地方为零。由于在 $\\omega$ 上 $\\nabla u = 0$，对于任何 $\\kappa  0$，都有 $a(u,u) = -\\kappa \\int_{\\omega} u^2\\,dx  0$，因此无论 $D_0$ 如何，矫顽性总是不成立。然而，在物理上，这对求解器没有影响，因为刚度矩阵保持对称正定；CG 仍然能正常收敛。\n\nC. 对于任意 $u \\in H^1_0(\\Omega)$，应用 $\\Omega$ 上的 Poincaré 不等式可得 $a(u,u) \\ge D_0 \\int_{\\Omega} |\\nabla u|^2\\,dx - \\kappa \\int_{\\omega} u^2\\,dx \\ge (D_0 - \\kappa C_P) \\int_{\\Omega} |\\nabla u|^2\\,dx$，其中 $C_P$ 是 Poincaré 常数，它总是足够小以保持 $D_0 - \\kappa C_P  0$。因此，即使对于大的 $\\kappa$，矫顽性也得以保持。在物理上，$\\Sigma_a  0$ 仅仅轻微改变特征值，对稳定性或求解器的选择没有定性影响。\n\nD. 在 $\\partial \\Omega$ 上施加齐次 Neumann 边界条件，并选择 $u$ 为 $\\Omega$ 上的一个非零空间常数。那么 $a(u,u) = \\int_{\\Omega} \\Sigma_a\\,u^2\\,dx  0$ 因为 $\\Sigma_a$ 在 $\\omega$ 上为负，所以矫顽性无条件地不成立。在物理上，这意味着反应堆是超临界的（有效增殖因子大于1），并且没有线性求解器可以处理由此产生的系统；必须完全放弃线性代数方法。",
            "solution": "### 解题思路\n\n任务是构建一个反例来证明双线性形式 $a(\\cdot, \\cdot)$ 在给定条件下不满足矫顽性。矫顽性要求存在一个常数 $\\alpha > 0$，使得对于所有非零函数 $u \\in H^1_0(\\Omega)$，都有 $a(u,u) \\ge \\alpha \\|u\\|_{H^1_0(\\Omega)}^2$。要证明此性质不成立，最直接的方法是找到一个特定的非零函数 $u_0 \\in H^1_0(\\Omega)$，使得 $a(u_0, u_0) \\le 0$。如果能找到一个使 $a(u_0, u_0)$ 为负的函数，那么它显然不可能大于或等于一个必须为正的数 $\\alpha \\|u_0\\|_{H^1_0(\\Omega)}^2$，从而直接推翻矫顽性。\n\n### 详细推导\n\n1.  **写出二次型 $a(u,u)$**\n    根据双线性形式的定义和给定的参数，我们有：\n    $$a(u,u) = \\int_{\\Omega} D(x)|\\nabla u|^2\\,dx + \\int_{\\Omega} \\Sigma_a(x) u^2\\,dx$$\n    $$a(u,u) = D_0 \\int_{\\Omega} |\\nabla u|^2\\,dx + \\int_{\\Omega \\setminus \\omega} \\Sigma_a(x) u^2\\,dx - \\kappa \\int_{\\omega} u^2\\,dx$$\n    由于在 $\\Omega \\setminus \\omega$ 上 $\\Sigma_a(x) \\ge 0$，第二项是非负的。因此，我们得到以下不等式：\n    $$a(u,u) \\ge D_0 \\int_{\\Omega} |\\nabla u|^2\\,dx - \\kappa \\int_{\\omega} u^2\\,dx$$\n\n2.  **构造反例函数**\n    为了使 $a(u,u)$ 的值尽可能小（甚至为负），我们应该选择一个主要集中在区域 $\\omega$ 内的检验函数 $u$。这样可以最大化负项的贡献。一个理想的选择是：选择一个函数 $u$，其支集（support）完全包含在 $\\omega$ 内，并且在 $\\omega$ 的边界上为零。这样的函数可以通过零延拓自然地成为 $H^1_0(\\Omega)$ 空间的一员。\n    对于这样的函数 $u$（即在 $\\Omega \\setminus \\omega$ 上 $u \\equiv 0$），$a(u,u)$ 的表达式简化为：\n    $$a(u,u) = D_0 \\int_{\\omega} |\\nabla u|^2\\,dx - \\kappa \\int_{\\omega} u^2\\,dx$$\n    我们希望找到一个函数 $u$ 使上式为负，即：\n    $$D_0 \\int_{\\omega} |\\nabla u|^2\\,dx  \\kappa \\int_{\\omega} u^2\\,dx \\quad \\iff \\quad \\frac{\\int_{\\omega} |\\nabla u|^2\\,dx}{\\int_{\\omega} u^2\\,dx}  \\frac{\\kappa}{D_0}$$\n\n3.  **利用瑞利商**\n    左侧的表达式是负拉普拉斯算子 $(-\\Delta)$ 在域 $\\omega$ 上（带有齐次狄利克雷边界条件）的瑞利商。根据变分原理，该瑞利商的最小值是该算子的第一（最小）特征值，记为 $\\lambda_1(\\omega)$。这个最小值由对应的第一特征函数 $u_1$ 达到。\n    因此，如果我们选择 $u$ 为拉普拉斯算子在 $\\omega$ 上的第一狄利克雷特征函数（即在 $\\omega$ 中 $-\\Delta u_1 = \\lambda_1(\\omega) u_1$，在 $\\partial\\omega$ 上 $u_1=0$），我们有：\n    $$a(u_1, u_1) = D_0 \\left( \\lambda_1(\\omega) \\int_{\\omega} u_1^2\\,dx \\right) - \\kappa \\int_{\\omega} u_1^2\\,dx = \\left(D_0 \\lambda_1(\\omega) - \\kappa\\right) \\int_{\\omega} u_1^2\\,dx$$\n    由于 $u_1$ 是非零函数，$\\int_{\\omega} u_1^2\\,dx > 0$。因此，只要我们选择的参数 $\\kappa$ 足够大，满足 $\\kappa > D_0 \\lambda_1(\\omega)$，那么 $a(u_1, u_1)$ 的值就会是负数。\n    一个非零函数 $u_1$ 使得 $a(u_1, u_1)  0$ 的存在，直接证明了双线性形式 $a(\\cdot, \\cdot)$ 不是矫顽的。\n\n### 选项分析\n\n-   **A. ** 此选项精确地执行了上述推导过程。它正确地选择了第一特征函数作为反例，得出了正确的非矫顽性条件 $\\kappa > D_0 \\lambda_1(\\omega)$。其物理和计算推论也是完全正确的：负吸收模拟了净中子产生，破坏了系统的对称正定（SPD）性，导致共轭梯度（CG）法失效，必须采用如 GMRES 等为不定系统设计的求解器。建模上的建议也十分中肯。**此选项正确。**\n\n-   **B. ** 此选项提议的检验函数是一个在 $\\omega$ 上为常数、在别处为零的函数。这样的函数在边界 $\\partial\\omega$ 上是不连续的，因此它不属于索博列夫空间 $H^1(\\Omega)$（其弱导数不是平方可积函数），更不属于 $H^1_0(\\Omega)$。因此，这是一个无效的检验函数。后续的结论也是错误的。\n\n-   **C. ** 此选项错误地应用了庞加莱不等式。它声称 Poincaré 常数 $C_P$ “总是足够小”以维持矫顽性，这是一个毫无根据的断言。对于任何给定的域和扩散系数，$C_P$ 是一个定值，但参数 $\\kappa$ 可以任意大，足以使得 $(D_0 - \\kappa C_P)$ 为负。因此，其论证是错误的。\n\n-   **D. ** 此选项从根本上改变了问题设定，将边界条件从齐次狄利克雷条件改为了齐次诺伊曼条件。问题明确要求在 $H^1_0(\\Omega)$ 空间（对应狄利克雷条件）中讨论。其选择的检验函数（非零常数）不属于 $H^1_0(\\Omega)$。因此，这个回答没有解决原问题。\n\n**最终结论：** 选项A提供了正确的数学构造和物理/计算推论。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "当我们获得一个适定的对称正定（SPD）系统后，下一个挑战便是如何高效地求解它。本实践通过一个简化的双区域扩散问题，为预处理技术提供了一个具体的入门。通过亲手计算应用雅可比（Jacobi）预条件子前后系统矩阵的特征值，你将直观地理解预处理是如何改善系统条件、从而加速求解器收敛的。",
            "id": "4234539",
            "problem": "考虑一个一维板层的稳态单群中子扩散模型，该板层由两个均匀区域组成，两端均为反射边界。设左侧区域的厚度为 $h_1$，扩散系数为 $D_1$，宏观吸收截面为 $\\Sigma_{a,1}$；右侧区域的厚度为 $h_2$，扩散系数为 $D_2$，宏观吸收截面为 $\\Sigma_{a,2}$。该板层具有恒定的横截面积 $A_c$。使用有限体积法和基于菲克定律的两点通量近似来处理界面流，两个控制体之间的界面传导系数 $G$ 由串联电阻推导出的调和平均值给出。具体而言，穿过界面的流近似为 $J \\approx -G\\left(\\phi_2 - \\phi_1\\right)$，其中\n$$\nG \\;=\\; \\frac{2\\,A_c}{\\frac{h_1}{D_1} + \\frac{h_2}{D_2}}\\,,\n$$\n并且由于是反射边界，没有边界泄漏项。由此产生的、作用于网格平均通量 $(\\phi_1,\\phi_2)$ 的对称正定 (SPD) $2\\times 2$ 离散算子 $\\mathbf{A}$ 的矩阵元为\n$$\nA_{11} \\;=\\; \\Sigma_{a,1}\\,V_1 + G,\\quad A_{22} \\;=\\; \\Sigma_{a,2}\\,V_2 + G,\\quad A_{12} \\;=\\; A_{21} \\;=\\; -G,\n$$\n其中 $V_i = A_c\\,h_i$ 是控制体的体积。\n\n定义块雅可比预条件子 $\\mathbf{M}$ 为 $\\mathbf{A}$ 的块对角部分，即 $\\mathbf{M} = \\operatorname{diag}(A_{11},A_{22})$。从单群中子扩散方程 $-\\nabla\\cdot\\left(D\\nabla\\phi\\right) + \\Sigma_a\\,\\phi = q$ 和每个区域上的有限体积平衡方程出发，推导预处理算子 $\\mathbf{M}^{-1}\\mathbf{A}$，并使用以下物理上一致的参数计算其特征值的精确形式：\n- $h_1 = 30\\,\\text{cm}$，$h_2 = 20\\,\\text{cm}$，\n- $A_c = 200\\,\\text{cm}^2$，\n- $D_1 = 1.2\\,\\text{cm}$，$D_2 = 0.8\\,\\text{cm}$，\n- $\\Sigma_{a,1} = 0.010\\,\\text{cm}^{-1}$，$\\Sigma_{a,2} = 0.015\\,\\text{cm}^{-1}$。\n\n在您的推导中，从控制方程以及两点通量近似和界面传导系数的定义开始。然后，构建 $\\mathbf{A}$ 和 $\\mathbf{M}$，形成 $\\mathbf{M}^{-1}\\mathbf{A}$，并解析地计算其特征值。为了提供背景信息，在您的解释中，也需要求出未经预处理的算子 $\\mathbf{A}$ 的特征值，并定性地讨论谱的聚集性；但是，最终需要报告的答案仅为 $\\mathbf{M}^{-1}\\mathbf{A}$ 的特征值。无需四舍五入；请提供精确值。最终答案中不要包含单位。",
            "solution": "### 解题思路\n\n本题要求推导一个双区域中子扩散问题的有限体积离散矩阵，并计算雅可比预处理前后系统矩阵的特征值。\n\n### 详细推导\n\n1.  **推导离散方程**\n    我们对控制方程 $-\\nabla\\cdot\\left(D\\nabla\\phi\\right) + \\Sigma_a\\,\\phi = q$ 在每个控制体 $V_i$ 上积分。应用散度定理，可得：\n    $$\n    -\\int_{\\partial V_i} (D\\nabla\\phi) \\cdot d\\mathbf{S} + \\int_{V_i} \\Sigma_a \\phi \\,dV = \\int_{V_i} q \\,dV\n    $$\n    对于由两个控制体 $V_1$ 和 $V_2$ 组成的系统，两端为反射边界（即外部边界上的中子流为零），平衡方程为：\n    -   **控制体 $V_1$**: 净流出 + 吸收 = 源\n        $$J_{1\\to 2} + \\Sigma_{a,1}\\phi_1 V_1 = q_1 V_1$$\n    -   **控制体 $V_2$**: 净流出 + 吸收 = 源\n        $$J_{2\\to 1} + \\Sigma_{a,2}\\phi_2 V_2 = q_2 V_2$$\n    其中 $J_{1\\to 2}$ 是从 $V_1$ 流向 $V_2$ 的净中子流。根据牛顿第三定律，$J_{2\\to 1} = -J_{1\\to 2}$。\n    问题给出了界面流的近似表达式：$J_{1\\to 2} \\approx G(\\phi_1 - \\phi_2)$。将此代入平衡方程：\n    -   对于 $V_1$：$G(\\phi_1 - \\phi_2) + \\Sigma_{a,1}V_1\\phi_1 = q_1 V_1 \\implies (\\Sigma_{a,1}V_1 + G)\\phi_1 - G\\phi_2 = q_1 V_1$\n    -   对于 $V_2$：$-G(\\phi_1 - \\phi_2) + \\Sigma_{a,2}V_2\\phi_2 = q_2 V_2 \\implies -G\\phi_1 + (\\Sigma_{a,2}V_2 + G)\\phi_2 = q_2 V_2$\n    这两个方程构成了线性系统 $\\mathbf{A}\\boldsymbol{\\phi} = \\mathbf{q}$，其中 $\\boldsymbol{\\phi} = \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix}$，矩阵 $\\mathbf{A}$ 为：\n    $$\n    \\mathbf{A} = \\begin{pmatrix} \\Sigma_{a,1}V_1 + G  -G \\\\ -G  \\Sigma_{a,2}V_2 + G \\end{pmatrix}\n    $$\n    这与问题陈述中给出的矩阵形式一致。\n\n2.  **计算矩阵各项的数值**\n    首先，计算各区域的体积 $V_i = A_c h_i$：\n    $V_1 = (200\\,\\text{cm}^2)(30\\,\\text{cm}) = 6000\\,\\text{cm}^3$\n    $V_2 = (200\\,\\text{cm}^2)(20\\,\\text{cm}) = 4000\\,\\text{cm}^3$\n\n    然后，计算界面传导系数 $G$：\n    $$\n    G = \\frac{2\\,A_c}{\\frac{h_1}{D_1} + \\frac{h_2}{D_2}} = \\frac{2(200)}{\\frac{30}{1.2} + \\frac{20}{0.8}} = \\frac{400}{25 + 25} = \\frac{400}{50} = 8\\,\\text{cm}^2\n    $$\n\n    现在，计算矩阵 $\\mathbf{A}$ 的元素（单位为 $\\text{cm}^2$）：\n    $A_{11} = \\Sigma_{a,1}V_1 + G = (0.010\\,\\text{cm}^{-1})(6000\\,\\text{cm}^3) + 8 = 60 + 8 = 68$\n    $A_{22} = \\Sigma_{a,2}V_2 + G = (0.015\\,\\text{cm}^{-1})(4000\\,\\text{cm}^3) + 8 = 60 + 8 = 68$\n    $A_{12} = A_{21} = -G = -8$\n\n    因此，算子矩阵 $\\mathbf{A}$ 为：\n    $$\n    \\mathbf{A} = \\begin{pmatrix} 68  -8 \\\\ -8  68 \\end{pmatrix}\n    $$\n\n3.  **计算未经预处理的矩阵 $\\mathbf{A}$ 的特征值**\n    特征方程为 $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$：\n    $$\n    \\det\\begin{pmatrix} 68 - \\lambda  -8 \\\\ -8  68 - \\lambda \\end{pmatrix} = (68 - \\lambda)^2 - (-8)^2 = 0\n    $$\n    $$\n    (68 - \\lambda)^2 = 64 \\implies 68 - \\lambda = \\pm 8 \\implies \\lambda = 68 \\mp 8\n    $$\n    $\\mathbf{A}$ 的特征值为 $\\lambda_1 = 60$ 和 $\\lambda_2 = 76$。其谱为 $\\{60, 76\\}$。\n\n4.  **计算预处理矩阵 $\\mathbf{M}^{-1}\\mathbf{A}$ 及其特征值**\n    雅可比预条件子 $\\mathbf{M}$ 是 $\\mathbf{A}$ 的对角部分：\n    $$\n    \\mathbf{M} = \\begin{pmatrix} 68  0 \\\\ 0  68 \\end{pmatrix}\n    $$\n    其逆矩阵为：\n    $$\n    \\mathbf{M}^{-1} = \\begin{pmatrix} 1/68  0 \\\\ 0  1/68 \\end{pmatrix}\n    $$\n    预处理后的矩阵为 $\\mathbf{M}^{-1}\\mathbf{A}$：\n    $$\n    \\mathbf{M}^{-1}\\mathbf{A} = \\begin{pmatrix} 1/68  0 \\\\ 0  1/68 \\end{pmatrix} \\begin{pmatrix} 68  -8 \\\\ -8  68 \\end{pmatrix} = \\begin{pmatrix} 1  -8/68 \\\\ -8/68  1 \\end{pmatrix} = \\begin{pmatrix} 1  -2/17 \\\\ -2/17  1 \\end{pmatrix}\n    $$\n    计算预处理矩阵的特征值 $\\mu$。特征方程为 $\\det(\\mathbf{M}^{-1}\\mathbf{A} - \\mu\\mathbf{I}) = 0$：\n    $$\n    \\det\\begin{pmatrix} 1 - \\mu  -2/17 \\\\ -2/17  1 - \\mu \\end{pmatrix} = (1 - \\mu)^2 - \\left(-\\frac{2}{17}\\right)^2 = 0\n    $$\n    $$\n    (1 - \\mu)^2 = \\left(\\frac{2}{17}\\right)^2 \\implies 1 - \\mu = \\pm \\frac{2}{17} \\implies \\mu = 1 \\mp \\frac{2}{17}\n    $$\n    预处理矩阵 $\\mathbf{M}^{-1}\\mathbf{A}$ 的特征值为：\n    $\\mu_1 = 1 - \\frac{2}{17} = \\frac{15}{17}$\n    $\\mu_2 = 1 + \\frac{2}{17} = \\frac{19}{17}$\n\n**结论**\n未经预处理的系统特征值为 $\\{60, 76\\}$。经过雅可比预处理后，系统特征值变为 $\\{\\frac{15}{17}, \\frac{19}{17}\\}$。预处理使得特征值紧密地聚集在1的周围，这通常会显著加速迭代求解器（如共轭梯度法）的收敛速度。在本例中，由于原矩阵对角元恰好相等，条件数 $\\kappa = 76/60 = 19/15$ 在预处理前后保持不变，但谱的聚集是预处理有效性的关键体现。",
            "answer": "$$\\boxed{\\frac{15}{17}, \\frac{19}{17}}$$"
        },
        {
            "introduction": "在预处理基本概念的基础上，这最后一个练习将带你应对一个更具挑战性的现实场景，即处理具有高反差扩散性质的材料。你将运用谱分析来估计原始系统和对角预处理后系统的条件数。通过这种分析，你能够量化预期的性能提升，从而证明即使是简单的预条件子也能显著减少共轭梯度法求解复杂问题所需的迭代次数。",
            "id": "4234506",
            "problem": "在一个具有真空边界条件的单群中子扩散一维平板模型中，考虑一个由两种材料构成的分层介质：当 $x \\in [0,1/2]$ 时，扩散系数为 $D_{1}$；当 $x \\in (1/2,1]$ 时，扩散系数为 $D_{2}$。稳态扩散方程为 $- \\frac{d}{dx}\\!\\left(D(x)\\,\\frac{d\\phi}{dx}\\right) = q(x)$，且满足 $\\phi(0) = \\phi(1) = 0$，其中 $D(x)$ 是如前述的分段常数函数，$q(x)$ 是一个有界源项。使用包含 $N=128$ 个单元、单元宽度为 $h = 1/(N+1)$ 的均匀网格对区间 $[0,1]$ 进行离散化，并通过在单元交界面上对扩散系数进行调和平均的守恒有限体积格式，构建对称正定线性系统 $A \\phi = b$。所得到的刚度矩阵 $A$ 是一个对称三对角 M 矩阵，其元素由交界面传导系数 $D_{i+1/2}$ 构造，其中 $D_{i+1/2}$ 是相邻单元扩散系数的调和平均值。\n\n令 $M = \\operatorname{diag}(A)$ 表示对角（雅可比）预条件子。利用有限体积离散化的基本原理、瑞利商界以及均匀网格上离散狄利克雷拉普拉斯算子的谱性质，估计条件数 $\\kappa(A)$ 和 $\\kappa(M^{-1}A)$，其估计结果可相差一个不依赖于扩散系数反差 $D_{\\max}/D_{\\min}$ 的乘法常数，其中 $D_{\\min} = \\min\\{D_{1},D_{2}\\}$ 且 $D_{\\max} = \\max\\{D_{1},D_{2}\\}$。然后，利用共轭梯度（CG）法的标准能量范数收敛界（该收敛界关联了迭代次数 $m$、条件数 $\\kappa$ 以及在 A-范数下期望的误差缩减因子 $\\varepsilon$），确定预测的比率\n$$\nR \\;=\\; \\frac{m_{\\text{unpre}}}{m_{\\text{pre}}},\n$$\n其中 $m_{\\text{unpre}}$ 和 $m_{\\text{pre}}$ 分别为不使用预条件和使用对角预条件时，将误差的 A-范数减小 $\\varepsilon = 10^{-8}$ 倍所需的 CG 迭代次数。取 $D_{1} = 1$ 和 $D_{2} = 100$。将你的最终答案表示为一个实数，并四舍五入到四位有效数字。",
            "solution": "我们首先回顾在均匀网格上对带变系数的一维二阶算子进行的有限体积离散化。令 $x_{i}$ 表示内部单元的中心，$i=1,\\dots,N$，网格宽度为 $h = 1/(N+1)$。采用在交界面上进行调和平均的守恒通量平衡法，可以得到一个对称三对角刚度矩阵 $A$，它对任意向量 $v \\in \\mathbb{R}^{N}$ 满足\n$$\nv^{\\top} A v \\;=\\; \\frac{1}{h^{2}} \\sum_{i=0}^{N} D_{i+1/2}\\,\\big(v_{i+1} - v_{i}\\big)^{2},\n$$\n其中，根据狄利克雷边界条件，约定 $v_{0}=v_{N+1}=0$，且 $D_{i+1/2}$ 是相邻单元上 $D$ 的调和平均值。对于在 $[0,1/2]$ 上扩散系数为 $D_{1}$、在 $(1/2,1]$ 上扩散系数为 $D_{2}$ 的分层介质，对所有的 $i$，交界面传导系数满足 $D_{\\min} \\le D_{i+1/2} \\le D_{\\max}$，其中 $D_{\\min} = \\min\\{D_{1},D_{2}\\}$ 且 $D_{\\max} = \\max\\{D_{1},D_{2}\\}$。\n\n定义标准的离散狄利克雷拉普拉斯模板矩阵 $T \\in \\mathbb{R}^{N \\times N}$ 如下：\n$$\nw^{\\top} \\left(\\frac{1}{h^{2}} T\\right) w \\;=\\; \\frac{1}{h^{2}} \\sum_{i=0}^{N} \\big(w_{i+1} - w_{i}\\big)^{2},\n$$\n因此 $(1/h^{2})T$ 的特征值为\n$$\n\\lambda_{k}\\!\\left(\\frac{1}{h^{2}} T\\right) \\;=\\; \\frac{4}{h^{2}} \\sin^{2}\\!\\left(\\frac{k\\pi}{2(N+1)}\\right), \\quad k=1,\\dots,N.\n$$\n因此\n$$\n\\lambda_{\\min}\\!\\left(\\frac{1}{h^{2}} T\\right) \\;=\\; \\frac{4}{h^{2}} \\sin^{2}\\!\\left(\\frac{\\pi}{2(N+1)}\\right), \n\\quad\n\\lambda_{\\max}\\!\\left(\\frac{1}{h^{2}} T\\right) \\;=\\; \\frac{4}{h^{2}} \\sin^{2}\\!\\left(\\frac{N\\pi}{2(N+1)}\\right).\n$$\n\n我们现在使用瑞利商比较来界定条件数 $\\kappa(A)$。对于任意 $v \\in \\mathbb{R}^{N}$，\n$$\n\\frac{D_{\\min}}{h^{2}} \\sum_{i=0}^{N} \\big(v_{i+1} - v_{i}\\big)^{2}\n\\;\\le\\;\nv^{\\top} A v\n\\;\\le\\;\n\\frac{D_{\\max}}{h^{2}} \\sum_{i=0}^{N} \\big(v_{i+1} - v_{i}\\big)^{2}.\n$$\n根据 Courant–Fischer 最小-最大特征值定理以及 $(1/h^{2})T$ 的特征对，可以得出\n$$\n\\lambda_{\\min}(A) \\;\\ge\\; D_{\\min} \\,\\lambda_{\\min}\\!\\left(\\frac{1}{h^{2}} T\\right),\n\\qquad\n\\lambda_{\\max}(A) \\;\\le\\; D_{\\max} \\,\\lambda_{\\max}\\!\\left(\\frac{1}{h^{2}} T\\right),\n$$\n因此\n$$\n\\kappa(A) \\;=\\; \\frac{\\lambda_{\\max}(A)}{\\lambda_{\\min}(A)}\n\\;\\le\\;\n\\frac{D_{\\max}}{D_{\\min}} \\cdot \n\\frac{\\lambda_{\\max}\\!\\left(\\frac{1}{h^{2}} T\\right)}{\\lambda_{\\min}\\!\\left(\\frac{1}{h^{2}} T\\right)}\n\\;=\\;\n\\frac{D_{\\max}}{D_{\\min}} \\cdot\n\\frac{\\sin^{2}\\!\\left(\\frac{N\\pi}{2(N+1)}\\right)}{\\sin^{2}\\!\\left(\\frac{\\pi}{2(N+1)}\\right)}.\n$$\n其渐进行为的缩放尺度为 $\\mathcal{O}\\!\\left(\\frac{D_{\\max}}{D_{\\min}} N^{2}\\right)$。\n\n接下来，考虑对角（雅可比）预条件子 $M = \\operatorname{diag}(A)$ 以及与原矩阵相似的对称预处理矩阵 $H = M^{-1/2} A M^{-1/2}$。其极端特征值可由瑞利商表示为\n$$\n\\lambda(H) \\;=\\; \n\\frac{v^{\\top} A v}{v^{\\top} M v}\n\\;=\\;\n\\frac{\\frac{1}{h^{2}} \\sum_{i=0}^{N} D_{i+1/2}\\,(v_{i+1}-v_{i})^{2}}{\\frac{1}{h^{2}} \\sum_{i=1}^{N} (D_{i-1/2}+D_{i+1/2}) \\, v_{i}^{2}}.\n$$\n对角缩放的主要作用是归一化由扩散系数变化引起的局部尺度变化。在每个 $D$ 为常数的均匀子区域中，分子和分母以相同的扩散因子进行缩放，因此 $H$ 的局部符号与归一化的一维拉普拉斯算子的符号相同。对 $D_{\\max}/D_{\\min}$ 的依赖性主要来源于材料交界面处的少数几行。对于这种只有一个交界面的简单情况，可以证明预处理后矩阵的谱等价于标准离散拉普拉斯算子，其等价常数不依赖于扩散系数的反差。因此，预处理后矩阵的条件数 $\\kappa(M^{-1}A) = \\kappa(H)$ 近似为\n$$\n\\kappa\\!\\big(M^{-1} A\\big) \\;\\approx\\; \n\\frac{\\sin^{2}\\!\\left(\\frac{N\\pi}{2(N+1)}\\right)}{\\sin^{2}\\!\\left(\\frac{\\pi}{2(N+1)}\\right)}\n\\;\\sim\\; \\mathcal{O}(N^2),\n$$\n即对系数反差的主要依赖性被消除了。\n\n最后，我们将共轭梯度（CG）的迭代次数与条件数关联起来。一个标准的收敛界表明，为达到给定的误差缩减，所需迭代次数 $m$ 近似与条件数的平方根成正比：\n$$\nm \\;\\propto\\; \\sqrt{\\kappa}.\n$$\n因此，对于无预条件和有预条件的系统，其达到相同收敛容差所需的迭代次数比率 $R$ 可估计为：\n$$\nR \\;=\\; \\frac{m_{\\text{unpre}}}{m_{\\text{pre}}}\n\\;\\approx\\;\n\\frac{\\sqrt{\\kappa(A)}}{\\sqrt{\\kappa\\!\\big(M^{-1}A\\big)}}.\n$$\n代入我们前面得到的条件数估计：\n$$\nR \\;\\approx\\; \\frac{\\sqrt{\\frac{D_{\\max}}{D_{\\min}} \\cdot \\mathcal{O}(N^2)}}{\\sqrt{\\mathcal{O}(N^2)}} \\;=\\; \\sqrt{\\frac{D_{\\max}}{D_{\\min}}}.\n$$\n给定 $D_{1}=1$ 和 $D_{2}=100$，我们有 $D_{\\max}/D_{\\min} = 100$。因此，\n$$\nR \\;\\approx\\; \\sqrt{100} \\;=\\; 10.\n$$\n四舍五入到四位有效数字，预测的比率为 $10.00$。",
            "answer": "$$\\boxed{10.00}$$"
        }
    ]
}