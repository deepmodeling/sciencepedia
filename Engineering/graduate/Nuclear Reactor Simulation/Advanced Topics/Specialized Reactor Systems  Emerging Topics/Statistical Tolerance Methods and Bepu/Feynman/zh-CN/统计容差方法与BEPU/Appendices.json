{
    "hands_on_practices": [
        {
            "introduction": "在最佳估算加不确定性（BEPU）分析中，一个核心任务是利用统计学方法来论证安全限值。Wilks单侧容差限是一种基石性的非参数方法，因为它无需假设输出变量的具体概率分布。这个练习 () 提供了推导和应用Wilks公式的实践，用于验证给定的样本量是否满足核安全评估中常见的“95/95”准则，这是一项关键技能。",
            "id": "4251480",
            "problem": "对压水堆堆芯进行最佳估算加不确定性 (BEPU) 分析，以评估偏离泡核沸腾比 (DNBR)，其定义为临界热通量与实际局部热通量之比。由于较高的 DNBR 意味着较大的热工裕度，因此将风险相关变量取为 DNBR 的倒数 $Y = 1/\\mathrm{DNBR}$，这样较大的 $Y$ 值就更为不利。假设在稳定、额定工况下，生成了 $N = 59$ 个独立同分布的 $Y$ 的 BEPU 实现，并且 $Y$ 的真实分布是连续的。\n\n在单侧 Wilks 非参数容差方法中，$Y$ 的容差上限定义为样本中观测到的最大值。DNBR 的监管安全目标规定如下：单侧容差声明必须确保至少有 $p_{\\mathrm{goal}} = 0.95$ 的总体比例以 $\\gamma_{\\mathrm{goal}} = 0.95$ 的置信度位于容差上限以下。就 $Y$ 而言，这意味着至少有 $0.95$ 的置信度，至少 $0.95$ 的运行状态其 $Y$ 值将低于该界限，等效于 DNBR 高于该界限的倒数。\n\n从顺序统计量和概率积分变换的第一性原理出发，推导由样本最大值构建的单侧上 Wilks 界限的容差含量 $p$ 和置信度 $\\gamma$ 之间的关系。然后，使用 $N = 59$，在 $p$ 等于 $p_{\\mathrm{goal}}$ 时，计算可实现的数对 $(p,\\gamma)$。将 $p$ 和 $\\gamma$ 表示为小数，并将 $\\gamma$ 四舍五入到四位有效数字。最后，说明所得数对是否满足为 DNBR 指定的安全目标。",
            "solution": "### 步骤 1：推导Wilks公式\n设 $Y_1, Y_2, \\dots, Y_N$ 是从一个未知但连续的累积分布函数（CDF）$F_Y(y)$ 中抽取的 $N$ 个独立同分布 (i.i.d.) 随机样本。样本的顺序统计量记为 $Y_{(1)} \\le Y_{(2)} \\le \\dots \\le Y_{(N)}$。单侧上容差限 $T_U$ 定义为样本最大值 $Y_{(N)}$。\n\n容差区间的随机覆盖率 $C$ 是由区间 $(-\\infty, T_U]$ 覆盖的总体比例，即 $C = F_Y(T_U) = F_Y(Y_{(N)})$。置信度 $\\gamma$ 是指该随机覆盖率 $C$ 至少达到目标覆盖率 $p$ 的概率：\n$$ \\gamma = P(C \\ge p) = P(F_Y(Y_{(N)}) \\ge p) $$\n设 $y_p$ 是总体分布的真实 $p$-分位数，满足 $F_Y(y_p) = p$。由于 $F_Y$ 是单调递增的，上述不等式等价于：\n$$ Y_{(N)} \\ge y_p $$\n因此，置信度 $\\gamma$ 是样本最大值大于或等于总体真实 $p$-分位数的概率。使用其互补事件进行计算更为方便：\n$$ \\gamma = 1 - P(Y_{(N)}  y_p) $$\n事件 $Y_{(N)}  y_p$ 发生，当且仅当所有 $N$ 个独立的样本观测值都小于 $y_p$：\n$$ P(Y_{(N)}  y_p) = P(Y_1  y_p, Y_2  y_p, \\dots, Y_N  y_p) $$\n由于样本是独立同分布的，该联合概率等于各边缘概率的乘积：\n$$ P(Y_{(N)}  y_p) = \\prod_{i=1}^{N} P(Y_i  y_p) = \\prod_{i=1}^{N} F_Y(y_p) $$\n根据 $p$-分位数的定义，$F_Y(y_p) = p$。因此：\n$$ P(Y_{(N)}  y_p) = p^N $$\n将此结果代回，我们得到著名的单侧Wilks公式：\n$$ \\gamma = 1 - p^N $$\n该推导从第一性原理出发，仅依赖于独立同分布样本和连续CDF的基本属性。\n\n### 步骤 2：计算可实现的置信度\n给定参数：\n- 样本大小，$N = 59$。\n- 目标覆盖率，$p = p_{\\mathrm{goal}} = 0.95$。\n\n使用推导出的公式计算可实现的置信度 $\\gamma$：\n$$ \\gamma = 1 - (0.95)^{59} \\approx 1 - 0.04849646 \\approx 0.95150354 $$\n根据要求，将 $\\gamma$ 四舍五入到四位有效数字，得到 $\\gamma \\approx 0.9515$。\n因此，对于 $p=0.95$ 和 $N=59$，可实现的数对是 $(p, \\gamma) = (0.95, 0.9515)$。\n\n### 步骤 3：验证是否满足安全目标\n安全目标要求同时满足 $p \\ge p_{\\mathrm{goal}}$ 和 $\\gamma \\ge \\gamma_{\\mathrm{goal}}$，其中 $p_{\\mathrm{goal}}=0.95$ 且 $\\gamma_{\\mathrm{goal}}=0.95$。\n\n1.  **覆盖率检查**：我们设定的 $p = 0.95$，满足 $p \\ge 0.95$。\n2.  **置信度检查**：我们计算出的 $\\gamma \\approx 0.9515$，满足 $\\gamma \\ge 0.95$。\n\n由于两个条件均得到满足，因此使用 $N=59$ 个样本的BEPU分析满足指定的“95/95”安全目标。选择 $N=59$ 是核工业界的标准做法，正因为它是在满足“95/95”单侧容差准则下的最小整数样本量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.95  0.9515\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在了解了非参数方法后，自然会思考是否存在其他替代方案。参数化容差区间利用了关于输出分布的先验知识（例如，正态性），从而可能提高统计效率。本练习 () 旨在量化这种效率上的权衡。通过计算和比较参数化方法与非参数方法为达到相同的置信度和覆盖率目标所需的样本量，您将深刻理解在计算成本高昂的反应堆模拟中，不同统计建模选择的实际影响。",
            "id": "4251455",
            "problem": "对一个压水反应堆的冷却剂丧失事故 (LOCA) 场景进行最佳估算加不确定性 (BEPU) 分析。通过一个经过校准和验证的程序代码以及拟合优度评估，验证了与安全相关的模拟输出量——包壳峰值温度（用 $Y$ 表示）服从正态分布。分析的目标是构造一个单边上容忍限，该容忍限在置信水平为 $\\gamma$ 的情况下，至少包含 $Y$ 真实分布的含量比例 $p$。\n\n考虑两种可供选择的容忍限构造方法：\n\n1. 一种基于 Wilks 顺序统计量上界的非参数构造方法，使用来自 $N$ 次独立运行的样本最大值。\n2. 一种在已验证的正态性假设和已知标准差 $\\sigma$ 下的参数正态理论构造方法，其中 BEPU 预算将容忍限约束为 $T_{\\mathrm{P}}=\\bar{X}+m_{\\max}\\sigma$ 的形式，且具有一个不可超过的固定裕度乘子 $m_{\\max}$。\n\n假设以下数值目标和约束条件：\n- 含量比例 $p=0.95$，\n- 置信水平 $\\gamma=0.95$，\n- 裕度乘子 $m_{\\max}=2.5$。\n\n从顺序统计量和独立正态随机变量之和的定义与第一性原理出发，解析地确定：\n- Wilks 非参数方法为满足 $(p,\\gamma)$ 目标所需的最小样本量 $N_{\\mathrm{W}}$，以及\n- 参数方法在 $m_{\\max}$ 约束下，为保证 $T_{\\mathrm{P}}$ 达到相同 $(p,\\gamma)$ 目标所需的最小样本量 $N_{\\mathrm{P}}$。\n\n最后，计算效率比 $R=N_{\\mathrm{W}}/N_{\\mathrm{P}}$。将最终比值四舍五入至四位有效数字。该比值为无量纲量，无需指明单位。",
            "solution": "### 第一部分：非参数 Wilks 方法的样本量, $N_{\\mathrm{W}}$\n\n对于基于样本最大值的单边上容忍限，其置信度 $\\gamma$、覆盖率 $p$ 和样本量 $N$ 之间的关系为：\n$$ \\gamma = 1 - p^N $$\n我们需要找到满足 $\\gamma \\ge 0.95$ 的最小整数 $N_{\\mathrm{W}}$，其中 $p=0.95$。\n$$ 1 - (0.95)^{N_{\\mathrm{W}}} \\ge 0.95 $$\n$$ (0.95)^{N_{\\mathrm{W}}} \\le 0.05 $$\n对两边取自然对数：\n$$ N_{\\mathrm{W}} \\ln(0.95) \\le \\ln(0.05) $$\n由于 $\\ln(0.95)$ 是负数，除以它会使不等号反向：\n$$ N_{\\mathrm{W}} \\ge \\frac{\\ln(0.05)}{\\ln(0.95)} \\approx 58.403 $$\n由于样本量 $N_{\\mathrm{W}}$ 必须是整数，我们取满足此条件的最小整数：\n$$ N_{\\mathrm{W}} = 59 $$\n\n### 第二部分：参数正态理论方法的样本量, $N_{\\mathrm{P}}$\n\n在这种方法中，数据 $X_1, \\dots, X_{N_{\\mathrm{P}}}$ 来自标准差 $\\sigma$ 已知的正态分布 $N(\\mu, \\sigma^2)$。容忍限为 $T_{\\mathrm{P}} = \\bar{X} + m_{\\max}\\sigma$，其中 $\\bar{X}$ 是样本均值。\n\n对于一个新的观测值 $Y \\sim N(\\mu, \\sigma^2)$，其值低于 $T_{\\mathrm{P}}$ 的概率（即覆盖率）为：\n$$ P(Y \\le T_{\\mathrm{P}} \\mid \\bar{X}) = \\Phi\\left(\\frac{T_{\\mathrm{P}} - \\mu}{\\sigma}\\right) = \\Phi\\left(\\frac{(\\bar{X} + m_{\\max}\\sigma) - \\mu}{\\sigma}\\right) = \\Phi\\left(\\frac{\\bar{X} - \\mu}{\\sigma} + m_{\\max}\\right) $$\n其中 $\\Phi(z)$ 是标准正态分布的CDF。我们需要这个随机覆盖率以置信度 $\\gamma$ 至少达到 $p$：\n$$ P\\left[ \\Phi\\left(\\frac{\\bar{X} - \\mu}{\\sigma} + m_{\\max}\\right) \\ge p \\right] \\ge \\gamma $$\n令 $z_p = \\Phi^{-1}(p)$ 为标准正态分布的 $p$-分位数。由于 $\\Phi$ 是严格递增的，不等式等价于：\n$$ P\\left( \\frac{\\bar{X} - \\mu}{\\sigma} + m_{\\max} \\ge z_p \\right) \\ge \\gamma $$\n$$ P\\left( \\frac{\\bar{X} - \\mu}{\\sigma} \\ge z_p - m_{\\max} \\right) \\ge \\gamma $$\n样本均值 $\\bar{X}$ 的分布为 $N(\\mu, \\sigma^2/N_{\\mathrm{P}})$。因此，随机变量 $W = \\frac{\\bar{X} - \\mu}{\\sigma}$ 服从分布 $N(0, 1/N_{\\mathrm{P}})$，可以表示为 $W = \\frac{Z}{\\sqrt{N_{\\mathrm{P}}}}$，其中 $Z \\sim N(0,1)$。\n条件变为：\n$$ P\\left( \\frac{Z}{\\sqrt{N_{\\mathrm{P}}}} \\ge z_p - m_{\\max} \\right) \\ge \\gamma $$\n$$ P\\left( Z \\ge \\sqrt{N_{\\mathrm{P}}}(z_p - m_{\\max}) \\right) \\ge \\gamma $$\n该概率为 $1 - \\Phi(\\sqrt{N_{\\mathrm{P}}}(z_p - m_{\\max}))$。因此：\n$$ \\Phi(\\sqrt{N_{\\mathrm{P}}}(z_p - m_{\\max})) \\le 1 - \\gamma $$\n应用逆CDF $\\Phi^{-1}$，并利用对称性 $\\Phi^{-1}(1-\\gamma) = -z_\\gamma$：\n$$ \\sqrt{N_{\\mathrm{P}}}(z_p - m_{\\max}) \\le -z_\\gamma $$\n我们代入数值：$p=0.95 \\implies z_p \\approx 1.64485$ 和 $\\gamma=0.95 \\implies z_\\gamma \\approx 1.64485$。$m_{\\max}=2.5$。\n$$ \\sqrt{N_{\\mathrm{P}}}(1.64485 - 2.5) \\le -1.64485 $$\n$$ \\sqrt{N_{\\mathrm{P}}}(-0.85515) \\le -1.64485 $$\n除以负数，不等号反向：\n$$ \\sqrt{N_{\\mathrm{P}}} \\ge \\frac{-1.64485}{-0.85515} \\approx 1.92346 $$\n$$ N_{\\mathrm{P}} \\ge (1.92346)^2 \\approx 3.6997 $$\n最小整数样本量为：\n$$ N_{\\mathrm{P}} = 4 $$\n\n### 第三部分：效率比, $R$\n\n效率比 $R$ 是非参数方法与参数方法所需的样本量之比：\n$$ R = \\frac{N_{\\mathrm{W}}}{N_{\\mathrm{P}}} = \\frac{59}{4} = 14.75 $$\n结果已为四位有效数字。",
            "answer": "$$\\boxed{14.75}$$"
        },
        {
            "introduction": "真实世界系统中的不确定性来源往往不是相互独立的。本练习从理论计算转向了一个更贴近实际的计算模拟任务，旨在探索输入参数之间的相关性对输出不确定性的影响。通过这个编码实践 ()，您将获得不确定性传播的实践经验，学习使用Cholesky分解来生成相关变量样本，并亲眼见证输入间的依赖关系如何显著改变输出分布及最终的安全裕度。",
            "id": "4251476",
            "problem": "考虑对一个压水反应堆进行最佳估算加不确定性（BEPU）分析，其中关注量为燃料包壳峰值温度（PCT）。假设不确定性输入向量维度为 $d=5$，并被建模为一个零均值的多元正态随机向量 $\\mathbf{z}\\in\\mathbb{R}^5$，其协方差矩阵为 $\\boldsymbol{\\Sigma}\\in\\mathbb{R}^{5\\times 5}$。PCT响应由一个二阶响应面表示\n$$\nT(\\mathbf{z}) \\;=\\; T_0 \\;+\\; \\mathbf{c}^\\top \\mathbf{z} \\;+\\; \\tfrac{1}{2}\\,\\mathbf{z}^\\top \\mathbf{H}\\,\\mathbf{z},\n$$\n其中 $T_0\\in\\mathbb{R}$ 是基准PCT，$\\mathbf{c}\\in\\mathbb{R}^5$ 是一个灵敏度向量，$\\mathbf{H}\\in\\mathbb{R}^{5\\times 5}$ 是一个对称曲率矩阵。所有温度均以开尔文（K）表示。相对于安全限值 $T_{\\text{limit}}$ 的BEPU裕度定义为\n$$\nM \\;=\\; T_{\\text{limit}} \\;-\\; Q_{0.95}[T(\\mathbf{z})],\n$$\n其中 $Q_{0.95}[\\cdot]$ 表示PCT分布的 $0.95$ 分位数。\n\n您的任务是，对于几个指定的协方差矩阵，计算当用相关抽样（即使用指定的 $\\boldsymbol{\\Sigma}$）替代独立抽样（即使用 $\\boldsymbol{\\Sigma}=\\mathbf{I}$）时，输出 $T(\\mathbf{z})$ 的 $0.95$ 分位数的变化，并由此计算BEPU裕度的变化。您必须从第一性原理出发实现以下内容：\n\n- 使用多元正态分布的定义和Cholesky分解。具体来说，如果 $\\mathbf{e}\\sim \\mathcal{N}(\\mathbf{0},\\mathbf{I})$，则通过 $\\mathbf{z} = \\mathbf{L}\\mathbf{e}$ 生成相关样本，其中 $\\mathbf{L}$ 满足 $\\mathbf{L}\\mathbf{L}^\\top = \\boldsymbol{\\Sigma}$。\n- 构建一个固定的样本矩阵 $\\mathbf{E}\\in\\mathbb{R}^{d\\times N}$ 以确保可复现性并通过对偶配对来减少方差。设 $N=2M$ 且 $M=100{,}000$。使用种子为 $12345$ 的伪随机数生成器生成一个具有独立标准正态条目的矩阵 $\\mathbf{G}\\in\\mathbb{R}^{d\\times M}$，然后设置 $\\mathbf{E} = [\\mathbf{G},\\,-\\mathbf{G}]$ (按列串联)。这确保了独立基准情况和所有相关情况都由相同的底层标准正态变量驱动。\n- 对于测试套件中的每个协方差矩阵 $\\boldsymbol{\\Sigma}$，计算在该 $\\boldsymbol{\\Sigma}$ 下和在独立情况 $\\mathbf{I}$ 下的 $0.95$ 分位数 $Q_{0.95}[T(\\mathbf{z})]$（使用相同的 $\\mathbf{E}$），然后报告分位数的变化\n$$\n\\Delta Q \\;=\\; Q_{0.95}[T(\\mathbf{z});\\,\\boldsymbol{\\Sigma}] \\;-\\; Q_{0.95}[T(\\mathbf{z});\\,\\mathbf{I}]\n$$\n以开尔文为单位，四舍五入到三位小数。同时计算相应的裕度变化 $\\Delta M$，以开尔文为单位，四舍五入到三位小数，其中\n$$\n\\Delta M \\;=\\; -\\,\\Delta Q.\n$$\n\n使用以下固定的模型系数和安全限值：\n- 基准PCT：$T_0 = 1100$ K。\n- 灵敏度向量：$\\mathbf{c} = [30,\\,-20,\\,15,\\,-10,\\,25]^\\top$ K。\n- 对称曲率矩阵（二次型中的单位为K）：\n$$\n\\mathbf{H} \\;=\\; \\begin{bmatrix}\n3.0  1.0  0.0  0.0  0.0 \\\\\n1.0  2.0  0.5  0.0  0.0 \\\\\n0.0  0.5  1.5  0.3  0.0 \\\\\n0.0  0.0  0.3  1.0  0.2 \\\\\n0.0  0.0  0.0  0.2  1.2\n\\end{bmatrix}.\n$$\n- 安全限值：$T_{\\text{limit}} = 1477$ K。\n- 分位数水平：$0.95$。\n\n对于协方差矩阵，请使用以下测试套件，每个都指定为一个 $5\\times 5$ 的相关矩阵（即单位方差）。在每种情况下，独立基准均为 $\\mathbf{I}$。\n1. 单位矩阵（与基准等效）：\n$$\n\\boldsymbol{\\Sigma}_1 \\;=\\; \\mathbf{I}_{5}.\n$$\n2. 等相关正值情况（$\\rho=0.6$）：\n$$\n\\boldsymbol{\\Sigma}_2 \\;=\\; (1-\\rho)\\mathbf{I}_5 \\;+\\; \\rho\\,\\mathbf{1}\\mathbf{1}^\\top,\\quad \\rho=0.6,\n$$\n其中 $\\mathbf{1}\\in\\mathbb{R}^5$ 是全一向量。\n3. 单一强負相关对：\n$$\n\\boldsymbol{\\Sigma}_3 \\;=\\; \\mathbf{I}_5 \\;+\\; \\rho(\\mathbf{e}_1\\mathbf{e}_2^\\top+\\mathbf{e}_2\\mathbf{e}_1^\\top),\\quad \\rho=-0.6,\n$$\n其中 $\\mathbf{e}_i$ 是第 $i$ 个标准基向量。\n4. 近奇异等相关正值情况（$\\rho=0.95$）：\n$$\n\\boldsymbol{\\Sigma}_4 \\;=\\; (1-\\rho)\\mathbf{I}_5 \\;+\\; \\rho\\,\\mathbf{1}\\mathbf{1}^\\top,\\quad \\rho=0.95.\n$$\n\n实现要求：\n- 在每种情况下，使用响应面为所有 $N$ 个样本计算PCT值。\n- 对独立和相关情况使用相同的 $\\mathbf{E}$，以消除差异中的抽样噪声。\n- 使用与序数统计量之间的线性插值一致的样本分位数标准定义来计算经验 $0.95$ 分位数。\n\n您的程序必须生成单行输出，其中包含按以下顺序汇总为单个列表的四个测试用例的结果：\n$$\n[\\Delta Q_1,\\Delta M_1,\\Delta Q_2,\\Delta M_2,\\Delta Q_3,\\Delta M_3,\\Delta Q_4,\\Delta M_4],\n$$\n每个条目都以开尔文（K）为单位，表示为四舍五入到三位小数的十进制数。对于单位矩阵的情况，按照规定计算时，$\\Delta Q_1$ 和 $\\Delta M_1$ 应恰好为 $0.000$。\n\n您的解决方案必须是纯粹计算性的，不得需要任何用户输入或外部数据。数值答案必须严格按照指定格式打印为单行。本问题不使用角度。百分比必须作为小数处理（例如，使用 $0.95$ 而不是 $95\\%$）。",
            "solution": "该计算任务旨在通过蒙特卡洛模拟，量化输入参数之间的相关性对响应面模型输出（PCT）高分位数的影响。\n\n**方法论概要**\n1.  **基础样本生成**：首先，生成一个包含 $N=200,000$ 个 $d=5$ 维独立标准正态随机向量的大型固定样本集 $\\mathbf{E}$。为减少抽样误差，采用对偶配对（antithetic variates）技术，即样本集由 $N/2$ 个随机向量及其相反向量构成。这个固定的样本集 $\\mathbf{E}$ 将作为所有后续计算的共同随机基础。\n\n2.  **基准（独立）情况计算**：将基础样本 $\\mathbf{E}$ 直接作为响应面模型的输入（相当于协方差矩阵 $\\boldsymbol{\\Sigma} = \\mathbf{I}$）。利用向量化计算，高效地为所有 $N$ 个输入向量评估PCT响应值。然后，计算这组PCT值的经验 $0.95$ 分位数，记为 $Q_{0.95}[T(\\mathbf{z});\\,\\mathbf{I}]$。\n\n3.  **相关情况计算**：对于测试套件中的每一个协方差矩阵 $\\boldsymbol{\\Sigma}_k$：\n    a.  **Cholesky分解**：计算 $\\boldsymbol{\\Sigma}_k$ 的Cholesky分解，得到下三角矩阵 $\\mathbf{L}_k$，满足 $\\boldsymbol{\\Sigma}_k = \\mathbf{L}_k \\mathbf{L}_k^\\top$。\n    b.  **相关样本生成**：通过线性变换 $\\mathbf{Z}_k = \\mathbf{L}_k \\mathbf{E}$，将基础独立样本 $\\mathbf{E}$ 转换为具有协方差结构 $\\boldsymbol{\\Sigma}_k$ 的相关样本 $\\mathbf{Z}_k$。\n    c.  **响应计算与分位数**：使用这组相关样本 $\\mathbf{Z}_k$ 计算PCT响应值，并求出其经验 $0.95$ 分位数 $Q_{0.95}[T(\\mathbf{z});\\,\\boldsymbol{\\Sigma}_k]$。\n\n4.  **影响量化**：对于每种相关情况，计算分位数相对于基准情况的变化 $\\Delta Q_k = Q_{0.95}[T(\\mathbf{z});\\,\\boldsymbol{\\Sigma}_k] - Q_{0.95}[T(\\mathbf{z});\\,\\mathbf{I}]$，以及由此导致的安全裕度变化 $\\Delta M_k = -\\Delta Q_k$。\n\n此过程通过在所有比较中使用相同的底层随机数，精确地隔离了相关性结构本身对输出不确定性的影响。最终答案中的Python代码实现了上述全部步骤，并按照指定格式输出结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import cholesky\n\ndef solve():\n    \"\"\"\n    Solves the BEPU analysis problem by calculating changes in the PCT quantile\n    due to input parameter correlations.\n    \"\"\"\n    # ====== Step 1: Define Constants and Model Parameters ======\n    d = 5\n    M = 100_000\n    N = 2 * M\n    seed = 12345\n    q_level = 0.95\n    \n    # Model coefficients\n    T0 = 1100.0\n    c = np.array([[30.0], [-20.0], [15.0], [-10.0], [25.0]]) # shape (d, 1)\n    H = np.array([\n        [3.0, 1.0, 0.0, 0.0, 0.0],\n        [1.0, 2.0, 0.5, 0.0, 0.0],\n        [0.0, 0.5, 1.5, 0.3, 0.0],\n        [0.0, 0.0, 0.3, 1.0, 0.2],\n        [0.0, 0.0, 0.0, 0.2, 1.2]\n    ])\n\n    # ====== Step 2: Generate Base Samples ======\n    # Use a fixed seed for reproducibility\n    rng = np.random.default_rng(seed)\n    # Generate G with shape (d, M)\n    G = rng.normal(size=(d, M))\n    # Construct E with antithetic pairing, shape (d, N)\n    E = np.concatenate([G, -G], axis=1)\n\n    # ====== Helper function to calculate PCT ======\n    def calculate_pct(Z, T0_val, c_vec, H_mat):\n        \"\"\"\n        Calculates PCT values for a matrix of samples Z.\n        Z is expected to have shape (d, N).\n        \"\"\"\n        linear_term = c_vec.T @ Z\n        # The quadratic term z.T @ H @ z is computed efficiently for all samples\n        # by summing the element-wise product of Z and (H @ Z)\n        quadratic_term = 0.5 * np.sum(Z * (H_mat @ Z), axis=0, keepdims=True)\n        return (T0_val + linear_term + quadratic_term).flatten()\n\n    # ====== Step 3: Calculate Baseline Quantile (Independent Case) ======\n    # For the independent case, Sigma = I, so L = I and Z = E.\n    pct_independent = calculate_pct(E, T0, c, H)\n    q_independent = np.quantile(pct_independent, q_level, method='linear')\n\n    # ====== Step 4: Define Test Cases for Covariance Matrices ======\n    I5 = np.identity(d)\n    ones_vec = np.ones((d, 1))\n    ones_mat = ones_vec @ ones_vec.T\n    \n    rho_2 = 0.6\n    Sigma_2 = (1 - rho_2) * I5 + rho_2 * ones_mat\n    \n    rho_3 = -0.6\n    E12 = np.zeros((d, d))\n    E12[0, 1] = E12[1, 0] = 1.0\n    Sigma_3 = I5 + rho_3 * E12\n    \n    rho_4 = 0.95\n    Sigma_4 = (1 - rho_4) * I5 + rho_4 * ones_mat\n    \n    test_cases = [\n        I5,\n        Sigma_2,\n        Sigma_3,\n        Sigma_4\n    ]\n\n    results = []\n\n    # ====== Step 5: Process Each Correlated Case ======\n    for Sigma in test_cases:\n        # Perform Cholesky decomposition: Sigma = L * L.T\n        try:\n            L = cholesky(Sigma, lower=True)\n        except np.linalg.LinAlgError:\n            # Handle cases where Sigma might not be positive definite\n            # though all provided matrices are.\n            results.extend([\"NaN\", \"NaN\"])\n            continue\n\n        # Generate correlated samples: Z_corr = L * E\n        Z_correlated = L @ E\n\n        # Calculate PCTs for correlated samples\n        pct_correlated = calculate_pct(Z_correlated, T0, c, H)\n        \n        # Compute the 0.95 quantile for the correlated case\n        q_correlated = np.quantile(pct_correlated, q_level, method='linear')\n\n        # Calculate change in quantile and margin\n        delta_Q = q_correlated - q_independent\n        delta_M = -delta_Q\n\n        results.append(f\"{delta_Q:.3f}\")\n        results.append(f\"{delta_M:.3f}\")\n\n    # ====== Final Output ======\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}