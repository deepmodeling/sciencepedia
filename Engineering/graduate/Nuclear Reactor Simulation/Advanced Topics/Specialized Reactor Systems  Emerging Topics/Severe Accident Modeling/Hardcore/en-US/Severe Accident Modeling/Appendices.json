{
    "hands_on_practices": [
        {
            "introduction": "The high-temperature reaction between zirconium fuel cladding and steam is a pivotal event in severe accidents, releasing large amounts of heat and producing flammable hydrogen gas. To predict the rates of these processes, severe accident codes rely on empirical correlations derived from experiments. This practice  provides a direct application of two such famous correlations, Baker-Just and Cathcart-Pawel, allowing you to compute and compare their predictions for hydrogen generation and heat release, and to understand how these models behave as a function of temperature.",
            "id": "4248236",
            "problem": "A heated zirconium alloy cladding segment is exposed to high-temperature steam during a severe accident. Assume the surface is in the breakaway oxidation regime (reaction-limited, negligible diffusion resistance) and that steam partial pressure is sufficiently high that the surface reaction rate is first-order in the available sites and can be represented by an Arrhenius form. The molar zirconium oxidation flux per unit area, denoted $j_{\\mathrm{Zr}}(T)$, is modeled using two widely used empirical correlations: the Baker–Just correlation and the Cathcart–Pawel correlation. The zirconium–steam reaction stoichiometry is\n$$\\mathrm{Zr} + 2\\,\\mathrm{H_2O} \\rightarrow \\mathrm{ZrO_2} + 2\\,\\mathrm{H_2},$$\nand the standard enthalpy change per mole of zirconium oxidized is $-\\Delta H_{\\mathrm{rxn}}$, with $\\Delta H_{\\mathrm{rxn}} = 5.86\\times 10^{5}\\,\\mathrm{J/mol}$. The universal gas constant is $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n\nFor the Baker–Just correlation (BJ), the Arrhenius parameters are\n$$A_{\\mathrm{BJ}} = 1.0\\times 10^{4}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}, \\quad E_{\\mathrm{BJ}} = 1.25\\times 10^{5}\\,\\mathrm{J/mol}.$$\nFor the Cathcart–Pawel correlation (CP), the Arrhenius parameters are\n$$A_{\\mathrm{CP}} = 1.0\\times 10^{5}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}, \\quad E_{\\mathrm{CP}} = 1.50\\times 10^{5}\\,\\mathrm{J/mol}.$$\n\nTasks:\n- Using these correlations, compute at $T_{s} = 1200\\,\\mathrm{K}$ the hydrogen molar generation rate per unit area $r_{\\mathrm{H_2}}(T_{s})$ (in $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$) and the heat release rate per unit area $q''(T_{s})$ (in $\\mathrm{W\\,m^{-2}}$) predicted by each correlation.\n- Across the temperature range $T \\in [1200,1500]\\,\\mathrm{K}$, determine the temperature $T_{\\mathrm{eq}}$ at which the BJ and CP correlations predict the same hydrogen molar generation rate per unit area.\n\nAnswer specification:\n- Report only the equalization temperature $T_{\\mathrm{eq}}$ as your final answer.\n- Express $T_{\\mathrm{eq}}$ in Kelvin (K) and round your answer to four significant figures.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of chemical kinetics and nuclear reactor safety analysis, using well-established empirical correlations. The problem is well-posed, providing all necessary data and definitions for a unique solution. The language is objective and free of ambiguity.\n\nThe molar oxidation flux of zirconium per unit area, $j_{\\mathrm{Zr}}(T)$, is given by the Arrhenius equation:\n$$j_{\\mathrm{Zr}}(T) = A \\exp\\left(-\\frac{E}{RT}\\right)$$\nwhere $A$ is the pre-exponential factor, $E$ is the activation energy, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n\nThe stoichiometry of the zirconium-steam reaction is given as:\n$$\\mathrm{Zr} + 2\\,\\mathrm{H_2O} \\rightarrow \\mathrm{ZrO_2} + 2\\,\\mathrm{H_2}$$\nFrom this stoichiometry, for every mole of zirconium (Zr) that is oxidized, two moles of hydrogen gas ($\\mathrm{H_2}$) are produced. Therefore, the molar generation rate of hydrogen per unit area, $r_{\\mathrm{H_2}}(T)$, is directly proportional to the zirconium oxidation flux:\n$$r_{\\mathrm{H_2}}(T) = 2 j_{\\mathrm{Zr}}(T)$$\nSimilarly, the heat release rate per unit area, $q''(T)$, is the product of the molar oxidation flux and the molar enthalpy of reaction, $\\Delta H_{\\mathrm{rxn}}$:\n$$q''(T) = \\Delta H_{\\mathrm{rxn}} j_{\\mathrm{Zr}}(T)$$\nThe problem provides two different correlations for the zirconium oxidation flux: the Baker–Just (BJ) correlation and the Cathcart–Pawel (CP) correlation. These are characterized by different Arrhenius parameters ($A$ and $E$).\n\nThe primary task is to find the temperature, $T_{\\mathrm{eq}}$, at which the two correlations predict the same hydrogen molar generation rate per unit area. This condition is expressed as:\n$$r_{\\mathrm{H_2, BJ}}(T_{\\mathrm{eq}}) = r_{\\mathrm{H_2, CP}}(T_{\\mathrm{eq}})$$\nUsing the relationship $r_{\\mathrm{H_2}} = 2 j_{\\mathrm{Zr}}$, this equality implies that the zirconium oxidation fluxes must also be equal:\n$$j_{\\mathrm{Zr, BJ}}(T_{\\mathrm{eq}}) = j_{\\mathrm{Zr, CP}}(T_{\\mathrm{eq}})$$\nSubstituting the Arrhenius expression for each correlation, we obtain:\n$$A_{\\mathrm{BJ}} \\exp\\left(-\\frac{E_{\\mathrm{BJ}}}{RT_{\\mathrm{eq}}}\\right) = A_{\\mathrm{CP}} \\exp\\left(-\\frac{E_{\\mathrm{CP}}}{RT_{\\mathrm{eq}}}\\right)$$\nTo solve for $T_{\\mathrm{eq}}$, we can rearrange the terms. We group the pre-exponential factors on one side and the exponential terms on the other:\n$$\\frac{A_{\\mathrm{BJ}}}{A_{\\mathrm{CP}}} = \\frac{\\exp\\left(-\\frac{E_{\\mathrm{CP}}}{RT_{\\mathrm{eq}}}\\right)}{\\exp\\left(-\\frac{E_{\\mathrm{BJ}}}{RT_{\\mathrm{eq}}}\\right)}$$\nUsing the property of exponents $\\exp(a)/\\exp(b) = \\exp(a-b)$, the equation becomes:\n$$\\frac{A_{\\mathrm{BJ}}}{A_{\\mathrm{CP}}} = \\exp\\left(-\\frac{E_{\\mathrm{CP}}}{RT_{\\mathrm{eq}}} + \\frac{E_{\\mathrm{BJ}}}{RT_{\\mathrm{eq}}}\\right) = \\exp\\left(\\frac{E_{\\mathrm{BJ}} - E_{\\mathrm{CP}}}{RT_{\\mathrm{eq}}}\\right)$$\nTaking the natural logarithm of both sides isolates the term containing $T_{\\mathrm{eq}}$:\n$$\\ln\\left(\\frac{A_{\\mathrm{BJ}}}{A_{\\mathrm{CP}}}\\right) = \\frac{E_{\\mathrm{BJ}} - E_{\\mathrm{CP}}}{RT_{\\mathrm{eq}}}$$\nFinally, we solve for $T_{\\mathrm{eq}}$:\n$$T_{\\mathrm{eq}} = \\frac{E_{\\mathrm{BJ}} - E_{\\mathrm{CP}}}{R \\ln\\left(\\frac{A_{\\mathrm{BJ}}}{A_{\\mathrm{CP}}}\\right)}$$\nNow, we substitute the given numerical values into this expression.\nThe parameters are:\n$A_{\\mathrm{BJ}} = 1.0\\times 10^{4}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$\n$E_{\\mathrm{BJ}} = 1.25\\times 10^{5}\\,\\mathrm{J/mol}$\n$A_{\\mathrm{CP}} = 1.0\\times 10^{5}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$\n$E_{\\mathrm{CP}} = 1.50\\times 10^{5}\\,\\mathrm{J/mol}$\n$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\nSubstituting these values:\n$$T_{\\mathrm{eq}} = \\frac{1.25\\times 10^{5}\\,\\mathrm{J/mol} - 1.50\\times 10^{5}\\,\\mathrm{J/mol}}{8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} \\times \\ln\\left(\\frac{1.0\\times 10^{4}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}}{1.0\\times 10^{5}\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}}\\right)}$$\n$$T_{\\mathrm{eq}} = \\frac{-0.25\\times 10^{5}\\,\\mathrm{J/mol}}{8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} \\times \\ln(0.1)}$$\nUsing the identity $\\ln(0.1) = \\ln(10^{-1}) = -\\ln(10)$:\n$$T_{\\mathrm{eq}} = \\frac{-25000}{-8.314 \\times \\ln(10)}\\,\\mathrm{K} = \\frac{25000}{8.314 \\times \\ln(10)}\\,\\mathrm{K}$$\nNow, we compute the numerical value:\n$$T_{\\mathrm{eq}} \\approx \\frac{25000}{8.314 \\times 2.302585}\\,\\mathrm{K} \\approx \\frac{25000}{19.14454}\\,\\mathrm{K} \\approx 1305.854\\,\\mathrm{K}$$\nThe problem states that this temperature should be in the range $[1200, 1500]\\,\\mathrm{K}$. Our calculated value of approximately $1306\\,\\mathrm{K}$ is within this range.\nThe final answer must be rounded to four significant figures.\n$$T_{\\mathrm{eq}} = 1306\\,\\mathrm{K}$$\nTo adhere to the output formatting rules, this will be expressed in scientific notation.",
            "answer": "$$\\boxed{1.306 \\times 10^{3}}$$"
        },
        {
            "introduction": "Beyond individual component physics, severe accident progression is dictated by complex system-level dynamics and feedback loops. During core uncovery, the interplay between decay heat, boiling, and fluid flow can lead to natural circulation instabilities, which may compromise cooling and accelerate damage. This exercise  guides you through a foundational technique in thermal-hydraulic safety analysis: the linear stability analysis of a simplified two-phase natural circulation loop, revealing the conditions that can trigger dangerous flow oscillations.",
            "id": "4248193",
            "problem": "Consider a simplified Natural Circulation Loop (NCL) representative of a light-water reactor during severe accident core uncovery. The loop consists of a heated riser (core) and a cooled downcomer, with a vertical elevation difference $H$ between the centroid of the riser and the downcomer. The working fluid is water at near-saturation conditions, modeled with a homogeneous equilibrium two-phase approximation, and subject to lumped momentum and energy balances. The objective is to analyze the linear stability of the loop under two-phase natural circulation and to assess the conditions under which flow oscillations or dryout occur.\n\nStarting from the fundamental balances:\n- Conservation of momentum for the loop, integrated over the circuit with an effective inertial coefficient, equates the net driving head to friction and inertia.\n- Conservation of energy in the heated riser relates boil-off generation to latent heat and convective removal by the loop flow.\n\nAssume the following state variables:\n- The loop mass flow rate $G$ in $\\mathrm{kg/s}$.\n- The average vapor mass fraction (quality) $x$ in the riser, dimensionless in $[0, 1]$.\n- A transport-lag surrogate $\\theta$ (dimensionless), which approximates the delayed effect of $x$ on the riser mixture density with a first-order lag.\n\nModel the system with the following lumped equations:\n1. Momentum (lumped loop):\n$$ I \\,\\frac{dG}{dt} = g\\,H\\left(\\rho_{d} - \\rho_{\\mathrm{mix}}(\\theta)\\right) - k_f\\,G\\,|G|,$$\nwhere $I$ is an effective inertial coefficient with units $\\mathrm{Pa}\\cdot\\mathrm{s}^2/\\mathrm{kg}$, $g$ is gravitational acceleration in $\\mathrm{m/s}^2$, $H$ is in $\\mathrm{m}$, $\\rho_{d}$ is the downcomer liquid density in $\\mathrm{kg/m}^3$, and $k_f$ is a friction coefficient such that $k_f\\,G\\,|G|$ gives a pressure drop in $\\mathrm{Pa}$.\n\n2. Energy and vapor generation in the riser (lumped control volume of mass $m_r$):\n$$ \\frac{dx}{dt} = \\frac{Q}{h_{fg}\\,m_r} - \\frac{G}{m_r}\\,x, $$\nwhere $Q$ is the core heat addition rate in $\\mathrm{W}$, $h_{fg}$ is the latent heat of vaporization in $\\mathrm{J/kg}$, and $m_r$ is the fluid mass in the riser in $\\mathrm{kg}$.\n\n3. Transport-lag surrogate (first-order lag for delayed density coupling):\n$$ \\frac{d\\theta}{dt} = \\frac{x - \\theta}{\\tau}, $$\nwhere $\\tau$ is the lag time in $\\mathrm{s}$.\n\nUse the homogeneous equilibrium model (HEM) for the riser mixture density:\n$$ \\rho_{\\mathrm{mix}}(x) = \\frac{1}{\\frac{x}{\\rho_v} + \\frac{1-x}{\\rho_l}}, $$\nwith $\\rho_l$ the saturated liquid density and $\\rho_v$ the saturated vapor density, both in $\\mathrm{kg/m}^3$.\n\nLet the steady state be defined by constant values $\\left(G_0, x_0, \\theta_0\\right)$ such that:\n$$ \\begin{aligned}\n& g\\,H\\left(\\rho_{d} - \\rho_{\\mathrm{mix}}(x_0)\\right) - k_f\\,G_0\\,|G_0| = 0, \\\\\n& \\frac{Q}{h_{fg}\\,m_r} - \\frac{G_0}{m_r}\\,x_0 = 0, \\\\\n& \\theta_0 = x_0.\n\\end{aligned} $$\nAssume $\\rho_d = \\rho_l$.\n\nPerform linear perturbation analysis around the steady state, defining small deviations $\\delta G$, $\\delta x$, and $\\delta \\theta$. Derive the linearized system in the form:\n$$ \\frac{d}{dt}\\begin{bmatrix}\\delta G \\\\ \\delta x \\\\ \\delta \\theta\\end{bmatrix} = \\mathbf{A}\\,\\begin{bmatrix}\\delta G \\\\ \\delta x \\\\ \\delta \\theta\\end{bmatrix}, $$\nwith the Jacobian matrix $\\mathbf{A}$ constructed from first principles based on the governing equations and the constitutive relation for $\\rho_{\\mathrm{mix}}(x)$. Use the derivative\n$$ \\left.\\frac{\\partial \\rho_{\\mathrm{mix}}}{\\partial x}\\right|_{x_0} = -\\left(\\frac{1}{\\rho_v} - \\frac{1}{\\rho_l}\\right)\\,\\rho_{\\mathrm{mix}}(x_0)^2. $$\n\nDefine the conditions to be checked for each parameter set:\n- Flow oscillations: presence of complex conjugate eigenvalues of $\\mathbf{A}$ (nonzero imaginary parts).\n- Instability: any eigenvalue of $\\mathbf{A}$ with strictly positive real part.\n- Dryout: the steady-state void fraction $\\alpha_0$ computed from $x_0$ via\n$$ \\alpha_0 = \\frac{\\frac{x_0}{\\rho_v}}{\\frac{x_0}{\\rho_v} + \\frac{1-x_0}{\\rho_l}} $$\nexceeds a specified critical threshold $\\alpha_{\\mathrm{crit}}$ (dimensionless), or equivalently $x_0 \\ge 1$ indicating complete vaporization.\n\nYour program must:\n1. Solve for the steady-state $G_0$ (in $\\mathrm{kg/s}$) using the steady momentum balance and the relation $x_0 = \\frac{Q}{h_{fg}\\,G_0}$.\n2. Construct $\\mathbf{A}$ from the linearized equations at the steady state.\n3. Compute its eigenvalues and deduce whether oscillations and instability are present.\n4. Compute $\\alpha_0$ and determine whether dryout occurs based on $\\alpha_{\\mathrm{crit}}$.\n\nExpress all physical quantities in International System of Units (SI) and ensure numerical stability by clipping $x_0$ used within $\\rho_{\\mathrm{mix}}$ to the open interval $(0,1)$ for constitutive calculations, while still using the unclipped $x_0$ for dryout determination.\n\nTest Suite:\nProvide the following parameter sets as input to your program internally. Each test case is a tuple with components $\\left(\\rho_l,\\rho_v,h_{fg},g,H,m_r,k_f,I,Q,\\tau,\\alpha_{\\mathrm{crit}}\\right)$:\n\n- Case $1$ (baseline stable, non-oscillatory): $\\left(950,4,2.3\\times 10^6,9.81,10,800,2.5,1.0\\times 10^5,50\\times 10^6,1.0,0.95\\right)$.\n- Case $2$ (high lag, low friction; likely oscillatory and potentially unstable): $\\left(950,4,2.0\\times 10^6,9.81,12,600,1.0,5.0\\times 10^4,180\\times 10^6,10.0,0.95\\right)$.\n- Case $3$ (high power; dryout expected): $\\left(900,6,1.8\\times 10^6,9.81,8,700,2.0,8.0\\times 10^4,380\\times 10^6,3.0,0.95\\right)$.\n- Case $4$ (near boundary; possible damped oscillations): $\\left(970,3.5,2.2\\times 10^6,9.81,11,900,2.2,9.0\\times 10^4,200\\times 10^6,4.0,0.95\\right)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output a list of three booleans in the order $\\left[\\text{unstable},\\text{oscillatory},\\text{dryout}\\right]$. For example:\n$$ [ [\\mathrm{False},\\mathrm{False},\\mathrm{False}], [\\mathrm{True},\\mathrm{True},\\mathrm{False}], [\\mathrm{False},\\mathrm{False},\\mathrm{True}], [\\mathrm{False},\\mathrm{True},\\mathrm{False}] ]. $$",
            "solution": "We begin from fundamental principles, applying conservation of momentum and energy to a lumped Natural Circulation Loop (NCL) with two-phase flow in the riser. The heated riser experiences a buoyancy head due to the density difference between the downcomer liquid and the two-phase mixture in the riser. Friction opposes motion, and the inertia of the loop fluid causes the mass flow rate to adjust dynamically.\n\nMomentum balance: Integrating the one-dimensional momentum equation over the loop yields a lumped form where the net driving pressure is the difference between the hydrostatic head and the frictional losses, and the rate of change of mass flow rate is proportional to the net pressure divided by an effective inertia. We define\n$$ I\\,\\frac{dG}{dt} = g\\,H\\left(\\rho_d - \\rho_{\\mathrm{mix}}(\\theta)\\right) - k_f\\,G\\,|G|, $$\nwith $I$ aggregating fluid inertia and geometric factors into units $\\mathrm{Pa\\cdot s^2/kg}$; this maps $\\frac{dG}{dt}$ with units $\\mathrm{kg/s^2}$ to a pressure-like quantity. The hydrostatic term $g\\,H\\left(\\rho_d - \\rho_{\\mathrm{mix}}\\right)$ is a well-tested buoyancy head expression, and $k_f\\,G\\,|G|$ is a standard turbulent friction scaling such that the pressure drop grows quadratically with mass flow rate.\n\nEnergy balance: In the heated riser, vapor generation is governed by latent heat and convective removal. A lumped control volume of riser mass $m_r$ obeys\n$$ \\frac{dx}{dt} = \\frac{Q}{h_{fg}\\,m_r} - \\frac{G}{m_r}\\,x, $$\nwhere $x$ is the mass fraction of vapor, $Q$ is power input, and $h_{fg}$ is latent heat. This relation is derived by equating the vapor mass generation rate $Q/h_{fg}$ to the change of vapor mass within the riser and the convective outflow $G\\,x$.\n\nTransport lag surrogate: Real density-wave instabilities are driven by transport delays along the riser; to capture the phase lag without solving partial differential equations, we introduce a first-order lag variable $\\theta$ that follows\n$$ \\frac{d\\theta}{dt} = \\frac{x - \\theta}{\\tau}, $$\nwith lag time $\\tau$ approximating the transit time of voids along the riser. The buoyancy head depends on $\\rho_{\\mathrm{mix}}(\\theta)$, modeling that the density influencing momentum responds to a delayed state of the void distribution.\n\nTwo-phase mixture density: Under the Homogeneous Equilibrium Model (HEM), the mixture density is\n$$ \\rho_{\\mathrm{mix}}(x) = \\left(\\frac{x}{\\rho_v} + \\frac{1-x}{\\rho_l}\\right)^{-1}, $$\nwhere $\\rho_l$ and $\\rho_v$ are saturated liquid and vapor densities. This is consistent with volume additivity assuming equal phase velocities. The derivative needed for linearization is\n$$ \\left.\\frac{\\partial \\rho_{\\mathrm{mix}}}{\\partial x}\\right|_{x_0} = -\\left(\\frac{1}{\\rho_v} - \\frac{1}{\\rho_l}\\right)\\,\\rho_{\\mathrm{mix}}(x_0)^2, $$\nobtained by differentiating $f(x)=\\frac{x}{\\rho_v}+\\frac{1-x}{\\rho_l}$ and using $\\rho_{\\mathrm{mix}}=1/f$.\n\nSteady state: At steady conditions, \n$$ \\begin{aligned}\n& 0 = g\\,H\\left(\\rho_d - \\rho_{\\mathrm{mix}}(x_0)\\right) - k_f\\,G_0\\,|G_0|, \\\\\n& 0 = \\frac{Q}{h_{fg}\\,m_r} - \\frac{G_0}{m_r}\\,x_0 \\quad\\Rightarrow\\quad x_0 = \\frac{Q}{h_{fg}\\,G_0}, \\\\\n& \\theta_0 = x_0.\n\\end{aligned} $$\nWe solve the nonlinear scalar equation for $G_0$ numerically: define $F(G)=g\\,H\\left(\\rho_d - \\rho_{\\mathrm{mix}}\\bigl(x(G)\\bigr)\\right) - k_f\\,G^2$ with $x(G)=\\frac{Q}{h_{fg}\\,G}$, find $G_0 > 0$ such that $F(G_0)=0$. For $\\rho_d=\\rho_l$, $F(G)$ is positive for small $G$ (buoyancy dominates) and negative for large $G$ (friction dominates), so a positive root exists and can be bracketed. For constitutive evaluations of $\\rho_{\\text{mix}}$ we clip $x$ away from exact $0$ or $1$ to avoid singularities, while keeping the original $x_0$ for dryout assessment.\n\nLinearization: We define small perturbations $\\delta G=G-G_0$, $\\delta x=x-x_0$, and $\\delta \\theta=\\theta-\\theta_0$. Linearizing around the steady state yields\n$$ \\frac{d}{dt}\\begin{bmatrix}\\delta G \\\\ \\delta x \\\\ \\delta \\theta\\end{bmatrix} = \\mathbf{A}\n\\begin{bmatrix}\\delta G \\\\ \\delta x \\\\ \\delta \\theta\\end{bmatrix}, $$\nwith Jacobian matrix $\\mathbf{A}$ entries computed from the governing equations:\n- From the momentum equation,\n$$ \\frac{d\\,\\delta G}{dt} = -\\frac{2\\,k_f\\,|G_0|}{I}\\,\\delta G - \\frac{g\\,H}{I}\\left.\\frac{\\partial \\rho_{\\mathrm{mix}}}{\\partial x}\\right|_{x_0}\\,\\delta\\theta, $$\nsince the density coupling uses $\\theta$ and $\\frac{d}{dG}(G\\,|G|)\\big|_{G_0}=2\\,|G_0|$.\nTherefore,\n$$ A_{11} = -\\frac{2\\,k_f\\,|G_0|}{I}, \\quad A_{13} = -\\frac{g\\,H}{I}\\left.\\frac{\\partial \\rho_{\\mathrm{mix}}}{\\partial x}\\right|_{x_0}, \\quad A_{12} = 0. $$\n\n- From the riser energy balance,\n$$ \\frac{d\\,\\delta x}{dt} = -\\frac{x_0}{m_r}\\,\\delta G - \\frac{G_0}{m_r}\\,\\delta x, $$\nso\n$$ A_{21} = -\\frac{x_0}{m_r}, \\quad A_{22} = -\\frac{G_0}{m_r}, \\quad A_{23} = 0. $$\n\n- From the lag equation,\n$$ \\frac{d\\,\\delta \\theta}{dt} = \\frac{1}{\\tau}\\,\\delta x - \\frac{1}{\\tau}\\,\\delta \\theta, $$\nso\n$$ A_{31} = 0, \\quad A_{32} = \\frac{1}{\\tau}, \\quad A_{33} = -\\frac{1}{\\tau}. $$\n\nEigenvalue analysis: The eigenvalues $\\lambda$ of $\\mathbf{A}$ determine local linear stability and dynamic character. If any eigenvalue has $\\Re(\\lambda)>0$, the steady state is linearly unstable (growth of perturbations). If the eigenvalues include a complex conjugate pair (nonzero imaginary parts), the system exhibits oscillatory behavior; if $\\Re(\\lambda)<0$ for the pair, oscillations are damped, and if $\\Re(\\lambda)>0$ they grow (unstable oscillations).\n\nDryout criterion: Compute the steady-state mass quality $x_0=\\frac{Q}{h_{fg}\\,G_0}$. The corresponding void fraction is\n$$ \\alpha_0 = \\frac{\\frac{x_0}{\\rho_v}}{\\frac{x_0}{\\rho_v} + \\frac{1-x_0}{\\rho_l}}. $$\nDryout is deemed to occur if $\\alpha_0 \\ge \\alpha_{\\mathrm{crit}}$ or $x_0 \\ge 1$.\n\nAlgorithmic procedure:\n- For each parameter set $\\left(\\rho_l,\\rho_v,h_{fg},g,H,m_r,k_f,I,Q,\\tau,\\alpha_{\\mathrm{crit}}\\right)$, numerically solve for $G_0$ by root bracketing and bisection or a robust scalar root finder, using the function $F(G)$ defined above and a wide bracket $[G_{\\min},G_{\\max}]$ with $G_{\\min}>0$ small and $G_{\\max}$ large to ensure sign change.\n- Compute $x_0=\\frac{Q}{h_{fg}\\,G_0}$ and $\\rho_{\\mathrm{mix}}(x_0)$; for constitutive derivatives, clip $x_0$ to $(0,1)$ and use\n$$ \\left.\\frac{\\partial \\rho_{\\mathrm{mix}}}{\\partial x}\\right|_{x_0} = -\\left(\\frac{1}{\\rho_v} - \\frac{1}{\\rho_l}\\right)\\,\\rho_{\\mathrm{mix}}(x_0)^2. $$\n- Assemble $\\mathbf{A}$ and compute its eigenvalues.\n- Determine booleans: unstable if any eigenvalue has positive real part, oscillatory if any eigenvalue has nonzero imaginary part, and dryout if $\\alpha_0 \\ge \\alpha_{\\mathrm{crit}}$ or $x_0 \\ge 1$.\n- Aggregate the results for all test cases as a list of lists in the order $\\left[\\text{unstable},\\text{oscillatory},\\text{dryout}\\right]$ and print them as a single bracketed, comma-separated line.\n\nScientific realism: The model employs the Homogeneous Equilibrium Model (HEM), which is a widely used baseline in severe accident analysis for lumped simulations. The friction scaling $k_f\\,G\\,|G|$ represents turbulent pressure losses, and the buoyancy head $g\\,H\\,\\Delta\\rho$ is a standard driving mechanism for natural circulation. The lag $\\tau$ introduces phase delay essential to density-wave oscillation modeling. Parameter magnitudes are chosen to be plausible for light-water systems under depressurized conditions. Although simplified, the formulation is internally consistent and suitable for linear stability analysis to classify oscillatory and dryout tendencies in the specified test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef rho_mix(x, rho_l, rho_v):\n    \"\"\"\n    Homogeneous equilibrium mixture density.\n    x is mass quality; to avoid singularities, clip x strictly between 0 and 1 for constitutive use.\n    \"\"\"\n    x_clip = np.clip(x, 1e-9, 1 - 1e-9)\n    return 1.0 / (x_clip / rho_v + (1.0 - x_clip) / rho_l)\n\ndef drho_mix_dx(x, rho_l, rho_v):\n    \"\"\"\n    Derivative of HEM mixture density with respect to quality x at x.\n    Uses clipped x for constitutive calculation.\n    d rho / dx = - (1/rho_v - 1/rho_l) * rho_mix^2\n    \"\"\"\n    rm = rho_mix(x, rho_l, rho_v)\n    return - (1.0 / rho_v - 1.0 / rho_l) * (rm ** 2)\n\ndef alpha_from_x(x, rho_l, rho_v):\n    \"\"\"\n    Void fraction alpha computed from quality x under HEM:\n    alpha = (x/rho_v) / (x/rho_v + (1-x)/rho_l)\n    Use unclipped x, but guard against zero division.\n    \"\"\"\n    denom = (x / rho_v) + ((1.0 - x) / rho_l)\n    if denom <= 0.0:\n        return 0.0\n    return (x / rho_v) / denom\n\ndef solve_steady_G(params):\n    \"\"\"\n    Solve for steady-state mass flow rate G0 using momentum balance:\n    g*H*(rho_d - rho_mix(x0)) - k_f*G0^2 = 0, with x0 = Q / (h_fg * G0).\n    rho_d = rho_l.\n    \"\"\"\n    rho_l, rho_v, h_fg, g, H, m_r, k_f, I, Q, tau, alpha_crit = params\n\n    def F(G):\n        if G <= 0.0:\n            return g * H * (rho_l - rho_mix(1.0, rho_l, rho_v))  # large buoyancy if G->0\n        x0 = Q / (h_fg * G)\n        rm = rho_mix(x0, rho_l, rho_v)\n        return g * H * (rho_l - rm) - k_f * G * abs(G)\n\n    # Bracket the root: at very small G, F(G) > 0; at large G, friction dominates => F(G) < 0\n    G_lo = 1e-6\n    G_hi = 1e4  # large upper bound to ensure friction dominance\n    # Ensure sign change for robustness by expanding hi if needed\n    F_lo = F(G_lo)\n    F_hi = F(G_hi)\n    # If both same sign, try increasing G_hi\n    tries = 0\n    while F_lo * F_hi > 0 and tries < 5:\n        G_hi *= 10.0\n        F_hi = F(G_hi)\n        tries += 1\n\n    sol = root_scalar(F, bracket=(G_lo, G_hi), method='bisect', xtol=1e-10, rtol=1e-10, maxiter=1000)\n    if not sol.converged:\n        # As a fallback, try a different bracket or use secant from two guesses\n        sol = root_scalar(F, x0=1.0, x1=1000.0, method='secant', maxiter=1000)\n        if not sol.converged:\n            raise RuntimeError(\"Steady-state G solve did not converge.\")\n\n    return sol.root\n\ndef build_jacobian(params, G0):\n    \"\"\"\n    Build the 3x3 Jacobian matrix A at steady state.\n    \"\"\"\n    rho_l, rho_v, h_fg, g, H, m_r, k_f, I, Q, tau, alpha_crit = params\n    x0 = Q / (h_fg * G0)\n    # Derivative of mixture density at steady state (use clipped x for constitutive derivative)\n    drmdx = drho_mix_dx(x0, rho_l, rho_v)\n    # Assemble A\n    A11 = - (2.0 * k_f * abs(G0)) / I\n    A12 = 0.0\n    A13 = - (g * H * drmdx) / I\n\n    A21 = - x0 / m_r\n    A22 = - G0 / m_r\n    A23 = 0.0\n\n    A31 = 0.0\n    A32 = 1.0 / tau\n    A33 = - 1.0 / tau\n\n    A = np.array([[A11, A12, A13],\n                  [A21, A22, A23],\n                  [A31, A32, A33]], dtype=float)\n    return A, x0\n\ndef analyze_case(params):\n    \"\"\"\n    For one parameter set, compute:\n    - steady-state G0\n    - Jacobian eigenvalues\n    - booleans [unstable, oscillatory, dryout]\n    \"\"\"\n    rho_l, rho_v, h_fg, g, H, m_r, k_f, I, Q, tau, alpha_crit = params\n    G0 = solve_steady_G(params)\n    A, x0 = build_jacobian(params, G0)\n    eigvals = np.linalg.eigvals(A)\n\n    # Determine instability and oscillation\n    unstable = np.any(np.real(eigvals) > 0.0)\n    oscillatory = np.any(np.abs(np.imag(eigvals)) > 1e-12)\n\n    # Dryout check: use x0 directly and void fraction alpha0\n    alpha0 = alpha_from_x(x0, rho_l, rho_v)\n    dryout = (alpha0 >= alpha_crit) or (x0 >= 1.0)\n\n    return [bool(unstable), bool(oscillatory), bool(dryout)]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (rho_l, rho_v, h_fg, g, H, m_r, k_f, I, Q, tau, alpha_crit)\n    test_cases = [\n        (950.0, 4.0, 2.3e6, 9.81, 10.0, 800.0, 2.5, 1.0e5, 50.0e6, 1.0, 0.95),\n        (950.0, 4.0, 2.0e6, 9.81, 12.0, 600.0, 1.0, 5.0e4, 180.0e6, 10.0, 0.95),\n        (900.0, 6.0, 1.8e6, 9.81, 8.0, 700.0, 2.0, 8.0e4, 380.0e6, 3.0, 0.95),\n        (970.0, 3.5, 2.2e6, 9.81, 11.0, 900.0, 2.2, 9.0e4, 200.0e6, 4.0, 0.95),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_case(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(str(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Accurate simulation of late-stage severe accidents, such as the interaction of molten corium with the concrete basemat (MCCI), is challenged by model uncertainties and sparse experimental data. Modern safety analysis increasingly employs probabilistic methods to address this. This advanced practice  introduces Bayesian inference as a rigorous framework for calibrating the parameters of an MCCI ablation rate model against experimental measurements, providing not only best-estimate parameters but also a principled quantification of their posterior uncertainty.",
            "id": "4248254",
            "problem": "Consider Molten Core-Concrete Interaction (MCCI), where the erosion (ablation) rate at the corium-concrete interface is influenced by the interfacial heat flux and the thermochemical kinetics of the reacting system. Use a probabilistic framework to calibrate an ablation-rate model against experimental erosion data under severe accident conditions. Begin from physically grounded principles: the reaction kinetics often follow an exponential temperature dependence consistent with Arrhenius behavior, and energy transfer at the interface is driven by heat flux. Assume the measurable ablation rate is strictly positive and that experimental reporting provides rate values and associated uncertainty that can be treated as additive noise in the logarithmic domain. Formulate a Bayesian calibration problem for the kinetic parameters of a log-linearized model derived from these bases. Derive the posterior distribution for the kinetic parameters using a Gaussian prior and Gaussian likelihood with heteroscedastic measurement variances, and implement the resulting formulas in a program.\n\nDefinitions and assumptions:\n- Molten Core-Concrete Interaction (MCCI) denotes corium-concrete chemical and thermal erosion under severe accident conditions.\n- Let the ablation rate be $v$ in $\\mathrm{m/s}$, the interfacial heat-flux ratio be $q_r = q/q_{\\mathrm{ref}}$ (dimensionless), where $q$ is the interfacial heat flux and $q_{\\mathrm{ref}}$ is a fixed reference heat flux, and the corium bulk temperature be $T$ in $\\mathrm{K}$.\n- Universal gas constant is $R = 8.314 \\, \\mathrm{J}/(\\mathrm{mol}\\cdot\\mathrm{K})$.\n- The kinetic parameter vector is $\\boldsymbol{\\theta} = [\\ln A, \\, a, \\, E]^{\\top}$, where $A$ has units of $\\mathrm{m/s}$, $a$ is dimensionless, and $E$ is the activation energy in $\\mathrm{J/mol}$.\n- After appropriate non-dimensionalization and logarithmic transformation justified by the fundamental bases, the model for the observed log-rate $y_i = \\ln v_i$ at experimental condition $i$ is linear in $\\boldsymbol{\\theta}$ with additive Gaussian error: $y_i = \\mathbf{x}_i^{\\top}\\boldsymbol{\\theta} + \\varepsilon_i$, where $\\mathbf{x}_i = [1, \\, \\ln q_{r,i}, \\, -1/(R T_i)]^{\\top}$ and $\\varepsilon_i \\sim \\mathcal{N}(0, s_i^2)$ are independent across $i$ with known $s_i$.\n- The prior for $\\boldsymbol{\\theta}$ is Gaussian: $\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0, \\mathbf{\\Sigma}_0)$.\n\nYour tasks:\n1. Starting from the stated bases (Arrhenius temperature dependence for reaction kinetics and heat-flux influence), justify the log-linear form of the model relating $y_i$ to $q_{r,i}$ and $T_i$ and define the design matrix $\\mathbf{X}$ and the observation vector $\\mathbf{y}$ for $N$ experiments.\n2. Using Bayes’ rule with a Gaussian prior and Gaussian likelihood with diagonal noise covariance $\\mathbf{S} = \\mathrm{diag}(s_1^2, \\dots, s_N^2)$, derive the posterior distribution $\\boldsymbol{\\theta} \\mid \\mathbf{y} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_n, \\mathbf{\\Sigma}_n)$, expressing $\\boldsymbol{\\mu}_n$ and $\\mathbf{\\Sigma}_n$ explicitly in terms of $\\mathbf{X}$, $\\mathbf{y}$, $\\mathbf{S}$, $\\boldsymbol{\\mu}_0$, and $\\mathbf{\\Sigma}_0$.\n3. Implement the derived posterior formulas to compute, for each test case, the posterior mean and variance of each component of $\\boldsymbol{\\theta}$. Report the posterior mean and variance for $E$ in $\\mathrm{kJ/mol}$ units, that is, convert the mean from $\\mathrm{J/mol}$ to $\\mathrm{kJ/mol}$ and the variance from $(\\mathrm{J/mol})^2$ to $(\\mathrm{kJ/mol})^2$ by dividing by $1000$ and $1000^2$, respectively.\n\nPrior specification:\n- Prior mean $\\boldsymbol{\\mu}_0 = [\\mu_{\\ln A}, \\, \\mu_a, \\, \\mu_E]^{\\top} = [ -10.0, \\, 0.7, \\, 150000.0 ]$.\n- Prior covariance $\\mathbf{\\Sigma}_0 = \\mathrm{diag}([\\sigma_{\\ln A}^2, \\, \\sigma_a^2, \\, \\sigma_E^2]) = \\mathrm{diag}([ 0.25, \\, 0.16, \\, (70000.0)^2 ])$.\n\nTest suite:\nFor each test case, you are given the experimental arrays $(q_{r,i})_{i=1}^N$, $(T_i)_{i=1}^N$, $(v_i)_{i=1}^N$, and $(s_i)_{i=1}^N$. Treat $s_i$ as the standard deviation of the additive Gaussian noise in the log-domain $y_i = \\ln v_i$.\n\n- Test case $1$ (general, well-conditioned):\n  - $q_{r} = [ \\, 1.5, \\, 2.0, \\, 2.5, \\, 3.0, \\, 3.5, \\, 4.0 \\, ]$ (dimensionless).\n  - $T = [ \\, 2100.0, \\, 2000.0, \\, 1950.0, \\, 2000.0, \\, 1900.0, \\, 1850.0 \\, ]$ in $\\mathrm{K}$.\n  - $v = [ \\, 4.46\\times 10^{-5}, \\, 4.53\\times 10^{-5}, \\, 4.90\\times 10^{-5}, \\, 6.54\\times 10^{-5}, \\, 5.86\\times 10^{-5}, \\, 5.78\\times 10^{-5} \\, ]$ in $\\mathrm{m/s}$.\n  - $s = [ \\, 0.08, \\, 0.08, \\, 0.08, \\, 0.08, \\, 0.08, \\, 0.08 \\, ]$ (dimensionless in log-domain).\n- Test case $2$ (boundary, sparse data with higher uncertainty):\n  - $q_{r} = [ \\, 1.0, \\, 4.0 \\, ]$ (dimensionless).\n  - $T = [ \\, 2000.0, \\, 1850.0 \\, ]$ in $\\mathrm{K}$.\n  - $v = [ \\, 2.43\\times 10^{-5}, \\, 5.78\\times 10^{-5} \\, ]$ in $\\mathrm{m/s}$.\n  - $s = [ \\, 0.20, \\, 0.20 \\, ]$ (dimensionless in log-domain).\n- Test case $3$ (heteroscedastic errors, mixed conditions):\n  - $q_{r} = [ \\, 2.0, \\, 3.5, \\, 4.0, \\, 1.8 \\, ]$ (dimensionless).\n  - $T = [ \\, 2100.0, \\, 1900.0, \\, 1850.0, \\, 2000.0 \\, ]$ in $\\mathrm{K}$.\n  - $v = [ \\, 5.76\\times 10^{-5}, \\, 5.86\\times 10^{-5}, \\, 5.78\\times 10^{-5}, \\, 4.22\\times 10^{-5} \\, ]$ in $\\mathrm{m/s}$.\n  - $s = [ \\, 0.05, \\, 0.12, \\, 0.20, \\, 0.05 \\, ]$ (dimensionless in log-domain).\n\nRequired final output:\n- For each test case, compute the posterior mean vector $\\boldsymbol{\\mu}_n$ and posterior covariance matrix $\\mathbf{\\Sigma}_n$ of $\\boldsymbol{\\theta}$.\n- Extract the posterior means $(\\mu_{\\ln A}, \\, \\mu_a, \\, \\mu_E)$ and posterior variances $(\\sigma_{\\ln A}^2, \\, \\sigma_a^2, \\, \\sigma_E^2)$ from $\\boldsymbol{\\mu}_n$ and the diagonal of $\\mathbf{\\Sigma}_n$.\n- Convert the activation energy results to $\\mathrm{kJ/mol}$ by reporting $\\mu_E/1000$ and $\\sigma_E^2/10^6$.\n- Your program should produce a single line of output containing a comma-separated list of results for all test cases, in the format:\n  \"$[ [\\mu_{\\ln A,1},\\mu_{a,1},\\mu_{E,1}^{\\mathrm{kJ/mol}},\\sigma_{\\ln A,1}^2,\\sigma_{a,1}^2,\\sigma_{E,1}^{2,\\mathrm{kJ^2/mol^2}}], [\\mu_{\\ln A,2},\\mu_{a,2},\\mu_{E,2}^{\\mathrm{kJ/mol}},\\sigma_{\\ln A,2}^2,\\sigma_{a,2}^2,\\sigma_{E,2}^{2,\\mathrm{kJ^2/mol^2}}], [\\mu_{\\ln A,3},\\mu_{a,3},\\mu_{E,3}^{\\mathrm{kJ/mol}},\\sigma_{\\ln A,3}^2,\\sigma_{a,3}^2,\\sigma_{E,3}^{2,\\mathrm{kJ^2/mol^2}}] ]$\".\nEnsure the printed floats are in decimal form and the activation energy values and variances are expressed in $\\mathrm{kJ/mol}$ and $(\\mathrm{kJ/mol})^2$, respectively.",
            "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded in the principles of chemical kinetics and heat transfer, mathematically well-posed as a Bayesian linear regression problem, and objectively specified with all necessary data and no ambiguities.\n\nThe solution proceeds in three parts as requested: first, the justification of the log-linear model form; second, the derivation of the posterior distribution for the model parameters; and third, the implementation of the derived formulas to solve the given test cases, which is detailed in the final program.\n\n### Task 1: Model Justification and Matrix Definitions\n\nThe problem concerns the ablation rate, $v$, at the interface between molten corium and concrete during a severe nuclear reactor accident. This rate is governed by complex thermochemical phenomena. A physically-grounded semi-empirical model can be constructed by considering the primary driving forces.\n\n$1$. **Temperature Dependence**: The reaction kinetics at the interface are strongly dependent on temperature, $T$. This dependence is commonly modeled using the Arrhenius equation, which posits an exponential relationship:\n$$ v \\propto \\exp\\left(-\\frac{E}{RT}\\right) $$\nwhere $E$ is the activation energy in $\\text{J}/\\text{mol}$, and $R$ is the universal gas constant, $8.314 \\, \\text{J}/(\\text{mol}\\cdot\\text{K})$.\n\n$2$. **Heat Flux Dependence**: The energy required to sustain the endothermic ablation process is supplied by the heat flux, $q$, from the corium. It is reasonable to model the ablation rate's dependence on heat flux as a power law of the dimensionless heat flux ratio, $q_r = q/q_{\\mathrm{ref}}$:\n$$ v \\propto q_r^a $$\nwhere $a$ is a dimensionless exponent that quantifies the sensitivity of the ablation rate to changes in heat flux.\n\nCombining these two dependencies with a proportionality constant, $A$ (the pre-exponential factor, with units of $\\text{m}/\\text{s}$), we arrive at the following model for the ablation rate:\n$$ v = A \\, q_r^a \\, \\exp\\left(-\\frac{E}{RT}\\right) $$\nThe problem states that experimental uncertainty is best modeled as additive Gaussian noise in the logarithmic domain. This motivates a log-transformation of the model equation. Taking the natural logarithm of both sides linearizes the model with respect to its parameters:\n$$ \\ln(v) = \\ln\\left(A \\, q_r^a \\, \\exp\\left(-\\frac{E}{RT}\\right)\\right) $$\n$$ \\ln(v) = \\ln(A) + \\ln(q_r^a) + \\ln\\left(\\exp\\left(-\\frac{E}{RT}\\right)\\right) $$\n$$ \\ln(v) = \\ln(A) + a \\ln(q_r) - \\frac{E}{RT} $$\nThis equation is linear in the parameters $\\ln(A)$, $a$, and $E$. Let us define the log-rate observation for the $i$-th experiment as $y_i = \\ln(v_i)$. We also define the parameter vector $\\boldsymbol{\\theta}$ and the design vector $\\mathbf{x}_i$ for the $i$-th experiment as specified:\n$$ \\boldsymbol{\\theta} = \\begin{pmatrix} \\ln A \\\\ a \\\\ E \\end{pmatrix}, \\quad \\mathbf{x}_i = \\begin{pmatrix} 1 \\\\ \\ln q_{r,i} \\\\ -1/(R T_i) \\end{pmatrix} $$\nWith these definitions, the model for a single observation becomes:\n$$ y_i = [1, \\, \\ln q_{r,i}, \\, -1/(RT_i)] \\begin{pmatrix} \\ln A \\\\ a \\\\ E \\end{pmatrix} = \\mathbf{x}_i^{\\top}\\boldsymbol{\\theta} $$\nThe problem further specifies that the observed log-rate $y_i$ includes independent, additive Gaussian noise $\\varepsilon_i \\sim \\mathcal{N}(0, s_i^2)$. Thus, the full probabilistic model for a single observation is:\n$$ y_i = \\mathbf{x}_i^{\\top}\\boldsymbol{\\theta} + \\varepsilon_i $$\nFor a set of $N$ experimental observations, we can express the model in matrix form. Let $\\mathbf{y}$ be the vector of $N$ observations, $\\mathbf{X}$ be the $N \\times 3$ design matrix, and $\\boldsymbol{\\varepsilon}$ be the vector of noise terms.\n$$ \\mathbf{y} = \\begin{pmatrix} y_1 \\\\ y_2 \\\\ \\vdots \\\\ y_N \\end{pmatrix} = \\begin{pmatrix} \\ln v_1 \\\\ \\ln v_2 \\\\ \\vdots \\\\ \\ln v_N \\end{pmatrix} $$\n$$ \\mathbf{X} = \\begin{pmatrix} \\mathbf{x}_1^{\\top} \\\\ \\mathbf{x}_2^{\\top} \\\\ \\vdots \\\\ \\mathbf{x}_N^{\\top} \\end{pmatrix} = \\begin{pmatrix} 1 & \\ln q_{r,1} & -1/(RT_1) \\\\ 1 & \\ln q_{r,2} & -1/(RT_2) \\\\ \\vdots & \\vdots & \\vdots \\\\ 1 & \\ln q_{r,N} & -1/(RT_N) \\end{pmatrix} $$\nThe full model for $N$ observations is $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}$, where $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{S})$ and $\\mathbf{S} = \\mathrm{diag}(s_1^2, s_2^2, \\dots, s_N^2)$.\n\n### Task 2: Derivation of the Posterior Distribution\n\nWe aim to find the posterior distribution of the parameter vector $\\boldsymbol{\\theta}$ given the observation vector $\\mathbf{y}$, denoted $p(\\boldsymbol{\\theta} | \\mathbf{y})$. According to Bayes' rule, the posterior is proportional to the product of the likelihood and the prior:\n$$ p(\\boldsymbol{\\theta} | \\mathbf{y}) \\propto p(\\mathbf{y} | \\boldsymbol{\\theta}) \\, p(\\boldsymbol{\\theta}) $$\nThe problem specifies a Gaussian prior for $\\boldsymbol{\\theta}$ and a Gaussian likelihood for the data.\n\n**Prior**: The prior belief about $\\boldsymbol{\\theta}$ is described by a multivariate Gaussian distribution with mean $\\boldsymbol{\\mu}_0$ and covariance $\\mathbf{\\Sigma}_0$:\n$$ p(\\boldsymbol{\\theta}) = \\mathcal{N}(\\boldsymbol{\\theta} | \\boldsymbol{\\mu}_0, \\mathbf{\\Sigma}_0) \\propto \\exp\\left(-\\frac{1}{2}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)^{\\top}\\mathbf{\\Sigma}_0^{-1}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)\\right) $$\n\n**Likelihood**: The likelihood of observing the data $\\mathbf{y}$ given a specific parameter vector $\\boldsymbol{\\theta}$ follows from the model $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}$. Since $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{S})$, the distribution of $\\mathbf{y}$ conditional on $\\boldsymbol{\\theta}$ is also Gaussian:\n$$ p(\\mathbf{y} | \\boldsymbol{\\theta}) = \\mathcal{N}(\\mathbf{y} | \\mathbf{X}\\boldsymbol{\\theta}, \\mathbf{S}) \\propto \\exp\\left(-\\frac{1}{2}(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})^{\\top}\\mathbf{S}^{-1}(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})\\right) $$\n\n**Posterior**: To find the posterior distribution, we examine the logarithm of the posterior probability density, ignoring constant terms:\n$$ \\ln p(\\boldsymbol{\\theta} | \\mathbf{y}) = -\\frac{1}{2}(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})^{\\top}\\mathbf{S}^{-1}(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta}) - \\frac{1}{2}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)^{\\top}\\mathbf{\\Sigma}_0^{-1}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0) + \\text{const.} $$\nWe expand the quadratic forms and group terms involving $\\boldsymbol{\\theta}$:\n$$ \\ln p(\\boldsymbol{\\theta} | \\mathbf{y}) = -\\frac{1}{2}\\left( (\\mathbf{y}^{\\top}\\mathbf{S}^{-1}\\mathbf{y} - 2\\mathbf{y}^{\\top}\\mathbf{S}^{-1}\\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\theta}^{\\top}\\mathbf{X}^{\\top}\\mathbf{S}^{-1}\\mathbf{X}\\boldsymbol{\\theta}) + (\\boldsymbol{\\theta}^{\\top}\\mathbf{\\Sigma}_0^{-1}\\boldsymbol{\\theta} - 2\\boldsymbol{\\theta}^{\\top}\\mathbf{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 + \\boldsymbol{\\mu}_0^{\\top}\\mathbf{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0) \\right) + \\text{const.} $$\nCollecting terms quadratic and linear in $\\boldsymbol{\\theta}$:\n$$ \\ln p(\\boldsymbol{\\theta} | \\mathbf{y}) = -\\frac{1}{2}\\left( \\boldsymbol{\\theta}^{\\top}(\\mathbf{X}^{\\top}\\mathbf{S}^{-1}\\mathbf{X} + \\mathbf{\\Sigma}_0^{-1})\\boldsymbol{\\theta} - 2\\boldsymbol{\\theta}^{\\top}(\\mathbf{X}^{\\top}\\mathbf{S}^{-1}\\mathbf{y} + \\mathbf{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0) \\right) + \\text{const.} $$\nThis is a quadratic form in $\\boldsymbol{\\theta}$, which implies that the posterior distribution is also a multivariate Gaussian, $\\boldsymbol{\\theta} | \\mathbf{y} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_n, \\mathbf{\\Sigma}_n)$. The log-density of this posterior is:\n$$ \\ln p(\\boldsymbol{\\theta} | \\mathbf{y}) = -\\frac{1}{2}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_n)^{\\top}\\mathbf{\\Sigma}_n^{-1}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_n) + \\text{const.} = -\\frac{1}{2}(\\boldsymbol{\\theta}^{\\top}\\mathbf{\\Sigma}_n^{-1}\\boldsymbol{\\theta} - 2\\boldsymbol{\\theta}^{\\top}\\mathbf{\\Sigma}_n^{-1}\\boldsymbol{\\mu}_n + \\text{const.}) $$\nBy comparing the coefficients of the quadratic terms in $\\boldsymbol{\\theta}$, we identify the posterior precision matrix (inverse covariance):\n$$ \\mathbf{\\Sigma}_n^{-1} = \\mathbf{X}^{\\top}\\mathbf{S}^{-1}\\mathbf{X} + \\mathbf{\\Sigma}_0^{-1} $$\nTherefore, the posterior covariance matrix is:\n$$ \\mathbf{\\Sigma}_n = (\\mathbf{X}^{\\top}\\mathbf{S}^{-1}\\mathbf{X} + \\mathbf{\\Sigma}_0^{-1})^{-1} $$\nBy comparing the coefficients of the linear terms in $\\boldsymbol{\\theta}$, we find:\n$$ \\mathbf{\\Sigma}_n^{-1}\\boldsymbol{\\mu}_n = \\mathbf{X}^{\\top}\\mathbf{S}^{-1}\\mathbf{y} + \\mathbf{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 $$\nSolving for the posterior mean $\\boldsymbol{\\mu}_n$ by pre-multiplying by $\\mathbf{\\Sigma}_n$:\n$$ \\boldsymbol{\\mu}_n = \\mathbf{\\Sigma}_n(\\mathbf{X}^{\\top}\\mathbf{S}^{-1}\\mathbf{y} + \\mathbf{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0) $$\nThese closed-form expressions for the posterior mean $\\boldsymbol{\\mu}_n$ and covariance $\\mathbf{\\Sigma}_n$ define the posterior distribution $\\boldsymbol{\\theta} | \\mathbf{y} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_n, \\mathbf{\\Sigma}_n)$.\n\n### Task 3: Implementation\n\nThe derived formulas are implemented in the provided Python program. For each test case, the program constructs the matrices $\\mathbf{X}$, $\\mathbf{y}$, and the inverses $\\mathbf{S}^{-1}$, $\\mathbf{\\Sigma}_0^{-1}$ from the given data and prior specifications. It then computes $\\boldsymbol{\\mu}_n$ and $\\mathbf{\\Sigma}_n$. Finally, it extracts the posterior means of the parameters $[\\mu_{\\ln A}, \\mu_a, \\mu_E]$ from $\\boldsymbol{\\mu}_n$ and the posterior variances $[\\sigma_{\\ln A}^2, \\sigma_a^2, \\sigma_E^2]$ from the diagonal of $\\mathbf{\\Sigma}_n$. The results for the activation energy are converted to the required units of kJ/mol and $(\\text{kJ}/\\text{mol})^2$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Bayesian calibration problem for the MCCI ablation-rate model.\n    \"\"\"\n    # Universal gas constant\n    R = 8.314  # J/(mol*K)\n\n    # Prior specification\n    mu0 = np.array([-10.0, 0.7, 150000.0])\n    Sigma0_diag = np.array([0.25, 0.16, 70000.0**2])\n    Sigma0 = np.diag(Sigma0_diag)\n    # The prior covariance is diagonal, so its inverse is simple to compute.\n    Sigma0_inv = np.diag(1.0 / Sigma0_diag)\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"qr\": np.array([1.5, 2.0, 2.5, 3.0, 3.5, 4.0]),\n            \"T\": np.array([2100.0, 2000.0, 1950.0, 2000.0, 1900.0, 1850.0]),\n            \"v\": np.array([4.46e-5, 4.53e-5, 4.90e-5, 6.54e-5, 5.86e-5, 5.78e-5]),\n            \"s\": np.array([0.08, 0.08, 0.08, 0.08, 0.08, 0.08]),\n        },\n        {\n            \"qr\": np.array([1.0, 4.0]),\n            \"T\": np.array([2000.0, 1850.0]),\n            \"v\": np.array([2.43e-5, 5.78e-5]),\n            \"s\": np.array([0.20, 0.20]),\n        },\n        {\n            \"qr\": np.array([2.0, 3.5, 4.0, 1.8]),\n            \"T\": np.array([2100.0, 1900.0, 1850.0, 2000.0]),\n            \"v\": np.array([5.76e-5, 5.86e-5, 5.78e-5, 4.22e-5]),\n            \"s\": np.array([0.05, 0.12, 0.20, 0.05]),\n        },\n    ]\n\n    results_str_list = []\n    \n    for case in test_cases:\n        qr_vals = case[\"qr\"]\n        T_vals = case[\"T\"]\n        v_vals = case[\"v\"]\n        s_vals = case[\"s\"]\n        \n        N = len(qr_vals)\n\n        # Construct the observation vector y\n        y = np.log(v_vals)\n        \n        # Construct the design matrix X\n        X = np.zeros((N, 3))\n        X[:, 0] = 1.0\n        X[:, 1] = np.log(qr_vals)\n        X[:, 2] = -1.0 / (R * T_vals)\n\n        # The noise covariance matrix S is diagonal, so its inverse is also diagonal.\n        S_inv_diag = 1.0 / (s_vals**2)\n        S_inv = np.diag(S_inv_diag)\n        \n        # Calculate the posterior precision (inverse covariance) matrix Sigma_n_inv\n        Sigma_n_inv = X.T @ S_inv @ X + Sigma0_inv\n        \n        # Calculate the posterior covariance matrix Sigma_n by inverting the precision matrix\n        Sigma_n = np.linalg.inv(Sigma_n_inv)\n        \n        # Calculate the posterior mean vector mu_n\n        # term1 = X.T @ S_inv @ y\n        # term2 = Sigma0_inv @ mu0\n        # A more numerically stable way to compute X.T @ S_inv @ y for diagonal S_inv is:\n        term1 = X.T @ (y * S_inv_diag)\n        term2 = Sigma0_inv @ mu0\n        \n        mu_n = Sigma_n @ (term1 + term2)\n        \n        # Extract posterior means\n        mu_lnA_n, mu_a_n, mu_E_n = mu_n\n        \n        # Extract posterior variances (diagonal of the covariance matrix)\n        var_lnA_n, var_a_n, var_E_n = np.diag(Sigma_n)\n        \n        # Convert activation energy E units for reporting\n        mu_E_n_kJ = mu_E_n / 1000.0\n        var_E_n_kJ2 = var_E_n / (1000.0**2)\n        \n        # Format the result string for this case\n        case_result_str = (\n            f\"[{mu_lnA_n},{mu_a_n},{mu_E_n_kJ},\"\n            f\"{var_lnA_n},{var_a_n},{var_E_n_kJ2}]\"\n        )\n        results_str_list.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str_list)}]\")\n\nsolve()\n```"
        }
    ]
}