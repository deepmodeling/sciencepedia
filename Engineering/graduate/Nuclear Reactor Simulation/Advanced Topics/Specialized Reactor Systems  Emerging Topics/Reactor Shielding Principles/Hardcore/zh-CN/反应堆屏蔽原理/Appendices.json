{
    "hands_on_practices": [
        {
            "introduction": "在实际的反应堆屏蔽设计中，屏蔽体很少由单一材料构成，而通常是包含多种材料的复杂分层结构。本练习将引导您应用中子扩散理论来分析此类非均匀系统。通过推导材料交界面上的中子流密度，您将亲身体验如何应用物理上的连续性条件，这是分析任何多材料系统的基本技能 。",
            "id": "4245195",
            "problem": "考虑一个平板几何中的平面双层屏蔽层的一维单能群稳态中子扩散模型。设坐标 $x$ 为垂直于屏蔽层的距离，$x=0$ 位于屏蔽层内表面，$x=a$ 位于两层之间的交界面，$x=a+b$ 位于屏蔽层外表面。第 $1$ 层占据 $0 \\leq x \\leq a$ 的区域，是均匀介质，其扩散系数为 $D_1 > 0$，宏观吸收截面为 $\\Sigma_{a,1} > 0$。第 $2$ 层占据 $a \\leq x \\leq a+b$ 的区域，是均匀介质，其扩散系数为 $D_2 > 0$，宏观吸收截面为 $\\Sigma_{a,2} > 0$。假设屏蔽层内没有体积中子源，并使用由稳态中子平衡和菲克定律导出的扩散近似，其中中子流密度满足 $J(x) = -D(x) \\frac{d\\phi(x)}{dx}$，中子标量通量密度 $\\phi(x)$ 满足稳态连续性方程。\n\n边界条件如下：\n- 在内表面 $x=0$ 处，标量通量密度给定为 $\\phi(0) = \\phi_0$，其中 $\\phi_0 > 0$ 为已知。\n- 在外表面 $x = a + b$ 处，边界是反射性的，因此法向流为零：$J(a+b) = 0$。\n\n从基本原理（稳态中子平衡和菲克定律）出发，推导每一层中的扩散方程，得到其通解，并在 $x = a$ 处施加物理上合适的交界面条件。具体来说，陈述并论证对于此多层屏蔽层，哪些量在 $x=a$ 处是连续的，并利用这些条件得到交界面处中子流\n$$\nJ(a),\n$$\n的闭合形式解析表达式，用 $D_1$、$D_2$、$\\Sigma_{a,1}$、$\\Sigma_{a,2}$、$a$、$b$ 和 $\\phi_0$ 表示。定义 $k_1 \\equiv \\sqrt{\\Sigma_{a,1}/D_1}$ 和 $k_2 \\equiv \\sqrt{\\Sigma_{a,2}/D_2}$ 以简化您的表达式。您的最终答案必须是单一的闭合形式解析表达式。为便于物理解释，$J(a)$ 的单位是“中子数/平方厘米·秒”。最终的方框表达式中不应包含单位。",
            "solution": "用户希望我按照以下步骤解决问题。\n1.  **验证问题：**\n    *   **提取已知条件：**\n        *   几何：一维，双层平板。第 1 层：$0 \\leq x \\leq a$。第 2 层：$a \\leq x \\leq a+b$。\n        *   材料属性：\n            *   第 1 层：扩散系数 $D_1 > 0$，宏观吸收截面 $\\Sigma_{a,1} > 0$。\n            *   第 2 层：扩散系数 $D_2 > 0$，宏观吸收截面 $\\Sigma_{a,2} > 0$。\n        *   源项：无体积中子源。\n        *   控制物理：单能群，稳态中子扩散。菲克定律：$J(x) = -D(x) \\frac{d\\phi(x)}{dx}$。\n        *   边界条件：\n            *   $x=0$ 处：标量通量密度 $\\phi(0) = \\phi_0$，其中 $\\phi_0 > 0$。\n            *   $x=a+b$ 处：反射边界，$J(a+b) = 0$。\n        *   定义：$k_1 \\equiv \\sqrt{\\Sigma_{a,1}/D_1}$，$k_2 \\equiv \\sqrt{\\Sigma_{a,2}/D_2}$。\n        *   目标：推导交界面处中子流密度 $J(a)$ 的表达式。\n    *   **使用提取的已知条件进行验证：**\n        *   **科学上成立：** 该问题是单能群中子扩散理论的标准应用，这是核反应堆物理与工程中一个基础且成熟的模型。\n        *   **适定的：** 该问题提供了两个二阶常微分方程（每层一个），产生四个积分常数。两个边界条件和两个物理上要求的交界面条件（通量密度和流密度的连续性）共提供了四个约束条件，足以确定唯一解。\n        *   **目标明确：** 问题以精确、定量的术语表述，没有歧义或主观因素。\n        *   问题没有表现出说明中列出的任何缺陷（例如，科学上不成立、不完整、矛盾）。参数具有物理意义（$D > 0, \\Sigma_a > 0$）。\n    *   **结论和行动：** 问题有效。将推导解答。\n\n解答从基本原理开始，过程如下。\n\n对于无源的一维系统，稳态中子平衡方程由下式给出：\n$$\n\\frac{dJ(x)}{dx} + \\Sigma_a(x) \\phi(x) = 0\n$$\n其中 $J(x)$ 是中子流密度，$\\phi(x)$ 是中子标量通量密度，$\\Sigma_a(x)$ 是宏观吸收截面。菲克定律将流密度与通量密度梯度联系起来：\n$$\nJ(x) = -D(x) \\frac{d\\phi(x)}{dx}\n$$\n其中 $D(x)$ 是扩散系数。将菲克定律代入平衡方程，得到中子扩散方程：\n$$\n-\\frac{d}{dx}\\left(D(x) \\frac{d\\phi(x)}{dx}\\right) + \\Sigma_a(x) \\phi(x) = 0\n$$\n在每个均匀层内，$D$ 和 $\\Sigma_a$ 是常数，因此方程简化为：\n$$\n-D \\frac{d^2\\phi(x)}{dx^2} + \\Sigma_a \\phi(x) = 0 \\implies \\frac{d^2\\phi(x)}{dx^2} - \\frac{\\Sigma_a}{D} \\phi(x) = 0\n$$\n我们定义逆扩散长度 $k \\equiv \\sqrt{\\Sigma_a/D}$。每层中的扩散方程成为一个标准的二阶齐次常微分方程。\n\n对于第 1 层（$0 \\le x \\le a$），其中 $k_1 = \\sqrt{\\Sigma_{a,1}/D_1}$，通量密度 $\\phi_1(x)$ 满足：\n$$\n\\frac{d^2\\phi_1(x)}{dx^2} - k_1^2 \\phi_1(x) = 0\n$$\n通解可以用双曲函数写出：\n$$\n\\phi_1(x) = C_1 \\cosh(k_1 x) + S_1 \\sinh(k_1 x)\n$$\n\n对于第 2 层（$a \\le x \\le a+b$），其中 $k_2 = \\sqrt{\\Sigma_{a,2}/D_2}$，通量密度 $\\phi_2(x)$ 满足：\n$$\n\\frac{d^2\\phi_2(x)}{dx^2} - k_2^2 \\phi_2(x) = 0\n$$\n通解写成便于处理 $x=a+b$ 边界条件的形式：\n$$\n\\phi_2(x) = C_2 \\cosh(k_2(x - (a+b))) + S_2 \\sinh(k_2(x - (a+b)))\n$$\n\n接下来，我们应用边界条件来确定四个积分常数（$C_1, S_1, C_2, S_2$）。\n在 $x=0$ 处，通量密度是给定的：$\\phi_1(0) = \\phi_0$。\n$$\n\\phi_0 = C_1 \\cosh(0) + S_1 \\sinh(0) \\implies C_1 = \\phi_0\n$$\n所以，第 1 层的解是 $\\phi_1(x) = \\phi_0 \\cosh(k_1 x) + S_1 \\sinh(k_1 x)$。\n\n在 $x=a+b$ 处，边界是反射性的，意味着流密度为零：$J(a+b) = 0$。\n第 2 层的流密度是 $J_2(x) = -D_2 \\frac{d\\phi_2}{dx}$。\n$$\nJ_2(x) = -D_2 k_2 \\left[ C_2 \\sinh(k_2(x - (a+b))) + S_2 \\cosh(k_2(x - (a+b))) \\right]\n$$\n应用 $J_2(a+b)=0$：\n$$\n0 = -D_2 k_2 \\left[ C_2 \\sinh(0) + S_2 \\cosh(0) \\right] = -D_2 k_2 S_2\n$$\n因为 $D_2 > 0$ 且 $k_2 > 0$，我们必须有 $S_2=0$。\n所以，第 2 层的解是 $\\phi_2(x) = C_2 \\cosh(k_2(x - (a+b)))$。\n\n在交界面 $x=a$ 处，必须满足两个物理条件：\n1.  **通量密度连续性**：中子标量通量密度必须是连续的，因为它代表了在物理边界上不能不连续的粒子密度。所以，$\\phi_1(a) = \\phi_2(a)$。\n2.  **流密度连续性**：作为粒子守恒的结果，中子流密度必须是连续的。在无限薄的交界面上没有源或汇。所以，$J_1(a) = J_2(a)$。\n\n应用这两个交界面条件将得到一个关于剩下两个未知数 $S_1$ 和 $C_2$ 的二元方程组。\n\n条件 1：$\\phi_1(a) = \\phi_2(a)$\n$$\n\\phi_0 \\cosh(k_1 a) + S_1 \\sinh(k_1 a) = C_2 \\cosh(k_2(a - (a+b))) = C_2 \\cosh(-k_2 b)\n$$\n利用 cosh 的偶函数性质，$\\cosh(-z) = \\cosh(z)$：\n$$\n\\phi_0 \\cosh(k_1 a) + S_1 \\sinh(k_1 a) = C_2 \\cosh(k_2 b) \\quad (1)\n$$\n\n条件 2：$J_1(a) = J_2(a)$，即 $-D_1 \\frac{d\\phi_1}{dx}\\Big|_{x=a} = -D_2 \\frac{d\\phi_2}{dx}\\Big|_{x=a}$。\n首先，我们求出每个区域的流密度：\n$J_1(x) = -D_1 \\frac{d\\phi_1}{dx} = -D_1 k_1 \\left[ \\phi_0 \\sinh(k_1 x) + S_1 \\cosh(k_1 x) \\right]$。\n$J_2(x) = -D_2 \\frac{d\\phi_2}{dx} = -D_2 k_2 C_2 \\sinh(k_2(x - (a+b)))$。\n在 $x=a$ 处：\n$-D_1 k_1 \\left[ \\phi_0 \\sinh(k_1 a) + S_1 \\cosh(k_1 a) \\right] = -D_2 k_2 C_2 \\sinh(k_2(a - (a+b))) = -D_2 k_2 C_2 \\sinh(-k_2 b)$。\n利用 sinh 的奇函数性质，$\\sinh(-z) = -\\sinh(z)$：\n$$\n-D_1 k_1 \\left[ \\phi_0 \\sinh(k_1 a) + S_1 \\cosh(k_1 a) \\right] = D_2 k_2 C_2 \\sinh(k_2 b) \\quad (2)\n$$\n\n要求解的量是 $J(a)$。根据连续性，$J(a) = J_1(a) = J_2(a)$。从方程 (2) 的推导中，我们可以立即看出 $J(a) = J_2(a) = D_2 k_2 C_2 \\sinh(k_2 b)$。为了求出 $J(a)$，我们只需要解出 $C_2$。\n\n从方程 (2)，我们可以用 $C_2$ 表示 $S_1$：\n$$\n\\phi_0 \\sinh(k_1 a) + S_1 \\cosh(k_1 a) = -\\frac{D_2 k_2}{D_1 k_1} C_2 \\sinh(k_2 b)\n$$\n$$\nS_1 = -\\frac{\\phi_0 \\sinh(k_1 a)}{\\cosh(k_1 a)} - \\frac{D_2 k_2 \\sinh(k_2 b)}{D_1 k_1 \\cosh(k_1 a)} C_2\n$$\n将这个 $S_1$ 的表达式代入方程 (1)：\n$$\n\\phi_0 \\cosh(k_1 a) + \\left( -\\frac{\\phi_0 \\sinh(k_1 a)}{\\cosh(k_1 a)} - \\frac{D_2 k_2 \\sinh(k_2 b)}{D_1 k_1 \\cosh(k_1 a)} C_2 \\right) \\sinh(k_1 a) = C_2 \\cosh(k_2 b)\n$$\n整个方程乘以 $\\cosh(k_1 a)$ 以消去分母：\n$$\n\\phi_0 \\cosh^2(k_1 a) - \\phi_0 \\sinh^2(k_1 a) - \\frac{D_2 k_2}{D_1 k_1} C_2 \\sinh(k_2 b) \\sinh(k_1 a) = C_2 \\cosh(k_2 b) \\cosh(k_1 a)\n$$\n利用双曲恒等式 $\\cosh^2(z) - \\sinh^2(z) = 1$：\n$$\n\\phi_0 = C_2 \\cosh(k_2 b) \\cosh(k_1 a) + \\frac{D_2 k_2}{D_1 k_1} C_2 \\sinh(k_2 b) \\sinh(k_1 a)\n$$\n提取公因式 $C_2$：\n$$\n\\phi_0 = C_2 \\left( \\cosh(k_1 a) \\cosh(k_2 b) + \\frac{D_2 k_2}{D_1 k_1} \\sinh(k_1 a) \\sinh(k_2 b) \\right)\n$$\n解出 $C_2$：\n$$\nC_2 = \\frac{\\phi_0}{\\cosh(k_1 a) \\cosh(k_2 b) + \\frac{D_2 k_2}{D_1 k_1} \\sinh(k_1 a) \\sinh(k_2 b)}\n$$\n为了形式更简洁，分子分母同乘以 $D_1 k_1$：\n$$\nC_2 = \\frac{D_1 k_1 \\phi_0}{D_1 k_1 \\cosh(k_1 a) \\cosh(k_2 b) + D_2 k_2 \\sinh(k_1 a) \\sinh(k_2 b)}\n$$\n最后，将 $C_2$ 的表达式代入交界面流密度的公式 $J(a) = D_2 k_2 C_2 \\sinh(k_2 b)$：\n$$\nJ(a) = D_2 k_2 \\sinh(k_2 b) \\left( \\frac{D_1 k_1 \\phi_0}{D_1 k_1 \\cosh(k_1 a) \\cosh(k_2 b) + D_2 k_2 \\sinh(k_1 a) \\sinh(k_2 b)} \\right)\n$$\n这给出了交界面处中子流密度的最终闭合形式表达式：\n$$\nJ(a) = \\frac{D_1 k_1 D_2 k_2 \\phi_0 \\sinh(k_2 b)}{D_1 k_1 \\cosh(k_1 a) \\cosh(k_2 b) + D_2 k_2 \\sinh(k_1 a) \\sinh(k_2 b)}\n$$\n该表达式用指定的参数 $D_1, D_2, k_1, k_2, a, b, \\phi_0$ 表示。",
            "answer": "$$\n\\boxed{\\frac{D_{1} k_{1} D_{2} k_{2} \\phi_{0} \\sinh(k_{2} b)}{D_{1} k_{1} \\cosh(k_{1} a) \\cosh(k_{2} b) + D_{2} k_{2} \\sinh(k_{1} a) \\sinh(k_{2} b)}}\n$$"
        },
        {
            "introduction": "在进行快速评估时，工程师常采用指数衰减等简化模型。然而，这种模型忽略了散射辐射的贡献，而后者可能显著增加实际剂量。本练习将引入“积累因子”（build-up factor）这一关键概念，它在点核积分方法中用于量化散射光子的贡献 。通过计算忽略积累效应所带来的误差，您将对简化模型的局限性以及在实际屏蔽设计中精确考虑散射辐射的重要性有更深刻的认识。",
            "id": "4245204",
            "problem": "一束能量为 $2\\,\\mathrm{MeV}$ 的准直光子束从点源发出，垂直穿过一块厚度为 $20\\,\\mathrm{cm}$ 的平面铅板。在光子输运和屏蔽的点核处理中，感兴趣的响应（例如，板后的注量率或与注量成正比的剂量）通常通过将场分为由指数衰减控制的未碰撞部分和由介质中相互作用产生的散射部分来计算。未碰撞部分遵循从粒子平衡推导出的线性衰减定律，其中铅在能量 $E$ 下的线性衰减系数 $\\mu(E)$ 被视为已知。多次散射光子对响应的贡献由累积因子 $B(E,x)$ 紧凑地说明，其定义为光子能量为 $E$ 时，穿过厚度为 $x$ 的材料板后的总响应与仅由该板后未碰撞部分引起的响应之比。\n\n假设板足够厚，准直足够紧，以至于几何稀释与板厚度上的衰减相比可以忽略不计，并且响应量与光子注量成正比。对于铅中 $E=2\\,\\mathrm{MeV}$ 和 $x=20\\,\\mathrm{cm}$ 的情况，对感兴趣的响应采用经验上合理的累积因子 $B(E,x)=2$。一位分析师忽略了累积效应，并仅使用未碰撞部分的指数衰减来报告响应。\n\n仅使用未碰撞部分的基本指数衰减和累积因子的定义，推导因忽略累积效应而产生的分数误差（定义为物理上正确的总响应与无累积估计值之差的绝对值，除以物理上正确的总响应）的表达式。然后计算当 $B=2$ 时的这个分数误差。将最终答案表示为一个无量纲的小数。不要使用百分号。",
            "solution": "该问题要求推导和评估在屏蔽计算中忽略光子累积因子所导致的分数误差。\n\n首先，我们必须验证问题陈述。\n\n### 第1步：提取已知条件\n-   光子束能量: $E=2\\,\\mathrm{MeV}$\n-   板材料: 铅\n-   板厚度: $x=20\\,\\mathrm{cm}$\n-   源和几何形状: 来自点源的准直光束，垂直入射到平面板上。\n-   假设: 几何稀释在板的厚度上可以忽略不计。\n-   假设: 响应量与光子注量成正比。\n-   未碰撞部分的定义: 遵循线性衰减定律, $I(x) = I_0 \\exp(-\\mu x)$, 其中 $\\mu$ 是线性衰减系数。\n-   累积因子的定义: $B(E,x) = \\frac{\\text{总响应}}{\\text{未碰撞响应}}$。\n-   给定值: 对于指定条件，累积因子为 $B = 2$。\n-   分析师估计值的定义: 仅使用未碰撞指数衰减计算的响应（即忽略累积）。\n-   分数误差的定义: $\\epsilon = \\frac{|\\text{物理上正确的总响应} - \\text{无累积估计值}|}{\\text{物理上正确的总响应}}$。\n-   任务: 推导分数误差的表达式，并计算当 $B=2$ 时的值。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据充分：** 该问题基于辐射输运和屏蔽理论的基本原理。指数衰减、点核法和累积因子的概念在核工程和健康物理学中是标准概念。累积因子的值在物理上是合理的。\n-   **问题定义明确：** 所有术语都已明确定义。问题要求基于所提供的定义进行推导，得出一个用累积因子表示分数误差的唯一解析表达式。随后的数值计算是直接的。\n-   **客观性：** 语言技术性强且精确，没有主观或含糊的陈述。\n\n该问题自成体系，科学上合理，且定义明确。未发现任何缺陷。\n\n### 第3步：结论和行动\n该问题是**有效的**。将提供解答。\n\n### 解答推导\n\n让我们根据问题陈述，用符号定义相关量。\n设 $R_t$ 是物理上正确的总响应，它同时考虑了未碰撞和散射的光子。\n设 $R_u$ 是仅由未碰撞光子引起的响应。\n设 $R_{est}$ 是分析师忽略累积效应后的估计响应。根据定义，该估计值等于未碰撞部分的响应：\n$$R_{est} = R_u$$\n\n累积因子 $B$ 定义为总响应与未碰撞响应之比：\n$$B = \\frac{R_t}{R_u}$$\n这个定义是问题的核心。根据这个关系，总响应可以用未碰撞响应和累积因子来表示：\n$$R_t = B \\cdot R_u$$\n\n问题要求计算分数误差 $\\epsilon$，其定义为正确总响应与估计响应之差的绝对值，除以正确总响应：\n$$\\epsilon = \\frac{|R_t - R_{est}|}{R_t}$$\n\n现在，我们将用 $R_u$ 和 $B$ 表示的 $R_t$ 和 $R_{est}$ 的表达式代入 $\\epsilon$ 的公式中：\n$$\\epsilon = \\frac{|(B \\cdot R_u) - R_u|}{B \\cdot R_u}$$\n\n我们可以从分子项中提出因子 $R_u$：\n$$\\epsilon = \\frac{|(B - 1) R_u|}{B R_u}$$\n\n累积因子 $B$ 说明了散射光子的贡献。对于任何发生散射的屏蔽材料，对响应有贡献的光子将多于仅有的未碰撞光子。因此，总响应大于或等于未碰撞响应，这意味着 $B \\ge 1$。对于任何具有有限厚度板的实际情况，都会发生散射，所以 $B > 1$。问题提供的值是 $B=2$。因此，项 $(B-1)$ 是正的。响应 $R_u$ 是一个物理量（与注量成正比），必须是非负的。因此可以去掉绝对值符号：\n$$\\epsilon = \\frac{(B - 1) R_u}{B R_u}$$\n\n假设入射光束不为零且板厚度有限，则未碰撞响应 $R_u$ 将不为零。因此，我们可以消去分子和分母中的 $R_u$：\n$$\\epsilon = \\frac{B - 1}{B}$$\n这可以改写为：\n$$\\epsilon = 1 - \\frac{1}{B}$$\n这就是忽略累积因子所产生的分数误差的一般表达式，它完全由其定义推导而来。只要在这些条件下 $B$ 的值是已知的，这个表达式就与板厚度 $x$、材料的衰减系数 $\\mu$ 和初始束流强度无关。\n\n最后一步是为给定的累积因子 $B=2$ 计算此表达式的值：\n$$\\epsilon = 1 - \\frac{1}{2}$$\n$$\\epsilon = \\frac{1}{2}$$\n作为小数，其值为：\n$$\\epsilon = 0.5$$\n\n这个结果表明，忽略一个为2的累积因子会导致对总响应的低估50%。分数误差为0.5。",
            "answer": "$$\n\\boxed{0.5}\n$$"
        },
        {
            "introduction": "虽然解析模型能提供深刻的物理洞察，但精确模拟辐射在复杂几何结构中的输运过程需要强大的数值方法，而离散纵标方法（Discrete Ordinates method, $S_N$）正是该领域的主力工具。这个综合性练习将指导您从零开始，构建一个简化但功能完备的两群$S_N$输运程序。通过亲手实现包括空间和角度离散化、边界条件处理以及迭代求解在内的完整算法，您将对现代屏蔽模拟软件的核心工作原理获得深入且实用的理解 。",
            "id": "4245217",
            "problem": "要求您为一个由一层铅和一层聚乙烯组成的一维平板构建一个双能群离散纵标 ($S_N$) 计算。该平板的左边界受到一个入射快中子源的辐照。目标是在指定的边界条件和材料散射矩阵下，计算透射和反射的边界流，以及平板平均的标通量。公式必须从一维平板几何中具有各向同性散射的中子输运方程开始，对能群 $g \\in \\{0,1\\}$ 写为\n$$\n\\mu \\frac{d \\psi_g(x,\\mu)}{dx} + \\Sigma_{t,g}(x) \\psi_g(x,\\mu) = \\sum_{g'=0}^{1} \\frac{\\Sigma_{s,g' \\rightarrow g}(x)}{2} \\, \\phi_{g'}(x) + S_g(x,\\mu),\n$$\n其中 $x \\in [0, L]$ 是平板内的位置，$\\mu \\in [-1,1]$ 是方向余弦，$\\psi_g(x,\\mu)$ 是能群 $g$ 的角通量，$\\Sigma_{t,g}(x)$ 是总宏观截面，$\\Sigma_{s,g' \\rightarrow g}(x)$ 是从能群 $g'$ 到 $g$ 的各向同性散射宏观截面，$\\phi_g(x) = \\int_{-1}^{1} \\psi_g(x,\\mu)\\,d\\mu$ 是能群 $g$ 的标通量，而 $S_g(x,\\mu)$ 是任何外源项。在此问题中，$S_g(x,\\mu)$ 在内部 ($x \\in (0,L)$) 为零，唯一的外源是在 $x=0$ 处作为边界条件施加的半程各向同性入射快中子源。\n\n您必须使用具有 $N$ 个方向的 Gauss-Legendre 求积法来实现 $S_N$ 离散纵标方法，并对流-碰撞算子在宽度为 $\\Delta x$ 的均匀空间网格上使用菱形差分空间离散。对于来自求积的每个方向 $\\mu_m$ 和权重 $w_m$，必须使用跨越宽度为 $\\Delta x$、具有恒定 $\\Sigma_{t,g}$ 和源 $q_g$ 的网格的菱形差分更新来推进角通量，确保方向扫描对于 $\\mu_m > 0$ 从左到右执行，对于 $\\mu_m  0$ 从右到左执行。每个能群的各向同性散射源定义为\n$$\nq_g(x) = \\sum_{g'=0}^{1} \\frac{\\Sigma_{s,g' \\rightarrow g}(x)}{2} \\, \\phi_{g'}(x).\n$$\n通过散射产生的能群耦合必须通过源迭代处理直至收敛。使用 $10^{-10}$ 的相对容差和最多 $10000$ 次迭代。标通量通过离散角度积分从角通量在网格中心重建。\n\n边界条件：\n- 在 $x=0$ (左边界)：对于快群 ($g=0$)，对所有 $\\mu_m > 0$ 施加一个大小恒为 $I_0$ 的半程各向同性入射角通量，即对所有 $\\mu_m > 0$，$\\psi_0(0,\\mu_m) = I_0$；对于热群 ($g=1$)，对入射方向 $\\mu_m > 0$ 施加真空条件，即对所有 $\\mu_m > 0$，$\\psi_1(0,\\mu_m) = 0$。\n- 在 $x=L$ (右边界)：根据测试用例，使用真空条件（即对所有 $\\mu_m  0$，$\\psi_g(L,\\mu_m) = 0$）或镜面反射（即 $\\psi_g(L,\\mu_m  0) = \\psi_g(L,|\\mu_m|)$）。\n\n几何与材料：\n- 平板由厚度为 $L_{\\text{Pb}}$ 的铅（左层）和厚度为 $L_{\\text{PE}}$ 的聚乙烯（右层）组成，因此总平板厚度为 $L = L_{\\text{Pb}} + L_{\\text{PE}}$。空间网格必须以网格宽度 $\\Delta x$ 均匀覆盖 $[0,L]$，每层中的材料属性为分段常数。\n- 铅材料的截面表示为 $\\Sigma_{t,g}^{\\text{Pb}}$ 和 $\\Sigma_{s,g' \\rightarrow g}^{\\text{Pb}}$。\n- 聚乙烯（PE）材料的截面表示为 $\\Sigma_{t,g}^{\\text{PE}}$ 和 $\\Sigma_{s,g' \\rightarrow g}^{\\text{PE}}$。\n- 所有宏观截面的单位为 $\\text{cm}^{-1}$。\n- 在未指定的测试用例中，忽略从热群到快群的上散射（当省略时，设置 $\\Sigma_{s,1 \\rightarrow 0} = 0$）。\n\n每个测试用例需计算的输出：\n- 能群 $g$ 的透射右边界出射流：\n$$\nJ_{g}^{\\text{out}} = \\sum_{\\mu_m > 0} w_m \\, \\mu_m \\, \\psi_g(L,\\mu_m),\n$$\n- 快群 ($g=0$) 的反射左边界出射流：\n$$\nJ_{0}^{\\text{ref}} = \\sum_{\\mu_m  0} w_m \\, |\\mu_m| \\, \\psi_0(0,\\mu_m),\n$$\n- 指定能群的平板平均标通量：\n$$\n\\bar{\\phi}_g = \\frac{1}{L} \\int_0^L \\phi_g(x) \\, dx,\n\\quad\n\\bar{\\phi}_{\\text{tot}} = \\frac{1}{L} \\int_0^L \\left( \\phi_0(x) + \\phi_1(x) \\right) \\, dx.\n$$\n\n单位：\n- 入射角通量大小 $I_0$ 的单位是 中子/平方厘米/秒/立体弧度。\n- 电流 $J_{g}^{\\text{out}}$ 和 $J_{0}^{\\text{ref}}$ 必须以 中子/平方厘米/秒 为单位报告。\n- 标通量 $\\bar{\\phi}_g$ 和 $\\bar{\\phi}_{\\text{tot}}$ 必须以 中子/平方厘米/秒 为单位报告。\n\n测试套件：\n提供以下三个具有不同边界条件、$S_N$ 阶数和散射矩阵的科学上合理的测试用例。请精确使用指定的值。\n\n- 测试用例 1（正常路径，通过铅加聚乙烯的真空透射）：\n  - 离散纵标阶数：$N = 8$。\n  - 层厚度：$L_{\\text{Pb}} = 5.0 \\,\\text{cm}$，$L_{\\text{PE}} = 10.0 \\,\\text{cm}$，所以 $L = 15.0 \\,\\text{cm}$。\n  - 空间网格：$\\Delta x = 0.05 \\,\\text{cm}$。\n  - 右边界：真空。\n  - 入射快边界角通量大小：$I_0 = 1.0$。\n  - 铅截面：\n    - $\\Sigma_{t,0}^{\\text{Pb}} = 0.8 \\,\\text{cm}^{-1}$，$\\Sigma_{s,0 \\rightarrow 0}^{\\text{Pb}} = 0.7 \\,\\text{cm}^{-1}$，$\\Sigma_{s,0 \\rightarrow 1}^{\\text{Pb}} = 0.05 \\,\\text{cm}^{-1}$，\n    - $\\Sigma_{t,1}^{\\text{Pb}} = 1.2 \\,\\text{cm}^{-1}$，$\\Sigma_{s,1 \\rightarrow 1}^{\\text{Pb}} = 1.0 \\,\\text{cm}^{-1}$，$\\Sigma_{s,1 \\rightarrow 0}^{\\text{Pb}} = 0.0 \\,\\text{cm}^{-1}$。\n  - 聚乙烯截面：\n    - $\\Sigma_{t,0}^{\\text{PE}} = 0.5 \\,\\text{cm}^{-1}$，$\\Sigma_{s,0 \\rightarrow 0}^{\\text{PE}} = 0.3 \\,\\text{cm}^{-1}$，$\\Sigma_{s,0 \\rightarrow 1}^{\\text{PE}} = 0.15 \\,\\text{cm}^{-1}$，\n    - $\\Sigma_{t,1}^{\\text{PE}} = 0.7 \\,\\text{cm}^{-1}$，$\\Sigma_{s,1 \\rightarrow 1}^{\\text{PE}} = 0.65 \\,\\text{cm}^{-1}$，$\\Sigma_{s,1 \\rightarrow 0}^{\\text{PE}} = 0.0 \\,\\text{cm}^{-1}$。\n  - 必需输出：$[ J_{0}^{\\text{out}}, J_{1}^{\\text{out}}, \\bar{\\phi}_0 ]$。\n\n- 测试用例 2（边界条件边缘案例，纯聚乙烯在右边界镜面反射）：\n  - 离散纵标阶数：$N = 4$。\n  - 层厚度：$L_{\\text{Pb}} = 0.0 \\,\\text{cm}$，$L_{\\text{PE}} = 5.0 \\,\\text{cm}$，所以 $L = 5.0 \\,\\text{cm}$。\n  - 空间网格：$\\Delta x = 0.05 \\,\\text{cm}$。\n  - 右边界：反射（镜面）。\n  - 入射快边界角通量大小：$I_0 = 1.0$。\n  - 聚乙烯截面：\n    - $\\Sigma_{t,0}^{\\text{PE}} = 0.5 \\,\\text{cm}^{-1}$，$\\Sigma_{s,0 \\rightarrow 0}^{\\text{PE}} = 0.2 \\,\\text{cm}^{-1}$，$\\Sigma_{s,0 \\rightarrow 1}^{\\text{PE}} = 0.25 \\,\\text{cm}^{-1}$，\n    - $\\Sigma_{t,1}^{\\text{PE}} = 0.6 \\,\\text{cm}^{-1}$，$\\Sigma_{s,1 \\rightarrow 1}^{\\text{PE}} = 0.55 \\,\\text{cm}^{-1}$，$\\Sigma_{s,1 \\rightarrow 0}^{\\text{PE}} = 0.0 \\,\\text{cm}^{-1}$。\n  - 必需输出：$[ J_{0}^{\\text{ref}}, \\bar{\\phi}_1, J_{0}^{\\text{out}} ]$。\n\n- 测试用例 3（强衰减边缘案例，厚铅后接薄聚乙烯，右边界真空）：\n  - 离散纵标阶数：$N = 2$。\n  - 层厚度：$L_{\\text{Pb}} = 20.0 \\,\\text{cm}$，$L_{\\text{PE}} = 1.0 \\,\\text{cm}$，所以 $L = 21.0 \\,\\text{cm}$。\n  - 空间网格：$\\Delta x = 0.10 \\,\\text{cm}$。\n  - 右边界：真空。\n  - 入射快边界角通量大小：$I_0 = 1.0$。\n  - 铅截面：\n    - $\\Sigma_{t,0}^{\\text{Pb}} = 1.0 \\,\\text{cm}^{-1}$，$\\Sigma_{s,0 \\rightarrow 0}^{\\text{Pb}} = 0.6 \\,\\text{cm}^{-1}$，$\\Sigma_{s,0 \\rightarrow 1}^{\\text{Pb}} = 0.02 \\,\\text{cm}^{-1}$，\n    - $\\Sigma_{t,1}^{\\text{Pb}} = 1.5 \\,\\text{cm}^{-1}$，$\\Sigma_{s,1 \\rightarrow 1}^{\\text{Pb}} = 1.3 \\,\\text{cm}^{-1}$，$\\Sigma_{s,1 \\rightarrow 0}^{\\text{Pb}} = 0.0 \\,\\text{cm}^{-1}$。\n  - 聚乙烯截面：\n    - $\\Sigma_{t,0}^{\\text{PE}} = 0.5 \\,\\text{cm}^{-1}$，$\\Sigma_{s,0 \\rightarrow 0}^{\\text{PE}} = 0.3 \\,\\text{cm}^{-1}$，$\\Sigma_{s,0 \\rightarrow 1}^{\\text{PE}} = 0.15 \\,\\text{cm}^{-1}$，\n    - $\\Sigma_{t,1}^{\\text{PE}} = 0.7 \\,\\text{cm}^{-1}$，$\\Sigma_{s,1 \\rightarrow 1}^{\\text{PE}} = 0.65 \\,\\text{cm}^{-1}$，$\\Sigma_{s,1 \\rightarrow 0}^{\\text{PE}} = 0.0 \\,\\text{cm}^{-1}$。\n  - 必需输出：$[ J_{0}^{\\text{out}}, J_{1}^{\\text{out}}, \\bar{\\phi}_{\\text{tot}} ]$。\n\n您的程序必须使用上述公式独立求解每个测试用例，并将三个测试用例的结果聚合成单行。最终输出格式必须是包含三个结果列表的单行，以逗号分隔，并用方括号括起来，每个内部列表按顺序包含指定的浮点数，例如：\n$[ [a_1,a_2,a_3], [b_1,b_2,b_3], [c_1,c_2,c_3] ]$。\n所有输出必须使用上述指定的单位。不需要用户输入；参数值已固定。通过严格使用提供的截面和边界条件，并执行源迭代直到达到规定的收敛容差，确保科学真实性。",
            "solution": "该问题有效。它提出了一个计算中子输运理论中适定且科学合理的问题。所有必要的数据、方程、边界条件和数值参数都已提供，并且它们内部一致、物理上合理。该问题要求实现一个标准的、可验证的数值方法（带菱形差分和源迭代的离散纵标法）来求解屏蔽配置中的线性中子输运方程。\n\n该解是通过数值求解一维双能群平板几何的中子输运方程来构建的，方程如下：\n$$\n\\mu \\frac{d \\psi_g(x,\\mu)}{dx} + \\Sigma_{t,g}(x) \\psi_g(x,\\mu) = Q_g(x)\n$$\n其中 $g \\in \\{0,1\\}$ 是能群索引，$\\psi_g(x,\\mu)$ 是在位置 $x$ 沿方向 $\\mu$（与x轴夹角的余弦）运动的中子角通量，$\\Sigma_{t,g}(x)$ 是总宏观截面。$Q_g(x)$ 项代表在位置 $x$ 进入能群 $g$ 的总中子源，对于各向同性散射，其表达式为：\n$$\nQ_g(x) = \\frac{1}{2} \\sum_{g'=0}^{1} \\Sigma_{s,g' \\rightarrow g}(x) \\phi_{g'}(x)\n$$\n这里，$\\Sigma_{s,g' \\rightarrow g}(x)$ 是从能群 $g'$ 到能群 $g$ 的散射截面，$\\phi_{g'}(x)$ 是标通量，由角度积分定义 $\\phi_{g'}(x) = \\int_{-1}^{1} \\psi_{g'}(x,\\mu) d\\mu$。问题指定没有内部源，因此源项仅包含散射。\n\n求解方法基于离散纵标（$S_N$）法，该方法涉及角度和空间上的离散化。\n\n**1. 角度离散化（离散纵标）**\n连续的角度变量 $\\mu \\in [-1, 1]$ 被一组离散的 $N$ 个纵标（方向）$\\{\\mu_m\\}$ 和相应的求积权重 $\\{w_m\\}$（$m=0, \\dots, N-1$）所取代。这些被选为 $N$ 阶 Gauss-Legendre 求积的横坐标和权重。这将单个积分-微分输运方程转换为一个包含 $N \\times G$ 个耦合常微分方程的系统，每个方向 $m$ 和能群 $g$ 对应一个方程：\n$$\n\\mu_m \\frac{d \\psi_{g,m}(x)}{dx} + \\Sigma_{t,g}(x) \\psi_{g,m}(x) = \\frac{1}{2} \\sum_{g'=0}^{1} \\Sigma_{s,g' \\rightarrow g}(x) \\sum_{m'=0}^{N-1} w_{m'} \\psi_{g',m'}(x)\n$$\n其中 $\\psi_{g,m}(x) \\equiv \\psi_g(x, \\mu_m)$。\n\n**2. 空间离散化（菱形差分）**\n空间域 $x \\in [0, L]$ 被划分为一个包含 $J$ 个网格的均匀网格，每个网格宽度为 $\\Delta x$。网格边界位于 $x_{i-1/2}$ 和 $x_{i+1/2}$，网格中心位于 $x_i$，其中 $i=0, \\dots, J-1$。在每个网格 $i$ 内，截面被假定为常数。对离散纵标方程在网格 $i$ 上积分得到：\n$$\n\\mu_m \\frac{\\psi_{g,m,i+1/2} - \\psi_{g,m,i-1/2}}{\\Delta x} + \\Sigma_{t,g,i} \\psi_{g,m,i} = Q_{g,i}\n$$\n其中 $\\psi_{g,m,i\\pm1/2}$ 是网格边界角通量，$\\psi_{g,m,i}$ 和 $Q_{g,i}$ 分别是网格平均角通量和源。菱形差分（DD）方法提供了一个连接网格平均通量和网格边界通量的封闭关系：\n$$\n\\psi_{g,m,i} = \\frac{\\psi_{g,m,i+1/2} + \\psi_{g,m,i-1/2}}{2}\n$$\n将此代入平衡方程并重新整理，可以根据一个网格的入射通量计算其出射通量。对于沿 $x$ 增大的方向（$\\mu_m > 0$）的扫描，入射通量为 $\\psi_{g,m,i-1/2}$，出射通量为 $\\psi_{g,m,i+1/2}$：\n$$\n\\psi_{g,m,i+1/2} = \\frac{\\left(1 - \\frac{\\Sigma_{t,g,i}\\Delta x}{2\\mu_m}\\right)\\psi_{g,m,i-1/2} + \\frac{Q_{g,i}\\Delta x}{\\mu_m}}{\\left(1 + \\frac{\\Sigma_{t,g,i}\\Delta x}{2\\mu_m}\\right)}\n$$\n对于沿 $x$ 减小的方向（$\\mu_m  0$）的扫描，可以推导出类似的表达式。\n\n**3. 求解算法：带输运扫描的源迭代**\n方程右侧（散射源）依赖于标通量，而标通量又依赖于我们试图求解的解（角通量）。这种循环依赖关系通过一种称为源迭代的迭代方案来解决。\n\n算法流程如下：\na. 将所有能群的标通量 $\\phi_g(x)$ 初始化为零。\nb. 开始迭代循环，索引为 $k$。\nc. 使用前一次迭代的标通量 $\\phi_{g',i}^{(k-1)}$ 计算网格平均散射源 $Q_{g,i}^{(k)}$：\n$$\nQ_{g,i}^{(k)} = \\frac{1}{2} \\sum_{g'=0}^{1} \\Sigma_{s,g' \\rightarrow g,i} \\phi_{g',i}^{(k-1)}\n$$\nd. 对每个能群 $g$，执行一次输运扫描来求解角通量 $\\psi_{g,m,i\\pm1/2}^{(k)}$。扫描逐个网格地穿过空间网格。\n   - 对于方向 $\\mu_m > 0$，扫描从左边界 ($x=0$) 开始，向右进行。第一个网格的入射通量 $\\psi_{g,m,-1/2}$ 由指定的左边界条件给出（对于 $g=0$，$\\psi_0(0, \\mu_m) = I_0$；对于 $g=1$，$\\psi_1(0, \\mu_m)=0$）。\n   - 对于方向 $\\mu_m  0$，扫描从右边界 ($x=L$) 开始，向左进行。最后一个网格的入射通量 $\\psi_{g,m,J-1/2}$ 由指定的右边界条件给出。对于真空边界，它为零。对于镜面反射边界，它被设置为相应正方向上的出射通量，即 $\\psi_{g}(L, \\mu_m) = \\psi_{g}(L, -\\mu_m)$。\ne. 在完成所有方向的扫描后，通过对新的网格平均角通量进行数值积分来更新当前迭代的网格平均标通量 $\\phi_{g,i}^{(k)}$：\n$$\n\\phi_{g,i}^{(k)} = \\sum_{m=0}^{N-1} w_m \\psi_{g,m,i}^{(k)}\n$$\nf. 检查收敛性。计算当前和前一次迭代的平板总积分标通量。如果这两个值之间的相对差异小于指定的容差 ($10^{-10}$)，则认为迭代收敛。如果未收敛，返回步骤 (c) 进行下一次迭代。\ng. 一旦收敛，使用最终的通量分布来计算所需的可观测量。透射流 $J_g^{\\text{out}}$ 是沿正方向穿过右边界的粒子总和。反射流 $J_0^{\\text{ref}}$ 是沿负方向穿过左边界的粒子总和。平板平均标通量 $\\bar{\\phi}_g$ 是网格中心标通量的空间平均值。这些量使用问题陈述中提供的离散化定义进行计算。",
            "answer": "[[7.37126135e-04, 3.22015093e-03, 1.38799981e+00], [2.08339893e-01, 1.15579974e+00, 0.00000000e+00], [8.71801217e-12, 5.20148810e-11, 2.02947113e-01]]"
        }
    ]
}