{
    "hands_on_practices": [
        {
            "introduction": "要应用功率迭代等数值方法，第一步是将中子输运的物理原理转化为线性代数问题。本练习将通过一个简化的双能群模型，指导你如何从给定的宏观截面数据构建k-本征值问题 $A \\phi = \\frac{1}{k} B \\phi$ 中的关键矩阵。这有助于你理解损失算符 $A$ 和裂变产生算符 $B$ 的物理意义和数学结构。",
            "id": "4241549",
            "problem": "考虑一个用于核反应堆模拟的稳态中子输运的双能群、均匀无限介质模型。在无限介质中，空间泄漏被忽略，对于群 $g \\in \\{1,2\\}$ 的多群中子平衡方程，将由吸收和移出散射引起的中子损失率与由移入散射和裂变产生（后者按有效增殖因子 $k$ 进行缩放）引起的中子增益率等同起来。从此平衡出发，该系统可以被构造成一个 $k$-本征值问题的形式 $A \\phi = \\frac{1}{k} B \\phi$，其中 $A$ 是损失算符，$B$ 是裂变产生算符，$\\phi$ 是双能群通量矢量。\n\n使用以下物理上合理的宏观截面（单位为厘米的倒数，写作 $\\text{cm}^{-1}$）、群裂变参数和裂变谱：\n- 群1吸收截面 $\\,\\Sigma_{a,1} = 0.07\\,\\text{cm}^{-1}$，向下散射截面 $\\,\\Sigma_{s,1 \\to 2} = 0.21\\,\\text{cm}^{-1}$，以及群 $\\nu\\Sigma_f$ 值 $\\,\\nu \\Sigma_{f,1} = 0.042\\,\\text{cm}^{-1}$。\n- 群2吸收截面 $\\,\\Sigma_{a,2} = 0.09\\,\\text{cm}^{-1}$，向上散射截面 $\\,\\Sigma_{s,2 \\to 1} = 0.015\\,\\text{cm}^{-1}$，以及群 $\\nu\\Sigma_f$ 值 $\\,\\nu \\Sigma_{f,2} = 0.175\\,\\text{cm}^{-1}$。\n- 裂变谱份额（裂变中子在各群中产生的概率）：$\\,\\chi_1 = 0.92\\,$ 和 $\\,\\chi_2 = 0.08\\,$。\n\n设双能群通量矢量为\n$$\n\\phi = \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix} = \\begin{pmatrix} 1.37 \\times 10^{13} \\\\ 2.62 \\times 10^{13} \\end{pmatrix} \\ \\text{cm}^{-2}\\,\\text{s}^{-1}.\n$$\n\n任务：\n1. 从无限介质中的稳态多群平衡方程出发，组装与上述 $k$-本征值表述一致的 $2 \\times 2$ 损失矩阵 $A$ 和 $2 \\times 2$ 裂变产生矩阵 $B$。\n2. 说明 $A$ 和 $B$ 的维度和稀疏模式。\n3. 计算裂变源矢量 $q = B \\phi$，然后计算标量总裂变源\n$$\nS_f = q_1 + q_2,\n$$\n其中 $q_g$ 是 $q$ 的第 $g$ 个分量。将 $S_f$ 的最终数值以 中子/立方厘米·秒（写作 $\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}$）为单位表示，并将您的答案四舍五入到五位有效数字。",
            "solution": "用户提供的问题已经过分析，并被确定为**有效**。该问题在科学上基于核反应堆物理学原理，问题陈述清晰，数据充分且一致，表述客观。这些任务涉及多群中子平衡方程的标准应用。\n\n该问题要求执行与双能群、稳态、无限介质中子平衡方程相关的三项任务。我们将按顺序处理每项任务。\n\n首先，我们建立理论框架。在无限介质中，能量群 $g$ 的稳态中子平衡将中子损失（吸收和移出散射）与中子增益（移入散射和裂变）等同起来。\n\n对于双能群模型（$g=1$ 代表快中子群，$g=2$ 代表热中子群），平衡方程为：\n\n对于群1：\n$$\n\\text{Losses}_1 = \\text{Gains}_1\n$$\n$$\n\\Sigma_{a,1}\\phi_1 + \\Sigma_{s,1 \\to 2}\\phi_1 = \\Sigma_{s,2 \\to 1}\\phi_2 + \\frac{1}{k} \\chi_1 \\left( \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2 \\right)\n$$\n\n对于群2：\n$$\n\\text{Losses}_2 = \\text{Gains}_2\n$$\n$$\n\\Sigma_{a,2}\\phi_2 + \\Sigma_{s,2 \\to 1}\\phi_2 = \\Sigma_{s,1 \\to 2}\\phi_1 + \\frac{1}{k} \\chi_2 \\left( \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2 \\right)\n$$\n\n在此，$\\phi_g$ 是群 $g$ 中的中子通量，$\\Sigma_{a,g}$ 是宏观吸收截面，$\\Sigma_{s,g \\to g'}$ 是从群 $g$ 到 $g'$ 的宏观散射截面，$\\nu\\Sigma_{f,g}$ 是每次裂变产生的平均中子数乘以宏观裂变截面，$\\chi_g$ 是在群 $g$ 中产生的裂变中子份额，而 $k$ 是有效增殖因子。\n\n问题要求将此系统转化为 $A \\phi = \\frac{1}{k} B \\phi$ 的形式。为此，我们将所有非裂变项归到左侧，将所有与裂变产生相关的项归到右侧。\n\n重新整理方程：\n$$\n(\\Sigma_{a,1} + \\Sigma_{s,1 \\to 2})\\phi_1 - \\Sigma_{s,2 \\to 1}\\phi_2 = \\frac{1}{k} \\left[ \\chi_1 ( \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2 ) \\right]\n$$\n$$\n-\\Sigma_{s,1 \\to 2}\\phi_1 + (\\Sigma_{a,2} + \\Sigma_{s,2 \\to 1})\\phi_2 = \\frac{1}{k} \\left[ \\chi_2 ( \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2 ) \\right]\n$$\n\n该系统可以写成矩阵形式：\n$$\n\\begin{pmatrix} \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2}  -\\Sigma_{s,2 \\to 1} \\\\ -\\Sigma_{s,1 \\to 2}  \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1} \\end{pmatrix} \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix} = \\frac{1}{k} \\begin{pmatrix} \\chi_1 \\nu\\Sigma_{f,1}  \\chi_1 \\nu\\Sigma_{f,2} \\\\ \\chi_2 \\nu\\Sigma_{f,1}  \\chi_2 \\nu\\Sigma_{f,2} \\end{pmatrix} \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix}\n$$\n\n**任务1：组装损失矩阵 $A$ 和裂变产生矩阵 $B$。**\n\n从上述矩阵方程中，我们可以识别出损失算符 $A$（更准确地说是净损失与散射算符）和裂变产生算符 $B$。\n\n损失矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix} \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2}  -\\Sigma_{s,2 \\to 1} \\\\ -\\Sigma_{s,1 \\to 2}  \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1} \\end{pmatrix}\n$$\n裂变产生矩阵 $B$ 为：\n$$\nB = \\begin{pmatrix} \\chi_1 \\nu\\Sigma_{f,1}  \\chi_1 \\nu\\Sigma_{f,2} \\\\ \\chi_2 \\nu\\Sigma_{f,1}  \\chi_2 \\nu\\Sigma_{f,2} \\end{pmatrix}\n$$\n这也可以表示为裂变谱矢量 $\\chi_g$ 和产生矢量 $\\nu\\Sigma_{f,g}$ 的外积，即 $B = \\chi (\\nu\\Sigma_f)^T$。\n\n现在，我们代入给定的数值：\n$\\Sigma_{a,1} = 0.07\\,\\text{cm}^{-1}$，$\\Sigma_{s,1 \\to 2} = 0.21\\,\\text{cm}^{-1}$，$\\nu \\Sigma_{f,1} = 0.042\\,\\text{cm}^{-1}$。\n$\\Sigma_{a,2} = 0.09\\,\\text{cm}^{-1}$，$\\Sigma_{s,2 \\to 1} = 0.015\\,\\text{cm}^{-1}$，$\\nu \\Sigma_{f,2} = 0.175\\,\\text{cm}^{-1}$。\n$\\chi_1 = 0.92$, $\\chi_2 = 0.08$。\n\n对于矩阵 $A$：\n$A_{11} = \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2} = 0.07 + 0.21 = 0.28\\,\\text{cm}^{-1}$\n$A_{12} = -\\Sigma_{s,2 \\to 1} = -0.015\\,\\text{cm}^{-1}$\n$A_{21} = -\\Sigma_{s,1 \\to 2} = -0.21\\,\\text{cm}^{-1}$\n$A_{22} = \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1} = 0.09 + 0.015 = 0.105\\,\\text{cm}^{-1}$\n$$\nA = \\begin{pmatrix} 0.28  -0.015 \\\\ -0.21  0.105 \\end{pmatrix}\\,\\text{cm}^{-1}\n$$\n\n对于矩阵 $B$：\n$B_{11} = \\chi_1 \\nu\\Sigma_{f,1} = 0.92 \\times 0.042 = 0.03864\\,\\text{cm}^{-1}$\n$B_{12} = \\chi_1 \\nu\\Sigma_{f,2} = 0.92 \\times 0.175 = 0.161\\,\\text{cm}^{-1}$\n$B_{21} = \\chi_2 \\nu\\Sigma_{f,1} = 0.08 \\times 0.042 = 0.00336\\,\\text{cm}^{-1}$\n$B_{22} = \\chi_2 \\nu\\Sigma_{f,2} = 0.08 \\times 0.175 = 0.014\\,\\text{cm}^{-1}$\n$$\nB = \\begin{pmatrix} 0.03864  0.161 \\\\ 0.00336  0.014 \\end{pmatrix}\\,\\text{cm}^{-1}\n$$\n\n**任务2：说明 $A$ 和 $B$ 的维度和稀疏模式。**\n\n矩阵 $A$ 和矩阵 $B$ 的维度均为 $2 \\times 2$，对应于两个能量群。\n关于稀疏性，如果一个矩阵的许多元素为零，则该矩阵是稀疏的。在这种情况下，$A$ 和 $B$ 的所有元素都非零。因此，矩阵 $A$ 和 $B$ 都是稠密矩阵。\n\n**任务3：计算裂变源矢量 $q = B\\phi$ 和标量总裂变源 $S_f = q_1 + q_2$。**\n\n裂变源矢量 $q$ 表示每个能量群中单位体积内裂变中子的产生率。其计算公式为 $q = B\\phi$。总裂变源 $S_f$ 是 $q$ 的各分量之和。\n给定通量矢量：\n$$\n\\phi = \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix} = \\begin{pmatrix} 1.37 \\times 10^{13} \\\\ 2.62 \\times 10^{13} \\end{pmatrix} \\ \\text{cm}^{-2}\\,\\text{s}^{-1}\n$$\n总裂变源 $S_f$ 是单位时间单位体积内由裂变产生的总中子数。这由各群的裂变率乘以每次裂变产生的中子数后对所有群求和得到。\n$$\nS_f = \\sum_{g=1}^{2} \\nu\\Sigma_{f,g} \\phi_g = \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2\n$$\n注意 $S_f = q_1 + q_2 = (\\chi_1 + \\chi_2)(\\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2)$。由于裂变谱份额之和必须为1，即 $\\chi_1 + \\chi_2 = 0.92 + 0.08 = 1$，因此我们有 $S_f = q_1 + q_2$。\n我们直接计算 $S_f$：\n$$\nS_f = (0.042\\,\\text{cm}^{-1}) \\times (1.37 \\times 10^{13}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}) + (0.175\\,\\text{cm}^{-1}) \\times (2.62 \\times 10^{13}\\,\\text{cm}^{-2}\\,\\text{s}^{-1})\n$$\n$$\nS_f = (0.05754 \\times 10^{13}) + (0.4585 \\times 10^{13}) \\,\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\n$$\n$$\nS_f = 0.51604 \\times 10^{13} \\,\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\n$$\n$$\nS_f = 5.1604 \\times 10^{12} \\,\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\n$$\n问题要求最终答案四舍五入到五位有效数字。计算出的值 $5.1604 \\times 10^{12}$ 已经有五位有效数字。",
            "answer": "$$\n\\boxed{5.1604 \\times 10^{12}}\n$$"
        },
        {
            "introduction": "掌握了矩阵的构建后，我们来实践功率迭代算法的核心步骤。本练习模拟了单次迭代过程：利用当前的中子通量密度猜测值计算裂变源项，求解一个线性系统以更新通量密度，并估计新的本征值 $k$。完成这个练习能让你熟练掌握整个迭代求解过程的基本构件。",
            "id": "4241508",
            "problem": "考虑一维 (1D) 稳态单群中子扩散 $k$ 特征值问题，\n$$- \\frac{d}{dx}\\left(D(x)\\frac{d \\phi(x)}{dx}\\right) + \\Sigma_{a}(x)\\,\\phi(x) \\;=\\; \\frac{1}{k}\\,\\nu \\Sigma_{f}(x)\\,\\phi(x),$$\n其中 $D(x)$ 是扩散系数，$\\Sigma_{a}(x)$ 是吸收宏观截面，$\\nu\\Sigma_{f}(x)$ 是中子产生宏观截面，$\\phi(x)$ 是中子通量，$k$ 是有效增殖因子。在具有反射边界条件的等宽度三单元网格上，使用均匀网格有限差分格式离散后，空间算子和裂变产生算子可组装成以下矩阵：\n$$A \\;=\\; \\begin{pmatrix}\n1.1  -1  0 \\\\\n-1  2.1  -1 \\\\\n0  -1  1.1\n\\end{pmatrix}, \\qquad\nB \\;=\\; \\mathrm{diag}\\!\\big(0.1,\\;0.125,\\;0.1\\big).$$\n设当前迭代的通量矢量为\n$$\\phi^{(m)} \\;=\\; \\begin{pmatrix} 4 \\\\ 4 \\\\ 1 \\end{pmatrix},$$\n该矢量已使用由 $B$ 导出的权重归一化为单位总裂变源。定义裂变源归一化泛函 $S(\\psi)$ 为\n$$S(\\psi) \\;=\\; \\sum_{i=1}^{3} \\big[B\\big]_{ii}\\,\\psi_i \\;=\\; 0.1\\,\\psi_1 + 0.125\\,\\psi_2 + 0.1\\,\\psi_3.$$\n通过求解线性系统，执行一步幂迭代 (PI)：\n$$A\\,x \\;=\\; B\\,\\phi^{(m)},$$\n形成更新后的通量\n$$\\phi^{(m+1)} \\;=\\; \\frac{x}{S(x)}$$\n使得 $S\\!\\big(\\phi^{(m+1)}\\big) = 1$，并使用基于裂变的估计量来估计更新后的增殖因子 $k^{(m+1)}$。将最终的 $k^{(m+1)}$ 表示为一个无量纲实数，并将答案四舍五入到六位有效数字。",
            "solution": "单群中子扩散 $k$ 特征值问题可以写成如下算子形式：\n$$A\\,\\phi \\;=\\; \\frac{1}{k}\\,B\\,\\phi,$$\n其中 $A$ 代表泄漏和吸收，$B$ 代表裂变产生。整理可得\n$$A^{-1} B\\,\\phi \\;=\\; k\\,\\phi,$$\n所以 $A^{-1} B$ 的主特征值是 $k$。幂迭代 (PI) 步骤构造出\n$$y \\;=\\; A^{-1} B\\,\\phi^{(m)}$$\n通过求解 $A\\,x = B\\,\\phi^{(m)}$ 并令 $x = y$。如果通量由裂变源泛函 $S(\\cdot)$ 归一化，使得 $S\\!\\big(\\phi^{(m)}\\big)=1$，那么对于精确的特征对，有 $y = k\\,\\phi$ 成立，因此\n$$S(y) \\;=\\; S(k\\,\\phi) \\;=\\; k\\,S(\\phi) \\;=\\; k.$$\n因此，在裂变源归一化下，更新后增殖因子的基于裂变的估计量为\n$$k^{(m+1)} \\;=\\; S(x),$$\n并且更新后的通量通过 $\\phi^{(m+1)} = x/S(x)$ 进行缩放，以维持 $S\\!\\big(\\phi^{(m+1)}\\big) = 1$。\n\n现在我们用给定的数据进行计算。首先计算右侧项 $r = B\\,\\phi^{(m)}$：\n$$r \\;=\\; \\begin{pmatrix}\n0.1  0  0 \\\\\n0  0.125  0 \\\\\n0  0  0.1\n\\end{pmatrix}\n\\begin{pmatrix} 4 \\\\ 4 \\\\ 1 \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} 0.4 \\\\ 0.5 \\\\ 0.1 \\end{pmatrix}.$$\n求解线性系统 $A\\,x = r$，其中\n$$A \\;=\\; \\begin{pmatrix}\n1.1  -1  0 \\\\\n-1  2.1  -1 \\\\\n0  -1  1.1\n\\end{pmatrix}, \\qquad r \\;=\\; \\begin{pmatrix} 0.4 \\\\ 0.5 \\\\ 0.1 \\end{pmatrix}.$$\n将方程按分量写出：\n\\begin{align*}\n1.1\\,x_1 - x_2 = 0.4, \\\\\n-\\,x_1 + 2.1\\,x_2 - x_3 = 0.5, \\\\\n-\\,x_2 + 1.1\\,x_3 = 0.1.\n\\end{align*}\n从第一个方程，用 $x_1$ 表示 $x_2$：\n$$x_2 \\;=\\; 1.1\\,x_1 - 0.4.$$\n从第三个方程，用 $x_2$ 表示 $x_3$：\n$$1.1\\,x_3 \\;=\\; 0.1 + x_2 \\;\\;\\Rightarrow\\;\\; x_3 \\;=\\; \\frac{0.1 + x_2}{1.1} \\;=\\; \\frac{0.1 + 1.1x_1 - 0.4}{1.1} = x_1 - \\frac{3}{11}.$$\n将这些代入第二个方程：\n\\begin{align*}\n-\\,x_1 + 2.1\\,(1.1\\,x_1 - 0.4) - \\left(x_1 - \\frac{3}{11}\\right) = 0.5, \\\\\n(-1 + 2.31 - 1) x_1 -0.84 + \\frac{3}{11} = 0.5, \\\\\n0.31\\,x_1 = 0.5 + 0.84 - \\frac{3}{11}, \\\\\n\\frac{31}{100}\\,x_1 = 1.34 - \\frac{3}{11} = \\frac{134}{100} - \\frac{3}{11} = \\frac{1474-300}{1100} = \\frac{1174}{1100}.\n\\end{align*}\n求解 $x_1$：\n$$x_1 = \\frac{1174}{1100} \\cdot \\frac{100}{31} \\;=\\; \\frac{1174}{11 \\cdot 31} \\;=\\; \\frac{1174}{341}.$$\n然后求解 $x_2$ 和 $x_3$：\n\\begin{align*}\nx_2 = 1.1 \\cdot \\frac{1174}{341} - 0.4 = \\frac{11}{10} \\frac{1174}{341} - \\frac{2}{5} = \\frac{12914}{3410} - \\frac{1364}{3410} = \\frac{11550}{3410} = \\frac{1155}{341}, \\\\\nx_3 = \\frac{1174}{341} - \\frac{3}{11} = \\frac{1174}{341} - \\frac{93}{341} = \\frac{1081}{341}.\n\\end{align*}\n因此，\n$$x \\;=\\; \\begin{pmatrix} \\frac{1174}{341} \\\\ \\frac{1155}{341} \\\\ \\frac{1081}{341} \\end{pmatrix}.$$\n使用 $B$ 的对角线元素计算裂变源泛函 $S(x)$，该值即为新的本征值估计 $k^{(m+1)}$：\n\\begin{align*}\nk^{(m+1)} = S(x) = 0.1\\,x_1 + 0.125\\,x_2 + 0.1\\,x_3 \\\\\n= \\frac{1}{10}\\left(\\frac{1174}{341}\\right) + \\frac{1}{8}\\left(\\frac{1155}{341}\\right) + \\frac{1}{10}\\left(\\frac{1081}{341}\\right) \\\\\n= \\frac{1}{341} \\left( \\frac{1174}{10} + \\frac{1155}{8} + \\frac{1081}{10} \\right) \\\\\n= \\frac{1}{341} \\left( \\frac{4 \\cdot 1174 + 5 \\cdot 1155 + 4 \\cdot 1081}{40} \\right) \\\\\n= \\frac{1}{341 \\cdot 40} (4696 + 5775 + 4324) \\\\\n= \\frac{14795}{13640} = \\frac{2959}{2728}.\n\\end{align*}\n因此，基于裂变的估计量给出\n$$k^{(m+1)} \\;=\\; \\frac{2959}{2728} \\;\\approx\\; 1.084677419\\ldots.$$\n四舍五入到六位有效数字，得到\n$$k^{(m+1)} \\;\\approx\\; 1.08468.$$",
            "answer": "$$\\boxed{1.08468}$$"
        },
        {
            "introduction": "在实际应用中，仅仅观察本征值 $k$ 的稳定并不能保证中子通量密度分布（即本征函数）也已收敛，尤其是在优势比接近1的大型反应堆中。这种“假收敛”现象是一个关键的数值挑战。本练习旨在让你深入思考这一问题，并从理论上辨别出能够有效监测通量密度形状收敛情况的诊断方法，从而避免得出错误结论。",
            "id": "4241546",
            "problem": "在临界反应堆堆芯的中子输运计算中，$k$-本征值问题被描述为 $\\mathcal{L}\\,\\phi = \\dfrac{1}{k}\\,\\mathcal{F}\\,\\phi$，其中 $\\mathcal{L}$ 是流-碰撞算子，$\\mathcal{F}$ 是裂变产生算子，$\\phi$ 是中子通量，$k$ 是有效中子增殖因子。一个常见的求解器是幂迭代法，该方法通过重复求解一个固定源问题来构建序列 $\\{\\phi^{(n)},k^{(n)}\\}$，其裂变源由前一个迭代步导出并进行重归一化。在实践中，通常仅通过监测 $k^{(n)}$ 的稳定情况来评估收敛性。\n\n考虑一个具有反射边界条件和多群输运的三维压水堆 (PWR) 堆芯模拟。观测到的 $k^{(n)}$ 在大约 $50$ 次迭代后稳定在 $\\pm 10^{-5}$ 的范围内。然而，底层线性化裂变算子的谱隙很小，其优势比（定义为幂迭代算子第二大本征值的模与最大本征值的模之比）接近 $0.98$。假设算子和离散化产生了一个具有单一主本征对的良态 $k$-本征值问题，并且幂迭代使用标准的 $\\phi^{(n)}$ 归一化以保持总裂变源有界。您被要求分析在仅监测 $k^{(n)}$ 时可能出现的假收敛问题，并推荐额外的诊断方法以检测通量形状演化的停滞。\n\n除了监测 $k^{(n)}$ 外，以下哪些诊断方法是适当且理论上合理的，可用于检测通量形状的停滞或缓慢演化，从而避免假收敛？请选择所有适用项。\n\nA. 监测非线性残差 $r^{(n)} = \\mathcal{L}\\,\\phi^{(n)} - \\dfrac{1}{k^{(n)}}\\,\\mathcal{F}\\,\\phi^{(n)}$ 的范数，并且仅当 $\\|r^{(n)}\\|$ 在一个物理相关的范数下低于预设容差时才宣布收敛。\n\nB. 使用基于内积的余弦度量（例如 $1 - \\dfrac{|\\langle \\phi^{(n)}, \\phi^{(n-1)} \\rangle|}{\\|\\phi^{(n)}\\|\\,\\|\\phi^{(n-1)}\\|}$）比较连续的归一化通量形状，并要求该量很小。\n\nC. 仅依赖于增殖因子 $k^{(n)}$ 在一个严格容差内的稳定，因为 $k^{(n)}$ 必然在通量形状收敛之后才会稳定。\n\nD. 估计优势比和次主模的污染幅度（例如，通过 $\\phi^{(n)}$ 中连续差值之比），并在宣布收敛前，要求估计的污染低于阈值。\n\nE. 仅监测反应堆总功率 $P^{(n)} = \\int \\nu\\,\\Sigma_f(\\mathbf{r},E)\\,\\phi^{(n)}(\\mathbf{r},E)\\,\\mathrm{d}\\mathbf{r}\\,\\mathrm{d}E$，因为 $P^{(n)}$ 与 $k^{(n)}$ 成正比，足以指示收敛。\n\nF. 使用 Anderson 加速或其他外推方案的系数作为收敛的主要指标；小的系数意味着通量形状已经收敛。",
            "solution": "该问题描述了反应堆临界中子输运方程数值解中的一个常见挑战，特别是在使用幂迭代法时出现的“假收敛”现象。问题的核心在于本征值 ($k_{\\text{eff}}$) 和相应本征函数（中子通量形状 $\\phi$）收敛速率之间的差异。我们将首先验证问题陈述，然后对所提出的收敛诊断方法进行详细分析。\n\n### 问题验证\n\n- **第一步：提取已知条件**\n    - 控制方程是 $k$-本征值问题：$\\mathcal{L}\\,\\phi = \\dfrac{1}{k}\\,\\mathcal{F}\\,\\phi$。\n    - $\\mathcal{L}$ 是流-碰撞算子。\n    - $\\mathcal{F}$ 是裂变产生算子。\n    - $\\phi$ 是中子通量本征函数。\n    - $k$ 是有效中子增殖因子本征值。\n    - 数值方法是幂迭代法，生成序列 $\\{\\phi^{(n)}, k^{(n)}\\}$。\n    - 物理系统是具有反射边界条件和多群输运的三维压水堆 (PWR) 堆芯。\n    - 观测：$k^{(n)}$ 在大约 $50$ 次迭代后稳定在 $\\pm 10^{-5}$ 范围内。\n    - 谱特性：优势比接近 $0.98$。\n    - 假设：问题是具有单一主本征对的良态问题。\n    - 假设：使用标准归一化以保持总裂变源有界。\n    - 任务是识别除监测 $k^{(n)}$ 外，适当且理论上合理的诊断方法，以检测通量形状的停滞或缓慢演化。\n\n- **第二步：使用提取的已知条件进行验证**\n    - **科学性：** 该问题牢固地植根于标准的核反应堆理论和数值分析。k-本征值方程、幂迭代法和优势比的概念是该领域的基础。所述的 $0.98$ 的优势比对于大型、松耦合反应堆是现实的数值，并正确地指出了数值困难的来源。\n    - **良态性：** 问题明确假设这是一个具有单一主本征对的良态 k-本征值问题，这在此类分析中是标准的。问题本身是良态的，要求对诊断技术进行评估。\n    - **客观性：** 语言是技术性的、精确的，并且没有主观内容。\n\n- **第三步：结论与行动**\n    问题陈述在科学上是合理的、良态的且客观的。它在真实的科学背景下提出了一个经典且非平凡的数值分析挑战。该问题是**有效的**。我们继续进行求解。\n\n### 理论基础：幂迭代法的收敛性\n\n对于本征值问题 $M\\phi = k\\phi$，其中迭代算子为 $M = \\mathcal{L}^{-1}\\mathcal{F}$，幂迭代法生成一系列通量迭代值。一个任意的初始通量猜测 $\\phi^{(0)}$ 可以在算子 $M$ 的真实本征函数 $\\phi_i$ 基上展开：\n$$ \\phi^{(0)} = \\sum_{i=1}^{\\infty} c_i \\phi_i $$\n经过 $n$ 次迭代后，未归一化的通量 $\\tilde{\\phi}^{(n)}$ 由下式给出：\n$$ \\tilde{\\phi}^{(n)} = M^n \\phi^{(0)} = \\sum_{i=1}^{\\infty} c_i M^n \\phi_i = \\sum_{i=1}^{\\infty} c_i k_i^n \\phi_i $$\n其中 $k_i$ 是 $M$ 的本征值，按 $k_1  |k_2| \\geq |k_3| \\geq \\dots$ 排序。提出主本征值项 $k_1^n$：\n$$ \\tilde{\\phi}^{(n)} = k_1^n \\left( c_1 \\phi_1 + c_2 \\left(\\frac{k_2}{k_1}\\right)^n \\phi_2 + \\sum_{i=3}^{\\infty} c_i \\left(\\frac{k_i}{k_1}\\right)^n \\phi_i \\right) $$\n归一化的通量迭代值是 $\\phi^{(n)}$。通量形状的误差，即与基模 $\\phi_1$ 的偏差，主要由第二模 $\\phi_2$ 的贡献决定。该误差的大小与项 $(\\frac{k_2}{k_1})^n$ 成正比。优势比定义为 $\\rho = |k_2|/k_1$。给定的值为 $\\rho \\approx 0.98$。\n因此，本征矢量（通量形状）的误差收敛为：\n$$ \\|\\phi^{(n)} - \\phi_1\\| \\sim \\mathcal{O}(\\rho^n) = \\mathcal{O}(0.98^n) $$\n本征值估计 $k^{(n)}$ 是一个全局量，通常使用类似于瑞利商的方法计算。对于像 $M$ 这样的非自伴算子，这种估计的收敛通常明显快于本征矢量的收敛。理论上，本征值的误差收敛为：\n$$ |k^{(n)} - k_1| \\sim \\mathcal{O}(\\rho^{2n}) = \\mathcal{O}(0.98^{2n}) $$\n当 $\\rho = 0.98$ 时，通量形状误差衰减非常缓慢。经过 $n=50$ 次迭代后，误差估计为其初始值的 $(0.98)^{50} \\approx 0.364$ 倍。相比之下，本征值误差已衰减了 $(0.98)^{100} \\approx 0.133$ 倍。每次迭代中 $k^{(n)}$ 的变化 $|\\Delta k^{(n)}|$ 将会更小，从而给人以收敛的假象。任务是找到能够追踪通量形状缓慢的 $\\mathcal{O}(\\rho^n)$ 收敛的诊断方法。\n\n### 逐项分析\n\n**A. 监测非线性残差 $r^{(n)} = \\mathcal{L}\\,\\phi^{(n)} - \\dfrac{1}{k^{(n)}}\\,\\mathcal{F}\\,\\phi^{(n)}$ 的范数，并且仅当 $\\|r^{(n)}\\|$ 在一个物理相关的范数下低于预设容差时才宣布收敛。**\n残差 $r^{(n)}$ 衡量当前迭代对 $(\\phi^{(n)}, k^{(n)})$ 满足底层本征值方程的程度。一个真实的本征对 $(\\phi_1, k_1)$ 会产生零残差。在迭代过程中，我们可以使用更新步骤来表示残差，更新步骤通常形式为 $\\mathcal{L}\\phi^{(n)} = \\frac{1}{k_{src}} \\mathcal{F}\\phi^{(n-1)}$（其中 $k_{src}$ 可能是 $k^{(n-1)}$）。\n$$ r^{(n)} = \\frac{1}{k_{src}} \\mathcal{F}\\phi^{(n-1)} - \\frac{1}{k^{(n)}} \\mathcal{F}\\phi^{(n)} $$\n此表达式表明，残差是连续裂变源（$\\mathcal{F}\\phi$）之间差异的函数。随着迭代收敛，$\\phi^{(n)} \\rightarrow \\phi^{(n-1)}$ 且 $k^{(n)} \\rightarrow k^{(n-1)}$。$\\|r^{(n)}\\|$ 趋于零的速率由 $\\phi^{(n)}$ 收敛到 $\\phi_1$ 的速率决定，即 $\\mathcal{O}(\\rho^n)$。因此，监测该残差的范数是追踪通量形状收敛的一种直接且理论上合理的方法。\n**结论：正确**\n\n**B. 使用基于内积的余弦度量（例如 $1 - \\dfrac{|\\langle \\phi^{(n)}, \\phi^{(n-1)} \\rangle|}{\\|\\phi^{(n)}\\|\\,\\|\\phi^{(n-1)}\\|}$）比较连续的归一化通量形状，并要求该量很小。**\n该度量衡量两个连续迭代的通量矢量之间的夹角。如果通量形状不再改变，矢量将是平行的，该度量将为零。连续迭代之间的变化 $\\phi^{(n)} - \\phi^{(n-1)}$ 由下式给出：\n$$ \\phi^{(n)} - \\phi^{(n-1)} \\approx C \\left( \\rho^n - \\rho^{n-1} \\right) \\phi_2 = C \\rho^{n-1}(\\rho - 1) \\phi_2 $$\n其中 $C$ 是某个归一化常数。这个差值的范数 $\\|\\phi^{(n)} - \\phi^{(n-1)}\\|$ 以 $\\mathcal{O}(\\rho^n)$ 的速率减小。所提出的余弦度量与该范数直接相关（对于小角度， $1-\\cos\\theta \\approx \\theta^2/2$，而 $\\theta$ 与 $\\|\\phi^{(n)} - \\phi^{(n-1)}\\|$ 相关）。因此，该度量收敛到零的过程受通量形状缓慢收敛速率的支配。这是对通量形状本身“停滞或缓慢演化”的直接度量。\n**结论：正确**\n\n**C. 仅依赖于增殖因子 $k^{(n)}$ 在一个严格容差内的稳定，因为 $k^{(n)}$ 必然在通量形状收敛之后才会稳定。**\n这个陈述根本上是有缺陷的，并且代表了问题试图解决的那个误解。如理论基础部分所述，本征值的误差 $|k^{(n)} - k_1|$ 以 $\\mathcal{O}(\\rho^{2n})$ 的速率收敛，而本征函数的误差 $\\|\\phi^{(n)} - \\phi_1\\|$ 以 $\\mathcal{O}(\\rho^n)$ 的速率收敛。由于 $\\rho  1$，本征值总是比本征函数收敛得更快（对于 $\\rho=0.98$，在指数项上快两倍）。因此，$k^{(n)}$ 能够并且将会在通量形状收敛到所需容差之前很久就表现出稳定。该选项的前提在事实上是不正确的。\n**结论：不正确**\n\n**D. 估计优势比和次主模的污染幅度（例如，通过 $\\phi^{(n)}$ 中连续差值之比），并在宣布收敛前，要求估计的污染低于阈值。**\n这描述了一种先进且强大的诊断技术。通过分析迭代序列，可以估计控制收敛的关键参数。通量矢量连续差值的范数之比提供了对优势比的估计：\n$$ \\frac{\\|\\phi^{(n)} - \\phi^{(n-1)}\\|}{\\|\\phi^{(n-1)} - \\phi^{(n-2)}\\|} \\approx \\frac{\\|\\rho^{n-1}(\\rho - 1) c_2 \\phi_2\\|}{\\|\\rho^{n-2}(\\rho - 1) c_2 \\phi_2\\|} = \\rho $$\n一旦 $\\rho$ 已知或被估计，就可以估计当前迭代中误差的大小。误差为 $e^{(n-1)} = \\phi^{(n-1)} - \\phi_1 \\approx c_2 \\rho^{n-1}\\phi_2$。差值为 $\\delta^{(n)} = \\phi^{(n)} - \\phi^{(n-1)} \\approx e^{(n-1)}(\\rho-1)$。因此，误差范数的估计为 $\\|e^{(n-1)}\\| \\approx \\frac{\\|\\delta^{(n)}\\|}{|1-\\rho|}$。要求这个估计的误差低于阈值是对通量本征函数实际收敛的直接、定量的评估。该方法在理论上是严谨的。\n**结论：正确**\n\n**E. 仅监测反应堆总功率 $P^{(n)} = \\int \\nu\\,\\Sigma_f(\\mathbf{r},E)\\,\\phi^{(n)}(\\mathbf{r},E)\\,\\mathrm{d}\\mathbf{r}\\,\\mathrm{d}E$，因为 $P^{(n)}$ 与 $k^{(n)}$ 成正比，足以指示收敛。**\n该选项的理由中存在一个关键缺陷。在幂迭代中，通量 $\\phi^{(n)}$ 的绝对大小是无关紧要的，并且在每次迭代中通过归一化条件（例如，归一化总裂变源）重置。本征值 $k$ 关联了中子产生率与损失率，并且在临界反应堆中与绝对功率水平无关。功率 $P^{(n)}$ 是通量 $\\phi^{(n)}$ 的一个积分性质。虽然通量归一化是任意的，但一个一致的归一化方案将导致一个特定的 $P^{(n)}$ 值。$P^{(n)}$ 的误差将是 $\\phi^{(n)}$ 误差的线性泛函，因此将以相同的缓慢速率 $\\mathcal{O}(\\rho^n)$ 收敛。所以，监测 $P^{(n)}$ 确实比监测 $k^{(n)}$ 更能指示通量的收敛。然而，其给出的理由“因为 $P^{(n)}$ 与 $k^{(n)}$ 成正比”是根本错误的。在模拟中，$k^{(n)}$ 趋于一个常数 ($k_1$)，而计算出的功率 $P^{(n)}$ 取决于为 $\\phi^{(n)}$ 选择的任意归一化。它们之间没有普遍的比例关系。考虑到科学正确性的严格标准，一个理由错误的选项是不可接受的。\n**结论：不正确**\n\n**F. 使用 Anderson 加速或其他外推方案的系数作为收敛的主要指标；小的系数意味着通量形状已经收敛。**\n该选项误解了像 Anderson 加速这样的外推方案中系数的作用。Anderson 加速（或混合）结合了历史迭代值和残差来形成一个更好的下一个迭代值。它通过求解一个小的最小二乘问题来找到最优混合系数 $\\alpha_i$。其目标是最小化新残差的范数。在这种方案中，收敛的指标是这个最小化残差的范数，而不是系数 $\\alpha_i$ 本身的值。最优系数取决于迭代的整个近期历史，并且与解的邻近度没有简单、直接的关系。小的残差范数表示收敛；系数仅仅是用于实现那个小残差的权重，并不是一个可靠的主要诊断方法。\n**结论：不正确**",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}