{
    "hands_on_practices": [
        {
            "introduction": "掌握Wielandt偏移加速技术的第一步是理解如何选择偏移参数$w$以达到预期的收敛效果。这个练习将引导你推导一个直接的公式，该公式将系统的谱特性（优势比 $\\hat{d}$）、目标收敛因子 $r^{\\ast}$ 与控制参数$w$联系起来。通过这个实践，你将学会如何根据问题的内在属性和性能要求来精确设定偏移量。",
            "id": "4261247",
            "problem": "在临界反应堆的稳态中子输运中，基模本征问题可以抽象地写为裂变源的算子不动点问题，其中有界线性算子 $\\mathcal{T}$ 将归一化的通量迭代值映射到下一代。在标准的迭代值归一化下，$\\mathcal{T}$ 的主特征值为 $1$，次主特征值的大小等于优势比 $\\hat{d}$，其中 $0  \\hat{d}  1$。考虑一个受经典 Wielandt 移位启发的加速方案：每次外迭代应用由以下公式隐式定义的基于预解式的映射：\n$$(\\mathcal{I} - w\\,\\mathcal{T})\\,\\phi^{(m+1)} = \\mathcal{T}\\,\\phi^{(m)},$$\n其中标量参数 $w$ 的选择是为了减小每次外迭代次主模的渐近误差收缩。假设迭代是稳定的，即 $0 \\le w  1/\\hat{d}$，从而 $(\\mathcal{I} - w\\,\\mathcal{T})$ 在相关的不变子空间上是可逆的。\n\n从 $\\mathcal{T}$ 的谱特性和上述预解式映射的定义出发，确定使渐近误差收缩因子等于一个预定目标值 $r^{\\ast}$ 的 $w$ 值，其中 $0  r^{\\ast}  1$。使用以下数据：$\\hat{d} = 0.9$ 和 $r^{\\ast} = 0.3$。\n\n将你的答案表示为一个无量纲的标量，并将结果四舍五入到四位有效数字。",
            "solution": "该问题要求在一个用于中子输运本征问题的 Wielandt 式加速方案中，确定参数 $w$ 的值，使得渐近误差收缩因子为一个指定值 $r^{\\ast}$。\n\n首先，我们必须形式化迭代过程，并确定控制误差传播的算子。给定的迭代方案由以下隐式关系定义：\n$$(\\mathcal{I} - w\\,\\mathcal{T})\\,\\phi^{(m+1)} = \\mathcal{T}\\,\\phi^{(m)}$$\n其中 $\\mathcal{I}$ 是单位算子，$\\mathcal{T}$ 是临界系统的裂变源算子，$\\phi^{(m)}$ 是第 $m$ 步的通量迭代值，$w$ 是实值移位参数。\n\n通过形式上对左侧的算子求逆，我们可以定义将 $\\phi^{(m)}$ 映射到 $\\phi^{(m+1)}$ 的显式迭代算子 $\\mathcal{M}$：\n$$\\phi^{(m+1)} = (\\mathcal{I} - w\\,\\mathcal{T})^{-1}\\mathcal{T}\\,\\phi^{(m)} \\equiv \\mathcal{M}\\,\\phi^{(m)}$$\n逆 $(\\mathcal{I} - w\\,\\mathcal{T})^{-1}$ 的存在性由问题的稳定性条件 $0 \\le w  1/\\hat{d}$ 保证，这确保了 $1$ 不是 $w\\mathcal{T}$ 的特征值。\n\n设 $\\lambda_k$ 为算子 $\\mathcal{T}$ 的特征值，$\\psi_k$ 为相应的特征向量，使得 $\\mathcal{T}\\psi_k = \\lambda_k \\psi_k$。$\\mathcal{T}$ 的特征向量也是任何作为 $\\mathcal{T}$ 函数的算子（如 $\\mathcal{M}$）的特征向量。我们记 $\\mathcal{M}$ 的特征值为 $\\mu_k$，可通过将 $\\mathcal{M}$ 应用于特征向量 $\\psi_k$ 来求得：\n$$\\mathcal{M}\\psi_k = (\\mathcal{I} - w\\,\\mathcal{T})^{-1}\\mathcal{T}\\psi_k = (\\mathcal{I} - w\\,\\mathcal{T})^{-1}(\\lambda_k \\psi_k) = \\frac{1}{1-w\\lambda_k}(\\lambda_k \\psi_k) = \\frac{\\lambda_k}{1-w\\lambda_k}\\psi_k$$\n因此，迭代算子 $\\mathcal{M}$ 的特征值由映射 $\\mu_k = \\frac{\\lambda_k}{1-w\\lambda_k}$ 给出。\n\n问题指出，对于原始算子 $\\mathcal{T}$，主特征值为 $\\lambda_1 = 1$，对应于基模解 $\\psi_1$。对于 $k > 1$，次主特征值 $\\lambda_k$ 的大小受优势比 $\\hat{d}$ 的限制，即对所有 $k > 1$ 都有 $|\\lambda_k| \\le \\hat{d}$。\n\n该迭代是一种类幂法，其向基模的收敛速度取决于其他本征模（误差）相对于基模的衰减速度。设迭代值可分解为 $\\phi^{(m)} = c_1^{(m)}\\psi_1 + \\sum_{k=2}^N c_k^{(m)}\\psi_k$。应用算子 $\\mathcal{M}$ 得到：\n$$\\phi^{(m+1)} = c_1^{(m)}\\mu_1 \\psi_1 + \\sum_{k=2}^N c_k^{(m)}\\mu_k \\psi_k$$\n特征向量 $\\psi_1$ 对应于特征值 $\\mu_1 = \\frac{\\lambda_1}{1-w\\lambda_1} = \\frac{1}{1-w}$。与 $k>1$ 的 $\\psi_k$ 相关联的误差分量被因子 $\\mu_k$ 放大。每次迭代后，解通常会被重新归一化。在幂法的背景下，这意味着误差传播由 $\\mathcal{M}$ 的次主特征值与 $\\mathcal{M}$ 的主特征值之比决定。\n\n因此，渐近误差收缩因子 $r$ 是误差传播算子的谱半径，由下式给出：\n$$r = \\sup_{k>1} \\left| \\frac{\\mu_k}{\\mu_1} \\right| = \\sup_{k>1} \\left| \\frac{\\lambda_k / (1 - w\\lambda_k)}{1 / (1-w)} \\right| = \\sup_{k>1} \\left| \\frac{\\lambda_k(1-w)}{1-w\\lambda_k} \\right|$$\n问题指定 $0 \\le w  1/\\hat{d}$。为使该方案成为一种加速方法，我们期望 $r  \\hat{d}$，这将意味着 $0 \\le w  1$（稍后会证明）。假设如此，则 $|1-w| = 1-w$。$r$ 的表达式变为：\n$$r = (1-w) \\sup_{k>1} \\left| \\frac{\\lambda_k}{1-w\\lambda_k} \\right|$$\n问题给出了次主特征值的谱界为 $\\sup_{k>1}|\\lambda_k| = \\hat{d}$。根据解析函数的最大模原理，函数 $|\\lambda / (1-w\\lambda)|$ 在圆盘 $|\\lambda| \\le \\hat{d}$ 上的最大值必然出现在其边界 $|\\lambda|=\\hat{d}$ 上。所以我们需要找到：\n$$r = (1-w) \\max_{|\\lambda|=\\hat{d}} \\left| \\frac{\\lambda}{1-w\\lambda} \\right| = (1-w) \\frac{\\hat{d}}{\\min_{|\\lambda|=\\hat{d}}|1-w\\lambda|}$$\n设 $\\lambda = \\hat{d} e^{i\\theta}$。需要最小化的项是 $|1-w\\hat{d}e^{i\\theta}|^2$：\n$$|1-w\\hat{d}e^{i\\theta}|^2 = |(1-w\\hat{d}\\cos\\theta) - i(w\\hat{d}\\sin\\theta)|^2 = (1-w\\hat{d}\\cos\\theta)^2 + (w\\hat{d}\\sin\\theta)^2 = 1 - 2w\\hat{d}\\cos\\theta + w^2\\hat{d}^2$$\n由于 $w > 0$ 和 $\\hat{d} > 0$，当 $\\cos\\theta$ 取最大值，即 $\\cos\\theta=1$ 时，该表达式最小。这对应于实特征值 $\\lambda = \\hat{d}$。因此 $|1-w\\lambda|$ 的最小值为 $|1-w\\hat{d}|$。给定的稳定性条件 $w  1/\\hat{d}$ 确保了 $w\\hat{d}  1$，所以 $1-w\\hat{d} > 0$。\n因此，渐近误差收缩因子为：\n$$r = (1-w) \\frac{\\hat{d}}{1-w\\hat{d}}$$\n我们已知该因子应等于一个目标值 $r^{\\ast}$。现在我们可以解出 $w$：\n$$r^{\\ast} = \\frac{(1-w)\\hat{d}}{1-w\\hat{d}}$$\n$$r^{\\ast}(1-w\\hat{d}) = \\hat{d}(1-w)$$\n$$r^{\\ast} - r^{\\ast}w\\hat{d} = \\hat{d} - w\\hat{d}$$\n$$w\\hat{d} - r^{\\ast}w\\hat{d} = \\hat{d} - r^{\\ast}$$\n$$w\\hat{d}(1 - r^{\\ast}) = \\hat{d} - r^{\\ast}$$\n$$w = \\frac{\\hat{d} - r^{\\ast}}{\\hat{d}(1 - r^{\\ast})}$$\n问题提供了数值 $\\hat{d} = 0.9$ 和 $r^{\\ast} = 0.3$。将这些值代入 $w$ 的表达式：\n$$w = \\frac{0.9 - 0.3}{0.9(1 - 0.3)} = \\frac{0.6}{0.9 \\times 0.7} = \\frac{0.6}{0.63}$$\n$$w = \\frac{60}{63} = \\frac{20}{21}$$\n将答案以四舍五入到四位有效数字的小数形式表示：\n$$w \\approx 0.95238095...$$\n四舍五入到四位有效数字得到 $0.9524$。\n\n我们验证此结果与我们的假设一致。由于 $0  r^{\\ast}  \\hat{d}  1$，分子 $(\\hat{d}-r^{\\ast})$ 和分母 $\\hat{d}(1-r^{\\ast})$ 均为正，因此 $w>0$。此外，因为 $\\hat{d}1$ 意味着 $r^{\\ast}/\\hat{d} > r^{\\ast}$，所以 $w = \\frac{1-r^{\\ast}/\\hat{d}}{1-r^{\\ast}}  1$。因此，假设 $0 \\le w  1$ 是正确的。稳定性条件 $w  1/\\hat{d} = 1/0.9 \\approx 1.111$ 也得到满足，因为 $0.9524  1.111$。\n最终结果是 $w$ 的数值。",
            "answer": "$$\\boxed{0.9524}$$"
        },
        {
            "introduction": "在实际应用中，我们通常无法精确知道用于构造最佳偏移的基态特征值 $k_1$，而是使用一个迭代过程中的估计值 $k$。这个练习探讨了这种不精确性带来的实际后果，要求你分析收敛因子对 $k$ 估计误差的敏感性。这能帮助你更深入地理解该方法的鲁棒性，并为设计自适应偏移策略提供理论基础。",
            "id": "4261257",
            "problem": "在基于中子输运的核反应堆模拟中，稳态中子倍增因子由广义特征问题 $F \\phi = k A \\phi$ 定义，其中 $F$ 是线性裂变产生算子， $A$ 是线性移出（损失和散射）算子， $k$ 是有效倍增因子，$\\phi$ 是中子通量特征函数。在幂迭代法中，相关的迭代算子是 $T := A^{-1} F$，其特征值是 $k$-特征值 $\\{k_i\\}$，按大小排序为 $k_1 > k_2 > \\cdots$。每次迭代的渐近误差收缩由比率 $|k_2/k_1|$ 控制。\n\n引入 Wielandt 移位法通过修改迭代中使用的算子来加速收敛。考虑无量纲移位参数 $w \\in \\mathbb{R}$ 和当前近似倍增因子 $k \\neq k_1$。定义移位迭代算子\n$$\nT_w(k) := \\left(A - \\frac{w}{k} F\\right)^{-1} F,\n$$\n这是在这种广义特征值设定下 Wielandt 加速法的标准形式。从上述定义出发，推导与 $T_w(k)$ 相关的渐近收缩因子（用 $k$、$k_1$、$k_2$ 和 $w$ 表示），然后得到该收缩因子对数对 $k$ 的灵敏度的解析表达式，即 $\\frac{d}{dk}\\ln r_w(k)$。\n\n假设反应堆状态为 $k_1 = 1.00$ 和 $k_2 = 0.95$，进行符号推导，然后在 $k = 0.98$ 和 $w = 0.60$ 处评估您的灵敏度表达式。将最终答案表示为单个实数，并四舍五入到四位有效数字。灵敏度是无量纲的；最终数值中不要包含任何单位。",
            "solution": "第一步是确定移位算子 $T_w(k)$ 的特征值。设 $\\lambda_i$ 为 $T_w(k)$ 对应于特征函数 $\\psi_i$ 的特征值。$T_w(k)$ 的特征问题是：\n$$\nT_w(k) \\psi_i = \\lambda_i \\psi_i\n$$\n代入 $T_w(k)$ 的定义：\n$$\n\\left(A - \\frac{w}{k} F\\right)^{-1} F \\psi_i = \\lambda_i \\psi_i\n$$\n从左侧乘以可逆算子 $\\left(A - \\frac{w}{k} F\\right)$ 得：\n$$\nF \\psi_i = \\lambda_i \\left(A - \\frac{w}{k} F\\right) \\psi_i\n$$\n$$\nF \\psi_i = \\lambda_i A \\psi_i - \\frac{\\lambda_i w}{k} F \\psi_i\n$$\n重新整理各项，将算子 $F$ 和 $A$ 分组：\n$$\n\\left(1 + \\frac{\\lambda_i w}{k}\\right) F \\psi_i = \\lambda_i A \\psi_i\n$$\n这可以写成原始广义特征问题的形式：\n$$\nF \\psi_i = \\left( \\frac{\\lambda_i}{1 + \\frac{\\lambda_i w}{k}} \\right) A \\psi_i\n$$\n通过与原始特征问题 $F \\phi_i = k_i A \\phi_i$ 比较，我们发现移位算子 $T_w(k)$ 与原始问题共享相同的特征函数，即 $\\psi_i = \\phi_i$。原始问题的特征值 $k_i$ 与移位算子的特征值 $\\lambda_i$ 的关系如下：\n$$\nk_i = \\frac{\\lambda_i}{1 + \\frac{\\lambda_i w}{k}}\n$$\n我们现在求解这个方程以得到 $\\lambda_i$，从而用原始特征值表示新的特征值：\n$$\nk_i \\left(1 + \\frac{\\lambda_i w}{k}\\right) = \\lambda_i\n$$\n$$\nk_i + \\frac{k_i \\lambda_i w}{k} = \\lambda_i\n$$\n$$\nk_i = \\lambda_i \\left(1 - \\frac{k_i w}{k}\\right)\n$$\n$$\n\\lambda_i = \\frac{k_i}{1 - \\frac{k_i w}{k}} = \\frac{k_i k}{k - k_i w}\n$$\n幂迭代法收敛到与模最大的特征值相对应的特征函数。为使 Wielandt 移位法能有效加速收敛到基模（对应于 $k_1$），$|\\lambda_1|$ 必须是最大的特征值，而渐近收缩因子 $r_w(k)$ 是第二大特征值的模与最大特征值的模之比。假设特征值谱的排序使得第二主导模对应于 $k_2$，则该因子为：\n$$\nr_w(k) = \\frac{|\\lambda_2|}{|\\lambda_1|} = \\frac{\\left| \\frac{k_2 k}{k - k_2 w} \\right|}{\\left| \\frac{k_1 k}{k - k_1 w} \\right|}\n$$\n鉴于 $k_1$、$k_2$ 和 $k$ 都是正的物理量（倍增因子），我们可以将其简化为：\n$$\nr_w(k) = \\frac{k_2}{k_1} \\frac{|k - k_1 w|}{|k - k_2 w|}\n$$\n这是渐近收缩因子的符号表达式。现在我们根据给定参数评估绝对值函数内部各项的符号：$k_1 = 1.00$、$k_2 = 0.95$、$k = 0.98$ 和 $w = 0.60$。\n$$\nk - k_1 w = 0.98 - (1.00)(0.60) = 0.98 - 0.60 = 0.38\n$$\n$$\nk - k_2 w = 0.98 - (0.95)(0.60) = 0.98 - 0.57 = 0.41\n$$\n由于两项均为正，我们可以去掉绝对值符号：\n$$\nr_w(k) = \\frac{k_2}{k_1} \\left( \\frac{k - k_1 w}{k - k_2 w} \\right)\n$$\n接下来，我们求该收缩因子的对数：\n$$\n\\ln r_w(k) = \\ln\\left(\\frac{k_2}{k_1}\\right) + \\ln(k - k_1 w) - \\ln(k - k_2 w)\n$$\n问题要求这个对数相对于 $k$ 的灵敏度，即其导数 $\\frac{d}{dk} \\ln r_w(k)$。设该灵敏度为 $S_w(k)$。\n$$\nS_w(k) = \\frac{d}{dk} \\left[ \\ln\\left(\\frac{k_2}{k_1}\\right) + \\ln(k - k_1 w) - \\ln(k - k_2 w) \\right]\n$$\n第一项是关于 $k$ 的常数，因此其导数为零。对对数项应用链式法则：\n$$\nS_w(k) = 0 + \\frac{1}{k - k_1 w} \\cdot \\frac{d}{dk}(k - k_1 w) - \\frac{1}{k - k_2 w} \\cdot \\frac{d}{dk}(k - k_2 w)\n$$\n$$\nS_w(k) = \\frac{1}{k - k_1 w} - \\frac{1}{k - k_2 w}\n$$\n这是灵敏度的解析表达式。我们可以合并分数以得到单个表达式：\n$$\nS_w(k) = \\frac{(k - k_2 w) - (k - k_1 w)}{(k - k_1 w)(k - k_2 w)} = \\frac{k - k_2 w - k + k_1 w}{(k - k_1 w)(k - k_2 w)} = \\frac{w(k_1 - k_2)}{(k - k_1 w)(k - k_2 w)}\n$$\n最后，我们在 $k = 0.98$ 和 $w = 0.60$ 处，使用 $k_1 = 1.00$ 和 $k_2 = 0.95$ 对该表达式进行求值。\n$$\nS_w(0.98) = \\frac{0.60(1.00 - 0.95)}{(0.98 - 1.00 \\times 0.60)(0.98 - 0.95 \\times 0.60)}\n$$\n$$\nS_w(0.98) = \\frac{0.60(0.05)}{(0.98 - 0.60)(0.98 - 0.57)}\n$$\n$$\nS_w(0.98) = \\frac{0.03}{(0.38)(0.41)}\n$$\n$$\nS_w(0.98) = \\frac{0.03}{0.1558} \\approx 0.1925545571...\n$$\n将结果四舍五入到四位有效数字，得到 $0.1926$。",
            "answer": "$$\\boxed{0.1926}$$"
        },
        {
            "introduction": "理论知识的最终考验在于其能否指导实践，尤其是在验证和调试复杂的数值模拟程序时。本练习模拟了一个真实场景：一个本应被Wielandt偏移加速的求解器表现未达预期。你需要扮演一名数值分析侦探，利用对算子谱理论的理解，通过对比理论预测与观测结果，诊断出程序中潜在的实现错误。",
            "id": "4261207",
            "problem": "考虑一个压水反应堆堆芯的二维中子扩散 $k$-特征值问题，其算子形式写作 $A \\phi = \\frac{1}{k} F \\phi$，其中 $A$ 是损失算子，$F$ 是裂变产生算子。定义传播算子 $T = A^{-1} F$，使得右特征对 $(k_i, v_i)$ 满足 $T v_i = k_i v_i$，其中 $k_1  k_2  \\dots  0$。通过算子 $S = (T - \\omega I)^{-1} T$ 和一个标量移位 $\\omega$ 实现了一个 Wielandt 移位幂迭代。\n\n为了验证该实现，您测量了迭代向量在前两个右本征模上的投影每次迭代的衰减情况。设双正交伴随（左）特征向量 $(w_i)$ 满足 $w_i^{\\top} v_j = \\delta_{ij}$，并为第 $m$ 次迭代的向量 $\\phi^{(m)}$ 定义模态含量 $a_i^{(m)} = w_i^{\\top} \\phi^{(m)}$。观测到的第二模态相对于第一模态的每次迭代相对衰减因子计算如下：\n$$r_{\\mathrm{obs}} \\approx \\frac{a_2^{(m+1)}/a_1^{(m+1)}}{a_2^{(m)}/a_1^{(m)}}.$$\n在一个测试问题中，已知主导和次主导增殖因子（来自一个独立的高精度求解器）分别为 $k_1 = 1.000$ 和 $k_2 = 0.90$，代码中使用的 Wielandt 移位为 $\\omega = 0.99$。验证测量报告显示 $r_{\\mathrm{obs}} \\approx +0.90$，且在迭代过程中没有符号交替。\n\n利用线性算子理论的第一性原理和 Wielandt 移位迭代的定义，推导在正确的 Wielandt 移位下第二模态的理论预期相对衰减因子 $r_w$，并将其与观测值进行比较。然后，为这种差异选择最一致的诊断。哪个选项最能解释这些观测结果？\n\nA. Wielandt 移位没有被应用到有效迭代算子上；代码实际上是在对 $T$ 执行标准幂迭代，从而得到 $r_{\\mathrm{obs}} \\approx k_2/k_1$，并且没有符号交替。\n\nB. 内部线性求解器的容差太松，使得每次迭代的总体误差收缩率实际上为 1；观测到的 $r_{\\mathrm{obs}} \\approx 0.90$ 表明接近停滞。\n\nC. 移位被错误地实现为应用 $(T - \\omega I)^{-1}$ 而没有后乘以 $T$，这将得到 $r_{\\mathrm{obs}} \\approx \\left|\\frac{k_1 - \\omega}{k_2 - \\omega}\\right|$。\n\nD. 模态投影诊断使用了一个非双正交的内积，这污染了测量的 $a_i^{(m)}$，即使在 Wielandt 移位正确实现的情况下，也造成了大的系统性偏差。",
            "solution": "任务的核心是推导正确实现的 Wielandt 移位的理论相对衰减因子 $r_w$，并将其与观测值 $r_{\\mathrm{obs}}$进行比较。\n\n**1. Wielandt 移位算子的特征值**\n\nWielandt 移位迭代过程为 $\\phi^{(m+1)} \\propto S \\phi^{(m)}$，其中迭代算子为 $S = (T - \\omega I)^{-1} T$。为了理解其收敛性，我们必须找到 $S$ 的特征值。设 $v_i$ 是 $T$ 的一个特征向量，其特征值为 $k_i$，使得 $T v_i = k_i v_i$。\n\n将算子 $S$ 应用于特征向量 $v_i$：\n$$ S v_i = (T - \\omega I)^{-1} T v_i = (T - \\omega I)^{-1} (k_i v_i) $$\n由于 $k_i$ 是一个标量，它与算子可交换：\n$$ S v_i = k_i (T - \\omega I)^{-1} v_i $$\n算子 $(T - \\omega I)$ 作用于 $v_i$ 的结果是 $(T - \\omega I) v_i = T v_i - \\omega v_i = k_i v_i - \\omega v_i = (k_i - \\omega)v_i$。因此，$v_i$ 也是 $(T - \\omega I)$ 的一个特征向量，其特征值为 $(k_i - \\omega)$。因此，$v_i$ 是逆算子 $(T - \\omega I)^{-1}$ 的一个特征向量，其特征值为 $(k_i - \\omega)^{-1}$。\n$$ (T - \\omega I)^{-1} v_i = \\frac{1}{k_i - \\omega} v_i $$\n将此代回 $S v_i$ 的表达式中：\n$$ S v_i = k_i \\left( \\frac{1}{k_i - \\omega} v_i \\right) = \\left( \\frac{k_i}{k_i - \\omega} \\right) v_i $$\n因此，算子 $S$ 与 $T$ 具有相同的特征向量 $v_i$，其特征值（我们称之为 $\\lambda_i$）由下式给出：\n$$ \\lambda_i = \\frac{k_i}{k_i - \\omega} $$\n\n**2. 迭代的渐近行为**\n\n初始向量 $\\phi^{(0)}$ 可以在特征向量基中展开：$\\phi^{(0)} = \\sum_i a_i^{(0)} v_i$。经过 $m$ 次迭代后，忽略归一化，向量变为：\n$$ \\phi^{(m)} \\propto S^m \\phi^{(0)} = \\sum_i a_i^{(0)} S^m v_i = \\sum_i a_i^{(0)} \\lambda_i^m v_i $$\n第 $j$ 个模态的模态含量为 $a_j^{(m)} = w_j^{\\top} \\phi^{(m)}$。由于双正交性，这会投影出第 $j$ 个分量：\n$$ a_j^{(m)} \\propto w_j^{\\top} \\left( \\sum_i a_i^{(0)} \\lambda_i^m v_i \\right) = a_j^{(0)} \\lambda_j^m $$\n第二模态相对于第一模态的相对衰减因子是其模态含量比率的每次迭代变化：\n$$ r_w = \\frac{a_2^{(m+1)}/a_1^{(m+1)}}{a_2^{(m)}/a_1^{(m)}} = \\frac{(a_2^{(0)}\\lambda_2^{m+1})/(a_1^{(0)}\\lambda_1^{m+1})}{(a_2^{(0)}\\lambda_2^{m})/(a_1^{(0)}\\lambda_1^{m})} = \\frac{\\lambda_2}{\\lambda_1} $$\n这个迭代算子 $S$ 的次主导特征值与主导特征值的比率就是理论衰减因子。\n\n**3. 理论衰减因子的计算**\n\n使用给定数据：$k_1 = 1.000$，$k_2 = 0.90$，以及 $\\omega = 0.99$。\n首先，我们计算 $S$ 的主导和次主导特征值：\n$$ \\lambda_1 = \\frac{k_1}{k_1 - \\omega} = \\frac{1.000}{1.000 - 0.99} = \\frac{1.0}{0.01} = 100 $$\n$$ \\lambda_2 = \\frac{k_2}{k_2 - \\omega} = \\frac{0.90}{0.90 - 0.99} = \\frac{0.90}{-0.09} = -10 $$\n理论相对衰减因子 $r_w$ 是它们的比率：\n$$ r_w = \\frac{\\lambda_2}{\\lambda_1} = \\frac{-10}{100} = -0.10 $$\n因此，一个正确的 Wielandt 移位迭代应该表现出 $-0.10$ 的衰减因子。负号意味着比率 $a_2^{(m)}/a_1^{(m)}$ 的符号应该在每次迭代时交替。\n\n**4. 与观测值的比较及选项评估**\n\n观测到的衰减因子为 $r_{\\mathrm{obs}} \\approx +0.90$，且没有符号交替。这与理论值 $r_w = -0.10$ 存在明显且重大的差异。我们现在分析每个选项，以找到最合理的解释。\n\n**A. Wielandt 移位没有被应用到有效迭代算子上；代码实际上是在对 $T$ 执行标准幂迭代，从而得到 $r_{\\mathrm{obs}} \\approx k_2/k_1$，并且没有符号交替。**\n- 如果代码执行标准幂迭代，迭代算子就是简单的 $T$。\n- $T$ 的特征值是 $k_i$。\n- 标准幂迭代的衰减因子是 $T$ 的次主导特征值与主导特征值的比率，即 $r_{\\mathrm{PI}} = k_2/k_1$。\n- 使用给定值：$r_{\\mathrm{PI}} = 0.90 / 1.000 = 0.90$。\n- 由于 $k_1$ 和 $k_2$ 都是正数，这个衰减因子是正数，预示着没有符号交替。\n- 计算出的 $r_{\\mathrm{PI}} = +0.90$ 与观测值 $r_{\\mathrm{obs}} \\approx +0.90$ 完全匹配。这表明可能存在一个编码错误，导致 Wielandt 移位机制被绕过，迭代退化为未加速的幂方法。\n- **结论：正确。** 这个选项提供了一个在数量和性质上都与所有可用信息一致的诊断。\n\n**B. 内部线性求解器的容差太松，使得每次迭代的总体误差收缩率实际上为 1；观测到的 $r_{\\mathrm{obs}} \\approx 0.90$ 表明接近停滞。**\n- Wielandt 迭代需要在每一步求解一个线性系统。该系统内部求解器的容差过松会阻碍外部幂迭代的收敛。\n- 如果内部求解效果很差，外部迭代可能会停滞，意味着 $\\phi^{(m+1)} \\approx \\phi^{(m)}$。在这种情况下，模态含量不会有显著变化，因此 $a_i^{(m+1)} \\approx a_i^{(m)}$。\n- 相对衰减因子将是 $r_{\\mathrm{obs}} \\approx \\frac{a_2^{(m)}/a_1^{(m)}}{a_2^{(m)}/a_1^{(m)}} = 1$。\n- 该选项声称收缩率“实际上为 1”，但又将其等同于观测到的衰减率 $r_{\\mathrm{obs}} \\approx 0.90$。这是一个矛盾。衰减因子为 $0.90$ 代表了一致但缓慢的收敛，而不是停滞（停滞意味着衰减因子为 1）。\n- **结论：不正确。** 该选项内部的推理自相矛盾，与观测到的数值不符。\n\n**C. 移位被错误地实现为应用 $(T - \\omega I)^{-1}$ 而没有后乘以 $T$，这将得到 $r_{\\mathrm{obs}} \\approx \\left|\\frac{k_1 - \\omega}{k_2 - \\omega}\\right|$。**\n- 这种情况描述了一种标准的“位移反转”幂迭代，其算子是 $S' = (T - \\omega I)^{-1}$。该方法收敛到 $T$ 的那个其特征值最接近移位 $\\omega$ 的特征向量。\n- 如前所示，$S'$ 的特征值为 $\\mu_i = (k_i - \\omega)^{-1}$。\n- 这种错误迭代的衰减因子将是其次主导与主导特征值的比率，$r' = \\mu_2 / \\mu_1$。注意，$S'$ 的主导特征值对应于最接近 $\\omega$ 的 $k_i$。此处， $|k_1 - \\omega| = |1.000-0.99| = 0.01$ 且 $|k_2 - \\omega| = |0.90-0.99|=0.09$。所以 $k_1$ 最接近，$\\mu_1 = (k_1-\\omega)^{-1}$ 是 $S'$ 的主导特征值。\n- 衰减因子是 $r' = \\frac{\\mu_2}{\\mu_1} = \\frac{(k_2-\\omega)^{-1}}{(k_1-\\omega)^{-1}} = \\frac{k_1-\\omega}{k_2-\\omega} = \\frac{1.000-0.99}{0.90-0.99} = \\frac{0.01}{-0.09} = -\\frac{1}{9} \\approx -0.111$。\n- 这个预测的衰减因子是负数，其大小约为 $0.111$。这与观测到的 $r_{\\mathrm{obs}} \\approx +0.90$ 严重不符。选项中给出的公式 $\\left|\\frac{k_1 - \\omega}{k_2 - \\omega}\\right|$ 给出了大小，但也与观测结果不符。\n- **结论：不正确。**\n\n**D. 模态投影诊断使用了一个非双正交的内积，这污染了测量的 $a_i^{(m)}$，即使在 Wielandt 移位正确实现的情况下，也造成了大的系统性偏差。**\n- 让我们假设 Wielandt 移位工作正常，那么真实的衰减率是 $r_w = -0.10$。这意味着 $v_2$ 分量正在非常迅速地衰减。\n- 几次迭代后，迭代向量被基波模态强烈主导：$\\phi^{(m)} \\approx C v_1$。\n- 如果诊断中使用的投影向量与特征向量不是真正的双正交，那么测量的第二模态含量 $a_{2, \\text{meas}}^{(m)}$ 将会有一个来自主导第一模态的伪贡献。这被称为模态串扰。\n- 随着 $m$ 的增加，$\\phi^{(m)}$ 趋近于 $v_1$，测量的模态含量 $a_{1, \\text{meas}}^{(m)}$ 和 $a_{2, \\text{meas}}^{(m)}$ 都将与同一个主导分量成正比，导致它们的比率趋于一个常数。\n- 如果 $a_2^{(m)}/a_1^{(m)} \\to \\text{常数}$，那么每次迭代的衰减因子 $r_{\\mathrm{obs}}$ 将趋近于 1。\n- 这样的测量误差系统性地产生一个恰好是 $0.90$ 的值的可能性极小，而这个值恰好是另一个完全不同的算法（标准幂迭代）的衰减因子。根据奥卡姆剃刀原理，更简单的解释——即实际上运行的是另一个算法——要可信得多。\n- **结论：不正确。** 这个解释远不如选项 A 合理。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}