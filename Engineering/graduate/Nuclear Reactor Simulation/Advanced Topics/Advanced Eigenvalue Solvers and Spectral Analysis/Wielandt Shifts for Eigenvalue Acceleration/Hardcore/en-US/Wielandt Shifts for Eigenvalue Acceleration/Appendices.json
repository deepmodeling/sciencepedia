{
    "hands_on_practices": [
        {
            "introduction": "The effectiveness of a Wielandt shift hinges on choosing an appropriate shift parameter, $w$. This parameter directly manipulates the spectrum of the iteration operator, which in turn governs the convergence rate. This first exercise  provides practice in the fundamental skill of calculating the shift $w$ required to achieve a desired acceleration, connecting the system's intrinsic dominance ratio $\\hat{d}$ to a target contraction factor $r^{\\ast}$.",
            "id": "4261247",
            "problem": "In steady-state neutron transport for a critical reactor, the fundamental-mode eigenproblem can be written abstractly as an operator fixed point for the fission source, where a bounded linear operator $\\mathcal{T}$ maps a normalized flux iterate to the next generation. Under standard normalization of the iterate, the dominant eigenvalue of $\\mathcal{T}$ is $1$, and the subdominant eigenvalue has magnitude equal to the dominance ratio $\\hat{d}$, with $0  \\hat{d}  1$. Consider an acceleration scheme inspired by the classic Wielandt shift: each outer iteration applies the resolvent-based map defined implicitly by\n$$(\\mathcal{I} - w\\,\\mathcal{T})\\,\\phi^{(m+1)} = \\mathcal{T}\\,\\phi^{(m)},$$\nwith a scalar parameter $w$ chosen to reduce the asymptotic error contraction of the subdominant mode per outer iteration. Assume that the iteration is stable, that is, $0  w  1/\\hat{d}$ so that $(\\mathcal{I} - w\\,\\mathcal{T})$ is invertible on the relevant invariant subspace.\n\nStarting from the spectral properties of $\\mathcal{T}$ and the definition of the resolvent map above, determine the value of $w$ that makes the asymptotic error contraction factor equal to a prescribed target $r^{\\ast}$, where $0  r^{\\ast}  1$. Use the following data: $\\hat{d} = 0.9$ and $r^{\\ast} = 0.3$.\n\nExpress your answer as a dimensionless scalar, and round your result to four significant figures.",
            "solution": "The problem asks for the value of a parameter $w$ in a Wielandt-style acceleration scheme for a neutron transport eigenproblem, such that the asymptotic error contraction factor is a specified value $r^{\\ast}$.\n\nFirst, we must formalize the iteration process and determine the operator that governs the propagation of the error. The given iteration scheme is defined by the implicit relation:\n$$(\\mathcal{I} - w\\,\\mathcal{T})\\,\\phi^{(m+1)} = \\mathcal{T}\\,\\phi^{(m)}$$\nwhere $\\mathcal{I}$ is the identity operator, $\\mathcal{T}$ is the fission source operator for a critical system, $\\phi^{(m)}$ is the flux iterate at step $m$, and $w$ is the real-valued shift parameter.\n\nBy formally inverting the operator on the left-hand side, we can define the explicit iteration operator $\\mathcal{M}$ which maps $\\phi^{(m)}$ to $\\phi^{(m+1)}$:\n$$\\phi^{(m+1)} = (\\mathcal{I} - w\\,\\mathcal{T})^{-1}\\mathcal{T}\\,\\phi^{(m)} \\equiv \\mathcal{M}\\,\\phi^{(m)}$$\nThe existence of the inverse $(\\mathcal{I} - w\\,\\mathcal{T})^{-1}$ is guaranteed by the problem's stability condition, $0  w  1/\\hat{d}$, which ensures that $1$ is not an eigenvalue of $w\\mathcal{T}$.\n\nLet $\\lambda_k$ be the eigenvalues of the operator $\\mathcal{T}$, and let $\\psi_k$ be the corresponding eigenvectors, such that $\\mathcal{T}\\psi_k = \\lambda_k \\psi_k$. The eigenvectors of $\\mathcal{T}$ are also the eigenvectors of any operator that is a function of $\\mathcal{T}$, such as $\\mathcal{M}$. The eigenvalues of $\\mathcal{M}$, which we denote by $\\mu_k$, can be found by applying $\\mathcal{M}$ to an eigenvector $\\psi_k$:\n$$\\mathcal{M}\\psi_k = (\\mathcal{I} - w\\,\\mathcal{T})^{-1}\\mathcal{T}\\psi_k = (\\mathcal{I} - w\\,\\mathcal{T})^{-1}(\\lambda_k \\psi_k) = \\frac{1}{1-w\\lambda_k}(\\lambda_k \\psi_k) = \\frac{\\lambda_k}{1-w\\lambda_k}\\psi_k$$\nThus, the eigenvalues of the iteration operator $\\mathcal{M}$ are given by the mapping $\\mu_k = \\frac{\\lambda_k}{1-w\\lambda_k}$.\n\nThe problem states that for the original operator $\\mathcal{T}$, the dominant eigenvalue is $\\lambda_1 = 1$, corresponding to the fundamental mode solution $\\psi_1$. The subdominant eigenvalues $\\lambda_k$ for $k > 1$ have magnitudes bounded by the dominance ratio $\\hat{d}$, i.e., $|\\lambda_k| \\le \\hat{d}$ for all $k > 1$.\n\nThe iteration is a power-like method, where convergence to the fundamental mode is determined by how quickly the other eigenmodes (the error) decay relative to the fundamental mode. Let the iterate be decomposed as $\\phi^{(m)} = c_1^{(m)}\\psi_1 + \\sum_{k=2}^N c_k^{(m)}\\psi_k$. Applying the operator $\\mathcal{M}$ yields:\n$$\\phi^{(m+1)} = c_1^{(m)}\\mu_1 \\psi_1 + \\sum_{k=2}^N c_k^{(m)}\\mu_k \\psi_k$$\nThe eigenvector $\\psi_1$ corresponds to the eigenvalue $\\mu_1 = \\frac{\\lambda_1}{1-w\\lambda_1} = \\frac{1}{1-w}$. The error components, associated with $\\psi_k$ for $k1$, are amplified by factors of $\\mu_k$. After each iteration, the solution is typically re-normalized. In the context of the power method, this means the error propagation is governed by the ratio of the subdominant eigenvalues of $\\mathcal{M}$ to the dominant eigenvalue of $\\mathcal{M}$.\n\nTherefore, the asymptotic error contraction factor, $r$, is the spectral radius of the error propagation operator, which is given by:\n$$r = \\sup_{k1} \\left| \\frac{\\mu_k}{\\mu_1} \\right| = \\sup_{k1} \\left| \\frac{\\lambda_k / (1 - w\\lambda_k)}{1 / (1-w)} \\right| = \\sup_{k1} \\left| \\frac{\\lambda_k(1-w)}{1-w\\lambda_k} \\right|$$\nThe problem specifies $0  w  1/\\hat{d}$. For the scheme to be an acceleration, we expect $r  \\hat{d}$, which, as will be shown, implies $0  w  1$. Assuming this, $|1-w| = 1-w$. The expression for $r$ becomes:\n$$r = (1-w) \\sup_{k1} \\left| \\frac{\\lambda_k}{1-w\\lambda_k} \\right|$$\nThe problem gives the spectral bound for the subdominant eigenvalues as $\\sup_{k1}|\\lambda_k| = \\hat{d}$. By the maximum modulus principle for analytic functions, the maximum of $|\\lambda / (1-w\\lambda)|$ over the disk $|\\lambda| \\le \\hat{d}$ must occur on its boundary, $|\\lambda|=\\hat{d}$. So we need to find:\n$$r = (1-w) \\max_{|\\lambda|=\\hat{d}} \\left| \\frac{\\lambda}{1-w\\lambda} \\right| = (1-w) \\frac{\\hat{d}}{\\min_{|\\lambda|=\\hat{d}}|1-w\\lambda|}$$\nLet $\\lambda = \\hat{d} e^{i\\theta}$. The term to minimize is $|1-w\\hat{d}e^{i\\theta}|^2$:\n$$|1-w\\hat{d}e^{i\\theta}|^2 = |(1-w\\hat{d}\\cos\\theta) - i(w\\hat{d}\\sin\\theta)|^2 = (1-w\\hat{d}\\cos\\theta)^2 + (w\\hat{d}\\sin\\theta)^2 = 1 - 2w\\hat{d}\\cos\\theta + w^2\\hat{d}^2$$\nSince $w  0$ and $\\hat{d}  0$, this expression is minimized when $\\cos\\theta$ is maximized, i.e., $\\cos\\theta=1$. This corresponds to a real eigenvalue $\\lambda = \\hat{d}$. The minimum value of $|1-w\\lambda|$ is thus $|1-w\\hat{d}|$. The given stability condition $w  1/\\hat{d}$ ensures $w\\hat{d}1$, so $1-w\\hat{d}  0$.\nThe asymptotic error contraction factor is therefore:\n$$r = (1-w) \\frac{\\hat{d}}{1-w\\hat{d}}$$\nWe are given that this factor should be equal to a target value $r^{\\ast}$. We can now solve for $w$:\n$$r^{\\ast} = \\frac{(1-w)\\hat{d}}{1-w\\hat{d}}$$\n$$r^{\\ast}(1-w\\hat{d}) = \\hat{d}(1-w)$$\n$$r^{\\ast} - r^{\\ast}w\\hat{d} = \\hat{d} - w\\hat{d}$$\n$$w\\hat{d} - r^{\\ast}w\\hat{d} = \\hat{d} - r^{\\ast}$$\n$$w\\hat{d}(1 - r^{\\ast}) = \\hat{d} - r^{\\ast}$$\n$$w = \\frac{\\hat{d} - r^{\\ast}}{\\hat{d}(1 - r^{\\ast})}$$\nThe problem provides the numerical values $\\hat{d} = 0.9$ and $r^{\\ast} = 0.3$. Substituting these into the expression for $w$:\n$$w = \\frac{0.9 - 0.3}{0.9(1 - 0.3)} = \\frac{0.6}{0.9 \\times 0.7} = \\frac{0.6}{0.63}$$\n$$w = \\frac{60}{63} = \\frac{20}{21}$$\nTo provide the answer as a decimal rounded to four significant figures:\n$$w \\approx 0.95238095...$$\nRounding to four significant figures gives $0.9524$.\n\nWe verify this result is consistent with our assumptions. Since $0  r^{\\ast}  \\hat{d}  1$, both the numerator $(\\hat{d}-r^{\\ast})$ and the denominator $\\hat{d}(1-r^{\\ast})$ are positive, so $w0$. Also, $w = \\frac{1-r^{\\ast}/\\hat{d}}{1-r^{\\ast}}  1$ because $\\hat{d}1$ implies $r^{\\ast}/\\hat{d}  r^{\\ast}$. Thus, the assumption $0  w  1$ is correct. The stability condition $w  1/\\hat{d} = 1/0.9 \\approx 1.111$ is also satisfied, as $0.9524  1.111$.\nThe final result is the numerical value for $w$.",
            "answer": "$$\\boxed{0.9524}$$"
        },
        {
            "introduction": "In practical applications, the Wielandt shift is often implemented within an iterative scheme where the eigenvalue $k$ is not known beforehand but is updated at each step. This introduces a critical question: how sensitive is the acceleration to the accuracy of the current eigenvalue estimate? This problem  delves into this by asking you to derive the sensitivity of the convergence rate to errors in the estimated eigenvalue, a crucial consideration for designing robust and adaptive solvers.",
            "id": "4261257",
            "problem": "In neutron transport–based nuclear reactor simulation, the steady-state neutron multiplication factor is defined by the generalized eigenproblem $F \\phi = k A \\phi$, where $F$ is the linear fission production operator, $A$ is the linear removal (loss and scattering) operator, $k$ is the effective multiplication factor, and $\\phi$ is the neutron flux eigenfunction. In power iteration, the associated iteration operator is $T := A^{-1} F$, whose eigenvalues are the $k$-eigenvalues $\\{k_i\\}$ ordered by magnitude $k_1  k_2  \\cdots$.\n\nWielandt shift is introduced to accelerate convergence by modifying the operator used in the iteration. Consider the dimensionless shift parameter $w \\in \\mathbb{R}$ and a current approximate multiplication factor $k \\neq k_1$. Define the shifted iteration operator \n$$\nT_w(k) := \\left(A - \\frac{w}{k} F\\right)^{-1} F,\n$$\nwhich is a standard form of Wielandt acceleration in this generalized eigenvalue setting. Starting from the definitions above, derive the asymptotic contraction factor associated with $T_w(k)$ in terms of $k$, $k_1$, $k_2$, and $w$, and then obtain an analytic expression for the sensitivity of the logarithm of this contraction factor with respect to $k$, that is, $\\frac{d}{dk}\\ln r_w(k)$.\n\nAssume a reactor state with $k_1 = 1.00$ and $k_2 = 0.95$, perform the derivation symbolically, and then evaluate your sensitivity expression at $k = 0.98$ and $w = 0.60$. Express your final answer as a single real number and round your answer to four significant figures. The sensitivity is dimensionless; do not include any units in your final numeric value.",
            "solution": "The first step is to determine the eigenvalues of the shifted operator $T_w(k)$. Let $\\lambda_i$ be the eigenvalues of $T_w(k)$ corresponding to the eigenfunctions $\\psi_i$. The eigenproblem for $T_w(k)$ is:\n$$\nT_w(k) \\psi_i = \\lambda_i \\psi_i\n$$\nSubstituting the definition of $T_w(k)$:\n$$\n\\left(A - \\frac{w}{k} F\\right)^{-1} F \\psi_i = \\lambda_i \\psi_i\n$$\nMultiplying from the left by the invertible operator $\\left(A - \\frac{w}{k} F\\right)$ yields:\n$$\nF \\psi_i = \\lambda_i \\left(A - \\frac{w}{k} F\\right) \\psi_i\n$$\n$$\nF \\psi_i = \\lambda_i A \\psi_i - \\frac{\\lambda_i w}{k} F \\psi_i\n$$\nRearranging the terms to group operators $F$ and $A$:\n$$\n\\left(1 + \\frac{\\lambda_i w}{k}\\right) F \\psi_i = \\lambda_i A \\psi_i\n$$\nThis can be written in the form of the original generalized eigenproblem:\n$$\nF \\psi_i = \\left( \\frac{\\lambda_i}{1 + \\frac{\\lambda_i w}{k}} \\right) A \\psi_i\n$$\nBy comparing this with the original eigenproblem, $F \\phi_i = k_i A \\phi_i$, we see that the shifted operator $T_w(k)$ shares the same eigenfunctions as the original problem, i.e., $\\psi_i = \\phi_i$. The eigenvalues $k_i$ of the original problem are related to the eigenvalues $\\lambda_i$ of the shifted operator by:\n$$\nk_i = \\frac{\\lambda_i}{1 + \\frac{\\lambda_i w}{k}}\n$$\nWe now solve this equation for $\\lambda_i$ to express the new eigenvalues in terms of the original ones:\n$$\nk_i \\left(1 + \\frac{\\lambda_i w}{k}\\right) = \\lambda_i\n$$\n$$\nk_i + \\frac{k_i \\lambda_i w}{k} = \\lambda_i\n$$\n$$\nk_i = \\lambda_i \\left(1 - \\frac{k_i w}{k}\\right)\n$$\n$$\n\\lambda_i = \\frac{k_i}{1 - \\frac{k_i w}{k}} = \\frac{k_i k}{k - k_i w}\n$$\nThe power iteration method converges to the eigenfunction corresponding to the eigenvalue with the largest magnitude. For the Wielandt shift to be effective in accelerating convergence to the fundamental mode (corresponding to $k_1$), $|\\lambda_1|$ must be the largest eigenvalue, and the asymptotic contraction factor, $r_w(k)$, is the ratio of the magnitude of the second-largest eigenvalue to the largest. Assuming the eigenvalue spectrum is ordered such that the second dominant mode corresponds to $k_2$, this factor is:\n$$\nr_w(k) = \\frac{|\\lambda_2|}{|\\lambda_1|} = \\frac{\\left| \\frac{k_2 k}{k - k_2 w} \\right|}{\\left| \\frac{k_1 k}{k - k_1 w} \\right|}\n$$\nGiven that $k_1$, $k_2$, and $k$ are positive physical quantities (multiplication factors), we can simplify this to:\n$$\nr_w(k) = \\frac{k_2}{k_1} \\frac{|k - k_1 w|}{|k - k_2 w|}\n$$\nThis is the symbolic expression for the asymptotic contraction factor. We now evaluate the signs of the terms inside the absolute value functions for the given parameters: $k_1 = 1.00$, $k_2 = 0.95$, $k = 0.98$, and $w = 0.60$.\n$$\nk - k_1 w = 0.98 - (1.00)(0.60) = 0.98 - 0.60 = 0.38\n$$\n$$\nk - k_2 w = 0.98 - (0.95)(0.60) = 0.98 - 0.57 = 0.41\n$$\nSince both terms are positive, we can remove the absolute value signs:\n$$\nr_w(k) = \\frac{k_2}{k_1} \\left( \\frac{k - k_1 w}{k - k_2 w} \\right)\n$$\nNext, we find the logarithm of this contraction factor:\n$$\n\\ln r_w(k) = \\ln\\left(\\frac{k_2}{k_1}\\right) + \\ln(k - k_1 w) - \\ln(k - k_2 w)\n$$\nThe problem asks for the sensitivity of this logarithm with respect to $k$, which is its derivative $\\frac{d}{dk} \\ln r_w(k)$. Let this sensitivity be denoted by $S_w(k)$.\n$$\nS_w(k) = \\frac{d}{dk} \\left[ \\ln\\left(\\frac{k_2}{k_1}\\right) + \\ln(k - k_1 w) - \\ln(k - k_2 w) \\right]\n$$\nThe first term is a constant with respect to $k$, so its derivative is zero. Applying the chain rule to the logarithmic terms:\n$$\nS_w(k) = 0 + \\frac{1}{k - k_1 w} \\cdot \\frac{d}{dk}(k - k_1 w) - \\frac{1}{k - k_2 w} \\cdot \\frac{d}{dk}(k - k_2 w)\n$$\n$$\nS_w(k) = \\frac{1}{k - k_1 w} - \\frac{1}{k - k_2 w}\n$$\nThis is the analytic expression for the sensitivity. We can combine the fractions to get a single expression:\n$$\nS_w(k) = \\frac{(k - k_2 w) - (k - k_1 w)}{(k - k_1 w)(k - k_2 w)} = \\frac{k - k_2 w - k + k_1 w}{(k - k_1 w)(k - k_2 w)} = \\frac{w(k_1 - k_2)}{(k - k_1 w)(k - k_2 w)}\n$$\nFinally, we evaluate this expression at $k = 0.98$ and $w = 0.60$, with $k_1 = 1.00$ and $k_2 = 0.95$.\n$$\nS_w(0.98) = \\frac{0.60(1.00 - 0.95)}{(0.98 - 1.00 \\times 0.60)(0.98 - 0.95 \\times 0.60)}\n$$\n$$\nS_w(0.98) = \\frac{0.60(0.05)}{(0.98 - 0.60)(0.98 - 0.57)}\n$$\n$$\nS_w(0.98) = \\frac{0.03}{(0.38)(0.41)}\n$$\n$$\nS_w(0.98) = \\frac{0.03}{0.1558} \\approx 0.1925545571...\n$$\nRounding the result to four significant figures gives $0.1926$.",
            "answer": "$$\\boxed{0.1926}$$"
        },
        {
            "introduction": "A common and vital task in computational science is verifying that a complex algorithm has been implemented correctly. Theoretical predictions about an algorithm's performance serve as powerful diagnostic tools for this purpose. In this final exercise , you will step into the role of a code verifier, using your theoretical understanding of the Wielandt shift to diagnose a significant discrepancy between observed and expected behavior, thereby honing a key skill in software validation and debugging.",
            "id": "4261207",
            "problem": "Consider a two-dimensional neutron diffusion $k$-eigenvalue problem for a pressurized water reactor core, written in operator form as $A \\phi = \\frac{1}{k} F \\phi$, where $A$ is the loss operator and $F$ is the fission production operator. Define the propagation operator $T = A^{-1} F$, so that the right-eigenpairs $(k_i, v_i)$ satisfy $T v_i = k_i v_i$ with $k_1  k_2  \\dots  0$. A Wielandt-shifted power iteration is implemented through the operator $S = (T - \\omega I)^{-1} T$ with a scalar shift $\\omega$.\n\nTo verify the implementation, you measure the per-iteration decay of the projection of the iterates onto the first two right eigenmodes. Let the biorthogonal adjoint (left) eigenvectors $(w_i)$ satisfy $w_i^{\\top} v_j = \\delta_{ij}$, and define the modal content $a_i^{(m)} = w_i^{\\top} \\phi^{(m)}$ for the $m$-th iterate $\\phi^{(m)}$. The observed per-iteration relative decay factor of the second mode with respect to the first is computed as\n$$r_{\\mathrm{obs}} \\approx \\frac{a_2^{(m+1)}/a_1^{(m+1)}}{a_2^{(m)}/a_1^{(m)}}.$$\nIn a test problem, the dominant and subdominant multiplication factors are known (from an independent high-accuracy solver) to be $k_1 = 1.000$ and $k_2 = 0.90$, and the Wielandt shift used in the code is $\\omega = 0.99$. The verification measurements report $r_{\\mathrm{obs}} \\approx +0.90$ with no sign alternation across iterations.\n\nUsing first principles from linear operator theory and the definition of the Wielandt-shifted iteration, derive the theoretically expected relative decay factor $r_w$ for the second mode under correct Wielandt shifting and compare it with the observed value. Then, select the most consistent diagnosis for the discrepancy. Which option best explains the observations?\n\nA. The Wielandt shift is not being applied to the effective iteration operator; the code is effectively performing standard power iteration on $T$, yielding $r_{\\mathrm{obs}} \\approx k_2/k_1$ with no sign alternation.\n\nB. The inner linear solver tolerance is too loose, making the overall error contraction effectively unity per iteration; the observed $r_{\\mathrm{obs}} \\approx 0.90$ indicates near-stagnation.\n\nC. The shift is mistakenly implemented as applying $(T - \\omega I)^{-1}$ without the post-multiplication by $T$, which would yield $r_{\\mathrm{obs}} \\approx \\left|\\frac{k_1 - \\omega}{k_2 - \\omega}\\right|$.\n\nD. The modal projection diagnostic uses a non-biorthogonal inner product that contaminates the measured $a_i^{(m)}$, creating large systematic bias even when the Wielandt shift is correctly implemented.",
            "solution": "The core of the task is to derive the theoretical relative decay factor, $r_w$, for a correctly implemented Wielandt shift and compare it with the observed value, $r_{\\mathrm{obs}}$.\n\n**1. Eigenvalues of the Wielandt-Shifted Operator**\n\nThe Wielandt-shifted iteration proceeds as $\\phi^{(m+1)} \\propto S \\phi^{(m)}$, where the iteration operator is $S = (T - \\omega I)^{-1} T$. To understand the convergence, we must find the eigenvalues of $S$. Let $v_i$ be an eigenvector of $T$ with eigenvalue $k_i$, such that $T v_i = k_i v_i$.\n\nApplying the operator $S$ to an eigenvector $v_i$:\n$$ S v_i = (T - \\omega I)^{-1} T v_i = (T - \\omega I)^{-1} (k_i v_i) $$\nSince $k_i$ is a scalar, it commutes with the operator:\n$$ S v_i = k_i (T - \\omega I)^{-1} v_i $$\nThe operator $(T - \\omega I)$ acts on $v_i$ as $(T - \\omega I) v_i = T v_i - \\omega v_i = k_i v_i - \\omega v_i = (k_i - \\omega)v_i$. Thus, $v_i$ is also an eigenvector of $(T - \\omega I)$ with eigenvalue $(k_i - \\omega)$. Consequently, $v_i$ is an eigenvector of the inverse operator $(T - \\omega I)^{-1}$ with eigenvalue $(k_i - \\omega)^{-1}$.\n$$ (T - \\omega I)^{-1} v_i = \\frac{1}{k_i - \\omega} v_i $$\nSubstituting this back into the expression for $S v_i$:\n$$ S v_i = k_i \\left( \\frac{1}{k_i - \\omega} v_i \\right) = \\left( \\frac{k_i}{k_i - \\omega} \\right) v_i $$\nTherefore, the operator $S$ has the same eigenvectors $v_i$ as $T$, and its eigenvalues, let's call them $\\lambda_i$, are given by:\n$$ \\lambda_i = \\frac{k_i}{k_i - \\omega} $$\n\n**2. Asymptotic Behavior of the Iteration**\n\nAn initial vector $\\phi^{(0)}$ can be expanded in the basis of eigenvectors: $\\phi^{(0)} = \\sum_i a_i^{(0)} v_i$. After $m$ iterations, ignoring normalization, the vector becomes:\n$$ \\phi^{(m)} \\propto S^m \\phi^{(0)} = \\sum_i a_i^{(0)} S^m v_i = \\sum_i a_i^{(0)} \\lambda_i^m v_i $$\nThe modal content of the $j$-th mode is $a_j^{(m)} = w_j^{\\top} \\phi^{(m)}$. Due to biorthogonality, this projects out the $j$-th component:\n$$ a_j^{(m)} \\propto w_j^{\\top} \\left( \\sum_i a_i^{(0)} \\lambda_i^m v_i \\right) = a_j^{(0)} \\lambda_j^m $$\nThe relative decay factor of the second mode with respect to the first is the per-iteration change in the ratio of their modal contents:\n$$ r_w = \\frac{a_2^{(m+1)}/a_1^{(m+1)}}{a_2^{(m)}/a_1^{(m)}} = \\frac{(a_2^{(0)}\\lambda_2^{m+1})/(a_1^{(0)}\\lambda_1^{m+1})}{(a_2^{(0)}\\lambda_2^{m})/(a_1^{(0)}\\lambda_1^{m})} = \\frac{\\lambda_2}{\\lambda_1} $$\nThis ratio of the subdominant to dominant eigenvalues of the iteration operator $S$ is the theoretical decay factor.\n\n**3. Calculation of the Theoretical Decay Factor**\n\nUsing the given data: $k_1 = 1.000$, $k_2 = 0.90$, and $\\omega = 0.99$.\nFirst, we calculate the dominant and subdominant eigenvalues of $S$:\n$$ \\lambda_1 = \\frac{k_1}{k_1 - \\omega} = \\frac{1.000}{1.000 - 0.99} = \\frac{1.0}{0.01} = 100 $$\n$$ \\lambda_2 = \\frac{k_2}{k_2 - \\omega} = \\frac{0.90}{0.90 - 0.99} = \\frac{0.90}{-0.09} = -10 $$\nThe theoretical relative decay factor $r_w$ is their ratio:\n$$ r_w = \\frac{\\lambda_2}{\\lambda_1} = \\frac{-10}{100} = -0.10 $$\nA correct Wielandt-shifted iteration should therefore exhibit a decay factor of $-0.10$. The negative sign implies that the sign of the ratio $a_2^{(m)}/a_1^{(m)}$ should alternate with each iteration.\n\n**4. Comparison with Observation and Evaluation of Options**\n\nThe observed decay factor is $r_{\\mathrm{obs}} \\approx +0.90$ with no sign alternation. This is a clear and significant discrepancy from the theoretical value $r_w = -0.10$. We now analyze each option to find the most plausible explanation.\n\n**A. The Wielandt shift is not being applied to the effective iteration operator; the code is effectively performing standard power iteration on $T$, yielding $r_{\\mathrm{obs}} \\approx k_2/k_1$ with no sign alternation.**\n- If the code performs a standard power iteration, the iteration operator is simply $T$.\n- The eigenvalues of $T$ are $k_i$.\n- The decay factor for standard power iteration is the ratio of the subdominant to the dominant eigenvalue of $T$, which is $r_{\\mathrm{PI}} = k_2/k_1$.\n- Using the given values: $r_{\\mathrm{PI}} = 0.90 / 1.000 = 0.90$.\n- Since $k_1$ and $k_2$ are both positive, this decay factor is positive, predicting no sign alternation.\n- The calculated $r_{\\mathrm{PI}} = +0.90$ perfectly matches the observed value $r_{\\mathrm{obs}} \\approx +0.90$. This suggests a coding error where the Wielandt shift machinery is bypassed, and the iteration defaults to the unaccelerated power method.\n- **Verdict: Correct.** This option provides a diagnosis that is quantitatively and qualitatively consistent with all available information.\n\n**B. The inner linear solver tolerance is too loose, making the overall error contraction effectively unity per iteration; the observed $r_{\\mathrm{obs}} \\approx 0.90$ indicates near-stagnation.**\n- The Wielandt iteration requires solving a linear system $(F - \\omega A) \\phi^{(m+1)} = F \\phi^{(m)}$ at each step. A loose tolerance in the inner solver for this system can impede the convergence of the outer power iteration.\n- If the inner solve is very poor, the outer iteration can stall, meaning $\\phi^{(m+1)} \\approx \\phi^{(m)}$. In this case, the modal contents would not change significantly, so $a_i^{(m+1)} \\approx a_i^{(m)}$.\n- The relative decay factor would then be $r_{\\mathrm{obs}} \\approx \\frac{a_2^{(m)}/a_1^{(m)}}{a_2^{(m)}/a_1^{(m)}} = 1$.\n- The option claims the contraction is \"effectively unity\" but then equates this to an observed decay of $r_{\\mathrm{obs}} \\approx 0.90$. This is a contradiction. A decay factor of $0.90$ represents consistent, albeit slow, convergence, not stagnation (which implies a decay factor of $1$).\n- **Verdict: Incorrect.** The reasoning within the option is self-contradictory and does not align with the observed numerical value.\n\n**C. The shift is mistakenly implemented as applying $(T - \\omega I)^{-1}$ without the post-multiplication by $T$, which would yield $r_{\\mathrm{obs}} \\approx \\left|\\frac{k_1 - \\omega}{k_2 - \\omega}\\right|$.**\n- This scenario describes a standard \"shift-and-invert\" power iteration, where the operator is $S' = (T - \\omega I)^{-1}$. This method converges to the eigenvector of $T$ whose eigenvalue is closest to the shift $\\omega$.\n- As shown previously, the eigenvalues of $S'$ are $\\mu_i = (k_i - \\omega)^{-1}$.\n- The decay factor for this mistaken iteration would be the ratio of its subdominant to dominant eigenvalues, $r' = \\mu_2 / \\mu_1$. Note that the dominant eigenvalue of $S'$ corresponds to the $k_i$ closest to $\\omega$. Here, $|k_1 - \\omega| = |1.000-0.99| = 0.01$ and $|k_2 - \\omega| = |0.90-0.99|=0.09$. So $k_1$ is closest, and $\\mu_1 = (k_1-\\omega)^{-1}$ is the dominant eigenvalue of $S'$.\n- The decay factor is $r' = \\frac{\\mu_2}{\\mu_1} = \\frac{(k_2-\\omega)^{-1}}{(k_1-\\omega)^{-1}} = \\frac{k_1-\\omega}{k_2-\\omega} = \\frac{1.000-0.99}{0.90-0.99} = \\frac{0.01}{-0.09} = -\\frac{1}{9} \\approx -0.111$.\n- This predicted decay factor is negative and has a magnitude of $\\approx 0.111$. This is grossly inconsistent with the observed $r_{\\mathrm{obs}} \\approx +0.90$. The formula presented in the option, $\\left|\\frac{k_1 - \\omega}{k_2 - \\omega}\\right|$, gives the magnitude but is also inconsistent with the observation.\n- **Verdict: Incorrect.**\n\n**D. The modal projection diagnostic uses a non-biorthogonal inner product that contaminates the measured $a_i^{(m)}$, creating large systematic bias even when the Wielandt shift is correctly implemented.**\n- Let's assume the Wielandt shift is working correctly, so the true decay rate is $r_w = -0.10$. This means the $v_2$ component is decaying very rapidly.\n- After a few iterations, the iterate vector is strongly dominated by the fundamental mode: $\\phi^{(m)} \\approx C v_1$.\n- If the projection vectors used in the diagnostic are not truly biorthogonal to the eigenvectors, the measured second-mode content $a_{2, \\text{meas}}^{(m)}$ would have a spurious contribution from the dominant first mode. This is called modal cross-talk.\n- As $m$ increases, $\\phi^{(m)}$ approaches $v_1$, and both measured modal contents $a_{1, \\text{meas}}^{(m)}$ and $a_{2, \\text{meas}}^{(m)}$ would become proportional to the same dominant component, causing their ratio to approach a constant.\n- If $a_2^{(m)}/a_1^{(m)} \\to \\text{constant}$, then the per-iteration decay factor $r_{\\mathrm{obs}}$ would approach $1$.\n- It is highly improbable that such a measurement error would systematically produce a value of precisely $0.90$, which happens to be the decay factor of an entirely different algorithm (standard power iteration). According to Occam's razor, the simpler explanation—that the other algorithm is actually running—is far more likely.\n- **Verdict: Incorrect.** This is a far less plausible explanation than Option A.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}