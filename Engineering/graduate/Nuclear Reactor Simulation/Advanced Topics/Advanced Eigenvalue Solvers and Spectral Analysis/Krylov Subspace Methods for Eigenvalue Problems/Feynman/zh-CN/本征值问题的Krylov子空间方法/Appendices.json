{
    "hands_on_practices": [
        {
            "introduction": "Krylov子空间方法的核心在于迭代，因此理解其收敛速度至关重要。本练习  通过一个理想化的幂迭代场景，揭示了控制收敛速度的关键参数——“优势比”。通过亲手计算达到所需精度所需的迭代次数，你将直观地理解反应堆的谱特性如何直接决定求解 $k_{\\text{eff}}$ 特征值问题的计算效率。",
            "id": "4232451",
            "problem": "考虑一个稳态中子平衡，该平衡导出了非均匀热中子反应堆堆芯中的多群裂变源本征值公式。令 $A$ 表示损失算子（包括吸收、迁出散射和泄漏），$F$ 表示裂变产生算子。增殖算子定义为 $K = A^{-1} F$，因此基态本征对满足 $K \\phi_1 = \\lambda_1 \\phi_1$，其中 $\\lambda_1 = k_{\\text{eff}}$ 是有效中子增殖因子（在近临界时 $k_{\\text{eff}} \\approx 1$）。假设 $K$ 是可对角化的，具有一组完备的右本征向量 $\\{\\phi_i\\}_{i=1}^{N}$，这些本征向量根据其本征值的大小排序：$|\\lambda_1| > |\\lambda_2| \\ge \\cdots \\ge 0$。优势比定义为 $r = |\\lambda_2/\\lambda_1|$，它表征了 Krylov 子空间迭代中非基模的渐近衰减率。\n\n通过不进行正交化或缩并的简单幂迭代法应用一种 Krylov 子空间方法：从初始猜测 $\\phi^{(0)}$ 开始，后续的迭代向量为 $\\phi^{(n)} = K^{n} \\phi^{(0)}$，并且对每个迭代向量进行缩放以使其范数固定（假设存在一个由内积导出的一致范数，在该内积下本征向量是标准正交的）。\n\n假设：\n- 优势比为 $r = 0.92$。\n- 初始猜测是一个归一化的双模混合，$\\phi^{(0)} = c_1 \\phi_1 + c_2 \\phi_2$，其中 $c_1 = 0.8$，$c_2 = 0.6$，且高阶模分量可以忽略不计。\n- 误差因子 $E(n)$ 定义为经过 $n$ 次 Krylov 步数后，归一化迭代向量中第二模分量的幅度与基模分量的幅度之比。\n\n仅使用上述物理设置和定义，确定所需的最小整数 Krylov 迭代次数 $n$，使得误差因子满足 $E(n) \\le \\epsilon$，其中 $\\epsilon = 1.0 \\times 10^{-7}$。将最终答案表示为一个不带单位的整数。",
            "solution": "题目要求计算所需的最小 Krylov 迭代次数 $n$，以使误差因子 $E(n)$ 小于或等于指定的容差 $\\epsilon$。所使用的 Krylov 方法是用于寻找增殖算子 $K$ 的主本征对的幂迭代法。\n\n令本征向量的初始猜测为 $\\phi^{(0)}$。题目指定了一个双模混合：\n$$\n\\phi^{(0)} = c_1 \\phi_1 + c_2 \\phi_2\n$$\n其中 $\\phi_1$ 和 $\\phi_2$ 分别是对应于基模和第一高阶模的本征向量。给定的系数为 $c_1 = 0.8$ 和 $c_2 = 0.6$。题目说明本征向量集合 $\\{\\phi_i\\}$ 在某个一致的内积下是标准正交的。\n\n幂迭代法生成一个向量序列。经过 $n$ 次迭代后的未归一化向量（我们记为 $\\psi^{(n)}$）是通过将算子 $K$ 对初始猜测 $\\phi^{(0)}$ 应用 $n$ 次得到的：\n$$\n\\psi^{(n)} = K^n \\phi^{(0)}\n$$\n代入 $\\phi^{(0)}$ 的表达式并利用算子 $K^n$ 的线性性质：\n$$\n\\psi^{(n)} = K^n (c_1 \\phi_1 + c_2 \\phi_2) = c_1 K^n \\phi_1 + c_2 K^n \\phi_2\n$$\n根据定义，$\\phi_i$ 是 $K$ 的一个本征向量，其本征值为 $\\lambda_i$，所以 $K \\phi_i = \\lambda_i \\phi_i$。这意味着 $K^n \\phi_i = \\lambda_i^n \\phi_i$。应用这个性质，我们得到：\n$$\n\\psi^{(n)} = c_1 \\lambda_1^n \\phi_1 + c_2 \\lambda_2^n \\phi_2\n$$\n这个向量 $\\psi^{(n)}$ 表示经过 $n$ 次迭代后、归一化之前的解的状态。基模分量是 $c_1 \\lambda_1^n \\phi_1$，第二模分量是 $c_2 \\lambda_2^n \\phi_2$。\n\n题目将误差因子 $E(n)$ 定义为*归一化*迭代向量 $\\phi^{(n)}$ 中第二模分量的幅度与基模分量的幅度之比。归一化迭代向量为 $\\phi^{(n)} = \\psi^{(n)}/\\|\\psi^{(n)}\\|$。由于本征向量是标准正交的，归一化迭代向量的系数为 $d_1 = \\frac{c_1 \\lambda_1^n}{\\|\\psi^{(n)}\\|}$ 和 $d_2 = \\frac{c_2 \\lambda_2^n}{\\|\\psi^{(n)}\\|}$。在归一化的本征向量展开式中，每个分量的幅度是其系数的绝对值。因此，误差因子为：\n$$\nE(n) = \\frac{|d_2|}{|d_1|} = \\frac{\\left| \\frac{c_2 \\lambda_2^n}{\\|\\psi^{(n)}\\|} \\right|}{\\left| \\frac{c_1 \\lambda_1^n}{\\|\\psi^{(n)}\\|} \\right|} = \\frac{|c_2| |\\lambda_2|^n}{|c_1| |\\lambda_1|^n}\n$$\n归一化常数 $\\|\\psi^{(n)}\\|$ 被消掉了。误差因子的表达式简化为：\n$$\nE(n) = \\frac{|c_2|}{|c_1|} \\left( \\frac{|\\lambda_2|}{|\\lambda_1|} \\right)^n\n$$\n题目将优势比定义为 $r = |\\lambda_2/\\lambda_1|$。代入这个定义以及给定的系数值 $|c_1| = 0.8$ 和 $|c_2| = 0.6$：\n$$\nE(n) = \\frac{0.6}{0.8} r^n = 0.75 \\ r^n\n$$\n已知优势比为 $r = 0.92$。要求的条件是误差因子 $E(n)$ 必须小于或等于容差 $\\epsilon = 1.0 \\times 10^{-7}$。现在我们可以建立不等式来求解 $n$：\n$$\n0.75 \\times (0.92)^n \\le 1.0 \\times 10^{-7}\n$$\n为了求解 $n$，我们首先分离出带指数的项：\n$$\n(0.92)^n \\le \\frac{1.0 \\times 10^{-7}}{0.75} = \\frac{4}{3} \\times 10^{-7}\n$$\n接下来，我们对不等式两边取自然对数：\n$$\n\\ln((0.92)^n) \\le \\ln\\left(\\frac{4}{3} \\times 10^{-7}\\right)\n$$\n$$\nn \\ln(0.92) \\le \\ln\\left(\\frac{4}{3}\\right) + \\ln(10^{-7})\n$$\n因为 $0.92  1$，其自然对数 $\\ln(0.92)$ 是一个负数。因此，当我们除以 $\\ln(0.92)$ 来求解 $n$ 时，我们必须反转不等号的方向：\n$$\nn \\ge \\frac{\\ln\\left(\\frac{4}{3} \\times 10^{-7}\\right)}{\\ln(0.92)}\n$$\n现在，我们可以计算数值：\n$$\nn \\ge \\frac{\\ln(1.333... \\times 10^{-7})}{\\ln(0.92)}\n$$\n对数的近似值为：\n$$\n\\ln(1.333... \\times 10^{-7}) \\approx -15.83041\n$$\n$$\n\\ln(0.92) \\approx -0.08338\n$$\n代入这些值：\n$$\nn \\ge \\frac{-15.83041}{-0.08338} \\approx 189.856\n$$\n因为 $n$ 必须是表示迭代次数的整数，所以我们必须取满足此条件的最小整数值。这可以通过对结果向上取整得到：\n$$\nn = \\lceil 189.856 \\rceil = 190\n$$\n因此，至少需要 $190$ 次迭代才能将误差因子降低到所要求的容差。",
            "answer": "$$\\boxed{190}$$"
        },
        {
            "introduction": "在掌握了理想情况下的收敛性后，我们必须面对实际反应堆模拟中一个更微妙的挑战：算子的非正规性（non-normality）。本练习  构建了一个简化的非正规算子模型，它能体现中子输运问题离散化引入的数值特性。你将通过推导发现，克里洛夫方法早期迭代产生的“里兹值”可能严重偏离真实特征值，反而趋近于算子“值域”的边界，从而深刻理解非正规性为何会给算法的稳定性和加速策略带来困扰。",
            "id": "4232489",
            "problem": "考虑一个简化的单能、单向平板中子输运模型，该模型通过在核反应堆模拟中广泛使用的粗网格迎风有限体积格式进行离散化。所得到的 k-特征值模型的迭代算子可以抽象为一个作用于三单元粗网格通量向量的非正规矩阵 $A \\in \\mathbb{C}^{3 \\times 3}$。在此简化设定中，裂变与损失的迭代由下式描述：\n$$\nA \\;=\\; I \\;+\\; N, \\quad\nN \\;=\\; \\begin{pmatrix}\n0  L  0 \\\\\n0  0  L \\\\\n0  0  0\n\\end{pmatrix},\n$$\n其中 $L$ 是一个源于迎风离散化的无量纲迁移耦合参数。假设 $L = 2\\sqrt{2}$。这个矩阵 $A$ 是非正规的，但其所有特征值都等于 $1$，这反映了潜在的物理目标（主 k-特征值）接近于 1，而离散化引起的非正规性可能会扭曲瞬态瑞利商的行为。\n\n令值域（也称为数值范围）定义为：\n$$\nW(A) \\;=\\; \\left\\{ \\frac{x^{*} A x}{x^{*} x} \\;:\\; x \\in \\mathbb{C}^{3} \\setminus \\{0\\} \\right\\},\n$$\n并令厄米部为：\n$$\nH \\;=\\; \\frac{A + A^{*}}{2}.\n$$\n在用于反应堆临界和 α-特征值计算的 Krylov 子空间方法（例如 Arnoldi 方法）中，早期迭代的 Ritz 值可能瞬态地反映值域而非谱，这使得用于加速和目标选择的谱位移选择变得复杂。\n\n从以上定义以及 $W(A)$ 的实部极值是厄米部 $H$ 的极值特征值（此性质源于厄米矩阵瑞利商的变分特征）这一基本性质出发，考虑一个 1 步 Arnoldi 过程。该过程使用单位向量 $v_{1}$ 进行初始化，此向量取为 $H$ 的最小特征值所对应的归一化特征向量。1 步 Ritz 值等于 $h_{11} = v_{1}^{*} A v_{1}$。\n\n任务：对于给定的 $A$ 和 $L=2\\sqrt{2}$，显式推导 $H$，确定其最小特征值和相应的归一化特征向量 $v_{1}$，然后计算 1 步 Ritz 值 $h_{11} = v_{1}^{*} A v_{1}$。解释为什么这个 $h_{11}$ 量化了 Ritz 值暂时偏离 $A$ 真实特征值的漂移，并由此说明当值域远离谱簇时，位移选择会如何被早期迭代所误导。将你的最终答案 $h_{11}$ 表示为一个实数。无需四舍五入。",
            "solution": "分析过程首先构造矩阵 $A$，然后是其厄米部 $H$，接着确定找到起始向量 $v_{1}$ 所需的 $H$ 的谱特性。最后，计算 1 步 Ritz 值 $h_{11}$。\n\n给定参数 $L = 2\\sqrt{2}$，矩阵 $N$ 为：\n$$\nN = \\begin{pmatrix}\n0  2\\sqrt{2}  0 \\\\\n0  0  2\\sqrt{2} \\\\\n0  0  0\n\\end{pmatrix}\n$$\n矩阵 $A$ 定义为 $A = I + N$，其中 $I$ 是 $3 \\times 3$ 的单位矩阵。\n$$\nA = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix} + \\begin{pmatrix}\n0  2\\sqrt{2}  0 \\\\\n0  0  2\\sqrt{2} \\\\\n0  0  0\n\\end{pmatrix} = \\begin{pmatrix}\n1  2\\sqrt{2}  0 \\\\\n0  1  2\\sqrt{2} \\\\\n0  0  1\n\\end{pmatrix}\n$$\n接下来，我们计算 $A$ 的共轭转置，记为 $A^{*}$。由于 $A$ 的所有元素都是实数，这等价于其转置 $A^{T}$。\n$$\nA^{*} = \\begin{pmatrix}\n1  0  0 \\\\\n2\\sqrt{2}  1  0 \\\\\n0  2\\sqrt{2}  1\n\\end{pmatrix}\n$$\n$A$ 的厄米部为 $H = \\frac{A + A^{*}}{2}$。\n$$\nH = \\frac{1}{2} \\left( \\begin{pmatrix}\n1  2\\sqrt{2}  0 \\\\\n0  1  2\\sqrt{2} \\\\\n0  0  1\n\\end{pmatrix} + \\begin{pmatrix}\n1  0  0 \\\\\n2\\sqrt{2}  1  0 \\\\\n0  2\\sqrt{2}  1\n\\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix}\n2  2\\sqrt{2}  0 \\\\\n2\\sqrt{2}  2  2\\sqrt{2} \\\\\n0  2\\sqrt{2}  2\n\\end{pmatrix} = \\begin{pmatrix}\n1  \\sqrt{2}  0 \\\\\n\\sqrt{2}  1  \\sqrt{2} \\\\\n0  \\sqrt{2}  1\n\\end{pmatrix}\n$$\n为了求 $H$ 的特征值，我们求解特征方程 $\\det(H - \\lambda I) = 0$。\n$$\n\\det \\begin{pmatrix}\n1-\\lambda  \\sqrt{2}  0 \\\\\n\\sqrt{2}  1-\\lambda  \\sqrt{2} \\\\\n0  \\sqrt{2}  1-\\lambda\n\\end{pmatrix} = 0\n$$\n沿第一行展开行列式：\n$$\n(1-\\lambda) \\left[(1-\\lambda)^2 - (\\sqrt{2})^2\\right] - \\sqrt{2} \\left[\\sqrt{2}(1-\\lambda) - 0\\right] = 0\n$$\n$$\n(1-\\lambda) \\left((1-\\lambda)^2 - 2\\right) - 2(1-\\lambda) = 0\n$$\n提出公因子 $(1-\\lambda)$：\n$$\n(1-\\lambda) \\left[ (1-\\lambda)^2 - 2 - 2 \\right] = 0\n$$\n$$\n(1-\\lambda) \\left[ (1-\\lambda)^2 - 4 \\right] = 0\n$$\n这给出了 $\\lambda$ 的三个可能解：\n$1 - \\lambda = 0 \\implies \\lambda_1 = 1$\n$(1 - \\lambda)^2 = 4 \\implies 1 - \\lambda = \\pm 2$\n$1 - \\lambda = 2 \\implies \\lambda_2 = -1$\n$1 - \\lambda = -2 \\implies \\lambda_3 = 3$\n$H$ 的特征值为 $\\{-1, 1, 3\\}$。最小特征值为 $\\lambda_{\\min} = -1$。\n\n现在我们通过求解 $(H - \\lambda_{\\min} I)v = 0$，即 $(H+I)v=0$，来找到对应于 $\\lambda_{\\min} = -1$ 的特征向量 $v$。\n$$\n\\begin{pmatrix}\n1+1  \\sqrt{2}  0 \\\\\n\\sqrt{2}  1+1  \\sqrt{2} \\\\\n0  \\sqrt{2}  1+1\n\\end{pmatrix} \\begin{pmatrix} x \\\\ y \\\\ z \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\implies \\begin{pmatrix}\n2  \\sqrt{2}  0 \\\\\n\\sqrt{2}  2  \\sqrt{2} \\\\\n0  \\sqrt{2}  2\n\\end{pmatrix} \\begin{pmatrix} x \\\\ y \\\\ z \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n根据第一行：$2x + \\sqrt{2}y = 0 \\implies y = -\\frac{2}{\\sqrt{2}}x = -\\sqrt{2}x$。\n根据第三行：$\\sqrt{2}y + 2z = 0 \\implies z = -\\frac{\\sqrt{2}}{2}y = -\\frac{\\sqrt{2}}{2}(-\\sqrt{2}x) = x$。\n第二行，$\\sqrt{2}x + 2y + \\sqrt{2}z = \\sqrt{2}x + 2(-\\sqrt{2}x) + \\sqrt{2}x = 2\\sqrt{2}x - 2\\sqrt{2}x = 0$，是一致的。\n因此，任何特征向量的形式都为 $c \\begin{pmatrix} 1 \\\\ -\\sqrt{2} \\\\ 1 \\end{pmatrix}$，其中 $c$ 为非零常数。我们选择 $c=1$。\n问题说明起始向量 $v_1$ 必须是归一化的。我们计算其欧几里得范数：\n$$\n\\|v\\|_2 = \\sqrt{1^2 + (-\\sqrt{2})^2 + 1^2} = \\sqrt{1 + 2 + 1} = \\sqrt{4} = 2\n$$\n归一化的特征向量 $v_1$ 是：\n$$\nv_1 = \\frac{v}{\\|v\\|_2} = \\frac{1}{2}\\begin{pmatrix} 1 \\\\ -\\sqrt{2} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ -\\sqrt{2}/2 \\\\ 1/2 \\end{pmatrix}\n$$\n最后，我们计算 1 步 Ritz 值 $h_{11} = v_{1}^{*} A v_{1}$。\n首先，我们计算乘积 $A v_{1}$：\n$$\nA v_1 = \\begin{pmatrix}\n1  2\\sqrt{2}  0 \\\\\n0  1  2\\sqrt{2} \\\\\n0  0  1\n\\end{pmatrix} \\begin{pmatrix} 1/2 \\\\ -\\sqrt{2}/2 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix}\n1(1/2) + 2\\sqrt{2}(-\\sqrt{2}/2) + 0 \\\\\n0 + 1(-\\sqrt{2}/2) + 2\\sqrt{2}(1/2) \\\\\n0 + 0 + 1(1/2)\n\\end{pmatrix} = \\begin{pmatrix}\n1/2 - 2 \\\\\n-\\sqrt{2}/2 + \\sqrt{2} \\\\\n1/2\n\\end{pmatrix} = \\begin{pmatrix}\n-3/2 \\\\\n\\sqrt{2}/2 \\\\\n1/2\n\\end{pmatrix}\n$$\n现在，我们计算内积 $v_1^{*} (A v_1)$。由于 $v_1$ 是实向量，$v_1^{*} = v_1^{T}$。\n$$\nh_{11} = \\begin{pmatrix} 1/2  -\\sqrt{2}/2  1/2 \\end{pmatrix} \\begin{pmatrix} -3/2 \\\\ \\sqrt{2}/2 \\\\ 1/2 \\end{pmatrix}\n$$\n$$\nh_{11} = \\left(\\frac{1}{2}\\right)\\left(-\\frac{3}{2}\\right) + \\left(-\\frac{\\sqrt{2}}{2}\\right)\\left(\\frac{\\sqrt{2}}{2}\\right) + \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = -\\frac{3}{4} - \\frac{2}{4} + \\frac{1}{4} = \\frac{-3-2+1}{4} = \\frac{-4}{4} = -1\n$$\n计算出的 1 步 Ritz 值为 $h_{11} = -1$。\n\n### 意义解释\n矩阵 $A$ 是一个上三角矩阵，因此其特征值就是其对角线元素。所以，$A$ 的谱为 $\\sigma(A) = \\{1\\}$。应用于 $A$ 的特征值算法的目标就是找到这个特征值。\n\nArnoldi 方法生成 Ritz 值，它们是 $A$ 的特征值的近似。一个关键性质是所有 Ritz 值都必须位于值域 $W(A)$ 之内。$W(A)$ 中任意点 $z$ 的实部由 $\\Re(z) = \\frac{x^{*}Hx}{x^{*}x}$ 给出。一个基本定理指出，$W(A)$ 上 $\\Re(z)$ 的最小值和最大值分别是 $H$ 的最小和最大特征值。我们已经求得 $\\lambda_{\\min}(H) = -1$ 和 $\\lambda_{\\max}(H) = 3$。这意味着值域 $W(A)$ 在实轴方向上从 $-1$ 延伸到 $3$，这比谱的凸包（仅为单点 $\\{1\\}$）要大得多。这种差异是非正规矩阵的一个标志。\n\n问题指定的起始向量 $v_1$ 是 $H$ 对应于 $\\lambda_{\\min}(H) = -1$ 的特征向量。这个向量特意探查了值域的极值边界。由此产生的 1 步 Ritz 值 $h_{11} = v_1^{*} A v_1$ 得出 $-1$。这个值与 $\\lambda_{\\min}(H)$ 相同，而后者是 $W(A)$ 中任意点可能具有的最小实部。\n\n这个结果说明了在反应堆物理中遇到的非正规特征值问题上使用 Krylov 方法的一个关键挑战。对特征值的第一个近似 ($h_{11} = -1$) 与真实特征值 ($\\lambda = 1$) 相去甚远。在旨在寻找主 k-特征值（物理上接近 $1$）的实际模拟中，$-1$ 这个初始估计是极具误导性的。如果使用这个早期的 Ritz 值来选择加速收敛的位移参数（例如，在移位-求逆 Arnoldi 方法中），所选的位移将会非常差，可能导致收敛极慢或收敛到一个非物理模式。早期 Ritz 值探索值域边界而非聚集在特征值周围的现象，是该矩阵非正规性的直接后果，而在本模型中，这种非正规性是由迎风离散化参数 $L$ 驱动的。",
            "answer": "$$\n\\boxed{-1}\n$$"
        },
        {
            "introduction": "在大型反应堆模拟中，理论算法必须适配实际的计算限制。本练习  将引导你进行一次性能建模与优化实践，目标是在内存限制和数值稳定性要求下，为重启动分块Arnoldi方法选择最佳的块大小和重启动长度。通过构建并最小化一个包含计算与通信成本的总时间模型，你将学会如何在算法参数之间进行权衡，以在给定的计算资源下实现最快的求解速度。",
            "id": "4232472",
            "problem": "在一个三维压水反应堆 k-特征值模拟中，考虑由一个无矩阵的裂变-输运算子应用所近似的多群中子输运算子的主特征对。迭代求解器使用重启动分块 Arnoldi 方法来构建一个 Krylov 子空间，用于 Rayleigh–Ritz 提取。假设存在以下基础建模要素：\n\n- 基模的中子输运特征值问题由谱问题 $A x = \\lambda x$ 建模，其中 $A$ 是一个线性化固定源算子，它封装了输运扫描、散射和裂变源的应用。输运扫描在不显式组装 $A$ 的情况下执行，而 $A$ 对一个向量的作用是通过一次源应用后跟一次输运扫描来实现的。\n- 块大小为 $b$、重启长度为 $m$ 的重启动分块 Arnoldi 方法在每个循环中构建一个维度为 $m b$ 的子空间，将每 $b$ 个向量组成的新块与现有基进行正交化，并在每个循环结束时执行 Rayleigh–Ritz 提取。\n\n给定此反应堆问题的以下物理和计算驱动的参数与约束：\n\n1. 基模的谱分离：设 $q = |\\lambda_{2} / \\lambda_{1}| = 0.92$，其中 $\\lambda_{1}$ 是主特征值，$\\lambda_{2}$ 是模第二大的特征值。假设重启动 Arnoldi 方法采用一个多项式滤波模型，其中每个循环的残差减小量近似为 $q^{m}$，因此要实现残差从 $1$ 减小到 $10^{-6}$，需要的总有效多项式次数至少为 $d^{\\star}$，满足 $q^{d^{\\star}} \\leq 10^{-6}$。\n2. 内存约束：存储基向量是内存使用的主要部分。每个向量需要 $40$ 兆字节，总可用内存为 $3.2$ 吉字节。这导致 $m b \\leq 80$ 的约束。\n3. 稳健提取约束：为确保稳定的 Ritz 值和 Ritz 向量提取并降低停滞风险，要求 $m \\geq 6$。\n4. 单个循环内的每步成本模型：\n   - 在一个 Arnoldi 步骤中，作用于大小为 $b$ 的块的源应用和输运扫描时间建模为 $T_{\\mathrm{src}}(b) = \\theta_{0} + \\theta_{1} b$，其中 $\\theta_{0} = 0.06$ 秒，表示在块上分摊的设置和边界条件处理时间，$\\theta_{1} = 0.08$ 秒/右端项，捕捉了扫描工作量随 $b$ 线性扩展的特性。\n   - 在步骤 $j$（循环内 $j = 1, 2, \\dots, m$），将包含 $b$ 个向量的新进块与现有的 $j b$ 个基向量进行分块经典 Gram–Schmidt（两次）正交化的时间建模为\n     $$T_{\\mathrm{orth,step}}(j, b) = 2 \\big( t_{\\mathrm{dot}} + t_{\\mathrm{axpy}} \\big) \\, j b^{2},$$\n     其中 $t_{\\mathrm{dot}} = 0.002$ 秒/等效分块内积，$t_{\\mathrm{axpy}} = 0.003$ 秒/等效分块更新，得出 $T_{\\mathrm{orth,step}}(j, b) = 0.01 \\, j b^{2}$ 秒。\n   - 每个循环的 Rayleigh–Ritz 和小型稠密特征问题求解时间近似为一个常数 $T_{\\mathrm{rr}} = 0.02$ 秒/循环。\n\n5. 对于给定的 $b$ 和 $m$，每个循环的总时间是循环内 $m$ 次源应用时间、整个循环的累积正交化时间以及 Rayleigh–Ritz 时间的总和：\n   $$T_{\\mathrm{cycle}}(b, m) = m \\, T_{\\mathrm{src}}(b) + \\sum_{j=1}^{m} T_{\\mathrm{orth,step}}(j, b) + T_{\\mathrm{rr}}.$$\n\n6. 为达到目标残差减小量所需的循环次数 $L$ 是满足 $q^{L m} \\leq 10^{-6}$ 的最小整数。\n\n使用这些定义和约束：\n\n- 推导出 $d^{\\star}$ 以及用 $m$ 表示的 $L$ 的表达式。\n- 推导出 $T_{\\mathrm{cycle}}(b, m)$ 的闭式表达式。\n- 在给定模型下，构建总预测求解时间 $T_{\\mathrm{total}}(b, m) = L \\, T_{\\mathrm{cycle}}(b, m)$。\n- 在满足 $b \\geq 1$、$m \\geq 6$ 和 $m b \\leq 80$ 的可行整数对 $(b, m)$ 中，确定使 $T_{\\mathrm{total}}(b, m)$ 最小化的对 $(b^{\\star}, m^{\\star})$。\n\n将所选的块大小和重启长度以单行矩阵 $\\begin{pmatrix} b^{\\star}  m^{\\star} \\end{pmatrix}$ 的形式报告。最终答案无需四舍五入。如果执行任何中间数值计算，请精确进行，不要对最终选择值进行四舍五入。",
            "solution": "首先，我们推导所需的总多项式次数 $d^{\\star}$ 和循环次数 $L$。\n条件是 $q^{L m} \\leq 10^{-6}$。问题将 $d^{\\star}$ 定义为所需的最小总次数。总次数为 $L m$。\n因此，我们必须有 $L m \\geq d^{\\star}$，其中 $d^{\\star}$ 满足 $q^{d^{\\star}} = 10^{-6}$。\n$$\nd^{\\star} \\ln(q) = \\ln(10^{-6}) = -6 \\ln(10)\n$$\n$$\nd^{\\star} = \\frac{-6 \\ln(10)}{\\ln(q)} = \\frac{-6 \\ln(10)}{\\ln(0.92)}\n$$\n我们定义一个常数 $C = d^{\\star} = \\frac{-6 \\ln(10)}{\\ln(0.92)}$。\n循环次数 $L$ 是使得 $L m \\geq C$ 的最小整数。这可以写成：\n$$\nL = \\left\\lceil \\frac{C}{m} \\right\\rceil\n$$\n接下来，我们推导每个循环时间 $T_{\\mathrm{cycle}}(b, m)$ 的闭式表达式。\n$$\nT_{\\mathrm{cycle}}(b, m) = m \\, T_{\\mathrm{src}}(b) + \\sum_{j=1}^{m} T_{\\mathrm{orth,step}}(j, b) + T_{\\mathrm{rr}}\n$$\n代入给定的模型：\n$$\nT_{\\mathrm{cycle}}(b, m) = m (\\theta_{0} + \\theta_{1} b) + \\sum_{j=1}^{m} (0.01 \\, j b^{2}) + T_{\\mathrm{rr}}\n$$\n求和项是一个等差数列：\n$$\n\\sum_{j=1}^{m} (0.01 \\, j b^{2}) = 0.01 \\, b^{2} \\sum_{j=1}^{m} j = 0.01 \\, b^{2} \\frac{m(m+1)}{2} = 0.005 \\, m (m+1) b^{2}\n$$\n所以，循环时间为：\n$$\nT_{\\mathrm{cycle}}(b, m) = m (\\theta_{0} + \\theta_{1} b) + 0.005 \\, m (m+1) b^{2} + T_{\\mathrm{rr}}\n$$\n代入数值 $\\theta_{0}=0.06$, $\\theta_{1}=0.08$ 和 $T_{\\mathrm{rr}}=0.02$：\n$$\nT_{\\mathrm{cycle}}(b, m) = m(0.06 + 0.08 b) + 0.005 \\, m (m+1) b^{2} + 0.02\n$$\n总求解时间为：\n$$\nT_{\\mathrm{total}}(b, m) = L \\cdot T_{\\mathrm{cycle}}(b, m) = \\left\\lceil \\frac{C}{m} \\right\\rceil \\left( 0.06 m + 0.08 m b + 0.005 m(m+1) b^2 + 0.02 \\right)\n$$\n我们需要在由以下条件定义的可行整数对 $(b, m)$ 集合上最小化此函数：\n$b \\geq 1$，$m \\geq 6$，以及 $m b \\leq 80$。\n\n让我们分析 $T_{\\mathrm{total}}(b, m)$ 对 $b$ 的依赖性（对于固定的 $m$）。循环次数 $L = \\lceil C/m \\rceil$ 不依赖于 $b$。我们只需要分析 $T_{\\mathrm{cycle}}(b, m)$。\n$$\nT_{\\mathrm{cycle}}(b, m) = (0.06 m + 0.02) + (0.08 m) b + (0.005 m(m+1)) b^2\n$$\n对于固定的 $m \\geq 6$，这是一个关于 $b$ 的二次函数。$b$ 和 $b^2$ 项的系数 $0.08 m$ 和 $0.005 m(m+1)$ 都是正的。因此，对于 $b \\geq 1$，$T_{\\mathrm{cycle}}(b, m)$ 是 $b$ 的严格递增函数。因此，对于任何固定的 $m$，$T_{\\mathrm{total}}(b, m)$ 也随 $b$ 严格递增。\n这意味着对于任何给定的重启长度 $m$，最小时间是在最小可能的块大小处实现的，即 $b=1$。\n因此，最优块大小是 $b^{*}=1$。\n\n问题现在简化为一个一维优化问题：找到在可行范围 $m \\geq 6$ 和 $1 \\cdot m \\leq 80$ 内使 $T_{\\mathrm{total}}(1, m)$ 最小化的整数 $m$。所以我们在整数区间 $[6, 80]$ 中搜索 $m^{\\star}$。\n让我们定义要最小化的函数：\n$$\nf(m) = T_{\\mathrm{total}}(1, m) = \\left\\lceil \\frac{C}{m} \\right\\rceil \\left( 0.06 m + 0.08 m (1) + 0.005 m(m+1) (1)^2 + 0.02 \\right)\n$$\n$$\nf(m) = \\left\\lceil \\frac{C}{m} \\right\\rceil \\left( 0.14 m + 0.005 m^2 + 0.005 m + 0.02 \\right)\n$$\n$$\nf(m) = \\left\\lceil \\frac{C}{m} \\right\\rceil \\left( 0.005 m^2 + 0.145 m + 0.02 \\right)\n$$\n我们需要 $C$ 的数值：\n$C = \\frac{-6 \\ln(10)}{\\ln(0.92)} \\approx \\frac{-6 \\times 2.302585}{-0.0833816} \\approx 165.69055$。\n\n函数 $f(m)$ 是一个非递增阶梯函数 $L(m) = \\lceil C/m \\rceil$ 和一个严格递增的二次函数 $T(m) = 0.005 m^2 + 0.145 m + 0.02$ 的乘积。结果函数不一定是单调的。我们必须从 $m=6$ 开始评估 $m$ 的整数值的 $f(m)$。\n\n对于 $m=6$：\n$L(6) = \\lceil 165.69055 / 6 \\rceil = \\lceil 27.615 \\rceil = 28$。\n$T(6) = 0.005(6^2) + 0.145(6) + 0.02 = 0.005(36) + 0.87 + 0.02 = 0.18 + 0.87 + 0.02 = 1.07$。\n$f(6) = 28 \\times 1.07 = 29.96$。\n\n对于 $m=7$：\n$L(7) = \\lceil 165.69055 / 7 \\rceil = \\lceil 23.67 \\rceil = 24$。\n$T(7) = 0.005(7^2) + 0.145(7) + 0.02 = 0.005(49) + 1.015 + 0.02 = 0.245 + 1.015 + 0.02 = 1.28$。\n$f(7) = 24 \\times 1.28 = 30.72$。\n\n对于 $m=8$：\n$L(8) = \\lceil 165.69055 / 8 \\rceil = \\lceil 20.71 \\rceil = 21$。\n$T(8) = 0.005(8^2) + 0.145(8) + 0.02 = 0.005(64) + 1.16 + 0.02 = 0.32 + 1.16 + 0.02 = 1.50$。\n$f(8) = 21 \\times 1.50 = 31.50$。\n\n$f(m)$ 的值正在增加。一个连续近似 $f_{\\text{approx}}(m) \\approx \\frac{C}{m} T(m) = C(0.005m + 0.145 + 0.02/m)$ 的最小值在 $m = \\sqrt{0.02/0.005} = \\sqrt{4} = 2$ 处。对于 $m \\geq 6$，连续近似是严格递增的，这表明离散函数的最小值也将在 $m=6$ 处。然而，向上取整函数可能会导致局部下降。让我们检查一个 $L(m)$ 显著下降的点。\n\n对于 $m=11$：\n$L(11) = \\lceil 165.69055 / 11 \\rceil = \\lceil 15.06 \\rceil = 16$。\n$T(11) = 0.005(11^2) + 0.145(11) + 0.02 = 0.605 + 1.595 + 0.02 = 2.22$。\n$f(11) = 16 \\times 2.22 = 35.52$。\n\n对于 $m=12$：\n$L(12) = \\lceil 165.69055 / 12 \\rceil = \\lceil 13.807 \\rceil = 14$。\n$T(12) = 0.005(12^2) + 0.145(12) + 0.02 = 0.72 + 1.74 + 0.02 = 2.48$。\n$f(12) = 14 \\times 2.48 = 34.72$。\n\n我们观察到从 $f(11)$到 $f(12)$ 有一个下降，但值 $34.72$ 仍然显著大于 $f(6) = 29.96$。\n由于 $T(m)$ 的强二次增长超过了 $L(m)$ 的 $1/m$ 下降，对于 $m \\geq 6$，$f(m)$ 的总体趋势是增加的。局部下降将不足以低于 $m=6$ 时的值。因此，最小值出现在 $m$ 的允许最小值处。\n\n可行集中 $m$ 的最小值是 $m=6$。\n因此，最优重启长度是 $m^{\\star}=6$。\n\n最优对是 $(b^{\\star}, m^{\\star}) = (1, 6)$。这对满足所有约束：$b=1 \\geq 1$，$m=6 \\geq 6$，以及 $mb = 1 \\times 6 = 6 \\leq 80$。\n\n最优对 $(b^{\\star}, m^{\\star})$ 是 $(1, 6)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  6\n\\end{pmatrix}\n}\n$$"
        }
    ]
}