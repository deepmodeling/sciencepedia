{
    "hands_on_practices": [
        {
            "introduction": "To effectively apply the forced collision technique, one must first grasp its theoretical underpinnings. This initial exercise focuses on deriving the two most fundamental quantities from first principles: the probability of a particle interacting within a defined region, and the correct statistical weight to assign to a history where this interaction is \"forced\" to happen. Mastering this derivation ensures a solid understanding of how the method preserves the unbiased nature of the Monte Carlo simulation .",
            "id": "4246746",
            "problem": "Consider a one-dimensional homogeneous slab of thickness $d$ with constant macroscopic total cross section $\\Sigma_{t}$, traversed perpendicularly by a neutral particle of initial statistical weight $w_{0}$ entering at $x=0$. In analog Monte Carlo (MC) transport, collisions along the flight path are modeled as a spatial Poisson process with rate $\\Sigma_{t}$ per unit length, and the free-path length is distributed exponentially. A common variance-reduction technique in sampling collision types is the \"forced collision\" method over a finite region: instead of allowing the history to escape without interaction, one forces a collision within the slab by sampling the collision depth from the appropriate conditional probability density function (PDF), while separately accounting for uncollided transmission.\n\nStarting from the Beer–Lambert attenuation law and the Poisson-process model of collisions in a homogeneous medium, derive the probability that at least one collision occurs before exiting the slab, and then derive the weight to assign to the forced-collision history such that unbiasedness is preserved for any collision-based tally that depends on the collision depth $x \\in [0,d]$. Express your final answers symbolically in terms of $\\Sigma_{t}$, $d$, and $w_{0}$. No numerical evaluation is required. If you introduce intermediate PDFs in your derivation, write them explicitly. Provide your final expressions in analytic closed form. Do not include any units in your final expressions.",
            "solution": "The problem asks for two quantities related to particle transport in a one-dimensional slab: the probability of at least one collision within the slab, and the weight adjustment required for the forced collision variance reduction technique. The derivation will be based on the principles of particle transport and statistical sampling.\n\nThe fundamental model for neutral particle transport in a homogeneous medium is a spatial Poisson process. The rate of collisions per unit length is given by the macroscopic total cross section, $\\Sigma_{t}$. From this, the probability distribution of the free-path length, $s$, which is the distance a particle travels between collisions, is exponential. The probability density function (PDF) for the first collision to occur at a depth $x$, for a particle entering at $x=0$, is given by:\n$$p(x) = \\Sigma_{t} \\exp(-\\Sigma_{t} x), \\quad x \\ge 0$$\n\nPart 1: Probability of at least one collision in the slab\nA particle entering at $x=0$ exits the slab if it travels a distance greater than the slab thickness, $d$, without interacting. The probability of the particle having no collision within the interval $[0, d]$ is equivalent to the probability that its first collision occurs at a depth $x > d$. This probability, which we denote as $P_{trans}$ (for transmission), can be calculated by integrating the free-path PDF from $d$ to infinity:\n$$P_{trans} = P(x > d) = \\int_{d}^{\\infty} p(x) \\,dx = \\int_{d}^{\\infty} \\Sigma_{t} \\exp(-\\Sigma_{t} x) \\,dx$$\nEvaluating the integral:\n$$P_{trans} = \\Sigma_{t} \\left[ -\\frac{1}{\\Sigma_{t}} \\exp(-\\Sigma_{t} x) \\right]_{d}^{\\infty} = -[\\exp(-\\Sigma_{t} x)]_{d}^{\\infty}$$\n$$P_{trans} = -(\\lim_{x\\to\\infty} \\exp(-\\Sigma_{t} x) - \\exp(-\\Sigma_{t} d)) = -(0 - \\exp(-\\Sigma_{t} d)) = \\exp(-\\Sigma_{t} d)$$\nThis result is the well-known Beer–Lambert law for particle attenuation.\n\nThe event \"at least one collision occurs before exiting the slab\" is the complement of the event \"the particle is transmitted without collision\". Therefore, the probability of at least one collision, which we denote as $P_{coll}$, is:\n$$P_{coll} = 1 - P_{trans} = 1 - \\exp(-\\Sigma_{t} d)$$\n\nPart 2: Weight for the forced-collision history\nThe objective of a Monte Carlo simulation is to estimate the expected value of some quantity (a tally). For a simulation to be unbiased, the expected score from the non-analog (variance-reduced) scheme must be identical to the expected score from the analog scheme.\n\nLet $T(x)$ be the score contributed to a tally if a collision occurs at depth $x \\in [0, d]$. In an analog simulation, a particle starts with weight $w_0$. The expected score from collisions within the slab, $E_{analog}[\\text{Tally}]$, is the integral of the score at $x$ multiplied by the probability density of a collision occurring at $x$:\n$$E_{analog}[\\text{Tally}] = \\int_{0}^{d} (w_0 T(x)) p(x) \\,dx = \\int_{0}^{d} w_0 T(x) \\Sigma_{t} \\exp(-\\Sigma_{t} x) \\,dx$$\nNote that this expression correctly represents the expectation over the subset of histories that collide within the slab. The histories that are transmitted do not contribute to a collision-based tally within the slab.\n\nIn the forced collision method, two things are changed. First, the uncollided transmission is handled deterministically. A weight equal to $w_0 P_{trans} = w_0 \\exp(-\\Sigma_{t} d)$ is immediately tallied as transmitted, and removed from the active particle weight. The remaining weight, $w_0' = w_0 (1-P_{trans}) = w_0(1-\\exp(-\\Sigma_t d))$, is assigned to a particle that is *forced* to collide within the slab. This is a common implementation, but the problem asks for the weight of the history itself, sampled from a conditional PDF, which is a slightly different but equivalent perspective. Let us follow the problem's framing.\n\nThe problem states we force a collision to occur within the slab $[0, d]$ by sampling from an appropriate conditional PDF. This means we are sampling from the PDF of collision locations, $p(x)$, conditioned on the event that the collision occurs within $[0, d]$. Let's call this new sampling PDF $p_{forced}(x)$. By definition of conditional probability:\n$$p_{forced}(x) \\equiv p(x | x \\in [0, d]) = \\frac{p(x)}{P(x \\in [0, d])}$$\nWe have already calculated $P(x \\in [0, d]) = P_{coll} = 1 - \\exp(-\\Sigma_{t} d)$.\nThus, the PDF used to sample the forced collision site is:\n$$p_{forced}(x) = \\frac{\\Sigma_{t} \\exp(-\\Sigma_{t} x)}{1 - \\exp(-\\Sigma_{t} d)}, \\quad \\text{for } x \\in [0, d]$$\nand $p_{forced}(x)=0$ otherwise.\n\nIn this forced collision scheme, a collision is guaranteed to occur in $[0, d]$. We sample the collision site $x$ from $p_{forced}(x)$. To maintain an unbiased estimate, the particle's weight must be adjusted. Let the new weight assigned to this forced-collision history be $w_{forced}$. The expected score in the forced collision scheme, $E_{forced}[\\text{Tally}]$, is:\n$$E_{forced}[\\text{Tally}] = \\int_{0}^{d} (w_{forced} T(x)) p_{forced}(x) \\,dx$$\nSubstituting the expression for $p_{forced}(x)$:\n$$E_{forced}[\\text{Tally}] = \\int_{0}^{d} w_{forced} T(x) \\frac{\\Sigma_{t} \\exp(-\\Sigma_{t} x)}{1 - \\exp(-\\Sigma_{t} d)} \\,dx$$\n\nFor the tally to be unbiased, the expected scores from both the analog and forced schemes must be equal for any arbitrary tally function $T(x)$:\n$$E_{analog}[\\text{Tally}] = E_{forced}[\\text{Tally}]$$\n$$\\int_{0}^{d} w_0 T(x) \\Sigma_{t} \\exp(-\\Sigma_{t} x) \\,dx = \\int_{0}^{d} w_{forced} T(x) \\frac{\\Sigma_{t} \\exp(-\\Sigma_{t} x)}{1 - \\exp(-\\Sigma_{t} d)} \\,dx$$\nSince this equality must hold for any valid, non-trivial tally function $T(x)$, the integrands must be equal:\n$$w_0 T(x) \\Sigma_{t} \\exp(-\\Sigma_{t} x) = w_{forced} T(x) \\frac{\\Sigma_{t} \\exp(-\\Sigma_{t} x)}{1 - \\exp(-\\Sigma_{t} d)}$$\nWe can cancel the common terms $T(x)$, $\\Sigma_{t}$, and $\\exp(-\\Sigma_{t} x)$ from both sides (as they are non-zero over the domain of integration):\n$$w_0 = \\frac{w_{forced}}{1 - \\exp(-\\Sigma_{t} d)}$$\nSolving for the weight of the forced-collision history, $w_{forced}$:\n$$w_{forced} = w_0 (1 - \\exp(-\\Sigma_{t} d))$$\nThis result confirms the intuition that when we force an event to occur (that had an original probability of $P_{coll}$), we must multiply the particle's weight by that probability to preserve the expected outcome. The weight to be assigned is the initial weight $w_0$ multiplied by the probability of at least one collision, $P_{coll}$.\n\nThe two quantities requested are:\n1.  The probability of at least one collision: $P_{coll} = 1 - \\exp(-\\Sigma_{t} d)$.\n2.  The weight to assign to the forced-collision history: $w_{forced} = w_0 (1 - \\exp(-\\Sigma_{t} d))$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 - \\exp(-\\Sigma_{t} d) & w_{0} (1 - \\exp(-\\Sigma_{t} d))\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Real-world nuclear systems are rarely simple homogeneous materials; they are complex, heterogeneous assemblies. This practice extends the foundational concept of forced collision to a more realistic scenario involving a particle path that crosses multiple material layers with different properties, including a complete void . By tackling this problem, you will learn to generalize the core principles to handle piecewise-constant cross sections, a crucial skill for practical transport simulations.",
            "id": "4227234",
            "problem": "A particle transport simulation in a heterogeneous cell employs a forced collision technique along a straight chord traversed by a neutral particle. The linear Boltzmann equation for neutral particle transport along a one-dimensional path implies that the survival probability $S(s)$ of no collision up to pathlength $s$ satisfies $\\frac{dS}{ds}=-\\Sigma_{t}(s)S(s)$ with solution $S(s)=\\exp\\!\\left(-\\int_{0}^{s}\\Sigma_{t}(u)\\,du\\right)$ for piecewise constant macroscopic total cross section $\\Sigma_{t}(s)$. The forced collision method splits the particle weight into a collision portion and a leakage portion conditioned on whether a collision occurs prior to exit.\n\nConsider a chord that first passes through a void subregion of length $L_{0}$ with $\\Sigma_{t}(s)=0$ (no material), then through two nonvoid material subregions with piecewise constant total cross sections: segment $1$ has length $L_{1}$ and $\\Sigma_{t}(s)=\\Sigma_{1}$, and segment $2$ has length $L_{2}$ and $\\Sigma_{t}(s)=\\Sigma_{2}$. The particle enters the chord at $s=0$ with initial weight $w_{0}$. The material reaction of interest is absorption, with macroscopic absorption cross sections $\\Sigma_{a1}$ in segment $1$ and $\\Sigma_{a2}$ in segment $2$. Assume straight-line flight with no angular effects, and neglect sources and scattering outside the reaction selection at the collision site.\n\nTasks:\n1. Starting from the survival definition $S(s)=\\exp\\!\\left(-\\int_{0}^{s}\\Sigma_{t}(u)\\,du\\right)$ and the probability density function (PDF) for the free-path to the first collision $f(s)=\\Sigma_{t}(s)S(s)$, derive the weight split into a collision portion $w_{c}$ and a leakage portion $w_{\\ell}$ for this chord, and obtain the conditional PDF for the collision location along the chord under forced collision, explicitly accounting for the void subregion with $\\Sigma_{t}=0$ and the piecewise constant $\\Sigma_{t}$ in the two material segments.\n2. Using the derived conditional collision PDF and the reaction selection probabilities $p_{a1}=\\Sigma_{a1}/\\Sigma_{1}$ and $p_{a2}=\\Sigma_{a2}/\\Sigma_{2}$, derive a closed-form expression for the expected absorbed weight $W_{\\text{abs}}$ contributed by a single forced collision along the chord.\n3. Evaluate your expression for the following physically plausible parameters: $w_{0}=1$, $L_{0}=2\\,\\text{cm}$, $L_{1}=0.5\\,\\text{cm}$, $L_{2}=0.8\\,\\text{cm}$, $\\Sigma_{1}=1.2\\,\\text{cm}^{-1}$, $\\Sigma_{a1}=0.3\\,\\text{cm}^{-1}$, $\\Sigma_{2}=0.6\\,\\text{cm}^{-1}$, and $\\Sigma_{a2}=0.1\\,\\text{cm}^{-1}$. Express the final absorbed weight as a decimal fraction (unitless) and round your answer to four significant figures.",
            "solution": "The solution addresses the three tasks in order. The total length of the chord is $L = L_{0} + L_{1} + L_{2}$.\n\n**Task 1: Weight Split and Conditional Collision PDF**\n\nFirst, we determine the probability of a particle traversing the entire chord without a collision (leakage probability, $P_{\\ell}$) and the probability of it colliding somewhere along the chord (collision probability, $P_{c}$).\n\nThe total optical thickness of the chord, $\\tau_{tot}$, is the integral of the total macroscopic cross section $\\Sigma_t(s)$ over the entire path length $L$.\n$$ \\tau_{tot} = \\int_{0}^{L_{0}+L_{1}+L_{2}} \\Sigma_t(u) \\, du $$\nGiven the piecewise constant nature of $\\Sigma_t(s)$:\n$$ \\tau_{tot} = \\int_{0}^{L_{0}} 0 \\, du + \\int_{L_{0}}^{L_{0}+L_{1}} \\Sigma_{1} \\, du + \\int_{L_{0}+L_{1}}^{L_{0}+L_{1}+L_{2}} \\Sigma_{2} \\, du $$\n$$ \\tau_{tot} = 0 + \\Sigma_{1} [u]_{L_{0}}^{L_{0}+L_{1}} + \\Sigma_{2} [u]_{L_{0}+L_{1}}^{L_{0}+L_{1}+L_{2}} = \\Sigma_{1}L_{1} + \\Sigma_{2}L_{2} $$\nThe survival probability to the end of the chord, which is the leakage probability $P_{\\ell}$, is:\n$$ P_{\\ell} = S(L) = \\exp(-\\tau_{tot}) = \\exp(-(\\Sigma_{1}L_{1} + \\Sigma_{2}L_{2})) $$\nThe probability of having at least one collision within the chord is the complement of the leakage probability:\n$$ P_{c} = 1 - P_{\\ell} = 1 - \\exp(-(\\Sigma_{1}L_{1} + \\Sigma_{2}L_{2})) $$\nThe forced collision technique splits the initial weight $w_{0}$ into a leakage portion $w_{\\ell}$ and a collision portion $w_{c}$:\n$$ w_{\\ell} = w_{0} P_{\\ell} = w_{0} \\exp(-(\\Sigma_{1}L_{1} + \\Sigma_{2}L_{2})) $$\n$$ w_{c} = w_{0} P_{c} = w_{0} (1 - \\exp(-(\\Sigma_{1}L_{1} + \\Sigma_{2}L_{2}))) $$\nThese two components sum to the initial weight: $w_{c} + w_{\\ell} = w_{0}$.\n\nNext, we derive the conditional PDF for the collision location, $f_{c}(s)$, given that a collision occurs within the chord. This is the unconditional PDF, $f(s)=\\Sigma_{t}(s)S(s)$, normalized by the total probability of collision, $P_{c}$.\n$$ f_{c}(s) = \\frac{f(s)}{P_{c}} = \\frac{\\Sigma_{t}(s) S(s)}{1 - \\exp(-(\\Sigma_{1}L_{1} + \\Sigma_{2}L_{2}))} $$\nWe evaluate $f_c(s)$ for each segment of the chord. The survival probability $S(s) = \\exp(-\\int_0^s \\Sigma_t(u)du)$.\n- For $s \\in [0, L_{0}]$: $\\Sigma_{t}(s)=0$, so $f_{c}(s) = 0$. No collision can occur in a void.\n- For $s \\in (L_{0}, L_{0}+L_{1}]$:\n  $$ \\int_{0}^{s} \\Sigma_{t}(u)du = \\int_{L_{0}}^{s} \\Sigma_{1}du = \\Sigma_{1}(s-L_{0}) $$\n  $$ S(s) = \\exp(-\\Sigma_{1}(s-L_{0})) $$\n  $$ f_{c}(s) = \\frac{\\Sigma_{1} \\exp(-\\Sigma_{1}(s-L_{0}))}{1 - \\exp(-(\\Sigma_{1}L_{1} + \\Sigma_{2}L_{2}))} $$\n- For $s \\in (L_{0}+L_{1}, L_{0}+L_{1}+L_{2}]$:\n  $$ \\int_{0}^{s} \\Sigma_{t}(u)du = \\int_{L_{0}}^{L_{0}+L_{1}} \\Sigma_{1}du + \\int_{L_{0}+L_{1}}^{s} \\Sigma_{2}du = \\Sigma_{1}L_{1} + \\Sigma_{2}(s - L_{0} - L_{1}) $$\n  $$ S(s) = \\exp(-(\\Sigma_{1}L_{1} + \\Sigma_{2}(s - L_{0} - L_{1}))) $$\n  $$ f_{c}(s) = \\frac{\\Sigma_{2} \\exp(-(\\Sigma_{1}L_{1} + \\Sigma_{2}(s-L_{0}-L_{1})))}{1 - \\exp(-(\\Sigma_{1}L_{1} + \\Sigma_{2}L_{2}))} $$\n\n**Task 2: Expected Absorbed Weight**\n\nThe expected absorbed weight, $W_{\\text{abs}}$, is found by integrating the differential contribution to absorption over all possible collision locations. At a location $s$, a collision occurs with the forced collision particle of weight $w_c$. The probability of this collision resulting in absorption is $p_a(s)$. The expected absorbed weight is the integral of this absorbed weight, $w_{c} p_{a}(s)$, weighted by the conditional PDF $f_{c}(s)$.\n$$ W_{\\text{abs}} = \\int_{0}^{L_{0}+L_{1}+L_{2}} (w_{c} \\cdot p_{a}(s)) f_{c}(s) \\, ds $$\nSubstituting the expressions for $w_c$ and $f_c(s)$:\n$$ W_{\\text{abs}} = \\int_{0}^{L} \\left[ w_{0} (1 - P_{\\ell}) \\cdot p_{a}(s) \\cdot \\frac{\\Sigma_{t}(s) S(s)}{1 - P_{\\ell}} \\right] ds $$\nThe term $(1 - P_{\\ell})$ cancels, a key feature that shows the expectation is preserved.\n$$ W_{\\text{abs}} = w_{0} \\int_{0}^{L} p_{a}(s) \\Sigma_{t}(s) S(s) \\, ds $$\nUsing the definition $p_{a}(s) = \\Sigma_{a}(s) / \\Sigma_{t}(s)$, the product $p_{a}(s)\\Sigma_{t}(s)$ simplifies to the macroscopic absorption cross section $\\Sigma_{a}(s)$.\n$$ W_{\\text{abs}} = w_{0} \\int_{0}^{L_{0}+L_{1}+L_{2}} \\Sigma_{a}(s) S(s) \\, ds $$\nWe split the integral over the non-void regions:\n$$ W_{\\text{abs}} = w_{0} \\left[ \\int_{L_{0}}^{L_{0}+L_{1}} \\Sigma_{a1} S(s) \\, ds + \\int_{L_{0}+L_{1}}^{L_0+L_1+L_2} \\Sigma_{a2} S(s) \\, ds \\right] $$\nLet's evaluate the two integrals, $I_1$ and $I_2$.\n$$ I_{1} = \\int_{L_{0}}^{L_{0}+L_{1}} \\Sigma_{a1} \\exp(-\\Sigma_{1}(s-L_{0})) \\, ds = \\Sigma_{a1} \\left[ \\frac{\\exp(-\\Sigma_{1}(s-L_{0}))}{-\\Sigma_{1}} \\right]_{L_{0}}^{L_{0}+L_{1}} $$\n$$ I_{1} = -\\frac{\\Sigma_{a1}}{\\Sigma_{1}} ( \\exp(-\\Sigma_{1}L_{1}) - \\exp(0) ) = \\frac{\\Sigma_{a1}}{\\Sigma_{1}} (1 - \\exp(-\\Sigma_{1}L_{1})) = p_{a1}(1 - \\exp(-\\Sigma_{1}L_{1})) $$\nFor the second integral,\n$$ I_{2} = \\int_{L_{0}+L_{1}}^{L_{0}+L_{1}+L_{2}} \\Sigma_{a2} \\exp(-(\\Sigma_{1}L_{1} + \\Sigma_{2}(s-L_{0}-L_{1}))) \\, ds $$\n$$ I_{2} = \\Sigma_{a2} \\exp(-\\Sigma_{1}L_{1}) \\int_{L_{0}+L_{1}}^{L_{0}+L_{1}+L_{2}} \\exp(-\\Sigma_{2}(s-L_{0}-L_{1})) \\, ds $$\n$$ I_{2} = \\Sigma_{a2} \\exp(-\\Sigma_{1}L_{1}) \\left[ \\frac{\\exp(-\\Sigma_{2}(s-L_{0}-L_{1}))}{-\\Sigma_{2}} \\right]_{L_{0}+L_{1}}^{L_{0}+L_{1}+L_{2}} $$\n$$ I_{2} = -\\frac{\\Sigma_{a2}}{\\Sigma_{2}} \\exp(-\\Sigma_{1}L_{1}) (\\exp(-\\Sigma_{2}L_{2}) - \\exp(0)) = \\frac{\\Sigma_{a2}}{\\Sigma_{2}} \\exp(-\\Sigma_{1}L_{1}) (1 - \\exp(-\\Sigma_{2}L_{2})) $$\n$$ I_{2} = p_{a2} \\exp(-\\Sigma_{1}L_{1}) (1 - \\exp(-\\Sigma_{2}L_{2})) $$\nCombining the results, the total expected absorbed weight is:\n$$ W_{\\text{abs}} = w_{0} (I_{1} + I_{2}) = w_{0} \\left[ p_{a1} (1 - \\exp(-\\Sigma_{1}L_{1})) + p_{a2} \\exp(-\\Sigma_{1}L_{1}) (1 - \\exp(-\\Sigma_{2}L_{2})) \\right] $$\n\n**Task 3: Numerical Evaluation**\n\nWe are given the following parameters:\n$w_{0}=1$\n$L_{1}=0.5\\,\\text{cm}$, $\\Sigma_{1}=1.2\\,\\text{cm}^{-1}$, $\\Sigma_{a1}=0.3\\,\\text{cm}^{-1}$\n$L_{2}=0.8\\,\\text{cm}$, $\\Sigma_{2}=0.6\\,\\text{cm}^{-1}$, $\\Sigma_{a2}=0.1\\,\\text{cm}^{-1}$\n\nFirst, we calculate the required intermediate values:\n- Absorption probability in segment 1: $p_{a1} = \\frac{\\Sigma_{a1}}{\\Sigma_{1}} = \\frac{0.3}{1.2} = 0.25$\n- Absorption probability in segment 2: $p_{a2} = \\frac{\\Sigma_{a2}}{\\Sigma_{2}} = \\frac{0.1}{0.6} = \\frac{1}{6}$\n- Optical thickness of segment 1: $\\tau_{1} = \\Sigma_{1}L_{1} = 1.2 \\times 0.5 = 0.6$\n- Optical thickness of segment 2: $\\tau_{2} = \\Sigma_{2}L_{2} = 0.6 \\times 0.8 = 0.48$\n\nNow, substitute these values into the expression for $W_{\\text{abs}}$:\n$$ W_{\\text{abs}} = 1 \\cdot \\left[ 0.25 \\cdot (1 - \\exp(-0.6)) + \\frac{1}{6} \\cdot \\exp(-0.6) \\cdot (1 - \\exp(-0.48)) \\right] $$\nWe compute the exponential terms:\n$$ \\exp(-0.6) \\approx 0.548811635 $$\n$$ \\exp(-0.48) \\approx 0.618783392 $$\nSubstitute these into the main expression:\n$$ W_{\\text{abs}} \\approx 0.25 \\cdot (1 - 0.548811635) + \\frac{1}{6} \\cdot 0.548811635 \\cdot (1 - 0.618783392) $$\n$$ W_{\\text{abs}} \\approx 0.25 \\cdot (0.451188365) + \\frac{1}{6} \\cdot 0.548811635 \\cdot (0.381216608) $$\n$$ W_{\\text{abs}} \\approx 0.112797091 + 0.166666... \\cdot (0.20919199) $$\n$$ W_{\\text{abs}} \\approx 0.112797091 + 0.034865332 $$\n$$ W_{\\text{abs}} \\approx 0.147662423 $$\nRounding the result to four significant figures gives:\n$$ W_{\\text{abs}} \\approx 0.1477 $$\nThis is the expected fraction of the initial particle weight that is absorbed in the two material regions via a forced collision event.",
            "answer": "$$\\boxed{0.1477}$$"
        },
        {
            "introduction": "A key aspect of an expert simulator is not just knowing how to implement a variance reduction technique, but also understanding when to use it and what its performance benefits are. This exercise provides a direct comparison between the forced collision method and another common technique, the exponential transform . By analyzing a case where one method drastically outperforms the other, you will gain deeper insight into the specific strengths of forced collision, particularly its power to guarantee the sampling of events in a designated region with high efficiency.",
            "id": "4227231",
            "problem": "A monoenergetic, normally incident neutron beam of unit intensity enters a homogeneous, purely absorbing slab of thickness $L$ (in $\\mathrm{cm}$). The material has macroscopic total cross section $\\Sigma_{t}$ (in $\\mathrm{cm}^{-1}$), with no scattering so that $\\Sigma_{t}=\\Sigma_{a}$. Consider the collision-count tally that scores $1$ for a collision occurring before the particle exits the slab and $0$ otherwise. The free path length $s$ (in $\\mathrm{cm}$) to collision is distributed exponentially in the analog Monte Carlo (MC) description, and the estimator for this tally is the indicator $X=\\mathbf{1}\\{s<L\\}$.\n\nTwo variance-reduction techniques are applied to this collision-count tally:\n- Exponential Transform (ET): Free paths are sampled from a biased exponential distribution with rate parameter $\\mu$ (in $\\mathrm{cm}^{-1}$), i.e., $q(s)=\\mu \\exp(-\\mu s)$ for $s\\ge 0$, and an importance weight $w(s)$ is applied to keep the tally unbiased.\n- Forced Collision (FC): A collision is forced within the slab by sampling $s$ from the conditional distribution given $s<L$, and an appropriate deterministic weight is assigned to preserve unbiasedness.\n\nStarting from first principles of probability (indicator estimators, importance sampling with the likelihood ratio $p(s)/q(s)$, and the exponential free-path law for a homogeneous medium), derive expressions for the means and variances of the collision-count estimator under analog MC and ET, and argue the variance under FC. Using the following specified slab and cross-section parameters,\n- $L=5\\,\\mathrm{cm}$,\n- $\\Sigma_{t}=1\\,\\mathrm{cm}^{-1}$,\n- ET parameter $\\mu=0.2\\,\\mathrm{cm}^{-1}$,\n\ncompute the ratio\n$$\nR=\\frac{\\mathrm{Var}_{\\mathrm{ET}}}{\\mathrm{Var}_{\\mathrm{analog}}}\n$$\nfor the collision-count tally. Round your final result to four significant figures. Express your answer as a dimensionless number.",
            "solution": "The problem asks for an analysis of three different Monte Carlo estimators for the probability of a neutron colliding within a slab of thickness $L$. The physical probability of collision is the quantity being estimated.\n\n**1. Analog Monte Carlo Estimator**\n\nIn the analog simulation, the neutron's free path $s$ is sampled from its natural PDF, $p(s) = \\Sigma_{t} \\exp(-\\Sigma_{t} s)$. The estimator for a collision in the slab is an indicator variable, $X_{\\mathrm{analog}} = \\mathbf{1}\\{s < L\\}$, which is $1$ if $s < L$ and $0$ otherwise.\n\nThe mean of the estimator is the expected value of $X_{\\mathrm{analog}}$, which is the probability of the event $\\{s < L\\}$:\n$$E[X_{\\mathrm{analog}}] = P(s < L) = \\int_{0}^{L} p(s) \\, ds = \\int_{0}^{L} \\Sigma_{t} \\exp(-\\Sigma_{t} s) \\, ds$$\n$$E[X_{\\mathrm{analog}}] = [-\\exp(-\\Sigma_{t} s)]_{0}^{L} = 1 - \\exp(-\\Sigma_{t} L)$$\nThis is the true probability of collision, which we will denote as $p_{coll}$.\n\nThe variance of a Bernoulli trial (which this is) is given by $\\mathrm{Var}(p) = p(1-p)$. Alternatively, using the definition $\\mathrm{Var}(X) = E[X^2] - (E[X])^2$:\nSince $X_{\\mathrm{analog}}$ can only be $0$ or $1$, $X_{\\mathrm{analog}}^2 = X_{\\mathrm{analog}}$. Thus, $E[X_{\\mathrm{analog}}^2] = E[X_{\\mathrm{analog}}]$.\n$$\\mathrm{Var}_{\\mathrm{analog}} = E[X_{\\mathrm{analog}}] - (E[X_{\\mathrm{analog}}])^2 = p_{coll}(1-p_{coll})$$\n$$\\mathrm{Var}_{\\mathrm{analog}} = (1 - \\exp(-\\Sigma_{t} L)) \\exp(-\\Sigma_{t} L) = \\exp(-\\Sigma_{t} L) - \\exp(-2\\Sigma_{t} L)$$\n\n**2. Forced Collision (FC) Estimator**\n\nIn the FC technique, a collision is forced to occur within the slab. This is achieved by sampling the collision distance $s$ from the conditional PDF, $p(s | s < L)$. The original probability of this event occurring was $p_{coll} = P(s < L)$. To maintain an unbiased estimate of the mean, every forced collision event must be weighted by this probability.\n\nThe estimator is therefore not random; it has a fixed, deterministic value for every history:\n$$X_{\\mathrm{FC}} = P(s < L) = 1 - \\exp(-\\Sigma_{t} L)$$\nSince the estimator $X_{\\mathrm{FC}}$ is a constant, its variance is zero.\n$$\\mathrm{Var}_{\\mathrm{FC}} = E[(X_{\\mathrm{FC}} - E[X_{\\mathrm{FC}}])^2] = E[(X_{\\mathrm{FC}} - X_{\\mathrm{FC}})^2] = 0$$\nFC is a zero-variance scheme for this particular simple tally.\n\n**3. Exponential Transform (ET) Estimator**\n\nThe ET technique uses importance sampling. Instead of the analog PDF $p(s)$, paths are sampled from a biased PDF $q(s) = \\mu \\exp(-\\mu s)$. To correct for this bias, each tally is multiplied by a weight factor, which is the likelihood ratio $w(s) = p(s)/q(s)$.\n\n$$w(s) = \\frac{\\Sigma_{t} \\exp(-\\Sigma_{t} s)}{\\mu \\exp(-\\mu s)} = \\frac{\\Sigma_{t}}{\\mu} \\exp(-(\\Sigma_{t} - \\mu) s)$$\nThe ET estimator is $X_{\\mathrm{ET}} = w(s) \\mathbf{1}\\{s < L\\}$.\n\nThe mean of the ET estimator is:\n$$E[X_{\\mathrm{ET}}] = \\int_{0}^{\\infty} X_{\\mathrm{ET}}(s) q(s) \\, ds = \\int_{0}^{L} w(s) q(s) \\, ds = \\int_{0}^{L} \\frac{p(s)}{q(s)} q(s) \\, ds = \\int_{0}^{L} p(s) \\, ds$$\n$$E[X_{\\mathrm{ET}}] = 1 - \\exp(-\\Sigma_{t} L) = p_{coll}$$\nThis confirms the estimator is unbiased, as required.\n\nThe variance is $\\mathrm{Var}_{\\mathrm{ET}} = E[X_{\\mathrm{ET}}^2] - (E[X_{\\mathrm{ET}}])^2$. We need to compute the second moment $E[X_{\\mathrm{ET}}^2]$.\n$$E[X_{\\mathrm{ET}}^2] = \\int_{0}^{\\infty} (X_{\\mathrm{ET}}(s))^2 q(s) \\, ds = \\int_{0}^{L} (w(s))^2 q(s) \\, ds$$\nThe integrand is:\n$$(w(s))^2 q(s) = \\left(\\frac{\\Sigma_{t}}{\\mu} \\exp(-(\\Sigma_{t} - \\mu) s)\\right)^2 (\\mu \\exp(-\\mu s)) = \\frac{\\Sigma_{t}^2}{\\mu} \\exp(-2(\\Sigma_{t} - \\mu) s - \\mu s)$$\n$$(w(s))^2 q(s) = \\frac{\\Sigma_{t}^2}{\\mu} \\exp(-(2\\Sigma_{t} - \\mu) s)$$\nNow we integrate from $0$ to $L$:\n$$E[X_{\\mathrm{ET}}^2] = \\int_{0}^{L} \\frac{\\Sigma_{t}^2}{\\mu} \\exp(-(2\\Sigma_{t} - \\mu) s) \\, ds$$\nAssuming $2\\Sigma_{t} - \\mu \\neq 0$:\n$$E[X_{\\mathrm{ET}}^2] = \\frac{\\Sigma_{t}^2}{\\mu} \\left[ \\frac{-\\exp(-(2\\Sigma_{t} - \\mu) s)}{2\\Sigma_{t} - \\mu} \\right]_{0}^{L} = \\frac{\\Sigma_{t}^2}{\\mu(2\\Sigma_{t} - \\mu)} (1 - \\exp(-(2\\Sigma_{t} - \\mu)L))$$\nThe variance is then:\n$$\\mathrm{Var}_{\\mathrm{ET}} = \\frac{\\Sigma_{t}^2}{\\mu(2\\Sigma_{t} - \\mu)} (1 - \\exp(-(2\\Sigma_{t} - \\mu)L)) - (1 - \\exp(-\\Sigma_{t} L))^2$$\n\nNote that ET is typically used to enhance sampling of rare events. For deep penetration problems, one chooses $\\mu < \\Sigma_t$ to sample longer paths. For this problem, we are estimating collisions within a finite slab. Using $\\mu < \\Sigma_t$ (in this case, $\\mu=0.2 < \\Sigma_t=1$) biases sampling towards longer paths, making collisions within the slab ($s < L=5$) a rarer event than in the analog case. The few such events that do occur get a very large weight, which is expected to increase the variance.\n\n### Numerical Calculation\n\nWe are given:\n$L = 5 \\, \\mathrm{cm}$\n$\\Sigma_{t} = 1 \\, \\mathrm{cm}^{-1}$\n$\\mu = 0.2 \\, \\mathrm{cm}^{-1}$\n\nFirst, calculate the analog variance:\n$$\\mathrm{Var}_{\\mathrm{analog}} = \\exp(-\\Sigma_{t} L) - \\exp(-2\\Sigma_{t} L) = \\exp(-1 \\times 5) - \\exp(-2 \\times 1 \\times 5)$$\n$$\\mathrm{Var}_{\\mathrm{analog}} = \\exp(-5) - \\exp(-10)$$\nUsing a calculator: $\\exp(-5) \\approx 0.006737947$ and $\\exp(-10) \\approx 0.0000453999$.\n$$\\mathrm{Var}_{\\mathrm{analog}} \\approx 0.006737947 - 0.0000453999 = 0.0066925471$$\n\nNext, calculate the ET variance:\nThe pre-factor for the second moment is $2\\Sigma_{t} - \\mu = 2(1) - 0.2 = 1.8$.\n$$E[X_{\\mathrm{ET}}^2] = \\frac{1^2}{0.2(1.8)} (1 - \\exp(-1.8 \\times 5)) = \\frac{1}{0.36} (1 - \\exp(-9))$$\nUsing a calculator: $\\exp(-9) \\approx 0.00012341$.\n$$E[X_{\\mathrm{ET}}^2] \\approx \\frac{1}{0.36} (1 - 0.00012341) = \\frac{0.99987659}{0.36} \\approx 2.7774350$$\nThe square of the mean is:\n$$(E[X_{\\mathrm{ET}}])^2 = (1 - \\exp(-5))^2 \\approx (1 - 0.006737947)^2 = (0.993262053)^2 \\approx 0.98656952$$\nSo, the ET variance is:\n$$\\mathrm{Var}_{\\mathrm{ET}} \\approx 2.7774350 - 0.98656952 = 1.79086548$$\n\nFinally, compute the ratio $R$:\n$$R = \\frac{\\mathrm{Var}_{\\mathrm{ET}}}{\\mathrm{Var}_{\\mathrm{analog}}} \\approx \\frac{1.79086548}{0.0066925471} \\approx 267.59015$$\n\nRounding the result to four significant figures gives $267.6$.",
            "answer": "$$\\boxed{267.6}$$"
        }
    ]
}