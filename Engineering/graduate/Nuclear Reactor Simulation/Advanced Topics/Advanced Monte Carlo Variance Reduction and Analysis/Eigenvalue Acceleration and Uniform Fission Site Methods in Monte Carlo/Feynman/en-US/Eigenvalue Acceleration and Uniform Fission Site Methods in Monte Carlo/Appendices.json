{
    "hands_on_practices": [
        {
            "introduction": "The convergence of the fission source in a Monte Carlo simulation is mathematically equivalent to a power iteration seeking the dominant eigen-solution of the fission operator. The rate of this convergence is governed by the dominance ratio, a value close to one indicating slow convergence and persistent statistical correlations. This first exercise  provides a tangible foundation for this concept by having you construct a simple, discretized fission matrix for a slab reactor and directly compute its eigenvalues and the resulting dominance ratio. This calculation makes the abstract cause of slow convergence concrete and highlights why acceleration techniques are often necessary.",
            "id": "4223495",
            "problem": "In the context of Monte Carlo (MC) eigenvalue simulations for nuclear reactor analysis, consider a one-dimensional ($1$-D) slab reactor domain partitioned into $3$ coarse spatial bins. Define the fission matrix $\\mathbf{F} \\in \\mathbb{R}^{3 \\times 3}$ such that each entry $F_{i j}$ is the expected number of fission neutrons born in bin $i$ in the next generation per fission neutron born in bin $j$ in the current generation. Assume a uniform material and nearest-neighbor spatial coupling so that, for any source bin $j$, a fission neutron induces on average $\\kappa_{0}$ fission neutrons in the same bin and $\\kappa_{1}$ fission neutrons in each immediate neighbor; there is no coupling beyond nearest neighbors. Take $\\kappa_{0} = 0.90$ and $\\kappa_{1} = 0.10$.\n\nTasks:\n- Construct the matrix $\\mathbf{F}$ under these assumptions.\n- Starting from the eigenvalue problem definition for the fission matrix, determine all eigenvalues and corresponding right eigenvectors of $\\mathbf{F}$.\n- Using the standard definition relevant to power iteration in MC criticality calculations, compute the dominance ratio $\\rho = \\left|\\lambda_{2}\\right| / \\left|\\lambda_{1}\\right|$, where $\\lambda_{1}$ is the largest eigenvalue in magnitude and $\\lambda_{2}$ is the second-largest in magnitude.\n\nExpress the final dominance ratio as a dimensionless number. Round your final dominance ratio to $4$ significant figures. Provide only the dominance ratio as your final reported answer.",
            "solution": "The problem asks us to construct a fission matrix $\\mathbf{F}$ for a discretized slab reactor, find its eigenvalues and eigenvectors, and then compute the dominance ratio.\n\n**1. Construct the Fission Matrix $\\mathbf{F}$**\n\nThe reactor is divided into $3$ bins. The matrix entry $F_{ij}$ is the number of fissions in bin $i$ from a source in bin $j$. With self-coupling $\\kappa_0 = 0.90$ and nearest-neighbor coupling $\\kappa_1 = 0.10$, the matrix is constructed column by column based on the source bin $j$. For a source in bin $j$, fissions are induced in bin $i=j$ (rate $\\kappa_0$) and in bins $i=j\\pm 1$ (rate $\\kappa_1$).\n\nThus, the matrix $\\mathbf{F}$ is:\n$$\n\\mathbf{F} = \\begin{pmatrix} \\kappa_0  \\kappa_1  0 \\\\ \\kappa_1  \\kappa_0  \\kappa_1 \\\\ 0  \\kappa_1  \\kappa_0 \\end{pmatrix} = \\begin{pmatrix} 0.90  0.10  0 \\\\ 0.10  0.90  0.10 \\\\ 0  0.10  0.90 \\end{pmatrix}\n$$\n\n**2. Determine Eigenvalues and Eigenvectors**\n\nWe solve the eigenvalue problem $\\mathbf{F}\\mathbf{v} = \\lambda\\mathbf{v}$, which is equivalent to solving $\\det(\\mathbf{F} - \\lambda\\mathbf{I}) = 0$.\n$$\n\\det \\begin{pmatrix} 0.90 - \\lambda  0.10  0 \\\\ 0.10  0.90 - \\lambda  0.10 \\\\ 0  0.10  0.90 - \\lambda \\end{pmatrix} = 0\n$$\nExpanding the determinant gives the characteristic equation:\n$$\n(0.90 - \\lambda)[(0.90 - \\lambda)^2 - 0.10^2] - 0.10[0.10(0.90 - \\lambda)] = 0\n$$\n$$\n(0.90 - \\lambda)[(0.90 - \\lambda)^2 - 0.01] - 0.01(0.90 - \\lambda) = 0\n$$\n$$\n(0.90 - \\lambda)[(0.90 - \\lambda)^2 - 0.02] = 0\n$$\nThis gives three solutions for $\\lambda$:\n- $\\lambda_a = 0.90$\n- $(0.90 - \\lambda)^2 = 0.02 \\implies 0.90 - \\lambda = \\pm\\sqrt{0.02} \\implies \\lambda = 0.90 \\mp 0.1\\sqrt{2}$\n\nThe three eigenvalues are:\n- $\\lambda_c = 0.90 + 0.1\\sqrt{2} \\approx 1.0414$\n- $\\lambda_a = 0.90$\n- $\\lambda_b = 0.90 - 0.1\\sqrt{2} \\approx 0.7586$\n\nThe corresponding right eigenvectors are:\n- For $\\lambda \\approx 1.0414$: eigenvector is $\\mathbf{v} \\propto [1, \\sqrt{2}, 1]^T$. (Fundamental mode)\n- For $\\lambda = 0.90$: eigenvector is $\\mathbf{v} \\propto [1, 0, -1]^T$. (First harmonic)\n- For $\\lambda \\approx 0.7586$: eigenvector is $\\mathbf{v} \\propto [1, -\\sqrt{2}, 1]^T$. (Second harmonic)\n\n**3. Compute the Dominance Ratio**\n\nThe eigenvalues are ordered by magnitude:\n- $\\lambda_1 = 0.90 + 0.1\\sqrt{2} \\approx 1.0414$ (largest magnitude)\n- $\\lambda_2 = 0.90$ (second-largest magnitude)\n- $\\lambda_3 = 0.90 - 0.1\\sqrt{2} \\approx 0.7586$\n\nThe dominance ratio $\\rho$ is the ratio of the magnitudes of the second-largest to the largest eigenvalue:\n$$\n\\rho = \\frac{|\\lambda_2|}{|\\lambda_1|} = \\frac{0.90}{0.90 + 0.1\\sqrt{2}}\n$$\n$$\n\\rho \\approx \\frac{0.90}{1.041421356} \\approx 0.8641975...\n$$\nRounding to four significant figures, we get $\\rho = 0.8642$.",
            "answer": "$$\\boxed{0.8642}$$"
        },
        {
            "introduction": "Having established that the dominance ratio dictates convergence speed, we now explore a powerful method to reduce it: the Wielandt shift. This technique algebraically modifies the fission operator to change its eigenvalue spectrum, effectively pushing the subdominant eigenvalues further from the dominant one. In this practice , you will derive the transformation of the dominance ratio under a Wielandt shift from first principles. This exercise illuminates the mathematical machinery behind the acceleration, showing precisely how the shift parameter $\\sigma$ can be chosen to dramatically improve convergence.",
            "id": "4223565",
            "problem": "In a Monte Carlo (MC) eigenvalue simulation of neutron transport with the Uniform Fission Site (UFS) source normalization, the fission source update from cycle to cycle can be modeled by a linear, compact, positive fission operator $F$ acting on the fission source distribution $q$. The eigenvalue problem is $F \\varphi_{i} = \\lambda_{i} \\varphi_{i}$, with ordered real eigenvalues $\\lambda_{1}  \\lambda_{2} \\ge \\lambda_{3} \\ge \\cdots$ and corresponding eigenfunctions $\\{\\varphi_{i}\\}$. Under UFS, the source update is normalized each cycle so that the dominant mode is stationary, which corresponds to iteration by the normalized operator $T = \\frac{1}{\\lambda_{1}} F$, whose spectrum is $\\{1, \\lambda_{2}/\\lambda_{1}, \\lambda_{3}/\\lambda_{1}, \\ldots\\}$. The classical dominance ratio is $\\rho = \\lambda_{2} / \\lambda_{1}$.\n\nA Wielandt shift with shift parameter $\\sigma$ modifies the operator prior to normalization by replacing $F$ with $F_{\\sigma} = F - \\sigma I$, where $I$ is the identity operator, followed by UFS normalization relative to the fundamental mode. Assume $\\sigma$ is chosen such that $0 \\le \\sigma  \\lambda_{2}$ so that the shifted operator remains positive on the subspace spanned by the first two modes.\n\nStarting only from the linearity of $F$, the eigenpair relations $F \\varphi_{i} = \\lambda_{i} \\varphi_{i}$, and the properties of the UFS normalization outlined above, construct a two-mode model to show how the second eigenvalue of the normalized source-update operator transforms under the Wielandt shift. Then, using your derived transformation, compute the new dominance ratio after the shift for a system with\n$\\lambda_{1} = 1.005$, $\\lambda_{2} = 0.94$, and $\\sigma = 0.90$.\n\nGive your final numerical value for the new dominance ratio rounded to four significant figures. No units are required.",
            "solution": "The problem requires us to derive the transformation of the dominance ratio for a Monte Carlo eigenvalue simulation under a Wielandt shift and then calculate its new value for a specific system.\n\nLet the linear fission operator be $F$. The eigenvalue problem is given by:\n$$F \\varphi_{i} = \\lambda_{i} \\varphi_{i}$$\nwhere $\\lambda_{i}$ are the eigenvalues and $\\varphi_{i}$ are the corresponding eigenfunctions. The eigenvalues are ordered such that $\\lambda_{1}  \\lambda_{2} \\ge \\lambda_{3} \\ge \\cdots$.\n\nIn the standard Uniform Fission Site (UFS) method, the source update operator is normalized by the fundamental eigenvalue $\\lambda_{1}$. This normalized operator is $T$:\n$$T = \\frac{1}{\\lambda_{1}} F$$\nThe eigenvalues of $T$ can be found by applying it to an eigenfunction $\\varphi_{i}$:\n$$T \\varphi_{i} = \\frac{1}{\\lambda_{1}} F \\varphi_{i} = \\frac{1}{\\lambda_{1}} (\\lambda_{i} \\varphi_{i}) = \\frac{\\lambda_{i}}{\\lambda_{1}} \\varphi_{i}$$\nSo, the eigenvalues of $T$ are $\\lambda'_{i} = \\frac{\\lambda_{i}}{\\lambda_{1}}$. The spectrum of $T$ is $\\{1, \\frac{\\lambda_{2}}{\\lambda_{1}}, \\frac{\\lambda_{3}}{\\lambda_{1}}, \\ldots\\}$. The classical dominance ratio, $\\rho$, is the magnitude of the largest subdominant eigenvalue, which in a two-mode model (considering only the first and second modes) is:\n$$\\rho = \\left| \\frac{\\lambda_{2}}{\\lambda_{1}} \\right| = \\frac{\\lambda_{2}}{\\lambda_{1}}$$\nsince the eigenvalues of the fission operator $F$ are positive.\n\nNext, we introduce a Wielandt shift. The shifted operator, $F_{\\sigma}$, is defined as:\n$$F_{\\sigma} = F - \\sigma I$$\nwhere $\\sigma$ is the shift parameter and $I$ is the identity operator. To find the eigenvalues of $F_{\\sigma}$, we apply it to an eigenfunction $\\varphi_{i}$ of the original operator $F$:\n$$F_{\\sigma} \\varphi_{i} = (F - \\sigma I) \\varphi_{i} = F \\varphi_{i} - \\sigma I \\varphi_{i} = \\lambda_{i} \\varphi_{i} - \\sigma \\varphi_{i} = (\\lambda_{i} - \\sigma) \\varphi_{i}$$\nThis shows that the eigenfunctions of $F_{\\sigma}$ are the same as those of $F$, and the corresponding eigenvalues, let's call them $\\lambda_{i, \\sigma}$, are:\n$$\\lambda_{i, \\sigma} = \\lambda_{i} - \\sigma$$\n\nThe problem states that the UFS normalization is then applied to this shifted operator, relative to its fundamental mode. The fundamental eigenvalue of $F_{\\sigma}$ is $\\lambda_{1, \\sigma} = \\lambda_{1} - \\sigma$. The new normalized source-update operator, $T_{\\sigma}$, is therefore:\n$$T_{\\sigma} = \\frac{1}{\\lambda_{1, \\sigma}} F_{\\sigma} = \\frac{1}{\\lambda_{1} - \\sigma} (F - \\sigma I)$$\nThe eigenvalues of $T_{\\sigma}$, denoted as $\\lambda'_{i, \\sigma}$, can be found by applying $T_{\\sigma}$ to an eigenfunction $\\varphi_{i}$:\n$$T_{\\sigma} \\varphi_{i} = \\frac{1}{\\lambda_{1} - \\sigma} (F - \\sigma I) \\varphi_{i} = \\frac{1}{\\lambda_{1} - \\sigma} (\\lambda_{i} - \\sigma) \\varphi_{i}$$\nSo, the eigenvalues of the normalized shifted operator are:\n$$\\lambda'_{i, \\sigma} = \\frac{\\lambda_{i} - \\sigma}{\\lambda_{1} - \\sigma}$$\nThe spectrum of $T_{\\sigma}$ is $\\{1, \\frac{\\lambda_{2} - \\sigma}{\\lambda_{1} - \\sigma}, \\frac{\\lambda_{3} - \\sigma}{\\lambda_{1} - \\sigma}, \\ldots\\}$.\n\nThe new dominance ratio, $\\rho_{\\sigma}$, is the magnitude of the largest subdominant eigenvalue. In a two-mode model, this is the magnitude of the second eigenvalue of $T_{\\sigma}$:\n$$\\rho_{\\sigma} = |\\lambda'_{2, \\sigma}| = \\left| \\frac{\\lambda_{2} - \\sigma}{\\lambda_{1} - \\sigma} \\right|$$\nThis expression shows how the second eigenvalue of the normalized operator, and thus the dominance ratio, transforms under the Wielandt shift. This completes the first part of the problem.\n\nFor the second part, we must compute the numerical value of $\\rho_{\\sigma}$ using the given data: $\\lambda_{1} = 1.005$, $\\lambda_{2} = 0.94$, and $\\sigma = 0.90$. We are also given the constraint $0 \\le \\sigma  \\lambda_{2}$, which is satisfied since $0 \\le 0.90  0.94$.\n\nUnder this constraint, the numerator $\\lambda_{2} - \\sigma$ is positive:\n$$\\lambda_{2} - \\sigma = 0.94 - 0.90 = 0.04  0$$\nAlso, since $\\lambda_{1}  \\lambda_{2}  \\sigma$, the denominator $\\lambda_{1} - \\sigma$ is also positive:\n$$\\lambda_{1} - \\sigma = 1.005 - 0.90 = 0.105  0$$\nSince both the numerator and the denominator are positive, the absolute value is not necessary. The new dominance ratio is:\n$$\\rho_{\\sigma} = \\frac{\\lambda_{2} - \\sigma}{\\lambda_{1} - \\sigma} = \\frac{0.94 - 0.90}{1.005 - 0.90} = \\frac{0.04}{0.105}$$\nNow, we compute the numerical value:\n$$\\rho_{\\sigma} = \\frac{0.04}{0.105} \\approx 0.38095238...$$\nThe problem asks for the result rounded to four significant figures.\nThe fifth significant figure is $5$, so we round up the fourth digit.\n$$\\rho_{\\sigma} \\approx 0.3810$$",
            "answer": "$$\\boxed{0.3810}$$"
        },
        {
            "introduction": "In practice, optimizing a Monte Carlo simulation involves a multi-faceted trade-off between reducing systematic error (bias from an unconverged source), statistical error (variance), and computational cost. This final exercise  integrates the concepts of Wielandt shifting and the Uniform Fission Site (UFS) method into a comprehensive performance model. You will build a simulation to conduct a factorial experiment, quantifying how factors like the shift parameter, UFS binning, and particle count interact to influence the final Root-Mean-Square Error (RMSE) of the $ k $-eigenvalue. This capstone practice moves beyond simple convergence rates to the holistic goal of minimizing total error for a given computational budget.",
            "id": "4223521",
            "problem": "You are tasked to design and implement a complete and runnable program that simulates, in a stylized but scientifically grounded manner, how eigenvalue acceleration through Wielandt shifting and the Uniform Fission Site (UFS) method influence the convergence and variance of a Monte Carlo (MC) $k$-eigenvalue calculation in nuclear reactor simulation. Your program must compute quantitative metrics across a factorial experiment varying the number of UFS bins, particle count per cycle, and the Wielandt shift parameter.\n\nAssumptions and base model:\n- The transport/source operator is represented by a linear operator with two dominant eigenvalues $ \\mu_0 $ and $ \\mu_1 $ such that $ \\mu_0  \\mu_1  0 $. Use $ \\mu_0 = 1.05 $ and $ \\mu_1 = 0.90 $.\n- Wielandt shifting is applied by introducing a shift parameter $ k_w $ to accelerate the power iteration via a shifted-inverted iteration. The shift must satisfy $ \\mu_1  k_w  \\mu_0 $ and be sufficiently close to $ \\mu_0 $ so that the fundamental mode remains dominant under the transformed iteration.\n- There are $ W $ inactive cycles (discarded for statistics to reduce bias) and $ M $ active cycles (used to form the reported estimator). Use $ W = 15 $ and $ M = 50 $.\n- The Uniform Fission Site (UFS) method partitions phase space into $ B $ equal-probability bins to stratify fission site sampling. Assume that a fraction $ q $ of the per-cycle estimator variance is reducible by UFS stratification such that the reducible component scales inversely with $ B $. Use $ q = 0.8 $. Model the per-cycle variance multiplier due to UFS as $ h(B) $, where $ h(B) $ equals the sum of an irreducible component and a reducible component:\n  - $ h(B) = (1 - q) + q/B $.\n- The per-cycle, per-particle base standard deviation of the $ k $-estimator (in arbitrary units) is $ \\sigma_{\\text{base}} = 0.02 $. The number of particle histories per cycle is $ N $, so the per-cycle variance (before UFS and correlation adjustments) scales as $ \\sigma_{\\text{base}}^2 / N $ by the Central Limit Theorem.\n- Correlations between successive active-cycle $ k $ estimates arise from incomplete source convergence. Model the across-cycle correlation as approximately first-order autoregressive with correlation coefficient equal to the spectral dominance ratio of the shifted-inverted iteration. For an autoregressive process with lag-$ 1 $ correlation $ r $, the variance inflation factor for the mean of $ M $ samples is $ (1 + r)/(1 - r) $ for $ M $ sufficiently large.\n- The residual bias in $ k $ after $ W $ inactive cycles originates from the surviving amplitude of the first subdominant mode. Assume the initial subdominant mode amplitude is $ a_0 = 1.0 $, and that the projection of this mode onto the $ k $-estimator induces a bias proportional to the mode amplitude with proportionality constant $ c_{\\text{bias}} = 0.02 $. The amplitude contracts geometrically per iteration according to the spectral dominance ratio.\n- All quantities are dimensionless. Express convergence factors and all reported metrics as plain decimals (no percent signs).\n\nTasks to be completed by your program:\n- From linear-algebraic principles of the shifted-inverted power iteration applied to a diagonalizable operator with eigenvalues $ \\mu_0 $ and $ \\mu_1 $, derive the expression for the spectral dominance ratio $ r(k_w) $ as a function of the shift $ k_w $, ensuring the fundamental mode remains dominant.\n- Using the Central Limit Theorem and the variance of the mean of correlated samples under a first-order autoregressive correlation model, derive a formula for the standard deviation of the sample mean across $ M $ active cycles that incorporates (i) the $ 1/N $ scaling of per-cycle variance, (ii) the UFS factor $ h(B) $, and (iii) the variance inflation due to across-cycle correlation governed by $ r(k_w) $.\n- Derive the residual bias after $ W $ inactive cycles based on geometric decay of the subdominant mode amplitude and its proportional mapping to the $ k $-estimator bias.\n- Finally, compute the root-mean-square error (RMSE) of the reported $ k $ estimate over the $ M $ active cycles by combining the residual bias and the standard deviation of the mean.\n\nTest suite:\n- Consider the full factorial of the following parameters:\n  - Number of UFS bins $ B \\in \\{1, 8, 64\\} $,\n  - Particles per cycle $ N \\in \\{2000, 20000\\} $,\n  - Wielandt shift $ k_w \\in \\{0.98, 1.00, 1.03\\} $.\n- For each test case, your program must compute and return a list of three floats:\n  - The spectral dominance ratio $ r $ (unitless, express as a decimal),\n  - The standard deviation of the sample mean across $ M $ active cycles, $ \\sigma_{\\bar{k}} $ (unitless, express as a decimal),\n  - The root-mean-square error $ \\text{RMSE} $ (unitless, express as a decimal).\n\nParameter values to use:\n- $ \\mu_0 = 1.05 $, $ \\mu_1 = 0.90 $, $ W = 15 $, $ M = 50 $, $ \\sigma_{\\text{base}} = 0.02 $, $ q = 0.8 $, $ a_0 = 1.0 $, $ c_{\\text{bias}} = 0.02 $.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element of this list must itself be a three-element list $ [r, \\sigma_{\\bar{k}}, \\text{RMSE}] $ corresponding to one test case, ordered in lexicographic order of $ (B, N, k_w) $ as listed above (i.e., loop over $ B $ fastest outside, then $ N $, then $ k_w $ as the innermost loop).",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It presents a stylized but conceptually sound model of a Monte Carlo $k$-eigenvalue calculation, incorporating standard acceleration and variance reduction techniques. All parameters are defined, and the tasks are unambiguous, leading to a unique, verifiable solution. We proceed with the derivation and computation.\n\nThe analysis is broken down into four parts: derivation of the spectral dominance ratio, the standard deviation of the mean $k$-estimate, the residual bias, and finally the root-mean-square error.\n\n1.  **Spectral Dominance Ratio, $r(k_w)$**\n\nThe standard power iteration method for the transport operator $A$ converges at a rate determined by the ratio of its subdominant to dominant eigenvalues, $\\mu_1/\\mu_0$. The problem utilizes Wielandt's method, a shifted-inverse iteration scheme, to accelerate this convergence. The iteration operator becomes $(A - k_w I)^{-1}$, where $k_w$ is the shift parameter and $I$ is the identity operator.\n\nIf the eigenvalues of $A$ are $\\mu_i$, then the eigenvalues of the shifted operator $(A - k_w I)$ are $\\mu_i - k_w$. Consequently, the eigenvalues of the shifted-inverse operator $(A - k_w I)^{-1}$ are $\\lambda'_i = (\\mu_i - k_w)^{-1}$.\n\nThe convergence rate of the shifted-inverse iteration is governed by its spectral dominance ratio, which is the ratio of the magnitudes of the new first subdominant eigenvalue to the new fundamental eigenvalue. The fundamental mode of operator $A$ corresponds to the eigenvalue $\\mu_0 = 1.05$, and the first subdominant mode corresponds to $\\mu_1 = 0.90$. For the shifted operator, these become $\\lambda'_0 = (\\mu_0 - k_w)^{-1}$ and $\\lambda'_1 = (\\mu_1 - k_w)^{-1}$. The problem requires that the fundamental mode remains dominant, i.e., $|\\lambda'_0|  |\\lambda'_j|$ for all $j \\neq 0$. The condition $\\mu_1  k_w  \\mu_0$ ensures that $\\lambda'_0$ is the largest in magnitude.\n\nThe spectral dominance ratio $r$ is therefore given by the ratio of the magnitude of the next largest eigenvalue, $\\lambda'_1$, to that of the dominant one, $\\lambda'_0$:\n$$\nr(k_w) = \\frac{|\\lambda'_1|}{|\\lambda'_0|} = \\frac{|(\\mu_1 - k_w)^{-1}|}{|(\\mu_0 - k_w)^{-1}|} = \\frac{|\\mu_0 - k_w|}{|\\mu_1 - k_w|}\n$$\nGiven the constraint $\\mu_1  k_w  \\mu_0$, we have $\\mu_0 - k_w  0$ and $\\mu_1 - k_w  0$. Thus, $|\\mu_0 - k_w| = \\mu_0 - k_w$ and $|\\mu_1 - k_w| = -(\\mu_1 - k_w) = k_w - \\mu_1$. The expression for the spectral dominance ratio simplifies to:\n$$\nr(k_w) = \\frac{\\mu_0 - k_w}{k_w - \\mu_1}\n$$\n\n2.  **Standard Deviation of the Mean, $\\sigma_{\\bar{k}}$**\n\nThe standard deviation of the final $k$-eigenvalue estimate is derived by considering several contributing factors.\n\nFirst, the base variance of the estimator for a single particle history is given as $\\sigma_{\\text{base}}^2$. For a Monte Carlo cycle with $N$ independent particle histories, the variance of the per-cycle estimator $k_i$ is reduced by a factor of $N$ according to the Central Limit Theorem: $\\sigma_{\\text{cycle}}^2 = \\sigma_{\\text{base}}^2 / N$.\n\nSecond, the Uniform Fission Site (UFS) method introduces stratification to reduce variance. The problem provides a variance multiplier $h(B) = (1 - q) + q/B$, where $B$ is the number of bins and $q$ is the fraction of variance that is reducible. The variance of a single cycle-averaged estimate, incorporating UFS, is:\n$$\n\\sigma_{k_i}^2 = h(B) \\frac{\\sigma_{\\text{base}}^2}{N}\n$$\n\nThird, incomplete source convergence between cycles induces a correlation in the sequence of cycle-based estimates $\\{k_i\\}$. The problem models this as a first-order autoregressive process, AR($1$), with a correlation coefficient equal to the spectral dominance ratio, $r = r(k_w)$. The variance of the sample mean $\\bar{k}$ of $M$ such correlated samples is inflated. For a large number of active cycles $M$, the variance inflation factor (VIF) is approximately $(1+r)/(1-r)$.\n\nCombining these effects, the variance of the sample mean $\\bar{k}$ over $M$ active cycles is:\n$$\n\\sigma_{\\bar{k}}^2 = \\text{Var}(\\bar{k}) = \\frac{\\sigma_{k_i}^2}{M} \\left( \\frac{1+r}{1-r} \\right) = \\frac{h(B) \\sigma_{\\text{base}}^2}{MN} \\left( \\frac{1+r}{1-r} \\right)\n$$\nThe standard deviation of the mean, $\\sigma_{\\bar{k}}$, is the square root of this variance:\n$$\n\\sigma_{\\bar{k}} = \\sqrt{\\frac{h(B) \\sigma_{\\text{base}}^2}{MN} \\left( \\frac{1+r}{1-r} \\right)} = \\frac{\\sigma_{\\text{base}}}{\\sqrt{MN}} \\sqrt{h(B) \\left( \\frac{1+r}{1-r} \\right)}\n$$\n\n3.  **Residual Bias**\n\nAfter tallying begins, a residual bias may persist in the $k$-eigenvalue estimate due to the not-yet-fully-converged source distribution. This bias is dominated by the slowest-decaying non-fundamental mode, i.e., the first subdominant mode. The amplitude of this mode, initially $a_0$, is reduced by a factor of the spectral dominance ratio $r$ at each iteration. After $W$ inactive (discarded) cycles, the residual amplitude of this mode is $a_W = a_0 \\cdot r^W$.\n\nThe problem states that the bias in the $k$-estimator is proportional to this amplitude, with a proportionality constant $c_{\\text{bias}}$. Therefore, the residual bias in the estimates averaged over the active cycles is:\n$$\n\\text{Bias} = c_{\\text{bias}} \\cdot a_W = c_{\\text{bias}} \\cdot a_0 \\cdot (r(k_w))^W\n$$\nUsing the given values $a_0 = 1.0$, $c_{\\text{bias}} = 0.02$, and $W=15$, the formula becomes $\\text{Bias} = 0.02 \\cdot (r(k_w))^{15}$.\n\n4.  **Root-Mean-Square Error (RMSE)**\n\nThe Root-Mean-Square Error (RMSE) is a comprehensive metric of estimator quality, combining both its random error (variance) and systematic error (bias). It is defined as the square root of the Mean Squared Error (MSE), which is the sum of the variance and the squared bias of the estimator.\n$$\n\\text{MSE}(\\bar{k}) = \\text{Var}(\\bar{k}) + (\\text{Bias}(\\bar{k}))^2 = \\sigma_{\\bar{k}}^2 + \\text{Bias}^2\n$$\nSubstituting the expressions derived above, the final formula for RMSE is:\n$$\n\\text{RMSE} = \\sqrt{\\sigma_{\\bar{k}}^2 + \\text{Bias}^2}\n$$\nThis single value quantifies the total expected error in the computed $k$-eigenvalue.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes key performance metrics for a stylized Monte Carlo k-eigenvalue simulation\n    across a factorial experiment of parameters.\n    \"\"\"\n    # Define problem constants\n    mu0 = 1.05          # Fundamental eigenvalue\n    mu1 = 0.90          # First subdominant eigenvalue\n    W = 15              # Number of inactive cycles\n    M = 50              # Number of active cycles\n    sigma_base = 0.02   # Per-cycle, per-particle base standard deviation\n    q = 0.8             # Reducible fraction of variance for UFS\n    a0 = 1.0            # Initial subdominant mode amplitude\n    c_bias = 0.02       # Proportionality constant for bias\n\n    # Define the factorial experiment parameters\n    B_values = [1, 8, 64]      # Number of UFS bins\n    N_values = [2000, 20000]   # Particles per cycle\n    kw_values = [0.98, 1.00, 1.03] # Wielandt shift parameter\n\n    test_cases = []\n    # Generate test cases in lexicographic order of (B, N, kw)\n    for B in B_values:\n        for N in N_values:\n            for kw in kw_values:\n                test_cases.append((B, N, kw))\n\n    results = []\n    for case in test_cases:\n        B, N, kw = case\n        \n        # 1. Calculate Spectral Dominance Ratio, r\n        # r(kw) = (mu0 - kw) / (kw - mu1)\n        # Condition mu1  kw  mu0 is satisfied by the problem statement.\n        r = (mu0 - kw) / (kw - mu1)\n\n        # 2. Calculate Standard Deviation of the Mean, sigma_k_bar\n        # UFS variance multiplier: h(B) = (1 - q) + q/B\n        h_B = (1 - q) + q / B\n        \n        # Variance of a single cycle estimate\n        sigma_ki_sq = h_B * (sigma_base**2) / N\n        \n        # Variance inflation factor for AR(1) process\n        vif = (1 + r) / (1 - r)\n        \n        # Variance of the mean over M active cycles\n        sigma_k_bar_sq = (sigma_ki_sq / M) * vif\n        \n        # Standard deviation of the mean\n        sigma_k_bar = np.sqrt(sigma_k_bar_sq)\n\n        # 3. Calculate Residual Bias\n        # Bias = c_bias * a0 * r^W\n        bias = c_bias * a0 * (r**W)\n\n        # 4. Calculate Root-Mean-Square Error (RMSE)\n        # RMSE = sqrt(sigma_k_bar^2 + Bias^2)\n        rmse = np.sqrt(sigma_k_bar_sq + bias**2)\n\n        results.append([r, sigma_k_bar, rmse])\n    \n    # Format the final output string\n    # E.g., [[r1, sdk1, rmse1],[r2, sdk2, rmse2],...]\n    output_str = \"[\" + \",\".join([f\"[{res[0]},{res[1]},{res[2]}]\" for res in results]) + \"]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}