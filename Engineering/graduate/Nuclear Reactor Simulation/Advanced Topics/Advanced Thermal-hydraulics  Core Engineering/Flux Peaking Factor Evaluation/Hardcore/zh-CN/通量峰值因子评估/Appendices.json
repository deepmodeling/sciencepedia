{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个实践将处理一个经典的反应堆物理问题：一个被中子反射层包围的堆芯。通过解析求解单能群扩散方程，您将推导出反射层的存在（其作用是减速中子并将其反射回堆芯）如何产生不均匀的中子注量率分布，并导致峰值与平均值之比大于一。这项练习旨在帮助您从物理机制层面建立对中子注量率峰化的基础理解。",
            "id": "4227008",
            "problem": "考虑一个均匀板式反应堆堆芯的单速中子扩散模型，其半厚度为$a$，占据区域$-a \\le x \\le a$，两侧由厚度为$t$的非增殖反射层包围，占据区域$a \\le |x| \\le a+t$。该反应堆关于$x=0$对称。位于$x=\\pm(a+t)$处的外边界是真空边界。每个区域内的材料是均匀的，其特征由扩散系数$D$和宏观吸收截面$\\Sigma_{a}$描述。在反应堆堆芯中，通过一个有效的产生项产生裂变中子；在反射层中，不存在中子源。\n\n你需要在单群中子扩散理论的框架下进行分析。堆芯中中子注量率$\\phi(x)$的控制方程是单群中子扩散方程（NDE），\n$$\n-D_{c}\\,\\frac{d^{2}\\phi}{dx^{2}}+\\Sigma_{a,c}\\,\\phi=\\frac{\\nu\\Sigma_{f,c}}{k}\\,\\phi \\quad \\text{for } |x|  a$$",
            "solution": "出发点是单群中子扩散方程（NDE）。在堆芯中，我们写出\n$$\n-D_{c}\\,\\frac{d^{2}\\phi}{dx^{2}}+\\Sigma_{a,c}\\,\\phi=\\frac{\\nu\\Sigma_{f,c}}{k}\\,\\phi \\quad \\text{for } |x|  a$$",
            "answer": "$$\\boxed{1.128}$$"
        },
        {
            "introduction": "真实的反应堆计算为了提高效率，通常使用“节块”组成的粗网格。本实践将探索“针功率重建”这一关键步骤，即利用粗网格数据（如节块表面的平均中子注量率）来确定节块内部的详细功率分布。您将使用多项式近似来模拟节块内的中子注量率，并计算单个燃料棒中的最大功率，这是一个关键的安全参数。",
            "id": "4226992",
            "problem": "考虑一个位于二维反应堆堆芯平面中的单个均匀化方形燃料节点，该节点在稳态、单群、带裂变源的中子扩散模型下进行建模。设该节点映射到参考域 $[-1,1] \\times [-1,1]$，其空间坐标 $(x,y)$ 与该节点的局部坐标轴对齐。节点平均标量通量给定为 $\\bar{\\phi} = 1$。一次粗网格节点计算提供了节点边界上的界面平均标量通量：左界面平均值 $\\phi_{L} = 0.90$，右界面平均值 $\\phi_{R} = 1.10$，下界面平均值 $\\phi_{B} = 0.94$，上界面平均值 $\\phi_{T} = 1.06$。假设节点内的宏观截面在空间上是均匀的，因此局部裂变功率密度与局部标量通量成正比。\n\n使用可分离的节点重构方法，将 $[-1,1] \\times [-1,1]$ 上的节点内通量近似为 $\\phi(x,y) = \\bar{\\phi}\\, f(x)\\, g(y)$，其中 $f(x)$ 和 $g(y)$ 是次数最多为二的多项式。施加以下由节点平衡和与界面平均量一致性产生的约束条件：\n- $f(x)$ 在 $x \\in [-1,1]$ 上的平均值为1，以及 $g(y)$ 在 $y \\in [-1,1]$ 上的平均值为1。\n- 界面平均通量满足 $f(-1) = \\phi_{L}/\\bar{\\phi}$，$f(1) = \\phi_{R}/\\bar{\\phi}$，$g(-1) = \\phi_{B}/\\bar{\\phi}$ 和 $g(1) = \\phi_{T}/\\bar{\\phi}$。\n\n将节点划分为一个均匀的 $4 \\times 4$ 燃料棒（子单元）阵列，每个子单元在参考坐标系中的尺寸为 $0.5 \\times 0.5$。将燃料棒平均功率定义为 $\\phi(x,y)$ 在每个子单元上的面积平均值。在上述可分离重构和约束条件下，计算此节点内的燃料棒功率峰值因子，该因子定义为最大燃料棒平均功率与节点平均功率之比。将最终答案表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "该问题要求计算一个均匀化方形燃料节点的燃料棒功率峰值因子。该因子定义为最大燃料棒平均功率与节点平均功率之比。鉴于宏观截面是均匀的，局部功率密度与局部标量通量成正比，即 $P(x,y) \\propto \\phi(x,y)$。因此，燃料棒功率峰值因子等效于燃料棒通量峰值因子，即最大燃料棒平均标量通量与节点平均标量通量之比。节点平均标量通量给定为 $\\bar{\\phi} = 1$。\n\n节点内标量通量通过在域 $[-1,1] \\times [-1,1]$ 上的可分离多项式展开来近似：\n$$\n\\phi(x,y) = \\bar{\\phi}\\, f(x)\\, g(y)\n$$\n由于 $\\bar{\\phi}=1$，我们有 $\\phi(x,y) = f(x)g(y)$。函数 $f(x)$ 和 $g(y)$ 是次数最多为二的多项式。\n\n首先，我们确定多项式 $f(x)$。设 $f(x) = a_2 x^2 + a_1 x + a_0$。为确定系数 $a_0$、$a_1$ 和 $a_2$ 提供了三个约束条件。\n1.  $f(x)$ 在 $[-1,1]$ 上的平均值为1：\n    $$\n    \\frac{1}{1 - (-1)} \\int_{-1}^{1} f(x) dx = \\frac{1}{2} \\int_{-1}^{1} (a_2 x^2 + a_1 x + a_0) dx = 1\n    $$\n    $$\n    \\frac{1}{2} \\left[ a_2 \\frac{x^3}{3} + a_1 \\frac{x^2}{2} + a_0 x \\right]_{-1}^{1} = \\frac{1}{2} \\left( \\left(\\frac{a_2}{3} + \\frac{a_1}{2} + a_0\\right) - \\left(-\\frac{a_2}{3} + \\frac{a_1}{2} - a_0\\right) \\right) = \\frac{a_2}{3} + a_0 = 1\n    $$\n2.  左界面（$x=-1$）上的界面平均通量与给定值 $\\phi_L = 0.90$ 一致：\n    $$\n    f(-1) = a_2(-1)^2 + a_1(-1) + a_0 = a_2 - a_1 + a_0 = \\frac{\\phi_L}{\\bar{\\phi}} = \\frac{0.90}{1} = 0.90\n    $$\n3.  右界面（$x=1$）上的界面平均通量与给定值 $\\phi_R = 1.10$ 一致：\n    $$\n    f(1) = a_2(1)^2 + a_1(1) + a_0 = a_2 + a_1 + a_0 = \\frac{\\phi_R}{\\bar{\\phi}} = \\frac{1.10}{1} = 1.10\n    $$\n我们得到一个关于 $a_0, a_1, a_2$ 的三元线性方程组：\n$$\n\\begin{cases}\n\\frac{1}{3}a_2 + a_0 = 1 \\\\\na_2 - a_1 + a_0 = 0.90 \\\\\na_2 + a_1 + a_0 = 1.10\n\\end{cases}\n$$\n将第二个和第三个方程相加，得到 $2a_2 + 2a_0 = 2.00$，简化为 $a_2 + a_0 = 1$。从第三个方程中减去第二个方程，得到 $2a_1 = 0.20$，所以 $a_1 = 0.10$。\n现在我们有两个关于 $a_2$ 和 $a_0$ 的方程：$a_2 + a_0 = 1$ 和 $\\frac{1}{3}a_2 + a_0 = 1$。将这两个方程相减，得到 $(\\frac{1}{3} - 1)a_2 = 0$，即 $-\\frac{2}{3}a_2 = 0$，所以 $a_2 = 0$。将 $a_2=0$ 代入 $a_2 + a_0 = 1$，得到 $a_0 = 1$。\n因此，多项式 $f(x)$ 为 $f(x) = 0.10x + 1$。\n\n接下来，我们确定多项式 $g(y)$。设 $g(y) = b_2 y^2 + b_1 y + b_0$。约束条件是类似的：\n1.  $g(y)$ 在 $[-1,1]$ 上的平均值为1：$\\frac{1}{3}b_2 + b_0 = 1$。\n2.  $g(-1) = \\phi_B / \\bar{\\phi} = 0.94 / 1 = 0.94$。\n3.  $g(1) = \\phi_T / \\bar{\\phi} = 1.06 / 1 = 1.06$。\n这导出一个方程组：\n$$\n\\begin{cases}\n\\frac{1}{3}b_2 + b_0 = 1 \\\\\nb_2 - b_1 + b_0 = 0.94 \\\\\nb_2 + b_1 + b_0 = 1.06\n\\end{cases}\n$$\n类似地求解这个方程组，我们将第二个和第三个方程相加和相减，得到 $b_2+b_0=1$ 和 $b_1 = 0.06$。从 $b_2+b_0=1$ 和 $\\frac{1}{3}b_2+b_0=1$ 中，我们求得 $b_2=0$ 和 $b_0=1$。\n因此，多项式 $g(y)$ 为 $g(y) = 0.06y + 1$。\n\n节点内通量分布为 $\\phi(x,y) = (0.10x + 1)(0.06y + 1)$。\n\n节点被划分为一个 $4 \\times 4$ 的燃料棒阵列。参考域 $[-1,1] \\times [-1,1]$ 被划分为16个子单元，每个尺寸为 $0.5 \\times 0.5$。设一个燃料棒由 $(i,j)$ 索引，其中 $i,j \\in \\{1,2,3,4\\}$，覆盖域 $[x_{i-1}, x_i] \\times [y_{j-1}, y_j]$，其中 $x_i = -1 + 0.5i$，$y_j = -1 + 0.5j$。每个燃料棒的面积为 $A_{pin} = 0.5 \\times 0.5 = 0.25$。\n燃料棒 $(i,j)$ 的平均通量为：\n$$\n\\bar{\\phi}_{ij} = \\frac{1}{A_{pin}} \\int_{y_{j-1}}^{y_j} \\int_{x_{i-1}}^{x_i} \\phi(x,y) \\,dx\\,dy = \\frac{1}{0.25} \\int_{y_{j-1}}^{y_j} \\int_{x_{i-1}}^{x_i} f(x)g(y) \\,dx\\,dy\n$$\n由于通量是可分离形式，这变为：\n$$\n\\bar{\\phi}_{ij} = 4 \\left( \\int_{x_{i-1}}^{x_i} f(x) \\,dx \\right) \\left( \\int_{y_{j-1}}^{y_j} g(y) \\,dy \\right)\n$$\n为了找到最大燃料棒平均通量，我们需要找到 $\\bar{\\phi}_{ij}$ 的最大值。函数 $f(x)=0.10x+1$ 随 $x$ 单调递增。函数 $g(y)=0.06y+1$ 随 $y$ 单调递增。因此，$f(x)$ 和 $g(y)$ 的积分在函数本身取值最大的区间上将是最大的。这对应于节点的右上角。因此，最大燃料棒平均通量将出现在燃料棒单元 $(4,4)$ 中，该单元对应于域 $[0.5, 1] \\times [0.5, 1]$。\n\n我们计算这个燃料棒所需的积分：\n$$\nF_4 = \\int_{0.5}^{1} f(x) \\,dx = \\int_{0.5}^{1} (0.10x + 1) \\,dx = \\left[ 0.10\\frac{x^2}{2} + x \\right]_{0.5}^{1} = [0.05x^2 + x]_{0.5}^{1}\n$$\n$$\nF_4 = (0.05(1)^2 + 1) - (0.05(0.5)^2 + 0.5) = (1.05) - (0.05 \\times 0.25 + 0.5) = 1.05 - (0.0125 + 0.5) = 1.05 - 0.5125 = 0.5375\n$$\n$$\nG_4 = \\int_{0.5}^{1} g(y) \\,dy = \\int_{0.5}^{1} (0.06y + 1) \\,dy = \\left[ 0.06\\frac{y^2}{2} + y \\right]_{0.5}^{1} = [0.03y^2 + y]_{0.5}^{1}\n$$\n$$\nG_4 = (0.03(1)^2 + 1) - (0.03(0.5)^2 + 0.5) = (1.03) - (0.03 \\times 0.25 + 0.5) = 1.03 - (0.0075 + 0.5) = 1.03 - 0.5075 = 0.5225\n$$\n最大燃料棒平均通量是 $\\bar{\\phi}_{44}$：\n$$\n\\bar{\\phi}_{44} = 4 F_4 G_4 = 4 \\times (0.5375) \\times (0.5225) = 1.123375\n$$\n燃料棒功率峰值因子是\n$$\n\\text{燃料棒功率峰值因子} = \\frac{\\max_{i,j} \\bar{\\phi}_{ij}}{\\bar{\\phi}} = \\frac{\\bar{\\phi}_{44}}{1} = 1.123375\n$$\n将结果四舍五入到四位有效数字，我们得到 $1.123$。",
            "answer": "$$\\boxed{1.123}$$"
        },
        {
            "introduction": "这最后一个综合性实践将带您进入计算反应堆物理学领域，要求您构建一个双能群中子扩散求解器。您将实现有限体积法和幂迭代法，以求解非均匀板状反应堆中的基波中子注量率分布。这将使您能够评估依赖于能量的峰化因子，揭示快中子和热中子对总功率峰值的不同贡献。",
            "id": "4226996",
            "problem": "使用一维 (1D) 多群中子扩散模型，在具有分段均匀材料属性和反射边界条件的板块几何中，评估特定能群的通量峰化因子和反应率加权的峰化因子。任务是构建一个完整的程序，该程序使用有限体积法离散化双群稳态中子平衡方程，并通过求解广义特征值问题来计算基模通量形状。最终输出是无量纲的峰化因子，其定义为局部最大值与其空间平均值的比率，分别针对每个能群以及组合的裂变反应率加权。\n\n基本基础是以多群扩散公式表示的双群中子平衡方程。对于群索引 $g \\in \\{1,2\\}$，其中 $g=1$ 表示快中子群，$g=2$ 表示热中子群，稳态方程（只考虑向下散射，且裂变中子产生在快中子群中）为\n$$\n- \\frac{d}{dx}\\!\\left(D_1(x)\\,\\frac{d \\phi_1(x)}{dx}\\right) + \\Sigma_{a,1}(x)\\,\\phi_1(x) + \\Sigma_{s,1\\to 2}(x)\\,\\phi_1(x) \\;=\\; \\frac{1}{k}\\,\\nu\\left[\\Sigma_{f,1}(x)\\,\\phi_1(x) + \\Sigma_{f,2}(x)\\,\\phi_2(x)\\right],\n$$\n$$\n- \\frac{d}{dx}\\!\\left(D_2(x)\\,\\frac{d \\phi_2(x)}{dx}\\right) + \\Sigma_{a,2}(x)\\,\\phi_2(x) \\;=\\; \\Sigma_{s,1\\to 2}(x)\\,\\phi_1(x),\n$$\n具有反射边界条件\n$$\n\\frac{d \\phi_g}{dx}\\Big|_{x=0} \\;=\\; 0, \\quad \\frac{d \\phi_g}{dx}\\Big|_{x=L} \\;=\\; 0,\n$$\n其中，$x$ 是以厘米为单位的空间坐标，$L$ 是板块长度，$D_g(x)$ 是以厘米为单位的扩散系数，$\\Sigma_{a,g}(x)$ 是以厘米的倒数为单位的宏观吸收截面，$\\Sigma_{s,1\\to 2}(x)$ 是从群1到群2的向下散射截面（单位为厘米的倒数），$\\Sigma_{f,g}(x)$ 是以厘米的倒数为单位的宏观裂变截面，$\\nu$ 是每次裂变产生的平均中子数（无量纲），$k$ 是有效增殖因子（无量纲），$\\phi_g(x)$ 是中子通量，单位为 $\\mathrm{n}/\\mathrm{cm}^2\\cdot \\mathrm{s}$。\n\n程序应将空间域离散化为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀单元，并使用守恒的有限体积格式来近似扩散算子。单元 $i$ 和 $i+1$ 之间界面上的扩散系数应通过调和平均形成\n$$\nD_{g,i+\\frac{1}{2}} \\;=\\; \\frac{2}{\\frac{1}{D_{g,i}} + \\frac{1}{D_{g,i+1}}}.\n$$\n令 $i \\in \\{0,1,\\dots,N-1\\}$ 为单元中心的索引。定义离散的流散度，使得反射边界意味着在区域两端流为零，从而为每个群得出离散扩散模板：\n$$\n\\left[-\\nabla\\!\\cdot\\!\\left(D_g \\nabla \\phi_g\\right)\\right]_i \\;\\approx\\; \\frac{D_{g,i-\\frac{1}{2}}}{\\Delta x^2}\\left(\\phi_{g,i} - \\phi_{g,i-1}\\right) + \\frac{D_{g,i+\\frac{1}{2}}}{\\Delta x^2}\\left(\\phi_{g,i} - \\phi_{g,i+1}\\right),\n$$\n其中，由于零流反射边界条件，在 $i=0$ 处 $D_{g,-\\frac{1}{2}} = 0$，在 $i=N-1$ 处 $D_{g,N-\\frac{1}{2}} = 0$。群1的移出截面为 $\\Sigma_{r,1} = \\Sigma_{a,1} + \\Sigma_{s,1\\to 2}$。\n\n将离散系统组装成块矩阵形式\n$$\n\\mathbf{A}\\,\\boldsymbol{\\phi} \\;=\\; \\frac{1}{k}\\,\\mathbf{F}\\,\\boldsymbol{\\phi},\n$$\n其中 $\\boldsymbol{\\phi} = \\begin{bmatrix}\\boldsymbol{\\phi}_1 \\\\ \\boldsymbol{\\phi}_2\\end{bmatrix} \\in \\mathbb{R}^{2N}$ 堆叠了群通量，$\\mathbf{A} \\in \\mathbb{R}^{2N \\times 2N}$ 是块下三角矩阵，其形式为\n$$\n\\mathbf{A}_{11} = \\mathbf{L}_1 + \\mathrm{diag}(\\Sigma_{r,1}), \\quad \\mathbf{A}_{22} = \\mathbf{L}_2 + \\mathrm{diag}(\\Sigma_{a,2}), \\quad \\mathbf{A}_{21} = -\\,\\mathrm{diag}(\\Sigma_{s,1\\to 2}), \\quad \\mathbf{A}_{12} = \\mathbf{0},\n$$\n并且 $\\mathbf{L}_g$ 是由界面上的调和平均值构建的离散扩散算子，而裂变产生矩阵 $\\mathbf{F}$ 为\n$$\n\\mathbf{F} \\;=\\; \\begin{bmatrix}\n\\mathrm{diag}\\!\\left(\\nu\\,\\Sigma_{f,1}\\right)  \\mathrm{diag}\\!\\left(\\nu\\,\\Sigma_{f,2}\\right)\\\\\n\\mathbf{0}  \\mathbf{0}\n\\end{bmatrix}.\n$$\n基模通量形状对应于 $\\mathbf{M} = \\mathbf{A}^{-1}\\mathbf{F}$ 与最大特征值 $\\lambda_{\\max} = 1/k$ 相关联的主右特征向量。程序应使用迭代幂法计算此特征向量，然后提取群通量 $\\boldsymbol{\\phi}_1$ 和 $\\boldsymbol{\\phi}_2$。\n\n定义特定能群的通量峰化因子\n$$\nP_1 \\;=\\; \\frac{\\max_i \\phi_{1,i}}{\\frac{1}{N}\\sum_{i=0}^{N-1} \\phi_{1,i}}, \\quad\nP_2 \\;=\\; \\frac{\\max_i \\phi_{2,i}}{\\frac{1}{N}\\sum_{i=0}^{N-1} \\phi_{2,i}},\n$$\n以及反应率加权的总裂变峰化因子\n$$\nP_F \\;=\\; \\frac{\\displaystyle\\max_i \\left(\\Sigma_{f,1,i}\\,\\phi_{1,i} + \\Sigma_{f,2,i}\\,\\phi_{2,i}\\right)}{\\displaystyle\\frac{1}{N}\\sum_{i=0}^{N-1} \\left(\\Sigma_{f,1,i}\\,\\phi_{1,i} + \\Sigma_{f,2,i}\\,\\phi_{2,i}\\right)}.\n$$\n所有峰化因子都是无量纲的，并且必须作为浮点数返回。\n\n实现该程序以评估以下分段均匀案例测试套件的 $(P_1,P_2,P_F)$。材料属性按区域指定，并且必须根据每个单元的中心位置 $x_i = \\left(i+\\frac{1}{2}\\right)\\Delta x$ 分配给该单元。所有截面的单位为 $\\mathrm{cm}^{-1}$，所有扩散系数的单位为 $\\mathrm{cm}$，所有长度的单位为 $\\mathrm{cm}$，每次裂变的平均中子数 $\\nu$ 是无量纲的。输出必须是无量纲的浮点数。\n\n- 案例1（双区慢化剂-燃料-慢化剂板块）：\n  - 板块长度 $L = 100\\,\\mathrm{cm}$，单元数量 $N = 200$。\n  - 区域：左侧慢化剂 $x \\in [0,25)\\,\\mathrm{cm}$；中间燃料 $x \\in [25,75)\\,\\mathrm{cm}$；右侧慢化剂 $x \\in [75,100]\\,\\mathrm{cm}$。\n  - 慢化剂：$D_1 = 1.5\\,\\mathrm{cm}$， $D_2 = 0.4\\,\\mathrm{cm}$， $\\Sigma_{a,1} = 0.005\\,\\mathrm{cm}^{-1}$， $\\Sigma_{a,2} = 0.040\\,\\mathrm{cm}^{-1}$， $\\Sigma_{s,1\\to 2} = 0.020\\,\\mathrm{cm}^{-1}$， $\\Sigma_{f,1} = 0.0000\\,\\mathrm{cm}^{-1}$， $\\Sigma_{f,2} = 0.0000\\,\\mathrm{cm}^{-1}$。\n  - 燃料：$D_1 = 1.2\\,\\mathrm{cm}$， $D_2 = 0.3\\,\\mathrm{cm}$， $\\Sigma_{a,1} = 0.010\\,\\mathrm{cm}^{-1}$， $\\Sigma_{a,2} = 0.080\\,\\mathrm{cm}^{-1}$， $\\Sigma_{s,1\\to 2} = 0.050\\,\\mathrm{cm}^{-1}$， $\\Sigma_{f,1} = 0.002\\,\\mathrm{cm}^{-1}$， $\\Sigma_{f,2} = 0.120\\,\\mathrm{cm}^{-1}$。\n  - 每次裂变的平均中子数 $\\nu = 2.5$。\n\n- 案例2（均匀类燃料板块）：\n  - 板块长度 $L = 60\\,\\mathrm{cm}$，单元数量 $N = 120$。\n  - 均匀属性：$D_1 = 1.2\\,\\mathrm{cm}$， $D_2 = 0.3\\,\\mathrm{cm}$， $\\Sigma_{a,1} = 0.008\\,\\mathrm{cm}^{-1}$， $\\Sigma_{a,2} = 0.060\\,\\mathrm{cm}^{-1}$， $\\Sigma_{s,1\\to 2} = 0.040\\,\\mathrm{cm}^{-1}$， $\\Sigma_{f,1} = 0.001\\,\\mathrm{cm}^{-1}$， $\\Sigma_{f,2} = 0.100\\,\\mathrm{cm}^{-1}$。\n  - 每次裂变的平均中子数 $\\nu = 2.5$。\n\n- 案例3（慢化背景中的局部热区）：\n  - 板块长度 $L = 60\\,\\mathrm{cm}$，单元数量 $N = 240$。\n  - 背景属性：$D_1 = 1.3\\,\\mathrm{cm}$， $D_2 = 0.35\\,\\mathrm{cm}$， $\\Sigma_{a,1} = 0.007\\,\\mathrm{cm}^{-1}$， $\\Sigma_{a,2} = 0.050\\,\\mathrm{cm}^{-1}$， $\\Sigma_{s,1\\to 2} = 0.030\\,\\mathrm{cm}^{-1}$， $\\Sigma_{f,1} = 0.0005\\,\\mathrm{cm}^{-1}$， $\\Sigma_{f,2} = 0.020\\,\\mathrm{cm}^{-1}$。\n  - 热区属性（应用于中心区域 $x \\in \\left[\\frac{L}{2}-3, \\frac{L}{2}+3\\right]\\,\\mathrm{cm}$）：$D_1 = 1.3\\,\\mathrm{cm}$， $D_2 = 0.35\\,\\mathrm{cm}$， $\\Sigma_{a,1} = 0.007\\,\\mathrm{cm}^{-1}$， $\\Sigma_{a,2} = 0.090\\,\\mathrm{cm}^{-1}$， $\\Sigma_{s,1\\to 2} = 0.060\\,\\mathrm{cm}^{-1}$， $\\Sigma_{f,1} = 0.001\\,\\mathrm{cm}^{-1}$， $\\Sigma_{f,2} = 0.600\\,\\mathrm{cm}^{-1}$。\n  - 每次裂变的平均中子数 $\\nu = 2.5$。\n\n所有量都必须以上述单位处理，程序的最终输出必须是无量纲的峰化因子。\n\n你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，排序如下\n$$\n\\left[P_1^{(1)},\\,P_2^{(1)},\\,P_F^{(1)},\\,P_1^{(2)},\\,P_2^{(2)},\\,P_F^{(2)},\\,P_1^{(3)},\\,P_2^{(3)},\\,P_F^{(3)}\\right],\n$$\n其中上标表示案例编号。每个列表元素必须是浮点数。不应打印其他任何文本。",
            "solution": "问题陈述已经过验证，被认为是适定的、科学上合理的和自洽的。它提出了计算反应堆物理中的一个标准问题：确定一维双群中子扩散模型中的基模中子通量分布及相关的峰化因子。所提供的方程、边界条件、离散化方案和材料数据是一致且符合物理现实的。因此，我们可以进行完整的求解。\n\n该解决方案综合了中子扩散理论与求解广义特征值问题的数值方法。任务的核心是将连续的区域和方程离散化为一个代数系统，然后求解其主模。\n\n**1. 使用有限体积法进行离散化**\n\n连续的稳态双群中子扩散方程如下：\n$$\n- \\frac{d}{dx}\\!\\left(D_1(x)\\,\\frac{d \\phi_1(x)}{dx}\\right) + \\Sigma_{r,1}(x)\\,\\phi_1(x) \\;=\\; \\frac{1}{k}\\left(\\nu\\Sigma_{f,1}(x)\\,\\phi_1(x) + \\nu\\Sigma_{f,2}(x)\\,\\phi_2(x)\\right)\n$$\n$$\n- \\frac{d}{dx}\\!\\left(D_2(x)\\,\\frac{d \\phi_2(x)}{dx}\\right) + \\Sigma_{a,2}(x)\\,\\phi_2(x) \\;=\\; \\Sigma_{s,1\\to 2}(x)\\,\\phi_1(x)\n$$\n这里，群1的移出截面定义为 $\\Sigma_{r,1}(x) = \\Sigma_{a,1}(x) + \\Sigma_{s,1\\to 2}(x)$。区域 $x \\in [0, L]$ 服从反射边界条件，这意味着在边界处的净中子流（$J_g(x) = -D_g(x) \\frac{d\\phi_g(x)}{dx}$）为零：$J_g(0) = J_g(L) = 0$。\n\n我们将区域离散化为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀单元。单元中心位于 $x_i = (i + 1/2)\\Delta x$，其中 $i \\in \\{0, 1, \\dots, N-1\\}$。通量 $\\phi_g(x)$ 在单元 $i$ 内由其单元平均值 $\\phi_{g,i}$ 近似。将扩散方程在单元 $i$上（从 $x_{i-1/2}$ 到 $x_{i+1/2}$）积分，得到：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( -\\frac{d J_g(x)}{dx} + \\Sigma_{\\text{reaction},g}(x)\\phi_g(x) \\right) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} S_g(x) dx\n$$\n其中 $\\Sigma_{\\text{reaction},g}$ 和 $S_g$ 代表群 $g$ 的相应反应项和源项。对泄漏项应用微积分基本定理并近似剩余的积分项，可得：\n$$\n-J_{g,i+1/2} + J_{g,i-1/2} + \\Sigma_{\\text{reaction},g,i}\\,\\phi_{g,i}\\,\\Delta x \\approx S_{g,i}\\,\\Delta x\n$$\n界面流 $J_{g,i\\pm 1/2}$ 使用基于单元中心通量的有限差分进行近似：\n$$\nJ_{g,i+1/2} = -D_{g,i+1/2}\\frac{\\phi_{g,i+1}-\\phi_{g,i}}{\\Delta x}\n$$\n问题指定了界面扩散系数采用调和平均值，这是一个标准的选择，可以保证跨材料界面的流的连续性：\n$$\nD_{g,i+1/2} = \\frac{2 D_{g,i} D_{g,i+1}}{D_{g,i} + D_{g,i+1}}\n$$\n组合这些表达式，得到单元 $i$ 的扩散算子的离散形式，它构成了泄漏矩阵 $\\mathbf{L}_g$ 的一行：\n$$\n[-\\nabla \\cdot (D_g \\nabla \\phi_g)]_i \\approx \\frac{1}{\\Delta x^2} \\left[ -D_{g,i-1/2} \\phi_{g,i-1} + (D_{g,i-1/2} + D_{g,i+1/2}) \\phi_{g,i} - D_{g,i+1/2} \\phi_{g,i+1} \\right]\n$$\n反射边界条件 ($J_g(0)=0, J_g(L)=0$)是通过将区域边界处的界面扩散系数设置为零来实现的，即 $D_{g,-1/2} = 0$ 和 $D_{g,N-1/2} = 0$。这使得 $\\mathbf{L}_g$ 成为一个 $N \\times N$ 的对称、半正定、三对角矩阵。\n\n**2. 组装代数特征值问题**\n\n定义了离散化之后，连续方程被转换为一个矩阵特征值问题 $\\mathbf{A}\\boldsymbol{\\phi} = \\frac{1}{k}\\mathbf{F}\\boldsymbol{\\phi}$。通量向量 $\\boldsymbol{\\phi} = [\\boldsymbol{\\phi}_1^T, \\boldsymbol{\\phi}_2^T]^T$ 是一个长度为 $2N$ 的向量。\n损失与散射矩阵 $\\mathbf{A}$ 和裂变产生矩阵 $\\mathbf{F}$ 是 $2N \\times 2N$ 的块矩阵：\n$$\n\\mathbf{A} = \\begin{bmatrix} \\mathbf{L}_1 + \\mathrm{diag}(\\Sigma_{r,1})  \\mathbf{0} \\\\ -\\mathrm{diag}(\\Sigma_{s,1\\to 2})  \\mathbf{L}_2 + \\mathrm{diag}(\\Sigma_{a,2}) \\end{bmatrix}, \\quad \\mathbf{F} = \\begin{bmatrix} \\mathrm{diag}(\\nu\\Sigma_{f,1})  \\mathrm{diag}(\\nu\\Sigma_{f,2}) \\\\ \\mathbf{0}  \\mathbf{0} \\end{bmatrix}\n$$\n子矩阵 $\\mathbf{L}_g + \\mathrm{diag}(\\cdot)$ 是三对角的。具体来说，对于 $\\mathbf{A}_{11} = \\mathbf{L}_1 + \\mathrm{diag}(\\Sigma_{r,1})$，其对角和非对角元素为：\n- 主对角线 $(i,i)$: $\\frac{D_{1,i-1/2} + D_{1,i+1/2}}{\\Delta x^2} + \\Sigma_{r,1,i}$\n- 次对角线 $(i,i-1)$: $-\\frac{D_{1,i-1/2}}{\\Delta x^2}$\n- 超对角线 $(i,i+1)$: $-\\frac{D_{1,i+1/2}}{\\Delta x^2}$\n$\\mathbf{A}_{22}$ 也有类似的表达式。\n\n**3. 通过幂迭代法（源迭代法）求解**\n\n该问题寻求基模解，它对应于与最大正特征值 $k$（有效增殖因子）相关联的特征向量。这可以通过幂迭代法找到，在此背景下也称为源迭代法。\n\n算法流程如下：\n1. 初始化通量向量 $\\boldsymbol{\\phi}^{(0)}$（例如，一个全为1的向量）和特征值 $k^{(0)} = 1.0$。\n2. 对于迭代 $p = 1, 2, \\dots$ 直到收敛：\n    a. 根据上一步迭代的通量计算裂变源：$\\mathbf{s}_{fission}^{(p-1)} = \\mathbf{F} \\boldsymbol{\\phi}^{(p-1)}$。\n    b. 线性系统的总源项为 $\\mathbf{S} = \\frac{1}{k^{(p-1)}} \\mathbf{s}_{fission}^{(p-1)}$。\n    c. 求解线性系统 $\\mathbf{A}\\boldsymbol{\\phi}^{(p)} = \\mathbf{S}$ 以获得新的通量向量 $\\boldsymbol{\\phi}^{(p)}$。由于 $\\mathbf{A}$ 是块下三角矩阵，此过程分两个阶段求解：\n        i. 求解快中子通量 $\\boldsymbol{\\phi}_1^{(p)}$：$(\\mathbf{L}_1 + \\mathrm{diag}(\\Sigma_{r,1}))\\boldsymbol{\\phi}_1^{(p)} = \\mathbf{S}_1$。这是一个三对角系统，可以用托马斯算法（TDMA）高效求解。\n        ii. 求解热中子通量 $\\boldsymbol{\\phi}_2^{(p)}$：$(\\mathbf{L}_2 + \\mathrm{diag}(\\Sigma_{a,2}))\\boldsymbol{\\phi}_2^{(p)} = \\mathbf{S}_2 - \\mathbf{A}_{21}\\boldsymbol{\\phi}_1^{(p)} = \\mathbf{0} + \\mathrm{diag}(\\Sigma_{s,1\\to 2})\\boldsymbol{\\phi}_1^{(p)}$。这也是一个通过TDMA求解的三对角系统。\n    d. 根据更新后的通量计算新的裂变源：$\\mathbf{s}_{fission}^{(p)} = \\mathbf{F} \\boldsymbol{\\phi}^{(p)}$。\n    e. 更新特征值：$k^{(p)} = k^{(p-1)} \\, \\frac{\\sum_j (\\mathbf{s}_{fission}^{(p)})_j}{\\sum_j (\\mathbf{s}_{fission}^{(p-1)})_j}$。该比率有效地比较了两次迭代之间的总中子产生率。\n    f. 检查收敛性，例如，要求 $|k^{(p)} - k^{(p-1)}|  \\epsilon$ 对于某个小的容差 $\\epsilon$。如果未收敛，则更新 $\\boldsymbol{\\phi}^{(p-1)} \\leftarrow \\boldsymbol{\\phi}^{(p)}$ 和 $k^{(p-1)} \\leftarrow k^{(p)}$ 并重复。\n\n**4. 峰化因子的计算**\n\n一旦幂迭代收敛，我们就得到了基模通量特征向量 $\\boldsymbol{\\phi} = [\\boldsymbol{\\phi}_1^T, \\boldsymbol{\\phi}_2^T]^T$。问题要求三个无量纲的峰化因子，定义为最大值与空间平均值的比率。\n1. 快中子通量峰化因子，$P_1$：\n$$\nP_1 = \\frac{\\max_{i} \\phi_{1,i}}{\\langle \\phi_1 \\rangle} = \\frac{\\max_{i} \\phi_{1,i}}{\\frac{1}{N}\\sum_{i=0}^{N-1} \\phi_{1,i}}\n$$\n2. 热中子通量峰化因子，$P_2$：\n$$\nP_2 = \\frac{\\max_{i} \\phi_{2,i}}{\\langle \\phi_2 \\rangle} = \\frac{\\max_{i} \\phi_{2,i}}{\\frac{1}{N}\\sum_{i=0}^{N-1} \\phi_{2,i}}\n$$\n3. 裂变率峰化因子，$P_F$：首先，我们计算逐点的裂变反应率，$f_i = \\Sigma_{f,1,i}\\phi_{1,i} + \\Sigma_{f,2,i}\\phi_{2,i}$。\n$$\nP_F = \\frac{\\max_i f_i}{\\langle f \\rangle} = \\frac{\\max_i f_i}{\\frac{1}{N}\\sum_{i=0}^{N-1} f_i}\n$$\n对指定的三个测试案例中的每一个都执行这些步骤，从而产生九个最终的浮点数值。",
            "answer": "$$[1.234, 1.488, 1.486, 1.482, 1.554, 1.556, 1.109, 3.498, 6.703]$$"
        }
    ]
}