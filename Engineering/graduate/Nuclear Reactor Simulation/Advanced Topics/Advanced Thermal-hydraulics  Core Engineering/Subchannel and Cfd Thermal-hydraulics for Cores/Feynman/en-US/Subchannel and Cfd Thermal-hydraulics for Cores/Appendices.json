{
    "hands_on_practices": [
        {
            "introduction": "A robust thermal-hydraulic analysis of a reactor core begins with an accurate model of the heat source. This exercise guides you through a foundational conjugate heat transfer (CHT) problem, where you will derive the temperature distribution across a fuel rod, from its centerline to the cladding surface . By mastering this multi-region heat conduction problem, you can precisely determine the heat flux delivered to the coolant, a critical boundary condition for any subchannel or CFD simulation.",
            "id": "4253226",
            "problem": "A single fuel rod in a nuclear reactor core is modeled as an axisymmetric cylinder consisting of a solid fuel region and a solid cladding region, surrounded by a flowing coolant. You are to apply Conjugate Heat Transfer (CHT) with physically correct interface conditions to compute centerline fuel temperature at the rod outlet for specified scenarios.\n\nAssumptions and geometry:\n- The fuel is a solid cylinder of radius $R_f$ with constant thermal conductivity $k_f$.\n- The cladding is a hollow cylinder with inner radius equal to $R_f$ and outer radius $R_{co}$, with constant thermal conductivity $k_c$.\n- The coolant is modeled as a one-dimensional bulk flow along the axial direction $x \\in [0,L]$ with constant mass flow rate $\\dot{m}$ and specific heat $c_p$; the convective heat transfer coefficient at the cladding outer surface is $h$, and the bulk inlet temperature is $T_{b,\\mathrm{in}}$.\n- The volumetric heat generation in the fuel is spatially varying in the radial direction as $q'''(r) = q_0 \\left[1 + a \\left(\\frac{r}{R_f}\\right)^2\\right]$ for $0 \\le r \\le R_f$, and $q'''(r)=0$ for $R_f  r \\le R_{co}$.\n- The problem is steady state, axisymmetric, and neglects axial conduction and thermal radiation.\n\nGoverning equations:\n- In the fuel ($0 \\le r \\le R_f$): the steady radial energy equation in cylindrical coordinates is\n$$\n\\frac{1}{r}\\frac{d}{dr}\\left(k_f r \\frac{dT}{dr}\\right) + q'''(r) = 0.\n$$\n- In the cladding ($R_f \\le r \\le R_{co}$): the steady radial energy equation is\n$$\n\\frac{1}{r}\\frac{d}{dr}\\left(k_c r \\frac{dT}{dr}\\right) = 0.\n$$\n- Boundary and interface conditions:\n  1. Symmetry at the centerline: $\\left.\\frac{dT}{dr}\\right|_{r=0} = 0$.\n  2. Continuity of temperature at $r=R_f$: $T_f(R_f) = T_c(R_f)$.\n  3. Continuity of normal heat flux at $r=R_f$: $k_f \\left.\\frac{dT_f}{dr}\\right|_{r=R_f} = k_c \\left.\\frac{dT_c}{dr}\\right|_{r=R_f}$.\n  4. Convective boundary at the cladding outer surface: $-k_c \\left.\\frac{dT_c}{dr}\\right|_{r=R_{co}} = h\\left[T_c(R_{co}) - T_b(x)\\right]$.\n- Bulk coolant energy balance along $x$:\n$$\n\\frac{dT_b}{dx} = \\frac{Q'}{\\dot{m} c_p}, \\qquad Q' = \\int_0^{R_f} q'''(r) 2\\pi r \\, dr,\n$$\nwith inlet condition $T_b(0)=T_{b,\\mathrm{in}}$.\n\nTasks:\n1. Starting from the governing equations and boundary/interface conditions, derive the analytical expression for the fuel centerline temperature $T_f(0;x)$ in terms of the bulk coolant temperature $T_b(x)$ and the parameters $\\{q_0,a,R_f,R_{co},k_f,k_c,h\\}$.\n2. Using the bulk energy balance, compute $T_b(L)$ at the rod outlet and evaluate the corresponding centerline temperature $T_f(0;L)$.\n\nUnits and output requirements:\n- All temperatures must be expressed in Kelvin, and the final reported values must be rounded to three decimal places.\n- Your program must compute the outlet fuel centerline temperature for each of the following three test cases and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases listed below.\n\nTest suite (all quantities in SI units):\n- Case 1 (representative pressurized water reactor subchannel conditions):\n  - $R_f = 0.004\\,\\mathrm{m}$, $R_{co} = 0.00475\\,\\mathrm{m}$, $k_f = 3.0\\,\\mathrm{W/(m\\cdot K)}$, $k_c = 16.0\\,\\mathrm{W/(m\\cdot K)}$, $h = 20000.0\\,\\mathrm{W/(m^2\\cdot K)}$\n  - $q_0 = 3.5\\times 10^8\\,\\mathrm{W/m^3}$, $a = 0.3$, $L = 4.0\\,\\mathrm{m}$, $\\dot{m} = 0.25\\,\\mathrm{kg/s}$, $c_p = 4200.0\\,\\mathrm{J/(kg\\cdot K)}$, $T_{b,\\mathrm{in}} = 580.0\\,\\mathrm{K}$\n- Case 2 (very high convection limit and inward-peaked power):\n  - $R_f = 0.004\\,\\mathrm{m}$, $R_{co} = 0.00475\\,\\mathrm{m}$, $k_f = 3.0\\,\\mathrm{W/(m\\cdot K)}$, $k_c = 16.0\\,\\mathrm{W/(m\\cdot K)}$, $h = 1.0\\times 10^6\\,\\mathrm{W/(m^2\\cdot K)}$\n  - $q_0 = 1.2\\times 10^8\\,\\mathrm{W/m^3}$, $a = -0.5$, $L = 2.0\\,\\mathrm{m}$, $\\dot{m} = 0.10\\,\\mathrm{kg/s}$, $c_p = 4200.0\\,\\mathrm{J/(kg\\cdot K)}$, $T_{b,\\mathrm{in}} = 570.0\\,\\mathrm{K}$\n- Case 3 (low fuel conductivity, thicker heat loads):\n  - $R_f = 0.004\\,\\mathrm{m}$, $R_{co} = 0.0046\\,\\mathrm{m}$, $k_f = 1.5\\,\\mathrm{W/(m\\cdot K)}$, $k_c = 16.0\\,\\mathrm{W/(m\\cdot K)}$, $h = 15000.0\\,\\mathrm{W/(m^2\\cdot K)}$\n  - $q_0 = 5.0\\times 10^8\\,\\mathrm{W/m^3}$, $a = 0.0$, $L = 3.5\\,\\mathrm{m}$, $\\dot{m} = 0.20\\,\\mathrm{kg/s}$, $c_p = 4200.0\\,\\mathrm{J/(kg\\cdot K)}$, $T_{b,\\mathrm{in}} = 565.0\\,\\mathrm{K}$\n\nFinal output format:\n- Your program should produce a single line of output containing the outlet centerline temperatures for Cases $1$, $2$, and $3$ in Kelvin, rounded to three decimals, as a comma-separated list enclosed in square brackets, for example, $[T_1,T_2,T_3]$.",
            "solution": "The user-provided problem statement is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n\n**Geometry and Materials:**\n- Fuel region: solid cylinder, radius $R_f$, constant thermal conductivity $k_f$.\n- Cladding region: hollow cylinder, inner radius $R_f$, outer radius $R_{co}$, constant thermal conductivity $k_c$.\n- Coolant: one-dimensional bulk flow in axial direction $x \\in [0,L]$, constant mass flow rate $\\dot{m}$, constant specific heat $c_p$.\n- Convective heat transfer coefficient at cladding outer surface: $h$.\n- Bulk coolant inlet temperature: $T_{b,\\mathrm{in}}$.\n\n**Heat Generation:**\n- Volumetric heat generation in fuel ($0 \\le r \\le R_f$): $q'''(r) = q_0 \\left[1 + a \\left(\\frac{r}{R_f}\\right)^2\\right]$.\n- No heat generation in cladding ($R_f  r \\le R_{co}$): $q'''(r) = 0$.\n\n**Assumptions:**\n- Steady state.\n- Axisymmetric.\n- Axial conduction is neglected.\n- Thermal radiation is neglected.\n\n**Governing Equations:**\n- Fuel ($0 \\le r \\le R_f$): $\\frac{1}{r}\\frac{d}{dr}\\left(k_f r \\frac{dT}{dr}\\right) + q'''(r) = 0$.\n- Cladding ($R_f \\le r \\le R_{co}$): $\\frac{1}{r}\\frac{d}{dr}\\left(k_c r \\frac{dT}{dr}\\right) = 0$.\n- Coolant ($x \\in [0,L]$): $\\frac{dT_b}{dx} = \\frac{Q'}{\\dot{m} c_p}$, where $Q' = \\int_0^{R_f} q'''(r) 2\\pi r \\, dr$.\n\n**Boundary and Interface Conditions:**\n1. Centerline symmetry: $\\left.\\frac{dT}{dr}\\right|_{r=0} = 0$.\n2. Temperature continuity at fuel-cladding interface: $T_f(R_f) = T_c(R_f)$.\n3. Heat flux continuity at fuel-cladding interface: $k_f \\left.\\frac{dT_f}{dr}\\right|_{r=R_f} = k_c \\left.\\frac{dT_c}{dr}\\right|_{r=R_f}$.\n4. Convection at cladding-coolant interface: $-k_c \\left.\\frac{dT_c}{dr}\\right|_{r=R_{co}} = h\\left[T_c(R_{co}) - T_b(x)\\right]$.\n5. Coolant inlet condition: $T_b(0)=T_{b,\\mathrm{in}}$.\n\n**Tasks:**\n1. Derive the analytical expression for $T_f(0;x)$ in terms of $T_b(x)$ and parameters.\n2. Compute $T_b(L)$ and subsequently $T_f(0;L)$.\n\n**Test Cases (SI Units):**\n- Case 1: $R_f = 0.004$, $R_{co} = 0.00475$, $k_f = 3.0$, $k_c = 16.0$, $h = 20000.0$, $q_0 = 3.5\\times 10^8$, $a = 0.3$, $L = 4.0$, $\\dot{m} = 0.25$, $c_p = 4200.0$, $T_{b,\\mathrm{in}} = 580.0$.\n- Case 2: $R_f = 0.004$, $R_{co} = 0.00475$, $k_f = 3.0$, $k_c = 16.0$, $h = 1.0\\times 10^6$, $q_0 = 1.2\\times 10^8$, $a = -0.5$, $L = 2.0$, $\\dot{m} = 0.10$, $c_p = 4200.0$, $T_{b,\\mathrm{in}} = 570.0$.\n- Case 3: $R_f = 0.004$, $R_{co} = 0.0046$, $k_f = 1.5$, $k_c = 16.0$, $h = 15000.0$, $q_0 = 5.0\\times 10^8$, $a = 0.0$, $L = 3.5$, $\\dot{m} = 0.20$, $c_p = 4200.0$, $T_{b,\\mathrm{in}} = 565.0$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, employing standard one-dimensional heat conduction equations in cylindrical coordinates and a bulk energy balance for the coolant, which are fundamental principles of heat transfer. The boundary and interface conditions (symmetry, continuity of temperature and heat flux, convection) are physically correct and standard for conjugate heat transfer problems. The problem is well-posed, providing all necessary parameters and a clear set of tasks that lead to a unique solution. The language is objective and precise, with no ambiguity. All data are provided in consistent SI units. The problem is self-contained and free of contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n---\n\nThe solution proceeds by first deriving the temperature profile in the radial direction and then solving for the axial temperature rise of the coolant.\n\n**Part 1: Radial Temperature Profile**\n\nThe goal is to find the temperature difference between the fuel centerline, $T_f(0; x)$, and the bulk coolant, $T_b(x)$, at an arbitrary axial position $x$. This difference is the sum of temperature drops across the fuel, the cladding, and the convective film:\n$$\nT_f(0; x) - T_b(x) = \\left[T_f(0) - T_f(R_f)\\right] + \\left[T_c(R_f) - T_c(R_{co})\\right] + \\left[T_c(R_{co}) - T_b(x)\\right]\n$$\nNote that from interface condition 2, $T_f(R_f) = T_c(R_f)$.\n\n**1a: Temperature Drop in the Fuel, $\\Delta T_{fuel} = T_f(0) - T_f(R_f)$**\nThe energy equation in the fuel is:\n$$\n\\frac{d}{dr}\\left(r \\frac{dT_f}{dr}\\right) = -\\frac{r}{k_f} q'''(r) = -\\frac{r}{k_f} q_0 \\left[1 + a \\left(\\frac{r}{R_f}\\right)^2\\right] = -\\frac{q_0}{k_f} \\left(r + \\frac{a}{R_f^2}r^3\\right)\n$$\nIntegrating with respect to $r$:\n$$\nr \\frac{dT_f}{dr} = -\\frac{q_0}{k_f} \\left(\\frac{r^2}{2} + \\frac{a r^4}{4R_f^2}\\right) + C_1\n$$\nApplying the symmetry condition $\\left.\\frac{dT_f}{dr}\\right|_{r=0} = 0$. For the gradient to be finite at $r=0$, we must have $C_1=0$.\n$$\n\\frac{dT_f}{dr} = -\\frac{q_0}{k_f} \\left(\\frac{r}{2} + \\frac{a r^3}{4R_f^2}\\right)\n$$\nIntegrating again from $r$ to $R_f$:\n$$\nT_f(R_f) - T_f(r) = \\int_r^{R_f} \\left[-\\frac{q_0}{k_f} \\left(\\frac{s}{2} + \\frac{a s^3}{4R_f^2}\\right)\\right] ds = -\\frac{q_0}{k_f} \\left[\\frac{s^2}{4} + \\frac{a s^4}{16R_f^2}\\right]_r^{R_f}\n$$\n$T_f(r) - T_f(R_f) = \\frac{q_0}{k_f} \\left[ \\left(\\frac{R_f^2}{4} + \\frac{a R_f^4}{16R_f^2}\\right) - \\left(\\frac{r^2}{4} + \\frac{a r^4}{16R_f^2}\\right) \\right]$.\nThe temperature drop from centerline ($r=0$) to the fuel surface ($r=R_f$) is:\n$$\n\\Delta T_{fuel} = T_f(0) - T_f(R_f) = \\frac{q_0}{k_f} \\left(\\frac{R_f^2}{4} + \\frac{a R_f^2}{16}\\right) = \\frac{q_0 R_f^2}{16k_f}(4+a)\n$$\n\n**1b: Total Heat Generation per Unit Length, $Q'$**\nThe heat generated in the fuel must be transferred through the cladding and to the coolant. The linear heat rate, $Q'$, is constant with respect to $r$ outside the fuel.\n$$\nQ' = \\int_0^{R_f} q'''(r) 2\\pi r \\, dr = 2\\pi q_0 \\int_0^{R_f} \\left(r + \\frac{a}{R_f^2}r^3\\right) dr\n$$\n$$\nQ' = 2\\pi q_0 \\left[\\frac{r^2}{2} + \\frac{a r^4}{4R_f^2}\\right]_0^{R_f} = 2\\pi q_0 \\left(\\frac{R_f^2}{2} + \\frac{a R_f^2}{4}\\right) = \\pi q_0 R_f^2 \\left(1 + \\frac{a}{2}\\right)\n$$\n\n**1c: Temperature Drop in the Cladding, $\\Delta T_{clad} = T_c(R_f) - T_c(R_{co})$**\nThe energy equation in the cladding is $\\frac{d}{dr}\\left(r \\frac{dT_c}{dr}\\right) = 0$. The general solution is $T_c(r) = C_2 \\ln(r) + C_3$.\nThe heat flux is $q''(r) = -k_c \\frac{dT_c}{dr} = -k_c \\frac{C_2}{r}$. The total heat flow per unit length is $Q'_{clad} = 2\\pi r q''(r) = -2\\pi k_c C_2$.\nBy conservation of energy, $Q'_{clad} = Q'$, so $C_2 = -\\frac{Q'}{2\\pi k_c}$.\nThe temperature drop across the cladding is:\n$$\n\\Delta T_{clad} = T_c(R_f) - T_c(R_{co}) = \\left(-\\frac{Q'}{2\\pi k_c} \\ln(R_f) + C_3\\right) - \\left(-\\frac{Q'}{2\\pi k_c} \\ln(R_{co}) + C_3\\right)\n$$\n$$\n\\Delta T_{clad} = \\frac{Q'}{2\\pi k_c} (\\ln(R_{co}) - \\ln(R_f)) = \\frac{Q'}{2\\pi k_c} \\ln\\left(\\frac{R_{co}}{R_f}\\right)\n$$\n\n**1d: Temperature Drop across Convective Film, $\\Delta T_{conv} = T_c(R_{co}) - T_b(x)$**\nThe convective boundary condition at $r=R_{co}$ relates the heat flux to the temperature difference. The heat flux is $q''_{co} = \\frac{Q'}{2\\pi R_{co}}$.\n$$\nq''_{co} = h \\left[T_c(R_{co}) - T_b(x)\\right] \\implies \\frac{Q'}{2\\pi R_{co}} = h \\left[T_c(R_{co}) - T_b(x)\\right]\n$$\nSolving for the temperature drop:\n$$\n\\Delta T_{conv} = T_c(R_{co}) - T_b(x) = \\frac{Q'}{2\\pi R_{co} h}\n$$\n\n**1e: Total Radial Temperature Drop**\nSumming the individual drops gives the expression for $T_f(0;x)$ in terms of $T_b(x)$:\n$$\nT_f(0; x) - T_b(x) = \\Delta T_{fuel} + \\Delta T_{clad} + \\Delta T_{conv}\n$$\n$$\nT_f(0; x) = T_b(x) + \\frac{q_0 R_f^2}{16k_f}(4+a) + \\frac{Q'}{2\\pi k_c} \\ln\\left(\\frac{R_{co}}{R_f}\\right) + \\frac{Q'}{2\\pi R_{co} h}\n$$\nSubstituting the expression for $Q'$:\n$$\nT_f(0; x) = T_b(x) + \\frac{q_0 R_f^2}{16k_f}(4+a) + \\frac{\\pi q_0 R_f^2 (1 + a/2)}{2\\pi} \\left[ \\frac{1}{k_c}\\ln\\left(\\frac{R_{co}}{R_f}\\right) + \\frac{1}{R_{co} h} \\right]\n$$\nThis expression is the complete solution to Task 1.\n\n**Part 2: Axial Coolant Temperature Rise and Outlet Centerline Temperature**\n\n**2a: Outlet Coolant Temperature, $T_b(L)$**\nThe coolant energy balance is given by $\\frac{dT_b}{dx} = \\frac{Q'}{\\dot{m} c_p}$. Since $Q'$ is constant with respect to $x$, this is a simple ordinary differential equation.\nIntegrating from inlet ($x=0$) to outlet ($x=L$):\n$$\n\\int_{T_{b,\\mathrm{in}}}^{T_b(L)} dT_b = \\int_0^L \\frac{Q'}{\\dot{m} c_p} dx \\implies T_b(L) - T_{b,\\mathrm{in}} = \\frac{Q'L}{\\dot{m} c_p}\n$$\nSo, the outlet bulk coolant temperature is:\n$$\nT_b(L) = T_{b,\\mathrm{in}} + \\frac{Q'L}{\\dot{m} c_p} = T_{b,\\mathrm{in}} + \\frac{\\pi q_0 R_f^2 L (1+a/2)}{\\dot{m} c_p}\n$$\n\n**2b: Outlet Fuel Centerline Temperature, $T_f(0;L)$**\nFinally, to find the fuel centerline temperature at the outlet, we evaluate the expression from Part 1e at $x=L$ using $T_b(L)$:\n$$\nT_f(0; L) = T_b(L) + \\left[ T_f(0;x) - T_b(x) \\right]\n$$\nThe radial temperature drop $\\left[ T_f(0;x) - T_b(x) \\right]$ is independent of $x$, so we can write:\n$$\nT_f(0; L) = \\left( T_{b,\\mathrm{in}} + \\frac{\\pi q_0 R_f^2 L (1+a/2)}{\\dot{m} c_p} \\right) + \\frac{q_0 R_f^2}{16k_f}(4+a) + \\frac{\\pi q_0 R_f^2 (1+a/2)}{2\\pi} \\left[ \\frac{1}{k_c}\\ln\\left(\\frac{R_{co}}{R_f}\\right) + \\frac{1}{R_{co} h} \\right]\n$$\nThis is the final analytical expression used for computation. The calculation is implemented by first finding $Q'$, then $T_b(L)$, then the total radial temperature drop, and finally summing them.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nuclear fuel rod heat transfer problem for the specified test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Representative PWR subchannel conditions\n        {\n            \"Rf\": 0.004, \"Rco\": 0.00475, \"kf\": 3.0, \"kc\": 16.0, \"h\": 20000.0,\n            \"q0\": 3.5e8, \"a\": 0.3, \"L\": 4.0, \"m_dot\": 0.25, \"cp\": 4200.0, \"Tb_in\": 580.0\n        },\n        # Case 2: Very high convection limit and inward-peaked power\n        {\n            \"Rf\": 0.004, \"Rco\": 0.00475, \"kf\": 3.0, \"kc\": 16.0, \"h\": 1.0e6,\n            \"q0\": 1.2e8, \"a\": -0.5, \"L\": 2.0, \"m_dot\": 0.10, \"cp\": 4200.0, \"Tb_in\": 570.0\n        },\n        # Case 3: Low fuel conductivity, thicker heat loads\n        {\n            \"Rf\": 0.004, \"Rco\": 0.0046, \"kf\": 1.5, \"kc\": 16.0, \"h\": 15000.0,\n            \"q0\": 5.0e8, \"a\": 0.0, \"L\": 3.5, \"m_dot\": 0.20, \"cp\": 4200.0, \"Tb_in\": 565.0\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        Rf, Rco = params[\"Rf\"], params[\"Rco\"]\n        kf, kc, h = params[\"kf\"], params[\"kc\"], params[\"h\"]\n        q0, a, L = params[\"q0\"], params[\"a\"], params[\"L\"]\n        m_dot, cp, Tb_in = params[\"m_dot\"], params[\"cp\"], params[\"Tb_in\"]\n\n        # 1. Calculate the linear heat rate Q' (W/m)\n        # Q' = pi * q0 * Rf^2 * (1 + a/2)\n        Q_prime = np.pi * q0 * Rf**2 * (1.0 + a / 2.0)\n\n        # 2. Calculate the outlet bulk coolant temperature Tb(L) (K)\n        # Tb(L) = Tb_in + (Q' * L) / (m_dot * cp)\n        Tb_out = Tb_in + (Q_prime * L) / (m_dot * cp)\n\n        # 3. Calculate the radial temperature drops\n        \n        # 3a. Temperature drop within the fuel: Tf(0) - Tf(Rf)\n        # deltaT_fuel = (q0 * Rf^2 / (16 * kf)) * (4 + a)\n        delta_T_fuel = (q0 * Rf**2 * (4.0 + a)) / (16.0 * kf)\n\n        # 3b. Temperature drop across the cladding: Tc(Rf) - Tc(Rco)\n        # Thermal resistance of cladding (hollow cylinder) is R_clad = ln(Rco/Rf) / (2*pi*kc)\n        # deltaT_clad = Q' * R_clad\n        delta_T_clad = (Q_prime / (2.0 * np.pi * kc)) * np.log(Rco / Rf)\n\n        # 3c. Temperature drop across the convective film: Tc(Rco) - Tb\n        # Thermal resistance of convection is R_conv = 1 / (h * A) where A is surface area per unit length\n        # A = 2*pi*Rco. So, R_conv_linear = 1 / (2*pi*Rco*h)\n        # deltaT_conv = Q' * R_conv_linear\n        delta_T_conv = Q_prime / (2.0 * np.pi * Rco * h)\n\n        # 4. Sum the temperatures to get the final outlet centerline temperature\n        # Tf(0, L) = Tb(L) + deltaT_fuel + deltaT_clad + deltaT_conv\n        Tf_centerline_outlet = Tb_out + delta_T_fuel + delta_T_clad + delta_T_conv\n        \n        # Round to three decimal places and append to results list\n        results.append(f\"{Tf_centerline_outlet:.3f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "With the heat source defined, the focus shifts to modeling its effect on the coolant as it flows through the complex geometry of the reactor core. This practice delves into the heart of subchannel analysis by simulating the energy exchange between adjacent coolant channels due to turbulent mixing and lateral crossflow . Solving the coupled system of energy equations will provide direct insight into how these mixing phenomena work to homogenize the coolant temperature field, a crucial process for maintaining safe operating margins.",
            "id": "4253228",
            "problem": "Consider a simplified subchannel thermal-hydraulics model for a nuclear reactor core in which multiple coolant subchannels exchange energy through turbulent mixing and lateral crossflow. Assume single-phase, incompressible flow with constant mass flow rate in each subchannel, negligible axial conduction, and constant heat addition per unit axial length. For subchannel $i$, the axial evolution of the specific enthalpy $h_i(z)$ is modeled by the coupled first-order ordinary differential equation\n$$\n\\frac{d h_i}{dz} = s_i + \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right)\\left(h_j - h_i\\right),\n$$\nwhere $z$ is the axial coordinate, $m_i$ is the mass flow rate in subchannel $i$, $s_i = \\frac{q''_i P_i}{m_i}$ is the axial enthalpy source term with $q''_i$ the wall heat flux and $P_i$ the wetted perimeter, $\\beta_{ij}$ is the turbulent mixing coefficient between subchannels $i$ and $j$, $f_{ij}$ is the lateral crossflow mass exchange rate per unit axial length from subchannel $i$ to neighbor $j$, and $\\mathcal{N}(i)$ is the set of neighbors of subchannel $i$. All quantities are taken as constant in $z$. The initial condition at the core inlet is uniform across subchannels,\n$$\nh_i(0) = h_{\\text{in}}, \\quad \\text{for all } i.\n$$\nDefine the enthalpy rise in subchannel $i$ as $\\Delta h_i = h_i(L) - h_{\\text{in}}$, where $L$ is the core length. The enthalpy maldistribution at the outlet is quantified by the coefficient of variation\n$$\n\\text{CV} = \\frac{\\sigma_{\\Delta h}}{\\mu_{\\Delta h}},\n$$\nwhere $\\sigma_{\\Delta h}$ is the standard deviation of $\\{\\Delta h_i\\}$ across all subchannels and $\\mu_{\\Delta h}$ is the mean of $\\{\\Delta h_i\\}$ across all subchannels.\n\nStarting from conservation of energy and the definitions above, derive the coupled system in vector form and solve for the outlet enthalpies $h_i(L)$ using a mathematically sound method. Then compute the maldistribution metric $\\text{CV}$.\n\nUnits and constants:\n- Use $h$ in $\\text{J}/\\text{kg}$, $z$ and $L$ in $\\text{m}$, $m$ in $\\text{kg}/\\text{s}$, $q''$ in $\\text{W}/\\text{m}^2$, $P$ in $\\text{m}$, $\\beta$ in $\\text{m}^{-1}$, and $f$ in $\\text{kg}/(\\text{s}\\cdot\\text{m})$.\n- Use $h_{\\text{in}} = 1.0\\times 10^{5}\\ \\text{J}/\\text{kg}$.\n\nTest suite to implement and evaluate:\n- Case $1$ (happy path, moderate mixing and crossflow, asymmetric heating):\n  - Subchannels: $N = 4$ arranged in a $2\\times 2$ grid with neighbors $(0,1)$, $(0,2)$, $(1,3)$, $(2,3)$.\n  - Length: $L = 4.0\\ \\text{m}$.\n  - Mass flows: $(m_0,m_1,m_2,m_3) = (0.25, 0.25, 0.25, 0.25)\\ \\text{kg}/\\text{s}$.\n  - Wetted perimeters: $(P_0,P_1,P_2,P_3) = (0.10,0.10,0.10,0.10)\\ \\text{m}$.\n  - Heat fluxes: $(q''_0,q''_1,q''_2,q''_3) = (100000,100000,120000,100000)\\ \\text{W}/\\text{m}^2$.\n  - Mixing: $\\beta_{ij} = 0.8\\ \\text{m}^{-1}$ for each neighbor pair.\n  - Crossflow per unit length: $f_{ij} = 0.02\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$ for each neighbor pair.\n- Case $2$ (edge case, no mixing and no crossflow):\n  - Same $N$, neighbors, $L$, $m_i$, $P_i$, $q''_i$ as Case $1$.\n  - Mixing: $\\beta_{ij} = 0.0\\ \\text{m}^{-1}$ for each neighbor pair.\n  - Crossflow per unit length: $f_{ij} = 0.0\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$ for each neighbor pair.\n- Case $3$ (strong mixing and crossflow, heterogeneous mass flows):\n  - Subchannels: $N = 4$ with same neighbor pairs.\n  - Length: $L = 4.0\\ \\text{m}$.\n  - Mass flows: $(m_0,m_1,m_2,m_3) = (0.22, 0.30, 0.26, 0.27)\\ \\text{kg}/\\text{s}$.\n  - Wetted perimeters: $(P_0,P_1,P_2,P_3) = (0.10,0.10,0.10,0.10)\\ \\text{m}$.\n  - Heat fluxes: $(q''_0,q''_1,q''_2,q''_3) = (100000,100000,120000,100000)\\ \\text{W}/\\text{m}^2$.\n  - Mixing: $\\beta_{ij} = 5.0\\ \\text{m}^{-1}$ for each neighbor pair.\n  - Crossflow per unit length: $f_{ij} = 0.10\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$ for each neighbor pair.\n- Case $4$ (boundary case, equal heating):\n  - Subchannels: $N = 4$ with same neighbor pairs.\n  - Length: $L = 4.0\\ \\text{m}$.\n  - Mass flows: $(m_0,m_1,m_2,m_3) = (0.25, 0.25, 0.25, 0.25)\\ \\text{kg}/\\text{s}$.\n  - Wetted perimeters: $(P_0,P_1,P_2,P_3) = (0.10,0.10,0.10,0.10)\\ \\text{m}$.\n  - Heat fluxes: $(q''_0,q''_1,q''_2,q''_3) = (110000,110000,110000,110000)\\ \\text{W}/\\text{m}^2$.\n  - Mixing: $\\beta_{ij} = 1.5\\ \\text{m}^{-1}$ for each neighbor pair.\n  - Crossflow per unit length: $f_{ij} = 0.05\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$ for each neighbor pair.\n\nYour program should, for each case, assemble and solve the coupled system to obtain $h_i(L)$, compute $\\Delta h_i$ and the coefficient of variation $\\text{CV}$, and return the four $\\text{CV}$ values. Express each $\\text{CV}$ as a decimal, rounded to six decimal places. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $\\left[0.123456,0.234567,0.345678,0.456789\\right]$).",
            "solution": "The user has provided a problem statement that describes the axial evolution of specific enthalpy in a set of coupled coolant subchannels within a nuclear reactor core. The task is to solve the governing system of ordinary differential equations (ODEs), calculate the enthalpy rise for each subchannel, and then compute a statistical measure of the outlet enthalpy maldistribution, the coefficient of variation (CV).\n\n### Step 1: Validation of the Problem Statement\n\nI will first validate the problem statement according to the specified criteria.\n\n#### Extraction of Givens:\n- **Governing Equation**: For each subchannel $i$, the axial evolution of specific enthalpy $h_i(z)$ is given by:\n$$\n\\frac{d h_i}{dz} = s_i + \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right)\\left(h_j - h_i\\right)\n$$\n- **Variables and Definitions**:\n  - $z$: axial coordinate (m).\n  - $h_i(z)$: specific enthalpy of subchannel $i$ at position $z$ (J/kg).\n  - $m_i$: constant mass flow rate in subchannel $i$ (kg/s).\n  - $s_i = \\frac{q''_i P_i}{m_i}$: axial enthalpy source term, assumed constant.\n  - $q''_i$: wall heat flux (W/m$^2$).\n  - $P_i$: wetted perimeter (m).\n  - $\\beta_{ij}$: turbulent mixing coefficient between subchannels $i$ and $j$ (m$^{-1}$).\n  - $f_{ij}$: lateral crossflow mass exchange rate per unit length from subchannel $i$ to $j$ (kg/(sÂ·m)). Assumed $f_{ij}=f_{ji}$.\n  - $\\mathcal{N}(i)$: set of neighbors of subchannel $i$.\n- **Initial Condition**: Uniform enthalpy at the core inlet ($z=0$):\n$$\nh_i(0) = h_{\\text{in}} = 1.0\\times 10^{5}\\ \\text{J}/\\text{kg} \\quad \\text{for all } i.\n$$\n- **Quantities to Calculate**:\n  - Enthalpy rise: $\\Delta h_i = h_i(L) - h_{\\text{in}}$, where $L$ is the core length (m).\n  - Coefficient of Variation (maldistribution metric): $\\text{CV} = \\frac{\\sigma_{\\Delta h}}{\\mu_{\\Delta h}}$, where $\\sigma_{\\Delta h}$ and $\\mu_{\\Delta h}$ are the standard deviation and mean of the set $\\{\\Delta h_i\\}$.\n- **Test Suite**: Four specific cases are provided with all necessary numerical parameters for a 4-subchannel system ($N=4$). The topology is a $2\\times 2$ grid with neighbor pairs (0,1), (0,2), (1,3), (2,3), which defines a cycle graph C4 corresponding to a square arrangement (0-1-3-2-0).\n\n#### Validation Using Extracted Givens:\n1.  **Scientifically Grounded**: The governing equation is a standard, albeit simplified, energy balance used in subchannel analysis for nuclear reactor thermal-hydraulics (e.g., in COBRA-like codes). It represents a linearized model of heat and mass exchange. The model is based on fundamental principles of conservation of energy. It is scientifically sound within the context of engineering approximations.\n2.  **Well-Posed**: The problem is an initial value problem (IVP) for a system of linear, first-order ordinary differential equations with constant coefficients. Given a well-defined initial condition, a unique solution exists for all $z \\geq 0$. All parameters required for the solution are provided.\n3.  **Objective**: The problem is stated in precise mathematical and physical terms. The quantities are defined unambiguously.\n4.  **Completeness and Consistency**: All data required to solve the problem for the given test cases are provided. The units are consistent. There are no contradictions in the problem statement.\n5.  **Feasibility/Realism**: The parameters provided in the test cases are within a plausible range for simplified reactor core analysis. The operations are computationally feasible.\n\n#### Verdict and Action:\nThe problem is deemed **valid**. It is a well-posed, scientifically grounded problem from the field of nuclear engineering. I will proceed with the solution.\n\n### Step 2: Solution Derivation and Algorithmic Design\n\nThe core of the problem is to solve a system of coupled linear first-order ODEs.\n\n#### Mathematical Formulation in Vector Form\nThe governing equation for subchannel $i$ can be rewritten by expanding the summation term:\n$$\n\\frac{d h_i}{dz} = s_i + \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right)h_j - \\left[ \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right) \\right] h_i\n$$\nThis system of $N$ equations can be expressed in matrix-vector form. Let $\\mathbf{h}(z)$ be the column vector of specific enthalpies, $[h_0(z), h_1(z), \\dots, h_{N-1}(z)]^T$, and $\\mathbf{s}$ be the column vector of source terms, $[s_0, s_1, \\dots, s_{N-1}]^T$. The system becomes:\n$$\n\\frac{d\\mathbf{h}}{dz} = \\mathbf{A}\\mathbf{h} + \\mathbf{s}\n$$\nwhere $\\mathbf{A}$ is an $N \\times N$ matrix with elements defined as:\n- For off-diagonal elements ($i \\neq j$):\n$$\nA_{ij} = \\begin{cases} \\beta_{ij} + \\frac{f_{ij}}{m_i}  \\text{if } j \\in \\mathcal{N}(i) \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n- For diagonal elements ($i = j$):\n$$\nA_{ii} = - \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right) = - \\sum_{j \\neq i} A_{ij}\n$$\nThe problem states that $\\beta_{ij}$ and $f_{ij}$ are given for each \"neighbor pair\", which implies symmetry: $\\beta_{ij} = \\beta_{ji}$ and $f_{ij} = f_{ji}$. However, the matrix $\\mathbf{A}$ is not necessarily symmetric if the mass flow rates $m_i$ are different. A key property of $\\mathbf{A}$ is that the sum of each row is zero, i.e., $\\mathbf{A}\\mathbf{1} = \\mathbf{0}$, where $\\mathbf{1}$ is a column vector of ones. This means $\\mathbf{A}$ is a singular matrix.\n\nThe initial condition is $\\mathbf{h}(0) = h_{\\text{in}}\\mathbf{1}$.\n\n#### Solving the ODE System\nTo simplify the initial condition, let's define a new vector for the enthalpy rise relative to the inlet, $\\mathbf{y}(z) = \\mathbf{h}(z) - h_{\\text{in}}\\mathbf{1}$. The initial condition for $\\mathbf{y}$ is $\\mathbf{y}(0) = \\mathbf{0}$. The differential equation for $\\mathbf{y}$ is:\n$$\n\\frac{d\\mathbf{y}}{dz} = \\frac{d\\mathbf{h}}{dz} = \\mathbf{A}(\\mathbf{y} + h_{\\text{in}}\\mathbf{1}) + \\mathbf{s} = \\mathbf{A}\\mathbf{y} + h_{\\text{in}}(\\mathbf{A}\\mathbf{1}) + \\mathbf{s}\n$$\nSince $\\mathbf{A}\\mathbf{1} = \\mathbf{0}$, the equation simplifies to:\n$$\n\\frac{d\\mathbf{y}}{dz} = \\mathbf{A}\\mathbf{y} + \\mathbf{s}, \\quad \\text{with} \\quad \\mathbf{y}(0) = \\mathbf{0}\n$$\nThis is a standard inhomogeneous linear ODE system with a homogeneous initial condition. The solution is given by:\n$$\n\\mathbf{y}(z) = \\left( \\int_0^z e^{\\mathbf{A}\\tau} d\\tau \\right) \\mathbf{s}\n$$\nwhere $e^{\\mathbf{A}\\tau}$ is the matrix exponential. Since $\\mathbf{A}$ and $\\mathbf{s}$ are constant, we need to evaluate this expression at $z=L$ to find the outlet enthalpy rises, $\\mathbf{\\Delta h} = \\mathbf{y}(L)$.\n\nA robust numerical method for finding $\\mathbf{y}(L)$ is to use the \"matrix exponential of an augmented matrix\" technique. Let's define an $(N+1) \\times (N+1)$ block matrix $\\mathbf{B}$ as:\n$$\n\\mathbf{B} = \\begin{pmatrix} \\mathbf{A}  \\mathbf{s} \\\\ \\mathbf{0}^T  0 \\end{pmatrix}\n$$\nThe exponential of $\\mathbf{B}L$ can be shown to be:\n$$\ne^{\\mathbf{B}L} = \\begin{pmatrix} e^{\\mathbf{A}L}  \\mathbf{y}(L) \\\\ \\mathbf{0}^T  1 \\end{pmatrix}\n$$\nThus, the vector $\\mathbf{y}(L)$, which is exactly the vector of enthalpy rises $\\mathbf{\\Delta h}$, can be extracted from the upper-right $N \\times 1$ block of the computed matrix $e^{\\mathbf{B}L}$. This method avoids issues with the singularity of $\\mathbf{A}$ and is numerically stable.\n\n#### Algorithm for Computing the Coefficient of Variation (CV)\nFor each test case, the following algorithm is applied:\n1.  **Initialize**: Extract the parameters: core length $L$, mass flow rates $\\mathbf{m}$, wetted perimeters $\\mathbf{P}$, heat fluxes $\\mathbf{q''}$, mixing coefficient $\\beta$, and crossflow coefficient $f$. Define the subchannel neighbor pairs.\n2.  **Construct Source Vector**: Calculate the source term $s_i = \\frac{q''_i P_i}{m_i}$ for each subchannel $i=0, \\dots, N-1$ to form the vector $\\mathbf{s}$.\n3.  **Construct A Matrix**: Create the $N \\times N$ matrix $\\mathbf{A}$ based on the neighbor topology and the given $\\beta$, $f$, and $\\mathbf{m}$ values, according to the formulas for $A_{ij}$ and $A_{ii}$ derived above.\n4.  **Construct Augmented Matrix**: Form the $(N+1) \\times (N+1)$ matrix $\\mathbf{B}$ by augmenting $\\mathbf{A}$ with $\\mathbf{s}$ and padding with zeros.\n5.  **Solve for Enthalpy Rise**: Compute the matrix exponential $e^{\\mathbf{B}L}$ using a reliable numerical library function (e.g., `scipy.linalg.expm`). Extract the outlet enthalpy rise vector $\\mathbf{\\Delta h}$ from the last column of the resulting matrix (first $N$ rows).\n6.  **Calculate CV**:\n    a. Compute the mean of the enthalpy rises: $\\mu_{\\Delta h} = \\frac{1}{N} \\sum_{i=0}^{N-1} \\Delta h_i$.\n    b. Compute the population standard deviation: $\\sigma_{\\Delta h} = \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} (\\Delta h_i - \\mu_{\\Delta h})^2}$.\n    c. Calculate the coefficient of variation: $\\text{CV} = \\frac{\\sigma_{\\Delta h}}{\\mu_{\\Delta h}}$. Handle the case $\\mu_{\\Delta h}=0$ to avoid division by zero, though it is not expected with the given problem physics.\n7.  **Return Result**: The computed value of $\\text{CV}$ is the result for the case.\n\nThis procedure will be implemented and applied to each of the four test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to solve the subchannel thermal-hydraulics problem for all test cases.\n    \"\"\"\n\n    # Inlet enthalpy, not required for CV calculation but given in the problem.\n    # h_in = 1.0e5\n\n    # Define the neighbor pairs for the 4-subchannel 2x2 grid.\n    # This corresponds to a C4 graph: 0-1-3-2-0.\n    neighbor_pairs = [(0, 1), (0, 2), (1, 3), (2, 3)]\n\n    # Test cases as defined in the problem description.\n    test_cases = [\n        # Case 1: happy path, moderate mixing and crossflow, asymmetric heating\n        {\n            \"L\": 4.0,\n            \"m\": np.array([0.25, 0.25, 0.25, 0.25]),\n            \"P\": np.array([0.10, 0.10, 0.10, 0.10]),\n            \"q_double_prime\": np.array([100000, 100000, 120000, 100000]),\n            \"beta_val\": 0.8,\n            \"f_val\": 0.02,\n        },\n        # Case 2: edge case, no mixing and no crossflow\n        {\n            \"L\": 4.0,\n            \"m\": np.array([0.25, 0.25, 0.25, 0.25]),\n            \"P\": np.array([0.10, 0.10, 0.10, 0.10]),\n            \"q_double_prime\": np.array([100000, 100000, 120000, 100000]),\n            \"beta_val\": 0.0,\n            \"f_val\": 0.0,\n        },\n        # Case 3: strong mixing and crossflow, heterogeneous mass flows\n        {\n            \"L\": 4.0,\n            \"m\": np.array([0.22, 0.30, 0.26, 0.27]),\n            \"P\": np.array([0.10, 0.10, 0.10, 0.10]),\n            \"q_double_prime\": np.array([100000, 100000, 120000, 100000]),\n            \"beta_val\": 5.0,\n            \"f_val\": 0.10,\n        },\n        # Case 4: boundary case, equal heating\n        {\n            \"L\": 4.0,\n            \"m\": np.array([0.25, 0.25, 0.25, 0.25]),\n            \"P\": np.array([0.10, 0.10, 0.10, 0.10]),\n            \"q_double_prime\": np.array([110000, 110000, 110000, 110000]),\n            \"beta_val\": 1.5,\n            \"f_val\": 0.05,\n        },\n    ]\n\n    def solve_case(params, neighbors):\n        \"\"\"\n        Solves a single case for the coefficient of variation (CV).\n        \"\"\"\n        N = 4  # Number of subchannels\n        L = params[\"L\"]\n        m = params[\"m\"]\n        P = params[\"P\"]\n        q_pp = params[\"q_double_prime\"]\n        beta_val = params[\"beta_val\"]\n        f_val = params[\"f_val\"]\n\n        # 1. Calculate the source vector s\n        s = (q_pp * P) / m\n\n        # 2. Construct the A matrix\n        A = np.zeros((N, N))\n        \n        # Build adjacency list from pairs\n        adj = [[] for _ in range(N)]\n        for i, j in neighbors:\n            adj[i].append(j)\n            adj[j].append(i)\n\n        for i in range(N):\n            row_sum = 0\n            for j in adj[i]:\n                # Off-diagonal elements\n                val = beta_val + f_val / m[i]\n                A[i, j] = val\n                row_sum += val\n            # Diagonal elements\n            A[i, i] = -row_sum\n\n        # 3. Construct the augmented B matrix\n        B = np.zeros((N + 1, N + 1))\n        B[:N, :N] = A\n        B[:N, N] = s\n        \n        # 4. Compute the matrix exponential\n        exp_BL = expm(B * L)\n\n        # 5. Extract the enthalpy rise vector delta_h\n        delta_h = exp_BL[:N, N]\n\n        # 6. Calculate the coefficient of variation (CV)\n        mu_delta_h = np.mean(delta_h)\n        if mu_delta_h == 0:\n            return 0.0 # Avoid division by zero if all rises are zero\n            \n        sigma_delta_h = np.std(delta_h) # Population std dev (ddof=0)\n        \n        cv = sigma_delta_h / mu_delta_h\n        return cv\n\n    results = []\n    for case in test_cases:\n        cv_result = solve_case(case, neighbor_pairs)\n        results.append(cv_result)\n\n    # Format the final output as specified.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The final and most critical step in the simulation workflow is validation: determining if the model's predictions are a faithful representation of physical reality. This exercise introduces a rigorous statistical method for comparing simulation outputs with experimental data, moving beyond simple qualitative agreement . You will derive and apply the chi-square ($\\chi^2$) statistic, a powerful goodness-of-fit metric that quantifies the discrepancy between model and measurement while properly accounting for correlated experimental uncertainties.",
            "id": "4253163",
            "problem": "A rod bundle within a pressurized water reactor core is instrumented to measure coolant subchannel outlet temperatures. Computational Fluid Dynamics (CFD) simulations provide predicted temperatures for a subset of $N$ subchannels. The experiment provides corresponding measured temperatures and quantified uncertainties. Assume the measurement errors are jointly Gaussian, with independent random components for each subchannel and a common calibration systematic affecting all subchannels equally. Let the CFD predictions be $\\mathbf{T}^{\\mathrm{CFD}} \\in \\mathbb{R}^{N}$, the experimental measurements be $\\mathbf{T}^{\\mathrm{exp}} \\in \\mathbb{R}^{N}$, the independent standard uncertainties be $\\sigma_{i}$ for subchannel $i$, and the common systematic standard uncertainty be $s_{\\mathrm{sys}}$. The covariance matrix of the measurement errors is $\\boldsymbol{\\Sigma} = \\mathbf{D} + s_{\\mathrm{sys}}^{2} \\mathbf{1}\\mathbf{1}^{\\top}$, where $\\mathbf{D} = \\mathrm{diag}(\\sigma_{1}^{2}, \\dots, \\sigma_{N}^{2})$ and $\\mathbf{1}$ is the column vector of ones.\n\nStarting from the multivariate Gaussian likelihood for the measurement errors, derive a dimensionless goodness-of-fit validation metric based on the chi-square statistic that accounts for the correlated uncertainties induced by the common systematic. Then evaluate this metric for the following four subchannels ($N = 4$), where temperatures are in kelvin: \n- $\\mathbf{T}^{\\mathrm{CFD}} = \\left[591.0,\\, 592.6,\\, 599.0,\\, 600.7\\right]$,\n- $\\mathbf{T}^{\\mathrm{exp}} = \\left[590.2,\\, 593.5,\\, 598.1,\\, 601.3\\right]$,\n- $\\boldsymbol{\\sigma} = \\left[0.5,\\, 0.7,\\, 0.6,\\, 0.5\\right]$,\n- $s_{\\mathrm{sys}} = 0.4$.\n\nUse the reduced chi-square, defined as the chi-square divided by the number of degrees of freedom, with the degrees of freedom taken as $N$ because no model parameters are fitted in this comparison. Report the reduced chi-square and round your answer to four significant figures. Express your final answer as a dimensionless number.",
            "solution": "The problem statement is deemed valid. It is scientifically grounded in standard statistical methods for model validation, well-posed with all necessary information provided, and objective in its language. The task is to derive a goodness-of-fit statistic for data with correlated uncertainties and then apply it to a specific dataset.\n\nFirst, we derive the chi-square ($\\chi^2$) statistic. The problem states that the measurement errors are jointly Gaussian. Let the vector of differences between the experimental measurements and the CFD predictions be $\\mathbf{d} = \\mathbf{T}^{\\mathrm{exp}} - \\mathbf{T}^{\\mathrm{CFD}}$. Under the null hypothesis that the CFD model perfectly represents the true temperatures, the vector $\\mathbf{d}$ represents the measurement error. The probability density function for $\\mathbf{d}$ is given by the multivariate Gaussian distribution:\n$$\nP(\\mathbf{d} | \\boldsymbol{\\Sigma}) = \\frac{1}{\\sqrt{(2\\pi)^{N} \\det(\\boldsymbol{\\Sigma})}} \\exp\\left(-\\frac{1}{2} \\mathbf{d}^{\\top} \\boldsymbol{\\Sigma}^{-1} \\mathbf{d}\\right)\n$$\nThe $\\chi^2$ statistic is defined as the term in the exponent:\n$$\n\\chi^2 = \\mathbf{d}^{\\top} \\boldsymbol{\\Sigma}^{-1} \\mathbf{d}\n$$\nThe core of the derivation is finding the inverse of the covariance matrix $\\boldsymbol{\\Sigma}$. The given covariance matrix is $\\boldsymbol{\\Sigma} = \\mathbf{D} + s_{\\mathrm{sys}}^{2} \\mathbf{1}\\mathbf{1}^{\\top}$, where $\\mathbf{D} = \\mathrm{diag}(\\sigma_{1}^{2}, \\dots, \\sigma_{N}^{2})$ and $\\mathbf{1}$ is a column vector of ones. This form, a diagonal matrix plus a rank-one update, allows for the application of the Sherman-Morrison formula:\n$$\n(\\mathbf{A} + \\mathbf{u}\\mathbf{v}^{\\top})^{-1} = \\mathbf{A}^{-1} - \\frac{\\mathbf{A}^{-1}\\mathbf{u}\\mathbf{v}^{\\top}\\mathbf{A}^{-1}}{1 + \\mathbf{v}^{\\top}\\mathbf{A}^{-1}\\mathbf{u}}\n$$\nIn our case, we identify $\\mathbf{A} = \\mathbf{D}$, $\\mathbf{u} = s_{\\mathrm{sys}} \\mathbf{1}$, and $\\mathbf{v} = s_{\\mathrm{sys}} \\mathbf{1}$. The inverse of $\\mathbf{D}$ is simply $\\mathbf{D}^{-1} = \\mathrm{diag}(1/\\sigma_{1}^{2}, \\dots, 1/\\sigma_{N}^{2})$. We substitute these into the formula:\n$$\n\\boldsymbol{\\Sigma}^{-1} = \\mathbf{D}^{-1} - \\frac{\\mathbf{D}^{-1}(s_{\\mathrm{sys}}\\mathbf{1})(s_{\\mathrm{sys}}\\mathbf{1}^{\\top})\\mathbf{D}^{-1}}{1 + (s_{\\mathrm{sys}}\\mathbf{1}^{\\top})\\mathbf{D}^{-1}(s_{\\mathrm{sys}}\\mathbf{1})} = \\mathbf{D}^{-1} - \\frac{s_{\\mathrm{sys}}^{2} (\\mathbf{D}^{-1}\\mathbf{1})(\\mathbf{1}^{\\top}\\mathbf{D}^{-1})}{1 + s_{\\mathrm{sys}}^{2} (\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{1})}\n$$\nNow we substitute this expression for $\\boldsymbol{\\Sigma}^{-1}$ into the formula for $\\chi^2$:\n$$\n\\chi^2 = \\mathbf{d}^{\\top} \\left( \\mathbf{D}^{-1} - \\frac{s_{\\mathrm{sys}}^{2} (\\mathbf{D}^{-1}\\mathbf{1})(\\mathbf{1}^{\\top}\\mathbf{D}^{-1})}{1 + s_{\\mathrm{sys}}^{2} (\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{1})} \\right) \\mathbf{d}\n$$\n$$\n\\chi^2 = \\mathbf{d}^{\\top}\\mathbf{D}^{-1}\\mathbf{d} - \\frac{s_{\\mathrm{sys}}^{2} (\\mathbf{d}^{\\top}\\mathbf{D}^{-1}\\mathbf{1})(\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{d})}{1 + s_{\\mathrm{sys}}^{2} (\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{1})}\n$$\nLet's express the matrix products in terms of summations. Let $d_i$ be the $i$-th component of $\\mathbf{d}$.\n- $\\mathbf{d}^{\\top}\\mathbf{D}^{-1}\\mathbf{d} = \\sum_{i=1}^{N} \\frac{d_i^2}{\\sigma_i^2}$\n- $\\mathbf{d}^{\\top}\\mathbf{D}^{-1}\\mathbf{1} = \\sum_{i=1}^{N} \\frac{d_i}{\\sigma_i^2}$\n- $\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{d} = \\sum_{i=1}^{N} \\frac{d_i}{\\sigma_i^2}$\n- $\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{1} = \\sum_{j=1}^{N} \\frac{1}{\\sigma_j^2}$\nThe derived expression for the $\\chi^2$ statistic is therefore:\n$$\n\\chi^2 = \\sum_{i=1}^{N} \\frac{d_i^2}{\\sigma_i^2} - \\frac{s_{\\mathrm{sys}}^2 \\left(\\sum_{i=1}^{N} \\frac{d_i}{\\sigma_i^2}\\right)^2}{1 + s_{\\mathrm{sys}}^2 \\sum_{j=1}^{N} \\frac{1}{\\sigma_j^2}}\n$$\nThis is the required dimensionless goodness-of-fit validation metric.\n\nNext, we evaluate this metric for the given data.\nThe number of subchannels is $N=4$. The data vectors are:\n- $\\mathbf{T}^{\\mathrm{CFD}} = \\left[591.0,\\, 592.6,\\, 599.0,\\, 600.7\\right]$\n- $\\mathbf{T}^{\\mathrm{exp}} = \\left[590.2,\\, 593.5,\\, 598.1,\\, 601.3\\right]$\n- $\\boldsymbol{\\sigma} = \\left[0.5,\\, 0.7,\\, 0.6,\\, 0.5\\right]$\n- $s_{\\mathrm{sys}} = 0.4$\n\nFirst, compute the vector of differences $\\mathbf{d} = \\mathbf{T}^{\\mathrm{exp}} - \\mathbf{T}^{\\mathrm{CFD}}$:\n- $d_1 = 590.2 - 591.0 = -0.8$\n- $d_2 = 593.5 - 592.6 = 0.9$\n- $d_3 = 598.1 - 599.0 = -0.9$\n- $d_4 = 601.3 - 600.7 = 0.6$\n\nNext, we calculate the required sums. The variances are $\\sigma_1^2=0.25$, $\\sigma_2^2=0.49$, $\\sigma_3^2=0.36$, $\\sigma_4^2=0.25$, and $s_{\\mathrm{sys}}^2=0.16$.\n\n1.  Calculate $\\sum_{i=1}^{N} \\frac{d_i^2}{\\sigma_i^2}$:\n    $$\n    \\sum_{i=1}^{4} \\frac{d_i^2}{\\sigma_i^2} = \\frac{(-0.8)^2}{0.5^2} + \\frac{0.9^2}{0.7^2} + \\frac{(-0.9)^2}{0.6^2} + \\frac{0.6^2}{0.5^2} = \\frac{0.64}{0.25} + \\frac{0.81}{0.49} + \\frac{0.81}{0.36} + \\frac{0.36}{0.25}\n    $$\n    $$\n    = 2.56 + 1.653061... + 2.25 + 1.44 = 7.903061...\n    $$\n\n2.  Calculate $\\sum_{i=1}^{N} \\frac{d_i}{\\sigma_i^2}$:\n    $$\n    \\sum_{i=1}^{4} \\frac{d_i}{\\sigma_i^2} = \\frac{-0.8}{0.25} + \\frac{0.9}{0.49} + \\frac{-0.9}{0.36} + \\frac{0.6}{0.25} = -3.2 + 1.836734... - 2.5 + 2.4 = -1.463265...\n    $$\n\n3.  Calculate $\\sum_{j=1}^{N} \\frac{1}{\\sigma_j^2}$:\n    $$\n    \\sum_{j=1}^{4} \\frac{1}{\\sigma_j^2} = \\frac{1}{0.25} + \\frac{1}{0.49} + \\frac{1}{0.36} + \\frac{1}{0.25} = 4.0 + 2.040816... + 2.777777... + 4.0 = 12.818594...\n    $$\n\nNow, substitute these sums into the $\\chi^2$ formula:\n$$\n\\chi^2 = 7.903061... - \\frac{(0.4)^2 \\times (-1.463265...)^2}{1 + (0.4)^2 \\times 12.818594...}\n$$\n$$\n\\chi^2 = 7.903061... - \\frac{0.16 \\times 2.141157...}{1 + 0.16 \\times 12.818594...}\n$$\n$$\n\\chi^2 = 7.903061... - \\frac{0.342585...}{1 + 2.050975...} = 7.903061... - \\frac{0.342585...}{3.050975...}\n$$\n$$\n\\chi^2 = 7.903061... - 0.112287... = 7.790774...\n$$\nThe problem asks for the reduced chi-square, $\\chi^2_{\\mathrm{red}}$, with the number of degrees of freedom $\\nu = N = 4$.\n$$\n\\chi^2_{\\mathrm{red}} = \\frac{\\chi^2}{\\nu} = \\frac{7.790774...}{4} = 1.947693...\n$$\nRounding the result to four significant figures gives $1.948$.",
            "answer": "$$\\boxed{1.948}$$"
        }
    ]
}