{
    "hands_on_practices": [
        {
            "introduction": "对反应堆堆芯的精确计算流体动力学（CFD）模拟，取决于能否正确模拟燃料棒附近的湍流。无量纲壁面距离 $y^+$ 是一个关键参数，它决定了壁面处所需的网格分辨率。本练习将通过动手实践，从基本原理出发推导并计算所需的第一层网格单元高度，这是在使用壁面函数或低雷诺数湍流模型建立可靠CFD模拟时的一项关键技能。",
            "id": "4253215",
            "problem": "一个核反应堆棒束子通道使用计算流体动力学（CFD）进行建模。必须选择合适的近壁面网格分辨率，以便通过壁面函数法或解析粘性子层的低雷诺数法来恰当捕捉壁面束缚湍流。从基本定义和经过充分检验的关联式出发，推导连接到第一个单元中心的壁面法向距离、无量纲壁面坐标和流动特性之间的普适关系。然后，使用以下压水堆（PWR）子通道的物理真实堆芯热工水力条件，计算两种方法所需的第一个单元中心距离：\n- 冷却剂为高压液态水，建模为牛顿流体，其密度 $\\rho = 700\\,\\mathrm{kg/m^3}$，动力粘度 $\\mu = 1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s}$。\n- 流动在水力直径为 $D_{h} = 9.0\\times 10^{-3}\\,\\mathrm{m}$ 的光滑壁面子通道中是充分发展的湍流。\n- 质量通量为 $G = 3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}$。\n- 使用 Petukhov 关联式计算光滑管中的 Darcy–Weisbach 摩擦因子：$f = \\left(0.79\\,\\ln(\\mathrm{Re}) - 1.64\\right)^{-2}$，其中雷诺数 $\\mathrm{Re} = \\dfrac{G\\,D_{h}}{\\mu}$。\n\n您必须从基本原理出发：\n- 使用无量纲壁面坐标 $y^{+}$ 的定义。\n- 使用以壁面剪切应力和 Darcy 摩擦因子表示的摩擦速度定义。\n- 对于充分发展的内部湍流，使用壁面剪切应力与 Darcy 摩擦因子之间的关系。\n\n对于壁面函数法，将第一个单元中心的目标位置设在 $y^{+} = 30$。对于低雷诺数法，将第一个单元中心的目标位置设在 $y^{+} = 1$。以微米为单位表示两种方法所需的第一个单元中心距离，并将您的答案四舍五入至三位有效数字。最终答案必须是计算结果，并仅包含所要求的两个值，以行矩阵的形式排列。",
            "solution": "问题陈述已经过验证，被认定为具有科学依据、提法得当、客观且自洽。它展示了应用于核反应堆热工水力学领域的计算流体动力学（CFD）中的一个标准工程计算。所有提供的数据在指定条件下都是物理真实的，所要求的任务清晰且可解。现进行求解。\n\n目标是推导从壁面到第一个单元中心的距离 $y_p$ 作为无量纲壁面坐标 $y^{+}$ 和其他流动特性的函数关系式，然后针对两个目标 $y^{+}$ 值计算 $y_p$。\n\n推导从无量纲壁面坐标 $y^{+}$ 的定义开始：\n$$y^{+} = \\frac{y_p u_{\\tau}}{\\nu}$$\n其中 $y_p$ 是从壁面到第一个单元中心的有量纲距离，$u_{\\tau}$ 是摩擦速度，$\\nu$ 是流体的运动粘度。\n\n摩擦速度 $u_{\\tau}$ 由壁面剪切应力 $\\tau_w$ 和流体密度 $\\rho$ 定义：\n$$u_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}$$\n运动粘度 $\\nu$ 是动力粘度 $\\mu$ 与密度 $\\rho$ 的比值：\n$$\\nu = \\frac{\\mu}{\\rho}$$\n对于通道或管道中的充分发展湍流，壁面剪切应力 $\\tau_w$ 与主流体速度 $u_b$ 和 Darcy–Weisbach 摩擦因子 $f$ 的关系由以下方程给出：\n$$\\tau_w = \\frac{1}{8} f \\rho u_b^2$$\n问题给出了质量通量 $G$，它与主流速度和密度的关系为 $G = \\rho u_b$。因此，主流速度可以表示为 $u_b = G/\\rho$。将此代入 $\\tau_w$ 的表达式中：\n$$\\tau_w = \\frac{1}{8} f \\rho \\left(\\frac{G}{\\rho}\\right)^2 = \\frac{f G^2}{8\\rho}$$\n现在，我们可以根据给定参数推导摩擦速度 $u_{\\tau}$ 的表达式：\n$$u_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}} = \\sqrt{\\frac{1}{\\rho} \\left(\\frac{f G^2}{8\\rho}\\right)} = \\sqrt{\\frac{f G^2}{8\\rho^2}} = \\frac{G}{\\rho} \\sqrt{\\frac{f}{8}}$$\n接下来，我们将 $u_{\\tau}$ 和 $\\nu$ 的表达式代回 $y^{+}$ 的定义中：\n$$y^{+} = \\frac{y_p u_{\\tau}}{\\nu} = \\frac{y_p \\left(\\frac{G}{\\rho} \\sqrt{\\frac{f}{8}}\\right)}{\\mu/\\rho}$$\n密度 $\\rho$ 被消去，得到：\n$$y^{+} = \\frac{y_p G}{\\mu} \\sqrt{\\frac{f}{8}}$$\n最后，我们重排此方程以求解第一个单元中心的距离 $y_p$。这就提供了所需的普适关系：\n$$y_p = \\frac{y^{+} \\mu}{G} \\sqrt{\\frac{8}{f}}$$\n利用这个推导出的关系式，我们进行数值计算。给定参数如下：\n- 密度：$\\rho = 700\\,\\mathrm{kg/m^3}$\n- 动力粘度：$\\mu = 1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s}$\n- 水力直径：$D_{h} = 9.0\\times 10^{-3}\\,\\mathrm{m}$\n- 质量通量：$G = 3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}$\n\n首先，我们计算雷诺数 $\\mathrm{Re}$，以确定摩擦因子 $f$：\n$$\\mathrm{Re} = \\frac{G D_{h}}{\\mu} = \\frac{(3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}) \\times (9.0\\times 10^{-3}\\,\\mathrm{m})}{1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s}} = 270000$$\n由于 $\\mathrm{Re} \\gg 4000$，流动是高度湍流的。\n\n接下来，我们使用所提供的 Petukhov 关联式来计算摩擦因子 $f$：\n$$f = \\left(0.79\\,\\ln(\\mathrm{Re}) - 1.64\\right)^{-2}$$\n代入 $\\mathrm{Re}$ 的值：\n$$f = \\left(0.79\\,\\ln(270000) - 1.64\\right)^{-2}$$\n$$\\ln(270000) \\approx 12.506176$$\n$$f \\approx \\left(0.79 \\times 12.506176 - 1.64\\right)^{-2} = \\left(9.879879 - 1.64\\right)^{-2} = (8.239879)^{-2} \\approx 0.0147285$$\n现在我们可以计算两种指定情况下所需的第一个单元中心距离 $y_p$。\n\n情况 1：壁面函数法，目标 $y^{+} = 30$。\n$$y_{p, wf} = \\frac{30 \\times (1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s})}{3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}} \\sqrt{\\frac{8}{0.0147285}}$$\n$$y_{p, wf} = (1.0\\times 10^{-6}\\,\\mathrm{m}) \\times \\sqrt{543.160} \\approx (1.0\\times 10^{-6}\\,\\mathrm{m}) \\times 23.3058$$\n$$y_{p, wf} \\approx 2.33058\\times 10^{-5}\\,\\mathrm{m}$$\n转换为微米（$1\\,\\mathrm{m} = 10^6\\,\\mu\\mathrm{m}$）：\n$$y_{p, wf} \\approx 23.3058\\,\\mu\\mathrm{m}$$\n四舍五入到三位有效数字，壁面函数法所需的距离为 $23.3\\,\\mu\\mathrm{m}$。\n\n情况 2：低雷诺数法，目标 $y^{+} = 1$。\n$$y_{p, \\text{low-Re}} = \\frac{1 \\times (1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s})}{3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}} \\sqrt{\\frac{8}{0.0147285}}$$\n$$y_{p, \\text{low-Re}} = \\frac{1}{30} \\times y_{p, wf} \\approx \\frac{23.3058\\,\\mu\\mathrm{m}}{30} \\approx 0.77686\\,\\mu\\mathrm{m}$$\n四舍五入到三位有效数字，低雷诺数法所需的距离为 $0.777\\,\\mu\\mathrm{m}$。\n\n计算出的两个距离分别是：壁面函数法（$y^+=30$）为 $23.3\\,\\mu\\mathrm{m}$，低雷诺数法（$y^+=1$）为 $0.777\\,\\mu\\mathrm{m}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n23.3  0.777\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理解燃料棒内的温度分布对于确保反应堆的安全和性能至关重要。这涉及求解一个共轭传热（CHT）问题，即热量在燃料中产生，通过包壳传导，并最终以对流方式传递到冷却剂中。本练习将指导您完成温度剖面的解析推导，将燃料的内部生热与冷却剂的整体温度联系起来，从而巩固基本传热原理在真实核工程背景下的应用。",
            "id": "4253226",
            "problem": "在核反应堆堆芯中，单根燃料棒被建模为一个轴对称圆柱体，由固体燃料区和固体包壳区组成，并被流动的冷却剂包围。您需要应用共轭传热（CHT）和物理上正确的界面条件，来计算指定情景下燃料棒出口处的燃料中心线温度。\n\n假设和几何结构：\n- 燃料是一个半径为 $R_f$ 的实心圆柱体，其导热系数 $k_f$ 为常数。\n- 包壳是一个空心圆柱体，内半径等于 $R_f$，外半径为 $R_{co}$，其导热系数 $k_c$ 为常数。\n- 冷却剂被建模为沿轴向 $x \\in [0,L]$ 的一维集总流动，其质量流量 $\\dot{m}$ 和比热容 $c_p$ 为常数；包壳外表面的对流换热系数为 $h$，入口集总温度为 $T_{b,\\mathrm{in}}$。\n- 燃料中的体积热生成率在径向上呈空间变化，对于 $0 \\le r \\le R_f$，其表达式为 $q'''(r) = q_0 \\left[1 + a \\left(\\frac{r}{R_f}\\right)^2\\right]$；对于 $R_f  r \\le R_{co}$，则 $q'''(r)=0$。\n- 问题为稳态、轴对称，并忽略轴向热传导和热辐射。\n\n控制方程：\n- 在燃料区 ($0 \\le r \\le R_f$)：圆柱坐标系下的稳态径向能量方程为\n$$\n\\frac{1}{r}\\frac{d}{dr}\\left(k_f r \\frac{dT}{dr}\\right) + q'''(r) = 0.\n$$\n- 在包壳区 ($R_f \\le r \\le R_{co}$)：稳态径向能量方程为\n$$\n\\frac{1}{r}\\frac{d}{dr}\\left(k_c r \\frac{dT}{dr}\\right) = 0.\n$$\n- 边界与界面条件：\n  1. 中心线对称性：$\\left.\\frac{dT}{dr}\\right|_{r=0} = 0$。\n  2. 在 $r=R_f$ 处温度连续：$T_f(R_f) = T_c(R_f)$。\n  3. 在 $r=R_f$ 处法向热通量连续：$k_f \\left.\\frac{dT_f}{dr}\\right|_{r=R_f} = k_c \\left.\\frac{dT_c}{dr}\\right|_{r=R_f}$。\n  4. 包壳外表面的对流边界：$-k_c \\left.\\frac{dT_c}{dr}\\right|_{r=R_{co}} = h\\left[T_c(R_{co}) - T_b(x)\\right]$。\n- 沿 $x$ 方向的冷却剂集总能量平衡：\n$$\n\\frac{dT_b}{dx} = \\frac{Q'}{\\dot{m} c_p}, \\qquad Q' = \\int_0^{R_f} q'''(r) 2\\pi r \\, dr,\n$$\n入口条件为 $T_b(0)=T_{b,\\mathrm{in}}$。\n\n任务：\n1. 从控制方程和边界/界面条件出发，推导燃料中心线温度 $T_f(0;x)$ 的解析表达式，该表达式应以冷却剂集总温度 $T_b(x)$ 和参数 $\\{q_0,a,R_f,R_{co},k_f,k_c,h\\}$ 表示。\n2. 使用集总能量平衡计算燃料棒出口处的 $T_b(L)$，并评估相应的中心线温度 $T_f(0;L)$。\n\n单位和输出要求：\n- 所有温度必须以开尔文（Kelvin）表示，最终报告的值必须四舍五入至三位小数。\n- 您的程序必须为以下三个测试案例中的每一个计算出口燃料中心线温度，并生成一行输出，其中包含一个用逗号分隔并用方括号括起来的结果列表，顺序与下面列出的案例相同。\n\n测试套件（所有量均为国际单位制）：\n- 案例1（代表性压水堆子通道工况）：\n  - $R_f = 0.004\\,\\mathrm{m}$，$R_{co} = 0.00475\\,\\mathrm{m}$，$k_f = 3.0\\,\\mathrm{W/(m\\cdot K)}$，$k_c = 16.0\\,\\mathrm{W/(m\\cdot K)}$，$h = 20000.0\\,\\mathrm{W/(m^2\\cdot K)}$\n  - $q_0 = 3.5\\times 10^8\\,\\mathrm{W/m^3}$，$a = 0.3$，$L = 4.0\\,\\mathrm{m}$，$\\dot{m} = 0.25\\,\\mathrm{kg/s}$，$c_p = 4200.0\\,\\mathrm{J/(kg\\cdot K)}$，$T_{b,\\mathrm{in}} = 580.0\\,\\mathrm{K}$\n- 案例2（极高对流极限和内向功率峰值）：\n  - $R_f = 0.004\\,\\mathrm{m}$，$R_{co} = 0.00475\\,\\mathrm{m}$，$k_f = 3.0\\,\\mathrm{W/(m\\cdot K)}$，$k_c = 16.0\\,\\mathrm{W/(m\\cdot K)}$，$h = 1.0\\times 10^6\\,\\mathrm{W/(m^2\\cdot K)}$\n  - $q_0 = 1.2\\times 10^8\\,\\mathrm{W/m^3}$，$a = -0.5$，$L = 2.0\\,\\mathrm{m}$，$\\dot{m} = 0.10\\,\\mathrm{kg/s}$，$c_p = 4200.0\\,\\mathrm{J/(kg\\cdot K)}$，$T_{b,\\mathrm{in}} = 570.0\\,\\mathrm{K}$\n- 案例3（低燃料导热系数，较厚热负荷）：\n  - $R_f = 0.004\\,\\mathrm{m}$，$R_{co} = 0.0046\\,\\mathrm{m}$，$k_f = 1.5\\,\\mathrm{W/(m\\cdot K)}$，$k_c = 16.0\\,\\mathrm{W/(m\\cdot K)}$，$h = 15000.0\\,\\mathrm{W/(m^2\\cdot K)}$\n  - $q_0 = 5.0\\times 10^8\\,\\mathrm{W/m^3}$，$a = 0.0$，$L = 3.5\\,\\mathrm{m}$，$\\dot{m} = 0.20\\,\\mathrm{kg/s}$，$c_p = 4200.0\\,\\mathrm{J/(kg\\cdot K)}$，$T_{b,\\mathrm{in}} = 565.0\\,\\mathrm{K}$\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含案例1、2和3的出口中心线温度（单位：开尔文），四舍五入至三位小数，格式为用逗号分隔并用方括号括起来的列表，例如 $[T_1,T_2,T_3]$。",
            "solution": "在尝试任何解答之前，需对用户提供的问题陈述进行验证。\n\n### 第一步：提取已知条件\n\n**几何结构与材料：**\n- 燃料区：实心圆柱体，半径 $R_f$，导热系数 $k_f$ 为常数。\n- 包壳区：空心圆柱体，内半径 $R_f$，外半径 $R_{co}$，导热系数 $k_c$ 为常数。\n- 冷却剂：沿轴向 $x \\in [0,L]$ 的一维集总流动，质量流量 $\\dot{m}$ 为常数，比热容 $c_p$ 为常数。\n- 包壳外表面的对流换热系数：$h$。\n- 入口冷却剂集总温度：$T_{b,\\mathrm{in}}$。\n\n**热生成：**\n- 燃料中的体积热生成率 ($0 \\le r \\le R_f$)：$q'''(r) = q_0 \\left[1 + a \\left(\\frac{r}{R_f}\\right)^2\\right]$。\n- 包壳中无热生成 ($R_f  r \\le R_{co}$): $q'''(r) = 0$。\n\n**假设：**\n- 稳态。\n- 轴对称。\n- 忽略轴向热传导。\n- 忽略热辐射。\n\n**控制方程：**\n- 燃料区 ($0 \\le r \\le R_f$)：$\\frac{1}{r}\\frac{d}{dr}\\left(k_f r \\frac{dT}{dr}\\right) + q'''(r) = 0$。\n- 包壳区 ($R_f \\le r \\le R_{co}$)：$\\frac{1}{r}\\frac{d}{dr}\\left(k_c r \\frac{dT}{dr}\\right) = 0$。\n- 冷却剂 ($x \\in [0,L]$)：$\\frac{dT_b}{dx} = \\frac{Q'}{\\dot{m} c_p}$，其中 $Q' = \\int_0^{R_f} q'''(r) 2\\pi r \\, dr$。\n\n**边界与界面条件：**\n1. 中心线对称性：$\\left.\\frac{dT}{dr}\\right|_{r=0} = 0$。\n2. 燃料-包壳界面温度连续：$T_f(R_f) = T_c(R_f)$。\n3. 燃料-包壳界面热通量连续：$k_f \\left.\\frac{dT_f}{dr}\\right|_{r=R_f} = k_c \\left.\\frac{dT_c}{dr}\\right|_{r=R_f}$。\n4. 包壳-冷却剂界面对流：$-k_c \\left.\\frac{dT_c}{dr}\\right|_{r=R_{co}} = h\\left[T_c(R_{co}) - T_b(x)\\right]$。\n5. 冷却剂入口条件：$T_b(0)=T_{b,\\mathrm{in}}$。\n\n**任务：**\n1. 推导 $T_f(0;x)$ 关于 $T_b(x)$ 和参数的解析表达式。\n2. 计算 $T_b(L)$ 并随后计算 $T_f(0;L)$。\n\n**测试案例（国际单位制）：**\n- 案例1：$R_f = 0.004$, $R_{co} = 0.00475$, $k_f = 3.0$, $k_c = 16.0$, $h = 20000.0$, $q_0 = 3.5\\times 10^8$, $a = 0.3$, $L = 4.0$, $\\dot{m} = 0.25$, $c_p = 4200.0$, $T_{b,\\mathrm{in}} = 580.0$。\n- 案例2：$R_f = 0.004$, $R_{co} = 0.00475$, $k_f = 3.0$, $k_c = 16.0$, $h = 1.0\\times 10^6$, $q_0 = 1.2\\times 10^8$, $a = -0.5$, $L = 2.0$, $\\dot{m} = 0.10$, $c_p = 4200.0$, $T_{b,\\mathrm{in}} = 570.0$。\n- 案例3：$R_f = 0.004$, $R_{co} = 0.0046$, $k_f = 1.5$, $k_c = 16.0$, $h = 15000.0$, $q_0 = 5.0\\times 10^8$, $a = 0.0$, $L = 3.5$, $\\dot{m} = 0.20$, $c_p = 4200.0$, $T_{b,\\mathrm{in}} = 565.0$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据，采用了圆柱坐标系下的一维热传导方程和冷却剂的集总能量平衡，这些都是传热学的基本原理。边界和界面条件（对称性、温度和热通量的连续性、对流）在物理上是正确的，并且是共轭传热问题的标准条件。该问题是适定的，提供了所有必要的参数和一组明确的任务，可以导出一个唯一的解。语言客观精确，没有歧义。所有数据均以一致的国际单位制提供。该问题是自洽且无矛盾的。\n\n### 第三步：结论与行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n---\n\n求解过程首先推导径向温度分布，然后求解冷却剂的轴向温升。\n\n**第一部分：径向温度分布**\n\n目标是找到在任意轴向位置 $x$ 处，燃料中心线温度 $T_f(0; x)$ 与冷却剂集总温度 $T_b(x)$ 之间的温差。这个温差是燃料、包壳和对流膜上的温降之和：\n$$\nT_f(0; x) - T_b(x) = \\left[T_f(0) - T_f(R_f)\\right] + \\left[T_c(R_f) - T_c(R_{co})\\right] + \\left[T_c(R_{co}) - T_b(x)\\right]\n$$\n请注意，根据界面条件2，$T_f(R_f) = T_c(R_f)$。\n\n**1a：燃料内的温降, $\\Delta T_{fuel} = T_f(0) - T_f(R_f)$**\n燃料中的能量方程为：\n$$\n\\frac{d}{dr}\\left(r \\frac{dT_f}{dr}\\right) = -\\frac{r}{k_f} q'''(r) = -\\frac{r}{k_f} q_0 \\left[1 + a \\left(\\frac{r}{R_f}\\right)^2\\right] = -\\frac{q_0}{k_f} \\left(r + \\frac{a}{R_f^2}r^3\\right)\n$$\n对 $r$ 进行积分：\n$$\nr \\frac{dT_f}{dr} = -\\frac{q_0}{k_f} \\left(\\frac{r^2}{2} + \\frac{a r^4}{4R_f^2}\\right) + C_1\n$$\n应用对称性条件 $\\left.\\frac{dT_f}{dr}\\right|_{r=0} = 0$。为了使梯度在 $r=0$ 处为有限值，必须有 $C_1=0$。\n$$\n\\frac{dT_f}{dr} = -\\frac{q_0}{k_f} \\left(\\frac{r}{2} + \\frac{a r^3}{4R_f^2}\\right)\n$$\n再次从 $r$ 到 $R_f$ 进行积分：\n$$\nT_f(R_f) - T_f(r) = \\int_r^{R_f} \\left[-\\frac{q_0}{k_f} \\left(\\frac{s}{2} + \\frac{a s^3}{4R_f^2}\\right)\\right] ds = -\\frac{q_0}{k_f} \\left[\\frac{s^2}{4} + \\frac{a s^4}{16R_f^2}\\right]_r^{R_f}\n$$\n$T_f(r) - T_f(R_f) = \\frac{q_0}{k_f} \\left[ \\left(\\frac{R_f^2}{4} + \\frac{a R_f^4}{16R_f^2}\\right) - \\left(\\frac{r^2}{4} + \\frac{a r^4}{16R_f^2}\\right) \\right]$。\n从中心线（$r=0$）到燃料表面（$r=R_f$）的温降为：\n$$\n\\Delta T_{fuel} = T_f(0) - T_f(R_f) = \\frac{q_0}{k_f} \\left(\\frac{R_f^2}{4} + \\frac{a R_f^2}{16}\\right) = \\frac{q_0 R_f^2}{16k_f}(4+a)\n$$\n\n**1b：单位长度总生热率, $Q'$**\n燃料中产生的热量必须通过包壳传递给冷却剂。线热功率 $Q'$ 在燃料区外相对于 $r$ 是恒定的。\n$$\nQ' = \\int_0^{R_f} q'''(r) 2\\pi r \\, dr = 2\\pi q_0 \\int_0^{R_f} \\left(r + \\frac{a}{R_f^2}r^3\\right) dr\n$$\n$$\nQ' = 2\\pi q_0 \\left[\\frac{r^2}{2} + \\frac{a r^4}{4R_f^2}\\right]_0^{R_f} = 2\\pi q_0 \\left(\\frac{R_f^2}{2} + \\frac{a R_f^2}{4}\\right) = \\pi q_0 R_f^2 \\left(1 + \\frac{a}{2}\\right)\n$$\n\n**1c：包壳内的温降, $\\Delta T_{clad} = T_c(R_f) - T_c(R_{co})$**\n包壳中的能量方程为 $\\frac{d}{dr}\\left(r \\frac{dT_c}{dr}\\right) = 0$。其通解为 $T_c(r) = C_2 \\ln(r) + C_3$。\n热通量为 $q''(r) = -k_c \\frac{dT_c}{dr} = -k_c \\frac{C_2}{r}$。单位长度的总热流为 $Q'_{clad} = 2\\pi r q''(r) = -2\\pi k_c C_2$。\n根据能量守恒，$Q'_{clad} = Q'$，所以 $C_2 = -\\frac{Q'}{2\\pi k_c}$。\n包壳上的温降为：\n$$\n\\Delta T_{clad} = T_c(R_f) - T_c(R_{co}) = \\left(-\\frac{Q'}{2\\pi k_c} \\ln(R_f) + C_3\\right) - \\left(-\\frac{Q'}{2\\pi k_c} \\ln(R_{co}) + C_3\\right)\n$$\n$$\n\\Delta T_{clad} = \\frac{Q'}{2\\pi k_c} (\\ln(R_{co}) - \\ln(R_f)) = \\frac{Q'}{2\\pi k_c} \\ln\\left(\\frac{R_{co}}{R_f}\\right)\n$$\n\n**1d：对流膜温降, $\\Delta T_{conv} = T_c(R_{co}) - T_b(x)$**\n在 $r=R_{co}$ 处的对流边界条件将热通量与温差联系起来。热通量为 $q''_{co} = \\frac{Q'}{2\\pi R_{co}}$。\n$$\nq''_{co} = h \\left[T_c(R_{co}) - T_b(x)\\right] \\implies \\frac{Q'}{2\\pi R_{co}} = h \\left[T_c(R_{co}) - T_b(x)\\right]\n$$\n求解温降：\n$$\n\\Delta T_{conv} = T_c(R_{co}) - T_b(x) = \\frac{Q'}{2\\pi R_{co} h}\n$$\n\n**1e：总径向温降**\n将各个温降相加，得到 $T_f(0;x)$ 关于 $T_b(x)$ 的表达式：\n$$\nT_f(0; x) - T_b(x) = \\Delta T_{fuel} + \\Delta T_{clad} + \\Delta T_{conv}\n$$\n$$\nT_f(0; x) = T_b(x) + \\frac{q_0 R_f^2}{16k_f}(4+a) + \\frac{Q'}{2\\pi k_c} \\ln\\left(\\frac{R_{co}}{R_f}\\right) + \\frac{Q'}{2\\pi R_{co} h}\n$$\n代入 $Q'$ 的表达式：\n$$\nT_f(0; x) = T_b(x) + \\frac{q_0 R_f^2}{16k_f}(4+a) + \\frac{\\pi q_0 R_f^2 (1 + a/2)}{2\\pi} \\left[ \\frac{1}{k_c}\\ln\\left(\\frac{R_{co}}{R_f}\\right) + \\frac{1}{R_{co} h} \\right]\n$$\n该表达式是任务1的完整解。\n\n**第二部分：冷却剂轴向温升和出口中心线温度**\n\n**2a：出口冷却剂温度, $T_b(L)$**\n冷却剂能量平衡由 $\\frac{dT_b}{dx} = \\frac{Q'}{\\dot{m} c_p}$ 给出。由于 $Q'$ 相对于 $x$ 是常数，这是一个简单的一阶常微分方程。\n从入口（$x=0$）到出口（$x=L$）进行积分：\n$$\n\\int_{T_{b,\\mathrm{in}}}^{T_b(L)} dT_b = \\int_0^L \\frac{Q'}{\\dot{m} c_p} dx \\implies T_b(L) - T_{b,\\mathrm{in}} = \\frac{Q'L}{\\dot{m} c_p}\n$$\n所以，出口集总冷却剂温度为：\n$$\nT_b(L) = T_{b,\\mathrm{in}} + \\frac{Q'L}{\\dot{m} c_p} = T_{b,\\mathrm{in}} + \\frac{\\pi q_0 R_f^2 L (1+a/2)}{\\dot{m} c_p}\n$$\n\n**2b：出口燃料中心线温度, $T_f(0;L)$**\n最后，为了求出出口处的燃料中心线温度，我们使用 $T_b(L)$ 计算第一部分1e中在 $x=L$ 处的表达式：\n$$\nT_f(0; L) = T_b(L) + \\left[ T_f(0;x) - T_b(x) \\right]\n$$\n径向温降 $\\left[ T_f(0;x) - T_b(x) \\right]$ 与 $x$ 无关，所以我们可以写成：\n$$\nT_f(0; L) = \\left( T_{b,\\mathrm{in}} + \\frac{\\pi q_0 R_f^2 L (1+a/2)}{\\dot{m} c_p} \\right) + \\frac{q_0 R_f^2}{16k_f}(4+a) + \\frac{\\pi q_0 R_f^2 (1+a/2)}{2\\pi} \\left[ \\frac{1}{k_c}\\ln\\left(\\frac{R_{co}}{R_f}\\right) + \\frac{1}{R_{co} h} \\right]\n$$\n这是用于计算的最终解析表达式。计算过程首先求出 $Q'$，然后是 $T_b(L)$，接着是总径向温降，最后将它们相加。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nuclear fuel rod heat transfer problem for the specified test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Representative PWR subchannel conditions\n        {\n            \"Rf\": 0.004, \"Rco\": 0.00475, \"kf\": 3.0, \"kc\": 16.0, \"h\": 20000.0,\n            \"q0\": 3.5e8, \"a\": 0.3, \"L\": 4.0, \"m_dot\": 0.25, \"cp\": 4200.0, \"Tb_in\": 580.0\n        },\n        # Case 2: Very high convection limit and inward-peaked power\n        {\n            \"Rf\": 0.004, \"Rco\": 0.00475, \"kf\": 3.0, \"kc\": 16.0, \"h\": 1.0e6,\n            \"q0\": 1.2e8, \"a\": -0.5, \"L\": 2.0, \"m_dot\": 0.10, \"cp\": 4200.0, \"Tb_in\": 570.0\n        },\n        # Case 3: Low fuel conductivity, thicker heat loads\n        {\n            \"Rf\": 0.004, \"Rco\": 0.0046, \"kf\": 1.5, \"kc\": 16.0, \"h\": 15000.0,\n            \"q0\": 5.0e8, \"a\": 0.0, \"L\": 3.5, \"m_dot\": 0.20, \"cp\": 4200.0, \"Tb_in\": 565.0\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        Rf, Rco = params[\"Rf\"], params[\"Rco\"]\n        kf, kc, h = params[\"kf\"], params[\"kc\"], params[\"h\"]\n        q0, a, L = params[\"q0\"], params[\"a\"], params[\"L\"]\n        m_dot, cp, Tb_in = params[\"m_dot\"], params[\"cp\"], params[\"Tb_in\"]\n\n        # 1. Calculate the linear heat rate Q' (W/m)\n        # Q' = pi * q0 * Rf^2 * (1 + a/2)\n        Q_prime = np.pi * q0 * Rf**2 * (1.0 + a / 2.0)\n\n        # 2. Calculate the outlet bulk coolant temperature Tb(L) (K)\n        # Tb(L) = Tb_in + (Q' * L) / (m_dot * cp)\n        Tb_out = Tb_in + (Q_prime * L) / (m_dot * cp)\n\n        # 3. Calculate the radial temperature drops\n        \n        # 3a. Temperature drop within the fuel: Tf(0) - Tf(Rf)\n        # deltaT_fuel = (q0 * Rf^2 / (16 * kf)) * (4 + a)\n        delta_T_fuel = (q0 * Rf**2 * (4.0 + a)) / (16.0 * kf)\n\n        # 3b. Temperature drop across the cladding: Tc(Rf) - Tc(Rco)\n        # Thermal resistance of cladding (hollow cylinder) is R_clad = ln(Rco/Rf) / (2*pi*kc)\n        # deltaT_clad = Q' * R_clad\n        delta_T_clad = (Q_prime / (2.0 * np.pi * kc)) * np.log(Rco / Rf)\n\n        # 3c. Temperature drop across the convective film: Tc(Rco) - Tb\n        # Thermal resistance of convection is R_conv = 1 / (h * A) where A is surface area per unit length\n        # A = 2*pi*Rco. So, R_conv_linear = 1 / (2*pi*Rco*h)\n        # deltaT_conv = Q' * R_conv_linear\n        delta_T_conv = Q_prime / (2.0 * np.pi * Rco * h)\n\n        # 4. Sum the temperatures to get the final outlet centerline temperature\n        # Tf(0, L) = Tb(L) + deltaT_fuel + deltaT_clad + deltaT_conv\n        Tf_centerline_outlet = Tb_out + delta_T_fuel + delta_T_clad + delta_T_conv\n        \n        # Round to three decimal places and append to results list\n        results.append(f\"{Tf_centerline_outlet:.3f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在反应堆堆芯中，相邻的冷却剂子通道并非孤立存在；它们通过湍流混合和横向流动交换能量与质量，这会影响整个堆芯的温度分布。子通道分析程序正是为了模拟这些系统级的相互作用而开发的。这项编程练习要求您实现一个简化的子通道模型，以量化混合与横流如何减小温度的不均匀性，帮助您深入理解在反应堆组件中使冷却剂焓均匀化的核心机制。",
            "id": "4253228",
            "problem": "考虑一个核反应堆堆芯的简化子通道热工水力模型，其中多个冷却剂子通道通过湍流混合和横向交混流进行能量交换。假设每个子通道中为单相不可压缩流动，质量流量恒定，轴向热传导可忽略不计，并且每单位轴向长度上的热量增加是恒定的。对于子通道 $i$，比焓 $h_i(z)$ 的轴向演化由以下耦合一阶常微分方程建模：\n$$\n\\frac{d h_i}{dz} = s_i + \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right)\\left(h_j - h_i\\right),\n$$\n其中，$z$ 是轴向坐标，$m_i$ 是子通道 $i$ 中的质量流量，$s_i = \\frac{q''_i P_i}{m_i}$ 是轴向焓源项，其中 $q''_i$ 是壁面热通量，$P_i$ 是湿周，$\\beta_{ij}$ 是子通道 $i$ 和 $j$ 之间的湍流混合系数，$f_{ij}$ 是从子通道 $i$ 到相邻子通道 $j$ 的每单位轴向长度的横向交混流质量交换率，$\\mathcal{N}(i)$ 是子通道 $i$ 的相邻子通道集合。所有量均视为不随 $z$ 变化的常数。堆芯入口处的初始条件在所有子通道中是均匀的，\n$$\nh_i(0) = h_{\\text{in}}, \\quad \\text{对所有 } i.\n$$\n定义子通道 $i$ 中的焓升为 $\\Delta h_i = h_i(L) - h_{\\text{in}}$，其中 $L$ 是堆芯长度。出口处的焓值分布不均度通过变异系数来量化：\n$$\n\\text{CV} = \\frac{\\sigma_{\\Delta h}}{\\mu_{\\Delta h}},\n$$\n其中 $\\sigma_{\\Delta h}$ 是所有子通道的 $\\{\\Delta h_i\\}$ 的标准差，$\\mu_{\\Delta h}$ 是所有子通道的 $\\{\\Delta h_i\\}$ 的平均值。\n\n从能量守恒和上述定义出发，推导向量形式的耦合系统，并使用数学上可靠的方法求解出口焓值 $h_i(L)$。然后计算分布不均度量 $\\text{CV}$。\n\n单位和常数：\n- 使用 $h$ 的单位为 $\\text{J}/\\text{kg}$，$z$ 和 $L$ 的单位为 $\\text{m}$，$m$ 的单位为 $\\text{kg}/\\text{s}$，$q''$ 的单位为 $\\text{W}/\\text{m}^2$，$P$ 的单位为 $\\text{m}$，$\\beta$ 的单位为 $\\text{m}^{-1}$，$f$ 的单位为 $\\text{kg}/(\\text{s}\\cdot\\text{m})$。\n- 使用 $h_{\\text{in}} = 1.0\\times 10^{5}\\ \\text{J}/\\text{kg}$。\n\n需要实现和评估的测试套件：\n- 情况1（理想情况，中等混合与交混流，非对称加热）：\n  - 子通道：$N = 4$，排列成 $2\\times 2$ 网格，相邻关系为 $(0,1)$、$(0,2)$、$(1,3)$、$(2,3)$。\n  - 长度：$L = 4.0\\ \\text{m}$。\n  - 质量流量：$(m_0,m_1,m_2,m_3) = (0.25, 0.25, 0.25, 0.25)\\ \\text{kg}/\\text{s}$。\n  - 湿周：$(P_0,P_1,P_2,P_3) = (0.10,0.10,0.10,0.10)\\ \\text{m}$。\n  - 热通量：$(q''_0,q''_1,q''_2,q''_3) = (100000,100000,120000,100000)\\ \\text{W}/\\text{m}^2$。\n  - 混合：对于每对相邻子通道，$\\beta_{ij} = 0.8\\ \\text{m}^{-1}$。\n  - 每单位长度交混流：对于每对相邻子通道，$f_{ij} = 0.02\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$。\n- 情况2（边界情况，无混合与交混流）：\n  - 与情况1相同的 $N$、相邻关系、$L$、$m_i$、$P_i$、$q''_i$。\n  - 混合：对于每对相邻子通道，$\\beta_{ij} = 0.0\\ \\text{m}^{-1}$。\n  - 每单位长度交混流：对于每对相邻子通道，$f_{ij} = 0.0\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$。\n- 情况3（强混合与交混流，非均匀质量流量）：\n  - 子通道：$N = 4$，具有相同的相邻关系。\n  - 长度：$L = 4.0\\ \\text{m}$。\n  - 质量流量：$(m_0,m_1,m_2,m_3) = (0.22, 0.30, 0.26, 0.27)\\ \\text{kg}/\\text{s}$。\n  - 湿周：$(P_0,P_1,P_2,P_3) = (0.10,0.10,0.10,0.10)\\ \\text{m}$。\n  - 热通量：$(q''_0,q''_1,q''_2,q''_3) = (100000,100000,120000,100000)\\ \\text{W}/\\text{m}^2$。\n  - 混合：对于每对相邻子通道，$\\beta_{ij} = 5.0\\ \\text{m}^{-1}$。\n  - 每单位长度交混流：对于每对相邻子通道，$f_{ij} = 0.10\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$。\n- 情况4（边界情况，均匀加热）：\n  - 子通道：$N = 4$，具有相同的相邻关系。\n  - 长度：$L = 4.0\\ \\text{m}$。\n  - 质量流量：$(m_0,m_1,m_2,m_3) = (0.25, 0.25, 0.25, 0.25)\\ \\text{kg}/\\text{s}$。\n  - 湿周：$(P_0,P_1,P_2,P_3) = (0.10,0.10,0.10,0.10)\\ \\text{m}$。\n  - 热通量：$(q''_0,q''_1,q''_2,q''_3) = (110000,110000,110000,110000)\\ \\text{W}/\\text{m}^2$。\n  - 混合：对于每对相邻子通道，$\\beta_{ij} = 1.5\\ \\text{m}^{-1}$。\n  - 每单位长度交混流：对于每对相邻子通道，$f_{ij} = 0.05\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$。\n\n您的程序应针对每种情况，建立并求解耦合系统以获得 $h_i(L)$，计算 $\\Delta h_i$ 和变异系数 $\\text{CV}$，并返回四个 $\\text{CV}$ 值。将每个 $\\text{CV}$ 表示为小数，四舍五入到六位小数。您的程序应产生单行输出，其中包含一个由方括号括起来的、以逗号分隔的结果列表（例如，$\\left[0.123456,0.234567,0.345678,0.456789\\right]$）。",
            "solution": "用户提供了一个问题陈述，该陈述描述了核反应堆堆芯中一组耦合冷却剂子通道内比焓的轴向演化。任务是求解控制常微分方程(ODE)组，计算每个子通道的焓升，然后计算出口焓值分布不均的统计度量，即变异系数(CV)。\n\n### 步骤1：问题陈述验证\n\n我将首先根据指定标准验证问题陈述。\n\n#### 提取给定条件：\n- **控制方程**：对于每个子通道 $i$，比焓 $h_i(z)$ 的轴向演化由下式给出：\n$$\n\\frac{d h_i}{dz} = s_i + \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right)\\left(h_j - h_i\\right)\n$$\n- **变量和定义**：\n  - $z$：轴向坐标 (m)。\n  - $h_i(z)$：子通道 $i$ 在位置 $z$ 处的比焓 (J/kg)。\n  - $m_i$：子通道 $i$ 中的恒定质量流量 (kg/s)。\n  - $s_i = \\frac{q''_i P_i}{m_i}$：轴向焓源项，假定为常数。\n  - $q''_i$：壁面热通量 (W/m$^2$)。\n  - $P_i$：湿周 (m)。\n  - $\\beta_{ij}$：子通道 $i$ 和 $j$ 之间的湍流混合系数 (m$^{-1}$)。\n  - $f_{ij}$：从子通道 $i$到 $j$ 每单位长度的横向交混流质量交换率 (kg/(s·m))。假定 $f_{ij}=f_{ji}$。\n  - $\\mathcal{N}(i)$：子通道 $i$ 的相邻子通道集合。\n- **初始条件**：堆芯入口 ($z=0$) 处的焓值均匀：\n$$\nh_i(0) = h_{\\text{in}} = 1.0\\times 10^{5}\\ \\text{J}/\\text{kg} \\quad \\text{对所有 } i.\n$$\n- **待计算量**：\n  - 焓升：$\\Delta h_i = h_i(L) - h_{\\text{in}}$，其中 $L$ 是堆芯长度 (m)。\n  - 变异系数（分布不均度量）：$\\text{CV} = \\frac{\\sigma_{\\Delta h}}{\\mu_{\\Delta h}}$，其中 $\\sigma_{\\Delta h}$ 和 $\\mu_{\\Delta h}$ 分别是集合 $\\{\\Delta h_i\\}$ 的标准差和平均值。\n- **测试套件**：为4个子通道系统 ($N=4$) 提供了四个具体的案例及所有必要的数值参数。拓扑结构是一个2x2网格，相邻对为 (0,1)、(0,2)、(1,3)、(2,3)，这定义了一个对应于方形排列（0-1-3-2-0）的循环图C4。\n\n#### 使用提取的给定条件进行验证：\n1.  **科学依据**：该控制方程是用于核反应堆热工水力子通道分析（例如，在类COBRA程序中）的标准能量平衡方程，尽管是简化形式。它代表了热量和质量交换的线性化模型。该模型基于能量守恒的基本原理。在工程近似的背景下，它是科学上可靠的。\n2.  **适定性**：该问题是一个带有常系数的线性一阶常微分方程组的初值问题(IVP)。给定明确的初始条件，对于所有 $z \\geq 0$ 都存在唯一解。求解所需的所有参数均已提供。\n3.  **目标明确**：问题以精确的数学和物理术语陈述。所有量都得到了明确的定义。\n4.  **完整性和一致性**：解决给定测试案例所需的所有数据均已提供。单位是一致的。问题陈述中没有矛盾之处。\n5.  **可行性/现实性**：测试案例中提供的参数对于简化的反应堆堆芯分析来说，处于一个合理的范围内。相关计算在计算上是可行的。\n\n#### 结论和行动：\n该问题被判定为**有效**。这是一个来自核工程领域的、适定的、有科学依据的问题。我将继续进行求解。\n\n### 步骤2：求解推导与算法设计\n\n问题的核心是求解一个耦合线性一阶常微分方程组。\n\n#### 向量形式的数学公式\n通过展开求和项，可以重写子通道 $i$ 的控制方程：\n$$\n\\frac{d h_i}{dz} = s_i + \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right)h_j - \\left[ \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right) \\right] h_i\n$$\n这个由 $N$ 个方程组成的系统可以用矩阵-向量形式表示。设 $\\mathbf{h}(z)$ 是比焓的列向量 $[h_0(z), h_1(z), \\dots, h_{N-1}(z)]^T$，$\\mathbf{s}$ 是源项的列向量 $[s_0, s_1, \\dots, s_{N-1}]^T$。系统变为：\n$$\n\\frac{d\\mathbf{h}}{dz} = \\mathbf{A}\\mathbf{h} + \\mathbf{s}\n$$\n其中 $\\mathbf{A}$ 是一个 $N \\times N$ 矩阵，其元素定义如下：\n- 对于非对角元素 ($i \\neq j$)：\n$$\nA_{ij} = \\begin{cases} \\beta_{ij} + \\frac{f_{ij}}{m_i}  \\text{如果 } j \\in \\mathcal{N}(i) \\\\ 0  \\text{其他情况} \\end{cases}\n$$\n- 对于对角元素 ($i = j$)：\n$$\nA_{ii} = - \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right) = - \\sum_{j \\neq i} A_{ij}\n$$\n问题陈述中指出，$\\beta_{ij}$ 和 $f_{ij}$ 是为每个“相邻对”给出的，这意味着对称性：$\\beta_{ij} = \\beta_{ji}$ 和 $f_{ij} = f_{ji}$。然而，如果质量流量 $m_i$ 不同，矩阵 $\\mathbf{A}$ 不一定是对称的。$\\mathbf{A}$ 的一个关键属性是每行之和为零，即 $\\mathbf{A}\\mathbf{1} = \\mathbf{0}$，其中 $\\mathbf{1}$ 是全为1的列向量。这意味着 $\\mathbf{A}$ 是一个奇异矩阵。\n\n初始条件为 $\\mathbf{h}(0) = h_{\\text{in}}\\mathbf{1}$。\n\n#### 求解常微分方程组\n为了简化初始条件，我们定义一个新向量表示相对于入口的焓升，$\\mathbf{y}(z) = \\mathbf{h}(z) - h_{\\text{in}}\\mathbf{1}$。$\\mathbf{y}$ 的初始条件是 $\\mathbf{y}(0) = \\mathbf{0}$。$\\mathbf{y}$ 的微分方程是：\n$$\n\\frac{d\\mathbf{y}}{dz} = \\frac{d\\mathbf{h}}{dz} = \\mathbf{A}(\\mathbf{y} + h_{\\text{in}}\\mathbf{1}) + \\mathbf{s} = \\mathbf{A}\\mathbf{y} + h_{\\text{in}}(\\mathbf{A}\\mathbf{1}) + \\mathbf{s}\n$$\n由于 $\\mathbf{A}\\mathbf{1} = \\mathbf{0}$，方程简化为：\n$$\n\\frac{d\\mathbf{y}}{dz} = \\mathbf{A}\\mathbf{y} + \\mathbf{s}, \\quad \\text{其中} \\quad \\mathbf{y}(0) = \\mathbf{0}\n$$\n这是一个具有齐次初始条件的标准非齐次线性常微分方程组。解由下式给出：\n$$\n\\mathbf{y}(z) = \\left( \\int_0^z e^{\\mathbf{A}\\tau} d\\tau \\right) \\mathbf{s}\n$$\n其中 $e^{\\mathbf{A}\\tau}$ 是矩阵指数。由于 $\\mathbf{A}$ 和 $\\mathbf{s}$ 是常数，我们需要在 $z=L$ 处计算此表达式的值，以找到出口焓升 $\\mathbf{\\Delta h} = \\mathbf{y}(L)$。\n\n一种求解 $\\mathbf{y}(L)$ 的稳健数值方法是使用“增广矩阵的矩阵指数”技巧。我们定义一个 $(N+1) \\times (N+1)$ 的分块矩阵 $\\mathbf{B}$：\n$$\n\\mathbf{B} = \\begin{pmatrix} \\mathbf{A}  \\mathbf{s} \\\\ \\mathbf{0}^T  0 \\end{pmatrix}\n$$\n可以证明 $\\mathbf{B}L$ 的指数为：\n$$\ne^{\\mathbf{B}L} = \\begin{pmatrix} e^{\\mathbf{A}L}  \\mathbf{y}(L) \\\\ \\mathbf{0}^T  1 \\end{pmatrix}\n$$\n因此，向量 $\\mathbf{y}(L)$，也就是焓升向量 $\\mathbf{\\Delta h}$，可以从计算出的矩阵 $e^{\\mathbf{B}L}$ 的右上角 $N \\times 1$ 分块中提取。这种方法避免了 $\\mathbf{A}$ 的奇异性问题，并且在数值上是稳定的。\n\n#### 计算变异系数(CV)的算法\n对于每个测试案例，应用以下算法：\n1.  **初始化**：提取参数：堆芯长度 $L$、质量流量 $\\mathbf{m}$、湿周 $\\mathbf{P}$、热通量 $\\mathbf{q''}$、混合系数 $\\beta$ 和交混流系数 $f$。定义子通道的相邻关系对。\n2.  **构建源向量**：为每个子通道 $i=0, \\dots, N-1$ 计算源项 $s_i = \\frac{q''_i P_i}{m_i}$，以形成向量 $\\mathbf{s}$。\n3.  **构建A矩阵**：根据相邻拓扑以及给定的 $\\beta$、$f$ 和 $\\mathbf{m}$ 值，按照上面推导的 $A_{ij}$ 和 $A_{ii}$ 的公式，创建 $N \\times N$ 矩阵 $\\mathbf{A}$。\n4.  **构建增广矩阵**：通过用 $\\mathbf{s}$ 增广 $\\mathbf{A}$ 并用零填充，形成 $(N+1) \\times (N+1)$ 矩阵 $\\mathbf{B}$。\n5.  **求解焓升**：使用可靠的数值库函数（例如 `scipy.linalg.expm`）计算矩阵指数 $e^{\\mathbf{B}L}$。从结果矩阵的最后一列（前 $N$ 行）中提取出口焓升向量 $\\mathbf{\\Delta h}$。\n6.  **计算CV**：\n    a. 计算焓升的平均值：$\\mu_{\\Delta h} = \\frac{1}{N} \\sum_{i=0}^{N-1} \\Delta h_i$。\n    b. 计算总体标准差：$\\sigma_{\\Delta h} = \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} (\\Delta h_i - \\mu_{\\Delta h})^2}$。\n    c. 计算变异系数：$\\text{CV} = \\frac{\\sigma_{\\Delta h}}{\\mu_{\\Delta h}}$。处理 $\\mu_{\\Delta h}=0$ 的情况以避免除以零，尽管在给定的物理问题中这种情况预计不会发生。\n7.  **返回结果**：计算出的 $\\text{CV}$ 值即为该案例的结果。\n\n此过程将被实现并应用于提供的四个测试案例中的每一个。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to solve the subchannel thermal-hydraulics problem for all test cases.\n    \"\"\"\n\n    # Inlet enthalpy, not required for CV calculation but given in the problem.\n    # h_in = 1.0e5\n\n    # Define the neighbor pairs for the 4-subchannel 2x2 grid.\n    # This corresponds to a C4 graph: 0-1-3-2-0.\n    neighbor_pairs = [(0, 1), (0, 2), (1, 3), (2, 3)]\n\n    # Test cases as defined in the problem description.\n    test_cases = [\n        # Case 1: happy path, moderate mixing and crossflow, asymmetric heating\n        {\n            \"L\": 4.0,\n            \"m\": np.array([0.25, 0.25, 0.25, 0.25]),\n            \"P\": np.array([0.10, 0.10, 0.10, 0.10]),\n            \"q_double_prime\": np.array([100000, 100000, 120000, 100000]),\n            \"beta_val\": 0.8,\n            \"f_val\": 0.02,\n        },\n        # Case 2: edge case, no mixing and no crossflow\n        {\n            \"L\": 4.0,\n            \"m\": np.array([0.25, 0.25, 0.25, 0.25]),\n            \"P\": np.array([0.10, 0.10, 0.10, 0.10]),\n            \"q_double_prime\": np.array([100000, 100000, 120000, 100000]),\n            \"beta_val\": 0.0,\n            \"f_val\": 0.0,\n        },\n        # Case 3: strong mixing and crossflow, heterogeneous mass flows\n        {\n            \"L\": 4.0,\n            \"m\": np.array([0.22, 0.30, 0.26, 0.27]),\n            \"P\": np.array([0.10, 0.10, 0.10, 0.10]),\n            \"q_double_prime\": np.array([100000, 100000, 120000, 100000]),\n            \"beta_val\": 5.0,\n            \"f_val\": 0.10,\n        },\n        # Case 4: boundary case, equal heating\n        {\n            \"L\": 4.0,\n            \"m\": np.array([0.25, 0.25, 0.25, 0.25]),\n            \"P\": np.array([0.10, 0.10, 0.10, 0.10]),\n            \"q_double_prime\": np.array([110000, 110000, 110000, 110000]),\n            \"beta_val\": 1.5,\n            \"f_val\": 0.05,\n        },\n    ]\n\n    def solve_case(params, neighbors):\n        \"\"\"\n        Solves a single case for the coefficient of variation (CV).\n        \"\"\"\n        N = 4  # Number of subchannels\n        L = params[\"L\"]\n        m = params[\"m\"]\n        P = params[\"P\"]\n        q_pp = params[\"q_double_prime\"]\n        beta_val = params[\"beta_val\"]\n        f_val = params[\"f_val\"]\n\n        # 1. Calculate the source vector s\n        s = (q_pp * P) / m\n\n        # 2. Construct the A matrix\n        A = np.zeros((N, N))\n        \n        # Build adjacency list from pairs\n        adj = [[] for _ in range(N)]\n        for i, j in neighbors:\n            adj[i].append(j)\n            adj[j].append(i)\n\n        for i in range(N):\n            row_sum = 0\n            for j in adj[i]:\n                # Off-diagonal elements\n                val = beta_val + f_val / m[i]\n                A[i, j] = val\n                row_sum += val\n            # Diagonal elements\n            A[i, i] = -row_sum\n\n        # 3. Construct the augmented B matrix\n        B = np.zeros((N + 1, N + 1))\n        B[:N, :N] = A\n        B[:N, N] = s\n        \n        # 4. Compute the matrix exponential\n        exp_BL = expm(B * L)\n\n        # 5. Extract the enthalpy rise vector delta_h\n        delta_h = exp_BL[:N, N]\n\n        # 6. Calculate the coefficient of variation (CV)\n        mu_delta_h = np.mean(delta_h)\n        if mu_delta_h == 0:\n            return 0.0 # Avoid division by zero if all rises are zero\n            \n        sigma_delta_h = np.std(delta_h) # Population std dev (ddof=0)\n        \n        cv = sigma_delta_h / mu_delta_h\n        return cv\n\n    results = []\n    for case in test_cases:\n        cv_result = solve_case(case, neighbor_pairs)\n        results.append(cv_result)\n\n    # Format the final output as specified.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        }
    ]
}