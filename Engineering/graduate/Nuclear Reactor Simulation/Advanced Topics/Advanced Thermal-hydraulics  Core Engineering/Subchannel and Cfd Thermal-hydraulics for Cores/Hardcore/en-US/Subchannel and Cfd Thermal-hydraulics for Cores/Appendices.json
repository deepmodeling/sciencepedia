{
    "hands_on_practices": [
        {
            "introduction": "Accurate prediction of heat transfer and friction in a reactor core relies on correctly resolving the turbulent boundary layer near fuel rod surfaces. This exercise grounds the abstract concept of the non-dimensional wall coordinate, $y^+$, in the practical task of designing a computational mesh. By deriving and applying the relationship between flow properties and the required near-wall cell size, you will gain a fundamental skill for setting up high-fidelity Computational Fluid Dynamics (CFD) simulations .",
            "id": "4253215",
            "problem": "A nuclear reactor rod-bundle subchannel is modeled using Computational Fluid Dynamics (CFD). The near-wall mesh resolution must be chosen to properly capture wall-bounded turbulence in either a wall-function approach or a low-Reynolds-number approach that resolves the viscous sublayer. Starting from fundamental definitions and well-tested correlations, derive the general relationship connecting the wall-normal distance to the first cell centroid, the non-dimensional wall coordinate, and flow properties. Then compute the necessary first-cell centroid distance for both approaches using the following physically realistic core thermal-hydraulic conditions for a Pressurized Water Reactor (PWR) subchannel:\n- The coolant is liquid water at high pressure, modeled as a Newtonian fluid with density $\\rho = 700\\,\\mathrm{kg/m^3}$ and dynamic viscosity $\\mu = 1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s}$.\n- The flow is fully developed and turbulent in a smooth-wall subchannel with hydraulic diameter $D_{h} = 9.0\\times 10^{-3}\\,\\mathrm{m}$.\n- The mass flux is $G = 3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}$.\n- Use the Petukhov correlation for the Darcy–Weisbach friction factor in smooth tubes: $f = \\left(0.79\\,\\ln(\\mathrm{Re}) - 1.64\\right)^{-2}$, where the Reynolds number is $\\mathrm{Re} = \\dfrac{G\\,D_{h}}{\\mu}$.\n\nYou must proceed from first principles:\n- Use the definition of the non-dimensional wall coordinate $y^{+}$.\n- Use the definition of the friction velocity in terms of wall shear stress and the Darcy friction factor.\n- Use the relationship between wall shear stress and the Darcy friction factor for fully developed internal turbulent flow.\n\nFor the wall-function approach, target the first cell centroid at $y^{+} = 30$. For the low-Reynolds-number approach, target the first cell centroid at $y^{+} = 1$. Express both required first-cell centroid distances in micrometers and round your answers to three significant figures. The final answer must be a calculation and contain only the two values requested, arranged as a row matrix.",
            "solution": "The problem statement has been validated and found to be scientifically grounded, well-posed, objective, and self-contained. It presents a standard engineering calculation in the field of computational fluid dynamics (CFD) as applied to nuclear reactor thermal-hydraulics. All provided data are physically realistic for the specified conditions, and the requested task is clear and solvable. Proceeding to solution.\n\nThe objective is to derive a relationship for the first cell centroid distance from the wall, $y_p$, as a function of the non-dimensional wall coordinate, $y^{+}$, and other flow properties, and then to compute $y_p$ for two target $y^{+}$ values.\n\nThe derivation begins from the definition of the non-dimensional wall coordinate, $y^{+}$:\n$$y^{+} = \\frac{y_p u_{\\tau}}{\\nu}$$\nwhere $y_p$ is the dimensional distance from the wall to the first cell centroid, $u_{\\tau}$ is the friction velocity, and $\\nu$ is the kinematic viscosity of the fluid.\n\nThe friction velocity, $u_{\\tau}$, is defined in terms of the wall shear stress, $\\tau_w$, and the fluid density, $\\rho$:\n$$u_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}$$\nThe kinematic viscosity, $\\nu$, is the ratio of dynamic viscosity, $\\mu$, to density, $\\rho$:\n$$\\nu = \\frac{\\mu}{\\rho}$$\nFor fully developed turbulent flow in a channel or pipe, the wall shear stress, $\\tau_w$, is related to the bulk fluid velocity, $u_b$, and the Darcy-Weisbach friction factor, $f$, by the following equation:\n$$\\tau_w = \\frac{1}{8} f \\rho u_b^2$$\nThe problem provides the mass flux, $G$, which is related to the bulk velocity and density by $G = \\rho u_b$. Therefore, the bulk velocity can be expressed as $u_b = G/\\rho$. Substituting this into the expression for $\\tau_w$:\n$$\\tau_w = \\frac{1}{8} f \\rho \\left(\\frac{G}{\\rho}\\right)^2 = \\frac{f G^2}{8\\rho}$$\nNow, we can derive an expression for the friction velocity, $u_{\\tau}$, in terms of the given parameters:\n$$u_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}} = \\sqrt{\\frac{1}{\\rho} \\left(\\frac{f G^2}{8\\rho}\\right)} = \\sqrt{\\frac{f G^2}{8\\rho^2}} = \\frac{G}{\\rho} \\sqrt{\\frac{f}{8}}$$\nNext, we substitute the expressions for $u_{\\tau}$ and $\\nu$ back into the definition of $y^{+}$:\n$$y^{+} = \\frac{y_p u_{\\tau}}{\\nu} = \\frac{y_p \\left(\\frac{G}{\\rho} \\sqrt{\\frac{f}{8}}\\right)}{\\mu/\\rho}$$\nThe density, $\\rho$, cancels out, yielding:\n$$y^{+} = \\frac{y_p G}{\\mu} \\sqrt{\\frac{f}{8}}$$\nFinally, we rearrange this equation to solve for the first cell centroid distance, $y_p$. This provides the general relationship required:\n$$y_p = \\frac{y^{+} \\mu}{G} \\sqrt{\\frac{8}{f}}$$\nWith this derived relationship, we proceed to the numerical calculation. The given parameters are:\n- Density: $\\rho = 700\\,\\mathrm{kg/m^3}$\n- Dynamic viscosity: $\\mu = 1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s}$\n- Hydraulic diameter: $D_{h} = 9.0\\times 10^{-3}\\,\\mathrm{m}$\n- Mass flux: $G = 3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}$\n\nFirst, we calculate the Reynolds number, $\\mathrm{Re}$, to determine the friction factor, $f$:\n$$\\mathrm{Re} = \\frac{G D_{h}}{\\mu} = \\frac{(3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}) \\times (9.0\\times 10^{-3}\\,\\mathrm{m})}{1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s}} = 270000$$\nThe flow is highly turbulent, as $\\mathrm{Re} \\gg 4000$.\n\nNext, we use the provided Petukhov correlation to calculate the friction factor, $f$:\n$$f = \\left(0.79\\,\\ln(\\mathrm{Re}) - 1.64\\right)^{-2}$$\nSubstituting the value for $\\mathrm{Re}$:\n$$f = \\left(0.79\\,\\ln(270000) - 1.64\\right)^{-2}$$\n$$\\ln(270000) \\approx 12.506176$$\n$$f \\approx \\left(0.79 \\times 12.506176 - 1.64\\right)^{-2} = \\left(9.879879 - 1.64\\right)^{-2} = (8.239879)^{-2} \\approx 0.0147285$$\nNow we can compute the required first-cell centroid distance, $y_p$, for the two specified cases.\n\nCase 1: Wall-function approach, targeting $y^{+} = 30$.\n$$y_{p, wf} = \\frac{30 \\times (1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s})}{3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}} \\sqrt{\\frac{8}{0.0147285}}$$\n$$y_{p, wf} = (1.0\\times 10^{-6}\\,\\mathrm{m}) \\times \\sqrt{543.160} \\approx (1.0\\times 10^{-6}\\,\\mathrm{m}) \\times 23.3058$$\n$$y_{p, wf} \\approx 2.33058\\times 10^{-5}\\,\\mathrm{m}$$\nConverting to micrometers ($1\\,\\mathrm{m} = 10^6\\,\\mu\\mathrm{m}$):\n$$y_{p, wf} \\approx 23.3058\\,\\mu\\mathrm{m}$$\nRounding to three significant figures, the required distance for the wall-function approach is $23.3\\,\\mu\\mathrm{m}$.\n\nCase 2: Low-Reynolds-number approach, targeting $y^{+} = 1$.\n$$y_{p, \\text{low-Re}} = \\frac{1 \\times (1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s})}{3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}} \\sqrt{\\frac{8}{0.0147285}}$$\n$$y_{p, \\text{low-Re}} = \\frac{1}{30} \\times y_{p, wf} \\approx \\frac{23.3058\\,\\mu\\mathrm{m}}{30} \\approx 0.77686\\,\\mu\\mathrm{m}$$\nRounding to three significant figures, the required distance for the low-Reynolds-number approach is $0.777\\,\\mu\\mathrm{m}$.\n\nThe two calculated distances are $23.3\\,\\mu\\mathrm{m}$ for the wall-function approach ($y^+=30$) and $0.777\\,\\mu\\mathrm{m}$ for the low-Reynolds-number approach ($y^+=1$).",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n23.3  0.777\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While detailed CFD provides fine-grained resolution, system-level behavior is often captured more efficiently using subchannel analysis codes. This practice explores the core of such analysis by modeling the axial evolution of coolant enthalpy as a system of coupled channels that exchange energy through mixing and crossflow. By solving this system, you will learn how local heat imbalances and flow mixing collectively determine the overall temperature maldistribution at the core outlet, a key metric for thermal margin assessment .",
            "id": "4253228",
            "problem": "Consider a simplified subchannel thermal-hydraulics model for a nuclear reactor core in which multiple coolant subchannels exchange energy through turbulent mixing and lateral crossflow. Assume single-phase, incompressible flow with constant mass flow rate in each subchannel, negligible axial conduction, and constant heat addition per unit axial length. For subchannel $i$, the axial evolution of the specific enthalpy $h_i(z)$ is modeled by the coupled first-order ordinary differential equation\n$$\n\\frac{d h_i}{dz} = s_i + \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right)\\left(h_j - h_i\\right),\n$$\nwhere $z$ is the axial coordinate, $m_i$ is the mass flow rate in subchannel $i$, $s_i = \\frac{q''_i P_i}{m_i}$ is the axial enthalpy source term with $q''_i$ the wall heat flux and $P_i$ the wetted perimeter, $\\beta_{ij}$ is the turbulent mixing coefficient between subchannels $i$ and $j$, $f_{ij}$ is the lateral crossflow mass exchange rate per unit axial length from subchannel $i$ to neighbor $j$, and $\\mathcal{N}(i)$ is the set of neighbors of subchannel $i$. All quantities are taken as constant in $z$. The initial condition at the core inlet is uniform across subchannels,\n$$\nh_i(0) = h_{\\text{in}}, \\quad \\text{for all } i.\n$$\nDefine the enthalpy rise in subchannel $i$ as $\\Delta h_i = h_i(L) - h_{\\text{in}}$, where $L$ is the core length. The enthalpy maldistribution at the outlet is quantified by the coefficient of variation\n$$\n\\text{CV} = \\frac{\\sigma_{\\Delta h}}{\\mu_{\\Delta h}},\n$$\nwhere $\\sigma_{\\Delta h}$ is the standard deviation of $\\{\\Delta h_i\\}$ across all subchannels and $\\mu_{\\Delta h}$ is the mean of $\\{\\Delta h_i\\}$ across all subchannels.\n\nStarting from conservation of energy and the definitions above, derive the coupled system in vector form and solve for the outlet enthalpies $h_i(L)$ using a mathematically sound method. Then compute the maldistribution metric $\\text{CV}$.\n\nUnits and constants:\n- Use $h$ in $\\text{J}/\\text{kg}$, $z$ and $L$ in $\\text{m}$, $m$ in $\\text{kg}/\\text{s}$, $q''$ in $\\text{W}/\\text{m}^2$, $P$ in $\\text{m}$, $\\beta$ in $\\text{m}^{-1}$, and $f$ in $\\text{kg}/(\\text{s}\\cdot\\text{m})$.\n- Use $h_{\\text{in}} = 1.0\\times 10^{5}\\ \\text{J}/\\text{kg}$.\n\nTest suite to implement and evaluate:\n- Case $1$ (happy path, moderate mixing and crossflow, asymmetric heating):\n  - Subchannels: $N = 4$ arranged in a $2\\times 2$ grid with neighbors $(0,1)$, $(0,2)$, $(1,3)$, $(2,3)$.\n  - Length: $L = 4.0\\ \\text{m}$.\n  - Mass flows: $(m_0,m_1,m_2,m_3) = (0.25, 0.25, 0.25, 0.25)\\ \\text{kg}/\\text{s}$.\n  - Wetted perimeters: $(P_0,P_1,P_2,P_3) = (0.10,0.10,0.10,0.10)\\ \\text{m}$.\n  - Heat fluxes: $(q''_0,q''_1,q''_2,q''_3) = (100000,100000,120000,100000)\\ \\text{W}/\\text{m}^2$.\n  - Mixing: $\\beta_{ij} = 0.8\\ \\text{m}^{-1}$ for each neighbor pair.\n  - Crossflow per unit length: $f_{ij} = 0.02\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$ for each neighbor pair.\n- Case $2$ (edge case, no mixing and no crossflow):\n  - Same $N$, neighbors, $L$, $m_i$, $P_i$, $q''_i$ as Case $1$.\n  - Mixing: $\\beta_{ij} = 0.0\\ \\text{m}^{-1}$ for each neighbor pair.\n  - Crossflow per unit length: $f_{ij} = 0.0\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$ for each neighbor pair.\n- Case $3$ (strong mixing and crossflow, heterogeneous mass flows):\n  - Subchannels: $N = 4$ with same neighbor pairs.\n  - Length: $L = 4.0\\ \\text{m}$.\n  - Mass flows: $(m_0,m_1,m_2,m_3) = (0.22, 0.30, 0.26, 0.27)\\ \\text{kg}/\\text{s}$.\n  - Wetted perimeters: $(P_0,P_1,P_2,P_3) = (0.10,0.10,0.10,0.10)\\ \\text{m}$.\n  - Heat fluxes: $(q''_0,q''_1,q''_2,q''_3) = (100000,100000,120000,100000)\\ \\text{W}/\\text{m}^2$.\n  - Mixing: $\\beta_{ij} = 5.0\\ \\text{m}^{-1}$ for each neighbor pair.\n  - Crossflow per unit length: $f_{ij} = 0.10\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$ for each neighbor pair.\n- Case $4$ (boundary case, equal heating):\n  - Subchannels: $N = 4$ with same neighbor pairs.\n  - Length: $L = 4.0\\ \\text{m}$.\n  - Mass flows: $(m_0,m_1,m_2,m_3) = (0.25, 0.25, 0.25, 0.25)\\ \\text{kg}/\\text{s}$.\n  - Wetted perimeters: $(P_0,P_1,P_2,P_3) = (0.10,0.10,0.10,0.10)\\ \\text{m}$.\n  - Heat fluxes: $(q''_0,q''_1,q''_2,q''_3) = (110000,110000,110000,110000)\\ \\text{W}/\\text{m}^2$.\n  - Mixing: $\\beta_{ij} = 1.5\\ \\text{m}^{-1}$ for each neighbor pair.\n  - Crossflow per unit length: $f_{ij} = 0.05\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$ for each neighbor pair.\n\nYour program should, for each case, assemble and solve the coupled system to obtain $h_i(L)$, compute $\\Delta h_i$ and the coefficient of variation $\\text{CV}$, and return the four $\\text{CV}$ values. Express each $\\text{CV}$ as a decimal, rounded to six decimal places. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $\\left[0.123456,0.234567,0.345678,0.456789\\right]$).",
            "solution": "The user has provided a problem statement that describes the axial evolution of specific enthalpy in a set of coupled coolant subchannels within a nuclear reactor core. The task is to solve the governing system of ordinary differential equations (ODEs), calculate the enthalpy rise for each subchannel, and then compute a statistical measure of the outlet enthalpy maldistribution, the coefficient of variation (CV).\n\n### Step 1: Validation of the Problem Statement\n\nI will first validate the problem statement according to the specified criteria.\n\n#### Extraction of Givens:\n- **Governing Equation**: For each subchannel $i$, the axial evolution of specific enthalpy $h_i(z)$ is given by:\n$$\n\\frac{d h_i}{dz} = s_i + \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right)\\left(h_j - h_i\\right)\n$$\n- **Variables and Definitions**:\n  - $z$: axial coordinate (m).\n  - $h_i(z)$: specific enthalpy of subchannel $i$ at position $z$ (J/kg).\n  - $m_i$: constant mass flow rate in subchannel $i$ (kg/s).\n  - $s_i = \\frac{q''_i P_i}{m_i}$: axial enthalpy source term, assumed constant.\n  - $q''_i$: wall heat flux (W/m$^2$).\n  - $P_i$: wetted perimeter (m).\n  - $\\beta_{ij}$: turbulent mixing coefficient between subchannels $i$ and $j$ (m$^{-1}$).\n  - $f_{ij}$: lateral crossflow mass exchange rate per unit length from subchannel $i$ to $j$ (kg/(s·m)). Assumed $f_{ij}=f_{ji}$.\n  - $\\mathcal{N}(i)$: set of neighbors of subchannel $i$.\n- **Initial Condition**: Uniform enthalpy at the core inlet ($z=0$):\n$$\nh_i(0) = h_{\\text{in}} = 1.0\\times 10^{5}\\ \\text{J}/\\text{kg} \\quad \\text{for all } i.\n$$\n- **Quantities to Calculate**:\n  - Enthalpy rise: $\\Delta h_i = h_i(L) - h_{\\text{in}}$, where $L$ is the core length (m).\n  - Coefficient of Variation (maldistribution metric): $\\text{CV} = \\frac{\\sigma_{\\Delta h}}{\\mu_{\\Delta h}}$, where $\\sigma_{\\Delta h}$ and $\\mu_{\\Delta h}$ are the standard deviation and mean of the set $\\{\\Delta h_i\\}$.\n- **Test Suite**: Four specific cases are provided with all necessary numerical parameters for a 4-subchannel system ($N=4$). The topology is a $2\\times 2$ grid with neighbor pairs (0,1), (0,2), (1,3), (2,3), which defines a cycle graph C4 corresponding to a square arrangement (0-1-3-2-0).\n\n#### Validation Using Extracted Givens:\n1.  **Scientifically Grounded**: The governing equation is a standard, albeit simplified, energy balance used in subchannel analysis for nuclear reactor thermal-hydraulics (e.g., in COBRA-like codes). It represents a linearized model of heat and mass exchange. The model is based on fundamental principles of conservation of energy. It is scientifically sound within the context of engineering approximations.\n2.  **Well-Posed**: The problem is an initial value problem (IVP) for a system of linear, first-order ordinary differential equations with constant coefficients. Given a well-defined initial condition, a unique solution exists for all $z \\geq 0$. All parameters required for the solution are provided.\n3.  **Objective**: The problem is stated in precise mathematical and physical terms. The quantities are defined unambiguously.\n4.  **Completeness and Consistency**: All data required to solve the problem for the given test cases are provided. The units are consistent. There are no contradictions in the problem statement.\n5.  **Feasibility/Realism**: The parameters provided in the test cases are within a plausible range for simplified reactor core analysis. The operations are computationally feasible.\n\n#### Verdict and Action:\nThe problem is deemed **valid**. It is a well-posed, scientifically grounded problem from the field of nuclear engineering. I will proceed with the solution.\n\n### Step 2: Solution Derivation and Algorithmic Design\n\nThe core of the problem is to solve a system of coupled linear first-order ODEs.\n\n#### Mathematical Formulation in Vector Form\nThe governing equation for subchannel $i$ can be rewritten by expanding the summation term:\n$$\n\\frac{d h_i}{dz} = s_i + \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right)h_j - \\left[ \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right) \\right] h_i\n$$\nThis system of $N$ equations can be expressed in matrix-vector form. Let $\\mathbf{h}(z)$ be the column vector of specific enthalpies, $[h_0(z), h_1(z), \\dots, h_{N-1}(z)]^T$, and $\\mathbf{s}$ be the column vector of source terms, $[s_0, s_1, \\dots, s_{N-1}]^T$. The system becomes:\n$$\n\\frac{d\\mathbf{h}}{dz} = \\mathbf{A}\\mathbf{h} + \\mathbf{s}\n$$\nwhere $\\mathbf{A}$ is an $N \\times N$ matrix with elements defined as:\n- For off-diagonal elements ($i \\neq j$):\n$$\nA_{ij} = \\begin{cases} \\beta_{ij} + \\frac{f_{ij}}{m_i}  \\text{if } j \\in \\mathcal{N}(i) \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n- For diagonal elements ($i = j$):\n$$\nA_{ii} = - \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right) = - \\sum_{j \\neq i} A_{ij}\n$$\nThe problem states that $\\beta_{ij}$ and $f_{ij}$ are given for each \"neighbor pair\", which implies symmetry: $\\beta_{ij} = \\beta_{ji}$ and $f_{ij} = f_{ji}$. However, the matrix $\\mathbf{A}$ is not necessarily symmetric if the mass flow rates $m_i$ are different. A key property of $\\mathbf{A}$ is that the sum of each row is zero, i.e., $\\mathbf{A}\\mathbf{1} = \\mathbf{0}$, where $\\mathbf{1}$ is a column vector of ones. This means $\\mathbf{A}$ is a singular matrix.\n\nThe initial condition is $\\mathbf{h}(0) = h_{\\text{in}}\\mathbf{1}$.\n\n#### Solving the ODE System\nTo simplify the initial condition, let's define a new vector for the enthalpy rise relative to the inlet, $\\mathbf{y}(z) = \\mathbf{h}(z) - h_{\\text{in}}\\mathbf{1}$. The initial condition for $\\mathbf{y}$ is $\\mathbf{y}(0) = \\mathbf{0}$. The differential equation for $\\mathbf{y}$ is:\n$$\n\\frac{d\\mathbf{y}}{dz} = \\frac{d\\mathbf{h}}{dz} = \\mathbf{A}(\\mathbf{y} + h_{\\text{in}}\\mathbf{1}) + \\mathbf{s} = \\mathbf{A}\\mathbf{y} + h_{\\text{in}}(\\mathbf{A}\\mathbf{1}) + \\mathbf{s}\n$$\nSince $\\mathbf{A}\\mathbf{1} = \\mathbf{0}$, the equation simplifies to:\n$$\n\\frac{d\\mathbf{y}}{dz} = \\mathbf{A}\\mathbf{y} + \\mathbf{s}, \\quad \\text{with} \\quad \\mathbf{y}(0) = \\mathbf{0}\n$$\nThis is a standard inhomogeneous linear ODE system with a homogeneous initial condition. The solution is given by:\n$$\n\\mathbf{y}(z) = \\left( \\int_0^z e^{\\mathbf{A}\\tau} d\\tau \\right) \\mathbf{s}\n$$\nwhere $e^{\\mathbf{A}\\tau}$ is the matrix exponential. Since $\\mathbf{A}$ and $\\mathbf{s}$ are constant, we need to evaluate this expression at $z=L$ to find the outlet enthalpy rises, $\\mathbf{\\Delta h} = \\mathbf{y}(L)$.\n\nA robust numerical method for finding $\\mathbf{y}(L)$ is to use the \"matrix exponential of an augmented matrix\" technique. Let's define an $(N+1) \\times (N+1)$ block matrix $\\mathbf{B}$ as:\n$$\n\\mathbf{B} = \\begin{pmatrix} \\mathbf{A}  \\mathbf{s} \\\\ \\mathbf{0}^T  0 \\end{pmatrix}\n$$\nThe exponential of $\\mathbf{B}L$ can be shown to be:\n$$\ne^{\\mathbf{B}L} = \\begin{pmatrix} e^{\\mathbf{A}L}  \\mathbf{y}(L) \\\\ \\mathbf{0}^T  1 \\end{pmatrix}\n$$\nThus, the vector $\\mathbf{y}(L)$, which is exactly the vector of enthalpy rises $\\mathbf{\\Delta h}$, can be extracted from the upper-right $N \\times 1$ block of the computed matrix $e^{\\mathbf{B}L}$. This method avoids issues with the singularity of $\\mathbf{A}$ and is numerically stable.\n\n#### Algorithm for Computing the Coefficient of Variation (CV)\nFor each test case, the following algorithm is applied:\n1.  **Initialize**: Extract the parameters: core length $L$, mass flow rates $\\mathbf{m}$, wetted perimeters $\\mathbf{P}$, heat fluxes $\\mathbf{q''}$, mixing coefficient $\\beta$, and crossflow coefficient $f$. Define the subchannel neighbor pairs.\n2.  **Construct Source Vector**: Calculate the source term $s_i = \\frac{q''_i P_i}{m_i}$ for each subchannel $i=0, \\dots, N-1$ to form the vector $\\mathbf{s}$.\n3.  **Construct A Matrix**: Create the $N \\times N$ matrix $\\mathbf{A}$ based on the neighbor topology and the given $\\beta$, $f$, and $\\mathbf{m}$ values, according to the formulas for $A_{ij}$ and $A_{ii}$ derived above.\n4.  **Construct Augmented Matrix**: Form the $(N+1) \\times (N+1)$ matrix $\\mathbf{B}$ by augmenting $\\mathbf{A}$ with $\\mathbf{s}$ and padding with zeros.\n5.  **Solve for Enthalpy Rise**: Compute the matrix exponential $e^{\\mathbf{B}L}$ using a reliable numerical library function (e.g., `scipy.linalg.expm`). Extract the outlet enthalpy rise vector $\\mathbf{\\Delta h}$ from the last column of the resulting matrix (first $N$ rows).\n6.  **Calculate CV**:\n    a. Compute the mean of the enthalpy rises: $\\mu_{\\Delta h} = \\frac{1}{N} \\sum_{i=0}^{N-1} \\Delta h_i$.\n    b. Compute the population standard deviation: $\\sigma_{\\Delta h} = \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} (\\Delta h_i - \\mu_{\\Delta h})^2}$.\n    c. Calculate the coefficient of variation: $\\text{CV} = \\frac{\\sigma_{\\Delta h}}{\\mu_{\\Delta h}}$. Handle the case $\\mu_{\\Delta h}=0$ to avoid division by zero, though it is not expected with the given problem physics.\n7.  **Return Result**: The computed value of $\\text{CV}$ is the result for the case.\n\nThis procedure will be implemented and applied to each of the four test cases provided.",
            "answer": "$$\\boxed{[0.038480,0.043301,0.019448,0.000000]}$$"
        },
        {
            "introduction": "A simulation is only as useful as its ability to predict reality, making model validation an indispensable part of the engineering workflow. This practice introduces a rigorous statistical approach to compare simulation predictions with experimental data, accounting for both random and systematic measurement uncertainties. By deriving and applying the chi-square ($\\chi^2$) statistic for correlated errors, you will gain a powerful tool for quantitatively assessing the goodness-of-fit and validating your computational models .",
            "id": "4253163",
            "problem": "A rod bundle within a pressurized water reactor core is instrumented to measure coolant subchannel outlet temperatures. Computational Fluid Dynamics (CFD) provides predicted temperatures for a subset of $N$ subchannels. The experiment provides corresponding measured temperatures and quantified uncertainties. Assume the measurement errors are jointly Gaussian, with independent random components for each subchannel and a common calibration systematic affecting all subchannels equally. Let the CFD predictions be $\\mathbf{T}^{\\mathrm{CFD}} \\in \\mathbb{R}^{N}$, the experimental measurements be $\\mathbf{T}^{\\mathrm{exp}} \\in \\mathbb{R}^{N}$, the independent standard uncertainties be $\\sigma_{i}$ for subchannel $i$, and the common systematic standard uncertainty be $s_{\\mathrm{sys}}$. The covariance matrix of the measurement errors is $\\boldsymbol{\\Sigma} = \\mathbf{D} + s_{\\mathrm{sys}}^{2} \\mathbf{1}\\mathbf{1}^{\\top}$, where $\\mathbf{D} = \\mathrm{diag}(\\sigma_{1}^{2}, \\dots, \\sigma_{N}^{2})$ and $\\mathbf{1}$ is the column vector of ones.\n\nStarting from the multivariate Gaussian likelihood for the measurement errors, derive a dimensionless goodness-of-fit validation metric based on the chi-square statistic that accounts for the correlated uncertainties induced by the common systematic. Then evaluate this metric for the following four subchannels ($N = 4$), where temperatures are in kelvin: \n- $\\mathbf{T}^{\\mathrm{CFD}} = \\left[591.0,\\, 592.6,\\, 599.0,\\, 600.7\\right]$,\n- $\\mathbf{T}^{\\mathrm{exp}} = \\left[590.2,\\, 593.5,\\, 598.1,\\, 601.3\\right]$,\n- $\\boldsymbol{\\sigma} = \\left[0.5,\\, 0.7,\\, 0.6,\\, 0.5\\right]$,\n- $s_{\\mathrm{sys}} = 0.4$.\n\nUse the reduced chi-square, defined as the chi-square divided by the number of degrees of freedom, with the degrees of freedom taken as $N$ because no model parameters are fitted in this comparison. Report the reduced chi-square and round your answer to four significant figures. Express your final answer as a dimensionless number.",
            "solution": "The problem statement is deemed valid. It is scientifically grounded in standard statistical methods for model validation, well-posed with all necessary information provided, and objective in its language. The task is to derive a goodness-of-fit statistic for data with correlated uncertainties and then apply it to a specific dataset.\n\nFirst, we derive the chi-square ($\\chi^2$) statistic. The problem states that the measurement errors are jointly Gaussian. Let the vector of differences between the experimental measurements and the CFD predictions be $\\mathbf{d} = \\mathbf{T}^{\\mathrm{exp}} - \\mathbf{T}^{\\mathrm{CFD}}$. Under the null hypothesis that the CFD model perfectly represents the true temperatures, the vector $\\mathbf{d}$ represents the measurement error. The probability density function for $\\mathbf{d}$ is given by the multivariate Gaussian distribution:\n$$\nP(\\mathbf{d} | \\boldsymbol{\\Sigma}) = \\frac{1}{\\sqrt{(2\\pi)^{N} \\det(\\boldsymbol{\\Sigma})}} \\exp\\left(-\\frac{1}{2} \\mathbf{d}^{\\top} \\boldsymbol{\\Sigma}^{-1} \\mathbf{d}\\right)\n$$\nThe $\\chi^2$ statistic is defined as the term in the exponent:\n$$\n\\chi^2 = \\mathbf{d}^{\\top} \\boldsymbol{\\Sigma}^{-1} \\mathbf{d}\n$$\nThe core of the derivation is finding the inverse of the covariance matrix $\\boldsymbol{\\Sigma}$. The given covariance matrix is $\\boldsymbol{\\Sigma} = \\mathbf{D} + s_{\\mathrm{sys}}^{2} \\mathbf{1}\\mathbf{1}^{\\top}$, where $\\mathbf{D} = \\mathrm{diag}(\\sigma_{1}^{2}, \\dots, \\sigma_{N}^{2})$ and $\\mathbf{1}$ is a column vector of ones. This form, a diagonal matrix plus a rank-one update, allows for the application of the Sherman-Morrison formula:\n$$\n(\\mathbf{A} + \\mathbf{u}\\mathbf{v}^{\\top})^{-1} = \\mathbf{A}^{-1} - \\frac{\\mathbf{A}^{-1}\\mathbf{u}\\mathbf{v}^{\\top}\\mathbf{A}^{-1}}{1 + \\mathbf{v}^{\\top}\\mathbf{A}^{-1}\\mathbf{u}}\n$$\nIn our case, we identify $\\mathbf{A} = \\mathbf{D}$, $\\mathbf{u} = s_{\\mathrm{sys}} \\mathbf{1}$, and $\\mathbf{v} = s_{\\mathrm{sys}} \\mathbf{1}$. The inverse of $\\mathbf{D}$ is simply $\\mathbf{D}^{-1} = \\mathrm{diag}(1/\\sigma_{1}^{2}, \\dots, 1/\\sigma_{N}^{2})$. We substitute these into the formula:\n$$\n\\boldsymbol{\\Sigma}^{-1} = \\mathbf{D}^{-1} - \\frac{\\mathbf{D}^{-1}(s_{\\mathrm{sys}}\\mathbf{1})(s_{\\mathrm{sys}}\\mathbf{1}^{\\top})\\mathbf{D}^{-1}}{1 + (s_{\\mathrm{sys}}\\mathbf{1}^{\\top})\\mathbf{D}^{-1}(s_{\\mathrm{sys}}\\mathbf{1})} = \\mathbf{D}^{-1} - \\frac{s_{\\mathrm{sys}}^{2} (\\mathbf{D}^{-1}\\mathbf{1})(\\mathbf{1}^{\\top}\\mathbf{D}^{-1})}{1 + s_{\\mathrm{sys}}^{2} (\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{1})}\n$$\nNow we substitute this expression for $\\boldsymbol{\\Sigma}^{-1}$ into the formula for $\\chi^2$:\n$$\n\\chi^2 = \\mathbf{d}^{\\top} \\left( \\mathbf{D}^{-1} - \\frac{s_{\\mathrm{sys}}^{2} (\\mathbf{D}^{-1}\\mathbf{1})(\\mathbf{1}^{\\top}\\mathbf{D}^{-1})}{1 + s_{\\mathrm{sys}}^{2} (\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{1})} \\right) \\mathbf{d}\n$$\n$$\n\\chi^2 = \\mathbf{d}^{\\top}\\mathbf{D}^{-1}\\mathbf{d} - \\frac{s_{\\mathrm{sys}}^{2} (\\mathbf{d}^{\\top}\\mathbf{D}^{-1}\\mathbf{1})(\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{d})}{1 + s_{\\mathrm{sys}}^{2} (\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{1})}\n$$\nLet's express the matrix products in terms of summations. Let $d_i$ be the $i$-th component of $\\mathbf{d}$.\n- $\\mathbf{d}^{\\top}\\mathbf{D}^{-1}\\mathbf{d} = \\sum_{i=1}^{N} \\frac{d_i^2}{\\sigma_i^2}$\n- $\\mathbf{d}^{\\top}\\mathbf{D}^{-1}\\mathbf{1} = \\sum_{i=1}^{N} \\frac{d_i}{\\sigma_i^2}$\n- $\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{d} = \\sum_{i=1}^{N} \\frac{d_i}{\\sigma_i^2}$\n- $\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{1} = \\sum_{j=1}^{N} \\frac{1}{\\sigma_j^2}$\nThe derived expression for the $\\chi^2$ statistic is therefore:\n$$\n\\chi^2 = \\sum_{i=1}^{N} \\frac{d_i^2}{\\sigma_i^2} - \\frac{s_{\\mathrm{sys}}^2 \\left(\\sum_{i=1}^{N} \\frac{d_i}{\\sigma_i^2}\\right)^2}{1 + s_{\\mathrm{sys}}^2 \\sum_{j=1}^{N} \\frac{1}{\\sigma_j^2}}\n$$\nThis is the required dimensionless goodness-of-fit validation metric.\n\nNext, we evaluate this metric for the given data.\nThe number of subchannels is $N=4$. The data vectors are:\n- $\\mathbf{T}^{\\mathrm{CFD}} = \\left[591.0,\\, 592.6,\\, 599.0,\\, 600.7\\right]$\n- $\\mathbf{T}^{\\mathrm{exp}} = \\left[590.2,\\, 593.5,\\, 598.1,\\, 601.3\\right]$\n- $\\boldsymbol{\\sigma} = \\left[0.5,\\, 0.7,\\, 0.6,\\, 0.5\\right]$\n- $s_{\\mathrm{sys}} = 0.4$\n\nFirst, compute the vector of differences $\\mathbf{d} = \\mathbf{T}^{\\mathrm{exp}} - \\mathbf{T}^{\\mathrm{CFD}}$:\n- $d_1 = 590.2 - 591.0 = -0.8$\n- $d_2 = 593.5 - 592.6 = 0.9$\n- $d_3 = 598.1 - 599.0 = -0.9$\n- $d_4 = 601.3 - 600.7 = 0.6$\n\nNext, we calculate the required sums. The variances are $\\sigma_1^2=0.25$, $\\sigma_2^2=0.49$, $\\sigma_3^2=0.36$, $\\sigma_4^2=0.25$, and $s_{\\mathrm{sys}}^2=0.16$.\n\n1.  Calculate $\\sum_{i=1}^{N} \\frac{d_i^2}{\\sigma_i^2}$:\n    $$\n    \\sum_{i=1}^{4} \\frac{d_i^2}{\\sigma_i^2} = \\frac{(-0.8)^2}{0.5^2} + \\frac{0.9^2}{0.7^2} + \\frac{(-0.9)^2}{0.6^2} + \\frac{0.6^2}{0.5^2} = \\frac{0.64}{0.25} + \\frac{0.81}{0.49} + \\frac{0.81}{0.36} + \\frac{0.36}{0.25}\n    $$\n    $$\n    = 2.56 + 1.653061... + 2.25 + 1.44 = 7.903061...\n    $$\n\n2.  Calculate $\\sum_{i=1}^{N} \\frac{d_i}{\\sigma_i^2}$:\n    $$\n    \\sum_{i=1}^{4} \\frac{d_i}{\\sigma_i^2} = \\frac{-0.8}{0.25} + \\frac{0.9}{0.49} + \\frac{-0.9}{0.36} + \\frac{0.6}{0.25} = -3.2 + 1.836734... - 2.5 + 2.4 = -1.463265...\n    $$\n\n3.  Calculate $\\sum_{j=1}^{N} \\frac{1}{\\sigma_j^2}$:\n    $$\n    \\sum_{j=1}^{4} \\frac{1}{\\sigma_j^2} = \\frac{1}{0.25} + \\frac{1}{0.49} + \\frac{1}{0.36} + \\frac{1}{0.25} = 4.0 + 2.040816... + 2.777777... + 4.0 = 12.818594...\n    $$\n\nNow, substitute these sums into the $\\chi^2$ formula:\n$$\n\\chi^2 = 7.903061... - \\frac{(0.4)^2 \\times (-1.463265...)^2}{1 + (0.4)^2 \\times 12.818594...}\n$$\n$$\n\\chi^2 = 7.903061... - \\frac{0.16 \\times 2.141157...}{1 + 0.16 \\times 12.818594...}\n$$\n$$\n\\chi^2 = 7.903061... - \\frac{0.342585...}{1 + 2.050975...} = 7.903061... - \\frac{0.342585...}{3.050975...}\n$$\n$$\n\\chi^2 = 7.903061... - 0.112287... = 7.790774...\n$$\nThe problem asks for the reduced chi-square, $\\chi^2_{\\mathrm{red}}$, with the number of degrees of freedom $\\nu = N = 4$.\n$$\n\\chi^2_{\\mathrm{red}} = \\frac{\\chi^2}{\\nu} = \\frac{7.790774...}{4} = 1.947693...\n$$\nRounding the result to four significant figures gives $1.948$.",
            "answer": "$$\\boxed{1.948}$$"
        }
    ]
}