{
    "hands_on_practices": [
        {
            "introduction": "在进行精细的反应堆物理计算时，准确模拟燃料组件周围的中子环境至关重要。此练习旨在探讨两种常用的泄漏模型——均匀巴克林（buckling）模型和反照率（albedo）边界条件——的适用范围与局限性。通过分析不同物理情景，您将学会何时复杂的反照率耦合模型能比简化的巴克林模型提供更精确的燃耗计算结果，从而加深对边界条件物理意义的理解 。",
            "id": "4232740",
            "problem": "对于压水堆（PWR）中单个燃料组件的栅格物理燃耗计算，必须捕捉到周围堆芯环境对组件内中子能谱的影响，因为同位素成分会随着燃耗而演化。考虑在一个组件区域 $\\Omega$ 上的多群稳态中子输运描述，其边界 $\\partial \\Omega$ 上的外向单位法向量为 $\\mathbf{n}$。角通量 $\\psi(\\mathbf{r}, \\mathbf{\\Omega}, E)$ 满足中子输运方程，该方程包含反应堆物理中标准的流、移出和散射/裂变源项。为表示该环境，有两种广泛使用的方法：\n\n$1.$ 标量曲率泄漏等效，在扩散形式中，它将第 $g$ 群的泄漏算符从 $-\\nabla \\cdot D_g \\nabla \\phi_g(\\mathbf{r})$ 替换为 $-\\nabla \\cdot D_g \\nabla \\phi_g(\\mathbf{r}) - D_g B^2 \\phi_g(\\mathbf{r})$，其中 $D_g$ 是群扩散系数，$\\phi_g(\\mathbf{r})$ 是群标量通量，$B^2$ 是一个假定在组件内空间和能谱上均匀的全堆芯曲率参数。\n\n$2.$ 与环境的反照率耦合。在输运形式中，它在边界 $\\partial \\Omega$ 上为出射角通量施加一个返回概率，例如，对于指向 $\\Omega$ 内部的方向 $\\mathbf{\\Omega}$，有 $\\psi^{-}_g(\\mathbf{r}, \\mathbf{\\Omega}, E) = a_g(\\mathbf{r}, \\mathbf{\\Omega}, E) \\, \\psi^{+}_g(\\mathbf{r}, \\mathbf{\\Omega}, E)$，其中 $a_g$ 可能依赖于能量、角度、位置以及周围堆芯的燃耗状态。在扩散形式中，这简化为边界 $\\partial \\Omega$ 上的罗宾型（Robin-type）边界条件 $-D_g \\, \\partial \\phi_g / \\partial n = \\alpha_g \\, \\phi_g$，其中 $\\partial \\phi_g / \\partial n$ 是法向导数，$\\alpha_g$ 是一个依赖于群的耦合系数。\n\n假设燃耗计算需要准确预测一组具有截面 $\\Sigma_{x,g}(\\mathbf{r})$ 的反应的反应率 $R_g = \\int_{\\Omega} \\Sigma_{x,g}(\\mathbf{r}) \\, \\phi_g(\\mathbf{r}) \\, \\mathrm{d}V$，以及从组件内通量推断出的无限介质增殖因子 $k_{\\infty}$。从上述中子平衡和边界耦合的定义出发，论证每种环境模型的能谱和空间保真度。在下列哪种情况下，与基于标量曲率的泄漏修正相比，与堆芯环境的反照率耦合通常会在燃耗依赖的反应率和 $k_{\\infty}$ 上产生更低的误差？\n\nA. 目标组件与强反射层和水隙相邻，且相邻的控制棒在循环的一部分时间内部分插入，产生能量依赖的背向散射和随燃耗演化的显著泄漏角度各向异性。\n\nB. 堆芯径向均匀、非常大，且净泄漏很小；散射近似各向同性，不存在控制材料，慢化剂条件固定，因此曲率可以近似为空间和能谱上是均匀的。\n\nC. 热工水力反馈导致慢化剂密度和温度随燃耗在组件边界周围变化，从而引起局部的能谱硬化或软化，以及随时间变化的、依赖于群的返回中子流。\n\nD. 混合氧化物（MOX）和二氧化铀（UO$_2$）组件交错布置，在燃耗过程中产生持续的组件间能谱梯度和边界附近不可分离的通量形状。\n\nE. 组件被建模为具有真空边界条件的无限栅格，且附近没有非均匀性；泄漏被处理为边界 $\\partial \\Omega$ 上的零入射通量，且曲率在整个区域内是均匀的。\n\n选择所有适用项。",
            "solution": "用户希望对栅格物理燃耗计算中两种常见模型——标量曲率和反照率耦合——进行批判性评估，以确定在哪种条件下反照率方法更为准确。\n\n### 步骤1：提取已知条件\n\n-   **背景**：针对单个压水堆（PWR）燃料组件的栅格物理燃耗计算。\n-   **目标**：通过对周围堆芯环境影响的建模，准确预测依赖于燃耗的反应率 $R_g$ 和无限介质增殖因子 $k_{\\infty}$。\n-   **模型1（标量曲率）**：应用于中子扩散方程的体积泄漏模型。\n    -   泄漏算符 $-\\nabla \\cdot D_g \\nabla \\phi_g(\\mathbf{r})$ 被修改为 $-\\nabla \\cdot D_g \\nabla \\phi_g(\\mathbf{r}) - D_g B^2 \\phi_g(\\mathbf{r})$。\n    -   $D_g$ 是第 $g$ 群的扩散系数。\n    -   $\\phi_g(\\mathbf{r})$ 是第 $g$ 群的标量通量。\n    -   $B^2$ 是曲率参数，明确定义为“一个假定在组件内空间和能谱上均匀的全堆芯曲率参数”。\n-   **模型2（反照率耦合）**：一种边界条件模型。\n    -   输运形式：入射角通量 $\\psi^{-}$ 通过 $\\psi^{-}_g = a_g \\, \\psi^{+}_g$ 与边界 $\\partial \\Omega$ 上的出射角通量 $\\psi^{+}$ 相关联。反照率 $a_g$ 可依赖于能量（$E$）、角度（$\\mathbf{\\Omega}$）、位置（$\\mathbf{r} \\in \\partial \\Omega$）和燃耗状态。\n    -   扩散形式：罗宾型（Robin-type）边界条件，$-D_g \\, \\partial \\phi_g / \\partial n = \\alpha_g \\, \\phi_g$ 作用于边界 $\\partial \\Omega$ 上，其中 $\\alpha_g$ 是一个依赖于群的耦合系数。\n-   **问题**：确定在哪种条件下，反照率耦合模型（模型2）比标量曲率模型（模型1）能更准确地预测 $R_g$ 和 $k_{\\infty}$。\n\n### 步骤2：使用提取的已知条件进行验证\n\n问题陈述在科学上是合理的、适定的和客观的。\n\n1.  **科学依据**：该问题描述了核反应堆堆芯分析中用于近似单个组件中子环境的两种标准、既定方法。底层物理概念——中子输运、扩散理论、燃耗、曲率、反照率、反应率和 $k_{\\infty}$——是反应堆物理的基石。描述是准确的，不含伪科学。\n2.  **适定性**：该问题要求对两种模型在不同物理场景下的保真度进行定性比较。这是工程和应用物理中的标准练习，其中必须理解不同模型的假设和局限性。可以基于这些原则构建一个明确、合理的答案。\n3.  **客观性**：对模型和物理场景的描述是技术性的、明确的。问题寻求基于物理原理对模型准确性进行客观评估，而非主观意见。\n\n该问题不含科学或事实上的不合理之处，是可形式化的，与所述主题直接相关，是自洽的，是物理上现实的，并且结构良好。\n\n### 步骤3：结论与行动\n\n问题陈述是**有效的**。将通过分析每个模型的基本假设，并评估其对选项中提出的场景的适用性来推导出解决方案。\n\n### 求解与选项分析\n\n两种模型之间的根本区别在于它们如何表示中子泄漏。\n\n**标量曲率模型**是一种基于强简化假设的体积方法。它假定组件的净泄漏可以用一个与局部通量成正比的空间均匀移出项 $-D_g B^2 \\phi_g(\\mathbf{r})$ 来近似。如前所述，其关键假设是曲率参数 $B^2$ 在*空间和能谱上是均匀的*。这意味着环境是均匀的，并且泄漏特性不随中子能量或组件内位置发生显著变化。该模型最适用于位于大型均匀堆芯深处、远离任何非均匀性的组件，在这种情况下，通量形状可被认为是可分离的，并且可以用全局基波模式很好地描述。\n\n**反照率耦合模型**是一种基于表面的方法。它明确地模拟了中子在组件物理边界 $\\partial \\Omega$ 上的反射。其主要优点是灵活性。反照率 $a_g$（或相关系数 $\\alpha_g$）可以指定为能群、边界位置、入射角和燃耗的函数。这使其能够捕捉复杂的、非均匀的边界效应，例如不同类型的相邻组件、来自反射层的能量依赖反射，或通过水隙的各向异性流。\n\n在任何严重违反曲率模型的空间和能谱均匀性核心假设的情况下，反照率模型通常会比标量曲率模型更准确。这种情况发生在存在强环境非均匀性的地方，这些非均匀性在组件边界上施加了非均匀、能量依赖或各向异性的条件。\n\n我们现在根据这一原则评估每个选项。\n\n**A. 目标组件与强反射层和水隙相邻，且相邻的控制棒在循环的一部分时间内部分插入，产生能量依赖的背向散射和随燃耗演化的显著泄漏角度各向异性。**\n该场景呈现了对曲率模型假设的多种强烈违反：\n-   **强反射层**：反射层返回的中子能谱比其接收的能谱要软得多（更热化）。这使得返回的中子流具有高度的*能量依赖性*。一个能谱均匀的 $B^2$ 无法模拟这一点。需要一个具有群依赖 $a_g$ 的反照率模型。\n-   **水隙**：这些区域会促进中子流，这是一种以中子通量中强烈的*角度各向异性*为特征的输运效应。反照率模型在其输运形式下可以捕捉到这一点，而基于扩散的曲率模型则不能。\n-   **相邻的控制棒**：它们是强烈的、局部的热中子吸收体，在边界处产生严重的空间和能谱梯度。控制棒附近的边界条件会发生剧烈变化。\n-   **随燃耗演化**：控制棒的部分插入和相邻组件的燃耗意味着边界条件是*时间依赖的*。反照率模型可以使用依赖于燃耗的系数来跟踪这种演化。一个恒定的 $B^2$ 则不能。\n这是一个典型的复杂环境示例，其中反照率模型详细的边界处理对于保证准确性是必需的。\n**结论：正确。**\n\n**B. 堆芯径向均匀、非常大，且净泄漏很小；散射近似各向同性，不存在控制材料，慢化剂条件固定，因此曲率可以近似为空间和能谱上是均匀的。**\n该场景描述了曲率模型适用性的理想条件。在大型、均匀（渐近）介质中，通量可以很好地用扩散方程的基波模式解来近似，对于该解，单个恒定的曲率参数 $B^2$ 是泄漏的正确表示。环境是均匀且可预测的。反照率模型增加的复杂性在准确性上带来的提升可以忽略不计。这是曲率模型预期表现最佳而非更差的场景。\n**结论：不正确。**\n\n**C. 热工水力反馈导致慢化剂密度和温度随燃耗在组件边界周围变化，从而引起局部的能谱硬化或软化，以及随时间变化的、依赖于群的返回中子流。**\n该场景在边界处引入了随时间（燃耗）演化的非均匀性。\n-   **变化的慢化剂密度和温度**：慢化剂性质的改变直接影响其中子的散射和反射特性。这导致边界条件在空间上不均匀。\n-   **局部的能谱硬化或软化**：这是一个明确的*能量依赖*效应。\n-   **随时间变化的、依赖于群的返回中子流**：这个陈述完美地概括了一种需要反照率模型的情况。边界的反射特性既是群依赖的（$a_g$）也是燃耗依赖的（$a_g(t)$）。单个恒定的 $B^2$ 无法捕捉这些在边界上局部的、演化的能谱效应。\n**结论：正确。**\n\n**D. 混合氧化物（MOX）和二氧化铀（UO$_2$）组件交错布置，在燃耗过程中产生持续的组件间能谱梯度和边界附近不可分离的通量形状。**\n该场景涉及到由不同相邻燃料类型引起的强非均匀性。\n-   **MOX 和 UO$_2$ 组件**：这些燃料类型具有截然不同的中子能谱。MOX燃料具有较硬的能谱和显著的钚共振峰，而UO$_2$燃料的能谱较软。\n-   **交错布置**：一个组件的一侧可能与MOX组件相邻，另一侧与UO$_2$组件相邻。这会产生强烈的、*空间非均匀*且*依赖于能谱*的边界条件。将会有从MOX到UO$_2$的快中子净流和从UO$_2$到MOX的热中子净流。\n-   **不可分离的通量形状**：作为曲率模型基础的通量可分离性假设，在不同材料的界面处会失效。通量形状和能谱是强耦合的。\n单个 $B^2$ 无法表示这种复杂的、依赖于面的能谱交换。需要一个在每个面上具有不同、群依赖边界条件的反照率模型，来准确地模拟环境。\n**结论：正确。**\n\n**E. 组件被建模为具有真空边界条件的无限栅格，且附近没有非均匀性；泄漏被处理为边界 $\\partial \\Omega$ 上的零入射通量，且曲率在整个区域内是均匀的。**\n这个选项有问题。“无限栅格”意味着周期性或反射性边界条件（零净流），而“真空边界条件”（$\\psi^- = 0$）则意味着一个处于真空中的有限系统。假设其意图是在一个其他方面均质的环境中（“附近没有非均匀性”、“曲率均匀”）模拟一个具有真空边界条件的单个组件，这是一个高度理想化的场景。真空边界条件本身就是一个简单的反照率模型，其中所有群的 $a_g = 0$。曲率模型会通过找到一个能再现总泄漏的 $B^2$ 来近似这种情况。在这样一个简化的、均匀的环境中，曲率近似很可能是相当准确的，类似于选项B中的情况。这并非一种以复杂环境效应为特征、要求反照率模型具有优越性的情况。实际上，“没有非均匀性”和“曲率均匀”的前提明确指向了曲率模型被设计用来工作的条件。\n**结论：不正确。**\n\n总之，在组件边界条件存在显著空间、能谱、角度或时间变化的场景中，反照率模型显示出其优越性。选项 A、C 和 D 描述了此类场景。",
            "answer": "$$\\boxed{ACD}$$"
        },
        {
            "introduction": "本练习将理论付诸实践，要求您在一个二维矩形栅元中求解一个混合边界条件下的中子扩散方程。通过在一个方向上施加周期性边界条件，在另一个方向上施加反照率边界条件，您需要推导出系统的最低几何巴克林 $B^2$。这个计算过程不仅能巩固您对分离变量法和本征值问题求解的掌握，还能具体展示这两种边界条件如何共同决定中子通量的空间分布和系统的临界状态 。",
            "id": "4213712",
            "problem": "考虑一个表示重复晶格单元的二维矩形区域中的均匀、稳态、单能中子场。设空间坐标为 $x \\in [-L/2, L/2]$ 和 $y \\in [0, H]$。介质具有恒定的扩散系数 $D$ 和单能材料性质。从中子平衡和菲克定律（$\\mathbf{J} = -D \\nabla \\phi$）出发，在临界条件（$k = 1$）下，通量形状 $\\phi(x,y)$ 的稳态单群扩散方程可简化为亥姆霍兹形式的形状方程\n$$\n\\nabla^{2} \\phi + B^{2} \\phi = 0,\n$$\n其中 $B^{2}$ 是（尚待确定的）几何曲率。边界条件如下：\n- 沿 $y = 0$ 和 $y = H$，施加一个相移为 $\\theta$ 的佛洛凯型周期性边界条件 (PBC)，即 $\\phi(x, y+H) = \\phi(x, y) \\exp(i \\theta)$ 和 $\\partial \\phi/\\partial y (x, y+H) = \\exp(i \\theta) \\, \\partial \\phi/\\partial y (x, y)$。在本问题中，设 $\\theta = \\pi$ 弧度。\n- 沿 $x = \\pm L/2$，施加一个反照率边界条件 (ABC)，在扩散模型中它被建模为一个从广义反照率概念推导出的罗宾边界条件：$D \\, \\partial \\phi/\\partial n + h \\, \\phi = 0$，其中 $\\partial/\\partial n$ 是沿外法线方向的导数，$h$ 是一个已知的、依赖于几何形状和材料的无量纲表面参数，通过输运到扩散匹配得到。\n\n假设变量可分离，并确定与这些边界条件相符的最小容许几何曲率 $B^{2}$。使用以下物理上合理的参数：\n- $L = 0.50~\\mathrm{m}$,\n- $H = 0.30~\\mathrm{m}$,\n- $D = 0.030~\\mathrm{m}$,\n- $h = 0.060$,\n- $\\theta = \\pi$ 弧度。\n\n以 $\\mathrm{m}^{-2}$ 为单位提供最终的 $B^{2}$ 值，并将答案四舍五入至四位有效数字。",
            "solution": "该问题要求确定在二维矩形区域内中子通量分布 $\\phi(x,y)$ 的最小容许几何曲率 $B^2$。控制方程是稳态单群中子扩散方程，对于临界系统（$k=1$），该方程呈亥姆霍兹形式：\n$$\n\\nabla^{2} \\phi + B^{2} \\phi = 0 \\quad \\implies \\quad \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2} + B^2 \\phi = 0\n$$\n区域由空间坐标 $x \\in [-L/2, L/2]$ 和 $y \\in [0, H]$ 定义。该问题将使用分离变量法求解，为此我们假设解的形式为 $\\phi(x,y) = X(x)Y(y)$。将此形式代入亥姆霍兹方程，然后除以乘积 $X(x)Y(y)$，得到：\n$$\n\\frac{1}{X(x)}\\frac{d^2 X}{dx^2} + \\frac{1}{Y(y)}\\frac{d^2 Y}{dy^2} + B^2 = 0\n$$\n由于第一项仅是 $x$ 的函数，第二项仅是 $y$ 的函数，它们的和要为一个常数（$-B^2$），唯一的可能是每一项本身都是一个常数。我们将这些分离常数定义为 $-B_x^2$ 和 $-B_y^2$：\n$$\n\\frac{1}{X(x)}\\frac{d^2 X}{dx^2} = -B_x^2 \\quad \\implies \\quad \\frac{d^2 X}{dx^2} + B_x^2 X = 0\n$$\n$$\n\\frac{1}{Y(y)}\\frac{d^2 Y}{dy^2} = -B_y^2 \\quad \\implies \\quad \\frac{d^2 Y}{dy^2} + B_y^2 Y = 0\n$$\n总几何曲率是这些分量曲率的代数和：$B^2 = B_x^2 + B_y^2$。为了找到最低的总曲率，我们必须求解这两个常微分方程 (ODE)，并考虑它们各自的边界条件，以找到最低的容许本征值 $B_x^2$ 和 $B_y^2$。通过分析我们已经证明 $B_x^2$ 和 $B_y^2$ 都必须为正。\n\n我们首先分析 $y$ 维度。常微分方程为 $Y''(y) + B_y^2 Y(y) = 0$。边界条件是相移为 $\\theta = \\pi$ 的佛洛凯型周期性边界条件。这意味着 $\\phi(x, y+H) = \\phi(x, y) \\exp(i\\pi) = -\\phi(x, y)$，对于分离后的函数 $Y(y)$，这变成了一个反周期性边界条件：\n$$\nY(y+H) = -Y(y)\n$$\n该常微分方程的通解为 $Y(y) = A \\exp(iB_y y) + C \\exp(-iB_y y)$。应用反周期性条件要求 $\\exp(iB_y H) = -1$。这个等式意味着 $B_y H$ 必须是 $\\pi$ 的奇数倍：\n$$\nB_y H = (2n+1)\\pi, \\quad n \\in \\{0, 1, 2, \\dots\\}\n$$\n$y$ 方向的曲率分量因此为 $B_y^2 = \\left(\\frac{(2n+1)\\pi}{H}\\right)^2$。$B_y^2$ 的最低可能正值可以通过取基模（对应于 $n=0$）找到：\n$$\nB_y^2 = \\left(\\frac{\\pi}{H}\\right)^2\n$$\n代入给定值 $H = 0.30~\\mathrm{m}$：\n$$\nB_y^2 = \\left(\\frac{\\pi}{0.30}\\right)^2 \\approx (10.4719755)^2 \\approx 109.66228~\\mathrm{m}^{-2}\n$$\n接下来，我们分析 $x$ 维度。常微分方程为 $X''(x) + B_x^2 X(x) = 0$。反照率边界条件为 $D \\, \\partial \\phi/\\partial n + h \\, \\phi = 0$。\n在 $x = L/2$ 处，外法线向量在 $+x$ 方向，所以 $\\partial/\\partial n = \\partial/\\partial x$。对 $X(x)$ 的条件是 $D X'(L/2) + h X(L/2) = 0$。\n在 $x = -L/2$ 处，外法线在 $-x$ 方向，所以 $\\partial/\\partial n = -\\partial/\\partial x$。条件是 $-D X'(-L/2) + h X(-L/2) = 0$，这等价于 $D X'(-L/2) - h X(-L/2) = 0$。\n该常微分方程的通解为 $X(x) = C_1 \\cos(B_x x) + C_2 \\sin(B_x x)$。区域和边界条件的对称性允许我们分别考虑偶解和奇解。\n对于偶解，$X(x) = C_1 \\cos(B_x x)$，其导数为 $X'(x) = -C_1 B_x \\sin(B_x x)$。在 $x = L/2$ 处应用边界条件得到 $-D C_1 B_x \\sin(B_x L/2) + h C_1 \\cos(B_x L/2) = 0$。对于非平凡解（$C_1 \\neq 0$），这简化为超越方程：\n$$\nD B_x \\tan\\left(\\frac{B_x L}{2}\\right) = h\n$$\n对于奇解，$X(x) = C_2 \\sin(B_x x)$，其导数为 $X'(x) = C_2 B_x \\cos(B_x x)$。在 $x=L/2$ 处的边界条件得到 $D C_2 B_x \\cos(B_x L/2) + h C_2 \\sin(B_x L/2) = 0$。对于 $C_2 \\neq 0$，这给出：\n$$\nD B_x \\cot\\left(\\frac{B_x L}{2}\\right) = -h\n$$\n为了找到最低本征值 $B_x^2$，我们必须找到满足这两个方程中任意一个的最小正值 $B_x$。设 $\\eta = B_x L/2$。方程变为：\n偶模：$\\tan(\\eta) = \\frac{hL}{2D} \\frac{1}{\\eta}$\n奇模：$\\tan(\\eta) = -\\frac{2D}{hL} \\eta$\n由于 $D$、$h$ 和 $L$ 均为正值，图形分析显示偶模方程的最小正根 $\\eta$ 位于区间 $(0, \\pi/2)$ 内，而奇模方程的最小正根位于 $(\\pi/2, \\pi)$ 内。因此，对应于最低本征值 $B_x^2$ 的基模是一个偶解。\n我们求解偶模的特征方程。首先，根据给定的罗宾边界条件 $D \\partial \\phi/\\partial n + h \\phi = 0$，其中 $D$ 的单位是长度 [m] 而 $h$ 是无量纲的，存在量纲不一致。物理上一致的罗宾边界条件应为 $D \\partial \\phi/\\partial n + \\gamma \\phi = 0$，其中 $\\gamma$ 的单位是 [m/s]。然而，在扩散理论中，通常将 $h$ 定义为具有与 $D/L$ 相同单位的系数，或者将方程写为 $L_{extrap} \\partial \\phi/\\partial n + \\phi = 0$。在此，我们遵循问题中参数的量纲，假设预期的物理模型是 $\\tan(\\eta) = C/\\eta$ 的形式，其中 $C$ 是一个无量纲常数。\n让我们计算这个常数 $C = \\frac{hL}{2D}$。代入给定值：$L=0.50~\\mathrm{m}$，$D=0.030~\\mathrm{m}$ 和 $h=0.060$ (无量纲)。\n$$\nC = \\frac{hL}{2D} = \\frac{0.060 \\times 0.50}{2 \\times 0.030} = \\frac{0.030}{0.060} = 0.5\n$$\n这个常数是无量纲的，这是正确的。因此，需要求解的方程是：\n$$\n\\eta\\tan(\\eta) = 0.5\n$$\n这个超越方程需要数值求解。其最小正根为：\n$$\n\\eta \\approx 0.653031\n$$\n由此，我们计算 $B_x$ 和 $B_x^2$：\n$$\nB_x = \\frac{2\\eta}{L} = \\frac{2 \\times 0.653031}{0.50} = 4 \\times 0.653031 \\approx 2.612124~\\mathrm{m}^{-1}\n$$\n$$\nB_x^2 = (2.612124)^2 \\approx 6.82319~\\mathrm{m}^{-2}\n$$\n总几何曲率 $B^2$ 是各分量之和：\n$$\nB^2 = B_x^2 + B_y^2 \\approx 6.82319~\\mathrm{m}^{-2} + 109.66228~\\mathrm{m}^{-2} = 116.48547~\\mathrm{m}^{-2}\n$$\n问题要求将结果四舍五入至四位有效数字。\n$$\nB^2 \\approx 116.5~\\mathrm{m}^{-2}\n$$",
            "answer": "$$\n\\boxed{116.5}\n$$"
        },
        {
            "introduction": "尽管解析解能提供深刻的物理洞察，但现代反应堆模拟的核心是数值方法。此练习提供了一个绝佳的编程实践机会，要求您使用有限差分法（FDM）和有限元法（FEM）这两种主流数值技术，来求解包含反照率和周期性边界条件的一维中子扩散方程。通过亲手实现并对比这两种方法的结果，您将获得在计算模拟中处理复杂边界条件的宝贵实践经验 。",
            "id": "4213703",
            "problem": "考虑一个一维空间中的均匀、各向同性介质，其中标量中子通量 $ \\phi(x) $ 满足由中子守恒和 Fick 扩散定律推导出的稳态中子扩散方程：\n$$ -\\frac{d}{dx}\\left(D \\frac{d \\phi}{dx}\\right) + \\Sigma_a \\phi = S, \\quad x \\in (0,L). $$\n这里 $ D $ 是扩散系数，单位为 $\\mathrm{cm}$；$ \\Sigma_a $ 是宏观吸收截面，单位为 $\\mathrm{cm}^{-1}$；$ S $ 是一个恒定的体积源，单位为 $\\mathrm{n}/(\\mathrm{cm}^3\\cdot \\mathrm{s})$；$ L $ 是平板厚度，单位为 $\\mathrm{cm}$。总中子流为 $ J = -D \\frac{d \\phi}{dx} $。\n\n考虑两种边界条件类型：\n- Robin（反照率）边界条件：在边界点上 $ -D \\frac{d \\phi}{dn} = r \\phi $，其中 $ \\frac{d}{dn} $ 是外法向导数，$ r $ 是一个无量纲的反照率系数。该边界条件模拟了具有按比例返回特性的部分泄漏，其特征由 $ r $ 决定。在左边界 $ x = 0 $ 处（外法线指向负 $ x $ 方向），这意味着 $ \\frac{d \\phi}{dx}(0) = \\frac{r_0}{D} \\phi(0) $。在右边界 $ x = L $ 处（外法线指向正 $ x $ 方向），这意味着 $ \\frac{d \\phi}{dx}(L) = -\\frac{r_L}{D} \\phi(L) $。\n- 周期性边界条件：$ \\phi(0) = \\phi(L) $ 和 $ \\frac{d \\phi}{dx}(0) = \\frac{d \\phi}{dx}(L) $，表示具有平移不变性的环形拓扑。\n\n请在均匀网格上实现两种用于求解 $ \\phi(x) $ 的数值求解器：\n- 有限差分法 (FDM)：对内部使用二阶中心差分近似，并使用鬼点强制施加 Robin 边界条件，以确保边界处的二阶相容性。对于周期性边界，将离散模板中的第一个和最后一个节点连接起来。\n- 有限元法 (FEM)：在相同的均匀剖分上，使用带有分段线性形函数的 Galerkin 方法。通过将控制方程乘以一个测试函数 $ v $，在定义域上积分，并对扩散项进行分部积分来获得弱形式，从而得到一个由刚度项 $\\int_0^L D \\frac{d \\phi}{dx}\\frac{d v}{dx}\\,dx$、吸收项 $\\int_0^L \\Sigma_a \\phi v \\, dx$ 和源项 $\\int_0^L S v \\, dx$ 组成的双线性形式。对于 Robin 条件，包括边界贡献 $ \\int_{\\partial \\Omega} r \\phi v \\, d\\Gamma $，在一维情况下，这会在 $ x=0 $ 处向全局矩阵添加 $ r_0 \\phi(0)v(0) $，在 $ x=L $ 处添加 $ r_L \\phi(L)v(L) $。对于周期性条件，通过合并相应的自由度来强制执行 $ \\phi(0) = \\phi(L) $，并通过在合并的拓扑上进行组装来隐式地强制执行导数的周期性。\n\n您的程序必须为下面的每个测试用例构建 FDM 和 FEM 离散系统，求解它们，然后计算 FDM 和 FEM 通量解在节点网格上的相对离散 $ L^2 $-范数差异：\n$$ \\delta = \\frac{\\left\\| \\phi^{\\mathrm{FDM}} - \\phi^{\\mathrm{FEM}} \\right\\|_2}{\\left\\| \\phi^{\\mathrm{FEM}} \\right\\|_2}, $$\n该值为无量纲。这里 $ \\| \\cdot \\|_2 $ 表示节点值上的欧几里得范数。对于周期性 FEM，通过适当复制合并的自由度来重建一个长度为 $ N $ 的节点向量，以便与 FDM 的比较是在同一组节点上进行的。\n\n使用以下测试套件，每个套件由 $ (L, N, D, \\Sigma_a, S, \\text{BC type}, r_0, r_L) $ 指定：\n- 测试 $1$：$ (100\\,\\mathrm{cm}, 101, 1.2\\,\\mathrm{cm}, 0.08\\,\\mathrm{cm}^{-1}, 1.0\\,\\mathrm{n}/(\\mathrm{cm}^3\\cdot \\mathrm{s}), \\text{robin}, 0.0, 0.0) $。\n- 测试 $２$：$ (100\\,\\mathrm{cm}, 101, 1.2\\,\\mathrm{cm}, 0.08\\,\\mathrm{cm}^{-1}, 1.0\\,\\mathrm{n}/(\\mathrm{cm}^3\\cdot \\mathrm{s}), \\text{robin}, 10^6, 10^6) $。\n- 测试 $３$：$ (100\\,\\mathrm{cm}, 101, 1.2\\,\\mathrm{cm}, 0.08\\,\\mathrm{cm}^{-1}, 1.0\\,\\mathrm{n}/(\\mathrm{cm}^3\\cdot \\mathrm{s}), \\text{robin}, 0.5, 0.1) $。\n- 测试 $４$：$ (100\\,\\mathrm{cm}, 101, 1.2\\,\\mathrm{cm}, 0.08\\,\\mathrm{cm}^{-1}, 1.0\\,\\mathrm{n}/(\\mathrm{cm}^3\\cdot \\mathrm{s}), \\text{periodic}, -, -) $；对于周期性情况，忽略 $ r_0 $ 和 $ r_L $。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，$ [\\delta_1,\\delta_2,\\delta_3,\\delta_4] $），其中 $ \\delta_i $ 是测试 $ i $ 的相对 $ L^2 $-范数差异。输出不需要单位，因为 $ \\delta_i $ 是无量纲的。",
            "solution": "该问题要求使用两种不同的方法——有限差分法（FDM）和有限元法（FEM）——对均匀介质中的一维稳态中子扩散方程进行数值求解。对于一系列涉及不同边界条件的测试用例，将对这两种方法的结果进行比较。\n\n控制方程为：\n$$ -D \\frac{d^2 \\phi}{dx^2} + \\Sigma_a \\phi = S, \\quad x \\in (0,L) $$\n其中 $D$、$\\Sigma_a$ 和 $S$ 是常数。定义域使用由 $N$ 个点 $x_i = i h$（$i=0, 1, \\dots, N-1$）组成的均匀网格进行离散化，其中网格间距为 $h = L/(N-1)$。未知量是节点通量值的向量 $\\boldsymbol{\\phi} = [\\phi_0, \\phi_1, \\dots, \\phi_{N-1}]^T$，其中 $\\phi_i \\approx \\phi(x_i)$。\n\n### 有限差分法 (FDM) 离散化\n\nFDM 近似节点处的导数。对于内部节点 $x_i$（$1 \\le i \\le N-2$），使用二阶中心差分近似来计算二阶导数：\n$$ \\frac{d^2 \\phi}{dx^2}\\bigg|_{x_i} \\approx \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2} $$\n将此代入控制方程，得到内部节点的离散方程：\n$$ -D \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2} + \\Sigma_a \\phi_i = S $$\n整理后得到线性系统 $A^{\\text{FDM}}\\boldsymbol{\\phi} = b^{\\text{FDM}}$ 的模板：\n$$ \\left(\\frac{-D}{h^2}\\right)\\phi_{i-1} + \\left(\\frac{2D}{h^2} + \\Sigma_a\\right)\\phi_i + \\left(\\frac{-D}{h^2}\\right)\\phi_{i+1} = S $$\n\n**Robin 边界条件：**\n问题在 $x=0$ 和 $x=L$ 处指定了 Robin 边界条件：\n$$ \\frac{d \\phi}{dx}(0) = \\frac{r_0}{D} \\phi(0) \\quad \\text{和} \\quad \\frac{d \\phi}{dx}(L) = -\\frac{r_L}{D} \\phi(L) $$\n为了保持二阶精度，我们采用鬼点。\n在 $x_0=0$ 处，我们在 $x_{-1} = -h$ 处引入一个鬼点。在 $x_0$ 处的中心差分导数近似为 $\\frac{\\phi_1 - \\phi_{-1}}{2h} = \\frac{r_0}{D}\\phi_0$，这给出 $\\phi_{-1} = \\phi_1 - \\frac{2hr_0}{D}\\phi_0$。我们将其代入在 $i=0$ 处计算的标准扩散方程模板中：\n$$ -D \\frac{\\phi_{-1} - 2\\phi_0 + \\phi_1}{h^2} + \\Sigma_a \\phi_0 = S \\implies -D \\frac{(\\phi_1 - \\frac{2hr_0}{D}\\phi_0) - 2\\phi_0 + \\phi_1}{h^2} + \\Sigma_a \\phi_0 = S $$\n这简化为线性系统的第一行：\n$$ \\left(\\frac{2D}{h^2} + \\frac{2r_0}{h} + \\Sigma_a\\right)\\phi_0 - \\frac{2D}{h^2}\\phi_1 = S $$\n类似地，在 $x_{N-1}=L$ 处，位于 $x_N=L+h$ 的鬼点产生系统的最后一行：\n$$ -\\frac{2D}{h^2}\\phi_{N-2} + \\left(\\frac{2D}{h^2} + \\frac{2r_L}{h} + \\Sigma_a\\right)\\phi_{N-1} = S $$\n得到的系统是一个 $N \\times N$ 的三对角系统。源向量 $b^{\\text{FDM}}$ 是一个所有元素均为 $S$ 的向量。\n\n**周期性边界条件：**\n条件为 $\\phi(0) = \\phi(L)$ 和 $\\phi'(0) = \\phi'(L)$。在离散网格上，这意味着 $\\phi_0 = \\phi_{N-1}$。这将独立未知数的数量减少到 $N-1$ 个。我们求解 $\\tilde{\\boldsymbol{\\phi}} = [\\phi_0, \\dots, \\phi_{N-2}]^T$。周期性意味着节点 $0$ 左侧的邻居是节点 $N-2$，节点 $N-2$ 右侧的邻居是节点 $0$。在 $i=0$ 处的模板变为：\n$$ \\left(\\frac{-D}{h^2}\\right)\\phi_{N-2} + \\left(\\frac{2D}{h^2} + \\Sigma_a\\right)\\phi_0 + \\left(\\frac{-D}{h^2}\\right)\\phi_1 = S $$\n在 $i=N-2$ 处：\n$$ \\left(\\frac{-D}{h^2}\\right)\\phi_{N-3} + \\left(\\frac{2D}{h^2} + \\Sigma_a\\right)\\phi_{N-2} + \\left(\\frac{-D}{h^2}\\right)\\phi_0 = S $$\n这导致一个 $(N-1) \\times (N-1)$ 的循环三对角系统。求解 $\\tilde{\\boldsymbol{\\phi}}$ 后，完整的 $N$ 点解向量被重构为 $\\boldsymbol{\\phi}^{\\text{FDM}} = [\\phi_0, \\dots, \\phi_{N-2}, \\phi_0]^T$。\n\n### 有限元法 (FEM) 离散化\n\nFEM 采用 Galerkin 方法。我们将扩散方程乘以一个测试函数 $v(x)$，并在定义域 $[0, L]$ 上积分。对扩散项进行分部积分得到弱形式：\n$$ \\int_0^L D \\frac{d\\phi}{dx} \\frac{dv}{dx} \\,dx + \\int_0^L \\Sigma_a \\phi v \\,dx - \\left[D \\frac{d\\phi}{dx} v\\right]_0^L = \\int_0^L S v \\,dx $$\n代入 Robin 边界条件 $D\\frac{d\\phi}{dx}(0) = r_0\\phi(0)$ 和 $-D\\frac{d\\phi}{dx}(L) = r_L\\phi(L)$，得到：\n$$ \\underbrace{\\int_0^L D \\frac{d\\phi}{dx} \\frac{dv}{dx} \\,dx + \\int_0^L \\Sigma_a \\phi v \\,dx + r_L \\phi(L)v(L) + r_0 \\phi(0)v(0)}_{a(\\phi, v)} = \\underbrace{\\int_0^L S v \\,dx}_{l(v)} $$\n通量 $\\phi(x)$ 由分段线性基函数（“帽函数”）$\\psi_j(x)$ 的线性组合来近似，即 $\\phi(x) \\approx \\sum_{j=0}^{N-1} \\phi_j \\psi_j(x)$，其中 $\\psi_j(x_i) = \\delta_{ij}$。将这些基函数也用作测试函数（$v = \\psi_i$），我们得到线性系统 $A^{\\text{FEM}}\\boldsymbol{\\phi} = b^{\\text{FEM}}$，其中 $A_{ij} = a(\\psi_j, \\psi_i)$，$b_i = l(\\psi_i)$。\n\n在均匀网格上，对于长度为 $h$ 的单元，单元刚度矩阵 $K^e$、质量矩阵 $M^e$ 和源向量 $F^e$ 分别为：\n$$ K^e = \\frac{D}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}, \\quad M^e = \\frac{\\Sigma_a h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}, \\quad F^e = \\frac{Sh}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n全局矩阵是通过对这些单元贡献求和来组装的。\n\n**Robin 边界条件：**\n系统是 $N \\times N$ 的。组装后的矩阵 $A^{\\text{FEM}}$ 是三对角且对称的。\n对于内部行 $i$：\n$$ \\left(-\\frac{D}{h} + \\frac{h\\Sigma_a}{6}\\right)\\phi_{i-1} + \\left(\\frac{2D}{h} + \\frac{2h\\Sigma_a}{3}\\right)\\phi_i + \\left(-\\frac{D}{h} + \\frac{h\\Sigma_a}{6}\\right)\\phi_{i+1} = Sh $$\n来自弱形式的边界项 $r_0\\phi(0)v(0)$ 和 $r_L\\phi(L)v(L)$ 仅对边界节点的对角元有贡献。具体来说，$r_0$ 加到 $A_{00}$ 上，$r_L$ 加到 $A_{N-1,N-1}$ 上。源向量的元素对于内部节点是 $b_i = Sh$，对于边界节点是 $b_i = Sh/2$。\n完整的边界方程为：\n$$ i=0: \\left(\\frac{D}{h} + \\frac{h\\Sigma_a}{3} + r_0\\right)\\phi_0 + \\left(-\\frac{D}{h} + \\frac{h\\Sigma_a}{6}\\right)\\phi_1 = \\frac{Sh}{2} $$\n$$ i=N-1: \\left(-\\frac{D}{h} + \\frac{h\\Sigma_a}{6}\\right)\\phi_{N-2} + \\left(\\frac{D}{h} + \\frac{h\\Sigma_a}{3} + r_L\\right)\\phi_{N-1} = \\frac{Sh}{2} $$\n\n**周期性边界条件：**\n节点 $0$ 和 $N-1$ 的自由度被合并，从而得到一个用于求解 $\\tilde{\\boldsymbol{\\phi}} = [\\phi_0, \\dots, \\phi_{N-2}]^T$ 的 $(N-1) \\times (N-1)$ 系统。组装过程将节点 $N-2$ 与节点 $0$ 连接起来，形成一个对称的循环三对角矩阵。对角元为 $A_{ii} = \\frac{2D}{h} + \\frac{2h\\Sigma_a}{3}$，非对角元为 $A_{i, i\\pm 1} = -\\frac{D}{h} + \\frac{h\\Sigma_a}{6}$（角元素作环绕处理）。源向量的所有元素均为 $b_i = Sh$。求解后，完整的解向量被重构为 $\\boldsymbol{\\phi}^{\\text{FEM}} = [\\phi_0, \\dots, \\phi_{N-2}, \\phi_0]^T$。\n\n### 解的比较\n\n对于每个测试用例，构建并求解 FDM 和 FEM 系统。然后使用得到的节点通量向量 $\\boldsymbol{\\phi}^{\\text{FDM}}$ 和 $\\boldsymbol{\\phi}^{\\text{FEM}}$ 来计算相对离散 $L^2$-范数差异：\n$$ \\delta = \\frac{\\left\\| \\boldsymbol{\\phi}^{\\mathrm{FDM}} - \\boldsymbol{\\phi}^{\\mathrm{FEM}} \\right\\|_2}{\\left\\| \\boldsymbol{\\phi}^{\\mathrm{FEM}} \\right\\|_2} = \\frac{\\sqrt{\\sum_{i=0}^{N-1} (\\phi_i^{\\mathrm{FDM}} - \\phi_i^{\\mathrm{FEM}})^2}}{\\sqrt{\\sum_{i=0}^{N-1} (\\phi_i^{\\mathrm{FEM}})^2}} $$\n该度量量化了两个数值解在节点网格上的差异。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve_fdm(L, N, D, Sigma_a, S, bc_type, r0, rL):\n    \"\"\"\n    Solves the 1D neutron diffusion equation using the Finite Difference Method.\n    \"\"\"\n    h = L / (N - 1)\n    \n    if bc_type == 'robin':\n        A = np.zeros((N, N))\n        b = np.full(N, S)\n        \n        # Interior points\n        c1 = -D / h**2\n        c2 = 2 * D / h**2 + Sigma_a\n        for i in range(1, N - 1):\n            A[i, i-1] = c1\n            A[i, i] = c2\n            A[i, i+1] = c1\n            \n        # Boundary at x=0\n        A[0, 0] = 2 * D / h**2 + 2 * r0 / h + Sigma_a\n        A[0, 1] = -2 * D / h**2\n        \n        # Boundary at x=L\n        A[N-1, N-2] = -2 * D / h**2\n        A[N-1, N-1] = 2 * D / h**2 + 2 * rL / h + Sigma_a\n        \n        phi = np.linalg.solve(A, b)\n        return phi\n\n    elif bc_type == 'periodic':\n        num_unknowns = N - 1\n        A = np.zeros((num_unknowns, num_unknowns))\n        b = np.full(num_unknowns, S)\n        \n        c1 = -D / h**2\n        c2 = 2 * D / h**2 + Sigma_a\n        \n        for i in range(num_unknowns):\n            A[i, i] = c2\n            A[i, (i - 1 + num_unknowns) % num_unknowns] += c1\n            A[i, (i + 1) % num_unknowns] += c1\n\n        phi_tilde = np.linalg.solve(A, b)\n        phi = np.append(phi_tilde, phi_tilde[0])\n        return phi\n\n    return None\n\ndef solve_fem(L, N, D, Sigma_a, S, bc_type, r0, rL):\n    \"\"\"\n    Solves the 1D neutron diffusion equation using the Finite Element Method.\n    \"\"\"\n    h = L / (N - 1)\n    \n    if bc_type == 'robin':\n        A = np.zeros((N, N))\n        b = np.zeros(N)\n        \n        # Interior points\n        diag = 2 * D / h + 2 * h * Sigma_a / 3\n        off_diag = -D / h + h * Sigma_a / 6\n        \n        for i in range(1, N - 1):\n            A[i, i-1] = off_diag\n            A[i, i] = diag\n            A[i, i+1] = off_diag\n            b[i] = S * h\n            \n        # Boundary at x=0\n        A[0, 0] = D / h + h * Sigma_a / 3 + r0\n        A[0, 1] = off_diag\n        b[0] = S * h / 2\n        \n        # Boundary at x=L\n        A[N-1, N-2] = off_diag\n        A[N-1, N-1] = D / h + h * Sigma_a / 3 + rL\n        b[N-1] = S * h / 2\n        \n        phi = np.linalg.solve(A, b)\n        return phi\n\n    elif bc_type == 'periodic':\n        num_unknowns = N - 1\n        A = np.zeros((num_unknowns, num_unknowns))\n        b = np.full(num_unknowns, S * h)\n\n        diag = 2 * D / h + 2 * h * Sigma_a / 3\n        off_diag = -D / h + h * Sigma_a / 6\n\n        for i in range(num_unknowns):\n            A[i, i] = diag\n            A[i, (i - 1 + num_unknowns) % num_unknowns] += off_diag\n            A[i, (i + 1) % num_unknowns] += off_diag\n            \n        phi_tilde = np.linalg.solve(A, b)\n        phi = np.append(phi_tilde, phi_tilde[0])\n        return phi\n\n    return None\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, N, D, Sigma_a, S, bc_type, r0, rL)\n        (100.0, 101, 1.2, 0.08, 1.0, 'robin', 0.0, 0.0),\n        (100.0, 101, 1.2, 0.08, 1.0, 'robin', 1e6, 1e6),\n        (100.0, 101, 1.2, 0.08, 1.0, 'robin', 0.5, 0.1),\n        (100.0, 101, 1.2, 0.08, 1.0, 'periodic', None, None),\n    ]\n\n    results = []\n    for L, N, D, Sigma_a, S, bc_type, r0, rL in test_cases:\n        phi_fdm = solve_fdm(L, N, D, Sigma_a, S, bc_type, r0, rL)\n        phi_fem = solve_fem(L, N, D, Sigma_a, S, bc_type, r0, rL)\n        \n        # Compute relative discrete L2-norm difference\n        diff_norm = np.linalg.norm(phi_fdm - phi_fem)\n        fem_norm = np.linalg.norm(phi_fem)\n        \n        relative_diff = diff_norm / fem_norm\n        results.append(relative_diff)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}