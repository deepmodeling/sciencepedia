{
    "hands_on_practices": [
        {
            "introduction": "To effectively apply variance reduction techniques, it is essential to first quantify their impact. This foundational exercise guides you through the derivation of the Variance Reduction Factor (VRF) for the Common Random Numbers (CRN) method in the context of a simplified neutron transport scenario. By establishing a direct mathematical link between the induced correlation $\\rho$ and the resulting VRF, you will gain a core insight into why correlated sampling is a powerful tool for efficiently estimating small differential effects. ",
            "id": "4219745",
            "problem": "Consider a one-speed neutron transport in a homogeneous slab of thickness $L$ with isotropic, straight-line flight. The free path length $s$ to the next interaction is exponentially distributed with the probability density function $f(s) = \\Sigma_{t} \\exp(-\\Sigma_{t} s)$, where $\\Sigma_{t}$ is the total macroscopic cross section. The probability that a neutron launched at one face exits the slab without interaction (transmission) is $T = \\exp(-\\Sigma_{t} L)$. Let a perturbed system have total macroscopic cross section $\\Sigma_{t}' = \\Sigma_{t} + \\delta \\Sigma$, with $|\\delta \\Sigma| \\ll \\Sigma_{t}$. Define the per-history transmission score in the baseline system as $X = \\mathbf{1}\\{s > L\\}$ and in the perturbed system as $Y = \\mathbf{1}\\{s' > L\\}$, where $s$ and $s'$ are sampled by inverse transform sampling from independent standard uniform random numbers $U$ and $U'$ via $s = -\\ln(U)/\\Sigma_{t}$ and $s' = -\\ln(U')/\\Sigma_{t}'$. The quantity of interest is the differential transmission $\\Delta T = T' - T$, estimated by the difference of sample means $\\widehat{\\Delta T} = \\overline{Y} - \\overline{X}$ from $n$ histories in each system.\n\nTwo sampling strategies are considered:\n1. Independent sampling: sample $\\{U_{i}\\}$ and $\\{U_{i}'\\}$ independently, producing independent $\\{X_{i}\\}$ and $\\{Y_{i}\\}$.\n2. Common Random Numbers (CRN): use the same $U_{i}$ to generate both $s_{i}$ and $s_{i}'$, inducing correlation between $X_{i}$ and $Y_{i}$.\n\nDefine the Variance Reduction Factor (VRF) as $\\mathrm{VRF} = \\mathrm{Var}_{\\text{indep}}(\\widehat{\\Delta T}) / \\mathrm{Var}_{\\text{CRN}}(\\widehat{\\Delta T})$. Starting from the definitions of variance, covariance, and correlation, and using only the properties of the exponential flight distribution and the indicator estimator, derive an expression for $\\mathrm{VRF}$ as a function of the per-history correlation coefficient $\\rho$ between paired scores under CRN in the regime of small differential effects where the per-history score variances in the two systems are equal. Then, compute the numerical value of $\\mathrm{VRF}$ when $\\rho = 0.9$. State any assumptions you require explicitly and ensure that all steps in your derivation are justified from first principles. The final numerical answer is dimensionless and does not require rounding.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n-   **System**: One-speed neutron transport in a homogeneous slab of thickness $L$.\n-   **Neutron Flight**: Isotropic, straight-line flight.\n-   **Free Path Length PDF**: $f(s) = \\Sigma_{t} \\exp(-\\Sigma_{t} s)$, where $\\Sigma_{t}$ is the total macroscopic cross section.\n-   **Baseline Transmission**: $T = \\exp(-\\Sigma_{t} L)$.\n-   **Perturbed System Cross Section**: $\\Sigma_{t}' = \\Sigma_{t} + \\delta \\Sigma$, with $|\\delta \\Sigma| \\ll \\Sigma_{t}$.\n-   **Per-history Baseline Score**: $X = \\mathbf{1}\\{s > L\\}$, an indicator function.\n-   **Per-history Perturbed Score**: $Y = \\mathbf{1}\\{s' > L\\}$, an indicator function.\n-   **Sampling**: Inverse transform sampling from standard uniform random numbers $U$ and $U'$.\n-   **Path Length Sampling Formulae**: $s = -\\ln(U)/\\Sigma_{t}$ and $s' = -\\ln(U')/\\Sigma_{t}'$.\n-   **Quantity of Interest**: $\\Delta T = T' - T$, where $T' = \\exp(-\\Sigma_{t}' L)$.\n-   **Estimator**: $\\widehat{\\Delta T} = \\overline{Y} - \\overline{X}$, where $\\overline{X}$ and $\\overline{Y}$ are sample means over $n$ histories.\n-   **Sampling Strategies**:\n    1.  Independent: $\\{U_{i}\\}$ and $\\{U_{i}'\\}$ are independent sets of random numbers.\n    2.  Common Random Numbers (CRN): The same random number $U_{i}$ is used to generate the paired scores $X_i$ and $Y_i$.\n-   **Definition**: Variance Reduction Factor, $\\mathrm{VRF} = \\mathrm{Var}_{\\text{indep}}(\\widehat{\\Delta T}) / \\mathrm{Var}_{\\text{CRN}}(\\widehat{\\Delta T})$.\n-   **Task 1**: Derive an expression for $\\mathrm{VRF}$ as a function of the per-history correlation coefficient $\\rho$ between paired scores under CRN.\n-   **Condition**: The derivation is to be performed in the regime of small differential effects where the per-history score variances in the two systems are assumed to be equal.\n-   **Task 2**: Compute the numerical value of $\\mathrm{VRF}$ for $\\rho = 0.9$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically and mathematically sound. It describes a standard, albeit simplified, problem in Monte Carlo particle transport simulation. The use of an exponential distribution for free path length, inverse transform sampling, and indicator function estimators are all fundamental concepts in this field. The study of differential effects using correlated sampling (specifically, Common Random Numbers) is a cornerstone of perturbation analysis in reactor physics. The problem is self-contained, with all necessary definitions and conditions provided. The assumption of equal variances for small perturbations is a standard and justifiable approximation. The question is well-posed and objective, leading to a unique and meaningful solution.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A complete, reasoned solution will be provided.\n\n### Derivation\n\nThe quantity to be estimated is the difference in transmission probability, $\\Delta T = T' - T$. The Monte Carlo estimator for this quantity, based on $n$ simulation histories, is $\\widehat{\\Delta T} = \\overline{Y} - \\overline{X}$. Here, $\\overline{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$ and $\\overline{Y} = \\frac{1}{n}\\sum_{i=1}^{n} Y_i$ are the sample means of the per-history scores for the baseline and perturbed systems, respectively.\n\nThe variance of this estimator is given by the general formula for the variance of a difference:\n$$\n\\mathrm{Var}(\\widehat{\\Delta T}) = \\mathrm{Var}(\\overline{Y} - \\overline{X}) = \\mathrm{Var}(\\overline{Y}) + \\mathrm{Var}(\\overline{X}) - 2\\mathrm{Cov}(\\overline{X}, \\overline{Y})\n$$\nSince the individual histories $(X_i, Y_i)$ are independent and identically distributed pairs, the variance of the sample means are $\\mathrm{Var}(\\overline{X}) = \\frac{\\mathrm{Var}(X)}{n}$ and $\\mathrm{Var}(\\overline{Y}) = \\frac{\\mathrm{Var}(Y)}{n}$. Similarly, the covariance of the sample means is $\\mathrm{Cov}(\\overline{X}, \\overline{Y}) = \\frac{\\mathrm{Cov}(X, Y)}{n}$. Let $\\sigma_X^2 = \\mathrm{Var}(X)$ and $\\sigma_Y^2 = \\mathrm{Var}(Y)$ denote the per-history variances. The variance of the estimator becomes:\n$$\n\\mathrm{Var}(\\widehat{\\Delta T}) = \\frac{1}{n} \\left( \\sigma_Y^2 + \\sigma_X^2 - 2\\mathrm{Cov}(X, Y) \\right)\n$$\nWe now analyze this expression for the two specified sampling strategies.\n\n**1. Independent Sampling**\nIn this strategy, the score $X_i$ for the baseline system and the score $Y_i$ for the perturbed system are generated from independent random numbers. Consequently, the scores $X$ and $Y$ are statistically independent random variables. A fundamental property of independent variables is that their covariance is zero.\n$$\n\\mathrm{Cov}(X, Y) = 0\n$$\nSubstituting this into the general variance formula gives the variance for the independent sampling case:\n$$\n\\mathrm{Var}_{\\text{indep}}(\\widehat{\\Delta T}) = \\frac{1}{n} (\\sigma_X^2 + \\sigma_Y^2)\n$$\n\n**2. Common Random Numbers (CRN) Sampling**\nIn this strategy, the same random number $U_i$ is used to generate both $s_i = -\\ln(U_i)/\\Sigma_t$ and $s_i' = -\\ln(U_i)/\\Sigma_t'$. This induces a statistical correlation between the scores $X_i$ and $Y_i$. Thus, their covariance, $\\mathrm{Cov}(X, Y)$, is generally non-zero. The variance for the CRN case is therefore:\n$$\n\\mathrm{Var}_{\\text{CRN}}(\\widehat{\\Delta T}) = \\frac{1}{n} \\left( \\sigma_X^2 + \\sigma_Y^2 - 2\\mathrm{Cov}(X, Y) \\right)\n$$\nThe problem defines $\\rho$ as the correlation coefficient between the paired scores $X$ and $Y$. By definition, the correlation coefficient is related to the covariance by:\n$$\n\\rho = \\frac{\\mathrm{Cov}(X, Y)}{\\sqrt{\\sigma_X^2 \\sigma_Y^2}} = \\frac{\\mathrm{Cov}(X, Y)}{\\sigma_X \\sigma_Y}\n$$\nFrom this, we can express the covariance as $\\mathrm{Cov}(X, Y) = \\rho \\sigma_X \\sigma_Y$. Substituting this into the variance expression for CRN gives:\n$$\n\\mathrm{Var}_{\\text{CRN}}(\\widehat{\\Delta T}) = \\frac{1}{n} \\left( \\sigma_X^2 + \\sigma_Y^2 - 2\\rho \\sigma_X \\sigma_Y \\right)\n$$\n\n**Derivation of the Variance Reduction Factor (VRF)**\nThe problem asks for the derivation under the assumption that the per-history score variances are equal, which is a common and justified approximation for small perturbations where $|\\delta\\Sigma| \\ll \\Sigma_t$. Let us denote this common variance as $\\sigma^2$:\n$$\n\\sigma_X^2 = \\sigma_Y^2 = \\sigma^2\n$$\nThis implies $\\sigma_X = \\sigma_Y = \\sigma$.\n\nWe can justify this assumption. The score $X = \\mathbf{1}\\{s > L\\}$ is a Bernoulli random variable. Its expected value is $E[X] = P(s > L)$.\n$P(s > L) = P(-\\ln(U)/\\Sigma_t > L) = P(\\ln(U)  -\\Sigma_t L) = P(U  \\exp(-\\Sigma_t L))$.\nSince $U$ is uniform on $(0, 1)$, $P(U  a) = a$ for $a \\in [0, 1]$. Therefore, $E[X] = \\exp(-\\Sigma_t L) = T$.\nThe variance of a Bernoulli variable with success probability $p$ is $p(1-p)$. Thus, $\\sigma_X^2 = T(1-T)$.\nSimilarly, for the perturbed system, $\\sigma_Y^2 = T'(1-T')$.\nThe condition $|\\delta\\Sigma| \\ll \\Sigma_t$ implies that $T' = \\exp(-(\\Sigma_t+\\delta\\Sigma)L) \\approx T$. Since the variance function $v(p) = p(1-p)$ is continuous, $T' \\approx T$ implies $\\sigma_Y^2 \\approx \\sigma_X^2$. The assumption is therefore physically and mathematically sound in the specified regime.\n\nApplying the assumption $\\sigma_X^2 = \\sigma_Y^2 = \\sigma^2$ to the variance expressions for both sampling schemes:\nFor independent sampling:\n$$\n\\mathrm{Var}_{\\text{indep}}(\\widehat{\\Delta T}) = \\frac{1}{n} (\\sigma^2 + \\sigma^2) = \\frac{2\\sigma^2}{n}\n$$\nFor CRN sampling:\n$$\n\\mathrm{Var}_{\\text{CRN}}(\\widehat{\\Delta T}) = \\frac{1}{n} (\\sigma^2 + \\sigma^2 - 2\\rho \\sigma \\sigma) = \\frac{1}{n} (2\\sigma^2 - 2\\rho \\sigma^2) = \\frac{2\\sigma^2(1-\\rho)}{n}\n$$\nThe Variance Reduction Factor (VRF) is defined as the ratio of these two variances:\n$$\n\\mathrm{VRF} = \\frac{\\mathrm{Var}_{\\text{indep}}(\\widehat{\\Delta T})}{\\mathrm{Var}_{\\text{CRN}}(\\widehat{\\Delta T})} = \\frac{\\frac{2\\sigma^2}{n}}{\\frac{2\\sigma^2(1-\\rho)}{n}}\n$$\nCanceling the common term $\\frac{2\\sigma^2}{n}$ from the numerator and denominator yields the final expression for the VRF as a function of $\\rho$:\n$$\n\\mathrm{VRF} = \\frac{1}{1-\\rho}\n$$\nThis result shows that for positive correlation ($\\rho > 0$), which is expected when using CRN for small perturbations, the variance of the CRN estimator is smaller than that of the independent estimator, leading to a VRF greater than $1$. The efficiency of the CRN method increases dramatically as $\\rho$ approaches $1$.\n\n**Numerical Calculation**\nThe problem asks for the numerical value of the VRF when the correlation coefficient is $\\rho = 0.9$.\n$$\n\\mathrm{VRF} = \\frac{1}{1 - 0.9} = \\frac{1}{0.1} = 10\n$$\nA correlation of $\\rho=0.9$ results in a variance reduction factor of $10$. This means that to achieve the same statistical precision on the estimate of $\\Delta T$, an independent sampling simulation would require $10$ times as many neutron histories as a simulation using the CRN technique.",
            "answer": "$$\\boxed{10}$$"
        },
        {
            "introduction": "Moving from pure theory to computational practice, this exercise applies the principles of correlated sampling to a key problem in reactor physics: estimating the change in the effective multiplication factor, $\\Delta k_{\\text{eff}}$. You will implement a simplified linear model that mimics the use of a shared fission source bank, a common and powerful application of CRN in large-scale Monte Carlo simulations. This hands-on coding task will solidify your understanding by requiring you to verify the theoretical benefits of CRN against empirically generated data, bridging the gap between mathematical formulas and practical simulation results. ",
            "id": "4219754",
            "problem": "You are tasked with constructing a Common Random Numbers (CRN) based estimator for the change in the effective multiplication factor, denoted by $\\Delta k_{\\text{eff}}$, between a base nuclear system and a slightly perturbed nuclear system, and analyzing the covariance induced by shared fission bank sampling. Model the per-history multiplication factor contributions as linear functionals of a shared fission source random variate to reflect reuse of the same fission source samples across systems. Treat the per-history contributions in the base system as $X_i = \\mu_0 + \\sigma_0 Z_i$ and in the perturbed system as $Y_i = \\mu_1 + \\sigma_1 Z_i$ for $i = 1, \\dots, N$, where $Z_i$ are independent and identically distributed standard normal random variables generated from shared uniform random numbers via inverse cumulative distribution transformation to enforce CRN. The use of shared $Z_i$ models reusing the fission source bank across both systems. The change in the effective multiplication factor is estimated by the sample mean difference $\\widehat{\\Delta k}_{\\text{eff}} = \\overline{Y} - \\overline{X}$.\n\nStart from fundamental Monte Carlo definitions and probability properties: the sample mean as an unbiased estimator of an expectation, linearity of expectation, and the bilinearity of covariance with independence assumptions limited to the driving random variables. Assume the first-order linear response model stated above is valid for small perturbations in the nuclear data and that $Z_i$ are standard normal random variables constructed by mapping independent and identically distributed uniform random variables $U_i \\sim \\text{Uniform}(0,1)$ through the inverse of the standard normal cumulative distribution function.\n\nYour program must:\n- Generate shared $Z_i$ for both systems using common uniform random numbers $U_i$ and the inverse standard normal cumulative distribution function so that the same $Z_i$ drive both $X_i$ and $Y_i$ in each test case.\n- Compute the CRN-based estimator $\\widehat{\\Delta k}_{\\text{eff}}$ from the sample means over $N$ histories.\n- Compute the empirical covariance $\\widehat{\\operatorname{Cov}}(X,Y)$ using the unbiased sample covariance formula derived from the shared $Z_i$.\n- Compute the empirical variance of the per-history difference $D_i = Y_i - X_i$, denoted $\\widehat{\\operatorname{Var}}(D)$, and the empirical variance of the estimator $\\widehat{\\operatorname{Var}}(\\widehat{\\Delta k}_{\\text{eff}})$ by dividing $\\widehat{\\operatorname{Var}}(D)$ by $N$.\n- Derive and compute the theoretical covariance induced by shared fission bank sampling and the theoretical variance of $D_i$ and of $\\widehat{\\Delta k}_{\\text{eff}}$ under the linear response model and shared $Z_i$.\n- Report all quantities as dimensionless decimal fractions with no percentage signs.\n\nTo ensure scientific realism, interpret $Z_i$ as a latent representation of fission source sampling randomness that is reused across the base and perturbed systems; $\\mu_0$, $\\mu_1$ represent mean per-history contributions to $k_{\\text{eff}}$, and $\\sigma_0$, $\\sigma_1$ reflect the amplitude of stochastic variation due to random particle histories in fixed-source simulations that are reweighted to estimate $k_{\\text{eff}}$.\n\nUse the following test suite, where each tuple is $(\\mu_0, \\mu_1, \\sigma_0, \\sigma_1, N, \\text{seed})$:\n- Test $1$: $(0.995, 1.000, 0.050, 0.050, 100000, 314159)$\n- Test $2$: $(0.980, 0.983, 0.060, 0.040, 80000, 271828)$\n- Edge Test $3$: $(0.997, 0.9975, 0.000, 0.005, 60000, 161803)$\n\nFor each test case, output a list containing the following seven quantities in order: $\\widehat{\\Delta k}_{\\text{eff}}$, $\\widehat{\\operatorname{Cov}}(X,Y)$, $\\operatorname{Cov}_{\\text{theory}}(X,Y)$, $\\widehat{\\operatorname{Var}}(D)$, $\\operatorname{Var}_{\\text{theory}}(D)$, $\\widehat{\\operatorname{Var}}(\\widehat{\\Delta k}_{\\text{eff}})$, $\\operatorname{Var}_{\\text{theory}}(\\widehat{\\Delta k}_{\\text{eff}})$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one inner list per test case, for example $[[r_{1,1}, \\dots, r_{1,7}], [r_{2,1}, \\dots, r_{2,7}], [r_{3,1}, \\dots, r_{3,7}]]$ where each $r_{i,j}$ is a real number.\n\nAngle units do not apply in this problem. All reported quantities are dimensionless. Express all answers in decimal form. The final output format must be exactly one line containing the outer list with three inner lists as specified.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of Monte Carlo simulation and variance reduction techniques, specifically the use of Common Random Numbers (CRN) for estimating differential effects in nuclear systems. The problem is well-posed, providing a clear mathematical model, all necessary parameters, and an objective set of computational and theoretical tasks. The linear response model is a standard and useful simplification for pedagogical purposes and for analyzing small perturbations. The problem is self-contained, consistent, and admits a unique, verifiable solution.\n\nThe core task is to analyze a CRN-based estimator for the change in the effective multiplication factor, $\\Delta k_{\\text{eff}}$, between a base and a perturbed system. The per-history contributions to $k_{\\text{eff}}$ are modeled as linear functions of a shared random variate.\n\nLet the per-history contribution for the base system be a random variable $X$ and for the perturbed system be $Y$. For the $i$-th history, their realizations are given by:\n$$X_i = \\mu_0 + \\sigma_0 Z_i$$\n$$Y_i = \\mu_1 + \\sigma_1 Z_i$$\nwhere $i = 1, \\dots, N$. The parameters $\\mu_0$ and $\\mu_1$ represent the mean per-history contributions, while $\\sigma_0$ and $\\sigma_1$ represent the standard deviation of these contributions. The variables $Z_i$ are independent and identically distributed (i.i.d.) standard normal random variables, $Z_i \\sim \\mathcal{N}(0, 1)$. The crucial aspect of the CRN technique is that the same random variate $Z_i$ is used to generate both $X_i$ and $Y_i$ for each history, thereby inducing a correlation between the two simulations. This shared randomness models the reuse of a fission source bank between the base and perturbed calculations. The $Z_i$ are generated by applying the inverse cumulative distribution function (CDF) of the standard normal distribution, denoted $\\Phi^{-1}$, to a set of i.i.d. uniform random numbers $U_i \\sim \\text{Uniform}(0,1)$.\n\nThe estimator for the change in the effective multiplication factor, $\\widehat{\\Delta k}_{\\text{eff}}$, is the difference in the sample means:\n$$\\widehat{\\Delta k}_{\\text{eff}} = \\overline{Y} - \\overline{X} = \\frac{1}{N}\\sum_{i=1}^{N} Y_i - \\frac{1}{N}\\sum_{i=1}^{N} X_i$$\n\nFirst, we derive the required theoretical quantities based on the properties of expectation, variance, and covariance.\n\n**1. Theoretical Covariance: $\\operatorname{Cov}_{\\text{theory}}(X,Y)$**\nThe covariance between the per-history contributions $X_i$ and $Y_i$ is defined as $\\operatorname{Cov}(X_i, Y_i) = E[(X_i - E[X_i])(Y_i - E[Y_i])]$.\nThe expectations are $E[X_i] = E[\\mu_0 + \\sigma_0 Z_i] = \\mu_0 + \\sigma_0 E[Z_i] = \\mu_0$, and similarly $E[Y_i] = \\mu_1$, since $E[Z_i] = 0$.\nThe centered variables are $X_i - E[X_i] = \\sigma_0 Z_i$ and $Y_i - E[Y_i] = \\sigma_1 Z_i$.\nThus, the covariance is:\n$$\\operatorname{Cov}(X_i, Y_i) = E[(\\sigma_0 Z_i)(\\sigma_1 Z_i)] = \\sigma_0 \\sigma_1 E[Z_i^2]$$\nFor a standard normal variable $Z_i$, its variance is $\\operatorname{Var}(Z_i) = E[Z_i^2] - (E[Z_i])^2 = 1$. Since $E[Z_i]=0$, we have $E[Z_i^2] = 1$.\nTherefore, the theoretical covariance is:\n$$\\operatorname{Cov}_{\\text{theory}}(X,Y) = \\sigma_0 \\sigma_1$$\n\n**2. Theoretical Variance of the Difference: $\\operatorname{Var}_{\\text{theory}}(D)$**\nLet $D_i$ be the per-history difference, $D_i = Y_i - X_i$.\n$$D_i = (\\mu_1 + \\sigma_1 Z_i) - (\\mu_0 + \\sigma_0 Z_i) = (\\mu_1 - \\mu_0) + (\\sigma_1 - \\sigma_0) Z_i$$\nThe variance of $D_i$ can be calculated directly. Since $\\mu_1 - \\mu_0$ is a constant, it does not affect the variance.\n$$\\operatorname{Var}(D_i) = \\operatorname{Var}((\\mu_1 - \\mu_0) + (\\sigma_1 - \\sigma_0) Z_i) = (\\sigma_1 - \\sigma_0)^2 \\operatorname{Var}(Z_i) = (\\sigma_1 - \\sigma_0)^2$$\nAlternatively, using the bilinearity of covariance:\n$$\\operatorname{Var}(D_i) = \\operatorname{Var}(Y_i - X_i) = \\operatorname{Var}(Y_i) + \\operatorname{Var}(X_i) - 2\\operatorname{Cov}(Y_i, X_i)$$\nWith $\\operatorname{Var}(X_i) = \\sigma_0^2 \\operatorname{Var}(Z_i) = \\sigma_0^2$ and $\\operatorname{Var}(Y_i) = \\sigma_1^2$, we get:\n$$\\operatorname{Var}_{\\text{theory}}(D) = \\sigma_1^2 + \\sigma_0^2 - 2\\sigma_0\\sigma_1 = (\\sigma_1 - \\sigma_0)^2$$\n\n**3. Theoretical Variance of the Estimator: $\\operatorname{Var}_{\\text{theory}}(\\widehat{\\Delta k}_{\\text{eff}})$**\nThe estimator can be rewritten in terms of the differences $D_i$:\n$$\\widehat{\\Delta k}_{\\text{eff}} = \\overline{Y} - \\overline{X} = \\frac{1}{N}\\sum_{i=1}^{N} (Y_i - X_i) = \\frac{1}{N}\\sum_{i=1}^{N} D_i = \\overline{D}$$\nThe estimator is the sample mean of the i.i.d. differences $D_i$. The variance of a sample mean of $N$ i.i.d. random variables is the variance of a single variable divided by $N$.\n$$\\operatorname{Var}_{\\text{theory}}(\\widehat{\\Delta k}_{\\text{eff}}) = \\operatorname{Var}(\\overline{D}) = \\frac{\\operatorname{Var}(D_i)}{N} = \\frac{(\\sigma_1 - \\sigma_0)^2}{N}$$\nThis result highlights the power of CRN: if $\\sigma_1 \\approx \\sigma_0$, the variance of the estimator can be made very small, leading to a much more efficient estimation of the differential effect compared to independent simulations.\n\nNext, we define the numerical procedure for computing the empirical estimates for a sample of size $N$.\n\n**1. Sample Generation:**\nFor each test case, we generate $N$ shared uniform random numbers $U_1, \\dots, U_N$ using a seeded random number generator for reproducibility. These are transformed into standard normal variates $Z_i = \\Phi^{-1}(U_i)$. The samples $X_i$ and $Y_i$ are then calculated using the given linear models.\n\n**2. Empirical Estimator: $\\widehat{\\Delta k}_{\\text{eff}}$**\nThis is computed directly from the sample means of the generated $X$ and $Y$ samples: $\\widehat{\\Delta k}_{\\text{eff}} = \\text{mean}(Y) - \\text{mean}(X)$.\n\n**3. Empirical Covariance: $\\widehat{\\operatorname{Cov}}(X,Y)$**\nThis is computed using the unbiased sample covariance formula:\n$$\\widehat{\\operatorname{Cov}}(X,Y) = \\frac{1}{N-1}\\sum_{i=1}^{N} (X_i - \\overline{X})(Y_i - \\overline{Y})$$\n\n**4. Empirical Variance of the Difference: $\\widehat{\\operatorname{Var}}(D)$**\nAfter computing the sample of differences $D_i = Y_i - X_i$, the unbiased sample variance is calculated:\n$$\\widehat{\\operatorname{Var}}(D) = \\frac{1}{N-1}\\sum_{i=1}^{N} (D_i - \\overline{D})^2$$\n\n**5. Empirical Variance of the Estimator: $\\widehat{\\operatorname{Var}}(\\widehat{\\Delta k}_{\\text{eff}})$**\nAs specified in the problem, this is obtained by scaling the sample variance of the difference by $N$:\n$$\\widehat{\\operatorname{Var}}(\\widehat{\\Delta k}_{\\text{eff}}) = \\frac{\\widehat{\\operatorname{Var}}(D)}{N}$$\n\nThe implementation will perform these calculations for each test case provided, generating the seven required quantities: $\\widehat{\\Delta k}_{\\text{eff}}$, $\\widehat{\\operatorname{Cov}}(X,Y)$, $\\operatorname{Cov}_{\\text{theory}}(X,Y)$, $\\widehat{\\operatorname{Var}}(D)$, $\\operatorname{Var}_{\\text{theory}}(D)$, $\\widehat{\\operatorname{Var}}(\\widehat{\\Delta k}_{\\text{eff}})$, and $\\operatorname{Var}_{\\text{theory}}(\\widehat{\\Delta k}_{\\text{eff}})$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Computes theoretical and empirical statistics for a CRN-based estimator\n    of a differential effect in a simplified nuclear reactor simulation model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (mu0, mu1, sigma0, sigma1, N, seed)\n        (0.995, 1.000, 0.050, 0.050, 100000, 314159),\n        (0.980, 0.983, 0.060, 0.040, 80000, 271828),\n        (0.997, 0.9975, 0.000, 0.005, 60000, 161803),\n    ]\n\n    results = []\n    for case in test_cases:\n        mu0, mu1, sigma0, sigma1, N, seed = case\n        \n        # --- Sample Generation using Common Random Numbers ---\n        # Initialize a random number generator with a specific seed for reproducibility.\n        rng = np.random.default_rng(seed)\n        # Generate N uniform random numbers in the interval (0, 1).\n        u_samples = rng.uniform(size=N)\n        # Transform uniform samples to standard normal samples using inverse transform sampling.\n        # This is the shared random variate Z_i.\n        z_samples = norm.ppf(u_samples)\n        \n        # Generate per-history contributions for the base (X) and perturbed (Y) systems.\n        x_samples = mu0 + sigma0 * z_samples\n        y_samples = mu1 + sigma1 * z_samples\n        \n        # --- Theoretical Calculations ---\n        # 3. Theoretical covariance between X and Y.\n        cov_theory_xy = sigma0 * sigma1\n        \n        # 5. Theoretical variance of the per-history difference D = Y - X.\n        var_theory_d = (sigma1 - sigma0)**2\n        \n        # 7. Theoretical variance of the estimator for Delta k_eff.\n        var_theory_delta_k = var_theory_d / N\n\n        # --- Empirical Calculations ---\n        # 1. CRN-based estimator for Delta k_eff (difference of sample means).\n        delta_k_eff_hat = np.mean(y_samples) - np.mean(x_samples)\n        \n        # 2. Unbiased sample covariance between X and Y.\n        # np.cov with ddof=1 computes the unbiased estimator using (N-1) in the denominator.\n        cov_hat_xy = np.cov(x_samples, y_samples, ddof=1)[0, 1]\n        \n        # 4. Unbiased sample variance of the per-history difference D.\n        d_samples = y_samples - x_samples\n        var_hat_d = np.var(d_samples, ddof=1)\n        \n        # 6. Empirical variance of the estimator for Delta k_eff.\n        var_hat_delta_k = var_hat_d / N\n        \n        # Compile results for the current test case in the specified order.\n        case_results = [\n            delta_k_eff_hat,\n            cov_hat_xy,\n            cov_theory_xy,\n            var_hat_d,\n            var_theory_d,\n            var_hat_delta_k,\n            var_theory_delta_k\n        ]\n        results.append(case_results)\n\n    # --- Final Output Formatting ---\n    # Construct the output string to match the required format: [[r1,r2,...],[s1,s2,...]]\n    outer_list_str = []\n    for res_list in results:\n        # Convert each list of floats to a comma-separated string \"[f1,f2,...]\"\n        inner_list_str = f\"[{','.join(map(str, res_list))}]\"\n        outer_list_str.append(inner_list_str)\n    \n    # Join the inner list strings into the final output format \"[[...],[...]]\"\n    final_output = f\"[{','.join(outer_list_str)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}