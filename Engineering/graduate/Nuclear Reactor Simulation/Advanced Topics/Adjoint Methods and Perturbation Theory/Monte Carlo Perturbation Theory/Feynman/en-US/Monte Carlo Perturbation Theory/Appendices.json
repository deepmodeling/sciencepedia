{
    "hands_on_practices": [
        {
            "introduction": "The power of the Likelihood Ratio (LR) method lies in its ability to compute sensitivities from a single simulation of the unperturbed system. This is achieved by calculating a \"score\" for each particle history, which represents the logarithmic derivative of the path probability. This exercise  provides essential practice in deriving these scores from first principles by breaking down a particle's journey into discrete events—free flights and collisions—and calculating the specific contribution of each event to the total score.",
            "id": "4236703",
            "problem": "A fixed-source neutron transport problem is simulated with an analog Monte Carlo (MC) method. The geometry is piecewise-homogeneous with a subregion $D$ in which only the microscopic absorption cross section is subject to a small multiplicative perturbation. Specifically, for $\\varepsilon$ in a neighborhood of $0$, the absorption and scattering macroscopic cross sections satisfy $\\Sigma_a(\\mathbf{r};\\varepsilon) = (1+\\varepsilon)\\,\\Sigma_a^0(\\mathbf{r})$ and $\\Sigma_s(\\mathbf{r};\\varepsilon) = \\Sigma_s^0(\\mathbf{r})$, so that $\\Sigma_t(\\mathbf{r};\\varepsilon) = \\Sigma_s^0(\\mathbf{r}) + (1+\\varepsilon)\\,\\Sigma_a^0(\\mathbf{r})$, with $\\Sigma_a^0(\\mathbf{r})0$ only in $D$. The source probability density function (PDF) $q(\\mathbf{r},\\mathbf{\\Omega},E)$ and all angular/energy scattering PDFs are independent of $\\varepsilon$, and the geometry is not perturbed. A response is defined as $R = h(X)$, where $X$ denotes a full analog history (source to termination) and $h$ is a bounded tally functional that does not depend explicitly on $\\varepsilon$ (e.g., a track-length estimate of scalar flux in a detector volume disjoint from $D$).\n\nLet the analog-history PDF $p_\\varepsilon(X)$ under parameter $\\varepsilon$, and let $\\mathbb{E}_\\varepsilon[\\cdot]$ denote expectation with respect to $p_\\varepsilon$. The quantity of interest is $\\delta R \\equiv \\left.\\dfrac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}\\mathbb{E}_\\varepsilon[R]\\right|_{\\varepsilon=0}$.\n\nThe Likelihood Ratio (LR) or score-function identity states that if $p_\\varepsilon$ is differentiable in $\\varepsilon$ and $h(X)$ is integrable, then $\\delta R = \\mathbb{E}_0\\!\\left[R\\,S(X)\\right]$, where $S(X) \\equiv \\left.\\dfrac{\\partial}{\\partial \\varepsilon}\\ln p_\\varepsilon(X)\\right|_{\\varepsilon=0}$ is the per-history score that can be accumulated along the analog trajectory as a sum of per-event contributions.\n\nWhich of the following option(s) correctly describe an implementable per-event LR accumulation in this setting to estimate $\\delta R$ without running the perturbed system? Select all that apply.\n\n- A. At each free-flight segment of length $\\ell$ inside $D$, add the flight contribution $-\\displaystyle\\int_{\\text{segment}}\\dfrac{\\partial \\Sigma_t(\\mathbf{r};\\varepsilon)}{\\partial \\varepsilon}\\Big|_{\\varepsilon=0}\\,\\mathrm{d}s$ to the running score. At each analog collision in $D$ of reaction type $c\\in\\{a,s,f,\\dots\\}$, add the collision contribution $\\displaystyle\\left.\\dfrac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_c(\\mathbf{r};\\varepsilon)\\right|_{\\varepsilon=0}-\\left.\\dfrac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_t(\\mathbf{r};\\varepsilon)\\right|_{\\varepsilon=0}$. Do not add any term for events outside $D$ or for angular/energy sampling, and add a source term $\\left.\\dfrac{\\partial}{\\partial \\varepsilon}\\ln q\\right|_{\\varepsilon=0}$ only if the source PDF depends on $\\varepsilon$. Form the unbiased estimator $\\widehat{\\delta R}=\\dfrac{1}{N}\\sum_{n=1}^{N} h(X_n)\\,S(X_n)$ from i.i.d. nominal histories $X_n\\sim p_0$.\n\n- B. Ignore free-flight contributions and only add collision contributions at events in $D$ by incrementing the score by $\\dfrac{\\partial \\Sigma_c(\\mathbf{r};\\varepsilon)}{\\partial \\varepsilon}\\big|_{\\varepsilon=0}$ at each collision of type $c$, without any normalization by $\\Sigma_t$ or subtraction of a total cross section term. Form $\\widehat{\\delta R}$ as in Option A.\n\n- C. At each free-flight segment inside $D$, add $-\\displaystyle\\int_{\\text{segment}}\\dfrac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_t(\\mathbf{r};\\varepsilon)\\Big|_{\\varepsilon=0}\\,\\mathrm{d}s$, and at each collision in $D$, add $\\left.\\dfrac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_t(\\mathbf{r};\\varepsilon)\\right|_{\\varepsilon=0}$. No other terms are needed. Form $\\widehat{\\delta R}$ as in Option A.\n\n- D. Specializing to the given absorption-only perturbation, at each free-flight segment inside $D$ accumulate $-\\displaystyle\\int_{\\text{segment}}\\Sigma_a^0(\\mathbf{r})\\,\\mathrm{d}s$. At a collision in $D$, if the reaction is absorption, add $1-\\dfrac{\\Sigma_a^0(\\mathbf{r})}{\\Sigma_t^0(\\mathbf{r})}$; if it is scattering, add $-\\dfrac{\\Sigma_a^0(\\mathbf{r})}{\\Sigma_t^0(\\mathbf{r})}$. Do not add any score for events outside $D$, for boundary crossings, for angular/energy sampling, or for the source (since $q$ is independent of $\\varepsilon$). Estimate $\\delta R$ by multiplying the per-history score by $R$ and averaging over nominal histories.\n\n- E. Each time a boundary between $D$ and the unperturbed region is crossed, add a jump term equal to $\\left(\\Sigma_t^0\\big|_{\\text{inside }D}-\\Sigma_t^0\\big|_{\\text{outside }D}\\right)\\times \\ell_{\\text{prev}}$, where $\\ell_{\\text{prev}}$ is the immediately preceding free-flight length, to account for the discontinuity of $\\Sigma_t$. Free-flight and collision contributions are otherwise unnecessary. Estimate $\\delta R$ as in Option A.\n\nAssume standard analog MC sampling: free flights from the exponential attenuation law, reaction type selected with probability proportional to reaction cross sections, and history termination on absorption, with no variance-reduction biasing and no fission source coupling (i.e., fixed source). State all correct options.",
            "solution": "We begin from first principles: the analog Monte Carlo (MC) method samples a neutron history $X$ according to the transport-process probability density function (PDF) $p_\\varepsilon(X)$ induced by the exponential attenuation between collisions, the selection of reaction type with probability proportional to the reaction macroscopic cross sections, the sampling of scattering kinematics from prescribed angular/energy PDFs, and the source PDF $q$. The response is $R=h(X)$, which does not depend explicitly on $\\varepsilon$. The Likelihood Ratio (LR) identity (also known as the score-function identity) asserts\n$$\n\\delta R \\equiv \\left.\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}\\mathbb{E}_\\varepsilon[R]\\right|_{\\varepsilon=0}\n= \\left.\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}\\int h(X)\\,p_\\varepsilon(X)\\,\\mathrm{d}X\\right|_{\\varepsilon=0}\n= \\int h(X)\\, \\left.\\frac{\\partial}{\\partial \\varepsilon}\\ln p_\\varepsilon(X)\\right|_{\\varepsilon=0} p_0(X)\\,\\mathrm{d}X\n= \\mathbb{E}_0\\!\\left[R\\,S(X)\\right],\n$$\nwith the per-history score\n$$\nS(X) \\equiv \\left.\\frac{\\partial}{\\partial \\varepsilon}\\ln p_\\varepsilon(X)\\right|_{\\varepsilon=0}.\n$$\nTo implement a per-event accumulation of $S(X)$, we factorize $\\ln p_\\varepsilon(X)$ as a sum over events. For a sequence of free-flight segments $j=1,\\dots,J$ of lengths $\\ell_j$ along paths $\\gamma_j$ between events and collisions $k=1,\\dots,K$ at locations $\\mathbf{r}_k$, in analog sampling we have\n- a free-flight survival factor $\\exp\\!\\left(-\\int_{\\gamma_j} \\Sigma_t(\\mathbf{r};\\varepsilon)\\,\\mathrm{d}s\\right)$, and hence a log-term $-\\int_{\\gamma_j} \\Sigma_t(\\mathbf{r};\\varepsilon)\\,\\mathrm{d}s$,\n- a reaction-type selection probability $\\Sigma_{c_k}(\\mathbf{r}_k;\\varepsilon)/\\Sigma_t(\\mathbf{r}_k;\\varepsilon)$, and hence a log-term $\\ln \\Sigma_{c_k}(\\mathbf{r}_k;\\varepsilon) - \\ln \\Sigma_t(\\mathbf{r}_k;\\varepsilon)$,\n- angular and energy PDFs and the source $q$, which by assumption do not depend on $\\varepsilon$.\n\nTherefore,\n$$\n\\ln p_\\varepsilon(X)\n= \\sum_{j=1}^{J} \\left(-\\int_{\\gamma_j} \\Sigma_t(\\mathbf{r};\\varepsilon)\\,\\mathrm{d}s\\right)\n+ \\sum_{k=1}^{K} \\left(\\ln \\Sigma_{c_k}(\\mathbf{r}_k;\\varepsilon) - \\ln \\Sigma_t(\\mathbf{r}_k;\\varepsilon)\\right)\n+ \\text{terms independent of }\\varepsilon,\n$$\nso that\n$$\nS(X) = \\sum_{j=1}^{J} \\left(-\\int_{\\gamma_j} \\left.\\frac{\\partial \\Sigma_t(\\mathbf{r};\\varepsilon)}{\\partial \\varepsilon}\\right|_{\\varepsilon=0}\\,\\mathrm{d}s\\right)\n+ \\sum_{k=1}^{K} \\left(\\left.\\frac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_{c_k}(\\mathbf{r}_k;\\varepsilon)\\right|_{\\varepsilon=0}\n- \\left.\\frac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_t(\\mathbf{r}_k;\\varepsilon)\\right|_{\\varepsilon=0}\\right).\n$$\nSince only $\\Sigma_a$ is perturbed and only inside $D$, we have inside $D$\n$$\n\\left.\\frac{\\partial \\Sigma_t}{\\partial \\varepsilon}\\right|_{\\varepsilon=0} = \\Sigma_a^0,\\quad\n\\left.\\frac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_a\\right|_{\\varepsilon=0} = 1,\\quad\n\\left.\\frac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_s\\right|_{\\varepsilon=0} = 0,\\quad\n\\left.\\frac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_t\\right|_{\\varepsilon=0} = \\frac{\\Sigma_a^0}{\\Sigma_t^0},\n$$\nand outside $D$ all these derivatives are $0$. Therefore, the score accumulates only when the particle is in $D$:\n- For any free-flight segment $\\gamma$ inside $D$, the flight contribution is\n$$\nS_{\\text{flight}}(\\gamma) = -\\int_{\\gamma} \\Sigma_a^0(\\mathbf{r})\\,\\mathrm{d}s.\n$$\n- For a collision in $D$:\n  - If the reaction is absorption ($c=a$), the collision contribution is\n  $$\n  S_{\\text{coll}} = \\left(1\\right) - \\left(\\frac{\\Sigma_a^0}{\\Sigma_t^0}\\right) = 1 - \\frac{\\Sigma_a^0}{\\Sigma_t^0}.\n  $$\n  - If the reaction is scattering ($c=s$), the collision contribution is\n  $$\n  S_{\\text{coll}} = \\left(0\\right) - \\left(\\frac{\\Sigma_a^0}{\\Sigma_t^0}\\right) = - \\frac{\\Sigma_a^0}{\\Sigma_t^0}.\n  $$\nThere are no source terms (since $q$ is independent of $\\varepsilon$), no terms from angular/energy sampling (by assumption), and no explicit boundary-crossing jump terms because $\\ln p_\\varepsilon$ is a sum of integrals and local reaction probabilities; boundaries only segment the path integrals.\n\nWith these principles established, we assess each option:\n\n- Option A: This option states the general per-event LR accumulation that follows directly from the factorization of $\\ln p_\\varepsilon(X)$ into free-flight and collision contributions, with source and other sampling contributions included only if their PDFs depend on $\\varepsilon$. It matches the derived form:\n$$\nS = \\sum_{\\text{segments}} \\left(-\\int \\frac{\\partial \\Sigma_t}{\\partial \\varepsilon}\\,\\mathrm{d}s\\right)\n+ \\sum_{\\text{collisions}} \\left(\\frac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_c - \\frac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_t\\right),\n$$\nwith contributions confined to $D$. The estimator $\\widehat{\\delta R} = \\frac{1}{N}\\sum h(X_n) S(X_n)$ is the standard LR estimator. Verdict: Correct.\n\n- Option B: This option ignores the free-flight contribution and adds an unnormalized $\\frac{\\partial \\Sigma_c}{\\partial \\varepsilon}$ at collisions. From the derivation, the collision term must be the derivative of the log of the reaction probability, i.e., $\\frac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_c - \\frac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_t$, and the free-flight survival contributes $-\\int \\frac{\\partial \\Sigma_t}{\\partial \\varepsilon}\\,\\mathrm{d}s$. Omitting the flight term and failing to subtract the $\\ln \\Sigma_t$ part yields a biased score. Verdict: Incorrect.\n\n- Option C: This option uses a flight term $-\\int \\frac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_t\\,\\mathrm{d}s$ and a collision term $+\\frac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_t$. The correct flight contribution arises from the derivative of $-\\int \\Sigma_t\\,\\mathrm{d}s$, not of its logarithm; thus it should be $-\\int \\frac{\\partial \\Sigma_t}{\\partial \\varepsilon}\\,\\mathrm{d}s$. The collision term should be the difference of reaction and total log-derivatives, not a bare $\\frac{\\partial}{\\partial \\varepsilon}\\ln \\Sigma_t$. This double-counts the total cross section and mis-specifies the flight contribution. Verdict: Incorrect.\n\n- Option D: This is the specialization of Option A to the given perturbation. It uses\n$$\nS_{\\text{flight}} = -\\int \\Sigma_a^0\\,\\mathrm{d}s,\\quad\nS_{\\text{coll}} = \\begin{cases}\n1 - \\Sigma_a^0/\\Sigma_t^0,  c=a,\\\\\n-\\Sigma_a^0/\\Sigma_t^0,  c=s,\n\\end{cases}\n$$\napplied only inside $D$, with no source or boundary-crossing terms. This matches exactly the derived expressions. Verdict: Correct.\n\n- Option E: This posits a boundary-crossing jump term proportional to the difference in $\\Sigma_t^0$ times a preceding flight length, and dispenses with the principled free-flight and collision contributions. There is no such boundary jump in the derivative of $\\ln p_\\varepsilon$ when the geometry is fixed; the contributions come from the integral of $\\frac{\\partial \\Sigma_t}{\\partial \\varepsilon}$ along the path and the local reaction log-probabilities. Verdict: Incorrect.\n\nTherefore, the correct options are A and D.",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "While the Likelihood Ratio (LR) method is elegant, it is not the only tool for sensitivity analysis; the more intuitive correlated Finite Difference (FD) method is a common alternative. The choice between them is a critical strategic decision for any practitioner, involving a nuanced trade-off between computational cost, statistical uncertainty, and implementation complexity. This practice  guides you through a comparative analysis of these two methods, examining their respective strengths and weaknesses concerning bias, variance, and applicability to different types of physical perturbations.",
            "id": "4236727",
            "problem": "A reactor physics analyst is considering two Monte Carlo perturbation techniques to estimate derivatives of responses in a critical reactor, including the effective multiplication factor ($k_\\text{eff}$) and region-integrated fluxes. The parameterized transport model depends on a scalar parameter $\\theta$ that scales a localized microscopic absorption cross section in a material region. Let $R(\\theta)$ denote a differentiable response functional that can be represented as an expectation with respect to the parameter-dependent path distribution $p_\\theta(X)$, where $X$ is a random history (neutron path and interaction sequence) generated by the Monte Carlo transport simulation. The analyst considers:\n\n(i) a single-run Likelihood Ratio (LR) estimator that uses the score function $s_\\theta(X) = \\frac{\\partial}{\\partial \\theta}\\ln p_\\theta(X)$ to form the derivative estimator based on a common ensemble of histories at the nominal parameter, and\n\n(ii) a two-run correlated finite difference (FD) estimator that uses common random numbers (CRN) to couple two simulations at $\\theta+\\epsilon$ and $\\theta-\\epsilon$, and then approximates the derivative by a central difference quotient with step $\\epsilon$.\n\nStarting from fundamental definitions of expectations and basic properties of variances and covariances, the analyst seeks criteria for choosing between the two methods in practical reactor problems, including cases where the perturbation modifies material cross sections within a fixed geometry and cases where the perturbation corresponds to moving a control rod boundary by a small distance. Which of the following statements are correct?\n\nA. For small cross-section perturbations confined to a fixed geometry, the single-run LR estimator of $\\frac{dR}{d\\theta}$ is unbiased and its variance does not blow up as $\\epsilon \\to 0$, whereas the variance of the correlated central FD derivative estimator scales like $O(\\epsilon^{-2}(1-\\rho))$, where $\\rho$ is the correlation coefficient between the two run responses. Therefore, unless $1-\\rho = O(\\epsilon^2)$ as $\\epsilon \\to 0$, the LR method typically has better efficiency for very small steps.\n\nB. When the perturbation is a geometric change that moves a material interface (for example, a control rod boundary) by a distance comparable to a mean free path, the standard pathwise LR score $s_\\theta(X)$ is not well defined for trajectories that cross the moved boundary without specialized surface-term corrections, so correlated FD is generally preferred for such shape perturbations.\n\nC. If one requires gradients with respect to many independent cross sections, the LR method can provide all partial derivatives in a single simulation by accumulating a vector of score-function terms, while the correlated FD method requires a separate pair of runs per parameter; thus LR is typically more efficient in high-dimensional parameter spaces.\n\nD. In optically thick perturbation regions with high absorption, the LR score always has bounded variance due to exponential attenuation, so LR uniformly outperforms correlated FD regardless of the correlation level.\n\nE. For a smooth response $R(\\theta)$, the central FD derivative estimator has truncation bias $O(\\epsilon^2)$, and its variance behaves like $\\frac{\\mathrm{Var}(Y_{+}) + \\mathrm{Var}(Y_{-}) - 2\\,\\mathrm{Cov}(Y_{+},Y_{-})}{4\\epsilon^2}$; with common random numbers and approximately equal variances, this reduces to $\\approx \\frac{\\sigma^2}{2N\\epsilon^2}(1-\\rho)$, implying that achieving competitive efficiency requires $\\rho \\to 1$ as $\\epsilon \\to 0$.",
            "solution": "The problem asks for an evaluation of statements comparing two Monte Carlo perturbation techniques: the single-run Likelihood Ratio (LR) method and the two-run correlated Finite Difference (FD) method. We begin by formalizing the estimators and their properties.\n\nLet the response be given by the expectation $R(\\theta) = \\mathbb{E}_{p_\\theta}[f(X)] = \\int f(X) p_\\theta(X) dX$, where $f(X)$ is the score for a particle history $X$ and $p_\\theta(X)$ is the probability density of that history, dependent on a parameter $\\theta$.\n\n**1. Likelihood Ratio (LR) Method**\n\nThe derivative of the response is $\\frac{dR}{d\\theta} = \\frac{d}{d\\theta} \\int f(X) p_\\theta(X) dX$. Under the condition that differentiation and integration can be interchanged (i.e., the domain of integration is independent of $\\theta$ and $p_\\theta(X)$ is sufficiently smooth), we have:\n$$ \\frac{dR}{d\\theta} = \\int f(X) \\frac{\\partial p_\\theta(X)}{\\partial \\theta} dX = \\int f(X) \\left( \\frac{1}{p_\\theta(X)} \\frac{\\partial p_\\theta(X)}{\\partial \\theta} \\right) p_\\theta(X) dX $$\nThis can be written as an expectation:\n$$ \\frac{dR}{d\\theta} = \\mathbb{E}_{p_\\theta} \\left[ f(X) \\frac{\\partial \\ln p_\\theta(X)}{\\partial \\theta} \\right] = \\mathbb{E}_{p_\\theta} [f(X) s_\\theta(X)] $$\nwhere $s_\\theta(X) = \\frac{\\partial}{\\partial \\theta}\\ln p_\\theta(X)$ is the score function. The LR estimator based on $N$ samples $\\{X_i\\}_{i=1}^N$ drawn from the nominal distribution $p_\\theta(X)$ is:\n$$ \\left( \\frac{dR}{d\\theta} \\right)_{\\text{LR}} = \\frac{1}{N} \\sum_{i=1}^N f(X_i) s_\\theta(X_i) $$\nThis estimator is unbiased, provided the interchange of operators is valid. Its variance is $\\frac{1}{N}\\mathrm{Var}_{p_\\theta}[f(X)s_\\theta(X)]$, which is a constant independent of any finite difference step size.\n\n**2. Finite Difference (FD) Method**\n\nThe central difference approximation to the derivative is:\n$$ \\frac{dR}{d\\theta} \\approx \\frac{R(\\theta+\\epsilon) - R(\\theta-\\epsilon)}{2\\epsilon} $$\nThe FD estimator uses two separate simulations, one at $\\theta+\\epsilon$ and one at $\\theta-\\epsilon$. Let $Y_+ = f(X_+)$ with $X_+ \\sim p_{\\theta+\\epsilon}$ and $Y_- = f(X_-)$ with $X_- \\sim p_{\\theta-\\epsilon}$. The estimator based on $N$ pairs of samples is:\n$$ \\left( \\frac{dR}{d\\theta} \\right)_{\\text{FD}} = \\frac{\\bar{Y}_+ - \\bar{Y}_-}{2\\epsilon} = \\frac{1}{N} \\sum_{i=1}^N \\frac{f(X_{+,i}) - f(X_{-,i})}{2\\epsilon} $$\nUsing common random numbers (CRN) induces a positive correlation between $Y_{+,i}$ and $Y_{-,i}$.\n\n*   **Bias of FD:** A Taylor expansion of $R(\\theta)$ around $\\theta$ shows that the truncation bias of the central difference formula is $O(\\epsilon^2)$:\n    $$ \\frac{R(\\theta+\\epsilon) - R(\\theta-\\epsilon)}{2\\epsilon} = \\frac{dR}{d\\theta} + \\frac{\\epsilon^2}{6}\\frac{d^3R}{d\\theta^3} + O(\\epsilon^4) $$\n*   **Variance of FD:** The variance of the estimator is:\n    $$ \\mathrm{Var}\\left[\\left(\\frac{dR}{d\\theta}\\right)_{\\text{FD}}\\right] = \\mathrm{Var}\\left[\\frac{\\bar{Y}_+ - \\bar{Y}_-}{2\\epsilon}\\right] = \\frac{\\mathrm{Var}(\\bar{Y}_+) + \\mathrm{Var}(\\bar{Y}_-) - 2\\mathrm{Cov}(\\bar{Y}_+, \\bar{Y}_-)}{4\\epsilon^2} $$\n    For large $N$, this is $\\frac{1}{N} \\frac{\\mathrm{Var}(Y_+) + \\mathrm{Var}(Y_-) - 2\\mathrm{Cov}(Y_+, Y_-)}{4\\epsilon^2}$. If we assume $\\mathrm{Var}(Y_+) \\approx \\mathrm{Var}(Y_-) \\approx \\sigma^2$ and define the correlation coefficient $\\rho = \\frac{\\mathrm{Cov}(Y_+, Y_-)}{\\sqrt{\\mathrm{Var}(Y_+)\\mathrm{Var}(Y_-)}}$, the variance becomes:\n    $$ \\mathrm{Var}\\left[\\left(\\fracdR}{d\\theta}\\right)_{\\text{FD}}\\right] \\approx \\frac{2\\sigma^2 - 2\\rho\\sigma^2}{4N\\epsilon^2} = \\frac{\\sigma^2(1-\\rho)}{2N\\epsilon^2} $$\nThis variance scales as $O(\\epsilon^{-2}(1-\\rho))$.\n\nWith these fundamentals, we evaluate each option.\n\n**Option A:**\nThis statement discusses small cross-section perturbations in a fixed geometry.\n- The claim that the LR estimator is unbiased is correct. For cross-section perturbations, the domain of integration is fixed, and the path probability density $p_\\theta(X)$ is typically non-zero over the same set of paths for different $\\theta$, allowing for the interchange of differentiation and integration.\n- The claim that its variance does not blow up as $\\epsilon \\to 0$ is also correct. The LR estimator's formulation and variance are independent of any finite difference step $\\epsilon$.\n- The claim that the variance of the correlated central FD estimator scales like $O(\\epsilon^{-2}(1-\\rho))$ is correct, as derived above.\n- The conclusion is that LR is typically more efficient for very small steps unless $1-\\rho = O(\\epsilon^2)$. The total error of the FD method has two components: a bias term of $O(\\epsilon^2)$ and a statistical variance term of $O(\\epsilon^{-2}(1-\\rho))$. For the variance to remain bounded as $\\epsilon \\to 0$, it is necessary that $1-\\rho$ approaches zero at a rate of at least $O(\\epsilon^2)$. If this condition is not met, the FD variance will diverge as $\\epsilon \\to 0$, making the fixed-variance LR method more efficient. The statement is a correct analysis of the efficiency trade-off. For smoothly varying cross sections, CRN can often achieve $1-\\rho = O(\\epsilon^2)$, but the statement's logic is sound in placing this as a condition.\n**Verdict: Correct.**\n\n**Option B:**\nThis statement addresses geometric perturbations, such as moving a control rod boundary.\n- A geometric perturbation changes the domain boundaries. This means the support of the probability density $p_\\theta(X)$ changes with $\\theta$. For a path $X$ that crosses the perturbed boundary, $p_\\theta(X)$ may be non-zero for some values of $\\theta$ and zero for others. This non-differentiability and lack of absolute continuity invalidates the simple interchange of derivative and integral. The score $s_\\theta(X)$ becomes ill-defined, involving delta functions at the boundary.\n- To handle this, specialized techniques that introduce surface integrals (boundary terms) are required, which are corrections to the standard \"pathwise LR score.\"\n- In the absence of these complex corrections, the FD method is a more straightforward and robust approach. It directly simulates the systems with the boundary at $\\theta+\\epsilon$ and $\\theta-\\epsilon$. Although the effectiveness of CRN may be reduced if paths diverge significantly, the method remains applicable. Thus, correlated FD is indeed generally preferred for such problems in standard practice.\n**Verdict: Correct.**\n\n**Option C:**\nThis statement compares the methods for problems with many independent parameters, e.g., cross sections in different regions or energy groups.\n- For the LR method, to compute the gradient $\\nabla_\\theta R$ with respect to a vector of parameters $\\vec{\\theta} = (\\theta_1, \\dots, \\theta_M)$, one needs to compute the score vector $\\vec{s}_{\\vec{\\theta}}(X) = (\\frac{\\partial \\ln p_{\\vec{\\theta}}(X)}{\\partial \\theta_1}, \\dots, \\frac{\\partial \\ln p_{\\vec{\\theta}}(X)}{\\partial \\theta_M})$. All derivatives $\\frac{\\partial R}{\\partial \\theta_j} = \\mathbb{E}[f(X) s_{\\theta_j}(X)]$ are expectations with respect to the same nominal distribution $p_{\\vec{\\theta}}(X)$. Therefore, a single Monte Carlo simulation can be used to estimate all $M$ partial derivatives by accumulating the product of the tally $f(X_i)$ with each component of the score vector for each history $X_i$. The computational cost is roughly that of a single simulation, plus the (usually minor) overhead of calculating $M$ score components.\n- For the FD method, estimating each partial derivative $\\frac{\\partial R}{\\partial \\theta_j}$ requires a pair of simulations at parameter values $\\vec{\\theta} \\pm \\epsilon \\hat{e}_j$, where $\\hat{e}_j$ is the unit vector for the $j$-th parameter. To estimate the full gradient, this must be repeated for all $M$ parameters, requiring $M$ pairs of runs, or $2M$ simulations in total.\n- The conclusion that LR is typically more efficient in high-dimensional parameter spaces ($M \\gg 1$) is therefore correct, as its cost is roughly independent of $M$ while the cost of FD scales linearly with $M$.\n**Verdict: Correct.**\n\n**Option D:**\nThis statement makes a strong claim about the LR method in optically thick, high-absorption regions.\n- The claim is that the LR score variance is \"always bounded due to exponential attenuation\". This is factually incorrect. The variance of the LR estimator, $\\mathrm{Var}[f(X)s_\\theta(X)]$, can be very large or even infinite in precisely such problems. While attenuation reduces the probability of long neutron paths, the score $s_\\theta(X)$ for such rare paths can be extremely large. The score accumulates with each interaction in the perturbed region. If a perturbation reduces absorption, formerly rare (highly attenuated) paths become more probable, and these paths carry large weights in the derivative calculation, leading to high variance. This issue is a well-known limitation of the LR method, especially in deep penetration or shielding problems. High absorption does not guarantee a small or bounded variance; it often makes it worse.\n- The subsequent conclusion that \"LR uniformly outperforms correlated FD regardless of the correlation level\" is false. The choice of method is highly problem-dependent, and given that the premise about LR variance is flawed, this generalization is unsubstantiated. Correlated FD can be superior if the correlation is high and/or the LR variance is excessive.\n**Verdict: Incorrect.**\n\n**Option E:**\nThis statement analyzes the error components of the central FD estimator.\n- The bias is correctly identified as $O(\\epsilon^2)$ for a smooth response $R(\\theta)$. This is a standard result for central differences.\n- The variance formula $\\frac{\\mathrm{Var}(Y_{+}) + \\mathrm{Var}(Y_{-}) - 2\\,\\mathrm{Cov}(Y_{+},Y_{-})}{4\\epsilon^2}$ is the correct expression for the variance of the quantity $\\frac{Y_+ - Y_-}{2\\epsilon}$ (i.e., for a sample size of $N=1$).\n- The reduction to $\\approx \\frac{\\sigma^2}{2N\\epsilon^2}(1-\\rho)$ under the assumption of CRN and approximately equal variances (letting $\\sigma^2 \\approx \\mathrm{Var}(Y_\\pm)$ and accounting for a sample size of $N$) is also a standard and correct derivation.\n- The implication that competitive efficiency requires $\\rho \\to 1$ as $\\epsilon \\to 0$ is a direct and crucial consequence. To prevent the variance from blowing up due to the $\\epsilon^{-2}$ term, the factor $(1-\\rho)$ must go to zero. Since $\\rho \\le 1$, this means $\\rho$ must approach $1$. This insight is fundamental to understanding the behavior of correlated FD methods.\n**Verdict: Correct.**\n\nFinal summary: Statements A, B, C, and E are correct descriptions of the properties and comparative merits of the LR and correlated FD methods in Monte Carlo transport. Statement D is incorrect as it mischaracterizes the behavior of the LR estimator's variance in optically thick problems.",
            "answer": "$$\\boxed{ABCE}$$"
        },
        {
            "introduction": "Implementing perturbation methods in production-level Monte Carlo codes requires addressing the complexities of non-analog simulations, particularly the use of variance reduction techniques. Techniques like splitting and Russian roulette are essential for efficient eigenvalue calculations but modify the sampling process in ways that can interact with the Likelihood Ratio (LR) score. This advanced exercise  explores this critical interplay, challenging you to determine how these population control mechanisms affect the LR estimator and what conditions are necessary to maintain an unbiased sensitivity calculation.",
            "id": "4236732",
            "problem": "Consider a steady-state neutron multiplication problem in a nuclear reactor core, where the fundamental mode eigenvalue problem of the linear Boltzmann transport with fission is simulated by Monte Carlo (MC) power iteration. Let the physical path measure for a single particle history be denoted by the parameterized density $p_{\\epsilon}(\\omega)$, where $\\epsilon$ controls a small perturbation to material cross sections and $p_{\\epsilon}$ encodes the analog physics of free flights, collisions, and fission events. Let a scalar response be $R(\\epsilon) = \\mathbb{E}_{\\epsilon}[T(\\omega)]$ for a cycle-average tally $T(\\omega)$ taken with the standard per-cycle source normalization used in eigenvalue MC. Define $\\delta R = \\left.\\frac{\\mathrm{d}}{\\mathrm{d}\\epsilon} R(\\epsilon)\\right|_{\\epsilon=0}$. The Likelihood Ratio (LR) method constructs the pathwise score \n$$\nL(\\omega) = \\left.\\frac{\\partial}{\\partial \\epsilon} \\ln p_{\\epsilon}(\\omega)\\right|_{\\epsilon=0}\n$$\nand forms an unbiased estimator of $\\delta R$ by augmenting the tally with $L(\\omega)$ (together with any additional terms required when the tally includes $\\epsilon$-dependent normalization). In eigenvalue MC, population control and variance reduction are often implemented by splitting and Russian roulette. In splitting, a particle of weight $w$ is replaced by $M$ offspring, each initially assigned weight $w/M$, where $M$ may depend on a user-prescribed importance map but is designed so that expected weight is conserved. In Russian roulette, a particle of weight $w$ is terminated with kill probability $p_{k}$ and, conditional on survival, its weight is increased to $w/(1-p_{k})$, again conserving expected weight. Population control and MC power iteration apply a per-cycle normalization factor $c_{\\epsilon}$ to stabilize the particle population, which depends (implicitly or explicitly) on the eigenvalue and therefore on $\\epsilon$.\n\nFrom first principles of importance sampling and change-of-measure, the LR estimator is constructed with respect to the physical path density $p_{\\epsilon}$, while splitting, roulette, and per-cycle normalization are parts of the sampling scheme that may or may not depend on $\\epsilon$. Analyze how splitting and Russian roulette affect the accumulation of $L(\\omega)$ and the unbiasedness of $\\delta R$. Choose all statements that are correct.\n\nA. In eigenvalue MC, the per-cycle source normalization introduces a factor $c_{\\epsilon}$ in the tally definition. The LR score must include the contribution $\\left.\\frac{\\partial}{\\partial \\epsilon}\\ln c_{\\epsilon}\\right|_{\\epsilon=0}$ to preserve unbiasedness of $\\delta R$. Splitting and Russian roulette, when implemented with $\\epsilon$-independent branching and weight adjustments that conserve expected weight, do not alter $L(\\omega)$ and do not bias the LR-based $\\delta R$ estimator.\n\nB. Splitting multiplies the LR $L(\\omega)$ by the realized multiplicity $M$, because each offspring copies the parent’s $L(\\omega)$; unless $L(\\omega)$ is divided by $M$ after splitting, the LR-based estimator of $\\delta R$ is biased high.\n\nC. Russian roulette affects only the variance of the LR-based estimator. If the survival probability $p_{\\text{surv}} = 1 - p_{k}$ is independent of $\\epsilon$ and survivors are reweighted by $1/p_{\\text{surv}}$, then the accumulation of $L(\\omega)$ is unchanged and $\\delta R$ remains unbiased.\n\nD. In eigenvalue MC, any use of splitting or Russian roulette necessarily biases the LR-based estimator of $\\delta R$ because the number of contributing histories changes under population control; to avoid bias, these techniques must be disabled when computing $\\delta R$.\n\nE. If the splitting importance map or roulette thresholds depend on cross sections that are perturbed by $\\epsilon$, then the branching probabilities depend on $\\epsilon$; in this case, the LR must include the derivative of the log of the splitting or roulette decision probability, and omitting this term biases $\\delta R$.\n\nSelect all correct options.",
            "solution": "The problem statement is subjected to validation before proceeding to a solution.\n\n### Step 1: Extract Givens\n-   **Problem Context**: Steady-state neutron multiplication in a nuclear reactor core, simulated using Monte Carlo (MC) power iteration for the fundamental mode eigenvalue problem of the linear Boltzmann equation.\n-   **Path Measure**: The physical path measure for a particle history $\\omega$ is a parameterized density $p_{\\epsilon}(\\omega)$. The parameter $\\epsilon$ represents a small perturbation to material cross sections.\n-   **Response**: A scalar response $R(\\epsilon) = \\mathbb{E}_{\\epsilon}[T(\\omega)]$, where $T(\\omega)$ is a cycle-average tally.\n-   **Normalization**: The tally $T(\\omega)$ incorporates a \"standard per-cycle source normalization\" factor, denoted as $c_{\\epsilon}$, which depends on the eigenvalue and thus on $\\epsilon$.\n-   **Sensitivity**: The quantity to be estimated is the first-order sensitivity $\\delta R = \\left.\\frac{\\mathrm{d}}{\\mathrm{d}\\epsilon} R(\\epsilon)\\right|_{\\epsilon=0}$.\n-   **Likelihood Ratio (LR) Score**: The pathwise score is defined as $L(\\omega) = \\left.\\frac{\\partial}{\\partial \\epsilon} \\ln p_{\\epsilon}(\\omega)\\right|_{\\epsilon=0}$.\n-   **LR Estimator**: The estimator for $\\delta R$ is formed by augmenting the tally with $L(\\omega)$ and any terms from $\\epsilon$-dependent normalization.\n-   **Variance Reduction**: The simulation uses population control techniques:\n    -   **Splitting**: A particle of weight $w$ is replaced by $M$ offspring, each with weight $w/M$.\n    -   **Russian Roulette (RR)**: A particle of weight $w$ is terminated with probability $p_{k}$ or survives with weight $w/(1-p_{k})$.\n-   **Conservation**: Both splitting and RR are stated to conserve expected weight.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Grounding**: The problem describes the application of the Likelihood Ratio (LR) method, a well-established technique for sensitivity analysis in stochastic simulations, to the specific context of nuclear reactor eigenvalue calculations using Monte Carlo. The concepts of power iteration, path density, cross-section perturbation, splitting, Russian roulette, and weight-based estimators are all standard and fundamental to the field of computational nuclear engineering and transport theory. The problem is scientifically and mathematically sound.\n-   **Well-Posed**: The question asks for a qualitative analysis of how specific algorithmic choices (splitting and RR) affect the unbiasedness of the LR estimator. This is a well-defined conceptual problem that can be resolved by applying the first principles of importance sampling and Monte Carlo estimators. A unique and meaningful answer can be derived.\n-   **Objectivity**: The problem is stated in precise, formal language common to computational physics. All terms have objective mathematical or physical definitions.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is a well-formulated question about the interaction between a sensitivity analysis method and standard variance reduction techniques in Monte Carlo simulations. The solution process may proceed.\n\n### Derivation from First Principles\nThe response is given by $R(\\epsilon) = \\mathbb{E}_{\\epsilon}[T(\\omega)]$. The problem states that the tally $T(\\omega)$ includes an $\\epsilon$-dependent normalization factor $c_{\\epsilon}$. Let us write the tally as $T(\\omega, \\epsilon) = c_{\\epsilon} T_u(\\omega)$, where $T_u(\\omega)$ is an unnormalized tally score that depends only on the physical path $\\omega$ and not on $\\epsilon$. The expectation is taken over the path measure $p_{\\epsilon}(\\omega)$:\n$$\nR(\\epsilon) = \\int T(\\omega, \\epsilon) p_{\\epsilon}(\\omega) \\mathrm{d}\\omega = c_{\\epsilon} \\int T_u(\\omega) p_{\\epsilon}(\\omega) \\mathrm{d}\\omega\n$$\nWe seek the derivative $\\delta R = \\left.\\frac{\\mathrm{d}R}{\\mathrm{d}\\epsilon}\\right|_{\\epsilon=0}$. Using the product rule:\n$$\n\\frac{\\mathrm{d}R}{\\mathrm{d}\\epsilon} = \\frac{\\mathrm{d}c_{\\epsilon}}{\\mathrm{d}\\epsilon} \\int T_u(\\omega) p_{\\epsilon}(\\omega) \\mathrm{d}\\omega + c_{\\epsilon} \\int T_u(\\omega) \\frac{\\mathrm{d}p_{\\epsilon}(\\omega)}{\\mathrm{d}\\epsilon} \\mathrm{d}\\omega\n$$\nUsing the identity $\\frac{\\mathrm{d}p_{\\epsilon}}{\\mathrm{d}\\epsilon} = \\left(\\frac{\\mathrm{d} \\ln p_{\\epsilon}}{\\mathrm{d}\\epsilon}\\right) p_{\\epsilon}$, we substitute this into the second term:\n$$\n\\frac{\\mathrm{d}R}{\\mathrm{d}\\epsilon} = \\frac{\\mathrm{d}c_{\\epsilon}}{\\mathrm{d}\\epsilon} \\int T_u(\\omega) p_{\\epsilon}(\\omega) \\mathrm{d}\\omega + c_{\\epsilon} \\int T_u(\\omega) \\left(\\frac{\\mathrm{d} \\ln p_{\\epsilon}}{\\mathrm{d}\\epsilon}\\right) p_{\\epsilon}(\\omega) \\mathrm{d}\\omega\n$$\nEvaluating this expression at $\\epsilon=0$, we note that the integrals become expectations with respect to the unperturbed measure $p_{0}(\\omega)$, denoted by $\\mathbb{E}_{0}[\\cdot]$.\n$$\n\\delta R = \\left.\\frac{\\mathrm{d}c_{\\epsilon}}{\\mathrm{d}\\epsilon}\\right|_{\\epsilon=0} \\mathbb{E}_{0}[T_u(\\omega)] + c_{0} \\mathbb{E}_{0}\\left[T_u(\\omega) \\left.\\left(\\frac{\\mathrm{d} \\ln p_{\\epsilon}}{\\mathrm{d}\\epsilon}\\right)\\right|_{\\epsilon=0}\\right]\n$$\nBy definition, $L(\\omega) = \\left.\\frac{\\partial}{\\partial \\epsilon} \\ln p_{\\epsilon}(\\omega)\\right|_{\\epsilon=0}$. Also, $\\left.\\frac{\\mathrm{d}c_{\\epsilon}}{\\mathrm{d}\\epsilon}\\right|_{\\epsilon=0} = c_0 \\left.\\frac{\\mathrm{d} \\ln c_{\\epsilon}}{\\mathrm{d}\\epsilon}\\right|_{\\epsilon=0}$. Furthermore, $T(\\omega, 0) = c_0 T_u(\\omega)$. Substituting these gives:\n$$\n\\delta R = c_0 \\left.\\frac{\\mathrm{d} \\ln c_{\\epsilon}}{\\mathrm{d}\\epsilon}\\right|_{\\epsilon=0} \\frac{1}{c_0}\\mathbb{E}_{0}[T(\\omega, 0)] + \\mathbb{E}_{0}[T(\\omega, 0) L(\\omega)]\n$$\n$$\n\\delta R = \\mathbb{E}_{0}\\left[ T(\\omega, 0) \\left( L(\\omega) + \\left.\\frac{\\mathrm{d} \\ln c_{\\epsilon}}{\\mathrm{d}\\epsilon}\\right|_{\\epsilon=0} \\right) \\right]\n$$\nThis shows that an unbiased estimator for $\\delta R$ is obtained by scoring the quantity $T(\\omega, 0) \\left( L(\\omega) + \\left.\\frac{\\mathrm{d} \\ln c_{\\epsilon}}{\\mathrm{d}\\epsilon}\\right|_{\\epsilon=0} \\right)$ for each history $\\omega$ sampled from the unperturbed system $p_{0}(\\omega)$.\n\nNow, consider the effect of splitting and Russian roulette. These are variance reduction techniques that operate on weighted particles. They are designed to preserve the expectation of any tallied score. Let $S(\\omega)$ be any score for an analog history $\\omega$. In a non-analog simulation with weights, the estimator is the average of $w(\\omega)S(\\omega)$, where $w$ is the particle weight. The games are constructed such that $\\mathbb{E}_{\\text{non-analog}}[w S] = \\mathbb{E}_{\\text{analog}}[S]$. The LR method requires tallying $S'(\\omega) = T(\\omega, 0) \\left( L(\\omega) + \\left.\\frac{\\mathrm{d} \\ln c_{\\epsilon}}{\\mathrm{d}\\epsilon}\\right|_{\\epsilon=0} \\right)$. The MC code will estimate $\\mathbb{E}_{0}[S'(\\omega)]$ by averaging $w(\\omega)S'(\\omega)$. The key question is whether the use of splitting and RR makes this estimate biased.\n\nCase 1: Splitting/RR rules are independent of $\\epsilon$.\nIn this case, the probabilities governing the splitting/RR decisions are not part of the physical path density $p_{\\epsilon}(\\omega)$. They are part of the sampling algorithm, not the underlying probability measure being differentiated. The LR score $L(\\omega)$ is accumulated along the physical path, unaffected by these games.\n-   At a splitting event, a particle with weight $w$ and accumulated score $L$ is replaced by $M$ particles, each given weight $w/M$ and inheriting the score $L$. The total score-weight product is conserved: $w L \\rightarrow \\sum_{i=1}^M (w/M) L = wL$.\n-   At an RR event, a particle with weight $w$ and score $L$ is killed with probability $p_k$ or survives with weight $w/(1-p_k)$ and score $L$ with probability $1-p_k$. The expected score-weight product is conserved: $(0 \\cdot p_k) + ( \\frac{w}{1-p_k} L \\cdot (1-p_k) ) = wL$.\nSince the expected value of the score-weight product is conserved at each step, the overall expectation of the final tallied quantity $w(\\omega)S'(\\omega)$ is preserved. The estimator remains unbiased.\n\nCase 2: Splitting/RR rules depend on $\\epsilon$.\nThis occurs if the importance map or other parameters for these games are functions of the perturbed cross sections. In this scenario, the probabilities of the splitting/RR branching events must be considered part of the overall path density $p_{\\epsilon}(\\omega)$. For instance, if the probability of a specific splitting decision is $q_{\\epsilon}$, then $\\ln p_{\\epsilon}(\\omega)$ contains a term $\\ln q_{\\epsilon}$. Consequently, the LR score $L(\\omega)$ must include the term $\\left.\\frac{\\partial}{\\partial \\epsilon} \\ln q_{\\epsilon}\\right|_{\\epsilon=0}$. Omitting this term means the score $L(\\omega)$ is incomplete, and the resulting estimator for $\\delta R$ will be biased.\n\n### Option-by-Option Analysis\n\n**A. In eigenvalue MC, the per-cycle source normalization introduces a factor $c_{\\epsilon}$ in the tally definition. The LR score must include the contribution $\\left.\\frac{\\partial}{\\partial \\epsilon}\\ln c_{\\epsilon}\\right|_{\\epsilon=0}$ to preserve unbiasedness of $\\delta R$. Splitting and Russian roulette, when implemented with $\\epsilon$-independent branching and weight adjustments that conserve expected weight, do not alter $L(\\omega)$ and do not bias the LR-based $\\delta R$ estimator.**\n-   The first part regarding the normalization constant $c_{\\epsilon}$ is confirmed by our derivation. The full multiplier on the tally a posteriori is the sum of the physical score $L(\\omega)$ and the term from the normalization derivative. It is common practice to refer to this entire corrective factor as the \"score.\"\n-   The second part corresponds to Case $1$ in our analysis. If the variance reduction games are $\\epsilon$-independent, they are simply part of the machinery for sampling from $p_0(\\omega)$ and correctly preserve the expectation of the LR estimator.\n-   **Verdict: Correct.**\n\n**B. Splitting multiplies the LR $L(\\omega)$ by the realized multiplicity $M$, because each offspring copies the parent’s $L(\\omega)$; unless $L(\\omega)$ is divided by $M$ after splitting, the LR-based estimator of $\\delta R$ is biased high.**\n-   This statement fundamentally misunderstands the interplay between weights and scores. Each of the $M$ offspring inherits the parent's score $L(\\omega)$, but also has its weight divided by $M$. The quantity that is conserved in expectation is the score-weight product $w L$. The statement incorrectly suggests that the total score is multiplied by $M$. The total score-weight is what is conserved instantaneously at the split ($w L \\rightarrow M \\times \\frac{w}{M} \\times L = w L$), and the estimator remains unbiased without any ad-hoc division of $L(\\omega)$.\n-   **Verdict: Incorrect.**\n\n**C. Russian roulette affects only the variance of the LR-based estimator. If the survival probability $p_{\\text{surv}} = 1 - p_{k}$ is independent of $\\epsilon$ and survivors are reweighted by $1/p_{\\text{surv}}$, then the accumulation of $L(\\omega)$ is unchanged and $\\delta R$ remains unbiased.**\n-   This is a correct and specific instance of Case $1$ from our analysis, applied to Russian roulette. If the survival probability is $\\epsilon$-independent, the RR game does not contribute to the LR score $L(\\omega)$. The weight adjustment $w \\rightarrow w/p_{\\text{surv}}$ ensures that the expected score-weight product is conserved, thereby preserving unbiasedness. The purpose of RR is indeed to control variance (by culling low-importance particles).\n-   **Verdict: Correct.**\n\n**D. In eigenvalue MC, any use of splitting or Russian roulette necessarily biases the LR-based estimator of $\\delta R$ because the number of contributing histories changes under population control; to avoid bias, these techniques must be disabled when computing $\\delta R$.**\n-   This statement is an overgeneralization and is factually incorrect. As demonstrated by the analysis for options A and C, if the splitting and RR games are designed to be independent of the perturbation parameter $\\epsilon$, they do not introduce bias. The weight adjustment mechanism is precisely what accounts for the changing number of particles/histories to ensure the expectation remains correct. Disabling these techniques is a sufficient but not a necessary condition for unbiasedness, and doing so would often be computationally prohibitive.\n-   **Verdict: Incorrect.**\n\n**E. If the splitting importance map or roulette thresholds depend on cross sections that are perturbed by $\\epsilon$, then the branching probabilities depend on $\\epsilon$; in this case, the LR must include the derivative of the log of the splitting or roulette decision probability, and omitting this term biases $\\delta R$.**\n-   This statement correctly describes Case $2$ from our analysis. If the rules of the variance reduction game depend on $\\epsilon$, their probabilities are part of the full path measure $p_{\\epsilon}(\\omega)$. Therefore, the LR score $L(\\omega)$ must be augmented with terms corresponding to the derivatives of the logarithms of these branching probabilities. Failing to include these terms leads to an incomplete score and a biased estimator for $\\delta R$.\n-   **Verdict: Correct.**",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}