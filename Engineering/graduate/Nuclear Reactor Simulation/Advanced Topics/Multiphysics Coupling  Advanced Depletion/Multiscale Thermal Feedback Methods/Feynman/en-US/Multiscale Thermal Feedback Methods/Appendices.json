{
    "hands_on_practices": [
        {
            "introduction": "Before simulating complex, core-wide transients, it is essential to understand how fundamental physical changes translate into macroscopic reactor behavior. The Doppler effect, or the temperature-dependent broadening of neutron absorption resonances in fuel, provides a critical and prompt negative feedback mechanism. This first exercise guides you through a foundational calculation, demonstrating how to derive the Doppler reactivity coefficient from given microscopic cross-section sensitivities for a simplified pin cell . Mastering this connection is the first step toward building robust multiscale feedback models.",
            "id": "4237400",
            "problem": "A canonical infinite-lattice pin cell is modeled with a one-group, homogenized description. Assume neutronic leakage is negligible. At a base fuel temperature $T_{f,0}$, the macroscopic one-group parameters are\n- fuel absorption cross section $\\Sigma_{a,f,0} = 0.06 \\ \\mathrm{cm^{-1}}$,\n- moderator absorption cross section $\\Sigma_{a,m,0} = 0.02 \\ \\mathrm{cm^{-1}}$,\n- neutron production cross section $\\nu \\Sigma_{f,0} = 0.12 \\ \\mathrm{cm^{-1}}$.\n\nOver small fuel temperature changes about $T_{f,0}$, the only non-negligible temperature dependences are given by the linear sensitivities\n- $\\dfrac{\\partial \\Sigma_{a,f}}{\\partial T_f}\\bigg|_{T_{f,0}} = 6.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}$,\n- $\\dfrac{\\partial (\\nu \\Sigma_f)}{\\partial T_f}\\bigg|_{T_{f,0}} = -2.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}$,\n\nand you may neglect the dependence of moderator cross sections and scattering on the fuel temperature. Use the one-group definition of the infinite multiplication factor $k_{\\infty}$,\n$$\nk_{\\infty} = \\frac{\\nu \\Sigma_f}{\\Sigma_a}, \\quad \\Sigma_a = \\Sigma_{a,f} + \\Sigma_{a,m},\n$$\nand the definition of reactivity $\\rho$,\n$$\n\\rho = \\frac{k - 1}{k}.\n$$\n\nFirst, compute the change in the infinite multiplication factor $\\Delta k_{\\infty}$ when the fuel temperature increases by $\\Delta T = +100 \\ \\mathrm{K}$ from $T_{f,0}$, treating the response to temperature as linear about $T_{f,0}$. Then, use this linearized result to determine the pin Doppler coefficient $\\alpha_D = \\dfrac{d\\rho}{dT_f}\\big|_{T_{f,0}}$. Express the final value of $\\alpha_D$ in $1/\\mathrm{K}$ and round your answer to three significant figures. Report only the value of $\\alpha_D$ as your final answer.",
            "solution": "The problem has been validated and is found to be scientifically grounded, well-posed, and objective. It presents a standard problem in nuclear reactor physics based on established principles. All necessary data and definitions are provided, and there are no internal contradictions.\n\nThe objective is to determine the pin Doppler coefficient, $\\alpha_D$, for a homogenized infinite-lattice pin cell. The analysis is based on a one-group neutronics model with specified linear temperature sensitivities for the fuel cross sections.\n\nThe infinite multiplication factor, $k_{\\infty}$, is defined as:\n$$\nk_{\\infty} = \\frac{\\nu \\Sigma_f}{\\Sigma_a}\n$$\nwhere $\\nu \\Sigma_f$ is the macroscopic neutron production cross section and $\\Sigma_a$ is the total macroscopic absorption cross section. The total absorption is the sum of fuel absorption, $\\Sigma_{a,f}$, and moderator absorption, $\\Sigma_{a,m}$:\n$$\n\\Sigma_a = \\Sigma_{a,f} + \\Sigma_{a,m}\n$$\nReactivity, $\\rho$, is defined in terms of a multiplication factor $k$ as:\n$$\n\\rho = \\frac{k - 1}{k}\n$$\nFor an infinite lattice with negligible leakage, the multiplication factor is $k = k_{\\infty}$.\n\nFirst, we establish the reactor state at the base fuel temperature, $T_{f,0}$. The given parameters are:\n- Fuel absorption cross section: $\\Sigma_{a,f,0} = 0.06 \\ \\mathrm{cm^{-1}}$\n- Moderator absorption cross section: $\\Sigma_{a,m,0} = 0.02 \\ \\mathrm{cm^{-1}}$\n- Neutron production cross section: $\\nu \\Sigma_{f,0} = 0.12 \\ \\mathrm{cm^{-1}}$\n\nThe total absorption cross section at the base temperature is:\n$$\n\\Sigma_{a,0} = \\Sigma_{a,f,0} + \\Sigma_{a,m,0} = 0.06 \\ \\mathrm{cm^{-1}} + 0.02 \\ \\mathrm{cm^{-1}} = 0.08 \\ \\mathrm{cm^{-1}}\n$$\nThe infinite multiplication factor at the base temperature is:\n$$\nk_{\\infty,0} = \\frac{\\nu \\Sigma_{f,0}}{\\Sigma_{a,0}} = \\frac{0.12 \\ \\mathrm{cm^{-1}}}{0.08 \\ \\mathrm{cm^{-1}}} = 1.5\n$$\n\nThe first task is to compute the change in the infinite multiplication factor, $\\Delta k_{\\infty}$, for a fuel temperature increase of $\\Delta T_f = +100 \\ \\mathrm{K}$. The problem states to treat the response as linear. The temperature sensitivities are:\n- $\\dfrac{\\partial \\Sigma_{a,f}}{\\partial T_f}\\bigg|_{T_{f,0}} = 6.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}$\n- $\\dfrac{\\partial (\\nu \\Sigma_f)}{\\partial T_f}\\bigg|_{T_{f,0}} = -2.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}$\n\nUsing a first-order Taylor expansion, the changes in the cross sections are:\n$$\n\\Delta \\Sigma_{a,f} = \\left(\\dfrac{\\partial \\Sigma_{a,f}}{\\partial T_f}\\bigg|_{T_{f,0}}\\right) \\Delta T_f = (6.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}) \\times (100 \\ \\mathrm{K}) = 6.0 \\times 10^{-4} \\ \\mathrm{cm^{-1}}\n$$\n$$\n\\Delta (\\nu \\Sigma_f) = \\left(\\dfrac{\\partial (\\nu \\Sigma_f)}{\\partial T_f}\\bigg|_{T_{f,0}}\\right) \\Delta T_f = (-2.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}) \\times (100 \\ \\mathrm{K}) = -2.0 \\times 10^{-4} \\ \\mathrm{cm^{-1}}\n$$\nThe new cross sections at temperature $T_{f,0} + \\Delta T_f$ are:\n$$\n\\Sigma_{a,f,1} = \\Sigma_{a,f,0} + \\Delta \\Sigma_{a,f} = 0.06 + 0.0006 = 0.0606 \\ \\mathrm{cm^{-1}}\n$$\n$$\n(\\nu \\Sigma_f)_1 = \\nu \\Sigma_{f,0} + \\Delta (\\nu \\Sigma_f) = 0.12 - 0.0002 = 0.1198 \\ \\mathrm{cm^{-1}}\n$$\nThe moderator cross section is assumed to be constant, so $\\Sigma_{a,m,1} = \\Sigma_{a,m,0}$. The new total absorption cross section is:\n$$\n\\Sigma_{a,1} = \\Sigma_{a,f,1} + \\Sigma_{a,m,0} = 0.0606 + 0.02 = 0.0806 \\ \\mathrm{cm^{-1}}\n$$\nThe new infinite multiplication factor is:\n$$\nk_{\\infty,1} = \\frac{(\\nu \\Sigma_f)_1}{\\Sigma_{a,1}} = \\frac{0.1198 \\ \\mathrm{cm^{-1}}}{0.0806 \\ \\mathrm{cm^{-1}}} \\approx 1.48635\n$$\nThe change in the multiplication factor is:\n$$\n\\Delta k_{\\infty} = k_{\\infty,1} - k_{\\infty,0} \\approx 1.48635 - 1.5 = -0.01365\n$$\n\nThe second task is to determine the pin Doppler coefficient, $\\alpha_D$, defined as the derivative of reactivity with respect to fuel temperature, evaluated at the base temperature $T_{f,0}$:\n$$\n\\alpha_D = \\dfrac{d\\rho}{dT_f}\\bigg|_{T_{f,0}}\n$$\nFirst, we express the derivative of reactivity in terms of the multiplication factor $k_{\\infty}$:\n$$\n\\rho = 1 - \\frac{1}{k_{\\infty}} \\quad \\implies \\quad \\frac{d\\rho}{dT_f} = \\frac{d}{dT_f}\\left(1 - \\frac{1}{k_{\\infty}}\\right) = \\frac{1}{k_{\\infty}^2} \\frac{dk_{\\infty}}{dT_f}\n$$\nSo, the Doppler coefficient is:\n$$\n\\alpha_D = \\frac{1}{k_{\\infty,0}^2} \\frac{dk_{\\infty}}{dT_f}\\bigg|_{T_{f,0}}\n$$\nWe must now find the analytical derivative of $k_{\\infty}$ with respect to $T_f$. Using the quotient rule on the definition of $k_{\\infty}$:\n$$\n\\frac{dk_{\\infty}}{dT_f} = \\frac{ \\left(\\frac{\\partial(\\nu \\Sigma_f)}{\\partial T_f}\\right) \\Sigma_a - (\\nu \\Sigma_f) \\left(\\frac{\\partial \\Sigma_a}{\\partial T_f}\\right) }{ \\Sigma_a^2 }\n$$\nThe derivative of the total absorption is $\\frac{\\partial \\Sigma_a}{\\partial T_f} = \\frac{\\partial \\Sigma_{a,f}}{\\partial T_f} + \\frac{\\partial \\Sigma_{a,m}}{\\partial T_f}$. Since the moderator cross section's dependence on fuel temperature is negligible, $\\frac{\\partial \\Sigma_{a,m}}{\\partial T_f} = 0$. Thus, $\\frac{\\partial \\Sigma_a}{\\partial T_f} = \\frac{\\partial \\Sigma_{a,f}}{\\partial T_f}$.\n\nEvaluating the derivative at $T_{f,0}$:\n$$\n\\frac{dk_{\\infty}}{dT_f}\\bigg|_{T_{f,0}} = \\frac{ \\left(\\frac{\\partial(\\nu \\Sigma_f)}{\\partial T_f}\\bigg|_{T_{f,0}}\\right) \\Sigma_{a,0} - (\\nu \\Sigma_f)_0 \\left(\\frac{\\partial \\Sigma_{a,f}}{\\partial T_f}\\bigg|_{T_{f,0}}\\right) }{ (\\Sigma_{a,0})^2 }\n$$\nSubstituting the given values:\n$$\n\\frac{dk_{\\infty}}{dT_f}\\bigg|_{T_{f,0}} = \\frac{ (-2.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}) \\times (0.08 \\ \\mathrm{cm^{-1}}) - (0.12 \\ \\mathrm{cm^{-1}}) \\times (6.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}) }{ (0.08 \\ \\mathrm{cm^{-1}})^2 }\n$$\n$$\n\\frac{dk_{\\infty}}{dT_f}\\bigg|_{T_{f,0}} = \\frac{ -1.6 \\times 10^{-7} \\ \\mathrm{cm^{-2} \\ K^{-1}} - 7.2 \\times 10^{-7} \\ \\mathrm{cm^{-2} \\ K^{-1}} }{ 0.0064 \\ \\mathrm{cm^2} } = \\frac{-8.8 \\times 10^{-7} \\ \\mathrm{cm^{-2} \\ K^{-1}}}{6.4 \\times 10^{-3} \\ \\mathrm{cm^2}}\n$$\n$$\n\\frac{dk_{\\infty}}{dT_f}\\bigg|_{T_{f,0}} = -1.375 \\times 10^{-4} \\ \\mathrm{K^{-1}}\n$$\nNow we can compute the Doppler coefficient:\n$$\n\\alpha_D = \\frac{1}{k_{\\infty,0}^2} \\left( \\frac{dk_{\\infty}}{dT_f}\\bigg|_{T_{f,0}} \\right) = \\frac{1}{(1.5)^2} (-1.375 \\times 10^{-4} \\ \\mathrm{K^{-1}}) = \\frac{1}{2.25} (-1.375 \\times 10^{-4} \\ \\mathrm{K^{-1}})\n$$\n$$\n\\alpha_D = -0.61111... \\times 10^{-4} \\ \\mathrm{K^{-1}} = -6.1111... \\times 10^{-5} \\ \\mathrm{K^{-1}}\n$$\nRounding the result to three significant figures, as requested:\n$$\n\\alpha_D \\approx -6.11 \\times 10^{-5} \\ \\mathrm{K^{-1}}\n$$",
            "answer": "$$\\boxed{-6.11 \\times 10^{-5}}$$"
        },
        {
            "introduction": "When simulating the coupled evolution of neutronics and thermal-hydraulics, a common and efficient strategy is operator splitting, where each physics is advanced sequentially over a small time step. However, this explicit separation can introduce numerical errors that do not exist in the underlying continuous physics, sometimes leading to spurious oscillations or instability. This practice uses a hypothetical model to explore this very phenomenon, asking you to analytically determine the stability limit for a first-order splitting scheme . This analysis reveals why the choice of numerical method and time step size is as critical as the physical model itself.",
            "id": "4237433",
            "problem": "Consider a lumped (zero-dimensional) multiscale model of neutron kinetics coupled to thermal feedback in a homogeneous reactor region, where the neutron population $n(t)$ and the fuel temperature $T(t)$ evolve according to the following ordinary differential equations derived from point kinetics and an energy balance:\n$$\n\\frac{dn}{dt} \\;=\\; \\frac{\\rho(T)}{\\Lambda}\\,n, \n\\qquad \n\\frac{dT}{dt} \\;=\\; \\alpha\\,n \\;-\\; \\beta\\,(T - T_{\\mathrm{s}}).\n$$\nHere, $\\rho(T)$ is the temperature-dependent reactivity, $\\Lambda$ is the prompt neutron generation time, $\\alpha$ is a lumped heating coefficient, $\\beta$ is the effective heat removal coefficient, and $T_{\\mathrm{s}}$ is the coolant sink temperature. Assume strong nonlinear temperature dependence representative of Doppler feedback by prescribing\n$$\n\\rho(T) \\;=\\; \\rho_{0} \\;-\\; a\\,\\sqrt{T},\n$$\nwith constants $\\rho_{0}  0$ and $a  0$. For the purposes of this problem, take the parameters\n$$\n\\Lambda = 1.0 \\times 10^{-4}\\ \\mathrm{s}, \\quad \\alpha = 2.0\\ \\mathrm{K}\\,\\mathrm{s}^{-1}, \\quad \\beta = 5.0 \\times 10^{-1}\\ \\mathrm{s}^{-1}, \\quad T_{\\mathrm{s}} = 6.00 \\times 10^{2}\\ \\mathrm{K}, \\quad \\rho_{0} = 5.00 \\times 10^{-3}, \\quad a = 2.00 \\times 10^{-4}\\ \\mathrm{K}^{-1/2}.\n$$\nA first-order Lieâ€“Trotter operator splitting (OS) scheme updates the coupled system over a single time step $\\Delta t$ by first advancing the neutron population with the temperature frozen, then advancing the temperature with the newly updated neutron population frozen:\n$$\n\\text{Step A:}\\quad n^{m+\\frac{1}{2}} \\;=\\; n^{m} \\;+\\; \\Delta t\\;\\frac{\\rho(T^{m})}{\\Lambda}\\,n^{m}, \n$$\n$$\n\\text{Step B:}\\quad T^{m+1} \\;=\\; T^{m} \\;+\\; \\Delta t\\;\\big(\\alpha\\,n^{m+\\frac{1}{2}} \\;-\\; \\beta\\,(T^{m} - T_{\\mathrm{s}})\\big), \n\\qquad \nn^{m+1} \\;=\\; n^{m+\\frac{1}{2}}.\n$$\nStarting from the fundamental laws and definitions given above, and without invoking any pre-derived discrete stability criteria, do the following:\n- Determine the nontrivial steady state $(n^{\\ast}, T^{\\ast})$ for the continuous system and linearize the OS map around $(n^{\\ast}, T^{\\ast})$ to obtain the $2 \\times 2$ amplification matrix $M(\\Delta t)$ governing the evolution of small perturbations $(\\delta n^{m}, \\delta T^{m}) \\mapsto (\\delta n^{m+1}, \\delta T^{m+1})$.\n- Using this linearized OS map, analytically characterize the onset of spurious discrete-time oscillations introduced by operator splitting, and compute the largest time step $\\Delta t_{\\max}$ for which the spectral radius of $M(\\Delta t)$ is less than or equal to $1$. Express $\\Delta t_{\\max}$ in milliseconds and round your answer to three significant figures.\n\nAs part of your derivation, explain why the chosen nonlinear dependence $\\rho(T) = \\rho_{0} - a \\sqrt{T}$ can induce splitting-driven oscillations in the discrete-time scheme even when the continuous-time linearized dynamics are asymptotically stable, and briefly discuss principled remedies grounded in multiscale thermal feedback methods (for example, higher-order splitting, implicit coupling, or stabilized coarse-to-fine coupling) without changing the required final numeric answer format.",
            "solution": "The problem statement has been validated and is deemed to be scientifically grounded, well-posed, internally consistent, and free of defects. It presents a standard problem in the numerical analysis of reactor physics models. We may therefore proceed with the solution.\n\nThe evolution of the system is governed by the coupled ordinary differential equations (ODEs):\n$$\n\\frac{dn}{dt} = \\frac{\\rho(T)}{\\Lambda} n\n$$\n$$\n\\frac{dT}{dt} = \\alpha n - \\beta(T - T_s)\n$$\nwith the reactivity given by $\\rho(T) = \\rho_0 - a\\sqrt{T}$.\n\nFirst, we determine the nontrivial steady state $(n^*, T^*)$ of the continuous system by setting the time derivatives to zero.\n$$\n\\frac{dn}{dt} = 0 \\implies \\frac{\\rho(T^*)}{\\Lambda} n^* = 0\n$$\nSince we seek a nontrivial solution with $n^* \\neq 0$, this requires the reactivity to be zero at equilibrium:\n$$\n\\rho(T^*) = \\rho_0 - a\\sqrt{T^*} = 0\n$$\nSolving for the steady-state temperature $T^*$ yields:\n$$\n\\sqrt{T^*} = \\frac{\\rho_0}{a} \\implies T^* = \\left(\\frac{\\rho_0}{a}\\right)^2\n$$\nNext, we set the time derivative of the temperature to zero:\n$$\n\\frac{dT}{dt} = 0 \\implies \\alpha n^* - \\beta(T^* - T_s) = 0\n$$\nSolving for the steady-state neutron population $n^*$ gives:\n$$\nn^* = \\frac{\\beta}{\\alpha}(T^* - T_s)\n$$\nSubstituting the given parameter values:\n$\\Lambda = 1.0 \\times 10^{-4}\\ \\mathrm{s}$, $\\alpha = 2.0\\ \\mathrm{K}\\,\\mathrm{s}^{-1}$, $\\beta = 0.5\\ \\mathrm{s}^{-1}$, $T_s = 600\\ \\mathrm{K}$, $\\rho_0 = 5.00 \\times 10^{-3}$, $a = 2.00 \\times 10^{-4}\\ \\mathrm{K}^{-1/2}$.\n$$\nT^* = \\left(\\frac{5.00 \\times 10^{-3}}{2.00 \\times 10^{-4}}\\right)^2 = (25.0)^2 = 625\\ \\mathrm{K}\n$$\n$$\nn^* = \\frac{0.5}{2.0}(625 - 600) = 0.25 \\times 25 = 6.25\n$$\nThe units of $n$ are consistent with the equation for $dT/dt$, implying a scaling factor absorbed into $\\alpha$.\n\nNext, we linearize the discrete Lie-Trotter operator splitting (OS) map. The map advances the state from $(n^m, T^m)$ to $(n^{m+1}, T^{m+1})$ over a time step $\\Delta t$:\n$$\nn^{m+1} = F_n(n^m, T^m) = n^m \\left( 1 + \\frac{\\Delta t}{\\Lambda} \\rho(T^m) \\right)\n$$\n$$\nT^{m+1} = F_T(n^m, T^m) = T^m + \\Delta t \\left[ \\alpha \\left( n^m \\left( 1 + \\frac{\\Delta t}{\\Lambda} \\rho(T^m) \\right) \\right) - \\beta (T^m - T_s) \\right]\n$$\nThe amplification matrix $M(\\Delta t)$ is the Jacobian of the map $(n^{m+1}, T^{m+1}) = \\mathbf{F}(n^m, T^m)$ evaluated at the steady state $(n^*, T^*)$:\n$$\nM(\\Delta t) = \\begin{pmatrix} \\frac{\\partial F_n}{\\partial n}  \\frac{\\partial F_n}{\\partial T} \\\\ \\frac{\\partial F_T}{\\partial n}  \\frac{\\partial F_T}{\\partial T} \\end{pmatrix} \\Bigg|_{(n^*, T^*)}\n$$\nWe compute the partial derivatives:\n$$\n\\frac{\\partial F_n}{\\partial n} = 1 + \\frac{\\Delta t}{\\Lambda} \\rho(T^m)\n$$\n$$\n\\frac{\\partial F_n}{\\partial T} = n^m \\frac{\\Delta t}{\\Lambda} \\rho'(T^m), \\quad \\text{where } \\rho'(T) = -\\frac{a}{2\\sqrt{T}}\n$$\n$$\n\\frac{\\partial F_T}{\\partial n} = \\Delta t \\left[ \\alpha \\left( 1 + \\frac{\\Delta t}{\\Lambda} \\rho(T^m) \\right) \\right]\n$$\n$$\n\\frac{\\partial F_T}{\\partial T} = 1 + \\Delta t \\left[ \\alpha n^m \\frac{\\Delta t}{\\Lambda} \\rho'(T^m) - \\beta \\right]\n$$\nEvaluating these at the steady state $(n^*, T^*)$, where $\\rho(T^*) = 0$ and $\\rho'(T^*) = -a / (2\\sqrt{T^*}) = -a^2 / (2\\rho_0)$:\n$$\n\\frac{\\partial F_n}{\\partial n}\\bigg|_{*} = 1\n$$\n$$\n\\frac{\\partial F_n}{\\partial T}\\bigg|_{*} = n^* \\frac{\\Delta t}{\\Lambda} \\rho'(T^*) = -\\frac{n^* a \\Delta t}{2\\Lambda\\sqrt{T^*}} = -\\frac{n^* a^2 \\Delta t}{2\\Lambda\\rho_0}\n$$\n$$\n\\frac{\\partial F_T}{\\partial n}\\bigg|_{*} = \\alpha \\Delta t\n$$\n$$\n\\frac{\\partial F_T}{\\partial T}\\bigg|_{*} = 1 - \\beta \\Delta t + \\alpha n^* \\frac{(\\Delta t)^2}{\\Lambda} \\rho'(T^*) = 1 - \\beta \\Delta t - \\frac{\\alpha n^* a^2 (\\Delta t)^2}{2\\Lambda\\rho_0}\n$$\nLet's define the constant $C_1 = \\frac{\\alpha n^* a^2}{2\\Lambda\\rho_0}$. The amplification matrix is:\n$$\nM(\\Delta t) = \\begin{pmatrix} 1  -C_1 \\frac{\\Delta t}{\\alpha} \\\\ \\alpha \\Delta t  1 - \\beta \\Delta t - C_1 (\\Delta t)^2 \\end{pmatrix}\n$$\nThe stability of the scheme is governed by the eigenvalues $\\lambda$ of $M$, which are the roots of the characteristic equation $\\det(M - \\lambda I) = 0$, or $\\lambda^2 - \\mathrm{Tr}(M)\\lambda + \\det(M) = 0$.\nThe trace and determinant of $M$ are:\n$$\n\\mathrm{Tr}(M) = 1 + (1 - \\beta \\Delta t - C_1 (\\Delta t)^2) = 2 - \\beta \\Delta t - C_1 (\\Delta t)^2\n$$\n$$\n\\det(M) = 1 \\cdot (1 - \\beta \\Delta t - C_1 (\\Delta t)^2) - (-C_1 \\frac{\\Delta t}{\\alpha})(\\alpha \\Delta t) = 1 - \\beta \\Delta t - C_1 (\\Delta t)^2 + C_1 (\\Delta t)^2 = 1 - \\beta \\Delta t\n$$\nFor the spectral radius $\\rho(M) \\le 1$, the eigenvalues must lie within or on the unit circle in the complex plane. For a $2 \\times 2$ real matrix, this is guaranteed if the Jury stability criteria are met:\n1. $1 - \\mathrm{Tr}(M) + \\det(M) \\ge 0$\n2. $1 + \\mathrm{Tr}(M) + \\det(M) \\ge 0$\n3. $|\\det(M)| \\le 1$\n\nLet's check these conditions:\n1. $1 - (2 - \\beta \\Delta t - C_1 (\\Delta t)^2) + (1 - \\beta \\Delta t) = C_1 (\\Delta t)^2 \\ge 0$. Since $C_1  0$, this is always satisfied for $\\Delta t  0$.\n2. $1 + (2 - \\beta \\Delta t - C_1 (\\Delta t)^2) + (1 - \\beta \\Delta t) = 4 - 2\\beta \\Delta t - C_1 (\\Delta t)^2 \\ge 0$.\n3. $|1 - \\beta \\Delta t| \\le 1$. Since $\\beta  0$ and $\\Delta t \\ge 0$, this simplifies to $1 - \\beta \\Delta t \\ge -1$, which gives $\\beta \\Delta t \\le 2$, or $\\Delta t \\le \\frac{2}{\\beta}$.\n\nThe onset of spurious oscillations occurs when a pair of complex conjugate eigenvalues reaches the unit circle, which corresponds to the second Jury criterion becoming an equality at the stability boundary: $4 - 2\\beta \\Delta t - C_1 (\\Delta t)^2 = 0$, or $C_1 (\\Delta t)^2 + 2\\beta \\Delta t - 4 = 0$. This is a quadratic equation for $\\Delta t$. Solving for $\\Delta t  0$:\n$$\n\\Delta t = \\frac{-2\\beta + \\sqrt{(2\\beta)^2 - 4(C_1)(-4)}}{2C_1} = \\frac{-\\beta + \\sqrt{\\beta^2 + 4C_1}}{C_1}\n$$\nThe maximum stable time step, $\\Delta t_{\\max}$, is the smaller of the two limits derived from conditions 2 and 3:\n$$\n\\Delta t_{\\max} = \\min \\left( \\frac{-\\beta + \\sqrt{\\beta^2 + 4C_1}}{C_1}, \\frac{2}{\\beta} \\right)\n$$\nNow, we compute the numerical value of $C_1$:\n$$\nC_1 = \\frac{\\alpha n^* a^2}{2\\Lambda\\rho_0} = \\frac{(2.0)(6.25)(2.00 \\times 10^{-4})^2}{2(1.0 \\times 10^{-4})(5.00 \\times 10^{-3})} = \\frac{(12.5)(4.00 \\times 10^{-8})}{1.0 \\times 10^{-6}} = \\frac{50.0 \\times 10^{-8}}{1.0 \\times 10^{-6}} = 0.5\\ \\mathrm{s}^{-2}\n$$\nThe limit from the oscillation condition is:\n$$\n\\Delta t_{\\text{osc}} = \\frac{-0.5 + \\sqrt{(0.5)^2 + 4(0.5)}}{0.5} = \\frac{-0.5 + \\sqrt{0.25 + 2.0}}{0.5} = \\frac{-0.5 + \\sqrt{2.25}}{0.5} = \\frac{-0.5 + 1.5}{0.5} = 2.0\\ \\mathrm{s}\n$$\nThe limit from the determinant condition is:\n$$\n\\Delta t_{\\text{det}} = \\frac{2}{\\beta} = \\frac{2}{0.5} = 4.0\\ \\mathrm{s}\n$$\nThe overall stability limit is the minimum of these two values:\n$$\n\\Delta t_{\\max} = \\min(2.0, 4.0) = 2.0\\ \\mathrm{s}\n$$\nExpressed in milliseconds, this is $2000\\ \\mathrm{ms}$. Rounding to three significant figures gives $2.00 \\times 10^3\\ \\mathrm{ms}$.\n\nThe existence of these spurious oscillations is an artifact of the operator splitting scheme. The continuous system, when linearized around $(n^*, T^*)$, has a Jacobian matrix $J$ with eigenvalues that have strictly negative real parts, indicating that the steady state is asymptotically stable. The splitting scheme, however, introduces a numerical error, which is formally of order $\\mathcal{O}(\\Delta t)$. This error arises because the neutronics and thermal hydraulics are advanced sequentially rather than simultaneously. In the A-B splitting used here (neutronics first), the temperature feedback on the neutron population is delayed by one full time step: $n^{m+1}$ is computed using $\\rho(T^m)$. This artificial delay can cause the numerical solution to \"overshoot\" the true solution, leading to oscillations that grow in amplitude if $\\Delta t$ is too large. The nonlinear dependence $\\rho(T) = \\rho_0 - a\\sqrt{T}$ is crucial because it creates the coupling term $\\frac{\\partial F_n}{\\partial T}$ and the destabilizing $(\\Delta t)^2$ term in $\\frac{\\partial F_T}{\\partial T}$ via the chain rule during linearization. These terms, which depend on $\\rho'(T^*) \\neq 0$, are responsible for the complex interaction that leads to the numerical instability.\n\nPrincipled remedies to mitigate such splitting errors, common in multiscale thermal feedback methods, include:\n1.  **Higher-Order Splitting:** Schemes like Strang splitting ($B_{err}/2 \\to A_{err} \\to B_{err}/2$) reduce the splitting error to $\\mathcal{O}((\\Delta t)^2)$, often significantly increasing the stable time step limit.\n2.  **Implicit Coupling:** Treating the entire system implicitly (e.g., with Backward Euler or Crank-Nicolson) solves for $(n^{m+1}, T^{m+1})$ simultaneously. This eliminates the artificial delay and typically results in an unconditionally stable method, though it requires solving a nonlinear system of algebraic equations at each time step.\n3.  **Stabilized or Iterative Coupling:** Instead of full implicit coupling, one can use a few iterations (e.g., Picard or Jacobi) between the neutronics and thermal-hydraulics solves within a single time step to better converge the coupling terms. This offers a compromise between the stability of implicit methods and the simplicity of explicit splitting.",
            "answer": "$$ \\boxed{2.00 \\times 10^3} $$"
        },
        {
            "introduction": "Building on the principles of feedback quantification and numerical stability, this final practice is a comprehensive implementation exercise. You will code a point-kinetics model coupled with a thermal energy balance to simulate a reactor's response to a reactivity insertion . The core task is to implement and directly compare two different coupling strategies: a simple explicit scheme and a more robust, fully implicit scheme. By running simulations for various transient scenarios, you will gain tangible, hands-on experience with how different numerical coupling methods impact the accuracy and stability of a multiscale thermal feedback simulation.",
            "id": "4237386",
            "problem": "You are asked to model the transient response of a homogeneous thermal nuclear reactor to a step reactivity insertion with negative Doppler feedback, and to compare the results under explicit and implicit coupling between neutron kinetics and thermal feedback. The reactor is modeled using point kinetics with one delayed neutron group and a lumped-parameter fuel thermal energy balance. You must derive the discrete-time update laws from fundamental balances, implement both coupling schemes, and compute specified metrics over a set of test scenarios. All calculations and outputs must strictly conform to the physical units and numerical specifications provided.\n\nStart from the following fundamental bases:\n\n- Neutron population and delayed neutron precursor balance (one group), where $P(t)$ is reactor power in watts and $C(t)$ is the delayed neutron precursor concentration in an equivalent power-normalized unit:\n  - $$\\frac{dP}{dt} = \\frac{\\rho(t) - \\beta}{\\Lambda} P(t) + \\lambda C(t)$$\n  - $$\\frac{dC}{dt} = \\frac{\\beta}{\\Lambda} P(t) - \\lambda C(t)$$\n  Here, $\\rho(t)$ is the reactivity (dimensionless), $\\beta$ is the total delayed neutron fraction (dimensionless), $\\Lambda$ is the neutron generation time in seconds, and $\\lambda$ is the delayed neutron decay constant in inverse seconds.\n\n- Lumped-parameter fuel thermal energy balance:\n  - $$H_f \\frac{dT_f}{dt} = \\eta P(t) - K_f\\left(T_f(t) - T_c\\right)$$\n  Here, $T_f(t)$ is the average fuel temperature in kelvin, $T_c$ is the coolant temperature in kelvin (assumed constant), $H_f$ is the effective fuel thermal capacitance in joules per kelvin, $K_f$ is the effective fuel-to-coolant heat transfer coefficient in watts per kelvin, and $\\eta$ is the fraction of reactor power deposited in the fuel (dimensionless).\n\n- Reactivity feedback through the Doppler effect (negative Doppler coefficient):\n  - $$\\rho(t) = \\rho_{\\text{ext}} + \\alpha_D \\left(T_f(t) - T_{f,0}\\right)$$\n  where $\\rho_{\\text{ext}}$ is the externally imposed step reactivity at $t \\ge 0$, $\\alpha_D$ is the Doppler coefficient in inverse kelvin (negative), and $T_{f,0}$ is the initial fuel temperature in kelvin.\n\nAssume the reactor is at steady state for $t  0$ with $\\rho_{\\text{ext}} = 0$, and at $t = 0$ a step reactivity $\\rho_{\\text{ext}}$ is applied and held constant thereafter. For the steady state, use the physically consistent initial conditions obtained by enforcing time derivatives equal to zero at $t = 0^{-}$:\n- $$C(0) = \\frac{\\beta}{\\lambda \\Lambda} P(0)$$\n- $$T_f(0) = T_c + \\frac{\\eta}{K_f} P(0)$$\n\nYour task:\n\n- Discretize time with a uniform time step $\\Delta t$ and implement two coupling schemes between neutron kinetics and thermal feedback:\n  1. Explicit coupling: within each time step, evaluate $\\rho$ using $T_f$ from the previous time level, and advance neutron kinetics and precursors using a numerically stable method, then update $T_f$ using the newly computed power.\n  2. Implicit coupling: within each time step, evaluate $\\rho$ using $T_f$ at the new time level, and simultaneously advance neutron kinetics, precursors, and fuel temperature using a numerically stable method that ensures the negative Doppler feedback acts within the same time level.\n\n- In both schemes, use backward Euler (fully implicit) time discretization for the differential equations, while adhering to the explicit or implicit choice only in how $\\rho$ is evaluated with respect to $T_f$.\n\n- Compute, for each test scenario and coupling scheme:\n  - The reactor power at the final time $t_{\\text{end}}$, expressed in megawatts.\n  - The maximum reactor power observed over the entire transient interval $[0, t_{\\text{end}}]$, expressed in megawatts.\n\n- Express every power value in megawatts (MW) as a floating-point number rounded to six decimal places.\n\nTest suite:\n\nUse the following parameter sets to define four scenarios. For each scenario, the values of $\\beta$, $\\Lambda$, $\\lambda$, $\\eta$, $H_f$, $K_f$, $T_c$, $P(0)$, $\\rho_{\\text{ext}}$, $\\Delta t$, and $t_{\\text{end}}$ are given. Units are as specified next to each symbol.\n\n- Scenario A (general case, subprompt insertion):\n  - $\\beta = 0.0065$ (dimensionless)\n  - $\\Lambda = 1 \\times 10^{-4}$ (seconds)\n  - $\\lambda = 0.08$ (inverse seconds)\n  - $\\eta = 0.95$ (dimensionless)\n  - $H_f = 5 \\times 10^{7}$ (joules per kelvin)\n  - $K_f = 3.1666667 \\times 10^{5}$ (watts per kelvin)\n  - $T_c = 600$ (kelvin)\n  - $P(0) = 1.0 \\times 10^{8}$ (watts)\n  - $\\alpha_D = -3.0 \\times 10^{-5}$ (inverse kelvin)\n  - $\\rho_{\\text{ext}} = 0.002$ (dimensionless)\n  - $\\Delta t = 1.0 \\times 10^{-3}$ (seconds)\n  - $t_{\\text{end}} = 3.0$ (seconds)\n\n- Scenario B (near prompt-critical insertion):\n  - Same as Scenario A, except $\\rho_{\\text{ext}} = 0.006$ (dimensionless)\n\n- Scenario C (edge case, zero insertion):\n  - Same as Scenario A, except $\\rho_{\\text{ext}} = 0.0$ (dimensionless)\n\n- Scenario D (superprompt insertion moderated by feedback):\n  - Same as Scenario A, except $\\rho_{\\text{ext}} = 0.010$ (dimensionless)\n\nFinal output specification:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each scenario, output four values in order: final power under explicit coupling (MW), final power under implicit coupling (MW), maximum power under explicit coupling (MW), maximum power under implicit coupling (MW). Concatenate the results of the four scenarios in the order A, B, C, D, yielding a list of $16$ floating-point numbers. For example, the output format must be exactly like:\n  - $$\\left[\\text{A\\_final\\_explicit}, \\text{A\\_final\\_implicit}, \\text{A\\_max\\_explicit}, \\text{A\\_max\\_implicit}, \\text{B\\_final\\_explicit}, \\ldots, \\text{D\\_max\\_implicit}\\right]$$\nAll outputs must be in megawatts (MW), rounded to six decimal places, and expressed as decimal numbers without any percentage sign.",
            "solution": "The user has provided a well-posed problem in nuclear reactor physics, asking for the implementation and comparison of two numerical coupling schemes for a point kinetics model with thermal feedback. The problem is scientifically grounded, self-contained, and algorithmically specific. Therefore, a full solution is warranted.\n\nThe reactor dynamics are described by a system of three coupled ordinary differential equations (ODEs). Let $P(t)$, $C(t)$, and $T_f(t)$ denote the reactor power, precursor concentration, and fuel temperature, respectively. The time index for the discrete solution will be denoted by a subscript $n$, where $t_n = n \\Delta t$. The state variables at time $t_n$ are $P_n$, $C_n$, and $T_{f,n}$. We aim to find the state at $t_{n+1}$.\n\nThe fundamental equations provided are:\n1.  Neutron population balance:\n    $$\\frac{dP}{dt} = \\frac{\\rho(t) - \\beta}{\\Lambda} P(t) + \\lambda C(t)$$\n2.  Precursor concentration balance:\n    $$\\frac{dC}{dt} = \\frac{\\beta}{\\Lambda} P(t) - \\lambda C(t)$$\n3.  Fuel thermal energy balance:\n    $$H_f \\frac{dT_f}{dt} = \\eta P(t) - K_f\\left(T_f(t) - T_c\\right)$$\n4.  Reactivity feedback:\n    $$\\rho(t) = \\rho_{\\text{ext}} + \\alpha_D \\left(T_f(t) - T_{f,0}\\right)$$\n\nThe problem specifies the use of the backward Euler method for time discretization. Applying this method to the system of ODEs, we replace $\\frac{dy}{dt}$ with $\\frac{y_{n+1} - y_n}{\\Delta t}$ and evaluate all terms on the right-hand side at time step $n+1$.\n\nFrom the precursor balance (2):\n$\\frac{C_{n+1} - C_n}{\\Delta t} = \\frac{\\beta}{\\Lambda} P_{n+1} - \\lambda C_{n+1}$\nSolving for $C_{n+1}$ yields:\n$$C_{n+1} = \\frac{C_n + \\frac{\\beta \\Delta t}{\\Lambda} P_{n+1}}{1 + \\lambda \\Delta t}$$\n\nFrom the thermal energy balance (3):\n$\\frac{T_{f,n+1} - T_{f,n}}{\\Delta t} = \\frac{1}{H_f} \\left[ \\eta P_{n+1} - K_f(T_{f,n+1} - T_c) \\right]$\nSolving for $T_{f,n+1}$ yields:\n$$T_{f,n+1} = \\frac{T_{f,n} + \\frac{K_f \\Delta t}{H_f} T_c + \\frac{\\eta \\Delta t}{H_f} P_{n+1}}{1 + \\frac{K_f \\Delta t}{H_f}}$$\n\nFrom the neutron population balance (1):\n$\\frac{P_{n+1} - P_n}{\\Delta t} = \\frac{\\rho_{n+1} - \\beta}{\\Lambda} P_{n+1} + \\lambda C_{n+1}$\nSubstituting the expression for $C_{n+1}$ and rearranging to solve for $P_{n+1}$ leads to a general expression for the new power level. After algebraic manipulation, we arrive at:\n$$P_{n+1} = \\frac{\\Lambda \\left[ P_n(1 + \\lambda \\Delta t) + \\lambda \\Delta t C_n \\right]}{\\Lambda(1 + \\lambda \\Delta t) + \\beta \\Delta t - \\rho_{n+1} \\Delta t(1 + \\lambda \\Delta t)}$$\nThe term $\\rho_{n+1}$ is where the explicit and implicit coupling schemes differ.\n\nThe initial conditions at $t=0$ are derived from the steady-state assumption ($\\frac{d}{dt} = 0$) with $\\rho_{\\text{ext}}=0$. This yields:\n-   Initial fuel temperature: $T_{f,0} = T_c + \\frac{\\eta P(0)}{K_f}$\n-   Initial precursor concentration: $C(0) = \\frac{\\beta P(0)}{\\lambda \\Lambda}$\n\nWe will now detail the implementation of both coupling schemes.\n\n**1. Explicit Coupling Scheme**\n\nIn the explicit coupling scheme, the reactivity at the new time step, $\\rho_{n+1}$, is calculated using the fuel temperature from the previous time step, $T_{f,n}$.\n$$\\rho_{n+1} = \\rho_{\\text{ext}} + \\alpha_D \\left(T_{f,n} - T_{f,0}\\right)$$\nSince $T_{f,n}$ is known, $\\rho_{n+1}$ is determined before solving for the new state vector $[P_{n+1}, C_{n+1}, T_{f,n+1}]^T$. The update procedure is sequential:\n1.  Compute reactivity: $\\rho_{n+1, \\text{exp}} = \\rho_{\\text{ext}} + \\alpha_D (T_{f,n} - T_{f,0})$.\n2.  Compute power: Substitute $\\rho_{n+1, \\text{exp}}$ into the equation for $P_{n+1}$ and solve. Since all terms in the denominator are known, this is a direct calculation.\n3.  Compute precursors and temperature: Use the newly computed $P_{n+1}$ to find $C_{n+1}$ and $T_{f,n+1}$ using their respective update equations.\n\nThis scheme is computationally simple but introduces a time lag in the thermal feedback, which can lead to inaccuracies or numerical instability, especially for large time steps or rapid transients.\n\n**2. Implicit Coupling Scheme**\n\nIn the implicit coupling scheme, the reactivity $\\rho_{n+1}$ is evaluated using the fuel temperature at the new time step, $T_{f,n+1}$.\n$$\\rho_{n+1} = \\rho_{\\text{ext}} + \\alpha_D \\left(T_{f,n+1} - T_{f,0}\\right)$$\nThis creates a fully coupled non-linear system, as $P_{n+1}$ depends on $\\rho_{n+1}$, which depends on $T_{f,n+1}$, which in turn depends on $P_{n+1}$. We can solve this system by substituting the expressions for $T_{f,n+1}$ and $\\rho_{n+1}$ into the equation for $P_{n+1}$.\n\nLet's combine the expressions:\n-   $P_{n+1} = f(\\rho_{n+1})$\n-   $\\rho_{n+1} = g(T_{f,n+1})$\n-   $T_{f,n+1} = h(P_{n+1})$\n\nSubstituting $T_{f,n+1}$ into the expression for $\\rho_{n+1}$ gives a linear relationship between $\\rho_{n+1}$ and $P_{n+1}$. Substituting this into the equation for $P_{n+1}$ results in a quadratic equation for $P_{n+1}$ of the form $a P_{n+1}^2 + b P_{n+1} + c = 0$.\n\nThe coefficients of this quadratic equation are derived as follows. Let:\n-   $A_n = \\Lambda(P_n(1+\\lambda\\Delta t) + \\lambda\\Delta t C_n)$\n-   $B = \\Lambda(1+\\lambda\\Delta t) + \\beta\\Delta t$\n-   $D = \\Delta t(1+\\lambda\\Delta t)$\n-   $E_n = \\frac{H_f T_{f,n} + K_f\\Delta t T_c}{H_f + K_f\\Delta t}$\n-   $F = \\frac{\\eta\\Delta t}{H_f + K_f\\Delta t}$\n-   $G_n = \\rho_{\\text{ext}} + \\alpha_D(E_n - T_{f,0})$\n-   $H = \\alpha_D F$\n\nThe system of equations for the unknowns $P_{n+1}$ and $\\rho_{n+1}$ is:\n$$P_{n+1} (B - D \\rho_{n+1}) = A_n$$\n$$\\rho_{n+1} = G_n + H P_{n+1}$$\nSubstituting the second equation into the first gives:\n$$P_{n+1} (B - D(G_n + H P_{n+1})) = A_n$$\n$$P_{n+1} (B - D G_n) - D H P_{n+1}^2 = A_n$$\nRearranging into standard quadratic form $a x^2 + b x + c = 0$ with $x=P_{n+1}$:\n$$(DH)P_{n+1}^2 + (DG_n - B)P_{n+1} + A_n = 0$$\nThe coefficients are:\n-   $a = DH$\n-   $b = DG_n - B$\n-   $c = A_n$\n\nSince $\\alpha_D  0$, we have $H  0$ and consequently $a  0$. $A_n$ is always positive for a positive power reactor state, so $c0$. The discriminant $b^2-4ac$ is always positive, guaranteeing two real roots. The product of the roots, $c/a$, is negative, meaning one root is positive (physical) and one is negative (non-physical). The physical power $P_{n+1}$ must be positive. The standard quadratic formula is $P_{n+1} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$. Since the denominator $2a$ is negative, to get a positive result for $P_{n+1}$, the numerator must also be negative. The term $-b - \\sqrt{b^2 - 4ac}$ is always negative, whereas $-b + \\sqrt{b^2 - 4ac}$ is always positive. Thus, we must choose the minus sign in the numerator to obtain the physical root:\n$$P_{n+1} = \\frac{-b - \\sqrt{b^2 - 4ac}}{2a} = \\frac{-(DG_n - B) - \\sqrt{(DG_n - B)^2 - 4(DH)A_n}}{2DH}$$\n\nThe implicit update procedure is:\n1.  Calculate the coefficients $a, b, c$ for the quadratic equation based on the state at time $t_n$.\n2.  Solve the quadratic equation for $P_{n+1}$ using the physical root.\n3.  Compute $C_{n+1}$ and $T_{f,n+1}$ using the new $P_{n+1}$.\n\nThis scheme correctly models the instantaneous nature of Doppler feedback and is generally more accurate and stable than the explicit scheme, especially for super-prompt critical transients.\n\nThe solution will be implemented by creating a function that executes the time-stepping loop for a given set of parameters and coupling choice, calculating the final power and tracking the maximum power throughout the transient.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the reactor transient simulations for all scenarios\n    and print the results in the specified format.\n    \"\"\"\n\n    scenarios = {\n        'A': {'rho_ext': 0.002},\n        'B': {'rho_ext': 0.006},\n        'C': {'rho_ext': 0.0},\n        'D': {'rho_ext': 0.010},\n    }\n\n    base_params = {\n        'BETA': 0.0065,        # dimensionless\n        'LAMBDA_N': 1.0e-4,    # seconds\n        'LAMBDA_C': 0.08,      # inverse seconds\n        'ETA': 0.95,           # dimensionless\n        'H_F': 5.0e7,          # joules per kelvin\n        'K_F': 3.1666667e5,    # watts per kelvin\n        'T_C': 600.0,          # kelvin\n        'P0_W': 1.0e8,         # watts\n        'ALPHA_D': -3.0e-5,    # inverse kelvin\n        'DT': 1.0e-3,          # seconds\n        'T_END': 3.0,          # seconds\n    }\n\n    results = []\n\n    for key in sorted(scenarios.keys()):\n        params = base_params.copy()\n        params.update(scenarios[key])\n\n        # Run explicit coupling simulation\n        p_final_exp, p_max_exp = run_simulation(params, 'explicit')\n        results.extend([p_final_exp, 0.0, p_max_exp, 0.0])\n\n        # Run implicit coupling simulation\n        p_final_imp, p_max_imp = run_simulation(params, 'implicit')\n        results[-3] = p_final_imp\n        results[-1] = p_max_imp\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\ndef run_simulation(params, coupling_type):\n    \"\"\"\n    Runs a single reactor transient simulation.\n    \n    Args:\n        params (dict): A dictionary of physical and numerical parameters.\n        coupling_type (str): 'explicit' or 'implicit'.\n\n    Returns:\n        tuple: A tuple containing (final_power_MW, max_power_MW).\n    \"\"\"\n    # Unpack parameters\n    BETA = params['BETA']\n    LAMBDA_N = params['LAMBDA_N']\n    LAMBDA_C = params['LAMBDA_C']\n    ETA = params['ETA']\n    H_F = params['H_F']\n    K_F = params['K_F']\n    T_C = params['T_C']\n    P0_W = params['P0_W']\n    ALPHA_D = params['ALPHA_D']\n    DT = params['DT']\n    T_END = params['T_END']\n    RHO_EXT = params['rho_ext']\n\n    # Initial conditions\n    T_F0 = T_C + ETA * P0_W / K_F\n    C0 = BETA * P0_W / (LAMBDA_C * LAMBDA_N)\n\n    # State variables\n    p_n = P0_W\n    c_n = C0\n    t_f_n = T_F0\n\n    # Simulation setup\n    n_steps = int(T_END / DT)\n    max_power = P0_W\n\n    # Time-stepping loop\n    for _ in range(n_steps):\n        if coupling_type == 'explicit':\n            # 1. Calculate reactivity using previous temperature\n            rho_n1 = RHO_EXT + ALPHA_D * (t_f_n - T_F0)\n\n            # 2. Calculate power P_{n+1}\n            numerator_p = LAMBDA_N * (p_n * (1 + LAMBDA_C * DT) + LAMBDA_C * DT * c_n)\n            denominator_p = LAMBDA_N * (1 + LAMBDA_C * DT) + BETA * DT - rho_n1 * DT * (1 + LAMBDA_C * DT)\n            p_n1 = numerator_p / denominator_p\n            \n        elif coupling_type == 'implicit':\n            # 1. Calculate coefficients for the quadratic equation a*x^2 + b*x + c = 0\n            # where x = P_{n+1}\n            An = LAMBDA_N * (p_n * (1 + LAMBDA_C * DT) + LAMBDA_C * DT * c_n)\n            B_const = LAMBDA_N * (1 + LAMBDA_C * DT) + BETA * DT\n            D_const = DT * (1 + LAMBDA_C * DT)\n            \n            En = (H_F * t_f_n + K_F * DT * T_C) / (H_F + K_F * DT)\n            F_const = (ETA * DT) / (H_F + K_F * DT)\n            \n            Gn = RHO_EXT + ALPHA_D * (En - T_F0)\n            H_const = ALPHA_D * F_const\n\n            a_quad = D_const * H_const\n            b_quad = D_const * Gn - B_const\n            c_quad = An\n            \n            # 2. Solve the quadratic equation for the physical (positive) root\n            discriminant = np.sqrt(b_quad**2 - 4 * a_quad * c_quad)\n            p_n1 = (-b_quad - discriminant) / (2 * a_quad)\n\n        else:\n            raise ValueError(\"Invalid coupling type specified.\")\n\n        # 3. Update precursor concentration C_{n+1}\n        c_n1 = (c_n + (BETA * DT / LAMBDA_N) * p_n1) / (1 + LAMBDA_C * DT)\n\n        # 4. Update fuel temperature T_{f,n+1}\n        t_f_n1 = (t_f_n + (K_F * DT / H_F) * T_C + (ETA * DT / H_F) * p_n1) / (1 + K_F * DT / H_F)\n\n        # Update state for next step\n        p_n, c_n, t_f_n = p_n1, c_n1, t_f_n1\n\n        # Track maximum power\n        if p_n  max_power:\n            max_power = p_n\n\n    # Convert final and max power from Watts to Megawatts\n    final_power_mw = p_n / 1e6\n    max_power_mw = max_power / 1e6\n\n    return final_power_mw, max_power_mw\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}