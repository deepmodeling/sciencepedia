{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any Newton-based solver is the formulation of the nonlinear system of equations to be solved, expressed as a residual vector $R(u) = 0$. This first practice guides you through this fundamental step by discretizing the multigroup neutron diffusion equations, which form the core of reactor physics analysis. By deriving the residual for a control volume on an unstructured mesh , you will gain hands-on experience in translating continuous physical laws into a discrete algebraic system suitable for a numerical solver, paying special attention to handling material discontinuities that are characteristic of multiphysics problems.",
            "id": "4232179",
            "problem": "Consider the steady-state multigroup neutron diffusion model for a nuclear reactor core, posed on a general unstructured polyhedral mesh. Let $G$ denote the number of energy groups, and for each group $g \\in \\{1,\\dots,G\\}$, the group flux field is $\\phi_{g}(\\mathbf{x})$. The governing equation in the diffusion approximation is\n$$\n-\\nabla \\cdot \\left(D_{g}(\\mathbf{x}) \\nabla \\phi_{g}(\\mathbf{x})\\right) + \\Sigma_{r,g}(\\mathbf{x}) \\phi_{g}(\\mathbf{x})\n= \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g' \\to g}(\\mathbf{x}) \\phi_{g'}(\\mathbf{x}) \\;+\\; \\chi_{g} \\frac{1}{k} \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g'}(\\mathbf{x}) \\phi_{g'}(\\mathbf{x}) \\;+\\; Q_{g}(\\mathbf{x}),\n$$\nwhere $D_{g}(\\mathbf{x})$ is the diffusion coefficient, $\\Sigma_{r,g}(\\mathbf{x})$ is the removal cross section, $\\Sigma_{s,g' \\to g}(\\mathbf{x})$ is the scattering cross section from group $g'$ to group $g$, $\\Sigma_{f,g'}(\\mathbf{x})$ is the macroscopic fission cross section, $\\nu$ is the average number of neutrons produced per fission, $\\chi_{g}$ is the fission spectrum fraction into group $g$, $k$ is the effective multiplication factor, and $Q_{g}(\\mathbf{x})$ is an external source. All material coefficients may be discontinuous across material interfaces and may depend on thermal-hydraulic state variables; however, for the purpose of discretization in this problem, assume they are piecewise constant within each control volume, possibly obtained by accurate averaging of subcell mixtures.\n\nLet the mesh consist of control volumes $\\{V_{i}\\}$ with volumes $V_{i}$, cell-centered unknowns $\\phi_{g,i}$ for each $g$, and faces $\\{f\\}$ of area $A_{f}$ and outward unit normal $\\mathbf{n}_{f}$ relative to $V_{i}$. For an interior face $f$ shared by cells $i$ and $j_{f}$, let $d_{i,f}$ and $d_{j_{f},f}$ be the distances measured along $\\mathbf{n}_{f}$ from the respective cell centers to the plane of face $f$. On an interface where $D_{g}$ is discontinuous, enforce continuity of flux and continuity of normal current across the face. Within a cell $i$ that contains multiple material subregions indexed by $m$, with volume fractions $f_{m,i}$ satisfying $\\sum_{m} f_{m,i} = 1$, let the cellwise cross sections be defined by accurate mixture averaging as\n$$\n\\Sigma_{x,g,i} \\;=\\; \\sum_{m} f_{m,i} \\, \\Sigma_{x,g}^{(m)},\n$$\nfor any $x \\in \\{r, s(g' \\to g), f\\}$, where $\\Sigma_{x,g}^{(m)}$ are the material cross sections in subregion $m$.\n\nStarting from the governing equation and using the finite volume method, perform the following steps for a general interior face $f$ between $V_{i}$ and $V_{j_{f}}$:\n\n- Integrate the equation over $V_{i}$ and apply the divergence theorem to obtain face-integrated diffusive currents.\n- Enforce continuity of flux and normal current across $f$ to derive a two-point flux for the diffusive term that is consistent in the presence of discontinuous $D_{g}$.\n- Express the scattering, removal, and fission source terms using the cellwise averaged cross sections and cell-centered fluxes.\n\nDefine the residual for use in a Jacobian-free Newton–Krylov (JFNK) method as $R_{g,i}(\\boldsymbol{\\phi},k)$, where $\\boldsymbol{\\phi}$ is the vector of all cell-centered group fluxes and $k$ is the eigenvalue unknown, such that $R_{g,i}(\\boldsymbol{\\phi},k) = 0$ enforces the discrete balance in $V_{i}$ for group $g$. Derive a closed-form analytical expression for $R_{g,i}(\\boldsymbol{\\phi},k)$ in terms of the quantities $A_{f}$, $d_{i,f}$, $d_{j_{f},f}$, $D_{g,i}$, $D_{g,j_{f}}$, $V_{i}$, $\\Sigma_{r,g,i}$, $\\Sigma_{s,g' \\to g,i}$, $\\Sigma_{f,g',i}$, $\\chi_{g}$, $\\nu$, $k$, $Q_{g,i}$, and the cell-centered unknowns $\\phi_{g,i}$ and $\\phi_{g,j_{f}}$.\n\nYour final answer must be the single analytical expression for $R_{g,i}(\\boldsymbol{\\phi},k)$ obtained by the above derivation. No numerical evaluation is required. No units are required in the final expression. If any assumptions are needed for closure of the face term, clearly state them in your derivation; however, the final answer must be a single, explicit residual formula.",
            "solution": "The problem requires the derivation of the discrete residual for the steady-state multigroup neutron diffusion equation using a cell-centered finite volume method on an unstructured polyhedral mesh. The residual, denoted $R_{g,i}(\\boldsymbol{\\phi},k)$, represents the discretized balance equation for energy group $g$ in control volume $V_i$. The derivation proceeds as follows.\n\nFirst, we state the governing equation for a specific energy group $g$:\n$$\n-\\nabla \\cdot \\left(D_{g}(\\mathbf{x}) \\nabla \\phi_{g}(\\mathbf{x})\\right) + \\Sigma_{r,g}(\\mathbf{x}) \\phi_{g}(\\mathbf{x})\n= \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g' \\to g}(\\mathbf{x}) \\phi_{g'}(\\mathbf{x}) + \\frac{\\chi_{g}}{k} \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g'}(\\mathbf{x}) \\phi_{g'}(\\mathbf{x}) + Q_{g}(\\mathbf{x})\n$$\nThis equation represents a balance of neutron reaction rates: Leakage + Removal = Scattering Source + Fission Source + External Source.\n\nTo discretize this equation, we integrate it over a control volume $V_i$:\n$$\n\\int_{V_i} \\left( -\\nabla \\cdot \\left(D_{g} \\nabla \\phi_{g}\\right) \\right) dV + \\int_{V_i} \\Sigma_{r,g} \\phi_{g} dV = \\int_{V_i} \\left( \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g' \\to g} \\phi_{g'} \\right) dV + \\int_{V_i} \\left( \\frac{\\chi_{g}}{k} \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g'} \\phi_{g'} \\right) dV + \\int_{V_i} Q_{g} dV\n$$\nLet's discretize each term.\n\nThe leakage term is treated by applying the divergence theorem:\n$$\n\\int_{V_i} \\left( -\\nabla \\cdot \\left(D_{g} \\nabla \\phi_{g}\\right) \\right) dV = -\\oint_{\\partial V_i} \\left(D_{g} \\nabla \\phi_{g}\\right) \\cdot \\mathbf{n} dS = -\\sum_{f \\in \\partial V_i} \\int_{A_f} \\left(D_{g} \\nabla \\phi_{g}\\right) \\cdot \\mathbf{n}_f dS\n$$\nwhere $\\partial V_i$ is the boundary of the control volume $V_i$, composed of faces $f$. The vector $\\mathbf{n}_f$ is the outward unit normal relative to $V_i$. The term $-D_{g} \\nabla \\phi_{g}$ is the neutron current density, $\\mathbf{J}_g$. We are evaluating the net current leaving the control volume. The integral becomes a sum over faces, and assuming the normal current is uniform across each face, we have:\n$$\n-\\sum_{f \\in \\partial V_i} A_f \\left( \\mathbf{J}_{g,f} \\cdot \\mathbf{n}_f \\right) = -\\sum_{f \\in \\partial V_i} A_f J_{g,f,n}\n$$\nwhere $J_{g,f,n}$ is the average normal current through face $f$.\n\nTo find an expression for $J_{g,f,n}$ for an interior face $f$ between cells $i$ and $j_f$ with potentially discontinuous $D_g$, we enforce continuity of flux and normal current at the face. We assume a one-dimensional flux profile along the line connecting the cell centers of $i$ and $j_f$. Let the coordinate along this line, normal to the face, be $\\xi$, with the face at $\\xi=0$. The cell center of $i$ is at $\\xi = -d_{i,f}$ and that of $j_f$ is at $\\xi = +d_{j_f,f}$.\nThe normal current within cell $i$, evaluated at the face, is approximated as:\n$$\nJ_{g,f,n} = -D_{g,i} \\frac{\\phi_{g,f} - \\phi_{g,i}}{d_{i,f}}\n$$\nSimilarly, from cell $j_f$:\n$$\nJ_{g,f,n} = -D_{g,j_f} \\frac{\\phi_{g,j_f} - \\phi_{g,f}}{d_{j_f,f}}\n$$\nwhere $\\phi_{g,f}$ is the unknown flux value at the face. We can solve for $J_{g,f,n}$ by eliminating $\\phi_{g,f}$. From the two equations, we have:\n$$\n\\phi_{g,f} = \\phi_{g,i} - J_{g,f,n} \\frac{d_{i,f}}{D_{g,i}} \\quad \\text{and} \\quad \\phi_{g,f} = \\phi_{g,j_f} + J_{g,f,n} \\frac{d_{j_f,f}}{D_{g,j_f}}\n$$\nEquating these expressions for $\\phi_{g,f}$:\n$$\n\\phi_{g,i} - J_{g,f,n} \\frac{d_{i,f}}{D_{g,i}} = \\phi_{g,j_f} + J_{g,f,n} \\frac{d_{j_f,f}}{D_{g,j_f}}\n$$\nSolving for $J_{g,f,n}$:\n$$\n\\phi_{g,i} - \\phi_{g,j_f} = J_{g,f,n} \\left( \\frac{d_{i,f}}{D_{g,i}} + \\frac{d_{j_f,f}}{D_{g,j_f}} \\right) \\implies J_{g,f,n} = \\frac{\\phi_{g,i} - \\phi_{g,j_f}}{\\frac{d_{i,f}}{D_{g,i}} + \\frac{d_{j_f,f}}{D_{g,j_f}}}\n$$\nThe total rate of neutrons leaking out of cell $i$ is $\\sum_{f \\in \\partial V_i} A_f J_{g,f,n}$. Using the derived expression for the current, the net leakage term for cell $i$ is:\n$$\n\\text{Leakage} = \\sum_{f \\in \\partial V_i} \\frac{A_f (\\phi_{g,i} - \\phi_{g,j_f})}{\\frac{d_{i,f}}{D_{g,i}} + \\frac{d_{j_f,f}}{D_{g,j_f}}}\n$$\nThis expression is valid for all interior faces of cell $i$.\n\nThe remaining terms (removal and sources) are simpler to discretize, as material properties are assumed to be piecewise constant within each cell $V_i$. We approximate the integrals using the cell-centered flux $\\phi_{g,i}$ and cell-averaged cross sections $\\Sigma_{x,g,i}$.\n$$\n\\int_{V_i} \\Sigma_{r,g} \\phi_{g} dV \\approx \\Sigma_{r,g,i} \\phi_{g,i} V_i\n$$\n$$\n\\int_{V_i} \\left( \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g' \\to g} \\phi_{g'} \\right) dV \\approx V_i \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g' \\to g, i} \\phi_{g',i}\n$$\n$$\n\\int_{V_i} \\left( \\frac{\\chi_{g}}{k} \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g'} \\phi_{g'} \\right) dV \\approx V_i \\frac{\\chi_{g}}{k} \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g',i} \\phi_{g',i}\n$$\n$$\n\\int_{V_i} Q_{g} dV \\approx Q_{g,i} V_i\n$$\n\nThe residual $R_{g,i}(\\boldsymbol{\\phi},k)$ is defined by setting the net balance of all reaction rates to zero. The convention is $(\\text{Loss Terms}) - (\\text{Source Terms}) = 0$.\nLoss terms are leakage and removal. Source terms are in-scattering, fission, and external sources.\n$$\nR_{g,i}(\\boldsymbol{\\phi},k) = (\\text{Leakage} + \\text{Removal}) - (\\text{Scattering Source} + \\text{Fission Source} + \\text{External Source}) = 0\n$$\nSubstituting the derived discrete expressions:\n$$\nR_{g,i}(\\boldsymbol{\\phi},k) = \\sum_{f \\in \\partial V_i} \\frac{A_f (\\phi_{g,i} - \\phi_{g,j_f})}{\\frac{d_{i,f}}{D_{g,i}} + \\frac{d_{j_f,f}}{D_{g,j_f}}} + \\Sigma_{r,g,i} \\phi_{g,i} V_i - V_i \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g' \\to g, i} \\phi_{g',i} - V_i \\frac{\\chi_{g}}{k} \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g',i} \\phi_{g',i} - Q_{g,i} V_i\n$$\nThis expression assumes that all faces $f$ of cell $i$ are interior faces, each connected to a neighbor cell $j_f$. We can factor out the volume $V_i$ from the non-leakage terms to obtain the final form.\nThe dependence on the global flux vector $\\boldsymbol{\\phi}$ is through the terms $\\phi_{g,i}$, $\\phi_{g,j_f}$ (for spatial coupling), and $\\phi_{g',i}$ (for energy group coupling). The dependence on the eigenvalue $k$ is explicit in the fission source term.",
            "answer": "$$\\boxed{R_{g,i}(\\boldsymbol{\\phi},k) = \\sum_{f \\in \\partial V_i} \\frac{A_f (\\phi_{g,i} - \\phi_{g,j_f})}{\\frac{d_{i,f}}{D_{g,i}} + \\frac{d_{j_f,f}}{D_{g,j_f}}} + V_i \\left( \\Sigma_{r,g,i} \\phi_{g,i} - \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g' \\to g, i} \\phi_{g',i} - \\frac{\\chi_{g}}{k} \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g',i} \\phi_{g',i} - Q_{g,i} \\right)}$$"
        },
        {
            "introduction": "Once a residual has been formulated and implemented in code, how can we be sure it is correct? This exercise introduces the Method of Manufactured Solutions (MMS), a powerful and rigorous technique for software verification. You will construct an analytical solution, substitute it into the governing equations to derive corresponding source terms, and then use this setup to analyze the accuracy of the finite-difference Jacobian-vector product approximation . This practice is critical for building confidence in your numerical implementation and understanding the truncation error at the heart of the \"Jacobian-free\" approach.",
            "id": "4232172",
            "problem": "Consider a one-dimensional, steady-state, dimensionless model of coupled neutronics and heat conduction in a nuclear fuel slab occupying the domain $x \\in [0,\\pi]$. The unknown field is $u(x) = (\\phi(x), T(x))$, where $\\phi(x)$ is the neutron scalar flux and $T(x)$ is the temperature. The governing equations are based on neutron diffusion and heat conduction with fission heating:\n$$\n- \\frac{d}{dx} \\left( D \\frac{d \\phi}{dx} \\right) + \\Sigma_{a}(T) \\, \\phi = \\nu \\, \\Sigma_{f} \\, \\phi + S_{n}(x),\n$$\n$$\n- \\frac{d}{dx} \\left( k_{T} \\frac{d T}{dx} \\right) = Q_{f} \\, \\Sigma_{f} \\, \\phi + S_{T}(x),\n$$\nwhere $D  0$ is the neutron diffusion coefficient, $k_{T}  0$ is the thermal conductivity, $\\Sigma_{f}  0$ is the fission cross section, $\\nu  0$ is the average number of neutrons per fission, and $Q_{f}  0$ is the energy released per fission (scaled to be dimensionless). The absorption cross section is modeled with linear Doppler feedback,\n$$\n\\Sigma_{a}(T) = \\Sigma_{a0} + \\alpha \\, T,\n$$\nwith $\\Sigma_{a0}  0$ and $\\alpha  0$ constants. Assume Dirichlet boundary conditions are chosen to be consistent with the manufactured solution defined below.\n\nUsing the method of manufactured solutions, choose analytic fields\n$$\n\\phi(x) = \\Phi_{0} \\cos(x) + \\Phi_{1} \\sin(2x), \\qquad T(x) = T_{0} + \\Theta_{0} \\sin(x),\n$$\nwith constants $\\Phi_{0}$, $\\Phi_{1}$, $T_{0}$, $\\Theta_{0}$ specified and positive. Back-compute the source terms $S_{n}(x)$ and $S_{T}(x)$ so that the chosen $(\\phi,T)$ exactly satisfy the equations above for given constants $D$, $k_{T}$, $\\Sigma_{a0}$, $\\alpha$, $\\Sigma_{f}$, $\\nu$, and $Q_{f}$.\n\nDefine the residual operator $R(u)$ component-wise as\n$$\nR_{\\phi}(u) = - D \\, \\phi'' + (\\Sigma_{a0} + \\alpha T) \\, \\phi - \\nu \\, \\Sigma_{f} \\, \\phi - S_{n}(x),\n$$\n$$\nR_{T}(u) = - k_{T} \\, T'' - Q_{f} \\, \\Sigma_{f} \\, \\phi - S_{T}(x),\n$$\nwhere $'$ denotes differentiation with respect to $x$. The Jacobian of the residual evaluated at $u$, denoted $J R(u)$, acts on a perturbation $v = (v_{\\phi}, v_{T})$ via the directional derivative of $R$ at $u$ in the direction $v$. In a Jacobian-free Newton–Krylov (JFNK) method, the Jacobian-vector product is approximated by the first-order difference quotient\n$$\nJ_{\\epsilon}(u; v) = \\frac{R(u + \\epsilon v) - R(u)}{\\epsilon},\n$$\nfor a small parameter $\\epsilon  0$. The Taylor test error in the $L^{2}$ norm is\n$$\nE(\\epsilon) = \\left\\| J_{\\epsilon}(u; v) - J R(u) v \\right\\|_{L^{2}(0,\\pi)}.\n$$\n\nFor the specific test direction\n$$\nv_{\\phi}(x) = V_{\\phi} \\sin(x), \\qquad v_{T}(x) = V_{T} \\cos(x),\n$$\nwith $V_{\\phi}  0$ and $V_{T}  0$ constants, derive the exact leading-order coefficient of $\\epsilon$ in the small-$\\epsilon$ expansion of $E(\\epsilon)$, that is,\n$$\n\\lim_{\\epsilon \\to 0^{+}} \\frac{E(\\epsilon)}{\\epsilon}.\n$$\nExpress your final answer as a simplified, closed-form analytic expression in terms of $\\alpha$, $V_{\\phi}$, $V_{T}$, and $\\pi$. No numerical rounding is required. Use dimensionless quantities throughout and do not include units in your answer.",
            "solution": "The user wants to find the leading-order coefficient of the Taylor test error for a Jacobian-free Newton–Krylov (JFNK) method applied to a coupled neutronics-thermal model. The problem is valid as it is scientifically grounded in established models of reactor physics and numerical analysis, is well-posed, objective, and internally consistent.\n\nThe quantity to be determined is the limit\n$$ L = \\lim_{\\epsilon \\to 0^{+}} \\frac{E(\\epsilon)}{\\epsilon}, $$\nwhere the Taylor test error $E(\\epsilon)$ is defined as\n$$ E(\\epsilon) = \\left\\| J_{\\epsilon}(u; v) - J R(u) v \\right\\|_{L^{2}(0,\\pi)}. $$\nHere, $J R(u) v$ is the exact Jacobian-vector product (the directional derivative of the residual operator $R(u)$ in the direction $v$), and $J_{\\epsilon}(u; v)$ is its finite difference approximation:\n$$ J_{\\epsilon}(u; v) = \\frac{R(u + \\epsilon v) - R(u)}{\\epsilon}. $$\nThe state vector is $u(x) = (\\phi(x), T(x))$ and the perturbation vector is $v(x) = (v_{\\phi}(x), v_{T}(x))$.\n\nTo analyze the difference $J_{\\epsilon}(u; v) - J R(u) v$, we perform a Taylor series expansion of $R(u + \\epsilon v)$ around $u$ with respect to the small parameter $\\epsilon$. For a sufficiently smooth operator $R$, the expansion is\n$$ R(u + \\epsilon v) = R(u) + \\epsilon J R(u) v + \\frac{\\epsilon^2}{2} H R(u)(v,v) + O(\\epsilon^3), $$\nwhere $H R(u)(v,v)$ is the second directional derivative of $R$ at $u$ in the direction $v$ (i.e., the Hessian of $R$ applied to the pair of vectors $(v, v)$).\n\nSubstituting this expansion into the definition of $J_{\\epsilon}(u; v)$:\n$$ J_{\\epsilon}(u; v) = \\frac{ \\left( R(u) + \\epsilon J R(u) v + \\frac{\\epsilon^2}{2} H R(u)(v,v) + O(\\epsilon^3) \\right) - R(u) }{\\epsilon} $$\n$$ J_{\\epsilon}(u; v) = J R(u) v + \\frac{\\epsilon}{2} H R(u)(v,v) + O(\\epsilon^2). $$\nThe difference term is therefore\n$$ J_{\\epsilon}(u; v) - J R(u) v = \\frac{\\epsilon}{2} H R(u)(v,v) + O(\\epsilon^2). $$\nThis is the truncation error of the finite difference approximation.\n\nNow, we can express the error $E(\\epsilon)$ as\n$$ E(\\epsilon) = \\left\\| \\frac{\\epsilon}{2} H R(u)(v,v) + O(\\epsilon^2) \\right\\|_{L^{2}(0,\\pi)}. $$\nThe quantity we need to evaluate is\n$$ L = \\lim_{\\epsilon \\to 0^{+}} \\frac{E(\\epsilon)}{\\epsilon} = \\lim_{\\epsilon \\to 0^{+}} \\frac{1}{\\epsilon} \\left\\| \\frac{\\epsilon}{2} H R(u)(v,v) + O(\\epsilon^2) \\right\\|_{L^{2}(0,\\pi)}. $$\nUsing the property of norms $\\|c f\\| = |c| \\|f\\|$, we can factor out $\\epsilon$:\n$$ L = \\lim_{\\epsilon \\to 0^{+}} \\left\\| \\frac{1}{2} H R(u)(v,v) + O(\\epsilon) \\right\\|_{L^{2}(0,\\pi)}. $$\nBy the continuity of the norm, we can take the limit inside:\n$$ L = \\left\\| \\lim_{\\epsilon \\to 0^{+}} \\left( \\frac{1}{2} H R(u)(v,v) + O(\\epsilon) \\right) \\right\\|_{L^{2}(0,\\pi)} = \\left\\| \\frac{1}{2} H R(u)(v,v) \\right\\|_{L^{2}(0,\\pi)}. $$\nOur task reduces to calculating the $L^2$ norm of the vector $\\frac{1}{2} H R(u)(v,v)$. This requires finding the second directional derivative of the residual operator $R(u)$. The components of the residual are:\n$$ R_{\\phi}(u) = - D \\, \\phi'' + (\\Sigma_{a0} + \\alpha T) \\, \\phi - \\nu \\, \\Sigma_{f} \\, \\phi - S_{n}(x) $$\n$$ R_{T}(u) = - k_{T} \\, T'' - Q_{f} \\, \\Sigma_{f} \\, \\phi - S_{T}(x) $$\nThe second directional derivative $H R(u)(v,v)$ is the vector $(\\frac{d^2}{d\\delta^2} R_{\\phi}(u+\\delta v)|_{\\delta=0}, \\frac{d^2}{d\\delta^2} R_{T}(u+\\delta v)|_{\\delta=0})$.\n\nLet's inspect the components for non-linearities in $u=(\\phi, T)$.\nThe term $R_T(u)$ is linear in $\\phi$ and $T$. Therefore, its second derivative with respect to $u$ is zero.\n$$ H R_T(u)(v,v) = 0. $$\nThe term $R_{\\phi}(u)$ can be rewritten as\n$$ R_{\\phi}(u) = - D \\, \\phi'' + \\Sigma_{a0}\\phi + \\alpha T \\phi - \\nu \\Sigma_f \\phi - S_n(x). $$\nThe only term that is not linear in the components of $u$ is the product $\\alpha T \\phi$. All other terms are linear, so their second derivatives are zero. Thus, the Hessian contribution comes solely from this term.\nLet $g(\\phi, T) = \\alpha T \\phi$. The second directional derivative of $g$ in the direction $v=(v_{\\phi}, v_T)$ is\n$$ \\frac{d^2}{d\\delta^2} g(\\phi + \\delta v_{\\phi}, T + \\delta v_T)|_{\\delta=0} = \\frac{d^2}{d\\delta^2} \\left[ \\alpha (T + \\delta v_T)(\\phi + \\delta v_{\\phi}) \\right] |_{\\delta=0}. $$\nExpanding the term in the brackets gives\n$$ \\alpha(T\\phi + \\delta(T v_{\\phi} + \\phi v_T) + \\delta^2(v_{\\phi}v_T)). $$\nThe second derivative with respect to $\\delta$ is $2\\alpha v_{\\phi} v_T$. So,\n$$ H R_{\\phi}(u)(v,v) = 2 \\alpha v_{\\phi}(x) v_{T}(x). $$\nNotice that this result is independent of the base state $u(x)$, so the specific forms of $\\phi(x)$ and $T(x)$ provided are not needed for this calculation.\n\nThe Hessian vector is\n$$ H R(u)(v,v) = \\begin{pmatrix} 2 \\alpha v_{\\phi}(x) v_{T}(x) \\\\ 0 \\end{pmatrix}. $$\nNow we can compute the desired limit $L$:\n$$ L = \\left\\| \\frac{1}{2} H R(u)(v,v) \\right\\|_{L^{2}(0,\\pi)} = \\left\\| \\frac{1}{2} \\begin{pmatrix} 2 \\alpha v_{\\phi}(x) v_{T}(x) \\\\ 0 \\end{pmatrix} \\right\\|_{L^{2}(0,\\pi)} = \\left\\| \\begin{pmatrix} \\alpha v_{\\phi}(x) v_{T}(x) \\\\ 0 \\end{pmatrix} \\right\\|_{L^{2}(0,\\pi)}. $$\nThe $L^2$ norm is defined by $\\left\\| f \\right\\|_{L^2} = \\sqrt{\\int_0^\\pi \\|f(x)\\|_2^2 dx}$. For our vector function, this becomes\n$$ L = \\sqrt{\\int_0^{\\pi} \\left( (\\alpha v_{\\phi}(x) v_{T}(x))^2 + 0^2 \\right) dx} = \\sqrt{\\int_0^{\\pi} \\alpha^2 (v_{\\phi}(x) v_{T}(x))^2 dx}. $$\nThe problem provides the specific test direction functions:\n$$ v_{\\phi}(x) = V_{\\phi} \\sin(x) \\quad \\text{and} \\quad v_{T}(x) = V_{T} \\cos(x). $$\nSubstituting these into the integral:\n$$ L = \\sqrt{\\int_0^{\\pi} \\alpha^2 (V_{\\phi} \\sin(x) \\cdot V_{T} \\cos(x))^2 dx} = \\sqrt{\\alpha^2 V_{\\phi}^2 V_{T}^2 \\int_0^{\\pi} \\sin^2(x) \\cos^2(x) dx}. $$\nSince $\\alpha, V_{\\phi}, V_{T}$ are positive constants, we have\n$$ L = \\alpha V_{\\phi} V_{T} \\sqrt{\\int_0^{\\pi} \\sin^2(x) \\cos^2(x) dx}. $$\nWe use the trigonometric identity $\\sin(x)\\cos(x) = \\frac{1}{2}\\sin(2x)$.\n$$ \\int_0^{\\pi} \\sin^2(x) \\cos^2(x) dx = \\int_0^{\\pi} \\left( \\frac{1}{2}\\sin(2x) \\right)^2 dx = \\frac{1}{4} \\int_0^{\\pi} \\sin^2(2x) dx. $$\nNext, we use the identity $\\sin^2(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$. With $\\theta = 2x$, this becomes $\\sin^2(2x) = \\frac{1 - \\cos(4x)}{2}$.\n$$ \\frac{1}{4} \\int_0^{\\pi} \\left( \\frac{1 - \\cos(4x)}{2} \\right) dx = \\frac{1}{8} \\int_0^{\\pi} (1 - \\cos(4x)) dx. $$\nEvaluating the definite integral:\n$$ \\frac{1}{8} \\left[ x - \\frac{1}{4}\\sin(4x) \\right]_0^{\\pi} = \\frac{1}{8} \\left[ (\\pi - \\frac{1}{4}\\sin(4\\pi)) - (0 - \\frac{1}{4}\\sin(0)) \\right] = \\frac{1}{8} (\\pi - 0 - 0) = \\frac{\\pi}{8}. $$\nSubstituting this result back into the expression for $L$:\n$$ L = \\alpha V_{\\phi} V_{T} \\sqrt{\\frac{\\pi}{8}}. $$\nSimplifying the square root term:\n$$ \\sqrt{\\frac{\\pi}{8}} = \\frac{\\sqrt{\\pi}}{\\sqrt{8}} = \\frac{\\sqrt{\\pi}}{2\\sqrt{2}} = \\frac{\\sqrt{\\pi}\\sqrt{2}}{2\\sqrt{2}\\sqrt{2}} = \\frac{\\sqrt{2\\pi}}{4}. $$\nTherefore, the final expression for the limit is\n$$ L = \\alpha V_{\\phi} V_{T} \\frac{\\sqrt{2\\pi}}{4}. $$\nThis expression is in terms of the specified constants $\\alpha$, $V_{\\phi}$, $V_{T}$, and $\\pi$.",
            "answer": "$$\\boxed{\\frac{\\alpha V_{\\phi} V_{T} \\sqrt{2\\pi}}{4}}$$"
        },
        {
            "introduction": "A correct implementation does not always guarantee an efficient one, especially in multiphysics where vastly different physical scales can lead to stiff, ill-conditioned systems. This final practice explores how poor scaling between coupled physics can severely hamper the convergence of the Krylov subspace solver (GMRES) at the core of the JFNK method. Using a simplified but highly illustrative model , you will analytically demonstrate how the solver can stagnate when trying to resolve residuals of disparate magnitudes, providing clear motivation for the necessity of robust preconditioning strategies in practical applications.",
            "id": "4232108",
            "problem": "Consider a Jacobian-free Newton–Krylov (JFNK) solve for a coupled nuclear reactor multiphysics system with neutron diffusion and heat conduction, where the nonlinear residual is $F(U)$ with $U = (\\phi, T)$ denoting the neutron flux and temperature fields. The Newton linearization at a given iterate seeks $\\delta U$ such that $J \\, \\delta U = -F(U)$, where $J$ is the Jacobian of $F$ with respect to $U$. Suppose that at this iterate the preconditioned Jacobian is well approximated by a linear operator that is diagonalizable with eigenvectors aligned to the physics blocks, and in this simplified model the effective spectrum can be represented by the diagonal matrix\n$$\nJ = \\begin{pmatrix}\n\\lambda_{\\phi}  0 \\\\\n0  \\lambda_{T}\n\\end{pmatrix},\n$$\nwith $\\lambda_{\\phi} = 1$ and $\\lambda_{T} = 10^{-6}$, reflecting disparate stiffness arising from coupled transport and conduction scales.\n\nAssume an improper residual scaling is applied that leaves the neutron block with magnitude $w_{\\phi} = 1$ while suppressing the temperature block to $w_{T} = 10^{-6}$, so the initial residual in the eigenbasis is\n$$\nr_{0} = \\begin{pmatrix}\nw_{\\phi} \\\\\nw_{T}\n\\end{pmatrix} = \\begin{pmatrix}\n1 \\\\\n10^{-6}\n\\end{pmatrix}.\n$$\nApply the Generalized Minimal Residual (GMRES) method, defined as minimizing the norm of the residual over polynomials in $J$ with $p(0) = 1$ within a Krylov subspace, for a single iteration ($k = 1$). In this case the residual after one iteration can be written as $r_{1} = (I - \\alpha J) r_{0}$ for some scalar $\\alpha$ chosen to minimize $\\|r_{1}\\|_{2}^{2}$.\n\nStarting from the fundamental definition of the GMRES one-step residual minimization, derive the expression for $\\alpha$ and then compute the small-block residual reduction factor\n$$\ng_{T} = \\left| 1 - \\alpha \\lambda_{T} \\right|\n$$\nfor the given data. Provide $g_{T}$ as a pure number. If you choose to approximate, round your answer to six significant figures and do not include any units.",
            "solution": "The problem requires the analysis of a single iteration of the Generalized Minimal Residual (GMRES) method applied to a simplified, stiff, and poorly scaled linear system that arises from a Jacobian-free Newton–Krylov (JFNK) method for a nuclear reactor physics problem.\n\nFirst, we validate the problem statement.\nThe givens are:\n- A simplified, diagonalized Jacobian matrix representing a coupled system:\n$$\nJ = \\begin{pmatrix}\n\\lambda_{\\phi}  0 \\\\\n0  \\lambda_{T}\n\\end{pmatrix}\n$$\n- The eigenvalues, representing the disparate physical scales: $\\lambda_{\\phi} = 1$ and $\\lambda_{T} = 10^{-6}$.\n- An improperly scaled initial residual vector in the same eigenbasis:\n$$\nr_{0} = \\begin{pmatrix}\nw_{\\phi} \\\\\nw_{T}\n\\end{pmatrix} = \\begin{pmatrix}\n1 \\\\\n10^{-6}\n\\end{pmatrix}\n$$\n- The form of the residual after one GMRES iteration ($k=1$): $r_{1} = (I - \\alpha J) r_{0}$.\n- The optimization criterion: the scalar $\\alpha$ is chosen to minimize the Euclidean norm of the new residual, $\\|r_{1}\\|_{2}$.\n- The quantity to be computed: the small-block residual reduction factor $g_{T} = | 1 - \\alpha \\lambda_{T} |$.\n\nThe problem is scientifically grounded, as it models a common and critical issue (stiffness and poor scaling) in multiphysics simulations using standard numerical methods (JFNK, GMRES). It is well-posed, with a clear objective and all necessary data provided to find a unique solution. The language is objective and precise. Therefore, the problem is valid.\n\nWe proceed with the solution. The core task is to find the value of $\\alpha$ that minimizes the squared Euclidean norm of the residual $r_{1}$. Let this objective function be $f(\\alpha) = \\|r_{1}\\|_{2}^{2}$.\n\nFirst, we express $r_{1}$ in terms of the given quantities:\n$$\nr_{1} = \\left( \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\alpha \\begin{pmatrix} \\lambda_{\\phi}  0 \\\\ 0  \\lambda_{T} \\end{pmatrix} \\right) \\begin{pmatrix} w_{\\phi} \\\\ w_{T} \\end{pmatrix} = \\begin{pmatrix} 1 - \\alpha\\lambda_{\\phi}  0 \\\\ 0  1 - \\alpha\\lambda_{T} \\end{pmatrix} \\begin{pmatrix} w_{\\phi} \\\\ w_{T} \\end{pmatrix} = \\begin{pmatrix} (1 - \\alpha\\lambda_{\\phi})w_{\\phi} \\\\ (1 - \\alpha\\lambda_{T})w_{T} \\end{pmatrix}\n$$\nThe squared norm of $r_{1}$ is:\n$$\nf(\\alpha) = \\|r_{1}\\|_{2}^{2} = ((1 - \\alpha\\lambda_{\\phi})w_{\\phi})^{2} + ((1 - \\alpha\\lambda_{T})w_{T})^{2}\n$$\nTo find the minimum, we differentiate $f(\\alpha)$ with respect to $\\alpha$ and set the result to zero.\n$$\n\\frac{df}{d\\alpha} = \\frac{d}{d\\alpha} \\left[ (1 - 2\\alpha\\lambda_{\\phi} + \\alpha^{2}\\lambda_{\\phi}^{2})w_{\\phi}^{2} + (1 - 2\\alpha\\lambda_{T} + \\alpha^{2}\\lambda_{T}^{2})w_{T}^{2} \\right] = 0\n$$\n$$\n(-2\\lambda_{\\phi} + 2\\alpha\\lambda_{\\phi}^{2})w_{\\phi}^{2} + (-2\\lambda_{T} + 2\\alpha\\lambda_{T}^{2})w_{T}^{2} = 0\n$$\nSolving for $\\alpha$:\n$$\n\\alpha(\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}) = \\lambda_{\\phi}w_{\\phi}^{2} + \\lambda_{T}w_{T}^{2}\n$$\n$$\n\\alpha = \\frac{\\lambda_{\\phi}w_{\\phi}^{2} + \\lambda_{T}w_{T}^{2}}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}}\n$$\nThis expression gives the optimal $\\alpha$ for the single GMRES step. Now, we compute the small-block residual reduction factor, $g_{T} = |1 - \\alpha \\lambda_{T}|$. We substitute the derived expression for $\\alpha$:\n$$\ng_{T} = \\left| 1 - \\left( \\frac{\\lambda_{\\phi}w_{\\phi}^{2} + \\lambda_{T}w_{T}^{2}}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}} \\right) \\lambda_{T} \\right|\n$$\nTo simplify, we find a common denominator:\n$$\n1 - \\alpha \\lambda_{T} = \\frac{(\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}) - (\\lambda_{\\phi}w_{\\phi}^{2}\\lambda_{T} + \\lambda_{T}^{2}w_{T}^{2})}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}}\n$$\n$$\n= \\frac{\\lambda_{\\phi}^{2}w_{\\phi}^{2} - \\lambda_{\\phi}w_{\\phi}^{2}\\lambda_{T}}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}} = \\frac{\\lambda_{\\phi}w_{\\phi}^{2}(\\lambda_{\\phi} - \\lambda_{T})}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}}\n$$\nGiven the values $\\lambda_{\\phi} = 1$ and $\\lambda_{T} = 10^{-6}$, we have $\\lambda_{\\phi}  \\lambda_{T}$. All other terms in the expression are non-negative ($w_{\\phi}$, $w_{T}$ are squared). Therefore, the expression is positive, and the absolute value is redundant.\n$$\ng_{T} = \\frac{\\lambda_{\\phi}w_{\\phi}^{2}(\\lambda_{\\phi} - \\lambda_{T})}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}}\n$$\nNow, we substitute the numerical values provided in the problem: $\\lambda_{\\phi} = 1$, $\\lambda_{T} = 10^{-6}$, $w_{\\phi} = 1$, and $w_{T} = 10^{-6}$.\nThe numerator is:\n$$\n\\lambda_{\\phi}w_{\\phi}^{2}(\\lambda_{\\phi} - \\lambda_{T}) = 1 \\cdot (1)^{2} \\cdot (1 - 10^{-6}) = 1 - 10^{-6}\n$$\nThe denominator is:\n$$\n\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2} = (1)^{2}(1)^{2} + (10^{-6})^{2}(10^{-6})^{2} = 1 + (10^{-12})(10^{-12}) = 1 + 10^{-24}\n$$\nThus, the exact value for $g_{T}$ is:\n$$\ng_{T} = \\frac{1 - 10^{-6}}{1 + 10^{-24}} = \\frac{0.999999}{1.000000000000000000000001}\n$$\nTo obtain the final numerical answer, we perform the division and round to six significant figures as requested.\n$$\ng_{T} \\approx 0.999998999999999999999999...\n$$\nThe first six significant digits are $9, 9, 9, 9, 9, 8$. The seventh significant digit is $9$. Since $9 \\geq 5$, we round up the sixth digit.\n$$\ng_{T} \\approx 0.999999\n$$\nThis result demonstrates that the residual component corresponding to the slow physics (temperature), which was already small, is barely reduced (a reduction factor close to $1$). The GMRES iteration is almost entirely consumed by minimizing the large component of the residual corresponding to the stiff physics (neutrons), highlighting the detrimental effect of poor scaling on solver convergence.",
            "answer": "$$\\boxed{0.999999}$$"
        }
    ]
}