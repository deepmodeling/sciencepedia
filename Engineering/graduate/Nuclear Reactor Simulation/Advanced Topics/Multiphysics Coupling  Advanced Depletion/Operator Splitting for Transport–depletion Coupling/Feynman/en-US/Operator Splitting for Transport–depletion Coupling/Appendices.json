{
    "hands_on_practices": [
        {
            "introduction": "The order in which mathematical operations are applied can have significant consequences, a concept that is central to operator splitting methods. When operators do not commute, splitting the solution into sequential steps introduces an error. This exercise provides a foundational look into this phenomenon by asking you to derive the leading-order difference between two first-order splitting sequences for a simplified transport-depletion model. By working from the power-series definition of the matrix exponential, you will see precisely how the commutator, $[\\mathbf{D}, \\mathbf{T}]$, emerges as the source of this discrepancy.",
            "id": "4240100",
            "problem": "A single homogeneous spatial region in a nuclear reactor is modeled over a short time interval by a linearized, two-state system that couples neutron transport and nuclide depletion. Let the state vector be $\\mathbf{y}(t) = \\begin{pmatrix} \\psi(t) \\\\ N(t) \\end{pmatrix}$, where $\\psi(t)$ is a scalar neutron flux amplitude and $N(t)$ is the number density of a single representative nuclide. Over a small time step $\\Delta t$, assume the evolution is governed by a linear system $\\dot{\\mathbf{y}}(t) = (\\mathbf{T} + \\mathbf{D}) \\mathbf{y}(t)$ with constant operators\n$$\n\\mathbf{T} = \\begin{pmatrix} s & r \\\\ 0 & 0 \\end{pmatrix}, \\qquad\n\\mathbf{D} = \\begin{pmatrix} 0 & 0 \\\\ p & -\\lambda \\end{pmatrix},\n$$\nwhere $s$, $r$, $p$, and $\\lambda$ are real constants that do not vary during the step and represent, respectively, a linearized neutron transport growth rate, the sensitivity of neutron amplitude to nuclide density, a production coupling from neutrons to nuclide, and a nuclide removal rate. The exact propagator over $\\Delta t$ is $\\exp((\\mathbf{T}+\\mathbf{D}) \\Delta t)$.\n\nIn the Lie–Trotter operator-splitting approximation, two first-order factorizations are commonly used: applying depletion then transport yields $\\mathbf{U}_{D \\to T} = \\exp(\\mathbf{D}\\,\\Delta t)\\,\\exp(\\mathbf{T}\\,\\Delta t)$, while applying transport then depletion yields $\\mathbf{U}_{T \\to D} = \\exp(\\mathbf{T}\\,\\Delta t)\\,\\exp(\\mathbf{D}\\,\\Delta t)$.\n\nStarting only from the power-series definition of the matrix exponential and the definition of the commutator $[\\mathbf{A},\\mathbf{B}] \\equiv \\mathbf{A}\\mathbf{B} - \\mathbf{B}\\mathbf{A}$, derive, retaining terms up to and including order $(\\Delta t)^{2}$, the difference\n$$\n\\Delta \\mathbf{U} \\equiv \\mathbf{U}_{D \\to T} - \\mathbf{U}_{T \\to D},\n$$\nand express it in two equivalent ways: first, in terms of the commutator of $\\mathbf{D}$ and $\\mathbf{T}$ and, second, as an explicit $2 \\times 2$ matrix in the parameters $s$, $r$, $p$, $\\lambda$, and $\\Delta t$. Neglect all terms of order $\\mathcal{O}((\\Delta t)^{3})$ and higher. Provide your final answer as the explicit $2 \\times 2$ matrix expression for $\\Delta \\mathbf{U}$ up to order $(\\Delta t)^{2}$. No numerical values are required, and no units are needed. The final answer must be a single analytic expression.",
            "solution": "The problem requires the derivation of the difference between two first-order Lie-Trotter operator-splitting approximations for a given linear system. The difference, $\\Delta \\mathbf{U} \\equiv \\mathbf{U}_{D \\to T} - \\mathbf{U}_{T \\to D}$, is to be determined up to and including terms of order $(\\Delta t)^{2}$. We are instructed to start from the power-series definition of the matrix exponential.\n\nThe power-series definition of the exponential of a square matrix $\\mathbf{X}$ is:\n$$\n\\exp(\\mathbf{X}) = \\sum_{k=0}^{\\infty} \\frac{\\mathbf{X}^k}{k!} = \\mathbf{I} + \\mathbf{X} + \\frac{1}{2!}\\mathbf{X}^2 + \\frac{1}{3!}\\mathbf{X}^3 + \\dots\n$$\nwhere $\\mathbf{I}$ is the identity matrix. To solve this problem, we need to expand the exponential terms up to the second order in the time step $\\Delta t$. We neglect all terms of order $\\mathcal{O}((\\Delta t)^{3})$ and higher.\n\nThe two operators in question are $\\mathbf{T}$ and $\\mathbf{D}$. The exponentials we need to expand are $\\exp(\\mathbf{T}\\,\\Delta t)$ and $\\exp(\\mathbf{D}\\,\\Delta t)$:\n$$\n\\exp(\\mathbf{T}\\,\\Delta t) = \\mathbf{I} + (\\mathbf{T}\\,\\Delta t) + \\frac{1}{2}(\\mathbf{T}\\,\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3) = \\mathbf{I} + \\mathbf{T}\\Delta t + \\frac{1}{2}\\mathbf{T}^2(\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3)\n$$\n$$\n\\exp(\\mathbf{D}\\,\\Delta t) = \\mathbf{I} + (\\mathbf{D}\\,\\Delta t) + \\frac{1}{2}(\\mathbf{D}\\,\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3) = \\mathbf{I} + \\mathbf{D}\\Delta t + \\frac{1}{2}\\mathbf{D}^2(\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3)\n$$\n\nNow, we can write out the two splitting approximations by multiplying these series expansions.\n\nFirst, for the \"depletion then transport\" approximation, $\\mathbf{U}_{D \\to T} = \\exp(\\mathbf{D}\\,\\Delta t)\\,\\exp(\\mathbf{T}\\,\\Delta t)$:\n$$\n\\mathbf{U}_{D \\to T} = \\left( \\mathbf{I} + \\mathbf{D}\\Delta t + \\frac{1}{2}\\mathbf{D}^2(\\Delta t)^2 \\right) \\left( \\mathbf{I} + \\mathbf{T}\\Delta t + \\frac{1}{2}\\mathbf{T}^2(\\Delta t)^2 \\right) + \\mathcal{O}((\\Delta t)^3)\n$$\nWe perform the matrix multiplication, retaining only terms up to order $(\\Delta t)^2$:\n$$\n\\mathbf{U}_{D \\to T} = \\mathbf{I}(\\mathbf{I} + \\mathbf{T}\\Delta t + \\frac{1}{2}\\mathbf{T}^2(\\Delta t)^2) + \\mathbf{D}\\Delta t(\\mathbf{I} + \\mathbf{T}\\Delta t) + \\frac{1}{2}\\mathbf{D}^2(\\Delta t)^2(\\mathbf{I}) + \\mathcal{O}((\\Delta t)^3)\n$$\n$$\n\\mathbf{U}_{D \\to T} = \\mathbf{I} + \\mathbf{T}\\Delta t + \\frac{1}{2}\\mathbf{T}^2(\\Delta t)^2 + \\mathbf{D}\\Delta t + \\mathbf{D}\\mathbf{T}(\\Delta t)^2 + \\frac{1}{2}\\mathbf{D}^2(\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3)\n$$\nCollecting terms by powers of $\\Delta t$:\n$$\n\\mathbf{U}_{D \\to T} = \\mathbf{I} + (\\mathbf{D} + \\mathbf{T})\\Delta t + \\left(\\mathbf{D}\\mathbf{T} + \\frac{1}{2}\\mathbf{D}^2 + \\frac{1}{2}\\mathbf{T}^2\\right)(\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3)\n$$\n\nSecond, for the \"transport then depletion\" approximation, $\\mathbf{U}_{T \\to D} = \\exp(\\mathbf{T}\\,\\Delta t)\\,\\exp(\\mathbf{D}\\,\\Delta t)$, we simply swap the roles of $\\mathbf{T}$ and $\\mathbf{D}$ in the expansion above:\n$$\n\\mathbf{U}_{T \\to D} = \\left( \\mathbf{I} + \\mathbf{T}\\Delta t + \\frac{1}{2}\\mathbf{T}^2(\\Delta t)^2 \\right) \\left( \\mathbf{I} + \\mathbf{D}\\Delta t + \\frac{1}{2}\\mathbf{D}^2(\\Delta t)^2 \\right) + \\mathcal{O}((\\Delta t)^3)\n$$\n$$\n\\mathbf{U}_{T \\to D} = \\mathbf{I} + (\\mathbf{T} + \\mathbf{D})\\Delta t + \\left(\\mathbf{T}\\mathbf{D} + \\frac{1}{2}\\mathbf{T}^2 + \\frac{1}{2}\\mathbf{D}^2\\right)(\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3)\n$$\n\nNow we find the difference $\\Delta \\mathbf{U} = \\mathbf{U}_{D \\to T} - \\mathbf{U}_{T \\to D}$. The identity terms and the first-order terms in $\\Delta t$ cancel. The terms $\\frac{1}{2}\\mathbf{D}^2(\\Delta t)^2$ and $\\frac{1}{2}\\mathbf{T}^2(\\Delta t)^2$ also cancel.\n$$\n\\Delta \\mathbf{U} = \\left[ \\left(\\mathbf{D}\\mathbf{T} + \\frac{1}{2}\\mathbf{D}^2 + \\frac{1}{2}\\mathbf{T}^2\\right)(\\Delta t)^2 \\right] - \\left[ \\left(\\mathbf{T}\\mathbf{D} + \\frac{1}{2}\\mathbf{T}^2 + \\frac{1}{2}\\mathbf{D}^2\\right)(\\Delta t)^2 \\right] + \\mathcal{O}((\\Delta t)^3)\n$$\n$$\n\\Delta \\mathbf{U} = (\\mathbf{D}\\mathbf{T} - \\mathbf{T}\\mathbf{D})(\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3)\n$$\nUsing the definition of the commutator, $[\\mathbf{A},\\mathbf{B}] \\equiv \\mathbf{A}\\mathbf{B} - \\mathbf{B}\\mathbf{A}$, we arrive at the first required expression:\n$$\n\\Delta \\mathbf{U} = [\\mathbf{D}, \\mathbf{T}](\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3)\n$$\nThis result shows that the difference between the two splitting schemes, which is a measure of the splitting error, is proportional to the commutator of the operators and is of second order in the time step.\n\nFor the second part of the problem, we compute this commutator explicitly using the given matrices:\n$$\n\\mathbf{T} = \\begin{pmatrix} s & r \\\\ 0 & 0 \\end{pmatrix}, \\qquad \\mathbf{D} = \\begin{pmatrix} 0 & 0 \\\\ p & -\\lambda \\end{pmatrix}\n$$\nWe compute the matrix products $\\mathbf{D}\\mathbf{T}$ and $\\mathbf{T}\\mathbf{D}$:\n$$\n\\mathbf{D}\\mathbf{T} = \\begin{pmatrix} 0 & 0 \\\\ p & -\\lambda \\end{pmatrix} \\begin{pmatrix} s & r \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} (0)(s) + (0)(0) & (0)(r) + (0)(0) \\\\ (p)(s) + (-\\lambda)(0) & (p)(r) + (-\\lambda)(0) \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ ps & pr \\end{pmatrix}\n$$\n$$\n\\mathbf{T}\\mathbf{D} = \\begin{pmatrix} s & r \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ p & -\\lambda \\end{pmatrix} = \\begin{pmatrix} (s)(0) + (r)(p) & (s)(0) + (r)(-\\lambda) \\\\ (0)(0) + (0)(p) & (0)(0) + (0)(-\\lambda) \\end{pmatrix} = \\begin{pmatrix} pr & -r\\lambda \\\\ 0 & 0 \\end{pmatrix}\n$$\nThe commutator matrix is the difference between these two products:\n$$\n[\\mathbf{D}, \\mathbf{T}] = \\mathbf{D}\\mathbf{T} - \\mathbf{T}\\mathbf{D} = \\begin{pmatrix} 0 & 0 \\\\ ps & pr \\end{pmatrix} - \\begin{pmatrix} pr & -r\\lambda \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0-pr & 0-(-r\\lambda) \\\\ ps-0 & pr-0 \\end{pmatrix} = \\begin{pmatrix} -pr & r\\lambda \\\\ ps & pr \\end{pmatrix}\n$$\nFinally, we substitute this matrix into the expression for $\\Delta \\mathbf{U}$ and neglect terms of higher order, providing the explicit $2 \\times 2$ matrix as requested:\n$$\n\\Delta \\mathbf{U} = [\\mathbf{D}, \\mathbf{T}](\\Delta t)^2 = \\begin{pmatrix} -pr & r\\lambda \\\\ ps & pr \\end{pmatrix} (\\Delta t)^2 = \\begin{pmatrix} -pr (\\Delta t)^2 & r\\lambda (\\Delta t)^2 \\\\ ps (\\Delta t)^2 & pr (\\Delta t)^2 \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -pr(\\Delta t)^{2} & r\\lambda(\\Delta t)^{2} \\\\ ps(\\Delta t)^{2} & pr(\\Delta t)^{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Building upon the understanding that non-commutativity causes splitting error, we now explore how to quantify and control it. This practice introduces the second-order Strang splitting method and compares its accuracy against the first-order Lie–Trotter scheme. Using principles from the Baker-Campbell-Hausdorff formula and hypothetical operator norm bounds, you will derive the leading-order error terms for both methods and see how their different scalings with the time step, $\\Delta t$, influence decisions in adaptive time-stepping algorithms.",
            "id": "4240076",
            "problem": "Consider a coupled neutron transport–fuel depletion system in which the state over one time step is advanced by operator splitting. Let the combined generator be written as the sum of two time-independent operators over a single step, the transport operator $\\mathcal{T}$ and the depletion operator $\\mathcal{D}$, so that the exact one-step propagator over a duration $\\Delta t$ is $\\exp\\!\\big(\\Delta t(\\mathcal{T}+\\mathcal{D})\\big)$. In practice, one may use either the Lie–Trotter splitting $\\exp(\\Delta t\\,\\mathcal{T})\\,\\exp(\\Delta t\\,\\mathcal{D})$ or the Strang (symmetric) splitting $\\exp\\!\\big(\\frac{\\Delta t}{2}\\mathcal{T}\\big)\\,\\exp(\\Delta t\\,\\mathcal{D})\\,\\exp\\!\\big(\\frac{\\Delta t}{2}\\mathcal{T}\\big)$.\n\nAt a particular reactor state, assume the following bounds on operator commutators (all norms are in the induced $\\infty$-norm):\n- $\\big\\|[\\mathcal{T},\\mathcal{D}]\\big\\| \\leq 2.0~\\mathrm{s}^{-2}$,\n- $\\big\\|[\\mathcal{T},[\\mathcal{T},\\mathcal{D}]]\\big\\| \\leq 0.6~\\mathrm{s}^{-3}$,\n- $\\big\\|[\\mathcal{D},[\\mathcal{T},\\mathcal{D}]]\\big\\| \\leq 0.4~\\mathrm{s}^{-3}$.\n\nThe current time step is $\\Delta t = 0.02~\\mathrm{s}$. A step-rejection policy is applied based on a local error tolerance, where a step is rejected if a rigorous leading-order bound on the local error (in a dimensionless relative $\\infty$-norm of the state update) exceeds $\\tau = 5.0 \\times 10^{-4}$. The local error bound is to be obtained from first principles by expanding the split propagators relative to the exact propagator using the Baker–Campbell–Hausdorff (BCH) series and retaining the leading nonvanishing term appropriate to each splitting.\n\nStarting from the definition of the exact and split propagators and the BCH series, derive the leading-order local error bounds for both Lie–Trotter and Strang splitting in terms of $\\Delta t$ and the given commutator norm bounds. Then, evaluate the local error bound at $\\Delta t$ and at $2\\,\\Delta t$ for each method. Compute the multiplicative factor by which the local error bound changes when $\\Delta t$ is doubled for each method, and decide, under the stated policy, whether the doubled step should be rejected for each method.\n\nProvide your final answer as a single row matrix with four entries $(r_{\\mathrm{Lie}},\\, r_{\\mathrm{Str}},\\, I_{\\mathrm{Lie}},\\, I_{\\mathrm{Str}})$, where $r_{\\mathrm{Lie}}$ and $r_{\\mathrm{Str}}$ are the multiplicative factors by which the local error bound increases when $\\Delta t$ is doubled for Lie–Trotter and Strang splitting, respectively, and $I_{\\mathrm{Lie}}$ and $I_{\\mathrm{Str}}$ are indicator values equal to $1$ if the doubled step should be rejected and $0$ if it should be accepted. No rounding is required. The indicators are dimensionless; the intermediate analysis should treat the tolerance as dimensionless as stated.",
            "solution": "The problem requires the derivation and evaluation of local error bounds for Lie–Trotter and Strang operator splitting methods for a coupled transport–depletion system. The decision to accept or reject a doubled time step is then made based on these bounds.\n\nFirst, we establish the theoretical foundation for the error analysis. The state of the system evolves according to the equation $\\frac{d\\psi}{dt} = (\\mathcal{T}+\\mathcal{D})\\psi$, where $\\mathcal{T}$ is the transport operator and $\\mathcal{D}$ is the depletion operator. The exact solution over a time step of duration $\\Delta t$ is given by the propagator $E = \\exp(\\Delta t(\\mathcal{T}+\\mathcal{D}))$.\n\nThe operator splitting methods approximate this exact propagator.\nThe Lie–Trotter splitting propagator is $S_{\\mathrm{Lie}} = \\exp(\\Delta t\\,\\mathcal{T})\\,\\exp(\\Delta t\\,\\mathcal{D})$.\nThe Strang splitting propagator is $S_{\\mathrm{Str}} = \\exp(\\frac{\\Delta t}{2}\\mathcal{T})\\,\\exp(\\Delta t\\,\\mathcal{D})\\,\\exp(\\frac{\\Delta t}{2}\\mathcal{T})$.\n\nThe local error of these methods is determined by comparing them to the exact propagator. This comparison relies on the Baker–Campbell–Hausdorff (BCH) formula, which for two non-commuting operators $X$ and $Y$ states:\n$$ \\exp(X)\\exp(Y) = \\exp\\left(X+Y+\\frac{1}{2}[X,Y]+\\frac{1}{12}\\big([X,[X,Y]]-[Y,[X,Y]]\\big) + \\mathcal{O}(\\|X,Y\\|^3)\\right) $$\nwhere $[A,B] = AB-BA$ is the commutator.\n\n**Lie–Trotter Splitting Analysis**\n\nLet $X = \\Delta t\\,\\mathcal{T}$ and $Y = \\Delta t\\,\\mathcal{D}$. Applying the BCH formula to $S_{\\mathrm{Lie}}$ gives:\n$$ S_{\\mathrm{Lie}} = \\exp\\left(\\Delta t\\,\\mathcal{T} + \\Delta t\\,\\mathcal{D} + \\frac{1}{2}[\\Delta t\\,\\mathcal{T}, \\Delta t\\,\\mathcal{D}] + \\mathcal{O}((\\Delta t)^3)\\right) $$\n$$ S_{\\mathrm{Lie}} = \\exp\\left(\\Delta t(\\mathcal{T}+\\mathcal{D}) + \\frac{(\\Delta t)^2}{2}[\\mathcal{T},\\mathcal{D}] + \\mathcal{O}((\\Delta t)^3)\\right) $$\nThe local error operator, $\\mathcal{E}_{\\mathrm{Lie}} = S_{\\mathrm{Lie}} - E$, can be found by expanding the exponentials. Let $A = \\Delta t(\\mathcal{T}+\\mathcal{D})$ and $B = \\frac{(\\Delta t)^2}{2}[\\mathcal{T},\\mathcal{D}] + \\mathcal{O}((\\Delta t)^3)$.\nThen $\\mathcal{E}_{\\mathrm{Lie}} = \\exp(A+B) - \\exp(A)$. For small $B$, the leading term of this difference is $B$.\nThus, the leading-order local error operator for Lie–Trotter splitting is:\n$$ \\mathcal{E}_{\\mathrm{Lie}} \\approx \\frac{(\\Delta t)^2}{2}[\\mathcal{T},\\mathcal{D}] $$\nThis shows that the Lie–Trotter method is first-order accurate, with a local error of order $\\mathcal{O}((\\Delta t)^2)$. The problem asks for a rigorous local error bound, which we denote as $B_{\\mathrm{Lie}}$. We obtain this by taking the norm and using the provided commutator bound, $\\big\\|[\\mathcal{T},\\mathcal{D}]\\big\\| \\leq 2.0~\\mathrm{s}^{-2}$:\n$$ B_{\\mathrm{Lie}}(\\Delta t) = \\left\\| \\frac{(\\Delta t)^2}{2}[\\mathcal{T},\\mathcal{D}] \\right\\| \\leq \\frac{(\\Delta t)^2}{2}\\big\\|[\\mathcal{T},\\mathcal{D}]\\big\\| = \\frac{(\\Delta t)^2}{2}(2.0~\\mathrm{s}^{-2}) = (\\Delta t)^2 \\cdot (1.0~\\mathrm{s}^{-2}) $$\n\n**Strang Splitting Analysis**\n\nFor the symmetric Strang splitting, the local error is of order $\\mathcal{O}((\\Delta t)^3)$, making it a second-order method. A detailed expansion using the Baker–Campbell–Hausdorff formula shows the leading-order local error operator to be:\n$$ \\mathcal{E}_{\\mathrm{Str}} \\approx \\frac{(\\Delta t)^3}{12}[\\mathcal{D}, [\\mathcal{D},\\mathcal{T}]] + \\frac{(\\Delta t)^3}{24}[\\mathcal{T},[\\mathcal{T},\\mathcal{D}]] $$\nUsing the identity $[\\mathcal{D},[\\mathcal{D},\\mathcal{T}]] = -[\\mathcal{D},[\\mathcal{T},\\mathcal{D}]]$, we can combine these terms:\n$$ \\mathcal{E}_{\\mathrm{Str}} \\approx \\frac{(\\Delta t)^3}{24}\\left([\\mathcal{T},[\\mathcal{T},\\mathcal{D}]] - 2[\\mathcal{D},[\\mathcal{T},\\mathcal{D}]]\\right) $$\nTo find the local error bound $B_{\\mathrm{Str}}$, we take the norm and use the triangle inequality along with the given bounds $\\big\\|[\\mathcal{T},[\\mathcal{T},\\mathcal{D}]]\\big\\| \\leq 0.6~\\mathrm{s}^{-3}$ and $\\big\\|[\\mathcal{D},[\\mathcal{T},\\mathcal{D}]]\\big\\| \\leq 0.4~\\mathrm{s}^{-3}$:\n$$ B_{\\mathrm{Str}}(\\Delta t) = \\left\\| \\mathcal{E}_{\\mathrm{Str}} \\right\\| \\leq \\frac{(\\Delta t)^3}{24}\\left(\\big\\|[\\mathcal{T},[\\mathcal{T},\\mathcal{D}]]\\big\\| + 2\\big\\|[\\mathcal{D},[\\mathcal{T},\\mathcal{D}]]\\big\\|\\right) $$\n$$ B_{\\mathrm{Str}}(\\Delta t) = \\frac{(\\Delta t)^3}{24}\\left(0.6~\\mathrm{s}^{-3} + 2(0.4~\\mathrm{s}^{-3})\\right) = \\frac{(\\Delta t)^3}{24}(1.4~\\mathrm{s}^{-3}) = \\frac{7}{120}(\\Delta t)^3~\\mathrm{s}^{-3} $$\n\n**Numerical Evaluation and Decision**\n\nThe current time step is $\\Delta t = 0.02~\\mathrm{s}$, and the tolerance is $\\tau = 5.0 \\times 10^{-4}$.\n\nFor Lie–Trotter splitting:\nThe error bound is $B_{\\mathrm{Lie}}(\\Delta t) = (1.0) \\cdot (\\Delta t)^2$.\nAt $\\Delta t = 0.02~\\mathrm{s}$, the error bound is $B_{\\mathrm{Lie}}(0.02) = (1.0) \\cdot (0.02)^2 = 4.0 \\times 10^{-4}$.\nAt $2\\Delta t = 0.04~\\mathrm{s}$, the error bound is $B_{\\mathrm{Lie}}(0.04) = (1.0) \\cdot (0.04)^2 = 1.6 \\times 10^{-3}$.\nThe multiplicative factor by which the error bound increases when doubling the step is $r_{\\mathrm{Lie}} = \\frac{B_{\\mathrm{Lie}}(2\\Delta t)}{B_{\\mathrm{Lie}}(\\Delta t)} = \\frac{(2\\Delta t)^2}{(\\Delta t)^2} = 4$.\nTo decide on the doubled step, we compare its error bound to the tolerance: $B_{\\mathrm{Lie}}(0.04) = 1.6 \\times 10^{-3}$.\nSince $1.6 \\times 10^{-3} > 5.0 \\times 10^{-4}$, the step must be rejected. The indicator is $I_{\\mathrm{Lie}} = 1$.\n\nFor Strang splitting:\nThe error bound is $B_{\\mathrm{Str}}(\\Delta t) = \\frac{7}{120}(\\Delta t)^3$.\nAt $\\Delta t = 0.02~\\mathrm{s}$, the error bound is $B_{\\mathrm{Str}}(0.02) = \\frac{7}{120}(0.02)^3 = \\frac{7}{120}(8 \\times 10^{-6}) = \\frac{56}{120} \\times 10^{-6} = \\frac{7}{15} \\times 10^{-6} \\approx 4.67 \\times 10^{-7}$.\nAt $2\\Delta t = 0.04~\\mathrm{s}$, the error bound is $B_{\\mathrm{Str}}(0.04) = \\frac{7}{120}(0.04)^3 = \\frac{7}{120}(64 \\times 10^{-6}) = \\frac{448}{120} \\times 10^{-6} = \\frac{56}{15} \\times 10^{-6} \\approx 3.73 \\times 10^{-6}$.\nThe multiplicative factor is $r_{\\mathrm{Str}} = \\frac{B_{\\mathrm{Str}}(2\\Delta t)}{B_{\\mathrm{Str}}(\\Delta t)} = \\frac{(2\\Delta t)^3}{(\\Delta t)^3} = 8$.\nTo decide on the doubled step, we compare its error bound to the tolerance: $B_{\\mathrm{Str}}(0.04) = \\frac{56}{15} \\times 10^{-6}$.\nSince $\\frac{56}{15} \\times 10^{-6} \\approx 3.73 \\times 10^{-6}$ and $\\tau = 5.0 \\times 10^{-4} = 500 \\times 10^{-6}$, it is clear that $B_{\\mathrm{Str}}(0.04) < \\tau$. Therefore, the step is accepted. The indicator is $I_{\\mathrm{Str}} = 0$.\n\nThe final results are the multiplicative factors $r_{\\mathrm{Lie}}=4$ and $r_{\\mathrm{Str}}=8$, and the rejection indicators $I_{\\mathrm{Lie}}=1$ and $I_{\\mathrm{Str}}=0$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 4 & 8 & 1 & 0 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Theoretical error estimates are powerful, but their practical utility depends on their ability to predict real-world computational behavior. This final exercise bridges theory and practice by having you implement and test splitting methods on a physically-motivated model of nuclide depletion. You will use the difference between two splitting sequences as a computable surrogate for the local error, a common technique in adaptive solvers, and then verify the accuracy of this prediction against the true solution. This will provide direct insight into the validity of the leading-order error theory and its limitations as the time step $\\Delta t$ grows large.",
            "id": "4240057",
            "problem": "Consider a linearized transport–depletion coupling for nuclide number densities in nuclear reactor simulation. Let the state vector be the nuclide number density vector $y(t) \\in \\mathbb{R}^3$ with components $y_1(t)$ for Uranium-235, $y_2(t)$ for Uranium-238, and $y_3(t)$ for Xenon-135, all in units of $1/\\mathrm{cm}^3$. The coupled system is modeled as the ordinary differential equation (ODE) $y'(t) = (A + B) y(t)$, where $A$ represents non-transport depletion (e.g., radioactive decay) and $B$ represents effective transport-mediated neutron-induced reactions linearized around a steady neutron flux. The exact solution over a time step $\\Delta t$ is $y(\\Delta t) = \\exp(\\Delta t (A+B)) y(0)$, where $\\exp(\\cdot)$ denotes the matrix exponential.\n\nFor a physically plausible, constant-coefficient approximation at steady flux, use the following matrices (units of $A$ and $B$ are $\\mathrm{s}^{-1}$):\n$$\nA = \\begin{bmatrix}\n0 & 0 & 0\\\\\n0 & 0 & 0\\\\\n0 & 0 & -\\lambda_{\\mathrm{Xe}}\n\\end{bmatrix},\\quad\n\\lambda_{\\mathrm{Xe}} = 2.10\\times 10^{-5},\n$$\n$$\nB = \\begin{bmatrix}\n-k_{1} & 0 & 0\\\\\n0 & -k_{2} & 0\\\\\nf & 0 & -k_{3}\n\\end{bmatrix},\\quad\nk_1 = 5.85\\times 10^{-8},\\quad k_2 = 2.70\\times 10^{-10},\\quad k_3 = 3.00\\times 10^{-4},\\quad f = 1.755\\times 10^{-9}.\n$$\nThese values correspond to reasonable orders of magnitude obtained from steady flux and cross-section data: $k_1$ approximates a Uranium-235 fission rate per nucleus, $k_2$ approximates a Uranium-238 capture rate per nucleus, $k_3$ approximates a Xenon-135 neutron absorption rate per nucleus, and $f$ approximates the Xenon-135 production coupling from Uranium-235 fission yield.\n\nDefine two first-order operator-splitting orderings over a single step of size $\\Delta t$:\n1. Transport-then-depletion: $y_{\\mathrm{AB}}(\\Delta t) = \\exp(\\Delta t A)\\exp(\\Delta t B) y(0)$.\n2. Depletion-then-transport: $y_{\\mathrm{BA}}(\\Delta t) = \\exp(\\Delta t B)\\exp(\\Delta t A) y(0)$.\n\nLet the matrix commutator be defined by $[A,B] = AB - BA$. The goal is to estimate the local error of a split ordering by computing a surrogate for the commutator action on $y(0)$ from the two split orderings, and then verify this prediction against the observed difference from the exact solution. Specifically:\n- Compute $y_{\\mathrm{AB}}(\\Delta t)$ and $y_{\\mathrm{BA}}(\\Delta t)$ for the given $A$, $B$, and $y(0)$.\n- Use these two split orderings to construct a surrogate vector for $[A,B]y(0)$ via appropriate normalization based on dimensional analysis of the leading-order behavior in $\\Delta t$.\n- Use that surrogate to predict the leading-order local error of the transport-then-depletion ordering relative to the exact solution and compare it to the observed error $y_{\\mathrm{AB}}(\\Delta t) - \\exp(\\Delta t (A+B)) y(0)$ by computing the relative discrepancy, defined as the ratio of the Euclidean norm of the prediction error to the Euclidean norm of the observed error. The Euclidean norm here is over the density components and thus has unit $1/\\mathrm{cm}^3$, and the relative discrepancy is dimensionless.\n\nThe initial number densities are\n$$\ny(0) = \\begin{bmatrix}\n2.50\\times 10^{21}\\\\\n4.00\\times 10^{22}\\\\\n1.00\\times 10^{15}\n\\end{bmatrix}\\ \\mathrm{cm}^{-3}.\n$$\n\nTest suite (time steps in seconds):\n- Case $1$: $\\Delta t = 0.01$.\n- Case $2$: $\\Delta t = 10.0$.\n- Case $3$: $\\Delta t = 864000.0$ (ten days).\n\nFor each case, compute the relative discrepancy (dimensionless) and decide if the commutator-based prediction is acceptable using the criterion “relative discrepancy $\\leq 0.2$” as a boolean outcome. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases, where each element is the boolean outcome for that case (e.g., “$[{\\tt True},{\\tt False},{\\tt True}]$”). Angles do not appear in this problem. All physical quantities involving number densities must be kept in $1/\\mathrm{cm}^3$, time in $\\mathrm{s}$, and rates in $\\mathrm{s}^{-1}$. Percentages, if any, must be expressed as decimals.",
            "solution": "The problem requires an analysis of the local error of a first-order operator splitting method for solving the linear ODE system $y'(t) = (A+B)y(t)$.\n\nThe exact solution over a time step $\\Delta t$ is given by the action of the matrix exponential of the summed operator:\n$$y(\\Delta t) = \\exp(\\Delta t(A+B))y(0)$$\n\nOperator splitting methods approximate this by separating the actions of $A$ and $B$. The two first-order schemes given are:\n1.  $y_{\\text{AB}}(\\Delta t) = \\exp(\\Delta t A)\\exp(\\Delta t B) y(0)$ (transport-then-depletion)\n2.  $y_{\\text{BA}}(\\Delta t) = \\exp(\\Delta t B)\\exp(\\Delta t A) y(0)$ (depletion-then-transport)\n\nThe error in these methods arises because matrix exponentiation does not distribute over a sum unless the matrices commute, i.e., $[A,B] = AB - BA = 0$. In this problem, the matrices do not commute, so the splitting introduces an error.\n\nThe leading term of this local error can be found by expanding the matrix exponentials in a Taylor series for small $\\Delta t$.\nThe exact solution expands as:\n$$ \\exp(\\Delta t(A+B)) = I + \\Delta t(A+B) + \\frac{\\Delta t^2}{2}(A+B)^2 + O(\\Delta t^3) $$\n$$ = I + \\Delta t(A+B) + \\frac{\\Delta t^2}{2}(A^2 + AB+BA + B^2) + O(\\Delta t^3) $$\nThe transport-then-depletion split solution expands as:\n$$ \\exp(\\Delta t A)\\exp(\\Delta t B) = \\left(I+\\Delta t A + \\frac{\\Delta t^2}{2}A^2+...\\right)\\left(I+\\Delta t B + \\frac{\\Delta t^2}{2}B^2+...\\right) $$\n$$ = I + \\Delta t(A+B) + \\frac{\\Delta t^2}{2}(A^2 + 2AB + B^2) + O(\\Delta t^3) $$\nThe local error of the $y_{\\text{AB}}$ scheme, which we denote the \"observed error\" $v_o$, is the difference between the approximate and exact propagators acting on $y(0)$:\n$$ v_o = y_{\\text{AB}}(\\Delta t) - y(\\Delta t) = \\left(\\exp(\\Delta t A)\\exp(\\Delta t B) - \\exp(\\Delta t(A+B))\\right) y(0) $$\nTo leading order in $\\Delta t$, this is:\n$$ v_o \\approx \\left( \\frac{\\Delta t^2}{2}(A^2 + 2AB + B^2) - \\frac{\\Delta t^2}{2}(A^2 + AB+BA + B^2) \\right) y(0) $$\n$$ v_o \\approx \\frac{\\Delta t^2}{2}(AB - BA)y(0) = \\frac{\\Delta t^2}{2}[A,B]y(0) $$\n\nThe problem asks to construct a surrogate for the commutator term $[A,B]y(0)$ using the two split orderings, $y_{\\text{AB}}$ and $y_{\\text{BA}}$. We examine their difference:\n$$ y_{\\text{AB}}(\\Delta t) - y_{\\text{BA}}(\\Delta t) = (\\exp(\\Delta t A)\\exp(\\Delta t B) - \\exp(\\Delta t B)\\exp(\\Delta t A))y(0) $$\nExpanding this difference to leading order gives:\n$$ y_{\\text{AB}}(\\Delta t) - y_{\\text{BA}}(\\Delta t) \\approx \\left(\\frac{\\Delta t^2}{2}(2AB) - \\frac{\\Delta t^2}{2}(2BA)\\right)y(0) = \\Delta t^2[A,B]y(0) $$\nThis relation allows us to approximate the action of the commutator on the initial state vector using only the results of the two splitting schemes:\n$$ [A,B]y(0) \\approx \\frac{y_{\\text{AB}}(\\Delta t) - y_{\\text{BA}}(\\Delta t)}{\\Delta t^2} $$\nSubstituting this into our expression for the leading-order error of $y_{\\text{AB}}$, we obtain a prediction for the error vector, $v_p$:\n$$ v_p = \\frac{1}{2} (y_{\\text{AB}}(\\Delta t) - y_{\\text{BA}}(\\Delta t)) $$\n\nThe goal is to assess how well this prediction $v_p$ matches the true observed error $v_o$. We define the \"prediction error\" as the vector difference $E_{pred} = v_p - v_o$. The \"relative discrepancy\" is then the ratio of the Euclidean norms of the prediction error and the observed error:\n$$ D_r = \\frac{\\|E_{pred}\\|_2}{\\|v_o\\|_2} = \\frac{\\|v_p - v_o\\|_2}{\\|v_o\\|_2} $$\nFor small $\\Delta t$, the higher-order terms in the Taylor series are negligible, so we expect $v_p \\approx v_o$, leading to a small relative discrepancy. For large $\\Delta t$, the leading-order approximations break down, and we expect a large discrepancy. The criterion for an acceptable prediction is $D_r \\leq 0.2$.\n\nThe computational procedure for each value of $\\Delta t$ is as follows:\n1.  Define the matrices $A$, $B$, and the combined matrix $C = A+B$.\n2.  Define the initial state vector $y(0)$.\n3.  Compute the matrix exponentials $\\exp(\\Delta t A)$, $\\exp(\\Delta t B)$, and $\\exp(\\Delta t C)$.\n4.  Calculate the three propagated state vectors:\n    - $y_{\\text{AB}}(\\Delta t) = \\exp(\\Delta t A)\\exp(\\Delta t B) y(0)$\n    - $y_{\\text{BA}}(\\Delta t) = \\exp(\\Delta t B)\\exp(\\Delta t A) y(0)$\n    - $y(\\Delta t) = \\exp(\\Delta t C) y(0)$\n5.  Calculate the predicted error vector: $v_p = 0.5 \\times (y_{\\text{AB}}(\\Delta t) - y_{\\text{BA}}(\\Delta t))$.\n6.  Calculate the observed error vector: $v_o = y_{\\text{AB}}(\\Delta t) - y(\\Delta t)$.\n7.  Calculate the relative discrepancy $D_r = \\|v_p - v_o\\|_2 / \\|v_o\\|_2$.\n8.  Determine if $D_r \\leq 0.2$.\n\nThis procedure is repeated for all given time steps $\\Delta t$.",
            "answer": "```\n[True,True,False]\n```"
        }
    ]
}