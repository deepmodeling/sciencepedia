## 引言
在现代核反应堆工程领域，精确预测反应堆在整个寿期内的行为是设计、运行和安全评估的基石。其核心挑战在于处理一个复杂的动态反馈过程：反应堆内的中子场持续改变着材料的同位素组分（即“燃耗”），而变化的材料组分又反过来重塑了中子场。为了解决这一难题，发展出了“输运-[燃耗计算](@entry_id:1121947)循环”这一强大的[数值模拟](@entry_id:146043)框架。它将描述中子行为的物理学与描述材料演化的[核化学](@entry_id:141626)紧密耦合，构成了高保真反应堆模拟的心脏。

本文旨在系统性地剖析输运-[燃耗计算](@entry_id:1121947)循环的原理、实现及其在多学科交叉领域的关键应用。文章将通过三个层次递进的章节，带领读者全面掌握这一核心技术：
*   **第一章：原理与机制**，将深入探讨构成该循环的两大理论支柱——[中子输运方程](@entry_id:1128709)和[核素燃耗](@entry_id:1128926)方程，并阐明它们之间通过反应率和[截面](@entry_id:154995)反馈形成的耦合机制，以及常用的数值求解策略。
*   **第二章：应用与跨学科联系**，将展示该计算循环在反应堆设计、燃料管理、安全分析以及乏燃料处置等真实工程问题中的强大威力，并揭示其如何成为连接反应堆物理、热工水力与材料科学的桥梁。
*   **第三章：动手实践**，将通过一系列精心设计的问题，帮助读者将理论知识转化为实践技能，加深对通量归一化、[燃耗方程](@entry_id:1123563)刚性等关键概念的理解。

通过学习本文，读者将能够理解反应堆长期行为模拟的内在逻辑，为从事更高级的反应堆分析与设计工作奠定坚实的基础。

## 原理与机制

在核反应堆的模拟与分析中，耦合[中子输运](@entry_id:159564)与[核素燃耗](@entry_id:1128926)的计算是核心任务之一。反应堆在运行过程中，其材料成分会因中子诱发的核反应和放射性衰变而不断变化，这一过程被称为燃耗。同时，变化的材料成分反过来又会改变反应堆内的中子通量场，进而影响后续的[反应速率](@entry_id:185114)。这种中子物理与材料演化之间的双向耦合关系，必须通过一个迭代的计算循环来精确求解。本章将深入探讨构成这一输运-[燃耗计算](@entry_id:1121947)循环的基本原理、核心机制及其数值实现方法。

### 循环的两大支柱

输运-[燃耗计算](@entry_id:1121947)循环建立在两个核心的物理模型之上：描述中子在反应堆内行为的[中子输运方程](@entry_id:1128709)，以及描述核素密度随时间变化的[核素燃耗](@entry_id:1128926)方程。

#### [稳态](@entry_id:139253)中子输运方程

在[燃耗计算](@entry_id:1121947)的每一个时间步内，我们通常假设反应堆处于一种“准[稳态](@entry_id:139253)”，即中子通量场相对于核素成分的变化而言，能瞬时达到平衡。这种平衡状态由[稳态](@entry_id:139253)[中子输运方程](@entry_id:1128709)描述。对于一个给定的反应堆介质成分，我们求解[中子输运](@entry_id:159564)的 k-[本征值问题](@entry_id:142153)，以确定中子通量场的空间、能量和角度分布，以及反应堆的有效增殖因子 $k$。

该方程源于相空间中一个无穷小体积元内的中子平衡。方程等号左边代表中子的损失项，右边代表中子的源项。其连续能量、连续角度的积分-[微分形式](@entry_id:146747)如下 ：
$$
\mathbf{\Omega}\cdot\nabla \psi(\mathbf{r},E,\mathbf{\Omega}) + \Sigma_t(\mathbf{r},E)\,\psi(\mathbf{r},E,\mathbf{\Omega})
=
\int_{0}^{\infty}\int_{4\pi} \Sigma_s(\mathbf{r},E'\to E,\mathbf{\Omega}'\to\mathbf{\Omega})\,\psi(\mathbf{r},E',\\mathbf{\Omega}')\,\mathrm{d}\mathbf{\Omega}'\,\mathrm{d}E'
\;+\;
\frac{\chi(E)}{4\pi\,k}\int_{0}^{\infty} \nu(E')\,\Sigma_f(\mathbf{r},E')\,\phi(\mathbf{r},E')\,\mathrm{d}E'
$$
其中，各个项的物理意义为：
*   $\psi(\mathbf{r},E,\mathbf{\Omega})$ 是[角中子通量](@entry_id:1121012)密度，描述了在位置 $\mathbf{r}$、能量 $E$、运动方向为 $\mathbf{\Omega}$ 的单位立体角内的中子数量。
*   $\mathbf{\Omega}\cdot\nabla \psi$ 是 **流出项**，代表中子因运动而净流出该位置的速率。
*   $\Sigma_t(\mathbf{r},E)\,\psi$ 是 **碰撞损失项**，代表中子与原子核发生任何类型相互作用（散射或吸收）而从能量 $E$ 和方向 $\mathbf{\Omega}$ 移出的速率。$\Sigma_t$ 是宏观总截面。
*   第一个积分项是 **散射源项**，描述了从中子能量 $E'$ 和方向 $\mathbf{\Omega}'$ 经过散射进入能量 $E$ 和方向 $\mathbf{\Omega}$ 的速率。$\Sigma_s(\mathbf{r},E'\to E,\mathbf{\Omega}'\to\mathbf{\Omega})$ 是双[微分散射截面](@entry_id:1123684)。
*   第二个积分项是 **裂变源项**，描述了由核裂变产生的新中子。$\nu(E')$ 是每次裂变产生的平均中子数，$\Sigma_f(\mathbf{r},E')$ 是宏观裂变[截面](@entry_id:154995)，$\phi(\mathbf{r},E') = \int_{4\pi}\psi(\mathbf{r},E',\\mathbf{\Omega}')\,\mathrm{d}\mathbf{\Omega}'$ 是标量中子通量密度。裂变中子以特定的能量谱 $\chi(E)$ 释出，并通常假设在实验室坐标系下是各向同性的，因此有 $1/(4\pi)$ 因子。

本征值 $k$（即有效增殖因子）被引入到裂变源项中，以确保对于任意给定的非临界（次临界或超临界）系统，方程都存在一个数学上的非零[稳态解](@entry_id:200351)。$k$ 的物理意义是，为了使系统恰好达到[临界状态](@entry_id:160700)，每一代裂变产生的中子数需要被调整的因子。

这个[本征值方程](@entry_id:192306)是齐次的，其解的幅度（即通量的大小）是不确定的。在[燃耗计算](@entry_id:1121947)中，我们必须根据反应堆的实际运行功率 $P$ 来对通量进行归一化。这通过以下关系实现 ：
$$
\int_V\int_{0}^{\infty} \epsilon_f(E)\,\Sigma_f(\mathbf{r},E)\,\phi(\mathbf{r},E)\,\mathrm{d}E\,\mathrm{d}V = P
$$
其中 $\epsilon_f(E)$ 是每次裂变释放的可回收能量。经过归一化的通量场 $\phi(\mathbf{r},E)$ 才是驱动后续[燃耗计算](@entry_id:1121947)的物理量。

#### [核素燃耗](@entry_id:1128926)方程

[燃耗方程](@entry_id:1123563)描述了反应堆中各种核素的原子核数量密度 $\mathbf{N}(t)$ 如何随时间演化。这个演化过程由[放射性衰变](@entry_id:142155)和中子诱发的核反应（如[中子俘获](@entry_id:161038)、(n,2n)反应、裂变等）共同驱动。这一系列耦合的常微分方程（ODEs）通常被称为 **Bateman 方程**。

对于一个包含 $M$ 种核素的系统，我们可以将其写成矩阵形式 ：
$$
\frac{d\mathbf{N}}{dt} = \mathbf{A}(t)\,\mathbf{N}(t)
$$
其中 $\mathbf{N}(t)$ 是一个列向量，其分量 $N_i(t)$ 是第 $i$ 种核素的[数密度](@entry_id:895657)。$\mathbf{A}(t)$ 是 **[燃耗矩阵](@entry_id:1123564)**，其元素描述了所有核素之间由于衰变和中子反应而发生的转化。

[燃耗矩阵](@entry_id:1123564) $\mathbf{A}$ 的元素由以下物理过程决定：
*   **对角元素 $A_{ii}(t)$**：代表核素 $i$ 的 **总消耗速率系数**。它是一个负值，包括了[放射性衰变](@entry_id:142155)和所有中子诱发的破坏性反应。
    $$
    A_{ii}(t) = -\lambda_i - \sum_{r\in R_{\text{out}}(i)} \int_0^\infty \phi(E,t)\,\sigma_{r,i}(E)\,dE
    $$
    这里，$\lambda_i$ 是核素 $i$ 的[衰变常数](@entry_id:149530)。$R_{\text{out}}(i)$ 代表所有能使核素 $i$ 发生转化的中子反应（包括俘获、裂变等）的集合，$\sigma_{r,i}(E)$ 是相应的微观[截面](@entry_id:154995)。积分项代表了由中子通量 $\phi(E,t)$ 驱动的总反应率系数。

*   **非对角元素 $A_{ji}(t)$ ($j \neq i$)**：代表由核素 $i$ 生成核素 $j$ 的 **总产生速率系数**。它包括了从核素 $i$ 到核素 $j$ 的所有产生途径。
    $$
    A_{ji}(t) = \lambda_i b_{i\to j} + \sum_{r:\,i\to j} c_{r,i\to j}(t) + y_{j\leftarrow i}^{(f)}\,c_{f,i}(t)
    $$
    这里，第一项代表核素 $i$ 经[放射性衰变](@entry_id:142155)生成核素 $j$ 的贡献，其中 $b_{i\to j}$ 是分支比。第二项代表核素 $i$ 经中子诱发的非裂变反应（如中子俘获）直接转化为核素 $j$ 的贡献，$c_{r,i\to j}(t)$ 是相应的反应率系数。第三项代表核素 $j$ 作为核素 $i$ [裂变产物](@entry_id:1125033)的贡献，$y_{j\leftarrow i}^{(f)}$ 是[裂变产额](@entry_id:1125035)，$c_{f,i}(t)$ 是核素 $i$ 的裂变反应率系数 。

通过求解这个[线性常微分方程组](@entry_id:163837)，我们便可以从一个时间点的核素密度 $\mathbf{N}(t_n)$ 推算出下一个时间点的核素密度 $\mathbf{N}(t_{n+1})$。

### 耦合机制：反应率与[截面](@entry_id:154995)

[输运方程](@entry_id:174281)和[燃耗方程](@entry_id:1123563)通过反应率和宏观截面这两个关键量紧密地耦合在一起，形成了一个闭合的反馈循环。

#### 从通量到反应率

输运计算的直接输出——归一化后的中子通量 $\phi(\mathbf{r},E,t)$——是驱动燃耗过程的引擎。对于任意一种核素 $i$ 和任意一种中子反应 $x$，其反应率密度（单位体积、单位时间内的反应次数）可以表示为 ：
$$
R_{i,x}(\mathbf{r},t) = N_i(\mathbf{r},t) \int_0^\infty \sigma_{i,x}(E)\,\phi(\mathbf{r},E,t)\,dE
$$
这些微观反应率正是构建[燃耗矩阵](@entry_id:1123564) $\mathbf{A}$ 的基础。例如，核素 $i$ 的总消耗速率等于其数密度 $N_i$ 乘以所有破坏性反应的反应率系数之和。而核素 $j$ 的产生速率则来自于所有能产生它的母核素 $i$ 的相关反应率之和，并按产额加权。

在一些计算流程中，输运求解器可能会直接计算宏观反应率 $R_x(\mathbf{r}) = \int \Sigma_x(\mathbf{r},E)\phi(\mathbf{r},E)dE$。为了将其用于特定核素的[燃耗方程](@entry_id:1123563)，需要将其分解到每个核素的贡献上。这可以通过一个分配因子 $f_{i,x}$ 实现，它代表了反应 $x$ 发生在核素 $i$ 上的份额 。

#### 从成分到[截面](@entry_id:154995)：[反馈机制](@entry_id:269921)

耦合的另一方向是，[燃耗计算](@entry_id:1121947)的输出——更新后的核素[数密度](@entry_id:895657) $\mathbf{N}(\mathbf{r},t)$——反过来会改变下一次输运计算的输入参数。这种反馈主要通过[宏观截面](@entry_id:1127564) $\Sigma_x$ 体现：
$$
\Sigma_x(\mathbf{r},E,t) = \sum_i N_i(\mathbf{r},t)\,\sigma_{x,i}(E,T)
$$
这个简单的线性关系掩盖了其背后复杂的物理现象。[宏观截面](@entry_id:1127564)的变化不仅源于 $N_i$ 的变化，还受到温度和[中子能谱](@entry_id:1128692)自身变化的深刻影响 。

*   **多普勒展宽**：这是一个微观效应。燃料温度 $T_f$ 的升高会导致燃料原子核（如 $^{238}\mathrm{U}$）的热运动加剧。这使得微观[截面](@entry_id:154995) $\sigma_{x,i}(E,T)$ 在共振能量区域的[共振峰](@entry_id:271281)变低、变宽。虽然[共振峰](@entry_id:271281)下的面积几乎不变，但展宽的效应在光学厚的燃料元件中会增加总的[共振吸收](@entry_id:1130936)率。这是反应堆重要的[负温度](@entry_id:140023)[反馈机制](@entry_id:269921)之一 。

*   **[共振自屏效应](@entry_id:1130933)**：这是一个宏观的、与系统相关的效应。在[共振能量](@entry_id:147349)处，由于宏观总截面 $\Sigma_t$ 变得极大，该能量的中子在燃料元件内部的通量 $\phi(\mathbf{r},E,T)$ 会被急剧压低，因为它们在燃料表面附近就被大量吸收或散射了。这种通量压低现象就是[自屏效应](@entry_id:1131421)。在进行能群平均（即群常数凝聚）时，这种被压低的通量会降低[共振峰](@entry_id:271281)值处的权重，从而导致计算出的有效群平均[截面](@entry_id:154995) $\Sigma_{x,g}$ 远低于在假设通量平坦（无屏蔽）情况下得到的值 。

*   **[能谱](@entry_id:181780)[硬化](@entry_id:177483)/软化（Spectral Shift）**：随着燃耗的进行，燃料中可裂变核素（如 $^{235}\mathrm{U}$）的消耗和强[热中子](@entry_id:270226)吸收体（如 $^{135}\mathrm{Xe}$、$^{149}\mathrm{Sm}$ 等裂变产物）的累积，会改变整个反应堆的吸收和散射特性。例如，[热中子](@entry_id:270226)吸收的增加会使得中子能谱向更高能量区域移动，即 **[能谱](@entry_id:181780)硬化**。由于群平均[截面](@entry_id:154995)是使用中子能谱作为权重函数计算的，[能谱](@entry_id:181780)的任何变化都会直接导致群常数的改变。

    考虑一个简化的双能群（快群 F，热群 T）例子来说明能谱[硬化](@entry_id:177483)的影响。假设在燃耗初期（BOC），快、热群的通量份额分别为 $w_F=0.3$ 和 $w_T=0.7$。随着燃耗，强[热中子](@entry_id:270226)吸收体累积，导致能谱[硬化](@entry_id:177483)，通量份额变为 $w_F=0.5$ 和 $w_T=0.5$。对于一种在热群有很高[吸收截面](@entry_id:172609)的吸收体 A ($\sigma_{a,A}^T \gg \sigma_{a,A}^F$)，其[单群](@entry_id:140851)等效吸收截面 $\Sigma_{a,A}^{1g} = w_F \Sigma_{a,A}^F + w_T \Sigma_{a,A}^T$ 会随着能谱[硬化](@entry_id:177483)而显著减小，因为权重从高[截面](@entry_id:154995)区（热群）转移到了低[截面](@entry_id:154995)区（快群）。这直接导致该核素的总反应率降低 。

### 数值实现：计算循环

理论上，输运和燃耗是瞬时耦合的[非线性](@entry_id:637147)问题。但在数值实践中，我们采用 **算子分裂 (Operator Splitting)** 方法，将这个复杂的耦合[问题分解](@entry_id:272624)为一系列在时间步内交替求解的、相对简单的子问题。

#### [算子分裂](@entry_id:634210)方法与[预测-校正格式](@entry_id:637533)

一个典型的燃耗时间步从 $t_n$ 到 $t_{n+1} = t_n + \Delta t$ 的计算流程通常采用 **预测-校正 (Predictor-Corrector)** 格式，以提高计算精度并部分补偿算子分裂带来的误差  。

一个完整的[预测-校正循环](@entry_id:270742)步骤如下：
1.  **步初状态 (BOS) 计算**：
    *   使用 $t_n$ 时刻的核素密度 $\mathbf{N}^{(n)}$ 和温度场 $T^{(n)}$，进行[截面](@entry_id:154995)处理（包括共振自屏计算和群常数凝聚），得到步初的宏观截面 $\Sigma^{(n)}$。
    *   求解[稳态](@entry_id:139253)中子输运方程，得到步初的通量场 $\phi^{(n)}$，并将其归一化到指定功率 $P$。
    *   利用 $\phi^{(n)}$ 和 $\mathbf{N}^{(n)}$ 计算步初的反应率和[燃耗矩阵](@entry_id:1123564) $\mathbf{A}(\phi^{(n)})$。

2.  **预测步 (Predictor Step)**：
    *   假设在整个时间步 $\Delta t$ 内，[燃耗矩阵](@entry_id:1123564)保持为步初值 $\mathbf{A}(\phi^{(n)})$ 不变，求解[燃耗方程](@entry_id:1123563) $\frac{d\mathbf{N}}{dt} = \mathbf{A}(\phi^{(n)})\mathbf{N}(t)$，从 $\mathbf{N}^{(n)}$ 积分到 $t_{n+1}$，得到一个预测的步末核素密度 $\mathbf{N}^{\text{pred}}$。一个简单的方法是使用前向欧拉法：$\mathbf{N}^{\text{pred}} = \mathbf{N}^n + \Delta t\,\mathbf{A}(\phi^n)\,\mathbf{N}^n$ 。

3.  **步末状态 (EOS) 计算**：
    *   使用预测的步末核素密度 $\mathbf{N}^{\text{pred}}$ 和可能更新的温度场 $T^{\text{pred}}$，重新进行[截面](@entry_id:154995)处理，得到预测的步末[宏观截面](@entry_id:1127564) $\Sigma^{\text{pred}}$。
    *   再次[求解输运方程](@entry_id:1131949)，得到预测的步末通量场 $\phi^{\text{pred}}$ (同样归一化到功率 $P$)。
    *   计算预测的步末[燃耗矩阵](@entry_id:1123564) $\mathbf{A}(\phi^{\text{pred}})$。

4.  **校正步 (Corrector Step)**：
    *   使用一个更高阶的积分方法，结合步初和步末的信息来求解[燃耗方程](@entry_id:1123563)。例如，可以使用梯形法则，即使用步初和预测步末反应率的平均值：
        $$
        \mathbf{N}^{(n+1)} = \mathbf{N}^n + \frac{\Delta t}{2} \left( \mathbf{A}(\phi^n)\,\mathbf{N}^n + \mathbf{A}(\phi^{\text{pred}})\,\mathbf{N}^{\text{pred}} \right)
        $$
    *   这样得到的 $\mathbf{N}^{(n+1)}$ 是对步末核素密度的一个更准确的估计。

这个循环可以迭代进行，直到步末的核素密度收敛，从而达到所谓的 **[紧耦合](@entry_id:1133144) (Tight Coupling)**，以减小算子分裂误差。

#### 数值挑战与对策

*   **[燃耗方程](@entry_id:1123563)的刚性 (Stiffness)**：[燃耗方程](@entry_id:1123563)组是一个典型的 **[刚性系统](@entry_id:146021)**。这是因为系统中包含了寿命极短（如 $^{135}\mathrm{Xe}$，[半衰期](@entry_id:144843)约9小时）和寿命极长（如 $^{238}\mathrm{U}$，[半衰期](@entry_id:144843)达45亿年）的核素。这些特征时间尺度的巨大差异（可达 $10^9$ 倍或更高）导致[燃耗矩阵](@entry_id:1123564) $\mathbf{A}$ 的[本征值分布](@entry_id:194746)范围极广 。对于刚性系统，如果使用显式时间积分方法（如前向欧拉法），其稳定性将受到最快衰变模式（绝对值最大的本征值）的严格限制，迫使时间步长 $\Delta t$ 变得非常小，远小于描述慢变核素所需的时间步长，从而导致计算效率低下。因此，必须采用具有更好稳定性的数值方法，如 **[隐式积分](@entry_id:1126415)方法**（如后向欧拉法）或 **矩阵指数法**。
    *   A-稳定或L-稳定的[隐式方法](@entry_id:138537)（如后向欧拉）的稳定性区域覆盖了整个左半复平面，因此不受刚性问题的稳定性限制，可以选择仅由精度决定的更大的时间步长 。
    *   矩阵指数法，即直接计算解析解 $\mathbf{N}(t+\Delta t) = \exp(\mathbf{A}\Delta t)\mathbf{N}(t)$，完全绕开了时间积分的稳定性问题，是求解[常系数](@entry_id:269842)线性ODE的精确方法。其实际精度仅取决于在时间步 $\Delta t$ 内将[燃耗矩阵](@entry_id:1123564) $\mathbf{A}$ 视为常数的假设的有效性 。

*   **算子分裂误差与耦合方案**：将输运和燃耗算子分开求解会引入 **[分裂误差](@entry_id:755244)**。由于输运算子和燃耗算子通常不对易，一个简单的非对称分裂（如先输运后燃耗）会引入一个与时间步长 $\Delta t$ 成正比的一阶[全局误差](@entry_id:147874) 。为了控制这种误差，发展了不同的耦合策略 ：
    *   **松耦合 (Loose Coupling)** 或[单向耦合](@entry_id:752919)：在一个时间步内只进行一次输运计算和一次[燃耗计算](@entry_id:1121947)，如简单的预测步。这种方法计算成本低，但精度也较低，误差为 $\mathcal{O}(\Delta t)$。
    *   **紧耦合 (Tight Coupling)** 或迭代耦合：在一个时间步内，通过迭代交替求解输运和[燃耗方程](@entry_id:1123563)，直到通量、[截面](@entry_id:154995)和核素密度达到自洽。[预测-校正格式](@entry_id:637533)可以看作是[紧耦合](@entry_id:1133144)的一种简单形式。更复杂的[紧耦合](@entry_id:1133144)方案包括：
        *   **皮卡 (Picard) 迭代**：一种[不动点迭代法](@entry_id:168837)。将上一次迭代的通量和密度作为下一次迭代的输入，交替求解直至收敛。其[收敛速度](@entry_id:636873)通常是线性的。
        *   **牛顿 (Newton) 法**：将整个耦合系统（输运、燃耗、功率归一化）构建为一个大的[非线性](@entry_id:637147)残差方程 $\mathbf{R}(\mathbf{x}) = \mathbf{0}$，然后通过牛顿法求解。这需要计算和求解包含所有物理场之间耦合的[雅可比矩阵](@entry_id:178326)，但一旦收敛，通常具有二次收敛性，更为高效和鲁棒。

### 高级耦合：[热工水力反馈](@entry_id:1132979)

在真实的反应堆模拟中，输运-燃耗循环本身还必须与 **热工水力 (Thermal-Hydraulics, T/H)** 计算耦合。这是一个更高层次的[多物理场耦合](@entry_id:171389)问题，其核心是温度和密度反馈 。

耦合机制是双向的：
1.  **中子物理 $\rightarrow$ 热工水力**：输运计算得到的裂变率分布决定了燃料中的释热率 $q'''(z)$。这个热源驱动着热工水力方程，决定了燃料温度 $T_f(z)$、冷却剂温度 $T_m(z)$ 和冷却剂密度 $\rho_m(z)$ 的空间分布。
2.  **热工水力 $\rightarrow$ 中子物理**：热工水力计算得到的温度和密度场反过来影响中子[物理计算](@entry_id:1129641)的输入：
    *   **燃料温度 $T_f$** 通过多普勒展宽效应改变共振吸收[截面](@entry_id:154995)。
    *   **冷却剂温度 $T_m$** 改变慢化剂的热[中子散射](@entry_id:142835)律 $S(\alpha,\beta;T_m)$，影响中子的[热化](@entry_id:142388)过程。
    *   **冷却剂密度 $\rho_m$** 直接改变慢化剂和吸收剂（如硼酸）的原子核[数密度](@entry_id:895657)，从而显著影响宏观慢化和[吸收截面](@entry_id:172609)。

为了求解这个完全耦合的问题，通常在每个燃耗时间步内，嵌入一个求解中子-热工耦合的内迭代循环。其典型流程如下 ：
1.  使用上一次内迭代的温度/密度场 $(T_f^{(i)}, T_m^{(i)}, \rho_m^{(i)})$ 来更新所有与温度和密度相关的[截面](@entry_id:154995)数据。
2.  利用更新后的[截面](@entry_id:154995)，求解中子输运方程，得到新的通量分布 $\phi^{(i+1)}$。
3.  根据新的通量分布，计算新的功率分布 $q'''^{(i+1)}$。
4.  将新的功率分布作为热源，求解热工水力方程，得到新的温度/密度场 $(T_f^{(i+1)}, T_m^{(i+1)}, \rho_m^{(i+1)})$。
5.  检查新旧物理场之间的差异。如果差异大于容差，则返回第1步继续迭代；否则，认为中子物理和热工水力已达到自洽。
6.  使用收敛后的自洽物理场（通量、温度、密度）来执行该燃耗时间步的[燃耗计算](@entry_id:1121947)。

通过这样的多层次迭代框架，现代反应堆模拟程序能够精确地捕捉中子物理、[核素燃耗](@entry_id:1128926)和热工水力之间复杂的相互作用，从而对反应堆的[长期行为](@entry_id:192358)和安全特性做出可靠的预测。