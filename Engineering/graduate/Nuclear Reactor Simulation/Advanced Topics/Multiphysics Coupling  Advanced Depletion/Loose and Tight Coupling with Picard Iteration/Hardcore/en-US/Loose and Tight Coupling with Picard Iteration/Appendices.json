{
    "hands_on_practices": [
        {
            "introduction": "To begin our exploration of coupled physics simulations, we will start with a foundational example. This first practice demonstrates the core mechanics of a 'loose coupling' scheme using Picard iteration on a simplified, zero-dimensional reactor model . By stepping through a single iteration, you will gain hands-on experience in how transient neutronics and thermal feedback are solved sequentially, providing a clear illustration of the information lag inherent in this common numerical strategy.",
            "id": "4234044",
            "problem": "Consider a zero-dimensional coupled neutronics-thermal model for a homogeneous thermal reactor, where the neutron population is represented by point kinetics without delayed neutrons and the thermal state is represented by a single lumped temperature. The fundamental relations are:\n- Point kinetics (prompt-only): the reactor power $P(t)$ evolves according to\n$$\n\\frac{\\mathrm{d}P}{\\mathrm{d}t} \\;=\\; \\frac{\\rho(T)}{\\Lambda}\\,P,\n$$\nwhere $\\rho(T)$ is the reactivity and $\\Lambda$ is the prompt neutron generation time.\n- Thermal energy balance: the lumped fuel-coolant temperature $T(t)$ evolves according to\n$$\nC_{\\mathrm{th}}\\,\\frac{\\mathrm{d}T}{\\mathrm{d}t} \\;=\\; P \\;-\\; h\\,(T - T_{\\mathrm{cool}}),\n$$\nwhere $C_{\\mathrm{th}}$ is the effective heat capacity, $h$ is a linear heat removal coefficient, and $T_{\\mathrm{cool}}$ is the coolant reference temperature.\n- Neutronic thermal feedback is introduced via the temperature dependence of $k$-effective. Assume a linear temperature dependence\n$$\n\\frac{\\mathrm{d}k}{\\mathrm{d}T} \\;=\\; -\\beta_T,\\quad\\text{so that}\\quad k(T) \\;=\\; k_{\\mathrm{ref}} - \\beta_T\\,(T - T_{\\mathrm{ref}}),\n$$\nwith $k_{\\mathrm{ref}}=1$ at $T_{\\mathrm{ref}}$. The reactivity is defined by\n$$\n\\rho(T) \\;=\\; \\frac{k(T)-1}{k(T)}.\n$$\n\nYou are to perform a single Picard (fixed-point) update over one backward Euler time step $\\Delta t$, using a loose coupling strategy where the inter-physics coupling is lagged from the previous iterate. Specifically, at time level $t^n \\to t^{n+1}=t^n+\\Delta t$, starting from the initial guess\n$$\nP^{n+1,(0)} \\;=\\; P^n,\\qquad T^{n+1,(0)} \\;=\\; T^n,\n$$\ncompute one Picard update to obtain the pair $\\big(P^{n+1,(1)},\\,T^{n+1,(1)}\\big)$ by:\n1) Updating the power with backward Euler while lagging the temperature in the reactivity at the previous iterate $T^{n+1,(0)}$,\n2) Updating the temperature with backward Euler using the newly updated power $P^{n+1,(1)}$.\n\nUse the following physically consistent data:\n- Time step $\\Delta t = 0.1\\,\\mathrm{s}$,\n- Prompt neutron generation time $\\Lambda = 5.0\\times 10^{-5}\\,\\mathrm{s}$,\n- Temperature coefficient of $k$-effective $\\beta_T = 1.0\\times 10^{-5}\\,\\mathrm{K}^{-1}$,\n- Reference state $k_{\\mathrm{ref}}=1$ at $T_{\\mathrm{ref}}=600\\,\\mathrm{K}$,\n- Previous power $P^n = 100\\,\\mathrm{MW}$,\n- Previous temperature $T^n = 601\\,\\mathrm{K}$,\n- Heat capacity $C_{\\mathrm{th}} = 5.0\\times 10^{7}\\,\\mathrm{J/K}$,\n- Heat removal coefficient $h = 1.0\\times 10^{6}\\,\\mathrm{W/K}$,\n- Coolant reference temperature $T_{\\mathrm{cool}} = 600\\,\\mathrm{K}$.\n\nCarry out the single Picard update described and compute the updated pair $\\big(P^{n+1,(1)},\\,T^{n+1,(1)}\\big)$. Round your final numerical results to five significant figures. Express the power in megawatts (MW) and the temperature in kelvins (K). Provide the pair as a single ordered pair.",
            "solution": "The problem requires the computation of a single Picard update for a coupled neutronics-thermal hydraulics system over one time step, from $t^n$ to $t^{n+1} = t^n + \\Delta t$. The update is performed using the backward Euler method and a loose coupling scheme. The state of the system is described by the power $P(t)$ and temperature $T(t)$. We are given the state at time $t^n$ as $P^n$ and $T^n$, and we need to find the first Picard iterate $(P^{n+1,(1)}, T^{n+1,(1)})$ at time $t^{n+1}$.\n\nThe governing equations are:\nPoint kinetics (prompt-only):\n$$\n\\frac{\\mathrm{d}P}{\\mathrm{d}t} = \\frac{\\rho(T)}{\\Lambda} P\n$$\nThermal energy balance:\n$$\nC_{\\mathrm{th}}\\,\\frac{\\mathrm{d}T}{\\mathrm{d}t} = P - h\\,(T - T_{\\mathrm{cool}})\n$$\n\nThe initial guess for the Picard iteration at time $t^{n+1}$ is given as:\n$$\nP^{n+1,(0)} = P^n, \\qquad T^{n+1,(0)} = T^n\n$$\n\nThe problem specifies a two-step loose coupling procedure for the first Picard update:\n1. Update the power using backward Euler, with the temperature in the reactivity term lagged at the previous iterate, $T^{n+1,(0)}$.\n2. Update the temperature using backward Euler, with the power source term being the newly computed power from step 1, $P^{n+1,(1)}$.\n\nWe will work with all quantities in base SI units: power in Watts (W), temperature in Kelvin (K), time in seconds (s), etc.\n\nThe given data are:\n- Time step: $\\Delta t = 0.1\\,\\mathrm{s}$\n- Prompt neutron generation time: $\\Lambda = 5.0 \\times 10^{-5}\\,\\mathrm{s}$\n- Temperature coefficient of $k$-effective: $\\beta_T = 1.0 \\times 10^{-5}\\,\\mathrm{K}^{-1}$\n- Reference state: $k_{\\mathrm{ref}} = 1$ at $T_{\\mathrm{ref}} = 600\\,\\mathrm{K}$\n- State at $t^n$: $P^n = 100\\,\\mathrm{MW} = 1.0 \\times 10^8\\,\\mathrm{W}$, $T^n = 601\\,\\mathrm{K}$\n- Heat capacity: $C_{\\mathrm{th}} = 5.0 \\times 10^{7}\\,\\mathrm{J/K}$\n- Heat removal coefficient: $h = 1.0 \\times 10^{6}\\,\\mathrm{W/K}$\n- Coolant reference temperature: $T_{\\mathrm{cool}} = 600\\,\\mathrm{K}$\n\n### Step 1: Update Power to $P^{n+1,(1)}$\n\nThe backward Euler discretization of the point kinetics equation is:\n$$\n\\frac{P^{n+1} - P^n}{\\Delta t} = \\frac{\\rho(T^{n+1})}{\\Lambda} P^{n+1}\n$$\nFollowing the specified scheme, we compute the first iterate $P^{n+1,(1)}$ using the temperature from the zeroth iterate, $T^{n+1,(0)} = T^n$:\n$$\n\\frac{P^{n+1,(1)} - P^n}{\\Delta t} = \\frac{\\rho(T^{n+1,(0)})}{\\Lambda} P^{n+1,(1)} = \\frac{\\rho(T^n)}{\\Lambda} P^{n+1,(1)}\n$$\nWe rearrange this equation to solve for $P^{n+1,(1)}$:\n$$\nP^{n+1,(1)} - P^n = \\frac{\\Delta t \\, \\rho(T^n)}{\\Lambda} P^{n+1,(1)}\n$$\n$$\nP^{n+1,(1)} \\left(1 - \\frac{\\Delta t \\, \\rho(T^n)}{\\Lambda}\\right) = P^n\n$$\n$$\nP^{n+1,(1)} = \\frac{P^n}{1 - \\frac{\\Delta t \\, \\rho(T^n)}{\\Lambda}}\n$$\nFirst, we must calculate the reactivity $\\rho(T^n)$. The $k$-effective at $T^n$ is:\n$$\nk(T^n) = k_{\\mathrm{ref}} - \\beta_T(T^n - T_{\\mathrm{ref}}) = 1 - (1.0 \\times 10^{-5}\\,\\mathrm{K}^{-1}) (601\\,\\mathrm{K} - 600\\,\\mathrm{K}) = 1 - 1.0 \\times 10^{-5} = 0.99999\n$$\nThe reactivity is then:\n$$\n\\rho(T^n) = \\frac{k(T^n)-1}{k(T^n)} = \\frac{0.99999 - 1}{0.99999} = \\frac{-1.0 \\times 10^{-5}}{0.99999}\n$$\nNow, substitute the values into the expression for $P^{n+1,(1)}$:\n$$\nP^{n+1,(1)} = \\frac{1.0 \\times 10^8\\,\\mathrm{W}}{1 - \\frac{(0.1\\,\\mathrm{s}) (\\frac{-1.0 \\times 10^{-5}}{0.99999})}{5.0 \\times 10^{-5}\\,\\mathrm{s}}} = \\frac{1.0 \\times 10^8}{1 + \\frac{0.1}{5.0 \\times 0.99999}} = \\frac{1.0 \\times 10^8}{1 + \\frac{0.02}{0.99999}}\n$$\n$$\nP^{n+1,(1)} = \\frac{1.0 \\times 10^8}{\\frac{0.99999 + 0.02}{0.99999}} = (1.0 \\times 10^8) \\frac{0.99999}{1.01999} \\approx 98039211.84\\,\\mathrm{W}\n$$\n\n### Step 2: Update Temperature to $T^{n+1,(1)}$\n\nThe backward Euler discretization of the thermal energy balance equation is:\n$$\nC_{\\mathrm{th}}\\,\\frac{T^{n+1} - T^n}{\\Delta t} = P^{n+1} - h(T^{n+1} - T_{\\mathrm{cool}})\n$$\nAccording to the scheme, we use the newly computed power $P^{n+1,(1)}$ to solve for $T^{n+1,(1)}$:\n$$\nC_{\\mathrm{th}}\\,\\frac{T^{n+1,(1)} - T^n}{\\Delta t} = P^{n+1,(1)} - h(T^{n+1,(1)} - T_{\\mathrm{cool}})\n$$\nWe rearrange this equation to solve for $T^{n+1,(1)}$:\n$$\n\\frac{C_{\\mathrm{th}}}{\\Delta t} T^{n+1,(1)} - \\frac{C_{\\mathrm{th}}}{\\Delta t} T^n = P^{n+1,(1)} - h T^{n+1,(1)} + h T_{\\mathrm{cool}}\n$$\n$$\nT^{n+1,(1)} \\left(\\frac{C_{\\mathrm{th}}}{\\Delta t} + h\\right) = \\frac{C_{\\mathrm{th}}}{\\Delta t} T^n + P^{n+1,(1)} + h T_{\\mathrm{cool}}\n$$\n$$\nT^{n+1,(1)} = \\frac{\\frac{C_{\\mathrm{th}}}{\\Delta t} T^n + P^{n+1,(1)} + h T_{\\mathrm{cool}}}{\\frac{C_{\\mathrm{th}}}{\\Delta t} + h}\n$$\nNow, substitute the numerical values:\nThe denominator is:\n$$\n\\frac{C_{\\mathrm{th}}}{\\Delta t} + h = \\frac{5.0 \\times 10^7\\,\\mathrm{J/K}}{0.1\\,\\mathrm{s}} + 1.0 \\times 10^6\\,\\mathrm{W/K} = 5.0 \\times 10^8\\,\\mathrm{W/K} + 1.0 \\times 10^6\\,\\mathrm{W/K} = 5.01 \\times 10^8\\,\\mathrm{W/K}\n$$\nThe numerator is:\n$$\n\\left(\\frac{5.0 \\times 10^7}{0.1}\\right)(601) + 98039211.84 + (1.0 \\times 10^6)(600)\n$$\n$$\n= (5.0 \\times 10^8)(601) + 98039211.84 + 6.0 \\times 10^8\n$$\n$$\n= 3.005 \\times 10^{11} + 0.09803921184 \\times 10^9 + 0.6 \\times 10^9\n$$\n$$\n= 3.005 \\times 10^{11} + 9.803921184 \\times 10^7 + 6.0 \\times 10^8 = 3.005 \\times 10^{11} + 0.09803921184 \\times 10^9 + 0.6 \\times 10^9\n$$\nRe-evaluating the numerator:\n$$\n(5.0 \\times 10^8 \\times 601) + 98039211.84 + (1.0 \\times 10^6 \\times 600) = 3.005 \\times 10^{11} + 98039211.84 + 6 \\times 10^8\n$$\n$$\n= 3005 \\times 10^8 + 0.9803921184 \\times 10^8 + 6 \\times 10^8 = (3005 + 0.9803921184 + 6) \\times 10^8 = 3011.9803921184 \\times 10^8\n$$\n$$\n= 3.0119803921184 \\times 10^{11} \\ \\mathrm{W}\n$$\nNow, we compute $T^{n+1,(1)}$:\n$$\nT^{n+1,(1)} = \\frac{3.0119803921184 \\times 10^{11}\\,\\mathrm{W}}{5.01 \\times 10^8\\,\\mathrm{W/K}} \\approx 601.19369104\\,\\mathrm{K}\n$$\n\n### Final Results\n\nThe problem asks for the final numerical results to be rounded to five significant figures, with the power expressed in megawatts (MW).\n\nThe updated power is:\n$$\nP^{n+1,(1)} = 98039211.84\\,\\mathrm{W} = 98.03921184\\,\\mathrm{MW} \\approx 98.039\\,\\mathrm{MW}\n$$\nThe updated temperature is:\n$$\nT^{n+1,(1)} = 601.19369104\\,\\mathrm{K} \\approx 601.19\\,\\mathrm{K}\n$$\nThe resulting pair is $\\big(P^{n+1,(1)},\\,T^{n+1,(1)}\\big) = \\big(98.039\\,\\mathrm{MW},\\,601.19\\,\\mathrm{K}\\big)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 98.039  601.19 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Having established the basic iterative procedure, we now advance to a more realistic physics model common in reactor analysis. This problem explores the coupling between a two-group neutron diffusion model and temperature-dependent cross sections, a phenomenon known as Doppler feedback . You will linearize the system to compute the sensitivity of the neutron fluxes to temperature changes, a technique that demonstrates how the structure of the coupled system is fundamental to perturbation analysis.",
            "id": "4234018",
            "problem": "Consider a spatially uniform, infinite-medium, two-group neutron diffusion model for a subcritical system driven by external sources, with Doppler feedback acting only through temperature-dependent macroscopic absorption cross sections. In a loose coupling treatment with Picard iteration, cross sections are updated from the previous thermal state and the neutron balance is solved once per thermal update without forming a monolithic Jacobian. Assume a single Picard step in response to a uniform temperature perturbation about a reference temperature.\n\nThe steady-state multigroup neutron balance in an infinite medium (no leakage) for group $g \\in \\{1,2\\}$ is\n$$\n\\Sigma_{r,1}(T)\\,\\phi_{1} - \\Sigma_{s,2 \\rightarrow 1}\\,\\phi_{2} = q_{1}, \\qquad\n-\\Sigma_{s,1 \\rightarrow 2}\\,\\phi_{1} + \\Sigma_{r,2}(T)\\,\\phi_{2} = q_{2},\n$$\nwhere $\\phi_{g}$ is the group-$g$ scalar flux, $q_{g}$ is the isotropic external source to group $g$, $\\Sigma_{s,g \\rightarrow g'}$ are macroscopic scattering cross sections, and $\\Sigma_{r,g}(T) = \\Sigma_{a,g}(T) + \\Sigma_{s,g \\rightarrow \\text{out}}$ are macroscopic removal cross sections. The Doppler feedback is modeled by a linearization of the macroscopic absorption cross section about a reference temperature $T_{0}$:\n$$\n\\Sigma_{a,g}(T) = \\Sigma_{a,g}^{0} + \\beta_{g}\\,(T - T_{0}),\n$$\nwith temperature coefficients $\\beta_{g}$.\n\nGiven the numerical data\n$$\n\\Sigma_{a,1}^{0} = 0.05 \\text{ cm}^{-1}, \\quad \\Sigma_{a,2}^{0} = 0.10 \\text{ cm}^{-1}, \\quad\n\\Sigma_{s,1 \\rightarrow 2} = 0.20 \\text{ cm}^{-1}, \\quad \\Sigma_{s,2 \\rightarrow 1} = 0.01 \\text{ cm}^{-1},\n$$\n$$\n\\beta_{1} = 4.0 \\times 10^{-3} \\text{ cm}^{-1}\\text{K}^{-1}, \\quad \\beta_{2} = 5.0 \\times 10^{-4} \\text{ cm}^{-1}\\text{K}^{-1},\n$$\nand external sources\n$$\nq_{1} = 1.0, \\quad q_{2} = 0.5,\n$$\ncompute, using a single Picard step linearization about $T=T_{0}$, the sensitivity vector\n$$\n\\left( \\frac{\\partial \\phi_{1}}{\\partial T}, \\frac{\\partial \\phi_{2}}{\\partial T} \\right)\\bigg|_{T=T_{0}},\n$$\nin units of $\\text{(neutrons cm}^{-2}\\text{s}^{-1}\\text{) K}^{-1}$.\n\nRound each component to four significant figures. Express your final answer as a two-component row vector.",
            "solution": "The problem requires the computation of the sensitivity of the neutron flux vector with respect to temperature, evaluated at a reference state. The governing equations for the two-group, infinite-medium neutron diffusion model are given as:\n$$\n\\Sigma_{r,1}(T)\\,\\phi_{1} - \\Sigma_{s,2 \\rightarrow 1}\\,\\phi_{2} = q_{1}\n$$\n$$\n-\\Sigma_{s,1 \\rightarrow 2}\\,\\phi_{1} + \\Sigma_{r,2}(T)\\,\\phi_{2} = q_{2}\n$$\nThese equations can be written in matrix form as:\n$$\nM(T)\\,\\phi(T) = q\n$$\nwhere $\\phi(T) = \\begin{pmatrix} \\phi_1(T) \\\\ \\phi_2(T) \\end{pmatrix}$ is the neutron flux vector, $q = \\begin{pmatrix} q_1 \\\\ q_2 \\end{pmatrix}$ is the external source vector, and $M(T)$ is the system matrix:\n$$\nM(T) = \\begin{pmatrix} \\Sigma_{r,1}(T)  -\\Sigma_{s,2 \\rightarrow 1} \\\\ -\\Sigma_{s,1 \\rightarrow 2}  \\Sigma_{r,2}(T) \\end{pmatrix}\n$$\nThe temperature dependence is through the removal cross sections, $\\Sigma_{r,g}(T) = \\Sigma_{a,g}(T) + \\Sigma_{s,g \\rightarrow \\text{out}}$. Specifically, for the two-group model, $\\Sigma_{r,1}(T) = \\Sigma_{a,1}(T) + \\Sigma_{s,1 \\rightarrow 2}$ and $\\Sigma_{r,2}(T) = \\Sigma_{a,2}(T) + \\Sigma_{s,2 \\rightarrow 1}$. The absorption cross sections are linearized about a reference temperature $T_0$:\n$$\n\\Sigma_{a,g}(T) = \\Sigma_{a,g}^{0} + \\beta_{g}\\,(T - T_{0})\n$$\nThe source vector $q$ and the scattering cross sections $\\Sigma_{s,1 \\rightarrow 2}$ and $\\Sigma_{s,2 \\rightarrow 1}$ are independent of temperature.\n\nTo find the sensitivity vector $S = \\left( \\frac{\\partial \\phi_{1}}{\\partial T}, \\frac{\\partial \\phi_{2}}{\\partial T} \\right)\\bigg|_{T=T_{0}}$, we differentiate the matrix equation $M(T)\\,\\phi(T) = q$ with respect to $T$ using the product rule:\n$$\n\\frac{d}{dT} \\left[ M(T)\\,\\phi(T) \\right] = \\frac{d(q)}{dT}\n$$\n$$\n\\frac{dM(T)}{dT}\\,\\phi(T) + M(T)\\,\\frac{d\\phi(T)}{dT} = 0\n$$\nsince the source vector $q$ is constant. Evaluating this equation at the reference temperature $T=T_{0}$ gives:\n$$\n\\left(\\frac{dM}{dT}\\right)_{T=T_0} \\phi(T_0) + M(T_0) \\left(\\frac{d\\phi}{dT}\\right)_{T=T_0} = 0\n$$\nRearranging to solve for the sensitivity vector $S = \\left(\\frac{d\\phi}{dT}\\right)_{T=T_0}$, we get:\n$$\nM(T_0)\\,S = - \\left(\\frac{dM}{dT}\\right)_{T=T_0} \\phi(T_0)\n$$\nThe solution process involves three main steps:\n1.  Calculate the reference flux vector $\\phi(T_0)$ by solving the steady-state equation at $T=T_0$.\n2.  Determine the matrices $M(T_0)$ and $\\left(\\frac{dM}{dT}\\right)_{T=T_0}$.\n3.  Solve the resulting linear system for the sensitivity vector $S$.\n\nStep 1: Calculate the reference state $\\phi(T_0)$.\nAt $T=T_0$, the absorption cross sections are $\\Sigma_{a,g}(T_0) = \\Sigma_{a,g}^{0}$. The removal cross sections are:\n$$\n\\Sigma_{r,1}(T_0) = \\Sigma_{a,1}^{0} + \\Sigma_{s,1 \\rightarrow 2} = 0.05\\,\\text{cm}^{-1} + 0.20\\,\\text{cm}^{-1} = 0.25\\,\\text{cm}^{-1}\n$$\n$$\n\\Sigma_{r,2}(T_0) = \\Sigma_{a,2}^{0} + \\Sigma_{s,2 \\rightarrow 1} = 0.10\\,\\text{cm}^{-1} + 0.01\\,\\text{cm}^{-1} = 0.11\\,\\text{cm}^{-1}\n$$\nThe system matrix at $T_0$ is:\n$$\nM(T_0) = \\begin{pmatrix} 0.25  -0.01 \\\\ -0.20  0.11 \\end{pmatrix}\n$$\nThe source vector is $q = \\begin{pmatrix} 1.0 \\\\ 0.5 \\end{pmatrix}$. We solve the system $M(T_0)\\,\\phi(T_0) = q$:\n$$\n\\begin{pmatrix} 0.25  -0.01 \\\\ -0.20  0.11 \\end{pmatrix} \\begin{pmatrix} \\phi_{1}^0 \\\\ \\phi_{2}^0 \\end{pmatrix} = \\begin{pmatrix} 1.0 \\\\ 0.5 \\end{pmatrix}\n$$\nThe determinant of $M(T_0)$ is $\\det(M(T_0)) = (0.25)(0.11) - (-0.01)(-0.20) = 0.0275 - 0.002 = 0.0255$.\nUsing Cramer's rule or matrix inversion, we find $\\phi(T_0) = [M(T_0)]^{-1}q$:\n$$\n\\phi(T_0) = \\frac{1}{0.0255} \\begin{pmatrix} 0.11  0.01 \\\\ 0.20  0.25 \\end{pmatrix} \\begin{pmatrix} 1.0 \\\\ 0.5 \\end{pmatrix} = \\frac{1}{0.0255} \\begin{pmatrix} 0.11(1.0) + 0.01(0.5) \\\\ 0.20(1.0) + 0.25(0.5) \\end{pmatrix} = \\frac{1}{0.0255} \\begin{pmatrix} 0.115 \\\\ 0.325 \\end{pmatrix}\n$$\n$$\n\\phi_{1}^0 = \\frac{0.115}{0.0255} \\approx 4.50980392 \\quad \\text{and} \\quad \\phi_{2}^0 = \\frac{0.325}{0.0255} \\approx 12.74509804\n$$\n\nStep 2: Determine the derivative matrix $\\left(\\frac{dM}{dT}\\right)_{T=T_0}$.\nThe matrix $M(T)$ is:\n$$\nM(T) = \\begin{pmatrix} \\Sigma_{a,1}^{0} + \\Sigma_{s,1 \\rightarrow 2} + \\beta_{1}(T-T_0)  -\\Sigma_{s,2 \\rightarrow 1} \\\\ -\\Sigma_{s,1 \\rightarrow 2}  \\Sigma_{a,2}^{0} + \\Sigma_{s,2 \\rightarrow 1} + \\beta_{2}(T-T_0) \\end{pmatrix}\n$$\nDifferentiating with respect to $T$ yields a constant matrix:\n$$\n\\frac{dM}{dT} = \\begin{pmatrix} \\beta_{1}  0 \\\\ 0  \\beta_{2} \\end{pmatrix} = \\begin{pmatrix} 4.0 \\times 10^{-3}  0 \\\\ 0  5.0 \\times 10^{-4} \\end{pmatrix}\n$$\nThis matrix is independent of $T$, so its value at $T=T_0$ is the same.\n\nStep 3: Solve for the sensitivity vector $S$.\nWe first compute the right-hand side vector, $b = - \\left(\\frac{dM}{dT}\\right)_{T=T_0} \\phi(T_0)$:\n$$\nb = - \\begin{pmatrix} 4.0 \\times 10^{-3}  0 \\\\ 0  5.0 \\times 10^{-4} \\end{pmatrix} \\begin{pmatrix} 4.50980392 \\\\ 12.74509804 \\end{pmatrix} = - \\begin{pmatrix} 0.01803922 \\\\ 0.00637255 \\end{pmatrix}\n$$\nNow we solve the linear system $M(T_0)\\,S = b$ for $S = \\begin{pmatrix} S_1 \\\\ S_2 \\end{pmatrix}$:\n$$\n\\begin{pmatrix} 0.25  -0.01 \\\\ -0.20  0.11 \\end{pmatrix} \\begin{pmatrix} S_1 \\\\ S_2 \\end{pmatrix} = \\begin{pmatrix} -0.01803922 \\\\ -0.00637255 \\end{pmatrix}\n$$\nWe can solve this by using the inverse of $M(T_0)$ found earlier: $S = [M(T_0)]^{-1}b$.\n$$\nS = \\frac{1}{0.0255} \\begin{pmatrix} 0.11  0.01 \\\\ 0.20  0.25 \\end{pmatrix} \\begin{pmatrix} -0.01803922 \\\\ -0.00637255 \\end{pmatrix}\n$$\n$$\nS = \\frac{1}{0.0255} \\begin{pmatrix} 0.11(-0.01803922) + 0.01(-0.00637255) \\\\ 0.20(-0.01803922) + 0.25(-0.00637255) \\end{pmatrix}\n$$\n$$\nS = \\frac{1}{0.0255} \\begin{pmatrix} -0.00198431 - 0.00006373 \\\\ -0.00360784 - 0.00159314 \\end{pmatrix} = \\frac{1}{0.0255} \\begin{pmatrix} -0.00204804 \\\\ -0.00520098 \\end{pmatrix}\n$$\n$$\nS_1 = \\frac{-0.00204804}{0.0255} \\approx -0.0803153\n$$\n$$\nS_2 = \\frac{-0.00520098}{0.0255} \\approx -0.2039600\n$$\nThe problem asks for each component to be rounded to four significant figures.\n$$\n\\frac{\\partial \\phi_{1}}{\\partial T}\\bigg|_{T=T_{0}} \\approx -0.08032\n$$\n$$\n\\frac{\\partial \\phi_{2}}{\\partial T}\\bigg|_{T=T_{0}} \\approx -0.2040\n$$\nThe sensitivity vector is negative, which is physically expected, as an increase in temperature increases absorption (positive $\\beta$ values) and thus decreases the neutron flux. The final answer is presented as a two-component row vector.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.08032  -0.2040 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Our final practice shifts from executing iterations to analyzing their performance, a critical skill for practical applications. This problem introduces the concept of the contraction factor, which governs the convergence speed of a Picard iteration . By estimating this factor from a series of iterates, you will learn how to diagnose convergence behavior and make informed decisions about using relaxation parameters to improve simulation efficiency.",
            "id": "4234057",
            "problem": "In a steady-state single pin-cell model of a pressurized water reactor, the neutron diffusion and heat conduction equations are coupled through Doppler feedback. A loose coupling strategy based on Picard fixed-point iteration with under-relaxation is used: starting from an initial volume-averaged fuel temperature iterate $T^{(0)}$, the neutronics subproblem is solved using $T^{(n)}$ to obtain a power distribution, the heat conduction subproblem is then solved to obtain an updated temperature field, and a relaxed update $T^{(n+1)} = (1-\\omega)\\,T^{(n)} + \\omega\\,\\mathcal{G}(T^{(n)})$ is formed for the next Picard iterate, where $\\omega \\in (0,1]$ is the relaxation parameter and $\\mathcal{G}$ denotes the composition of the physics maps. For a given choice of $\\omega$, three successive Picard iterates of the volume-averaged fuel temperature have been recorded as $T^{(0)} = 900\\,\\mathrm{K}$, $T^{(1)} = 940\\,\\mathrm{K}$, and $T^{(2)} = 956\\,\\mathrm{K}$.\n\nStarting from the definition of a fixed point and the linearization of a differentiable fixed-point map near its fixed point, derive a finite-difference estimator for the local contraction factor of the relaxed map using three successive iterates, and then evaluate it from the data above. In your reasoning, interpret how the magnitude of the estimated contraction factor informs the choice between increasing or decreasing the relaxation parameter $\\omega$ in the loose coupling, with reference to the robustness of Picard iteration versus tight (monolithic) coupling strategies. Report only the estimated contraction factor as your final answer. Round your final answer to four significant figures. Express the contraction factor as a dimensionless number.",
            "solution": "The problem requires the derivation of a finite-difference estimator for the local contraction factor of a relaxed Picard iteration, its evaluation using provided data from a nuclear reactor simulation, and an interpretation of the result in the context of numerical coupling strategies.\n\nFirst, we formalize the iterative process. The relaxed Picard iteration is given by the update rule:\n$$T^{(n+1)} = (1-\\omega)\\,T^{(n)} + \\omega\\,\\mathcal{G}(T^{(n)})$$\nwhere $T^{(n)}$ is the volume-averaged fuel temperature at iterate $n$, $\\omega \\in (0,1]$ is the under-relaxation parameter, and $\\mathcal{G}$ represents the mapping from temperature to a new temperature obtained by solving the neutronics and heat conduction subproblems sequentially.\n\nLet us define the relaxed fixed-point map $\\mathcal{H}(T)$ as:\n$$\\mathcal{H}(T) = (1-\\omega)T + \\omega\\mathcal{G}(T)$$\nThe iteration can then be written as $T^{(n+1)} = \\mathcal{H}(T^{(n)})$. A fixed point $T^*$ of this iteration satisfies the condition $T^* = \\mathcal{H}(T^*)$. Convergence of the iteration to the fixed point is governed by the local contraction factor, which is defined as the magnitude of the derivative of the map $\\mathcal{H}$ evaluated at the fixed point, $\\lambda = |\\mathcal{H}'(T^*)|$. For the iteration to converge, we require $\\lambda  1$.\n\nTo derive an estimator for the contraction factor from successive iterates, we consider the behavior of the error, $e^{(n)} = T^{(n)} - T^*$, near the fixed point. Using a a first-order Taylor series expansion of $\\mathcal{H}(T^{(n)})$ around $T^*$:\n$$T^{(n+1)} = \\mathcal{H}(T^{(n)}) = \\mathcal{H}(T^* + e^{(n)}) \\approx \\mathcal{H}(T^*) + \\mathcal{H}'(T^*) e^{(n)}$$\nSince $T^* = \\mathcal{H}(T^*)$, this simplifies to:\n$$T^{(n+1)} \\approx T^* + \\mathcal{H}'(T^*) e^{(n)}$$\n$$T^{(n+1)} - T^* \\approx \\mathcal{H}'(T^*)(T^{(n)} - T^*)$$\nThis shows that the error at a given step is approximately proportional to the error at the previous step, with the constant of proportionality being the derivative $\\mathcal{H}'(T^*)$. Let us denote this derivative, which we aim to estimate, as $k \\approx \\mathcal{H}'(T^*)$. The relationship is $e^{(n+1)} \\approx k \\, e^{(n)}$. This indicates linear convergence.\n\nWe have a set of three successive iterates, $T^{(0)}$, $T^{(1)}$, and $T^{(2)}$. We can write the error relationships for these steps:\n$$T^{(2)} - T^* \\approx k(T^{(1)} - T^*)$$\n$$T^{(1)} - T^* \\approx k(T^{(0)} - T^*)$$\nThe fixed point $T^*$ is unknown. To eliminate it, we can examine the differences between successive iterates, $\\Delta^{(n)} = T^{(n+1)} - T^{(n)}$.\n$$\\Delta^{(1)} = T^{(2)} - T^{(1)} = (T^{(2)} - T^*) - (T^{(1)} - T^*) \\approx k(T^{(1)} - T^*) - (T^{(1)} - T^*) = (k-1)(T^{(1)} - T^*)$$\nSimilarly, for the previous step:\n$$\\Delta^{(0)} = T^{(1)} - T^{(0)} = (T^{(1)} - T^*) - (T^{(0)} - T^*) \\approx k(T^{(0)} - T^*) - (T^{(0)} - T^*) = (k-1)(T^{(0)} - T^*)$$\nNow, we take the ratio of these two differences:\n$$\\frac{\\Delta^{(1)}}{\\Delta^{(0)}} = \\frac{T^{(2)} - T^{(1)}}{T^{(1)} - T^{(0)}} \\approx \\frac{(k-1)(T^{(1)} - T^*)}{(k-1)(T^{(0)} - T^*)} = \\frac{T^{(1)} - T^*}{T^{(0)} - T^*} \\approx k$$\nThis provides a finite-difference estimator for the local convergence factor $k$ using three successive iterates:\n$$k \\approx \\frac{T^{(2)} - T^{(1)}}{T^{(1)} - T^{(0)}}$$\n\nNext, we evaluate this estimator using the data provided:\n$T^{(0)} = 900\\,\\mathrm{K}$\n$T^{(1)} = 940\\,\\mathrm{K}$\n$T^{(2)} = 956\\,\\mathrm{K}$\n\nThe differences are:\n$$T^{(1)} - T^{(0)} = 940\\,\\mathrm{K} - 900\\,\\mathrm{K} = 40\\,\\mathrm{K}$$\n$$T^{(2)} - T^{(1)} = 956\\,\\mathrm{K} - 940\\,\\mathrm{K} = 16\\,\\mathrm{K}$$\n\nSubstituting these into the estimator formula:\n$$k \\approx \\frac{16\\,\\mathrm{K}}{40\\,\\mathrm{K}} = \\frac{16}{40} = \\frac{2}{5} = 0.4$$\nThe estimated local contraction factor is approximately $0.4$. As required, this is a dimensionless number.\n\nFinally, we interpret this result. The magnitude of the contraction factor is $|k| \\approx 0.4$, which is less than $1$. This indicates that the Picard iteration is converging. Since $k$ is positive, the convergence is monotonic; the iterates are approaching the fixed point from one side without oscillating. Given that $T^{(0)}  T^{(1)}  T^{(2)}$, the iterates are monotonically increasing towards the fixed point $T^*$.\n\nThe contraction factor of the relaxed map is $k = \\mathcal{H}'(T) = 1 - \\omega + \\omega \\mathcal{G}'(T)$. Let $J = \\mathcal{G}'(T)$ be the derivative (or Jacobian in a multi-dimensional case) of the unrelaxed map. In a PWR, the dominant Doppler feedback mechanism is negative: an increase in fuel temperature broadens neutron absorption resonances in materials like $^{238}\\mathrm{U}$, which increases neutron capture, reduces reactivity, and thus lowers the fission power. Lower power leads to a lower temperature. Therefore, the map $\\mathcal{G}$ is a decreasing function of temperature, and its derivative $J$ must be negative, $J  0$.\n\nSo, the contraction factor is $k = 1 - \\omega + \\omega J = 1 - \\omega(1 - J) = 1 - \\omega(1 + |J|)$. We have estimated $k \\approx 0.4$.\n$$0.4 \\approx 1 - \\omega(1+|J|)$$\nThe goal of relaxation is to accelerate convergence, which means choosing $\\omega$ to make $|k|$ as close to $0$ as possible. The optimal value, $k_{opt} = 0$, is achieved for a relaxation parameter $\\omega_{opt}$ such that $1 - \\omega_{opt}(1 + |J|) = 0$, which gives $\\omega_{opt} = \\frac{1}{1+|J|}$.\nOur current estimate is $k \\approx 0.4  0$. The function $k(\\omega) = 1 - \\omega(1 + |J|)$ is a strictly decreasing function of $\\omega$ (since $1+|J|0$). To reduce the value of $k$ from $0.4$ towards $0$, one must *increase* the relaxation parameter $\\omega$. Increasing $\\omega$ would move the scheme from under-relaxation towards no relaxation ($\\omega=1$). It is even possible that the optimal $\\omega$ is greater than $1$ (over-relaxation).\n\nThe fact that the estimated contraction factor is $0.4$ indicates that the loose coupling strategy (Picard iteration) is quite effective for this problem. The physical coupling is not excessively strong. If $|k|$ were close to or greater than $1$, the slow convergence or divergence would argue for a more robust but complex tight coupling strategy (like a Newton-Raphson method) that solves the coupled system monolithically. Here, the loose coupling is robust, and its performance can be further enhanced by tuning the relaxation parameter $\\omega$ upwards.\n\nThe final computed value for the estimator, rounded to four significant figures, is $0.4000$.",
            "answer": "$$\\boxed{0.4000}$$"
        }
    ]
}