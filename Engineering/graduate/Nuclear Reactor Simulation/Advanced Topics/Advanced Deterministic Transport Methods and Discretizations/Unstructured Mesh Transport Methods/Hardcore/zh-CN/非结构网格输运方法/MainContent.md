## 引言
在现代核反应堆的设计与安全分析中，对中子行为进行精确、高保真的模拟至关重要。传统的计算方法，如基于[结构化网格](@entry_id:755573)的程序或简化的[中子扩散理论](@entry_id:160104)，在处理复杂几何形状或物理现象（如强[各向异性散射](@entry_id:148372)）时往往力不从心。非结构网格输运方法应运而生，它通过直接求解更为基础的线性[玻尔兹曼方程](@entry_id:138866)，并结合任意[多面体](@entry_id:637910)网格的几何灵活性，为解决这些挑战提供了强有力的工具。本文旨在系统性地介绍这一先进计算领域的核心知识，填补了从基础理论到高级应用之间的认知鸿沟。

为实现这一目标，本文分为三个循序渐进的部分。在**“原理与机制”**一章中，我们将从第一性原理出发，剖析线性玻尔兹曼方程的结构，并深入探讨将其在角度和空间维度上离散化的关键策略，如离散纵标法($S_N$)和间断伽辽金(DG)法。您将理解局部守恒、因果性以及迎风格式等核心概念如何共同构筑一个稳定且精确的数值格式。接下来，在**“应用与交叉学科联系”**一章中，我们将视野从单个单元的离散化扩展到整个系统的求解。文章将讨论如何构建和求解大规模线性系统，介绍[源迭代](@entry_id:1131994)、[扩散综合加速](@entry_id:1123717)(DSA)等关键算法，并探讨如何在[高性能计算](@entry_id:169980)平台上实现并行输运扫描。此外，本章还将揭示输运方法如何作为核心引擎，与[热工水力学](@entry_id:1133002)、材料科学等领域进行[多物理场](@entry_id:164478)和多尺度耦合。最后，**“动手实践”**部分提供了一系列精心设计的问题，旨在通过编码实践，将理论知识转化为解决实际计算问题的能力。通过这一系列的学习，读者将能够全面掌握非结构网格输运方法的精髓。

## 原理与机制

本章在前一章介绍中子输运理论背景的基础上，深入探讨在非结构网格上求解线性玻尔兹曼方程的核心原理和关键机制。我们将从控制方程的结构出发，系统地剖析角度和[空间离散化](@entry_id:172158)的基本策略，进而阐述数值方法的构建、因果性的强制执行以及求解过程中的高级挑战，例如保证解的物理实在性。

### 线性玻尔兹曼方程：基本构成

中子在介质中的行为由[线性玻尔兹曼输运方程](@entry_id:1127271)描述。对于[稳态](@entry_id:139253)问题，该方程是一个关于位置、能量和运动方向的积分-[微分](@entry_id:158422)方程。其核心是描述粒子在相空间中守恒的平衡关系。方程的典型形式可以分解为几个关键部分：

$$
\underbrace{\boldsymbol{\Omega}\cdot\nabla \psi(\mathbf{r},\boldsymbol{\Omega},E)}_{\text{流串项}} + \underbrace{\Sigma_t(\mathbf{r},E)\psi(\mathbf{r},\boldsymbol{\Omega},E)}_{\text{碰撞项}} = \underbrace{\int_{4\pi}\int_0^\infty \Sigma_s(\mathbf{r},E'\to E,\boldsymbol{\Omega}'\to \boldsymbol{\Omega})\psi(\mathbf{r},\boldsymbol{\Omega}',E')\,dE'\,d\boldsymbol{\Omega}'}_{\text{散射源项}} + \underbrace{q(\mathbf{r},\boldsymbol{\Omega},E)}_{\text{外源项}}
$$

- **流串项 (Streaming Term)**, $\boldsymbol{\Omega}\cdot\nabla \psi$，描述了粒子沿方向 $\boldsymbol{\Omega}$ 的自由飞行。这是一个一阶双曲型算子，体现了[输运过程](@entry_id:177992)的方向性和传播特性。
- **碰撞项 (Collision Term)**, $\Sigma_t\psi$，代表了粒子因与介质原子核发生任何类型的相互作用（吸收或散射）而从相空间点 $(\mathbf{r}, \boldsymbol{\Omega}, E)$ 移出的速率。$\Sigma_t$ 是宏观[总截面](@entry_id:151809)。
- **散射源项 (Scattering Source Term)** 是一个积分项，描述了从所有其他方向 $\boldsymbol{\Omega}'$ 和能量 $E'$ 经过散射过程后，进入当前相空间点 $(\mathbf{r}, \boldsymbol{\Omega}, E)$ 的粒子速率。$\Sigma_s$ 是宏观双[微分散射截面](@entry_id:1123684)。
- **外源项 (External Source Term)**, $q$，代表了独立于角通量 $\psi$ 的粒子源，例如来自核反应或设定的外部源。

与此相对，**[中子扩散理论](@entry_id:160104)**是输运理论的一种低阶近似。它通过对[输运方程](@entry_id:174281)取角度矩，并引入一个封闭关系（如[菲克定律](@entry_id:155177)，$ \mathbf{J} = -D\nabla\phi $）来消除对角度变量的显式依赖。在这个近似下，具有方向性的流串项 $\boldsymbol{\Omega}\cdot\nabla \psi$ 被替换为与标通量 $\phi$ 梯度相关的泄漏项 $-\nabla\cdot\mathbf{J}$。各向异性的散射源也被其各向同性部分（零阶矩）所取代，而散射的各向异性效应则被间接地包含在扩散系数 $D$ 和[输运截面](@entry_id:1133392) $\Sigma_{tr}$ 中。这种简化使得扩散方程在计算上远比[输运方程](@entry_id:174281)简单，但也牺牲了对高度各向异性通量分布的精确描述能力，尤其是在界面、强吸收区或近真空区域 。

### 离散化策略：分解复杂性

直接求解连续的[玻尔兹曼方程](@entry_id:138866)极其困难，因此数值方法的核心在于对其[自变量](@entry_id:267118)——角度、空间和能量——进行离散化。

#### 角度离散化

角度变量 $\boldsymbol{\Omega}$ 定义在[单位球](@entry_id:142558)面上，对其进行离散化主要有两种途径：

- **[离散纵标法](@entry_id:1123828) ($S_N$ 方法)**：这是求解输运问题最流行的方法之一。它用一个精心选择的**[求积组](@entry_id:156430) (quadrature set)**，即一组离散方向 $\{\boldsymbol{\Omega}_m\}$ 和对应的权重 $\{w_m\}$，来近似角度空间上的积分。这样，连续的角度变量被有限个离散方向取代，原始的积分-[微分](@entry_id:158422)方程转化为一个关于各个离散[方向角](@entry_id:167868)通量 $\psi_m(\mathbf{r}, E) \approx \psi(\mathbf{r}, \boldsymbol{\Omega}_m, E)$ 的[耦合偏微分方程组](@entry_id:198181)。$S_N$ 方法的优势在于其直观性和处理复杂几何的能力。然而，由于角度空间的离散化，它可能在低散射或真空区域引入非物理的**射线效应 (ray effects)**，即通量分布会沿着离散方向呈现出虚假的条纹 。

- **[球谐函数法](@entry_id:1132122) ($P_N$ 方法)**：该方法采用谱方法的思想，将角通量 $\psi$ 展开为球谐函数 $Y_{lk}(\boldsymbol{\Omega})$ 的级数，并在 $N$ 阶截断。求解的对象不再是方向上的通量，而是空间依赖的**矩函数 (moment functions)** $\psi_{lk}(\mathbf{r}, E)$。通过将此展开代入[输运方程](@entry_id:174281)并对基函数做投影，得到一个关于矩函数的[耦合偏微分方程组](@entry_id:198181)。$P_N$ 方法的基函数是全局光滑的，因此其解天然具有**[旋转不变性](@entry_id:137644)**，完全避免了射线效应。但其主要缺点是，当用有限阶[光滑函数](@entry_id:267124)级数去拟合具有尖锐角度不连续（如束源或阴影边界）的真实通量时，会产生**[吉布斯振荡](@entry_id:749902) (Gibbs-like oscillations)**，可能导致非物理的负通量值  。

在[反应堆物理](@entry_id:158170)的许多应用中，尤其是在非结构网格上，$S_N$ 方法因其灵活性和鲁棒性而被广泛采用。因此，本章后续的讨论将主要围绕 $S_N$ 框架展开。

#### [空间离散化](@entry_id:172158)

在选定 $S_N$ 方法进行角度离散化后，我们得到了一组针对每个离散方向 $\boldsymbol{\Omega}_m$ 的方程。下一步是在代表反应堆几何的非结构网格上对这些方程进[行空间](@entry_id:148831)离散。一个核心思想是将求解域分解为许多不重叠的控制体（或**单元 (cell)**），并在每个单元上近似求解。

### [空间离散化](@entry_id:172158)的基本构件

在非结构网格上构建一个有效的数值格式，需要精确的几何信息和坚实的物理原理作为基础。

#### 几何与拓扑要求

为了在任意[多面体](@entry_id:637910)单元上精确计算[通量平衡](@entry_id:637776)，数值格式必须依赖于网格提供的一套完备的几何与拓扑信息 。一个最小完备集包括：
- **对于每个单元 $c$**：其体积 $|V_c|$，用于计算单元内的总碰撞移除和源项。
- **对于单元 $c$ 的每个面 $f$**：其面积 $|A_f|$ 和一个指向单元外部的**[单位法向量](@entry_id:178851) $\mathbf{n}_f$**。这两个量是计算[粒子流](@entry_id:753205)过该面的通量的关键。[法向量](@entry_id:264185)方向的统一约定对于区分流入和流出至关重要。
- **拓扑连接关系**：包括单元-邻居关系（即对于单元 $c$ 的一个面 $f$，与之共享该面的邻居单元是谁）和定义每个多边形面的顶点-面关系（如按顺序排列的顶点坐标列表）。邻居关系是实现**上游格式 (upwinding)** 的基础，而顶点信息则允许我们精确计算任意形状面的面积、[法向量](@entry_id:264185)和[质心](@entry_id:138352)，并为高阶方法提供必要的几何矩。

#### 局部守恒原理

一个高质量的数值格式应能精确地保持物理守恒律。在粒子输运中，这意味着粒子数目的守恒。

- **局部粒子守恒 (Local Particle Conservation)**：指在每个网格单元 $K$ 内部，粒子的产生率等于其消失率。通过在单元 $K$ 上对[输运方程](@entry_id:174281)进行积分，并对流串项应用高斯散度定理，我们可以得到一个精确的积分[平衡方程](@entry_id:172166) ：
$$
\oint_{\partial K} (\boldsymbol{\Omega}_m \cdot \mathbf{n}_f) \psi_m \,dA + \int_K \Sigma_{t} \psi_m \,dV = \int_K q_m \,dV
$$
这个方程表明，对于方向 $\boldsymbol{\Omega}_m$，（通过边界 $\partial K$ 的净泄漏率）+（在 $K$ 内的碰撞移除率）=（在 $K$ 内的总源率）。一个**[守恒格式](@entry_id:747714) (conservative scheme)**，如[有限体积法](@entry_id:141374)或间断[伽辽金法](@entry_id:749698)，其构造的核心就是确保离散方程在每个单元上都精确满足这一平衡关系。

- **全局粒子守恒 (Global Particle Conservation)**：指在整个计算区域 $\mathcal{D}$ 内，粒子的总产生率等于总消失率。如果一个格式是局部守恒的，那么全局守恒将自动得到满足。这是因为，当我们将所有单元的局部平衡方程相加时，对于任何一个内部面 $f$，它被两个相邻单元共享，其法向量方向相反。由于[守恒格式](@entry_id:747714)在该面上使用唯一的[数值通量](@entry_id:145174)，这两个单元对该面的通量贡献大小相等、符号相反，因此会精确抵消。最终，只有位于整个区域外部边界上的通量项被保留下来。因此，**检验局部守恒是确保全局守恒的充分条件** 。

### 主要空间离散化方法

基于上述原理，多种[空间离散化](@entry_id:172158)方法被开发出来，其中以[有限体积法](@entry_id:141374)、连续有限元法和间断伽辽金法最为重要 。

- **[有限体积法](@entry_id:141374) (Finite Volume Method, FVM)** 直接从单元积分平衡方程出发。它通常假设每个单元内的解由一个单一值（如单元平均值）表示，并通过定义在单元交界面上的**[数值通量](@entry_id:145174) (numerical flux)** 来耦合相邻单元。由于其构造直接源于[积分守恒律](@entry_id:202878)，FVM 天然满足**局部守恒**。它的解在单元间是间断的。FVM 概念简单，鲁棒性强，但传统的 FVM 通常只有一阶或[二阶精度](@entry_id:137876)。

- **连续[有限元法](@entry_id:749389) (Continuous Finite Element Method, CFEM)** 采用变分原理，在一个要求解跨单元连续的函数空间中（例如，$C^0$ 连续空间）寻找[弱解](@entry_id:161732)。然而，标准的 CFEM 应用于输运这类双曲型方程时存在严重问题：它**不满足局部守恒**，并且在对流占优的情况下（即输运效应远大于碰撞或扩散效应时）会产生剧烈的非物理**[伪振荡](@entry_id:152404) (spurious oscillations)**。

- 为了解决 CFEM 的振荡问题，**流线迎风/彼得罗夫-伽辽金 (Streamline-Upwind/Petrov-Galerkin, SUPG)** 方法被提出 。SUPG 是一种稳定化技术，它通过修改测试函数，引入一个沿着流线方向（即 $\boldsymbol{\Omega}$ 方向）的扰动项。这种修改在变分形式中增加了一项与方程残差成正比的稳定项。其主要作用是引入了**[人工扩散](@entry_id:637299)**，但这种扩散是各向异性的，主要作用于流线方向，从而有效地抑制了沿特征线传播的振荡，同时又避免了对垂直于流线方向的物理梯度造成过度模糊。由于稳定项是基于残差的，该方法保持了**相容性 (consistency)**，即精确解代入后稳定项为零。稳定参数 $\tau_K$ 的选择至关重要，它需要根据单元尺寸 $h_K$ 和输运速度进行调整，通常取 $\tau_K = \mathcal{O}(h_K/\|\boldsymbol{\Omega}\|)$。

- **间断伽辽金法 (Discontinuous Galerkin, DG)** 是近年来在输运计算领域备受青睐的现代方法。DG 法在一个解在单元间可以不连续的函数空间（通常是分片[多项式空间](@entry_id:144410)）中求解。它通过在单元边界上引入数值通量来耦合相邻单元，这一点与 FVM 类似。DG 法集 FVM 和 FEM 的优点于一身：
    1.  **局部守恒**：由于分片[常数函数](@entry_id:152060)是合法的[测试函数](@entry_id:166589)，DG 法能够精确满足每个单元的[积分守恒律](@entry_id:202878)。
    2.  **[高阶精度](@entry_id:750325)**：通过在每个单元内使用高阶多项式基函数，DG 法可以系统地达到任意高阶的精度。
    3.  **灵活性**：它非常适合处理非结构网格和复杂的几何形状。
DG 法为处理[输运方程](@entry_id:174281)提供了一个统一而强大的框架。

### 因果性、迎风格式与[输运扫描](@entry_id:1133407)

[输运方程](@entry_id:174281)的双曲特性决定了其信息传播的**因果性 (causality)**：在给定方向 $\boldsymbol{\Omega}$ 上，某一点的粒子通量只受其上游（即粒子来源方向）区域通量的影响，而不会影响到其上游。数值格式必须严格遵守这一物理原则才能保证稳定性和物理真实性。

#### [迎风原理](@entry_id:756377)

在 FVM 和 DG 方法中，因果性通过在单元交界面上采用**[迎风](@entry_id:756372)数值通量 (upwind numerical flux)** 来强制执行 。对于一个被单元 $K^-$ 和 $K^+$ 共享的面 $f$（法向量 $\mathbf{n}_f$ 从 $K^-$ 指向 $K^+$），[迎风原理](@entry_id:756377)规定：
- 如果粒子沿 $\boldsymbol{\Omega}$ 方向从 $K^-$ 流向 $K^+$（即 $\boldsymbol{\Omega} \cdot \mathbf{n}_f > 0$），则 $K^-$ 是**上游单元**，面上的通量值应取为 $K^-$ 在该面上的迹 $\psi^-$。
- 如果粒子沿 $\boldsymbol{\Omega}$ 方向从 $K^+$ 流向 $K^-$（即 $\boldsymbol{\Omega} \cdot \mathbf{n}_f  0$），则 $K^+$ 是**上游单元**，面上的通量值应取为 $K^+$ 在该面上的迹 $\psi^+$。

采用[迎风通量](@entry_id:143931)后，每个单元的离散方程只依赖于其上游邻居单元的解，而与下游邻居无关。这种单向的依赖关系是因果性的直接体现。相比之下，采用中心格式的数值通量（如 $\frac{1}{2}(\psi^- + \psi^+)$）会引入[双向耦合](@entry_id:178809)，破坏因果性，并导致不稳定。

#### [输运扫描](@entry_id:1133407)

对于一个固定的方向 $\boldsymbol{\Omega}_m$，[迎风格式](@entry_id:756378)在所有网格单元之间建立了一个**有向依赖关系图 (directed dependency graph)**，其中每个节点代表一个单元，每条有向边从上游单元指向其直接下游单元 。

如果这个图是**无环的 (acyclic)**，即一个**有向无环图 (Directed Acyclic Graph, DAG)**，那么我们就可以对其进行**[拓扑排序](@entry_id:156507) (topological sort)**。这个排序结果给出了一个单元的[计算顺序](@entry_id:749112)，使得每个单元在被计算时，其所有上游邻居都已经被计算完毕。沿着这个顺序依次求解每个单元的过程，称为一次**输运扫描 (transport sweep)**。这是一种极其高效的非迭代求解方法，因为它将全局耦合的代数系统[解耦](@entry_id:160890)成一个可以顺序求解的块下三角（或上三角）系统 。

#### 依赖[图中的环](@entry_id:273495)路

然而，在非结构网格上，依赖关系图并不总是无环的 。**环路 (cycles)** 的出现会阻止简单的[拓扑排序](@entry_id:156507)，使得单次扫描无法完成。环路主要由以下两种情况引起：
1.  **几何诱导的环路**：在具有凹陷或重入（re-entrant）边界的复杂几何中，粒子流可能沿着一条路径离开某个区域，然后又重新进入该区域的上游，形成单元间的依赖闭环。
2.  **边界条件诱导的环路**：**[周期性边界条件](@entry_id:753346) (periodic boundary conditions)** 是最典型的例子。它将下游出流边界与上游入流边界直接相连，人为地构造了一个全局性的依赖环。

当依赖图中存在环路时，环路中的所有单元（称为一个**[强连通分量](@entry_id:270183)**）必须被耦合求解，通常作为一个小型的[线性方程组](@entry_id:148943)来处理，或者通过在整个环路（或整个计算域）上进行迭代来求解。因此，虽然[迎风格式](@entry_id:756378)保证了局部因果性，但能否实现全局的单次非迭代扫描，还取决于网格的拓扑结构和边界条件。

### 边界条件

边界条件的正确施加是求解输运问题的关键一环。在 FVM/DG 框架中，边界条件通过为位于计算域边界上的面指定**入射角通量 (incoming angular flux)** 来实现 。对于一个边界单元，其外法向量 $\mathbf{n}_f$ 指向区域外部，因此入射方向 $\boldsymbol{\Omega}_m$ 满足 $\boldsymbol{\Omega}_m \cdot \mathbf{n}_f  0$。

- **[真空边界条件](@entry_id:1133678) (Vacuum)**：假设计算区域外部是真空，没有粒子会进入。因此，对于任何入射方向，入射通量为零：
$$ \psi_{f,g,m}^{\mathrm{in}} = 0 \quad (\text{for } \boldsymbol{\Omega}_m \cdot \mathbf{n}_f  0) $$

- **[反射边界条件](@entry_id:1130780) (Reflective)**：模拟一个像镜面一样的边界。当一个粒子以方向 $\boldsymbol{\Omega}_m$ 入射到边界时，它会以一个反射后的方向 $\boldsymbol{\Omega}_{\mathcal{R}_f(m)}$ 离开。对于**[镜面反射](@entry_id:270785) (specular reflection)**，[入射角](@entry_id:192705)等于反射角。入射通量的大小等于对应出射方向的通量大小。
$$ \psi_{f,g,m}^{\mathrm{in}} = \psi_{f,g,\mathcal{R}_f(m)}^{\mathrm{out}} $$
其中反射方向由下式给出：
$$ \boldsymbol{\Omega}_{\mathcal{R}_f(m)} = \boldsymbol{\Omega}_m - 2 ( \boldsymbol{\Omega}_m \cdot \mathbf{n}_f ) \mathbf{n}_f $$

- **周期性边界条件 (Periodic)**：用于模拟无限重复的晶格结构。它将区域的一侧边界（例如 $f$）与另一侧边界（例如 $g$）配对。当一个粒子以方向 $\boldsymbol{\Omega}_m$ 从 $g$ 边界射出时，它被认为同时以相同的方向从 $f$ 边界射入。
$$ \psi_{f,g,m}^{\mathrm{in}} = \psi_{g,g,m}^{\mathrm{out}} $$

### 高级主题：精度与正性

虽然我们已经构建了数值方法的基本框架，但在追求高精度解的过程中，还会遇到更深层次的挑战。

#### [网格质量](@entry_id:151343)对精度的影响

对于基于迎风的格式，离散化误差（或称**[截断误差](@entry_id:140949) (truncation error)**）的大小不仅与单元尺寸 $h$ 有关，还与网格的几何质量密切相关 。[截断误差](@entry_id:140949)的主要表现形式是**[数值扩散](@entry_id:136300) (numerical diffusion)**。

- **单元[佩克莱数](@entry_id:141791) (Cell Peclet number)**, $Pe_K := \frac{\|\boldsymbol{\Omega}\| h}{2D}$（其中 $D$ 是等效扩散系数），量化了单元内对流与物理扩散的相对强度。[迎风格式](@entry_id:756378)引入的[数值扩散](@entry_id:136300)与 $Pe_K$ 成正比。在对流占优的情况下 ($Pe_K \gg 1$)，[数值扩散](@entry_id:136300)会远大于物理扩散，导致解被过度抹平。
- **[网格质量度量](@entry_id:1125799)**，如**长宽比 (aspect ratio)** 和**偏斜度 (skewness)**，对误差有显著影响。在偏斜的网格上，[迎风通量](@entry_id:143931)的计算会引入**横风扩散 (crosswind diffusion)**，即在垂直于流线方向上产生非物理的扩散，进一步降低解的精度。一个定性的[误差界](@entry_id:139888)可以表示为：
$$
\text{Error} \propto Pe_{K} \cdot (1 + AR_{K} \tan\theta_{K})
$$
其中 $AR_K$ 是[长宽比](@entry_id:177707)，$\theta_K$ 是偏斜度。这表明，要获得高精度的解，不仅需要细化网格，还需要保证网格单元的形状良好。

#### 高阶方法的正性挑战

物理上，当中子源和入射边界条件都非负时，角通量 $\psi$ 在任何地方都应是非负的。然而，高阶数值格式（如阶数 $p \ge 2$ 的 DG 法）在面临解的剧烈变化（如材料界面、边界层或强局部源）时，往往会产生非物理的**负值 (negative fluxes)** 。

这一现象是**戈东诺夫定理 (Godunov's theorem)** 的一个推论，该定理指出，任何保持[单调性](@entry_id:143760)（即不产生新极值，从而保证正性）的线性数值格式，其精度最高只能是一阶。因此，任何试图同时实现[高阶精度](@entry_id:750325)和严格正性的方法，都必须是**[非线性](@entry_id:637147)的**或**自适应的**。

以下是两种有效且严谨的**保正 (positivity-preserving)** 策略：

1.  **限制器 (Limiters)**：例如 **Zhang-Shu 型限制器**。这种方法采用“检测-修正”的策略。在每个单元计算完毕后，检测其内部多项式解是否在某些点出现负值。如果出现，则对解进行修正。修正过程通常是将高阶部分（即多项式解与单元平均值之差）乘以一个缩放因子 $\theta \in [0, 1]$，使得修正后的解的最小值恰好为零。
    $$ P_{\text{lim}}(\mathbf{x}) = \bar{\psi}_K + \theta (P(\mathbf{x}) - \bar{\psi}_K) $$
    这个过程**保持了单元平均值**（因此是局部守恒的），并且只在必要时激活，所以在解光滑的区域，$\theta=1$，方法恢复到原始的[高阶格式](@entry_id:150564)，从而**保持了高阶精度**。

2.  **[通量修正输运](@entry_id:749476) (Flux-Corrected Transport, FCT)**：FCT 是一种更为复杂的[非线性](@entry_id:637147)[通量限制](@entry_id:749486)技术。其基本思想是，首先使用一个低阶、鲁棒且[保证正性](@entry_id:1125838)的格式（如一阶迎风）计算一个初步的解。然后，计算一个[高阶格式](@entry_id:150564)与低阶格式之间的“反[扩散通量](@entry_id:748422)差”。最后，对这个反扩散通量进行[非线性](@entry_id:637147)限制，只添加那些不会产生新[极值](@entry_id:145933)（即不会导致负值）的部分。FCT 同样是**守恒的**和**自适应的**，能够在光滑区域恢复高阶精度。

与之相对，一些看似简单直接的方法是不可取的，例如，在计算后简单地将所有负值“裁剪”为零。这种做法破坏了粒子守恒，并且会引入不一致性，因为作为散射源的标通量将不再是角通量的精确积分，从而损害解的准确性和物理意义 。