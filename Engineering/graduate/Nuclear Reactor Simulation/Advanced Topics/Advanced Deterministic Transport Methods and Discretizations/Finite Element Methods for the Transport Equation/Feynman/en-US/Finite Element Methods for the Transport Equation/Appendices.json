{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of the Finite Element Method (FEM) is the use of an affine mapping to transform integrals and derivatives from a complex physical element in a mesh to a simple, fixed reference element. This practice is essential for creating a general and efficient computational framework. This exercise  provides hands-on experience with this core concept by asking you to compute the gradient of a basis function on a physical tetrahedron. You will apply the chain rule, involving the Jacobian of the transformation, to see exactly how the streaming term $\\boldsymbol{\\Omega} \\cdot \\nabla \\psi$ is evaluated in practice within an FEM code.",
            "id": "4225515",
            "problem": "Consider the steady-state one-group neutron transport equation in three spatial dimensions, where the streaming operator appears as $\\boldsymbol{\\Omega} \\cdot \\nabla \\psi(\\boldsymbol{x})$. In a Continuous Finite Element (CFE) discretization on a tetrahedral mesh, the mapped gradient of a basis function from the reference tetrahedron to a physical tetrahedral element is required to evaluate the directional derivative $\\boldsymbol{\\Omega} \\cdot \\nabla \\varphi$ at quadrature points for assembling the streaming contribution. Let the reference tetrahedron $\\hat{T}$ have vertices at $\\hat{\\boldsymbol{v}}_{1}=(0,0,0)$, $\\hat{\\boldsymbol{v}}_{2}=(1,0,0)$, $\\hat{\\boldsymbol{v}}_{3}=(0,1,0)$, and $\\hat{\\boldsymbol{v}}_{4}=(0,0,1)$, and let the standard linear Lagrange basis functions on $\\hat{T}$ be $\\hat{\\varphi}_{1}(\\hat{\\boldsymbol{x}})=1-\\hat{\\xi}-\\hat{\\eta}-\\hat{\\zeta}$, $\\hat{\\varphi}_{2}(\\hat{\\boldsymbol{x}})=\\hat{\\xi}$, $\\hat{\\varphi}_{3}(\\hat{\\boldsymbol{x}})=\\hat{\\eta}$, and $\\hat{\\varphi}_{4}(\\hat{\\boldsymbol{x}})=\\hat{\\zeta}$ for $\\hat{\\boldsymbol{x}}=(\\hat{\\xi},\\hat{\\eta},\\hat{\\zeta})$. A physical tetrahedral element $T$ in a reactor core subregion is defined by the vertices $\\boldsymbol{v}_{1}=(1.2,-0.3,0.5)$, $\\boldsymbol{v}_{2}=(3.3,0.1,0.6)$, $\\boldsymbol{v}_{3}=(1.4,2.2,0.8)$, and $\\boldsymbol{v}_{4}=(0.7,-0.2,3.5)$, with all coordinates measured in centimeters. The affine mapping $\\boldsymbol{x}(\\hat{\\boldsymbol{x}})=\\boldsymbol{v}_{1}+\\mathbf{A}\\hat{\\boldsymbol{x}}$ is defined by the Jacobian matrix $\\mathbf{A}=[\\boldsymbol{v}_{2}-\\boldsymbol{v}_{1}\\ \\ \\boldsymbol{v}_{3}-\\boldsymbol{v}_{1}\\ \\ \\boldsymbol{v}_{4}-\\boldsymbol{v}_{1}]$, where columns are the edge vectors from $\\boldsymbol{v}_{1}$ to the other vertices. Assume the particle streaming direction is the unit vector $\\boldsymbol{\\Omega}=\\frac{1}{\\sqrt{3}}(1,-1,1)$, typical of a Discrete Ordinates (SN) angular direction. Using the chain rule for affine maps, and the definition of the gradient on the reference element, compute the mapped physical gradient $\\nabla \\varphi_{1}(\\boldsymbol{x})$ of the basis function associated with vertex $\\boldsymbol{v}_{1}$, and evaluate the directional derivative $\\boldsymbol{\\Omega}\\cdot\\nabla\\varphi_{1}$ at the following four reference-space quadrature points with equal weights: $\\hat{\\boldsymbol{x}}_{1}=(0,0,0)$, $\\hat{\\boldsymbol{x}}_{2}=(1,0,0)$, $\\hat{\\boldsymbol{x}}_{3}=(0,1,0)$, and $\\hat{\\boldsymbol{x}}_{4}=(0,0,1)$, with each weight $w_{q}=1/24$. Finally, report the arithmetic mean of the four values $\\boldsymbol{\\Omega}\\cdot\\nabla\\varphi_{1}$ evaluated at the mapped physical quadrature points. Express the final mean value in inverse centimeters and round your answer to four significant figures.",
            "solution": "The problem asks for the arithmetic mean of the directional derivative, $\\boldsymbol{\\Omega}\\cdot\\nabla\\varphi_{1}$, evaluated at four quadrature points. Since the basis function $\\varphi_{1}$ is linear on a tetrahedral element and the mapping from the reference to the physical element is affine, its gradient $\\nabla\\varphi_{1}$ is a constant vector throughout the physical element. Consequently, the directional derivative $\\boldsymbol{\\Omega}\\cdot\\nabla\\varphi_{1}$ is also constant. The mean value is simply this constant value.\n\nThe core of the calculation is to find the physical gradient $\\nabla\\varphi_{1}$ using the chain rule, which relates it to the gradient on the reference element, $\\hat{\\nabla}\\hat{\\varphi}_{1}$:\n$$ \\nabla \\varphi_{1}(\\boldsymbol{x}) = (\\mathbf{A}^{-1})^{T} \\hat{\\nabla} \\hat{\\varphi}_{1}(\\hat{\\boldsymbol{x}}) $$\nwhere $\\mathbf{A}$ is the Jacobian matrix of the affine map $\\boldsymbol{x}(\\hat{\\boldsymbol{x}})$.\n\n**Step 1: Compute the gradient on the reference element.**\nThe basis function on the reference tetrahedron is $\\hat{\\varphi}_{1}(\\hat{\\boldsymbol{x}}) = 1 - \\hat{\\xi} - \\hat{\\eta} - \\hat{\\zeta}$. Its gradient with respect to the reference coordinates $\\hat{\\boldsymbol{x}}=(\\hat{\\xi}, \\hat{\\eta}, \\hat{\\zeta})$ is:\n$$ \\hat{\\nabla} \\hat{\\varphi}_{1} = \\begin{pmatrix} \\partial/\\partial\\hat{\\xi} \\\\ \\partial/\\partial\\hat{\\eta} \\\\ \\partial/\\partial\\hat{\\zeta} \\end{pmatrix} (1 - \\hat{\\xi} - \\hat{\\eta} - \\hat{\\zeta}) = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix} $$\n\n**Step 2: Construct the Jacobian matrix $\\mathbf{A}$.**\nThe Jacobian matrix $\\mathbf{A}$ is constructed from the edge vectors of the physical element $T$ originating from vertex $\\boldsymbol{v}_{1}=(1.2, -0.3, 0.5)$. The other vertices are $\\boldsymbol{v}_{2}=(3.3, 0.1, 0.6)$, $\\boldsymbol{v}_{3}=(1.4, 2.2, 0.8)$, and $\\boldsymbol{v}_{4}=(0.7, -0.2, 3.5)$.\n$$ \\boldsymbol{v}_{2}-\\boldsymbol{v}_{1} = \\begin{pmatrix} 2.1 \\\\ 0.4 \\\\ 0.1 \\end{pmatrix}, \\quad \\boldsymbol{v}_{3}-\\boldsymbol{v}_{1} = \\begin{pmatrix} 0.2 \\\\ 2.5 \\\\ 0.3 \\end{pmatrix}, \\quad \\boldsymbol{v}_{4}-\\boldsymbol{v}_{1} = \\begin{pmatrix} -0.5 \\\\ 0.1 \\\\ 3.0 \\end{pmatrix} $$\nThe Jacobian matrix is formed by these column vectors:\n$$ \\mathbf{A} = \\begin{pmatrix} 2.1  0.2  -0.5 \\\\ 0.4  2.5  0.1 \\\\ 0.1  0.3  3.0 \\end{pmatrix} $$\n\n**Step 3: Compute the physical gradient $\\nabla \\varphi_{1}$.**\nTo compute $(\\mathbf{A}^{-1})^T$, we first find the determinant of $\\mathbf{A}$:\n$$ \\det(\\mathbf{A}) = 2.1(2.5 \\cdot 3.0 - 0.1 \\cdot 0.3) - 0.2(0.4 \\cdot 3.0 - 0.1 \\cdot 0.1) - 0.5(0.4 \\cdot 0.3 - 2.5 \\cdot 0.1) = 15.514 $$\nThe physical gradient is $\\nabla \\varphi_{1} = (\\mathbf{A}^{-1})^{T} \\hat{\\nabla} \\hat{\\varphi}_{1} = \\frac{1}{\\det(\\mathbf{A})} \\text{adj}(\\mathbf{A})^T \\hat{\\nabla} \\hat{\\varphi}_{1} = \\frac{1}{\\det(\\mathbf{A})} \\mathbf{C} \\hat{\\nabla} \\hat{\\varphi}_{1}$, where $\\mathbf{C}$ is the cofactor matrix of $\\mathbf{A}$.\n$$ \\nabla \\varphi_{1} = \\frac{1}{15.514} \\begin{pmatrix} 7.47  -1.19  -0.13 \\\\ -0.75  6.35  -0.61 \\\\ 1.27  -0.41  5.17 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix} = \\frac{-1}{15.514} \\begin{pmatrix} 6.15 \\\\ 4.99 \\\\ 6.03 \\end{pmatrix} $$\n\n**Step 4: Calculate the directional derivative.**\nThe directional derivative is the dot product of the streaming direction $\\boldsymbol{\\Omega} = \\frac{1}{\\sqrt{3}}(1, -1, 1)$ and the physical gradient $\\nabla \\varphi_{1}$.\n$$ \\boldsymbol{\\Omega} \\cdot \\nabla \\varphi_{1} = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix} \\cdot \\left( \\frac{-1}{15.514} \\begin{pmatrix} 6.15 \\\\ 4.99 \\\\ 6.03 \\end{pmatrix} \\right) $$\n$$ \\boldsymbol{\\Omega} \\cdot \\nabla \\varphi_{1} = \\frac{-1}{\\sqrt{3} \\cdot 15.514} [ (1)(6.15) + (-1)(4.99) + (1)(6.03) ] $$\n$$ \\boldsymbol{\\Omega} \\cdot \\nabla \\varphi_{1} = \\frac{-(6.15 - 4.99 + 6.03)}{15.514\\sqrt{3}} = \\frac{-7.19}{15.514\\sqrt{3}} \\approx -0.267573 \\text{ cm}^{-1} $$\nSince this value is constant over the element, the mean value is the same. Rounding to four significant figures gives $-0.2676$.",
            "answer": "$$ \\boxed{-0.2676} $$"
        },
        {
            "introduction": "When using Discontinuous Galerkin (DG) methods for the transport equation, the treatment of information flow at element boundaries is paramount. Unlike continuous methods, DG formulations use a numerical flux to couple adjacent elements and impose boundary conditions, which explicitly depends on the direction of particle travel. This exercise  focuses on the fundamental concept of identifying \"inflow\" and \"outflow\" boundaries by examining the dot product of the particle direction $\\boldsymbol{\\Omega}$ and the boundary normal vector $\\mathbf{n}$. By working through this problem, you will understand how vacuum boundary conditions are incorporated into the weak form and why they lead to a specific, simplified term in the discrete system.",
            "id": "4225529",
            "problem": "Consider the steady-state, monoenergetic neutron transport equation in a rectangular reactor assembly subdomain with vacuum boundaries. Let the physical domain be $D = [0,L_{x}] \\times [0,L_{y}] \\times [0,L_{z}] \\subset \\mathbb{R}^{3}$, with outward unit normal $\\mathbf{n}$ defined on the boundary $\\partial D$. The neutron angular flux is denoted by $\\psi(\\mathbf{x},\\boldsymbol{\\Omega})$, the total macroscopic cross section by $\\Sigma_{t}(\\mathbf{x})$, and the volumetric source by $q(\\mathbf{x},\\boldsymbol{\\Omega})$. The fundamental balance law is\n$$\n\\boldsymbol{\\Omega} \\cdot \\nabla \\psi(\\mathbf{x},\\boldsymbol{\\Omega}) + \\Sigma_{t}(\\mathbf{x}) \\psi(\\mathbf{x},\\boldsymbol{\\Omega}) = q(\\mathbf{x},\\boldsymbol{\\Omega}) \\quad \\text{in } D,\n$$\nfor a given direction of flight $\\boldsymbol{\\Omega} \\in \\mathbb{S}^{2}$.\n\nIn a discontinuous Galerkin (DG) finite element formulation, using a test function $v(\\mathbf{x},\\boldsymbol{\\Omega})$ and integrating the streaming term by parts on $D$, the boundary contribution involves the upwind numerical flux and is written over inflow portions of the boundary. The inflow boundary set is defined by\n$$\n\\Gamma_{-} := \\left\\{ \\mathbf{x} \\in \\partial D \\,:\\, \\boldsymbol{\\Omega} \\cdot \\mathbf{n}(\\mathbf{x})  0 \\right\\}.\n$$\nFor a vacuum boundary condition, the incoming angular flux is zero, namely\n$$\n\\psi^{b}(\\mathbf{x},\\boldsymbol{\\Omega}) = 0 \\quad \\text{on } \\Gamma_{-}.\n$$\n\nLet the flight direction be fixed as $\\boldsymbol{\\Omega} = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right)$. Determine which faces of the rectangular boundary $\\partial D$ belong to the inflow set $\\Gamma_{-}$ by evaluating $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}$ on each face of the box. Then, write the inflow boundary integral term that appears in the DG weak form as\n$$\n\\int_{\\Gamma_{-}} \\left( - \\boldsymbol{\\Omega} \\cdot \\mathbf{n} \\right) \\, \\psi^{b} \\, v \\, \\mathrm{d}S,\n$$\nand simplify it under the vacuum boundary condition. Your final answer must be a single real-valued number or a single closed-form analytic expression. No units are required because the requested expression is dimensionless. If your final result is an exact value, do not round.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- **Domain:** $D = [0,L_{x}] \\times [0,L_{y}] \\times [0,L_{z}] \\subset \\mathbb{R}^{3}$.\n- **Outward unit normal:** $\\mathbf{n}$ on the boundary $\\partial D$.\n- **Transport equation:** $\\boldsymbol{\\Omega} \\cdot \\nabla \\psi(\\mathbf{x},\\boldsymbol{\\Omega}) + \\Sigma_{t}(\\mathbf{x}) \\psi(\\mathbf{x},\\boldsymbol{\\Omega}) = q(\\mathbf{x},\\boldsymbol{\\Omega})$.\n- **Fixed direction of flight:** $\\boldsymbol{\\Omega} = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right)$.\n- **Inflow boundary set definition:** $\\Gamma_{-} := \\left\\{ \\mathbf{x} \\in \\partial D \\,:\\, \\boldsymbol{\\Omega} \\cdot \\mathbf{n}(\\mathbf{x})  0 \\right\\}$.\n- **Vacuum boundary condition:** $\\psi^{b}(\\mathbf{x},\\boldsymbol{\\Omega}) = 0$ on $\\Gamma_{-}$.\n- **Inflow boundary integral term to evaluate:** $\\int_{\\Gamma_{-}} \\left( - \\boldsymbol{\\Omega} \\cdot \\mathbf{n} \\right) \\, \\psi^{b} \\, v \\, \\mathrm{d}S$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it deals with the standard steady-state, monoenergetic neutron transport equation and its discontinuous Galerkin formulation, which are well-established concepts in nuclear reactor physics and numerical methods. The problem is well-posed, providing all necessary information (domain geometry, particle direction, boundary condition definition) to uniquely identify the inflow boundary and evaluate the specified integral term. The language is objective and precise. All givens are consistent. The problem is therefore deemed **valid**.\n\n**Step 3: Proceed to Solution**\n\nThe objective is to identify the inflow faces of the rectangular domain $D$ for the given direction of flight $\\boldsymbol{\\Omega}$ and then to evaluate the provided boundary integral term under a vacuum boundary condition.\n\nThe domain is a rectangular prism $D = [0, L_x] \\times [0, L_y] \\times [0, L_z]$. Its boundary $\\partial D$ consists of six planar faces. We must determine the outward unit normal vector $\\mathbf{n}$ for each face.\n\nThe six faces and their corresponding outward unit normal vectors are:\n1.  Face at $x=0$: $\\mathbf{n}_1 = (-1, 0, 0)$\n2.  Face at $x=L_x$: $\\mathbf{n}_2 = (1, 0, 0)$\n3.  Face at $y=0$: $\\mathbf{n}_3 = (0, -1, 0)$\n4.  Face at $y=L_y$: $\\mathbf{n}_4 = (0, 1, 0)$\n5.  Face at $z=0$: $\\mathbf{n}_5 = (0, 0, -1)$\n6.  Face at $z=L_z$: $\\mathbf{n}_6 = (0, 0, 1)$\n\nThe fixed direction of neutron flight is given as $\\boldsymbol{\\Omega} = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right)$.\n\nAccording to the definition, the inflow boundary $\\Gamma_{-}$ consists of all points $\\mathbf{x} \\in \\partial D$ where $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}(\\mathbf{x})  0$. We compute this dot product for each of the six faces:\n\n1.  Face at $x=0$:\n    $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_1 = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right) \\cdot (-1, 0, 0) = -\\frac{1}{\\sqrt{2}}$.\n    Since $-\\frac{1}{\\sqrt{2}}  0$, this face is part of the inflow boundary $\\Gamma_{-}$.\n\n2.  Face at $x=L_x$:\n    $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_2 = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right) \\cdot (1, 0, 0) = \\frac{1}{\\sqrt{2}}$.\n    Since $\\frac{1}{\\sqrt{2}}  0$, this is an outflow face.\n\n3.  Face at $y=0$:\n    $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_3 = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right) \\cdot (0, -1, 0) = -\\frac{1}{\\sqrt{2}}$.\n    Since $-\\frac{1}{\\sqrt{2}}  0$, this face is also part of the inflow boundary $\\Gamma_{-}$.\n\n4.  Face at $y=L_y$:\n    $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_4 = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right) \\cdot (0, 1, 0) = \\frac{1}{\\sqrt{2}}$.\n    Since $\\frac{1}{\\sqrt{2}}  0$, this is an outflow face.\n\n5.  Face at $z=0$:\n    $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_5 = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right) \\cdot (0, 0, -1) = 0$.\n    Since the dot product is not strictly negative, this is not an inflow face. It is a tangential or characteristic boundary.\n\n6.  Face at $z=L_z$:\n    $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_6 = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right) \\cdot (0, 0, 1) = 0$.\n    This is also a tangential boundary.\n\nTherefore, the inflow boundary set $\\Gamma_{-}$ is the union of the two faces where the inflow condition is met:\n$$\n\\Gamma_{-} = \\left\\{ (0, y, z) \\,:\\, y \\in [0,L_y], z \\in [0,L_z] \\right\\} \\cup \\left\\{ (x, 0, z) \\,:\\, x \\in [0,L_x], z \\in [0,L_z] \\right\\}.\n$$\n\nNext, we must evaluate the specified inflow boundary integral term:\n$$\nI = \\int_{\\Gamma_{-}} \\left( - \\boldsymbol{\\Omega} \\cdot \\mathbf{n} \\right) \\, \\psi^{b} \\, v \\, \\mathrm{d}S.\n$$\nThe problem states that a vacuum boundary condition is applied. This condition is formally given as $\\psi^{b}(\\mathbf{x},\\boldsymbol{\\Omega}) = 0$ for all $\\mathbf{x} \\in \\Gamma_{-}$, where $\\psi^{b}$ is the incoming angular flux prescribed at the boundary.\n\nSubstituting $\\psi^{b} = 0$ into the integrand, the integral becomes:\n$$\nI = \\int_{\\Gamma_{-}} \\left( - \\boldsymbol{\\Omega} \\cdot \\mathbf{n} \\right) \\, (0) \\, v(\\mathbf{x}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}S.\n$$\nThe integrand is identically zero for all points $\\mathbf{x} \\in \\Gamma_{-}$ and for any arbitrary test function $v$. The integral of a zero function over any domain is zero.\n$$\nI = \\int_{\\Gamma_{-}} 0 \\, \\mathrm{d}S = 0.\n$$\nThus, the inflow boundary integral term simplifies to $0$ under the vacuum boundary condition. This is a fundamental result in the DG method for the transport equation: for vacuum boundaries, the boundary term corresponding to the incoming flux vanishes.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "While higher-order DG methods can achieve high accuracy, they can also produce unphysical oscillations, such as negative flux values, near sharp gradients or discontinuities in the solution. To ensure the physical non-negativity of the particle density, practical DG codes employ \"limiters\" that locally adjust the solution. This problem  walks you through the application of a common positivity-preserving limiter, demonstrating how to modify the solution's modal coefficients to eliminate an undershoot while conserving the cell average. This practice offers valuable insight into the non-linear techniques required to make advanced numerical methods for transport both robust and reliable.",
            "id": "4225471",
            "problem": "Consider the one-dimensional, steady, monoenergetic neutron transport equation in slab geometry,\n$$\\mu \\,\\frac{d \\psi(x,\\mu)}{dx} + \\sigma_{t}(x)\\,\\psi(x,\\mu) = q(x,\\mu),$$\nwhere $\\psi(x,\\mu)$ is the angular flux, $\\mu \\in [-1,1]$ is the cosine of the particle flight direction, $\\sigma_{t}(x)$ is the total macroscopic cross section, and $q(x,\\mu)$ is a known source. In a Discontinuous Galerkin (DG) finite element approximation (Finite Element Method (FEM) with discontinuous trial spaces), consider a single cell $K$ mapped affinely to the reference interval $\\xi \\in [-1,1]$. On $K$, for a fixed direction $\\mu = \\mu_{0}  0$, the DG modal representation of the angular flux is linear:\n$$\\psi_{h}(\\xi;\\mu_{0}) = a_{0} + a_{1}\\,\\xi,$$\nwith $a_{0}$ equal to the cell average and $a_{1}$ the modal slope coefficient. Suppose the current DG solution exhibits a small negative undershoot at the left face $\\xi=-1$, with\n$$a_{0} = 1.0 \\times 10^{-2}, \\quad a_{1} = 1.5 \\times 10^{-2}, \\quad \\mu_{0} = 8.0 \\times 10^{-1}.$$\nTo enforce physical nonnegativity, apply a positivity-preserving limiter that rescales deviations from the cell average by a factor $\\theta \\in [0,1]$ while preserving the cell average. The positivity tolerance is\n$$\\epsilon = 1.0 \\times 10^{-6}.$$\nAssume the left face value is the minimum in the cell before limiting, and determine the limiting factor that makes the limited left face value exactly $\\epsilon$, leaving the average unchanged. Then compute the adjusted coefficients $(a_{0}^{\\text{lim}}, a_{1}^{\\text{lim}})$ and the resulting upwind numerical face flux on the right face $\\xi=+1$ for the convective term, defined for $\\mu_{0}  0$ as\n$$F_{K,+} = \\mu_{0}\\,\\psi_{h}^{-}(+1;\\mu_{0}),$$\nwhere $\\psi_{h}^{-}$ denotes the interior trace from cell $K$. Round the entries of the final answer to six significant figures and express the flux in neutrons per centimeter squared per second. Provide the final answer as a single row matrix containing $a_{0}^{\\text{lim}}$, $a_{1}^{\\text{lim}}$, and $F_{K,+}$, in that order.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and complete. All given data, definitions, and conditions are explicitly stated and appear to be consistent and physically reasonable within the context of numerical methods for neutron transport. The problem is a standard application of a positivity-preserving limiter in a Discontinuous Galerkin (DG) finite element method, a well-established technique in computational physics. Therefore, the problem is deemed valid and a full solution is provided.\n\nThe angular flux $\\psi_{h}$ in a single cell, mapped to the reference interval $\\xi \\in [-1,1]$, is given by a linear modal representation for a fixed direction $\\mu_{0}$:\n$$ \\psi_{h}(\\xi;\\mu_{0}) = a_{0} + a_{1}\\,\\xi $$\nThe coefficient $a_{0}$ represents the cell-average flux, as verified by integrating over the reference element:\n$$ \\bar{\\psi}_{h} = \\frac{1}{1 - (-1)} \\int_{-1}^{1} (a_{0} + a_{1}\\,\\xi) \\,d\\xi = \\frac{1}{2} \\left[ a_{0}\\xi + \\frac{a_{1}\\xi^{2}}{2} \\right]_{-1}^{1} = \\frac{1}{2} \\left( (a_{0} + \\frac{a_{1}}{2}) - (-a_{0} + \\frac{a_{1}}{2}) \\right) = a_{0} $$\nThe given initial coefficients are $a_{0} = 1.0 \\times 10^{-2}$ and $a_{1} = 1.5 \\times 10^{-2}$.\nSince the slope coefficient $a_{1}$ is positive, the linear function $\\psi_{h}(\\xi)$ is monotonically increasing on the interval $\\xi \\in [-1,1]$. Its minimum value therefore occurs at the left face, $\\xi=-1$.\nThe value of the flux at the left face is:\n$$ \\psi_{h}(-1) = a_{0} + a_{1}(-1) = a_{0} - a_{1} = 1.0 \\times 10^{-2} - 1.5 \\times 10^{-2} = -0.005 $$\nThis value is negative, which is unphysical for a particle flux, thus necessitating the application of a positivity-preserving limiter.\n\nThe limiter is designed to rescale deviations from the cell average, $a_{0}$, by a factor $\\theta \\in [0,1]$ while preserving the cell average itself. The deviation from the average is $\\psi_{h}(\\xi) - a_{0} = a_{1}\\xi$. The limited flux, $\\psi_{h}^{\\text{lim}}(\\xi)$, is then:\n$$ \\psi_{h}^{\\text{lim}}(\\xi) = a_{0} + \\theta (\\psi_{h}(\\xi) - a_{0}) = a_{0} + \\theta(a_{1}\\xi) $$\nThis can be written in the same modal form as the original flux:\n$$ \\psi_{h}^{\\text{lim}}(\\xi) = a_{0}^{\\text{lim}} + a_{1}^{\\text{lim}}\\xi $$\nBy comparing the two expressions for $\\psi_{h}^{\\text{lim}}(\\xi)$, we find the adjusted coefficients:\n$$ a_{0}^{\\text{lim}} = a_{0} $$\n$$ a_{1}^{\\text{lim}} = \\theta a_{1} $$\nThe limiter preserves the cell average, as required.\n\nThe problem requires determining the limiting factor $\\theta$ such that the limited value at the left face, $\\psi_{h}^{\\text{lim}}(-1)$, is exactly equal to the positivity tolerance $\\epsilon = 1.0 \\times 10^{-6}$.\nThe value of the limited flux at $\\xi=-1$ is:\n$$ \\psi_{h}^{\\text{lim}}(-1) = a_{0}^{\\text{lim}} + a_{1}^{\\text{lim}}(-1) = a_{0} - \\theta a_{1} $$\nWe set this equal to $\\epsilon$:\n$$ a_{0} - \\theta a_{1} = \\epsilon $$\nSolving for $\\theta$:\n$$ \\theta a_{1} = a_{0} - \\epsilon $$\n$$ \\theta = \\frac{a_{0} - \\epsilon}{a_{1}} $$\nSubstituting the given values:\n$$ \\theta = \\frac{1.0 \\times 10^{-2} - 1.0 \\times 10^{-6}}{1.5 \\times 10^{-2}} = \\frac{0.009999}{0.015} = 0.6666 $$\nSince $0 \\leq 0.6666 \\leq 1$, this is a valid limiting factor.\n\nNow we compute the adjusted coefficients $(a_{0}^{\\text{lim}}, a_{1}^{\\text{lim}})$.\nThe cell average is unchanged:\n$$ a_{0}^{\\text{lim}} = a_{0} = 1.0 \\times 10^{-2} $$\nThe adjusted slope coefficient is:\n$$ a_{1}^{\\text{lim}} = \\theta a_{1} = \\left(\\frac{a_{0} - \\epsilon}{a_{1}}\\right) a_{1} = a_{0} - \\epsilon $$\n$$ a_{1}^{\\text{lim}} = 1.0 \\times 10^{-2} - 1.0 \\times 10^{-6} = 0.009999 $$\n\nFinally, we compute the upwind numerical face flux on the right face of the cell, $\\xi=+1$. For $\\mu_0  0$, the upwind flux is determined by the interior trace from the cell $K$, which is the value of the limited solution at the right face boundary.\n$$ F_{K,+} = \\mu_{0}\\,\\psi_{h}^{-}(+1;\\mu_{0}) = \\mu_{0}\\,\\psi_{h}^{\\text{lim}}(+1) $$\nThe value of the limited flux at $\\xi=+1$ is:\n$$ \\psi_{h}^{\\text{lim}}(+1) = a_{0}^{\\text{lim}} + a_{1}^{\\text{lim}}(+1) = a_{0} + (a_{0} - \\epsilon) = 2a_{0} - \\epsilon $$\nSubstituting the values:\n$$ \\psi_{h}^{\\text{lim}}(+1) = 2(1.0 \\times 10^{-2}) - 1.0 \\times 10^{-6} = 0.02 - 0.000001 = 0.019999 $$\nNow, we calculate the flux $F_{K,+}$ using $\\mu_0 = 8.0 \\times 10^{-1} = 0.8$:\n$$ F_{K,+} = (0.8) \\times (0.019999) = 0.0159992 $$\n\nThe problem requires rounding the final answers to six significant figures.\n1. $a_{0}^{\\text{lim}} = 1.0 \\times 10^{-2}$. Rounded to six significant figures, this is $1.00000 \\times 10^{-2}$.\n2. $a_{1}^{\\text{lim}} = 0.009999$. Rounded to six significant figures, this is $9.99900 \\times 10^{-3}$.\n3. $F_{K,+} = 0.0159992$. This number already has six significant figures, $1.59992 \\times 10^{-2}$.\n\nThe final answer is the row matrix $(a_{0}^{\\text{lim}}, a_{1}^{\\text{lim}}, F_{K,+})$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.00000 \\times 10^{-2}  9.99900 \\times 10^{-3}  1.59992 \\times 10^{-2} \\end{pmatrix} } $$"
        }
    ]
}