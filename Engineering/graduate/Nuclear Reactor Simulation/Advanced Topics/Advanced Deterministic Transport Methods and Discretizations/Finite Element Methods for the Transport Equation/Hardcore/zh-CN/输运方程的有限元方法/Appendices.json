{
    "hands_on_practices": [
        {
            "introduction": "有限元方法（FEM）的核心在于将复杂区域分解为简单的单元（如四面体）网格，并在这些单元上近似求解。此练习将带您亲手实践有限元方法中最基本的一项任务：在从“参考”单元到“物理”单元的仿射变换下，计算基函数的梯度。掌握通过雅可比矩阵变换计算梯度的能力，是实现中子输运方程中流算符 $\\boldsymbol{\\Omega} \\cdot \\nabla \\psi$ 离散化的关键一步 。",
            "id": "4225515",
            "problem": "考虑三维空间中的稳态单群中子输运方程，其中流算子表示为 $\\boldsymbol{\\Omega} \\cdot \\nabla \\psi(\\boldsymbol{x})$。在四面体网格上的连续有限元 (CFE) 离散化中，需要将基函数从参考四面体映射到物理四面体单元的梯度，以在求积点处评估方向导数 $\\boldsymbol{\\Omega} \\cdot \\nabla \\varphi$，从而组合流项的贡献。设参考四面体 $\\hat{T}$ 的顶点为 $\\hat{\\boldsymbol{v}}_{1}=(0,0,0)$、$\\hat{\\boldsymbol{v}}_{2}=(1,0,0)$、$\\hat{\\boldsymbol{v}}_{3}=(0,1,0)$ 和 $\\hat{\\boldsymbol{v}}_{4}=(0,0,1)$，$\\hat{T}$ 上的标准线性拉格朗日基函数为 $\\hat{\\varphi}_{1}(\\hat{\\boldsymbol{x}})=1-\\hat{\\xi}-\\hat{\\eta}-\\hat{\\zeta}$、$\\hat{\\varphi}_{2}(\\hat{\\boldsymbol{x}})=\\hat{\\xi}$、$\\hat{\\varphi}_{3}(\\hat{\\boldsymbol{x}})=\\hat{\\eta}$ 和 $\\hat{\\varphi}_{4}(\\hat{\\boldsymbol{x}})=\\hat{\\zeta}$，其中 $\\hat{\\boldsymbol{x}}=(\\hat{\\xi},\\hat{\\eta},\\hat{\\zeta})$。反应堆堆芯子区域中的一个物理四面体单元 $T$ 由顶点 $\\boldsymbol{v}_{1}=(1.2,-0.3,0.5)$、$\\boldsymbol{v}_{2}=(3.3,0.1,0.6)$、$\\boldsymbol{v}_{3}=(1.4,2.2,0.8)$ 和 $\\boldsymbol{v}_{4}=(0.7,-0.2,3.5)$ 定义，所有坐标均以厘米为单位。仿射映射 $\\boldsymbol{x}(\\hat{\\boldsymbol{x}})=\\boldsymbol{v}_{1}+\\mathbf{A}\\hat{\\boldsymbol{x}}$ 由雅可比矩阵 $\\mathbf{A}=[\\boldsymbol{v}_{2}-\\boldsymbol{v}_{1}\\ \\ \\boldsymbol{v}_{3}-\\boldsymbol{v}_{1}\\ \\ \\boldsymbol{v}_{4}-\\boldsymbol{v}_{1}]$ 定义，其中各列是从 $\\boldsymbol{v}_{1}$ 到其他顶点的边向量。假设粒子流方向是单位向量 $\\boldsymbol{\\Omega}=\\frac{1}{\\sqrt{3}}(1,-1,1)$，这是离散纵标 (SN) 角方向的典型值。使用仿射映射的链式法则和参考单元上梯度的定义，计算与顶点 $\\boldsymbol{v}_{1}$ 相关联的基函数的映射物理梯度 $\\nabla \\varphi_{1}(\\boldsymbol{x})$，并在以下四个具有相等权重的参考空间求积点处评估方向导数 $\\boldsymbol{\\Omega}\\cdot\\nabla\\varphi_{1}$：$\\hat{\\boldsymbol{x}}_{1}=(0,0,0)$、$\\hat{\\boldsymbol{x}}_{2}=(1,0,0)$、$\\hat{\\boldsymbol{x}}_{3}=(0,1,0)$ 和 $\\hat{\\boldsymbol{x}}_{4}=(0,0,1)$，每个权重为 $w_{q}=1/24$。最后，报告在映射的物理求积点处评估的四个 $\\boldsymbol{\\Omega}\\cdot\\nabla\\varphi_{1}$ 值的算术平均值。以反厘米为单位表示最终平均值，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求计算方向导数 $\\boldsymbol{\\Omega}\\cdot\\nabla\\varphi_{1}$ 在物理四面体单元内四个特定点上的算术平均值。这是输运问题中连续有限元法 (CFEM) 背景下的一个标准计算。\n\n由于基函数是线性的，并且从参考单元到物理单元的映射是仿射的，因此方向导数在整个单元中是恒定的。因此，在所有四个求积点处，方向导数的值将相同，算术平均值将等于此常数值。\n\n问题的核心是使用链式法则计算物理梯度 $\\nabla \\varphi_{1}(\\boldsymbol{x})$，该法则将其与参考单元上的梯度 $\\hat{\\nabla} \\hat{\\varphi}_{1}(\\hat{\\boldsymbol{x}})$ 相关联。该关系由下式给出：\n$$ \\nabla \\varphi_{1}(\\boldsymbol{x}) = (\\mathbf{A}^{-1})^{T} \\hat{\\nabla} \\hat{\\varphi}_{1}(\\hat{\\boldsymbol{x}}) $$\n其中 $\\mathbf{A}$ 是仿射映射 $\\boldsymbol{x}(\\hat{\\boldsymbol{x}}) = \\boldsymbol{v}_{1} + \\mathbf{A}\\hat{\\boldsymbol{x}}$ 的雅可比矩阵。\n\n**第 1 步：计算参考梯度**\n我们计算参考单元 $\\hat{T}$ 上基函数 $\\hat{\\varphi}_{1}$ 的梯度。基函数为 $\\hat{\\varphi}_{1}(\\hat{\\boldsymbol{x}}) = 1 - \\hat{\\xi} - \\hat{\\eta} - \\hat{\\zeta}$，其中 $\\hat{\\boldsymbol{x}}=(\\hat{\\xi},\\hat{\\eta},\\hat{\\zeta})$。其梯度为：\n$$ \\hat{\\nabla} \\hat{\\varphi}_{1} = \\begin{pmatrix} \\frac{\\partial \\hat{\\varphi}_{1}}{\\partial \\hat{\\xi}} \\\\ \\frac{\\partial \\hat{\\varphi}_{1}}{\\partial \\hat{\\eta}} \\\\ \\frac{\\partial \\hat{\\varphi}_{1}}{\\partial \\hat{\\zeta}} \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix} $$\n\n**第 2 步：构建雅可比矩阵**\n我们根据物理单元 $T$ 的顶点构造雅可比矩阵 $\\mathbf{A}$。顶点为 $\\boldsymbol{v}_{1}=(1.2, -0.3, 0.5)$、$\\boldsymbol{v}_{2}=(3.3, 0.1, 0.6)$、$\\boldsymbol{v}_{3}=(1.4, 2.2, 0.8)$ 和 $\\boldsymbol{v}_{4}=(0.7, -0.2, 3.5)$。$\\mathbf{A}$ 的列是从 $\\boldsymbol{v}_{1}$ 出发的边向量：\n$$ \\boldsymbol{v}_{2}-\\boldsymbol{v}_{1} = \\begin{pmatrix} 2.1 \\\\ 0.4 \\\\ 0.1 \\end{pmatrix}, \\quad \\boldsymbol{v}_{3}-\\boldsymbol{v}_{1} = \\begin{pmatrix} 0.2 \\\\ 2.5 \\\\ 0.3 \\end{pmatrix}, \\quad \\boldsymbol{v}_{4}-\\boldsymbol{v}_{1} = \\begin{pmatrix} -0.5 \\\\ 0.1 \\\\ 3.0 \\end{pmatrix} $$\n因此，雅可比矩阵为：\n$$ \\mathbf{A} = \\begin{pmatrix} 2.1  0.2  -0.5 \\\\ 0.4  2.5  0.1 \\\\ 0.1  0.3  3.0 \\end{pmatrix} $$\n\n**第 3 步：计算物理梯度**\n为了找到物理梯度，我们需要计算 $(\\mathbf{A}^{-1})^{T} \\hat{\\nabla} \\hat{\\varphi}_{1}$。我们可以先求 $\\mathbf{A}$ 的逆，再转置，或者使用伴随矩阵法。\n$\\mathbf{A}$ 的行列式为：\n$$ \\det(\\mathbf{A}) = 2.1(2.5 \\cdot 3.0 - 0.1 \\cdot 0.3) - 0.2(0.4 \\cdot 3.0 - 0.1 \\cdot 0.1) - 0.5(0.4 \\cdot 0.3 - 2.5 \\cdot 0.1) $$\n$$ \\det(\\mathbf{A}) = 2.1(7.47) - 0.2(1.19) - 0.5(-0.13) = 15.687 - 0.238 + 0.065 = 15.514 $$\n$\\mathbf{A}$ 的代数余子式矩阵 $\\mathbf{C}$ 为：\n$$ \\mathbf{C} = \\begin{pmatrix} 7.47  -1.19  -0.13 \\\\ -0.75  6.35  -0.61 \\\\ 1.27  -0.41  5.17 \\end{pmatrix} $$\n物理梯度由下式给出：\n$$ \\nabla \\varphi_{1} = (\\mathbf{A}^{-1})^{T} \\hat{\\nabla} \\hat{\\varphi}_{1} = \\frac{1}{\\det(\\mathbf{A})} \\mathbf{C} \\hat{\\nabla} \\hat{\\varphi}_{1} $$\n$$ \\nabla \\varphi_{1} = \\frac{1}{15.514} \\begin{pmatrix} 7.47  -1.19  -0.13 \\\\ -0.75  6.35  -0.61 \\\\ 1.27  -0.41  5.17 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix} = \\frac{-1}{15.514} \\begin{pmatrix} 7.47 - 1.19 - 0.13 \\\\ -0.75 + 6.35 - 0.61 \\\\ 1.27 - 0.41 + 5.17 \\end{pmatrix} $$\n$$ \\nabla \\varphi_{1} = \\frac{-1}{15.514} \\begin{pmatrix} 6.15 \\\\ 4.99 \\\\ 6.03 \\end{pmatrix} = \\begin{pmatrix} -0.396416 \\\\ -0.321645 \\\\ -0.388681 \\end{pmatrix} \\text{ cm}^{-1} $$\n\n**第 4 步：计算方向导数**\n最后一步是计算方向导数 $\\boldsymbol{\\Omega} \\cdot \\nabla \\varphi_{1}$。流方向为 $\\boldsymbol{\\Omega} = \\frac{1}{\\sqrt{3}}(1, -1, 1)$。\n$$ \\boldsymbol{\\Omega} \\cdot \\nabla \\varphi_{1} = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix} \\cdot \\left( \\frac{-1}{15.514} \\begin{pmatrix} 6.15 \\\\ 4.99 \\\\ 6.03 \\end{pmatrix} \\right) $$\n$$ \\boldsymbol{\\Omega} \\cdot \\nabla \\varphi_{1} = \\frac{-1}{\\sqrt{3} \\cdot 15.514} [1(6.15) + (-1)(4.99) + 1(6.03)] $$\n$$ \\boldsymbol{\\Omega} \\cdot \\nabla \\varphi_{1} = \\frac{-1}{\\sqrt{3} \\cdot 15.514} [6.15 - 4.99 + 6.03] = \\frac{-7.19}{15.514 \\sqrt{3}} $$\n该值在整个单元上是恒定的。因此，四个求积点中的每一个点的值都是相同的，它们的算术平均值就是这个值。\n\n计算数值结果：\n$$ \\text{平均值} = \\frac{-7.19}{26.87083...} \\approx -0.267573 \\text{ cm}^{-1} $$\n四舍五入到四位有效数字，我们得到 $-0.2676$。",
            "answer": "$$ \\boxed{-0.2676} $$"
        },
        {
            "introduction": "间断伽辽金（DG）方法因其局部守恒和处理复杂几何的灵活性，在求解输运方程中广受欢迎。其核心特征之一是在单元交界面上定义的“数值通量”，这取决于粒子是流入还是流出单元。本练习将帮助您厘清“入流”与“出流”这两个关键概念 ，通过一个简单的矩形区域，您将具体理解粒子方向 $\\boldsymbol{\\Omega}$ 与边界法向量 $\\mathbf{n}$ 如何决定了DG弱形式中边界项的处理方式。",
            "id": "4225529",
            "problem": "考虑一个矩形反应堆组件子域中的稳态单能中子输运方程，其边界为真空边界。设物理域为 $D = [0,L_{x}] \\times [0,L_{y}] \\times [0,L_{z}] \\subset \\mathbb{R}^{3}$，其边界 $\\partial D$ 上的外法向单位向量为 $\\mathbf{n}$。中子角通量用 $\\psi(\\mathbf{x},\\boldsymbol{\\Omega})$ 表示，总宏观截面用 $\\Sigma_{t}(\\mathbf{x})$ 表示，体源用 $q(\\mathbf{x},\\boldsymbol{\\Omega})$ 表示。基本平衡定律为\n$$\n\\boldsymbol{\\Omega} \\cdot \\nabla \\psi(\\mathbf{x},\\boldsymbol{\\Omega}) + \\Sigma_{t}(\\mathbf{x}) \\psi(\\mathbf{x},\\boldsymbol{\\Omega}) = q(\\mathbf{x},\\boldsymbol{\\Omega}) \\quad \\text{in } D,\n$$\n对于给定的飞行方向 $\\boldsymbol{\\Omega} \\in \\mathbb{S}^{2}$。\n\n在间断伽辽金 (DG) 有限元格式中，使用试函数 $v(\\mathbf{x},\\boldsymbol{\\Omega})$ 并对流项在 $D$ 上进行分部积分，边界贡献项涉及迎风数值通量，并在边界的流入部分上写出。流入边界集定义为\n$$\n\\Gamma_{-} := \\left\\{ \\mathbf{x} \\in \\partial D \\,:\\, \\boldsymbol{\\Omega} \\cdot \\mathbf{n}(\\mathbf{x})  0 \\right\\}.\n$$\n对于真空边界条件，入射角通量为零，即\n$$\n\\psi^{b}(\\mathbf{x},\\boldsymbol{\\Omega}) = 0 \\quad \\text{on } \\Gamma_{-}.\n$$\n\n设飞行方向固定为 $\\boldsymbol{\\Omega} = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right)$。通过在长方体盒子的每个面上计算 $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}$，确定矩形边界 $\\partial D$ 的哪些面属于流入集 $\\Gamma_{-}$。然后，写出在 DG 弱形式中出现的流入边界积分项\n$$\n\\int_{\\Gamma_{-}} \\left( - \\boldsymbol{\\Omega} \\cdot \\mathbf{n} \\right) \\, \\psi^{b} \\, v \\, \\mathrm{d}S,\n$$\n并在真空边界条件下对其进行简化。你的最终答案必须是单一的实数值或单一的闭式解析表达式。由于所求表达式是无量纲的，因此不需要单位。如果你的最终结果是精确值，请不要四舍五入。",
            "solution": "目标是对于给定的飞行方向 $\\boldsymbol{\\Omega}$，确定矩形域 $D$ 的流入面，然后在真空边界条件下计算给定的边界积分项。\n\n该域是一个长方体 $D = [0, L_x] \\times [0, L_y] \\times [0, L_z]$。其边界 $\\partial D$ 由六个平面组成。我们必须确定每个面的外法向单位向量 $\\mathbf{n}$。\n\n六个面及其对应的外法向单位向量如下：\n1.  位于 $x=0$ 的面： $\\mathbf{n}_1 = (-1, 0, 0)$\n2.  位于 $x=L_x$ 的面： $\\mathbf{n}_2 = (1, 0, 0)$\n3.  位于 $y=0$ 的面： $\\mathbf{n}_3 = (0, -1, 0)$\n4.  位于 $y=L_y$ 的面： $\\mathbf{n}_4 = (0, 1, 0)$\n5.  位于 $z=0$ 的面： $\\mathbf{n}_5 = (0, 0, -1)$\n6.  位于 $z=L_z$ 的面： $\\mathbf{n}_6 = (0, 0, 1)$\n\n中子飞行的固定方向为 $\\boldsymbol{\\Omega} = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right)$。\n\n根据定义，流入边界 $\\Gamma_{-}$ 由 $\\partial D$ 上所有满足 $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}(\\mathbf{x})  0$ 的点 $\\mathbf{x}$ 组成。我们为六个面中的每一个计算这个点积：\n\n1.  位于 $x=0$ 的面：\n    $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_1 = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right) \\cdot (-1, 0, 0) = -\\frac{1}{\\sqrt{2}}$。\n    由于 $-\\frac{1}{\\sqrt{2}}  0$，该面是流入边界 $\\Gamma_{-}$ 的一部分。\n\n2.  位于 $x=L_x$ 的面：\n    $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_2 = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right) \\cdot (1, 0, 0) = \\frac{1}{\\sqrt{2}}$。\n    由于 $\\frac{1}{\\sqrt{2}}  0$，这是一个流出面。\n\n3.  位于 $y=0$ 的面：\n    $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_3 = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right) \\cdot (0, -1, 0) = -\\frac{1}{\\sqrt{2}}$。\n    由于 $-\\frac{1}{\\sqrt{2}}  0$，该面也是流入边界 $\\Gamma_{-}$ 的一部分。\n\n4.  位于 $y=L_y$ 的面：\n    $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_4 = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right) \\cdot (0, 1, 0) = \\frac{1}{\\sqrt{2}}$。\n    由于 $\\frac{1}{\\sqrt{2}}  0$，这是一个流出面。\n\n5.  位于 $z=0$ 的面：\n    $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_5 = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right) \\cdot (0, 0, -1) = 0$。\n    由于点积不严格为负，这不是一个流入面。它是一个切向边界或特征边界。\n\n6.  位于 $z=L_z$ 的面：\n    $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_6 = \\left( \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0 \\right) \\cdot (0, 0, 1) = 0$。\n    这也是一个切向边界。\n\n因此，流入边界集 $\\Gamma_{-}$ 是满足流入条件的两个面的并集：\n$$\n\\Gamma_{-} = \\left\\{ (0, y, z) \\,:\\, y \\in [0,L_y], z \\in [0,L_z] \\right\\} \\cup \\left\\{ (x, 0, z) \\,:\\, x \\in [0,L_x], z \\in [0,L_z] \\right\\}.\n$$\n\n接下来，我们必须计算指定的流入边界积分项：\n$$\nI = \\int_{\\Gamma_{-}} \\left( - \\boldsymbol{\\Omega} \\cdot \\mathbf{n} \\right) \\, \\psi^{b} \\, v \\, \\mathrm{d}S.\n$$\n问题指出应用了真空边界条件。该条件形式上给出为对于所有 $\\mathbf{x} \\in \\Gamma_{-}$，$\\psi^{b}(\\mathbf{x},\\boldsymbol{\\Omega}) = 0$，其中 $\\psi^{b}$ 是在边界上规定的入射角通量。\n\n将 $\\psi^{b} = 0$ 代入被积函数，积分变为：\n$$\nI = \\int_{\\Gamma_{-}} \\left( - \\boldsymbol{\\Omega} \\cdot \\mathbf{n} \\right) \\, (0) \\, v(\\mathbf{x}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}S.\n$$\n对于所有点 $\\mathbf{x} \\in \\Gamma_{-}$ 和任何任意的试函数 $v$，被积函数恒为零。零函数在任何域上的积分都为零。\n$$\nI = \\int_{\\Gamma_{-}} 0 \\, \\mathrm{d}S = 0.\n$$\n因此，在真空边界条件下，流入边界积分项简化为 $0$。这是输运方程的 DG 方法中的一个基本结果：对于真空边界，与入射通量对应的边界项消失。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "尽管像DG这样的高阶方法能提供精确的解，但它们有时会产生非物理的结果，例如负的角通量。为了构建稳健的模拟工具，我们需要引入技术来修正这些问题，同时保持粒子数守恒等重要的物理性质。本练习将向您介绍一种实用且重要的高级技术：保正限制器 。您将对一个出现负值的线性DG解应用该限制器，学习如何在不改变单元平均通量的前提下调整解以保证其非负性，这是维持计算精度的关键。",
            "id": "4225471",
            "problem": "考虑一维、稳态、单能中子输运方程的平板几何形式，\n$$\\mu \\,\\frac{d \\psi(x,\\mu)}{dx} + \\sigma_{t}(x)\\,\\psi(x,\\mu) = q(x,\\mu),$$\n其中 $\\psi(x,\\mu)$ 是角通量，$\\mu \\in [-1,1]$ 是粒子飞行方向的余弦，$\\sigma_{t}(x)$ 是总宏观截面，而 $q(x,\\mu)$ 是已知源。在不连续 Galerkin (DG) 有限元近似（使用不连续试探空间的有限元法 (FEM)）中，考虑一个单元 $K$，它通过仿射映射到参考区间 $\\xi \\in [-1,1]$。在单元 $K$ 上，对于固定的方向 $\\mu = \\mu_{0}  0$，角通量的 DG 模态表示是线性的：\n$$\\psi_{h}(\\xi;\\mu_{0}) = a_{0} + a_{1}\\,\\xi,$$\n其中 $a_{0}$ 等于单元平均值，$a_{1}$ 是模态斜率系数。假设当前的 DG 解在左侧面 $\\xi=-1$ 处出现一个小的负值下冲，其中\n$$a_{0} = 1.0 \\times 10^{-2}, \\quad a_{1} = 1.5 \\times 10^{-2}, \\quad \\mu_{0} = 8.0 \\times 10^{-1}.$$\n为强制实现物理非负性，应用一个保正限制器，该限制器在保持单元平均值不变的同时，将与单元平均值的偏差按因子 $\\theta \\in [0,1]$ 进行缩放。正值容差为\n$$\\epsilon = 1.0 \\times 10^{-6}.$$\n假设限制前的左侧面值是单元内的最小值，确定限制因子，使得限制后的左侧面值恰好为 $\\epsilon$，同时保持平均值不变。然后计算调整后的系数 $(a_{0}^{\\text{lim}}, a_{1}^{\\text{lim}})$ 以及在右侧面 $\\xi=+1$ 处由对流项产生的迎风数值面通量，对于 $\\mu_{0}  0$ 其定义为\n$$F_{K,+} = \\mu_{0}\\,\\psi_{h}^{-}(+1;\\mu_{0}),$$\n其中 $\\psi_{h}^{-}$ 表示来自单元 $K$ 的内部迹。将最终答案的各项四舍五入到六位有效数字，并将通量以“中子数/平方厘米/秒”为单位表示。将最终答案以单行矩阵的形式给出，按顺序包含 $a_{0}^{\\text{lim}}$、$a_{1}^{\\text{lim}}$ 和 $F_{K,+}$。",
            "solution": "在单个单元中，映射到参考区间 $\\xi \\in [-1,1]$ 的角通量 $\\psi_{h}$，对于一个固定的方向 $\\mu_{0}$，由线性模态表示给出：\n$$ \\psi_{h}(\\xi;\\mu_{0}) = a_{0} + a_{1}\\,\\xi $$\n系数 $a_{0}$ 代表单元平均通量。给定的初始系数为 $a_{0} = 1.0 \\times 10^{-2}$ 和 $a_{1} = 1.5 \\times 10^{-2}$。\n由于斜率系数 $a_{1}$ 为正，线性函数 $\\psi_{h}(\\xi)$ 在区间 $\\xi \\in [-1,1]$ 上是单调递增的。因此，其最小值出现在左侧面 $\\xi=-1$ 处。\n在左侧面的通量值为：\n$$ \\psi_{h}(-1) = a_{0} + a_{1}(-1) = a_{0} - a_{1} = 1.0 \\times 10^{-2} - 1.5 \\times 10^{-2} = -0.005 $$\n该值为负，不符合物理实际，因此需要应用保正限制器。\n\n限制器被设计为在保持单元平均值 $a_{0}$ 本身不变的同时，将与单元平均值的偏差按因子 $\\theta \\in [0,1]$ 进行缩放。与平均值的偏差为 $\\psi_{h}(\\xi) - a_{0} = a_{1}\\xi$。那么，限制后的通量 $\\psi_{h}^{\\text{lim}}(\\xi)$ 为：\n$$ \\psi_{h}^{\\text{lim}}(\\xi) = a_{0} + \\theta (\\psi_{h}(\\xi) - a_{0}) = a_{0} + \\theta(a_{1}\\xi) $$\n这可以写成与原始通量相同的模态形式：\n$$ \\psi_{h}^{\\text{lim}}(\\xi) = a_{0}^{\\text{lim}} + a_{1}^{\\text{lim}}\\xi $$\n通过比较 $\\psi_{h}^{\\text{lim}}(\\xi)$ 的两个表达式，我们得到调整后的系数：\n$$ a_{0}^{\\text{lim}} = a_{0}, \\quad a_{1}^{\\text{lim}} = \\theta a_{1} $$\n该限制器保持了单元平均值。\n\n问题要求确定限制因子 $\\theta$，使得左侧面的限制后值 $\\psi_{h}^{\\text{lim}}(-1)$ 恰好等于正值容差 $\\epsilon = 1.0 \\times 10^{-6}$。\n在 $\\xi=-1$ 处的限制后通量值为：\n$$ \\psi_{h}^{\\text{lim}}(-1) = a_{0}^{\\text{lim}} + a_{1}^{\\text{lim}}(-1) = a_{0} - \\theta a_{1} $$\n我们令此值等于 $\\epsilon$：\n$$ a_{0} - \\theta a_{1} = \\epsilon $$\n求解 $\\theta$：\n$$ \\theta a_{1} = a_{0} - \\epsilon \\implies \\theta = \\frac{a_{0} - \\epsilon}{a_{1}} $$\n代入给定值：\n$$ \\theta = \\frac{1.0 \\times 10^{-2} - 1.0 \\times 10^{-6}}{1.5 \\times 10^{-2}} = \\frac{0.009999}{0.015} = 0.6666 $$\n由于 $0 \\leq 0.6666 \\leq 1$，这是一个有效的限制因子。\n\n现在我们计算调整后的系数 $(a_{0}^{\\text{lim}}, a_{1}^{\\text{lim}})$。\n单元平均值保持不变：\n$$ a_{0}^{\\text{lim}} = a_{0} = 1.0 \\times 10^{-2} $$\n调整后的斜率系数为：\n$$ a_{1}^{\\text{lim}} = \\theta a_{1} = \\left(\\frac{a_{0} - \\epsilon}{a_{1}}\\right) a_{1} = a_{0} - \\epsilon $$\n$$ a_{1}^{\\text{lim}} = 1.0 \\times 10^{-2} - 1.0 \\times 10^{-6} = 0.009999 $$\n\n最后，我们计算单元右侧面 $\\xi=+1$ 处的迎风数值面通量。对于 $\\mu_0  0$，迎风通量由来自单元 $K$ 的内部迹确定，即限制后解在右侧面边界处的值。\n$$ F_{K,+} = \\mu_{0}\\,\\psi_{h}^{-}(+1;\\mu_{0}) = \\mu_{0}\\,\\psi_{h}^{\\text{lim}}(+1) $$\n在 $\\xi=+1$ 处的限制后通量值为：\n$$ \\psi_{h}^{\\text{lim}}(+1) = a_{0}^{\\text{lim}} + a_{1}^{\\text{lim}}(+1) = a_{0} + (a_{0} - \\epsilon) = 2a_{0} - \\epsilon $$\n代入数值：\n$$ \\psi_{h}^{\\text{lim}}(+1) = 2(1.0 \\times 10^{-2}) - 1.0 \\times 10^{-6} = 0.02 - 0.000001 = 0.019999 $$\n现在，我们使用 $\\mu_0 = 8.0 \\times 10^{-1} = 0.8$ 计算通量 $F_{K,+}$：\n$$ F_{K,+} = (0.8) \\times (0.019999) = 0.0159992 $$\n\n问题要求将最终答案四舍五入到六位有效数字。\n1. $a_{0}^{\\text{lim}} = 1.0 \\times 10^{-2}$，四舍五入为 $1.00000 \\times 10^{-2}$。\n2. $a_{1}^{\\text{lim}} = 0.009999$，四舍五入为 $9.99900 \\times 10^{-3}$。\n3. $F_{K,+} = 0.0159992$，四舍五入为 $1.59992 \\times 10^{-2}$。\n\n最终答案是行矩阵 $(a_{0}^{\\text{lim}}, a_{1}^{\\text{lim}}, F_{K,+})$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.00000 \\times 10^{-2}  9.99900 \\times 10^{-3}  1.59992 \\times 10^{-2} \\end{pmatrix} } $$"
        }
    ]
}