{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在建立晶体微观能量形貌与塑性变形动力学之间的基本联系。通过对皮尔斯势和外加应力效应进行建模，您将推导出位错滑移的激活焓，这是热激活流动理论中的一个关键参数。该练习  为理解温度和应力如何在原子尺度上协同促成塑性变形提供了坚实的数学基础。",
            "id": "3755771",
            "problem": "晶体固体中位错运动的一个关键阻力是源于皮尔斯势垒的晶格摩擦。在高熵合金（HEAs）中，局域晶格畸变和化学无序会改变势垒的振幅，但热激活滑移的基本机制仍然由过渡态理论控制。考虑一个位于体心立方（BCC）高熵合金中的单位线长直螺型位错段，其柏氏矢量模为 $b$。沿反应坐标 $x$ 的滑移焓景可以用一个周期性的皮尔斯势和一个由分解切应力 $\\tau$ 引起的外部倾斜来建模，使得单位线长的焓为\n$$\nH(x) = U_{0}\\left[1 - \\cos\\left(\\frac{2\\pi x}{b}\\right)\\right] - \\tau\\, b\\, x,\n$$\n其中 $U_{0} > 0$ 是每个周期 $b$ 内皮尔斯势的振幅。在过渡态理论和塑性应变率的阿伦尼乌斯描述 $\\dot{\\epsilon} \\propto \\exp\\!\\left[-\\Delta H(\\tau)/k_{B}T\\right]$ 的框架内，激活焓 $\\Delta H(\\tau)$ 定义为一个周期内鞍点的焓与最近的 $H(x)$ 局域极小值点焓之差。从上述焓景和基本微积分（驻点及其二阶导数分类）出发，推导激活焓 $\\Delta H(\\tau)$ 对 $\\tau$ 的闭合形式函数依赖关系，用零应力势垒 $\\Delta H_{0}$ 和皮尔斯应力 $\\tau_{P}$ 表示，其中 $\\tau_{P}$ 定义为势垒消失时的 $\\tau$ 值。将您的最终答案表示为在 $0 \\le \\tau \\le \\tau_{P}$ 范围内有效的单个解析表达式。无需进行数值计算，也无需四舍五入。仅使用解析函数，并用 $\\Delta H_{0}$、$\\tau$ 和 $\\tau_{P}$ 写出 $\\Delta H(\\tau)$ 的最终表达式，所有数学实体均用 LaTeX 书写。",
            "solution": "问题给出了螺型位错段单位线长的焓 $H(x)$，作为其沿滑移方向位置 $x$ 的函数。该焓景是周期性皮尔斯势与由外部自分解切应力 $\\tau$ 引起的线性倾斜的叠加。其表达式为：\n$$\nH(x) = U_{0}\\left[1 - \\cos\\left(\\frac{2\\pi x}{b}\\right)\\right] - \\tau\\, b\\, x\n$$\n其中 $U_0 > 0$ 是势的振幅，$b$ 是柏氏矢量的模，对应于势的周期。\n\n位错滑移的激活焓 $\\Delta H(\\tau)$ 是位错从一个稳定平衡位置（$H(x)$ 的局域极小值点）移动到一个不稳定位置（$H(x)$ 的鞍点）所必须克服的能垒。为了找到这些位置，我们必须首先通过将其对 $x$ 的一阶导数设为零来找到 $H(x)$ 的驻点。\n\n$H(x)$ 的一阶导数为：\n$$\n\\frac{dH}{dx} = U_{0}\\left(\\frac{2\\pi}{b}\\right)\\sin\\left(\\frac{2\\pi x}{b}\\right) - \\tau b\n$$\n令 $\\frac{dH}{dx} = 0$ 给出驻点的条件：\n$$\n\\sin\\left(\\frac{2\\pi x}{b}\\right) = \\frac{\\tau b^2}{2\\pi U_0}\n$$\n\n为了将这些驻点分类为极小值点或鞍点（在这种一维情况下是极大值点），我们检查二阶导数 $\\frac{d^2H}{dx^2}$ 的符号：\n$$\n\\frac{d^2H}{dx^2} = U_{0}\\left(\\frac{2\\pi}{b}\\right)^2\\cos\\left(\\frac{2\\pi x}{b}\\right)\n$$\n局域极小值对应于 $\\frac{d^2H}{dx^2} > 0$，这意味着 $\\cos\\left(\\frac{2\\pi x}{b}\\right) > 0$。\n鞍点对应于 $\\frac{d^2H}{dx^2} < 0$，这意味着 $\\cos\\left(\\frac{2\\pi x}{b}\\right) < 0$。\n\n首先，我们确定零应力激活势垒 $\\Delta H_0$。这是当 $\\tau = 0$ 时的势垒。对于 $\\tau=0$，驻点的条件变为 $\\sin\\left(\\frac{2\\pi x}{b}\\right) = 0$。这发生在 $\\frac{2\\pi x}{b} = n\\pi$（其中 $n$ 为任意整数），即 $x = n\\frac{b}{2}$。\n-   对于偶数 $n$（例如，$x=0, b, ...$），$\\cos\\left(\\frac{2\\pi x}{b}\\right) = 1$，所以 $\\frac{d^2H}{dx^2} > 0$。这些是能量极小值点。焓为 $H_{min} = U_0(1-1) - 0 = 0$。\n-   对于奇数 $n$（例如，$x=b/2, 3b/2, ...$），$\\cos\\left(\\frac{2\\pi x}{b}\\right) = -1$，所以 $\\frac{d^2H}{dx^2} < 0$。这些是鞍点。焓为 $H_{sad} = U_0(1-(-1)) - 0 = 2U_0$。\n因此，零应力势垒为：\n$$\n\\Delta H_0 = H_{sad} - H_{min} = 2U_0 - 0 = 2U_0\n$$\n\n接下来，我们确定皮尔斯应力 $\\tau_P$，即激活势垒消失时的应力。这发生在极小值点和鞍点合并成一个拐点时，此时 $\\frac{dH}{dx} = 0$ 和 $\\frac{d^2H}{dx^2} = 0$ 同时满足。\n由 $\\frac{d^2H}{dx^2} = 0$，我们有 $\\cos\\left(\\frac{2\\pi x}{b}\\right) = 0$。对于这样的位置，$\\left|\\sin\\left(\\frac{2\\pi x}{b}\\right)\\right|=1$。将此代入驻点条件，得到晶格阻力能平衡的最大可能应力：\n$$\n1 = \\frac{\\tau_P b^2}{2\\pi U_0} \\implies \\tau_P = \\frac{2\\pi U_0}{b^2}\n$$\n\n现在，我们推导任意应力 $0 \\le \\tau \\le \\tau_P$ 下的激活焓 $\\Delta H(\\tau)$。我们可以定义一个归一化应力 $\\sigma = \\frac{\\tau}{\\tau_P}$。使用 $\\tau_P$ 和 $U_0$ 的表达式：\n$$\n\\sigma = \\frac{\\tau}{\\tau_P} = \\frac{\\tau}{2\\pi U_0 / b^2} = \\frac{\\tau b^2}{2\\pi U_0}\n$$\n驻点条件变为 $\\sin\\left(\\frac{2\\pi x}{b}\\right) = \\sigma$。因为 $0 \\le \\tau \\le \\tau_P$，我们有 $0 \\le \\sigma \\le 1$。\n在区间 $[0, \\pi]$ 中，对于 $\\theta = \\frac{2\\pi x}{b}$ 有两个解：\n1.  $\\theta_{min} = \\arcsin(\\sigma)$。此处，$\\cos(\\theta_{min}) = \\sqrt{1-\\sigma^2} > 0$，所以这是一个局域极小值点，$x_{min} = \\frac{b}{2\\pi}\\arcsin(\\sigma)$。\n2.  $\\theta_{sad} = \\pi - \\arcsin(\\sigma)$。此处，$\\cos(\\theta_{sad}) = -\\sqrt{1-\\sigma^2} < 0$，所以这是一个鞍点，$x_{sad} = \\frac{b}{2\\pi}(\\pi - \\arcsin(\\sigma))$。\n\n激活焓为 $\\Delta H(\\tau) = H(x_{sad}) - H(x_{min})$：\n$$\n\\Delta H(\\tau) = \\left( U_0\\left(1-\\cos\\theta_{sad}\\right) - \\tau b x_{sad} \\right) - \\left( U_0\\left(1-\\cos\\theta_{min}\\right) - \\tau b x_{min} \\right)\n$$\n$$\n\\Delta H(\\tau) = U_0 \\left(\\cos\\theta_{min} - \\cos\\theta_{sad}\\right) - \\tau b \\left(x_{sad} - x_{min}\\right)\n$$\n代入各项：\n- $\\cos\\theta_{min} - \\cos\\theta_{sad} = \\sqrt{1-\\sigma^2} - (-\\sqrt{1-\\sigma^2}) = 2\\sqrt{1-\\sigma^2}$。\n- $x_{sad} - x_{min} = \\frac{b}{2\\pi}[(\\pi - \\arcsin\\sigma) - \\arcsin\\sigma] = \\frac{b}{2\\pi}(\\pi - 2\\arcsin\\sigma)$。\n- $\\tau b = \\sigma \\tau_P b = \\sigma \\frac{2\\pi U_0}{b^2} b = \\sigma \\frac{2\\pi U_0}{b}$。\n\n将这些代入 $\\Delta H(\\tau)$ 的表达式中：\n$$\n\\Delta H(\\tau) = U_0 \\left(2\\sqrt{1-\\sigma^2}\\right) - \\left(\\sigma \\frac{2\\pi U_0}{b}\\right) \\left(\\frac{b}{2\\pi}(\\pi - 2\\arcsin\\sigma)\\right)\n$$\n$$\n\\Delta H(\\tau) = 2U_0\\sqrt{1-\\sigma^2} - \\sigma U_0 (\\pi - 2\\arcsin\\sigma)\n$$\n$$\n\\Delta H(\\tau) = 2U_0\\left[\\sqrt{1-\\sigma^2} - \\frac{\\pi}{2}\\sigma + \\sigma\\arcsin\\sigma\\right]\n$$\n现在，我们用 $\\Delta H_0 = 2U_0$ 和 $\\sigma = \\tau/\\tau_P$ 来表示此式：\n$$\n\\Delta H(\\tau) = \\Delta H_0 \\left[\\sqrt{1-\\left(\\frac{\\tau}{\\tau_P}\\right)^2} - \\frac{\\pi}{2}\\frac{\\tau}{\\tau_P} + \\frac{\\tau}{\\tau_P}\\arcsin\\left(\\frac{\\tau}{\\tau_P}\\right)\\right]\n$$\n为了得到更简洁的形式，我们使用恒等式 $\\arcsin(z) + \\arccos(z) = \\frac{\\pi}{2}$，这给出 $\\arcsin(z) = \\frac{\\pi}{2} - \\arccos(z)$。\n$$\n\\Delta H(\\tau) = \\Delta H_0 \\left[\\sqrt{1-\\left(\\frac{\\tau}{\\tau_P}\\right)^2} - \\frac{\\pi}{2}\\frac{\\tau}{\\tau_P} + \\frac{\\tau}{\\tau_P}\\left(\\frac{\\pi}{2} - \\arccos\\left(\\frac{\\tau}{\\tau_P}\\right)\\right)\\right]\n$$\n$$\n\\Delta H(\\tau) = \\Delta H_0 \\left[\\sqrt{1-\\left(\\frac{\\tau}{\\tau_P}\\right)^2} - \\frac{\\pi}{2}\\frac{\\tau}{\\tau_P} + \\frac{\\pi}{2}\\frac{\\tau}{\\tau_P} - \\frac{\\tau}{\\tau_P}\\arccos\\left(\\frac{\\tau}{\\tau_P}\\right)\\right]\n$$\n包含 $\\pi$ 的项相互抵消，得到最终表达式：\n$$\n\\Delta H(\\tau) = \\Delta H_0 \\left[\\sqrt{1-\\left(\\frac{\\tau}{\\tau_P}\\right)^2} - \\frac{\\tau}{\\tau_P}\\arccos\\left(\\frac{\\tau}{\\tau_P}\\right)\\right]\n$$\n这就是激活焓 $\\Delta H(\\tau)$ 对外加应力 $\\tau$ 的闭合形式函数依赖关系，用零应力势垒 $\\Delta H_0$ 和皮尔斯应力 $\\tau_P$ 表示。",
            "answer": "$$\n\\boxed{\\Delta H_{0}\\left[\\sqrt{1 - \\left(\\frac{\\tau}{\\tau_{P}}\\right)^{2}} - \\frac{\\tau}{\\tau_{P}}\\arccos\\left(\\frac{\\tau}{\\tau_{P}}\\right)\\right]}\n$$"
        },
        {
            "introduction": "超越理想化的模型，本练习将探讨体心立方（BCC）晶体中位错运动的复杂性，这种晶体的行为常常违背简单的施密特法则。您将分析非滑移应力分量如何影响位错核心，从而导致正向和反向滑移的临界分切应力出现不对称性。该练习  对于理解和模拟许多先进材料（包括在此类非施密特效应显著的难熔高熵合金）的力学响应至关重要。",
            "id": "3755804",
            "problem": "一种体心立方（BCC）难熔高熵合金（HEA）的螺位错在 $\\{110\\}\\langle 111\\rangle$ 滑移系上滑移时，由于其位错核心对非滑移应力分量的敏感性，表现出显著的非施密特行为。考虑在低温下单个直螺位错，此时热激活过程可以忽略不计，其运动受晶格摩擦力控制。\n\n从以下基本原理出发：\n- 当驱动分解切应力等于晶格摩擦力（皮尔斯应力）时，位错发生移动，即 Peach–Koehler 力与最大晶格阻力之间达到力平衡。\n- 在具有非施密特行为的晶体中（如BCC），作用在位错核心上的有效驱动应力不仅是滑移系上的分解切应力，还包括与核心结构耦合的非滑移应力分量的线性贡献。\n\n设 $\\{110\\}\\langle 111\\rangle$ 螺位错的晶格摩擦力由皮尔斯应力 $\\tau_{P}$ 表征。有效驱动应力模型为\n$$\n\\tau_{\\mathrm{eff}} = \\tau + \\alpha \\,\\sigma_{n} + \\beta \\,\\tau_{\\perp},\n$$\n其中 $\\tau$ 是滑移系上的分解切应力，$\\sigma_{n}$ 是滑移面上的正应力，$\\tau_{\\perp}$ 是在滑移面内垂直于滑移方向的切应力。系数 $\\alpha$ 和 $\\beta$ 量化了位错核心对这些非滑移分量的敏感性，源于原子尺度的核心结构效应。\n\n单轴加载取向在活动滑移系上产生以下应力状态：\n- $\\tau_{P} = 0.95 \\,\\text{GPa}$，\n- $\\sigma_{n} = -1.00 \\,\\text{GPa}$ （压缩），\n- 对于正向滑移 $\\tau_{\\perp} = +0.18 \\,\\text{GPa}$，对于反向滑移 $\\tau_{\\perp} = -0.18 \\,\\text{GPa}$ （符号变化反映了切变相对于核心的方向），\n- $\\alpha = 0.12$, $\\beta = 0.35$。\n\n使用上述原理和参数，通过施加有效驱动应力等于晶格摩擦力的条件，推导出正向滑移的临界分解切应力 $\\tau_{c}^{+}$ 和反向滑移的临界分解切应力 $\\tau_{c}^{-}$ 的符号表达式。然后计算其不对称性\n$$\n\\Delta = \\tau_{c}^{-} - \\tau_{c}^{+}.\n$$\n简要解释为什么 $\\tau_{\\perp}$ 的符号变化会导致 $\\Delta \\neq 0$，并将其与核心结构耦合及晶格摩擦力联系起来。\n\n将 $\\Delta$ 的最终值以 $\\text{MPa}$ 表示，并四舍五入到四位有效数字。如果引入任何角度，请以弧度表示。最终答案必须是一个实数值。",
            "solution": "该问题要求推导并计算一种表现出非施密特行为的体心立方（BCC）高熵合金（HEA）中，螺位错的临界分解切应力（CRSS）的不对称性。解题过程首先是验证问题的有效性，然后执行所需的推导和计算。\n\n该问题被认为是有效的，因为它科学地基于BCC晶体中位错力学的既定理论，问题陈述清晰且提供了所有必要信息，并以客观方式表达。\n\n在低温下（热激活可忽略不计），位错运动的基本条件是有效驱动应力 $\\tau_{\\mathrm{eff}}$ 必须克服固有的晶格阻力，即皮尔斯应力 $\\tau_{P}$。这是一个力平衡条件。\n$$\n\\tau_{\\mathrm{eff}} = \\tau_{P}\n$$\n问题提供了一个考虑了非施密特效应的有效驱动应力模型，其中应力张量的非滑移分量会影响位错运动。该模型为：\n$$\n\\tau_{\\mathrm{eff}} = \\tau + \\alpha \\,\\sigma_{n} + \\beta \\,\\tau_{\\perp}\n$$\n此处，$\\tau$ 是滑移系 $\\{110\\}\\langle 111\\rangle$ 上的分解切应力，$\\sigma_{n}$ 是滑移面上的正应力，$\\tau_{\\perp}$ 是滑移面上垂直于滑移方向的切应力。系数 $\\alpha$ 和 $\\beta$ 量化了这些非滑移应力与位错核心的耦合程度。\n\n临界分解切应力 $\\tau_c$ 是位错开始运动时 $\\tau$ 的特定值。将 $\\tau_{\\mathrm{eff}}$ 的表达式代入力平衡条件，我们可以解出 $\\tau_c$：\n$$\n\\tau_{c} + \\alpha \\,\\sigma_{n} + \\beta \\,\\tau_{\\perp} = \\tau_{P}\n$$\n整理后得到CRSS的通用符号表达式：\n$$\n\\tau_{c} = \\tau_{P} - \\alpha \\,\\sigma_{n} - \\beta \\,\\tau_{\\perp}\n$$\n此方程表明，CRSS不是一个恒定的材料属性，而是通过非滑移分量 $\\sigma_n$ 和 $\\tau_{\\perp}$ 依赖于完整的应力状态。\n\n现在，我们将此通用表达式应用于正向和反向滑移的具体情况。问题指出，垂直切应力 $\\tau_{\\perp}$ 在这两种情况下符号相反。\n\n对于正向滑移，用上标 `+` 表示，应力分量按给定值代入。设 $\\tau_{\\perp, \\text{fwd}}$ 为正向滑移的值。正向滑移的临界分解切应力 $\\tau_c^{+}$ 为：\n$$\n\\tau_{c}^{+} = \\tau_{P} - \\alpha \\,\\sigma_{n} - \\beta \\,\\tau_{\\perp, \\text{fwd}}\n$$\n对于反向滑移，用上标 `-` 表示，$\\tau_{\\perp}$ 的符号反转。设 $\\tau_{\\perp, \\text{rev}}$ 为反向滑移的值，其中 $\\tau_{\\perp, \\text{rev}} = -\\tau_{\\perp, \\text{fwd}}$。反向滑移的CRSS $\\tau_c^{-}$ 为：\n$$\n\\tau_{c}^{-} = \\tau_{P} - \\alpha \\,\\sigma_{n} - \\beta \\,\\tau_{\\perp, \\text{rev}} = \\tau_{P} - \\alpha \\,\\sigma_{n} - \\beta \\,(-\\tau_{\\perp, \\text{fwd}})\n$$\n$$\n\\tau_{c}^{-} = \\tau_{P} - \\alpha \\,\\sigma_{n} + \\beta \\,\\tau_{\\perp, \\text{fwd}}\n$$\nCRSS的不对称性 $\\Delta$ 定义为反向滑移和正向滑移应力之差：\n$$\n\\Delta = \\tau_{c}^{-} - \\tau_{c}^{+}\n$$\n代入推导出的 $\\tau_c^{-}$ 和 $\\tau_c^{+}$ 的符号表达式：\n$$\n\\Delta = (\\tau_{P} - \\alpha \\,\\sigma_{n} + \\beta \\,\\tau_{\\perp, \\text{fwd}}) - (\\tau_{P} - \\alpha \\,\\sigma_{n} - \\beta \\,\\tau_{\\perp, \\text{fwd}})\n$$\n相减后，$\\tau_{P}$ 和 $\\alpha \\,\\sigma_{n}$ 项相互抵消：\n$$\n\\Delta = \\beta \\,\\tau_{\\perp, \\text{fwd}} - (-\\beta \\,\\tau_{\\perp, \\text{fwd}}) = 2 \\beta \\,\\tau_{\\perp, \\text{fwd}}\n$$\n这就是不对称性 $\\Delta$ 的符号表达式。\n\n这种不对称性（$\\Delta \\neq 0$）的物理原因在于BCC材料中螺位错核心的结构。该核心是非平面的，扩展到几个相交的 $\\{110\\}$ 面上。这种复杂的三维结构使其对主驱动切应力 $\\tau$ 以外的应力分量敏感。系数 $\\beta$ 量化了其对垂直切应力 $\\tau_{\\perp}$ 的敏感性。非零的 $\\beta$ 意味着 $\\tau_{\\perp}$ 可以使核心变形，从而使其更容易或更难转变为可移动的构型。当滑移方向反转时（从正向到反向），$\\tau_{\\perp}$ 的符号也随之反转。这会改变其对核心的影响，例如，从辅助运动变为抵抗运动。结果是在正向和反向运动时，需要不同大小的主驱动应力 $\\tau$ 来启动运动。这个差异 $\\Delta$ 是非施密特行为和核心对完整应力张量结构响应的直接体现。$\\alpha \\sigma_n$ 项也对非施密特效应有贡献，它使得CRSS依赖于正应力，但它对这里定义的不对称性 $\\Delta$ 没有贡献，因为假定 $\\sigma_n$ 对于两个滑移方向是相同的。\n\n最后，我们使用给定参数计算 $\\Delta$ 的数值：\n- $\\beta = 0.35$\n- $\\tau_{\\perp, \\text{fwd}} = +0.18 \\,\\text{GPa}$\n\n将这些值代入 $\\Delta$ 的表达式中：\n$$\n\\Delta = 2 \\times 0.35 \\times (0.18 \\,\\text{GPa})\n$$\n$$\n\\Delta = 0.70 \\times 0.18 \\,\\text{GPa} = 0.126 \\,\\text{GPa}\n$$\n问题要求答案以兆帕（MPa）表示。我们使用换算系数 $1 \\,\\text{GPa} = 1000 \\,\\text{MPa}$：\n$$\n\\Delta = 0.126 \\times 1000 \\,\\text{MPa} = 126 \\,\\text{MPa}\n$$\n问题还规定答案必须四舍五入到四位有效数字。为了将 $126$ 表示为四位有效数字，我们写作 $126.0$。\n$$\n\\Delta = 126.0 \\,\\text{MPa}\n$$",
            "answer": "$$\n\\boxed{126.0}\n$$"
        },
        {
            "introduction": "最后的这个练习旨在搭建分析理论与现代计算材料科学之间的桥梁。您将构建一个工作流程，利用密度泛函理论（DFT）的计算结果——特别是广义堆垛层错能（$\\gamma$-曲面），通过皮尔斯-纳巴罗（Peierls-Nabarro）模型来计算皮尔斯应力。该练习  展示了第一性原理计算如何为更高级别的塑性模型提供必要参数，并让您一窥复杂合金力学性能预测建模的前沿。",
            "id": "3755809",
            "problem": "要求您设计一个程序，该程序将密度泛函理论 (DFT) 工作流程形式化，以计算目标高熵合金 (HEA) 滑移系的广义层错能（也称为 $\\gamma$-曲面），然后通过皮尔斯-纳巴罗 (Peierls-Nabarro, PN) 程序评估皮尔斯应力。该程序必须为每个测试案例量化三个输出：皮尔斯应力、超胞尺寸是否足以抑制位错核心的镜像相互作用，以及所提供的 $\\mathbf{k}$-点网格是否满足最小倒易空间采样密度要求。该程序必须使用从基本弹性理论和 $\\gamma$-曲面定义的有原则的推导来实现物理模型，并且除了这些基础之外，不得假定任何捷径公式。\n\n从以下基本事实和定义开始：\n- 沿一维滑移坐标的广义层错能，或称 $\\gamma$-曲面，是一个周期性的单位面积能量函数，记为 $\\gamma(u)$，其中 $u$ 是沿滑移方向的切向错排，且 $u \\in [0,b]$，$b$ 是 Burgers 矢量的大小。\n- 穿过滑移面的抗剪切牵引力（晶格摩擦力）为 $d\\gamma/du$，其单位为压强，沿该路径的最大恢复剪切牵引力大小记为 $\\tau_{\\max}$。\n- 在用于直位错的各向同性皮尔斯-纳巴罗框架中，当失配势由类正弦周期函数表示时，非局域弹性核简化为一个有效的依赖于位错类型的预因子；位错核心半宽度 $w$ 是通过在稳态下平衡弹性能和失配力来确定的。\n- 皮尔斯应力 $\\tau_p$ 是克服晶格摩擦力并将位错移过周期性势垒所需的最小外加剪切应力。\n\n您的程序必须实现以下建模步骤：\n1. 将沿选定滑移路径的 $\\gamma$-曲面表示为满足周期性和 $u=0$ 处零能量参考的有限傅里叶级数：$$\\gamma(u) = \\sum_{n=1}^{N_h} C_n\\left(1 - \\cos\\left(\\frac{2\\pi n u}{b}\\right)\\right),$$ 其中 $C_n$ 是能量/面积单位的振幅，$N_h$ 是谐波数。\n2. 将抗剪切牵引力计算为 $\\gamma$-曲面的导数：$$\\tau(u) = \\frac{d\\gamma}{du}(u) = \\sum_{n=1}^{N_h} C_n \\frac{2\\pi n}{b} \\sin\\left(\\frac{2\\pi n u}{b}\\right).$$ 定义 $\\tau_{\\max} = \\max_{u \\in [0,b]} |\\tau(u)|$。\n3. 对于位错类型角为 $\\theta$ 的直位错（定义为位错线与 Burgers 矢量之间的夹角，$\\theta = 0$ 对应纯螺位错，$\\theta = \\pi/2$ 对应纯刃位错），使用各向同性弹性理论将核心宽度的有效预因子定义为 $$f(\\theta,\\nu) = \\cos^2\\theta + \\frac{\\sin^2\\theta}{1-\\nu},$$ 其中 $\\nu$ 是泊松比，并令核心半宽度为 $$w = \\frac{\\mu\\, b}{2\\pi\\, \\tau_{\\max}}\\, f(\\theta,\\nu),$$ 其中 $\\mu$ 是剪切模量，$b$ 是 Burgers 矢量的大小。\n4. 在此近似中，皮尔斯应力通过穿越周期性势垒获得：$$\\tau_p = \\tau_{\\max}\\,\\exp\\left(-\\frac{2\\pi w}{b}\\right).$$\n\n此外，您的程序必须为 $\\gamma$-曲面计算形式化 DFT 的实用性要求：\n- 假设一个体超胞尺寸为 $(L_x,L_y,L_z)$，其取向使得滑移方向沿一个横向轴，滑移面法线沿另一个轴。为了在 PN 中实现位错核心的数值隔离，要求横向尺寸远大于核心宽度。定义一个充分性准则，即较小的横向尺寸超过核心宽度的倍数：$$\\min(L_x, L_y) \\ge \\alpha \\, w,$$ 推荐因子 $\\alpha = 8$。\n- 对于布里渊区采样，使用倒易空间密度要求。倒易晶格基矢的大小为 $|\\mathbf{b}_i^*| = 2\\pi/L_i$，其中 $i \\in \\{x,y,z\\}$。对于以反长度为单位的目标最大间距 $\\Delta k$，最小 Monkhorst-Pack 网格 $\\{N_x,N_y,N_z\\}$ 必须满足 $$N_i \\ge \\left\\lceil \\frac{|\\mathbf{b}_i^*|}{\\Delta k} \\right\\rceil = \\left\\lceil \\frac{2\\pi}{L_i \\Delta k} \\right\\rceil.$$\n\n单位和数值要求：\n- 输入振幅 $C_n$ 以毫焦耳/平方米为单位。在计算中转换为焦耳/平方米。\n- Burgers 矢量大小 $b$ 和超胞尺寸 $L_x,L_y,L_z$ 以埃为单位。在计算弹性相关长度时转换为米，在需要时转换为反埃以计算倒易空间量值。\n- 剪切模量 $\\mu$ 以吉帕斯卡为单位。在计算中转换为帕斯卡，并以吉帕斯卡表示最终的 $\\tau_p$。\n- 角度 $\\theta$ 以度为单位提供，必须转换为弧度。\n- 最终的皮尔斯应力 $\\tau_p$ 以吉帕斯卡表示，四舍五入到三位小数。\n- 内部使用弧度作为角度单位，并验证规范与案例定义匹配。\n\n测试套件和输出：\n定义三个测试案例，用于探究该建模的不同方面：\n- 案例 A（一般滑移，纯螺位错）：$b = 2.55\\,\\text{\\AA}$，$\\mu = 80\\,\\text{GPa}$，$\\nu = 0.33$，$\\theta = 0^\\circ$，傅里叶振幅 $\\{(n=1,C_1=180\\,\\text{mJ/m}^2), (n=2,C_2=40\\,\\text{mJ/m}^2)\\}$，超胞 $(L_x,L_y,L_z) = (60\\,\\text{\\AA},60\\,\\text{\\AA},20\\,\\text{\\AA})$，目标 $\\Delta k = 0.03\\,\\text{\\AA}^{-1}$，提供的 $\\{N_x,N_y,N_z\\} = \\{3,3,5\\}$。\n- 案例 B（更高势垒，纯刃位错）：$b = 2.00\\,\\text{\\AA}$，$\\mu = 120\\,\\text{GPa}$，$\\nu = 0.29$，$\\theta = 90^\\circ$，傅里叶振幅 $\\{(n=1,C_1=250\\,\\text{mJ/m}^2), (n=2,C_2=80\\,\\text{mJ/m}^2)\\}$，超胞 $(L_x,L_y,L_z) = (100\\,\\text{\\AA},80\\,\\text{\\AA},30\\,\\text{\\AA})$，目标 $\\Delta k = 0.02\\,\\text{\\AA}^{-1}$，提供的 $\\{N_x,N_y,N_z\\} = \\{6,5,12\\}$。\n- 案例 C（低势垒，混合位错）：$b = 2.50\\,\\text{\\AA}$，$\\mu = 70\\,\\text{GPa}$，$\\nu = 0.35$，$\\theta = 35^\\circ$，傅里叶振幅 $\\{(n=1,C_1=90\\,\\text{mJ/m}^2), (n=2,C_2=20\\,\\text{mJ/m}^2)\\}$，超胞 $(L_x,L_y,L_z) = (40\\,\\text{\\AA},40\\,\\text{\\AA},15\\,\\text{\\AA})$，目标 $\\Delta k = 0.04\\,\\text{\\AA}^{-1}$，提供的 $\\{N_x,N_y,N_z\\} = \\{4,4,8\\}$。\n\n要求的最终输出格式：\n- 对于每个案例，生成一个包含四个元素的列表：$[\\tau_p\\text{（GPa，四舍五入到三位小数）}, \\text{supercell\\_ok}, \\text{kgrid\\_ok}, [N_x^{\\min},N_y^{\\min},N_z^{\\min}]]$, 其中 $\\text{supercell\\_ok}$ 和 $\\text{kgrid\\_ok}$ 是布尔值，指示所提供的尺寸和 $\\mathbf{k}$-点网格是否满足标准，而 $[N_x^{\\min},N_y^{\\min},N_z^{\\min}]$ 是推荐的最小网格。\n- 您的程序应生成单行输出，其中包含所有三个案例的结果，格式为方括号内包含的逗号分隔列表，例如 $[[\\cdots],[\\cdots],[\\cdots]]$。",
            "solution": "该问题提出了一个多步骤任务，旨在形式化一个计算工作流程，用于从第一性原理（特别是密度泛函理论，DFT）出发，使用皮尔斯-纳巴罗 (Peierls–Nabarro, PN) 框架确定位错的皮尔斯应力。这包括分析给定的广义层错能（$\\gamma$-曲面），计算特定于材料的位错属性，并验证底层 DFT 计算中使用的计算参数。该问题具有科学依据，提法明确，并提供了所有必要的数据和方程。它代表了计算材料科学中研究塑性变形机制的一个标准（尽管简化了）的程序。我们将通过为三个给定的测试案例实施指定的工作流程来继续。\n\n该工作流程可以分解为四个主要阶段：\n1.  从提供的 $\\gamma$-曲面傅里叶级数表示中确定最大抗剪切牵引力 $\\tau_{\\max}$。\n2.  使用各向同性弹性模型计算位错核心半宽度 $w$。\n3.  评估皮尔斯应力 $\\tau_p$，它代表了晶格对位错运动的内禀阻力。\n4.  通过两项检查来验证计算设置的有效性：超胞尺寸的充分性和 $\\mathbf{k}$-点网格的密度。\n\n首先，我们必须建立一个一致的单位制。计算将在国际单位制（SI）基本单位（米、帕斯卡、焦耳）中进行。给定的输入参数将按如下方式转换：\n-   Burgers 矢量 $b$ 和超胞尺寸 $L_i$：埃（$\\text{\\AA}$）转换为米（$1\\,\\text{\\AA} = 10^{-10}\\,\\text{m}$）。\n-   剪切模量 $\\mu$：吉帕斯卡（$\\text{GPa}$）转换为帕斯卡（$\\text{Pa}$，$1\\,\\text{GPa} = 10^9\\,\\text{Pa}$）。\n-   傅里叶系数 $C_n$：毫焦耳/平方米（$\\text{mJ/m}^2$）转换为焦耳/平方米（$\\text{J/m}^2$，$1\\,\\text{mJ/m}^2 = 10^{-3}\\,\\text{J/m}^2$）。\n-   位错类型角 $\\theta$：度转换为弧度。\n$\\tau_p$ 的最终结果将转换回 $\\text{GPa}$。\n\n计算步骤如下：\n\n**1. 抗剪切牵引力及其最大值 ($\\tau_{\\max}$)**\n广义层错能 $\\gamma(u)$ 以沿滑移路径坐标 $u$ 的傅里叶级数形式给出：\n$$\n\\gamma(u) = \\sum_{n=1}^{N_h} C_n\\left(1 - \\cos\\left(\\frac{2\\pi n u}{b}\\right)\\right)\n$$\n抗剪切牵引力 $\\tau(u)$ 是 $\\gamma(u)$ 关于 $u$ 的导数：\n$$\n\\tau(u) = \\frac{d\\gamma}{du}(u) = \\sum_{n=1}^{N_h} C_n \\frac{2\\pi n}{b} \\sin\\left(\\frac{2\\pi n u}{b}\\right)\n$$\n量 $\\tau_{\\max}$ 定义为该牵引力大小的最大值，$\\tau_{\\max} = \\max_{u \\in [0,b]} |\\tau(u)|$。为了找到这个最大值，可以求解 $\\frac{d\\tau}{du} = 0$，这等价于求解 $\\frac{d^2\\gamma}{du^2} = 0$。对于一个通用级数，这可能没有解析解。一个更稳健和通用的数值方法是将区间 $u \\in [0, b]$ 离散化为一个精细的网格，在每个点上计算 $\\tau(u)$，然后从结果数组中找到最大绝对值。我们将实现这种方法。\n\n**2. 位错核心半宽度 ($w$)**\n核心半宽度 $w$ 是通过平衡周围晶格中存储的弹性能与滑移面上的失配能来计算的。在指定的各向同性 PN 模型中，这得出：\n$$\nw = \\frac{\\mu b}{2\\pi \\tau_{\\max}} f(\\theta, \\nu)\n$$\n其中 $\\mu$ 是剪切模量，$b$ 是 Burgers 矢量的大小，$f(\\theta, \\nu)$ 是一个依赖于位错类型的因子，由下式给出：\n$$\nf(\\theta, \\nu) = \\cos^2\\theta + \\frac{\\sin^2\\theta}{1-\\nu}\n$$\n这里，$\\theta$ 是位错类型角（螺位错为 $\\theta=0$，刃位错为 $\\theta=\\pi/2$），$\\nu$ 是泊松比。\n\n**3. 皮尔斯应力 ($\\tau_p$)**\n皮尔斯应力 $\\tau_p$ 是移动位错所需的临界外加应力，它对应于克服周期性晶格势的能垒。它由以下表达式给出：\n$$\n\\tau_p = \\tau_{\\max}\\,\\exp\\left(-\\frac{2\\pi w}{b}\\right)\n$$\n代入 $w$ 的表达式揭示了 $\\tau_p$ 与材料参数之间的直接关系：\n$$\n\\tau_p = \\tau_{\\max}\\,\\exp\\left(-\\frac{\\mu}{\\tau_{\\max}} f(\\theta, \\nu)\\right)\n$$\n\n**4. DFT 实用性检查**\n必须执行两项检查以评估将用于导出 $\\gamma$-曲面的底层 DFT 计算的数值有效性。\n\n**a. 超胞尺寸充分性**\n为避免模拟中位错与其周期性镜像之间的虚假相互作用，超胞尺寸必须与位错核心尺寸相比足够大。其准则为：\n$$\n\\min(L_x, L_y) \\ge \\alpha \\, w\n$$\n因子 $\\alpha = 8$。尺寸 $L_x$ 和 $L_y$ 是晶胞的横向长度，$w$ 是先前计算的核心半宽度。此检查将返回一个布尔值（`True` 或 `False`）。\n\n**b. K 点网格密度**\n电子波函数在倒易空间中使用 Monkhorst-Pack 网格进行采样。采样必须足够密集以使总能量收敛。沿每个倒易晶格矢量所需的最小网格点数 $N_i^{\\min}$ 由目标最大间距 $\\Delta k$ 确定：\n$$\nN_i^{\\min} = \\left\\lceil \\frac{2\\pi}{L_i \\Delta k} \\right\\rceil \\quad \\text{for } i \\in \\{x,y,z\\}\n$$\n如果对于所有三个维度都有 $N_i \\ge N_i^{\\min}$，则认为所提供的网格 $\\{N_x, N_y, N_z\\}$ 是足够的。计算将报告此检查的布尔值（`True` 或 `False`），并返回计算出的最小网格 $[N_x^{\\min}, N_y^{\\min}, N_z^{\\min}]$。对于此计算，使用单位为 $\\text{\\AA}$ 的 $L_i$ 和单位为 $\\text{\\AA}^{-1}$ 的 $\\Delta k$ 很方便，因为单位会方便地抵消掉。\n\n我们现在将这个完整的工作流程应用于提供的三个测试案例中的每一个。对于每个案例，我们将计算 $\\tau_p$，确定 `supercell_ok` 和 `kgrid_ok`，并列出所需的最小 k 点网格，将这四条信息组合成最终的输出格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Peierls stress and validates DFT parameters for given test cases\n    based on the Peierls-Nabarro model and standard computational checks.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a dictionary containing all input parameters.\n    test_cases = [\n        # Case A: general slip, pure screw\n        {\n            \"b_A\": 2.55,  # Angstrom\n            \"mu_GPa\": 80.0, # GPa\n            \"nu\": 0.33,\n            \"theta_deg\": 0.0, # degrees\n            \"Cn_mJ_m2\": [(1, 180.0), (2, 40.0)], # mJ/m^2\n            \"L_A\": (60.0, 60.0, 20.0), # Angstrom\n            \"delta_k\": 0.03, # 1/Angstrom\n            \"N_given\": (3, 3, 5)\n        },\n        # Case B: higher barrier, pure edge\n        {\n            \"b_A\": 2.00,  # Angstrom\n            \"mu_GPa\": 120.0, # GPa\n            \"nu\": 0.29,\n            \"theta_deg\": 90.0, # degrees\n            \"Cn_mJ_m2\": [(1, 250.0), (2, 80.0)], # mJ/m^2\n            \"L_A\": (100.0, 80.0, 30.0), # Angstrom\n            \"delta_k\": 0.02, # 1/Angstrom\n            \"N_given\": (6, 5, 12)\n        },\n        # Case C: low barrier, mixed character\n        {\n            \"b_A\": 2.50,  # Angstrom\n            \"mu_GPa\": 70.0, # GPa\n            \"nu\": 0.35,\n            \"theta_deg\": 35.0, # degrees\n            \"Cn_mJ_m2\": [(1, 90.0), (2, 20.0)], # mJ/m^2\n            \"L_A\": (40.0, 40.0, 15.0), # Angstrom\n            \"delta_k\": 0.04, # 1/Angstrom\n            \"N_given\": (4, 4, 8)\n        }\n    ]\n\n    results = []\n    \n    # Constants for conversion\n    A_to_m = 1e-10\n    GPa_to_Pa = 1e9\n    mJ_m2_to_J_m2 = 1e-3\n    alpha_supercell = 8.0\n\n    for case in test_cases:\n        # 1. Unpack variables and convert units to SI\n        b_m = case[\"b_A\"] * A_to_m\n        mu_Pa = case[\"mu_GPa\"] * GPa_to_Pa\n        nu = case[\"nu\"]\n        theta_rad = np.deg2rad(case[\"theta_deg\"])\n        \n        # Cn coefficients are given with n=1, 2...\n        # Create a dictionary for easier access\n        Cn_dict = {n: c * mJ_m2_to_J_m2 for n, c in case[\"Cn_mJ_m2\"]}\n        Nh = max(Cn_dict.keys())\n        \n        # 2. Calculate tau_max\n        # Discretize slip coordinate u from 0 to b\n        u_space = np.linspace(0, b_m, 10000, endpoint=True)\n        \n        # Calculate resisting shear traction tau(u)\n        tau_u = np.zeros_like(u_space)\n        for n in range(1, Nh + 1):\n            if n in Cn_dict:\n                C_n = Cn_dict[n]\n                tau_u += C_n * (2 * np.pi * n / b_m) * np.sin(2 * np.pi * n * u_space / b_m)\n        \n        tau_max_Pa = np.max(np.abs(tau_u))\n\n        # 3. Calculate core half-width w\n        f_theta_nu = np.cos(theta_rad)**2 + (np.sin(theta_rad)**2) / (1 - nu)\n        w_m = (mu_Pa * b_m) / (2 * np.pi * tau_max_Pa) * f_theta_nu\n        \n        # 4. Calculate Peierls stress tau_p\n        tau_p_Pa = tau_max_Pa * np.exp(-2 * np.pi * w_m / b_m)\n        tau_p_GPa = tau_p_Pa / GPa_to_Pa\n        \n        # 5. Perform DFT practicality checks\n        \n        # a. Supercell sufficiency check\n        L_A = case[\"L_A\"]\n        min_lat_dim_A = min(L_A[0], L_A[1])\n        w_A = w_m / A_to_m\n        supercell_ok = min_lat_dim_A >= alpha_supercell * w_A\n        \n        # b. K-point grid sufficiency check\n        delta_k = case[\"delta_k\"]\n        Nx_min = int(np.ceil(2 * np.pi / (L_A[0] * delta_k)))\n        Ny_min = int(np.ceil(2 * np.pi / (L_A[1] * delta_k)))\n        Nz_min = int(np.ceil(2 * np.pi / (L_A[2] * delta_k)))\n        N_min = [Nx_min, Ny_min, Nz_min]\n        \n        N_given = case[\"N_given\"]\n        kgrid_ok = (N_given[0] >= N_min[0]) and \\\n                   (N_given[1] >= N_min[1]) and \\\n                   (N_given[2] >= N_min[2])\n\n        # 6. Assemble the results for this case\n        result_list = [\n            round(tau_p_GPa, 3),\n            supercell_ok,\n            kgrid_ok,\n            N_min\n        ]\n        results.append(result_list)\n\n    # Final print statement in the exact required format.\n    # Manually construct string to match example format without extra spaces\n    result_strings = []\n    for r in results:\n        # str(bool) gives 'True'/'False' with capital T/F\n        result_strings.append(f\"[{r[0]}, {r[1]}, {r[2]}, {r[3]}]\".replace(\" \", \"\"))\n\n    # The problem example shows [[...],[...]], not '[[...], [...]]'\n    # Python's str() on a list of lists will add spaces.\n    # Joining the string representations of each inner list is closer.\n    # However, the template print is given, so we follow that structure.\n    # The str() representation of a list is standard and unambiguous.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}