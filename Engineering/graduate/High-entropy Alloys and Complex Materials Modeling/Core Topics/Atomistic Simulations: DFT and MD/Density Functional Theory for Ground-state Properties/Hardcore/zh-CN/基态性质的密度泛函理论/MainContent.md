## 引言
在现代计算材料科学领域，密度泛函理论（DFT）已成为一块不可或缺的基石，它使我们能够仅从基本的量子力学定律出发，便能预测和解释材料的各种性质。面对日益复杂的材料体系，如具有巨大成分空间和显著局域无序性的[高熵合金](@entry_id:141320)，传统的经验模型往往力不从心。DFT提供了一个第一性原理的框架，从根本上解决了如何对这些复杂多电子系统进行精确计算的难题，从而揭示其结构、稳定性和性能的内在联系。

本文旨在为读者提供一个关于DFT及其在材料科学中应用的全面而深入的理解。我们将分三个层次展开：首先，在“原理与机制”一章中，我们将深入探讨作为理论基础的[Hohenberg-Kohn定理](@entry_id:139793)，阐明实现计算可行性的[Kohn-Sham方法](@entry_id:263733)，并剖析交换关联泛函和[赝势](@entry_id:170389)等核心计算构件。接着，在“应用与交叉学科联系”一章中，我们将展示如何运用这些原理来解决物理、化学和材料科学中的实际问题，例如预测合金的相稳定性、[计算力学](@entry_id:174464)性能以及为复杂无序体系建模。最后，“动手实践”部分将提供具体的计算练习，帮助您巩固所学知识。通过这一结构化的学习路径，您将构建起一个从理论基础到实际应用的完整知识体系，为驾驭这一强大的计算工具奠定坚实的基础。

## 原理与机制

本章将深入探讨[密度泛函理论](@entry_id:139027)（DFT）的基石原理及其在计算实践中实现这些原理的核心机制。我们将从作为理论基础的 Hohenberg-Kohn 定理出发，过渡到实现计算可行性的 Kohn-Sham 方法，并详细阐述交换关联泛函、基[组选择](@entry_id:175784)、[自洽场](@entry_id:136549)迭代和力计算等关键概念。这些内容共同构成了应用 DFT 预测复杂材料（如[高熵合金](@entry_id:141320)）基态性质的完整框架。

### 理论基石：Hohenberg-Kohn 定理

现代[电子结构理论](@entry_id:172375)的一个核心突破在于认识到，一个多电子体系的全部基态信息都蕴含在一个看似简单的量中：**电子密度** $n(\mathbf{r})$。对于一个由 $N$ 个电子组成的体系，其状态由一个复杂的、依赖于所有 $N$ 个电子坐标（空间和自旋）的[多体波函数](@entry_id:203043) $\Psi(\mathbf{x}_1, \dots, \mathbf{x}_N)$ 描述。从第一性原理出发，电子密度被定义为在基态[波函数](@entry_id:201714) $\Psi_0$ 下对密度算符 $\hat{n}(\mathbf{r}) = \sum_{i=1}^{N} \delta(\mathbf{r} - \hat{\mathbf{r}}_i)$ 的[期望值](@entry_id:150961)。这等价于将[多体波函数](@entry_id:203043)[概率密度](@entry_id:175496)对除一个电子之外的所有电子的坐标进行积分和[自旋求和](@entry_id:162099) ：
$$
n(\mathbf{r}) = N \sum_{\sigma_1, \dots, \sigma_N} \int |\Psi_0(\mathbf{r}\sigma_1, \mathbf{r}_2\sigma_2, \dots, \mathbf{r}_N\sigma_N)|^2 d\mathbf{r}_2 \dots d\mathbf{r}_N
$$
这个函数 $n(\mathbf{r})$ 是一个三维空间中的标量场，非负且积分为总电子数 $N$。Hohenberg 和 Kohn 在其开创性的定理中证明，对于一个给定的非简并基态，外部势 $v_{\text{ext}}(\mathbf{r})$ 与基态电子密度 $n(\mathbf{r})$ 之间存在[一一对应](@entry_id:143935)关系。这意味着，知道了 $n(\mathbf{r})$，原则上就可以唯一确定束缚这些电子的外部势（例如原子核产生的势），从而确定整个系统的哈密顿量及所有性质。

这个定理引出了 DFT 的核心思想：总能量可以表示为电子密度的泛函 $E[n]$。我们可以将这个[能量泛函](@entry_id:170311)分解为依赖于外部势的部分和不依赖于外部势的部分：
$$
E_v[n] = F[n] + \int n(\mathbf{r}) v_{\text{ext}}(\mathbf{r}) d\mathbf{r}
$$
其中，$F[n] = \langle \Psi[n] | \hat{T} + \hat{W} | \Psi[n] \rangle$ 包含了电子的动能 $(\hat{T})$ 和[电子-电子相互作用](@entry_id:139900)能 $(\hat{W})$。关键在于，$\hat{T}$ 和 $\hat{W}$ 是由基本物理定律决定的，对于任何非相对论性的电子系统都是相同的。一个特定材料（无论是氢原子还是复杂的[高熵合金](@entry_id:141320)）的独特性完全由其原子核构型所产生的外部势 $v_{\text{ext}}(\mathbf{r})$ 决定。因此，泛函 $F[n]$ 是**普适的**，它不依赖于具体的材料，只依赖于电子密度本身 。这种普适性是 DFT 强大功能的根源。

为了使这一理论框架严谨，需要明确泛函的定义域，这引出了两个“[可表示性](@entry_id:635277)”概念。一个密度 $n(\mathbf{r})$ 如果能由某个反对称的 $N$ 电子[波函数](@entry_id:201714)（不一定是某个势的基态）产生，则被称为 **$N$-可表示的**。如果一个密度是某个局域外部势 $v(\mathbf{r})$ 下的基态密度，则被称为 **$v$-可表示的**。最初的 Hohenberg-Kohn 定理是针对 $v$-可表示密度集提出的，但这个集合的性质难以捉摸。通过 Levy 和 Lieb 的约[束搜索](@entry_id:634146)（constrained-search）表述，[普适泛函](@entry_id:140176)被定义为在所有产生相同密度 $n$ 的 $N$-可表示[波函数](@entry_id:201714) $\Psi$ 上，对动能和相互作用能之和取最小值：
$$
F[n] = \min_{\Psi \to n} \langle \Psi | \hat{T} + \hat{W} | \Psi \rangle
$$
这个定义将 DFT 的[适用范围](@entry_id:636189)扩展到了更广泛且性质更好的 $N$-可表示密度集，极大地增强了理论的严谨性和实用性 。

### 实用性的飞跃：Kohn-Sham 方法

尽管 Hohenberg-Kohn 定理在理论上极为优美，但[普适泛函](@entry_id:140176) $F[n]$ 的确切形式是未知的，特别是其中的动能部分 $T[n]$ 难以直接用密度表示。Kohn 和 Sham 提出了一种巧妙的解决方法，即引入一个辅助的、虚拟的**无相互作用电子系统**，并要求这个[无相互作用系统](@entry_id:143064)的基态密度与真实的、有相互作用的系统的基[态密度](@entry_id:147894)**完全相同**。

这个思想的精妙之处在于，一个[无相互作用系统](@entry_id:143064)的动能 $T_s[n]$ 可以通过其单粒子轨道 $\{\phi_i\}$ 精确地写出，而这些轨道可以通过求解一个有效的单粒子薛定谔方程得到。总能量泛函因此被重新划分为 ：
$$
E[n] = T_s[n] + E_H[n] + E_{\text{ext}}[n] + E_{xc}[n]
$$
这里，$T_s[n]$ 是[无相互作用系统](@entry_id:143064)的动能，$E_H[n] = \frac{1}{2} \int d\mathbf{r} \int d\mathbf{r}' \frac{n(\mathbf{r})n(\mathbf{r}')}{|\mathbf{r}-\mathbf{r}'|}$ 是电子密度的经典静电排斥能（即**哈特里能**），$E_{\text{ext}}[n] = \int n(\mathbf{r}) v_{\text{ext}}(\mathbf{r}) d\mathbf{r}$ 是电子在原子核外部势中的能量。所有我们不知道的复杂量子效应都被归入一个唯一的项：**交换关联能** $E_{xc}[n]$。它被定义为 $E_{xc}[n] = (T[n] - T_s[n]) + (E_{ee}[n] - E_H[n])$，即真实动能与无相互作用动能的差，加上真实[电子-电子相互作用](@entry_id:139900)能与哈特里能的差。

根据[变分原理](@entry_id:198028)，对总能量泛函 $E[n]$ 关于电子密度 $n$（或等效地，关于单粒子轨道 $\{\phi_i\}$）求极小值，可以得到一组自洽的单粒子方程，即**Kohn-Sham (KS) 方程**：
$$
\left[ -\frac{1}{2}\nabla^2 + v_{\text{eff}}(\mathbf{r}) \right] \phi_i(\mathbf{r}) = \epsilon_i \phi_i(\mathbf{r})
$$
其中，电子密度由占据的 KS 轨道构成：$n(\mathbf{r}) = \sum_{i=1}^{N} |\phi_i(\mathbf{r})|^2$。[有效势](@entry_id:1124192) $v_{\text{eff}}(\mathbf{r})$ 包含了与密度相关的所有相互作用：
$$
v_{\text{eff}}(\mathbf{r}) = v_{\text{ext}}(\mathbf{r}) + v_H(\mathbf{r}) + v_{xc}(\mathbf{r})
$$
其中，哈特里势 $v_H(\mathbf{r}) = \int d\mathbf{r}' \frac{n(\mathbf{r}')}{|\mathbf{r}-\mathbf{r}'|}$，交换关联势 $v_{xc}(\mathbf{r}) = \frac{\delta E_{xc}[n]}{\delta n(\mathbf{r})}$。对于一个化学成分复杂的合金，外部势就是所有不同种类原子核（或更实用的赝势）在各自位置 $\mathbf{R}_I$ 产生的势的总和，$v_{\text{ext}}(\mathbf{r})=\sum_I v_I(\mathbf{r}-\mathbf{R}_I)$。值得强调的是，在处理特定原子构型的基态[电子结构](@entry_id:145158)时，合金的**[构型熵](@entry_id:147820)**（一个描述原子排布无序度的[热力学](@entry_id:172368)量）并不会进入零温下的[电子哈密顿量](@entry_id:177588)或交换关联泛函中 。

### 核心近似：交换关联泛函

Kohn-Sham 方法将全部的复杂性集中到了交换关联泛函 $E_{xc}[n]$ 上。该泛函的确切形式是未知的，必须采用近似。理解和发展这些近似是现代 DFT 的核心任务。

#### 交换关联空穴

$E_{xc}[n]$ 的物理根源可以从**交换关联空穴** $n_{xc}(\mathbf{r}, \mathbf{r}')$ 的概念中理解。这个函数描述了当一个电子位于 $\mathbf{r}$ 处时，周围其他电子的[条件概率密度](@entry_id:265457)相对于平均概率密度的变化。由于[泡利不相容原理](@entry_id:141850)（交换效应）和库仑排斥（关联效应），一个电子周围会形成一个电荷亏损的区域，即“空穴”。

从第一性原理出发，交换关联空穴是通过对关联密度 $n_2(\mathbf{r}, \mathbf{r}')$ 定义的，后者给出了在 $\mathbf{r}$ 和 $\mathbf{r}'$ 同时找到两个不同电子的概率密度 ：
$$
n_2(\mathbf{r}, \mathbf{r}') = n(\mathbf{r}) \big[ n(\mathbf{r}') + n_{xc}(\mathbf{r}, \mathbf{r}') \big]
$$
这个定义引出了一些 $n_{xc}$ 必须满足的**普适的精确条件**，无论材料多复杂，这些条件都必须成立。最重要的一个是**求和规则**：
$$
\int n_{xc}(\mathbf{r}, \mathbf{r}') d\mathbf{r}' = -1
$$
它表明，交换关联空穴在全空间积分后，其总电荷恰好为 $-1$，完美地屏蔽了参考电子。此外，还有加权对称性、[渐近行为](@entry_id:160836)和单电子极限等其他精确条件 。这些条件为构建和检验近似泛函提供了重要的指导。

#### 泛函的层级与系统误差

近似泛函通常被比喻为一个“[雅各布天梯](@entry_id:139901)”，从简单到复杂，精度逐步提升。最基础的两个梯级是：
1.  **局域密度近似 ([LDA](@entry_id:138982))**：它假设在空间每一点 $\mathbf{r}$ 处，交换关联能密度与密度为 $n(\mathbf{r})$ 的[均匀电子气](@entry_id:195006)相同。LDA 虽然简单，但在描述固体性质方面出人意料地成功。然而，它存在一个系统性的缺陷：在非[均匀电子气](@entry_id:195006)（如原子和分子）中，它倾向于**过度键合 (overbinding)**。这意味着它预测的[结合能](@entry_id:143405)太强，导致计算出的平衡[晶格常数](@entry_id:158935)通常比实验值偏小 。
2.  **[广义梯度近似 (GGA)](@entry_id:140295)**：为了修正 [LDA](@entry_id:138982) 的问题，GGA 在泛函中不仅考虑了局域密度 $n(\mathbf{r})$，还引入了其梯度 $\nabla n(\mathbf{r})$。像 Perdew-Burke-Ernzerhof (PBE) 这样的 GGA 泛函，通过引入梯度修正，削弱了 LDA 中过度的交换关联吸引，从而减小了内聚压力。这使得能量-体积曲线的最低点向更大的体积移动，预测出的晶格常数通常更接近实验值，显著改善了对金属、半导体等材料结构性质的描述 。

然而，即便是 GGA 也存在根本性的缺陷。其中最著名的是**自相互作用误差 (Self-Interaction Error, SIE)**。对于一个单电子体系，电子不应与自身发生相互作用，因此哈特里能 $E_H[n]$ 必须与交换关联能 $E_{xc}[n]$ 精确抵消，即 $E_H[n] + E_{xc}[n] = 0$。对于精确的交换泛函（非局域的），这种抵消是完美的。但对于 LDA 和 GGA 这样的半局域泛函，由于其数学形式是局域的，无法完全抵消非局域的哈特里能，从而产生一个虚假的、非零的残余自相互作用能 。这种误差会导致对[局域化电子](@entry_id:751389)态（如 $d$ 或 $f$ 电子）的描述不佳。我们可以通过一个思想实验来诊断这种误差：将一个氢原子（单电子密度）置于一个足够大的周期性盒子中，计算 $E_H[n] + E_{xc}^{\text{approx}}[n]$ 的值。对于精确泛函，该值应为零；而对于近似泛函，其非零值就量化了[自相互作用误差](@entry_id:260813)的大小 。

### 计算实践的机制

将 Kohn-Sham 理论付诸实践需要一套复杂的计算工具。对于周期性系统，如晶体和[高熵合金](@entry_id:141320)的超胞模型，以下几个方面是至关重要的。

#### 基组：平面波与[赝势](@entry_id:170389)

为了求解 KS 方程，我们需要一个基组来展开单粒子轨道 $\phi_i(\mathbf{r})$。对于周期性系统，**[平面波](@entry_id:189798)**基组是一个自然且高效的选择。根据[布洛赫定理](@entry_id:137461)，KS 轨道可以写成 $e^{i\mathbf{k}\cdot\mathbf{r}} u_{n\mathbf{k}}(\mathbf{r})$ 的形式，其中 $u_{n\mathbf{k}}(\mathbf{r})$ 是一个具有[晶格](@entry_id:148274)周期的函数，可以方便地展开为倒易点阵矢量 $\mathbf{G}$ 对应的傅里叶级数。因此，KS 轨道被展开为一系列[平面波](@entry_id:189798)：
$$
\psi_{n\mathbf{k}}(\mathbf{r}) = \sum_{\mathbf{G}} c_{n\mathbf{k}}(\mathbf{G}) e^{i(\mathbf{k}+\mathbf{G})\cdot\mathbf{r}}
$$
在实践中，这个无限求和必须被截断。截断的标准是**[动能截断](@entry_id:186065)能** $E_{\text{cut}}$，只有动能 $\frac{1}{2}|\mathbf{k}+\mathbf{G}|^2 \le E_{\text{cut}}$ 的[平面波](@entry_id:189798)被包含在基组中。$E_{\text{cut}}$ 是 DFT 计算中最重要的收敛性参数之一。包含的平面波数量 $N_{\text{PW}}$ 与超胞体积 $V$ 和[截断能](@entry_id:177594) $E_{\text{cut}}$ 的关系为 $N_{\text{PW}} \propto V E_{\text{cut}}^{3/2}$ 。这个关系表明，提高精度（增加 $E_{\text{cut}}$）或模拟更大的系统（增加 $V$）都会迅速增加计算成本。

然而，价电子[波函数](@entry_id:201714)在靠近原子核的区域会剧烈振荡，以保持与芯层电子的正交性。用[平面波](@entry_id:189798)描述这些振荡需要极高的 $E_{\text{cut}}$，这在计算上是不可行的。为了解决这个问题，我们引入了**[赝势](@entry_id:170389)**（或更现代的 PAW 方法），用一个平滑的赝[波函数](@entry_id:201714)替换原子核附近的真实价电子[波函数](@entry_id:201714)，同时保持其在原子核区域外的散射性质不变。主要有三类方法 ：

1.  **模守恒[赝势](@entry_id:170389) (NCPP)**：要求在[截断半径](@entry_id:136708) $r_c$ 内，赝[波函数](@entry_id:201714)的积分电荷与全电子[波函数](@entry_id:201714)完全相同。这个“模守恒”约束保证了良好的迁移性（即赝势在不同化学环境中都能表现良好），但代价是赝[波函数](@entry_id:201714)不够平滑，需要较高的 $E_{\text{cut}}$。
2.  **[超软赝势](@entry_id:144509) (USPP)**：放宽了模守恒约束，允许赝[波函数](@entry_id:201714)在[截断半径](@entry_id:136708)内尽可能平滑，从而显著降低 $E_{\text{cut}}$。电荷的亏损通过引入额外的“增广电荷”来补偿，这使得 KS 方程变为一个广义本征值问题，增加了计算的复杂性。
3.  **投影缀加波方法 (PAW)**：这是一种形式上更严谨的方法。它引入一个[线性变换](@entry_id:149133)，可以将平滑的辅助[波函数](@entry_id:201714)精确地映射回全电子价电子[波函数](@entry_id:201714)。PAW 方法在冻芯近似下，原则上可以达到[全电子计算](@entry_id:170546)的精度，同时其计算成本与[超软赝势](@entry_id:144509)相当，是目前精度和效率之间最佳的折衷方案之一。

#### 倒空间积分：$k$ 点取样

对于周期性系统，许多物理量（如总能量）需要在倒空间的[第一布里渊区](@entry_id:269110)（BZ）内进行积分。在数值计算中，这个积分被离散为对一组特定**$k$ 点**的加权求和。

**Monkhorst-Pack (MP) 格点**是一种标准的生成均匀 $k$ 点网格的方法，它在倒易[基矢](@entry_id:199546)方向上均匀地划分[布里渊区](@entry_id:142395) 。利用晶体的[点群对称性](@entry_id:141230)，可以只在**不可约布里渊区 (IBZ)** 内进行计算，IBZ 是 BZ 在所有[对称操作](@entry_id:143398)下不重复的最小区域。这可以大大减少所需的 $k$ 点数量，从而节省计算资源。

一个重要的实际考虑是，当使用大的超胞（如用于模拟[高熵合金](@entry_id:141320)的[特殊准随机结构](@entry_id:1132064) SQS）时，实空间的[晶胞](@entry_id:143489)很大，对应的[倒空间](@entry_id:754151)[布里渊区](@entry_id:142395)就非常小。在这个小 BZ 内，能带通常非常平坦（色散很弱）。因此，对整个 BZ 的积分可以很好地用单个 $k$ 点——通常是 BZ 的中心**$\Gamma$ 点** ($\mathbf{k}=\mathbf{0}$)——来近似。这种“仅 $\Gamma$ 点”的计算不仅因为 $k$ 点数量少而节省时间，还因为在 $\Gamma$ 点，对于具有[时间反演对称性](@entry_id:138094)的体系，[哈密顿量](@entry_id:144286)和[波函数](@entry_id:201714)可以表示为实数，进一步将计算量和内存需求减少约一半到四分之一 。

#### 求解过程：[自洽场循环](@entry_id:195211)

Kohn-Sham 方程是一个[非线性方程组](@entry_id:178110)，因为[有效势](@entry_id:1124192) $v_{\text{eff}}$ 依赖于密度 $n$，而密度又依赖于 KS 轨道，轨道则是 $v_{\text{eff}}$ 的[本征函数](@entry_id:154705)。这个方程组必须通过**[自洽场](@entry_id:136549) (Self-Consistent Field, SCF)** 迭代求解 。

SCF 循环的基本流程如下：
1.  从一个初始猜测的电子密度 $n^{(0)}(\mathbf{r})$ 开始。
2.  利用 $n^{(0)}$ 构建[有效势](@entry_id:1124192) $v_{\text{eff}}[n^{(0)}](\mathbf{r})$。
3.  求解 KS 方程，得到一组新的轨道 $\{\phi_i^{(0)}\}$ 和一个新的输出密度 $\tilde{n}^{(0)}(\mathbf{r})$。
4.  将输入密度 $n^{(0)}$ 和输出密度 $\tilde{n}^{(0)}$ 进行**混合**，生成下一次迭代的输入密度 $n^{(1)}$。
5.  重复步骤 2-4，直到输入和输出密度之间的差异（残差）小于一个设定的阈值，达到自洽。

对于金属体系，简单的线性混合（即 $n^{(k+1)} = (1-\alpha)n^{(k)} + \alpha\tilde{n}^{(k)}$）通常会收敛失败或非常缓慢，这是由于金属中存在电荷“晃动”的长波不稳定性。为了加速收敛，必须采用更先进的**混合方案**，如 **Pulay 混合** (也称 DIIS) 或 **Broyden 混合**。这些方法是[准牛顿法](@entry_id:138962)，它们利用之前迭代步的残差信息来构造一个近似的系统[雅可比矩阵](@entry_id:178326)的逆，从而更有效地抑制不稳定性，将迭代导向不动点 。

#### [结构优化](@entry_id:176910)：力与 Hellmann-Feynman 定理

DFT 不仅能计算给定原子结构下的能量，还能通过计算原子核上的**力**来预测平衡结构。在 Born-Oppenheimer 近似下，作用在原子核 $I$ 上的力定义为总能量对该原子核位置 $\mathbf{R}_I$ 的负导数：$F_I = -\partial E / \partial \mathbf{R}_I$。

根据**Hellmann-Feynman 定理**，如果 KS 轨道已经达到自洽收敛（即能量对轨道的一阶变分为零），并且所用的基组不依赖于原子位置，那么力的计算就非常简单：它等于总能量（或哈密顿量）对原子核位置 $\mathbf{R}_I$ 的显式导数的[期望值](@entry_id:150961) 。对于[平面波基组](@entry_id:178287)，基函数 $e^{i\mathbf{G}\cdot\mathbf{r}}$ 不依赖于原子位置，因此这个条件是满足的。

然而，如果基组本身依赖于原子位置（例如，以原子为中心的[原子轨道基组](@entry_id:1121226)），或者计算没有完全达到自洽，那么力的表达式中就会出现额外的项，称为**Pulay 力**或基组不完备力。这些项来源于[波函数](@entry_id:201714)对原子位移的隐式响应。

在对[高熵合金](@entry_id:141320)等化学无序体系进行[结构弛豫](@entry_id:263707)时，力的计算精度至关重要。由于存在大量的局域环境和复杂的[势能面](@entry_id:143655)，即使是很小的系统性力误差，在多个弛豫步骤中累积起来，也可能导致原子被驱动到错误的局域构型，从而得出关于短程有序或相分离趋势的虚[假结](@entry_id:168307)论。因此，确保 SCF 循环的高度收敛和最小化基组相关的误差是获得可靠[结构预测](@entry_id:1132571)的先决条件 。