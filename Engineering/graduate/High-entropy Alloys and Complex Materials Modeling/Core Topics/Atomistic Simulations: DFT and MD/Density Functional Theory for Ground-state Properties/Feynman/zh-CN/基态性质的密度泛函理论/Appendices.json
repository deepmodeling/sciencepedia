{
    "hands_on_practices": [
        {
            "introduction": "在平面波密度泛函理论计算中，电子波函数由一组平面波基函数展开，其完备性由动能截断能 $E_{\\text{cut}}$ 控制。选择合适的 $E_{\\text{cut}}$ 是在计算精度和计算成本之间取得平衡的关键。本练习将通过一个物理上合理的代理模型，模拟确定一个高熵合金达到所需力收敛精度所需的最小 $E_{\\text{cut}}$ 的过程，让您亲身体验这一核心收敛性测试。",
            "id": "3737531",
            "problem": "考虑一个平面波密度泛函理论 (DFT) 对化学无序高熵合金的基态计算，其中 Kohn-Sham 方程在一个由平面波动能截断值 $E_{\\text{cut}}$（单位为 eV）表征的截断平面波基组内进行变分求解。在结构弛豫中，$T=0$ K 的基态是在有限的 $E_{\\text{cut}}$ 下近似得到的，这会导致因基组不完备性而产生一个残余力范数 $\\|\\mathbf{F}\\|$（单位为 eV/Å）。请从 Hohenberg-Kohn 定理、Kohn-Sham 变分原理以及用于基组截断的 Rayleigh-Ritz 方法出发，论证一个关于残余离子力范数随 $E_{\\text{cut}}$ 变化的、依赖于成分的收敛定律，该定律与以下性质一致：\n\n- 残余力范数 $\\|\\mathbf{F}\\|(E_{\\text{cut}})$ 是非负的，并随着 $E_{\\text{cut}}$ 的增加而减小。\n- 该衰减包含一个主导的代数分量，其依赖于一个有效的、与成分相关的硬度度量；以及一个次要的指数衰减分量，其由高频平面波的倏逝特性控制。\n\n定义有效成分硬度 $H$ 为\n$$\nH \\equiv \\sum_{i} x_i\\, s_i,\n$$\n其中 $x_i$ 是元素 $i$ 的原子分数，$s_i$ 是一个与元素种类相关的硬度参数。为解决此问题，请使用以下元素种类参数：\n- $\\text{Al}: s_{\\text{Al}} = 1.0$\n- $\\text{Ni}: s_{\\text{Ni}} = 2.0$\n- $\\text{Co}: s_{\\text{Co}} = 2.1$\n- $\\text{Cr}: s_{\\text{Cr}} = 2.5$\n- $\\text{Fe}: s_{\\text{Fe}} = 2.0$\n- $\\text{Mn}: s_{\\text{Mn}} = 2.3$\n- $\\text{Ti}: s_{\\text{Ti}} = 3.0$\n- $\\text{V}: s_{\\text{V}} = 3.0$\n- $\\text{Mo}: s_{\\text{Mo}} = 3.2$\n- $\\text{W}: s_{\\text{W}} = 3.5$\n\n假设残余力范数的替代收敛定律由下式给出\n$$\n\\|\\mathbf{F}\\|(E_{\\text{cut}}; H) \\equiv \\frac{A(H)}{E_{\\text{cut}}^{\\,p(H)}} + B(H)\\,\\exp\\!\\big(-\\gamma \\sqrt{E_{\\text{cut}}}\\big),\n$$\n其参数形式的启发来自于基组误差的变分标度行为：\n$$\nA(H) = a_0\\, H^{1.2}, \\quad p(H) = p_0 + \\beta \\ln(1+H), \\quad B(H) = b_0\\, H, \\quad \\gamma > 0,\n$$\n其中 $a_0$、$p_0$、$\\beta$、$b_0$ 和 $\\gamma$ 是正常数。对于数值实现，请使用\n$$\na_0 = 30, \\quad p_0 = 1.5, \\quad \\beta = 0.3, \\quad b_0 = 10^{-3}, \\quad \\gamma = 0.08,\n$$\n$E_{\\text{cut}}$ 的单位为 eV，$\\|\\mathbf{F}\\|$ 的单位为 eV/Å。选择这些值是为了反映金属体系中常见的投影缀加波/赝势表示下平面波收敛的典型尺度。\n\n您的任务是编写一个完整的程序，针对下方的每个测试用例，计算在每个指定的 $E_{\\text{cut}}$ 下的残余力范数 $\\|\\mathbf{F}\\|(E_{\\text{cut}})$，并返回能满足以下条件的最小 $E_{\\text{cut}}$ 值：\n$$\n\\|\\mathbf{F}\\|(E_{\\text{cut}}; H)  10^{-3} \\text{ eV/Å}.\n$$\n如果没有提供的 $E_{\\text{cut}}$ 值满足此严格不等式，则该测试用例返回 $-1.0$。\n\n待测试的成分和能量截断网格如下：\n\n- 测试用例 1 (通用高熵合金):\n  - 成分: $\\{(\\text{Ni}, 0.2), (\\text{Co}, 0.2), (\\text{Cr}, 0.2), (\\text{Fe}, 0.2), (\\text{Mn}, 0.2)\\}$\n  - $E_{\\text{cut}}$ 网格 (eV): $[300, 350, 400, 450, 500, 550, 600, 650, 700]$\n\n- 测试用例 2 (软合金):\n  - 成分: $\\{(\\text{Al}, 0.8), (\\text{Ni}, 0.2)\\}$\n  - $E_{\\text{cut}}$ 网格 (eV): $[350, 400, 450, 500, 550, 600]$\n\n- 测试用例 3 (硬质难熔合金):\n  - 成分: $\\{(\\text{Ti}, 0.2), (\\text{V}, 0.2), (\\text{Cr}, 0.2), (\\text{Mo}, 0.2), (\\text{W}, 0.2)\\}$\n  - $E_{\\text{cut}}$ 网格 (eV): $[450, 500, 550, 600, 650, 700, 750, 800]$\n\n- 测试用例 4 (对于非常硬的合金，网格不足):\n  - 成分: $\\{(\\text{W}, 0.6), (\\text{Mo}, 0.4)\\}$\n  - $E_{\\text{cut}}$ 网格 (eV): $[300, 350, 400, 450, 500]$\n\n- 测试用例 5 (在第一个网格点即已收敛):\n  - 成分: $\\{(\\text{Al}, 1.0)\\}$\n  - $E_{\\text{cut}}$ 网格 (eV): $[600, 650, 700]$\n\n数值要求和输出规范：\n- 所有计算必须使用上述单位进行：$E_{\\text{cut}}$ 的单位为 eV，$\\|\\mathbf{F}\\|$ 的单位为 eV/Å。\n- 必须强制执行严格不等式 $\\|\\mathbf{F}\\|  10^{-3}$；等于 $10^{-3}$ 的值不符合条件。\n- 您的程序应生成单行输出，其中包含五个测试用例的结果，格式为方括号内以逗号分隔的列表。每个条目必须是一个浮点数，表示该测试用例的最小截断能（单位为 eV），如果未达到要求则为 $-1.0$。例如，输出可能看起来像 \"[500.0,600.0,-1.0,700.0,650.0]\"，但必须反映上述测试套件的实际计算值。",
            "solution": "问题陈述已经过分析，并被确定为有效。它在科学上基于密度泛函理论（DFT）的既定框架，定义和参数完备一致，问题阐述清晰，并且表述客观。任务是实现一个给定的半经验模型，该模型用于描述残余离子力相对于平面波能量截断的收敛行为，并将此模型应用于代表不同高熵合金的几个测试用例。\n\n该问题的理论背景源于量子力学应用于多电子系统的基本原理。Hohenberg-Kohn 定理确立了系统的基态性质是基态电子密度 $n(\\mathbf{r})$ 的唯一泛函。DFT 的 Kohn-Sham (KS) 公式提供了一种实用的方法，通过将相互作用的电子问题映射到一个在有效势 $v_{\\text{eff}}(\\mathbf{r})$ 中运动的、易于处理的非相互作用电子系统，来求解该基态。KS 方程具有单粒子薛定谔方程的形式，通常通过自洽方式求解。\n\n在固态物理学中，特别是对于晶体材料，KS 轨道 $\\psi_i(\\mathbf{r})$ 在一个基组中展开。对于平面波基组，一个轨道表示为傅里叶级数：\n$$\n\\psi_{i,\\mathbf{k}}(\\mathbf{r}) = \\frac{1}{\\sqrt{\\Omega}} \\sum_{\\mathbf{G}} c_{i,\\mathbf{k}+\\mathbf{G}} e^{i(\\mathbf{k}+\\mathbf{G})\\cdot\\mathbf{r}},\n$$\n其中 $\\Omega$ 是晶胞体积，$\\mathbf{k}$ 是第一布里渊区中的一个波矢，$\\mathbf{G}$ 是倒格矢。为了计算上的可行性，这个无限求和被截断。标准的截断准则只包括动能小于指定截断能量 $E_{\\text{cut}}$ 的平面波：\n$$\n\\frac{\\hbar^2}{2m_e} |\\mathbf{k}+\\mathbf{G}|^2 \\le E_{\\text{cut}}.\n$$\n根据 Rayleigh-Ritz 变分原理，用有限基组计算出的总能量 $E(E_{\\text{cut}})$ 是真实基态能量（对于给定的交换相关泛函和赝势）的一个上界，并且随着 $E_{\\text{cut}} \\to \\infty$ 单调地从上方收敛。\n\n离子力计算为总能量相对于原子核坐标的负梯度，即 $\\mathbf{F}_I = -\\nabla_{\\mathbf{R}_I} E$。由于基组本身对离子位置的依赖性（在某些表述中），以及更普遍地，对于任何有限的 $E_{\\text{cut}}$，基组都是不完备的，因此即使离子处于其理论上的完美基态位置，也存在一个非零的残余力，通常称为 Pulay 力。这个残余力 $\\|\\mathbf{F}\\|$ 随着基组趋于完备（即 $E_{\\text{cut}} \\to \\infty$）而系统地减小至零。\n\n这种收敛的速度取决于 KS 波函数的平滑度。赝势的使用消除了全电子势在原子核附近的奇异行为以及核心电子波函数的快速振荡，从而产生更平滑的赝波函数，这些赝波函数可以用小得多的平面波基组来表示。然而，赝势的“硬度”——一个与势和波函数变化快慢相关的定性度量——在不同化学物种之间有所不同。具有深而局域的价态的元素（例如过渡金属 W、Mo 或第一行元素 N、O）“更硬”，与“更软”的元素（如 Al）相比，需要更高的 $E_{\\text{cut}}$ 才能准确计算力。该问题通过一个成分平均的硬度度量 $H = \\sum_{i} x_i s_i$ 来形式化这个概念。\n\n问题中提供的替代收敛定律，\n$$\n\\|\\mathbf{F}\\|(E_{\\text{cut}}; H) \\equiv \\frac{A(H)}{E_{\\text{cut}}^{\\,p(H)}} + B(H)\\,\\exp\\!\\big(-\\gamma \\sqrt{E_{\\text{cut}}}\\big),\n$$\n是一个具有物理动机的拟合函数。主导的代数项 $A(H) E_{\\text{cut}}^{-p(H)}$ 捕获了对具有有限可微性的函数进行基组展开时预期的误差幂律衰减。指数 $p(H)$ 和振幅 $A(H)$ 被设定为依赖于合金的有效硬度 $H$，反映了更硬的系统收敛更慢。次要的指数项 $B(H)\\exp(-\\gamma \\sqrt{E_{\\text{cut}}})$ 则解释了赝波函数中更平滑、更像解析函数部分的傅里叶系数的更快衰减，其中 $\\sqrt{E_{\\text{cut}}}$ 的依赖关系源于能量截断与波矢大小 $G_{\\text{max}} \\propto \\sqrt{E_{\\text{cut}}}$ 之间的关系。\n\n解决该问题的计算步骤如下：\n1.  定义所有固定的数值常数：与元素种类相关的硬度参数 $s_i$，以及模型系数 $a_0 = 30$，$p_0 = 1.5$，$\\beta = 0.3$，$b_0 = 10^{-3}$ 和 $\\gamma = 0.08$。力收敛阈值为 $10^{-3} \\text{ eV/Å}$。\n2.  对于所提供的五个测试用例中的每一个：\n    a.  解析合金成分 $\\{ ( \\text{element}_i, x_i ) \\}$ 和能量截断网格 $\\{ E_{\\text{cut}, j} \\}$。\n    b.  计算有效成分硬度 $H = \\sum_i x_i s_i$。\n    c.  使用 $H$ 的值，计算收敛定律中依赖于成分的参数：\n        $$A(H) = a_0\\, H^{1.2}$$\n        $$p(H) = p_0 + \\beta \\ln(1+H)$$\n        $$B(H) = b_0\\, H$$\n    d.  遍历按升序排列的所提供 $E_{\\text{cut}}$ 网格。对于每个 $E_{\\text{cut}}$ 值：\n        i.  使用完整的替代模型计算残余力范数 $\\|\\mathbf{F}\\|$。\n        ii. 检查是否满足条件 $\\|\\mathbf{F}\\|  10^{-3}$。\n    e.  如果满足条件，则当前的 $E_{\\text{cut}}$ 是网格中达到所需力收敛的最小值。该值被记录为该测试用例的结果，并终止对该用例的迭代。\n    f.  如果循环完成而条件从未满足，则表示在给定的网格上未实现收敛。在这种情况下，该测试用例的结果定义为 $-1.0$。\n3.  收集所有五个测试用例的结果到一个列表中，并将其格式化为指定的输出字符串。\n\n这个系统化的程序确保了对于每种合金成分，都正确地模拟了其相应的收敛行为，并根据问题的标准精确地确定了所需的能量截断。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimal energy cutoff to achieve a target residual force norm\n    for various high-entropy alloys based on a surrogate convergence model.\n    \"\"\"\n    # Define species-dependent hardness parameters\n    species_hardness = {\n        'Al': 1.0, 'Ni': 2.0, 'Co': 2.1, 'Cr': 2.5, 'Fe': 2.0,\n        'Mn': 2.3, 'Ti': 3.0, 'V': 3.0, 'Mo': 3.2, 'W': 3.5\n    }\n\n    # Define model constants\n    a0 = 30.0\n    p0 = 1.5\n    beta = 0.3\n    b0 = 1e-3\n    gamma = 0.08\n    force_threshold = 1e-3\n\n    # Define the test cases\n    test_cases = [\n        {\n            \"composition\": [('Ni', 0.2), ('Co', 0.2), ('Cr', 0.2), ('Fe', 0.2), ('Mn', 0.2)],\n            \"ecut_grid\": [300, 350, 400, 450, 500, 550, 600, 650, 700]\n        },\n        {\n            \"composition\": [('Al', 0.8), ('Ni', 0.2)],\n            \"ecut_grid\": [350, 400, 450, 500, 550, 600]\n        },\n        {\n            \"composition\": [('Ti', 0.2), ('V', 0.2), ('Cr', 0.2), ('Mo', 0.2), ('W', 0.2)],\n            \"ecut_grid\": [450, 500, 550, 600, 650, 700, 750, 800]\n        },\n        {\n            \"composition\": [('W', 0.6), ('Mo', 0.4)],\n            \"ecut_grid\": [300, 350, 400, 450, 500]\n        },\n        {\n            \"composition\": [('Al', 1.0)],\n            \"ecut_grid\": [600, 650, 700]\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        composition = case[\"composition\"]\n        ecut_grid = case[\"ecut_grid\"]\n\n        # Step 1: Calculate effective composition hardness H\n        H = sum(fraction * species_hardness[element] for element, fraction in composition)\n\n        # Step 2: Calculate composition-dependent parameters A(H), p(H), B(H)\n        A_H = a0 * (H ** 1.2)\n        p_H = p0 + beta * np.log(1 + H)\n        B_H = b0 * H\n\n        # Step 3: Iterate through E_cut grid to find the minimal cutoff\n        min_ecut_found = -1.0\n        \n        # The grids are already sorted, so the first one to meet the criterion is the minimal one\n        for ecut in ecut_grid:\n            # Calculate the residual force norm\n            algebraic_term = A_H / (ecut ** p_H)\n            exponential_term = B_H * np.exp(-gamma * np.sqrt(ecut))\n            force_norm = algebraic_term + exponential_term\n\n            # Check for strict inequality\n            if force_norm  force_threshold:\n                min_ecut_found = float(ecut)\n                break  # Found the minimal cutoff, move to the next test case\n        \n        results.append(min_ecut_found)\n\n    # Final output formatting\n    # The map(str, ...) is used to correctly format the floats, including the -1.0 cases.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "对于周期性晶体材料，其宏观性质（如总能量和应力）是通过在倒空间的布里渊区内进行积分得到的。在实际计算中，这个连续积分被离散的 $k$ 点网格上的求和所替代。本练习模拟了如何通过系统性地增加 $k$ 点网格密度，来确保总能量和应力等物理量收敛到稳定值，这是确保计算结果可靠性的另一个关键步骤。",
            "id": "3737416",
            "problem": "您的任务是设计并实现一个收敛性评估程序，该程序用于评估在密度泛函理论 (DFT) 中，对无序高熵合金 (HEA) 超胞的基态进行计算时，采用 $k$ 点网格对倒易空间进行采样的收敛性。计算设定为一个周期性的、金属性的无序 HEA 超胞，其中对 Kohn–Sham (KS) 总能量和应力有贡献的布里渊区 (BZ) 积分必须通过一组有限的 $k$ 点来近似。您可以依赖的基本原理包括：用于计算基态性质的密度泛函理论 (DFT) 的 Kohn–Sham 表述、周期性系统需要进行布里渊区 (BZ) 积分的要求，以及此类积分的求积误差随采样密度增加而减小的普适原理。您不得在这些基础之外假设任何特殊的简化公式。\n\n出发点是以下原理：每个原子的 KS 基态总能量（记为 $E$）是通过对布里渊区内的能带能量按占据数加权积分得到的；柯西应力张量分量 $\\sigma_{ij}$ 是通过基态能量对应变的导数求得的（例如，在适用情况下通过 Hellmann–Feynman 定理和 Pulay 修正）。通过有限 $k$ 点网格对 BZ 积分进行离散化会引入一个数值误差，该误差通常随着采样密度的增加而减小。对于无序 HEA 超胞，由无序引起的实空间扩大效应会使 BZ 折叠，并改变采样要求，但其收敛逻辑仍然取决于 $E$ 和应力是否随着 $k$ 点密度的增加而稳定。\n\n您的任务是构建一个程序，该程序能够：\n- 考虑针对给定无序 HEA 超胞的一系列逐渐密集的 $k$ 点网格（不一定是立方网格）。\n- 使用以下判据：相邻网格之间每个原子的总能量变化 $|\\Delta E|$ 必须严格小于每个原子 $1\\,\\mathrm{meV}$（即 $|\\Delta E|  0.001\\,\\mathrm{eV}$），并且相邻网格之间的应力大小变化 $|\\Delta \\sigma|$ 必须严格小于 $0.1\\,\\mathrm{GPa}$（即 $|\\Delta \\sigma|  0.1\\,\\mathrm{GPa}$）。\n- 选择总 $k$ 点数 $N_k = k_x \\cdot k_y \\cdot k_z$ 最少的网格，在该网格上，从前一个网格到当前网格的过渡同时满足了上述两个判据。\n- 如果在所提供的序列中不存在这样的网格，则为该测试用例输出 $-1$。\n\n假设应力以标量大小的形式提供（例如，应力张量的范数或与收敛性评估相关的某个合适的应力标量描述符）。所有总能量均为每个原子的能量。\n\n您必须实现一个程序来处理以下测试用例集。对于每个用例 $c$，您会得到：\n- 一系列从粗到细采样的 $k$ 点网格 $G^{(c)} = \\{(k_x,k_y,k_z)\\}$。\n- 与网格对齐的每个原子的总能量列表 $E^{(c)}$（单位：$\\mathrm{eV}$）。\n- 与网格对齐的应力大小列表 $\\sigma^{(c)}$（单位：$\\mathrm{GPa}$）。\n\n您的程序必须在相邻网格之间应用严格的收敛判据 $|\\Delta E|  0.001\\,\\mathrm{eV}$ 和 $|\\Delta \\sigma|  0.1\\,\\mathrm{GPa}$，并返回第一个同时满足这两个条件的最小 $N_k$，如果无满足条件的网格则返回 $-1$。\n\n使用以下测试集：\n\n- 用例 $1$：\n  网格 $G^{(1)}$: $[(2,2,2),(3,3,3),(4,4,4),(6,6,6),(8,8,8)]$。\n  每个原子的能量 $E^{(1)}$: $[-6.3200,-6.3350,-6.3405,-6.3412,-6.3418]\\,\\mathrm{eV}$。\n  应力大小 $\\sigma^{(1)}$: $[2.05,1.26,0.98,0.92,0.91]\\,\\mathrm{GPa}$。\n\n- 用例 $2$：\n  网格 $G^{(2)}$: $[(1,1,1),(2,2,2),(3,3,3),(4,4,4),(5,5,5)]$。\n  每个原子的能量 $E^{(2)}$: $[-7.1250,-7.1300,-7.1310,-7.1314,-7.1316]\\,\\mathrm{eV}$。\n  应力大小 $\\sigma^{(2)}$: $[0.55,0.46,0.42,0.41,0.405]\\,\\mathrm{GPa}$。\n\n- 用例 $3$：\n  网格 $G^{(3)}$: $[(1,1,1),(2,2,2),(3,3,3),(4,4,4),(6,6,6)]$。\n  每个原子的能量 $E^{(3)}$: $[-5.0000,-5.1200,-5.1550,-5.1600,-5.1622]\\,\\mathrm{eV}$。\n  应力大小 $\\sigma^{(3)}$: $[1.80,1.40,1.30,1.25,1.22]\\,\\mathrm{GPa}$。\n\n- 用例 $4$ (各向异性网格)：\n  网格 $G^{(4)}$: $[(2,2,1),(3,3,1),(3,3,2),(4,4,2),(4,4,3)]$。\n  每个原子的能量 $E^{(4)}$: $[-6.0000,-6.0200,-6.0280,-6.0290,-6.0296]\\,\\mathrm{eV}$。\n  应力大小 $\\sigma^{(4)}$: $[1.10,0.85,0.80,0.78,0.779]\\,\\mathrm{GPa}$。\n\n- 用例 $5$ (非单调小幅波动)：\n  网格 $G^{(5)}$: $[(2,2,2),(3,3,3),(4,4,4),(6,6,6),(8,8,8)]$。\n  每个原子的能量 $E^{(5)}$: $[-8.0000,-8.0006,-8.0010,-8.0012,-8.0013]\\,\\mathrm{eV}$。\n  应力大小 $\\sigma^{(5)}$: $[0.95,0.90,0.88,0.879,0.8785]\\,\\mathrm{GPa}$。\n\n边界与边缘情况要求：\n- 短语“低于 $1\\,\\mathrm{meV}$”和“低于 $0.1\\,\\mathrm{GPa}$”表示严格不等式：$|\\Delta E|  0.001\\,\\mathrm{eV}$ 且 $|\\Delta \\sigma|  0.1\\,\\mathrm{GPa}$。相等情况不满足判据。\n- 所选网格对应于两个差异同时低于阈值的那对网格中较精细的一个。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,\\dots]$），其中每个 $result_c$ 是用例 $c$ 选定的总 $k$ 点数 $N_k$，如果在提供的序列中未达到收敛，则为 $-1$。不允许外部输入，也不应打印任何额外文本。所有能量必须使用单位 $\\mathrm{eV}$/原子，所有应力大小必须使用单位 $\\mathrm{GPa}$。",
            "solution": "所述问题已经过形式化验证。\n\n**步骤 1：提取已知条件**\n- **任务**：为密度泛函理论 (DFT) 中应用于高熵合金 (HEA) 超胞的 $k$ 点网格采样设计并实现一个收敛性评估程序。\n- **原理**：每个原子的 Kohn-Sham (KS) 总能量 $E$ 和柯西应力张量分量 $\\sigma_{ij}$ 是通过布里渊区 (BZ) 积分获得的。使用有限 $k$ 点网格进行离散化会引入必须使其收敛的数值误差。\n- **收敛判据**：\n    1. 相邻网格之间每个原子的总能量变化 $|\\Delta E|$ 必须严格小于每个原子 $1\\,\\mathrm{meV}$，即 $|\\Delta E|  0.001\\,\\mathrm{eV}$。\n    2. 相邻网格之间的应力大小变化 $|\\Delta \\sigma|$ 必须严格小于 $0.1\\,\\mathrm{GPa}$，即 $|\\Delta \\sigma|  0.1\\,\\mathrm{GPa}$。\n- **选择规则**：选择总 $k$ 点数 $N_k = k_x \\cdot k_y \\cdot k_z$ 最少的网格，在该网格上同时满足两个判据。被选择的网格是进行比较的两个网格中较精细的那一个。\n- **未收敛情况**：如果在提供的序列中没有网格满足判据，则该用例的输出为 $-1$。\n- **输入数据**：对于每个用例 $c$，提供一个网格列表 $G^{(c)}$、一个能量列表 $E^{(c)}$（单位 $\\mathrm{eV}$）和一个应力大小列表 $\\sigma^{(c)}$（单位 $\\mathrm{GPa}$）。\n- **测试集**：\n    - **用例 $1$**：$G^{(1)} = [(2,2,2),(3,3,3),(4,4,4),(6,6,6),(8,8,8)]$, $E^{(1)} = [-6.3200,-6.3350,-6.3405,-6.3412,-6.3418]\\,\\mathrm{eV}$, $\\sigma^{(1)} = [2.05,1.26,0.98,0.92,0.91]\\,\\mathrm{GPa}$。\n    - **用例 $2$**：$G^{(2)} = [(1,1,1),(2,2,2),(3,3,3),(4,4,4),(5,5,5)]$, $E^{(2)} = [-7.1250,-7.1300,-7.1310,-7.1314,-7.1316]\\,\\mathrm{eV}$, $\\sigma^{(2)} = [0.55,0.46,0.42,0.41,0.405]\\,\\mathrm{GPa}$。\n    - **用例 $3$**：$G^{(3)} = [(1,1,1),(2,2,2),(3,3,3),(4,4,4),(6,6,6)]$, $E^{(3)} = [-5.0000,-5.1200,-5.1550,-5.1600,-5.1622]\\,\\mathrm{eV}$, $\\sigma^{(3)} = [1.80,1.40,1.30,1.25,1.22]\\,\\mathrm{GPa}$。\n    - **用例 $4$**：$G^{(4)} = [(2,2,1),(3,3,1),(3,3,2),(4,4,2),(4,4,3)]$, $E^{(4)} = [-6.0000,-6.0200,-6.0280,-6.0290,-6.0296]\\,\\mathrm{eV}$, $\\sigma^{(4)} = [1.10,0.85,0.80,0.78,0.779]\\,\\mathrm{GPa}$。\n    - **用例 $5$**：$G^{(5)} = [(2,2,2),(3,3,3),(4,4,4),(6,6,6),(8,8,8)]$, $E^{(5)} = [-8.0000,-8.0006,-8.0010,-8.0012,-8.0013]\\,\\mathrm{eV}$, $\\sigma^{(5)} = [0.95,0.90,0.88,0.879,0.8785]\\,\\mathrm{GPa}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题被正确定位在 DFT 的标准框架内。对于任何周期性系统的电子结构计算，关于 $k$ 点采样的 BZ 积分收敛是基础且强制性的步骤。总能量 ($1\\,\\mathrm{meV/}$原子) 和应力 ($0.1\\,\\mathrm{GPa}$) 的收敛判据是计算材料科学中使用的标准、实际的数值。\n- **适定性**：该问题是适定的。它提供了预先计算的数据序列和一个确定性、无歧义的算法以供应用。对于每个输入用例，都存在一个唯一的、稳定的、有意义的解（一个特定的 $N_k$ 值或 $-1$）。\n- **客观性**：语言精确客观。判据是定量的，并基于严格不等式。无需主观解释。\n\n**步骤 3：结论与行动**\n该问题是有效的。它在科学上是合理的、适定的、客观的且自洽的。该任务是计算物理学中一个标准工作流程的形式化。将提供一个解决方案。\n\n**基于原理的解决方案设计**\n\n目标是确定在 DFT 计算中，为使总能量和应力达到预定义的数值精度水平所需的最小 $k$ 点网格密度。这是一个数值求积收敛问题。\n\n在用于周期性固体的 DFT 的 Kohn-Sham 表述中，诸如总能量 $E$ 之类的可观测量是通过对第一布里渊区 (BZ) 上的量进行积分来计算的。例如，基态能量的电子部分涉及对占据带的能带能量 $\\varepsilon_{n}(\\mathbf{k})$ 积分进行求和：\n$$ E_{elec} \\propto \\sum_{n} \\int_{\\mathrm{BZ}} w_{n}(\\mathbf{k}) \\varepsilon_{n}(\\mathbf{k}) d\\mathbf{k} $$\n其中 $w_{n}(\\mathbf{k})$ 是与占据数相关的权重。应力张量分量 $\\sigma_{ij}$ 由总能量对无穷小应变的响应导出，这也涉及 BZ 积分。\n\n在数值上，这些积分通过对一个规则的 $k$ 点网格进行离散求和来近似：\n$$ \\int_{\\mathrm{BZ}} f(\\mathbf{k}) d\\mathbf{k} \\approx \\sum_{i=1}^{N_k} \\omega_i f(\\mathbf{k}_i) $$\n其中 $\\mathbf{k}_i$ 是采样点，$\\omega_i$ 是积分权重，$N_k$ 是网格中的总点数。随着 $N_k$ 的增加，这种近似的精度会提高。\n\n所指定的程序是这一收敛原理的算法实现。我们给定了一系列在逐渐密集的 $k$ 点网格上执行的计算。设网格序列为 $\\{G_0, G_1, \\dots, G_{M-1}\\}$，其中每个网格 $G_i$ 由 $(k_x, k_y, k_z)_i$ 定义。对于每个网格 $G_i$，我们有相应的计算出的每个原子的总能量 $E_i$ 和应力大小 $\\sigma_i$。\n\n收敛性评估算法按以下步骤进行：\n$1$. 该过程从比较前两个网格 $G_0$ 和 $G_1$ 的结果开始，并按顺序继续。对每对连续的网格 $(G_{i-1}, G_i)$（其中 $i=1, 2, \\dots, M-1$）进行比较。\n\n$2$. 对于每个步骤 $i$，我们计算每个原子的能量绝对差 $|\\Delta E_i|$ 和应力大小的绝对差 $|\\Delta \\sigma_i|$：\n$$ |\\Delta E_i| = |E_i - E_{i-1}| $$\n$$ |\\Delta \\sigma_i| = |\\sigma_i - \\sigma_{i-1}| $$\n\n$3$. 我们检查两个差值是否同时满足严格不等式判据：\n$$ |\\Delta E_i|  E_{tol} \\quad \\text{and} \\quad |\\Delta \\sigma_i|  \\sigma_{tol} $$\n其中容差给定为 $E_{tol} = 0.001\\,\\mathrm{eV}$ 和 $\\sigma_{tol} = 0.1\\,\\mathrm{GPa}$。\n\n$4$. 第一个满足这两个条件的网格 $G_i$ 被认为是收敛的网格。问题要求报告此网格的总 $k$ 点数 $N_k$，其计算公式为 $N_k = (k_x)_i \\cdot (k_y)_i \\cdot (k_z)_i$。\n\n$5$. 一旦找到第一个这样的网格 $G_i$，搜索就终止，因为这对应于满足收敛标准的“最小网格”（即计算成本最低的网格）。\n\n$6$. 如果遍历所有从 $1$ 到 $M-1$ 的 $i$ 后，仍未找到任何满足两个判据的 $i$，则表示在提供的计算集合内未达到收敛。在这种情况下，指定的输出为 $-1$。\n\n此程序独立地应用于每个测试用例。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Processes a suite of DFT convergence test cases to find the minimal k-point grid satisfying\n    predefined energy and stress convergence criteria.\n    \"\"\"\n    \n    test_cases = [\n        {\n            \"grids\": [(2, 2, 2), (3, 3, 3), (4, 4, 4), (6, 6, 6), (8, 8, 8)],\n            \"energies\": [-6.3200, -6.3350, -6.3405, -6.3412, -6.3418],\n            \"stresses\": [2.05, 1.26, 0.98, 0.92, 0.91],\n        },\n        {\n            \"grids\": [(1, 1, 1), (2, 2, 2), (3, 3, 3), (4, 4, 4), (5, 5, 5)],\n            \"energies\": [-7.1250, -7.1300, -7.1310, -7.1314, -7.1316],\n            \"stresses\": [0.55, 0.46, 0.42, 0.41, 0.405],\n        },\n        {\n            \"grids\": [(1, 1, 1), (2, 2, 2), (3, 3, 3), (4, 4, 4), (6, 6, 6)],\n            \"energies\": [-5.0000, -5.1200, -5.1550, -5.1600, -5.1622],\n            \"stresses\": [1.80, 1.40, 1.30, 1.25, 1.22],\n        },\n        {\n            \"grids\": [(2, 2, 1), (3, 3, 1), (3, 3, 2), (4, 4, 2), (4, 4, 3)],\n            \"energies\": [-6.0000, -6.0200, -6.0280, -6.0290, -6.0296],\n            \"stresses\": [1.10, 0.85, 0.80, 0.78, 0.779],\n        },\n        {\n            \"grids\": [(2, 2, 2), (3, 3, 3), (4, 4, 4), (6, 6, 6), (8, 8, 8)],\n            \"energies\": [-8.0000, -8.0006, -8.0010, -8.0012, -8.0013],\n            \"stresses\": [0.95, 0.90, 0.88, 0.879, 0.8785],\n        },\n    ]\n\n    # Convergence criteria\n    energy_threshold = 0.001  # eV per atom\n    stress_threshold = 0.1     # GPa\n\n    results = []\n\n    for case in test_cases:\n        grids = case[\"grids\"]\n        energies = case[\"energies\"]\n        stresses = case[\"stresses\"]\n        \n        found_convergence = False\n        \n        # Iterate from the second grid onwards to compare with the previous one\n        for i in range(1, len(grids)):\n            # Calculate the absolute difference in energy and stress\n            delta_e = abs(energies[i] - energies[i-1])\n            delta_s = abs(stresses[i] - stresses[i-1])\n            \n            # Check if both criteria are strictly met\n            if delta_e  energy_threshold and delta_s  stress_threshold:\n                # If converged, get the current grid and calculate total k-points\n                converged_grid = grids[i]\n                # Using np.prod is a clean way to multiply tuple elements\n                num_k_points = int(np.prod(converged_grid))\n                results.append(num_k_points)\n                found_convergence = True\n                break  # Stop at the first grid that meets the criteria\n        \n        if not found_convergence:\n            results.append(-1)\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在处理金属体系时，费米能级处电子占有数的急剧变化会给自洽场（SCF）计算带来收敛性难题。电子展宽（smearing）技术通过平滑占有数函数来解决这一问题，但过大的展宽值会引入非物理的电子温度，影响基态性质的准确性。本练习旨在通过优化一个模拟总误差的代理模型，探索如何在提高收敛稳定性和减小物理偏差之间找到最佳的展宽宽度 $\\sigma$。",
            "id": "3737495",
            "problem": "您的任务是设计一个程序，该程序在一个基于原理的模型（该模型描述了展宽如何影响数值收敛和热展宽赝象）的基础上，确定在密度泛函理论 (DFT) 的基态计算中，金属高熵合金 (HEA) 的最佳电子展宽宽度。其基本依据是电子结构的 Kohn-Sham 形式及其由 Mermin 提出的有限温推广，其中占据数由费米-狄拉克分布展宽。该程序必须是纯数学的，并对一个通过物理上合理的标度校准的代理模型执行以下优化。在整个问题中，用 $\\sigma$ 表示展宽宽度，并以电子伏特 (eV) 为单位。数值必须以小数点后六位的小数（浮点数）形式返回。\n\n背景和定义：\n- 在金属体系中，较小的 $\\sigma$ 会导致费米面采样不佳，从而产生含噪声的力和应力。由于化学势附近的占据数变得平滑，这种与收敛相关的噪声会随着 $\\sigma$ 的增加而减小。\n- 相反，较大的 $\\sigma$ 会在基态的力和应力中引入热展宽赝象。在 Kohn-Sham DFT 的 Mermin 扩展中，有限的电子温度会使自由能相对于零温基态能量发生偏移。根据 Sommerfeld 展开，领头阶修正与 $(k_B T)^2$ 成比例，并将 $k_B T$ 等同于 $\\sigma$（以 eV 为单位测量），这会产生一个在 $\\sigma$ 较小时近似以 $\\sigma^2$ 增长的偏差项。\n\n待优化的模型：\n- 对于给定的 HEA 和数值设置（固定的 k 点网格和平面波截断能），假设总误差的组合标量度量可以表示为\n$$\nM(\\sigma) \\equiv A\\,\\sigma^{-p} + C\\,\\sigma^2,\n$$\n其中 $A  0$ 量化了与收敛相关的噪声的振幅（在固定权重下聚合了力和应力的贡献），$p  0$ 控制了数值噪声随 $\\sigma$ 增加而衰减的强度，而 $C  0$ 则通过与 $\\sigma$ 的二次方缩放关系量化了力和应力中热展宽赝象的强度。这种函数形式与费米面积分误差的减少以及来自 Sommerfeld 展开的二次领头阶偏差是一致的。\n- 物理上可接受的展宽被限制在一个闭区间 $[\\sigma_{\\min}, \\sigma_{\\max}]$（单位为 eV）内，最佳展宽宽度是 $M(\\sigma)$ 在此区间上的最小值点。\n\n您的任务：\n- 对于下面套件中的每个测试用例，计算使 $M(\\sigma)$ 在边界约束 $\\sigma \\in [\\sigma_{\\min}, \\sigma_{\\max}]$ 下最小化的最佳 $\\sigma^\\star$。以 eV 为单位返回 $\\sigma^\\star$。如果无约束最小值点落在区间之外，则选择最近的边界（$\\sigma_{\\min}$ 或 $\\sigma_{\\max}$）。将每个结果表示为四舍五入到小数点后六位的浮点数。\n\n测试套件：\n- 使用以下参数集 $(A, p, C, \\sigma_{\\min}, \\sigma_{\\max})$，所有单位均保持一致，以使 $M(\\sigma)$ 无量纲且 $\\sigma$ 的单位为 eV：\n  - 案例 1：$A = 0.08$，$p = 1.0$，$C = 12.0$，$\\sigma_{\\min} = 0.01$ eV，$\\sigma_{\\max} = 0.25$ eV。\n  - 案例 2：$A = 0.00001$，$p = 1.0$，$C = 20.0$，$\\sigma_{\\min} = 0.01$ eV，$\\sigma_{\\max} = 0.20$ eV。\n  - 案例 3：$A = 2.0$，$p = 1.0$，$C = 1.0$，$\\sigma_{\\min} = 0.01$ eV，$\\sigma_{\\max} = 0.25$ eV。\n  - 案例 4：$A = 0.20$，$p = 1.5$，$C = 8.0$，$\\sigma_{\\min} = 0.01$ eV，$\\sigma_{\\max} = 0.30$ eV。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个案例的结果，结果为方括号括起来的、以逗号分隔的列表，顺序如上所述，每个值都四舍五入到小数点后六位。例如，格式必须是\n$[x_1,x_2,x_3,x_4]$\n其中每个 $x_i$ 是相应案例的最佳 $\\sigma^\\star$（单位为 eV）。",
            "solution": "用户要求设计一个程序，用于确定在金属高熵合金 (HEA) 的基态密度泛函理论 (DFT) 计算中，最佳的电子展宽宽度 $\\sigma$。该优化基于一个总组合误差度量 $M(\\sigma)$ 的代理模型，该模型是展宽宽度 $\\sigma$ 的函数。\n\n问题陈述了总误差度量由以下函数给出：\n$$\nM(\\sigma) = A\\,\\sigma^{-p} + C\\,\\sigma^2\n$$\n其中参数 $A  0$、$p  0$ 和 $C  0$ 是给定的常数。该模型代表了一种具有物理动机的权衡：$A\\,\\sigma^{-p}$ 项模拟了与费米面积分相关的数值噪声，该噪声随 $\\sigma$ 的增加而减小；而 $C\\,\\sigma^2$ 项模拟了由热展宽赝象引入的偏差，该偏差随 $\\sigma$ 的增加而增大。参数 $\\sigma$ 以电子伏特 (eV) 为单位。任务是找到使 $M(\\sigma)$ 在指定的闭区间 $[\\sigma_{\\min}, \\sigma_{\\max}]$ 内最小的 $\\sigma$ 值，我们称之为 $\\sigma^\\star$。\n\n该问题是一个受约束的一维优化问题。函数 $M(\\sigma)$ 在 $\\sigma  0$（物理相关域）上是连续且可微的。一个连续函数在闭有界区间上的最小值保证存在，并且位于区间内部的临界点（一阶导数为零处）或区间的某个边界点。\n\n首先，我们通过寻找 $M(\\sigma)$ 的临界点来定位无约束最小值。这包括计算 $M(\\sigma)$ 对 $\\sigma$ 的一阶导数并将其设为零。\n一阶导数是：\n$$\n\\frac{dM}{d\\sigma} = \\frac{d}{d\\sigma} (A\\sigma^{-p} + C\\sigma^2) = -pA\\sigma^{-p-1} + 2C\\sigma\n$$\n为了评估极值的性质，我们计算二阶导数：\n$$\n\\frac{d^2M}{d\\sigma^2} = \\frac{d}{d\\sigma} (-pA\\sigma^{-p-1} + 2C\\sigma) = (-p)(-p-1)A\\sigma^{-p-2} + 2C = p(p+1)A\\sigma^{-p-2} + 2C\n$$\n鉴于问题约束 $A  0$、$p  0$ 和 $C  0$，二阶导数 $\\frac{d^2M}{d\\sigma^2}$ 对于所有 $\\sigma  0$ 都是严格为正的。这证明了 $M(\\sigma)$ 在其定义域上是一个严格凸函数。因此，任何临界点都对应一个唯一的全局最小值。\n\n我们通过令 $\\frac{dM}{d\\sigma} = 0$ 来找到无约束最小值点，我们将其表示为 $\\sigma_0$：\n$$\n-pA\\sigma_0^{-p-1} + 2C\\sigma_0 = 0\n$$\n假设 $\\sigma_0  0$，我们可以重新整理方程：\n$$\n2C\\sigma_0 = pA\\sigma_0^{-p-1}\n$$\n两边同乘以 $\\sigma_0^{p+1}$ 得：\n$$\n2C\\sigma_0^{p+2} = pA\n$$\n最后，解出 $\\sigma_0$：\n$$\n\\sigma_0 = \\left( \\frac{pA}{2C} \\right)^{\\frac{1}{p+2}}\n$$\n这个 $\\sigma_0$ 是在没有任何约束的情况下使误差度量最小化的展宽宽度值。\n\n受约束问题解 $\\sigma^\\star$ 必须位于区间 $[\\sigma_{\\min}, \\sigma_{\\max}]$ 内。$M(\\sigma)$ 的凸性意味着该函数在 $\\sigma  \\sigma_0$ 时递减，在 $\\sigma  \\sigma_0$ 时递增。因此，区间 $[\\sigma_{\\min}, \\sigma_{\\max}]$ 上的最小值点按如下方式确定：\n1. 如果 $\\sigma_0  \\sigma_{\\min}$，那么 $M(\\sigma)$ 在整个区间 $[\\sigma_{\\min}, \\sigma_{\\max}]$ 上是递增的。因此，最小值必须出现在左边界：$\\sigma^\\star = \\sigma_{\\min}$。\n2. 如果 $\\sigma_0  \\sigma_{\\max}$，那么 $M(\\sigma)$ 在整个区间 $[\\sigma_{\\min}, \\sigma_{\\max}]$ 上是递减的。因此，最小值必须出现在右边界：$\\sigma^\\star = \\sigma_{\\max}$。\n3. 如果 $\\sigma_{\\min} \\le \\sigma_0 \\le \\sigma_{\\max}$，则无约束最小值点先验地位于可行区域内，因此它也是受约束的最小值点：$\\sigma^\\star = \\sigma_0$。\n\n此逻辑等价于将 $\\sigma_0$ 的值限制在区间 $[\\sigma_{\\min}, \\sigma_{\\max}]$ 内，可以表示为 $\\sigma^\\star = \\max(\\sigma_{\\min}, \\min(\\sigma_0, \\sigma_{\\max}))$。\n\n我们现在将此过程应用于给定的测试用例。\n\n**案例 1：** $A = 0.08$，$p = 1.0$，$C = 12.0$，$\\sigma_{\\min} = 0.01$ eV，$\\sigma_{\\max} = 0.25$ eV。\n$$ \\sigma_0 = \\left( \\frac{(1.0)(0.08)}{2(12.0)} \\right)^{\\frac{1}{1.0+2}} = \\left( \\frac{0.08}{24} \\right)^{\\frac{1}{3}} \\approx 0.14938016 \\text{ eV} $$\n因为 $0.01 \\le \\sigma_0 \\le 0.25$，所以最佳值为 $\\sigma^\\star_1 = \\sigma_0$。四舍五入到六位小数，结果是 $0.149380$。\n\n**案例 2：** $A = 0.00001$，$p = 1.0$，$C = 20.0$，$\\sigma_{\\min} = 0.01$ eV，$\\sigma_{\\max} = 0.20$ eV。\n$$ \\sigma_0 = \\left( \\frac{(1.0)(0.00001)}{2(20.0)} \\right)^{\\frac{1}{1.0+2}} = \\left( \\frac{10^{-5}}{40} \\right)^{\\frac{1}{3}} \\approx 0.00629961 \\text{ eV} $$\n因为 $\\sigma_0  0.01$，所以最佳值被限制在下界：$\\sigma^\\star_2 = \\sigma_{\\min} = 0.01$。作为小数点后六位的浮点数，结果是 $0.010000$。\n\n**案例 3：** $A = 2.0$，$p = 1.0$，$C = 1.0$，$\\sigma_{\\min} = 0.01$ eV，$\\sigma_{\\max} = 0.25$ eV。\n$$ \\sigma_0 = \\left( \\frac{(1.0)(2.0)}{2(1.0)} \\right)^{\\frac{1}{1.0+2}} = (1.0)^{\\frac{1}{3}} = 1.0 \\text{ eV} $$\n因为 $\\sigma_0  0.25$，所以最佳值被限制在上界：$\\sigma^\\star_3 = \\sigma_{\\max} = 0.25$。作为小数点后六位的浮点数，结果是 $0.250000$。\n\n**案例 4：** $A = 0.20$，$p = 1.5$，$C = 8.0$，$\\sigma_{\\min} = 0.01$ eV，$\\sigma_{\\max} = 0.30$ eV。\n$$ \\sigma_0 = \\left( \\frac{(1.5)(0.20)}{2(8.0)} \\right)^{\\frac{1}{1.5+2}} = \\left( \\frac{0.3}{16} \\right)^{\\frac{1}{3.5}} \\approx 0.22279580 \\text{ eV} $$\n因为 $0.01 \\le \\sigma_0 \\le 0.30$，所以最佳值为 $\\sigma^\\star_4 = \\sigma_0$。四舍五入到六位小数，结果是 $0.222796$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the optimal electronic smearing width for a series of test cases\n    based on a surrogate model for total error in DFT calculations.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (A, p, C, sigma_min, sigma_max)\n    test_cases = [\n        (0.08, 1.0, 12.0, 0.01, 0.25),\n        (0.00001, 1.0, 20.0, 0.01, 0.20),\n        (2.0, 1.0, 1.0, 0.01, 0.25),\n        (0.20, 1.5, 8.0, 0.01, 0.30),\n    ]\n\n    results = []\n    for case in test_cases:\n        A, p, C, sigma_min, sigma_max = case\n\n        # Calculate the unconstrained minimizer, sigma_0.\n        # The formula is sigma_0 = (p*A / (2*C))**(1 / (p + 2)).\n        # We ensure all constants are floats for the division and exponentiation.\n        # A, p, C are guaranteed to be positive.\n        base = (p * A) / (2.0 * C)\n        exponent = 1.0 / (p + 2.0)\n        sigma_0 = base ** exponent\n\n        # The optimal sigma_star is the unconstrained minimizer clipped to the\n        # allowed interval [sigma_min, sigma_max].\n        # This is due to the convexity of the error function M(sigma).\n        sigma_star = np.clip(sigma_0, sigma_min, sigma_max)\n        \n        results.append(sigma_star)\n\n    # Format the results as strings with six decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Self-contained execution\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}