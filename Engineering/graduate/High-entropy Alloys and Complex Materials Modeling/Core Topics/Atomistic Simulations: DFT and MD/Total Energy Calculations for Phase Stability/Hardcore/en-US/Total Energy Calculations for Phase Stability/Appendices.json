{
    "hands_on_practices": [
        {
            "introduction": "Determining a material's preferred crystal structure is a cornerstone of phase stability analysis. This exercise guides you through the fundamental process of taking discrete total energy versus volume data, the typical output of first-principles calculations, and fitting it to find the equilibrium state for competing phases . By comparing the minimum energies, you will directly predict the ground-state structure, a critical skill for any computational materials scientist.",
            "id": "3763371",
            "problem": "You are given discrete total-energy versus volume data for Face-Centered Cubic (FCC) and Body-Centered Cubic (BCC) crystal structures of a single equiatomic high-entropy alloy. Assume the Born–Oppenheimer approximation holds and the total electronic energy at fixed atomic positions defines a well-behaved equation of state near equilibrium. In the vicinity of the minimum, approximate the total energy as a cubic polynomial in volume, and determine the minimum-energy volume by calculus principles.\n\nStarting from the following foundational bases:\n- The Born–Oppenheimer approximation asserts that the total electronic energy at fixed nuclei positions defines a potential energy surface for the atoms.\n- Near a stable equilibrium volume, the total energy as a function of volume can be approximated by a low-order Taylor series. For practical fitting over a finite volume window, model the energy by a cubic polynomial in volume, i.e., fit $$E(V) = a_3 V^3 + a_2 V^2 + a_1 V + a_0$$ using linear least squares, where $E$ is energy and $V$ is volume.\n- The equilibrium volume is given by the stationarity condition $$\\frac{dE}{dV} = 0$$ with the positive curvature condition $$\\frac{d^2E}{dV^2} > 0$$ for a minimum. If the computed stationary point lies outside the sampled interval, or does not satisfy the curvature condition in the sampled interval, select the minimum energy among the interval endpoints.\n\nImplement a program that, for each test case below:\n1. Fits a cubic polynomial $E(V)$ independently to the FCC and BCC datasets by minimizing the sum of squared residuals.\n2. Finds the minimizing volume $V^\\star$ within the sampled interval by solving $$\\frac{dE}{dV} = 0$$ and testing $$\\frac{d^2E}{dV^2} > 0$$, else uses the endpoint with the lowest energy.\n3. Evaluates the minimum energy for FCC, $E^\\text{FCC}_\\text{min}$, and for BCC, $E^\\text{BCC}_\\text{min}$.\n4. Outputs the energy difference $\\Delta E = E^\\text{FCC}_\\text{min} - E^\\text{BCC}_\\text{min}$ expressed in electronvolts per atom (eV/atom) as a float.\n\nPhysical and numerical units:\n- Volumes are per atom and given in cubic angstroms per atom ($\\text{\\AA}^3/\\text{atom}$).\n- Energies are per atom and given in electronvolts per atom ($\\text{eV}/\\text{atom}$).\n- Express the final energy differences $\\Delta E$ in electronvolts per atom ($\\text{eV}/\\text{atom}$) as floats.\n\nTest suite and data:\nProvide the following five test cases as lists of volume and energy pairs for FCC and BCC. For each case, the program must compute $\\Delta E$.\n\nCase A (happy path; distinct minima):\n- FCC volumes $[14.5, 15.0, 15.5, 16.0, 16.5, 17.0]$ with energies $[-5.1505, -5.1770, -5.19375, -5.2000, -5.1935, -5.1730]$.\n- BCC volumes $[14.5, 15.0, 15.5, 16.0, 16.5, 17.0]$ with energies $[-4.979375, -5.0500, -5.103625, -5.1410, -5.162875, -5.1700]$.\n\nCase B (BCC stable; FCC higher):\n- FCC volumes $[15.0, 15.5, 16.0, 16.5, 17.0, 17.5]$ with energies $[-5.078528, -5.105643, -5.118808, -5.117273, -5.100288, -5.067103]$.\n- BCC volumes $[15.0, 15.5, 16.0, 16.5, 17.0, 17.5]$ with energies $[-5.123744, -5.137624, -5.138904, -5.126084, -5.097664, -5.052144]$.\n\nCase C (near-degenerate; very small difference):\n- FCC volumes $[15.0, 15.3, 15.6, 15.9, 16.2]$ with energies $[-5.992908, -5.9982135, -6.0000, -5.9981865, -5.992692]$.\n- BCC volumes $[15.0, 15.3, 15.6, 15.9, 16.2]$ with energies $[-5.9817713, -5.9913752, -5.9971019, -5.9990, -5.9971181]$.\n\nCase D (boundary condition; minimum outside interval):\n- FCC volumes $[13.0, 13.5, 14.0, 14.5]$ with energies $[-4.3800, -4.4325, -4.4700, -4.4925]$.\n- BCC volumes $[13.0, 13.5, 14.0, 14.5]$ with energies $[-4.46125, -4.4350, -4.39125, -4.3300]$.\n\nCase E (flat curvature; slight noise):\n- FCC volumes $[10.0, 10.5, 11.0, 11.5, 12.0]$ with energies $[-2.9953, -2.99855, -3.0000, -2.99885, -2.99485]$.\n- BCC volumes $[10.0, 10.5, 11.0, 11.5, 12.0]$ with energies $[-2.98656, -2.99196, -2.99476, -2.99456, -2.9910]$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example `[x_1,x_2,x_3,x_4,x_5]` where each $x_i$ is the float $\\Delta E$ in electronvolts per atom ($\\text{eV}/\\text{atom}$), computed for the corresponding test case in the order A, B, C, D, E.",
            "solution": "The posed problem requires the determination of the relative phase stability between the Face-Centered Cubic (FCC) and Body-Centered Cubic (BCC) crystal structures of a high-entropy alloy. This is accomplished by calculating the difference in their minimum total energies, $$\\Delta E = E^\\text{FCC}_\\text{min} - E^\\text{BCC}_\\text{min}$$. The foundation of this analysis rests on the Born-Oppenheimer approximation, which allows the total energy to be expressed as a function of atomic volume, $$E(V)$$. The provided discrete energy-volume data for each phase must be fitted to a continuous model to accurately locate the energy minimum.\n\nThe procedure for each crystal structure involves two principal stages: fitting the discrete data to a cubic polynomial and subsequently finding the minimum of this polynomial function under the specified constraints.\n\nStep 1: Cubic Polynomial Fitting via Linear Least Squares\nGiven a set of $$N$$ discrete data points representing volume and energy, $$(V_i, E_i)$$ for $$i = 1, \\dots, N$$, we are tasked with modeling the energy-volume relationship using a cubic polynomial of the form:\n$$\nE(V) = a_3 V^3 + a_2 V^2 + a_1 V + a_0\n$$\nThe coefficients $$\\mathbf{c} = [a_3, a_2, a_1, a_0]^T$$ are determined by minimizing the sum of the squared residuals, $$S$$, which is the difference between the observed energies $$E_i$$ and the energies predicted by the polynomial $$E(V_i)$$:\n$$\nS = \\sum_{i=1}^{N} [E_i - (a_3 V_i^3 + a_2 V_i^2 + a_1 V_i + a_0)]^2\n$$\nThis minimization is a standard linear least-squares problem. It can be expressed in matrix algebra as minimizing the Euclidean norm of the residual vector, $$\\| \\mathbf{A}\\mathbf{c} - \\mathbf{E} \\|_2^2$$. Here, $$\\mathbf{E}$$ is the vector of the given energy values, and $$\\mathbf{A}$$ is the Vandermonde matrix constructed from the volume data:\n$$\n\\mathbf{A} = \\begin{pmatrix}\nV_1^3  V_1^2  V_1  1 \\\\\nV_2^3  V_2^2  V_2  1 \\\\\n\\vdots  \\vdots  \\vdots  \\vdots \\\\\nV_N^3  V_N^2  V_N  1\n\\end{pmatrix}, \\quad\n\\mathbf{E} = \\begin{pmatrix}\nE_1 \\\\\nE_2 \\\\\n\\vdots \\\\\nE_N\n\\end{pmatrix}\n$$\nThis system is robustly solved using standard numerical linear algebra routines, such as those provided by the `numpy` library in Python, which compute the coefficient vector $$\\mathbf{c}$$.\n\nStep 2: Locating the Minimum Energy\nWith the continuous function $$E(V)$$ established, the next step is to find the volume $$V^\\star$$ at which the energy is minimized. The principles of differential calculus dictate that a minimum must occur at a stationary point, where the first derivative of the function with respect to volume is zero. The stability of this point (i.e., whether it is a minimum, maximum, or inflection point) is determined by the sign of the second derivative.\n\nThe first derivative of the energy polynomial is:\n$$\n\\frac{dE}{dV} = 3a_3 V^2 + 2a_2 V + a_1\n$$\nEquating this to zero, $$\\frac{dE}{dV} = 0$$, yields a quadratic equation for the volume $$V$$. The roots of this equation, representing the stationary points, are found using the quadratic formula:\n$$\nV_\\text{stationary} = \\frac{-2a_2 \\pm \\sqrt{(2a_2)^2 - 4(3a_3)(a_1)}}{2(3a_3)} = \\frac{-a_2 \\pm \\sqrt{a_2^2 - 3a_1 a_3}}{3a_3}\n$$\nA physically valid minimum must satisfy several conditions:\n1.  The root $$V_\\text{stationary}$$ must be a real number, which requires the discriminant $$a_2^2 - 3a_1 a_3 \\ge 0$$.\n2.  The stationary point must correspond to a local minimum, which is confirmed by a positive second derivative:\n    $$\n    \\frac{d^2E}{dV^2} = 6a_3 V + 2a_2 > 0\n    $$\n3.  The volume $$V^\\star$$ that minimizes the energy must lie within the closed interval defined by the minimum and maximum sampled volumes, $$V^\\star \\in [V_\\text{min\\_data}, V_\\text{max\\_data}]$$.\n\nOur algorithm will find all real roots of $$\\frac{dE}{dV} = 0$$. For each root that falls within the data interval, we test the second derivative condition. If one or more such minima are found, we select the volume that corresponds to the absolute lowest energy value.\n\nAs per the problem statement, if no stationary point satisfying these conditions exists within the sampled interval, the minimum energy over this interval must occur at one of its boundaries. In such a scenario, we evaluate the fitted polynomial $$E(V)$$ at the endpoints, $$V_\\text{min\\_data}$$ and $$V_\\text{max\\_data}$$, and the minimum energy is taken as the smaller of these two values:\n$$\nE_\\text{min} = \\min(E(V_\\text{min\\_data}), E(V_\\text{max\\_data}))\n$$\nThis procedure correctly identifies the global minimum of the fitted polynomial over the specified closed interval.\n\nFinal Calculation\nThis entire process is executed independently for both the FCC and BCC datasets for each test case, yielding their respective minimum energies, $$E^\\text{FCC}_\\text{min}$$ and $$E^\\text{BCC}_\\text{min}$$. The final value to be reported is their difference:\n$$\n\\Delta E = E^\\text{FCC}_\\text{min} - E^\\text{BCC}_\\text{min}\n$$\nThe sign of $$\\Delta E$$ indicates the relative stability: if $$\\Delta E  0$$, the FCC phase is more stable; if $$\\Delta E  0$$, the BCC phase is more stable.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef find_minimum_energy(volumes, energies):\n    \"\"\"\n    Fits a cubic polynomial to the energy-volume data and finds the minimum energy.\n\n    The function fits E(V) = a*V^3 + b*V^2 + c*V + d, finds the stationary\n    points by solving dE/dV = 0, and checks for a minimum within the given\n    volume range. If no such minimum exists, it checks the boundaries of the\n    volume interval.\n\n    Args:\n        volumes (list[float]): A list of volumes per atom in cubic angstroms.\n        energies (list[float]): A list of corresponding energies per atom in eV.\n\n    Returns:\n        float: The minimum energy found for the fitted curve within the interval.\n    \"\"\"\n    # Fit a cubic polynomial E(V) = a3*V^3 + a2*V^2 + a1*V + a0\n    # The result of polyfit is an array of coefficients [a3, a2, a1, a0].\n    coeffs = np.polyfit(volumes, energies, 3)\n    p = np.poly1d(coeffs)\n\n    # Define the closed interval from the sampled volumes.\n    v_min_data = min(volumes)\n    v_max_data = max(volumes)\n\n    # Find stationary points by finding the roots of the first derivative.\n    # The derivative polynomial is given by p.deriv().\n    roots = np.roots(p.deriv())\n\n    # The second derivative polynomial is used to test for a minimum.\n    p_d2 = p.deriv(2)\n\n    valid_minima_volumes = []\n    for r in roots:\n        # We are only interested in real-valued stationary points.\n        if np.isreal(r):\n            v_stat = np.real(r)\n            # Check if the stationary point is within the sampled interval.\n            if v_min_data = v_stat = v_max_data:\n                # Check the second derivative condition for a local minimum (d^2E/dV^2 > 0).\n                if p_d2(v_stat) > 0:\n                    valid_minima_volumes.append(v_stat)\n\n    if valid_minima_volumes:\n        # If one or more valid minima are found within the interval,\n        # calculate their energies and select the lowest one.\n        min_energies_at_roots = [p(v) for v in valid_minima_volumes]\n        min_energy = min(min_energies_at_roots)\n    else:\n        # If no valid minimum is found in the interval (e.g., the minimum\n        # is outside the interval or the stationary points are maxima),\n        # the minimum over the closed interval must be at one of the endpoints.\n        energy_at_min_endpoint = p(v_min_data)\n        energy_at_max_endpoint = p(v_max_data)\n        min_energy = min(energy_at_min_endpoint, energy_at_max_endpoint)\n\n    return min_energy\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path; distinct minima)\n        {\n            \"fcc_v\": [14.5, 15.0, 15.5, 16.0, 16.5, 17.0],\n            \"fcc_e\": [-5.1505, -5.1770, -5.19375, -5.2000, -5.1935, -5.1730],\n            \"bcc_v\": [14.5, 15.0, 15.5, 16.0, 16.5, 17.0],\n            \"bcc_e\": [-4.979375, -5.0500, -5.103625, -5.1410, -5.162875, -5.1700]\n        },\n        # Case B (BCC stable; FCC higher)\n        {\n            \"fcc_v\": [15.0, 15.5, 16.0, 16.5, 17.0, 17.5],\n            \"fcc_e\": [-5.078528, -5.105643, -5.118808, -5.117273, -5.100288, -5.067103],\n            \"bcc_v\": [15.0, 15.5, 16.0, 16.5, 17.0, 17.5],\n            \"bcc_e\": [-5.123744, -5.137624, -5.138904, -5.126084, -5.097664, -5.052144]\n        },\n        # Case C (near-degenerate; very small difference)\n        {\n            \"fcc_v\": [15.0, 15.3, 15.6, 15.9, 16.2],\n            \"fcc_e\": [-5.992908, -5.9982135, -6.0000, -5.9981865, -5.992692],\n            \"bcc_v\": [15.0, 15.3, 15.6, 15.9, 16.2],\n            \"bcc_e\": [-5.9817713, -5.9913752, -5.9971019, -5.9990, -5.9971181]\n        },\n        # Case D (boundary condition; minimum outside interval)\n        {\n            \"fcc_v\": [13.0, 13.5, 14.0, 14.5],\n            \"fcc_e\": [-4.3800, -4.4325, -4.4700, -4.4925],\n            \"bcc_v\": [13.0, 13.5, 14.0, 14.5],\n            \"bcc_e\": [-4.46125, -4.4350, -4.39125, -4.3300]\n        },\n        # Case E (flat curvature; slight noise)\n        {\n            \"fcc_v\": [10.0, 10.5, 11.0, 11.5, 12.0],\n            \"fcc_e\": [-2.9953, -2.99855, -3.0000, -2.99885, -2.99485],\n            \"bcc_v\": [10.0, 10.5, 11.0, 11.5, 12.0],\n            \"bcc_e\": [-2.98656, -2.99196, -2.99476, -2.99456, -2.9910]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        e_fcc_min = find_minimum_energy(case[\"fcc_v\"], case[\"fcc_e\"])\n        e_bcc_min = find_minimum_energy(case[\"bcc_v\"], case[\"bcc_e\"])\n\n        delta_e = e_fcc_min - e_bcc_min\n        results.append(delta_e)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A low total energy is necessary, but not sufficient, for a crystal structure to be stable; it must also be stable against small atomic vibrations. This practice explores the concept of dynamical stability by having you compute the phonon dispersion of a model crystal lattice from its harmonic force constants . You will learn to identify \"soft modes,\" whose imaginary frequencies signal a structural instability, providing insight into the atomistic pathways of phase transitions.",
            "id": "3763319",
            "problem": "You are asked to implement a principled lattice-dynamics computation rooted in the harmonic approximation to the total energy for a simple one-dimensional binary sublattice model of a High-Entropy Alloy (HEA). The goal is to compute the phonon dispersion along the First Brillouin Zone (FBZ) and to identify soft modes whose imaginary frequencies signal structural instability or phase transitions. The algorithm must start from the harmonic approximation of the total energy and the definition of the dynamical matrix. You must not rely on pre-derived dispersion formulas; instead, you must construct the dynamical matrix by Fourier transforming real-space harmonic force constants and then diagonalize it to obtain phonon frequencies from first principles.\n\nFundamental base:\n- Under the harmonic approximation, the total energy $E$ of small displacements about a reference structure is expanded as\n$$\nE \\approx E_0 + \\frac{1}{2} \\sum_{i\\alpha,j\\beta} \\Phi_{i\\alpha,j\\beta} \\, u_{i\\alpha} \\, u_{j\\beta},\n$$\nwhere $u_{i\\alpha}$ is the displacement of atom $i$ in Cartesian direction $\\alpha$, and $\\Phi_{i\\alpha,j\\beta}$ is the force-constant (second derivative of the total energy).\n- The dynamical matrix $D(\\mathbf{q})$ at wave vector $\\mathbf{q}$ is defined by the lattice Fourier transform of the mass-weighted force constants,\n$$\nD_{i\\alpha,j\\beta}(\\mathbf{q}) = \\frac{1}{\\sqrt{m_i m_j}} \\sum_{\\mathbf{R}} \\Phi_{i\\alpha,j\\beta}(\\mathbf{R}) \\, e^{i \\mathbf{q}\\cdot \\mathbf{R}},\n$$\nwhere $m_i$ is the mass of atom $i$ and $\\Phi_{i\\alpha,j\\beta}(\\mathbf{R})$ couples the reference cell to a cell displaced by lattice vector $\\mathbf{R}$. Phonon frequencies $\\omega(\\mathbf{q})$ satisfy\n$$\nD(\\mathbf{q}) \\, e(\\mathbf{q},s) = \\omega^2(\\mathbf{q},s) \\, e(\\mathbf{q},s),\n$$\nwith $s$ indexing branches and $e(\\mathbf{q},s)$ eigenvectors. Imaginary frequencies correspond to negative $\\omega^2(\\mathbf{q},s)$ (negative eigenvalues of $D(\\mathbf{q})$) and indicate soft modes and structural instabilities.\n\nModel specification:\n- Consider a one-dimensional diatomic chain as a minimal binary sublattice model for an HEA, with two atoms per unit cell, labeled $s=0$ and $s=1$, masses $m_0$ and $m_1$, and lattice constant $a$. Restrict to displacements along the chain direction, so Cartesian indices are unnecessary.\n- Include only nearest-neighbor harmonic interactions via two spring constants: $k_0$ for the bond between $s=0$ and $s=1$ within the same unit cell, and $k_1$ for the bond between $s=1$ in cell $n$ and $s=0$ in cell $n+1$. The pair interaction energy for a spring connecting atoms $i$ and $j$ is\n$$\nE_{ij} = \\frac{1}{2} k_{ij} \\, (u_j - u_i)^2,\n$$\nwhich yields local contributions to force constants\n$$\n\\Phi_{ii} \\leftarrow \\Phi_{ii} + k_{ij}, \\quad\n\\Phi_{jj} \\leftarrow \\Phi_{jj} + k_{ij}, \\quad\n\\Phi_{ij} \\leftarrow \\Phi_{ij} - k_{ij}, \\quad\n\\Phi_{ji} \\leftarrow \\Phi_{ji} - k_{ij}.\n$$\n- Enumerate nonzero real-space force constants consistent with periodicity and translational invariance for the diatomic chain:\n$$\n\\Phi_{00}(0) = k_0 + k_1, \\quad \\Phi_{11}(0) = k_0 + k_1,\n$$\n$$\n\\Phi_{01}(0) = -k_0, \\quad \\Phi_{01}(-1) = -k_1,\n$$\n$$\n\\Phi_{10}(0) = -k_0, \\quad \\Phi_{10}(+1) = -k_1,\n$$\nand all other $\\Phi_{ss'}(n)$ vanish, with $n \\in \\mathbb{Z}$ labeling unit-cell offsets and positions $R_n = n a$.\n- The one-dimensional dynamical matrix components follow from the lattice Fourier transform:\n$$\nD_{00}(q) = \\frac{k_0 + k_1}{m_0}, \\quad\nD_{11}(q) = \\frac{k_0 + k_1}{m_1},\n$$\n$$\nD_{01}(q) = \\frac{-k_0 - k_1 e^{-i q a}}{\\sqrt{m_0 m_1}}, \\quad\nD_{10}(q) = \\frac{-k_0 - k_1 e^{+i q a}}{\\sqrt{m_0 m_1}},\n$$\nand the $2\\times 2$ Hermitian matrix $D(q)$ is diagonalized to obtain $\\omega^2(q,s)$.\n\nComputational task:\n- Implement a program that, given $(m_0,m_1,a,k_0,k_1)$, constructs $D(q)$ on a uniform grid of wave vectors $q \\in [0, \\pi/a]$ with $N_q$ points, diagonalizes $D(q)$ for each $q$, and detects soft modes by checking for negative eigenvalues $\\omega^2(q,s)  -\\epsilon$, where $\\epsilon$ is a small positive threshold to avoid false positives due to numerical round-off. Imaginary frequencies are equivalent to negative $\\omega^2(q,s)$ and therefore signal a soft mode.\n- Masses must be converted from atomic mass units to kilograms using $1\\,\\text{u} = 1.66053906660 \\times 10^{-27}\\,\\text{kg}$ before assembling $D(q)$. Spring constants are in $\\text{N}/\\text{m}$, and $a$ is in $\\text{m}$. Although the program will internally work in $\\text{s}^{-2}$ for $\\omega^2$, the required outputs are unitless booleans indicating the presence or absence of soft modes. No angle units ambiguity arises because $q a$ is dimensionless.\n\nTest suite:\nUse the following three scientifically consistent parameter sets with distinct behaviors. For each case, set $N_q = 201$ and $\\epsilon = 10^{-12}$.\n1. Case $1$ (stable, typical binary masses and springs): $(m_0,m_1) = (\\,50\\,\\text{u},\\,55\\,\\text{u}\\,)$, $a = 2.5 \\times 10^{-10}\\,\\text{m}$, $k_0 = 12\\,\\text{N}/\\text{m}$, $k_1 = 10\\,\\text{N}/\\text{m}$.\n2. Case $2$ (unstable, softened intercell bond giving a negative curvature in the optical mode at $q=0$): $(m_0,m_1) = (\\,50\\,\\text{u},\\,55\\,\\text{u}\\,)$, $a = 2.5 \\times 10^{-10}\\,\\text{m}$, $k_0 = 12\\,\\text{N}/\\text{m}$, $k_1 = -20\\,\\text{N}/\\text{m}$.\n3. Case $3$ (edge case, extreme mass ratio with an ultra-weak intercell bond, numerically challenging but stable): $(m_0,m_1) = (\\,50\\,\\text{u},\\,200\\,\\text{u}\\,)$, $a = 2.5 \\times 10^{-10}\\,\\text{m}$, $k_0 = 1.0\\,\\text{N}/\\text{m}$, $k_1 = 1.0 \\times 10^{-6}\\,\\text{N}/\\text{m}$.\n\nOutput specification:\n- For each test case, return a boolean indicating whether at least one soft mode exists on the $q$-grid, defined as the existence of any negative eigenvalue $\\omega^2(q,s)  -\\epsilon$. Aggregate the three booleans into a single line of output as a comma-separated Python-style list, for example `[x_1,x_2,x_3]`, where each $x_i$ is either `True` or `False` (unitless).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., `[x_1,x_2,x_3]`).",
            "solution": "The problem of determining the stability of a crystal lattice is fundamental to condensed matter physics and materials science. A given atomic arrangement is structurally stable only if it corresponds to a local minimum of the total potential energy. Small displacements of atoms from their equilibrium positions must lead to an increase in energy. In the harmonic approximation, the potential energy surface is expanded to second order around the equilibrium configuration, providing a quadratic energy landscape. The stability is then determined by the signs of the curvatures of this landscape.\n\nThe total energy $E$ for small atomic displacements $u_{i\\alpha}$ (displacement of atom $i$ in direction $\\alpha$) is given by:\n$$\nE \\approx E_0 + \\frac{1}{2} \\sum_{i\\alpha,j\\beta} \\Phi_{i\\alpha,j\\beta} u_{i\\alpha} u_{j\\beta}\n$$\nHere, $E_0$ is the energy of the static reference lattice, and $\\Phi_{i\\alpha,j\\beta} = \\frac{\\partial^2 E}{\\partial u_{i\\alpha} \\partial u_{j\\beta}}$ is the Hessian matrix, or the matrix of harmonic force constants. For a stable structure, this quadratic form must be positive definite, meaning all its eigenvalues are positive.\n\nThe collective vibrations of the atoms in a periodic lattice are described by phonons. The equations of motion for the atoms, derived from the harmonic potential, are best solved by transforming into reciprocal space. This procedure block-diagonalizes the problem by wave vector $\\mathbf{q}$. For each $\\mathbf{q}$, we solve an eigenvalue problem for a small matrix known as the dynamical matrix, $D(\\mathbf{q})$. Its elements are the mass-weighted Fourier transform of the real-space force constants:\n$$\nD_{s\\alpha,s'\\beta}(\\mathbf{q}) = \\frac{1}{\\sqrt{m_s m_{s'}}} \\sum_{\\mathbf{R}} \\Phi_{s\\alpha,s'\\beta}(\\mathbf{R}) e^{i \\mathbf{q}\\cdot \\mathbf{R}}\n$$\nwhere $s$ and $s'$ index atoms within a unit cell, $m_s$ is the mass of atom $s$, and the sum is over all lattice vectors $\\mathbf{R}$. The eigenvalues of $D(\\mathbf{q})$ are the squared phonon frequencies, $\\omega^2(\\mathbf{q})$.\n$$\nD(\\mathbf{q}) \\mathbf{e}(\\mathbf{q}) = \\omega^2(\\mathbf{q}) \\mathbf{e}(\\mathbf{q})\n$$\nThe physical significance of the eigenvalues determines stability:\n- If $\\omega^2(\\mathbf{q}) > 0$, the frequency $\\omega(\\mathbf{q})$ is real, corresponding to a stable, propagating vibrational mode (a phonon).\n- If $\\omega^2(\\mathbf{q})  0$, the frequency $\\omega(\\mathbf{q})$ is imaginary. This indicates that a small displacement will grow exponentially in time, rather than oscillate. This is a dynamic instability known as a \"soft mode\", and it signals that the initial atomic structure is unstable and will spontaneously distort.\n\nThe problem requires us to apply this formalism to a one-dimensional diatomic chain with atoms of mass $m_0$ and $m_1$ in each unit cell. The lattice constant is $a$. We consider only nearest-neighbor interactions with an intracell spring constant $k_0$ and an intercell spring constant $k_1$. Following the rules for constructing force constants from pair potentials, the non-zero force constants $\\Phi_{ss'}(n)$ (coupling atom $s$ in the reference cell $0$ to atom $s'$ in cell $n$) are provided.\n\nThe dynamical matrix for this 1D model is a $2 \\times 2$ Hermitian matrix, whose components are given as:\n$$\nD_{00}(q) = \\frac{k_0 + k_1}{m_0}\n$$\n$$\nD_{11}(q) = \\frac{k_0 + k_1}{m_1}\n$$\n$$\nD_{01}(q) = \\frac{-k_0 - k_1 e^{-i q a}}{\\sqrt{m_0 m_1}}\n$$\n$$\nD_{10}(q) = \\frac{-k_0 - k_1 e^{+i q a}}{\\sqrt{m_0 m_1}}\n$$\nNote that $D_{10}(q) = D_{01}^*(q)$, confirming the Hermitian property.\n\nThe computational procedure is to implement the calculation for the given test cases. For each case, we will:\n1. Define the physical constants and model parameters $(m_0, m_1, a, k_0, k_1)$. Masses, given in atomic mass units ($\\text{u}$), must be converted to kilograms ($\\text{kg}$) using the provided conversion factor.\n2. Generate a uniform grid of $N_q$ wave vectors $q$ in the interval $[0, \\pi/a]$, which covers the irreducible part of the first Brillouin zone.\n3. Iterate through each value of $q$ in the grid.\n4. At each $q$, construct the complex-valued $2 \\times 2$ dynamical matrix $D(q)$ using the formulas above.\n5. Compute the two eigenvalues of $D(q)$. Since $D(q)$ is Hermitian, its eigenvalues ($\\omega^2$) are guaranteed to be real.\n6. Check if either eigenvalue is negative, specifically less than a small negative threshold $-\\epsilon$ (where $\\epsilon = 10^{-12}$) to robustly detect instabilities while avoiding false positives from floating-point inaccuracies around zero.\n7. If a negative eigenvalue is found for any $q$, we conclude that a soft mode exists for the given set of parameters. We can then stop checking further $q$ values for that case and record the result as `True`.\n8. If the loop completes without finding any negative eigenvalues, the system is stable, and the result is `False`.\n9. The final output aggregates the boolean results for all test cases.\n\nThis process directly simulates the physical principles of lattice dynamics to assess structural stability, as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries outside the Python standard library are permitted.\n\ndef solve():\n    \"\"\"\n    Computes the presence of soft modes in a 1D diatomic lattice model.\n    \"\"\"\n\n    # Physical constant for atomic mass unit to kilogram conversion.\n    U_TO_KG = 1.66053906660e-27\n\n    # Computational parameters from the problem statement.\n    N_q = 201\n    epsilon = 1.0e-12\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (m0_u, m1_u, a_m, k0_Npm, k1_Npm)\n    test_cases = [\n        (50.0, 55.0, 2.5e-10, 12.0, 10.0),   # Case 1: Stable\n        (50.0, 55.0, 2.5e-10, 12.0, -20.0),  # Case 2: Unstable\n        (50.0, 200.0, 2.5e-10, 1.0, 1.0e-6),  # Case 3: Stable, extreme params\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        m0_u, m1_u, a, k0, k1 = case\n\n        # Convert masses from atomic mass units (u) to kilograms (kg).\n        m0 = m0_u * U_TO_KG\n        m1 = m1_u * U_TO_KG\n\n        # Create a uniform grid of wave vectors q in the first Brillouin Zone [0, pi/a].\n        q_grid = np.linspace(0, np.pi / a, N_q)\n\n        soft_mode_found = False\n        \n        # Iterate through each wave vector to check for instabilities.\n        for q in q_grid:\n            # Construct the 2x2 dynamical matrix D(q).\n            # D is a complex-valued Hermitian matrix.\n            D = np.zeros((2, 2), dtype=np.complex128)\n\n            # Diagonal elements (real).\n            D[0, 0] = (k0 + k1) / m0\n            D[1, 1] = (k0 + k1) / m1\n\n            # Off-diagonal elements (complex conjugates).\n            common_term = -k0 - k1 * np.exp(-1j * q * a)\n            D[0, 1] = common_term / np.sqrt(m0 * m1)\n            D[1, 0] = np.conj(D[0, 1])\n\n            # Calculate the eigenvalues of the Hermitian matrix D(q).\n            # The eigenvalues omega^2 are guaranteed to be real.\n            # np.linalg.eigvalsh is optimized for Hermitian matrices.\n            eigenvalues_w2 = np.linalg.eigvalsh(D)\n\n            # Check if any eigenvalue is negative beyond the numerical tolerance epsilon.\n            # This indicates a soft mode and thus a structural instability.\n            if np.any(eigenvalues_w2  -epsilon):\n                soft_mode_found = True\n                # An instability was found, no need to check other q values for this case.\n                break\n        \n        results.append(soft_mode_found)\n\n    # Format the final output as a Python-style list of booleans.\n    # The map(str, ...) is used to get 'True'/'False' with capital letters.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Standard density functional theory can sometimes fall short for materials with strongly correlated electrons, such as those in $d$- and $f$-orbitals. This exercise demonstrates the impact of the DFT+U method, an important correction, by having you perform a scan of the effective Hubbard $U$ parameter . You will investigate how this correction modifies formation energies and can even alter the predicted ground-state phase, highlighting the importance of choosing an appropriate level of theory.",
            "id": "3763332",
            "problem": "You are asked to design and implement a program that evaluates the necessity of including the Hubbard parameter in Density Functional Theory plus Hubbard U (DFT+U) calculations for materials containing localized electrons, by scanning the effective Hubbard parameter and analyzing changes in formation energies and phase ordering across competing phases. The context is total energy calculations for phase stability in high-entropy alloys and complex materials modeling.\n\nStarting from a valid base, use the following foundational facts:\n\n- Formation energy per atom is defined as $$E_{\\mathrm{form}}(U) = E_{\\mathrm{tot}}^{\\mathrm{compound}}(U) - \\sum_{k} x_k \\mu_k(U),$$ where $E_{\\mathrm{tot}}^{\\mathrm{compound}}(U)$ is the total energy per atom of the compound at Hubbard parameter $U$, $x_k$ is the atomic fraction of element $k$ in the compound, and $\\mu_k(U)$ is the chemical potential per atom of element $k$ (reference elemental solid) at $U$.\n- In the widely used rotationally invariant Dudarev formulation of DFT+U, the Hubbard energy correction per localized site is $$E_U^{\\mathrm{site}}(U) = \\frac{U_{\\mathrm{eff}}}{2}\\sum_{m} \\left(n_m - n_m^2\\right),$$ where $n_m$ is the occupancy of localized orbital $m$ on that site and $U_{\\mathrm{eff}}$ is the effective Hubbard parameter. In this problem, take $U_{\\mathrm{eff}} = U$ and treat occupancies as fixed over the scan (a common small-$U$ approximation).\n\nTo ensure scientific realism while keeping the task purely mathematical and programmable, you are provided with a test suite consisting of three independent cases. Each case defines:\n\n- A discrete scan grid of Hubbard parameter values $\\{U_i\\}$ in electron volt ($\\mathrm{eV}$).\n- A set of elements $k$ with baseline chemical potentials per atom $\\mu_{k,0}$ in $\\mathrm{eV}$, localized occupancy vectors for the elemental reference $\\{n_{m}^{(k,\\mathrm{elem})}\\}$ with $m$ indexing the localized orbitals (e.g., $d$ with $5$ orbitals or $f$ with $7$ orbitals), and the number of localized sites per atom in the elemental phase $s_k^{\\mathrm{elem}}$ (a non-negative real number).\n- A set of competing phases $p$ with baseline total energies per atom $E_{0}^{(p)}$ in $\\mathrm{eV}$, composition fractions $x_k^{(p)}$ for each element, localized occupancy vectors $\\{n_{m}^{(p,k)}\\}$ for each element within the compound (only defined if that element has localized electrons), and the number of localized sites per atom for that element within the compound $s_k^{(p)}$.\n\nYou must compute for each phase $p$ at each scan point $U_i$ the formation energy per atom using:\n- $$E_{\\mathrm{tot}}^{\\mathrm{compound}}(U_i) = E_{0}^{(p)} + \\sum_{k} x_k^{(p)} s_k^{(p)} \\left[\\frac{U_i}{2}\\sum_{m}\\left(n_{m}^{(p,k)} - \\left(n_{m}^{(p,k)}\\right)^2 \\right)\\right],$$\n- $$\\mu_k(U_i) = \\mu_{k,0} + s_k^{\\mathrm{elem}} \\left[\\frac{U_i}{2}\\sum_{m}\\left(n_{m}^{(k,\\mathrm{elem})} - \\left(n_{m}^{(k,\\mathrm{elem})}\\right)^2 \\right)\\right],$$\nand then $$E_{\\mathrm{form}}^{(p)}(U_i) = E_{\\mathrm{tot}}^{\\mathrm{compound}}(U_i) - \\sum_{k} x_k^{(p)} \\mu_k(U_i).$$\n\nDefine the ground-state phase at a given $U_i$ as the phase with the smallest (most negative) formation energy per atom. Use a strict comparison with a numerical tolerance $\\varepsilon = 10^{-8}$ for deciding changes: if two phases are within $\\varepsilon$, treat them as equal and do not register a change of ordering solely due to numerical noise. Determine whether the identity of the ground-state phase at $U = 0$ changes at any subsequent $U_i > 0$ in the scan. If a change occurs, report the smallest $U_i$ where this change is first observed.\n\nUnits: All energies, including the Hubbard parameter $U$, must be handled and interpreted in electron volt ($\\mathrm{eV}$). The threshold value of $U$ should be reported in $\\mathrm{eV}$. No angles or percentages are involved.\n\nTest Suite Definition:\n\n- Case $1$ (binary with localized $d$ electrons on one element):\n    - $U\\text{ grid} = [0.0, 0.25, 0.5, 1.0, 2.0, 4.0] \\ \\mathrm{eV}$\n    - Elements:\n        - Element $A$: $\\mu_{A,0} = -5.0 \\ \\mathrm{eV}, \\quad s_A^{\\mathrm{elem}} = 1.0, \\quad \\{n_{m}^{(A,\\mathrm{elem})}\\} = [0.5, 0.5, 0.5, 0.5, 0.5]$\n        - Element $B$: $\\mu_{B,0} = -4.0 \\ \\mathrm{eV}, \\quad s_B^{\\mathrm{elem}} = 0.0$ (no localized electrons)\n    - Phases:\n        - Phase $P_1$: $E_{0}^{(P_1)} = -4.7 \\ \\mathrm{eV}, \\quad x_A^{(P_1)} = 0.5, \\quad x_B^{(P_1)} = 0.5,$ with $s_A^{(P_1)} = 1.0, \\ \\{n_{m}^{(P_1,A)}\\} = [0.6, 0.6, 0.6, 0.2, 0.0]$\n        - Phase $P_2$: $E_{0}^{(P_2)} = -4.65 \\ \\mathrm{eV}, \\quad x_A^{(P_2)} = 0.5, \\quad x_B^{(P_2)} = 0.5,$ with $s_A^{(P_2)} = 1.0, \\ \\{n_{m}^{(P_2,A)}\\} = [1.0, 1.0, 0.0, 0.0, 0.0]$\n\n- Case $2$ (ternary; ordering robust over scan window):\n    - $U\\text{ grid} = [0.0, 0.5, 1.0] \\ \\mathrm{eV}$\n    - Elements:\n        - Element $A$: $\\mu_{A,0} = -5.0 \\ \\mathrm{eV}, \\quad s_A^{\\mathrm{elem}} = 1.0, \\quad \\{n_{m}^{(A,\\mathrm{elem})}\\} = [0.5, 0.5, 0.5, 0.5, 0.5]$\n        - Element $B$: $\\mu_{B,0} = -4.2 \\ \\mathrm{eV}, \\quad s_B^{\\mathrm{elem}} = 0.0$\n        - Element $C$: $\\mu_{C,0} = -3.5 \\ \\mathrm{eV}, \\quad s_C^{\\mathrm{elem}} = 0.0$\n    - Phases:\n        - Phase $P_3$: $E_{0}^{(P_3)} = -4.3 \\ \\mathrm{eV}, \\quad x_A^{(P_3)} = 0.4, \\quad x_B^{(P_3)} = 0.4, \\quad x_C^{(P_3)} = 0.2,$ with $s_A^{(P_3)} = 1.0, \\ \\{n_{m}^{(P_3,A)}\\} = [0.7, 0.7, 0.3, 0.3, 0.0]$\n        - Phase $P_4$: $E_{0}^{(P_4)} = -4.18 \\ \\mathrm{eV}, \\quad x_A^{(P_4)} = 0.5, \\quad x_B^{(P_4)} = 0.3, \\quad x_C^{(P_4)} = 0.2,$ with $s_A^{(P_4)} = 1.0, \\ \\{n_{m}^{(P_4,A)}\\} = [1.0, 1.0, 0.0, 0.0, 0.0]$\n        - Phase $P_5$: $E_{0}^{(P_5)} = -4.24 \\ \\mathrm{eV}, \\quad x_A^{(P_5)} = 0.3, \\quad x_B^{(P_5)} = 0.4, \\quad x_C^{(P_5)} = 0.3,$ with $s_A^{(P_5)} = 1.0, \\ \\{n_{m}^{(P_5,A)}\\} = [0.6, 0.6, 0.6, 0.2, 0.0]$\n\n- Case $3$ (binary with localized $f$ electrons on one element):\n    - $U\\text{ grid} = [0.0, 0.12, 0.2, 0.5, 1.0, 2.0] \\ \\mathrm{eV}$\n    - Elements:\n        - Element $F$: $\\mu_{F,0} = -6.0 \\ \\mathrm{eV}, \\quad s_F^{\\mathrm{elem}} = 1.0, \\quad \\{n_{m}^{(F,\\mathrm{elem})}\\} = [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]$\n        - Element $G$: $\\mu_{G,0} = -3.0 \\ \\mathrm{eV}, \\quad s_G^{\\mathrm{elem}} = 0.0$\n    - Phases:\n        - Phase $Q_1$: $E_{0}^{(Q_1)} = -4.9 \\ \\mathrm{eV}, \\quad x_F^{(Q_1)} = 0.5, \\quad x_G^{(Q_1)} = 0.5,$ with $s_F^{(Q_1)} = 1.0, \\ \\{n_{m}^{(Q_1,F)}\\} = [0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6]$\n        - Phase $Q_2$: $E_{0}^{(Q_2)} = -4.85 \\ \\mathrm{eV}, \\quad x_F^{(Q_2)} = 0.5, \\quad x_G^{(Q_2)} = 0.5,$ with $s_F^{(Q_2)} = 1.0, \\ \\{n_{m}^{(Q_2,F)}\\} = [1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0]$\n\nYour program must:\n\n1. Compute $E_{\\mathrm{form}}^{(p)}(U_i)$ for all phases in each case and for all $U_i$ on the provided grid (in $\\mathrm{eV}$ per atom), using the definitions above.\n2. Determine the index of the ground-state phase at $U = 0$ for each case.\n3. Find the smallest $U_i > 0$ in the grid at which the ground-state phase index differs from that at $U = 0$, subject to the tolerance $\\varepsilon = 10^{-8}$. If no change occurs over the provided grid, report that no threshold exists.\n4. For each case, output a two-element list `[b, U*]`, where $b$ is a boolean indicating whether a change occurs (True if a change is observed, False otherwise), and $U^*$ is the smallest $U_i$ at which the change occurs in $\\mathrm{eV}$, or $-1.0$ if no change occurs.\n\nFinal output format: Your program should produce a single line of output containing the results for the three cases as a comma-separated list enclosed in square brackets of lists, for example `[[True, 0.25],[False, -1.0],[True, 0.12]]`. The output must be exactly one line, with no extra whitespace or text.",
            "solution": "The user-provided problem has been analyzed and is determined to be valid. It is scientifically grounded in the principles of computational materials science, specifically Density Functional Theory plus Hubbard U (DFT+U). The problem is self-contained, with all necessary data and equations provided, and is mathematically well-posed, allowing for a unique and verifiable solution.\n\nThe core of the problem is to determine the formation energy, $$E_{\\mathrm{form}}$$, of several competing material phases as a function of the effective Hubbard parameter, $$U$$. The formation energy per atom for a phase $$p$$ is given by:\n$$E_{\\mathrm{form}}^{(p)}(U) = E_{\\mathrm{tot}}^{\\mathrm{compound}}(U) - \\sum_{k} x_k^{(p)} \\mu_k(U)$$\nwhere $$E_{\\mathrm{tot}}^{\\mathrm{compound}}(U)$$ is the total energy of the compound, $$x_k^{(p)}$$ is the atomic fraction of element $$k$$, and $$\\mu_k(U)$$ is the chemical potential of element $$k$$.\n\nThe problem specifies the functional form for the $$U$$-dependent energies based on the Dudarev formulation of DFT+U, under the simplifying approximation that orbital occupancies $$n_m$$ are constant. The total energy and chemical potentials are given as:\n$$E_{\\mathrm{tot}}^{\\mathrm{compound}}(U_i) = E_{0}^{(p)} + \\sum_{k} x_k^{(p)} s_k^{(p)} \\left[\\frac{U_i}{2}\\sum_{m}\\left(n_{m}^{(p,k)} - \\left(n_{m}^{(p,k)}\\right)^2 \\right)\\right]$$\n$$\\mu_k(U_i) = \\mu_{k,0} + s_k^{\\mathrm{elem}} \\left[\\frac{U_i}{2}\\sum_{m}\\left(n_{m}^{(k,\\mathrm{elem})} - \\left(n_{m}^{(k,\\mathrm{elem})}\\right)^2 \\right)\\right]$$\n\nTo simplify the analysis, we can express the formation energy as a linear function of $$U$$. Let's define a \"Hubbard trace term\" for a given set of orbital occupancies $$\\{n_m\\}$$ as:\n$$T(\\{n_m\\}) = \\sum_{m} \\left(n_m - n_m^2\\right)$$\n\nSubstituting this into the expressions for total energy and chemical potential, and then into the formation energy equation, we can rearrange the terms:\n$$E_{\\mathrm{form}}^{(p)}(U) = \\left( E_{0}^{(p)} + \\frac{U}{2} \\sum_{k} x_k^{(p)} s_k^{(p)} T_k^{(p)} \\right) - \\sum_{k} x_k^{(p)} \\left( \\mu_{k,0} + \\frac{U}{2} s_k^{\\mathrm{elem}} T_k^{\\mathrm{elem}} \\right)$$\nwhere $$T_k^{(p)} = T(\\{n_m^{(p,k)}\\})$$ and $$T_k^{\\mathrm{elem}} = T(\\{n_m^{(k,\\mathrm{elem})}\\})$$.\n\nGrouping terms by their dependence on $$U$$, we get a linear equation:\n$$E_{\\mathrm{form}}^{(p)}(U) = \\left( E_{0}^{(p)} - \\sum_{k} x_k^{(p)} \\mu_{k,0} \\right) + U \\cdot \\left[ \\frac{1}{2} \\sum_{k} x_k^{(p)} \\left( s_k^{(p)} T_k^{(p)} - s_k^{\\mathrm{elem}} T_k^{\\mathrm{elem}} \\right) \\right]$$\n\nThis can be written concisely as:\n$$E_{\\mathrm{form}}^{(p)}(U) = E_{\\mathrm{form}}^{(p)}(0) + U \\cdot S^{(p)}$$\nwhere $$E_{\\mathrm{form}}^{(p)}(0)$$ is the formation energy at $$U=0$$ and $$S^{(p)}$$ is the slope of the energy line with respect to $$U$$.\n\nThe algorithmic procedure to solve the problem for each case is as follows:\n1.  For each element $$k$$ with localized electrons, calculate the elemental Hubbard trace term, $$T_k^{\\mathrm{elem}}$$.\n2.  For each phase $$p$$:\n    a. Calculate the formation energy at $$U=0$$: $$E_{\\mathrm{form}}^{(p)}(0) = E_0^{(p)} - \\sum_k x_k^{(p)} \\mu_{k,0}$$.\n    b. For each element $$k$$ within the phase that has localized electrons, calculate the compound Hubbard trace term, $$T_k^{(p)}$$.\n    c. Calculate the slope $$S^{(p)}$$ using the formula derived above.\n3.  Determine the ground-state phase at $$U=0$$ by identifying the phase with the minimum formation energy. Let this be phase $$p_{\\mathrm{gs},0}$$.\n4.  Iterate through the provided grid of $$U$$ values, for each $$U_i > 0$$.\n5.  At each $$U_i$$, calculate $$E_{\\mathrm{form}}^{(p)}(U_i)$$ for all phases using the linear equation.\n6.  Find the minimum formation energy across all phases at this $$U_i$$, denoted $$E_{\\min}(U_i)$$.\n7.  A change in the ground state is detected if the formation energy of the original ground-state phase, $$E_{\\mathrm{form}}^{(p_{\\mathrm{gs},0})}(U_i)$$, is greater than the new minimum energy plus the specified tolerance $$\\varepsilon = 10^{-8}$$. That is, if $$E_{\\mathrm{form}}^{(p_{\\mathrm{gs},0})}(U_i) > E_{\\min}(U_i) + \\varepsilon$$.\n8.  The result for the case is the smallest $$U_i > 0$$ at which this condition is met. If the condition is never met across the entire grid, no change is reported.\n\nThis procedure, based on the linear relationship between formation energy and $$U$$, will be implemented to analyze the three provided test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the DFT+U phase stability problem for all test cases.\n    \"\"\"\n    \n    # Define the test suite data\n    test_cases_data = [\n        # Case 1\n        {\n            \"u_grid\": [0.0, 0.25, 0.5, 1.0, 2.0, 4.0],\n            \"elements\": {\n                \"A\": {\"mu0\": -5.0, \"s_elem\": 1.0, \"n_elem\": [0.5, 0.5, 0.5, 0.5, 0.5]},\n                \"B\": {\"mu0\": -4.0, \"s_elem\": 0.0, \"n_elem\": []}\n            },\n            \"phases\": [\n                { # P1\n                    \"E0\": -4.7,\n                    \"composition\": {\"A\": 0.5, \"B\": 0.5},\n                    \"localized_sites\": {\n                        \"A\": {\"s_comp\": 1.0, \"n_comp\": [0.6, 0.6, 0.6, 0.2, 0.0]}\n                    }\n                },\n                { # P2\n                    \"E0\": -4.65,\n                    \"composition\": {\"A\": 0.5, \"B\": 0.5},\n                    \"localized_sites\": {\n                        \"A\": {\"s_comp\": 1.0, \"n_comp\": [1.0, 1.0, 0.0, 0.0, 0.0]}\n                    }\n                }\n            ]\n        },\n        # Case 2\n        {\n            \"u_grid\": [0.0, 0.5, 1.0],\n            \"elements\": {\n                \"A\": {\"mu0\": -5.0, \"s_elem\": 1.0, \"n_elem\": [0.5, 0.5, 0.5, 0.5, 0.5]},\n                \"B\": {\"mu0\": -4.2, \"s_elem\": 0.0, \"n_elem\": []},\n                \"C\": {\"mu0\": -3.5, \"s_elem\": 0.0, \"n_elem\": []}\n            },\n            \"phases\": [\n                { # P3\n                    \"E0\": -4.3,\n                    \"composition\": {\"A\": 0.4, \"B\": 0.4, \"C\": 0.2},\n                    \"localized_sites\": {\n                        \"A\": {\"s_comp\": 1.0, \"n_comp\": [0.7, 0.7, 0.3, 0.3, 0.0]}\n                    }\n                },\n                { # P4\n                    \"E0\": -4.18,\n                    \"composition\": {\"A\": 0.5, \"B\": 0.3, \"C\": 0.2},\n                    \"localized_sites\": {\n                        \"A\": {\"s_comp\": 1.0, \"n_comp\": [1.0, 1.0, 0.0, 0.0, 0.0]}\n                    }\n                },\n                { # P5\n                    \"E0\": -4.24,\n                    \"composition\": {\"A\": 0.3, \"B\": 0.4, \"C\": 0.3},\n                    \"localized_sites\": {\n                        \"A\": {\"s_comp\": 1.0, \"n_comp\": [0.6, 0.6, 0.6, 0.2, 0.0]}\n                    }\n                }\n            ]\n        },\n        # Case 3\n        {\n            \"u_grid\": [0.0, 0.12, 0.2, 0.5, 1.0, 2.0],\n            \"elements\": {\n                \"F\": {\"mu0\": -6.0, \"s_elem\": 1.0, \"n_elem\": [0.5] * 7},\n                \"G\": {\"mu0\": -3.0, \"s_elem\": 0.0, \"n_elem\": []}\n            },\n            \"phases\": [\n                { # Q1\n                    \"E0\": -4.9,\n                    \"composition\": {\"F\": 0.5, \"G\": 0.5},\n                    \"localized_sites\": {\n                        \"F\": {\"s_comp\": 1.0, \"n_comp\": [0.6] * 7}\n                    }\n                },\n                { # Q2\n                    \"E0\": -4.85,\n                    \"composition\": {\"F\": 0.5, \"G\": 0.5},\n                    \"localized_sites\": {\n                        \"F\": {\"s_comp\": 1.0, \"n_comp\": [1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0]}\n                    }\n                }\n            ]\n        }\n    ]\n    \n    results = []\n    for case_data in test_cases_data:\n        results.append(_process_case(case_data))\n\n    # Format output to match specification: [[True, 0.25],[False, -1.0],[True, 0.12]]\n    formatted_results = [f\"[{res[0]}, {res[1]}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef _process_case(case_data):\n    \"\"\"\n    Processes a single test case to find the ground state crossover.\n    \"\"\"\n    u_grid = case_data[\"u_grid\"]\n    elements = case_data[\"elements\"]\n    phases = case_data[\"phases\"]\n    epsilon = 1e-8\n\n    def _calculate_trace(occupancies):\n        \"\"\"Calculates the Hubbard trace term Sum(n - n^2).\"\"\"\n        if not occupancies:\n            return 0.0\n        n = np.array(occupancies)\n        return np.sum(n - np.square(n))\n\n    # Pre-calculate trace for elemental references\n    elem_traces = {name: _calculate_trace(props[\"n_elem\"]) for name, props in elements.items()}\n\n    e_form_0_values = []\n    slopes = []\n\n    for phase in phases:\n        # Calculate formation energy at U=0\n        ref_energy_0 = sum(phase[\"composition\"][name] * props[\"mu0\"] \n                           for name, props in elements.items())\n        e_form_0 = phase[\"E0\"] - ref_energy_0\n        e_form_0_values.append(e_form_0)\n\n        # Calculate slope S^(p)\n        slope_sum = 0.0\n        for elem_name, frac in phase[\"composition\"].items():\n            s_elem = elements[elem_name][\"s_elem\"]\n            t_elem = elem_traces[elem_name]\n            \n            s_comp = 0.0\n            t_comp = 0.0\n            if elem_name in phase[\"localized_sites\"]:\n                s_comp = phase[\"localized_sites\"][elem_name][\"s_comp\"]\n                t_comp = _calculate_trace(phase[\"localized_sites\"][elem_name][\"n_comp\"])\n            \n            slope_sum += frac * (s_comp * t_comp - s_elem * t_elem)\n        \n        slopes.append(0.5 * slope_sum)\n\n    e_form_0_values = np.array(e_form_0_values)\n    slopes = np.array(slopes)\n\n    # Determine ground state at U=0\n    energies_at_0 = e_form_0_values # U=0 term\n    gs_index_0 = np.argmin(energies_at_0)\n\n    # Check for crossover at U > 0\n    for u_val in u_grid[1:]:\n        # Calculate formation energies for all phases at current U\n        current_energies = e_form_0_values + u_val * slopes\n        \n        min_energy_at_u = np.min(current_energies)\n        \n        # Check if the original ground state is still a ground state\n        original_gs_energy_at_u = current_energies[gs_index_0]\n        \n        if original_gs_energy_at_u > min_energy_at_u + epsilon:\n            # A crossover has occurred\n            return [True, u_val]\n\n    # No crossover found\n    return [False, -1.0]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}