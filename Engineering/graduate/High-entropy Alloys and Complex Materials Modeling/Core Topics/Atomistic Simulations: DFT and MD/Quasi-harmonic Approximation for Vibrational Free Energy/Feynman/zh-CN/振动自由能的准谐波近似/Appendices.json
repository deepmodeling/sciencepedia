{
    "hands_on_practices": [
        {
            "introduction": "准谐振子近似（QHA）从根本上将材料的振动特性与其热力学行为联系起来。理解这种联系的第一步是分析其最简单的组成部分：单个振动模式。本练习将指导您从第一性原理出发，为一个频率随体积变化的量子谐振子推导其亥姆霍兹自由能和热压强，掌握这一基础计算对于理解热膨胀等热力学性质如何从晶格振动的体积依赖性中产生至关重要。",
            "id": "3755384",
            "problem": "在准谐近似下，一个化学无序的面心立方高熵合金中的单一、非简并振动模式可以被建模为一个量子谐振子，其角频率 $\\omega(V)$ 通过一个恒定的模式格林爱森参数 $\\gamma0$ 依赖于晶体体积 $V$，遵循幂律关系 $\\omega(V)=\\omega_0\\left(V/V_0\\right)^{-\\gamma}$，其中 $\\omega_0$ 是在参考体积 $V_0$ 下的模式频率。假设在温度 $T$ 下为正则系综，并采用亥姆霍兹自由能的定义 $F=-k_B T \\ln Z$，其中 $Z$ 是由能量级为 $E_n=\\hbar \\omega(V)\\left(n+\\frac{1}{2}\\right)$（$n=0,1,2,\\dots$）的谐振子的量子能谱构建的正则配分函数，$\\hbar$ 是约化普朗克常数，$k_B$ 是玻尔兹曼常数。在准谐近似内，当进行热平均时，将 $\\omega$ 视为在给定 $V$ 下的固定值。从第一性原理出发，推导该单一模式对振动亥姆霍兹自由能 $F_{\\mathrm{vib}}(T,V)$ 贡献的闭合形式表达式，然后计算其由 $P_{\\mathrm{th}}(T,V)=-\\partial F_{\\mathrm{vib}}/\\partial V$（在固定 $T$ 下）定义的热压。将你的最终结果表示为以 $\\hbar$、$k_B$、$T$、$V$、$\\omega_0$、$V_0$ 和 $\\gamma$ 为变量的闭合形式解析表达式。将你的答案以两个表达式集合的形式给出，无需进行数值计算。",
            "solution": "用户要求在准谐近似下，推导单一振动模式的振动亥姆霍兹自由能 $F_{\\mathrm{vib}}(T,V)$ 和热压 $P_{\\mathrm{th}}(T,V)$。\n\n### 第1步：问题验证\n\n**1.1. 提取已知条件**\n- **系统**：高熵合金中的一个单一、非简并振动模式。\n- **模型**：准谐近似 (QHA)，建模为量子谐振子。\n- **角频率**：$\\omega(V)=\\omega_0\\left(V/V_0\\right)^{-\\gamma}$，其中 $V$ 是晶体体积，$\\gamma0$ 是一个恒定的模式格林爱森参数，$\\omega_0$ 是在参考体积 $V_0$ 下的频率。\n- **热力学系综**：温度 $T$ 下的正则系综。\n- **能谱**：$E_n=\\hbar \\omega(V)\\left(n+\\frac{1}{2}\\right)$，对于 $n=0,1,2,\\dots$，其中 $\\hbar$ 是约化普朗克常数。\n- **亥姆霍兹自由能定义**：$F=-k_B T \\ln Z$，其中 $k_B$ 是玻尔兹曼常数，$Z$ 是正则配分函数。\n- **热压定义**：$P_{\\mathrm{th}}(T,V)=-\\partial F_{\\mathrm{vib}}/\\partial V$（在固定 $T$ 下）。\n- **准谐近似约束**：在进行热平均时，$\\omega$ 在给定的 $V$ 下被视为固定参数。\n\n**1.2. 使用提取的已知条件进行验证**\n- **科学基础**：该问题在标准统计力学和固态物理学中有充分的依据。准谐近似、量子谐振子的能级、正则配分函数、亥姆霍兹自由能和热压的定义都是基本和标准的概念。格林艾森参数及其在定义振动频率的体积依赖性中的应用是准谐近似的基石。\n- **适定性**：该问题是适定的。它提供了所有必要的定义和出发点，以唯一且有意义的方式推导出所要求的两个量，$F_{\\mathrm{vib}}(T,V)$ 和 $P_{\\mathrm{th}}(T,V)$。\n- **客观性**：该问题使用精确、客观的科学语言陈述。\n- **完整性与一致性**：该问题是自洽且内部一致的。所有必需的参数和关系均已提供。\n- **不切实际/不可行性**：该模型是一种近似，但在物理上是合理的，并广泛用于材料建模。\n- **其他缺陷**：该问题并非无关紧要、不适定或无法验证。\n\n**1.3. 结论与行动**\n问题有效。将提供完整解答。\n\n### 第2步：振动亥姆霍兹自由能 $F_{\\mathrm{vib}}(T,V)$ 的推导\n\n第一步是计算具有能级 $E_n=\\hbar \\omega(V)\\left(n+\\frac{1}{2}\\right)$ 的单一量子谐振子的正则配分函数 $Z$。\n$$Z = \\sum_{n=0}^{\\infty} \\exp\\left(-\\frac{E_n}{k_B T}\\right) = \\sum_{n=0}^{\\infty} \\exp\\left(-\\frac{\\hbar \\omega(V)\\left(n+\\frac{1}{2}\\right)}{k_B T}\\right)$$\n我们可以将求和分解为两个指数因子：\n$$Z = \\exp\\left(-\\frac{\\hbar \\omega(V)}{2k_B T}\\right) \\sum_{n=0}^{\\infty} \\exp\\left(-\\frac{n\\hbar \\omega(V)}{k_B T}\\right) = \\exp\\left(-\\frac{\\hbar \\omega(V)}{2k_B T}\\right) \\sum_{n=0}^{\\infty} \\left[\\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)\\right]^n$$\n该求和是一个形式为 $\\sum_{n=0}^{\\infty} x^n = \\frac{1}{1-x}$ 的几何级数，其中 $x = \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)$。由于 $\\hbar$、$\\omega(V)$、$k_B$ 和 $T$ 均为正值，我们有 $0  x  1$，因此该级数收敛。\n$$Z = \\exp\\left(-\\frac{\\hbar \\omega(V)}{2k_B T}\\right) \\frac{1}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)} = \\frac{\\exp\\left(-\\frac{\\hbar \\omega(V)}{2k_B T}\\right)}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)}$$\n振动亥姆霍兹自由能 $F_{\\mathrm{vib}}$ 由 $F_{\\mathrm{vib}} = -k_B T \\ln Z$ 给出。\n$$F_{\\mathrm{vib}}(T,V) = -k_B T \\ln\\left[\\frac{\\exp\\left(-\\frac{\\hbar \\omega(V)}{2k_B T}\\right)}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)}\\right]$$\n利用对数的性质 $\\ln(a/b) = \\ln(a) - \\ln(b)$：\n$$F_{\\mathrm{vib}}(T,V) = -k_B T \\left[ \\ln\\left(\\exp\\left(-\\frac{\\hbar \\omega(V)}{2k_B T}\\right)\\right) - \\ln\\left(1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)\\right) \\right]$$\n$$F_{\\mathrm{vib}}(T,V) = -k_B T \\left[ -\\frac{\\hbar \\omega(V)}{2k_B T} - \\ln\\left(1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)\\right) \\right]$$\n$$F_{\\mathrm{vib}}(T,V) = \\frac{1}{2}\\hbar \\omega(V) + k_B T \\ln\\left(1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)\\right)$$\n这个表达式将自由能分为零点能项 $\\frac{1}{2}\\hbar \\omega(V)$ 和一个源于热激发的温度依赖项。\n\n最后，我们代入给定的频率的体积依赖关系 $\\omega(V)=\\omega_0\\left(V/V_0\\right)^{-\\gamma}$：\n$$F_{\\mathrm{vib}}(T,V) = \\frac{1}{2}\\hbar \\omega_0 \\left(\\frac{V}{V_0}\\right)^{-\\gamma} + k_B T \\ln\\left(1 - \\exp\\left[-\\frac{\\hbar \\omega_0}{k_B T}\\left(\\frac{V}{V_0}\\right)^{-\\gamma}\\right]\\right)$$\n这是振动亥姆霍兹自由能的最终表达式。\n\n### 第3步：热压 $P_{\\mathrm{th}}(T,V)$ 的推导\n\n热压定义为 $P_{\\mathrm{th}}(T,V) = -\\frac{\\partial F_{\\mathrm{vib}}}{\\partial V}$（在恒定 $T$ 下）。我们将推导出的 $F_{\\mathrm{vib}}(T,V)$ 表达式对 $V$ 求导。首先求出 $\\omega(V)$ 对 $V$ 的导数会很有帮助：\n$$\\omega(V) = \\omega_0 \\left(\\frac{1}{V_0}\\right)^{-\\gamma} V^{-\\gamma} = \\omega_0 V_0^{\\gamma} V^{-\\gamma}$$\n$$\\frac{\\partial \\omega(V)}{\\partial V} = \\omega_0 V_0^{\\gamma} (-\\gamma) V^{-\\gamma-1} = -\\gamma \\frac{\\omega_0 V_0^{\\gamma} V^{-\\gamma}}{V} = -\\gamma \\frac{\\omega(V)}{V}$$\n现在，我们逐项对 $F_{\\mathrm{vib}}(T,V)$ 进行微分：\n$$P_{\\mathrm{th}}(T,V) = -\\frac{\\partial}{\\partial V}\\left[\\frac{1}{2}\\hbar \\omega(V) + k_B T \\ln\\left(1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)\\right)\\right]$$\n我们分别对这两项进行微分。\n第一项：\n$$-\\frac{\\partial}{\\partial V}\\left(\\frac{1}{2}\\hbar \\omega(V)\\right) = -\\frac{1}{2}\\hbar \\frac{\\partial \\omega(V)}{\\partial V} = -\\frac{1}{2}\\hbar \\left(-\\gamma \\frac{\\omega(V)}{V}\\right) = \\frac{\\gamma}{V} \\frac{1}{2}\\hbar \\omega(V)$$\n第二项（使用链式法则）：\n$$-\\frac{\\partial}{\\partial V}\\left[k_B T \\ln\\left(1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)\\right)\\right] = -k_B T \\frac{1}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)} \\frac{\\partial}{\\partial V}\\left(1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)\\right)$$\n$$-k_B T \\frac{-\\left[\\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right) \\cdot \\left(-\\frac{\\hbar}{k_B T}\\right) \\frac{\\partial \\omega(V)}{\\partial V}\\right]}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)} = - \\hbar \\frac{\\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)} \\frac{\\partial \\omega(V)}{\\partial V}$$\n代入 $\\frac{\\partial \\omega(V)}{\\partial V} = -\\gamma \\frac{\\omega(V)}{V}$：\n$$- \\hbar \\frac{\\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)} \\left(-\\gamma \\frac{\\omega(V)}{V}\\right) = \\frac{\\gamma}{V} \\frac{\\hbar \\omega(V) \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)}{1 - \\exp\\left(-\\frac{\\hbar \\omega(V)}{k_B T}\\right)}$$\n为了简化此分数，我们将分子和分母同乘以 $\\exp\\left(\\frac{\\hbar \\omega(V)}{k_B T}\\right)$:\n$$\\frac{\\gamma}{V} \\frac{\\hbar \\omega(V)}{\\exp\\left(\\frac{\\hbar \\omega(V)}{k_B T}\\right) - 1}$$\n合并两项的导数：\n$$P_{\\mathrm{th}}(T,V) = \\frac{\\gamma}{V} \\frac{1}{2}\\hbar \\omega(V) + \\frac{\\gamma}{V} \\frac{\\hbar \\omega(V)}{\\exp\\left(\\frac{\\hbar \\omega(V)}{k_B T}\\right) - 1}$$\n提出公因式 $\\frac{\\gamma}{V}$：\n$$P_{\\mathrm{th}}(T,V) = \\frac{\\gamma}{V} \\left[\\frac{1}{2}\\hbar \\omega(V) + \\frac{\\hbar \\omega(V)}{\\exp\\left(\\frac{\\hbar \\omega(V)}{k_B T}\\right) - 1}\\right]$$\n方括号中的项是振子的总振动内能 $U_{\\mathrm{vib}}(T,V)$，由零点能和热能组成。\n最后，我们代入 $\\omega(V)$ 的表达式：\n$$P_{\\mathrm{th}}(T,V) = \\frac{\\gamma}{V} \\left[ \\frac{1}{2}\\hbar \\omega_0 \\left(\\frac{V}{V_0}\\right)^{-\\gamma} + \\frac{\\hbar \\omega_0 \\left(\\frac{V}{V_0}\\right)^{-\\gamma}}{\\exp\\left(\\frac{\\hbar \\omega_0}{k_B T}\\left(\\frac{V}{V_0}\\right)^{-\\gamma}\\right) - 1} \\right]$$\n这是热压的最终表达式。",
            "answer": "$$\\boxed{\\begin{pmatrix} F_{\\mathrm{vib}}(T,V) = \\frac{1}{2}\\hbar \\omega_0 \\left(\\frac{V}{V_0}\\right)^{-\\gamma} + k_B T \\ln\\left(1 - \\exp\\left[-\\frac{\\hbar \\omega_0}{k_B T}\\left(\\frac{V}{V_0}\\right)^{-\\gamma}\\right]\\right) \\\\ P_{\\mathrm{th}}(T,V) = \\frac{\\gamma}{V} \\left[ \\frac{1}{2}\\hbar \\omega_0 \\left(\\frac{V}{V_0}\\right)^{-\\gamma} + \\frac{\\hbar \\omega_0 \\left(\\frac{V}{V_0}\\right)^{-\\gamma}}{\\exp\\left(\\frac{\\hbar \\omega_0}{k_B T}\\left(\\frac{V}{V_0}\\right)^{-\\gamma}\\right) - 1} \\right] \\end{pmatrix}}$$"
        },
        {
            "introduction": "基于振动诱导压强的概念，我们可以进一步探索其在绝对零度下的效应。德拜模型为我们提供了一个强大的框架，用以整合固体中所有振动模式的贡献，包括它们的量子零点能。本问题挑战您计算德拜固体中纯粹由零点振动引起的体积变化，通过线性化状态方程，您将推导出微观参数（如德拜温度和格林爱森参数）与宏观可观测量（体积位移）之间的直接关系，从而揭示固体中一个关键的量子效应。",
            "id": "3755403",
            "problem": "一种单相等原子比高熵合金在准谐振子近似（QHA）下被建模为各向同性的Debye固体。在零温下，亥姆霍兹自由能是静态晶格能和零点振动能之和。样品处于外部静水压 $P_{0}$下，其在 $P_{0}$ 下的冷（静态晶格）平衡体积为 $V_{0}$。此状态下的等温体弹性模量为 $B_{0}$，其定义为 $B_{0}=-V\\left(\\partial P_{\\mathrm{cold}}/\\partial V\\right)\\big|_{V_{0}}$。Debye温度随体积的变化关系为 $\\Theta_{D}(V)=\\Theta_{D0}\\left(V/V_{0}\\right)^{-\\gamma}$，其中 $\\gamma$ 是一个常数Grüneisen参数，且 $\\Theta_{D0}=\\Theta_{D}(V_{0})$。系统包含 $N$ 个原子。\n\n从基本定义——恒温下的压强 $P(V)=-\\partial F/\\partial V$ 和 $T=0$ 时Debye模型的零点振动能——出发，并对小的体积分数变化 $\\Delta V/V_{0}$ 保留到领头阶，通过求解一阶方程 $P_{\\mathrm{cold}}(V)+P_{\\mathrm{ZP}}(V)=P_{0}$ 来确定由零点振动在 $T=0$ 时产生的体积位移 $\\Delta V=V-V_{0}$ 的解析表达式。用 $N$、$k_{B}$、$\\gamma$、$\\Theta_{D0}$ 和 $B_{0}$ 的符号形式表示最终答案。不需要进行数值计算。",
            "solution": "我们从零温下的准谐振子近似（QHA）出发，此时亥姆霍兹自由能为\n$$\nF(V,T=0)=U_{\\mathrm{cold}}(V)+E_{\\mathrm{ZP}}(V),\n$$\n其中 $U_{\\mathrm{cold}}(V)$ 是静态晶格能，$E_{\\mathrm{ZP}}(V)$ 是零点振动能。恒温下的机械压强定义为\n$$\nP(V)=-\\frac{\\partial F}{\\partial V}=-\\frac{\\partial U_{\\mathrm{cold}}}{\\partial V}-\\frac{\\partial E_{\\mathrm{ZP}}}{\\partial V}\\equiv P_{\\mathrm{cold}}(V)+P_{\\mathrm{ZP}}(V).\n$$\n\n对于一个包含 $N$ 个原子的Debye固体，其零点能的成熟Debye模型表达式为\n$$\nE_{\\mathrm{ZP}}(V)=\\frac{9}{8}N k_{B}\\,\\Theta_{D}(V),\n$$\n其中 $\\Theta_{D}(V)$ 是Debye温度。因此，零点振动压强为\n$$\nP_{\\mathrm{ZP}}(V)=-\\frac{\\partial E_{\\mathrm{ZP}}}{\\partial V}=-\\frac{9}{8}N k_{B}\\,\\frac{\\partial \\Theta_{D}(V)}{\\partial V}.\n$$\n已知 $\\Theta_{D}(V)=\\Theta_{D0}\\left(\\frac{V}{V_{0}}\\right)^{-\\gamma}$，其导数为\n$$\n\\frac{\\partial \\Theta_{D}}{\\partial V}=\\Theta_{D0}\\left(-\\gamma\\right)\\left(\\frac{V}{V_{0}}\\right)^{-\\gamma-1}\\frac{1}{V_{0}}=-\\gamma\\,\\frac{\\Theta_{D}(V)}{V}.\n$$\n因此，\n$$\nP_{\\mathrm{ZP}}(V)=-\\frac{9}{8}N k_{B}\\left(-\\gamma\\,\\frac{\\Theta_{D}(V)}{V}\\right)=\\frac{9}{8}N k_{B}\\,\\gamma\\,\\frac{\\Theta_{D}(V)}{V}.\n$$\n\n接下来，我们在 $P_{0}$ 下，对 $V_{0}$ 附近的静态晶格（冷）状态方程进行线性化。此状态下的等温体弹性模量为\n$$\nB_{0}=-V\\left(\\frac{\\partial P_{\\mathrm{cold}}}{\\partial V}\\right)\\Big|_{V_{0}},\n$$\n因此，$P_{\\mathrm{cold}}(V)$ 关于 $V_{0}$ 的一阶泰勒展开为\n$$\nP_{\\mathrm{cold}}(V)\\approx P_{0}-\\frac{B_{0}}{V_{0}}\\,(V-V_{0})=P_{0}-\\frac{B_{0}}{V_{0}}\\,\\Delta V,\n$$\n其中 $\\Delta V\\equiv V-V_{0}$。\n\n在外部压强为 $P_{0}$ 时，$T=0$ 下的力学平衡要求\n$$\nP_{\\mathrm{cold}}(V)+P_{\\mathrm{ZP}}(V)=P_{0}.\n$$\n代入线性化的 $P_{\\mathrm{cold}}$，并在 $V\\approx V_{0}$ （因此 $\\Theta_{D}(V)\\approx \\Theta_{D0}$ 且 $V\\approx V_{0}$）处对 $P_{\\mathrm{ZP}}$ 取领头阶，可得\n$$\nP_{0}-\\frac{B_{0}}{V_{0}}\\,\\Delta V+\\frac{9}{8}N k_{B}\\,\\gamma\\,\\frac{\\Theta_{D0}}{V_{0}}=P_{0}.\n$$\n近似 $P_{\\mathrm{ZP}}(V)\\approx P_{\\mathrm{ZP}}(V_{0})$ 在一阶上是一致的，因为由 $\\Delta V$ 引起的 $P_{\\mathrm{ZP}}$ 的分数变化是 $\\mathcal{O}(\\gamma\\,\\Delta V/V_{0})$ 阶，而 $\\Delta V$ 本身对于小比率 $E_{\\mathrm{ZP}}/B_{0}V_{0}$ 是一阶的；因此，它们的乘积是二阶的，在领头阶可以忽略。\n\n消去等式两边的 $P_{0}$ 并求解 $\\Delta V$ 可得\n$$\n-\\frac{B_{0}}{V_{0}}\\,\\Delta V+\\frac{9}{8}N k_{B}\\,\\gamma\\,\\frac{\\Theta_{D0}}{V_{0}}=0\n\\quad\\Longrightarrow\\quad\n\\Delta V=\\frac{V_{0}}{B_{0}}\\left(\\frac{9}{8}N k_{B}\\,\\gamma\\,\\frac{\\Theta_{D0}}{V_{0}}\\right)=\\frac{9}{8}\\,\\frac{N k_{B}\\,\\gamma\\,\\Theta_{D0}}{B_{0}}.\n$$\n\n这就是对于 $\\Theta_{D}(V)\\propto V^{-\\gamma}$ 的Debye固体，在 $T=0$ 时由零点振动压强引起的领头阶体积位移。",
            "answer": "$$\\boxed{\\frac{9}{8}\\,\\frac{N k_{B}\\,\\gamma\\,\\Theta_{D0}}{B_{0}}}$$"
        },
        {
            "introduction": "热力学建模的最终目标通常是预测材料在特定温度和压力条件下的稳定状态，这需要计算吉布斯自由能。准谐振子近似为此提供了一种实用而强大的计算方法。这个综合性练习将指导您将理论付诸实践，编写程序来计算吉布斯自由能。您需要将静态晶格能（通过 Birch-Murnaghan 状态方程）与振动自由能（通过德拜模型）相结合，通过最小化 $G(T,P) = F(V,T) + PV$ 来找到平衡体积，这项任务概括了使用准谐振子近似预测材料属性的完整工作流程。",
            "id": "3755401",
            "problem": "在高熵合金和复杂材料建模的背景下，您需要实现一种用于计算振动自由能的准谐近似。基本的热力学目标是，对于每个指定的温度和压力，求得使亥姆霍兹自由能的勒让德变换最小化的平衡体积，并报告相应的吉布斯自由能。建模假设如下：静态晶格能由三阶 Birch–Murnaghan 冷曲线描述，振动自由能通过德拜近似建模，其中与体积相关的德拜温度遵循幂律。\n\n从以下基础出发：\n- 亥姆霍兹自由能 $F(T,V)$ 等于内能减去温度与熵的乘积，即 $F(T,V) = U(T,V) - T S(T,V)$。\n- 在准谐近似中，将 $F(T,V)$ 写为静态晶格能和振动自由能之和，$F(T,V) = E_{\\mathrm{static}}(V) + F_{\\mathrm{vib}}(T,V)$。\n- 在压力 $P$ 下的吉布斯自由能 $G(T,P)$ 是勒让德变换 $F(T,V) + P V$ 相对于体积 $V$ 的最小值。\n- 对于德拜固体，振动自由能可以写为声子态密度的频率积分，在德拜模型中，声子态密度是一个带截断的二次函数，而德拜温度 $\\Theta_D(V)$ 根据类格林艾森定律与体积的负幂成正比。\n\n您的任务：\n1. 从吉布斯自由能作为亥姆霍兹自由能的勒让德变换的定义出发，使用准谐分解和包含体积依赖的德拜温度的德拜模型，推导出 $G(T,P)$ 的表达式，该表达式是基于 $E_{\\mathrm{static}}(V)$、$F_{\\mathrm{vib}}(T,V)$ 和 $P V$ 构建的关于 $V$ 的标量函数的最小值。推导应仅从经过充分验证的公式和事实开始：平衡时的关系 $G=F+PV$、亥姆霍兹自由能的定义、具有与 $\\Theta_D(V)$ 成正比的截断频率的德拜积分表示，以及函数形式 $\\Theta_D(V) = \\Theta_{D0} \\left(\\frac{V}{V_0}\\right)^{-\\gamma}$（其中 $\\Theta_{D0}$、$V_0$ 和 $\\gamma$ 为常数）。\n2. 明确构建一个数值稳定的程序，以找到使标量函数 $\\Phi(V;T,P) = F(T,V) + P V$ 最小化的体积 $V$。其中 $F(T,V)$ 由三阶 Birch–Murnaghan 静态能和德拜模型的振动贡献构成。您的程序必须：\n   - 在参考体积 $V_0$ 附近一个物理上合理的 $V$ 区间上，使用有界一维最小化算法。\n   - 使用其积分表示形式（以无量纲积分变量和上限 $\\Theta_D(V)/T$ 表示）来评估德拜振动自由能，并在 $T$ 接近 $0$ 时正确包含零点能项。\n   - 严格处理单位转换。使用单位为电子伏特/开尔文的 $k_B$，并使用恒等式 $1\\,\\mathrm{eV}/\\text{\\AA}^3 = 160.21766208\\,\\mathrm{GPa}$ 将压力从吉帕斯卡转换为电子伏特/立方埃。\n3. 在一个单一、可运行的程序中实现整个过程，该程序为每个测试用例返回最小化体积和相应的吉布斯自由能。\n\n物理和数值单位及输出规范：\n- 体积必须以每原子立方埃（$\\text{\\AA}^3$/atom）表示。\n- 温度必须以开尔文（$\\mathrm{K}$）表示。\n- 压力必须以吉帕斯卡（$\\mathrm{GPa}$）表示。\n- 能量必须以每原子电子伏特（$\\mathrm{eV}$/atom）表示。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果是一个双元素列表 $[V^\\ast, G(T,P)]$，两个条目都四舍五入到六位小数，例如 $[[12.000000,-3.000000],[\\dots,\\dots],\\dots]$。\n\n测试套件：\n使用以下材料参数，这些参数代表了高熵合金中随机固溶体的单原子替代模型：\n- 参考能量 $E_0 = -3.000000\\,\\mathrm{eV}$/atom。\n- 参考体积 $V_0 = 12.000000\\,\\text{\\AA}^3$/atom。\n- 在 $V_0$ 处的体积模量 $B_0 = 180.000000\\,\\mathrm{GPa}$。\n- 在 $V_0$ 处的体积模量一阶导数 $B_0' = 5.000000$。\n- 参考德拜温度 $\\Theta_{D0} = 350.000000\\,\\mathrm{K}$。\n- 格林艾森参数 $\\gamma = 1.800000$，用于 $\\Theta_D(V) = \\Theta_{D0} \\left(\\frac{V}{V_0}\\right)^{-\\gamma}$。\n\n在以下温度-压力条件下运行您的程序，以测试多种情况：\n- 情况 A（边界情况，零温零压）：$T = 0.000000\\,\\mathrm{K}$, $P = 0.000000\\,\\mathrm{GPa}$。\n- 情况 B（环境压力下的热膨胀）：$T = 1200.000000\\,\\mathrm{K}$, $P = 0.000000\\,\\mathrm{GPa}$。\n- 情况 C（高温中等压缩）：$T = 1200.000000\\,\\mathrm{K}$, $P = 30.000000\\,\\mathrm{GPa}$。\n- 情况 D（室温高压）：$T = 300.000000\\,\\mathrm{K}$, $P = 50.000000\\,\\mathrm{GPa}$。\n\n算法要求：\n- 在 $V \\in [0.600000\\,V_0,\\,1.400000\\,V_0]$ 上使用有界最小化。\n- 通过在德拜自由能中仅保留零点能项来处理 $T \\to 0$ 的极限情况。\n- 确保德拜自由能的数值积分对于大的 $\\Theta_D(V)/T$ 值能够稳健收敛。\n\n最终输出格式：\n您的程序应生成单行输出，其中按顺序包含情况 A–D 的四个双元素列表，形式为用方括号括起来的逗号分隔列表，每个浮点数四舍五入到六位小数：$[[V_A^\\ast,G_A],[V_B^\\ast,G_B],[V_C^\\ast,G_C],[V_D^\\ast,G_D]]$。",
            "solution": "该问题要求实现准谐近似（QHA）来确定材料的平衡热力学性质。具体而言，对于给定的温度 $T$ 和压力 $P$，我们必须找到使吉布斯自由能泛函 $\\Phi(V; T, P)$ 最小化的平衡体积 $V^\\ast$，并报告 $V^\\ast$ 和相应的最小化吉布斯自由能 $G(T,P) = \\Phi(V^\\ast; T, P)$。该泛函定义为亥姆霍兹自由能 $F(T,V)$ 的勒让德变换：\n$$\n\\Phi(V; T, P) = F(T,V) + P V\n$$\n在 QHA 框架内，亥姆霍兹自由能被分解为静态晶格能 $E_{\\mathrm{static}}(V)$ 和依赖于体积的振动自由能 $F_{\\mathrm{vib}}(T,V)$：\n$$\nF(T,V) = E_{\\mathrm{static}}(V) + F_{\\mathrm{vib}}(T,V)\n$$\n因此，我们的目标是找到以下函数相对于体积 $V$ 的最小值：\n$$\n\\Phi(V; T, P) = E_{\\mathrm{static}}(V) + F_{\\mathrm{vib}}(T,V) + P V\n$$\n问题指定了每一项的模型，我们现在将详细阐述。所有能量和体积均以每原子为单位表示。\n\n**静态晶格能：三阶 Birch–Murnaghan 状态方程**\n\n晶格的静态能量作为体积的函数，$E_{\\mathrm{static}}(V)$，由三阶 Birch–Murnaghan 状态方程描述。该方程由自由能对欧拉有限应变的展开推导而来。每原子的能量由下式给出：\n$$\nE_{\\mathrm{static}}(V) = E_0 + \\frac{9 V_0 B_0}{16} \\left\\{ \\left[ \\left(\\frac{V_0}{V}\\right)^{2/3} - 1 \\right]^3 B_0' + \\left[ \\left(\\frac{V_0}{V}\\right)^{2/3} - 1 \\right]^2 \\left[ 6 - 4 \\left(\\frac{V_0}{V}\\right)^{2/3} \\right] \\right\\}\n$$\n此处，$E_0$ 是参考能量，$V_0$ 是参考体积，$B_0$ 是在 $V_0$ 处的体积模量，$B_0'$ 是在 $V_0$ 处体积模量的一阶压力导数。为了在我们的能量计算中保持一致性，以吉帕斯卡（GPa）为单位的体积模量 $B_0$ 必须使用提供的转换因子 $1\\,\\mathrm{eV}/\\text{\\AA}^3 = 160.21766208\\,\\mathrm{GPa}$ 转换为电子伏特/立方埃（$\\mathrm{eV}/\\text{\\AA}^3$）。\n\n**振动自由能：德拜模型**\n\n对自由能的振动贡献 $F_{\\mathrm{vib}}(T,V)$ 使用德拜模型计算。在该模型中，每原子的振动自由能是非热的零点能（ZPE）和依赖于温度的热自由能之和：\n$$\nF_{\\mathrm{vib}}(T,V) = E_{\\mathrm{ZPE}}(V) + F_{\\mathrm{th}}(T,V)\n$$\n零点能由下式给出：\n$$\nE_{\\mathrm{ZPE}}(V) = \\frac{9}{8} k_B \\Theta_D(V)\n$$\n其中 $k_B$ 是玻尔兹曼常数，$\\Theta_D(V)$ 是依赖于体积的德拜温度。振动自由能的热分量为：\n$$\nF_{\\mathrm{th}}(T,V) = k_B T \\left[ 3 \\ln\\left(1 - e^{-\\Theta_D(V)/T}\\right) - D_3\\left(\\frac{\\Theta_D(V)}{T}\\right) \\right]\n$$\n此处，$D_3(y)$ 是三阶德拜函数，由积分定义：\n$$\nD_3(y) = \\frac{3}{y^3} \\int_0^y \\frac{t^3}{e^t - 1} dt\n$$\n德拜温度对体积的依赖性由幂律建模，这与 Grüneisen 理论一致：\n$$\n\\Theta_D(V) = \\Theta_{D0} \\left(\\frac{V}{V_0}\\right)^{-\\gamma}\n$$\n其中 $\\Theta_{D0}$ 是在参考体积 $V_0$ 处的德拜温度，$\\gamma$ 是格林艾森参数。\n\n结合这些项，振动自由能的完整表达式为：\n$$\nF_{\\mathrm{vib}}(T,V) = \\frac{9}{8} k_B \\Theta_D(V) + k_B T \\left[ 3 \\ln\\left(1 - e^{-\\Theta_D(V)/T}\\right) - D_3\\left(\\frac{\\Theta_D(V)}{T}\\right) \\right]\n$$\n对于 $T=0\\,\\mathrm{K}$ 的特殊情况，热项 $F_{\\mathrm{th}}(T,V)$ 消失，振动自由能简化为零点能，$F_{\\mathrm{vib}}(0,V) = E_{\\mathrm{ZPE}}(V)$。\n\n**压力-体积项与单位一致性**\n\n吉布斯泛函中的最后一项是功项 $P V$。为保持与以电子伏特（$\\mathrm{eV}$）计算的能量项的单位一致性，以吉帕斯卡（$\\mathrm{GPa}$）给出的压力 $P$ 必须转换为 $\\mathrm{eV}/\\text{\\AA}^3$。该项的能量计算如下：\n$$\nE_{PV} = P\\,[\\mathrm{GPa}] \\times V\\,[\\text{\\AA}^3] \\times \\frac{1}{160.21766208} \\,[\\mathrm{eV}/(\\mathrm{GPa}\\cdot\\text{\\AA}^3)]\n$$\n\n**数值最小化过程**\n\n对于给定的 $(T, P)$ 对，平衡体积 $V^\\ast$ 通过对目标函数 $\\Phi(V; T, P)$ 关于 $V$ 进行数值最小化来找到。我们在物理上合理的区间 $V \\in [0.600000\\,V_0, 1.400000\\,V_0]$ 上，采用有界一维最小化算法，即 `scipy.optimize.minimize_scalar` 并设置 `method='bounded'`。\n\n数值实现需要仔细处理某些方面：\n1.  **零温极限**：对于 $T  10^{-6}\\,\\mathrm{K}$，我们明确设置 $F_{\\mathrm{vib}}(T,V) = E_{\\mathrm{ZPE}}(V)$ 以避免除以零和其他数值不稳定性。\n2.  **德拜积分**：德拜函数 $D_3(y)$ 的积分使用 `scipy.integrate.quad` 进行数值计算。当上限 $y = \\Theta_D(V)/T$ 值很大时，积分迅速收敛到已知的解析极限 $\\int_0^\\infty \\frac{t^3}{e^t - 1} dt = \\frac{\\pi^4}{15}$。为确保稳定性和效率，当 $y  100$ 时使用此渐近值。被积函数在 $t=0$ 处非奇异，`scipy.integrate.quad` 可以正确处理。在分母 `e^t-1` 中使用表达式 `np.expm1(t)` 以提高小 $t$ 时的精度。\n3.  **对数项**：当 $y$ 很大且 $e^{-y}$ 接近于零时，项 $\\ln(1 - e^{-y})$ 计算为 `np.log1p(-np.exp(-y))` 以保持数值精度。\n\n该过程对每个测试用例 $(T,P)$ 执行。最小化例程返回最优体积 $V^\\ast$ 和函数 $\\Phi(V^\\ast; T,P)$ 的最小值，该值对应于吉布斯自由能 $G(T,P)$。最终结果被收集并按规定格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Calculates the equilibrium volume and Gibbs free energy for a material\n    using the quasi-harmonic approximation with a Birch-Murnaghan static energy\n    term and a Debye model for vibrational free energy.\n    \"\"\"\n\n    # Physical constants\n    KB_EV_K = 8.617333262145e-5  # Boltzmann constant in eV/K\n    GPA_TO_EV_PER_A3 = 1.0 / 160.21766208  # Conversion factor\n\n    # Material parameters from the problem statement\n    E0 = -3.000000         # Reference energy in eV/atom\n    V0 = 12.000000         # Reference volume in A^3/atom\n    B0 = 180.000000        # Bulk modulus in GPa\n    B0_PRIME = 5.000000    # First derivative of bulk modulus\n    THETA_D0 = 350.000000  # Reference Debye temperature in K\n    GAMMA = 1.800000       # Grüneisen parameter\n\n    # Test cases: (Temperature [K], Pressure [GPa])\n    test_cases = [\n        (0.000000, 0.000000),    # Case A\n        (1200.000000, 0.000000), # Case B\n        (1200.000000, 30.000000),# Case C\n        (300.000000, 50.000000), # Case D\n    ]\n\n    # Pre-calculate constants for efficiency\n    B0_EV_A3 = B0 * GPA_TO_EV_PER_A3\n    DEBYE_INTEGRAL_INF = np.pi**4 / 15.0\n\n    memoized_debye_integrals = {}\n\n    def get_debye_integral(y):\n        \"\"\"\n        Numerically calculates the integral component of the Debye function,\n        with memoization and an asymptotic limit for large y.\n        \"\"\"\n        if y in memoized_debye_integrals:\n            return memoized_debye_integrals[y]\n        \n        if y > 100.0:  # Use asymptotic limit for large y\n            result = DEBYE_INTEGRAL_INF\n        else:\n            integrand = lambda t: t**3 / np.expm1(t)\n            result, _ = quad(integrand, 0, y)\n        \n        memoized_debye_integrals[y] = result\n        return result\n\n    def static_energy(V):\n        \"\"\"Calculates the static lattice energy using the 3rd-order Birch-Murnaghan EOS.\"\"\"\n        eta = (V0 / V)**(2.0/3.0)\n        term1 = (eta - 1)**3 * B0_PRIME\n        term2 = (eta - 1)**2 * (6 - 4 * eta)\n        return E0 + (9 * V0 * B0_EV_A3 / 16) * (term1 + term2)\n\n    def vibrational_free_energy(T, V):\n        \"\"\"Calculates the vibrational free energy using the Debye model.\"\"\"\n        if V = 1e-9: # Avoid division by zero for volume\n            return np.inf\n        \n        theta_d_v = THETA_D0 * (V / V0)**(-GAMMA)\n        \n        # Zero-point energy (athermal component)\n        zpe = 9.0 / 8.0 * KB_EV_K * theta_d_v\n\n        # Handle T=0 K case explicitly to avoid numerical issues\n        if T  1e-6:\n            return zpe\n\n        y = theta_d_v / T\n\n        # Thermal component\n        debye_integral_val = get_debye_integral(y)\n        d3 = (3.0 / y**3) * debye_integral_val\n        \n        # Use np.log1p for precision: log(1-exp(-y))\n        log_term = np.log1p(-np.exp(-y)) if y  700 else 0.0\n\n        f_thermal = KB_EV_K * T * (3.0 * log_term - d3)\n        \n        return zpe + f_thermal\n\n    def objective_function(V, T, P):\n        \"\"\"The Gibbs free energy functional to be minimized.\"\"\"\n        e_static = static_energy(V)\n        f_vib = vibrational_free_energy(T, V)\n        pv_term = P * GPA_TO_EV_PER_A3 * V\n        return e_static + f_vib + pv_term\n\n    results = []\n    for T, P in test_cases:\n        # Clear memoization cache for each new minimization\n        memoized_debye_integrals.clear()\n\n        # Define the function to be minimized for the current T and P\n        func_to_minimize = lambda v: objective_function(v, T, P)\n        \n        # Define bounds for the minimization\n        bounds = (0.6 * V0, 1.4 * V0)\n        \n        # Perform bounded scalar minimization\n        res = minimize_scalar(\n            func_to_minimize,\n            bounds=bounds,\n            method='bounded',\n            options={'xatol': 1e-9, 'maxiter': 500}\n        )\n        \n        v_star = res.x\n        g_min = res.fun\n        \n        results.append([v_star, g_min])\n\n    # Format the final output string exactly as specified\n    formatted_results = [f'[{v:.6f},{g:.6f}]' for v, g in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}