{
    "hands_on_practices": [
        {
            "introduction": "The engine driving any phase transformation is the reduction in Gibbs free energy. Before we can analyze the kinetics of nucleation, we must first quantify this thermodynamic driving force, $\\Delta g$. In modern materials science, especially for multicomponent systems like high-entropy alloys, the CALPHAD (Computer Coupling of Phase Diagrams and Thermochemistry) method provides the essential framework for this task. This practice  will guide you through the implementation of CALPHAD-style thermodynamic models, giving you hands-on experience in calculating the bulk driving force from first principles and assessing the model's sensitivity to interaction parameters.",
            "id": "3733453",
            "problem": "You are asked to compute the molar bulk free-energy driving force for a phase transformation under classical nucleation and growth theory in a quinary high-entropy alloy using two thermodynamic models and to compare their predictions. The alloy is a five-component system $\\{\\mathrm{Cr},\\mathrm{Mn},\\mathrm{Fe},\\mathrm{Co},\\mathrm{Ni}\\}$ with a specified composition vector. The transformation considered is from a disordered Face-Centered Cubic (FCC) solution phase to a disordered Body-Centered Cubic (BCC) solution phase at temperature $T$. The driving force is defined as the molar Gibbs free energy change $\\Delta g_{\\mathrm{molar}} = g_{\\mathrm{BCC}}(x,T) - g_{\\mathrm{FCC}}(x,T)$, which serves as the bulk term in classical nucleation barriers. You must compute $\\Delta g_{\\mathrm{molar}}$ using a Computer Coupling of Phase Diagrams and Thermochemistry (CALPHAD) style Gibbs free energy with temperature-dependent pairwise interaction parameters and compare it to a simplified regular solution model with constant pairwise interactions. Your final outputs must be expressed in $\\mathrm{J/mol}$.\n\nFundamental base and definitions that must be used:\n- The molar Gibbs free energy of a multicomponent solution phase is the sum of reference contributions, the ideal configurational entropy term, and an excess interaction term. Let the composition vector be $x = (x_1,x_2,x_3,x_4,x_5)$ with $\\sum_i x_i = 1$, and temperature $T$ in $\\mathrm{K}$. The ideal configurational entropy contribution for a solution is proportional to $\\sum_i x_i \\ln x_i$ and must be multiplied by the gas constant and the temperature. The excess term accounts for pairwise interactions between components and must respect symmetry and composition weighting. All calculations must be performed on a per-mole basis.\n- Use the ideal configurational entropy constant $R = 8.314$ $\\mathrm{J/(mol\\,K)}$.\n\nPhase-specific CALPHAD-style parameters (units are $\\mathrm{J/mol}$ for constants and $\\mathrm{J/(mol\\,K)}$ for temperature coefficients):\n- FCC reference molar energies per component, modeled as $g_i^{0,\\mathrm{FCC}}(T) = a_i^{\\mathrm{FCC}} + b_i^{\\mathrm{FCC}}\\,T$:\n  - $\\mathrm{Cr}$: $a_1^{\\mathrm{FCC}} = -35000$, $b_1^{\\mathrm{FCC}} = 5$\n  - $\\mathrm{Mn}$: $a_2^{\\mathrm{FCC}} = -30000$, $b_2^{\\mathrm{FCC}} = 6$\n  - $\\mathrm{Fe}$: $a_3^{\\mathrm{FCC}} = -32000$, $b_3^{\\mathrm{FCC}} = 5.5$\n  - $\\mathrm{Co}$: $a_4^{\\mathrm{FCC}} = -33000$, $b_4^{\\mathrm{FCC}} = 5.2$\n  - $\\mathrm{Ni}$: $a_5^{\\mathrm{FCC}} = -34000$, $b_5^{\\mathrm{FCC}} = 5.1$\n- BCC reference molar energies per component, modeled as $g_i^{0,\\mathrm{BCC}}(T) = a_i^{\\mathrm{BCC}} + b_i^{\\mathrm{BCC}}\\,T$:\n  - $\\mathrm{Cr}$: $a_1^{\\mathrm{BCC}} = -34000$, $b_1^{\\mathrm{BCC}} = 5.1$\n  - $\\mathrm{Mn}$: $a_2^{\\mathrm{BCC}} = -31000$, $b_2^{\\mathrm{BCC}} = 5.8$\n  - $\\mathrm{Fe}$: $a_3^{\\mathrm{BCC}} = -33000$, $b_3^{\\mathrm{BCC}} = 5.3$\n  - $\\mathrm{Co}$: $a_4^{\\mathrm{BCC}} = -32000$, $b_4^{\\mathrm{BCC}} = 5.0$\n  - $\\mathrm{Ni}$: $a_5^{\\mathrm{BCC}} = -33500$, $b_5^{\\mathrm{BCC}} = 5.0$\n\nCALPHAD-style pairwise interaction parameters for FCC and BCC are temperature-dependent and symmetric in component indices. Let the pair interaction be $L_{ij}^{\\mathrm{phase}}(T) = L_{0,ij}^{\\mathrm{phase}} + L_{1,ij}^{\\mathrm{phase}}\\,T$ for $ij$, and $L_{ij} = L_{ji}$. The nonzero pairs are listed below.\n\nFCC interactions:\n- $(\\mathrm{Cr},\\mathrm{Mn})$: $L_{0,12}^{\\mathrm{FCC}} = 8000$, $L_{1,12}^{\\mathrm{FCC}} = -3$\n- $(\\mathrm{Cr},\\mathrm{Fe})$: $L_{0,13}^{\\mathrm{FCC}} = 12000$, $L_{1,13}^{\\mathrm{FCC}} = -4$\n- $(\\mathrm{Cr},\\mathrm{Co})$: $L_{0,14}^{\\mathrm{FCC}} = 10000$, $L_{1,14}^{\\mathrm{FCC}} = -2$\n- $(\\mathrm{Cr},\\mathrm{Ni})$: $L_{0,15}^{\\mathrm{FCC}} = 9000$, $L_{1,15}^{\\mathrm{FCC}} = -2.5$\n- $(\\mathrm{Mn},\\mathrm{Fe})$: $L_{0,23}^{\\mathrm{FCC}} = 7000$, $L_{1,23}^{\\mathrm{FCC}} = -2$\n- $(\\mathrm{Mn},\\mathrm{Co})$: $L_{0,24}^{\\mathrm{FCC}} = 6000$, $L_{1,24}^{\\mathrm{FCC}} = -1.5$\n- $(\\mathrm{Mn},\\mathrm{Ni})$: $L_{0,25}^{\\mathrm{FCC}} = 6500$, $L_{1,25}^{\\mathrm{FCC}} = -2.2$\n- $(\\mathrm{Fe},\\mathrm{Co})$: $L_{0,34}^{\\mathrm{FCC}} = 5000$, $L_{1,34}^{\\mathrm{FCC}} = -1.8$\n- $(\\mathrm{Fe},\\mathrm{Ni})$: $L_{0,35}^{\\mathrm{FCC}} = 5500$, $L_{1,35}^{\\mathrm{FCC}} = -2.0$\n- $(\\mathrm{Co},\\mathrm{Ni})$: $L_{0,45}^{\\mathrm{FCC}} = 4000$, $L_{1,45}^{\\mathrm{FCC}} = -1.2$\n\nBCC interactions:\n- $(\\mathrm{Cr},\\mathrm{Mn})$: $L_{0,12}^{\\mathrm{BCC}} = 10000$, $L_{1,12}^{\\mathrm{BCC}} = -3.5$\n- $(\\mathrm{Cr},\\mathrm{Fe})$: $L_{0,13}^{\\mathrm{BCC}} = 14000$, $L_{1,13}^{\\mathrm{BCC}} = -4.5$\n- $(\\mathrm{Cr},\\mathrm{Co})$: $L_{0,14}^{\\mathrm{BCC}} = 11000$, $L_{1,14}^{\\mathrm{BCC}} = -2.2$\n- $(\\mathrm{Cr},\\mathrm{Ni})$: $L_{0,15}^{\\mathrm{BCC}} = 10000$, $L_{1,15}^{\\mathrm{BCC}} = -2.8$\n- $(\\mathrm{Mn},\\mathrm{Fe})$: $L_{0,23}^{\\mathrm{BCC}} = 8000$, $L_{1,23}^{\\mathrm{BCC}} = -2.2$\n- $(\\mathrm{Mn},\\mathrm{Co})$: $L_{0,24}^{\\mathrm{BCC}} = 7000$, $L_{1,24}^{\\mathrm{BCC}} = -1.6$\n- $(\\mathrm{Mn},\\mathrm{Ni})$: $L_{0,25}^{\\mathrm{BCC}} = 7500$, $L_{1,25}^{\\mathrm{BCC}} = -2.4$\n- $(\\mathrm{Fe},\\mathrm{Co})$: $L_{0,34}^{\\mathrm{BCC}} = 6000$, $L_{1,34}^{\\mathrm{BCC}} = -2.0$\n- $(\\mathrm{Fe},\\mathrm{Ni})$: $L_{0,35}^{\\mathrm{BCC}} = 6500$, $L_{1,35}^{\\mathrm{BCC}} = -2.1$\n- $(\\mathrm{Co},\\mathrm{Ni})$: $L_{0,45}^{\\mathrm{BCC}} = 5000$, $L_{1,45}^{\\mathrm{BCC}} = -1.4$\n\nSimplified regular solution constants (temperature independent), symmetric $W_{ij}^{\\mathrm{phase}}$ for $ij$:\n- FCC:\n  - $(\\mathrm{Cr},\\mathrm{Mn})$: $W_{12}^{\\mathrm{FCC}} = 5000$\n  - $(\\mathrm{Cr},\\mathrm{Fe})$: $W_{13}^{\\mathrm{FCC}} = 9000$\n  - $(\\mathrm{Cr},\\mathrm{Co})$: $W_{14}^{\\mathrm{FCC}} = 7000$\n  - $(\\mathrm{Cr},\\mathrm{Ni})$: $W_{15}^{\\mathrm{FCC}} = 6500$\n  - $(\\mathrm{Mn},\\mathrm{Fe})$: $W_{23}^{\\mathrm{FCC}} = 5000$\n  - $(\\mathrm{Mn},\\mathrm{Co})$: $W_{24}^{\\mathrm{FCC}} = 4500$\n  - $(\\mathrm{Mn},\\mathrm{Ni})$: $W_{25}^{\\mathrm{FCC}} = 5000$\n  - $(\\mathrm{Fe},\\mathrm{Co})$: $W_{34}^{\\mathrm{FCC}} = 4000$\n  - $(\\mathrm{Fe},\\mathrm{Ni})$: $W_{35}^{\\mathrm{FCC}} = 4500$\n  - $(\\mathrm{Co},\\mathrm{Ni})$: $W_{45}^{\\mathrm{FCC}} = 3500$\n- BCC:\n  - $(\\mathrm{Cr},\\mathrm{Mn})$: $W_{12}^{\\mathrm{BCC}} = 6000$\n  - $(\\mathrm{Cr},\\mathrm{Fe})$: $W_{13}^{\\mathrm{BCC}} = 10000$\n  - $(\\mathrm{Cr},\\mathrm{Co})$: $W_{14}^{\\mathrm{BCC}} = 8000$\n  - $(\\mathrm{Cr},\\mathrm{Ni})$: $W_{15}^{\\mathrm{BCC}} = 7500$\n  - $(\\mathrm{Mn},\\mathrm{Fe})$: $W_{23}^{\\mathrm{BCC}} = 5500$\n  - $(\\mathrm{Mn},\\mathrm{Co})$: $W_{24}^{\\mathrm{BCC}} = 5000$\n  - $(\\mathrm{Mn},\\mathrm{Ni})$: $W_{25}^{\\mathrm{BCC}} = 5500$\n  - $(\\mathrm{Fe},\\mathrm{Co})$: $W_{34}^{\\mathrm{BCC}} = 4500$\n  - $(\\mathrm{Fe},\\mathrm{Ni})$: $W_{35}^{\\mathrm{BCC}} = 5000$\n  - $(\\mathrm{Co},\\mathrm{Ni})$: $W_{45}^{\\mathrm{BCC}} = 4000$\n\nSensitivity assessment instruction: For a subset of test cases, scale the BCC CALPHAD interaction parameters by a multiplicative factor $s$ applied to the entire $L_{ij}^{\\mathrm{BCC}}(T)$, i.e., use $s\\cdot L_{ij}^{\\mathrm{BCC}}(T)$ when computing $g_{\\mathrm{BCC}}$ for the CALPHAD-style model. Do not scale the regular solution constants in this comparison. This scaling explores how interaction parameter uncertainty affects the computed driving force.\n\nTasks:\n1. Implement a function to compute $g_{\\mathrm{phase}}(x,T)$ per mole for the FCC and BCC phases using the CALPHAD-style parameters, including the ideal configurational entropy term, the reference energies $g_i^{0,\\mathrm{phase}}(T)$, and the symmetric pairwise interaction term weighted by $x_i x_j$.\n2. Implement a function to compute $g_{\\mathrm{phase}}^{\\mathrm{RS}}(x,T)$ per mole for the FCC and BCC phases using the simplified regular solution constants with the same ideal configurational entropy and the same reference energies $g_i^{0,\\mathrm{phase}}(T)$.\n3. For each test case, compute $\\Delta g_{\\mathrm{molar}}^{\\mathrm{CALPHAD}} = g_{\\mathrm{BCC}}(x,T) - g_{\\mathrm{FCC}}(x,T)$ using CALPHAD-style interactions (with scaling factor $s$ applied only to BCC CALPHAD interactions), and $\\Delta g_{\\mathrm{molar}}^{\\mathrm{RS}} = g_{\\mathrm{BCC}}^{\\mathrm{RS}}(x,T) - g_{\\mathrm{FCC}}^{\\mathrm{RS}}(x,T)$ using the regular solution constants. Report the comparison quantity $D = \\Delta g_{\\mathrm{molar}}^{\\mathrm{CALPHAD}} - \\Delta g_{\\mathrm{molar}}^{\\mathrm{RS}}$ in $\\mathrm{J/mol}$ for each test case.\n4. To ensure numerical stability near $x_i \\to 0$, you must treat the ideal entropy term using the limit $x_i \\ln x_i \\to 0$ as $x_i \\to 0$, and in your computation you should use a small positive floor for $x_i$ where needed to avoid evaluating $\\ln 0$.\n5. Express all outputs in $\\mathrm{J/mol}$ as floating-point numbers rounded to five decimal places.\n\nTest Suite:\n- Case $1$: $T = 1200$, $x = [0.2,0.2,0.2,0.2,0.2]$, scaling factor $s = 1.0$.\n- Case $2$: $T = 1200$, $x = [0.2,0.2,0.2,0.2,0.2]$, scaling factor $s = 1.15$.\n- Case $3$: $T = 900$, $x = [0.35,0.15,0.25,0.15,0.10]$, scaling factor $s = 1.0$.\n- Case $4$: $T = 900$, $x = [0.01,0.25,0.34,0.20,0.20]$, scaling factor $s = 1.0$.\n- Case $5$: $T = 600$, $x = [0.2,0.2,0.2,0.2,0.2]$, scaling factor $s = 1.0$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the comparison results $D$ for the five test cases as a comma-separated list of floating-point values rounded to five decimal places, enclosed in square brackets, for example $[d_1,d_2,d_3,d_4,d_5]$ where each $d_k$ is in $\\mathrm{J/mol}$.",
            "solution": "The problem is validated as scientifically sound, well-posed, and objective. It presents a clear computational task based on established principles of materials thermodynamics, specifically the CALPHAD (Computer Coupling of Phase Diagrams and Thermochemistry) methodology. All necessary data, models, and constants are provided, and there are no internal contradictions or ambiguities.\n\nThe objective is to compute the molar Gibbs free energy driving force, $\\Delta g_{\\mathrm{molar}}$, for the FCC to BCC phase transformation in a quinary alloy system $\\{\\mathrm{Cr},\\mathrm{Mn},\\mathrm{Fe},\\mathrm{Co},\\mathrm{Ni}\\}$. This is achieved using two different thermodynamic models: a CALPHAD-style model with temperature-dependent interactions and a simplified regular solution model with constant interactions. The final goal is to calculate the difference, $D$, between the driving forces predicted by these two models for a given set of test conditions.\n\nThe molar Gibbs free energy, $g_{\\phi}$, for a given phase $\\phi$ (where $\\phi$ is either $\\mathrm{FCC}$ or $\\mathrm{BCC}$), composition vector $x = (x_1, x_2, x_3, x_4, x_5)$, and temperature $T$ is given by the sum of three contributions:\n$$g_{\\phi}(x, T) = g_{\\mathrm{ref}}^{\\phi}(x, T) + g_{\\mathrm{ideal}}(x, T) + g_{\\mathrm{excess}}^{\\phi}(x, T)$$\n\nEach term is defined as follows:\n\n1.  **Reference Energy ($g_{\\mathrm{ref}}$)**: This term represents the Gibbs free energy of the unmixed components, weighted by their mole fractions. It is calculated as a linear combination of the reference energies of the pure components in the structure of the phase $\\phi$.\n    $$g_{\\mathrm{ref}}^{\\phi}(x, T) = \\sum_{i=1}^{5} x_i g_i^{0,\\phi}(T)$$\n    where $g_i^{0,\\phi}(T)$ is the molar Gibbs free energy of pure component $i$ in the phase $\\phi$ at temperature $T$. The problem provides a linear model for this temperature dependence:\n    $$g_i^{0,\\phi}(T) = a_i^{\\phi} + b_i^{\\phi}T$$\n    with specific coefficients $a_i^{\\phi}$ and $b_i^{\\phi}$ provided for each component and phase.\n\n2.  **Ideal Mixing Entropy Contribution ($g_{\\mathrm{ideal}}$)**: This term accounts for the increase in entropy from randomly mixing the components. It is independent of the phase structure.\n    $$g_{\\mathrm{ideal}}(x, T) = R T \\sum_{i=1}^{5} x_i \\ln(x_i)$$\n    where $R$ is the ideal gas constant, given as $8.314 \\, \\mathrm{J/(mol \\cdot K)}$, and the limit $x_i \\ln(x_i) \\to 0$ is applied for any component $i$ with $x_i \\to 0$.\n\n3.  **Excess Gibbs Free Energy ($g_{\\mathrm{excess}}$)**: This term accounts for the non-ideal interactions between different atomic species in the solution. The problem requires the use of two different models for this term.\n\n    a.  **CALPHAD-style Model**: The excess energy is described using temperature-dependent binary interaction parameters, $L_{ij}^{\\phi}(T)$, within a Muggianu framework for multicomponent solutions.\n        $$g_{\\mathrm{excess}}^{\\phi, \\mathrm{CALPHAD}}(x, T) = \\sum_{i=1}^{4} \\sum_{j=i+1}^{5} x_i x_j L_{ij}^{\\phi}(T)$$\n        The interaction parameters are linear functions of temperature:\n        $$L_{ij}^{\\phi}(T) = L_{0,ij}^{\\phi} + L_{1,ij}^{\\phi}T$$\n        The problem specifies a scaling factor $s$ to be applied to the BCC CALPHAD interaction parameters for sensitivity analysis: $s \\cdot L_{ij}^{\\mathrm{BCC}}(T)$.\n\n    b.  **Simplified Regular Solution (RS) Model**: The excess energy is described using temperature-independent binary interaction parameters, $W_{ij}^{\\phi}$.\n        $$g_{\\mathrm{excess}}^{\\phi, \\mathrm{RS}}(x) = \\sum_{i=1}^{4} \\sum_{j=i+1}^{5} x_i x_j W_{ij}^{\\phi}$$\n\nThe driving force for the $\\mathrm{FCC} \\to \\mathrm{BCC}$ transformation is the change in molar Gibbs free energy:\n$$\\Delta g_{\\mathrm{molar}} = g_{\\mathrm{BCC}}(x, T) - g_{\\mathrm{FCC}}(x, T)$$\n\nWe must compute this quantity for both models:\n$$\\Delta g_{\\mathrm{molar}}^{\\mathrm{CALPHAD}}(x, T, s) = g_{\\mathrm{BCC}}^{\\mathrm{CALPHAD}}(x, T, s) - g_{\\mathrm{FCC}}^{\\mathrm{CALPHAD}}(x, T)$$\n$$\\Delta g_{\\mathrm{molar}}^{\\mathrm{RS}}(x, T) = g_{\\mathrm{BCC}}^{\\mathrm{RS}}(x, T) - g_{\\mathrm{FCC}}^{\\mathrm{RS}}(x, T)$$\n\nNote that in the expressions for $\\Delta g_{\\mathrm{molar}}$, the ideal mixing term $g_{\\mathrm{ideal}}(x, T)$ is identical for both phases and therefore cancels out. However, the reference energy contributions do not cancel as $g_i^{0,\\mathrm{BCC}} \\neq g_i^{0,\\mathrm{FCC}}$.\n\nThe final comparison quantity to be calculated is the difference between these two predicted driving forces:\n$$D = \\Delta g_{\\mathrm{molar}}^{\\mathrm{CALPHAD}} - \\Delta g_{\\mathrm{molar}}^{\\mathrm{RS}}$$\n\nThe algorithmic approach to solve the problem is as follows:\n1.  Store all fundamental constants ($R$) and model parameters ($a_i^{\\phi}, b_i^{\\phi}, L_{0,ij}^{\\phi}, L_{1,ij}^{\\phi}, W_{ij}^{\\phi}$) in appropriate data structures. The components $\\{\\mathrm{Cr},\\mathrm{Mn},\\mathrm{Fe},\\mathrm{Co},\\mathrm{Ni}\\}$ are mapped to indices $0$ through $4$.\n2.  Implement a function `compute_g_calphad(phase, x, T, s=1.0)` that calculates the molar Gibbs free energy according to the CALPHAD-style model. This function will sum the reference, ideal, and CALPHAD-style excess energy terms. The scaling factor $s$ will be applied conditionally for the $\\mathrm{BCC}$ phase.\n3.  Implement a function `compute_g_rs(phase, x, T)` that calculates the molar Gibbs free energy according to the Regular Solution model. This function will sum the reference, ideal, and RS excess energy terms.\n4.  For each test case provided:\n    a. Extract the temperature $T$, composition vector $x$, and scaling factor $s$.\n    b. Calculate $g_{\\mathrm{BCC}}^{\\mathrm{CALPHAD}}$ and $g_{\\mathrm{FCC}}^{\\mathrm{CALPHAD}}$ using `compute_g_calphad`.\n    c. Compute $\\Delta g_{\\mathrm{molar}}^{\\mathrm{CALPHAD}} = g_{\\mathrm{BCC}}^{\\mathrm{CALPHAD}} - g_{\\mathrm{FCC}}^{\\mathrm{CALPHAD}}$.\n    d. Calculate $g_{\\mathrm{BCC}}^{\\mathrm{RS}}$ and $g_{\\mathrm{FCC}}^{\\mathrm{RS}}$ using `compute_g_rs`.\n    e. Compute $\\Delta g_{\\mathrm{molar}}^{\\mathrm{RS}} = g_{\\mathrm{BCC}}^{\\mathrm{RS}} - g_{\\mathrm{FCC}}^{\\mathrm{RS}}$.\n    f. Calculate the final difference $D = \\Delta g_{\\mathrm{molar}}^{\\mathrm{CALPHAD}} - \\Delta g_{\\mathrm{molar}}^{\\mathrm{RS}}$.\n5.  Collect the results for all test cases, format them to five decimal places, and present them in the specified comma-separated list format.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the difference in predicted thermodynamic driving forces\n    between a CALPHAD-style model and a Regular Solution model for an\n    FCC-to-BCC transformation in a quinary high-entropy alloy.\n    \"\"\"\n\n    # Gas constant in J/(mol K)\n    R = 8.314\n\n    # Component mapping: 0:Cr, 1:Mn, 2:Fe, 3:Co, 4:Ni\n    \n    # Reference molar energies: g_i^0(T) = a_i + b_i*T\n    g_ref_coeffs = {\n        'FCC': {\n            'a': np.array([-35000, -30000, -32000, -33000, -34000]),\n            'b': np.array([5, 6, 5.5, 5.2, 5.1])\n        },\n        'BCC': {\n            'a': np.array([-34000, -31000, -33000, -32000, -33500]),\n            'b': np.array([5.1, 5.8, 5.3, 5.0, 5.0])\n        }\n    }\n\n    # CALPHAD-style interaction parameters: L_ij(T) = L0_ij + L1_ij*T\n    L_calphad_coeffs = {\n        'FCC': {\n            (0, 1): (8000, -3.0), (0, 2): (12000, -4.0), (0, 3): (10000, -2.0),\n            (0, 4): (9000, -2.5), (1, 2): (7000, -2.0), (1, 3): (6000, -1.5),\n            (1, 4): (6500, -2.2), (2, 3): (5000, -1.8), (2, 4): (5500, -2.0),\n            (3, 4): (4000, -1.2)\n        },\n        'BCC': {\n            (0, 1): (10000, -3.5), (0, 2): (14000, -4.5), (0, 3): (11000, -2.2),\n            (0, 4): (10000, -2.8), (1, 2): (8000, -2.2), (1, 3): (7000, -1.6),\n            (1, 4): (7500, -2.4), (2, 3): (6000, -2.0), (2, 4): (6500, -2.1),\n            (3, 4): (5000, -1.4)\n        }\n    }\n\n    # Regular Solution interaction parameters: W_ij\n    W_rs_coeffs = {\n        'FCC': {\n            (0, 1): 5000, (0, 2): 9000, (0, 3): 7000, (0, 4): 6500,\n            (1, 2): 5000, (1, 3): 4500, (1, 4): 5000, (2, 3): 4000,\n            (2, 4): 4500, (3, 4): 3500\n        },\n        'BCC': {\n            (0, 1): 6000, (0, 2): 10000, (0, 3): 8000, (0, 4): 7500,\n            (1, 2): 5500, (1, 3): 5000, (1, 4): 5500, (2, 3): 4500,\n            (2, 4): 5000, (3, 4): 4000\n        }\n    }\n\n    def compute_g_calphad(phase, x, T, s=1.0):\n        # x is a numpy array\n        \n        # 1. Reference energy\n        g_ref_vec = g_ref_coeffs[phase]['a'] + g_ref_coeffs[phase]['b'] * T\n        g_ref = np.dot(x, g_ref_vec)\n        \n        # 2. Ideal mixing entropy contribution\n        x_nonzero = x[x > 0]\n        g_ideal = R * T * np.sum(x_nonzero * np.log(x_nonzero))\n        \n        # 3. Excess Gibbs free energy\n        g_excess = 0.0\n        for i in range(5):\n            for j in range(i + 1, 5):\n                L0, L1 = L_calphad_coeffs[phase][(i, j)]\n                L_ij = L0 + L1 * T\n                if phase == 'BCC':\n                    L_ij *= s\n                g_excess += x[i] * x[j] * L_ij\n                \n        return g_ref + g_ideal + g_excess\n\n    def compute_g_rs(phase, x, T):\n        # x is a numpy array\n        \n        # 1. Reference energy\n        g_ref_vec = g_ref_coeffs[phase]['a'] + g_ref_coeffs[phase]['b'] * T\n        g_ref = np.dot(x, g_ref_vec)\n        \n        # 2. Ideal mixing entropy contribution\n        x_nonzero = x[x > 0]\n        g_ideal = R * T * np.sum(x_nonzero * np.log(x_nonzero))\n        \n        # 3. Excess Gibbs free energy\n        g_excess = 0.0\n        for i in range(5):\n            for j in range(i + 1, 5):\n                W_ij = W_rs_coeffs[phase][(i, j)]\n                g_excess += x[i] * x[j] * W_ij\n                \n        return g_ref + g_ideal + g_excess\n\n    test_cases = [\n        {'T': 1200, 'x': [0.2, 0.2, 0.2, 0.2, 0.2], 's': 1.0},\n        {'T': 1200, 'x': [0.2, 0.2, 0.2, 0.2, 0.2], 's': 1.15},\n        {'T': 900, 'x': [0.35, 0.15, 0.25, 0.15, 0.10], 's': 1.0},\n        {'T': 900, 'x': [0.01, 0.25, 0.34, 0.20, 0.20], 's': 1.0},\n        {'T': 600, 'x': [0.2, 0.2, 0.2, 0.2, 0.2], 's': 1.0}\n    ]\n\n    results = []\n    for case in test_cases:\n        T = case['T']\n        x = np.array(case['x'])\n        s = case['s']\n\n        # CALPHAD model calculation\n        g_fcc_calphad = compute_g_calphad('FCC', x, T)\n        g_bcc_calphad = compute_g_calphad('BCC', x, T, s)\n        delta_g_calphad = g_bcc_calphad - g_fcc_calphad\n        \n        # Regular Solution model calculation\n        g_fcc_rs = compute_g_rs('FCC', x, T)\n        g_bcc_rs = compute_g_rs('BCC', x, T)\n        delta_g_rs = g_bcc_rs - g_fcc_rs\n        \n        # Comparison quantity D\n        D = delta_g_calphad - delta_g_rs\n        results.append(f\"{D:.5f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "With the bulk thermodynamic driving force $\\Delta g$ in hand, we can turn to Classical Nucleation Theory (CNT) to understand the kinetic barrier to forming a new phase. The formation of a stable nucleus requires overcoming an energy penalty associated with creating a new interface, a quantity captured by the interfacial energy $\\gamma$. This practice  provides a foundational exercise in applying CNT to calculate the critical nucleus radius $r^*$ and the nucleation energy barrier $\\Delta G^*$, and critically explores how uncertainties in interfacial energy can dramatically affect predictions of nucleation behavior.",
            "id": "3733457",
            "problem": "A face-centered cubic high-entropy alloy matrix is supersaturated at a fixed temperature with respect to an ordered $L1_2$ precipitate phase. Assume homogeneous nucleation of a coherent, spherical $L1_2$ nucleus and neglect elastic strain energy, anisotropy of interfacial energy, and solute segregation, so that the interfacial contribution to the total free-energy change scales with the nucleus surface area with coefficient $\\,\\gamma\\,$, and the bulk free-energy change scales with the nucleus volume with magnitude $\\,\\Delta g\\,$, where $\\,\\Delta g0\\,$ denotes the absolute volumetric free-energy decrease upon transformation. Using these assumptions and starting from the decomposition of the nucleation free-energy into surface and volume contributions, derive the expressions for the critical radius $\\,r^{\\ast}\\,$ and the nucleation barrier $\\,\\Delta G^{\\ast}\\,$ for a spherical nucleus. Then evaluate $\\,r^{\\ast}\\,$ and $\\,\\Delta G^{\\ast}\\,$ numerically for $\\,\\gamma=0.2\\,\\mathrm{J/m^{2}}\\,$ and $\\,\\Delta g=2\\times 10^{8}\\,\\mathrm{J/m^{3}}\\,$. Finally, quantify and interpret the sensitivity of $\\,r^{\\ast}\\,$ and $\\,\\Delta G^{\\ast}\\,$ to a $\\,20\\%\\,$ uncertainty in $\\,\\gamma\\,$.\n\nRound your numerical answers to three significant figures. Express $\\,r^{\\ast}\\,$ in nanometers and $\\,\\Delta G^{\\ast}\\,$ in Joules.",
            "solution": "The problem statement is first subjected to validation.\n\n### Step 1: Extract Givens\n-   System: A face-centered cubic high-entropy alloy matrix supersaturated with respect to an ordered L1$_2$ precipitate phase.\n-   Process: Homogeneous nucleation of a coherent, spherical L1$_2$ nucleus.\n-   Temperature: Fixed.\n-   Assumptions:\n    -   Elastic strain energy is neglected.\n    -   Anisotropy of interfacial energy is neglected.\n    -   Solute segregation is neglected.\n-   Free-energy model:\n    -   Interfacial contribution scales with nucleus surface area with coefficient $\\gamma$.\n    -   Bulk free-energy change scales with nucleus volume with magnitude $\\Delta g$.\n    -   $\\Delta g  0$ denotes the absolute volumetric free-energy decrease upon transformation.\n-   Numerical values:\n    -   $\\gamma = 0.2 \\, \\mathrm{J/m^2}$.\n    -   $\\Delta g = 2 \\times 10^8 \\, \\mathrm{J/m^3}$.\n-   Tasks:\n    1.  Derive the expressions for the critical radius $r^{\\ast}$ and the nucleation barrier $\\Delta G^{\\ast}$.\n    2.  Evaluate $r^{\\ast}$ and $\\Delta G^{\\ast}$ numerically.\n    3.  Quantify and interpret the sensitivity of $r^{\\ast}$ and $\\Delta G^{\\ast}$ to a $20\\%$ uncertainty in $\\gamma$.\n-   Output requirements:\n    -   Round numerical answers to three significant figures.\n    -   Express $r^{\\ast}$ in nanometers and $\\Delta G^{\\ast}$ in Joules.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed based on the predefined criteria.\n\n-   **Scientifically Grounded**: The problem is rooted in Classical Nucleation Theory (CNT), a cornerstone of materials science for describing phase transformations. The decomposition of the total free-energy change into surface and volume terms is the fundamental premise of CNT. The given numerical values for interfacial energy ($\\gamma$) and bulk free-energy change ($\\Delta g$) are physically realistic for solid-state transformations in metallic alloys.\n-   **Well-Posed**: The problem is well-posed. The assumptions (spherical nucleus, isotropic $\\gamma$, no strain) simplify the system to a canonical CNT problem, for which a unique, stable solution for the critical nucleus size and energy barrier exists. The tasks are clear and lead to a definite result.\n-   **Objective**: The language is precise, quantitative, and free of any subjective or opinion-based statements. All terms are standard in the field of physical metallurgy and materials thermodynamics.\n-   **Self-Contained and Consistent**: The problem provides all necessary information and assumptions required for the derivation and numerical calculation. There are no internal contradictions.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a standard, well-posed problem in materials thermodynamics. I will proceed with the solution.\n\nThe total free-energy change, $\\Delta G$, associated with the formation of a spherical nucleus of radius $r$ is the sum of the energy required to create the new interface (a positive contribution) and the energy released by the transformation of the bulk material (a negative contribution).\n\nThe surface energy term, $\\Delta G_S$, is the product of the surface area of the sphere, $A = 4\\pi r^2$, and the specific interfacial energy, $\\gamma$.\n$$ \\Delta G_S = 4\\pi r^2 \\gamma $$\nThe bulk free-energy term, $\\Delta G_V$, is the product of the volume of the sphere, $V = \\frac{4}{3}\\pi r^3$, and the negative of the magnitude of the volumetric free-energy change, $-\\Delta g$.\n$$ \\Delta G_V = -\\frac{4}{3}\\pi r^3 \\Delta g $$\nThe total free-energy change as a function of the radius $r$ is therefore:\n$$ \\Delta G(r) = \\Delta G_S + \\Delta G_V = 4\\pi r^2 \\gamma - \\frac{4}{3}\\pi r^3 \\Delta g $$\nThe critical nucleus radius, $r^{\\ast}$, corresponds to the maximum of the function $\\Delta G(r)$. This maximum is found by setting the first derivative of $\\Delta G(r)$ with respect to $r$ equal to zero.\n$$ \\frac{d(\\Delta G(r))}{dr} = \\frac{d}{dr} \\left( 4\\pi r^2 \\gamma - \\frac{4}{3}\\pi r^3 \\Delta g \\right) = 8\\pi r \\gamma - 4\\pi r^2 \\Delta g $$\nSetting the derivative to zero at $r = r^{\\ast}$:\n$$ 8\\pi r^{\\ast} \\gamma - 4\\pi (r^{\\ast})^2 \\Delta g = 0 $$\nSince $r^{\\ast}  0$, we can divide by $4\\pi r^{\\ast}$:\n$$ 2\\gamma - r^{\\ast} \\Delta g = 0 $$\nSolving for $r^{\\ast}$ gives the expression for the critical radius:\n$$ r^{\\ast} = \\frac{2\\gamma}{\\Delta g} $$\nThe nucleation barrier, $\\Delta G^{\\ast}$, is the value of $\\Delta G(r)$ evaluated at $r = r^{\\ast}$.\n$$ \\Delta G^{\\ast} = \\Delta G(r^{\\ast}) = 4\\pi (r^{\\ast})^2 \\gamma - \\frac{4}{3}\\pi (r^{\\ast})^3 \\Delta g $$\nSubstituting the expression for $r^{\\ast}$:\n$$ \\Delta G^{\\ast} = 4\\pi \\left(\\frac{2\\gamma}{\\Delta g}\\right)^2 \\gamma - \\frac{4}{3}\\pi \\left(\\frac{2\\gamma}{\\Delta g}\\right)^3 \\Delta g $$\n$$ \\Delta G^{\\ast} = 4\\pi \\left(\\frac{4\\gamma^2}{(\\Delta g)^2}\\right) \\gamma - \\frac{4}{3}\\pi \\left(\\frac{8\\gamma^3}{(\\Delta g)^3}\\right) \\Delta g $$\n$$ \\Delta G^{\\ast} = \\frac{16\\pi\\gamma^3}{(\\Delta g)^2} - \\frac{32\\pi\\gamma^3}{3(\\Delta g)^2} $$\n$$ \\Delta G^{\\ast} = \\left(1 - \\frac{2}{3}\\right) \\frac{16\\pi\\gamma^3}{(\\Delta g)^2} = \\frac{1}{3} \\frac{16\\pi\\gamma^3}{(\\Delta g)^2} $$\nThus, the expression for the nucleation barrier is:\n$$ \\Delta G^{\\ast} = \\frac{16\\pi\\gamma^3}{3(\\Delta g)^2} $$\nNow, we evaluate $r^{\\ast}$ and $\\Delta G^{\\ast}$ numerically using the given values: $\\gamma = 0.2 \\, \\mathrm{J/m^2}$ and $\\Delta g = 2 \\times 10^8 \\, \\mathrm{J/m^3}$.\n\nFor the critical radius $r^{\\ast}$:\n$$ r^{\\ast} = \\frac{2 \\times (0.2 \\, \\mathrm{J/m^2})}{2 \\times 10^8 \\, \\mathrm{J/m^3}} = \\frac{0.4}{2 \\times 10^8} \\, \\mathrm{m} = 2 \\times 10^{-9} \\, \\mathrm{m} $$\nConverting to nanometers ($1 \\, \\mathrm{nm} = 10^{-9} \\, \\mathrm{m}$), and rounding to three significant figures:\n$$ r^{\\ast} = 2.00 \\, \\mathrm{nm} $$\nFor the nucleation barrier $\\Delta G^{\\ast}$:\n$$ \\Delta G^{\\ast} = \\frac{16\\pi(0.2 \\, \\mathrm{J/m^2})^3}{3(2 \\times 10^8 \\, \\mathrm{J/m^3})^2} = \\frac{16\\pi(0.008)}{3(4 \\times 10^{16})} \\, \\mathrm{J} $$\n$$ \\Delta G^{\\ast} = \\frac{0.128\\pi}{12 \\times 10^{16}} \\, \\mathrm{J} = \\frac{32\\pi}{3} \\times 10^{-19} \\, \\mathrm{J} \\approx 3.35103 \\times 10^{-19} \\, \\mathrm{J} $$\nRounding to three significant figures:\n$$ \\Delta G^{\\ast} = 3.35 \\times 10^{-19} \\, \\mathrm{J} $$\nFinally, we analyze the sensitivity of $r^{\\ast}$ and $\\Delta G^{\\ast}$ to a $20\\%$ uncertainty in $\\gamma$.\nLet the fractional change in $\\gamma$ be $\\epsilon = \\frac{\\delta \\gamma}{\\gamma}$. Here, the uncertainty is $\\pm 20\\%$, so $\\epsilon = \\pm 0.2$.\n\nFor the critical radius $r^{\\ast}$:\n$$ r^{\\ast} \\propto \\gamma^1 $$\nThe relationship is linear. The relative change in $r^{\\ast}$ is equal to the relative change in $\\gamma$.\n$$ \\frac{\\delta r^{\\ast}}{r^{\\ast}} = \\frac{\\delta \\gamma}{\\gamma} $$\nTherefore, a $\\pm 20\\%$ uncertainty in $\\gamma$ results in a $\\pm 20\\%$ uncertainty in $r^{\\ast}$. This means $r^{\\ast}$ would vary from $2.00 \\times (1 - 0.20) = 1.60 \\, \\mathrm{nm}$ to $2.00 \\times (1 + 0.20) = 2.40 \\, \\mathrm{nm}$.\n\nFor the nucleation barrier $\\Delta G^{\\ast}$:\n$$ \\Delta G^{\\ast} \\propto \\gamma^3 $$\nThe relationship is cubic. The relative change in $\\Delta G^{\\ast}$ relates to the relative change in $\\gamma$ as follows. Let $\\gamma_{new} = \\gamma(1+\\epsilon)$. Then:\n$$ \\Delta G^{\\ast}_{new} = C (\\gamma_{new})^3 = C (\\gamma(1+\\epsilon))^3 = (C \\gamma^3)(1+\\epsilon)^3 = \\Delta G^{\\ast}_{old}(1+\\epsilon)^3 $$\nThe fractional change in $\\Delta G^{\\ast}$ is $\\frac{\\Delta G^{\\ast}_{new} - \\Delta G^{\\ast}_{old}}{\\Delta G^{\\ast}_{old}} = (1+\\epsilon)^3 - 1$.\nFor a $+20\\%$ uncertainty in $\\gamma$ ($\\epsilon = +0.2$):\n$$ \\text{Change} = (1 + 0.2)^3 - 1 = (1.2)^3 - 1 = 1.728 - 1 = 0.728 $$\nThis corresponds to a $+72.8\\%$ increase in $\\Delta G^{\\ast}$.\nFor a $-20\\%$ uncertainty in $\\gamma$ ($\\epsilon = -0.2$):\n$$ \\text{Change} = (1 - 0.2)^3 - 1 = (0.8)^3 - 1 = 0.512 - 1 = -0.488 $$\nThis corresponds to a $-48.8\\%$ decrease in $\\Delta G^{\\ast}$.\n\n**Interpretation**: The sensitivity analysis reveals that the nucleation barrier $\\Delta G^{\\ast}$ is far more sensitive to variations in the interfacial energy $\\gamma$ than the critical radius $r^{\\ast}$. While $r^{\\ast}$ scales linearly with $\\gamma$ (a sensitivity of $1$), $\\Delta G^{\\ast}$ scales with the third power of $\\gamma$ (a sensitivity of $3$). A moderate $20\\%$ uncertainty in $\\gamma$ leads to a large, asymmetric uncertainty range for $\\Delta G^{\\ast}$ spanning from $-48.8\\%$ to $+72.8\\%$. Since the nucleation rate, $J$, is exponentially dependent on the nucleation barrier ($J \\propto \\exp(-\\Delta G^{\\ast}/k_B T)$), this high sensitivity implies that even small errors in determining $\\gamma$ can lead to errors of many orders of magnitude in predicting nucleation kinetics. This underscores the critical importance of obtaining accurate interfacial energy data for modeling phase transformations.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.00  3.35 \\times 10^{-19} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The ultimate goal of nucleation theory is to predict the macroscopic rate of phase transformations. The Johnson-Mehl-Avrami-Kolmogorov (JMAK) model serves as a powerful bridge between the microscopic events of nucleation and growth and the experimentally measured fraction of transformed material over time. In this final practice , you will analyze isothermal transformation data to extract the Avrami parameters, which in turn allow you to determine the underlying kinetic mechanism and estimate the effective nucleation rate $J$ and growth coefficient $G$.",
            "id": "3733400",
            "problem": "You are asked to write a complete, runnable program that uses isothermal transformation data to estimate the nucleation rate per unit volume $J$ and the growth coefficient $G$ by fitting the Johnson-Mehl-Avrami-Kolmogorov (JMAK) parameters $K$ and $n$, and then assesses whether the inferred kinetics correspond to diffusion-controlled growth or interface-controlled growth in three-dimensional geometry. The program must implement the following scientifically and logically sound modeling assumptions and steps:\n\n- Base assumptions and well-tested facts:\n  - Random nucleation and isotropic three-dimensional growth with random impingement can be modeled by the classical Johnson-Mehl-Avrami-Kolmogorov (JMAK) relation $X(t) = 1 - \\exp\\left(-K t^n\\right)$ for the isothermal fraction transformed $X(t)$ at time $t$, where $K$ has units $\\mathrm{s}^{-n}$ and $n$ is the Avrami exponent.\n  - The nucleation rate $J$ has units $\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$, and the growth law of the radius $R(t,\\tau)$ of a grain nucleated at time $\\tau$ may be either interface-controlled, $R(t,\\tau) = v\\,(t-\\tau)$ with interface velocity $v$ (units $\\mathrm{m}\\,\\mathrm{s}^{-1}$), or diffusion-controlled, $R(t,\\tau) = k\\,(t-\\tau)^{1/2}$ with diffusion growth coefficient $k$ (units $\\mathrm{m}\\,\\mathrm{s}^{-1/2}$).\n  - For three-dimensional spherical growth and continuous (time-independent) nucleation rate, the extended transformed volume fraction is obtained by integrating the contribution of all nuclei over time with the respective growth law. Combining this with random impingement leads to the JMAK form above, with specific relations between $K$, $J$, and the growth coefficient that depend on the mechanism.\n  - An independent early-time measurement of the number density of stable nuclei $N(t_n)$ at a short time $t_n$ can be used to estimate $J \\approx N(t_n)/t_n$, assuming $X(t_n)$ is still small enough that impingement is negligible.\n\nYour program must:\n\n1. For each dataset, fit $n$ and $K$ from the provided isothermal transformation data $(t_i, X_i)$ by appropriate linearization consistent with the JMAK model. You must design a robust fitting procedure that discards data points where $X_i \\le 0$ or $X_i \\ge 1$ to avoid singularities in the logarithmic transform. The fit must be based on the linearization of the JMAK model in terms of $\\ln(-\\ln(1-X))$ versus $\\ln t$, and must compute both the slope (which estimates $n$) and the intercept (which estimates $\\ln K$).\n2. Use the independent early-time nucleation count data $(t_n, N(t_n))$ to estimate $J$ in $\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ via $J \\approx N(t_n)/t_n$.\n3. Determine whether the kinetics are interface-controlled or diffusion-controlled by comparing the fitted Avrami exponent $n$ to the theoretically expected values for continuous nucleation in three-dimensional growth. To perform this classification, define a tolerance and choose the mechanism whose theoretical exponent is closest to the fitted $n$. You must report a control flag of $0$ for interface-controlled and $1$ for diffusion-controlled, and also report the corresponding growth law exponent $m$ where $R \\sim (t-\\tau)^m$, with $m=1$ for interface-controlled and $m=1/2$ for diffusion-controlled.\n4. Given the classification, compute the appropriate growth coefficient $G$ in the correct physical units:\n   - If interface-controlled (three-dimensional, continuous nucleation), compute the interface velocity $v$ in $\\mathrm{m}\\,\\mathrm{s}^{-1}$ from the fitted $K$ and estimated $J$.\n   - If diffusion-controlled (three-dimensional, continuous nucleation), compute the diffusion growth coefficient $k$ in $\\mathrm{m}\\,\\mathrm{s}^{-1/2}$ from the fitted $K$ and estimated $J$.\n   Your derivation must be based on first principles by integrating the extended transformed volume and relating the resulting $K$ to $J$ and the corresponding growth coefficient for three-dimensional isotropic growth.\n\nPhysical units and reporting requirements:\n\n- Report $J$ in $\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n- Report $G$ as $v$ in $\\mathrm{m}\\,\\mathrm{s}^{-1}$ if interface-controlled, or $k$ in $\\mathrm{m}\\,\\mathrm{s}^{-1/2}$ if diffusion-controlled. The program must also report the growth law exponent $m$ (dimensionless) as either $1.0$ or $0.5$ consistently with the classification.\n- Express $J$ and $G$ each rounded to three significant figures. Express $m$ with one decimal place. The control flag must be an integer $0$ or $1$ as specified.\n- Angles do not appear; therefore no angle unit is required.\n\nTest suite:\n\nUse the following three datasets that emulate experimental measurements for high-entropy alloys under isothermal conditions. Each dataset consists of $(t_i, X_i)$ pairs and an early-time nucleation count $(t_n, N(t_n))$.\n\n- Dataset A (expected to be interface-controlled, continuous nucleation, three-dimensional growth):\n  - Times $t$ in seconds: $[5, 10, 15, 20, 25, 30]$.\n  - Measured fractions $X(t)$ (dimensionless): $[0.00262, 0.0410, 0.191, 0.488, 0.806, 0.966]$.\n  - Early-time nucleation count: $t_n = 3\\,\\mathrm{s}$, $N(t_n) = 1.50 \\times 10^{18}\\,\\mathrm{m}^{-3}$.\n- Dataset B (expected to be diffusion-controlled, continuous nucleation, three-dimensional growth):\n  - Times $t$ in seconds: $[10, 20, 30, 40, 50, 60, 80, 100]$.\n  - Measured fractions $X(t)$ (dimensionless): $[0.0132, 0.0721, 0.186, 0.345, 0.522, 0.689, 0.909, 0.985]$.\n  - Early-time nucleation count: $t_n = 20\\,\\mathrm{s}$, $N(t_n) = 4.00 \\times 10^{18}\\,\\mathrm{m}^{-3}$.\n- Dataset C (edge case with an initial zero fraction to test robustness of the fit and data filtering):\n  - Times $t$ in seconds: $[2, 4, 6, 8, 10, 12]$.\n  - Measured fractions $X(t)$ (dimensionless): $[0.0, 0.00102, 0.00518, 0.0163, 0.0392, 0.0796]$.\n  - Early-time nucleation count: $t_n = 2\\,\\mathrm{s}$, $N(t_n) = 1.60 \\times 10^{18}\\,\\mathrm{m}^{-3}$.\n\nFinal output format:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each dataset, output the following four values in order: $J$ (rounded to three significant figures), $G$ (rounded to three significant figures), $m$ (one decimal place), and the control flag (integer $0$ for interface-controlled or $1$ for diffusion-controlled). Concatenate the results for all datasets in order A, B, C into a single flat list. For example, the output must have the form\n$[J_A,G_A,m_A,flag_A,J_B,G_B,m_B,flag_B,J_C,G_C,m_C,flag_C]$,\nwith no additional text.",
            "solution": "The scientific and algorithmic solution proceeds from first principles of classical nucleation and growth theory applied to high-entropy alloys under isothermal conditions. We begin from core definitions of nucleation rate, growth laws, and random impingement, and derive the Johnson-Mehl-Avrami-Kolmogorov (JMAK) parameters to connect the measured fraction transformed to the underlying nucleation and growth coefficients.\n\n1. Modeling assumptions and definitions:\n   - Let $J$ be the steady nucleation rate per unit volume with units $\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n   - For interface-controlled growth, the radius $R(t,\\tau)$ of a grain nucleated at time $\\tau$ and observed at time $t$ is $R(t,\\tau) = v\\,(t-\\tau)$, where $v$ is the constant interface velocity with units $\\mathrm{m}\\,\\mathrm{s}^{-1}$, and $t\\tau$.\n   - For diffusion-controlled growth, the radius is $R(t,\\tau) = k\\,(t-\\tau)^{1/2}$, where $k$ is a growth coefficient related to diffusion with units $\\mathrm{m}\\,\\mathrm{s}^{-1/2}$.\n   - In three dimensions, the volume of a single spherical grain nucleated at time $\\tau$ and observed at time $t$ is $V(t,\\tau) = \\frac{4}{3}\\pi R(t,\\tau)^3$.\n   - The extended transformed volume fraction $\\tilde{X}(t)$ assuming no impingement is given by the time integral over all nucleation events:\n     $$\n     \\tilde{X}(t) = \\int_0^t J \\, V(t,\\tau)\\, d\\tau.\n     $$\n   - Under random impingement, the actual transformed fraction $X(t)$ is connected to the extended fraction by a Poisson process:\n     $$\n     X(t) = 1 - \\exp\\left(-\\tilde{X}(t)\\right).\n     $$\n\n2. Derivation of $K$ and $n$ from the growth law and nucleation rate:\n   - Interface-controlled growth:\n     - Using $R(t,\\tau) = v\\,(t-\\tau)$, the volume is $V(t,\\tau) = \\frac{4}{3}\\pi v^3 (t-\\tau)^3$.\n     - Integrate the extended fraction:\n       $$\n       \\tilde{X}(t) = \\int_0^t J \\cdot \\frac{4}{3}\\pi v^3 (t-\\tau)^3 \\, d\\tau\n       = J \\cdot \\frac{4}{3}\\pi v^3 \\cdot \\int_0^t (t-\\tau)^3\\, d\\tau\n       = J \\cdot \\frac{4}{3}\\pi v^3 \\cdot \\frac{t^4}{4}\n       = \\frac{\\pi}{3} J v^3 \\, t^4.\n       $$\n     - Therefore,\n       $$\n       X(t) = 1 - \\exp\\left( - \\left( \\frac{\\pi}{3} J v^3 \\right) t^4 \\right),\n       $$\n       which is of JMAK form $X(t) = 1 - \\exp(-K t^n)$ with $n=4$ and $K = \\frac{\\pi}{3} J v^3$.\n   - Diffusion-controlled growth:\n     - Using $R(t,\\tau) = k\\,(t-\\tau)^{1/2}$, the volume is $V(t,\\tau) = \\frac{4}{3}\\pi k^3 (t-\\tau)^{3/2}$.\n     - Integrate the extended fraction:\n       $$\n       \\tilde{X}(t) = \\int_0^t J \\cdot \\frac{4}{3}\\pi k^3 (t-\\tau)^{3/2} \\, d\\tau\n       = J \\cdot \\frac{4}{3}\\pi k^3 \\cdot \\int_0^t (t-\\tau)^{3/2}\\, d\\tau\n       = J \\cdot \\frac{4}{3}\\pi k^3 \\cdot \\frac{2}{5} t^{5/2}\n       = \\frac{8\\pi}{15} J k^3 \\, t^{5/2}.\n       $$\n     - Therefore,\n       $$\n       X(t) = 1 - \\exp\\left( - \\left( \\frac{8\\pi}{15} J k^3 \\right) t^{5/2} \\right),\n       $$\n       which is of JMAK form $X(t) = 1 - \\exp(-K t^n)$ with $n=5/2$ and $K = \\frac{8\\pi}{15} J k^3$.\n   - These relations show that for three-dimensional isotropic growth with continuous nucleation, the Avrami exponent is $n=4$ for interface-controlled growth and $n=5/2$ for diffusion-controlled growth, and $K$ is directly proportional to $J$ times the cube of the appropriate growth coefficient.\n\n3. Estimation strategy from data:\n   - Fit $n$ and $K$:\n     - Given $X(t) = 1 - \\exp(-K t^n)$, rearrange:\n       $$\n       -\\ln(1 - X(t)) = K t^n \\quad \\Rightarrow \\quad\n       \\ln\\left( -\\ln(1 - X(t)) \\right) = \\ln K + n \\ln t.\n       $$\n     - Perform linear regression of $y_i = \\ln\\left( -\\ln(1 - X_i) \\right)$ versus $x_i = \\ln t_i$ to estimate $n$ (slope) and $\\ln K$ (intercept). Then $K = \\exp(\\text{intercept})$.\n     - Robustness: exclude points where $X_i \\le 0$ or $X_i \\ge 1$ because $\\ln(1-X)$ is undefined or divergent there.\n   - Estimate $J$:\n     - Use the early-time nucleation count measurement $(t_n, N(t_n))$ and the approximation $J \\approx N(t_n)/t_n$ (valid when $X(t_n)$ is small and impingement is negligible).\n   - Classify mechanism and compute growth coefficient:\n     - Compute the distance of fitted $n$ to the theoretical interface-controlled exponent $4$ and diffusion-controlled exponent $5/2$ and select the mechanism with the smaller distance. Assign the growth law exponent $m$ as $1$ for interface-controlled or $1/2$ for diffusion-controlled.\n     - If interface-controlled is selected, compute $v$ by inverting $K = \\frac{\\pi}{3} J v^3$:\n       $$\n       v = \\left( \\frac{3 K}{\\pi J} \\right)^{1/3}.\n       $$\n     - If diffusion-controlled is selected, compute $k$ by inverting $K = \\frac{8\\pi}{15} J k^3$:\n       $$\n       k = \\left( \\frac{15 K}{8 \\pi J} \\right)^{1/3}.\n       $$\n     - The growth coefficient $G$ reported is $v$ if interface-controlled or $k$ if diffusion-controlled.\n\n4. Units and rounding:\n   - $J$ is reported in $\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n   - $G$ is reported in $\\mathrm{m}\\,\\mathrm{s}^{-m}$, where $m$ is the selected growth law exponent ($1$ for $v$ or $1/2$ for $k$).\n   - Round $J$ and $G$ to three significant figures. Report $m$ with one decimal place. Report the control flag as an integer $0$ for interface-controlled and $1$ for diffusion-controlled.\n\n5. Algorithmic steps implemented in code:\n   - For each dataset:\n     - Build masks to include only points with $0  X_i  1$.\n     - Compute $x_i = \\ln t_i$ and $y_i = \\ln(-\\ln(1 - X_i))$.\n     - Perform least squares linear fit to obtain $n$ and $\\ln K$, then compute $K$.\n     - Compute $J = N(t_n)/t_n$.\n     - Classify mechanism by comparing $|n - 4|$ versus $|n - 5/2|$.\n     - Compute $G$ from $K$ and $J$ using the appropriate formula.\n     - Round and append $[J, G, m, \\text{flag}]$ to the output list.\n\n6. Test suite coverage:\n   - Dataset A exercises interface-controlled kinetics at moderate to high transformed fractions.\n   - Dataset B exercises diffusion-controlled kinetics over a wide time span.\n   - Dataset C provides an edge case with an initial zero fraction to validate robustness in the fitting stage; classification and parameter recovery remain well-defined after filtering.\n\nThe final program outputs a single line containing the concatenated results for all datasets in the exact required format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef round_sig(x, sig=3):\n    \"\"\"\n    Round a float x to 'sig' significant figures.\n    Handles non-finite values gracefully by returning x unchanged.\n    \"\"\"\n    if not np.isfinite(x) or x == 0:\n        return x\n    # Determine the order of magnitude and scale accordingly\n    order = int(np.floor(np.log10(abs(x))))\n    factor = 10 ** (order - sig + 1)\n    return np.round(x / factor) * factor\n\ndef fit_avrami(t, X):\n    \"\"\"\n    Fit the Avrami model X = 1 - exp(-K t^n) by linearizing:\n    y = ln(-ln(1 - X)) = ln K + n ln t\n    Returns (n, K). Filters out X = 0 or X = 1 to avoid singularities.\n    \"\"\"\n    t = np.asarray(t, dtype=float)\n    X = np.asarray(X, dtype=float)\n    # Filter valid range 0X1\n    mask = (X  0.0)  (X  1.0)  (t  0.0)\n    if np.count_nonzero(mask)  2:\n        # Not enough points; return NaNs\n        return np.nan, np.nan\n    x = np.log(t[mask])\n    # Guard against numerical issues in log1p\n    one_minus_X = 1.0 - X[mask]\n    # Ensure arguments are within (0,1) exclusive\n    y = np.log(-np.log(one_minus_X))\n    # Linear regression y = a + b x\n    A = np.vstack([np.ones_like(x), x]).T\n    coeff, _, _, _ = np.linalg.lstsq(A, y, rcond=None)\n    lnK, n = coeff[0], coeff[1]\n    K = np.exp(lnK)\n    return n, K\n\ndef classify_mechanism(n):\n    \"\"\"\n    Classify mechanism based on proximity of fitted n to theoretical values:\n    - Interface-controlled (continuous nucleation, 3D): n = 4 - flag 0, m = 1.0\n    - Diffusion-controlled (continuous nucleation, 3D): n = 2.5 - flag 1, m = 0.5\n    Returns (m, flag).\n    \"\"\"\n    if not np.isfinite(n):\n        # Default to interface if n is invalid\n        return 1.0, 0\n    target_interface = 4.0\n    target_diffusion = 2.5\n    d_int = abs(n - target_interface)\n    d_diff = abs(n - target_diffusion)\n    if d_int = d_diff:\n        return 1.0, 0\n    else:\n        return 0.5, 1\n\ndef compute_growth_coeff(K, J, m):\n    \"\"\"\n    Compute growth coefficient G from K and J given mechanism exponent m:\n    - If m=1.0 (interface-controlled), v = (3 K / (pi J))^(1/3)\n    - If m=0.5 (diffusion-controlled), k = (15 K / (8 pi J))^(1/3)\n    Returns G (float).\n    \"\"\"\n    pi = np.pi\n    if not (np.isfinite(K) and np.isfinite(J)) or J = 0 or K = 0:\n        return np.nan\n    if m == 1.0:\n        return (3.0 * K / (pi * J)) ** (1.0 / 3.0)\n    elif m == 0.5:\n        return (15.0 * K / (8.0 * pi * J)) ** (1.0 / 3.0)\n    else:\n        # Unsupported mechanism; return NaN\n        return np.nan\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: dict with time array t (s), fraction array X (dimensionless),\n    # early-time nucleation count t_n (s), N_meas (m^-3).\n    test_cases = [\n        {\n            \"t\": [5, 10, 15, 20, 25, 30],\n            \"X\": [0.00262, 0.0410, 0.191, 0.488, 0.806, 0.966],\n            \"t_n\": 3.0,\n            \"N_meas\": 1.50e18\n        },\n        {\n            \"t\": [10, 20, 30, 40, 50, 60, 80, 100],\n            \"X\": [0.0132, 0.0721, 0.186, 0.345, 0.522, 0.689, 0.909, 0.985],\n            \"t_n\": 20.0,\n            \"N_meas\": 4.00e18\n        },\n        {\n            \"t\": [2, 4, 6, 8, 10, 12],\n            \"X\": [0.0, 0.00102, 0.00518, 0.0163, 0.0392, 0.0796],\n            \"t_n\": 2.0,\n            \"N_meas\": 1.60e18\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        t = np.array(case[\"t\"], dtype=float)\n        X = np.array(case[\"X\"], dtype=float)\n        t_n = float(case[\"t_n\"])\n        N_meas = float(case[\"N_meas\"])\n\n        # Fit Avrami parameters\n        n_fit, K_fit = fit_avrami(t, X)\n\n        # Estimate nucleation rate J from early-time nuclei count\n        J_est = N_meas / t_n if t_n  0 else np.nan\n\n        # Classify mechanism\n        m, flag = classify_mechanism(n_fit)\n\n        # Compute growth coefficient G (v if interface-controlled, k if diffusion-controlled)\n        G_est = compute_growth_coeff(K_fit, J_est, m)\n\n        # Round outputs: J and G to 3 significant figures, m to 1 decimal\n        J_out = round_sig(J_est, sig=3)\n        G_out = round_sig(G_est, sig=3)\n        m_out = np.round(m, 1)\n\n        # Append to final results\n        results.extend([J_out, G_out, m_out, int(flag)])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(lambda x: str(x), results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}