{
    "hands_on_practices": [
        {
            "introduction": "吉布斯-杜亥姆关系为多组分体系中各组分的化学势变化提供了严格的约束。这个练习将指导您应用该关系，从一个组分已知的活度系数表达式，通过积分推导出另一个组分的活度系数。这是检验热力学模型自洽性的基本功，也是理解溶液行为相互依赖性的关键一步 ()。",
            "id": "3743533",
            "problem": "考虑一个嵌入在多组分高熵合金（HEA, High-Entropy Alloy）中的二元置换合金子系统 $A$–$B$，在恒定温度 $T$ 和压力 $P$ 下进行建模。设溶液的摩尔吉布斯自由能为 $G(T,P,n_A,n_B)$，化学势定义为 $\\mu_i = \\left(\\partial G/\\partial n_i\\right)_{T,P,n_{j \\neq i}}$，其中 $i \\in \\{A,B\\}$。活度遵循 $\\mu_i = \\mu_i^{\\mathrm{ref}}(T,P) + R T \\ln a_i$，其中每个组分的参考态是其在相同 $T$ 和 $P$ 下的纯液态（拉乌尔定律参考态）。对于等温等压二元溶液，吉布斯-杜亥姆关系适用。\n\n假设活度写为 $a_i = \\gamma_i x_i$，其中 $x_i$ 是摩尔分数，$\\gamma_i$ 是活度系数。在该高熵合金子系统中，假设基于第一性原理的相互作用模型得出组分 $B$ 的活度系数依赖于成分，其形式为：\n$$\n\\ln \\gamma_B(x_A) = a\\, x_A^{2} + b\\, x_A^{3}\n$$\n其中 $a$ 和 $b$ 是与成分无关的参数，且 $x_A + x_B = 1$。在所述参考态（拉乌尔定律）下，当 $x_A \\to 1$ 时有 $\\gamma_A \\to 1$，当 $x_B \\to 1$ 时有 $\\gamma_B \\to 1$。\n\n仅使用化学势和活度的基本定义以及在恒定 $T$ 和 $P$ 下的吉布斯-杜亥姆关系，推导由给定的 $\\ln \\gamma_B(x_A)$ 所隐含的 $\\ln \\gamma_A(x_A)$ 的闭合形式解析表达式。将最终结果表示为 $x_A$、$a$ 和 $b$ 的函数。不需要进行数值计算，也无需四舍五入。只提供表达式，最终答案中不包括单位。",
            "solution": "根据规定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **系统：**多组分高熵合金（HEA）中的一个二元置换合金子系统 A–B。\n- **热力学条件：**恒定温度 $T$ 和恒定压力 $P$。\n- **热力学势：**摩尔吉布斯自由能为 $G(T,P,n_A,n_B)$。\n- **化学势定义：**$\\mu_i = \\left(\\frac{\\partial G}{\\partial n_i}\\right)_{T,P,n_{j \\neq i}}$，对于组分 $i \\in \\{A,B\\}$。\n- **活度定义：**$\\mu_i = \\mu_i^{\\mathrm{ref}}(T,P) + R T \\ln a_i$。\n- **活度系数定义：**$a_i = \\gamma_i x_i$，其中 $x_i$ 是摩尔分数，$\\gamma_i$ 是活度系数。\n- **参考态：**每个组分的参考态是其在相同 $T$ 和 $P$ 下的纯液态。这对应于拉乌尔定律参考态。\n- **控制方程：**等温等压二元溶液的吉布斯-杜亥姆关系。\n- **摩尔分数约束：**$x_A + x_B = 1$。\n- **给定的函数形式：**组分 $B$ 的活度系数由 $\\ln \\gamma_B(x_A) = a\\, x_A^{2} + b\\, x_A^{3}$ 给出，其中 $a$ 和 $b$ 是常数。\n- **边界条件：**根据拉乌尔定律参考态的定义，当 $x_i \\to 1$ 时 $\\gamma_i \\to 1$。具体来说，当 $x_A \\to 1$ 时 $\\gamma_A \\to 1$，当 $x_B \\to 1$ 时 $\\gamma_B \\to 1$。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题的有效性进行评估。\n- **科学依据：**该问题牢固地植根于经典化学热力学。吉布斯-杜亥姆关系是多组分系统的基本状态方程。使用多项式展开来表示活度系数的对数是溶液建模中的标准方法（例如，Margules 或 Redlich-Kister 方程）。高熵合金的背景具有科学相关性。\n- **适定性：**问题提供了一个活度系数的函数形式，并要求求解另一个。吉布斯-杜亥姆关系提供了必要的微分约束。此外，还提供了待求活度系数的边界条件（当 $x_A \\to 1$ 时 $\\gamma_A \\to 1$），这使得积分常数得以确定，从而确保了唯一解。\n- **一致性检查：**给定的 $\\ln \\gamma_B$ 形式必须与其边界条件一致。条件“当 $x_B \\to 1$ 时 $\\gamma_B \\to 1$”等价于“当 $x_A \\to 0$ 时 $\\ln \\gamma_B \\to 0$”。将 $x_A=0$ 代入给定表达式，得到 $\\ln \\gamma_B(0) = a(0)^2 + b(0)^3 = 0$。这是一致的。\n- **客观性：**问题以精确、无歧义的科学语言陈述。\n\n该问题没有验证清单中列出的任何缺陷（例如，科学上不健全、不完整、矛盾、含糊不清）。它是物理化学或材料科学中的一个标准、可解的问题。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将推导解答。\n\n### 推导\n推导从恒定温度 $T$ 和压力 $P$ 下二元混合物的吉布斯-杜亥姆关系开始。以摩尔量表示，该关系式为：\n$$x_A d\\mu_A + x_B d\\mu_B = 0$$\n其中 $x_i$ 是组分 $i$ 的摩尔分数，$\\mu_i$ 是其化学势。\n\n化学势通过以下定义与活度 $a_i$ 相关：\n$$\\mu_i = \\mu_i^{\\mathrm{ref}}(T,P) + R T \\ln a_i$$\n由于 $T$ 和 $P$ 是恒定的，参考化学势 $\\mu_i^{\\mathrm{ref}}$ 也是恒定的。对 $\\mu_i$ 进行微分得到：\n$$d\\mu_i = R T d(\\ln a_i)$$\n将此代入吉布斯-杜亥姆方程并消去非零因子 $R T$ 得：\n$$x_A d(\\ln a_A) + x_B d(\\ln a_B) = 0$$\n活度 $a_i$ 通过 $a_i = \\gamma_i x_i$ 与活度系数 $\\gamma_i$ 和摩尔分数 $x_i$ 相关。因此，$\\ln a_i = \\ln \\gamma_i + \\ln x_i$。将此代入上式：\n$$x_A d(\\ln \\gamma_A + \\ln x_A) + x_B d(\\ln \\gamma_B + \\ln x_B) = 0$$\n展开微分：\n$$x_A d\\ln \\gamma_A + x_A d\\ln x_A + x_B d\\ln \\gamma_B + x_B d\\ln x_B = 0$$\n使用关系式 $d\\ln u = du/u$：\n$$x_A d\\ln \\gamma_A + x_A \\frac{dx_A}{x_A} + x_B d\\ln \\gamma_B + x_B \\frac{dx_B}{x_B} = 0$$\n$$x_A d\\ln \\gamma_A + dx_A + x_B d\\ln \\gamma_B + dx_B = 0$$\n根据摩尔分数约束 $x_A + x_B = 1$，我们有 $dx_A + dx_B = 0$。方程简化为活度系数的吉布斯-杜亥姆关系：\n$$x_A d\\ln \\gamma_A + x_B d\\ln \\gamma_B = 0$$\n为了求出 $\\ln \\gamma_A$，我们重排这个方程：\n$$d\\ln \\gamma_A = -\\frac{x_B}{x_A} d\\ln \\gamma_B$$\n问题提供了 $\\ln \\gamma_B$ 关于 $x_A$ 的函数形式：\n$$\\ln \\gamma_B(x_A) = a\\, x_A^{2} + b\\, x_A^{3}$$\n我们对该表达式关于 $x_A$ 求导以求得 $d\\ln \\gamma_B$：\n$$\\frac{d(\\ln \\gamma_B)}{dx_A} = 2a\\, x_A + 3b\\, x_A^{2}$$\n因此，$d\\ln \\gamma_B = (2a\\, x_A + 3b\\, x_A^{2}) dx_A$。\n\n将此式和 $x_B = 1 - x_A$ 代入重排后的吉布斯-杜亥姆方程：\n$$d\\ln \\gamma_A = -\\frac{1 - x_A}{x_A} (2a\\, x_A + 3b\\, x_A^{2}) dx_A$$\n通过从第二个括号中提出因子 $x_A$ 来简化该项：\n$$d\\ln \\gamma_A = -(1 - x_A) (2a + 3b\\, x_A) dx_A$$\n展开乘积：\n$$d\\ln \\gamma_A = -(2a + 3b\\, x_A - 2a\\, x_A - 3b\\, x_A^{2}) dx_A$$\n$$d\\ln \\gamma_A = -[2a + (3b - 2a)x_A - 3b\\, x_A^{2}] dx_A$$\n为了求出 $\\ln \\gamma_A$，我们必须对这个微分表达式进行积分。我们从参考态（纯组分 A，此时 $x_A=1$）到任意成分 $x_A$ 进行定积分。边界条件是当 $x_A=1$ 时，$\\gamma_A=1$，这意味着 $\\ln \\gamma_A = 0$。\n$$\\int_{\\ln \\gamma_A(1)}^{\\ln \\gamma_A(x_A)} d(\\ln \\gamma_A') = \\int_{1}^{x_A} -[2a + (3b - 2a)x_A' - 3b\\, (x_A')^{2}] dx_A'$$\n$$\\ln \\gamma_A(x_A) - \\ln \\gamma_A(1) = -\\left[ 2a x_A' + (3b - 2a)\\frac{(x_A')^2}{2} - 3b\\frac{(x_A')^3}{3} \\right]_1^{x_A}$$\n在 $\\ln \\gamma_A(1) = 0$ 的条件下：\n$$\\ln \\gamma_A(x_A) = - \\left[ 2a x_A' + \\frac{3b-2a}{2}(x_A')^2 - b(x_A')^3 \\right]_1^{x_A}$$\n在积分上下限处求值：\n$$\\ln \\gamma_A(x_A) = - \\left( \\left( 2a x_A + \\frac{3b-2a}{2}x_A^2 - b x_A^3 \\right) - \\left( 2a(1) + \\frac{3b-2a}{2}(1)^2 - b(1)^3 \\right) \\right)$$\n在 $x_A=1$ 处求值的常数项是：\n$$2a + \\frac{3b-2a}{2} - b = \\frac{4a + 3b - 2a - 2b}{2} = \\frac{2a+b}{2} = a + \\frac{b}{2}$$\n将此代回 $\\ln \\gamma_A(x_A)$ 的表达式中：\n$$\\ln \\gamma_A(x_A) = - \\left( 2a x_A + \\left(\\frac{3b}{2} - a\\right)x_A^2 - b x_A^3 \\right) + \\left(a + \\frac{b}{2}\\right)$$\n分配负号得到最终表达式：\n$$\\ln \\gamma_A(x_A) = a + \\frac{b}{2} - 2a x_A - \\left(\\frac{3b}{2} - a\\right)x_A^2 + b x_A^3$$\n按 $x_A$ 的升幂次序重新排列各项：\n$$\\ln \\gamma_A(x_A) = \\left(a + \\frac{b}{2}\\right) - 2a x_A + \\left(a - \\frac{3b}{2}\\right)x_A^2 + b x_A^3$$\n这就是 $\\ln \\gamma_A$ 作为 $x_A$、$a$ 和 $b$ 的函数的闭合形式解析表达式。",
            "answer": "$$\n\\boxed{b x_A^3 + \\left(a - \\frac{3b}{2}\\right)x_A^2 - 2a x_A + a + \\frac{b}{2}}\n$$"
        },
        {
            "introduction": "吉布斯-杜亥姆关系的应用远不止于一致性检验，它与材料的相稳定性密切相关。本练习将引导您探索吉布斯自由能的曲率如何决定一个固溶体是稳定存在还是会发生亚稳分解，从而揭示热力学基本原理与材料微观结构演化之间的深刻联系 ()。通过一个正则溶体模型，您将推导出亚稳分解的判据和成分范围。",
            "id": "3743554",
            "problem": "考虑一种在恒定温度和压力下的化学无序高熵合金（HEA），该合金在其他元素摩尔分数固定的惰性背景下，沿着组分 $A$ 和 $B$ 之间的伪二元连接线进行建模。设该体系的摩尔吉布斯混合自由能为：\n$$\ng(x) = R T \\left[ x \\ln x + (1 - x) \\ln(1 - x) \\right] + \\Omega\\, x(1 - x)\n$$\n其中 $x$ 是组分 $A$ 的摩尔分数，$R$ 是气体常数，$T$ 是绝对温度，$\\Omega$ 是一个与成分无关的对称相互作用参数，表征了高熵合金环境中 $A$–$B$ 的混合焓。\n\n从多组分溶液的吉布斯自由能微分的基本定义、化学势定义以及恒定温度和压力下的吉布斯-杜亥姆关系出发，推导受吉布斯-杜亥姆约束所限定的成分流形上 $g(x)$ 的凸性所表示的局部稳定性条件。利用此条件，为上述正规溶体模型获得解析的旋节线判据以及旋节线成分 $x_{-}$ 和 $x_{+}$ 的闭合形式表达式。\n\n然后，对于 $T = 1200\\,\\mathrm{K}$，$\\Omega = 20\\,\\mathrm{kJ\\,mol^{-1}}$ 和 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$（请使用一致的单位），计算两个旋节线成分。将最终结果四舍五入至四位有效数字。以小数形式表示最终成分（不带百分号）。",
            "solution": "该问题具有科学依据，提法恰当，客观，并包含了获得完整解答所需的所有信息。因此，该问题被认定为有效。\n\n解答过程分为两部分：首先，从基本热力学原理推导旋节线稳定性判据；其次，将此判据应用于给定的正规溶体模型，以求出特定的旋节线成分。\n\n**第一部分：旋节线稳定性判据的推导**\n\n多组分体系的总吉布斯自由能 $G$ 是温度 $T$、压力 $P$ 和各组分摩尔数 $n_i$ 的函数。其全微分为：\n$$\ndG = -SdT + VdP + \\sum_{i} \\mu_i dn_i\n$$\n其中 $S$ 是熵，$V$ 是体积，$\\mu_i$ 是组分 $i$ 的化学势。\n\n在恒定温度（$dT=0$）和恒定压力（$dP=0$）下，上式简化为：\n$$\ndG_{T,P} = \\sum_{i} \\mu_i dn_i\n$$\n由于 $G$ 是一个广延性质，并且是关于摩尔数 $n_i$ 的一次齐次函数，根据 Euler 齐次函数定理，有 $G = \\sum_{i} n_i \\mu_i$。该表达式的全微分为 $dG = \\sum_{i} n_i d\\mu_i + \\sum_{i} \\mu_i dn_i$。在恒定 $T$ 和 $P$ 下，令两个 $dG$ 表达式相等，即可得到吉布斯-杜亥姆关系：\n$$\n\\sum_{i} n_i d\\mu_i = 0 \\quad (\\text{在恒定 } T, P\\text{下})\n$$\n对于所讨论的包含组分 $A$ 和 $B$ 的伪二元体系，该关系变为 $n_A d\\mu_A + n_B d\\mu_B = 0$。两边同除以总摩尔数 $N = n_A + n_B$，并使用摩尔分数 $x_A = x = n_A/N$ 和 $x_B = 1-x = n_B/N$，我们得到：\n$$\nx\\, d\\mu_A + (1-x)\\, d\\mu_B = 0\n$$\n如果任何微小的局部成分涨落都会导致吉布斯自由能增加，则均匀溶液相对于这种涨落是热力学稳定的。这个稳定区域的边界就是旋节线。不稳定（旋节线分解）的条件是，当体系可以通过分离成两个成分略有不同的相来降低其自由能时。这对应于摩尔吉布斯自由能函数 $g(x)$ 的负曲率。因此，稳定性的极限，即旋节线，由曲率为零的条件定义。\n\n为了将其形式化，我们将化学势与摩尔吉布斯自由能 $g(x) = G/N$ 联系起来。化学势由切线截距法给出：\n$$\n\\mu_A = g(x) + (1-x)\\frac{dg}{dx}\n$$\n$$\n\\mu_B = g(x) - x\\frac{dg}{dx}\n$$\n根据这些定义，化学势的差异与摩尔吉布斯自由能的一阶导数直接相关：\n$$\n\\mu_A - \\mu_B = \\left( g + (1-x)\\frac{dg}{dx} \\right) - \\left( g - x\\frac{dg}{dx} \\right) = \\frac{dg}{dx}\n$$\n稳定性判据可以表示为 $\\frac{d(\\mu_A - \\mu_B)}{dx} > 0$。如果一个区域的组分 $A$ 略微富集（即 $x$ 增加），化学势差必须增加才能将体系驱动回均匀状态。将 $\\mu_A - \\mu_B = \\frac{dg}{dx}$ 代入稳定性条件，得到：\n$$\n\\frac{d}{dx}\\left(\\frac{dg}{dx}\\right) > 0 \\implies \\frac{d^2g}{dx^2} > 0\n$$\n因此，当摩尔吉布斯自由能函数 $g(x)$ 是凸函数时，体系是稳定的。旋节线标志着稳定区和非稳定区之间的边界，其定义为凸性消失的条件：\n$$\n\\frac{d^2g}{dx^2} = 0\n$$\n\n**第二部分：应用于正规溶体模型**\n\n正规溶体模型的摩尔吉布斯混合自由能由下式给出：\n$$\ng(x) = R T \\left[ x \\ln x + (1 - x) \\ln(1 - x) \\right] + \\Omega\\, x(1 - x)\n$$\n我们需要计算 $g(x)$ 对 $x$ 的二阶导数。\n一阶导数：\n$$\n\\frac{dg}{dx} = \\frac{d}{dx} \\left( R T x \\ln x + R T (1 - x) \\ln(1 - x) + \\Omega x - \\Omega x^2 \\right)\n$$\n$$\n\\frac{dg}{dx} = R T \\left( \\ln x + x\\frac{1}{x} - \\ln(1-x) - (1-x)\\frac{1}{1-x} \\right) + \\Omega(1 - 2x)\n$$\n$$\n\\frac{dg}{dx} = R T \\left( \\ln x + 1 - \\ln(1-x) - 1 \\right) + \\Omega(1-2x) = RT \\ln\\left(\\frac{x}{1-x}\\right) + \\Omega(1-2x)\n$$\n二阶导数：\n$$\n\\frac{d^2g}{dx^2} = \\frac{d}{dx} \\left( RT \\ln\\left(\\frac{x}{1-x}\\right) + \\Omega(1-2x) \\right)\n$$\n$$\n\\frac{d^2g}{dx^2} = R T \\left( \\frac{1-x}{x} \\right) \\left( \\frac{(1-x) - x(-1)}{(1-x)^2} \\right) - 2\\Omega\n$$\n$$\n\\frac{d^2g}{dx^2} = R T \\left( \\frac{1}{x(1-x)} \\right) - 2\\Omega\n$$\n应用旋节线判据 $\\frac{d^2g}{dx^2} = 0$：\n$$\n\\frac{RT}{x(1-x)} - 2\\Omega = 0 \\implies x(1-x) = \\frac{RT}{2\\Omega}\n$$\n这可以改写为关于 $x$ 的二次方程：\n$$\nx^2 - x + \\frac{RT}{2\\Omega} = 0\n$$\n使用二次公式 $x = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$，其中 $a=1$，$b=-1$，以及 $c=\\frac{RT}{2\\Omega}$，我们求得根为：\n$$\nx = \\frac{1 \\pm \\sqrt{(-1)^2 - 4(1)\\left(\\frac{RT}{2\\Omega}\\right)}}{2} = \\frac{1 \\pm \\sqrt{1 - \\frac{2RT}{\\Omega}}}{2}\n$$\n这些就是两个旋节线成分 $x_{-}$ 和 $x_{+}$ 的闭合形式表达式。\n$$\nx_{-} = \\frac{1}{2} - \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{\\Omega}}\n$$\n$$\nx_{+} = \\frac{1}{2} + \\frac{1}{2}\\sqrt{1 - \\frac{2RT}{\\Omega}}\n$$\n\n**数值计算**\n\n我们已知以下数值：\n$T = 1200\\,\\mathrm{K}$\n$\\Omega = 20\\,\\mathrm{kJ\\,mol^{-1}} = 20000\\,\\mathrm{J\\,mol^{-1}}$\n$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\n首先，我们计算无量纲项 $\\frac{2RT}{\\Omega}$：\n$$\n\\frac{2RT}{\\Omega} = \\frac{2 \\times (8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (1200\\,\\mathrm{K})}{20000\\,\\mathrm{J\\,mol^{-1}}} = \\frac{19953.6}{20000} = 0.99768\n$$\n现在，将该值代入 $x_{-}$ 和 $x_{+}$ 的表达式中：\n$$\nx = \\frac{1 \\pm \\sqrt{1 - 0.99768}}{2} = \\frac{1 \\pm \\sqrt{0.00232}}{2}\n$$\n计算平方根：\n$$\n\\sqrt{0.00232} \\approx 0.048166378\n$$\n两个旋节线成分为：\n$$\nx_{-} = \\frac{1 - 0.048166378}{2} = \\frac{0.951833622}{2} = 0.475916811...\n$$\n$$\nx_{+} = \\frac{1 + 0.048166378}{2} = \\frac{1.048166378}{2} = 0.524083189...\n$$\n按照要求将这些值四舍五入到四位有效数字，得到：\n$x_{-} = 0.4759$\n$x_{+} = 0.5241$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.4759 & 0.5241 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在高熵合金等复杂多组分体系的计算模拟中，准确实现热力学模型至关重要。本练习要求您编写程序，在一个四元正则溶体模型中计算各组分的化学势和活度，并将吉布斯-杜亥姆关系作为数值验证工具，以检验模型的正确性 ()。这真实地模拟了计算材料科学家在开发和验证热力学数据库时所需的核心技能。",
            "id": "3743526",
            "problem": "考虑一个代表高熵合金 (HEA) 的多元替代固溶体。该系统由 $N=4$ 种组分构成，其摩尔分数 $\\mathbf{x}=(x_1,x_2,x_3,x_4)$ 满足 $\\sum_{i=1}^{4} x_i = 1$。设在恒定温度 $T$ 和压力 $P$ 下，摩尔混合吉布斯自由能被建模为一个理想混合项和一个来自二元相互作用正则溶体模型的超额项之和，即：\n$$\ng(\\mathbf{x},T) = g^{\\text{ideal}}(\\mathbf{x},T) + g^{\\text{excess}}(\\mathbf{x},T)\n$$\n其中理想项为：\n$$\ng^{\\text{ideal}}(\\mathbf{x},T) = R T \\sum_{i=1}^{4} x_i \\ln x_i\n$$\n而超额项为：\n$$\ng^{\\text{excess}}(\\mathbf{x},T) = \\sum_{1 \\le i  j \\le 4} x_i x_j L_{ij}(T), \\quad L_{ij}(T) = A_{ij} + B_{ij} T\n$$\n此处，$R$ 表示普适气体常数，$A_{ij}$ 和 $B_{ij}$ 是不依赖于温度的系数，单位分别为 $\\text{J mol}^{-1}$ 和 $\\text{J mol}^{-1} \\text{K}^{-1}$。\n\n组分 $i$ 的化学势 $\\mu_i$ 由基本热力学关系定义：\n$$\n\\mu_i = \\left(\\frac{\\partial G}{\\partial n_i}\\right)_{T,P,n_{j\\ne i}}\n$$\n以拉乌尔定律标准态为参考，组分 $i$ 的活度 $a_i$ 定义为：\n$$\n\\mu_i = \\mu_i^{0}(T,P) + R T \\ln a_i\n$$\n活度系数 $\\gamma_i$ 满足 $a_i = \\gamma_i x_i$。\n\n您的任务是编写一个程序，对下面指定的每个测试用例执行以下操作：\n\n1. 从上述定义出发，根据第一性原理，计算在给定温度 $T$ 和组分 $\\mathbf{x}$ 下各组分的化学势 $\\mu_i$，单位为 $\\text{J mol}^{-1}$。\n2. 通过从化学势的超额贡献中导出的活度系数来计算活度 $a_i$。具体来说，使用分解 $\\mu_i = \\mu_i^{\\text{ideal}} + \\mu_i^{\\text{excess}}$ 并通过 $\\gamma_i = \\exp\\!\\big(\\mu_i^{\\text{excess}}/(R T)\\big)$ 来定义活度系数，从而得到 $a_i = \\gamma_i x_i$。\n3. 通过构造总和为零的小组分扰动 $\\delta \\mathbf{x}$ 并计算残差，来评估一个由恒定 $T$ 和 $P$ 下的吉布斯-杜亥姆关系启发的离散检验：\n$$\n\\Delta(\\mathbf{x},\\delta \\mathbf{x}) = \\left| \\sum_{i=1}^{4} x_i \\left[ \\mu_i(\\mathbf{x} + \\delta \\mathbf{x}, T) - \\mu_i(\\mathbf{x}, T) \\right] \\right|\n$$\n使用两种扰动：\n   - $\\delta \\mathbf{x}^{(1)} = (\\varepsilon, -\\varepsilon, 0, 0)$,\n   - $\\delta \\mathbf{x}^{(2)} = (\\varepsilon, 0, -\\varepsilon/2, -\\varepsilon/2)$,\n   其中 $\\varepsilon = 10^{-8}$。\n   如果 $\\mathbf{x} + \\delta \\mathbf{x}$ 的任何分量变为负数，则应均匀地向下缩放 $\\varepsilon$，直到所有分量都保持严格为正。对于每个测试用例，报告两个残差中的最大值，单位为 $\\text{J mol}^{-1}$。\n\n使用 $R = 8.314462618\\ \\text{J mol}^{-1}\\text{K}^{-1}$。所有化学势和残差都必须以 $\\text{J mol}^{-1}$ 表示。活度是无量纲的。本问题不涉及角度。\n\n为以下参数值的测试套件实现计算。在每种情况下，二元相互作用参数都是对称的，即 $A_{ij} = A_{ji}$ 和 $B_{ij} = B_{ji}$。\n\n测试用例1（通用类高熵合金，等摩尔组分）：\n- $T = 1400\\ \\text{K}$，\n- $\\mathbf{x} = (0.25, 0.25, 0.25, 0.25)$，\n- 非零二元相互作用参数：\n  - $(i,j) = (1,2)$: $A_{12} = 4000$, $B_{12} = -1.5$,\n  - $(1,3)$: $A_{13} = 8000$, $B_{13} = 0.0$,\n  - $(1,4)$: $A_{14} = -3000$, $B_{14} = 0.5$,\n  - $(2,3)$: $A_{23} = 2000$, $B_{23} = -0.8$,\n  - $(2,4)$: $A_{24} = 1000$, $B_{24} = 0.2$,\n  - $(3,4)$: $A_{34} = -5000$, $B_{34} = 1.0$.\n\n测试用例2（理想溶液，靠近边界的偏斜组分）：\n- $T = 1200\\ \\text{K}$，\n- $\\mathbf{x} = (0.70, 0.20, 0.09, 0.01)$，\n- 所有二元相互作用参数均为零：$A_{ij} = 0$, $B_{ij} = 0$ for all $i \\ne j$。\n\n测试用例3（强非理想相互作用，非等摩尔组分）：\n- $T = 1700\\ \\text{K}$，\n- $\\mathbf{x} = (0.25, 0.35, 0.25, 0.15)$，\n- 非零二元相互作用参数：\n  - $(i,j) = (1,2)$: $A_{12} = 15000$, $B_{12} = -5.0$,\n  - $(1,3)$: $A_{13} = -8000$, $B_{13} = 3.0$,\n  - $(1,4)$: $A_{14} = 2000$, $B_{14} = 0.0$,\n  - $(2,3)$: $A_{23} = 5000$, $B_{23} = 1.0$,\n  - $(2,4)$: $A_{24} = -2000$, $B_{24} = 0.5$,\n  - $(3,4)$: $A_{34} = 10000$, $B_{34} = -2.0$.\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，返回一个包含三个浮点数的子列表：\n- 最大离散残差 $\\max\\{\\Delta(\\mathbf{x},\\delta \\mathbf{x}^{(1)}),\\Delta(\\mathbf{x},\\delta \\mathbf{x}^{(2)})\\}$，单位为 $\\text{J mol}^{-1}$，\n- 组分1的活度 $a_1$，\n- 组分2的活度 $a_2$。\n\n因此，最终输出必须具有以下形式：\n$$\n[ [r_1, a_{1,1}, a_{2,1}], [r_2, a_{1,2}, a_{2,2}], [r_3, a_{1,3}, a_{2,3}] ]\n$$\n其中每个 $r_k$ 的单位为 $\\text{J mol}^{-1}$，每个 $a_{i,k}$ 均为无量纲，所有内容打印在单行上。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上植根于经典化学热力学，特别是溶液理论。该问题是适定的，提供了所有必要的数据和函数形式，以确保每个测试用例都存在唯一且有意义的解。语言客观而精确，所提出的框架——一个多元正则溶体模型——是描述所述系统（高熵合金）的标准且合适的模型。不存在内部矛盾、信息缺失或违反物理原理的情况。\n\n求解过程如下。首先，我们必须推导出组分 $k$ 的化学势 $\\mu_k$ 的可计算表达式。其次，我们使用此表达式来计算活度并对吉布斯-杜亥姆关系进行数值检验。\n\n组分 $k$ 的化学势 $\\mu_k$ 是该组分的偏摩尔吉布斯自由能。系统的总吉布斯自由能为 $G = \\sum_{i=1}^N n_i \\mu_i^0 + G_{\\text{mix}}$，其中 $\\mu_i^0$ 是纯组分 $i$ 在其标准态下的化学势，$n_i$ 是摩尔数，$G_{\\text{mix}}$ 是总混合吉布斯自由能。摩尔混合吉布斯自由能 $g$ 是给定的，因此 $G_{\\text{mix}} = n_t g$，其中 $n_t = \\sum_i n_i$ 是总摩尔数。\n化学势定义为 $\\mu_k = (\\partial G / \\partial n_k)_{T,P,n_{j\\ne k}}$。应用此定义可得：\n$$\n\\mu_k = \\mu_k^0 + \\left(\\frac{\\partial (n_t g)}{\\partial n_k}\\right)_{T,P,n_{j\\ne k}}\n$$\n涉及混合能导数的项是组分 $k$ 的偏摩尔混合吉布斯自由能。对于与摩尔量 $Y$ 对应的任何偏摩尔量 $\\bar{Y}_k$，存在一个标准热力学关系：\n$$\n\\bar{Y}_k = Y + \\frac{\\partial Y}{\\partial x_k} - \\sum_{j=1}^{N} x_j \\frac{\\partial Y}{\\partial x_j}\n$$\n其中，相对于摩尔分数 $x_k$ 的导数是在将其中 $N-1$ 个视为自变量的情况下计算的。让我们将此公式应用于 $g = g^{\\text{ideal}} + g^{\\text{excess}}$。我们将偏摩尔混合吉布斯自由能表示为 $\\mu_k^{\\text{mix}} = \\mu_k - \\mu_k^0$。\n\n对于理想部分，$g^{\\text{ideal}} = R T \\sum_{i=1}^{4} x_i \\ln x_i$：\n相对于 $x_k$ 的偏导数为 $\\frac{\\partial g^{\\text{ideal}}}{\\partial x_k} = R T (\\ln x_k + 1)$。\n求和项为 $\\sum_{j=1}^{4} x_j \\frac{\\partial g^{\\text{ideal}}}{\\partial x_j} = \\sum_{j=1}^{4} x_j (R T (\\ln x_j + 1)) = R T \\sum_{j=1}^{4} x_j \\ln x_j + R T \\sum_{j=1}^{4} x_j = g^{\\text{ideal}} + R T$。\n因此，对混合化学势的理想贡献为：\n$$\n\\mu_k^{\\text{ideal, mix}} = g^{\\text{ideal}} + (R T (\\ln x_k + 1)) - (g^{\\text{ideal}} + R T) = R T \\ln x_k\n$$\n这是预期的结果。\n\n对于超额部分，$g^{\\text{excess}} = \\sum_{1 \\le i  j \\le 4} x_i x_j L_{ij}(T)$，其中 $L_{ij} = L_{ji}$：\n相对于 $x_k$ 的偏导数为 $\\frac{\\partial g^{\\text{excess}}}{\\partial x_k} = \\sum_{j \\ne k} x_j L_{kj}$。\n求和项为 $\\sum_{j=1}^{4} x_j \\frac{\\partial g^{\\text{excess}}}{\\partial x_j} = \\sum_{j=1}^{4} x_j \\sum_{l \\ne j} x_l L_{jl} = \\sum_{j \\ne l} x_j x_l L_{jl}$。由于 $L_{jl} = L_{lj}$，此和将每对 $(j,l)$ 计算两次，因此 $\\sum_{j \\ne l} x_j x_l L_{jl} = 2 \\sum_{j  l} x_j x_l L_{jl} = 2 g^{\\text{excess}}$。\n因此，超额化学势为：\n$$\n\\mu_k^{\\text{excess}} = g^{\\text{excess}} + \\left( \\sum_{j \\ne k} x_j L_{kj} \\right) - (2 g^{\\text{excess}}) = \\sum_{j \\ne k} x_j L_{kj} - \\sum_{1 \\le i  j \\le 4} x_i x_j L_{ij}\n$$\n结合这些结果，混合化学势的完整表达式为：\n$$\n\\mu_k^{\\text{mix}}(\\mathbf{x}, T) = \\mu_k - \\mu_k^0 = R T \\ln x_k + \\sum_{j \\ne k} x_j L_{kj}(T) - \\sum_{1 \\le i  j \\le 4} x_i x_j L_{ij}(T)\n$$\n问题要求计算 $\\mu_i$，但未提供 $\\mu_i^0$。然而，后续任务（活度和吉布斯-杜亥姆检验）仅依赖于化学势的混合部分或超额部分。我们将“计算各组分的化学势”这一指令解释为计算混合化学势 $\\mu_k^{\\text{mix}}$ 的任务，这等效于将标准态化学势 $\\mu_k^0$ 设置为0。\n\n现在可以按算法解决这些任务：\n\n1.  **化学势计算**：我们实现一个函数，该函数将组分 $\\mathbf{x}$、温度 $T$ 以及相互作用参数 $A_{ij}$ 和 $B_{ij}$ 作为输入。该函数首先计算与温度相关的相互作用矩阵 $L_{ij}(T) = A_{ij} + B_{ij}T$。然后计算 $g^{\\text{excess}}$，并最终使用推导出的公式评估每个组分 $k=1,2,3,4$ 的 $\\mu_k^{\\text{mix}}$。\n\n2.  **活度计算**：活度系数 $\\gamma_k$ 由 $\\gamma_k = \\exp(\\mu_k^{\\text{excess}} / (R T))$ 给出。活度为 $a_k = \\gamma_k x_k$。所需的项 $\\mu_k^{\\text{excess}}$ 在计算 $\\mu_k^{\\text{mix}}$ 的过程中作为中间步骤计算。我们将为每个测试用例计算 $a_1$ 和 $a_2$。\n\n3.  **吉布斯-杜亥姆检验**：在恒定 $T$ 和 $P$ 下的吉布斯-杜亥姆关系表明 $\\sum_{i} x_i d\\mu_i = 0$。对于从 $\\mathbf{x}$ 到 $\\mathbf{x} + \\delta\\mathbf{x}$ 的一个小的、离散的组分变化，这意味着总和 $\\sum_{i} x_i [\\mu_i(\\mathbf{x}+\\delta\\mathbf{x}) - \\mu_i(\\mathbf{x})]$ 应接近于零。残差 $\\Delta(\\mathbf{x}, \\delta\\mathbf{x})$ 是此总和的绝对值。由于 $\\mu_i^0$ 是常数，$\\mu_i$ 的变化与 $\\mu_i^{\\text{mix}}$ 的变化相同。我们针对给定的两个扰动，计算 $\\mu_i^{\\text{mix}}(\\mathbf{x}, T)$ 和 $\\mu_i^{\\text{mix}}(\\mathbf{x}+\\delta\\mathbf{x}, T)$，计算相应的残差 $\\Delta(\\mathbf{x}, \\delta\\mathbf{x}^{(1)})$ 和 $\\Delta(\\mathbf{x}, \\delta\\mathbf{x}^{(2)})$，并报告两者中的最大值。对于给定的组分，扰动幅度 $\\varepsilon = 10^{-8}$ 足够小，不会使任何组分变为负数，因此不需要对 $\\varepsilon$ 进行缩放。\n\n该实现将处理三个测试用例中的每一个，执行这些计算，并将所需的输出（最大残差、$a_1$、$a_2$）汇总到一个最终列表中以供打印。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the thermodynamics problem for multicomponent solutions as specified.\n    \"\"\"\n    \n    R_GAS_CONSTANT = 8.314462618  # J mol^-1 K^-1\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {\n            \"T\": 1400.0,\n            \"x\": np.array([0.25, 0.25, 0.25, 0.25]),\n            \"params\": {\n                (1, 2): (4000.0, -1.5), (1, 3): (8000.0, 0.0), (1, 4): (-3000.0, 0.5),\n                (2, 3): (2000.0, -0.8), (2, 4): (1000.0, 0.2), (3, 4): (-5000.0, 1.0)\n            }\n        },\n        {\n            \"T\": 1200.0,\n            \"x\": np.array([0.70, 0.20, 0.09, 0.01]),\n            \"params\": {}\n        },\n        {\n            \"T\": 1700.0,\n            \"x\": np.array([0.25, 0.35, 0.25, 0.15]),\n            \"params\": {\n                (1, 2): (15000.0, -5.0), (1, 3): (-8000.0, 3.0), (1, 4): (2000.0, 0.0),\n                (2, 3): (5000.0, 1.0), (2, 4): (-2000.0, 0.5), (3, 4): (10000.0, -2.0)\n            }\n        }\n    ]\n\n    def get_mu_mix(x_vec, T, L_mat):\n        \"\"\"\n        Calculates the mixing chemical potentials and excess chemical potentials.\n        \n        Args:\n            x_vec (np.ndarray): Mole fraction vector (4,).\n            T (float): Temperature in Kelvin.\n            L_mat (np.ndarray): Matrix of interaction parameters L_ij (4x4).\n            \n        Returns:\n            tuple: (mu_mix, mu_excess) where each is a (4,) numpy array.\n        \"\"\"\n        N = 4\n        \n        # Calculate excess Gibbs energy\n        g_excess = 0.0\n        for i in range(N):\n            for j in range(i + 1, N):\n                g_excess += x_vec[i] * x_vec[j] * L_mat[i, j]\n\n        mu_mix = np.zeros(N)\n        mu_excess = np.zeros(N)\n        RT = R_GAS_CONSTANT * T\n\n        for k in range(N):\n            # Term for sum over j != k\n            sum_term = 0.0\n            for j in range(N):\n                if k != j:\n                    sum_term += x_vec[j] * L_mat[k, j]\n            \n            # Excess chemical potential\n            mu_excess_k = sum_term - g_excess\n            mu_excess[k] = mu_excess_k\n            \n            # Ideal mixing chemical potential part\n            # Use small epsilon to avoid log(0) if a component is zero, although not in test cases\n            mu_ideal_mix_k = RT * np.log(x_vec[k] if x_vec[k] > 0 else 1e-100)\n            \n            # Total mixing chemical potential\n            mu_mix[k] = mu_ideal_mix_k + mu_excess_k\n            \n        return mu_mix, mu_excess\n\n    final_results = []\n    \n    for case in test_cases:\n        T = case[\"T\"]\n        x = case[\"x\"]\n        \n        # Setup interaction parameter matrices\n        N_COMPONENTS = 4\n        A = np.zeros((N_COMPONENTS, N_COMPONENTS))\n        B = np.zeros((N_COMPONENTS, N_COMPONENTS))\n        \n        for (i, j), (A_val, B_val) in case[\"params\"].items():\n            A[i-1, j-1] = A_val\n            A[j-1, i-1] = A_val # Symmetric\n            B[i-1, j-1] = B_val\n            B[j-1, i-1] = B_val # Symmetric\n            \n        # Calculate L_ij(T) matrix\n        L = A + B * T\n        \n        # --- Base calculation ---\n        mu_mix_base, mu_excess_base = get_mu_mix(x, T, L)\n        \n        # --- Activity calculation (Task 2) ---\n        RT = R_GAS_CONSTANT * T\n        gamma = np.exp(mu_excess_base / RT)\n        activities = gamma * x\n        a1, a2 = activities[0], activities[1]\n\n        # --- Gibbs-Duhem Check (Task 3) ---\n        epsilon = 1e-8\n        \n        # Perturbation 1\n        delta_x1 = np.array([epsilon, -epsilon, 0.0, 0.0])\n        x_perturbed1 = x + delta_x1\n        # The problem statement guarantees no component will be = 0 for the given test cases.\n        mu_mix_pert1, _ = get_mu_mix(x_perturbed1, T, L)\n        residual1 = np.abs(np.sum(x * (mu_mix_pert1 - mu_mix_base)))\n        \n        # Perturbation 2\n        delta_x2 = np.array([epsilon, 0.0, -epsilon / 2.0, -epsilon / 2.0])\n        x_perturbed2 = x + delta_x2\n        mu_mix_pert2, _ = get_mu_mix(x_perturbed2, T, L)\n        residual2 = np.abs(np.sum(x * (mu_mix_pert2 - mu_mix_base)))\n        \n        max_residual = max(residual1, residual2)\n        \n        final_results.append([max_residual, a1, a2])\n\n    # Format the output as specified\n    output_str = str(final_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}