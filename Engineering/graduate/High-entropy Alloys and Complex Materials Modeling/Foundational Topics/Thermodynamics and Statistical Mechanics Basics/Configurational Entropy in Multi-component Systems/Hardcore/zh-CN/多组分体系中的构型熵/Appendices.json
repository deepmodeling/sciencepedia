{
    "hands_on_practices": [
        {
            "introduction": "我们实践的第一步是掌握计算理想构型熵的基础。这个练习将引导您从统计力学的基本原理出发，推导多组分系统中理想混合构型熵的核心公式。通过计算一个具体的非等摩尔比四元合金的熵，并将其与等摩尔比情况进行比较，您将能定量地理解一个关键概念：在理想混合模型中，当各组分浓度相等时，构型熵达到最大值。",
            "id": "3734886",
            "problem": "考虑一种理想的、随机混合的、置换型四元合金，其处于一个包含大量（$N$）晶格点的固定晶格上。设宏观组分由物种 $i \\in \\{1,2,3,4\\}$ 的占位分数 $x_i$ 指定，且满足 $\\sum_{i=1}^{4} x_i = 1$。假设相同物种的原子不可区分，而晶格点是可区分的。取热力学极限 $N \\to \\infty$，并假设理想混合模型，即各物种间无能量偏好，也无短程有序。使用熵的 Boltzmann 关系式 $S = k_{\\text{B}} \\ln \\Omega$（其中 $\\Omega$ 是与宏观组分一致的不同微观态的数量），并在固定 $N$ 和 $\\{x_i\\}$ 的条件下处理该问题，推导出单位摩尔的理想构型熵 $S_{\\text{ideal}}$（由气体常数 $R$ 归一化）的表达式。\n\n然后，针对组分 $x = \\{0.4, 0.3, 0.2, 0.1\\}$ 和等摩尔四元组分情况 $x = \\{0.25, 0.25, 0.25, 0.25\\}$，计算此归一化熵。作为最终答案，报告单个无量纲比值\n$$\\frac{S_{\\text{ideal}}(x=\\{0.4,0.3,0.2,0.1\\})/R}{S_{\\text{ideal}}(x=\\{0.25,0.25,0.25,0.25\\})/R}.$$\n将最终比值四舍五入至五位有效数字。最终比值无需单位。",
            "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上基于统计力学原理，问题提法良好，信息充分且一致，陈述客观。该问题要求推导多组分系统的理想构型熵，并计算一个特定比值，这是材料热力学中的标准步骤。\n\n第一步是推导单位摩尔的理想构型熵 $S_{\\text{ideal}}$（由气体常数 $R$ 归一化）的一般表达式。该体系是一个处于包含 $N$ 个格点的固定晶格上的四元合金，其中 $N$ 非常大。其组分由四个物种 ($i \\in \\{1, 2, 3, 4\\}$) 的占位分数 $x_i$ 给出，且满足 $\\sum_{i=1}^{4} x_i = 1$。物种 $i$ 的原子数为 $N_i = x_i N$。\n\n根据本问题的统计力学假设，相同物种的原子是不可区分的，而晶格点是可区分的。与给定宏观组分 $\\{x_i\\}$ 对应的不同微观态的数量 $\\Omega$，是在 $N$ 个可用晶格点上排列 $N_1, N_2, N_3, N_4$ 个原子的方式数。这由多项式系数给出：\n$$\n\\Omega = \\frac{N!}{N_1! N_2! N_3! N_4!} = \\frac{N!}{\\prod_{i=1}^{4} (x_i N)!}\n$$\n构型熵 $S$ 由 Boltzmann 关系式 $S = k_{\\text{B}} \\ln \\Omega$ 给出，其中 $k_{\\text{B}}$ 是玻尔兹曼常数。\n$$\nS = k_{\\text{B}} \\ln\\left(\\frac{N!}{\\prod_{i=1}^{4} (x_i N)!}\\right) = k_{\\text{B}} \\left( \\ln(N!) - \\sum_{i=1}^{4} \\ln((x_i N)!) \\right)\n$$\n由于问题指定了热力学极限 $N \\to \\infty$，因此 $N$ 和每个 $N_i = x_i N$ 都是非常大的数。因此，我们可以应用 Stirling 近似来处理阶乘的自然对数，即 $\\ln(k!) \\approx k \\ln k - k$。将此应用于我们的 $S$ 表达式：\n$$\nS \\approx k_{\\text{B}} \\left[ (N \\ln N - N) - \\sum_{i=1}^{4} (x_i N \\ln(x_i N) - x_i N) \\right]\n$$\n我们可以展开项 $\\ln(x_i N) = \\ln x_i + \\ln N$：\n$$\nS \\approx k_{\\text{B}} \\left[ N \\ln N - N - \\sum_{i=1}^{4} (x_i N (\\ln x_i + \\ln N) - x_i N) \\right]\n$$\n$$\nS \\approx k_{\\text{B}} \\left[ N \\ln N - N - \\sum_{i=1}^{4} x_i N \\ln x_i - \\sum_{i=1}^{4} x_i N \\ln N + \\sum_{i=1}^{4} x_i N \\right]\n$$\n提取公因式：\n$$\nS \\approx k_{\\text{B}} \\left[ N \\ln N - N - N \\sum_{i=1}^{4} x_i \\ln x_i - N \\ln N \\left(\\sum_{i=1}^{4} x_i\\right) + N \\left(\\sum_{i=1}^{4} x_i\\right) \\right]\n$$\n使用组分约束 $\\sum_{i=1}^{4} x_i = 1$：\n$$\nS \\approx k_{\\text{B}} \\left[ N \\ln N - N - N \\sum_{i=1}^{4} x_i \\ln x_i - N \\ln N (1) + N (1) \\right]\n$$\n项 $(N \\ln N - N \\ln N)$ 和 $(-N + N)$相互抵消，得到总构型熵的表达式：\n$$\nS = -N k_{\\text{B}} \\sum_{i=1}^{4} x_i \\ln x_i\n$$\n问题要求的是单位摩尔熵 $S_{\\text{ideal}}$。一个包含 $N$ 个原子的系统对应于 $n = N/N_{\\text{A}}$ 摩尔，其中 $N_{\\text{A}}$ 是阿伏伽德罗常数。摩尔熵为 $S_{\\text{ideal}} = S/n = S / (N/N_{\\text{A}}) = S N_{\\text{A}} / N$。\n$$\nS_{\\text{ideal}} = \\frac{N_{\\text{A}}}{N} \\left(-N k_{\\text{B}} \\sum_{i=1}^{4} x_i \\ln x_i\\right) = -N_{\\text{A}} k_{\\text{B}} \\sum_{i=1}^{4} x_i \\ln x_i\n$$\n认识到摩尔气体常数是 $R = N_{\\text{A}} k_{\\text{B}}$，我们得到理想摩尔构型熵的表达式：\n$$\nS_{\\text{ideal}} = -R \\sum_{i=1}^{4} x_i \\ln x_i\n$$\n因此，归一化的熵为：\n$$\n\\frac{S_{\\text{ideal}}}{R} = - \\sum_{i=1}^{4} x_i \\ln x_i\n$$\n现在，我们针对两种指定的组分计算该表达式的值。\n\n情况 1：组分 $x_A = \\{0.4, 0.3, 0.2, 0.1\\}$。\n设归一化熵为 $S_{A, \\text{norm}} = S_{\\text{ideal}}(x_A)/R$。\n$$\nS_{A, \\text{norm}} = - \\left( 0.4 \\ln(0.4) + 0.3 \\ln(0.3) + 0.2 \\ln(0.2) + 0.1 \\ln(0.1) \\right)\n$$\n使用自然对数值：\n$\\ln(0.4) \\approx -0.9162907$\n$\\ln(0.3) \\approx -1.2039728$\n$\\ln(0.2) \\approx -1.6094379$\n$\\ln(0.1) \\approx -2.3025851$\n$$\nS_{A, \\text{norm}} \\approx - \\left( 0.4(-0.9162907) + 0.3(-1.2039728) + 0.2(-1.6094379) + 0.1(-2.3025851) \\right)\n$$\n$$\nS_{A, \\text{norm}} \\approx - \\left( -0.3665163 - 0.3611918 - 0.3218876 - 0.2302585 \\right)\n$$\n$$\nS_{A, \\text{norm}} \\approx -(-1.2798542) = 1.2798542\n$$\n\n情况 2：等摩尔组分 $x_B = \\{0.25, 0.25, 0.25, 0.25\\}$。\n设归一化熵为 $S_{B, \\text{norm}} = S_{\\text{ideal}}(x_B)/R$。\n$$\nS_{B, \\text{norm}} = - \\sum_{i=1}^{4} 0.25 \\ln(0.25) = -4 \\times (0.25 \\ln(0.25)) = -\\ln(0.25)\n$$\n由于 $\\ln(0.25) = \\ln(1/4) = -\\ln(4)$，我们有：\n$$\nS_{B, \\text{norm}} = \\ln(4)\n$$\n数值上，$S_{B, \\text{norm}} \\approx 1.3862944$。该值对应于四元体系可能的最大构型熵。\n\n最后，我们计算所需比值：\n$$\n\\text{Ratio} = \\frac{S_{\\text{ideal}}(x_A)/R}{S_{\\text{ideal}}(x_B)/R} = \\frac{S_{A, \\text{norm}}}{S_{B, \\text{norm}}} = \\frac{- \\sum_{i=1}^{4} x_{A,i} \\ln x_{A,i}}{\\ln(4)}\n$$\n$$\n\\text{Ratio} = \\frac{1.2798542}{1.3862944} \\approx 0.9232238\n$$\n按要求将此结果四舍五入至五位有效数字，得到 $0.92322$。",
            "answer": "$$\\boxed{0.92322}$$"
        },
        {
            "introduction": "理想混合熵公式是在热力学极限下（即系统尺寸无限大）的精确描述，但在计算机模拟和纳米材料等实际应用中，系统总是有限的。这个练习将带您超越这一理想化假设，探索有限尺寸效应如何影响熵的计算。您将使用一个更精确的斯特林公式来推导并应用一个修正项，从而学会量化系统尺寸对构型熵密度的影响，这是连接理论模型与实际计算的关键一步。",
            "id": "3734844",
            "problem": "一种由 $A$ 和 $B$ 两种组元构成的替位二元合金，占据一个具有 $N=10^5$ 个可分辨格点的刚性晶格。成分固定为 $x_A=0.01$ 和 $x_B=1-x_A$。假设理想随机混合，没有能量相互作用，唯一的约束是固定的成分（没有空位或填隙原子）。从熵的微正则定义 $S=k_{\\text{B}}\\ln\\Omega$ 出发，其中 $k_{\\text{B}}$ 是玻尔兹曼常数，$\\Omega$ 是与成分约束一致的不同构型数，并使用 $N_A=x_A N$ 个 $A$ 原子和 $N_B=x_B N$ 个 $B$ 原子的构型的精确组合计数，推导热力学极限下的构型熵密度 $s=S/N$，并量化由有限 $N$ 和小 $x_A$ 引起的主要有限尺寸修正。计算当 $N=10^5$ 和 $x_A=0.01$ 时，修正后的熵密度 $s_{\\text{corr}}/k_{\\text{B}}$。\n\n你的推导必须从上述定义开始，使用适用于大阶乘的渐近展开，并展示成分如何进入熵密度的表达式中。在你的分析中，简要解释在小 $x_A$ 下的有限成分如何影响熵密度以及有限尺寸修正项的符号。将修正后的熵密度 $s_{\\text{corr}}/k_{\\text{B}}$ 的最终数值以无量纲数的形式报告，并将答案四舍五入到六位有效数字。",
            "solution": "该问题是有效的，因为它是统计力学中一个标准的、适定的问题，具有科学依据、客观且内部一致。\n\n该系统是一个替位二元合金，位于一个有 $N$ 个格点的晶格上，包含 $N_A$ 个 $A$ 种原子和 $N_B$ 个 $B$ 种原子。总格点数为 $N = N_A + N_B$。成分由摩尔分数 $x_A = N_A/N$ 和 $x_B = N_B/N = 1-x_A$ 给出。\n\n在 $N$ 个格点上排列 $N_A$ 个 $A$ 类原子的不同构型数 $\\Omega$ 由二项式系数给出：\n$$\n\\Omega = \\binom{N}{N_A} = \\frac{N!}{N_A! N_B!}\n$$\n微正则熵 $S$ 定义为 $S = k_{\\text{B}} \\ln \\Omega$，其中 $k_{\\text{B}}$ 是玻尔兹曼常数。\n$$\nS = k_{\\text{B}} (\\ln N! - \\ln N_A! - \\ln N_B!)\n$$\n为了对大量的原子进行计算，我们使用阶乘的渐近展开，通常称为 Stirling 近似。为了找到有限尺寸修正，我们必须使用比主导阶近似更精确的形式。我们使用：\n$$\n\\ln n! \\approx n \\ln n - n + \\frac{1}{2}\\ln(2\\pi n) + O(1/n)\n$$\n将此代入熵的表达式中：\n$$\n\\frac{S}{k_{\\text{B}}} \\approx \\left(N \\ln N - N + \\frac{1}{2}\\ln(2\\pi N)\\right) - \\left(N_A \\ln N_A - N_A + \\frac{1}{2}\\ln(2\\pi N_A)\\right) - \\left(N_B \\ln N_B - N_B + \\frac{1}{2}\\ln(2\\pi N_B)\\right)\n$$\n我们对各项进行分组。与粒子数成线性关系的项是：\n$$\n(N \\ln N - N) - (N_A \\ln N_A - N_A) - (N_B \\ln N_B - N_B)\n$$\n由于 $N = N_A + N_B$，线性项 $-N$、$-(-N_A)$ 和 $-(-N_B)$ 相互抵消。我们剩下：\n$$\nN \\ln N - N_A \\ln N_A - N_B \\ln N_B\n$$\n代入 $N_A = x_A N$ 和 $N_B = x_B N = (1-x_A)N$：\n$$\nN \\ln N - (x_A N) \\ln(x_A N) - (x_B N) \\ln(x_B N)\n$$\n$$\n= N \\ln N - x_A N (\\ln x_A + \\ln N) - x_B N (\\ln x_B + \\ln N)\n$$\n$$\n= N (\\ln N - x_A \\ln N - x_B \\ln N) - N(x_A \\ln x_A + x_B \\ln x_B)\n$$\n由于 $x_A + x_B = 1$，第一个括号内的表达式变为 $\\ln N - (x_A+x_B)\\ln N = \\ln N - \\ln N = 0$。这留下了对熵的主导贡献项：\n$$\nS_{\\text{thermo}} = -k_{\\text{B}} N (x_A \\ln x_A + x_B \\ln x_B)\n$$\n在热力学极限下（$N \\to \\infty$），熵密度 $s = S/N$ 为：\n$$\ns = \\frac{S_{\\text{thermo}}}{N} = -k_{\\text{B}} (x_A \\ln x_A + x_B \\ln x_B)\n$$\n现在，我们分析来自 Stirling 展开的修正项，我们将其记为 $\\Delta S$：\n$$\n\\frac{\\Delta S}{k_{\\text{B}}} = \\frac{1}{2}\\ln(2\\pi N) - \\frac{1}{2}\\ln(2\\pi N_A) - \\frac{1}{2}\\ln(2\\pi N_B)\n$$\n$$\n= \\frac{1}{2} [\\ln(2\\pi N) - \\ln(2\\pi N_A) - \\ln(2\\pi N_B)]\n$$\n$$\n= \\frac{1}{2} \\ln\\left(\\frac{2\\pi N}{(2\\pi N_A)(2\\pi N_B)}\\right) = \\frac{1}{2} \\ln\\left(\\frac{N}{2\\pi N_A N_B}\\right)\n$$\n代入 $N_A = x_A N$ 和 $N_B = x_B N$：\n$$\n\\frac{\\Delta S}{k_{\\text{B}}} = \\frac{1}{2} \\ln\\left(\\frac{N}{2\\pi (x_A N)(x_B N)}\\right) = \\frac{1}{2} \\ln\\left(\\frac{1}{2\\pi N x_A x_B}\\right) = -\\frac{1}{2} \\ln(2\\pi N x_A x_B)\n$$\n总的修正熵为 $S_{\\text{corr}} = S_{\\text{thermo}} + \\Delta S$。修正后的熵密度 $s_{\\text{corr}} = S_{\\text{corr}}/N$ 为：\n$$\ns_{\\text{corr}} = s + \\frac{\\Delta S}{N} = -k_{\\text{B}} (x_A \\ln x_A + x_B \\ln x_B) - \\frac{k_{\\text{B}}}{2N} \\ln(2\\pi N x_A x_B)\n$$\n无量纲的修正熵密度为：\n$$\n\\frac{s_{\\text{corr}}}{k_{\\text{B}}} = -(x_A \\ln x_A + x_B \\ln x_B) - \\frac{1}{2N} \\ln(2\\pi N x_A (1-x_A))\n$$\n有限尺寸修正项为 $\\Delta s/k_{\\text{B}} = -\\frac{1}{2N}\\ln(2\\pi N x_A(1-x_A))$。其符号由对数的参数决定。当二项式系数的高斯近似中平方根的参数很大时，即 $2\\pi N x_A(1-x_A) \\gg 1$，使用此修正是有效的。给定 $N=10^5$ 和 $x_A=0.01$，该参数为 $2\\pi(10^5)(0.01)(0.99) = 1980\\pi \\approx 6220$，远大于 $1$。因此，其对数为正。因此，整个修正项 $\\Delta s$ 是负的。这个负号表明，有限系统的熵低于简单热力学极限公式预测的值，该公式实际上高估了可用构型的数量。$x_A=0.01$ 的小值使合金处于一个低熵的成分区域，远离 $x_A=0.5$ 时的最大值。有限尺寸修正的大小取决于 $x_A(1-x_A)$，它也比等摩尔成分时的情况要小。\n\n我们现在计算给定参数下的修正熵密度：$N=10^5$ 且 $x_A=0.01$。因此，$x_B = 1 - 0.01 = 0.99$。\n需要计算的表达式是：\n$$\n\\frac{s_{\\text{corr}}}{k_{\\text{B}}} = -[0.01 \\ln(0.01) + 0.99 \\ln(0.99)] - \\frac{1}{2 \\times 10^5} \\ln(2\\pi \\times 10^5 \\times 0.01 \\times 0.99)\n$$\n首先，计算热力学项：\n$$\nT_1 = -[0.01 \\ln(0.01) + 0.99 \\ln(0.99)] \\approx -[0.01 \\times (-4.605170) + 0.99 \\times (-0.010050)]\n$$\n$$\nT_1 \\approx -[-0.0460517 - 0.0099495] = 0.0560012\n$$\n接下来，计算修正项：\n$$\nT_2 = -\\frac{1}{2 \\times 10^5} \\ln(1980\\pi) \\approx -\\frac{1}{2 \\times 10^5} \\ln(6220.353) \\approx -\\frac{8.735593}{2 \\times 10^5}\n$$\n$$\nT_2 \\approx -0.000043678\n$$\n以更高的精度将两项相加：\n$$\nT_1 \\approx 0.0560015344\n$$\n$$\nT_2 \\approx -0.0000436780\n$$\n$$\n\\frac{s_{\\text{corr}}}{k_{\\text{B}}} = T_1 + T_2 \\approx 0.0560015344 - 0.0000436780 = 0.0559578564\n$$\n四舍五入到六位有效数字，我们得到 $0.0559579$。",
            "answer": "$$\\boxed{0.0559579}$$"
        },
        {
            "introduction": "最后的练习将挑战您使用一种更普适和强大的计算方法来处理构型熵。我们不再假设一个固定的宏观组分，而是考虑一个与化学势库接触的系统，其组分本身会发生涨落。这个动手编程练习要求您从巨正则系综的视角出发，计算所有可能组分的概率分布，并利用香农熵（Shannon entropy）公式 $S = -k_{\\mathrm{B}} \\sum P \\ln P$ 来得到系统的总构型熵。 这项实践不仅能提升您的计算建模技能，还能加深您对涨落系统熵本质的理解。",
            "id": "3734828",
            "problem": "考虑一个与高熵合金（HEA）和复杂材料相关的多组分置换固溶体的晶格模型。该晶格有 $M$ 个位点，存在 $K$ 种化学上不同的物种，标记为 $i \\in \\{1,2,\\dots,K\\}$。每个晶格位点恰好被一个物种占据，$n_i$ 表示被物种 $i$ 占据的位点数，并满足约束条件 $\\sum_{i=1}^K n_i = M$。该系统与一个由化学势 $\\{\\mu_i\\}$ 和温度 $T$ 表征的热库接触。假设位点能量相等，且除了物种身份之外的相互作用可以忽略不计，因此唯一的能量驱动项是化学势。\n\n从巨正则系综（GCE）和晶格占据的基本组合数学出发，推导允许的向量 $\\{n_i\\}$ 上的成分分布 $P(\\{n_i\\})$，并用它来计算构型熵。构型熵定义为 $S = - k_{\\mathrm{B}} \\sum_{\\{n_i\\}} P(\\{n_i\\}) \\ln P(\\{n_i\\})$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。您必须以 $k_{\\mathrm{B}}$ 为单位表示最终结果，即，将 $S/k_{\\mathrm{B}}$ 作为无量纲实数报告。本问题不涉及角度。不涉及百分比。\n\n您的程序必须：\n- 枚举所有整数成分组合 $\\{n_i\\}$，使得每个 $n_i \\ge 0$ 且 $\\sum_{i=1}^K n_i = M$。\n- 使用与基本原理一致的GCE权重，即概率与能量除以 $k_{\\mathrm{B}} T$ 的指数成正比，并结合给定成分的构型组合多样性。\n- 对所有成分精确地（在数值精度范围内）归一化分布 $P(\\{n_i\\})$。\n- 通过求和 $- \\sum_{\\{n_i\\}} P(\\{n_i\\}) \\ln P(\\{n_i\\})$ 来精确计算 $S/k_{\\mathrm{B}}$。\n\n使用以电子伏特每开尔文为单位的玻尔兹曼常数，$k_{\\mathrm{B}} = 8.617333262145 \\times 10^{-5} \\,\\mathrm{eV/K}$，以及以电子伏特（eV）为单位的化学势 $\\mu_i$。温度 $T$ 的单位是开尔文（K）。参数 $M$ 是无量纲的。\n\n测试套件：\n针对以下情况评估 $S/k_{\\mathrm{B}}$。在所有情况下，都提供了 $M$、$K$、$\\{\\mu_i\\}$ 和 $T$，其中 $\\mu_i$ 的单位是电子伏特，$T$ 的单位是开尔文。\n\n- 案例 1：$M = 5$，$K = 3$，$\\{\\mu_i\\} = \\{0.2, 0.0, -0.1\\}$，$T = 1000$。\n- 案例 2：$M = 4$，$K = 3$，$\\{\\mu_i\\} = \\{0.0, 0.0, 0.0\\}$，$T = 1000$。\n- 案例 3：$M = 6$，$K = 3$，$\\{\\mu_i\\} = \\{1.0, -1.0, -1.0\\}$，$T = 300$。\n- 案例 4：$M = 1$，$K = 4$，$\\{\\mu_i\\} = \\{0.0, 0.0, 0.0, 0.0\\}$，$T = 500$。\n- 案例 5：$M = 7$，$K = 5$，$\\{\\mu_i\\} = \\{-0.05, 0.1, 0.0, 0.2, -0.15\\}$，$T = 1200$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容为按上述顺序列出的各案例的结果。例如，输出应类似于 $[s_1,s_2,s_3,s_4,s_5]$，其中每个 $s_j$ 是为案例 $j$ 计算出的 $S/k_{\\mathrm{B}}$ 的浮点数值。",
            "solution": "该问题经评估是有效的。它在科学上基于应用于材料科学的统计力学原理，特别是使用多组分合金的晶格模型。该问题是适定的，为得到唯一且有意义的解提供了所有必要的参数和定义。方法论已明确说明，且测试案例在计算上是可行的。\n\n任务是计算多组分系统中成分分布的构型熵。该量明确定义为 $S = - k_{\\mathrm{B}} \\sum_{\\{n_i\\}} P(\\{n_i\\}) \\ln P(\\{n_i\\})$，其中 $P(\\{n_i\\})$ 是发现系统处于具有特定成分向量 $\\{n_i\\} = (n_1, n_2, \\dots, n_K)$ 的状态的概率。该系统由 $M$ 个晶格位点组成，被 $K$ 个物种占据，总位点数固定为 $\\sum_{i=1}^K n_i = M$。系统的能量学由化学势 $\\{\\mu_i\\}$ 和温度 $T$ 决定。\n\n首先，我们推导概率分布 $P(\\{n_i\\})$。问题指导我们使用巨正则系综（GCE）框架。然而，总粒子数（或位点数）$M$ 是固定的。这种构型对应于半巨正则系综，其中粒子类型可以与热库交换，但总粒子数是守恒的。\n\n系统的哈密顿量被视为零，因为位点能量相等且没有相互作用。在存在化学势库的情况下，有效哈密顿量为 $H' = H - \\sum_{i=1}^K \\mu_i N_i = - \\sum_{i=1}^K \\mu_i N_i$，其中 $N_i$ 是物种 $i$ 的粒子数算符。\n\n配分函数 $Z$ 是对晶格所有可能的微观构型求和。一个微观态是对每个位点 $j \\in \\{1, \\dots, M\\}$ 指定一个物种 $s_j \\in \\{1, \\dots, K\\}$ 的特定分配。\n$$ Z = \\sum_{\\text{microstates}} \\exp\\left( - \\frac{H'}{k_{\\mathrm{B}} T} \\right) = \\sum_{s_1=1}^K \\dots \\sum_{s_M=1}^K \\exp\\left( \\frac{\\sum_{j=1}^M \\mu_{s_j}}{k_{\\mathrm{B}} T} \\right) $$\n由于位点是独立的，我们可以将求和分开：\n$$ Z = \\prod_{j=1}^M \\left( \\sum_{s_j=1}^K \\exp\\left( \\frac{\\mu_{s_j}}{k_{\\mathrm{B}} T} \\right) \\right) = \\left( \\sum_{i=1}^K \\exp\\left( \\frac{\\mu_i}{k_{\\mathrm{B}} T} \\right) \\right)^M $$\n我们定义单一位点配分函数 $z = \\sum_{i=1}^K \\exp\\left(\\frac{\\mu_i}{k_{\\mathrm{B}} T}\\right)$。那么 $Z = z^M$。\n设 $p_i$ 为一个给定位点被物种 $i$ 占据的概率。该概率由该物种的玻尔兹曼权重除以单一位点配分函数给出：\n$$ p_i = \\frac{\\exp\\left(\\frac{\\mu_i}{k_{\\mathrm{B}} T}\\right)}{z} = \\frac{\\exp\\left(\\frac{\\mu_i}{k_{\\mathrm{B}} T}\\right)}{\\sum_{k=1}^K \\exp\\left(\\frac{\\mu_k}{k_{\\mathrm{B}} T}\\right)} $$\n注意 $\\sum_{i=1}^K p_i = 1$。具有成分 $\\{n_i\\}$（即物种1有 $n_1$ 个粒子，物种2有 $n_2$ 个粒子，等等）的特定微观态的概率是每个位点概率的乘积，因为位点是独立的：$\\prod_{i=1}^K p_i^{n_i}$。\n\n问题要求的是成分 $\\{n_i\\}$ 本身的概率，这是一个宏观态。为求此概率，我们必须将具有该成分的一个微观态的概率乘以在晶格上排列粒子以实现该成分的方式数。这个组合因子是多项式系数，$\\Omega(\\{n_i\\}) = \\frac{M!}{n_1! n_2! \\dots n_K!}$。\n因此，成分的概率分布是多项式分布：\n$$ P(\\{n_i\\}) = \\frac{M!}{\\prod_{i=1}^K n_i!} \\prod_{i=1}^K p_i^{n_i} $$\n其中 $\\{n_i\\}$ 是任何满足 $\\sum_{i=1}^K n_i = M$ 的非负整数向量。\n\n最后一步是计算问题中定义的构型熵，$S/k_{\\mathrm{B}} = - \\sum_{\\{n_i\\}} P(\\{n_i\\}) \\ln P(\\{n_i\\})$。求和遍及所有可能的成分向量 $\\{n_i\\}$。\n\n计算的算法如下：\n1.  对每个测试案例，定义参数 $M$、$K$、$\\{\\mu_i\\}$ 和 $T$，以及 $k_{\\mathrm{B}}$ 的值。\n2.  生成所有唯一的整数成分组合 $\\{n_i\\}$，使得 $n_i \\ge 0$ 且 $\\sum_{i=1}^K n_i = M$。递归函数非常适合这种组合枚举。\n3.  计算单一位点概率 $\\{p_i\\}$。为确保数值稳定性，我们可以定义一个平移后的化学势集合 $\\mu'_i = \\mu_i - \\max(\\{\\mu_k\\})$。概率 $p_i$ 在此平移下是不变的：\n    $$ p_i = \\frac{\\exp\\left(\\frac{\\mu'_i}{k_{\\mathrm{B}} T}\\right)}{\\sum_{k=1}^K \\exp\\left(\\frac{\\mu'_k}{k_{\\mathrm{B}} T}\\right)} $$\n    这可以防止在计算指数时发生浮点数上溢。\n4.  对每个成分 $\\{n_i\\}$，计算其概率 $P(\\{n_i\\})$。为避免阶乘的上溢和概率乘积的下溢，最好先计算概率的对数：\n    $$ \\ln P(\\{n_i\\}) = \\ln(M!) - \\sum_{i=1}^K \\ln(n_i!) + \\sum_{i=1}^K n_i \\ln(p_i) $$\n    对数阶乘项 $\\ln(n!)$ 可以使用对数伽玛函数精确计算，$\\ln(n!) = \\text{gammaln}(n+1)$。从 $\\ln P(\\{n_i\\})$，我们可以得到 $P(\\{n_i\\}) = \\exp(\\ln P(\\{n_i\\}))$。\n5.  遍历所有成分，对每个成分计算 $-P(\\{n_i\\}) \\ln(P(\\{n_i\\}))$ 项并将其加到一个运行总和中。需要检查 $P(\\{n_i\\})  0$，因为在计算上，当 $P \\to 0$ 时，$P \\ln P \\to 0$。\n6.  最终的总和就是所求的 $S/k_{\\mathrm{B}}$ 值。\n对于给定的参数范围，此过程是精确且稳健的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gammaln\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n\n    k_B = 8.617333262145e-5  # Boltzmann constant in eV/K\n\n    test_cases = [\n        # Case 1: M = 5, K = 3, {mu_i} = {0.2, 0.0, -0.1}, T = 1000\n        {'M': 5, 'K': 3, 'mu': [0.2, 0.0, -0.1], 'T': 1000},\n        # Case 2: M = 4, K = 3, {mu_i} = {0.0, 0.0, 0.0}, T = 1000\n        {'M': 4, 'K': 3, 'mu': [0.0, 0.0, 0.0], 'T': 1000},\n        # Case 3: M = 6, K = 3, {mu_i} = {1.0, -1.0, -1.0}, T = 300\n        {'M': 6, 'K': 3, 'mu': [1.0, -1.0, -1.0], 'T': 300},\n        # Case 4: M = 1, K = 4, {mu_i} = {0.0, 0.0, 0.0, 0.0}, T = 500\n        {'M': 1, 'K': 4, 'mu': [0.0, 0.0, 0.0, 0.0], 'T': 500},\n        # Case 5: M = 7, K = 5, {mu_i} = {-0.05, 0.1, 0.0, 0.2, -0.15}, T = 1200\n        {'M': 7, 'K': 5, 'mu': [-0.05, 0.1, 0.0, 0.2, -0.15], 'T': 1200},\n    ]\n\n    def generate_compositions(m, k):\n        \"\"\"\n        Recursively generates all integer compositions of m into k parts.\n        A composition is a tuple (n_1, n_2, ..., n_k) such that sum(n_i) = m.\n        \"\"\"\n        if k == 1:\n            yield (m,)\n            return\n        for i in range(m + 1):\n            for comp in generate_compositions(m - i, k - 1):\n                yield (i,) + comp\n\n    def calculate_entropy(M, K, mu, T):\n        \"\"\"\n        Calculates the configurational entropy S/k_B for a given set of parameters.\n        \"\"\"\n        beta = 1.0 / (k_B * T)\n        mu_np = np.array(mu, dtype=np.float64)\n\n        # Numerically stable calculation of single-site probabilities p_i\n        mu_max = np.max(mu_np)\n        exp_terms = np.exp(beta * (mu_np - mu_max))\n        Z_site = np.sum(exp_terms)\n        p = exp_terms / Z_site\n        \n        # Handle cases where p_i can be zero to avoid log(0)\n        log_p = np.full_like(p, -np.inf)\n        non_zero_mask = p > 0\n        log_p[non_zero_mask] = np.log(p[non_zero_mask])\n\n        compositions = list(generate_compositions(M, K))\n        \n        total_entropy = 0.0\n        log_M_factorial = gammaln(M + 1)\n\n        for comp in compositions:\n            n = np.array(comp, dtype=np.int64)\n            \n            # Calculate log-probability of the composition\n            log_sum_n_factorial = np.sum(gammaln(n + 1))\n            log_p_terms = np.sum(n * log_p)\n            \n            log_P = log_M_factorial - log_sum_n_factorial + log_p_terms\n            \n            # Check for -inf which results from a_i * log(0) where a_i > 0\n            if log_P == -np.inf:\n                continue\n\n            P = np.exp(log_P)\n\n            # The term P * log(P) = 0 if P = 0.\n            if P > 0:\n                total_entropy -= P * log_P\n        \n        return total_entropy\n\n    results = []\n    for case in test_cases:\n        result = calculate_entropy(case['M'], case['K'], case['mu'], case['T'])\n        results.append(f\"{result:.10f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}