{
    "hands_on_practices": [
        {
            "introduction": "理想固溶体模型是理解多组分合金（如高熵合金）热力学行为的基石。本练习将指导你从统计力学的最基本定义出发，通过对微观构型进行组合计数，推导出宏观的理想混合自由能表达式。这个从第一性原理出发的推导，是连接微观态与宏观热力学函数的核心技能，对于理解合金中的熵驱动力至关重要。",
            "id": "3731439",
            "problem": "考虑一种代表高熵合金（HEA）的多组分置换合金，其模型为一个具有 $N$ 个固定格点且无空位的刚性晶格。系统中有 $K$ 种化学物种，其组分由 $\\mathbf{n} = (n_1,\\dots,n_K)$ 指定，且满足 $\\sum_{i=1}^{K} n_i = N$。假设如下：\n- 晶格是刚性的，因此唯一的自由度是 $K$ 种物种对 $N$ 个晶格格点的占据情况。\n- 同一物种的所有原子是不可区分的，而所有晶格格点是可区分的。\n- 物种间的相互作用能为零，因此构型能与占据情况无关；将此恒定能量记为 $E_0(\\mathbf{n},V)$，它可能依赖于 $\\mathbf{n}$ 和体积 $V$，但与物种在晶格上的具体排列方式无关。\n\n在正则系综中进行分析，逆温度为 $\\beta = 1/(k_B T)$，并固定体积 $V$ 和组分 $\\mathbf{n}$。仅从正则配分函数和组合计数的基本定义出发，不引用任何预先推导出的混合公式，完成以下任务：\n1. 通过对所有与组分 $\\mathbf{n}$ 一致的多体微观态求和，计算正则配分函数 $Z(\\beta,V,\\mathbf{n})$。\n2. 根据你得到的 $Z(\\beta,V,\\mathbf{n})$ 结果，使用定义 $F(\\beta,V,\\mathbf{n}) = -k_B T \\ln Z(\\beta,V,\\mathbf{n})$ 和热力学极限近似，推导出刚性晶格理想溶液的理想构型亥姆霍兹自由能，\n$$\nF_{\\mathrm{conf}}(\\beta,V,\\mathbf{n}) = k_B T \\sum_{i=1}^{K} n_i \\ln\\!\\left(\\frac{n_i}{N}\\right)\n$$\n结果可忽略不随 N 广延标度的附加项以及与排列无关的恒定能量偏移。\n\n答案格式要求：提供 $Z(\\beta,V,\\mathbf{n})$ 的单个闭合形式解析表达式。最终答案中不要包含单位。不需要进行数值取整。",
            "solution": "此问题经评估有效。这是一个提法恰当、有科学依据的基础统计力学练习，使用了标准的理想溶液模型，该模型是研究复杂合金的常见起点。问题陈述客观、自洽且无矛盾。其假设和目标都得到了清晰的阐明，从而可以进行严谨且明确的数学推导。\n\n第一个任务是计算正则配分函数 $Z(\\beta,V,\\mathbf{n})$。根据定义，正则配分函数是系统所有不同微观态 $\\nu$ 的玻尔兹曼因子的总和：\n$$ Z(\\beta,V,\\mathbf{n}) = \\sum_{\\nu} \\exp(-\\beta E_{\\nu}) $$\n其中 $\\beta = 1/(k_B T)$ 是逆温度，$E_{\\nu}$ 是微观态 $\\nu$ 的能量。\n\n对于给定系统，一个微观态是指固定数量的各物种原子 $\\mathbf{n} = (n_1, \\dots, n_K)$ 在 $N$ 个可区分晶格格点上的一种特定排列。问题指定了刚性晶格理想溶液模型，其中物种间的相互作用能为零。这个关键假设意味着系统的总构型能与原子的具体排列方式无关。因此，对于所有与组分 $\\mathbf{n}$ 和体积 $V$ 一致的微观态，其能量 $E_{\\nu}$ 都是相同的。我们将这个恒定能量记为 $E_0(\\mathbf{n},V)$。\n\n因此，配分函数表达式可以简化。由于项 $\\exp(-\\beta E_0(\\mathbf{n},V))$ 对所有微观态都是常数，因此可以将其从求和中提取出来：\n$$ Z(\\beta,V,\\mathbf{n}) = \\sum_{\\nu} \\exp(-\\beta E_0(\\mathbf{n},V)) = \\exp(-\\beta E_0(\\mathbf{n},V)) \\sum_{\\nu} 1 $$\n求和项 $\\sum_{\\nu} 1$ 表示不同微观态的总数，或称为构型简并度，我们记为 $\\Omega(\\mathbf{n})$。这是一个组合问题：在满足约束条件 $\\sum_{i=1}^{K} n_i = N$ 的情况下，求将 $n_1$ 个不可区分的物种1原子，$n_2$ 个物种2原子，...，以及 $n_K$ 个物种K原子排列在 $N$ 个可区分晶格格点上的方法数。\n\n这个数目由多项式系数给出。我们可以通过考虑原子的顺序放置来确定它。有 $\\binom{N}{n_1}$ 种方式为物种1的 $n_1$ 个原子选择格点。此后，剩下 $N-n_1$ 个格点，因此有 $\\binom{N-n_1}{n_2}$ 种方式放置物种2的 $n_2$ 个原子。对所有物种重复此过程。总方法数是这些方式的乘积：\n$$ \\Omega(\\mathbf{n}) = \\binom{N}{n_1} \\binom{N-n_1}{n_2} \\cdots \\binom{N - \\sum_{j=1}^{K-1} n_j}{n_K} = \\frac{N!}{n_1!(N-n_1)!} \\frac{(N-n_1)!}{n_2!(N-n_1-n_2)!} \\cdots \\frac{n_K!}{n_K!(0)!} $$\n消去各项后，表达式简化为：\n$$ \\Omega(\\mathbf{n}) = \\frac{N!}{n_1! n_2! \\cdots n_K!} = \\frac{N!}{\\prod_{i=1}^{K} n_i!} $$\n将此代入 $Z$ 的表达式，我们得到正则配分函数：\n$$ Z(\\beta,V,\\mathbf{n}) = \\frac{N!}{\\prod_{i=1}^{K} n_i!} \\exp(-\\beta E_0(\\mathbf{n},V)) $$\n这是问题第一部分的答案。\n\n第二个任务是利用关系式 $F = -k_B T \\ln Z$ 从 $Z$ 推导出理想构型亥姆霍兹自由能 $F_{\\mathrm{conf}}$。\n$$ F(\\beta,V,\\mathbf{n}) = -k_B T \\ln \\left( \\frac{N!}{\\prod_{i=1}^{K} n_i!} \\exp(-\\beta E_0) \\right) = -k_B T \\left[ \\ln\\left(\\frac{N!}{\\prod_{i=1}^{K} n_i!}\\right) - \\beta E_0 \\right] $$\n$$ F = -k_B T \\left( \\ln(N!) - \\sum_{i=1}^{K} \\ln(n_i!) \\right) + E_0(\\mathbf{n},V) $$\n自由能由能量部分 $E_0$ 和构型部分 $F_{\\mathrm{conf}}$ 组成，后者源于混合熵。\n$$ F_{\\mathrm{conf}} = -k_B T \\left( \\ln(N!) - \\sum_{i=1}^{K} \\ln(n_i!) \\right) $$\n在热力学极限下（$N, n_i \\to \\infty$ 且比率 $n_i/N$ 固定），我们可以应用Stirling近似 $\\ln(m!) \\approx m \\ln(m) - m$。该近似对大的 $m$ 有效，并能捕捉其主要的广延行为。\n$$ F_{\\mathrm{conf}} \\approx -k_B T \\left[ (N \\ln N - N) - \\sum_{i=1}^{K} (n_i \\ln n_i - n_i) \\right] $$\n$$ F_{\\mathrm{conf}} \\approx -k_B T \\left[ N \\ln N - N - \\sum_{i=1}^{K} n_i \\ln n_i + \\sum_{i=1}^{K} n_i \\right] $$\n根据约束条件 $\\sum_{i=1}^{K} n_i = N$，项 $-N$ 和 $\\sum_{i=1}^{K} n_i$ 相互抵消。\n$$ F_{\\mathrm{conf}} \\approx -k_B T \\left( N \\ln N - \\sum_{i=1}^{K} n_i \\ln n_i \\right) = k_B T \\left( \\sum_{i=1}^{K} n_i \\ln n_i - N \\ln N \\right) $$\n为了得到最终的目标形式，我们代入 $N \\ln N = (\\sum_{i=1}^{K} n_i) \\ln N = \\sum_{i=1}^{K} (n_i \\ln N)$。\n$$ F_{\\mathrm{conf}} \\approx k_B T \\left( \\sum_{i=1}^{K} n_i \\ln n_i - \\sum_{i=1}^{K} n_i \\ln N \\right) = k_B T \\sum_{i=1}^{K} (n_i \\ln n_i - n_i \\ln N) $$\n使用对数恒等式 $\\ln a - \\ln b = \\ln(a/b)$：\n$$ F_{\\mathrm{conf}} = k_B T \\sum_{i=1}^{K} n_i \\ln\\left(\\frac{n_i}{N}\\right) $$\n这个表达式就是理想构型混合自由能，它是按照要求从第一性原理推导出来的。所做的近似与问题中忽略非广延项的指令是一致的。",
            "answer": "$$\\boxed{\\frac{N!}{\\prod_{i=1}^{K} n_i!} \\exp(-\\beta E_0(\\mathbf{n}, V))}$$"
        },
        {
            "introduction": "真实的合金体系，尤其是金属间化合物，通常表现出化学有序结构，而非完全随机混合。本练习将我们从简单的理想模型推进到更复杂的B2有序结构，引入了亚晶格和反位缺陷等关键概念。通过计算构型熵随缺陷浓度的变化，我们可以量化无序度对有序合金热力学性质的影响，这对于研究高熵合金中可能存在的短程或长程有序现象具有重要意义。",
            "id": "3731451",
            "problem": "考虑一个具有立方B2（氯化铯型）长程有序的等原子二元合金，它由两个相互贯穿的亚晶格（表示为 $\\alpha$ 和 $\\beta$）组成，每个亚晶格包含 $N/2$ 个晶格位置，总共有 $N$ 个位置。在完全有序状态下，组元 $A$ 占据 $\\alpha$ 亚晶格，组元 $B$ 占据 $\\beta$ 亚晶格。在表现出B2有序的高熵合金（HEA）或复杂合金中，可能存在反位缺陷：反位缺陷是指相对于理想有序，一个晶格位置被“错误”的组元占据（例如，$\\alpha$ 位置上的 $B$ 原子或 $\\beta$ 位置上的 $A$ 原子）。假设该合金是等原子的，并严格保持其化学计量比，因此反位缺陷成对出现，并且 $\\alpha$ 亚晶格上错误组元的分数等于 $\\beta$ 亚晶格上错误组元的分数。用 $c \\in [0,1]$ 表示总反位缺陷浓度，其定义为所有 $N$ 个位置中被错误组元占据的分数。\n\n使用构型熵的微正则系综定义和微观态的组合计数，推导在热力学极限下，每个晶格位置的构型熵 $s(c) \\equiv S/N$ 作为反位缺陷浓度 $c$ 的函数的精确主导阶表达式。将反位缺陷视为无相互作用，并忽略任何对熵的振动、电子或弹性贡献。将 $s(c)/k_B$ 的最终答案表示为一个闭式解析表达式，其中 $k_B$ 是玻尔兹曼常数（不要转换为焦耳/开尔文）。不需要数值取整。",
            "solution": "问题要求计算等原子B2有序二元合金中，每个晶格位置的构型熵 $s(c) \\equiv S/N$ 作为反位缺陷浓度 $c$ 的函数。我们将使用熵的微正则系综定义 $S = k_B \\ln W$，其中 $W$ 是由 $c$ 定义的给定宏观态下可及微观态（构型）的总数。假设处于热力学极限（$N \\to \\infty$）。\n\n首先，我们来确定每个亚晶格上各种类原子的数量。系统共有 $N$ 个晶格位置，分为两个相互贯穿的亚晶格 $\\alpha$ 和 $\\beta$，每个亚晶格有 $N/2$ 个位置。该合金是等原子的，因此总共有 $N/2$ 个 $A$ 原子和 $N/2$ 个 $B$ 原子。\n\n反位缺陷浓度 $c$ 定义为所有 $N$ 个位置中被“错误”组元占据的分数。因此，具有反位缺陷的位置总数为 $cN$。由于等原子化学计量比以及反位缺陷成对出现（一个 $A$ 在 $\\beta$ 上，一个 $B$ 在 $\\alpha$ 上）的要求，$\\alpha$ 亚晶格上的 $B$ 原子数 $N_{B}^{\\alpha}$ 必须等于 $\\beta$ 亚晶格上的 $A$ 原子数 $N_{A}^{\\beta}$。\n错误原子的总数为 $N_{B}^{\\alpha} + N_{A}^{\\beta} = cN$。\n由此，我们推断出：\n$N_{B}^{\\alpha} = N_{A}^{\\beta} = \\frac{cN}{2}$。\n\n现在我们可以确定每个亚晶格上“正确”原子的数量。\n在 $\\alpha$ 亚晶格上，总位置数为 $N/2$。此亚晶格上的 $A$ 原子数为：\n$N_{A}^{\\alpha} = (\\alpha \\text{ 亚晶格总位置数}) - N_{B}^{\\alpha} = \\frac{N}{2} - \\frac{cN}{2} = \\frac{(1-c)N}{2}$。\n\n在 $\\beta$ 亚晶格上，总位置数为 $N/2$。此亚晶格上的 $B$ 原子数为：\n$N_{B}^{\\beta} = (\\beta \\text{ 亚晶格总位置数}) - N_{A}^{\\beta} = \\frac{N}{2} - \\frac{cN}{2} = \\frac{(1-c)N}{2}$。\n\n微观态总数 $W$ 是在 $\\alpha$ 亚晶格上排列原子的方式数 $W_{\\alpha}$ 与在 $\\beta$ 亚晶格上排列原子的方式数 $W_{\\beta}$ 的乘积，因为在给定各组元数量的情况下，两个亚晶格上的排列是独立的。\n\n对于 $\\alpha$ 亚晶格，我们需要从总共 $N/2$ 个位置中选择 $N_{B}^{\\alpha}$ 个位置来放置 $B$ 原子。其方式数由二项式系数给出：\n$$W_{\\alpha} = \\binom{N/2}{N_{B}^{\\alpha}} = \\binom{N/2}{cN/2} = \\frac{(N/2)!}{(cN/2)! (N/2 - cN/2)!} = \\frac{(N/2)!}{(cN/2)! ((1-c)N/2)!}$$\n\n对于 $\\beta$ 亚晶格，我们需要从总共 $N/2$ 个位置中选择 $N_{A}^{\\beta}$ 个位置来放置 $A$ 原子。其方式数为：\n$$W_{\\beta} = \\binom{N/2}{N_{A}^{\\beta}} = \\binom{N/2}{cN/2} = \\frac{(N/2)!}{(cN/2)! ((1-c)N/2)!}$$\n\n微观态总数是 $W = W_{\\alpha} W_{\\beta}$：\n$$W = \\left[ \\frac{(N/2)!}{(cN/2)! ((1-c)N/2)!} \\right]^2$$\n\n构型熵为 $S = k_B \\ln W$：\n$$S = k_B \\ln \\left( \\left[ \\frac{(N/2)!}{(cN/2)! ((1-c)N/2)!} \\right]^2 \\right) = 2 k_B \\ln \\left( \\frac{(N/2)!}{(cN/2)! ((1-c)N/2)!} \\right)$$\n使用对数性质 $\\ln(a/b) = \\ln(a) - \\ln(b)$：\n$$S = 2 k_B \\left[ \\ln\\left(\\left(\\frac{N}{2}\\right)!\\right) - \\ln\\left(\\left(\\frac{cN}{2}\\right)!\\right) - \\ln\\left(\\left(\\frac{(1-c)N}{2}\\right)!\\right) \\right]$$\n\n为了在热力学极限下计算此式，我们使用阶乘自然对数的斯特林近似 $\\ln(n!) \\approx n \\ln(n) - n$，该近似在 $n$ 很大时是精确的。\n将此近似应用于每一项：\n$\\ln\\left(\\left(\\frac{N}{2}\\right)!\\right) \\approx \\frac{N}{2} \\ln\\left(\\frac{N}{2}\\right) - \\frac{N}{2}$\n$\\ln\\left(\\left(\\frac{cN}{2}\\right)!\\right) \\approx \\frac{cN}{2} \\ln\\left(\\frac{cN}{2}\\right) - \\frac{cN}{2}$\n$\\ln\\left(\\left(\\frac{(1-c)N}{2}\\right)!\\right) \\approx \\frac{(1-c)N}{2} \\ln\\left(\\frac{(1-c)N}{2}\\right) - \\frac{(1-c)N}{2}$\n\n将这些代入 $S$ 的表达式中：\n$$S \\approx 2 k_B \\left[ \\left(\\frac{N}{2} \\ln\\left(\\frac{N}{2}\\right) - \\frac{N}{2}\\right) - \\left(\\frac{cN}{2} \\ln\\left(\\frac{cN}{2}\\right) - \\frac{cN}{2}\\right) - \\left(\\frac{(1-c)N}{2} \\ln\\left(\\frac{(1-c)N}{2}\\right) - \\frac{(1-c)N}{2}\\right) \\right]$$\n对数之外的 $N$ 的线性项相互抵消：$-\\frac{N}{2} - (-\\frac{cN}{2}) - (-\\frac{(1-c)N}{2}) = \\frac{N}{2} (-1 + c + (1-c)) = 0$。\n表达式简化为：\n$$S \\approx 2 k_B \\left[ \\frac{N}{2} \\ln\\left(\\frac{N}{2}\\right) - \\frac{cN}{2} \\ln\\left(\\frac{cN}{2}\\right) - \\frac{(1-c)N}{2} \\ln\\left(\\frac{(1-c)N}{2}\\right) \\right]$$\n提出公因子 $N/2$：\n$$S \\approx N k_B \\left[ \\ln\\left(\\frac{N}{2}\\right) - c \\ln\\left(\\frac{cN}{2}\\right) - (1-c) \\ln\\left(\\frac{(1-c)N}{2}\\right) \\right]$$\n使用对数性质 $\\ln(xy) = \\ln(x) + \\ln(y)$：\n$$S \\approx N k_B \\left[ \\ln\\left(\\frac{N}{2}\\right) - c\\left(\\ln(c) + \\ln\\left(\\frac{N}{2}\\right)\\right) - (1-c)\\left(\\ln(1-c) + \\ln\\left(\\frac{N}{2}\\right)\\right) \\right]$$\n$$S \\approx N k_B \\left[ \\ln\\left(\\frac{N}{2}\\right) - c\\ln(c) - c\\ln\\left(\\frac{N}{2}\\right) - (1-c)\\ln(1-c) - (1-c)\\ln\\left(\\frac{N}{2}\\right) \\right]$$\n合并含有 $\\ln(N/2)$ 的项：\n$$S \\approx N k_B \\left[ \\ln\\left(\\frac{N}{2}\\right)(1-c-(1-c)) - c\\ln(c) - (1-c)\\ln(1-c) \\right]$$\n$\\ln(N/2)$ 项的系数是 $1-c-1+c = 0$，所以该项消失。\n我们剩下：\n$$S \\approx N k_B \\left[ -c\\ln(c) - (1-c)\\ln(1-c) \\right]$$\n问题要求的是每个晶格位置的构型熵 $s(c) = S/N$。将表达式除以 $N$：\n$$s(c) = \\frac{S}{N} = k_B \\left[ -c\\ln(c) - (1-c)\\ln(1-c) \\right]$$\n最后，我们将结果表示为 $s(c)/k_B$：\n$$\\frac{s(c)}{k_B} = -c\\ln(c) - (1-c)\\ln(1-c)$$\n此表达式代表了两个亚晶格中每一个的混合熵。对于亚晶格上固定浓度为 $c$ 的“错误”类型原子，熵具有此形式。由于相对于理想占据者，两个亚晶格都具有相同浓度 $c$ 的错位原子，因此系统的每个位置的总熵由该表达式给出。需要注意的是，这个最终表达式中的参数 $c$ 是*在给定亚晶格上*错误原子的分数，这对应于问题中定义的*总*反位缺陷分数 $c$，这是因为 $c$ 的定义方式以及它与亚晶格布居数关联的特定方式。如果 $c_{sublattice}$ 是一个亚晶格上错误位置的分数，那么 $c_{sublattice} = (cN/2)/(N/2) = c$。因此，我的推导是一致的。",
            "answer": "$$\\boxed{-c\\ln(c) - (1-c)\\ln(1-c)}$$"
        },
        {
            "introduction": "对于大多数现实中的复杂合金，解析求解其统计力学性质是不可能的，因此我们必须依赖于蒙特卡洛等计算机模拟方法。本练习聚焦于计算材料建模中的一个关键实践环节：如何正确地分析模拟输出数据。它探讨了模拟产生的时间序列数据中存在的自相关性问题，并介绍了块平均法这一稳健的技术，用于准确估计系综平均值的统计误差。",
            "id": "3731414",
            "problem": "在温度 $T$ 和化学势差 $\\Delta \\mu_{\\alpha\\beta}$ 条件下，对一种五元高熵合金（HEA）进行的半大正则系综（SGC）蒙特卡洛（MC）模拟，生成了一个用于测量短程有序的标量可观测量 $X$ 的平稳、遍历时间序列 $\\{X_t\\}_{t=1}^N$。在 SGC 系综中，一个能量为 $E$、各组分粒子数为 $\\{N_\\alpha\\}$ 的微观态出现的概率正比于 $\\exp\\left[-\\beta\\left(E - \\sum_\\alpha \\mu_\\alpha N_\\alpha\\right)\\right]$，其中 $\\beta = 1/(k_\\mathrm{B} T)$，$k_\\mathrm{B}$ 是玻尔兹曼常数，$\\mu_\\alpha$ 是各组分的化学势。系综平均 $\\langle X \\rangle$ 是 $X$ 在该分布下的期望值。在 MC 马尔可夫链满足平稳性和遍历性的条件下，时间平均 $\\bar{X} = \\frac{1}{N}\\sum_{t=1}^N X_t$ 是 $\\langle X \\rangle$ 的一个一致估计量。\n\n现有一次包含 $N = 4\\times 10^5$ 个样本的长时间生产性模拟。原始时间序列的样本方差为 $s^2 = 0.25$，其归一化自相关函数近似以 $\\rho(k) \\approx \\exp(-k/\\tau_\\mathrm{exp})$ 的形式指数衰减，特征时间为 $\\tau_\\mathrm{exp} = 40$ 个 MC 扫描步。为了从该相关时间序列中估计 $\\bar{X}$ 的统计误差，你考虑采用分块平均法：将轨迹划分为 $M$ 个长度为 $b$ 的连续数据块，计算数据块均值 $Y_j = \\frac{1}{b}\\sum_{t=(j-1)b+1}^{jb} X_t$（其中 $j=1,\\dots,M$），并用它们来估计 $\\bar{X}$ 的不确定度。选择 $b = 400$，得到 $M = N/b = 1000$ 个数据块。\n\n使用现有数据和假设，下列哪种方法能正确估计系综平均 $\\langle X \\rangle$ 的标准误差？请选择所有适用项。数值可以假定为输入所隐含的精度。\n\nA. 将样本视为独立样本，使用 $\\mathrm{SE} = \\sqrt{s^2/N} \\approx 7.9\\times 10^{-4}$。\n\nB. 计算数据块均值 $\\{Y_j\\}$ 的样本方差 $s_b^2$，并估计 $\\mathrm{SE} = \\sqrt{s_b^2/M}$。对于给定的指数自相关和足够大的 $b$，该方法得出 $\\mathrm{SE} \\approx \\sqrt{\\left(s^2 \\cdot 2\\tau_\\mathrm{int}/b\\right)/M} \\approx 7.1\\times 10^{-3}$。\n\nC. 使用数据块均值的方差，并估计 $\\mathrm{SE} = \\sqrt{s_b^2/b} \\approx 1.12\\times 10^{-2}$。\n\nD. 从指数尾部估计积分自相关时间（IAT）$\\tau_\\mathrm{int}$ 为 $\\tau_\\mathrm{int} \\approx \\tau_\\mathrm{exp}$，并计算 $\\mathrm{SE} = \\sqrt{2 \\tau_\\mathrm{int} s^2 / N} \\approx 7.1\\times 10^{-3}$。\n\nE. 增加数据块大小 $b$ 以使误差按 $\\mathrm{SE} \\sim 1/b$ 的关系减小，并对所选的 $b$ 使用 $\\mathrm{SE} = \\sqrt{s^2/b} \\approx 2.5\\times 10^{-2}$。",
            "solution": "我们从半大正则系综（SGC）的统计力学定义出发。在 SGC 系综中，一个微观态的概率正比于 $\\exp\\left[-\\beta\\left(E - \\sum_\\alpha \\mu_\\alpha N_\\alpha\\right)\\right]$，一个可观测量 $X$ 的系综平均为 $\\langle X \\rangle = \\sum_{\\text{states}} X\\, P_\\mathrm{SGC}(\\text{state})$。一个为满足 SGC 分布的细致平衡和遍历性而构造的蒙特卡洛（MC）马尔可夫链将是平稳的；在遍历性条件下，时间平均 $\\bar{X} = \\frac{1}{N}\\sum_{t=1}^N X_t$ 是 $\\langle X \\rangle$ 的一个一致估计量。\n\n对于相关数据，决定 $\\bar{X}$ 不确定度的基本量是自协方差函数 $C(k) = \\mathrm{Cov}(X_t, X_{t+k})$ 及其归一化形式 $\\rho(k) = C(k)/C(0)$，其中 $C(0) = \\sigma^2$ 是 $X_t$ 的真实方差。对于一个平稳过程，样本均值的方差为\n$$\n\\mathrm{Var}(\\bar{X}) = \\frac{1}{N^2} \\sum_{t=1}^N \\sum_{u=1}^N \\mathrm{Cov}(X_t,X_u) \n= \\frac{1}{N} \\sigma^2 \\left[ 1 + 2 \\sum_{k=1}^{N-1} \\left(1 - \\frac{k}{N}\\right) \\rho(k) \\right].\n$$\n在大 $N$ 极限下，且 $\\rho(k)$ 随 $k$ 衰减，该式可简化为\n$$\n\\mathrm{Var}(\\bar{X}) \\approx \\frac{\\sigma^2}{N} \\cdot 2 \\tau_\\mathrm{int},\n$$\n其中积分自相关时间（IAT）定义为\n$$\n\\tau_\\mathrm{int} = \\frac{1}{2} + \\sum_{k=1}^{\\infty} \\rho(k).\n$$\n对于指数形式的归一化自相关 $\\rho(k) = \\exp(-k/\\tau_\\mathrm{exp})$，该求和是一个几何级数，\n$$\n\\sum_{k=1}^{\\infty} \\exp\\left(-\\frac{k}{\\tau_\\mathrm{exp}}\\right) = \\frac{1}{\\exp\\left(\\frac{1}{\\tau_\\mathrm{exp}}\\right) - 1}.\n$$\n因此，\n$$\n\\tau_\\mathrm{int} = \\frac{1}{2} + \\frac{1}{\\exp\\left(\\frac{1}{\\tau_\\mathrm{exp}}\\right) - 1}.\n$$\n当 $\\tau_\\mathrm{exp} = 40$ 时，$\\exp\\left(\\frac{1}{40}\\right) \\approx 1.0253$，所以 $\\frac{1}{\\exp\\left(\\frac{1}{40}\\right) - 1} \\approx \\frac{1}{0.0253} \\approx 39.5$，且 $\\tau_\\mathrm{int} \\approx 39.5 + 0.5 \\approx 40.0$。这证明了当 $\\tau_\\mathrm{exp}$ 远大于 1 时，常用的近似 $\\tau_\\mathrm{int} \\approx \\tau_\\mathrm{exp}$ 是合理的。\n\n代入后，$\\bar{X}$ 的标准误差（SE）为\n$$\n\\mathrm{SE} = \\sqrt{\\mathrm{Var}(\\bar{X})} \\approx \\sqrt{\\frac{2 \\tau_\\mathrm{int} \\sigma^2}{N}}.\n$$\n在实践中，$\\sigma^2$ 用样本方差 $s^2$ 来估计，而 $\\tau_\\mathrm{int}$ 则通过样本自相关或使用指数拟合来估计。当 $s^2 = 0.25$，$N = 4\\times 10^5$，$\\tau_\\mathrm{int} \\approx 40$ 时，我们得到\n$$\n\\mathrm{SE} \\approx \\sqrt{\\frac{2 \\cdot 40 \\cdot 0.25}{4\\times 10^5}} = \\sqrt{\\frac{20}{4\\times 10^5}} = \\sqrt{5\\times 10^{-5}} \\approx 7.07 \\times 10^{-3}.\n$$\n\n分块平均法可以在不直接对自相关求和的情况下推导出相同的结果。定义长度为 $b$ 的数据块和数据块均值 $Y_j = \\frac{1}{b}\\sum_{t=(j-1)b+1}^{jb} X_t$，$j=1,\\dots,M$，其中 $M = N/b$。当 $b \\gg \\tau_\\mathrm{int}$ 时，数据块均值 $\\{Y_j\\}$ 近似独立同分布，其方差为\n$$\n\\mathrm{Var}(Y_j) \\approx \\frac{\\sigma^2}{b} \\left[1 + 2 \\sum_{k=1}^{\\infty} \\rho(k)\\right] = \\frac{\\sigma^2}{b} \\cdot 2 \\tau_\\mathrm{int}.\n$$\n因此，总均值 $\\bar{X} = \\frac{1}{M} \\sum_{j=1}^M Y_j$ 的方差是\n$$\n\\mathrm{Var}(\\bar{X}) = \\frac{1}{M^2} \\sum_{j=1}^M \\mathrm{Var}(Y_j) \\approx \\frac{1}{M} \\cdot \\frac{\\sigma^2}{b} \\cdot 2 \\tau_\\mathrm{int} = \\frac{\\sigma^2}{N} \\cdot 2 \\tau_\\mathrm{int},\n$$\n与基于自相关的表达式一致。实际的估计量是计算数据块均值的样本方差 $s_b^2$ 并使用\n$$\n\\widehat{\\mathrm{SE}} = \\sqrt{\\frac{s_b^2}{M}},\n$$\n前提是 $b$ 足够大，以至于数据块之间可以视为有效独立。如果希望对指数形式的 $\\rho$ 进行参数一致性检验，那么 $s_b^2 \\approx s^2 \\cdot 2 \\tau_\\mathrm{int}/b$ 且 $\\sqrt{s_b^2/M} \\approx \\sqrt{(s^2 \\cdot 2\\tau_\\mathrm{int}/b)/M}$。\n\n根据 $b = 400$，$M = 1000$ 和上述参数，\n$$\ns_b^2 \\approx \\frac{0.25 \\cdot 2 \\cdot 40}{400} = \\frac{20}{400} = 0.05,\n$$\n且\n$$\n\\sqrt{\\frac{s_b^2}{M}} = \\sqrt{\\frac{0.05}{1000}} = \\sqrt{5\\times 10^{-5}} \\approx 7.07 \\times 10^{-3},\n$$\n与积分自相关时间方法的结果相匹配。\n\n现在我们来评估每个选项：\n\nA. $\\mathrm{SE} = \\sqrt{s^2/N}$ 假定样本是独立的（即 $\\tau_\\mathrm{int} = 1/2$）。对于 $\\tau_\\mathrm{int} \\gg 1$ 的相关 MC 时间序列，这会低估真实的不确定度。数值上，$\\sqrt{0.25/(4\\times 10^5)} = \\sqrt{6.25\\times 10^{-7}} \\approx 7.9\\times 10^{-4}$，这个值太小了，大约是真实值的 1/9。结论：不正确。\n\nB. 当 $b \\gg \\tau_\\mathrm{int}$ 时，使用数据块均值并估计 $\\mathrm{SE} = \\sqrt{s_b^2/M}$ 是标准的分块平均估计方法，它源于将数据块视为独立。在给定假设下，它能重现 $\\mathrm{Var}(\\bar{X}) = (\\sigma^2/N)\\cdot 2\\tau_\\mathrm{int}$，并且对于给定的参数，其结果约为 $\\approx 7.1\\times 10^{-3}$。结论：正确。\n\nC. $\\mathrm{SE} = \\sqrt{s_b^2/b}$ 在分母中使用的是数据块长度而不是数据块数量。从量纲和统计学角度看，这对应于单个数据块均值的标准误差除以 $\\sqrt{b}$，而不是 $M$ 个独立数据块的总均值的方差。总均值的正确缩放关系是 $\\sqrt{s_b^2/M}$，而不是 $\\sqrt{s_b^2/b}$。数值上，这会得到 $\\approx 1.12\\times 10^{-2}$，与正确的推导不一致。结论：不正确。\n\nD. 从指数尾部估计积分自相关时间（IAT）$\\tau_\\mathrm{int}$，并使用 $\\mathrm{SE} = \\sqrt{2 \\tau_\\mathrm{int} s^2 / N}$ 是基于原理的自相关估计方法，它直接从平稳相关过程的均值方差推导而来。当 $\\tau_\\mathrm{int} \\approx 40$ 且 $s^2 = 0.25$ 时，该方法得到的结果约为 $\\approx 7.1\\times 10^{-3}$，与分块平均法一致。结论：正确。\n\nE. 对于固定 $N$ 的整个数据集的总均值而言，$\\mathrm{SE} \\sim 1/b$ 的说法是不正确的。增加 $b$ 会减少数据块均值之间的相关性，但在固定 $N$ 的情况下，$\\bar{X}$ 的标准误差由 $N$ 和 $\\tau_\\mathrm{int}$ 决定，而不是直接由 $b$ 决定；正确的缩放关系是 $\\mathrm{SE} \\sim \\sqrt{2 \\tau_\\mathrm{int} \\sigma^2 / N}$。表达式 $\\mathrm{SE} = \\sqrt{s^2/b}$ 是单个数据块均值的标准误差，而不是 $M$ 个数据块总均值的标准误差，它会高估或错误地描述 $\\bar{X}$ 的不确定度。数值上，$\\sqrt{0.25/400} = 0.025$，这不是全样本均值的不确定度。结论：不正确。\n\n因此，正确的步骤是选项 B 和 D 中的方法。两者都是一致的、基于原理的估计量，并且对于给定的参数，其数值结果一致。分块平均法不改变均值的估计量 $\\bar{X}$；当 $b$ 的选择超过相关时间时，它提供了一个稳健的误差估计。自相关方法通过 $\\tau_\\mathrm{int}$ 提供了等效的估计。",
            "answer": "$$\\boxed{BD}$$"
        }
    ]
}