{
    "hands_on_practices": [
        {
            "introduction": "高熵合金 (High-Entropy Alloy, HEA) 的“高熵”概念源于其高构型熵，这在热力学上有利于形成简单的固溶体相。本练习将引导你从第一性原理，即 Boltzmann 熵公式，推导出理想混合构型熵的通用表达式。通过计算并比较等原子比合金与非等原子比合金的构型熵，你将量化组分偏离如何影响熵值，从而更深刻地理解高熵合金与更广泛的成分复杂合金 (Compositionally Complex Alloy, CCA) 之间的区别。",
            "id": "3736938",
            "problem": "等原子五元合金是高熵合金（High-Entropy Alloy, HEA）的典型例子，而具有多种主元但成分偏离等原子比的合金通常被称为成分复杂合金（Compositionally Complex Alloys, CCA）。为量化在理想无规固溶体极限下成分对理想构型熵的影响，从玻尔兹曼熵定义 $S = k_{B} \\ln W$ 出发，其中 $k_{B}$ 是玻尔兹曼常数，$W$ 是可分辨的微观状态数。考虑一个由 $M$ 种化学物种占据的 $N$ 个替代晶格位置的体系，各物种的摩尔分数为 $\\{x_{i}\\}_{i=1}^{M}$，且满足 $\\sum_{i=1}^{M} x_{i} = 1$。假设理想无规固溶体模型，并对大的 $n$ 使用斯特林近似 $\\ln n! \\approx n \\ln n - n$，推导出一个M元合金单位通用气体常数 $R$ 的摩尔构型熵作为 $\\{x_{i}\\}$ 的函数。然后，针对以下情况计算该表达式的值：\n- 对于五元（$M = 5$）等原子合金，所有 $i$ 均满足 $x_{i} = \\frac{1}{5}$，以及\n- 对于成分为 $x = \\{0.50, 0.25, 0.125, 0.0625, 0.0625\\}$ 的非等原子五元合金。\n\n报告从等原子合金变为偏成分合金时无量纲构型熵的减少量，该减少量定义为 $\\Delta s \\equiv \\left(S_{\\mathrm{config}}/R\\right)_{\\mathrm{equiatomic}} - \\left(S_{\\mathrm{config}}/R\\right)_{\\mathrm{skewed}}$，以此作为单一的定量度量。将最终答案表示为一个纯数（无量纲），并四舍五入到 $4$ 位有效数字。",
            "solution": "构型熵 $S_{\\mathrm{config}}$ 源于在晶格上排列不同原子种类的方式数 $W$。对于一个总共有 $N$ 个晶格位置和 $M$ 种化学物种的系统，其中物种 $i$ 的原子数为 $N_i$，可分辨的微观状态数由多项式系数给出：\n$$\nW = \\frac{N!}{N_1! N_2! \\cdots N_M!} = \\frac{N!}{\\prod_{i=1}^{M} N_i!}\n$$\n原子总数为 $N = \\sum_{i=1}^{M} N_i$。物种 $i$ 的摩尔分数为 $x_i = N_i/N$。\n\n将 $W$ 代入玻尔兹曼熵公式 $S = k_B \\ln W$：\n$$\nS_{\\mathrm{config}} = k_B \\ln\\left(\\frac{N!}{\\prod_{i=1}^{M} N_i!}\\right) = k_B \\left( \\ln(N!) - \\sum_{i=1}^{M} \\ln(N_i!) \\right)\n$$\n对于宏观系统，$N$ 和每个 $N_i$ 都非常大，因此我们可以应用斯特林近似 $\\ln n! \\approx n \\ln n - n$：\n$$\nS_{\\mathrm{config}} \\approx k_B \\left[ (N \\ln N - N) - \\sum_{i=1}^{M} (N_i \\ln N_i - N_i) \\right]\n$$\n分配求和：\n$$\nS_{\\mathrm{config}} \\approx k_B \\left[ N \\ln N - N - \\sum_{i=1}^{M} N_i \\ln N_i + \\sum_{i=1}^{M} N_i \\right]\n$$\n由于 $\\sum_{i=1}^{M} N_i = N$，项 $-N$ 和 $+\\sum_{i=1}^{M} N_i$ 相互抵消：\n$$\nS_{\\mathrm{config}} \\approx k_B \\left[ N \\ln N - \\sum_{i=1}^{M} N_i \\ln N_i \\right]\n$$\n现在，代入关系式 $N_i = x_i N$：\n$$\nS_{\\mathrm{config}} \\approx k_B \\left[ N \\ln N - \\sum_{i=1}^{M} (x_i N) \\ln(x_i N) \\right]\n$$\n使用对数性质 $\\ln(ab) = \\ln a + \\ln b$：\n$$\nS_{\\mathrm{config}} \\approx k_B \\left[ N \\ln N - \\sum_{i=1}^{M} (x_i N)(\\ln x_i + \\ln N) \\right]\n$$\n$$\nS_{\\mathrm{config}} \\approx k_B \\left[ N \\ln N - N \\sum_{i=1}^{M} x_i \\ln x_i - N \\ln N \\sum_{i=1}^{M} x_i \\right]\n$$\n使用摩尔分数之和为一的约束条件 $\\sum_{i=1}^{M} x_i = 1$：\n$$\nS_{\\mathrm{config}} \\approx k_B \\left[ N \\ln N - N \\sum_{i=1}^{M} x_i \\ln x_i - N \\ln N \\right]\n$$\n项 $N \\ln N$ 和 $-N \\ln N$ 相互抵消，得到 $N$ 个原子的构型熵：\n$$\nS_{\\mathrm{config}} = -N k_B \\sum_{i=1}^{M} x_i \\ln x_i\n$$\n为求摩尔构型熵，我们考虑 1 摩尔原子，因此 $N = N_A$，其中 $N_A$ 是阿伏伽德罗常数。\n$$\nS_{\\mathrm{molar}} = -N_A k_B \\sum_{i=1}^{M} x_i \\ln x_i\n$$\n阿伏伽德罗常数与玻尔兹曼常数的乘积定义了通用气体常数 $R = N_A k_B$。因此：\n$$\nS_{\\mathrm{molar}} = -R \\sum_{i=1}^{M} x_i \\ln x_i\n$$\n题目要求的是无量纲摩尔构型熵，即摩尔熵除以气体常数 $R$。我们将其记为 $s$。\n$$\ns = \\frac{S_{\\mathrm{molar}}}{R} = -\\sum_{i=1}^{M} x_i \\ln x_i\n$$\n这就是我们必须为两种指定情况计算的通用表达式。\n\n情况1：五元（$M=5$）等原子合金。\n成分对于所有 $i \\in \\{1, 2, 3, 4, 5\\}$ 均为 $x_i = \\frac{1}{M} = \\frac{1}{5}$。\n$$\ns_{\\mathrm{equiatomic}} = -\\sum_{i=1}^{5} \\frac{1}{5} \\ln\\left(\\frac{1}{5}\\right) = -5 \\times \\left(\\frac{1}{5} \\ln\\left(\\frac{1}{5}\\right)\\right) = -\\ln\\left(\\frac{1}{5}\\right) = \\ln(5)\n$$\n数值上，$s_{\\mathrm{equiatomic}} \\approx 1.60943791$。\n\n情况2：五元（$M=5$）非等原子（偏成分）合金。\n成分由摩尔分数集合 $x = \\{0.50, 0.25, 0.125, 0.0625, 0.0625\\}$ 给出。我们验证一下总和：$0.50 + 0.25 + 0.125 + 0.0625 + 0.0625 = 1.0$。该成分有效。\n$$\ns_{\\mathrm{skewed}} = -\\left[ 0.50 \\ln(0.50) + 0.25 \\ln(0.25) + 0.125 \\ln(0.125) + 2 \\times (0.0625 \\ln(0.0625)) \\right]\n$$\n我们计算每一项：\n$0.50 \\ln(0.50) \\approx 0.50 \\times (-0.693147) \\approx -0.346574$\n$0.25 \\ln(0.25) \\approx 0.25 \\times (-1.386294) \\approx -0.346574$\n$0.125 \\ln(0.125) \\approx 0.125 \\times (-2.079442) \\approx -0.259930$\n$0.0625 \\ln(0.0625) \\approx 0.0625 \\times (-2.772589) \\approx -0.173287$\n将这些贡献相加：\n$$\ns_{\\mathrm{skewed}} = -[(-0.346574) + (-0.346574) + (-0.259930) + 2 \\times (-0.173287)] \\approx 1.299652\n$$\n\n最后，我们计算无量纲构型熵的减少量 $\\Delta s$：\n$$\n\\Delta s = s_{\\mathrm{equiatomic}} - s_{\\mathrm{skewed}}\n$$\n$$\n\\Delta s \\approx 1.609438 - 1.299652 = 0.309786\n$$\n将结果四舍五入到 $4$ 位有效数字，我们得到 $0.3098$。\n这个正值证实了等原子合金的熵高于偏成分合金的熵，这与最无序（均匀概率）分布下熵达到最大值的原理是一致的。",
            "answer": "$$\n\\boxed{0.3098}\n$$"
        },
        {
            "introduction": "高构型熵是稳定随机固溶体的驱动力，但这并非决定合金相结构的唯一因素。混合焓（$\\Delta H_{\\mathrm{mix}}$）反映了原子间的化学键合偏好，当其为强负值时，会驱动体系形成有序的金属间化合物，而非无序的固溶体。本练习是一个合金设计的思想实验，旨在探讨熵（倾向于无序）与焓（倾向于有序）之间的竞争，这对于准确地将多主元合金分类为高熵合金（HEA）或成分复杂合金（CCA）至关重要。",
            "id": "3736904",
            "problem": "一个材料设计团队寻求一种$4$组元等原子比合金，该合金通过两个互穿的简单立方亚晶格之间的化学有序化，形成单相有序B$2$（氯化铯）结构。他们将在足以使单相平衡的足够高的温度下进行退火，然后在不发生分解的情况下冷却。利用关于早期-晚期过渡金属组合中异类原子对成键趋势的第一性原理推理和理想混合构型熵，确定哪种方案最符合单相有序B$2$的结果，并根据通用的操作定义，判断其是否属于高熵合金（HEA）或成分复杂合金（CCA）。选择最佳选项。\n\nA. 提议$\\mathrm{Ti}_{0.25}\\mathrm{Zr}_{0.25}\\mathrm{Fe}_{0.25}\\mathrm{Co}_{0.25}$，预期由于强烈的异类原子对吸引作用，$\\{\\mathrm{Ti},\\mathrm{Zr}\\}$组占据一个亚晶格，而$\\{\\mathrm{Fe},\\mathrm{Co}\\}$组占据另一个亚晶格，从而形成B$2$有序结构。其在有序状态下的理想构型熵低于典型的高熵合金阈值；因此它不是高熵合金，而是成分复杂合金。\n\nB. 提议$\\mathrm{Fe}_{0.25}\\mathrm{Co}_{0.25}\\mathrm{Ni}_{0.25}\\mathrm{Al}_{0.25}$，预期形成单相B$2$结构，因为铝化物通常形成B$2$结构。作为一种等原子比$4$组元合金，它是一种高熵合金而不是成分复杂合金。\n\nC. 提议$\\mathrm{Fe}_{0.25}\\mathrm{Ni}_{0.25}\\mathrm{Co}_{0.25}\\mathrm{Cr}_{0.25}$，预期在高构型熵的驱动下形成无序单相体心立方固溶体；作为一种多主元等原子比合金，它是一种成分复杂合金但不是高熵合金。\n\nD. 提议$\\mathrm{Ti}_{0.25}\\mathrm{Zr}_{0.25}\\mathrm{Fe}_{0.25}\\mathrm{Co}_{0.25}$，预期形成单相B$2$有序结构，并将其归类为高熵合金和成分复杂合金，因为其作为等原子比$4$组元合金的理想构型熵达到或超过了常见的高熵合金阈值。\n\n通过选择唯一的正确选项来回答。",
            "solution": "### 推导与选项分析\n\n问题要求对相稳定性和合金分类进行分析。有序相（如B$2$）的形成主要由负的混合焓（$\\Delta H_{\\text{mix}}  0$）驱动，这表明异类原子之间存在强烈的成键能量偏好。相反，高混合构型熵（$\\Delta S_{\\text{conf}}$）有利于无序固溶体的形成。混合吉布斯自由能$\\Delta G_{\\text{mix}} = \\Delta H_{\\text{mix}} - T\\Delta S_{\\text{mix}}$决定了平衡相，更负的$\\Delta G_{\\text{mix}$表示更高的稳定性。\n\n**1. $4$组元等原子比合金中的B2结构**\nB$2$结构由两个互穿的简单立方亚晶格组成，分别标记为$\\alpha$和$\\beta$。对于一个等原子比$4$组元合金$A_{0.25}B_{0.25}C_{0.25}D_{0.25}$要形成B$2$相，元素必须分成两组，每组两个元素，分别占据一个亚晶格。例如，$(A, B)$在$\\alpha$亚晶格上，$(C, D)$在$\\beta$亚晶格上，得到化学式$(A_{0.5}B_{0.5})_{\\alpha}(C_{0.5}D_{0.5})_{\\beta}$。这种分配是由$\\{A, B\\}$组中的元素与$\\{C, D\\}$组中的元素之间强烈的化学亲和力（大的负$\\Delta H_{\\text{mix}}$）驱动的。“早期-晚期过渡金属组合”的原理正指向这一现象，因为这些组合通常表现出大的负$\\Delta H_{\\text{mix}}$。\n\n**2. HEA和CCA的定义**\n-   **构型熵（$\\Delta S_{\\text{conf}}$）：** 对于一个随机的$N$组元等原子比合金，理想构型熵由$\\Delta S_{\\text{conf}} = R \\ln N$给出，其中$R$是气体常数。\n-   **高熵合金阈值：** 一个普遍（尽管并非绝对）的惯例是，如果合金在其无序固溶体状态下的构型熵$\\Delta S_{\\text{conf}} \\ge 1.5R$，则将其归类为“高熵”合金。\n-   **成分复杂合金（CCA）：** 这是一个更广泛的术语，用于描述包含多种主元素（通常为$3$种或更多）的合金，它包含了高熵合金。任何高熵合金也是成分复杂合金，但并非所有成分复杂合金都满足被视为高熵合金的熵阈值。\n\n对于一个$4$组元等原子比合金，其无序状态的熵为$\\Delta S_{\\text{conf, random}} = R \\ln 4 \\approx 1.386R$。由于$1.386R  1.5R$，根据这一定义，这种合金通常被归类为CCA，但严格来说不属于HEA。\n\n对于有序的B$2$相$(A_{0.5}B_{0.5})_{\\alpha}(C_{0.5}D_{0.5})_{\\beta}$，构型熵源于每个亚晶格内部的随机混合。每摩尔原子的总熵是各亚晶格熵贡献的加权平均值：\n$$ \\Delta S_{\\text{conf, ordered}} = 0.5 \\times (-R[0.5 \\ln 0.5 + 0.5 \\ln 0.5]) + 0.5 \\times (-R[0.5 \\ln 0.5 + 0.5 \\ln 0.5]) $$\n$$ \\Delta S_{conf, ordered} = 0.5 (R \\ln 2) + 0.5 (R \\ln 2) = R \\ln 2 \\approx 0.693R $$\n这个值远低于无序态熵和$1.5R$的高熵合金阈值。\n\n现在，我们来评估每个选项。\n\n**A. 提议$\\mathrm{Ti}_{0.25}\\mathrm{Zr}_{0.25}\\mathrm{Fe}_{0.25}\\mathrm{Co}_{0.25}$，预期由于强烈的异类原子对吸引作用，$\\{\\mathrm{Ti},\\mathrm{Zr}\\}$组占据一个亚晶格，而$\\{\\mathrm{Fe},\\mathrm{Co}\\}$组占据另一个亚晶格，从而形成B$2$有序结构。其在有序状态下的理想构型熵低于典型的高熵合金阈值；因此它不是高熵合金，而是成分复杂合金。**\n\n-   **相形成：** 所提议的合金由两种早期过渡金属（$\\mathrm{Ti}$, $\\mathrm{Zr}$）和两种晚期过渡金属（$\\mathrm{Fe}$, $\\mathrm{Co}$）组成。已知早期-晚期金属对（例如$\\mathrm{Ti}-\\mathrm{Fe}$, $\\mathrm{Zr}-\\mathrm{Co}$）之间的混合热为强负值。这为有序化提供了强大的热力学驱动力。将$\\{\\mathrm{Ti}, \\mathrm{Zr}\\}$分配到一个亚晶格，将$\\{\\mathrm{Fe}, \\mathrm{Co}\\}$分配到另一个亚晶格的提议在化学上是合理的，因为它最大化了高度有利的早期-晚期金属键的数量。这个提议与形成B$2$有序相高度一致。\n-   **HEA/CCA分类：** 该陈述断言有序状态下的构型熵低于高熵合金阈值。根据计算，$\\Delta S_{\\text{conf, ordered}} = R \\ln 2 \\approx 0.693R$，这确实远低于$1.5R$的阈值。结论是，该合金是一种CCA（因为它是一种$4$组元多主元合金），但不是HEA（由于其低熵，特别是在有序状态下），这根据通用定义是完全正确的。\n-   **结论：** **正确**。该选项为所需结构提供了合理的化学基础，并根据已建立的定义进行了正确的分类。\n\n**B. 提议$\\mathrm{Fe}_{0.25}\\mathrm{Co}_{0.25}\\mathrm{Ni}_{0.25}\\mathrm{Al}_{0.25}$，预期形成单相B$2$结构，因为铝化物通常形成B$2$结构。作为一种等原子比$4$组元合金，它是一种高熵合金而不是成分复杂合金。**\n\n-   **相形成：** 诸如$\\mathrm{NiAl}$和$\\mathrm{FeAl}$之类的铝化物确实是强B$2$相形成剂。驱动力是$\\mathrm{Al}$与过渡金属之间的强吸引力。这将有利于一种有序化，即$\\mathrm{Al}$占据一个亚晶格，而$\\{\\mathrm{Fe}, \\mathrm{Co}, \\mathrm{Ni}\\}$占据另一个亚晶格。然而，这将导致成分为$\\mathrm{Al}_{0.5}(\\mathrm{Fe}_{1/3}\\mathrm{Co}_{1/3}\\mathrm{Ni}_{1/3})_{0.5}$，这在所有四种元素中并非等原子比（$50\\%$的$\\mathrm{Al}$，$\\mathrm{Fe, Co, Ni}$各占$16.7\\%$）。这与问题中等原子比$A_{0.25}B_{0.25}C_{0.25}D_{0.25}$合金的前提相矛盾。虽然可能会形成B$2$相，但通过这种简单的类比，并不能直接预测其作为等原子比四元合金的存在。\n-   **HEA/CCA分类：** “它是一种高熵合金而不是成分复杂合金”的陈述在逻辑上是错误的。高熵合金的集合是成分复杂合金集合的子集。一种合金不可能是高熵合金*而*不是成分复杂合金。此外，如前所述，一个$4$组元等原子比合金，其$\\Delta S_{\\text{conf, random}} \\approx 1.386R$，不满足常见的$1.5R$高熵合金熵阈值。\n-   **结论：** **不正确**。HEA/CCA的分类在逻辑上和事实上都是不正确的。\n\n**C. 提议$\\mathrm{Fe}_{0.25}\\mathrm{Ni}_{0.25}\\mathrm{Co}_{0.25}\\mathrm{Cr}_{0.25}$，预期在高构型熵的驱动下形成无序单相体心立方固溶体；作为一种多主元等原子比合金，它是一种成分复杂合金但不是高熵合金。**\n\n-   **相形成：** 这种合金（通常称为Cantor合金，尽管它通常是FCC结构且含有Mn）由相邻的$3d$过渡金属组成。这些元素之间的混合热很小，没有为化学有序化提供显著的驱动力。因此，预测它会形成*无序*固溶体是正确的。然而，这直接与问题设计*有序*B$2$结构的目标相矛盾。因此，这个提议未能满足主要的设计要求。\n-   **HEA/CCA分类：** 将其分类为“一种CCA但不是HEA”与$\\Delta S_{\\text{conf, random}} \\approx 1.386R  1.5R$的分析是一致的。这部分陈述是合理的。\n-   **结论：** **不正确**。尽管对这个特定合金体系的分析是合理的，但它被提议作为实现B$2$有序相这一既定目标的不合适候选者。\n\n**D. 提议$\\mathrm{Ti}_{0.25}\\mathrm{Zr}_{0.25}\\mathrm{Fe}_{0.25}\\mathrm{Co}_{0.25}$，预期形成单相B$2$有序结构，并将其归类为高熵合金和成分复杂合金，因为其作为等原子比$4$组元合金的理想构型熵达到或超过了常见的高熵合金阈值。**\n\n-   **相形成：** 与选项A一样，所提议的合金是形成有序B$2$相的绝佳候选者。这部分陈述是正确的。\n-   **HEA/CCA分类：** 该陈述声称该合金是高熵合金，因为其熵“达到或超过了常见的高熵合金阈值”。这在事实上是不正确的。一个随机的$4$组元等原子比合金的理想构型熵为$\\Delta S_{\\text{conf}} = R \\ln 4 \\approx 1.386R$，这*低于*常见的$1.5R$阈值。其高熵合金分类的论据是基于一个错误的前提。如果考虑最终有序状态的熵（$\\Delta S_{\\text{conf}} = R \\ln 2 \\approx 0.693R$），这个说法就更加不正确了。\n-   **结论：** **不正确**。对高熵合金分类的理由在事实上是错误的。\n\n### 结论\n\n选项A是唯一一个为实现目标B$2$结构提出了化学上合理的方案，并根据常见的现代定义对所得合金进行了正确且细致的分类。其推理正确地指出了有序状态的低熵是其分类的关键因素。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "真实的合金设计需要超越理想模型，考虑原子间复杂的相互作用。本项高级练习将理论与现代计算材料科学实践相结合，引入一个包含非理想相互作用项（混合焓）的吉布斯自由能模型。你将通过实施一个蒙特卡洛模拟，来评估相互作用参数的不确定性如何影响我们对多组分合金单相稳定性的预测，并最终影响我们将其划分为高熵合金（HEA）的置信度。",
            "id": "3736920",
            "problem": "您正在对多组分金属合金在相互作用参数存在不确定性时的局部单相稳定性进行建模。目标是评估预测的稳定性对三元及更高阶相互作用参数不确定性的敏感性，并解释其对将合金分类为高熵合金（HEA）或成分复杂合金（CCA）的置信度的影响。\n\n从以下基本依据开始：\n\n1.  一个 $N$ 组分置换固溶体在温度 $T$ 下的摩尔混合吉布斯自由能模型为\n$$\nG_{\\mathrm{mix}}(\\mathbf{x},T) \\;=\\; R T \\sum_{i=1}^{N} x_i \\ln x_i \\;+\\; \\sum_{1 \\le i  j \\le N} x_i x_j L_{ij} \\;+\\; \\sum_{1 \\le i  j  k \\le N} x_i x_j x_k L_{ijk},\n$$\n其中 $R$ 是摩尔气体常数，$\\mathbf{x} = (x_1,\\dots,x_N)$ 是组分的摩尔分数，满足 $\\sum_i x_i = 1$ 和 $x_i \\in (0,1)$，$L_{ij}$ 是二元相互作用参数，$L_{ijk}$ 是三元相互作用参数。使用 $R = 0.008314\\,\\mathrm{kJ}\\, \\mathrm{mol}^{-1}\\, \\mathrm{K}^{-1}$。所有相互作用参数 $L_{ij}$ 和 $L_{ijk}$ 的单位均为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n2.  如果 $G_{\\mathrm{mix}}$ 相对于 $N-1$ 个独立成分变量（需遵守约束 $\\sum_i x_i = 1$）的海森矩阵（二阶偏导数矩阵）在目标成分点是正定的，那么均匀单相在成分涨落方面是局部稳定的。设独立变量为 $(x_1,\\dots,x_{N-1})$ 并定义 $x_N = 1 - \\sum_{i=1}^{N-1} x_i$。判定规则是：如果约束海森矩阵的最小特征值严格为正，则均匀相是局部稳定的。\n\n3.  参数不确定性模型：对于每个二元相互作用 $L_{ij}$，将其视为随机变量 $L_{ij} \\sim \\mathcal{N}(\\mu_{2},\\, s \\sigma_{2})$；对于每个三元相互作用 $L_{ijk}$，将其视为 $L_{ijk} \\sim \\mathcal{N}(\\mu_{3},\\, s \\sigma_{3})$，且所有 $i,j,k$ 的抽样相互独立。这里 $s$ 是一个控制不确定性幅度的非负缩放因子。当 $s=0$ 时，所有参数都固定为其均值。\n\n4.  分类背景：高熵合金（HEA）通常定义为含有 $N \\ge 5$ 种主要元素且比例接近等原子比的合金（在本问题中，“近等原子比”指每个 $x_i$ 与 $1/N$ 的绝对偏差在 $0.05$ 以内）。成分复杂合金（CCA）是一个更广泛的类别，含有多种主要元素（在本问题中，考虑 $N \\ge 4$），但不一定是近等原子比。对单相假设的“分类置信度”与在指定的参数不确定性下，海森矩阵为正定的概率相关联。\n\n您的任务：\n\n- 实现一个程序，对于下面定义的每个测试用例，通过对相互作用参数进行蒙特卡洛抽样来估计在指定成分下，约束海森矩阵 $G_{\\mathrm{mix}}$ 为正定的概率。使用中心差分数值近似来构建关于 $(x_1,\\dots,x_{N-1})$ 的约束海森矩阵。每个独立变量的有限差分步长必须很小，并且必须保持定义域约束 $x_i \\in (0,1)$ 和 $\\sum_i x_i = 1$。局部稳定性的判定为：如果海森矩阵的最小特征值严格大于容差 $10^{-9}$，则为稳定。\n\n- 对于每个测试用例，使用每个尺度 $M$ 个独立的蒙特卡洛样本，计算三种不确定性尺度 $s \\in \\{0,\\;0.5,\\;1.0\\}$ 的稳定性概率。估计的概率是产生正定海森矩阵的样本所占的比例。所有测试用例和所有尺度均使用 $M = 600$。\n\n- 能量单位必须是 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，温度 $T$ 的单位是 $\\mathrm{K}$。您的程序不能要求任何外部输入，并且必须使用固定的随机种子，以确保结果是可复现的。\n\n- 输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，按顺序报告三个浮点数，分别对应于 $s=0$、$s=0.5$ 和 $s=1.0$ 时的估计稳定性概率。每个概率表示为四舍五入到六位小数的小数。因此，最终输出包含 $3 \\times$ (测试用例数) 个数字。\n\n测试套件：\n\n- 测试用例 1（基准类HEA，高温）：$N = 5$, $\\mathbf{x} = (0.2, 0.2, 0.2, 0.2, 0.2)$, $T = 1200\\,\\mathrm{K}$, 二元均值 $\\mu_{2} = -2.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, 二元标准差 $\\sigma_{2} = 1.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, 三元均值 $\\mu_{3} = 0.5\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, 三元标准差 $\\sigma_{3} = 0.5\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n- 测试用例 2（类HEA成分，但低温且有排斥相互作用）：$N = 5$, $\\mathbf{x} = (0.2, 0.2, 0.2, 0.2, 0.2)$, $T = 300\\,\\mathrm{K}$, 二元均值 $\\mu_{2} = 15.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, 二元标准差 $\\sigma_{2} = 2.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, 三元均值 $\\mu_{3} = 2.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, 三元标准差 $\\sigma_{3} = 1.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n- 测试用例 3（类CCA，非等原子比）：$N = 4$, $\\mathbf{x} = (0.4, 0.3, 0.2, 0.1)$, $T = 900\\,\\mathrm{K}$, 二元均值 $\\mu_{2} = 3.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, 二元标准差 $\\sigma_{2} = 3.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, 三元均值 $\\mu_{3} = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, 三元标准差 $\\sigma_{3} = 2.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n- 测试用例 4（确定性相互作用）：$N = 5$, $\\mathbf{x} = (0.2, 0.2, 0.2, 0.2, 0.2)$, $T = 1000\\,\\mathrm{K}$, 二元均值 $\\mu_{2} = 6.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, 二元标准差 $\\sigma_{2} = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, 三元均值 $\\mu_{3} = -1.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, 三元标准差 $\\sigma_{3} = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n您的程序必须完全使用上述测试套件，并按指定格式生成单行输出。",
            "solution": "### 基于原理的解决方案设计\n\n该问题要求通过蒙特卡洛模拟来估计多组分合金的单相稳定性概率。稳定性由摩尔混合吉布斯自由能的性质决定，这是化学热力学中的一个核心量。\n\n首先，我们形式化一个 $N$ 组分体系在温度 $T$ 和成分向量 $\\mathbf{x} = (x_1, \\dots, x_N)$ 下的混合吉布斯自由能 $G_{\\mathrm{mix}}$。所提供的模型是：\n$$\nG_{\\mathrm{mix}}(\\mathbf{x},T) \\;=\\; R T \\sum_{i=1}^{N} x_i \\ln x_i \\;+\\; \\sum_{1 \\le i  j \\le N} x_i x_j L_{ij} \\;+\\; \\sum_{1 \\le i  j  k \\le N} x_i x_j x_k L_{ijk}\n$$\n第一项代表理想混合吉布斯自由能（或构型熵项，$-T \\Delta S_{\\mathrm{mix}}^{\\mathrm{ideal}}$），它总是倾向于形成单相溶液。第二项和第三项构成了过剩吉布斯自由能 $G^{\\mathrm{E}}$，这里使用由二元（$L_{ij}$）和三元（$L_{ijk}$）相互作用参数参数化的Redlich-Kister型展开式来建模。常数 $R$ 是摩尔气体常数，取值为 $0.008314\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n\n抵抗无穷小成分涨落的局部稳定性（即抵抗调幅分解的稳定性）要求吉布斯自由能曲面在所研究的成分点是凸的。在数学上，这等价于 $G_{\\mathrm{mix}}$ 关于一组独立成分变量的海森矩阵是正定的。给定约束 $\\sum_{i=1}^{N} x_i = 1$，我们可以选择 $N-1$ 个独立变量，例如 $(x_1, \\dots, x_{N-1})$，而 $x_N$ 是因变量：$x_N = 1 - \\sum_{i=1}^{N-1} x_i$。海森矩阵 $H$ 是一个 $(N-1) \\times (N-1)$ 的对称矩阵，其元素为 $H_{mn} = \\frac{\\partial^2 G_{\\mathrm{mix}}}{\\partial x_m \\partial x_n}$，其中 $m, n \\in \\{1, \\dots, N-1\\}$。如果 $H$ 的所有特征值都严格为正，则该相是稳定的。我们使用数值容差 $10^{-9}$，因此条件是 $\\lambda_{\\min}(H) > 10^{-9}$。\n\n$G_{\\mathrm{mix}}$ 二阶导数的解析计算虽然可行但可能很繁琐。问题指定使用中心差分格式的数值方法来近似偏导数。对于一个有 $k$ 个变量的函数 $f(\\mathbf{y})$，导数近似为：\n$$\n\\frac{\\partial^2 f}{\\partial y_i^2} \\approx \\frac{f(\\mathbf{y} + h \\mathbf{e}_i) - 2f(\\mathbf{y}) + f(\\mathbf{y} - h \\mathbf{e}_i)}{h^2}\n$$\n$$\n\\frac{\\partial^2 f}{\\partial y_i \\partial y_j} \\approx \\frac{f(\\mathbf{y} + h \\mathbf{e}_i + h \\mathbf{e}_j) - f(\\mathbf{y} + h \\mathbf{e}_i - h \\mathbf{e}_j) - f(\\mathbf{y} - h \\mathbf{e}_i + h \\mathbf{e}_j) + f(\\mathbf{y} - h \\mathbf{e}_i - h \\mathbf{e}_j)}{4h^2}\n$$\n这里，$\\mathbf{y} = (x_1, \\dots, x_{N-1})$，函数是 $f=G_{\\mathrm{mix}}$，$\\mathbf{e}_i$ 是第 $i$ 个标准基向量，$h$ 是一个小的步长，我们选择 $h=10^{-6}$。关键在于，当一个独立变量 $x_m$（其中 $m  N$）被扰动了某个量 $\\Delta x_m$ 时，因变量 $x_N$ 必须调整 $-\\sum_{m=1}^{N-1} \\Delta x_m$ 以维持质量平衡约束 $\\sum_{k=1}^{N} x_k = 1$。我们的实现正确地处理了这些耦合扰动。\n\n问题的核心是考虑相互作用参数的不确定性。参数 $L_{ij}$ 和 $L_{ijk}$ 被建模为从正态分布中抽取的独立随机变量：$L_{ij} \\sim \\mathcal{N}(\\mu_{2}, s \\sigma_{2})$ 和 $L_{ijk} \\sim \\mathcal{N}(\\mu_{3}, s \\sigma_{3})$。缩放因子 $s \\in \\{0, 0.5, 1.0\\}$ 调节不确定性的幅度。对于每个指定的测试用例和每个 $s$ 值，我们执行一个包含 $M=600$ 次试验的蒙特卡洛模拟。\n\n总体算法如下：\n1.  为保证可复现性，初始化一个固定的随机数生成器种子。\n2.  对每个测试用例和每个不确定性尺度 $s \\in \\{0, 0.5, 1.0\\}$：\n    a. 初始化稳定构型计数器 `stable_count` 为 $0$。\n    b. 重复 $M=600$ 次：\n        i. 基于指定的均值（$\\mu_2, \\mu_3$）、标准差（$\\sigma_2, \\sigma_3$）和当前尺度 $s$，生成所有二元（$L_{ij}$）和三元（$L_{ijk}$）相互作用参数的一个随机实现。\n        ii. 使用生成的参数和数值中心差分方案，在指定的成分 $\\mathbf{x}$ 和温度 $T$ 下，构建 $(N-1) \\times (N-1)$ 的海森矩阵 $H$。\n        iii. 计算对称海森矩阵 $H$ 的特征值。使用 `numpy.linalg.eigvalsh` 是完成此任务的恰当且高效的方法。\n        iv. 找到最小特征值 $\\lambda_{\\min}$。如果 $\\lambda_{\\min} > 10^{-9}$，则增加 `stable_count`。\n    c. 稳定性的估计概率为 $P_{\\mathrm{stable}} = \\frac{\\text{stable\\_count}}{M}$。\n3.  将所有计算出的概率存储并格式化为单个逗号分隔的字符串，每个概率四舍五入到六位小数。\n\nPython 实现封装了这一逻辑。函数 `G_mix` 计算给定成分和相互作用参数集的吉布斯自由能。第二个函数 `calculate_hessian` 实现数值微分来构建海森矩阵。主函数 `solve` 负责组织蒙特卡洛循环，调用这些辅助函数，评估稳定性准则，并按要求格式化最终输出。问题中指定的测试用例涵盖了不同情景：高温HEA、具有排斥相互作用的低温HEA、非等原子比CCA以及确定性情况，从而可以对模型行为进行全面测试。",
            "answer": "```python\nimport numpy as np\nfrom itertools import combinations\nimport math\n\n# Global constants as per the problem description\nR_KJ_MOL_K = 0.008314  # Gas constant in kJ/(mol*K)\nMC_SAMPLES = 600\nHESSIAN_STEP_SIZE = 1e-6\nSTABILITY_TOLERANCE = 1e-9\nRANDOM_SEED = 42\n\ndef G_mix(x, T, L2_params, L3_params):\n    \"\"\"\n    Calculates the molar Gibbs free energy of mixing.\n    \n    Args:\n        x (np.ndarray): Array of mole fractions.\n        T (float): Temperature in Kelvin.\n        L2_params (dict): Dictionary of pairwise interaction parameters, e.g., {(0, 1): value}.\n        L3_params (dict): Dictionary of ternary interaction parameters, e.g., {(0, 1, 2): value}.\n        \n    Returns:\n        float: The Gibbs free energy of mixing in kJ/mol.\n    \"\"\"\n    N = len(x)\n    \n    # Handle log(0) for invalid compositions, which can occur during numerical differentiation\n    # if the step size is too large. Mole fractions must be > 0 for log to be defined.\n    if np.any(x = 0):\n        return np.inf\n\n    # Ideal entropy of mixing term\n    term1 = R_KJ_MOL_K * T * np.sum(x * np.log(x))\n    \n    # Pairwise interaction term\n    term2 = 0.0\n    for i, j in combinations(range(N), 2):\n        term2 += x[i] * x[j] * L2_params.get((i, j), 0.0)\n        \n    # Ternary interaction term\n    term3 = 0.0\n    if N >= 3:\n        for i, j, k in combinations(range(N), 3):\n            term3 += x[i] * x[j] * x[k] * L3_params.get((i, j, k), 0.0)\n            \n    return term1 + term2 + term3\n\ndef calculate_hessian(x_base, T, L2_params, L3_params, h):\n    \"\"\"\n    Calculates the constrained Hessian matrix using a central-difference scheme.\n    \n    Args:\n        x_base (np.ndarray): Base composition vector.\n        T (float): Temperature in Kelvin.\n        L2_params (dict): Pairwise interaction parameters.\n        L3_params (dict): Ternary interaction parameters.\n        h (float): Finite difference step size.\n        \n    Returns:\n        np.ndarray: The (N-1)x(N-1) Hessian matrix.\n    \"\"\"\n    N = len(x_base)\n    n_indep = N - 1\n    hessian = np.zeros((n_indep, n_indep))\n    x_indep_base = x_base[:n_indep]\n\n    def eval_g_at_delta(delta_vec):\n        x_indep_perturbed = x_indep_base + delta_vec\n        x_dep_perturbed = 1.0 - np.sum(x_indep_perturbed)\n        x_perturbed = np.append(x_indep_perturbed, x_dep_perturbed)\n        return G_mix(x_perturbed, T, L2_params, L3_params)\n\n    # Diagonal elements\n    for i in range(n_indep):\n        delta_vec = np.zeros(n_indep)\n        delta_vec[i] = h\n        g_plus = eval_g_at_delta(delta_vec)\n        g_minus = eval_g_at_delta(-delta_vec)\n        g_center = eval_g_at_delta(np.zeros(n_indep))\n        hessian[i, i] = (g_plus - 2 * g_center + g_minus) / (h * h)\n\n    # Off-diagonal elements\n    for i in range(n_indep):\n        for j in range(i + 1, n_indep):\n            delta_i = np.zeros(n_indep); delta_i[i] = h\n            delta_j = np.zeros(n_indep); delta_j[j] = h\n            \n            g_pp = eval_g_at_delta(delta_i + delta_j)\n            g_pm = eval_g_at_delta(delta_i - delta_j)\n            g_mp = eval_g_at_delta(-delta_i + delta_j)\n            g_mm = eval_g_at_delta(-delta_i - delta_j)\n            \n            val = (g_pp - g_pm - g_mp + g_mm) / (4 * h * h)\n            hessian[i, j] = val\n            hessian[j, i] = val\n\n    return hessian\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print results.\n    \"\"\"\n    np.random.seed(RANDOM_SEED)\n\n    test_cases = [\n        {'N': 5, 'x': (0.2, 0.2, 0.2, 0.2, 0.2), 'T': 1200, 'mu2': -2.0, 'sigma2': 1.0, 'mu3': 0.5, 'sigma3': 0.5},\n        {'N': 5, 'x': (0.2, 0.2, 0.2, 0.2, 0.2), 'T': 300, 'mu2': 15.0, 'sigma2': 2.0, 'mu3': 2.0, 'sigma3': 1.0},\n        {'N': 4, 'x': (0.4, 0.3, 0.2, 0.1), 'T': 900, 'mu2': 3.0, 'sigma2': 3.0, 'mu3': 0.0, 'sigma3': 2.0},\n        {'N': 5, 'x': (0.2, 0.2, 0.2, 0.2, 0.2), 'T': 1000, 'mu2': 6.0, 'sigma2': 0.0, 'mu3': -1.0, 'sigma3': 0.0}\n    ]\n\n    all_results = []\n    scales = [0.0, 0.5, 1.0]\n\n    for case in test_cases:\n        N = case['N']\n        x_base = np.array(case['x'])\n        T = case['T']\n        mu2, sigma2 = case['mu2'], case['sigma2']\n        mu3, sigma3 = case['mu3'], case['sigma3']\n\n        pairs = list(combinations(range(N), 2))\n        triplets = list(combinations(range(N), 3))\n        num_L2 = len(pairs)\n        num_L3 = len(triplets)\n\n        for s in scales:\n            stable_count = 0\n            for _ in range(MC_SAMPLES):\n                # Sample interaction parameters\n                L2_vals = np.random.normal(mu2, s * sigma2, num_L2)\n                L2_params = {pair: val for pair, val in zip(pairs, L2_vals)}\n                \n                L3_params = {}\n                if num_L3 > 0:\n                    L3_vals = np.random.normal(mu3, s * sigma3, num_L3)\n                    L3_params = {triplet: val for triplet, val in zip(triplets, L3_vals)}\n\n                # Calculate Hessian\n                hessian = calculate_hessian(x_base, T, L2_params, L3_params, HESSIAN_STEP_SIZE)\n                \n                # Check stability: positive definite Hessian\n                try:\n                    # eigvalsh is for symmetric matrices, which Hessian is by construction.\n                    # It's faster and more numerically stable than eig.\n                    eigenvalues = np.linalg.eigvalsh(hessian)\n                    min_eig = np.min(eigenvalues)\n                    if min_eig > STABILITY_TOLERANCE:\n                        stable_count += 1\n                except np.linalg.LinAlgError:\n                    # In case of non-finite values leading to an error, treat as unstable\n                    pass\n            \n            prob = stable_count / MC_SAMPLES\n            all_results.append(f\"{prob:.6f}\")\n\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        }
    ]
}