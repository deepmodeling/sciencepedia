{
    "hands_on_practices": [
        {
            "introduction": "自由能是材料热力学的基石，它决定了相的稳定性和相变驱动力。然而，直接计算自由能通常非常困难。该练习介绍了一种强大的通用方法——热力学积分（TI），它通过在两个状态之间构建一条虚拟路径来计算自由能的*差值*。通过为一个简化的晶格模型实践热力学积分，您将掌握一项在处理更复杂系统时至关重要的基础计算技能()。",
            "id": "3746287",
            "problem": "在集成计算材料工程 (ICME) 框架下，考虑一个二元高熵合金 (HEA) 的粗粒化晶格模型，其中每个晶格位点可以呈现两种构型状态之一，分别代表局域有序或无序环境。假设有 $N$ 个独立且等价的晶格位点。在无序参考态下，两种构型的能量均为 $0$，处于简并状态。而在有序目标态下，局域有序构型的能量相对于无序构型稳定了 $-\\Delta \\varepsilon$。引入一个耦合参数 $\\lambda \\in [0,1]$，该参数在两个哈密顿量之间进行线性插值，使得依赖于 $\\lambda$ 的哈密顿量由 $H(\\lambda) = (1-\\lambda)H_{\\mathrm{A}} + \\lambda H_{\\mathrm{B}}$ 给出，其中 $H_{\\mathrm{A}}$ 表示无序参考哈密顿量，$H_{\\mathrm{B}}$ 表示有序目标哈密顿量。对于单个位点，其状态变量为 $s \\in \\{0,1\\}$（其中 $s=1$ 表示局域有序，$s=0$ 表示无序），位点哈密顿量的形式为 $H_{\\text{site}}(\\lambda;s) = -\\lambda \\Delta \\varepsilon \\, s$。系统处于绝对温度为 $T$ 的正则系综中。\n\n从正则配分函数定义 $Z(\\lambda) = \\sum_{\\text{all states}} \\exp\\!\\left(-\\beta H(\\lambda)\\right)$（其中 $\\beta = 1/(k_{\\mathrm{B}}T)$）和 Helmholtz 自由能 $F(\\lambda) = -k_{\\mathrm{B}}T \\ln Z(\\lambda)$ 出发，推导一个热力学积分关系式。该关系式将有序态和无序态之间的自由能差 $F_{\\mathrm{B}}-F_{\\mathrm{A}}$ 表示为一个关于 $\\lambda$ 的一维积分，积分项是一个包含哈密顿量对 $\\lambda$ 导数的系综平均值。然后，对于给定的两态无相互作用位点模型，从第一性原理出发构建显式的被积函数，并对该积分进行数值计算。\n\n你的程序必须：\n- 仅基于上述定义和基本统计力学，使用正则系综为给定模型计算热力学积分所需的、依赖于 $\\lambda$ 的系综平均值。\n- 对每个提供的测试用例，在 $\\lambda \\in [0,1]$ 上执行数值积分，以估算自由能差 $F_{\\mathrm{B}}-F_{\\mathrm{A}}$。\n- 将 $k_{\\mathrm{B}}$ 视为物理玻尔兹曼常数，其值为 $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}$ eV/K（电子伏特每开尔文），并将所有最终的自由能差以电子伏特 (eV) 为单位表示，四舍五入到6位小数。\n\n测试套件：\n- 案例1：$N = 100$, $\\Delta \\varepsilon = 0.05$ eV, $T = 1000$ K。\n- 案例2：$N = 100$, $\\Delta \\varepsilon = 0.00$ eV, $T = 800$ K。\n- 案例3：$N = 10$, $\\Delta \\varepsilon = 0.10$ eV, $T = 50$ K。\n- 案例4：$N = 1000$, $\\Delta \\varepsilon = 0.02$ eV, $T = 300$ K。\n- 案例5：$N = 1$, $\\Delta \\varepsilon = -0.05$ eV, $T = 300$ K。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是相应测试用例计算出的自由能差 $F_{\\mathrm{B}}-F_{\\mathrm{A}}$（单位为eV），并四舍五入到6位小数。",
            "solution": "我们从正则系综开始。在固定的 $\\lambda$ 下，配分函数为 $Z(\\lambda) = \\sum_{\\text{states}} \\exp\\!\\left(-\\beta H(\\lambda)\\right)$，其中 $\\beta = 1/(k_{\\mathrm{B}}T)$。Helmholtz 自由能为 $F(\\lambda) = -k_{\\mathrm{B}}T \\ln Z(\\lambda)$。使用链式法则对 $\\lambda$ 求导，得到\n\n$$\n\\frac{\\partial F}{\\partial \\lambda} = -k_{\\mathrm{B}}T \\frac{1}{Z(\\lambda)} \\frac{\\partial Z(\\lambda)}{\\partial \\lambda}.\n$$\n\n我们计算 $\\partial Z/\\partial \\lambda$：\n\n$$\n\\frac{\\partial Z(\\lambda)}{\\partial \\lambda} = \\sum_{\\text{states}} \\left( -\\beta \\frac{\\partial H(\\lambda)}{\\partial \\lambda} \\right) \\exp\\!\\left(-\\beta H(\\lambda)\\right).\n$$\n\n因此，\n\n$$\n\\frac{\\partial F}{\\partial \\lambda} = \\frac{1}{Z(\\lambda)} \\sum_{\\text{states}} \\left( \\frac{\\partial H(\\lambda)}{\\partial \\lambda} \\right) \\exp\\!\\left(-\\beta H(\\lambda)\\right) = \\left\\langle \\frac{\\partial H(\\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda},\n$$\n\n这就是热力学积分关系。有序和无序两个终态之间的自由能差为\n\n$$\nF_{\\mathrm{B}} - F_{\\mathrm{A}} = \\int_{0}^{1} \\left\\langle \\frac{\\partial H(\\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\, d\\lambda.\n$$\n\n\n现在我们为给定模型构建系综平均。系统由 $N$ 个独立、等价的位点组成，每个位点的状态变量为 $s \\in \\{0,1\\}$。位点哈密顿量为 $H_{\\text{site}}(\\lambda; s) = -\\lambda \\Delta \\varepsilon \\, s$。因此，对于完整系统，\n\n$$\nH(\\lambda; \\{s_i\\}) = -\\lambda \\Delta \\varepsilon \\sum_{i=1}^{N} s_i,\n$$\n\n以及\n\n$$\n\\frac{\\partial H(\\lambda)}{\\partial \\lambda} = -\\Delta \\varepsilon \\sum_{i=1}^{N} s_i.\n$$\n\n因为各位点是独立的，所以系综平均可以分解，我们得到\n\n$$\n\\left\\langle \\sum_{i=1}^{N} s_i \\right\\rangle_{\\lambda} = N \\left\\langle s \\right\\rangle_{\\lambda},\n$$\n\n其中，单位点平均值使用玻尔兹曼权重计算。单位点配分函数为\n\n$$\nZ_{\\text{site}}(\\lambda) = \\sum_{s \\in \\{0,1\\}} \\exp\\!\\left(-\\beta H_{\\text{site}}(\\lambda;s)\\right) = 1 + \\exp\\!\\left(\\beta \\lambda \\Delta \\varepsilon\\right).\n$$\n\n单位点 $s=1$ 的概率为\n\n$$\np_{\\lambda}(s=1) = \\frac{\\exp\\!\\left(\\beta \\lambda \\Delta \\varepsilon\\right)}{1 + \\exp\\!\\left(\\beta \\lambda \\Delta \\varepsilon\\right)},\n$$\n\n因此\n\n$$\n\\left\\langle s \\right\\rangle_{\\lambda} = \\frac{\\exp\\!\\left(\\beta \\lambda \\Delta \\varepsilon\\right)}{1 + \\exp\\!\\left(\\beta \\lambda \\Delta \\varepsilon\\right)}.\n$$\n\n因此，\n\n$$\n\\left\\langle \\frac{\\partial H(\\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda} = -\\Delta \\varepsilon \\, N \\, \\frac{\\exp\\!\\left(\\beta \\lambda \\Delta \\varepsilon\\right)}{1 + \\exp\\!\\left(\\beta \\lambda \\Delta \\varepsilon\\right)}.\n$$\n\n热力学积分变为\n\n$$\nF_{\\mathrm{B}} - F_{\\mathrm{A}} = -\\Delta \\varepsilon \\, N \\int_{0}^{1} \\frac{\\exp\\!\\left(\\beta \\lambda \\Delta \\varepsilon\\right)}{1 + \\exp\\!\\left(\\beta \\lambda \\Delta \\varepsilon\\right)} \\, d\\lambda.\n$$\n\n定义 $a = \\beta \\Delta \\varepsilon$。注意到 $\\frac{\\exp(ax)}{1+\\exp(ax)}$ 是 logistic 函数 $\\sigma(ax)$，我们使用恒等式 $\\int \\sigma(ax) \\, dx = \\frac{1}{a} \\ln\\!\\left(1+\\exp(ax)\\right) + C$。因此，\n\n$$\n\\int_{0}^{1} \\frac{\\exp\\!\\left(a \\lambda\\right)}{1 + \\exp\\!\\left(a \\lambda\\right)} \\, d\\lambda = \\frac{1}{a} \\left[ \\ln\\!\\left(1+\\exp(a)\\right) - \\ln\\!\\left(1+\\exp(0)\\right) \\right] = \\frac{1}{a} \\left[ \\ln\\!\\left(1+\\exp(a)\\right) - \\ln(2) \\right].\n$$\n\n于是，自由能差具有以下解析形式\n\n$$\nF_{\\mathrm{B}} - F_{\\mathrm{A}} = -\\Delta \\varepsilon \\, N \\cdot \\frac{1}{\\beta \\Delta \\varepsilon} \\left[ \\ln\\!\\left( \\frac{1+\\exp(\\beta \\Delta \\varepsilon)}{2} \\right) \\right] = -\\frac{N}{\\beta} \\ln\\!\\left( \\frac{1+\\exp(\\beta \\Delta \\varepsilon)}{2} \\right).\n$$\n\n这个解析形式可以作为一个有用的解析检验。然而，题目要求的数值解是通过执行数值积分得到的\n\n$$\nF_{\\mathrm{B}} - F_{\\mathrm{A}} = \\int_{0}^{1} g(\\lambda) \\, d\\lambda, \\quad \\text{其中} \\quad g(\\lambda) = -\\Delta \\varepsilon \\, N \\, \\frac{\\exp\\!\\left(\\beta \\lambda \\Delta \\varepsilon\\right)}{1 + \\exp\\!\\left(\\beta \\lambda \\Delta \\varepsilon\\right)}.\n$$\n\n\n程序算法规划：\n- 对每个测试用例，解析 $N$、$\\Delta \\varepsilon$（单位为 eV）和 $T$（单位为 K）。\n- 使用 eV/K 为单位的 $k_{\\mathrm{B}}$ 计算 $\\beta = 1/(k_{\\mathrm{B}} T)$。被积函数 $g(\\lambda)$ 的单位是 eV，因此积分直接得到 eV 单位的结果。\n- 为 $x = \\beta \\lambda \\Delta \\varepsilon$ 定义一个数值稳定的 logistic 函数以避免当 $|x|$ 很大时发生溢出：使用 $\\sigma(x) = \\begin{cases} \\frac{1}{1+\\exp(-x)},  x \\ge 0 \\\\ \\frac{\\exp(x)}{1+\\exp(x)},  x  0 \\end{cases}$。\n- 使用自适应数值积分方法在 $\\lambda \\in [0,1]$ 上对 $g(\\lambda)$ 进行积分，并设置适用于 eV 尺度精度的绝对和相对容差。\n- 将得到的自由能差四舍五入到6位小数，并收集所有测试用例的结果。\n- 以要求的格式打印单行：一个用方括号括起来的逗号分隔列表。\n\n边界情况与覆盖范围：\n- $\\Delta \\varepsilon = 0$ 的情况会得到 $g(\\lambda) \\equiv 0$，因此积分精确地为 $0$ eV。\n- 负的 $\\Delta \\varepsilon$ 对不利的有序化具有物理意义；由于 logistic 函数的对称性，算法保持稳定。\n- 高温（小 $\\beta$）和低温（大 $\\beta$）区域可以通过稳定的 logistic 函数求值和自适应积分得到稳健的处理。\n\n按要求，所有输出均以电子伏特 (eV) 表示，并四舍五入到6位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\n# Boltzmann constant in eV/K\nK_B_EV_PER_K = 8.617333262145e-5\n\ndef stable_logistic(x: float) - float:\n    \"\"\"\n    Numerically stable logistic function: sigma(x) = 1 / (1 + exp(-x))\n    Handles large |x| without overflow.\n    \"\"\"\n    if x = 0:\n        # For non-negative x, use the standard form\n        # Avoid overflow for large x by limiting exp(-x)\n        return 1.0 / (1.0 + np.exp(-x))\n    else:\n        # For negative x, use exp(x) / (1 + exp(x)) to avoid overflow in exp(-x)\n        ex = np.exp(x)\n        return ex / (1.0 + ex)\n\ndef ti_free_energy_difference(N: int, delta_e_ev: float, T_K: float) - float:\n    \"\"\"\n    Compute F_B - F_A via thermodynamic integration for the two-state lattice model.\n    Returns value in eV.\n    \"\"\"\n    beta = 1.0 / (K_B_EV_PER_K * T_K)\n\n    # Integrand g(lambda) = -N * delta_e_ev * sigma(beta * delta_e_ev * lambda)\n    def integrand(lmbda):\n        x = beta * delta_e_ev * lmbda\n        return -N * delta_e_ev * stable_logistic(x)\n\n    # Perform adaptive quadrature over lambda in [0, 1]\n    # Set tolerances to ensure accuracy at 1e-10 absolute, 1e-10 relative\n    result, _ = quad(integrand, 0.0, 1.0, epsabs=1e-12, epsrel=1e-12, limit=200)\n    return result\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (N, delta_e_ev, T_K)\n    test_cases = [\n        (100, 0.05, 1000.0),   # Case 1\n        (100, 0.00, 800.0),    # Case 2\n        (10,  0.10, 50.0),     # Case 3\n        (1000,0.02, 300.0),    # Case 4\n        (1,  -0.05, 300.0),    # Case 5\n    ]\n\n    results = []\n    for N, delta_e_ev, T_K in test_cases:\n        f_diff_ev = ti_free_energy_difference(N, delta_e_ev, T_K)\n        # Round to 6 decimal places as required\n        results.append(f\"{f_diff_ev:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "集成计算材料工程（ICME）的一个核心思想是使用代理模型（如团簇展开）来连接不同尺度的计算，例如从密度泛函理论（DFT）到晶格尺度的蒙特卡洛模拟。然而，如果不了解其可靠性，任何模型都无法发挥其全部作用。本练习将运用贝叶斯回归方法，不仅拟合一个团簇展开模型，更重要的是量化其参数和预测的不确定性()，这是实现稳健材料设计的关键一步。",
            "id": "3746316",
            "problem": "一种面心立方晶格上的高熵合金 (HEA) 采用团簇展开进行建模，其中超胞的构型能被写为一组有限的对称不等价团簇函数的线性组合。在集成计算材料工程 (ICME) 工作流程中，密度泛函理论 (DFT) 的能量被用来拟合有效团簇相互作用，这是通过求解一个带有不确定性量化的回归问题来完成的。考虑截断为三个团簇函数，其系数为 $J_{1}$、$J_{2}$ 和 $J_{3}$，并用 $\\boldsymbol{J} \\in \\mathbb{R}^{3}$ 表示未知相互作用的向量。设 $\\boldsymbol{\\phi}^{(i)} \\in \\mathbb{R}^{3}$ 为在第 $i$ 个训练构型上求值的三个团簇函数所构成的向量。\n\n假设以下数据和模型：\n- 训练数据集包含 $m = 3$ 个超胞，其团簇函数向量构成设计矩阵 $\\boldsymbol{X} \\in \\mathbb{R}^{3 \\times 3}$，其行为 $\\boldsymbol{\\phi}^{(1)} = (1, 0, 0)$、$\\boldsymbol{\\phi}^{(2)} = (0, 1, 0)$ 和 $\\boldsymbol{\\phi}^{(3)} = (0, 0, 1)$，即 $\\boldsymbol{X} = \\boldsymbol{I}_{3}$。\n- DFT 能量 $\\boldsymbol{y} \\in \\mathbb{R}^{3}$ 通过同方差高斯噪声模型 $y_{i} = \\boldsymbol{\\phi}^{(i)} \\cdot \\boldsymbol{J} + \\varepsilon_{i}$ 进行建模，其中 $\\varepsilon_{i} \\sim \\mathcal{N}(0, \\sigma^{2})$ 是独立的，且噪声方差已知为 $\\sigma^{2} = 1.0 \\times 10^{-2} \\ \\mathrm{eV}^{2}$。\n- 对 $\\boldsymbol{J}$ 施加一个零均值高斯先验：$\\boldsymbol{J} \\sim \\mathcal{N}(\\boldsymbol{0}, \\boldsymbol{S}_{0})$，其对角先验协方差 $\\boldsymbol{S}_{0} = \\mathrm{diag}(s_{1}^{2}, s_{2}^{2}, s_{3}^{2})$ 由 $s_{1}^{2} = 1.0 \\times 10^{-2} \\ \\mathrm{eV}^{2}$、$s_{2}^{2} = 4.0 \\times 10^{-2} \\ \\mathrm{eV}^{2}$ 和 $s_{3}^{2} = 9.0 \\times 10^{-2} \\ \\mathrm{eV}^{2}$ 给出。\n\n从 Bayes 定理和线性高斯模型出发，推导 $\\boldsymbol{J}$ 的后验协方差，并计算 $J_{1}$、$J_{2}$ 和 $J_{3}$ 的后验方差。然后，对于一个团簇函数向量为 $\\boldsymbol{\\phi}_{\\ast} = (0.6, -0.3, 0.2)$ 的新构型，通过推导和计算一个新的含噪声能量观测值 $y_{\\ast}$ 的后验预测方差来量化其预测不确定性，计算中使用相同的单位和噪声模型。\n\n将所有要求的方差以 $\\mathrm{eV}^{2}$ 为单位表示，并将每个值四舍五入到四位有效数字。以单行矩阵的形式提供最终答案，按顺序包含：$J_{1}$ 的后验方差、$J_{2}$ 的后验方差、$J_{3}$ 的后验方差，以及 $y_{\\ast}$ 的后验预测方差。",
            "solution": "该问题已经过验证，被认为是科学上可靠、良定、客观且自洽的。所有推导所求量所需的信息均已提供。该问题是贝叶斯线性回归的一个标准应用，这是 ICME 框架内材料建模不确定性量化的核心技术。\n\n问题要求基于线性高斯模型，计算模型参数 $\\boldsymbol{J}$ 的后验方差以及新观测值 $y_{\\ast}$ 的后验预测方差。我们从 Bayes 定理开始，该定理指出后验分布与似然和先验的乘积成正比：\n$$p(\\boldsymbol{J} | \\boldsymbol{y}, \\boldsymbol{X}) \\propto p(\\boldsymbol{y} | \\boldsymbol{J}, \\boldsymbol{X}) p(\\boldsymbol{J})$$\n\n似然函数源于每个观测值 $y_{i} = \\boldsymbol{\\phi}^{(i)} \\cdot \\boldsymbol{J} + \\varepsilon_{i}$ 具有独立同分布高斯噪声 $\\varepsilon_{i} \\sim \\mathcal{N}(0, \\sigma^{2})$ 的假设。对于包含 $m=3$ 个观测值的整个数据集，这可以写成向量形式 $\\boldsymbol{y} = \\boldsymbol{X}\\boldsymbol{J} + \\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\boldsymbol{0}, \\sigma^{2}\\boldsymbol{I})$。因此，似然是一个多元高斯分布：\n$$p(\\boldsymbol{y} | \\boldsymbol{J}, \\boldsymbol{X}, \\sigma^2) = \\mathcal{N}(\\boldsymbol{y} | \\boldsymbol{XJ}, \\sigma^{2}\\boldsymbol{I}_{3})$$\n\n参数 $\\boldsymbol{J}$ 的先验分布被给定为一个零均值高斯分布：\n$$p(\\boldsymbol{J} | \\boldsymbol{S}_{0}) = \\mathcal{N}(\\boldsymbol{J} | \\boldsymbol{0}, \\boldsymbol{S}_{0})$$\n\n由于似然和先验都是高斯分布，因此 $\\boldsymbol{J}$ 的后验分布也是高斯分布，$p(\\boldsymbol{J} | \\boldsymbol{y}, \\boldsymbol{X}) = \\mathcal{N}(\\boldsymbol{J} | \\boldsymbol{\\mu}_{N}, \\boldsymbol{S}_{N})$。后验协方差矩阵 $\\boldsymbol{S}_{N}$ 是通过将先验的精度矩阵和似然数据项的精度矩阵相加得到的（精度矩阵即协方差矩阵的逆）。先验的精度是 $\\boldsymbol{S}_{0}^{-1}$，来自数据的精度是 $\\frac{1}{\\sigma^{2}}\\boldsymbol{X}^{T}\\boldsymbol{X}$。\n后验协方差的逆由下式给出：\n$$\\boldsymbol{S}_{N}^{-1} = \\boldsymbol{S}_{0}^{-1} + \\frac{1}{\\sigma^{2}}\\boldsymbol{X}^{T}\\boldsymbol{X}$$\n\n我们已知以下值：\n设计矩阵是单位矩阵，$\\boldsymbol{X} = \\boldsymbol{I}_{3}$。因此，$\\boldsymbol{X}^{T}\\boldsymbol{X} = \\boldsymbol{I}_{3}^{T}\\boldsymbol{I}_{3} = \\boldsymbol{I}_{3}$。\n噪声方差为 $\\sigma^{2} = 1.0 \\times 10^{-2} \\ \\mathrm{eV}^{2}$。\n先验协方差矩阵是对角的：$\\boldsymbol{S}_{0} = \\mathrm{diag}(s_{1}^{2}, s_{2}^{2}, s_{3}^{2})$，其中 $s_{1}^{2} = 1.0 \\times 10^{-2} \\ \\mathrm{eV}^{2}$，$s_{2}^{2} = 4.0 \\times 10^{-2} \\ \\mathrm{eV}^{2}$，以及 $s_{3}^{2} = 9.0 \\times 10^{-2} \\ \\mathrm{eV}^{2}$。\n\n首先，我们计算先验协方差矩阵的逆 $\\boldsymbol{S}_{0}^{-1}$：\n$$\\boldsymbol{S}_{0}^{-1} = \\mathrm{diag}\\left(\\frac{1}{s_{1}^{2}}, \\frac{1}{s_{2}^{2}}, \\frac{1}{s_{3}^{2}}\\right) = \\mathrm{diag}\\left(\\frac{1}{1.0 \\times 10^{-2}}, \\frac{1}{4.0 \\times 10^{-2}}, \\frac{1}{9.0 \\times 10^{-2}}\\right) = \\mathrm{diag}\\left(100, 25, \\frac{100}{9}\\right) \\ \\mathrm{eV}^{-2}$$\n\n接下来，我们计算数据精度项：\n$$\\frac{1}{\\sigma^{2}}\\boldsymbol{X}^{T}\\boldsymbol{X} = \\frac{1}{1.0 \\times 10^{-2}}\\boldsymbol{I}_{3} = 100 \\boldsymbol{I}_{3} = \\mathrm{diag}(100, 100, 100) \\ \\mathrm{eV}^{-2}$$\n\n现在我们将精度矩阵相加，得到后验精度矩阵 $\\boldsymbol{S}_{N}^{-1}$：\n$$\\boldsymbol{S}_{N}^{-1} = \\mathrm{diag}\\left(100, 25, \\frac{100}{9}\\right) + \\mathrm{diag}(100, 100, 100)$$\n$$\\boldsymbol{S}_{N}^{-1} = \\mathrm{diag}\\left(100+100, 25+100, \\frac{100}{9}+100\\right) = \\mathrm{diag}\\left(200, 125, \\frac{1000}{9}\\right) \\ \\mathrm{eV}^{-2}$$\n\n后验协方差矩阵 $\\boldsymbol{S}_{N}$ 是 $\\boldsymbol{S}_{N}^{-1}$ 的逆：\n$$\\boldsymbol{S}_{N} = (\\boldsymbol{S}_{N}^{-1})^{-1} = \\mathrm{diag}\\left(\\frac{1}{200}, \\frac{1}{125}, \\frac{9}{1000}\\right) \\ \\mathrm{eV}^{2}$$\n$$\\boldsymbol{S}_{N} = \\mathrm{diag}(0.005, 0.008, 0.009) \\ \\mathrm{eV}^{2}$$\n\n参数 $J_{1}$、$J_{2}$ 和 $J_{3}$ 的后验方差是 $\\boldsymbol{S}_{N}$ 的对角元素：\n$\\mathrm{Var}(J_{1} | \\boldsymbol{y}) = (\\boldsymbol{S}_{N})_{11} = 0.005 \\ \\mathrm{eV}^{2}$\n$\\mathrm{Var}(J_{2} | \\boldsymbol{y}) = (\\boldsymbol{S}_{N})_{22} = 0.008 \\ \\mathrm{eV}^{2}$\n$\\mathrm{Var}(J_{3} | \\boldsymbol{y}) = (\\boldsymbol{S}_{N})_{33} = 0.009 \\ \\mathrm{eV}^{2}$\n\n接下来，我们推导在一个新输入向量 $\\boldsymbol{\\phi}_{\\ast} = (0.6, -0.3, 0.2)$ 处的新观测值 $y_{\\ast}$ 的后验预测方差。新观测值的模型为 $y_{\\ast} = \\boldsymbol{\\phi}_{\\ast}^{T}\\boldsymbol{J} + \\varepsilon_{\\ast}$，其中 $\\varepsilon_{\\ast} \\sim \\mathcal{N}(0, \\sigma^{2})$。预测方差 $\\mathrm{Var}(y_{\\ast} | \\boldsymbol{y})$ 考虑了两种不确定性来源：参数 $\\boldsymbol{J}$ 的不确定性（由后验协方差 $\\boldsymbol{S}_{N}$ 体现）和固有的观测噪声 $\\sigma^{2}$。\n预测方差由预测均值的方差与噪声的方差之和给出：\n$$\\mathrm{Var}(y_{\\ast} | \\boldsymbol{y}, \\boldsymbol{X}, \\boldsymbol{\\phi}_{\\ast}) = \\mathrm{Var}(\\boldsymbol{\\phi}_{\\ast}^{T}\\boldsymbol{J} + \\varepsilon_{\\ast} | \\boldsymbol{y}) = \\mathrm{Var}(\\boldsymbol{\\phi}_{\\ast}^{T}\\boldsymbol{J} | \\boldsymbol{y}) + \\mathrm{Var}(\\varepsilon_{\\ast})$$\n$$\\mathrm{Var}(y_{\\ast} | \\boldsymbol{y}) = \\boldsymbol{\\phi}_{\\ast}^{T} \\mathrm{Var}(\\boldsymbol{J} | \\boldsymbol{y}) \\boldsymbol{\\phi}_{\\ast} + \\sigma^{2} = \\boldsymbol{\\phi}_{\\ast}^{T} \\boldsymbol{S}_{N} \\boldsymbol{\\phi}_{\\ast} + \\sigma^{2}$$\n\n我们代入 $\\boldsymbol{\\phi}_{\\ast}$、$\\boldsymbol{S}_{N}$ 和 $\\sigma^{2}$ 的值：\n$$\\boldsymbol{\\phi}_{\\ast}^{T} \\boldsymbol{S}_{N} \\boldsymbol{\\phi}_{\\ast} = \\begin{pmatrix} 0.6  -0.3  0.2 \\end{pmatrix} \\begin{pmatrix} 0.005  0  0 \\\\ 0  0.008  0 \\\\ 0  0  0.009 \\end{pmatrix} \\begin{pmatrix} 0.6 \\\\ -0.3 \\\\ 0.2 \\end{pmatrix}$$\n$$= (0.6)^{2}(0.005) + (-0.3)^{2}(0.008) + (0.2)^{2}(0.009)$$\n$$= (0.36)(0.005) + (0.09)(0.008) + (0.04)(0.009)$$\n$$= 0.0018 + 0.00072 + 0.00036 = 0.00288 \\ \\mathrm{eV}^{2}$$\n\n最后，我们加上噪声方差 $\\sigma^{2}$：\n$$\\mathrm{Var}(y_{\\ast} | \\boldsymbol{y}) = 0.00288 + \\sigma^{2} = 0.00288 + 0.01 = 0.01288 \\ \\mathrm{eV}^{2}$$\n\n问题要求将每个值四舍五入到四位有效数字。\n- $\\mathrm{Var}(J_{1} | \\boldsymbol{y}) = 0.005 \\rightarrow 0.005000 \\ \\mathrm{eV}^{2}$\n- $\\mathrm{Var}(J_{2} | \\boldsymbol{y}) = 0.008 \\rightarrow 0.008000 \\ \\mathrm{eV}^{2}$\n- $\\mathrm{Var}(J_{3} | \\boldsymbol{y}) = 0.009 \\rightarrow 0.009000 \\ \\mathrm{eV}^{2}$\n- $\\mathrm{Var}(y_{\\ast} | \\boldsymbol{y}) = 0.01288 \\rightarrow 0.01288 \\ \\mathrm{eV}^{2}$\n\n所求结果被组合成一个单行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.005000  0.008000  0.009000  0.01288\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "现在，我们将视角从单个计算技术转向整个ICME项目的战略规划。想象一个真实场景：通过探索广阔的成分空间来设计一种新型高熵合金。本练习将指导您如何进行“信封背面”式的估算，以预测一个完整的多尺度建模流程的总计算成本()，这对于项目管理、资源分配和评估项目可行性至关重要。",
            "id": "3746321",
            "problem": "计划开展一场集成计算材料工程 (ICME) 运动，以探索五元高熵合金的成分空间。该探索使用一个代理模型级联，将密度泛函理论 (DFT)、团簇展开 (CE)、蒙特卡洛 (MC) 和相图计算 (CALPHAD) 连接起来。该成分空间表示为五元合金的摩尔分数单纯形，并在每个组分的增量为 $\\delta = 0.05$ 的均匀网格上进行离散化。只有摩尔分数为非负且总和为1的成分才是有效的。\n\n探索策略如下：考虑两种晶格原型，即面心立方 (fcc) 和体心立方 (bcc)。对于每种晶格类型，分别使用 $N_{\\mathrm{train}}^{\\mathrm{fcc}} = 600$ 和 $N_{\\mathrm{train}}^{\\mathrm{bcc}} = 600$ 个独立构型的 DFT 计算能量来训练一个团簇展开模型。每个结构的 DFT 计算成本为 $C_{\\mathrm{DFT}} = 120$ 节点时。拟合每个 CE 的回归和模型构建开销为每种晶格 $C_{\\mathrm{CE,fit}} = 30$ 节点时。训练完成后，CE 用于参数化半巨正则蒙特卡洛模拟，该模拟针对两种晶格上的每个成分网格点运行。每次 MC 运行的成本为每个成分-晶格对 $C_{\\mathrm{MC}} = 0.75$ 节点时。最后，对每个成分网格点执行一次 CALPHAD 同化（与晶格无关），成本为 $C_{\\mathrm{CALPHAD}} = 0.25$ 节点时。\n\n假设该项目必须在 $21$ 天内完成。使用第一性原理计算有效成分数量，并累加整个级联的总计算成本，确定在时间预算内完成所需的平均计算吞吐量（以节点时/天为单位）。\n\n将最终答案四舍五入至四位有效数字。以节点时/天为单位表示最终吞吐量。",
            "solution": "首先根据所需标准验证问题陈述。\n\n### 第一步：提取已知条件\n- 组分数量：$k=5$ (五元合金)\n- 成分网格增量：$\\delta = 0.05$\n- 成分约束：摩尔分数 $x_i \\ge 0$，$\\sum_{i=1}^{5} x_i = 1$\n- 晶格原型数量：$2$ (fcc 和 bcc)\n- fcc 的 DFT 训练构型数：$N_{\\mathrm{train}}^{\\mathrm{fcc}} = 600$\n- bcc 的 DFT 训练构型数：$N_{\\mathrm{train}}^{\\mathrm{bcc}} = 600$\n- 每个构型的 DFT 计算成本：$C_{\\mathrm{DFT}} = 120$ 节点时\n- 每种晶格的团簇展开 (CE) 拟合成本：$C_{\\mathrm{CE,fit}} = 30$ 节点时\n- 每个成分-晶格对的蒙特卡洛 (MC) 成本：$C_{\\mathrm{MC}} = 0.75$ 节点时\n- 每个成分的 CALPHAD 同化成本：$C_{\\mathrm{CALPHAD}} = 0.25$ 节点时\n- 时间预算：$T_{\\mathrm{budget}} = 21$ 天\n\n### 第二步：使用提取的已知条件进行验证\n该问题描述了一个标准的集成计算材料工程 (ICME) 工作流程，这是现代材料科学中一种有科学依据的方法。这些参数和成本对于大规模计算项目是切合实际的。该问题是适定的、客观的、自洽的，并且需要一个标准的组合计算和随后的核算。问题的核心在于确定离散化单纯形中的点数，这是一个明确定义的数学任务。未发现科学、逻辑或结构上的缺陷。\n\n### 第三步：结论与行动\n该问题被认为是有效的，将提供完整的解答。\n\n解答需要确定项目的总计算成本，然后将其除以分配的时间预算。总成本是计算工作流程中每个步骤的成本之和。第一步是计算需要评估的独特成分的数量。\n\n**1. 有效成分的数量**\n\n成分空间是一个五元体系，意味着它有 $k=5$ 个组分。对于 $i \\in \\{1, 2, 3, 4, 5\\}$，摩尔分数 $x_i$ 必须满足 $x_i \\ge 0$ 和 $\\sum_{i=1}^{5} x_i = 1$。成分在增量为 $\\delta = 0.05$ 的网格上离散化。这意味着每个摩尔分数 $x_i$ 可以表示为 $x_i = n_i \\delta$，其中 $n_i$ 是一个非负整数。\n\n将此代入总和约束中：\n$$ \\sum_{i=1}^{5} n_i \\delta = 1 $$\n$$ \\sum_{i=1}^{5} n_i = \\frac{1}{\\delta} $$\n当 $\\delta = 0.05$ 时，整数之和为：\n$$ N = \\frac{1}{0.05} = 20 $$\n因此，问题等价于求方程的非负整数解的数量：\n$$ n_1 + n_2 + n_3 + n_4 + n_5 = 20 $$\n这是一个经典的组合问题，可以使用隔板法解决。解的数量，即有效成分点数 $N_{\\mathrm{comp}}$，由多重集系数给出：\n$$ N_{\\mathrm{comp}} = \\binom{N+k-1}{k-1} = \\binom{20+5-1}{5-1} = \\binom{24}{4} $$\n计算二项式系数：\n$$ N_{\\mathrm{comp}} = \\frac{24!}{4!(24-4)!} = \\frac{24 \\times 23 \\times 22 \\times 21}{4 \\times 3 \\times 2 \\times 1} = 6 \\times 23 \\times 11 \\times 7 = 10626 $$\n网格上有 $N_{\\mathrm{comp}} = 10626$ 个不同的成分。\n\n**2. 总计算成本**\n\n总计算成本 $C_{\\mathrm{total}}$ 是四个阶段成本的总和：DFT、CE 拟合、MC 模拟和 CALPHAD 同化。\n$$ C_{\\mathrm{total}} = C_{\\mathrm{DFT, total}} + C_{\\mathrm{CE,fit, total}} + C_{\\mathrm{MC, total}} + C_{\\mathrm{CALPHAD, total}} $$\n\n- **DFT 成本 ($C_{\\mathrm{DFT, total}}$):** 此成本用于为 CE 模型生成训练数据。\n$$ C_{\\mathrm{DFT, total}} = (N_{\\mathrm{train}}^{\\mathrm{fcc}} + N_{\\mathrm{train}}^{\\mathrm{bcc}}) \\times C_{\\mathrm{DFT}} = (600 + 600) \\times 120 \\text{ 节点时} = 1200 \\times 120 = 144000 \\text{ 节点时} $$\n\n- **CE 拟合成本 ($C_{\\mathrm{CE,fit, total}}$):** 为两种晶格原型中的每一种训练一个 CE 模型。\n$$ C_{\\mathrm{CE,fit, total}} = 2 \\times C_{\\mathrm{CE,fit}} = 2 \\times 30 \\text{ 节点时} = 60 \\text{ 节点时} $$\n\n- **MC 成本 ($C_{\\mathrm{MC, total}}$):** 对两种晶格上的每个 $N_{\\mathrm{comp}}$ 成分运行 MC 模拟。\n$$ C_{\\mathrm{MC, total}} = N_{\\mathrm{comp}} \\times 2 \\times C_{\\mathrm{MC}} = 10626 \\times 2 \\times 0.75 \\text{ 节点时} = 10626 \\times 1.5 = 15939 \\text{ 节点时} $$\n\n- **CALPHAD 成本 ($C_{\\mathrm{CALPHAD, total}}$):** 对每个成分执行一次 CALPHAD 同化。\n$$ C_{\\mathrm{CALPHAD, total}} = N_{\\mathrm{comp}} \\times C_{\\mathrm{CALPHAD}} = 10626 \\times 0.25 \\text{ 节点时} = 2656.5 \\text{ 节点时} $$\n\n现在，将这些成本相加得到总成本：\n$$ C_{\\mathrm{total}} = 144000 + 60 + 15939 + 2656.5 = 162655.5 \\text{ 节点时} $$\n\n**3. 所需计算吞吐量**\n\n该项目必须在 $T_{\\mathrm{budget}} = 21$ 天的时间预算内完成。所需的平均计算吞吐量 $R$ 是总成本除以时间预算。\n$$ R = \\frac{C_{\\mathrm{total}}}{T_{\\mathrm{budget}}} = \\frac{162655.5 \\text{ 节点时}}{21 \\text{ 天}} \\approx 7745.5 \\text{ 节点时/天} $$\n问题要求将最终答案四舍五入到四位有效数字。数值 $7745.5$ 四舍五入到四位有效数字是 $7746$。\n$$ R \\approx 7746 \\text{ 节点时/天} $$\n该值表示按时完成项目所需的平均计算速率。",
            "answer": "$$\\boxed{7.746 \\times 10^{3}}$$"
        }
    ]
}