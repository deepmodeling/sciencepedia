{
    "hands_on_practices": [
        {
            "introduction": "在材料建模中，代理模型（Surrogate model）是连接输入参数和输出属性的高效工具。然而，任何模型预测都伴随着不确定性，因此，校准并量化这种不确定性至关重要。本练习将指导您使用留一法交叉验证（Leave-One-Out Cross-Validation, LOOCV）这一强大的技术，从模型残差中推导出预测误差的概率界限 。",
            "id": "3763738",
            "problem": "考虑一个高熵合金 (HEA) 的属性模型，其中标量响应 $y$（例如，屈服强度）依赖于一个高维成分描述符 $x \\in \\mathbb{R}^{p}$。您拟合了一个形式为 $\\hat{y}(x) = x^{\\top}\\hat{\\beta}$ 的线性 Tikhonov 正则化代理模型，其中 $\\hat{\\beta} = (X^{\\top}X + \\lambda I)^{-1}X^{\\top}y$，$X \\in \\mathbb{R}^{n \\times p}$ 是由 $n$ 个训练输入 $\\{x_{i}\\}_{i=1}^{n}$ 构建的设计矩阵，$y \\in \\mathbb{R}^{n}$ 汇集了相应的训练响应 $\\{y_{i}\\}_{i=1}^{n}$，$\\lambda > 0$ 是正则化参数，$I$ 是单位矩阵。相关的线性平滑器具有帽子矩阵 $S = X(X^{\\top}X + \\lambda I)^{-1}X^{\\top}$，其元素为 $S_{ij}$。假设数据生成过程为 $y_{i} = f(x_{i}) + \\varepsilon_{i}$，其中 $\\varepsilon_{i}$ 是零均值平方可积误差，且方差未知并可能与输入相关。该代理模型提供了一个名义预测方差 $s^{2}(x)$，用于量化其在任何输入 $x$ 处由于参数估计和测量噪声所导致的不确定性，该方差由您的建模流程计算得出。\n\n将训练点 $i$ 的留一法 (LOO) 交叉验证残差定义为 $r_{i} = y_{i} - \\hat{y}^{(-i)}_{i}$，其中 $\\hat{y}^{(-i)}_{i}$ 表示在拟合过程中排除第 $i$ 个样本时，代理模型在 $x_{i}$ 处的预测值。您的目标是使用 $\\{r_{i}\\}_{i=1}^{n}$ 来校准代理模型的名义预测不确定性，并为一个样本外点 $x_{\\ast}$ 推导出一个概率误差界。\n\n仅从平滑器 $\\hat{y} = Sy$ 的线性性质、LOO 交叉验证的定义以及适用于平方可积随机变量的基本概率不等式出发，完成以下任务：\n\n1. 推导样本内残差 $y_{i} - \\hat{y}_{i}$ 与 LOO 残差 $r_{i}$ 之间的关系，用对角杠杆值 $S_{ii}$ 表示。\n2. 令 $s_{i}^{2} := s^{2}(x_{i})$ 表示在训练输入 $x_{i}$ 处的名义预测方差。引入一个乘法校准因子 $\\kappa > 0$，使得在 $x$ 处的校准方差为 $\\kappa\\,s^{2}(x)$。通过最小化经验平方差异 $\\sum_{i=1}^{n}\\left(r_{i}^{2} - \\kappa\\,s_{i}^{2}\\right)^{2}$ 来确定 $\\kappa$，并以闭式形式表达 $\\kappa$。\n3. 对于一个名义方差为 $s^{2}(x_{\\ast})$ 的样本外输入 $x_{\\ast}$，使用校准方差和切比雪夫不等式，获得一个界半径 $B(x_{\\ast},\\alpha)$，使得对于任何 $\\alpha \\in (0,1)$，绝对预测误差满足 $\\mathbb{P}\\!\\left(|y_{\\ast} - \\hat{y}(x_{\\ast})| \\leq B(x_{\\ast},\\alpha)\\right) \\geq 1 - \\alpha$。请将 $B(x_{\\ast},\\alpha)$ 完全用 $\\alpha$、LOO 残差 $\\{r_{i}\\}_{i=1}^{n}$、名义训练方差 $\\{s_{i}^{2}\\}_{i=1}^{n}$ 以及名义样本外方差 $s^{2}(x_{\\ast})$ 来表示。\n\n请将您的最终答案表示为 $B(x_{\\ast},\\alpha)$ 的单一闭式解析表达式。答案无需单位。",
            "solution": "该问题陈述清晰，具有坚实的统计学习理论基础，并为推导正则化线性模型的概率误差界提供了一个完整且一致的框架。我们按以下步骤进行求解，该过程包括三个连续的推导。\n\n第 1 部分：样本内残差与留一法 (LOO) 残差之间的关系。\n\n令 $\\hat{y} = Sy$ 为 Tikhonov 正则化模型预测的向量，其中 $S = X(X^{\\top}X + \\lambda I)^{-1}X^{\\top}$ 是平滑矩阵或帽子矩阵。对于第 $i$ 个训练样本的预测值为 $\\hat{y}_{i} = (Sy)_{i} = \\sum_{j=1}^{n} S_{ij}y_j$。相应的样本内残差为 $e_{i} = y_{i} - \\hat{y}_{i}$。\n\nLOO 预测值 $\\hat{y}^{(-i)}_{i}$ 是使用除第 $i$ 个样本 $(x_{i}, y_{i})$ 之外的所有数据训练的模型，在输入 $x_{i}$ 处的预测值。我们将要推导的一个关于线性平滑器的基本结果，它将 LOO 预测与全数据预测联系起来。这个结果有时被称为留一法引理或 Allen 的 PRESS 公式。\n\n考虑一个修改后的训练集，其中第 $i$ 个样本的响应 $y_i$ 被替换为一个任意值 $y'_i$，而所有其他响应 $y_j$ ($j \\neq i$) 保持不变。新的响应向量为 $y' = y + (y'_i - y_i)e_i$，其中 $e_i$ 是第 $i$ 个标准基向量。由于平滑器的线性特性，在 $x_i$ 处的新预测值为：\n$$ \\hat{y}'_{i} = (Sy')_i = (S(y + (y'_i - y_i)e_i))_i = (Sy)_i + (y'_i - y_i)(Se_i)_i $$\n因为 $(Se_i)_i$ 是 $S$ 的第 $i$ 列的第 $i$ 个元素，也就是对角元素 $S_{ii}$，我们得到：\n$$ \\hat{y}'_{i} = \\hat{y}_{i} + S_{ii}(y'_{i} - y_{i}) $$\n通过留出第 $i$ 个样本训练的模型，等价于一个在完整数据集上训练的模型，但其目标值 $y_i$ 被调整为一个值 $y'_i$，使得模型在 $x_i$ 处的预测值恰好是 $y'_i$。这个自洽条件是 $\\hat{y}'_i = y'_i$。根据定义，所得的 $y'_i$ 值就是 LOO 预测值 $\\hat{y}^{(-i)}_{i}$。我们可以求解这个值：\n$$ y'_{i} = \\hat{y}_{i} + S_{ii}(y'_{i} - y_{i}) $$\n$$ y'_{i}(1 - S_{ii}) = \\hat{y}_{i} - S_{ii}y_{i} $$\n$$ y'_{i} = \\frac{\\hat{y}_{i} - S_{ii}y_{i}}{1 - S_{ii}} $$\n因此，$\\hat{y}^{(-i)}_{i} = \\frac{\\hat{y}_{i} - S_{ii}y_{i}}{1 - S_{ii}}$。LOO 残差 $r_{i}$ 定义为 $r_{i} = y_{i} - \\hat{y}^{(-i)}_{i}$。代入 $\\hat{y}^{(-i)}_{i}$ 的表达式：\n$$ r_{i} = y_{i} - \\frac{\\hat{y}_{i} - S_{ii}y_{i}}{1 - S_{ii}} = \\frac{y_{i}(1 - S_{ii}) - (\\hat{y}_{i} - S_{ii}y_{i})}{1 - S_{ii}} = \\frac{y_{i} - y_{i}S_{ii} - \\hat{y}_{i} + y_{i}S_{ii}}{1 - S_{ii}} $$\n化简后得到 LOO 残差 $r_i$ 和样本内残差 $y_i - \\hat{y}_i$ 之间的期望关系：\n$$ r_{i} = \\frac{y_{i} - \\hat{y}_{i}}{1 - S_{ii}} $$\n\n第 2 部分：校准因子 $\\kappa$ 的确定。\n\n我们的任务是找到一个校准因子 $\\kappa > 0$，使其最小化平方 LOO 残差 $r_{i}^{2}$ 与校准后的名义方差 $\\kappa s_{i}^{2}$ 之间的经验平方差异。需要最小化的目标函数是：\n$$ L(\\kappa) = \\sum_{i=1}^{n}\\left(r_{i}^{2} - \\kappa s_{i}^{2}\\right)^{2} $$\n这是一个标准的最小二乘问题。为了找到最小值，我们将 $L(\\kappa)$ 对 $\\kappa$ 求导，并令结果为零。\n$$ \\frac{dL}{d\\kappa} = \\sum_{i=1}^{n} \\frac{d}{d\\kappa}\\left(r_{i}^{2} - \\kappa s_{i}^{2}\\right)^{2} = \\sum_{i=1}^{n} 2\\left(r_{i}^{2} - \\kappa s_{i}^{2}\\right)(-s_{i}^{2}) $$\n将导数设为零：\n$$ -2 \\sum_{i=1}^{n}\\left(r_{i}^{2}s_{i}^{2} - \\kappa (s_{i}^{2})^{2}\\right) = 0 $$\n$$ \\sum_{i=1}^{n} r_{i}^{2}s_{i}^{2} - \\kappa \\sum_{i=1}^{n} s_{i}^{4} = 0 $$\n解出 $\\kappa$ 得到其闭式表达式：\n$$ \\kappa = \\frac{\\sum_{i=1}^{n} r_{i}^{2}s_{i}^{2}}{\\sum_{i=1}^{n} s_{i}^{4}} $$\n为确认这是一个最小值，我们检查二阶导数：\n$$ \\frac{d^{2}L}{d\\kappa^{2}} = \\sum_{i=1}^{n} 2(s_i^2)^2 = 2\\sum_{i=1}^{n} s_i^4 $$\n由于方差 $s_i^2$ 必须为非负，并且对于任何有意义的不确定性都应为正，因此 $\\sum_{i=1}^{n} s_i^4 > 0$。二阶导数为正证实了我们求得的 $\\kappa$ 值对应于一个最小值。\n\n第 3 部分：界半径 $B(x_{\\ast}, \\alpha)$ 的推导。\n\n我们希望为样本外预测 $x_{\\ast}$ 找到一个界半径 $B(x_{\\ast},\\alpha)$，使得绝对预测误差 $|y_{\\ast} - \\hat{y}(x_{\\ast})|$ 在一定概率下有界。问题指定使用切比雪夫不等式。对于一个均值为 $\\mu$、有限方差为 $\\sigma^2 > 0$ 的随机变量 $Z$，该不等式表述为：\n$$ \\mathbb{P}(|Z - \\mu| \\leq B) \\geq 1 - \\frac{\\sigma^2}{B^2} $$\n对于任何界 $B>0$。\n\n令我们的随机变量为预测误差 $E = y_{\\ast} - \\hat{y}(x_{\\ast})$。在此类校准程序中，一个标准的假设是预测误差以零为中心，即 $\\mathbb{E}[E] = 0$。这个误差的方差 $\\mathrm{Var}(E) = \\mathbb{E}[E^2]$ 是未知的。校准程序的目的是为这个方差提供一个可靠的估计。在 $x_{\\ast}$ 处的校准方差是 $\\kappa s^2(x_{\\ast})$。因此，我们用它作为真实误差方差的估计值：$\\mathrm{Var}(E) \\approx \\kappa s^2(x_{\\ast})$。\n\n将切比雪夫不等式应用于预测误差 $E$：\n$$ \\mathbb{P}\\left(|y_{\\ast} - \\hat{y}(x_{\\ast})| \\leq B\\right) \\geq 1 - \\frac{\\kappa s^2(x_{\\ast})}{B^2} $$\n我们要求这个概率至少为 $1 - \\alpha$。通过将不等式的下界设为 $1-\\alpha$ 来实现这一点：\n$$ 1 - \\alpha = 1 - \\frac{\\kappa s^2(x_{\\ast})}{B^2} $$\n这意味着：\n$$ \\alpha = \\frac{\\kappa s^2(x_{\\ast})}{B^2} $$\n现在我们求解界半径 $B$，记为 $B(x_{\\ast},\\alpha)$：\n$$ B(x_{\\ast},\\alpha)^2 = \\frac{\\kappa s^2(x_{\\ast})}{\\alpha} $$\n$$ B(x_{\\ast},\\alpha) = \\sqrt{\\frac{\\kappa s^2(x_{\\ast})}{\\alpha}} $$\n最后，我们代入第 2 部分中推导出的 $\\kappa$ 的表达式。这就得到了完全用指定量表示的界半径的最终表达式：\n$$ B(x_{\\ast},\\alpha) = \\sqrt{\\frac{s^2(x_{\\ast})}{\\alpha} \\left( \\frac{\\sum_{i=1}^{n} r_{i}^{2}s_{i}^{2}}{\\sum_{i=1}^{n} s_{i}^{4}} \\right)} $$\n这可以写成一个单一的分数形式：\n$$ B(x_{\\ast},\\alpha) = \\sqrt{\\frac{s^2(x_{\\ast}) \\sum_{i=1}^{n} r_{i}^{2}s_{i}^{2}}{\\alpha \\sum_{i=1}^{n} s_{i}^{4}}} $$\n该表达式为新预测提供了所需的概率误差界。",
            "answer": "$$\\boxed{\\sqrt{\\frac{s^{2}(x_{\\ast}) \\sum_{i=1}^{n} r_{i}^{2}s_{i}^{2}}{\\alpha \\sum_{i=1}^{n} s_{i}^{4}}}}$$"
        },
        {
            "introduction": "材料的性能往往受到成分波动或微观结构变化等不确定性输入的影响。多项式混沌展开（Polynomial Chaos Expansion, PCE）是一种核心的非侵入式不确定性量化方法，它能有效地将模型输出表示为这些随机输入的函数。本练习将引导您构建一个稀疏PCE模型，通过应用L1正则化来处理高维输入问题，并估算模型系数 。",
            "id": "3763791",
            "problem": "一种具有等原子基准成分的高熵合金（HEA）由于成分和微观结构的波动，其屈服强度表现出可变性。将随机输入建模如下：成分偏差由标量随机变量 $\\xi_{1} \\sim \\mathrm{Uniform}([-1,1])$ 表示，微观结构波动（例如，归一化对数晶粒尺寸偏差）由 $\\xi_{2} \\sim \\mathcal{N}(0,1)$ 表示。假设 $\\xi_{1}$ 和 $\\xi_{2}$ 是独立的。\n\n使用由标准正交多项式构成的总阶为1的张量积基，为屈服强度 $Y$ 构建一个稀疏多项式混沌展开（PCE）。令 $L_{n}(\\xi_{1})$ 表示关于 $[-1,1]$ 上均匀分布的标准正交化勒让德多项式，令 $\\mathrm{He}_{n}(\\xi_{2})$ 表示关于标准正态分布的标准正交化概率论者埃尔米特多项式。具体地，使用以下三个基函数\n$$\n\\psi_{0}(\\xi_{1},\\xi_{2}) = 1,\\quad \\psi_{1}(\\xi_{1},\\xi_{2}) = L_{1}(\\xi_{1}),\\quad \\psi_{2}(\\xi_{1},\\xi_{2}) = \\mathrm{He}_{1}(\\xi_{2}),\n$$\n其中 $L_{0}(\\xi_{1}) = 1$，$L_{1}(\\xi_{1}) = \\sqrt{3}\\,\\xi_{1}$，$\\mathrm{He}_{0}(\\xi_{2}) = 1$ 以及 $\\mathrm{He}_{1}(\\xi_{2}) = \\xi_{2}$。假设这些基函数在 $(\\xi_{1},\\xi_{2})$ 的联合分布下是标准正交的。\n\n假设真实屈服强度（单位：兆帕，MPa）的一个基于物理的代理模型由下式给出\n$$\nY_{\\mathrm{true}}(\\xi_{1},\\xi_{2}) \\;=\\; 950 \\;+\\; 150\\,L_{1}(\\xi_{1}) \\;-\\; 100\\,\\mathrm{He}_{1}(\\xi_{2}) \\;+\\; 50\\,L_{1}(\\xi_{1})\\,\\mathrm{He}_{1}(\\xi_{2}) \\;+\\; \\varepsilon,\n$$\n其中 $\\varepsilon$ 是一个零均值随机误差，与 $(\\xi_{1},\\xi_{2})$ 相互独立，且具有有限方差。\n\n通过在总体水平上进行 $\\ell_{1}$-正则化回归来估计系数 $\\{c_{j}\\}_{j=0}^{2}$，从而构建稀疏PCE\n$$\nY(\\xi_{1},\\xi_{2}) \\;\\approx\\; c_{0}\\,\\psi_{0}(\\xi_{1},\\xi_{2}) \\;+\\; c_{1}\\,\\psi_{1}(\\xi_{1},\\xi_{2}) \\;+\\; c_{2}\\,\\psi_{2}(\\xi_{1},\\xi_{2}),\n$$\n$$\n\\min_{c_{0},c_{1},c_{2}} \\;\\; \\frac{1}{2}\\,\\mathbb{E}\\!\\left[\\left(Y_{\\mathrm{true}} - c_{0}\\psi_{0} - c_{1}\\psi_{1} - c_{2}\\psi_{2}\\right)^{2}\\right] \\;+\\; \\lambda\\left(|c_{1}| + |c_{2}|\\right),\n$$\n其中截距 $c_{0}$ 不受惩罚。取正则化参数为 $\\lambda = 120$（单位：兆帕，MPa）。\n\n基于 $\\{\\psi_{j}\\}$ 的标准正交性和输入的独立性，从第一性原理推导出系数估计量，然后计算 $(c_{0},c_{1},c_{2})$ 的数值。将每个系数以兆帕（MPa）为单位表示，并将答案四舍五入到四位有效数字。按 $(c_{0},\\,c_{1},\\,c_{2})$ 的顺序列出最终的系数向量作为行矩阵。",
            "solution": "用户希望找到屈服强度 $Y$ 的稀疏多项式混沌展开 (PCE) 的系数 $(c_0, c_1, c_2)$。这些系数通过求解一个 $\\ell_1$-正则化回归问题来确定，该问题通常被称为 LASSO (最小绝对值收缩和选择算子)。\n\n需要最小化的目标函数由下式给出：\n$$\nJ(c_{0},c_{1},c_{2}) = \\frac{1}{2}\\,\\mathbb{E}\\!\\left[\\left(Y_{\\mathrm{true}} - \\left(c_{0}\\psi_{0} + c_{1}\\psi_{1} + c_{2}\\psi_{2}\\right)\\right)^{2}\\right] \\;+\\; \\lambda\\left(|c_{1}| + |c_{2}|\\right)\n$$\n其中 $Y_{\\mathrm{true}}$ 是屈服强度的真实值，$\\{\\psi_{j}\\}_{j=0}^{2}$ 是标准正交基函数，$\\{c_j\\}_{j=0}^2$ 是待确定的系数，$\\lambda = 120$ 是正则化参数。期望 $\\mathbb{E}[\\cdot]$ 是对随机输入 $(\\xi_{1}, \\xi_{2})$ 的联合概率分布计算的。\n\n由于基函数 $\\psi_0$、$\\psi_1$ 和 $\\psi_2$ 是标准正交的，问题得以简化。这意味着 $\\mathbb{E}[\\psi_j \\psi_k] = \\delta_{jk}$，其中 $\\delta_{jk}$ 是克罗内克δ。此性质使得最小化问题有直接的解析解。标准正交基函数集指定为：\n$$\n\\psi_{0} = 1, \\quad \\psi_{1} = L_{1}(\\xi_{1}), \\quad \\psi_{2} = \\mathrm{He}_{1}(\\xi_{2})\n$$\n其中 $L_1$ 和 $\\mathrm{He}_1$ 是标准正交多项式。\n\n最小化问题的解是通过将凸目标函数 $J$ 关于每个系数的次梯度设为零来找到的。\n\n**1. 无惩罚系数 $c_{0}$ 的推导**\n由于截距 $c_0$ 不包含在 $\\ell_1$-惩罚项中，我们可以通过标准的偏微分法求其值：\n$$\n\\frac{\\partial J}{\\partial c_{0}} = \\mathbb{E}\\!\\left[\\frac{\\partial}{\\partial c_{0}} \\frac{1}{2}\\left(Y_{\\mathrm{true}} - c_{0}\\psi_{0} - c_{1}\\psi_{1} - c_{2}\\psi_{2}\\right)^{2}\\right] = -\\mathbb{E}\\!\\left[\\left(Y_{\\mathrm{true}} - c_{0}\\psi_{0} - c_{1}\\psi_{1} - c_{2}\\psi_{2}\\right)\\psi_{0}\\right]\n$$\n将导数设为零，并利用期望的线性性：\n$$\n\\mathbb{E}[Y_{\\mathrm{true}}\\psi_0] - c_0\\mathbb{E}[\\psi_0^2] - c_1\\mathbb{E}[\\psi_1\\psi_0] - c_2\\mathbb{E}[\\psi_2\\psi_0] = 0\n$$\n应用标准正交性条件（$\\mathbb{E}[\\psi_0^2]=1$，$\\mathbb{E}[\\psi_1\\psi_0]=0$，$\\mathbb{E}[\\psi_2\\psi_0]=0$）：\n$$\n\\mathbb{E}[Y_{\\mathrm{true}}\\psi_0] - c_0 = 0 \\implies c_0 = \\mathbb{E}[Y_{\\mathrm{true}}\\psi_0]\n$$\n由于 $\\psi_0=1$，这仅仅是真实模型的期望值：$c_0 = \\mathbb{E}[Y_{\\mathrm{true}}]$。\n\n**2. 带惩罚系数 $c_{1}$ 和 $c_{2}$ 的推导**\n对于带惩罚的系数，我们使用次梯度。$|c_j|$ 的次微分在 $c_j \\neq 0$ 时为 $\\mathrm{sgn}(c_j)$，在 $c_j = 0$ 时为区间 $[-1,1]$。$c_1$ 的最优性条件要求零在次梯度中：\n$$\n0 \\in \\frac{\\partial J}{\\partial c_{1}} = -\\mathbb{E}\\!\\left[\\left(Y_{\\mathrm{true}} - c_{0}\\psi_{0} - c_{1}\\psi_{1} - c_{2}\\psi_{2}\\right)\\psi_{1}\\right] + \\lambda\\,\\partial|c_1|\n$$\n使用标准正交性，上式可简化为：\n$$\n0 \\in -(\\mathbb{E}[Y_{\\mathrm{true}}\\psi_1] - c_1) + \\lambda\\,\\partial|c_1|\n$$\n这个条件由软阈值算子 $S_{\\lambda}(\\cdot)$ 满足。$c_1$ 的解为：\n$$\nc_1 = S_{\\lambda}(\\mathbb{E}[Y_{\\mathrm{true}}\\psi_1]) = \\mathrm{sgn}(\\mathbb{E}[Y_{\\mathrm{true}}\\psi_1]) \\max\\left(|\\mathbb{E}[Y_{\\mathrm{true}}\\psi_1]| - \\lambda, 0\\right)\n$$\n对 $c_2$ 进行相同的推导可得：\n$$\nc_2 = S_{\\lambda}(\\mathbb{E}[Y_{\\mathrm{true}}\\psi_2]) = \\mathrm{sgn}(\\mathbb{E}[Y_{\\mathrm{true}}\\psi_2]) \\max\\left(|\\mathbb{E}[Y_{\\mathrm{true}}\\psi_2]| - \\lambda, 0\\right)\n$$\n项 $\\mathbb{E}[Y_{\\mathrm{true}}\\psi_j]$ 是标准的伽辽金投影系数。我们将其记为 $y_j = \\mathbb{E}[Y_{\\mathrm{true}}\\psi_j]$。\n\n**3. 期望项的计算**\n屈服强度的真实模型由下式给出：\n$$\nY_{\\mathrm{true}} = 950 + 150\\,L_{1}(\\xi_{1}) - 100\\,\\mathrm{He}_{1}(\\xi_{2}) + 50\\,L_{1}(\\xi_{1})\\,\\mathrm{He}_{1}(\\xi_{2}) + \\varepsilon\n$$\n用我们的基函数表示，即为 $Y_{\\mathrm{true}} = 950\\psi_0 + 150\\psi_1 - 100\\psi_2 + 50\\psi_1\\psi_2 + \\varepsilon$。我们使用以下性质：$\\xi_1$ 和 $\\xi_2$ 独立，$\\varepsilon$ 与两者都独立且 $\\mathbb{E}[\\varepsilon]=0$，并且由 $\\psi_0=1$ 的标准正交性，我们有 $\\mathbb{E}[\\psi_1] = \\mathbb{E}[L_1(\\xi_1)]=0$ 和 $\\mathbb{E}[\\psi_2] = \\mathbb{E}[\\mathrm{He}_1(\\xi_2)]=0$。\n\n- **$c_0$ 的计算**：\n$c_0 = \\mathbb{E}[Y_{\\mathrm{true}}] = \\mathbb{E}[950\\psi_0 + 150\\psi_1 - 100\\psi_2 + 50\\psi_1\\psi_2 + \\varepsilon]$\n$c_0 = 950\\mathbb{E}[\\psi_0] + 150\\mathbb{E}[\\psi_1] - 100\\mathbb{E}[\\psi_2] + 50\\mathbb{E}[\\psi_1\\psi_2] + \\mathbb{E}[\\varepsilon]$\n由于独立性，$\\mathbb{E}[\\psi_1\\psi_2] = \\mathbb{E}[\\psi_1]\\mathbb{E}[\\psi_2] = 0 \\cdot 0 = 0$。\n$c_0 = 950(1) + 150(0) - 100(0) + 50(0) + 0 = 950$。\n\n- **$c_1$ 的计算**：\n首先，我们计算投影系数 $y_1 = \\mathbb{E}[Y_{\\mathrm{true}}\\psi_1]$:\n$y_1 = \\mathbb{E}[(950\\psi_0 + 150\\psi_1 - 100\\psi_2 + 50\\psi_1\\psi_2 + \\varepsilon)\\psi_1]$\n$y_1 = 950\\mathbb{E}[\\psi_0\\psi_1] + 150\\mathbb{E}[\\psi_1^2] - 100\\mathbb{E}[\\psi_2\\psi_1] + 50\\mathbb{E}[\\psi_1^2\\psi_2] + \\mathbb{E}[\\varepsilon\\psi_1]$\n使用标准正交性（$\\mathbb{E}[\\psi_0\\psi_1]=0$，$\\mathbb{E}[\\psi_1^2]=1$，$\\mathbb{E}[\\psi_2\\psi_1]=0$）和独立性（$\\mathbb{E}[\\psi_1^2\\psi_2]=\\mathbb{E}[\\psi_1^2]\\mathbb{E}[\\psi_2]=1 \\cdot 0=0$；$\\mathbb{E}[\\varepsilon\\psi_1]=\\mathbb{E}[\\varepsilon]\\mathbb{E}[\\psi_1]=0 \\cdot 0=0$）：\n$y_1 = 950(0) + 150(1) - 100(0) + 50(0) + 0 = 150$。\n现在，应用软阈值法，其中 $\\lambda=120$。由于 $|y_1|=150 > 120$：\n$c_1 = S_{120}(150) = 150 - 120 = 30$。\n\n- **$c_2$ 的计算**：\n首先，我们计算投影系数 $y_2 = \\mathbb{E}[Y_{\\mathrm{true}}\\psi_2]$:\n$y_2 = \\mathbb{E}[(950\\psi_0 + 150\\psi_1 - 100\\psi_2 + 50\\psi_1\\psi_2 + \\varepsilon)\\psi_2]$\n$y_2 = 950\\mathbb{E}[\\psi_0\\psi_2] + 150\\mathbb{E}[\\psi_1\\psi_2] - 100\\mathbb{E}[\\psi_2^2] + 50\\mathbb{E}[\\psi_1\\psi_2^2] + \\mathbb{E}[\\varepsilon\\psi_2]$\n使用标准正交性（$\\mathbb{E}[\\psi_0\\psi_2]=0$，$\\mathbb{E}[\\psi_1\\psi_2]=0$，$\\mathbb{E}[\\psi_2^2]=1$）和独立性（$\\mathbb{E}[\\psi_1\\psi_2^2]=\\mathbb{E}[\\psi_1]\\mathbb{E}[\\psi_2^2]=0 \\cdot 1=0$；$\\mathbb{E}[\\varepsilon\\psi_2]=\\mathbb{E}[\\varepsilon]\\mathbb{E}[\\psi_2]=0 \\cdot 0=0$）：\n$y_2 = 950(0) + 150(0) - 100(1) + 50(0) + 0 = -100$。\n现在，应用软阈值法，其中 $\\lambda=120$。由于 $|y_2|=100 \\le 120$：\n$c_2 = S_{120}(-100) = 0$。\n\n**4. 最终系数**\n计算出的系数为 $(c_0, c_1, c_2) = (950, 30, 0)$。题目要求答案四舍五入到四位有效数字。\n- $c_0 = 950$ 变为 $950.0$。\n- $c_1 = 30$ 变为 $30.00$。\n- $c_2 = 0$ 变为 $0.000$ 以表示精度，尽管 $0$ 没有非零有效数字。选择此格式是为了保持一致性。\n\n最终的系数向量为 $(950.0, 30.00, 0.000)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 950.0  30.00  0.000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "贝叶斯推断为材料模型校准提供了强大的框架，但它依赖于马尔可夫链蒙特卡洛（MCMC）等采样方法。评估MCMC模拟是否已收敛到目标后验分布，是确保推断结果可靠性的关键步骤。本练习提供了一个实际的校准场景，要求您计算并解释两个核心收敛诊断指标：Gelman-Rubin统计量（$\\hat{R}$）和有效样本量（Effective Sample Size, ESS），这是MCMC分析中的必备技能 。",
            "id": "3763799",
            "problem": "对一种面心立方高熵合金的本构模型进行贝叶斯校准，其参数向量为 $\\theta=(K,G,\\alpha)\\in\\Theta\\subset\\mathbb{R}^3$，由体积模量 $K$、剪切模量 $G$ 和一个短程有序参数 $\\alpha$ 组成。物理上允许的参数域 $\\Theta$ 是紧致且连通的。后验密度 $\\pi(\\theta)\\propto L(y\\mid\\theta)p(\\theta)$ 在 $\\Theta$ 上是正且连续的，其中先验 $p(\\theta)$ 的支撑集为 $\\Theta$。使用随机游走 Metropolis 算法，其建议分布 $q(\\theta'\\mid\\theta)$ 为截断在 $\\Theta$ 上的对称高斯分布，并采用包含拒绝可能性的常规接受准则。\n\n在预热期后，你运行了 $m=3$ 条独立的马尔可夫链蒙特卡洛 (MCMC) 链，每条链保留 $n=2000$ 次迭代，以校准 $G$（单位为吉帕斯卡，但在此视为一个无量纲的数值变量）。$G$ 的各链样本均值和方差如下：\n- 链 1：均值 $79.5$，方差 $9.0$，\n- 链 2：均值 $80.1$，方差 $8.0$，\n- 链 3：均值 $79.9$，方差 $10.0$。\n\n从所有链中合并的 $G$ 的抽样中，估计的滞后自相关系数为：\n- $\\rho_1=0.5$，$\\rho_2=0.3$，$\\rho_3=0.1$，$\\rho_4=-0.05$，$\\rho_5=-0.02$，$\\rho_6=-0.01$。\n\n利用马尔可夫链的不可约性、非周期性、Harris 递归性以及漂移/次控制（drift/minorization）的基本定义，结合链间和链内方差分解以及基于自相关的有效样本量 (ESS) 的概念，判断以下关于此校准任务的遍历性条件和收敛性诊断的陈述中哪些是正确的。Gelman–Rubin 潜在尺度缩减因子 (PSRF)，记作 $\\hat{R}$，以及有效样本量 (ESS) 均指其在 MCMC 收敛性评估中的标准用法。\n\nA. 在所述条件下（后验密度 $\\pi(\\theta)$ 在紧致集 $\\Theta$ 上是正且连续的，对称建议分布 $q(\\theta'\\mid\\theta)$ 在邻域上具有正密度，且拒绝概率非零），Metropolis 链是不可约和非周期的，因此是 Harris 递归的；此外，由于 $\\Theta$ 是紧致的，$\\pi(\\theta)$ 在 $\\Theta$ 上有界且远离零，且 $q$ 局部有下界，因此在 $\\Theta$ 上存在一个全局次控制条件（global minorization condition），这意味着几何遍历性。\n\nB. 仅当测量噪声分布的方差有限时，该链才是几何遍历的；如果后验分布具有重尾，随机游走 Metropolis 算法将变为非遍历的。\n\nC. 对于 $G$，根据所提供的摘要信息计算出的 Gelman–Rubin PSRF $\\hat{R}$ 约等于 $1.005$，而基于合并的自相关系数计算出的 ESS 约为 $6000$ 次总保留抽样中的 $2200$。\n\nD. 一条足够长的链就足以计算 $\\hat{R}$，并且当自相关接近于零时，$\\hat{R}$ 可能小于 $1$。\n\nE. 无论自相关如何，ESS 都等于保留的总迭代次数；因此，对于 3 条各有 2000 次保留迭代的链，$\\mathrm{ESS}=6000$。\n\n选择所有正确的选项。",
            "solution": "用户要求对问题陈述进行详细验证，然后完整推导解决方案并评估所有选项。\n\n### 步骤 1：提取给定信息\n\n-   **模型**：面心立方高熵合金的本构模型。\n-   **参数向量**：$\\theta=(K,G,\\alpha)\\in\\Theta\\subset\\mathbb{R}^3$。\n-   **参数域**：$\\Theta$ 是紧致且连通的。\n-   **贝叶斯设置**：后验密度 $\\pi(\\theta)\\propto L(y\\mid\\theta)p(\\theta)$ 在 $\\Theta$ 上是正且连续的。先验 $p(\\theta)$ 的支撑集为 $\\Theta$。\n-   **算法**：随机游走 Metropolis，采用截断在 $\\Theta$ 上的对称高斯建议分布 $q(\\theta'\\mid\\theta)$。接受准则是标准的，具有非零的拒绝概率。\n-   **MCMC 运行细节**：$m=3$ 条独立链，在预热期后运行。每条链保留 $n=2000$ 次迭代。保留的总抽样数为 $N=mn=6000$。\n-   **剪切模量 $G$ 的数据**：\n    -   链 1：均值 $\\bar{G}_1 = 79.5$，方差 $s_1^2 = 9.0$。\n    -   链 2：均值 $\\bar{G}_2 = 80.1$，方差 $s_2^2 = 8.0$。\n    -   链 3：均值 $\\bar{G}_3 = 79.9$，方差 $s_3^2 = 10.0$。\n-   **$G$ 的自相关数据（来自合并抽样）**：\n    -   $\\rho_1=0.5$, $\\rho_2=0.3$, $\\rho_3=0.1$, $\\rho_4=-0.05$, $\\rho_5=-0.02$, $\\rho_6=-0.01$。\n-   **问题**：评估关于遍历性条件和收敛性诊断的给定陈述的正确性，特别是 Gelman–Rubin 潜在尺度缩减因子（$\\hat{R}$）和有效样本量（ESS）。\n\n### 步骤 2：使用提取的给定信息进行验证\n\n-   **科学基础**：该问题在计算材料科学和贝叶斯统计领域有坚实的基础。其应用（校准高熵合金的本构模型）是一个现实且重要的研究领域。所描述的方法（贝叶斯推断、MCMC、Metropolis 算法）和使用的诊断工具（$\\hat{R}$、ESS）都是标准工具。参数（$K$、$G$、$\\alpha$）具有物理意义。\n-   **适定性**：该问题是适定的。它提供了清晰的理论设置和充分的数值数据来评估每个选项中的声明。问题明确无歧义。\n-   **客观性**：语言技术性强、精确，没有主观或基于观点的陈述。\n-   **完整性和一致性**：问题是自洽的。关于后验分布和状态空间的理论条件陈述清晰。数值数据内部一致，足以进行所需的计算。设置中没有矛盾。\n-   **现实性和可行性**：数值是现实的。对于许多金属合金而言，剪切模量 $G$ 在 $80$ GPa 左右是典型的。自相关值表明 MCMC 采样器效率中等但合理。\n-   **其他缺陷**：问题不是琐碎的、同义反复的或不适定的。它要求对 MCMC 方法的理论和实践都有扎实的理解。\n\n### 步骤 3：结论和行动\n\n问题陈述是有效的。它在科学上是合理的、适定的，并包含足够的信息以进行全面分析。\n\n### 解决方案和选项分析\n\n问题是有效的。我们现在开始分析每个陈述。\n\n**A. 在所述条件下（后验密度 $\\pi(\\theta)$ 在紧致集 $\\Theta$ 上是正且连续的，对称建议分布 $q(\\theta'\\mid\\theta)$ 在邻域上具有正密度，且拒绝概率非零），Metropolis 链是不可约和非周期的，因此是 Harris 递归的；此外，由于 $\\Theta$ 是紧致的，$\\pi(\\theta)$ 在 $\\Theta$ 上有界且远离零，且 $q$ 局部有下界，因此在 $\\Theta$ 上存在一个全局次控制条件（global minorization condition），这意味着几何遍历性。**\n\n该陈述对所描述的马尔可夫链的理论性质提出了几个主张。\n1.  **不可约性**：建议分布 $q(\\theta'\\mid\\theta)$ 是一个截断高斯分布，在连通空间 $\\Theta$ 内的 $\\theta$ 的邻域中具有正密度。目标密度 $\\pi(\\theta)$ 在 $\\Theta$ 上严格为正。这确保了从任何状态 $\\theta$ 出发，都有正的概率接受移动到其邻域中的状态 $\\theta'$。由于 $\\Theta$ 是连通的，任何状态都可以在有限步内从任何其他状态到达。因此，该链是 $\\pi$-不可约的。\n2.  **非周期性**：Metropolis 算法具有非零的拒绝概率，这意味着链可以停留在同一状态（$\\theta_t = \\theta_{t+1}$）。每个状态的这种自循环足以保证非周期性。\n3.  **Harris 递归性**：拥有平稳分布的不可约马尔可夫链是 Harris 递归的。根据构造，Metropolis 算法以 $\\pi(\\theta)$ 作为其平稳分布。鉴于其不可约性，它必须是 Harris 递归的。\n4.  **几何遍历性**：几何遍历性意味着向平稳分布的收敛速度是指数级的。对此，一个充分条件是存在一个漂移条件，或者在这种情况下更简单地说，是整个状态空间都是一个“小集”的性质。对于紧致状态空间 $\\Theta$ 上的马尔可夫链，如果目标密度 $\\pi(\\theta)$ 是连续且严格为正的（因此有下界，即 $\\pi(\\theta) \\ge \\delta > 0$），并且建议密度表现良好（例如，局部有下界），则存在一个次控制条件：$P(\\theta, A) \\ge \\epsilon \\nu(A)$，对于某个 $\\epsilon > 0$ 和概率测度 $\\nu$。这意味着一致遍历性，它比几何遍历性更强。该选项中提出的推理是高级 MCMC 理论的标准结果。该选项中描述的所有条件都足以确立几何遍历性。\n\n该陈述中的逻辑链是合理的，并与已建立的 MCMC 理论一致。\n\n结论：**正确**。\n\n**B. 仅当测量噪声分布的方差有限时，该链才是几何遍历的；如果后验分布具有重尾，随机游走 Metropolis 算法将变为非遍历的。**\n\n该陈述提出了关于遍历性的两个主张。\n1.  **“当且仅当”的主张**：几何遍历性取决于后验分布的全局性质和状态空间 $\\Theta$ 上的建议机制。将其用“当且仅当”的条件与似然的单个方面（例如测量噪声的方差）联系起来，是一种过度简化，并且通常是错误的。例如，即使有高斯噪声（有限方差），一个不可识别的模型或重尾先验也可能导致后验分布在使用随机游走 Metropolis 采样器于*无界*空间上时不是几何遍历的。反之，在这个问题中，状态空间 $\\Theta$ 是紧致的。正如在 A 中确立的，这种紧致性，加上正的连续后验，是一个非常强的条件，确保了几何遍历性，而与噪声模型的尾部行为无关。\n2.  **“重尾”的主张**：这个主张断言重尾后验使得链“非遍历”。这混淆了遍历性与收敛*速度*。如果一条链收敛到其平稳分布，它就是遍历的。重尾可能导致链不是*几何*遍历的，意味着收敛可能是多项式级的缓慢而不是指数级的快。然而，链通常仍然是遍历的（即，它会收敛）。因此，说它变为“非遍历的”是不正确的。\n\n这个陈述的两个部分都是不正确的。\n\n结论：**错误**。\n\n**C. 对于 $G$，根据所提供的摘要信息计算出的 Gelman–Rubin PSRF $\\hat{R}$ 约等于 $1.005$，而基于合并的自相关系数计算出的 ESS 约为 $6000$ 次总保留抽样中的 $2200$。**\n\n这个陈述需要进行数值验证。\n-   **Gelman-Rubin PSRF ($\\hat{R}$)**：\n    公式为 $\\hat{R} = \\sqrt{\\frac{\\widehat{\\mathrm{Var}}^+}{W}}$，其中 $W$ 是链内方差，$\\widehat{\\mathrm{Var}}^+$ 是估计的边际后验方差。\n    -   链数 $m=3$，每条链的迭代次数 $n=2000$。\n    -   链内方差 $W = \\frac{1}{m}\\sum_{j=1}^m s_j^2 = \\frac{1}{3}(9.0 + 8.0 + 10.0) = \\frac{27.0}{3} = 9.0$。\n    -   总均值 $\\bar{\\bar{G}} = \\frac{1}{m}\\sum_{j=1}^m \\bar{G}_j = \\frac{1}{3}(79.5 + 80.1 + 79.9) = \\frac{239.5}{3} \\approx 79.8333$。\n    -   链间方差 $B = \\frac{n}{m-1}\\sum_{j=1}^m (\\bar{G}_j - \\bar{\\bar{G}})^2 = \\frac{2000}{2} \\left[ (79.5 - \\frac{239.5}{3})^2 + (80.1 - \\frac{239.5}{3})^2 + (79.9 - \\frac{239.5}{3})^2 \\right] = 1000 \\left[ (-\\frac{1}{3})^2 + (\\frac{0.8}{3})^2 + (\\frac{0.2}{3})^2 \\right] = 1000 \\left[ \\frac{1}{9} + \\frac{0.64}{9} + \\frac{0.04}{9} \\right] = 1000 \\frac{1.68}{9} \\approx 186.67$。\n    -   估计方差 $\\widehat{\\mathrm{Var}}^+ = \\frac{n-1}{n}W + \\frac{1}{n}B = \\frac{1999}{2000}(9.0) + \\frac{186.67}{2000} \\approx (0.9995)(9.0) + 0.093335 = 8.9955 + 0.093335 = 9.088835$。\n    -   PSRF $\\hat{R} = \\sqrt{\\frac{9.088835}{9.0}} = \\sqrt{1.00987...} \\approx 1.0049$。\n    计算出的值 $\\hat{R} \\approx 1.0049$ 与声称的约等于 $1.005$ 的值是一致的。\n\n-   **有效样本量 (ESS)**：\n    公式为 $\\mathrm{ESS} = \\frac{N}{1 + 2\\sum_{t=1}^T \\rho_t}$，其中 $N = 6000$，$\\rho_t$ 是滞后 $t$ 的自相关系数。求和在某个滞后 $T$ 处截断。一个常见的启发式方法是当自相关为正且递减时进行求和，或者更可靠地，求和到估计值变得过于嘈杂（通常由负值表示）之前的第一个滞后 $t$。让我们使用求和到成对自相关和 $\\rho_t + \\rho_{t+1}$ 变为负值之前的滞后 $T$ 的规则。这里 $\\rho_3+\\rho_4=0.05 > 0$ 并且 $\\rho_4+\\rho_5=-0.07 < 0$。一个合理的选择是求和到 $T=4$。\n    -   $\\sum_{t=1}^4 \\rho_t = 0.5 + 0.3 + 0.1 - 0.05 = 0.85$。\n    -   $\\mathrm{ESS} = \\frac{6000}{1 + 2(0.85)} = \\frac{6000}{1 + 1.7} = \\frac{6000}{2.7} \\approx 2222.2$。\n    这个计算出的约 $2222$ 的值非常接近声称的约 $2200$ 的值。微小的差异可以忽略不计，很可能是由于未指定的不同自相关求和截断/加窗规则造成的。该近似是有效的。\n\n该陈述的两个部分都通过标准计算得到了验证。\n\n结论：**正确**。\n\n**D. 一条足够长的链就足以计算 $\\hat{R}$，并且当自相关接近于零时，$\\hat{R}$ 可能小于 $1$。**\n\n1.  **“一条足够长的链就足以计算 $\\hat{R}$”**：这在根本上是错误的。Gelman-Rubin 诊断 $\\hat{R}$ 的设计初衷就是为了比较多个并行链*之间*的方差（$B$）与每个链*内部*的方差（$W$）。根据其定义，它需要多条链（$m>1$）。从单条链中计算 $\\hat{R}$ 是不可能的。\n2.  **“$\\hat{R}$ 可能小于 $1$...”**：$\\hat{R}^2$ 的公式是 $\\frac{n-1}{n} + \\frac{B}{nW}$。为了使 $\\hat{R}$ 小于 $1$，我们需要 $\\hat{R}^2 < 1$，这意味着 $\\frac{n-1}{n} + \\frac{B}{nW} < 1$。这简化为 $B < W$。由于抽样变异性，基于样本的链间方差估计 $B$ 有可能小于基于样本的链内方差估计 $W$，尤其是在预收敛的链或 $n$ 较小的情况下。所以，从数学上讲，$\\hat{R}$ 可能小于 $1$。然而，陈述的第一部分是明确错误的，导致整个联合陈述不正确。\n\n结论：**错误**。\n\n**E. 无论自相关如何，ESS 都等于保留的总迭代次数；因此，对于 3 条各有 2000 次保留迭代的链，$\\mathrm{ESS}=6000$。**\n\n这个陈述从根本上误解了有效样本量 (ESS) 的定义。ESS 的定义是 $\\mathrm{ESS} = N / \\tau$，其中 $N$ 是总样本数，$\\tau = 1 + 2\\sum_{t=1}^\\infty \\rho_t$ 是积分自相关时间。\n-   ESS 等于总迭代次数 $N$ 当且仅当 $\\tau=1$，这要求对于 $t \\ge 1$ 的所有自相关 $\\rho_t$ 都为零。这对应于一组完全独立的样本。\n-   MCMC 算法生成的是相关样本，因此至少在一些初始滞后中 $\\rho_t > 0$，这意味着 $\\tau > 1$ 且 $\\mathrm{ESS} < N$。\n-   问题明确给出了非零的自相关系数（$\\rho_1=0.5$ 等），我们在 C 中的计算也证实了 $\\mathrm{ESS} \\approx 2200$，远小于 $N=6000$。\n-   该陈述说 ESS *无论自相关如何* 都等于总抽样数，这与其定义和目的直接矛盾。\n\n结论：**错误**。\n\n### 结论摘要\n\n-   A: 正确\n-   B: 错误\n-   C: 正确\n-   D: 错误\n-   E: 错误\n\n正确的选项是 A 和 C。",
            "answer": "$$\\boxed{AC}$$"
        }
    ]
}