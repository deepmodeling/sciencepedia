{
    "hands_on_practices": [
        {
            "introduction": "多尺度建模的核心挑战之一是在不同尺度之间建立联系。此实践将带你体验一种经典的“自下而上”方法，即使用柯西-玻恩(Cauchy-Born)定则。我们将从一个描述原子间相互作用的有效势函数出发，直接推导出材料的宏观弹性常数，从而揭示微观作用如何决定宏观力学行为。",
            "id": "3752520",
            "problem": "考虑一种具有面心立方 (FCC) 晶格的等原子高熵合金 (HEA)。为了在分层多尺度框架中连接原子尺度和连续介质尺度，请使用 Cauchy–Born 法则，通过一个经由等效介质近似表示化学无序的等效中心对势，来推导晶体的等效弹性常数。假设以下符合科学实际的设定：\n\n- 在 $0\\,\\text{K}$ 时，晶格常数为 $a_0 = 3.60\\,\\text{\\AA}$。\n- 只考虑最近邻相互作用，其中有 $z_1 = 12$ 个最近邻，距离为 $r_1 = a_0 / \\sqrt{2}$，键方向对应于 FCC 的面对角线。\n- 原子间相互作用由一个等效 Morse 势 $\nV(r) = D_e\\left[\\exp\\!\\left(-2 a (r - r_0)\\right) - 2\\exp\\!\\left(-a (r - r_0)\\right)\\right],\n$ 建模，其参数为 $D_e = 0.30\\,\\text{eV}$，$a = 2.00\\,\\text{\\AA}^{-1}$，平衡距离 $r_0 = r_1$。\n- 晶体数密度为 $\\rho = 4/a_0^3$。\n\n使用 Cauchy–Born 法则，并假设在 $r = r_0$ 处处于力学平衡（因此一阶导数项为零），通过对键方向贡献的晶格求和来计算立方弹性常数 $C_{11}$ 和 $C_{12}$，使用 $1\\,\\text{eV}/\\text{\\AA}^3 = 160.21766208\\,\\text{GPa}$ 将它们转换为吉帕 (GPa)，然后将它们与在一个并行原子-连续介质耦合框架中获得的基于分子动力学 (MD) 的估计值 $C_{11}^{\\mathrm{MD}} = 195\\,\\text{GPa}$ 和 $C_{12}^{\\mathrm{MD}} = 115\\,\\text{GPa}$ 进行比较。\n\n定义偏差度量 $\nD = \\sqrt{\\left(\\frac{C_{11}^{\\mathrm{CB}} - C_{11}^{\\mathrm{MD}}}{C_{11}^{\\mathrm{MD}}}\\right)^2 + \\left(\\frac{C_{12}^{\\mathrm{CB}} - C_{12}^{\\mathrm{MD}}}{C_{12}^{\\mathrm{MD}}}\\right)^2},\n$ 其中 $C_{ij}^{\\mathrm{CB}}$ 是 Cauchy–Born 法则的计算结果，$C_{ij}^{\\mathrm{MD}}$ 是基于 MD 的估计值。\n\n计算 $D$ 并将您的答案四舍五入到四位有效数字。最终答案以不带单位的小数形式表示。",
            "solution": "该问题要求计算偏差度量 $D$，它量化了使用 Cauchy–Born 法则计算的弹性常数 ($C_{ij}^{\\mathrm{CB}}$) 与通过分子动力学模拟获得的弹性常数 ($C_{ij}^{\\mathrm{MD}}$) 之间的差异。该系统是一种等原子面心立方 (FCC) 高熵合金，其原子间相互作用由一个等效 Morse 势建模。\n\n首先，我们建立理论框架。Cauchy–Born 法则提供了原子尺度（原子间势）和连续介质尺度（弹性常数）之间的联系。对于一个由中心对势 $V(r)$ 描述且无初始应力（即晶格处于力学平衡状态）的中心对称晶格（如 FCC），可以推导出立方弹性常数的表达式。在晶格常数为 $a_0$ 的 FCC 晶格中，只考虑最近邻相互作用，最近邻距离为 $r_1 = a_0 / \\sqrt{2}$。$C_{11}$ 和 $C_{12}$ 的标准表达式为：\n$$C_{11} = \\frac{2}{a_0} \\frac{d^2V}{dr^2}\\bigg|_{r=r_1}$$\n$$C_{12} = \\frac{1}{a_0} \\frac{d^2V}{dr^2}\\bigg|_{r=r_1}$$\n这些关系满足中心势的 Cauchy 关系 $C_{12} = C_{44}$，并且对于此特定模型（FCC，最近邻），也意味着 $C_{11} = 2C_{12}$。\n\n问题提供了等效 Morse 势：\n$$V(r) = D_e\\left[\\exp(-2 a (r - r_0)) - 2\\exp(-a (r - r_0))\\right]$$\n我们需要计算它的二阶导数 $V''(r)$。一阶导数为：\n$$V'(r) = \\frac{dV}{dr} = D_e\\left[-2a\\exp(-2a(r-r_0)) + 2a\\exp(-a(r-r_0))\\right]$$\n二阶导数为：\n$$V''(r) = \\frac{d^2V}{dr^2} = D_e\\left[4a^2\\exp(-2a(r-r_0)) - 2a^2\\exp(-a(r-r_0))\\right]$$\n\n问题指明晶格处于平衡状态，势的平衡距离 $r_0$ 等于最近邻距离 $r_1$。这确保了势的一阶导数在原子间距处为零，即 $V'(r_1) = V'(r_0) = 0$，与无初始应力的假设一致。我们在 $r = r_1 = r_0$ 处计算二阶导数：\n$$V''(r_1) = V''(r_0) = D_e\\left[4a^2\\exp(0) - 2a^2\\exp(0)\\right] = D_e(4a^2 - 2a^2) = 2a^2 D_e$$\n\n现在，我们代入给定的势参数值：$D_e = 0.30\\,\\text{eV}$ 和 $a = 2.00\\,\\text{\\AA}^{-1}$。\n$$V''(r_1) = 2 \\times (2.00\\,\\text{\\AA}^{-1})^2 \\times (0.30\\,\\text{eV}) = 2 \\times 4.00\\,\\text{\\AA}^{-2} \\times 0.30\\,\\text{eV} = 2.40\\,\\text{eV}/\\text{\\AA}^2$$\n\n利用这个结果和给定的晶格常数 $a_0 = 3.60\\,\\text{\\AA}$，我们可以计算出以 $\\text{eV}/\\text{\\AA}^3$ 为单位的弹性常数：\n$$C_{11}^{\\mathrm{CB}} = \\frac{2}{a_0}V''(r_1) = \\frac{2}{3.60\\,\\text{\\AA}} \\times (2.40\\,\\text{eV}/\\text{\\AA}^2) = \\frac{4.80}{3.60}\\,\\text{eV}/\\text{\\AA}^3 = \\frac{4}{3}\\,\\text{eV}/\\text{\\AA}^3$$\n$$C_{12}^{\\mathrm{CB}} = \\frac{1}{a_0}V''(r_1) = \\frac{1}{3.60\\,\\text{\\AA}} \\times (2.40\\,\\text{eV}/\\text{\\AA}^2) = \\frac{2.40}{3.60}\\,\\text{eV}/\\text{\\AA}^3 = \\frac{2}{3}\\,\\text{eV}/\\text{\\AA}^3$$\n\n接下来，我们使用提供的转换因子 $1\\,\\text{eV}/\\text{\\AA}^3 = 160.21766208\\,\\text{GPa}$ 将这些值转换为吉帕 (GPa)。\n$$C_{11}^{\\mathrm{CB}} = \\frac{4}{3} \\times 160.21766208\\,\\text{GPa} \\approx 213.623549\\,\\text{GPa}$$\n$$C_{12}^{\\mathrm{CB}} = \\frac{2}{3} \\times 160.21766208\\,\\text{GPa} \\approx 106.811775\\,\\text{GPa}$$\n\n最后，我们使用计算出的 Cauchy–Born 值和给定的基于 MD 的估计值 $C_{11}^{\\mathrm{MD}} = 195\\,\\text{GPa}$ 和 $C_{12}^{\\mathrm{MD}} = 115\\,\\text{GPa}$ 来计算偏差度量 $D$。\n$$D = \\sqrt{\\left(\\frac{C_{11}^{\\mathrm{CB}} - C_{11}^{\\mathrm{MD}}}{C_{11}^{\\mathrm{MD}}}\\right)^2 + \\left(\\frac{C_{12}^{\\mathrm{CB}} - C_{12}^{\\mathrm{MD}}}{C_{12}^{\\mathrm{MD}}}\\right)^2}$$\n我们计算相对差异：\n$$\\frac{C_{11}^{\\mathrm{CB}} - C_{11}^{\\mathrm{MD}}}{C_{11}^{\\mathrm{MD}}} = \\frac{213.623549 - 195}{195} = \\frac{18.623549}{195} \\approx 0.09550538$$\n$$\\frac{C_{12}^{\\mathrm{CB}} - C_{12}^{\\mathrm{MD}}}{C_{12}^{\\mathrm{MD}}} = \\frac{106.811775 - 115}{115} = \\frac{-8.188225}{115} \\approx -0.07120196$$\n\n现在，我们将这些值代入 $D$ 的表达式中：\n$$D = \\sqrt{(0.09550538)^2 + (-0.07120196)^2}$$\n$$D = \\sqrt{0.00912128 + 0.00506972} = \\sqrt{0.01419100} \\approx 0.11912598$$\n\n将结果四舍五入到四位有效数字，我们得到：\n$$D \\approx 0.1191$$",
            "answer": "$$\\boxed{0.1191}$$"
        },
        {
            "introduction": "在分层建模中，我们通常通过对一个小的“代表性体积单元”（RVE）进行均匀化来获得等效性能。然而，一个关键问题随之而来：RVE需要多大才能精确地代表整体材料？本实践将探讨RVE概念背后的统计学基础，并推导出一个尺度定律，以根据微观结构的关联长度来确定所需的最小RVE尺寸。",
            "id": "3752508",
            "problem": "在高熵合金（HEA）的分层多尺度框架中，宏观本构响应是通过对一个代表性体积单元（RVE）进行均质化来获得的。该RVE取自有有限相关长度$\\ell$的统计均匀微观结构，其边长为$L$。设$X(\\mathbf{x})$表示一个平稳遍历标量属性场（例如，局部弹性模量），其系综平均值为$\\mu$，微观方差为$\\sigma_{0}^{2}$。在尺度$L$上的表观均质化属性是体积为$V=L^{d}$（其中$d=3$）的立方体RVE上的体积平均$\\bar{X}_{L}=\\frac{1}{V}\\int_{V} X(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x}$。从空间平均随机场的中心极限定理以及两点相关函数$C(\\mathbf{r})=\\langle\\delta X(\\mathbf{x})\\delta X(\\mathbf{x}+\\mathbf{r})\\rangle/\\sigma_{0}^{2}$（其中$\\delta X(\\mathbf{x})=X(\\mathbf{x})-\\mu$）的定义出发，假设存在短程相关性，其在相关长度$\\ell$上衰减，并定义一个有效相关体积$V_{c}\\approx \\ell^{d}$。利用这些基本原理，推导归一化方差$\\mathrm{Var}[\\bar{X}_{L}]/\\sigma_{0}^{2}$随$L$变化的标度关系，并确定所需的最小边长$L_{RVE}$，以确保在$d=3$时归一化方差满足$\\mathrm{Var}[\\bar{X}_{L}]/\\sigma_{0}^{2}\\leq 0.01$。请用$\\ell$的闭式解析表达式表示最终答案。最终答案中不包含单位。无需四舍五入。",
            "solution": "该问题的目标是推导体积平均属性 $\\bar{X}_{L}$ 的方差与 RVE 尺寸 $L$ 之间的标度关系。\n\n体积平均属性的方差定义为 $\\mathrm{Var}[\\bar{X}_{L}] = \\langle (\\bar{X}_{L} - \\langle \\bar{X}_{L} \\rangle)^{2} \\rangle$。由于属性场 $X(\\mathbf{x})$ 是平稳的，其均值为常数 $\\mu$，因此体积平均的均值也为 $\\mu$。方差可以写作：\n$$\n\\mathrm{Var}[\\bar{X}_{L}] = \\left\\langle \\left( \\frac{1}{V}\\int_{V} (X(\\mathbf{x}) - \\mu)\\,\\mathrm{d}\\mathbf{x} \\right)^2 \\right\\rangle = \\frac{1}{V^2} \\int_{V}\\int_{V} \\langle \\delta X(\\mathbf{x})\\delta X(\\mathbf{y}) \\rangle \\,\\mathrm{d}\\mathbf{x}\\,\\mathrm{d}\\mathbf{y}\n$$\n其中 $\\delta X(\\mathbf{x}) = X(\\mathbf{x}) - \\mu$，$\\langle \\delta X(\\mathbf{x})\\delta X(\\mathbf{y}) \\rangle = \\sigma_{0}^{2} C(\\mathbf{y}-\\mathbf{x})$ 是两点协方差函数。\n\n一个更直观的推导是基于中心极限定理的论证。由于微观结构的相关性在长度 $\\ell$ 上衰减，我们可以将体积为 $V=L^d$ 的 RVE 视为由 $N_{eff}$ 个有效独立的子块组成。每个子块的体积约为相关体积 $V_c \\approx \\ell^d$。因此，有效独立块的数量为：\n$$\nN_{eff} \\approx \\frac{V}{V_c} = \\frac{L^d}{\\ell^d} = \\left(\\frac{L}{\\ell}\\right)^d\n$$\n根据中心极限定理，样本均值的方差是总体方差除以样本数量。在这里，体积平均 $\\bar{X}_L$ 的方差是微观（点态）方差 $\\sigma_0^2$ 除以有效独立样本数 $N_{eff}$：\n$$\n\\mathrm{Var}[\\bar{X}_{L}] \\approx \\frac{\\sigma_{0}^{2}}{N_{eff}} = \\sigma_{0}^{2} \\frac{V_c}{V}\n$$\n将 $V = L^d$ 和 $V_c = \\ell^d$ 代入，我们得到归一化方差的标度律：\n$$\n\\frac{\\mathrm{Var}[\\bar{X}_{L}]}{\\sigma_{0}^{2}} \\approx \\left(\\frac{\\ell}{L}\\right)^d\n$$\n该关系表明，均质化属性的方差随着 RVE 尺寸的增加而减小，衰减速度与空间维度 $d$ 的幂成正比。\n\n现在，我们应用这个标度律来确定满足 $\\mathrm{Var}[\\bar{X}_{L}]/\\sigma_{0}^{2} \\leq 0.01$ 的最小 RVE 边长 $L_{RVE}$。设 $d=3$：\n$$\n\\left(\\frac{\\ell}{L_{RVE}}\\right)^3 \\leq 0.01 = \\frac{1}{100}\n$$\n求解 $L_{RVE}$ 的最小值：\n$$\n\\frac{\\ell^3}{L_{RVE}^3} = \\frac{1}{100} \\implies L_{RVE}^3 = 100 \\ell^3\n$$\n对两边取立方根，得到：\n$$\nL_{RVE} = (100)^{1/3} \\ell\n$$\n这是所要求的最小 RVE 边长与相关长度 $\\ell$ 之间的解析关系。",
            "answer": "$$\\boxed{100^{1/3} \\ell}$$"
        },
        {
            "introduction": "与分层模型不同，并发模型同时对原子和连续介质区域进行模拟，其主要挑战在于处理两者之间的人为界面。这个界面可能会产生非物理的“伪影”，例如虚假的波反射。本项高级实践将引导你在一个一维耦合系统中优化“握手”区域，以最大限度地减少这些反射，从而深入了解如何设计稳健的并发耦合框架。",
            "id": "3752618",
            "problem": "考虑沿代表高熵合金（HEA）的杆传播的一维纵向弹性波。左侧域通过分子动力学（MD）在原子尺度上建模，右侧域通过有限元（FE）方法在连续介质尺度上建模。通过长度为 $L_{\\mathrm{o}}$ 的重叠区域实现并发耦合，在该区域中，材料属性平滑混合。假设横截面积 $A$ 均匀，MD 和 FE 区域的特征分别为密度和杨氏模量对 $\\left(\\rho_{\\mathrm{MD}},E_{\\mathrm{MD}}\\right)$ 和 $\\left(\\rho_{\\mathrm{FE}},E_{\\mathrm{FE}}\\right)$。重叠区域的属性从 $x=0$ 处的 MD 值线性混合到 $x=L_{\\mathrm{o}}$ 处的 FE 值。角频率为 $\\omega$ 的时谐纵向波从 MD 侧入射。\n\n基本原理：\n- 根据 Newton 第二定律和线性弹性理论，可得一维波动方程。在时谐拟设 $u(x,t)=\\Re\\left\\{U(x)\\mathrm{e}^{\\mathrm{i}\\omega t}\\right\\}$ 下，该方程简化为亥姆霍兹型方程 $U''(x)+k(x)^{2}U(x)=0$，其中 $k(x)=\\omega/c(x)$ 且 $c(x)=\\sqrt{E(x)/\\rho(x)}$。\n- 在每个材料界面处，位移 $u(x)$ 和牵引力 $\\sigma(x)=E(x)\\,\\partial u/\\partial x$ 必须保持连续。\n\n在频域中，均匀段中的场可以表示为 $U(x)=A\\,\\mathrm{e}^{\\mathrm{i}k x}+B\\,\\mathrm{e}^{-\\mathrm{i}k x}$，其中 $A$ 和 $B$ 分别是右行波和左行波的振幅。穿过从段 $j$到段 $j+1$ 的界面时，连续性条件意味着 $\\left(A_{j},B_{j}\\right)$ 和 $\\left(A_{j+1},B_{j+1}\\right)$ 之间存在线性关系；穿过长度为 $d$ 的均匀段会在 $A$ 和 $B$ 上引起 $\\mathrm{e}^{\\pm \\mathrm{i}k d}$ 的相移。通过将这些从 MD 侧穿过重叠区域到 FE 侧的线性映射进行组合，可以得到一个全局传递算子，该算子在 FE 侧施加仅出射波条件时，确定了 MD 入口处的反射振幅 $R$。\n\n定义一个目标函数 $J(L_{\\mathrm{o}})=\\left|R(L_{\\mathrm{o}})\\right|+\\alpha\\,L_{\\mathrm{o}}$，其中第一项惩罚伪反射，第二项惩罚与重叠区域大小成正比的计算成本。您的任务是针对每个测试用例，计算（从提供的离散候选集中选择）使 $J(L_{\\mathrm{o}})$ 最小化的重叠长度 $L_{\\mathrm{o}}$。\n\n离散化和建模要求：\n- 将重叠区域离散化为 $N$ 个宽度均匀的均匀单元，其中 $N=\\left\\lfloor L_{\\mathrm{o}}/\\Delta x \\right\\rfloor$ 且 $N\\geq 1$。\n- 在重叠区域内，使用归一化坐标 $s_{j}=j/N$ 定义单元 $j\\in\\{0,\\dots,N-1\\}$ 处的线性混合属性为 $E_{j}=E_{\\mathrm{MD}}+(E_{\\mathrm{FE}}-E_{\\mathrm{MD}})\\,s_{j}$ 和 $\\rho_{j}=\\rho_{\\mathrm{MD}}+(\\rho_{\\mathrm{FE}}-\\rho_{\\mathrm{MD}})\\,s_{j}$，以及 $k_{j}=\\omega/\\sqrt{E_{j}/\\rho_{j}}$。\n- 对于每个均匀单元 $j$，相映射由对角算子表示，其元素为 $\\mathrm{e}^{\\mathrm{i}k_{j}\\Delta x}$ 和 $\\mathrm{e}^{-\\mathrm{i}k_{j}\\Delta x}$，作用于 $(A_{j},B_{j})$。\n- 在连续单元之间的每个界面，以及在 MD-到-第一单元和最后单元-到-FE 的界面处，强制位移和牵引力的连续性，以构建一个 $2\\times 2$ 的界面算子。对界面的每一侧使用牵引力系数 $r=\\!E\\,k$。\n- 组合这些算子以获得从 MD 入口到 FE 出口的总传递算子，并在 FE 侧使用仅出射波条件，以纯数学方式提取 MD 入口处的反射振幅 $R$。\n- 对于每个候选 $L_{\\mathrm{o}}$，计算 $J(L_{\\mathrm{o}})$ 并选择最小值点。\n\n单位和报告：\n- 使用单位：$\\rho$ 为 $\\mathrm{kg}/\\mathrm{m}^{3}$，$E$ 为 $\\mathrm{Pa}$，$\\omega$ 为 $\\mathrm{rad}/\\mathrm{s}$，$A$ 为 $\\mathrm{m}^{2}$（注意，在此一维纵向公式中 $A$ 会被消掉），$L_{\\mathrm{o}}$ 和 $\\Delta x$ 为 $\\mathrm{m}$，$\\alpha$ 为 $\\mathrm{m}^{-1}$。\n- 以 $\\mathrm{m}$ 为单位表示最优重叠长度 $L_{\\mathrm{o}}^{\\star}$，四舍五入到六位小数。\n- 角度必须以弧度为单位。\n\n测试组：\n- 用例 $1$（中等失配，中等频率）：$\\rho_{\\mathrm{MD}}=7800\\,\\mathrm{kg}/\\mathrm{m}^{3}$，$E_{\\mathrm{MD}}=1.60\\times 10^{11}\\,\\mathrm{Pa}$，$\\rho_{\\mathrm{FE}}=8000\\,\\mathrm{kg}/\\mathrm{m}^{3}$，$E_{\\mathrm{FE}}=1.90\\times 10^{11}\\,\\mathrm{Pa}$，$\\omega=2\\pi\\times 8.0\\times 10^{6}\\,\\mathrm{rad}/\\mathrm{s}$，$A=1.0\\times 10^{-6}\\,\\mathrm{m}^{2}$，$\\Delta x=2.5\\times 10^{-4}\\,\\mathrm{m}$，候选 $L_{\\mathrm{o}}\\in\\{5.0\\times 10^{-4},1.0\\times 10^{-3},2.0\\times 10^{-3},3.0\\times 10^{-3}\\}\\,\\mathrm{m}$，$\\alpha=20\\,\\mathrm{m}^{-1}$。\n- 用例 $2$（近乎匹配，较低频率）：$\\rho_{\\mathrm{MD}}=7900\\,\\mathrm{kg}/\\mathrm{m}^{3}$，$E_{\\mathrm{MD}}=1.80\\times 10^{11}\\,\\mathrm{Pa}$，$\\rho_{\\mathrm{FE}}=7950\\,\\mathrm{kg}/\\mathrm{m}^{3}$，$E_{\\mathrm{FE}}=1.82\\times 10^{11}\\,\\mathrm{Pa}$，$\\omega=2\\pi\\times 5.0\\times 10^{6}\\,\\mathrm{rad}/\\mathrm{s}$，$A=1.0\\times 10^{-6}\\,\\mathrm{m}^{2}$，$\\Delta x=2.5\\times 10^{-4}\\,\\mathrm{m}$，候选 $L_{\\mathrm{o}}\\in\\{5.0\\times 10^{-4},1.0\\times 10^{-3},2.0\\times 10^{-3},3.0\\times 10^{-3}\\}\\,\\mathrm{m}$，$\\alpha=50\\,\\mathrm{m}^{-1}$。\n- 用例 $3$（强失配，较高频率）：$\\rho_{\\mathrm{MD}}=7500\\,\\mathrm{kg}/\\mathrm{m}^{3}$，$E_{\\mathrm{MD}}=1.30\\times 10^{11}\\,\\mathrm{Pa}$，$\\rho_{\\mathrm{FE}}=8200\\,\\mathrm{kg}/\\mathrm{m}^{3}$，$E_{\\mathrm{FE}}=2.10\\times 10^{11}\\,\\mathrm{Pa}$，$\\omega=2\\pi\\times 1.50\\times 10^{7}\\,\\mathrm{rad}/\\mathrm{s}$，$A=1.0\\times 10^{-6}\\,\\mathrm{m}^{2}$，$\\Delta x=2.5\\times 10^{-4}\\,\\mathrm{m}$，候选 $L_{\\mathrm{o}}\\in\\{5.0\\times 10^{-4},1.0\\times 10^{-3},2.0\\times 10^{-3},3.0\\times 10^{-3}\\}\\,\\mathrm{m}$，$\\alpha=10\\,\\mathrm{m}^{-1}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个条目是按上述顺序列出的各测试用例的最优 $L_{\\mathrm{o}}^{\\star}$（单位为米，四舍五入到六位小数）（例如，$\\left[0.001000,0.000500,0.002000\\right]$）。",
            "solution": "该问题要求使用传递矩阵法来求解一维波在多层介质中的反射问题，并优化重叠区域的长度。\n                \n**1. 物理模型**\n时谐纵向波 $u(x,t)=\\Re\\{U(x)e^{i\\omega t}\\}$ 在非均匀杆中的传播由亥姆霍兹方程 $U''(x)+k(x)^2 U(x)=0$ 描述，其中波数 $k(x)=\\omega/\\sqrt{E(x)/\\rho(x)}$。在任何均匀区域内，解是前向波和后向波的叠加 $U(x) = A e^{\\mathrm{i}k x} + B e^{-\\mathrm{i}k x}$。\n\n**2. 传递矩阵法**\n该方法通过矩阵将不同区域的波振幅向量 $\\mathbf{v} = \\begin{pmatrix} A \\\\ B \\end{pmatrix}$ 联系起来。\n\n*   **界面传递矩阵 ($\\mathbf{T}$)**：在两种介质（L 和 R）的界面处，位移 $U$ 和牵引力 $\\sigma = E U'$ 必须连续。这导致了振幅之间的线性关系 $\\mathbf{v}_R = \\mathbf{T}_{L\\to R} \\mathbf{v}_L$，其中：\n    $$\n    \\mathbf{T}_{L\\to R} = \\frac{1}{2r_R} \\begin{pmatrix} r_R+r_L  r_R-r_L \\\\ r_R-r_L  r_R+r_L \\end{pmatrix}\n    $$\n    这里 $r = E k = \\omega\\sqrt{E\\rho}$ 是材料的声阻抗相关量。\n\n*   **传播矩阵 ($\\mathbf{P}$)**：波在宽度为 $\\Delta x$、波数为 $k_j$ 的均匀单元内传播时，其振幅会发生相移。这由对角矩阵描述：\n    $$\n    \\mathbf{P}_j = \\begin{pmatrix} e^{\\mathrm{i}k_j \\Delta x}  0 \\\\ 0  e^{-\\mathrm{i}k_j \\Delta x} \\end{pmatrix}\n    $$\n\n**3. 总传递矩阵 ($\\mathbf{M}$)**\n重叠区域被离散为 $N$ 个单元。从 MD 区域到 FE 区域的总传递矩阵通过将所有界面和传播矩阵按顺序相乘得到：\n$$\n\\mathbf{M} = \\mathbf{T}_{N-1 \\to \\mathrm{FE}} \\cdot \\mathbf{P}_{N-1} \\cdot \\mathbf{T}_{N-2 \\to N-1} \\cdots \\mathbf{T}_{0 \\to 1} \\cdot \\mathbf{P}_0\n$$\n这将 MD 区域的振幅与 FE 区域的振幅联系起来：$\\mathbf{v}_{\\mathrm{FE}} = \\mathbf{M} \\mathbf{v}_{\\mathrm{MD}}$。\n\n**4. 反射系数 ($R$) 的计算**\n在 MD 侧，我们有入射波 ($A_{\\mathrm{MD}}=1$) 和反射波 ($B_{\\mathrm{MD}}=R$)，所以 $\\mathbf{v}_{\\mathrm{MD}} = \\begin{pmatrix} 1 \\\\ R \\end{pmatrix}$。在 FE 侧，仅有出射波，因此没有后向波 ($B_{\\mathrm{FE}}=0$)，即 $\\mathbf{v}_{\\mathrm{FE}} = \\begin{pmatrix} A_{\\mathrm{FE}} \\\\ 0 \\end{pmatrix}$。将这些代入 $\\mathbf{v}_{\\mathrm{FE}} = \\mathbf{M} \\mathbf{v}_{\\mathrm{MD}}$，我们得到：\n$$\n\\begin{pmatrix} A_{\\mathrm{FE}} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} M_{11}  M_{12} \\\\ M_{21}  M_{22} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ R \\end{pmatrix}\n$$\n从第二行方程 $0 = M_{21} + M_{22} R$，我们可以解出反射系数：\n$$\nR = - \\frac{M_{21}}{M_{22}}\n$$\n\n**5. 优化**\n对于每个候选的重叠长度 $L_{\\mathrm{o}}$，我们计算相应的反射系数的绝对值 $|R(L_{\\mathrm{o}})|$，并评估目标函数 $J(L_{\\mathrm{o}}) = |R(L_{\\mathrm{o}})| + \\alpha L_{\\mathrm{o}}$。选择使 $J$ 最小的 $L_{\\mathrm{o}}$ 即为最优解。\n                \n下面的 Python 代码实现了此算法，用于计算每个测试用例的最优重叠长度。",
            "answer": "完整且可运行的 Python 3 代码如下。导入的库必须符合指定的执行环境。未使用其他库。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are used.\n\ndef solve():\n    \"\"\"\n    Main solver function to process all test cases and print the final result.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1\n        {\n            \"rho_md\": 7800.0, \"e_md\": 1.60e11,\n            \"rho_fe\": 8000.0, \"e_fe\": 1.90e11,\n            \"omega\": 2 * np.pi * 8.0e6,\n            \"dx\": 2.5e-4,\n            \"lo_candidates\": [5.0e-4, 1.0e-3, 2.0e-3, 3.0e-3],\n            \"alpha\": 20.0\n        },\n        # Case 2\n        {\n            \"rho_md\": 7900.0, \"e_md\": 1.80e11,\n            \"rho_fe\": 7950.0, \"e_fe\": 1.82e11,\n            \"omega\": 2 * np.pi * 5.0e6,\n            \"dx\": 2.5e-4,\n            \"lo_candidates\": [5.0e-4, 1.0e-3, 2.0e-3, 3.0e-3],\n            \"alpha\": 50.0\n        },\n        # Case 3\n        {\n            \"rho_md\": 7500.0, \"e_md\": 1.30e11,\n            \"rho_fe\": 8200.0, \"e_fe\": 2.10e11,\n            \"omega\": 2 * np.pi * 1.50e7,\n            \"dx\": 2.5e-4,\n            \"lo_candidates\": [5.0e-4, 1.0e-3, 2.0e-3, 3.0e-3],\n            \"alpha\": 10.0\n        }\n    ]\n\n    optimal_los = []\n\n    for case in test_cases:\n        optimal_los.append(find_optimal_lo(case))\n\n    # Format and print the final output as specified.\n    print(f\"[{','.join([f'{lo:.6f}' for lo in optimal_los])}]\")\n\n\ndef find_optimal_lo(params):\n    \"\"\"\n    Finds the optimal overlap length Lo for a single test case.\n    \"\"\"\n    rho_md, e_md = params[\"rho_md\"], params[\"e_md\"]\n    rho_fe, e_fe = params[\"rho_fe\"], params[\"e_fe\"]\n    omega = params[\"omega\"]\n    dx = params[\"dx\"]\n    lo_candidates = params[\"lo_candidates\"]\n    alpha = params[\"alpha\"]\n\n    min_j = float('inf')\n    optimal_lo = -1.0\n\n    r_fe = omega * np.sqrt(e_fe * rho_fe)\n    \n    for lo in lo_candidates:\n        n_cells = int(np.floor(lo / dx))\n        if n_cells  1:\n            # Per problem spec, N must be >= 1.\n            # This case won't be hit with the given test data.\n            continue\n        \n        # --- Pre-calculate properties for all cells ---\n        s_vals = np.arange(n_cells) / n_cells\n        e_cells = e_md + (e_fe - e_md) * s_vals\n        rho_cells = rho_md + (rho_fe - rho_md) * s_vals\n        \n        r_cells = omega * np.sqrt(e_cells * rho_cells)\n        k_cells = omega / np.sqrt(e_cells / rho_cells)\n\n        # --- Construct total transfer matrix M ---\n        # The first interface T_{MD -> 0} is identity because cell 0 has MD properties.\n        # So, the chain starts with P_0.\n        \n        # P_0\n        phase = 1j * k_cells[0] * dx\n        M = np.array([[np.exp(phase), 0], [0, np.exp(-phase)]], dtype=np.cdouble)\n\n        # Chain multiplication for the rest of the cells\n        for j in range(1, n_cells):\n            # Interface T_{j-1 -> j}\n            r_left = r_cells[j-1]\n            r_right = r_cells[j]\n            p = r_left / r_right\n            t11 = 0.5 * (1 + p)\n            t12 = 0.5 * (1 - p)\n            T_interface = np.array([[t11, t12], [t12, t11]], dtype=np.cdouble)\n            M = T_interface @ M\n            \n            # Propagation P_j\n            phase = 1j * k_cells[j] * dx\n            P_prop = np.array([[np.exp(phase), 0], [0, np.exp(-phase)]], dtype=np.cdouble)\n            M = P_prop @ M\n            \n        # Final interface T_{N-1 -> FE}\n        r_left = r_cells[n_cells - 1]\n        r_right = r_fe\n        p = r_left / r_right\n        t11 = 0.5 * (1 + p)\n        t12 = 0.5 * (1 - p)\n        T_final = np.array([[t11, t12], [t12, t11]], dtype=np.cdouble)\n        M = T_final @ M\n\n        # --- Calculate reflection and objective function J ---\n        m21, m22 = M[1, 0], M[1, 1]\n        \n        if np.abs(m22)  1e-12:\n            # Avoid division by zero, though unlikely with physical properties.\n            # A very large reflection would be implied.\n            R = complex(1e12, 0)\n        else:\n            R = -m21 / m22\n            \n        J = np.abs(R) + alpha * lo\n        \n        if J  min_j:\n            min_j = J\n            optimal_lo = lo\n            \n    return optimal_lo\n\n\nsolve()\n```"
        }
    ]
}