{
    "hands_on_practices": [
        {
            "introduction": "Mastering small-signal analysis begins with deriving the key transfer functions from first principles. This exercise guides you through the process of obtaining the control-to-output transfer function, $G_{vd}(s)$, for a flyback converter using state-space averaging. Successfully completing this practice will not only reinforce your modeling skills but also provide a deep understanding of the origin of the right-half-plane zero (RHPZ), a critical dynamic feature of this topology .",
            "id": "3880449",
            "problem": "An ideal flyback converter operating in Continuous Conduction Mode (CCM) is built with an ideal transformer of turns ratio $n = N_{s}/N_{p}$, a magnetizing inductance $L_{m}$ on the primary, an ideal switch and an ideal diode, a resistive load $R$ on the secondary, and an output capacitor $C$ with negligible parasitics. The input voltage $V_{g}$ is constant. Assume perfect coupling and neglect leakage inductance, winding resistance, and all nonidealities except the finite load $R$ and output capacitor $C$. The duty ratio is $D$.\n\nStarting only from the constitutive relations for the inductor and capacitor, $v_{L} = L\\,\\mathrm{d}i/\\mathrm{d}t$ and $i_{C} = C\\,\\mathrm{d}v/\\mathrm{d}t$, and the ideal transformer relations $v_{p}/v_{s} = N_{p}/N_{s} = 1/n$ and $N_{p} i_{p} = N_{s} i_{s}$, use state-space averaging followed by small-signal linearization around the CCM steady state to derive the control-to-output transfer function $G_{vd}(s) = \\hat{v}_{o}(s)/\\hat{d}(s)$ in terms of $V_{g}$, $n$, $L_{m}$, $R$, $C$, and $D$. Explicitly identify the right-half-plane (RHP) zero and provide its frequency as a closed-form expression.\n\nExpress your final answers as closed-form analytic expressions. No numerical evaluation is required. Do not include units in your final answers.",
            "solution": "The user's problem statement is rigorously validated and found to be valid. It is a well-posed, scientifically grounded problem from the field of power electronics, with a complete and consistent set of givens.\n\nThe derivation of the control-to-output transfer function $G_{vd}(s) = \\hat{v}_{o}(s)/\\hat{d}(s)$ for an ideal flyback converter in Continuous Conduction Mode (CCM) will proceed via state-space averaging.\n\nThe state variables are chosen as the primary magnetizing inductor current, $i_{m}(t)$, and the output capacitor voltage, $v_{o}(t)$. The state vector is $x(t) = \\begin{pmatrix} i_m(t) & v_o(t) \\end{pmatrix}^T$. The input is the constant voltage $V_g$, and the control input is the duty cycle $d(t)$.\n\nThe analysis is performed over one switching period $T_s$, which consists of two subintervals.\n\n**1. State 1: Switch is ON (Interval $d T_s$)**\n\nDuring this interval, the switch is closed, and the primary winding is connected to the input voltage source $V_g$. The voltage across the magnetizing inductance $L_m$ is $v_{L_m} = V_g$. Applying the inductor constitutive relation:\n$$ \\frac{di_m}{dt} = \\frac{V_g}{L_m} $$\nThe voltage $V_g$ on the primary induces a voltage on the secondary that reverse-biases the diode. Consequently, the secondary side is disconnected from the primary. The output capacitor $C$ discharges into the load resistor $R$. The capacitor current is $i_C = -v_o/R$. Applying the capacitor constitutive relation:\n$$ \\frac{dv_o}{dt} = \\frac{i_C}{C} = -\\frac{v_o}{RC} $$\nThe state-space representation for this interval is $\\dot{x} = A_1 x + B_1 v_g$:\n$$ \\frac{d}{dt}\\begin{pmatrix} i_m \\\\ v_o \\end{pmatrix} = \\underbrace{\\begin{pmatrix} 0 & 0 \\\\ 0 & -\\frac{1}{RC} \\end{pmatrix}}_{A_1} \\begin{pmatrix} i_m \\\\ v_o \\end{pmatrix} + \\underbrace{\\begin{pmatrix} \\frac{1}{L_m} \\\\ 0 \\end{pmatrix}}_{B_1} V_g $$\n\n**2. State 2: Switch is OFF (Interval $(1-d) T_s$)**\n\nDuring this interval, the switch is open. The energy stored in the magnetizing inductance is transferred to the secondary side. The current in $L_m$ forces the diode on the secondary side into forward conduction, clamping the secondary voltage to $v_s = v_o$. Using the ideal transformer voltage relation $v_p/v_s = 1/n$, the voltage reflected to the primary is $v_p = v_s/n = v_o/n$. This voltage appears across the magnetizing inductance with a polarity opposing the current flow, so $v_{L_m} = -v_o/n$.\n$$ \\frac{di_m}{dt} = -\\frac{v_o}{n L_m} $$\nOn the secondary side, the magnetizing current reflected to the secondary is $i_s = i_m / n$. This current is the diode current, which splits between the output capacitor and the load resistor. The capacitor current is $i_C = i_s - i_R = i_m/n - v_o/R$.\n$$ \\frac{dv_o}{dt} = \\frac{i_C}{C} = \\frac{i_m}{nC} - \\frac{v_o}{RC} $$\nThe state-space representation for this interval is $\\dot{x} = A_2 x + B_2 v_g$:\n$$ \\frac{d}{dt}\\begin{pmatrix} i_m \\\\ v_o \\end{pmatrix} = \\underbrace{\\begin{pmatrix} 0 & -\\frac{1}{n L_m} \\\\ \\frac{1}{nC} & -\\frac{1}{RC} \\end{pmatrix}}_{A_2} \\begin{pmatrix} i_m \\\\ v_o \\end{pmatrix} + \\underbrace{\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}}_{B_2} V_g $$\n\n**3. State-Space Averaging**\n\nThe averaged state-space model is obtained by weighting the matrices from each subinterval by the duration of that subinterval. Let $d$ be the duty cycle.\n$A = d A_1 + (1-d) A_2$\n$B = d B_1 + (1-d) B_2$\n$$ A = d\\begin{pmatrix} 0 & 0 \\\\ 0 & -\\frac{1}{RC} \\end{pmatrix} + (1-d)\\begin{pmatrix} 0 & -\\frac{1}{n L_m} \\\\ \\frac{1}{nC} & -\\frac{1}{RC} \\end{pmatrix} = \\begin{pmatrix} 0 & -\\frac{1-d}{n L_m} \\\\ \\frac{1-d}{nC} & -\\frac{1}{RC} \\end{pmatrix} $$\n$$ B = d\\begin{pmatrix} \\frac{1}{L_m} \\\\ 0 \\end{pmatrix} + (1-d)\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{d}{L_m} \\\\ 0 \\end{pmatrix} $$\nThe averaged system is $\\dot{x} = Ax + Bv_g$.\n\n**4. DC Operating Point**\n\nAt steady state (DC), the time derivatives are zero, and the state variables and duty cycle are constant: $x(t) = X = \\begin{pmatrix} I_m & V_o \\end{pmatrix}^T$ and $d(t) = D$.\n$0 = AX + BV_g$\n$$ 0 = -\\frac{1-D}{n L_m} V_o + \\frac{D}{L_m} V_g \\implies V_o = V_g \\frac{nD}{1-D} $$\n$$ 0 = \\frac{1-D}{nC} I_m - \\frac{1}{RC} V_o \\implies I_m = \\frac{n V_o}{(1-D)R} = V_g \\frac{n^2 D}{(1-D)^2 R} $$\n\n**5. Small-Signal Linearization**\n\nWe introduce small AC perturbations: $x(t) = X + \\hat{x}(t)$, $d(t) = D + \\hat{d}(t)$, $v_g(t) = V_g + \\hat{v}_g(t)$. Since $V_g$ is constant, $\\hat{v}_g(t)=0$. The linearized small-signal model is:\n$\\dot{\\hat{x}} = A\\hat{x} + B\\hat{v}_g + [(A_1-A_2)X + (B_1-B_2)V_g]\\hat{d}$\nWith $\\hat{v}_g = 0$, this becomes $\\dot{\\hat{x}} = A\\hat{x} + B_d \\hat{d}$, where $A$ is the averaged matrix evaluated at $D$, and $B_d$ is the control input matrix.\n$A_1-A_2 = \\begin{pmatrix} 0 & \\frac{1}{nL_m} \\\\ -\\frac{1}{nC} & 0 \\end{pmatrix}$\n$B_1-B_2 = \\begin{pmatrix} \\frac{1}{L_m} \\\\ 0 \\end{pmatrix}$\n$B_d = (A_1-A_2)X + (B_1-B_2)V_g = \\begin{pmatrix} 0 & \\frac{1}{nL_m} \\\\ -\\frac{1}{nC} & 0 \\end{pmatrix} \\begin{pmatrix} I_m \\\\ V_o \\end{pmatrix} + \\begin{pmatrix} \\frac{1}{L_m} \\\\ 0 \\end{pmatrix} V_g = \\begin{pmatrix} \\frac{V_o}{nL_m} + \\frac{V_g}{L_m} \\\\ -\\frac{I_m}{nC} \\end{pmatrix}$\nUsing the DC relations, we simplify $B_d$. Let $D' = 1-D$.\n$\\frac{V_o}{nL_m} + \\frac{V_g}{L_m} = \\frac{1}{L_m}(\\frac{V_o}{n} + V_g) = \\frac{V_g}{L_m}(\\frac{D}{D'} + 1) = \\frac{V_g}{D'L_m}$\n$-\\frac{I_m}{nC} = -\\frac{1}{nC} \\frac{n V_o}{D'R} = -\\frac{V_o}{D'RC}$\nSo, the linearized model is:\n$$ \\frac{d}{dt}\\begin{pmatrix} \\hat{i}_m \\\\ \\hat{v}_o \\end{pmatrix} = \\begin{pmatrix} 0 & -\\frac{D'}{n L_m} \\\\ \\frac{D'}{nC} & -\\frac{1}{RC} \\end{pmatrix} \\begin{pmatrix} \\hat{i}_m \\\\ \\hat{v}_o \\end{pmatrix} + \\begin{pmatrix} \\frac{V_g}{D'L_m} \\\\ -\\frac{V_o}{D'RC} \\end{pmatrix} \\hat{d} $$\nThe output equation is $\\hat{v}_o(t) = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\hat{x}(t)$.\n\n**6. Transfer Function Derivation**\n\nThe transfer function $G_{vd}(s) = \\hat{v}_o(s)/\\hat{d}(s)$ is given by $C_{ss}(sI - A)^{-1}B_d + E_{ss}$, where $C_{ss} = \\begin{pmatrix} 0 & 1 \\end{pmatrix}$ and $E_{ss}=0$.\n$$ sI - A = \\begin{pmatrix} s & \\frac{D'}{nL_m} \\\\ -\\frac{D'}{nC} & s + \\frac{1}{RC} \\end{pmatrix} $$\n$$ \\det(sI - A) = s\\left(s+\\frac{1}{RC}\\right) + \\frac{(D')^2}{n^2 L_m C} = s^2 + \\frac{s}{RC} + \\frac{(D')^2}{n^2 L_m C} $$\n$$ (sI - A)^{-1} = \\frac{1}{\\det(sI-A)} \\begin{pmatrix} s+\\frac{1}{RC} & -\\frac{D'}{nL_m} \\\\ \\frac{D'}{nC} & s \\end{pmatrix} $$\nNow, we compute $G_{vd}(s) = C_{ss} (sI - A)^{-1} B_d$:\n$$ G_{vd}(s) = \\frac{1}{\\det(sI-A)} \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} s+\\frac{1}{RC} & -\\frac{D'}{nL_m} \\\\ \\frac{D'}{nC} & s \\end{pmatrix} \\begin{pmatrix} \\frac{V_g}{D'L_m} \\\\ -\\frac{V_o}{D'RC} \\end{pmatrix} $$\n$$ G_{vd}(s) = \\frac{1}{\\det(sI-A)} \\left[ \\left(\\frac{D'}{nC}\\right)\\left(\\frac{V_g}{D'L_m}\\right) + s\\left(-\\frac{V_o}{D'RC}\\right) \\right] $$\n$$ G_{vd}(s) = \\frac{\\frac{V_g}{nL_mC} - s\\frac{V_o}{D'RC}}{s^2 + \\frac{s}{RC} + \\frac{(D')^2}{n^2 L_m C}} $$\nSubstitute $V_o = V_g \\frac{nD}{D'}$ and $D' = 1-D$:\n$$ G_{vd}(s) = \\frac{\\frac{V_g}{nL_mC} - s\\frac{V_g nD}{(D')^2 RC}}{s^2 + \\frac{s}{RC} + \\frac{(D')^2}{n^2 L_m C}} = \\frac{\\frac{V_g}{nL_mC}\\left(1-s\\frac{n^2 D L_m}{(D')^2 R}\\right)}{s^2 + \\frac{s}{RC} + \\frac{(D')^2}{n^2 L_m C}} $$\nFinal expression for the transfer function in terms of the given parameters:\n$$ G_{vd}(s) = \\frac{\\frac{V_g}{n L_m C} \\left( 1 - s \\frac{n^2 D L_m}{(1-D)^2 R} \\right)}{s^2 + \\frac{s}{RC} + \\frac{(1-D)^2}{n^2 L_m C}} $$\n\n**7. Right-Half-Plane (RHP) Zero**\n\nThe zero of the transfer function, $s_z$, is found by setting the numerator to zero:\n$$ 1 - s_z \\frac{n^2 D L_m}{(1-D)^2 R} = 0 $$\nSolving for $s_z$ gives the location of the zero:\n$$ s_z = \\frac{(1-D)^2 R}{n^2 D L_m} $$\nSince all parameters $R, L_m, D, n$ are positive, $s_z$ is a positive real number, confirming it is a Right-Half-Plane (RHP) zero. The frequency of this zero, $\\omega_z$, is this value in rad/s.\n$$ \\omega_z = \\frac{(1-D)^2 R}{n^2 D L_m} $$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\frac{V_g}{n L_m C} \\left( 1 - s \\frac{n^2 D L_m}{(1-D)^2 R} \\right)}{s^2 + \\frac{s}{RC} + \\frac{(1-D)^2}{n^2 L_m C}} & \\frac{(1-D)^2 R}{n^2 D L_m}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A converter's performance is not defined solely by its response to control inputs, but also by its interaction with the load, characterized by its output impedance, $Z_{out}(s)$. This problem focuses on deriving the output impedance for a boost converter, including the practical effects of parasitic resistances. By working through this analysis, you will also clarify why the right-half-plane zero, a defining feature of the boost converter's control transfer function, does not appear in its output impedance .",
            "id": "3880511",
            "problem": "Consider a continuous-conduction-mode boost converter with an ideal diode and ideal controlled switch, input source voltage $V_{g}$, inductor $L$ with series resistance $r_{L}$, and an output network consisting of a capacitor $C$ with series equivalent series resistance $r_{C}$ connected to the output node, and a resistive load $R$ tied from the output node to ground. The duty ratio $D$ is constant, and the input source voltage $V_{g}$ does not vary. Assume that the average model is obtained via State-Space Averaging (SSA), and that all parasitic resistances are small but nonzero. Define the small-signal open-loop output impedance $Z_{\\text{out}}(s)$ as the ratio of the small-signal output voltage perturbation $\\hat{v}_{o}(s)$ to a small-signal current injection $\\hat{i}_{\\text{inj}}(s)$ at the output node, with $\\hat{i}_{\\text{inj}}$ taken positive into the output node, while holding the duty ratio and input source at their steady-state values.\n\nStarting only from the fundamental averaged laws implied by Kirchhoff’s Voltage Law (KVL), Kirchhoff’s Current Law (KCL), and the capacitor and inductor constitutive relations, derive the small-signal linearized averaged model and use it to obtain $Z_{\\text{out}}(s)$, fully accounting for $r_{L}$ and $r_{C}$. Express your final answer as a single closed-form analytic expression in terms of $s$, $L$, $r_{L}$, $C$, $r_{C}$, $R$, and $D$ only. Briefly explain, based on your derivation, how the right-half-plane zero typical of the boost converter appears (or does not appear) in the impedance response. No numerical evaluation is required. Provide the expression exactly; no rounding is needed. Units are not required in the final expression.",
            "solution": "The problem REMAINS VALID under scrutiny. It is a well-posed, scientifically grounded problem in power electronics analysis.\n\nThe derivation of the small-signal open-loop output impedance, $Z_{\\text{out}}(s)$, for the specified boost converter begins with establishing the averaged model, which describes the circuit's dynamics over time scales longer than a single switching period. We select the inductor current $\\langle i_L \\rangle$ and the voltage across the capacitor proper $\\langle v_C \\rangle$ as our state variables. The output voltage $\\langle v_o \\rangle$ includes the voltage drop across the capacitor's equivalent series resistance (ESR), $r_C$.\n\nThe fundamental averaged equations are derived by applying Kirchhoff's laws to the circuit, averaged over one switching period $T_s$.\n\n1.  **Averaged Inductor Voltage Law:** The average voltage across the inductor $L$ is determined by the switch position.\n    -   When the switch is ON (duration $D T_s$), the voltage applied across the $L-r_L$ series combination is $\\langle v_g \\rangle$.\n    -   When the switch is OFF (duration $(1-D)T_s$), the voltage is $\\langle v_g \\rangle - \\langle v_o \\rangle$.\n    Averaging these gives the equation for the inductor branch:\n    $$L \\frac{d\\langle i_L \\rangle}{dt} + \\langle i_L \\rangle r_L = D \\langle v_g \\rangle + (1-D)(\\langle v_g \\rangle - \\langle v_o \\rangle)$$\n    $$L \\frac{d\\langle i_L \\rangle}{dt} = \\langle v_g \\rangle - \\langle i_L \\rangle r_L - (1-D)\\langle v_o \\rangle$$\n\n2.  **Averaged Output Node Current Law:** The current delivered to the output stage from the switching action is $(1-D)\\langle i_L \\rangle$. This current splits between the load resistor $R$ and the capacitor branch ($C$ in series with $r_C$). To define the output impedance, an external current source $\\langle i_{\\text{inj}} \\rangle$ is injected at the output node.\n    The current into the capacitor branch is $\\langle i_C \\rangle = C \\frac{d\\langle v_C \\rangle}{dt}$. The current into the load is $\\frac{\\langle v_o \\rangle}{R}$. The KCL at the output node is:\n    $$(1-D)\\langle i_L \\rangle + \\langle i_{\\text{inj}} \\rangle = \\frac{\\langle v_o \\rangle}{R} + \\langle i_C \\rangle$$\n    $$C \\frac{d\\langle v_C \\rangle}{dt} = (1-D)\\langle i_L \\rangle - \\frac{\\langle v_o \\rangle}{R} + \\langle i_{\\text{inj}} \\rangle$$\n\n3.  **Output Voltage Relation:** The output voltage $\\langle v_o \\rangle$ is the sum of the voltage across the capacitor, $\\langle v_C \\rangle$, and the voltage across its ESR, $r_C$, which is $r_C \\langle i_C \\rangle$.\n    $$\\langle v_o \\rangle = \\langle v_C \\rangle + r_C \\langle i_C \\rangle = \\langle v_C \\rangle + r_C C \\frac{d\\langle v_C \\rangle}{dt}$$\n\nTo find the small-signal model, we perturb each variable around its DC quiescent point: $\\langle v_g \\rangle = V_g + \\hat{v}_g$, $\\langle i_L \\rangle = I_L + \\hat{i}_L$, $\\langle v_C \\rangle = V_C + \\hat{v}_C$, $\\langle v_o \\rangle = V_o + \\hat{v}_o$, $D = D + \\hat{d}$, and $\\langle i_{\\text{inj}} \\rangle = 0 + \\hat{i}_{\\text{inj}}$. We then linearize the equations by retaining only the first-order (small-signal) terms.\n\nFor the output impedance calculation, the control input and source voltage are held constant, so $\\hat{d}=0$ and $\\hat{v}_g=0$. The linearized AC equations are:\n\n1.  From the inductor voltage equation:\n    $$L \\frac{d\\hat{i}_L}{dt} = -\\hat{i}_L r_L - (1-D)\\hat{v}_o$$\n\n2.  From the output node current equation:\n    $$C \\frac{d\\hat{v}_C}{dt} = (1-D)\\hat{i}_L - \\frac{\\hat{v}_o}{R} + \\hat{i}_{\\text{inj}}$$\n\n3.  From the output voltage relation:\n    $$\\hat{v}_o = \\hat{v}_C + r_C C \\frac{d\\hat{v}_C}{dt}$$\n\nNext, we transform these time-domain differential equations into the Laplace domain by replacing $\\frac{d}{dt}$ with the complex frequency variable $s$.\n\n1.  $sL\\hat{i}_L(s) = -r_L\\hat{i}_L(s) - (1-D)\\hat{v}_o(s)$\n    $$(sL+r_L)\\hat{i}_L(s) = -(1-D)\\hat{v}_o(s) \\implies \\hat{i}_L(s) = -\\frac{1-D}{sL+r_L}\\hat{v}_o(s)$$\n\n2.  $sC\\hat{v}_C(s) = (1-D)\\hat{i}_L(s) - \\frac{\\hat{v}_o(s)}{R} + \\hat{i}_{\\text{inj}}(s)$\n\n3.  $\\hat{v}_o(s) = \\hat{v}_C(s) + sCr_C\\hat{v}_C(s) = (1+sCr_C)\\hat{v}_C(s)$\n    $$\\implies \\hat{v}_C(s) = \\frac{\\hat{v}_o(s)}{1+sCr_C}$$\n\nNow we substitute the expressions for $\\hat{i}_L(s)$ and $\\hat{v}_C(s)$ into the Laplace-transformed KCL equation:\n$$sC \\left( \\frac{\\hat{v}_o(s)}{1+sCr_C} \\right) = (1-D)\\left( -\\frac{1-D}{sL+r_L}\\hat{v}_o(s) \\right) - \\frac{\\hat{v}_o(s)}{R} + \\hat{i}_{\\text{inj}}(s)$$\n\nTo find the output impedance $Z_{\\text{out}}(s) = \\frac{\\hat{v}_o(s)}{\\hat{i}_{\\text{inj}}(s)}$, we rearrange the equation to isolate $\\hat{i}_{\\text{inj}}(s)$:\n$$\\hat{i}_{\\text{inj}}(s) = \\hat{v}_o(s) \\left[ \\frac{sC}{1+sCr_C} + \\frac{(1-D)^2}{sL+r_L} + \\frac{1}{R} \\right]$$\n\nThe output impedance is the reciprocal of the term in the brackets. This shows that $Z_{\\text{out}}(s)$ is the parallel combination of three impedances: the impedance of the capacitor with its ESR ($r_C + \\frac{1}{sC}$), the impedance of the active input stage reflected to the output ($\\frac{sL+r_L}{(1-D)^2}$), and the load resistance $R$.\n\nTo obtain a single closed-form expression, we combine the terms in the admittance expression:\n$$\\frac{1}{Z_{\\text{out}}(s)} = \\frac{ sCR(sL+r_L) + (1-D)^2 R(1+sCr_C) + (sL+r_L)(1+sCr_C) }{R(sL+r_L)(1+sCr_C)}$$\nTaking the reciprocal yields the final expression for the output impedance:\n$$Z_{\\text{out}}(s) = \\frac{R(sL+r_L)(1+sCr_C)}{sCR(sL+r_L) + (1-D)^2 R(1+sCr_C) + (sL+r_L)(1+sCr_C)}$$\nThis can be written in a more structured form by factoring the denominator:\n$$Z_{\\text{out}}(s) = \\frac{R(sL+r_L)(1+sCr_C)}{(sL+r_L)(1+sC(R+r_C)) + (1-D)^2R(1+sCr_C)}$$\n\n**Regarding the Right-Half-Plane Zero (RHPZ):**\nThe RHPZ characteristic of a boost converter appears in its control-to-output transfer function, $G_{vd}(s) = \\hat{v}_o(s)/\\hat{d}(s)$, not in its output impedance $Z_{\\text{out}}(s)$. The physical reason for the RHPZ is the two-stage power transfer: an increase in duty cycle $D$ first lengthens the time the inductor charges from the input, disconnecting it from the output. This causes an initial drop in output voltage before the larger stored energy is delivered to the output, causing a subsequent rise. This non-minimum phase behavior (\"going the wrong way first\") is modeled mathematically as a zero in the right half of the complex s-plane.\n\nIn the derivation of the output impedance $Z_{\\text{out}}(s)$, the duty ratio is held constant ($\\hat{d}=0$). The system's response is solely due to the passive, averaged circuit's reaction to an external current injection. The dynamic behavior that causes the RHPZ—the active modulation of the switch duty cycle—is not present in this scenario.\nThe zeros of $Z_{\\text{out}}(s)$ are found from the numerator of its expression: $R(sL+r_L)(1+sCr_C)=0$. This gives two zeros: $s_1 = -r_L/L$ and $s_2 = -1/(Cr_C)$. Both are located in the left-half plane, as $L, C, r_L, r_C$ are positive physical quantities. Therefore, the output impedance does not exhibit the RHPZ.",
            "answer": "$$\\boxed{\\frac{R(sL+r_L)(1+sCr_C)}{(sL+r_L)(1+sC(R+r_C)) + (1-D)^2R(1+sCr_C)}}$$"
        },
        {
            "introduction": "Small-signal models are powerful tools that bridge the gap between analysis and practical design. This practice elevates modeling by applying it to a design-oriented goal: shaping the output filter's response. You will analyze how parasitic resistances in a buck converter's filter can be tuned to achieve a 'maximally flat' output impedance, a concept borrowed from classic filter theory that is crucial for system stability and performance .",
            "id": "3880489",
            "problem": "Consider a continuous-conduction-mode buck converter power stage in which parasitic resistances are modeled explicitly: the inductor has Direct Current Resistance (DCR) denoted by $R_{\\mathrm{DCR}}$, and the output capacitor has Equivalent Series Resistance (ESR) denoted by $R_{\\mathrm{ESR}}$. Assume an ideal switch network and an ideal input source. Using the standard state-space averaging framework for small-signal modeling, define the small-signal output impedance $Z_{\\mathrm{out}}(s)$ as the ratio of the small-signal output voltage perturbation to a small-signal current injection at the output node, with the duty ratio and input source perturbations suppressed (set to zero).\n\nStarting from the element constitutive relations $v_{L}(t) = L \\, \\frac{di_{L}}{dt}$ with series resistance $R_{\\mathrm{DCR}}$, $i_{C}(t) = C \\, \\frac{dv_{C}}{dt}$ with series resistance $R_{\\mathrm{ESR}}$, and Ohm’s law, along with Kirchhoff’s Current Law (KCL) at the output node, perform the following:\n\n1. Derive the exact small-signal output impedance $Z_{\\mathrm{out}}(s)$ of the passive network seen at the output node when the input source and duty perturbations are suppressed (i.e., the left terminal of the inductor is at small-signal ground). Model the inductor branch impedance as $Z_{L}(s) = R_{\\mathrm{DCR}} + s L$ and the capacitor branch impedance as $Z_{C}(s) = R_{\\mathrm{ESR}} + \\frac{1}{s C}$, and use passive network combination laws to obtain $Z_{\\mathrm{out}}(s)$.\n\n2. Define the natural frequency $\\omega_{0} = \\frac{1}{\\sqrt{L C}}$ and the characteristic impedance $Z_{0} = \\sqrt{\\frac{L}{C}}$. Express the squared magnitude of $Z_{\\mathrm{out}}(j \\omega)$ normalized by $Z_{0}^{2}$ as a rational function of the dimensionless frequency $x = \\frac{\\omega}{\\omega_{0}}$ and the normalized resistances $r_{L} = \\frac{R_{\\mathrm{DCR}}}{Z_{0}}$ and $r_{C} = \\frac{R_{\\mathrm{ESR}}}{Z_{0}}$.\n\n3. In the precise sense that the first and second derivatives of $\\left| Z_{\\mathrm{out}}(j \\omega) \\right|$ with respect to $\\omega$ vanish at $\\omega = \\omega_{0}$, determine the condition on $R_{\\mathrm{ESR}}$ and $R_{\\mathrm{DCR}}$ (expressed in ohms) that yields a maximally flat magnitude response at midband. Provide your final condition as a single pair $(R_{\\mathrm{ESR}}, R_{\\mathrm{DCR}})$ expressed in terms of $L$ and $C$.\n\nNo numerical approximation is required; provide your final condition in closed form. Express both resistances in $\\mathrm{\\Omega}$.",
            "solution": "The problem asks for the derivation of the output impedance of a buck converter's passive filter stage, its normalized magnitude response, and the specific condition on the parasitic resistances that results in a maximally flat magnitude response at the natural frequency $\\omega_0$.\n\n### **Problem Validation**\n\n**Step 1: Extract Givens**\n- **System:** Continuous-conduction-mode (CCM) buck converter power stage.\n- **Parasitics:** Inductor Direct Current Resistance ($R_{\\mathrm{DCR}}$), Capacitor Equivalent Series Resistance ($R_{\\mathrm{ESR}}$).\n- **Assumptions:** Ideal switch network, ideal input source.\n- **Analysis:** Small-signal model based on state-space averaging. Duty ratio perturbation $\\hat{d}(s)$ and input source perturbation $\\hat{v}_g(s)$ are suppressed (set to $0$).\n- **Definition of Output Impedance:** $Z_{\\mathrm{out}}(s)$ is the ratio of small-signal output voltage perturbation to a small-signal current injection at the output node.\n- **Task 1:** Derive $Z_{\\mathrm{out}}(s)$ by modeling the inductor branch impedance as $Z_{L}(s) = R_{\\mathrm{DCR}} + s L$ and the capacitor branch impedance as $Z_{C}(s) = R_{\\mathrm{ESR}} + \\frac{1}{s C}$, with the inductor's left terminal at small-signal ground. $Z_{\\mathrm{out}}(s)$ is the parallel combination of these impedances.\n- **Task 2:** Define natural frequency $\\omega_{0} = \\frac{1}{\\sqrt{L C}}$ and characteristic impedance $Z_{0} = \\sqrt{\\frac{L}{C}}$. Express the squared magnitude $|Z_{\\mathrm{out}}(j \\omega)|^2$ normalized by $Z_{0}^{2}$ as a rational function of dimensionless frequency $x = \\frac{\\omega}{\\omega_{0}}$ and normalized resistances $r_{L} = \\frac{R_{\\mathrm{DCR}}}{Z_{0}}$ and $r_{C} = \\frac{R_{\\mathrm{ESR}}}{Z_{0}}$.\n- **Task 3:** Determine the condition on $R_{\\mathrm{ESR}}$ and $R_{\\mathrm{DCR}}$ that yields a maximally flat magnitude response, defined by the first and second derivatives of $| Z_{\\mathrm{out}}(j \\omega) |$ with respect to $\\omega$ vanishing at $\\omega = \\omega_{0}$. The result should be a pair $(R_{\\mathrm{ESR}}, R_{\\mathrm{DCR}})$ in terms of $L$ and $C$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, being a standard exercise in the small-signal analysis of power converters, a fundamental topic in power electronics. The modeling assumptions (ideal switches, suppressed perturbations) are standard for deriving subsystem transfer functions like output impedance. The concepts of parasitic resistance, characteristic impedance, and maximally flat (Butterworth-type) responses are all well-established in electrical engineering and filter theory. The problem is well-posed, with all necessary information provided and a clear objective. The language is precise and objective. No scientific, logical, or factual flaws are present.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\n### **Solution Derivation**\n\n**Part 1: Small-Signal Output Impedance $Z_{\\mathrm{out}}(s)$**\n\nIn the small-signal model of the buck converter, setting the duty cycle perturbation $\\hat{d}(s)$ and the input voltage perturbation $\\hat{v}_g(s)$ to zero effectively connects the input of the $L$-$C$ filter to small-signal ground. The output impedance $Z_{\\mathrm{out}}(s)$ is then the impedance of this passive filter network as seen from the output terminals. This network consists of the inductor branch in parallel with the capacitor branch.\n\nThe impedance of the inductor branch, including its DCR, is given by:\n$$Z_{L}(s) = R_{\\mathrm{DCR}} + s L$$\nThe impedance of the capacitor branch, including its ESR, is given by:\n$$Z_{C}(s) = R_{\\mathrm{ESR}} + \\frac{1}{s C}$$\nThe total output impedance $Z_{\\mathrm{out}}(s)$ is the parallel combination of $Z_{L}(s)$ and $Z_{C}(s)$:\n$$Z_{\\mathrm{out}}(s) = Z_{L}(s) \\parallel Z_{C}(s) = \\frac{Z_{L}(s) Z_{C}(s)}{Z_{L}(s) + Z_{C}(s)}$$\nSubstituting the expressions for $Z_{L}(s)$ and $Z_{C}(s)$:\n$$Z_{\\mathrm{out}}(s) = \\frac{(R_{\\mathrm{DCR}} + s L) (R_{\\mathrm{ESR}} + \\frac{1}{s C})}{R_{\\mathrm{DCR}} + s L + R_{\\mathrm{ESR}} + \\frac{1}{s C}}$$\nThis expression can be expanded into a standard rational function form:\n$$Z_{\\mathrm{out}}(s) = \\frac{(R_{\\mathrm{DCR}} + s L) \\frac{s C R_{\\mathrm{ESR}} + 1}{s C}}{\\frac{s C (R_{\\mathrm{DCR}} + R_{\\mathrm{ESR}}) + s^2 L C + 1}{s C}} = \\frac{s^2 L C R_{\\mathrm{ESR}} + s(L + C R_{\\mathrm{DCR}} R_{\\mathrm{ESR}}) + R_{\\mathrm{DCR}}}{s^2 L C + s C(R_{\\mathrm{DCR}} + R_{\\mathrm{ESR}}) + 1}$$\n\n**Part 2: Normalized Squared Magnitude Response**\n\nWe are asked to express $\\frac{|Z_{\\mathrm{out}}(j \\omega)|^2}{Z_{0}^{2}}$ as a function of the normalized variables. Let's start with the impedance ratio $\\frac{Z_{\\mathrm{out}}(s)}{Z_{0}}$. We use the given definitions: $\\omega_{0} = \\frac{1}{\\sqrt{L C}}$, $Z_{0} = \\sqrt{\\frac{L}{C}}$, $x = \\frac{\\omega}{\\omega_{0}}$, $r_{L} = \\frac{R_{\\mathrm{DCR}}}{Z_{0}}$, and $r_{C} = \\frac{R_{\\mathrm{ESR}}}{Z_{0}}$. From these, we can express $L$ and $C$ as $L = \\frac{Z_0}{\\omega_0}$ and $C = \\frac{1}{Z_0 \\omega_0}$.\n\nWe substitute $s = j\\omega = j x \\omega_0$ into the component impedances:\n$$R_{\\mathrm{DCR}} = r_L Z_0$$\n$$R_{\\mathrm{ESR}} = r_C Z_0$$\n$$s L = j x \\omega_0 \\left(\\frac{Z_0}{\\omega_0}\\right) = j x Z_0$$\n$$\\frac{1}{s C} = \\frac{1}{j x \\omega_0 \\left(\\frac{1}{Z_0 \\omega_0}\\right)} = \\frac{Z_0}{j x} = -j \\frac{Z_0}{x}$$\nNow, substitute these into the expression for $Z_{\\mathrm{out}}(s)$:\n$$Z_{\\mathrm{out}}(j\\omega) = Z_0 \\frac{(r_L + j x) (r_C - j \\frac{1}{x})}{(r_L + r_C) + j(x - \\frac{1}{x})}$$\nThe normalized impedance is:\n$$\\frac{Z_{\\mathrm{out}}(j\\omega)}{Z_0} = \\frac{(r_L + j x) (r_C - j \\frac{1}{x})}{(r_L + r_C) + j(x - \\frac{1}{x})}$$\nWe now find the squared magnitude of this complex expression:\n$$\\frac{|Z_{\\mathrm{out}}(j\\omega)|^2}{Z_0^2} = \\frac{|(r_L + j x) (r_C - j \\frac{1}{x})|^2}{|(r_L + r_C) + j(x - \\frac{1}{x})|^2} = \\frac{|r_L + j x|^2 |r_C - j \\frac{1}{x}|^2}{(r_L + r_C)^2 + (x - \\frac{1}{x})^2}$$\nThis simplifies to:\n$$\\frac{|Z_{\\mathrm{out}}(j\\omega)|^2}{Z_0^2} = \\frac{(r_L^2 + x^2) (r_C^2 + \\frac{1}{x^2})}{(r_L + r_C)^2 + (x - \\frac{1}{x})^2}$$\nTo express this as a rational function of $x$, we can expand and multiply the numerator and denominator by $x^2$:\n$$\\frac{|Z_{\\mathrm{out}}(j\\omega)|^2}{Z_0^2} = \\frac{r_L^2 r_C^2 + \\frac{r_L^2}{x^2} + x^2 r_C^2 + 1}{(r_L+r_C)^2 + x^2 - 2 + \\frac{1}{x^2}} = \\frac{r_C^2 x^4 + (r_L^2 r_C^2 + 1)x^2 + r_L^2}{x^4 + ((r_L+r_C)^2 - 2)x^2 + 1}$$\n\n**Part 3: Condition for Maximally Flat Magnitude Response**\n\nThe condition for a maximally flat magnitude response at $\\omega=\\omega_0$ (which corresponds to $x=1$) is that the first and second derivatives of $|Z_{\\mathrm{out}}(j\\omega)|$ with respect to $\\omega$ vanish at $\\omega=\\omega_0$. It is mathematically more convenient to work with the squared magnitude. Let $F(x) = \\frac{|Z_{\\mathrm{out}}(j\\omega)|^2}{Z_0^2}$. The condition is equivalent to setting the first and second derivatives of $F(x)$ with respect to $x$ to zero at $x=1$, provided $|Z_{\\mathrm{out}}(j\\omega_0)| \\neq 0$.\n\nLet $F(x) = \\frac{N(x)}{D(x)}$, where:\n$$N(x) = r_L^2 r_C^2 + r_L^2 x^{-2} + r_C^2 x^2 + 1$$\n$$D(x) = (r_L+r_C)^2 + x^2 - 2 + x^{-2}$$\nThe first derivative is $F'(x) = \\frac{N'(x)D(x) - N(x)D'(x)}{D(x)^2}$. For $F'(1)=0$, we need $N'(1)D(1) - N(1)D'(1)=0$.\nFirst, we find the derivatives of $N(x)$ and $D(x)$:\n$$N'(x) = -2 r_L^2 x^{-3} + 2 r_C^2 x \\implies N'(1) = 2(r_C^2 - r_L^2)$$\n$$D'(x) = 2x - 2x^{-3} \\implies D'(1) = 2(1) - 2(1) = 0$$\nAt $x=1$:\n$$D(1) = (r_L+r_C)^2 + 1 - 2 + 1 = (r_L+r_C)^2$$\nThe first derivative condition becomes:\n$$2(r_C^2 - r_L^2)(r_L+r_C)^2 - N(1) \\cdot 0 = 0$$\n$$2(r_C - r_L)(r_C + r_L)(r_L+r_C)^2 = 0$$\nSince resistances are non-negative, $r_L \\ge 0$ and $r_C \\ge 0$. The term $(r_L+r_C)$ can only be zero if both resistances are zero, a trivial case. Thus, we must have $r_C - r_L = 0$, which implies:\n$$r_L = r_C$$\nThis is the first condition. Let's denote the common value by $r$.\n\nNow for the second derivative. The general expression is complex, but at a point where $N'(1)=0$ and $D'(1)=0$, it simplifies.\n$F''(1) = \\frac{N''(1)D(1) - N(1)D''(1)}{D(1)^2}$. For $F''(1)=0$, we need $N''(1)D(1) - N(1)D''(1)=0$.\nLet's compute the second derivatives:\n$$N''(x) = 6 r_L^2 x^{-4} + 2 r_C^2 \\implies N''(1) = 6 r_L^2 + 2 r_C^2$$\n$$D''(x) = 2 + 6x^{-4} \\implies D''(1) = 2 + 6 = 8$$\nWe also need $N(1)$:\n$$N(1) = (r_L^2+1)(r_C^2+1)$$\nSubstituting these into the condition and using $r_L=r_C=r$:\n$$(6r^2+2r^2)(r+r)^2 - (r^2+1)(r^2+1)(8) = 0$$\n$$(8r^2)(2r)^2 - 8(r^2+1)^2 = 0$$\n$$(8r^2)(4r^2) - 8(r^4 + 2r^2 + 1) = 0$$\n$$32r^4 - 8r^4 - 16r^2 - 8 = 0$$\n$$24r^4 - 16r^2 - 8 = 0$$\nDividing by $8$:\n$$3r^4 - 2r^2 - 1 = 0$$\nThis is a quadratic equation for $r^2$. Let $y=r^2$.\n$$3y^2 - 2y - 1 = 0$$\nFactoring this gives:\n$$(3y+1)(y-1) = 0$$\nThe solutions for $y$ are $y = -\\frac{1}{3}$ and $y = 1$. Since $y=r^2$ and $r$ is a real, non-negative quantity, $r^2$ must be non-negative. Therefore, the only physically valid solution is $r^2=1$, which implies $r=1$.\n\nThe condition for the maximally flat magnitude response is $r_L=r_C=1$.\nWe convert this back to the original resistance values:\n$$r_L = \\frac{R_{\\mathrm{DCR}}}{Z_0} = 1 \\implies R_{\\mathrm{DCR}} = Z_0 = \\sqrt{\\frac{L}{C}}$$\n$$r_C = \\frac{R_{\\mathrm{ESR}}}{Z_0} = 1 \\implies R_{\\mathrm{ESR}} = Z_0 = \\sqrt{\\frac{L}{C}}$$\nThus, both the inductor DCR and capacitor ESR must be equal to the characteristic impedance $Z_0$ of the filter.\n\nThe final condition is the pair $(R_{\\mathrm{ESR}}, R_{\\mathrm{DCR}})$ given by $(\\sqrt{\\frac{L}{C}}, \\sqrt{\\frac{L}{C}})$.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\sqrt{\\frac{L}{C}} & \\sqrt{\\frac{L}{C}} \\end{pmatrix}}$$"
        }
    ]
}