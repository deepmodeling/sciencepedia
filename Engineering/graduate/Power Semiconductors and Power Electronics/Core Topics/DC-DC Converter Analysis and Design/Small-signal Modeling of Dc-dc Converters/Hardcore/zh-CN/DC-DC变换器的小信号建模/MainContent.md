## 引言
开关模式DC-DC变换器是现代电子系统的基石，为从手持设备到数据中心和电动汽车的各种应用提供高效的电能转换。然而，其固有的开关特性使其成为一种高度[非线性](@entry_id:637147)的[时变系统](@entry_id:175653)，这给精确、快速的输出电压调节带来了巨大挑战。若要设计出鲁棒的反馈控制器，我们必须超越[时域仿真](@entry_id:755983)，建立一个能够揭示系统动态本质并指导设计的数学模型。

本文旨在解决这一核心问题，系统地介绍将复杂的开关电路转化为易于分析的[线性时不变](@entry_id:276287)（LTI）模型的过程，即[小信号建模](@entry_id:1131775)。通过掌握这项技术，读者将能够深刻理解变换器的动态行为，并为其设计高性能的控制系统。

文章将分为三个核心章节。第一章“原理与机制”将深入探讨[小信号建模](@entry_id:1131775)的理论基础，详细介绍[状态空间平均法](@entry_id:1132297)和平均开关模型，并阐明这些模型的有效性条件。第二章“应用与交叉学科联系”将展示这些模型的强大威力，探讨如何利用它们进行[控制器设计](@entry_id:274982)、性能量化、分析先进控制策略，并解决与[电力](@entry_id:264587)系统等领域的交叉耦合问题。最后，“动手实践”部分将通过一系列精心设计的练习，引导您将理论知识应用于具体的工程问题，从而巩固和深化您的理解。让我们首先从构建这些模型的基本原理与机制开始。

## 原理与机制

在“引言”章节中，我们已经了解，开关模式DC-DC变换器本质上是时变的[非线性系统](@entry_id:168347)。为了设计出能够精确调节其输出的反馈控制器，我们必须首先建立一个能够描述其动态行为的数学模型。直接对开关电路进行[时域仿真](@entry_id:755983)虽然精确，但计算量巨大，且难以提供用于[控制器综合](@entry_id:261816)的设计洞察力。因此，我们需要一种系统化的方法来获得一个在特定工作点附近足够精确的[线性时不变](@entry_id:276287)（LTI）模型。本章将深入探讨建立这种模型的核心原理与机制，即[状态空间平均法](@entry_id:1132297)和小信号线性化。

### [小信号建模](@entry_id:1131775)的基础：平均化与线性化

将一个[非线性](@entry_id:637147)的开关系统转化为一个[LTI模型](@entry_id:1127521)，主要包含两个关键步骤：**平均化（Averaging）** 和 **线性化（Linearization）**。平均化的目标是消除由高频开关动作引起的内在纹波，得到一个描述变换器低频动态的连续非线性模型。线性化则是在此平均模型的基础上，围绕一个[静态工作点](@entry_id:264648)进行[泰勒级数展开](@entry_id:138468)，从而得到一个描述微小扰动动态的[LTI模型](@entry_id:1127521)。

#### [状态空间平均法](@entry_id:1132297)的概念

[状态空间平均法](@entry_id:1132297)通过在一个开关周期内对变换器的状态方程进行加权平均，来近似其低频动态。这种方法的根本前提是**时间尺度分离（Time-Scale Separation）**：我们关心的控制动态（例如，响应负载变化的动态）所处的频段，必须远低于变换器的开关频率。如果这个条件成立，状态变量（如电感电流和电容电压）在一个开关周期内的变化将非常小，我们可以合理地认为这些状态变量的动态是由其在一个周期内的“平均”行为主导的。

#### 平均化与线性化的有效性条件

为了确保[小信号模型](@entry_id:270703)的有效性和准确性，必须满足一系列严格的数学和物理条件。假设变换器的平均模型可以表示为[非线性](@entry_id:637147)[状态空间](@entry_id:160914)形式 $\dot{x}(t) = f(x(t), d(t), p)$，其中 $x(t)$ 是状态向量，$d(t)$ 是[占空比](@entry_id:199172)，$p$ 是系统参数。在[稳态](@entry_id:139253)[工作点](@entry_id:173374) $(X, D)$ 附近，我们将变量表示为直流分量与交流小信号扰动之和：$x(t) = X + \hat{x}(t)$ 和 $d(t) = D + \hat{d}(t)$。线性化模型的有效性依赖于以下几个核心假设 ：

1.  **小信号假设**：这是线性化的数学基础。扰动量 $\hat{x}(t)$ 和 $\hat{d}(t)$ 必须“足够小”，使得在对[非线性](@entry_id:637147)函数 $f$ 进行[泰勒级数展开](@entry_id:138468)时，所有二阶及更高阶的扰动项（如 $\hat{x}(t)^2$, $\hat{d}(t)^2$, $\hat{x}(t)\hat{d}(t)$）与一阶项相比可以忽略不计。通常，这意味着扰动的大小远小于其对应的直流工作点值，即 $\|\hat{x}(t)\| \ll \|X\|$ 和 $|\hat{d}(t)| \ll 1$。

2.  **平均化有效性假设**：这是平均化的物理基础。所有扰动信号的[频谱](@entry_id:276824)（即其带宽）必须远低于开关频率 $f_s$（或[角频率](@entry_id:261565) $\omega_s$）。如果扰动频率接近开关频率，平均化处理将失效，开关纹波与扰动信号会发生混叠，产生模型无法预测的复杂动态。

3.  **工作模式不变性**：变换器的平均模型 $f$ 取决于其工作模式，例如**连续导通模式（Continuous Conduction Mode, CCM）**或**断续导通模式（Discontinuous Conduction Mode, DCM）**。[小信号模型](@entry_id:270703)是围绕特定模式下的一个工作点建立的。因此，扰动的大小必须被限制在不会导致变换器跨越模式边界的范围内（例如，在CC[M模式](@entry_id:915690)下，电感电流的最小值必须始终大于零）。

4.  **[占空比](@entry_id:199172)饱和限制**：物理上，[占空比](@entry_id:199172) $d(t)$ 必须严格保持在 $(0, 1)$ 区间内。任何导致 $D + \hat{d}(t)$ 超出此范围的扰动都会使变换器停止正常开关，从而使平均模型失效。

只有当这些条件同时满足时，通过平均化和线性化得到的小信号[LTI模型](@entry_id:1127521)才能准确地描述变换器在[工作点](@entry_id:173374)附近的局部动态特性。

### 通用[状态空间](@entry_id:160914)平均（SSA）模型

基于上述原则，我们可以为任何DC-DC变换器推导出标准的LTI状态空间模型。

#### [LTI模型](@entry_id:1127521)的推导

我们从一个更通用的[非线性](@entry_id:637147)平均模型开始，该模型包含[状态向量](@entry_id:154607) $x(t)$、控制输入（[占空比](@entry_id:199172)）$u(t)$ 和外部输入（如输入电压）$v(t)$：
$$
\begin{align}
\dot{x}(t) = f(x(t), u(t), v(t)) \\
y(t) = h(x(t), u(t), v(t))
\end{align}
$$
其中 $y(t)$ 是我们关心的输出量（如输出电压）。

我们围绕一个满足 $f(X, U, V) = 0$ 和 $Y = h(X, U, V)$ 的[稳态](@entry_id:139253)工作点 $(X, U, V)$ 进行线性化。引入小信号扰动：
$$
x(t) = X + \hat{x}(t), \quad u(t) = U + \hat{u}(t), \quad v(t) = V + \hat{v}(t), \quad y(t) = Y + \hat{y}(t)
$$
将这些代入原方程，并在工作点进行一阶[泰勒级数展开](@entry_id:138468)。对于状态方程：
$$
\dot{X} + \dot{\hat{x}}(t) \approx f(X, U, V) + \frac{\partial f}{\partial x}\bigg|_{(X,U,V)} \hat{x}(t) + \frac{\partial f}{\partial u}\bigg|_{(X,U,V)} \hat{u}(t) + \frac{\partial f}{\partial v}\bigg|_{(X,U,V)} \hat{v}(t)
$$
由于 $\dot{X}=0$ 且 $f(X, U, V)=0$，上式简化为小信号状态方程。对输出方程进行同样的处理，我们可以得到一个完整的LTI[状态空间模型](@entry_id:137993) ：
$$
\begin{align}
\dot{\hat{x}}(t) = A\hat{x}(t) + B\hat{u}(t) + E\hat{v}(t) \\
\hat{y}(t) = C\hat{x}(t) + D_m\hat{u}(t) + F\hat{v}(t)
\end{align}
$$
其中，矩阵 $A, B, E, C, D_m, F$ 都是在工作点 $(X, U, V)$ 处求得的[雅可比矩阵](@entry_id:178326)：
- $A = \frac{\partial f}{\partial x}$ **(状态矩阵)**
- $B = \frac{\partial f}{\partial u}$ **(控制输入矩阵)**
- $E = \frac{\partial f}{\partial v}$ **(线路输入矩阵)**
- $C = \frac{\partial h}{\partial x}$ **(输出矩阵)**
- $D_m = \frac{\partial h}{\partial u}$ **(前馈矩阵)**
- $F = \frac{\partial h}{\partial v}$ **(线路到输出矩阵)**

注意，我们将前馈矩阵记为 $D_m$，以区别于[占空比](@entry_id:199172)的直流分量 $D$。这个模型清晰地描述了控制扰动 $\hat{u}(t)$ 和线路扰动 $\hat{v}(t)$ 如何通过变换器的内部动态（由矩阵 $A$ 描述）影响输出扰动 $\hat{y}(t)$。在实际测量中，总输出 $y(t) = Y + \hat{y}(t)$ 包含一个大的直流分量 $Y$ 和一个小的交流分量 $\hat{y}(t)$。为了分析动态响应，我们需要将 $\hat{y}(t)$ 从 $Y$ 中分离出来，这可以通过**[交流耦合](@entry_id:267307)（AC Coupling）**或[数字信号处理](@entry_id:263660)中的**[直流偏置](@entry_id:271748)移除**来实现。

#### 从模型到传递函数

一旦获得了LTI[状态空间模型](@entry_id:137993)，就可以通过[拉普拉斯变换](@entry_id:159339)推导出各种**传递函数（Transfer Function）**。例如，我们最常关心的**控制到输出传递函数** $G_{vd}(s) = \hat{v}_o(s)/\hat{d}(s)$（假设 $\hat{v}_g(s)=0$）可以由下式给出：
$$
G_{vd}(s) = C(sI - A)^{-1}B + D_m
$$
其中 $I$ 是单位矩阵，$s$ 是[复频率](@entry_id:266400)。这个传递函数是设计[反馈控制](@entry_id:272052)器的基础。

#### 示例：理想Boost变换器的SSA建模

让我们将此方法应用于一个在CC[M模式](@entry_id:915690)下工作的理想Boost变换器。其[状态向量](@entry_id:154607)为 $x(t) = \begin{pmatrix} i_L(t)  v_C(t) \end{pmatrix}^T$，其中 $i_L$ 是电感电流，$v_C$ 是电容（输出）电压。在忽略输入电压扰动的情况下，其线性化后的[状态空间](@entry_id:160914)矩阵为 ：
$$
A = \begin{pmatrix} 0  -\frac{1-D}{L} \\ \frac{1-D}{C}  -\frac{1}{RC} \end{pmatrix}, \quad B = \begin{pmatrix} \frac{V_C}{L} \\ -\frac{I_L}{C} \end{pmatrix}, \quad C = \begin{pmatrix} 0  1 \end{pmatrix}, \quad D_m = 0
$$
其中 $V_C = V_g/(1-D)$ 和 $I_L = V_g/(R(1-D)^2)$ 是[稳态](@entry_id:139253)输出电压和电感电流。

通过计算 $G_{vd}(s) = C(sI-A)^{-1}B$，我们可以得到：
$$
(sI-A)^{-1} = \frac{1}{s^2 + \frac{s}{RC} + \frac{(1-D)^2}{LC}} \begin{pmatrix} s + \frac{1}{RC}  \frac{1-D}{L} \\ -\frac{1-D}{C}  s \end{pmatrix}
$$
进而得到：
$$
G_{vd}(s) = \frac{\frac{V_g}{LC} - s\frac{V_g}{RC(1-D)^2}}{s^2 + \frac{s}{RC} + \frac{(1-D)^2}{LC}} = \frac{V_g \left(1 - s \frac{L}{R(1-D)^2}\right)}{s^2 LC + s\frac{L}{R} + (1-D)^2}
$$

#### [直流增益](@entry_id:267449)验证

推导出的传递函数是否正确，一个重要的**健全性检查（Sanity Check）**是验证其**[直流增益](@entry_id:267449)（DC Gain）**。传递函数的[直流增益](@entry_id:267449)，即 $s \to 0$ 时的值，应等于输出量关于输入量的静态灵敏度。对于控制到输出传递函数，我们有：
$$
\lim_{s \to 0} G_{vd}(s) = \frac{dV_o}{dD}
$$
在上述Boost变换器的例子中，$G_{vd}(0) = \frac{V_g}{(1-D)^2}$。同时，其静态电压关系为 $V_o = V_g/(1-D)$，其对 $D$ 的导数为 $\frac{d V_o}{dD} = \frac{V_g}{(1-D)^2}$。两者完全吻合，从而验证了模型的正确性 。

### 另一种方法：平均开关模型

除了正式的[状态空间平均法](@entry_id:1132297)，还有一种更偏向电路直觉的建模方法，即**平均开关模型（Averaged Switch Model）**，由 V. Vorperian 提出。该方法将变换器中的“开关-二[极管](@entry_id:909477)”单元视为一个三端口的平均电路元件，从而允许我们使用标准的[电路分析](@entry_id:261116)技术（如KCL、KVL）直接在平均电[路图](@entry_id:274599)上进行分析。

对于一个工作在CC[M模式](@entry_id:915690)下的PWM开关单元，其三个端口分别为“有源”端（a）、“无源”端（p）和“公共”端（c）。其端口电压和电流的平均关系为：
$$
v_{ap}(t) = d(t) v_{cp}(t) \quad \text{和} \quad i_c(t) = d(t) i_a(t)
$$
这些简单的代数关系极大地简化了建模过程。

#### 示例：含ESR的Boost变换器

让我们使用平均开关模型来分析一个更实际的Boost变换器，其输出电容包含**[等效串联电阻](@entry_id:275904)（Equivalent Series Resistance, ESR）** $r_c$ 。在Boost变换器中，开关的“公共”端连接到输入电压 $V_g$ 和电感 $L$，“有源”端连接到输出，而“无源”端接地。平均开关关系变为 $v_c(t) = (1-d(t))v_a(t)$ 和 $i_a(t) = (1-d(t))i_c(t)$。

通过对平均电路图应用KVL和KCL，并进行小信号线性化，我们可以直接推导出其控制到输出传递函数，而无需构建[状态空间](@entry_id:160914)矩阵。最终结果为：
$$
G_{vd}(s) = \frac{\frac{V_g}{(1-D)^2} (1+sCr_c)((1-D)^2 R - sL)}{s^2LC(R+r_c) + s(L+(1-D)^2 RCr_c) + (1-D)^2 R}
$$
这个结果不仅包含了理想Boost变换器的动态特性，还揭示了ESR引入的新特征，我们将在下一节详细讨论。

### 变换器传递函数的关键特征

通过上述建模方法得到的传递函数，通常包含一些共同的特征，如[极点和零点](@entry_id:262457)，它们决定了变换器的动态响应。

#### LC谐振极点

大多数基本拓扑（Buck, Boost, Buck-Boost）的传递函数的分母都是一个二阶多项式，其形式为 $s^2LC + \dots$。这个二阶项来源于输出级的**[LC滤波器](@entry_id:274694)**，它引入了一对**谐振极点（Resonant Poles）**。这对极点决定了变换器对扰动的自然振荡频率和阻尼特性。

#### ESR零点

从前面包含ESR的Boost变换器模型中，我们看到分子中出现了 $(1+sCr_c)$ 这一项。这对应于一个位于[左半平面](@entry_id:270729)（LHP）的实数零点，其频率为 $\omega_z = 1/(Cr_c)$。这个**ESR零点**是由电容的ESR引入的。在频率高于 $\omega_z$ 时，该零点会提供相位裕度提升（Phase Boost），同时增加增益。

类似地，我们也可以分析变换器的**[输出阻抗](@entry_id:265563)** $Z_{out}(s)$。对于Buck变换器，在忽略输入电压和[占空比](@entry_id:199172)扰动时，其[输出阻抗](@entry_id:265563)可以看作是电感 $L$ 与“电容C串联ESR $R_C$”支路的并联。其归一化输出阻抗可以表示为 ：
$$
\bar{Z}_{\mathrm{out}}(\hat{s}) = \frac{\hat{s}(1 + \hat{s}/\Omega_z)}{1 + \hat{s}/\Omega_z + \hat{s}^2}
$$
其中 $\hat{s} = s/\omega_0$ 是[归一化频率](@entry_id:171939)，$\omega_0=1/\sqrt{LC}$，$\Omega_z = \omega_z/\omega_0$ 是归一化ESR零点频率。这个表达式清楚地显示了ESR零点对输出阻抗特性的影响：它在LC谐振之上引入了一个零点，改变了高频段的阻抗特性。

#### [右半平面](@entry_id:277010)（RHP）零点：[非最小相位](@entry_id:267340)挑战

在Boost和Buck-Boost等拓扑的控制到输出传递函数中，我们观察到分子中存在形如 $(K - sL)$ 的项，例如在理想Boost模型中是 $(V_g - s L I_L)$。这引入了一个位于复平面右半部分的零点，即**右半平面零点（Right-Half-Plane Zero, RHPZ）**。

- **物理起源**：RHPZ源于一种“反向”动态响应。以Boost变换器为例，当控制器为了提高输出电压而增加[占空比](@entry_id:199172) $\hat{d}$ 时，开关导通时间变长，而二[极管](@entry_id:909477)关断时间变短。由于能量仅在二[极管](@entry_id:909477)导通期间传输到输出端，[占空比](@entry_id:199172)的增加会**立即**导致流向输出的平均电流减小，使得输出电压在初始瞬间不升反降。只有在稍后，由于更长的导通时间使得[电感储能](@entry_id:270721)增加，输出电压才会逐渐爬升到更高的[稳态](@entry_id:139253)值。这种“先降后升”的[非最小相位](@entry_id:267340)行为，在数学上就表现为RHPZ。

- **比较分析 (Boost vs. Buck-Boost)**：RHPZ的位置取决于变换器的参数和[工作点](@entry_id:173374)。对于具有相同 $L, R, D$ 的Boost和Buck-Boost变换器，它们的RHPZ位置是不同的 ：
    $$
    \omega_{z,\mathrm{boost}} = \frac{R(1-D)^2}{L}, \quad \omega_{z,\mathrm{bb}} = \frac{R(1-D)^2}{LD}
    $$
    由于 $D  1$，Buck-Boost变换器的RHPZ频率更高。这背后的物理原因是，在相同条件下，Boost变换器的[稳态](@entry_id:139253)电感电流 $I_L$ 更大。更大的电感电流意味着在[占空比](@entry_id:199172)扰动时，被“截断”的输出电流也更大，从而导致更强烈的“反向”效应，对应于一个频率更低的RHPZ。

- **控制影响**：RHPZ对控制设计构成了根本性的限制。它在增加增益的同时引入了[相位滞后](@entry_id:172443)（与LHP零点相反），这会严重侵蚀[相位裕度](@entry_id:264609)。一个普遍的法则是，[闭环控制系统](@entry_id:269635)的带宽必须远低于RHPZ的频率，否则系统将变得不稳定。

#### 输出极性的影响：反相变换器

对于**反相Buck-Boost变换器**，其输出电压为负 ($v_o  0$)。这一特性对其[小信号模型](@entry_id:270703)有着至关重要的影响。通过对其[稳态](@entry_id:139253)关系 $V_o = -V_g \frac{D}{1-D}$ 求导，我们发现其[直流增益](@entry_id:267449)为 ：
$$
G_{vd}(0) = \frac{dV_o}{dD} = -\frac{V_g}{(1-D)^2}
$$
这个增益是**负数**。这意味着该变换器在其控制通路中天然地包含了一个**信号反相**，对应于 $180^\circ$ 的相移。在标准的负[反馈控制](@entry_id:272052)环路中（[误差信号](@entry_id:271594) $e = v_{ref} - v_{sense}$），这个额外的 $180^\circ$ 相移会将负反馈转变为**正反馈**，导致系统不稳定。

为了解决这个问题，[设计控制](@entry_id:904437)器时必须进行补偿。常见的方法有两种：
1.  使用一个本身就是反相的控制器（例如，运算放大器配置为反相放大）。
2.  在反馈求和点处，将减法改为加法（即 $e = v_{ref} + v_{sense}$）。

忽略这个固有的符号反转是设计反相变换器控制器时一个常见且致命的错误。

### PWM与采样效应的建模

到目前为止，我们的模型主要基于平均化思想，即假设开关频率无限高。然而，在实际系统中，PWM过程本身是一个离散时间的采样与保持过程，它会引入额外的动态，主要是**[相位滞后](@entry_id:172443)**。

#### [时间尺度分离](@entry_id:149780)的量化要求

我们在前面提到，[平均法](@entry_id:264400)要求扰动频率远低于开关频率。这个“远低于”究竟是多少？我们可以通过将PWM过程建模为一个**[零阶保持器](@entry_id:264751)（Zero-Order Hold, ZOH）**来量化这个要求 。一个持续时间为 $T_s$ 的ZOH的传递函数为 $G_{ZOH}(s) = (1 - e^{-sT_s})/s$。在控制建模中，我们通常关心其对理想平坦增益的偏离，其归一化传递函数为：
$$
G'_{ZOH}(s) = \frac{1 - e^{-sT_s}}{sT_s} = \frac{\sin(\omega T_s/2)}{\omega T_s/2} e^{-j\omega T_s/2}
$$
这个模型在频率 $\omega$ 处引入了大小为 $\frac{\sin(\omega T_s/2)}{\omega T_s/2}$ 的增益衰减和大小为 $\omega T_s/2$ 的[相位滞后](@entry_id:172443)。

如果我们要求在系统的[主导极点](@entry_id:275579)频率 $f_p$ 处，由ZOH引入的幅值误差小于 $5\%$ 且相位滞后小于 $10^\circ$，通过计算可以得到一个保守的工程准则：开关频率 $f_s$ 应至少是[主导极点](@entry_id:275579)频率 $f_p$ 的20倍，即 $f_s/f_p \gtrsim 20$。

#### 实际影响：相位裕度的损失

对于控制设计而言，PWM采样引入的最直接影响就是**[相位裕度](@entry_id:264609)（Phase Margin）**的损失。一个更简单的模型是将PWM的[延迟效应](@entry_id:199612)近似为一个纯时间延迟 $e^{-sT_s}$ 。在穿越频率 $\omega_c = 2\pi f_c$ 处，这个延迟引入的额外[相位滞后](@entry_id:172443)为：
$$
\Delta \phi = \omega_c T_s = (2\pi f_c) \frac{1}{f_s} = 2\pi \frac{f_c}{f_s} \quad (\text{弧度})
$$
换算成角度，相位裕度的损失为：
$$
\Delta PM = 360^\circ \frac{f_c}{f_s}
$$
这个简洁的公式非常强大。它告诉我们，[相位裕度](@entry_id:264609)的损失直接正比于闭环带宽 $f_c$ 与开关频率 $f_s$ 的比值。例如，如果一个变换器的开关频率为 $100\,\text{kHz}$，设计的目标闭环带宽为 $5\,\text{kHz}$（这是一个 $f_s/f_c=20$ 的典型比例），那么仅PWM采样这一项就会造成 $360^\circ \times \frac{5}{100} = 18^\circ$ 的相位裕度损失。这在控制设计中是一个不可忽略的重要因素，它直接限制了在给定开关频率下可以实现的[闭环性能](@entry_id:265001)。