{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在巩固您对Foster网络如何模拟瞬态温升的理解。通过运用线性时不变（LTI）系统的基本原理，您将推导出一个典型功率脉冲输入下的响应，从而将抽象的网络参数与具体的物理结果联系起来。这项实践对于掌握器件在脉冲负载下的热行为至关重要。",
            "id": "3840357",
            "problem": "一个功率半导体器件的结到环境的热路径被建模为一个线性时不变 (LTI) 系统。施加的功率为随时间变化的输入 $P(t)$，产生的结温升高为输出 $\\Theta(t)$（单位为开尔文）。LTI 属性意味着叠加性和时移不变性，因此输入-输出关系是输入与系统冲激响应的卷积。热阶跃响应 $Z_{\\mathrm{th,step}}(t)$ 是由单位功率阶跃输入产生的结温升高，其时间导数是冲激响应 $h(t) = \\frac{d}{dt} Z_{\\mathrm{th,step}}(t)$。在实践中，Foster 热网络表示法将 $Z_{\\mathrm{th,step}}(t)$ 建模为具有正系数和时间常数的有限个衰减指数函数之和，由 $\\{R_{i},\\tau_{i}\\}_{i=1}^{N}$ 参数化，其中对于所有 $i$，$R_{i} > 0$ 且 $\\tau_{i} > 0$。考虑一个从 $t=0$ 开始的单个矩形功率脉冲，其幅值为 $P_{0} > 0$，宽度为 $t_{p} > 0$，即\n$$\nP(t) = P_{0} \\,\\big(u(t) - u(t - t_{p})\\big),\n$$\n其中 $u(t)$ 是亥维赛单位阶跃函数，定义为当 $t  0$ 时 $u(t)=0$，当 $t\\ge 0$ 时 $u(t)=1$。从卷积定义和上述 LTI 原理出发（不使用任何快捷公式），推导结温升高 $\\Theta(t)$ 在所有 $t \\ge 0$ 条件下的一个闭式解析表达式，该表达式应使用 $P_{0}$、$t_{p}$ 和 Foster 参数 $\\{R_{i},\\tau_{i}\\}_{i=1}^{N}$ 表示。将你的最终答案以开尔文为单位，表示为一个对所有 $t \\ge 0$ 均有效的单一解析表达式。不需要进行数值舍入。",
            "solution": "热路径被建模为一个线性时不变 (LTI) 系统。令 $h(t)$ 表示热系统的冲激响应。根据定义，如果输入功率为 $P(t)$，则结温升高 $\\Theta(t)$ 由卷积给出\n$$\n\\Theta(t) = \\int_{-\\infty}^{\\infty} P(\\tau)\\, h(t - \\tau)\\, d\\tau.\n$$\n因为系统是因果的，所以当 $t  0$ 时 $h(t) = 0$；又因为施加的功率脉冲在 $\\tau  0$ 和 $\\tau>t_{p}$ 时为零，我们可以将卷积重写为\n$$\n\\Theta(t) = \\int_{0}^{t_{p}} P_{0}\\, h(t - \\tau)\\, d\\tau,\n$$\n需要理解的是，$h(t - \\tau)$ 仅在 $t - \\tau \\ge 0$ 时有贡献，这对于 $\\tau \\le t$ 自动满足；如果 $t  t_{p}$，有效的积分上限变为 $t$；如果 $t \\ge t_{p}$，积分上限仍为 $t_{p}$。为了明确表示，\n$$\n\\Theta(t) = P_{0} \\int_{0}^{\\min(t, t_{p})} h(t - \\tau)\\, d\\tau.\n$$\n\n冲激响应 $h(t)$ 是阶跃响应 $Z_{\\mathrm{th,step}}(t)$ 的时间导数：\n$$\nh(t) = \\frac{d}{dt} Z_{\\mathrm{th,step}}(t),\n$$\n其中由于因果性，当 $t  0$ 时 $h(t)=0$ 且 $Z_{\\mathrm{th,step}}(t)=0$。Foster 表示法将阶跃热阻抗建模为具有正系数和时间常数的有限个衰减指数函数之和。具体地，可以写为\n$$\nZ_{\\mathrm{th,step}}(t) = \\sum_{i=1}^{N} R_{i} \\left(1 - \\exp\\!\\left(-\\frac{t}{\\tau_{i}}\\right)\\right) u(t),\n$$\n其中 $R_{i} > 0$ 且 $\\tau_{i} > 0$。对时间求导，得到冲激响应\n$$\nh(t) = \\sum_{i=1}^{N} \\frac{R_{i}}{\\tau_{i}} \\exp\\!\\left(-\\frac{t}{\\tau_{i}}\\right) u(t).\n$$\n\n我们现在计算与矩形脉冲的卷积。对于 $t \\ge 0$，\n\\begin{align*}\n\\Theta(t) = P_{0} \\int_{0}^{\\min(t, t_{p})} \\left[\\sum_{i=1}^{N} \\frac{R_{i}}{\\tau_{i}} \\exp\\!\\left(-\\frac{t - \\tau}{\\tau_{i}}\\right)\\right] d\\tau \\\\\n= P_{0} \\sum_{i=1}^{N} \\frac{R_{i}}{\\tau_{i}} \\exp\\!\\left(-\\frac{t}{\\tau_{i}}\\right) \\int_{0}^{\\min(t, t_{p})} \\exp\\!\\left(\\frac{\\tau}{\\tau_{i}}\\right) d\\tau \\\\\n= P_{0} \\sum_{i=1}^{N} \\frac{R_{i}}{\\tau_{i}} \\exp\\!\\left(-\\frac{t}{\\tau_{i}}\\right) \\left[ \\tau_{i} \\left( \\exp\\!\\left(\\frac{\\min(t, t_{p})}{\\tau_{i}}\\right) - 1 \\right) \\right] \\\\\n= P_{0} \\sum_{i=1}^{N} R_{i} \\left( \\exp\\!\\left(-\\frac{t - \\min(t, t_{p})}{\\tau_{i}}\\right) - \\exp\\!\\left(-\\frac{t}{\\tau_{i}}\\right) \\right).\n\\end{align*}\n这个紧凑的形式对所有 $t \\ge 0$ 都有效。通常，利用矩形脉冲是两个阶跃函数之差这一特性，将结果用亥维赛单位阶跃函数表示会很有用：\n$$\nP(t) = P_{0} \\big(u(t) - u(t - t_{p})\\big).\n$$\n与冲激响应的卷积可以使用阶跃响应来重写，因为对于任何因果 LTI 系统，\n$$\n\\int_{0}^{t} u(\\tau)\\, h(t - \\tau)\\, d\\tau = Z_{\\mathrm{th,step}}(t).\n$$\n因此，\n\\begin{align*}\n\\Theta(t) = P_{0} \\left[ Z_{\\mathrm{th,step}}(t) - u(t - t_{p})\\, Z_{\\mathrm{th,step}}(t - t_{p}) \\right] \\\\\n= P_{0} \\sum_{i=1}^{N} R_{i} \\left[ \\left(1 - \\exp\\!\\left(-\\frac{t}{\\tau_{i}}\\right)\\right) - u(t - t_{p}) \\left(1 - \\exp\\!\\left(-\\frac{t - t_{p}}{\\tau_{i}}\\right)\\right) \\right].\n\\end{align*}\n这是一个对所有 $t \\ge 0$ 都有效的等价闭式表达式。为了验证一致性：\n- 对于 $t  t_{p}$，$u(t - t_{p}) = 0$，且 $\\Theta(t) = P_{0} \\sum_{i=1}^{N} R_{i} \\left(1 - \\exp\\!\\left(-\\frac{t}{\\tau_{i}}\\right)\\right)$，这是在幅值为 $P_{0}$ 的恒定功率阶跃下，直到时间 $t$ 时的温升。\n- 对于 $t \\ge t_{p}$，第二项减去延迟的阶跃响应，得到 $\\Theta(t) = P_{0} \\sum_{i=1}^{N} R_{i} \\left( \\exp\\!\\left(-\\frac{t - t_{p}}{\\tau_{i}}\\right) - \\exp\\!\\left(-\\frac{t}{\\tau_{i}}\\right) \\right)$，当 $t \\to \\infty$ 时，该表达式衰减至零。\n\n两种形式都是闭式表达式，并且根据其构建方式，温升的单位是开尔文。所要求的最终表达式，用 $P_{0}$、$t_{p}$ 和 $\\{R_{i},\\tau_{i}\\}_{i=1}^{N}$ 表示，如下所示。",
            "answer": "$$\\boxed{P_{0} \\sum_{i=1}^{N} R_{i} \\left[ 1 - \\exp\\!\\left( - \\frac{t}{\\tau_{i}} \\right) - u(t - t_{p}) \\left( 1 - \\exp\\!\\left( - \\frac{t - t_{p}}{\\tau_{i}} \\right) \\right) \\right]}$$"
        },
        {
            "introduction": "这项练习在两种主要的热网络模型之间架起了一座桥梁。它将引导您使用在网络综合中至关重要的数学工具——连分式展开，将Foster网络模型转换为具有直接物理对应的Cauer阶梯网络。理解这种转换对于从测量数据中提取物理上可实现的模型至关重要。",
            "id": "4269069",
            "problem": "给定一个集成电路模块的线性时不变紧凑热模型的 Foster 热阻抗表示，其中电学类比将热阻等效于电阻，热容等效于电容。在拉普拉斯域中，热阻抗为\n$$\nZ_{th}(s) \\;=\\; \\sum_{i=1}^{N} \\frac{r_i}{1 + s \\tau_i},\n$$\n其中 $s$ 是拉普拉斯变量，$r_i$ 是单位为 $\\mathrm{K/W}$ 的正热阻，$\\tau_i$ 是单位为 $\\mathrm{s}$ 的正时间常数，且对于单位为 $\\mathrm{J/K}$ 的热容 $c_i$，有 $\\tau_i = r_i c_i$。这种表示法通常从瞬态热测量或有限元分析 (FEA) 中提取，并与电路仿真器（如集成电路仿真程序 SPICE）一起用于电子设计自动化 (EDA) 流程中。\n\n从热-电类比、热系统的线性以及纯阻容网络的无源性出发，使用连分式展开推导 $Z_{th}(s)$ 的 Cauer 梯形网络（Cauer-II 型）。具体要求：\n- 从第一性原理出发，证明对于 $\\Re\\{s\\} > 0$，$Z_{th}(s)$ 是一个严格真分式的正实施蒂尔切斯函数。\n- 考虑倒数 $Y(s) = 1/Z_{th}(s)$，执行连分式展开的前几个步骤，并用 Foster 参数 $\\{r_i,\\tau_i\\}$ 表示提取出的第一个并联热容 $C_0$ 和下一个串联热阻 $R_1$。\n- 使用与 $Z_{th}(s)$ 在高频下的级数展开相关的基于矩的论证，证明提取出的 Cauer 元件是正的。\n\n为具体起见，考虑具有以下参数的三阶 Foster 模型：\n$$\nr_1 = 0.8 \\;\\mathrm{K/W}, \\quad \\tau_1 = 0.04 \\;\\mathrm{s}, \\quad\nr_2 = 0.5 \\;\\mathrm{K/W}, \\quad \\tau_2 = 0.01 \\;\\mathrm{s}, \\quad\nr_3 = 0.2 \\;\\mathrm{K/W}, \\quad \\tau_3 = 0.002 \\;\\mathrm{s}.\n$$\n计算由 $Z_{th}(s)$ 实现的 Cauer-II 梯形网络的第一个并联热容 $C_0$，并以 $\\mathrm{J/K}$ 为单位表示最终数值答案。请给出精确的最终值，无需四舍五入。在推导过程中，不得引用任何快捷公式或综合法则，而必须通过连分式展开和 $Y(s)$ 在高频下的渐近行为来求得 $C_0$，并且必须使用基本的矩不等式来证明元件的正性。",
            "solution": "经核实，该问题陈述在科学上是合理的、良态的且客观的。这是网络综合理论中的一个标准问题，应用于集成电路建模中电学与热学系统之间富有成效的物理类比。所提供的数据是完整且一致的。\n\n热阻抗 $Z_{th}(s)$ 由一个无源RC网络的Foster-II表示法给出，该网络是多个并联RC支路的串联。第 $i$ 个支路（由一个电阻 $r_i$ 和一个电容 $c_i$ 并联组成）的阻抗是 $\\frac{r_i \\cdot (1/sc_i)}{r_i + 1/sc_i} = \\frac{r_i}{1+sr_ic_i}$。定义时间常数 $\\tau_i = r_i c_i$，则 $N$ 个这样的支路串联的总阻抗为：\n$$Z_{th}(s) = \\sum_{i=1}^{N} \\frac{r_i}{1 + s \\tau_i}$$\n\n首先，我们确定 $Z_{th}(s)$ 的性质。\n1.  **正实函数**：如果 $\\Re\\{s\\}  0$ 意味着 $\\Re\\{Z(s)\\} \\ge 0$，则函数 $Z(s)$ 是正实的。设 $s = \\sigma + j\\omega$ 且 $\\sigma = \\Re\\{s\\}  0$。\n    $$Z_{th}(s) = \\sum_{i=1}^{N} \\frac{r_i}{1 + (\\sigma + j\\omega)\\tau_i} = \\sum_{i=1}^{N} \\frac{r_i}{(1 + \\sigma\\tau_i) + j\\omega\\tau_i}$$\n    取其实部：\n    $$\\Re\\{Z_{th}(s)\\} = \\sum_{i=1}^{N} \\Re\\left\\{\\frac{r_i ((1 + \\sigma\\tau_i) - j\\omega\\tau_i)}{(1 + \\sigma\\tau_i)^2 + (\\omega\\tau_i)^2}\\right\\} = \\sum_{i=1}^{N} \\frac{r_i(1 + \\sigma\\tau_i)}{(1 + \\sigma\\tau_i)^2 + (\\omega\\tau_i)^2}$$\n    鉴于 $r_i  0$、$\\tau_i  0$ 且我们假设 $\\sigma  0$，求和中的每一项都严格为正。因此，当 $\\Re\\{s\\}  0$ 时，$\\Re\\{Z_{th}(s)\\}  0$，该函数是正实的。\n\n2.  **施蒂尔切斯函数**：一个施蒂尔切斯函数除了在负实轴上的一条割线外，在所有地方都是解析的；对于正实数自变量，其值为实数；并且在上半平面具有正的虚部。$Z_{th}(s)$ 的极点位于 $s = -1/\\tau_i$，这些极点都在负实轴上。由于系数 $r_i$ 是实数，所以当 $s$ 为实数时 $Z_{th}(s)$ 是实数。该函数是若干项之和，其中每一项都是一个施蒂尔切斯函数，因此 $Z_{th}(s)$ 本身也是一个施蒂尔切斯函数。\n\n3.  **严格真分式函数**：如果一个有理函数的分子的次数小于分母的次数，则该函数是严格真分式的。当 $|s| \\to \\infty$ 时，每一项的行为都像 $\\frac{r_i}{s\\tau_i}$，所以 $Z_{th}(s) \\to 0$。这证实了该函数是严格真分式的。\n\n接下来，我们使用关于 $s = \\infty$ 的连分式展开来推导Cauer-II型梯形网络表示法。这种展开可以合成一个带有并联电容和串联电阻的梯形网络。\n热导纳为 $Y(s) = 1/Z_{th}(s)$。由于当 $s \\to \\infty$ 时 $Z_{th}(s) \\to 0$，所以 $Y(s)$ 必定趋于无穷大。对于一个RC网络，导纳最多只能随 $s$ 线性增长。第一个Cauer元件，一个并联热容 $C_0$，通过取以下极限来提取：\n$$C_0 = \\lim_{s\\to\\infty} \\frac{Y(s)}{s} = \\lim_{s\\to\\infty} \\frac{1}{s Z_{th}(s)}$$\n为了计算这个极限，我们对 $Z_{th}(s)$ 在 $s$ 很大时进行级数展开：\n$$Z_{th}(s) = \\sum_{i=1}^{N} \\frac{r_i}{s\\tau_i(1 + 1/(s\\tau_i))} = \\sum_{i=1}^{N} \\frac{r_i}{s\\tau_i} \\left( 1 - \\frac{1}{s\\tau_i} + \\frac{1}{(s\\tau_i)^2} - \\dots \\right)$$\n$$Z_{th}(s) = \\frac{1}{s}\\left(\\sum_{i=1}^{N} \\frac{r_i}{\\tau_i}\\right) - \\frac{1}{s^2}\\left(\\sum_{i=1}^{N} \\frac{r_i}{\\tau_i^2}\\right) + O(s^{-3})$$\n我们定义高频矩 $h_k$：\n$h_1 = \\sum_{i=1}^{N} \\frac{r_i}{\\tau_i}$\n$h_2 = -\\sum_{i=1}^{N} \\frac{r_i}{\\tau_i^2}$\n所以，$Z_{th}(s) = \\frac{h_1}{s} + \\frac{h_2}{s^2} + O(s^{-3})$。\n现在我们计算 $C_0$：\n$$C_0 = \\lim_{s\\to\\infty} \\frac{1}{s\\left(\\frac{h_1}{s} + \\frac{h_2}{s^2} + \\dots\\right)} = \\lim_{s\\to\\infty} \\frac{1}{h_1 + \\frac{h_2}{s} + \\dots} = \\frac{1}{h_1}$$\n$$C_0 = \\frac{1}{\\sum_{i=1}^{N} \\frac{r_i}{\\tau_i}}$$\n提取 $C_0$ 后的剩余导纳是 $Y_1(s) = Y(s) - sC_0$。下一个元件是一个串联电阻 $R_1$，它是阻抗 $Z_1(s) = 1/Y_1(s)$ 的高频极限。\n$$R_1 = \\lim_{s\\to\\infty} Z_1(s) = \\lim_{s\\to\\infty} \\frac{1}{Y(s) - sC_0}$$\n为了求这个极限，我们对 $Y(s)$ 在 $s$ 很大时进行展开：\n$$Y(s) = \\frac{1}{\\frac{h_1}{s} + \\frac{h_2}{s^2} + O(s^{-3})} = \\frac{s}{h_1} \\left(1 + \\frac{h_2}{h_1 s} + O(s^{-2})\\right)^{-1}$$\n使用二项式近似 $(1+x)^{-1} \\approx 1-x$：\n$$Y(s) \\approx \\frac{s}{h_1}\\left(1 - \\frac{h_2}{h_1 s}\\right) = \\frac{s}{h_1} - \\frac{h_2}{h_1^2}$$\n剩余导纳为 $Y_1(s) \\approx \\left(\\frac{s}{h_1} - \\frac{h_2}{h_1^2}\\right) - s C_0 = \\left(\\frac{s}{h_1} - \\frac{h_2}{h_1^2}\\right) - \\frac{s}{h_1} = -\\frac{h_2}{h_1^2}$。\n因此，下一个串联电阻是：\n$$R_1 = \\frac{1}{\\lim_{s\\to\\infty} Y_1(s)} = \\frac{1}{-h_2/h_1^2} = -\\frac{h_1^2}{h_2} = \\frac{\\left(\\sum_i r_i/\\tau_i\\right)^2}{\\sum_i r_i/\\tau_i^2}$$\n我们使用基于矩的论证来证明这些元件的正性。矩 $h_k$ 与冲激响应 $z(t) = \\mathcal{L}^{-1}\\{Z_{th}(s)\\}$ 相关。\n$$z(t) = \\sum_{i=1}^{N} \\frac{r_i}{\\tau_i} \\exp(-t/\\tau_i)$$\n$1/s$ 展开的系数是 $z(t)$ 在 $t=0$ 处的导数：$h_1 = z(0)$，$h_2 = z'(0)$ 等。\n$$h_1 = z(0) = \\sum_{i=1}^{N} \\frac{r_i}{\\tau_i}$$\n由于 $r_i > 0$ 且 $\\tau_i > 0$，每一项都是正的，所以 $h_1 > 0$。因此，$C_0 = 1/h_1 > 0$。\n$$h_2 = z'(0) = \\left[-\\sum_{i=1}^{N} \\frac{r_i}{\\tau_i^2} \\exp(-t/\\tau_i)\\right]_{t=0} = -\\sum_{i=1}^{N} \\frac{r_i}{\\tau_i^2}$$\n由于 $r_i > 0$ 且 $\\tau_i > 0$，所以这个和是正的，且 $h_2  0$。\n因此，$R_1 = -h_1^2/h_2$ 必定是正的，因为 $h_1^2 > 0$ 且 $h_2  0$。\n所有后续Cauer元件的正性由关于矩的汉克尔行列式不等式保证，对于这类函数，这可以从柯西-施瓦茨不等式中确立。例如，下一个电容 $C_2$ 的正性依赖于矩不等式 $h_1h_3 > h_2^2$，这是柯西-施瓦茨不等式的直接推论。\n\n最后，我们计算给定 $N=3$ 的三阶 Foster 模型的 $C_0$ 的数值：\n$r_1 = 0.8 \\;\\mathrm{K/W}, \\quad \\tau_1 = 0.04 \\;\\mathrm{s}$\n$r_2 = 0.5 \\;\\mathrm{K/W}, \\quad \\tau_2 = 0.01 \\;\\mathrm{s}$\n$r_3 = 0.2 \\;\\mathrm{K/W}, \\quad \\tau_3 = 0.002 \\;\\mathrm{s}$\n\n我们计算 $h_1$ 的求和项：\n$$\\frac{r_1}{\\tau_1} = \\frac{0.8}{0.04} = 20 \\;\\mathrm{W/K}$$\n$$\\frac{r_2}{\\tau_2} = \\frac{0.5}{0.01} = 50 \\;\\mathrm{W/K}$$\n$$\\frac{r_3}{\\tau_3} = \\frac{0.2}{0.002} = 100 \\;\\mathrm{W/K}$$\n矩 $h_1$ 是这些值的和：\n$$h_1 = \\sum_{i=1}^{3} \\frac{r_i}{\\tau_i} = 20 + 50 + 100 = 170 \\;\\mathrm{W/K}$$\nCauer-II型梯形网络的第一个并联热容 $C_0$ 是 $h_1$ 的倒数：\n$$C_0 = \\frac{1}{h_1} = \\frac{1}{170} \\;\\mathrm{J/K}$$\n根据要求，该值为精确值。",
            "answer": "$$\\boxed{\\frac{1}{170}}$$"
        },
        {
            "introduction": "这项综合性练习将热模型概念应用于一个真实的工程问题。您将通过编程实现一个电热协同仿真，以预测并联器件中由热反馈引起的电流不均衡问题——这是电力电子设计中一个关键的可靠性问题。此练习展示了如何利用稳态热模型来分析和解决复杂的系统级行为。",
            "id": "3840370",
            "problem": "一组 $N$ 个金属氧化物半导体场效应晶体管（MOSFET）以电气并联的方式连接，并安装在一个共同的散热结构上，该结构会产生自身和相互之间的热耦合。每个 MOSFET 在共用的漏源电压下导通，电流根据瞬时导通电阻进行分配。第 $i$ 个 MOSFET 的导通电阻被建模为其结温的线性函数，$R_{\\mathrm{ds},i}(T_i) = R_{0,i} \\big( 1 + \\alpha_i (T_i - T_{\\mathrm{ref}}) \\big)$，其中 $R_{0,i}$ 是在参考温度 $T_{\\mathrm{ref}}$ 下的导通电阻，$\\alpha_i$ 是温度系数。结温由耗散功率驱动的热网络决定。该热网络采用广泛使用的 Foster 和 Cauer 热模型方法来表示。\n\n基本原理：\n- 固体中的热扩散可以通过一个等效电路网络来近似：温度映射为电压，热流映射为电流，热阻映射为电阻，热容映射为电容。在稳态（时不变操作）下，热容表现为开路，只有热阻对温升有贡献。\n- Foster 表示法将热阻抗表示为并联电阻-电容支路之和。在稳态下，每个电容实际上都变成开路，热阻抗简化为电阻部分之和，从而得到从结到环境的直流（DC）热阻。\n- Cauer 表示法通过一个串联电阻和并联电容的梯形网络实现相同的热阻抗；在稳态下，电容再次开路，留下一个串联的电阻链，其总和等于直流热阻。Foster 和 Cauer 表示法产生相同的稳态热阻。\n- 对于具有热耦合的多个热源，一个热阻矩阵 $Z \\in \\mathbb{R}^{N \\times N}$ 将结温升高向量 $\\Delta T$ 与耗散功率向量 $P$ 关联起来：$\\Delta T = Z P$。对角线元素 $Z_{ii}$ 代表每个器件到环境的自身热阻，非对角线元素 $Z_{ij}$ 代表通过公共结构的相互热阻。在物理可实现的条件下，稳态下的 $Z$ 是对称且正定的。\n\n目标：\n从电气并联和稳态热网络出发，推导确定由于热反馈导致的 $N$ 个 MOSFET 之间稳态电流分配的不动点方程。使用这些方程，实现一个算法来计算稳态电流并量化不平衡度。将不平衡度指标定义为最大 MOSFET 电流与最小 MOSFET 电流之比，即 $I_{\\max}/I_{\\min}$。\n\n假设和定义：\n- 所有 MOSFET 共享相同的漏源电压，并在欧姆区导通；在固定总电流 $I_{\\mathrm{tot}}$ 下，它们的电流根据电导 $G_i(T_i) = 1 / R_{\\mathrm{ds},i}(T_i)$ 进行分配。\n- 第 $i$ 个 MOSFET 在稳态下耗散的功率为 $P_i = I_i^2 R_{\\mathrm{ds},i}(T_i)$。\n- 结温满足 $T_i = T_{\\mathrm{amb}} + \\sum_{j=1}^N Z_{ij} P_j$，其中 $T_{\\mathrm{amb}}$ 是环境温度。\n- 每个器件自身热阻抗的 Foster 参数以电阻值列表（单位为开尔文/瓦）的形式提供，对应于 Foster 支路的电阻元件；稳态自身热阻是这些值的总和。相互热阻直接以稳态值（单位为开尔文/瓦）的形式提供。\n- 所有温度以摄氏度表示，所有电阻以欧姆表示，所有热阻以开尔文/瓦表示，所有电流以安培表示，所有功率以瓦特表示。不平衡比率 $I_{\\max}/I_{\\min}$ 是无量纲的。\n\n你的程序必须根据提供的 Foster 自身电阻列表和相互耦合值来构建稳态热阻矩阵 $Z$，然后使用基于基本原理推导出的迭代方法求解稳态电流。为保证数值稳定性，你可以在不动点迭代中使用松弛法，但必须通过基于范数的温度更新准则来检测收敛。\n\n测试套件：\n为以下五个参数集计算不平衡比率 $I_{\\max}/I_{\\min}$。每个集合指定了 $N$、环境温度 $T_{\\mathrm{amb}}$、参考温度 $T_{\\mathrm{ref}}$、总电流 $I_{\\mathrm{tot}}$、每个器件的电气参数 $\\{R_{0,i}, \\alpha_i\\}$、Foster 自身热阻列表以及 $i \\neq j$ 时的对称相互热阻 $Z_{ij}$。\n\n- 案例 A（基准对称，中等耦合）：\n    - $N = 2$\n    - $T_{\\mathrm{amb}} = 25\\,^\\circ\\mathrm{C}$，$T_{\\mathrm{ref}} = 25\\,^\\circ\\mathrm{C}$\n    - $I_{\\mathrm{tot}} = 100\\,\\mathrm{A}$\n    - $R_{0,1} = 5\\times 10^{-3}\\,\\Omega$，$\\alpha_1 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$；$R_{0,2} = 5\\times 10^{-3}\\,\\Omega$，$\\alpha_2 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$\n    - Foster 自身电阻：器件 1：$\\{0.5, 0.7\\}\\,\\mathrm{K/W}$；器件 2：$\\{0.5, 0.7\\}\\,\\mathrm{K/W}$\n    - 相互热阻：$Z_{12} = Z_{21} = 0.2\\,\\mathrm{K/W}$\n- 案例 B（电气失配，强耦合）：\n    - $N = 2$\n    - $T_{\\mathrm{amb}} = 25\\,^\\circ\\mathrm{C}$，$T_{\\mathrm{ref}} = 25\\,^\\circ\\mathrm{C}$\n    - $I_{\\mathrm{tot}} = 100\\,\\mathrm{A}$\n    - $R_{0,1} = 5\\times 10^{-3}\\,\\Omega$，$\\alpha_1 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$；$R_{0,2} = 6\\times 10^{-3}\\,\\Omega$，$\\alpha_2 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$\n    - Foster 自身电阻：器件 1：$\\{0.4, 0.6\\}\\,\\mathrm{K/W}$；器件 2：$\\{0.5, 0.5\\}\\,\\mathrm{K/W}$\n    - 相互热阻：$Z_{12} = Z_{21} = 0.4\\,\\mathrm{K/W}$\n- 案例 C（三个器件，非对称相互耦合和电气失配）：\n    - $N = 3$\n    - $T_{\\mathrm{amb}} = 25\\,^\\circ\\mathrm{C}$，$T_{\\mathrm{ref}} = 25\\,^\\circ\\mathrm{C}$\n    - $I_{\\mathrm{tot}} = 180\\,\\mathrm{A}$\n    - $R_{0,1} = 4.5\\times 10^{-3}\\,\\Omega$，$\\alpha_1 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$；$R_{0,2} = 5.0\\times 10^{-3}\\,\\Omega$，$\\alpha_2 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$；$R_{0,3} = 5.5\\times 10^{-3}\\,\\Omega$，$\\alpha_3 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$\n    - Foster 自身电阻：器件 1：$\\{0.6, 0.9\\}\\,\\mathrm{K/W}$；器件 2：$\\{0.6, 0.9\\}\\,\\mathrm{K/W}$；器件 3：$\\{0.6, 0.9\\}\\,\\mathrm{K/W}$\n    - 相互热阻：$Z_{12} = Z_{21} = 0.6\\,\\mathrm{K/W}$；$Z_{13} = Z_{31} = 0.1\\,\\mathrm{K/W}$；$Z_{23} = Z_{32} = 0.1\\,\\mathrm{K/W}$\n- 案例 D（无相互耦合，相同器件）：\n    - $N = 2$\n    - $T_{\\mathrm{amb}} = 25\\,^\\circ\\mathrm{C}$，$T_{\\mathrm{ref}} = 25\\,^\\circ\\mathrm{C}$\n    - $I_{\\mathrm{tot}} = 100\\,\\mathrm{A}$\n    - $R_{0,1} = 5\\times 10^{-3}\\,\\Omega$，$\\alpha_1 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$；$R_{0,2} = 5\\times 10^{-3}\\,\\Omega$，$\\alpha_2 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$\n    - Foster 自身电阻：器件 1：$\\{0.6, 0.6\\}\\,\\mathrm{K/W}$；器件 2：$\\{0.6, 0.6\\}\\,\\mathrm{K/W}$\n    - 相互热阻：$Z_{12} = Z_{21} = 0.0\\,\\mathrm{K/W}$\n- 案例 E（单个器件健全性检查）：\n    - $N = 1$\n    - $T_{\\mathrm{amb}} = 25\\,^\\circ\\mathrm{C}$，$T_{\\mathrm{ref}} = 25\\,^\\circ\\mathrm{C}$\n    - $I_{\\mathrm{tot}} = 80\\,\\mathrm{A}$\n    - $R_{0,1} = 5.0\\times 10^{-3}\\,\\Omega$，$\\alpha_1 = 4\\times 10^{-3}\\,\\mathrm{K}^{-1}$\n    - Foster 自身电阻：器件 1：$\\{1.0, 0.5\\}\\,\\mathrm{K/W}$\n    - 无相互耦合\n\n程序规范：\n- 通过将 $Z_{ii}$ 设置为器件 $i$ 的 Foster 自身电阻之和，并将 $Z_{ij}$ 设置为 $i \\neq j$ 时提供的相互热阻值，来构建 $Z$。\n- 使用与基本原理和定义一致的、有原则的迭代算法求解稳态电流 $I_i$。当温度更新的无穷范数小于 $10^{-9}\\,\\mathrm{K}$ 或达到最大迭代次数 $10^4$ 次后，应宣布收敛。你可以使用一个在 $(0,1]$ 区间内的松弛因子。\n- 对于每个案例，将不平衡比率 $I_{\\max}/I_{\\min}$ 作为浮点数输出，小数点后精确到六位。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$\\big[$result1,result2,result3,result4,result5$\\big]$）。这五个条目必须分别对应案例 A 到 E，每个都打印到小数点后六位。",
            "solution": "评估认定该问题有效。分析和解决方案如下。\n\n### I. 问题验证\n\n**步骤1：提取已知条件**\n- **MOSFET 数量**：$N$\n- **导通电阻模型**：第 $i$ 个 MOSFET 的 $R_{\\mathrm{ds},i}(T_i) = R_{0,i} \\big( 1 + \\alpha_i (T_i - T_{\\mathrm{ref}}) \\big)$。\n- **电气连接**：$N$ 个 MOSFET 并联，总电流为 $I_{\\mathrm{tot}}$。\n- **电流分配**：电流 $I_i$ 根据电导 $G_i(T_i) = 1 / R_{\\mathrm{ds},i}(T_i)$ 进行分配。\n- **功耗**：$P_i = I_i^2 R_{\\mathrm{ds},i}(T_i)$。\n- **结温模型**：$T_i = T_{\\mathrm{amb}} + \\sum_{j=1}^N Z_{ij} P_j$，其中 $\\Delta T_i = T_i - T_{\\mathrm{amb}} = \\sum_{j=1}^N Z_{ij} P_j$。\n- **热阻矩阵 $Z$**：一个在 $\\mathbb{R}^{N \\times N}$ 中的对称正定矩阵。\n- **$Z$ 的构建**：\n    - 对角线元素 $Z_{ii}$ 是器件 $i$ 的 Foster 自身热阻模型的电阻值之和。\n    - 非对角线元素 $Z_{ij}$（$i \\neq j$）直接以稳态相互热阻的形式提供。\n- **目标**：计算稳态电流不平衡比率 $I_{\\max}/I_{\\min}$。\n- **数值参数**：\n    - 收敛准则：温度向量更新的无穷范数  $10^{-9}\\,\\mathrm{K}$。\n    - 最大迭代次数：$10^4$。\n    - 松弛因子：$\\omega \\in (0, 1]$。\n- **单位**：温度单位为摄氏度（$^\\circ\\mathrm{C}$），电阻单位为欧姆（$\\Omega$），热阻单位为开尔文/瓦（K/W），电流单位为安培（A），功率单位为瓦特（W）。\n- **测试案例**：提供了五个不同的参数集（A、B、C、D、E），包含所有必需参数的具体值。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于电路（欧姆定律、分流）和电力电子系统中热传递的基本原理。导通电阻的线性模型和热阻矩阵（$Z$参数）方法是分析电力半导体中电热行为的标准且被广泛接受的工程近似。Foster和Cauer模型在稳态下等效是正确的陈述。该问题具有科学合理性。\n- **良态**：该问题在数学上是明确定义的。它描述了一个耦合非线性方程组，需要求解其稳态解。正温度系数（$\\alpha_i  0$）通常确保了一个稳定的负反馈机制，从而得到一个唯一且稳定的不动点。为五个测试案例提供了所有必要的数据和边界条件，并且目标明确。\n- **目标**：问题陈述使用精确、正式且不带偏见的语言，没有主观论断。\n- **完整性和一致性**：问题陈述是自包含的。对于每个案例，它提供了所有必需的数值和模型参数。使用摄氏度表示温度和开尔文/瓦表示热阻是一致的，因为温差在这两种尺度下具有相同的数值（$\\Delta T\\,[\\mathrm{K}] = \\Delta T\\,[^\\circ\\mathrm{C}]$）。所提供的参数在物理上是合理的。\n- **无其他缺陷**：该问题不是隐喻性的，与所述主题直接相关，不包含矛盾，提出的任务是可行的，不是病态或琐碎的，并且是科学上可验证的。\n\n**步骤3：结论和行动**\n该问题有效。将提供完整的解决方案。\n\n### II. 电热不动点方程的推导\n\n并联MOSFET的稳态行为由一组耦合的电热方程控制。目标是找到一个平衡点，在该点上，结温、导通电阻、电流和耗散功率都是自洽的。不动点迭代法是解决此类系统的自然方法。我们选择对结温向量 $T = [T_1, T_2, \\ldots, T_N]^T$ 进行迭代。\n\n设 $T^{(k)}$ 是第 $k$ 次迭代时的结温向量。计算下一次迭代的温度向量 $T^{(k+1)}$ 的过程如下：\n\n1.  **计算导通电阻**：根据温度向量 $T^{(k)}$，使用给定的线性模型更新每个 MOSFET 的导通电阻 $R_{\\mathrm{ds},i}^{(k)}$：\n    $$R_{\\mathrm{ds},i}^{(k)} = R_{0,i} \\left( 1 + \\alpha_i (T_i^{(k)} - T_{\\mathrm{ref}}) \\right)$$\n\n2.  **计算共用电压**：MOSFET 并联连接，因此它们共享一个共同的漏源电压 $V_{\\mathrm{ds}}$。总电流 $I_{\\mathrm{tot}}$ 是各个电流之和，$I_{\\mathrm{tot}} = \\sum_{j=1}^N I_j$。并联结构的总电导为 $G_{\\mathrm{tot}}^{(k)} = \\sum_{j=1}^N G_j^{(k)} = \\sum_{j=1}^N \\frac{1}{R_{\\mathrm{ds},j}^{(k)}}$。因此，共用电压为：\n    $$V_{\\mathrm{ds}}^{(k)} = \\frac{I_{\\mathrm{tot}}}{G_{\\mathrm{tot}}^{(k)}} = \\frac{I_{\\mathrm{tot}}}{\\sum_{j=1}^N \\frac{1}{R_{\\mathrm{ds},j}^{(k)}}}$$\n\n3.  **计算功耗**：每个 MOSFET 耗散的功率 $P_i^{(k)}$ 可以通过共用电压及其各自的电阻计算得出：\n    $$P_i^{(k)} = \\frac{(V_{\\mathrm{ds}}^{(k)})^2}{R_{\\mathrm{ds},i}^{(k)}}$$\n    耗散功率向量为 $P^{(k)} = [P_1^{(k)}, P_2^{(k)}, \\ldots, P_N^{(k)}]^T$。\n\n4.  **更新结温**：使用热网络方程计算新的结温。设 $T^{(k+1, \\text{raw})}$ 为未松弛的温度更新值：\n    $$T^{(k+1, \\text{raw})} = T_{\\mathrm{amb}} \\mathbf{1} + Z P^{(k)}$$\n    其中 $\\mathbf{1}$ 是一个大小为 $N$ 的全一向量，$Z$ 是稳态热阻矩阵。\n\n5.  **应用松弛法**：为了提高迭代的稳定性和收敛性，引入一个松弛步骤。更新后的温度向量 $T^{(k+1)}$ 是前一个温度 $T^{(k)}$ 和新的原始计算值 $T^{(k+1, \\text{raw})}$ 的加权平均：\n    $$T^{(k+1)} = (1 - \\omega) T^{(k)} + \\omega T^{(k+1, \\text{raw})}$$\n    其中 $\\omega \\in (0, 1]$ 是松弛因子。\n\n迭代从一个初始猜测开始，通常是 $T^{(0)} = T_{\\mathrm{amb}} \\mathbf{1}$，并持续进行，直到温度向量的变化可以忽略不计，即当 $\\|T^{(k+1)} - T^{(k)}\\|_{\\infty}  \\epsilon$ 时（$\\epsilon$ 是一个很小的容差）。\n\n### III. 算法实现\n\n该解决方案实现为一个 Python 程序，遵循推导出的不动点迭代法。\n\n**1. 构建热阻矩阵 $Z$**\n首先构建矩阵 $Z \\in \\mathbb{R}^{N \\times N}$。\n- 对于对角线元素 $Z_{ii}$，将器件 $i$ 的 Foster 自身电阻列表中的值相加。这个总和代表了从器件 $i$ 的结到环境的总直流热阻。\n  $$Z_{ii} = \\sum_{r \\in \\text{FosterResistors}_i} r$$\n- 对于非对角线元素 $Z_{ij}$（其中 $i \\neq j$），使用提供的相互热阻值。由于矩阵是对称的，$Z_{ij} = Z_{ji}$。\n\n**2. 稳态温度的迭代解**\n算法流程如下：\n- 初始化温度向量：$T \\leftarrow T_{\\mathrm{amb}} \\mathbf{1}$。\n- 设置迭代参数：最大迭代次数 $k_{\\max} = 10^4$，收敛容差 $\\epsilon = 10^{-9}\\,\\mathrm{K}$，松弛因子 $\\omega$。为保证稳健收敛，选择 $\\omega = 0.25$。\n- 从 $k=0$ 到 $k_{\\max}-1$ 进行循环：\n    a. 根据当前温度 $T$ 计算所有 $i=1, \\ldots, N$ 的 $R_{\\mathrm{ds},i}$。\n    b. 根据 $I_{\\mathrm{tot}}$ 和电导之和 $1/R_{\\mathrm{ds},i}$ 计算 $V_{\\mathrm{ds}}$。\n    c. 计算功率 $P_i = V_{\\mathrm{ds}}^2 / R_{\\mathrm{ds},i}$。\n    d. 计算原始温度更新值 $T_{\\text{new\\_raw}} = T_{\\mathrm{amb}} \\mathbf{1} + Z P$。\n    e. 应用松弛法：$T_{\\text{new}} = (1-\\omega)T + \\omega T_{\\text{new\\_raw}}$。\n    f. 检查收敛性：如果 $\\max_i |T_{\\text{new},i} - T_i|  \\epsilon$，则退出循环。\n    g. 更新温度以进行下一次迭代：$T \\leftarrow T_{\\text{new}}$。\n\n**3. 最终量的计算**\n- 一旦迭代收敛到稳态温度向量 $T_{\\mathrm{ss}}$，就可以计算出最终的、自洽的电阻、电压和电流值。\n- 稳态电阻为 $R_{\\mathrm{ds},i}(T_{\\mathrm{ss},i})$。\n- 稳态电压为 $V_{\\mathrm{ds,ss}} = I_{\\mathrm{tot}} / \\sum_j (1/R_{\\mathrm{ds},j}(T_{\\mathrm{ss},j}))$。\n- 稳态电流为 $I_i = V_{\\mathrm{ds,ss}} / R_{\\mathrm{ds},i}(T_{\\mathrm{ss},i})$。\n- 最后，计算电流不平衡比率：\n  $$\\text{Imbalance} = \\frac{\\max(I_1, I_2, \\ldots, I_N)}{\\min(I_1, I_2, \\ldots, I_N)}$$\n对提供的五个测试案例中的每一个都应用此过程。对于 $N=1$ 的特殊情况，电流就是 $I_1 = I_{\\mathrm{tot}}$，不平衡比率显然为1。对于对称情况（案例A和D），不平衡度也应为1。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for the current imbalance in parallel MOSFETs\n    for a series of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case A: baseline symmetry with moderate coupling\n        {\n            \"N\": 2, \"Tamb\": 25.0, \"Tref\": 25.0, \"Itot\": 100.0,\n            \"R0_list\": [5e-3, 5e-3], \"alpha_list\": [4e-3, 4e-3],\n            \"foster_resistors_list\": [[0.5, 0.7], [0.5, 0.7]],\n            \"mutual_resistances_dict\": {(1, 2): 0.2}\n        },\n        # Case B: electrical mismatch with stronger coupling\n        {\n            \"N\": 2, \"Tamb\": 25.0, \"Tref\": 25.0, \"Itot\": 100.0,\n            \"R0_list\": [5e-3, 6e-3], \"alpha_list\": [4e-3, 4e-3],\n            \"foster_resistors_list\": [[0.4, 0.6], [0.5, 0.5]],\n            \"mutual_resistances_dict\": {(1, 2): 0.4}\n        },\n        # Case C: three devices with asymmetric mutual couplings and electrical mismatch\n        {\n            \"N\": 3, \"Tamb\": 25.0, \"Tref\": 25.0, \"Itot\": 180.0,\n            \"R0_list\": [4.5e-3, 5.0e-3, 5.5e-3],\n            \"alpha_list\": [4e-3, 4e-3, 4e-3],\n            \"foster_resistors_list\": [[0.6, 0.9], [0.6, 0.9], [0.6, 0.9]],\n            \"mutual_resistances_dict\": {(1, 2): 0.6, (1, 3): 0.1, (2, 3): 0.1}\n        },\n        # Case D: no mutual coupling, identical devices\n        {\n            \"N\": 2, \"Tamb\": 25.0, \"Tref\": 25.0, \"Itot\": 100.0,\n            \"R0_list\": [5e-3, 5e-3], \"alpha_list\": [4e-3, 4e-3],\n            \"foster_resistors_list\": [[0.6, 0.6], [0.6, 0.6]],\n            \"mutual_resistances_dict\": {(1, 2): 0.0}\n        },\n        # Case E: single device sanity check\n        {\n            \"N\": 1, \"Tamb\": 25.0, \"Tref\": 25.0, \"Itot\": 80.0,\n            \"R0_list\": [5.0e-3], \"alpha_list\": [4e-3],\n            \"foster_resistors_list\": [[1.0, 0.5]],\n            \"mutual_resistances_dict\": {}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _solve_case(**case)\n        results.append(result)\n\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\ndef _solve_case(N, Tamb, Tref, Itot, R0_list, alpha_list, foster_resistors_list, mutual_resistances_dict):\n    \"\"\"\n    Solves a single electro-thermal case using a fixed-point iteration method.\n    \"\"\"\n    if N == 0:\n        return 1.0\n    if N == 1:\n        return 1.0\n\n    # 1. Build the steady-state thermal resistance matrix Z\n    Z = np.zeros((N, N))\n    for i in range(N):\n        Z[i, i] = sum(foster_resistors_list[i])\n    for (i, j), val in mutual_resistances_dict.items():\n        # Convert 1-based device indices to 0-based array indices\n        Z[i - 1, j - 1] = val\n        Z[j - 1, i - 1] = val\n\n    # 2. Convert electrical parameter lists to numpy arrays for vectorized operations\n    R0 = np.array(R0_list)\n    alpha = np.array(alpha_list)\n\n    # 3. Fixed-point iteration to find steady-state temperatures\n    max_iter = 10000\n    tol = 1e-9\n    omega = 0.25  # Relaxation factor for stability\n\n    # Initial guess for temperatures\n    T = np.full(N, Tamb)\n\n    for _ in range(max_iter):\n        # Calculate on-resistances based on current temperatures\n        Rds = R0 * (1.0 + alpha * (T - Tref))\n\n        # Calculate total conductance and shared drain-source voltage\n        G_tot = np.sum(1.0 / Rds)\n        Vds = Itot / G_tot\n\n        # Calculate power dissipation in each device\n        P = Vds**2 / Rds\n        \n        # Calculate new temperatures using the thermal network equation\n        T_new_raw = Tamb + Z @ P\n        \n        # Apply relaxation\n        T_new = (1.0 - omega) * T + omega * T_new_raw\n\n        # Check for convergence using infinity norm\n        if np.linalg.norm(T_new - T, ord=np.inf)  tol:\n            T = T_new\n            break\n        \n        T = T_new\n    \n    # 4. Calculate final currents and the imbalance ratio\n    # Recompute state variables with the converged temperature\n    Rds_final = R0 * (1.0 + alpha * (T - Tref))\n    G_tot_final = np.sum(1.0 / Rds_final)\n    Vds_final = Itot / G_tot_final\n    I_final = Vds_final / Rds_final\n\n    imbalance = np.max(I_final) / np.min(I_final)\n    \n    return imbalance\n\nsolve()\n```"
        }
    ]
}