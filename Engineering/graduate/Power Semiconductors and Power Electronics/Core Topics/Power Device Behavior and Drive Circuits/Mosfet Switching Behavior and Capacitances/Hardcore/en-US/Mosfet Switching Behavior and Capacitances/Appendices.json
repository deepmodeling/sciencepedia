{
    "hands_on_practices": [
        {
            "introduction": "Understanding the Miller plateau is fundamental to analyzing MOSFET switching speed. This practice exercise guides you to derive the duration of this plateau from the first principles of charge and current. By connecting the constant gate current ($I_g$) to the charge required to transition the drain voltage ($Q_{gd}$), you will develop a foundational model for predicting a key part of the turn-on time and appreciate the impact of the gate-drain capacitance. ",
            "id": "3860826",
            "problem": "A power Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET) is turned on by a current-mode gate driver that delivers a constant gate current during the so-called Miller plateau. During this plateau, the drain-to-source voltage transitions from a higher value to a lower value while the gate-to-drain capacitance is charged. The datasheet specifies a gate-drain charge associated with this drain voltage transition. Assume that the gate driver supplies a strictly constant current during the plateau and that parasitic inductances are negligible.\n\nGiven a constant gate current of $I_{g} = 300\\,\\mathrm{mA}$, a specified gate-drain charge of $Q_{gd} = 30\\,\\mathrm{nC}$ corresponding to a drain-to-source voltage change from $400\\,\\mathrm{V}$ down to $50\\,\\mathrm{V}$, and that the Miller plateau spans exactly this voltage interval, do the following:\n\n1. Starting from the fundamental definitions of electric charge and current, derive an expression for the plateau duration in terms of the charge that must be moved during the plateau and the constant gate current. Do not invoke any specialized or shortcut switching-time formulas; base your reasoning on first principles.\n2. Using your derived expression, compute the numerical value of the plateau duration for the given parameters.\n3. Briefly explain, using the capacitance–voltage relation for the gate-to-drain capacitance $C_{gd}(V)$ and the integral definition of charge, how the nonlinearity of $C_{gd}(V)$ affects the accuracy of estimating the plateau duration by using a single specified $Q_{gd}$ value.\n\nExpress the final time in nanoseconds and round your numerical result to four significant figures. Your final answer must be a single number.",
            "solution": "The problem asks for the derivation of an expression for the Miller plateau duration, a numerical calculation of this duration, and an explanation of the role of the nonlinearity of the gate-to-drain capacitance. The process begins with a validation of the problem statement.\n\n### Step 1: Extract Givens\n- Constant gate current during the Miller plateau: $I_{g} = 300\\,\\mathrm{mA}$\n- Gate-drain charge for the specified voltage transition: $Q_{gd} = 30\\,\\mathrm{nC}$\n- Drain-to-source voltage change during the plateau: from $400\\,\\mathrm{V}$ down to $50\\,\\mathrm{V}$\n- The Miller plateau is defined to span exactly this voltage interval.\n- The gate driver supplies a strictly constant current.\n- Parasitic inductances are negligible.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it deals with the Miller effect in a power MOSFET, a fundamental topic in power electronics. The underlying principles relate electric current, charge, and time, which are cornerstones of physics. The provided values for current, charge, and voltage are realistic for a modern power semiconductor device. The problem is well-posed, providing all necessary information for the calculation. The assumptions, such as a constant gate current and negligible inductance, are standard idealizations used in first-order switching analysis, making the problem tractable and focused on the core concept. The problem statement is objective and uses precise technical terminology. There are no contradictions, missing data, or scientifically unsound premises.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n---\n\n### Solution\n\nThe solution is presented in three parts as requested by the problem statement.\n\n#### 1. Derivation of the Plateau Duration Expression\n\nThe fundamental definition of electric current, $I$, is the rate of flow of electric charge, $Q$, with respect to time, $t$. Mathematically, this is expressed as:\n$$I = \\frac{dQ}{dt}$$\nThe problem states that the gate driver supplies a strictly constant gate current, $I_g$, during the Miller plateau. When the current is constant over a time interval $\\Delta t = t_p$, where $t_p$ is the duration of the plateau, the differential relationship can be integrated to yield a simpler algebraic form. Let $\\Delta Q$ be the total charge that flows during this interval.\n$$\\int_{0}^{\\Delta Q} dQ = \\int_{0}^{t_p} I_g dt$$\nSince $I_g$ is constant, it can be taken out of the integral:\n$$\\Delta Q = I_g \\int_{0}^{t_p} dt = I_g \\cdot t_p$$\nDuring the Miller plateau phase of MOSFET turn-on, the gate-to-source voltage, $V_{gs}$, remains constant at the plateau voltage, $V_{pl}$. Consequently, the current flowing into the gate-to-source capacitance, $C_{gs}$, is zero, as $I_{gs} = C_{gs} \\frac{dV_{gs}}{dt} = 0$. Therefore, the entire constant gate current $I_g$ is directed to charging the gate-to-drain capacitance, $C_{gd}$.\n\nThe problem specifies the gate-drain charge, $Q_{gd}$, as the total charge required to be supplied to the gate terminal to cause the drain-to-source voltage to transition across its specified range. This charge, $Q_{gd}$, is precisely the total charge, $\\Delta Q$, that must be supplied by the gate driver during the plateau.\nTherefore, we set $\\Delta Q = Q_{gd}$. Substituting this into our derived equation gives:\n$$Q_{gd} = I_g \\cdot t_p$$\nSolving for the plateau duration, $t_p$, yields the desired expression derived from first principles:\n$$t_p = \\frac{Q_{gd}}{I_g}$$\n\n#### 2. Numerical Calculation of Plateau Duration\n\nThe problem provides the following values:\n- Gate-drain charge: $Q_{gd} = 30\\,\\mathrm{nC} = 30 \\times 10^{-9}\\,\\mathrm{C}$\n- Constant gate current: $I_{g} = 300\\,\\mathrm{mA} = 300 \\times 10^{-3}\\,\\mathrm{A} = 0.3\\,\\mathrm{A}$\n\nSubstituting these values into the derived expression for $t_p$:\n$$t_p = \\frac{30 \\times 10^{-9}\\,\\mathrm{C}}{0.3\\,\\mathrm{A}}$$\n$$t_p = \\frac{30}{0.3} \\times 10^{-9}\\,\\mathrm{s} = 100 \\times 10^{-9}\\,\\mathrm{s}$$\nThe problem requires the final answer to be expressed in nanoseconds. Since $1\\,\\mathrm{ns} = 10^{-9}\\,\\mathrm{s}$, the duration is:\n$$t_p = 100\\,\\mathrm{ns}$$\nRounding to four significant figures as requested, the result is $100.0\\,\\mathrm{ns}$.\n\n#### 3. Effect of Non-linear Capacitance $C_{gd}(V)$\n\nThe gate-to-drain capacitance of a MOSFET, $C_{gd}$, is not a constant value; it is highly dependent on the voltage across it, $V_{gd}$. This voltage is given by $V_{gd} = V_g - V_d \\approx V_{gs} - V_{ds}$ (assuming the source is at ground potential). During the Miller plateau, $V_{gs}$ is constant, so $C_{gd}$ becomes a function of the drain-to-source voltage, $C_{gd}(V_{ds})$. Specifically, for a power MOSFET, $C_{gd}$ is large for small values of $V_{ds}$ and decreases significantly as $V_{ds}$ increases.\n\nThe charge $Q$ on a capacitor is fundamentally defined by the integral of its capacitance $C(V)$ over the change in voltage $V$. The gate-drain charge $Q_{gd}$ specified in a datasheet for a voltage swing from $V_{DS,high}$ to $V_{DS,low}$ is the result of this integration:\n$$Q_{gd} = \\int_{V_{DS,low}}^{V_{DS,high}} C_{gd}(V_{ds}) dV_{ds}$$\nA single value of $Q_{gd}$ provided in a datasheet represents the total charge for a specific, predefined voltage transition (in this case, from $400\\,\\mathrm{V}$ to $50\\,\\mathrm{V}$).\n\nThe use of this single $Q_{gd}$ value to calculate the total plateau duration $t_p = Q_{gd}/I_g$ is accurate under the explicit assumption that the constant gate current $I_g$ is used to supply exactly this total amount of charge. The calculation effectively averages the nonlinear effects over the entire interval.\n\nHowever, the nonlinearity of $C_{gd}(V_{ds})$ critically affects the *instantaneous* behavior during the plateau. The rate of change of the drain voltage (slew rate) is given by rearranging the capacitor current equation:\n$$I_g = I_{C_{gd}} = C_{gd}(V_{ds}) \\frac{dV_{gd}}{dt} \\approx -C_{gd}(V_{ds}) \\frac{dV_{ds}}{dt}$$\n$$\\frac{dV_{ds}}{dt} \\approx -\\frac{I_g}{C_{gd}(V_{ds})}$$\nSince $C_{gd}(V_{ds})$ is small at high $V_{ds}$ (beginning of the plateau) and large at low $V_{ds}$ (end of the plateau), the magnitude of the slew rate, $|\\frac{dV_{ds}}{dt}|$, is large at the beginning and small at the end. In other words, the drain voltage falls quickly at first and then slows down as it approaches its final on-state value.\n\nTherefore, the accuracy of estimating the plateau duration using a single $Q_{gd}$ value is contingent upon the application's operating conditions (specifically, the $V_{ds}$ swing) matching the test conditions under which the datasheet specified $Q_{gd}$. If the actual voltage swing in an application differs from the datasheet's test conditions, using the provided $Q_{gd}$ will lead to an inaccurate estimation of $t_p$, because the integral of the nonlinear $C_{gd}(V)$ over a different voltage interval will yield a different total charge. The nonlinearity of the capacitance means that the charge cannot be simply scaled linearly with the voltage swing.",
            "answer": "$$\\boxed{100.0}$$"
        },
        {
            "introduction": "A MOSFET's capacitances are not constant; they vary significantly with voltage, which has profound implications for switching loss. This exercise focuses on the output capacitance, $C_{\\mathrm{oss}}$, and asks you to calculate the total charge and energy stored within it as it charges to a high voltage. By applying integral calculus to a realistic capacitance model, you will gain direct insight into the source of capacitive switching losses, a key performance limiter in hard-switched converters. ",
            "id": "3860874",
            "problem": "A manufacturer reports the nonlinear output capacitance curve of a high-voltage Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET) as a function of drain-to-source voltage $V$ by the empirical law\n$$\nC_{\\mathrm{oss}}(V)=\\frac{C_{0}}{\\left(1+\\frac{V}{V_{0}}\\right)^{1/2}},\n$$\nwith $C_{0}=2\\ \\mathrm{nF}$ and $V_{0}=50\\ \\mathrm{V}$. In a hard-switching application, the output capacitance is charged from $0$ to a bus voltage $V$ each cycle. Starting from the fundamental relations $dQ=C(V)\\,dV$ and $dE=v\\,dQ$ that define charge and electrostatic energy for a voltage-dependent capacitor, derive closed-form expressions for the total stored charge $Q_{\\mathrm{oss}}(V)$ and the stored energy $E_{\\mathrm{oss}}(V)$ when charging from $0$ to $V$. Then evaluate both at $V=400\\ \\mathrm{V}$. Express $Q_{\\mathrm{oss}}(400\\ \\mathrm{V})$ in microcoulombs and $E_{\\mathrm{oss}}(400\\ \\mathrm{V})$ in microjoules, and round both numerical results to four significant figures.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- The voltage-dependent output capacitance is given by the empirical law: $C_{\\mathrm{oss}}(V) = \\frac{C_0}{(1 + \\frac{V}{V_0})^{1/2}}$.\n- The constant parameters are: $C_0 = 2 \\ \\mathrm{nF}$ and $V_0 = 50 \\ \\mathrm{V}$.\n- The charging process occurs from a voltage of $0$ to a final voltage $V$.\n- The fundamental relation between differential charge $dQ$, capacitance $C(V)$, and differential voltage $dV$ is $dQ = C(V) \\, dV$.\n- The fundamental relation between differential electrostatic energy $dE$, voltage $v$, and differential charge $dQ$ is $dE = v \\, dQ$.\n- The task is to derive closed-form expressions for the total stored charge $Q_{\\mathrm{oss}}(V)$ and the stored energy $E_{\\mathrm{oss}}(V)$.\n- The derived expressions are to be evaluated at a bus voltage of $V = 400 \\ \\mathrm{V}$.\n- The final numerical results for $Q_{\\mathrm{oss}}(400 \\ \\mathrm{V})$ and $E_{\\mathrm{oss}}(400 \\ \\mathrm{V})$ must be expressed in microcoulombs ($\\mu$C) and microjoules ($\\mu$J), respectively, and rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is scientifically sound. The provided formula for $C_{\\mathrm{oss}}(V)$ is a standard and physically justified model for the capacitance of a reverse-biased p-n junction, which dominates the output capacitance of a MOSFET. The exponent of $1/2$ corresponds to an abrupt junction model. The fundamental relations for charge and energy in a capacitor are correct. The given component values and voltage levels are realistic for high-voltage power electronics applications.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary information—the functional form of the capacitance and the initial/final conditions for charging—to uniquely determine the stored charge and energy through integration. The requested integrations are well-defined.\n- **Objectivity**: The problem is stated in precise, objective language, free of any subjective or ambiguous terms.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid as it is scientifically grounded, well-posed, and objective. A complete solution will be provided.\n\n### Derivation of Stored Charge $Q_{\\mathrm{oss}}(V)$\nThe total charge $Q_{\\mathrm{oss}}(V)$ stored in the output capacitance when charging from a voltage of $0$ to $V$ is found by integrating the differential charge relation $dQ = C_{\\mathrm{oss}}(v) \\, dv$ over the specified voltage range. We use a dummy variable of integration $v'$ to distinguish it from the upper limit $V$.\n$$ Q_{\\mathrm{oss}}(V) = \\int_{0}^{V} C_{\\mathrm{oss}}(v') \\, dv' $$\nSubstituting the given expression for $C_{\\mathrm{oss}}(v')$:\n$$ Q_{\\mathrm{oss}}(V) = \\int_{0}^{V} \\frac{C_0}{\\left(1 + \\frac{v'}{V_0}\\right)^{1/2}} \\, dv' $$\nTo solve this integral, we perform a substitution. Let $u = 1 + \\frac{v'}{V_0}$. Then, the differential is $du = \\frac{1}{V_0} \\, dv'$, which implies $dv' = V_0 \\, du$. The limits of integration for $u$ are:\n- When $v' = 0$, $u = 1 + \\frac{0}{V_0} = 1$.\n- When $v' = V$, $u = 1 + \\frac{V}{V_0}$.\n\nThe integral transforms to:\n$$ Q_{\\mathrm{oss}}(V) = \\int_{1}^{1+V/V_0} \\frac{C_0}{u^{1/2}} (V_0 \\, du) = C_0 V_0 \\int_{1}^{1+V/V_0} u^{-1/2} \\, du $$\nThe integral of $u^{-1/2}$ is $2u^{1/2}$. Evaluating the definite integral:\n$$ Q_{\\mathrm{oss}}(V) = C_0 V_0 \\left[ 2u^{1/2} \\right]_{1}^{1+V/V_0} = 2C_0 V_0 \\left( \\left(1 + \\frac{V}{V_0}\\right)^{1/2} - 1^{1/2} \\right) $$\nThe closed-form expression for the stored charge is:\n$$ Q_{\\mathrm{oss}}(V) = 2C_0 V_0 \\left( \\sqrt{1 + \\frac{V}{V_0}} - 1 \\right) $$\n\n### Derivation of Stored Energy $E_{\\mathrm{oss}}(V)$\nThe total energy $E_{\\mathrm{oss}}(V)$ stored in the output capacitance is found by integrating the differential energy relation $dE = v \\, dQ$. Using $dQ = C_{\\mathrm{oss}}(v) \\, dv$, we have $dE = v \\, C_{\\mathrm{oss}}(v) \\, dv$. Integrating from $0$ to $V$:\n$$ E_{\\mathrm{oss}}(V) = \\int_{0}^{V} v' \\, C_{\\mathrm{oss}}(v') \\, dv' $$\nSubstituting the expression for $C_{\\mathrm{oss}}(v')$:\n$$ E_{\\mathrm{oss}}(V) = \\int_{0}^{V} v' \\frac{C_0}{\\left(1 + \\frac{v'}{V_0}\\right)^{1/2}} \\, dv' $$\nUsing the same substitution as before, $u = 1 + \\frac{v'}{V_0}$, we have $v' = V_0(u - 1)$ and $dv' = V_0 \\, du$. The limits of integration remain $u=1$ to $u=1+V/V_0$.\n$$ E_{\\mathrm{oss}}(V) = \\int_{1}^{1+V/V_0} V_0(u - 1) \\frac{C_0}{u^{1/2}} (V_0 \\, du) = C_0 V_0^2 \\int_{1}^{1+V/V_0} \\frac{u-1}{u^{1/2}} \\, du $$\nThe integrand can be split into two terms: $\\frac{u-1}{u^{1/2}} = u^{1/2} - u^{-1/2}$.\n$$ E_{\\mathrm{oss}}(V) = C_0 V_0^2 \\int_{1}^{1+V/V_0} (u^{1/2} - u^{-1/2}) \\, du $$\nIntegrating term by term:\n$$ E_{\\mathrm{oss}}(V) = C_0 V_0^2 \\left[ \\frac{u^{3/2}}{3/2} - \\frac{u^{1/2}}{1/2} \\right]_{1}^{1+V/V_0} = C_0 V_0^2 \\left[ \\frac{2}{3}u^{3/2} - 2u^{1/2} \\right]_{1}^{1+V/V_0} $$\nEvaluating at the limits:\n$$ E_{\\mathrm{oss}}(V) = C_0 V_0^2 \\left( \\left[ \\frac{2}{3}\\left(1 + \\frac{V}{V_0}\\right)^{3/2} - 2\\left(1 + \\frac{V}{V_0}\\right)^{1/2} \\right] - \\left[ \\frac{2}{3}(1)^{3/2} - 2(1)^{1/2} \\right] \\right) $$\n$$ E_{\\mathrm{oss}}(V) = C_0 V_0^2 \\left( \\frac{2}{3}\\left(1 + \\frac{V}{V_0}\\right)^{3/2} - 2\\sqrt{1 + \\frac{V}{V_0}} - \\left(\\frac{2}{3} - 2\\right) \\right) $$\nThe closed-form expression for the stored energy is:\n$$ E_{\\mathrm{oss}}(V) = C_0 V_0^2 \\left( \\frac{2}{3}\\left(1 + \\frac{V}{V_0}\\right)^{3/2} - 2\\sqrt{1 + \\frac{V}{V_0}} + \\frac{4}{3} \\right) $$\n\n### Numerical Evaluation\nWe are given $C_0 = 2 \\ \\mathrm{nF} = 2 \\times 10^{-9} \\ \\mathrm{F}$, $V_0 = 50 \\ \\mathrm{V}$, and we evaluate at $V = 400 \\ \\mathrm{V}$.\nFirst, we calculate the dimensionless ratio:\n$$ \\frac{V}{V_0} = \\frac{400 \\ \\mathrm{V}}{50 \\ \\mathrm{V}} = 8 $$\nThen we compute the terms that appear in both expressions:\n$$ 1 + \\frac{V}{V_0} = 1 + 8 = 9 $$\n$$ \\sqrt{1 + \\frac{V}{V_0}} = \\sqrt{9} = 3 $$\n$$ \\left(1 + \\frac{V}{V_0}\\right)^{3/2} = 9^{3/2} = (9^{1/2})^3 = 3^3 = 27 $$\n\n#### Evaluation of $Q_{\\mathrm{oss}}(400 \\ \\mathrm{V})$\n$$ Q_{\\mathrm{oss}}(400 \\ \\mathrm{V}) = 2(2 \\times 10^{-9} \\ \\mathrm{F})(50 \\ \\mathrm{V}) (3 - 1) $$\n$$ Q_{\\mathrm{oss}}(400 \\ \\mathrm{V}) = 2(100 \\times 10^{-9} \\ \\mathrm{C}) (2) = 400 \\times 10^{-9} \\ \\mathrm{C} = 4 \\times 10^{-7} \\ \\mathrm{C} $$\nTo express this in microcoulombs ($1 \\ \\mathrm{\\mu C} = 10^{-6} \\ \\mathrm{C}$):\n$$ Q_{\\mathrm{oss}}(400 \\ \\mathrm{V}) = 0.4 \\times 10^{-6} \\ \\mathrm{C} = 0.4 \\ \\mathrm{\\mu C} $$\nRounding to four significant figures, this is $0.4000 \\ \\mathrm{\\mu C}$.\n\n#### Evaluation of $E_{\\mathrm{oss}}(400 \\ \\mathrm{V})$\n$$ E_{\\mathrm{oss}}(400 \\ \\mathrm{V}) = (2 \\times 10^{-9} \\ \\mathrm{F})(50 \\ \\mathrm{V})^2 \\left( \\frac{2}{3}(27) - 2(3) + \\frac{4}{3} \\right) $$\n$$ E_{\\mathrm{oss}}(400 \\ \\mathrm{V}) = (2 \\times 10^{-9})(2500) \\left( 18 - 6 + \\frac{4}{3} \\right) $$\n$$ E_{\\mathrm{oss}}(400 \\ \\mathrm{V}) = (5000 \\times 10^{-9}) \\left( 12 + \\frac{4}{3} \\right) = (5 \\times 10^{-6}) \\left( \\frac{36+4}{3} \\right) $$\n$$ E_{\\mathrm{oss}}(400 \\ \\mathrm{V}) = 5 \\times 10^{-6} \\left( \\frac{40}{3} \\right) \\ \\mathrm{J} = \\frac{200}{3} \\times 10^{-6} \\ \\mathrm{J} $$\nTo express this in microjoules ($1 \\ \\mathrm{\\mu J} = 10^{-6} \\ \\mathrm{J}$):\n$$ E_{\\mathrm{oss}}(400 \\ \\mathrm{V}) = \\frac{200}{3} \\ \\mathrm{\\mu J} \\approx 66.666... \\ \\mathrm{\\mu J} $$\nRounding to four significant figures, this is $66.67 \\ \\mathrm{\\mu J}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.4000 & 66.67 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The accuracy of a circuit simulation depends critically on the fidelity of its component models. This hands-on coding practice challenges you to compare the predictions of a basic SPICE model with a more sophisticated charge-based macro-model for a MOSFET's gate-drain capacitance. By deriving and comparing the predicted drain voltage slew rates, you will quantify the impact of model choice and gain a deeper appreciation for why accurate, non-linear charge models are essential for modern power electronic design. ",
            "id": "3860875",
            "problem": "You are given a scenario involving a Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET) in a hard-switching turn-on event into a constant current load, with a gate driver modeled as an ideal voltage step source in series with a gate resistor. The objective is to compare how the Simulation Program with Integrated Circuit Emphasis (SPICE) level-1 MOSFET model and a charge-based power MOSFET macro-model predict the dependency of the drain-node voltage slew rate $dv_d/dt$ on gate resistance $R_g$ and gate-to-drain capacitance $C_{gd}$ during the drain voltage fall dominated by the Miller plateau.\n\nAssume the following physically consistent and widely used modeling assumptions:\n\n- The gate driver applies an ideal step from $V_{\\text{drive}}$ to the MOSFET gate through series resistance $R_g$.\n- The load current $I_{\\text{load}}$ is constant and sufficiently high to force a Miller plateau at the gate during the drain fall. The source node is at $0$ reference potential.\n- The SPICE level-1 channel current in strong inversion saturation is modeled by $I_D = k \\left(V_{GS} - V_{\\text{th}}\\right)^2$ with $V_{DS}$ large enough to satisfy saturation. During the Miller plateau, $I_D \\approx I_{\\text{load}}$ fixes an approximate plateau voltage $V_{\\text{MP}}$ by $I_{\\text{load}} = k \\left(V_{\\text{MP}} - V_{\\text{th}}\\right)^2$.\n- In the drain-fall interval dominated by the Miller effect, the gate voltage $V_G$ is approximately clamped at $V_{\\text{MP}}$, the gate current is $I_G = \\left(V_{\\text{drive}} - V_{\\text{MP}}\\right)/R_g$, and the drain-node motion is governed by gate-drain charge flow according to the fundamental law $i = dQ/dt$.\n- For the SPICE level-1 capacitance abstraction, treat $Q_{gd}$ as linear in $V_D$ with a constant $C_{gd}$.\n- For the charge-based macro-model, use a non-linear gate-drain charge function $Q_{gd}(V_D) = C_{gd0}\\,V_{\\text{ref}}\\,\\ln\\!\\left(1 + \\frac{V_D}{V_{\\text{ref}}}\\right)$, which yields a voltage-dependent incremental capacitance $C_{gd,\\text{eff}}(V_D) = \\frac{dQ_{gd}}{dV_D} = C_{gd0}\\,\\frac{V_{\\text{ref}}}{V_{\\text{ref}} + V_D}$ at the operating $V_D$; this captures the common reduction of reverse transfer capacitance at high drain voltage in power MOSFETs.\n- During the initial drain fall, evaluate $dv_D/dt$ at $V_D \\approx V_{DD}$ (the bus voltage) where the Miller effect is strongest.\n\nStarting from the fundamental relationships $i = dQ/dt$ and the defined models, derive expressions for $dv_D/dt$ for both modeling approaches in terms of the given parameters. Then implement a program that computes, for each test case, the ratio of the macro-model prediction to the SPICE level-1 prediction for the initial drain voltage slew rate,\n$$\nr = \\frac{\\left(dv_D/dt\\right)_{\\text{macro}}}{\\left(dv_D/dt\\right)_{\\text{level-1}}},\n$$\nand outputs these ratios.\n\nUse the following fixed parameters for all test cases unless otherwise specified in an individual case:\n- Bus voltage $V_{DD} = 400\\ \\mathrm{V}$,\n- Gate drive level $V_{\\text{drive}} = 10\\ \\mathrm{V}$,\n- Threshold voltage $V_{\\text{th}} = 3\\ \\mathrm{V}$,\n- Level-1 transconductance parameter $k = 5\\ \\mathrm{A}/\\mathrm{V}^2$,\n- Load current $I_{\\text{load}} = 20\\ \\mathrm{A}$,\n- Base gate-drain capacitance $C_{gd0} = 200 \\times 10^{-12}\\ \\mathrm{F}$ unless overridden,\n- Reference voltage $V_{\\text{ref}}$ in the macro-model as specified per test case.\n\nYour program must compute $V_{\\text{MP}}$ from $I_{\\text{load}} = k \\left(V_{\\text{MP}} - V_{\\text{th}}\\right)^2$ and then evaluate the initial $dv_D/dt$ for the SPICE level-1 model and the macro-model at $V_D = V_{DD}$ using the above physical assumptions.\n\nPhysical units: Express any intermediate $dv_D/dt$ in $\\mathrm{V/s}$ internally. The final reported ratio $r$ is dimensionless.\n\nTest suite:\n- Case 1 (baseline): $R_g = 5\\ \\Omega$, $C_{gd0} = 200 \\times 10^{-12}\\ \\mathrm{F}$, $V_{\\text{ref}} = 50\\ \\mathrm{V}$.\n- Case 2 (small gate resistance): $R_g = 0.5\\ \\Omega$, $C_{gd0} = 200 \\times 10^{-12}\\ \\mathrm{F}$, $V_{\\text{ref}} = 50\\ \\mathrm{V}$.\n- Case 3 (large gate resistance): $R_g = 25\\ \\Omega$, $C_{gd0} = 200 \\times 10^{-12}\\ \\mathrm{F}$, $V_{\\text{ref}} = 50\\ \\mathrm{V}$.\n- Case 4 (small base $C_{gd}$): $R_g = 5\\ \\Omega$, $C_{gd0} = 50 \\times 10^{-12}\\ \\mathrm{F}$, $V_{\\text{ref}} = 50\\ \\mathrm{V}$.\n- Case 5 (moderate nonlinearity weakening): $R_g = 5\\ \\Omega$, $C_{gd0} = 200 \\times 10^{-12}\\ \\mathrm{F}$, $V_{\\text{ref}} = 200\\ \\mathrm{V}$.\n- Case 6 (weak nonlinearity): $R_g = 5\\ \\Omega$, $C_{gd0} = 200 \\times 10^{-12}\\ \\mathrm{F}$, $V_{\\text{ref}} = 1000\\ \\mathrm{V}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4,r5,r6]\"), where each $r_i$ is a floating-point number representing the ratio for the corresponding test case.",
            "solution": "The problem requires a comparative analysis of two different models for the gate-drain capacitance of a MOSFET during a hard-switching turn-on event. We must derive the initial drain voltage slew rate, $dv_D/dt$, for both the SPICE level-1 model and a charge-based macro-model, and then find the ratio of their predictions.\n\nThe analysis focuses on the Miller plateau phase of the turn-on transition. During this interval, the gate-source voltage is approximately constant at the Miller plateau voltage, $V_{GS} \\approx V_{\\text{MP}}$, which is just sufficient to conduct the full load current, $I_{\\text{load}}$. All gate current provided by the driver is therefore channeled into changing the charge on the gate-drain capacitance, $C_{gd}$.\n\nFirst, we determine the Miller plateau voltage, $V_{\\text{MP}}$. The problem states that the SPICE level-1 saturation current is $I_D = k(V_{GS} - V_{\\text{th}})^2$. During the plateau, $V_{GS} = V_{\\text{MP}}$ and the channel conducts the load current, $I_D = I_{\\text{load}}$.\n$$I_{\\text{load}} = k(V_{\\text{MP}} - V_{\\text{th}})^2$$\nSolving for $V_{\\text{MP}}$ (and taking the positive root since $V_{\\text{MP}} > V_{\\text{th}}$ for the transistor to be on):\n$$V_{\\text{MP}} = V_{\\text{th}} + \\sqrt{\\frac{I_{\\text{load}}}{k}}$$\nUsing the provided fixed parameters, $V_{\\text{th}} = 3\\ \\mathrm{V}$, $I_{\\text{load}} = 20\\ \\mathrm{A}$, and $k = 5\\ \\mathrm{A}/\\mathrm{V}^2$:\n$$V_{\\text{MP}} = 3\\ \\mathrm{V} + \\sqrt{\\frac{20\\ \\mathrm{A}}{5\\ \\mathrm{A}/\\mathrm{V}^2}} = 3\\ \\mathrm{V} + \\sqrt{4\\ \\mathrm{V}^2} = 3\\ \\mathrm{V} + 2\\ \\mathrm{V} = 5\\ \\mathrm{V}$$\n\nNext, we establish the gate current, $I_G$. The gate is driven by a voltage source $V_{\\text{drive}}$ through a resistor $R_g$. Since the gate voltage is clamped at $V_{\\text{MP}}$ during the Miller plateau, the gate current is constant:\n$$I_G = \\frac{V_{\\text{drive}} - V_{\\text{MP}}}{R_g}$$\nSubstituting $V_{\\text{drive}} = 10\\ \\mathrm{V}$ and $V_{\\text{MP}} = 5\\ \\mathrm{V}$:\n$$I_G = \\frac{10\\ \\mathrm{V} - 5\\ \\mathrm{V}}{R_g} = \\frac{5\\ \\mathrm{V}}{R_g}$$\n\nThe fundamental relationship governing the drain voltage slew rate is based on the displacement current through the gate-drain capacitance. The gate current $I_G$ charges the effective gate-drain capacitance $C_{gd,\\text{eff}}$. The voltage across this capacitance is $V_{GD} = V_G - V_D$. The current is given by $I_G = \\frac{dQ_{gd}}{dt}$. Using the chain rule, and noting that $V_G = V_{\\text{MP}}$ is constant:\n$$I_G = \\frac{dQ_{gd}}{dV_{GD}} \\frac{dV_{GD}}{dt} = C_{gd,\\text{eff}} \\frac{d(V_{\\text{MP}} - V_D)}{dt} = -C_{gd,\\text{eff}} \\frac{dV_D}{dt}$$\nThis yields the expression for the drain voltage slew rate:\n$$\\frac{dV_D}{dt} = - \\frac{I_G}{C_{gd,\\text{eff}}}$$\nThe negative sign correctly indicates that a positive gate current causes the drain voltage to fall.\n\nNow, we apply this general formula to the two specified models.\n\n**1. SPICE Level-1 Model**\nThis model assumes a constant gate-drain capacitance, $C_{gd}$. For a fair comparison with the macro-model, we use the base capacitance value, so $C_{gd,\\text{eff}} = C_{gd0}$.\nThe slew rate is therefore constant throughout the drain voltage fall:\n$$\\left(\\frac{dV_D}{dt}\\right)_{\\text{level-1}} = - \\frac{I_G}{C_{gd0}} = - \\frac{V_{\\text{drive}} - V_{\\text{MP}}}{R_g C_{gd0}}$$\n\n**2. Charge-based Macro-Model**\nThis model uses a voltage-dependent effective capacitance:\n$$C_{gd,\\text{eff}}(V_D) = C_{gd0} \\frac{V_{\\text{ref}}}{V_{\\text{ref}} + V_D}$$\nThe problem asks for the *initial* slew rate, which occurs at the beginning of the drain voltage fall when $V_D \\approx V_{DD}$. We evaluate the capacitance at this voltage:\n$$C_{gd,\\text{eff}}(V_{DD}) = C_{gd0} \\frac{V_{\\text{ref}}}{V_{\\text{ref}} + V_{DD}}$$\nThe corresponding initial slew rate is:\n$$\\left(\\frac{dV_D}{dt}\\right)_{\\text{macro}} = - \\frac{I_G}{C_{gd,\\text{eff}}(V_{DD})} = - \\frac{I_G}{C_{gd0} \\frac{V_{\\text{ref}}}{V_{\\text{ref}} + V_{DD}}}$$\nRearranging this gives:\n$$\\left(\\frac{dV_D}{dt}\\right)_{\\text{macro}} = - \\frac{I_G}{C_{gd0}} \\left(\\frac{V_{\\text{ref}} + V_{DD}}{V_{\\text{ref}}}\\right) = - \\frac{I_G}{C_{gd0}} \\left(1 + \\frac{V_{DD}}{V_{\\text{ref}}}\\right)$$\n\n**3. Ratio of Predictions**\nWe now compute the required ratio, $r$:\n$$r = \\frac{\\left(dV_D/dt\\right)_{\\text{macro}}}{\\left(dV_D/dt\\right)_{\\text{level-1}}} = \\frac{- \\frac{I_G}{C_{gd0}} \\left(1 + \\frac{V_{DD}}{V_{\\text{ref}}}\\right)}{- \\frac{I_G}{C_{gd0}}}$$\nThe term $-I_G/C_{gd0}$ cancels, leading to a remarkably simple result:\n$$r = 1 + \\frac{V_{DD}}{V_{\\text{ref}}}$$\nThis result reveals a key insight: the ratio of the predicted initial slew rates is independent of the gate resistance $R_g$, the base capacitance $C_{gd0}$, and all other parameters that determine the gate current $I_G$. The ratio depends only on the bus voltage $V_{DD}$ and the macro-model's nonlinearity parameter $V_{\\text{ref}}$. Physically, this occurs because both slew rate predictions are scaled identically by the gate current $I_G$ and base capacitance $C_{gd0}$, making their ratio dependent only on the factor that distinguishes the models: the voltage-dependent term $\\left(1 + V_{DD}/V_{\\text{ref}}\\right)$. The macro-model predicts a faster slew rate (larger magnitude, $r > 1$) because the effective capacitance at high $V_{DD}$ is lower than the constant $C_{gd0}$ assumed by the level-1 model.\n\nThe program will implement this final formula for the test suite. For a given test case, only the parameter $V_{\\text{ref}}$ is needed, along with the fixed parameter $V_{DD} = 400\\ \\mathrm{V}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ratio of drain voltage slew rate predictions between a charge-based\n    macro-model and a SPICE level-1 model for a MOSFET turn-on event.\n    \"\"\"\n\n    # Define the fixed bus voltage as per the problem statement.\n    V_DD = 400.0  # Bus voltage in Volts\n\n    # Define the test cases. Each case is a tuple of (Rg, Cgd0, V_ref), though only\n    # V_ref is needed for the final ratio calculation. The other parameters are\n    # included for clarity and correspondence with the problem statement.\n    # (R_g [Ohm], C_gd0 [F], V_ref [V])\n    test_cases = [\n        (5.0, 200e-12, 50.0),    # Case 1 (baseline)\n        (0.5, 200e-12, 50.0),   # Case 2 (small gate resistance)\n        (25.0, 200e-12, 50.0),  # Case 3 (large gate resistance)\n        (5.0, 50e-12, 50.0),    # Case 4 (small base Cgd)\n        (5.0, 200e-12, 200.0),  # Case 5 (moderate nonlinearity weakening)\n        (5.0, 200e-12, 1000.0)  # Case 6 (weak nonlinearity)\n    ]\n\n    results = []\n    \n    # As derived in the solution, the ratio 'r' simplifies to a formula that only\n    # depends on V_DD and V_ref.\n    # r = (dv_D/dt)_macro / (dv_D/dt)_level-1 = 1 + V_DD / V_ref\n    for case in test_cases:\n        # Unpack the parameters for the current case.\n        # Rg and Cgd0 do not influence the final ratio.\n        _Rg, _Cgd0, V_ref = case\n        \n        # Calculate the ratio using the derived formula.\n        r = 1.0 + V_DD / V_ref\n        \n        results.append(r)\n\n    # The final print statement must produce a single line containing a\n    # comma-separated list of results enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}