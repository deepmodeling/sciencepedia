{
    "hands_on_practices": [
        {
            "introduction": "The reverse recovery process is not solely an intrinsic property of a diode but a dynamic interplay with the external circuit. This exercise explores a common scenario where the commutating inductance $L$ and reverse voltage $V$ dominate the initial phase of recovery, setting the rate of rise of the reverse current, $di_{R}/dt$. By applying fundamental circuit laws and charge conservation principles, you will derive the peak reverse current $I_{rrm}$, providing a crucial link between circuit parameters and device stress. ",
            "id": "3834801",
            "problem": "A single-diode commutation experiment is set up to study reverse recovery in a power semiconductor diode. Immediately prior to commutation at time $t=0$, the diode conducts a steady forward current and holds a stored excess charge $Q_{s}$ in its drift region due to conductivity modulation. At $t=0^{+}$, an ideal Direct Current (DC) source of magnitude $V$ is applied so that the diode is reverse biased through a series inductance $L$. Assume the following scientifically realistic conditions during the carrier storage phase of reverse recovery:\n- The reverse current through the diode, denoted $i_{R}(t)$, is determined entirely by the external circuit dynamics, and any diode-junction capacitive effects are negligible on the timescale of interest.\n- The inductor current starts from $0$ at $t=0^{+}$ and rises monotonically while carriers are being extracted.\n- The diode maintains a small voltage across its junction during the storage phase, so that the majority of the applied source voltage appears across the series inductance.\n- Carrier extraction is modeled by the continuity of charge, where the stored charge $Q_{s}$ is removed by the time-integral of the reverse current during the storage interval $[0, t_{a}]$, with $t_{a}$ denoting the storage time (the end of the storage phase).\n- The reverse current $i_{R}(t)$ increases approximately linearly from $0$ to its storage-phase endpoint value $I_{rrm}$ over $[0, t_{a}]$.\n\nStarting from fundamental circuit and charge-conservation principles, perform the following:\n1. Use the voltage–current relation for an inductor and Kirchhoff’s Voltage Law (KVL) to obtain the reverse-current slope during the storage phase in terms of $V$ and $L$.\n2. Using charge continuity, relate $Q_{s}$ to the time-integral of $i_{R}(t)$ over $[0, t_{a}]$ under the linear-ramp approximation and derive a closed-form relation linking $t_{a}$ and $I_{rrm}$.\n3. Eliminate $t_{a}$ to obtain a closed-form analytic expression for $I_{rrm}$ in terms of $Q_{s}$, $V$, and $L$.\n\nFinally, evaluate $I_{rrm}$ for the parameters $Q_{s} = 60 \\times 10^{-6} \\,\\text{C}$, $V = 200 \\,\\text{V}$, and $L = 0.5 \\times 10^{-3} \\,\\text{H}$. Round your final numeric answer to four significant figures. Express the final current in A.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of power electronics, well-posed with sufficient and consistent information, and objective in its language. It represents a standard, albeit simplified, analysis of diode reverse recovery, a fundamental topic in the field.\n\nThe solution proceeds by satisfying the three parts of the problem statement in order.\n\nPart 1: Derivation of the reverse-current slope.\nDuring the carrier storage phase, from time $t=0$ to $t=t_{a}$, the diode is reverse-biased by a DC voltage source $V$ through a series inductor $L$. We apply Kirchhoff’s Voltage Law (KVL) to this loop:\n$$V = v_{L}(t) + v_{D}(t)$$\nwhere $v_{L}(t)$ is the voltage across the inductor and $v_{D}(t)$ is the voltage across the diode.\n\nThe problem states that during the storage phase, the diode junction maintains a small voltage drop. This is a key characteristic of the storage phase, where the presence of stored charge keeps the junction effectively forward-biased, even as the current reverses direction. Therefore, we can approximate the diode voltage as negligible compared to the source voltage:\n$$v_{D}(t) \\approx 0 \\quad \\text{for } t \\in [0, t_{a}]$$\nUnder this standard approximation, the KVL equation simplifies to:\n$$V \\approx v_{L}(t)$$\nThe fundamental voltage-current relationship for an inductor is given by:\n$$v_{L}(t) = L \\frac{di_{L}(t)}{dt}$$\nIn the specified circuit, the inductor current $i_{L}(t)$ is the reverse current flowing through the diode, denoted as $i_{R}(t)$. Thus, we have:\n$$V = L \\frac{di_{R}(t)}{dt}$$\nSolving for the slope of the reverse current, we find it to be a constant value:\n$$\\frac{di_{R}(t)}{dt} = \\frac{V}{L}$$\nThis result confirms that the reverse current increases linearly with time, consistent with the problem's assumption.\n\nPart 2: Relation between $Q_{s}$, $t_{a}$, and $I_{rrm}$.\nThe problem states that the reverse current $i_{R}(t)$ increases approximately linearly from $0$ at $t=0$ to its peak value $I_{rrm}$ at $t=t_{a}$. This linear relationship can be expressed as:\n$$i_{R}(t) = \\left(\\frac{I_{rrm}}{t_{a}}\\right) t \\quad \\text{for } t \\in [0, t_{a}]$$\nThe slope of this line is $\\frac{I_{rrm}}{t_{a}}$, which must be equal to the slope derived in Part 1, $\\frac{V}{L}$. We will use this fact later.\n\nThe principle of charge continuity states that the total stored charge $Q_{s}$ is removed by the time integral of the reverse current over the storage interval $[0, t_{a}]$. Mathematically:\n$$Q_{s} = \\int_{0}^{t_{a}} i_{R}(t) \\, dt$$\nSubstituting the linear expression for $i_{R}(t)$ into the integral:\n$$Q_{s} = \\int_{0}^{t_{a}} \\left(\\frac{I_{rrm}}{t_{a}}\\right) t \\, dt$$\nWe can factor out the constant term $\\frac{I_{rrm}}{t_{a}}$:\n$$Q_{s} = \\frac{I_{rrm}}{t_{a}} \\int_{0}^{t_{a}} t \\, dt$$\nEvaluating the integral gives:\n$$Q_{s} = \\frac{I_{rrm}}{t_{a}} \\left[ \\frac{t^{2}}{2} \\right]_{0}^{t_{a}} = \\frac{I_{rrm}}{t_{a}} \\left( \\frac{t_{a}^{2}}{2} - 0 \\right)$$\nSimplifying this expression yields the desired closed-form relation:\n$$Q_{s} = \\frac{1}{2} I_{rrm} t_{a}$$\nThis shows that the stored charge swept out during the storage phase is equal to the area of the triangular-shaped reverse current pulse.\n\nPart 3: Derivation of $I_{rrm}$ and numerical evaluation.\nOur goal is to find an expression for $I_{rrm}$ in terms of the given parameters $Q_{s}$, $V$, and $L$. We have two key relations:\n1.  From combining the results of Part 1 and the definition of the linear ramp: $\\frac{di_{R}}{dt} = \\frac{I_{rrm}}{t_{a}} = \\frac{V}{L}$.\n2.  From the charge continuity analysis in Part 2: $Q_{s} = \\frac{1}{2} I_{rrm} t_{a}$.\n\nFrom relation (1), we can express the storage time $t_{a}$ in terms of $I_{rrm}$, $V$, and $L$:\n$$t_{a} = \\frac{I_{rrm} L}{V}$$\nNow, we substitute this expression for $t_{a}$ into relation (2) to eliminate $t_{a}$:\n$$Q_{s} = \\frac{1}{2} I_{rrm} \\left( \\frac{I_{rrm} L}{V} \\right)$$\n$$Q_{s} = \\frac{L}{2V} I_{rrm}^{2}$$\nWe can now rearrange this equation to solve for $I_{rrm}$:\n$$I_{rrm}^{2} = \\frac{2 Q_{s} V}{L}$$\nTaking the square root of both sides gives the final analytic expression for the peak reverse recovery current. Since $I_{rrm}$ represents a magnitude, we take the positive root:\n$$I_{rrm} = \\sqrt{\\frac{2 Q_{s} V}{L}}$$\n\nFinally, we evaluate this expression using the provided numerical values: $Q_{s} = 60 \\times 10^{-6} \\,\\text{C}$, $V = 200 \\,\\text{V}$, and $L = 0.5 \\times 10^{-3} \\,\\text{H}$.\n$$I_{rrm} = \\sqrt{\\frac{2 \\times (60 \\times 10^{-6}) \\times 200}{0.5 \\times 10^{-3}}}$$\n$$I_{rrm} = \\sqrt{\\frac{24000 \\times 10^{-6}}{0.5 \\times 10^{-3}}}$$\n$$I_{rrm} = \\sqrt{\\frac{2.4 \\times 10^{4} \\times 10^{-6}}{5 \\times 10^{-1} \\times 10^{-3}}} = \\sqrt{\\frac{2.4 \\times 10^{-2}}{5 \\times 10^{-4}}}$$\n$$I_{rrm} = \\sqrt{\\frac{2.4}{5} \\times 10^{-2 - (-4)}} = \\sqrt{0.48 \\times 10^{2}} = \\sqrt{48}$$\nTo simplify, we can write $48$ as $16 \\times 3$:\n$$I_{rrm} = \\sqrt{16 \\times 3} = 4\\sqrt{3}$$\nNumerically, $\\sqrt{3} \\approx 1.7320508...$.\n$$I_{rrm} \\approx 4 \\times 1.7320508... \\approx 6.9282032...$$\nRounding the final answer to four significant figures, as requested, we get:\n$$I_{rrm} \\approx 6.928 \\, \\text{A}$$",
            "answer": "$$\\boxed{6.928}$$"
        },
        {
            "introduction": "While the external circuit may initiate reverse recovery, the diode's internal charge dynamics dictate the subsequent shape of the current waveform, particularly its \"softness.\" This practice demonstrates the critical impact of the softness factor $S$ on circuit performance by linking it directly to the peak voltage slew rate $dv/dt$ across a commutating switch. Understanding this relationship is essential for managing voltage stress and electromagnetic interference (EMI) in power converters. ",
            "id": "3834792",
            "problem": "A commutation node is driven by a constant current source of magnitude $I_{L}$ feeding an idealized high-side switch and a grounded diode that had been conducting forward current prior to turn-on of the switch. At $t=0^{+}$, the high-side switch is driven such that it instantaneously and thereafter sinks a fixed current equal to $I_{L}$ (ideal current control), so that the only current available to charge the node’s parasitic capacitances is the diode’s reverse recovery current. The node has a total lumped capacitance $C_{\\text{eq}}$ to ground representing the sum of the switch output capacitance, diode junction capacitance, and interconnect capacitances. The reverse recovery current of the diode is modeled by a piecewise-linear triangular waveform: starting at $t=0^{+}$ with $i_{rr}(0^{+})=0$, it decreases linearly to a negative peak $-I_{\\mathrm{RM}}$ at $t=t_{a}$, and then increases linearly back to $0$ at $t=t_{a}+t_{b}$. The reverse recovery charge is defined as $Q_{rr}=\\int_{0}^{t_{a}+t_{b}} |i_{rr}(t)|\\,dt$, and the softness factor is defined as $S=t_{b}/t_{a}$.\n\nTwo diodes, $\\mathcal{D}_{1}$ and $\\mathcal{D}_{2}$, have identical reverse recovery charge $Q_{rr}$ and are tested under identical commutation conditions so that the buildup time $t_{a}$ is the same for both devices. They differ only in softness factor: $\\mathcal{D}_{1}$ has softness factor $S_{1}$ and $\\mathcal{D}_{2}$ has softness factor $S_{2}$. The node capacitance is the same in both cases and equals $C_{\\text{eq}}$. Assume the total capacitance $C_{\\text{eq}}$ is constant over the voltage swing of interest.\n\nStarting only from Kirchhoff’s current law at the node, the capacitor constitutive relation, and the given piecewise-linear definition of the reverse recovery current and softness factor, derive an expression for the peak node voltage slew rate $dv/dt$ across the commutating switch for each diode, and then compute the difference in their peak slew rates. Use the following numerical data:\n- $Q_{rr}=120\\,\\text{nC}$,\n- $t_{a}=15\\,\\text{ns}$,\n- $S_{1}=0.30$ for $\\mathcal{D}_{1}$ and $S_{2}=2.0$ for $\\mathcal{D}_{2}$,\n- $C_{\\text{eq}}=C_{\\text{oss}}+C_{j}+C_{p}$ with $C_{\\text{oss}}=120\\,\\text{pF}$, $C_{j}=30\\,\\text{pF}$, and $C_{p}=50\\,\\text{pF}$.\n\nExpress your final answer as the difference in peak $dv/dt$ between $\\mathcal{D}_{1}$ and $\\mathcal{D}_{2}$ in $\\text{V/ns}$, rounded to three significant figures.",
            "solution": "The problem is first validated by extracting all givens and examining them for scientific soundness, consistency, and completeness.\n\n### Step 1: Extract Givens\n- A constant current source of magnitude $I_{L}$ feeds a commutation node.\n- A high-side switch, upon turn-on at $t=0^{+}$, sinks a fixed current $I_{L}$.\n- A grounded diode was conducting prior to $t=0^{+}$.\n- The current available to charge the node's parasitic capacitance is the diode's reverse recovery current, $i_{rr}(t)$.\n- Total lumped capacitance at the node is $C_{\\text{eq}}$.\n- The reverse recovery current $i_{rr}(t)$ is modeled as a piecewise-linear triangular waveform:\n    - $i_{rr}(0^{+})=0$.\n    - It decreases linearly to a peak of $-I_{\\mathrm{RM}}$ at time $t=t_{a}$.\n    - It increases linearly back to $0$ at time $t=t_{a}+t_{b}$.\n- Reverse recovery charge is defined as $Q_{rr}=\\int_{0}^{t_{a}+t_{b}} |i_{rr}(t)|\\,dt$.\n- Softness factor is defined as $S=t_{b}/t_{a}$.\n- Diode $\\mathcal{D}_{1}$ has softness factor $S_{1}$.\n- Diode $\\mathcal{D}_{2}$ has softness factor $S_{2}$.\n- Both diodes have identical $Q_{rr}$ and are tested under conditions yielding the same $t_{a}$.\n- $C_{\\text{eq}}$ is constant and the same for both tests.\n- Numerical data: $Q_{rr}=120\\,\\text{nC}$, $t_{a}=15\\,\\text{ns}$, $S_{1}=0.30$, $S_{2}=2.0$, $C_{\\text{eq}}=C_{\\text{oss}}+C_{j}+C_{p}$ with $C_{\\text{oss}}=120\\,\\text{pF}$, $C_{j}=30\\,\\text{pF}$, and $C_{p}=50\\,\\text{pF}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a standard hard-switching commutation event in power electronics, focusing on the effects of diode reverse recovery. The model for the reverse recovery current is a common and accepted first-order approximation. The definitions of $Q_{rr}$ and softness factor $S$ are standard in the field. All concepts are based on fundamental principles of circuit theory (Kirchhoff's laws) and semiconductor device physics. The provided numerical values for charge, time, and capacitance are physically realistic for modern power semiconductor devices. The problem is self-contained, with all necessary information provided for a unique solution. The language is objective and scientifically precise. No scientific, logical, or factual flaws are present.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be developed.\n\n### Derivation of the Peak Slew Rate\nLet $v(t)$ be the voltage at the commutation node with respect to ground. The currents at this node are:\n$1$. The current from the source, $I_{L}$, flowing into the node.\n$2$. The current sunk by the high-side switch, $I_{L}$, flowing out of the node.\n$3$. The diode current, $i_{D}(t)$, flowing out of the node to ground. During reverse recovery, this is $i_{D}(t) = i_{rr}(t)$.\n$4$. The capacitor current, $i_{C}(t)$, flowing out of the node to ground.\n\nApplying Kirchhoff’s Current Law (KCL) at the node (sum of currents leaving is zero):\n$$(-I_{L}) + I_{L} + i_{D}(t) + i_{C}(t) = 0$$\nThis simplifies to:\n$$i_{D}(t) + i_{C}(t) = 0$$\nSubstituting $i_{D}(t) = i_{rr}(t)$, we get:\n$$i_{C}(t) = -i_{rr}(t)$$\nThe constitutive relation for the capacitor $C_{\\text{eq}}$ is:\n$$i_{C}(t) = C_{\\text{eq}} \\frac{dv}{dt}$$\nCombining these two equations gives an expression for the node voltage slew rate:\n$$\\frac{dv}{dt} = \\frac{i_{C}(t)}{C_{\\text{eq}}} = -\\frac{i_{rr}(t)}{C_{\\text{eq}}}$$\nThe peak node voltage slew rate, $(\\frac{dv}{dt})_{\\text{peak}}$, occurs when $-\\frac{i_{rr}(t)}{C_{\\text{eq}}}$ is maximum. Since $C_{\\text{eq}}$ is a positive constant, this corresponds to the maximum value of $-i_{rr}(t)$. The diode reverse recovery current $i_{rr}(t)$ is negative during the interval $t \\in (0, t_a+t_b)$, reaching its minimum (most negative) value of $-I_{\\mathrm{RM}}$ at $t=t_a$. Therefore, the maximum value of $-i_{rr}(t)$ is $I_{\\mathrm{RM}}$.\nThe peak slew rate is thus:\n$$\\left(\\frac{dv}{dt}\\right)_{\\text{peak}} = \\frac{I_{\\mathrm{RM}}}{C_{\\text{eq}}}$$\nTo find $I_{\\mathrm{RM}}$, we use the definition of the reverse recovery charge, $Q_{rr}$. $Q_{rr}$ is the total charge that flows during the reverse recovery interval, which is the area under the curve of $|i_{rr}(t)|$. Since $i_{rr}(t)$ is negative, $|i_{rr}(t)| = -i_{rr}(t)$. The shape of the $-i_{rr}(t)$ waveform is a triangle with base $t_{a}+t_{b}$ and height $I_{\\mathrm{RM}}$.\nThe area of a triangle is $\\frac{1}{2} \\times \\text{base} \\times \\text{height}$.\n$$Q_{rr} = \\int_{0}^{t_{a}+t_{b}} |i_{rr}(t)|\\,dt = \\frac{1}{2} (t_{a}+t_{b}) I_{\\mathrm{RM}}$$\nWe are given the softness factor $S = t_{b}/t_{a}$, which implies $t_{b} = S \\cdot t_{a}$. Substituting this into the equation for $Q_{rr}$:\n$$Q_{rr} = \\frac{1}{2} (t_{a} + S \\cdot t_{a}) I_{\\mathrm{RM}} = \\frac{1}{2} t_{a}(1+S)I_{\\mathrm{RM}}$$\nWe can now solve for the peak reverse current $I_{\\mathrm{RM}}$:\n$$I_{\\mathrm{RM}} = \\frac{2 Q_{rr}}{t_{a}(1+S)}$$\nSubstituting this expression for $I_{\\mathrm{RM}}$ into the equation for the peak slew rate:\n$$\\left(\\frac{dv}{dt}\\right)_{\\text{peak}} = \\frac{1}{C_{\\text{eq}}} \\left( \\frac{2 Q_{rr}}{t_{a}(1+S)} \\right) = \\frac{2 Q_{rr}}{C_{\\text{eq}} t_{a} (1+S)}$$\nThis is the general expression for the peak slew rate.\n\n### Calculation of the Difference\nWe need to find the difference in peak slew rates between diode $\\mathcal{D}_{1}$ (with softness $S_{1}$) and diode $\\mathcal{D}_{2}$ (with softness $S_{2}$). The quantities $Q_{rr}$, $t_{a}$, and $C_{\\text{eq}}$ are identical for both cases.\nThe peak slew rate for $\\mathcal{D}_{1}$ is:\n$$\\left(\\frac{dv}{dt}\\right)_{\\text{peak}, 1} = \\frac{2 Q_{rr}}{C_{\\text{eq}} t_{a} (1+S_{1})}$$\nThe peak slew rate for $\\mathcal{D}_{2}$ is:\n$$\\left(\\frac{dv}{dt}\\right)_{\\text{peak}, 2} = \\frac{2 Q_{rr}}{C_{\\text{eq}} t_{a} (1+S_{2})}$$\nThe difference is:\n$$\\Delta\\left(\\frac{dv}{dt}\\right)_{\\text{peak}} = \\left(\\frac{dv}{dt}\\right)_{\\text{peak}, 1} - \\left(\\frac{dv}{dt}\\right)_{\\text{peak}, 2}$$\n$$\\Delta\\left(\\frac{dv}{dt}\\right)_{\\text{peak}} = \\frac{2 Q_{rr}}{C_{\\text{eq}} t_{a} (1+S_{1})} - \\frac{2 Q_{rr}}{C_{\\text{eq}} t_{a} (1+S_{2})}$$\nFactoring out the common terms:\n$$\\Delta\\left(\\frac{dv}{dt}\\right)_{\\text{peak}} = \\frac{2 Q_{rr}}{C_{\\text{eq}} t_{a}} \\left( \\frac{1}{1+S_{1}} - \\frac{1}{1+S_{2}} \\right)$$\nNow, we substitute the numerical values. First, calculate the total capacitance $C_{\\text{eq}}$:\n$$C_{\\text{eq}} = C_{\\text{oss}} + C_{j} + C_{p} = 120\\,\\text{pF} + 30\\,\\text{pF} + 50\\,\\text{pF} = 200\\,\\text{pF} = 200 \\times 10^{-12}\\,\\text{F}$$\nThe other given values are:\n$Q_{rr} = 120\\,\\text{nC} = 120 \\times 10^{-9}\\,\\text{C}$\n$t_{a} = 15\\,\\text{ns} = 15 \\times 10^{-9}\\,\\text{s}$\n$S_{1} = 0.30$\n$S_{2} = 2.0$\n\nLet's compute the pre-factor:\n$$\\frac{2 Q_{rr}}{C_{\\text{eq}} t_{a}} = \\frac{2 \\times (120 \\times 10^{-9}\\,\\text{C})}{(200 \\times 10^{-12}\\,\\text{F}) \\times (15 \\times 10^{-9}\\,\\text{s})} = \\frac{240 \\times 10^{-9}}{3000 \\times 10^{-21}}\\,\\frac{\\text{V}}{\\text{s}}$$\n$$\\frac{2 Q_{rr}}{C_{\\text{eq}} t_{a}} = \\frac{240}{3000} \\times 10^{12}\\,\\frac{\\text{V}}{\\text{s}} = 0.08 \\times 10^{12}\\,\\frac{\\text{V}}{\\text{s}} = 8 \\times 10^{10}\\,\\frac{\\text{V}}{\\text{s}}$$\nNow, let's compute the term in the parentheses:\n$$\\frac{1}{1+S_{1}} - \\frac{1}{1+S_{2}} = \\frac{1}{1+0.30} - \\frac{1}{1+2.0} = \\frac{1}{1.3} - \\frac{1}{3} = \\frac{10}{13} - \\frac{1}{3}$$\n$$\\frac{10}{13} - \\frac{1}{3} = \\frac{3 \\times 10 - 1 \\times 13}{39} = \\frac{30 - 13}{39} = \\frac{17}{39}$$\nNow, multiply the two parts:\n$$\\Delta\\left(\\frac{dv}{dt}\\right)_{\\text{peak}} = (8 \\times 10^{10}) \\times \\frac{17}{39}\\,\\frac{\\text{V}}{\\text{s}} = \\frac{136 \\times 10^{10}}{39}\\,\\frac{\\text{V}}{\\text{s}} \\approx 3.487179 \\times 10^{10}\\,\\frac{\\text{V}}{\\text{s}}$$\nThe problem asks for the answer in units of V/ns. Since $1\\,\\text{ns} = 10^{-9}\\,\\text{s}$, we have $1\\,\\text{V/s} = 10^{-9}\\,\\text{V/ns}$.\n$$\\Delta\\left(\\frac{dv}{dt}\\right)_{\\text{peak}} \\approx (3.487179 \\times 10^{10}) \\times (10^{-9}\\,\\text{V/ns}) = 34.87179\\,\\text{V/ns}$$\nRounding to three significant figures, we get:\n$$\\Delta\\left(\\frac{dv}{dt}\\right)_{\\text{peak}} \\approx 34.9\\,\\text{V/ns}$$",
            "answer": "$$\n\\boxed{34.9}\n$$"
        },
        {
            "introduction": "In a real-world measurement, the observed reverse current is a composite signal, blending the conduction current from stored minority charge with the displacement current from the junction capacitance. This computational exercise guides you through the practical task of separating these two components from a given set of \"measured\" voltage and current waveforms. Mastering this numerical decomposition is a key skill for accurate device characterization and the development of high-fidelity simulation models. ",
            "id": "3834852",
            "problem": "A silicon junction diode is subjected to a reverse commutation event producing a transient reverse current and a time-varying terminal voltage. The total reverse current includes a contribution due to the removal of stored minority carrier charge accumulated during forward conduction and a displacement current due to the voltage-dependent junction capacitance. Starting from a fundamental base, the total charge in the device can be written as the sum of a voltage-dependent depletion charge and a time-dependent stored minority charge. Current is defined as the time derivative of charge, and incremental capacitance is defined as the derivative of charge with respect to voltage.\n\nYou are given a parametric model for the junction capacitance as a function of voltage, the sampling interval, and synthetic but physically plausible waveforms for the terminal voltage and measured reverse current for three test cases. Your task is to separate the reverse recovery charge attributable to conduction (stored/diffusion) from the capacitive charge, using integration and differentiation consistent with the definitions above, and compute each component.\n\nAssumptions and definitions:\n- The junction capacitance function is defined as $C_{j}(v) = C_{0}\\left(1 + \\dfrac{v}{V_{j}}\\right)^{-m}$ for $v \\ge 0$, where $C_{0} \\gt 0$, $V_{j} \\gt 0$, and $m \\ge 0$ are parameters.\n- The terminal voltage $v(t)$ is nonnegative and varies in time according to each test case specification.\n- The measured reverse current $i_{R}(t)$ is the sum of two contributions: a conduction (diffusion) component related to the time rate of change of the stored charge, and a capacitive displacement component related to the time rate of change of the depletion charge.\n- Sampling is uniform with interval $\\Delta t$, and all quantities are expressed in the International System of Units (SI).\n\nFundamental base for derivation:\n- Current equals the time derivative of total charge: $i(t) = \\dfrac{dq(t)}{dt}$.\n- Incremental capacitance is the derivative of depletion charge with respect to voltage: $C_{j}(v) = \\dfrac{dq_{C}(v)}{dv}$.\n- The capacitive displacement current equals the time derivative of the depletion charge, and the conduction current equals the time derivative of the stored charge.\n\nFor each test case, you are provided the parameters below, and the program must construct the voltage and current waveforms and then compute:\n- The capacitive charge $Q_{\\text{cap}}$ obtained by integrating the capacitive displacement current over time, expressed in coulombs.\n- The conduction (diffusion) charge $Q_{\\text{cond}}$ obtained by integrating the conduction current over time, expressed in coulombs.\n\nWaveform construction rules used to generate the synthetic measured data for testing:\n- The terminal voltage is specified per case as a function $v(t)$ over a finite interval $[0,T_{\\text{end}}]$.\n- The conduction (diffusion) current is specified as $i_{\\text{diff}}(t) = \\dfrac{Q_{s}}{\\tau_{Q}}e^{-t/\\tau_{Q}}$ for $t \\in [0,T_{\\text{end}}]$, where $Q_{s} \\gt 0$ and $\\tau_{Q} \\gt 0$ are parameters and $i_{\\text{diff}}$ is nonnegative.\n- The measured reverse current is constructed as $i_{R}(t) = i_{\\text{diff}}(t) + i_{\\text{cap}}(t)$, where $i_{\\text{cap}}(t)$ is the capacitive displacement current consistent with the given $C_{j}(v)$ and $v(t)$.\n\nTest suite:\n- Case 1 (general, nonconstant voltage, moderately nonlinear capacitance):\n  - $C_{0} = 150 \\times 10^{-12}\\ \\text{F}$, $V_{j} = 0.7\\ \\text{V}$, $m = 0.5$\n  - $\\Delta t = 1 \\times 10^{-9}\\ \\text{s}$, $T_{\\text{end}} = 1 \\times 10^{-6}\\ \\text{s}$\n  - $v(t) = V_{R}\\left(1 - e^{-t/\\tau_{v}}\\right)$ with $V_{R} = 100\\ \\text{V}$ and $\\tau_{v} = 40 \\times 10^{-9}\\ \\text{s}$\n  - $Q_{s} = 400 \\times 10^{-9}\\ \\text{C}$, $\\tau_{Q} = 120 \\times 10^{-9}\\ \\text{s}$\n- Case 2 (boundary, constant voltage, vanishing capacitive current):\n  - $C_{0} = 100 \\times 10^{-12}\\ \\text{F}$, $V_{j} = 0.7\\ \\text{V}$, $m = 0.5$\n  - $\\Delta t = 1 \\times 10^{-9}\\ \\text{s}$, $T_{\\text{end}} = 1 \\times 10^{-6}\\ \\text{s}$\n  - $v(t) = V_{R}$ with $V_{R} = 200\\ \\text{V}$ (constant in time)\n  - $Q_{s} = 200 \\times 10^{-9}\\ \\text{C}$, $\\tau_{Q} = 80 \\times 10^{-9}\\ \\text{s}$\n- Case 3 (edge, strong nonlinearity in capacitance and linear voltage ramp):\n  - $C_{0} = 300 \\times 10^{-12}\\ \\text{F}$, $V_{j} = 0.5\\ \\text{V}$, $m = 1.0$\n  - $\\Delta t = 0.5 \\times 10^{-9}\\ \\text{s}$, $T_{\\text{end}} = 0.5 \\times 10^{-6}\\ \\text{s}$\n  - $v(t) = V_{R}\\dfrac{t}{T_{\\text{end}}}$ with $V_{R} = 400\\ \\text{V}$\n  - $Q_{s} = 150 \\times 10^{-9}\\ \\text{C}$, $\\tau_{Q} = 50 \\times 10^{-9}\\ \\text{s}$\n\nProgram requirements:\n- Construct the time vector $t_{k} = k \\Delta t$ for $k = 0,1,\\dots,K$ such that $t_{K} \\approx T_{\\text{end}}$ and evaluate $v(t_{k})$ and $i_{R}(t_{k})$ according to the rules above.\n- Using only the given $v(t_{k})$, $i_{R}(t_{k})$, and $C_{j}(v)$, compute the capacitive displacement current by differentiating the voltage and applying the incremental capacitance, and then separate the conduction component by subtraction from the measured current.\n- Numerically integrate each component over time to obtain $Q_{\\text{cap}}$ and $Q_{\\text{cond}}$ for each case. Express both charges in coulombs.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[Q_{\\text{cap,1}}, Q_{\\text{cond,1}}, Q_{\\text{cap,2}}, Q_{\\text{cond,2}}, Q_{\\text{cap,3}}, Q_{\\text{cond,3}}]$, where subscript $1,2,3$ correspond to Cases 1, 2, and 3 respectively.\n\nAnswer in coulombs for all outputs. The final line must be formatted exactly as specified.",
            "solution": "The user-provided problem is evaluated as scientifically sound, well-posed, and based on established principles of semiconductor physics and power electronics. The parameters and models are physically plausible and self-consistent. The task is a standard numerical analysis problem involving the application of differentiation and integration to sampled data to separate components of a mixed signal. Therefore, the problem is deemed **valid**.\n\nThe solution proceeds by first establishing the theoretical framework and then detailing the numerical implementation for separating the capacitive and conduction charge components from the total reverse recovery current of a diode.\n\n**1. Theoretical Framework**\n\nThe total charge $q(t)$ in the diode junction region is the sum of the depletion charge $q_C$, which depends on the junction voltage $v(t)$, and the stored minority carrier charge $q_S$, which is related to prior forward conduction.\n$$\nq(t) = q_{C}(v(t)) + q_{S}(t)\n$$\nThe total current $i(t)$ flowing through the device is the time derivative of the total charge:\n$$\ni(t) = \\frac{dq(t)}{dt} = \\frac{d}{dt}q_{C}(v(t)) + \\frac{d}{dt}q_{S}(t)\n$$\nThe problem considers a reverse current $i_R(t)$, which is conventionally taken as positive when flowing out of the device. The two terms on the right-hand side are identified as the capacitive (or displacement) current, $i_{\\text{cap}}(t)$, and the conduction (or diffusion) current, $i_{\\text{cond}}(t)$, respectively.\n$$\ni_{R}(t) = i_{\\text{cap}}(t) + i_{\\text{cond}}(t)\n$$\nThe capacitive current $i_{\\text{cap}}(t)$ arises from the change in the depletion charge. Using the chain rule, we can express it in terms of the voltage-dependent junction capacitance $C_j(v)$:\n$$\ni_{\\text{cap}}(t) = \\frac{dq_{C}(v(t))}{dt} = \\frac{dq_{C}}{dv} \\frac{dv}{dt}\n$$\nBy definition, the incremental junction capacitance is $C_j(v) = \\frac{dq_{C}}{dv}$. Therefore, the capacitive current is given by:\n$$\ni_{\\text{cap}}(t) = C_{j}(v(t)) \\frac{dv(t)}{dt}\n$$\nThe problem provides a standard parametric model for this capacitance:\n$$\nC_{j}(v) = C_{0}\\left(1 + \\frac{v}{V_{j}}\\right)^{-m}\n$$\nwhere $v(t)$ is the non-negative reverse voltage across the junction.\n\nThe conduction current $i_{\\text{cond}}(t) = \\frac{d q_S(t)}{dt}$ is due to the removal of stored minority carriers from the neutral regions of the diode.\n\nThe objective is to find the total charge associated with each component over the time interval $[0, T_{\\text{end}}]$. These are the capacitive charge, $Q_{\\text{cap}}$, and the conduction charge, $Q_{\\text{cond}}$:\n$$\nQ_{\\text{cap}} = \\int_{0}^{T_{\\text{end}}} i_{\\text{cap}}(t) dt\n$$\n$$\nQ_{\\text{cond}} = \\int_{0}^{T_{\\text{end}}} i_{\\text{cond}}(t) dt\n$$\n\n**2. Numerical Procedure**\n\nThe problem provides synthetic waveforms for the terminal voltage $v(t)$ and the total reverse current $i_R(t)$ as discrete time series sampled at intervals of $\\Delta t$. Let the discrete time points be $t_k = k \\Delta t$, and the corresponding sampled values be $v_k = v(t_k)$ and $i_{R,k} = i_R(t_k)$.\n\nThe core of the task is to estimate $i_{\\text{cap},k}$ from the given $v_k$ data and the capacitance model, then find $i_{\\text{cond},k}$ by subtraction, and finally perform numerical integration.\n\n**Step 2.1: Numerical Differentiation**\nTo calculate the capacitive current $i_{\\text{cap},k}$, we first need the time derivative of the voltage, $(\\frac{dv}{dt})_k$, at each sample point. We use a numerical finite difference approximation. The `numpy.gradient` function is suitable as it employs a second-order accurate central difference scheme for interior points and first-order accurate forward/backward differences for the endpoints. For an interior point $t_k$, the derivative is approximated as:\n$$\n\\left(\\frac{dv}{dt}\\right)_{k} \\approx \\frac{v_{k+1} - v_{k-1}}{2\\Delta t}\n$$\n\n**Step 2.2: Component Separation**\nWith the numerical derivative $(\\frac{dv}{dt})_k$, we can compute the capacitive current at each time step:\n$$\ni_{\\text{cap},k} = C_{j}(v_k) \\left(\\frac{dv}{dt}\\right)_{k} = C_{0}\\left(1 + \\frac{v_k}{V_{j}}\\right)^{-m} \\left(\\frac{dv}{dt}\\right)_{k}\n$$\nThe conduction current component is then found by subtracting the calculated capacitive current from the total measured current:\n$$\ni_{\\text{cond},k} = i_{R,k} - i_{\\text{cap},k}\n$$\nThis procedure is performed for the entire time series to obtain the discrete waveforms $i_{\\text{cap},k}$ and $i_{\\text{cond},k}$.\n\n**Step 2.3: Numerical Integration**\nThe final step is to compute the total charges $Q_{\\text{cap}}$ and $Q_{\\text{cond}}$ by numerically integrating their respective current waveforms over the time interval $[0, T_{\\text{end}}]$. The trapezoidal rule is a robust and commonly used method for integrating discrete data points. The integral of a function $f(t)$ is approximated as:\n$$\n\\int_{t_0}^{t_N} f(t) dt \\approx \\sum_{k=0}^{N-1} \\frac{f(t_{k+1}) + f(t_k)}{2} \\Delta t\n$$\nThis is implemented for both $i_{\\text{cap},k}$ and $i_{\\text{cond},k}$ to yield the final charge values.\n\n**3. Waveform Generation for Analysis**\n\nPer the problem a two-stage process is required:\n1.  **Generation:** First, the program must generate the \"measured\" data. This involves analytically defining $v(t)$, its derivative $\\frac{dv}{dt}$, and the \"true\" conduction current $i_{\\text{diff}}(t) = \\frac{Q_{s}}{\\tau_{Q}}e^{-t/\\tau_{Q}}$. The \"true\" capacitive current is $i_{\\text{cap,true}}(t) = C_j(v(t)) \\frac{dv}{dt}$ (using the analytical derivative). The total \"measured\" current is then $i_R(t) = i_{\\text{diff}}(t) + i_{\\text{cap,true}}(t)$.\n2.  **Analysis:** Second, using only the generated discrete arrays for $v_k$, $i_{R,k}$, and the model for $C_j(v)$, the program must execute the numerical procedure described in Step 2 to compute the estimated capacitive and conduction currents, and then integrate them to find $Q_{\\text{cap}}$ and $Q_{\\text{cond}}$.\n\nThis process simulates a real-world scenario where underlying \"true\" signals produce a measurement, and the task is to deconvolve the components from that measurement using numerical methods. The accuracy of the result will depend on the fidelity of the numerical differentiation and integration.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves the diode reverse recovery problem for three test cases.\n    For each case, it:\n    1. Generates synthetic voltage and total current waveforms based on analytical models.\n    2. Analyzes these waveforms as if they were measurements to separate capacitive and\n       conduction current components using numerical differentiation.\n    3. Numerically integrates the separated current components to find the total\n       capacitive charge (Q_cap) and conduction charge (Q_cond).\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (general)\n        {\n            \"C0\": 150e-12, \"Vj\": 0.7, \"m\": 0.5,\n            \"dt\": 1e-9, \"T_end\": 1e-6,\n            \"v_func_params\": {\"VR\": 100.0, \"tau_v\": 40e-9},\n            \"v_func\": lambda t, p: p[\"VR\"] * (1 - np.exp(-t / p[\"tau_v\"])),\n            \"dv_dt_func\": lambda t, p: (p[\"VR\"] / p[\"tau_v\"]) * np.exp(-t / p[\"tau_v\"]),\n            \"Qs\": 400e-9, \"tau_Q\": 120e-9,\n        },\n        # Case 2 (constant voltage)\n        {\n            \"C0\": 100e-12, \"Vj\": 0.7, \"m\": 0.5,\n            \"dt\": 1e-9, \"T_end\": 1e-6,\n            \"v_func_params\": {\"VR\": 200.0},\n            \"v_func\": lambda t, p: p[\"VR\"] + 0*t, # 0*t to ensure array shape is correct\n            \"dv_dt_func\": lambda t, p: 0*t,\n            \"Qs\": 200e-9, \"tau_Q\": 80e-9,\n        },\n        # Case 3 (linear ramp voltage)\n        {\n            \"C0\": 300e-12, \"Vj\": 0.5, \"m\": 1.0,\n            \"dt\": 0.5e-9, \"T_end\": 0.5e-6,\n            \"v_func_params\": {\"VR\": 400.0, \"T_end\": 0.5e-6},\n            \"v_func\": lambda t, p: p[\"VR\"] * t / p[\"T_end\"],\n            \"dv_dt_func\": lambda t, p: (p[\"VR\"] / p[\"T_end\"]) + 0*t,\n            \"Qs\": 150e-9, \"tau_Q\": 50e-9,\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Unpack parameters for clarity\n        C0, Vj, m = case[\"C0\"], case[\"Vj\"], case[\"m\"]\n        dt, T_end = case[\"dt\"], case[\"T_end\"]\n        v_func, v_params = case[\"v_func\"], case[\"v_func_params\"]\n        dv_dt_func = case[\"dv_dt_func\"]\n        Qs, tau_Q = case[\"Qs\"], case[\"tau_Q\"]\n\n        # === STAGE 1: Generate Synthetic \"Measured\" Data ===\n\n        # 1. Create the time vector\n        # Ensure the time vector includes T_end\n        num_points = int(np.floor(T_end / dt)) + 1\n        t = np.linspace(0, T_end, num_points)\n\n        # 2. Generate voltage waveform from analytical function\n        v_waveform = v_func(t, v_params)\n\n        # 3. Generate \"true\" conduction and capacitive currents\n        # Conduction current based on exponential decay model\n        i_diff_true = (Qs / tau_Q) * np.exp(-t / tau_Q)\n\n        # Capacitance as a function of voltage\n        def C_j(v_val):\n            return C0 * (1 + v_val / Vj)**(-m)\n\n        Cj_waveform = C_j(v_waveform)\n\n        # \"True\" capacitive current using the analytical derivative\n        dv_dt_analytical = dv_dt_func(t, v_params)\n        i_cap_true = Cj_waveform * dv_dt_analytical\n\n        # 4. Total \"measured\" reverse current is the sum of the two components\n        i_R_waveform = i_diff_true + i_cap_true\n\n\n        # === STAGE 2: Analyze Data to Separate Components ===\n\n        # We now act as if we only have t, v_waveform, and i_R_waveform.\n\n        # 1. Numerically differentiate the voltage waveform\n        # Use np.gradient for better accuracy (central difference)\n        dv_dt_numeric = np.gradient(v_waveform, t)\n\n        # 2. Calculate the estimated capacitive current based on numerical derivative\n        # The capacitance Cj_waveform is an implicit function of time via v(t),\n        # so it's calculated using the measured v_waveform.\n        i_cap_estimated = Cj_waveform * dv_dt_numeric\n\n        # 3. Calculate the estimated conduction current by subtraction\n        i_cond_estimated = i_R_waveform - i_cap_estimated\n\n        # 4. Numerically integrate the estimated current components\n        # Use trapezoidal rule for integration (np.trapz)\n        Q_cap = np.trapz(i_cap_estimated, t)\n        Q_cond = np.trapz(i_cond_estimated, t)\n\n        results.extend([Q_cap, Q_cond])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}