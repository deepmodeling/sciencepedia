{
    "hands_on_practices": [
        {
            "introduction": "The primary function of an AC voltage controller is to regulate the power delivered to a load. To quantify this control, we must relate the firing angle $\\alpha$ to a meaningful measure of the output, like the Root Mean Square (RMS) voltage. This first practice () guides you through the fundamental derivation of the RMS output voltage for a controller with a simple resistive load. Mastering this calculation is essential, as it builds the foundational skill of applying the RMS definition to the non-sinusoidal waveforms characteristic of power electronic converters.",
            "id": "3819984",
            "problem": "An ideal single-phase full-wave alternating current (AC) voltage controller comprises two antiparallel Silicon Controlled Rectifiers (SCRs) feeding a purely resistive load of resistance $R$. The source voltage is $v_{s}(t) = V_{m} \\sin(\\omega t)$, where $V_{m}$ is the peak amplitude and $\\omega$ is the angular frequency. The controller uses symmetric firing at an angle $\\alpha$ per half-cycle, with $0 \\leq \\alpha \\leq \\pi$, measured from the instant when the source voltage passes through zero in the positive direction. Assume ideal thyristor behavior (zero leakage in the off-state, zero on-state voltage drop, instantaneous turn-on at the gating instant, and natural commutation at current zero), negligible source impedance, and no commutation overlap, so that the output voltage equals the source voltage during conduction and is zero otherwise.\n\nUnder these conditions, the conduction interval in each half-cycle is from $\\theta = \\alpha$ to $\\theta = \\pi$, where $\\theta = \\omega t$ is the electrical angle. Using only the root-mean-square (RMS) definition and fundamental trigonometric integration, derive a closed-form analytic expression for the RMS output voltage $V_{o,\\mathrm{rms}}$ in terms of $V_{m}$, $\\alpha$, and $\\pi$. Begin from the RMS definition applied over one full electrical period and evaluate the integral by employing the antiderivative of $\\sin^{2}(\\theta)$ over the conduction interval. Clearly state the change of variables from $t$ to $\\theta$ and use $\\alpha$ in radians. Express your final result as an exact symbolic expression. Do not substitute numerical values or perform any rounding. The final answer must be a single closed-form expression.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **System:** Ideal single-phase full-wave alternating current (AC) voltage controller.\n- **Components:** Two antiparallel Silicon Controlled Rectifiers (SCRs) and a purely resistive load of resistance $R$.\n- **Source Voltage:** $v_{s}(t) = V_{m} \\sin(\\omega t)$.\n- **Parameters:** $V_{m}$ is the peak voltage amplitude, $\\omega$ is the angular frequency.\n- **Control:** Symmetric firing at an angle $\\alpha$ per half-cycle.\n- **Firing Angle Domain:** $0 \\leq \\alpha \\leq \\pi$.\n- **Angle Definition:** $\\alpha$ is measured from the zero-crossing of the source voltage. The electrical angle is $\\theta = \\omega t$.\n- **Assumptions:**\n    1.  Ideal thyristors: zero leakage current, zero on-state voltage drop, instantaneous turn-on, natural commutation at current zero.\n    2.  Negligible source impedance.\n    3.  No commutation overlap.\n- **Output Voltage:** $v_{o}(t) = v_{s}(t)$ during conduction; $v_{o}(t) = 0$ otherwise.\n- **Conduction Interval:** For each half-cycle, conduction occurs from $\\theta = \\alpha$ to $\\theta = \\pi$.\n- **Mandated Method:** Derive the RMS output voltage $V_{o,\\mathrm{rms}}$ using only the RMS definition and fundamental trigonometric integration, starting from the definition over one full period. The derivation must employ the antiderivative of $\\sin^{2}(\\theta)$.\n- **Required Output:** A closed-form analytic expression for $V_{o,\\mathrm{rms}}$ in terms of $V_{m}$, $\\alpha$, and $\\pi$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the established criteria:\n- **Scientifically Grounded:** The problem is a standard exercise in power electronics, based on the well-established principles of circuit theory, semiconductor device operation (idealized), and calculus. The physics and mathematics are sound.\n- **Well-Posed:** The problem is fully specified. It provides the input voltage waveform, the circuit configuration, the load type, the control method, and all necessary idealizing assumptions required to arrive at a unique, analytic solution. The objective is clearly stated.\n- **Objective:** The problem is formulated using precise, unambiguous technical language. It is free from subjective or opinion-based statements.\n\nThe problem does not exhibit any of the invalidity flags. It is a formalizable, complete, and standard academic problem.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be derived as requested.\n\nThe root-mean-square (RMS) value of a periodic voltage $v_{o}(t)$ with period $T$ is defined as:\n$$ V_{o,\\mathrm{rms}} = \\sqrt{\\frac{1}{T} \\int_{0}^{T} v_{o}^{2}(t) \\, dt} $$\nThe source voltage is $v_{s}(t) = V_{m} \\sin(\\omega t)$, which has a period $T = \\frac{2\\pi}{\\omega}$. We perform a change of variables from time $t$ to the electrical angle $\\theta = \\omega t$. This implies $dt = \\frac{d\\theta}{\\omega}$. The integration interval over one full period becomes $0$ to $2\\pi$ in terms of $\\theta$.\nThe RMS definition in terms of $\\theta$ is:\n$$ V_{o,\\mathrm{rms}} = \\sqrt{\\frac{1}{2\\pi} \\int_{0}^{2\\pi} v_{o}^{2}(\\theta) \\, d\\theta} $$\nThe output voltage $v_{o}(\\theta)$ is determined by the SCRs' state. Due to symmetric firing, the behavior in the positive and negative half-cycles of the source voltage is structurally similar.\nFor the positive half-cycle, $0 \\leq \\theta \\leq \\pi$:\n- The first SCR is forward-biased but blocked for $0 \\leq \\theta  \\alpha$. Thus, $v_{o}(\\theta) = 0$.\n- The SCR is triggered at $\\theta = \\alpha$ and conducts until the current naturally commutates at $\\theta = \\pi$. For a resistive load, voltage and current are in phase, so conduction occurs for $\\alpha \\leq \\theta \\leq \\pi$. During this interval, $v_{o}(\\theta) = v_{s}(\\theta) = V_{m} \\sin(\\theta)$.\n\nFor the negative half-cycle, $\\pi \\leq \\theta \\leq 2\\pi$:\n- The second SCR is forward-biased but blocked for $\\pi \\leq \\theta  \\pi+\\alpha$. Thus, $v_{o}(\\theta) = 0$.\n- The SCR is triggered at $\\theta = \\pi+\\alpha$ and conducts until the current commutates at $\\theta = 2\\pi$. During this interval, $\\pi+\\alpha \\leq \\theta \\leq 2\\pi$, the output voltage is $v_{o}(\\theta) = v_{s}(\\theta) = V_{m} \\sin(\\theta)$.\n\nThe square of the output voltage, $v_{o}^{2}(\\theta)$, is therefore:\n$$\nv_{o}^{2}(\\theta) =\n\\begin{cases}\n(V_{m} \\sin(\\theta))^{2}  \\text{for } \\alpha \\leq \\theta \\leq \\pi \\\\\n(V_{m} \\sin(\\theta))^{2}  \\text{for } \\pi+\\alpha \\leq \\theta \\leq 2\\pi \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\nNow, we compute the integral for the squared RMS voltage, $V_{o,\\mathrm{rms}}^{2}$:\n$$ V_{o,\\mathrm{rms}}^{2} = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} v_{o}^{2}(\\theta) \\, d\\theta = \\frac{1}{2\\pi} \\left[ \\int_{\\alpha}^{\\pi} (V_{m} \\sin(\\theta))^{2} \\, d\\theta + \\int_{\\pi+\\alpha}^{2\\pi} (V_{m} \\sin(\\theta))^{2} \\, d\\theta \\right] $$\n$$ V_{o,\\mathrm{rms}}^{2} = \\frac{V_{m}^{2}}{2\\pi} \\left[ \\int_{\\alpha}^{\\pi} \\sin^{2}(\\theta) \\, d\\theta + \\int_{\\pi+\\alpha}^{2\\pi} \\sin^{2}(\\theta) \\, d\\theta \\right] $$\nDue to the symmetry of the $\\sin^{2}(\\theta)$ function about $\\theta=\\pi$, the integral over the second conduction interval is identical to the first. Specifically, let $\\phi = \\theta - \\pi$. The integral becomes $\\int_{\\alpha}^{\\pi} \\sin^{2}(\\phi+\\pi) \\, d\\phi = \\int_{\\alpha}^{\\pi} (-\\sin(\\phi))^{2} \\, d\\phi = \\int_{\\alpha}^{\\pi} \\sin^{2}(\\phi) \\, d\\phi$.\nTherefore, the expression simplifies to:\n$$ V_{o,\\mathrm{rms}}^{2} = \\frac{V_{m}^{2}}{2\\pi} \\left[ 2 \\int_{\\alpha}^{\\pi} \\sin^{2}(\\theta) \\, d\\theta \\right] = \\frac{V_{m}^{2}}{\\pi} \\int_{\\alpha}^{\\pi} \\sin^{2}(\\theta) \\, d\\theta $$\nTo evaluate the integral, we use the trigonometric power-reduction identity:\n$$ \\sin^{2}(\\theta) = \\frac{1 - \\cos(2\\theta)}{2} $$\nSubstituting this into the integral:\n$$ \\int_{\\alpha}^{\\pi} \\sin^{2}(\\theta) \\, d\\theta = \\int_{\\alpha}^{\\pi} \\frac{1 - \\cos(2\\theta)}{2} \\, d\\theta = \\frac{1}{2} \\left[ \\int_{\\alpha}^{\\pi} 1 \\, d\\theta - \\int_{\\alpha}^{\\pi} \\cos(2\\theta) \\, d\\theta \\right] $$\nThe antiderivative of $\\cos(2\\theta)$ is $\\frac{\\sin(2\\theta)}{2}$. Evaluating the definite integral:\n$$ = \\frac{1}{2} \\left[ [\\theta]_{\\alpha}^{\\pi} - \\left[\\frac{\\sin(2\\theta)}{2}\\right]_{\\alpha}^{\\pi} \\right] $$\n$$ = \\frac{1}{2} \\left[ (\\pi - \\alpha) - \\left( \\frac{\\sin(2\\pi)}{2} - \\frac{\\sin(2\\alpha)}{2} \\right) \\right] $$\n$$ = \\frac{1}{2} \\left[ \\pi - \\alpha - \\left( 0 - \\frac{\\sin(2\\alpha)}{2} \\right) \\right] $$\n$$ = \\frac{1}{2} \\left[ \\pi - \\alpha + \\frac{\\sin(2\\alpha)}{2} \\right] $$\nNow, we substitute this result back into the expression for $V_{o,\\mathrm{rms}}^{2}$:\n$$ V_{o,\\mathrm{rms}}^{2} = \\frac{V_{m}^{2}}{\\pi} \\left( \\frac{1}{2} \\left[ \\pi - \\alpha + \\frac{\\sin(2\\alpha)}{2} \\right] \\right) $$\n$$ V_{o,\\mathrm{rms}}^{2} = \\frac{V_{m}^{2}}{2\\pi} \\left( \\pi - \\alpha + \\frac{\\sin(2\\alpha)}{2} \\right) $$\nFinally, taking the square root of both sides yields the expression for the RMS output voltage, $V_{o,\\mathrm{rms}}$:\n$$ V_{o,\\mathrm{rms}} = \\sqrt{\\frac{V_{m}^{2}}{2\\pi} \\left( \\pi - \\alpha + \\frac{\\sin(2\\alpha)}{2} \\right)} $$\n$$ V_{o,\\mathrm{rms}} = V_{m} \\sqrt{\\frac{1}{2\\pi} \\left( \\pi - \\alpha + \\frac{\\sin(2\\alpha)}{2} \\right)} $$\nThis is the final closed-form analytical expression for the RMS output voltage in terms of the peak source voltage $V_{m}$ and the firing angle $\\alpha$.",
            "answer": "$$ \\boxed{V_{m} \\sqrt{\\frac{1}{2\\pi}\\left(\\pi - \\alpha + \\frac{\\sin(2\\alpha)}{2}\\right)}} $$"
        },
        {
            "introduction": "While resistive loads provide a clear starting point, most real-world applications, such as motor drives and inductive heaters, involve a combination of resistance and inductance. The introduction of an inductor fundamentally changes the circuit's dynamics, causing the load current to lag the voltage and persist even after the voltage reverses. This practice () challenges you to derive the analytical expression for the instantaneous load current by solving the governing differential equation. This analysis is crucial for understanding the concepts of extinction angle, discontinuous and continuous conduction modes, and their impact on converter performance.",
            "id": "3819917",
            "problem": "A single-phase Alternating Current (AC) voltage controller employing two anti-parallel Silicon Controlled Rectifiers (SCRs) supplies a series resistor–inductor load characterized by resistance $R$ and inductance $L$. The input source voltage is $v_{s}(t) = V_{m} \\sin(\\omega t)$, where $V_{m}$ is the source amplitude and $\\omega$ is the angular frequency. Assume ideal thyristors (zero on-state drop, infinite off-state impedance) and negligible source inductance. During the positive half-cycle, the positive-polarity SCR is triggered at the firing angle $\\alpha$ with $0\\alpha\\pi$ (angles are in radians). Consider the case of discontinuous conduction such that the load current is zero just prior to firing, i.e., $i(\\alpha) = 0$.\n\nUsing Kirchhoff’s Voltage Law and fundamental properties of linear time-invariant systems, derive the closed-form analytic expression for the instantaneous load current $i(\\theta)$ as a function of the dimensionless angle variable $\\theta = \\omega t$, for $\\theta \\ge \\alpha$ and while the triggered SCR conducts. Define the compact parameters $Z = \\sqrt{R^{2} + (\\omega L)^{2}}$, $\\phi = \\arctan\\!\\left(\\frac{\\omega L}{R}\\right)$, and $\\tau = \\frac{L}{R}$, and express your final answer explicitly in terms of $V_{m}$, $Z$, $\\phi$, $\\alpha$, $\\theta$, $\\omega$, and $\\tau$.\n\nExpress the current in amperes and the angles in radians. Your final answer must be a single closed-form analytic expression for $i(\\theta)$.",
            "solution": "The load is a series resistor–inductor, so applying Kirchhoff’s Voltage Law (KVL) during the conduction of the positive-polarity Silicon Controlled Rectifier (SCR) gives\n$$\nL \\frac{di(t)}{dt} + R\\, i(t) = V_{m} \\sin(\\omega t),\n$$\nwith the initial condition imposed at firing,\n$$\ni(t_{\\alpha}) = 0,\\quad \\text{where } t_{\\alpha} = \\frac{\\alpha}{\\omega}.\n$$\nThis is a first-order linear ordinary differential equation. Write it in the standard form\n$$\n\\frac{di(t)}{dt} + \\frac{R}{L}\\, i(t) = \\frac{V_{m}}{L} \\sin(\\omega t).\n$$\nAn integrating factor for this equation is\n$$\n\\mu(t) = \\exp\\!\\left(\\frac{R}{L} t\\right).\n$$\nMultiplying both sides by $\\mu(t)$ yields\n$$\n\\frac{d}{dt}\\!\\left(i(t)\\,\\exp\\!\\left(\\frac{R}{L} t\\right)\\right) = \\frac{V_{m}}{L} \\sin(\\omega t)\\, \\exp\\!\\left(\\frac{R}{L} t\\right).\n$$\nIntegrate from $t_{\\alpha}$ to $t$ and use $i(t_{\\alpha}) = 0$:\n$$\ni(t)\\,\\exp\\!\\left(\\frac{R}{L} t\\right) - i(t_{\\alpha})\\,\\exp\\!\\left(\\frac{R}{L} t_{\\alpha}\\right) = \\frac{V_{m}}{L} \\int_{t_{\\alpha}}^{t} \\sin(\\omega \\xi)\\, \\exp\\!\\left(\\frac{R}{L} \\xi\\right)\\, d\\xi,\n$$\nso\n$$\ni(t) = \\frac{V_{m}}{L}\\, \\exp\\!\\left(-\\frac{R}{L} t\\right) \\int_{t_{\\alpha}}^{t} \\sin(\\omega \\xi)\\, \\exp\\!\\left(\\frac{R}{L} \\xi\\right)\\, d\\xi.\n$$\nLet $a = \\frac{R}{L}$ and $b = \\omega$. The integral is standard:\n$$\n\\int \\exp(a \\xi)\\, \\sin(b \\xi)\\, d\\xi = \\frac{\\exp(a \\xi)}{a^{2} + b^{2}} \\left(a \\sin(b \\xi) - b \\cos(b \\xi)\\right),\n$$\nhence\n$$\n\\int_{t_{\\alpha}}^{t} \\exp(a \\xi)\\, \\sin(b \\xi)\\, d\\xi = \\left.\\frac{\\exp(a \\xi)}{a^{2} + b^{2}} \\left(a \\sin(b \\xi) - b \\cos(b \\xi)\\right)\\right|_{\\xi = t_{\\alpha}}^{\\xi = t}.\n$$\nSubstitute back to obtain\n$$\ni(t) = \\frac{V_{m}}{L}\\, \\exp(-a t)\\, \\frac{1}{a^{2} + b^{2}} \\left\\{ \\exp(a t)\\left[a \\sin(b t) - b \\cos(b t)\\right] - \\exp(a t_{\\alpha})\\left[a \\sin(b t_{\\alpha}) - b \\cos(b t_{\\alpha})\\right]\\right\\}.\n$$\nSimplify:\n$$\ni(t) = \\frac{V_{m}}{L}\\, \\frac{a \\sin(b t) - b \\cos(b t)}{a^{2} + b^{2}} - \\frac{V_{m}}{L}\\, \\frac{a \\sin(b t_{\\alpha}) - b \\cos(b t_{\\alpha})}{a^{2} + b^{2}}\\, \\exp\\!\\left(a (t_{\\alpha} - t)\\right).\n$$\nReplace $a = \\frac{R}{L}$ and $b = \\omega$, and note that\n$$\na^{2} + b^{2} = \\left(\\frac{R}{L}\\right)^{2} + \\omega^{2} = \\frac{R^{2} + (\\omega L)^{2}}{L^{2}} = \\frac{Z^{2}}{L^{2}},\n$$\nso\n$$\n\\frac{V_{m}}{L}\\, \\frac{1}{a^{2} + b^{2}} = \\frac{V_{m}}{L}\\, \\frac{L^{2}}{Z^{2}} = \\frac{V_{m} L}{Z^{2}}.\n$$\nTherefore,\n$$\ni(t) = \\frac{V_{m} L}{Z^{2}} \\left[\\frac{R}{L} \\sin(\\omega t) - \\omega \\cos(\\omega t)\\right] - \\frac{V_{m} L}{Z^{2}} \\left[\\frac{R}{L} \\sin(\\omega t_{\\alpha}) - \\omega \\cos(\\omega t_{\\alpha})\\right] \\exp\\!\\left(-\\frac{R}{L} (t - t_{\\alpha})\\right).\n$$\nGroup terms using $Z = \\sqrt{R^{2} + (\\omega L)^{2}}$ and define the load angle $\\phi = \\arctan\\!\\left(\\frac{\\omega L}{R}\\right)$, for which\n$$\n\\cos\\phi = \\frac{R}{Z}, \\qquad \\sin\\phi = \\frac{\\omega L}{Z}.\n$$\nObserve that\n$$\n\\frac{V_{m} L}{Z^{2}} \\left[\\frac{R}{L} \\sin(\\omega t) - \\omega \\cos(\\omega t)\\right] = \\frac{V_{m}}{Z} \\left[\\sin(\\omega t)\\, \\frac{R}{Z} - \\cos(\\omega t)\\, \\frac{\\omega L}{Z}\\right] = \\frac{V_{m}}{Z} \\sin(\\omega t - \\phi).\n$$\nSimilarly,\n$$\n\\frac{V_{m} L}{Z^{2}} \\left[\\frac{R}{L} \\sin(\\omega t_{\\alpha}) - \\omega \\cos(\\omega t_{\\alpha})\\right] = \\frac{V_{m}}{Z} \\sin(\\omega t_{\\alpha} - \\phi) = \\frac{V_{m}}{Z} \\sin(\\alpha - \\phi),\n$$\nbecause $\\omega t_{\\alpha} = \\alpha$. Also define the time constant $\\tau = \\frac{L}{R}$, yielding\n$$\n\\exp\\!\\left(-\\frac{R}{L} (t - t_{\\alpha})\\right) = \\exp\\!\\left(-\\frac{t - t_{\\alpha}}{\\tau}\\right).\n$$\nIntroduce the dimensionless angle variable $\\theta = \\omega t$, so $t = \\frac{\\theta}{\\omega}$ and $t - t_{\\alpha} = \\frac{\\theta - \\alpha}{\\omega}$. The exponential term becomes\n$$\n\\exp\\!\\left(-\\frac{t - t_{\\alpha}}{\\tau}\\right) = \\exp\\!\\left(-\\frac{\\theta - \\alpha}{\\omega \\tau}\\right).\n$$\nPutting all pieces together gives the closed-form current during conduction for $\\theta \\ge \\alpha$:\n$$\ni(\\theta) = \\frac{V_{m}}{Z}\\, \\sin(\\theta - \\phi) - \\frac{V_{m}}{Z}\\, \\sin(\\alpha - \\phi)\\, \\exp\\!\\left(-\\frac{\\theta - \\alpha}{\\omega \\tau}\\right).\n$$\nThis expression is in amperes when $V_{m}$ is in volts, $R$ in ohms, $L$ in henries, and $\\omega$ in radians per second, and the angles $\\alpha$, $\\theta$, and $\\phi$ are in radians. It captures the forced sinusoidal steady-state response with amplitude $\\frac{V_{m}}{Z}$ and phase shift $\\phi$, plus the exponentially decaying natural response determined by the initial condition $i(\\alpha)=0$ and the time constant $\\tau = \\frac{L}{R}$.",
            "answer": "$$\\boxed{\\frac{V_{m}}{Z}\\sin(\\theta-\\phi)-\\frac{V_{m}}{Z}\\sin(\\alpha-\\phi)\\,\\exp\\!\\left(-\\frac{\\theta-\\alpha}{\\omega\\tau}\\right)}$$"
        },
        {
            "introduction": "In modern power systems, theoretical analysis must be complemented by accurate measurement. The chopped, non-sinusoidal waveforms produced by AC voltage controllers pose a significant challenge for conventional voltmeters, necessitating \"True-RMS\" measurement techniques. This final practice () moves from pure theory to computational application, tasking you with designing a digital algorithm to estimate the RMS voltage from discrete samples. By comparing your numerical estimate to the analytical value, you will explore the practical realities of digital instrumentation, including the effects of sampling rate and phase offset on measurement accuracy.",
            "id": "3819930",
            "problem": "You are tasked with designing a computational algorithm that estimates the True-Root-Mean-Square (True-RMS) of a phase-controlled alternating current (AC) waveform produced by an AC voltage controller that uses two antiparallel Silicon Controlled Rectifiers (SCRs) supplying an ideal resistive load. The AC source is sinusoidal. The estimation algorithm must use uniformly spaced samples per period of the mains waveform, with sampling synchronized to the mains frequency but with a controllable sampling phase offset. Your program must also quantify the relative measurement error as a function of the sampling phase offset.\n\nStart from fundamental definitions and modeling assumptions:\n\n- The source voltage is ideal sinusoidal and given by $v_{\\mathrm{s}}(t) = V_{\\mathrm{m}}\\sin(\\omega t)$, where $V_{\\mathrm{m}}$ is the peak voltage and $\\omega = 2\\pi f_{\\mathrm{line}}$ with $f_{\\mathrm{line}}$ the line frequency in $\\mathrm{Hz}$. The relationship between root-mean-square (RMS) source voltage $V_{\\mathrm{rms}}$ and peak voltage is $V_{\\mathrm{m}} = \\sqrt{2}\\,V_{\\mathrm{rms}}$.\n- The controller is an ideal bidirectional SCR pair with symmetrical phase control at firing angle $\\alpha$ in radians, applied identically in both half-cycles. The load is purely resistive so that when a thyristor is conducting, the load voltage equals the source voltage, and when neither conducts, the load voltage is zero.\n- Over one period, denote the electrical angle by $\\theta = \\omega t \\in [0,2\\pi)$. The chopped output voltage $v_{\\mathrm{o}}(\\theta)$ satisfies the piecewise definition: $$v_{\\mathrm{o}}(\\theta) = \\begin{cases} V_{\\mathrm{m}}\\sin(\\theta),  \\theta \\in [\\alpha,\\pi] \\cup [\\pi+\\alpha,2\\pi], \\\\ 0,  \\text{otherwise.} \\end{cases}$$\n\nTrue-RMS is defined from first principles of mean-square over a period $T = \\frac{2\\pi}{\\omega}$:\n$$V_{\\mathrm{o,true}} = \\sqrt{\\frac{1}{T}\\int_{0}^{T} v_{\\mathrm{o}}^2(t)\\,\\mathrm{d}t} = \\sqrt{\\frac{\\omega}{2\\pi}\\int_{0}^{2\\pi} v_{\\mathrm{o}}^2(\\theta)\\,\\frac{\\mathrm{d}\\theta}{\\omega}} = \\sqrt{\\frac{1}{2\\pi}\\int_{0}^{2\\pi} v_{\\mathrm{o}}^2(\\theta)\\,\\mathrm{d}\\theta}.$$\n\nThe measurement algorithm samples uniformly at $N$ samples per period, starting at an electrical phase offset $\\phi_{\\mathrm{s}}$ in radians relative to $\\theta = 0$. The sample phases are\n$$\\theta_k = \\phi_{\\mathrm{s}} + \\frac{2\\pi k}{N},\\quad k \\in \\{0,1,\\dots,N-1\\}.$$\nThe estimated RMS from samples is\n$$V_{\\mathrm{o,est}}(N,\\phi_{\\mathrm{s}}) = \\sqrt{\\frac{1}{N}\\sum_{k=0}^{N-1} v_{\\mathrm{o}}^2(\\theta_k)}.$$\nDefine the relative measurement error (dimensionless) as\n$$\\varepsilon(N,\\phi_{\\mathrm{s}},\\alpha) = \\frac{V_{\\mathrm{o,est}}(N,\\phi_{\\mathrm{s}}) - V_{\\mathrm{o,true}}}{V_{\\mathrm{o,true}}}.$$\n\nYour program must implement the above model and compute $\\varepsilon(N,\\phi_{\\mathrm{s}},\\alpha)$ for the specified test suite. Use the following physical parameters common to all test cases:\n- Line frequency $f_{\\mathrm{line}} = 50\\,\\mathrm{Hz}$.\n- Source RMS voltage $V_{\\mathrm{rms}} = 230\\,\\mathrm{V}$, so $V_{\\mathrm{m}} = \\sqrt{2}\\cdot 230\\,\\mathrm{V}$.\n- All angles are specified and must be used in radians.\n\nTest suite specification (each test case is a tuple $(\\alpha, N, \\phi_{\\mathrm{s}})$):\n1. $(\\alpha = \\frac{\\pi}{6},\\, N = 64,\\, \\phi_{\\mathrm{s}} = 0)$: a general case with moderate conduction and dense sampling.\n2. $(\\alpha = 0,\\, N = 8,\\, \\phi_{\\mathrm{s}} = 0.31)$: boundary case of an unchopped sine wave with many samples.\n3. $(\\alpha = 0,\\, N = 2,\\, \\phi_{\\mathrm{s}} = 0.13)$: extreme low sample count on an unchopped sine.\n4. $(\\alpha = 0.95\\pi,\\, N = 16,\\, \\phi_{\\mathrm{s}} = 0.02)$: near-blocked conduction with moderate sampling.\n5. $(\\alpha = \\frac{\\pi}{3},\\, N = 12,\\, \\phi_{\\mathrm{s}} = 0.5)$: moderate chopping and modest sampling.\n\nAll five cases use the same $f_{\\mathrm{line}}$ and $V_{\\mathrm{rms}}$ given above. Your program should:\n\n- Implement $v_{\\mathrm{o}}(\\theta)$ exactly according to the piecewise definition above with angles in radians.\n- Compute $V_{\\mathrm{o,true}}$ exactly from the analytical integral definition over one period.\n- Compute $V_{\\mathrm{o,est}}$ from uniformly spaced samples at the specified $N$ and $\\phi_{\\mathrm{s}}$.\n- Return the relative error $\\varepsilon$ for each case as a floating-point number.\n\nExpress the final output as a single line containing a comma-separated list enclosed in square brackets with the five relative errors, each rounded to $9$ decimal places, for example, $[0.000000123,-0.000003210,\\dots]$. Angles must be used in radians, and any intermediate computation involving physical units must consistently use $\\mathrm{V}$ for volts and $\\mathrm{Hz}$ for hertz. The relative error is a dimensionless decimal number; do not include a percentage sign. Your program must produce no other output beyond this single line. The numerical values must be scientifically consistent with an idealized SCR-based AC voltage controller driving a resistive load under the stated assumptions.",
            "solution": "The problem requires the design of an algorithm to compute the relative error in the digital estimation of the True-RMS voltage of a phase-controlled AC waveform. The solution involves three primary steps: first, an analytical calculation of the true RMS voltage; second, a numerical estimation from discrete samples; and third, the calculation of the relative error between these two values.\n\nThe common physical parameters are the source RMS voltage $V_{\\mathrm{rms}} = 230\\,\\mathrm{V}$ and the line frequency $f_{\\mathrm{line}} = 50\\,\\mathrm{Hz}$. The peak voltage is $V_{\\mathrm{m}} = \\sqrt{2}V_{\\mathrm{rms}}$, and the angular frequency is $\\omega = 2\\pi f_{\\mathrm{line}}$.\n\n### 1. Analytical True-RMS Voltage ($V_{\\mathrm{o,true}}$)\n\nThe True-RMS value of a periodic voltage $v_{\\mathrm{o}}(t)$ over a period $T$ is defined as:\n$$V_{\\mathrm{o,true}} = \\sqrt{\\frac{1}{T}\\int_{0}^{T} v_{\\mathrm{o}}^2(t)\\,\\mathrm{d}t}$$\nBy changing the variable of integration to the electrical angle $\\theta = \\omega t$, where $T = 2\\pi/\\omega$, the definition becomes:\n$$V_{\\mathrm{o,true}} = \\sqrt{\\frac{1}{2\\pi}\\int_{0}^{2\\pi} v_{\\mathrm{o}}^2(\\theta)\\,\\mathrm{d}\\theta}$$\nThe problem defines the phase-controlled output voltage $v_{\\mathrm{o}}(\\theta)$ as:\n$$v_{\\mathrm{o}}(\\theta) = \\begin{cases} V_{\\mathrm{m}}\\sin(\\theta),  \\theta \\in [\\alpha,\\pi] \\cup [\\pi+\\alpha,2\\pi], \\\\ 0,  \\text{otherwise.} \\end{cases}$$\nThe integral of the squared voltage is non-zero only over the conduction intervals:\n$$\\int_{0}^{2\\pi} v_{\\mathrm{o}}^2(\\theta)\\,\\mathrm{d}\\theta = \\int_{\\alpha}^{\\pi} (V_{\\mathrm{m}}\\sin(\\theta))^2\\,\\mathrm{d}\\theta + \\int_{\\pi+\\alpha}^{2\\pi} (V_{\\mathrm{m}}\\sin(\\theta))^2\\,\\mathrm{d}\\theta$$\nUsing the trigonometric identity $\\sin^2(\\theta) = \\frac{1}{2}(1 - \\cos(2\\theta))$, the integral of $\\sin^2(\\theta)$ is $\\frac{\\theta}{2} - \\frac{\\sin(2\\theta)}{4}$. Evaluating the first definite integral:\n$$\\int_{\\alpha}^{\\pi} \\sin^2(\\theta)\\,\\mathrm{d}\\theta = \\left[\\frac{\\theta}{2} - \\frac{\\sin(2\\theta)}{4}\\right]_{\\alpha}^{\\pi} = \\left(\\frac{\\pi}{2} - 0\\right) - \\left(\\frac{\\alpha}{2} - \\frac{\\sin(2\\alpha)}{4}\\right) = \\frac{\\pi - \\alpha}{2} + \\frac{\\sin(2\\alpha)}{4}$$\nDue to the symmetry of the $\\sin^2(\\theta)$ function, i.e., $\\sin^2(\\theta) = \\sin^2(\\theta+\\pi)$, the second integral over $[\\pi+\\alpha, 2\\pi]$ yields the same result. Therefore, the total integral is:\n$$\\int_{0}^{2\\pi} v_{\\mathrm{o}}^2(\\theta)\\,\\mathrm{d}\\theta = V_{\\mathrm{m}}^2 \\cdot 2 \\left( \\frac{\\pi - \\alpha}{2} + \\frac{\\sin(2\\alpha)}{4} \\right) = V_{\\mathrm{m}}^2 \\left( \\pi - \\alpha + \\frac{\\sin(2\\alpha)}{2} \\right)$$\nSubstituting this into the $V_{\\mathrm{o,true}}$ expression and using $V_{\\mathrm{m}} = \\sqrt{2}V_{\\mathrm{rms}}$:\n$$V_{\\mathrm{o,true}}^2 = \\frac{1}{2\\pi} V_{\\mathrm{m}}^2 \\left( \\pi - \\alpha + \\frac{\\sin(2\\alpha)}{2} \\right) = \\frac{2V_{\\mathrm{rms}}^2}{2\\pi} \\left( \\pi - \\alpha + \\frac{\\sin(2\\alpha)}{2} \\right) = \\frac{V_{\\mathrm{rms}}^2}{\\pi} \\left( \\pi - \\alpha + \\frac{\\sin(2\\alpha)}{2} \\right)$$\nFinally, the analytical expression for the true RMS voltage is:\n$$V_{\\mathrm{o,true}}(\\alpha) = V_{\\mathrm{rms}} \\sqrt{1 - \\frac{\\alpha}{\\pi} + \\frac{\\sin(2\\alpha)}{2\\pi}}$$\nThis formula is valid for firing angles $\\alpha \\in [0, \\pi]$.\n\n### 2. Estimated RMS Voltage from Samples ($V_{\\mathrm{o,est}}$)\n\nThe digital estimation algorithm computes the RMS value from $N$ discrete samples taken over one period. The sampling instants are given by the angles:\n$$\\theta_k = \\phi_{\\mathrm{s}} + \\frac{2\\pi k}{N}, \\quad \\text{for } k \\in \\{0, 1, \\dots, N-1\\}$$\nwhere $\\phi_{\\mathrm{s}}$ is the sampling phase offset. The estimated RMS voltage is:\n$$V_{\\mathrm{o,est}}(N,\\phi_{\\mathrm{s}},\\alpha) = \\sqrt{\\frac{1}{N}\\sum_{k=0}^{N-1} v_{\\mathrm{o}}^2(\\theta_k)}$$\nTo compute $v_{\\mathrm{o}}(\\theta_k)$, we must first determine if the sample angle $\\theta_k$ falls within a conduction interval. Since the waveform is periodic with period $2\\pi$, we first map each $\\theta_k$ to its equivalent angle $\\theta'_k$ in the fundamental interval $[0, 2\\pi)$ using the modulo operation: $\\theta'_k = \\theta_k \\pmod{2\\pi}$.\nThen, for each sample $k$:\n1.  Calculate $\\theta_k = \\phi_{\\mathrm{s}} + 2\\pi k / N$.\n2.  Find the equivalent angle $\\theta'_k = \\theta_k \\pmod{2\\pi}$.\n3.  Check if $\\theta'_k$ lies in the conduction regions: $(\\alpha \\le \\theta'_k \\le \\pi)$ or $(\\pi + \\alpha \\le \\theta'_k \\le 2\\pi)$.\n4.  If it does, the instantaneous voltage is $v_{\\mathrm{o}}(\\theta_k) = V_{\\mathrm{m}}\\sin(\\theta_k)$.\n5.  If it does not, the voltage is $v_{\\mathrm{o}}(\\theta_k) = 0$.\nThe sum of squares of these $N$ voltage samples is computed, divided by $N$, and the square root is taken to find $V_{\\mathrm{o,est}}$.\n\n### 3. Relative Measurement Error ($\\varepsilon$)\n\nThe relative error $\\varepsilon$ quantifies the deviation of the estimated value from the true value, and is defined as:\n$$\\varepsilon(N,\\phi_{\\mathrm{s}},\\alpha) = \\frac{V_{\\mathrm{o,est}}(N,\\phi_{\\mathrm{s}},\\alpha) - V_{\\mathrm{o,true}}(\\alpha)}{V_{\\mathrm{o,true}}(\\alpha)}$$\nThis dimensionless quantity will be computed for each of the five test cases specified in the problem statement. The implementation will use the derived analytical formula for $V_{\\mathrm{o,true}}$ and the described numerical procedure for $V_{\\mathrm{o,est}}$. The case where $V_{\\mathrm{o,true}}(\\alpha)=0$ (which occurs at $\\alpha=\\pi$) requires special handling to avoid division by zero, though none of the test cases feature this specific firing angle.",
            "answer": "[0.000302302,-0.001602410,-0.816690185,0.001090159,-0.007600877]"
        }
    ]
}