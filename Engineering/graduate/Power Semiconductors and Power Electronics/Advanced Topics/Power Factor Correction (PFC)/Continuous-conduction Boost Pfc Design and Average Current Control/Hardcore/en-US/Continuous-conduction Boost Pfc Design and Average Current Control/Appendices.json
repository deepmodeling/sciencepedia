{
    "hands_on_practices": [
        {
            "introduction": "The boost inductor is a cornerstone of the PFC power stage, responsible for intermediate energy storage and shaping the input current. A primary design task is selecting an inductance value that ensures the converter operates in the desired Continuous Conduction Mode (CCM) across its intended operating range. This practice guides you through the fundamental calculation of the minimum required inductance based on a specified current ripple percentage, a critical first step in any PFC design .",
            "id": "3829458",
            "problem": "A single-phase boost Power Factor Correction (PFC) pre-regulator operating in Continuous Conduction Mode (CCM) with Average Current Control is supplied from a sinusoidal line of root-mean-square voltage $V_{\\text{rms}} = 230 \\, \\text{V}$ and regulates a direct-current output voltage $V_{\\text{out}} = 400 \\, \\text{V}$. The output power is $P_{\\text{out}} = 1000 \\, \\text{W}$, and the switching frequency is $f_{s} = 100000 \\, \\text{Hz}$. Assume ideal components (zero semiconductor voltage drops, lossless inductor and switch, and negligible input filter effects), unity power factor such that the input current is proportional to the instantaneous input voltage, and steady-state operation. The inductor current ripple specification is that the peak-to-peak inductor current ripple $\\Delta i_{L}$ must satisfy $\\Delta i_{L}/I_{L,\\text{avg}}\\leq 0.10$ at the low-line peak of the rectified sinusoid.\n\nUsing only fundamental laws, namely the inductor law $v_{L}=L\\,\\frac{di_{L}}{dt}$, volt-second balance over one switching period, and the definition of root-mean-square and peak values for sinusoidal quantities, determine the minimum inductance $L$ that satisfies the ripple criterion at the low-line peak. Express your final inductance in millihenries (mH) and round your answer to four significant figures.",
            "solution": "The problem asks for the minimum inductance $L$ for a continuous-conduction mode (CCM) boost Power Factor Correction (PFC) pre-regulator that satisfies a specific inductor current ripple criterion. The solution will be derived from fundamental principles as requested.\n\nFirst, the givens are extracted and validated.\nInput root-mean-square voltage: $V_{\\text{rms}} = 230 \\, \\text{V}$\nOutput direct-current voltage: $V_{\\text{out}} = 400 \\, \\text{V}$\nOutput power: $P_{\\text{out}} = 1000 \\, \\text{W}$\nSwitching frequency: $f_{s} = 100000 \\, \\text{Hz}$\nRipple criterion: $\\frac{\\Delta i_{L}}{I_{L,\\text{avg}}} \\leq 0.10$ at the low-line peak.\n\nAssumptions: ideal components, unity power factor, steady-state operation. The problem is scientifically sound, well-posed, objective, and contains sufficient information for a unique solution under the interpretation that \"low-line peak\" refers to the peak of the specified sinusoidal input voltage. Thus, the problem is valid.\n\nThe instantaneous input voltage from the line is a sinusoid $v_{\\text{in}}(t) = V_{\\text{pk}} \\sin(\\omega t)$, where the peak voltage $V_{\\text{pk}}$ is related to the RMS voltage by $V_{\\text{pk}} = \\sqrt{2} V_{\\text{rms}}$. The PFC circuit's input is the rectified line voltage, $v_g(t) = |v_{\\text{in}}(t)| = V_{\\text{pk}} |\\sin(\\omega t)|$.\n\nDue to the unity power factor requirement, the average input current (which is the average inductor current, $i_{L, \\text{avg}}(t)$) is in phase with and proportional to the rectified input voltage $v_g(t)$. We can write $i_{L, \\text{avg}}(t) = I_{\\text{pk}} |\\sin(\\omega t)|$, where $I_{\\text{pk}}$ is the peak of the average inductor current envelope.\n\nAssuming an ideal converter (100% efficiency), the average input power $P_{\\text{in}}$ equals the output power $P_{\\text{out}}$. The average input power is the product of the RMS input voltage and RMS input current, $P_{\\text{in}} = V_{\\text{rms}} I_{\\text{rms}}$. The peak input current $I_{\\text{pk}}$ is related to the RMS current by $I_{\\text{pk}} = \\sqrt{2} I_{\\text{rms}}$. We can express $I_{\\text{pk}}$ in terms of the output power and peak voltage:\n$P_{\\text{out}} = P_{\\text{in}} = V_{\\text{rms}} I_{\\text{rms}} = \\frac{V_{\\text{pk}}}{\\sqrt{2}} \\frac{I_{\\text{pk}}}{\\sqrt{2}} = \\frac{V_{\\text{pk}} I_{\\text{pk}}}{2}$.\nSolving for $I_{\\text{pk}}$:\n$$I_{\\text{pk}} = \\frac{2 P_{\\text{out}}}{V_{\\text{pk}}}$$\n\nFor a boost converter operating in CCM, the steady-state voltage conversion ratio over a switching cycle is given by $\\frac{V_{\\text{out}}}{v_g(t)} = \\frac{1}{1 - d(t)}$, where $d(t)$ is the duty cycle of the main switch. This relationship stems directly from the volt-second balance principle on the inductor over one switching period $T_s = 1/f_s$. The duty cycle must vary over the AC line cycle to maintain a constant $V_{\\text{out}}$:\n$$d(t) = 1 - \\frac{v_g(t)}{V_{\\text{out}}}$$\n\nThe peak-to-peak inductor current ripple, $\\Delta i_{L}(t)$, is determined by the inductor voltage and the duration for which it is applied. Using the fundamental inductor law $v_{L} = L \\frac{di_{L}}{dt}$, we can approximate the change in current, $\\Delta i_{L}$, as $\\frac{v_L \\Delta t}{L}$. When the switch is on (for a duration $\\Delta t = d(t) T_s$), the voltage across the inductor is $v_L = v_g(t)$. The current ramps up, and the peak-to-peak ripple is equal to this rise in current:\n$$\\Delta i_{L}(t) = \\frac{v_g(t) d(t) T_s}{L}$$\nSubstituting the expression for $d(t)$:\n$$\\Delta i_{L}(t) = \\frac{v_g(t) T_s}{L} \\left(1 - \\frac{v_g(t)}{V_{\\text{out}}}\\right)$$\nThis equation shows that the ripple magnitude $\\Delta i_{L}(t)$ varies throughout the AC line half-cycle as $v_g(t)$ changes.\n\nThe problem requires us to evaluate the ripple criterion at the \"low-line peak,\" which is the instant when the rectified voltage $v_g(t)$ is at its maximum value, $V_{\\text{pk}}$. At this point:\n$v_g = V_{\\text{pk}} = \\sqrt{2} V_{\\text{rms}}$\n$i_{L, \\text{avg}} = I_{\\text{pk}}$\nThe inductor current ripple at this instant, $\\Delta i_{L, \\text{pk}}$, is:\n$$\\Delta i_{L, \\text{pk}} = \\frac{V_{\\text{pk}} T_s}{L} \\left(1 - \\frac{V_{\\text{pk}}}{V_{\\text{out}}}\\right)$$\n\nThe ripple criterion is $\\frac{\\Delta i_{L}}{I_{L,\\text{avg}}} \\leq 0.10$. At the specified point, this becomes $\\frac{\\Delta i_{L, \\text{pk}}}{I_{\\text{pk}}} \\leq 0.10$. To find the minimum inductance $L$ that satisfies this, we use the equality:\n$$\\frac{\\Delta i_{L, \\text{pk}}}{I_{\\text{pk}}} = 0.10$$\nSubstituting the expressions for $\\Delta i_{L, \\text{pk}}$ and $I_{\\text{pk}}$:\n$$\\frac{\\frac{V_{\\text{pk}} T_s}{L} \\left(1 - \\frac{V_{\\text{pk}}}{V_{\\text{out}}}\\right)}{\\frac{2 P_{\\text{out}}}{V_{\\text{pk}}}} = 0.10$$\nSolving for $L$:\n$$L = \\frac{V_{\\text{pk}}^2 T_s}{0.10 \\times 2 P_{\\text{out}}} \\left(1 - \\frac{V_{\\text{pk}}}{V_{\\text{out}}}\\right)$$\n$$L = \\frac{V_{\\text{pk}}^2}{0.2 \\cdot P_{\\text{out}} \\cdot f_s} \\left(1 - \\frac{V_{\\text{pk}}}{V_{\\text{out}}}\\right)$$\n\nNow, we substitute the given numerical values:\n$V_{\\text{rms}} = 230 \\, \\text{V}$\n$V_{\\text{out}} = 400 \\, \\text{V}$\n$P_{\\text{out}} = 1000 \\, \\text{W}$\n$f_s = 100000 \\, \\text{Hz}$\n\nFirst, calculate the peak input voltage $V_{\\text{pk}}$:\n$$V_{\\text{pk}} = \\sqrt{2} \\times 230 \\, \\text{V} \\approx 325.269 \\, \\text{V}$$\nThe square of the peak voltage is:\n$$V_{\\text{pk}}^2 = (\\sqrt{2} \\times 230)^2 = 2 \\times 230^2 = 105800 \\, \\text{V}^2$$\n\nNow, substitute all values into the expression for $L$:\n$$L = \\frac{105800}{0.2 \\times 1000 \\times 100000} \\left(1 - \\frac{\\sqrt{2} \\times 230}{400}\\right)$$\n$$L = \\frac{105800}{2 \\times 10^7} \\left(1 - \\frac{325.269...}{400}\\right)$$\n$$L = 5.29 \\times 10^{-3} \\left(1 - 0.81317...\\right)$$\n$$L = 5.29 \\times 10^{-3} \\left(0.186827...\\right)$$\n$$L \\approx 0.000988316 \\, \\text{H}$$\n\nThe problem requires the answer in millihenries (mH), so we multiply by $1000$:\n$$L \\approx 0.988316 \\, \\text{mH}$$\nRounding to four significant figures gives:\n$$L \\approx 0.9883 \\, \\text{mH}$$",
            "answer": "$$\\boxed{0.9883}$$"
        },
        {
            "introduction": "While initial designs often assume ideal components, a practical converter's performance is ultimately governed by power losses. Understanding and quantifying these losses is essential for calculating efficiency and designing an effective thermal management system. This exercise focuses on the boost diode, demonstrating how to use datasheet parameters like forward voltage ($V_{F}$) and reverse recovery charge ($Q_{rr}$) to estimate the two primary loss components: conduction loss and switching loss .",
            "id": "3829537",
            "problem": "A continuous-conduction-mode (CCM) single-phase boost Power Factor Correction (PFC) stage employing average current control is supplied from an alternating current mains of $V_{\\text{in,rms}} = 230\\,\\text{V}$ at $50\\,\\text{Hz}$ and regulates a direct current output of $V_{\\text{out}} = 390\\,\\text{V}$. The boost switch is a Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET), and the boost diode is an ultrafast silicon diode. The converter delivers a constant output power of $P_{\\text{out}} = 780\\,\\text{W}$ at steady state with near-unity power factor and negligible ripple at the switching frequency on the output.\n\nThe diode datasheet specifies the forward characteristic such that at a forward current of $I_{F} = 2.0\\,\\text{A}$ the forward voltage drop is $V_{F} = 0.95\\,\\text{V}$ at a junction temperature of $25^{\\circ}\\text{C}$. The reverse recovery charge is specified as $Q_{\\text{rr}} = 40\\,\\text{nC}$ for a representative current slew rate and operating point matching the application. The switching frequency is $f_{s} = 100\\,\\text{kHz}$, and the inductor value ensures CCM across the entire line cycle.\n\nStarting from the definition of instantaneous power $p(t) = v(t)i(t)$ and the time-average of power over one period, and using the datasheet definition of reverse recovery charge $Q_{\\text{rr}} = \\int i_{\\text{rr}}(t)\\,\\mathrm{d}t$, derive expressions to estimate the average diode power dissipation due to forward conduction and reverse recovery. For reverse recovery, assume the diode sees approximately a constant reverse voltage equal to $V_{\\text{out}}$ during the recovery interval and that one recovery event occurs each switching cycle.\n\nCompute the total average diode power loss by summing the forward conduction and reverse recovery contributions under these assumptions. Round your final result to four significant figures and express it in $\\text{W}$.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It contains sufficient information to derive a unique and meaningful solution under standard engineering approximations pertinent to the field of power electronics. All provided parameters are physically realistic for a boost Power Factor Correction (PFC) converter operating under the specified conditions.\n\nThe total average power dissipation in the boost diode, $P_{D,\\text{total}}$, is the sum of the average power loss due to forward conduction, $P_{D,\\text{cond}}$, and the average power loss due to reverse recovery, $P_{D,\\text{rr}}$.\n$$P_{D,\\text{total}} = P_{D,\\text{cond}} + P_{D,\\text{rr}}$$\n\nWe will derive expressions for each component and then compute the total loss.\n\n**1. Average Diode Conduction Power Loss ($P_{D,\\text{cond}}$)**\n\nThe starting point is the definition of the time-average of power over one period of the AC mains, $T_{\\text{line}} = 1/f_{\\text{line}}$, where $f_{\\text{line}} = 50\\,\\text{Hz}$.\n$$P_{D,\\text{cond}} = \\frac{1}{T_{\\text{line}}} \\int_{0}^{T_{\\text{line}}} p_{D,\\text{cond}}(t)\\,\\mathrm{d}t$$\nThe instantaneous power dissipation during conduction is $p_{D,\\text{cond}}(t) = v_{F}(t) i_{D}(t)$, where $v_{F}(t)$ is the instantaneous forward voltage drop across the diode and $i_{D}(t)$ is the instantaneous current flowing through it.\n\nA common and practical model for estimating conduction losses involves approximating the diode's forward voltage as a constant value, $V_{F}$. This approximation is most representative when $V_{F}$ is chosen as the forward drop at the average current flowing through the component. With $v_{F}(t) \\approx V_{F}$, the expression for average power becomes:\n$$P_{D,\\text{cond}} \\approx V_{F} \\left( \\frac{1}{T_{\\text{line}}} \\int_{0}^{T_{\\text{line}}} i_{D}(t)\\,\\mathrm{d}t \\right)$$\nThe integral term is, by definition, the average current through the diode over a line cycle, denoted as $I_{D,\\text{avg}}$. In a boost converter supplying a DC load, the diode provides the current to both the load and the output capacitor. Over a full line cycle in steady state, the net charge supplied to the output capacitor is zero. Therefore, the average current supplied by the diode must equal the average current drawn by the load, $I_{\\text{out}}$.\n$$I_{D,\\text{avg}} = \\frac{1}{T_{\\text{line}}} \\int_{0}^{T_{\\text{line}}} i_{D}(t)\\,\\mathrm{d}t = I_{\\text{out}}$$\nThe output current is determined by the constant output power $P_{\\text{out}}$ and the regulated output voltage $V_{\\text{out}}$:\n$$I_{\\text{out}} = \\frac{P_{\\text{out}}}{V_{\\text{out}}}$$\nCombining these results, we derive the expression for the average conduction loss:\n$$P_{D,\\text{cond}} = V_{F} \\cdot I_{\\text{out}} = V_{F} \\left(\\frac{P_{\\text{out}}}{V_{\\text{out}}}\\right)$$\nThe problem provides that for a forward current $I_{F} = 2.0\\,\\text{A}$, the forward voltage is $V_{F} = 0.95\\,\\text{V}$. Let us calculate the average output current:\n$$I_{\\text{out}} = \\frac{780\\,\\text{W}}{390\\,\\text{V}} = 2.0\\,\\text{A}$$\nSince the average diode current matches the test current provided in the datasheet, we use $V_{F} = 0.95\\,\\text{V}$ for our calculation.\n$$P_{D,\\text{cond}} = (0.95\\,\\text{V}) \\times (2.0\\,\\text{A}) = 1.9\\,\\text{W}$$\n\n**2. Average Diode Reverse Recovery Power Loss ($P_{D,\\text{rr}}$)**\n\nReverse recovery loss occurs each time the diode transitions from a forward-biased (conducting) state to a reverse-biased (blocking) state. This happens once per switching cycle. The energy dissipated during a single reverse recovery event, $E_{\\text{rr}}$, is given by the integral of the instantaneous power during the recovery interval $t_{\\text{rr}}$:\n$$E_{\\text{rr}} = \\int_{0}^{t_{\\text{rr}}} v_{R}(t) i_{\\text{rr}}(t)\\,\\mathrm{d}t$$\nHere, $v_{R}(t)$ is the reverse voltage across the diode and $i_{\\text{rr}}(t)$ is the reverse recovery current. The problem states to assume a constant reverse voltage equal to $V_{\\text{out}}$. Thus, $v_{R}(t) \\approx V_{\\text{out}}$.\n$$E_{\\text{rr}} \\approx V_{\\text{out}} \\int_{0}^{t_{\\text{rr}}} i_{\\text{rr}}(t)\\,\\mathrm{d}t$$\nThe integral of the reverse recovery current is the definition of the reverse recovery charge, $Q_{\\text{rr}}$.\n$$Q_{\\text{rr}} = \\int_{0}^{t_{\\text{rr}}} i_{\\text{rr}}(t)\\,\\mathrm{d}t$$\nTherefore, the energy loss per switching cycle is:\n$$E_{\\text{rr}} = Q_{\\text{rr}} V_{\\text{out}}$$\nThe average power dissipation is the energy lost per cycle multiplied by the number of cycles per second, which is the switching frequency $f_{s}$.\n$$P_{D,\\text{rr}} = E_{\\text{rr}} \\cdot f_{s} = Q_{\\text{rr}} V_{\\text{out}} f_{s}$$\nUsing the given values:\n$Q_{\\text{rr}} = 40\\,\\text{nC} = 40 \\times 10^{-9}\\,\\text{C}$\n$V_{\\text{out}} = 390\\,\\text{V}$\n$f_{s} = 100\\,\\text{kHz} = 100 \\times 10^{3}\\,\\text{Hz}$\nWe can compute the reverse recovery loss:\n$$P_{D,\\text{rr}} = (40 \\times 10^{-9}\\,\\text{C}) \\times (390\\,\\text{V}) \\times (100 \\times 10^{3}\\,\\text{s}^{-1})$$\n$$P_{D,\\text{rr}} = (40 \\times 390 \\times 100) \\times 10^{-6}\\,\\text{W} = 1560000 \\times 10^{-6}\\,\\text{W} = 1.56\\,\\text{W}$$\n\n**3. Total Average Diode Power Loss**\n\nThe total average power loss in the diode is the sum of the conduction and reverse recovery losses.\n$$P_{D,\\text{total}} = P_{D,\\text{cond}} + P_{D,\\text{rr}} = 1.9\\,\\text{W} + 1.56\\,\\text{W} = 3.46\\,\\text{W}$$\nThe problem requires the final result to be rounded to four significant figures.\n$$P_{D,\\text{total}} = 3.460\\,\\text{W}$$",
            "answer": "$$\\boxed{3.460}$$"
        },
        {
            "introduction": "In a single-phase PFC, the instantaneous input power pulsates at twice the line frequency, while the load demands constant power, creating an unavoidable energy ripple that must be buffered by the output capacitor. This exercise delves into the subtle but important consequence of the resulting output voltage ripple: the distortion of the input current, even with an 'ideal' average current controller. By analyzing how this ripple modulates the current reference, you will quantify the inherent degradation in power factor, gaining a deeper understanding of the performance limits of this topology .",
            "id": "3829571",
            "problem": "A single-phase continuous-conduction boost Power Factor Correction (PFC) rectifier using average current control is supplied by an input line voltage $v_{g}(t) = V_{\\mathrm{m}} \\sin(\\omega t)$, where $V_{\\mathrm{m}} = \\sqrt{2} V_{\\mathrm{rms}}$ and $\\omega$ is the angular line frequency. The output is regulated to a direct-current bus voltage $v_{o}(t)$ across a bulk capacitor of capacitance $C$ feeding a downstream load that draws constant power $P$. The average current control inner loop shapes the input current to track a reference proportional to the instantaneous input voltage divided by the measured output voltage, i.e., $i_{\\mathrm{in}}(t) \\propto v_{g}(t) / v_{o}(t)$, and can be considered ideal for the purposes of this analysis. The outer voltage loop is slow relative to the twice-line dynamics, so the twice-line ripple in $v_{o}(t)$ arises solely from energy buffering in the bulk capacitor. Assume $v_{o}(t)$ can be written as $v_{o}(t) = V_{0} + A \\sin(2 \\omega t)$ with $A/V_{0} \\ll 1$.\n\nStarting only from the following bases:\n- The instantaneous input power of an in-phase sinusoidal voltage and current is $p_{\\mathrm{in}}(t) = v_{g}(t)i_{\\mathrm{in}}(t)$.\n- The capacitor energy is $E(t) = \\frac{1}{2} C v_{o}^{2}(t)$ and obeys $\\frac{\\mathrm{d}E}{\\mathrm{d}t} = p_{\\mathrm{in}}(t) - P$ for a constant-power load $P$.\n- The ideal average current control inner loop enforces $i_{\\mathrm{in}}(t) \\propto v_{g}(t)/v_{o}(t)$.\n\nDerive the leading-order amplitude $A$ of the twice-line ripple in $v_{o}(t)$, then obtain the input current waveform to first order in the small parameter $\\beta = A/V_{0}$ and compute the resulting power factor $\\mathrm{PF}$ up to second order in $\\beta$ using the definition $\\mathrm{PF} = \\frac{P}{V_{\\mathrm{rms}} I_{\\mathrm{rms}}}$, where $V_{\\mathrm{rms}}$ and $I_{\\mathrm{rms}}$ are the root-mean-square values of $v_{g}(t)$ and $i_{\\mathrm{in}}(t)$, respectively. Finally, evaluate $\\mathrm{PF}$ numerically for\n$V_{\\mathrm{rms}} = 230\\,\\mathrm{V}$, $\\omega = 2\\pi \\cdot 50\\,\\mathrm{rad/s}$, $V_{0} = 400\\,\\mathrm{V}$, $C = 470\\,\\mu\\mathrm{F}$, and $P = 1000\\,\\mathrm{W}$. Round your final power factor to six significant figures. Express the final power factor as a decimal.",
            "solution": "The solution is structured in four parts: first, deriving the amplitude of the output voltage ripple; second, finding the input current waveform; third, deriving the power factor; and finally, performing the numerical calculation.\n\n**Part 1: Derivation of the Ripple Amplitude $A$**\n\nThe instantaneous input power to the PFC converter is $p_{\\mathrm{in}}(t) = v_g(t)i_{in}(t)$. Given the ideal average current control, the input current $i_{\\mathrm{in}}(t)$ is shaped to be proportional to $v_g(t)$ to achieve a high power factor. To leading order, we can ignore the output voltage ripple and assume $v_o(t) \\approx V_0$. The control law $i_{\\mathrm{in}}(t) \\propto v_{g}(t)/v_{o}(t)$ then implies $i_{\\mathrm{in}}(t) \\approx I_m \\sin(\\omega t)$, making the converter emulate a resistor.\nThe input power is $p_{\\mathrm{in}}(t) = v_g(t) i_{in}(t) \\approx (V_m \\sin(\\omega t))(I_m \\sin(\\omega t)) = V_m I_m \\sin^2(\\omega t)$.\nUsing the identity $\\sin^2(\\theta) = \\frac{1}{2}(1-\\cos(2\\theta))$, we get:\n$$p_{\\mathrm{in}}(t) = \\frac{V_m I_m}{2}(1 - \\cos(2\\omega t))$$\nThe average input power must equal the output power $P$. Since the average of $\\cos(2\\omega t)$ over a cycle is zero, we have $P = \\langle p_{\\mathrm{in}}(t) \\rangle = \\frac{V_m I_m}{2}$.\nThus, the instantaneous input power can be expressed in terms of the average power $P$ as:\n$$p_{\\mathrm{in}}(t) = P(1 - \\cos(2\\omega t))$$\nThis expression is accurate to zeroth order in the output voltage ripple. The power flowing into the bulk capacitor is the difference between the instantaneous input power and the constant load power $P$:\n$$\\frac{\\mathrm{d}E}{\\mathrm{d}t} = p_{\\mathrm{in}}(t) - P = -P \\cos(2\\omega t)$$\nThe energy stored in the capacitor is $E(t) = \\frac{1}{2} C v_{o}^{2}(t)$. We differentiate this with respect to time:\n$$\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left(\\frac{1}{2} C v_{o}^{2}(t)\\right) = C v_{o}(t) \\frac{\\mathrm{d}v_{o}}{\\mathrm{d}t}$$\nGiven the form $v_{o}(t) = V_{0} + A \\sin(2 \\omega t)$, its derivative is $\\frac{\\mathrm{d}v_{o}}{\\mathrm{d}t} = 2\\omega A \\cos(2\\omega t)$.\nSubstituting this and approximating $v_o(t) \\approx V_0$ (since $A/V_0 \\ll 1$), we obtain a first-order approximation for the rate of change of energy:\n$$\\frac{\\mathrm{d}E}{\\mathrm{d}t} \\approx C V_0 (2\\omega A \\cos(2\\omega t)) = 2\\omega C A V_0 \\cos(2\\omega t)$$\nEquating the two expressions for $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$:\n$$2\\omega C A V_0 \\cos(2\\omega t) = -P \\cos(2\\omega t)$$\nSolving for the ripple amplitude $A$ gives:\n$$A = -\\frac{P}{2\\omega C V_0}$$\n\n**Part 2: Input Current Waveform $i_{\\mathrm{in}}(t)$**\n\nThe average current control law is $i_{\\mathrm{in}}(t) = K \\frac{v_g(t)}{v_o(t)}$ for some proportionality constant $K$.\nSubstituting the given forms for $v_g(t)$ and $v_o(t)$:\n$$i_{\\mathrm{in}}(t) = K \\frac{V_m \\sin(\\omega t)}{V_0 + A \\sin(2\\omega t)} = \\frac{K V_m}{V_0} \\frac{\\sin(\\omega t)}{1 + (A/V_0) \\sin(2\\omega t)}$$\nLetting $\\beta = A/V_0$, and using the Taylor expansion $(1+x)^{-1} \\approx 1-x$ for small $x$:\n$$i_{\\mathrm{in}}(t) \\approx \\frac{K V_m}{V_0} \\sin(\\omega t) (1 - \\beta \\sin(2\\omega t))$$\nTo find $K$, we enforce the average power condition $P = \\langle p_{\\mathrm{in}}(t) \\rangle = \\langle v_g(t) i_{\\mathrm{in}}(t) \\rangle$.\n$$P = \\left\\langle (V_m \\sin(\\omega t)) \\left( \\frac{K V_m}{V_0} \\sin(\\omega t) (1 - \\beta \\sin(2\\omega t)) \\right) \\right\\rangle$$\n$$P = \\frac{K V_m^2}{V_0} \\langle \\sin^2(\\omega t) - \\beta \\sin^2(\\omega t)\\sin(2\\omega t) \\rangle$$\nThe average of $\\sin^2(\\omega t)$ is $1/2$. The average of the second term is $\\langle \\sin^2(\\omega t)\\sin(2\\omega t) \\rangle = \\langle \\frac{1}{2}(1-\\cos(2\\omega t)) \\sin(2\\omega t) \\rangle = \\frac{1}{2}\\langle \\sin(2\\omega t) - \\cos(2\\omega t)\\sin(2\\omega t) \\rangle = 0$.\nSo, the average power is $P = \\frac{K V_m^2}{V_0} \\frac{1}{2}$, which gives $K = \\frac{2PV_0}{V_m^2}$.\nSubstituting $K$ back into the expression for $i_{\\mathrm{in}}(t)$:\n$$i_{\\mathrm{in}}(t) \\approx \\frac{2PV_0}{V_m^2} \\frac{V_m}{V_0} \\sin(\\omega t) (1 - \\beta \\sin(2\\omega t)) = \\frac{2P}{V_m} \\sin(\\omega t) (1 - \\beta \\sin(2\\omega t))$$\nLet $I_m = 2P/V_m$ be the peak current of an ideal PFC.\n$$i_{\\mathrm{in}}(t) \\approx I_m (\\sin(\\omega t) - \\beta \\sin(\\omega t)\\sin(2\\omega t))$$\nUsing the product-to-sum identity $\\sin(\\alpha)\\sin(\\beta) = \\frac{1}{2}(\\cos(\\alpha-\\beta)-\\cos(\\alpha+\\beta))$:\n$$\\sin(\\omega t)\\sin(2\\omega t) = \\frac{1}{2}(\\cos(\\omega t) - \\cos(3\\omega t))$$\nThe input current to first order in $\\beta$ is:\n$$i_{\\mathrm{in}}(t) \\approx I_m \\left( \\sin(\\omega t) - \\frac{\\beta}{2}\\cos(\\omega t) + \\frac{\\beta}{2}\\cos(3\\omega t) \\right)$$\nThis shows the current contains the desired fundamental component, a quadrature fundamental component (causing phase shift), and a third harmonic component (causing distortion).\n\n**Part 3: Power Factor $\\mathrm{PF}$ up to Second Order in $\\beta$**\n\nThe power factor is $\\mathrm{PF} = \\frac{P}{V_{\\mathrm{rms}} I_{\\mathrm{rms}}}$. We need to find $I_{\\mathrm{rms}}$.\n$$I_{\\mathrm{rms}}^2 = \\langle i_{\\mathrm{in}}^2(t) \\rangle = \\left\\langle I_m^2 \\left( \\sin(\\omega t) - \\frac{\\beta}{2}\\cos(\\omega t) + \\frac{\\beta}{2}\\cos(3\\omega t) \\right)^2 \\right\\rangle$$\nWhen squaring and averaging, due to orthogonality, the cross-product terms of sinusoids with different frequencies average to zero. Thus, we only need to average the squared terms:\n$$I_{\\mathrm{rms}}^2 = I_m^2 \\left[ \\langle\\sin^2(\\omega t)\\rangle + \\left\\langle\\left(-\\frac{\\beta}{2}\\cos(\\omega t)\\right)^2\\right\\rangle + \\left\\langle\\left(\\frac{\\beta}{2}\\cos(3\\omega t)\\right)^2\\right\\rangle \\right]$$\n$$I_{\\mathrm{rms}}^2 = I_m^2 \\left[ \\frac{1}{2} + \\frac{\\beta^2}{4}\\langle\\cos^2(\\omega t)\\rangle + \\frac{\\beta^2}{4}\\langle\\cos^2(3\\omega t)\\rangle \\right]$$\nSince $\\langle\\cos^2(\\theta)\\rangle = 1/2$:\n$$I_{\\mathrm{rms}}^2 = I_m^2 \\left[ \\frac{1}{2} + \\frac{\\beta^2}{8} + \\frac{\\beta^2}{8} \\right] = \\frac{I_m^2}{2} \\left(1 + \\frac{\\beta^2}{2}\\right)$$\nSo, $I_{\\mathrm{rms}} = \\sqrt{\\frac{I_m^2}{2} \\left(1 + \\frac{\\beta^2}{2}\\right)} = \\frac{I_m}{\\sqrt{2}} \\sqrt{1 + \\frac{\\beta^2}{2}}$.\nWe know $P = \\frac{V_m I_m}{2} = (\\frac{V_m}{\\sqrt{2}})(\\frac{I_m}{\\sqrt{2}}) = V_{\\mathrm{rms}} \\frac{I_m}{\\sqrt{2}}$.\nSubstituting into the PF formula:\n$$\\mathrm{PF} = \\frac{V_{\\mathrm{rms}} \\frac{I_m}{\\sqrt{2}}}{V_{\\mathrm{rms}} I_{\\mathrm{rms}}} = \\frac{V_{\\mathrm{rms}} \\frac{I_m}{\\sqrt{2}}}{V_{\\mathrm{rms}} \\frac{I_m}{\\sqrt{2}} \\sqrt{1 + \\frac{\\beta^2}{2}}} = \\frac{1}{\\sqrt{1 + \\frac{\\beta^2}{2}}}$$\nUsing the expansion $(1+x)^{-1/2} \\approx 1 - x/2$ for small $x$, we get the power factor up to second order in $\\beta$:\n$$\\mathrm{PF} \\approx 1 - \\frac{\\beta^2}{4}$$\nWe have $\\beta = A/V_0$ and $A = -P/(2\\omega C V_0)$, so $\\beta = -\\frac{P}{2\\omega C V_0^2}$.\n$$\\mathrm{PF} \\approx 1 - \\frac{1}{4} \\left( -\\frac{P}{2\\omega C V_0^2} \\right)^2 = 1 - \\frac{P^2}{16 \\omega^2 C^2 V_0^4}$$\n\n**Part 4: Numerical Evaluation**\n\nGiven values:\n- $P = 1000\\,\\mathrm{W}$\n- $\\omega = 2\\pi \\cdot 50 = 100\\pi\\,\\mathrm{rad/s}$\n- $C = 470 \\times 10^{-6}\\,\\mathrm{F}$\n- $V_{0} = 400\\,\\mathrm{V}$\n\nFirst, we calculate the parameter $\\beta$:\n$$\\beta = -\\frac{P}{2\\omega C V_0^2} = -\\frac{1000}{2 \\cdot (100\\pi) \\cdot (470 \\times 10^{-6}) \\cdot (400)^2}$$\n$$\\beta = -\\frac{1000}{200\\pi \\cdot (470 \\times 10^{-6}) \\cdot 160000} = -\\frac{1000}{200\\pi \\cdot 470 \\cdot 16 \\cdot 10^{-2}}$$\n$$\\beta = -\\frac{1000}{14960 \\pi} \\approx -\\frac{1000}{47249.5534} \\approx -0.02116422$$\nNow, we can compute the power factor:\n$$\\mathrm{PF} \\approx 1 - \\frac{\\beta^2}{4} = 1 - \\frac{(-0.02116422)^2}{4}$$\n$$\\mathrm{PF} \\approx 1 - \\frac{0.0004479246}{4} = 1 - 0.00011198115$$\n$$\\mathrm{PF} \\approx 0.99988801885$$\nRounding to six significant figures, the power factor is $0.999888$.",
            "answer": "$$ \\boxed{0.999888} $$"
        }
    ]
}