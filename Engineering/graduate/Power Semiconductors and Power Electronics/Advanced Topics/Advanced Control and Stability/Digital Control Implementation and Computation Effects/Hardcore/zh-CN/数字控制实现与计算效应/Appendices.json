{
    "hands_on_practices": [
        {
            "introduction": "为了在数字处理器上实现控制器，我们必须首先将连续时间系统模型转换为离散时间等效模型。双线性变换（或Tustin变换）是一种常用的离散化方法，但它会引入一种称为“频率整形”的非理想效应。本练习旨在通过对一个典型的降压变换器进行建模，让您亲手推导离散传递函数，并定量分析在关键频率点（如穿越频率）附近频率整形所带来的影响()。",
            "id": "3833389",
            "problem": "一个工作在连续导通模式下的降压转换器由一个数字电压环路调节。转换器的参数为：输入电压 $V_{g} = 12\\,\\mathrm{V}$，电感 $L = 100\\,\\mu\\mathrm{H}$，输出电容 $C = 47\\,\\mu\\mathrm{F}$，以及阻性负载 $R = 5\\,\\Omega$。假设输出电容为理想电容，其等效串联电阻可忽略不计，且开关频率足够高，使得标准状态空间平均模型适用于小信号分析。脉冲宽度调制（PWM）与数字控制器的采样同步，采样周期为 $T_{s} = 20\\,\\mu\\mathrm{s}$。\n\n从平均电感-电容动态方程和围绕稳态工作点的小信号线性化出发，要求根据第一性原理推导出电压环路的连续时间小信号控制到输出的被控对象传递函数 $G_{vd}(s)$。然后，使用Tustin双线性变换离散化方法（不进行预畸变），推导出离散时间传递函数 $G_{vd}(z)$，其形式为关于 $z^{-1}$ 且系数为实数的有理函数。最后，根据第一性原理的频率映射关系，讨论对于给定的采样周期，双线性频率畸变如何影响期望的连续时间穿越角频率 $\\omega_{c} = 10{,}000\\,\\mathrm{rad/s}$ 附近的环路特性，并量化期望的模拟频率 $\\omega_{c}$ 与其离散时间镜像之间的相对偏差（将此偏差表示为小数）。\n\n将最终答案表示为关于 $z^{-1}$ 的单一简化表达式 $G_{vd}(z)$。$G_{vd}(z)$ 的系数无需四舍五入。在讨论中，所有角频率均使用弧度/秒，最终表达式中不包含任何单位。",
            "solution": "用户要求我解决一个电力电子系统数字控制领域的问题。\n\n### **问题验证**\n\n**步骤1：提取给定条件**\n- **系统**：连续导通模式（CCM）降压转换器。\n- **调节方式**：数字电压环路。\n- **转换器参数**：\n    - 输入电压: $V_g = 12\\,\\mathrm{V}$\n    - 电感: $L = 100\\,\\mu\\mathrm{H} = 1 \\times 10^{-4}\\,\\mathrm{H}$\n    - 输出电容: $C = 47\\,\\mu\\mathrm{F} = 4.7 \\times 10^{-5}\\,\\mathrm{F}$\n    - 阻性负载: $R = 5\\,\\Omega$\n- **假设**：\n    - 理想输出电容（等效串联电阻可忽略）。\n    - 开关频率高，验证了状态空间平均模型可用于小信号分析。\n- **数字控制参数**：\n    - 采样周期: $T_s = 20\\,\\mu\\mathrm{s} = 2 \\times 10^{-5}\\,\\mathrm{s}$\n    - PWM与采样同步。\n- **任务**：\n    1. 根据第一性原理推导连续时间小信号控制到输出的被控对象传递函数 $G_{vd}(s)$。\n    2. 使用Tustin双线性变换推导离散时间传递函数 $G_{vd}(z)$。\n    3. 讨论在 $\\omega_c = 10{,}000\\,\\mathrm{rad/s}$ 附近的频率畸变，并量化相对偏差。\n- **输出格式**：\n    - $G_{vd}(z)$ 表示为关于 $z^{-1}$ 的有理函数，系数为实数，不四舍五入。\n    - 最终答案仅为 $G_{vd}(z)$ 的表达式。\n\n**步骤2：使用提取的条件进行验证**\n根据验证标准对问题进行评估：\n\n- **科学性**：该问题基于直流-直流转换器状态空间平均法和数字控制理论（Tustin变换、频率畸变）的标准和成熟理论。这些是电力电子和控制系统工程中的基本概念。该模型是降压转换器的标准表示。参数是物理上现实的。该问题具有科学合理性。\n- **良构性**：该问题提供了确定连续时间和离散时间传递函数所需的所有必要参数（$V_g$, $L$, $C$, $R$, $T_s$）。任务定义明确，可得出唯一解。频率畸变的分析是一个具有确定结果的标准过程。\n- **客观性**：语言精确且技术性强。它使用了电力电子和控制理论领域的标准术语，没有主观解释的余地。\n- **完整性**：虽然没有给出稳态占空比 $D$ 或输出电压 $V_{out}$，但对于理想降压转换器，控制到输出传递函数 $G_{vd}(s)$ 的推导不依赖于这些参数，因为扰动项与恒定的输入电压 $V_g$ 成正比。因此，该问题是自洽的。\n- **无其他缺陷**（不切实际、病态、过于简单等）。\n\n**步骤3：结论与行动**\n该问题是**有效**的。将继续进行求解过程。\n\n### **求解推导**\n\n求解过程按要求分为三部分：推导连续时间被控对象模型、对其进行离散化以及分析频率畸变。\n\n**第1部分：连续时间小信号模型 $G_{vd}(s)$**\n\n工作在CCM模式下的降压转换器的状态空间平均模型由电感电流 $i_L(t)$ 和电容电压 $v_C(t)$ 的动态方程给出。状态向量为 $\\mathbf{x}(t) = [i_L(t) \\quad v_C(t)]^T$。控制输入是占空比 $d(t)$。\n\n平均状态方程为：\n$$\nL \\frac{di_L}{dt} = d \\cdot V_g - v_C\n$$\n$$\nC \\frac{dv_C}{dt} = i_L - \\frac{v_C}{R}\n$$\n\n我们将这些方程在一个稳态工作点附近进行线性化，该工作点通过将时间导数设为零来定义。设稳态（直流）值为 $I_L$、$V_C$ 和 $D$。时变数量表示为直流分量和小信号交流扰动（用帽子符号 `^` 表示）之和：\n$i_L(t) = I_L + \\hat{i}_L(t)$\n$v_C(t) = V_C + \\hat{v}_C(t)$\n$d(t) = D + \\hat{d}(t)$\n\n将这些代入状态方程并分离直流和交流项，得到小信号（交流）模型。直流项满足稳态方程：\n$0 = D \\cdot V_g - V_C$\n$0 = I_L - V_C/R$\n\n交流模型通过仅保留一阶扰动项获得：\n$$\nL \\frac{d\\hat{i}_L}{dt} = D \\cdot V_g + \\hat{d} \\cdot V_g - (V_C + \\hat{v}_C) \\implies L \\frac{d\\hat{i}_L}{dt} = (D \\cdot V_g - V_C) + \\hat{d} \\cdot V_g - \\hat{v}_C\n$$\n由于在稳态下 $D \\cdot V_g - V_C = 0$，上式简化为：\n$$\nL \\frac{d\\hat{i}_L}{dt} = \\hat{d} \\cdot V_g - \\hat{v}_C\n$$\n对于第二个方程：\n$$\nC \\frac{d\\hat{v}_C}{dt} = (I_L + \\hat{i}_L) - \\frac{V_C + \\hat{v}_C}{R} \\implies C \\frac{d\\hat{v}_C}{dt} = (I_L - \\frac{V_C}{R}) + \\hat{i}_L - \\frac{\\hat{v}_C}{R}\n$$\n由于在稳态下 $I_L - V_C/R = 0$，上式简化为：\n$$\nC \\frac{d\\hat{v}_C}{dt} = \\hat{i}_L - \\frac{\\hat{v}_C}{R}\n$$\n对交流方程进行拉普拉斯变换（零初始条件下），我们得到：\n$$\nsL\\hat{i}_L(s) = \\hat{d}(s)V_g - \\hat{v}_C(s) \\quad \\implies \\quad \\hat{i}_L(s) = \\frac{\\hat{d}(s)V_g - \\hat{v}_C(s)}{sL}\n$$\n$$\nsC\\hat{v}_C(s) = \\hat{i}_L(s) - \\frac{\\hat{v}_C(s)}{R}\n$$\n控制到输出的传递函数为 $G_{vd}(s) = \\frac{\\hat{v}_C(s)}{\\hat{d}(s)}$。我们将 $\\hat{i}_L(s)$ 的表达式代入第二个方程：\n$$\nsC\\hat{v}_C(s) = \\frac{\\hat{d}(s)V_g - \\hat{v}_C(s)}{sL} - \\frac{\\hat{v}_C(s)}{R}\n$$\n现在，我们对含 $\\hat{v}_C(s)$ 和 $\\hat{d}(s)$ 的项进行分组：\n$$\n\\hat{v}_C(s) \\left( sC + \\frac{1}{sL} + \\frac{1}{R} \\right) = \\hat{d}(s) \\frac{V_g}{sL}\n$$\n两边同乘以 $sL$：\n$$\n\\hat{v}_C(s) \\left( s^2LC + 1 + \\frac{sL}{R} \\right) = \\hat{d}(s) V_g\n$$\n因此，传递函数为：\n$$\nG_{vd}(s) = \\frac{\\hat{v}_C(s)}{\\hat{d}(s)} = \\frac{V_g}{s^2LC + s\\frac{L}{R} + 1}\n$$\n现在，我们代入给定的数值：\n$V_g = 12\\,\\mathrm{V}$\n$L = 1 \\times 10^{-4}\\,\\mathrm{H}$\n$C = 4.7 \\times 10^{-5}\\,\\mathrm{F}$\n$R = 5\\,\\Omega$\n\n分母的系数为：\n$LC = (1 \\times 10^{-4}\\,\\mathrm{H}) \\times (4.7 \\times 10^{-5}\\,\\mathrm{F}) = 4.7 \\times 10^{-9}\\,\\mathrm{s^2}$\n$\\frac{L}{R} = \\frac{1 \\times 10^{-4}\\,\\mathrm{H}}{5\\,\\Omega} = 2 \\times 10^{-5}\\,\\mathrm{s}$\n\n所以，连续时间传递函数为：\n$$\nG_{vd}(s) = \\frac{12}{4.7 \\times 10^{-9} s^2 + 2 \\times 10^{-5} s + 1}\n$$\n\n**第2部分：离散时间传递函数 $G_{vd}(z)$**\n\n我们使用Tustin双线性变换来离散化 $G_{vd}(s)$。该变换由下式给出：\n$$\ns = \\frac{2}{T_s} \\frac{1 - z^{-1}}{1 + z^{-1}}\n$$\n给定 $T_s = 2 \\times 10^{-5}\\,\\mathrm{s}$，我们有 $\\frac{2}{T_s} = \\frac{2}{2 \\times 10^{-5}} = 10^5\\,\\mathrm{s^{-1}}$。\n所以，$s = 10^5 \\frac{1 - z^{-1}}{1 + z^{-1}}$。\n\n让我们将此代入 $G_{vd}(s)$ 的表达式中。为清晰起见，设 $G_{vd}(s) = \\frac{V_g}{A s^2 + B s + 1}$，其中 $A = LC = 4.7 \\times 10^{-9}$ 且 $B = L/R = 2 \\times 10^{-5}$。\n$$\nG_{vd}(z) = \\frac{12}{A \\left(10^5 \\frac{1 - z^{-1}}{1 + z^{-1}}\\right)^2 + B \\left(10^5 \\frac{1 - z^{-1}}{1 + z^{-1}}\\right) + 1}\n$$\n为简化，我们将分子和分母同乘以 $(1 + z^{-1})^2$：\n$$\nG_{vd}(z) = \\frac{12 (1 + z^{-1})^2}{A (10^5)^2 (1 - z^{-1})^2 + B (10^5) (1 - z^{-1})(1 + z^{-1}) + (1 + z^{-1})^2}\n$$\n让我们计算分母中的系数：\n$A (10^5)^2 = (4.7 \\times 10^{-9}) \\times (10^{10}) = 47$\n$B (10^5) = (2 \\times 10^{-5}) \\times (10^5) = 2$\n\n分母变为：\n$D(z) = 47(1 - 2z^{-1} + z^{-2}) + 2(1 - z^{-2}) + 1(1 + 2z^{-1} + z^{-2})$\n我们按 $z^{-1}$ 的幂次收集项：\n$z^0$ 的系数: $47 \\times 1 + 2 \\times 1 + 1 \\times 1 = 47 + 2 + 1 = 50$\n$z^{-1}$ 的系数: $47 \\times (-2) + 2 \\times 0 + 1 \\times 2 = -94 + 2 = -92$\n$z^{-2}$ 的系数: $47 \\times 1 + 2 \\times (-1) + 1 \\times 1 = 47 - 2 + 1 = 46$\n所以，分母多项式为 $D(z) = 50 - 92z^{-1} + 46z^{-2}$。\n\n分子为：\n$N(z) = 12 (1 + z^{-1})^2 = 12(1 + 2z^{-1} + z^{-2}) = 12 + 24z^{-1} + 12z^{-2}$。\n\n离散时间传递函数为：\n$$\nG_{vd}(z) = \\frac{12 + 24z^{-1} + 12z^{-2}}{50 - 92z^{-1} + 46z^{-2}}\n$$\n为了将其表示为分母首项系数为1的标准形式，我们将分子和分母同除以 $50$：\n$$\nG_{vd}(z) = \\frac{\\frac{12}{50} + \\frac{24}{50}z^{-1} + \\frac{12}{50}z^{-2}}{1 - \\frac{92}{50}z^{-1} + \\frac{46}{50}z^{-2}}\n$$\n化简分数：\n$$\nG_{vd}(z) = \\frac{\\frac{6}{25} + \\frac{12}{25}z^{-1} + \\frac{6}{25}z^{-2}}{1 - \\frac{46}{25}z^{-1} + \\frac{23}{25}z^{-2}}\n$$\n这就是 $G_{vd}(z)$ 所要求的表达式。\n\n**第3部分：频率畸变分析**\n\n双线性变换将连续时间域的虚轴 $s=j\\omega_c$ 映射到离散时间域的单位圆 $z=e^{j\\omega_d T_s}$，其中 $\\omega_c$ 是连续时间角频率，$\\omega_d$ 是离散时间角频率。映射关系由下式给出：\n$$\n\\omega_c = \\frac{2}{T_s} \\tan\\left(\\frac{\\omega_d T_s}{2}\\right)\n$$\n这种关系是非线性的，导致频率轴的“畸变”。对于 $\\omega_d T_s / 2 \\ll 1$ 的低频，我们可以使用近似 $\\tan(x) \\approx x$，得到 $\\omega_c \\approx \\omega_d$。然而，随着频率的增加，$\\tan(\\omega_d T_s / 2)$ 的增长速度快于其自变量，这表明 $\\omega_c > \\omega_d$。这意味着连续时间频谱被压缩到从 $0$ 到奈奎斯特频率 $\\omega_s/2 = \\pi/T_s$ 的离散时间频率范围内。\n\n问题要求分析在期望的连续时间穿越频率 $\\omega_c = 10{,}000\\,\\mathrm{rad/s}$ 附近的这种效应。我们需要找到对应的离散时间频率 $\\omega_d$，即 $\\omega_c$ 的“离散时间镜像”。我们反转映射方程：\n$$\n\\omega_d = \\frac{2}{T_s} \\arctan\\left(\\frac{\\omega_c T_s}{2}\\right)\n$$\n给定 $\\omega_c = 10{,}000\\,\\mathrm{rad/s}$ 和 $T_s = 2 \\times 10^{-5}\\,\\mathrm{s}$。\n反正切函数的参数是：\n$$\n\\frac{\\omega_c T_s}{2} = \\frac{(10{,}000\\,\\mathrm{rad/s}) \\times (2 \\times 10^{-5}\\,\\mathrm{s})}{2} = \\frac{0.2}{2} = 0.1\n$$\n现在，我们计算 $\\omega_d$：\n$$\n\\omega_d = \\frac{2}{2 \\times 10^{-5}} \\arctan(0.1) = 10^5 \\arctan(0.1)\\,\\mathrm{rad/s}\n$$\n使用计算器，$\\arctan(0.1) \\approx 0.09966865$。\n$$\n\\omega_d \\approx 10^5 \\times 0.09966865 = 9966.865\\,\\mathrm{rad/s}\n$$\n畸变效应是显而易见的：期望的模拟频率 $10{,}000\\,\\mathrm{rad/s}$ 被映射到一个较低的数字频率，约为 $9966.87\\,\\mathrm{rad/s}$。\n\n期望的模拟频率 $\\omega_c$ 与其离散时间镜像 $\\omega_d$ 之间的相对偏差为：\n$$\n\\text{相对偏差} = \\frac{\\omega_c - \\omega_d}{\\omega_c} = 1 - \\frac{\\omega_d}{\\omega_c}\n$$\n$$\n\\text{相对偏差} = 1 - \\frac{10^5 \\arctan(0.1)}{10^4} = 1 - 10 \\arctan(0.1)\n$$\n$$\n\\text{相对偏差} \\approx 1 - 10 \\times 0.09966865 = 1 - 0.9966865 = 0.0033135\n$$\n相对偏差约为 $0.0033$，或 $0.33\\%$。这意味着，一个在连续时间域中设计、旨在使穿越频率为 $10{,}000\\,\\mathrm{rad/s}$ 的控制器，在不进行预畸变的情况下使用Tustin变换进行离散化后，其在离散系统中的实际穿越频率将对应于这个较低的模拟频率。为了实现期望的 $10{,}000\\,\\mathrm{rad/s}$ 穿越频率，需要进行预畸变，即向上调整模拟设计的目标频率以补偿畸变效应。",
            "answer": "$$\n\\boxed{\\frac{\\frac{6}{25} + \\frac{12}{25}z^{-1} + \\frac{6}{25}z^{-2}}{1 - \\frac{46}{25}z^{-1} + \\frac{23}{25}z^{-2}}}\n$$"
        },
        {
            "introduction": "数字控制器使用有限的字长来表示信号和系数，这种固有的量化效应会给系统引入非线性。一个重要的后果是，即使在线性理论中稳定的系统，也可能在无外部输入的情况下产生不期望的持续振荡，即“极限环”。本练习将引导您从第一性原理出发，推导在一个一阶数字滤波器中产生极限环的条件，并将其应用于分析一个数字电流估算器中的量化行为()。",
            "id": "3833392",
            "problem": "一个带量化反馈的一阶无限脉冲响应 (IIR) 数字滤波器在零输入下实现为 $y[n] = Q(a\\,y[n-1])$，其中 $Q(\\cdot)$ 是一个均匀的中心点量化器，它将输入四舍五入到最接近的可表示电平，步长为 $\\Delta  0$。该量化器具有无限范围，并满足 $Q(x) = \\Delta\\,\\mathrm{round}(x/\\Delta)$ 以及奇对称性 $Q(-x) = -Q(x)$。系数 $a \\in \\mathbb{R}$ 是反馈增益。从这些定义和性质出发，根据第一性原理，推导非线性量化产生形式为 $y[n] \\in \\{+A,-A\\}$ 的非平凡周期为2的零输入极限环的条件，并用 $\\Delta$、$a$ 和一个表征量化电平的整数参数明确表示极限环的振幅 $A$。你的推导应确定 $a$ 的必要符号条件以及这种极限环可能存在的整数的容许集合。\n\n然后将这些条件应用于一个电阻-电感 (RL) 负载的数字电流估计器。该物理对象由 $\\frac{di(t)}{dt} = \\frac{1}{L}\\big(v(t) - R\\,i(t)\\big)$ 描述，其中 $i(t)$ 是电流，$R$ 是电阻，$L$ 是电感，$v(t)$ 是施加的电压。一个使用电流估计的量化反馈的前向欧拉预测器实现为\n$$\\hat{i}[n] = \\hat{i}[n-1] + \\frac{T_s}{L}\\big(u[n-1] - R\\,Q(\\hat{i}[n-1])\\big),$$\n采样周期为 $T_s$，零输入为 $u[n] \\equiv 0$。在零输入和量化反馈下，这简化为形式为 $\\hat{i}[n] = \\hat{i}[n-1] - \\beta\\,Q(\\hat{i}[n-1])$ 的一维非线性递归，其中 $\\beta \\triangleq \\frac{R\\,T_s}{L}$。根据第一性原理，推导该估计器中任何对称的周期为2的零输入极限环 $\\hat{i}[n] \\in \\{+A,-A\\}$ 的振幅 $A$，并用 $\\Delta$、$\\beta$ 和一个整数参数表示。说明该整数的容许条件。\n\n最后，对于RL估计器，取 $L = 1\\ \\mathrm{mH}$、$R = 0.5\\ \\Omega$、$T_s = 3\\ \\mathrm{ms}$ 和量化器步长 $\\Delta = 0.125\\ \\mathrm{A}$。计算上述量化反馈递归可能产生的最大振幅零输入极限环，并以安培为单位报告其振幅。将你最终的数值振幅四舍五入到四位有效数字，并以 $\\mathrm{A}$ 表示。",
            "solution": "该问题提出了一个三部分分析，研究数字滤波器中由量化引起的零输入极限环。我们必须首先验证问题陈述。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **第1部分 (通用IIR滤波器)：**\n  - 系统方程：$y[n] = Q(a\\,y[n-1])$，在零输入下。\n  - 量化器 $Q(\\cdot)$：均匀中心点量化器，步长 $\\Delta  0$，定义为 $Q(x) = \\Delta\\,\\mathrm{round}(x/\\Delta)$，并具有奇对称性 $Q(-x) = -Q(x)$。\n  - 极限环形式：非平凡周期为2，$y[n] \\in \\{+A, -A\\}$ 且 $A \\neq 0$。\n- **第2部分 (RL估计器)：**\n  - 系统方程：$\\hat{i}[n] = \\hat{i}[n-1] - \\beta\\,Q(\\hat{i}[n-1])$，其中 $\\beta \\triangleq \\frac{R\\,T_s}{L}$。\n  - 极限环形式：对称周期为2，$\\hat{i}[n] \\in \\{+A, -A\\}$。\n- **第3部分 (数值计算)：**\n  - 参数：$L = 1 \\times 10^{-3}\\ \\mathrm{H}$，$R = 0.5\\ \\Omega$，$T_s = 3 \\times 10^{-3}\\ \\mathrm{s}$，$\\Delta = 0.125\\ \\mathrm{A}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，研究的是数字信号处理和控制理论中一个有据可查的现象，即量化引起的极限环。数字滤波器、RL估计器和量化器的模型都是标准的，并且在数学上是明确定义的。该问题是自包含的，提供了所有必要的定义和参数。语言客观而精确。任务陈述清晰，并导向一个唯一的、可验证的解。该问题没有违反任何无效标准。例如，它在科学上不是不合理的、不完整的或不适定的。\n\n**步骤3：结论与行动**\n该问题有效。我们继续进行求解。\n\n### 推导与求解\n\n量化器 $Q(x) = \\Delta\\,\\mathrm{round}(x/\\Delta)$ 将一个实数 $x$ 映射到最接近的 $\\Delta$ 的整数倍。奇对称性 $Q(-x)=-Q(x)$ 意味着对于恰好在量化电平中间的值，采用对称的舍入规则（例如，逢半离零舍入）。根据这样的规则，映射到输出电平 $k\\Delta$（对于整数 $k$）的输入区域是半开区间 $[(k - 0.5)\\Delta, (k + 0.5)\\Delta)$。\n\n**第1部分：通用IIR滤波器 $y[n] = Q(a\\,y[n-1])$ 的分析**\n\n我们在寻找支持形式为 $\\{..., +A, -A, +A, -A, ...\\}$（其中 $A  0$）的非平凡周期为2的极限环的条件。\n要使该序列成为系统方程 $y[n] = Q(a\\,y[n-1])$ 的解，必须满足两个条件：\n1. 如果 $y[n-1] = -A$，那么 $y[n]$ 必须是 $+A$。这给出：$A = Q(a(-A)) = Q(-aA)$。\n2. 如果 $y[n-1] = +A$，那么 $y[n]$ 必须是 $-A$。这给出：$-A = Q(aA)$。\n\n使用量化器的奇对称性 $Q(-x) = -Q(x)$，第一个条件 $A = Q(-aA)$ 变为 $A = -Q(aA)$，这与第二个条件等价。因此，我们只需要满足 $-A = Q(aA)$。\n\n量化器的输出始终是步长 $\\Delta$ 的整数倍。由于 $A$ 是系统（也就是量化器）的输出，它必须具有 $A = m\\Delta$ 的形式，其中 $m$ 是某个整数。因为我们关心的是非平凡极限环（$A0$），所以 $m$ 必须是一个正整数，$m \\in \\mathbb{Z}^+$。\n\n将 $A=m\\Delta$ 代入条件 $-A = Q(aA)$ 得到：\n$$ -m\\Delta = Q(a(m\\Delta)) $$\n要使量化器输出为 $-m\\Delta$，其输入 $a(m\\Delta)$ 必须落在相应的量化区间内。根据量化器定义，对于输出 $k\\Delta$，输入必须在 $[(k-0.5)\\Delta, (k+0.5)\\Delta)$ 内。对于 $k=-m$，这是：\n$$ (-m - 0.5)\\Delta \\le a(m\\Delta)  (-m + 0.5)\\Delta $$\n因为 $m  0$ 且 $\\Delta  0$，我们可以用 $m\\Delta$ 除以不等式两边而不改变符号：\n$$ \\frac{-m - 0.5}{m} \\le a  \\frac{-m + 0.5}{m} $$\n$$ -1 - \\frac{1}{2m} \\le a  -1 + \\frac{1}{2m} $$\n这个不等式定义了能够维持振幅为 $A=m\\Delta$ 的周期为2的极限环的反馈增益 $a$ 的范围。这种极限环存在的必要条件是增益 $a$ 必须为负，因为对于任何 $m \\ge 1$，$a$ 的区间完全在 $0$ 以下。容许的整数是所有正整数 $m \\ge 1$。\n\n**第2部分：RL电流估计器的分析**\n\n电流估计器的零输入递归由 $\\hat{i}[n] = \\hat{i}[n-1] - \\beta\\,Q(\\hat{i}[n-1])$ 给出。我们寻求一个对称的周期为2的极限环 $\\hat{i}[n] \\in \\{+A, -A\\}$，其中 $A0$。\n1. 如果 $\\hat{i}[n-1] = A$，那么 $\\hat{i}[n]$ 必须是 $-A$。代入方程：\n   $$ -A = A - \\beta\\,Q(A) \\Rightarrow 2A = \\beta\\,Q(A) $$\n2. 如果 $\\hat{i}[n-1] = -A$，那么 $\\hat{i}[n]$ 必须是 $A$。代入方程：\n   $$ A = -A - \\beta\\,Q(-A) $$\n   使用量化器的奇对称性，$Q(-A) = -Q(A)$，这变为：\n   $$ A = -A + \\beta\\,Q(A) \\Rightarrow 2A = \\beta\\,Q(A) $$\n两种转换都得到相同的条件。从 $2A = \\beta\\,Q(A)$，我们可以将量化输出表示为 $Q(A) = \\frac{2A}{\\beta}$。由于量化器输出必须是 $\\Delta$ 的整数倍，设 $Q(A) = k\\Delta$，其中 $k$ 是某个整数。已知 $\\beta = \\frac{R\\,T_s}{L}  0$ 且 $A  0$，我们必须有 $Q(A)  0$。对于中心点量化器，这意味着 $A  \\Delta/2$ 且 $k$ 必须是正整数，$k \\in \\mathbb{Z}^+$。\n\n将 $Q(A) = k\\Delta$ 代回条件 $2A = \\beta\\,Q(A)$，我们求解振幅 $A$：\n$$ 2A = \\beta(k\\Delta) \\Rightarrow A = \\frac{\\beta k \\Delta}{2} $$\n为了使该解自洽，振幅 $A$ 在输入到量化器时必须产生输出 $k\\Delta$。也就是说，$Q(A)$ 必须等于 $k\\Delta$。这要求 $A$ 位于对应于输出 $k\\Delta$ 的量化区间内：\n$$ (k - 0.5)\\Delta \\le A  (k + 0.5)\\Delta $$\n代入我们的 $A$ 的表达式：\n$$ (k - 0.5)\\Delta \\le \\frac{\\beta k \\Delta}{2}  (k + 0.5)\\Delta $$\n因为 $\\Delta  0$，我们可以用它来除：\n$$ k - 0.5 \\le \\frac{\\beta k}{2}  k + 0.5 $$\n乘以 $2$ 得到：\n$$ 2k - 1 \\le \\beta k  2k + 1 $$\n这对不等式为给定的 $\\beta$ 提供了关于整数参数 $k$ 的容许条件。我们可以将它们分开：\n1. $2k - 1 \\le \\beta k \\Rightarrow 2k - \\beta k \\le 1 \\Rightarrow k(2 - \\beta) \\le 1$。\n2. $\\beta k  2k + 1 \\Rightarrow \\beta k - 2k  1 \\Rightarrow k(\\beta - 2)  1$。\n\n因此，对于给定的系统参数 $\\beta$，对于每个满足 $k(2 - \\beta) \\le 1$ 和 $k(\\beta - 2)  1$ 的正整数 $k$，都可能存在一个周期为2的极限环。这种极限环的振幅是 $A = \\frac{\\beta k \\Delta}{2}$。\n\n**第3部分：RL估计器的数值计算**\n\n我们已知参数 $L = 1 \\times 10^{-3}\\ \\mathrm{H}$，$R = 0.5\\ \\Omega$，$T_s = 3 \\times 10^{-3}\\ \\mathrm{s}$，以及 $\\Delta = 0.125\\ \\mathrm{A}$。\n首先，我们计算参数 $\\beta$：\n$$ \\beta = \\frac{R\\,T_s}{L} = \\frac{(0.5)(3 \\times 10^{-3})}{1 \\times 10^{-3}} = 1.5 $$\n接下来，我们使用推导出的条件和 $\\beta = 1.5$ 来找到容许的正整数 $k$ 的集合：\n1. $k(2 - 1.5) \\le 1 \\Rightarrow 0.5k \\le 1 \\Rightarrow k \\le 2$。\n2. $k(1.5 - 2)  1 \\Rightarrow -0.5k  1$。这个不等式对所有正整数 $k$ 都成立。\n\n综合这些，容许的整数是 $k \\in \\{1, 2\\}$。\n极限环振幅由 $A_k = \\frac{\\beta k \\Delta}{2}$ 给出。为了找到最大振幅的极限环，我们必须使用 $k$ 的最大容许值，即 $k_{max} = 2$。\n最大振幅 $A_{max}$ 是：\n$$ A_{max} = \\frac{\\beta k_{max} \\Delta}{2} = \\frac{(1.5)(2)(0.125)}{2} $$\n$$ A_{max} = (1.5)(0.125) = \\frac{3}{2} \\times \\frac{1}{8} = \\frac{3}{16} $$\n转换为十进制值：\n$$ A_{max} = 0.1875\\ \\mathrm{A} $$\n问题要求将结果四舍五入到四位有效数字。值 $0.1875$ 已经有四位有效数字。",
            "answer": "$$\\boxed{0.1875}$$"
        },
        {
            "introduction": "先进的控制算法（如模型预测控制，MPC）虽然性能强大，但其计算量也相当可观，这对其在具有严格时间限制的实时系统中的应用构成了挑战。本练习将理论与实践相结合，要求您量化一个典型MPC控制器的计算复杂度，并根据数字信号处理器（DSP）的性能指标来评估其可行性。通过这个过程，您将学会如何分析算法的计算负载，并思考如何通过剪枝策略来满足实时性要求()。",
            "id": "3833325",
            "problem": "一个三相两电平电压源逆变器由部署在数字信号处理器 (DSP) 上的有限控制集模型预测控制 (MPC) 进行控制。该逆变器有三个桥臂，每个桥臂有两个开关，从而产生 $2^{3}$ 个不同的开关状态。控制器在每个控制间隔内评估长度为 $L$ 的候选开关序列，以最小化一个二次跟踪代价。\n\n假设受控对象为三相阻感负载，在静止 $\\alpha$-$\\beta$ 坐标系中表示，其状态向量为 $i_{\\alpha\\beta} = \\begin{pmatrix} i_{\\alpha} \\\\ i_{\\beta} \\end{pmatrix}$。使用带有预计算常数的前向欧拉离散化，每个维度的预测更新为\n$$\ni_{k+1} = c_{1}\\, i_{k} + c_{2}\\, v_{k},\n$$\n其中 $c_{1} = 1 - (R/L) T_{s}$，$c_{2} = T_{s}/L$，$R$ 是电阻，$L$ 是电感，$T_{s}$ 是采样周期，$v_{k}$ 是通过预计算的查找表从开关状态获得的对应 $\\alpha$ 轴或 $\\beta$ 轴上的逆变器电压分量。在时域内的二次跟踪代价定义为\n$$\nJ = \\sum_{m=1}^{L} w \\left( \\left( i_{\\alpha,k+m} - i_{\\alpha}^{\\star} \\right)^{2} + \\left( i_{\\beta,k+m} - i_{\\beta}^{\\star} \\right)^{2} \\right),\n$$\n其中参考值 $i_{\\alpha}^{\\star}$ 和 $i_{\\beta}^{\\star}$ 为常数，权重为 $w$。假设对于单个预测步和单个候选序列元素，每次浮点乘法、加法或减法计为一次浮点运算 (FLOP)，而比较或查表不计入。\n\n1. 从给定的离散时间模型和代价定义出发，推导二维 $\\alpha$-$\\beta$ 系统中每个预测步、每个候选序列所需的浮点运算次数。然后，推导在考虑所有逆变器开关状态时，评估所有长度为 $L$ 的候选开关序列所需的总浮点运算次数。\n\n2. DSP 的峰值吞吐量为每秒 $400$ 百万次浮点运算 (MFLOPS)，但由于流水线停顿和内存读取，只有峰值的 $60\\%$ 可有效地用于预测和代价的计算。控制间隔为 $T_{s} = 50\\,\\mu\\text{s}$，其中非计算开销消耗 $15\\,\\mu\\text{s}$，留给计算的时间预算为 $35\\,\\mu\\text{s}$。使用这些参数，计算每个控制间隔内允许的最大浮点运算次数，并确定最大分支因子 $b_{\\max}$（每步的最大候选开关状态数），使得对所有长度为 $L=3$ 的序列的评估能够满足实时截止期限。将 $b_{\\max}$ 表示为整数。\n\n3. 简要提出两种物理上和计算上合理的剪枝策略，这些策略能在保持控制性能的同时，将有效分支因子减少到小于逆变器状态的全集。并定性解释每种策略如何影响分支因子和计算复杂度。您的最终数值答案必须是第 2 部分得到的 $b_{\\max}$ 的值，表示为一个不带单位的整数。",
            "solution": "将首先验证问题的前提和结构，然后对三个部分进行依次推导来解决该问题。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n- 系统：三相两电平电压源逆变器。\n- 开关状态数：$2^{3} = 8$。\n- 控制方法：有限控制集模型预测控制 (FCS-MPC)。\n- 候选序列长度：$L$。\n- 系统状态向量：$i_{\\alpha\\beta} = \\begin{pmatrix} i_{\\alpha} \\\\ i_{\\beta} \\end{pmatrix}$。\n- 离散时间模型 (前向欧拉)：$i_{k+1} = c_{1}\\, i_{k} + c_{2}\\, v_{k}$，适用于每个维度 ($\\alpha$, $\\beta$)。\n- 模型常数：$c_{1} = 1 - (R/L) T_{s}$，$c_{2} = T_{s}/L$。\n- 代价函数：$J = \\sum_{m=1}^{L} w \\left( \\left( i_{\\alpha,k+m} - i_{\\alpha}^{\\star} \\right)^{2} + \\left( i_{\\beta,k+m} - i_{\\beta}^{\\star} \\right)^{2} \\right)$。\n- 参考值：$i_{\\alpha}^{\\star}$ 和 $i_{\\beta}^{\\star}$ 是常数。\n- FLOP 计数：一次浮点乘法、加法或减法为一次 FLOP。比较和查表为零 FLOP。\n- DSP 峰值吞吐量：$400$ MFLOPS。\n- DSP 有效吞吐量系数：$60\\%$。\n- 控制间隔 (采样周期)：$T_{s} = 50\\,\\mu\\text{s}$。\n- 非计算开销时间：$15\\,\\mu\\text{s}$。\n- 第 2 部分的时域长度：$L=3$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题牢固地植根于电力电子学和数字控制的原理。系统 (VSI)、负载模型 (RL)、控制策略 (FCS-MPC) 和性能指标 (二次代价函数) 都是该领域的标准且广泛使用的。离散时间模型是一个有效的一阶近似。(标准：满足)\n- **适定性**：问题各部分所需的所有数据都已提供。问题具体，并能得出唯一、可推导的答案。(标准：满足)\n- **客观性**：问题使用工程和数学中常见的精确、形式化的语言陈述，没有主观或模糊的术语。(标准：满足)\n\n**步骤 3：结论和行动**\n该问题在科学上合理、适定且客观。因此被判定为**有效**。现在开始求解过程。\n\n**第 1 部分：计算复杂度推导**\n\n首先，我们确定单个候选序列在一次预测步及相关的代价计算中所需的浮点运算 (FLOP) 次数。\n\n**一次预测更新的 FLOP 次数：**\n状态预测模型应用于电流的 $\\alpha$ 和 $\\beta$ 两个分量。\n对于 $\\alpha$ 分量：$i_{\\alpha, k+1} = c_{1}\\, i_{\\alpha, k} + c_{2}\\, v_{\\alpha, k}$。\n- $c_{1} \\times i_{\\alpha, k}$ 需要一次乘法。\n- $c_{2} \\times v_{\\alpha, k}$ 需要一次乘法。\n- 将两个乘积相加需要一次加法。\n因此 $\\alpha$ 分量需要 $3$ 次 FLOP。对 $\\beta$ 分量执行相同的计算，也需要 $3$ 次 FLOP。\n二维状态向量 $i_{\\alpha\\beta}$ 的单次预测更新所需的总 FLOP 次数为 $F_{pred} = 3 + 3 = 6$ 次 FLOP。\n\n**一个代价项计算的 FLOP 次数：**\n单个预测步 $k+m$ 的代价项为 $j_{m} = w \\left( \\left( i_{\\alpha,k+m} - i_{\\alpha}^{\\star} \\right)^{2} + \\left( i_{\\beta,k+m} - i_{\\beta}^{\\star} \\right)^{2} \\right)$。\n- 误差 $e_{\\alpha} = i_{\\alpha,k+m} - i_{\\alpha}^{\\star}$ 需要一次减法。\n- 误差 $e_{\\beta} = i_{\\beta,k+m} - i_{\\beta}^{\\star}$ 需要一次减法。\n- 平方 $e_{\\alpha}^{2}$ 需要一次乘法。\n- 平方 $e_{\\beta}^{2}$ 需要一次乘法。\n- 平方和 $e_{\\alpha}^{2} + e_{\\beta}^{2}$ 需要一次加法。\n- 与权重 $w$ 相乘需要一次乘法。\n计算代价函数中一个项的总 FLOP 次数为 $F_{cost\\_term} = 1 + 1 + 1 + 1 + 1 + 1 = 6$ 次 FLOP。\n\n对于给定的候选序列，时域中**每个预测步**所需的 FLOP 次数是状态预测和该步代价项计算的 FLOP 次数之和。\n$F_{step} = F_{pred} + F_{cost\\_term} = 6 + 6 = 12$ 次 FLOP。\n\n接下来，我们推导评估所有可能的候选序列所需的总 FLOP 次数。\n一个长度为 $L$ 的序列需要 $L$ 次预测更新和 $L$ 次代价项计算。总代价 $J$ 是这 $L$ 个项的和。如果使用初始化为零的累加器 ($J_{acc} = J_{acc} + j_m$) 则需要 $L$ 次加法，如果最后再求和则需要 $L-1$ 次加法。我们假设使用累加器，这是典型做法。\n长度为 $L$ 的每个序列的 FLOP 次数：$F_{seq} = L \\times F_{step} + L \\times (\\text{1 for accumulation}) = L \\times 12 + L = 13L$。\n\n逆变器有 $N_{states} = 2^{3} = 8$ 个不同的开关状态。对于长度为 $L$ 的预测时域，有 $N_{seq} = (N_{states})^{L} = 8^{L}$ 个可能的序列需要评估。\n总浮点运算次数是序列数与每个序列的 FLOP 次数的乘积。\n$F_{total} = N_{seq} \\times F_{seq} = 8^{L} \\times 13L$。\n\n**第 1 部分总结：**\n- 每个候选序列、每个预测步的 FLOP 次数：$12$。\n- 评估所有候选序列的总 FLOP 次数：$8^{L} \\times 13L$。\n\n**第 2 部分：最大分支因子计算**\n\n首先，我们计算一个控制间隔内可用的计算预算。\n- DSP 峰值吞吐量：$P_{peak} = 400 \\times 10^{6}$ FLOPS。\n- 有效吞吐量：$P_{eff} = 0.60 \\times P_{peak} = 0.60 \\times 400 \\times 10^{6} = 240 \\times 10^{6}$ FLOPS。\n- 总控制间隔：$T_{s} = 50 \\times 10^{-6}\\,s$。\n- 开销时间：$T_{overhead} = 15 \\times 10^{-6}\\,s$。\n- 可用计算时间：$T_{compute} = T_{s} - T_{overhead} = (50 - 15) \\times 10^{-6} = 35 \\times 10^{-6}\\,s$。\n\n在此时间内可执行的最大 FLOP 次数是：\n$F_{max} = P_{eff} \\times T_{compute} = (240 \\times 10^{6}) \\times (35 \\times 10^{-6}) = 240 \\times 35 = 8400$ FLOPs。\n\n现在，我们将第 1 部分的总 FLOP 计数推广到任意分支因子 $b$。分支因子是时域中每一步考虑的候选状态数。需要评估的总序列数变为 $b^L$。\n作为 $b$ 和 $L$ 的函数的总 FLOP 计数为：\n$F_{total}(b, L) = b^{L} \\times 13L$。\n\n我们需要找到最大整数 $b_{max}$，使得对于 $L=3$ 的时域，计算可以在可用的时间预算内完成。\n$F_{total}(b_{max}, 3) \\le F_{max}$\n$b_{max}^{3} \\times 13 \\times 3 \\le 8400$\n$b_{max}^{3} \\times 39 \\le 8400$\n$b_{max}^{3} \\le \\frac{8400}{39} \\approx 215.385$\n\n为了找到最大整数 $b_{max}$，我们对该值取立方根。\n$b_{max} \\le (215.385)^{1/3}$。\n我们知道 $5^3 = 125$ 且 $6^3 = 216$。由于 $215.385  216$，所以 $b_{max}$ 必须小于 $6$。\n因此，允许的最大整数分支因子为 $b_{max} = 5$。\n\n**第 3 部分：剪枝策略**\n\n为了减少每一步评估所有 $8$ 个可能状态所带来的计算负担，可以采用剪枝策略来降低有效分支因子 $b$。两种物理上和计算上合理的策略如下：\n\n1.  **基于扇区的剪枝：** 该策略利用了对系统行为的物理洞察。$\\alpha$-$\\beta$ 平面被划分为六个 $60$ 度的扇区，每个扇区对应两个相邻非零电压矢量之间的区域。在每个控制步，计算一个理想或所需的电压矢量 $v_{req}$，通常使用无差拍控制律（例如，$v_{req} = (i^{\\star} - c_1 i_k) / c_2$）。然后，算法确定 $v_{req}$ 所在的扇区，并将候选状态集剪枝，只保留那些最有可能将电流驱动至参考值的状态。通常，这包括界定该扇区的两个有效电压矢量以及一个或两个零矢量。\n    - **影响：** 该策略将分支因子从 $b=8$ 急剧减少到一个小的固定数值，通常为 $b=3$（两个有效矢量和一个零矢量）。这使得计算复杂度从 $O(8^L)$ 降至 $O(3^L)$，通过将搜索集中在最有效的控制动作上，在保持高性能的同时，极大地减少了计算负载。\n\n2.  **基于代价的启发式剪枝：** 该策略使用简化的代价评估来预筛选候选状态。对于给定序列，在预测时域的每一步 $m$，不是立即进行整个时域的搜索，而是对所有 $8$ 个可能的下一状态执行单步预测。计算这 $8$ 种结果中每一种的单步代价值 $j_m$。然后根据这个短期代价对状态进行排序。只保留前 $b$ 个状态（那些单步代价最低的状态）以继续进行到下一步 $m+1$ 的预测。\n    - **影响：** 该方法使分支因子 $b$ 成为一个可调参数，从而在计算负载和搜索广度之间提供了直接的权衡。例如，设置 $b=5$ 满足了第 2 部分计算出的截止期限。复杂度变为 $O(b^L)$，但在搜索树的每个节点上都有额外的开销，即在剪枝到 $b$ 个状态之前需要评估 $8$ 种可能性。与基于扇区的剪枝相比，这是一种更灵活但更具启发式的方法，因为它假设局部最优的选择是全局最优序列的良好指标。",
            "answer": "$$\\boxed{5}$$"
        }
    ]
}