{
    "hands_on_practices": [
        {
            "introduction": "Understanding the origin of subharmonic oscillation is the first step toward mastering its control. This foundational exercise guides you through a small-signal analysis to derive the minimum required compensation slope from first principles. By modeling the cycle-to-cycle dynamics of the inductor current, you will uncover the mathematical condition that guarantees stability in a current-mode controlled converter .",
            "id": "3883985",
            "problem": "An ideal buck converter employing peak current-mode control with trailing-edge Pulse Width Modulation (PWM) operates in continuous conduction mode. The inductor current is sensed with a gain $k_i$ (volts per ampere) and a linear artificial ramp of slope $m_a$ (volts per second) is added to the sensed current signal before the comparator. The converter has input voltage $V_g$, inductance $L$, switching frequency $f_s$, and is designed for a maximum duty ratio $D_{max}$ at which it must not exhibit subharmonic oscillation. Assume ideal components, negligible propagation delays, and that the output voltage satisfies $V_o = D V_g$ in steady state.\n\nStarting from the inductor law $v_L = L \\, di_L/dt$ and the piecewise-linear inductor current slopes in the on- and off-intervals, derive the sampled-data perturbation map of the peak current loop and determine the minimum required artificial ramp slope $m_a$ (in the comparator signal domain) that guarantees avoidance of subharmonic oscillation for all duty ratios $0 \\leq D \\leq D_{max}$. Express your final answer as a single closed-form analytic expression in terms of $V_g$, $L$, $D_{max}$, and $k_i$, in units of volts per second. No numerical evaluation is required and no rounding is to be performed.",
            "solution": "The problem asks for the minimum required artificial ramp slope, $m_a$, to prevent subharmonic oscillation in a peak current-mode controlled ideal buck converter for all duty ratios $D$ up to a maximum value $D_{max}$. The analysis begins from fundamental principles.\n\nLet the switching period be $T_s = 1/f_s$. The converter operates in continuous conduction mode (CCM).\n\nFirst, we determine the slopes of the inductor current, $i_L(t)$. The voltage across the inductor, $v_L$, is given by $v_L = L \\frac{di_L}{dt}$.\n\nDuring the ON interval, $[nT_s, (n+D)T_s]$, the main switch is on. The inductor voltage is $v_L = V_g - V_o$. Using the steady-state relation $V_o = D V_g$ for an ideal buck converter, the inductor current up-slope, $S_{on}$, is:\n$$ S_{on} = \\frac{di_L}{dt} = \\frac{V_g - V_o}{L} = \\frac{V_g - D V_g}{L} = \\frac{V_g(1-D)}{L} $$\nThis slope is positive for $D  1$.\n\nDuring the OFF interval, $[(n+D)T_s, (n+1)T_s]$, the main switch is off and the diode conducts. The inductor voltage is $v_L = -V_o = -D V_g$. The inductor current down-slope, $S_{off}$, is:\n$$ S_{off} = \\frac{di_L}{dt} = \\frac{-V_o}{L} = \\frac{-D V_g}{L} $$\nThis slope is negative. The magnitude of the down-slope is $|S_{off}| = \\frac{D V_g}{L}$.\n\nIn peak current-mode control with an added artificial ramp, the switch is turned off when the sum of the sensed current signal and the artificial ramp reaches a control reference voltage, $v_c$. The sensed current signal is $k_i i_L(t)$, and the artificial ramp signal is $m_a (t-nT_s)$ within the $n$-th cycle. At the turn-off instant $t = (n+d[n])T_s$, where $d[n]$ is the duty ratio of the $n$-th cycle, we have:\n$$ k_i i_L\\left((n+d[n])T_s\\right) + m_a d[n]T_s = v_c[n] $$\nThe inductor current at this instant is the peak current, which is the sum of the current at the start of the cycle, $i_L[n]$, and the rise during the on-time: $i_L((n+d[n])T_s) = i_L[n] + S_{on} d[n] T_s$.\nSubstituting this into the control law gives:\n$$ k_i \\left( i_L[n] + S_{on} d[n] T_s \\right) + m_a d[n] T_s = v_c[n] $$\n\nTo analyze the stability of the current loop, we introduce small-signal perturbations around a steady-state operating point. Let each variable be the sum of its DC steady-state value (e.g., $D$, $I_L[n]$) and a small perturbation (e.g., $\\hat{d}[n]$, $\\hat{i}_L[n]$):\n$i_L[n] = I_L[n] + \\hat{i}_L[n]$, $d[n] = D + \\hat{d}[n]$, and $v_c[n] = V_c + \\hat{v}_c[n]$.\nTo study the intrinsic instability of the current loop (subharmonic oscillation), we assume the control voltage is constant, so $\\hat{v}_c[n] = 0$. The slopes $S_{on}$ and $S_{off}$ are also treated as constant, which is equivalent to assuming the input and output voltages do not have perturbations on the time scale of the switching frequency.\n\nThe steady-state part of the equation is $k_i (I_L[n] + S_{on} D T_s) + m_a D T_s = V_c$.\nThe first-order perturbation part of the equation is:\n$$ k_i \\left( \\hat{i}_L[n] + S_{on} \\hat{d}[n] T_s \\right) + m_a \\hat{d}[n] T_s = 0 $$\nSolving for the duty cycle perturbation $\\hat{d}[n]$:\n$$ \\hat{d}[n] (k_i S_{on} T_s + m_a T_s) = -k_i \\hat{i}_L[n] $$\n$$ \\hat{d}[n] = - \\frac{k_i}{ (k_i S_{on} + m_a) T_s } \\hat{i}_L[n] $$\n\nNext, we establish the cycle-to-cycle evolution of the inductor current perturbation. The current at the start of cycle $n+1$, denoted $i_L[n+1]$, is the current at the end of cycle $n$:\n$$ i_L[n+1] = i_L[n] + S_{on} d[n] T_s + S_{off} (T_s - d[n] T_s) $$\n$$ i_L[n+1] = i_L[n] + (S_{on} - S_{off}) d[n] T_s + S_{off} T_s $$\nThe steady-state volt-second balance on the inductor requires $S_{on} D T_s + S_{off} (1-D) T_s = 0$, which implies $I_L[n+1] = I_L[n]$.\nThe perturbation dynamics are therefore:\n$$ \\hat{i}_L[n+1] = \\hat{i}_L[n] + (S_{on} - S_{off}) \\hat{d}[n] T_s $$\nSubstituting the expression for $\\hat{d}[n]$:\n$$ \\hat{i}_L[n+1] = \\hat{i}_L[n] + (S_{on} - S_{off}) T_s \\left( - \\frac{k_i}{ (k_i S_{on} + m_a) T_s } \\hat{i}_L[n] \\right) $$\n$$ \\hat{i}_L[n+1] = \\left( 1 - \\frac{k_i(S_{on} - S_{off})}{k_i S_{on} + m_a} \\right) \\hat{i}_L[n] $$\nThis is a first-order linear discrete-time system of the form $\\hat{i}_L[n+1] = \\lambda \\hat{i}_L[n]$, where $\\lambda$ is the characteristic multiplier:\n$$ \\lambda = 1 - \\frac{k_i(S_{on} - S_{off})}{k_i S_{on} + m_a} $$\nFor stability, the magnitude of the multiplier must be less than $1$, i.e., $|\\lambda|  1$. The boundary for subharmonic oscillation (period-doubling bifurcation) occurs when $\\lambda = -1$. To prevent this, we require $\\lambda > -1$.\n$$ 1 - \\frac{k_i(S_{on} - S_{off})}{k_i S_{on} + m_a} > -1 $$\n$$ 2 > \\frac{k_i(S_{on} - S_{off})}{k_i S_{on} + m_a} $$\nLet's define the slopes of the compensated sense signal in units of V/s. The on-slope is $M_1 = k_i S_{on}$ and the magnitude of the off-slope is $M_2 = -k_i S_{off}$. Both $M_1$ and $M_2$ are positive. The inequality can be rewritten as:\n$$ 2 > \\frac{M_1 + M_2}{M_1 + m_a} $$\nSince $M_1 + m_a$ must be positive for the peak current to be reached, we can multiply both sides by it without changing the inequality direction:\n$$ 2(M_1 + m_a) > M_1 + M_2 $$\n$$ 2 M_1 + 2 m_a > M_1 + M_2 $$\n$$ 2 m_a > M_2 - M_1 $$\n$$ m_a > \\frac{M_2 - M_1}{2} $$\nThis is the general condition for stability. Now, we substitute the expressions for the buck converter:\n$$ M_1 = k_i S_{on} = k_i \\frac{V_g(1-D)}{L} $$\n$$ M_2 = -k_i S_{off} = -k_i \\frac{-D V_g}{L} = \\frac{k_i D V_g}{L} $$\nThe condition on $m_a$ becomes:\n$$ m_a > \\frac{1}{2} \\left(\\frac{k_i D V_g}{L} - \\frac{k_i V_g(1-D)}{L}\\right) $$\n$$ m_a > \\frac{k_i V_g}{2L} [D - (1-D)] $$\n$$ m_a > \\frac{k_i V_g}{2L} (2D - 1) $$\nThis inequality must be satisfied for all duty ratios $D$ in the operating range $0 \\le D \\le D_{max}$. Let $g(D) = \\frac{k_i V_g}{2L} (2D - 1)$. This function is monotonically increasing with $D$. Therefore, to ensure stability over the entire range, $m_a$ must be greater than the maximum value that $g(D)$ takes in this range. The maximum occurs at $D = D_{max}$.\n$$ m_a > \\frac{k_i V_g}{2L} (2D_{max} - 1) $$\nFor duty cycles $D \\le 0.5$, the right-hand side is negative or zero, meaning the system is inherently stable and any non-negative ramp slope $m_a \\ge 0$ is sufficient. For $D > 0.5$, a compensating ramp is necessary. The minimum required slope to guarantee stability across the entire range is the one that satisfies the condition at the worst-case (largest) duty ratio, $D_{max}$. This minimum value corresponds to the boundary of the inequality at $D=D_{max}$.\n$$ (m_a)_{min} = \\frac{k_i V_g}{2L} (2D_{max} - 1) $$\nIf $D_{max} \\le 0.5$, this expression yields a negative value, which simply implies that the minimum non-negative slope required is $0$. The formula provides the general analytical boundary for stability.\n\nThe final expression for the minimum required ramp slope $m_a$ is given in terms of $V_g$, $L$, $D_{max}$, and $k_i$. The units are $(\\text{V/A}) \\cdot \\text{V} / \\text{H} = (\\text{V/A}) \\cdot \\text{V} / (\\text{V} \\cdot \\text{s/A}) = \\text{V/s}$, which is correct.",
            "answer": "$$\\boxed{\\frac{k_i V_g (2 D_{max} - 1)}{2 L}}$$"
        },
        {
            "introduction": "Theoretical requirements must ultimately translate into practical circuit design. This practice bridges the gap between the analytically derived compensation slope, $m_a$, and its physical implementation using a fraction of the PWM controller's own oscillator ramp. You will determine the exact proportion of the oscillator signal needed to stabilize the converter, a common technique in integrated and discrete designs .",
            "id": "3883982",
            "problem": "A continuous-conduction-mode buck converter is controlled with peak current-mode control. The inductor has inductance $L$, the input voltage is $V_{\\mathrm{in}}$, and the regulated output voltage is $V_{\\mathrm{o}}$. The inductor current is sensed by a resistor of value $R_{\\mathrm{s}}$ followed by a gain stage of gain $G_{\\mathrm{s}}$, so that the net current-to-voltage sense gain at the comparator input is $k_{i} = R_{\\mathrm{s}} G_{\\mathrm{s}}$ in units of $\\mathrm{V}/\\mathrm{A}$. To mitigate subharmonic oscillation, a compensation ramp is added by injecting a fraction $\\alpha$ of the Pulse Width Modulation (PWM) oscillator sawtooth into the comparator summing node. The PWM oscillator produces a sawtooth voltage that rises linearly from $0$ to $V_{p}$ each switching period $T_{s} = 1/f_{s}$, where $f_{s}$ is the switching frequency.\n\nStarting from the inductor voltage-current dynamics and well-tested facts about the onset and suppression of subharmonic oscillation in peak current-mode control, derive an expression for the required fraction $\\alpha$ that achieves a compensation ramp slope $m_{a}$ at the comparator input equal to half of the magnitude of the inductor current downslope during the off-time, translated by the sense gain $k_{i}$. Your derivation must begin from the definitions of the inductor current slopes during the on and off intervals of the buck converter and proceed logically to the condition for the compensation ramp and the resulting $\\alpha$.\n\nThen, evaluate your derived expression numerically for the following parameters:\n- $V_{\\mathrm{in}} = 48 \\ \\mathrm{V}$,\n- $V_{\\mathrm{o}} = 12 \\ \\mathrm{V}$,\n- $L = 15 \\ \\mu\\mathrm{H}$,\n- $f_{s} = 200 \\ \\mathrm{kHz}$,\n- $R_{\\mathrm{s}} = 0.02 \\ \\Omega$,\n- $G_{\\mathrm{s}} = 20$,\n- $V_{p} = 2.0 \\ \\mathrm{V}$.\n\nRound your final numerical value of $\\alpha$ to four significant figures. Express your answer as a pure number (dimensionless).",
            "solution": "The derivation begins from the fundamental voltage-current relationship for the inductor, $v_L(t) = L \\frac{di_L(t)}{dt}$.\n\nDuring the on-time interval of a switching period $T_s$, when the main switch is closed for a duration $DT_s$ (where $D$ is the duty cycle), the voltage across the inductor in a buck converter is $v_L = V_{\\mathrm{in}} - V_{\\mathrm{o}}$. The inductor current increases with a constant slope, denoted as $m_1$:\n$$m_1 = \\frac{di_L}{dt} = \\frac{V_{\\mathrm{in}} - V_{\\mathrm{o}}}{L}$$\n\nDuring the off-time interval, when the switch is open for a duration $(1-D)T_s$, the voltage across the inductor is $v_L = -V_{\\mathrm{o}}$ (assuming the converter is in continuous conduction mode, CCM). The inductor current decreases with a constant slope, denoted as $m_2$:\n$$m_2 = \\frac{di_L}{dt} = -\\frac{V_{\\mathrm{o}}}{L}$$\nThe magnitude of this inductor current downslope is:\n$$|m_2| = \\frac{V_{\\mathrm{o}}}{L}$$\n\nThe inductor current $i_L$ is sensed and converted to a voltage signal $v_{\\text{sense}}$ for the comparator. The net current-to-voltage sense gain is given as $k_{i} = R_{\\mathrm{s}} G_{\\mathrm{s}}$. The slope of the sensed voltage signal at the comparator input during the off-time is $-S_f$, where $S_f$ is the magnitude of the downslope translated by the gain $k_{i}$:\n$$S_f = k_{i} |m_2| = k_{i} \\frac{V_{\\mathrm{o}}}{L}$$\n\nTo prevent subharmonic oscillation, an external compensation ramp is added to the sensed current signal. This ramp is derived from the PWM oscillator's sawtooth voltage, which rises linearly from $0$ to $V_{p}$ over one switching period $T_s$. The slope of the oscillator sawtooth voltage is:\n$$m_{\\text{osc}} = \\frac{V_p}{T_s}$$\nA fraction $\\alpha$ of this sawtooth voltage is injected as the compensation ramp, $v_a(t) = \\alpha \\cdot v_{\\text{sawtooth}}(t)$. The slope of this added compensation ramp at the comparator input is $m_a$:\n$$m_a = \\frac{d v_a}{dt} = \\alpha \\cdot m_{\\text{osc}} = \\alpha \\frac{V_p}{T_s}$$\n\nThe problem specifies the condition for compensation: the slope of the compensation ramp $m_a$ must be equal to half the magnitude of the inductor current downslope during the off-time, as seen at the comparator input. Mathematically, this is expressed as:\n$$m_a = \\frac{1}{2} S_f$$\n\nSubstituting the expressions for $m_a$ and $S_f$ into this condition gives:\n$$\\alpha \\frac{V_p}{T_s} = \\frac{1}{2} \\left( k_{i} \\frac{V_{\\mathrm{o}}}{L} \\right)$$\n\nWe can now solve for the required fraction $\\alpha$:\n$$\\alpha = \\frac{1}{2} \\frac{k_{i} V_{\\mathrm{o}} T_s}{L V_p}$$\nSince the switching period $T_s$ is the reciprocal of the switching frequency $f_s$, i.e., $T_s = 1/f_s$, we can write a more convenient expression for $\\alpha$:\n$$\\alpha = \\frac{k_{i} V_{\\mathrm{o}}}{2 L V_p f_s}$$\nThis is the symbolic expression for the required compensation fraction $\\alpha$.\n\nNext, we evaluate this expression numerically using the provided parameters:\n- Input voltage, $V_{\\mathrm{in}} = 48 \\ \\mathrm{V}$\n- Output voltage, $V_{\\mathrm{o}} = 12 \\ \\mathrm{V}$\n- Inductance, $L = 15 \\ \\mu\\mathrm{H} = 15 \\times 10^{-6} \\ \\mathrm{H}$\n- Switching frequency, $f_{s} = 200 \\ \\mathrm{kHz} = 200 \\times 10^3 \\ \\mathrm{Hz}$\n- Sense resistance, $R_{\\mathrm{s}} = 0.02 \\ \\Omega$\n- Sense gain, $G_{\\mathrm{s}} = 20$\n- PWM peak voltage, $V_{p} = 2.0 \\ \\mathrm{V}$\n\nFirst, we calculate the net current-to-voltage sense gain $k_i$:\n$$k_{i} = R_{\\mathrm{s}} G_{\\mathrm{s}} = (0.02 \\ \\Omega) \\times 20 = 0.4 \\ \\mathrm{V/A}$$\n\nNow, we substitute all the numerical values into the expression for $\\alpha$:\n$$\\alpha = \\frac{(0.4 \\ \\mathrm{V/A}) \\times (12 \\ \\mathrm{V})}{2 \\times (15 \\times 10^{-6} \\ \\mathrm{H}) \\times (2.0 \\ \\mathrm{V}) \\times (200 \\times 10^3 \\ \\mathrm{Hz})}$$\n\nLet's compute the numerator and the denominator separately.\nNumerator:\n$$0.4 \\times 12 = 4.8$$\nDenominator:\n$$2 \\times (15 \\times 10^{-6}) \\times 2.0 \\times (200 \\times 10^3) = 2 \\times 15 \\times 2 \\times 200 \\times 10^{-6} \\times 10^3 = 60 \\times 200 \\times 10^{-3} = 12000 \\times 10^{-3} = 12$$\n\nNow, we calculate $\\alpha$:\n$$\\alpha = \\frac{4.8}{12} = 0.4$$\n\nThe problem requires the answer to be rounded to four significant figures. An exact value of $0.4$ is written as $0.4000$ to meet this requirement. The result is a dimensionless quantity as expected.",
            "answer": "$$ \\boxed{0.4000} $$"
        },
        {
            "introduction": "Subharmonic oscillation can be viewed as a resonance at exactly half the switching frequency. This advanced exercise asks you to adopt a frequency-domain perspective to quantify the system's sensitivity to disturbances at this critical frequency. By deriving the complex gain at $f_s/2$, you will see precisely how the system's response becomes infinite at the onset of instability, providing a powerful insight into the mechanism of period-doubling .",
            "id": "3883978",
            "problem": "Consider a continuous-conduction-mode buck converter under peak current-mode control with an added linear artificial ramp of slope $m_a$ injected into the current comparator. Let the inductor current slope during the switch ON interval be $m_1$ and the magnitude of the inductor current slope during the switch OFF interval be $m_2$, with $m_10$, $m_20$, and the compensation ramp slope $m_a \\ge 0$. Assume ideal switching elements and negligible propagation delays and filtering in the inner current loop. The switching period is $T$, and the switching frequency is $f_s = 1/T$.\n\nThe converter operates in a period-$2$ (subharmonic) orbit of the inner current loop. A small sinusoidal disturbance at half the switching frequency is injected into the current reference entering the current comparator, so that when sampled once per switching period at the start of each ON interval, the disturbance sequence is $u_n = U(-1)^n$, where $U$ is a small constant amplitude and $n \\in \\mathbb{Z}$ is the cycle index.\n\nUsing a linearization around the period-$2$ orbit based on:\n- the inductor current ramp relations across ON and OFF subintervals, and\n- the comparator timing sensitivity $\\delta t_{\\text{on}} = (\\delta i_c - \\delta i_v)/(m_1 + m_a)$, where $\\delta i_c$ is the current-reference perturbation entering the comparator and $\\delta i_v$ is the inductor valley-current perturbation at the start of the ON interval,\n\nderive the complex small-signal mapping from the injected sequence $u_n$ to the resulting alternation in the inductor peak current $\\delta i_{p,n}$ of the period-$2$ orbit. That is, under a steady state at the injected half-frequency, $\\delta i_{p,n} = X(-1)^n$ for some complex scalar $X$, and you are to determine the closed-form expression of the complex gain $G_{1/2} \\equiv X/U$ in terms of $m_1$, $m_2$, and $m_a$ only.\n\nYour final answer must be a single closed-form analytic expression for $G_{1/2}$ as a function of $m_1$, $m_2$, and $m_a$. Do not substitute numerical values. Express the final result without units. If you wish to interpret amplitude and phase, treat $G_{1/2}$ as a complex number whose magnitude and argument correspond to the amplitude and phase, respectively, of the period-$2$ orbit relative to the injected disturbance.",
            "solution": "Let $i_{v,n}$ be the inductor current at the beginning of the $n$-th switching cycle (valley current), and let $i_{p,n}$ be the inductor current at the end of the ON-time in the $n$-th cycle (peak current). Let $t_{on,n}$ and $t_{off,n}$ be the ON and OFF durations, respectively. The switching period $T = t_{on,n} + t_{off,n}$ is constant.\n\nThe fundamental dynamics of the inductor current are:\n1. During the ON interval: $i_{p,n} = i_{v,n} + m_1 t_{on,n}$\n2. During the OFF interval: $i_{v,n+1} = i_{p,n} - m_2 t_{off,n}$\n\nWe perform a small-signal analysis around a steady-state operating point. Let perturbations be denoted by $\\delta$. The linearized equations are:\n1. $\\delta i_{p,n} = \\delta i_{v,n} + m_1 \\delta t_{on,n}$\n2. Since $\\delta t_{off,n} = -\\delta t_{on,n}$, the second equation becomes: $\\delta i_{v,n+1} = \\delta i_{p,n} - m_2(-\\delta t_{on,n}) = \\delta i_{p,n} + m_2 \\delta t_{on,n}$\n\nThe problem provides the linearized modulator equation relating the ON-time perturbation $\\delta t_{on,n}$ to the perturbations in the current reference $\\delta i_{c,n}$ and the valley current $\\delta i_{v,n}$:\n3. $\\delta t_{on,n} = \\frac{\\delta i_{c,n} - \\delta i_{v,n}}{m_1 + m_a}$\n\nTo find the gain from $\\delta i_{c,n}$ to $\\delta i_{p,n}$, we can construct a discrete-time state-space model with $\\delta i_{v,n}$ as the state variable. First, let's derive the state-update equation for $\\delta i_{v,n+1}$. Substitute equation (1) into (2):\n$$ \\delta i_{v,n+1} = (\\delta i_{v,n} + m_1 \\delta t_{on,n}) + m_2 \\delta t_{on,n} = \\delta i_{v,n} + (m_1 + m_2) \\delta t_{on,n} $$\nNow, substitute equation (3) into this expression:\n$$ \\delta i_{v,n+1} = \\delta i_{v,n} + (m_1 + m_2) \\left( \\frac{\\delta i_{c,n} - \\delta i_{v,n}}{m_1 + m_a} \\right) $$\nGrouping terms for $\\delta i_{v,n}$ and $\\delta i_{c,n}$ yields the state equation:\n$$ \\delta i_{v,n+1} = \\left( 1 - \\frac{m_1 + m_2}{m_1 + m_a} \\right) \\delta i_{v,n} + \\left( \\frac{m_1 + m_2}{m_1 + m_a} \\right) \\delta i_{c,n} $$\n$$ \\delta i_{v,n+1} = \\left( \\frac{m_a - m_2}{m_1 + m_a} \\right) \\delta i_{v,n} + \\left( \\frac{m_1 + m_2}{m_1 + m_a} \\right) \\delta i_{c,n} $$\nNext, we derive the output equation for $\\delta i_{p,n}$. Substitute equation (3) into (1):\n$$ \\delta i_{p,n} = \\delta i_{v,n} + m_1 \\left( \\frac{\\delta i_{c,n} - \\delta i_{v,n}}{m_1 + m_a} \\right) $$\nGrouping terms gives the output equation:\n$$ \\delta i_{p,n} = \\left( 1 - \\frac{m_1}{m_1 + m_a} \\right) \\delta i_{v,n} + \\left( \\frac{m_1}{m_1 + m_a} \\right) \\delta i_{c,n} $$\n$$ \\delta i_{p,n} = \\left( \\frac{m_a}{m_1 + m_a} \\right) \\delta i_{v,n} + \\left( \\frac{m_1}{m_1 + m_a} \\right) \\delta i_{c,n} $$\nThe problem specifies a disturbance at half the switching frequency, which corresponds to the discrete-time frequency $z = -1$. The input is $\\delta i_{c,n} = u_n = U(-1)^n$. In steady state, the state and output variables will respond at the same frequency. Let $\\delta i_{v,n} = Y(-1)^n$ and $\\delta i_{p,n} = X(-1)^n$, where $Y$ and $X$ are complex amplitudes.\n\nSubstitute these forms into the state equation:\n$$ Y(-1)^{n+1} = \\left( \\frac{m_a - m_2}{m_1 + m_a} \\right) Y(-1)^n + \\left( \\frac{m_1 + m_2}{m_1 + m_a} \\right) U(-1)^n $$\nDividing by $(-1)^n$, we get:\n$$ -Y = \\left( \\frac{m_a - m_2}{m_1 + m_a} \\right) Y + \\left( \\frac{m_1 + m_2}{m_1 + m_a} \\right) U $$\n$$ -Y \\left( 1 + \\frac{m_a - m_2}{m_1 + m_a} \\right) = \\left( \\frac{m_1 + m_2}{m_1 + m_a} \\right) U $$\n$$ -Y \\left( \\frac{m_1 + m_a + m_a - m_2}{m_1 + m_a} \\right) = \\left( \\frac{m_1 + m_2}{m_1 + m_a} \\right) U $$\n$$ -Y \\left( \\frac{m_1 + 2m_a - m_2}{m_1 + m_a} \\right) = \\left( \\frac{m_1 + m_2}{m_1 + m_a} \\right) U $$\nSolving for $Y$:\n$$ Y = -U \\left( \\frac{m_1 + m_2}{m_1 + 2m_a - m_2} \\right) $$\nNow, substitute the alternating forms into the output equation:\n$$ X(-1)^n = \\left( \\frac{m_a}{m_1 + m_a} \\right) Y(-1)^n + \\left( \\frac{m_1}{m_1 + m_a} \\right) U(-1)^n $$\nDividing by $(-1)^n$:\n$$ X = \\left( \\frac{m_a}{m_1 + m_a} \\right) Y + \\left( \\frac{m_1}{m_1 + m_a} \\right) U $$\nThe complex gain is $G_{1/2} = X/U$. Dividing by $U$:\n$$ G_{1/2} = \\frac{X}{U} = \\left( \\frac{m_a}{m_1 + m_a} \\right) \\frac{Y}{U} + \\left( \\frac{m_1}{m_1 + m_a} \\right) $$\nSubstitute the expression for $Y/U$:\n$$ G_{1/2} = \\left( \\frac{m_a}{m_1 + m_a} \\right) \\left( - \\frac{m_1 + m_2}{m_1 + 2m_a - m_2} \\right) + \\frac{m_1}{m_1 + m_a} $$\nCombine the terms over a common denominator:\n$$ G_{1/2} = \\frac{1}{m_1 + m_a} \\left[ - \\frac{m_a(m_1 + m_2)}{m_1 + 2m_a - m_2} + m_1 \\right] $$\n$$ G_{1/2} = \\frac{1}{m_1 + m_a} \\left[ \\frac{-m_a(m_1 + m_2) + m_1(m_1 + 2m_a - m_2)}{m_1 + 2m_a - m_2} \\right] $$\nExpand the numerator of the expression in the brackets:\n$$ -m_a m_1 - m_a m_2 + m_1^2 + 2m_1 m_a - m_1 m_2 = m_1^2 + m_1 m_a - m_1 m_2 - m_a m_2 $$\nFactor this expression by grouping:\n$$ m_1(m_1 + m_a) - m_2(m_1 + m_a) = (m_1 - m_2)(m_1 + m_a) $$\nSubstitute this simplified numerator back into the equation for $G_{1/2}$:\n$$ G_{1/2} = \\frac{1}{m_1 + m_a} \\left[ \\frac{(m_1 - m_2)(m_1 + m_a)}{m_1 + 2m_a - m_2} \\right] $$\nThe term $(m_1 + m_a)$ cancels, yielding the final expression for the complex gain:\n$$ G_{1/2} = \\frac{m_1 - m_2}{m_1 + 2m_a - m_2} $$\nThis expression depends only on $m_1$, $m_2$, and $m_a$, as requested. The gain becomes infinite when the denominator is zero, $m_1 + 2m_a - m_2 = 0$, which corresponds to the well-known boundary for subharmonic instability $m_a = (m_2 - m_1)/2$.",
            "answer": "$$ \\boxed{\\frac{m_1 - m_2}{m_1 + 2m_a - m_2}} $$"
        }
    ]
}