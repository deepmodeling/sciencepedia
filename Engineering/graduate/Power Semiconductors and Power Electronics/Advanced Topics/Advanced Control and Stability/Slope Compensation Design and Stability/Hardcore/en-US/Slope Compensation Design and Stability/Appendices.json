{
    "hands_on_practices": [
        {
            "introduction": "Peak current-mode control is a powerful technique, yet it harbors a potential instability known as subharmonic oscillation, especially for duty cycles $D$ exceeding $0.5$. This first practice guides you through a fundamental analysis of a buck converter to derive this exact instability threshold from first principles . Mastering this derivation solidifies the core reason why slope compensation is an indispensable tool in the power electronics designer's toolkit.",
            "id": "3880021",
            "problem": "An ideal step-down direct current-to-direct current ($\\mathrm{DC}$-$\\mathrm{DC}$) buck converter employs a Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET) power switch and a diode. The converter is controlled by peak current-mode control with a trailing-edge pulse-width modulation (PWM) comparator. A linear compensation ramp of slope $m_{a}$ (in $\\mathrm{A}/\\mathrm{s}$) may be summed to the sensed inductor current. The inductor has inductance $L$, the switching period is $T_{s}$, the input voltage is $V_{g}$, and the steady-state duty cycle is $D \\in (0,1)$. Under ideal conditions the output voltage is $V_{o} = D V_{g}$. The load is such that the average inductor current equals the load current $I_{o}$.\n\nUsing only the inductor law $v_{L} = L \\, \\frac{di_{L}}{dt}$, the ideal buck conversion relation $V_{o} = D V_{g}$, and the definition of peak current-mode control with an added linear compensation ramp, do the following:\n\n1) Starting from the inductor law and the triangular ripple shape of $i_{L}(t)$ over a switching cycle, derive an analytic expression for the minimum average inductor current $I_{o,\\min}(D)$ required to maintain Continuous Conduction Mode (CCM), where CCM is defined as $i_{L}(t)  0$ for all $t$. Your derivation must explicitly use $L$, $T_{s}$, $V_{g}$, and $D$.\n\n2) Starting from the sampled-data interpretation of peak current-mode control with a linear compensation ramp, derive the one-cycle perturbation map for small deviations of the inductor current at the beginning of a cycle. From this, determine the single duty threshold $D_{c}$ such that, in the absence of slope compensation ($m_{a} = 0$), subharmonic instability occurs for $D  D_{c}$ and does not occur for $D  D_{c}$. Conclude the duty range where slope compensation must be ensured to avoid subharmonic oscillation.\n\nAnswer specification:\n- Provide your final results as two closed-form analytic expressions:\n  (i) $I_{o,\\min}(D)$ in Amperes,\n  (ii) the unitless duty threshold $D_{c}$ as a single number.\n- No numerical evaluation or rounding is required; provide exact symbolic expressions.",
            "solution": "The analysis begins from fundamental laws and core definitions for the buck converter and peak current-mode control. First, we obtain the duty-dependent condition for Continuous Conduction Mode (CCM) from the inductor law. Second, we derive the sampled-data current perturbation map under peak current-mode control with a linear compensation ramp, and we extract the condition identifying the duty threshold above which slope compensation must be ensured.\n\nPart 1: Duty-dependent CCM condition.\n\nThe inductor obeys $v_{L} = L \\, \\frac{di_{L}}{dt}$. In an ideal buck converter with input voltage $V_{g}$, output voltage $V_{o} = D V_{g}$ and duty cycle $D$, the inductor experiences two affine current slopes each cycle:\n\n- During the switch on-time, $0 \\le t \\le D T_{s}$, the inductor voltage is $v_{L,\\mathrm{on}} = V_{g} - V_{o} = V_{g} - D V_{g} = V_{g}(1 - D)$, hence the up-slope of the inductor current is\n$$\nm_{1} = \\frac{di_{L}}{dt}\\Big|_{\\mathrm{on}} = \\frac{V_{g}(1 - D)}{L}.\n$$\n\n- During the off-time, $D T_{s} \\le t \\le T_{s}$, the inductor voltage is $v_{L,\\mathrm{off}} = - V_{o} = - D V_{g}$, hence the down-slope magnitude is\n$$\nm_{2} = \\left|\\frac{di_{L}}{dt}\\Big|_{\\mathrm{off}}\\right| = \\frac{D V_{g}}{L}.\n$$\n\nIn steady state, the inductor current ripple is triangular and its peak-to-peak amplitude in one cycle is equal whether computed over the on-interval or off-interval:\n$$\n\\Delta i_{L} = m_{1} \\, D T_{s} = m_{2} \\, (1 - D) T_{s}.\n$$\nEither formula evaluates to the same quantity:\n$$\n\\Delta i_{L} = \\frac{V_{g}}{L} (1 - D) \\, D \\, T_{s}.\n$$\n\nThe average inductor current $I_{o}$ equals the load current under ideal conditions. The inductor current minimum over the cycle is\n$$\ni_{L,\\min} = I_{o} - \\frac{\\Delta i_{L}}{2}.\n$$\nContinuous Conduction Mode (CCM) requires $i_{L,\\min} > 0$, which leads to the duty-dependent condition\n$$\nI_{o} > \\frac{\\Delta i_{L}}{2} = \\frac{1}{2} \\frac{V_{g}}{L} (1 - D) \\, D \\, T_{s}.\n$$\nThus, the minimum average current required to guarantee CCM as a function of duty is\n$$\nI_{o,\\min}(D) = \\frac{V_{g} \\, T_{s}}{2 L} D (1 - D).\n$$\n\nPart 2: Duty threshold for subharmonic instability and slope compensation necessity.\n\nWe analyze peak current-mode control using a sampled-data map of the inductor current perturbation. Let a small deviation $\\delta i_{n}$ be present at the beginning of cycle $n$. The controller compares the sensed inductor current plus a linear compensation ramp against a fixed reference. The sensed signal during the on-time may be represented as a sum with effective slope\n$$\ns_{\\mathrm{on}}(t) = i_{L}(0) + (m_{1} + m_{a}) t,\n$$\nwhere $m_{a}$ is the slope of the linear compensation ramp in $\\mathrm{A}/\\mathrm{s}$. The comparator crossing time determines the instantaneous duty $d_{n}$ in that cycle via $s_{\\mathrm{on}}(d_{n} T_{s}) = \\text{constant}$. For small perturbations, linearizing the crossing condition yields the relationship between the duty perturbation $\\delta d_{n}$ and the initial current perturbation $\\delta i_{n}$:\n$$\n(m_{1} + m_{a}) T_{s} \\, \\delta d_{n} + \\delta i_{n} = 0 \\quad \\Rightarrow \\quad \\delta d_{n} = - \\frac{\\delta i_{n}}{(m_{1} + m_{a}) T_{s}}.\n$$\n\nThe inductor current at the end of cycle $n$ is the sum of the initial current and changes over the on and off subintervals. The one-cycle update of the perturbation at the beginning of cycle $n+1$ equals the perturbation at the end of cycle $n$. Linearizing in $\\delta d_{n}$,\n$$\n\\delta i_{n+1} = \\delta i_{n} + m_{1} T_{s} \\, \\delta d_{n} - m_{2} T_{s} \\, (-\\delta d_{n}) = \\delta i_{n} + (m_{1} + m_{2}) T_{s} \\, \\delta d_{n}.\n$$\nSubstituting $\\delta d_{n}$ from the crossing linearization,\n$$\n\\delta i_{n+1} = \\delta i_{n} + (m_{1} + m_{2}) T_{s} \\left( - \\frac{\\delta i_{n}}{(m_{1} + m_{a}) T_{s}} \\right) = \\delta i_{n} \\left( 1 - \\frac{m_{1} + m_{2}}{m_{1} + m_{a}} \\right).\n$$\nTherefore the perturbation map is\n$$\n\\delta i_{n+1} = \\alpha \\, \\delta i_{n}, \\quad \\text{with} \\quad \\alpha = \\frac{m_{a} - m_{2}}{m_{1} + m_{a}}.\n$$\n\nSubharmonic instability (period-doubling) arises when the sampled-data eigenvalue $\\alpha$ is less than or equal to -1. For stability, we require $|\\alpha|  1$, which is equivalent to $-1  \\alpha  1$.\n\nThe first condition, $\\alpha  1$, is:\n$$\n\\frac{m_{a} - m_{2}}{m_{1} + m_{a}}  1 \\implies m_a - m_2  m_1 + m_a \\implies -m_2  m_1\n$$\nThis is always true since both slopes are positive magnitudes.\n\nThe second condition, $\\alpha > -1$, provides the critical design constraint:\n$$\n\\frac{m_{a} - m_{2}}{m_{1} + m_{a}} > -1 \\implies m_a - m_2 > -(m_1 + m_a) \\implies 2m_a > m_2 - m_1\n$$\nThus, the general stability condition is $m_a > \\frac{m_2 - m_1}{2}$.\n\nIn the absence of slope compensation ($m_{a} = 0$), this stability condition reduces to $0 > m_{2} - m_{1}$, or $m_{1} > m_{2}$. For the buck converter, this becomes:\n$$\n\\frac{V_{g}(1 - D)}{L} > \\frac{D V_{g}}{L} \\quad \\Leftrightarrow \\quad 1 - D > D \\quad \\Leftrightarrow \\quad D  \\frac{1}{2}.\n$$\nHence the duty threshold is\n$$\nD_{c} = \\frac{1}{2},\n$$\nand slope compensation must be ensured to avoid subharmonic oscillation for duty cycles $D > D_{c}$. More generally, a sufficient design ensuring stability for all $D \\in (0,1)$ is to choose $m_{a}$ to satisfy the condition at the worst-case duty cycle. The minimum ramp slope that eliminates subharmonics at a given $D$ is\n$$\nm_{a,\\min}(D) = \\max\\!\\left( 0, \\, \\frac{m_{2} - m_{1}}{2} \\right) = \\max\\!\\left( 0, \\, \\frac{V_{g}}{2 L} (2 D - 1) \\right),\n$$\nwhich is strictly positive precisely for $D > \\frac{1}{2}$.\n\nCollecting the requested expressions, we have:\n- The CCM minimum average inductor current:\n$$\nI_{o,\\min}(D) = \\frac{V_{g} \\, T_{s}}{2 L} D (1 - D).\n$$\n- The unitless duty threshold for the onset of subharmonic instability without slope compensation:\n$$\nD_{c} = \\frac{1}{2}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{V_{g}\\,T_{s}}{2\\,L}\\,D\\,(1-D)  \\dfrac{1}{2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "Once the necessity of compensation is clear, the focus shifts to design. This exercise challenges you to apply stability analysis to an inverting buck-boost converter, where the instability condition depends on the duty cycle as $D/(1-D)$ . You will derive the general compensated stability condition and then calculate the specific ramp slope $m_a$ needed to ensure stability, turning theoretical knowledge into a concrete design procedure.",
            "id": "3879970",
            "problem": "An ideal inverting buck-boost direct current to direct current converter operating in continuous conduction mode (CCM) is controlled by peak current-mode control with constant switching frequency. The input voltage is fixed at $V_g$, the magnitude of the output voltage is $V_o$, and the duty ratio is $D \\in (0,1)$. Let the inductor value be $L$. During the switch on-interval, the inductor sees the input voltage, and during the off-interval, it sees the negative of the output voltage. Define the inductor current rise slope during the on-interval as $m_1$ and the magnitude of the inductor current fall slope during the off-interval as $m_2$.\n\n1) Starting only from the inductor constitutive law $v_L = L \\, \\frac{di_L}{dt}$ and periodic steady-state volt-second balance, derive expressions for $m_1$ and $m_2$ in terms of $V_g$, $V_o$, and $L$. Using these, and a sampled-data perturbation analysis of the peak current-mode control intersection with a fixed control reference in the absence of any artificial compensation ramp, derive the uncompensated fast-scale eigenvalue magnitude $\\lambda$ of the one-dimensional PoincarÃ© map and show that $\\lambda = \\frac{m_2}{m_1} = \\frac{V_o}{V_g} = \\frac{D}{1-D}$.\n\n2) Now include an artificial slope compensation ramp of equivalent current slope $m_a$ added to the sensed current during the on-interval. By repeating the sampled-data perturbation analysis with this artificial ramp, derive the compensated eigenvalue magnitude $|\\lambda_c|$ in terms of $m_1$, $m_2$, and $m_a$. Then, for $D = 0.75$, $V_g = 12$ V, and $L = 47$ $\\mu$H, compute the minimum $m_a$ that guarantees fast-scale stability, defined by the condition $|\\lambda_c|  1$. Express the final value of $m_a$ in A/$\\mu$s and round your answer to four significant figures.",
            "solution": "The problem is evaluated to be scientifically grounded, self-contained, and well-posed. The terminology and physical model are standard in the field of power electronics. I will proceed with a full derivation.\n\nThe problem is divided into two parts. The first part deals with an uncompensated system, and the second part introduces slope compensation.\n\n**Part 1: Uncompensated System Analysis**\n\nFirst, we derive the expressions for the inductor current slopes, $m_1$ and $m_2$. The problem states the inductor constitutive law is $v_L(t) = L \\frac{di_L(t)}{dt}$.\n\nDuring the switch on-interval, which has a duration of $DT_s$ where $T_s$ is the switching period, the inductor voltage is given as $v_L(t) = V_g$. The rate of change of inductor current is constant:\n$$ \\frac{di_L(t)}{dt} = \\frac{V_g}{L} $$\nThis slope is defined as $m_1$. Thus,\n$$ m_1 = \\frac{V_g}{L} $$\n\nDuring the switch off-interval, with duration $(1-D)T_s$, the inductor voltage is given as $v_L(t) = -V_o$. The rate of change of inductor current is also constant:\n$$ \\frac{di_L(t)}{dt} = -\\frac{V_o}{L} $$\nThe problem defines $m_2$ as the magnitude of this fall slope. Therefore,\n$$ m_2 = \\left| -\\frac{V_o}{L} \\right| = \\frac{V_o}{L} $$\n\nNext, we apply the principle of periodic steady-state volt-second balance on the inductor. This principle states that the average voltage across the inductor over one full switching period must be zero.\n$$ \\frac{1}{T_s} \\int_0^{T_s} v_L(t) \\, dt = 0 $$\n$$ \\frac{1}{T_s} \\left( \\int_0^{DT_s} V_g \\, dt + \\int_{DT_s}^{T_s} (-V_o) \\, dt \\right) = 0 $$\n$$ \\frac{1}{T_s} \\left( V_g (DT_s) - V_o ((1-D)T_s) \\right) = 0 $$\n$$ V_g D = V_o (1-D) $$\nThis yields the ideal voltage conversion ratio for a buck-boost converter in continuous conduction mode (CCM):\n$$ \\frac{V_o}{V_g} = \\frac{D}{1-D} $$\n\nUsing this relationship, we can relate the slopes $m_1$ and $m_2$:\n$$ \\frac{m_2}{m_1} = \\frac{V_o/L}{V_g/L} = \\frac{V_o}{V_g} $$\nCombining the results, we have shown that $\\frac{m_2}{m_1} = \\frac{V_o}{V_g} = \\frac{D}{1-D}$.\n\nNow, we derive the uncompensated fast-scale eigenvalue using a sampled-data perturbation analysis. Let the inductor current at the beginning of switching cycle $k$ be $i_L[k]$. Let the steady-state duty ratio be $D$ and the perturbed duty ratio in cycle $k$ be $d_k = D + \\hat{d}_k$. The inductor current at the start of cycle $k$ is perturbed, $i_L[k] = \\bar{I}_L[k] + \\hat{i}_L[k]$, where $\\bar{I}_L[k]$ is the steady-state component and $\\hat{i}_L[k]$ is the small perturbation.\n\nIn peak current-mode control without compensation, the switch turns off when the inductor current $i_L(t)$ reaches a fixed reference level $I_{ref}$.\nDuring the on-time of cycle $k$, the current evolves as $i_L(t) = i_L[k] + m_1 t$. The turn-off occurs at time $t = d_k T_s$.\n$$ i_L[k] + m_1 (d_k T_s) = I_{ref} $$\n$$ (\\bar{I}_L[k] + \\hat{i}_L[k]) + m_1 (D + \\hat{d}_k) T_s = I_{ref} $$\nThe steady-state condition is $\\bar{I}_L[k] + m_1 D T_s = I_{ref}$. Subtracting the steady-state equation from the perturbed equation gives the first-order perturbation dynamics:\n$$ \\hat{i}_L[k] + m_1 \\hat{d}_k T_s = 0 \\implies \\hat{d}_k T_s = -\\frac{\\hat{i}_L[k]}{m_1} $$\n\nThe inductor current at the end of cycle $k$ (which is the beginning of cycle $k+1$, i.e., $i_L[k+1]$) is found by considering the current decrease during the off-interval:\n$$ i_L[k+1] = i_L(d_k T_s) - m_2 (T_s - d_k T_s) $$\nSince $i_L(d_k T_s) = I_{ref}$, we have:\n$$ i_L[k+1] = I_{ref} - m_2 T_s(1 - d_k) = I_{ref} - m_2 T_s(1 - (D + \\hat{d}_k)) $$\n$$ \\bar{I}_L[k+1] + \\hat{i}_L[k+1] = I_{ref} - m_2 T_s(1-D) + m_2 \\hat{d}_k T_s $$\nThe steady-state value is $\\bar{I}_L[k+1] = \\bar{I}_L[k] = I_{ref} - m_2 T_s(1-D)$. Subtracting this leaves the perturbation evolution:\n$$ \\hat{i}_L[k+1] = m_2 \\hat{d}_k T_s $$\nSubstituting the expression for $\\hat{d}_k T_s$:\n$$ \\hat{i}_L[k+1] = m_2 \\left( -\\frac{\\hat{i}_L[k]}{m_1} \\right) = -\\frac{m_2}{m_1} \\hat{i}_L[k] $$\nThis is a one-dimensional discrete-time map for the perturbation, $\\hat{i}_L[k+1] = \\lambda_{eig} \\hat{i}_L[k]$. The eigenvalue of this map is $\\lambda_{eig} = -\\frac{m_2}{m_1}$.\nThe problem asks for the eigenvalue magnitude, which it denotes by the symbol $\\lambda$. Since $m_1$ and $m_2$ are positive:\n$$ \\lambda = |\\lambda_{eig}| = \\left|-\\frac{m_2}{m_1}\\right| = \\frac{m_2}{m_1} $$\nWe have already shown that $\\frac{m_2}{m_1} = \\frac{V_o}{V_g} = \\frac{D}{1-D}$. This completes the derivation for Part 1. For stability, it is required that $|\\lambda_{eig}|  1$, which means $\\frac{m_2}{m_1}  1$, or $D  0.5$.\n\n**Part 2: Compensated System Analysis**\n\nNow, an artificial compensation ramp of slope $m_a$ is added to the sensed current. The sensed signal becomes $i_s(t) = i_L(t) + m_a t$ during the on-interval. The switch turns off when $i_s(t) = I_{ref}$.\nAt the turn-off instant $t = d_k T_s$:\n$$ i_L(d_k T_s) + m_a (d_k T_s) = I_{ref} $$\nThe inductor current itself still follows $i_L(t) = i_L[k] + m_1 t$. Substituting this into the turn-off condition:\n$$ (i_L[k] + m_1 d_k T_s) + m_a d_k T_s = I_{ref} $$\n$$ i_L[k] + (m_1 + m_a) d_k T_s = I_{ref} $$\nPerforming the same perturbation analysis as before ($i_L[k] = \\bar{I}_L[k] + \\hat{i}_L[k]$, $d_k = D + \\hat{d}_k$):\n$$ (\\bar{I}_L[k] + \\hat{i}_L[k]) + (m_1 + m_a) (D + \\hat{d}_k) T_s = I_{ref} $$\nThe steady-state equation is $\\bar{I}_L[k] + (m_1 + m_a) D T_s = I_{ref}$. Subtracting this gives:\n$$ \\hat{i}_L[k] + (m_1 + m_a) \\hat{d}_k T_s = 0 \\implies \\hat{d}_k T_s = -\\frac{\\hat{i}_L[k]}{m_1 + m_a} $$\n\nNow we find the current at the start of the next cycle, $i_L[k+1]$. The falling portion of the current is not affected by the compensation ramp, which is only active during the on-time.\n$$ i_L[k+1] = i_L(d_k T_s) - m_2(T_s - d_k T_s) $$\nFrom the turn-off condition, we can express the peak current as $i_L(d_k T_s) = I_{ref} - m_a d_k T_s$.\n$$ i_L[k+1] = (I_{ref} - m_a d_k T_s) - m_2(T_s - d_k T_s) $$\n$$ i_L[k+1] = I_{ref} - m_2 T_s + (m_2 - m_a) d_k T_s $$\n$$ \\bar{I}_L[k+1] + \\hat{i}_L[k+1] = I_{ref} - m_2 T_s + (m_2 - m_a) (D + \\hat{d}_k) T_s $$\nThe steady-state equation is $\\bar{I}_L[k+1] = I_{ref} - m_2 T_s + (m_2 - m_a) D T_s$. Subtracting gives:\n$$ \\hat{i}_L[k+1] = (m_2 - m_a) \\hat{d}_k T_s $$\nSubstituting the expression for $\\hat{d}_k T_s$:\n$$ \\hat{i}_L[k+1] = (m_2 - m_a) \\left( -\\frac{\\hat{i}_L[k]}{m_1 + m_a} \\right) = -\\frac{m_2 - m_a}{m_1 + m_a} \\hat{i}_L[k] $$\nThe compensated eigenvalue is $\\lambda_c = -\\frac{m_2 - m_a}{m_1 + m_a}$.\nThe magnitude of the compensated eigenvalue is therefore:\n$$ |\\lambda_c| = \\left| -\\frac{m_2 - m_a}{m_1 + m_a} \\right| = \\frac{|m_2 - m_a|}{m_1 + m_a} $$\nThis is the required expression.\n\nFinally, we compute the minimum compensation slope $m_a$ that guarantees stability, defined by $|\\lambda_c|  1$, for the given parameters: $D = 0.75$, $V_g = 12$ V, and $L = 47$ $\\mu$H.\nThe stability boundary is at $|\\lambda_c| = 1$. The instability occurs when the eigenvalue crosses $-1$.\n$$ \\lambda_c = -1 \\implies -\\frac{m_2 - m_a}{m_1 + m_a} = -1 $$\n$$ m_2 - m_a = m_1 + m_a $$\n$$ m_2 - m_1 = 2 m_a $$\nThe minimum required slope to ensure stability ($|\\lambda_c|$ is just less than $1$) is therefore:\n$$ m_{a,min} = \\frac{m_2 - m_1}{2} $$\nThis condition is only necessary if $m_2 > m_1$, which corresponds to $D > 0.5$. With $D=0.75$, compensation is indeed required.\n\nNow, we calculate the numerical values. The units of the slopes will be in A/$\\mu$s. We have $L = 47$ $\\mu$H $= 47$ V$\\cdot\\mu$s/A.\nThe inductor current rise slope is:\n$$ m_1 = \\frac{V_g}{L} = \\frac{12 \\text{ V}}{47 \\text{ } \\mu\\text{H}} = \\frac{12}{47} \\text{ A/}\\mu\\text{s} $$\nTo find $m_2$, we first find the output voltage $V_o$:\n$$ V_o = V_g \\frac{D}{1-D} = 12 \\text{ V} \\times \\frac{0.75}{1-0.75} = 12 \\text{ V} \\times \\frac{0.75}{0.25} = 12 \\text{ V} \\times 3 = 36 \\text{ V} $$\nThe inductor current fall slope magnitude is:\n$$ m_2 = \\frac{V_o}{L} = \\frac{36 \\text{ V}}{47 \\text{ } \\mu\\text{H}} = \\frac{36}{47} \\text{ A/}\\mu\\text{s} $$\nNow we can compute the minimum compensation slope:\n$$ m_{a,min} = \\frac{m_2 - m_1}{2} = \\frac{1}{2} \\left( \\frac{36}{47} - \\frac{12}{47} \\right) \\text{ A/}\\mu\\text{s} $$\n$$ m_{a,min} = \\frac{1}{2} \\left( \\frac{24}{47} \\right) \\text{ A/}\\mu\\text{s} = \\frac{12}{47} \\text{ A/}\\mu\\text{s} $$\nConverting this to a numerical value:\n$$ m_{a,min} = \\frac{12}{47} \\approx 0.25531914... \\text{ A/}\\mu\\text{s} $$\nRounding to four significant figures, we get:\n$$ m_{a,min} \\approx 0.2553 \\text{ A/}\\mu\\text{s} $$",
            "answer": "$$\\boxed{0.2553}$$"
        },
        {
            "introduction": "A theoretically sound design must prove its worth against real-world imperfections. This final practice introduces the practical effect of temperature variation on the compensation circuitry, a common challenge in robust system design . By calculating the required design margin to maintain stability over a wide temperature range, you will learn how to bridge the gap between an ideal model and a reliable, production-ready converter.",
            "id": "3879990",
            "problem": "A peak current-mode controlled buck converter in Continuous Conduction Mode (CCM) uses a trailing-edge Pulse Width Modulation (PWM) comparator. The peak inductor current is sensed with unity gain and summed with a linear compensation ramp of slope $m_{a}$, applied only during the switch on-time. The comparator turns the switch off when the sum of the sensed current and the ramp reaches a fixed control reference. The inductor is ideal, and the control reference is constant over a switching period. The inductor obeys $v_{L} = L \\, di_{L}/dt$. Let the input voltage be $V_{\\mathrm{in}} = 24\\,\\mathrm{V}$, the output voltage be $V_{\\mathrm{out}} = 17\\,\\mathrm{V}$, and the inductance be $L = 15\\,\\mu\\mathrm{H}$. Define the rising inductor-current slope during the on-time as $m_{1}$ and the falling slope during the off-time as $m_{2}$.\n\nStarting from $v_{L} = L \\, di_{L}/dt$ and the timing condition for the comparator crossing, derive the sampled return map for a small perturbation in peak inductor current from cycle to cycle. From this, obtain the discrete-time eigenvalue $\\lambda$ that governs the cycle-to-cycle evolution of the peak-current perturbation in terms of $m_{1}$, $m_{2}$, and $m_{a}$, and deduce the corresponding compensation condition for stability $\\lvert \\lambda \\rvert  1$.\n\nThe compensation ramp slope has a linear Temperature Coefficient (TC), defined as $\\beta_{m_{a}} = \\frac{1}{m_{a}} \\frac{\\partial m_{a}}{\\partial T}$, which is constant over temperature. Model the temperature dependence as\n$$\nm_{a}(T) = m_{a,25} \\left[ 1 + \\beta_{m_{a}} \\left( T - 25 \\right) \\right],\n$$\nwhere $T$ is in $\\mathrm{^{\\circ}C}$ and $m_{a,25}$ is the ramp slope at $25\\,\\mathrm{^{\\circ}C}$. The ambient temperature range is from $-40\\,\\mathrm{^{\\circ}C}$ to $85\\,\\mathrm{^{\\circ}C}$, and the ramp generator has $\\beta_{m_{a}} = -800 \\times 10^{-6} \\,\\mathrm{^{\\circ}C^{-1}}$.\n\nLet $m_{a,\\mathrm{thr}}$ denote the threshold compensation slope obtained from your stability condition. Determine the minimum fractional margin $\\mu$ such that choosing $m_{a,25} = \\left( 1 + \\mu \\right) m_{a,\\mathrm{thr}}$ guarantees $\\lvert \\lambda \\rvert  1$ for all $T$ in the specified temperature range. Express the final margin $\\mu$ as a decimal fraction (dimensionless) and round your answer to four significant figures.",
            "solution": "The problem asks for the minimum fractional margin $\\mu$ for the slope compensation of a peak current-mode controlled buck converter to ensure stability over a specified temperature range. The solution requires several steps: deriving the stability criterion, calculating the threshold compensation, and then incorporating the temperature-dependent effects to find the required margin.\n\nFirst, we define the inductor current slopes during the on-time and off-time. The inductor voltage is given by $v_{L} = L \\frac{di_{L}}{dt}$.\nDuring the switch on-time, the voltage across the ideal inductor is $v_{L} = V_{\\mathrm{in}} - V_{\\mathrm{out}}$. The rising slope of the inductor current, $m_{1}$, is:\n$$m_{1} = \\frac{di_{L}}{dt} = \\frac{V_{\\mathrm{in}} - V_{\\mathrm{out}}}{L}$$\nDuring the switch off-time, the inductor voltage is $v_{L} = -V_{\\mathrm{out}}$. The magnitude of the falling slope of the inductor current, $m_{2}$, is:\n$$m_{2} = \\left| \\frac{di_{L}}{dt} \\right| = \\left| \\frac{-V_{\\mathrm{out}}}{L} \\right| = \\frac{V_{\\mathrm{out}}}{L}$$\n\nNext, we derive the sampled return map for a small perturbation in the inductor current. Let's analyze the system dynamics on a cycle-by-cycle basis. Let $i_{v,n}$ be the valley current at the beginning of the $n$-th switching cycle and $d_n T_s$ be the on-time during that cycle, where $T_s$ is the switching period.\nThe inductor current at time $t$ during the on-time (starting from $t=0$ at the beginning of the cycle) is $i_L(t) = i_{v,n} + m_1 t$. The compensation ramp signal is $S_e(t) = m_a t$. The switch turns off at $t=d_n T_s$ when the sum of the sensed current and the compensation ramp reaches the control reference $I_{\\mathrm{ref}}$:\n$$i_L(d_n T_s) + S_e(d_n T_s) = I_{\\mathrm{ref}}$$\nSubstituting the expressions for the current and ramp:\n$$(i_{v,n} + m_1 d_n T_s) + m_a d_n T_s = I_{\\mathrm{ref}}$$\n$$i_{v,n} + (m_1 + m_a) d_n T_s = I_{\\mathrm{ref}}$$\nWe can express the on-time perturbation $\\hat{d}_n T_s$ in terms of the valley current perturbation $\\hat{i}_{v,n}$ by linearizing this equation around the steady-state operating point (denoted by uppercase letters $I_V, D$):\n$$(I_V + \\hat{i}_{v,n}) + (m_1 + m_a) (D + \\hat{d}_n) T_s = I_{\\mathrm{ref}}$$\nThe steady-state part is $I_V + (m_1 + m_a) D T_s = I_{\\mathrm{ref}}$. The small-signal perturbation equation is:\n$$\\hat{i}_{v,n} + (m_1 + m_a) \\hat{d}_n T_s = 0 \\implies \\hat{d}_n T_s = -\\frac{\\hat{i}_{v,n}}{m_1 + m_a}$$\nNow we relate the valley current of the next cycle, $i_{v,n+1}$, to the peak current of the current cycle, $i_{p,n}$. The peak current is $i_{p,n} = i_{v,n} + m_1 d_n T_s$. The next valley current is $i_{v,n+1} = i_{p,n} - m_2(1-d_n)T_s$.\nLinearizing these two relationships gives:\n$$\\hat{i}_{p,n} = \\hat{i}_{v,n} + m_1 \\hat{d}_n T_s$$\n$$\\hat{i}_{v,n+1} = \\hat{i}_{p,n} + m_2 \\hat{d}_n T_s$$\nSubstituting the expression for $\\hat{d}_n T_s$ into the equation for $\\hat{i}_{p,n}$:\n$$\\hat{i}_{p,n} = \\hat{i}_{v,n} + m_1 \\left(-\\frac{\\hat{i}_{v,n}}{m_1 + m_a}\\right) = \\left(1 - \\frac{m_1}{m_1+m_a}\\right) \\hat{i}_{v,n} = \\left(\\frac{m_a}{m_1+m_a}\\right) \\hat{i}_{v,n}$$\nNow substitute both $\\hat{i}_{p,n}$ and $\\hat{d}_n T_s$ into the equation for $\\hat{i}_{v,n+1}$:\n$$\\hat{i}_{v,n+1} = \\left(\\frac{m_a}{m_1+m_a}\\right) \\hat{i}_{v,n} + m_2 \\left(-\\frac{\\hat{i}_{v,n}}{m_1 + m_a}\\right) = \\left(\\frac{m_a - m_2}{m_1 + m_a}\\right) \\hat{i}_{v,n}$$\nThis is the sampled return map for the valley current perturbation. As the problem requested the map for the peak current perturbation $\\hat{i}_{p,n}$, we note that $\\hat{i}_{p,n}$ is linearly proportional to $\\hat{i}_{v,n}$. Thus, $\\hat{i}_{p,n+1} \\propto \\hat{i}_{v,n+1}$ and the same eigenvalue governs its evolution: $\\hat{i}_{p,n+1} = \\lambda \\hat{i}_{p,n}$. The discrete-time eigenvalue $\\lambda$ is:\n$$\\lambda = \\frac{m_a - m_2}{m_1 + m_a}$$\nFor stability, the magnitude of the eigenvalue must be less than $1$, i.e., $|\\lambda|  1$.\n$$\\left| \\frac{m_a - m_2}{m_1 + m_a} \\right|  1$$\nThis expands to two inequalities: $-(m_1 + m_a)  m_a - m_2  m_1 + m_a$.\nThe right-hand inequality, $m_a - m_2  m_1 + m_a$, simplifies to $-m_2  m_1$, which is always true since $m_1$ and $m_2$ are positive slopes.\nThe left-hand inequality gives the non-trivial stability condition:\n$$m_a - m_2 > -(m_1 + m_a)$$\n$$2m_a > m_2 - m_1$$\n$$m_a > \\frac{m_2 - m_1}{2}$$\nThe problem defines the threshold compensation slope, $m_{a,\\mathrm{thr}}$, as the value at the boundary of this condition.\n$$m_{a,\\mathrm{thr}} = \\frac{m_2 - m_1}{2}$$\nUsing the given converter parameters, we calculate $m_{a,\\mathrm{thr}}$:\n$V_{\\mathrm{in}} = 24\\,\\mathrm{V}$, $V_{\\mathrm{out}} = 17\\,\\mathrm{V}$, $L = 15\\,\\mu\\mathrm{H} = 15 \\times 10^{-6}\\,\\mathrm{H}$.\n$$m_1 = \\frac{24 - 17}{15 \\times 10^{-6}} = \\frac{7}{15 \\times 10^{-6}} \\, \\mathrm{A/s}$$\n$$m_2 = \\frac{17}{15 \\times 10^{-6}} \\, \\mathrm{A/s}$$\n$$m_{a,\\mathrm{thr}} = \\frac{1}{2} \\left( \\frac{17}{15 \\times 10^{-6}} - \\frac{7}{15 \\times 10^{-6}} \\right) = \\frac{1}{2} \\frac{10}{15 \\times 10^{-6}} = \\frac{10}{30 \\times 10^{-6}} = \\frac{1}{3} \\times 10^6 \\, \\mathrm{A/s}$$\nThe compensation slope $m_a$ is temperature-dependent, following the model:\n$$m_{a}(T) = m_{a,25} \\left[ 1 + \\beta_{m_{a}} \\left( T - 25 \\right) \\right]$$\nwhere $\\beta_{m_{a}} = -800 \\times 10^{-6} \\,\\mathrm{^{\\circ}C^{-1}}$ and the temperature range is $T \\in [-40, 85]\\, \\mathrm{^{\\circ}C}$.\nFor stability across the entire temperature range, the condition $m_a(T) > m_{a,\\mathrm{thr}}$ must always be met. We must find the minimum value of $m_a(T)$ in the given range. Since $\\beta_{m_a}$ is negative, the term $1 + \\beta_{m_a}(T-25)$ is minimized when $T$ is maximized. The worst-case temperature is $T_{\\mathrm{max}} = 85\\,\\mathrm{^{\\circ}C}$.\nThe stability condition at this temperature is:\n$$m_a(85) > m_{a,\\mathrm{thr}}$$\n$$m_{a,25} \\left[ 1 + \\beta_{m_a} (85 - 25) \\right] > m_{a,\\mathrm{thr}}$$\nThe nominal slope at $25\\,\\mathrm{^{\\circ}C}$ is set with a fractional margin $\\mu$: $m_{a,25} = (1 + \\mu) m_{a,\\mathrm{thr}}$. Substituting this into the inequality:\n$$(1+\\mu)m_{a,\\mathrm{thr}} \\left[ 1 + \\beta_{m_a} (60) \\right] > m_{a,\\mathrm{thr}}$$\nSince $m_{a,\\mathrm{thr}} > 0$, we can divide by it:\n$$(1+\\mu) \\left[ 1 + \\beta_{m_a} (60) \\right] > 1$$\n$$1+\\mu > \\frac{1}{1 + \\beta_{m_a} (60)}$$\n$$\\mu > \\frac{1}{1 + \\beta_{m_a} (60)} - 1$$\nThe minimum required margin $\\mu$ is this lower bound. Plugging in the value for $\\beta_{m_a}$:\n$$\\mu_{\\mathrm{min}} = \\frac{1}{1 + (-800 \\times 10^{-6})(60)} - 1$$\n$$\\mu_{\\mathrm{min}} = \\frac{1}{1 - 48000 \\times 10^{-6}} - 1 = \\frac{1}{1 - 0.048} - 1 = \\frac{1}{0.952} - 1$$\n$$\\mu_{\\mathrm{min}} = 1.050420168... - 1 = 0.050420168...$$\nRounding to four significant figures, we get $\\mu = 0.05042$.",
            "answer": "$$\\boxed{0.05042}$$"
        }
    ]
}