## 引言
在现代[电力](@entry_id:264587)电子系统中，对输出电压和电流[频谱](@entry_id:276824)的精确控制是提升[电能质量](@entry_id:1130058)、系统效率和可靠性的核心。[选择性谐波消除](@entry_id:1131396)（SHE）与随机[脉宽调制](@entry_id:262754)（RPWM）是实现这一目标的两大关键调制技术，它们通过截然不同的方法，解决了从低频[谐波](@entry_id:181533)污染到高频电磁干扰（EMI）的一系列问题。然而，要有效地应用这些技术，工程师必须深刻理解其背后的数学原理、固有的局限性以及在复杂系统中的相互作用。本文旨在弥合理论与实践之间的鸿沟，为读者提供一个关于SHE和RPWM的全面视角。

在接下来的内容中，我们将分三章进行深入探讨。第一章“原理与机制”将奠定理论基础，从[傅里叶分析](@entry_id:137640)入手，详细推导SHE的数学模型，并介绍RPWM重塑谐波[频谱](@entry_id:276824)的核心思想。第二章“应用与交叉学科联系”将视野拓宽至实际工程场景，分析这些技术在[多电平逆变器](@entry_id:1128307)、电机驱动声学噪声控制、EMI合规以及并网系统中的具体应用与挑战。最后，第三章“动手实践”将通过一系列精心设计的问题，引导读者将理论知识应用于解决具体的工程计算与分析任务。通过这一结构化的学习路径，读者将能够系统地掌握SHE和RPWM的设计、分析与应用。

## 原理与机制

本章深入探讨[选择性谐波消除](@entry_id:1131396)（SHE）和随机[脉宽调制](@entry_id:262754)（RPWM）的基本原理与核心机制。我们将从构建理想电压波形的[傅里叶级数](@entry_id:139455)分析入手，揭示如何利用波形对称性精确消除特定[谐波](@entry_id:181533)。随后，我们将建立SHE的数学模型，并探讨其实施过程中面临的挑战，如调制死区和数值求解的复杂性。最后，我们将介绍作为SHE补充或替代方案的加权[谐波](@entry_id:181533)整形（WHS）和随机[脉宽调制](@entry_id:262754)（RPWM），分析它们在改善电能质量和控制电磁干扰方面的独特优势与理论基础。

### [选择性谐波消除](@entry_id:1131396)（SHE）原理

[选择性谐波消除](@entry_id:1131396)（SHE）是一种低开关频率的[脉宽调制](@entry_id:262754)（PWM）技术，其核心思想是通过精确控制功率半导体器件在每个基波周期内的开关时刻，主动构建一种输出电压波形，使其傅里叶级数展开中不包含某些指定的低[次谐波](@entry_id:171489)分量。实现这一目标的关键工具是引入特定的波形对称性。

#### 波形对称性的运用

在[电力](@entry_id:264587)电子逆变器中，通过精心设计的开关序列，可以强制输出电压波形具备某些对称性，这些对称性会极大地简化其[谐波](@entry_id:181533)[频谱](@entry_id:276824)。

首先，**半波对称性**，也称为奇[谐波](@entry_id:181533)对称性，其数学定义为 $v(t) = -v(t + T/2)$，其中 $T$ 是基波周期。这一特性对波形的[谐波含量](@entry_id:1125926)有深刻影响。根据傅里叶级数的定义，我们可以证明，任何满足半波对称性的周期波形，其直流分量以及所有偶[次谐波](@entry_id:171489)分量都必定为零 。这意味着[傅里叶级数](@entry_id:139455)中仅包含奇[次谐波](@entry_id:171489)。这一性质是极其有利的，因为它自然地滤除了直流偏置和最常见的一组干扰谐波（偶次谐波），使我们能够将控制精力完[全集](@entry_id:264200)中在处理剩余的奇[次谐波](@entry_id:171489)上。

其次，在半波对称性的基础上，我们通常会进一步引入**四分之一波对称性**。对于一个具有半波对称性的波形，四分之一波对称性通常表现为在前半周期内关于 $t=T/4$（或电角度 $\theta=\pi/2$）点呈偶对称，即在 $[0, T/2]$ 区间内满足 $v(t) = v(T/2 - t)$。当这两种对称性结合时，波形在[傅里叶级数](@entry_id:139455)展开中所有的余弦分量 ($a_n$) 也将为零。最终，电压波形可以表示为一个仅包含奇次正弦谐波的纯正弦级数：

$$
v(\theta) = \sum_{n=1,3,5,\dots}^{\infty} b_n \sin(n\theta)
$$

这种高度对称的结构意味着，我们只需确定第一个四分之一周期（即 $\theta \in [0, \pi/2]$ 区间）内的开关模式，就可以通过对称性确定整个周期的波形。这极大地简化了分析和计算的复杂性 。

### SHE的数学模型

利用四分之一波对称性，我们可以将SHE问题转化为一个求解开关角度的数学问题。考虑一个单相两电平[全桥逆变器](@entry_id:1125871)，其输出在 $\pm V_{\text{dc}}$ 之间切换。假设在第一个四分之一周期内，我们设置了 $N$ 个开关角 $0 < \alpha_1 < \alpha_2 < \dots < \alpha_N < \pi/2$。

对于这样一个阶梯波，第 $n$ [次谐波](@entry_id:171489)（$n$ 为奇数）的幅值 $b_n$ 可以通过对第一个四分之一周期的波形进行傅里叶积分得到。其通用表达式为 ：

$$
b_n = \frac{4V_{\text{dc}}}{n\pi} \left( 1 + 2\sum_{k=1}^{N} (-1)^k \cos(n\alpha_k) \right)
$$

这个公式是SHE技术的核心。它将离散的开关角度 $\alpha_k$ 与连续的[谐波](@entry_id:181533)[频谱](@entry_id:276824) $b_n$ 直接关联起来。SHE的目标是：1) 将基波分量 ($n=1$) 的幅值 $V_1 = b_1$ 控制到[期望值](@entry_id:150961)，通常由调制比 $m$ 定义；2) 将一组指定的低次谐波（例如3次、5次、7次等）的幅值设为零。

对于 $N$ 个开关角（即 $N$ 个自由度），我们最多可以设定 $N$ 个独立的约束条件。通常，我们用一个约束来控制基波幅值，剩下的 $N-1$ 个约束用来消除 $N-1$ 个谐波  。这形成了一个包含 $N$ 个未知数（$\alpha_1, \dots, \alpha_N$）和 $N$ 个方程的[非线性](@entry_id:637147)[超越方程](@entry_id:276279)组。例如，若要消除谐波集合 $\mathcal{H} = \{h_1, h_2, \dots, h_{N-1}\}$，则需求解如下方程组 ：

$$
\begin{cases}
    1 + 2\sum_{k=1}^{N} (-1)^k \cos(\alpha_k) - \frac{m\pi}{4} = 0 \\
    1 + 2\sum_{k=1}^{N} (-1)^k \cos(h_1\alpha_k) = 0 \\
     \vdots \\
    1 + 2\sum_{k=1}^{N} (-1)^k \cos(h_{N-1}\alpha_k) = 0
\end{cases}
$$

其中，调制比 $m$ 通常定义为基波峰值与基准直流电压的比值，例如 $m = V_1 / V_{\text{dc}}$，这里的 $V_1$ 是指 $b_1$。上述方程组的解 $\boldsymbol{\alpha} = \{\alpha_k\}$ 必须满足物理约束 $0 < \alpha_1 < \dots < \alpha_N < \pi/2$。

### SHE的挑战与扩展

#### 调制[死区](@entry_id:183758)与多重解

求解SHE方程组并非易事。由于方程的高度[非线性](@entry_id:637147)，其解具有复杂的特性 ：
1.  **解的存在性**：并非对于所有期望的调制比 $m \in (0, 1)$ 都存在满足物理约束的实数解。那些不存在解的 $m$ 值区间被称为**调制死区** (modulation dead bands)。在这些[死区](@entry_id:183758)内，无法通过SHE技术生成期望的基波电压并同时消除指定谐波。
2.  **解的非唯一性**：在允许存在解的 $m$ 值区间内，可能会存在多组不同的开关角度[解集](@entry_id:154326)，它们都能满足相同的[谐波](@entry_id:181533)消除目标。这种多值性为系统控制提供了额外的灵活性，但也增加了复杂性。
3.  **[分岔](@entry_id:270606)现象**：当我们将开关角度解 $\alpha_k$ 视为调制比 $m$ 的函数时，解的路径会展现出**分岔** (bifurcations) 和**转折点** (turning points)。在这些点上，[雅可比矩阵](@entry_id:178326) $J(\boldsymbol{\alpha}) = \partial F / \partial \boldsymbol{\alpha}$ 会变得奇异，导致解的局部唯一性丧失。

#### 数值求解：[同伦延拓](@entry_id:634008)法

由于上述复杂性，简单的数值迭代方法（如标[准牛顿法](@entry_id:138962)）在求解SHE方程时可能会在转折点附近发散或失败。为了稳健地追踪整个[解路径](@entry_id:755046)（即 $\boldsymbol{\alpha}(m)$），需要采用更先进的数值技术，如**[同伦延拓](@entry_id:634008)法** (homotopy continuation) 。

[同伦延拓](@entry_id:634008)法的核心思想是将原问题嵌入一个更广泛的、含参数的“[同伦](@entry_id:139266)”问题中，并从一个已知的简单解出发，通过逐步改变参数，连续地[追踪解](@entry_id:159403)的路径直至目标问题。特别是**[伪弧长延拓法](@entry_id:637668)** (pseudo-arc-length continuation)，它将调制比 $m$ 视为与开关角同等地位的变量，并沿着解曲线的[弧长](@entry_id:191173)进行追踪。这种方法能够平滑地绕过转折点，从而计算出完整的解曲线，包括所有的[解分支](@entry_id:755045)和调制[死区](@entry_id:183758)范围。

#### 扩展至[多电平逆变器](@entry_id:1128307)

SHE技术在**[多电平逆变器](@entry_id:1128307)**，特别是级联H桥（Cascaded H-bridge, CHB）拓扑中，展现出独特的优势 。一个由 $M$ 个H桥单元级联而成的逆变器，可以产生一个具有更多电压阶梯的波形。这为SHE提供了更多的自由度。在典型的SHE控制方案中，每个H桥单元提供一个独立的开关角，因此我们拥有 $N=M$ 个可控角度。

这意味着，通过增加级联单元的数量 $M$，我们可以在不增加任何单个功率器件开关频率（每个器件仍然在一个基波周期内开关少数几次）的前提下，消除更多的低[次谐波](@entry_id:171489)（$M-1$个）。这种能力使得[多电平逆变器](@entry_id:1128307)能够在输出极高质量正弦波形的同时，保持非常高的效率（低[开关损耗](@entry_id:1132728)），这在兆瓦级大功率应用中至关重要。

### 严格SHE的替代与补充方案

严格的SHE方法虽然效果显著，但其固有的调制死区和对参数变化的敏感性限制了其应用。因此，发展出了一些更灵活或完全不同的[谐波](@entry_id:181533)控制策略。

#### 加权[谐波](@entry_id:181533)整形 (WHS)

加权[谐波](@entry_id:181533)整形（Weighted Harmonic Shaping, WHS）是一种基于优化的方法，它不追求将谐波严格置零，而是最小化一个加权的谐波分量平方和的代价函数 $J$ ：

$$
\text{minimize } J(\boldsymbol{\theta}) = \sum_{n \in \mathcal{H}} w_n V_n(\boldsymbol{\theta})^2
$$
约束条件为基波幅值 $V_1(\boldsymbol{\theta}) = V_1^\star$。其中 $w_n > 0$ 是设计者选择的权重。

WHS相比于SHE有几个关键优势：
1.  **避免[死区](@entry_id:183758)**：由于这是一个优化问题而非[求根问题](@entry_id:174994)，只要基波约束可以满足，总能找到一个使代价[函数最小化](@entry_id:138381)的解。这从根本上消除了调制死区问题，使得在整个调制范围内都能获得一组可行的开关角度。
2.  **灵活性**：通过调整权重 $w_n$，控制系统可以在不同谐波的抑制程度之间进行权衡。例如，如果某个谐波 $k$ 的权重 $w_k \to \infty$，WHS问题的解将收敛于严格消除该谐波的SHE解。
3.  **物理目标对齐**：权重可以根据具体的物理目标来设定。例如，若目标是最小化流过串联电感 $L$ 的负载电流纹波，由于谐波电流 $I_n \approx V_n / (n \omega L)$，总电流纹波的平方与 $\sum V_n^2/n^2$ 成正比。因此，选择权重 $w_n \propto 1/n^2$ 可以使WHS直接优化电流质量，而不是电压质量。

#### 随机[脉宽调制](@entry_id:262754) (RPWM)

随机[脉宽调制](@entry_id:262754)（Random PWM, RPWM）采用了一种与SHE截然不同的哲学。它不试图消除谐波，而是通过在开关过程中引入随机性来**重塑**[谐波](@entry_id:181533)[频谱](@entry_id:276824) 。

**1. 核心机制：**
RPWM通过对开关周期、脉冲位置或相位等参数施加小的、随机的[抖动](@entry_id:200248)（jitter），来打破标准PWM波形的严格周期性。这样做的结果是，原本集中在开关频率及其[倍频](@entry_id:265429)处的离散、高耸的谐波能量尖峰，被“涂抹”开来，重新分布到一个更宽的连续频带上，形成一个类似于宽带噪声的[频谱](@entry_id:276824)。

**2. 在电磁干扰（EMI）控制中的应用：**
RPWM是应对电磁干扰（EMI）法规的强大工具。EMI法规通常对特定频率的离散发射和[谐波](@entry_id:181533)发射有严格的限制（[离散谱](@entry_id:150970)限值），对宽带噪声的限值则较为宽松。RPWM可以将超出[离散谱](@entry_id:150970)限值的[谐波](@entry_id:181533)尖峰功率分散，使其峰值[功率谱密度](@entry_id:141002)（PSD）降低到宽带噪声限值以下。

这其中存在一个重要的权衡：降低[离散谱](@entry_id:150970)峰值的同时，必然会抬高周围频带的噪声基底。因此，一个关键的优化问题是确定最佳的[随机抖动](@entry_id:1130551)量 ($\Delta T$)，使得衰减后的[离散谱](@entry_id:150970)峰值和抬高后的宽带噪声基底相对于各自的法规限值具有相同的裕量。这种**最坏情况归一化发射**的最小化，实现了最佳的EMI合规性 。

**3. [随机化](@entry_id:198186)SHE (RSHE):**
RPWM的思想也可以与SHE结合。如果在SHE控制中存在多组可行的开关角度解，我们可以在每个基波周期随机地从这些[解集](@entry_id:154326)中选择一组来使用。这种被称为随机化SHE（RSHE）的策略，其效果是：被SHE方程指定消除的谐波在每个周期内都为零，因此在长时平均[频谱](@entry_id:276824)中也保持为零；而未被消除的谐波（如更高次的[谐波](@entry_id:181533)）的能量则因为不同[解集](@entry_id:154326)之间的切换而被有效打散，从而实现了对目标[谐波](@entry_id:181533)的精确消除和对非目标[谐波](@entry_id:181533)的[频谱](@entry_id:276824)展宽 。

### RPWM分析的理论基础

对RPWM产生的随机信号进行[频谱分析](@entry_id:275514)，需要借助[随机过程](@entry_id:268487)理论的基本概念 。

**宽义平稳性 (WSS) 与遍历性 (Ergodicity):**
为了使理论分析与实际测量相符，我们通常假设RPWM产生的电压或电流信号是一个**宽义平稳** (Wide-Sense Stationary, WSS) 过程。这意味着其均值不随时间变化，且其自相关函数仅依赖于时间差，不依赖于时间的起点。此外，我们还需要**遍历性** (Ergodicity)，特别是[自相关函数](@entry_id:138327)的遍历性。遍历性保证了对单个、足够长的信号实现进行时间平均所得到的结果，等同于对整个[随机过程](@entry_id:268487)进行系综平均（即对所有可能的实现求平均）的结果。

这两个条件是至关重要的，因为在实践中我们只能测量单个逆变器的一次运行输出（一个实现），而我们希望这次测量能代表该RPWM策略的普适特性（系综平均）。

**实际[频谱](@entry_id:276824)测量：**
当使用[频谱分析仪](@entry_id:184248)测量RPWM信号时，必须注意：
- 即使过程是平稳和遍历的，单次测量的原始[频谱图](@entry_id:271925)（[周期图](@entry_id:194101)）的方差并不会随测量时间 $T_m$ 的增加而减小，它始终是一个充满噪声、不一致的估计。
- 为了获得一个收敛到真实[功率谱密度](@entry_id:141002)的、低方差的平滑[频谱](@entry_id:276824)，必须进行平均。[频谱分析仪](@entry_id:184248)通过其**分辨率带宽** $\Delta f$ 和**测量时间** $T_m$ 来实现这种平均。估计[频谱](@entry_id:276824)的相对标准差与 $1/\sqrt{T_m \Delta f}$ 成正比。
- 因此，为了获得可靠的测量结果，测量时间 $T_m$ 必须足够长，不仅要远大于信号的**相关时间** $\tau_c$（以保证采样的独立性），还要满足[时间-带宽积](@entry_id:195055) $T_m \Delta f \gg 1$（以保证充分的平均来降低估计方差）。

这些理论考虑为RPWM的设计和验证提供了严谨的科学依据，确保了从仿真到实际硬件测量的结果一致性。