{
    "hands_on_practices": [
        {
            "introduction": "选择性谐波消除（SHE）策略的核心在于精确控制开关事件，以构建具有特定频谱特性的输出电压波形。要掌握SHE，首先必须深刻理解开关角与谐波分量之间的数学关系。本练习  将引导你从第一性原理出发，为级联H桥多电平逆变器的输出电压推导傅里叶级数系数，这是设计和分析任何SHE方案的基石。",
            "id": "3876981",
            "problem": "考虑一个由 $s$ 个串联的H桥单元组成的单相级联H桥逆变器。第 $i$ 个H桥具有一个大小为 $V_{i} > 0$ 的独立直流电源。假设开关器件是理想的，且寄生参数可忽略不计。输出电压波形 $v(\\theta)$（其中 $\\theta$ 为电角度）被设计为具有半波对称性，即 $v(\\theta + \\pi) = -v(\\theta)$，以及四分之一波对称性，即对于 $\\theta \\in [0, \\pi]$ 有 $v(\\pi - \\theta) = v(\\theta)$。其在第一象限的阶梯结构按如下方式构建。\n\n在第一象限 $\\theta \\in [0, \\frac{\\pi}{2}]$ 内，每个单元在唯一的开关角 $\\alpha_{i} \\in (0, \\frac{\\pi}{2})$ 处从 $0$ 切换到 $+V_{i}$，且这些开关角严格排序：$0  \\alpha_{1}  \\alpha_{2}  \\cdots  \\alpha_{s}  \\frac{\\pi}{2}$。因此，该波形在子区间上是分段恒定的，在 $[0, \\alpha_{1})$ 上取值为 $0$，在 $[\\alpha_{1}, \\alpha_{2})$ 上取值为 $V_{1}$，在 $[\\alpha_{2}, \\alpha_{3})$ 上取值为 $V_{1}+V_{2}$，依此类推，直到在 $[\\alpha_{s}, \\frac{\\pi}{2}]$ 上取值为 $\\sum_{i=1}^{s} V_{i}$。周期的其余部分通过所述的半波和四分之一波对称性条件补全，从而得到一个仅包含正弦谐波的奇函数。\n\n从一个实值的、$2\\pi$周期信号的傅里叶级数基本定义出发，并利用所述的对称性，推导 $v(\\theta)$ 的傅里叶系数 $a_{n}$ 和 $b_{n}$ 的表达式，该表达式应以电平电压 $\\{V_{i}\\}_{i=1}^{s}$ 和开关角 $\\{\\alpha_{i}\\}_{i=1}^{s}$ 表示。然后，将基波分量（$\\sin(\\theta)$ 的系数）的幅值 $V_{1}$ 表示为以 $\\{V_{i}\\}$ 和 $\\{\\alpha_{i}\\}$ 表示的闭式解析表达式。\n\n所有角度 $\\alpha_{i}$ 必须以弧度为单位。请用符号表示您的最终公式，不要进行任何数值计算。",
            "solution": "该问题要求推导一个特定多电平电压波形的傅里叶级数系数，并随后推导基波分量的幅值。\n\n首先，我们来讨论一下符号表示。问题使用符号 $V_{i}$ 来表示第 $i$ 个H桥单元的直流电压。然后它要求基波分量的幅值，并也将其命名为 $V_{1}$。这在基波谐波的幅值与第一个单元的直流电压 ($V_{1}$) 之间造成了潜在的歧义。根据“将幅值 $V_{1}$ ... 用 $\\{V_{i}\\}$ 表示”这一措辞，很明显要推导的量是基波幅值，而单元电压集合 $\\{V_{i}\\}_{i=1}^{s}$ 是给定参数。我们将在此解释下进行推导，得出问题中指定为 $V_{1}$ 的基波幅值的表达式。\n\n一个 $2\\pi$ 周期函数 $v(\\theta)$ 的傅里叶级数表示为：\n$$v(\\theta) = a_{0} + \\sum_{n=1}^{\\infty} \\left( a_{n} \\cos(n\\theta) + b_{n} \\sin(n\\theta) \\right)$$\n其中系数由欧拉公式定义：\n$$a_{0} = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} v(\\theta) \\, d\\theta$$\n$$a_{n} = \\frac{1}{\\pi} \\int_{0}^{2\\pi} v(\\theta) \\cos(n\\theta) \\, d\\theta \\quad \\text{for } n \\ge 1$$\n$$b_{n} = \\frac{1}{\\pi} \\int_{0}^{2\\pi} v(\\theta) \\sin(n\\theta) \\, d\\theta \\quad \\text{for } n \\ge 1$$\n\n问题指出，波形 $v(\\theta)$ 具有特定的对称性，可以用来简化这些系数的计算。\n1.  **半波对称性**：$v(\\theta + \\pi) = -v(\\theta)$。此性质意味着波形不含偶次谐波。因此，对于所有偶数 $n$，$a_{n} = 0$ 且 $b_{n} = 0$。此外，直流分量 $a_{0}$ 也为零。对于奇数 $n$，积分得以简化。\n2.  **四分之一波对称性**：问题将其定义为对于 $\\theta \\in [0, \\pi]$ 有 $v(\\pi - \\theta) = v(\\theta)$，这意味着波形在前半周期内关于 $\\theta = \\frac{\\pi}{2}$ 对称。此性质与半波对称性相结合，意味着该波形为奇函数，即 $v(-\\theta) = -v(\\theta)$。对于奇函数，乘积 $v(\\theta)\\cos(n\\theta)$ 是奇函数，其在 $[-\\pi, \\pi]$ 这样的对称区间上的积分为零。因此，所有余弦系数均为零：\n$$a_{n} = 0 \\quad \\text{for all } n \\ge 0$$\n对于正弦系数 $b_{n}$，被积函数 $v(\\theta)\\sin(n\\theta)$ 是一个偶函数，这简化了其积分。半波和四分之一波对称性的结合使得整个周期的积分可以表示为第一象限（即第一个四分之一周期）积分的四倍：\n$$b_{n} = \\frac{4}{\\pi} \\int_{0}^{\\pi/2} v(\\theta) \\sin(n\\theta) \\, d\\theta$$\n此表达式仅对奇数 $n$ 有效，因为对于偶数 $n$，$b_n = 0$。\n\n接下来，我们必须利用 $v(\\theta)$ 在第一象限 $\\theta \\in [0, \\frac{\\pi}{2}]$ 内的指定结构来计算该积分。电压波形是一个阶梯函数，可以表示为在每个开关角 $\\alpha_{i}$ 处的上升跃变之和。一个方便的表示方法是使用亥维赛阶跃函数 $H(\\theta)$，其中当 $\\theta \\ge 0$ 时 $H(\\theta) = 1$，当 $\\theta  0$ 时 $H(\\theta) = 0$。电压电平在角度 $\\alpha_{i}$ 处增加 $V_{i}$。因此，对于 $\\theta \\in [0, \\frac{\\pi}{2}]$，波形可以写为：\n$$v(\\theta) = \\sum_{i=1}^{s} V_{i} H(\\theta - \\alpha_{i})$$\n将此代入 $b_{n}$ 的表达式中：\n$$b_{n} = \\frac{4}{\\pi} \\int_{0}^{\\pi/2} \\left( \\sum_{i=1}^{s} V_{i} H(\\theta - \\alpha_{i}) \\right) \\sin(n\\theta) \\, d\\theta$$\n由于和是有限的，我们可以交换求和与积分的顺序：\n$$b_{n} = \\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\int_{0}^{\\pi/2} H(\\theta - \\alpha_{i}) \\sin(n\\theta) \\, d\\theta$$\n亥维赛函数 $H(\\theta - \\alpha_{i})$ 在 $\\theta  \\alpha_{i}$ 时为零，在 $\\theta \\ge \\alpha_{i}$ 时为一。这将每个积分的下限从 $0$ 更改为 $\\alpha_{i}$：\n$$b_{n} = \\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\int_{\\alpha_{i}}^{\\pi/2} \\sin(n\\theta) \\, d\\theta$$\n现在我们进行积分：\n$$\\int_{\\alpha_{i}}^{\\pi/2} \\sin(n\\theta) \\, d\\theta = \\left[ -\\frac{1}{n} \\cos(n\\theta) \\right]_{\\alpha_{i}}^{\\pi/2} = -\\frac{1}{n} \\cos\\left(\\frac{n\\pi}{2}\\right) + \\frac{1}{n} \\cos(n\\alpha_{i})$$\n如前所述，这个 $b_n$ 的表达式仅在 $n$ 为奇数时非零。对于任何奇数 $n$，$\\cos(\\frac{n\\pi}{2}) = 0$。因此，积分简化为：\n$$\\int_{\\alpha_{i}}^{\\pi/2} \\sin(n\\theta) \\, d\\theta = \\frac{1}{n} \\cos(n\\alpha_{i})$$\n将此结果代回 $b_{n}$ 的表达式中：\n$$b_{n} = \\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\left( \\frac{1}{n} \\cos(n\\alpha_{i}) \\right)$$\n这可以重写为：\n$$b_{n} = \\frac{4}{n\\pi} \\sum_{i=1}^{s} V_{i} \\cos(n\\alpha_{i})$$\n\n总结傅里叶系数如下：\n- 对于所有 $n \\ge 0$，$a_{n} = 0$。\n- 对于所有偶数 $n$，$b_{n} = 0$。\n- 对于所有奇数 $n$，$b_{n} = \\frac{4}{n\\pi} \\sum_{i=1}^{s} V_{i} \\cos(n\\alpha_{i})$。\n\n最后一步是求基波分量的幅值。基波分量是傅里叶级数中对应于 $n=1$ 的项。其幅值由系数 $b_{1}$ 给出。根据问题的符号表示，此幅值记为 $V_{1}$。在我们推导的 $b_{n}$ 表达式中令 $n=1$：\n$$V_{1} \\equiv b_{1} = \\frac{4}{1 \\cdot \\pi} \\sum_{i=1}^{s} V_{i} \\cos(1 \\cdot \\alpha_{i})$$\n$$V_{1} = \\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\cos(\\alpha_{i})$$\n这就是用直流电压电平 $\\{V_i\\}$ 和开关角 $\\{\\alpha_i\\}$ 表示的基波谐波幅值的闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{4}{\\pi} \\sum_{i=1}^{s} V_{i} \\cos(\\alpha_{i})}$$"
        },
        {
            "introduction": "理论模型是理想的，但实际的电力电子系统面临着各种非理想效应。在逆变器中，为防止桥臂直通必须设置死区时间，但这会引入时序误差，扭曲输出电压，从而破坏精心设计的SHE效果。本练习  探讨了如何对这一关键的非理想效应进行建模，并推导出一阶校正策略，这是实现高性能逆变器控制的关键一步。",
            "id": "3877052",
            "problem": "一台单相全桥逆变器使用选择性谐波消除 (SHE) 技术生成具有四分之一波对称性的两电平输出电压。该逆变器以基波角频率 $\\omega$ 进行控制，并在第一象限内采用 $N$ 个开关角 $\\alpha_{1}, \\alpha_{2}, \\ldots, \\alpha_{N}$（满足 $0  \\alpha_{1}  \\cdots  \\alpha_{N}  \\pi/2$），以消除一组指定的非三倍奇次谐波，同时实现期望的基波分量。为防止互补桥臂器件发生直通，在每次换向期间，每个桥臂都会插入一个时长为 $\\tau_{d}$（单位：秒）的不重叠开关死区时间。假设两电平跃迁是理想的，且器件压降可忽略不计。\n\n在实际应用中，死区时间会使实际输出电压的开关边沿相对于指令边沿时刻发生延迟，从而对有效开关角产生扰动。将死区时间视为小量，即满足 $\\omega \\tau_{d} \\ll 1$。从具有四分之一波对称性的分段常数两电平波形的谐波系数的傅里叶级数定义出发，推导由死区时间引起的谐波消除条件的一阶微扰，并证明有效角发生了量值为 $\\delta \\alpha_{k}$ 的偏移，且该偏移量近似正比于 $\\omega \\tau_{d}$。然后，求出指令开关角的一阶校正量（以弧度表示），该校正量能够在 $\\tau_{d}$ 的一阶近似下维持选择性谐波消除条件。\n\n将您的最终答案表示为关于 $\\alpha_{k}$、$\\omega$ 和 $\\tau_{d}$ 的单个闭式解析表达式，用于表示补偿死区时间的校正后指令角 $\\alpha_{k}^{\\mathrm{cmd}}$。所有角度均使用弧度。无需进行数值代入，也无需四舍五入。",
            "solution": "该问题要求为选择性谐波消除 (SHE) 控制的逆变器推导死区时间补偿角。死区时间是实际系统中为防止桥臂直通而引入的必要延迟，但它会扭曲输出电压波形，破坏预期的谐波消除效果。我们的目标是找到一个对指令开关角的一阶校正量，以抵消死区时间的影响。\n\n首先，我们回顾具有四分之一波对称性的两电平逆变器输出电压的谐波分析。其第 $n$ 次奇次谐波（$n=1, 3, 5, \\dots$）的幅值 $b_n$ 由以下公式给出，该公式是关于在第一象限内的 $N$ 个开关角 $\\{\\alpha_k\\}_{k=1}^N$ 的函数：\n$$\nb_n = \\frac{4V_{\\mathrm{dc}}}{n\\pi} \\left( 1 + 2\\sum_{k=1}^N (-1)^k \\cos(n\\alpha_k) \\right)\n$$\nSHE 的目标是选择一组理想的开关角 $\\{\\alpha_k^*\\}$，使得对于一组指定的谐波次数 $n \\in \\mathcal{H}$，其幅值 $b_n$ 为零。这等价于求解以下非线性方程组：\n$$\n1 + 2\\sum_{k=1}^N (-1)^k \\cos(n\\alpha_k^*) = 0, \\quad \\text{for } n \\in \\mathcal{H}\n$$\n\n接下来，我们对死区时间的影响进行建模。问题陈述指出，死区时间 $\\tau_d$ 会“使实际输出电压的开关边沿相对于指令边沿时刻发生延迟”。这可以被建模为一个对开关角的固定偏移。如果数字控制器发出的指令开关角为 $\\alpha_k^{\\mathrm{cmd}}$，那么由于死区延迟，实际在逆变器输出端产生的有效开关角 $\\alpha_k^{\\mathrm{act}}$ 为：\n$$\n\\alpha_k^{\\mathrm{act}} = \\alpha_k^{\\mathrm{cmd}} + \\omega \\tau_d\n$$\n其中 $\\omega \\tau_d$ 是以弧度表示的延迟时间。这个简化的模型假设了电流方向在换向期间不会改变，这在许多情况下是合理的近似。\n\n为了恢复理想的谐波消除效果，我们必须确保实际施加在波形上的有效开关角 $\\alpha_k^{\\mathrm{act}}$ 等于我们求解得到的理想SHE角 $\\alpha_k^*$。因此，我们设定目标：\n$$\n\\alpha_k^{\\mathrm{act}} = \\alpha_k^*\n$$\n将死区效应模型代入此目标，我们得到：\n$$\n\\alpha_k^{\\mathrm{cmd}} + \\omega \\tau_d = \\alpha_k^*\n$$\n现在，我们可以求解需要发送给控制器的补偿后的指令角 $\\alpha_k^{\\mathrm{cmd}}$：\n$$\n\\alpha_k^{\\mathrm{cmd}} = \\alpha_k^* - \\omega \\tau_d\n$$\n这个结果直观地表明，为了补偿大小为 $\\omega\\tau_d$ 的延迟，我们必须将开关指令提前相同的角度量。\n\n问题中用 $\\alpha_k$ 表示理想开关角，因此最终的校正后指令角表达式为 $\\alpha_k - \\omega\\tau_d$。这是一个一阶校正，因为它与小量 $\\tau_d$ 成线性关系，并且是在 $\\omega \\tau_d \\ll 1$ 的假设下有效的。",
            "answer": "$$\\boxed{\\alpha_k - \\omega \\tau_d}$$"
        },
        {
            "introduction": "随着数字控制器的普及，另一个不可忽视的非理想因素源于其有限的时序分辨率。理想的开关时刻在数字实现中被量化，引入了量化误差，这会影响谐波消除的精度。本练习  将这种量化误差视为一个随机过程——这是随机PWM（RPWM）中的一个核心思想，并要求你量化其对关键谐波分量的平均影响，从而让你洞察数字实现所引入的噪声基底。",
            "id": "3876969",
            "problem": "一台单相两电平全桥逆变器通过在 $+V_{\\mathrm{dc}}$ 和 $-V_{\\mathrm{dc}}$ 电平之间切换，产生一个四分之一波和半波对称的输出电压波形。在电角度 $\\theta \\in [0,\\pi/2]$ 的第一象限内，有 $N$ 个单调递增的开关角 $0  \\alpha_{1}  \\alpha_{2}  \\cdots  \\alpha_{N}  \\pi/2$，通过四分之一波对称性生成 $[0,2\\pi)$ 范围内的剩余波形。基波电周期为 $T$，基波角频率为 $\\omega_{0}=2\\pi/T$。在每个四分之一波内，理想的开关时刻发生在预定时间 $t_{k}^{\\star}=\\alpha_{k}/\\omega_{0}$，其中 $k=1,\\dots,N$。\n\n该逆变器采用一个分辨率有限（$\\Delta t0$）的数字计时器实现。每个预定的开关时间被量化到最近的计时器滴答时刻，即 $t_{k}=\\mathrm{round}(t_{k}^{\\star}/\\Delta t)\\,\\Delta t$。定义由此产生的量化时间误差为 $\\varepsilon_{k}=t_{k}-t_{k}^{\\star}$，相应的角度误差为 $\\delta\\alpha_{k}=\\omega_{0}\\varepsilon_{k}$。假设采用一种与随机脉宽调制（random PWM）一致的抖动方案，使得量化误差 $\\{\\varepsilon_{k}\\}_{k=1}^{N}$ 是在 $[-\\Delta t/2,\\Delta t/2]$ 上独立同分布的均匀分布。\n\n设 $\\mathcal{H}=\\{h_{1},\\dots,h_{K}\\}$ 为一个有限集合，包含了在理想（未量化）情况下通过选择性谐波消除（SHE）技术所消除的目标奇次谐波的次数。设 $\\mathcal{S}=\\{1\\}\\cup\\mathcal{H}$ 表示包含基波（$m=1$）和目标谐波的集合。对于奇次 $m$，线-中性点电压谐波幅值 $V_{m}$ 由一个周期内分段常数波形的标准傅里叶级数积分表达式定义。\n\n仅从傅里叶级数定义出发，对小角度误差 $\\{\\delta\\alpha_{k}\\}$ 推导至一阶，得到由时间量化引起的对每个 $m\\in\\mathcal{S}$ 的幅值误差 $\\Delta V_{m}$ 的线性化表达式。然后，使用所述的量化误差概率模型，计算这些幅值误差在集合 $\\mathcal{S}$ 上的平方和的期望值，\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right],\n$$\n并将其表示为关于 $V_{\\mathrm{dc}}$、$\\Delta t$、$T$、$N$、角度集 $\\{\\alpha_{k}\\}_{k=1}^{N}$ 和谐波集 $\\mathcal{S}$ 的闭式表达式。\n\n将您的最终结果表述为单个解析表达式。所有角度均使用弧度。不要进行数值简化。将最终的类能量值以平方伏特为单位表示，但不要在最终答案框中写出单位。",
            "solution": "该问题要求推导在使用选择性谐波消除（SHE）的单相逆变器中，由时间量化引起的谐波电压幅值误差的平方和的期望值。推导过程将分三个阶段进行：首先，建立开关角与谐波幅值之间的关系；其次，将此关系线性化，以求出由开关角微小误差引起的一阶谐波幅值误差；第三，使用给定的时间误差统计模型，计算幅值误差平方和的期望值。\n\n逆变器产生一个四分之一波对称的输出电压波形 $v(t)$。设 $\\theta = \\omega_0 t$ 为电角度，其中 $\\omega_0 = 2\\pi/T$ 是基波角频率。由于四分之一波对称性，整个周期内的波形由其在第一象限 $\\theta \\in [0, \\pi/2]$ 内的形状决定。在该象限内，有 $N$ 个开关角 $0  \\alpha_1  \\alpha_2  \\dots  \\alpha_N  \\pi/2$。电压 $v(\\theta)$ 在 $+V_{\\mathrm{dc}}$ 和 $-V_{\\mathrm{dc}}$ 之间切换。为方便表示，我们可以定义 $\\alpha_0 = 0$ 和 $\\alpha_{N+1} = \\pi/2$。对于 $\\theta \\in [0, \\pi/2]$，电压由下式给出：\n$$\nv(\\theta) = \\sum_{k=0}^{N} (-1)^k V_{\\mathrm{dc}} \\quad \\text{for } \\alpha_k \\le \\theta  \\alpha_{k+1}\n$$\n\n对于具有四分之一波对称性的波形，其傅里叶级数仅包含奇次谐波的正弦项。第 $m$ 次奇次谐波的幅值 $V_m$ 由下式给出：\n$$\nV_m = \\frac{4}{\\pi} \\int_0^{\\pi/2} v(\\theta) \\sin(m\\theta) \\,d\\theta\n$$\n进行积分并化简后，可得 $V_m$ 与开关角 $\\{\\alpha_k\\}$ 的关系式：\n$$\nV_m(\\alpha_1, \\dots, \\alpha_N) = \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left( 1 + 2\\sum_{k=1}^N (-1)^k \\cos(m\\alpha_k) \\right)\n$$\n该方程将谐波幅值定义为开关角的函数。\n\n接下来，我们求解由开关角 $\\alpha_k$ 的微小扰动 $\\delta\\alpha_k$ 引起的 $V_m$ 的一阶变化。总误差 $\\Delta V_m$ 可由一阶泰勒展开近似：\n$$\n\\Delta V_m \\approx \\sum_{k=1}^N \\frac{\\partial V_m}{\\partial \\alpha_k} \\delta\\alpha_k\n$$\n我们计算偏导数：\n$$\n\\frac{\\partial V_m}{\\partial \\alpha_k} = \\frac{\\partial}{\\partial \\alpha_k} \\left[ \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left( 1 + 2\\sum_{j=1}^N (-1)^j \\cos(m\\alpha_j) \\right) \\right]\n$$\n导数仅作用于和式中 $j=k$ 的项：\n$$\n\\frac{\\partial V_m}{\\partial \\alpha_k} = \\frac{4V_{\\mathrm{dc}}}{m\\pi} \\left( 2(-1)^k [-m\\sin(m\\alpha_k)] \\right) = \\frac{8V_{\\mathrm{dc}}}{\\pi} (-1)^{k+1} \\sin(m\\alpha_k)\n$$\n因此，幅值误差的线性化表达式为：\n$$\n\\Delta V_m = \\frac{8V_{\\mathrm{dc}}}{\\pi} \\sum_{k=1}^N (-1)^{k+1} \\sin(m\\alpha_k) \\delta\\alpha_k\n$$\n角度误差 $\\delta\\alpha_k$ 与时间量化误差 $\\varepsilon_k$ 的关系为 $\\delta\\alpha_k = \\omega_0 \\varepsilon_k$。\n\n现在，我们计算这些幅值误差的平方和的期望值 $\\mathbb{E}\\left[\\sum_{m\\in\\mathcal{S}}(\\Delta V_m)^2\\right]$。首先计算 $(\\Delta V_m)^2$ 的期望值。\n$$\n(\\Delta V_m)^2 = \\left( \\frac{8V_{\\mathrm{dc}}}{\\pi} \\sum_{k=1}^N (-1)^{k+1} \\sin(m\\alpha_k) \\delta\\alpha_k \\right)^2\n$$\n$$\n(\\Delta V_m)^2 = \\left(\\frac{64V_{\\mathrm{dc}}^2}{\\pi^2}\\right) \\sum_{k=1}^N \\sum_{j=1}^N (-1)^{k+j} \\sin(m\\alpha_k) \\sin(m\\alpha_j) \\delta\\alpha_k \\delta\\alpha_j\n$$\n取期望，并利用期望的线性性质：\n$$\n\\mathbb{E}[(\\Delta V_m)^2] = \\left(\\frac{64V_{\\mathrm{dc}}^2}{\\pi^2}\\right) \\sum_{k=1}^N \\sum_{j=1}^N (-1)^{k+j} \\sin(m\\alpha_k) \\sin(m\\alpha_j) \\mathbb{E}[\\delta\\alpha_k \\delta\\alpha_j]\n$$\n时间误差 $\\varepsilon_k$ 是服从均匀分布 $U[-\\Delta t/2, \\Delta t/2]$ 的独立同分布（i.i.d.）随机变量。因此，角度误差 $\\delta\\alpha_k = \\omega_0 \\varepsilon_k$ 也是独立同分布的随机变量，服从 $[-\\omega_0\\Delta t/2, \\omega_0\\Delta t/2]$ 上的均匀分布。\n该分布的均值为 $\\mathbb{E}[\\delta\\alpha_k] = 0$。方差为 $\\mathrm{Var}(\\delta\\alpha_k) = \\mathbb{E}[(\\delta\\alpha_k)^2] - (\\mathbb{E}[\\delta\\alpha_k])^2 = \\mathbb{E}[(\\delta\\alpha_k)^2]$。对于均匀分布 $U[-a, a]$，方差为 $a^2/3$。此处，$a = \\omega_0\\Delta t/2$，所以：\n$$\n\\mathbb{E}[(\\delta\\alpha_k)^2] = \\frac{(\\omega_0\\Delta t/2)^2}{3} = \\frac{\\omega_0^2 (\\Delta t)^2}{12}\n$$\n由于误差是独立的，当 $k \\ne j$ 时，$\\mathbb{E}[\\delta\\alpha_k \\delta\\alpha_j] = \\mathbb{E}[\\delta\\alpha_k]\\mathbb{E}[\\delta\\alpha_j]=0$。因此：\n$$\n\\mathbb{E}[\\delta\\alpha_k \\delta\\alpha_j] = \\delta_{kj} \\frac{\\omega_0^2 (\\Delta t)^2}{12}\n$$\n其中 $\\delta_{kj}$ 是克罗内克 delta 符号。将此代入 $\\mathbb{E}[(\\Delta V_m)^2]$ 的表达式中，双重求和将简化为单重求和（当 $j=k$ 时）：\n$$\n\\mathbb{E}[(\\Delta V_m)^2] = \\left(\\frac{64V_{\\mathrm{dc}}^2}{\\pi^2}\\right) \\sum_{k=1}^N (-1)^{2k} \\sin^2(m\\alpha_k) \\left(\\frac{\\omega_0^2 (\\Delta t)^2}{12}\\right)\n$$\n由于 $(-1)^{2k}=1$，上式可简化为：\n$$\n\\mathbb{E}[(\\Delta V_m)^2] = \\frac{64V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{12\\pi^2} \\sum_{k=1}^N \\sin^2(m\\alpha_k) = \\frac{16V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{3\\pi^2} \\sum_{k=1}^N \\sin^2(m\\alpha_k)\n$$\n最后，我们通过对集合 $\\mathcal{S}=\\{1\\}\\cup\\mathcal{H}$ 中的所有谐波 $m$ 进行求和来计算所求量。\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\sum_{m\\in\\mathcal{S}} \\mathbb{E}[(\\Delta V_m)^2] = \\sum_{m\\in\\mathcal{S}} \\left( \\frac{16V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{3\\pi^2} \\sum_{k=1}^N \\sin^2(m\\alpha_k) \\right)\n$$\n常数因子可以从对 $m$ 的求和中提出：\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\frac{16V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{3\\pi^2} \\sum_{m\\in\\mathcal{S}} \\sum_{k=1}^N \\sin^2(m\\alpha_k)\n$$\n我们可以交换有限求和的顺序：\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\frac{16V_{\\mathrm{dc}}^2 \\omega_0^2 (\\Delta t)^2}{3\\pi^2} \\sum_{k=1}^N \\sum_{m\\in\\mathcal{S}} \\sin^2(m\\alpha_k)\n$$\n问题要求结果用 $T$ 而不是 $\\omega_0$ 表示。代入 $\\omega_0 = 2\\pi/T$：\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\frac{16V_{\\mathrm{dc}}^2 (4\\pi^2/T^2) (\\Delta t)^2}{3\\pi^2} \\sum_{k=1}^N \\sum_{m\\in\\mathcal{S}} \\sin^2(m\\alpha_k)\n$$\n$$\n\\mathbb{E}\\!\\left[\\sum_{m\\in\\mathcal{S}}\\left(\\Delta V_{m}\\right)^{2}\\right] = \\frac{64V_{\\mathrm{dc}}^2 (\\Delta t)^2}{3T^2} \\sum_{k=1}^N \\sum_{m\\in\\mathcal{S}} \\sin^2(m\\alpha_k)\n$$\n这就是最终的闭式表达式。它依赖于指定的参数 $V_{\\mathrm{dc}}$、$\\Delta t$、$T$、$N$、$\\{\\alpha_k\\}_{k=1}^N$ 和 $\\mathcal{S}$。",
            "answer": "$$\n\\boxed{\\frac{64 V_{\\mathrm{dc}}^2 (\\Delta t)^2}{3 T^2} \\sum_{k=1}^{N} \\sum_{m \\in \\mathcal{S}} \\sin^2(m\\alpha_k)}\n$$"
        }
    ]
}