{
    "hands_on_practices": [
        {
            "introduction": "高效的热管理是确保大功率器件可靠性的首要条件，而芯片贴装材料的选择直接影响着结温。本练习对传统的焊料连接和先进的银烧结连接进行了实用的比较。通过计算考虑了材料孔隙率的热阻，您将定量地理解现代封装材料及其微观结构质量如何有助于实现卓越的热性能。",
            "id": "3864118",
            "problem": "一个横向尺寸为 $5 \\ \\mathrm{mm} \\times 5 \\ \\mathrm{mm}$ 的碳化硅金属氧化物半导体场效应晶体管 (MOSFET) 芯片通过一个芯片贴装层连接到一个铜直接键合铜 (DBC) 基板上。考虑了两种用于芯片贴装的封装变体：焊料贴装和多孔烧结银贴装。芯片中的功耗为恒定的 $P = 200 \\ \\mathrm{W}$。假设热流是垂直于贴装层的一维流动，横向扩展可忽略不计，并且所有其他层和边界条件在两种变体之间保持不变，因此峰值结温的任何变化都完全由芯片贴装层的变化引起。芯片面积为 $A = 25 \\ \\mathrm{mm}^2$。\n\n对于焊料贴装，键合层厚度为 $t_{s} = 80 \\ \\mu \\mathrm{m}$，固态焊料基体的热导率为 $k_{s,m} = 58 \\ \\mathrm{W \\ m^{-1} \\ K^{-1}}$。对于烧结银贴装，键合层厚度为 $t_{Ag} = 25 \\ \\mu \\mathrm{m}$，致密银基体的热导率为 $k_{Ag,m} = 250 \\ \\mathrm{W \\ m^{-1} \\ K^{-1}}$。两层都含有空洞，这些空洞被建模为连续基体中的球形孔隙，焊料的空洞率为 $\\phi_{s} = 0.03$，银的空洞率为 $\\phi_{Ag} = 0.15$。使用一个经过充分检验的、适用于导电基体中球形非导电夹杂物的等效介质近似模型，将每个贴装层的等效热导率与其基体热导率和空洞率联系起来。\n\n从傅里叶热传导定律和第一性原理出发，在所述假设下，推导从焊料贴装过渡到烧结银贴装时峰值结温降低量 $\\Delta T_{j,\\mathrm{red}}$ 的表达式。然后数值计算 $\\Delta T_{j,\\mathrm{red}}$。在你的推导中，评估在 $\\phi_{Ag} = 0.15$ 时 $\\Delta T_{j,\\mathrm{red}}$ 对银层空洞率的局部灵敏度，并结合辐射诱导的孔隙度增长的背景简要解释其符号和大小；但是，你报告的最终数值答案应仅为 $\\Delta T_{j,\\mathrm{red}}$ 的值。\n\n将 $\\Delta T_{j,\\mathrm{red}}$ 的数值结果四舍五入到四位有效数字，并以开尔文表示。",
            "solution": "首先验证问题，以确保其科学上合理、内容独立且提法得当。\n\n**步骤1：提取的已知条件**\n-   器件类型：碳化硅金属氧化物半导体场效应晶体管 (MOSFET)\n-   芯片尺寸：$5 \\ \\mathrm{mm} \\times 5 \\ \\mathrm{mm}$\n-   芯片面积：$A = 25 \\ \\mathrm{mm}^2$\n-   功耗：$P = 200 \\ \\mathrm{W}$\n-   热流假设：一维 (1D)，垂直于贴装层，横向扩展可忽略不计。\n-   系统假设：峰值结温 $T_j$ 的任何变化完全由芯片贴装层的变化引起。\n-   焊料贴装参数：\n    -   厚度：$t_{s} = 80 \\ \\mu \\mathrm{m}$\n    -   基体热导率：$k_{s,m} = 58 \\ \\mathrm{W \\ m^{-1} \\ K^{-1}}$\n    -   空洞率：$\\phi_{s} = 0.03$\n-   烧结银贴装参数：\n    -   厚度：$t_{Ag} = 25 \\ \\mu \\mathrm{m}$\n    -   基体热导率：$k_{Ag,m} = 250 \\ \\mathrm{W \\ m^{-1} \\ K^{-1}}$\n    -   空洞率：$\\phi_{Ag} = 0.15$\n-   空洞模型：连续基体中的球形孔隙（非导电）。\n-   等效介质模型要求：一个经过充分检验的、适用于球形非导电夹杂物的模型。\n-   目标1：推导峰值结温降低量 $\\Delta T_{j,\\mathrm{red}}$ 的表达式。\n-   目标2：数值计算 $\\Delta T_{j,\\mathrm{red}}$，并四舍五入到四位有效数字。\n-   目标3：评估在 $\\phi_{Ag} = 0.15$ 时 $\\Delta T_{j,\\mathrm{red}}$ 对 $\\phi_{Ag}$ 的局部灵敏度。\n-   目标4：解释该灵敏度。\n-   最终答案：仅为 $\\Delta T_{j,\\mathrm{red}}$ 的数值。\n\n**步骤2：验证**\n-   **科学依据：** 问题基于傅里叶热传导定律和热阻的概念，这些是热物理学和工程学的基本原理。使用等效介质近似来模拟复合材料（带有空洞的金属）的热导率是材料科学中一种标准且科学有效的方法。材料、尺寸和功率水平对于大功率 SiC 器件是符合实际的。\n-   **提法得当性：** 问题提供了计算芯片贴装层热阻以及随后的温差所需的所有必要数据。使用“一个经过充分检验的等效介质近似”的指令引导求解者采用一类标准模型，例如 Maxwell-Eucken 模型，该模型适用于所描述的几何形状（稀疏球形夹杂物）。一维热流和恒定边界条件的假设使问题具有唯一解。\n-   **客观性：** 问题使用精确、定量的语言陈述，没有主观或含糊的术语。\n\n**步骤3：结论**\n问题是有效的。它在科学上是合理的，提法得当，客观，并包含足够的信息以获得唯一解。\n\n**求解推导**\n分析始于一维热传导的傅里叶定律，该定律指出热通量 $q''$（单位面积的功率）与温度梯度成正比：\n$$ q'' = -k \\frac{dT}{dx} $$\n对于在均匀面积 $A$ 上的恒定功耗 $P$，热通量为 $q'' = P/A$。对于厚度为 $t$、热导率为常数 $k$ 的层，对傅里叶定律在该层上积分，得到其上的温降 $\\Delta T$：\n$$ \\Delta T = q'' \\frac{t}{k} = \\frac{P t}{k A} $$\n该关系定义了层的热阻 $R_{th}$ 为 $R_{th} = t / (kA)$，因此 $\\Delta T = P \\cdot R_{th}$。\n\n芯片贴装层是含有非导电空洞的复合材料。必须计算它们的等效热导率 $k_{\\mathrm{eff}}$。问题指定了连续基体中的球形空洞，对此，Maxwell-Eucken 等效介质近似是合适的。对于热导率为 $k_m$ 的基体和热导率为 $k_p$ 的夹杂物体积分数为 $\\phi$ 的情况，该模型为：\n$$ k_{\\mathrm{eff}} = k_m \\frac{k_p + 2k_m - 2\\phi(k_m - k_p)}{k_p + 2k_m + \\phi(k_m - k_p)} $$\n对于非导电空洞，我们取 $k_p \\to 0$ 的极限，表达式简化为：\n$$ k_{\\mathrm{eff}}(\\phi, k_m) = k_m \\frac{2k_m - 2\\phi k_m}{2k_m + \\phi k_m} = k_m \\frac{1-\\phi}{1+\\frac{\\phi}{2}} $$\n我们将此模型应用于焊料层和烧结银层。\n\n焊料贴装的热阻 $R_{th,s}$ 为：\n$$ R_{th,s} = \\frac{t_s}{k_{\\mathrm{eff},s} A} = \\frac{t_s}{A \\left( k_{s,m} \\frac{1-\\phi_s}{1+\\frac{\\phi_s}{2}} \\right)} = \\frac{t_s}{A k_{s,m}} \\frac{1+\\frac{\\phi_s}{2}}{1-\\phi_s} $$\n烧结银贴装的热阻 $R_{th,Ag}$ 为：\n$$ R_{th,Ag} = \\frac{t_{Ag}}{k_{\\mathrm{eff},Ag} A} = \\frac{t_{Ag}}{A \\left( k_{Ag,m} \\frac{1-\\phi_{Ag}}{1+\\frac{\\phi_{Ag}}{2}} \\right)} = \\frac{t_{Ag}}{A k_{Ag,m}} \\frac{1+\\frac{\\phi_{Ag}}{2}}{1-\\phi_{Ag}} $$\n问题陈述所有其他层和边界条件都是固定的。因此，焊料情况下的峰值结温 $T_{j,s}$ 和烧结银情况下的峰值结温 $T_{j,Ag}$ 可以写为 $T_{j,s} = T_{base} + \\Delta T_s$ 和 $T_{j,Ag} = T_{base} + \\Delta T_{Ag}$，其中 $T_{base}$ 是芯片贴装层底部的温度（假设两种情况下相同），而 $\\Delta T_s = P \\cdot R_{th,s}$ 和 $\\Delta T_{Ag} = P \\cdot R_{th,Ag}$ 分别是各自贴装层上的温降。\n\n峰值结温的降低量 $\\Delta T_{j,\\mathrm{red}}$ 是其差值：\n$$ \\Delta T_{j,\\mathrm{red}} = T_{j,s} - T_{j,Ag} = (T_{base} + \\Delta T_s) - (T_{base} + \\Delta T_{Ag}) = \\Delta T_s - \\Delta T_{Ag} $$\n$$ \\Delta T_{j,\\mathrm{red}} = P(R_{th,s} - R_{th,Ag}) $$\n代入热阻的表达式，得到所需的符号表达式：\n$$ \\Delta T_{j,\\mathrm{red}} = \\frac{P}{A} \\left[ \\frac{t_s}{k_{s,m}} \\frac{1+\\frac{\\phi_s}{2}}{1-\\phi_s} - \\frac{t_{Ag}}{k_{Ag,m}} \\frac{1+\\frac{\\phi_{Ag}}{2}}{1-\\phi_{Ag}} \\right] $$\n接下来，我们评估 $\\Delta T_{j,\\mathrm{red}}$ 对银层空洞率 $\\phi_{Ag}$ 的局部灵敏度。这由偏导数 $\\frac{\\partial (\\Delta T_{j,\\mathrm{red}})}{\\partial \\phi_{Ag}}$ 给出。$\\Delta T_{j,\\mathrm{red}}$ 表达式中的第一项相对于 $\\phi_{Ag}$ 是常数。\n$$ \\frac{\\partial (\\Delta T_{j,\\mathrm{red}})}{\\partial \\phi_{Ag}} = -\\frac{P t_{Ag}}{A k_{Ag,m}} \\frac{\\partial}{\\partial \\phi_{Ag}} \\left( \\frac{1+\\frac{\\phi_{Ag}}{2}}{1-\\phi_{Ag}} \\right) $$\n使用商法则，其中 $u = 1+\\phi_{Ag}/2$ 且 $v = 1-\\phi_{Ag}$，我们有 $u' = 1/2$ 和 $v' = -1$：\n$$ \\frac{\\partial}{\\partial \\phi_{Ag}} \\left( \\frac{u}{v} \\right) = \\frac{u'v - uv'}{v^2} = \\frac{(\\frac{1}{2})(1-\\phi_{Ag}) - (1+\\frac{\\phi_{Ag}}{2})(-1)}{(1-\\phi_{Ag})^2} = \\frac{\\frac{1}{2} - \\frac{1}{2}\\phi_{Ag} + 1 + \\frac{1}{2}\\phi_{Ag}}{(1-\\phi_{Ag})^2} = \\frac{\\frac{3}{2}}{(1-\\phi_{Ag})^2} $$\n因此，灵敏度为：\n$$ S_{\\phi_{Ag}} = \\frac{\\partial (\\Delta T_{j,\\mathrm{red}})}{\\partial \\phi_{Ag}} = -\\frac{P t_{Ag}}{A k_{Ag,m}} \\frac{\\frac{3}{2}}{(1-\\phi_{Ag})^2} = -\\frac{3 P t_{Ag}}{2 A k_{Ag,m} (1-\\phi_{Ag})^2} $$\n现在，我们使用国际单位制在 $\\phi_{Ag} = 0.15$ 处评估此灵敏度：$P=200 \\ \\mathrm{W}$，$A=25 \\times 10^{-6} \\ \\mathrm{m}^2$，$t_{Ag}=25 \\times 10^{-6} \\ \\mathrm{m}$，$k_{Ag,m}=250 \\ \\mathrm{W \\ m^{-1} \\ K^{-1}}$。\n$$ S_{\\phi_{Ag}} = -\\frac{3(200)(25 \\times 10^{-6})}{2(25 \\times 10^{-6})(250)(1-0.15)^2} = -\\frac{3(200)}{2(250)(0.85)^2} = -\\frac{600}{500(0.7225)} = -\\frac{1.2}{0.7225} \\approx -1.6609 \\ \\mathrm{K} $$\n灵敏度的单位是开尔文每单位空洞率。\n**解释：** 灵敏度的负号表示随着银层中空洞率 $\\phi_{Ag}$ 的增加，温降 $\\Delta T_{j,\\mathrm{red}}$ 会减小。这是因为增加的孔隙度会降低银层的热导率，从而增加其热阻，并因此提高结温 $T_{j,Ag}$。这使得烧结银贴装的性能更接近于焊料，从而减少了转换带来的净效益。其大小，约为 $-1.66 \\ \\mathrm{K}$ 每单位分数，量化了这种性能退化。孔隙度每增加 $0.01$（例如，从 $15\\%$ 到 $16\\%$），热效益 $\\Delta T_{j,\\mathrm{red}}$ 就会减少约 $0.0166 \\ \\mathrm{K}$。在辐射诱导失效的背景下，这意味着导致孔隙度增长的损伤直接转化为更高的工作温度，而这反过来又会加速其他温度依赖的失效机制。\n\n最后，我们使用国际单位制中的给定值对 $\\Delta T_{j,\\mathrm{red}}$ 进行数值计算。\n-   $A = 25 \\ \\mathrm{mm}^2 = 25 \\times 10^{-6} \\ \\mathrm{m}^2$\n-   $t_s = 80 \\ \\mu\\mathrm{m} = 80 \\times 10^{-6} \\ \\mathrm{m}$\n-   $t_{Ag} = 25 \\ \\mu\\mathrm{m} = 25 \\times 10^{-6} \\ \\mathrm{m}$\n\n焊料贴装的比热阻项为：\n$$ \\frac{t_s}{k_{s,m}} \\frac{1+\\frac{\\phi_s}{2}}{1-\\phi_s} = \\frac{80 \\times 10^{-6}}{58} \\frac{1+\\frac{0.03}{2}}{1-0.03} = \\frac{80 \\times 10^{-6}}{58} \\frac{1.015}{0.97} \\approx 1.44320 \\times 10^{-6} \\ \\mathrm{m^2 K W^{-1}} $$\n烧结银贴装的比热阻项为：\n$$ \\frac{t_{Ag}}{k_{Ag,m}} \\frac{1+\\frac{\\phi_{Ag}}{2}}{1-\\phi_{Ag}} = \\frac{25 \\times 10^{-6}}{250} \\frac{1+\\frac{0.15}{2}}{1-0.15} = \\frac{25 \\times 10^{-6}}{250} \\frac{1.075}{0.85} \\approx 0.12647 \\times 10^{-6} \\ \\mathrm{m^2 K W^{-1}} $$\n热通量为 $P/A = 200 / (25 \\times 10^{-6}) = 8 \\times 10^6 \\ \\mathrm{W m^{-2}}$。\n$$ \\Delta T_{j,\\mathrm{red}} = (8 \\times 10^6 \\ \\mathrm{W m^{-2}}) \\left( 1.44320 \\times 10^{-6} - 0.12647 \\times 10^{-6} \\right) \\ \\mathrm{m^2 K W^{-1}} $$\n$$ \\Delta T_{j,\\mathrm{red}} = 8 \\times 10^6 \\times (1.31673 \\times 10^{-6}) \\ \\mathrm{K} = 10.53384 \\ \\mathrm{K} $$\n将结果四舍五入到四位有效数字，得到 $10.53 \\ \\mathrm{K}$。",
            "answer": "$$\\boxed{10.53}$$"
        },
        {
            "introduction": "在辐射环境中工作的功率器件会因总电离剂量（TID）等效应而遭受性能退化，其中一个关键的失效机制是电荷在氧化物层中的积累。本练习将引导您理解连接辐射诱导氧化物电荷与可测量的器件行为变化的物理机制。通过应用高斯定律和肖克利-里德-霍尔模型，您将量化关态漏电流的增加和击穿电压的降低，从而将基础物理学与关键的可靠性指标联系起来。",
            "id": "3864180",
            "problem": "一种平面高压硅$p-n$二极管在模塑环氧树脂封装中，使用结终端扩展（JTE）技术，并在二氧化硅（$\\text{SiO}_{2}$）场氧化层上覆有金属场板。在高能电离辐射环境下，正固定电荷在场氧化层和硅-氧化物界面处累积，改变了终端区域的表面电场分布，并通过增强表面产生效应增加了关态漏电流。假设在$125^{\\circ}\\text{C}$的稳定结温下，存在以下科学上真实且自洽的条件：\n\n- 终端在器件周长 $P = 5.0~\\text{cm}$ 上，沿着长度为 $L_{\\text{term}} = 0.02~\\text{cm}$ 的表面条带上完全耗尽，因此耗尽表面积为 $A_{\\text{dep}} = P L_{\\text{term}}$。\n- 漂移区厚度为 $W_{d} = 5.0 \\times 10^{-3}~\\text{cm}$，均匀掺杂，其设计使得在未经辐照的雪崩击穿时，硅中的电场分布近似为三角形，峰值等于雪崩临界电场 $E_{\\text{crit}} = 3.0 \\times 10^{5}~\\text{V/cm}$。\n- 总电离剂量在终端场氧化层中产生了空间均匀的正固定氧化物电荷密度 $N_{\\text{ox}} = 1.0 \\times 10^{12}~\\text{cm}^{-2}$。\n- 辐射感生的固定电荷通过一个增量 $\\Delta E_{\\text{surf}}$ 改变了终端中的硅表面电场，该增量遵循 $\\text{Si}$/$\\text{SiO}_{2}$ 界面处的高斯定律；由于场板屏蔽和二维边缘效应，只有该理想电场不连续性的一小部分 $\\kappa = 0.05$ 耦合到硅中。取硅的介电常数为 $\\varepsilon_{\\text{si}} = 11.7 \\varepsilon_{0}$，真空介电常数为 $\\varepsilon_{0} = 8.854 \\times 10^{-14}~\\text{F/cm}$。\n- 终端区域的关态漏电主要由 Shockley-Read-Hall (SRH) 表面产生主导。有效表面产生速率为 $s_{g}$，来自耗尽表面区域的 SRH 产生电流与 $q n_{i} s_{g} A_{\\text{dep}}$ 成正比，其中 $q = 1.602 \\times 10^{-19}~\\text{C}$ 是基本电荷，$n_{i} = 1.0 \\times 10^{12}~\\text{cm}^{-3}$ 是 $125^{\\circ}\\text{C}$ 时硅的本征载流子浓度。辐照前，$s_{g0} = 300~\\text{cm/s}$。辐照后，场氧化层充电及相关的界面缺陷产生使 $s_{g}$ 增加了一个量 $\\Delta s_{g}$，该增量与固定氧化物电荷成比例，即 $\\Delta s_{g} = \\alpha N_{\\text{ox}}$，其中 $\\alpha = 1.0 \\times 10^{-10}~\\text{cm}^{3}/\\text{s}$ 是一个与材料和温度相关的系数。\n- 该器件规定阻断的关态电压为 $V_{\\text{off}} = 600~\\text{V}$。\n\n从基本定律（适用于耗尽区的高斯定律和泊松方程）和 Shockley-Read-Hall (SRH) 产生框架出发，完成以下任务：\n\n1. 推导由辐射感生的场氧化层充电引起的终端区域漏电流增量 $\\Delta I_{\\text{leak}}$ 的表达式，并进行数值计算。\n2. 对均匀掺杂的漂移区使用一维三角形电场近似，用硅表面电场增量 $\\Delta E_{\\text{surf}}$ 表示击穿电压的降低量 $\\Delta V_{\\text{BR}}$，并进行数值计算。\n3. 计算在 $V_{\\text{off}}$ 电压下，由增加的漏电流导致的新关态功率损耗 $P_{\\text{off,new}}$。\n\n按以下顺序提供你的最终答案，共三个量：以微安（$\\mu\\text{A}$）表示的漏电流增量 $\\Delta I_{\\text{leak}}$，以伏特（V）表示的击穿电压降低量 $\\Delta V_{\\text{BR}}$，以及以毫瓦（mW）表示的新关态功率损耗 $P_{\\text{off,new}}$。将每个量四舍五入到三位有效数字。",
            "solution": "问题陈述已经过评估，被认为是有效的。它科学地基于半导体器件物理的原理，特别是针对功率二极管上的辐射效应。所提供的数据、定义和物理模型是自洽、一致且适定的，从而可以得出一个唯一且有意义的解。所有参数对于高压硅器件都是物理上真实的。\n\n解答将按要求分三部分推导。\n\n**1. 终端区域漏电流的增量 ($\\Delta I_{\\text{leak}}$)**\n\n题目指出，终端区域的关态漏电流主要由 Shockley-Read-Hall (SRH) 表面产生主导。来自耗尽表面积 $A_{\\text{dep}}$ 的产生电流 $I_{\\text{leak}}$ 由表达式 $I_{\\text{leak}} = q n_{i} s_{g} A_{\\text{dep}}$ 给出，其中 $q$ 是基本电荷，$n_{i}$ 是本征载流子浓度，$s_{g}$ 是有效表面产生速率。\n\n辐照前的初始漏电流 $I_{\\text{leak,0}}$ 对应于初始表面产生速率 $s_{g0}$：\n$$I_{\\text{leak,0}} = q n_{i} s_{g0} A_{\\text{dep}}$$\n辐照后，表面产生速率增加了一个量 $\\Delta s_{g}$，达到新值 $s_{g,\\text{new}} = s_{g0} + \\Delta s_{g}$。新的漏电流 $I_{\\text{leak,new}}$ 为：\n$$I_{\\text{leak,new}} = q n_{i} s_{g,\\text{new}} A_{\\text{dep}} = q n_{i} (s_{g0} + \\Delta s_{g}) A_{\\text{dep}}$$\n漏电流的增量 $\\Delta I_{\\text{leak}}$ 是新电流与初始电流之差：\n$$\\Delta I_{\\text{leak}} = I_{\\text{leak,new}} - I_{\\text{leak,0}} = q n_{i} (s_{g0} + \\Delta s_{g}) A_{\\text{dep}} - q n_{i} s_{g0} A_{\\text{dep}} = q n_{i} \\Delta s_{g} A_{\\text{dep}}$$\n题目明确指出，表面产生速率的增加量与固定氧化物电荷密度 $N_{\\text{ox}}$ 成比例，即 $\\Delta s_{g} = \\alpha N_{\\text{ox}}$，其中 $\\alpha$ 是一个给定的系数。将此代入 $\\Delta I_{\\text{leak}}$ 的表达式中，得到：\n$$\\Delta I_{\\text{leak}} = q n_{i} (\\alpha N_{\\text{ox}}) A_{\\text{dep}}$$\n耗尽表面积 $A_{\\text{dep}}$ 由器件周长 $P$ 和终端条带长度 $L_{\\text{term}}$ 的乘积给出，所以 $A_{\\text{dep}} = P L_{\\text{term}}$。最终的表达式是：\n$$\\Delta I_{\\text{leak}} = q n_{i} \\alpha N_{\\text{ox}} P L_{\\text{term}}$$\n现在我们代入给定的数值：\n$q = 1.602 \\times 10^{-19}~\\text{C}$\n$n_{i} = 1.0 \\times 10^{12}~\\text{cm}^{-3}$ (在 $125^{\\circ}\\text{C}$ 时)\n$\\alpha = 1.0 \\times 10^{-10}~\\text{cm}^{3}/\\text{s}$\n$N_{\\text{ox}} = 1.0 \\times 10^{12}~\\text{cm}^{-2}$\n$P = 5.0~\\text{cm}$\n$L_{\\text{term}} = 0.02~\\text{cm}$\n\n首先，计算耗尽表面积 $A_{\\text{dep}}$：\n$$A_{\\text{dep}} = (5.0~\\text{cm}) \\times (0.02~\\text{cm}) = 0.1~\\text{cm}^{2}$$\n接下来，计算 $\\Delta I_{\\text{leak}}$：\n$$\\Delta I_{\\text{leak}} = (1.602 \\times 10^{-19}~\\text{C}) \\times (1.0 \\times 10^{12}~\\text{cm}^{-3}) \\times (1.0 \\times 10^{-10}~\\text{cm}^{3}/\\text{s}) \\times (1.0 \\times 10^{12}~\\text{cm}^{-2}) \\times (0.1~\\text{cm}^{2})$$\n$$\\Delta I_{\\text{leak}} = 1.602 \\times 10^{-19+12-10+12-1}~\\text{A} = 1.602 \\times 10^{-6}~\\text{A}$$\n题目要求答案以微安（$\\mu\\text{A}$）为单位。由于 $1~\\mu\\text{A} = 10^{-6}~\\text{A}$，我们有：\n$$\\Delta I_{\\text{leak}} = 1.602~\\mu\\text{A}$$\n四舍五入到三位有效数字，$\\Delta I_{\\text{leak}} = 1.60~\\mu\\text{A}$。\n\n**2. 击穿电压的降低量 ($\\Delta V_{\\text{BR}}$)**\n\n击穿电压的降低是由辐射感生的表面电场增强引起的。正固定氧化物电荷 $N_{\\text{ox}}$ 在 $\\text{Si}$/$\\text{SiO}_{2}$ 界面处的硅中感生一个电场。根据高斯定律，界面处的理想电场不连续性会在硅中产生一个大小为 $\\Delta E_{\\text{ideal}} = \\frac{q N_{\\text{ox}}}{\\varepsilon_{\\text{si}}}$ 的电场，其中 $\\varepsilon_{\\text{si}}$ 是硅的介电常数。\n\n题目指出，只有该理想电场的一小部分 $\\kappa$ 耦合到硅中。因此，实际的表面电场增量是：\n$$\\Delta E_{\\text{surf}} = \\kappa \\frac{q N_{\\text{ox}}}{\\varepsilon_{\\text{si}}}$$\n硅的介电常数为 $\\varepsilon_{\\text{si}} = 11.7 \\varepsilon_{0}$。代入给定值：\n$q = 1.602 \\times 10^{-19}~\\text{C}$\n$N_{\\text{ox}} = 1.0 \\times 10^{12}~\\text{cm}^{-2}$\n$\\kappa = 0.05$\n$\\varepsilon_{\\text{si}} = 11.7 \\times (8.854 \\times 10^{-14}~\\text{F/cm}) = 1.0359 \\times 10^{-12}~\\text{F/cm}$\n$$\\Delta E_{\\text{surf}} = 0.05 \\times \\frac{(1.602 \\times 10^{-19}~\\text{C}) \\times (1.0 \\times 10^{12}~\\text{cm}^{-2})}{1.0359 \\times 10^{-12}~\\text{F/cm}} \\approx 7732~\\text{V/cm}$$\n对于一个厚度为 $W_d$、具有三角形电场分布的均匀掺杂漂移区，其击穿电压 $V_{\\text{BR}}$ 为 $V_{\\text{BR}} = \\frac{1}{2} E_{\\text{peak}} W_d$。当峰值电场 $E_{\\text{peak}}$ 达到临界电场 $E_{\\text{crit}}$ 时，发生击穿。在未辐照的情况下，$V_{\\text{BR,0}} = \\frac{1}{2} E_{\\text{crit}} W_d$。\n辐照后，表面电场增量 $\\Delta E_{\\text{surf}}$ 叠加在由外加电压产生的电场之上。现在，当电压感生的峰值电场与辐射感生的电场之和达到 $E_{\\text{crit}}$ 时，发生击穿。由外加电压所能支持的峰值电场降低到 $E_{\\text{crit}} - \\Delta E_{\\text{surf}}$。\n因此，新的击穿电压为：\n$$V_{\\text{BR,new}} = \\frac{1}{2} (E_{\\text{crit}} - \\Delta E_{\\text{surf}}) W_d$$\n击穿电压的降低量 $\\Delta V_{\\text{BR}}$ 是原始击穿电压与新击穿电压之差：\n$$\\Delta V_{\\text{BR}} = V_{\\text{BR,0}} - V_{\\text{BR,new}} = \\frac{1}{2} E_{\\text{crit}} W_d - \\frac{1}{2} (E_{\\text{crit}} - \\Delta E_{\\text{surf}}) W_d$$\n$$\\Delta V_{\\text{BR}} = \\frac{1}{2} \\Delta E_{\\text{surf}} W_d$$\n代入计算出的 $\\Delta E_{\\text{surf}}$ 值和给定的 $W_d = 5.0 \\times 10^{-3}~\\text{cm}$ 值：\n$$\\Delta V_{\\text{BR}} = \\frac{1}{2} (7732~\\text{V/cm}) \\times (5.0 \\times 10^{-3}~\\text{cm}) = 19.33~\\text{V}$$\n四舍五入到三位有效数字，$\\Delta V_{\\text{BR}} = 19.3~\\text{V}$。\n\n**3. 新的关态功率损耗 ($P_{\\text{off,new}}$)**\n\n在指定的关态电压 $V_{\\text{off}} = 600~\\text{V}$ 下，新的关态功率损耗 $P_{\\text{off,new}}$ 是该电压与新的总漏电流 $I_{\\text{leak,new}}$ 的乘积：\n$$P_{\\text{off,new}} = V_{\\text{off}} I_{\\text{leak,new}}$$\n新的漏电流是初始漏电流与辐射感生的增量之和：\n$$I_{\\text{leak,new}} = I_{\\text{leak,0}} + \\Delta I_{\\text{leak}}$$\n首先，我们计算初始漏电流 $I_{\\text{leak,0}}$：\n$$I_{\\text{leak,0}} = q n_{i} s_{g0} A_{\\text{dep}}$$\n使用给定值 $s_{g0} = 300~\\text{cm/s}$ 和先前计算出的 $A_{\\text{dep}} = 0.1~\\text{cm}^2$：\n$$I_{\\text{leak,0}} = (1.602 \\times 10^{-19}~\\text{C}) \\times (1.0 \\times 10^{12}~\\text{cm}^{-3}) \\times (300~\\text{cm/s}) \\times (0.1~\\text{cm}^{2})$$\n$$I_{\\text{leak,0}} = 4.806 \\times 10^{-6}~\\text{A}$$\n现在，我们使用 $\\Delta I_{\\text{leak}} = 1.602 \\times 10^{-6}~\\text{A}$ 来计算新的总漏电流：\n$$I_{\\text{leak,new}} = 4.806 \\times 10^{-6}~\\text{A} + 1.602 \\times 10^{-6}~\\text{A} = 6.408 \\times 10^{-6}~\\text{A}$$\n最后，我们计算新的功率损耗：\n$$P_{\\text{off,new}} = (600~\\text{V}) \\times (6.408 \\times 10^{-6}~\\text{A}) = 3.8448 \\times 10^{-3}~\\text{W}$$\n题目要求答案以毫瓦（mW）为单位。由于 $1~\\text{mW} = 10^{-3}~\\text{W}$：\n$$P_{\\text{off,new}} = 3.8448~\\text{mW}$$\n四舍五入到三位有效数字，$P_{\\text{off,new}} = 3.84~\\text{mW}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.60  19.3  3.84\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "除了渐进性退化，功率器件还可能因单个高能粒子而遭受随机的、灾难性的失效，例如单粒子烧毁（SEB）。对于高海拔或太空应用，预测此类事件的发生率是可靠性工程的一个关键方面。这项高级练习将挑战您从头开始构建一个全面的可靠性模型。您将综合考虑器件的易感性（通过其截面建​​模）、辐射环境（通过宇宙射线能谱建模）以及工作条件（任务剖面），以计算真实的失效率。此练习展示了如何将复杂的物理相互作用转化为可预测的工程计算。",
            "id": "3864176",
            "problem": "在偏置下工作的车用功率金属氧化物半导体场效应晶体管 (MOSFET)，易受大气次级粒子产生的电离径迹引发的单粒子烧毁 (SEB) 的影响。每设备年SEB事件的期望数可以通过以下方式建模：首先将随高度变化的微分宇宙射线谱与器件截面函数之积对线性能量传输 (LET) 进行积分，然后对任务时间剖面进行积分。使用以下基本要素和假设，从第一性原理出发推导并实现此计算：\n\n1. 泊松过程中期望计数的基本定义由瞬时率对时间的积分给出。如果 $R(t)$ 是瞬时事件率，则事件的期望数为 $N = \\int R(t)\\, dt$。\n2. 瞬时事件率是器件截面对LET的通量加权积分，写作 $R(t) = \\int_{0}^{\\infty} \\Phi(L,h(t))\\, T(L)\\, \\sigma(L)\\, dL$，其中 $L$ 是LET，$h(t)$ 是时间 $t$ 时的高度，$\\Phi(L,h)$ 是高度 $h$ 处的微分通量，$T(L)$ 是封装传输因子，$\\sigma(L)$ 是器件的SEB截面。\n3. LET定义为每单位面质量密度损失的能量，单位为 $\\mathrm{MeV\\cdot cm^2/mg}$。通量 $\\Phi(L,h)$ 的单位为 $\\mathrm{cm^{-2}\\cdot s^{-1}\\cdot (MeV\\cdot cm^2/mg)^{-1}}$，$T(L)$ 是无量纲的，而 $\\sigma(L)$ 的单位是 $\\mathrm{cm^2}$，因此 $R(t)$ 的单位是 $\\mathrm{s^{-1}}$。\n\n为确保科学真实性和可处理性，采用以下广泛使用的参数化模型：\n\nA. 器件SEB截面通过阈值威布尔函数建模：\n$$\n\\sigma(L) = \n\\begin{cases}\n0,  L \\le L_0, \\\\\n\\sigma_{\\text{sat}} \\left( 1 - \\exp\\left(-\\left(\\dfrac{L - L_0}{W}\\right)^s\\right) \\right),  L > L_0,\n\\end{cases}\n$$\n其中 $\\sigma_{\\text{sat}}$ 是饱和截面（单位为 $\\mathrm{cm^2}$），$L_0$ 是阈值LET（单位为 $\\mathrm{MeV\\cdot cm^2/mg}$），$W$ 是宽度参数（单位为 $\\mathrm{MeV\\cdot cm^2/mg}$），$s$ 是形状参数（无量纲）。\n\nB. 使用指数模型对微分LET谱进行高度标度：\n$$\n\\Phi(L,h) = F_0 \\exp\\left(\\dfrac{h}{H}\\right) \\left(\\dfrac{L}{L_{\\mathrm{ref}}}\\right)^{-p} \\exp\\left(-\\dfrac{L}{L_c}\\right),\n$$\n其中 $F_0$ 是海平面归一化常数（单位为 $\\mathrm{cm^{-2}\\cdot s^{-1}\\cdot (MeV\\cdot cm^2/mg)^{-1}}$），$H$ 是标高（单位为米），$L_{\\mathrm{ref}} = 1\\,\\mathrm{MeV\\cdot cm^2/mg}$，$p$ 是谱指数，$L_c$ 是高LET截止值（单位为 $\\mathrm{MeV\\cdot cm^2/mg}$）。\n\nC. 封装传输因子，用于表示电离径迹穿过封装材料时的衰减：\n$$\nT(L) = \\exp(-\\beta L),\n$$\n其中 $\\beta$ 是有效衰减系数（单位为 $\\mathrm{(MeV\\cdot cm^2/mg)^{-1}}$），$T(L)$ 是无量纲的。\n\n设任务剖面在高度和占空比（器件处于偏置状态的时间比例）上是分段恒定的。对于一个任务段 $i$，其高度为 $h_i$（单位为米），持续时间为 $\\Delta t_i$（单位为小时），占空比为 $d_i$（无量纲），其对期望SEB事件的贡献为：\n$$\nN_i = d_i \\left( \\Delta t_i \\times 3600 \\right) \\int_{0}^{L_{\\max}} \\Phi(L,h_i)\\, T(L)\\, \\sigma(L)\\, dL.\n$$\n每设备年的总期望事件数为 $N = \\sum_i N_i$，其中 $L_{\\max}$ 是一个足够大的LET积分上限，以捕捉响应的尾部；使用 $L_{\\max} = 100\\,\\mathrm{MeV\\cdot cm^2/mg}$。\n\n你的任务是实现一个程序，对于下方的每个测试用例，通过在精细网格上对LET进行数值积分以及对任务段求和，来计算每设备年的期望SEB事件数。请严格按照所述的单位和公式进行计算，并在需要时将小时转换为秒。\n\n将最终答案以“事件/设备年”为单位表示为浮点数，并四舍五入到六位小数。\n\n测试套件：\n- 案例1（具有中等高度的典型任务）：\n  - 截面参数：$\\sigma_{\\text{sat}} = 2.0\\times 10^{-6}\\,\\mathrm{cm^2}$, $L_0 = 12\\,\\mathrm{MeV\\cdot cm^2/mg}$, $W = 18\\,\\mathrm{MeV\\cdot cm^2/mg}$, $s = 3.0$。\n  - 谱参数：$F_0 = 1.0\\times 10^{-6}\\,\\mathrm{cm^{-2}\\cdot s^{-1}\\cdot (MeV\\cdot cm^2/mg)^{-1}}$, $H = 8000\\,\\mathrm{m}$, $p = 2.2$, $L_c = 30\\,\\mathrm{MeV\\cdot cm^2/mg}$。\n  - 封装衰减：$\\beta = 0.02\\,\\mathrm{(MeV\\cdot cm^2/mg)^{-1}}$。\n  - 任务段：$(h_1 = 0\\,\\mathrm{m}, \\Delta t_1 = 4000\\,\\mathrm{h}, d_1 = 0.5)$ 和 $(h_2 = 2000\\,\\mathrm{m}, \\Delta t_2 = 4760\\,\\mathrm{h}, d_2 = 0.75)$。\n- 案例2（更强的封装衰减和更小的敏感面积）：\n  - 截面参数：$\\sigma_{\\text{sat}} = 5.0\\times 10^{-7}\\,\\mathrm{cm^2}$, $L_0 = 15\\,\\mathrm{MeV\\cdot cm^2/mg}$, $W = 12\\,\\mathrm{MeV\\cdot cm^2/mg}$, $s = 2.5$。\n  - 谱参数：$F_0 = 1.0\\times 10^{-6}\\,\\mathrm{cm^{-2}\\cdot s^{-1}\\cdot (MeV\\cdot cm^2/mg)^{-1}}$, $H = 8000\\,\\mathrm{m}$, $p = 2.2$, $L_c = 30\\,\\mathrm{MeV\\cdot cm^2/mg}$。\n  - 封装衰减：$\\beta = 0.08\\,\\mathrm{(MeV\\cdot cm^2/mg)^{-1}}$。\n  - 任务段：$(h_1 = 0\\,\\mathrm{m}, \\Delta t_1 = 6000\\,\\mathrm{h}, d_1 = 0.3)$ 和 $(h_2 = 1500\\,\\mathrm{m}, \\Delta t_2 = 2760\\,\\mathrm{h}, d_2 = 0.6)$。\n- 案例3（高阈值器件，在给定谱下基本免疫）：\n  - 截面参数：$\\sigma_{\\text{sat}} = 1.0\\times 10^{-6}\\,\\mathrm{cm^2}$, $L_0 = 60\\,\\mathrm{MeV\\cdot cm^2/mg}$, $W = 10\\,\\mathrm{MeV\\cdot cm^2/mg}$, $s = 3.0$。\n  - 谱参数：$F_0 = 1.0\\times 10^{-6}\\,\\mathrm{cm^{-2}\\cdot s^{-1}\\cdot (MeV\\cdot cm^2/mg)^{-1}}$, $H = 8000\\,\\mathrm{m}$, $p = 2.2$, $L_c = 30\\,\\mathrm{MeV\\cdot cm^2/mg}$。\n  - 封装衰减：$\\beta = 0.01\\,\\mathrm{(MeV\\cdot cm^2/mg)^{-1}}$。\n  - 任务段：$(h_1 = 1000\\,\\mathrm{m}, \\Delta t_1 = 8760\\,\\mathrm{h}, d_1 = 0.8)$。\n\n算法要求：\n- 在 $L \\in [0, 100]\\,\\mathrm{MeV\\cdot cm^2/mg}$ 的网格上进行LET的数值积分，使用足够精细的离散化以确保收敛（例如，至少 $10^4$ 个点）。\n- 对 $L$ 的积分使用梯形法则。\n- 对时间加权的任务段贡献求和，以获得年度期望事件数。\n- 将每个案例的最终结果四舍五入到六位小数。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，`[result1,result2,result3]`），每个结果都是一个四舍五入到六位小数的浮点数，分别代表案例1、2和3的每设备年期望SEB事件数。",
            "solution": "问题陈述已经过仔细审查，并被确定为有效。它在科学上基于辐射对半导体器件影响的原理，提法得当，目标明确，数据充分，并且没有任何事实错误、主观论断或逻辑不一致。所有提供的物理模型、参数和单位在电力电子可靠性领域都是标准的，并且相互一致。任务是基于这个坚实的理论框架实现一个数值计算。\n\n每设备年的单粒子烧毁 (SEB) 事件期望数，记为 $N$，是通过对指定任务剖面中每个任务段的贡献求和来计算的。\n$$\nN = \\sum_{i} N_i\n$$\n其中 $N_i$ 是任务段 $i$ 期间的期望事件数。\n\n对于每个任务段 $i$，其特征为高度 $h_i$、持续时间 $\\Delta t_i$（小时）和偏置占空比 $d_i$，其事件期望数是有效工作时间（秒）与该高度下恒定瞬时事件率 $R(h_i)$ 的乘积。通过乘以 3600 实现从小时到秒的转换。\n$$\nN_i = d_i \\left( \\Delta t_i \\times 3600 \\right) R(h_i)\n$$\n瞬时事件率 $R(h_i)$ 是通过将微分宇宙射线通量 $\\Phi(L,h_i)$、封装传输因子 $T(L)$ 和器件的SEB截面 $\\sigma(L)$ 的乘积对线性能量传输 (LET) $L$进行积分来确定的。\n$$\nR(h_i) = \\int_{0}^{L_{\\max}} \\Phi(L,h_i)\\, T(L)\\, \\sigma(L)\\, dL\n$$\n积分上限设定为一个足够大的值，$L_{\\max} = 100\\,\\mathrm{MeV\\cdot cm^2/mg}$。\n\n被积函数由问题陈述中提供的三个模型组成：\n\n1.  **器件SEB截面 $\\sigma(L)$**：一个阈值威布尔函数，当LET低于阈值 $L_0$ 时为零，在高LET值时饱和于 $\\sigma_{\\text{sat}}$。\n    $$\n    \\sigma(L) = \n    \\begin{cases}\n    0,  L \\le L_0 \\\\\n    \\sigma_{\\text{sat}} \\left( 1 - \\exp\\left(-\\left(\\dfrac{L - L_0}{W}\\right)^s\\right) \\right),  L > L_0\n    \\end{cases}\n    $$\n    此处，$\\sigma_{\\text{sat}}$ 是饱和截面，$W$ 是宽度参数，$s$ 是形状参数。\n\n2.  **微分LET谱 $\\Phi(L,h)$**：一个结合了指数形式的高度依赖性和LET谱函数形式（带指数截止的幂律）的模型。\n    $$\n    \\Phi(L,h) = F_0 \\exp\\left(\\dfrac{h}{H}\\right) \\left(\\dfrac{L}{L_{\\mathrm{ref}}}\\right)^{-p} \\exp\\left(-\\dfrac{L}{L_c}\\right)\n    $$\n    此处，$F_0$ 是海平面通量归一化常数，$H$ 是大气标高，$L_{\\mathrm{ref}} = 1\\,\\mathrm{MeV\\cdot cm^2/mg}$ 是参考LET，$p$ 是谱指数，$L_c$ 是高LET截止值。\n\n3.  **封装传输因子 $T(L)$**：一个表示器件封装屏蔽效应的指数衰减模型。\n    $$\n    T(L) = \\exp(-\\beta L)\n    $$\n    此处，$\\beta$ 是一个有效衰减系数。\n\n将这些模型结合起来，用于任务段 $i$ 中事件率计算的完整被积函数是：\n$$\n\\text{Integrand}(L, h_i) = F_0 \\exp\\left(\\dfrac{h_i}{H}\\right) \\left(\\dfrac{L}{L_{\\mathrm{ref}}}\\right)^{-p} \\exp\\left(-\\dfrac{L}{L_c}\\right) \\times \\exp(-\\beta L) \\times \\sigma(L)\n$$\n该表达式在 $L > 0$ 时有效。项 $(L/L_{\\mathrm{ref}})^{-p}$ 在 $L=0$ 处存在一个奇点。然而，由于截面 $\\sigma(L)$ 对于所有 $L \\le L_0$ 都严格为零，且所有测试用例都指定了 $L_0 > 0$，因此被积函数在 $L=0$ 附近为零，该奇点不影响定积分的结果。\n\n该计算以数值方式执行。LET的积分域 $L \\in [0, L_{\\max}]$ 被离散化为一个至少包含 $10^4$ 个点的精细网格。然后使用梯形法则来近似计算 $R(h_i)$ 的定积分。对于一组具有值 $f_j = \\text{Integrand}(L_j, h_i)$ 和均匀间距 $\\Delta L$ 的 $M+1$ 个点 $L_j$，积分为：\n$$\n\\int_{0}^{L_{\\max}} \\text{Integrand}(L, h_i) dL \\approx \\Delta L \\left( \\frac{f_0 + f_{M}}{2} + \\sum_{j=1}^{M-1} f_j \\right)\n$$\n对测试用例中指定的每个任务段重复此过程。将得到的事件计数 $N_i$ 求和，以获得每设备年的总期望事件数 $N$，然后按要求将其四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the expected number of Single Event Burnout (SEB) events per\n    device-year for power MOSFETs based on given models and mission profiles.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"case_id\": 1,\n            \"params\": {\n                \"sigma_sat\": 2.0e-6, \"L0\": 12.0, \"W\": 18.0, \"s\": 3.0,\n                \"F0\": 1.0e-6, \"H\": 8000.0, \"p\": 2.2, \"Lc\": 30.0,\n                \"beta\": 0.02\n            },\n            \"mission_segments\": [\n                {\"h\": 0.0, \"dt\": 4000.0, \"d\": 0.5},\n                {\"h\": 2000.0, \"dt\": 4760.0, \"d\": 0.75}\n            ]\n        },\n        {\n            \"case_id\": 2,\n            \"params\": {\n                \"sigma_sat\": 5.0e-7, \"L0\": 15.0, \"W\": 12.0, \"s\": 2.5,\n                \"F0\": 1.0e-6, \"H\": 8000.0, \"p\": 2.2, \"Lc\": 30.0,\n                \"beta\": 0.08\n            },\n            \"mission_segments\": [\n                {\"h\": 0.0, \"dt\": 6000.0, \"d\": 0.3},\n                {\"h\": 1500.0, \"dt\": 2760.0, \"d\": 0.6}\n            ]\n        },\n        {\n            \"case_id\": 3,\n            \"params\": {\n                \"sigma_sat\": 1.0e-6, \"L0\": 60.0, \"W\": 10.0, \"s\": 3.0,\n                \"F0\": 1.0e-6, \"H\": 8000.0, \"p\": 2.2, \"Lc\": 30.0,\n                \"beta\": 0.01\n            },\n            \"mission_segments\": [\n                {\"h\": 1000.0, \"dt\": 8760.0, \"d\": 0.8}\n            ]\n        }\n    ]\n\n    # Constants and numerical integration setup\n    L_ref = 1.0\n    L_max = 100.0\n    num_points = 10001\n    L_grid = np.linspace(0.0, L_max, num_points)\n    \n    results = []\n\n    for case in test_cases:\n        params = case[\"params\"]\n        mission_segments = case[\"mission_segments\"]\n        \n        # Unpack parameters\n        sigma_sat = params[\"sigma_sat\"]\n        L0 = params[\"L0\"]\n        W = params[\"W\"]\n        s = params[\"s\"]\n        F0 = params[\"F0\"]\n        H = params[\"H\"]\n        p = params[\"p\"]\n        Lc = params[\"Lc\"]\n        beta = params[\"beta\"]\n\n        total_events_per_year = 0.0\n\n        for segment in mission_segments:\n            h = segment[\"h\"]\n            dt = segment[\"dt\"]\n            d = segment[\"d\"]\n            \n            # 1. Calculate device cross-section sigma(L)\n            sigma_L = np.zeros_like(L_grid)\n            mask_L_gt_L0 = L_grid > L0\n            L_active = L_grid[mask_L_gt_L0]\n            # Ensure W is not zero to avoid division by zero\n            if W > 0:\n                weibull_arg = (L_active - L0) / W\n                sigma_L[mask_L_gt_L0] = sigma_sat * (1.0 - np.exp(-(weibull_arg**s)))\n\n            # 2. Calculate differential LET spectrum Phi(L,h)\n            phi_Lh = np.zeros_like(L_grid)\n            mask_L_gt_0 = L_grid > 0\n            L_positive = L_grid[mask_L_gt_0]\n            \n            altitude_factor = np.exp(h / H)\n            spectrum_L_part = (L_positive / L_ref)**(-p) * np.exp(-L_positive / Lc)\n            phi_Lh[mask_L_gt_0] = F0 * altitude_factor * spectrum_L_part\n            \n            # 3. Calculate package transmission factor T(L)\n            T_L = np.exp(-beta * L_grid)\n\n            # 4. Form the integrand: Phi * T * sigma\n            integrand = phi_Lh * T_L * sigma_L\n\n            # 5. Numerically integrate to find the event rate R(h)\n            event_rate_at_h = np.trapz(integrand, L_grid)\n\n            # 6. Calculate events for the segment and add to total\n            seconds_in_segment = dt * 3600.0\n            events_in_segment = d * seconds_in_segment * event_rate_at_h\n            total_events_per_year += events_in_segment\n\n        results.append(round(total_events_per_year, 6))\n\n    # Format the final output string\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}