{
    "hands_on_practices": [
        {
            "introduction": "The performance of a Bipolar Junction Transistor is fundamentally tied to its physical structure and the properties of its semiconductor materials. This first practice delves into this core relationship by tasking you with designing the base region of a power BJT . By deriving the connection between base width $W_B$, minority carrier lifetime $\\tau_n$, and the base transport factor $\\alpha_T$, you will gain a first-hand understanding of the trade-offs involved in achieving a desired current gain.",
            "id": "3867046",
            "problem": "An $n$-$p$-$n$ power Bipolar Junction Transistor (BJT) is designed with a uniformly doped $p$-type base region of width $W_B$ and negligible built-in electric field across the quasi-neutral base. Assume one-dimensional low-level injection, so that the minority-carrier electron transport in the base is governed by diffusion and Shockley-Read-Hall recombination. The electron diffusivity in the base is $D_n$ and the minority-carrier lifetime is $\\tau_n$. The device is intended to operate at an angular frequency $\\omega = 2 \\pi f$ with $f$ sufficiently low that the condition $\\omega \\tau_n \\ll 1$ holds, so that the quasi-static approximation is valid.\n\nStarting from the continuity equation in the base and appropriate boundary conditions at the emitter-base and collector-base depletion edges, derive the frequency-domain expression for the base transport factor magnitude and then specialize it under the quasi-static condition to obtain a design relation between $W_B$, $D_n$, $\\tau_n$, and a target transport factor magnitude $\\alpha_T$. Use this relation to calculate the required base width $W_B$ that achieves a target transport factor magnitude $\\alpha_T = 0.90$ at $f = 100\\,\\mathrm{kHz}$ given $D_n = 20\\,\\mathrm{cm^2/s}$ and $\\tau_n = 0.20\\,\\mu\\mathrm{s}$. Express your final numerical answer for $W_B$ in $\\mu\\mathrm{m}$ and round to three significant figures.\n\nThen, briefly discuss the sensitivity of the required $W_B$ to variations in $\\tau_n$ at fixed $\\alpha_T$ and $D_n$, identifying the relative sensitivity and its physical implication. Your final reported answer must be only the computed $W_B$ value.",
            "solution": "The user-provided problem has been validated and is determined to be a well-posed, scientifically grounded problem in semiconductor device physics.\n\nThe analysis begins with the one-dimensional, time-dependent continuity equation for excess minority-carrier electrons, $\\delta n_p(x,t)$, in the quasi-neutral $p$-type base region. Assuming transport is dominated by diffusion and Shockley-Read-Hall recombination, and the built-in field is negligible, the equation is:\n$$\n\\frac{\\partial \\delta n_p(x,t)}{\\partial t} = D_n \\frac{\\partial^2 \\delta n_p(x,t)}{\\partial x^2} - \\frac{\\delta n_p(x,t)}{\\tau_n}\n$$\nwhere $D_n$ is the electron diffusivity and $\\tau_n$ is the electron lifetime in the base.\n\nFor sinusoidal steady-state analysis at an angular frequency $\\omega$, we express the excess carrier concentration as a phasor $\\tilde{n}_p(x)$ such that $\\delta n_p(x,t) = \\text{Re}\\{\\tilde{n}_p(x) e^{j\\omega t}\\}$. Substituting this into the continuity equation yields the time-independent ordinary differential equation for the phasor:\n$$\nj\\omega \\tilde{n}_p(x) = D_n \\frac{d^2 \\tilde{n}_p(x)}{dx^2} - \\frac{\\tilde{n}_p(x)}{\\tau_n}\n$$\nRearranging this equation gives:\n$$\n\\frac{d^2 \\tilde{n}_p(x)}{dx^2} - \\left( \\frac{1+j\\omega\\tau_n}{D_n\\tau_n} \\right) \\tilde{n}_p(x) = 0\n$$\nWe define the complex diffusion length $L_n(\\omega)$ as:\n$$\nL_n^2(\\omega) = \\frac{D_n\\tau_n}{1+j\\omega\\tau_n} = \\frac{L_{n0}^2}{1+j\\omega\\tau_n}\n$$\nwhere $L_{n0} = \\sqrt{D_n\\tau_n}$ is the DC minority-carrier diffusion length. The differential equation simplifies to:\n$$\n\\frac{d^2 \\tilde{n}_p(x)}{dx^2} - \\frac{\\tilde{n}_p(x)}{L_n^2(\\omega)} = 0\n$$\nThe general solution to this equation is $\\tilde{n}_p(x) = A \\sinh(x/L_n(\\omega)) + B \\cosh(x/L_n(\\omega))$. The boundary conditions are applied at the edges of the quasi-neutral base, from $x=0$ (emitter-base depletion edge) to $x=W_B$ (collector-base depletion edge).\n1.  At the forward-biased emitter-base junction edge, $x=0$, the AC excess carrier concentration is non-zero, $\\tilde{n}_p(0) = \\tilde{n}_{p,E}$.\n2.  At the reverse-biased collector-base junction edge, $x=W_B$, the excess carrier concentration is assumed to be zero, $\\tilde{n}_p(W_B) = 0$.\n\nApplying the second boundary condition to the alternative general solution form $\\tilde{n}_p(x) = C \\sinh((W_B-x)/L_n(\\omega)) + D \\cosh((W_B-x)/L_n(\\omega))$ immediately gives $D=0$. Applying the first boundary condition gives $C = \\tilde{n}_{p,E} / \\sinh(W_B/L_n(\\omega))$. Thus, the excess electron profile is:\n$$\n\\tilde{n}_p(x) = \\tilde{n}_{p,E} \\frac{\\sinh\\left(\\frac{W_B-x}{L_n(\\omega)}\\right)}{\\sinh\\left(\\frac{W_B}{L_n(\\omega)}\\right)}\n$$\nThe AC electron current density is due to diffusion: $\\tilde{J}_n(x) = q D_n \\frac{d\\tilde{n}_p(x)}{dx}$. The AC electron current injected from the emitter is $\\tilde{I}_{nE} = - Area \\cdot \\tilde{J}_n(0)$, and the AC electron current collected at the collector is $\\tilde{I}_{nC} = - Area \\cdot \\tilde{J}_n(W_B)$. The base transport factor, $\\alpha_T(\\omega)$, is the ratio $\\tilde{I}_{nC} / \\tilde{I}_{nE} = \\tilde{J}_n(W_B) / \\tilde{J}_n(0)$.\nFirst, we find the derivatives:\n$$\n\\frac{d\\tilde{n}_p}{dx} = -\\frac{\\tilde{n}_{p,E}}{L_n(\\omega)} \\frac{\\cosh\\left(\\frac{W_B-x}{L_n(\\omega)}\\right)}{\\sinh\\left(\\frac{W_B}{L_n(\\omega)}\\right)}\n$$\nEvaluating at the boundaries:\n$$\n\\tilde{J}_n(0) = q D_n \\left.\\frac{d\\tilde{n}_p}{dx}\\right|_{x=0} = -\\frac{q D_n \\tilde{n}_{p,E}}{L_n(\\omega)} \\coth\\left(\\frac{W_B}{L_n(\\omega)}\\right)\n$$\n$$\n\\tilde{J}_n(W_B) = q D_n \\left.\\frac{d\\tilde{n}_p}{dx}\\right|_{x=W_B} = -\\frac{q D_n \\tilde{n}_{p,E}}{L_n(\\omega)} \\frac{1}{\\sinh\\left(\\frac{W_B}{L_n(\\omega)}\\right)}\n$$\nThe frequency-dependent base transport factor is then:\n$$\n\\alpha_T(\\omega) = \\frac{\\tilde{J}_n(W_B)}{\\tilde{J}_n(0)} = \\frac{1/\\sinh\\left(\\frac{W_B}{L_n(\\omega)}\\right)}{\\coth\\left(\\frac{W_B}{L_n(\\omega)}\\right)} = \\frac{1}{\\cosh\\left(\\frac{W_B}{L_n(\\omega)}\\right)} = \\text{sech}\\left(\\frac{W_B}{L_n(\\omega)}\\right)\n$$\nThe problem specifies operation under the quasi-static condition $\\omega\\tau_n \\ll 1$. Let's check the given values: $\\omega\\tau_n = (2\\pi f)\\tau_n = (2\\pi \\times 100 \\times 10^3\\,\\mathrm{s^{-1}}) (0.20 \\times 10^{-6}\\,\\mathrm{s}) = 0.04\\pi \\approx 0.126$. Since $0.126 \\ll 1$, the condition is satisfied. Under this condition, the complex argument of the sech function can be approximated.\n$$\n\\frac{W_B}{L_n(\\omega)} = \\frac{W_B}{L_{n0}} \\sqrt{1+j\\omega\\tau_n} \\approx \\frac{W_B}{L_{n0}} \\left(1 + j\\frac{\\omega\\tau_n}{2}\\right)\n$$\nHowever, a more direct interpretation of the quasi-static condition in this context is that the frequency is low enough that the transport factor's magnitude is dominated by recombination, not by frequency-dependent phase-shift effects. The magnitude $|\\alpha_T(\\omega)|$ is thus well-approximated by its DC value, $\\alpha_{T0}$.\n$$\n|\\alpha_T(\\omega)| = \\left|\\text{sech}\\left(\\frac{W_B}{L_{n0}} \\sqrt{1+j\\omega\\tau_n}\\right)\\right| \\approx \\left|\\text{sech}\\left(\\frac{W_B}{L_{n0}}\\right)\\right| = \\text{sech}\\left(\\frac{W_B}{L_{n0}}\\right)\n$$\nWe set this expression equal to the target transport factor magnitude, $\\alpha_T$:\n$$\n\\alpha_T = \\text{sech}\\left(\\frac{W_B}{\\sqrt{D_n\\tau_n}}\\right)\n$$\nThis is the required design relation. To find the base width $W_B$, we solve for it:\n$$\n\\frac{1}{\\alpha_T} = \\cosh\\left(\\frac{W_B}{\\sqrt{D_n\\tau_n}}\\right) \\implies \\frac{W_B}{\\sqrt{D_n\\tau_n}} = \\text{arccosh}\\left(\\frac{1}{\\alpha_T}\\right)\n$$\n$$\nW_B = \\sqrt{D_n\\tau_n} \\cdot \\text{arccosh}\\left(\\frac{1}{\\alpha_T}\\right)\n$$\nNow we substitute the given numerical values: $\\alpha_T = 0.90$, $D_n = 20\\,\\mathrm{cm^2/s}$, and $\\tau_n = 0.20\\,\\mu\\mathrm{s}$. We must use consistent units, so we convert $D_n$ to $\\mathrm{m^2/s}$ and $\\tau_n$ to $\\mathrm{s}$.\n$$\nD_n = 20\\,\\mathrm{cm^2/s} = 20 \\times (10^{-2}\\,\\mathrm{m})^2/\\mathrm{s} = 2.0 \\times 10^{-3}\\,\\mathrm{m^2/s}\n$$\n$$\n\\tau_n = 0.20\\,\\mu\\mathrm{s} = 2.0 \\times 10^{-7}\\,\\mathrm{s}\n$$\nFirst, calculate the DC diffusion length $L_{n0} = \\sqrt{D_n\\tau_n}$:\n$$\nL_{n0} = \\sqrt{(2.0 \\times 10^{-3}\\,\\mathrm{m^2/s}) \\times (2.0 \\times 10^{-7}\\,\\mathrm{s})} = \\sqrt{4.0 \\times 10^{-10}\\,\\mathrm{m^2}} = 2.0 \\times 10^{-5}\\,\\mathrm{m} = 20\\,\\mu\\mathrm{m}\n$$\nNext, calculate the arccosh term:\n$$\n\\text{arccosh}\\left(\\frac{1}{\\alpha_T}\\right) = \\text{arccosh}\\left(\\frac{1}{0.90}\\right) = \\text{arccosh}\\left(\\frac{10}{9}\\right)\n$$\nUsing the identity $\\text{arccosh}(x) = \\ln(x + \\sqrt{x^2 - 1})$:\n$$\n\\text{arccosh}\\left(\\frac{10}{9}\\right) = \\ln\\left(\\frac{10}{9} + \\sqrt{\\left(\\frac{10}{9}\\right)^2 - 1}\\right) = \\ln\\left(\\frac{10}{9} + \\sqrt{\\frac{100-81}{81}}\\right) = \\ln\\left(\\frac{10+\\sqrt{19}}{9}\\right) \\approx 0.46714\n$$\nFinally, calculate the base width $W_B$:\n$$\nW_B = (2.0 \\times 10^{-5}\\,\\mathrm{m}) \\times 0.46714 \\approx 9.3428 \\times 10^{-6}\\,\\mathrm{m}\n$$\nThe problem requests the answer in micrometers ($\\mu\\mathrm{m}$), rounded to three significant figures.\n$$\nW_B \\approx 9.34\\,\\mu\\mathrm{m}\n$$\nFor the discussion of sensitivity, we analyze the relation $W_B = \\sqrt{D_n \\tau_n} \\cdot \\text{arccosh}(1/\\alpha_T)$. For fixed $\\alpha_T$ and $D_n$, $W_B$ is proportional to $\\sqrt{\\tau_n}$. The relative sensitivity of $W_B$ with respect to $\\tau_n$ is $S_{\\tau_n}^{W_B} = \\frac{\\tau_n}{W_B}\\frac{\\partial W_B}{\\partial \\tau_n}$. Since $W_B = C\\tau_n^{1/2}$ where $C$ is a constant, $\\frac{\\partial W_B}{\\partial \\tau_n} = \\frac{1}{2} C \\tau_n^{-1/2} = \\frac{W_B}{2\\tau_n}$. Therefore, $S_{\\tau_n}^{W_B} = \\frac{1}{2}$. This means a $10\\%$ decrease in lifetime $\\tau_n$ requires a $5\\%$ decrease (narrowing) of the base width $W_B$ to maintain the same base transport factor $\\alpha_T$. This highlights the critical interplay between material quality (lifetime) and structural design (base width) in achieving desired transistor performance.",
            "answer": "$$\\boxed{9.34}$$"
        },
        {
            "introduction": "Power BJTs operate at high power densities, making them susceptible to a dangerous positive feedback loop known as thermal runaway. This exercise guides you through the process of deriving the stability criterion to prevent this failure mode from first principles . By constructing a small-signal electro-thermal model, you will learn to quantify the conditions for stable operation and calculate the design margin against thermal instability, a critical skill for any power device designer.",
            "id": "3867048",
            "problem": "A high-current Bipolar Junction Transistor (BJT) operated in forward-active mode is used in a linear power stage with a constant applied collector-emitter voltage $V_{CE}$ over the timescale of interest. To assess and prevent thermal runaway, you are to derive a stability criterion in terms of the local slope of the collector current versus base-emitter voltage characteristic $I_{C}$–$V_{BE}$ at the operating point and the thermal impedance. Use only fundamental device relations and the definition of thermal impedance.\n\nAssume the following physically grounded facts at the operating point:\n- The collector current obeys the exponential relation $I_{C}=I_{S}\\exp(V_{BE}/V_{T})$, where $V_{T}=k_{B}T/q$, $k_{B}$ is the Boltzmann constant, $q$ is the elementary charge, and $T$ is the absolute junction temperature.\n- The required base-emitter voltage to sustain a fixed collector current $I_{C}$ decreases with temperature; define the local positive coefficient $\\theta$ by $\\theta \\equiv -\\left.\\frac{\\partial V_{BE,\\mathrm{req}}}{\\partial T}\\right|_{I_{C}}$.\n- The small-signal thermal impedance $Z_{th}(\\tau)$ relates incremental temperature rise to incremental power over the time horizon $\\tau$, so that a small change in dissipated power $\\delta P$ produces a small change in junction temperature $\\delta T = Z_{th}(\\tau)\\,\\delta P$.\n- Over the timescale $\\tau$, $V_{CE}$ is effectively constant, so $\\delta P \\approx V_{CE}\\,\\delta I_{C}$.\n\nStarting from these bases, derive the small-signal stability criterion that ensures thermal feedback does not diverge. Your criterion should be expressed in terms of the local slope $\\left.\\frac{\\partial I_{C}}{\\partial V_{BE}}\\right|_{Q}$ at the operating point $Q$, the thermal impedance $Z_{th}(\\tau)$, $V_{CE}$, and $\\theta$, without introducing any heuristic formulas beyond the stated bases. Then, evaluate the numerical design margin defined as $m \\equiv 1 - G_{th}$, where $G_{th}$ is the net small-signal thermal loop gain obtained in your derivation, for the following operating conditions:\n\n- Operating collector current: $I_{C} = 20\\,\\mathrm{A}$.\n- Junction temperature at the operating point: $T = 350\\,\\mathrm{K}$.\n- Collector-emitter voltage over the timescale $\\tau$: $V_{CE} = 3.5\\,\\mathrm{V}$.\n- Local temperature coefficient of the required base-emitter voltage at fixed current: $\\theta = 1.7 \\times 10^{-3}\\,\\mathrm{V/K}$.\n- Small-signal thermal impedance at the timescale $\\tau$: $Z_{th}(\\tau) = 1.5 \\times 10^{-2}\\,\\mathrm{K/W}$.\n\nUse $k_{B} = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J/K}$ and $q = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$ for evaluating $V_{T}$ at $350\\,\\mathrm{K}$. Express the final design margin $m$ as a dimensionless decimal rounded to four significant figures. Do not include units in your final boxed answer.",
            "solution": "The problem statement is evaluated for validity prior to attempting a solution.\n\n### Step 1: Extracted Givens\n- A high-current Bipolar Junction Transistor (BJT) is in forward-active mode in a linear power stage.\n- Collector-emitter voltage $V_{CE}$ is constant over the timescale of interest.\n- Collector current relation: $I_{C}=I_{S}\\exp(V_{BE}/V_{T})$.\n- Thermal voltage definition: $V_{T}=k_{B}T/q$, where $k_{B}$ is the Boltzmann constant, $q$ is the elementary charge, and $T$ is the absolute junction temperature.\n- Local temperature coefficient of required base-emitter voltage at fixed current: $\\theta \\equiv -\\left.\\frac{\\partial V_{BE,\\mathrm{req}}}{\\partial T}\\right|_{I_{C}}$. $\\theta$ is positive.\n- Small-signal thermal impedance relation: $\\delta T = Z_{th}(\\tau)\\,\\delta P$.\n- Small-signal power dissipation relation: $\\delta P \\approx V_{CE}\\,\\delta I_{C}$.\n- Task 1: Derive the small-signal stability criterion.\n- Task 2: Evaluate the numerical design margin $m \\equiv 1 - G_{th}$, where $G_{th}$ is the thermal loop gain.\n- Operating collector current: $I_{C} = 20\\,\\mathrm{A}$.\n- Junction temperature at operating point: $T = 350\\,\\mathrm{K}$.\n- Collector-emitter voltage: $V_{CE} = 3.5\\,\\mathrm{V}$.\n- Local temperature coefficient: $\\theta = 1.7 \\times 10^{-3}\\,\\mathrm{V/K}$.\n- Small-signal thermal impedance: $Z_{th}(\\tau) = 1.5 \\times 10^{-2}\\,\\mathrm{K/W}$.\n- Boltzmann constant: $k_{B} = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J/K}$.\n- Elementary charge: $q = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$.\n- Final answer specification: $m$ as a dimensionless decimal rounded to four significant figures.\n\n### Step 2: Validation\nThe problem is scientifically grounded, describing the well-established phenomenon of thermal runaway in BJTs through an electro-thermal feedback loop. All provided equations and definitions are standard in semiconductor device physics and electronics (Ebers-Moll relation, definition of thermal impedance, temperature dependence of the p-n junction voltage). The problem is well-posed, providing all necessary data and conditions for both the derivation and the numerical calculation. The language is objective and precise. The numerical values are physically realistic for a power BJT application. The problem does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be provided.\n\n### Derivation of the Stability Criterion\n\nThermal runaway in a BJT is a positive feedback phenomenon. The feedback loop can be analyzed by considering the effect of a small perturbation at the operating point $Q$.\n\n$1$. A small increase in collector current, $\\delta I_{C}$, increases the power dissipated by the transistor. Since $V_{CE}$ is constant, the change in power dissipation is:\n$$ \\delta P = V_{CE} \\delta I_{C} $$\n\n$2$. This increase in power dissipation leads to a rise in the junction temperature, $\\delta T$, governed by the thermal impedance $Z_{th}(\\tau)$:\n$$ \\delta T = Z_{th}(\\tau) \\delta P = Z_{th}(\\tau) V_{CE} \\delta I_{C} $$\n\n$3$. The rise in junction temperature, in turn, affects the collector current. For a BJT under a constant external base-emitter voltage bias, a higher temperature leads to a higher collector current. This constitutes the feedback path. To quantify this effect, we need the partial derivative $\\left(\\frac{\\partial I_{C}}{\\partial T}\\right)_{V_{BE}}$. This derivative can be related to the given quantities using the triple product rule for partial derivatives involving the state variables $I_C$, $V_{BE}$, and $T$:\n$$ \\left(\\frac{\\partial I_{C}}{\\partial V_{BE}}\\right)_{T} \\left(\\frac{\\partial V_{BE}}{\\partial T}\\right)_{I_{C}} \\left(\\frac{\\partial T}{\\partial I_{C}}\\right)_{V_{BE}} = -1 $$\nFrom the definition $\\theta \\equiv -\\left(\\frac{\\partial V_{BE}}{\\partial T}\\right)_{I_{C}}$, we have $\\left(\\frac{\\partial V_{BE}}{\\partial T}\\right)_{I_{C}} = -\\theta$. Substituting this into the triple product rule:\n$$ \\left(\\frac{\\partial I_{C}}{\\partial V_{BE}}\\right)_{T} (-\\theta) \\frac{1}{\\left(\\frac{\\partial I_{C}}{\\partial T}\\right)_{V_{BE}}} = -1 $$\nSolving for the desired partial derivative gives:\n$$ \\left(\\frac{\\partial I_{C}}{\\partial T}\\right)_{V_{BE}} = \\theta \\left(\\frac{\\partial I_{C}}{\\partial V_{BE}}\\right)_{T} $$\nThe term $\\left(\\frac{\\partial I_{C}}{\\partial V_{BE}}\\right)_{T}$ is the local slope of the $I_C$-$V_{BE}$ characteristic at the operating point, which is the transconductance $g_m$.\n\n$4$. The feedback-induced change in collector current, $\\delta I_{C,fb}$, is therefore:\n$$ \\delta I_{C,fb} = \\left(\\frac{\\partial I_{C}}{\\partial T}\\right)_{V_{BE}} \\delta T = \\left( \\theta \\left.\\frac{\\partial I_{C}}{\\partial V_{BE}}\\right|_{Q} \\right) \\delta T $$\nSubstituting the expression for $\\delta T$ from step $2$:\n$$ \\delta I_{C,fb} = \\left( \\theta \\left.\\frac{\\partial I_{C}}{\\partial V_{BE}}\\right|_{Q} \\right) (Z_{th}(\\tau) V_{CE} \\delta I_{C}) $$\n\n$5$. The net small-signal thermal loop gain, $G_{th}$, is the ratio of the feedback response to the initial perturbation, $G_{th} = \\frac{\\delta I_{C,fb}}{\\delta I_{C}}$:\n$$ G_{th} = V_{CE} Z_{th}(\\tau) \\theta \\left.\\frac{\\partial I_{C}}{\\partial V_{BE}}\\right|_{Q} $$\nFor the system to be stable, this positive feedback loop gain must be less than unity. If $G_{th} \\ge 1$, any perturbation will be amplified, leading to thermal runaway. Thus, the stability criterion is:\n$$ V_{CE} Z_{th}(\\tau) \\theta \\left.\\frac{\\partial I_{C}}{\\partial V_{BE}}\\right|_{Q} < 1 $$\n\n### Numerical Evaluation\n\nTo evaluate the design margin $m = 1 - G_{th}$, we first need to calculate the local slope $\\left.\\frac{\\partial I_{C}}{\\partial V_{BE}}\\right|_{Q}$. From the given collector current relation $I_{C} = I_{S}\\exp(V_{BE}/V_{T})$, we differentiate with respect to $V_{BE}$ at constant temperature $T$:\n$$ \\left.\\frac{\\partial I_{C}}{\\partial V_{BE}}\\right|_{Q} = \\frac{d}{dV_{BE}}\\left(I_{S}\\exp\\left(\\frac{V_{BE}}{V_{T}}\\right)\\right) = \\frac{1}{V_{T}} I_{S}\\exp\\left(\\frac{V_{BE}}{V_{T}}\\right) = \\frac{I_{C}}{V_{T}} $$\nThis is the transconductance $g_m$ at the operating point.\n\nFirst, we calculate the thermal voltage $V_T$ at the operating temperature $T = 350\\,\\mathrm{K}$:\n$$ V_{T} = \\frac{k_{B}T}{q} = \\frac{(1.380\\,649 \\times 10^{-23}\\,\\mathrm{J/K})(350\\,\\mathrm{K})}{1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}} \\approx 0.0301608\\,\\mathrm{V} $$\n\nNext, we calculate the transconductance $g_m$:\n$$ g_m = \\left.\\frac{\\partial I_{C}}{\\partial V_{BE}}\\right|_{Q} = \\frac{I_{C}}{V_{T}} = \\frac{20\\,\\mathrm{A}}{0.0301608\\,\\mathrm{V}} \\approx 663.100\\,\\mathrm{S} $$\n\nNow, we can calculate the thermal loop gain $G_{th}$ using the given operating conditions:\n$$ G_{th} = V_{CE} Z_{th}(\\tau) \\theta g_m $$\n$$ G_{th} = (3.5\\,\\mathrm{V}) \\times (1.5 \\times 10^{-2}\\,\\mathrm{K/W}) \\times (1.7 \\times 10^{-3}\\,\\mathrm{V/K}) \\times (663.100\\,\\mathrm{S}) $$\n$$ G_{th} = (3.5) \\times (0.015) \\times (0.0017) \\times (663.100) \\approx 0.0592036 $$\n\nFinally, the design margin $m$ is calculated:\n$$ m = 1 - G_{th} = 1 - 0.0592036 \\approx 0.9407964 $$\nRounding to four significant figures, the design margin is $0.9408$.",
            "answer": "$$\\boxed{0.9408}$$"
        },
        {
            "introduction": "While simple analytical models are useful, real-world power devices are complex, multi-cell structures where non-ideal effects like current crowding can dominate performance. This computational practice challenges you to build a numerical model of a multi-cell BJT to investigate this phenomenon directly . By simulating the current distribution across the emitter array, you will see how parasitic resistances lead to non-uniform operation and explore how layout strategies, such as Kelvin connections, can be designed to ensure device robustness.",
            "id": "3867066",
            "problem": "You are asked to construct and solve a one-dimensional multi-cell model of a power Bipolar Junction Transistor (BJT) emitter array that captures distributed base resistance and emitter resistance effects, along with per-cell base-emitter voltage variation, to quantify emitter current crowding and to evaluate Kelvin connection strategies that mitigate it.\n\nThe model and assumptions are as follows:\n\n- There are $N$ emitter cells, indexed by $i \\in \\{0,1,\\dots,N-1\\}$, laid out along a straight line. Each cell has a local base node at voltage $v_{b,i}$ and a local emitter node at voltage $v_{e,i}$.\n- The base nodes are interconnected in a one-dimensional chain by resistors of resistance $R_b$ between neighboring nodes. Similarly, the emitter nodes are interconnected by resistors of resistance $R_e$ between neighboring nodes.\n- The base-emitter junction of each cell is modeled by the ideal Shockley diode equation at temperature $T$, with scale current $I_{S,i}$, so that the emitter current of cell $i$ is\n$$\nI_{e,i} \\;=\\; I_{S,i}\\,\\exp\\!\\left(\\frac{v_{b,i} - v_{e,i}}{V_T}\\right),\n$$\nwhere $V_T$ is the thermal voltage. The base current of cell $i$ is given by\n$$\nI_{b,i} \\;=\\; \\frac{I_{e,i}}{\\beta + 1},\n$$\nwhere $\\beta$ is the large-signal current gain.\n- Base-emitter variation is represented by per-cell scale currents $I_{S,i}$ defined by a deterministic base-emitter voltage offset pattern $\\Delta V_{BE,i}$ of half-range $A$ volts, mapped to scale current via\n$$\nI_{S,i} \\;=\\; I_S \\,\\exp\\!\\left(\\frac{\\Delta V_{BE,i}}{V_T}\\right), \\quad \\Delta V_{BE,i} \\;=\\; A\\,\\left(\\frac{2i}{N-1} - 1\\right).\n$$\nHere $I_S$ is the nominal scale current and $A$ controls the mismatch severity.\n- The base bus is driven at a supply voltage $V_B$ applied at one or both ends as ideal voltage sources (zero source impedance). The emitter bus is returned to ground at $0$ volts applied at one or both ends as ideal voltage sources. The four possible feed configurations used in the test suite are: base fed left end only, base fed both ends, emitter fed left end only, and emitter fed both ends. A feed at an end means the corresponding end node voltage is fixed (Dirichlet boundary condition).\n- All device operation is direct current (DC). Resistive interconnects follow Ohm’s law and all nodes obey Kirchhoff’s Current Law (KCL).\n\nFormulate and solve the nonlinear nodal equations that enforce KCL at every free (unfixed) base and emitter node. For a free base node $i$, the KCL equation is the sum of currents through adjacent resistors plus the current into the base-emitter junction:\n$$\n\\sum_{j \\in \\mathcal{N}_b(i)} \\frac{v_{b,i} - v_{b,j}}{R_b} \\;+\\; I_{b,i} \\;=\\; 0,\n$$\nwhere $\\mathcal{N}_b(i)$ are neighboring base nodes $j$ connected by a resistor; if a neighbor is a fixed-voltage node, treat $v_{b,j}$ as that fixed voltage. For a free emitter node $i$, the KCL equation is the sum of currents through adjacent emitter resistors minus the diode emitter current:\n$$\n\\sum_{j \\in \\mathcal{N}_e(i)} \\frac{v_{e,i} - v_{e,j}}{R_e} \\;-\\; I_{e,i} \\;=\\; 0,\n$$\nwith analogous handling for fixed-voltage emitter neighbors.\n\nYour program must:\n- Assemble and solve the $2M$ nonlinear equations for the $2M$ unknown node voltages, where $M$ is the number of free base nodes plus the number of free emitter nodes (nodes not fixed by the feed configuration).\n- Use a deterministic initial guess and a robust numerical method to converge to the DC solution.\n- After solving, compute the emitter current distribution $\\{I_{e,i}\\}$ and the current crowding factor, defined as\n$$\n\\kappa \\;=\\; \\frac{\\max_i I_{e,i}}{\\frac{1}{N}\\sum_{i=0}^{N-1} I_{e,i}}.\n$$\n\nTest Suite:\nImplement and solve the model for the following four test cases (each fully specified by parameters). All resistances are in $\\Omega$, all voltages in $\\mathrm{V}$, all currents in $\\mathrm{A}$, and temperature is implicitly absorbed into $V_T$ (so no explicit temperature unit is required). The thermal voltage $V_T$ must be used in volts. The mismatch half-range $A$ is in volts. For each test case, output only the current crowding factor $\\kappa$ as a floating-point number.\n\n- Case $1$ (single-ended feeds, crowding baseline):\n    - $N = 8$, $R_b = 10.0$, $R_e = 0.001$, $V_B = 0.75$, $\\beta = 50$, $V_T = 0.02585$, $I_S = 1.0\\times 10^{-15}$, $A = 0.003$.\n    - Base feed: left end only fixed at $V_B$; right end free.\n    - Emitter feed: left end only fixed at $0$; right end free.\n\n- Case $2$ (Kelvin base: dual base feeds):\n    - Same parameters as Case $1$, except base feed: both left and right ends fixed at $V_B$.\n\n- Case $3$ (Kelvin base and emitter: dual feeds on both buses):\n    - Same parameters as Case $1$, except base feed: both left and right ends fixed at $V_B$; emitter feed: both left and right ends fixed at $0$.\n\n- Case $4$ (low base resistance edge case):\n    - $N = 8$, $R_b = 0.05$, $R_e = 0.001$, $V_B = 0.75$, $\\beta = 50$, $V_T = 0.02585$, $I_S = 1.0\\times 10^{-15}$, $A = 0.003$.\n    - Base feed: left end only fixed at $V_B$; right end free.\n    - Emitter feed: left end only fixed at $0$; right end free.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$), where $result_k$ is the crowding factor $\\kappa$ for Case $k$ expressed as a floating-point number. No other text should be printed.",
            "solution": "The user-provided problem is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Model Structure**: A one-dimensional array of $N$ emitter cells, indexed $i \\in \\{0, 1, \\dots, N-1\\}$.\n- **Node Voltages**: Local base voltage $v_{b,i}$, local emitter voltage $v_{e,i}$.\n- **Interconnect Resistances**: Base-to-base resistance $R_b$, Emitter-to-emitter resistance $R_e$.\n- **Emitter Current**: The emitter current of cell $i$ is given by the Shockley diode equation: $I_{e,i} = I_{S,i} \\exp\\left(\\frac{v_{b,i} - v_{e,i}}{V_T}\\right)$, where $V_T$ is the thermal voltage.\n- **Base Current**: The base current of cell $i$ is $I_{b,i} = \\frac{I_{e,i}}{\\beta + 1}$, where $\\beta$ is the large-signal current gain.\n- **Mismatch Model**: Per-cell scale current is $I_{S,i} = I_S \\exp\\left(\\frac{\\Delta V_{BE,i}}{V_T}\\right)$, with nominal scale current $I_S$ and a linear base-emitter voltage offset pattern $\\Delta V_{BE,i} = A\\left(\\frac{2i}{N-1} - 1\\right)$, where $A$ is the mismatch half-range.\n- **Boundary Conditions**: The base bus is driven at $V_B$ and the emitter bus is returned to $0\\,\\mathrm{V}$. Four feed configurations are specified: (1) Base fed left, Emitter fed left; (2) Base fed both ends, Emitter fed left; (3) Base fed both ends, Emitter fed both ends. A feed at an end imposes a fixed voltage (Dirichlet boundary condition).\n- **Governing Equations (KCL)**:\n    - For a free base node $i$: $\\sum_{j \\in \\mathcal{N}_b(i)} \\frac{v_{b,i} - v_{b,j}}{R_b} + I_{b,i} = 0$.\n    - For a free emitter node $i$: $\\sum_{j \\in \\mathcal{N}_e(i)} \\frac{v_{e,i} - v_{e,j}}{R_e} - I_{e,i} = 0$.\n    ($\\mathcal{N}_b(i)$ and $\\mathcal{N}_e(i)$ are the sets of neighboring nodes connected by resistors).\n- **Target Metric**: Current crowding factor $\\kappa = \\frac{\\max_i I_{e,i}}{\\frac{1}{N}\\sum_{i=0}^{N-1} I_{e,i}}$.\n- **Test Cases**: Four cases are provided with specific parameters for $N, R_b, R_e, V_B, \\beta, V_T, I_S, A$ and specific feed configurations.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is well-grounded in semiconductor device physics and electrical circuit theory. It uses standard models: the Shockley equation for the B-E junction, Ohm's law for resistors, and Kirchhoff's Current Law for network analysis. The concept of current crowding from distributed resistance is a fundamental topic in power electronics. The model is a standard and valid simplification.\n- **Well-Posed**: The problem is formulated as a system of nonlinear algebraic equations derived from nodal analysis. For each specified feed configuration, the number of free (unknown) node voltages equals the number of KCL equations that can be written, resulting in a determined system. The physical nature of the problem, representing a resistive network with diodes, suggests a unique and stable DC solution exists for the given boundary conditions.\n- **Objective**: The problem is stated using precise mathematical formulas and quantitative parameters. The task is objective and computational.\n- **Conclusion**: The problem is free of scientific flaws, contradictions, ambiguities, or unrealistic assumptions. It is a well-posed, scientifically valid problem.\n\n### Step 3: Verdict and Action\n- **Verdict**: The problem is **valid**.\n- **Action**: Proceed with providing a reasoned solution.\n\n### Solution Derivation\n\nThe problem requires solving a system of nonlinear equations that describe the DC steady state of a multi-cell power BJT. The method of choice is nodal analysis, where the unknowns are the voltages at each node of the circuit.\n\n**1. System Formulation**\nThe circuit consists of two one-dimensional resistive ladders (the base bus and the emitter bus) coupled by $N$ nonlinear current sources (the base-emitter junctions). The primary unknowns are the node voltages $\\{v_{b,i}\\}$ and $\\{v_{e,i}\\}$ for all cells $i$ that are not fixed by a boundary condition. Let the full vector of cell voltages be $\\mathbf{v} = [v_{b,0}, \\dots, v_{b,N-1}, v_{e,0}, \\dots, v_{e,N-1}]^T$. The problem is to find the elements of $\\mathbf{v}$ that satisfy KCL at every free node.\n\nWe can define a vector function $\\mathbf{F}(\\mathbf{x})$ where $\\mathbf{x}$ is the vector of *unknown* node voltages, such that $\\mathbf{F}(\\mathbf{x}) = \\mathbf{0}$ represents the system of KCL equations.\n\n**2. KCL Equations**\nFor each free node, we write a KCL equation, which states that the sum of currents leaving the node is zero.\n\nFor a free **base node** $i$: The current leaving through the base-emitter junction is $I_{b,i}$. The currents leaving towards neighboring base nodes $j$ are $\\frac{v_{b,i} - v_{b,j}}{R_b}$.\nThe KCL equation is:\n$$\nF_{b,i}(\\mathbf{v}) = \\sum_{j \\in \\mathcal{N}_b(i)} \\frac{v_{b,i} - v_{b,j}}{R_b} + \\frac{I_{S,i}}{\\beta + 1} \\exp\\left(\\frac{v_{b,i} - v_{e,i}}{V_T}\\right) = 0\n$$\nThe set of neighbors $\\mathcal{N}_b(i)$ is $\\{i-1, i+1\\}$ for an internal node ($0 < i < N-1$), $\\{i-1\\}$ for a free right-end node ($i=N-1$), and $\\{i+1\\}$ for a free left-end node ($i=0$). If a neighbor is a boundary-conditioned node (e.g., $v_{b,0}=V_B$), its voltage is a constant in the equation.\n\nFor a free **emitter node** $i$: The current entering from the base-emitter junction is $I_{e,i}$. The currents leaving towards neighboring emitter nodes $j$ are $\\frac{v_{e,i} - v_{e,j}}{R_e}$.\nThe KCL equation is:\n$$\nF_{e,i}(\\mathbf{v}) = \\sum_{j \\in \\mathcal{N}_e(i)} \\frac{v_{e,i} - v_{e,j}}{R_e} - I_{S,i} \\exp\\left(\\frac{v_{b,i} - v_{e,i}}{V_T}\\right) = 0\n$$\nThe neighbor set $\\mathcal{N}_e(i)$ is defined analogously to the base case.\n\nThe collection of these equations for all free base and emitter nodes forms the system $\\mathbf{F}(\\mathbf{x}) = \\mathbf{0}$.\n\n**3. Numerical Solution Method**\nThis system of nonlinear equations is not solvable analytically due to the exponential terms. We must use a numerical root-finding algorithm. A robust choice is a quasi-Newton method, such as the one implemented in `scipy.optimize.root`. This iterative method requires an initial guess for the unknown voltages, $\\mathbf{x}_0$.\n\nA deterministic and physically reasonable initial guess is to assume ideal interconnects (zero voltage drop). This leads to:\n- Initial guess for any unknown base voltage $v_{b,i}$: $V_B$.\n- Initial guess for any unknown emitter voltage $v_{e,i}$: $0\\,\\mathrm{V}$.\nThis guess starts the solver in a state of strong forward bias for all junctions, which is a good starting point for convergence.\n\n**4. Implementation Strategy by Case**\nFor each test case, the procedure is as follows:\n1.  **Identify Free Nodes**: Based on the `'base feed'` and `'emitter feed'` configuration, determine which of the $2N$ total nodes are free (unknown) and which are fixed (known).\n2.  **Construct State Vector**: Create the vector of unknowns $\\mathbf{x}$ consisting of the voltages of the free nodes.\n3.  **Define Residual Function**: Implement a function `F(x)` that takes the vector of current guesses for the unknowns, reconstructs the complete set of node voltages $\\mathbf{v}$ (by combining $\\mathbf{x}$ with the fixed boundary values), calculates the KCL residual for each free node, and returns these residuals as a vector.\n4.  **Solve**: Use `scipy.optimize.root` with the residual function and the initial guess to find the solution vector $\\mathbf{x}^*$.\n5.  **Post-Process**: Reconstruct the final, complete voltage vectors $\\mathbf{v}_b^*$ and $\\mathbf{v}_e^*$ from $\\mathbf{x}^*$.\n6.  **Calculate Emitter Currents**: Use the final voltages to compute the emitter current for each cell $i=0, \\dots, N-1$ using the formula $I_{e,i} = I_{S,i} \\exp\\left(\\frac{v_{b,i}^* - v_{e,i}^*}{V_T}\\right)$. Note that the per-cell scale currents $I_{S,i}$ must be pre-calculated using the given mismatch model.\n7.  **Compute Crowding Factor**: Calculate the final metric $\\kappa = \\frac{\\max_i I_{e,i}}{\\text{mean}(I_{e,i})}$.\n\nThis structured approach ensures that the boundary conditions for each case are correctly applied and that the nonlinear system is solved robustly. The resulting current distribution reveals the extent of current crowding, and the factor $\\kappa$ quantifies it, allowing for a direct comparison between different feed strategies. For instance, comparing Case 1 (single-ended feed) and Case 2 (dual base feed) will demonstrate the effectiveness of a Kelvin base connection in mitigating voltage drops along the base bus and thus reducing current crowding.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve_bjt_model(N, Rb, Re, VB, beta, VT, IS, A, base_feed, emitter_feed):\n    \"\"\"\n    Solves the 1D multi-cell BJT model for node voltages and computes the\n    current crowding factor kappa.\n\n    Args:\n        N (int): Number of emitter cells.\n        Rb (float): Interconnect resistance between base nodes [Ohm].\n        Re (float): Interconnect resistance between emitter nodes [Ohm].\n        VB (float): Base supply voltage [V].\n        beta (float): Large-signal current gain.\n        VT (float): Thermal voltage [V].\n        IS (float): Nominal scale current [A].\n        A (float): Mismatch half-range [V].\n        base_feed (str): Base feed config ('left' or 'both').\n        emitter_feed (str): Emitter feed config ('left' or 'both').\n\n    Returns:\n        float: The current crowding factor kappa.\n    \"\"\"\n    # 1. Pre-computation and Setup\n    # Calculate per-cell scale currents based on mismatch model\n    i_indices = np.arange(N)\n    delta_VBE = A * (2 * i_indices / (N - 1) - 1) if N > 1 else np.zeros(1)\n    ISi_array = IS * np.exp(delta_VBE / VT)\n\n    # Determine free and fixed nodes\n    is_base_free = np.ones(N, dtype=bool)\n    is_emitter_free = np.ones(N, dtype=bool)\n\n    if base_feed == 'left':\n        is_base_free[0] = False\n    elif base_feed == 'both':\n        is_base_free[0] = False\n        if N > 1:\n            is_base_free[N - 1] = False\n\n    if emitter_feed == 'left':\n        is_emitter_free[0] = False\n    elif emitter_feed == 'both':\n        is_emitter_free[0] = False\n        if N > 1:\n            is_emitter_free[N - 1] = False\n\n    # Indices of free nodes\n    free_base_indices = np.where(is_base_free)[0]\n    free_emitter_indices = np.where(is_emitter_free)[0]\n    num_free_base = len(free_base_indices)\n    num_free_emitter = len(free_emitter_indices)\n    num_unknowns = num_free_base + num_free_emitter\n    \n    if num_unknowns == 0: # All nodes fixed\n        vb = np.full(N, VB)\n        ve = np.zeros(N)\n    else:\n        # 2. Define the residual function F(x) = 0\n        def residual_function(x):\n            residuals = np.zeros(num_unknowns)\n            \n            # Reconstruct the full voltage vectors from the unknown vector x\n            # and the fixed boundary conditions\n            vb = np.full(N, VB)\n            ve = np.zeros(N)\n            if num_free_base > 0:\n                vb[free_base_indices] = x[:num_free_base]\n            if num_free_emitter > 0:\n                ve[free_emitter_indices] = x[num_free_base:]\n\n            # Emitter currents based on current voltage guess\n            # Add a small epsilon to avoid ve > vb issues during iteration\n            vbe = vb - ve\n            Ie_array = ISi_array * np.exp(vbe / VT)\n\n            # KCL for free base nodes\n            for idx, i in enumerate(free_base_indices):\n                # Current into BE junction\n                current_sum = Ie_array[i] / (beta + 1.0)\n                # Current to left neighbor\n                if i > 0:\n                    current_sum += (vb[i] - vb[i - 1]) / Rb\n                # Current to right neighbor\n                if i < N - 1:\n                    current_sum += (vb[i] - vb[i + 1]) / Rb\n                residuals[idx] = current_sum\n\n            # KCL for free emitter nodes\n            for idx, i in enumerate(free_emitter_indices):\n                # Current from BE junction\n                current_sum = -Ie_array[i]\n                # Current to left neighbor\n                if i > 0:\n                    current_sum += (ve[i] - ve[i - 1]) / Re\n                # Current to right neighbor\n                if i < N - 1:\n                    current_sum += (ve[i] - ve[i + 1]) / Re\n                residuals[num_free_base + idx] = current_sum\n\n            return residuals\n\n        # 3. Initial Guess and Solve\n        x0_base = np.full(num_free_base, VB)\n        x0_emitter = np.zeros(num_free_emitter)\n        x0 = np.concatenate((x0_base, x0_emitter))\n\n        # Solve the system\n        sol = root(residual_function, x0, method='hybr')\n        if not sol.success:\n            raise RuntimeError(f\"Solver failed to converge: {sol.message}\")\n        x_sol = sol.x\n\n        # Reconstruct final voltages\n        vb = np.full(N, VB)\n        ve = np.zeros(N)\n        if num_free_base > 0:\n            vb[free_base_indices] = x_sol[:num_free_base]\n        if num_free_emitter > 0:\n            ve[free_emitter_indices] = x_sol[num_free_base:]\n\n    # 4. Post-processing: Calculate crowding factor\n    vbe = vb - ve\n    Ie_final = ISi_array * np.exp(vbe / VT)\n    \n    if np.mean(Ie_final) == 0:\n        return 1.0 # No current, so no crowding\n\n    kappa = np.max(Ie_final) / np.mean(Ie_final)\n    return kappa\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Test Suite Parameters\n    # (N, Rb, Re, VB, beta, VT, IS, A, base_feed, emitter_feed)\n    test_cases = [\n        (8, 10.0, 0.001, 0.75, 50, 0.02585, 1.0e-15, 0.003, 'left', 'left'),  # Case 1\n        (8, 10.0, 0.001, 0.75, 50, 0.02585, 1.0e-15, 0.003, 'both', 'left'),  # Case 2\n        (8, 10.0, 0.001, 0.75, 50, 0.02585, 1.0e-15, 0.003, 'both', 'both'),  # Case 3\n        (8, 0.05, 0.001, 0.75, 50, 0.02585, 1.0e-15, 0.003, 'left', 'left'),  # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        kappa = solve_bjt_model(*case)\n        results.append(kappa)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}