{
    "hands_on_practices": [
        {
            "introduction": "The foundation of digital control for power converters lies in accurately modeling their dynamic response to PWM inputs in the discrete-time domain. This exercise focuses on deriving the small-signal transfer function from duty cycle to inductor current for a buck converter operating in continuous conduction mode. Mastering this sampled-data modeling approach is essential for the analysis and design of high-performance digital feedback loops. ",
            "id": "3870752",
            "problem": "A pulse width modulation (PWM) buck converter operates in continuous conduction mode and is modeled with an ideal switch and diode, an inductor of inductance $L$, an output capacitor $C$, and a resistive load $R$. The converter is driven from a constant input source $v_{g}$ and switches at a fixed switching period $T_{s}$ with duty ratio sequence $d_{k}$ that is held constant over the $k$-th switching interval $[k T_{s}, (k+1) T_{s})$. The inductor current $i_{L}(t)$ is sampled just before the update of the duty ratio at $t=(k+1)T_{s}$, producing the discrete-time sequence $i_{L,k+1} \\equiv i_{L}((k+1)T_{s}^{-})$. Assume the output voltage $v_{o}(t)$ is approximately constant over each switching interval due to a large output capacitor.\n\nStarting from the inductor constitutive law and the piecewise-constant inductor voltage in a buck converter, derive the exact one-period sampled-data update mapping for $i_{L,k+1}$ in terms of $i_{L,k}$, $d_{k}$, and $v_{o}$ under the assumption of ideal switching and negligible inductor resistance. Linearize this mapping about a steady operating point with duty $D$ and output voltage $V$, and, under the approximation that the small-signal output-voltage perturbation over a period is negligible relative to the duty perturbation at the modulation frequency, obtain the discrete-time small-signal transfer function $G_{id}(z)$ from the duty perturbation $\\tilde{d}_{k}$ to the inductor-current perturbation $\\tilde{i}_{L,k+1}$.\n\nThen, for the specific converter and excitation below, evaluate the sinusoidal steady-state response magnitude and phase of the inductor current to a sinusoidal small-signal duty modulation by evaluating $G_{id}(z)$ on the unit circle at the modulation frequency. The converter parameters and operating point are:\n- Input voltage $v_{g} = 48\\,\\mathrm{V}$, inductance $L = 1\\,\\mathrm{mH}$, output capacitance $C = 1000\\,\\mu\\mathrm{F}$, load resistance $R = 6\\,\\Omega$.\n- Switching frequency $f_{s} = 50\\,\\mathrm{kHz}$, so $T_{s} = 1/f_{s}$.\n- Steady operating duty $D = 0.25$, yielding $V \\approx D\\,v_{g}$ in steady state under the stated idealizations.\n- Small-signal duty modulation $\\tilde{d}_{k} = \\hat{d}\\,\\sin(2\\pi f_{m}\\,k\\,T_{s})$ with modulation frequency $f_{m} = 1\\,\\mathrm{kHz}$ and amplitude $\\hat{d} = 0.02$.\n\nUsing your derived $G_{id}(z)$, predict the steady-state inductor-current ripple amplitude and its phase relative to the duty modulation at $f_{m}$, assuming the output-voltage small-signal variation over one switching period is negligible at $f_{m}$ given the large $C$ and the load. Express the phase in radians. As your final reported result, provide only the amplitude of the inductor-current ripple in amperes, rounded to four significant figures.",
            "solution": "The problem requires the derivation of a small-signal discrete-time transfer function for a PWM buck converter and its subsequent use to calculate the amplitude of the inductor current response to a sinusoidal duty cycle modulation.\n\nFirst, we validate the problem.\n\n**Step 1: Extract Givens**\n- **Model**: Ideal switch and diode, inductor $L$, capacitor $C$, resistor $R$.\n- **Operation**: Continuous conduction mode (CCM).\n- **Input**: Constant voltage source $v_{g}$.\n- **Control**: Fixed switching period $T_{s}$, duty ratio sequence $d_k$ constant over $[k T_{s}, (k+1) T_{s})$.\n- **Sampling**: Inductor current $i_{L}(t)$ is sampled at $t=(k+1)T_{s}^{-}$ to get $i_{L,k+1} \\equiv i_{L}((k+1)T_{s}^{-})$.\n- **Assumption 1**: Output voltage $v_{o}(t)$ is approximately constant over each switching interval.\n- **Assumption 2**: Ideal switching and negligible inductor resistance.\n- **Assumption 3 (for linearization)**: The small-signal output-voltage perturbation over a period is negligible relative to the duty perturbation at the modulation frequency.\n- **Parameters**:\n  - Input voltage $v_{g} = 48\\,\\mathrm{V}$\n  - Inductance $L = 1\\,\\mathrm{mH} = 1 \\times 10^{-3}\\,\\mathrm{H}$\n  - Capacitance $C = 1000\\,\\mu\\mathrm{F} = 1 \\times 10^{-3}\\,\\mathrm{F}$\n  - Load resistance $R = 6\\,\\Omega$\n  - Switching frequency $f_{s} = 50\\,\\mathrm{kHz}$, so $T_{s} = 1/f_{s} = 2 \\times 10^{-5}\\,\\mathrm{s}$\n  - Steady operating duty $D = 0.25$\n  - Steady output voltage $V \\approx D\\,v_{g}$\n  - Small-signal duty modulation $\\tilde{d}_{k} = \\hat{d}\\,\\sin(2\\pi f_{m}\\,k\\,T_{s})$\n  - Modulation frequency $f_{m} = 1\\,\\mathrm{kHz}$\n  - Modulation amplitude $\\hat{d} = 0.02$\n- **Required output**: Amplitude of the inductor-current ripple in amperes, rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes a standard buck converter and uses fundamental principles of power electronics and control theory (sampled-data modeling, linearization, small-signal analysis). The assumptions are standard for introductory analysis of such converters. The model is scientifically valid.\n- **Well-Posed**: The problem statement is clear, provides all necessary data, and requests a specific, calculable result. The steps are logically laid out, leading to a unique solution.\n- **Objective**: The language is technical and precise, with no subjective or ambiguous terms.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed with the solution.\n\n**Derivation of the Sampled-Data Update Mapping**\nThe inductor's behavior is described by its constitutive law, $v_{L}(t) = L \\frac{di_{L}(t)}{dt}$. Over a single switching period $T_s$, from $t=kT_s$ to $t=(k+1)T_s$, the change in inductor current is found by integrating the inductor voltage:\n$$ \\Delta i_{L,k} = i_{L}((k+1)T_s) - i_{L}(kT_s) = \\frac{1}{L} \\int_{kT_s}^{(k+1)T_s} v_L(\\tau) d\\tau $$\nIn a buck converter, the inductor voltage $v_L(t)$ is piecewise constant over the switching period. For the interval $[k T_{s}, (k+d_{k})T_{s})$, the switch is ON, and the inductor voltage is $v_{L}(t) = v_{g} - v_{o}(t)$. For the interval $[(k+d_{k})T_{s}, (k+1)T_{s})$, the switch is OFF, and the inductor voltage is $v_{L}(t) = -v_{o}(t)$.\n\nUnder the assumption that the output voltage $v_o(t)$ is approximately constant over the switching interval, let's denote it by $v_{o,k}$. The integral becomes:\n$$ L \\Delta i_{L,k} = \\int_{kT_s}^{(k+d_k)T_s} (v_g - v_{o,k}) d\\tau + \\int_{(k+d_k)T_s}^{(k+1)T_s} (-v_{o,k}) d\\tau $$\n$$ L (i_{L,k+1} - i_{L,k}) = (v_g - v_{o,k})d_k T_s + (-v_{o,k})(1-d_k)T_s $$\nSimplifying the right-hand side:\n$$ L (i_{L,k+1} - i_{L,k}) = (v_g d_k - v_{o,k} d_k - v_{o,k} + v_{o,k} d_k)T_s = (v_g d_k - v_{o,k})T_s $$\nThus, the exact one-period sampled-data update mapping is:\n$$ i_{L,k+1} = i_{L,k} + \\frac{T_s}{L} (v_g d_k - v_{o,k}) $$\n\n**Linearization and Small-Signal Transfer Function**\nWe linearize this mapping around a steady operating point $(D, I_L, V)$. We express each variable as a sum of its steady-state (DC) value and a small-signal (AC) perturbation:\n- $d_k = D + \\tilde{d}_k$\n- $i_{L,k} = I_L + \\tilde{i}_{L,k}$\n- $v_{o,k} = V + \\tilde{v}_{o,k}$\n\nSubstituting these into the update equation:\n$$ I_L + \\tilde{i}_{L,k+1} = (I_L + \\tilde{i}_{L,k}) + \\frac{T_s}{L} [v_g(D + \\tilde{d}_k) - (V + \\tilde{v}_{o,k})] $$\nThe steady-state (DC) terms must equate to zero on their own:\n$$ I_L = I_L + \\frac{T_s}{L} (v_g D - V) \\implies v_g D - V = 0 \\implies V = D v_g $$\nThis confirms the steady-state output voltage relation for an ideal buck converter.\n\nThe remaining terms form the small-signal model:\n$$ \\tilde{i}_{L,k+1} = \\tilde{i}_{L,k} + \\frac{T_s}{L} (v_g \\tilde{d}_k - \\tilde{v}_{o,k}) $$\nThe problem states to use the approximation that the small-signal output-voltage perturbation $\\tilde{v}_{o,k}$ is negligible for deriving the duty-to-current transfer function. Setting $\\tilde{v}_{o,k} \\approx 0$, we get:\n$$ \\tilde{i}_{L,k+1} = \\tilde{i}_{L,k} + \\frac{v_g T_s}{L} \\tilde{d}_k $$\nTo find the transfer function $G_{id}(z) = \\frac{\\tilde{I}_L(z)}{\\tilde{D}(z)}$, we take the Z-transform of this linear difference equation, where $\\tilde{I}_L(z) = \\mathcal{Z}\\{\\tilde{i}_{L,k}\\}$ and $\\tilde{D}(z) = \\mathcal{Z}\\{\\tilde{d}_k\\}$:\n$$ z \\tilde{I}_L(z) = \\tilde{I}_L(z) + \\frac{v_g T_s}{L} \\tilde{D}(z) $$\nRearranging to solve for the transfer function:\n$$ (z-1) \\tilde{I}_L(z) = \\frac{v_g T_s}{L} \\tilde{D}(z) $$\n$$ G_{id}(z) = \\frac{\\tilde{I}_L(z)}{\\tilde{D}(z)} = \\frac{v_g T_s / L}{z-1} $$\n\n**Evaluation of the Sinusoidal Steady-State Response**\nThe steady-state response of the inductor current to a sinusoidal duty modulation $\\tilde{d}_k = \\hat{d}\\,\\sin(\\omega_m k T_s)$ is found by evaluating the transfer function at $z = \\exp(j\\omega_m T_s)$, where $\\omega_m = 2\\pi f_m$. The resulting complex number $G_{id}(\\exp(j\\omega_m T_s))$ gives the gain and phase shift at that frequency. The amplitude of the inductor current response, $\\hat{i}_L$, is given by:\n$$ \\hat{i}_L = \\hat{d} \\cdot |G_{id}(\\exp(j\\omega_m T_s))| $$\nFirst, we compute the numerical values of the constants.\n- $k_{G} = \\frac{v_g T_s}{L} = \\frac{48 \\, \\mathrm{V} \\cdot (2 \\times 10^{-5}\\,\\mathrm{s})}{1 \\times 10^{-3}\\,\\mathrm{H}} = 0.96$\n- The complex exponential argument is $\\theta = \\omega_m T_s = 2\\pi f_m T_s = 2\\pi \\cdot (1 \\times 10^3\\,\\mathrm{Hz}) \\cdot (2 \\times 10^{-5}\\,\\mathrm{s}) = 0.04\\pi$ radians.\n\nNow we evaluate the magnitude of $G_{id}(z)$ at $z = \\exp(j0.04\\pi)$:\n$$ |G_{id}(\\exp(j0.04\\pi))| = \\left| \\frac{0.96}{\\exp(j0.04\\pi) - 1} \\right| = \\frac{0.96}{|\\cos(0.04\\pi) + j\\sin(0.04\\pi) - 1|} $$\n$$ |G_{id}| = \\frac{0.96}{|(\\cos(0.04\\pi) - 1) + j\\sin(0.04\\pi)|} = \\frac{0.96}{\\sqrt{(\\cos(0.04\\pi) - 1)^2 + \\sin^2(0.04\\pi)}} $$\nUsing the identity $\\sqrt{(\\cos\\theta - 1)^2 + \\sin^2\\theta} = \\sqrt{\\cos^2\\theta - 2\\cos\\theta + 1 + \\sin^2\\theta} = \\sqrt{2 - 2\\cos\\theta} = \\sqrt{2(2\\sin^2(\\theta/2))} = 2|\\sin(\\theta/2)|$. For $\\theta=0.04\\pi$, $\\theta/2 = 0.02\\pi$, which is in the first quadrant, so $\\sin(\\theta/2)$ is positive.\n$$ |G_{id}| = \\frac{0.96}{2\\sin(0.04\\pi/2)} = \\frac{0.96}{2\\sin(0.02\\pi)} $$\nNumerically:\n$$ \\sin(0.02\\pi) \\approx 0.0627905 $$\n$$ |G_{id}| \\approx \\frac{0.96}{2 \\cdot 0.0627905} = \\frac{0.96}{0.125581} \\approx 7.64448 $$\nThe amplitude of the inductor current ripple at the modulation frequency is:\n$$ \\hat{i}_L = \\hat{d} \\cdot |G_{id}| = 0.02 \\cdot 7.64448 \\approx 0.1528896\\,\\mathrm{A} $$\nRounding to four significant figures, the amplitude is $0.1529\\,\\mathrm{A}$.\n\nFor completeness, the phase of the response is:\n$$ \\angle G_{id} = \\angle(0.96) - \\angle(\\exp(j0.04\\pi) - 1) = 0 - \\arctan\\left(\\frac{\\sin(0.04\\pi)}{\\cos(0.04\\pi)-1}\\right) $$\nUsing the more robust identity $e^{j\\theta}-1 = 2\\sin(\\theta/2)e^{j(\\theta/2+\\pi/2)}$, the phase is:\n$$ \\angle G_{id} = \\angle\\left(\\frac{k_G}{2\\sin(\\theta/2)e^{j(\\theta/2+\\pi/2)}}\\right) = -\\left(\\frac{\\theta}{2} + \\frac{\\pi}{2}\\right) = -\\left(\\frac{0.04\\pi}{2} + \\frac{\\pi}{2}\\right) = -0.52\\pi \\approx -1.6336\\,\\mathrm{radians} $$\nThe current ripple lags the duty cycle modulation by approximately $1.6336$ radians. The question, however, only asks for the amplitude.",
            "answer": "$$\\boxed{0.1529}$$"
        },
        {
            "introduction": "Peak current-mode control is a powerful PWM strategy offering benefits like fast dynamic response and automatic overcurrent protection. However, it is prone to subharmonic oscillation, an instability rooted in its cycle-by-cycle decision-making process. This problem requires you to analyze these discrete-time dynamics from first principles to determine the stability boundary and derive the necessary slope compensation to ensure stable operation. ",
            "id": "3870693",
            "problem": "Consider a Continuous Conduction Mode (CCM) buck converter operating under peak current-mode control with fixed-frequency Pulse Width Modulation (PWM). Let the switching period be $T_{s}$, the inductor current rise (on-time) slope be $m_{1}>0$ and the magnitude of the inductor current fall (off-time) slope be $m_{2}>0$. A linear compensation ramp of slope $m_{a} \\geq 0$ (added to the sensed inductor current signal) is used during the on-time and reset every switching period. Assume ideal current sensing and an ideal comparator that terminates the switch on-time when the sum of the sensed inductor current and the compensation ramp equals a constant threshold $i_{\\mathrm{th}}$.\n\nStarting only from the physical triangular inductor current evolution under constant input and output voltages and the sample-and-hold nature of the PWM, perform the following:\n\n1. Derive the exact one-cycle mapping for the inductor valley current $i_{v}^{(n)}$ to $i_{v}^{(n+1)}$ in terms of $m_{1}$, $m_{2}$, $m_{a}$, $T_{s}$, and $i_{\\mathrm{th}}$, under the described peak current-mode modulation law.\n2. Linearize this mapping about a steady-state periodic solution and identify the sample-data eigenvalue $p$ governing the intrinsic subharmonic dynamics of the inner current loop.\n3. Using the condition $|p|<1$ for elimination of subharmonic oscillation, find the minimum compensation ramp slope that guarantees stability at the given operating point $(m_{1},m_{2})$.\n4. Show explicitly how the addition of the compensation ramp of slope $m_{a}$ modifies the effective small-signal duty-to-current conversion within the inner loop by deriving the linear relation between a small perturbation in the comparator threshold and the resulting perturbation in the valley current across one cycle, and identify the scaling that depends on $m_{a}$.\n\nExpress your final answer for the minimum required compensation ramp slope as a closed-form analytic expression in terms of $m_{1}$ and $m_{2}$. Use the unit ampere per second (A/s) for $m_{a}$. No numerical evaluation is required.",
            "solution": "The problem requires the analysis of a peak current-mode controlled buck converter. We are asked to derive its discrete-time dynamics, assess its stability, determine the minimum compensation ramp for stable operation, and analyze the effect of this ramp on the small-signal response. The analysis begins from first principles, considering the inductor current waveform over a single switching period, $T_s$.\n\nLet the $n$-th switching cycle begin at time $t=nT_s$. The inductor current at this instant is the valley current, denoted by $i_v^{(n)}$. The switch is turned on, and the inductor current increases with a constant slope $m_1$. The current at any time $t'$ within the on-interval, where $t' = t - nT_s$, is given by:\n$$i_L(t) = i_v^{(n)} + m_1 (t - nT_s)$$\nThe on-time, denoted by $d_n T_s$, is terminated when the sum of the sensed inductor current and the compensation ramp equals the threshold $i_{\\mathrm{th}}$. The compensation ramp signal is $m_a (t-nT_s)$. Thus, the switching condition at the end of the on-time, $t = nT_s + d_n T_s$, is:\n$$i_L(nT_s + d_n T_s) + m_a (d_n T_s) = i_{\\mathrm{th}}$$\nThe current at this instant is the peak current, $i_p^{(n)} = i_v^{(n)} + m_1 (d_n T_s)$. Substituting this into the switching condition yields:\n$$(i_v^{(n)} + m_1 d_n T_s) + m_a d_n T_s = i_{\\mathrm{th}}$$\nWe can solve for the on-time duration $d_n T_s$:\n$$(m_1 + m_a) d_n T_s = i_{\\mathrm{th}} - i_v^{(n)}$$\n$$d_n T_s = \\frac{i_{\\mathrm{th}} - i_v^{(n)}}{m_1 + m_a}$$\nDuring the off-time, which lasts for $(1-d_n)T_s$, the inductor current decreases with a slope of magnitude $m_2$. The valley current at the beginning of the next cycle, $i_v^{(n+1)}$, is found by subtracting the current drop from the peak current $i_p^{(n)}$:\n$$i_v^{(n+1)} = i_p^{(n)} - m_2 (T_s - d_n T_s)$$\nSubstituting the expression for the peak current, $i_p^{(n)} = i_v^{(n)} + m_1 d_n T_s$:\n$$i_v^{(n+1)} = (i_v^{(n)} + m_1 d_n T_s) - m_2 (T_s - d_n T_s) = i_v^{(n)} - m_2 T_s + (m_1 + m_2)d_n T_s$$\nNow, substituting the expression for $d_n T_s$:\n$$i_v^{(n+1)} = i_v^{(n)} - m_2 T_s + (m_1 + m_2) \\left( \\frac{i_{\\mathrm{th}} - i_v^{(n)}}{m_1 + m_a} \\right)$$\nRearranging the terms to find the mapping from $i_v^{(n)}$ to $i_v^{(n+1)}$ completes the first task.\n$$i_v^{(n+1)} = i_v^{(n)} \\left( 1 - \\frac{m_1 + m_2}{m_1 + m_a} \\right) + \\frac{m_1 + m_2}{m_1 + m_a} i_{\\mathrm{th}} - m_2 T_s$$\n$$i_v^{(n+1)} = i_v^{(n)} \\left( \\frac{m_1 + m_a - m_1 - m_2}{m_1 + m_a} \\right) + \\frac{m_1 + m_2}{m_1 + m_a} i_{\\mathrm{th}} - m_2 T_s$$\nThis yields the final one-cycle mapping:\n$$i_v^{(n+1)} = \\left( \\frac{m_a - m_2}{m_1 + m_a} \\right) i_v^{(n)} + \\frac{m_1 + m_2}{m_1 + m_a} i_{\\mathrm{th}} - m_2 T_s$$\n\nFor the second task, we linearize this map. Let the steady-state operating point be defined by $i_v^{(n)} = i_v^{(n+1)} = I_v$ and constant inputs and outputs. We introduce a small perturbation $\\hat{i}_v^{(n)}$ such that $i_v^{(n)} = I_v + \\hat{i}_v^{(n)}$. The derived map is already a linear first-order affine transformation. Thus, linearizing it involves simply finding the derivative of the mapping function with respect to $i_v^{(n)}$, which is the coefficient of the $i_v^{(n)}$ term.\nThe perturbation dynamics are given by:\n$$\\hat{i}_v^{(n+1)} = \\frac{\\partial i_v^{(n+1)}}{\\partial i_v^{(n)}} \\bigg|_{I_v} \\hat{i}_v^{(n)}$$\nThe sample-data eigenvalue $p$ governing the intrinsic dynamics is this derivative:\n$$p = \\frac{\\partial}{\\partial i_v^{(n)}} \\left[ \\left( \\frac{m_a - m_2}{m_1 + m_a} \\right) i_v^{(n)} + \\text{constant terms} \\right] = \\frac{m_a - m_2}{m_1 + m_a}$$\n\nFor the third task, we use the stability criterion for a discrete-time system, which requires the magnitude of the eigenvalue to be less than $1$, i.e., $|p| < 1$. This prevents the growth of perturbations, including subharmonic oscillations which correspond to an eigenvalue of $p=-1$.\n$$-1 < \\frac{m_a - m_2}{m_1 + m_a} < 1$$\nGiven $m_1 > 0$, $m_2 > 0$, and $m_a \\ge 0$, the denominator $m_1 + m_a$ is strictly positive. We can analyze the two inequalities separately.\nFirst, the right-hand side inequality:\n$$\\frac{m_a - m_2}{m_1 + m_a} < 1 \\implies m_a - m_2 < m_1 + m_a \\implies -m_2 < m_1 \\implies m_1 + m_2 > 0$$\nThis condition is always met since $m_1$ and $m_2$ are positive slopes.\nSecond, the left-hand side inequality, which is critical for preventing period-doubling bifurcation (subharmonic oscillation):\n$$-1 < \\frac{m_a - m_2}{m_1 + m_a} \\implies -(m_1 + m_a) < m_a - m_2 \\implies -m_1 - m_a < m_a - m_2$$\n$$m_2 - m_1 < 2 m_a \\implies m_a > \\frac{m_2 - m_1}{2}$$\nThis is the condition on the compensation ramp slope $m_a$ to guarantee stability. The problem asks for the minimum required slope. If $m_2 \\le m_1$, then $\\frac{m_2 - m_1}{2} \\le 0$. Since the problem states $m_a \\ge 0$, any physically allowable compensation ramp, including $m_a = 0$, satisfies the stability condition. Thus, the minimum required slope in this case is $0$. If $m_2 > m_1$, a positive compensation slope is required, and the minimum value that guarantees stability is the boundary value $\\frac{m_2 - m_1}{2}$. Combining both cases, the minimum required non-negative slope $m_{a, \\text{min}}$ is:\n$$m_{a, \\text{min}} = \\max\\left(0, \\frac{m_2 - m_1}{2}\\right)$$\nThe expression for the final answer will be based on this result.\n\nFor the fourth task, we analyze the effect of a small perturbation in the threshold, $\\hat{i}_{\\mathrm{th}}$, on the valley current. We return to the full discrete-time map and introduce perturbations for both $i_v$ and $i_{\\mathrm{th}}$: $i_v^{(n)} = I_v + \\hat{i}_v^{(n)}$ and $i_{\\mathrm{th}}^{(n)} = I_{\\mathrm{th}} + \\hat{i}_{\\mathrm{th}}^{(n)}$, where $I_v$ and $I_{\\mathrm{th}}$ are the steady-state values.\n$$I_v + \\hat{i}_v^{(n+1)} = \\left( \\frac{m_a - m_2}{m_1 + m_a} \\right) (I_v + \\hat{i}_v^{(n)}) + \\frac{m_1 + m_2}{m_1 + m_a} (I_{\\mathrm{th}} + \\hat{i}_{\\mathrm{th}}^{(n)}) - m_2 T_s$$\nThe steady-state terms cancel out, leaving the small-signal dynamic equation:\n$$\\hat{i}_v^{(n+1)} = \\left( \\frac{m_a - m_2}{m_1 + m_a} \\right) \\hat{i}_v^{(n)} + \\left( \\frac{m_1 + m_2}{m_1 + m_a} \\right) \\hat{i}_{\\mathrm{th}}^{(n)}$$\nThe question asks for the linear relation for the resulting perturbation in valley current across one cycle from a perturbation in the threshold. This corresponds to the case where the system starts in steady state, so $\\hat{i}_v^{(n)} = 0$. The resulting perturbation in the next valley current is:\n$$\\hat{i}_v^{(n+1)} = \\left( \\frac{m_1 + m_2}{m_1 + m_a} \\right) \\hat{i}_{\\mathrm{th}}^{(n)}$$\nThis is the linear relation. The scaling factor that depends on $m_a$ is the term multiplying $\\hat{i}_{\\mathrm{th}}^{(n)}$:\n$$G_{\\mathrm{th}} = \\frac{m_1 + m_2}{m_1 + m_a}$$\nThis shows that the addition of the compensation ramp (increasing $m_a$ from $0$) reduces the gain from the control reference ($i_{\\mathrm{th}}$) to the state variable ($i_v$). This is an important trade-off: increasing $m_a$ improves stability at the cost of reducing the dynamic response of the current loop.\n\nThe final answer requested is the minimum required compensation ramp slope. Based on the analysis for the third task, this is $\\max(0, \\frac{m_2-m_1}{2})$.",
            "answer": "$$\\boxed{\\max\\left(0, \\frac{m_2-m_1}{2}\\right)}$$"
        },
        {
            "introduction": "In the digital implementation of PWM controllers, duty cycle commands are inevitably quantized due to the finite resolution of hardware timers. This practice explores how this quantization introduces a bounded error that can induce small, persistent oscillations known as limit cycles. You will derive a rigorous upper bound on the amplitude of these limit cycles, providing a crucial analytical tool for assessing the steady-state precision of a digitally controlled converter. ",
            "id": "3870766",
            "problem": "Consider a Single-Input Single-Output (SISO) averaged model of a pulse-width modulated step-down converter controlled by a digital loop. The Pulse Width Modulation (PWM) command is implemented by a timer with a finite count per period, leading to quantization of the duty cycle. Let the normalized output deviation be denoted by $x(t)$, which is dimensionless by construction. Assume the small-signal continuous-time averaged plant is first-order and given by the linear time-invariant differential equation\n$$\n\\dot{x}(t) = -\\alpha\\,x(t) + \\beta\\,d(t),\n$$\nwhere $d(t)$ is the duty cycle, $\\alpha > 0$ is the closed-loop pole of the passive output network when the switch is held fixed, and $\\beta > 0$ is the small-signal gain from the duty cycle to the normalized output deviation. The controller updates once per switching period $T_s$ and applies a Zero-Order Hold (ZOH) on $d(t)$. The controller computes the unquantized duty command at discrete times $t_k = k T_s$ as\n$$\nu[k] = -K\\,x[k] + d_0,\n$$\nwith $K > 0$ the proportional feedback gain, $d_0$ the constant feedforward chosen so that $x[k] = 0$ is an equilibrium in the absence of quantization, and $x[k] = x(t_k)$. The PWM timer has $N \\in \\mathbb{N}$ counts per period, so the applied duty cycle at each sample is quantized to a multiple of the step size $\\Delta_d = 1/N$ by round-to-nearest,\n$$\nd[k] = Q(u[k]),\n$$\nand the quantization error $\\eta[k] = d[k] - u[k]$ satisfies $\\eta[k] \\in [-\\Delta_d/2,\\,\\Delta_d/2]$ for all $k$. Assume the closed-loop design satisfies $|\\lambda| < 1$, where $\\lambda$ is the closed-loop coefficient to be defined by the discretization of the plant and the controller action.\n\nStarting only from the given continuous-time plant, the ZOH assumption over $[t_k, t_{k+1})$, and the bounded round-to-nearest quantization property above, derive a rigorous upper bound on the amplitude of any steady-state quantization-induced limit cycle in the normalized output deviation $x[k]$ (after transients have decayed), expressed purely in terms of $\\alpha$, $\\beta$, $K$, $T_s$, and $N$. Your derivation must proceed from first principles by solving the continuous-time plant over one sampling interval, forming the exact discrete-time update with ZOH, composing it with the controller and the quantization error, and then bounding the steady-state response to the bounded quantization error sequence. Express the final bound as a single closed-form analytic expression. Because $x[k]$ is dimensionless by construction, no physical units are required. Do not insert numerical values, and do not round; provide the bound as an exact symbolic expression.",
            "solution": "The problem statement is evaluated to be valid as it is scientifically grounded in established principles of linear systems and digital control theory, is well-posed, objective, and self-contained. The provided information is sufficient and consistent for deriving the requested bound. We may therefore proceed with the solution.\n\nThe objective is to find a rigorous upper bound on the amplitude of steady-state limit cycles in the normalized output deviation $x[k]$. We begin by finding the exact discrete-time representation of the continuous-time plant under a zero-order hold (ZOH) assumption.\n\nThe continuous-time plant is described by the linear time-invariant (LTI) differential equation:\n$$\n\\dot{x}(t) = -\\alpha\\,x(t) + \\beta\\,d(t)\n$$\nTo solve this equation over a single sampling interval $[t_k, t_{k+1})$, where $t_k = k T_s$, we recognize that the ZOH implies the duty cycle $d(t)$ is constant and equal to its value at the beginning of the interval, $d[k]$. Thus, for $t \\in [t_k, t_{k+1})$, we have $d(t) = d[k]$.\n\nThe solution to the first-order linear ODE $\\dot{x} + ax = b$ with initial condition $x(t_0)$ is $x(t) = x(t_0) e^{-a(t-t_0)} + \\frac{b}{a}(1-e^{-a(t-t_0)})$. Applying this standard form to our plant with $a=\\alpha$, $b=\\beta d[k]$, and the initial time $t_0=t_k$, we get the solution for $x(t)$ at any time $t \\in [t_k, t_{k+1})$:\n$$\nx(t) = x(t_k) \\exp(-\\alpha(t-t_k)) + \\frac{\\beta d[k]}{\\alpha} (1 - \\exp(-\\alpha(t-t_k)))\n$$\nWe are interested in the value of $x$ at the next sampling instant, $t_{k+1} = t_k + T_s$. Substituting $t=t_{k+1}$ into the equation gives:\n$$\nx(t_{k+1}) = x(t_k) \\exp(-\\alpha T_s) + \\frac{\\beta}{\\alpha} (1 - \\exp(-\\alpha T_s)) d[k]\n$$\nUsing the discrete-time notation $x[k] = x(t_k)$, we obtain the exact discrete-time model:\n$$\nx[k+1] = \\Phi x[k] + \\Gamma d[k]\n$$\nwhere the discrete-time system parameters are:\n$$\n\\Phi = \\exp(-\\alpha T_s)\n$$\n$$\n\\Gamma = \\frac{\\beta}{\\alpha} (1 - \\exp(-\\alpha T_s))\n$$\nSince $\\alpha > 0$, $\\beta > 0$, and $T_s > 0$, it follows that $0 < \\Phi < 1$ and $\\Gamma > 0$.\n\nNext, we incorporate the digital controller and the quantization process. The unquantized control command is $u[k] = -K x[k] + d_0$. The problem states that $x[k]=0$ is an equilibrium for the unquantized system. For this to hold, if $x[k]=x[k+1]=0$, the discrete-time system becomes $0 = \\Phi(0) + \\Gamma(-K(0) + d_0)$, which simplifies to $\\Gamma d_0 = 0$. Since $\\Gamma > 0$, this implies $d_0 = 0$. Thus, the control law is simply $u[k] = -K x[k]$.\n\nThe duty cycle applied to the plant, $d[k]$, is the quantized version of $u[k]$. This relationship can be expressed by introducing the quantization error $\\eta[k]$:\n$$\nd[k] = Q(u[k]) = u[k] + \\eta[k] = -K x[k] + \\eta[k]\n$$\nThe problem specifies round-to-nearest quantization with a step size of $\\Delta_d = 1/N$. The quantization error is therefore bounded:\n$$\n|\\eta[k]| \\le \\frac{\\Delta_d}{2} = \\frac{1}{2N}\n$$\nSubstituting the expression for $d[k]$ into the discrete-time plant model yields the closed-loop system dynamics:\n$$\nx[k+1] = \\Phi x[k] + \\Gamma (-K x[k] + \\eta[k])\n$$\n$$\nx[k+1] = (\\Phi - K\\Gamma) x[k] + \\Gamma \\eta[k]\n$$\nLet us define the closed-loop pole as $\\lambda = \\Phi - K\\Gamma$. The system dynamics are then given by the linear difference equation with a bounded disturbance:\n$$\nx[k+1] = \\lambda x[k] + \\Gamma \\eta[k]\n$$\nThe problem assumes the design is stable, i.e., $|\\lambda| < 1$. The solution to this difference equation can be found by recursion, resulting in the convolution sum:\n$$\nx[k] = \\lambda^k x[0] + \\sum_{j=0}^{k-1} \\lambda^{k-1-j} \\Gamma \\eta[j]\n$$\nAs $k \\to \\infty$, the first term, representing the transient response, decays to zero because $|\\lambda|<1$. The remaining part is the steady-state response, which describes the limit cycle behavior driven by the quantization error sequence. For a sufficiently large $k$, the state $x[k]$ is well-approximated by the forced response:\n$$\nx_{ss}[k] = \\sum_{j=0}^{\\infty} \\lambda^j \\Gamma \\eta[k-1-j]\n$$\nWe seek an upper bound on the amplitude of this steady-state response, $\\max_k |x_{ss}[k]|$. We take the absolute value and apply the triangle inequality:\n$$\n|x_{ss}[k]| = \\left| \\Gamma \\sum_{j=0}^{\\infty} \\lambda^j \\eta[k-1-j] \\right| = \\Gamma \\left| \\sum_{j=0}^{\\infty} \\lambda^j \\eta[k-1-j] \\right| \\le \\Gamma \\sum_{j=0}^{\\infty} |\\lambda^j| |\\eta[k-1-j]|\n$$\n(We used the fact that $\\Gamma > 0$, so $|\\Gamma| = \\Gamma$). Now, we use the bound on the quantization error, $|\\eta[\\cdot]| \\le 1/(2N)$:\n$$\n|x_{ss}[k]| \\le \\Gamma \\sum_{j=0}^{\\infty} |\\lambda|^j \\left( \\frac{1}{2N} \\right) = \\frac{\\Gamma}{2N} \\sum_{j=0}^{\\infty} |\\lambda|^j\n$$\nThe summation is a geometric series. Since $|\\lambda| < 1$, the series converges:\n$$\n\\sum_{j=0}^{\\infty} |\\lambda|^j = \\frac{1}{1 - |\\lambda|}\n$$\nSubstituting this result back gives the upper bound for the steady-state amplitude of $x[k]$:\n$$\n\\max_k |x_{ss}[k]| \\le \\frac{\\Gamma}{2N(1 - |\\lambda|)}\n$$\nFinally, we substitute the expressions for $\\Gamma$ and $\\lambda$:\n$$\n\\Gamma = \\frac{\\beta}{\\alpha} (1 - \\exp(-\\alpha T_s))\n$$\n$$\n\\lambda = \\exp(-\\alpha T_s) - K \\Gamma = \\exp(-\\alpha T_s) - K \\frac{\\beta}{\\alpha} (1 - \\exp(-\\alpha T_s))\n$$\nThe upper bound, which we shall denote $X_{max\\_bound}$, is therefore:\n$$\nX_{max\\_bound} = \\frac{\\frac{\\beta}{\\alpha}(1 - \\exp(-\\alpha T_s))}{2N \\left(1 - \\left| \\exp(-\\alpha T_s) - K \\frac{\\beta}{\\alpha}(1 - \\exp(-\\alpha T_s)) \\right| \\right)}\n$$\nThis expression can be written in a slightly more compact form by multiplying the numerator and denominator by $\\alpha$:\n$$\nX_{max\\_bound} = \\frac{\\beta(1 - \\exp(-\\alpha T_s))}{2N \\alpha \\left(1 - \\left| \\exp(-\\alpha T_s) - K \\frac{\\beta}{\\alpha}(1 - \\exp(-\\alpha T_s)) \\right| \\right)}\n$$\nThis is the rigorous upper bound on the limit cycle amplitude, expressed solely in terms of the given system parameters.",
            "answer": "$$\n\\boxed{\\frac{\\beta(1 - \\exp(-\\alpha T_s))}{2N \\alpha \\left(1 - \\left| \\exp(-\\alpha T_s) - K \\frac{\\beta}{\\alpha}(1 - \\exp(-\\alpha T_s)) \\right| \\right)}}\n$$"
        }
    ]
}