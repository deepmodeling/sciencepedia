{
    "hands_on_practices": [
        {
            "introduction": "At the heart of the SIMPLE algorithm lies the pressure-correction step, which iteratively enforces mass conservation. This exercise provides a direct, hands-on calculation of how a computed pressure correction field, $p'$, adjusts the mass fluxes across the faces of a control volume. By working through this fundamental example, you will solidify your understanding of how the algorithm drives the continuity residual towards zero.",
            "id": "3994181",
            "problem": "Consider a two-dimensional, steady, incompressible flow of constant density on a uniform Cartesian grid within the framework of the Semi-Implicit Method for Pressure-Linked Equations (SIMPLE) family of algorithms in Computational Fluid Dynamics (CFD). Focus on one interior control volume centered at cell $P$ with neighbors $E$, $W$, $N$, and $S$. Adopt the sign convention that each face mass flux $\\dot{m}_{f}$ is defined as positive when directed outward from cell $P$ through face $f \\in \\{E,W,N,S\\}$. The incompressible steady continuity requirement for cell $P$ is that the sum of outward face mass fluxes must vanish.\n\nIn a pressure-correction step, the face mass fluxes are updated according to\n$$\n\\dot{m}_{f}^{\\text{new}} \\;=\\; \\dot{m}_{f}^{\\text{old}} \\;+\\; d_{f}\\,\\bigl(p_{P}' - p_{N(f)}'\\bigr),\n$$\nwhere $p'$ denotes the pressure correction at a cell center, $N(f)$ is the neighbor cell associated with face $f$, and $d_{f}$ is a known positive coefficient obtained from the discretized momentum equation on a uniform grid.\n\nYou are given the following data for the sample cell $P$:\n- Old outward mass fluxes: $\\dot{m}_{E}^{\\text{old}} = 2.2 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$, $\\dot{m}_{W}^{\\text{old}} = -1.0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$, $\\dot{m}_{N}^{\\text{old}} = -0.6 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$, $\\dot{m}_{S}^{\\text{old}} = 0.1 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$.\n- Uniform face coefficients: $d_{E} = d_{W} = d_{N} = d_{S} = 1.0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1}$.\n- Pressure corrections at cell centers: $p_{P}' = 0 \\ \\mathrm{Pa}$ and $p_{E}' = p_{W}' = p_{N}' = p_{S}' = 0.175 \\ \\mathrm{Pa}$.\n\nTasks:\n- Using only the governing requirement of steady incompressible continuity and the given flux-correction relation, compute the corrected face mass fluxes $\\dot{m}_{f}^{\\text{new}}$ for $f \\in \\{E,W,N,S\\}$ and verify that the local mass balance is satisfied for cell $P$ on this uniform grid.\n- Finally, report the net mass imbalance\n$$\nR_{P}^{\\text{new}} \\;=\\; \\dot{m}_{E}^{\\text{new}} \\;+\\; \\dot{m}_{W}^{\\text{new}} \\;+\\; \\dot{m}_{N}^{\\text{new}} \\;+\\; \\dot{m}_{S}^{\\text{new}}\n$$\nas a single number.\n\nExpress the final answer for $R_{P}^{\\text{new}}$ in $\\mathrm{kg}\\,\\mathrm{s}^{-1}$. No rounding is required.",
            "solution": "The problem is validated as sound. It is a well-posed, self-contained computational exercise grounded in the standard principles of the SIMPLE algorithm for Computational Fluid Dynamics (CFD). All provided data are scientifically consistent and sufficient for a unique solution.\n\nThe primary task is to compute the corrected mass fluxes for a control volume $P$ and then determine the resulting net mass imbalance, or continuity residual, $R_{P}^{\\text{new}}$. The framework is that of a pressure-correction step in a steady, incompressible flow simulation.\n\nThe correction of the mass flux $\\dot{m}_{f}$ through each face $f$ of the control volume is given by the relation:\n$$\n\\dot{m}_{f}^{\\text{new}} = \\dot{m}_{f}^{\\text{old}} + d_{f}(p_{P}' - p_{N(f)}')\n$$\nwhere $\\dot{m}_{f}^{\\text{new}}$ is the corrected mass flux, $\\dot{m}_{f}^{\\text{old}}$ is the mass flux from the previous iteration, $p_{P}'$ is the pressure correction at the center of the cell $P$, $p_{N(f)}'$ is the pressure correction at the center of the neighbor cell $N(f)$ sharing face $f$, and $d_{f}$ is a known coefficient derived from the discretized momentum equation.\n\nThe given data for the control volume $P$ and its neighbors $E$, $W$, $N$, and $S$ are:\n- Old outward mass fluxes:\n  $\\dot{m}_{E}^{\\text{old}} = 2.2 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$\n  $\\dot{m}_{W}^{\\text{old}} = -1.0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$\n  $\\dot{m}_{N}^{\\text{old}} = -0.6 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$\n  $\\dot{m}_{S}^{\\text{old}} = 0.1 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$\n- Face coefficients: $d_{E} = d_{W} = d_{N} = d_{S} = 1.0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1}$\n- Pressure corrections:\n  $p_{P}' = 0 \\ \\mathrm{Pa}$\n  $p_{E}' = p_{W}' = p_{N}' = p_{S}' = 0.175 \\ \\mathrm{Pa}$\n\nFirst, we compute the corrected mass flux for each face of the control volume $P$.\n\nFor the east face, $f=E$, the neighbor cell is $N(E) = E$.\n$$\n\\dot{m}_{E}^{\\text{new}} = \\dot{m}_{E}^{\\text{old}} + d_{E}(p_{P}' - p_{E}') = 2.2 + 1.0 \\times (0 - 0.175) = 2.2 - 0.175 = 2.025 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\n\nFor the west face, $f=W$, the neighbor cell is $N(W) = W$.\n$$\n\\dot{m}_{W}^{\\text{new}} = \\dot{m}_{W}^{\\text{old}} + d_{W}(p_{P}' - p_{W}') = -1.0 + 1.0 \\times (0 - 0.175) = -1.0 - 0.175 = -1.175 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\n\nFor the north face, $f=N$, the neighbor cell is $N(N) = N$.\n$$\n\\dot{m}_{N}^{\\text{new}} = \\dot{m}_{N}^{\\text{old}} + d_{N}(p_{P}' - p_{N}') = -0.6 + 1.0 \\times (0 - 0.175) = -0.6 - 0.175 = -0.775 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\n\nFor the south face, $f=S$, the neighbor cell is $N(S) = S$.\n$$\n\\dot{m}_{S}^{\\text{new}} = \\dot{m}_{S}^{\\text{old}} + d_{S}(p_{P}' - p_{S}') = 0.1 + 1.0 \\times (0 - 0.175) = 0.1 - 0.175 = -0.075 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\n\nThe problem requires a verification that the local mass balance is satisfied. This is achieved by calculating the net mass imbalance, $R_{P}^{\\text{new}}$, which is the sum of all outward corrected mass fluxes from cell $P$. According to the steady incompressible continuity equation, this sum must be zero for the mass to be conserved.\n$$\nR_{P}^{\\text{new}} = \\dot{m}_{E}^{\\text{new}} + \\dot{m}_{W}^{\\text{new}} + \\dot{m}_{N}^{\\text{new}} + \\dot{m}_{S}^{\\text{new}}\n$$\nSubstituting the computed values:\n$$\nR_{P}^{\\text{new}} = 2.025 + (-1.175) + (-0.775) + (-0.075)\n$$\n$$\nR_{P}^{\\text{new}} = 2.025 - 1.175 - 0.775 - 0.075\n$$\n$$\nR_{P}^{\\text{new}} = 2.025 - (1.175 + 0.775 + 0.075) = 2.025 - (1.950 + 0.075) = 2.025 - 2.025\n$$\n$$\nR_{P}^{\\text{new}} = 0\n$$\nThe result $R_{P}^{\\text{new}} = 0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$ verifies that the pressure-correction step, using the given pressure correction values, has successfully enforced local mass conservation for the control volume $P$. The final task is to report this value.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "While powerful, pressure-correction schemes on collocated grids can suffer from numerical instabilities if not implemented carefully. This practice delves into the classic \"checkerboard\" pressure instability, a numerical artifact that the SIMPLE algorithm must overcome. Through a linear mode analysis, you will derive the amplification factor for this spurious mode, providing a rigorous explanation for why specialized techniques like Rhie-Chow interpolation are indispensable in modern CFD codes.",
            "id": "3994170",
            "problem": "Consider a one-dimensional, steady, incompressible flow of constant density $\\rho$ in a duct of length $L$ and constant cross-sectional area $A$. The spatial domain is discretized using a uniform collocated grid of $N$ control volumes with spacing $\\Delta x = L/N$. Pressure and velocity are stored at the cell centers. In the Semi-Implicit Method for Pressure-Linked Equations (SIMPLE) algorithm, the predictor velocity $u_{i}^{*}$ is corrected using the pressure correction $p_{i}^{\\prime}$ via the linearized discrete momentum correction\n$$\nu_{i}^{(k+1)} \\;=\\; u_{i}^{*} \\;-\\; d\\,\\frac{p_{i+1}^{\\prime\\,(k)} - p_{i-1}^{\\prime\\,(k)}}{2\\,\\Delta x},\n$$\nwhere $d>0$ is the local velocity–pressure coupling coefficient that results from the discretized momentum equation, $i$ is the cell index, and $k$ is the SIMPLE iteration index. Face velocities are computed without Rhie–Chow interpolation, using simple averaging,\n$$\nu_{i+\\frac{1}{2}}^{(k+1)} \\;=\\; \\frac{u_{i}^{(k+1)} + u_{i+1}^{(k+1)}}{2}.\n$$\nThe discrete continuity equation in each cell enforces zero net mass flux,\n$$\n\\rho\\,A\\left(u_{i+\\frac{1}{2}}^{(k+1)} - u_{i-\\frac{1}{2}}^{(k+1)}\\right) \\;=\\; 0,\n$$\nwith periodic boundary conditions over the domain.\n\nStarting from the incompressible continuity equation and the above discrete relations, perform a linear mode analysis of the pressure correction update for the alternating (checkerboard) pressure mode\n$$\np_{i}^{\\prime\\,(k)} \\;=\\; \\hat{A}^{(k)}\\,(-1)^{i},\n$$\nwhere $\\hat{A}^{(k)}$ is the amplitude of the mode at iteration $k$. Derive the amplification factor $G$ defined by\n$$\nG \\;=\\; \\frac{\\hat{A}^{(k+1)}}{\\hat{A}^{(k)}}\n$$\nfor a single SIMPLE pressure-correction iteration on this collocated grid without Rhie–Chow interpolation. Assume uniform $d$ and neglect any effects beyond those explicitly stated. Then, evaluate $G$ for the representative grid spacing $\\Delta x = L/N$ with $L = 1\\,\\mathrm{m}$ and $N = 64$.\n\nProvide the exact value of $G$ (no rounding). Express the final answer as a dimensionless number. Do not include units in your final answer.",
            "solution": "The core of the SIMPLE algorithm involves solving a Poisson-like equation for the pressure correction, $p'$. This equation is derived by substituting the velocity correction formulas into the continuity equation. We begin by deriving this pressure correction equation from the given discrete relations.\n\nThe discrete continuity equation is given as:\n$$\n\\rho\\,A\\left(u_{i+\\frac{1}{2}}^{(k+1)} - u_{i-\\frac{1}{2}}^{(k+1)}\\right) = 0\n$$\nSince $\\rho$ and $A$ are non-zero constants, this simplifies to:\n$$\nu_{i+\\frac{1}{2}}^{(k+1)} - u_{i-\\frac{1}{2}}^{(k+1)} = 0\n$$\nThe face velocities are calculated by simple averaging of the cell-center velocities:\n$$\nu_{i+\\frac{1}{2}}^{(k+1)} = \\frac{u_{i}^{(k+1)} + u_{i+1}^{(k+1)}}{2} \\quad \\text{and} \\quad u_{i-\\frac{1}{2}}^{(k+1)} = \\frac{u_{i-1}^{(k+1)} + u_{i}^{(k+1)}}{2}\n$$\nSubstituting these into the continuity equation yields:\n$$\n\\frac{u_{i}^{(k+1)} + u_{i+1}^{(k+1)}}{2} - \\frac{u_{i-1}^{(k+1)} + u_{i}^{(k+1)}}{2} = 0\n$$\nThis simplifies to a centered difference form for the corrected velocities:\n$$\nu_{i+1}^{(k+1)} - u_{i-1}^{(k+1)} = 0\n$$\nThe problem states that the corrected velocities $u^{(k+1)}$ are obtained from the predictor velocities $u^*$ and the pressure correction $p'^{(k)}$ from the current SIMPLE iteration $k$:\n$$\nu_{j}^{(k+1)} = u_{j}^{*} - d\\,\\frac{p_{j+1}^{\\prime\\,(k)} - p_{j-1}^{\\prime\\,(k)}}{2\\,\\Delta x}\n$$\nNow, we substitute this velocity correction formula into the simplified continuity equation. For the terms $u_{i+1}^{(k+1)}$ and $u_{i-1}^{(k+1)}$, the index $j$ becomes $i+1$ and $i-1$, respectively:\n$$\n\\left( u_{i+1}^{*} - d\\,\\frac{p_{i+2}^{\\prime\\,(k)} - p_{i}^{\\prime\\,(k)}}{2\\,\\Delta x} \\right) - \\left( u_{i-1}^{*} - d\\,\\frac{p_{i}^{\\prime\\,(k)} - p_{i-2}^{\\prime\\,(k)}}{2\\,\\Delta x} \\right) = 0\n$$\nRearranging the terms to isolate the pressure correction field $p'^{(k)}$ on one side and the predictor velocity field $u^*$ on the other gives the discrete Poisson equation for the pressure correction:\n$$\nd\\,\\frac{p_{i+2}^{\\prime\\,(k)} - 2p_{i}^{\\prime\\,(k)} + p_{i-2}^{\\prime\\,(k)}}{2\\,\\Delta x} = u_{i+1}^{*} - u_{i-1}^{*}\n$$\nThis equation is solved at iteration $k$ to find $p'^{(k)}$. The right-hand side, involving the predictor velocities, acts as the source term, representing the local mass imbalance. The left-hand side is a discrete Laplacian operator, albeit with a stencil width of $4\\Delta x$ connecting nodes $i-2$, $i$, and $i+2$.\n\nThe critical feature of this operator is that it only couples grid points with the same parity (even indices with even indices, odd with odd). It is completely insensitive to any pressure field component that alternates in sign at every grid point—the checkerboard mode. To see this, let's substitute the checkerboard mode $p_{j}^{\\prime} = \\hat{A}\\,(-1)^{j}$ into the left-hand side of the pressure correction equation:\n$$\np_{i+2}^{\\prime} - 2p_{i}^{\\prime} + p_{i-2}^{\\prime} = \\hat{A}(-1)^{i+2} - 2\\hat{A}(-1)^{i} + \\hat{A}(-1)^{i-2}\n$$\nSince $(-1)^{i+2} = (-1)^i$ and $(-1)^{i-2} = (-1)^i$, the expression becomes:\n$$\n\\hat{A}(-1)^{i} - 2\\hat{A}(-1)^{i} + \\hat{A}(-1)^{i} = \\hat{A}(-1)^{i}(1-2+1) = 0\n$$\nThis demonstrates that the checkerboard mode is in the null space of the discrete pressure-Poisson operator. Consequently, the SIMPLE algorithm, as described, has no mechanism to control or damp this mode. If a checkerboard pressure field exists, it satisfies the homogeneous part of the pressure-correction equation and does not generate any velocity correction, as the discrete pressure gradient is also zero:\n$$\n\\frac{p_{i+1}^{\\prime} - p_{i-1}^{\\prime}}{2\\,\\Delta x} = \\frac{\\hat{A}(-1)^{i+1} - \\hat{A}(-1)^{i-1}}{2\\,\\Delta x} = \\frac{-\\hat{A}(-1)^{i} - (-\\hat{A}(-1)^{i})}{2\\,\\Delta x} = 0\n$$\nThe question asks for the amplification factor $G = \\hat{A}^{(k+1)}/\\hat{A}^{(k)}$. This factor describes how the amplitude of the checkerboard mode in the pressure correction field evolves from one SIMPLE iteration to the next. In a typical problem, the pressure correction field $p'$ is found by solving the Poisson equation iteratively. The phrase \"a single SIMPLE pressure-correction iteration\" is best interpreted as a single iteration of an iterative solver (like Jacobi or Gauss-Seidel) for the pressure-correction equation. Let's analyze the behavior of the checkerboard mode during such a solve.\n\nLet $m$ be the iteration index for the inner iterative solver for the pressure-correction equation at a fixed outer SIMPLE loop index $k$. A Jacobi-type iteration for the equation\n$$\np_{i+2}^{\\prime} - 2p_{i}^{\\prime} + p_{i-2}^{\\prime} = \\frac{2\\Delta x}{d}(u_{i+1}^* - u_{i-1}^*)\n$$\nis formulated by isolating the diagonal term $p_i'$:\n$$\np_{i}^{\\prime, (m+1)} = \\frac{1}{2}\\left(p_{i-2}^{\\prime, (m)} + p_{i+2}^{\\prime, (m)}\\right) - \\frac{\\Delta x}{d}(u_{i+1}^* - u_{i-1}^*)\n$$\nWe perform a linear mode analysis on the propagation of an error, $\\epsilon_i^{(m)}$, which has the form of the checkerboard mode: $\\epsilon_i^{(m)} = \\hat{A}^{(m)}(-1)^i$. The error propagates according to the homogeneous part of the iterative scheme:\n$$\n\\epsilon_{i}^{(m+1)} = \\frac{1}{2}\\left(\\epsilon_{i-2}^{(m)} + \\epsilon_{i+2}^{(m)}\\right)\n$$\nSubstituting the mode shape:\n$$\n\\hat{A}^{(m+1)}(-1)^i = \\frac{1}{2}\\left(\\hat{A}^{(m)}(-1)^{i-2} + \\hat{A}^{(m)}(-1)^{i+2}\\right)\n$$\nUsing the identity $(-1)^{i \\pm 2} = (-1)^i$:\n$$\n\\hat{A}^{(m+1)}(-1)^i = \\frac{1}{2}\\left(\\hat{A}^{(m)}(-1)^{i} + \\hat{A}^{(m)}(-1)^{i}\\right) = \\hat{A}^{(m)}(-1)^{i}\n$$\nThis gives $\\hat{A}^{(m+1)} = \\hat{A}^{(m)}$. The amplification factor for the error from one inner iteration to the next is $1$. This means that a checkerboard error, once present, is not damped by the iterative solver; it persists indefinitely. We can equate the evolution of the mode across one such iteration step with the evolution from a global SIMPLE step $k$ to $k+1$, as this numerical error is not corrected by any other part of the algorithm. Therefore, $\\hat{A}^{(k+1)} = \\hat{A}^{(k)}$.\n\nThe amplification factor is:\n$$\nG = \\frac{\\hat{A}^{(k+1)}}{\\hat{A}^{(k)}} = 1\n$$\nAn amplification factor of $1$ means the spurious checkerboard mode is neither amplified nor damped, leading to the persistence of non-physical oscillations in the pressure field. This is the classic failure mode of a collocated grid scheme that the Rhie-Chow interpolation was invented to fix.\n\nThe given values $L = 1\\,\\mathrm{m}$ and $N = 64$ are not needed for this derivation, as the result is independent of the grid spacing or domain size.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "The convergence of any iterative solver depends on carefully chosen numerical parameters, and the SIMPLE algorithm is no exception. This exercise isolates the role of under-relaxation factors, which are crucial for stabilizing the segregated solution procedure and controlling its convergence rate. By analyzing a simplified one-dimensional model, you will gain practical insight into the delicate interplay between pressure ($\\alpha_p$) and velocity ($\\alpha_u$) under-relaxation and its impact on residual decay.",
            "id": "3994235",
            "problem": "Consider a one-dimensional steady incompressible flow patch represented by a single control volume in a finite-volume discretization used in Aerospace Computational Fluid Dynamics (CFD). The Semi-Implicit Method for Pressure-Linked Equations (SIMPLE) couples the pressure and velocity fields through a segregated procedure based on the discretized momentum and continuity equations. For the control volume, suppose the discretized streamwise momentum equation takes the linear form\n$$\na_u\\, u = h - d\\, p,\n$$\nwhere $a_u > 0$ is the central momentum coefficient, $d > 0$ is the pressure-gradient coupling coefficient, $h$ is the aggregated neighbor and source contribution, $u$ is the control-volume velocity, and $p$ is the control-volume pressure. The continuity for this control volume requires zero net mass flux, which here reduces to a vanishing velocity target,\n$$\nu = 0.\n$$\nIn SIMPLE, one computes a predicted velocity $u^{*}$ by holding the pressure at its current iterate $p^{(k)}$ fixed and solving the momentum equation; then one enforces continuity by introducing a pressure correction $p'$ that induces a velocity correction through the momentum equation linearization. With standard linearization, the velocity correction induced by the pressure correction is\n$$\nu^{\\text{corr}} = u^{*} - \\frac{d}{a_u}\\, p'.\n$$\nLocal continuity is recovered by imposing $u^{\\text{corr}} = 0$ in this one-degree-of-freedom patch. Under-relaxation is applied at the level of the updated variables,\n$$\np^{(k+1)} = p^{(k)} + \\alpha_p\\, p' \\quad \\text{and} \\quad u^{(k+1)} = u^{(k)} + \\alpha_u \\left(u^{\\text{corr}} - u^{(k)}\\right),\n$$\nwith prescribed relaxation factors $\\alpha_p \\in (0,1]$ and $\\alpha_u \\in (0,1]$. To quantify the iterative decay, define the coupled residual vector at iterate $k$,\n$$\nr^{(k)} := \\begin{pmatrix} r_m^{(k)} \\\\ r_c^{(k)} \\end{pmatrix} = \\begin{pmatrix} a_u\\, u^{(k)} - d\\, p^{(k)} - h \\\\ u^{(k)} \\end{pmatrix},\n$$\nand the associated Euclidean norm\n$$\n\\|r^{(k)}\\|_2 = \\sqrt{\\left(r_m^{(k)}\\right)^2 + \\left(r_c^{(k)}\\right)^2}.\n$$\n\nGiven the coefficients and initial guesses\n$$\na_u = 4, \\quad d = 1.5, \\quad h = 2, \\quad u^{(0)} = 0.5, \\quad p^{(0)} = 1,\n$$\nperform two SIMPLE iterations ($k=0 \\rightarrow 1 \\rightarrow 2$) for two distinct under-relaxation settings:\n\nCase A: $\\alpha_u = 0.7$ and $\\alpha_p = 0.3$,\n\nCase B: $\\alpha_u = 0.3$ and $\\alpha_p = 0.7$.\n\nUsing the described procedure and the residual definition, compute the ratio\n$$\n\\rho := \\frac{\\|r^{(2)}\\|_{2,\\text{B}}}{\\|r^{(2)}\\|_{2,\\text{A}}},\n$$\nwhere $\\|r^{(2)}\\|_{2,\\text{A}}$ and $\\|r^{(2)}\\|_{2,\\text{B}}$ denote the residual norms after two iterations for Case A and Case B, respectively. Round your final ratio to four significant figures. No units are required for the final ratio.",
            "solution": "### Step 1: Define the Iterative Procedure\nThe iterative procedure for advancing from iterate $k$ to $k+1$ is as follows:\n1.  Solve the momentum equation for the predicted velocity $u^{*}$ using the current pressure $p^{(k)}$:\n    $$u^{*} = \\frac{h - d\\, p^{(k)}}{a_u}$$\n2.  The pressure correction $p'$ is found by enforcing the continuity condition $u^{\\text{corr}} = 0$ in the velocity correction formula:\n    $$0 = u^{*} - \\frac{d}{a_u}\\, p' \\implies p' = \\frac{a_u}{d} u^{*}$$\n3.  Update the pressure and velocity fields using the under-relaxation factors. The velocity update simplifies since $u^{\\text{corr}}=0$:\n    $$p^{(k+1)} = p^{(k)} + \\alpha_p\\, p'$$\n    $$u^{(k+1)} = u^{(k)} + \\alpha_u \\left(0 - u^{(k)}\\right) = (1 - \\alpha_u) u^{(k)}$$\n4.  Calculate the residuals at iterate $k+1$:\n    $$r_m^{(k+1)} = a_u\\, u^{(k+1)} - d\\, p^{(k+1)} - h$$\n    $$r_c^{(k+1)} = u^{(k+1)}$$\n5.  Calculate the Euclidean norm of the residual vector:\n    $$\\|r^{(k+1)}\\|_2 = \\sqrt{\\left(r_m^{(k+1)}\\right)^2 + \\left(r_c^{(k+1)}\\right)^2}$$\n\nThe given constants are $a_u = 4$, $d = 1.5$, $h = 2$.\nThe initial conditions are $u^{(0)} = 0.5$, $p^{(0)} = 1$.\n\n### Step 2: Case A Calculation ($\\alpha_u = 0.7$, $\\alpha_p = 0.3$)\n\n**Iteration 1 ($k=0 \\rightarrow 1$):**\n- Predicted velocity: $u^{*} = \\frac{2 - 1.5 \\times 1}{4} = \\frac{0.5}{4} = 0.125$.\n- Pressure correction: $p' = \\frac{4}{1.5} \\times 0.125 = \\frac{8}{3} \\times \\frac{1}{8} = \\frac{1}{3}$.\n- Updated pressure: $p^{(1)} = p^{(0)} + \\alpha_p\\, p' = 1 + 0.3 \\times \\frac{1}{3} = 1 + 0.1 = 1.1$.\n- Updated velocity: $u^{(1)} = (1 - \\alpha_u) u^{(0)} = (1 - 0.7) \\times 0.5 = 0.3 \\times 0.5 = 0.15$.\n\n**Iteration 2 ($k=1 \\rightarrow 2$):**\n- Predicted velocity: $u^{*} = \\frac{2 - 1.5 \\times p^{(1)}}{4} = \\frac{2 - 1.5 \\times 1.1}{4} = \\frac{2 - 1.65}{4} = \\frac{0.35}{4} = 0.0875$.\n- Pressure correction: $p' = \\frac{4}{1.5} \\times 0.0875 = \\frac{8}{3} \\times \\frac{7}{80} = \\frac{7}{30}$.\n- Updated pressure: $p_{\\text{A}}^{(2)} = p^{(1)} + \\alpha_p\\, p' = 1.1 + 0.3 \\times \\frac{7}{30} = 1.1 + 0.07 = 1.17$.\n- Updated velocity: $u_{\\text{A}}^{(2)} = (1 - \\alpha_u) u^{(1)} = (1 - 0.7) \\times 0.15 = 0.3 \\times 0.15 = 0.045$.\n\n**Residuals for Case A at $k=2$:**\n- Momentum residual: $r_{m,\\text{A}}^{(2)} = a_u u_{\\text{A}}^{(2)} - d p_{\\text{A}}^{(2)} - h = 4(0.045) - 1.5(1.17) - 2 = 0.18 - 1.755 - 2 = -3.575$.\n- Continuity residual: $r_{c,\\text{A}}^{(2)} = u_{\\text{A}}^{(2)} = 0.045$.\n- Residual norm: $\\|r^{(2)}\\|_{2,\\text{A}} = \\sqrt{(-3.575)^2 + (0.045)^2} = \\sqrt{12.780625 + 0.002025} = \\sqrt{12.78265}$.\n\n### Step 3: Case B Calculation ($\\alpha_u = 0.3$, $\\alpha_p = 0.7$)\n\n**Iteration 1 ($k=0 \\rightarrow 1$):**\n- Predicted velocity (same as Case A): $u^{*} = 0.125$.\n- Pressure correction (same as Case A): $p' = \\frac{1}{3}$.\n- Updated pressure: $p^{(1)} = p^{(0)} + \\alpha_p\\, p' = 1 + 0.7 \\times \\frac{1}{3} = 1 + \\frac{7}{30} = \\frac{37}{30}$.\n- Updated velocity: $u^{(1)} = (1 - \\alpha_u) u^{(0)} = (1 - 0.3) \\times 0.5 = 0.7 \\times 0.5 = 0.35$.\n\n**Iteration 2 ($k=1 \\rightarrow 2$):**\n- Predicted velocity: $u^{*} = \\frac{2 - 1.5 \\times p^{(1)}}{4} = \\frac{2 - 1.5 \\times (37/30)}{4} = \\frac{2 - (3/2) \\times (37/30)}{4} = \\frac{2 - 37/20}{4} = \\frac{(40-37)/20}{4} = \\frac{3/20}{4} = \\frac{3}{80} = 0.0375$.\n- Pressure correction: $p' = \\frac{4}{1.5} \\times 0.0375 = \\frac{8}{3} \\times \\frac{3}{80} = \\frac{1}{10} = 0.1$.\n- Updated pressure: $p_{\\text{B}}^{(2)} = p^{(1)} + \\alpha_p\\, p' = \\frac{37}{30} + 0.7 \\times 0.1 = \\frac{37}{30} + 0.07 = \\frac{37}{30} + \\frac{7}{100} = \\frac{370 + 21}{300} = \\frac{391}{300}$.\n- Updated velocity: $u_{\\text{B}}^{(2)} = (1 - \\alpha_u) u^{(1)} = (1 - 0.3) \\times 0.35 = 0.7 \\times 0.35 = 0.245$.\n\n**Residuals for Case B at $k=2$:**\n- Momentum residual: $r_{m,\\text{B}}^{(2)} = a_u u_{\\text{B}}^{(2)} - d p_{\\text{B}}^{(2)} - h = 4(0.245) - 1.5(\\frac{391}{300}) - 2 = 0.98 - \\frac{391}{200} - 2 = 0.98 - 1.955 - 2 = -2.975$.\n- Continuity residual: $r_{c,\\text{B}}^{(2)} = u_{\\text{B}}^{(2)} = 0.245$.\n- Residual norm: $\\|r^{(2)}\\|_{2,\\text{B}} = \\sqrt{(-2.975)^2 + (0.245)^2} = \\sqrt{8.850625 + 0.060025} = \\sqrt{8.91065}$.\n\n### Step 4: Final Ratio Calculation\nThe ratio $\\rho$ is computed as:\n$$\\rho = \\frac{\\|r^{(2)}\\|_{2,\\text{B}}}{\\|r^{(2)}\\|_{2,\\text{A}}} = \\frac{\\sqrt{8.91065}}{\\sqrt{12.78265}} = \\sqrt{\\frac{8.91065}{12.78265}} \\approx \\sqrt{0.6970719} \\approx 0.8349083$$\nRounding to four significant figures, the result is $0.8349$.",
            "answer": "$$\\boxed{0.8349}$$"
        }
    ]
}