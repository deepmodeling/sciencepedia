{
    "hands_on_practices": [
        {
            "introduction": "A key advantage of the staggered grid is its inherent accuracy for the pressure-velocity coupling terms. This first practice provides a rigorous method for quantifying that accuracy using the powerful tool of Taylor series analysis . By analytically deriving the leading-order truncation error for the discrete pressure gradient, you will formally confirm the scheme's second-order accuracy and understand how it depends on the grid spacing, $h$.",
            "id": "3996771",
            "problem": "Consider a two-dimensional incompressible flow on the periodic domain $\\Omega = [0, 2\\pi] \\times [0, 2\\pi]$ discretized with a uniform Cartesian grid of $N_{x} \\times N_{y}$ cells, where the spacings are $h_{x} = \\frac{2\\pi}{N_{x}}$ and $h_{y} = \\frac{2\\pi}{N_{y}}$. Use the Marker-and-Cell (MAC) formulation: pressure $p$ is stored at cell centers $(x_{i}, y_{j})$ and velocity components $(u, v)$ are stored at faces $(x_{i+1/2}, y_{j})$ and $(x_{i}, y_{j+1/2})$, respectively. A manufactured solution is specified by the velocity $\\mathbf{u}(x,y) = (-\\sin y, \\sin x)$ and pressure $p(x,y) = \\cos x \\cos y$. In the discrete momentum equation, the pressure gradient at faces is approximated by the centered differences\n$$G_{x}^{h}(x_{i+1/2}, y_{j}) = \\frac{p_{i+1,j} - p_{i,j}}{h_{x}}, \\quad G_{y}^{h}(x_{i}, y_{j+1/2}) = \\frac{p_{i,j+1} - p_{i,j}}{h_{y}},$$\nwhere $p_{i,j} = p(x_{i}, y_{j})$, $x_{i} = i h_{x}$, $y_{j} = j h_{y}$, and $x_{i+1/2} = x_{i} + \\frac{h_{x}}{2}$, $y_{j+1/2} = y_{j} + \\frac{h_{y}}{2}$. Starting from first principles in calculus and the definition of derivatives, derive the leading-order spatial truncation error fields at the faces by comparing $G_{x}^{h}$ and $G_{y}^{h}$ with the exact gradients $\\frac{\\partial p}{\\partial x}(x_{i+1/2}, y_{j})$ and $\\frac{\\partial p}{\\partial y}(x_{i}, y_{j+1/2})$. Then, over the entire domain $\\Omega$, compute the root-mean-square magnitude of the truncation error vector field to leading order, defined by\n$$\\mathrm{RMS} = \\left( \\frac{1}{|\\Omega|} \\iint_{\\Omega} \\left[ \\mathrm{TE}_{x}(x,y)^{2} + \\mathrm{TE}_{y}(x,y)^{2} \\right] \\, dx \\, dy \\right)^{1/2},$$\nwhere $|\\Omega| = 4\\pi^{2}$ and $\\mathrm{TE}_{x}$, $\\mathrm{TE}_{y}$ are the leading-order truncation error components at the corresponding face locations. Express your final answer as a closed-form analytic expression in terms of $h_{x}$ and $h_{y}$. No rounding is required.",
            "solution": "The problem requires the derivation of the leading-order spatial truncation error for a centered difference approximation of the pressure gradient on a staggered grid, followed by the computation of the root-mean-square (RMS) magnitude of this error over a periodic domain for a given manufactured solution.\n\nFirst, we derive the truncation error for the $x$-component of the pressure gradient, $G_{x}^{h}$. The truncation error, $\\mathrm{TE}_{x}$, at a face center location $(x_{i+1/2}, y_{j})$ is defined as the difference between the discrete approximation and the exact partial derivative:\n$$ \\mathrm{TE}_{x}(x_{i+1/2}, y_{j}) = G_{x}^{h}(x_{i+1/2}, y_{j}) - \\frac{\\partial p}{\\partial x}(x_{i+1/2}, y_{j}) $$\nThe discrete gradient is given by:\n$$ G_{x}^{h}(x_{i+1/2}, y_{j}) = \\frac{p_{i+1,j} - p_{i,j}}{h_{x}} = \\frac{p(x_{i+1}, y_{j}) - p(x_{i}, y_{j})}{h_{x}} $$\nTo analyze this expression, we use Taylor series expansions for $p(x_{i+1}, y_{j})$ and $p(x_{i}, y_{j})$ around the point $(x_{i+1/2}, y_{j})$. Let $x = x_{i+1/2}$ and $y = y_{j}$. The cell-centered pressure points are at $x_{i} = x - \\frac{h_{x}}{2}$ and $x_{i+1} = x + \\frac{h_{x}}{2}$. The expansions are:\n$$ p(x + \\frac{h_{x}}{2}, y) = p(x, y) + \\frac{h_{x}}{2} \\frac{\\partial p}{\\partial x} + \\frac{1}{2!} \\left(\\frac{h_{x}}{2}\\right)^{2} \\frac{\\partial^{2} p}{\\partial x^{2}} + \\frac{1}{3!} \\left(\\frac{h_{x}}{2}\\right)^{3} \\frac{\\partial^{3} p}{\\partial x^{3}} + \\mathcal{O}(h_{x}^{4}) $$\n$$ p(x - \\frac{h_{x}}{2}, y) = p(x, y) - \\frac{h_{x}}{2} \\frac{\\partial p}{\\partial x} + \\frac{1}{2!} \\left(\\frac{h_{x}}{2}\\right)^{2} \\frac{\\partial^{2} p}{\\partial x^{2}} - \\frac{1}{3!} \\left(\\frac{h_{x}}{2}\\right)^{3} \\frac{\\partial^{3} p}{\\partial x^{3}} + \\mathcal{O}(h_{x}^{4}) $$\nwhere all partial derivatives are evaluated at $(x, y)$. Substituting these into the expression for $G_{x}^{h}$:\n$$ G_{x}^{h}(x, y) = \\frac{1}{h_{x}} \\left[ \\left( p + \\frac{h_{x}}{2} \\frac{\\partial p}{\\partial x} + \\frac{h_{x}^{2}}{8} \\frac{\\partial^{2} p}{\\partial x^{2}} + \\frac{h_{x}^{3}}{48} \\frac{\\partial^{3} p}{\\partial x^{3}} \\right) - \\left( p - \\frac{h_{x}}{2} \\frac{\\partial p}{\\partial x} + \\frac{h_{x}^{2}}{8} \\frac{\\partial^{2} p}{\\partial x^{2}} - \\frac{h_{x}^{3}}{48} \\frac{\\partial^{3} p}{\\partial x^{3}} \\right) + \\mathcal{O}(h_{x}^{5}) \\right] $$\n$$ G_{x}^{h}(x, y) = \\frac{1}{h_{x}} \\left[ h_{x} \\frac{\\partial p}{\\partial x} + \\frac{h_{x}^{3}}{24} \\frac{\\partial^{3} p}{\\partial x^{3}} + \\mathcal{O}(h_{x}^{5}) \\right] = \\frac{\\partial p}{\\partial x}(x,y) + \\frac{h_{x}^{2}}{24} \\frac{\\partial^{3} p}{\\partial x^{3}}(x,y) + \\mathcal{O}(h_{x}^{4}) $$\nThe leading-order truncation error for the $x$-component is therefore:\n$$ \\mathrm{TE}_{x}(x, y) = \\frac{h_{x}^{2}}{24} \\frac{\\partial^{3} p}{\\partial x^{3}}(x, y) $$\nBy an identical argument for the $y$-component of the gradient, $G_{y}^{h}$, which is evaluated at $(x_{i}, y_{j+1/2})$, we expand $p$ around $(x_{i}, y_{j+1/2})$:\n$$ G_{y}^{h}(x_{i}, y_{j+1/2}) = \\frac{p_{i,j+1} - p_{i,j}}{h_{y}} = \\frac{\\partial p}{\\partial y}(x_{i}, y_{j+1/2}) + \\frac{h_{y}^{2}}{24} \\frac{\\partial^{3} p}{\\partial y^{3}}(x_{i}, y_{j+1/2}) + \\mathcal{O}(h_{y}^{4}) $$\nThe leading-order truncation error for the $y$-component is:\n$$ \\mathrm{TE}_{y}(x, y) = \\frac{h_{y}^{2}}{24} \\frac{\\partial^{3} p}{\\partial y^{3}}(x, y) $$\nNext, we evaluate these error fields for the given manufactured pressure solution $p(x,y) = \\cos x \\cos y$. We need the third-order partial derivatives:\n$$ \\frac{\\partial p}{\\partial x} = -\\sin x \\cos y \\quad \\implies \\quad \\frac{\\partial^{2} p}{\\partial x^{2}} = -\\cos x \\cos y \\quad \\implies \\quad \\frac{\\partial^{3} p}{\\partial x^{3}} = \\sin x \\cos y $$\n$$ \\frac{\\partial p}{\\partial y} = -\\cos x \\sin y \\quad \\implies \\quad \\frac{\\partial^{2} p}{\\partial y^{2}} = -\\cos x \\cos y \\quad \\implies \\quad \\frac{\\partial^{3} p}{\\partial y^{3}} = \\cos x \\sin y $$\nSubstituting these derivatives into the error expressions:\n$$ \\mathrm{TE}_{x}(x, y) = \\frac{h_{x}^{2}}{24} \\sin x \\cos y $$\n$$ \\mathrm{TE}_{y}(x, y) = \\frac{h_{y}^{2}}{24} \\cos x \\sin y $$\nNow, we compute the RMS magnitude of the truncation error vector field over the domain $\\Omega = [0, 2\\pi] \\times [0, 2\\pi]$. The RMS value is defined as:\n$$ \\mathrm{RMS} = \\left( \\frac{1}{|\\Omega|} \\iint_{\\Omega} \\left[ \\mathrm{TE}_{x}(x,y)^{2} + \\mathrm{TE}_{y}(x,y)^{2} \\right] \\, dx \\, dy \\right)^{1/2} $$\nwhere $|\\Omega| = (2\\pi)^{2} = 4\\pi^{2}$. We compute the integrand:\n$$ \\mathrm{TE}_{x}(x,y)^{2} + \\mathrm{TE}_{y}(x,y)^{2} = \\left(\\frac{h_{x}^{2}}{24}\\right)^{2} \\sin^{2} x \\cos^{2} y + \\left(\\frac{h_{y}^{2}}{24}\\right)^{2} \\cos^{2} x \\sin^{2} y $$\n$$ = \\frac{h_{x}^{4}}{576} \\sin^{2} x \\cos^{2} y + \\frac{h_{y}^{4}}{576} \\cos^{2} x \\sin^{2} y $$\nWe now integrate this expression over $\\Omega$:\n$$ I = \\iint_{\\Omega} \\left( \\frac{h_{x}^{4}}{576} \\sin^{2} x \\cos^{2} y + \\frac{h_{y}^{4}}{576} \\cos^{2} x \\sin^{2} y \\right) \\, dx \\, dy $$\nThe integral can be separated due to the nature of the functions:\n$$ I = \\frac{h_{x}^{4}}{576} \\left(\\int_{0}^{2\\pi} \\sin^{2} x \\, dx\\right) \\left(\\int_{0}^{2\\pi} \\cos^{2} y \\, dy\\right) + \\frac{h_{y}^{4}}{576} \\left(\\int_{0}^{2\\pi} \\cos^{2} x \\, dx\\right) \\left(\\int_{0}^{2\\pi} \\sin^{2} y \\, dy\\right) $$\nWe use the standard definite integrals:\n$$ \\int_{0}^{2\\pi} \\sin^{2} \\theta \\, d\\theta = \\int_{0}^{2\\pi} \\frac{1 - \\cos(2\\theta)}{2} \\, d\\theta = \\left[ \\frac{\\theta}{2} - \\frac{\\sin(2\\theta)}{4} \\right]_{0}^{2\\pi} = \\pi $$\n$$ \\int_{0}^{2\\pi} \\cos^{2} \\theta \\, d\\theta = \\int_{0}^{2\\pi} \\frac{1 + \\cos(2\\theta)}{2} \\, d\\theta = \\left[ \\frac{\\theta}{2} + \\frac{\\sin(2\\theta)}{4} \\right]_{0}^{2\\pi} = \\pi $$\nSubstituting these results back into the expression for $I$:\n$$ I = \\frac{h_{x}^{4}}{576} (\\pi)(\\pi) + \\frac{h_{y}^{4}}{576} (\\pi)(\\pi) = \\frac{\\pi^{2}}{576} (h_{x}^{4} + h_{y}^{4}) $$\nFinally, we calculate the RMS value:\n$$ \\mathrm{RMS} = \\left( \\frac{1}{4\\pi^{2}} \\cdot I \\right)^{1/2} = \\left( \\frac{1}{4\\pi^{2}} \\frac{\\pi^{2}}{576} (h_{x}^{4} + h_{y}^{4}) \\right)^{1/2} $$\n$$ \\mathrm{RMS} = \\left( \\frac{h_{x}^{4} + h_{y}^{4}}{4 \\times 576} \\right)^{1/2} = \\left( \\frac{h_{x}^{4} + h_{y}^{4}}{2304} \\right)^{1/2} $$\nSince $\\sqrt{2304} = \\sqrt{48^2} = 48$, the final expression is:\n$$ \\mathrm{RMS} = \\frac{\\sqrt{h_{x}^{4} + h_{y}^{4}}}{48} $$\nThis is the closed-form analytic expression for the leading-order RMS error in terms of $h_{x}$ and $h_{y}$.",
            "answer": "$$\\boxed{\\frac{\\sqrt{h_{x}^{4} + h_{y}^{4}}}{48}}$$"
        },
        {
            "introduction": "After analyzing the scheme's behavior in the domain interior, we address the critical challenge of implementing wall boundary conditions. This exercise demonstrates how the staggered placement of velocity components simplifies the enforcement of the no-slip condition in a way that preserves the scheme's overall accuracy . You will learn to use ghost cells to set the tangential velocity and see how the normal velocity is naturally handled, ensuring the discrete Laplacian remains second-order accurate right up to the wall.",
            "id": "3996801",
            "problem": "Consider an incompressible, steady, two-dimensional channel flow of height $H$ and length $L$, described by the incompressible Navier–Stokes equations. The channel walls are located at $y=0$ (bottom) and $y=H$ (top), and enforce the classical no-slip boundary condition, namely that both the tangential and normal velocity components vanish at the walls. The domain is discretized using a uniform Marker-and-Cell (MAC) arrangement for Computational Fluid Dynamics (CFD) with $N_{x}$ cells in the streamwise direction and $N_{y}$ cells in the wall-normal direction. Let the uniform spacings be $\\Delta x = L/N_{x}$ and $\\Delta y = H/N_{y}$. Pressure $p$ is stored at cell centers $(i,j)$ located at $(x_{i},y_{j})=\\left((i-\\tfrac{1}{2})\\Delta x,(j-\\tfrac{1}{2})\\Delta y\\right)$ for $i=1,\\dots,N_{x}$ and $j=1,\\dots,N_{y}$. The streamwise velocity $u$ is stored at vertical faces at $(i+\\tfrac{1}{2},j)$ with coordinates $\\left(x_{i+\\tfrac{1}{2}},y_{j}\\right)=\\left(i\\Delta x,(j-\\tfrac{1}{2})\\Delta y\\right)$ for $i=0,\\dots,N_{x}$ and $j=1,\\dots,N_{y}$. The wall-normal velocity $v$ is stored at horizontal faces at $(i,j+\\tfrac{1}{2})$ with coordinates $\\left(x_{i},y_{j+\\tfrac{1}{2}}\\right)=\\left((i-\\tfrac{1}{2})\\Delta x,j\\Delta y\\right)$ for $i=1,\\dots,N_{x}$ and $j=0,\\dots,N_{y}$. To form second-order central-difference viscous terms near the walls in the discrete Laplacian, define ghost $u$-face indices $j=0$ below the bottom wall at $y=-\\tfrac{1}{2}\\Delta y$ and $j=N_{y}+1$ above the top wall at $y=H+\\tfrac{1}{2}\\Delta y$; for $v$, the boundary faces at $j=0$ and $j=N_{y}$ lie exactly on the walls at $y=0$ and $y=H$.\n\nStarting from the no-slip and no-penetration conditions derived from fundamental continuum mechanics ($u=0$ and $v=0$ at solid boundaries) and the MAC placement described above, do the following:\n\n- Derive the ghost-face values $u_{i+\\tfrac{1}{2},0}$ and $u_{i+\\tfrac{1}{2},N_{y}+1}$ that must be imposed adjacent to the bottom and top walls to ensure that the discrete wall-normal second derivative of $u$ at the first interior $u$-faces (at $y=\\tfrac{1}{2}\\Delta y$ near the bottom and $y=H-\\tfrac{1}{2}\\Delta y$ near the top) remains second-order accurate.\n\n- State the wall-face values $v_{i,0}$ and $v_{i,N_{y}}$ that enforce no penetration at the walls.\n\n- Let $u(y)$ be a smooth wall-parallel velocity profile satisfying $u(0)=0$ near the bottom wall. Using Taylor expansions and without introducing any shortcut formulas, analyze the discrete wall-normal Laplacian stencil for $u$ at the first interior $u$-face adjacent to the bottom wall, \n$$\n\\left.\\frac{\\partial^{2}u}{\\partial y^{2}}\\right|_{y=\\tfrac{1}{2}\\Delta y}\n\\approx \\frac{u_{i+\\tfrac{1}{2},2}-2u_{i+\\tfrac{1}{2},1}+u_{i+\\tfrac{1}{2},0}}{\\Delta y^{2}},\n$$\nand provide the explicit leading-order truncation error term as a closed-form expression in terms of $\\Delta y$ and derivatives of $u$ evaluated at $y=\\tfrac{1}{2}\\Delta y$.\n\nExpress your final answer as a single row matrix containing, in order, the four face values $u_{i+\\tfrac{1}{2},0}$, $u_{i+\\tfrac{1}{2},N_{y}+1}$, $v_{i,0}$, $v_{i,N_{y}}$, and the leading-order truncation error term for the discrete wall-normal Laplacian of $u$ at $y=\\tfrac{1}{2}\\Delta y$. No numerical evaluation is required. If any approximation is used, provide it as an exact symbolic expression. No units are required. If you choose to compute any intermediate numerical values, round the final answer to four significant figures; otherwise provide exact expressions.",
            "solution": "The solution requires deriving the ghost-cell values for the streamwise velocity $u$, the boundary values for the wall-normal velocity $v$, and the leading-order truncation error for the discrete Laplacian of $u$ near a wall.\n\n**1. Ghost-Face Values for Streamwise Velocity ($u$)**\n\nThe no-slip boundary condition requires the tangential velocity component, $u$, to be zero at the walls, i.e., $u(y=0)=0$ and $u(y=H)=0$. A second-order accurate enforcement of this Dirichlet boundary condition is achieved by linear interpolation.\n\n*   **Bottom Wall ($y=0$):**\nThe wall at $y=0$ is located exactly halfway between the first interior $u$-velocity node, $u_{i+\\frac{1}{2},1}$, at location $y_1 = (1-\\frac{1}{2})\\Delta y = \\frac{1}{2}\\Delta y$, and the ghost-face node, $u_{i+\\frac{1}{2},0}$, at location $y_0 = (0-\\frac{1}{2})\\Delta y = -\\frac{1}{2}\\Delta y$.\nA second-order accurate approximation for the velocity at the wall is obtained by averaging the values at these two bracketing points:\n$$u(y=0) \\approx \\frac{u_{i+\\frac{1}{2},1} + u_{i+\\frac{1}{2},0}}{2}$$\nTo enforce the no-slip condition $u(y=0)=0$, we set this approximation to zero:\n$$\\frac{u_{i+\\frac{1}{2},1} + u_{i+\\frac{1}{2},0}}{2} = 0$$\nSolving for the ghost-face value $u_{i+\\frac{1}{2},0}$ yields:\n$$u_{i+\\frac{1}{2},0} = -u_{i+\\frac{1}{2},1}$$\nThis represents an anti-symmetric reflection of the velocity across the wall.\n\n*   **Top Wall ($y=H$):**\nSimilarly, the top wall at $y=H = N_y \\Delta y$ is located halfway between the last interior $u$-velocity node, $u_{i+\\frac{1}{2},N_y}$, at $y_{N_y} = (N_y-\\frac{1}{2})\\Delta y$, and the top ghost-face node, $u_{i+\\frac{1}{2},N_y+1}$, at $y_{N_y+1} = (N_y+1-\\frac{1}{2})\\Delta y = (N_y+\\frac{1}{2})\\Delta y$.\nThe interpolated velocity at the wall is:\n$$u(y=H) \\approx \\frac{u_{i+\\frac{1}{2},N_y} + u_{i+\\frac{1}{2},N_y+1}}{2}$$\nEnforcing the no-slip condition $u(y=H)=0$:\n$$\\frac{u_{i+\\frac{1}{2},N_y} + u_{i+\\frac{1}{2},N_y+1}}{2} = 0$$\nSolving for the ghost-face value $u_{i+\\frac{1}{2},N_y+1}$ gives:\n$$u_{i+\\frac{1}{2},N_y+1} = -u_{i+\\frac{1}{2},N_y}$$\n\n**2. Wall-Face Values for Wall-Normal Velocity ($v$)**\n\nThe no-slip condition also implies no penetration, meaning the wall-normal velocity component, $v$, must be zero at the walls: $v(y=0)=0$ and $v(y=H)=0$.\nAccording to the problem description, the $v$-velocity faces for indices $j=0$ and $j=N_y$ are located directly on the walls at $y=0$ and $y=H=N_y\\Delta y$, respectively.\nTherefore, the discrete velocities $v_{i,0}$ and $v_{i,N_y}$ represent the wall-normal velocity exactly at the wall locations. To enforce the no-penetration condition, we must set these values to zero for all $i$:\n$$v_{i,0} = 0$$\n$$v_{i,N_y} = 0$$\n\n**3. Truncation Error Analysis of the Discrete Laplacian**\n\nThe final task is to find the leading-order truncation error for the given central-difference approximation of the second derivative of $u$ with respect to $y$, evaluated at the first interior $u$-face, $y_1=\\frac{1}{2}\\Delta y$.\nThe truncation error $\\tau$ is defined as the difference between the discrete approximation and the exact derivative:\n$$\\tau = \\left( \\frac{u_{i+\\frac{1}{2},2}-2u_{i+\\frac{1}{2},1}+u_{i+\\frac{1}{2},0}}{\\Delta y^{2}} \\right) - \\left.\\frac{\\partial^{2}u}{\\partial y^{2}}\\right|_{y_1}$$\nTo perform the analysis, we use Taylor series expansions for the discrete velocity values around the point of interest, $y_1 = \\frac{1}{2}\\Delta y$. Let $u(y)$ be the smooth, continuous velocity profile. The discrete points correspond to $u_{i+\\frac{1}{2},1} = u(y_1)$, $u_{i+\\frac{1}{2},2} = u(y_1+\\Delta y)$, and we consider the ideal point value $u(y_1-\\Delta y)$ for the analysis.\nThe Taylor series expansions for $u(y_1+\\Delta y)$ and $u(y_1-\\Delta y)$ around $y_1$ are:\n$$u(y_1+\\Delta y) = u(y_1) + \\left.\\frac{\\partial u}{\\partial y}\\right|_{y_1}\\Delta y + \\left.\\frac{\\partial^{2} u}{\\partial y^{2}}\\right|_{y_1}\\frac{\\Delta y^{2}}{2!} + \\left.\\frac{\\partial^{3} u}{\\partial y^{3}}\\right|_{y_1}\\frac{\\Delta y^{3}}{3!} + \\left.\\frac{\\partial^{4} u}{\\partial y^{4}}\\right|_{y_1}\\frac{\\Delta y^{4}}{4!} + \\mathcal{O}(\\Delta y^{5})$$\n$$u(y_1-\\Delta y) = u(y_1) - \\left.\\frac{\\partial u}{\\partial y}\\right|_{y_1}\\Delta y + \\left.\\frac{\\partial^{2} u}{\\partial y^{2}}\\right|_{y_1}\\frac{\\Delta y^{2}}{2!} - \\left.\\frac{\\partial^{3} u}{\\partial y^{3}}\\right|_{y_1}\\frac{\\Delta y^{3}}{3!} + \\left.\\frac{\\partial^{4} u}{\\partial y^{4}}\\right|_{y_1}\\frac{\\Delta y^{4}}{4!} - \\mathcal{O}(\\Delta y^{5})$$\nSubstituting these into the numerator of the discrete Laplacian:\n$$u(y_1+\\Delta y) - 2u(y_1) + u(y_1-\\Delta y) = \\left.\\frac{\\partial^{2} u}{\\partial y^{2}}\\right|_{y_1} \\Delta y^{2} + \\left.\\frac{\\partial^{4} u}{\\partial y^{4}}\\right|_{y_1} \\frac{\\Delta y^{4}}{12} + \\mathcal{O}(\\Delta y^{6})$$\nNow, we divide by $\\Delta y^{2}$ to get the full expression for the discrete operator:\n$$\\frac{u(y_1+\\Delta y)-2u(y_1)+u(y_1-\\Delta y)}{\\Delta y^{2}} = \\left.\\frac{\\partial^{2} u}{\\partial y^{2}}\\right|_{y_1} + \\left.\\frac{\\partial^{4} u}{\\partial y^{4}}\\right|_{y_1} \\frac{\\Delta y^{2}}{12} + \\mathcal{O}(\\Delta y^{4})$$\nThe truncation error is the difference between this expression and the exact derivative:\n$$\\tau = \\left(\\left.\\frac{\\partial^{2} u}{\\partial y^{2}}\\right|_{y_1} + \\left.\\frac{\\partial^{4} u}{\\partial y^{4}}\\right|_{y_1} \\frac{\\Delta y^{2}}{12} + \\mathcal{O}(\\Delta y^{4})\\right) - \\left.\\frac{\\partial^{2} u}{\\partial y^{2}}\\right|_{y_1}$$\n$$\\tau = \\left.\\frac{\\partial^{4} u}{\\partial y^{4}}\\right|_{y_1} \\frac{\\Delta y^{2}}{12} + \\mathcal{O}(\\Delta y^{4})$$\nThe leading-order truncation error term is the first term in this series, expressed in terms of $\\Delta y$ and a derivative of $u$ evaluated at $y=\\frac{1}{2}\\Delta y$:\n$$\\text{Leading-order TE} = \\frac{\\Delta y^{2}}{12} \\left.\\frac{\\partial^{4} u}{\\partial y^{4}}\\right|_{y=\\frac{1}{2}\\Delta y}$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-u_{i+\\frac{1}{2},1} & -u_{i+\\frac{1}{2},N_{y}} & 0 & 0 & \\frac{\\Delta y^2}{12} \\left.\\frac{\\partial^4 u}{\\partial y^4}\\right|_{y=\\frac{1}{2}\\Delta y}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A spatially accurate scheme is useless if it is not temporally stable. This final practice moves from spatial discretization to the dynamics of a time-marching simulation by tackling the crucial concept of the Courant-Friedrichs-Lewy (CFL) stability constraint . You will derive the multi-dimensional CFL condition for explicit advection on a MAC grid and apply it to a practical scenario, learning how to calculate the maximum allowable time step, $\\Delta t$, based on the flow velocity and grid resolution.",
            "id": "3996797",
            "problem": "Consider incompressible flow of air governed by the conservation of mass and momentum, discretized on a Marker-and-Cell (MAC) grid where pressure is cell-centered and velocity components are stored at face centers. The governing equations are the incompressible Navier–Stokes equations,\n$$\n\\nabla \\cdot \\boldsymbol{u} = 0, \\qquad \\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\nabla \\cdot (\\boldsymbol{u}\\boldsymbol{u}) = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^{2}\\boldsymbol{u},\n$$\nwhere $\\boldsymbol{u}$ is the velocity field, $p$ is pressure, $\\rho$ is density, and $\\nu$ is the kinematic viscosity. Consider a cubic domain of side length $L = 1~\\mathrm{m}$ discretized uniformly with a $100^{3}$ MAC grid, so that the uniform grid spacing is $\\Delta x = \\Delta y = \\Delta z = L/100$. The advection term is discretized by first-order upwind (donor-cell) differences and advanced in time by forward Euler (explicit), the diffusion term is advanced by backward Euler (implicit), and incompressibility is enforced by a projection step.\n\nSuppose the maximum face-normal velocity magnitudes observed over the grid are $u_{\\max} = 16~\\mathrm{m\\,s^{-1}}$ in the $x$-direction, $v_{\\max} = 8~\\mathrm{m\\,s^{-1}}$ in the $y$-direction, and $w_{\\max} = 4~\\mathrm{m\\,s^{-1}}$ in the $z$-direction. The air kinematic viscosity is $\\nu = 1.5 \\times 10^{-5}~\\mathrm{m^{2}\\,s^{-1}}$ at the operating conditions. A separate numerical experiment with the same discretization reports loss of stability at $\\Delta t_{\\mathrm{obs,unstable}} = 3.80 \\times 10^{-4}~\\mathrm{s}$, while $\\Delta t_{\\mathrm{obs,stable}} = 3.30 \\times 10^{-4}~\\mathrm{s}$ remains stable.\n\nStarting from the conservation laws and the stated discretization choices, derive the multi-dimensional Courant–Friedrichs–Lewy (CFL) stability constraint for the explicit advection update on the MAC grid. Using this constraint, compute the allowable time step $\\Delta t_{\\mathrm{CFL}}$ based on the given grid and velocity bounds, and then compare it to the numerical observation by forming the ratio\n$$\nR = \\frac{\\Delta t_{\\mathrm{obs,stable}}}{\\Delta t_{\\mathrm{CFL}}}.\n$$\nReport only the value of $R$ (dimensionless), rounded to four significant figures. The kinematic viscosity $\\nu$ is provided to confirm physical realism; note that diffusion is treated implicitly in this problem statement.",
            "solution": "The problem concerns the numerical stability of a time-marching scheme for the incompressible Navier-Stokes equations. The time integration method is a fractional-step method where different terms are treated with different schemes. The advection term, $\\nabla \\cdot (\\boldsymbol{u}\\boldsymbol{u})$, is discretized explicitly using Forward Euler in time and first-order upwind differences in space. The diffusion term, $\\nu \\nabla^{2}\\boldsymbol{u}$, is treated implicitly using Backward Euler. An explicit time-stepping scheme for an evolutionary partial differential equation is only stable if the time step, $\\Delta t$, is sufficiently small. The condition that defines this upper limit is known as a Courant–Friedrichs–Lewy (CFL) condition. Since the viscous term is treated implicitly, it does not impose a stability restriction on the time step. Therefore, the stability of the entire scheme is governed by the explicit treatment of the advection term.\n\nTo derive the stability constraint, we perform a von Neumann stability analysis on a model equation. For advection, the relevant model is the linear advection equation. Let us consider the one-dimensional case first:\n$$\n\\frac{\\partial q}{\\partial t} + c \\frac{\\partial q}{\\partial x} = 0\n$$\nwhere $q$ is a scalar quantity and $c$ is a constant wave speed. Discretizing in time with Forward Euler and in space with first-order upwind differences (assuming $c > 0$) at grid point $i$ and time level $n$ gives:\n$$\n\\frac{q_i^{n+1} - q_i^n}{\\Delta t} + c \\frac{q_i^n - q_{i-1}^n}{\\Delta x} = 0\n$$\nwhere $\\Delta x$ is the grid spacing. Rearranging for the value at the new time level, $q_i^{n+1}$:\n$$\nq_i^{n+1} = q_i^n - \\frac{c \\Delta t}{\\Delta x} (q_i^n - q_{i-1}^n)\n$$\nLet $C = \\frac{c \\Delta t}{\\Delta x}$ be the Courant number. The equation becomes:\n$$\nq_i^{n+1} = (1 - C) q_i^n + C q_{i-1}^n\n$$\nIn von Neumann analysis, we examine the amplification of a single Fourier mode, $q_j^n = G^n e^{\\mathrm{i}k x_j}$, where $x_j = j\\Delta x$, $k$ is the wavenumber, and $G$ is the amplification factor. Substituting this into the discretized equation:\n$$\nG^{n+1} e^{\\mathrm{i}k i \\Delta x} = (1 - C) G^n e^{\\mathrm{i}k i \\Delta x} + C G^n e^{\\mathrm{i}k (i-1) \\Delta x}\n$$\nDividing by $G^n e^{\\mathrm{i}k i \\Delta x}$:\n$$\nG = (1 - C) + C e^{-\\mathrm{i}k \\Delta x}\n$$\nFor the scheme to be stable, the magnitude of the amplification factor must satisfy $|G| \\le 1$ for all wavenumbers. The squared magnitude is:\n$$\n|G|^2 = |(1 - C) + C(\\cos(k\\Delta x) - \\mathrm{i}\\sin(k\\Delta x))|^2 = (1 - C + C\\cos(k\\Delta x))^2 + (-C\\sin(k\\Delta x))^2\n$$\n$$\n|G|^2 = (1-C)^2 + 2C(1-C)\\cos(k\\Delta x) + C^2\\cos^2(k\\Delta x) + C^2\\sin^2(k\\Delta x)\n$$\n$$\n|G|^2 = 1 - 2C + C^2 + 2C\\cos(k\\Delta x) - 2C^2\\cos(k\\Delta x) + C^2 = 1 - 2C(1 - \\cos(k\\Delta x)) + 2C^2(1 - \\cos(k\\Delta x))\n$$\n$$\n|G|^2 = 1 + 2C(C-1)(1 - \\cos(k\\Delta x))\n$$\nSince $1 - \\cos(k\\Delta x) \\ge 0$, the condition $|G|^2 \\le 1$ requires $2C(C-1) \\le 0$. This inequality holds for $0 \\le C \\le 1$. If we consider $c < 0$, the upwind stencil changes, but the resulting condition is $|C| \\le 1$. Thus, the 1D stability condition is:\n$$\n\\frac{|c|\\Delta t}{\\Delta x} \\le 1\n$$\nFor the three-dimensional nonlinear advection term, discretized with first-order upwind and Forward Euler on a Cartesian grid where the velocity components are $(u, v, w)$, the stability analysis can be extended. The resulting CFL condition is that the sum of the Courant numbers in each direction must be less than or equal to one:\n$$\n\\frac{|u|\\Delta t}{\\Delta x} + \\frac{|v|\\Delta t}{\\Delta y} + \\frac{|w|\\Delta t}{\\Delta z} \\le 1\n$$\nTo ensure stability throughout the entire computational domain, one must use the maximum possible velocity magnitudes. This leads to the definition of the maximum allowable time step, $\\Delta t_{\\mathrm{CFL}}$:\n$$\n\\Delta t_{\\mathrm{CFL}} \\left( \\frac{u_{\\max}}{\\Delta x} + \\frac{v_{\\max}}{\\Delta y} + \\frac{w_{\\max}}{\\Delta z} \\right) \\le 1\n$$\n$$\n\\Delta t_{\\mathrm{CFL}} = \\frac{1}{\\frac{u_{\\max}}{\\Delta x} + \\frac{v_{\\max}}{\\Delta y} + \\frac{w_{\\max}}{\\Delta z}}\n$$\nNow, we substitute the values provided in the problem statement. The domain has side length $L = 1~\\mathrm{m}$ and is discretized with a $100^3$ grid, so the uniform grid spacing is:\n$$\n\\Delta x = \\Delta y = \\Delta z = \\frac{L}{100} = \\frac{1~\\mathrm{m}}{100} = 0.01~\\mathrm{m}\n$$\nThe maximum velocity magnitudes are given as $u_{\\max} = 16~\\mathrm{m\\,s^{-1}}$, $v_{\\max} = 8~\\mathrm{m\\,s^{-1}}$, and $w_{\\max} = 4~\\mathrm{m\\,s^{-1}}$.\nSubstituting these values into the expression for $\\Delta t_{\\mathrm{CFL}}$:\n$$\n\\Delta t_{\\mathrm{CFL}} = \\frac{1}{\\frac{16}{0.01} + \\frac{8}{0.01} + \\frac{4}{0.01}} = \\frac{1}{1600 + 800 + 400} = \\frac{1}{2800}~\\mathrm{s}\n$$\nThe problem asks for the ratio $R = \\frac{\\Delta t_{\\mathrm{obs,stable}}}{\\Delta t_{\\mathrm{CFL}}}$. We are given $\\Delta t_{\\mathrm{obs,stable}} = 3.30 \\times 10^{-4}~\\mathrm{s}$.\n$$\nR = \\frac{3.30 \\times 10^{-4}~\\mathrm{s}}{1/2800~\\mathrm{s}} = (3.30 \\times 10^{-4}) \\times 2800\n$$\n$$\nR = 3.30 \\times 28 \\times 10^{-2} = 3.30 \\times 0.28\n$$\n$$\nR = 0.924\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nR = 0.9240\n$$\nThis result is physically reasonable. The derived CFL limit is a theoretical upper bound based on a linear model. For the full nonlinear Navier-Stokes equations, the actual stable time step is often slightly smaller than the theoretical limit, so a ratio close to but less than $1$ is expected. The provided values for the observed stable and unstable time steps ($\\Delta t_{\\mathrm{obs,stable}} = 3.30 \\times 10^{-4}~\\mathrm{s}$ and $\\Delta t_{\\mathrm{obs,unstable}} = 3.80 \\times 10^{-4}~\\mathrm{s}$) are consistent with the calculated theoretical limit of $\\Delta t_{\\mathrm{CFL}} = 1/2800~\\mathrm{s} \\approx 3.57 \\times 10^{-4}~\\mathrm{s}$. The stable observed time step is below the limit, and the unstable one is above it.",
            "answer": "$$\\boxed{0.9240}$$"
        }
    ]
}