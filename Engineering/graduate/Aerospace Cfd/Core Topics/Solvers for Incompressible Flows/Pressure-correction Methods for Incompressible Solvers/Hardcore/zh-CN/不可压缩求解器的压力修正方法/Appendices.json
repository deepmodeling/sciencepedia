{
    "hands_on_practices": [
        {
            "introduction": "压力修正法的第一步是量化预测速度场在多大程度上违反了不可压缩流动的连续性方程。压力泊松方程 (Pressure Poisson Equation, PPE) 的源项直接来源于这个预测速度场的散度，本练习将指导您在有限体积框架下，通过一个具体的预测速度场来亲手计算该源项，从而掌握压力修正法的核心计算环节。",
            "id": "3986461",
            "problem": "在计算流体力学（CFD）中，一个不可压缩流通过压力修正策略在时间上推进。通过对修正后的速度施加无散约束，产生了压力泊松方程（PPE）。考虑一个二维均匀笛卡尔网格，预测速度场存储在单元中心。我们关注一个内部控制体，记为单元 $P$，其近邻为 $W$、$E$、$S$ 和 $N$。网格间距为 $\\Delta x = 0.02$ 和 $\\Delta y = 0.03$（单位均为米），流体密度和时间步长分别为 $\\rho = 1.2$（单位 $\\mathrm{kg\\, m^{-3}}$）和 $\\Delta t = 0.005$（单位秒）。\n\n五个单元中心处的预测速度分量如下（单位 $\\mathrm{m\\, s^{-1}}$）：\n- 在 $P$ 处：$\\tilde{u}_{P} = 1.8$，$\\tilde{v}_{P} = -0.6$。\n- 在 $E$ 处：$\\tilde{u}_{E} = 2.1$，$\\tilde{v}_{E} = -0.5$。\n- 在 $W$ 处：$\\tilde{u}_{W} = 1.2$，$\\tilde{v}_{W} = -0.7$。\n- 在 $N$ 处：$\\tilde{u}_{N} = 1.9$，$\\tilde{v}_{N} = -0.2$。\n- 在 $S$ 处：$\\tilde{u}_{S} = 1.7$，$\\tilde{v}_{S} = -1.0$。\n\n使用二阶中心插值格式来近似单元 $P$ 东、西、南、北四个面上的法向预测速度，计算由预测速度的有限体积散度得到的、在 $P$ 处的压力泊松方程（PPE）的离散右端源项。将答案表示为单位体积源项 $s_{P}$，并将您的答案四舍五入到四位有效数字。最终源项的单位表示为 $\\mathrm{kg\\, m^{-3}\\, s^{-2}}$。",
            "solution": "用户希望我解决一个CFD问题，因此我将首先验证问题陈述。\n\n### 第1步：提取已知条件\n-   **网格间距**：$\\Delta x = 0.02$ m, $\\Delta y = 0.03$ m.\n-   **流体属性**：密度 $\\rho = 1.2$ $\\mathrm{kg\\,m^{-3}}$。\n-   **时间步长**：$\\Delta t = 0.005$ s.\n-   **单元中心预测速度**：\n    -   单元 $P$：$(\\tilde{u}_{P}, \\tilde{v}_{P}) = (1.8, -0.6)$ $\\mathrm{m\\,s^{-1}}$。\n    -   单元 $E$：$(\\tilde{u}_{E}, \\tilde{v}_{E}) = (2.1, -0.5)$ $\\mathrm{m\\,s^{-1}}$。\n    -   单元 $W$：$(\\tilde{u}_{W}, \\tilde{v}_{W}) = (1.2, -0.7)$ $\\mathrm{m\\,s^{-1}}$。\n    -   单元 $N$：$(\\tilde{u}_{N}, \\tilde{v}_{N}) = (1.9, -0.2)$ $\\mathrm{m\\,s^{-1}}$。\n    -   单元 $S$：$(\\tilde{u}_{S}, \\tilde{v}_{S}) = (1.7, -1.0)$ $\\mathrm{m\\,s^{-1}}$。\n-   **方法论**：\n    -   不可压缩流的压力修正策略。\n    -   用于面速度的二阶中心插值。\n    -   有限体积离散化。\n-   **目标**：计算单元 $P$ 处的压力泊松方程（PPE）的单位体积源项 $s_{P}$。\n-   **输出要求**：将答案四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是计算流体力学（CFD）中的一个标准练习，具体涉及SIMPLE算法或其变体之一。从无散约束推导出的压力泊松方程是求解不可压缩流的基本概念。所有原理都是合理的。\n2.  **适定性**：该问题提供了计算源项唯一值所需的所有数值、几何信息和方法论约束。\n3.  **目标**：语言精确且量化。所使用的术语（例如，“压力修正”、“预测速度”、“单元中心”）在CFD领域是标准的。\n4.  **完整性**：问题是自洽的，没有缺少计算所需的任何数据。\n5.  **一致性**：所提供的数据或要求中没有矛盾。\n\n### 第3步：结论与行动\n问题有效。我现在开始求解。\n\n不可压缩流的压力修正方法对修正后的速度场 $\\mathbf{u}^{n+1}$ 施加无散约束。新时间步 $n+1$ 处的速度由预测速度场 $\\tilde{\\mathbf{u}}$ 和压力修正量 $p'$ 更新得到：\n$$ \\mathbf{u}^{n+1} = \\tilde{\\mathbf{u}} - \\frac{\\Delta t}{\\rho} \\nabla p' $$\n不可压缩流的连续性方程为 $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$。将修正方程代入连续性方程，得到压力泊松方程（PPE）：\n$$ \\nabla \\cdot \\left( \\tilde{\\mathbf{u}} - \\frac{\\Delta t}{\\rho} \\nabla p' \\right) = 0 $$\n$$ \\nabla \\cdot \\tilde{\\mathbf{u}} - \\frac{\\Delta t}{\\rho} \\nabla^2 p' = 0 $$\n整理后得到压力修正量的标准形式PPE：\n$$ \\nabla^2 p' = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\tilde{\\mathbf{u}} $$\n问题要求计算该方程在控制体 $P$ 中心处的离散单位体积源项 $s_P$。连续源项为 $s = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\tilde{\\mathbf{u}}$。其在单元 $P$ 处的离散对应项为：\n$$ s_P = \\frac{\\rho}{\\Delta t} (\\nabla \\cdot \\tilde{\\mathbf{u}})_P $$\n其中 $(\\nabla \\cdot \\tilde{\\mathbf{u}})_P$ 是单元 $P$ 中预测速度场散度的有限体积近似。\n\n根据散度定理，控制体 $V_P$ 上的平均散度是流出控制体表面 $S_P$ 的净通量除以体积：\n$$ (\\nabla \\cdot \\tilde{\\mathbf{u}})_P = \\frac{1}{V_P} \\oint_{S_P} \\tilde{\\mathbf{u}} \\cdot d\\mathbf{A} $$\n对于具有单元尺寸 $\\Delta x$ 和 $\\Delta y$ 的二维笛卡尔网格，体积为 $V_P = \\Delta x \\Delta y$（假设单位深度）。面积分近似为穿过控制体四个面（东 $e$、西 $w$、北 $n$、南 $s$）的通量之和：\n$$ \\oint_{S_P} \\tilde{\\mathbf{u}} \\cdot d\\mathbf{A} \\approx (\\tilde{u}_e A_e) - (\\tilde{u}_w A_w) + (\\tilde{v}_n A_n) - (\\tilde{v}_s A_s) $$\n面面积为 $A_e = A_w = \\Delta y$ 和 $A_n = A_s = \\Delta x$。散度的表达式变为：\n$$ (\\nabla \\cdot \\tilde{\\mathbf{u}})_P \\approx \\frac{\\tilde{u}_e \\Delta y - \\tilde{u}_w \\Delta y + \\tilde{v}_n \\Delta x - \\tilde{v}_s \\Delta x}{\\Delta x \\Delta y} = \\frac{\\tilde{u}_e - \\tilde{u}_w}{\\Delta x} + \\frac{\\tilde{v}_n - \\tilde{v}_s}{\\Delta y} $$\n问题规定，面法向速度需要使用二阶中心插值格式从单元中心值近似得到。\n东面上的速度 $\\tilde{u}_e$ 由单元 $P$ 和 $E$ 插值得到：\n$$ \\tilde{u}_e = \\frac{\\tilde{u}_P + \\tilde{u}_E}{2} = \\frac{1.8 + 2.1}{2} = \\frac{3.9}{2} = 1.95 \\, \\mathrm{m\\,s^{-1}} $$\n西面上的速度 $\\tilde{u}_w$ 由单元 $W$ 和 $P$ 插值得到：\n$$ \\tilde{u}_w = \\frac{\\tilde{u}_W + \\tilde{u}_P}{2} = \\frac{1.2 + 1.8}{2} = \\frac{3.0}{2} = 1.5 \\, \\mathrm{m\\,s^{-1}} $$\n北面上的速度 $\\tilde{v}_n$ 由单元 $P$ 和 $N$ 插值得到：\n$$ \\tilde{v}_n = \\frac{\\tilde{v}_P + \\tilde{v}_N}{2} = \\frac{-0.6 + (-0.2)}{2} = \\frac{-0.8}{2} = -0.4 \\, \\mathrm{m\\,s^{-1}} $$\n南面上的速度 $\\tilde{v}_s$ 由单元 $S$ 和 $P$ 插值得到：\n$$ \\tilde{v}_s = \\frac{\\tilde{v}_S + \\tilde{v}_P}{2} = \\frac{-1.0 + (-0.6)}{2} = \\frac{-1.6}{2} = -0.8 \\, \\mathrm{m\\,s^{-1}} $$\n现在，我们使用给定的网格间距 $\\Delta x = 0.02$ 和 $\\Delta y = 0.03$ 计算离散散度的两项：\n$$ \\frac{\\tilde{u}_e - \\tilde{u}_w}{\\Delta x} = \\frac{1.95 - 1.5}{0.02} = \\frac{0.45}{0.02} = 22.5 \\, \\mathrm{s^{-1}} $$\n$$ \\frac{\\tilde{v}_n - \\tilde{v}_s}{\\Delta y} = \\frac{-0.4 - (-0.8)}{0.03} = \\frac{0.4}{0.03} = \\frac{40}{3} \\, \\mathrm{s^{-1}} $$\n单元 $P$ 处的总离散散度是这两项之和：\n$$ (\\nabla \\cdot \\tilde{\\mathbf{u}})_P = 22.5 + \\frac{40}{3} = \\frac{45}{2} + \\frac{40}{3} = \\frac{135 + 80}{6} = \\frac{215}{6} \\, \\mathrm{s^{-1}} $$\n最后，我们使用 $\\rho = 1.2$ 和 $\\Delta t = 0.005$ 计算单位体积源项 $s_P$：\n$$ s_P = \\frac{\\rho}{\\Delta t} (\\nabla \\cdot \\tilde{\\mathbf{u}})_P = \\left( \\frac{1.2\\,\\mathrm{kg\\,m^{-3}}}{0.005\\,\\mathrm{s}} \\right) \\left( \\frac{215}{6} \\, \\mathrm{s^{-1}} \\right) $$\n前置因子为：\n$$ \\frac{1.2}{0.005} = \\frac{1200}{5} = 240 \\, \\mathrm{kg\\,m^{-3}\\,s^{-1}} $$\n因此，源项为：\n$$ s_P = 240 \\times \\frac{215}{6} = 40 \\times 215 = 8600 \\, \\mathrm{kg\\,m^{-3}\\,s^{-2}} $$\n计算值恰好为 $8600$。问题要求答案四舍五入到四位有效数字。数字 $8600$ 可以无歧义地写成四位有效数字形式，即 $8.600 \\times 10^3$。",
            "answer": "$$\n\\boxed{8.600 \\times 10^3}\n$$"
        },
        {
            "introduction": "在同位网格 (collocated grid) 上求解不可压缩流时，压力与速度之间可能会出现非物理性的棋盘状振荡，即压力-速度解耦。Rhie-Chow 插值是解决这一问题的经典方法，它通过修正面心速度的计算方式来恢复压力梯度与速度场的正确耦合。本练习将让您应用 Rhie-Chow 插值，计算一个正确耦合了压力梯度的面心质量通量，从而深入理解该技术在实际计算中的作用。",
            "id": "3986482",
            "problem": "考虑沿笛卡尔坐标$x$的一维稳态、层流、不可压缩流动，该流动采用同位网格有限体积法进行离散，控制体大小均匀为$\\Delta x$，面面积为单位面积$A$。流动方向与$x$轴对齐，面法向矢量指向$x$轴正方向。计算任务是利用Rhie–Chow动量插值法计算单个内部面的质量通量，以避免压力-速度解耦问题。\n\n从一维质量守恒和稳态不可压缩动量平衡方程出发：\n- 连续性方程：$\\frac{d u}{d x} = 0$，\n- 动量方程：$\\rho u \\frac{d u}{d x} = -\\frac{d p}{d x} + \\mu \\frac{d^{2} u}{d x^{2}}$，\n并使用均匀网格上的中心差分、同位有限体积法 (FVM) 离散格式，推导与Rhie–Chow动量插值一致的面速度表达式。假设动量方程已被线性化并通过速度欠松弛因子$\\alpha_{u}$进行欠松弛处理，因此单元$P$的欠松弛对角系数为$a_{P}^{u} = a_{P}/\\alpha_{u}$，其中$a_{P}$是由均匀网格上的扩散算子产生的未松弛对角系数。使用欠松弛动量对角系数，通过对称平均相邻的欠松弛对角系数，构建位于两个相邻单元$P$和$E$之间的面$f$处的Rhie–Chow压力-速度耦合系数，并用此系数来封闭与半控制体动量平衡一致的面速度表达式。将给定的单元中心伪速度视为求解不含压力梯度项的动量方程所得到的速度。\n\n特定面$f$（位于单元$P$和$E$之间）的数据：\n- 均匀间距 $\\Delta x = 0.1\\,\\mathrm{m}$，\n- 面面积 $A = 1\\,\\mathrm{m}^{2}$，\n- 密度 $\\rho = 1.0\\,\\mathrm{kg/m^{3}}$，\n- 动力粘度 $\\mu = 10\\,\\mathrm{Pa\\cdot s}$，\n- 速度欠松弛因子 $\\alpha_{u} = 0.7$，\n- 相邻单元中心的伪速度 $u_{P}^{*} = 0.08\\,\\mathrm{m/s}$ 和 $u_{E}^{*} = 0.04\\,\\mathrm{m/s}$，\n- 单元中心压力 $p_{P} = 101325\\,\\mathrm{Pa}$ 和 $p_{E} = 101305\\,\\mathrm{Pa}$。\n\n计算面$f$上沿$x$轴正方向的Rhie–Chow插值面质量通量 $\\phi_{f} = \\rho\\,u_{f}\\,A$。最终答案以$\\mathrm{kg/s}$为单位，并四舍五入至四位有效数字。",
            "solution": "用户希望使用Rhie–Chow动量插值法计算特定面`f`上的面质量通量。\n\n### 步骤1：提取给定信息\n- **控制方程 (一维、稳态、不可压缩):**\n  - 连续性方程: $\\frac{d u}{d x} = 0$\n  - 动量方程: $\\rho u \\frac{d u}{d x} = -\\frac{d p}{d x} + \\mu \\frac{d^{2} u}{d x^{2}}$\n- **离散格式:**\n  - 一维同位有限体积法 (FVM)。\n  - 大小为$\\Delta x$的均匀控制体。\n  - 中心差分格式。\n- **问题特定假设:**\n  - 动量方程是线性化的，并通过速度欠松弛因子$\\alpha_u$进行欠松弛处理。\n  - 单元$P$的欠松弛对角系数为$a_{P}^{u} = a_{P}/\\alpha_{u}$。\n  - 未松弛对角系数$a_{P}$仅由均匀网格上的扩散算子产生。\n  - Rhie–Chow压力-速度耦合系数通过对称平均相邻的欠松弛对角系数构建。\n  - 伪速度 ($u_P^*$, $u_E^*$) 是通过求解不含压力梯度项的动量方程得到的。\n- **数值数据:**\n  - 均匀间距: $\\Delta x = 0.1\\,\\mathrm{m}$\n  - 面面积: $A = 1\\,\\mathrm{m}^{2}$\n  - 密度: $\\rho = 1.0\\,\\mathrm{kg/m^{3}}$\n  - 动力粘度: $\\mu = 10\\,\\mathrm{Pa\\cdot s}$\n  - 速度欠松弛因子: $\\alpha_{u} = 0.7$\n  - 单元中心P的伪速度: $u_{P}^{*} = 0.08\\,\\mathrm{m/s}$\n  - 单元中心E的伪速度: $u_{E}^{*} = 0.04\\,\\mathrm{m/s}$\n  - 单元中心P的压力: $p_{P} = 101325\\,\\mathrm{Pa}$\n  - 单元中心E的压力: $p_{E} = 101305\\,\\mathrm{Pa}$\n- **目标量:**\n  - 位于单元$P$和$E$之间的面$f$上的面质量通量 $\\phi_{f} = \\rho\\,u_{f}\\,A$。\n\n### 步骤2：使用提取的给定信息进行验证\n- **科学性：** 该问题基于基本的Navier-Stokes方程和计算流体动力学中一个成熟的数值方法（带有Rhie-Chow插值的FVM）。其物理和数学原理是可靠的。\n- **良定性：** 所有必要的数据、边界条件（通过单元值隐式给出）和本构参数都已提供。该问题的结构决定了其具有唯一的可计算解。\n- **客观性：** 语言精确且专业。所有术语均为CFD领域内的标准术语。\n\n该问题是一个经典的、自洽的CFD数值练习。它没有任何科学缺陷、歧义或矛盾。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供解答。\n\n### 求解推导\n\n主要目标是计算位于两个单元中心$P$和$E$之间的面$f$上的质量通量$\\phi_f$。质量通量定义为$\\phi_f = \\rho u_f A$。为了求得$\\phi_f$，我们必须首先使用Rhie–Chow插值法确定面速度$u_f$。\n\n在某个单元中心（例如$P$）的离散动量方程可以普遍地写成欠松弛形式：\n$$ a_P^u u_P = H_P - V_P (\\nabla p)_P $$\n其中$a_P^u$是欠松弛对角系数，$H_P$包含来自相邻速度和源项的贡献，$V_P$是单元体积，$(\\nabla p)_P$是单元中心的压力梯度。\n\n问题将伪速度$u_P^*$定义为不含压力梯度项的动量方程的解：\n$$ a_P^u u_P^* = H_P $$\n将此代入完整的动量方程，得到单元中心速度的表达式：\n$$ u_P = u_P^* - \\frac{V_P}{a_P^u} (\\nabla p)_P $$\nRhie–Chow插值格式通过插值伪速度并应用一个特殊构造的压力修正项来构建面速度$u_f$。面速度$u_f$的表达式为：\n$$ u_f = \\overline{u_f^*} - \\overline{\\left(\\frac{V}{a^u}\\right)_f} (\\nabla p)_f $$\n此处，对于位于单元$P$和$E$之间的面$f$，各项定义如下：\n1.  插值伪速度$\\overline{u_f^*}$是单元中心伪速度的线性平均：\n    $$ \\overline{u_f^*} = \\frac{u_P^* + u_E^*}{2} $$\n2.  面上的压力梯度$(\\nabla p)_f$使用中心差分进行近似：\n    $$ (\\nabla p)_f = \\frac{p_E - p_P}{\\Delta x} $$\n3.  插值压力-速度耦合系数$\\overline{\\left(\\frac{V}{a^u}\\right)_f}$是单元级系数的算术平均值：\n    $$ \\overline{\\left(\\frac{V}{a^u}\\right)_f} = \\frac{1}{2} \\left(\\frac{V_P}{a_P^u} + \\frac{V_E}{a_E^u}\\right) $$\n对于一维均匀网格，单元体积为$V_P = V_E = V = A \\Delta x$。问题还指定了均匀网格和恒定属性，这意味着对角系数相等，$a_P = a_E$，因此$a_P^u = a_E^u$。耦合系数简化为：\n$$ \\overline{\\left(\\frac{V}{a^u}\\right)_f} = \\frac{V_P}{a_P^u} = \\frac{A \\Delta x}{a_P^u} $$\n将这些代入面速度方程：\n$$ u_f = \\frac{u_P^* + u_E^*}{2} - \\left(\\frac{A \\Delta x}{a_P^u}\\right) \\left(\\frac{p_E - p_P}{\\Delta x}\\right) = \\frac{u_P^* + u_E^*}{2} - \\frac{A}{a_P^u} (p_E - p_P) $$\n为了继续计算，我们必须计算未松弛的对角系数$a_P$。问题指出$a_P$来自使用中心差分有限体积法离散的扩散算子$\\mu \\frac{d^2 u}{dx^2}$。扩散项在控制体$V_P$（从面$w$到面$e$）上的积分为：\n$$ \\int_{V_P} \\nabla \\cdot (\\mu \\nabla u) \\,dV = (\\mu A \\frac{du}{dx})_e - (\\mu A \\frac{du}{dx})_w $$\n对面上的梯度使用中心差分：\n$$ \\mu A \\left(\\frac{u_E - u_P}{\\Delta x}\\right) - \\mu A \\left(\\frac{u_P - u_W}{\\Delta x}\\right) = \\frac{\\mu A}{\\Delta x} u_E + \\frac{\\mu A}{\\Delta x} u_W - \\frac{2\\mu A}{\\Delta x} u_P $$\n在标准FVM格式$a_P u_P = \\sum a_{nb} u_{nb} + S_u$中，我们有$a_E = \\frac{\\mu A}{\\Delta x}$，$a_W = \\frac{\\mu A}{\\Delta x}$，以及$a_P = a_E + a_W$（对于无源、纯扩散问题，以确保守恒）。因此，未松弛的对角系数为：\n$$ a_P = \\frac{2\\mu A}{\\Delta x} $$\n现在，我们可以代入给定的数值：\n$\\mu = 10\\,\\mathrm{Pa\\cdot s}$，$A = 1\\,\\mathrm{m}^2$，$\\Delta x = 0.1\\,\\mathrm{m}$。\n$$ a_P = \\frac{2(10)(1)}{0.1} = 200\\,\\mathrm{kg/s} $$\n使用给定的欠松弛因子$\\alpha_u = 0.7$计算欠松弛对角系数$a_P^u$：\n$$ a_P^u = \\frac{a_P}{\\alpha_u} = \\frac{200}{0.7}\\,\\mathrm{kg/s} $$\n我们现在拥有计算$u_f$所需的所有部分：\n- $u_P^* = 0.08\\,\\mathrm{m/s}$, $u_E^* = 0.04\\,\\mathrm{m/s}$\n- $p_P = 101325\\,\\mathrm{Pa}$, $p_E = 101305\\,\\mathrm{Pa}$\n- $A = 1\\,\\mathrm{m}^2$\n\n首先，计算插值伪速度：\n$$ \\overline{u_f^*} = \\frac{0.08 + 0.04}{2} = 0.06\\,\\mathrm{m/s} $$\n接下来，计算压力差：\n$$ p_E - p_P = 101305 - 101325 = -20\\,\\mathrm{Pa} $$\n现在将这些值代入$u_f$的表达式：\n$$ u_f = 0.06 - \\frac{1}{200/0.7} (-20) = 0.06 - \\frac{0.7}{200}(-20) = 0.06 - (-0.07) = 0.06 + 0.07 = 0.13\\,\\mathrm{m/s} $$\n最后，计算面质量通量$\\phi_f$：\n$$ \\phi_f = \\rho u_f A = (1.0\\,\\mathrm{kg/m^3})(0.13\\,\\mathrm{m/s})(1\\,\\mathrm{m}^2) = 0.13\\,\\mathrm{kg/s} $$\n问题要求答案四舍五入到四位有效数字。\n$$ \\phi_f = 0.1300\\,\\mathrm{kg/s} $$",
            "answer": "$$\n\\boxed{0.1300}\n$$"
        },
        {
            "introduction": "压力修正步骤不仅是一个工程上的修正技巧，在数学上，它对应着一个将速度场投影到无散度向量空间的正交投影算子。这个练习通过一个特殊构造的、不满足无散度条件的初始速度场，来清晰地揭示投影步骤的这一基本性质及其重要推论：压力修正过程不会增加系统的动能，这是保证数值方法稳定性的一个关键因素。",
            "id": "3986492",
            "problem": "考虑一个二维、周期性、单位厚度的正方形区域，边长为 $L = 1$，该区域被离散化为一个均匀的笛卡尔网格，有 $N_x = 4$ 和 $N_y = 4$ 个单元，因此 $\\Delta x = \\Delta y = L/4$ 且 $\\Delta V = \\Delta x \\Delta y \\times 1$。密度恒为 $\\rho = 1.2$ ($kg/m³$)的空气充满了该区域。在计算流体动力学（CFD）的预测-校正压力修正方法中，执行了一个不可压缩投影步骤，其中压力修正更新为\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla p,\n$$\n时间步长为 $\\Delta t = 0.01$。位于单元中心 $(x_i, y_j)$ 的中间速度场 $\\boldsymbol{u}^{*} = (u^{*}, v^{*})$ 被选为标量势\n$$\n\\phi(x,y) = B \\cos(2\\pi x)\\cos(2\\pi y),\n$$\n的梯度，其中 $B = 0.1$。具体来说，\n$$\nu^{*}(x_i,y_j) = \\frac{\\partial \\phi}{\\partial x}(x_i,y_j), \\quad v^{*}(x_i,y_j) = \\frac{\\partial \\phi}{\\partial y}(x_i,y_j),\n$$\n其中单元中心坐标为 $x_i = \\left(i - \\tfrac{1}{2}\\right)\\Delta x$, $y_j = \\left(j - \\tfrac{1}{2}\\right)\\Delta y$，对于 $i=1,\\dots,4$，$j=1,\\dots,4$。用于修正的压力取为\n$$\np(x_i,y_j) = \\frac{\\rho}{\\Delta t}\\,\\phi(x_i,y_j),\n$$\n因此在单元中心有 $\\nabla p = \\frac{\\rho}{\\Delta t}\\nabla \\phi$，且该修正完全移除了 $\\boldsymbol{u}^{*}$ 的无旋分量。单元中心速度场的离散动能定义为\n$$\nE = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\frac{1}{2}\\,\\rho \\left(u_{i,j}^{2} + v_{i,j}^{2}\\right)\\,\\Delta V.\n$$\n\n从投影步骤和离散动能的基本定义出发，计算上述压力修正步骤产生的离散动能变化量 $\\Delta E = E^{n+1} - E^{*}$。将最终答案四舍五入到四位有效数字。以焦耳为单位表示能量变化。",
            "solution": "不可压缩投影步骤通过以下方式将中间速度 $\\boldsymbol{u}^{*}$ 更新为 $\\boldsymbol{u}^{n+1}$\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{*} - \\frac{\\Delta t}{\\rho}\\nabla p.\n$$\n对于具有周期性边界的均匀网格上的一致离散化，离散散度算子是在由 $\\Delta V$ 加权的 $\\ell^{2}$ 内积下的离散梯度算子的负伴随算子，这确保了向无散子空间投影的能量稳定性。单元中心场的离散动能为\n$$\nE = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\frac{1}{2}\\,\\rho \\left(u_{i,j}^{2} + v_{i,j}^{2}\\right)\\,\\Delta V.\n$$\n\n我们从势 $\\phi(x,y) = B \\cos(2\\pi x)\\cos(2\\pi y)$ 构建 $\\boldsymbol{u}^{*}$，因此\n$$\nu^{*}(x,y) = \\frac{\\partial \\phi}{\\partial x}(x,y) = -2\\pi B \\sin(2\\pi x)\\cos(2\\pi y),\n$$\n$$\nv^{*}(x,y) = \\frac{\\partial \\phi}{\\partial y}(x,y) = -2\\pi B \\cos(2\\pi x)\\sin(2\\pi y).\n$$\n通过取 $p = \\frac{\\rho}{\\Delta t}\\phi$，我们有\n$$\n\\nabla p = \\frac{\\rho}{\\Delta t}\\nabla \\phi = \\frac{\\rho}{\\Delta t}\\,\\boldsymbol{u}^{*},\n$$\n因此\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{*} - \\frac{\\Delta t}{\\rho}\\left(\\frac{\\rho}{\\Delta t}\\boldsymbol{u}^{*}\\right) = \\boldsymbol{u}^{*} - \\boldsymbol{u}^{*} = \\boldsymbol{0}.\n$$\n因此，在所有单元中心，修正后的场恒为零，这意味着\n$$\nE^{n+1} = 0.\n$$\n所以，能量变化为\n$$\n\\Delta E = E^{n+1} - E^{*} = -E^{*}.\n$$\n\n剩下需要计算 $E^{*}$。因为区域是均匀且周期性的，所以只需在 $4\\times 4$ 个单元中心计算 $\\left(u^{*2} + v^{*2}\\right)$ 并求和。设单元中心坐标为\n$$\nx_i = \\left(i - \\tfrac{1}{2}\\right)\\Delta x,\\quad y_j = \\left(j - \\tfrac{1}{2}\\right)\\Delta y,\\quad \\Delta x = \\Delta y = \\frac{L}{4} = \\frac{1}{4}.\n$$\n因此\n$$\nx_i \\in \\left\\{ \\frac{1}{8}, \\frac{3}{8}, \\frac{5}{8}, \\frac{7}{8} \\right\\},\\quad y_j \\in \\left\\{ \\frac{1}{8}, \\frac{3}{8}, \\frac{5}{8}, \\frac{7}{8} \\right\\}.\n$$\n在这些点上，\n$$\n\\sin(2\\pi x_i),\\ \\cos(2\\pi x_i),\\ \\sin(2\\pi y_j),\\ \\cos(2\\pi y_j) \\in \\left\\{ \\pm \\frac{\\sqrt{2}}{2} \\right\\},\n$$\n所以对于所有 $i,j$，都有 $\\sin^{2}(2\\pi x_i) = \\cos^{2}(2\\pi x_i) = \\sin^{2}(2\\pi y_j) = \\cos^{2}(2\\pi y_j) = \\frac{1}{2}$。因此，在每个单元中心，\n$$\nu^{*2} + v^{*2} = (2\\pi B)^{2}\\left[\\sin^{2}(2\\pi x)\\cos^{2}(2\\pi y) + \\cos^{2}(2\\pi x)\\sin^{2}(2\\pi y)\\right]\n= (2\\pi B)^{2}\\left(\\frac{1}{2}\\cdot\\frac{1}{2} + \\frac{1}{2}\\cdot\\frac{1}{2}\\right)\n= (2\\pi B)^{2}\\cdot\\frac{1}{2}\n= 2\\pi^{2}B^{2}.\n$$\n因此，中间速度场的离散动能为\n$$\nE^{*} = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\frac{1}{2}\\rho \\left(u_{i,j}^{*2} + v_{i,j}^{*2}\\right)\\Delta V\n= 16 \\cdot \\frac{1}{2}\\rho \\cdot \\left(2\\pi^{2}B^{2}\\right)\\cdot \\Delta V\n= 16\\,\\rho\\,\\pi^{2}B^{2}\\,\\Delta V.\n$$\n使用 $\\rho = 1.2$，$B = 0.1$，$L = 1$，$\\Delta x = \\Delta y = \\frac{1}{4}$ 以及 $\\Delta V = \\Delta x \\Delta y \\times 1 = \\frac{1}{16}$，我们得到\n$$\n\\Delta V = \\frac{1}{16} = 0.0625,\n$$\n$$\nE^{*} = 16 \\times 1.2 \\times \\pi^{2} \\times (0.1)^{2} \\times 0.0625\n= \\left(16 \\times 1.2 \\times 0.01 \\times 0.0625\\right)\\pi^{2}\n= \\left(0.012\\right)\\pi^{2}.\n$$\n由于 $\\pi^{2} \\approx 9.869604401$，这给出\n$$\nE^{*} \\approx 0.012 \\times 9.869604401 \\approx 0.1184352528.\n$$\n因此，\n$$\n\\Delta E = -E^{*} \\approx -0.1184352528.\n$$\n四舍五入到四位有效数字，能量变化为\n$$\n\\Delta E \\approx -0.1184.\n$$\n\n讨论：所选的中间速度 $\\boldsymbol{u}^{*}$ 是无旋的，因为它是标量势的梯度。使用 $p = \\frac{\\rho}{\\Delta t}\\phi$ 的压力修正步骤精确地移除了这个无旋分量，将 $\\boldsymbol{u}^{*}$ 投影到无散子空间上，得到 $\\boldsymbol{u}^{n+1} = \\boldsymbol{0}$。离散动能严格减少了 $E^{*}$，这说明了当散度算子是离散内积下梯度算子的负伴随时，压力投影的能量不增特性。一般来说，可以证明\n$$\nE^{n+1} - E^{*} = -\\frac{1}{2}\\,\\frac{\\Delta t^{2}}{\\rho}\\,\\|\\nabla p\\|^{2}_{\\Delta V} \\le 0,\n$$\n这与当前的计算结果一致。",
            "answer": "$$\\boxed{-0.1184}$$"
        }
    ]
}