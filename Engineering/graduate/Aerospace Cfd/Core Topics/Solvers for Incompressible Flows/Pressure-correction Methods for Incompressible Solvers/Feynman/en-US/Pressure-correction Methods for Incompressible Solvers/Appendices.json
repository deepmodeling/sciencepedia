{
    "hands_on_practices": [
        {
            "introduction": "The Pressure Poisson Equation (PPE) is the core of all pressure-correction algorithms, and its source term is the first critical component to compute in any time step. This source term, which is proportional to the divergence of the provisional velocity field, provides a direct measure of the local mass imbalance that the pressure correction must eliminate. This exercise provides fundamental, hands-on practice in discretizing the divergence operator using the finite volume method, a cornerstone skill for developing or analyzing any incompressible flow solver .",
            "id": "3986461",
            "problem": "An incompressible flow is advanced in time by a pressure-correction strategy within Computational Fluid Dynamics (CFD). The Pressure Poisson Equation (PPE) arises by enforcing the divergence-free constraint on the corrected velocity. Consider a two-dimensional uniform Cartesian grid with cell-centered storage of the predicted velocity field. Focus on an interior control volume, denoted as cell $P$, with immediate neighbors $W$, $E$, $S$, and $N$. The grid spacings are $\\Delta x = 0.02$ and $\\Delta y = 0.03$ (both in meters), and the fluid density and time step are $\\rho = 1.2$ and $\\Delta t = 0.005$ (in $\\mathrm{kg\\, m^{-3}}$ and seconds, respectively).\n\nThe predicted velocity components at the centers of the five cells are given as follows (in $\\mathrm{m\\, s^{-1}}$):\n- At $P$: $\\tilde{u}_{P} = 1.8$, $\\tilde{v}_{P} = -0.6$.\n- At $E$: $\\tilde{u}_{E} = 2.1$, $\\tilde{v}_{E} = -0.5$.\n- At $W$: $\\tilde{u}_{W} = 1.2$, $\\tilde{v}_{W} = -0.7$.\n- At $N$: $\\tilde{u}_{N} = 1.9$, $\\tilde{v}_{N} = -0.2$.\n- At $S$: $\\tilde{u}_{S} = 1.7$, $\\tilde{v}_{S} = -1.0$.\n\nUsing a second-order central interpolation stencil to approximate the face-normal predicted velocities on the east, west, north, and south faces of cell $P$, compute the discrete right-hand-side source term for the PPE at $P$ obtained from the finite-volume divergence of the predicted velocity. Express the answer as the per-volume source $s_{P}$, and round your answer to four significant figures. Express the final source term in $\\mathrm{kg\\, m^{-3}\\, s^{-2}}$.",
            "solution": "The user wants me to solve a CFD problem, so I will first validate the problem statement.\n\n### Step 1: Extract Givens\n-   **Grid Spacing**: $\\Delta x = 0.02$ m, $\\Delta y = 0.03$ m.\n-   **Fluid Properties**: Density $\\rho = 1.2$ $\\mathrm{kg\\,m^{-3}}$.\n-   **Time Step**: $\\Delta t = 0.005$ s.\n-   **Cell-Centered Predicted Velocities**:\n    -   Cell $P$: $(\\tilde{u}_{P}, \\tilde{v}_{P}) = (1.8, -0.6)$ $\\mathrm{m\\,s^{-1}}$.\n    -   Cell $E$: $(\\tilde{u}_{E}, \\tilde{v}_{E}) = (2.1, -0.5)$ $\\mathrm{m\\,s^{-1}}$.\n    -   Cell $W$: $(\\tilde{u}_{W}, \\tilde{v}_{W}) = (1.2, -0.7)$ $\\mathrm{m\\,s^{-1}}$.\n    -   Cell $N$: $(\\tilde{u}_{N}, \\tilde{v}_{N}) = (1.9, -0.2)$ $\\mathrm{m\\,s^{-1}}$.\n    -   Cell $S$: $(\\tilde{u}_{S}, \\tilde{v}_{S}) = (1.7, -1.0)$ $\\mathrm{m\\,s^{-1}}$.\n-   **Methodology**:\n    -   Pressure-correction strategy for incompressible flow.\n    -   Second-order central interpolation for face velocities.\n    -   Finite-volume discretization.\n-   **Objective**: Compute the per-volume source term for the Pressure Poisson Equation (PPE), $s_{P}$, at cell $P$.\n-   **Output Requirement**: Round the answer to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is a standard exercise in Computational Fluid Dynamics (CFD), specifically concerning the SIMPLE algorithm or one of its variants. The use of a Pressure Poisson Equation derived from the divergence-free constraint is a fundamental concept in solving incompressible flows. All principles are sound.\n2.  **Well-Posed**: The problem provides all necessary numerical values, geometric information, and methodological constraints to calculate a unique value for the source term.\n3.  **Objective**: The language is precise and quantitative. The terms used (e.g., \"pressure-correction,\" \"predicted velocity,\" \"cell-centered\") are standard in the field of CFD.\n4.  **Completeness**: The problem is self-contained and not missing any data required for the calculation.\n5.  **Consistency**: There are no contradictions in the provided data or requirements.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will now proceed with the solution.\n\nThe pressure-correction method for incompressible flow enforces the divergence-free constraint on the corrected velocity field $\\mathbf{u}^{n+1}$. The velocity at the new time step, $n+1$, is updated from a predicted velocity field, $\\tilde{\\mathbf{u}}$, using a pressure correction, $p'$:\n$$ \\mathbf{u}^{n+1} = \\tilde{\\mathbf{u}} - \\frac{\\Delta t}{\\rho} \\nabla p' $$\nThe continuity equation for an incompressible flow is $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$. Substituting the correction equation into the continuity equation yields the Pressure Poisson Equation (PPE):\n$$ \\nabla \\cdot \\left( \\tilde{\\mathbf{u}} - \\frac{\\Delta t}{\\rho} \\nabla p' \\right) = 0 $$\n$$ \\nabla \\cdot \\tilde{\\mathbf{u}} - \\frac{\\Delta t}{\\rho} \\nabla^2 p' = 0 $$\nRearranging gives the standard form of the PPE for the pressure correction:\n$$ \\nabla^2 p' = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\tilde{\\mathbf{u}} $$\nThe problem asks for the discrete, per-volume source term, $s_P$, for this equation at the center of a control volume $P$. The continuous source term is $s = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\tilde{\\mathbf{u}}$. Its discretized counterpart at cell $P$ is:\n$$ s_P = \\frac{\\rho}{\\Delta t} (\\nabla \\cdot \\tilde{\\mathbf{u}})_P $$\nwhere $(\\nabla \\cdot \\tilde{\\mathbf{u}})_P$ is the finite-volume approximation of the divergence of the predicted velocity field in cell $P$.\n\nUsing the divergence theorem, the average divergence over the control volume $V_P$ is the net flux out of the control volume surface $S_P$, divided by the volume:\n$$ (\\nabla \\cdot \\tilde{\\mathbf{u}})_P = \\frac{1}{V_P} \\oint_{S_P} \\tilde{\\mathbf{u}} \\cdot d\\mathbf{A} $$\nFor a two-dimensional Cartesian grid with cell dimensions $\\Delta x$ and $\\Delta y$, the volume is $V_P = \\Delta x \\Delta y$ (assuming unit depth). The surface integral is approximated as a sum of fluxes across the four faces of the control volume (east $e$, west $w$, north $n$, south $s$):\n$$ \\oint_{S_P} \\tilde{\\mathbf{u}} \\cdot d\\mathbf{A} \\approx (\\tilde{u}_e A_e) - (\\tilde{u}_w A_w) + (\\tilde{v}_n A_n) - (\\tilde{v}_s A_s) $$\nThe face areas are $A_e = A_w = \\Delta y$ and $A_n = A_s = \\Delta x$. The expression for the divergence becomes:\n$$ (\\nabla \\cdot \\tilde{\\mathbf{u}})_P \\approx \\frac{\\tilde{u}_e \\Delta y - \\tilde{u}_w \\Delta y + \\tilde{v}_n \\Delta x - \\tilde{v}_s \\Delta x}{\\Delta x \\Delta y} = \\frac{\\tilde{u}_e - \\tilde{u}_w}{\\Delta x} + \\frac{\\tilde{v}_n - \\tilde{v}_s}{\\Delta y} $$\nThe problem specifies that the face-normal velocities are to be approximated using a second-order central interpolation stencil from the cell-centered values.\nThe velocity on the east face, $\\tilde{u}_e$, is interpolated between cells $P$ and $E$:\n$$ \\tilde{u}_e = \\frac{\\tilde{u}_P + \\tilde{u}_E}{2} = \\frac{1.8 + 2.1}{2} = \\frac{3.9}{2} = 1.95 \\, \\mathrm{m\\,s^{-1}} $$\nThe velocity on the west face, $\\tilde{u}_w$, is interpolated between cells $W$ and $P$:\n$$ \\tilde{u}_w = \\frac{\\tilde{u}_W + \\tilde{u}_P}{2} = \\frac{1.2 + 1.8}{2} = \\frac{3.0}{2} = 1.5 \\, \\mathrm{m\\,s^{-1}} $$\nThe velocity on the north face, $\\tilde{v}_n$, is interpolated between cells $P$ and $N$:\n$$ \\tilde{v}_n = \\frac{\\tilde{v}_P + \\tilde{v}_N}{2} = \\frac{-0.6 + (-0.2)}{2} = \\frac{-0.8}{2} = -0.4 \\, \\mathrm{m\\,s^{-1}} $$\nThe velocity on the south face, $\\tilde{v}_s$, is interpolated between cells $S$ and $P$:\n$$ \\tilde{v}_s = \\frac{\\tilde{v}_S + \\tilde{v}_P}{2} = \\frac{-1.0 + (-0.6)}{2} = \\frac{-1.6}{2} = -0.8 \\, \\mathrm{m\\,s^{-1}} $$\nNow, we compute the two terms of the discrete divergence using the given grid spacings $\\Delta x = 0.02$ and $\\Delta y = 0.03$:\n$$ \\frac{\\tilde{u}_e - \\tilde{u}_w}{\\Delta x} = \\frac{1.95 - 1.5}{0.02} = \\frac{0.45}{0.02} = 22.5 \\, \\mathrm{s^{-1}} $$\n$$ \\frac{\\tilde{v}_n - \\tilde{v}_s}{\\Delta y} = \\frac{-0.4 - (-0.8)}{0.03} = \\frac{0.4}{0.03} = \\frac{40}{3} \\, \\mathrm{s^{-1}} $$\nThe total discrete divergence at cell $P$ is the sum of these two terms:\n$$ (\\nabla \\cdot \\tilde{\\mathbf{u}})_P = 22.5 + \\frac{40}{3} = \\frac{45}{2} + \\frac{40}{3} = \\frac{135 + 80}{6} = \\frac{215}{6} \\, \\mathrm{s^{-1}} $$\nFinally, we compute the per-volume source term $s_P$ using $\\rho = 1.2$ and $\\Delta t = 0.005$:\n$$ s_P = \\frac{\\rho}{\\Delta t} (\\nabla \\cdot \\tilde{\\mathbf{u}})_P = \\left( \\frac{1.2\\,\\mathrm{kg\\,m^{-3}}}{0.005\\,\\mathrm{s}} \\right) \\left( \\frac{215}{6} \\, \\mathrm{s^{-1}} \\right) $$\nThe pre-factor is:\n$$ \\frac{1.2}{0.005} = \\frac{1200}{5} = 240 \\, \\mathrm{kg\\,m^{-3}\\,s^{-1}} $$\nThus, the source term is:\n$$ s_P = 240 \\times \\frac{215}{6} = 40 \\times 215 = 8600 \\, \\mathrm{kg\\,m^{-3}\\,s^{-2}} $$\nThe calculated value is exactly $8600$. The problem requires the answer to be rounded to four significant figures. The number $8600$ can be written unambiguously with four significant figures as $8.600 \\times 10^3$.",
            "answer": "$$\n\\boxed{8.600 \\times 10^3}\n$$"
        },
        {
            "introduction": "While numerical solvers ultimately operate on discrete algebraic equations, a deep comprehension of the underlying continuous problem is essential for robust implementation and debugging. This problem challenges you to derive the governing Pressure Poisson Equation and its associated boundary conditions from first principles for a given analytical velocity field. By working through the analytical solution to this boundary value problem, you will gain crucial insight into how the physical no-penetration constraint at solid walls translates into a mathematical Neumann condition on the pressure field, a concept that is vital for correctly implementing boundary conditions in a CFD code .",
            "id": "3986495",
            "problem": "Consider a two-dimensional incompressible flow in a rectangular cavity domain $\\Omega = \\{(x,y) \\mid 0 \\leq x \\leq L,\\; 0 \\leq y \\leq H\\}$ with impermeable no-slip walls. In a fractional-step incompressible solver of computational fluid dynamics (CFD), a provisional velocity field $\\boldsymbol{u}^{\\ast}(x,y)$ is obtained after advancing the viscous and convective terms. To enforce incompressibility and the wall-normal no-penetration constraint, a pressure-correction step is performed.\n\nYou are given the provisional velocity field components\n$$u^{\\ast}(x,y) = U_{0}\\,\\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\cos\\!\\left(\\frac{2\\pi y}{H}\\right), \\qquad v^{\\ast}(x,y) = V_{0}\\,\\cos\\!\\left(\\frac{2\\pi x}{L}\\right)\\sin\\!\\left(\\frac{\\pi y}{H}\\right),$$\nwhere $U_{0}$ and $V_{0}$ are constants with units of velocity, and $\\rho$ and $\\Delta t$ denote the constant fluid density and the constant time step, respectively.\n\nStarting only from the incompressible kinematic constraint $\\nabla \\cdot \\boldsymbol{u} = 0$, the definition that the corrected velocity is obtained by subtracting the gradient of a pressure-correction field from the provisional velocity, and the physical requirement that the corrected velocity have zero normal component at the solid walls, derive the governing elliptic problem for the pressure-correction field $p(x,y)$ and the associated boundary conditions on $\\partial \\Omega$. Then, solve this problem to obtain a closed-form expression for $p(x,y)$ unique up to an additive constant, and impose the gauge condition that the spatial average of $p$ over $\\Omega$ is zero.\n\nFinally, evaluate $p(x,y)$ at the point $(x,y) = \\left(\\frac{L}{3},\\,\\frac{H}{3}\\right)$ and express your final answer in Pascals. Provide a single closed-form analytic expression in terms of $U_{0}$, $V_{0}$, $L$, $H$, $\\rho$, and $\\Delta t$.",
            "solution": "The problem requires the derivation and solution of a pressure-correction equation, a common step in fractional-step methods for solving the incompressible Navier-Stokes equations.\n\nFirst, we establish the governing equations for the pressure-correction field, which we denote as $p(x,y)$. The corrected velocity field, $\\boldsymbol{u}(x,y)$, must be divergence-free to satisfy the incompressibility constraint:\n$$ \\nabla \\cdot \\boldsymbol{u} = 0 $$\nThe problem states that the corrected velocity is obtained by subtracting the gradient of a scalar field from the provisional velocity field $\\boldsymbol{u}^{\\ast}(x,y)$. Let this scalar potential be $\\phi$. In the context of projection methods, this potential is directly proportional to the pressure-correction field $p$. The relation is given by:\n$$ \\boldsymbol{u} = \\boldsymbol{u}^{\\ast} - \\frac{\\Delta t}{\\rho} \\nabla p $$\nwhere $\\rho$ is the fluid density and $\\Delta t$ is the time step.\n\nSubstituting this expression for $\\boldsymbol{u}$ into the incompressibility constraint gives:\n$$ \\nabla \\cdot \\left( \\boldsymbol{u}^{\\ast} - \\frac{\\Delta t}{\\rho} \\nabla p \\right) = 0 $$\n$$ \\nabla \\cdot \\boldsymbol{u}^{\\ast} - \\frac{\\Delta t}{\\rho} \\nabla \\cdot (\\nabla p) = 0 $$\nThis simplifies to the Poisson equation for the pressure-correction field $p$:\n$$ \\nabla^2 p = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^{\\ast} $$\n\nNext, we derive the boundary conditions for $p$. The physical requirement is that the corrected velocity field has a zero normal component on the impermeable walls of the domain $\\Omega$. This is the no-penetration condition, $\\boldsymbol{u} \\cdot \\boldsymbol{n} = 0$ on $\\partial\\Omega$, where $\\boldsymbol{n}$ is the outward-pointing unit normal vector.\nSubstituting the expression for $\\boldsymbol{u}$:\n$$ \\left( \\boldsymbol{u}^{\\ast} - \\frac{\\Delta t}{\\rho} \\nabla p \\right) \\cdot \\boldsymbol{n} = 0 $$\n$$ \\boldsymbol{u}^{\\ast} \\cdot \\boldsymbol{n} - \\frac{\\Delta t}{\\rho} (\\nabla p \\cdot \\boldsymbol{n}) = 0 $$\nThe term $\\nabla p \\cdot \\boldsymbol{n}$ is the normal derivative of $p$, which we denote as $\\frac{\\partial p}{\\partial n}$. Rearranging gives the Neumann boundary condition for $p$:\n$$ \\frac{\\partial p}{\\partial n} = \\frac{\\rho}{\\Delta t} (\\boldsymbol{u}^{\\ast} \\cdot \\boldsymbol{n}) $$\n\nNow we must compute the source term $\\nabla \\cdot \\boldsymbol{u}^{\\ast}$ and the boundary terms $\\boldsymbol{u}^{\\ast} \\cdot \\boldsymbol{n}$. The provisional velocity components are given as:\n$$ u^{\\ast}(x,y) = U_{0}\\,\\sin\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{2\\pi y}{H}\\right) $$\n$$ v^{\\ast}(x,y) = V_{0}\\,\\cos\\left(\\frac{2\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{H}\\right) $$\nThe divergence is:\n$$ \\nabla \\cdot \\boldsymbol{u}^{\\ast} = \\frac{\\partial u^{\\ast}}{\\partial x} + \\frac{\\partial v^{\\ast}}{\\partial y} $$\n$$ \\frac{\\partial u^{\\ast}}{\\partial x} = U_{0} \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{2\\pi y}{H}\\right) $$\n$$ \\frac{\\partial v^{\\ast}}{\\partial y} = V_{0} \\frac{\\pi}{H} \\cos\\left(\\frac{2\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{H}\\right) $$\nSo, the Poisson equation becomes:\n$$ \\nabla^2 p = \\frac{\\rho}{\\Delta t} \\left[ U_{0} \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{2\\pi y}{H}\\right) + V_{0} \\frac{\\pi}{H} \\cos\\left(\\frac{2\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{H}\\right) \\right] $$\n\nFor the boundary conditions on $\\partial\\Omega = \\{(x,y) \\mid x=0, x=L, y=0, y=H \\}$:\n1.  Left wall ($x=0$): $\\boldsymbol{n} = (-1, 0)$. $\\boldsymbol{u}^{\\ast} \\cdot \\boldsymbol{n} = -u^{\\ast}(0,y) = -U_{0}\\sin(0)\\cos(\\dots) = 0$. Thus, $\\frac{\\partial p}{\\partial x}(0,y) = 0$.\n2.  Right wall ($x=L$): $\\boldsymbol{n} = (1, 0)$. $\\boldsymbol{u}^{\\ast} \\cdot \\boldsymbol{n} = u^{\\ast}(L,y) = U_{0}\\sin(\\pi)\\cos(\\dots) = 0$. Thus, $\\frac{\\partial p}{\\partial x}(L,y) = 0$.\n3.  Bottom wall ($y=0$): $\\boldsymbol{n} = (0, -1)$. $\\boldsymbol{u}^{\\ast} \\cdot \\boldsymbol{n} = -v^{\\ast}(x,0) = -V_{0}\\cos(\\dots)\\sin(0) = 0$. Thus, $\\frac{\\partial p}{\\partial y}(x,0) = 0$.\n4.  Top wall ($y=H$): $\\boldsymbol{n} = (0, 1)$. $\\boldsymbol{u}^{\\ast} \\cdot \\boldsymbol{n} = v^{\\ast}(x,H) = V_{0}\\cos(\\dots)\\sin(\\pi) = 0$. Thus, $\\frac{\\partial p}{\\partial y}(x,H) = 0$.\n\nWe have a Poisson equation with homogeneous Neumann boundary conditions: $\\frac{\\partial p}{\\partial n} = 0$ on all boundaries.\nThe problem is to solve:\n$$ \\nabla^2 p = S(x,y) $$\n$$ \\frac{\\partial p}{\\partial n} |_{\\partial \\Omega} = 0 $$\nwhere $S(x,y) = \\frac{\\rho \\pi}{\\Delta t} \\left[ \\frac{U_{0}}{L} \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{2\\pi y}{H}\\right) + \\frac{V_{0}}{H} \\cos\\left(\\frac{2\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{H}\\right) \\right]$.\n\nGiven the form of the source term, we propose a solution of the form:\n$$ p(x,y) = C_{1} \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{2\\pi y}{H}\\right) + C_{2} \\cos\\left(\\frac{2\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{H}\\right) + C_{3} $$\nwhere $C_1, C_2$ are constants to be determined and $C_3$ is an integration constant. This form automatically satisfies the homogeneous Neumann boundary conditions. We calculate the Laplacian of this ansatz:\n$$ \\nabla^2 p = \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial y^2} $$\n$$ \\frac{\\partial^2 p}{\\partial x^2} = -C_{1} \\left(\\frac{\\pi}{L}\\right)^2 \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{2\\pi y}{H}\\right) - C_{2} \\left(\\frac{2\\pi}{L}\\right)^2 \\cos\\left(\\frac{2\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{H}\\right) $$\n$$ \\frac{\\partial^2 p}{\\partial y^2} = -C_{1} \\left(\\frac{2\\pi}{H}\\right)^2 \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{2\\pi y}{H}\\right) - C_{2} \\left(\\frac{\\pi}{H}\\right)^2 \\cos\\left(\\frac{2\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{H}\\right) $$\nSumming these gives:\n$$ \\nabla^2 p = -C_{1} \\left[ \\left(\\frac{\\pi}{L}\\right)^2 + \\left(\\frac{2\\pi}{H}\\right)^2 \\right] \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{2\\pi y}{H}\\right) - C_{2} \\left[ \\left(\\frac{2\\pi}{L}\\right)^2 + \\left(\\frac{\\pi}{H}\\right)^2 \\right] \\cos\\left(\\frac{2\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{H}\\right) $$\nBy equating the coefficients of the basis functions in the expressions for $\\nabla^2 p$ and $S(x,y)$, we solve for $C_1$ and $C_2$:\nFor the first term:\n$$ -C_{1} \\pi^2 \\left( \\frac{1}{L^2} + \\frac{4}{H^2} \\right) = \\frac{\\rho \\pi U_{0}}{L \\Delta t} \\implies C_{1} = -\\frac{\\rho U_{0}}{L \\pi \\Delta t} \\frac{1}{\\frac{H^2+4L^2}{L^2 H^2}} = -\\frac{\\rho U_{0} L H^2}{\\pi \\Delta t (H^2 + 4L^2)} $$\nFor the second term:\n$$ -C_{2} \\pi^2 \\left( \\frac{4}{L^2} + \\frac{1}{H^2} \\right) = \\frac{\\rho \\pi V_{0}}{H \\Delta t} \\implies C_{2} = -\\frac{\\rho V_{0}}{H \\pi \\Delta t} \\frac{1}{\\frac{4H^2+L^2}{L^2 H^2}} = -\\frac{\\rho V_{0} H L^2}{\\pi \\Delta t (4H^2 + L^2)} $$\n\nThe solution for $p$ is unique up to an additive constant $C_3$. The gauge condition that the spatial average of $p$ over $\\Omega$ is zero is imposed to fix this constant:\n$$ \\frac{1}{LH} \\int_0^L \\int_0^H p(x,y) \\,dy\\,dx = 0 $$\nThe integrals of the cosine terms over their respective periods (or integer multiples) are zero:\n$$ \\int_0^L \\cos\\left(\\frac{\\pi x}{L}\\right) dx = 0, \\quad \\int_0^L \\cos\\left(\\frac{2\\pi x}{L}\\right) dx = 0, \\quad \\int_0^H \\cos\\left(\\frac{2\\pi y}{H}\\right) dy = 0, \\quad \\int_0^H \\cos\\left(\\frac{\\pi y}{H}\\right) dy = 0. $$\nThis implies that the average of the first two terms in $p(x,y)$ is zero. Therefore, the average of $p(x,y)$ is:\n$$ \\frac{1}{LH} \\int_0^L \\int_0^H C_{3} \\,dy\\,dx = \\frac{C_3 LH}{LH} = C_3 $$\nThe gauge condition requires $C_3=0$. The unique solution is:\n$$ p(x,y) = -\\frac{\\rho U_{0} L H^2}{\\pi \\Delta t (H^2 + 4L^2)} \\cos\\left(\\frac{\\pi x}{L}\\right)\\cos\\left(\\frac{2\\pi y}{H}\\right) - \\frac{\\rho V_{0} H L^2}{\\pi \\Delta t (4H^2 + L^2)} \\cos\\left(\\frac{2\\pi x}{L}\\right)\\cos\\left(\\frac{\\pi y}{H}\\right) $$\n\nFinally, we evaluate $p(x,y)$ at the point $(x,y) = \\left(\\frac{L}{3}, \\frac{H}{3}\\right)$:\n$$ \\cos\\left(\\frac{\\pi}{L} \\cdot \\frac{L}{3}\\right) = \\cos\\left(\\frac{\\pi}{3}\\right) = \\frac{1}{2} $$\n$$ \\cos\\left(\\frac{2\\pi}{H} \\cdot \\frac{H}{3}\\right) = \\cos\\left(\\frac{2\\pi}{3}\\right) = -\\frac{1}{2} $$\n$$ \\cos\\left(\\frac{2\\pi}{L} \\cdot \\frac{L}{3}\\right) = \\cos\\left(\\frac{2\\pi}{3}\\right) = -\\frac{1}{2} $$\n$$ \\cos\\left(\\frac{\\pi}{H} \\cdot \\frac{H}{3}\\right) = \\cos\\left(\\frac{\\pi}{3}\\right) = \\frac{1}{2} $$\nSubstituting these values:\n$$ p\\left(\\frac{L}{3}, \\frac{H}{3}\\right) = C_1 \\left(\\frac{1}{2}\\right)\\left(-\\frac{1}{2}\\right) + C_2 \\left(-\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = -\\frac{1}{4} (C_1 + C_2) $$\n$$ p\\left(\\frac{L}{3}, \\frac{H}{3}\\right) = -\\frac{1}{4} \\left[ -\\frac{\\rho U_{0} L H^2}{\\pi \\Delta t (H^2 + 4L^2)} - \\frac{\\rho V_{0} H L^2}{\\pi \\Delta t (4H^2 + L^2)} \\right] $$\n$$ p\\left(\\frac{L}{3}, \\frac{H}{3}\\right) = \\frac{\\rho}{4\\pi\\Delta t} \\left[ \\frac{U_{0} L H^2}{H^2 + 4L^2} + \\frac{V_{0} H L^2}{4H^2 + L^2} \\right] $$\nThis is the final analytical expression for the pressure correction at the specified point.",
            "answer": "$$\\boxed{\\frac{\\rho}{4\\pi\\Delta t} \\left( \\frac{U_{0} L H^2}{H^2 + 4L^2} + \\frac{V_{0} H L^2}{4H^2 + L^2} \\right)}$$"
        },
        {
            "introduction": "A major challenge in modern solvers that use a collocated grid arrangement—where pressure and velocity are stored at the same locations—is the potential for non-physical pressure oscillations, a phenomenon known as pressure-velocity decoupling. This advanced exercise tackles the Rhie-Chow interpolation scheme, the most common and effective remedy for this numerical artifact. This practice demystifies this crucial technique by guiding you through a concrete calculation that demonstrates how a carefully constructed face velocity ensures that mass fluxes remain tightly coupled to the pressure gradient, thereby maintaining solution stability and accuracy .",
            "id": "3986482",
            "problem": "Consider a one-dimensional collocated finite volume discretization of steady, laminar, incompressible flow along the Cartesian coordinate $x$ with uniform control volumes of size $\\Delta x$ and unit face area $A$. The flow is aligned with the $x$-axis, and the face-normal vector points in the positive $x$-direction. The computational task is to compute a single interior face mass flux using Rhie–Chow momentum interpolation so that pressure–velocity decoupling is avoided.\n\nStarting from the conservation of mass and the steady, incompressible momentum balance in one dimension,\n- continuity: $\\frac{d u}{d x} = 0$,\n- momentum: $\\rho u \\frac{d u}{d x} = -\\frac{d p}{d x} + \\mu \\frac{d^{2} u}{d x^{2}}$,\nand using a central-difference, collocated Finite Volume Method (FVM) discretization on a uniform mesh, derive the face-velocity expression that is consistent with Rhie–Chow momentum interpolation. Assume that the momentum equation has been linearized and under-relaxed with a velocity under-relaxation factor $\\alpha_{u}$, so that the under-relaxed diagonal coefficient for cell $P$ is $a_{P}^{u} = a_{P}/\\alpha_{u}$, where $a_{P}$ is the unrelaxed diagonal arising from the diffusion operator on a uniform grid. Use the under-relaxed momentum diagonal to construct the Rhie–Chow pressure–velocity coupling coefficient at the face $f$ between two adjacent cells $P$ and $E$ by averaging the neighboring under-relaxed diagonals symmetrically, and use this to close the face-velocity expression consistent with the half-control-volume momentum balance. Treat the given cell-centered pseudo-velocities as those obtained by solving the momentum equation without the pressure-gradient term.\n\nData for the specific face $f$ between cells $P$ and $E$:\n- uniform spacing $\\Delta x = 0.1\\,\\mathrm{m}$,\n- face area $A = 1\\,\\mathrm{m}^{2}$,\n- density $\\rho = 1.0\\,\\mathrm{kg/m^{3}}$,\n- dynamic viscosity $\\mu = 10\\,\\mathrm{Pa\\cdot s}$,\n- velocity under-relaxation $\\alpha_{u} = 0.7$,\n- pseudo-velocities at adjacent cell centers $u_{P}^{*} = 0.08\\,\\mathrm{m/s}$ and $u_{E}^{*} = 0.04\\,\\mathrm{m/s}$,\n- cell-centered pressures $p_{P} = 101325\\,\\mathrm{Pa}$ and $p_{E} = 101305\\,\\mathrm{Pa}$.\n\nCompute the Rhie–Chow-interpolated face mass flux $\\phi_{f} = \\rho\\,u_{f}\\,A$ at face $f$ in the positive $x$-direction. Express your final answer in $\\mathrm{kg/s}$ and round your answer to four significant figures.",
            "solution": "The user wants to compute the face mass flux at a specific face $f$ using the Rhie–Chow momentum interpolation method.\n\n### Step 1: Extract Givens\n- **Governing Equations (1D, steady, incompressible):**\n  - Continuity: $\\frac{d u}{d x} = 0$\n  - Momentum: $\\rho u \\frac{d u}{d x} = -\\frac{d p}{d x} + \\mu \\frac{d^{2} u}{d x^{2}}$\n- **Discretization Scheme:**\n  - One-dimensional collocated Finite Volume Method (FVM).\n  - Uniform control volumes of size $\\Delta x$.\n  - Central-difference scheme.\n- **Problem-Specific Assumptions:**\n  - The momentum equation is linearized and under-relaxed with a velocity under-relaxation factor $\\alpha_u$.\n  - The under-relaxed diagonal coefficient for cell $P$ is $a_{P}^{u} = a_{P}/\\alpha_{u}$.\n  - The unrelaxed diagonal coefficient $a_{P}$ arises solely from the diffusion operator on a uniform grid.\n  - The Rhie–Chow pressure–velocity coupling coefficient is constructed by symmetrically averaging the neighboring under-relaxed diagonals.\n  - Pseudo-velocities ($u_P^*$, $u_E^*$) are obtained by solving the momentum equation without the pressure-gradient term.\n- **Numerical Data:**\n  - Uniform spacing: $\\Delta x = 0.1\\,\\mathrm{m}$\n  - Face area: $A = 1\\,\\mathrm{m}^{2}$\n  - Density: $\\rho = 1.0\\,\\mathrm{kg/m^{3}}$\n  - Dynamic viscosity: $\\mu = 10\\,\\mathrm{Pa\\cdot s}$\n  - Velocity under-relaxation factor: $\\alpha_{u} = 0.7$\n  - Pseudo-velocity at cell center P: $u_{P}^{*} = 0.08\\,\\mathrm{m/s}$\n  - Pseudo-velocity at cell center E: $u_{E}^{*} = 0.04\\,\\mathrm{m/s}$\n  - Pressure at cell center P: $p_{P} = 101325\\,\\mathrm{Pa}$\n  - Pressure at cell center E: $p_{E} = 101305\\,\\mathrm{Pa}$\n- **Target Quantity:**\n  - Face mass flux $\\phi_{f} = \\rho\\,u_{f}\\,A$ at face $f$ between cells $P$ and $E$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on the fundamental Navier-Stokes equations and a well-established numerical method (FVM with Rhie-Chow interpolation) for computational fluid dynamics. The physics and mathematics are sound.\n- **Well-Posed:** All necessary data, boundary conditions (implicitly through cell values), and constitutive parameters are provided. The problem is structured to have a unique, computable solution.\n- **Objective:** The language is precise and technical. All terms are standard within the field of CFD.\n\nThe problem is a classic, self-contained numerical exercise in CFD. It is free from any scientific flaws, ambiguities, or contradictions.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Solution Derivation\n\nThe primary goal is to compute the mass flux $\\phi_f$ at the face $f$ located between two cell centers, $P$ and $E$. The mass flux is defined as $\\phi_f = \\rho u_f A$. To find $\\phi_f$, we must first determine the face velocity $u_f$ using Rhie–Chow interpolation.\n\nThe discretized momentum equation at a cell center, say $P$, can be generically written in an under-relaxed form as:\n$$ a_P^u u_P = H_P - V_P (\\nabla p)_P $$\nwhere $a_P^u$ is the under-relaxed diagonal coefficient, $H_P$ contains the contributions from neighboring velocities and source terms, $V_P$ is the cell volume, and $(\\nabla p)_P$ is the pressure gradient at the cell center.\n\nThe problem defines the pseudo-velocity $u_P^*$ as the solution to the momentum equation without the pressure gradient term:\n$$ a_P^u u_P^* = H_P $$\nSubstituting this back into the full momentum equation gives an expression for the cell-centered velocity:\n$$ u_P = u_P^* - \\frac{V_P}{a_P^u} (\\nabla p)_P $$\nThe Rhie–Chow interpolation scheme constructs the face velocity $u_f$ by interpolating the pseudo-velocities and applying a specially formulated pressure correction term. The expression for the face velocity $u_f$ is:\n$$ u_f = \\overline{u_f^*} - \\overline{\\left(\\frac{V}{a^u}\\right)_f} (\\nabla p)_f $$\nHere, the terms are defined as follows for the face $f$ between cells $P$ and $E$:\n1.  The interpolated pseudo-velocity, $\\overline{u_f^*}$, is the linear average of the cell-centered pseudo-velocities:\n    $$ \\overline{u_f^*} = \\frac{u_P^* + u_E^*}{2} $$\n2.  The pressure gradient at the face, $(\\nabla p)_f$, is approximated using a central difference:\n    $$ (\\nabla p)_f = \\frac{p_E - p_P}{\\Delta x} $$\n3.  The interpolated pressure-velocity coupling coefficient, $\\overline{\\left(\\frac{V}{a^u}\\right)_f}$, is the arithmetic mean of the cell-level coefficients:\n    $$ \\overline{\\left(\\frac{V}{a^u}\\right)_f} = \\frac{1}{2} \\left(\\frac{V_P}{a_P^u} + \\frac{V_E}{a_E^u}\\right) $$\nFor a uniform one-dimensional grid, the cell volume is $V_P = V_E = V = A \\Delta x$. The problem also specifies a uniform grid and constant properties, which implies that the diagonal coefficients are equal, $a_P = a_E$, and thus $a_P^u = a_E^u$. The coupling coefficient simplifies to:\n$$ \\overline{\\left(\\frac{V}{a^u}\\right)_f} = \\frac{V_P}{a_P^u} = \\frac{A \\Delta x}{a_P^u} $$\nSubstituting these into the face velocity equation:\n$$ u_f = \\frac{u_P^* + u_E^*}{2} - \\left(\\frac{A \\Delta x}{a_P^u}\\right) \\left(\\frac{p_E - p_P}{\\Delta x}\\right) = \\frac{u_P^* + u_E^*}{2} - \\frac{A}{a_P^u} (p_E - p_P) $$\nTo proceed, we must calculate the unrelaxed diagonal coefficient $a_P$. The problem states that $a_P$ arises from the diffusion operator, $\\mu \\frac{d^2 u}{dx^2}$, discretized using a central-difference finite-volume method. The integral of the diffusion term over the control volume $V_P$ (from face $w$ to face $e$) is:\n$$ \\int_{V_P} \\nabla \\cdot (\\mu \\nabla u) \\,dV = (\\mu A \\frac{du}{dx})_e - (\\mu A \\frac{du}{dx})_w $$\nUsing central differences for the gradients at the faces:\n$$ \\mu A \\left(\\frac{u_E - u_P}{\\Delta x}\\right) - \\mu A \\left(\\frac{u_P - u_W}{\\Delta x}\\right) = \\frac{\\mu A}{\\Delta x} u_E + \\frac{\\mu A}{\\Delta x} u_W - \\frac{2\\mu A}{\\Delta x} u_P $$\nIn the standard FVM formulation $a_P u_P = \\sum a_{nb} u_{nb} + S_u$, we have $a_E = \\frac{\\mu A}{\\Delta x}$, $a_W = \\frac{\\mu A}{\\Delta x}$, and $a_P = a_E + a_W$ (for a source-free diffusion-only problem, ensuring conservation). Thus, the unrelaxed diagonal coefficient is:\n$$ a_P = \\frac{2\\mu A}{\\Delta x} $$\nNow, we can substitute the given numerical values:\n$\\mu = 10\\,\\mathrm{Pa\\cdot s}$, $A = 1\\,\\mathrm{m}^2$, $\\Delta x = 0.1\\,\\mathrm{m}$.\n$$ a_P = \\frac{2(10)(1)}{0.1} = 200\\,\\mathrm{kg/s} $$\nThe under-relaxed diagonal coefficient $a_P^u$ is calculated using the given under-relaxation factor $\\alpha_u = 0.7$:\n$$ a_P^u = \\frac{a_P}{\\alpha_u} = \\frac{200}{0.7}\\,\\mathrm{kg/s} $$\nWe now have all the components to calculate $u_f$:\n- $u_P^* = 0.08\\,\\mathrm{m/s}$, $u_E^* = 0.04\\,\\mathrm{m/s}$\n- $p_P = 101325\\,\\mathrm{Pa}$, $p_E = 101305\\,\\mathrm{Pa}$\n- $A = 1\\,\\mathrm{m}^2$\n\nFirst, calculate the interpolated pseudo-velocity:\n$$ \\overline{u_f^*} = \\frac{0.08 + 0.04}{2} = 0.06\\,\\mathrm{m/s} $$\nNext, calculate the pressure difference:\n$$ p_E - p_P = 101305 - 101325 = -20\\,\\mathrm{Pa} $$\nNow substitute these values into the expression for $u_f$:\n$$ u_f = 0.06 - \\frac{1}{200/0.7} (-20) = 0.06 - \\frac{0.7}{200}(-20) = 0.06 - (-0.07) = 0.06 + 0.07 = 0.13\\,\\mathrm{m/s} $$\nFinally, compute the face mass flux $\\phi_f$:\n$$ \\phi_f = \\rho u_f A = (1.0\\,\\mathrm{kg/m^3})(0.13\\,\\mathrm{m/s})(1\\,\\mathrm{m}^2) = 0.13\\,\\mathrm{kg/s} $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\phi_f = 0.1300\\,\\mathrm{kg/s} $$",
            "answer": "$$\n\\boxed{0.1300}\n$$"
        }
    ]
}