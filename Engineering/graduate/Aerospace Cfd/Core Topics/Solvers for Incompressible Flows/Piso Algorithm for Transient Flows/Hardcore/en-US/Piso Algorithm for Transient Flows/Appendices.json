{
    "hands_on_practices": [
        {
            "introduction": "In the PISO algorithm, the momentum predictor step generates a velocity field that satisfies momentum conservation but typically violates mass conservation and specified boundary fluxes. This exercise provides a concrete example of how to enforce global conservation laws after the predictor step . You will practice a common technique for correcting boundary face velocities to ensure that a specified volumetric flow rate is precisely matched, a crucial step for the physical accuracy of any CFD simulation.",
            "id": "3984960",
            "problem": "Consider a transient, incompressible flow advanced with the Pressure-Implicit with Splitting of Operators (PISO) algorithm. The momentum predictor yields face-normal velocities that do not, in general, satisfy the integral inlet condition when the inlet boundary condition specifies a total volumetric flow rate rather than a pointwise velocity distribution. Let the fluid have constant density and consider a single inlet boundary subdivided by the mesh into $4$ planar faces with outward-pointing area vectors aligned with the geometric normal. The inlet faces have areas $A_{1}=0.015\\,\\mathrm{m}^{2}$, $A_{2}=0.020\\,\\mathrm{m}^{2}$, $A_{3}=0.020\\,\\mathrm{m}^{2}$, and $A_{4}=0.015\\,\\mathrm{m}^{2}$. After the momentum predictor at time level $t^{n+1}$, the predicted face-normal velocities into the domain are $u_{1}^{\\ast}=12.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $u_{2}^{\\ast}=9.8\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $u_{3}^{\\ast}=7.2\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, and $u_{4}^{\\ast}=10.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$. The specified inlet volumetric flow rate is $Q_{\\mathrm{in}}=0.700\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$, defined as the integral of the normal velocity over the inlet.\n\nAssume that, after one pressure-correction step of the PISO algorithm has enforced discrete continuity in the interior control volumes, the remaining boundary inconsistency is resolved by correcting only the inlet face-normal velocities in a shape-preserving manner: the corrected inlet velocities are constrained to be proportional to the predicted profile, i.e., $u_{i}^{\\mathrm{corr}}=\\beta\\,u_{i}^{\\ast}$ with a single scalar $\\beta$ applied uniformly to all inlet faces. Using fundamental mass conservation, determine the value of the scalar $\\beta$ that enforces the specified inlet volumetric flow rate exactly at time level $t^{n+1}$.\n\nReport the dimensionless scaling factor $\\beta$ rounded to five significant figures. Do not include units in your final boxed answer.",
            "solution": "The user wants me to solve the provided problem by first validating its premises and then, if valid, providing a detailed solution.\n\n### Step 1: Extract Givens\n- **Flow type**: Transient, incompressible.\n- **Algorithm**: PISO (Pressure-Implicit with Splitting of Operators).\n- **Fluid property**: Constant density.\n- **Inlet faces**: $4$ planar faces.\n- **Face areas**: $A_{1}=0.015\\,\\mathrm{m}^{2}$, $A_{2}=0.020\\,\\mathrm{m}^{2}$, $A_{3}=0.020\\,\\mathrm{m}^{2}$, $A_{4}=0.015\\,\\mathrm{m}^{2}$.\n- **Predicted face-normal velocities (into domain)**: $u_{1}^{\\ast}=12.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $u_{2}^{\\ast}=9.8\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $u_{3}^{\\ast}=7.2\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $u_{4}^{\\ast}=10.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n- **Specified inlet volumetric flow rate**: $Q_{\\mathrm{in}}=0.700\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$.\n- **Correction constraint**: Corrected face-normal velocities are $u_{i}^{\\mathrm{corr}}=\\beta\\,u_{i}^{\\ast}$, where $\\beta$ is a uniform scalar.\n- **Objective**: Determine the value of the scalar $\\beta$.\n- **Reporting requirement**: Report $\\beta$ rounded to five significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it describes a standard and practical method for enforcing fixed-flux boundary conditions within pressure-correction based CFD algorithms like PISO. The enforcement of global mass conservation by scaling local fluxes is a common technique. The problem is well-posed; it provides all necessary data and a clear constraint, leading to a unique solution for the unknown $\\beta$. The language is objective and employs standard terminology from the field of computational fluid dynamics. The physical and numerical values are realistic. The problem does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\nThe fundamental principle to be applied is the conservation of mass, expressed in terms of volumetric flow rate. The total volumetric flow rate, $Q$, through a boundary composed of a discrete set of faces is the sum of the flow rates through each individual face. The flow rate through a single face $i$ is the product of the face area, $A_i$, and the component of the velocity normal to the face, $u_i$. By convention in this problem, velocities directed into the domain are positive, so the total inlet flow rate is given by:\n$Q = \\sum_{i} u_{i} A_{i}$\nFirst, we calculate the total volumetric flow rate based on the predicted face-normal velocities, $u_{i}^{\\ast}$. Let this be denoted by $Q^{\\ast}$. The inlet boundary consists of $4$ faces, so the sum is from $i=1$ to $4$:\n$Q^{\\ast} = \\sum_{i=1}^{4} u_{i}^{\\ast} A_{i} = u_{1}^{\\ast}A_{1} + u_{2}^{\\ast}A_{2} + u_{3}^{\\ast}A_{3} + u_{4}^{\\ast}A_{4}$\nSubstituting the given values:\n- For face $1$: $u_{1}^{\\ast}A_{1} = (12.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (0.015\\,\\mathrm{m}^{2}) = 0.1875\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$\n- For face $2$: $u_{2}^{\\ast}A_{2} = (9.8\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (0.020\\,\\mathrm{m}^{2}) = 0.1960\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$\n- For face $3$: $u_{3}^{\\ast}A_{3} = (7.2\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (0.020\\,\\mathrm{m}^{2}) = 0.1440\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$\n- For face $4$: $u_{4}^{\\ast}A_{4} = (10.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (0.015\\,\\mathrm{m}^{2}) = 0.1575\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$\n\nSumming these individual flow rates gives the total predicted flow rate $Q^{\\ast}$:\n$Q^{\\ast} = 0.1875 + 0.1960 + 0.1440 + 0.1575 = 0.6850\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$\nThis predicted flow rate does not match the specified inlet flow rate, $Q_{\\mathrm{in}}=0.700\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$. To enforce the specified flow rate, the velocities must be corrected. The problem specifies a shape-preserving correction of the form $u_{i}^{\\mathrm{corr}}=\\beta\\,u_{i}^{\\ast}$, where $\\beta$ is a single scaling factor applied to all inlet faces.\n\nThe corrected volumetric flow rate, $Q_{\\mathrm{corr}}$, must be equal to the specified inlet flow rate, $Q_{\\mathrm{in}}$. We can express $Q_{\\mathrm{corr}}$ in terms of the corrected velocities:\n$Q_{\\mathrm{corr}} = \\sum_{i=1}^{4} u_{i}^{\\mathrm{corr}} A_{i}$\nSubstituting the correction relation $u_{i}^{\\mathrm{corr}}=\\beta\\,u_{i}^{\\ast}$ into this equation:\n$Q_{\\mathrm{corr}} = \\sum_{i=1}^{4} (\\beta u_{i}^{\\ast}) A_{i}$\nSince $\\beta$ is a constant scalar, it can be factored out of the summation:\n$Q_{\\mathrm{corr}} = \\beta \\left( \\sum_{i=1}^{4} u_{i}^{\\ast} A_{i} \\right)$\nThe term in the parentheses is the predicted flow rate, $Q^{\\ast}$. Thus, we have the relationship:\n$Q_{\\mathrm{corr}} = \\beta Q^{\\ast}$\nTo satisfy the boundary condition, we must have $Q_{\\mathrm{corr}} = Q_{\\mathrm{in}}$. Therefore:\n$Q_{\\mathrm{in}} = \\beta Q^{\\ast}$\nWe can now solve for the scaling factor $\\beta$:\n$\\beta = \\frac{Q_{\\mathrm{in}}}{Q^{\\ast}}$\nSubstituting the numerical values for $Q_{\\mathrm{in}}$ and the calculated $Q^{\\ast}$:\n$\\beta = \\frac{0.700\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}}{0.685\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}} = \\frac{0.700}{0.685}$\nPerforming the division gives:\n$\\beta \\approx 1.0218978102...$\nThe problem requires the answer to be reported rounded to five significant figures. The first five significant figures are $1$, $0$, $2$, $1$, and $8$. The sixth significant figure is $9$. Since $9 \\ge 5$, we round up the fifth significant figure, which is $8$, to $9$.\nTherefore, the value of $\\beta$ rounded to five significant figures is $1.0219$.",
            "answer": "$$\\boxed{1.0219}$$"
        },
        {
            "introduction": "Real-world engineering applications often require meshes that are non-orthogonal, where the vector connecting two cell centers is not aligned with the normal vector of their shared face. This geometric complexity introduces a \"non-orthogonal error\" in the standard approximation of the pressure gradient, which can compromise the accuracy of the solution. This practice delves into the mathematical formulation of the non-orthogonal correction within the PISO algorithm, showing how the pressure gradient is decomposed to maintain accuracy on distorted grids . Mastering this calculation is essential for understanding how modern finite-volume solvers remain robust and accurate for complex geometries.",
            "id": "3984994",
            "problem": "Consider a two-dimensional incompressible transient flow solved using the Pressure-Implicit with Splitting of Operators (PISO) algorithm in Computational Fluid Dynamics (CFD). Focus on a single interior face shared by two neighboring control volumes, cell $P$ and cell $N$, in a distorted quadrilateral mesh. The cell centers are at $\\boldsymbol{x}_{P} = (0, 0)\\,\\text{m}$ and $\\boldsymbol{x}_{N} = (1.0, 0.2)\\,\\text{m}$. The shared face has endpoints at $(0.5, -0.3)\\,\\text{m}$ and $(0.5, 0.5)\\,\\text{m}$, so its length is $0.8\\,\\text{m}$ and its outward area vector from cell $P$ is $\\boldsymbol{S}_{f} = (0.8, 0)\\,\\text{m}^{2}$. Let $\\boldsymbol{n}_{f} = \\boldsymbol{S}_{f} / \\|\\boldsymbol{S}_{f}\\| = (1, 0)$ denote the unit normal at the face, pointing from cell $P$ to cell $N$. The vector connecting the cell centers is $\\boldsymbol{d} = \\boldsymbol{x}_{N} - \\boldsymbol{x}_{P}$.\n\nAssume the following field values at the current PISO iteration:\n- Constant density $\\rho = 1.2\\,\\text{kg}\\,\\text{m}^{-3}$.\n- Time step $\\Delta t = 1.0 \\times 10^{-3}\\,\\text{s}$.\n- Cell pressures $p_{P} = 102000\\,\\text{Pa}$ and $p_{N} = 101000\\,\\text{Pa}$.\n- Predicted velocities (momentum predictor) $\\boldsymbol{u}^{*}_{P} = (2.0, 0.0)\\,\\text{m}\\,\\text{s}^{-1}$ and $\\boldsymbol{u}^{*}_{N} = (1.5, 0.2)\\,\\text{m}\\,\\text{s}^{-1}$.\n- Reconstructed cell pressure gradients from a least-squares procedure $\\left(\\nabla p\\right)_{P} = (-900,\\, 200)\\,\\text{Pa}\\,\\text{m}^{-1}$ and $\\left(\\nabla p\\right)_{N} = (-1100,\\, 300)\\,\\text{Pa}\\,\\text{m}^{-1}$.\n\nStarting from the integral forms of continuity and momentum and invoking Gauss’s theorem (divergence theorem), construct the non-orthogonally corrected approximation of the face-normal pressure gradient using a decomposition into directions normal and tangential to $\\boldsymbol{d}$. Specifically, decompose the face-normal projection of $\\nabla p$ into an orthogonal part tied to the center-to-center difference $p_{N} - p_{P}$ along $\\boldsymbol{d}$ and a non-orthogonal correction based on the reconstructed gradient interpolated to the face. Use linear interpolation for both the predicted velocity and reconstructed pressure gradient at the face center.\n\nThen, using the predictor-corrector form that follows from Newton’s second law applied to a control volume, estimate the face velocity as $\\boldsymbol{u}_{f} = \\boldsymbol{u}^{*}_{f} - \\frac{\\Delta t}{\\rho}\\left(\\nabla p\\right)_{f}$ and compute the corresponding mass flux through the face, $\\dot{m}_{f} = \\rho\\,\\boldsymbol{u}_{f} \\cdot \\boldsymbol{S}_{f}$.\n\nRound your final numeric answer for the face mass flux to four significant figures. Express the final mass flux in $\\text{kg}\\,\\text{s}^{-1}$.",
            "solution": "The objective is to compute a non-orthogonally corrected face-normal pressure gradient and then use it in the Pressure-Implicit with Splitting of Operators (PISO) face velocity to obtain the mass flux. We proceed from the finite-volume foundations, using Gauss’s theorem and vector decompositions.\n\nFirst, set up the geometry. The center-to-center vector and its norm and unit vector are\n$$\n\\boldsymbol{d} = \\boldsymbol{x}_{N} - \\boldsymbol{x}_{P} = (1.0,\\,0.2), \\quad\n\\|\\boldsymbol{d}\\| = \\sqrt{(1.0)^{2} + (0.2)^{2}} = \\sqrt{1.04}, \\quad\n\\hat{\\boldsymbol{d}} = \\frac{\\boldsymbol{d}}{\\|\\boldsymbol{d}\\|}.\n$$\nNumerically,\n$$\n\\|\\boldsymbol{d}\\| = 1.019803902718557, \\quad\n\\hat{\\boldsymbol{d}} = \\left(0.980580675690920,\\,0.196116135138184\\right).\n$$\nThe face area vector and face unit normal (pointing from $P$ to $N$) are\n$$\n\\boldsymbol{S}_{f} = (0.8,\\,0), \\quad \\boldsymbol{n}_{f} = (1,\\,0).\n$$\n\nTo construct the non-orthogonal pressure gradient at the face, we use a decomposition of the face-normal projection. For any vector $\\boldsymbol{a}$,\n$$\n\\boldsymbol{a}\\cdot \\boldsymbol{n}_{f} = (\\boldsymbol{a}\\cdot \\hat{\\boldsymbol{d}})\\,(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f}) + \\boldsymbol{a}\\cdot\\left(\\boldsymbol{n}_{f} - \\hat{\\boldsymbol{d}}(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f})\\right).\n$$\nApplying this to $\\boldsymbol{a} = \\left(\\nabla p\\right)_{f}$ and replacing the center-to-center directional derivative by the finite-volume approximation,\n$$\n\\left(\\nabla p\\right)_{f}\\cdot \\hat{\\boldsymbol{d}} \\approx \\frac{p_{N} - p_{P}}{\\|\\boldsymbol{d}\\|},\n$$\nwe obtain the non-orthogonally corrected face-normal pressure gradient as\n$$\n\\left(\\nabla p\\right)_{f}\\cdot \\boldsymbol{n}_{f} \\approx \\frac{p_{N} - p_{P}}{\\|\\boldsymbol{d}\\|}\\,(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f})\n+ \\left(\\nabla p\\right)_{f}\\cdot\\left(\\boldsymbol{n}_{f} - \\hat{\\boldsymbol{d}}(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f})\\right).\n$$\nWe take $\\left(\\nabla p\\right)_{f}$ by linear interpolation of the reconstructed gradients:\n$$\n\\left(\\nabla p\\right)_{f} = \\frac{\\left(\\nabla p\\right)_{P} + \\left(\\nabla p\\right)_{N}}{2} = \\frac{(-900,\\,200) + (-1100,\\,300)}{2} = (-1000,\\,250)\\,\\text{Pa}\\,\\text{m}^{-1}.\n$$\nCompute the geometric scalars and vectors needed:\n$$\n\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f} = 0.980580675690920,\n$$\n$$\n\\hat{\\boldsymbol{d}}(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f}) = \\left(0.980580675690920,\\,0.196116135138184\\right)\\,(0.980580675690920)\n= \\left(0.961538461538462,\\,0.192307692307692\\right),\n$$\n$$\n\\boldsymbol{n}_{f} - \\hat{\\boldsymbol{d}}(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f}) = \\left(1,\\,0\\right) - \\left(0.961538461538462,\\,0.192307692307692\\right)\n= \\left(0.038461538461538,\\,-0.192307692307692\\right).\n$$\nNow evaluate the orthogonal and non-orthogonal contributions. The orthogonal part is\n$$\n\\frac{p_{N} - p_{P}}{\\|\\boldsymbol{d}\\|}\\,(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f})\n= \\frac{101000 - 102000}{1.019803902718557}\\,(0.980580675690920)\n= (-980.580675690920)\\,(0.980580675690920)\n= -961.538461538462\\,\\text{Pa}\\,\\text{m}^{-1}.\n$$\nThe non-orthogonal correction is\n$$\n\\left(\\nabla p\\right)_{f}\\cdot\\left(\\boldsymbol{n}_{f} - \\hat{\\boldsymbol{d}}(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f})\\right)\n= (-1000,\\,250)\\cdot\\left(0.038461538461538,\\,-0.192307692307692\\right)\n= -38.461538461538 - 48.076923076923\n= -86.538461538462\\,\\text{Pa}\\,\\text{m}^{-1}.\n$$\nThus the corrected face-normal pressure gradient is\n$$\n\\left(\\nabla p\\right)_{f}\\cdot \\boldsymbol{n}_{f} \\approx -961.538461538462 - 86.538461538462\n= -1048.07692307692\\,\\text{Pa}\\,\\text{m}^{-1}.\n$$\nIts contraction with the face area vector is\n$$\n\\left(\\nabla p\\right)_{f}\\cdot \\boldsymbol{S}_{f}\n= \\|\\boldsymbol{S}_{f}\\|\\,\\left[\\left(\\nabla p\\right)_{f}\\cdot \\boldsymbol{n}_{f}\\right]\n= 0.8\\,(-1048.07692307692)\n= -838.461538461538\\,\\text{Pa}.\n$$\n\nNext, compute the face velocity used in PISO. From the momentum predictor-corrector derived by integrating Newton’s second law over the control volume, we employ\n$$\n\\boldsymbol{u}_{f} = \\boldsymbol{u}^{*}_{f} - \\frac{\\Delta t}{\\rho}\\left(\\nabla p\\right)_{f}.\n$$\nInterpolate the predicted velocities to the face (linear interpolation):\n$$\n\\boldsymbol{u}^{*}_{f} = \\frac{\\boldsymbol{u}^{*}_{P} + \\boldsymbol{u}^{*}_{N}}{2}\n= \\frac{(2.0,\\,0.0) + (1.5,\\,0.2)}{2}\n= (1.75,\\,0.1)\\,\\text{m}\\,\\text{s}^{-1}.\n$$\nThe mass flux through the face is\n$$\n\\dot{m}_{f} = \\rho\\,\\boldsymbol{u}_{f}\\cdot \\boldsymbol{S}_{f}\n= \\rho\\,\\boldsymbol{u}^{*}_{f}\\cdot \\boldsymbol{S}_{f} - \\Delta t\\,\\left(\\nabla p\\right)_{f}\\cdot \\boldsymbol{S}_{f}.\n$$\nEvaluate the two contributions:\n$$\n\\rho\\,\\boldsymbol{u}^{*}_{f}\\cdot \\boldsymbol{S}_{f}\n= 1.2\\,\\left[(1.75,\\,0.1)\\cdot(0.8,\\,0)\\right]\n= 1.2\\,(1.4)\n= 1.68\\,\\text{kg}\\,\\text{s}^{-1},\n$$\n$$\n-\\Delta t\\,\\left(\\nabla p\\right)_{f}\\cdot \\boldsymbol{S}_{f}\n= -\\left(1.0\\times 10^{-3}\\right)\\,(-838.461538461538)\n= +0.838461538461538\\,\\text{kg}\\,\\text{s}^{-1}.\n$$\nTherefore,\n$$\n\\dot{m}_{f} = 1.68 + 0.838461538461538 = 2.51846153846154\\,\\text{kg}\\,\\text{s}^{-1}.\n$$\nRounded to four significant figures and expressed in $\\text{kg}\\,\\text{s}^{-1}$, the mass flux is $2.518\\,\\text{kg}\\,\\text{s}^{-1}$.",
            "answer": "$$\\boxed{2.518}$$"
        },
        {
            "introduction": "A central challenge in transient CFD is balancing computational cost with numerical accuracy. For the PISO algorithm, this balance involves a critical trade-off between the size of the time step, $\\Delta t$, and the number of pressure-correction sweeps, $M$, performed within each step. This exercise explores the quantitative relationship between these parameters, linking them to the continuity residual and the overall simulation efficiency . By analyzing how the required number of corrections changes with $\\Delta t$, you will develop a deeper intuition for configuring efficient and robust transient simulations in practice.",
            "id": "3984973",
            "problem": "Consider an incompressible, transient external flow around a wing section discretized on a collocated, unstructured mesh and advanced in time using the Pressure Implicit with Splitting of Operators (PISO) algorithm. The governing laws are the incompressible Navier–Stokes equations,\n$$\n\\rho \\,\\frac{\\partial \\mathbf{u}}{\\partial t} + \\rho\\,(\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\nabla p + \\mu \\,\\nabla^2 \\mathbf{u},\n\\qquad\n\\nabla\\cdot \\mathbf{u} = 0,\n$$\nwith density $\\rho$ and dynamic viscosity $\\mu$. At each time step of size $\\Delta t$, PISO performs a momentum predictor followed by a sequence of pressure corrections to enforce the discrete continuity constraint. The solver monitors the global continuity residual norm, denoted $\\|\\mathbf{r}_c\\|$, at the beginning of the pressure-correction loop and after each correction.\n\nOn this mesh and with the chosen linear solver tolerances and pressure under-relaxation, prior verification runs show the following behavior:\n\n- The initial continuity residual at the start of the correction loop scales with time step as $\\|\\mathbf{r}_c^{(0)}\\| \\approx C\\,\\Delta t$, with $C = 0.2\\,\\mathrm{s}^{-1}$.\n- Each pressure-correction sweep reduces the continuity residual by an empirically measured factor $q(\\Delta t) = q_0 + \\beta\\,\\Delta t$, where $q_0 = 0.25$ and $\\beta = 600\\,\\mathrm{s}^{-1}$, reflecting the effective contraction governed by the pressure correction coupling and under-relaxation at this operating point.\n\nThe target tolerance for the continuity residual is $\\varepsilon = 10^{-6}$ (dimensionless norm). Quantify the trade-off between $\\Delta t$ and the number of pressure corrections $M$ required to achieve $\\|\\mathbf{r}_c^{(M)}\\| \\le \\varepsilon$ by determining the smallest integer $M$ for two candidate time steps: $\\Delta t = 10^{-4}\\,\\mathrm{s}$ and $\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$. Then, for each $\\Delta t$, compute the total number of pressure-correction sweeps per unit physical time (per second), given by $M / \\Delta t$, assuming one momentum predictor per time step and $M$ corrections per time step.\n\nChoose the option that correctly reports $M$ for both $\\Delta t$ values and the corresponding total number of pressure-correction sweeps per physical second.\n\nA. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ requires $M = 3$, and $\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ requires $M = 8$; the total pressure-correction sweeps per physical second are $3\\times 10^{4}$ and $1.6\\times 10^{4}$, respectively.\n\nB. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ requires $M = 2$, and $\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ requires $M = 6$; the total pressure-correction sweeps per physical second are $2\\times 10^{4}$ and $1.2\\times 10^{4}$, respectively.\n\nC. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ requires $M = 3$, and $\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ requires $M = 6$; the total pressure-correction sweeps per physical second are $3\\times 10^{4}$ and $1.2\\times 10^{4}$, respectively.\n\nD. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ requires $M = 4$, and $\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ requires $M = 9$; the total pressure-correction sweeps per physical second are $4\\times 10^{4}$ and $1.8\\times 10^{4}$, respectively.",
            "solution": "The problem statement is subjected to validation before proceeding to a solution.\n\n**Step 1: Extract Givens**\n- Governing equations: Incompressible Navier–Stokes equations:\n$$\n\\rho \\,\\frac{\\partial \\mathbf{u}}{\\partial t} + \\rho\\,(\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\nabla p + \\mu \\,\\nabla^2 \\mathbf{u}\n$$\n$$\n\\nabla\\cdot \\mathbf{u} = 0\n$$\n- Algorithm: Pressure Implicit with Splitting of Operators (PISO).\n- Initial continuity residual norm at a time step: $\\|\\mathbf{r}_c^{(0)}\\| \\approx C\\,\\Delta t$.\n- Constant for initial residual: $C = 0.2\\,\\mathrm{s}^{-1}$.\n- Residual reduction factor per pressure-correction sweep: $q(\\Delta t) = q_0 + \\beta\\,\\Delta t$.\n- Constants for reduction factor: $q_0 = 0.25$ and $\\beta = 600\\,\\mathrm{s}^{-1}$.\n- Target tolerance for continuity residual norm: $\\varepsilon = 10^{-6}$.\n- Number of pressure corrections per time step: $M$.\n- Condition to be met: $\\|\\mathbf{r}_c^{(M)}\\| \\le \\varepsilon$.\n- Two candidate time steps for analysis: $\\Delta t_1 = 10^{-4}\\,\\mathrm{s}$ and $\\Delta t_2 = 5\\times 10^{-4}\\,\\mathrm{s}$.\n- Quantity to compute for comparison: Total number of pressure-correction sweeps per unit physical time, $M / \\Delta t$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes the behavior of the PISO algorithm, a standard method for solving the incompressible Navier-Stokes equations in computational fluid dynamics. The empirical models for the initial residual ($ \\|\\mathbf{r}_c^{(0)}\\| \\propto \\Delta t$) and the convergence factor of the pressure correction ($q(\\Delta t) = q_0 + \\beta\\,\\Delta t$) are plausible representations of numerical behavior. A first-order predictor step naturally produces an initial continuity error proportional to $\\Delta t$. The degradation of the iterative solver's convergence rate with increasing $\\Delta t$ (i.e., $q$ increases with $\\Delta t$) is also a commonly observed phenomenon.\n- **Well-Posed**: The problem is well-posed. It provides a clear mathematical framework and all necessary parameters to calculate a unique integer value for the number of corrections, $M$, for each case.\n- **Objective**: The problem is stated in precise, quantitative terms, free from ambiguity or subjective content.\n\nAll other validation criteria are met. The problem does not exhibit any of the flaws listed in the instructions. The constants provided are physically reasonable for a numerical simulation. For the chosen $\\Delta t$ values, the reduction factor $q(\\Delta t)$ remains below $1$, ensuring convergence.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\n**Derivation**\n\nThe PISO algorithm iteratively reduces the continuity residual norm. Let $\\|\\mathbf{r}_c^{(k)}\\|$ be the norm after $k$ pressure-correction sweeps. According to the problem statement, the residual norm is reduced by a factor of $q(\\Delta t)$ at each sweep.\nTherefore, after $M$ sweeps, the residual norm is related to the initial residual norm $\\|\\mathbf{r}_c^{(0)}\\|$ by:\n$$\n\\|\\mathbf{r}_c^{(M)}\\| = [q(\\Delta t)]^M \\, \\|\\mathbf{r}_c^{(0)}\\|\n$$\nThe goal is to determine the minimum number of integer corrections $M$ required to satisfy the tolerance condition $\\|\\mathbf{r}_c^{(M)}\\| \\le \\varepsilon$.\nSubstituting the given models for $\\|\\mathbf{r}_c^{(0)}\\|$ and $q(\\Delta t)$:\n$$\n[q_0 + \\beta\\,\\Delta t]^M \\, (C\\,\\Delta t) \\le \\varepsilon\n$$\nTo solve for $M$, we take the natural logarithm of both sides of the inequality:\n$$\n\\ln\\left( [q_0 + \\beta\\,\\Delta t]^M \\, (C\\,\\Delta t) \\right) \\le \\ln(\\varepsilon)\n$$\n$$\nM \\ln(q_0 + \\beta\\,\\Delta t) + \\ln(C\\,\\Delta t) \\le \\ln(\\varepsilon)\n$$\n$$\nM \\ln(q_0 + \\beta\\,\\Delta t) \\le \\ln(\\varepsilon) - \\ln(C\\,\\Delta t) = \\ln\\left(\\frac{\\varepsilon}{C\\,\\Delta t}\\right)\n$$\nSince convergence requires $q(\\Delta t)  1$, its logarithm, $\\ln(q_0 + \\beta\\,\\Delta t)$, is negative. Dividing by this negative number reverses the inequality sign:\n$$\nM \\ge \\frac{\\ln\\left(\\frac{\\varepsilon}{C\\,\\Delta t}\\right)}{\\ln(q_0 + \\beta\\,\\Delta t)}\n$$\nSince $M$ must be an integer, we must take the ceiling of the right-hand side.\n\n**Case 1: $\\Delta t = 10^{-4}\\,\\mathrm{s}$**\n\nFirst, calculate the necessary parameters for this time step:\n- Initial residual: $\\|\\mathbf{r}_c^{(0)}\\|_1 = C\\,\\Delta t_1 = (0.2\\,\\mathrm{s}^{-1}) \\times (10^{-4}\\,\\mathrm{s}) = 2 \\times 10^{-5}$.\n- Reduction factor: $q_1 = q_0 + \\beta\\,\\Delta t_1 = 0.25 + (600\\,\\mathrm{s}^{-1}) \\times (10^{-4}\\,\\mathrm{s}) = 0.25 + 0.06 = 0.31$.\n\nNow, we calculate the minimum number of corrections, $M_1$:\n$$\nM_1 \\ge \\frac{\\ln\\left(\\frac{10^{-6}}{2 \\times 10^{-5}}\\right)}{\\ln(0.31)} = \\frac{\\ln(0.05)}{\\ln(0.31)} \\approx \\frac{-2.9957}{-1.1712} \\approx 2.5578\n$$\nThe smallest integer $M_1$ that satisfies this condition is $M_1=3$.\n\nThe total number of pressure-correction sweeps per physical second is:\n$$\n\\frac{M_1}{\\Delta t_1} = \\frac{3}{10^{-4}\\,\\mathrm{s}} = 3 \\times 10^4\\,\\mathrm{s}^{-1}\n$$\n\n**Case 2: $\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$**\n\nFirst, calculate the parameters for this time step:\n- Initial residual: $\\|\\mathbf{r}_c^{(0)}\\|_2 = C\\,\\Delta t_2 = (0.2\\,\\mathrm{s}^{-1}) \\times (5\\times 10^{-4}\\,\\mathrm{s}) = 1 \\times 10^{-4}$.\n- Reduction factor: $q_2 = q_0 + \\beta\\,\\Delta t_2 = 0.25 + (600\\,\\mathrm{s}^{-1}) \\times (5 \\times 10^{-4}\\,\\mathrm{s}) = 0.25 + 0.30 = 0.55$.\n\nNow, we calculate the minimum number of corrections, $M_2$:\n$$\nM_2 \\ge \\frac{\\ln\\left(\\frac{10^{-6}}{1 \\times 10^{-4}}\\right)}{\\ln(0.55)} = \\frac{\\ln(0.01)}{\\ln(0.55)} \\approx \\frac{-4.6052}{-0.5978} \\approx 7.7036\n$$\nThe smallest integer $M_2$ that satisfies this condition is $M_2=8$.\n\nThe total number of pressure-correction sweeps per physical second is:\n$$\n\\frac{M_2}{\\Delta t_2} = \\frac{8}{5\\times 10^{-4}\\,\\mathrm{s}} = \\frac{8}{5} \\times 10^4\\,\\mathrm{s}^{-1} = 1.6 \\times 10^4\\,\\mathrm{s}^{-1}\n$$\n\n**Summary of Results**\n- For $\\Delta t = 10^{-4}\\,\\mathrm{s}$: $M = 3$ corrections are required, resulting in $3 \\times 10^4$ sweeps per physical second.\n- For $\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$: $M = 8$ corrections are required, resulting in $1.6 \\times 10^4$ sweeps per physical second.\n\n**Option-by-Option Analysis**\n\nA. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ requires $M = 3$, and $\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ requires $M = 8$; the total pressure-correction sweeps per physical second are $3\\times 10^{4}$ and $1.6\\times 10^{4}$, respectively.\nThis option perfectly matches our derived results for both time steps, including the number of corrections $M$ and the sweeps per second.\n**Verdict: Correct**\n\nB. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ requires $M = 2$, and $\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ requires $M = 6$; the total pressure-correction sweeps per physical second are $2\\times 10^{4}$ and $1.2\\times 10^{4}$, respectively.\nThe values for $M$ are incorrect. Our calculations show $M_1=3$ and $M_2=8$.\n**Verdict: Incorrect**\n\nC. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ requires $M = 3$, and $\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ requires $M = 6$; the total pressure-correction sweeps per physical second are $3\\times 10^{4}$ and $1.2\\times 10^{4}$, respectively.\nThe value of $M=3$ for the first case is correct, but the value of $M=6$ for the second case is incorrect (it should be $8$).\n**Verdict: Incorrect**\n\nD. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ requires $M = 4$, and $\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ requires $M = 9$; the total pressure-correction sweeps per physical second are $4\\times 10^{4}$ and $1.8\\times 10^{4}$, respectively.\nThe values for $M$ are incorrect for both cases. Our calculations show $M_1=3$ and $M_2=8$.\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}