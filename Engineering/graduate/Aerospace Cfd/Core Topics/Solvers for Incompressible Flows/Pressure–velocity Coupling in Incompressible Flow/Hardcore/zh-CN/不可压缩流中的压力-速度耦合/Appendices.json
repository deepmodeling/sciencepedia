{
    "hands_on_practices": [
        {
            "introduction": "理论的理解最好通过实践来巩固。本节的第一个练习将引导你通过一个经典的“纸笔”计算，来直观地理解压力场在不可压缩流中的基本作用。通过分析一个简单的槽道流问题 ，你将推导出为满足全局质量守恒，系统必须建立的压力梯度。这个练习揭示了压力不仅仅是一个被动的状态变量，而是流场为了满足物理约束而主动调整的关键因素。",
            "id": "3986915",
            "problem": "在计算流体动力学 (CFD) 中，使用分离式压力-速度耦合算法模拟了一个高度为 $H$、长度为 $L$ 的二维通道中的稳态、不可压缩牛顿流。流体的密度为 $\\rho$，动力粘度为 $\\mu$。基于 $H$ 和一个特征速度的雷诺数足够小，以至于惯性项可以忽略，即适用斯托克斯流极限。\n\n在 $x=0$ 处的左边界为流向速度分量指定了一个狄利克雷（Dirichlet）速度分布，\n$$u_{\\text{in}}(y)=U_{0}\\left[1-\\left( \\frac{2y}{H}-1 \\right)^{2}\\right],$$\n并且对于 $y\\in[0,H]$，$v=0$。在 $y=H$ 和 $y=0$ 处的顶部和底部壁面施加了无滑移和无穿透条件，即 $u=0$ 和 $v=0$。在 $x=L$ 处的右边界是开放的；算法会确定与速度场耦合的压力场，以满足不可压缩性条件和动量守恒。假设出口截面是充分发展的局部平行流，因此流向速度 $u(y)$ 满足一个恒定的流向压力梯度 $\\partial p/\\partial x$ 与跨间隙的粘性扩散之间的稳态斯托克斯平衡，且 $u(0)=u(H)=0$。\n\n从不可压缩连续性方程和稳态斯托克斯动量方程出发，并对由整个矩形域定义的控制体使用散度定理，完成以下任务：\n\n- 通过计算流经矩形每条边的质量通量，并利用在稳态不可压缩流中其总和必须为零的条件，计算由边界条件所隐含的区域积分质量通量。\n- 在充分发展的出口截面，求解壁面有界的斯托克斯问题得到 $u(y)$，并沿高度方向积分，从而用均匀压力梯度 $\\partial p/\\partial x$ 表示出口的体积流量（单位展向长度）。\n- 施加零净散度条件（即入口和出口流量相等），以确定压力场为满足全局质量守恒而必须形成的恒定流向压力梯度。\n\n将最终答案表示为所需恒定流向压力梯度 $\\partial p/\\partial x$ 的单一闭式解析表达式，以国际单位制 $\\text{Pa/m}$ 为单位，作为 $\\mu$、$U_{0}$ 和 $H$ 的函数。不需要提供数值。",
            "solution": "该问题要求在给定入口特定速度分布的情况下，确定在充分发展的通道流截面中为满足全局质量守恒而必须存在的恒定流向压力梯度 $\\frac{\\partial p}{\\partial x}$。该分析基于稳态、不可压缩斯托克斯流的基本原理。\n\n第一个原理是质量守恒。对于不可压缩流体，连续性方程为 $\\nabla \\cdot \\mathbf{u} = 0$，其中 $\\mathbf{u}$ 是速度场。为了在由矩形 $[0, L] \\times [0, H]$ 定义的整个计算域上实施全局质量守恒，我们应用散度定理：\n$$ \\int_V (\\nabla \\cdot \\mathbf{u}) \\, dV = \\oint_S \\mathbf{u} \\cdot \\mathbf{n} \\, dS = 0 $$\n此处，$V$ 是二维域的面积，$S$ 是其边界。边界 $S$ 由四部分组成：$x=0$ 处的入口、$x=L$ 处的出口、$y=0$ 处的底壁和 $y=H$ 处的顶壁。面积分可以写成通过这四个边界的通量之和：\n$$ \\oint_S \\mathbf{u} \\cdot \\mathbf{n} \\, dS = \\int_{0}^{H} u(x=L, y) \\, dy - \\int_{0}^{H} u(x=0, y) \\, dy + \\int_{0}^{L} v(x, y=H) \\, dx - \\int_{0}^{L} v(x, y=0) \\, dx = 0 $$\n壁面边界条件是无滑移和无穿透，意味着在 $y=0$ 和 $y=H$ 处 $u=0$ 和 $v=0$。因此，沿顶壁和底壁的积分为零。该条件简化为：\n$$ \\int_{0}^{H} u(x=L, y) \\, dy = \\int_{0}^{H} u(x=0, y) \\, dy $$\n该方程表明，出口的单位展向体积流量 $Q_{\\text{out}}$ 必须等于入口的单位展向体积流量 $Q_{\\text{in}}$。\n\n首先，我们使用给定的速度分布 $u_{\\text{in}}(y) = U_{0}\\left[1-\\left( \\frac{2y}{H}-1 \\right)^{2}\\right]$ 计算入口体积流量 $Q_{\\text{in}}$：\n$$ Q_{\\text{in}} = \\int_0^H u_{\\text{in}}(y) \\, dy = \\int_0^H U_{0}\\left[1-\\left( \\frac{2y}{H}-1 \\right)^{2}\\right] \\, dy $$\n我们展开被积函数中的项：\n$$ 1-\\left( \\frac{2y}{H}-1 \\right)^{2} = 1 - \\left( \\frac{4y^2}{H^2} - \\frac{4y}{H} + 1 \\right) = \\frac{4y}{H} - \\frac{4y^2}{H^2} $$\n将此代回积分中：\n$$ Q_{\\text{in}} = U_0 \\int_0^H \\left( \\frac{4y}{H} - \\frac{4y^2}{H^2} \\right) dy = U_0 \\left[ \\frac{4y^2}{2H} - \\frac{4y^3}{3H^2} \\right]_0^H $$\n$$ Q_{\\text{in}} = U_0 \\left( \\frac{2H^2}{H} - \\frac{4H^3}{3H^2} \\right) = U_0 \\left( 2H - \\frac{4}{3}H \\right) = \\frac{2}{3}U_0 H $$\n\n接下来，我们用恒定的流向压力梯度 $\\frac{\\partial p}{\\partial x}$ 来确定出口体积流量 $Q_{\\text{out}}$。假设出口处的流动是充分发展的局部平行流。对于稳态斯托克斯流，动量方程为 $0 = -\\nabla p + \\mu \\nabla^2 \\mathbf{u}$。在流向（$x$）方向上，该方程变为：\n$$ 0 = -\\frac{\\partial p}{\\partial x} + \\mu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right) $$\n对于充分发展的流动，速度分布不随 $x$ 变化，所以 $\\frac{\\partial u}{\\partial x} = 0$，这意味着 $\\frac{\\partial^2 u}{\\partial x^2} = 0$。对于平行流，横向速度 $v=0$ 处处成立，所以 $y$ 方向动量方程简化为 $\\frac{\\partial p}{\\partial y} = 0$。这意味着压力 $p$ 仅是 $x$ 的函数，$p=p(x)$。$x$ 方向动量方程随之简化为一个常微分方程：\n$$ \\mu \\frac{d^2 u}{dy^2} = \\frac{dp}{dx} $$\n因为左边只依赖于 $y$ 而右边只依赖于 $x$，所以两边都必须等于一个常数。设这个恒定的压力梯度为 $G = \\frac{dp}{dx}$。\n$$ \\frac{d^2 u}{dy^2} = \\frac{G}{\\mu} $$\n对 $y$ 积分两次，得到速度分布的通解：\n$$ u(y) = \\frac{G}{2\\mu}y^2 + C_1 y + C_2 $$\n积分常数 $C_1$ 和 $C_2$ 由壁面上的无滑移边界条件 $u(0)=0$ 和 $u(H)=0$ 确定。\n由 $u(0)=0$ 得：\n$$ 0 = \\frac{G}{2\\mu}(0)^2 + C_1(0) + C_2 \\implies C_2=0 $$\n由 $u(H)=0$ 得：\n$$ 0 = \\frac{G}{2\\mu}H^2 + C_1 H \\implies C_1 = -\\frac{GH}{2\\mu} $$\n将常数代回，出口的速度分布为：\n$$ u_{\\text{out}}(y) = \\frac{G}{2\\mu}y^2 - \\frac{GH}{2\\mu}y = \\frac{G}{2\\mu}(y^2 - Hy) $$\n现在，我们可以计算出口体积流量 $Q_{\\text{out}}$：\n$$ Q_{\\text{out}} = \\int_0^H u_{\\text{out}}(y) \\, dy = \\int_0^H \\frac{G}{2\\mu}(y^2 - Hy) \\, dy $$\n$$ Q_{\\text{out}} = \\frac{G}{2\\mu} \\left[ \\frac{y^3}{3} - \\frac{Hy^2}{2} \\right]_0^H = \\frac{G}{2\\mu} \\left( \\frac{H^3}{3} - \\frac{H^3}{2} \\right) = \\frac{G}{2\\mu} \\left( -\\frac{H^3}{6} \\right) = -\\frac{G H^3}{12\\mu} $$\n\n最后，我们通过令入口和出口流量相等 ($Q_{\\text{in}} = Q_{\\text{out}}$) 来实施全局质量守恒：\n$$ \\frac{2}{3}U_0 H = -\\frac{G H^3}{12\\mu} $$\n代入 $G = \\frac{\\partial p}{\\partial x}$，我们可以解出所需的压力梯度：\n$$ \\frac{2}{3}U_0 H = -\\frac{(\\partial p/\\partial x) H^3}{12\\mu} $$\n$$ \\frac{\\partial p}{\\partial x} = -\\left( \\frac{2}{3}U_0 H \\right) \\left( \\frac{12\\mu}{H^3} \\right) = -\\frac{2 \\times 12}{3} \\frac{\\mu U_0 H}{H^3} = -\\frac{24}{3} \\frac{\\mu U_0}{H^2} $$\n$$ \\frac{\\partial p}{\\partial x} = -8 \\frac{\\mu U_0}{H^2} $$\n这个表达式给出了压力场为驱动流动而必须形成的恒定流向压力梯度，该梯度使得出口质量通量恰好与入口质量通量平衡，从而满足整个域上的不可压缩性约束。负号表示压力必须沿流动方向减小，这与压力驱动流的预期相符。",
            "answer": "$$ \\boxed{-8 \\frac{\\mu U_0}{H^2}} $$"
        },
        {
            "introduction": "知道了压力场必须调整以满足质量守恒，我们接下来要问：在数值上如何求解这个压力场？这个问题引出了一个独特的数学挑战。这个练习  深入探讨了离散压力泊松方程的线性代数结构，特别是在全域使用诺伊曼（Neumann）边界条件的情况下。你将发现为什么压力解不是唯一的，并分析在实践中（例如在SIMPLE或PISO算法中）如何通过设定压力参考点来克服这一奇异性，从而确保数值求解的稳定性和唯一性。",
            "id": "3986924",
            "problem": "考虑一个在有界单连通域 $\\Omega \\subset \\mathbb{R}^{d}$ (其中 $d \\in \\{2,3\\}$) 中的不可压缩流，并假设边界上满足无穿透条件，即在 $\\partial \\Omega$ 上 $\\mathbf{u} \\cdot \\mathbf{n} = 0$，其中 $\\mathbf{u}$ 是速度，$\\mathbf{n}$ 是外法向向量。在一个具有 $N$ 个单元的连通均匀笛卡尔网格上进行同位有限体积离散时，所有主变量（压力和速度分量）都存储在单元中心。用于压力-速度耦合的压力方程源于施加不可压缩性约束 $\\nabla \\cdot \\mathbf{u} = 0$ 以及动量预测步。其标准离散形式可以抽象地写为\n$$\nL \\, p = b,\n$$\n其中 $p \\in \\mathbb{R}^{N}$ 是单元中心压力的向量，$b \\in \\mathbb{R}^{N}$ 是预测质量通量场的离散散度，$L$ 是离散诺伊曼泊松算子，组装为\n$$\nL \\;=\\; -\\, D \\, G,\n$$\n其中 $G$ 是一个离散梯度算子，将单元中心压力映射到面法向压力梯度；$D$ 是一个离散散度算子，将面法向通量映射到单元中心散度。由无穿透条件和动量预测-校正步所隐含的 $p$ 的边界条件是齐次诺伊曼条件，即在连续极限下，在 $\\partial \\Omega$ 上 $\\partial p / \\partial n = 0$。假设 $G$ 和 $D$ 的构造满足离散散度定理和在此同位网格上的分部求和恒等式，并且面梯度由与齐次诺伊曼边界处理一致的二阶中心差分形成。\n\n从不可压缩流约束和这些算子定义出发，确定 $L$ 在此连通同位网格上的零空间维度。然后，解释在实际的计算流体动力学（CFD）压力-速度耦合算法（如SIMPLE和PISO）中，当压力存在纯诺伊曼条件时，如何处理这个零空间。\n\n将零空间维度作为一个整数提供。不需要四舍五入。最终答案不需要单位。",
            "solution": "出发点是不可压缩流的不可压缩性约束，其强形式为在 $\\Omega$ 中 $\\nabla \\cdot \\mathbf{u} = 0$ 且在 $\\partial \\Omega$ 上 $\\mathbf{u} \\cdot \\mathbf{n} = 0$。在投影型压力-速度耦合方案（包括压力耦合方程组的半隐式方法（SIMPLE）和算子分裂的压力隐式方法（PISO））中，动量预测步会产生一个不一定满足 $\\nabla \\cdot \\mathbf{u} = 0$ 的临时速度 $\\mathbf{u}^{\\ast}$。然后引入压力修正量 $\\phi$（或压力 $p$），使得校正后的速度 $\\mathbf{u} = \\mathbf{u}^{\\ast} - G \\, \\phi$ 在离散层面上是无散度的。施加 $D \\, \\mathbf{u} = 0$ 可得到压力方程\n$$\n- D \\, G \\, \\phi = D \\, \\mathbf{u}^{\\ast},\n$$\n因此，压力方程的离散算子为 $L = - D G$。\n\n我们分析在具有齐次诺伊曼压力边界处理的连通同位网格上 $L$ 的零空间。算子的定义是为了遵循一个离散分部求和恒等式（积分分部法的代数模拟）。具体来说，对于任意两个单元中心的标量场 $q, r \\in \\mathbb{R}^{N}$ 和一个与 $G q$ 一致的面中心向量场 $\\mathbf{f}$，在齐次诺伊曼边界条件下，以下恒等式成立，该条件使得边界项为零：\n$$\nq^{\\top} \\, (D \\, \\mathbf{f}) \\;=\\; -\\, (G \\, q)^{\\top} \\, \\mathbf{f}\n$$\n从 $L = - D G$，我们得到离散能量恒等式\n$$\nq^{\\top} \\, L \\, q \\;=\\; q^{\\top} \\, (- D G) \\, q \\;=\\; (G \\, q)^{\\top} \\, (G \\, q) \\;=\\; \\| G \\, q \\|^{2}.\n$$\n因此，$L$ 是对称半正定的。$L$ 的零空间由所有满足 $q^{\\top} L q = 0$ 的 $q$ 给出，根据上述恒等式，这等价于 $G \\, q = \\mathbf{0}$。\n\n我们现在来刻画集合 $\\{ q \\in \\mathbb{R}^{N} \\mid G \\, q = \\mathbf{0} \\}$。离散梯度 $G$ 通过二阶中心差分将单元中心压力映射到面法向差分，这与在区域边界上的齐次诺伊曼处理是一致的。在一个连通网格上，$G \\, q = \\mathbf{0}$ 意味着相邻单元压力在每个内部面上的离散差为零，因为垂直于任何内部面的 $q$ 的中心差分与相邻单元值的差成正比。根据连通性，这迫使 $q$ 的所有单元值都等于一个常数 $c \\in \\mathbb{R}$。在边界上，齐次诺伊曼条件与 $G \\, c = \\mathbf{0}$ 一致，因为常数的法向导数为零。因此，所有常数都位于 $G$ 的核中，从而也位于 $L$ 的核中。\n\n接下来需要论证该模式的唯一性。假设 $q$ 在 $G$ 的核中但不是常数。在一个使用中心差分的均匀连通网格上，所有面法向差分为零的唯一方式是 $q$ 在相邻单元中完全相同，通过归纳法可知 $q$ 在整个连通分量（根据假设即为整个区域）中必须是常数。因此，$G$ 的核恰好是常数向量的张成空间\n$$\n\\mathbf{1} \\;=\\; (1, 1, \\dots, 1)^{\\top} \\in \\mathbb{R}^{N}.\n$$\n因此，$L$ 的零空间是相同的的一维子空间：\n$$\n\\mathrm{null}(L) \\;=\\; \\mathrm{span}\\{\\mathbf{1}\\}.\n$$\n所以，$L$ 的零空间维度为1。\n\n这个结论与具有纯诺伊曼边界条件的连续算子是一致的：具有齐次诺伊曼条件的拉普拉斯算子的核由常数组成，而离散算子 $L = - D G$ 在一致的离散化和边界处理下反映了这一性质。\n\n我们现在解释在计算流体动力学（CFD）的压力-速度耦合算法中，当压力存在纯诺伊曼边界条件时，这个零空间在实践中是如何处理的。由于 $L$ 是奇异的且具有一维核，线性系统 $L \\, p = b$ 仅当 $b$ 与零空间正交时才有解，即 $\\mathbf{1}^{\\top} b = 0$。对于封闭区域，由于离散散度定理和无穿透条件，这个条件是满足的：净通量总和为零。然而，解 $p$ 并不是唯一的；它只能确定到一个附加常数。在实现中，可以采用以下等效的补救措施之一来固定这个自由度：\n- 强加一个参考压力，例如，在一个选定的单元索引 $k$ 处设置 $p_{k} = p_{\\mathrm{ref}}$，这将增广系统使其非奇异并产生唯一解。\n- 强制零均值约束，$\\frac{1}{N} \\sum_{i=1}^{N} p_{i} = 0$，可以通过添加拉格朗日乘子，或者将右端项投影到 $\\mathrm{span}\\{\\mathbf{1}\\}$ 的正交补空间上，然后从计算出的解中减去均值。\n- 使用带有零空间降维的求解器，显式地将 $\\mathbf{1}$ 注册为零向量，使得Krylov方法在商空间中运行，并对最终压力进行后处理以满足选定的参考（通常是零均值）。\n\n在同位网格上，如果面通量纯粹由单元中心速度和压力的插值形成，可能会发生额外的虚假压力-速度解耦（棋盘格模式）。在实践中，使用Rhie–Chow插值来构造同时依赖于动量和压力梯度的面通量，从而抑制这些非物理的棋盘格模式。这种稳定化方法解决了耦合病态问题，但并不改变由诺伊曼边界条件引起的基本一维零空间，该零空间仍需通过上述约束之一来消除。\n\n因此，离散诺伊曼泊松算子 $L$ 的零空间计算维度为1，在实践中通过固定压力参考或强制零均值约束来消除（可选用能感知零空间的线性求解器），而Rhie–Chow插值确保了同位网格上的鲁棒耦合。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "在理解了压力耦合的物理必要性和其离散系统的数学特性之后，现在是时候将所有知识融会贯通，付诸实践了。这个练习  提供了一个从零开始实现完整压力-速度耦合算法的机会。通过为经典的顶盖驱动方腔流问题编写人工可压缩性方法（ACM）的求解器，你将获得宝贵的实践经验，亲身体验压力和速度场如何通过迭代更新，最终达到一个满足无散条件的稳态解。",
            "id": "3986941",
            "problem": "考虑一个单位正方形域（坐标 $x\\in[0,1]$ 和 $y\\in[0,1]$）中的二维、稳态、不可压缩的顶盖驱动方腔流。顶盖以均匀切向速度 $U$ 移动，所有壁面均强制执行无滑移边界条件。目标是设计并实现一种伪时间推进法，使用人工可压缩方法（ACM）进行压力-速度耦合，将速度场的散度驱动至机器容差，并量化散度残差的衰减。该实现必须基于第一性原理，从守恒定律出发，并在均匀笛卡尔网格上使用有限差分法（FDM）进行离散化。\n\n从以下基本物理定律和定义出发：\n\n- 不可压缩流的质量守恒：$\\nabla\\cdot\\boldsymbol{u} = 0$。\n- 线性动量守恒（稳态目标）的无量纲形式：\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial \\tau} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} = -\\nabla p + \\frac{1}{Re}\\nabla^2 \\boldsymbol{u},\n$$\n其中 $\\boldsymbol{u}=(u,v)$ 是速度场，$p$ 是压力，$Re$ 是雷诺数，$\\tau$ 是用于松弛到稳态解的伪时间。\n- 压力的人工可压缩耦合：\n$$\n\\beta\\,\\frac{\\partial p}{\\partial \\tau} + \\nabla\\cdot\\boldsymbol{u} = 0,\n$$\n其中 $\\beta$ 是人工可压缩系数。\n\n在均匀网格上离散化方程，其中 $x$ 方向有 $N_x$ 个点，$y$ 方向有 $N_y$ 个点，间距分别为 $\\Delta x = 1/(N_x-1)$ 和 $\\Delta y = 1/(N_y-1)$。对空间梯度和拉普拉斯算子使用二阶中心差分，对所有变量使用显式前向欧拉法进行伪时间积分。在每个伪时间步强制执行以下边界条件：\n- 无滑移速度边界：在底壁（$y=0$）、左壁（$x=0$）和右壁（$x=1$）上，$u=0$ 和 $v=0$；在顶盖（$y=1$）上，$u=U$ 和 $v=0$。\n- 零法向梯度压力边界：在所有壁面上 $\\partial p/\\partial n = 0$。\n\n将散度残差定义为内部网格点上 $\\nabla\\cdot\\boldsymbol{u}$ 的离散 $L^2$ 范数，\n$$\nR = \\left(\\frac{1}{(N_x-2)(N_y-2)}\\sum_{i=2}^{N_x-1}\\sum_{j=2}^{N_y-1} \\left(\\frac{\\partial u}{\\partial x}\\bigg|_{i,j} + \\frac{\\partial v}{\\partial y}\\bigg|_{i,j}\\right)^2\\right)^{1/2}.\n$$\n\n实现伪时间推进格式以更新 $(u,v,p)$，并在每一步测量 $R$。将内部速度场和压力场初始化为零（顶盖边界条件除外）。执行一个初始伪时间步以获得非零的初始残差 $R_0$（因为平凡的初始化可能导致 $R=0$）。然后迭代直到残差满足 $R \\leq \\varepsilon$，其中 $\\varepsilon$ 是用于停止的机器容差阈值。对于本问题，使用无量纲容差 $\\varepsilon = 10^{-10}$。\n\n您的程序必须实现该算法，并为下面指定的每个测试用例返回三个量：执行的总伪时间步数 $N_{\\text{steps}}$（包括用于定义 $R_0$ 的初始步），以无量纲单位的浮点数表示的最终残差 $R_{\\text{final}}$，以及指示终止时是否有 $R \\leq \\varepsilon$ 的收敛标志 $\\mathrm{converged}$。如果由于初始化导致 $R_0=0$，则将 $R_0$ 重新定义为第一次伪时间更新后的残差，以避免在您计算的任何内部比率中出现除以零的情况。\n\n所有量都是无量纲的，因此不需要物理单位。不使用角度。不得使用百分比。最终程序输出必须在单行上，并且必须将所有测试用例结果聚合到下面描述的确切格式的单个列表中。\n\n测试套件：\n- 案例 1：$N_x=24$, $N_y=24$, $Re=10$, $\\beta=1$, $\\Delta\\tau=5\\times 10^{-4}$, $U=1$, $N_{\\max}=4000$, $\\varepsilon=10^{-10}$。\n- 案例 2：$N_x=24$, $N_y=24$, $Re=10$, $\\beta=0.2$, $\\Delta\\tau=5\\times 10^{-4}$, $U=1$, $N_{\\max}=6000$, $\\varepsilon=10^{-10}$。\n- 案例 3：$N_x=16$, $N_y=16$, $Re=50$, $\\beta=2$, $\\Delta\\tau=3\\times 10^{-4}$, $U=1$, $N_{\\max}=5000$, $\\varepsilon=10^{-10}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的列表的列表，格式为逗号分隔。每个内部列表必须按 $[N_{\\text{steps}},R_{\\text{final}},\\mathrm{converged}]$ 的顺序排列。例如，输出格式必须完全是\n$[[N_{\\text{steps},1},R_{\\text{final},1},\\mathrm{converged}_1],[N_{\\text{steps},2},R_{\\text{final},2},\\mathrm{converged}_2],[N_{\\text{steps},3},R_{\\text{final},3},\\mathrm{converged}_3]]$，\n所有值都表示为单行上的普通数字和布尔字面量。",
            "solution": "用户希望我使用人工可压缩方法（ACM）解决一个计算流体动力学问题。这是一种用于寻找不可压缩流稳态解的成熟技术。我将首先验证问题陈述，如果有效，则继续提供完整解决方案。\n\n### 步骤1：提取给定条件\n- **域**：二维单位正方形，$x\\in[0,1]$ 和 $y\\in[0,1]$。\n- **流体**：稳态、不可压缩、顶盖驱动方腔流。\n- **控制方程**：\n    - 质量守恒（稳态目标）：$\\nabla\\cdot\\boldsymbol{u} = 0$。\n    - 线性动量守恒（伪瞬态）：$\\frac{\\partial \\boldsymbol{u}}{\\partial \\tau} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} = -\\nabla p + \\frac{1}{Re}\\nabla^2 \\boldsymbol{u}$。\n    - 人工可压缩压力耦合：$\\beta\\,\\frac{\\partial p}{\\partial \\tau} + \\nabla\\cdot\\boldsymbol{u} = 0$。\n- **变量和常数**：$\\boldsymbol{u}=(u,v)$ 是速度， $p$ 是压力， $Re$ 是雷诺数， $\\tau$ 是伪时间， $\\beta$ 是人工可压缩系数， $U$ 是顶盖速度。\n- **数值离散化**：\n    - 方法：在均匀笛卡尔网格上使用有限差分法（FDM）。\n    - 网格：$N_x \\times N_y$ 个点，间距为 $\\Delta x = 1/(N_x-1)$ 和 $\\Delta y = 1/(N_y-1)$。\n    - 空间导数：对所有梯度和拉普拉斯算子使用二阶中心差分。\n    - 时间积分：对所有变量 $(u,v,p)$ 在伪时间上使用显式前向欧拉法。\n- **边界条件**：\n    - 速度：壁面无滑移。在底壁、左壁、右壁上 $u=v=0$。在顶盖上 $u=U, v=0$。在每一步强制执行。\n    - 压力：零法向梯度，$\\partial p/\\partial n = 0$，在所有壁面上。\n- **残差定义**：内部点上速度散度的离散 $L^2$ 范数。\n$$R = \\left(\\frac{1}{(N_x-2)(N_y-2)}\\sum_{i=2}^{N_x-1}\\sum_{j=2}^{N_y-1} \\left(\\frac{\\partial u}{\\partial x}\\bigg|_{i,j} + \\frac{\\partial v}{\\partial y}\\bigg|_{i,j}\\right)^2\\right)^{1/2}$$\n- **算法**：\n    - 将内部 $u,v,p$ 初始化为零。\n    - 执行一个初始伪时间步以获得非零的初始残差。\n    - 迭代直到 $R \\leq \\varepsilon$，其中 $\\varepsilon = 10^{-10}$。\n    - 最大迭代次数：$N_{\\max}$。\n- **每个测试用例的输出量**：$N_{\\text{steps}}$, $R_{\\text{final}}$, 和 $\\mathrm{converged}$。\n- **测试用例**：\n    - 案例 1：$N_x=24, N_y=24, Re=10, \\beta=1, \\Delta\\tau=5\\times 10^{-4}, U=1, N_{\\max}=4000, \\varepsilon=10^{-10}$。\n    - 案例 2：$N_x=24, N_y=24, Re=10, \\beta=0.2, \\Delta\\tau=5\\times 10^{-4}, U=1, N_{\\max}=6000, \\varepsilon=10^{-10}$。\n    - 案例 3：$N_x=16, N_y=16, Re=50, \\beta=2, \\Delta\\tau=3\\times 10^{-4}, U=1, N_{\\max}=5000, \\varepsilon=10^{-10}$。\n\n### 步骤2：使用提取的给定条件进行验证\n- **科学基础**：该问题描述了使用人工可压缩方法（ACM）求解稳态不可压缩纳维-斯托克斯方程，这是计算流体动力学中一种标准且有充分文献记载的技术，最早由 A.J. Chorin 提出。控制方程和物理设置（顶盖驱动方腔）是该领域的经典模型。所有方面都基于已建立的物理和数学原理。此标准已满足。\n- **适定的**：该问题提供了一套完整的偏微分方程、一个明确定义的域、一套针对所有变量的完整边界条件以及具体的初始条件。离散化方法、数值格式和清晰的停止准则都已明确定义。包含最大迭代次数 $N_{\\max}$ 确保了即使在不稳定或收敛缓慢的情况下也能终止，从而使计算问题是适定的。此标准已满足。\n- **客观的**：该问题使用精确、无歧义的数学和计算语言陈述。所要求的输出是定量的，并且其格式已精确指定。不存在主观元素。此标准已满足。\n\n### 步骤3：结论与行动\n该问题具有科学合理性、适定性和客观性。它满足所有有效性标准。我现在将继续提供完整的解决方案。\n\n### 基于原理的解决方案设计\n\n该问题要求实现人工可压缩方法（ACM），以求解顶盖驱动方腔内的稳态不可压缩流。ACM 的核心思想是在连续性方程中引入一个虚构的压力时间导数，将其与动量方程耦合。这将稳态不可压缩纳维-斯托克斯方程的混合椭圆-抛物线型系统转化为伪时间上的双曲-抛物线型系统，该系统可以通过时间推进程序求解，直到达到稳态。在稳态时，伪时间导数消失，原始控制方程（包括不可压缩性约束 $\\nabla \\cdot \\boldsymbol{u}=0$）得以恢复。\n\n**1. 控制方程的离散化**\n求解域被离散化为一个均匀的笛卡尔网格，网格点为 $(x_i, y_j)$，其中 $x_i = (i-1)\\Delta x$（对于 $i=1, \\dots, N_x$）和 $y_j = (j-1)\\Delta y$（对于 $j=1, \\dots, N_y$）。所有变量 $(u, v, p)$ 都存储在这些网格点上（一种同位网格布置）。令 $f_{i,j}^n$ 表示函数 $f$ 在网格点 $(i,j)$ 和伪时间步 $n$ 上的值。\n\n对于通用变量 $\\phi$，指定的显式前向欧拉格式为：\n$$ \\phi^{n+1} = \\phi^n + \\Delta\\tau \\left(\\frac{\\partial\\phi}{\\partial\\tau}\\right)^n $$\n空间导数使用二阶中心差分进行近似。对于函数 $f(x,y)$：\n$$ \\left(\\frac{\\partial f}{\\partial x}\\right)_{i,j} \\approx \\frac{f_{i+1,j} - f_{i-1,j}}{2\\Delta x} \\quad , \\quad \\left(\\frac{\\partial f}{\\partial y}\\right)_{i,j} \\approx \\frac{f_{i,j+1} - f_{i,j-1}}{2\\Delta y} $$\n$$ (\\nabla^2 f)_{i,j} \\approx \\frac{f_{i+1,j} - 2f_{i,j} + f_{i-1,j}}{(\\Delta x)^2} + \\frac{f_{i,j+1} - 2f_{i,j} + f_{i-1,j}}{(\\Delta y)^2} $$\n\n将这些格式应用于控制方程，可得到内部网格点（$i=2,\\dots,N_x-1$; $j=2,\\dots,N_y-1$）的更新规则。\n\n**动量方程：**\n分离出时间导数项：\n$$ \\frac{\\partial u}{\\partial \\tau} = - \\left(u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y}\\right) - \\frac{\\partial p}{\\partial x} + \\frac{1}{Re} \\nabla^2 u $$\n$$ \\frac{\\partial v}{\\partial \\tau} = - \\left(u \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y}\\right) - \\frac{\\partial p}{\\partial y} + \\frac{1}{Re} \\nabla^2 v $$\n$u$-速度分量的完全显式离散更新为：\n$$\nu_{i,j}^{n+1} = u_{i,j}^n + \\Delta\\tau \\left[\n- \\left(u_{i,j}^n \\frac{u_{i+1,j}^n - u_{i-1,j}^n}{2\\Delta x} + v_{i,j}^n \\frac{u_{i,j+1}^n - u_{i,j-1}^n}{2\\Delta y}\\right)\n- \\frac{p_{i+1,j}^n - p_{i-1,j}^n}{2\\Delta x}\n+ \\frac{1}{Re} \\left(\\frac{u_{i+1,j}^n - 2u_{i,j}^n + u_{i-1,j}^n}{(\\Delta x)^2} + \\frac{u_{i,j+1}^n - 2u_{i,j}^n + u_{i-1,j}^n}{(\\Delta y)^2}\\right)\n\\right]\n$$\n对于 $v_{i,j}^{n+1}$，可以推导出类似的方程。\n\n**压力方程（人工可压缩性）：**\n压力根据前一时间步的速度场散度进行更新：\n$$ \\frac{\\partial p}{\\partial \\tau} = -\\frac{1}{\\beta} (\\nabla \\cdot \\boldsymbol{u}) $$\n离散更新规则为：\n$$ p_{i,j}^{n+1} = p_{i,j}^n - \\frac{\\Delta\\tau}{\\beta} \\left( \\frac{u_{i+1,j}^n - u_{i-1,j}^n}{2\\Delta x} + \\frac{v_{i,j+1}^n - v_{i,j-1}^n}{2\\Delta y} \\right) $$\n\n**2. 边界条件的实现**\n在每个伪时间步之后应用边界条件。\n- **速度**：无滑移条件是狄利克雷型的。在整个模拟过程中，所有边界节点上的 $u$ 和 $v$ 的值保持恒定。\n    - $u_{i,1}=0, v_{i,1}=0$ 对于 $i=1,\\dots,N_x$ （底壁）。\n    - $u_{1,j}=0, v_{1,j}=0$ 对于 $j=1,\\dots,N_y$ （左壁）。\n    - $u_{N_x,j}=0, v_{N_x,j}=0$ 对于 $j=1,\\dots,N_y$ （右壁）。\n    - $u_{i,N_y}=U, v_{i,N_y}=0$ 对于 $i=1,\\dots,N_x$ （顶盖）。\n更新方程仅适用于内部速度节点。\n\n- **压力**：零法向梯度条件 $\\partial p/\\partial n = 0$ 是诺伊曼型条件。使用一个简单而稳健的一阶有限差分近似，将压力从第一个内部节点外推到相应的边界节点。\n    - 左壁 ($n=(-1,0)$): $\\frac{\\partial p}{\\partial x}=0 \\implies p_{1,j} = p_{2,j}$。\n    - 右壁 ($n=(1,0)$): $\\frac{\\partial p}{\\partial x}=0 \\implies p_{N_x,j} = p_{N_x-1,j}$。\n    - 底壁 ($n=(0,-1)$): $\\frac{\\partial p}{\\partial y}=0 \\implies p_{i,1} = p_{i,2}$。\n    - 顶壁 ($n=(0,1)$): $\\frac{\\partial p}{\\partial y}=0 \\implies p_{i,N_y} = p_{i,N_y-1}$。\n这些条件在每一步更新内部点后应用于压力场。\n\n**3. 算法流程**\n完整的数值算法如下：\n1.  **初始化**：设置模拟参数（$N_x, N_y, Re, \\beta, \\Delta\\tau, U, N_{\\max}, \\varepsilon$）。定义网格间距 $\\Delta x$ 和 $\\Delta y$。将 $u, v, p$ 数组初始化为零，然后在顶部边界上应用固定的顶盖速度 $U$。\n2.  **伪时间推进**：从伪时间步 $k=1$ 迭代到 $N_{\\max}$。在每一步中：\n    a.  复制第 $k-1$ 步的场（$u^{k-1}, v^{k-1}, p^{k-1}$）。\n    b.  使用第 $k-1$ 步的场和中心差分，计算动量方程的对流项、压力梯度项和粘性项。\n    c.  使用前向欧拉公式更新内部速度分量 $u$ 和 $v$，以获得 $u^k$ 和 $v^k$。\n    d.  使用第 $k-1$ 步的速度场计算速度散度项。\n    e.  使用前向欧拉公式和人工可压缩性关系更新内部压力 $p$，以获得 $p^k$。\n    f.  将零法向梯度边界条件应用于新计算的压力场 $p^k$。\n3.  **残差计算和收敛性检查**：在计算新状态 $(u^k, v^k, p^k)$ 后：\n    a.  在所有内部点计算新速度场的散度 $D_{i,j} = (\\nabla \\cdot \\boldsymbol{u}^k)_{i,j}$。\n    b.  按照问题陈述中的定义计算 $L^2$-范数残差 $R$。\n    c.  如果 $R \\leq \\varepsilon$，则解已收敛。将当前步数 $k$ 存储为 $N_{\\text{steps}}$，最终残差 $R$ 存储为 $R_{\\text{final}}$，将收敛标志设置为真，并终止循环。\n4.  **终止**：如果循环在达到 $N_{\\max}$ 时仍未满足残差条件，则模拟未收敛。将 $N_{\\max}$ 存储为 $N_{\\text{steps}}$，将最终计算的残差存储为 $R_{\\text{final}}$，并将收敛标志设置为假。\n\n这个从初始化到终止的程序针对每个测试用例实现。使用 NumPy 数组存储场可以高效地对整个内部网格同时进行空间导数的矢量化计算，避免了在 Python 中使用缓慢的显式循环。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        # (Nx, Ny, Re, beta, dt, U, N_max, epsilon)\n        (24, 24, 10, 1.0, 5e-4, 1.0, 4000, 1e-10),\n        (24, 24, 10, 0.2, 5e-4, 1.0, 6000, 1e-10),\n        (16, 16, 50, 2.0, 3e-4, 1.0, 5000, 1e-10),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _solve_case(*case)\n        results.append(result)\n\n    # Format the final output list as specified.\n    # The boolean must be lowercase 'true' or 'false' in Python's string representation.\n    output_str = \"[\" + \",\".join([f\"[{res[0]},{res[1]},{str(res[2]).lower()}]\" for res in results]) + \"]\"\n    print(output_str)\n\ndef _solve_case(Nx, Ny, Re, beta, dt, U, N_max, epsilon):\n    \"\"\"\n    Solves the lid-driven cavity problem for a single test case using the\n    Artificial Compressibility Method.\n    \"\"\"\n    # 1. Grid and Initialization\n    dx = 1.0 / (Nx - 1)\n    dy = 1.0 / (Ny - 1)\n\n    # Initialize fields (u, v, p).\n    # Using (Ny, Nx) indexing to match (row, col) convention, where row ~ y, col ~ x.\n    u = np.zeros((Ny, Nx), dtype=np.float64)\n    v = np.zeros((Ny, Nx), dtype=np.float64)\n    p = np.zeros((Ny, Nx), dtype=np.float64)\n\n    # Apply Dirichlet boundary condition for velocity.\n    # Lid at y=1 (top wall, index Ny-1) moves with velocity U.\n    # Other walls have u=v=0, which is the default from initialization.\n    u[Ny - 1, :] = U\n\n    converged = False\n    final_R = 0.0\n    \n    # 2. Pseudo-Time Marching Loop\n    # The loop counter 'k' represents the number of steps taken.\n    for k in range(1, N_max + 1):\n        # Store fields from previous step (n) for RHS calculation\n        un = u.copy()\n        vn = v.copy()\n        pn = p.copy()\n\n        # --- Calculate RHS terms for interior points (from step n) ---\n        # Slices for interior points: [1:-1, 1:-1]\n        # Slices for neighbors: [1:-1, 2:], [1:-1, :-2], [2:, 1:-1], [:-2, 1:-1]\n        \n        # Convective terms\n        conv_u = (un[1:-1, 1:-1] * (un[1:-1, 2:] - un[1:-1, :-2]) / (2 * dx) +\n                  vn[1:-1, 1:-1] * (un[2:, 1:-1] - un[:-2, 1:-1]) / (2 * dy))\n        conv_v = (un[1:-1, 1:-1] * (vn[1:-1, 2:] - vn[1:-1, :-2]) / (2 * dx) +\n                  vn[1:-1, 1:-1] * (vn[2:, 1:-1] - vn[:-2, 1:-1]) / (2 * dy))\n\n        # Pressure gradient terms\n        grad_p_x = (pn[1:-1, 2:] - pn[1:-1, :-2]) / (2 * dx)\n        grad_p_y = (pn[2:, 1:-1] - pn[:-2, 1:-1]) / (2 * dy)\n\n        # Viscous terms (Laplacian)\n        lap_u = ((un[1:-1, 2:] - 2 * un[1:-1, 1:-1] + un[1:-1, :-2]) / dx**2 +\n                 (un[2:, 1:-1] - 2 * un[1:-1, 1:-1] + un[:-2, 1:-1]) / dy**2)\n        lap_v = ((vn[1:-1, 2:] - 2 * vn[1:-1, 1:-1] + vn[1:-1, :-2]) / dx**2 +\n                 (vn[2:, 1:-1] - 2 * vn[1:-1, 1:-1] + vn[:-2, 1:-1]) / dy**2)\n\n        # --- Update u and v for interior points to step n+1 ---\n        u[1:-1, 1:-1] = un[1:-1, 1:-1] + dt * (-conv_u - grad_p_x + (1 / Re) * lap_u)\n        v[1:-1, 1:-1] = vn[1:-1, 1:-1] + dt * (-conv_v - grad_p_y + (1 / Re) * lap_v)\n        \n        # Velocity BCs are fixed and not modified.\n\n        # --- Update p for interior points to step n+1 ---\n        # Pressure update uses the velocity field from step n for a fully explicit scheme.\n        div_u_old = ((un[1:-1, 2:] - un[1:-1, :-2]) / (2 * dx) +\n                     (vn[2:, 1:-1] - vn[:-2, 1:-1]) / (2 * dy))\n        p[1:-1, 1:-1] = pn[1:-1, 1:-1] - (dt / beta) * div_u_old\n        \n        # Apply pressure BCs (zero normal gradient, 1st-order extrapolation)\n        p[:, 0] = p[:, 1]       # Left wall\n        p[:, -1] = p[:, -2]     # Right wall\n        p[0, :] = p[1, :]       # Bottom wall\n        p[-1, :] = p[-2, :]     # Top wall\n\n        # --- Calculate Residual at step n+1 ---\n        # The residual is the L2 norm of the divergence of the newly computed velocity field.\n        div_u_new = ((u[1:-1, 2:] - u[1:-1, :-2]) / (2 * dx) +\n                     (v[2:, 1:-1] - v[:-2, 1:-1]) / (2 * dy))\n        \n        num_interior_points = (Nx - 2) * (Ny - 2)\n        R = np.sqrt(np.sum(div_u_new**2) / num_interior_points)\n        final_R = R\n\n        # --- Check for convergence ---\n        if R = epsilon:\n            converged = True\n            break\n    \n    # After loop, 'k' holds the total number of steps performed.\n    N_steps = k\n    \n    # If the loop finished by reaching N_max, 'converged' will be False.\n    return [N_steps, final_R, converged]\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}