{
    "hands_on_practices": [
        {
            "introduction": "投影方法的核心是将向量场分解为一个无散度和一个无旋（梯度）部分，这在数学上被称为亥姆霍兹-霍奇分解。在使用谱方法的计算流体力学中，这种分解在傅里叶空间中具有一种特别简洁和强大的形式。这项练习将指导你推导这个傅里叶空间中的投影算子，揭示如何通过滤除向量场在傅里叶空间中平行于波矢量的分量，从而将其投影到一个无散度的子空间上。",
            "id": "3987130",
            "problem": "考虑在边长为 $2\\pi$、具有周期性边界条件的三维周期性立方体上，针对粘性流体的不可压缩纳维-斯托克斯方程。在经典的投影（分数步长）法中，我们通过从给定的中间速度 $\\boldsymbol{v}(\\boldsymbol{x})$ 中减去一个梯度来构造一个无散速度 $\\boldsymbol{w}(\\boldsymbol{x})$：\n$$\n\\boldsymbol{w}(\\boldsymbol{x}) \\;=\\; \\boldsymbol{v}(\\boldsymbol{x}) \\;-\\; \\nabla \\phi(\\boldsymbol{x}),\n$$\n其中标量势 $\\phi(\\boldsymbol{x})$ 的选择需满足 $\\nabla \\cdot \\boldsymbol{w}(\\boldsymbol{x})=0$。令 $\\widehat{\\boldsymbol{v}}(\\boldsymbol{k})$ 表示 $\\boldsymbol{v}(\\boldsymbol{x})$ 在整数波矢 $\\boldsymbol{k}\\in\\mathbb{Z}^{3}$ 处的傅里叶系数，$\\widehat{\\boldsymbol{w}}(\\boldsymbol{k})$ 和 $\\widehat{\\phi}(\\boldsymbol{k})$ 的定义类似。仅使用以下基础：\n- 不可压缩性要求 $\\nabla \\cdot \\boldsymbol{w}(\\boldsymbol{x})=0$。\n- 分解式 $\\boldsymbol{w}=\\boldsymbol{v}-\\nabla\\phi$ 是投影法的定义步骤。\n- 在周期性域上，梯度的傅里叶符号是 $i\\boldsymbol{k}$，拉普拉斯算子的傅里叶符号是 $-|\\boldsymbol{k}|^{2}$。\n\n任务：\n1. 推导投影算子 $\\mathcal{P}$ 的傅里叶空间表示，该算子将任意矢量傅里叶模 $\\widehat{\\boldsymbol{v}}(\\boldsymbol{k})$ 映射到其无散对应项 $\\widehat{\\boldsymbol{w}}(\\boldsymbol{k})$。\n2. 对于特定模式 $\\boldsymbol{k}=(1,2,2)$ 和给定的中间傅里叶系数 $\\widehat{\\boldsymbol{v}}(\\boldsymbol{k})=(3,\\,-1,\\,4)$，计算投影后的模式 $\\widehat{\\boldsymbol{w}}(\\boldsymbol{k})$。\n\n将最终答案表示为一个包含 $\\widehat{\\boldsymbol{w}}(\\boldsymbol{k})$ 三个分量的单行向量。无需四舍五入。",
            "solution": "该问题是有效的，因为它科学地基于计算流体动力学的原理，特别是用于不可压缩流的投影法。该问题是适定的、客观的，并包含了推导投影算子和计算所需量所需的所有必要信息。\n\n解答过程按任务要求分为两部分。首先，我们推导投影算子的通用傅里叶空间表示。其次，我们将此算子应用于给定的特定中间速度模式。\n\n**第1部分：傅里叶空间投影算子的推导**\n\n投影法将任意矢量场 $\\boldsymbol{v}(\\boldsymbol{x})$ 分解为一个无散部分 $\\boldsymbol{w}(\\boldsymbol{x})$ 和一个梯度部分 $\\nabla\\phi(\\boldsymbol{x})$。该分解的控制方程如下：\n$$\n\\boldsymbol{w}(\\boldsymbol{x}) = \\boldsymbol{v}(\\boldsymbol{x}) - \\nabla \\phi(\\boldsymbol{x})\n$$\n得到的场 $\\boldsymbol{w}(\\boldsymbol{x})$ 要求是无散的，这施加了以下约束条件：\n$$\n\\nabla \\cdot \\boldsymbol{w}(\\boldsymbol{x}) = 0\n$$\n为了找到标量势 $\\phi(\\boldsymbol{x})$ 的方程，我们对第一个方程取散度：\n$$\n\\nabla \\cdot \\boldsymbol{w}(\\boldsymbol{x}) = \\nabla \\cdot \\boldsymbol{v}(\\boldsymbol{x}) - \\nabla \\cdot (\\nabla \\phi(\\boldsymbol{x}))\n$$\n使用矢量微积分恒等式 $\\nabla \\cdot (\\nabla \\phi) = \\nabla^2 \\phi$，其中 $\\nabla^2$ 是拉普拉斯算子，我们得到：\n$$\n\\nabla \\cdot \\boldsymbol{w}(\\boldsymbol{x}) = \\nabla \\cdot \\boldsymbol{v}(\\boldsymbol{x}) - \\nabla^2 \\phi(\\boldsymbol{x})\n$$\n应用不可压缩性约束 $\\nabla \\cdot \\boldsymbol{w}(\\boldsymbol{x}) = 0$，我们得到关于 $\\phi(\\boldsymbol{x})$ 的泊松方程：\n$$\n\\nabla^2 \\phi(\\boldsymbol{x}) = \\nabla \\cdot \\boldsymbol{v}(\\boldsymbol{x})\n$$\n现在我们将这些方程变换到傅里叶空间。令 $\\widehat{f}(\\boldsymbol{k}) = \\mathcal{F}(f(\\boldsymbol{x}))$ 表示函数 $f(\\boldsymbol{x})$ 在波矢 $\\boldsymbol{k} \\in \\mathbb{Z}^3$ 处的傅里叶系数。使用所提供的梯度 ($\\nabla \\to i\\boldsymbol{k}$)、散度 ($\\nabla \\cdot \\to i\\boldsymbol{k}\\cdot$) 和拉普拉斯算子 ($\\nabla^2 \\to -|\\boldsymbol{k}|^2$) 的傅里叶符号，方程变为：\n$$\n\\widehat{\\boldsymbol{w}}(\\boldsymbol{k}) = \\widehat{\\boldsymbol{v}}(\\boldsymbol{k}) - i\\boldsymbol{k}\\widehat{\\phi}(\\boldsymbol{k})\n$$\n且势的泊松方程变为：\n$$\n-|\\boldsymbol{k}|^2 \\widehat{\\phi}(\\boldsymbol{k}) = i\\boldsymbol{k} \\cdot \\widehat{\\boldsymbol{v}}(\\boldsymbol{k})\n$$\n对于任意非零波矢 $\\boldsymbol{k} \\neq \\boldsymbol{0}$，我们可以解出 $\\widehat{\\phi}(\\boldsymbol{k})$：\n$$\n\\widehat{\\phi}(\\boldsymbol{k}) = -\\frac{i\\boldsymbol{k} \\cdot \\widehat{\\boldsymbol{v}}(\\boldsymbol{k})}{|\\boldsymbol{k}|^2}\n$$\n$\\boldsymbol{k}=\\boldsymbol{0}$ 的情况对应于平均流，其自然是无散的，因此不需要投影。对于 $\\boldsymbol{k} \\neq \\boldsymbol{0}$，我们将 $\\widehat{\\phi}(\\boldsymbol{k})$ 的表达式代回到 $\\widehat{\\boldsymbol{w}}(\\boldsymbol{k})$ 的方程中：\n$$\n\\widehat{\\boldsymbol{w}}(\\boldsymbol{k}) = \\widehat{\\boldsymbol{v}}(\\boldsymbol{k}) - i\\boldsymbol{k} \\left( -\\frac{i\\boldsymbol{k} \\cdot \\widehat{\\boldsymbol{v}}(\\boldsymbol{k})}{|\\boldsymbol{k}|^2} \\right)\n$$\n化简表达式，注意到 $i \\times (-i) = -i^2 = -(-1) = 1$：\n$$\n\\widehat{\\boldsymbol{w}}(\\boldsymbol{k}) = \\widehat{\\boldsymbol{v}}(\\boldsymbol{k}) - \\frac{\\boldsymbol{k}(\\boldsymbol{k} \\cdot \\widehat{\\boldsymbol{v}}(\\boldsymbol{k}))}{|\\boldsymbol{k}|^2}\n$$\n这个方程定义了投影算子 $\\mathcal{P}$ 在傅里叶空间中的作用，使得 $\\widehat{\\boldsymbol{w}}(\\boldsymbol{k}) = \\mathcal{P}(\\boldsymbol{k})\\widehat{\\boldsymbol{v}}(\\boldsymbol{k})$。这个算子可以使用单位矩阵 $\\boldsymbol{I}$ 和外积（或张量积）$\\boldsymbol{k} \\otimes \\boldsymbol{k}$ 写成矩阵形式：\n$$\n\\mathcal{P}(\\boldsymbol{k}) = \\boldsymbol{I} - \\frac{\\boldsymbol{k} \\otimes \\boldsymbol{k}}{|\\boldsymbol{k}|^2}\n$$\n该算子将任意矢量 $\\widehat{\\boldsymbol{v}}(\\boldsymbol{k})$ 投影到与波矢 $\\boldsymbol{k}$ 正交的平面上，从而移除了其纵向分量，并确保结果 $\\widehat{\\boldsymbol{w}}(\\boldsymbol{k})$ 是无散的（$i\\boldsymbol{k} \\cdot \\widehat{\\boldsymbol{w}}(\\boldsymbol{k})=0$）。\n\n**第2部分：针对特定模式的计算**\n\n我们给定了特定的波矢 $\\boldsymbol{k}$ 和中间速度傅里叶系数 $\\widehat{\\boldsymbol{v}}(\\boldsymbol{k})$：\n$$\n\\boldsymbol{k} = (1, 2, 2)\n$$\n$$\n\\widehat{\\boldsymbol{v}}(\\boldsymbol{k}) = (3, -1, 4)\n$$\n首先，我们计算波矢模的平方 $|\\boldsymbol{k}|^2$：\n$$\n|\\boldsymbol{k}|^2 = k_1^2 + k_2^2 + k_3^2 = 1^2 + 2^2 + 2^2 = 1 + 4 + 4 = 9\n$$\n接下来，我们计算点积 $\\boldsymbol{k} \\cdot \\widehat{\\boldsymbol{v}}(\\boldsymbol{k})$：\n$$\n\\boldsymbol{k} \\cdot \\widehat{\\boldsymbol{v}}(\\boldsymbol{k}) = k_1 \\widehat{v}_1 + k_2 \\widehat{v}_2 + k_3 \\widehat{v}_3 = (1)(3) + (2)(-1) + (2)(4) = 3 - 2 + 8 = 9\n$$\n现在我们使用推导出的公式来计算投影后的模式 $\\widehat{\\boldsymbol{w}}(\\boldsymbol{k})$：\n$$\n\\widehat{\\boldsymbol{w}}(\\boldsymbol{k}) = \\widehat{\\boldsymbol{v}}(\\boldsymbol{k}) - \\frac{\\boldsymbol{k} (\\boldsymbol{k} \\cdot \\widehat{\\boldsymbol{v}}(\\boldsymbol{k}))}{|\\boldsymbol{k}|^2}\n$$\n代入计算出的值：\n$$\n\\widehat{\\boldsymbol{w}}(\\boldsymbol{k}) = (3, -1, 4) - \\frac{(1, 2, 2) (9)}{9}\n$$\n$$\n\\widehat{\\boldsymbol{w}}(\\boldsymbol{k}) = (3, -1, 4) - (1, 2, 2)\n$$\n按分量进行矢量减法：\n$$\n\\widehat{w}_1(\\boldsymbol{k}) = 3 - 1 = 2\n$$\n$$\n\\widehat{w}_2(\\boldsymbol{k}) = -1 - 2 = -3\n$$\n$$\n\\widehat{w}_3(\\boldsymbol{k}) = 4 - 2 = 2\n$$\n因此，投影后的傅里叶模式为 $\\widehat{\\boldsymbol{w}}(\\boldsymbol{k}) = (2, -3, 2)$。作为验证步骤，我们可以检查这个结果矢量确实与 $\\boldsymbol{k}$ 正交：\n$$\n\\boldsymbol{k} \\cdot \\widehat{\\boldsymbol{w}}(\\boldsymbol{k}) = (1)(2) + (2)(-3) + (2)(2) = 2 - 6 + 4 = 0\n$$\n由于点积为零，得到的模式是螺线型的（在傅里叶空间中是无散的），符合要求。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  -3  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在推导出投影算子的理论形式之后，下一步是将其应用于实际的数值计算中。这项动手实践要求你将理论转化为代码，使用快速傅里叶变换（FFT）来实现一个完整的投影步骤。通过构建并测试这个数值工具，你将验证该方法确实能在离散层面上精确地强制施加不可压缩约束，这是任何可靠的不可压缩流模拟的基石。",
            "id": "4082126",
            "problem": "你需要设计并实现一个质量守恒的投影步，该投影步用于不可压缩复杂流体的分步法中，以在新时间层级上强制执行离散质量守恒。从质量守恒和不可压缩性的定义出发，构建一个投影，该投影将一个中间速度场映射到二维周期性域上的一个无散场。该域为具有周期性边界条件的单位环面，即 $[0,1]^2$，在一个x方向有 $N_x$ 个点、y方向有 $N_y$ 个点的均匀网格上进行离散。在显式非压力更新后，时间层级 $n$ 的中间速度场表示为 $\\mathbf{u}^\\star(x,y) = (u^\\star(x,y), v^\\star(x,y))$，目标是生成一个速度场 $\\mathbf{u}^{n+1}(x,y)$，使其在离散层面上满足 $\\nabla \\cdot \\mathbf{u}^{n+1}(x,y) = 0$ 直至机器精度。\n\n你的构建必须基于周期性网格上一对一致且互为伴随的离散梯度和散度算子，从而使投影步能够精确地（在浮点舍入误差范围内）强制执行离散连续性方程。此步骤在概念上必须求解一个关于标量势的离散泊松方程，该标量势用于校正中间速度并保证得到一个无散的结果。核心科学基础必须从质量守恒定律和不可压缩性的定义开始。问题陈述中不允许使用任何快捷公式；你需要在你的解决方案中推导出所需的一切。\n\n以可复现且数值稳健的方式实现你在周期性单位平方上的投影。所有计算都应是无量纲的。若有角度，则隐式地解释为弧度，因为所用的函数是标准数学意义上的三角函数；但是，你无需在输出中报告任何角度。\n\n你的程序必须：\n- 在给定的网格上构建测试速度场 $\\mathbf{u}^\\star(x,y)$。\n- 应用你的质量守恒投影以获得 $\\mathbf{u}^{n+1}(x,y)$。\n- 使用作为你投影机制基础的相同离散算子，计算 $\\mathbf{u}^{n+1}(x,y)$ 的离散散度。\n- 对每个测试案例，报告整个网格上离散散度的最大绝对值，作为一个浮点数。\n\n测试套件：\n- 案例 1：$N_x = 32$, $N_y = 32$。对于整数 $i \\in \\{0,\\dots,N_x-1\\}$ 和 $j \\in \\{0,\\dots,N_y-1\\}$，定义 $x_i = i/N_x$, $y_j = j/N_y$。设标量场 $\\psi(x,y) = \\sin(2\\pi x)\\cos(2\\pi y)$ 和 $\\phi(x,y) = \\sin(2\\pi x)\\sin(2\\pi y)$。定义一个势流梯度分量 $\\mathbf{u}_{\\mathrm{grad}} = \\nabla \\psi$ 和一个无散旋转分量 $\\mathbf{u}_{\\mathrm{vort}} = (-\\partial_y \\phi, \\partial_x \\phi)$。设置 $\\mathbf{u}^\\star = \\mathbf{u}_{\\mathrm{grad}} + \\mathbf{u}_{\\mathrm{vort}} + 0.1\\,\\boldsymbol{\\eta}$，其中 $\\boldsymbol{\\eta}$ 是一个确定性伪随机场，其分量从种子设置为 $0$ 的标准正态分布中抽取，并对每个分量整形为 $(N_x,N_y)$。\n- 案例 2：$N_x = 33$, $N_y = 17$。设 $\\mathbf{u}^\\star = \\boldsymbol{\\eta} + \\mathbf{c}$，其中 $\\boldsymbol{\\eta}$ 同上但种子设置为 $0$，$\\mathbf{c} = (1.5, -0.75)$ 是一个恒定的均匀速度向量。\n- 案例 3：$N_x = 64$, $N_y = 64$。设 $\\psi(x,y) = \\cos(4\\pi x)\\sin(2\\pi y)$ 并设置 $\\mathbf{u}^\\star = \\nabla \\psi$（一个纯梯度场）。\n- 案例 4：$N_x = 8$, $N_y = 8$。设 $\\phi(x,y) = \\sin(2\\pi x)\\sin(2\\pi y)$ 并设置 $\\mathbf{u}^\\star = 3\\,(-\\partial_y \\phi, \\partial_x \\phi)$（一个经过缩放的无散场）。\n- 案例 5：$N_x = 16$, $N_y = 24$。设 $\\mathbf{u}^\\star = \\boldsymbol{\\eta}$，种子设置为 $42$，其分量从标准正态分布中抽取。\n\n定义和要求：\n- 使用与周期性边界条件一致的离散傅里叶变换来实现离散梯度、散度和泊松方程的求解。以快速傅里叶变换（FFT）作为数值计算机制。\n- 必须使用与投影构建中所用波数相同的波数，通过谱方法计算离散散度，以确保伴随性和精确抵消（在浮点误差范围内）。\n- 对每个案例，计算 $\\mathbf{u}^{n+1}$ 的最大绝对离散散度，并将其作为浮点值返回。\n\n最终输出格式：\n- 你的程序应产生单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4,\\mathrm{result}_5]$）。每个结果必须是一个浮点数。",
            "solution": "该问题要求在二维周期性域上为不可压缩流体设计并实现一个质量守恒的投影步。解决方案必须从第一性原理（特别是质量守恒）推导得出，并使用基于快速傅里叶变换（FFT）的谱方法实现。\n\n控制流体运动的基本原理是质量守恒，由连续性方程表示：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\n其中 $\\rho$ 是流体密度，$\\mathbf{u}$ 是速度场。对于作为不可压缩流体处理的复杂流体，密度 $\\rho$ 被假定在空间和时间上均为常数。因此，其偏导数为零，$\\frac{\\partial \\rho}{\\partial t} = 0$ 且 $\\nabla \\rho = \\mathbf{0}$。连续性方程简化为：\n$$\n\\rho (\\nabla \\cdot \\mathbf{u}) = 0\n$$\n由于 $\\rho > 0$，这得到了不可压缩性约束，这是对速度场的一个运动学条件：\n$$\n\\nabla \\cdot \\mathbf{u} = 0\n$$\n该方程表明，不可压缩流的速度场必须是无散的。\n\n分步法，或称投影法，通常用于求解不可压缩流的时间相关Navier-Stokes方程。它们将速度和压力的计算解耦。在一个典型的两步格式中，首先通过推进不含压力梯度项的动量方程，计算出时间层级 $n+1$ 的一个中间速度场，记为 $\\mathbf{u}^\\star$。这个场 $\\mathbf{u}^\\star$ 通常不满足不可压缩性约束。\n\n第二步，即投影步，校正 $\\mathbf{u}^\\star$ 以产生一个离散无散的速度场 $\\mathbf{u}^{n+1}$。这是通过引入压力梯度的效应来实现的。校正由下式给出：\n$$\n\\frac{\\mathbf{u}^{n+1} - \\mathbf{u}^\\star}{\\Delta t} = -\\nabla p^{n+1}\n$$\n其中 $p^{n+1}$ 与压力有关，$\\Delta t$ 是时间步长。对于我们的无量纲问题，我们可以将 $\\Delta t$ 吸收到一个标量势 $\\Phi$ 中，使得更新变为：\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^\\star - \\nabla \\Phi\n$$\n这是亥姆霍兹-霍奇分解的一个陈述，该分解指出任何向量场 $\\mathbf{u}^\\star$ 都可以唯一地分解为一个无散分量（$\\mathbf{u}^{n+1}$）和一个无旋（梯度）分量（$\\nabla \\Phi$）。\n\n为了找到势 $\\Phi$，我们对最终速度场施加不可压缩性约束，即 $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$。对校正方程应用散度算子，我们得到：\n$$\n\\nabla \\cdot \\mathbf{u}^{n+1} = \\nabla \\cdot \\mathbf{u}^\\star - \\nabla \\cdot (\\nabla \\Phi)\n$$\n设置 $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$ 导出了关于标量势 $\\Phi$ 的泊松方程：\n$$\n\\nabla^2 \\Phi = \\nabla \\cdot \\mathbf{u}^\\star\n$$\n求解这个关于 $\\Phi$ 的方程，我们就可以计算梯度 $\\nabla \\Phi$，并随后得到最终的无散速度场 $\\mathbf{u}^{n+1}$。\n\n对于指定的周期性域 $[0,1]^2$，使用离散傅里叶变换（DFT）的谱方法因其高精度和FFT算法的高效率而特别适用。在傅里叶空间中，微分算子变成代数乘法算子。网格上的函数 $f(x,y)$ 变换为其傅里叶系数 $\\hat{f}(k_x, k_y)$，其中 $k_x$ 和 $k_y$ 是波数。微分算子变换如下：\n$$\n\\mathcal{F}\\left(\\frac{\\partial f}{\\partial x}\\right) = i k_x \\hat{f} \\quad \\text{和} \\quad \\mathcal{F}\\left(\\frac{\\partial f}{\\partial y}\\right) = i k_y \\hat{f}\n$$\n其中 $\\mathcal{F}$ 表示傅里叶变换。\n\n对于尺寸为 $L_x=1$, $L_y=1$ 且分别有 $N_x$ 和 $N_y$ 个点的域，离散波数由 $k_x = 2\\pi m$ 和 $k_y = 2\\pi n$ 给出，其中 $m$ 和 $n$ 是整数模。这些波数使用 `scipy.fft.fftfreq` 计算。具体来说，$k_x = 2\\pi \\times \\text{fftfreq}(N_x, 1/N_x)$ 和 $k_y = 2\\pi \\times \\text{fftfreq}(N_y, 1/N_y)$。\n\n对泊松方程 $\\nabla^2 \\Phi = \\nabla \\cdot \\mathbf{u}^\\star$ 应用傅里叶变换：\n$$\n\\mathcal{F}(\\nabla^2 \\Phi) = \\mathcal{F}(\\nabla \\cdot \\mathbf{u}^\\star)\n$$\n左侧变为：\n$$\n\\mathcal{F}(\\nabla^2 \\Phi) = \\mathcal{F}\\left(\\frac{\\partial^2 \\Phi}{\\partial x^2} + \\frac{\\partial^2 \\Phi}{\\partial y^2}\\right) = ((ik_x)^2 + (ik_y)^2)\\hat{\\Phi} = -(k_x^2 + k_y^2)\\hat{\\Phi}\n$$\n右侧，即 $\\mathbf{u}^\\star = (u^\\star, v^\\star)$ 的散度，变为：\n$$\n\\mathcal{F}(\\nabla \\cdot \\mathbf{u}^\\star) = \\mathcal{F}\\left(\\frac{\\partial u^\\star}{\\partial x} + \\frac{\\partial v^\\star}{\\partial y}\\right) = i k_x \\hat{u}^\\star + i k_y \\hat{v}^\\star\n$$\n将它们组合起来，得到傅里叶空间中关于 $\\hat{\\Phi}$ 的代数方程：\n$$\n-(k_x^2 + k_y^2)\\hat{\\Phi} = i k_x \\hat{u}^\\star + i k_y \\hat{v}^\\star\n$$\n我们可以解出 $\\hat{\\Phi}$：\n$$\n\\hat{\\Phi}(k_x, k_y) = - \\frac{i k_x \\hat{u}^\\star + i k_y \\hat{v}^\\star}{k_x^2 + k_y^2}\n$$\n对于零波数模式 $(k_x, k_y) = (0,0)$，会出现一个特殊情况，此时分母 $k_x^2+k_y^2$ 为零。该模式对应于场的平均值。对于此模式，分子也为零，$i(0)\\hat{u}^\\star_{0,0} + i(0)\\hat{v}^\\star_{0,0} = 0$。这种 $0/0$ 不定性反映了势 $\\Phi$ 的确定只到一个任意常数的程度。我们可以通过设置 $\\hat{\\Phi}(0,0) = 0$ 来解决这个问题，这对应于选择空间平均值为零的唯一势函数。\n\n一旦 $\\hat{\\Phi}$ 已知，我们就可以找到投影后速度 $\\mathbf{u}^{n+1} = \\mathbf{u}^\\star - \\nabla \\Phi$ 的傅里叶变换：\n$$\n\\hat{u}^{n+1} = \\hat{u}^\\star - i k_x \\hat{\\Phi}\n$$\n$$\n\\hat{v}^{n+1} = \\hat{v}^\\star - i k_y \\hat{\\Phi}\n$$\n最后，通过应用逆傅里叶变换 $\\mathcal{F}^{-1}$ 恢复实空间速度场 $\\mathbf{u}^{n+1}$。\n\n为了验证结果，我们使用相同的谱算子计算 $\\mathbf{u}^{n+1}$ 的离散散度。在傅里叶空间中，这是：\n$$\n\\widehat{\\nabla \\cdot \\mathbf{u}^{n+1}} = i k_x \\hat{u}^{n+1} + i k_y \\hat{v}^{n+1}\n$$\n代入 $\\hat{u}^{n+1}$ 和 $\\hat{v}^{n+1}$ 的表达式：\n$$\n\\widehat{\\nabla \\cdot \\mathbf{u}^{n+1}} = i k_x (\\hat{u}^\\star - i k_x \\hat{\\Phi}) + i k_y (\\hat{v}^\\star - i k_y \\hat{\\Phi})\n= (i k_x \\hat{u}^\\star + i k_y \\hat{v}^\\star) - ( (ik_x)^2 + (ik_y)^2 ) \\hat{\\Phi}\n= (i k_x \\hat{u}^\\star + i k_y \\hat{v}^\\star) + (k_x^2 + k_y^2) \\hat{\\Phi}\n$$\n代入 $\\hat{\\Phi}$ 的解：\n$$\n= (i k_x \\hat{u}^\\star + i k_y \\hat{v}^\\star) + (k_x^2 + k_y^2) \\left( - \\frac{i k_x \\hat{u}^\\star + i k_y \\hat{v}^\\star}{k_x^2 + k_y^2} \\right) = 0\n$$\n这对所有 $(k_x, k_y) \\neq (0,0)$ 成立。对于 $(k_x, k_y)=(0,0)$，所有项都为零。因此，在傅里叶空间中，投影场的散度在解析上为零。其逆变换结果将在浮点舍入误差范围内为零。该场的最大绝对值即为所需输出。",
            "answer": "```python\nimport numpy as np\nimport scipy.fft\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n\n    test_cases = [\n        {'Nx': 32, 'Ny': 32, 'case_type': 'grad_vort_noise', 'seed': 0},\n        {'Nx': 33, 'Ny': 17, 'case_type': 'noise_const', 'seed': 0},\n        {'Nx': 64, 'Ny': 64, 'case_type': 'pure_grad', 'seed': None},\n        {'Nx': 8, 'Ny': 8, 'case_type': 'pure_vort', 'seed': None},\n        {'Nx': 16, 'Ny': 24, 'case_type': 'pure_noise', 'seed': 42},\n    ]\n\n    results = []\n    for params in test_cases:\n        result = _solve_single_case(params)\n        results.append(result)\n\n    print(f\"[{','.join(f'{r:.16e}' for r in results)}]\")\n\ndef _solve_single_case(params):\n    \"\"\"\n    Solves a single test case for the projection problem.\n    \"\"\"\n    Nx = params['Nx']\n    Ny = params['Ny']\n    case_type = params['case_type']\n    seed = params['seed']\n    \n    # 1. Construct the grid\n    x = np.arange(Nx) / Nx\n    y = np.arange(Ny) / Ny\n    xx, yy = np.meshgrid(x, y, indexing='ij')\n\n    # 2. Construct the intermediate velocity field u_star\n    pi = np.pi\n    u_star, v_star = None, None\n    rng = np.random.default_rng(seed) if seed is not None else None\n\n    if case_type == 'grad_vort_noise':\n        # Case 1: Grad + Vort + Noise\n        psi = np.sin(2 * pi * xx) * np.cos(2 * pi * yy)\n        dpsi_dx = 2 * pi * np.cos(2 * pi * xx) * np.cos(2 * pi * yy)\n        dpsi_dy = -2 * pi * np.sin(2 * pi * xx) * np.sin(2 * pi * yy)\n\n        phi_vort = np.sin(2 * pi * xx) * np.sin(2 * pi * yy)\n        dphi_dx = 2 * pi * np.cos(2 * pi * xx) * np.sin(2 * pi * yy)\n        dphi_dy = 2 * pi * np.sin(2 * pi * xx) * np.cos(2 * pi * yy)\n        \n        eta_x = rng.standard_normal(size=(Nx, Ny))\n        eta_y = rng.standard_normal(size=(Nx, Ny))\n\n        u_star = dpsi_dx - dphi_dy + 0.1 * eta_x\n        v_star = dpsi_dy + dphi_dx + 0.1 * eta_y\n\n    elif case_type == 'noise_const':\n        # Case 2: Noise + Constant\n        c = (1.5, -0.75)\n        eta_x = rng.standard_normal(size=(Nx, Ny))\n        eta_y = rng.standard_normal(size=(Nx, Ny))\n        u_star = eta_x + c[0]\n        v_star = eta_y + c[1]\n\n    elif case_type == 'pure_grad':\n        # Case 3: Pure gradient field\n        psi = np.cos(4 * pi * xx) * np.sin(2 * pi * yy)\n        u_star = -4 * pi * np.sin(4 * pi * xx) * np.sin(2 * pi * yy)\n        v_star = 2 * pi * np.cos(4 * pi * xx) * np.cos(2 * pi * yy)\n\n    elif case_type == 'pure_vort':\n        # Case 4: Purely rotational (divergence-free) field\n        phi_vort = np.sin(2 * pi * xx) * np.sin(2 * pi * yy)\n        dphi_dx = 2 * pi * np.cos(2 * pi * xx) * np.sin(2 * pi * yy)\n        dphi_dy = 2 * pi * np.sin(2 * pi * xx) * np.cos(2 * pi * yy)\n        u_star = 3.0 * (-dphi_dy)\n        v_star = 3.0 * (dphi_dx)\n\n    elif case_type == 'pure_noise':\n        # Case 5: Pure noise\n        u_star = rng.standard_normal(size=(Nx, Ny))\n        v_star = rng.standard_normal(size=(Nx, Ny))\n    \n    # 3. Perform the projection\n    u_proj, v_proj = _project_velocity(u_star, v_star, Nx, Ny)\n\n    # 4. Compute the divergence of the projected field\n    divergence_field = _calculate_divergence(u_proj, v_proj, Nx, Ny)\n\n    # 5. Return the maximum absolute divergence\n    return np.max(np.abs(divergence_field))\n\ndef _project_velocity(u, v, Nx, Ny):\n    \"\"\"\n    Projects a velocity field (u, v) onto its divergence-free part.\n    \"\"\"\n    # Create wavenumber grids\n    kx_1d = 2 * np.pi * scipy.fft.fftfreq(Nx, d=1.0/Nx)\n    ky_1d = 2 * np.pi * scipy.fft.fftfreq(Ny, d=1.0/Ny)\n    kx, ky = np.meshgrid(kx_1d, ky_1d, indexing='ij')\n\n    # FFT of the velocity field\n    u_hat = scipy.fft.fft2(u)\n    v_hat = scipy.fft.fft2(v)\n\n    # Compute FFT of divergence of (u, v)\n    div_u_hat = 1j * kx * u_hat + 1j * ky * v_hat\n\n    # Solve Poisson equation for the potential phi in Fourier space\n    k_squared = kx**2 + ky**2\n    # Handle the k=0 mode to avoid division by zero\n    k_squared[0, 0] = 1.0  # Denominator is non-zero\n    \n    phi_hat = -div_u_hat / k_squared\n    # The numerator at k=0 is already zero, so this enforces phi_hat(0,0)=0\n\n    # Correct the velocity field in Fourier space\n    u_proj_hat = u_hat - 1j * kx * phi_hat\n    v_proj_hat = v_hat - 1j * ky * phi_hat\n\n    # Inverse FFT to get the projected velocity field in real space\n    u_proj = scipy.fft.ifft2(u_proj_hat).real\n    v_proj = scipy.fft.ifft2(v_proj_hat).real\n    \n    return u_proj, v_proj\n\ndef _calculate_divergence(u, v, Nx, Ny):\n    \"\"\"\n    Computes the divergence of a velocity field (u, v) using spectral methods.\n    \"\"\"\n    # Create wavenumber grids\n    kx_1d = 2 * np.pi * scipy.fft.fftfreq(Nx, d=1.0/Nx)\n    ky_1d = 2 * np.pi * scipy.fft.fftfreq(Ny, d=1.0/Ny)\n    kx, ky = np.meshgrid(kx_1d, ky_1d, indexing='ij')\n\n    # FFT of the velocity field\n    u_hat = scipy.fft.fft2(u)\n    v_hat = scipy.fft.fft2(v)\n\n    # Compute divergence in Fourier space\n    div_u_hat = 1j * kx * u_hat + 1j * ky * v_hat\n\n    # Inverse FFT to get divergence in real space\n    divergence = scipy.fft.ifft2(div_u_hat).real\n    \n    return divergence\n\nsolve()\n```"
        },
        {
            "introduction": "分数步法（或算子分裂法）的强大之处在于它将复杂的物理过程分解为更简单的子步骤，但这并非没有代价。这种“分裂”会引入一种特定的误差，称为分裂误差。这项高级练习将引导你使用贝克-坎贝尔-豪斯多夫（Baker–Campbell–Hausdorff, BCH）公式来分析这种误差的来源和形式。通过推导主导误差项，你将发现误差源于对流和扩散算子的不对易性，并能精确量化这一误差，从而深刻理解该方法的精度限制。",
            "id": "3987160",
            "problem": "考虑用于计算流体动力学 (CFD) 中投影法和分数步长法的不可压缩动量方程，该方程具有显式平流子步和隐式扩散子步。令 $\\boldsymbol{w}(\\boldsymbol{x})$ 为一个光滑、无散的平流速度场，$\\nu(\\boldsymbol{x})$ 为一个光滑、空间变化的运动粘度。定义作用于向量场 $\\boldsymbol{u}(\\boldsymbol{x},t)$ 的线性平流和扩散算子如下：\n$$\nA \\boldsymbol{u} \\equiv - (\\boldsymbol{w} \\cdot \\nabla)\\,\\boldsymbol{u}, \n\\qquad \nB \\boldsymbol{u} \\equiv \\nabla \\cdot \\left( \\nu \\nabla \\boldsymbol{u} \\right),\n$$\n其中 $B$ 逐分量作用，即 $(B \\boldsymbol{u})_{k} = \\partial_{i}\\!\\left(\\nu\\,\\partial_{i} u_{k}\\right)$，这里对重复的空间指标 $i$ 和 $j$（从 $1$ 到 $d$，$d \\in \\{2,3\\}$）使用了爱因斯坦求和约定。考虑在大小为 $\\Delta t > 0$ 的单个时间步上的 Lie 分裂，其定义为首先应用扩散，然后应用平流，因此单步传播子为 $\\exp(\\Delta t A)\\exp(\\Delta t B)$，作为对由组合算子生成的精确演化 $\\exp(\\Delta t (A+B))$ 的近似。\n\n使用 Baker–Campbell–Hausdorff (BCH) 展开式，推导领头阶局部格式分裂误差算子，并用指标记法将其明确表示为一个作用于 $\\boldsymbol{u}(\\boldsymbol{x},t^{n})$ 的交换子，用 $\\boldsymbol{w}(\\boldsymbol{x})$、$\\nu(\\boldsymbol{x})$ 和 $\\boldsymbol{u}$ 的直到三阶的空间导数来表示。您的最终答案必须是对应于 Lie 组合 $\\exp(\\Delta t A)\\exp(\\Delta t B)$ 的、在时间层 $t^{n}$ 上的领头交换子误差项的第 $k$ 个分量的单一闭式解析表达式，并使用关于空间指标的爱因斯坦求和约定书写。不要通过假设 $\\nu$ 或 $\\boldsymbol{w}$ 为常数来进行简化。不需要进行数值计算。最终答案以无单位形式表示。",
            "solution": "用户要求推导应用于平流-扩散方程的 Lie 分裂格式的领头阶局部格式分裂误差。\n\n### 步骤 1：问题验证\n\n**1.1. 提取的已知条件：**\n- **平流速度：** 一个光滑、无散的向量场 $\\boldsymbol{w}(\\boldsymbol{x})$，意味着 $\\partial_j w_j = 0$（使用爱因斯坦求和约定）。\n- **运动粘度：** 一个光滑、空间变化的标量场 $\\nu(\\boldsymbol{x})$。\n- **平流算子：** $A \\boldsymbol{u} \\equiv - (\\boldsymbol{w} \\cdot \\nabla)\\,\\boldsymbol{u}$。在指标记法中，对于第 $k$ 个分量，$(A \\boldsymbol{u})_{k} = -w_j \\partial_j u_k$。\n- **扩散算子：** $B \\boldsymbol{u} \\equiv \\nabla \\cdot \\left( \\nu \\nabla \\boldsymbol{u} \\right)$。在指标记法中，逐分量作用，$(B \\boldsymbol{u})_{k} = \\partial_{i}\\!\\left(\\nu\\,\\partial_{i} u_{k}\\right)$。\n- **分裂格式：** 在时间步长 $\\Delta t > 0$ 上的 Lie 分裂，其中首先应用扩散，然后应用平流。单步传播子为 $\\exp(\\Delta t A)\\exp(\\Delta t B)$。\n- **精确演化算子：** $\\exp(\\Delta t (A+B))$。\n- **目标：** 推导领头阶局部格式分裂误差算子，表示为作用于向量场 $\\boldsymbol{u}(\\boldsymbol{x},t^{n})$ 的交换子，并提供其第 $k$ 个分量的显式表达式。\n\n**1.2. 验证：**\n- **科学依据：** 该问题牢固地植根于计算流体动力学和数值分析领域。平流-扩散方程、算子分裂方法（特别是 Lie 分裂）以及使用 Baker–Campbell–Hausdorff 公式分析误差都是标准且成熟的概念。\n- **良定性：** 该问题是良定的。它要求基于明确定义的算子和标准分析技术推导一个特定的数学表达式。可以获得唯一的解析解。\n- **客观性：** 该问题使用精确、客观的数学语言陈述。\n- **缺陷分析：** 问题陈述在科学上是合理的、可形式化的、内部一致的，并包含所有必要的信息。它不违反任何无效性标准。\n\n**1.3. 结论：**\n该问题是有效的。\n\n### 步骤 2：求解推导\n\n分裂方法的局部行为可以使用 Baker–Campbell–Hausdorff (BCH) 公式进行分析。对于两个非对易算子 $X$ 和 $Y$，该公式表述为：\n$$\n\\exp(X) \\exp(Y) = \\exp\\left(X + Y + \\frac{1}{2}[X, Y] + \\frac{1}{12}[X, [X, Y]] - \\frac{1}{12}[Y, [X, Y]] + \\dots\\right)\n$$\n在我们的情况下，我们设置 $X = \\Delta t A$ 和 $Y = \\Delta t B$。将这些代入 BCH 公式得到：\n$$\n\\exp(\\Delta t A) \\exp(\\Delta t B) = \\exp\\left(\\Delta t A + \\Delta t B + \\frac{(\\Delta t)^2}{2}[A, B] + O((\\Delta t)^3)\\right)\n$$\n一个时间步内的精确解算子是 $\\exp(\\Delta t (A+B))$。近似（分裂）算子与精确算子之间的差异是分裂误差的来源。令 $\\mathcal{E}$ 为误差算子。\n$$\n\\mathcal{E} = \\exp(\\Delta t A) \\exp(\\Delta t B) - \\exp(\\Delta t (A+B))\n$$\n通过展开指数项，该误差算子的领头阶项被发现为：\n$$\n\\mathcal{E} = \\frac{(\\Delta t)^2}{2}[A, B] + O((\\Delta t)^3)\n$$\n因此，作用于时间 $t^n$ 的解 $\\boldsymbol{u}$ 上的领头阶局部格式分裂误差项是 $\\frac{(\\Delta t)^2}{2}[A, B]\\boldsymbol{u}(\\boldsymbol{x},t^n)$。我们的任务是找到该项第 $k$ 个分量的显式表达式，这需要计算交换子 $[A, B]\\boldsymbol{u} = (AB - BA)\\boldsymbol{u}$。\n\n令 $\\boldsymbol{u}$ 为一个足够光滑的向量场。我们将分别计算 $(AB)\\boldsymbol{u}$ 和 $(BA)\\boldsymbol{u}$ 的第 $k$ 个分量。这里对重复的空间指标使用爱因斯坦求和约定。\n\n**第 1 项：$(B(A\\boldsymbol{u}))_k$**\n首先，我们应用平流算子 $A$：\n$$\n(A\\boldsymbol{u})_k = -w_j \\partial_j u_k\n$$\n接下来，我们将扩散算子 $B$ 应用于向量场 $A\\boldsymbol{u}$：\n$$\n(B(A\\boldsymbol{u}))_k = \\partial_i\\left(\\nu \\partial_i (A\\boldsymbol{u})_k\\right) = \\partial_i\\left(\\nu \\partial_i (-w_j \\partial_j u_k)\\right) = -\\partial_i\\left(\\nu \\partial_i (w_j \\partial_j u_k)\\right)\n$$\n使用导数的乘法法则展开：\n$$\n(B(A\\boldsymbol{u}))_k = -\\partial_i\\left(\\nu \\left[ (\\partial_i w_j)(\\partial_j u_k) + w_j(\\partial_i \\partial_j u_k) \\right]\\right)\n$$\n$$\n= -\\left[ (\\partial_i\\nu)\\left((\\partial_i w_j)(\\partial_j u_k) + w_j(\\partial_i \\partial_j u_k)\\right) + \\nu \\partial_i\\left((\\partial_i w_j)(\\partial_j u_k) + w_j(\\partial_i \\partial_j u_k)\\right) \\right]\n$$\n$$\n= -(\\partial_i\\nu)(\\partial_i w_j)(\\partial_j u_k) - w_j(\\partial_i\\nu)(\\partial_i \\partial_j u_k) - \\nu(\\partial_i\\partial_i w_j)(\\partial_j u_k) - 2\\nu(\\partial_i w_j)(\\partial_i\\partial_j u_k) - \\nu w_j(\\partial_i\\partial_i\\partial_j u_k)\n$$\n\n**第 2 项：$(A(B\\boldsymbol{u}))_k$**\n首先，我们应用扩散算子 $B$：\n$$\n(B\\boldsymbol{u})_k = \\partial_i(\\nu \\partial_i u_k)\n$$\n接下来，我们将平流算子 $A$ 应用于向量场 $B\\boldsymbol{u}$：\n$$\n(A(B\\boldsymbol{u}))_k = -w_j \\partial_j (B\\boldsymbol{u})_k = -w_j \\partial_j(\\partial_i(\\nu \\partial_i u_k))\n$$\n使用乘法法则展开：\n$$\n(A(B\\boldsymbol{u}))_k = -w_j \\partial_j\\left( (\\partial_i\\nu)(\\partial_i u_k) + \\nu(\\partial_i\\partial_i u_k) \\right)\n$$\n$$\n= -w_j \\left[ (\\partial_j\\partial_i\\nu)(\\partial_i u_k) + (\\partial_i\\nu)(\\partial_j\\partial_i u_k) + (\\partial_j\\nu)(\\partial_i\\partial_i u_k) + \\nu(\\partial_j\\partial_i\\partial_i u_k) \\right]\n$$\n$$\n= -w_j(\\partial_j\\partial_i\\nu)(\\partial_i u_k) - w_j(\\partial_i\\nu)(\\partial_j\\partial_i u_k) - w_j(\\partial_j\\nu)(\\partial_i\\partial_i u_k) - w_j\\nu(\\partial_j\\partial_i\\partial_i u_k)\n$$\n\n**交换子：$([A, B]\\boldsymbol{u})_k = (A(B\\boldsymbol{u}))_k - (B(A\\boldsymbol{u}))_k$**\n现在我们从 $(A(B\\boldsymbol{u}))_k$ 中减去 $(B(A\\boldsymbol{u}))_k$ 的表达式。我们按作用于 $u_k$ 的导数阶数对各项进行分组。\n\n- **三阶导数项：**\n$$\n-w_j\\nu(\\partial_j\\partial_i\\partial_i u_k) - (-\\nu w_j(\\partial_i\\partial_i\\partial_j u_k)) = -\\nu w_j(\\partial_j\\partial_i\\partial_i u_k) + \\nu w_j(\\partial_i\\partial_i\\partial_j u_k) = 0\n$$\n由于光滑函数的偏导数具有可交换性，这些项相互抵消。这是预料之中的，因为一阶和二阶微分算子的交换子应该是一个二阶算子。\n\n- **二阶导数项：**\n$$\n[-w_j(\\partial_i\\nu)(\\partial_j\\partial_i u_k) - w_j(\\partial_j\\nu)(\\partial_i\\partial_i u_k)] - [-w_j(\\partial_i\\nu)(\\partial_i \\partial_j u_k) - 2\\nu(\\partial_i w_j)(\\partial_i\\partial_j u_k)]\n$$\n项 $-w_j(\\partial_i\\nu)(\\partial_j\\partial_i u_k)$ 和 $-(-w_j(\\partial_i\\nu)(\\partial_i \\partial_j u_k))$ 相互抵消。剩余的项是：\n$$\n-w_j(\\partial_j\\nu)(\\partial_i\\partial_i u_k) + 2\\nu(\\partial_i w_j)(\\partial_i\\partial_j u_k)\n$$\n\n- **一阶导数项：**\n$$\n[-w_j(\\partial_j\\partial_i\\nu)(\\partial_i u_k)] - [-(\\partial_i\\nu)(\\partial_i w_j)(\\partial_j u_k) - \\nu(\\partial_i\\partial_i w_j)(\\partial_j u_k)]\n$$\n$$\n= -w_j(\\partial_j\\partial_i\\nu)(\\partial_i u_k) + (\\partial_i\\nu)(\\partial_i w_j)(\\partial_j u_k) + \\nu(\\partial_i\\partial_i w_j)(\\partial_j u_k)\n$$\n\n结合所有剩余的项，交换子的第 $k$ 个分量的表达式为：\n$$\n([A, B]\\boldsymbol{u})_k = 2\\nu(\\partial_i w_j)\\partial_i\\partial_j u_k - w_j(\\partial_j \\nu)\\partial_l\\partial_l u_k + \\left( (\\partial_i\\nu)(\\partial_i w_j) + \\nu(\\partial_i\\partial_i w_j) \\right) \\partial_j u_k - w_j(\\partial_j\\partial_i\\nu)\\partial_i u_k\n$$\n我们可以看出 $(\\partial_i\\nu)(\\partial_i w_j) + \\nu(\\partial_i\\partial_i w_j) = \\partial_i(\\nu \\partial_i w_j)$，这是扩散算子 $B$ 作用于向量场 $\\boldsymbol{w}$ 的第 $j$ 个分量，即 $(B\\boldsymbol{w})_j$。\n为避免求和指标混淆，我们可以将拉普拉斯项 $\\partial_i\\partial_i u_k$ 写为 $\\partial_l\\partial_l u_k$。为了清晰起见，我们也可以为每一项使用不同的哑指标。\n\n交换子作用的最终表达式为：\n$$\n([A, B]\\boldsymbol{u})_k = 2\\nu(\\partial_i w_j)\\partial_i\\partial_j u_k - w_j(\\partial_j \\nu)\\partial_l\\partial_l u_k + (\\partial_m(\\nu\\partial_m w_j))\\partial_j u_k - w_j(\\partial_j\\partial_p\\nu)\\partial_p u_k\n$$\n其中 $i, j, l, m, p$ 是从 $1$ 到 $d$ 的求和指标。无散条件 $\\partial_j w_j=0$ 不会使此表达式得到进一步的直接简化。\n\n最后，通过乘以 $\\frac{(\\Delta t)^2}{2}$ 得到领头阶局部格式分裂误差项。\n\n在时间层 $t^n$ 上，领头交换子误差项的第 $k$ 个分量是：\n$$\n\\frac{(\\Delta t)^2}{2} \\left( 2\\nu(\\partial_i w_j)\\partial_i\\partial_j u_k - w_j(\\partial_j \\nu)\\partial_l\\partial_l u_k + (\\partial_m(\\nu\\partial_m w_j))\\partial_j u_k - w_j(\\partial_j\\partial_p\\nu)\\partial_p u_k \\right)\n$$\n所有的场及其导数都在 $(\\boldsymbol{x}, t^n)$ 处求值。",
            "answer": "$$\n\\boxed{\\frac{(\\Delta t)^2}{2} \\left( 2\\nu(\\partial_i w_j)\\partial_i\\partial_j u_k - w_j(\\partial_j \\nu)\\partial_l\\partial_l u_k + (\\partial_m(\\nu\\partial_m w_j))\\partial_j u_k - w_j(\\partial_j\\partial_p\\nu)\\partial_p u_k \\right)}\n$$"
        }
    ]
}