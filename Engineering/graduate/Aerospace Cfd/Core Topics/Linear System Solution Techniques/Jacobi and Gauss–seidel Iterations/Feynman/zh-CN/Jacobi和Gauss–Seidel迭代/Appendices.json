{
    "hands_on_practices": [
        {
            "introduction": "迭代方法的收敛性由其迭代矩阵的谱半径 $\\rho(T)$ 决定，这是一个描述长期行为的渐近属性。然而，在实际计算中，误差范数在早期迭代中的表现可能并不直观。本练习  将通过一个精心设计的例子，展示一个全局发散的雅可比迭代（即 $\\rho(T_J)  1$）如何在最初几步中表现出误差减小的暂态现象，从而帮助您深入理解谱半径与矩阵范数在预测迭代行为上的区别。",
            "id": "2406949",
            "problem": "考虑线性系统 $A \\boldsymbol{x} = \\boldsymbol{b}$，其中\n$$\nA = \\begin{pmatrix}\n1  -0.2 \\\\\n-6  1\n\\end{pmatrix}, \\qquad \\boldsymbol{b} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n设精确解为 $\\boldsymbol{x}^{\\ast} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。从初始猜测\n$$\n\\boldsymbol{x}^{(0)} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n开始应用 Jacobi 迭代，并将第 $k$ 次迭代的误差定义为 $\\boldsymbol{e}^{(k)} = \\boldsymbol{x}^{(k)} - \\boldsymbol{x}^{\\ast}$。使用欧几里得范数（也称为 $2$-范数），记为 $|\\!| \\cdot |\\!|_{2}$，来衡量误差的大小。Jacobi 迭代矩阵 $T_J$ 的谱半径 $\\rho(T_J)$ 是 $T_J$ 的特征值的最大模。\n\n确定满足 $|\\!| \\boldsymbol{e}^{(k)} |\\!|_{2}  |\\!| \\boldsymbol{e}^{(k-1)} |\\!|_{2}$ 的最小整数 $k \\geq 1$。仅报告这个 $k$ 的值作为最终答案。",
            "solution": "首先必须验证问题陈述的科学性和逻辑完整性。\n\n给定条件如下：\n线性系统 $A \\boldsymbol{x} = \\boldsymbol{b}$。\n矩阵 $A = \\begin{pmatrix} 1  -0.2 \\\\ -6  1 \\end{pmatrix}$。\n向量 $\\boldsymbol{b} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n精确解 $\\boldsymbol{x}^{\\ast} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\nJacobi 迭代的初始猜测 $\\boldsymbol{x}^{(0)} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n误差定义 $\\boldsymbol{e}^{(k)} = \\boldsymbol{x}^{(k)} - \\boldsymbol{x}^{\\ast}$。\n使用的范数是欧几里得范数 $|\\!| \\cdot |\\!|_{2}$。\n目标是找到满足条件 $|\\!| \\boldsymbol{e}^{(k)} |\\!|_{2}  |\\!| \\boldsymbol{e}^{(k-1)} |\\!|_{2}$ 的最小整数 $k \\geq 1$。\n\n该问题具有科学依据，提法恰当且客观。它涉及计算工程中的一个标准主题，即 Jacobi 迭代法。我们可以验证给定的精确解。矩阵 $A$ 的行列式是 $\\det(A) = (1)(1) - (-0.2)(-6) = 1 - 1.2 = -0.2$。由于 $\\det(A) \\neq 0$，矩阵 $A$ 是可逆的，齐次系统 $A \\boldsymbol{x} = \\boldsymbol{0}$ 只有平凡解 $\\boldsymbol{x} = \\boldsymbol{0}$。因此，所提供的精确解 $\\boldsymbol{x}^{\\ast} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 是正确的。所有数据都已提供，没有矛盾之处。该问题是有效的。\n\n对于线性系统 $A\\boldsymbol{x} = \\boldsymbol{b}$，Jacobi 迭代由每个分量 $i$ 的更新规则定义：\n$$\nx_i^{(k)} = \\frac{1}{a_{ii}} \\left( b_i - \\sum_{j \\neq i} a_{ij} x_j^{(k-1)} \\right)\n$$\n对于给定的系统，其中 $A = \\begin{pmatrix} 1  -0.2 \\\\ -6  1 \\end{pmatrix}$ 且 $\\boldsymbol{b} = \\boldsymbol{0}$，分量形式的迭代是：\n$$\nx_1^{(k)} = \\frac{1}{1} \\left( 0 - (-0.2) x_2^{(k-1)} \\right) = 0.2 x_2^{(k-1)}\n$$\n$$\nx_2^{(k)} = \\frac{1}{1} \\left( 0 - (-6) x_1^{(k-1)} \\right) = 6 x_1^{(k-1)}\n$$\n这可以表示为矩阵形式 $\\boldsymbol{x}^{(k)} = T_J \\boldsymbol{x}^{(k-1)}$，其中 $T_J$ 是 Jacobi 迭代矩阵：\n$$\nT_J = \\begin{pmatrix} 0  0.2 \\\\ 6  0 \\end{pmatrix}\n$$\n第 $k$ 次迭代的误差向量是 $\\boldsymbol{e}^{(k)} = \\boldsymbol{x}^{(k)} - \\boldsymbol{x}^{\\ast}$。由于精确解是 $\\boldsymbol{x}^{\\ast} = \\boldsymbol{0}$，误差就是 $\\boldsymbol{e}^{(k)} = \\boldsymbol{x}^{(k)}$。\n误差的传播由相同的迭代矩阵控制：\n$$\n\\boldsymbol{e}^{(k)} = \\boldsymbol{x}^{(k)} = T_J \\boldsymbol{x}^{(k-1)} = T_J \\boldsymbol{e}^{(k-1)}\n$$\n这是一个递推关系，所以 $\\boldsymbol{e}^{(k)} = (T_J)^k \\boldsymbol{e}^{(0)}$。\n\n初始猜测为 $\\boldsymbol{x}^{(0)} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，所以初始误差为 $\\boldsymbol{e}^{(0)} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n初始误差的欧几里得范数的平方是：\n$$\n|\\!| \\boldsymbol{e}^{(0)} |\\!|_{2}^2 = 0^2 + 1^2 = 1\n$$\n因此，$|\\!| \\boldsymbol{e}^{(0)} |\\!|_{2} = 1$。\n\n现在，我们执行迭代来找到满足 $|\\!| \\boldsymbol{e}^{(k)} |\\!|_{2}  |\\!| \\boldsymbol{e}^{(k-1)} |\\!|_{2}$ 的最小整数 $k \\geq 1$。\n\n对于 $k=1$：\n$$\n\\boldsymbol{e}^{(1)} = T_J \\boldsymbol{e}^{(0)} = \\begin{pmatrix} 0  0.2 \\\\ 6  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0.2 \\\\ 0 \\end{pmatrix}\n$$\n在 $k=1$ 时误差的欧几里得范数的平方是：\n$$\n|\\!| \\boldsymbol{e}^{(1)} |\\!|_{2}^2 = (0.2)^2 + 0^2 = 0.04\n$$\n因此，$|\\!| \\boldsymbol{e}^{(1)} |\\!|_{2} = \\sqrt{0.04} = 0.2$。\n比较 $k=1$ 和 $k=0$ 时的范数：\n$$\n|\\!| \\boldsymbol{e}^{(1)} |\\!|_{2} = 0.2  1 = |\\!| \\boldsymbol{e}^{(0)} |\\!|_{2}\n$$\n误差范数减小了。对于 $k=1$ 条件不满足。\n\n对于 $k=2$：\n$$\n\\boldsymbol{e}^{(2)} = T_J \\boldsymbol{e}^{(1)} = \\begin{pmatrix} 0  0.2 \\\\ 6  0 \\end{pmatrix} \\begin{pmatrix} 0.2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1.2 \\end{pmatrix}\n$$\n在 $k=2$ 时误差的欧几里得范数的平方是：\n$$\n|\\!| \\boldsymbol{e}^{(2)} |\\!|_{2}^2 = 0^2 + (1.2)^2 = 1.44\n$$\n因此，$|\\!| \\boldsymbol{e}^{(2)} |\\!|_{2} = \\sqrt{1.44} = 1.2$。\n比较 $k=2$ 和 $k=1$ 时的范数：\n$$\n|\\!| \\boldsymbol{e}^{(2)} |\\!|_{2} = 1.2  0.2 = |\\!| \\boldsymbol{e}^{(1)} |\\!|_{2}\n$$\n误差范数增大了。对于 $k=2$，条件 $|\\!| \\boldsymbol{e}^{(k)} |\\!|_{2}  |\\!| \\boldsymbol{e}^{(k-1)} |\\!|_{2}$ 得到满足。\n\n因为我们寻找的是最小的整数 $k \\geq 1$，我们已经找到了答案。这个最小的整数是 $k=2$。\n\n分析这种现象发生的原因是很有启发性的。Jacobi 方法的收敛性由迭代矩阵的谱半径 $\\rho(T_J)$ 决定。$T_J$ 的特征值 $\\lambda$ 是特征方程 $\\det(T_J - \\lambda I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} -\\lambda  0.2 \\\\ 6  -\\lambda \\end{pmatrix} = (-\\lambda)(-\\lambda) - (0.2)(6) = \\lambda^2 - 1.2 = 0\n$$\n特征值为 $\\lambda_{1,2} = \\pm\\sqrt{1.2}$。\n谱半径是 $\\rho(T_J) = \\max(|\\sqrt{1.2}|, |-\\sqrt{1.2}|) = \\sqrt{1.2}$。\n由于 $\\rho(T_J) = \\sqrt{1.2}  1$，Jacobi 迭代是发散的，这意味着当 $k \\to \\infty$ 时，误差范数 $|\\!| \\boldsymbol{e}^{(k)} |\\!|_{2}$ 将无界增长。然而，这并不保证每一步都是单调增长的。在特定步骤 $k$ 误差范数的增长或衰减取决于比率 $\\frac{|\\!| \\boldsymbol{e}^{(k)} |\\!|_2}{|\\!| \\boldsymbol{e}^{(k-1)} |\\!|_2} = \\frac{|\\!| T_J \\boldsymbol{e}^{(k-1)} |\\!|_2}{|\\!| \\boldsymbol{e}^{(k-1)} |\\!|_2}$。这个比率受 $T_J$ 的奇异值所限制。算子范数 $|\\!|T_J|\\!|_2 = \\sqrt{\\rho(T_J^T T_J)}$。\n$$\nT_J^T T_J = \\begin{pmatrix} 0  6 \\\\ 0.2  0 \\end{pmatrix} \\begin{pmatrix} 0  0.2 \\\\ 6  0 \\end{pmatrix} = \\begin{pmatrix} 36  0 \\\\ 0  0.04 \\end{pmatrix}\n$$\n$T_J^T T_J$ 的特征值为 $36$ 和 $0.04$。$T_J$ 的奇异值为 $\\sigma_1 = \\sqrt{36} = 6$ 和 $\\sigma_2 = \\sqrt{0.04} = 0.2$。\n算子范数为 $|\\!|T_J|\\!|_2 = \\sigma_1 = 6$。\n初始误差 $\\boldsymbol{e}^{(0)}$ 与对应于较小奇异值的方向对齐，导致误差范数初始急剧减小，因子为 $\\sigma_2 = 0.2$。随后的误差向量 $\\boldsymbol{e}^{(1)}$ 与对应于较大奇异值的方向对齐，导致误差范数急剧增加，因子为 $\\sigma_1 = 6$。这是一个全局发散迭代过程中瞬态误差减小的绝佳例子。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "矩阵的对角占优性是保证雅可比和高斯-赛德尔迭代收敛的一个重要充分条件。然而，一个线性方程组的收敛特性并非一成不变，它取决于方程的书写顺序。本练习  演示了如何通过简单的行置换操作，将一个非对角占优且不收敛的系统，转化为一个严格对角占优的收敛系统，揭示了预处理技术在改善迭代求解器性能方面的巨大潜力。",
            "id": "2406931",
            "problem": "在计算工程中，用于求解线性系统的雅可比迭代法的收敛性取决于从系统矩阵派生出的迭代矩阵。考虑参数化线性系统族 $A(t)\\,x=b$，其中\n$$\nA(t) \\;=\\; \\begin{pmatrix}\nt  5  0\\\\\n0  t  5\\\\\n5  0  t\n\\end{pmatrix}, \n\\qquad\nb \\;=\\; \\begin{pmatrix}\n1\\\\\n1\\\\\n1\n\\end{pmatrix},\n$$\n$t$ 是一个正实数参数。设行置换矩阵\n$$\nP \\;=\\; \\begin{pmatrix}\n0  0  1\\\\\n1  0  0\\\\\n0  1  0\n\\end{pmatrix}\n$$\n应用于原系统以获得置换后的系统 $P\\,A(t)\\,x = P\\,b$。取 $t=4$。基于第一性原理，分析原始系统和置换后系统的雅可比方法，包括它们的迭代矩阵和收敛特性。\n\n计算当 $t=4$ 时，置換后系统的雅可比迭代矩阵的谱半径。将你的答案四舍五入到四位有效数字。",
            "solution": "问题陈述的验证是首要且最关键的步骤。\n\n**步骤1：提取已知条件**\n- 定义了一个参数化线性系统族 $A(t)\\,x=b$。\n- 系统矩阵为 $A(t) = \\begin{pmatrix} t  5  0\\\\ 0  t  5\\\\ 5  0  t \\end{pmatrix}$。\n- 右端向量为 $b = \\begin{pmatrix} 1\\\\ 1\\\\ 1 \\end{pmatrix}$。\n- 参数 $t$ 是一个正实数。\n- 给定一个行置换矩阵：$P = \\begin{pmatrix} 0  0  1\\\\ 1  0  0\\\\ 0  1  0 \\end{pmatrix}$。\n- 置换后的系统为 $P\\,A(t)\\,x = P\\,b$。\n- 特定的参数值为 $t=4$。\n- 任务是分析当 $t=4$ 时原始系统和置换后系统的雅可比方法，并计算置换后系统的雅可比迭代矩阵的谱半径。\n- 数值结果必须四舍五入到四位有效数字。\n\n**步骤2：验证结论**\n该问题在科学上是合理的，涉及数值线性代数中的标准课题——特别是雅可比迭代法、收敛准则以及矩阵性质（如对角占优）的影响。这是一个适定问题，为求得唯一解提供了所有必要的数据。语言客观且无歧义。因此，该问题被判定为**有效**。\n\n开始求解。\n\n雅可比方法是求解线性方程组 $M x = c$ 的一种迭代过程。矩阵 $M$ 被分解为 $M = D - L - U$，其中 $D$ 是 $M$ 的对角部分，$-L$ 是其严格下三角部分，$-U$ 是其严格上三角部分。迭代由以下公式定义：\n$$ x^{(k+1)} = D^{-1}(L+U) x^{(k)} + D^{-1}c $$\n矩阵 $T_J = D^{-1}(L+U)$ 是雅可比迭代矩阵。对于任意初始向量 $x^{(0)}$，迭代过程收敛的充要条件是 $T_J$ 的谱半径（记作 $\\rho(T_J)$）严格小于1。谱半径是 $T_J$ 的所有特征值中绝对值的最大值。\n\n**原始系统分析**\n对于参数值 $t=4$，原始系统矩阵为：\n$$ A(4) = \\begin{pmatrix} 4  5  0\\\\ 0  4  5\\\\ 5  0  4 \\end{pmatrix} $$\n该矩阵不是严格对角占优的。例如，在第一行，对角元素 $|4|$ 的绝对值不大于非对角元素绝对值之和 $|5| + |0| = 5$。这种非对角占优的情况表明雅可比方法可能不会收敛。\n\n我们将 $A(4)$ 分解为其分量 $D$、$L$ 和 $U$：\n$$ D = \\begin{pmatrix} 4  0  0\\\\ 0  4  0\\\\ 0  0  4 \\end{pmatrix}, \\quad L = \\begin{pmatrix} 0  0  0\\\\ 0  0  0\\\\ -5  0  0 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 0  -5  0\\\\ 0  0  -5\\\\ 0  0  0 \\end{pmatrix} $$\n原始系统的雅可比迭代矩阵 $T_{J,A}$ 为 $T_{J,A} = D^{-1}(L+U)$。\n$$ T_{J,A} = \\begin{pmatrix} \\frac{1}{4}  0  0\\\\ 0  \\frac{1}{4}  0\\\\ 0  0  \\frac{1}{4} \\end{pmatrix} \\begin{pmatrix} 0  -5  0\\\\ 0  0  -5\\\\ -5  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  -\\frac{5}{4}  0\\\\ 0  0  -\\frac{5}{4}\\\\ -\\frac{5}{4}  0  0 \\end{pmatrix} $$\n$T_{J,A}$ 的特征值 $\\lambda$ 可通过特征方程 $\\det(T_{J,A} - \\lambda I) = 0$ 求得：\n$$ \\det \\begin{pmatrix} -\\lambda  -\\frac{5}{4}  0\\\\ 0  -\\lambda  -\\frac{5}{4}\\\\ -\\frac{5}{4}  0  -\\lambda \\end{pmatrix} = 0 $$\n展开行列式得到：\n$$ -\\lambda^3 - \\left(\\frac{5}{4}\\right)^3 = 0 \\implies \\lambda^3 = -\\left(\\frac{5}{4}\\right)^3 $$\n每个特征值 $\\lambda$ 的模由 $|\\lambda|^3 = |-\\left(\\frac{5}{4}\\right)^3| = \\left(\\frac{5}{4}\\right)^3$ 给出，这意味着 $|\\lambda| = \\frac{5}{4}$。\n因此，谱半径为 $\\rho(T_{J,A}) = \\frac{5}{4} = 1.25$。由于 $\\rho(T_{J,A})  1$，原始系统的雅可比方法是发散的。\n\n**置换后系统分析**\n置换后的系统由矩阵 $A' = P A(4)$ 表征：\n$$ A' = P A(4) = \\begin{pmatrix} 0  0  1\\\\ 1  0  0\\\\ 0  1  0 \\end{pmatrix} \\begin{pmatrix} 4  5  0\\\\ 0  4  5\\\\ 5  0  4 \\end{pmatrix} = \\begin{pmatrix} 5  0  4\\\\ 4  5  0\\\\ 0  4  5 \\end{pmatrix} $$\n我们检查 $A'$ 的对角占优性。对于每一行 $i$，我们检查是否满足 $|a'_{ii}|  \\sum_{j \\neq i} |a'_{ij}|$。\n- 第1行：$|5|  |0| + |4| \\implies 5  4$。\n- 第2行：$|5|  |4| + |0| \\implies 5  4$。\n- 第3行：$|5|  |0| + |4| \\implies 5  4$。\n矩阵 $A'$ 是严格对角占优的。这是雅可比方法收敛的一个充分条件。我们现在计算谱半径以确认收敛性并量化其速率。\n\n我们将 $A'$ 分解为 $A' = D' - L' - U'$：\n$$ D' = \\begin{pmatrix} 5  0  0\\\\ 0  5  0\\\\ 0  0  5 \\end{pmatrix}, \\quad L' = \\begin{pmatrix} 0  0  0\\\\ -4  0  0\\\\ 0  -4  0 \\end{pmatrix}, \\quad U' = \\begin{pmatrix} 0  0  -4\\\\ 0  0  0\\\\ 0  0  0 \\end{pmatrix} $$\n置换后系统的雅可比迭代矩阵 $T_{J,A'}$ 为：\n$$ T_{J,A'} = (D')^{-1}(L'+U') = \\begin{pmatrix} \\frac{1}{5}  0  0\\\\ 0  \\frac{1}{5}  0\\\\ 0  0  \\frac{1}{5} \\end{pmatrix} \\begin{pmatrix} 0  0  -4\\\\ -4  0  0\\\\ 0  -4  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  -\\frac{4}{5}\\\\ -\\frac{4}{5}  0  0\\\\ 0  -\\frac{4}{5}  0 \\end{pmatrix} $$\n$T_{J,A'}$ 的特征值 $\\lambda'$ 是特征方程 $\\det(T_{J,A'} - \\lambda' I) = 0$ 的根：\n$$ \\det \\begin{pmatrix} -\\lambda'  0  -\\frac{4}{5}\\\\ -\\frac{4}{5}  -\\lambda'  0\\\\ 0  -\\frac{4}{5}  -\\lambda' \\end{pmatrix} = 0 $$\n展开此行列式得到：\n$$ -(\\lambda')^3 - \\left(\\frac{4}{5}\\right)^3 = 0 \\implies (\\lambda')^3 = -\\left(\\frac{4}{5}\\right)^3 $$\n每个特征值 $\\lambda'$ 的模为 $|\\lambda'|^3 = |-\\left(\\frac{4}{5}\\right)^3| = \\left(\\frac{4}{5}\\right)^3$，这意味着 $|\\lambda'| = \\frac{4}{5}$。\n置换后系统的雅可比迭代矩阵的谱半径为 $\\rho(T_{J,A'}) = \\max_i |\\lambda'_i| = \\frac{4}{5} = 0.8$。\n由于 $\\rho(T_{J,A'})  1$，雅可比方法对置换后的系统是收敛的，这与严格对角占优的性质是一致的。\n\n问题要求将此谱半径的数值四舍五入到四位有效数字。\n该值为 $0.8$。表示为四位有效数字即为 $0.8000$。",
            "answer": "$$\\boxed{0.8000}$$"
        },
        {
            "introduction": "在计算流体力学（CFD）中，迭代法是求解由偏微分方程离散化后产生的大型稀疏线性系统的核心工具。本练习  将理论付诸实践，要求您为二维拉普拉斯方程实现多种迭代求解器。您不仅将比较雅可比和高斯-赛德尔方法的效率，还将探索红黑着色排序法，这是一种经典的并行计算技术，能够有效解除高斯-赛德尔迭代中的数据依赖，从而在并行计算机上实现显著加速。",
            "id": "2406990",
            "problem": "您需要使用三种方法实现单位正方形上离散二维拉普拉斯方程的迭代求解器，并对实现进行检测，以评估红黑棋盘格排序对并行化 Gauss–Seidel 方法的影响。\n\n其数学基础如下。考虑单位正方形上的拉普拉斯方程，其带有 Dirichlet 边界条件，即偏微分方程 $\\nabla^2 u(x,y) = 0$ 在 $(x,y) \\in (0,1)\\times(0,1)$ 上，以及在边界上给定的 $u$ 值。使用均匀的笛卡尔网格对该方程进行离散化，在 $x$ 方向上有 $N_x$ 个内部点，在 $y$ 方向上有 $N_y$ 个内部点。网格间距为 $h_x = 1/(N_x+1)$ 和 $h_y = 1/(N_y+1)$。用整数 $i = 1,\\dots,N_y$ 和 $j = 1,\\dots,N_x$ 对内部点进行索引，并在所有边上包含一个点厚的边界层。假设在左、右和底边上为齐次 Dirichlet 边界条件，即 $u(0,y)=0$、$u(1,y)=0$ 和 $u(x,0)=0$，并在顶边上为由 $u(x,1)=g(x)$ 给出的非齐次 Dirichlet 边界条件。函数 $g(x)$ 在下面指定；角度必须以弧度为单位进行解释。\n\n根据拉普拉斯算子的标准二阶有限差分离散化，通过强制 $\\nabla^2 u$ 的五点模板近似等于零，可以得到每个内部点 $(i,j)$ 处的离散方程，这导出了一个线性系统 $A \\mathbf{u} = \\mathbf{b}$，其中 $A$ 是一个稀疏对称正定矩阵。您可以假设这个基本构造，并从中推导出您需要的任何迭代不动点更新。不要引入绕过此推导的捷径。\n\n您的任务是：\n\n- 实现应用于离散拉普拉斯方程的 Jacobi 方法。\n- 实现应用于同一方程的字典序 Gauss–Seidel 方法。\n- 实现红黑 Gauss–Seidel 方法，该方法对网格应用双色棋盘格排序。这种排序是有效的，因为每个内部点仅与其四个轴对齐的邻居耦合，从而形成一个二分图。在这种排序中，所有一种颜色的点可以根据另一种颜色的点同时更新，然后更新另一种颜色的点，以模拟数据并行更新。\n- 使用离散残差的无穷范数作为停止准则。在内部点 $(i,j)$ 处，离散残差是应用于当前近似解的五点有限差分拉普拉斯算子的值。将无穷范数计算为所有内部点上的最大绝对残差。当此无穷范数小于给定的容差 $tol$ 时，停止迭代方法。\n- 对于每种方法，计算完整迭代的次数。对于 Jacobi 方法，一次完整迭代是一次产生新迭代解的全局扫描。对于字典序 Gauss–Seidel 方法，一次完整迭代是对所有内部点的一次扫描。对于红黑 Gauss–Seidel 方法，一次完整迭代包括一次红色扫描和一次黑色扫描。\n\n边界数据规范如下。使用 $g(x) = \\sin(\\pi x)$，其中 $x$ 以弧度为单位，因此 $g(0)=0$ 和 $g(1)=0$。此选择确保了在角点处与左、右两侧的齐次边界值的兼容性。\n\n数值细节：\n\n- 将内部值初始化为零。\n- 始终保持边界值固定。\n- 使用如上定义的离散残差无穷范数来测试收敛性。\n- 使用最大迭代次数 $k_{\\max}$；如果在达到 $k_{\\max}$ 时仍未满足容差，则声明不收敛。\n\n设计一个包含四个测试用例的测试套件，以检验实现的不同方面：\n\n- 用例 $1$ (方形网格，偶数计数)：$N_x = 8$，$N_y = 8$，$tol = 10^{-6}$，$k_{\\max} = 50000$。\n- 用例 $2$ (方形网格, 奇数计数)：$N_x = 7$，$N_y = 7$，$tol = 10^{-6}$，$k_{\\max} = 50000$。\n- 用例 $3$ (矩形网格)：$N_x = 8$，$N_y = 12$，$tol = 10^{-6}$，$k_{\\max} = 50000$。\n- 用例 $4$ (最小内部)：$N_x = 1$，$N_y = 1$，$tol = 10^{-12}$，$k_{\\max} = 50000$。\n\n对于每个测试用例，您的程序必须计算以下四个值：\n\n- Jacobi 方法满足容差所需的整数迭代次数，如果未在限制内收敛，则为 $k_{\\max}$。\n- 红黑 Gauss–Seidel 方法满足容差所需的整数迭代次数，如果未在限制内收敛，则为 $k_{\\max}$。\n- 字典序 Gauss–Seidel 方法满足容差所需的整数迭代次数，如果未在限制内收敛，则为 $k_{\\max}$。\n- 一个布尔值，指示收敛的红黑 Gauss–Seidel 解与收敛的字典序 Gauss–Seidel 解之间差值的无穷范数是否小于 $10^{-10}$。\n\n最终输出格式：\n\n- 您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。该列表应包含四个子列表，每个测试用例一个，按用例 1 到 4 的顺序排列。每个子列表必须为 $[n_J, n_{RBGS}, n_{GS}, ok]$ 的形式，其中 $n_J$、$n_{RBGS}$ 和 $n_{GS}$ 是整数，$ok$ 是布尔值。例如：$[[12,8,7,True],[...],...]$。\n\n角度必须以弧度为单位。此问题不需要物理单位。您的推导和实现中的所有数值都应作为实数处理。",
            "solution": "所提出的问题是计算工程中一个有效且适定的练习。它要求实现和比较三种经典的迭代方法，用于求解二维拉普拉斯方程有限差分离散化所产生的线性系统。问题陈述科学上是合理的、自洽的且客观的。我将继续进行推导和求解。\n\n控制偏微分方程是单位正方形上的拉普拉斯方程：\n$$ \\nabla^2 u(x,y) = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0 \\quad \\text{for} \\quad (x,y) \\in (0,1) \\times (0,1) $$\n带有指定的 Dirichlet 边界条件：\n$$ u(x,0) = 0, \\quad u(x,1) = g(x) = \\sin(\\pi x), \\quad u(0,y) = 0, \\quad u(1,y) = 0 $$\n该区域使用均匀的笛卡尔网格进行离散化，在 $x$ 方向上有 $N_x$ 个内部点，在 $y$ 方向上有 $N_y$ 个内部点。网格间距为 $h_x = 1/(N_x+1)$ 和 $h_y = 1/(N_y+1)$。解 $u(x,y)$ 在网格点 $(x_j, y_i)$ 处由离散值 $u_{i,j}$ 近似，其中 $x_j = j h_x$ 和 $y_i = i h_y$。内部点的索引为 $i \\in \\{1, \\dots, N_y\\}$ 和 $j \\in \\{1, \\dots, N_x\\}$。完整网格包括边界点，其索引为 $i \\in \\{0, \\dots, N_y+1\\}$ 和 $j \\in \\{0, \\dots, N_x+1\\}$。\n\n二阶偏导数使用中心有限差分进行近似：\n$$ \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{(i,j)} \\approx \\frac{u_{i,j-1} - 2u_{i,j} + u_{i,j+1}}{h_x^2} $$\n$$ \\frac{\\partial^2 u}{\\partial y^2}\\bigg|_{(i,j)} \\approx \\frac{u_{i-1,j} - 2u_{i,j} + u_{i+1,j}}{h_y^2} $$\n将这些代入拉普拉斯方程，得到每个内部网格点 $(i,j)$ 的五点模板方程：\n$$ \\frac{u_{i,j-1} - 2u_{i,j} + u_{i,j+1}}{h_x^2} + \\frac{u_{i-1,j} - 2u_{i,j} + u_{i+1,j}}{h_y^2} = 0 $$\n为了形成不动点迭代，我们求解 $u_{i,j}$：\n$$ 2 \\left( \\frac{1}{h_x^2} + \\frac{1}{h_y^2} \\right) u_{i,j} = \\frac{u_{i,j-1} + u_{i,j+1}}{h_x^2} + \\frac{u_{i-1,j} + u_{i+1,j}}{h_y^2} $$\n这可以重排为迭代更新形式：\n$$ u_{i,j} = C_x (u_{i,j-1} + u_{i,j+1}) + C_y (u_{i-1,j} + u_{i+1,j}) $$\n其中系数定义为：\n$$ C_x = \\frac{h_y^2}{2(h_x^2 + h_y^2)} \\quad \\text{and} \\quad C_y = \\frac{h_x^2}{2(h_x^2 + h_y^2)} $$\n这个单一的更新公式是所有三种所需迭代方法的基础。\n\n设 $U^{(k)}$ 为第 $k$ 次迭代时的解值矩阵。\n\n1.  **Jacobi 方法**：Jacobi 方法完全基于当前状态 $U^{(k)}$ 的值来计算所有内部点的下一个状态 $U^{(k+1)}$。需要一个网格的临时副本。\n    $$ u_{i,j}^{(k+1)} = C_x (u_{i,j-1}^{(k)} + u_{i,j+1}^{(k)}) + C_y (u_{i-1,j}^{(k)} + u_{i+1,j}^{(k)}) $$\n\n2.  **字典序 Gauss–Seidel 方法**：此方法就地更新网格值，使用同一次迭代中最近计算出的值。“字典序”排序指的是顺序扫描，例如，逐行然后逐列。对于 $i$ 和 $j$ 递增的扫描：\n    $$ u_{i,j}^{(k+1)} = C_x (u_{i,j-1}^{(k+1)} + u_{i,j+1}^{(k)}) + C_y (u_{i-1,j}^{(k+1)} + u_{i+1,j}^{(k)}) $$\n\n3.  **红黑 Gauss–Seidel 方法**：此方法将网格点划分为“红色”和“黑色”两个集合，类似于棋盘格图案。如果 $i+j$ 是偶数，则点 $(i,j)$ 为红色；如果 $i+j$ 是奇数，则为黑色。五点模板确保了红色点的所有邻居都是黑色的，反之亦然。一次迭代包括两个阶段：\n    a.  **红色扫描**：更新所有红色点。由于它们的更新仅依赖于黑色点，因此所有红色点都可以使用迭代开始时的值同时计算。\n    b.  **黑色扫描**：更新所有黑色点。它们的更新使用其红色邻居新计算出的值。所有黑色点都可以同时计算。\n    这种结构特别适合并行化。一次完整迭代包括一次红色扫描和一次黑色扫描。\n\n停止准则是基于离散残差向量的无穷范数 $\\|r\\|_\\infty$。内部点 $(i,j)$ 处的残差 $r_{i,j}$ 是对当前解近似值 $\\tilde{U}$ 应用离散拉普拉斯算子的结果：\n$$ r_{i,j} = \\frac{\\tilde{u}_{i,j-1} - 2\\tilde{u}_{i,j} + \\tilde{u}_{i,j+1}}{h_x^2} + \\frac{\\tilde{u}_{i-1,j} - 2\\tilde{u}_{i,j} + \\tilde{u}_{i+1,j}}{h_y^2} $$\n当 $\\max_{i,j} |r_{i,j}|  tol$ （对于给定的容差 $tol$），或当迭代次数达到最大限制 $k_{\\max}$ 时，迭代终止。\n\n数值实现过程如下：\n对于由 $N_x$、$N_y$、$tol$ 和 $k_{\\max}$ 定义的每个测试用例：\n1.  一个 $(N_y+2) \\times (N_x+2)$ 的网格被初始化为 $0$。\n2.  设置 Dirichlet 边界条件。位于 $i=N_y+1$ 的顶边界 $u(x,1)$ 用值 $g(x_j) = \\sin(\\pi x_j)$ 填充，其中 $j \\in \\{1, \\dots, N_x\\}$。其他边界为 $0$。\n3.  从零初始化的内部网格开始，执行三种迭代求解器中的每一种。\n4.  每个求解器循环执行，进行更新并检查残差范数，直到收敛或达到 $k_{\\max}$。记录迭代次数。\n5.  在 Gauss-Seidel 变体收敛后，计算它们最终解网格之间差值的无穷范数 $\\|U_{\\text{RBGS}} - U_{\\text{GS}}\\|_\\infty$，并与阈值 $10^{-10}$ 进行比较，以验证它们产生了一致的结果。\n然后将四个指定测试用例的结果整合到所需的输出格式中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef setup_grid(Nx, Ny):\n    \"\"\"\n    Initializes the grid and applies boundary conditions.\n    Uses 'standard' indexing where grid row i corresponds to y-coordinate.\n    i=0 is bottom (y=0), i=Ny+1 is top (y=1).\n    \"\"\"\n    U = np.zeros((Ny + 2, Nx + 2))\n    hx = 1.0 / (Nx + 1)\n    \n    # Left, right, bottom boundaries are already zero.\n    \n    # Top boundary: u(x,1) = g(x) = sin(pi*x)\n    # This corresponds to row index Ny+1\n    x = np.linspace(0, 1, Nx + 2)\n    g = np.sin(np.pi * x)\n    U[Ny + 1, :] = g\n    return U\n\ndef calculate_residual_norm(U, hx, hy):\n    \"\"\"Calculates the infinity norm of the discrete residual.\"\"\"\n    Nx = U.shape[1] - 2\n    Ny = U.shape[0] - 2\n    if Nx == 0 or Ny == 0:\n        return 0.0\n    \n    # Slices for interior and neighbor points\n    U_int = U[1:-1, 1:-1]\n    U_left = U[1:-1, :-2]\n    U_right = U[1:-1, 2:]\n    U_down = U[:-2, 1:-1]\n    U_up = U[2:, 1:-1]\n    \n    # Discrete Laplacian operator\n    res_grid = (U_left - 2 * U_int + U_right) / (hx**2) + \\\n               (U_down - 2 * U_int + U_up) / (hy**2)\n               \n    return np.max(np.abs(res_grid))\n\ndef jacobi_solver(Nx, Ny, tol, k_max):\n    \"\"\"Solves the Laplace equation using the Jacobi method.\"\"\"\n    hx = 1.0 / (Nx + 1)\n    hy = 1.0 / (Ny + 1)\n    U = setup_grid(Nx, Ny)\n    U_old = U.copy()\n\n    Cx = hy**2 / (2 * (hx**2 + hy**2))\n    Cy = hx**2 / (2 * (hx**2 + hy**2))\n\n    for k in range(1, k_max + 1):\n        U_old[1:-1, 1:-1] = U[1:-1, 1:-1]\n\n        # Vectorized update using values from U_old\n        U[1:-1, 1:-1] = Cx * (U_old[1:-1, :-2] + U_old[1:-1, 2:]) + \\\n                        Cy * (U_old[:-2, 1:-1] + U_old[2:, 1:-1])\n\n        residual_norm = calculate_residual_norm(U, hx, hy)\n        if residual_norm  tol:\n            return k, U\n    return k_max, U\n\ndef gs_solver(Nx, Ny, tol, k_max):\n    \"\"\"Solves the Laplace equation using the lexicographic Gauss-Seidel method.\"\"\"\n    hx = 1.0 / (Nx + 1)\n    hy = 1.0 / (Ny + 1)\n    U = setup_grid(Nx, Ny)\n\n    Cx = hy**2 / (2 * (hx**2 + hy**2))\n    Cy = hx**2 / (2 * (hx**2 + hy**2))\n\n    for k in range(1, k_max + 1):\n        # In-place update with lexicographic sweep\n        for i in range(1, Ny + 1):\n            for j in range(1, Nx + 1):\n                U[i, j] = Cx * (U[i, j-1] + U[i, j+1]) + \\\n                          Cy * (U[i-1, j] + U[i+1, j])\n\n        residual_norm = calculate_residual_norm(U, hx, hy)\n        if residual_norm  tol:\n            return k, U\n    return k_max, U\n\ndef rbgs_solver(Nx, Ny, tol, k_max):\n    \"\"\"Solves the Laplace equation using the red-black Gauss-Seidel method.\"\"\"\n    hx = 1.0 / (Nx + 1)\n    hy = 1.0 / (Ny + 1)\n    U = setup_grid(Nx, Ny)\n\n    Cx = hy**2 / (2 * (hx**2 + hy**2))\n    Cy = hx**2 / (2 * (hx**2 + hy**2))\n    \n    for k in range(1, k_max + 1):\n        # A full iteration consists of one red sweep and one black sweep.\n        # Red sweep: update points where (i+j) is even\n        for i in range(1, Ny + 1):\n            for j in range(1, Nx + 1):\n                if (i + j) % 2 == 0:\n                    U[i, j] = Cx * (U[i, j-1] + U[i, j+1]) + \\\n                              Cy * (U[i-1, j] + U[i+1, j])\n        # Black sweep: update points where (i+j) is odd\n        for i in range(1, Ny + 1):\n            for j in range(1, Nx + 1):\n                if (i + j) % 2 != 0:\n                    U[i, j] = Cx * (U[i, j-1] + U[i, j+1]) + \\\n                              Cy * (U[i-1, j] + U[i+1, j])\n\n        residual_norm = calculate_residual_norm(U, hx, hy)\n        if residual_norm  tol:\n            return k, U\n    return k_max, U\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Nx, Ny, tol, k_max)\n        (8, 8, 1e-6, 50000),\n        (7, 7, 1e-6, 50000),\n        (8, 12, 1e-6, 50000),\n        (1, 1, 1e-12, 50000),\n    ]\n\n    results = []\n    for case in test_cases:\n        Nx, Ny, tol, k_max = case\n        \n        n_J, U_J = jacobi_solver(Nx, Ny, tol, k_max)\n        n_RBGS, U_RBGS = rbgs_solver(Nx, Ny, tol, k_max)\n        n_GS, U_GS = gs_solver(Nx, Ny, tol, k_max)\n        \n        # Check if the solutions from GS and RBGS are close\n        diff_norm = np.max(np.abs(U_RBGS - U_GS))\n        ok = bool(diff_norm  1e-10)\n        \n        results.append([n_J, n_RBGS, n_GS, ok])\n\n    # Final print statement in the exact required format.\n    # The default str() for a list already provides the required format '[a, b, ...]'\n    # The default str() for a boolean is 'True' or 'False' (capitalized), which is fine.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}