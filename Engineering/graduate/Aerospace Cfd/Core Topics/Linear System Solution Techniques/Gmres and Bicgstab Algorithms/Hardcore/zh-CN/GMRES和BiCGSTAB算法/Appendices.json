{
    "hands_on_practices": [
        {
            "introduction": "在部署任何算法之前，评估其计算开销是至关重要的一步。本练习将引导你剖析 GMRES 算法的核心组成部分，量化其在每次迭代中的内存占用和算术运算量。这种分析是预测算法性能、识别计算瓶颈以及进行硬件资源规划的基础 。",
            "id": "3962703",
            "problem": "在航空航天应用的计算流体动力学中，半离散可压缩Navier–Stokes方程在每个牛顿步或伪时间步都会产生一个形式为 $A x = b$ 的大型、稀疏、非对称线性系统，其中 $A \\in \\mathbb{R}^{n \\times n}$ 包含了通量雅可比矩阵和稳定项，而 $x \\in \\mathbb{R}^{n}$ 汇集了所有控制体上的未知数（例如密度、动量分量和能量）。考虑使用广义最小残差（GMRES）方法求解该线性系统。假设采用非重启动的实现，其中包含Arnoldi过程和修正的Gram–Schmidt正交化，以及通过Givens旋转进行的增量最小二乘更新。\n\n采用标准的标量浮点运算（flop）计数模型，其中每次标量乘法或加法计为 $1$ flop，每次标量除法计为 $1$ flop，两个长度为 $n$ 的向量的点积成本为 $2 n$ flops，形式为 $y \\leftarrow y + \\alpha x$（其中 $x, y \\in \\mathbb{R}^{n}$）的“axpy”更新成本为 $2 n$ flops，计算一个长度为 $n$ 的向量的2-范数成本为 $2 n$ flops，而缩放操作 $y \\leftarrow y / \\alpha$ 的成本为 $n$ flops。设一次稀疏矩阵向量乘积 $v \\leftarrow A u$ 的成本表示为 $c_{\\mathrm{mv}}(n)$ flops，其中 $c_{\\mathrm{mv}}(n)$ 仅取决于未知数的数量 $n$ 和由航空航天离散化引起的稀疏模式。忽略任何预处理器应用，并将矩阵 $A$ 本身的存储排除在存储预算之外。\n\n在GMRES的第 $k$ 次迭代中，算法存储当前的Krylov基 $V_{k+1} \\in \\mathbb{R}^{n \\times (k+1)}$、上Hessenberg矩阵 $H_{k+1,k} \\in \\mathbb{R}^{(k+1) \\times k}$、Arnoldi过程所需的长度为 $n$ 的工作向量（例如，残差、归一化前的候选向量和当前近似解），以及长度与 $k$ 成正比的最小二乘工作空间（例如，降维问题中的右端项、当前系数和Givens参数）。在第 $k$ 次迭代内，算术运算包括一次矩阵向量乘积、修正Gram–Schmidt过程中的 $k$ 次内积和 $k$ 次axpy更新、一次归一化（一次2-范数计算和一次缩放），以及对降维最小二乘问题的增量Givens更新，其浮点运算次数与 $k$ 成正比。\n\n以闭合形式计算在第 $k$ 次迭代时所需的总标量存储量（不包括 $A$ 本身的存储）和第 $k$ 次迭代的算术成本（以flop为单位），将其表示为未知数数量 $n$ 和迭代次数 $k$ 的函数。将最终答案表示为关于 $n$ 和 $k$ 的解析表达式。除了 $c_{\\mathrm{mv}}(n)$（其必须仅依赖于 $n$）之外，不要引入任何其他参数。将唯一的最终答案以一个行矩阵的形式提供，其中第一个条目是标量存储计数，第二个条目是每次迭代的flop计数。最终答案中无需单位。",
            "solution": "该问题被评估为科学上合理、适定、客观且自洽，因此被认为是有效的。我们接下来详细推导所要求的量。\n\n任务是计算非重启动GMRES在第 $k$ 次迭代结束时所需的总标量存储量（记为 $S_k$），以及执行第 $k$ 次迭代的算术成本（以浮点运算，即flops为单位，记为 $C_k$）。变量是未知数数量 $n$ 和迭代次数 $k$，其中 $k \\ge 1$。稀疏矩阵向量乘积的成本给定为 $c_{\\mathrm{mv}}(n)$。\n\n**1. 总标量存储量 ($S_k$)**\n\n第 $k$ 次迭代结束时的总存储量是算法生成和维护的各部分存储量之和。我们根据问题描述来统计这些部分。\n\n- **Krylov基存储**：在第 $k$ 次迭代结束时，算法已经计算出 $k+1$ 个标准正交基向量 $v_1, v_2, \\dots, v_{k+1}$，它们构成了矩阵 $V_{k+1} \\in \\mathbb{R}^{n \\times (k+1)}$ 的列。每个向量的长度为 $n$。基向量的总存储量为：\n$$ S_{\\text{basis}} = (k+1)n $$\n\n- **Hessenberg矩阵存储**：Arnoldi过程生成一个上Hessenberg矩阵 $H_{k+1,k} \\in \\mathbb{R}^{(k+1) \\times k}$。该矩阵通常是密集存储的。所需的存储量为：\n$$ S_{H} = (k+1)k = k^2 + k $$\n\n- **工作向量存储**：问题陈述算法存储“Arnoldi过程所需的长度为 $n$ 的工作向量（例如，残差、归一化前的候选向量和当前近似解）”。我们将这个示例列表解释为所需的向量集合，因此我们计入 $3$ 个长度为 $n$ 的工作向量。存储量为：\n$$ S_{\\text{work}} = 3n $$\n\n- **最小二乘工作空间存储**：问题指明需要存储“降维问题中的右端项、当前系数和Givens参数”。在第 $k$ 次迭代结束时：\n    - 降维最小二乘问题的右端项，在应用了 $k$ 次Givens旋转后，是一个长度为 $k+1$ 的向量。存储量：$k+1$。\n    - 解在Krylov基下的系数 $y_k$ 构成一个长度为 $k$ 的向量。存储量：$k$。\n    - $k$ 次Givens旋转每次需要存储一个余弦和一个正弦值。存储量：$2k$。\n该工作空间的总存储量为：\n$$ S_{\\text{LS}} = (k+1) + k + 2k = 4k + 1 $$\n\n总标量存储量 $S_k$ 是这些部分的总和：\n$$ S_k = S_{\\text{basis}} + S_{H} + S_{\\text{work}} + S_{\\text{LS}} $$\n$$ S_k = (k+1)n + (k^2+k) + 3n + (4k+1) $$\n$$ S_k = kn + n + k^2 + k + 3n + 4k + 1 $$\n$$ S_k = (k+4)n + k^2 + 5k + 1 $$\n\n**2. 第 $k$ 次迭代的算术成本 ($C_k$)**\n\n第 $k$ 次迭代的成本是在该单次迭代内执行的操作的flop总和。第 $k$ 次迭代生成基向量 $v_{k+1}$ 和Hessenberg矩阵的第 $k$ 列。\n\n- **稀疏矩阵向量乘积**：Arnoldi过程首先计算 $w \\leftarrow A v_k$。其成本给定为：\n$$ C_{\\text{mv}} = c_{\\mathrm{mv}}(n) $$\n\n- **修正Gram-Schmidt正交化**：向量 $w$ 与现有基向量 $v_1, \\dots, v_k$ 进行正交化。问题指明这涉及到“$k$ 次内积和 $k$ 次axpy更新”。\n    - $k$ 次长度为 $n$ 的向量之间的内积成本为 $k \\times (2n) = 2kn$ flops。\n    - $k$ 次对长度为 $n$ 的向量进行的“axpy”更新（$w \\leftarrow w - h_{i,k}v_i$）的成本为 $k \\times (2n) = 2kn$ flops。\nMGS的总成本为：\n$$ C_{\\text{MGS}} = 2kn + 2kn = 4kn $$\n\n- **归一化**：将得到的正交向量 $w$ 归一化以产生 $v_{k+1}$。这涉及一次范数计算和一次向量缩放。\n    - 一个长度为 $n$ 的向量的2-范数成本为 $2n$ flops。\n    - 缩放一个长度为 $n$ 的向量的成本为 $n$ flops。\n总归一化成本为：\n$$ C_{\\text{norm}} = 2n + n = 3n $$\n\n- **Givens旋转更新**：对最小二乘问题执行一次增量更新。这包括：\n    1. 将先前的 $k-1$ 次Givens旋转应用于新计算的 $H$ 的第 $k$ 列。每次旋转应用花费 $4$ 次乘法和 $2$ 次加法，共 $6$ flops。总成本：$6(k-1)$ flops。\n    2. 计算新的第 $k$ 次Givens旋转的参数（$c_k, s_k$）。这大约需要 $2$ 次平方、$1$ 次加法、$1$ 次平方根和 $2$ 次除法，我们计为 $6$ flops。\n    3. 将新的旋转应用于右端向量。这也花费 $6$ flops。\nGivens更新的总成本为：\n$$ C_{\\text{Givens}} = 6(k-1) + 6 + 6 = 6k + 6 $$\n\n第 $k$ 次迭代的总算术成本 $C_k$ 是这些成本的总和：\n$$ C_k = C_{\\text{mv}} + C_{\\text{MGS}} + C_{\\text{norm}} + C_{\\text{Givens}} $$\n$$ C_k = c_{\\mathrm{mv}}(n) + 4kn + 3n + (6k+6) $$\n$$ C_k = c_{\\mathrm{mv}}(n) + (4k+3)n + 6k + 6 $$\n\n因此，存储量和flop计数被推导为 $n$ 和 $k$ 的函数。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n(k+4)n + k^2 + 5k + 1 & c_{\\mathrm{mv}}(n) + (4k+3)n + 6k + 6\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在计算流体力学（CFD）中，一个常见且令人沮丧的现象是观察到迭代求解器的残差在下降到一定程度后便停滞不前。本练习将超越简单的特征值分析，探讨导致这种现象的深层原因，尤其是在流体动力学中常见的非正规矩阵问题中，伪谱（pseudospectrum）扮演了关键角色。理解这一概念是诊断和缓解收敛缓慢问题的关键 。",
            "id": "3962730",
            "problem": "考虑一个线性系统 $A x = b$，该系统源于在采用迎风格式的曲线网格上对可压缩 Navier–Stokes 方程进行全隐式牛顿线性化。由于对流主导的输运和源项线性化，离散雅可比矩阵 $A$ 是一个大型、稀疏、非对称且强非正规的矩阵。我们采用一个右预条件子 $M$，因此求解的系统为 $A M^{-1} y = b$，其中 $x = M^{-1} y$。使用了不带重启的广义最小残差 (GMRES) 方法，并且观察到当 $k$ 从 $80$ 增加到 $200$ 时，残差 $\\|r_k\\|_2$ 出现平台期，即尽管增加了 Krylov 子空间维度 $k$，残差范数并未进一步减小。\n\n从残差 $r_k = b - A x_k$、Krylov 子空间 $\\mathcal{K}_k(A M^{-1}, r_0)$、谱（特征值集合）以及 $\\varepsilon$-伪谱（使得 $\\|(A M^{-1} - z I)^{-1}\\|$ 超过 $1/\\varepsilon$ 的点 $z$ 的集合）的核心定义出发，推断哪些机制可以解释在这种 CFD 矩阵上 GMRES 方法出现的残差停滞现象。忽略任何重启效应，并假设使用双精度算术且对未知数进行了适当的缩放。\n\n在这种航空航天 CFD 背景下，以下哪些陈述与 $A M^{-1}$ 的谱和伪谱特征相关的停滞现象的科学合理解释最一致？选择所有适用的选项。\n\nA. 如果对于很小的 $\\varepsilon$，$A M^{-1}$ 的 $\\varepsilon$-伪谱与 $0$ 相交，那么受 $p(0) = 1$ 约束的残差多项式无法在相关算子区域上一致地小，并且即使 $k$ 增长，GMRES 也可能表现出停滞。\n\nB. $A M^{-1}$ 的特征值紧密聚集在某个点 $z_0$ 附近（其中 $|z_0|$ 远离 $0$）必然导致 GMRES 停滞，因为当特征值聚集在远离 $0$ 的位置时，多项式无法减小残差。\n\nC. 强非正规性（体现在 $A M^{-1}$ 的一个病态特征向量矩阵上）意味着残差最小化多项式在谱上的小值不能控制 $\\|p_k(A M^{-1})\\|$，因此，即使 $k$ 增加，瞬态放大也可能导致残差平台期。\n\nD. 在精确算术中，对于不带重启的 GMRES，$\\|r_k\\|_2$ 随 $k$ 严格递减，因此非零水平上的残差平台期必须完全归因于舍入误差导致的 Arnoldi 正交性损失。\n\nE. 如果 $A M^{-1}$ 的值域包含 $0$，已知的 GMRES 界无法保证 $\\|r_k\\|_2$ 会减小，并且即使 $k$ 增加，也可能发生停滞。",
            "solution": "令预条件化后的矩阵记为 $B = A M^{-1}$。GMRES 算法在第 $k$ 次迭代时，在仿射 Krylov 子空间 $y_0 + \\mathcal{K}_k(B, r_0)$ 中找到一个近似解 $y_k$，该解使得残差的 $L_2$-范数 $\\|r_k\\|_2 = \\|b - B y_k\\|_2$ 最小，其中 $r_0 = b - B y_0$ 是初始残差。残差可以表示为 $r_k = p_k(B) r_0$，其中 $p_k$ 是一个次数最多为 $k$ 且满足约束 $p_k(0) = 1$ 的多项式。GMRES 会找到最优的此类多项式。因此，收敛行为取决于随着 $k$ 的增加，$\\|p_k(B) r_0\\|_2$ 能变得多小。这导出了相对残差的上界：\n$$ \\frac{\\|r_k\\|_2}{\\|r_0\\|_2} \\le \\min_{p_k \\in \\mathcal{P}_k, p_k(0)=1} \\|p_k(B)\\|_2 $$\n其中 $\\mathcal{P}_k$ 是次数最多为 $k$ 的多项式集合。\n\n对于一个正规矩阵 $B$（即 $B B^H = B^H B$），矩阵多项式的 $2$-范数由矩阵的谱 $\\sigma(B)$ 决定：$\\|p_k(B)\\|_2 = \\max_{\\lambda \\in \\sigma(B)} |p_k(\\lambda)|$。此时，收敛问题就变成了寻找一个在特征值集合上很小且满足 $p_k(0)=1$ 的多项式 $p_k$。\n\n问题陈述指出 $A$（因此很可能 $B=AM^{-1}$）是强非正规的。对于非正规矩阵，仅靠谱无法决定矩阵函数的范数。相反，需要像伪谱（$\\Lambda_\\varepsilon(B)$）、值域（$W(B)$）以及特征向量矩阵的条件数等量来获得完整的图像。观察到的停滞现象，即当 $k \\in [80, 200]$ 时 $\\|r_k\\|_2$ 出现的平台期，必须通过这些概念来解释。\n\n让我们逐一评估每个陈述。\n\n**A. 如果对于很小的 $\\varepsilon$，$A M^{-1}$ 的 $\\varepsilon$-伪谱与 $0$ 相交，那么受 $p(0) = 1$ 约束的残差多项式无法在相关算子区域上一致地小，并且即使 $k$ 增长，GMRES 也可能表现出停滞。**\n\n令 $B = A M^{-1}$。GMRES 的收敛性不是由 $B$ 的谱 $\\sigma(B)$ 决定，而是由其伪谱 $\\Lambda_{\\varepsilon}(B)$ 决定。多项式范数的一个常见界是 $\\|p_k(B)\\|_2 \\le C \\sup_{z \\in \\Omega} |p_k(z)|$，其中 $\\Omega$ 是包含某个 $\\varepsilon$ 的 $\\Lambda_{\\varepsilon}(B)$ 的集合。GMRES 残差多项式 $p_k(z)$ 必须满足 $p_k(0)=1$。如果对于一个很小的 $\\varepsilon$，$\\varepsilon$-伪谱 $\\Lambda_\\varepsilon(B)$ 包含原点或其周围的一个区域，那么必须使 $|p_k(z)|$ 变小的定义域就包括了 $z=0$ 附近的点。根据最大模原理或简单的连续性，一个在 $z=0$ 处为 $1$ 的多项式不可能在包含 $z=0$ 的整个区域上都很小。因此，无论次数 $k$ 如何，$\\sup_{z \\in \\Lambda_\\varepsilon(B)} |p_k(z)|$ 都会被一个接近 $1$ 的值从下方界定。这意味着 $\\|p_k(B)\\|_2$ 不能任意小，从而导致残差范数的上界很差，并解释了观察到的停滞现象。这个陈述是现代理解非正规矩阵 GMRES 方法的基石。\n\n结论：**正确**。\n\n**B. $A M^{-1}$ 的特征值紧密聚集在某个点 $z_0$ 附近（其中 $|z_0|$ 远离 $0$）必然导致 GMRES 停滞，因为当特征值聚集在远离 $0$ 的位置时，多项式无法减小残差。**\n\n这个陈述是根本错误的。如果矩阵是正规的，其特征值聚集在一点 $z_0 \\neq 0$ 附近将导致非常快速的、通常是超线性的收敛。这是因为可以构造一个次数为 $k$ 的多项式，例如 $p_k(z) = (1 - z/z_0)^k$，它满足 $p_k(0)=1$ 并且在 $z_0$ 的邻域内极小。GMRES 会找到一个更好的多项式。“当特征值聚集在远离 $0$ 的位置时，多项式无法减小残差”这一前提是错误的。虽然非正规性使情况变得复杂（伪谱可能比特征值簇大得多），但特征值聚集本身是 GMRES 的一个有利条件，而不是停滞的原因。“必然”一词使该陈述确定无疑是错误的。\n\n结论：**不正确**。\n\n**C. 强非正规性（体现在 $A M^{-1}$ 的一个病态特征向量矩阵上）意味着残差最小化多项式在谱上的小值不能控制 $\\|p_k(A M^{-1})\\|$，因此，即使 $k$ 增加，瞬态放大也可能导致残差平台期。**\n\n这个陈述提供了一个正确且富有洞察力的解释。$B=AM^{-1}$ 的强非正规性等价于其特征向量矩阵 $V$ 是病态的（即具有很大的条件数 $\\kappa_2(V) = \\|V\\|_2 \\|V^{-1}\\|_2 \\gg 1$）。$p_k(B)$ 的范数与其在谱 $\\sigma(B)$ 上的值之间的关系由不等式 $\\|p_k(B)\\|_2 \\le \\kappa_2(V) \\max_{\\lambda \\in \\sigma(B)} |p_k(\\lambda)|$ 给出。如果 $\\kappa_2(V)$ 很大，即使多项式在特征值上非常小，$\\|p_k(B)\\|_2$ 也可能很大。这本质上解释了为什么对于非正规矩阵，特征值分析是不充分的。“瞬态放大”一词指的是对于某些函数 $f$（如矩阵指数或多项式），$\\|f(B)\\|$ 的行为，其范数在衰减之前可能会先显著增长。在 GMRES 的背景下，这转化为一个漫长的初始阶段，在此阶段残差几乎不减小（平台期），因为对于小到中等的 $k$，GMRES 多项式的范数 $\\|p_k(B)\\|_2$ 仍然很大。只有当 $k$ 变得足够大，以至于能够控制多项式在更大的伪谱上的行为时，收敛才会加速。\n\n结论：**正确**。\n\n**D. 在精确算术中，对于不带重启的 GMRES，$\\|r_k\\|_2$ 随 $k$ 严格递减，因此非零水平上的残差平台期必须完全归因于舍入误差导致的 Arnoldi 正交性损失。**\n\n陈述的第一部分是正确的：GMRES 在一系列嵌套子空间 $\\mathcal{K}_k \\subset \\mathcal{K}_{k+1}$ 上最小化残差范数。因此，在精确算术中，$\\|r_{k+1}\\|_2 \\le \\|r_k\\|_2$。除非找到精确解，否则这种减小是严格的。然而，平台期*必须完全*归因于舍入误差的结论是错误的。一个平台期，即极慢的下降速率（$\\|r_k\\|_2 \\approx \\|r_{k-1}\\|_2$），即使在精确算术中，也是高度非正规矩阵的众所周知的行为。理论收敛率可以任意慢。虽然由于浮点运算导致 Arnoldi 过程中的正交性损失是一个加剧停滞的真实且重要的实际问题，但它不是*唯一*原因。根本困难在于算子 $A M^{-1}$ 的数学性质，如选项 A 和 C 所述。问题特别要求与谱和伪谱特征相关的解释，这些是矩阵本身的性质，而不是浮点系统的性质。\n\n结论：**不正确**。\n\n**E. 如果 $A M^{-1}$ 的值域包含 $0$，已知的 GMRES 界无法保证 $\\|r_k\\|_2$ 会减小，并且即使 $k$ 增加，也可能发生停滞。**\n\n$B=AM^{-1}$ 的值域（或数值范围）是集合 $W(B) = \\{v^H B v : \\|v\\|_2 = 1\\}$。大量的 GMRES 收敛理论（例如，Eisenstat、Elman 和 Schultz 的一个定理）提供了依赖于 $W(B)$ 的收敛率界。具体来说，如果 $W(B)$ 包含在一个不含原点的半平面内，或者更一般地，如果原点与 $W(B)$ 有很好的分离，那么就可以建立收敛率的界。如果值域包含原点，即 $0 \\in W(B)$，这些界就不再适用，也无法保证收敛。条件 $0 \\in W(B)$ 是一个公认的指标，表明 GMRES 可能会收敛得非常慢或停滞。这是一个比矩阵有零特征值更一般的条件；对于非正规矩阵，即使矩阵是可逆的，$0$ 也可能在 $W(B)$ 中。这个陈述正确地指出了与 GMRES 停滞相关的一个关键理论条件。\n\n结论：**正确**。",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "前面的练习揭示了 GMRES 算法的成本会随迭代步数增长，并且可能出现收敛停滞。重启的 GMRES，即 GMRES($m$)，是应对这些挑战的实用策略，但我们该如何选择重启参数 $m$ 呢？本练习模拟了一个真实的工程决策过程，要求你在有限的内存资源和由算子非正规性决定的收敛需求之间做出权衡 。",
            "id": "3962743",
            "problem": "一个采用隐式时间积分的可压缩雷诺平均纳维-斯托克斯 (RANS) 求解器，在每个非线性更新步骤中都会产生一个大型稀疏线性系统 $A x = b$。应用一个左预条件子 $M$ 得到 $M^{-1} A x = M^{-1} b$，然后使用重启的广义最小残差法 (GMRES) 求解该线性系统，重启参数为 $m$，记为 GMRES($m$)。本问题涉及在计算流体动力学 (CFD) 中根据三个约束条件来选择 $m$：可用内存、预处理算子的非正规性程度以及期望的每次重启的收敛速率。\n\n假设以下科学上一致的情景：\n- 自由度数量为 $n = 3 \\times 10^{6}$。\n- 为克雷洛夫子空间存储（基向量和小型稠密结构）预留的内存为 $M_{\\mathrm{bytes}} = 8 \\times 10^{9}$ 字节。\n- 预处理和正交化流程需要 $s = 5$ 个长度为 $n$ 的额外辅助向量在迭代期间常驻内存（用于当前迭代解、残差、预处理后的残差以及两个工作向量）。\n- 每个克雷洛夫向量以双精度存储（每个元素使用 $8$ 字节），GMRES($m$) 存储大约 $(m+1)$ 个基向量、一个大小为 $(m+1) \\times m$ 的上Hessenberg矩阵以及少量标量系数。\n- 预处理算子 $M^{-1} A$ 具有中等程度的非正规性，其特征为偏离正规性指数 $\\delta \\approx 0.3$ 以及2-范数的先验估计 $\\|M^{-1}A\\|_{2} \\approx 1.4$。$M^{-1}A$ 的值域（数值范围）到原点的距离估计为 $\\nu \\approx 0.5$。\n- 期望的每次重启的残差下降因子为 $q = 10^{-4}$，这意味着在 $m$ 次内迭代后，残差范数应在重启前至少减小 $10^{-4}$ 倍。\n\n在此背景下，哪个选项最能指定一个科学上合理、实践中可执行的规则来选择 GMRES 重启参数 $m$，并根据给定数据给出相应的 $m$ 的数值选择？\n\nA. 通过限制存储的长度为 $n$ 的向量数量来强制执行内存约束，这些向量包括 $(m+1)$ 个 GMRES 基向量和 $s$ 个辅助向量，对于给定的 $n$，Hessenberg 矩阵的存储可忽略不计。这得到 $m_{\\mathrm{mem}} = \\left\\lfloor \\dfrac{M_{\\mathrm{bytes}}}{8 n} \\right\\rfloor - (s+1)$。通过 GMRES 残差的值域界来施加收敛目标，从而给出达到 $q$ 所需的最小 $m$；选择 $m_{\\mathrm{rate}}$ 为使该界 $\\le q$ 的最小整数。将 $m$ 设置为满足收敛速率但不违反内存约束的最小 $m$；如果 $m_{\\mathrm{rate}} \\le m_{\\mathrm{mem}}$，则使用 $m = m_{\\mathrm{rate}}$，否则使用 $m = m_{\\mathrm{mem}}$ 并在需要时加强预条件子 $M$ 或考虑使用稳定双共轭梯度法 (BiCGSTAB)。对于给定数据，$m_{\\mathrm{mem}} = \\left\\lfloor \\dfrac{8 \\times 10^{9}}{8 \\cdot 3 \\times 10^{6}} \\right\\rfloor - 6 = \\left\\lfloor \\dfrac{8 \\times 10^{9}}{24 \\times 10^{6}} \\right\\rfloor - 6 = \\left\\lfloor 333.\\overline{3} \\right\\rfloor - 6 = 327$，并且基于 $\\|M^{-1}A\\|_{2} \\approx 1.4$ 和 $\\nu \\approx 0.5$ 的值域估计得出 $m_{\\mathrm{rate}} \\approx 135$，因此选择 $m = 135$。\n\nB. 仅基于谱半径 $\\rho(M^{-1}A)$ 并假设算子是正规的来确定 $m$。使用几何收敛模型 $q \\approx \\rho^{m}$ 来达到目标 $q$，因此 $m \\approx \\left\\lceil \\dfrac{\\ln(q^{-1})}{\\ln(\\rho^{-1})} \\right\\rceil$。当 $\\rho \\approx 0.95$ 时，这给出 $m \\approx \\left\\lceil \\dfrac{\\ln(10^{4})}{\\ln(1/0.95)} \\right\\rceil \\approx 180$，并且由于 $(m+1)$ 个向量的粗略内存限制是 $\\left\\lfloor \\dfrac{M_{\\mathrm{bytes}}}{8n} \\right\\rfloor - 1 \\approx 332$，选择 $m=180$ 是在内存允许范围内的。\n\nC. 在仅受内存约束的情况下，通过使用所有可用的基向量存储空间来最大化 $m$，即设置 $m = \\left\\lfloor \\dfrac{M_{\\mathrm{bytes}}}{8 n} \\right\\rfloor - (s+1)$，这得到 $m=327$。这确保了每次重启时使用最大的子空间，通常认为这是最优的，而不管算子的非正规性和期望的收敛速率如何。\n\nD. 非正规性会导致瞬态增长，因此为防止停滞，必须非常频繁地重启。将 $m$ 限制在一个小的固定值，例如 $m=50$，而不考虑期望的 $q$ 值，因为频繁重启可以抑制非正规放大效应并在固定内存下稳定收斂。",
            "solution": "任务是在可压缩 RANS 模拟的背景下，为 GMRES($m$) 算法确定一个科学上合理且实践中可行的重启参数 $m$ 的选择规则。该选择必须平衡三个约束：可用内存、预处理线性系统的非正规性以及收敛速度目标。\n\n首先，我们验证问题陈述。给定条件如下：\n- 系统规模（自由度）：$n = 3 \\times 10^{6}$。\n- 用于克雷洛夫相关数据的可用内存：$M_{\\mathrm{bytes}} = 8 \\times 10^{9}$ 字节。\n- 辅助向量数量：$s = 5$。\n- 数据精度：双精度，每个元素需要 $8$ 字节。\n- GMRES($m$) 的存储模型：$(m+1)$ 个基向量以及辅助结构。\n- 预处理算子 $B = M^{-1} A$ 的性质：\n    - 非正规性指数：$\\delta \\approx 0.3$。\n    - 2-范数：$\\|B\\|_{2} \\approx 1.4$。\n    - 到值域 $W(B)$ 原点的距离：$\\nu = \\text{dist}(0, W(B)) \\approx 0.5$。\n- 期望的每次重启残差下降因子：$q = 10^{-4}$。\n\n该问题具有科学依据、是适定的、客观的，并为大规模 CFD 问题提供了一致且真实的数据。使用算子的范数和值域来表征它是对非正规矩阵迭代法进行数值分析的标准做法。因此，该问题是有效的，我们可以继续求解。\n\n$m$ 的选择受两个主要约束的制约：来自内存限制的上限 $m_{\\mathrm{mem}}$ 和来自期望收敛速率的下限 $m_{\\mathrm{rate}}$。\n\n**1. 内存约束 ($m \\le m_{\\mathrm{mem}}$)**\n\n总可用内存 $M_{\\mathrm{bytes}}$ 必须容纳所有同时驻留在内存中的全长向量。这些向量包括由 Arnoldi 过程生成的克雷洛夫子空间的 $(m+1)$ 个标准正交基向量，以及求解器操作所需的 $s=5$ 个辅助向量。问题陈述中提到，Hessenberg 矩阵和其他小数组的存储可忽略不计，这对于大的 $n$ 是一个有效的近似。\n\n一个长度为 $n$ 的双精度向量的大小为：\n$$S_{\\mathrm{vec}} = n \\times (\\text{bytes per double}) = (3 \\times 10^{6}) \\times 8 = 24 \\times 10^{6} \\text{ 字节}.$$\n\n需要存储的向量总数为 $(m+1) + s$。当 $s=5$ 时，总共有 $m+6$ 个向量。因此，内存约束为：\n$$(m+6) \\times S_{\\mathrm{vec}} \\le M_{\\mathrm{bytes}}$$\n$$m+6 \\le \\frac{M_{\\mathrm{bytes}}}{S_{\\mathrm{vec}}} = \\frac{8 \\times 10^{9}}{24 \\times 10^{6}} = \\frac{8000}{24} = \\frac{1000}{3} \\approx 333.33.$$\n\n由于 $m$ 必须是整数，我们有 $m+6 \\le 333$，这意味着：\n$$m \\le 333 - 6 = 327.$$\n因此，内存允许的最大重启参数为 $m_{\\mathrm{mem}} = 327$。\n\n**2. 收敛速率约束 ($m \\ge m_{\\mathrm{rate}}$)**\n\n问题指出算子 $B=M^{-1}A$ 是非正规的。对于此类算子，基于谱半径 $\\rho(B)$ 的收敛性估计是不可靠的。一种更稳健的方法是使用关于值域（或数值范围）$W(B)$ 的信息。\n\n当值域 $W(B)$ 不包含原点时，一个适用于 GMRES 的标准收敛界由 $\\nu = \\text{dist}(0, W(B))$ 和 $\\|B\\|_2$ 给出。一个常用的 $m$ 步后残差下降的估计是：\n$$ \\frac{\\|r_m\\|_2}{\\|r_0\\|_2} \\le C \\cdot \\left(\\sqrt{1 - \\frac{\\nu^2}{\\|B\\|_2^2}}\\right)^m $$\n其中前渐近因子 $C$ 可能大于 1（例如，$C=\\|B\\|_2/\\nu$），并解释了残差可能出现的初始瞬态增长。为了先验估计所需的迭代次数，通常设置 $C=1$ 以使用简化的渐近界：\n$$ \\frac{\\|r_m\\|_2}{\\|r_0\\|_2} \\approx \\left(\\sqrt{1 - \\frac{\\nu^2}{\\|B\\|_2^2}}\\right)^m \\le q. $$\n我们要求残差至少下降 $q=10^{-4}$。让我们根据给定的数据计算收敛因子：$\\nu \\approx 0.5$ 和 $\\|B\\|_2 \\approx 1.4$。\n$$ \\rho_{\\mathrm{fov}} = \\sqrt{1 - \\frac{\\nu^2}{\\|B\\|_2^2}} = \\sqrt{1 - \\frac{(0.5)^2}{(1.4)^2}} = \\sqrt{1 - \\frac{0.25}{1.96}} = \\sqrt{1 - 0.12755...} = \\sqrt{0.87244...} \\approx 0.93405. $$\n现在，我们求解满足速率要求的最小 $m$：\n$$ (\\rho_{\\mathrm{fov}})^m \\le q $$\n$$ (0.93405)^m \\le 10^{-4} $$\n对两边取自然对数：\n$$ m \\ln(0.93405) \\le \\ln(10^{-4}) $$\n由于 $\\ln(0.93405) \\approx -0.06824$ 是负数，我们在做除法时必须反转不等号：\n$$ m \\ge \\frac{\\ln(10^{-4})}{\\ln(0.93405)} \\approx \\frac{-9.21034}{-0.06824} \\approx 134.96. $$\n由于 $m$ 必须是整数，满足收敛目标所需的最小值为 $m_{\\mathrm{rate}} = \\lceil 134.96 \\rceil = 135$。\n\n**3. 最优重启参数 $m$ 的选择**\n\n我们已经确定了内存限制 $m_{\\mathrm{mem}} = 327$ 和收敛要求 $m_{\\mathrm{rate}} = 135$。科学上合理且实践中高效的策略是，在不超出内存预算的前提下，选择能够达到期望收敛速率的最小重启参数。这可以在满足性能目标的同时，最小化每个重启周期的工作量。\n\n在这里，$m_{\\mathrm{rate}} = 135 \\le m_{\\mathrm{mem}} = 327$。条件得到满足。因此，推荐的选择是 $m = m_{\\mathrm{rate}} = 135$。如果出现 $m_{\\mathrm{rate}} > m_{\\mathrm{mem}}$ 的情况，就不可能同时满足这两个约束。在这种情况下，人们将被迫使用 $m = m_{\\mathrm{mem}}$ 并接受较慢的收敛速率（即在一个周期内无法实现 $q$ 的下降量），或者寻求改进预条件子 $M$，或者切换到像 BiCGSTAB 这样的不同迭代方法。\n\n**选项评估**\n\n**A. 通过限制内存约束... 施加通过值域界的收敛目标... 对于给定数据，$m_{\\mathrm{mem}} = ... = 327$，并且值域估计...得出 $m_{\\mathrm{rate}} \\approx 135$，因此选择 $m = 135$。**\n- 内存约束的公式给出为 $m_{\\mathrm{mem}} = \\left\\lfloor \\dfrac{M_{\\mathrm{bytes}}}{8 n} \\right\\rfloor - (s+1)$。当 $s=5$ 时，即为 $\\left\\lfloor \\dfrac{M_{\\mathrm{bytes}}}{8 n} \\right\\rfloor - 6$。我们的推导得出 $m \\le \\left\\lfloor \\dfrac{M_{\\mathrm{bytes}}}{8 n} \\right\\rfloor - 6$，两者一致。计算结果 $m_{\\mathrm{mem}} = 327$ 是正确的。\n- 对于非正规算子，使用值域界是正确的方法。得出 $m_{\\mathrm{rate}} \\approx 135$ 的计算与我们的推导相符。\n- 其决策逻辑——选择 $m = m_{\\mathrm{rate}}$ 因为 $m_{\\mathrm{rate}} \\le m_{\\mathrm{mem}}$，并概述了如果不满足条件时的备选路径——是合理的，并反映了最佳实践。\n- 最终选择 $m=135$ 基于所提供的数据和合理的原则是正确的。\n**结论：正确。**\n\n**B. 仅基于谱半径 $\\rho(M^{-1}A)$ 并假设算子是正规的来确定 $m$。**\n- 这个选项的基本前提有缺陷。问题明确指出算子是非正规的。对于这类算子，收敛行为由伪谱决定，而不仅仅是谱（特征值）。依赖于基于谱半径的估计（这仅对正规算子有效）在这种情况下在科学上是不正确的，并且可能导致极其乐观的预测和求解器失败。该选项还虚构了一个谱半径的值 ($\\rho \\approx 0.95$)，而这个问题陈述中并未提供该值。\n**结论：不正确。**\n\n**C. 在仅受内存约束的情况下，通过使用所有可用的基向量存储空间来最大化 $m$，即设置 $m=327$。**\n- 这是一种贪婪策略，不一定是最优的。GMRES($m$) 周期的计算工作量与 $m$ 成正比。如果一个较小的 $m=135$ 值足以满足每个周期的收敛目标，那么使用一个较大的值 $m=327$ 会执行超过两倍的必要工作量（矩阵-向量乘法、正交化）。目标是最小化总求解时间，而不仅仅是最大化子空间大小。这种策略效率低下。\n**结论：不正确。**\n\n**D. 非正规性会导致瞬态增长，因此为防止停滞，必须非常频繁地重启。将 $m$ 限制在一个小的固定值，例如 $m = 50$。**\n- 这个选项正确地指出了非正规算子的一个潜在问题（瞬态残差增长），但提出了错误的解决方案。如果 GMRES 重启得太早（即 $m$ 太小），它可能永远无法越过瞬态增长阶段，从而导致停滞。正确的方法是选择足够大的 $m$ 以“越过驼峰”并进入渐近收敛区域。值域分析表明这大约需要 $m=135$ 次迭代。选择 $m=50$ 几乎肯定会导致求解器停滞，因为它会在残差仍处于瞬态非递减阶段时反复重启。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}