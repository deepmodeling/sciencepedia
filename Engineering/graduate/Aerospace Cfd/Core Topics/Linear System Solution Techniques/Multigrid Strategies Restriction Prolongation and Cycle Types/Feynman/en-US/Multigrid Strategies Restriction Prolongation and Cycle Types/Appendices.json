{
    "hands_on_practices": [
        {
            "introduction": "The first step in evaluating any numerical algorithm is to understand its computational cost. For multigrid methods, this means quantifying the work required for each cycle. This exercise  will guide you through a classic complexity analysis to derive the 'work unit' cost of a multigrid cycle as a function of its key parameters. By formulating a recurrence relation for the work across the grid hierarchy, you will determine the asymptotic work factor, a crucial metric for comparing the efficiency of different cycle types like the V-cycle or W-cycle.",
            "id": "3977977",
            "problem": "Aerospace Computational Fluid Dynamics (CFD) solvers for steady problems often employ geometric multigrid on a nested grid hierarchy to accelerate convergence of linear systems arising from the discretization of elliptic operators. Consider a three-dimensional uniform grid hierarchy constructed by standard coarsening, where each coarsening step halves the grid spacing in each coordinate direction. Consequently, the number of unknowns reduces by a factor of $q=2^{d}$ per level, with $d=3$ so that $q=8$. At each noncoarsest level, a multigrid cycle consists of $\\nu_{1}$ pre-smoothing sweeps, computation and restriction of the residual via full-weighting to the next coarser grid, $\\gamma$ recursive coarse-grid cycles, prolongation of the coarse-grid correction via trilinear interpolation back to the current grid, and $\\nu_{2}$ post-smoothing sweeps. Assume the following linear work model per level, measured in dimensionless “work units”:\n- Each smoothing sweep costs $s$ work units per unknown on that level.\n- Restriction via full-weighting costs $r$ work units per coarse-grid unknown produced.\n- Prolongation via trilinear interpolation costs $p$ work units per fine-grid unknown updated.\n\nLet $N_{\\ell}$ denote the number of unknowns on level $\\ell$, with $N_{\\ell+1}=N_{\\ell}/q$. Let $W_{\\ell}$ denote the total work units required to execute one $\\gamma$-cycle starting on level $\\ell$. Assume that the coarsest grid solve cost is negligible in the asymptotic limit of many levels.\n\nStarting from these definitions and the structural description of the geometric multigrid cycle, derive a closed-form expression for the asymptotic per-cycle work factor $\\alpha$ defined by $W_{0}\\approx \\alpha N_{0}$ in the limit of an arbitrarily deep hierarchy, expressed as a function of $\\gamma$, $\\nu_{1}$, $\\nu_{2}$, $s$, $r$, $p$, and $q$. Then, evaluate $\\alpha$ for the specific choices $d=3$ (so $q=8$), $\\gamma=2$ (a W-cycle), $\\nu_{1}=1$, $\\nu_{2}=2$, $s=5$, $r=3$, and $p=4$. \n\nExpress your final answer as a dimensionless real number, and round your answer to four significant figures.",
            "solution": "The problem statement is evaluated for validity before proceeding to a solution.\n\n**Step 1: Extract Givens**\n- Grid hierarchy: Three-dimensional ($d=3$) uniform grid with standard coarsening.\n- Coarsening factor: The number of unknowns reduces by a factor of $q=2^{d}$, where $d=3$, so $q=8$.\n- Multigrid cycle components:\n  - $\\nu_{1}$ pre-smoothing sweeps.\n  - Restriction of residual via full-weighting.\n  - $\\gamma$ recursive coarse-grid cycles.\n  - Prolongation of correction via trilinear interpolation.\n  - $\\nu_{2}$ post-smoothing sweeps.\n- Work model (in \"work units\"):\n  - Smoothing cost per unknown: $s$.\n  - Restriction cost per coarse-grid unknown: $r$.\n  - Prolongation cost per fine-grid unknown: $p$.\n- Notation:\n  - $N_{\\ell}$ is the number of unknowns on level $\\ell$.\n  - Grid level relation: $N_{\\ell+1} = N_{\\ell}/q$.\n  - $W_{\\ell}$ is the total work for one $\\gamma$-cycle on level $\\ell$.\n- Assumption: The cost of the coarsest grid solve is negligible.\n- Objective 1: Derive a closed-form expression for the asymptotic per-cycle work factor $\\alpha$, defined by $W_{0} \\approx \\alpha N_{0}$, as a function of $\\gamma$, $\\nu_{1}$, $\\nu_{2}$, $s$, $r$, $p$, and $q$.\n- Objective 2: Evaluate $\\alpha$ for the specific case: $d=3$ (so $q=8$), $\\gamma=2$ (W-cycle), $\\nu_{1}=1$, $\\nu_{2}=2$, $s=5$, $r=3$, and $p=4$.\n- Final answer requirements: Round the numerical result to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is firmly grounded in the well-established field of numerical analysis, specifically the complexity analysis of geometric multigrid methods. The work model is a standard and valid simplification used to analyze algorithmic efficiency. All components described (smoothing, restriction, prolongation, V-cycle, W-cycle) are standard elements of multigrid theory.\n- **Well-Posedness:** The problem is well-posed. It describes a recursive process for which a recurrence relation can be formulated. The request for an asymptotic work factor implies seeking a fixed-point solution to this recurrence, which leads to a unique algebraic expression for $\\alpha$. The provided numerical values allow for a unique solution.\n- **Objectivity:** The problem is stated in precise, objective, and technical language, free from any subjective or ambiguous terms.\n- **Completeness and Consistency:** The problem provides all necessary parameters and relationships ($\\nu_{1}$, $\\nu_{2}$, $s$, $r$, $p$, $\\gamma$, $q$, $N_{\\ell+1}/N_{\\ell}$) to formulate the recurrence relation. The assumption of a negligible coarsest-grid solve is explicitly stated, which is necessary for the asymptotic analysis. There are no contradictions.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a standard exercise in the analysis of multigrid algorithms. A solution will be derived.\n\n**Derivation of the Solution**\nLet $W_{\\ell}$ be the total work units to perform one multigrid cycle starting on level $\\ell$, which has $N_{\\ell}$ unknowns. The cycle consists of several steps, and the total work is the sum of the work for each step:\n\n1.  **Pre-smoothing:** $\\nu_{1}$ sweeps on level $\\ell$. The cost is $\\nu_{1} s N_{\\ell}$.\n2.  **Restriction:** The residual is restricted from level $\\ell$ to level $\\ell+1$. This operation produces $N_{\\ell+1}$ values on the coarse grid. The cost is $r N_{\\ell+1}$.\n3.  **Coarse-grid cycles:** $\\gamma$ multigrid cycles are performed recursively on the next coarser grid, level $\\ell+1$. The cost of one such cycle is $W_{\\ell+1}$. The total cost for this step is $\\gamma W_{\\ell+1}$.\n4.  **Prolongation:** The correction is prolonged from level $\\ell+1$ back to level $\\ell$. This operation updates all $N_{\\ell}$ unknowns on the fine grid. The cost is $p N_{\\ell}$.\n5.  **Post-smoothing:** $\\nu_{2}$ sweeps on level $\\ell$. The cost is $\\nu_{2} s N_{\\ell}$.\n\nSumming these contributions gives the recurrence relation for the work $W_{\\ell}$:\n$$W_{\\ell} = \\nu_{1} s N_{\\ell} + r N_{\\ell+1} + \\gamma W_{\\ell+1} + p N_{\\ell} + \\nu_{2} s N_{\\ell}$$\nThis can be simplified by grouping terms:\n$$W_{\\ell} = ((\\nu_{1} + \\nu_{2})s + p) N_{\\ell} + r N_{\\ell+1} + \\gamma W_{\\ell+1}$$\nThe number of unknowns on adjacent grid levels is related by $N_{\\ell+1} = N_{\\ell}/q$. Substituting this into the recurrence relation yields:\n$$W_{\\ell} = ((\\nu_{1} + \\nu_{2})s + p) N_{\\ell} + r \\frac{N_{\\ell}}{q} + \\gamma W_{\\ell+1}$$\n$$W_{\\ell} = \\left[ (\\nu_{1} + \\nu_{2})s + p + \\frac{r}{q} \\right] N_{\\ell} + \\gamma W_{\\ell+1}$$\nWe are looking for the asymptotic per-cycle work factor $\\alpha$, defined by $W_{0} \\approx \\alpha N_{0}$ for the finest grid (level $0$) in the limit of an infinitely deep grid hierarchy. In this limit, the work per unknown becomes independent of the level, so we can define a constant work factor $\\alpha$ such that $W_{\\ell} = \\alpha N_{\\ell}$ for all $\\ell$.\nDividing the recurrence by $N_{\\ell}$:\n$$\\frac{W_{\\ell}}{N_{\\ell}} = \\left[ (\\nu_{1} + \\nu_{2})s + p + \\frac{r}{q} \\right] + \\gamma \\frac{W_{\\ell+1}}{N_{\\ell}}$$\nSubstituting $\\alpha = W_{\\ell}/N_{\\ell}$ and $W_{\\ell+1} = \\alpha N_{\\ell+1}$:\n$$\\alpha = \\left[ (\\nu_{1} + \\nu_{2})s + p + \\frac{r}{q} \\right] + \\gamma \\frac{\\alpha N_{\\ell+1}}{N_{\\ell}}$$\nUsing $N_{\\ell+1}/N_{\\ell} = 1/q$, we get an algebraic equation for $\\alpha$:\n$$\\alpha = \\left[ (\\nu_{1} + \\nu_{2})s + p + \\frac{r}{q} \\right] + \\frac{\\gamma}{q} \\alpha$$\nThis is the fixed-point equation for the asymptotic work factor. We can now solve for $\\alpha$:\n$$\\alpha - \\frac{\\gamma}{q} \\alpha = (\\nu_{1} + \\nu_{2})s + p + \\frac{r}{q}$$\n$$\\alpha \\left(1 - \\frac{\\gamma}{q}\\right) = (\\nu_{1} + \\nu_{2})s + p + \\frac{r}{q}$$\nThis leads to the closed-form expression for $\\alpha$:\n$$\\alpha = \\frac{(\\nu_{1} + \\nu_{2})s + p + \\frac{r}{q}}{1 - \\frac{\\gamma}{q}}$$\nFor this expression to represent a finite, bounded amount of work, the denominator must be positive, which requires $\\frac{\\gamma}{q} < 1$, or $\\gamma < q$.\n\n**Numerical Evaluation**\nWe are given the following specific values:\n- $d=3$, so $q = 2^{d} = 2^{3} = 8$.\n- $\\gamma = 2$ (for a W-cycle).\n- $\\nu_{1} = 1$.\n- $\\nu_{2} = 2$.\n- $s = 5$.\n- $r = 3$.\n- $p = 4$.\n\nThe condition $\\gamma < q$ is met, since $2 < 8$. We can now substitute these values into the derived expression for $\\alpha$:\n$$\\alpha = \\frac{(1 + 2) \\cdot 5 + 4 + \\frac{3}{8}}{1 - \\frac{2}{8}}$$\n$$\\alpha = \\frac{3 \\cdot 5 + 4 + \\frac{3}{8}}{1 - \\frac{1}{4}}$$\n$$\\alpha = \\frac{15 + 4 + 0.375}{1 - 0.25}$$\n$$\\alpha = \\frac{19.375}{0.75}$$\nTo compute the exact fraction:\n$$\\alpha = \\frac{19 + \\frac{3}{8}}{\\frac{3}{4}} = \\frac{\\frac{152}{8} + \\frac{3}{8}}{\\frac{3}{4}} = \\frac{\\frac{155}{8}}{\\frac{3}{4}} = \\frac{155}{8} \\cdot \\frac{4}{3} = \\frac{155}{2 \\cdot 3} = \\frac{155}{6}$$\nAs a decimal, this is $155 \\div 6 \\approx 25.8333...$\nThe problem asks for the answer to be rounded to four significant figures. The first four significant figures are $2$, $5$, $8$, and $3$. The fifth digit is $3$, so we round down.\n$$\\alpha \\approx 25.83$$",
            "answer": "$$\\boxed{25.83}$$"
        },
        {
            "introduction": "While computational cost is important, a multigrid cycle's true value lies in its ability to efficiently reduce errors. This convergence power is primarily determined by the smoother's effectiveness at damping high-frequency error components. In this practice , you will use Local Fourier Analysis (LFA), a powerful theoretical tool, to analyze a line smoother designed for an anisotropic problem—a common challenge in CFD where simple smoothers fail. This analysis will not only reveal the smoother's performance but also show how to optimize it by selecting the ideal relaxation parameter.",
            "id": "3977962",
            "problem": "Consider an anisotropic diffusion model representative of laminar boundary layers in Computational Fluid Dynamics (CFD), given on a rectangular domain with periodic boundary conditions by the partial differential equation $-\\partial_{x}(\\epsilon\\,\\partial_{x} u) - \\partial_{y}(\\partial_{y} u) = f$, where $\\epsilon$ is a positive anisotropy parameter satisfying $0 < \\epsilon \\ll 1$. Let the domain be discretized on a uniform Cartesian grid with spacing $h$ in both directions, and let the resulting discrete linear system be $A u = b$, where $A$ is the five-point anisotropic diffusion operator obtained from second-order centered finite differences.\n\nA two-grid method is constructed using $2h$-coarsening in both directions with standard full-weighting restriction $R$ and bilinear (linear in one spatial dimension and linear in the other) interpolation prolongation $P$. A $V(1,1)$ cycle is employed. As the smoother, use weighted block Jacobi line relaxation in the $y$-direction: for each fixed index $i$ (grid line parallel to the $y$-axis), the block operator $B$ is the tridiagonal $y$-direction discrete diffusion plus the $x$-direction diagonal contribution, and the iteration is $e^{(k+1)} = e^{(k)} - \\omega B^{-1} A e^{(k)}$, with relaxation parameter $\\omega \\in (0,2)$ and error $e^{(k)}$.\n\nDefine the high-frequency set relative to $2h$-coarsening as all Fourier modes with at least one component not representable on the coarse grid, that is, $\\{ (\\theta_{x}, \\theta_{y}) \\in (-\\pi,\\pi]^{2} : |\\theta_{x}| \\geq \\pi/2 \\text{ or } |\\theta_{y}| \\geq \\pi/2 \\}$. Using Local Fourier Analysis (LFA), derive the symbol of the smoothing error-propagation operator for this line block Jacobi and determine the optimal relaxation parameter $\\omega$ that minimizes the maximum amplification over the high-frequency set. Then, for $\\epsilon = 10^{-3}$ and $h$ equal in both directions, compute the minimal possible high-frequency smoothing factor (the minimized maximum over the high-frequency set of the magnitude of the smoothing error amplification). Express your final numerical answer rounded to four significant figures. No units are required.",
            "solution": "The user wants to analyze a smoother for an anisotropic diffusion problem using Local Fourier Analysis (LFA).\n\n### Step 1: Problem Validation\n\n**1. Extract Givens:**\n-   **PDE:** $-\\partial_{x}(\\epsilon\\,\\partial_{x} u) - \\partial_{y}(\\partial_{y} u) = f$ on a rectangular domain with periodic boundary conditions.\n-   **Anisotropy Parameter:** $\\epsilon$ is a positive constant, $0 < \\epsilon \\ll 1$.\n-   **Discretization:** Uniform Cartesian grid with spacing $h$ in both directions. The resulting linear system is $A u = b$. The operator $A$ is a five-point stencil from second-order centered finite differences.\n-   **Multigrid Method:** A two-grid method with $2h$-coarsening.\n    -   Restriction $R$: Standard full-weighting.\n    -   Prolongation $P$: Bilinear interpolation.\n    -   Cycle: $V(1,1)$.\n-   **Smoother:** Weighted block Jacobi line relaxation in the $y$-direction.\n    -   Block operator $B$: For a fixed $x$-index $i$, $B$ is the tridiagonal $y$-direction discrete diffusion plus the $x$-direction diagonal contribution.\n    -   Iteration: $e^{(k+1)} = e^{(k)} - \\omega B^{-1} A e^{(k)}$ with relaxation parameter $\\omega \\in (0,2)$.\n-   **High-Frequency Set:** $\\{ (\\theta_{x}, \\theta_{y}) \\in (-\\pi,\\pi]^{2} : |\\theta_{x}| \\geq \\pi/2 \\text{ or } |\\theta_{y}| \\geq \\pi/2 \\}$.\n-   **Task:**\n    1.  Derive the symbol of the smoothing error-propagation operator.\n    2.  Determine the optimal relaxation parameter $\\omega$.\n    3.  For $\\epsilon = 10^{-3}$, compute the minimal high-frequency smoothing factor, rounded to four significant figures.\n\n**2. Validate Using Extracted Givens:**\n-   **Scientifically Grounded:** The problem is based on standard, well-established principles of numerical analysis for partial differential equations, specifically in the context of multigrid methods and computational fluid dynamics. The anisotropic diffusion equation is a canonical model problem. Local Fourier Analysis is the standard tool for analyzing idealized multigrid performance. The smoother is a common choice for this type of anisotropy. All aspects are scientifically sound.\n-   **Well-Posed:** The problem is mathematically well-defined. It asks for the derivation of an analytical expression (a symbol), the optimization of a parameter, and the computation of a specific numerical value. These tasks are clear and should lead to a unique, meaningful solution.\n-   **Objective:** The problem is stated in precise, technical, and unbiased language.\n-   **Completeness:** All necessary components are defined: the PDE, the discretization scheme, the smoother, the multigrid coarsening strategy (which defines the high-frequency domain), and the specific analysis to be performed. The problem is self-contained.\n\n**3. Verdict and Action:**\nThe problem is valid. I will proceed with the solution.\n\n### Step 2: Solution Derivation\n\n**Symbol of the Discrete Operator $A$**\n\nThe partial differential equation is $-\\epsilon \\frac{\\partial^2 u}{\\partial x^2} - \\frac{\\partial^2 u}{\\partial y^2} = f$.\nApplying second-order centered finite differences on a uniform grid with spacing $h$ gives the discrete operator $A$:\n$$ (A u)_{i,j} = \\frac{1}{h^2} \\left[ -\\epsilon u_{i-1,j} - u_{i,j-1} + (2\\epsilon + 2)u_{i,j} - u_{i,j+1} - \\epsilon u_{i+1,j} \\right] $$\nTo find the LFA symbol $\\tilde{A}(\\theta_x, \\theta_y)$, we apply $A$ to a Fourier mode $u_{i,j} = \\exp(\\mathrm{i}(i\\theta_x + j\\theta_y))$, where $\\theta_x = k_x h$ and $\\theta_y = k_y h$ are the dimensionless frequencies.\n$$ \\tilde{A}(\\theta_x, \\theta_y) = \\frac{1}{h^2} \\left[ -\\epsilon e^{-\\mathrm{i}\\theta_x} - e^{-\\mathrm{i}\\theta_y} + (2\\epsilon + 2) - e^{\\mathrm{i}\\theta_y} - \\epsilon e^{\\mathrm{i}\\theta_x} \\right] $$\n$$ \\tilde{A}(\\theta_x, \\theta_y) = \\frac{1}{h^2} \\left[ (2\\epsilon + 2) - \\epsilon(e^{\\mathrm{i}\\theta_x} + e^{-\\mathrm{i}\\theta_x}) - (e^{\\mathrm{i}\\theta_y} + e^{-\\mathrm{i}\\theta_y}) \\right] $$\n$$ \\tilde{A}(\\theta_x, \\theta_y) = \\frac{1}{h^2} \\left[ 2\\epsilon(1 - \\cos(\\theta_x)) + 2(1 - \\cos(\\theta_y)) \\right] $$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we get:\n$$ \\tilde{A}(\\theta_x, \\theta_y) = \\frac{4}{h^2} \\left[ \\epsilon \\sin^2(\\frac{\\theta_x}{2}) + \\sin^2(\\frac{\\theta_y}{2}) \\right] $$\n\n**Symbol of the Smoother Block Operator $B$**\n\nThe smoother is a weighted line Jacobi relaxation in the $y$-direction. The block operator $B$ is defined as the tridiagonal $y$-direction discrete diffusion plus the $x$-direction diagonal contribution.\nThe $y$-direction term is $-\\frac{\\partial^2 u}{\\partial y^2}$, which discretizes to $\\frac{1}{h^2}[-u_{i,j-1} + 2u_{i,j} - u_{i,j+1}]$.\nThe $x$-direction term is $-\\epsilon \\frac{\\partial^2 u}{\\partial x^2}$, which discretizes to $\\frac{\\epsilon}{h^2}[-u_{i-1,j} + 2u_{i,j} - u_{i+1,j}]$. The diagonal contribution from this term is $\\frac{2\\epsilon}{h^2}u_{i,j}$.\nThus, the operator $B$ is:\n$$ (B u)_{i,j} = \\frac{1}{h^2} \\left[ -u_{i,j-1} + (2\\epsilon + 2)u_{i,j} - u_{i,j+1} \\right] $$\nThe symbol $\\tilde{B}(\\theta_x, \\theta_y)$ is found by applying $B$ to the same Fourier mode. Note that $B$ only acts along the $j$ index, so its symbol will only depend on $\\theta_y$.\n$$ \\tilde{B}(\\theta_y) = \\frac{1}{h^2} \\left[ -e^{-\\mathrm{i}\\theta_y} + (2\\epsilon + 2) - e^{\\mathrm{i}\\theta_y} \\right] $$\n$$ \\tilde{B}(\\theta_y) = \\frac{1}{h^2} \\left[ 2\\epsilon + 2 - 2\\cos(\\theta_y) \\right] = \\frac{2}{h^2} \\left[ \\epsilon + 1 - \\cos(\\theta_y) \\right] $$\n$$ \\tilde{B}(\\theta_y) = \\frac{2}{h^2} \\left[ \\epsilon + 2\\sin^2(\\frac{\\theta_y}{2}) \\right] $$\n\n**Symbol of the Smoothing Error-Propagation Operator $S$**\n\nThe smoothing iteration for the error $e$ is $e^{(k+1)} = (I - \\omega B^{-1} A) e^{(k)}$. The smoothing operator is $S = I - \\omega B^{-1} A$.\nIts symbol is $\\tilde{S}(\\theta_x, \\theta_y) = 1 - \\omega \\frac{\\tilde{A}(\\theta_x, \\theta_y)}{\\tilde{B}(\\theta_y)}$.\nSubstituting the symbols for $A$ and $B$:\n$$ \\tilde{S}(\\theta_x, \\theta_y) = 1 - \\omega \\frac{\\frac{4}{h^2} \\left[ \\epsilon \\sin^2(\\frac{\\theta_x}{2}) + \\sin^2(\\frac{\\theta_y}{2}) \\right]}{\\frac{2}{h^2} \\left[ \\epsilon + 2\\sin^2(\\frac{\\theta_y}{2}) \\right]} $$\nThis is the desired symbol of the smoothing error-propagation operator:\n$$ \\tilde{S}(\\theta_x, \\theta_y) = 1 - \\omega \\frac{2 \\left( \\epsilon \\sin^2(\\frac{\\theta_x}{2}) + \\sin^2(\\frac{\\theta_y}{2}) \\right)}{\\epsilon + 2\\sin^2(\\frac{\\theta_y}{2})} $$\n\n**Optimal Relaxation Parameter and Smoothing Factor**\n\nTo find the optimal relaxation parameter $\\omega_{opt}$, we need to minimize the smoothing factor $\\mu = \\max_{(\\theta_x, \\theta_y) \\in HF} |\\tilde{S}(\\theta_x, \\theta_y)|$. Let $s_x = \\sin^2(\\theta_x/2)$ and $s_y = \\sin^2(\\theta_y/2)$. The domain for $(\\theta_x, \\theta_y)$ is $(-\\pi, \\pi]^2$, so $s_x, s_y \\in [0, 1]$. The high-frequency (HF) set is where $|\\theta_x| \\ge \\pi/2$ or $|\\theta_y| \\ge \\pi/2$, which translates to $s_x \\ge \\sin^2(\\pi/4) = 1/2$ or $s_y \\ge 1/2$.\nThe expression to analyze is $\\tilde{S} = 1 - \\omega Z$, where $Z(s_x, s_y) = \\frac{2(\\epsilon s_x + s_y)}{\\epsilon + 2s_y}$.\nWe must find the range of $Z$ over the HF set, i.e., for $(s_x, s_y) \\in D_{HF} = ([1/2, 1] \\times [0, 1]) \\cup ([0, 1/2) \\times [1/2, 1])$.\n\nThe partial derivatives are:\n$$ \\frac{\\partial Z}{\\partial s_x} = \\frac{2\\epsilon}{\\epsilon + 2s_y} > 0 $$\n$$ \\frac{\\partial Z}{\\partial s_y} = \\frac{2(\\epsilon + 2s_y) - 2(\\epsilon s_x + s_y) \\cdot 2}{(\\epsilon + 2s_y)^2} = \\frac{2\\epsilon(1 - 2s_x)}{(\\epsilon + 2s_y)^2} $$\nThe sign of $\\partial Z / \\partial s_y$ depends on $s_x$.\n-   If $s_x < 1/2$, $\\partial Z/\\partial s_y > 0$.\n-   If $s_x > 1/2$, $\\partial Z/\\partial s_y < 0$.\n-   If $s_x = 1/2$, $\\partial Z/\\partial s_y = 0$.\n\nWe analyze the extrema of $Z$ on the boundaries of the HF domain:\n1.  On the set $s_x \\in [1/2, 1], s_y \\in [0,1]$:\n    $\\partial Z/\\partial s_x > 0$ and $\\partial Z/\\partial s_y \\leq 0$. The extrema must lie on the boundary of this rectangular region.\n    Maximum is at a point with largest $s_x$ and smallest $s_y$, which is $(s_x, s_y) = (1, 0)$.\n    $Z_{max} = Z(1, 0) = \\frac{2(\\epsilon \\cdot 1 + 0)}{\\epsilon + 0} = 2$.\n    Minimum is at a point with smallest $s_x$ and largest $s_y$, which is $(s_x, s_y) = (1/2, 1)$.\n    $Z(1/2, 1) = \\frac{2(\\epsilon/2 + 1)}{\\epsilon + 2} = \\frac{\\epsilon + 2}{\\epsilon + 2} = 1$.\n    The range on this set is $[1, 2]$.\n\n2.  On the set $s_x \\in [0, 1/2), s_y \\in [1/2, 1]$:\n    $\\partial Z/\\partial s_x > 0$ and $\\partial Z/\\partial s_y > 0$. The function is increasing in both variables.\n    Maximum is approached at $(s_x, s_y) \\to (1/2, 1)$, where $Z \\to 1$.\n    Minimum is at $(s_x, s_y) = (0, 1/2)$.\n    $Z_{min} = Z(0, 1/2) = \\frac{2(\\epsilon \\cdot 0 + 1/2)}{\\epsilon + 2(1/2)} = \\frac{1}{1 + \\epsilon}$.\n    The range on this set is $[1/(1+\\epsilon), 1)$.\n\nCombining both regions, the total range of $Z$ over the high-frequency set is $[Z_{min}, Z_{max}] = [1/(1+\\epsilon), 2]$.\nTo minimize $\\max_Z |1 - \\omega Z|$, we choose $\\omega$ such that the amplification factor has equal magnitude at the ends of the interval:\n$$ 1 - \\omega Z_{min} = -(1 - \\omega Z_{max}) $$\n$$ 2 = \\omega (Z_{min} + Z_{max}) $$\nThis gives the optimal relaxation parameter:\n$$ \\omega_{opt} = \\frac{2}{Z_{min} + Z_{max}} = \\frac{2}{\\frac{1}{1+\\epsilon} + 2} = \\frac{2(1+\\epsilon)}{1 + 2(1+\\epsilon)} = \\frac{2(1+\\epsilon)}{3+2\\epsilon} $$\nThe minimal smoothing factor $\\mu_{opt}$ is the magnitude of the amplification at the endpoints:\n$$ \\mu_{opt} = |1 - \\omega_{opt} Z_{max}| = \\left|1 - \\frac{2(1+\\epsilon)}{3+2\\epsilon} \\cdot 2\\right| = \\left|\\frac{3+2\\epsilon - 4(1+\\epsilon)}{3+2\\epsilon}\\right| = \\left|\\frac{-1-2\\epsilon}{3+2epsilon}\\right| = \\frac{1+2\\epsilon}{3+2\\epsilon} $$\nAlternatively,\n$$ \\mu_{opt} = \\frac{Z_{max} - Z_{min}}{Z_{max} + Z_{min}} = \\frac{2 - \\frac{1}{1+\\epsilon}}{2 + \\frac{1}{1+\\epsilon}} = \\frac{2(1+\\epsilon) - 1}{2(1+\\epsilon) + 1} = \\frac{1+2\\epsilon}{3+2\\epsilon} $$\n\n**Numerical Calculation**\n\nWe are given $\\epsilon = 10^{-3} = 0.001$. We must compute the smoothing factor $\\mu_{opt}$.\n$$ \\mu_{opt} = \\frac{1 + 2(0.001)}{3 + 2(0.001)} = \\frac{1 + 0.002}{3 + 0.002} = \\frac{1.002}{3.002} $$\n$$ \\mu_{opt} \\approx 0.33377748167... $$\nRounding to four significant figures, we obtain $0.3338$.",
            "answer": "$$\\boxed{0.3338}$$"
        },
        {
            "introduction": "Effective multigrid performance relies on a symbiotic relationship: the smoother damps high-frequency errors, while the coarse-grid correction eliminates the low-frequency errors that remain. To predict the overall convergence rate, we must analyze these two processes together. This final exercise  synthesizes our analysis by developing a complete two-grid model using LFA. You will construct the $2 \\times 2$ amplification matrix that captures the interaction between smoothing and coarse-grid correction, allowing you to compute the two-grid convergence factor—the ultimate predictor of the method's idealized performance.",
            "id": "3977959",
            "problem": "Consider a one-dimensional discretization of the pressure Poisson equation that arises in incompressible Computational Fluid Dynamics (CFD), with periodic boundary conditions on a uniform grid of spacing $h$. The discrete operator is the standard second-order central-difference Laplacian represented by the three-point stencil with coefficients $[1,-2,1]/h^{2}$ acting on a grid function. The multigrid components are defined as follows: the smoother is the weighted Jacobi method with relaxation parameter $\\omega$ and with $\\nu_{1}$ pre-smoothing iterations and $\\nu_{2}$ post-smoothing iterations; the restriction from fine grid to coarse grid is the one-dimensional full-weighting strategy; the prolongation from coarse grid to fine grid is the one-dimensional linear interpolation. The coarse grid spacing is $H=2h$. The analysis is to be performed using Local Fourier Analysis (LFA), assuming infinite periodic grids so that discrete Fourier modes are exact eigenfunctions of the involved linear operators.\n\nStarting from the fundamental base consisting of the discrete Laplacian operator, the definition of the weighted Jacobi iteration using the diagonal of the operator, and the standard full-weighting and linear interpolation transfer operators, derive a two-grid error-propagation operator in Fourier space for the pair of fine-grid Fourier modes $\\varphi_{\\theta}(j)=e^{\\mathrm{i} j \\theta}$ and $\\varphi_{\\theta+\\pi}(j)=e^{\\mathrm{i} j (\\theta+\\pi)}$, where $j$ is the grid index and $\\theta \\in (-\\pi,\\pi]$. Use this to compute the following two quantities:\n\n1. The weighted-Jacobi smoothing factor $\\mu(\\omega)$ defined as the supremum over the high-frequency set $\\theta \\in [\\pi/2,\\pi]$ of the absolute value of the Fourier symbol of the weighted Jacobi iteration matrix.\n\n2. The two-grid convergence factor $\\rho_{\\mathrm{TG}}(\\omega,\\nu_{1},\\nu_{2})$ defined as the supremum over the low-frequency set $\\theta \\in (0,\\pi/2]$ of the spectral radius of the two-grid error-propagation matrix that combines $\\nu_{1}$ pre-smoothing iterations, coarse-grid correction with full-weighting restriction and linear interpolation prolongation, and $\\nu_{2}$ post-smoothing iterations.\n\nAll quantities are dimensionless and must be computed as real numbers. The program should approximate the suprema with sufficiently fine uniform sampling in $\\theta$ over the specified intervals. Avoid evaluating exactly at $\\theta=0$.\n\nTest Suite:\n- Case A (happy path): $\\omega=2/3$, $\\nu_{1}=1$, $\\nu_{2}=1$.\n- Case B (stronger smoothing): $\\omega=0.8$, $\\nu_{1}=2$, $\\nu_{2}=1$.\n- Case C (no smoothing effect): $\\omega=0.0$, $\\nu_{1}=1$, $\\nu_{2}=1$.\n- Case D (boundary of common stability range): $\\omega=1.0$, $\\nu_{1}=1$, $\\nu_{2}=1$.\n\nFor each test case, output a list with two floats $[\\mu,\\rho_{\\mathrm{TG}}]$, each rounded to six decimal places. Your program should produce a single line of output containing the results as a comma-separated list of these lists with no spaces, enclosed in square brackets (for example, $[[\\mu_{A},\\rho_{A}],[\\mu_{B},\\rho_{B}],[\\mu_{C},\\rho_{C}],[\\mu_{D},\\rho_{D}]]$).",
            "solution": "The problem statement has been validated and is deemed sound. It is a well-posed problem in the field of numerical analysis, specifically the Local Fourier Analysis (LFA) of multigrid methods, which is a standard technique in aerospace CFD and other areas involving the solution of partial differential equations. All parameters and definitions are standard and self-consistent. We proceed with the derivation and solution.\n\nThe analysis is performed in Fourier space. A grid function on an infinite periodic grid is represented by its Fourier series. An operator acting on this function is then represented by its action on each Fourier mode $\\varphi_{\\theta}(j) = e^{\\mathrm{i} j \\theta}$, where $j$ is the grid index and $\\theta \\in (-\\pi, \\pi]$ is the dimensionless frequency. The action of a linear, shift-invariant operator $A$ on a Fourier mode results in the mode being scaled by a complex number $\\hat{A}(\\theta)$, known as the Fourier symbol or amplification factor of the operator.\n$A \\varphi_{\\theta} = \\hat{A}(\\theta) \\varphi_{\\theta}$.\n\n**1. Fourier Symbol of the Discrete Laplacian**\n\nThe discrete Laplacian operator $L_h$ with the stencil $[1,-2,1]/h^2$ on a grid function $u_j$ is given by:\n$$ (L_h u)_j = \\frac{u_{j-1} - 2u_j + u_{j+1}}{h^2} $$\nApplying this to the Fourier mode $\\varphi_{\\theta}(j) = e^{\\mathrm{i} j \\theta}$:\n$$ (L_h \\varphi_{\\theta})_j = \\frac{e^{\\mathrm{i}(j-1)\\theta} - 2e^{\\mathrm{i} j\\theta} + e^{\\mathrm{i}(j+1)\\theta}}{h^2} = \\frac{e^{\\mathrm{i} j\\theta}}{h^2} (e^{-\\mathrm{i}\\theta} - 2 + e^{\\mathrm{i}\\theta}) = \\frac{e^{\\mathrm{i} j\\theta}}{h^2}(2\\cos\\theta - 2) $$\nUsing the identity $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$, the symbol of the Laplacian is:\n$$ \\hat{L}_h(\\theta) = \\frac{2(\\cos\\theta - 1)}{h^2} = -\\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta}{2}\\right) $$\nThe symbol is dimensionless if we scale the operator by $h^2$, which we will implicitly do as the $h^2$ factors will cancel out in the final dimensionless quantities.\n\n**2. Weighted-Jacobi Smoothing Factor $\\mu(\\omega)$**\n\nThe error $e$ in a system $L_h u = f$ transforms under one weighted Jacobi step as $e \\to S_h e$, where the iteration operator is $S_h = I - \\omega D^{-1} L_h$. The diagonal of $L_h$ is a constant operator, $D = (-2/h^2)I$. Thus, $D^{-1} = (-h^2/2)I$.\nThe smoother operator is $S_h = I - \\omega (-\\frac{h^2}{2}) L_h = I + \\frac{\\omega h^2}{2} L_h$.\nIts Fourier symbol is:\n$$ \\hat{S}_h(\\theta) = 1 + \\frac{\\omega h^2}{2} \\hat{L}_h(\\theta) = 1 + \\frac{\\omega h^2}{2} \\left(-\\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta}{2}\\right)\\right) = 1 - 2\\omega\\sin^2\\left(\\frac{\\theta}{2}\\right) $$\nThis can also be written as $\\hat{S}_h(\\theta) = 1 - \\omega(1 - \\cos\\theta)$.\nHigh frequencies correspond to $\\theta \\in [\\pi/2, \\pi]$. The smoothing factor $\\mu(\\omega)$ is the maximum amplification factor for these high frequencies:\n$$ \\mu(\\omega) = \\sup_{\\theta \\in [\\pi/2, \\pi]} |\\hat{S}_h(\\theta)| = \\sup_{\\theta \\in [\\pi/2, \\pi]} |1 - \\omega(1 - \\cos\\theta)| $$\nOn the interval $\\theta \\in [\\pi/2, \\pi]$, $\\cos\\theta$ is monotonic, decreasing from $0$ to $-1$. Therefore, $1-\\cos\\theta$ is monotonic, increasing from $1$ to $2$. The supremum of $|\\hat{S}_h(\\theta)|$ must occur at the boundaries of the interval:\n$$ \\mu(\\omega) = \\max\\left( \\left|\\hat{S}_h(\\pi/2)\\right|, \\left|\\hat{S}_h(\\pi)\\right| \\right) = \\max\\left( |1 - \\omega|, |1 - 2\\omega| \\right) $$\n\n**3. Two-Grid Convergence Factor $\\rho_{\\mathrm{TG}}$**\n\nThe two-grid analysis couples low-frequency modes $\\varphi_{\\theta}$ with their high-frequency aliases $\\varphi_{\\theta+\\pi}$ for $\\theta \\in (0, \\pi/2]$. The state of the error is described by a vector of Fourier coefficients $\\begin{pmatrix} c_\\theta & c_{\\theta+\\pi} \\end{pmatrix}^T$. The two-grid cycle's effect on this vector is described by a $2 \\times 2$ amplification matrix $\\hat{M}_{\\mathrm{TG}}(\\theta)$.\n\nThe two-grid error propagation operator is $M_{\\mathrm{TG}} = S_h^{\\nu_2} (I - P L_{2h}^{-1} R L_h) S_h^{\\nu_1}$. The symbol $\\hat{M}_{\\mathrm{TG}}(\\theta)$ is:\n$$ \\hat{M}_{\\mathrm{TG}}(\\theta) = \\hat{S}_h(\\theta)^{\\nu_2} \\left(I_2 - \\hat{P}(\\theta) \\hat{L}_{2h}(2\\theta)^{-1} \\hat{R}(\\theta) \\hat{L}_h(\\theta) \\right) \\hat{S}_h(\\theta)^{\\nu_1} $$\nwhere operators are replaced by their $2\\times2$ symbol matrices.\n\n- **Smoother Symbol Matrix:** The smoother acts component-wise on the two modes:\n$$ \\hat{S}_h(\\theta) \\rightarrow \\begin{pmatrix} \\hat{S}_h(\\theta) & 0 \\\\ 0 & \\hat{S}_h(\\theta+\\pi) \\end{pmatrix} $$\n- **Restriction Symbol:** Full-weighting restriction ($I_h^{2h}$) has stencil $[1/4, 1/2, 1/4]$. Its action on the two modes gives a $1\\times 2$ symbol matrix:\n$$ \\hat{R}(\\theta) = \\begin{pmatrix} \\cos^2(\\theta/2) & \\sin^2(\\theta/2) \\end{pmatrix} $$\n- **Prolongation Symbol:** Linear interpolation ($I_{2h}^h$) is the transpose of full-weighting:\n$$ \\hat{P}(\\theta) = \\begin{pmatrix} \\cos^2(\\theta/2) \\\\ \\sin^2(\\theta/2) \\end{pmatrix} $$\n- **Coarse-Grid Operator Symbol:** On the coarse grid with spacing $H=2h$, the frequency is $2\\theta$. The symbol is:\n$$ \\hat{L}_{2h}(2\\theta) = -\\frac{4}{(2h)^2}\\sin^2\\left(\\frac{2\\theta}{2}\\right) = -\\frac{1}{h^2}\\sin^2(\\theta) $$\n- **Fine-Grid Operator Symbol Matrix:** This is a diagonal matrix of the fine-grid operator symbols for the two coupled modes:\n$$ \\hat{L}_h(\\theta) \\rightarrow \\hat{L}_h(\\theta, \\theta+\\pi) = \\begin{pmatrix} \\hat{L}_h(\\theta) & 0 \\\\ 0 & \\hat{L}_h(\\theta+\\pi) \\end{pmatrix} = -\\frac{4}{h^2}\\begin{pmatrix} \\sin^2(\\theta/2) & 0 \\\\ 0 & \\cos^2(\\theta/2) \\end{pmatrix} $$\nThe coarse-grid operator satisfies the Galerkin property, $\\hat{L}_{2h}(2\\theta) = \\hat{R}(\\theta) \\hat{L}_h(\\theta, \\theta+\\pi) \\hat{P}(\\theta)$, which simplifies the analysis.\n\nThe coarse-grid correction matrix symbol is $\\hat{C}(\\theta) = I_2 - \\hat{P}(\\theta) \\hat{L}_{2h}(2\\theta)^{-1} \\hat{R}(\\theta) \\hat{L}_h(\\theta, \\theta+\\pi)$. A direct calculation yields:\n$$ \\hat{C}(\\theta) = \\begin{pmatrix} \\sin^2(\\theta/2) & -\\cos^2(\\theta/2) \\\\ -\\sin^2(\\theta/2) & \\cos^2(\\theta/2) \\end{pmatrix} $$\nThis is a projection matrix, satisfying $\\hat{C}(\\theta)^2 = \\hat{C}(\\theta)$.\n\nThe full two-grid amplification matrix is $\\hat{M}_{\\mathrm{TG}}(\\theta) = \\hat{S}_h(\\theta)^{\\nu_2} \\hat{C}(\\theta) \\hat{S}_h(\\theta)^{\\nu_1}$.\nLet $s^2 = \\sin^2(\\theta/2)$, $c^2 = \\cos^2(\\theta/2)$, $S_{\\theta} = \\hat{S}_h(\\theta) = 1-2\\omega s^2$, and $S_{\\theta+\\pi} = \\hat{S}_h(\\theta+\\pi) = 1-2\\omega c^2$.\n$$ \\hat{M}_{\\mathrm{TG}}(\\theta) = \\begin{pmatrix} S_{\\theta}^{\\nu_2} & 0 \\\\ 0 & S_{\\theta+\\pi}^{\\nu_2} \\end{pmatrix} \\begin{pmatrix} s^2 & -c^2 \\\\ -s^2 & c^2 \\end{pmatrix} \\begin{pmatrix} S_{\\theta}^{\\nu_1} & 0 \\\\ 0 & S_{\\theta+\\pi}^{\\nu_1} \\end{pmatrix} = \\begin{pmatrix} s^2 S_{\\theta}^{\\nu_1+\\nu_2} & -c^2 S_{\\theta}^{\\nu_2} S_{\\theta+\\pi}^{\\nu_1} \\\\ -s^2 S_{\\theta+\\pi}^{\\nu_2} S_{\\theta}^{\\nu_1} & c^2 S_{\\theta+\\pi}^{\\nu_1+\\nu_2} \\end{pmatrix} $$\nThe spectral radius $\\sigma(\\hat{M}_{\\mathrm{TG}})$ is the maximum absolute eigenvalue. The eigenvalues $\\lambda$ are roots of the characteristic polynomial $\\lambda^2 - \\text{tr}(\\hat{M}_{\\mathrm{TG}})\\lambda + \\det(\\hat{M}_{\\mathrm{TG}}) = 0$.\nThe determinant is $\\det(\\hat{M}_{\\mathrm{TG}}) = s^2c^2 S_{\\theta}^{\\nu_1+\\nu_2} S_{\\theta+\\pi}^{\\nu_1+\\nu_2} - s^2c^2 S_{\\theta}^{\\nu_1+\\nu_2} S_{\\theta+\\pi}^{\\nu_1+\\nu_2} = 0$.\nThis means one eigenvalue is $0$, and the other is equal to the trace.\n$$ \\sigma(\\hat{M}_{\\mathrm{TG}}(\\theta)) = |\\text{tr}(\\hat{M}_{\\mathrm{TG}}(\\theta))| = |s^2 S_{\\theta}^{\\nu_1+\\nu_2} + c^2 S_{\\theta+\\pi}^{\\nu_1+\\nu_2}| $$\nSubstituting the expressions, we get the quantity to be maximized:\n$$ \\sigma(\\theta; \\omega, \\nu_1, \\nu_2) = \\left|\\sin^2\\left(\\frac{\\theta}{2}\\right) \\left(1-2\\omega\\sin^2\\left(\\frac{\\theta}{2}\\right)\\right)^{\\nu_1+\\nu_2} + \\cos^2\\left(\\frac{\\theta}{2}\\right) \\left(1-2\\omega\\cos^2\\left(\\frac{\\theta}{2}\\right)\\right)^{\\nu_1+\\nu_2}\\right| $$\nThe two-grid convergence factor is the supremum of this quantity over the low frequencies:\n$$ \\rho_{\\mathrm{TG}}(\\omega, \\nu_1, \\nu_2) = \\sup_{\\theta \\in (0, \\pi/2]} \\sigma(\\theta; \\omega, \\nu_1, \\nu_2) $$\nThe suprema for both $\\mu(\\omega)$ and $\\rho_{\\mathrm{TG}}(\\omega, \\nu_1, \\nu_2)$ will be approximated by sampling the respective functions over a fine uniform grid on their domains.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the weighted-Jacobi smoothing factor and the two-grid convergence\n    factor for a 1D Poisson problem using Local Fourier Analysis (LFA).\n    \"\"\"\n\n    test_cases = [\n        # Case A (happy path)\n        (2/3, 1, 1),\n        # Case B (stronger smoothing)\n        (0.8, 2, 1),\n        # Case C (no smoothing effect)\n        (0.0, 1, 1),\n        # Case D (boundary of common stability range - standard Jacobi)\n        (1.0, 1, 1),\n    ]\n\n    all_results = []\n    \n    # Use a fine grid for approximating the supremum\n    N_POINTS = 20000\n\n    for omega, nu1, nu2 in test_cases:\n        \n        # 1. Compute the weighted-Jacobi smoothing factor mu(omega)\n        # mu = sup |S_hat(theta)| for theta in [pi/2, pi]\n        theta_high = np.linspace(np.pi / 2, np.pi, N_POINTS)\n        \n        # S_hat(theta) = 1 - omega * (1 - cos(theta))\n        # Note: 1 - cos(theta) = 2 * sin(theta/2)^2\n        # So S_hat(theta) = 1 - 2 * omega * sin(theta/2)^2\n        s_hat_high = 1.0 - omega * (1.0 - np.cos(theta_high))\n        mu = np.max(np.abs(s_hat_high))\n        \n        # Analytical check: mu(omega) = max(|1-omega|, |1-2*omega|)\n        # mu_analytical = max(abs(1 - omega), abs(1 - 2 * omega))\n        # This numerical result should be very close to the analytical one.\n\n        # 2. Compute the two-grid convergence factor rho_TG(omega, nu1, nu2)\n        # rho_TG = sup spectral_radius(M_TG(theta)) for theta in (0, pi/2]\n        \n        # Avoid theta=0 by starting at a small epsilon\n        epsilon = 1e-9\n        theta_low = np.linspace(epsilon, np.pi / 2, N_POINTS)\n        cos_theta = np.cos(theta_low)\n\n        # Let s2 = sin^2(theta/2) and c2 = cos^2(theta/2)\n        # s2 = (1 - cos(theta)) / 2\n        # c2 = (1 + cos(theta)) / 2\n        s2 = (1.0 - cos_theta) / 2.0\n        c2 = (1.0 + cos_theta) / 2.0\n        \n        # Smoother symbols for low and high frequency parts\n        # S_theta = 1 - 2 * omega * s^2\n        # S_theta_pi = 1 - 2 * omega * c^2\n        s_theta = 1.0 - 2.0 * omega * s2\n        s_theta_pi = 1.0 - 2.0 * omega * c2\n        \n        # Total number of smoothing steps\n        nu_total = nu1 + nu2\n        \n        # Spectral radius of the two-grid amplification matrix\n        # spectral_radius = |s^2 * S_theta^nu_total + c^2 * S_theta_pi^nu_total|\n        # Use np.power to handle non-integer exponents if ever needed,\n        # and it handles complex numbers correctly if base is negative.\n        # But here nu_total is an integer, so ** is fine.\n        spec_radius = np.abs(s2 * (s_theta ** nu_total) + c2 * (s_theta_pi ** nu_total))\n        rho_tg = np.max(spec_radius)\n\n        all_results.append([round(mu, 6), round(rho_tg, 6)])\n    \n    # Format the final output string as per requirements\n    # e.g., [[0.333333,0.111111],[0.600000,0.170368],...]\n    output_str = f\"[{','.join([f'[{res[0]:.6f},{res[1]:.6f}]' for res in all_results])}]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}