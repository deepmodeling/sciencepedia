{
    "hands_on_practices": [
        {
            "introduction": "多重网格方法的一个核心优势是其理想的计算复杂度，即求解问题的总计算量与未知数数量 $N$ 成正比。本练习旨在将这一理论概念具体化。通过建立一个多重网格循环中各项操作（如光滑、限制和延长）的线性工作量模型，您将推导出总计算功的递推关系，并求解其渐近行为，从而深入理解 V-循环与 W-循环等不同策略的效率差异 。",
            "id": "3977977",
            "problem": "航空航天计算流体动力学 (CFD) 求解器在处理稳态问题时，通常在嵌套网格层级上采用几何多重网格方法，以加速由椭圆算子离散化产生的线性系统的收敛。考虑一个通过标准粗化构建的三维均匀网格层级，其中每个粗化步骤将各坐标方向上的网格间距减半。因此，每层的未知量数量减少一个因子 $q=2^{d}$，其中 $d=3$，所以 $q=8$。在每个非最粗层上，一个多重网格循环包括 $\\nu_{1}$ 次预平滑扫描，通过全权重法计算残差并将其限制到下一层更粗的网格，$\\gamma$ 次递归的粗网格循环，通过三线性插值将粗网格校正延拓回当前网格，以及 $\\nu_{2}$ 次后平滑扫描。假设每层采用以下线性计算量模型，以无量纲的“工作单位”计量：\n- 每次平滑扫描在该层上每个未知量消耗 $s$ 个工作单位。\n- 通过全权重法进行限制，每产生一个粗网格未知量消耗 $r$ 个工作单位。\n- 通过三线性插值进行延拓，每更新一个细网格未知量消耗 $p$ 个工作单位。\n\n令 $N_{\\ell}$ 表示第 $\\ell$ 层的未知量数量，且 $N_{\\ell+1}=N_{\\ell}/q$。令 $W_{\\ell}$ 表示在第 $\\ell$ 层上执行一次 $\\gamma$ 循环所需的总工作单位数。假设在多层数的渐近极限下，最粗网格的求解成本可以忽略不计。\n\n从这些定义和几何多重网格循环的结构描述出发，推导在任意深度层级的极限情况下，由 $W_{0}\\approx \\alpha N_{0}$ 定义的渐近每循环功因子 $\\alpha$ 的闭式表达式，该表达式应为 $\\gamma$、$\\nu_{1}$、$\\nu_{2}$、$s$、$r$、$p$ 和 $q$ 的函数。然后，对于特定选择 $d=3$（因此 $q=8$）、$\\gamma=2$（W循环）、$\\nu_{1}=1$、$\\nu_{2}=2$、$s=5$、$r=3$ 和 $p=4$ 来计算 $\\alpha$ 的值。\n\n将你的最终答案表示为一个无量纲实数，并四舍五入到四位有效数字。",
            "solution": "在进行求解之前，对问题陈述的有效性进行评估。\n\n**步骤1：提取已知条件**\n- 网格层级：三维（$d=3$）均匀网格，采用标准粗化。\n- 粗化因子：未知量数量每层减少一个因子 $q=2^{d}$，其中 $d=3$，所以 $q=8$。\n- 多重网格循环组成部分：\n  - $\\nu_{1}$ 次预平滑扫描。\n  - 通过全权重法进行残差限制。\n  - $\\gamma$ 次递归粗网格循环。\n  - 通过三线性插值进行校正延拓。\n  - $\\nu_{2}$ 次后平滑扫描。\n- 计算量模型（以“工作单位”计）：\n  - 每个未知量的平滑成本：$s$。\n  - 每个粗网格未知量的限制成本：$r$。\n  - 每个细网格未知量的延拓成本：$p$。\n- 符号表示：\n  - $N_{\\ell}$ 是第 $\\ell$ 层的未知量数量。\n  - 网格层级关系：$N_{\\ell+1} = N_{\\ell}/q$。\n  - $W_{\\ell}$ 是在第 $\\ell$ 层上进行一次 $\\gamma$ 循环的总计算量。\n- 假设：最粗网格的求解成本可以忽略不计。\n- 目标1：推导由 $W_{0} \\approx \\alpha N_{0}$ 定义的渐近每循环功因子 $\\alpha$ 的闭式表达式，该表达式为 $\\gamma$、$\\nu_{1}$、$\\nu_{2}$、$s$、$r$、$p$ 和 $q$ 的函数。\n- 目标2：对特定情况 $d=3$（因此 $q=8$）、$\\gamma=2$（W循环）、$\\nu_{1}=1$、$\\nu_{2}=2$、$s=5$、$r=3$ 和 $p=4$ 计算 $\\alpha$ 的值。\n- 最终答案要求：将数值结果四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础：** 该问题牢固地植根于成熟的数值分析领域，特别是几何多重网格方法的复杂度分析。计算量模型是用于分析算法效率的标准且有效的简化模型。所描述的所有组成部分（平滑、限制、延拓、V循环、W循环）都是多重网格理论的标准元素。\n- **适定性：** 该问题是适定的。它描述了一个可以建立递推关系的递归过程。要求渐近功因子意味着寻求该递推关系的一个不动点解，这会导出一个唯一的 $\\alpha$ 代数表达式。提供的数值允许得出唯一解。\n- **客观性：** 问题以精确、客观、技术性的语言陈述，没有任何主观或模糊的术语。\n- **完整性和一致性：** 问题提供了建立递推关系所需的所有必要参数和关系（$\\nu_{1}$、$\\nu_{2}$、$s$、$r$、$p$、$\\gamma$、$q$、$N_{\\ell+1}/N_{\\ell}$）。明确说明了最粗网格求解成本可忽略的假设，这对于渐近分析是必要的。不存在任何矛盾。\n\n**步骤3：结论与行动**\n该问题是有效的。这是多重网格算法分析中的一个标准练习。将推导解答。\n\n**解的推导**\n令 $W_{\\ell}$ 为在具有 $N_{\\ell}$ 个未知量的第 $\\ell$ 层上执行一次多重网格循环所需的总工作单位。该循环包括几个步骤，总计算量是每一步计算量之和：\n\n1.  **预平滑：** 在第 $\\ell$ 层上进行 $\\nu_{1}$ 次扫描。成本为 $\\nu_{1} s N_{\\ell}$。\n2.  **限制：** 将残差从第 $\\ell$ 层限制到第 $\\ell+1$ 层。此操作在粗网格上产生 $N_{\\ell+1}$ 个值。成本为 $r N_{\\ell+1}$。\n3.  **粗网格循环：** 在下一层更粗的网格（第 $\\ell+1$ 层）上递归执行 $\\gamma$ 次多重网格循环。一次此类循环的成本为 $W_{\\ell+1}$。此步骤的总成本为 $\\gamma W_{\\ell+1}$。\n4.  **延拓：** 将校正从第 $\\ell+1$ 层延拓回第 $\\ell$ 层。此操作更新细网格上所有的 $N_{\\ell}$ 个未知量。成本为 $p N_{\\ell}$。\n5.  **后平滑：** 在第 $\\ell$ 层上进行 $\\nu_{2}$ 次扫描。成本为 $\\nu_{2} s N_{\\ell}$。\n\n将这些贡献相加，得到计算量 $W_{\\ell}$ 的递推关系：\n$$W_{\\ell} = \\nu_{1} s N_{\\ell} + r N_{\\ell+1} + \\gamma W_{\\ell+1} + p N_{\\ell} + \\nu_{2} s N_{\\ell}$$\n可以通过组合项来简化：\n$$W_{\\ell} = ((\\nu_{1} + \\nu_{2})s + p) N_{\\ell} + r N_{\\ell+1} + \\gamma W_{\\ell+1}$$\n相邻网格层上的未知量数量由 $N_{\\ell+1} = N_{\\ell}/q$ 关联。将此代入递推关系中，得到：\n$$W_{\\ell} = ((\\nu_{1} + \\nu_{2})s + p) N_{\\ell} + r \\frac{N_{\\ell}}{q} + \\gamma W_{\\ell+1}$$\n$$W_{\\ell} = \\left[ (\\nu_{1} + \\nu_{2})s + p + \\frac{r}{q} \\right] N_{\\ell} + \\gamma W_{\\ell+1}$$\n我们正在寻找渐近每循环功因子 $\\alpha$，对于最细网格（第0层），在无限深网格层级的极限下，定义为 $W_{0} \\approx \\alpha N_{0}$。在此极限下，每个未知量的计算量与层级无关，因此我们可以定义一个常数功因子 $\\alpha$，使得对于所有 $\\ell$ 都有 $W_{\\ell} = \\alpha N_{\\ell}$。\n将递推关系两边同除以 $N_{\\ell}$：\n$$\\frac{W_{\\ell}}{N_{\\ell}} = \\left[ (\\nu_{1} + \\nu_{2})s + p + \\frac{r}{q} \\right] + \\gamma \\frac{W_{\\ell+1}}{N_{\\ell}}$$\n代入 $\\alpha = W_{\\ell}/N_{\\ell}$ 和 $W_{\\ell+1} = \\alpha N_{\\ell+1}$：\n$$\\alpha = \\left[ (\\nu_{1} + \\nu_{2})s + p + \\frac{r}{q} \\right] + \\gamma \\frac{\\alpha N_{\\ell+1}}{N_{\\ell}}$$\n使用 $N_{\\ell+1}/N_{\\ell} = 1/q$，我们得到一个关于 $\\alpha$ 的代数方程：\n$$\\alpha = \\left[ (\\nu_{1} + \\nu_{2})s + p + \\frac{r}{q} \\right] + \\frac{\\gamma}{q} \\alpha$$\n这是渐近功因子的不动点方程。我们现在可以解出 $\\alpha$：\n$$\\alpha - \\frac{\\gamma}{q} \\alpha = (\\nu_{1} + \\nu_{2})s + p + \\frac{r}{q}$$\n$$\\alpha \\left(1 - \\frac{\\gamma}{q}\\right) = (\\nu_{1} + \\nu_{2})s + p + \\frac{r}{q}$$\n这导出了 $\\alpha$ 的闭式表达式：\n$$\\alpha = \\frac{(\\nu_{1} + \\nu_{2})s + p + \\frac{r}{q}}{1 - \\frac{\\gamma}{q}}$$\n为使此表达式表示有限且有界的计算量，分母必须为正，这要求 $\\frac{\\gamma}{q}  1$，即 $\\gamma  q$。\n\n**数值计算**\n我们给定以下具体值：\n- $d=3$，所以 $q = 2^{d} = 2^{3} = 8$。\n- $\\gamma = 2$（对于W循环）。\n- $\\nu_{1} = 1$。\n- $\\nu_{2} = 2$。\n- $s = 5$。\n- $r = 3$。\n- $p = 4$。\n\n条件 $\\gamma  q$ 得到满足，因为 $2  8$。我们现在可以将这些值代入导出的 $\\alpha$ 表达式中：\n$$\\alpha = \\frac{(1 + 2) \\cdot 5 + 4 + \\frac{3}{8}}{1 - \\frac{2}{8}}$$\n$$\\alpha = \\frac{3 \\cdot 5 + 4 + \\frac{3}{8}}{1 - \\frac{1}{4}}$$\n$$\\alpha = \\frac{15 + 4 + 0.375}{1 - 0.25}$$\n$$\\alpha = \\frac{19.375}{0.75}$$\n为了计算精确分数：\n$$\\alpha = \\frac{19 + \\frac{3}{8}}{\\frac{3}{4}} = \\frac{\\frac{152}{8} + \\frac{3}{8}}{\\frac{3}{4}} = \\frac{\\frac{155}{8}}{\\frac{3}{4}} = \\frac{155}{8} \\cdot \\frac{4}{3} = \\frac{155}{2 \\cdot 3} = \\frac{155}{6}$$\n作为小数，这是 $155 \\div 6 \\approx 25.8333...$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $2$、$5$、$8$ 和 $3$。第五位数字是 $3$，所以我们向下舍入。\n$$\\alpha \\approx 25.83$$",
            "answer": "$$\\boxed{25.83}$$"
        },
        {
            "introduction": "多重网格方法的收敛效率在很大程度上取决于光滑子的性能，即其快速衰减高频误差分量的能力。对于像计算流体力学（CFD）边界层中常见的各向异性问题，标准的光滑子（如点Jacobi）可能效果不佳。本练习将引导您使用局部傅里叶分析（Local Fourier Analysis, LFA）这一强大工具，来评估一种专为各向异性问题设计的行光滑子（line smoother）的性能，并确定其最优松弛参数 。",
            "id": "3977962",
            "problem": "考虑一个代表计算流体动力学(CFD)中层流边界层的各向异性扩散模型，该模型定义在一个具有周期性边界条件的矩形域上，由偏微分方程 $-\\partial_{x}(\\epsilon\\,\\partial_{x} u) - \\partial_{y}(\\partial_{y} u) = f$ 给出，其中 $\\epsilon$ 是一个满足 $0  \\epsilon \\ll 1$ 的正常数各向异性参数。设该域在两个方向上均以间距 $h$ 的均匀笛卡尔网格进行离散化，得到的离散线性系统为 $A u = b$，其中 $A$ 是由二阶中心有限差分得到的五点各向异性扩散算子。\n\n使用在两个方向上进行 $2h$-粗化、标准全加权限制 $R$ 和双线性插值延拓 $P$ 构建一个双网格方法。采用 $V(1,1)$ 循环。光滑子使用 $y$ 方向上的加权块雅可比线松弛：对于每个固定的索引 $i$（平行于 $y$ 轴的网格线），块算子 $B$ 是三对角的 $y$ 方向离散扩散加上 $x$ 方向的对角贡献，迭代过程为 $e^{(k+1)} = e^{(k)} - \\omega B^{-1} A e^{(k)}$，其中松弛参数为 $\\omega \\in (0,2)$，误差为 $e^{(k)}$。\n\n相对于 $2h$-粗化，将高频集定义为所有至少有一个分量不能在粗网格上表示的傅里叶模式，即 $\\{ (\\theta_{x}, \\theta_{y}) \\in (-\\pi,\\pi]^{2} : |\\theta_{x}| \\geq \\pi/2 \\text{ or } |\\theta_{y}| \\geq \\pi/2 \\}$。使用局部傅里叶分析(LFA)，推导此线块雅可比光滑子的光滑误差传播算子的符号，并确定最优松弛参数 $\\omega$，以最小化高频集上的最大放大率。然后，对于 $\\epsilon = 10^{-3}$ 且两个方向的 $h$ 相等的情况，计算最小可能的高频光滑因子（光滑误差放大率的幅值在高频集上的最小化最大值）。将最终数值答案四舍五入至四位有效数字。不需要单位。",
            "solution": "用户希望使用局部傅里叶分析(LFA)来分析一个各向异性扩散问题的光滑子。\n\n### 步骤1：问题验证\n\n**1. 提取已知条件：**\n-   **偏微分方程(PDE)：** $-\\partial_{x}(\\epsilon\\,\\partial_{x} u) - \\partial_{y}(\\partial_{y} u) = f$，在具有周期性边界条件的矩形域上。\n-   **各向异性参数：** $\\epsilon$ 是一个正常数，$0  \\epsilon \\ll 1$。\n-   **离散化：** 均匀笛卡尔网格，两个方向上的间距均为 $h$。得到的线性系统为 $A u = b$。算子 $A$ 是通过二阶中心有限差分得到的五点格式。\n-   **多重网格方法：** 一个具有 $2h$-粗化的双网格方法。\n    -   限制 $R$：标准全加权。\n    -   延拓 $P$：双线性插值。\n    -   循环：$V(1,1)$。\n-   **光滑子：** $y$ 方向上的加权块雅可比线松弛。\n    -   块算子 $B$：对于一个固定的 $x$-索引 $i$，$B$ 是三对角的 $y$ 方向离散扩散加上 $x$ 方向的对角贡献。\n    -   迭代：$e^{(k+1)} = e^{(k)} - \\omega B^{-1} A e^{(k)}$，松弛参数为 $\\omega \\in (0,2)$。\n-   **高频集：** $\\{ (\\theta_{x}, \\theta_{y}) \\in (-\\pi,\\pi]^{2} : |\\theta_{x}| \\geq \\pi/2 \\text{ or } |\\theta_{y}| \\geq \\pi/2 \\}$。\n-   **任务：**\n    1.  推导光滑误差传播算子的符号。\n    2.  确定最优松弛参数 $\\omega$。\n    3.  对于 $\\epsilon = 10^{-3}$，计算最小高频光滑因子，四舍五入到四位有效数字。\n\n**2. 使用提取的已知条件进行验证：**\n-   **科学依据：** 该问题基于偏微分方程数值分析的标准、成熟的原理，特别是在多重网格方法和计算流体力学的背景下。各向异性扩散方程是一个典型的模型问题。局部傅里叶分析是分析理想化多重网格性能的标准工具。该光滑子是针对此类各向异性问题的常用选择。所有方面都具有科学合理性。\n-   **适定性：** 该问题在数学上是适定的。它要求推导一个解析表达式（一个符号）、优化一个参数以及计算一个特定的数值。这些任务清晰明确，应能导出一个唯一且有意义的解。\n-   **客观性：** 问题以精确、技术性和无偏见的语言陈述。\n-   **完整性：** 所有必要的组成部分都已定义：偏微分方程、离散化方案、光滑子、多重网格粗化策略（它定义了高频域），以及要执行的具体分析。该问题是自包含的。\n\n**3. 结论与行动：**\n问题有效。我将继续进行求解。\n\n### 步骤2：求解推导\n\n**离散算子 $A$ 的符号**\n\n偏微分方程为 $-\\epsilon \\frac{\\partial^2 u}{\\partial x^2} - \\frac{\\partial^2 u}{\\partial y^2} = f$。\n在间距为 $h$ 的均匀网格上应用二阶中心有限差分，得到离散算子 $A$：\n$$ (A u)_{i,j} = \\frac{1}{h^2} \\left[ -\\epsilon u_{i-1,j} - u_{i,j-1} + (2\\epsilon + 2)u_{i,j} - u_{i,j+1} - \\epsilon u_{i+1,j} \\right] $$\n为了找到 LFA 符号 $\\tilde{A}(\\theta_x, \\theta_y)$，我们将 $A$ 应用于一个傅里叶模式 $u_{i,j} = \\exp(\\mathrm{i}(i\\theta_x + j\\theta_y))$，其中 $\\theta_x = k_x h$ 和 $\\theta_y = k_y h$ 是无量纲频率。\n$$ \\tilde{A}(\\theta_x, \\theta_y) = \\frac{1}{h^2} \\left[ -\\epsilon e^{-\\mathrm{i}\\theta_x} - e^{-\\mathrm{i}\\theta_y} + (2\\epsilon + 2) - e^{\\mathrm{i}\\theta_y} - \\epsilon e^{\\mathrm{i}\\theta_x} \\right] $$\n$$ \\tilde{A}(\\theta_x, \\theta_y) = \\frac{1}{h^2} \\left[ (2\\epsilon + 2) - \\epsilon(e^{\\mathrm{i}\\theta_x} + e^{-\\mathrm{i}\\theta_x}) - (e^{\\mathrm{i}\\theta_y} + e^{-\\mathrm{i}\\theta_y}) \\right] $$\n$$ \\tilde{A}(\\theta_x, \\theta_y) = \\frac{1}{h^2} \\left[ 2\\epsilon(1 - \\cos(\\theta_x)) + 2(1 - \\cos(\\theta_y)) \\right] $$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们得到：\n$$ \\tilde{A}(\\theta_x, \\theta_y) = \\frac{4}{h^2} \\left[ \\epsilon \\sin^2(\\frac{\\theta_x}{2}) + \\sin^2(\\frac{\\theta_y}{2}) \\right] $$\n\n**光滑子块算子 $B$ 的符号**\n\n光滑子是 $y$ 方向上的加权线雅可比松弛。块算子 $B$ 定义为三对角的 $y$ 方向离散扩散加上 $x$ 方向的对角贡献。\n$y$ 方向项为 $-\\frac{\\partial^2 u}{\\partial y^2}$，离散化为 $\\frac{1}{h^2}[-u_{i,j-1} + 2u_{i,j} - u_{i,j+1}]$。\n$x$ 方向项为 $-\\epsilon \\frac{\\partial^2 u}{\\partial x^2}$，离散化为 $\\frac{\\epsilon}{h^2}[-u_{i-1,j} + 2u_{i,j} - u_{i+1,j}]$。该项的对角贡献为 $\\frac{2\\epsilon}{h^2}u_{i,j}$。\n因此，算子 $B$ 为：\n$$ (B u)_{i,j} = \\frac{1}{h^2} \\left[ -u_{i,j-1} + (2\\epsilon + 2)u_{i,j} - u_{i,j+1} \\right] $$\n符号 $\\tilde{B}(\\theta_x, \\theta_y)$ 通过将 $B$ 应用于相同的傅里叶模式得到。注意 $B$ 仅沿 $j$ 索引作用，因此其符号将仅依赖于 $\\theta_y$。\n$$ \\tilde{B}(\\theta_y) = \\frac{1}{h^2} \\left[ -e^{-\\mathrm{i}\\theta_y} + (2\\epsilon + 2) - e^{\\mathrm{i}\\theta_y} \\right] $$\n$$ \\tilde{B}(\\theta_y) = \\frac{1}{h^2} \\left[ 2\\epsilon + 2 - 2\\cos(\\theta_y) \\right] = \\frac{2}{h^2} \\left[ \\epsilon + 1 - \\cos(\\theta_y) \\right] $$\n$$ \\tilde{B}(\\theta_y) = \\frac{2}{h^2} \\left[ \\epsilon + 2\\sin^2(\\frac{\\theta_y}{2}) \\right] $$\n\n**光滑误差传播算子 $S$ 的符号**\n\n误差 $e$ 的光滑迭代为 $e^{(k+1)} = (I - \\omega B^{-1} A) e^{(k)}$。光滑算子是 $S = I - \\omega B^{-1} A$。\n其符号为 $\\tilde{S}(\\theta_x, \\theta_y) = 1 - \\omega \\frac{\\tilde{A}(\\theta_x, \\theta_y)}{\\tilde{B}(\\theta_y)}$。\n代入 $A$ 和 $B$ 的符号：\n$$ \\tilde{S}(\\theta_x, \\theta_y) = 1 - \\omega \\frac{\\frac{4}{h^2} \\left[ \\epsilon \\sin^2(\\frac{\\theta_x}{2}) + \\sin^2(\\frac{\\theta_y}{2}) \\right]}{\\frac{2}{h^2} \\left[ \\epsilon + 2\\sin^2(\\frac{\\theta_y}{2}) \\right]} $$\n这就是所求的光滑误差传播算子的符号：\n$$ \\tilde{S}(\\theta_x, \\theta_y) = 1 - \\omega \\frac{2 \\left( \\epsilon \\sin^2(\\frac{\\theta_x}{2}) + \\sin^2(\\frac{\\theta_y}{2}) \\right)}{\\epsilon + 2\\sin^2(\\frac{\\theta_y}{2})} $$\n\n**最优松弛参数和光滑因子**\n\n为了找到最优松弛参数 $\\omega_{opt}$，我们需要最小化光滑因子 $\\mu = \\max_{(\\theta_x, \\theta_y) \\in HF} |\\tilde{S}(\\theta_x, \\theta_y)|$。令 $s_x = \\sin^2(\\theta_x/2)$ 和 $s_y = \\sin^2(\\theta_y/2)$。$(\\theta_x, \\theta_y)$ 的域是 $(-\\pi, \\pi]^2$，所以 $s_x, s_y \\in [0, 1]$。高频(HF)集是 $|\\theta_x| \\ge \\pi/2$ 或 $|\\theta_y| \\ge \\pi/2$ 的地方，这转化为 $s_x \\ge \\sin^2(\\pi/4) = 1/2$ 或 $s_y \\ge 1/2$。\n需要分析的表达式是 $\\tilde{S} = 1 - \\omega Z$，其中 $Z(s_x, s_y) = \\frac{2(\\epsilon s_x + s_y)}{\\epsilon + 2s_y}$。\n我们必须在高频集上找到 $Z$ 的范围，即对于 $(s_x, s_y) \\in D_{HF} = ([1/2, 1] \\times [0, 1]) \\cup ([0, 1/2) \\times [1/2, 1])$。\n\n偏导数为：\n$$ \\frac{\\partial Z}{\\partial s_x} = \\frac{2\\epsilon}{\\epsilon + 2s_y} > 0 $$\n$$ \\frac{\\partial Z}{\\partial s_y} = \\frac{2(\\epsilon + 2s_y) - 2(\\epsilon s_x + s_y) \\cdot 2}{(\\epsilon + 2s_y)^2} = \\frac{2\\epsilon(1 - 2s_x)}{(\\epsilon + 2s_y)^2} $$\n$\\partial Z / \\partial s_y$ 的符号取决于 $s_x$。\n-   如果 $s_x  1/2$，则 $\\partial Z/\\partial s_y > 0$。\n-   如果 $s_x > 1/2$，则 $\\partial Z/\\partial s_y  0$。\n-   如果 $s_x = 1/2$，则 $\\partial Z/\\partial s_y = 0$。\n\n我们在高频域的边界上分析 $Z$ 的极值：\n1.  在集合 $s_x \\in [1/2, 1], s_y \\in [0,1]$ 上：\n    $\\partial Z/\\partial s_x > 0$ 且 $\\partial Z/\\partial s_y \\leq 0$。极值必须位于此矩形区域的边界上。\n    最大值位于 $s_x$ 最大且 $s_y$ 最小的点，即 $(s_x, s_y) = (1, 0)$。\n    $Z_{max} = Z(1, 0) = \\frac{2(\\epsilon \\cdot 1 + 0)}{\\epsilon + 0} = 2$。\n    最小值位于 $s_x$ 最小且 $s_y$ 最大的点，即 $(s_x, s_y) = (1/2, 1)$。\n    $Z(1/2, 1) = \\frac{2(\\epsilon/2 + 1)}{\\epsilon + 2} = \\frac{\\epsilon + 2}{\\epsilon + 2} = 1$。\n    此集合上的范围是 $[1, 2]$。\n\n2.  在集合 $s_x \\in [0, 1/2), s_y \\in [1/2, 1]$ 上：\n    $\\partial Z/\\partial s_x > 0$ 且 $\\partial Z/\\partial s_y > 0$。函数在两个变量上都是递增的。\n    最大值在 $(s_x, s_y) \\to (1/2, 1)$ 时趋近，此时 $Z \\to 1$。\n    最小值在 $(s_x, s_y) = (0, 1/2)$。\n    $Z_{min} = Z(0, 1/2) = \\frac{2(\\epsilon \\cdot 0 + 1/2)}{\\epsilon + 2(1/2)} = \\frac{1}{1 + \\epsilon}$。\n    此集合上的范围是 $[1/(1+\\epsilon), 1)$。\n\n结合两个区域，高频集上 $Z$ 的总范围是 $[Z_{min}, Z_{max}] = [1/(1+\\epsilon), 2]$。\n为了最小化 $\\max_Z |1 - \\omega Z|$，我们选择 $\\omega$ 使得放大因子在区间两端的幅值相等：\n$$ 1 - \\omega Z_{min} = -(1 - \\omega Z_{max}) $$\n$$ 2 = \\omega (Z_{min} + Z_{max}) $$\n这给出了最优松弛参数：\n$$ \\omega_{opt} = \\frac{2}{Z_{min} + Z_{max}} = \\frac{2}{\\frac{1}{1+\\epsilon} + 2} = \\frac{2(1+\\epsilon)}{1 + 2(1+\\epsilon)} = \\frac{2(1+\\epsilon)}{3+2\\epsilon} $$\n最小光滑因子 $\\mu_{opt}$ 是在端点处的放大率的幅值：\n$$ \\mu_{opt} = |1 - \\omega_{opt} Z_{max}| = \\left|1 - \\frac{2(1+\\epsilon)}{3+2\\epsilon} \\cdot 2\\right| = \\left|\\frac{3+2\\epsilon - 4(1+\\epsilon)}{3+2\\epsilon}\\right| = \\left|\\frac{-1-2\\epsilon}{3+2epsilon}\\right| = \\frac{1+2\\epsilon}{3+2\\epsilon} $$\n或者，\n$$ \\mu_{opt} = \\frac{Z_{max} - Z_{min}}{Z_{max} + Z_{min}} = \\frac{2 - \\frac{1}{1+\\epsilon}}{2 + \\frac{1}{1+\\epsilon}} = \\frac{2(1+\\epsilon) - 1}{2(1+\\epsilon) + 1} = \\frac{1+2\\epsilon}{3+2\\epsilon} $$\n\n**数值计算**\n\n给定 $\\epsilon = 10^{-3} = 0.001$。我们必须计算光滑因子 $\\mu_{opt}$。\n$$ \\mu_{opt} = \\frac{1 + 2(0.001)}{3 + 2(0.001)} = \\frac{1 + 0.002}{3 + 0.002} = \\frac{1.002}{3.002} $$\n$$ \\mu_{opt} \\approx 0.33377748167... $$\n四舍五入到四位有效数字，我们得到 $0.3338$。",
            "answer": "$$\\boxed{0.3338}$$"
        },
        {
            "introduction": "在实际的CFD应用中，物理边界通常与计算网格不完全重合，从而产生所谓的“切割单元”（cut-cells）。为了在这些复杂几何附近保持多重网格方法的稳定性和准确性，必须精心设计限制和延长算子。本练习模拟了在弯曲壁面附近处理切割单元的情景，要求您通过施加物理守恒定律和边界条件一致性来推导特定的延长算子系数 。",
            "id": "3977964",
            "problem": "考虑在计算流体动力学（CFD）中，对一个由拉普拉斯算子控制的定常、无粘势流模型进行几何多重网格处理。其中，标量势场用 $\\phi$ 表示，并满足 $\\nabla^{2}\\phi = 0$。在弯曲的固体边界附近，由于边界与网格相交，笛卡尔有限体积（FV）网格会产生一个切割单元。为了设计边界一致的多重网格传递算子，假设一个粗控制体有如下设置，该粗控制体聚合了两个沿局部壁面法向方向 $n$ 排列的细控制体：\n\n- 一个细控制体是切割单元，其面积分数为 $\\theta$，面积为 $V_{c} = \\theta\\,\\Delta x\\,\\Delta y$，中心距离边界的壁面法向距离为 $d_{c}$。\n- 另一个细控制体是完整的内部单元，其面积为 $V_{f} = \\Delta x\\,\\Delta y$，中心距离边界的壁面法向距离为 $d_{f}$。\n- 边界条件在弯曲壁面上是狄利克雷条件，因此修正场 $e(n)$ 在壁面上满足 $e(0) = 0$。\n- 多重网格的粗网格修正量 $e_{H}$ 的定义方式是，细网格修正量的体积加权限制等于粗网格修正量，并且延长操作应产生一个与狄利克雷边界条件一致的线性壁面法向剖面 $e(n)$。\n\n从有限体积的积分守恒声明和限制定义为体积加权平均出发，推导切割单元的边界一致延长系数，定义为 $w_{c} = e_{c}/e_{H}$，其中 $e_{c}$ 是切割单元中的细网格修正量。然后，对于 $\\Delta x = 1$ 米，$\\Delta y = 1$ 米，$\\theta = 0.3$，$d_{c} = 0.08$ 米，以及 $d_{f} = 0.58$ 米，计算 $w_{c}$。\n\n将最终系数表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "控制模型是拉普拉斯方程 $\\nabla^{2}\\phi=0$，在弯曲壁面上具有狄利克雷边界条件。在有限体积法的多重网格设置中，修正是通过限制和延长算子在网格之间传递的。为确保守恒性和边界一致性，我们使用：\n\n1. 有限体积积分守恒声明：粗网格修正量应代表聚合控制体积中细网格修正量的体积平均效应。\n\n2. 体积加权限制算子：如果 $e_{c}$ 和 $e_{f}$ 表示切割单元和完整细单元中的细网格修正量，而 $e_{H}$ 表示粗网格修正量，我们施加\n$$\ne_{H} = \\frac{V_{c}\\,e_{c} + V_{f}\\,e_{f}}{V_{c}+V_{f}}。\n$$\n\n3. 边界一致的延长：沿着壁面法向坐标 $n$，狄利克雷边界条件意味着修正量必须在壁面上为零，因此我们采用线性剖面\n$$\ne(n) = b\\,n,\n$$\n其中 $e(0)=0$，斜率为某个值 $b$。在细网格中心进行求值可得\n$$\ne_{c} = b\\,d_{c}, \\quad e_{f} = b\\,d_{f}。\n$$\n\n将这些代入限制的定义中可得\n$$\ne_{H} = \\frac{V_{c}\\,(b\\,d_{c}) + V_{f}\\,(b\\,d_{f})}{V_{c}+V_{f}} = b\\,\\frac{V_{c}\\,d_{c} + V_{f}\\,d_{f}}{V_{c}+V_{f}}。\n$$\n将粗网格修正量的体积加权壁面法向位置定义为\n$$\n\\bar{n} \\equiv \\frac{V_{c}\\,d_{c} + V_{f}\\,d_{f}}{V_{c}+V_{f}}。\n$$\n那么\n$$\ne_{H} = b\\,\\bar{n} \\quad \\Rightarrow \\quad b = \\frac{e_{H}}{\\bar{n}}。\n$$\n因此，切割单元的延长系数为\n$$\nw_{c} = \\frac{e_{c}}{e_{H}} = \\frac{b\\,d_{c}}{e_{H}} = \\frac{d_{c}}{\\bar{n}} = d_{c}\\,\\frac{V_{c}+V_{f}}{V_{c}\\,d_{c} + V_{f}\\,d_{f}}。\n$$\n这一选择同时强制施加了壁面狄利克雷条件 ($e(0)=0$)、沿壁面法向的线性一致性以及聚合粗控制体的体积加权限制恒等式，这对于几何多重网格中常见循环类型（例如，V循环和W循环）内稳定的粗网格修正是至关重要的。\n\n现在根据给定的几何形状计算 $w_{c}$。面积为\n$$\n\\Delta x = 1,\\quad \\Delta y = 1,\\quad V_{f} = \\Delta x\\,\\Delta y = 1,\\quad \\theta = 0.3,\\quad V_{c} = \\theta\\,\\Delta x\\,\\Delta y = 0.3.\n$$\n壁面法向距离为\n$$\nd_{c} = 0.08,\\quad d_{f} = 0.58.\n$$\n计算 $\\bar{n}$：\n$$\n\\bar{n} = \\frac{V_{c}\\,d_{c} + V_{f}\\,d_{f}}{V_{c}+V_{f}} = \\frac{0.3\\cdot 0.08 + 1\\cdot 0.58}{0.3 + 1} = \\frac{0.024 + 0.58}{1.3} = \\frac{0.604}{1.3}。\n$$\n为求精确，注意 $\\bar{n} = \\frac{604}{1300} = \\frac{151}{325}$。那么\n$$\nw_{c} = \\frac{d_{c}}{\\bar{n}} = \\frac{0.08}{151/325} = \\frac{2/25}{151/325} = \\frac{2}{25} \\cdot \\frac{325}{151} = \\frac{2 \\cdot 13}{151} = \\frac{26}{151}。\n$$\n最后计算结果并四舍五入到四位有效数字：\n$$\n\\frac{26}{151} \\approx 0.172185\\ldots \\quad \\Rightarrow \\quad w_{c} \\approx 0.1722.\n$$\n该系数按要求是无量纲的。",
            "answer": "$$\\boxed{0.1722}$$"
        }
    ]
}