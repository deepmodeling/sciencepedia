{
    "hands_on_practices": [
        {
            "introduction": "求解线性系统的直接法通常始于 LU 分解这一基本概念。该过程等同于高斯消元法，它将一个矩阵分解为一个下三角矩阵 ($L$) 和一个上三角矩阵 ($U$)，从而将一个复杂问题转化为两个更简单的三角系统求解问题。本练习  将针对一个计算流体力学中常见的矩阵，提供这一基本技术的实践操作，为理解更高级的求解器奠定核心技能。",
            "id": "3954243",
            "problem": "考虑一个源于航空航天计算流体动力学（CFD）代码中一维稳态扩散平衡的线性系统，该系统在均匀网格上使用二阶中心差分格式进行离散化。对于三个内部控制体，其最终的系数矩阵具有如下的对称三对角形式：\n$$\nA \\;=\\; \\begin{bmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{bmatrix}.\n$$\n从扩散通量守恒和标准离散化原理出发，得到的矩阵 $A$ 是严格对角占优且对称正定的。请使用基于不含主元选择的高斯消去法的直接方法，构建将 $A$ 分解为一个单位下三角矩阵 $L$ 和一个上三角矩阵 $U$ （满足 $A = L\\,U$）所需的显式前向消元步骤。写出每一步使用的消元乘子以及最终的矩阵 $L$ 和 $U$。然后，利用三角分解，通过 $U$ 的对角线元素之积来确定 $A$ 的行列式。将最终的行列式表示为一个无舍入的精确实数。",
            "solution": "该问题陈述经验证具有科学依据，是适定的、客观且内部一致的。这是一个数值线性代数中的标准练习，具体是应用高斯消去法对给定矩阵进行 $LU$ 分解。所提供的将矩阵与CFD中的有限差分法离散化相关联的背景是准确的，并增加了相关的物理动机。没有任何缺陷会使问题无效。因此，我们可以着手求解。\n\n任务是找到矩阵 $A$ 的 $LU$ 分解，使得 $A=LU$，其中 $L$ 是一个单位下三角矩阵， $U$ 是一个上三角矩阵。这种分解是通过高斯消去过程实现的。矩阵 $A$ 由下式给出：\n$$\nA \\;=\\; \\begin{bmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{bmatrix}\n$$\n高斯消去过程旨在通过应用一系列初等行变换将 $A$ 转换为一个上三角矩阵 $U$。\n\n**第1步：第一列的消元**\n\n我们要消除第一个主元 $a_{11} = 2$ 下方的非零项。要被消除的项是 $a_{21} = -1$。这一步的乘子，记作 $m_{21}$，是待消元项与主元之比：\n$$\nm_{21} = \\frac{a_{21}}{a_{11}} = \\frac{-1}{2}\n$$\n相应的行操作是 $R_2 \\leftarrow R_2 - m_{21} R_1$。将此操作应用于矩阵 $A$：\n$$\nR_2 - \\left(-\\frac{1}{2}\\right) R_1 = [-1, 2, -1] - \\left(-\\frac{1}{2}\\right) [2, -1, 0] = [-1, 2, -1] + [1, -\\frac{1}{2}, 0] = [0, \\frac{3}{2}, -1]\n$$\n项 $a_{31}$ 已经是 $0$，因此该列的第三行无需操作。乘子为 $m_{31}=0$。此步骤后的矩阵为：\n$$\nA^{(1)} \\;=\\; \\begin{bmatrix}\n2  -1  0 \\\\\n0  \\frac{3}{2}  -1 \\\\\n0  -1  2\n\\end{bmatrix}\n$$\n\n**第2步：第二列的消元**\n\n现在我们处理第二列。主元是新的对角项 $a'_{22} = \\frac{3}{2}$。我们必须消除其下方的项，即 $a'_{32} = -1$。这一步的乘子 $m_{32}$ 是：\n$$\nm_{32} = \\frac{a'_{32}}{a'_{22}} = \\frac{-1}{3/2} = -\\frac{2}{3}\n$$\n相应的行操作是 $R_3 \\leftarrow R_3 - m_{32} R_2$。将此操作应用于矩阵的当前状态 $A^{(1)}$：\n$$\nR_3 - \\left(-\\frac{2}{3}\\right) R_2 = [0, -1, 2] - \\left(-\\frac{2}{3}\\right) [0, \\frac{3}{2}, -1] = [0, -1, 2] + [0, 1, -\\frac{2}{3}] = [0, 0, 2 - \\frac{2}{3}] = [0, 0, \\frac{4}{3}]\n$$\n消元过程现已完成。得到的上三角矩阵 $U$ 是：\n$$\nU \\;=\\; \\begin{bmatrix}\n2  -1  0 \\\\\n0  \\frac{3}{2}  -1 \\\\\n0  0  \\frac{4}{3}\n\\end{bmatrix}\n$$\n\n**构造L和U矩阵**\n\n上三角矩阵 $U$ 是前向消元的结果。单位下三角矩阵 $L$ 是通过将乘子 $m_{ij}$ 放置在相应的下三角位置来构造的：\n$$\nL \\;=\\; \\begin{bmatrix}\n1  0  0 \\\\\nm_{21}  1  0 \\\\\nm_{31}  m_{32}  1\n\\end{bmatrix}\n$$\n代入计算出的乘子值：\n$$\nL \\;=\\; \\begin{bmatrix}\n1  0  0 \\\\\n-\\frac{1}{2}  1  0 \\\\\n0  -\\frac{2}{3}  1\n\\end{bmatrix}\n$$\n消元乘子为 $m_{21} = -\\frac{1}{2}$ 和 $m_{32} = -\\frac{2}{3}$。\n\n**行列式计算**\n\n$A$ 的行列式可以从分解式 $A = LU$ 计算得出。使用矩阵乘积的行列式等于行列式的乘积这一性质，我们有 $\\det(A) = \\det(L)\\det(U)$。\n三角矩阵的行列式是其对角线元素的乘积。\n对于单位下三角矩阵 $L$，对角线元素均为 $1$，因此其行列式为：\n$$\n\\det(L) = 1 \\cdot 1 \\cdot 1 = 1\n$$\n对于上三角矩阵 $U$，其行列式为：\n$$\n\\det(U) = u_{11} \\cdot u_{22} \\cdot u_{33} = 2 \\cdot \\frac{3}{2} \\cdot \\frac{4}{3}\n$$\n进行乘法运算：\n$$\n\\det(U) = (2 \\cdot \\frac{3}{2}) \\cdot \\frac{4}{3} = 3 \\cdot \\frac{4}{3} = 4\n$$\n因此，$A$ 的行列式是：\n$$\n\\det(A) = \\det(L)\\det(U) = 1 \\cdot 4 = 4\n$$\n$A$ 的行列式恰好为 $4$。",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "虽然 LU 分解是一种通用工具，但我们可以通过利用矩阵的特殊性质来获得更高的效率。对于物理模拟（如压力泊松方程）中经常出现的对称正定 (SPD) 矩阵，Cholesky 分解是首选方法。本实践问题  演示了如何构造 Cholesky 因子 $L$ (其中 $A = LL^{\\top}$) 并用它来求解线性系统，展示了一种对于此类问题比标准 LU 分解更快且数值更稳定的方法。",
            "id": "3954300",
            "problem": "在计算流体动力学 (CFD) 中，用于不可压缩流的压力投影法中，在均匀一维网格上带有狄利克雷压力边界条件的离散压力泊松方程会导出一个对称正定线性系统。考虑表示 3 个内部单元上压力修正的系统 $A x = b$，其中\n$$\nA \\;=\\; \\begin{bmatrix}\n4  -1  0 \\\\\n-1  4  -1 \\\\\n0  -1  4\n\\end{bmatrix}, \n\\qquad\nb \\;=\\; \\begin{bmatrix}\n1 \\\\ 2 \\\\ 1\n\\end{bmatrix}.\n$$\n从离散拉普拉斯算子与狄利克雷边界条件产生对称正定矩阵，且此类矩阵允许具有正对角元的唯一 Cholesky 分解这一事实出发，通过逐项强制执行定义关系 $A = L L^{\\top}$ 来构造 $A$ 的 Cholesky 因子 $L$，然后使用前向和后向替换法求解 $x$。将最终的 $x$ 表示为无舍入的精确值，并以包含精确有理数或根式量且无单位的单行向量形式报告您的答案。",
            "solution": "问题陈述经评估有效。它提出了一个适定的数值线性代数问题，其背景是计算流体动力学 (CFD)。所提供的矩阵 $A$ 是一个经典的对称正定 (SPD) 矩阵，它源于拉普拉斯算子的有限差分法离散化，对于这类矩阵，Cholesky 分解是一种标准且稳定的求解方法。所有必要的数据（$A$，$b$）都已提供，任务定义清晰且数学上合理。\n\n问题是求解线性系统 $A x = b$，其中\n$$\nA \\;=\\; \\begin{bmatrix}\n4  -1  0 \\\\\n-1  4  -1 \\\\\n0  -1  4\n\\end{bmatrix}, \n\\qquad\nx \\;=\\; \\begin{bmatrix}\nx_1 \\\\ x_2 \\\\ x_3\n\\end{bmatrix},\n\\qquad\nb \\;=\\; \\begin{bmatrix}\n1 \\\\ 2 \\\\ 1\n\\end{bmatrix}.\n$$\n要使用的方法是 Cholesky 分解。由于已知 $A$ 是对称正定的，它允许形式为 $A = L L^{\\top}$ 的唯一分解，其中 $L$ 是一个对角线元素为正的下三角矩阵。\n\n首先，我们构造 Cholesky 因子 $L$。设 $L$ 的形式为：\n$$\nL \\;=\\; \\begin{bmatrix}\nl_{11}  0  0 \\\\\nl_{21}  l_{22}  0 \\\\\nl_{31}  l_{32}  l_{33}\n\\end{bmatrix}\n$$\n那么乘积 $L L^{\\top}$ 为：\n$$\nL L^{\\top} \\;=\\; \\begin{bmatrix}\nl_{11}  0  0 \\\\\nl_{21}  l_{22}  0 \\\\\nl_{31}  l_{32}  l_{33}\n\\end{bmatrix}\n\\begin{bmatrix}\nl_{11}  l_{21}  l_{31} \\\\\n0  l_{22}  l_{32} \\\\\n0  0  l_{33}\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\nl_{11}^{2}  & l_{11}l_{21}  & l_{11}l_{31} \\\\\nl_{21}l_{11}  & l_{21}^{2} + l_{22}^{2}  & l_{21}l_{31} + l_{22}l_{32} \\\\\nl_{31}l_{11}  & l_{31}l_{21} + l_{32}l_{22}  & l_{31}^{2} + l_{32}^{2} + l_{33}^{2}\n\\end{bmatrix}\n$$\n通过将 $L L^{\\top}$ 的各项与 $A$ 的各项相等，我们可以依次求解元素 $l_{ij}$。\n\n对于第一列 ($j=1$):\n- $a_{11} = l_{11}^{2} = 4 \\implies l_{11} = \\sqrt{4} = 2$ (因为 $l_{ii} > 0$)。\n- $a_{21} = l_{21}l_{11} = -1 \\implies l_{21}(2) = -1 \\implies l_{21} = -\\frac{1}{2}$。\n- $a_{31} = l_{31}l_{11} = 0 \\implies l_{31}(2) = 0 \\implies l_{31} = 0$。\n\n对于第二列 ($j=2$):\n- $a_{22} = l_{21}^{2} + l_{22}^{2} = 4 \\implies \\left(-\\frac{1}{2}\\right)^2 + l_{22}^{2} = 4 \\implies \\frac{1}{4} + l_{22}^{2} = 4 \\implies l_{22}^{2} = 4 - \\frac{1}{4} = \\frac{15}{4}$。\n因为 $l_{22} > 0$，我们有 $l_{22} = \\sqrt{\\frac{15}{4}} = \\frac{\\sqrt{15}}{2}$。\n- $a_{32} = l_{31}l_{21} + l_{32}l_{22} = -1 \\implies (0)(-\\frac{1}{2}) + l_{32}\\left(\\frac{\\sqrt{15}}{2}\\right) = -1 \\implies l_{32} = -\\frac{2}{\\sqrt{15}} = -\\frac{2\\sqrt{15}}{15}$。\n\n对于第三列 ($j=3$):\n- $a_{33} = l_{31}^{2} + l_{32}^{2} + l_{33}^{2} = 4 \\implies (0)^2 + \\left(-\\frac{2}{\\sqrt{15}}\\right)^2 + l_{33}^{2} = 4 \\implies \\frac{4}{15} + l_{33}^{2} = 4 \\implies l_{33}^{2} = 4 - \\frac{4}{15} = \\frac{60-4}{15} = \\frac{56}{15}$。\n因为 $l_{33} > 0$，我们有 $l_{33} = \\sqrt{\\frac{56}{15}} = \\frac{\\sqrt{56}}{\\sqrt{15}} = \\frac{2\\sqrt{14}}{\\sqrt{15}} = \\frac{2\\sqrt{210}}{15}$。\n\n因此，Cholesky 因子 $L$ 为：\n$$\nL \\;=\\; \\begin{bmatrix}\n2  & 0  & 0 \\\\\n-\\frac{1}{2}  & \\frac{\\sqrt{15}}{2}  & 0 \\\\\n0  & -\\frac{2}{\\sqrt{15}}  & \\sqrt{\\frac{56}{15}}\n\\end{bmatrix}\n$$\n\n原始系统 $A x = b$ 可以重写为 $L L^{\\top} x = b$。我们分两步求解。首先，令 $y = L^{\\top} x$，并使用前向替换法求解下三角系统 $L y = b$。\n$$\n\\begin{bmatrix}\n2  & 0  & 0 \\\\\n-\\frac{1}{2}  & \\frac{\\sqrt{15}}{2}  & 0 \\\\\n0  & -\\frac{2}{\\sqrt{15}}  & \\sqrt{\\frac{56}{15}}\n\\end{bmatrix}\n\\begin{bmatrix}\ny_1 \\\\ y_2 \\\\ y_3\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\n1 \\\\ 2 \\\\ 1\n\\end{bmatrix}\n$$\n- 从第一行：$2y_1 = 1 \\implies y_1 = \\frac{1}{2}$。\n- 从第二行：$-\\frac{1}{2}y_1 + \\frac{\\sqrt{15}}{2}y_2 = 2 \\implies -\\frac{1}{2}\\left(\\frac{1}{2}\\right) + \\frac{\\sqrt{15}}{2}y_2 = 2 \\implies -\\frac{1}{4} + \\frac{\\sqrt{15}}{2}y_2 = 2$。\n这得到 $\\frac{\\sqrt{15}}{2}y_2 = 2 + \\frac{1}{4} = \\frac{9}{4}$，所以 $y_2 = \\frac{9}{4} \\cdot \\frac{2}{\\sqrt{15}} = \\frac{9}{2\\sqrt{15}} = \\frac{9\\sqrt{15}}{30} = \\frac{3\\sqrt{15}}{10}$。\n- 从第三行：$-\\frac{2}{\\sqrt{15}}y_2 + \\sqrt{\\frac{56}{15}}y_3 = 1 \\implies -\\frac{2}{\\sqrt{15}}\\left(\\frac{9}{2\\sqrt{15}}\\right) + \\sqrt{\\frac{56}{15}}y_3 = 1 \\implies -\\frac{9}{15} + \\sqrt{\\frac{56}{15}}y_3 = 1$。\n这得到 $\\sqrt{\\frac{56}{15}}y_3 = 1 + \\frac{9}{15} = 1 + \\frac{3}{5} = \\frac{8}{5}$，所以 $y_3 = \\frac{8}{5} \\sqrt{\\frac{15}{56}} = \\frac{8}{5} \\frac{\\sqrt{15}}{2\\sqrt{14}} = \\frac{4\\sqrt{15}}{5\\sqrt{14}} = \\frac{4\\sqrt{210}}{70} = \\frac{2\\sqrt{210}}{35}$。\n\n接下来，我们使用后向替换法对上三角系统 $L^{\\top} x = y$ 求解 $x$。\n$$\n\\begin{bmatrix}\n2  & -\\frac{1}{2}  & 0 \\\\\n0  & \\frac{\\sqrt{15}}{2}  & -\\frac{2}{\\sqrt{15}} \\\\\n0  & 0  & \\sqrt{\\frac{56}{15}}\n\\end{bmatrix}\n\\begin{bmatrix}\nx_1 \\\\ x_2 \\\\ x_3\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\n\\frac{1}{2} \\\\\n\\frac{9}{2\\sqrt{15}} \\\\\n\\frac{8}{5}\\sqrt{\\frac{15}{56}}\n\\end{bmatrix}\n$$\n- 从第三行：$\\sqrt{\\frac{56}{15}}x_3 = y_3 = \\frac{8}{5}\\sqrt{\\frac{15}{56}}$。\n$x_3 = \\frac{y_3}{\\sqrt{56/15}} = \\frac{8/5 \\cdot \\sqrt{15/56}}{\\sqrt{56/15}} = \\frac{8}{5} \\frac{15}{56} = \\frac{8 \\cdot 3 \\cdot 5}{5 \\cdot 7 \\cdot 8} = \\frac{3}{7}$。\n- 从第二行：$\\frac{\\sqrt{15}}{2}x_2 - \\frac{2}{\\sqrt{15}}x_3 = y_2 = \\frac{9}{2\\sqrt{15}}$。\n$\\frac{\\sqrt{15}}{2}x_2 = \\frac{9}{2\\sqrt{15}} + \\frac{2}{\\sqrt{15}}x_3 = \\frac{9}{2\\sqrt{15}} + \\frac{2}{\\sqrt{15}}\\left(\\frac{3}{7}\\right) = \\frac{9}{2\\sqrt{15}} + \\frac{6}{7\\sqrt{15}}$。\n$\\frac{\\sqrt{15}}{2}x_2 = \\frac{1}{\\sqrt{15}}\\left(\\frac{9}{2} + \\frac{6}{7}\\right) = \\frac{1}{\\sqrt{15}}\\left(\\frac{63+12}{14}\\right) = \\frac{75}{14\\sqrt{15}}$。\n$x_2 = \\frac{2}{\\sqrt{15}} \\cdot \\frac{75}{14\\sqrt{15}} = \\frac{150}{14 \\cdot 15} = \\frac{10}{14} = \\frac{5}{7}$。\n- 从第一行：$2x_1 - \\frac{1}{2}x_2 = y_1 = \\frac{1}{2}$。\n$2x_1 = \\frac{1}{2} + \\frac{1}{2}x_2 = \\frac{1}{2} + \\frac{1}{2}\\left(\\frac{5}{7}\\right) = \\frac{1}{2} + \\frac{5}{14} = \\frac{7}{14} + \\frac{5}{14} = \\frac{12}{14} = \\frac{6}{7}$。\n$x_1 = \\frac{1}{2} \\cdot \\frac{6}{7} = \\frac{3}{7}$。\n\n因此，解向量为 $x = \\begin{bmatrix} 3/7 \\\\ 5/7 \\\\ 3/7 \\end{bmatrix}$。以精确有理数值表示，此为最终答案。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{7} & \\frac{5}{7} & \\frac{3}{7} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "对效率的追求通过关注矩阵结构，特别是稀疏性，得以延续。航空航天 CFD 中的许多问题，例如一维扩散模型，会产生三对角线性系统。托马斯算法 (Thomas algorithm) 是一种为这些系统量身定制的、计算成本极低的专用直接求解器。本练习  提供了一个应用这种强大算法的机会，说明了识别和利用矩阵的特定稀疏模式如何带来显著的计算节省。",
            "id": "3954251",
            "problem": "考虑在静止介质中具有恒定扩散系数的被动标量的稳态一维扩散，这是在高超声速飞行器的热防护系统薄板中进行流向热扩散的典型模型，在计算流体力学 (CFD) 的框架内进行分析。控制方程为具有恒定扩散系数的稳态扩散方程，其无量纲形式简化为拉普拉斯方程 $-\\frac{d^{2}\\phi}{dx^{2}} = 0$，并受两端狄利克雷边界条件的约束。在一个具有 $4$ 个内部节点的均匀网格上，并在两个边界上指定狄利克雷边界值，对每个内部节点的二阶导数应用标准的二阶中心差分近似，会得到一个形式为 $A \\, x = b$ 的线性系统，其中 $A$ 是一个具有严格对角占优结构的三对角矩阵。经过无量纲化并将边界数据并入右侧项后，待求解的系统为\n$$\nA \\, x = b, \\quad\nA = \\begin{bmatrix}\n2  -1  0  0 \\\\\n-1  2  -1  0 \\\\\n0  -1  2  -1 \\\\\n0  0  -1  2\n\\end{bmatrix}, \\quad\nb = \\begin{bmatrix}\n1 \\\\\n0 \\\\\n0 \\\\\n1\n\\end{bmatrix},\n$$\n其中 $x \\in \\mathbb{R}^{4}$ 包含离散标量场的未知节点值。使用三对角直接求解器（Thomas 算法），精确计算解向量 $x$。将您的最终答案表示为一个使用 $\\text{pmatrix}$ 格式的单行向量，无单位且不进行四舍五入。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤1：提取已知条件\n问题要求解线性方程组 $A x = b$ 以求得未知向量 $x$。\n矩阵 $A$ 如下所示：\n$$\nA = \\begin{bmatrix}\n2  -1  0  0 \\\\\n-1  2  -1  0 \\\\\n0  -1  2  -1 \\\\\n0  0  -1  2\n\\end{bmatrix}\n$$\n右侧向量 $b$ 如下所示：\n$$\nb = \\begin{bmatrix}\n1 \\\\\n0 \\\\\n0 \\\\\n1\n\\end{bmatrix}\n$$\n未知向量为 $x \\in \\mathbb{R}^{4}$。\n问题指定使用三对角直接求解器，即 Thomas 算法。其背景是在一个有4个内部节点的均匀网格上，对一维稳态扩散方程 $-\\frac{d^{2}\\phi}{dx^{2}} = 0$ 进行数值求解。\n\n### 步骤2：使用提取的已知条件进行验证\n根据已建立的验证标准对问题进行评估。\n- **科学依据**：该问题基于有限差分法，这是数值分析和计算流体力学 (CFD) 中求解微分方程的一种标准和基础技术。使用二阶中心差分格式对一维拉普拉斯方程进行离散化，正确地得到了指定形式的三对角系统。矩阵 $A$ 是由此类离散化产生的 Kac-Murdock-Szegö-Toeplitz 矩阵的一个经典例子。该问题是一个标准的教科书练习题，在科学上和数学上都是合理的。\n- **适定性**：矩阵 $A$ 是对称且严格对角占优的（每个对角元素的绝对值大于其所在行非对角元素绝对值之和）。严格对角占优矩阵保证是非奇异的，这确保了系统 $A x = b$ 有唯一解。因此，该问题是适定的。\n- **客观性**：该问题以精确的数学术语陈述，提供了所有必要的组成部分（$A$, $b$）并要求一个特定的计算结果。它没有歧义或主观论断。\n- **完整性和一致性**：该问题是自洽的。它提供了矩阵 $A$ 和向量 $b$ 的完整定义，这些是求得向量 $x$ 所需的全部信息。没有缺失或矛盾的信息。\n- **其他缺陷**：该问题没有表现出任何其他缺陷，如不切实际、结构不良、琐碎或无法验证。所提供的物理背景是合理的，并直接导出了该数学公式。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供一个解答。\n\n### 解答\n任务是求解线性系统 $A x = b$，其中 $A$ 是一个三对角矩阵。指定的方法是 Thomas 算法，也称为三对角矩阵算法 (Tridiagonal Matrix Algorithm, TDMA)。该算法是高斯消元法的一种特殊形式，对三对角系统非常高效。\n\n该方程组为：\n$$\n\\begin{bmatrix}\n2  -1  0  0 \\\\\n-1  2  -1  0 \\\\\n0  -1  2  -1 \\\\\n0  0  -1  2\n\\end{bmatrix}\n\\begin{bmatrix}\nx_1 \\\\\nx_2 \\\\\nx_3 \\\\\nx_4\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n1 \\\\\n0 \\\\\n0 \\\\\n1\n\\end{bmatrix}\n$$\n这对应于以下四个线性方程：\n$2x_1 - x_2 = 1$\n$-x_1 + 2x_2 - x_3 = 0$\n$-x_2 + 2x_3 - x_4 = 0$\n$-x_3 + 2x_4 = 1$\n\nThomas 算法包括两个阶段：一个前向消元过程和一个回代过程。\n\n**阶段1：前向消元**\n在此阶段，系统被转化为一个上三角系统。对于一个一般的三对角系统 $a_i x_{i-1} + b_i x_i + c_i x_{i+1} = d_i$，我们修改其系数。\n我们问题的系数是：\n对角元素：$b = [2, 2, 2, 2]^T$\n上对角元素：$c = [-1, -1, -1]^T$\n下对角元素：$a = [-1, -1, -1]^T$\n右侧项：$d = [1, 0, 0, 1]^T$\n\n该算法将系统转化为 $x_i + c'_i x_{i+1} = d'_i$ 形式（对于 $i=1, 2, 3$）以及 $x_4 = d'_4$。\n过程如下：\n\n对于 $i=1$：\n第一个方程是 $2x_1 - x_2 = 1$。我们除以对角元素 $b_1 = 2$。\n$x_1 - \\frac{1}{2}x_2 = \\frac{1}{2}$。\n因此，新系数为 $c'_1 = -\\frac{1}{2}$ 和 $d'_1 = \\frac{1}{2}$。\n\n对于 $i=2$：\n第二个方程是 $-x_1 + 2x_2 - x_3 = 0$。\n根据修改后的第一个方程，我们有 $x_1 = \\frac{1}{2} + \\frac{1}{2}x_2$。将其代入第二个方程：\n$-(\\frac{1}{2} + \\frac{1}{2}x_2) + 2x_2 - x_3 = 0$\n$-\\frac{1}{2} - \\frac{1}{2}x_2 + 2x_2 - x_3 = 0$\n$\\frac{3}{2}x_2 - x_3 = \\frac{1}{2}$\n除以新的对角元素 $\\frac{3}{2}$：\n$x_2 - \\frac{2}{3}x_3 = \\frac{1}{3}$。\n所以，$c'_2 = -\\frac{2}{3}$ 且 $d'_2 = \\frac{1}{3}$。\n\n对于 $i=3$：\n第三个方程是 $-x_2 + 2x_3 - x_4 = 0$。\n根据修改后的第二个方程，$x_2 = \\frac{1}{3} + \\frac{2}{3}x_3$。代入：\n$-(\\frac{1}{3} + \\frac{2}{3}x_3) + 2x_3 - x_4 = 0$\n$-\\frac{1}{3} - \\frac{2}{3}x_3 + 2x_3 - x_4 = 0$\n$\\frac{4}{3}x_3 - x_4 = \\frac{1}{3}$\n除以 $\\frac{4}{3}$：\n$x_3 - \\frac{3}{4}x_4 = \\frac{1}{4}$。\n所以，$c'_3 = -\\frac{3}{4}$ 且 $d'_3 = \\frac{1}{4}$。\n\n对于 $i=4$：\n第四个方程是 $-x_3 + 2x_4 = 1$。\n根据修改后的第三个方程，$x_3 = \\frac{1}{4} + \\frac{3}{4}x_4$。代入：\n$-(\\frac{1}{4} + \\frac{3}{4}x_4) + 2x_4 = 1$\n$-\\frac{1}{4} - \\frac{3}{4}x_4 + 2x_4 = 1$\n$\\frac{5}{4}x_4 = \\frac{5}{4}$\n除以 $\\frac{5}{4}$：\n$x_4 = 1$。\n所以，$d'_4 = 1$。\n\n前向消元得到上三角系统：\n$x_1 - \\frac{1}{2}x_2 = \\frac{1}{2}$\n$x_2 - \\frac{2}{3}x_3 = \\frac{1}{3}$\n$x_3 - \\frac{3}{4}x_4 = \\frac{1}{4}$\n$x_4 = 1$\n\n**阶段2：回代**\n现在我们从最后一个方程开始，向后求解 $x_i$。\n从最后一个方程，我们得到：\n$x_4 = 1$\n\n将 $x_4=1$ 代入第三个方程：\n$x_3 = \\frac{1}{4} + \\frac{3}{4}x_4 = \\frac{1}{4} + \\frac{3}{4}(1) = \\frac{4}{4} = 1$\n\n将 $x_3=1$ 代入第二个方程：\n$x_2 = \\frac{1}{3} + \\frac{2}{3}x_3 = \\frac{1}{3} + \\frac{2}{3}(1) = \\frac{3}{3} = 1$\n\n将 $x_2=1$ 代入第一个方程：\n$x_1 = \\frac{1}{2} + \\frac{1}{2}x_2 = \\frac{1}{2} + \\frac{1}{2}(1) = \\frac{2}{2} = 1$\n\n解向量为 $x = [x_1, x_2, x_3, x_4]^T = [1, 1, 1, 1]^T$。\n\n**验证**\n我们可以通过将解代回原方程 $Ax=b$ 来进行验证：\n$$\nA x = \\begin{bmatrix}\n2  -1  0  0 \\\\\n-1  2  -1  0 \\\\\n0  -1  2  -1 \\\\\n0  0  -1  2\n\\end{bmatrix}\n\\begin{bmatrix}\n1 \\\\\n1 \\\\\n1 \\\\\n1\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n2(1) - 1(1) \\\\\n-1(1) + 2(1) - 1(1) \\\\\n-1(1) + 2(1) - 1(1) \\\\\n-1(1) + 2(1)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n1 \\\\\n0 \\\\\n0 \\\\\n1\n\\end{bmatrix} = b\n$$\n结果正确。该解对应于一个常数标量场 $\\phi(x)=1$，这是边界条件为 $\\phi(\\text{left})=1$ 和 $\\phi(\\text{right})=1$ 的连续问题 $-\\frac{d^2\\phi}{dx^2}=0$ 的精确解析解。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1 & 1 & 1\n\\end{pmatrix}\n}\n$$"
        }
    ]
}