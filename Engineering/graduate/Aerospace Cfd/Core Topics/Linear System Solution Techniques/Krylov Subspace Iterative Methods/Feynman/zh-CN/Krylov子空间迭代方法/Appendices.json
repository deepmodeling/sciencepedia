{
    "hands_on_practices": [
        {
            "introduction": "像广义最小残差方法（GMRES）这类克雷洛夫子空间方法的收敛行为，与系统矩阵的性质密切相关，特别是其非正规性。第一个实践练习旨在建立流体动力学模型的物理特性与其离散形式的代数性质之间的具体联系。通过为对流扩散问题（计算流体力学中的一个基石模型）构建矩阵，并显式计算其非正规性，你将亲身体验到数值格式选择（如迎风格式）是如何引入那些高级迭代求解器旨在克服的挑战的。",
            "id": "3970343",
            "problem": "考虑在域 $[0,1]$ 上的稳态一维对流扩散算子 $L u = a \\, \\frac{d u}{d x} - \\nu \\, \\frac{d^{2} u}{d x^{2}}$，其边界条件为齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。在航空航天应用的计算流体动力学中，通过在均匀网格上使用有限差分法，从 $L$ 得到离散线性系统 $A \\mathbf{u} = \\mathbf{f}$。为了模拟实践中使用的典型稳定化方法，通过增加人工扩散 $\\nu_{\\text{art}}=\\gamma \\, a \\, h$ 来增强物理扩散系数 $\\nu$，其中 $a>0$ 是对流速度，$h$ 是均匀网格间距，$\\gamma \\geq 0$ 是一个稳定化参数。\n\n使用 $N=4$ 个内部网格点，因此 $h = \\frac{1}{N+1}$。在内部节点 $i$ 处，使用对 $a>0$ 有效的一阶迎风差分（即 $\\frac{u_{i} - u_{i-1}}{h}$）来离散化对流项 $a \\, \\frac{d u}{d x}$，并使用中心二阶差分 $\\frac{u_{i+1}-2 u_i + u_{i-1}}{h^{2}}$ 来离散化扩散项 $-\\nu \\, \\frac{d^{2} u}{d x^{2}}$。在离散扩散项中，通过将 $\\nu$ 替换为总扩散 $\\nu_{\\text{tot}} = \\nu + \\nu_{\\text{art}}$ 来引入稳定化。假设为齐次狄利克雷边界条件，因此任何涉及 $u_{0}$ 或 $u_{N+1}$ 的模板项都将从矩阵 $A$ 中消失，并且不贡献未知数。\n\n在航空航天计算流体动力学中，用于大规模系统的先进迭代求解器通常采用Krylov子空间方法，例如广义最小残差（GMRES）方法，其收敛行为对算子的非正规性很敏感。量化非正规性的一种方法是弗罗贝尼乌斯范数下的非正规性偏离度，由 $\\delta(A) = \\|A^{\\top} A - A A^{\\top}\\|_{F}$ 给出，其中 $\\|\\cdot\\|_{F}$ 表示Frobenius范数，$A^{\\top}$ 表示转置。\n\n使用 $a=3$，$\\nu=0.01$ 和 $\\gamma=0.5$，构建矩阵 $A$ 并计算 $\\delta(A)$ 的值。将您的最终答案四舍五入到四位有效数字，并表示为一个无量纲数。",
            "solution": "## 问题验证\n\n### 步骤1：提取已知条件\n- **算子**: $L u = a \\, \\frac{d u}{d x} - \\nu \\, \\frac{d^{2} u}{d x^{2}}$\n- **域**: $[0,1]$\n- **边界条件**: 齐次狄利克雷, $u(0)=0$ 和 $u(1)=0$。\n- **系统**: 离散线性系统 $A \\mathbf{u} = \\mathbf{f}$。\n- **人工扩散**: $\\nu_{\\text{art}}=\\gamma \\, a \\, h$, 其中 $a>0$。\n- **总扩散**: $\\nu_{\\text{tot}} = \\nu + \\nu_{\\text{art}}$。\n- **网格**: $N=4$ 个内部网格点，均匀网格间距 $h = \\frac{1}{N+1}$。\n- **离散化（对流）**: 对 $a>0$ 采用一阶迎风格式，在节点 $i$ 处为 $a \\, \\frac{d u}{d x} \\approx a \\frac{u_{i} - u_{i-1}}{h}$。\n- **离散化（扩散）**: 中心二阶差分, $-\\nu \\, \\frac{d^{2} u}{d x^{2}} \\approx -(\\nu_{\\text{tot}}) \\frac{u_{i+1}-2 u_i + u_{i-1}}{h^{2}}$。\n- **边界处理**: 涉及 $u_{0}$ 或 $u_{N+1}$ 的模板项为零。\n- **待计算量**: Frobenius范数非正规性偏离度, $\\delta(A) = \\|A^{\\top} A - A A^{\\top}\\|_{F}$。\n- **参数**: $a=3$, $\\nu=0.01$, $\\gamma=0.5$。\n- **输出要求**: 将最终答案四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**: 该问题描述了一维稳态对流扩散方程，这是流体动力学中的一个基本模型。离散化方法（对流项采用一阶迎风，扩散项采用二阶中心差分）是计算流体动力学（CFD）中的标准方法。人工扩散是稳定数值格式的常用技术，尤其适用于对流主导问题。矩阵的非正规性及其使用Frobenius范数的量化是数值线性代数中的标准课题，与CFD中使用的GMRES等Krylov子空间方法的收敛性直接相关。该问题在科学上和数学上都是合理的。\n- **适定性**: 该问题提供了所有必要的数据以及一个清晰、明确的流程来构建矩阵 $A$ 并计算 $\\delta(A)$。由于网格点数有限（$N=4$），矩阵很小，计算是适定的，并能得到唯一解。\n- **客观性**: 该问题以精确、客观的数学和技术语言陈述，不含任何主观或基于观点的论断。\n- **完整性**: 所有必需的数值（$a, \\nu, \\gamma, N$）、边界条件和离散格式都已指定。该问题是自洽的。\n- **现实性**: 问题背景是现实的，其表述虽然经过简化，但反映了航空航天CFD中遇到的真实问题。所给参数用于学术练习，这是恰当的。\n\n### 步骤3：结论与行动\n该问题有效。它具有科学依据、适定、客观且完整。将提供详细的解题步骤。\n\n## 求解推导\n\n该问题要求构建一个代表一维对流扩散算子离散化的矩阵 $A$，并计算其非正规性偏离度。\n\n首先，我们计算必要的参数。\n内部网格点的数量为 $N=4$。均匀网格间距 $h$ 为：\n$$h = \\frac{1}{N+1} = \\frac{1}{4+1} = \\frac{1}{5} = 0.2$$\n给定参数为对流速度 $a=3$，物理扩散系数 $\\nu=0.01$，以及稳定化参数 $\\gamma=0.5$。\n人工扩散 $\\nu_{\\text{art}}$ 为：\n$$\\nu_{\\text{art}} = \\gamma \\, a \\, h = (0.5)(3)(0.2) = 0.3$$\n总扩散系数 $\\nu_{\\text{tot}}$ 是物理扩散和人工扩散之和：\n$$\\nu_{\\text{tot}} = \\nu + \\nu_{\\text{art}} = 0.01 + 0.3 = 0.31$$\n\n接下来，我们建立内部网格点 $i$ 处的离散方程，其中 $i=1, \\dots, N$。离散算子 $L_h$ 应用于网格函数 $u$ 在点 $i$ 处的结果由下式给出：\n$$ (A\\mathbf{u})_i = a \\frac{u_i - u_{i-1}}{h} - \\nu_{\\text{tot}} \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} $$\n为了找到矩阵 $A$ 的元素，我们按 $u$ 的下标对各项进行重新组合：\n$$ (A\\mathbf{u})_i = \\left(-\\frac{a}{h} - \\frac{\\nu_{\\text{tot}}}{h^2}\\right) u_{i-1} + \\left(\\frac{a}{h} + \\frac{2\\nu_{\\text{tot}}}{h^2}\\right) u_i + \\left(-\\frac{\\nu_{\\text{tot}}}{h^2}\\right) u_{i+1} $$\n这表明矩阵 $A$ 是一个三对角矩阵。让我们计算各对角线元素的系数，分别记为下对角线 $c$、主对角线 $d$ 和上对角线 $b$：\n$$c = -\\frac{a}{h} - \\frac{\\nu_{\\text{tot}}}{h^2} = -\\frac{3}{0.2} - \\frac{0.31}{(0.2)^2} = -15 - \\frac{0.31}{0.04} = -15 - 7.75 = -22.75$$\n$$d = \\frac{a}{h} + \\frac{2\\nu_{\\text{tot}}}{h^2} = \\frac{3}{0.2} + 2\\frac{0.31}{(0.2)^2} = 15 + 2(7.75) = 15 + 15.5 = 30.5$$\n$$b = -\\frac{\\nu_{\\text{tot}}}{h^2} = -\\frac{0.31}{(0.2)^2} = -7.75$$\n\n对于 $N=4$ 个内部点，矩阵 $A$ 是一个 $4 \\times 4$ 的矩阵。边界条件 $u_0=0$ 和 $u_{N+1}=u_5=0$ 意味着 $i=1$ 的模板不涉及 $u_0$，$i=4$ 的模板不涉及 $u_5$。最终得到的矩阵 $A$ 是：\n$$\nA = \\begin{pmatrix}\nd  b  0  0 \\\\\nc  d  b  0 \\\\\n0  c  d  b \\\\\n0  0  c  d\n\\end{pmatrix} = \\begin{pmatrix}\n30.5   -7.75  0  0 \\\\\n-22.75  30.5  -7.75  0 \\\\\n0  -22.75  30.5  -7.75 \\\\\n0  0  -22.75  30.5\n\\end{pmatrix}\n$$\n非正规性偏离度为 $\\delta(A) = \\|A^{\\top} A - A A^{\\top}\\|_{F}$。令 $C = A^{\\top} A - A A^{\\top}$。我们来计算这个对易子矩阵。\n$$\nA^{\\top} = \\begin{pmatrix}\nd  c  0  0 \\\\\nb  d  c  0 \\\\\n0  b  d  c \\\\\n0  0  b  d\n\\end{pmatrix}\n$$\n$A^{\\top}A$ 和 $AA^{\\top}$ 的计算结果为：\n$$\nA^{\\top}A = \\begin{pmatrix} d^2+c^2  db+cd  cb  0 \\\\ db+cd  b^2+d^2+c^2  db+cd  cb \\\\ cb  db+cd  b^2+d^2+c^2  db+cd \\\\ 0  cb  db+cd  b^2+d^2 \\end{pmatrix}\n$$\n$$\nAA^{\\top} = \\begin{pmatrix} d^2+b^2  dc+bd  b^2  0 \\\\ dc+bd  c^2+d^2+b^2  dc+bd  b^2 \\\\ b^2  dc+bd  c^2+d^2+b^2  dc+bd \\\\ 0  b^2  dc+bd  c^2+d^2 \\end{pmatrix}\n$$\n相减得到对易子矩阵 $C = A^{\\top}A - AA^{\\top}$：\n$$\nC = \\begin{pmatrix}\nc^2-b^2  0  cb-b^2  0 \\\\\n0  0  0  cb-b^2 \\\\\ncb-b^2  0  0  0 \\\\\n0  cb-b^2  0  b^2-c^2\n\\end{pmatrix}\n$$\n现在我们计算非零元素的值：\n$c = -22.75$, $b = -7.75$.\n$c^2 - b^2 = (-22.75)^2 - (-7.75)^2 = 517.5625 - 60.0625 = 457.5$.\n$b^2 - c^2 = -457.5$.\n$cb - b^2 = (-22.75)(-7.75) - (-7.75)^2 = 176.3125 - 60.0625 = 116.25$.\n因此，矩阵 $C$ 是：\n$$ C = \\begin{pmatrix} 457.5  0  116.25  0 \\\\ 0  0  0  116.25 \\\\ 116.25  0  0  0 \\\\ 0  116.25  0  -457.5 \\end{pmatrix} $$\n$C$ 的Frobenius范数是其所有元素平方和的平方根：\n$$ \\delta(A) = \\|C\\|_F = \\sqrt{\\sum_{i,j=1}^{4} |C_{ij}|^2} = \\sqrt{(457.5)^2 + (116.25)^2 + (116.25)^2 + (116.25)^2 + (116.25)^2 + (-457.5)^2} $$\n$$ \\delta(A)^2 = 2 \\times (457.5)^2 + 4 \\times (116.25)^2 $$\n$$ \\delta(A)^2 = 2 \\times 209306.25 + 4 \\times 13514.0625 = 418612.5 + 54056.25 = 472668.75 $$\n$$ \\delta(A) = \\sqrt{472668.75} \\approx 687.50916... $$\n问题要求将答案四舍五入到四位有效数字。\n$$ \\delta(A) \\approx 687.5 $$\n该问题是在无量纲域 $[0,1]$ 上使用无量纲参数提出的，因此矩阵项和最终的非正规性偏离度也是无量纲的。",
            "answer": "$$\\boxed{687.5}$$"
        },
        {
            "introduction": "阿诺尔迪过程（Arnoldi process）是 GMRES 算法的核心引擎，它负责为克雷洛夫子空间构建一个标准正交基。然而，在有限精度的计算世界中，维持该基的严格正交性是一个重大挑战，尤其是在处理计算流体力学中常见的非正规、病态矩阵时。本练习深入探讨了这一关键的实现细节，通过比较经典格拉姆-施密特（CGS）与修正的格拉姆-施密特（MGS）正交化方案的数值稳定性，揭示了为何一个看似微小的算法选择对于整个求解器的鲁棒性和实际成功至关重要。",
            "id": "3970321",
            "problem": "考虑求解一个稀疏非对称线性系统 $A x = b$，该系统源于计算流体力学(CFD)中通过有限体积法和迎风数值通量离散化的可压缩纳维-斯托克斯方程的雅可比线性化。为求解 $A x = b$，您采用重启广义最小残差法(GMRES)，重启参数为 $m$，该方法通过阿诺德过程构建克雷洛夫基。在精确算术中，阿诺德关系式为\n$$\nA V_m = V_{m+1} \\,\\bar{H}_m,\n$$\n其中 $V_{m+1} \\in \\mathbb{R}^{n \\times (m+1)}$ 的列是标准正交的，$\\bar{H}_m \\in \\mathbb{R}^{(m+1)\\times m}$ 是上Hessenberg矩阵。Arnoldi过程中的标准正交化步骤可以通过经典格拉姆-施密特(CGS)或修正格拉姆-施密特(MGS)来执行。\n\n假设采用标准浮点运算，单位舍入误差为 $u$，并采用基本模型：对于任何涉及 $p$ 项的标量运算或内积，计算结果的相对误差以 $c\\,p\\,u$ 为界（其中 $c$ 为一个适中的常数）；每次saxpy更新产生的相对误差以 $u$ 的一个适中常数倍为界。同时假设 $A$ 是强非正规的，因此随着 $m$ 的增长，克雷洛夫基向量可能变得近似线性相关。\n\n仅使用Gram–Schmidt的投影定义，即向量 $w$ 对当前基 $Q_{k-1}$ 的正交化是应用投影算子 $I - Q_{k-1}Q_{k-1}^\\top$，并结合上述浮点模型，论证在Arnoldi过程中使用CGS与MGS对此类矩阵 $A$ 的计算所得 $V_m$ 的正交性以及重启GMRES$(m)$收敛行为的影响。选择所有正确的陈述。\n\n- A. 在精确算术中，CGS和MGS产生相同的Arnoldi分解，即它们都生成具有标准正交列的 $V_{m+1}$ 和相同的 $\\bar{H}_m$，因为它们在每一步都实现了相同的投影 $I - Q_{k-1}Q_{k-1}^\\top$。\n\n- B. 在有限精度下，未经再正交化的CGS可能导致 $V_m$ 的正交性损失，该损失随演化基的条件数增长，而对于强非正规矩阵 $A$，这可能导致GMRES残差范数的过早停滞。\n\n- C. 即使没有再正交化，MGS也能保证 $V_m$ 在机器精度内的精确正交性，无论 $A$ 的非正规性如何。\n\n- D. 执行单次再正交化过程（即应用两次MGS）通常将 $V_m$ 的正交性损失降低到单位舍入误差 $u$ 的水平，并且在实践中对于CFD中出现的非正规矩阵上的重启GMRES通常是足够的。\n\n- E. 在Arnoldi过程中，$V_m$ 的任何正交性损失只是在同一子空间内旋转基，因此里兹值近似和GMRES收敛不受此类正交性损失的影响。\n\n选择所有适用的选项，并基于正交投影的第一性原理和上述浮点误差模型来证明你的选择，不要借助任何未经证明的简化公式。",
            "solution": "用户要求对问题陈述进行严格验证，然后给出一个推导正确答案并评估每个选项的详细解答。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n- 问题是求解一个稀疏非对称线性系统 $A x = b$。\n- 该系统源于一个通过有限体积法和迎风数值通量离散化的可压缩纳维-斯托克斯方程的雅可比线性化。\n- 求解方法是重启GMRES$(m)$。\n- 克雷洛夫基是通过阿诺德过程构建的。\n- 在精确算术中，阿诺德关系式为 $A V_m = V_{m+1} \\,\\bar{H}_m$。\n- $V_{m+1} \\in \\mathbb{R}^{n \\times (m+1)}$ 具有标准正交列。\n- $\\bar{H}_m \\in \\mathbb{R}^{(m+1)\\times m}$ 是上Hessenberg矩阵。\n- Arnoldi过程中的正交化可以通过经典格拉姆-施密特(CGS)或修正格拉姆-施密特(MGS)完成。\n- 假设了一个浮点模型，单位舍入误差为 $u$。\n- 涉及 $p$ 项的标量运算或内积的计算结果，其相对误差以 $c\\,p\\,u$ 为界（$c$ 为一个适中的常数）。\n- 每次 `saxpy` 更新产生的相对误差以 $u$ 的一个适中常数倍为界。\n- 矩阵 $A$ 是强非正规的。\n- 随着 $m$ 的增长，克雷洛夫基向量可能变得近似线性相关。\n- Gram-Schmidt过程被定义为应用投影算子 $I - Q_{k-1}Q_{k-1}^\\top$ 将向量 $w$ 与一个基 $Q_{k-1}$ 正交化。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础：** 该问题牢固地植根于数值线性代数领域及其在计算流体力学(CFD)中的应用。所描述的场景——使用GMRES和Arnoldi过程求解来自CFD离散化的非对称系统——是科学计算中一个标准且至关重要的问题。CGS和MGS之间的区别及其稳定性是数值分析中的经典课题。矩阵的性质（强非正规性）是源于平流主导的流体动力学问题的系统的典型特征。\n- **良构性：** 问题提供了清晰的背景，指明了算法（CGS、MGS），定义了数学关系（阿诺德关系式），提供了一个简化但标准的浮点误差模型，并要求对数值行为进行定性分析。这些信息是充分且自洽的，足以基于已建立的数值分析原理进行严谨的推理。\n- **客观性：** 问题以精确的技术语言表述。它要求基于给定的模型进行推理，避免了任何主观或模糊的术语。\n\n该问题没有表现出任何列出的缺陷（例如，科学上不健全、不完整、模糊不清）。它代表了高等数值方法中一个标准的、有深度的问题。\n\n**步骤3：结论与行动**\n问题陈述是**有效的**。现在开始解答过程。\n\n**解答推导**\n\n问题的核心在于Arnoldi过程中Gram-Schmidt正交化过程的两种不同实现在应用于一组近似线性相关的向量时的数值稳定性。设有一组标准正交向量 $\\{v_1, \\dots, v_{k-1}\\}$，它们构成矩阵 $V_{k-1}$ 的列。Arnoldi过程的下一步是计算向量 $w = A v_{k-1}$，然后将其与 $V_{k-1}$ 正交化。将这个待正交化的向量记为 $z$。在精确算术中，目标是计算 $z_{\\perp} = (I - V_{k-1}V_{k-1}^\\top)z$。\n\n**经典格拉姆-施密特(CGS)** 如下实现此投影：\n$1.$ 计算所有内积：$h_{j, k-1} = v_j^\\top z$，其中 $j = 1, \\dots, k-1$。\n$2.$ 一步减去投影：$z_{\\perp} = z - \\sum_{j=1}^{k-1} h_{j, k-1} v_j$。\n这可以紧凑地写为 $z_{\\perp} = z - V_{k-1}(V_{k-1}^\\top z)$。\n\n**修正格拉姆-施密特(MGS)** 依次实现相同的投影：\n初始化 $z^{(0)} = z$。\n对于 $j=1, \\dots, k-1$:\n$1.$ 计算内积：$h_{j, k-1} = v_j^\\top z^{(j-1)}$。\n$2.$ 减去一个分量：$z^{(j)} = z^{(j-1)} - h_{j, k-1} v_j$。\n最终结果是 $z_{\\perp} = z^{(k-1)}$。\n\n在有限精度算术中，单位舍入误差为 $u$，这两种算法的行为截然不同。问题指出，对于强非正规矩阵 $A$，原始的克雷洛夫基向量会变得近似线性相关。这意味着向量 $z = A v_{k-1}$ 几乎完全位于由 $\\{v_1, \\dots, v_{k-1}\\}$ 张成的子空间中。因此，其正交分量 $z_{\\perp}$ 的大小与 $z$ 相比会非常小。\n\n使用CGS，我们计算 $\\hat{z}_{\\perp} = \\text{fl}(z - \\sum_{j=1}^{k-1} \\text{fl}(v_j^\\top z) v_j)$。项 $\\sum \\text{fl}(v_j^\\top z) v_j$ 是 $z$ 在 $\\mathrm{span}(V_{k-1})$ 上的计算投影，其大小非常接近 $z$ 的大小。这个减法是“大数 - 近似相等的大数”的形式，这是灾难性抵消的经典原因。计算内积和最终减法中的舍入误差相对于 $\\|z\\|$ 很小，但相对于真实结果 $\\|z_{\\perp}\\|$ 可能会变得非常大。计算出的向量 $\\hat{z}_{\\perp}$ 可能保留了沿着先前 $v_j$ 向量的显著分量，导致正交性的严重损失。可以证明，正交性损失 $\\|I - \\hat{V}_k^\\top \\hat{V}_k\\|$ 与 $u \\cdot \\kappa(\\mathcal{K}_k)$ 成正比，其中 $\\kappa(\\mathcal{K}_k)$ 是以原始克雷洛夫向量为列的矩阵的条件数，这个数可能非常大。\n\n使用MGS，在每一步 $j$，我们计算 $\\hat{z}^{(j)} = \\text{fl}(\\hat{z}^{(j-1)} - \\text{fl}(v_j^\\top \\hat{z}^{(j-1)}) v_j)$。向量 $\\hat{z}^{(j-1)}$ 已经被处理得与 $\\{v_1, \\dots, v_{j-1}\\}$ 近似正交。这种顺序移除分量的方式比CGS中的单步移除在数值上更稳定。虽然MGS也会遭受一定的正交性损失，但其严重程度要小得多。最终计算出的向量是近似正交的，即 $|v_i^\\top \\hat{v}_j| = O(u)$ 对于 $i \\neq j$ 成立，这是一个比CGS所能提供的要好得多的性质。\n\n这种正交性的损失直接影响GMRES。GMRES算法依赖于Arnoldi关系式 $AV_m = V_{m+1}\\bar{H}_m$ 来构建一个小型最小二乘问题 $\\| \\beta e_1 - \\bar{H}_m y \\|_2$，其解给出下一个迭代点。如果计算出的基 $\\hat{V}_m$ 的列不正交，这个关系式仅在有一个大的误差项 $F_m$ 时才成立：$A\\hat{V}_m = \\hat{V}_{m+1}\\hat{\\bar{H}}_m + F_m$。因此，小问题的残差不再能准确反映真实残差的范数 $\\|b-Ax_m\\|_2$。这可能导致算法错误地检测到停滞并终止或重启，这种现象被称为过早停滞。\n\n**逐项分析**\n\n- **A. 在精确算术中，CGS和MGS产生相同的Arnoldi分解，即它们都生成具有标准正交列的 $V_{m+1}$ 和相同的 $\\bar{H}_m$，因为它们在每一步都实现了相同的投影 $I - Q_{k-1}Q_{k-1}^\\top$。**\n  - **论证：** 在精确算术中，CGS和MGS在代数上是等价的。两个过程都计算一个向量与给定子空间正交的分量。CGS计算投影 $Pz = \\sum (v_j^\\top z) v_j$ 并减去它，$z_{\\perp} = z - Pz$。MGS应用一系列投影算子 $z_{\\perp} = (I - v_{k-1}v_{k-1}^\\top) \\cdots (I - v_1v_1^\\top)z$。由于 $v_j$ 是标准正交的，这两个过程产生相同的结果。因此，从相同的初始向量开始，它们将产生相同的标准正交基 $V_{m+1}$ 和相同的Hessenberg矩阵 $\\bar{H}_m$。该选项中提供的理由是正确的。\n  - **判定：** 正确。\n\n- **B. 在有限精度下，未经再正交化的CGS可能导致 $V_m$ 的正交性损失，该损失随演化基的条件数增长，而对于强非正规矩阵 $A$，这可能导致GMRES残差范数的过早停滞。**\n  - **论证：** 如上文推导，当待正交化的向量近似线性相关时，CGS在数值上是不稳定的。对于强非正规矩阵 $A$ 来说，情况正是如此。计算出的基 $\\hat{V}_m$ 的正交性损失随原始克雷洛夫基的条件数而增长。这种正交性的损失使得GMRES残差更新所依赖的假设失效，导致计算出的残差范数与真实残差范数偏离，这可能导致算法的过早停滞。这个陈述准确地描述了使用CGS的GMRES众所周知的失效模式。\n  - **判定：** 正确。\n\n- **C. 即使没有再正交化，MGS也能保证 $V_m$ 在机器精度内的精确正交性，无论 $A$ 的非正规性如何。**\n  - **论证：** 这个陈述过于绝对，因此是错误的。虽然MGS比CGS稳定得多，但它并不能在所有情况下都保证达到机器精度的正交性（即 $\\|I - \\hat{V}_m^\\top \\hat{V}_m\\| = O(u)$）。MGS中的正交性损失也取决于所生成基的条件数。对于具有极强非正规性、导致克雷洛夫基条件数极差的问题，仅靠MGS可能不足以将正交性维持在工作精度内。声称它“无论A的非正规性如何”都有效是不正确的。\n  - **判定：** 错误。\n\n- **D. 执行单次再正交化过程（即应用两次MGS）通常将 $V_m$ 的正交性损失降低到单位舍入误差 $u$ 的水平，并且在实践中对于CFD中出现的非正规矩阵上的重启GMRES通常是足够的。**\n  - **论证：** 再正交化是将正交化过程对计算出的向量再次应用的过程。设 $\\hat{v}_{k}$ 是经过一次MGS处理后得到的向量。它将与之前的基向量近似正交，但并非完全正交。对 $\\hat{v}_{k}$ 再次应用MGS会计算并减去其沿基向量的微小剩余分量。可以证明，只要初始损失不是灾难性的，这个过程就能将正交性损失降低到机器精度的水平，即 $O(u)$。这种技术通常表示为MGS2，是确保GMRES在处理具有挑战性的问题（例如CFD中出现的强非正规矩阵）时保持稳定性的标准且稳健的做法。该陈述准确地反映了数值线性代数中的理论和实践。\n  - **判定：** 正确。\n\n- **E. 在Arnoldi过程中，$V_m$ 的任何正交性损失只是在同一子空间内旋转基，因此里兹值近似和GMRES收敛不受此类正交性损失的影响。**\n  - **论证：** 这个陈述是根本错误的。旋转是一种正交变换，它会保持正交性，这与所描述的情况正好相反。正交性损失意味着计算出的基向量 $\\hat{v}_j$ 彼此不再正交。这会带来严重的负面后果。计算出的子空间甚至可能无法正确表示真实的克雷洛夫子空间。Arnoldi关系式被破坏，导致从被污染的Hessenberg矩阵 $\\hat{H}_m$ 计算出的里兹值（$\\hat{H}_m$ 的特征值）成为 $A$ 真实特征值的伪劣近似。如选项B中所解释的，GMRES的收敛受到严重影响，常常导致停滞。认为收敛“不受影响”的想法是错误的。\n  - **判定：** 错误。",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "预处理是一种强大的加速迭代求解器的策略，它能有效地将一个困难的线性系统转化为一个更易于求解的系统。这个高级实践将带你从分析现有方法转向主动设计求解器的组件。你将学习如何从第一性原理出发，利用切比雪夫多项式优雅的极小极大性质，来构建一个强大的多项式预处理器，从而优化地聚集系统矩阵的特征值，通过这种“谱工程”的方式显著加速 GMRES 的收敛。",
            "id": "3970309",
            "problem": "在一个针对航空航天构型的稳态、不可压缩计算流体动力学(CFD)模拟中，一个分离式压力修正步骤产生了一个对称正定线性系统 $A u = f$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是由一个六面体网格上的椭圆算子经过二阶有限体积离散化得到的。谱分析和网格无关估计表明，$A$ 的谱位于区间 $[\\alpha,\\beta]$ 内，其中 $0  \\alpha  \\beta$，且该区间外没有特征值。\n\n考虑使用一个次数至多为 $m-1$ 的多项式预条件子 $p(A)$ 进行左预处理，使得预处理算子为 $B = p(A) A$。将广义最小残差(GMRES)方法应用于 $B u = p(A) f$，在每次迭代中选择一个次数为 $k$ 且满足 $r_{k}(0)=1$ 的残差多项式 $r_{k}$，以最小化残差 $\\|r_{k}(B) r_{0}\\|$，其中 $r_{0}$ 是初始残差。多项式预条件子的目标是通过最小化在 $\\lambda \\in [\\alpha,\\beta]$ 上的最坏情况偏差 $|1 - \\lambda p(\\lambda)|$，将 $B$ 的谱聚集在 $1$ 附近。\n\n从以下基本事实出发：\n- $k$ 步后的 GMRES 残差具有 $r_{k}(B) r_{0}$ 的形式，其中 $r_{k}$ 是一个满足 $r_{k}(0)=1$ 的 $k$ 次多项式。\n- 由 $T_{m}(\\cos\\theta)=\\cos(m\\theta)$ 定义的第一类切比雪夫多项式 $T_{m}$，在 $[-1,1]$ 上具有极小化极大值性质：在所有经过缩放以在点 $x_{0} \\notin [-1,1]$ 处匹配一个固定值的首一 $m$ 次多项式中，$T_{m}$ 的幅值在 $[-1,1]$ 上的一致范数下是最小的。\n\n任务：\n1. 从极小化极大值性质出发，推导次数为 $m$ 且满足 $r_{m}(0)=1$ 的最优残差多项式 $r_{m}(\\lambda)$，该多项式能最小化 $\\max_{\\lambda \\in [\\alpha,\\beta]} |r_{m}(\\lambda)|$。使用一个从 $[\\alpha,\\beta]$ 到 $[-1,1]$ 的仿射映射，将 $r_{m}$ 表示为 $T_{m}$ 的函数，然后推导由 $1 - \\lambda p_{m-1}(\\lambda) = r_{m}(\\lambda)$ 定义的相关多项式预条件子 $p_{m-1}(\\lambda)$。\n2. 使用你推导的公式，取 $\\alpha = \\tfrac{1}{5}$，$\\beta = 5$ 和 $m=3$。显式计算所得的二次预条件子 $p_{2}(\\lambda)$，结果应为一个以 $\\lambda$ 为变量、系数为有理数的闭式解析表达式。将最终答案表示为关于 $\\lambda$ 的简化多项式。不要四舍五入。\n\n此外，在你的推导过程中，定性地解释所构造的 $p(A)$ 如何阻尼不期望的谱分量，以及在这种 CFD 背景下，$B$ 的谱的聚集如何影响 GMRES 的收敛行为。\n\n你的最终答案必须是 $p_{2}(\\lambda)$ 的显式表达式。",
            "solution": "该问题被评估为有效，因为它具有科学依据、适定且客观。它提出了一个关于多项式预处理的数值线性代数中的标准、可解问题，并使用了既定原则和清晰、正式的语言。\n\n总体任务是基于切比雪夫多项式推导一个最优多项式预条件子，然后计算它的一个具体实例。该预处理策略旨在通过聚集预处理算子的谱来改善 GMRES 方法的收敛性。\n\n### 第 1 部分：最优预条件子的推导\n\n问题在于找到一个次数至多为 $m-1$ 的多项式 $p_{m-1}(\\lambda)$，以最小化量 $\\max_{\\lambda \\in [\\alpha,\\beta]} |1 - \\lambda p_{m-1}(\\lambda)|$。令 $r_m(\\lambda) = 1 - \\lambda p_{m-1}(\\lambda)$。这个 $r_m(\\lambda)$ 是一个次数至多为 $m$ 的多项式。条件 $r_m(0) = 1 - 0 \\cdot p_{m-1}(0) = 1$ 自动满足。因此，该问题等价于找到一个次数为 $m$ 且满足 $r_m(0)=1$ 的多项式 $r_m(\\lambda)$，使其一致范数 $\\|r_m\\|_{L_{\\infty}([\\alpha,\\beta])} = \\max_{\\lambda \\in [\\alpha,\\beta]} |r_m(\\lambda)|$ 最小。\n\n这是一个经典的极小化极大值问题。其解已知是一个经过缩放和平移的第一类切比雪夫多项式 $T_m(x)$。$T_m(x)$ 的关键性质是，在所有首项系数为 $2^{m-1}$ 的 $m$ 次多项式中，它在 $[-1,1]$ 上具有最小的 $L_{\\infty}$ 范数，其值为 $1$。等价地，对于区间 $[-1,1]$ 外的一点 $x_0$，在所有满足 $r(x_0)=1$ 的 $m$ 次多项式中，多项式 $r(x) = T_m(x) / T_m(x_0)$ 能最小化 $\\max_{x\\in[-1,1]} |r(x)|$。\n\n为了应用此性质，我们必须首先使用仿射变换将谱区间 $[\\alpha,\\beta]$ 映射到区间 $[-1,1]$。设该映射为 $x = f(\\lambda) = c\\lambda+d$。我们要求 $f(\\alpha)=-1$ 和 $f(\\beta)=1$：\n$$\n\\begin{cases}\nc\\alpha + d = -1 \\\\\nc\\beta + d = 1\n\\end{cases}\n$$\n求解该方程组得到 $c$ 和 $d$：\n$$c(\\beta-\\alpha) = 2 \\implies c = \\frac{2}{\\beta-\\alpha}$$\n$$d = 1 - c\\beta = 1 - \\frac{2\\beta}{\\beta-\\alpha} = \\frac{\\beta-\\alpha-2\\beta}{\\beta-\\alpha} = -\\frac{\\alpha+\\beta}{\\beta-\\alpha}$$\n所以，仿射映射为：\n$$x(\\lambda) = \\frac{2\\lambda - (\\alpha+\\beta)}{\\beta-\\alpha}$$\n我们的约束在 $\\lambda=0$ 处，由于 $0  \\alpha$，该点在区间 $[\\alpha,\\beta]$ 之外。点 $\\lambda=0$ 映射到：\n$$x_0 = x(0) = \\frac{-(\\alpha+\\beta)}{\\beta-\\alpha}$$\n在约束 $r_m(0)=1$ 下，最小化其在 $[\\alpha,\\beta]$ 上最大幅值的最优残差多项式 $r_m(\\lambda)$，是通过缩放切比雪夫多项式 $T_m(x)$ 得到的，使其在映射点 $x_0$ 的值为 $1$。\n$$r_m(\\lambda) = \\frac{T_m(x(\\lambda))}{T_m(x_0)} = \\frac{T_m\\left(\\frac{2\\lambda - (\\alpha+\\beta)}{\\beta-\\alpha}\\right)}{T_m\\left(\\frac{-(\\alpha+\\beta)}{\\beta-\\alpha}\\right)}$$\n由于 $T_m(-x) = (-1)^m T_m(x)$，分母也可以写成 $(-1)^m T_m\\left(\\frac{\\alpha+\\beta}{\\beta-\\alpha}\\right)$。\n\n根据定义 $r_m(\\lambda) = 1 - \\lambda p_{m-1}(\\lambda)$，我们可以解出多项式预条件子 $p_{m-1}(\\lambda)$：\n$$p_{m-1}(\\lambda) = \\frac{1 - r_m(\\lambda)}{\\lambda} = \\frac{1}{\\lambda}\\left(1 - \\frac{T_m\\left(\\frac{2\\lambda - (\\alpha+\\beta)}{\\beta-\\alpha}\\right)}{T_m\\left(\\frac{-(\\alpha+\\beta)}{\\beta-\\alpha}\\right)}\\right)$$\n分子在 $\\lambda=0$ 处的值为 $1 - T_m(x(0))/T_m(x(0)) = 0$。这证实了该表达式可被 $\\lambda$ 整除，且 $p_{m-1}(\\lambda)$ 确实是一个 $m-1$ 次多项式。\n\n### 对 GMRES 收敛的定性影响\n\n多项式预条件子 $p(A)$ 将原始线性系统 $Au=f$ 变换为 $p(A)Au = p(A)f$。新的系统矩阵是 $B=p(A)A$。如果 $\\lambda_i$ 是 $A$ 的一个特征值，那么 $B$ 相应的特征值是 $\\mu_i = \\lambda_i p(\\lambda_i)$。\n我们的构造旨在使 $\\lambda p(\\lambda)$ 对于 $A$ 的谱中的所有 $\\lambda$（即 $\\lambda \\in [\\alpha, \\beta]$）都尽可能接近 $1$。\n多项式 $q(\\lambda) = \\lambda p_{m-1}(\\lambda)$ 被构造为 $q(\\lambda) = 1 - r_m(\\lambda)$。$r_m(\\lambda)$ 在 $[\\alpha, \\beta]$ 上的幅值有界，其界为：\n$$\\rho_m = \\max_{\\lambda \\in [\\alpha,\\beta]} |r_m(\\lambda)| = \\frac{\\max_{x \\in [-1,1]} |T_m(x)|}{\\left|T_m\\left(\\frac{-(\\alpha+\\beta)}{\\beta-\\alpha}\\right)\\right|} = \\frac{1}{\\left|T_m\\left(\\frac{\\alpha+\\beta}{\\beta-\\alpha}\\right)\\right|}$$\n这意味着对于 $A$ 的任何特征值 $\\lambda_i$，$B$ 对应的特征值 $\\mu_i = \\lambda_i p_{m-1}(\\lambda_i)$ 位于区间 $[1-\\rho_m, 1+\\rho_m]$ 内。因此，预条件子将原始的、可能很宽的谱区间 $[\\alpha, \\beta]$ 映射到一个以 $1$ 为中心的更小区间。\n\nGMRES 的收敛速度高度依赖于特征值的分布。通过将预处理矩阵 $B$ 的特征值紧密地聚集在 $1$ 附近，系统的有效条件数从 $\\kappa(A) \\approx \\beta/\\alpha$ 大大降低到 $\\kappa(B) \\approx \\frac{1+\\rho_m}{1-\\rho_m}$。更小的条件数和更聚集的谱使得 GMRES 算法能够找到一个在整个谱上都很小的低次残差多项式，从而导致残差范数更快地减小，并因此实现更快的收敛。多项式预条件子充当谱滤波器的角色，阻尼与导致收敛减慢的特征值相对应的残差分量。\n\n### 第 2 部分：$p_2(\\lambda)$ 的显式计算\n\n给定 $\\alpha = \\frac{1}{5}$，$\\beta = 5$ 和 $m=3$。我们求解二次预条件子 $p_2(\\lambda)$。\n\n首先，我们计算仿射映射的参数及其在 $\\lambda=0$ 处的值：\n$$\\alpha+\\beta = \\frac{1}{5} + 5 = \\frac{26}{5}$$\n$$\\beta-\\alpha = 5 - \\frac{1}{5} = \\frac{24}{5}$$\n从 $\\lambda$ 到 $x$ 的映射为：\n$$x(\\lambda) = \\frac{2\\lambda - 26/5}{24/5} = \\frac{10\\lambda - 26}{24} = \\frac{5\\lambda - 13}{12}$$\n对应于 $\\lambda=0$ 的点 $x_0$ 是：\n$$x_0 = x(0) = -\\frac{13}{12}$$\n我们需要次数为 $m=3$ 的切比雪夫多项式，即 $T_3(x) = 4x^3 - 3x$。\n接下来，我们计算 $T_3(x_0)$：\n$$T_3\\left(-\\frac{13}{12}\\right) = 4\\left(-\\frac{13}{12}\\right)^3 - 3\\left(-\\frac{13}{12}\\right) = 4\\left(-\\frac{2197}{1728}\\right) + \\frac{39}{12}$$\n$$= -\\frac{2197}{432} + \\frac{39 \\times 36}{12 \\times 36} = \\frac{-2197 + 1404}{432} = -\\frac{793}{432}$$\n次数为 $3$ 的最优残差多项式是：\n$$r_3(\\lambda) = \\frac{T_3\\left(\\frac{5\\lambda-13}{12}\\right)}{T_3\\left(-\\frac{13}{12}\\right)} = -\\frac{432}{793} T_3\\left(\\frac{5\\lambda-13}{12}\\right)$$\n现在我们求解预条件子 $p_2(\\lambda) = \\frac{1-r_3(\\lambda)}{\\lambda}$：\n$$p_2(\\lambda) = \\frac{1}{\\lambda} \\left(1 + \\frac{432}{793} T_3\\left(\\frac{5\\lambda-13}{12}\\right)\\right)$$\n让我们展开 $T_3\\left(\\frac{5\\lambda-13}{12}\\right)$：\n$$T_3\\left(\\frac{5\\lambda-13}{12}\\right) = 4\\left(\\frac{5\\lambda-13}{12}\\right)^3 - 3\\left(\\frac{5\\lambda-13}{12}\\right)$$\n$$= \\frac{4(5\\lambda-13)^3}{1728} - \\frac{3(5\\lambda-13)}{12} = \\frac{(5\\lambda-13)^3}{432} - \\frac{108(5\\lambda-13)}{432}$$\n分子是 $(5\\lambda-13)^3 - 108(5\\lambda-13)$。展开立方项：\n$$(5\\lambda-13)^3 = (5\\lambda)^3 - 3(5\\lambda)^2(13) + 3(5\\lambda)(13^2) - 13^3 = 125\\lambda^3 - 975\\lambda^2 + 2535\\lambda - 2197$$\n所以分子变为：\n$$(125\\lambda^3 - 975\\lambda^2 + 2535\\lambda - 2197) - (540\\lambda - 1404) = 125\\lambda^3 - 975\\lambda^2 + 1995\\lambda - 793$$\n因此，\n$$T_3\\left(\\frac{5\\lambda-13}{12}\\right) = \\frac{125\\lambda^3 - 975\\lambda^2 + 1995\\lambda - 793}{432}$$\n将此代入 $p_2(\\lambda)$ 的表达式中：\n$$p_2(\\lambda) = \\frac{1}{\\lambda} \\left(1 + \\frac{432}{793} \\left(\\frac{125\\lambda^3 - 975\\lambda^2 + 1995\\lambda - 793}{432}\\right)\\right)$$\n$$p_2(\\lambda) = \\frac{1}{\\lambda} \\left(1 + \\frac{125\\lambda^3 - 975\\lambda^2 + 1995\\lambda - 793}{793}\\right)$$\n$$p_2(\\lambda) = \\frac{1}{\\lambda} \\left(\\frac{793 + 125\\lambda^3 - 975\\lambda^2 + 1995\\lambda - 793}{793}\\right)$$\n$$p_2(\\lambda) = \\frac{1}{\\lambda} \\left(\\frac{125\\lambda^3 - 975\\lambda^2 + 1995\\lambda}{793}\\right)$$\n除以 $\\lambda$，我们得到最终的二次多项式：\n$$p_2(\\lambda) = \\frac{125\\lambda^2 - 975\\lambda + 1995}{793}$$\n我们可以简化系数。分母的质因数分解是 $793 = 13 \\times 61$。\n$$p_2(\\lambda) = \\frac{125}{793}\\lambda^2 - \\frac{975}{793}\\lambda + \\frac{1995}{793} = \\frac{125}{793}\\lambda^2 - \\frac{75 \\times 13}{61 \\times 13}\\lambda + \\frac{1995}{793}$$\n简化后的多项式是：\n$$p_2(\\lambda) = \\frac{125}{793}\\lambda^2 - \\frac{75}{61}\\lambda + \\frac{1995}{793}$$\n这就是所求的预条件子的闭式解析表达式。",
            "answer": "$$ \\boxed{ \\frac{125}{793}\\lambda^2 - \\frac{75}{61}\\lambda + \\frac{1995}{793} } $$"
        }
    ]
}