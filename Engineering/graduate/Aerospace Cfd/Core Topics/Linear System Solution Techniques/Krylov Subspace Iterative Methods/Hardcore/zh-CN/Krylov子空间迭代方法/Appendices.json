{
    "hands_on_practices": [
        {
            "introduction": "克雷洛夫子空间方法功能强大，但其性能在很大程度上取决于待解线性系统的矩阵属性。在计算流体力学(CFD)中，控制方程的离散化方法直接决定了这些属性。本练习将引导您从一个基本的一维对流扩散方程出发，构建其离散矩阵，从而亲手揭示一个核心挑战：诸如迎风格式这类为保证数值稳定性而引入的常用技术，会天然地导致矩阵的非正规性(non-normality)。通过亲自构建这个矩阵并量化其非正规度，您将深刻理解物理问题、数值格式与迭代求解器所面临的代数难题之间的内在联系。",
            "id": "3970343",
            "problem": "考虑定义在域 $[0,1]$ 上的稳态一维对流-扩散算子 $L u = a \\, \\frac{d u}{d x} - \\nu \\, \\frac{d^{2} u}{d x^{2}}$，其边界条件为齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。在航空航天应用的计算流体动力学中，离散线性系统 $A \\mathbf{u} = \\mathbf{f}$ 是通过在均匀网格上对 $L$ 进行有限差分得到的。为了模拟实践中使用的典型稳定性方法，我们通过增加一个人工扩散 $\\nu_{\\text{art}}=\\gamma \\, a \\, h$ 来增强物理扩散系数 $\\nu$，其中 $a>0$ 是对流速度，$h$ 是均匀网格间距，$\\gamma \\geq 0$ 是稳定化参数。\n\n使用 $N=4$ 个内部网格点，因此 $h = \\frac{1}{N+1}$。在内部节点 $i$ 处，使用适用于 $a>0$ 的一阶迎风差分（即 $\\frac{u_{i} - u_{i-1}}{h}$）来离散化对流项 $a \\, \\frac{d u}{d x}$，并使用中心二阶差分 $\\frac{u_{i+1}-2 u_i + u_{i-1}}{h^{2}}$ 来离散化扩散项 $-\\nu \\, \\frac{d^{2} u}{d x^{2}}$。在离散扩散项中，将 $\\nu$ 替换为总扩散 $\\nu_{\\text{tot}} = \\nu + \\nu_{\\text{art}}$ 以引入稳定化。假设边界条件为齐次狄利克雷边界条件，因此任何涉及 $u_{0}$ 或 $u_{N+1}$ 的模板项都会从矩阵 $A$ 中消失，并且不会贡献未知数。\n\n航空航天计算流体动力学中用于大规模系统的高级迭代求解器通常采用克雷洛夫子空间方法，例如广义最小残差（GMRES）方法，其收敛行为对算子的非正规性很敏感。量化非正规性的一种方法是弗罗贝尼乌斯范数非正规性偏离度，由 $\\delta(A) = \\|A^{\\top} A - A A^{\\top}\\|_{F}$ 给出，其中 $\\|\\cdot\\|_{F}$ 表示弗罗贝尼乌斯范数，$A^{\\top}$ 表示转置。\n\n使用 $a=3$，$\\nu=0.01$ 和 $\\gamma=0.5$，构建矩阵 $A$ 并计算 $\\delta(A)$ 的值。将您的最终答案四舍五入到四位有效数字，并以无量纲数的形式表示。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n- **算子**：$L u = a \\, \\frac{d u}{d x} - \\nu \\, \\frac{d^{2} u}{d x^{2}}$\n- **域**：$[0,1]$\n- **边界条件**：齐次狄利克雷边界条件，$u(0)=0$ 和 $u(1)=0$。\n- **系统**：离散线性系统 $A \\mathbf{u} = \\mathbf{f}$。\n- **人工扩散**：$\\nu_{\\text{art}}=\\gamma \\, a \\, h$，其中 $a>0$。\n- **总扩散**：$\\nu_{\\text{tot}} = \\nu + \\nu_{\\text{art}}$。\n- **网格**：$N=4$ 个内部网格点，均匀网格间距 $h = \\frac{1}{N+1}$。\n- **离散化（对流）**：对于 $a>0$，采用一阶迎风差分，在节点 $i$ 处为 $a \\, \\frac{d u}{d x} \\approx a \\frac{u_{i} - u_{i-1}}{h}$。\n- **离散化（扩散）**：中心二阶差分，$-\\nu \\, \\frac{d^{2} u}{d x^{2}} \\approx -(\\nu_{\\text{tot}}) \\frac{u_{i+1}-2 u_i + u_{i-1}}{h^{2}}$。\n- **边界处理**：涉及 $u_{0}$ 或 $u_{N+1}$ 的模板项为零。\n- **待计算量**：弗罗贝尼乌斯范数非正规性偏离度，$\\delta(A) = \\|A^{\\top} A - A A^{\\top}\\|_{F}$。\n- **参数**：$a=3$，$\\nu=0.01$，$\\gamma=0.5$。\n- **输出要求**：将最终答案四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了一维稳态对流-扩散方程，这是流体动力学中的一个基本模型。离散化方法（对流项用一阶迎风，扩散项用二阶中心差分）是计算流体动力学（CFD）中的标准方法。人工扩散的概念是稳定数值格式的常用技术，特别是对于对流占优问题。矩阵的非正规性及其使用弗罗贝尼乌斯范数的量化是数值线性代数中的标准课题，与CFD中使用的GMRES等克雷洛夫子空间方法的收敛性直接相关。该问题在科学上和数学上都是合理的。\n- **适定性**：该问题提供了所有必要的数据和清晰明确的步骤来构建矩阵 $A$ 并计算 $\\delta(A)$。由于网格点数量有限（$N=4$），矩阵很小，计算是明确定义的，并会得到唯一解。\n- **客观性**：该问题以精确、客观的数学和技术语言陈述，没有任何主观或基于意见的主张。\n- **完整性**：所有必需的数值（$a, \\nu, \\gamma, N$）、边界条件和离散化方案都已指定。问题是自洽的。\n- **现实性**：背景是现实的，并且其表述虽然简化，但反映了航空航天CFD中遇到的真实问题。参数用于学术练习，这是合适的。\n\n### 步骤 3：结论与行动\n该问题有效。它有科学依据、适定、客观且完整。将提供详细的解决方案。\n\n## 解题推导\n\n该问题要求构建一个表示一维对流-扩散算子离散化的矩阵 $A$，并计算其非正规性偏离度。\n\n首先，我们计算必要的参数。\n内部网格点数为 $N=4$。均匀网格间距 $h$ 为：\n$$h = \\frac{1}{N+1} = \\frac{1}{4+1} = \\frac{1}{5} = 0.2$$\n给定的参数是对流速度 $a=3$，物理扩散系数 $\\nu=0.01$，以及稳定化参数 $\\gamma=0.5$。\n人工扩散 $\\nu_{\\text{art}}$ 为：\n$$\\nu_{\\text{art}} = \\gamma \\, a \\, h = (0.5)(3)(0.2) = 0.3$$\n总扩散系数 $\\nu_{\\text{tot}}$ 是物理扩散和人工扩散之和：\n$$\\nu_{\\text{tot}} = \\nu + \\nu_{\\text{art}} = 0.01 + 0.3 = 0.31$$\n\n接下来，我们建立内部网格点 $i$ 处的离散方程，其中 $i=1, \\dots, N$。在点 $i$ 处应用于网格函数 $u$ 的离散算子 $L_h$ 由下式给出：\n$$ (A\\mathbf{u})_i = a \\frac{u_i - u_{i-1}}{h} - \\nu_{\\text{tot}} \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} $$\n为了找到矩阵 $A$ 的元素，我们按 $u$ 的下标重新组织各项：\n$$ (A\\mathbf{u})_i = \\left(-\\frac{a}{h} - \\frac{\\nu_{\\text{tot}}}{h^2}\\right) u_{i-1} + \\left(\\frac{a}{h} + \\frac{2\\nu_{\\text{tot}}}{h^2}\\right) u_i + \\left(-\\frac{\\nu_{\\text{tot}}}{h^2}\\right) u_{i+1} $$\n这表明矩阵 $A$ 是三对角的。我们来计算对角线上的系数的值：\n下对角元，$d_l$：\n$$d_l = -\\frac{a}{h} - \\frac{\\nu_{\\text{tot}}}{h^2} = -\\frac{3}{0.2} - \\frac{0.31}{(0.2)^2} = -15 - \\frac{0.31}{0.04} = -15 - 7.75 = -22.75$$\n主对角元，$d_m$：\n$$d_m = \\frac{a}{h} + \\frac{2\\nu_{\\text{tot}}}{h^2} = \\frac{3}{0.2} + 2\\frac{0.31}{(0.2)^2} = 15 + 2(7.75) = 15 + 15.5 = 30.5$$\n上对角元，$d_u$：\n$$d_u = -\\frac{\\nu_{\\text{tot}}}{h^2} = -\\frac{0.31}{(0.2)^2} = -7.75$$\n\n对于 $N=4$ 个内部点，矩阵 $A$ 是一个 $4 \\times 4$ 的矩阵。边界条件 $u_0=0$ 和 $u_{N+1}=u_5=0$ 意味着 $i=1$ 的模板不涉及 $u_0$，并且 $i=4$ 的模板不涉及 $u_5$ 在矩阵结构中。得到的矩阵 $A$ 是：\n$$\nA = \\begin{pmatrix}\nd_m  & d_u  & 0  & 0 \\\\\nd_l  & d_m  & d_u  & 0 \\\\\n0  & d_l  & d_m  & d_u \\\\\n0  & 0  & d_l  & d_m\n\\end{pmatrix} = \\begin{pmatrix}\n30.5  & -7.75  & 0  & 0 \\\\\n-22.75  & 30.5  & -7.75  & 0 \\\\\n0  & -22.75  & 30.5  & -7.75 \\\\\n0  & 0  & -22.75  & 30.5\n\\end{pmatrix}\n$$\n非正规性偏离度是 $\\delta(A) = \\|A^{\\top} A - A A^{\\top}\\|_{F}$。设 $C = A^{\\top} A - A A^{\\top}$。\n$C$ 的元素 $C_{ij}$ 可以通过符号计算得出。\n对角元素：\n$C_{11} = (A^{\\top}A)_{11} - (AA^{\\top})_{11} = (d_m^2+d_l^2) - (d_m^2+d_u^2) = d_l^2 - d_u^2$\n$C_{22} = (A^{\\top}A)_{22} - (AA^{\\top})_{22} = (d_u^2+d_m^2+d_l^2) - (d_l^2+d_m^2+d_u^2) = 0$\n同理，$C_{33} = 0$。\n$C_{44} = (A^{\\top}A)_{44} - (AA^{\\top})_{44} = (d_u^2+d_m^2) - (d_l^2+d_m^2) = d_u^2 - d_l^2 = -(d_l^2-d_u^2)$\n非对角元素：\n$C_{12} = (A^{\\top}A)_{12} - (AA^{\\top})_{12} = (d_m d_u + d_l d_m) - (d_l d_m + d_u d_m) = d_m(d_u - d_l)$\n$C_{21} = d_m(d_l - d_u) = -C_{12}$\n$C_{23} = d_m(d_u - d_l)$\n$C_{32} = d_m(d_l - d_u)$\n$C_{34} = d_m(d_u - d_l)$\n$C_{43} = d_m(d_l - d_u)$\n所有其他元素均为零。\n现在我们代入数值：\n$d_l^2 - d_u^2 = (-22.75)^2 - (-7.75)^2 = 517.5625 - 60.0625 = 457.5$\n$d_u - d_l = -7.75 - (-22.75) = 15$\n$d_m(d_u - d_l) = 30.5 \\times 15 = 457.5$\n因此，对易子矩阵 $C$ 是：\n$$ C = \\begin{pmatrix} 457.5 & 457.5 & 0 & 0 \\\\ -457.5 & 0 & 457.5 & 0 \\\\ 0 & -457.5 & 0 & 457.5 \\\\ 0 & 0 & -457.5 & -457.5 \\end{pmatrix} $$\n$C$ 的弗罗贝尼乌斯范数是其元素平方和的平方根：\n$$ \\delta(A) = \\|C\\|_F = \\sqrt{\\sum_{i,j=1}^{4} |C_{ij}|^2} $$\n$$ \\delta(A) = \\sqrt{(457.5)^2 + (457.5)^2 + (-457.5)^2 + (457.5)^2 + (-457.5)^2 + (457.5)^2 + (-457.5)^2 + (-457.5)^2} $$\n注意 $|-457.5|^2 = |457.5|^2$。\n$$ \\delta(A) = \\sqrt{8 \\times (457.5)^2} = \\sqrt{8} \\times 457.5 = 2\\sqrt{2} \\times 457.5 $$\n现在，我们计算数值：\n$$ \\delta(A) \\approx 2 \\times 1.41421356 \\times 457.5 \\approx 1294.0193 $$\n问题要求将答案四舍五入到四位有效数字。\n$$ \\delta(A) \\approx 1294 $$\n该问题是在无量纲域 $[0,1]$ 上使用无量纲参数提出的，因此矩阵元素和最终的非正规性偏离度也是无量纲的。",
            "answer": "$$\\boxed{1294}$$"
        },
        {
            "introduction": "当使用迭代法求解线性系统时，一个至关重要的问题是如何判断求解过程何时可以停止。最常用的标准是相对残差，但它是否能真实反映解的精度呢？本练习将深入探讨相对残差判据的有效性及其局限性，特别是当应用于CFD中常见的非对称、非正规且病态的线性系统时。通过分析残差、误差以及矩阵条件数之间的关系，您将学会批判性地解读求解器的收敛报告，避免因误判收敛而得出错误的结论。",
            "id": "3970340",
            "problem": "一个线性代数系统 $A x = b$ 源于计算流体力学（CFD）中对跨音速机翼的可压缩纳维-斯托克斯方程进行的全隐式有限体积离散化。其中，$A \\in \\mathbb{R}^{N \\times N}$ 因迎风格式和线性化而是非对称且可能非正规的，$x \\in \\mathbb{R}^{N}$ 是守恒变量的更新量，$b \\in \\mathbb{R}^{N}$ 是残差驱动项。使用克雷洛夫子空间方法（例如，广义最小残差法 GMRES）来计算迭代解 $x_k$，其残差为 $r_k = b - A x_k$。当满足用户指定的容差时，求解器终止。在实践中，常用的停止测试是相对残差准则，它通过数据对残差进行归一化，并且易于计算。\n\n从线性系统中残差和误差的核心定义出发，并根据需要使用算子范数界，论证相对残差准则是什么，为什么它可能是充分的，以及在评估 CFD 中实际解的精度时它何时可能具有误导性。考虑矩阵条件数、非正规性、预处理、变量的缩放和无量纲化，以及代数误差与离散误差之间关系的影响。然后选择正确定义该准则并最准确地描述其在 CFD 线性求解中的充分性和局限性的选项。\n\n哪个选项是正确的？\n\nA. 停止测试将相对残差定义为 $\\|r_k\\|_2 / \\|b\\|_2 \\le \\tau$。由于 $r_k = A e_k$ 且 $e_k = x^\\star - x_k$，我们有 $\\|e_k\\|_2 \\le \\|A^{-1}\\|_2 \\|r_k\\|_2$ 以及 $\\|x^\\star\\|_2 \\ge \\|b\\|_2 / \\|A\\|_2$，因此 $\\|e_k\\|_2 / \\|x^\\star\\|_2 \\le \\kappa_2(A) \\, \\|r_k\\|_2 / \\|b\\|_2$，其中 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$。因此，当 $A$ 是良态的且变量被适当缩放时，该测试可以作为充分的终止条件，特别是当 $\\tau$ 的选择使得代数误差低于离散误差时。然而，对于病态或非正规的 $A$，小的 $\\|r_k\\|_2 / \\|b\\|_2$ 可能与大的前向误差并存，并且如果 $\\|b\\|_2$ 非常小或为零（在稳态线性化中很常见），该准则会变得不良定义或无信息量。在预处理求解中，监控预处理残差（例如 $\\|M^{-1} r_k\\|_2$）或物理加权范数可以更好地反映精度。该准则本身不能量化代数误差是否低于 CFD 离散误差。\n\nB. 停止测试将相对残差定义为 $\\|r_k\\|_2 / \\|b\\|_2 \\le \\tau$，这直接意味着 $\\|e_k\\|_2 \\le \\tau \\|b\\|_2$，而与 $A$ 的性质无关。因此，该准则普遍适用于 CFD 中的精度评估，并且不依赖于条件数、缩放或预处理。\n\nC. 停止测试将相对残差定义为 $\\|r_k\\|_2 / \\|b\\|_2 \\le \\tau$，并且因为 $\\mathbb{R}^N$ 上的所有范数都是等价的，所以无量纲化、变量缩放或网格拉伸对该准则的充分性没有影响。因此，总可以从一个小的相对残差推断出小的前向误差，这与 $A$ 无关。\n\nD. 对于对称正定矩阵 $A$，停止测试 $\\|r_k\\|_2 / \\|b\\|_2 \\le \\tau$ 保证 $\\|e_k\\|_A / \\|x^\\star\\|_A \\le \\tau$，其中 $\\|w\\|_A = \\sqrt{w^\\top A w}$，并且这个界与 $\\kappa_2(A)$ 无关。因此，即使在强各向异性的 CFD 问题中，该准则也足以确保解的准确性。",
            "solution": "首先对问题陈述进行验证，以确保其科学上合理、适定且客观。\n\n### 第 1 步：提取已知条件\n-   考虑一个线性代数系统 $A x = b$。\n-   该系统源于计算流体力学（CFD）中对跨音速机翼的可压缩纳维-斯托克斯方程进行的全隐式有限体积离散化。\n-   矩阵 $A \\in \\mathbb{R}^{N \\times N}$ 是非对称且可能非正规的。\n-   向量 $x \\in \\mathbb{R}^{N}$ 是守恒变量的更新量。\n-   向量 $b \\in \\mathbb{R}^{N}$ 是残差驱动项。\n-   该系统使用克雷洛夫子空间方法（例如 GMRES）求解。\n-   迭代解用 $x_k$ 表示。\n-   第 k 次迭代的残差为 $r_k = b - A x_k$。\n-   一个常用的停止测试是相对残差准则，它通过数据对残差进行归一化。\n-   任务是论证该准则的定义、充分性和局限性，并选择最能描述它的选项。\n\n### 第 2 步：使用提取的已知条件进行验证\n-   **科学依据：** 该问题牢固地植根于数值线性代数和计算流体力学这两个成熟领域。关于线性系统来源（基于纳维-斯托克斯方程的隐式有限体积法）、矩阵 $A$ 的性质（由迎风格式导致的非对称、非正规）以及克雷洛夫方法（如 GMRES）的使用，都是对现代 CFD 实践的标准和准确的描述。\n-   **适定性：** 该问题是一个概念分析问题。它是适定的，因为它要求基于线性代数的基本数学原理进行逻辑推导和评估。在此框架内存在一个正确且唯一的分析。\n-   **客观性：** 语言是技术性的、精确的，并且没有主观性。它描述了一种标准的数值方法及其应用背景。\n\n### 第 3 步：结论和行动\n问题陈述是有效的。这是一个应用数值分析中定义明确的概念性问题。可以继续进行求解过程。\n\n### 推导与分析\n\n问题的核心是将停止准则所测量的量（残差）与我们所关心的量（解的误差）联系起来。\n\n令 $x^\\star$ 为线性系统 $A x = b$ 的精确解。第 $k$ 次迭代解 $x_k$ 的误差定义为 $e_k = x^\\star - x_k$。残差为 $r_k = b - A x_k$。\n\n通过将 $b = A x^\\star$ 代入残差的定义，可以推导出误差和残差之间的基本关系：\n$$r_k = A x^\\star - A x_k = A(x^\\star - x_k) = A e_k$$\n这意味着残差是误差在线性变换 $A$ 下的像。为了评估误差 $e_k$，我们可以反转这个关系：\n$$e_k = A^{-1} r_k$$\n这在假设 $A$ 可逆的情况下成立，而对于唯一解 $x^\\star$ 的存在，这一点必须为真。\n\n问题描述了一个相对残差停止准则。一个常见且简单的形式是“通过数据对残差进行归一化”，它使用右端向量 $b$ 的范数进行归一化。令 $\\tau$ 为用户指定的容差。该准则为：\n$$ \\frac{\\|r_k\\|}{\\|b\\|} \\le \\tau $$\n在这里，$\\| \\cdot \\|$ 可以是任何向量范数，但 2-范数 $\\| \\cdot \\|_2$ 非常常用。除非另有说明，我们将假设使用 2-范数。\n\n为了理解这个准则对误差意味着什么，我们对等式 $e_k = A^{-1} r_k$ 取范数：\n$$ \\|e_k\\|_2 = \\|A^{-1} r_k\\|_2 $$\n使用诱导矩阵范数的性质，我们得到绝对误差的一个上界：\n$$ \\|e_k\\|_2 \\le \\|A^{-1}\\|_2 \\|r_k\\|_2 $$\n这个不等式表明，只有当因子 $\\|A^{-1}\\|_2$ 不太大时，小的残差范数 $\\|r_k\\|_2$ 才会导致小的误差范数 $\\|e_k\\|_2$。\n\n更有用的是相对误差 $\\|e_k\\|_2 / \\|x^\\star\\|_2$。为了界定这个值，我们需要 $\\|x^\\star\\|_2$ 的一个下界。从 $A x^\\star = b$ 可得 $\\|b\\|_2 = \\|A x^\\star\\|_2 \\le \\|A\\|_2 \\|x^\\star\\|_2$，这意味着：\n$$ \\|x^\\star\\|_2 \\ge \\frac{\\|b\\|_2}{\\|A\\|_2} $$\n结合 $\\|e_k\\|_2$ 的上界和 $\\|x^\\star\\|_2$ 的下界，我们得到：\n$$ \\frac{\\|e_k\\|_2}{\\|x^\\star\\|_2} \\le \\frac{\\|A^{-1}\\|_2 \\|r_k\\|_2}{\\|b\\|_2 / \\|A\\|_2} = (\\|A\\|_2 \\|A^{-1}\\|_2) \\frac{\\|r_k\\|_2}{\\|b\\|_2} $$\n项 $\\|A\\|_2 \\|A^{-1}\\|_2$ 是矩阵 $A$ 在 2-范数下的条件数，记为 $\\kappa_2(A)$。因此，我们得到了经典界：\n$$ \\frac{\\|e_k\\|_2}{\\|x^\\star\\|_2} \\le \\kappa_2(A) \\frac{\\|r_k\\|_2}{\\|b\\|_2} $$\n如果满足停止准则 $\\frac{\\|r_k\\|_2}{\\|b\\|_2} \\le \\tau$，那么相对误差的界为：\n$$ \\frac{\\|e_k\\|_2}{\\|x^\\star\\|_2} \\le \\kappa_2(A) \\tau $$\n\n这个界是理解该准则充分性和局限性的关键：\n1.  **充分性：** 如果 $A$ 是良态的，即 $\\kappa_2(A)$ 接近 1，那么相对误差与相对残差的量级相同。在这种情况下，$\\|r_k\\|_2/\\|b\\|_2 \\le \\tau$ 是解精度的良好代理。\n2.  **局限性 1：病态条件：** 如果 $A$ 是病态的，$\\kappa_2(A)$ 会非常大。在这种情况下，相对残差可以非常小（小的 $\\tau$），但相对误差的界 $\\kappa_2(A)\\tau$ 仍然可能很大。小的相对残差不保证小的相对误差。来自 CFD 离散化的矩阵通常是严重病态的。\n3.  **局限性 2：非正规性：** 这个界对任何矩阵都成立，包括非正规矩阵。然而，对于高度非正规的矩阵，残差范数 $\\|r_k\\|_2$ 的行为可能不代表误差范数 $\\|e_k\\|_2$ 的行为（例如，长时间的停滞）。涉及 $\\kappa_2(A)$ 的界可能是一个极端的过高估计，但小残差本身不足以保证小误差这一事实仍然成立。\n4.  **局限性 3：归一化：** 使用 $\\|b\\|_2$ 进行归一化在 $\\|b\\|_2$ 非常小的情况下是有问题的。在为稳态问题求解更新量 $x$ 的非线性迭代中，驱动项 $b$ 是全局残差的负值，随着模拟收敛，它会趋近于 0。一个非常小的 $\\|b\\|_2$ 会使该准则不良定义或过于敏感。一种替代方法是使用 $\\|r_0\\|_2 = \\|b - A x_0\\|_2$ 进行归一化，对于零初始猜测 $x_0 = 0_N$，这正是 $\\|b\\|_2$。\n5.  **局限性 4：缩放：** 使用标准的欧几里得范数同等对待残差向量的所有分量。然而，CFD 中的未知量向量（例如，密度、动量分量、能量）的分量具有不同的物理单位和尺度。一个合适的停止准则应该使用加权范数来反映不同变量的物理重要性，或者系统应事先进行适当的无量纲化和缩放。\n6.  **局限性 5：代数误差与离散误差：** 迭代求解器减小的是*代数误差* $e_k$，即它将 $x_k$ 推向离散系统 $Ax=b$ 的精确解 $x^\\star$。然而，$x^\\star$ 本身是真实物理过程解的一个近似，其差异是*离散误差*。将代数误差减小到远小于固有离散误差的水平，在计算上是浪费且不必要的。理想情况下，容差 $\\tau$ 的选择应与离散误差的估计量级相关联，但停止准则本身不提供此信息。\n7.  **预处理：** 如果使用预条件子 $M$（例如，求解 $M^{-1}Ax = M^{-1}b$），收敛行为由 $\\kappa_2(M^{-1}A)$ 决定。监控预处理残差（例如 $\\|M^{-1}r_k\\|_2$）通常更有意义，因为满足对此量的容差可能更好地与误差范数的减小相关联。\n\n### 逐项分析\n\n**A. 停止测试将相对残差定义为 $\\|r_k\\|_2 / \\|b\\|_2 \\le \\tau$。由于 $r_k = A e_k$ 且 $e_k = x^\\star - x_k$，我们有 $\\|e_k\\|_2 \\le \\|A^{-1}\\|_2 \\|r_k\\|_2$ 以及 $\\|x^\\star\\|_2 \\ge \\|b\\|_2 / \\|A\\|_2$，因此 $\\|e_k\\|_2 / \\|x^\\star\\|_2 \\le \\kappa_2(A) \\, \\|r_k\\|_2 / \\|b\\|_2$，其中 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$。因此，当 $A$ 是良态的且变量被适当缩放时，该测试可以作为充分的终止条件，特别是当 $\\tau$ 的选择使得代数误差低于离散误差时。然而，对于病态或非正规的 $A$，小的 $\\|r_k\\|_2 / \\|b\\|_2$ 可能与大的前向误差并存，并且如果 $\\|b\\|_2$ 非常小或为零（在稳态线性化中很常见），该准则会变得不良定义或无信息量。在预处理求解中，监控预处理残差（例如 $\\|M^{-1} r_k\\|_2$）或物理加权范数可以更好地反映精度。该准则本身不能量化代数误差是否低于 CFD 离散误差。**\n\n该选项正确地定义了停止准则，并准确地推导了通过条件数 $\\kappa_2(A)$ 将相对误差与相对残差联系起来的标准界。它正确地指出，对于良态问题，该准则是充分的。至关重要的是，它列出了推导中讨论的所有主要局限性：病态和非正规矩阵的问题、稳态求解中 $\\|b\\|_2$ 过小的问题、缩放的重要性、预处理和加权范数的作用，以及代数误差和离散误差之间的区别。该分析在所有方面都是全面且正确的。\n\n结论：**正确**\n\n**B. 停止测试将相对残差定义为 $\\|r_k\\|_2 / \\|b\\|_2 \\le \\tau$，这直接意味着 $\\|e_k\\|_2 \\le \\tau \\|b\\|_2$，而与 $A$ 的性质无关。因此，该准则普遍适用于 CFD 中的精度评估，并且不依赖于条件数、缩放或预处理。**\n\n该选项根本上是错误的。推论 $\\|r_k\\|_2 / \\|b\\|_2 \\le \\tau \\implies \\|e_k\\|_2 \\le \\tau \\|b\\|_2$ 是错误的。从推导中我们有 $\\|e_k\\|_2 \\le \\|A^{-1}\\|_2 \\|r_k\\|_2$。停止条件给出 $\\|r_k\\|_2 \\le \\tau \\|b\\|_2$。将它们结合起来得到 $\\|e_k\\|_2 \\le \\|A^{-1}\\|_2 \\tau \\|b\\|_2$。选项 B 错误地忽略了因子 $\\|A^{-1}\\|_2$，其大小是条件数的关键部分。这一忽略导致了错误的结论，即该准则普遍适用且独立于矩阵性质，这与事实恰恰相反。\n\n结论：**不正确**\n\n**C. 停止测试将相对残差定义为 $\\|r_k\\|_2 / \\|b\\|_2 \\le \\tau$，并且因为 $\\mathbb{R}^N$ 上的所有范数都是等价的，所以无量纲化、变量缩放或网格拉伸对该准则的充分性没有影响。因此，总可以从一个小的相对残差推断出小的前向误差，这与 $A$ 无关。**\n\n该选项误用了范数等价的概念。虽然在有限维空间 $\\mathbb{R}^N$ 中，对于任何两个范数 $\\| \\cdot \\|_\\alpha$ 和 $\\| \\cdot \\|_\\beta$，确实存在常数 $c_1, c_2 > 0$ 使得对所有 $v \\in \\mathbb{R}^N$ 都有 $c_1 \\|v\\|_\\alpha \\le \\|v\\|_\\beta \\le c_2 \\|v\\|_\\alpha$，但这些常数 $c_1$ 和 $c_2$ 可能远不为 1。变量缩放和网格拉伸直接影响这些等价常数。对一个具有物理尺度差异巨大的分量的向量使用未加权的范数，等同于使用一个缩放得很差的范数，其与一个物理上有意义的范数之间的等价常数很差。这对准则的充分性有显著影响。此外，“与 A 无关”地从小的残差推断出小的误差的说法是错误的，正如对 $\\kappa_2(A)$ 的依赖性所示。\n\n结论：**不正确**\n\n**D. 对于对称正定矩阵 $A$，停止测试 $\\|r_k\\|_2 / \\|b\\|_2 \\le \\tau$ 保证 $\\|e_k\\|_A / \\|x^\\star\\|_A \\le \\tau$，其中 $\\|w\\|_A = \\sqrt{w^\\top A w}$，并且这个界与 $\\kappa_2(A)$ 无关。因此，即使在强各向异性的 CFD 问题中，该准则也足以确保解的准确性。**\n\n该选项不正确有两个主要原因。首先，它假设矩阵 $A$ 是对称正定（SPD）的。问题陈述明确说明 $A$ 是**非对称**的，这对于涉及迎风格式的 CFD 问题是典型情况。因此，该选项分析的情况与问题陈述无关。其次，即使对于 SPD 矩阵，该数学论断也是错误的。如详细推导所示，紧界是 $\\frac{\\|e_k\\|_A}{\\|x^\\star\\|_A} \\le \\sqrt{\\kappa_2(A)} \\frac{\\|r_k\\|_2}{\\|b\\|_2}$。该关系并非与条件数无关，而是依赖于 $\\sqrt{\\kappa_2(A)}$。因此，该选项的核心论断在数学上是不正确的。\n\n结论：**不正确**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "对于大规模CFD模拟，预处理技术是加速克雷洛夫方法收敛、缩短计算时间的关键。然而，预处理本身也可能引入新的复杂性和潜在陷阱。本练习聚焦于一种常见且微妙的风险：当使用左预处理器时，被监控的“预处理残差”可能已经变得很小，给人以收敛的假象，但真实的“物理残差”可能仍然很大。通过定量分析真实残差与预处理残差之间的关系，您将掌握识别和规避此类风险的能力，确保预处理技术在加速计算的同时，不会牺牲解的可靠性。",
            "id": "3970361",
            "problem": "在计算流体力学（CFD）中，对跨音速机翼进行稳态可压缩Navier–Stokes方程的隐式Newton–Krylov求解时，第$k$次迭代的线性子问题形式为 $A x = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是残差关于状态变量的雅可比矩阵，$x \\in \\mathbb{R}^{n}$ 是Newton校正量，$b \\in \\mathbb{R}^{n}$ 是非线性残差。一个非奇异左预条件子 $M \\in \\mathbb{R}^{n \\times n}$ 是通过基于物理的分块分解和行缩放构建的，旨在近似 $A$ 并加速Krylov收敛。广义最小残差（GMRES）方法被应用于该左预处理系统。将真实残差表示为 $r_k = b - A x_k$，预处理残差表示为 $\\tilde{r}_k = M^{-1} r_k$。使用欧几里得范数，并且 $M$ 和 $A$ 都是实数矩阵，其中由于速度、压力和温度之间的混合单位缩放，$M$ 可能是高度非对称和病态的。\n\n假设预条件子的算子$2$-范数为 $\\|M\\|_2 = 10^{5}$，其条件数为 $\\kappa_2(M) = 10^{6}$。一位实践者监测 $\\|\\tilde{r}_k\\|_2$ 并在 $\\|\\tilde{r}_k\\|_2 \\le \\tau$（其中 $\\tau = 10^{-8}$）时停止，期望这也意味着真实残差 $\\|r_k\\|_2$ 也很小。\n\n下列关于预处理残差 $\\tilde{r}_k$ 和真实残差 $r_k$ 之间的差异，以及监测 $\\|\\tilde{r}_k\\|_2$ 时可能导致误导性停止的风险的陈述中，哪些是正确的？\n\nA. 在左预处理广义最小残差（GMRES）方法中，算法最小化的是 $\\|\\tilde{r}_k\\|_2$ 而不是 $\\|r_k\\|_2$，因此如果 $\\|M\\|_2$ 很大，仅基于 $\\|\\tilde{r}_k\\|_2$ 的停止准则可能具有误导性。\n\nB. 对于任何非奇异预条件子 $M$，总是有 $\\|\\tilde{r}_k\\|_2 \\le \\|r_k\\|_2$，因此监测 $\\|\\tilde{r}_k\\|_2$ 是保守的。\n\nC. 等式 $\\tilde{r}_k = r_k$ 对所有迭代 $k$ 成立的充分必要条件是 $M$ 为单位矩阵。\n\nD. 在右预处理Krylov方法中，自然报告和最小化的残差是 $r_k$，基于 $\\|r_k\\|_2$ 的停止准则不受 $\\|M\\|_2$ 大小的直接影响。\n\nE. 如果 $M$ 非奇异但极端病态，可能存在某些迭代使得 $\\|\\tilde{r}_k\\|_2 \\le \\tau$ 但 $\\|r_k\\|_2$ 超过 $\\tau$ 一个数量级为 $\\|M\\|_2$ 的因子，这带来了提前停止的风险。",
            "solution": "该问题陈述已经过验证并且被认为是合理的。它描述了在计算流体力学问题中应用预处理Krylov子空间方法的一个标准且重要的场景。我们可以开始进行分析。\n\n问题的核心在于真实残差 $r_k = b - A x_k$ 与左预处理残差 $\\tilde{r}_k = M^{-1} r_k$ 之间的关系。这里，$x_k$ 是线性系统 $Ax=b$ 解的第 $k$ 个迭代解。广义最小残差（GMRES）方法在应用于左预处理系统 $M^{-1} A x = M^{-1} b$ 时，会生成一个迭代序列 $x_k$，该序列在仿射Krylov子空间上最小化预处理残差的欧几里得范数 $\\|\\tilde{r}_k\\|_2$。\n\n根据定义 $\\tilde{r}_k = M^{-1} r_k$，我们可以将真实残差写为 $r_k = M \\tilde{r}_k$。利用诱导矩阵范数的性质，我们可以用预处理残差的范数 $\\|\\tilde{r}_k\\|_2$ 来建立真实残差范数 $\\|r_k\\|_2$ 的界。\n\n关系式 $r_k = M \\tilde{r}_k$ 立即导出不等式：\n$$ \\|r_k\\|_2 = \\|M \\tilde{r}_k\\|_2 \\le \\|M\\|_2 \\|\\tilde{r}_k\\|_2 $$\n类似地，由 $\\tilde{r}_k = M^{-1} r_k$，我们有：\n$$ \\|\\tilde{r}_k\\|_2 = \\|M^{-1} r_k\\|_2 \\le \\|M^{-1}\\|_2 \\|r_k\\|_2 $$\n这可以被重新整理，得到 $\\|r_k\\|_2$ 的一个下界：\n$$ \\|r_k\\|_2 \\ge \\frac{\\|\\tilde{r}_k\\|_2}{\\|M^{-1}\\|_2} $$\n预条件子的条件数由 $\\kappa_2(M) = \\|M\\|_2 \\|M^{-1}\\|_2$ 给出。因此，我们可以将 $\\|M^{-1}\\|_2$ 表示为 $\\|M^{-1}\\|_2 = \\kappa_2(M) / \\|M\\|_2$。结合这些结果，我们得到双边不等式：\n$$ \\frac{\\|M\\|_2}{\\kappa_2(M)} \\|\\tilde{r}_k\\|_2 \\le \\|r_k\\|_2 \\le \\|M\\|_2 \\|\\tilde{r}_k\\|_2 $$\n使用给定的数值 $\\|M\\|_2 = 10^5$ 和 $\\kappa_2(M) = 10^6$，不等式变为：\n$$ \\frac{10^5}{10^6} \\|\\tilde{r}_k\\|_2 \\le \\|r_k\\|_2 \\le 10^5 \\|\\tilde{r}_k\\|_2 $$\n$$ 0.1 \\|\\tilde{r}_k\\|_2 \\le \\|r_k\\|_2 \\le 10^5 \\|\\tilde{r}_k\\|_2 $$\n停止准则是 $\\|\\tilde{r}_k\\|_2 \\le \\tau$，其中 $\\tau = 10^{-8}$。在终止点，当 $\\|\\tilde{r}_k\\|_2$ 的数量级为 $\\tau$ 时，真实残差范数 $\\|r_k\\|_2$ 的界为：\n$$ 0.1 \\times 10^{-8} \\le \\|r_k\\|_2 \\le 10^5 \\times 10^{-8} $$\n$$ 10^{-9} \\le \\|r_k\\|_2 \\le 10^{-3} $$\n这表明，尽管预处理残差很小（$10^{-8}$），真实残差可能大至 $10^{-3}$。这个五个数量级的差异凸显了仅监测预处理残差的潜在危险。\n\n现在，我们评估每个选项。\n\n**A. 在左预处理广义最小残差（GMRES）方法中，算法最小化的是 $\\|\\tilde{r}_k\\|_2$ 而不是 $\\|r_k\\|_2$，因此如果 $\\|M\\|_2$ 很大，仅基于 $\\|\\tilde{r}_k\\|_2$ 的停止准则可能具有误导性。**\n应用于系统 $M^{-1}Ax = M^{-1}b$ 的GMRES方法会找到相应Krylov子空间中的迭代解 $x_k$，该解最小化了系统残差的范数，这正是 $\\|\\tilde{r}_k\\|_2 = \\|M^{-1}(b-Ax_k)\\|_2$。这与最小化真实残差范数 $\\|r_k\\|_2 = \\|b-Ax_k\\|_2$ 是不同的。正如我们推导出的不等式 $\\|r_k\\|_2 \\le \\|M\\|_2 \\|\\tilde{r}_k\\|_2$ 所示，如果 $\\|M\\|_2$ 很大（这里是 $10^5$），一个小的 $\\|\\tilde{r}_k\\|_2$ 并不能保证一个小的 $\\|r_k\\|_2$。这种产生巨大差异的可能性使得停止准则具有误导性。\n**结论：正确。**\n\n**B. 对于任何非奇异预条件子 $M$，总是有 $\\|\\tilde{r}_k\\|_2 \\le \\|r_k\\|_2$，因此监测 $\\|\\tilde{r}_k\\|_2$ 是保守的。**\n该陈述声称 $\\|\\tilde{r}_k\\|_2 \\le \\|r_k\\|_2$ 总是成立。这等价于对任意向量 $r_k$ 都有 $\\|M^{-1} r_k\\|_2 \\le \\|r_k\\|_2$。这个不等式仅在算子范数 $\\|M^{-1}\\|_2 \\le 1$ 时成立。根据给定数据，$\\kappa_2(M) = 10^6$ 且 $\\|M\\|_2 = 10^5$，这得出 $\\|M^{-1}\\|_2 = \\kappa_2(M) / \\|M\\|_2 = 10^6 / 10^5 = 10$。由于 $\\|M^{-1}\\|_2 = 10 > 1$，$\\|\\tilde{r}_k\\|_2$ 有可能比 $\\|r_k\\|_2$ 大得多（最多大10倍）。因此，该陈述是错误的，并且监测预处理残差不一定是保守的。\n**结论：不正确。**\n\n**C. 等式 $\\tilde{r}_k = r_k$ 对所有迭代 $k$ 成立的充分必要条件是 $M$ 为单位矩阵。**\n这是一个“当且仅当”的陈述。\n($\\Leftarrow$) 如果 $M$ 是单位矩阵（$M=I$），那么它的逆 $M^{-1}$ 也是单位矩阵。定义 $\\tilde{r}_k = M^{-1} r_k$ 变为 $\\tilde{r}_k = I r_k = r_k$。这对所有 $k$ 都成立。\n($\\Rightarrow$) 如果对所有迭代 $k$，都有 $\\tilde{r}_k = r_k$，那么根据定义，$M^{-1} r_k = r_k$。这可以写成 $(M^{-1} - I)r_k = 0$。这意味着对于每次迭代 $k$，残差向量 $r_k$ 必须是 $M^{-1}$ 对应于特征值 $1$ 的特征向量。对于一个一般性问题，在Krylov迭代过程中生成的残差向量序列 $r_k$ 不被限制在单一方向上（除非问题是平凡的或在一步内收敛）。为了使等式在不考虑特定矩阵 $A$ 和起始向量 $x_0$ 的情况下（即，对任何可能的非零残差序列 $r_k$）都成立，矩阵算子 $(M^{-1} - I)$ 必须是零矩阵。这意味着 $M^{-1} = I$，因此 $M=I$。\n**结论：正确。**\n\n**D. 在右预处理Krylov方法中，自然报告和最小化的残差是 $r_k$，基于 $\\|r_k\\|_2$ 的停止准则不受 $\\|M\\|_2$ 大小的直接影响。**\n在右预处理中，我们求解系统 $A M^{-1} y = b$ 以得到变量 $y$，然后通过 $x = M^{-1} y$ 恢复解。像GMRES这样的Krylov方法应用于此系统时，将最小化其残差的范数，即 $\\|b - (A M^{-1}) y_k\\|_2$。代入 $x_k = M^{-1} y_k$，这变为 $\\|b - A x_k\\|_2$，这正是真实残差的范数 $\\|r_k\\|_2$。因此，被最小化的量是真实残差范数。所以，基于 $\\|r_k\\|_2$ 的停止准则是收敛的直接度量。$\\|M\\|_2$ 的大小影响算子 $A M^{-1}$，从而影响收敛速度，但与左预处理情况不同，它不作为被最小化的残差和真实残差之间的缩放因子出现。在这个意义上，停止准则不受其“直接影响”。\n**结论：正确。**\n\n**E. 如果 $M$ 非奇异但极端病态，可能存在某些迭代使得 $\\|\\tilde{r}_k\\|_2 \\le \\tau$ 但 $\\|r_k\\|_2$ 超过 $\\tau$ 一个数量级为 $\\|M\\|_2$ 的因子，这带来了提前停止的风险。**\n这个陈述从我们最初的分析中直接得出。真实残差范数的上界是 $\\|r_k\\|_2 \\le \\|M\\|_2 \\|\\tilde{r}_k\\|_2$。如果满足停止准则 $\\|\\tilde{r}_k\\|_2 \\le \\tau$（例如，$\\|\\tilde{r}_k\\|_2 = \\tau$），那么真实残差范数 $\\|r_k\\|_2$ 可能大至 $\\|M\\|_2 \\tau$。这个值超过了容差 $\\tau$ 一个因子 $\\|M\\|_2$。给定 $\\|M\\|_2=10^5$，这个因子就是 $10^5$。这正是“数量级为 $\\|M\\|_2$”的意思。这种可能性构成了提前终止的严重风险，即求解器停止时真实残差远未收敛。高的条件数 $\\kappa_2(M)$ 扩大了 $\\|r_k\\|_2$ 的不确定性范围，但产生巨大真实残差的风险由上界决定，而上界依赖于 $\\|M\\|_2$。\n**结论：正确。**",
            "answer": "$$\\boxed{ACDE}$$"
        }
    ]
}