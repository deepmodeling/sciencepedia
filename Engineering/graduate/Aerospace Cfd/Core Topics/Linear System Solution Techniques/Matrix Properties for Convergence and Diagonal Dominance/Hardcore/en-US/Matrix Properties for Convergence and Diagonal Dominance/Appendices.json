{
    "hands_on_practices": [
        {
            "introduction": "While diagonal dominance is a key goal for ensuring convergence, not all forms of it guarantee success. This practice  uses a simple, pure-convection model on a periodic domain to construct a matrix that is only weakly diagonally dominant. By analyzing its Gershgorin disks and the spectral radius, $\\rho$, of the corresponding Jacobi iteration matrix, you will discover why this condition is insufficient for the guaranteed convergence of this classic iterative solver.",
            "id": "3975445",
            "problem": "In Computational Fluid Dynamics (CFD), consider a steady, convection-dominated transport of a passive scalar along a closed, periodic one-dimensional loop that models a simplified bleed-air recirculation path in an aerospace system. The loop is discretized into $3$ equal control volumes, indexed as $i = 1, 2, 3$, with constant positive mass flux $F  0$ transporting the scalar in the direction $1 \\to 2 \\to 3 \\to 1$. Assume there is no source term and no diffusion, and use the first-order upwind finite volume method for the convective flux at each face.\n\nStarting from conservation at each control volume, derive the $3 \\times 3$ linear system matrix $A$ such that $A \\mathbf{u} = \\mathbf{0}$, where $\\mathbf{u} = (u_1, u_2, u_3)^{\\mathsf{T}}$ are the cell-centered unknowns. Using the matrix $A$, perform the following:\n\n1. Show that $A$ is weakly diagonally dominant by rows and compute the Gershgorin disks. Demonstrate that the union of these disks overlaps the origin.\n2. Form the Jacobi iteration matrix for solving $A \\mathbf{u} = \\mathbf{b}$ and determine its spectral radius $\\rho$. Explain why the convergence of the Jacobi method may fail in this configuration.\n\nProvide the value of the spectral radius $\\rho$ as your final answer. No rounding is required, and no physical units are involved. Your reasoning must start from the discrete conservation statement and an upwind flux approximation, and all mathematical derivations must be shown.",
            "solution": "**Derivation of the System Matrix $A$**\n\nThe finite volume method is based on the conservation principle applied to each control volume (CV). For a steady-state problem with no sources, the conservation of a scalar quantity $u$ in a control volume $i$ states that the sum of the fluxes across its faces is zero. The flux is due to convection only.\n\nThe net flux for CV $i$ is the sum of fluxes through its faces. Let's adopt the convention that outflow is positive and inflow is negative. The convective flux across a face is given by the product of the mass flux $F$ and the scalar value at the face, $u_{\\text{face}}$.\n$$ \\sum_{\\text{faces}} F_{\\text{face}} u_{\\text{face}} = 0 $$\nWith a constant mass flux $F$ and flow direction $1 \\to 2 \\to 3 \\to 1$, the equation for CV $i$ is:\n$$ F u_{\\text{east face}} - F u_{\\text{west face}} = 0 $$\nThe first-order upwind scheme dictates that the scalar value at a face, $u_{\\text{face}}$, is taken from the cell center of the upstream control volume. The flow is from $i \\to i+1$.\n\nFor CV $i$, the \"east\" face is between $i$ and $i+1$, and the \"west\" face is between $i-1$ and $i$.\n- The upstream cell for the east face is cell $i$. So, $u_{\\text{east face}} = u_i$.\n- The upstream cell for the west face is cell $i-1$. So, $u_{\\text{west face}} = u_{i-1}$.\n\nThe general discrete equation for CV $i$ is:\n$$ F u_i - F u_{i-1} = 0 $$\n\nApplying this to each of the $3$ control volumes with periodic boundary conditions:\n- **CV 1 ($i=1$)**: The upstream cell is CV 3. Thus, $u_{i-1} = u_3$. The equation is $F u_1 - F u_3 = 0$.\n- **CV 2 ($i=2$)**: The upstream cell is CV 1. Thus, $u_{i-1} = u_1$. The equation is $F u_2 - F u_1 = 0$.\n- **CV 3 ($i=3$)**: The upstream cell is CV 2. Thus, $u_{i-1} = u_2$. The equation is $F u_3 - F u_2 = 0$.\n\nThis system of linear equations can be written in matrix form $A \\mathbf{u} = \\mathbf{0}$:\n$$ \\begin{pmatrix} F  0  -F \\\\ -F  F  0 \\\\ 0  -F  F \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nThus, the system matrix $A$ is:\n$$ A = \\begin{pmatrix} F  0  -F \\\\ -F  F  0 \\\\ 0  -F  F \\end{pmatrix} $$\n\n**Task 1: Diagonal Dominance and Gershgorin Disks**\n\nA matrix $A$ is weakly diagonally dominant by rows if $|a_{ii}| \\ge \\sum_{j \\ne i} |a_{ij}|$ for all rows $i$.\nLet's examine matrix $A$, assuming $F  0$:\n- **Row 1**: $|a_{11}| = |F| = F$. The sum of magnitudes of off-diagonal elements is $\\sum_{j \\ne 1} |a_{1j}| = |0| + |-F| = F$. Thus, $|a_{11}| = \\sum_{j \\ne 1} |a_{1j}|$.\n- **Row 2**: $|a_{22}| = |F| = F$. The sum of magnitudes of off-diagonal elements is $\\sum_{j \\ne 2} |a_{2j}| = |-F| + |0| = F$. Thus, $|a_{22}| = \\sum_{j \\ne 2} |a_{2j}|$.\n- **Row 3**: $|a_{33}| = |F| = F$. The sum of magnitudes of off-diagonal elements is $\\sum_{j \\ne 3} |a_{3j}| = |0| + |-F| = F$. Thus, $|a_{33}| = \\sum_{j \\ne 3} |a_{3j}|$.\n\nSince the equality $|a_{ii}| = \\sum_{j \\ne i} |a_{ij}|$ holds for all rows, the matrix $A$ is weakly diagonally dominant.\n\nAccording to Gershgorin's circle theorem, every eigenvalue of $A$ lies within the union of its Gershgorin disks. The $i$-th disk, $D_i$, is centered at $a_{ii}$ with radius $R_i = \\sum_{j \\ne i} |a_{ij}|$.\n- **Disk 1 ($i=1$)**: Center $C_1 = a_{11} = F$. Radius $R_1 = |a_{12}| + |a_{13}| = |0| + |-F| = F$. The disk is defined by $|z - F| \\le F$ in the complex plane.\n- **Disk 2 ($i=2$)**: Center $C_2 = a_{22} = F$. Radius $R_2 = |a_{21}| + |a_{23}| = |-F| + |0| = F$. The disk is defined by $|z - F| \\le F$.\n- **Disk 3 ($i=3$)**: Center $C_3 = a_{33} = F$. Radius $R_3 = |a_{31}| + |a_{32}| = |0| + |-F| = F$. The disk is defined by $|z - F| \\le F$.\n\nAll three disks are identical. The union of the disks is the single disk centered at $F$ on the real axis with radius $F$. To show this disk overlaps the origin, we check if $z=0$ is in the disk:\n$$ |0 - F| \\le F \\implies |-F| \\le F \\implies F \\le F $$\nThis inequality is true. The origin $z=0$ lies on the boundary of the disk. This is consistent with the fact that $A$ is singular (sum of each row is $0$, so $\\lambda=0$ is an eigenvalue), and all eigenvalues must lie in the union of the Gershgorin disks.\n\n**Task 2: Jacobi Iteration and Spectral Radius**\n\nThe Jacobi method for solving $A\\mathbf{u} = \\mathbf{b}$ is an iterative scheme. We decompose $A$ as $A = D + L + U$, where $D$ is the diagonal part of $A$, and $L$ and $U$ are the strictly lower and upper triangular parts, respectively. The iteration is given by:\n$$ \\mathbf{u}^{(k+1)} = -D^{-1}(L+U) \\mathbf{u}^{(k)} + D^{-1}\\mathbf{b} $$\nThe Jacobi iteration matrix is $T_J = -D^{-1}(L+U)$.\n\nFrom our matrix $A$:\n$$ D = \\begin{pmatrix} F  0  0 \\\\ 0  F  0 \\\\ 0  0  F \\end{pmatrix}, \\quad L+U = \\begin{pmatrix} 0  0  -F \\\\ -F  0  0 \\\\ 0  -F  0 \\end{pmatrix} $$\nThe inverse of the diagonal matrix $D$ is:\n$$ D^{-1} = \\begin{pmatrix} 1/F  0  0 \\\\ 0  1/F  0 \\\\ 0  0  1/F \\end{pmatrix} = \\frac{1}{F}I $$\nNow, we compute the Jacobi matrix $T_J$:\n$$ T_J = -D^{-1}(L+U) = -\\left( \\frac{1}{F}I \\right) \\begin{pmatrix} 0  0  -F \\\\ -F  0  0 \\\\ 0  -F  0 \\end{pmatrix} = -\\frac{1}{F} \\begin{pmatrix} 0  0  -F \\\\ -F  0  0 \\\\ 0  -F  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  1 \\\\ 1  0  0 \\\\ 0  1  0 \\end{pmatrix} $$\nThe spectral radius, $\\rho(T_J)$, is the maximum absolute value of the eigenvalues of $T_J$. To find the eigenvalues $\\lambda$, we solve the characteristic equation $\\det(T_J - \\lambda I) = 0$:\n$$ \\det \\begin{pmatrix} -\\lambda  0  1 \\\\ 1  -\\lambda  0 \\\\ 0  1  -\\lambda \\end{pmatrix} = 0 $$\n$$ (-\\lambda) ((-\\lambda)(-\\lambda) - (0)(1)) - (0) + (1) ((1)(1) - (-\\lambda)(0)) = 0 $$\n$$ -\\lambda(\\lambda^2) + 1 = 0 $$\n$$ \\lambda^3 = 1 $$\nThe eigenvalues of $T_J$ are the three cube roots of unity:\n$$ \\lambda_1 = 1 $$\n$$ \\lambda_2 = \\exp\\left(\\frac{i2\\pi}{3}\\right) = -\\frac{1}{2} + i\\frac{\\sqrt{3}}{2} $$\n$$ \\lambda_3 = \\exp\\left(\\frac{i4\\pi}{3}\\right) = -\\frac{1}{2} - i\\frac{\\sqrt{3}}{2} $$\nThe absolute value of each eigenvalue is $1$:\n$$ |\\lambda_1| = 1, \\quad |\\lambda_2| = \\sqrt{\\left(-\\frac{1}{2}\\right)^2 + \\left(\\frac{\\sqrt{3}}{2}\\right)^2} = 1, \\quad |\\lambda_3| = \\sqrt{\\left(-\\frac{1}{2}\\right)^2 + \\left(-\\frac{\\sqrt{3}}{2}\\right)^2} = 1 $$\nThe spectral radius is the maximum of these values:\n$$ \\rho(T_J) = \\max\\{1, 1, 1\\} = 1 $$\n\nThe Jacobi method is guaranteed to converge for any initial guess if and only if the spectral radius of its iteration matrix is strictly less than $1$ (i.e., $\\rho(T_J)  1$). Since $\\rho(T_J) = 1$, the method is not guaranteed to converge and, in general, will fail. This failure is a direct consequence of the physical and mathematical nature of the problem. The matrix $A$ is singular because the underlying physical problem (pure convection on a closed loop) conserves the scalar, meaning there is no unique solution. If $\\mathbf{u}$ is a solution, so is $\\mathbf{u} + c(1, 1, 1)^{\\mathsf{T}}$ for any constant $c$. The singularity of $A$ and the fact that $\\rho(T_J) = 1$ are intrinsically linked. Specifically, the eigenvalue $\\lambda=1$ of $T_J$ corresponds to a stationary error mode, preventing convergence to a unique solution.",
            "answer": "$$ \\boxed{1} $$"
        },
        {
            "introduction": "The choice of discretization scheme has profound implications for the properties of the resulting linear system and the physical realism of the solution. This exercise  investigates a scenario where a standard second-order central difference scheme is applied to an advection-dominated flow, a common challenge in aerospace applications. You will see firsthand how this choice can lead to a matrix that lacks the necessary diagonal dominance, causing a violation of the discrete maximum principle and producing non-physical oscillations.",
            "id": "3975490",
            "problem": "Consider a one-dimensional, steady advection–diffusion transport of a passive scalar in Aerospace Computational Fluid Dynamics (CFD), modeled on the nondimensional interval $x \\in [0,1]$ with Dirichlet boundary data $T(0)=1$ and $T(1)=0$. The governing equation is the classical conservation-law form for constant coefficients,\n$$ a \\,\\frac{dT}{dx} - \\varepsilon \\,\\frac{d^{2}T}{dx^{2}} = 0, $$\nwhere $a0$ is a constant advection speed and $\\varepsilon0$ is a constant diffusion coefficient. Discretize the differential operator using second-order centered differences for both the first derivative and second derivative on a uniform grid with $N=5$ nodes, spacing $h=1/4$, and interior unknowns at $i=1,2,3$. For this discretization, the interior algebraic equation at node $i$ takes the generic form\n$$ \\left(-\\frac{\\varepsilon}{h^{2}} - \\frac{a}{2h}\\right)T_{i-1} + \\left(\\frac{2\\varepsilon}{h^{2}}\\right)T_{i} + \\left(-\\frac{\\varepsilon}{h^{2}} + \\frac{a}{2h}\\right)T_{i+1} = 0, $$\nwith the boundary values $T_{0}=1$ and $T_{4}=0$. Use the parameter values $a=1$ and $\\varepsilon=0.01$. From first principles of conservation and discrete approximation, assemble the resulting linear system for $T_{1},T_{2},T_{3}$, and solve it. Then quantify the discrete maximum principle violation by computing the overshoot magnitude\n$$ \\delta \\equiv \\max\\{T_{1},T_{2},T_{3}\\} - \\max\\{T_{0},T_{4}\\}. $$\nRound your final numerical value of $\\delta$ to four significant figures and express it without units.",
            "solution": "The problem requires the analysis of a one-dimensional, steady advection-diffusion equation on the domain $x \\in [0,1]$:\n$$ a \\,\\frac{dT}{dx} - \\varepsilon \\,\\frac{d^{2}T}{dx^{2}} = 0 $$\nwith Dirichlet boundary conditions $T(0)=1$ and $T(1)=0$. The physical parameters are the advection speed $a=1$ and the diffusion coefficient $\\varepsilon=0.01$.\n\nThe spatial domain is discretized using a uniform grid with $N=5$ nodes, indexed $i=0, 1, 2, 3, 4$. The grid spacing is $h = \\frac{1}{4} = 0.25$. The unknown temperatures are at the interior nodes $T_1$, $T_2$, and $T_3$, corresponding to positions $x_1=0.25$, $x_2=0.5$, and $x_3=0.75$. The boundary values are given as $T_0 = T(x_0=0) = 1$ and $T_4 = T(x_4=1) = 0$.\n\nThe problem specifies using second-order centered differences for both derivatives, resulting in the following generic algebraic equation for an interior node $i$:\n$$ \\left(-\\frac{\\varepsilon}{h^{2}} - \\frac{a}{2h}\\right)T_{i-1} + \\left(\\frac{2\\varepsilon}{h^{2}}\\right)T_{i} + \\left(-\\frac{\\varepsilon}{h^{2}} + \\frac{a}{2h}\\right)T_{i+1} = 0 $$\nThis can be rewritten as:\n$$ C_{west} T_{i-1} + C_{center} T_i + C_{east} T_{i+1} = 0 $$\nwhere $C_{west} = -\\frac{\\varepsilon}{h^2} - \\frac{a}{2h}$, $C_{center} = \\frac{2\\varepsilon}{h^2}$, and $C_{east} = -\\frac{\\varepsilon}{h^2} + \\frac{a}{2h}$.\n\nAn important nondimensional parameter is the cell Péclet number, $Pe_h = \\frac{ah}{\\varepsilon}$. For this problem, $Pe_h = \\frac{1 \\times 0.25}{0.01} = 25$. Since $Pe_h > 2$, the use of a second-order centered difference scheme is known to potentially violate the discrete maximum principle, leading to non-physical oscillations, which is the phenomenon being investigated.\n\nWe first compute the numerical values of the coefficients using the given parameters $a=1$, $\\varepsilon=0.01$, and $h=0.25$:\n$$ \\frac{\\varepsilon}{h^2} = \\frac{0.01}{(0.25)^2} = \\frac{0.01}{0.0625} = 0.16 $$\n$$ \\frac{a}{2h} = \\frac{1}{2 \\times 0.25} = \\frac{1}{0.5} = 2 $$\nThe coefficients are:\n$$ C_{west} = -0.16 - 2 = -2.16 $$\n$$ C_{center} = 2 \\times 0.16 = 0.32 $$\n$$ C_{east} = -0.16 + 2 = 1.84 $$\nThe discrete equation for each interior node $i$ is:\n$$ -2.16 T_{i-1} + 0.32 T_i + 1.84 T_{i+1} = 0 $$\nWe now assemble the system of linear algebraic equations for the unknowns $T_1$, $T_2$, and $T_3$.\n\nFor node $i=1$:\n$$ -2.16 T_0 + 0.32 T_1 + 1.84 T_2 = 0 $$\nSubstituting the boundary condition $T_0=1$:\n$$ -2.16(1) + 0.32 T_1 + 1.84 T_2 = 0 \\implies 0.32 T_1 + 1.84 T_2 = 2.16 $$\n\nFor node $i=2$:\n$$ -2.16 T_1 + 0.32 T_2 + 1.84 T_3 = 0 $$\n\nFor node $i=3$:\n$$ -2.16 T_2 + 0.32 T_3 + 1.84 T_4 = 0 $$\nSubstituting the boundary condition $T_4=0$:\n$$ -2.16 T_2 + 0.32 T_3 + 1.84(0) = 0 \\implies -2.16 T_2 + 0.32 T_3 = 0 $$\n\nThe resulting $3 \\times 3$ linear system for $(T_1, T_2, T_3)$ is:\n$$ \\begin{pmatrix} 0.32  1.84  0 \\\\ -2.16  0.32  1.84 \\\\ 0  -2.16  0.32 \\end{pmatrix} \\begin{pmatrix} T_1 \\\\ T_2 \\\\ T_3 \\end{pmatrix} = \\begin{pmatrix} 2.16 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nTo solve this system, we can use substitution. From the third equation:\n$$ 0.32 T_3 = 2.16 T_2 \\implies T_3 = \\frac{2.16}{0.32} T_2 = 6.75 T_2 = \\frac{27}{4} T_2 $$\nSubstitute this into the second equation:\n$$ -2.16 T_1 + 0.32 T_2 + 1.84 \\left(6.75 T_2\\right) = 0 $$\n$$ -2.16 T_1 + (0.32 + 12.42) T_2 = 0 $$\n$$ -2.16 T_1 + 12.74 T_2 = 0 \\implies T_1 = \\frac{12.74}{2.16} T_2 = \\frac{637}{108} T_2 $$\nNow substitute the expression for $T_1$ into the first equation:\n$$ 0.32 \\left(\\frac{637}{108} T_2\\right) + 1.84 T_2 = 2.16 $$\n$$ \\left( \\frac{0.32 \\times 637}{108} + 1.84 \\right) T_2 = 2.16 $$\nTo maintain precision, we can use the fractional representations of the initial coefficients. Dividing all equations by $0.01$ (or multiplying by $100$) simplifies the coefficients:\n$$ \\begin{pmatrix} 32  184  0 \\\\ -216  32  184 \\\\ 0  -216  32 \\end{pmatrix} \\begin{pmatrix} T_1 \\\\ T_2 \\\\ T_3 \\end{pmatrix} = \\begin{pmatrix} 216 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nFurther simplifying by dividing each row by its greatest common divisor (here, 8 for all rows):\n$$ \\begin{pmatrix} 4  23  0 \\\\ -27  4  23 \\\\ 0  -27  4 \\end{pmatrix} \\begin{pmatrix} T_1 \\\\ T_2 \\\\ T_3 \\end{pmatrix} = \\begin{pmatrix} 27 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nFrom the third equation: $4T_3 = 27T_2 \\implies T_3 = \\frac{27}{4}T_2$.\nFrom the first equation: $4T_1 = 27 - 23T_2 \\implies T_1 = \\frac{27-23T_2}{4}$.\nSubstitute both into the second equation:\n$$ -27\\left(\\frac{27-23T_2}{4}\\right) + 4T_2 + 23\\left(\\frac{27}{4}T_2\\right) = 0 $$\nMultiply by $4$:\n$$ -27(27-23T_2) + 16T_2 + 23(27T_2) = 0 $$\n$$ -729 + 621T_2 + 16T_2 + 621T_2 = 0 $$\n$$ (621+16+621)T_2 = 729 $$\n$$ 1258 T_2 = 729 \\implies T_2 = \\frac{729}{1258} $$\nNow we find $T_1$ and $T_3$:\n$$ T_3 = \\frac{27}{4} T_2 = \\frac{27}{4} \\left(\\frac{729}{1258}\\right) = \\frac{19683}{5032} $$\n$$ T_1 = \\frac{27-23T_2}{4} = \\frac{1}{4}\\left(27 - 23\\left(\\frac{729}{1258}\\right)\\right) = \\frac{1}{4}\\left(\\frac{27 \\times 1258 - 23 \\times 729}{1258}\\right) $$\n$$ T_1 = \\frac{1}{4}\\left(\\frac{33966 - 16767}{1258}\\right) = \\frac{1}{4}\\left(\\frac{17199}{1258}\\right) = \\frac{17199}{5032} $$\nThe discrete solution for the interior nodes is:\n$$ T_1 = \\frac{17199}{5032} \\approx 3.417965... $$\n$$ T_2 = \\frac{729}{1258} \\approx 0.579491... $$\n$$ T_3 = \\frac{19683}{5032} \\approx 3.911526... $$\nThe maximum temperature in the continuous problem should be at the boundary, $\\max\\{T(x)\\} = T(0) = 1$. This numerical solution clearly violates the maximum principle, with $T_1$ and $T_3$ exceeding $1$.\n\nThe overshoot magnitude $\\delta$ is defined as:\n$$ \\delta \\equiv \\max\\{T_{1},T_{2},T_{3}\\} - \\max\\{T_{0},T_{4}\\} $$\nThe maximum value at the boundaries is $\\max\\{T_0, T_4\\} = \\max\\{1, 0\\} = 1$.\nThe maximum value at the interior nodes is $\\max\\{T_1, T_2, T_3\\} = \\max\\{3.417..., 0.579..., 3.911...\\} = T_3$.\n$$ \\delta = T_3 - 1 = \\frac{19683}{5032} - 1 = \\frac{19683 - 5032}{5032} = \\frac{14651}{5032} $$\nWe now compute the numerical value:\n$$ \\delta = \\frac{14651}{5032} \\approx 2.91152623624... $$\nThe problem asks for this value rounded to four significant figures. The first four significant figures are $2, 9, 1, 1$. The fifth digit is $5$, so we round up the fourth digit.\n$$ \\delta \\approx 2.912 $$",
            "answer": "$$\n\\boxed{2.912}\n$$"
        },
        {
            "introduction": "Having explored the potential pitfalls of inadequate matrix properties, this final practice  demonstrates a constructive and widely used approach to ensure robust solver performance. Starting with a stable upwind discretization of an advection-diffusion problem, you will learn how to enhance the system matrix by adding a pseudo-time term. This exercise guides you through the practical steps of engineering strict diagonal dominance to control the convergence of an implicit solver.",
            "id": "3975443",
            "problem": "In an implicit steady-state Computational Fluid Dynamics (CFD) solver for a one-dimensional duct segment in an aerospace application, consider the transport of a passive scalar governed by steady advection–diffusion with constant properties. The density is $\\rho$, the uniform axial speed is $u0$, the effective diffusion coefficient is $\\Gamma$, the cross-sectional area is $A$, and the uniform grid spacing is $\\Delta x$. The Finite Volume Method (FVM) is used on a uniform grid with control volume $i$ bounded by west and east faces. Let the face mass fluxes be $F_{w}=\\rho u A$ and $F_{e}=\\rho u A$, and the diffusive conductances be $D_{w}=\\Gamma A/\\Delta x$ and $D_{e}=\\Gamma A/\\Delta x$. Adopt first-order upwind interpolation for the convective fluxes and central differencing for the diffusive fluxes. Assume no physical volumetric source in the control volume interior and constant face mass fluxes.\n\n1) Starting from the steady integral conservation law for a control volume, discretize the advection and diffusion fluxes to obtain the linear equation at an interior node in the coefficient form $a_{P}\\,\\phi_{i}=a_{W}\\,\\phi_{i-1}+a_{E}\\,\\phi_{i+1}+b_{i}$, and express $a_{W}$, $a_{E}$, and $a_{P}$ in terms of $F_{w}$, $F_{e}$, $D_{w}$, and $D_{e}$ under the above assumptions. Show that for $u0$ with no physical source, one obtains $a_{P}=a_{W}+a_{E}$.\n\n2) To enhance diagonal dominance for iterative solvers, a pseudo-time term is added to the steady residual, yielding a term $\\rho V \\left(\\phi_{i}^{n+1}-\\phi_{i}^{n}\\right)/\\Delta t$ per control volume, where $V=A\\,\\Delta x$ and $\\Delta t$ is a pseudo-time step. Show that linearization about $\\phi_{i}^{n+1}$ adds an amount $\\alpha=\\rho V/\\Delta t$ to the diagonal coefficient, so that the updated diagonal is $a_{P}+\\alpha$ while the off-diagonal coefficients remain unchanged.\n\n3) Let $A$ denote the coefficient matrix of the linear system after adding the pseudo-time term, and let $D$ be its diagonal matrix, $D=\\mathrm{diag}(a_{P}+\\alpha)$. Consider the left scaling by the inverse diagonal, forming $\\tilde{A}=D^{-1}A$. Demonstrate that the diagonal entries of $\\tilde{A}$ are unity and derive, for interior nodes under the assumptions in part (1), the expression for the sum of the absolute values of the off-diagonal entries in a row of $\\tilde{A}$, namely $s_{i}=\\sum_{j\\neq i}\\left|\\tilde{A}_{ij}\\right|$. Express $s_{i}$ solely in terms of $a_{W}$, $a_{E}$, $a_{P}$, and $\\alpha$.\n\n4) Impose the sufficient condition for strict diagonal dominance of the scaled matrix by rows, namely $s_{i}\\leq 1-\\eta$ for a prescribed margin $0\\eta1$. For the parameter values $\\rho=1.225$ kg/m$^{3}$, $u=200$ m/s, $\\Gamma=0.5$ kg/(m·s), $A=1$ m$^{2}$, $\\Delta x=0.01$ m, and $\\eta=0.2$, compute the maximum pseudo-time step $\\Delta t_{\\max}$ that guarantees $s_{i}\\leq 1-\\eta$ at all interior nodes. You must:\n- Use $V=A\\,\\Delta x$ and $F=\\rho u A$, $D=\\Gamma A/\\Delta x$.\n- Express your final answer for $\\Delta t_{\\max}$ in seconds.\n- Round your answer to four significant figures.",
            "solution": "**Part 1: Discretization and Coefficient Derivation**\n\nThe integral form of the steady-state conservation law for a passive scalar $\\phi$ over a control volume $V$ is given by the balance of convection and diffusion fluxes across its boundary $\\partial V$:\n$$ \\oint_{\\partial V} \\rho \\phi \\vec{u} \\cdot d\\vec{S} - \\oint_{\\partial V} \\Gamma \\nabla\\phi \\cdot d\\vec{S} = 0 $$\nFor a one-dimensional control volume $i$ with faces at west ($w$) and east ($e$), this simplifies to:\n$$ \\left( (\\rho u A) \\phi \\right)_e - \\left( (\\rho u A) \\phi \\right)_w - \\left( (\\Gamma A) \\frac{d\\phi}{dx} \\right)_e + \\left( (\\Gamma A) \\frac{d\\phi}{dx} \\right)_w = 0 $$\nUsing the given definitions for face mass flux, $F = \\rho u A$, and diffusive conductance, $D = \\frac{\\Gamma A}{\\Delta x}$, the equation becomes:\n$$ F_e \\phi_e - F_w \\phi_w - D_e (\\phi_{i+1} - \\phi_i) + D_w (\\phi_i - \\phi_{i-1}) = 0 $$\nHere, we have applied central differencing for the diffusive flux gradients. For the convective fluxes, we use first-order upwind interpolation. Since the axial speed $u0$, the flow is from west to east. Therefore, the scalar value at a face is taken from the upwind (west) cell:\n- At the east face $e$, the upwind node is $i$, so $\\phi_e = \\phi_i$.\n- At the west face $w$, the upwind node is $i-1$, so $\\phi_w = \\phi_{i-1}$.\n\nSubstituting these into the flux balance equation:\n$$ F_e \\phi_i - F_w \\phi_{i-1} - D_e(\\phi_{i+1} - \\phi_i) + D_w(\\phi_i - \\phi_{i-1}) = 0 $$\nWe now rearrange the terms to match the specified form $a_{P}\\,\\phi_{i}=a_{W}\\,\\phi_{i-1}+a_{E}\\,\\phi_{i+1}+b_{i}$. Grouping terms by their nodal index:\n$$ (F_e + D_e + D_w)\\phi_i = (F_w + D_w)\\phi_{i-1} + D_e\\phi_{i+1} $$\nBy comparing this with the required form, we identify the coefficients for an interior node:\n- $a_W = F_w + D_w$\n- $a_E = D_e$\n- $a_P = F_e + D_e + D_w$\n- $b_i = 0$, as there is no physical source term.\n\nTo show that $a_P = a_W + a_E$, we sum the derived off-diagonal coefficients:\n$$ a_W + a_E = (F_w + D_w) + D_e = F_w + D_w + D_e $$\nThe problem states that \"face mass fluxes be $F_{w}=\\rho u A$ and $F_{e}=\\rho u A$\". This implies $F_w = F_e$. Substituting $F_w = F_e$ into the expression for $a_W + a_E$:\n$$ a_W + a_E = F_e + D_w + D_e $$\nThis is identical to our derived expression for $a_P$. Thus, for an interior node under the given assumptions, $a_P = a_W + a_E$.\n\n**Part 2: Pseudo-Time Term and Diagonal Enhancement**\n\nThe steady-state residual for node $i$ is $R_i = a_{W}\\,\\phi_{i-1}+a_{E}\\,\\phi_{i+1} - a_{P}\\,\\phi_{i}$. For an iterative solution, the equation $R_i=0$ is modified by adding a pseudo-transient term:\n$$ \\frac{\\rho V}{\\Delta t} (\\phi_i^{n+1} - \\phi_i^n) = R_i^{n+1} = a_{W}\\,\\phi_{i-1}^{n+1}+a_{E}\\,\\phi_{i+1}^{n+1} - a_{P}\\,\\phi_{i}^{n+1} $$\nwhere $n$ and $n+1$ are pseudo-time indices. Let $\\alpha = \\frac{\\rho V}{\\Delta t} = \\frac{\\rho A \\Delta x}{\\Delta t}$. The equation is rearranged to form the linear system for the unknowns at level $n+1$:\n$$ \\alpha \\phi_i^{n+1} - \\alpha \\phi_i^n = a_W \\phi_{i-1}^{n+1} + a_E \\phi_{i+1}^{n+1} - a_P \\phi_i^{n+1} $$\nMoving all terms with superscript $n+1$ to the left-hand side and the known term from level $n$ to the right-hand side gives:\n$$ a_P \\phi_i^{n+1} + \\alpha \\phi_i^{n+1} - a_W \\phi_{i-1}^{n+1} - a_E \\phi_{i+1}^{n+1} = \\alpha \\phi_i^n $$\n$$ (a_P + \\alpha) \\phi_i^{n+1} = a_W \\phi_{i-1}^{n+1} + a_E \\phi_{i+1}^{n+1} + \\alpha \\phi_i^n $$\nThis equation is of the form $a'_P \\phi_i^{n+1} = a'_W \\phi_{i-1}^{n+1} + a'_E \\phi_{i+1}^{n+1} + S_i^n$. The coefficients of the matrix for the linear system in $\\phi^{n+1}$ are:\n- Diagonal coefficient: $a'_P = a_P + \\alpha$.\n- Off-diagonal coefficients: $a'_W = a_W$ and $a'_E = a_E$.\nThis demonstrates that adding the pseudo-time term and linearizing for $\\phi^{n+1}$ results in the addition of the quantity $\\alpha$ to the main diagonal coefficient $a_P$, while the off-diagonal coefficients remain unchanged.\n\n**Part 3: Scaled Matrix Properties**\n\nThe linear system for $\\phi^{n+1}$ can be written as $A\\phi^{n+1}=b$. For an interior row $i$, the non-zero entries of the matrix $A$ are:\n$$ A_{i,i-1} = -a_W, \\quad A_{i,i} = a_P+\\alpha, \\quad A_{i,i+1} = -a_E $$\nThe diagonal matrix $D$ is defined by $D_{ii} = A_{ii} = a_P+\\alpha$. The left-scaled matrix is $\\tilde{A} = D^{-1}A$. The entries of row $i$ of $\\tilde{A}$ are:\n- Diagonal entry: $\\tilde{A}_{ii} = \\frac{A_{ii}}{D_{ii}} = \\frac{a_P+\\alpha}{a_P+\\alpha} = 1$. The diagonal entries of $\\tilde{A}$ are indeed unity.\n- Off-diagonal entries: $\\tilde{A}_{i,i-1} = \\frac{A_{i,i-1}}{D_{ii}} = \\frac{-a_W}{a_P+\\alpha}$ and $\\tilde{A}_{i,i+1} = \\frac{A_{i,i+1}}{D_{ii}} = \\frac{-a_E}{a_P+\\alpha}$.\n\nThe sum of the absolute values of the off-diagonal entries in row $i$ is $s_i = \\sum_{j\\neq i}|\\tilde{A}_{ij}|$.\n$$ s_i = |\\tilde{A}_{i,i-1}| + |\\tilde{A}_{i,i+1}| = \\left|\\frac{-a_W}{a_P+\\alpha}\\right| + \\left|\\frac{-a_E}{a_P+\\alpha}\\right| $$\nFrom Part $1$, $a_W = F_w + D_w$ and $a_E = D_e$. Since $\\rho, u, A, \\Gamma, \\Delta x$ are all positive, $F_w, D_w, D_e$ are positive, making $a_W0$ and $a_E0$. Also, $a_P = a_W+a_E  0$ and $\\alpha  0$. Therefore, the absolute value signs can be removed:\n$$ s_i = \\frac{a_W}{a_P+\\alpha} + \\frac{a_E}{a_P+\\alpha} = \\frac{a_W+a_E}{a_P+\\alpha} $$\nUsing the result from Part $1$ that $a_P = a_W+a_E$ for interior nodes, we can express $s_i$ solely in terms of $a_P$ and $\\alpha$:\n$$ s_i = \\frac{a_P}{a_P+\\alpha} $$\n\n**Part 4: Calculation of Maximum Pseudo-Time Step**\n\nThe condition for strict diagonal dominance with margin $\\eta$ is $s_i \\leq 1-\\eta$.\n$$ \\frac{a_P}{a_P+\\alpha} \\leq 1-\\eta $$\nSince $a_P  0$ and $a_P+\\alpha  0$, we can rearrange without changing the inequality direction:\n$$ a_P \\leq (1-\\eta)(a_P+\\alpha) \\implies a_P \\leq a_P + \\alpha - \\eta a_P - \\eta\\alpha \\implies \\eta a_P \\leq \\alpha(1-\\eta) $$\nSince $0  \\eta  1$, we have $1-\\eta  0$, so we can divide by it:\n$$ \\alpha \\geq \\frac{\\eta}{1-\\eta} a_P $$\nSubstituting $\\alpha = \\frac{\\rho A \\Delta x}{\\Delta t}$:\n$$ \\frac{\\rho A \\Delta x}{\\Delta t} \\geq \\frac{\\eta}{1-\\eta} a_P $$\nSolving for $\\Delta t$, we find an upper bound:\n$$ \\Delta t \\leq \\frac{\\rho A \\Delta x (1-\\eta)}{\\eta a_P} $$\nThe maximum pseudo-time step $\\Delta t_{\\max}$ corresponds to the equality:\n$$ \\Delta t_{\\max} = \\frac{\\rho A \\Delta x (1-\\eta)}{\\eta a_P} $$\nWe now compute the numerical values. The givens are $\\rho=1.225\\,\\mathrm{kg}/\\mathrm{m}^{3}$, $u=200\\,\\mathrm{m}/\\mathrm{s}$, $\\Gamma=0.5\\,\\mathrm{kg}/(\\mathrm{m}\\cdot\\mathrm{s})$, $A=1\\,\\mathrm{m}^{2}$, $\\Delta x=0.01\\,\\mathrm{m}$, and $\\eta=0.2$.\nFirst, calculate $F$ and $D$:\n$$ F = \\rho u A = (1.225\\,\\mathrm{kg}/\\mathrm{m}^{3})(200\\,\\mathrm{m}/\\mathrm{s})(1\\,\\mathrm{m}^{2}) = 245\\,\\mathrm{kg}/\\mathrm{s} $$\n$$ D = \\frac{\\Gamma A}{\\Delta x} = \\frac{(0.5\\,\\mathrm{kg}/(\\mathrm{m}\\cdot\\mathrm{s}))(1\\,\\mathrm{m}^{2})}{0.01\\,\\mathrm{m}} = 50\\,\\mathrm{kg}/\\mathrm{s} $$\nNext, calculate $a_P = a_W+a_E$. For the upwind scheme used ($u0$):\n$$ a_W = F_w + D_w = F+D = 245 + 50 = 295\\,\\mathrm{kg}/\\mathrm{s} $$\n$$ a_E = D_e = D = 50\\,\\mathrm{kg}/\\mathrm{s} $$\nThus, $a_P = a_W + a_E = 295 + 50 = 345\\,\\mathrm{kg}/\\mathrm{s}$.\nThe term $\\rho A \\Delta x$ is:\n$$ \\rho A \\Delta x = (1.225\\,\\mathrm{kg}/\\mathrm{m}^{3})(1\\,\\mathrm{m}^{2})(0.01\\,\\mathrm{m}) = 0.01225\\,\\mathrm{kg} $$\nThe margin is $\\eta=0.2$, so $1-\\eta=0.8$.\nNow, substitute these values into the expression for $\\Delta t_{\\max}$:\n$$ \\Delta t_{\\max} = \\frac{(0.01225\\,\\mathrm{kg})(0.8)}{(0.2)(345\\,\\mathrm{kg}/\\mathrm{s})} = \\frac{0.0098}{69}\\,\\mathrm{s} \\approx 0.0001420289... \\,\\mathrm{s} $$\nRounding to four significant figures, we get $\\Delta t_{\\max} = 0.0001420\\,\\mathrm{s}$. In scientific notation, this is $1.420 \\times 10^{-4}\\,\\mathrm{s}$.",
            "answer": "$$\n\\boxed{1.420 \\times 10^{-4}}\n$$"
        }
    ]
}