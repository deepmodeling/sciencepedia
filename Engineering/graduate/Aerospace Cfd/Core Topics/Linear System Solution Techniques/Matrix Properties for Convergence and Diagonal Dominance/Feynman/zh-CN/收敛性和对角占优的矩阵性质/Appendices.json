{
    "hands_on_practices": [
        {
            "introduction": "本练习是连接CFD中数值离散化与最终矩阵性质的基础实践。我们将从一个标准的对流扩散方程出发，采用物理上合理的的一阶迎风格式进行离散，这将自然地导出一个性质良好的系数矩阵。然后，您将探索一种常见的实用技术——为隐式求解器添加伪时间步长——如何系统地增强矩阵的对角占优性，这是保证迭代方法收敛的关键属性。这个实践揭示了数值格式的构建与控制求解鲁棒性所必需的数学性质之间的直接联系。",
            "id": "3975443",
            "problem": "在一个用于航空航天应用的隐式稳态计算流体动力学 (CFD) 求解器中，考虑一个一维管道段内由物性恒定的稳态对流-扩散方程控制的被动标量的输运。密度为 $\\rho$，均匀轴向速度为 $u>0$，有效扩散系数为 $\\Gamma$，横截面积为 $A$，均匀网格间距为 $\\Delta x$。在均匀网格上使用有限体积法 (FVM)，控制体积 $i$ 的边界为西界面和东界面。设界面质量通量为 $F_{w}=\\rho u A$ 和 $F_{e}=\\rho u A$，扩散传导系数为 $D_{w}=\\Gamma A/\\Delta x$ 和 $D_{e}=\\Gamma A/\\Delta x$。对流通量采用一阶迎风插值，扩散通量采用中心差分。假设控制体积内部没有物理体源，且界面质量通量恒定。\n\n1) 从控制体积的稳态积分守恒定律出发，离散化对流通量和扩散通量，得到内部节点上系数形式为 $a_{P}\\,\\phi_{i}=a_{W}\\,\\phi_{i-1}+a_{E}\\,\\phi_{i+1}+b_{i}$ 的线性方程，并根据上述假设，用 $F_{w}$、$F_{e}$、$D_{w}$ 和 $D_{e}$ 表示 $a_{W}$、$a_{E}$ 和 $a_{P}$。证明在 $u>0$ 且无物理源项的情况下，可以得到 $a_{P}=a_{W}+a_{E}$。\n\n2) 为了增强迭代求解器的对角占优性，在稳态残差中加入一个伪时间项，每个控制体积产生一个 $\\rho V \\left(\\phi_{i}^{n+1}-\\phi_{i}^{n}\\right)/\\Delta t$ 项，其中 $V=A\\,\\Delta x$，$ \\Delta t$ 是伪时间步长。证明对 $\\phi_{i}^{n+1}$ 进行线性化会在对角系数上增加一个量 $\\alpha=\\rho V/\\Delta t$，使得更新后的对角系数为 $a_{P}+\\alpha$，而非对角系数保持不变。\n\n3) 设 $A$ 为添加伪时间项后线性系统的系数矩阵，设 $D$ 为其对角矩阵，$D=\\mathrm{diag}(a_{P}+\\alpha)$。考虑用对角逆矩阵进行左缩放，形成 $\\tilde{A}=D^{-1}A$。证明 $\\tilde{A}$ 的对角元素为1，并根据第(1)部分的假设，推导内部节点 $\\tilde{A}$ 矩阵某一行中非对角元素绝对值之和的表达式，即 $s_{i}=\\sum_{j\\neq i}\\left|\\tilde{A}_{ij}\\right|$。用 $a_{W}$、$a_{E}$、$a_{P}$ 和 $\\alpha$ 来表示 $s_{i}$。\n\n4) 对缩放后的矩阵施加按行严格对角占优的充分条件，即对于给定的裕度 $0\\eta1$，满足 $s_{i}\\leq 1-\\eta$。对于参数值 $\\rho=1.225$ kg/m$^{3}$，$u=200$ m/s，$\\Gamma=0.5$ kg/(m·s)，$A=1$ m$^{2}$，$\\Delta x=0.01$ m 和 $\\eta=0.2$，计算保证所有内部节点都满足 $s_{i}\\leq 1-\\eta$ 的最大伪时间步长 $\\Delta t_{\\max}$。您必须：\n- 使用 $V=A\\,\\Delta x$ 和 $F=\\rho u A$, $D=\\Gamma A/\\Delta x$。\n- 以秒为单位表示 $\\Delta t_{\\max}$ 的最终答案。\n- 将答案四舍五入至四位有效数字。",
            "solution": "该问题被评估为有效，因为它科学地基于计算流体动力学（CFD）的原理，特别是针对对流-扩散方程的有限体积法（FVM）。该问题是适定的，具有一套完整且一致的数据和约束，可以进行唯一的、分步的推导并得到最终的数值答案。语言是客观的，该问题是工程或物理专业数值方法课程中的一个标准的、有一定难度的练习。\n\n**第1部分：离散化与系数推导**\n\n控制体积 $V$ 上被动标量 $\\phi$ 的稳态守恒定律的积分形式由其边界 $\\partial V$ 上的对流通量和扩散通量的平衡给出：\n$$ \\oint_{\\partial V} \\rho \\phi \\vec{u} \\cdot d\\vec{S} - \\oint_{\\partial V} \\Gamma \\nabla\\phi \\cdot d\\vec{S} = 0 $$\n对于具有西 ($w$) 和东 ($e$) 界面的的一维控制体积 $i$，这可以简化为：\n$$ \\left( (\\rho u A) \\phi \\right)_e - \\left( (\\rho u A) \\phi \\right)_w - \\left( (\\Gamma A) \\frac{d\\phi}{dx} \\right)_e + \\left( (\\Gamma A) \\frac{d\\phi}{dx} \\right)_w = 0 $$\n使用给定的界面质量通量定义 $F = \\rho u A$ 和扩散传导系数定义 $D = \\frac{\\Gamma A}{\\Delta x}$，方程变为：\n$$ F_e \\phi_e - F_w \\phi_w - D_e (\\phi_{i+1} - \\phi_i) + D_w (\\phi_i - \\phi_{i-1}) = 0 $$\n这里，我们对扩散通量梯度应用了中心差分。对于对流通量，我们使用一阶迎风插值。由于轴向速度 $u0$，流动方向从西向东。因此，界面上的标量值取自上游（西侧）的单元：\n- 在东界面 $e$ 处，上游节点是 $i$，所以 $\\phi_e = \\phi_i$。\n- 在西界面 $w$ 处，上游节点是 $i-1$，所以 $\\phi_w = \\phi_{i-1}$。\n\n将这些代入通量平衡方程：\n$$ F_e \\phi_i - F_w \\phi_{i-1} - D_e(\\phi_{i+1} - \\phi_i) + D_w(\\phi_i - \\phi_{i-1}) = 0 $$\n我们现在重新排列各项，以匹配指定的形式 $a_{P}\\,\\phi_{i}=a_{W}\\,\\phi_{i-1}+a_{E}\\,\\phi_{i+1}+b_{i}$。按节点索引对各项进行分组：\n$$ (F_e + D_e + D_w)\\phi_i = (F_w + D_w)\\phi_{i-1} + D_e\\phi_{i+1} $$\n通过与所需形式进行比较，我们确定内部节点的系数：\n- $a_W = F_w + D_w$\n- $a_E = D_e$\n- $a_P = F_e + D_e + D_w$\n- $b_i = 0$，因为没有物理源项。\n\n为证明 $a_P = a_W + a_E$，我们将推导出的非对角系数相加：\n$$ a_W + a_E = (F_w + D_w) + D_e = F_w + D_w + D_e $$\n问题陈述“界面质量通量为 $F_{w}=\\rho u A$ 和 $F_{e}=\\rho u A$”。这意味着 $F_w = F_e$。将 $F_w = F_e$ 代入 $a_W + a_E$ 的表达式中：\n$$ a_W + a_E = F_e + D_w + D_e $$\n这与我们推导出的 $a_P$ 的表达式相同。因此，在给定假设下，对于内部节点，$a_P = a_W + a_E$。\n\n**第2部分：伪时间项与对角增强**\n\n节点 $i$ 的稳态残差为 $R_i = a_{W}\\,\\phi_{i-1}+a_{E}\\,\\phi_{i+1} - a_{P}\\,\\phi_{i}$。对于迭代解，通过添加一个伪瞬态项来修改方程 $R_i=0$：\n$$ \\frac{\\rho V}{\\Delta t} (\\phi_i^{n+1} - \\phi_i^n) = R_i^{n+1} = a_{W}\\,\\phi_{i-1}^{n+1}+a_{E}\\,\\phi_{i+1}^{n+1} - a_{P}\\,\\phi_{i}^{n+1} $$\n其中 $n$ 和 $n+1$ 是伪时间指数。令 $\\alpha = \\frac{\\rho V}{\\Delta t} = \\frac{\\rho A \\Delta x}{\\Delta t}$。重新整理方程，形成关于 $n+1$ 层未知数的线性系统：\n$$ \\alpha \\phi_i^{n+1} - \\alpha \\phi_i^n = a_W \\phi_{i-1}^{n+1} + a_E \\phi_{i+1}^{n+1} - a_P \\phi_i^{n+1} $$\n将所有带上标 $n+1$ 的项移到左侧，将 $n$ 层的已知项移到右侧，得到：\n$$ a_P \\phi_i^{n+1} + \\alpha \\phi_i^{n+1} - a_W \\phi_{i-1}^{n+1} - a_E \\phi_{i+1}^{n+1} = \\alpha \\phi_i^n $$\n$$ (a_P + \\alpha) \\phi_i^{n+1} = a_W \\phi_{i-1}^{n+1} + a_E \\phi_{i+1}^{n+1} + \\alpha \\phi_i^n $$\n该方程的形式为 $a'_P \\phi_i^{n+1} = a'_W \\phi_{i-1}^{n+1} + a'_E \\phi_{i+1}^{n+1} + S_i^n$。关于 $\\phi^{n+1}$ 的线性系统的矩阵系数为：\n- 对角系数：$a'_P = a_P + \\alpha$。\n- 非对角系数：$a'_W = a_W$ 和 $a'_E = a_E$。\n这证明了添加伪时间项并对 $\\phi^{n+1}$ 进行线性化，会导致在主对角系数 $a_P$ 上增加一个量 $\\alpha$，而非对角系数保持不变。\n\n**第3部分：缩放矩阵的性质**\n\n关于 $\\phi^{n+1}$ 的线性系统可以写成 $A\\phi^{n+1}=b$。对于内部行 $i$，矩阵 $A$ 的非零元素为：\n$$ A_{i,i-1} = -a_W, \\quad A_{i,i} = a_P+\\alpha, \\quad A_{i,i+1} = -a_E $$\n对角矩阵 $D$ 定义为 $D_{ii} = A_{ii} = a_P+\\alpha$。左缩放矩阵为 $\\tilde{A} = D^{-1}A$。$\\tilde{A}$ 的第 $i$ 行的元素为：\n- 对角元素：$\\tilde{A}_{ii} = \\frac{A_{ii}}{D_{ii}} = \\frac{a_P+\\alpha}{a_P+\\alpha} = 1$。$\\tilde{A}$ 的对角元素确实为1。\n- 非对角元素：$\\tilde{A}_{i,i-1} = \\frac{A_{i,i-1}}{D_{ii}} = \\frac{-a_W}{a_P+\\alpha}$ 和 $\\tilde{A}_{i,i+1} = \\frac{A_{i,i+1}}{D_{ii}} = \\frac{-a_E}{a_P+\\alpha}$。\n\n第 $i$ 行非对角元素绝对值之和为 $s_i = \\sum_{j\\neq i}|\\tilde{A}_{ij}|$。\n$$ s_i = |\\tilde{A}_{i,i-1}| + |\\tilde{A}_{i,i+1}| = \\left|\\frac{-a_W}{a_P+\\alpha}\\right| + \\left|\\frac{-a_E}{a_P+\\alpha}\\right| $$\n从第1部分可知，$a_W = F_w + D_w$ 且 $a_E = D_e$。由于 $\\rho, u, A, \\Gamma, \\Delta x$ 均为正数，所以 $F_w, D_w, D_e$ 均为正数，使得 $a_W0$ 且 $a_E0$。同时，$a_P = a_W+a_E  0$ 且 $\\alpha  0$。因此，可以去掉绝对值符号：\n$$ s_i = \\frac{a_W}{a_P+\\alpha} + \\frac{a_E}{a_P+\\alpha} = \\frac{a_W+a_E}{a_P+\\alpha} $$\n使用第1部分中对于内部节点 $a_P = a_W+a_E$ 的结果，我们可以仅用 $a_P$ 和 $\\alpha$ 来表示 $s_i$：\n$$ s_i = \\frac{a_P}{a_P+\\alpha} $$\n\n**第4部分：最大伪时间步长的计算**\n\n具有裕度 $\\eta$ 的严格对角占优条件是 $s_i \\leq 1-\\eta$。\n$$ \\frac{a_P}{a_P+\\alpha} \\leq 1-\\eta $$\n由于 $a_P  0$ 且 $a_P+\\alpha  0$，我们可以重新排列不等式而无需改变其方向：\n$$ a_P \\leq (1-\\eta)(a_P+\\alpha) \\implies a_P \\leq a_P + \\alpha - \\eta a_P - \\eta\\alpha \\implies \\eta a_P \\leq \\alpha(1-\\eta) $$\n由于 $0  \\eta  1$，我们有 $1-\\eta  0$，所以可以除以它：\n$$ \\alpha \\geq \\frac{\\eta}{1-\\eta} a_P $$\n代入 $\\alpha = \\frac{\\rho A \\Delta x}{\\Delta t}$：\n$$ \\frac{\\rho A \\Delta x}{\\Delta t} \\geq \\frac{\\eta}{1-\\eta} a_P $$\n求解 $\\Delta t$，我们得到一个上界：\n$$ \\Delta t \\leq \\frac{\\rho A \\Delta x (1-\\eta)}{\\eta a_P} $$\n最大伪时间步长 $\\Delta t_{\\max}$ 对应于等式成立的情况：\n$$ \\Delta t_{\\max} = \\frac{\\rho A \\Delta x (1-\\eta)}{\\eta a_P} $$\n现在我们计算数值。给定值为 $\\rho=1.225\\,\\mathrm{kg}/\\mathrm{m}^{3}$，$u=200\\,\\mathrm{m}/\\mathrm{s}$，$\\Gamma=0.5\\,\\mathrm{kg}/(\\mathrm{m}\\cdot\\mathrm{s})$，$A=1\\,\\mathrm{m}^{2}$，$\\Delta x=0.01\\,\\mathrm{m}$ 和 $\\eta=0.2$。\n首先，计算 $F$ 和 $D$：\n$$ F = \\rho u A = (1.225\\,\\mathrm{kg}/\\mathrm{m}^{3})(200\\,\\mathrm{m}/\\mathrm{s})(1\\,\\mathrm{m}^{2}) = 245\\,\\mathrm{kg}/\\mathrm{s} $$\n$$ D = \\frac{\\Gamma A}{\\Delta x} = \\frac{(0.5\\,\\mathrm{kg}/(\\mathrm{m}\\cdot\\mathrm{s}))(1\\,\\mathrm{m}^{2})}{0.01\\,\\mathrm{m}} = 50\\,\\mathrm{kg}/\\mathrm{s} $$\n接下来，计算 $a_P = a_W+a_E$。对于所使用的迎风格式 ($u0$)：\n$$ a_W = F_w + D_w = F+D = 245 + 50 = 295\\,\\mathrm{kg}/\\mathrm{s} $$\n$$ a_E = D_e = D = 50\\,\\mathrm{kg}/\\mathrm{s} $$\n因此，$a_P = a_W + a_E = 295 + 50 = 345\\,\\mathrm{kg}/\\mathrm{s}$。\n项 $\\rho A \\Delta x$ 为：\n$$ \\rho A \\Delta x = (1.225\\,\\mathrm{kg}/\\mathrm{m}^{3})(1\\,\\mathrm{m}^{2})(0.01\\,\\mathrm{m}) = 0.01225\\,\\mathrm{kg} $$\n裕度为 $\\eta=0.2$，所以 $1-\\eta=0.8$。\n现在，将这些值代入 $\\Delta t_{\\max}$ 的表达式中：\n$$ \\Delta t_{\\max} = \\frac{(0.01225\\,\\mathrm{kg})(0.8)}{(0.2)(345\\,\\mathrm{kg}/\\mathrm{s})} = \\frac{0.0098}{69}\\,\\mathrm{s} \\approx 0.0001420289... \\,\\mathrm{s} $$\n四舍五入到四位有效数字，我们得到 $\\Delta t_{\\max} = 0.0001420\\,\\mathrm{s}$。用科学记数法表示，即 $1.420 \\times 10^{-4}\\,\\mathrm{s}$。",
            "answer": "$$\n\\boxed{1.420 \\times 10^{-4}}\n$$"
        },
        {
            "introduction": "本练习是一个重要的警示案例。前一个练习展示了如何构建一个鲁棒的数值系统，而本练习则揭示了选择不当离散格式的严重后果。您将分析一个在对流主导问题中使用中心差分格式的场景，这是一个经典的导致数值不稳定的组合。通过解决这个问题，您将亲眼看到这种选择如何导致矩阵违背了确保物理真实性所必需的关键性质（例如$M$-矩阵的条件），并最终在解中产生非物理的振荡。这个实践强调了理解和尊重矩阵性质不仅是数学上的要求，更是获得有物理意义的模拟结果的先决条件。",
            "id": "3975490",
            "problem": "考虑航空航天计算流体动力学 (CFD) 中被动标量的一维稳态平流-扩散输运，其模型建立在无量纲区间 $x \\in [0,1]$ 上，狄利克雷边界数据为 $T(0)=1$ 和 $T(1)=0$。控制方程是常系数的经典守恒律形式，\n$$ a \\,\\frac{dT}{dx} - \\varepsilon \\,\\frac{d^{2}T}{dx^{2}} = 0, $$\n其中 $a0$ 是常数平流速度，$\\varepsilon0$ 是常数扩散系数。在具有 $N=5$ 个节点、间距 $h=1/4$ 的均匀网格上，使用二阶中心差分对一阶导数和二阶导数进行微分算子离散化，内部未知数位于 $i=1,2,3$。对于此离散化，节点 $i$ 处的内部代数方程具有以下通用形式：\n$$ \\left(-\\frac{\\varepsilon}{h^{2}} - \\frac{a}{2h}\\right)T_{i-1} + \\left(\\frac{2\\varepsilon}{h^{2}}\\right)T_{i} + \\left(-\\frac{\\varepsilon}{h^{2}} + \\frac{a}{2h}\\right)T_{i+1} = 0, $$\n边界值为 $T_{0}=1$ 和 $T_{4}=0$。使用参数值 $a=1$ 和 $\\varepsilon=0.01$。根据守恒和离散近似的第一性原理，建立并求解关于 $T_{1},T_{2},T_{3}$ 的线性系统。然后通过计算过冲量值来量化离散极值原理的违背程度：\n$$ \\delta \\equiv \\max\\{T_{1},T_{2},T_{3}\\} - \\max\\{T_{0},T_{4}\\}. $$\n将您的最终数值 $\\delta$ 四舍五入到四位有效数字，并以无单位形式表示。",
            "solution": "用户提供了一个在计算流体动力学数值方法领域有效且适定的问题。我将给出完整解答。\n\n该问题要求分析在区域 $x \\in [0,1]$ 上的一维稳态平流-扩散方程：\n$$ a \\,\\frac{dT}{dx} - \\varepsilon \\,\\frac{d^{2}T}{dx^{2}} = 0 $$\n狄利克雷边界条件为 $T(0)=1$ 和 $T(1)=0$。物理参数为平流速度 $a=1$ 和扩散系数 $\\varepsilon=0.01$。\n\n空间区域使用具有 $N=5$ 个节点（索引为 $i=0, 1, 2, 3, 4$）的均匀网格进行离散化。网格间距为 $h = \\frac{1}{N-1} = \\frac{1}{4} = 0.25$。未知温度位于内部节点 $T_1$、$T_2$ 和 $T_3$，对应位置为 $x_1=0.25$、$x_2=0.5$ 和 $x_3=0.75$。边界值给定为 $T_0 = T(x_0=0) = 1$ 和 $T_4 = T(x_4=1) = 0$。\n\n问题指定对两个导数都使用二阶中心差分，从而得到内部节点 $i$ 的以下通用代数方程：\n$$ \\left(-\\frac{\\varepsilon}{h^{2}} - \\frac{a}{2h}\\right)T_{i-1} + \\left(\\frac{2\\varepsilon}{h^{2}}\\right)T_{i} + \\left(-\\frac{\\varepsilon}{h^{2}} + \\frac{a}{2h}\\right)T_{i+1} = 0 $$\n这可以重写为：\n$$ C_{west} T_{i-1} + C_{center} T_i + C_{east} T_{i+1} = 0 $$\n其中 $C_{west} = -\\frac{\\varepsilon}{h^2} - \\frac{a}{2h}$，$C_{center} = \\frac{2\\varepsilon}{h^2}$，以及 $C_{east} = -\\frac{\\varepsilon}{h^2} + \\frac{a}{2h}$。\n\n一个重要的无量纲参数是网格佩克莱特数（cell Péclet number），$Pe_h = \\frac{ah}{\\varepsilon}$。对于此问题，$Pe_h = \\frac{1 \\times 0.25}{0.01} = 25$。由于 $Pe_h  2$，已知使用二阶中心差分格式可能会违背离散极值原理，导致非物理振荡，这正是本问题所要研究的现象。\n\n我们首先使用给定的参数 $a=1$，$\\varepsilon=0.01$ 和 $h=0.25$ 计算系数的数值：\n$$ \\frac{\\varepsilon}{h^2} = \\frac{0.01}{(0.25)^2} = \\frac{0.01}{0.0625} = 0.16 $$\n$$ \\frac{a}{2h} = \\frac{1}{2 \\times 0.25} = \\frac{1}{0.5} = 2 $$\n系数为：\n$$ C_{west} = -0.16 - 2 = -2.16 $$\n$$ C_{center} = 2 \\times 0.16 = 0.32 $$\n$$ C_{east} = -0.16 + 2 = 1.84 $$\n每个内部节点 $i$ 的离散方程为：\n$$ -2.16 T_{i-1} + 0.32 T_i + 1.84 T_{i+1} = 0 $$\n我们现在为未知数 $T_1$、$T_2$ 和 $T_3$ 建立线性代数方程组。\n\n对于节点 $i=1$：\n$$ -2.16 T_0 + 0.32 T_1 + 1.84 T_2 = 0 $$\n代入边界条件 $T_0=1$：\n$$ -2.16(1) + 0.32 T_1 + 1.84 T_2 = 0 \\implies 0.32 T_1 + 1.84 T_2 = 2.16 $$\n\n对于节点 $i=2$：\n$$ -2.16 T_1 + 0.32 T_2 + 1.84 T_3 = 0 $$\n\n对于节点 $i=3$：\n$$ -2.16 T_2 + 0.32 T_3 + 1.84 T_4 = 0 $$\n代入边界条件 $T_4=0$：\n$$ -2.16 T_2 + 0.32 T_3 + 1.84(0) = 0 \\implies -2.16 T_2 + 0.32 T_3 = 0 $$\n\n得到的关于 $(T_1, T_2, T_3)$ 的 $3 \\times 3$ 线性系统为：\n$$ \\begin{pmatrix} 0.32  1.84  0 \\\\ -2.16  0.32  1.84 \\\\ 0  -2.16  0.32 \\end{pmatrix} \\begin{pmatrix} T_1 \\\\ T_2 \\\\ T_3 \\end{pmatrix} = \\begin{pmatrix} 2.16 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n为了求解这个系统，我们可以使用代入法。从第三个方程得到：\n$$ 0.32 T_3 = 2.16 T_2 \\implies T_3 = \\frac{2.16}{0.32} T_2 = 6.75 T_2 = \\frac{27}{4} T_2 $$\n将此代入第二个方程：\n$$ -2.16 T_1 + 0.32 T_2 + 1.84 \\left(6.75 T_2\\right) = 0 $$\n$$ -2.16 T_1 + (0.32 + 12.42) T_2 = 0 $$\n$$ -2.16 T_1 + 12.74 T_2 = 0 \\implies T_1 = \\frac{12.74}{2.16} T_2 = \\frac{637}{108} T_2 $$\n现在将 $T_1$ 的表达式代入第一个方程：\n$$ 0.32 \\left(\\frac{637}{108} T_2\\right) + 1.84 T_2 = 2.16 $$\n$$ \\left( \\frac{0.32 \\times 637}{108} + 1.84 \\right) T_2 = 2.16 $$\n为保持精度，我们可以使用初始系数的分数表示。将所有方程除以 $0.01$（或乘以 $100$）可以简化系数：\n$$ \\begin{pmatrix} 32  184  0 \\\\ -216  32  184 \\\\ 0  -216  32 \\end{pmatrix} \\begin{pmatrix} T_1 \\\\ T_2 \\\\ T_3 \\end{pmatrix} = \\begin{pmatrix} 216 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n通过将每一行除以最大公约数（此处，所有行均为 $8$）来进一步简化：\n$$ \\begin{pmatrix} 4  23  0 \\\\ -27  4  23 \\\\ 0  -27  4 \\end{pmatrix} \\begin{pmatrix} T_1 \\\\ T_2 \\\\ T_3 \\end{pmatrix} = \\begin{pmatrix} 27 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n从第三个方程得到：$4T_3 = 27T_2 \\implies T_3 = \\frac{27}{4}T_2$。\n从第一个方程得到：$4T_1 = 27 - 23T_2 \\implies T_1 = \\frac{27-23T_2}{4}$。\n将两者都代入第二个方程：\n$$ -27\\left(\\frac{27-23T_2}{4}\\right) + 4T_2 + 23\\left(\\frac{27}{4}T_2\\right) = 0 $$\n乘以 $4$：\n$$ -27(27-23T_2) + 16T_2 + 23(27T_2) = 0 $$\n$$ -729 + 621T_2 + 16T_2 + 621T_2 = 0 $$\n$$ (621+16+621)T_2 = 729 $$\n$$ 1258 T_2 = 729 \\implies T_2 = \\frac{729}{1258} $$\n现在我们求解 $T_1$ 和 $T_3$：\n$$ T_3 = \\frac{27}{4} T_2 = \\frac{27}{4} \\left(\\frac{729}{1258}\\right) = \\frac{19683}{5032} $$\n$$ T_1 = \\frac{27-23T_2}{4} = \\frac{1}{4}\\left(27 - 23\\left(\\frac{729}{1258}\\right)\\right) = \\frac{1}{4}\\left(\\frac{27 \\times 1258 - 23 \\times 729}{1258}\\right) $$\n$$ T_1 = \\frac{1}{4}\\left(\\frac{33966 - 16767}{1258}\\right) = \\frac{1}{4}\\left(\\frac{17199}{1258}\\right) = \\frac{17199}{5032} $$\n内部节点的离散解为：\n$$ T_1 = \\frac{17199}{5032} \\approx 3.417965... $$\n$$ T_2 = \\frac{729}{1258} \\approx 0.579491... $$\n$$ T_3 = \\frac{19683}{5032} \\approx 3.911526... $$\n在连续问题中，最高温度应出现在边界上，即 $\\max\\{T(x)\\} = T(0) = 1$。这个数值解明显违背了极值原理，其中 $T_1$ 和 $T_3$ 超过了 $1$。\n\n过冲量值 $\\delta$ 定义为：\n$$ \\delta \\equiv \\max\\{T_{1},T_{2},T_{3}\\} - \\max\\{T_{0},T_{4}\\} $$\n边界上的最大值为 $\\max\\{T_0, T_4\\} = \\max\\{1, 0\\} = 1$。\n内部节点的最大值为 $\\max\\{T_1, T_2, T_3\\} = \\max\\{3.417..., 0.579..., 3.911...\\} = T_3$。\n$$ \\delta = T_3 - 1 = \\frac{19683}{5032} - 1 = \\frac{19683 - 5032}{5032} = \\frac{14651}{5032} $$\n我们现在计算其数值：\n$$ \\delta = \\frac{14651}{5032} \\approx 2.91152623624... $$\n问题要求将此值四舍五入到四位有效数字。前四位有效数字是 $2, 9, 1, 1$。第五位数字是 $5$，所以我们将第四位数字向上取整。\n$$ \\delta \\approx 2.912 $$",
            "answer": "$$\n\\boxed{2.912}\n$$"
        },
        {
            "introduction": "这最后一个练习作为理论的总结，将前两个练习中建立的直觉进行形式化。在见证了对角占优的实际重要性之后，我们现在转向对其优势进行量化分析。这个问题将引导您推导出一个精确的数学关系，证明更强的对角占优性（由因子 $\\alpha$ 表征）在应用简单的雅可比 (Jacobi) 预条件后，直接带来条件更好的线性系统。您将得出一个关于条件数的解析上界，从而优雅而严谨地证明了为什么追求对角占优性是开发高效CFD求解器的核心目标之一。",
            "id": "3975478",
            "problem": "在计算流体动力学（CFD）中，对可压缩流中的粘性算子进行隐式离散化，得到一个线性系统 $A \\mathbf{x} = \\mathbf{b}$，其中 $A \\in \\mathbb{R}^{n \\times n}$。由于扩散项的物理可实现离散化和适定的边界条件，$A$ 是行对角占优的。假设 $A$ 对所有 $i$ 满足严格对角占优条件 $|a_{ii}| \\ge \\alpha \\sum_{j \\neq i} |a_{ij}|$，其中 $\\alpha  1$，并令 $M = \\mathrm{diag}(a_{11}, \\dots, a_{nn})$ 为雅可比预条件子（即 $A$ 的对角线部分）。考虑预处理后的矩阵 $M^{-1} A$，并使用无穷范数定义的条件数 $\\kappa_{\\infty}(B) = \\|B\\|_{\\infty} \\|B^{-1}\\|_{\\infty}$。\n\n从严格对角占优、诱导矩阵范数和矩阵逆的基本级数展开的定义出发，推导一个仅用 $\\alpha$ 表示的 $\\kappa_{\\infty}(M^{-1} A)$ 的紧的解析上界。给出该上界的最终表达式。不需要进行数值计算。",
            "solution": "我们考虑线性系统 $A \\mathbf{x} = \\mathbf{b}$，其中 $A$ 是参数为 $\\alpha  1$ 的严格行对角占优矩阵，即\n$$\n|a_{ii}| \\ge \\alpha \\sum_{j \\neq i} |a_{ij}|, \\quad \\text{for all } i.\n$$\n我们使用 $M = \\mathrm{diag}(a_{11}, \\dots, a_{nn})$ 进行雅可比预处理，得到预处理后的矩阵\n$$\nM^{-1} A = M^{-1} (D + (A - D)) = I + M^{-1} (A - D),\n$$\n其中 $D = \\mathrm{diag}(a_{11}, \\dots, a_{nn})$，$I$ 是单位矩阵。定义\n$$\nB \\equiv M^{-1} (A - D),\n$$\n因此 $M^{-1} A = I + B$。$B$ 的元素为\n$$\nb_{ii} = 0, \\quad b_{ij} = \\frac{a_{ij}}{a_{ii}} \\quad \\text{for } i \\neq j.\n$$\n我们使用无穷范数，对于矩阵 $C$，其定义为\n$$\n\\|C\\|_{\\infty} = \\max_{1 \\le i \\le n} \\sum_{j=1}^{n} |c_{ij}|,\n$$\n即最大绝对行和。对于 $B$，其绝对行和为\n$$\n\\sum_{j=1}^{n} |b_{ij}| = \\sum_{j \\neq i} \\left| \\frac{a_{ij}}{a_{ii}} \\right| = \\frac{\\sum_{j \\neq i} |a_{ij}|}{|a_{ii}|}.\n$$\n利用严格对角占优的性质，\n$$\n\\frac{\\sum_{j \\neq i} |a_{ij}|}{|a_{ii}|} \\le \\frac{1}{\\alpha},\n$$\n因此\n$$\n\\|B\\|_{\\infty} \\le \\frac{1}{\\alpha}.\n$$\n我们现在对 $\\|I + B\\|_{\\infty}$ 和 $\\|(I + B)^{-1}\\|_{\\infty}$ 进行界定。由于 $\\|I\\|_{\\infty} = 1$ 且无穷范数是次可加的，\n$$\n\\|I + B\\|_{\\infty} \\le \\|I\\|_{\\infty} + \\|B\\|_{\\infty} \\le 1 + \\frac{1}{\\alpha}.\n$$\n因为 $\\|B\\|_{\\infty} \\le 1/\\alpha  1$ (由于 $\\alpha > 1$)，Neumann 级数收敛：\n$$\n(I + B)^{-1} = \\sum_{k=0}^{\\infty} (-B)^{k}.\n$$\n利用次可乘性和几何级数界，\n$$\n\\|(I + B)^{-1}\\|_{\\infty} \\le \\sum_{k=0}^{\\infty} \\|B\\|_{\\infty}^{k} = \\frac{1}{1 - \\|B\\|_{\\infty}} \\le \\frac{1}{1 - \\frac{1}{\\alpha}}.\n$$\n因此，无穷范数下的条件数满足\n$$\n\\kappa_{\\infty}(M^{-1} A) = \\|I + B\\|_{\\infty} \\cdot \\|(I + B)^{-1}\\|_{\\infty} \\le \\left(1 + \\frac{1}{\\alpha}\\right) \\cdot \\frac{1}{1 - \\frac{1}{\\alpha}} = \\frac{\\alpha + 1}{\\alpha - 1}.\n$$\n该界仅取决于 $\\alpha$，并反映了在严格行对角占优条件下，雅可比预处理对条件数的改善情况。",
            "answer": "$$\\boxed{\\frac{\\alpha+1}{\\alpha-1}}$$"
        }
    ]
}