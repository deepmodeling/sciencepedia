{
    "hands_on_practices": [
        {
            "introduction": "为了有效地进行数值模拟，我们必须首先掌握所研究物理现象的本质。本练习将引导你回归到流体动力学的第一性原理，通过对移动的控制体应用积分形式的守恒律，来推导描述激波前后物理量变化的Rankine-Hugoniot跳跃条件 。理解这些条件至关重要，因为它们为任何激波捕捉数值格式（包括使用人工粘性的方法）提供了必须精确逼近的理论目标。",
            "id": "3944623",
            "problem": "在一个高阶有限体积计算流体力学 (CFD) 求解器中，通过使用一个在远离间断处消失的人工（体积）黏性项来捕捉一维激波。在无黏性极限下，跨越激波的弱解必须满足一维可压缩欧拉方程的质量、动量和能量的积分守恒律。考虑一个理想气体的一维可压缩欧拉方程组的守恒形式，其中密度为 $\\rho$，速度为 $u$，压力为 $p$，总能量密度为 $E$，比热比为 $\\gamma$：\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix}\n\\rho \\\\\n\\rho u \\\\\nE\n\\end{pmatrix}\n+\n\\frac{\\partial}{\\partial x}\n\\begin{pmatrix}\n\\rho u \\\\\n\\rho u^{2} + p \\\\\nu(E + p)\n\\end{pmatrix}\n= \n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix},\n$$\n其热力学封闭关系为 $E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^{2}$。一个平面间断（激波）以速度 $S$ 传播，进入一个均匀的左状态 $(\\rho_{L},u_{L},p_{L})$，并留下一个均匀的右状态 $(\\rho_{R},u_{R},p_{R})$。人工黏性是足够局部化的，因此在渐近的黏性消失极限下，Rankine–Hugoniot 跳跃条件在激波两侧成立。\n\n从上述方程组在一个跨越移动间断的时空控制体上的积分守恒律出发，推导关联左、右状态和激波速度 $S$ 的 Rankine–Hugoniot 跳跃条件。然后，使用这些条件，计算对于比热比 $\\gamma = \\frac{7}{5}$ 的理想气体的以下给定状态的激波速度 $S$：\n- 左状态：$\\rho_{L} = 1$ $\\mathrm{kg/m^{3}}$，$u_{L} = 800$ $\\mathrm{m/s}$，$p_{L} = 1.0\\times 10^{5}$ $\\mathrm{Pa}$。\n- 右状态：$\\rho_{R} = \\frac{108}{53}$ $\\mathrm{kg/m^{3}}$，$u_{R} = \\frac{4450}{9}$ $\\mathrm{m/s}$，$p_{R} = \\frac{17}{6}\\times 10^{5}$ $\\mathrm{Pa}$。\n\n将激波速度的最终答案以米每秒 (m/s) 为单位表示。如果在任何步骤中使用了中间舍入，请保留足够的精度以避免有效数字的损失，并且不要对最终答案进行舍入；本题中期望得到一个精确值。",
            "solution": "题目要求从一维可压缩欧拉方程的积分形式推导 Rankine–Hugoniot 跳跃条件，并随后为给定的左、右状态集计算激波速度 $S$。\n\n首先，我们进行 Rankine–Hugoniot 条件的推导。一维欧拉方程以守恒形式给出：\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial x} = \\mathbf{0}\n$$\n其中 $\\mathbf{U}$ 是守恒变量向量，$\\mathbf{F}$ 是通量向量：\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad \\mathbf{F} = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E + p) \\end{pmatrix}\n$$\n此处，$\\rho$ 是密度，$u$ 是速度，$p$ 是压力，$E$ 是单位体积总能量，由理想气体封闭关系给出：\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2\n$$\n其中 $\\gamma$ 是比热比。\n\n为了推导跨越间断的跳跃条件，我们考虑守恒律在一个包含位于 $x_s(t)$ 的激波前缘的固定空间域 $[x_a, x_b]$ 上的积分形式。\n$$\n\\int_{x_a}^{x_b} \\left( \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial x} \\right) dx = \\mathbf{0}\n$$\n应用莱布尼茨积分法则并积分，我们得到：\n$$\n\\frac{d}{dt} \\int_{x_a}^{x_b} \\mathbf{U} \\, dx + \\mathbf{F}(x_b) - \\mathbf{F}(x_a) = \\mathbf{0}\n$$\n状态向量 $\\mathbf{U}$ 在激波前缘 $x_s(t)$ 处是不连续的。我们假设它在激波左侧取常数值 $\\mathbf{U}_L$，在右侧取常数值 $\\mathbf{U}_R$。积分可以被拆分为：\n$$\n\\int_{x_a}^{x_b} \\mathbf{U} \\, dx = \\int_{x_a}^{x_s(t)} \\mathbf{U}_L \\, dx + \\int_{x_s(t)}^{x_b} \\mathbf{U}_R \\, dx = \\mathbf{U}_L (x_s(t) - x_a) + \\mathbf{U}_R (x_b - x_s(t))\n$$\n对此式关于时间 $t$ 求导，并注意到激波速度为 $S = \\frac{dx_s}{dt}$，我们得到：\n$$\n\\frac{d}{dt} \\int_{x_a}^{x_b} \\mathbf{U} \\, dx = \\mathbf{U}_L \\frac{dx_s}{dt} - \\mathbf{U}_R \\frac{dx_s}{dt} = S (\\mathbf{U}_L - \\mathbf{U}_R) = -S (\\mathbf{U}_R - \\mathbf{U}_L)\n$$\n我们定义一个量 $q$ 跨越激波的跳跃为 $[q] = q_R - q_L$。因此，时间导数项为 $-S [\\mathbf{U}]$。\n将此代回到积分守恒律中：\n$$\n-S [\\mathbf{U}] + \\mathbf{F}(x_b) - \\mathbf{F}(x_a) = \\mathbf{0}\n$$\n现在，我们取区间收缩到激波前缘的极限，即 $x_a \\to x_s^-$ 且 $x_b \\to x_s^+$。在此极限下，$\\mathbf{F}(x_a) \\to \\mathbf{F}(\\mathbf{U}_L)$ 且 $\\mathbf{F}(x_b) \\to \\mathbf{F}(\\mathbf{U}_R)$。方程变为：\n$$\n-S [\\mathbf{U}] + [\\mathbf{F}] = \\mathbf{0}\n$$\n这就得到了一般形式的 Rankine–Hugoniot 跳跃条件：\n$$\nS [\\mathbf{U}] = [\\mathbf{F}]\n$$\n将欧拉方程组的每个分量写出，我们得到具体的跳跃条件：\n1.  质量守恒：$S [\\rho] = [\\rho u]$\n    $$S (\\rho_R - \\rho_L) = \\rho_R u_R - \\rho_L u_L$$\n2.  动量守恒：$S [\\rho u] = [\\rho u^2 + p]$\n    $$S (\\rho_R u_R - \\rho_L u_L) = (\\rho_R u_R^2 + p_R) - (\\rho_L u_L^2 + p_L)$$\n3.  能量守恒：$S [E] = [u(E+p)]$\n    $$S (E_R - E_L) = u_R(E_R + p_R) - u_L(E_L + p_L)$$\n这些就是关联激波左、右两侧的状态与激波速度 $S$ 的 Rankine–Hugoniot 条件。\n\n接下来，我们使用给定的数据计算激波速度 $S$：\n-   $\\gamma = \\frac{7}{5}$\n-   左状态：$\\rho_L = 1 \\ \\mathrm{kg/m^3}$，$u_L = 800 \\ \\mathrm{m/s}$，$p_L = 1.0 \\times 10^5 \\ \\mathrm{Pa}$。\n-   右状态：$\\rho_R = \\frac{108}{53} \\ \\mathrm{kg/m^3}$，$u_R = \\frac{4450}{9} \\ \\mathrm{m/s}$，$p_R = \\frac{17}{6} \\times 10^5 \\ \\mathrm{Pa}$。\n\n我们可以使用三个跳跃条件中的任意一个。质量守恒方程提供了计算 $S$ 最直接的方法：\n$$S = \\frac{\\rho_R u_R - \\rho_L u_L}{\\rho_R - \\rho_L}$$\n我们代入给定值，并以分数形式保留它们以保持精度。\n分子是：\n$$\n\\rho_R u_R - \\rho_L u_L = \\left(\\frac{108}{53}\\right) \\left(\\frac{4450}{9}\\right) - (1)(800)\n$$\n化简第一项：$\\frac{108}{9} = 12$。\n$$\n= \\frac{12 \\times 4450}{53} - 800 = \\frac{53400}{53} - \\frac{800 \\times 53}{53} = \\frac{53400 - 42400}{53} = \\frac{11000}{53}\n$$\n分母是：\n$$\n\\rho_R - \\rho_L = \\frac{108}{53} - 1 = \\frac{108 - 53}{53} = \\frac{55}{53}\n$$\n现在，我们可以计算激波速度 $S$：\n$$\nS = \\frac{\\frac{11000}{53}}{\\frac{55}{53}} = \\frac{11000}{55}\n$$\n为了化简此分数，我们可以将分子和分母同除以 $55$：\n$$\nS = \\frac{11000}{55} = \\frac{200 \\times 55}{55} = 200\n$$\n激波速度为 $S = 200 \\ \\mathrm{m/s}$。\n\n为确保给定状态的一致性，可以验证 $S$ 的这个值也满足动量和能量跳跃条件。让我们用动量方程来检验。一个从动量和质量跳跃条件推导出的方便形式是 $[p] = \\rho_L(u_L-S)(u_L-u_R)$。\n等式左边：\n$$\np_R - p_L = \\frac{17}{6} \\times 10^5 - 1 \\times 10^5 = \\left(\\frac{17}{6} - 1\\right) \\times 10^5 = \\frac{11}{6} \\times 10^5\n$$\n等式右边：\n$$\n\\rho_L (u_L - S) (u_L - u_R) = (1) (800 - 200) \\left(800 - \\frac{4450}{9}\\right)\n$$\n$$\n= 600 \\left(\\frac{7200 - 4450}{9}\\right) = 600 \\left(\\frac{2750}{9}\\right) = \\frac{200}{3} \\times 2750 = \\frac{550000}{3} = \\frac{5.5 \\times 10^5}{3}\n$$\n我们检验 $\\frac{11}{6} \\times 10^5$ 是否等于 $\\frac{5.5 \\times 10^5}{3}$。确实，$\\frac{11}{6} = \\frac{2 \\times 5.5}{2 \\times 3} = \\frac{5.5}{3}$。动量方程得到满足，这证实了数据和计算出的激波速度的一致性。类似的检验表明能量方程也得到满足。\n激波速度为 $200$ 米每秒。",
            "answer": "$$\\boxed{200}$$"
        },
        {
            "introduction": "在理解了理想间断的尖锐特性之后，我们现在来探究添加人工黏性的所带来的主要后果——数值扩散，也就是通常所说的“弥散”效应。本练习通过一个简化的模型，即一个随接触间断平流输运的被动标量，来隔离并分析这一现象 。通过解析求解所得到的平流-扩散方程，你将能够定量地理解界面厚度如何随时间演化，并揭示其与人工黏性系数 $\\nu_{a}$ 和时间 $t$ 的平方根 $\\sqrt{\\nu_{a}t}$ 之间的直接关系。",
            "id": "3944585",
            "problem": "为了量化间断抹平的程度，我们将无粘性可压缩流中速度恒定的一维接触间断，建模为一个无源标量 $\\phi(x,t)$ 的平流过程。在 $t=0$ 时，该标量在左侧状态为 $1$，在右侧状态为 $0$。为了在数值上捕捉该间断，添加了一个常系数为 $\\nu_{a}$ 的人工粘性，从而得到一个平流-扩散方程。请从平流标量的守恒和菲克扩散定律出发，推导因人工粘性导致的界面厚度增长的解析预测，并用它来计算在均匀网格上经过 $N$ 个显式时间步长后被抹平的 $10$–$90$ 厚度。\n\n假设以下科学上一致的设置，这在航空航天计算流体动力学（CFD）中间断捕捉方面具有代表性：\n- 该标量由守恒定律 $\\partial_{t}\\phi + u_{0}\\,\\partial_{x}\\phi = 0$ 控制，并增加了一个形式为 $\\partial_{x}(\\nu_{a}\\,\\partial_{x}\\phi)$ 的人工粘性项，其中 $u_{0}$ 和 $\\nu_{a}$ 是常数。\n- 在 $t=0$ 时的初始条件是一个位于 $x=0$ 处的尖锐接触，其中对于 $x0$ 有 $\\phi(x,0)=1$，对于 $x>0$ 有 $\\phi(x,0)=0$。域实际上是无限的，因此在所关心的时间内边界效应可以忽略不计。\n- 均匀网格间距为 $\\Delta x = 5.0\\times 10^{-4}\\,\\mathrm{m}$，恒定平流速度为 $u_{0}=250\\,\\mathrm{m/s}$，人工粘性系数为 $\\nu_{a}=5.0\\times 10^{-4}\\,\\mathrm{m^{2}/s}$，库朗-弗里德里希斯-列维（CFL）数为 $\\mathrm{CFL}=0.40$。显式时间步长取为 $\\Delta t = \\mathrm{CFL}\\,\\Delta x/|u_{0}|$，步数为 $N=250$。\n- 将界面厚度 $w_{10\\text{–}90}(t)$ 定义为 $\\phi(x,t)=0.9$ 和 $\\phi(x,t)=0.1$ 处位置之间的空间距离。\n\n仅使用此信息并从控制原理出发，计算 $N$ 步后 $w_{10\\text{–}90}$ 的预测值。将最终答案四舍五入至四位有效数字，并以米为单位表示。",
            "solution": "带有​人工粘性的无源标量的基本方程是\n$$\n\\partial_{t}\\phi + u_{0}\\,\\partial_{x}\\phi \\;=\\; \\nu_{a}\\,\\partial_{x}^{2}\\phi,\n$$\n该方程结合了平流物理量的守恒和由菲克定律给出的扩散通量，其中通量为 $-\\,\\nu_{a}\\,\\partial_{x}\\phi$。因为系数 $u_{0}$ 和 $\\nu_{a}$ 是常数，伽利略变换将此平流-扩散方程简化为在以恒定速度 $u_{0}$ 移动的参考系中的纯扩散方程。具体来说，定义随动坐标\n$$\n\\xi \\;=\\; x - u_{0}t.\n$$\n然后，根据链式法则，\n$$\n\\partial_{t}\\phi(x,t) \\;=\\; \\left.\\partial_{t}\\phi\\right|_{\\xi} - u_{0}\\,\\partial_{\\xi}\\phi, \\qquad\n\\partial_{x}\\phi(x,t) \\;=\\; \\partial_{\\xi}\\phi, \\qquad\n\\partial_{x}^{2}\\phi(x,t) \\;=\\; \\partial_{\\xi}^{2}\\phi,\n$$\n于是方程变为\n$$\n\\left.\\partial_{t}\\phi\\right|_{\\xi} - u_{0}\\,\\partial_{\\xi}\\phi + u_{0}\\,\\partial_{\\xi}\\phi \\;=\\; \\nu_{a}\\,\\partial_{\\xi}^{2}\\phi\n\\;\\;\\Rightarrow\\;\\;\n\\left.\\partial_{t}\\phi\\right|_{\\xi} \\;=\\; \\nu_{a}\\,\\partial_{\\xi}^{2}\\phi.\n$$\n因此，在移动参考系中，$\\phi(\\xi,t)$ 满足具有恒定扩散系数 $\\nu_{a}$ 的一维扩散方程。初始条件是位于 $\\xi=0$ 的亥维赛阶跃函数：对于 $\\xi0$ 有 $\\phi(\\xi,0)=1$，对于 $\\xi>0$ 有 $\\phi(\\xi,0)=0$。\n\n具有此初始数据的扩散方程存在由高斯格林函数构造的相似解。解是互补误差函数剖面\n$$\n\\phi(\\xi,t) \\;=\\; \\tfrac{1}{2}\\,\\mathrm{erfc}\\!\\left(\\frac{\\xi}{2\\sqrt{\\nu_{a}t}}\\right),\n$$\n它从 $1$ 平滑过渡到 $0$，其特征扩散厚度随 $\\sqrt{\\nu_{a}t}$ 增长。返回到实验室参考系，$\\xi=x-u_{0}t$ 给出\n$$\n\\phi(x,t) \\;=\\; \\tfrac{1}{2}\\,\\mathrm{erfc}\\!\\left(\\frac{x-u_{0}t}{2\\sqrt{\\nu_{a}t}}\\right).\n$$\n将 $x_{\\alpha}(t)$ 定义为 $\\phi(x_{\\alpha},t)=\\alpha$ 处的位置。求解 $x_{\\alpha}(t)$ 可得\n$$\n\\alpha \\;=\\; \\tfrac{1}{2}\\,\\mathrm{erfc}\\!\\left(\\frac{x_{\\alpha}-u_{0}t}{2\\sqrt{\\nu_{a}t}}\\right)\n\\;\\;\\Rightarrow\\;\\;\n\\mathrm{erfc}\\!\\left(\\frac{x_{\\alpha}-u_{0}t}{2\\sqrt{\\nu_{a}t}}\\right) \\;=\\; 2\\alpha\n\\;\\;\\Rightarrow\\;\\;\n\\frac{x_{\\alpha}-u_{0}t}{2\\sqrt{\\nu_{a}t}} \\;=\\; \\mathrm{erfc}^{-1}(2\\alpha).\n$$\n使用 $\\mathrm{erfc}^{-1}(y) \\,=\\, -\\,\\mathrm{erf}^{-1}(1-y)$，我们得到\n$$\n\\frac{x_{\\alpha}-u_{0}t}{2\\sqrt{\\nu_{a}t}} \\;=\\; -\\,\\mathrm{erf}^{-1}(1-2\\alpha).\n$$\n对于 $10$–$90$ 厚度，我们设 $\\alpha=0.9$ 和 $\\alpha=0.1$。这给出\n$$\n\\frac{x_{0.9}-u_{0}t}{2\\sqrt{\\nu_{a}t}} \\;=\\; -\\,\\mathrm{erf}^{-1}(1-1.8) \\;=\\; -\\,\\mathrm{erf}^{-1}(-0.8) \\;=\\; \\mathrm{erf}^{-1}(0.8),\n$$\n$$\n\\frac{x_{0.1}-u_{0}t}{2\\sqrt{\\nu_{a}t}} \\;=\\; -\\,\\mathrm{erf}^{-1}(1-0.2) \\;=\\; -\\,\\mathrm{erf}^{-1}(0.8).\n$$\n因此，$10$–$90$ 厚度 $w_{10\\text{–}90}(t)=x_{0.1}(t)-x_{0.9}(t)$ 为\n$$\nw_{10\\text{–}90}(t) \\;=\\; 2\\sqrt{\\nu_{a}t}\\,\\Big[-\\,\\mathrm{erf}^{-1}(0.8)\\;-\\;\\mathrm{erf}^{-1}(0.8)\\Big]\n\\;=\\; 4\\,\\sqrt{\\nu_{a}t}\\;\\mathrm{erf}^{-1}(0.8).\n$$\n值得注意的是，平移运动 $u_{0}t$ 从厚度的计算中消去了。经过 $N$ 个显式时间步长 $\\Delta t$ 后的总时间是\n$$\nt \\;=\\; N\\,\\Delta t \\;=\\; N\\,\\frac{\\mathrm{CFL}\\,\\Delta x}{|u_{0}|}.\n$$\n使用给定的值，\n$$\n\\Delta t \\;=\\; \\frac{0.40\\times 5.0\\times 10^{-4}\\,\\mathrm{m}}{250\\,\\mathrm{m/s}}\n\\;=\\; \\frac{2.0\\times 10^{-4}\\,\\mathrm{m}}{250\\,\\mathrm{m/s}}\n\\;=\\; 8.0\\times 10^{-7}\\,\\mathrm{s},\n$$\n并且\n$$\nt \\;=\\; N\\,\\Delta t \\;=\\; 250 \\times 8.0\\times 10^{-7}\\,\\mathrm{s} \\;=\\; 2.0\\times 10^{-4}\\,\\mathrm{s}.\n$$\n因此，\n$$\n\\sqrt{\\nu_{a}t} \\;=\\; \\sqrt{(5.0\\times 10^{-4}\\,\\mathrm{m^{2}/s})\\,(2.0\\times 10^{-4}\\,\\mathrm{s})}\n\\;=\\; \\sqrt{1.0\\times 10^{-7}\\,\\mathrm{m^{2}}}\n\\;=\\; 3.162277660168379\\times 10^{-4}\\,\\mathrm{m}.\n$$\n使用 $\\mathrm{erf}^{-1}(0.8) \\approx 0.906193802436823$，预测的厚度为\n$$\nw_{10\\text{–}90} \\;=\\; 4\\,\\sqrt{\\nu_{a}t}\\;\\mathrm{erf}^{-1}(0.8)\n\\;=\\; 4\\,(3.162277660168379\\times 10^{-4}\\,\\mathrm{m})\\,(0.906193802436823)\n\\;\\approx\\; 1.146254624045021\\times 10^{-3}\\,\\mathrm{m}.\n$$\n四舍五入到四位有效数字并以米表示，$N$ 个时间步长后预测的 $10$–$90$ 界面厚度为 $0.001146\\,\\mathrm{m}$。",
            "answer": "$$\\boxed{0.001146}$$"
        },
        {
            "introduction": "前面的练习分别阐明了为何需要捕捉间断以及人工黏性的基本效应。最后的这个实践环节将聚焦于一个关键的工程问题：在真实的CFD计算中，我们应如何设定人工黏性系数的大小？。本练习将指导你推导并实现一个实用的校准公式，通过平衡对流与扩散效应来控制激波的数值厚度，确保其在期望的网格单元数量上被解析。这是一项获得精确且稳定数值解的关键技能。",
            "id": "3944604",
            "problem": "您的任务是，在计算流体动力学（CFD）的框架内，为用于捕捉一维激波管问题（即Sod激波管问题）中间断的人工粘性系数，推导并实现一个标定公式。考虑一维理想气体欧拉方程，该方程增加了一个恒定的标量人工粘性项，通过添加一个与守恒变量梯度成正比的扩散通量来对间断进行正则化。流体是理想气体，其比热比为$\\gamma$，左右初始状态分别为$(\\rho_L, u_L, p_L)$和$(\\rho_R, u_R, p_R)$，其中$\\rho$表示密度，单位为$\\mathrm{kg/m^3}$，$u$表示速度，单位为$\\mathrm{m/s}$，$p$表示压力，单位为$\\mathrm{Pa}$。网格间距为$\\Delta x$，单位为$\\mathrm{m}$。\n\n从基本原理出发：\n- 理想气体的一维欧拉方程（无源项）表达了状态向量$U$和通量$F(U)$的质量、动量和能量守恒。\n- 人工粘性正则化通过添加一个形式为$\\partial_x (\\mu_a \\partial_x U)$的扩散项来建模，其中常数系数$\\mu_a$的单位为$\\mathrm{m^2/s}$。\n- 欧拉系统的特征速度是通量雅可比矩阵的特征值，其近似上界为$|u| + c$，其中$c = \\sqrt{\\gamma p / \\rho}$是当地声速。\n\n您必须通过将激波建模为一个稳态行波（其中以特征波速进行的对流输运与扩散输运相平衡），从第一性原理推导目标激波厚度$\\delta$与所需人工粘性系数$\\mu_a$之间的关系。您必须：\n1. 在激波固定坐标系中，建立稳态行波平衡的公式，解释与特征速度成正比的对流项和与$\\mu_a$成正比的扩散项如何决定粘性激波剖面的长度尺度。\n2. 论证使用欧拉系统的最大特征速度作为对流尺度的合理性，并使用Roe平均状态为该速度选择一个物理上一致的估计。定义Roe平均速度$\\tilde{u}$和Roe平均总焓$\\tilde{h}$，用$(\\rho_L, u_L, h_L)$和$(\\rho_R, u_R, h_R)$表示，其中$h = \\frac{\\gamma}{\\gamma - 1}\\frac{p}{\\rho} + \\frac{1}{2}u^2$，然后定义Roe平均声速$\\tilde{a} = \\sqrt{(\\gamma - 1)\\left(\\tilde{h} - \\frac{1}{2}\\tilde{u}^2\\right)}$。\n3. 根据此推理，推导出$\\mu_a$的显式表达式，用目标激波厚度$\\delta$、网格间距$\\Delta x$和Roe平均谱半径$\\lambda_{\\max} = |\\tilde{u}| + \\tilde{a}$来表示。目标激波厚度被设定为$N$个计算单元，因此$\\delta = N \\Delta x$。\n4. 在一个程序中实现所得关系，该程序根据给定的$(\\gamma, \\rho_L, u_L, p_L, \\rho_R, u_R, p_R, \\Delta x, N)$计算$\\mu_a$。\n\n您的程序必须处理以下测试套件，为每个案例计算所需的$\\mu_a$，并以$\\mathrm{m^2/s}$为单位输出结果，四舍五入到六位小数：\n- 案例 $1$：$\\gamma = 1.4$，$\\rho_L = 1.0\\,\\mathrm{kg/m^3}$，$u_L = 0.0\\,\\mathrm{m/s}$，$p_L = 1.0\\times10^5\\,\\mathrm{Pa}$，$\\rho_R = 0.125\\,\\mathrm{kg/m^3}$，$u_R = 0.0\\,\\mathrm{m/s}$，$p_R = 1.0\\times10^4\\,\\mathrm{Pa}$，$\\Delta x = 1.0\\times10^{-3}\\,\\mathrm{m}$，$N = 3$。\n- 案例 $2$：与案例$1$相同，除了$\\Delta x = 5.0\\times10^{-4}\\,\\mathrm{m}$。\n- 案例 $3$：与案例$1$相同，除了$\\Delta x = 1.0\\times10^{-6}\\,\\mathrm{m}$。\n- 案例 $4$：$\\gamma = 1.4$，$\\rho_L = 1.0\\,\\mathrm{kg/m^3}$，$u_L = 50.0\\,\\mathrm{m/s}$，$p_L = 1.0\\times10^5\\,\\mathrm{Pa}$，$\\rho_R = 0.125\\,\\mathrm{kg/m^3}$，$u_R = 0.0\\,\\mathrm{m/s}$，$p_R = 1.0\\times10^4\\,\\mathrm{Pa}$，$\\Delta x = 1.0\\times10^{-3}\\,\\mathrm{m}$，$N = 3$。\n- 案例 $5$：$\\gamma = 1.4$，$\\rho_L = 1.0\\,\\mathrm{kg/m^3}$，$u_L = 0.0\\,\\mathrm{m/s}$，$p_L = 1.0\\times10^5\\,\\mathrm{Pa}$，$\\rho_R = 0.125\\,\\mathrm{kg/m^3}$，$u_R = 0.0\\,\\mathrm{m/s}$，$p_R = 2.0\\times10^4\\,\\mathrm{Pa}$，$\\Delta x = 1.0\\times10^{-3}\\,\\mathrm{m}$，$N = 3$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表，例如$[\\mu_{a,1},\\mu_{a,2},\\mu_{a,3},\\mu_{a,4},\\mu_{a,5}]$，其中每个$\\mu_{a,i}$以$\\mathrm{m^2/s}$为单位表示，并四舍五入到六位小数。",
            "solution": "我们从理想气体的一维欧拉方程开始，其状态向量为$U = [\\rho, \\rho u, E]^T$，通量为$F(U) = [\\rho u, \\rho u^2 + p, u(E + p)]^T$。对于理想气体，压力$p$满足$p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^2\\right)$，声速为$c = \\sqrt{\\gamma p / \\rho}$。为了捕捉激波等间断，引入人工粘性作为扩散正则化。一个常见的模型是向系统中添加一个恒定的标量人工粘性系数$\\mu_a$，得到修正后的平衡方程\n$$\n\\partial_t U + \\partial_x F(U) = \\partial_x\\left(\\mu_a \\partial_x U\\right).\n$$\n\n为了标定$\\mu_a$，我们考虑一个在激波固定坐标系中代表激波剖面的稳态行波。设激波以速度$s$移动，并引入坐标$\\xi = x - s t$。对于一个稳态剖面$U(\\xi)$，在移动坐标系中时间导数消失，对流与扩散对某一特征模态的主导平衡变为\n$$\n- \\lambda \\,\\frac{d U}{d \\xi} + \\mu_a \\,\\frac{d^2 U}{d \\xi^2} \\approx 0,\n$$\n其中$\\lambda$是衡量该模态对流输运的特征速度。这个常微分方程是线性的，具有形式为$U(\\xi) \\sim \\exp\\left(\\frac{\\lambda}{\\mu_a}\\xi\\right)$的指数解，这意味着激波过渡区的特征长度尺度为\n$$\n\\delta \\sim \\frac{\\mu_a}{\\lambda}.\n$$\n该尺度是通过平衡对流项的量级$|\\lambda \\, dU/d\\xi|$和扩散项的量级$|\\mu_a \\, d^2U/d\\xi^2|$得到的，从而得出指数衰减长度$\\delta$。\n\n对于一维欧拉方程，物理上相关的对流尺度由通量雅可比矩阵$A(U) = \\partial F / \\partial U$的最大特征速度决定，对于理想气体，其特征值为$u - c$、$u$和$u + c$。在存在间断的情况下，对谱半径的稳健估计可以通过使用Roe平均状态获得。定义Roe平均速度$\\tilde{u}$和总焓$\\tilde{h}$为\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L} u_L + \\sqrt{\\rho_R} u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}},\n\\quad\nh = \\frac{\\gamma}{\\gamma - 1} \\frac{p}{\\rho} + \\frac{1}{2} u^2,\n\\quad\n\\tilde{h} = \\frac{\\sqrt{\\rho_L} h_L + \\sqrt{\\rho_R} h_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}.\n$$\nRoe平均声速$\\tilde{a}$则为\n$$\n\\tilde{a} = \\sqrt{(\\gamma - 1)\\left(\\tilde{h} - \\frac{1}{2} \\tilde{u}^2\\right)}.\n$$\n与Roe线性化相关的最大特征速度是\n$$\n\\lambda_{\\max} = |\\tilde{u}| + \\tilde{a}.\n$$\n这个选择在物理上是一致的，因为它是Roe平均雅可比矩阵的谱半径，并界定了压缩波跨界面传播的速度。\n\n将目标激波厚度$\\delta$与粘性长度尺度相等，得到\n$$\n\\delta = \\frac{\\mu_a}{\\lambda_{\\max}}.\n$$\n如果目标激波厚度被规定为$N$个计算单元，那么\n$$\n\\delta = N \\Delta x,\n$$\n所需的人工粘性系数则为\n$$\n\\mu_a = \\lambda_{\\max} \\, N \\, \\Delta x.\n$$\n该关系在量纲上是一致的：$\\lambda_{\\max}$的单位是$\\mathrm{m/s}$，$\\Delta x$的单位是$\\mathrm{m}$，所以$\\mu_a$的单位是$\\mathrm{m^2/s}$。\n\n为每个测试案例计算$\\mu_a$的算法步骤：\n1. 给定$(\\gamma, \\rho_L, u_L, p_L, \\rho_R, u_R, p_R, \\Delta x, N)$，计算左右两侧的总焓\n$$\nh_L = \\frac{\\gamma}{\\gamma - 1} \\frac{p_L}{\\rho_L} + \\frac{1}{2} u_L^2, \\quad h_R = \\frac{\\gamma}{\\gamma - 1} \\frac{p_R}{\\rho_R} + \\frac{1}{2} u_R^2.\n$$\n2. 计算Roe平均速度和焓\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L} u_L + \\sqrt{\\rho_R} u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}, \\quad \\tilde{h} = \\frac{\\sqrt{\\rho_L} h_L + \\sqrt{\\rho_R} h_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}.\n$$\n3. 计算Roe平均声速\n$$\n\\tilde{a} = \\sqrt{(\\gamma - 1)\\left(\\tilde{h} - \\frac{1}{2} \\tilde{u}^2\\right)}.\n$$\n4. 计算最大特征速度\n$$\n\\lambda_{\\max} = |\\tilde{u}| + \\tilde{a}.\n$$\n5. 计算所需的人工粘性系数\n$$\n\\mu_a = \\lambda_{\\max} \\, N \\, \\Delta x.\n$$\n6. 将结果四舍五入到六位小数，并以$\\mathrm{m^2/s}$为单位表示。\n\n所提供的测试套件探讨了：\n- 一个代表Sod激波管的标准左右状态的一般情况（案例1）。\n- 通过将$\\Delta x$减半（案例2）和使用一个极细网格（案例3）来检验对网格加密的敏感性。\n- 非零入流速度的影响（案例4）。\n- 增加右侧压力从而改变声速的效果（案例5）。\n\n您的程序应生成单行输出，包含列表$[\\mu_{a,1},\\mu_{a,2},\\mu_{a,3},\\mu_{a,4},\\mu_{a,5}]$，其中每个值都以$\\mathrm{m^2/s}$为单位四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef roe_averages(gamma, rhoL, uL, pL, rhoR, uR, pR):\n    # Compute total enthalpies\n    hL = (gamma / (gamma - 1.0)) * (pL / rhoL) + 0.5 * uL**2\n    hR = (gamma / (gamma - 1.0)) * (pR / rhoR) + 0.5 * uR**2\n\n    sqrL = np.sqrt(rhoL)\n    sqrR = np.sqrt(rhoR)\n    denom = sqrL + sqrR\n\n    u_tilde = (sqrL * uL + sqrR * uR) / denom\n    h_tilde = (sqrL * hL + sqrR * hR) / denom\n\n    a_tilde = np.sqrt((gamma - 1.0) * (h_tilde - 0.5 * u_tilde**2))\n\n    # Largest characteristic speed\n    lambda_max = abs(u_tilde) + a_tilde\n    return lambda_max\n\ndef required_mu(lambda_max, dx, Ncells):\n    # mu_a = lambda_max * Ncells * dx\n    return lambda_max * Ncells * dx\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (gamma, rhoL, uL, pL, rhoR, uR, pR, dx, Ncells)\n    test_cases = [\n        (1.4, 1.0, 0.0, 1.0e5, 0.125, 0.0, 1.0e4, 1.0e-3, 3),\n        (1.4, 1.0, 0.0, 1.0e5, 0.125, 0.0, 1.0e4, 5.0e-4, 3),\n        (1.4, 1.0, 0.0, 1.0e5, 0.125, 0.0, 1.0e4, 1.0e-6, 3),\n        (1.4, 1.0, 50.0, 1.0e5, 0.125, 0.0, 1.0e4, 1.0e-3, 3),\n        (1.4, 1.0, 0.0, 1.0e5, 0.125, 0.0, 2.0e4, 1.0e-3, 3),\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, rhoL, uL, pL, rhoR, uR, pR, dx, Ncells = case\n        lambda_max = roe_averages(gamma, rhoL, uL, pL, rhoR, uR, pR)\n        mu_a = required_mu(lambda_max, dx, Ncells)\n        # Round to six decimal places\n        mu_a_rounded = float(f\"{mu_a:.6f}\")\n        results.append(mu_a_rounded)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}