{
    "hands_on_practices": [
        {
            "introduction": "有限元方法的核心在于，在小的子域（即单元）上使用简单的多项式（形函数）来逼近复杂的连续场。这个练习将带你动手实践这一基本步骤：使用线性拉格朗日形函数对一个给定的二维场进行插值，并计算其逼近的精确度。通过计算$L^2$范数下的插值误差，你将对有限元法的逼近性质建立起直观且定量的理解。",
            "id": "3956616",
            "problem": "在一个使用有限元法 (FEM) 的二维计算流体动力学 (CFD) 离散化中，考虑一个单一的线性三角形单元，其顶点物理坐标为 $\\mathbf{P}_{1}=(0,0)$、$\\mathbf{P}_{2}=(1,0)$ 和 $\\mathbf{P}_{3}=(0,1)$。此三角形上的1次Lagrange形函数被定义为在顶点处满足克罗内克δ性质的唯一线性多项式。设标量场为多项式 $u(x,y)=x^{2}+xy$。使用该单元上的1次Lagrange形函数，构建节点插值 $I_{h}u$ 并计算插值误差 $e=u-I_{h}u$。然后，计算该单元上误差的 $L^{2}$ 范数，其定义为\n$$\n\\|e\\|_{L^{2}(T)}=\\left(\\int_{T} e(x,y)^{2}\\,\\mathrm{d}A\\right)^{\\frac{1}{2}},\n$$\n其中 $T$ 表示该三角形单元。请以精确值的形式给出最终答案，不进行四舍五入，不带单位。",
            "solution": "该问题已经过验证，被认为是有效的。这是一个源于数值分析领域（特别是有限元法）的适定的、有科学依据的问题，有限元法是许多现代计算流体动力学（CFD）代码的核心组成部分。所有必要信息均已提供，问题没有矛盾或歧义。\n\n该问题要求计算给定标量场在线性三角形单元上的插值误差的 $L^2$ 范数。求解过程包括四个主要步骤：\n1.  推导给定单元的1次Lagrange形函数。\n2.  构建标量场 $u(x,y)$ 的节点插值 $I_h u$。\n3.  确定插值误差函数 $e(x,y)$。\n4.  通过在单元面积上积分来计算误差函数的 $L^2$ 范数。\n\n三角形单元（记为 $T$）由笛卡尔坐标系 $(x,y)$ 中的三个顶点 $\\mathbf{P}_{1}=(0,0)$、$\\mathbf{P}_{2}=(1,0)$ 和 $\\mathbf{P}_{3}=(0,1)$ 定义。\n\n首先，我们确定1次Lagrange形函数 $N_1(x,y)$、$N_2(x,y)$ 和 $N_3(x,y)$。这些是形式为 $N_i(x,y) = a_i + b_i x + c_i y$ 的线性多项式，它们必须在节点处满足克罗内克δ性质，即 $N_i(\\mathbf{P}_j) = \\delta_{ij}$，其中当 $i=j$ 时 $\\delta_{ij}$ 为 $1$，当 $i \\neq j$ 时为 $0$。\n\n对于形函数 $N_1(x,y)$：\n$N_1(\\mathbf{P}_1) = N_1(0,0) = a_1 = 1$\n$N_1(\\mathbf{P}_2) = N_1(1,0) = a_1 + b_1 = 0 \\implies b_1 = -1$\n$N_1(\\mathbf{P}_3) = N_1(0,1) = a_1 + c_1 = 0 \\implies c_1 = -1$\n因此，$N_1(x,y) = 1 - x - y$。\n\n对于形函数 $N_2(x,y)$：\n$N_2(\\mathbf{P}_1) = N_2(0,0) = a_2 = 0$\n$N_2(\\mathbf{P}_2) = N_2(1,0) = a_2 + b_2 = 1 \\implies b_2 = 1$\n$N_2(\\mathbf{P}_3) = N_2(0,1) = a_2 + c_2 = 0 \\implies c_2 = 0$\n因此，$N_2(x,y) = x$。\n\n对于形函数 $N_3(x,y)$：\n$N_3(\\mathbf{P}_1) = N_3(0,0) = a_3 = 0$\n$N_3(\\mathbf{P}_2) = N_3(1,0) = a_3 + b_3 = 0 \\implies b_3 = 0$\n$N_3(\\mathbf{P}_3) = N_3(0,1) = a_3 + c_3 = 1 \\implies c_3 = 1$\n因此，$N_3(x,y) = y$。\n\n接下来，我们构建标量场 $u(x,y)=x^2+xy$ 的节点插值 $I_h u$。该插值函数定义为：\n$$I_h u(x,y) = \\sum_{i=1}^{3} u(\\mathbf{P}_i) N_i(x,y)$$\n我们计算 $u(x,y)$ 在顶点处的值：\n$u_1 = u(\\mathbf{P}_1) = u(0,0) = 0^2 + (0)(0) = 0$\n$u_2 = u(\\mathbf{P}_2) = u(1,0) = 1^2 + (1)(0) = 1$\n$u_3 = u(\\mathbf{P}_3) = u(0,1) = 0^2 + (0)(1) = 0$\n\n将这些节点值代入插值公式：\n$I_h u(x,y) = u_1 N_1(x,y) + u_2 N_2(x,y) + u_3 N_3(x,y) = (0)N_1(x,y) + (1)N_2(x,y) + (0)N_3(x,y) = N_2(x,y) = x$。\n\n插值误差 $e(x,y)$ 是原函数与其插值函数之间的差值：\n$e(x,y) = u(x,y) - I_h u(x,y) = (x^2 + xy) - x = x^2 + xy - x$。\n\n最后，我们计算误差的 $L^2$ 范数 $\\|e\\|_{L^2(T)}$，这需要将误差函数的平方在三角形域 $T$ 上进行积分。\n$$\\|e\\|_{L^2(T)}^2 = \\int_T e(x,y)^2 \\, \\mathrm{d}A = \\int_T (x^2 + xy - x)^2 \\, \\mathrm{d}A$$\n域 $T$ 由不等式 $x \\ge 0$、$y \\ge 0$ 和 $x+y \\le 1$ 描述。我们可以将二重积分写为：\n$$\\|e\\|_{L^2(T)}^2 = \\int_{0}^{1} \\int_{0}^{1-x} (x^2 + xy - x)^2 \\, \\mathrm{d}y \\, \\mathrm{d}x$$\n被积函数可以简化为：$(x^2 + xy - x)^2 = (x(x+y-1))^2 = x^2(x+y-1)^2$。\n首先，我们对 $y$ 进行积分：\n$$ \\int_{0}^{1-x} x^2(x+y-1)^2 \\, \\mathrm{d}y $$\n令 $z = x+y-1$，则 $\\mathrm{d}z = \\mathrm{d}y$。$z$ 的积分上下限是从 $x-1$ (当 $y=0$ 时) 到 $0$ (当 $y=1-x$ 时)。\n$$ \\int_{x-1}^{0} x^2 z^2 \\, \\mathrm{d}z = x^2 \\left[ \\frac{z^3}{3} \\right]_{x-1}^{0} = x^2 \\left( 0 - \\frac{(x-1)^3}{3} \\right) = -\\frac{x^2(x-1)^3}{3} = \\frac{x^2(1-x)^3}{3} $$\n接下来，我们将此结果对 $x$ 从 $0$ 到 $1$ 进行积分：\n$$ \\|e\\|_{L^2(T)}^2 = \\int_{0}^{1} \\frac{x^2(1-x)^3}{3} \\, \\mathrm{d}x = \\frac{1}{3} \\int_{0}^{1} x^2(1-x)^3 \\, \\mathrm{d}x $$\n这个积分是Beta函数的一个实例，$B(m,n) = \\int_{0}^{1} t^{m-1}(1-t)^{n-1} \\, \\mathrm{d}t = \\frac{\\Gamma(m)\\Gamma(n)}{\\Gamma(m+n)}$。\n在本例中，$m-1=2$ 且 $n-1=3$，所以 $m=3$ 且 $n=4$。\n$$ \\int_{0}^{1} x^2(1-x)^3 \\, \\mathrm{d}x = B(3,4) = \\frac{\\Gamma(3)\\Gamma(4)}{\\Gamma(3+4)} = \\frac{2! \\cdot 3!}{6!} = \\frac{2 \\cdot 6}{720} = \\frac{12}{720} = \\frac{1}{60} $$\n或者，我们可以展开多项式并逐项积分：\n$$ \\int_{0}^{1} x^2(1 - 3x + 3x^2 - x^3) \\, \\mathrm{d}x = \\int_{0}^{1} (x^2 - 3x^3 + 3x^4 - x^5) \\, \\mathrm{d}x $$\n$$ = \\left[ \\frac{x^3}{3} - \\frac{3x^4}{4} + \\frac{3x^5}{5} - \\frac{x^6}{6} \\right]_{0}^{1} = \\frac{1}{3} - \\frac{3}{4} + \\frac{3}{5} - \\frac{1}{6} $$\n分母的最小公倍数是 $60$：\n$$ = \\frac{20 - 45 + 36 - 10}{60} = \\frac{56 - 55}{60} = \\frac{1}{60} $$\n所以，我们得到：\n$$ \\|e\\|_{L^2(T)}^2 = \\frac{1}{3} \\cdot \\frac{1}{60} = \\frac{1}{180} $$\n$L^2$ 范数是该值的平方根：\n$$ \\|e\\|_{L^2(T)} = \\sqrt{\\frac{1}{180}} = \\frac{1}{\\sqrt{180}} = \\frac{1}{\\sqrt{36 \\cdot 5}} = \\frac{1}{6\\sqrt{5}} $$\n为了使分母有理化，我们将分子和分母同乘以 $\\sqrt{5}$：\n$$ \\|e\\|_{L^2(T)} = \\frac{\\sqrt{5}}{6 \\cdot 5} = \\frac{\\sqrt{5}}{30} $$",
            "answer": "$$\\boxed{\\frac{\\sqrt{5}}{30}}$$"
        },
        {
            "introduction": "虽然上一个练习使用了理想的直角三角形，但真实的航空航天应用，如翼型分析，不可避免地涉及弯曲边界。本练习将介绍功能强大的等参元概念，其中用于逼近解的形函数也同样被用来描述单元自身的几何形状。你将通过实践计算雅可比矩阵及其行列式，这是将复杂物理单元上的积分变换回简单参考单元进行计算的关键数学工具。",
            "id": "4006148",
            "problem": "考虑一个用于计算流体动力学（CFD）的空气动力学网格中的二维曲边边界相邻单元，该方法基于有限元法（FEM）和 Galerkin 加权残差法。该单元是一个二次六节点三角形，用于表示翼型的局部弯曲部分。参考单元是参数空间中的标准单位直角三角形，其局部坐标为 $\\boldsymbol{\\xi} = (\\xi,\\eta)$，顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$。三个顶点节点和三个边中节点在物理空间中的位置如下：\n$$\n(x_1,y_1) = (0,0),\\quad (x_2,y_2) = (2.0,0.0),\\quad (x_3,y_3) = (0.0,2.0),\n$$\n$$\n(x_4,y_4) = (1.0,0.2),\\quad (x_5,y_5) = (0.7,1.3),\\quad (x_6,y_6) = (0.2,1.0),\n$$\n其中节点 $1$、$2$ 和 $3$ 分别是对应于参考三角形上 $(\\xi,\\eta) = (0,0)$、$(1,0)$ 和 $(0,1)$ 的顶点，而节点 $4$、$5$ 和 $6$ 分别是对应于 $(\\xi,\\eta) = (0.5,0)$、$(0.5,0.5)$ 和 $(0,0.5)$ 的边中节点。\n\n从等参概念的基本定义出发，即用于解的近似的多项式基与用于插值几何的多项式基相同，执行以下操作：\n\n1. 对此曲边六节点三角形单元，根据定义在参考三角形上的二次 Lagrange 形函数，推导其等参映射 $\\boldsymbol{x}(\\boldsymbol{\\xi}) = (x(\\xi,\\eta),y(\\xi,\\eta))$。清晰地表达几何形状是如何通过节点坐标插值得到的。\n\n2. 使用该映射，计算在参考三角形的形心 $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的雅可比矩阵\n$$\n\\boldsymbol{J}(\\xi,\\eta) = \\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix},\n$$\n及其行列式 $J(\\xi,\\eta) = \\det \\boldsymbol{J}(\\xi,\\eta)$。\n\n3. 解释在 Galerkin 加权残差法下，雅可比行列式在变换弱形式积分中的作用，特别是对于单元 $E$ 上的局部 $L^{2}$ 内积，\n$$\nI \\;=\\; \\int_{E} N_1(\\boldsymbol{x})\\,N_1(\\boldsymbol{x}) \\,\\mathrm{d}\\Omega,\n$$\n其中 $N_1$ 是与节点 $1$ 相关的单元的第一个二次形函数，$\\mathrm{d}\\Omega$ 是物理面积微分。\n\n4. 在参考三角形上使用单点求积（对线性多项式精确），通过在形心 $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处求值来近似变换后的积分，求积权重等于参考三角形的面积。将 $I$ 的近似值的最终答案表示为一个精确的有理数。不包含任何物理单位，也不要四舍五入；以最简分数形式给出精确值。",
            "solution": "在有限元法（FEM）中，等参概念将几何形状和解的近似置于同一多项式空间中。对于二次六节点三角形单元，几何形状通过二次 Lagrange 形函数从参考三角形映射到物理三角形。用 $L_1 = 1 - \\xi - \\eta$，$L_2 = \\xi$ 和 $L_3 = \\eta$ 表示参考面积（重心）坐标。参考三角形上的六个二次 Lagrange 形函数为\n$$\nN_1 = L_1\\,(2L_1 - 1),\\quad\nN_2 = L_2\\,(2L_2 - 1),\\quad\nN_3 = L_3\\,(2L_3 - 1),\n$$\n$$\nN_4 = 4\\,L_1\\,L_2,\\quad\nN_5 = 4\\,L_2\\,L_3,\\quad\nN_6 = 4\\,L_3\\,L_1.\n$$\n通过几何的等参插值，从参考坐标 $\\boldsymbol{\\xi}=(\\xi,\\eta)$ 到物理坐标 $\\boldsymbol{x}=(x,y)$ 的映射为\n$$\nx(\\xi,\\eta) \\;=\\; \\sum_{i=1}^{6} N_i(\\xi,\\eta)\\,x_i,\\qquad\ny(\\xi,\\eta) \\;=\\; \\sum_{i=1}^{6} N_i(\\xi,\\eta)\\,y_i,\n$$\n其中 $(x_i,y_i)$ 是单元的物理节点坐标。\n\n该映射的雅可比矩阵为\n$$\n\\boldsymbol{J}(\\xi,\\eta) \\;=\\;\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,x_i  \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,x_i \\\\\n\\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,y_i  \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,y_i\n\\end{pmatrix}.\n$$\n我们现在计算在参考三角形的形心 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处形函数的导数。在形心处，重心坐标为 $L_1=L_2=L_3=\\frac{1}{3}$。形心处的形函数值为：\n$$\nN_1 = \\frac{1}{3}\\left(\\frac{2}{3} - 1\\right) = -\\frac{1}{9},\\quad\nN_2 = -\\frac{1}{9},\\quad\nN_3 = -\\frac{1}{9},\\quad\nN_4 = \\frac{4}{9},\\quad\nN_5 = \\frac{4}{9},\\quad\nN_6 = \\frac{4}{9}.\n$$\n重心坐标的导数为\n$$\n\\frac{\\partial L_1}{\\partial \\xi} = -1,\\quad \\frac{\\partial L_1}{\\partial \\eta} = -1,\\qquad\n\\frac{\\partial L_2}{\\partial \\xi} = 1,\\quad \\frac{\\partial L_2}{\\partial \\eta} = 0,\\qquad\n\\frac{\\partial L_3}{\\partial \\xi} = 0,\\quad \\frac{\\partial L_3}{\\partial \\eta} = 1.\n$$\n使用乘法法则和链式法则，在 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的形函数导数为：\n- 对于 $N_1 = L_1(2L_1 - 1)$，\n$$\n\\frac{\\partial N_1}{\\partial \\xi} = -4 L_1 + 1 = -\\frac{1}{3},\\qquad\n\\frac{\\partial N_1}{\\partial \\eta} = -4 L_1 + 1 = -\\frac{1}{3}.\n$$\n- 对于 $N_2 = L_2(2L_2 - 1)$，\n$$\n\\frac{\\partial N_2}{\\partial \\xi} = 4 L_2 - 1 = \\frac{1}{3},\\qquad\n\\frac{\\partial N_2}{\\partial \\eta} = 0.\n$$\n- 对于 $N_3 = L_3(2L_3 - 1)$，\n$$\n\\frac{\\partial N_3}{\\partial \\xi} = 0,\\qquad\n\\frac{\\partial N_3}{\\partial \\eta} = 4 L_3 - 1 = \\frac{1}{3}.\n$$\n- 对于 $N_4 = 4 L_1 L_2$，\n$$\n\\frac{\\partial N_4}{\\partial \\xi} = 4(L_1 - L_2) = 0,\\qquad\n\\frac{\\partial N_4}{\\partial \\eta} = -4 L_2 = -\\frac{4}{3}.\n$$\n- 对于 $N_5 = 4 L_2 L_3$，\n$$\n\\frac{\\partial N_5}{\\partial \\xi} = 4 L_3 = \\frac{4}{3},\\qquad\n\\frac{\\partial N_5}{\\partial \\eta} = 4 L_2 = \\frac{4}{3}.\n$$\n- 对于 $N_6 = 4 L_3 L_1$，\n$$\n\\frac{\\partial N_6}{\\partial \\xi} = -4 L_3 = -\\frac{4}{3},\\qquad\n\\frac{\\partial N_6}{\\partial \\eta} = 4(L_1 - L_3) = 0.\n$$\n利用给定的节点坐标，我们计算形心处的雅可比矩阵各项。首先，对于 $\\frac{\\partial x}{\\partial \\xi}$：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,x_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 2 + 0\\cdot 0 + 0\\cdot 1 + \\left(\\frac{4}{3}\\right)\\cdot 0.7 + \\left(-\\frac{4}{3}\\right)\\cdot 0.2\n= \\frac{4}{3}.\n$$\n接下来，对于 $\\frac{\\partial x}{\\partial \\eta}$：\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,x_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 2 + \\left(\\frac{1}{3}\\right)\\cdot 0 + \\left(-\\frac{4}{3}\\right)\\cdot 1 + \\left(\\frac{4}{3}\\right)\\cdot 0.7 + 0\\cdot 0.2\n= -\\frac{2}{5}.\n$$\n对于 $\\frac{\\partial y}{\\partial \\xi}$：\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,y_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 2 + 0\\cdot 0.2 + \\left(\\frac{4}{3}\\right)\\cdot 1.3 + \\left(-\\frac{4}{3}\\right)\\cdot 1.0\n= \\frac{2}{5}.\n$$\n对于 $\\frac{\\partial y}{\\partial \\eta}$：\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,y_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 2 + \\left(-\\frac{4}{3}\\right)\\cdot 0.2 + \\left(\\frac{4}{3}\\right)\\cdot 1.3 + 0\\cdot 1.0\n= \\frac{32}{15}.\n$$\n因此，在 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的雅可比矩阵为\n$$\n\\boldsymbol{J}\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\n=\n\\begin{pmatrix}\n\\frac{4}{3}  -\\frac{2}{5} \\\\\n\\frac{2}{5}  \\frac{32}{15}\n\\end{pmatrix},\n$$\n其行列式为\n$$\nJ\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\n= \\left(\\frac{4}{3}\\right)\\left(\\frac{32}{15}\\right) - \\left(-\\frac{2}{5}\\right)\\left(\\frac{2}{5}\\right)\n= \\frac{128}{45} + \\frac{4}{25}\n= \\frac{676}{225}.\n$$\n\n在 Galerkin 加权残差法下，雅可比行列式在变换弱形式积分中的作用由变量替换公式给出。对于定义在曲边物理单元 $E$ 上的任意被积函数 $g(\\boldsymbol{x})$，面积分变换到参考单元 $\\hat{E}$ 上为\n$$\n\\int_{E} g(\\boldsymbol{x})\\,\\mathrm{d}\\Omega\n=\n\\int_{\\hat{E}} g\\big(\\boldsymbol{x}(\\boldsymbol{\\xi})\\big)\\,\\big|J(\\boldsymbol{\\xi})\\big|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\n其中 $\\big|J(\\boldsymbol{\\xi})\\big| = \\det\\boldsymbol{J}(\\boldsymbol{\\xi})$ 解释了由映射引起的局部度量畸变和面积缩放。\n\n对于单元上指定的弱形式内积，\n$$\nI = \\int_{E} N_1(\\boldsymbol{x})\\,N_1(\\boldsymbol{x})\\,\\mathrm{d}\\Omega,\n$$\n在参考单元上的变换积分为\n$$\nI = \\int_{\\hat{E}} N_1(\\xi,\\eta)^2 \\,\\big|J(\\xi,\\eta)\\big|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta.\n$$\n在形心 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处使用单点求积，权重等于参考三角形的面积，\n$$\nw = \\text{area}(\\hat{E}) = \\frac{1}{2},\n$$\n我们得到近似值\n$$\nI \\;\\approx\\; w \\; N_1\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)^{2}\\; \\bigg|J\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\\bigg|.\n$$\n我们已经计算出 $N_1\\left(\\frac{1}{3},\\frac{1}{3}\\right) = -\\frac{1}{9}$ 和 $J\\left(\\frac{1}{3},\\frac{1}{3}\\right) = \\frac{676}{225}$。因此，\n$$\nI \\;\\approx\\; \\frac{1}{2} \\left(-\\frac{1}{9}\\right)^{2} \\cdot \\frac{676}{225}\n\\;=\\;\n\\frac{1}{2}\\cdot \\frac{1}{81} \\cdot \\frac{676}{225}\n\\;=\\;\n\\frac{676}{2 \\cdot 81 \\cdot 225}\n\\;=\\;\n\\frac{676}{36450}\n\\;=\\;\n\\frac{338}{18225}.\n$$\n这是对曲边单元上的局部 $L^{2}$ 内积进行指定的单点求积近似所得的精确有理数值。",
            "answer": "$$\\boxed{\\frac{338}{18225}}$$"
        },
        {
            "introduction": "雅可比行列式$J$不仅仅是积分变换中的一个数学项，它还具有深刻的物理意义，关系到单元的体积（或面积）和局部朝向。本练习紧接前一个实践，深入探讨当几何映射出错、导致雅可比行列式为负（$J \\lt 0$）时会发生什么，这种情况被称为“单元翻转”。理解如何诊断和修正这种导致计算发散的非物理情况，是任何CFD工程师都必须掌握的重要实践技能。",
            "id": "3952762",
            "problem": "考虑一个从计算坐标空间 $(\\xi,\\eta,\\zeta)$ 到物理空间 $(x,y,z)$ 的光滑一一映射，该映射由位置矢量 $\\mathbf{r}(\\xi,\\eta,\\zeta)$ 给出。定义协变基矢量 $\\mathbf{a}_{\\xi} = \\partial \\mathbf{r}/\\partial \\xi$、$\\mathbf{a}_{\\eta} = \\partial \\mathbf{r}/\\partial \\eta$ 和 $\\mathbf{a}_{\\zeta} = \\partial \\mathbf{r}/\\partial \\zeta$。局部雅可比行列式为 $J = \\det\\left(\\partial(x,y,z)/\\partial(\\xi,\\eta,\\zeta)\\right)$，它也等于标量三重积 $J = \\mathbf{a}_{\\xi}\\cdot(\\mathbf{a}_{\\eta}\\times \\mathbf{a}_{\\zeta})$。相关的逆变面积矢量通常定义为 $\\mathbf{A}^{\\xi} = \\mathbf{a}_{\\eta}\\times \\mathbf{a}_{\\zeta}$、$\\mathbf{A}^{\\eta} = \\mathbf{a}_{\\zeta}\\times \\mathbf{a}_{\\xi}$ 和 $\\mathbf{A}^{\\zeta} = \\mathbf{a}_{\\xi}\\times \\mathbf{a}_{\\eta}$，并满足关系 $J\\,\\mathbf{a}^{i} = \\mathbf{A}^{i}$（对于 $i\\in\\{\\xi,\\eta,\\zeta\\}$），其中 $\\mathbf{a}^{i}$ 是逆变基矢量。在计算流体动力学 (CFD) 中使用的守恒律的曲线坐标系公式（例如可压缩欧拉方程）中，通量被投影到外法线方向上，或者等效地，投影到由 $\\mathbf{A}^{i}$ 导出的逆变方向上，并且通过使用适当的度量项变换到 $(\\xi,\\eta,\\zeta)$ 空间来强制实现控制体内的守恒。\n\n从上述几何和变换定义出发，论述雅可比行列式 $J$ 的符号（特别是 $J  0$ 的情况）的物理和数值影响，并讨论在曲线网格（结构化或非结构化，二维/三维）中检测和处理单元反转的稳健诊断和修正措施。选择所有正确的陈述。\n\nA. $J$ 的符号编码了局部定向。如果 $J  0$，由 $(\\xi,\\eta,\\zeta)$ 导出的基的定向相对于 $(x,y,z)$ 发生反转；因此，相关的逆变面积矢量 $\\mathbf{A}^{i}$ 相对于预期的控制体边界指向内部而非外部，从而在有限体积法 (FVM) 中翻转了投影通量的符号，并产生非物理的外法线方向。\n\nB. 负的 $J$ 仅仅是重新缩放通量的大小；在任何出现 $J$ 的地方使用 $|J|$ 都能保持通量方向并维持守恒，因此在可压缩流求解器中可以容忍反转单元而不会损害物理保真度。\n\nC. 针对单元反转的稳健诊断程序包括：在每个单元的多个求积点上计算 $J$ 并拒绝 $J\\le 0$ 的单元；以离散方式验证连续度量恒等式 $\\partial_{\\xi}\\mathbf{A}^{\\xi} + \\partial_{\\eta}\\mathbf{A}^{\\eta} + \\partial_{\\zeta}\\mathbf{A}^{\\zeta} = \\mathbf{0}$ 以确保自由来流保持；以及检查相邻单元间的面面积矢量是否具有一致的定向（例如，两个相邻单元共享面的法线大小相等、方向相反）。违反这些检查表明可能存在单元反转或度量不一致性。\n\nD. 对反转单元的一种全局一致的修正是将网格中所有的面法线乘以 $-1$，这可以在任何地方恢复正的 $J$，同时保持边界条件方向和离散度量恒等式。\n\nE. 在二维 ($2$-D) 结构化网格中，负的 $J$ 是无害的，因为通量变换只需要大小 $|J|$。因此，在二维中不需要对反转进行诊断检查。\n\nF. 一种保持几何形状的一致修正是重新定向局部单元的连接关系以强制 $J0$（例如，交换两个顶点以恢复右手定则排序），然后重新计算度量项和面定向；如果重新定向无法解决病态单元，则在进行CFD模拟之前，局部平滑或重新生成网格，以消除 $J\\approx 0$ 或 $J  0$ 的区域。\n\n选择所有适用的选项。根据几何变换定义和守恒要求提供你的理由，不要借助未记录的捷径或特定于实现的技巧。",
            "solution": "该问题涉及在计算流体动力学 (CFD) 背景下，从计算坐标系 $(\\xi,\\eta,\\zeta)$ 到物理坐标系 $(x,y,z)$ 的变换的雅可比行列式 $J$ 的几何和数值影响。验证和分析将基于所提供的定义以及微分几何和有限体积法 (FVM) 的第一性原理。\n\n首先，我们建立基本原理。物理空间中的位置矢量由 $\\mathbf{r}(\\xi,\\eta,\\zeta)$ 给出。协变基矢量定义为位置矢量对计算坐标的偏导数：$\\mathbf{a}_{\\xi} = \\frac{\\partial \\mathbf{r}}{\\partial \\xi}$、$\\mathbf{a}_{\\eta} = \\frac{\\partial \\mathbf{r}}{\\partial \\eta}$ 和 $\\mathbf{a}_{\\zeta} = \\frac{\\partial \\mathbf{r}}{\\partial \\zeta}$。这三个矢量在物理域的每个点上形成一个局部基。\n\n雅可比行列式 $J$ 由这些基矢量的标量三重积给出：\n$$J = \\mathbf{a}_{\\xi} \\cdot (\\mathbf{a}_{\\eta} \\times \\mathbf{a}_{\\zeta})$$\n从几何上看，大小 $|J|$ 表示由基矢量 $(\\mathbf{a}_{\\xi}, \\mathbf{a}_{\\eta}, \\mathbf{a}_{\\zeta})$ 张成的无穷小平面的体积。至关重要的是，$J$ 的符号决定了这个局部基的定向或“手性”。假设计算坐标系 $(\\xi, \\eta, \\zeta)$ 是右手的，则正的雅可比行列式 ($J  0$) 表明局部基 $(\\mathbf{a}_{\\xi}, \\mathbf{a}_{\\eta}, \\mathbf{a}_{\\zeta})$ 也是右手的。这意味着从计算空间到物理空间的映射保持了局部定向。相反，负的雅可比行列式 ($J  0$) 表示局部基是左手的，意味着映射反转了定向。这对应于一个“折叠”、“纠缠”或“反转”的网格单元。雅可比行列式为零 ($J=0$) 表示一个退化单元，其中基矢量共面，导致体积为零。\n\n在有限体积法中，形如 $\\frac{\\partial Q}{\\partial t} + \\nabla \\cdot \\mathbf{F} = 0$ 的守恒律在一个控制体 $V$ 上进行积分。利用散度定理并变换到计算域，方程变为：\n$$ \\frac{\\partial}{\\partial t}\\int_{V_{\\xi}} Q J \\, d\\xi d\\eta d\\zeta + \\int_{\\partial V_{\\xi}} \\hat{\\mathbf{F}} \\cdot d\\mathbf{S}_{\\xi} = 0 $$\n其中 $d V = J \\, d\\xi d\\eta d\\zeta$ 是物理体积元，通量在计算单元的面上进行计算。例如，通过一个常数 $\\xi$ 面的通量由物理通量矢量与逆变面积矢量 $\\mathbf{A}^{\\xi} = \\mathbf{a}_{\\eta} \\times \\mathbf{a}_{\\zeta}$ 的点积给出。流出计算单元的总通量涉及诸如 $\\mathbf{F} \\cdot \\mathbf{A}^{\\xi}$、$\\mathbf{F} \\cdot \\mathbf{A}^{\\eta}$ 和 $\\mathbf{F} \\cdot \\mathbf{A}^{\\zeta}$ 的项。对于一个适定的物理问题，单元体积必须为正 ($J  0$)，并且面积矢量（例如，对于较大 $\\xi$ 处的面，为 $\\mathbf{A}^{\\xi}$）必须指向控制体的外部。\n\n在这些原理建立之后，我们评估每个陈述。\n\n**A. $J$ 的符号编码了局部定向。如果 $J  0$，由 $(\\xi,\\eta,\\zeta)$ 导出的基的定向相对于 $(x,y,z)$ 发生反转；因此，相关的逆变面积矢量 $\\mathbf{A}^{i}$ 相对于预期的控制体边界指向内部而非外部，从而在有限体积法 (FVM) 中翻转了投影通量的符号，并产生非物理的外法线方向。**\n这个陈述是正确的。如前所述，$J = \\mathbf{a}_{\\xi} \\cdot (\\mathbf{a}_{\\eta} \\times \\mathbf{a}_{\\zeta})$ 的符号定义了局部定向。如果 $J  0$，局部基 $(\\mathbf{a}_{\\xi}, \\mathbf{a}_{\\eta}, \\mathbf{a}_{\\zeta})$ 是左手的。对于一个由递增的 $\\xi$、$\\eta$ 和 $\\zeta$ 定义的控制体单元，一个常数 $\\xi$ 面的“外”方向直观上是沿着 $\\xi$ 递增的方向。然而，在左手系中，叉积 $\\mathbf{A}^{\\xi} = \\mathbf{a}_{\\eta} \\times \\mathbf{a}_{\\zeta}$ 将指向与右手系所产生的方向相反的方向，即它将指向“内部”。因此，依赖于通量矢量与该面积矢量（例如 $\\mathbf{F} \\cdot \\mathbf{A}^{\\xi}$）点积的通量计算，其符号将被翻转。这会在离散守恒律中引入一个非物理的源项或汇项，通常会导致数值不稳定和物理上无意义的结果。\n**结论：正确。**\n\n**B. 负的 $J$ 仅仅是重新缩放通量的大小；在任何出现 $J$ 的地方使用 $|J|$ 都能保持通量方向并维持守恒，因此在可压缩流求解器中可以容忍反转单元而不会损害物理保真度。**\n这个陈述是根本错误的。$J  0$ 的问题不仅仅是一个简单的缩放问题。这是一个定向和方向问题。逆变面积矢量 $\\mathbf{A}^{i}$ 的方向由协变基矢量的叉积决定。如果 $J  0$，正如在选项 A 的分析中确立的，这些矢量指向内部。变换后的守恒律明确使用了与这些 $\\mathbf{A}^i$ 矢量的点积。简单地用 $|J|$ 替换体积元 $J$ 并不能纠正通量贡献是用指向内部的法线计算这一事实。这违反了守恒的物理原理，并反转了该单元的通量输运符号，使得数值格式不稳定且非物理。反转的单元是不能容忍的。\n**结论：不正确。**\n\n**C. 针对单元反转的稳健诊断程序包括：在每个单元的多个求积点上计算 $J$ 并拒绝 $J\\le 0$ 的单元；以离散方式验证连续度量恒等式 $\\partial_{\\xi}\\mathbf{A}^{\\xi} + \\partial_{\\eta}\\mathbf{A}^{\\eta} + \\partial_{\\zeta}\\mathbf{A}^{\\zeta} = \\mathbf{0}$ 以确保自由来流保持；以及检查相邻单元间的面面积矢量是否具有一致的定向（例如，两个相邻单元共享面的法线大小相等、方向相反）。违反这些检查表明可能存在单元反转或度量不一致性。**\n这个陈述描述了一套标准且必要的网格质量检查。\n1. 计算 $J$ 是检测反转 ($J  0$) 或退化 ($J = 0$) 的直接方法。对于高阶单元，其中基矢量以及 $J$ 可以在单元内部变化，检查 $J$ 在多个位置（例如高斯求积点）的符号以确保它在整个单元内都为正是至关重要的。\n2. 恒等式 $\\sum_{i \\in \\{\\xi,\\eta,\\zeta\\}} \\partial_i \\mathbf{A}^i = \\mathbf{0}$ 是一个基本的矢量微积分恒等式，它源于面积矢量的定义（假设有足够的光滑性）。在离散形式下，这被称为几何守恒律 (GCL)。它的满足是数值格式保持均匀流场（自由来流保持）的必要条件。一个具有错误定向面矢量的反转单元，将导致对该定律的任何一致离散表示的严重违反。\n3. 在一个有效的 FVM 离散化中，从单元 $I$ 到相邻单元 $J$ 穿过它们公共面的通量必须与从 $J$ 到 $I$ 的通量大小相等、方向相反。这要求它们共享的面法线矢量大小相等、方向相反：$\\mathbf{S}_{IJ} = -\\mathbf{S}_{JI}$。一个反转的单元的面法线将与其有效的邻居不一致，违反此条件并破坏守恒。\n该陈述的所有部分都描述了有效且稳健的诊断程序。\n**结论：正确。**\n\n**D. 对反转单元的一种全局一致的修正是将网格中所有的面法线乘以 $-1$，这可以在任何地方恢复正的 $J$，同时保持边界条件方向和离散度量恒等式。**\n这个陈述提出了一个无效的修正方法。反转单元的问题是局部的；一些单元与其他单元具有不同的定向。一个全局操作，例如将所有面法线 $(\\mathbf{A}^i)$ 乘以 $-1$，是不合适的。这样的操作会处处翻转雅可比行列式 $J = \\mathbf{a}_{\\xi} \\cdot \\mathbf{A}^{\\xi} / g^{\\xi\\xi}$ （其中 $g^{\\xi\\xi}$ 是度量张量分量）的符号。因此，最初有效的单元（$J0$）会变为反转，而最初反转的单元（$J  0$）相对于新的、全局翻转的定向会变得“有效”。这并不能修复不一致性。此外，它还会反转所有边界法线，将物理入口变为出口，反之亦然，从而完全改变了正在求解的问题。\n**结论：不正确。**\n\n**E. 在二维 ($2$-D) 结构化网格中，负的 $J$ 是无害的，因为通量变换只需要大小 $|J|$。因此，在二维中不需要对反转进行诊断检查。**\n这个陈述是不正确的。其原理在二维中是类似的。映射是从 $(\\xi, \\eta)$ 到 $(x, y)$。雅可比行列式是 $J = \\det(\\partial(x,y)/\\partial(\\xi,\\eta))$。负的 $J$ 表明一个四边形单元“翻转”或“折叠”了，反转了其定向。面积矢量的二维等价物（即与单元边垂直并按边长缩放的矢量）将指向内部，导致与三维情况相同的通量计算符号错误。在二维中问题同样严重，对 $J \\le 0$ 的诊断检查同样是必要的。\n**结论：不正确。**\n\n**F. 一种保持几何形状的一致修正是重新定向局部单元的连接关系以强制 $J0$（例如，交换两个顶点以恢复右手定则排序），然后重新计算度量项和面定向；如果重新定向无法解决病态单元，则在进行CFD模拟之前，局部平滑或重新生成网格，以消除 $J\\approx 0$ 或 $J  0$ 的区域。**\n这个陈述描述了修复反转单元的正确和标准程序。单元的雅可比行列式（或体积）的符号由其定义顶点（其连接关系）的排序决定。对于一个 $J  0$ 的单元，通常可以找到其顶点的不同排列方式，从而得到 $J  0$。例如，交换一个四面体的两个顶点将翻转其有向体积的符号。这是一种拓扑修正，它保留了网格节点的几何位置。如果这种重新排序失败（例如，对于一个“蝶形”四边形，其节点位置如此糟糕以至于没有一种排序能给出凸形），则必须修改其底层几何结构。这是通过网格平滑算法（它重新定位节点以提高单元质量）或通过局部删除无效单元并在该区域重新生成新的有效网格来实现的。这种分层方法是CFD稳健网格生成和预处理中的标准实践。\n**结论：正确。**",
            "answer": "$$\\boxed{ACF}$$"
        }
    ]
}