{
    "hands_on_practices": [
        {
            "introduction": "When we discretize time-dependent conservation laws using the Galerkin method, the result is a system of ordinary differential equations governed by a global mass matrix. This exercise explores the construction of this matrix at the element level and introduces a crucial practical technique known as mass lumping. By working through the derivation of both the 'consistent' and 'lumped' mass matrices, you will gain direct insight into the fundamental trade-off between mathematical fidelity and computational efficiency that is central to designing explicit time-stepping schemes in CFD .",
            "id": "3956605",
            "problem": "In a semi-discrete Galerkin formulation of a scalar conservation law in Computational Fluid Dynamics (CFD), the element mass matrix on a single linear triangular finite element $K$ with constant density $\\rho$ and area $A$ is defined by the bilinear form of the basis (shape) functions. Let $\\{N_{1},N_{2},N_{3}\\}$ be the standard linear shape functions associated with the vertices of $K$ and satisfying the Kronecker delta property $N_{i}(\\mathbf{x}_{j})=\\delta_{ij}$ at the vertices $\\{\\mathbf{x}_{1},\\mathbf{x}_{2},\\mathbf{x}_{3}\\}$, and the partition of unity $\\sum_{i=1}^{3}N_{i}=1$. The consistent element mass matrix is defined by\n$$\nM_{ij}^{\\text{cons}}=\\int_{K}\\rho\\,N_{i}N_{j}\\,\\mathrm{d}A.\n$$\nTasks:\n1) Starting from the definitions of the shape functions on the reference triangle and an affine mapping to $K$, derive the exact entries of $M_{ij}^{\\text{cons}}$ in terms of $\\rho$ and $A$.\n2) Construct a diagonal (lumped) mass matrix $M_{ij}^{\\text{lump}}$ by approximating the integral with a three-point quadrature rule that uses the three vertices of $K$ as quadrature points and has equal weights chosen so that the rule is exact for all polynomials of total degree at most $1$. Use this to derive the analytic expression for the diagonal entries of $M_{ij}^{\\text{lump}}$ in terms of $\\rho$ and $A$.\n3) Briefly discuss, without further calculation, the trade-off between employing a diagonal lumped mass matrix and preserving interpolation accuracy in explicit time integration for convection-dominated problems.\n\nReport as your final answer only the analytic expression for the diagonal entry of $M_{ij}^{\\text{lump}}$ in terms of $\\rho$ and $A$. Do not include units. If you introduce any additional symbols, define them clearly. No numerical rounding is required; provide an exact expression.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n-   Formulation: Semi-discrete Galerkin for a scalar conservation law in CFD.\n-   Element: A linear triangular finite element, $K$.\n-   Parameters: Constant density $\\rho$, area $A$.\n-   Basis Functions: $\\{N_{1}, N_{2}, N_{3}\\}$, the standard linear shape functions.\n-   Basis Function Properties:\n    1.  Kronecker delta property at vertices $\\{\\mathbf{x}_{1}, \\mathbf{x}_{2}, \\mathbf{x}_{3}\\}$: $N_{i}(\\mathbf{x}_{j})=\\delta_{ij}$.\n    2.  Partition of unity: $\\sum_{i=1}^{3}N_{i}=1$.\n-   Consistent Element Mass Matrix Definition: $M_{ij}^{\\text{cons}}=\\int_{K}\\rho\\,N_{i}N_{j}\\,\\mathrm{d}A$.\n-   Task 1: Derive the entries of $M_{ij}^{\\text{cons}}$ in terms of $\\rho$ and $A$.\n-   Task 2: Construct a diagonal (lumped) mass matrix $M_{ij}^{\\text{lump}}$ using a $3$-point quadrature rule at the vertices with equal weights, such that the rule is exact for polynomials of total degree at most $1$. Derive the analytic expression for the diagonal entries of $M_{ij}^{\\text{lump}}$.\n-   Task 3: Discuss the trade-off between using a lumped mass matrix and preserving accuracy.\n-   Final Answer: Provide the analytic expression for the diagonal entry of $M_{ij}^{\\text{lump}}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard exercise in the theory of the Finite Element Method (FEM) as applied to Computational Fluid Dynamics (CFD).\n-   **Scientifically Grounded**: The definitions of linear shape functions, the Galerkin method, consistent mass matrices, and mass lumping through numerical quadrature are all fundamental and well-established concepts in FEM. The problem is scientifically and mathematically sound.\n-   **Well-Posed**: The problem is clearly defined. The tasks are specific and lead to a unique, derivable result. The properties of the shape functions and the conditions on the quadrature rule are sufficient to determine the required matrices.\n-   **Objective**: The problem is stated in precise, formal language common to mathematics and engineering, with no subjective or ambiguous terminology.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivations**\n\n**Task 1: Derivation of the Consistent Mass Matrix $M_{ij}^{\\text{cons}}$**\n\nThe entries of the consistent mass matrix are given by $M_{ij}^{\\text{cons}}=\\int_{K}\\rho\\,N_{i}N_{j}\\,\\mathrm{d}A$. Since the density $\\rho$ is constant, it can be factored out of the integral: $M_{ij}^{\\text{cons}}=\\rho\\int_{K}N_{i}N_{j}\\,\\mathrm{d}A$.\n\nFor a linear triangular element, the shape functions $N_i$ are identical to the barycentric coordinates, often denoted $L_i$. A standard integral formula for the product of barycentric coordinates over a triangle $K$ of area $A$ is:\n$$\n\\int_{K} L_{1}^{a} L_{2}^{b} L_{3}^{c} \\, \\mathrm{d}A = \\frac{a! \\, b! \\, c!}{(a+b+c+2)!} 2A\n$$\nwhere $a, b, c$ are non-negative integer exponents.\n\nWe apply this formula to compute the integrals of $N_i N_j$.\n\nFor the diagonal entries ($i=j$):\nWe need to compute $\\int_{K} N_{i}^{2} \\, \\mathrm{d}A$. By symmetry, this integral is the same for all $i \\in \\{1, 2, 3\\}$. Let's compute it for $i=1$. This corresponds to setting $a=2, b=0, c=0$ in the formula.\n$$\n\\int_{K} N_{1}^{2} \\, \\mathrm{d}A = \\int_{K} N_{1}^{2} N_{2}^{0} N_{3}^{0} \\, \\mathrm{d}A = \\frac{2! \\, 0! \\, 0!}{(2+0+0+2)!} 2A = \\frac{2}{4!} 2A = \\frac{2}{24} 2A = \\frac{A}{6}\n$$\nThus, the diagonal entries are $M_{ii}^{\\text{cons}} = \\rho \\frac{A}{6}$.\n\nFor the off-diagonal entries ($i \\ne j$):\nWe need to compute $\\int_{K} N_{i}N_{j} \\, \\mathrm{d}A$. By symmetry, this integral is the same for any pair $(i, j)$ with $i \\ne j$. Let's compute it for $i=1, j=2$. This corresponds to setting $a=1, b=1, c=0$ in the formula.\n$$\n\\int_{K} N_{1}N_{2} \\, \\mathrm{d}A = \\int_{K} N_{1}^{1} N_{2}^{1} N_{3}^{0} \\, \\mathrm{d}A = \\frac{1! \\, 1! \\, 0!}{(1+1+0+2)!} 2A = \\frac{1}{4!} 2A = \\frac{1}{24} 2A = \\frac{A}{12}\n$$\nThus, the off-diagonal entries are $M_{ij}^{\\text{cons}} = \\rho \\frac{A}{12}$ for $i \\ne j$.\n\nThe complete consistent element mass matrix is:\n$$\nM^{\\text{cons}} = \\frac{\\rho A}{12}\n\\begin{pmatrix}\n2 & 1 & 1 \\\\\n1 & 2 & 1 \\\\\n1 & 1 & 2\n\\end{pmatrix}\n$$\n\n**Task 2: Derivation of the Lumped Mass Matrix $M_{ij}^{\\text{lump}}$**\n\nThe integral for the mass matrix is to be approximated with a quadrature rule using the $3$ vertices of the triangle, $\\{\\mathbf{x}_{1}, \\mathbf{x}_{2}, \\mathbf{x}_{3}\\}$, as quadrature points, with equal weights $w$. The general form of such a rule for a function $f$ is:\n$$\n\\int_{K} f(\\mathbf{x}) \\, \\mathrm{d}A \\approx \\sum_{k=1}^{3} w f(\\mathbf{x}_{k}) = w \\left( f(\\mathbf{x}_{1}) + f(\\mathbf{x}_{2}) + f(\\mathbf{x}_{3}) \\right)\n$$\nThe weight $w$ is determined by requiring the rule to be exact for all polynomials of total degree at most $1$. We can find $w$ by enforcing exactness for the simplest such polynomial, the constant function $f(\\mathbf{x})=1$.\nThe exact integral is $\\int_{K} 1 \\, \\mathrm{d}A = A$.\nThe quadrature approximation is $w(1+1+1) = 3w$.\nEquating the two gives $3w = A$, so the weight is $w = \\frac{A}{3}$.\n\nThe quadrature rule is therefore:\n$$\n\\int_{K} f(\\mathbf{x}) \\, \\mathrm{d}A \\approx \\frac{A}{3} \\sum_{k=1}^{3} f(\\mathbf{x}_{k})\n$$\nWe apply this rule to the mass matrix integral, $M_{ij}^{\\text{lump}}=\\int_{K}\\rho\\,N_{i}N_{j}\\,\\mathrm{d}A$. The integrand is $f(\\mathbf{x}) = \\rho N_i(\\mathbf{x}) N_j(\\mathbf{x})$.\n$$\nM_{ij}^{\\text{lump}} = \\rho \\frac{A}{3} \\sum_{k=1}^{3} N_{i}(\\mathbf{x}_{k}) N_{j}(\\mathbf{x}_{k})\n$$\nWe use the Kronecker delta property of the shape functions, $N_{i}(\\mathbf{x}_{j}) = \\delta_{ij}$.\n\nFor the diagonal entries ($i=j$):\n$$\nM_{ii}^{\\text{lump}} = \\rho \\frac{A}{3} \\sum_{k=1}^{3} N_{i}(\\mathbf{x}_{k}) N_{i}(\\mathbf{x}_{k}) = \\rho \\frac{A}{3} \\sum_{k=1}^{3} \\left( N_{i}(\\mathbf{x}_{k}) \\right)^{2}\n$$\nFor a specific index, say $i=1$, the sum is:\n$$\n\\left( N_{1}(\\mathbf{x}_{1}) \\right)^{2} + \\left( N_{1}(\\mathbf{x}_{2}) \\right)^{2} + \\left( N_{1}(\\mathbf{x}_{3}) \\right)^{2} = (1)^{2} + (0)^{2} + (0)^{2} = 1\n$$\nThis holds for any $i \\in \\{1, 2, 3\\}$. The sum is always $1$.\nTherefore, the diagonal entries are:\n$$\nM_{ii}^{\\text{lump}} = \\rho \\frac{A}{3} \\cdot 1 = \\frac{\\rho A}{3}\n$$\n\nFor the off-diagonal entries ($i \\ne j$):\n$$\nM_{ij}^{\\text{lump}} = \\rho \\frac{A}{3} \\sum_{k=1}^{3} N_{i}(\\mathbf{x}_{k}) N_{j}(\\mathbf{x}_{k})\n$$\nFor any distinct pair of indices $i \\ne j$, and for any vertex $\\mathbf{x}_k$, at least one of $N_i(\\mathbf{x}_k)$ or $N_j(\\mathbf{x}_k)$ must be zero. This is because at any vertex $\\mathbf{x}_k$, only the shape function $N_k$ is non-zero (and equal to $1$). Therefore, the product $N_{i}(\\mathbf{x}_{k}) N_{j}(\\mathbf{x}_{k})$ is always $0$ for $i \\ne j$.\nFor example, for $i=1, j=2$:\n$$\n\\sum_{k=1}^{3} N_{1}(\\mathbf{x}_{k}) N_{2}(\\mathbf{x}_{k}) = N_{1}(\\mathbf{x}_{1})N_{2}(\\mathbf{x}_{1}) + N_{1}(\\mathbf{x}_{2})N_{2}(\\mathbf{x}_{2}) + N_{1}(\\mathbf{x}_{3})N_{2}(\\mathbf{x}_{3}) = (1)(0) + (0)(1) + (0)(0) = 0\n$$\nThus, the off-diagonal entries are $M_{ij}^{\\text{lump}} = 0$ for $i \\ne j$.\n\nThe lumped mass matrix is:\n$$\nM^{\\text{lump}} = \\frac{\\rho A}{3}\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n\n**Task 3: Discussion of Trade-offs**\n\nIn a semi-discrete finite element formulation for a time-dependent problem, one obtains a system of ordinary differential equations of the form $M \\frac{d\\mathbf{u}}{dt} = \\mathbf{r}(\\mathbf{u})$, where $M$ is the global mass matrix, $\\mathbf{u}$ is the vector of nodal degrees of freedom, and $\\mathbf{r}$ is the residual vector incorporating spatial derivative terms.\n\nFor an explicit time integration scheme (e.g., Forward Euler), the update at each time step is $\\mathbf{u}^{n+1} = \\mathbf{u}^{n} + \\Delta t \\, M^{-1} \\mathbf{r}(\\mathbf{u}^{n})$. The core of the trade-off lies in the structure of $M$ and the cost of computing $M^{-1}\\mathbf{r}$.\n\n1.  **Lumped Mass Matrix ($M^{\\text{lump}}$)**:\n    -   **Advantage**: By construction, $M^{\\text{lump}}$ is a diagonal matrix. Its inverse, $(M^{\\text{lump}})^{-1}$, is also diagonal, with entries being the reciprocals of the diagonal entries of $M^{\\text{lump}}$. The operation $M^{-1}\\mathbf{r}$ becomes a simple, computationally inexpensive vector-vector scaling (element-wise division). This makes explicit time stepping extremely efficient, which is a major benefit in large-scale CFD where millions of time steps may be required.\n    -   **Disadvantage**: Mass lumping is an approximation that degrades the accuracy of the spatial discretization. While the consistent mass matrix for linear elements provides a fourth-order accurate approximation of the dispersion relation (phase error), the lumped mass matrix reduces this to second-order. For convection-dominated problems, this manifests as increased numerical dispersion, meaning waves of different frequencies travel at incorrect speeds, leading to trailing oscillations and a smearing of sharp fronts. The formal order of accuracy of the spatial scheme is compromised.\n\n2.  **Consistent Mass Matrix ($M^{\\text{cons}}$)**:\n    -   **Advantage**: $M^{\\text{cons}}$ arises directly from the Galerkin projection and is thus the most mathematically faithful representation. It preserves the optimal accuracy of the underlying finite element space. As mentioned, it provides superior dispersion properties, which is critical for accurately simulating wave propagation phenomena inherent in convection-dominated flows. This is what the prompt refers to as \"preserving interpolation accuracy\".\n    -   **Disadvantage**: $M^{\\text{cons}}$ is a sparse but not diagonal matrix. Computing $M^{-1}\\mathbf{r}$ requires solving a linear system of equations, $M\\mathbf{x} = \\mathbf{r}$, at every time step. Although $M$ is symmetric positive-definite and well-conditioned, this solution step (e.g., using an iterative solver like Jacobi or Conjugate Gradient) is vastly more expensive than the element-wise division required for a lumped matrix. This can render an explicit scheme computationally prohibitive.\n\n**Trade-off Summary**: For explicit time integration of convection-dominated problems, the choice is between the high computational efficiency of the lumped mass matrix and the superior accuracy (especially lower dispersion error) of the consistent mass matrix. In practice, the efficiency gains from mass lumping are so significant that it is the default choice for most large-scale explicit CFD codes, with the understanding that the introduced dispersion error must be monitored or mitigated by other means (e.g., high-resolution advection schemes).",
            "answer": "$$\n\\boxed{\\frac{\\rho A}{3}}\n$$"
        },
        {
            "introduction": "The core idea of the Finite Element Method is to approximate a complex, unknown solution using a patchwork of simple, piecewise polynomial functions defined by shape functions. But how good is this approximation? This practice provides a concrete method for answering that question by guiding you through the calculation of the interpolation error in the $L^2$ norm. By directly comparing a known function to its finite element interpolant on a linear triangle, you will develop a hands-on understanding of the approximation theory that underpins the convergence and accuracy of FEM .",
            "id": "3956616",
            "problem": "In a two-dimensional Computational Fluid Dynamics (CFD) discretization using the Finite Element Method (FEM), consider a single linear triangular element with vertices at the physical coordinates $\\mathbf{P}_{1}=(0,0)$, $\\mathbf{P}_{2}=(1,0)$, and $\\mathbf{P}_{3}=(0,1)$. The degree-$1$ Lagrange shape functions on this triangle are defined as the unique linear polynomials that satisfy the Kronecker delta property at the vertices. Let the scalar field be the polynomial $u(x,y)=x^{2}+xy$. Using the degree-$1$ Lagrange shape functions on this element, construct the nodal interpolation $I_{h}u$ and compute the interpolation error $e=u-I_{h}u$. Then, compute the $L^{2}$ norm of the error over the element, defined by\n$$\n\\|e\\|_{L^{2}(T)}=\\left(\\int_{T} e(x,y)^{2}\\,\\mathrm{d}A\\right)^{\\frac{1}{2}},\n$$\nwhere $T$ denotes the triangular element. Express your final answer as an exact value with no rounding and no units.",
            "solution": "The problem is subjected to validation and is deemed valid. It is a well-posed, scientifically grounded problem from the field of numerical analysis, specifically the Finite Element Method, which is a core component of many modern Computational Fluid Dynamics (CFD) codes. All necessary information is provided, and the problem is free of contradictions or ambiguities.\n\nThe problem requires the computation of the $L^2$ norm of the interpolation error for a given scalar field on a linear triangular element. The solution process involves four main steps:\n1.  Derivation of the degree-$1$ Lagrange shape functions for the given element.\n2.  Construction of the nodal interpolant $I_h u$ of the scalar field $u(x,y)$.\n3.  Determination of the interpolation error function $e(x,y)$.\n4.  Computation of the $L^2$ norm of the error function by integration over the element area.\n\nThe triangular element, denoted as $T$, is defined by the three vertices $\\mathbf{P}_{1}=(0,0)$, $\\mathbf{P}_{2}=(1,0)$, and $\\mathbf{P}_{3}=(0,1)$ in the Cartesian coordinate system $(x,y)$.\n\nFirst, we determine the degree-$1$ Lagrange shape functions, $N_1(x,y)$, $N_2(x,y)$, and $N_3(x,y)$. These are linear polynomials of the form $N_i(x,y) = a_i + b_i x + c_i y$, which must satisfy the Kronecker delta property at the nodal points, i.e., $N_i(\\mathbf{P}_j) = \\delta_{ij}$, where $\\delta_{ij}$ is $1$ if $i=j$ and $0$ if $i \\neq j$.\n\nFor shape function $N_1(x,y)$:\n$N_1(\\mathbf{P}_1) = N_1(0,0) = a_1 = 1$\n$N_1(\\mathbf{P}_2) = N_1(1,0) = a_1 + b_1 = 0 \\implies b_1 = -1$\n$N_1(\\mathbf{P}_3) = N_1(0,1) = a_1 + c_1 = 0 \\implies c_1 = -1$\nThus, $N_1(x,y) = 1 - x - y$.\n\nFor shape function $N_2(x,y)$:\n$N_2(\\mathbf{P}_1) = N_2(0,0) = a_2 = 0$\n$N_2(\\mathbf{P}_2) = N_2(1,0) = a_2 + b_2 = 1 \\implies b_2 = 1$\n$N_2(\\mathbf{P}_3) = N_2(0,1) = a_2 + c_2 = 0 \\implies c_2 = 0$\nThus, $N_2(x,y) = x$.\n\nFor shape function $N_3(x,y)$:\n$N_3(\\mathbf{P}_1) = N_3(0,0) = a_3 = 0$\n$N_3(\\mathbf{P}_2) = N_3(1,0) = a_3 + b_3 = 0 \\implies b_3 = 0$\n$N_3(\\mathbf{P}_3) = N_3(0,1) = a_3 + c_3 = 1 \\implies c_3 = 1$\nThus, $N_3(x,y) = y$.\n\nNext, we construct the nodal interpolation $I_h u$ of the scalar field $u(x,y)=x^2+xy$. The interpolant is defined by:\n$$I_h u(x,y) = \\sum_{i=1}^{3} u(\\mathbf{P}_i) N_i(x,y)$$\nWe evaluate $u(x,y)$ at the vertices:\n$u_1 = u(\\mathbf{P}_1) = u(0,0) = 0^2 + (0)(0) = 0$\n$u_2 = u(\\mathbf{P}_2) = u(1,0) = 1^2 + (1)(0) = 1$\n$u_3 = u(\\mathbf{P}_3) = u(0,1) = 0^2 + (0)(1) = 0$\n\nSubstituting these nodal values into the interpolation formula:\n$I_h u(x,y) = u_1 N_1(x,y) + u_2 N_2(x,y) + u_3 N_3(x,y) = (0)N_1(x,y) + (1)N_2(x,y) + (0)N_3(x,y) = N_2(x,y) = x$.\n\nThe interpolation error $e(x,y)$ is the difference between the original function and its interpolant:\n$e(x,y) = u(x,y) - I_h u(x,y) = (x^2 + xy) - x = x^2 + xy - x$.\n\nFinally, we compute the $L^2$ norm of the error, $\\|e\\|_{L^2(T)}$, which requires integrating the square of the error function over the triangular domain $T$.\n$$\\|e\\|_{L^2(T)}^2 = \\int_T e(x,y)^2 \\, \\mathrm{d}A = \\int_T (x^2 + xy - x)^2 \\, \\mathrm{d}A$$\nThe domain $T$ is described by the inequalities $x \\ge 0$, $y \\ge 0$, and $x+y \\le 1$. We can set up the double integral as:\n$$\\|e\\|_{L^2(T)}^2 = \\int_{0}^{1} \\int_{0}^{1-x} (x^2 + xy - x)^2 \\, \\mathrm{d}y \\, \\mathrm{d}x$$\nThe integrand can be simplified: $(x^2 + xy - x)^2 = (x(x+y-1))^2 = x^2(x+y-1)^2$.\nFirst, we integrate with respect to $y$:\n$$ \\int_{0}^{1-x} x^2(x+y-1)^2 \\, \\mathrm{d}y $$\nLet $z = x+y-1$, so $\\mathrm{d}z = \\mathrm{d}y$. The limits of integration for $z$ are from $x-1$ (when $y=0$) to $0$ (when $y=1-x$).\n$$ \\int_{x-1}^{0} x^2 z^2 \\, \\mathrm{d}z = x^2 \\left[ \\frac{z^3}{3} \\right]_{x-1}^{0} = x^2 \\left( 0 - \\frac{(x-1)^3}{3} \\right) = -\\frac{x^2(x-1)^3}{3} = \\frac{x^2(1-x)^3}{3} $$\nNext, we integrate this result with respect to $x$ from $0$ to $1$:\n$$ \\|e\\|_{L^2(T)}^2 = \\int_{0}^{1} \\frac{x^2(1-x)^3}{3} \\, \\mathrm{d}x = \\frac{1}{3} \\int_{0}^{1} x^2(1-x)^3 \\, \\mathrm{d}x $$\nThis integral is an instance of the Beta function, $B(m,n) = \\int_{0}^{1} t^{m-1}(1-t)^{n-1} \\, \\mathrm{d}t = \\frac{\\Gamma(m)\\Gamma(n)}{\\Gamma(m+n)}$.\nIn our case, $m-1=2$ and $n-1=3$, so $m=3$ and $n=4$.\n$$ \\int_{0}^{1} x^2(1-x)^3 \\, \\mathrm{d}x = B(3,4) = \\frac{\\Gamma(3)\\Gamma(4)}{\\Gamma(3+4)} = \\frac{2! \\cdot 3!}{6!} = \\frac{2 \\cdot 6}{720} = \\frac{12}{720} = \\frac{1}{60} $$\nAlternatively, we can expand the polynomial and integrate term by term:\n$$ \\int_{0}^{1} x^2(1 - 3x + 3x^2 - x^3) \\, \\mathrm{d}x = \\int_{0}^{1} (x^2 - 3x^3 + 3x^4 - x^5) \\, \\mathrm{d}x $$\n$$ = \\left[ \\frac{x^3}{3} - \\frac{3x^4}{4} + \\frac{3x^5}{5} - \\frac{x^6}{6} \\right]_{0}^{1} = \\frac{1}{3} - \\frac{3}{4} + \\frac{3}{5} - \\frac{1}{6} $$\nThe least common multiple of the denominators is $60$:\n$$ = \\frac{20 - 45 + 36 - 10}{60} = \\frac{56 - 55}{60} = \\frac{1}{60} $$\nSo, we have:\n$$ \\|e\\|_{L^2(T)}^2 = \\frac{1}{3} \\cdot \\frac{1}{60} = \\frac{1}{180} $$\nThe $L^2$ norm is the square root of this value:\n$$ \\|e\\|_{L^2(T)} = \\sqrt{\\frac{1}{180}} = \\frac{1}{\\sqrt{180}} = \\frac{1}{\\sqrt{36 \\cdot 5}} = \\frac{1}{6\\sqrt{5}} $$\nTo rationalize the denominator, we multiply the numerator and denominator by $\\sqrt{5}$:\n$$ \\|e\\|_{L^2(T)} = \\frac{\\sqrt{5}}{6 \\cdot 5} = \\frac{\\sqrt{5}}{30} $$",
            "answer": "$$\\boxed{\\frac{\\sqrt{5}}{30}}$$"
        },
        {
            "introduction": "Real-world CFD applications, particularly in aerospace, involve complex, curved geometries that do not conform to simple shapes. The isoparametric concept is the elegant solution that allows us to mesh these domains by mapping simple reference elements (like a unit triangle) to curved physical elements. This exercise demonstrates this powerful technique by having you derive the mapping for a quadratic element, compute the Jacobian matrix that governs the geometric transformation, and understand its role in evaluating integrals in the weak formulation .",
            "id": "4006148",
            "problem": "Consider a two-dimensional curved boundary-adjacent element in an aerodynamics mesh used for Computational Fluid Dynamics (CFD) based on the Finite Element Method (FEM) with the Galerkin weighted residual approach. The element is a quadratic six-node triangle used to represent a locally curved portion of an airfoil. The reference element is the standard unit right triangle in the parameter space with local coordinates $\\boldsymbol{\\xi} = (\\xi,\\eta)$ and vertices at $(0,0)$, $(1,0)$, and $(0,1)$. The three vertex nodes and three midside nodes are positioned in physical space at\n$$\n(x_1,y_1) = (0,0),\\quad (x_2,y_2) = (2.0,0.0),\\quad (x_3,y_3) = (0.0,2.0),\n$$\n$$\n(x_4,y_4) = (1.0,0.2),\\quad (x_5,y_5) = (0.7,1.3),\\quad (x_6,y_6) = (0.2,1.0),\n$$\nwhere nodes $1$, $2$, and $3$ are the vertices corresponding to $(\\xi,\\eta) = (0,0)$, $(1,0)$, and $(0,1)$, respectively, and nodes $4$, $5$, and $6$ are the midside nodes corresponding to $(\\xi,\\eta) = (0.5,0)$, $(0.5,0.5)$, and $(0,0.5)$, respectively, on the reference triangle.\n\nStarting from the fundamental definition of the isoparametric concept, where the same polynomial basis used for the solution approximation is used to interpolate geometry, perform the following:\n\n1. Derive the isoparametric mapping $\\boldsymbol{x}(\\boldsymbol{\\xi}) = (x(\\xi,\\eta),y(\\xi,\\eta))$ for this curved six-node triangular element in terms of quadratic Lagrange shape functions defined on the reference triangle. Clearly express how the geometry is interpolated from the nodal coordinates.\n\n2. Using the mapping, compute the Jacobian matrix \n$$\n\\boldsymbol{J}(\\xi,\\eta) = \\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix},\n$$\nand its determinant $J(\\xi,\\eta) = \\det \\boldsymbol{J}(\\xi,\\eta)$ at the centroid of the reference triangle $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$.\n\n3. Explain the role of the Jacobian determinant in transforming weak integrals under the Galerkin weighted residual method, specifically the local $L^{2}$ inner product on the element $E$,\n$$\nI \\;=\\; \\int_{E} N_1(\\boldsymbol{x})\\,N_1(\\boldsymbol{x}) \\,\\mathrm{d}\\Omega,\n$$\nwhere $N_1$ is the elementâ€™s first quadratic shape function associated with node $1$, and $\\mathrm{d}\\Omega$ is the physical area differential.\n\n4. Using one-point quadrature on the reference triangle (exact for linear polynomials), approximate the transformed integral by evaluating at the centroid $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$, with the quadrature weight equal to the area of the reference triangle. Express your final answer for the approximate value of $I$ as an exact rational number. Do not include any physical units, and do not round; provide the exact value in simplest fractional form.",
            "solution": "The isoparametric concept in the Finite Element Method (FEM) sets the geometry and the solution approximation on the same polynomial space. For a quadratic six-node triangular element, the geometry is mapped from the reference triangle to the physical triangle using the quadratic Lagrange shape functions. Denote the reference-area (barycentric) coordinates by $L_1 = 1 - \\xi - \\eta$, $L_2 = \\xi$, and $L_3 = \\eta$. The six quadratic Lagrange shape functions on the reference triangle are\n$$\nN_1 = L_1\\,(2L_1 - 1),\\quad\nN_2 = L_2\\,(2L_2 - 1),\\quad\nN_3 = L_3\\,(2L_3 - 1),\n$$\n$$\nN_4 = 4\\,L_1\\,L_2,\\quad\nN_5 = 4\\,L_2\\,L_3,\\quad\nN_6 = 4\\,L_3\\,L_1.\n$$\nBy the isoparametric interpolation of geometry, the mapping from the reference coordinates $\\boldsymbol{\\xi}=(\\xi,\\eta)$ to the physical coordinates $\\boldsymbol{x}=(x,y)$ is\n$$\nx(\\xi,\\eta) \\;=\\; \\sum_{i=1}^{6} N_i(\\xi,\\eta)\\,x_i,\\qquad\ny(\\xi,\\eta) \\;=\\; \\sum_{i=1}^{6} N_i(\\xi,\\eta)\\,y_i,\n$$\nwhere $(x_i,y_i)$ are the physical nodal coordinates of the element.\n\nThe Jacobian matrix of the mapping is\n$$\n\\boldsymbol{J}(\\xi,\\eta) \\;=\\;\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,x_i & \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,x_i \\\\\n\\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,y_i & \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,y_i\n\\end{pmatrix}.\n$$\nWe now compute the derivatives of the shape functions at the centroid of the reference triangle, $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$. At the centroid, the barycentric coordinates are $L_1=L_2=L_3=\\frac{1}{3}$. The shape function values at the centroid are:\n$$\nN_1 = \\frac{1}{3}\\left(\\frac{2}{3} - 1\\right) = -\\frac{1}{9},\\quad\nN_2 = -\\frac{1}{9},\\quad\nN_3 = -\\frac{1}{9},\\quad\nN_4 = \\frac{4}{9},\\quad\nN_5 = \\frac{4}{9},\\quad\nN_6 = \\frac{4}{9}.\n$$\nThe derivatives of the barycentric coordinates are\n$$\n\\frac{\\partial L_1}{\\partial \\xi} = -1,\\quad \\frac{\\partial L_1}{\\partial \\eta} = -1,\\qquad\n\\frac{\\partial L_2}{\\partial \\xi} = 1,\\quad \\frac{\\partial L_2}{\\partial \\eta} = 0,\\qquad\n\\frac{\\partial L_3}{\\partial \\xi} = 0,\\quad \\frac{\\partial L_3}{\\partial \\eta} = 1.\n$$\nUsing product rule and chain rule, the derivatives of the shape functions at $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ are:\n- For $N_1 = L_1(2L_1 - 1)$,\n$$\n\\frac{\\partial N_1}{\\partial \\xi} = -4 L_1 + 1 = -\\frac{1}{3},\\qquad\n\\frac{\\partial N_1}{\\partial \\eta} = -4 L_1 + 1 = -\\frac{1}{3}.\n$$\n- For $N_2 = L_2(2L_2 - 1)$,\n$$\n\\frac{\\partial N_2}{\\partial \\xi} = 4 L_2 - 1 = \\frac{1}{3},\\qquad\n\\frac{\\partial N_2}{\\partial \\eta} = 0.\n$$\n- For $N_3 = L_3(2L_3 - 1)$,\n$$\n\\frac{\\partial N_3}{\\partial \\xi} = 0,\\qquad\n\\frac{\\partial N_3}{\\partial \\eta} = 4 L_3 - 1 = \\frac{1}{3}.\n$$\n- For $N_4 = 4 L_1 L_2$,\n$$\n\\frac{\\partial N_4}{\\partial \\xi} = 4(L_1 - L_2) = 0,\\qquad\n\\frac{\\partial N_4}{\\partial \\eta} = -4 L_2 = -\\frac{4}{3}.\n$$\n- For $N_5 = 4 L_2 L_3$,\n$$\n\\frac{\\partial N_5}{\\partial \\xi} = 4 L_3 = \\frac{4}{3},\\qquad\n\\frac{\\partial N_5}{\\partial \\eta} = 4 L_2 = \\frac{4}{3}.\n$$\n- For $N_6 = 4 L_3 L_1$,\n$$\n\\frac{\\partial N_6}{\\partial \\xi} = -4 L_3 = -\\frac{4}{3},\\qquad\n\\frac{\\partial N_6}{\\partial \\eta} = 4(L_1 - L_3) = 0.\n$$\nWith the given nodal coordinates, we compute the Jacobian entries at the centroid. First, for $\\frac{\\partial x}{\\partial \\xi}$:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,x_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 2 + 0\\cdot 0 + 0\\cdot 1 + \\left(\\frac{4}{3}\\right)\\cdot 0.7 + \\left(-\\frac{4}{3}\\right)\\cdot 0.2\n= \\frac{4}{3}.\n$$\nNext, for $\\frac{\\partial x}{\\partial \\eta}$:\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,x_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 2 + \\left(\\frac{1}{3}\\right)\\cdot 0 + \\left(-\\frac{4}{3}\\right)\\cdot 1 + \\left(\\frac{4}{3}\\right)\\cdot 0.7 + 0\\cdot 0.2\n= -\\frac{2}{5}.\n$$\nFor $\\frac{\\partial y}{\\partial \\xi}$:\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,y_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 2 + 0\\cdot 0.2 + \\left(\\frac{4}{3}\\right)\\cdot 1.3 + \\left(-\\frac{4}{3}\\right)\\cdot 1.0\n= \\frac{2}{5}.\n$$\nFor $\\frac{\\partial y}{\\partial \\eta}$:\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,y_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 2 + \\left(-\\frac{4}{3}\\right)\\cdot 0.2 + \\left(\\frac{4}{3}\\right)\\cdot 1.3 + 0\\cdot 1.0\n= \\frac{32}{15}.\n$$\nThus, the Jacobian matrix at $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ is\n$$\n\\boldsymbol{J}\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\n=\n\\begin{pmatrix}\n\\frac{4}{3} & -\\frac{2}{5} \\\\\n\\frac{2}{5} & \\frac{32}{15}\n\\end{pmatrix},\n$$\nand its determinant is\n$$\nJ\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\n= \\left(\\frac{4}{3}\\right)\\left(\\frac{32}{15}\\right) - \\left(-\\frac{2}{5}\\right)\\left(\\frac{2}{5}\\right)\n= \\frac{128}{45} + \\frac{4}{25}\n= \\frac{676}{225}.\n$$\n\nThe role of the Jacobian determinant in transforming weak integrals under the Galerkin weighted residual method is given by the change-of-variables formula. For any integrand $g(\\boldsymbol{x})$ defined on the curved physical element $E$, the area integral transforms to the reference element $\\hat{E}$ as\n$$\n\\int_{E} g(\\boldsymbol{x})\\,\\mathrm{d}\\Omega\n=\n\\int_{\\hat{E}} g\\big(\\boldsymbol{x}(\\boldsymbol{\\xi})\\big)\\,\\big|J(\\boldsymbol{\\xi})\\big|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\nwhere $\\big|J(\\boldsymbol{\\xi})\\big| = \\det\\boldsymbol{J}(\\boldsymbol{\\xi})$ accounts for the local metric distortion and area scaling due to the mapping.\n\nFor the specified weak inner product on the element,\n$$\nI = \\int_{E} N_1(\\boldsymbol{x})\\,N_1(\\boldsymbol{x})\\,\\mathrm{d}\\Omega,\n$$\nthe transformed integral on the reference element is\n$$\nI = \\int_{\\hat{E}} N_1(\\xi,\\eta)^2 \\,\\big|J(\\xi,\\eta)\\big|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta.\n$$\nUsing one-point quadrature at the centroid $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$, with weight equal to the reference triangle area,\n$$\nw = \\text{area}(\\hat{E}) = \\frac{1}{2},\n$$\nwe have the approximation\n$$\nI \\;\\approx\\; w \\; N_1\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)^{2}\\; \\bigg|J\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\\bigg|.\n$$\nWe already computed $N_1\\left(\\frac{1}{3},\\frac{1}{3}\\right) = -\\frac{1}{9}$ and $J\\left(\\frac{1}{3},\\frac{1}{3}\\right) = \\frac{676}{225}$. Therefore,\n$$\nI \\;\\approx\\; \\frac{1}{2} \\left(-\\frac{1}{9}\\right)^{2} \\cdot \\frac{676}{225}\n\\;=\\;\n\\frac{1}{2}\\cdot \\frac{1}{81} \\cdot \\frac{676}{225}\n\\;=\\;\n\\frac{676}{2 \\cdot 81 \\cdot 225}\n\\;=\\;\n\\frac{676}{36450}\n\\;=\\;\n\\frac{338}{18225}.\n$$\nThis is an exact rational value for the specified one-point quadrature approximation of the local $L^{2}$ inner product over the curved element.",
            "answer": "$$\\boxed{\\frac{338}{18225}}$$"
        }
    ]
}