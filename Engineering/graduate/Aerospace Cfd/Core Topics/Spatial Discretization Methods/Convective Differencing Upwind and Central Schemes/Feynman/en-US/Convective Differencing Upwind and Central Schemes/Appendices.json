{
    "hands_on_practices": [
        {
            "introduction": "To understand the behavior of a numerical scheme, it is not enough to know that it approximates a given partial differential equation; we must analyze the nature of the approximation itself. The modified equation is a powerful analytical tool that reveals the partial differential equation a discrete scheme effectively solves, including its leading-order error terms. This practice guides you through the derivation of the modified equation for the first-order upwind scheme, allowing you to discover how this scheme introduces an artificial diffusion term, a property known as numerical viscosity, which is key to its stability .",
            "id": "3952213",
            "problem": "Consider the one-dimensional linear convection equation, a canonical model for convective transport in Aerospace Computational Fluid Dynamics (CFD),\n$$\nu_{t} + a\\,u_{x} = 0,\n$$\nwith constant advection speed $a \\in \\mathbb{R}$ on a uniform grid of spacing $\\Delta x > 0$. Construct a semi-discrete first-order upwind discretization in space as follows: for $a>0$, approximate $u_{x}$ at node $x_{i}$ by the backward difference $(u_{i}-u_{i-1})/\\Delta x$, and for $a<0$, approximate it by the forward difference $(u_{i+1}-u_{i})/\\Delta x$. Assume $u$ is sufficiently smooth so that Taylor expansions are valid.\n\nStarting only from the definitions of Taylor series and the given semi-discrete upwind approximation, derive the leading-order modified partial differential equation that the semi-discrete scheme satisfies, retaining terms through $\\mathcal{O}(\\Delta x)$ beyond the original model. Match terms so that this modified equation is written in the form\n$$\nu_{t} + a\\,u_{x} = \\nu_{\\text{num}}\\,u_{xx} + \\text{higher-order terms},\n$$\nand determine the effective numerical kinematic viscosity $\\nu_{\\text{num}}$ in terms of $a$ and $\\Delta x$. Give your final answer as a closed-form analytic expression for $\\nu_{\\text{num}}$. Do not include units. No rounding is required.",
            "solution": "The problem requires the derivation of the effective numerical kinematic viscosity, $\\nu_{\\text{num}}$, for the first-order upwind semi-discretization of the one-dimensional linear convection equation, $u_{t} + a\\,u_{x} = 0$. The derivation proceeds by analyzing the truncation error of the spatial discretization using Taylor series expansions. This analysis reveals the modified partial differential equation that the numerical scheme actually solves.\n\nThe problem specifies two cases for the upwind scheme based on the sign of the advection speed, $a$. We will analyze each case separately.\n\nCase 1: $a > 0$\nFor this case, the problem states that the spatial derivative $u_x$ at node $x_i$ is approximated by the first-order backward difference. The resulting semi-discrete equation is:\n$$\n\\frac{du_i}{dt} + a \\left( \\frac{u_i - u_{i-1}}{\\Delta x} \\right) = 0\n$$\nTo analyze the truncation error, we interpret this discrete equation in a continuous setting. Let $u(x, t)$ be the exact solution, and let the discrete value $u_i(t)$ represent an approximation to $u(x_i, t)$. The semi-discrete equation at a point $x$ can be written as:\n$$\nu_t + a \\left( \\frac{u(x,t) - u(x-\\Delta x, t)}{\\Delta x} \\right) = 0\n$$\nWe perform a Taylor series expansion of the term $u(x-\\Delta x, t)$ around the point $(x, t)$. Assuming $u$ is sufficiently smooth, the expansion is:\n$$\nu(x-\\Delta x, t) = u(x,t) - \\Delta x \\frac{\\partial u}{\\partial x}(x,t) + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 u}{\\partial x^2}(x,t) - \\frac{(\\Delta x)^3}{3!} \\frac{\\partial^3 u}{\\partial x^3}(x,t) + \\dots\n$$\nFor brevity, we will use subscript notation for partial derivatives (e.g., $u_x = \\frac{\\partial u}{\\partial x}$).\n$$\nu(x-\\Delta x) = u - \\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2}u_{xx} - \\mathcal{O}((\\Delta x)^3)\n$$\nSubstituting this expansion into the discrete spatial derivative approximation:\n$$\n\\frac{u - u(x-\\Delta x)}{\\Delta x} = \\frac{u - \\left(u - \\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2}u_{xx} - \\mathcal{O}((\\Delta x)^3)\\right)}{\\Delta x}\n$$\n$$\n= \\frac{\\Delta x\\,u_x - \\frac{(\\Delta x)^2}{2}u_{xx} + \\mathcal{O}((\\Delta x)^3)}{\\Delta x}\n$$\n$$\n= u_x - \\frac{\\Delta x}{2}u_{xx} + \\mathcal{O}((\\Delta x)^2)\n$$\nNow, we substitute this expression back into the semi-discrete equation:\n$$\nu_t + a \\left( u_x - \\frac{\\Delta x}{2}u_{xx} + \\mathcal{O}((\\Delta x)^2) \\right) = 0\n$$\nRearranging the terms gives:\n$$\nu_t + a\\,u_x = a \\frac{\\Delta x}{2}u_{xx} - a \\mathcal{O}((\\Delta x)^2)\n$$\nThis is the modified partial differential equation. Comparing this to the target form $u_t + a\\,u_x = \\nu_{\\text{num}}\\,u_{xx} + \\text{higher-order terms}$, we identify the numerical viscosity for $a>0$ as:\n$$\n\\nu_{\\text{num}} = a \\frac{\\Delta x}{2}\n$$\n\nCase 2: $a < 0$\nFor this case, the spatial derivative $u_x$ is approximated by the first-order forward difference. The semi-discrete equation is:\n$$\n\\frac{du_i}{dt} + a \\left( \\frac{u_{i+1} - u_i}{\\Delta x} \\right) = 0\n$$\nIn a continuous setting, this is:\n$$\nu_t + a \\left( \\frac{u(x+\\Delta x, t) - u(x, t)}{\\Delta x} \\right) = 0\n$$\nWe perform a Taylor series expansion of $u(x+\\Delta x, t)$ around $(x, t)$:\n$$\nu(x+\\Delta x, t) = u(x,t) + \\Delta x \\frac{\\partial u}{\\partial x}(x,t) + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 u}{\\partial x^2}(x,t) + \\frac{(\\Delta x)^3}{3!} \\frac{\\partial^3 u}{\\partial x^3}(x,t) + \\dots\n$$\nUsing subscript notation:\n$$\nu(x+\\Delta x) = u + \\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2}u_{xx} + \\mathcal{O}((\\Delta x)^3)\n$$\nSubstituting this into the discrete spatial derivative approximation:\n$$\n\\frac{u(x+\\Delta x) - u}{\\Delta x} = \\frac{\\left(u + \\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2}u_{xx} + \\mathcal{O}((\\Delta x)^3)\\right) - u}{\\Delta x}\n$$\n$$\n= \\frac{\\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2}u_{xx} + \\mathcal{O}((\\Delta x)^3)}{\\Delta x}\n$$\n$$\n= u_x + \\frac{\\Delta x}{2}u_{xx} + \\mathcal{O}((\\Delta x)^2)\n$$\nSubstituting this back into the semi-discrete equation:\n$$\nu_t + a \\left( u_x + \\frac{\\Delta x}{2}u_{xx} + \\mathcal{O}((\\Delta x)^2) \\right) = 0\n$$\nRearranging the terms:\n$$\nu_t + a\\,u_x = -a \\frac{\\Delta x}{2}u_{xx} - a \\mathcal{O}((\\Delta x)^2)\n$$\nComparing this to the target form $u_t + a\\,u_x = \\nu_{\\text{num}}\\,u_{xx} + \\text{higher-order terms}$, we identify the numerical viscosity for $a<0$ as:\n$$\n\\nu_{\\text{num}} = -a \\frac{\\Delta x}{2}\n$$\n\nSummary and Final Expression\nWe have found the expressions for $\\nu_{\\text{num}}$ for both positive and negative $a$:\n- If $a > 0$, then $\\nu_{\\text{num}} = a \\frac{\\Delta x}{2}$. Since $a > 0$, this is equal to $|a| \\frac{\\Delta x}{2}$.\n- If $a < 0$, then $\\nu_{\\text{num}} = -a \\frac{\\Delta x}{2}$. Since $a < 0$, $-a$ is positive and equal to $|a|$. Thus, this is also equal to $|a| \\frac{\\Delta x}{2}$.\n\nBoth cases can be expressed by a single, unified formula using the absolute value of $a$. The leading-order error term in the upwind scheme acts as a diffusion term, with an effective numerical kinematic viscosity given by:\n$$\n\\nu_{\\text{num}} = \\frac{|a| \\Delta x}{2}\n$$\nThis term is always non-negative, signifying that the first-order upwind scheme introduces artificial dissipation or diffusion into the numerical solution, regardless of the sign of the advection speed $a$. This is a characteristic feature of the scheme.",
            "answer": "$$\\boxed{\\frac{|a|\\Delta x}{2}}$$"
        },
        {
            "introduction": "The dissipative effects revealed by the modified equation can be analyzed from another perspective: the frequency domain. This practice uses von Neumann analysis to examine how the upwind scheme damps individual Fourier modes of the solution, connecting the abstract concept of numerical diffusion to the tangible decay of wave amplitudes . By confirming that this decay rate matches the prediction from the modified equation, you will solidify your understanding of both analysis techniques and the inherent dissipation of the upwind scheme.",
            "id": "3952172",
            "problem": "Consider the one-dimensional linear advection equation with constant velocity, which serves as a canonical model for convective transport in Computational Fluid Dynamics (CFD):\n$$\nu_{t} + a\\,u_{x} = 0,\n$$\nwhere $a>0$ is a constant. Discretize space on a uniform grid with spacing $\\Delta x$ and time with step $\\Delta t$, and apply the first-order upwind scheme in space together with forward Euler time stepping. For $a>0$, the discrete update at grid point $x_{j} = j\\,\\Delta x$ and time level $t_{n} = n\\,\\Delta t$ is\n$$\nu_{j}^{\\,n+1} = u_{j}^{\\,n} - \\nu \\left(u_{j}^{\\,n} - u_{j-1}^{\\,n}\\right),\n$$\nwhere the Courant–Friedrichs–Lewy (CFL) number is $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$, and assume $0<\\nu<1$. Consider an initial Fourier mode\n$$\nu(x,0) = \\hat{u}_{0}\\,\\exp\\!\\left(i\\,\\kappa\\,x\\right),\n$$\nwith wavenumber $\\kappa>0$. Using the modified equation approach, derive the leading-order prediction for the decay rate per unit time $\\lambda(\\kappa)$ of the mode’s amplitude $|\\hat{u}(t)|$, defined by\n$$\n|\\hat{u}(t)| \\sim |\\hat{u}_{0}|\\,\\exp\\!\\left(-\\lambda(\\kappa)\\,t\\right),\n$$\nretaining terms up to the second spatial derivative in the modified equation. Independently, perform a von Neumann analysis of the discrete scheme, compute the amplification factor $G(\\kappa)$, and infer the corresponding leading-order decay rate per unit time by expanding $|G(\\kappa)|$ for small grid wavenumber $\\theta = \\kappa\\,\\Delta x$. Compare the two predictions and provide the final analytic expression for the decay rate $\\lambda(\\kappa)$ in terms of $a$, $\\Delta x$, $\\Delta t$, and $\\kappa$. Express $\\lambda(\\kappa)$ in $\\text{s}^{-1}$ and do not substitute numerical values. Your final answer must be a single closed-form expression.",
            "solution": "The problem requires the derivation of the leading-order decay rate, $\\lambda(\\kappa)$, for a Fourier mode evolved under the first-order upwind scheme for the linear advection equation. Two distinct methods must be used and their results compared: the modified equation approach and the von Neumann stability analysis.\n\nThe one-dimensional linear advection equation is given by:\n$$u_{t} + a\\,u_{x} = 0, \\quad a>0$$\nThe discretization is performed using forward Euler in time and first-order upwind in space. For a positive velocity $a>0$, the upwind direction is from the left, so the spatial derivative is approximated at grid node $j$ using values at nodes $j$ and $j-1$. The resulting discrete scheme is:\n$$u_{j}^{\\,n+1} = u_{j}^{\\,n} - \\nu \\left(u_{j}^{\\,n} - u_{j-1}^{\\,n}\\right)$$\nwhere $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$ is the Courant–Friedrichs–Lewy (CFL) number, with the stability constraint $0 < \\nu < 1$.\n\nWe analyze the decay of an initial Fourier mode $u(x,0) = \\hat{u}_{0}\\,\\exp(i\\,\\kappa\\,x)$ where the amplitude evolves according to $|\\hat{u}(t)| \\sim |\\hat{u}_{0}|\\,\\exp(-\\lambda(\\kappa)\\,t)$.\n\n### Method 1: Modified Equation Analysis\n\nThe modified equation is the partial differential equation that is more accurately solved by the numerical scheme than the original PDE. We derive it by performing Taylor series expansions of the terms in the discrete scheme around the point $(x_j, t_n)$.\nLet $u$ and its partial derivatives be evaluated at $(x_j, t_n)$.\n$$u_j^{n+1} = u(x_j, t_n+\\Delta t) = u + \\Delta t\\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + O((\\Delta t)^3)$$\n$$u_{j-1}^n = u(x_j-\\Delta x, t_n) = u - \\Delta x\\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + O((\\Delta x)^4)$$\nRewriting the scheme as $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -a \\frac{u_j^n - u_{j-1}^n}{\\Delta x}$ and substituting the expansions:\n$$\\frac{1}{\\Delta t}\\left(u + \\Delta t\\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\dots - u\\right) = -a \\frac{1}{\\Delta x}\\left(u - \\left(u - \\Delta x\\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots\\right)\\right)$$\n$$u_t + \\frac{\\Delta t}{2} u_{tt} + O((\\Delta t)^2) = -a \\left(u_x - \\frac{\\Delta x}{2} u_{xx} + O((\\Delta x)^2)\\right)$$\nRearranging the terms gives the first form of the error:\n$$u_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} u_{tt} + \\dots$$\nTo obtain the modified equation with spatial derivatives only up to second order, we must express $u_{tt}$ in terms of spatial derivatives. We can differentiate the lowest-order approximation of the equation itself, which is $u_t = -a u_x$.\n$$u_{tt} = \\frac{\\partial}{\\partial t} u_t \\approx \\frac{\\partial}{\\partial t}(-a u_x) = -a \\frac{\\partial}{\\partial x} u_t \\approx -a \\frac{\\partial}{\\partial x}(-a u_x) = a^2 u_{xx}$$\nSubstituting this back into the equation for the truncation error:\n$$u_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} (a^2 u_{xx}) + O(\\Delta t^2, (\\Delta x)^2)$$\n$$u_t + a u_x = \\left(\\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}\\right) u_{xx} + \\dots$$\nFactoring out the term $\\frac{a \\Delta x}{2}$:\n$$u_t + a u_x = \\frac{a \\Delta x}{2} \\left(1 - \\frac{a \\Delta t}{\\Delta x}\\right) u_{xx} + \\dots$$\nUsing the definition of the CFL number $\\nu = \\frac{a \\Delta t}{\\Delta x}$, the modified equation, truncated at the second spatial derivative, is:\n$$u_t + a u_x = \\frac{a \\Delta x}{2} (1-\\nu)\\, u_{xx}$$\nThis is an advection-diffusion equation. The term on the right-hand side represents numerical diffusion, with a diffusion coefficient $\\alpha = \\frac{a \\Delta x}{2} (1-\\nu)$. Since $a>0$, $\\Delta x>0$, and $0 < \\nu < 1$, the coefficient $\\alpha$ is positive, indicating that the scheme is dissipative.\n\nTo find the decay rate, we seek a solution of the form $u(x,t) = \\hat{u}(t)\\,\\exp(i\\,\\kappa\\,x)$ for this modified equation. Substituting this form into the equation yields an ordinary differential equation for the amplitude $\\hat{u}(t)$:\n$$\\frac{d\\hat{u}}{dt}\\exp(i\\,\\kappa\\,x) + a (i\\kappa \\hat{u})\\exp(i\\,\\kappa\\,x) = \\alpha ((i\\kappa)^2 \\hat{u})\\exp(i\\,\\kappa\\,x)$$\n$$\\frac{d\\hat{u}}{dt} + i a \\kappa \\hat{u} = -\\alpha \\kappa^2 \\hat{u}$$\n$$\\frac{d\\hat{u}}{dt} = \\left(-i a \\kappa - \\alpha \\kappa^2\\right) \\hat{u}$$\nThe solution to this ODE with initial condition $\\hat{u}(0) = \\hat{u}_0$ is:\n$$\\hat{u}(t) = \\hat{u}_0 \\exp\\left( \\left(-i a \\kappa - \\alpha \\kappa^2\\right) t \\right) = \\hat{u}_0 \\exp(-i a \\kappa t)\\,\\exp(-\\alpha \\kappa^2 t)$$\nThe magnitude of the amplitude is:\n$$|\\hat{u}(t)| = |\\hat{u}_0| \\left|\\exp(-i a \\kappa t)\\right| \\left|\\exp(-\\alpha \\kappa^2 t)\\right| = |\\hat{u}_0| \\exp(-\\alpha \\kappa^2 t)$$\nComparing this with the definition $|\\hat{u}(t)| \\sim |\\hat{u}_{0}|\\,\\exp(-\\lambda(\\kappa)\\,t)$, we identify the decay rate as:\n$$\\lambda(\\kappa) = \\alpha \\kappa^2 = \\frac{a \\Delta x}{2} (1-\\nu) \\kappa^2$$\nSubstituting $\\nu = \\frac{a \\Delta t}{\\Delta x}$, we get the final expression from this method:\n$$\\lambda(\\kappa) = \\frac{a \\Delta x}{2} \\left(1 - \\frac{a \\Delta t}{\\Delta x}\\right) \\kappa^2$$\n\n### Method 2: Von Neumann Stability Analysis\n\nWe substitute a single Fourier mode $u_j^n = G^n \\exp(i \\kappa x_j) = G^n \\exp(i j \\theta)$ into the discrete scheme, where $\\theta = \\kappa \\Delta x$ is the dimensionless grid wavenumber. The amplification factor $G$ determines the change in amplitude and phase over one time step.\n$$G^{n+1} \\exp(i j \\theta) = G^n \\exp(i j \\theta) - \\nu \\left(G^n \\exp(i j \\theta) - G^n \\exp(i (j-1) \\theta)\\right)$$\nDividing by $G^n \\exp(i j \\theta)$:\n$$G = 1 - \\nu (1 - \\exp(-i \\theta)) = (1-\\nu) + \\nu \\exp(-i \\theta)$$\nThe magnitude of the amplification factor, $|G|$, governs the amplitude decay. We compute its square:\n$$|G|^2 = ((1-\\nu) + \\nu \\cos\\theta)^2 + (-\\nu \\sin\\theta)^2$$\n$$|G|^2 = (1-\\nu)^2 + 2\\nu(1-\\nu)\\cos\\theta + \\nu^2\\cos^2\\theta + \\nu^2\\sin^2\\theta$$\n$$|G|^2 = 1 - 2\\nu + \\nu^2 + 2\\nu(1-\\nu)\\cos\\theta + \\nu^2 = 1 - 2\\nu(1-\\nu) + 2\\nu(1-\\nu)\\cos\\theta$$\n$$|G|^2 = 1 - 2\\nu(1-\\nu)(1-\\cos\\theta)$$\nThe problem asks for a leading-order analysis for small grid wavenumber $\\theta$. For small $\\theta$, we use the Taylor expansion $\\cos\\theta = 1 - \\frac{\\theta^2}{2} + O(\\theta^4)$.\n$$|G|^2 \\approx 1 - 2\\nu(1-\\nu)\\left(1 - \\left(1 - \\frac{\\theta^2}{2}\\right)\\right) = 1 - \\nu(1-\\nu)\\theta^2$$\nNow we find $|G|$ using the binomial approximation $\\sqrt{1-x} \\approx 1-\\frac{x}{2}$ for small $x$:\n$$|G| = \\sqrt{1 - \\nu(1-\\nu)\\theta^2} \\approx 1 - \\frac{1}{2}\\nu(1-\\nu)\\theta^2$$\nThe amplitude of the numerical solution at time $t_n = n \\Delta t$ is $|u_j^n| = |\\hat{u}_0| |G|^n$. We can write this as:\n$$|u_j^n| = |\\hat{u}_0| |G|^{t_n/\\Delta t} = |\\hat{u}_0| \\exp\\left(\\frac{t_n}{\\Delta t} \\ln|G|\\right)$$\nFor small $\\theta$, $|G|$ is close to $1$, so we can use the approximation $\\ln(1-x) \\approx -x$ for small $x$:\n$$\\ln|G| \\approx \\ln\\left(1 - \\frac{1}{2}\\nu(1-\\nu)\\theta^2\\right) \\approx -\\frac{1}{2}\\nu(1-\\nu)\\theta^2$$\nSubstituting this into the expression for the amplitude:\n$$|u_j^n| \\approx |\\hat{u}_0| \\exp\\left(\\frac{t_n}{\\Delta t} \\left(-\\frac{1}{2}\\nu(1-\\nu)\\theta^2\\right)\\right) = |\\hat{u}_0| \\exp\\left(-\\frac{\\nu(1-\\nu)\\theta^2}{2\\Delta t} t_n\\right)$$\nComparing with the definition $|\\hat{u}(t)| \\sim |\\hat{u}_{0}|\\,\\exp(-\\lambda(\\kappa)\\,t)$, we identify the decay rate:\n$$\\lambda(\\kappa) = \\frac{\\nu(1-\\nu)\\theta^2}{2\\Delta t}$$\nSubstituting back $\\nu = \\frac{a \\Delta t}{\\Delta x}$ and $\\theta = \\kappa \\Delta x$:\n$$\\lambda(\\kappa) = \\frac{1}{2\\Delta t} \\left(\\frac{a \\Delta t}{\\Delta x}\\right) \\left(1 - \\frac{a \\Delta t}{\\Delta x}\\right) (\\kappa \\Delta x)^2 = \\frac{a}{2\\Delta x} \\left(1 - \\frac{a \\Delta t}{\\Delta x}\\right) \\kappa^2 (\\Delta x)^2$$\n$$\\lambda(\\kappa) = \\frac{a \\Delta x}{2} \\left(1 - \\frac{a \\Delta t}{\\Delta x}\\right) \\kappa^2$$\n\n### Comparison and Conclusion\n\nThe expressions for the leading-order decay rate $\\lambda(\\kappa)$ derived from both the modified equation analysis and the von Neumann analysis are identical:\n$$\\lambda(\\kappa) = \\frac{a \\Delta x}{2} (1-\\nu) \\kappa^2 = \\frac{a \\Delta x}{2} \\left(1 - \\frac{a \\Delta t}{\\Delta x}\\right) \\kappa^2$$\nThis result confirms the consistency between the two analysis methods. The numerical diffusion term, which appears as the lowest-order even-derivative error term in the modified equation, is responsible for the dissipative nature of the scheme, causing the amplitude of Fourier modes to decay. The rate of decay is proportional to the square of the wavenumber, $\\kappa^2$, indicating that shorter wavelengths (larger $\\kappa$) are damped more quickly. This numerical dissipation is characteristic of the first-order upwind scheme.\n\nThe final expression for the decay rate per unit time is therefore given by the expression found through both methods.",
            "answer": "$$\\boxed{\\frac{a \\Delta x}{2} \\left(1 - \\frac{a \\Delta t}{\\Delta x}\\right) \\kappa^{2}}$$"
        },
        {
            "introduction": "Beyond accuracy and stability, a critical property for a numerical scheme is conservation, ensuring that discrete analogs of quantities like mass and momentum are not artificially created or destroyed. This practice directly contrasts a conservative, flux-differencing scheme with a non-conservative one to make this abstract principle tangible . By analytically demonstrating why one form conserves a discrete quantity while the other does not, you will gain a crucial insight into the robust design of finite volume methods.",
            "id": "3952240",
            "problem": "Consider one-dimensional passive scalar transport on the periodic interval $[0, 2\\pi]$, with a spatially varying advecting velocity field. The physically conservative governing equation is the scalar advection in conservation form\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(a(x)\\,u(x,t)\\right) = 0,\n$$\nwhere $u(x,t)$ is a dimensionless scalar and $a(x)$ is a prescribed, dimensionless, strictly positive velocity field. Let $a(x)$ be given by $a(x) = 1 + \\beta \\cos(x)$ with $0 < \\beta < 1$ so that $a(x) > 0$ for all $x \\in [0, 2\\pi]$.\n\nDefine a uniform grid with $N$ even, $N \\ge 4$, node locations $x_i = i \\,\\Delta x$ for $i = 0, 1, \\dots, N-1$, and grid spacing $\\Delta x = \\frac{2\\pi}{N}$. Let $u_i(t)$ denote a nodal approximation to $u(x_i,t)$. Consider two semi-discrete convective differencing schemes:\n\n- A conservative flux-differencing scheme constructed from the conservation law, using a first-order upwind flux for positive velocity,\n$$\n\\frac{d u_i}{d t} = -\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x}, \\quad F_{i+\\frac{1}{2}} = a\\!\\left(x_{i+\\frac{1}{2}}\\right)\\,u_i,\n$$\nwhere $x_{i+\\frac{1}{2}} = x_i + \\frac{\\Delta x}{2}$.\n\n- A nonconservative central-differencing scheme applied to the nonconservative operator $a(x)\\,\\frac{\\partial u}{\\partial x}$,\n$$\n\\frac{d u_i}{d t} = - a(x_i)\\,\\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x}.\n$$\n\nLet the initial condition be $u_i(0) = \\sin(x_i)$. Define the discrete approximation to the spatial integral of $u$ as $M(t) = \\Delta x \\sum_{i=0}^{N-1} u_i(t)$.\n\nStarting from the conservation form of the governing equation and the definitions above, analytically demonstrate which of the two schemes preserves $M(t)$ for periodic boundary conditions and which does not. Then, for the nonconservative central-differencing scheme, derive a closed-form analytic expression for the initial drift rate $\\frac{d M}{d t}\\big|_{t=0}$ as a function of $\\beta$ and $N$.\n\nYour final answer must be the single, simplified analytic expression for $\\frac{d M}{d t}\\big|_{t=0}$ under the nonconservative central-differencing scheme. No numerical approximation or rounding is required, and no physical units should be included in the final answer.",
            "solution": "The problem requires an analysis of two numerical schemes for the one-dimensional scalar advection equation in conservation form, $\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(a(x)\\,u(x,t)\\right) = 0$, on a periodic domain. We must determine which scheme conserves the total scalar mass and derive the initial rate of change of this mass for the non-conservative scheme.\n\nThe discrete approximation to the total scalar mass is defined as $M(t) = \\Delta x \\sum_{i=0}^{N-1} u_i(t)$. Its time derivative is given by\n$$\n\\frac{d M}{d t} = \\frac{d}{dt} \\left( \\Delta x \\sum_{i=0}^{N-1} u_i(t) \\right) = \\Delta x \\sum_{i=0}^{N-1} \\frac{d u_i}{d t}.\n$$\nA scheme is conservative if $\\frac{d M}{d t} = 0$. We will now analyze each scheme.\n\nFirst, consider the conservative flux-differencing upwind scheme. The semi-discrete equation for a node $i$ is\n$$\n\\frac{d u_i}{d t} = -\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x},\n$$\nwhere $F_{i+\\frac{1}{2}}$ is the numerical flux at the interface between nodes $i$ and $i+1$. Substituting this into the expression for $\\frac{d M}{d t}$:\n$$\n\\frac{d M}{d t} = \\Delta x \\sum_{i=0}^{N-1} \\left( -\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x} \\right) = - \\sum_{i=0}^{N-1} (F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}).\n$$\nThis sum is a telescoping series. Expanding the sum for $i = 0, 1, \\dots, N-1$:\n$$\n\\sum_{i=0}^{N-1} (F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}) = (F_{\\frac{1}{2}} - F_{-\\frac{1}{2}}) + (F_{\\frac{3}{2}} - F_{\\frac{1}{2}}) + \\dots + (F_{N-\\frac{1}{2}} - F_{N-\\frac{3}{2}}).\n$$\nDue to cancellations, the sum simplifies to $F_{N-\\frac{1}{2}} - F_{-\\frac{1}{2}}$. The problem specifies periodic boundary conditions. This implies that the grid wraps around, so that the interface to the left of node $0$ is the same as the interface to the right of node $N-1$. Mathematically, this means the flux is periodic, i.e., $F_{j+\\frac{1}{2}} = F_{j+N+\\frac{1}{2}}$ for any integer $j$. Therefore, $F_{-\\frac{1}{2}} = F_{N-\\frac{1}{2}}$. The sum is thus\n$$\nF_{N-\\frac{1}{2}} - F_{N-\\frac{1}{2}} = 0.\n$$\nHence, for the conservative upwind scheme, $\\frac{d M}{d t} = 0$. This scheme preserves the total scalar quantity $M(t)$, as expected from any scheme written in a discrete conservation-law (or flux-differencing) form.\n\nNext, consider the nonconservative central-differencing scheme. The semi-discrete equation is\n$$\n\\frac{d u_i}{d t} = - a(x_i)\\,\\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x}.\n$$\nSubstituting this into the expression for $\\frac{d M}{d t}$:\n$$\n\\frac{d M}{d t} = \\Delta x \\sum_{i=0}^{N-1} \\left( - a(x_i)\\,\\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x} \\right) = -\\frac{1}{2} \\sum_{i=0}^{N-1} a_i(u_{i+1} - u_{i-1}),\n$$\nwhere we use the shorthand $a_i = a(x_i)$. We can split the sum and perform a change of index (a discrete summation by parts):\n$$\n\\sum_{i=0}^{N-1} a_i(u_{i+1} - u_{i-1}) = \\sum_{i=0}^{N-1} a_i u_{i+1} - \\sum_{i=0}^{N-1} a_i u_{i-1}.\n$$\nUsing periodicity for the indices (i.e., $u_N=u_0$, $u_{-1}=u_{N-1}$, $a_N=a_0$, $a_{-1}=a_{N-1}$), we re-index the sums so that both have a factor of $u_i$:\n$$\n\\sum_{i=0}^{N-1} a_i u_{i+1} = \\sum_{j=1}^{N} a_{j-1} u_j = \\sum_{j=0}^{N-1} a_{j-1} u_j.\n$$\n$$\n\\sum_{i=0}^{N-1} a_i u_{i-1} = \\sum_{k=-1}^{N-2} a_{k+1} u_k = \\sum_{k=0}^{N-1} a_{k+1} u_k.\n$$\nCombining these results,\n$$\n\\frac{d M}{d t} = -\\frac{1}{2} \\left( \\sum_{i=0}^{N-1} a_{i-1} u_i - \\sum_{i=0}^{N-1} a_{i+1} u_i \\right) = \\frac{1}{2} \\sum_{i=0}^{N-1} (a_{i+1} - a_{i-1}) u_i.\n$$\nFor this scheme to be conservative, $\\frac{d M}{d t}$ must be zero for any choice of $u_i(t)$. This would require $a_{i+1} - a_{i-1} = 0$ for all $i$, which implies $a(x)$ must be a constant. Since $a(x) = 1 + \\beta \\cos(x)$ with $\\beta > 0$, the velocity field is not constant. Therefore, this central-differencing scheme is non-conservative and does not preserve $M(t)$.\n\nNow, we derive the expression for the initial drift rate $\\frac{d M}{d t}\\big|_{t=0}$ for this nonconservative scheme. The initial condition is $u_i(0) = \\sin(x_i)$.\n$$\n\\frac{d M}{d t}\\bigg|_{t=0} = \\frac{1}{2} \\sum_{i=0}^{N-1} (a_{i+1} - a_{i-1}) u_i(0) = \\frac{1}{2} \\sum_{i=0}^{N-1} (a(x_{i+1}) - a(x_{i-1})) \\sin(x_i).\n$$\nWith $a(x) = 1 + \\beta \\cos(x)$, the difference term is\n$$\na(x_{i+1}) - a(x_{i-1}) = (1 + \\beta \\cos(x_{i+1})) - (1 + \\beta \\cos(x_{i-1})) = \\beta (\\cos(x_{i+1}) - \\cos(x_{i-1})).\n$$\nUsing the trigonometric identity $\\cos(A) - \\cos(B) = -2 \\sin\\left(\\frac{A+B}{2}\\right) \\sin\\left(\\frac{A-B}{2}\\right)$, with $A=x_{i+1}=(i+1)\\Delta x$ and $B=x_{i-1}=(i-1)\\Delta x$:\n$$\n\\cos(x_{i+1}) - \\cos(x_{i-1}) = -2 \\sin\\left(\\frac{(i+1)\\Delta x + (i-1)\\Delta x}{2}\\right) \\sin\\left(\\frac{(i+1)\\Delta x - (i-1)\\Delta x}{2}\\right) = -2\\sin(i\\Delta x)\\sin(\\Delta x).\n$$\nSo, $a_{i+1} - a_{i-1} = -2\\beta\\sin(x_i)\\sin(\\Delta x)$.\nSubstituting this into the expression for the drift rate:\n$$\n\\frac{d M}{d t}\\bigg|_{t=0} = \\frac{1}{2} \\sum_{i=0}^{N-1} \\left( -2\\beta\\sin(x_i)\\sin(\\Delta x) \\right) \\sin(x_i) = -\\beta\\sin(\\Delta x) \\sum_{i=0}^{N-1} \\sin^2(x_i).\n$$\nWe must now evaluate the summation $\\sum_{i=0}^{N-1} \\sin^2(x_i)$. Using the identity $\\sin^2(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$:\n$$\n\\sum_{i=0}^{N-1} \\sin^2(x_i) = \\sum_{i=0}^{N-1} \\frac{1 - \\cos(2x_i)}{2} = \\frac{1}{2} \\sum_{i=0}^{N-1} 1 - \\frac{1}{2} \\sum_{i=0}^{N-1} \\cos(2x_i).\n$$\nThe first part of the sum is $\\frac{1}{2} \\sum_{i=0}^{N-1} 1 = \\frac{N}{2}$. The second part is a sum of cosines over a uniform discrete grid spanning the full period. With $x_i = i\\frac{2\\pi}{N}$, the sum is\n$$\n\\sum_{i=0}^{N-1} \\cos(2x_i) = \\sum_{i=0}^{N-1} \\cos\\left(i \\frac{4\\pi}{N}\\right).\n$$\nThis sum is the real part of a geometric series: $\\text{Re}\\left(\\sum_{k=0}^{N-1} (e^{i \\frac{4\\pi}{N}})^k\\right)$. The common ratio is $r = e^{i \\frac{4\\pi}{N}}$. Since $N \\ge 4$, $r \\neq 1$. The sum of the geometric series is $\\frac{1-r^N}{1-r}$. The numerator is $1 - (e^{i \\frac{4\\pi}{N}})^N = 1 - e^{i 4\\pi} = 1 - 1 = 0$. Thus, the sum is zero.\nTherefore,\n$$\n\\sum_{i=0}^{N-1} \\sin^2(x_i) = \\frac{N}{2} - 0 = \\frac{N}{2}.\n$$\nSubstituting this result back into the expression for the initial drift rate:\n$$\n\\frac{d M}{d t}\\bigg|_{t=0} = -\\beta\\sin(\\Delta x) \\left(\\frac{N}{2}\\right).\n$$\nFinally, substituting $\\Delta x = \\frac{2\\pi}{N}$, we obtain the closed-form expression:\n$$\n\\frac{d M}{d t}\\bigg|_{t=0} = -\\frac{N\\beta}{2} \\sin\\left(\\frac{2\\pi}{N}\\right).\n$$\nThis is the final analytical expression for the initial rate of change of the total scalar mass for the nonconservative scheme.",
            "answer": "$$\n\\boxed{-\\frac{N\\beta}{2}\\sin\\left(\\frac{2\\pi}{N}\\right)}\n$$"
        }
    ]
}