{
    "hands_on_practices": [
        {
            "introduction": "The Crank-Nicolson method is a cornerstone for the time integration of parabolic equations due to its second-order accuracy and unconditional stability. This exercise provides a foundational analysis of the scheme when applied to the 1D diffusion equation. By performing a von Neumann stability analysis, you will derive its amplification factor and rigorously verify its key properties, including a critical insight into its poor damping of high-frequency numerical modes .",
            "id": "3955585",
            "problem": "Consider the one-dimensional heat equation for a passive scalar in aerospace Computational Fluid Dynamics (CFD), with constant molecular diffusivity:\nGiven a periodic domain and a uniform spatial grid with spacing $\\Delta x$, the governing equation is\n$$\\frac{\\partial \\phi}{\\partial t} = \\Gamma \\frac{\\partial^{2} \\phi}{\\partial x^{2}},$$\nwhere $\\Gamma$ is constant. Use a second-order central difference for the spatial discretization on the grid points $x_{i} = i \\,\\Delta x$ to obtain a semi-discrete system for $\\phi_{i}(t)$.\n\nStarting only from the definitions of the second-order central difference and the trapezoidal rule in time, perform the following steps:\n\n1) Derive the semi-discrete ordinary differential equation at each grid point $i$ in the form\n$$\\frac{d \\phi_{i}}{dt} = \\Gamma \\frac{\\phi_{i+1} - 2 \\phi_{i} + \\phi_{i-1}}{\\Delta x^{2}}.$$\n\n2) Apply the trapezoidal rule in time over one step from $t^{n}$ to $t^{n+1}=t^{n}+\\Delta t$ to obtain a fully discrete linear system for $\\phi^{n+1}$ in the form of a Crank–Nicolson method (Crank–Nicolson (CN) method), and rewrite it in matrix form using the discrete diffusion operator $L$.\n\n3) Using von Neumann normal mode analysis, assume a Fourier mode ansatz $\\phi_{i}^{n} = A^{n} \\exp(\\mathrm{i} i \\theta)$, where $\\theta \\in [0,\\pi]$ is the nondimensional wavenumber and $\\mathrm{i}=\\sqrt{-1}$. Define the nondimensional time step $r = \\Gamma \\Delta t / \\Delta x^{2}$. Derive the temporal amplification factor $G(\\theta,r)$ for the CN scheme.\n\n4) Show by a Taylor expansion argument on the exact modal solution that the CN method is second-order accurate in time for this diffusive problem, and identify the leading-order difference between the CN stability function and the exact modal exponential at small time step.\n\n5) Characterize the damping behavior of the CN method for diffusive modes by evaluating the limit of the amplification factor for the highest resolvable wavenumber $\\theta=\\pi$ as $r \\to \\infty$, and interpret this limit physically.\n\nProvide the closed-form expression you derive for the amplification factor $G(\\theta,r)$ as your final answer. No numerical rounding is required. The final answer must be a single analytic expression with no units.",
            "solution": "The user has provided a multi-part problem concerning the numerical analysis of the one-dimensional heat equation. I will first validate the problem statement according to the specified criteria and then proceed to a complete solution if it is deemed valid.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   Governing Equation: $\\frac{\\partial \\phi}{\\partial t} = \\Gamma \\frac{\\partial^{2} \\phi}{\\partial x^{2}}$\n*   Domain: Periodic.\n*   Grid: Uniform spatial grid with spacing $\\Delta x$ and points $x_{i} = i \\Delta x$.\n*   Diffusivity: $\\Gamma$ is a constant.\n*   Task 1: Derive the semi-discrete ODE $\\frac{d \\phi_{i}}{dt} = \\Gamma \\frac{\\phi_{i+1} - 2 \\phi_{i} + \\phi_{i-1}}{\\Delta x^{2}}$ using a second-order central difference.\n*   Task 2: Apply the trapezoidal rule in time to obtain the Crank-Nicolson (CN) scheme and its matrix form using a discrete diffusion operator $L$.\n*   Task 3: Assume a Fourier mode ansatz $\\phi_{i}^{n} = A^{n} \\exp(\\mathrm{i} i \\theta)$, with $\\theta \\in [0,\\pi]$ and $\\mathrm{i}=\\sqrt{-1}$. Define the nondimensional time step $r = \\Gamma \\Delta t / \\Delta x^{2}$. Derive the temporal amplification factor $G(\\theta,r)$.\n*   Task 4: Show the CN method is second-order accurate in time by a Taylor expansion argument comparing the numerical and exact modal solutions. Identify the leading-order difference.\n*   Task 5: Characterize the damping behavior for the highest resolvable wavenumber $\\theta=\\pi$ as $r \\to \\infty$.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded:** The problem is based on the fundamental heat/diffusion equation and employs standard, well-established numerical methods (finite differences, Crank-Nicolson scheme, von Neumann stability analysis). These are core concepts in computational fluid dynamics (CFD) and numerical analysis. The problem is scientifically sound.\n*   **Well-Posed:** The problem is structured as a sequence of standard derivations. Each step is clearly defined and leads to a unique, meaningful result.\n*   **Objective:** The language is formal, precise, and free of any subjective or ambiguous terminology.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. It is a standard, well-posed problem in numerical methods for partial differential equations. I will now provide a complete, reasoned solution.\n\n### Solution\n\n**1) Derivation of the Semi-Discrete Ordinary Differential Equation**\n\nThe governing partial differential equation (PDE) is given by:\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\Gamma \\frac{\\partial^{2} \\phi}{\\partial x^{2}}\n$$\nWe discretize the spatial domain using a uniform grid with spacing $\\Delta x$, such that $x_i = i \\Delta x$. Let $\\phi_i(t)$ be the approximation of $\\phi(x_i, t)$. The spatial second derivative $\\frac{\\partial^2 \\phi}{\\partial x^2}$ at grid point $x_i$ is approximated using a second-order accurate central difference formula:\n$$\n\\left. \\frac{\\partial^{2} \\phi}{\\partial x^{2}} \\right|_{x=x_i} \\approx \\frac{\\phi(x_{i+1}) - 2\\phi(x_i) + \\phi(x_{i-1})}{\\Delta x^2} = \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{\\Delta x^2}\n$$\nSubstituting this approximation into the PDE, we replace the partial time derivative with an ordinary time derivative for the grid point value $\\phi_i(t)$, as the spatial dependence has been discretized. This process, known as the method of lines, yields a system of coupled ordinary differential equations (ODEs), one for each grid point $i$:\n$$\n\\frac{d \\phi_{i}}{dt} = \\Gamma \\frac{\\phi_{i+1} - 2 \\phi_{i} + \\phi_{i-1}}{\\Delta x^{2}}\n$$\nThis is the required semi-discrete form.\n\n**2) Derivation of the Crank-Nicolson Scheme**\n\nWe now discretize the semi-discrete ODE in time. The trapezoidal rule for an ODE of the form $\\frac{dy}{dt} = f(y)$ over a time step from $t^n$ to $t^{n+1} = t^n + \\Delta t$ is:\n$$\ny^{n+1} = y^n + \\frac{\\Delta t}{2} \\left[ f(y^n) + f(y^{n+1}) \\right]\n$$\nFor our system, $y_i$ corresponds to $\\phi_i$ and the function $f(\\phi)_i$ is the right-hand side of the semi-discrete equation:\n$$\nf(\\phi)_i = \\Gamma \\frac{\\phi_{i+1} - 2 \\phi_{i} + \\phi_{i-1}}{\\Delta x^{2}}\n$$\nApplying the trapezoidal rule gives:\n$$\n\\phi_i^{n+1} = \\phi_i^n + \\frac{\\Delta t}{2} \\left[ \\left(\\Gamma \\frac{\\phi_{i+1}^n - 2 \\phi_i^n + \\phi_{i-1}^n}{\\Delta x^2}\\right) + \\left(\\Gamma \\frac{\\phi_{i+1}^{n+1} - 2 \\phi_i^{n+1} + \\phi_{i-1}^{n+1}}{\\Delta x^2}\\right) \\right]\n$$\nWe group terms at time level $n+1$ on the left-hand side and terms at time level $n$ on the right-hand side:\n$$\n\\phi_i^{n+1} - \\frac{\\Gamma \\Delta t}{2 \\Delta x^2} (\\phi_{i+1}^{n+1} - 2 \\phi_i^{n+1} + \\phi_{i-1}^{n+1}) = \\phi_i^n + \\frac{\\Gamma \\Delta t}{2 \\Delta x^2} (\\phi_{i+1}^n - 2 \\phi_i^n + \\phi_{i-1}^n)\n$$\nThis is the fully discrete Crank-Nicolson scheme. To express it in matrix form, we define the discrete diffusion operator $L$ acting on the vector of grid values $\\vec{\\phi}$ such that $(L\\vec{\\phi})_i = \\frac{\\phi_{i+1} - 2 \\phi_{i} + \\phi_{i-1}}{\\Delta x^{2}}$. The semi-discrete system is $\\frac{d\\vec{\\phi}}{dt} = \\Gamma L \\vec{\\phi}$. The fully discrete system can then be written as:\n$$\n\\vec{\\phi}^{n+1} - \\frac{\\Gamma \\Delta t}{2} L \\vec{\\phi}^{n+1} = \\vec{\\phi}^n + \\frac{\\Gamma \\Delta t}{2} L \\vec{\\phi}^n\n$$\nFactoring out the vectors $\\vec{\\phi}^{n+1}$ and $\\vec{\\phi}^{n}$ gives the final matrix form, where $\\mathbf{I}$ is the identity matrix and $\\mathbf{L}$ is the matrix representation of the operator $L$:\n$$\n\\left(\\mathbf{I} - \\frac{\\Gamma \\Delta t}{2} \\mathbf{L}\\right) \\vec{\\phi}^{n+1} = \\left(\\mathbf{I} + \\frac{\\Gamma \\Delta t}{2} \\mathbf{L}\\right) \\vec{\\phi}^{n}\n$$\n\n**3) Derivation of the Temporal Amplification Factor**\n\nFor von Neumann stability analysis, we substitute the Fourier mode ansatz $\\phi_i^k = A^k \\exp(\\mathrm{i} i \\theta)$ into the scalar form of the Crank-Nicolson scheme. The amplification factor is defined as $G = G(\\theta,r) = A^{n+1}/A^n$, which implies $\\phi_i^{n+1} = G \\phi_i^n$.\n$$\nG \\phi_i^n - \\frac{r}{2} (G \\phi_{i+1}^n - 2 G \\phi_i^n + G \\phi_{i-1}^n) = \\phi_i^n + \\frac{r}{2} (\\phi_{i+1}^n - 2 \\phi_i^n + \\phi_{i-1}^n)\n$$\nwhere $r = \\frac{\\Gamma\\Delta t}{\\Delta x^2}$. We substitute $\\phi_i^n = A^n \\exp(\\mathrm{i}i\\theta)$ and divide the entire equation by $A^n \\exp(\\mathrm{i}i\\theta)$:\n$$\nG - \\frac{r}{2} G (\\exp(\\mathrm{i}\\theta) - 2 + \\exp(-\\mathrm{i}\\theta)) = 1 + \\frac{r}{2} (\\exp(\\mathrm{i}\\theta) - 2 + \\exp(-\\mathrm{i}\\theta))\n$$\nUsing the identity $2\\cos\\theta = \\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta)$, the term in the parentheses becomes $2\\cos\\theta - 2$. Then using the half-angle identity $1-\\cos\\theta = 2\\sin^2(\\theta/2)$, this simplifies to $-4\\sin^2(\\theta/2)$.\nSubstituting this back into the equation:\n$$\nG - \\frac{r}{2} G (-4\\sin^2(\\theta/2)) = 1 + \\frac{r}{2} (-4\\sin^2(\\theta/2))\n$$\n$$\nG (1 + 2r\\sin^2(\\theta/2)) = 1 - 2r\\sin^2(\\theta/2)\n$$\nSolving for the amplification factor $G$ yields:\n$$\nG(\\theta,r) = \\frac{1 - 2r\\sin^2(\\theta/2)}{1 + 2r\\sin^2(\\theta/2)}\n$$\n\n**4) Accuracy Analysis**\n\nTo analyze the temporal accuracy, we compare the numerical amplification factor $G_{CN} = G(\\theta,r)$ with the exact amplification factor of the semi-discrete ODE system, $G_{semi-exact}$. The semi-discrete ODE has modal solutions of the form $\\phi_i(t) = \\hat{\\phi}(t) \\exp(\\mathrm{i}i\\theta)$. The associated eigenvalue $\\lambda(\\theta)$ of the operator $\\Gamma L$ is:\n$$\n\\lambda(\\theta) = \\Gamma \\frac{\\exp(\\mathrm{i}\\theta) - 2 + \\exp(-\\mathrm{i}\\theta)}{\\Delta x^2} = \\frac{\\Gamma}{\\Delta x^2}(2\\cos\\theta - 2) = -\\frac{4\\Gamma}{\\Delta x^2}\\sin^2(\\theta/2)\n$$\nThe exact solution to the semi-discrete ODE over one time step $\\Delta t$ is amplified by $G_{semi-exact} = \\exp(\\lambda(\\theta)\\Delta t) = \\exp\\left(-\\frac{4\\Gamma\\Delta t}{\\Delta x^2}\\sin^2(\\theta/2)\\right) = \\exp(-4r\\sin^2(\\theta/2))$. Let $z = -4r\\sin^2(\\theta/2)$.\nSo, $G_{semi-exact} = \\exp(z)$.\nThe numerical amplification factor can be written in terms of $z$ as $G_{CN} = \\frac{1+z/2}{1-z/2}$. This is the $(1,1)$-Padé approximant to $\\exp(z)$.\nWe perform a Taylor series expansion of both factors for small $z$ (which corresponds to small $\\Delta t$):\n$$\nG_{semi-exact} = \\exp(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24} + \\mathcal{O}(z^5)\n$$\n$$\nG_{CN} = \\frac{1+z/2}{1-z/2} = (1+z/2)\\left(1 + \\frac{z}{2} + \\frac{z^2}{4} + \\frac{z^3}{8} + \\mathcal{O}(z^4)\\right) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{4} + \\mathcal{O}(z^4)\n$$\nThe difference between the numerical and semi-exact amplification factors is:\n$$\nG_{CN} - G_{semi-exact} = \\left(\\frac{1}{4} - \\frac{1}{6}\\right)z^3 + \\mathcal{O}(z^4) = \\frac{1}{12}z^3 + \\mathcal{O}(z^4)\n$$\nThe local error incurred in one step is proportional to $z^3$. Since $z$ is proportional to $\\Delta t$, the local error is $\\mathcal{O}(\\Delta t^3)$. The local truncation error (LTE) is the error per unit time, and is $\\mathcal{O}(\\Delta t^2)$. For a stable one-step method, an LTE of $\\mathcal{O}(\\Delta t^2)$ implies a global error of $\\mathcal{O}(\\Delta t^2)$, establishing that the Crank-Nicolson method is second-order accurate in time for this problem.\nThe leading-order difference is $\\frac{1}{12}z^3 = \\frac{1}{12}(-4r\\sin^2(\\theta/2))^3 = -\\frac{64}{12}r^3\\sin^6(\\theta/2) = -\\frac{16}{3}r^3\\sin^6(\\theta/2)$.\n\n**5) Damping Behavior for High Wavenumbers**\n\nWe analyze the behavior of the amplification factor for the highest resolvable wavenumber on the grid. This mode corresponds to a wavelength of $2\\Delta x$, which has a sawtooth pattern of alternating signs. For this mode, $\\phi_{i+1} = -\\phi_i$, which implies $\\exp(\\mathrm{i}\\theta)=-1$, so the nondimensional wavenumber is $\\theta=\\pi$.\nWe evaluate the amplification factor $G(\\theta,r)$ at $\\theta=\\pi$:\n$$\nG(\\pi,r) = \\frac{1 - 2r\\sin^2(\\pi/2)}{1 + 2r\\sin^2(\\pi/2)} = \\frac{1 - 2r(1)^2}{1 + 2r(1)^2} = \\frac{1 - 2r}{1 + 2r}\n$$\nNow, we take the limit as the nondimensional time step $r \\to \\infty$. This corresponds to a large time step $\\Delta t$, large diffusivity $\\Gamma$, or small grid spacing $\\Delta x$:\n$$\n\\lim_{r\\to\\infty} G(\\pi, r) = \\lim_{r\\to\\infty} \\frac{1 - 2r}{1 + 2r} = \\lim_{r\\to\\infty} \\frac{1/r - 2}{1/r + 2} = \\frac{0 - 2}{0 + 2} = -1\n$$\n**Physical Interpretation:** The limit of the amplification factor is $-1$. An amplification factor $G$ with magnitude $|G|<1$ indicates damping, $|G|=1$ indicates neutral stability (no damping), and $|G|>1$ indicates instability. In this case, $|G(\\pi, r \\to \\infty)| = |-1| = 1$. This means that for very large time steps, the highest frequency mode is not damped at all. Instead, its amplitude is preserved, and its sign is flipped at every time step. This leads to persistent, non-physical oscillations in the numerical solution. While the Crank-Nicolson scheme is unconditionally stable for the diffusion equation (since $|G(\\theta,r)| \\le 1$ for all $\\theta, r$), its lack of appropriate damping for high-wavenumber modes at large $r$ is a significant drawback. This numerical artifact can contaminate the solution with high-frequency noise.",
            "answer": "$$\n\\boxed{\\frac{1 - 2r\\sin^2(\\frac{\\theta}{2})}{1 + 2r\\sin^2(\\frac{\\theta}{2})}}\n$$"
        },
        {
            "introduction": "While the Crank-Nicolson scheme is celebrated for its accuracy and stability, the previous analysis hints at a practical flaw: the potential for non-physical oscillations. This practice delves deeper into this issue by examining the general $\\theta$-scheme, which includes Crank-Nicolson as a special case. The goal is to derive the precise conditions under which a scheme guarantees monotone behavior, preventing overshoots and ensuring that numerical solutions reflect the smooth, dissipative nature of the underlying physics .",
            "id": "3955647",
            "problem": "Consider the one-dimensional ($1$D) heat (diffusion) equation $u_{t}=\\nu u_{xx}$ with constant kinematic diffusivity $\\nu>0$ on a periodic domain of length $L$. Let the domain be discretized uniformly with grid spacing $\\Delta x=L/N$ for some integer $N\\ge 4$. Denote the grid points by $x_{j}=j\\Delta x$, and let $u_{j}^{n}$ denote the numerical approximation to $u(x_{j},t^{n})$ at time level $t^{n}=n\\Delta t$, with time step $\\Delta t>0$. Discretize the spatial second derivative with the standard second-order central difference operator and advance in time with the $\\theta$-scheme:\n$$\n\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\nu\\left[\\theta\\,\\frac{u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}}{\\Delta x^{2}}+(1-\\theta)\\,\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{\\Delta x^{2}}\\right],\n$$\nwhere $\\theta\\in[0,1]$.\n\nYou are asked to analyze the fully discrete scheme on the periodic uniform grid by considering discrete Fourier modes of the form $u_{j}^{n}=\\widehat{u}^{\\,n}\\exp(i k x_{j})$ with wavenumber $k=2\\pi m/L$, where $m\\in\\{-N/2+1,\\ldots, N/2\\}$ and $i=\\sqrt{-1}$. Proceed from fundamental principles as follows:\n\n$1$. Derive the scalar amplification factor $G_{\\theta}(k)$, defined by $\\widehat{u}^{\\,n+1}=G_{\\theta}(k)\\,\\widehat{u}^{\\,n}$, in terms of $\\nu$, $\\Delta t$, $\\Delta x$, $\\theta$, and $k$.\n\n$2$. Specialize to the Crank–Nicolson (CN) choice $\\theta=1/2$ and show that there exists a threshold on $\\Delta t$ above which the highest resolvable wavenumber mode on the grid produces $G_{1/2}(k)<0$ (a sign change of the amplitude), i.e., a temporal overshoot/undershoot. Identify this threshold on $\\Delta t$ in terms of $\\nu$ and $\\Delta x$.\n\n$3$. Define monotone-in-time behavior for this linear diffusion problem as the requirement that, for all resolvable wavenumbers $k$, the amplification factor satisfies $G_{\\theta}(k)\\in[0,1]$ so that every mode decays without oscillation in time. Using only the definitions above and your result from part $1$, derive a single closed-form expression for the minimal $\\theta$ as a function of $\\nu$, $\\Delta t$, and $\\Delta x$ that ensures $G_{\\theta}(k)\\in[0,1]$ for all grid-resolvable modes on the periodic grid. Your expression must respect the constraint $\\theta\\ge 1/2$. Provide your final answer as this minimal $\\theta$ in a single closed-form analytic expression. No numerical evaluation is required, and no units should be included in the final answer.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Partial Differential Equation**: One-dimensional ($1$D) heat (diffusion) equation $u_{t}=\\nu u_{xx}$.\n*   **Physical Parameters**: Constant kinematic diffusivity $\\nu > 0$. Domain is periodic with length $L$.\n*   **Discretization Parameters**: Uniform grid spacing $\\Delta x=L/N$ for an integer $N\\ge 4$. Grid points are $x_{j}=j\\Delta x$. The numerical approximation to $u(x_{j}, t^{n})$ is denoted $u_{j}^{n}$, where $t^{n}=n\\Delta t$ and $\\Delta t>0$.\n*   **Numerical Scheme**: The $\\theta$-scheme is given by:\n    $$\n    \\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\nu\\left[\\theta\\,\\frac{u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}}{\\Delta x^{2}}+(1-\\theta)\\,\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{\\Delta x^{2}}\\right]\n    $$\n    with $\\theta\\in[0,1]$.\n*   **Analysis Method**: Discrete Fourier analysis using modes of the form $u_{j}^{n}=\\widehat{u}^{\\,n}\\exp(i k x_{j})$, with wavenumber $k=2\\pi m/L$ where $m\\in\\{-N/2+1,\\ldots, N/2\\}$ and $i=\\sqrt{-1}$.\n*   **Task 1**: Derive the scalar amplification factor $G_{\\theta}(k)$ defined by $\\widehat{u}^{\\,n+1}=G_{\\theta}(k)\\,\\widehat{u}^{\\,n}$.\n*   **Task 2**: For the Crank–Nicolson (CN) case ($\\theta=1/2$), find the threshold on $\\Delta t$ above which the highest resolvable wavenumber mode yields $G_{1/2}(k)<0$.\n*   **Task 3**: Define monotone-in-time behavior by the condition $G_{\\theta}(k)\\in[0,1]$ for all resolvable wavenumbers. Derive the minimal $\\theta$ as a function of $\\nu$, $\\Delta t$, and $\\Delta x$ that ensures this behavior, while also respecting the constraint $\\theta\\ge 1/2$.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded**: The problem is fundamentally sound. It addresses the stability analysis of a standard finite difference scheme ($\\theta$-scheme) for the diffusion equation, a core topic in numerical analysis and scientific computing.\n*   **Well-Posed**: The problem is clearly stated and self-contained. It provides all necessary definitions and equations to derive the requested quantities. The tasks are specific and lead to unique, meaningful results.\n*   **Objective**: The problem is formulated in precise, mathematical language, free from any subjectivity or ambiguity.\n\nThe problem does not exhibit any of the listed flaws (e.g., scientific unsoundness, incompleteness, contradiction, or vagueness). It is a well-defined, standard exercise in the stability analysis of numerical methods for PDEs.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. A complete solution will be provided.\n\n### Detailed Solution\n\nThe solution proceeds by following the three parts outlined in the problem statement.\n\n**Part 1: Derivation of the Amplification Factor**\n\nWe perform a von Neumann stability analysis by substituting the discrete Fourier mode $u_{j}^{n}=\\widehat{u}^{\\,n}\\exp(i k x_{j})$ into the $\\theta$-scheme. The spatial shifts are handled as follows: $u_{j\\pm 1}^{n} = u_j^n \\exp(\\pm ik\\Delta x)$.\nThe discrete spatial operator $\\delta_{xx} u_j = (u_{j+1} - 2u_j + u_{j-1})/\\Delta x^2$ acting on the Fourier mode gives:\n$$\n\\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta x^2} = \\frac{u_j(\\exp(ik\\Delta x) - 2 + \\exp(-ik\\Delta x))}{\\Delta x^2}\n$$\nUsing Euler's identity $\\exp(i\\phi)+\\exp(-i\\phi) = 2\\cos(\\phi)$, this becomes:\n$$\n\\frac{u_j(2\\cos(k\\Delta x) - 2)}{\\Delta x^2} = -\\frac{2u_j}{\\Delta x^2}(1-\\cos(k\\Delta x))\n$$\nSubstituting this into the $\\theta$-scheme for both time levels $n$ and $n+1$:\n$$\n\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t} = \\nu\\left[ \\theta \\left(-\\frac{2u_j^{n+1}}{\\Delta x^2}(1-\\cos(k\\Delta x))\\right) + (1-\\theta)\\left(-\\frac{2u_j^n}{\\Delta x^2}(1-\\cos(k\\Delta x))\\right) \\right]\n$$\nSubstituting $u_j^n = \\widehat{u}^{\\,n}\\exp(ikx_j)$ and $u_j^{n+1} = \\widehat{u}^{\\,n+1}\\exp(ikx_j)$ and cancelling the common factor $\\exp(ikx_j)$:\n$$\n\\frac{\\widehat{u}^{\\,n+1}-\\widehat{u}^{\\,n}}{\\Delta t} = -\\frac{2\\nu}{\\Delta x^2}(1-\\cos(k\\Delta x)) \\left[ \\theta \\widehat{u}^{\\,n+1} + (1-\\theta)\\widehat{u}^{\\,n} \\right]\n$$\nTo simplify, let's define a non-dimensional parameter $\\alpha(k)$:\n$$\n\\alpha(k) = \\frac{2\\nu\\Delta t}{\\Delta x^2}(1-\\cos(k\\Delta x))\n$$\nNote that since $\\nu>0$, $\\Delta t>0$, $\\Delta x^2>0$, and $(1-\\cos(k\\Delta x)) \\ge 0$, we have $\\alpha(k) \\ge 0$. The equation becomes:\n$$\n\\widehat{u}^{\\,n+1}-\\widehat{u}^{\\,n} = -\\alpha(k) \\left[ \\theta \\widehat{u}^{\\,n+1} + (1-\\theta)\\widehat{u}^{\\,n} \\right]\n$$\nNow, we group terms with $\\widehat{u}^{\\,n+1}$ on the left-hand side and terms with $\\widehat{u}^{\\,n}$ on the right-hand side:\n$$\n\\widehat{u}^{\\,n+1} (1 + \\theta\\alpha(k)) = \\widehat{u}^{\\,n} (1 - (1-\\theta)\\alpha(k))\n$$\nThe amplification factor $G_{\\theta}(k) = \\widehat{u}^{\\,n+1}/\\widehat{u}^{\\,n}$ is therefore:\n$$\nG_{\\theta}(k) = \\frac{1 - (1-\\theta)\\alpha(k)}{1 + \\theta\\alpha(k)}\n$$\nSubstituting the expression for $\\alpha(k)$ gives the final form for the amplification factor:\n$$\nG_{\\theta}(k) = \\frac{1 - (1-\\theta)\\frac{2\\nu\\Delta t}{\\Delta x^2}(1-\\cos(k\\Delta x))}{1 + \\theta\\frac{2\\nu\\Delta t}{\\Delta x^2}(1-\\cos(k\\Delta x))}\n$$\n\n**Part 2: Analysis of the Crank-Nicolson Scheme**\n\nThe Crank-Nicolson (CN) scheme corresponds to the choice $\\theta=1/2$. Substituting this into the derived expression for $G_{\\theta}(k)$:\n$$\nG_{1/2}(k) = \\frac{1 - \\frac{1}{2}\\frac{2\\nu\\Delta t}{\\Delta x^2}(1-\\cos(k\\Delta x))}{1 + \\frac{1}{2}\\frac{2\\nu\\Delta t}{\\Delta x^2}(1-\\cos(k\\Delta x))} = \\frac{1 - \\frac{\\nu\\Delta t}{\\Delta x^2}(1-\\cos(k\\Delta x))}{1 + \\frac{\\nu\\Delta t}{\\Delta x^2}(1-\\cos(k\\Delta x))}\n$$\nA temporal overshoot/undershoot occurs when the amplification factor is negative, i.e., $G_{1/2}(k)<0$. Since the denominator is always positive for $\\nu>0, \\Delta t>0$, this condition is equivalent to the numerator being negative:\n$$\n1 - \\frac{\\nu\\Delta t}{\\Delta x^2}(1-\\cos(k\\Delta x)) < 0\n$$\nThe problem asks to consider the highest resolvable wavenumber on the grid. For a grid spacing $\\Delta x$, the shortest resolvable wavelength is $2\\Delta x$, which corresponds to the Nyquist wavenumber $k_{max} = \\pi/\\Delta x$. This wavenumber corresponds to $m=N/2$ in the provided set $k=2\\pi m/L$.\nAt this wavenumber, the term $(1-\\cos(k\\Delta x))$ is maximized:\n$$\n1-\\cos(k_{max}\\Delta x) = 1-\\cos(\\pi) = 1 - (-1) = 2\n$$\nSubstituting this into the inequality:\n$$\n1 - \\frac{\\nu\\Delta t}{\\Delta x^2}(2) < 0\n$$\n$$\n1 < \\frac{2\\nu\\Delta t}{\\Delta x^2}\n$$\nSolving for the time step $\\Delta t$ gives the threshold:\n$$\n\\Delta t > \\frac{\\Delta x^2}{2\\nu}\n$$\nThus, for the CN scheme, temporal oscillations are introduced for the highest frequency mode if the time step $\\Delta t$ exceeds the threshold value of $\\Delta x^2/(2\\nu)$.\n\n**Part 3: Derivation of Minimal $\\theta$ for Monotone-in-Time Behavior**\n\nMonotone-in-time behavior is defined by the condition $G_{\\theta}(k) \\in [0, 1]$ for all resolvable wavenumbers $k$. This single condition can be split into two inequalities: $G_{\\theta}(k) \\le 1$ and $G_{\\theta}(k) \\ge 0$.\n\n1.  **Condition $G_{\\theta}(k) \\le 1$**:\n    $$\n    \\frac{1 - (1-\\theta)\\alpha(k)}{1 + \\theta\\alpha(k)} \\le 1\n    $$\n    Since $1 + \\theta\\alpha(k) > 0$ for $\\theta \\in [0,1]$ and $\\alpha(k) \\ge 0$, we can multiply both sides by the denominator:\n    $$\n    1 - (1-\\theta)\\alpha(k) \\le 1 + \\theta\\alpha(k)\n    $$\n    $$\n    -(1-\\theta)\\alpha(k) \\le \\theta\\alpha(k)\n    $$\n    $$\n    -\\alpha(k) + \\theta\\alpha(k) \\le \\theta\\alpha(k) \\implies -\\alpha(k) \\le 0\n    $$\n    This is always true because $\\alpha(k) \\ge 0$. Therefore, the condition $G_{\\theta}(k) \\le 1$ holds for all $\\theta \\in [0, 1]$ and for all valid parameters and wavenumbers.\n\n2.  **Condition $G_{\\theta}(k) \\ge 0$**:\n    This is the governing constraint for monotonicity.\n    $$\n    \\frac{1 - (1-\\theta)\\alpha(k)}{1 + \\theta\\alpha(k)} \\ge 0\n    $$\n    Again, since the denominator is positive, this simplifies to the numerator being non-negative:\n    $$\n    1 - (1-\\theta)\\alpha(k) \\ge 0 \\implies 1 \\ge (1-\\theta)\\alpha(k)\n    $$\n    This inequality must hold for all resolvable wavenumbers $k$. To ensure this, we must satisfy the condition for the \"worst-case\" wavenumber, which is the one that maximizes $\\alpha(k)$.\n    $$\n    \\alpha(k) = \\frac{2\\nu\\Delta t}{\\Delta x^2}(1-\\cos(k\\Delta x))\n    $$\n    The term $(1-\\cos(k\\Delta x))$ is maximized when $\\cos(k\\Delta x)$ is minimized. As established in Part 2, the minimum value is $-1$, which occurs at the highest resolvable wavenumber $k_{max}=\\pi/\\Delta x$. The maximum value of the term is $2$.\n    Therefore, the maximum value of $\\alpha(k)$ is:\n    $$\n    \\alpha_{max} = \\frac{2\\nu\\Delta t}{\\Delta x^2}(2) = \\frac{4\\nu\\Delta t}{\\Delta x^2}\n    $$\n    The monotonicity condition becomes:\n    $$\n    1 \\ge (1-\\theta) \\frac{4\\nu\\Delta t}{\\Delta x^2}\n    $$\n    We solve this inequality for $\\theta$. Since $\\theta \\in [0, 1]$, the term $1-\\theta$ is non-negative.\n    $$\n    \\theta - 1 \\ge -\\frac{\\Delta x^2}{4\\nu\\Delta t} \\implies \\theta \\ge 1 - \\frac{\\Delta x^2}{4\\nu\\Delta t}\n    $$\n    This inequality provides the lower bound on $\\theta$ to ensure monotonicity for all modes. The problem also specifies that the final expression must respect the constraint $\\theta \\ge 1/2$. Consequently, the minimal value of $\\theta$ must satisfy both conditions:\n    $$\n    \\theta \\ge 1 - \\frac{\\Delta x^2}{4\\nu\\Delta t} \\quad \\text{and} \\quad \\theta \\ge \\frac{1}{2}\n    $$\n    This requires $\\theta$ to be greater than or equal to the maximum of the two lower bounds. Therefore, the minimal value for $\\theta$ is:\n    $$\n    \\theta_{min} = \\max\\left(\\frac{1}{2}, 1 - \\frac{\\Delta x^2}{4\\nu\\Delta t}\\right)\n    $$\n    This is the single closed-form expression for the minimal $\\theta$ that guarantees monotone decay for all resolvable modes while respecting the problem's constraints.",
            "answer": "$$\n\\boxed{\\max\\left(\\frac{1}{2}, 1 - \\frac{\\Delta x^2}{4\\nu\\Delta t}\\right)}\n$$"
        },
        {
            "introduction": "Practical CFD simulations, especially in aerospace, rarely use uniform grids. To efficiently resolve thin boundary layers, grids are often highly stretched, featuring cells with large aspect ratios. This exercise shifts our focus to the spatial domain to investigate how grid anisotropy impacts the accuracy of the discretized diffusion operator. You will use modified wavenumber analysis to quantify this direction-dependent error and derive a practical grid design rule to maintain simulation fidelity .",
            "id": "3955639",
            "problem": "Consider the two-dimensional diffusion equation for a passive scalar in a boundary-layer-resolving mesh, governed by the parabolic partial differential equation $\\partial u/\\partial t = \\nu \\nabla^{2} u$, where $\\nu$ is the kinematic viscosity. In a locally boundary-layer-aligned orthogonal Cartesian mesh, assume that the grid is highly stretched in the wall-normal direction $y$ and relatively coarse in the streamwise direction $x$, so that the local spacings are $\\Delta x$ and $\\Delta y$ with aspect ratio $\\alpha \\equiv \\Delta x / \\Delta y \\ge 1$. Assume that within each discrete stencil, the mesh is locally uniform (that is, $\\Delta x$ and $\\Delta y$ can be treated as constants over that stencil), which is a standard hypothesis of local Fourier analysis for smoothly stretched grids.\n\nDiscretize the diffusive operator using second-order central differences in each direction. Let a local plane-wave mode be characterized by the continuous wavenumber vector $(k_{x}, k_{y})$ of magnitude $k$ and polar angle $\\theta$, so that $k_{x} = k \\cos\\theta$ and $k_{y} = k \\sin\\theta$. Define the modified wavenumber squared of the discrete Laplacian, $\\tilde{k}^{2}(\\theta)$, as the positive scalar such that the discrete diffusion operator acting on the plane wave produces $-\\nu \\tilde{k}^{2}(\\theta)$ times the mode amplitude. Define the normalized discrete dissipation factor $R(\\theta)$ by $R(\\theta) \\equiv \\tilde{k}^{2}(\\theta) / k^{2}$.\n\nUsing only fundamental definitions and the above hypotheses, perform the following:\n\n1) Starting from the second-order central-difference discrete Laplacian on a locally uniform but anisotropic grid, derive an exact expression for $R(\\theta)$ in terms of $\\alpha$, the non-dimensional wall-normal wavenumber $\\eta \\equiv k \\Delta y$, and the angular coordinate $\\theta$.\n\n2) For modes satisfying $\\eta \\ll 1$ (wavelengths sufficiently resolved in the wall-normal direction), expand $R(\\theta)$ to leading non-trivial order in $\\eta$ and use this to quantify the angular anisotropy of discrete dissipation induced by grid stretching. In particular, evaluate $R(0)$ and $R(\\pi/2)$ to the same order and obtain the leading-order difference $|R(0) - R(\\pi/2)|$ as a function of $\\alpha$ and $\\eta$.\n\n3) Taking this leading-order difference as a conservative measure of anisotropic dissipation, formulate a grid design criterion that bounds the angular variation of the normalized dissipation by a prescribed tolerance $0 < \\epsilon \\ll 1$, that is, require $|R(0) - R(\\pi/2)| \\le \\epsilon$. Solve this bound explicitly for the maximum allowable aspect ratio $\\alpha_{\\max}$ as a function of $\\epsilon$ and $\\eta$.\n\nProvide your final answer as a single closed-form analytic expression for $\\alpha_{\\max}(\\epsilon, \\eta)$. No numerical values are required. The analysis should be self-consistent and should start from fundamental definitions without invoking any pre-derived anisotropy formulas for the discrete Laplacian. The final answer must be a single analytic expression and must not include any units.",
            "solution": "The problem statement is scientifically sound, well-posed, and free of contradictions or ambiguities. It presents a standard, albeit detailed, problem in the numerical analysis of partial differential equations, specifically the local Fourier analysis of a finite difference scheme for the diffusion equation on an anisotropic grid. All necessary definitions and constraints are provided to derive a unique analytical solution. Therefore, the problem is deemed valid and a full solution can be constructed.\n\nThe solution is derived in three sequential parts as requested.\n\nFirst, we derive the expression for the normalized discrete dissipation factor, $R(\\theta)$. The continuous diffusion operator is the Laplacian, $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$. Its action upon a plane-wave mode $u(x,y) = \\exp(i(k_x x + k_y y))$, where $i$ is the imaginary unit, is given by:\n$$ \\nabla^2 \\left( \\exp(i(k_x x + k_y y)) \\right) = ( (ik_x)^2 + (ik_y)^2 ) \\exp(i(k_x x + k_y y)) = -(k_x^2 + k_y^2) \\exp(i(k_x x + k_y y)) = -k^2 \\exp(i(k_x x + k_y y)) $$\nThe second-order central difference approximation to the Laplacian, $\\nabla_d^2$, at a grid node $(x_j, y_l) = (j\\Delta x, l\\Delta y)$ is:\n$$ \\nabla_d^2 u_{j,l} = \\frac{u_{j+1,l} - 2u_{j,l} + u_{j-1,l}}{\\Delta x^2} + \\frac{u_{j,l+1} - 2u_{j,l} + u_{j,l-1}}{\\Delta y^2} $$\nWe analyze the action of this discrete operator on the plane-wave mode evaluated at the grid nodes, $u_{j,l} = \\exp(i(k_x j \\Delta x + k_y l \\Delta y))$. For the term corresponding to the $x$-direction:\n$$ \\frac{\\exp(i(k_x(j+1)\\Delta x + k_y l\\Delta y)) - 2\\exp(i(k_x j\\Delta x + k_y l\\Delta y)) + \\exp(i(k_x(j-1)\\Delta x + k_y l\\Delta y))}{\\Delta x^2} $$\nFactoring out $u_{j,l}$ from the numerator gives:\n$$ \\frac{u_{j,l} \\left( \\exp(i k_x \\Delta x) - 2 + \\exp(-i k_x \\Delta x) \\right)}{\\Delta x^2} = -\\frac{4\\sin^2(\\frac{1}{2} k_x \\Delta x)}{\\Delta x^2} u_{j,l} $$\nwhere we have used the identities $\\exp(i\\phi) + \\exp(-i\\phi) = 2\\cos(\\phi)$ and $2(1-\\cos\\phi)=4\\sin^2(\\phi/2)$. A similar expression holds for the $y$-direction. Summing the two contributions, the action of the discrete Laplacian is:\n$$ \\nabla_d^2 u_{j,l} = -\\left[ \\frac{4\\sin^2(\\frac{1}{2} k_x \\Delta x)}{\\Delta x^2} + \\frac{4\\sin^2(\\frac{1}{2} k_y \\Delta y)}{\\Delta y^2} \\right] u_{j,l} $$\nBy definition, the term in the brackets is the modified wavenumber squared, $\\tilde{k}^2(\\theta)$.\n$$ \\tilde{k}^2(\\theta) = \\frac{4\\sin^2(\\frac{1}{2} k_x \\Delta x)}{\\Delta x^2} + \\frac{4\\sin^2(\\frac{1}{2} k_y \\Delta y)}{\\Delta y^2} $$\nTo express this in the specified variables, we use the given relations: $k_x = k \\cos\\theta$, $k_y = k \\sin\\theta$, $\\alpha = \\Delta x / \\Delta y$, and $\\eta = k \\Delta y$. From these, we have $\\Delta x = \\alpha \\Delta y$ and $k = \\eta / \\Delta y$. The arguments of the sine functions become:\n$$ \\frac{1}{2} k_x \\Delta x = \\frac{1}{2} (k \\cos\\theta) (\\alpha \\Delta y) = \\frac{1}{2} \\left(\\frac{\\eta}{\\Delta y}\\right) \\cos\\theta \\alpha \\Delta y = \\frac{1}{2} \\eta \\alpha \\cos\\theta $$\n$$ \\frac{1}{2} k_y \\Delta y = \\frac{1}{2} (k \\sin\\theta) \\Delta y = \\frac{1}{2} \\left(\\frac{\\eta}{\\Delta y}\\right) \\sin\\theta \\Delta y = \\frac{1}{2} \\eta \\sin\\theta $$\nSubstituting these into the expression for $\\tilde{k}^2(\\theta)$:\n$$ \\tilde{k}^2(\\theta) = \\frac{4\\sin^2(\\frac{1}{2}\\eta \\alpha \\cos\\theta)}{\\alpha^2 \\Delta y^2} + \\frac{4\\sin^2(\\frac{1}{2}\\eta \\sin\\theta)}{\\Delta y^2} $$\nThe normalized discrete dissipation factor is $R(\\theta) = \\tilde{k}^2(\\theta) / k^2$. Using $k^2 = \\eta^2 / \\Delta y^2$:\n$$ R(\\theta) = \\frac{\\Delta y^2}{\\eta^2} \\left[ \\frac{4\\sin^2(\\frac{1}{2}\\eta \\alpha \\cos\\theta)}{\\alpha^2 \\Delta y^2} + \\frac{4\\sin^2(\\frac{1}{2}\\eta \\sin\\theta)}{\\Delta y^2} \\right] $$\n$$ R(\\theta) = \\frac{4}{\\eta^2} \\left[ \\frac{\\sin^2(\\frac{1}{2}\\eta \\alpha \\cos\\theta)}{\\alpha^2} + \\sin^2(\\frac{1}{2}\\eta \\sin\\theta) \\right] $$\nThis is the exact expression for $R(\\theta)$, completing the first part of the problem.\n\nSecond, we analyze the case where $\\eta \\ll 1$. This implies that the arguments of the sine functions are small. We use the Taylor series expansion for $\\sin^2(z)$ around $z=0$: $\\sin^2(z) = (z - \\frac{z^3}{6} + \\mathcal{O}(z^5))^2 = z^2 - \\frac{z^4}{3} + \\mathcal{O}(z^6)$. We expand to this order to find the leading non-trivial term of $R(\\theta)$.\nLet $z_x=\\frac{1}{2}\\eta \\alpha \\cos\\theta$ and $z_y=\\frac{1}{2}\\eta \\sin\\theta$.\nThe term $\\frac{\\sin^2(z_x)}{\\alpha^2}$ becomes:\n$$ \\frac{1}{\\alpha^2} \\left[ z_x^2 - \\frac{z_x^4}{3} + \\mathcal{O}(\\eta^6) \\right] = \\frac{1}{\\alpha^2} \\left[ \\frac{\\eta^2 \\alpha^2 \\cos^2\\theta}{4} - \\frac{\\eta^4 \\alpha^4 \\cos^4\\theta}{48} + \\mathcal{O}(\\eta^6) \\right] = \\frac{\\eta^2 \\cos^2\\theta}{4} - \\frac{\\eta^4 \\alpha^2 \\cos^4\\theta}{48} + \\mathcal{O}(\\eta^6) $$\nThe term $\\sin^2(z_y)$ becomes:\n$$ z_y^2 - \\frac{z_y^4}{3} + \\mathcal{O}(\\eta^6) = \\frac{\\eta^2 \\sin^2\\theta}{4} - \\frac{\\eta^4 \\sin^4\\theta}{48} + \\mathcal{O}(\\eta^6) $$\nSubstituting these back into the expression for $R(\\theta)$:\n$$ R(\\theta) = \\frac{4}{\\eta^2} \\left[ \\left(\\frac{\\eta^2 \\cos^2\\theta}{4} - \\frac{\\eta^4 \\alpha^2 \\cos^4\\theta}{48}\\right) + \\left(\\frac{\\eta^2 \\sin^2\\theta}{4} - \\frac{\\eta^4 \\sin^4\\theta}{48}\\right) + \\mathcal{O}(\\eta^6) \\right] $$\n$$ R(\\theta) = \\frac{4}{\\eta^2} \\left[ \\frac{\\eta^2}{4}(\\cos^2\\theta + \\sin^2\\theta) - \\frac{\\eta^4}{48}(\\alpha^2 \\cos^4\\theta + \\sin^4\\theta) + \\mathcal{O}(\\eta^6) \\right] $$\nUsing $\\cos^2\\theta + \\sin^2\\theta = 1$, we find the expansion for $R(\\theta)$:\n$$ R(\\theta) = 1 - \\frac{\\eta^2}{12}(\\alpha^2 \\cos^4\\theta + \\sin^4\\theta) + \\mathcal{O}(\\eta^4) $$\nNow, we evaluate this expression at $\\theta=0$ (streamwise mode) and $\\theta=\\pi/2$ (wall-normal mode).\nFor $\\theta=0$: $\\cos(0)=1$, $\\sin(0)=0$.\n$$ R(0) = 1 - \\frac{\\eta^2}{12}(\\alpha^2 \\cdot 1^4 + 0^4) + \\mathcal{O}(\\eta^4) = 1 - \\frac{\\alpha^2 \\eta^2}{12} + \\mathcal{O}(\\eta^4) $$\nFor $\\theta=\\pi/2$: $\\cos(\\pi/2)=0$, $\\sin(\\pi/2)=1$.\n$$ R(\\pi/2) = 1 - \\frac{\\eta^2}{12}(\\alpha^2 \\cdot 0^4 + 1^4) + \\mathcal{O}(\\eta^4) = 1 - \\frac{\\eta^2}{12} + \\mathcal{O}(\\eta^4) $$\nThe leading-order difference is:\n$$ R(0) - R(\\pi/2) = \\left(1 - \\frac{\\alpha^2 \\eta^2}{12}\\right) - \\left(1 - \\frac{\\eta^2}{12}\\right) = \\frac{\\eta^2}{12}(1 - \\alpha^2) $$\nThe problem asks for the absolute difference $|R(0) - R(\\pi/2)|$. Since the grid is stretched, $\\alpha \\ge 1$, which implies $1 - \\alpha^2 \\le 0$. Thus:\n$$ |R(0) - R(\\pi/2)| = \\left| \\frac{\\eta^2}{12}(1 - \\alpha^2) \\right| = \\frac{\\eta^2}{12}(\\alpha^2 - 1) $$\nThis completes the second part of the problem.\n\nThird, we formulate the grid design criterion. The anisotropic dissipation is to be bounded by a tolerance $\\epsilon$:\n$$ |R(0) - R(\\pi/2)| \\le \\epsilon $$\nSubstituting the derived leading-order expression for the difference:\n$$ \\frac{\\eta^2}{12}(\\alpha^2 - 1) \\le \\epsilon $$\nWe solve this inequality for the aspect ratio $\\alpha$. Since $\\alpha \\ge 1$ and $\\eta > 0$, we can rearrange the terms:\n$$ \\alpha^2 - 1 \\le \\frac{12\\epsilon}{\\eta^2} $$\n$$ \\alpha^2 \\le 1 + \\frac{12\\epsilon}{\\eta^2} $$\nSince $\\alpha$ must be positive, we can take the positive square root of both sides:\n$$ \\alpha \\le \\sqrt{1 + \\frac{12\\epsilon}{\\eta^2}} $$\nThe maximum allowable aspect ratio, $\\alpha_{\\max}$, is the upper bound of this inequality.\n$$ \\alpha_{\\max}(\\epsilon, \\eta) = \\sqrt{1 + \\frac{12\\epsilon}{\\eta^2}} $$\nThis expression provides the required grid design criterion, completing the final part of the problem.",
            "answer": "$$\\boxed{\\sqrt{1 + \\frac{12\\epsilon}{\\eta^2}}}$$"
        }
    ]
}