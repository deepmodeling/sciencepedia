{
    "hands_on_practices": [
        {
            "introduction": "Understanding the Total Variation Diminishing (TVD) property begins with its definition and the behavior of the simplest numerical schemes. Total Variation (TV) provides a discrete measure of the total oscillation in a solution profile. This foundational exercise invites you to compute the change in TV for the first-order upwind scheme, a method known for being non-oscillatory, when it is applied to a sharp discontinuity. Through direct calculation, you will see how this robust but dissipative scheme affects the total variation, establishing a baseline for the TVD concept.",
            "id": "4001350",
            "problem": "Consider one-dimensional linear advection of a passive scalar field $u(x,t)$ representative of a convected mixture fraction in a simplified aerospace nozzle duct, modeled by the scalar conservation law $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a  0$. A uniform grid with spacing $\\Delta x$ is used, and the field is represented by cell averages $\\{u_{i}^{n}\\}$ at time level $t^{n}$. The time step is $\\Delta t$, and the nondimensional Courant–Friedrichs–Lewy (CFL) number is $\\nu = a\\,\\Delta t / \\Delta x$ satisfying $0  \\nu  1$. The update from $t^{n}$ to $t^{n+1}$ is performed by the first-order upwind scheme for $a0$:\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\nu\\left(u_{i}^{n} - u_{i-1}^{n}\\right).\n$$\nAssume a periodic computational domain and a piecewise constant initial state with a single jump aligned with a cell interface at index $j$, defined by $u_{i}^{n} = U_{L}$ for all $i \\leq j$ and $u_{i}^{n} = U_{R}$ for all $i \\geq j+1$, where $U_{L}$ and $U_{R}$ are constants with $U_{L} \\neq U_{R}$. The discrete total variation at time level $t^{n}$ is defined by\n$$\nTV^{n} = \\sum_{i} \\left|u_{i+1}^{n} - u_{i}^{n}\\right|.\n$$\nUsing only the stated definitions and data, compute $TV^{n}$ and $TV^{n+1}$, and then determine the change in total variation\n$$\n\\Delta TV = TV^{n+1} - TV^{n}.\n$$\nBased on your calculation, infer whether the first-order upwind step keeps $TV$ unchanged, reduces it, or increases it, but report only the value of $\\Delta TV$. Express your final answer as a dimensionless quantity. No rounding is required.",
            "solution": "The problem is validated as self-contained, consistent, and scientifically sound. We proceed to solve it.\n\nThe objective is to compute the change in total variation, $\\Delta TV = TV^{n+1} - TV^{n}$, for the first-order upwind scheme applied to a one-dimensional linear advection problem with a specified piecewise constant initial condition.\n\nFirst, we compute the total variation at the initial time level $t^{n}$, denoted as $TV^{n}$. The discrete total variation is defined as:\n$$\nTV^{n} = \\sum_{i} \\left|u_{i+1}^{n} - u_{i}^{n}\\right|\n$$\nThe initial state is given by $u_{i}^{n} = U_{L}$ for all $i \\leq j$ and $u_{i}^{n} = U_{R}$ for all $i \\geq j+1$, where $U_{L}$ and $U_{R}$ are constants and $U_{L} \\neq U_{R}$. We examine the difference terms $|u_{i+1}^{n} - u_{i}^{n}|$ in the sum:\n- For any index $i  j$, both $u_{i+1}^{n}$ and $u_{i}^{n}$ are equal to $U_{L}$. The difference is $|U_{L} - U_{L}| = 0$.\n- For the index $i = j$, the difference is $|u_{j+1}^{n} - u_{j}^{n}| = |U_{R} - U_{L}|$.\n- For any index $i  j$, both $u_{i+1}^{n}$ and $u_{i}^{n}$ are equal to $U_{R}$. The difference is $|U_{R} - U_{R}| = 0$.\n\nTherefore, the summation contains only one non-zero term, which occurs at the discontinuity. The total variation at time $t^{n}$ is:\n$$\nTV^{n} = |U_{R} - U_{L}|\n$$\n\nNext, we calculate the state of the field at the next time level, $t^{n+1}$. The first-order upwind scheme for $a  0$ is given by:\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\nu\\left(u_{i}^{n} - u_{i-1}^{n}\\right)\n$$\nwhere $\\nu = a\\,\\Delta t / \\Delta x$ is the CFL number, satisfying $0  \\nu  1$. We apply this scheme to the initial state $u_{i}^{n}$ for all grid indices $i$:\n- For any index $i \\leq j$: We have $u_{i}^{n} = U_{L}$ and $u_{i-1}^{n} = U_{L}$.\n  $$\n  u_{i}^{n+1} = U_{L} - \\nu(U_{L} - U_{L}) = U_{L}\n  $$\n- For the index $i = j+1$: We have $u_{j+1}^{n} = U_{R}$ and $u_{j}^{n} = U_{L}$.\n  $$\n  u_{j+1}^{n+1} = U_{R} - \\nu(U_{R} - U_{L}) = (1-\\nu)U_{R} + \\nu U_{L}\n  $$\n- For any index $i \\geq j+2$: We have $u_{i}^{n} = U_{R}$ and $u_{i-1}^{n} = U_{R}$.\n  $$\n  u_{i}^{n+1} = U_{R} - \\nu(U_{R} - U_{R}) = U_{R}\n  $$\n\nSo, the field at time $t^{n+1}$ is:\n- $u_{i}^{n+1} = U_{L}$ for $i \\leq j$.\n- $u_{j+1}^{n+1} = (1-\\nu)U_{R} + \\nu U_{L}$.\n- $u_{i}^{n+1} = U_{R}$ for $i \\geq j+2$.\nThe original sharp jump has been smeared over the cell at index $j+1$.\n\nNow, we compute the total variation at time level $t^{n+1}$, which is $TV^{n+1} = \\sum_{i} |u_{i+1}^{n+1} - u_{i}^{n+1}|$. We examine the difference terms:\n- For any index $i  j$, the difference is $|u_{i+1}^{n+1} - u_{i}^{n+1}| = |U_{L} - U_{L}| = 0$.\n- For the index $i = j$, the difference is:\n  $$\n  |u_{j+1}^{n+1} - u_{j}^{n+1}| = |((1-\\nu)U_{R} + \\nu U_{L}) - U_{L}| = |(1-\\nu)U_{R} - (1-\\nu)U_{L}| = |(1-\\nu)(U_{R} - U_{L})|\n  $$\n  Since $0  \\nu  1$, the term $(1-\\nu)$ is positive. Thus, this difference is $(1-\\nu)|U_{R} - U_{L}|$.\n- For the index $i = j+1$, the difference is:\n  $$\n  |u_{j+2}^{n+1} - u_{j+1}^{n+1}| = |U_{R} - ((1-\\nu)U_{R} + \\nu U_{L})| = |\\nu U_{R} - \\nu U_{L}| = |\\nu(U_{R} - U_{L})|\n  $$\n  Since $\\nu  0$, this difference is $\\nu|U_{R} - U_{L}|$.\n- For any index $i  j+1$, the difference is $|u_{i+1}^{n+1} - u_{i}^{n+1}| = |U_{R} - U_{R}| = 0$.\n\nThe sum for $TV^{n+1}$ consists of only two non-zero terms:\n$$\nTV^{n+1} = (1-\\nu)|U_{R} - U_{L}| + \\nu|U_{R} - U_{L}|\n$$\nFactoring out the common term $|U_{R} - U_{L}|$:\n$$\nTV^{n+1} = ((1-\\nu) + \\nu)|U_{R} - U_{L}| = (1)|U_{R} - U_{L}| = |U_{R} - U_{L}|\n$$\n\nFinally, we compute the change in total variation, $\\Delta TV$:\n$$\n\\Delta TV = TV^{n+1} - TV^{n} = |U_{R} - U_{L}| - |U_{R} - U_{L}| = 0\n$$\nThe calculation shows that for a single step function initial condition, the total variation is exactly conserved by the first-order upwind scheme. This indicates that while the scheme is dissipative (it smears the sharp front), it does so in a way that is non-increasing in total variation, and for this specific monotonic profile, the total variation remains unchanged. The problem statement notes that the scalar field represents a mixture fraction, a quantity that is itself dimensionless. Thus, $U_{L}$, $U_{R}$, and consequently $\\Delta TV$ are dimensionless.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "While the first-order upwind scheme is guaranteed not to introduce new oscillations, its high level of numerical diffusion smears sharp features, making it impractical for many aerospace applications. A natural step is to use higher-order methods like the Lax-Wendroff scheme, but this introduces a new challenge. This exercise demonstrates the critical flaw of simple second-order schemes: their dispersive nature can generate spurious oscillations near discontinuities, leading to an increase in total variation. By analytically calculating this increase, you will gain a concrete understanding of why TVD frameworks are essential for developing high-resolution, oscillation-free methods.",
            "id": "4001392",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a  0$ on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$. Define the Courant–Friedrichs–Lewy (CFL) number $\\nu = a\\,\\Delta t / \\Delta x$, and assume $0  \\nu  1$. Let the numerical method be the classical Lax–Wendroff scheme\n$$\nu^{n+1}_{j} = u^{n}_{j} - \\frac{\\nu}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\frac{\\nu^{2}}{2}\\left(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\right).\n$$\nInitialize the solution with a step (Riemann-type) data:\n$$\nu(x,0) = \\begin{cases}\nu_{L},  x  0, \\\\\nu_{R},  x  0,\n\\end{cases}\n$$\ndiscretized as $u^{0}_{j} = u_{L}$ for $j \\leq 0$ and $u^{0}_{j} = u_{R}$ for $j \\geq 1$, with jump $\\Delta u = u_{R} - u_{L} \\neq 0$. Define the total variation at time level $n$ by\n$$\n\\mathrm{TV}^{n} = \\sum_{j \\in \\mathbb{Z}} \\left|u^{n}_{j+1} - u^{n}_{j}\\right|.\n$$\nStarting from the governing partial differential equation and the definition of the numerical method, derive the modified equation (also called the backward error or consistency expansion) that the Lax–Wendroff scheme satisfies to leading nonvanishing order beyond the original equation, and identify the lowest-order dispersive correction proportional to $u_{xxx}$. Then, using only the scheme and the given initial data, compute the exact one-step values $u^{1}_{j}$ and determine $\\mathrm{TV}^{1}$ and $\\mathrm{TV}^{0}$. Finally, provide the exact analytic expression for the increase in total variation after one time step,\n$$\n\\Delta \\mathrm{TV} = \\mathrm{TV}^{1} - \\mathrm{TV}^{0},\n$$\nexpressed in terms of the CFL number $\\nu$ and the magnitude of the jump $\\left|\\Delta u\\right|$. No rounding is required. The final answer must be a single closed-form expression.",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Governing Equation**: One-dimensional linear advection equation, $u_{t} + a\\,u_{x} = 0$, with constant advection speed $a  0$.\n- **Discretization**: Uniform grid with spacing $\\Delta x$ and time step $\\Delta t$.\n- **Definitions**:\n    - Courant–Friedrichs–Lewy (CFL) number: $\\nu = a\\,\\Delta t / \\Delta x$.\n    - Total variation at time level $n$: $\\mathrm{TV}^{n} = \\sum_{j \\in \\mathbb{Z}} \\left|u^{n}_{j+1} - u^{n}_{j}\\right|$.\n    - Jump in initial data: $\\Delta u = u_{R} - u_{L} \\neq 0$.\n- **Numerical Scheme**: Lax–Wendroff scheme, $u^{n+1}_{j} = u^{n}_{j} - \\frac{\\nu}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\frac{\\nu^{2}}{2}\\left(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\right)$.\n- **Initial Condition**: Step function (Riemann problem), $u(x,0) = \\begin{cases} u_{L},  x  0 \\\\ u_{R},  x  0 \\end{cases}$, discretized as $u^{0}_{j} = u_{L}$ for $j \\leq 0$ and $u^{0}_{j} = u_{R}$ for $j \\geq 1$.\n- **Constraints**: $a  0$ and $0  \\nu  1$.\n- **Tasks**:\n    1. Derive the modified equation for the Lax–Wendroff scheme to leading nonvanishing order, identifying the term proportional to $u_{xxx}$.\n    2. Compute the one-step values $u^{1}_{j}$.\n    3. Determine $\\mathrm{TV}^{1}$ and $\\mathrm{TV}^{0}$.\n    4. Provide the exact analytic expression for the increase in total variation $\\Delta \\mathrm{TV} = \\mathrm{TV}^{1} - \\mathrm{TV}^{0}$ in terms of $\\nu$ and $|\\Delta u|$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem is based on fundamental concepts in numerical analysis for partial differential equations, specifically the analysis of the Lax–Wendroff scheme for the linear advection equation. These are standard topics in computational fluid dynamics and applied mathematics.\n- **Well-Posed**: The problem is clearly defined with all necessary information. The tasks are specific and lead to a unique, analytical solution. The constraints on $\\nu$ ensure the stability of the scheme.\n- **Objective**: The problem is stated using precise mathematical language and definitions. There are no subjective or ambiguous elements.\n\nThe problem is self-contained, consistent, and scientifically sound. It does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n***\n\nThe solution proceeds in three parts as requested: derivation of the modified equation, calculation of the solution after one time step and the associated total variation, and finally, the change in total variation.\n\n**Part 1: Modified Equation**\n\nTo derive the modified equation, we perform a Taylor series expansion of each term in the Lax–Wendroff scheme around the point $(x_j, t_n)$, where $x_j = j\\Delta x$ and $t_n = n\\Delta t$. Let $u \\equiv u(x_j, t_n)$.\n\nThe terms in the scheme are expanded as follows:\n$$\nu^{n+1}_{j} = u + \\Delta t u_t + \\frac{\\Delta t^2}{2} u_{tt} + \\frac{\\Delta t^3}{6} u_{ttt} + O(\\Delta t^4)\n$$\n$$\nu^{n}_{j \\pm 1} = u \\pm \\Delta x u_x + \\frac{\\Delta x^2}{2} u_{xx} \\pm \\frac{\\Delta x^3}{6} u_{xxx} + \\frac{\\Delta x^4}{24} u_{xxxx} + O(\\Delta x^5)\n$$\nFrom these, we form the finite difference operators:\n$$\nu^{n}_{j+1} - u^{n}_{j-1} = 2\\Delta x u_x + \\frac{\\Delta x^3}{3} u_{xxx} + O(\\Delta x^5)\n$$\n$$\nu^{n}_{j+1} - 2u^{n}_{j} + u^{n}_{j-1} = \\Delta x^2 u_{xx} + \\frac{\\Delta x^4}{12} u_{xxxx} + O(\\Delta x^6)\n$$\nSubstituting these into the Lax–Wendroff scheme:\n$$\nu^{n+1}_{j} - u^{n}_{j} = -\\frac{\\nu}{2}\\left(2\\Delta x u_x + \\frac{\\Delta x^3}{3} u_{xxx}\\right) + \\frac{\\nu^2}{2}\\left(\\Delta x^2 u_{xx} + \\frac{\\Delta x^4}{12} u_{xxxx}\\right) + \\dots\n$$\nDividing by $\\Delta t$ and substituting $\\nu = a \\Delta t / \\Delta x$:\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\Delta t} = -\\frac{a \\Delta t}{2\\Delta x \\Delta t}\\left(2\\Delta x u_x + \\dots\\right) + \\frac{a^2 \\Delta t^2}{2\\Delta x^2 \\Delta t}\\left(\\Delta x^2 u_{xx} + \\dots\\right)\n$$\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\Delta t} = -a u_x - \\frac{a \\Delta x^2}{6}u_{xxx} + \\frac{a^2 \\Delta t}{2}u_{xx} + \\dots\n$$\nThe left side is the forward difference in time, which is expanded as:\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\Delta t} = u_t + \\frac{\\Delta t}{2} u_{tt} + \\frac{\\Delta t^2}{6} u_{ttt} + O(\\Delta t^3)\n$$\nEquating the two expressions gives the truncation error:\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + \\frac{\\Delta t^2}{6} u_{ttt} + \\dots = -a u_x + \\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{a \\Delta x^2}{6}u_{xxx} + \\dots\n$$\nRearranging to match the form of the original PDE:\n$$\nu_t + a u_x = -\\frac{\\Delta t}{2} u_{tt} + \\frac{a^2 \\Delta t}{2} u_{xx} - \\frac{a \\Delta x^2}{6} u_{xxx} - \\frac{\\Delta t^2}{6} u_{ttt} + \\dots\n$$\nFor the modified equation, we recursively substitute time derivatives with spatial derivatives using the PDE itself. From $u_t = -a u_x$, we have $u_{tt} = \\partial_t(-a u_x) = -a (\\partial_t u)_x = -a(-a u_x)_x = a^2 u_{xx}$, and $u_{ttt} = \\partial_t(a^2 u_{xx}) = a^2 (\\partial_t u)_{xx} = a^2(-a u_x)_{xx} = -a^3 u_{xxx}$.\nSubstituting these into the rearranged equation:\n$$\nu_t + a u_x = -\\frac{\\Delta t}{2} (a^2 u_{xx}) + \\frac{a^2 \\Delta t}{2} u_{xx} - \\frac{a \\Delta x^2}{6} u_{xxx} + \\frac{\\Delta t^2}{6} (a^3 u_{xxx}) + \\dots\n$$\nThe second-order derivative terms cancel, confirming the scheme is second-order accurate.\n$$\nu_t + a u_x = \\left(\\frac{a^3 \\Delta t^2}{6} - \\frac{a \\Delta x^2}{6}\\right) u_{xxx} + \\dots\n$$\nThe leading nonvanishing error term is the dispersive term. We express its coefficient in terms of $\\nu$ by substituting $\\Delta t = \\nu \\Delta x / a$:\n$$\n\\frac{a^3}{6}\\left(\\frac{\\nu \\Delta x}{a}\\right)^2 - \\frac{a \\Delta x^2}{6} = \\frac{a^3 \\nu^2 \\Delta x^2}{6 a^2} - \\frac{a \\Delta x^2}{6} = \\frac{a \\nu^2 \\Delta x^2}{6} - \\frac{a \\Delta x^2}{6} = \\frac{a \\Delta x^2}{6} (\\nu^2 - 1)\n$$\nThe modified equation to leading order is:\n$$\nu_t + a u_x = \\frac{a \\Delta x^2}{6}(\\nu^2 - 1) u_{xxx}\n$$\nThe lowest-order dispersive correction is the term $\\frac{a \\Delta x^2}{6}(\\nu^2 - 1) u_{xxx}$.\n\n**Part 2: Total Variation Calculation**\n\nFirst, we calculate the total variation at the initial time, $t=0$ (or $n=0$).\nThe initial data is $u^{0}_{j} = u_{L}$ for $j \\leq 0$ and $u^{0}_{j} = u_{R}$ for $j \\geq 1$.\nThe total variation is $\\mathrm{TV}^{0} = \\sum_{j} |u^{0}_{j+1} - u^{0}_{j}|$. The only non-zero difference occurs at $j=0$.\n$$\n\\mathrm{TV}^{0} = |u^{0}_{1} - u^{0}_{0}| = |u_{R} - u_{L}| = |\\Delta u|\n$$\nNext, we compute the solution at the next time step, $u^{1}_{j}$, by applying the Lax-Wendroff scheme to the initial data $u^0_j$.\n- For $j \\leq -1$: The stencil points $(j-1, j, j+1)$ are all in the region where $u^0=u_L$. Thus, $u^{0}_{j-1} = u^{0}_{j} = u^{0}_{j+1} = u_L$. The scheme yields $u^{1}_{j} = u_L$.\n- For $j \\geq 2$: The stencil points are all in the region where $u^0=u_R$. Thus, $u^{0}_{j-1} = u^{0}_{j} = u^{0}_{j+1} = u_R$. The scheme yields $u^{1}_{j} = u_R$.\n- For $j=0$: The stencil values are $u^{0}_{-1} = u_L$, $u^{0}_{0} = u_L$, $u^{0}_{1} = u_R$.\n$$\nu^{1}_{0} = u^{0}_{0} - \\frac{\\nu}{2}(u^{0}_{1} - u^{0}_{-1}) + \\frac{\\nu^2}{2}(u^{0}_{1} - 2u^{0}_{0} + u^{0}_{-1})\n$$\n$$\nu^{1}_{0} = u_L - \\frac{\\nu}{2}(u_R - u_L) + \\frac{\\nu^2}{2}(u_R - 2u_L + u_L) = u_L - \\frac{\\nu}{2}\\Delta u + \\frac{\\nu^2}{2}(u_R - u_L) = u_L + \\Delta u \\left(\\frac{\\nu^2-\\nu}{2}\\right)\n$$\n- For $j=1$: The stencil values are $u^{0}_{0} = u_L$, $u^{0}_{1} = u_R$, $u^{0}_{2} = u_R$.\n$$\nu^{1}_{1} = u^{0}_{1} - \\frac{\\nu}{2}(u^{0}_{2} - u^{0}_{0}) + \\frac{\\nu^2}{2}(u^{0}_{2} - 2u^{0}_{1} + u^{0}_{0})\n$$\n$$\nu^{1}_{1} = u_R - \\frac{\\nu}{2}(u_R - u_L) + \\frac{\\nu^2}{2}(u_R - 2u_R + u_L) = u_R - \\frac{\\nu}{2}\\Delta u + \\frac{\\nu^2}{2}(u_L - u_R) = u_R - \\Delta u \\left(\\frac{\\nu+\\nu^2}{2}\\right)\n$$\nThe solution at $n=1$ is non-trivial only at $j=0$ and $j=1$. We now compute $\\mathrm{TV}^{1} = \\sum_{j} |u^{1}_{j+1} - u^{1}_{j}|$. The non-zero differences are at $j=-1, 0, 1$.\n- For $j=-1$: $u^{1}_{0} - u^{1}_{-1} = \\left(u_L + \\Delta u \\frac{\\nu^2-\\nu}{2}\\right) - u_L = \\Delta u \\frac{\\nu(\\nu-1)}{2}$.\n- For $j=0$: $u^{1}_{1} - u^{1}_{0} = \\left(u_R - \\Delta u \\frac{\\nu+\\nu^2}{2}\\right) - \\left(u_L + \\Delta u \\frac{\\nu^2-\\nu}{2}\\right) = (u_R-u_L) - \\Delta u \\left(\\frac{\\nu+\\nu^2}{2} + \\frac{\\nu^2-\\nu}{2}\\right) = \\Delta u - \\Delta u\\left(\\frac{2\\nu^2}{2}\\right) = \\Delta u (1-\\nu^2)$.\n- For $j=1$: $u^{1}_{2} - u^{1}_{1} = u_R - \\left(u_R - \\Delta u \\frac{\\nu+\\nu^2}{2}\\right) = \\Delta u \\frac{\\nu(\\nu+1)}{2}$.\n\nWe take the absolute values and sum them. Since $0  \\nu  1$, we have $\\nu-1  0$, $1-\\nu^2  0$, and $\\nu+1  0$.\n$$\n|u^{1}_{0} - u^{1}_{-1}| = \\left|\\Delta u \\frac{\\nu(\\nu-1)}{2}\\right| = |\\Delta u| \\frac{\\nu(1-\\nu)}{2}\n$$\n$$\n|u^{1}_{1} - u^{1}_{0}| = |\\Delta u (1-\\nu^2)| = |\\Delta u| (1-\\nu^2)\n$$\n$$\n|u^{1}_{2} - u^{1}_{1}| = \\left|\\Delta u \\frac{\\nu(\\nu+1)}{2}\\right| = |\\Delta u| \\frac{\\nu(1+\\nu)}{2}\n$$\nSumming these contributions to find $\\mathrm{TV}^1$:\n$$\n\\mathrm{TV}^{1} = |\\Delta u| \\left( \\frac{\\nu(1-\\nu)}{2} + (1-\\nu^2) + \\frac{\\nu(1+\\nu)}{2} \\right)\n$$\n$$\n\\mathrm{TV}^{1} = |\\Delta u| \\left( \\frac{\\nu-\\nu^2}{2} + 1-\\nu^2 + \\frac{\\nu+\\nu^2}{2} \\right)\n$$\n$$\n\\mathrm{TV}^{1} = |\\Delta u| \\left( \\frac{2\\nu}{2} + 1 - \\nu^2 \\right) = |\\Delta u| (1 + \\nu - \\nu^2)\n$$\n\n**Part 3: Change in Total Variation**\n\nThe increase in total variation is $\\Delta \\mathrm{TV} = \\mathrm{TV}^{1} - \\mathrm{TV}^{0}$.\n$$\n\\Delta \\mathrm{TV} = |\\Delta u| (1 + \\nu - \\nu^2) - |\\Delta u|\n$$\n$$\n\\Delta \\mathrm{TV} = |\\Delta u| (1 + \\nu - \\nu^2 - 1)\n$$\n$$\n\\Delta \\mathrm{TV} = |\\Delta u| (\\nu - \\nu^2) = |\\Delta u| \\nu (1 - \\nu)\n$$\nThis result is positive for $0  \\nu  1$, indicating that the Lax–Wendroff scheme is not total variation diminishing (TVD) for this problem, as it generates spurious oscillations that increase the total variation of the solution.",
            "answer": "$$\\boxed{\\nu(1-\\nu)|\\Delta u|}$$"
        },
        {
            "introduction": "The previous practices established a core dilemma: first-order schemes are non-oscillatory but too diffusive, while classical second-order schemes are accurate but oscillatory. The solution lies in high-resolution TVD schemes, which intelligently blend low- and high-order methods using flux limiters. This practice provides direct insight into the design of these limiters. You will derive the analytical form of a flux limiter based on a harmonic-mean prescription and then mathematically verify that it satisfies the stringent conditions required to guarantee the TVD property, locating it within the well-known Sweby diagram.",
            "id": "4001334",
            "problem": "Consider a one-dimensional scalar conservation law with smooth solution reconstruction in a Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) framework used in Computational Fluid Dynamics (CFD). In Total Variation Diminishing (TVD) formulations, the reconstructed slope in a cell is limited using a flux limiter function $\\phi(r)$, where the slope ratio $r$ is defined by $r = \\Delta^{-}/\\Delta^{+}$ with $\\Delta^{-}$ and $\\Delta^{+}$ denoting backward and forward one-sided differences of the conserved variable. A classical construction for a smooth, differentiable limiter prescribes that, when the one-sided slopes $\\Delta^{-}$ and $\\Delta^{+}$ have the same sign, the limited slope equals the harmonic mean of the two one-sided slopes; otherwise it vanishes. Specifically, the limited slope $s_{\\text{L}}$ is given by $s_{\\text{L}} = 2\\Big/\\Big(\\frac{1}{\\Delta^{+}} + \\frac{1}{\\Delta^{-}}\\Big)$ when $\\Delta^{-}\\Delta^{+}  0$, and $s_{\\text{L}} = 0$ otherwise. Define the flux limiter by setting $s_{\\text{L}} = \\phi(r)\\,\\Delta^{+}$.\n\nUsing this harmonic-mean prescription and the TVD requirement that reconstruction vanishes when the one-sided slopes differ in sign, derive the analytical form of the resulting limiter $\\phi(r)$ as a function of $r$ that is continuous on $\\mathbb{R}$, and then verify that it belongs to the TVD Sweby region by establishing each of the following properties:\n- $\\phi(r) = 0$ for $r \\leq 0$,\n- $0 \\leq \\phi(r) \\leq \\min\\{2r,\\,2\\}$ for $r \\geq 0$,\n- $\\phi(1) = 1$.\n\nFinally, to quantitatively locate this limiter relative to the TVD upper bound, define the vertical separation\n$$\\Delta(r) = \\min\\{2r,\\,2\\} - \\phi(r), \\quad r \\geq 0.$$\nDetermine the exact maximum value of $\\Delta(r)$ over $r \\geq 0$. Express your final answer as a dimensionless number. No rounding is required.",
            "solution": "The user has provided a valid problem statement grounded in the theory of Total Variation Diminishing (TVD) schemes for computational fluid dynamics. The problem is well-posed, objective, and contains sufficient information for a unique solution. We will proceed with the derivation and analysis as requested.\n\nThe problem asks for the derivation of a flux limiter function $\\phi(r)$, verification that it lies within the TVD region, and a subsequent optimization problem involving this function.\n\nFirst, we derive the analytical form of the flux limiter $\\phi(r)$.\nThe limited slope, $s_{\\text{L}}$, is related to the flux limiter $\\phi(r)$ by the definition:\n$$s_{\\text{L}} = \\phi(r)\\,\\Delta^{+}$$\nThe slope ratio $r$ is defined as $r = \\Delta^{-}/\\Delta^{+}$, which implies $\\Delta^{-} = r\\,\\Delta^{+}$.\n\nThe prescription for the limited slope $s_{\\text{L}}$ is given in two cases based on the sign of $\\Delta^{-}\\Delta^{+}$.\nThe condition $\\Delta^{-}\\Delta^{+}  0$ can be rewritten using the definition of $r$. Assuming $\\Delta^{+} \\neq 0$, we have $(r\\,\\Delta^{+})\\Delta^{+}  0$, which simplifies to $r\\,(\\Delta^{+})^2  0$. Since $(\\Delta^{+})^2  0$, this condition is equivalent to $r  0$.\nSimilarly, the condition $\\Delta^{-}\\Delta^{+} \\leq 0$ is equivalent to $r \\leq 0$.\n\nCase 1: $r  0$\nIn this case, the limited slope is the harmonic mean of $\\Delta^{-}$ and $\\Delta^{+}$:\n$$s_{\\text{L}} = \\frac{2}{\\frac{1}{\\Delta^{+}} + \\frac{1}{\\Delta^{-}}}$$\nSubstituting $s_{\\text{L}} = \\phi(r)\\,\\Delta^{+}$ and $\\Delta^{-} = r\\,\\Delta^{+}$ into this equation yields:\n$$\\phi(r)\\,\\Delta^{+} = \\frac{2}{\\frac{1}{\\Delta^{+}} + \\frac{1}{r\\,\\Delta^{+}}}$$\nWe can factor out $1/\\Delta^{+}$ from the denominator of the right-hand side:\n$$\\phi(r)\\,\\Delta^{+} = \\frac{2}{\\frac{1}{\\Delta^{+}}\\left(1 + \\frac{1}{r}\\right)} = \\frac{2\\Delta^{+}}{1 + \\frac{1}{r}}$$\nSimplifying the denominator gives $1 + \\frac{1}{r} = \\frac{r+1}{r}$:\n$$\\phi(r)\\,\\Delta^{+} = \\frac{2\\Delta^{+}}{\\frac{r+1}{r}} = \\frac{2r}{r+1}\\Delta^{+}$$\nAssuming $\\Delta^{+} \\neq 0$, we can divide by $\\Delta^{+}$ to find the expression for $\\phi(r)$:\n$$\\phi(r) = \\frac{2r}{r+1} \\quad \\text{for } r  0$$\n\nCase 2: $r \\leq 0$\nIn this case, the limited slope is prescribed to be zero: $s_{\\text{L}} = 0$.\nUsing the definition $s_{\\text{L}} = \\phi(r)\\,\\Delta^{+}$:\n$$\\phi(r)\\,\\Delta^{+} = 0$$\nAssuming $\\Delta^{+} \\neq 0$, we must have $\\phi(r) = 0$.\n$$\\phi(r) = 0 \\quad \\text{for } r \\leq 0$$\n\nCombining these two cases, we obtain the full definition of the limiter function, which is continuous on $\\mathbb{R}$:\n$$\n\\phi(r) = \\begin{cases}\n    \\frac{2r}{r+1}  \\text{if } r  0 \\\\\n    0  \\text{if } r \\leq 0\n\\end{cases}\n$$\n\nNext, we verify that this limiter belongs to the TVD Sweby region by checking the three specified properties.\n\nProperty 1: $\\phi(r) = 0$ for $r \\leq 0$.\nThis is true by the definition derived directly from the problem's prescription for the case $\\Delta^{-}\\Delta^{+} \\leq 0$.\n\nProperty 2: $0 \\leq \\phi(r) \\leq \\min\\{2r,\\,2\\}$ for $r \\geq 0$.\nFor $r=0$, $\\phi(0)=0$ and $\\min\\{2(0), 2\\}=0$, so $0 \\leq 0 \\leq 0$ holds.\nFor $r0$, we have $\\phi(r) = \\frac{2r}{r+1}$.\n-  First inequality: $0 \\leq \\phi(r)$. Since $r0$, both the numerator $2r$ and the denominator $r+1$ are positive, so $\\phi(r)  0$. This holds.\n-  Second inequality: $\\phi(r) \\leq 2r$. We must check if $\\frac{2r}{r+1} \\leq 2r$. Since $r0$, we can divide by $2r$ to get $\\frac{1}{r+1} \\leq 1$. As $r0$, $r+1  1$, so $\\frac{1}{r+1}  1$. This holds.\n-  Third inequality: $\\phi(r) \\leq 2$. We must check if $\\frac{2r}{r+1} \\leq 2$. Since $r+1  0$, we can multiply by $r+1$ to get $2r \\leq 2(r+1)$, which is $2r \\leq 2r+2$, or $0 \\leq 2$. This is always true.\nSince $\\phi(r)$ is less than or equal to both $2r$ and $2$, it must be less than or equal to their minimum. Thus, $0 \\leq \\phi(r) \\leq \\min\\{2r, 2\\}$ is verified for all $r \\geq 0$.\n\nProperty 3: $\\phi(1) = 1$.\nUsing the formula for $r  0$, we evaluate at $r=1$:\n$$\\phi(1) = \\frac{2(1)}{1+1} = \\frac{2}{2} = 1$$\nThis property is verified. This confirms that for equal upwind and downwind slopes, the scheme reduces to the second-order central difference slope, which is a desirable characteristic.\n\nFinally, we determine the maximum value of the vertical separation $\\Delta(r) = \\min\\{2r, 2\\} - \\phi(r)$ for $r \\geq 0$.\nThe function $\\min\\{2r, 2\\}$ has a piecewise definition depending on whether $r \\leq 1$ or $r  1$.\n- For $0 \\leq r \\leq 1$, we have $\\min\\{2r, 2\\} = 2r$.\n- For $r  1$, we have $\\min\\{2r, 2\\} = 2$.\n\nSo, we can write $\\Delta(r)$ as a piecewise function:\n$$\n\\Delta(r) = \\begin{cases}\n    2r - \\frac{2r}{r+1}  \\text{if } 0 \\leq r \\leq 1 \\\\\n    2 - \\frac{2r}{r+1}  \\text{if } r  1\n\\end{cases}\n$$\nLet's analyze each piece.\n\nFor $0 \\leq r \\leq 1$:\n$$\\Delta(r) = 2r - \\frac{2r}{r+1} = \\frac{2r(r+1) - 2r}{r+1} = \\frac{2r^2 + 2r - 2r}{r+1} = \\frac{2r^2}{r+1}$$\nTo find the maximum, we compute the derivative with respect to $r$:\n$$\\frac{d\\Delta}{dr} = \\frac{d}{dr}\\left(\\frac{2r^2}{r+1}\\right) = \\frac{(4r)(r+1) - (2r^2)(1)}{(r+1)^2} = \\frac{4r^2 + 4r - 2r^2}{(r+1)^2} = \\frac{2r^2+4r}{(r+1)^2} = \\frac{2r(r+2)}{(r+1)^2}$$\nFor $r \\in (0, 1]$, the terms $2r$, $r+2$, and $(r+1)^2$ are all positive. Therefore, $\\frac{d\\Delta}{dr}  0$ on $(0, 1]$. This means $\\Delta(r)$ is strictly increasing on the interval $[0, 1]$. The maximum value on this interval occurs at the right endpoint, $r=1$:\n$$\\Delta(1) = \\frac{2(1)^2}{1+1} = \\frac{2}{2} = 1$$\nAt the left endpoint, $\\Delta(0)=0$.\n\nFor $r  1$:\n$$\\Delta(r) = 2 - \\frac{2r}{r+1} = \\frac{2(r+1) - 2r}{r+1} = \\frac{2r + 2 - 2r}{r+1} = \\frac{2}{r+1}$$\nTo find the maximum, we compute the derivative:\n$$\\frac{d\\Delta}{dr} = \\frac{d}{dr}\\left(\\frac{2}{r+1}\\right) = -\\frac{2}{(r+1)^2}$$\nFor $r  1$, the derivative $\\frac{d\\Delta}{dr}$ is always negative. This means $\\Delta(r)$ is strictly decreasing on the interval $(1, \\infty)$. The values of $\\Delta(r)$ on this interval are always less than the value at $r=1$. The supremum on this open interval is approached as $r \\to 1^{+}$, which is $\\lim_{r\\to 1^{+}}\\frac{2}{r+1} = \\frac{2}{2} = 1$.\n\nCombining the analysis of both intervals, we see that $\\Delta(r)$ increases from $0$ to $1$ on $[0,1]$ and then decreases from $1$ towards $0$ on $(1, \\infty)$. The global maximum value of $\\Delta(r)$ is therefore attained at $r=1$.\nThe maximum value is $\\Delta(1)=1$.",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}