{
    "hands_on_practices": [
        {
            "introduction": "The process of formulating a weak variational form from a strong partial differential equation via integration by parts is fundamental to finite element methods. This process naturally gives rise to boundary integrals, which are not just mathematical artifacts but have profound physical meaning. This exercise  demystifies these terms by connecting them directly to the physical traction forces in an incompressible Stokes flow, a model crucial for low-speed aerodynamics. By working through this problem, you will see how externally applied pressures and stresses are incorporated as 'natural' boundary conditions within the variational framework.",
            "id": "4005885",
            "problem": "Consider a two-dimensional, steady, incompressible, Newtonian flow at very low Reynolds number (creeping flow) in the context of Computational Fluid Dynamics (CFD). Let the domain be the unit square $\\Omega = (0,1)\\times(0,1)$ with boundary $\\partial \\Omega$. Denote by $\\boldsymbol{u}:\\Omega \\to \\mathbb{R}^2$ the velocity and by $p:\\Omega \\to \\mathbb{R}$ the pressure. The Cauchy stress tensor is $\\boldsymbol{\\sigma}(\\boldsymbol{u},p) = -p\\,\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$, where $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}\\right)$ and $\\mu>0$ is the dynamic viscosity. The governing equations are\n$$\n-\\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u},p) = \\boldsymbol{0}\\quad \\text{in }\\Omega,\\qquad \\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in }\\Omega.\n$$\nOn the boundary, impose a homogeneous velocity (Dirichlet) condition $\\boldsymbol{u}=\\boldsymbol{0}$ on $\\Gamma_{D} = \\partial \\Omega \\setminus \\Gamma_{N}$ and a pressure (traction) boundary condition on the right edge $\\Gamma_{N} = \\{(x,y)\\in \\partial \\Omega: x=1,\\, y\\in(0,1)\\}$ of the form\n$$\n\\boldsymbol{\\sigma}(\\boldsymbol{u},p)\\,\\boldsymbol{n} = -\\,p_{\\text{out}}(y)\\,\\boldsymbol{n}\\quad \\text{on }\\Gamma_{N},\n$$\nwhere $\\boldsymbol{n}$ is the outward unit normal and $p_{\\text{out}}(y) = 1 + y^{2}$. Assume all quantities are nondimensional.\n\n(a) Starting from the balance of linear momentum and the definition of the Cauchy stress, derive the weak (variational) form of the Stokes problem: find $(\\boldsymbol{u},p)$ in appropriate spaces such that, for all test functions $(\\boldsymbol{w},q)$ with $\\boldsymbol{w}=\\boldsymbol{0}$ on $\\Gamma_{D}$,\n$$\n\\int_{\\Omega} 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w})\\,\\mathrm{d}\\Omega - \\int_{\\Omega} p\\,\\nabla \\cdot \\boldsymbol{w}\\,\\mathrm{d}\\Omega + \\int_{\\Omega} q\\,\\nabla \\cdot \\boldsymbol{u}\\,\\mathrm{d}\\Omega = \\int_{\\Gamma_{N}} \\boldsymbol{t}\\cdot \\boldsymbol{w}\\,\\mathrm{d}S,\n$$\nand identify the traction $\\boldsymbol{t}$ implied by the given pressure boundary condition. Clearly state the resulting natural boundary contribution functional on $\\Gamma_{N}$ in terms of $p_{\\text{out}}$ and $\\boldsymbol{w}$.\n\n(b) Let the specific test function be $\\boldsymbol{w}(x,y) = \\begin{pmatrix} y(1-y) \\\\ x(1-x) \\end{pmatrix}$. Compute the scalar value of the natural boundary contribution functional evaluated at $\\boldsymbol{w}$ over $\\Gamma_{N}$, i.e.,\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) \\equiv \\int_{\\Gamma_{N}} \\boldsymbol{t}\\cdot \\boldsymbol{w}\\,\\mathrm{d}S,\n$$\nwith the outward unit normal $\\boldsymbol{n}$ on $\\Gamma_{N}$ and the given $p_{\\text{out}}(y)=1+y^{2}$. Provide your final answer as a single exact real number. Do not round. All quantities are nondimensional, so no units are required.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and all necessary information is provided. The givens are the governing Stokes equations for a two-dimensional, steady, incompressible, Newtonian flow in a unit square domain $\\Omega = (0,1)\\times(0,1)$. The momentum balance is $-\\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u},p) = \\boldsymbol{0}$ and the mass continuity is $\\nabla \\cdot \\boldsymbol{u} = 0$. The Cauchy stress tensor is $\\boldsymbol{\\sigma}(\\boldsymbol{u},p) = -p\\,\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$, with $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}\\right)$. Boundary conditions consist of homogeneous Dirichlet conditions $\\boldsymbol{u}=\\boldsymbol{0}$ on $\\Gamma_{D} = \\partial \\Omega \\setminus \\Gamma_{N}$ and a traction condition $\\boldsymbol{\\sigma}(\\boldsymbol{u},p)\\,\\boldsymbol{n} = -\\,p_{\\text{out}}(y)\\,\\boldsymbol{n}$ on the right edge $\\Gamma_{N} = \\{(x,y): x=1, y\\in(0,1)\\}$, where $p_{\\text{out}}(y) = 1 + y^{2}$. The problem is well-defined and consistent with the principles of continuum mechanics. We may proceed with the solution.\n\n(a) Derivation of the weak variational form.\n\nWe begin with the momentum equation, also known as the balance of linear momentum, $-\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}$. To derive the weak form, we multiply by a vector test function $\\boldsymbol{w}$ and integrate over the domain $\\Omega$. The test function $\\boldsymbol{w}$ must belong to a suitable function space, and for the imposition of Dirichlet boundary conditions, it is required to vanish on the Dirichlet part of the boundary, i.e., $\\boldsymbol{w} = \\boldsymbol{0}$ on $\\Gamma_D$.\n$$\n- \\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{\\sigma}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}\\Omega = \\boldsymbol{0}\n$$\nWe apply the divergence theorem, or more specifically, Green's first identity for tensor fields, which states $\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{T}) \\cdot \\boldsymbol{v} \\,\\mathrm{d}\\Omega = -\\int_{\\Omega} \\boldsymbol{T} : \\nabla \\boldsymbol{v} \\,\\mathrm{d}\\Omega + \\int_{\\partial \\Omega} (\\boldsymbol{T} \\boldsymbol{n}) \\cdot \\boldsymbol{v} \\,\\mathrm{d}S$. Setting $\\boldsymbol{T} = \\boldsymbol{\\sigma}$ and $\\boldsymbol{v} = \\boldsymbol{w}$, we obtain:\n$$\n- \\left( -\\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla\\boldsymbol{w} \\,\\mathrm{d}\\Omega + \\int_{\\partial\\Omega} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S \\right) = \\boldsymbol{0}\n$$\nThis simplifies to:\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla\\boldsymbol{w} \\,\\mathrm{d}\\Omega = \\int_{\\partial\\Omega} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S\n$$\nNext, we substitute the definition of the Cauchy stress tensor, $\\boldsymbol{\\sigma} = -p\\,\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$, into the left-hand side:\n$$\n\\int_{\\Omega} (-p\\,\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) : \\nabla\\boldsymbol{w} \\,\\mathrm{d}\\Omega = \\int_{\\Omega} -p\\,(\\boldsymbol{I} : \\nabla\\boldsymbol{w}) + 2\\mu\\,(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) : \\nabla\\boldsymbol{w}) \\,\\mathrm{d}\\Omega\n$$\nWe analyze the two terms in the integrand separately. The first term involves the double dot product of the identity tensor $\\boldsymbol{I}$ and the gradient of $\\boldsymbol{w}$, which is the trace of $\\nabla\\boldsymbol{w}$, i.e., $\\boldsymbol{I}:\\nabla\\boldsymbol{w} = \\operatorname{tr}(\\nabla\\boldsymbol{w}) = \\nabla \\cdot \\boldsymbol{w}$. The second term involves the product of the strain-rate tensor $\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$ and $\\nabla\\boldsymbol{w}$. Since $\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$ is symmetric, its double dot product with any tensor $\\nabla\\boldsymbol{w}$ is equivalent to its product with the symmetric part of that tensor, $\\boldsymbol{\\varepsilon}(\\boldsymbol{w}) = \\frac{1}{2}(\\nabla\\boldsymbol{w} + \\nabla\\boldsymbol{w}^\\top)$. The product with the skew-symmetric part is zero. Thus, $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\nabla\\boldsymbol{w} = \\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w})$.\nThe left-hand side therefore becomes:\n$$\n-\\int_{\\Omega} p\\,(\\nabla \\cdot \\boldsymbol{w}) \\,\\mathrm{d}\\Omega + \\int_{\\Omega} 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w}) \\,\\mathrm{d}\\Omega\n$$\nThe boundary integral on the right-hand side is split over the Dirichlet and Neumann boundaries:\n$$\n\\int_{\\partial\\Omega} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S = \\int_{\\Gamma_D} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S + \\int_{\\Gamma_N} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S\n$$\nBy construction, the test functions for velocity satisfy $\\boldsymbol{w} = \\boldsymbol{0}$ on $\\Gamma_D$, so the integral over $\\Gamma_D$ vanishes. On $\\Gamma_N$, we are given the traction condition $\\boldsymbol{\\sigma}\\boldsymbol{n} = -p_{\\text{out}}(y)\\boldsymbol{n}$. We define the traction vector as $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$. Thus, on $\\Gamma_N$, $\\boldsymbol{t} = -p_{\\text{out}}(y)\\boldsymbol{n}$. The boundary integral reduces to:\n$$\n\\int_{\\Gamma_N} \\boldsymbol{t} \\cdot \\boldsymbol{w} \\,\\mathrm{d}S = \\int_{\\Gamma_N} (-p_{\\text{out}}(y)\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S\n$$\nCombining these parts, the weak form of the momentum equation is:\n$$\n\\int_{\\Omega} 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w}) \\,\\mathrm{d}\\Omega - \\int_{\\Omega} p\\,(\\nabla \\cdot \\boldsymbol{w}) \\,\\mathrm{d}\\Omega = \\int_{\\Gamma_N} \\boldsymbol{t} \\cdot \\boldsymbol{w} \\,\\mathrm{d}S\n$$\nFinally, we incorporate the incompressibility constraint $\\nabla \\cdot \\boldsymbol{u} = 0$. In a mixed formulation, we multiply it by a scalar pressure test function, $q$, and integrate over $\\Omega$. Since $\\nabla \\cdot \\boldsymbol{u} = 0$, this yields $\\int_{\\Omega} q\\,(\\nabla \\cdot \\boldsymbol{u}) \\,\\mathrm{d}\\Omega = 0$. Adding this null term to the left-hand side gives the final weak formulation as requested:\nFind $(\\boldsymbol{u}, p)$ such that for all valid test functions $(\\boldsymbol{w}, q)$:\n$$\n\\int_{\\Omega} 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w})\\,\\mathrm{d}\\Omega - \\int_{\\Omega} p\\,\\nabla \\cdot \\boldsymbol{w}\\,\\mathrm{d}\\Omega + \\int_{\\Omega} q\\,\\nabla \\cdot \\boldsymbol{u}\\,\\mathrm{d}\\Omega = \\int_{\\Gamma_{N}} \\boldsymbol{t}\\cdot \\boldsymbol{w}\\,\\mathrm{d}S\n$$\nThe traction $\\boldsymbol{t}$ implied by the boundary condition is $\\boldsymbol{t} = -p_{\\text{out}}(y)\\boldsymbol{n}$. The natural boundary contribution functional on $\\Gamma_N$ is the right-hand side, which is:\n$$\n\\int_{\\Gamma_{N}} (-p_{\\text{out}}(y)\\boldsymbol{n}) \\cdot \\boldsymbol{w}\\,\\mathrm{d}S\n$$\n\n(b) Computation of the natural boundary contribution functional.\n\nWe are asked to compute the value of the functional $I_{\\Gamma_{N}}(\\boldsymbol{w}) \\equiv \\int_{\\Gamma_{N}} \\boldsymbol{t}\\cdot \\boldsymbol{w}\\,\\mathrm{d}S$ for a specific function $\\boldsymbol{w}(x,y) = \\begin{pmatrix} y(1-y) \\\\ x(1-x) \\end{pmatrix}$. It is worth noting that this function does not satisfy $\\boldsymbol{w}=\\boldsymbol{0}$ on all parts of the Dirichlet boundary $\\Gamma_D$ (e.g., at $(0.5, 0)$, $\\boldsymbol{w} \\neq \\boldsymbol{0}$), and thus is not a valid test function for the variational problem. However, the evaluation of the integral for this function is a well-posed mathematical task.\n\nThe boundary $\\Gamma_N$ is the segment where $x=1$ and $y \\in (0,1)$. The outward unit normal vector on this boundary is $\\boldsymbol{n} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. The line element is $\\mathrm{d}S = \\mathrm{d}y$.\nFrom part (a), the integrand is $\\boldsymbol{t} \\cdot \\boldsymbol{w} = (-p_{\\text{out}}(y)\\boldsymbol{n}) \\cdot \\boldsymbol{w}$.\nSubstituting the given functions and vectors:\n$$\n\\boldsymbol{t} \\cdot \\boldsymbol{w} = -\\left(1+y^2\\right)\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\cdot \\begin{pmatrix} y(1-y) \\\\ x(1-x) \\end{pmatrix}\n$$\nThe dot product evaluates to:\n$$\n\\boldsymbol{t} \\cdot \\boldsymbol{w} = -(1+y^2) \\left(1 \\cdot y(1-y) + 0 \\cdot x(1-x) \\right) = -(1+y^2)y(1-y)\n$$\nThe integral is evaluated over $\\Gamma_N$, so we must set $x=1$ in the expression for $\\boldsymbol{w}$, although in this case, the $w_y$ component is multiplied by zero anyway. The function $\\boldsymbol{w}$ on $\\Gamma_N$ is $\\boldsymbol{w}(1,y) = \\begin{pmatrix} y(1-y) \\\\ 1(1-1) \\end{pmatrix} = \\begin{pmatrix} y(1-y) \\\\ 0 \\end{pmatrix}$.\nThe integrand on $\\Gamma_N$ is:\n$$\n-(1+y^2)(y-y^2) = -(y - y^2 + y^3 - y^4) = y^4 - y^3 + y^2 - y\n$$\nWe now compute the definite integral over $y$ from $0$ to $1$:\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\int_{0}^{1} (y^4 - y^3 + y^2 - y) \\,\\mathrm{d}y\n$$\nUsing the power rule for integration:\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\left[ \\frac{y^5}{5} - \\frac{y^4}{4} + \\frac{y^3}{3} - \\frac{y^2}{2} \\right]_{0}^{1}\n$$\nEvaluating the expression at the limits of integration:\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\left( \\frac{1^5}{5} - \\frac{1^4}{4} + \\frac{1^3}{3} - \\frac{1^2}{2} \\right) - \\left( 0 \\right)\n$$\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\frac{1}{5} - \\frac{1}{4} + \\frac{1}{3} - \\frac{1}{2}\n$$\nTo find the final value, we use a common denominator, which is the least common multiple of $2$, $3$, $4$, and $5$, which is $60$.\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\frac{12}{60} - \\frac{15}{60} + \\frac{20}{60} - \\frac{30}{60} = \\frac{12 - 15 + 20 - 30}{60}\n$$\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\frac{-3 + 20 - 30}{60} = \\frac{17 - 30}{60} = \\frac{-13}{60}\n$$\nThe value of the natural boundary contribution functional for the given function $\\boldsymbol{w}$ is $-\\frac{13}{60}$.",
            "answer": "$$\n\\boxed{-\\frac{13}{60}}\n$$"
        },
        {
            "introduction": "While the weak form tells us where boundary conditions can be applied, it does not tell us which conditions are physically appropriate. For hyperbolic systems, such as the Euler equations governing high-speed compressible flow, this choice is rigorously constrained by the physics of wave propagation. This practice  delves into the core of this concept by using characteristic analysis on the linearized Euler equations. You will determine which information must be provided at a subsonic outflow boundary by identifying the direction of wave travel, a critical skill for developing stable and non-reflecting boundary conditions in aerospace CFD.",
            "id": "4005907",
            "problem": "Consider the linearized isentropic Euler equations for small perturbations about a uniform, steady, one-dimensional ($1$-D) mean flow relevant to Computational Fluid Dynamics (CFD) in aerospace applications. Let the mean state be characterized by constant density $\\rho_{0} > 0$, constant pressure $p_{0} > 0$, constant flow speed $u_{0} > 0$, and constant sound speed $c_{0} > 0$, with subsonic mean flow satisfying $0 < u_{0} < c_{0}$. Denote the perturbations by $p'(x,t)$ and $u'(x,t)$, assumed sufficiently smooth, and adopt the isentropic closure so that the acoustic speed satisfies $c_{0}^{2} = \\gamma p_{0} / \\rho_{0}$ with $\\gamma > 1$ the ratio of specific heats. The linearized equations for $(p',u')$ are\n$$\np'_{t} + u_{0} \\, p'_{x} + \\rho_{0} c_{0}^{2} \\, u'_{x} = 0, \\qquad\nu'_{t} + u_{0} \\, u'_{x} + \\frac{1}{\\rho_{0}} \\, p'_{x} = 0,\n$$\non the spatial interval $x \\in (0,L)$ and time $t \\ge 0$, for some fixed $L>0$. Consider a Galerkin weak formulation: choose a test function $\\varphi(x) \\in H^{1}(0,L)$ and write the weak form by multiplying the system by $\\varphi$ and integrating by parts over $(0,L)$ in the spatial variable. Focus attention on the right boundary at $x=L$, where a physically admissible characteristic boundary condition must be imposed to ensure energy stability and non-reflection for the subsonic outflow.\n\nStarting from conservation of mass and momentum, the definition of sound speed, and the hyperbolic structure of the linearized system, derive the characteristic decomposition in the $x$-direction. Using an energy method with a symmetric positive definite symmetrizer appropriate for the isentropic acoustics subsystem and the boundary normal pointing in the positive $x$-direction at $x=L$, determine which characteristic is incoming at $x=L$ when $0 < u_{0} < c_{0}$. Then, for the purpose of formulating a non-reflecting characteristic boundary condition in the weak variational form, express the incoming characteristic combination at $x=L$ as a single linear expression in the primitive variables $p'$ and $u'$.\n\nYour final answer must be that single analytic expression, with all symbols as defined above. Do not provide an inequality or an equation; provide only the explicit linear combination of $p'$ and $u'$ corresponding to the incoming characteristic at $x=L$ in the specified subsonic regime.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n**Step 1: Extracted Givens**\n-   **System**: Linearized isentropic Euler equations for small perturbations $(p', u')$.\n-   **Equations**:\n    $$\n    p'_{t} + u_{0} \\, p'_{x} + \\rho_{0} c_{0}^{2} \\, u'_{x} = 0\n    $$\n    $$\n    u'_{t} + u_{0} \\, u'_{x} + \\frac{1}{\\rho_{0}} \\, p'_{x} = 0\n    $$\n-   **Domain**: $x \\in (0,L)$ and $t \\ge 0$.\n-   **Mean State**: Uniform with constant density $\\rho_{0} > 0$, constant pressure $p_{0} > 0$, constant flow speed $u_{0} > 0$, and constant sound speed $c_{0} > 0$.\n-   **Flow Regime**: Subsonic mean flow, $0 < u_{0} < c_{0}$.\n-   **Isentropic Closure**: $c_{0}^{2} = \\gamma p_{0} / \\rho_{0}$ with $\\gamma > 1$.\n-   **Objective**: At the right boundary $x=L$, identify the incoming characteristic and express it as a linear combination of $p'$ and $u'$.\n\n**Step 2: Validation**\nThe problem is scientifically grounded, as it deals with the linearized Euler equations, a standard model in fluid dynamics and acoustics. The concepts of characteristic decomposition and non-reflecting boundary conditions are fundamental to the theory and numerical solution of hyperbolic partial differential equations. All terms are well-defined, and the problem is mathematically self-contained and objective. There are no contradictions, missing data, or scientifically unsound premises.\n\n**Step 3: Verdict**\nThe problem is valid.\n\n**Solution Derivation**\nThe provided system of partial differential equations can be expressed in matrix-vector form. Let the state vector be $\\mathbf{q} = \\begin{pmatrix} p' \\\\ u' \\end{pmatrix}$. The system is then written as:\n$$\n\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x} = \\mathbf{0}\n$$\nwhere the coefficient matrix $\\mathbf{A}$ is given by:\n$$\n\\mathbf{A} = \\begin{pmatrix} u_{0} & \\rho_{0} c_{0}^{2} \\\\ \\frac{1}{\\rho_{0}} & u_{0} \\end{pmatrix}\n$$\nThe hyperbolic nature of this system is analyzed by finding the eigenvalues and eigenvectors of the matrix $\\mathbf{A}$. The eigenvalues, denoted by $\\lambda$, represent the characteristic speeds of wave propagation. They are found by solving the characteristic equation $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = 0$, where $\\mathbf{I}$ is the identity matrix.\n$$\n\\det \\begin{pmatrix} u_{0}-\\lambda & \\rho_{0} c_{0}^{2} \\\\ \\frac{1}{\\rho_{0}} & u_{0}-\\lambda \\end{pmatrix} = 0\n$$\nExpanding the determinant gives:\n$$\n(u_{0} - \\lambda)^{2} - \\left(\\rho_{0} c_{0}^{2}\\right) \\left(\\frac{1}{\\rho_{0}}\\right) = 0\n$$\n$$\n(u_{0} - \\lambda)^{2} - c_{0}^{2} = 0\n$$\n$$\nu_{0} - \\lambda = \\pm c_{0}\n$$\nThis yields two distinct real eigenvalues, confirming the system is strictly hyperbolic:\n$$\n\\lambda_{1} = u_{0} + c_{0}\n$$\n$$\n\\lambda_{2} = u_{0} - c_{0}\n$$\nThe problem asks for the incoming characteristic at the right boundary, $x=L$. At this boundary, the outward-pointing normal vector is in the positive $x$-direction. A characteristic is defined as \"incoming\" if its corresponding wave propagates into the domain, which means it travels in the negative $x$-direction. Therefore, an incoming characteristic is associated with a negative eigenvalue, $\\lambda < 0$.\n\nWe are given that the mean flow is subsonic, i.e., $0 < u_{0} < c_{0}$. We can determine the sign of each eigenvalue under this condition:\n-   For $\\lambda_{1} = u_{0} + c_{0}$: Since $u_{0} > 0$ and $c_{0} > 0$, it follows that $\\lambda_{1} > 0$. This corresponds to an outgoing characteristic. Information associated with this wave propagates out of the domain at $x=L$.\n-   For $\\lambda_{2} = u_{0} - c_{0}$: Since $u_{0} < c_{0}$, it follows that $\\lambda_{2} < 0$. This corresponds to an incoming characteristic. Information associated with this wave propagates into the domain at $x=L$.\n\nA physically-based, non-reflecting boundary condition requires that the amplitude of any incoming characteristic be specified. The problem asks for the expression of this incoming characteristic combination in terms of the primitive variables $p'$ and $u'$. This expression is found by determining the left eigenvector $\\mathbf{l}_{2}^{T}$ corresponding to the eigenvalue $\\lambda_{2}$.\n\nLet $\\mathbf{l}_{2}^{T} = \\begin{pmatrix} l_{a} & l_{b} \\end{pmatrix}$ be the left eigenvector for $\\lambda_{2}$. It must satisfy $\\mathbf{l}_{2}^{T} \\mathbf{A} = \\lambda_{2} \\mathbf{l}_{2}^{T}$.\n$$\n\\begin{pmatrix} l_{a} & l_{b} \\end{pmatrix} \\begin{pmatrix} u_{0} & \\rho_{0} c_{0}^{2} \\\\ \\frac{1}{\\rho_{0}} & u_{0} \\end{pmatrix} = (u_{0} - c_{0}) \\begin{pmatrix} l_{a} & l_{b} \\end{pmatrix}\n$$\nThis matrix equation yields a system of two linear algebraic equations for $l_{a}$ and $l_{b}$:\n1.  $l_{a} u_{0} + l_{b} \\frac{1}{\\rho_{0}} = l_{a} (u_{0} - c_{0}) \\implies \\frac{l_{b}}{\\rho_{0}} = -l_{a} c_{0} \\implies l_{b} = - \\rho_{0} c_{0} l_{a}$\n2.  $l_{a} \\rho_{0} c_{0}^{2} + l_{b} u_{0} = l_{b} (u_{0} - c_{0}) \\implies l_{a} \\rho_{0} c_{0}^{2} = -l_{b} c_{0} \\implies l_{a} \\rho_{0} c_{0} = -l_{b}$\n\nBoth equations give the same relationship, $l_{b} = - \\rho_{0} c_{0} l_{a}$. We can choose a convenient scaling, for example, $l_{a}=1$. Then $l_{b} = -\\rho_{0} c_{0}$. The left eigenvector is:\n$$\n\\mathbf{l}_{2}^{T} = \\begin{pmatrix} 1 & -\\rho_{0} c_{0} \\end{pmatrix}\n$$\nThe characteristic variable, or \"characteristic combination,\" $W_{2}$, is obtained by projecting the state vector $\\mathbf{q}$ onto the left eigenvector $\\mathbf{l}_{2}^{T}$:\n$$\nW_{2} = \\mathbf{l}_{2}^{T} \\mathbf{q} = \\begin{pmatrix} 1 & -\\rho_{0} c_{0} \\end{pmatrix} \\begin{pmatrix} p' \\\\ u' \\end{pmatrix} = p' - \\rho_{0} c_{0} u'\n$$\nThis expression, $p' - \\rho_{0} c_{0} u'$, is the linear combination corresponding to the incoming characteristic at the subsonic outflow boundary at $x=L$. This is the quantity that must be specified to form a well-posed, non-reflecting boundary condition. The energy method mentioned in the problem statement serves as a rigorous justification for this procedure, as it identifies which characteristic modes contribute negatively to the boundary energy flux, thus requiring control via boundary conditions to ensure stability. The analysis above, based on the sign of the eigenvalues of the flux Jacobian $\\mathbf{A}$, directly identifies these modes.",
            "answer": "$$\n\\boxed{p' - \\rho_{0} c_{0} u'}\n$$"
        },
        {
            "introduction": "Bridging the gap between variational theory and modern computational practice requires understanding how boundary data is implemented in numerical schemes. In widely used methods like Discontinuous Galerkin and Finite Volume, information is exchanged across element faces and domain boundaries using numerical fluxes. This hands-on calculation  provides a concrete example of this process for the compressible Euler equations. You will compute a Rusanov numerical flux at a subsonic outflow boundary, directly applying physical boundary data to construct the flux and ensure a stable and consistent numerical solution.",
            "id": "4005901",
            "problem": "Consider the two-dimensional compressible Euler equations in conservation form for inviscid flow, posed on a domain with boundary, as used in Computational Fluid Dynamics (CFD):\n$$\n\\partial_{t}\\boldsymbol{U} + \\nabla \\cdot \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0},\n$$\nwhere the conservative state vector is\n$$\n\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix},\n$$\nwith density $\\rho$, velocity component $u$ in the outward-normal direction, and total energy per unit volume $E$, and the flux tensor in the outward-normal direction $\\boldsymbol{n}$ is, for components aligned with $\\boldsymbol{n}$,\n$$\n\\boldsymbol{F}(\\boldsymbol{U}) \\cdot \\boldsymbol{n} = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u\\,(E + p) \\end{pmatrix},\n$$\nwith pressure $p$ given by the ideal gas law closure for a perfect gas,\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^{2},\n$$\nwhere $\\gamma$ is the ratio of specific heats. In a Discontinuous Galerkin (DG) formulation, after multiplying by a smooth test function and integrating by parts over a single element $K$ adjacent to the boundary, the weak variational form produces a boundary integral of the form\n$$\n\\int_{\\partial K} \\phi\\, \\boldsymbol{F}^{\\ast}(\\boldsymbol{U}^{-}, \\boldsymbol{U}^{+}) \\cdot \\boldsymbol{n}\\, \\mathrm{d}s,\n$$\nwhere $\\phi$ is the test function trace, $\\boldsymbol{U}^{-}$ is the interior trace state, $\\boldsymbol{U}^{+}$ is the exterior (boundary) state consistent with the physical boundary condition, and $\\boldsymbol{F}^{\\ast}$ is a consistent two-point numerical flux that must ensure stability through appropriate dissipation tied to the characteristic speeds in the normal direction.\n\nAt a right boundary segment where the outward unit normal is $\\boldsymbol{n} = (1, 0)$, assume a subsonic outflow boundary for an air flow with ratio of specific heats $\\gamma = 1.4$. For subsonic outflow, one incoming characteristic necessitates specification of the static pressure; adopt a far-field static pressure prescription $p^{+} = p_{\\infty}$. The far-field pressure is\n$p_{\\infty} = 1.000 \\times 10^{5}$,\nand the interior state adjacent to the boundary is\n$\\rho^{-} = 1.2,\\quad u^{-} = 250,\\quad p^{-} = 1.050 \\times 10^{5}$.\nUsing the above physical model and weak variational framework, and a consistent two-point flux with dissipation proportional to the largest normal characteristic speed across the boundary interface, derive the boundary numerical flux vector $\\boldsymbol{F}^{\\ast}(\\boldsymbol{U}^{-}, \\boldsymbol{U}^{+}) \\cdot \\boldsymbol{n}$ at this boundary and compute its three components numerically. Treat the speed of sound as $a = \\sqrt{\\gamma p/\\rho}$ evaluated for each state. Express each component of the flux in the International System of Units (SI), and round each component to four significant figures. Provide the final numerical vector in a single row matrix as your answer, without units inside the final answer box.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- **Governing Equations**:Compressible Euler equations, $\\partial_{t}\\boldsymbol{U} + \\nabla \\cdot \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0}$.\n- **State Vector**: $\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}$, where $u$ is the velocity component in the outward-normal direction.\n- **Normal Flux Vector**: $\\boldsymbol{F}(\\boldsymbol{U}) \\cdot \\boldsymbol{n} = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u\\,(E + p) \\end{pmatrix}$.\n- **Equation of State**: $E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^{2}$ for a perfect gas.\n- **Ratio of Specific Heats**: $\\gamma = 1.4$.\n- **Weak Form Boundary Integral**: $\\int_{\\partial K} \\phi\\, \\boldsymbol{F}^{\\ast}(\\boldsymbol{U}^{-}, \\boldsymbol{U}^{+}) \\cdot \\boldsymbol{n}\\, \\mathrm{d}s$.\n- **Numerical Flux**: A consistent two-point flux with dissipation proportional to the largest normal characteristic speed across the boundary interface. This corresponds to the Rusanov (or local Lax-Friedrichs) numerical flux.\n- **Boundary Conditions**: Subsonic outflow at a right boundary with outward normal $\\boldsymbol{n} = (1, 0)$.\n- **Boundary Data Prescription**:\n  - Exterior pressure: $p^{+} = p_{\\infty} = 1.000 \\times 10^{5}$ Pa.\n  - Extrapolated quantities: $\\rho^{+} = \\rho^{-}$, $u^{+} = u^{-}$.\n- **Interior State (`-`)**:\n  - Density: $\\rho^{-} = 1.2$ kg/m$^3$.\n  - Normal velocity: $u^{-} = 250$ m/s.\n  - Pressure: $p^{-} = 1.050 \\times 10^{5}$ Pa.\n- **Speed of Sound Formula**: $a = \\sqrt{\\gamma p/\\rho}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is based on the standard compressible Euler equations, the ideal gas law, and the Discontinuous Galerkin method with a Rusanov numerical flux. These are fundamental and well-established concepts in computational fluid dynamics.\n- **Well-Posedness**: The problem provides a complete set of data and definitions to calculate a specific quantity. The boundary condition treatment for subsonic outflow (specifying pressure and extrapolating other variables) is standard practice.\n- **Objectivity**: The problem is stated in precise, objective, and formal mathematical language.\n- **Consistency Check**: We must verify that the flow is indeed subsonic as stated.\n  - Speed of sound for the interior state: $a^{-} = \\sqrt{\\frac{\\gamma p^{-}}{\\rho^{-}}} = \\sqrt{\\frac{1.4 \\times (1.050 \\times 10^{5})}{1.2}} = \\sqrt{122500} = 350$ m/s.\n  - Interior Mach number: $M^{-} = \\frac{u^{-}}{a^{-}} = \\frac{250}{350} = \\frac{5}{7} \\approx 0.714$. Since $M^{-}  1$, the interior flow is subsonic.\n  - For the exterior state, $\\rho^{+} = 1.2$, $u^{+} = 250$, $p^{+} = 1.000 \\times 10^5$.\n  - Speed of sound for the exterior state: $a^{+} = \\sqrt{\\frac{\\gamma p^{+}}{\\rho^{+}}} = \\sqrt{\\frac{1.4 \\times (1.000 \\times 10^{5})}{1.2}} \\approx 341.565$ m/s.\n  - Exterior Mach number: $M^{+} = \\frac{u^{+}}{a^{+}} = \\frac{250}{341.565} \\approx 0.732$. Since $M^{+}  1$, the prescribed exterior state is also subsonic.\n- The problem is scientifically sound, well-posed, objective, and internally consistent.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\n### Solution Derivation\nThe numerical flux is described as a \"consistent two-point flux with dissipation proportional to the largest normal characteristic speed,\" which defines the Rusanov (or local Lax-Friedrichs) flux. For an interface with left state $\\boldsymbol{U}^{-}$ and right state $\\boldsymbol{U}^{+}$, the Rusanov flux is given by:\n$$ \\boldsymbol{F}^{\\ast}(\\boldsymbol{U}^{-}, \\boldsymbol{U}^{+}) \\cdot \\boldsymbol{n} = \\frac{1}{2} \\left[ (\\boldsymbol{F}(\\boldsymbol{U}^{-}) \\cdot \\boldsymbol{n}) + (\\boldsymbol{F}(\\boldsymbol{U}^{+}) \\cdot \\boldsymbol{n}) \\right] - \\frac{1}{2} S_{\\max} (\\boldsymbol{U}^{+} - \\boldsymbol{U}^{-}) $$\nThe dissipation coefficient $S_{\\max}$ is the maximum absolute characteristic speed at the interface. For the Euler equations, the characteristic speeds are $u-a$, $u$, and $u+a$. Thus, $S_{\\max}$ is given by:\n$$ S_{\\max} = \\max ( |u^{-}| + a^{-}, |u^{+}| + a^{+} ) $$\nWe will now compute each term in the Rusanov flux formula. All units are SI.\n\n**1. Interior State (`-`) and Flux:**\nGiven: $\\rho^{-} = 1.2$, $u^{-} = 250$, $p^{-} = 1.050 \\times 10^{5}$.\nTotal energy per unit volume $E^{-}$:\n$$ E^{-} = \\frac{p^{-}}{\\gamma - 1} + \\frac{1}{2}\\rho^{-} (u^{-})^{2} = \\frac{1.050 \\times 10^{5}}{1.4 - 1} + \\frac{1}{2}(1.2)(250)^{2} = 262500 + 37500 = 300000 $$\nThe interior state vector $\\boldsymbol{U}^{-}$ is:\n$$ \\boldsymbol{U}^{-} = \\begin{pmatrix} \\rho^{-} \\\\ \\rho^{-} u^{-} \\\\ E^{-} \\end{pmatrix} = \\begin{pmatrix} 1.2 \\\\ 1.2 \\times 250 \\\\ 300000 \\end{pmatrix} = \\begin{pmatrix} 1.2 \\\\ 300 \\\\ 300000 \\end{pmatrix} $$\nThe interior physical flux vector $\\boldsymbol{F}(\\boldsymbol{U}^{-}) \\cdot \\boldsymbol{n}$ is:\n$$ \\boldsymbol{F}(\\boldsymbol{U}^{-}) \\cdot \\boldsymbol{n} = \\begin{pmatrix} \\rho^{-} u^{-} \\\\ \\rho^{-} (u^{-})^{2} + p^{-} \\\\ u^{-}(E^{-} + p^{-}) \\end{pmatrix} = \\begin{pmatrix} 300 \\\\ 1.2(250)^{2} + 1.050 \\times 10^{5} \\\\ 250(300000 + 1.050 \\times 10^{5}) \\end{pmatrix} = \\begin{pmatrix} 300 \\\\ 75000 + 105000 \\\\ 250(405000) \\end{pmatrix} = \\begin{pmatrix} 300 \\\\ 180000 \\\\ 101250000 \\end{pmatrix} $$\n\n**2. Exterior State (`+`) and Flux:**\nGiven the subsonic outflow boundary conditions: $p^{+} = 1.000 \\times 10^{5}$, $\\rho^{+} = \\rho^{-} = 1.2$, $u^{+} = u^{-} = 250$.\nTotal energy per unit volume $E^{+}$:\n$$ E^{+} = \\frac{p^{+}}{\\gamma - 1} + \\frac{1}{2}\\rho^{+} (u^{+})^{2} = \\frac{1.000 \\times 10^{5}}{1.4 - 1} + \\frac{1}{2}(1.2)(250)^{2} = 250000 + 37500 = 287500 $$\nThe exterior state vector $\\boldsymbol{U}^{+}$ is:\n$$ \\boldsymbol{U}^{+} = \\begin{pmatrix} \\rho^{+} \\\\ \\rho^{+} u^{+} \\\\ E^{+} \\end{pmatrix} = \\begin{pmatrix} 1.2 \\\\ 1.2 \\times 250 \\\\ 287500 \\end{pmatrix} = \\begin{pmatrix} 1.2 \\\\ 300 \\\\ 287500 \\end{pmatrix} $$\nThe exterior physical flux vector $\\boldsymbol{F}(\\boldsymbol{U}^{+}) \\cdot \\boldsymbol{n}$ is:\n$$ \\boldsymbol{F}(\\boldsymbol{U}^{+}) \\cdot \\boldsymbol{n} = \\begin{pmatrix} \\rho^{+} u^{+} \\\\ \\rho^{+} (u^{+})^{2} + p^{+} \\\\ u^{+}(E^{+} + p^{+}) \\end{pmatrix} = \\begin{pmatrix} 300 \\\\ 1.2(250)^{2} + 1.000 \\times 10^{5} \\\\ 250(287500 + 1.000 \\times 10^{5}) \\end{pmatrix} = \\begin{pmatrix} 300 \\\\ 75000 + 100000 \\\\ 250(387500) \\end{pmatrix} = \\begin{pmatrix} 300 \\\\ 175000 \\\\ 96875000 \\end{pmatrix} $$\n\n**3. Dissipation Coefficient $S_{\\max}$:**\nWe need the speeds of sound for both states.\n$$ a^{-} = \\sqrt{\\frac{\\gamma p^{-}}{\\rho^{-}}} = \\sqrt{\\frac{1.4 \\times (1.050 \\times 10^{5})}{1.2}} = 350 $$\n$$ a^{+} = \\sqrt{\\frac{\\gamma p^{+}}{\\rho^{+}}} = \\sqrt{\\frac{1.4 \\times (1.000 \\times 10^{5})}{1.2}} \\approx 341.565 $$\nNow we compute $S_{\\max}$:\n$$ S_{\\max} = \\max ( |u^{-}| + a^{-}, |u^{+}| + a^{+} ) = \\max ( |250| + 350, |250| + 341.565 ) = \\max(600, 591.565) = 600 $$\n\n**4. Assemble the Rusanov Flux:**\nFirst, we find the difference in state vectors, $\\Delta\\boldsymbol{U} = \\boldsymbol{U}^{+} - \\boldsymbol{U}^{-}$:\n$$ \\Delta\\boldsymbol{U} = \\begin{pmatrix} 1.2 \\\\ 300 \\\\ 287500 \\end{pmatrix} - \\begin{pmatrix} 1.2 \\\\ 300 \\\\ 300000 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -12500 \\end{pmatrix} $$\nThe average of the physical fluxes is:\n$$ \\frac{1}{2}(\\boldsymbol{F}(\\boldsymbol{U}^{-}) \\cdot \\boldsymbol{n} + \\boldsymbol{F}(\\boldsymbol{U}^{+}) \\cdot \\boldsymbol{n}) = \\frac{1}{2}\\left( \\begin{pmatrix} 300 \\\\ 180000 \\\\ 101250000 \\end{pmatrix} + \\begin{pmatrix} 300 \\\\ 175000 \\\\ 96875000 \\end{pmatrix} \\right) = \\frac{1}{2}\\begin{pmatrix} 600 \\\\ 355000 \\\\ 198125000 \\end{pmatrix} = \\begin{pmatrix} 300 \\\\ 177500 \\\\ 99062500 \\end{pmatrix} $$\nThe dissipation term is:\n$$ \\frac{1}{2} S_{\\max} \\Delta\\boldsymbol{U} = \\frac{1}{2}(600) \\begin{pmatrix} 0 \\\\ 0 \\\\ -12500 \\end{pmatrix} = 300 \\begin{pmatrix} 0 \\\\ 0 \\\\ -12500 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -3750000 \\end{pmatrix} $$\nCombining these terms gives the numerical flux:\n$$ \\boldsymbol{F}^{\\ast} \\cdot \\boldsymbol{n} = \\begin{pmatrix} 300 \\\\ 177500 \\\\ 99062500 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ -3750000 \\end{pmatrix} = \\begin{pmatrix} 300 \\\\ 177500 \\\\ 99062500 + 3750000 \\end{pmatrix} = \\begin{pmatrix} 300 \\\\ 177500 \\\\ 102812500 \\end{pmatrix} $$\n\n**5. Final Result and Rounding:**\nThe problem requires each component to be rounded to four significant figures.\n- Component 1: $300$. To four significant figures, this is $300.0$ or $3.000 \\times 10^2$.\n- Component 2: $177500$. This is $1.775 \\times 10^5$, which already has four significant figures.\n- Component 3: $102812500$. This is $1.028125 \\times 10^8$. Rounding to four significant figures gives $1.028 \\times 10^8$.\n\nThe final numerical flux vector, with components rounded to four significant figures, is $(3.000 \\times 10^2, 1.775 \\times 10^5, 1.028 \\times 10^8)$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 3.000 \\times 10^{2}  1.775 \\times 10^{5}  1.028 \\times 10^{8} \\end{pmatrix} } $$"
        }
    ]
}