{
    "hands_on_practices": [
        {
            "introduction": "This first practice exercise grounds our theoretical discussion in a core problem of fluid dynamics: the convection-diffusion equation. We will not only derive the weak variational form from its strong counterpart but also confront a common numerical challenge in CFD—instability in convection-dominated scenarios. This problem  provides hands-on experience with integrating a Streamline-Upwind/Petrov-Galerkin (SUPG) stabilization term, a vital technique for developing accurate and robust finite element solvers for aerospace applications.",
            "id": "4005903",
            "problem": "A steady, one-dimensional convection–diffusion model for a passive scalar $\\phi(x)$ along a streamline in an aerospace Computational Fluid Dynamics (CFD) setting is considered on the interval $x \\in (0,L)$ with constant advective speed $a>0$ and constant diffusivity $\\kappa>0$. The governing conservation law is\n$$\n- \\frac{d}{dx}\\!\\left(\\kappa\\,\\frac{d\\phi}{dx}\\right) + a\\,\\frac{d\\phi}{dx} = 0 \\quad \\text{in } (0,L).\n$$\nImpose the inflow Dirichlet condition $\\phi(0)=\\phi_{\\mathrm{in}}$ and let the outflow at $x=L$ be treated naturally by the weak formulation. Start from this strong form and derive the weak variational form by multiplying with an admissible test function $w(x)$, integrating over $(0,L)$, and applying integration by parts on the diffusive term. Clearly identify the boundary terms and the role of $w(0)=0$ consistent with the essential boundary condition at the inflow.\n\nNow consider a continuous, linear finite element discretization on the first element $e=[0,h]$ adjacent to the inflow, with nodal values $\\phi_1$ at $x=0$ and $\\phi_2$ at $x=h$. The Dirichlet boundary condition is enforced strongly so that $\\phi_1=\\phi_{\\mathrm{in}}$. Use the standard linear shape functions on $e$, namely $N_1(x)=1-x/h$ and $N_2(x)=x/h$, so that the trial field on $e$ is $\\phi_h(x)=\\phi_1 N_1(x)+\\phi_2 N_2(x)$ and take the Galerkin test function $w(x)=N_2(x)$, which satisfies $w(0)=0$.\n\nAugment the elemental weak form with a residual-based Streamline-Upwind/Petrov–Galerkin (SUPG) stabilization term that is ramped off at the inflow boundary:\n$$\n\\int_{e} \\tau(x)\\, a\\, \\frac{dw}{dx}\\, r(\\phi_h)\\, dx,\n$$\nwhere the pointwise residual is $r(\\phi_h) = -\\kappa\\,\\frac{d^2 \\phi_h}{dx^2} + a\\,\\frac{d\\phi_h}{dx}$ and the boundary-damped stabilization parameter is $\\tau(x)=\\tau_0\\,\\frac{x}{h}$ with constant $\\tau_0>0$.\n\nCompute, in closed form, the total stabilized elemental left-hand side evaluated with $w=N_2$ on $e=[0,h]$, including the diffusive, advective, and boundary term arising from integration by parts, plus the SUPG contribution. Express your final result as a single analytic expression in terms of $a$, $\\kappa$, $h$, $\\tau_0$, $\\phi_{\\mathrm{in}}$, and $\\phi_2$. No numerical evaluation is required and no rounding is needed. Your final answer must be a single closed-form analytic expression.",
            "solution": "The user wants me to solve a problem on the Finite Element Method (FEM) for a 1D convection-diffusion equation.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Governing Equation:** $- \\frac{d}{dx}\\!\\left(\\kappa\\,\\frac{d\\phi}{dx}\\right) + a\\,\\frac{d\\phi}{dx} = 0$ on the domain $x \\in (0,L)$.\n*   **Parameters:** Advective speed $a>0$ and diffusivity $\\kappa>0$ are constants.\n*   **Boundary Conditions:** Inflow Dirichlet condition $\\phi(0)=\\phi_{\\mathrm{in}}$. Outflow at $x=L$ is treated naturally.\n*   **Discretization Task:** Derive the weak variational form from the strong form.\n*   **Finite Element Setup:**\n    *   **Element:** The first element is $e=[0,h]$.\n    *   **Nodal Values:** $\\phi_1$ at $x=0$ and $\\phi_2$ at $x=h$.\n    *   **Dirichlet Enforcement:** $\\phi_1=\\phi_{\\mathrm{in}}$ is strongly enforced.\n    *   **Shape Functions:** Linear shape functions on $e$ are $N_1(x)=1-x/h$ and $N_2(x)=x/h$.\n    *   **Trial Function:** $\\phi_h(x)=\\phi_1 N_1(x)+\\phi_2 N_2(x)$.\n    *   **Test Function:** Galerkin test function is $w(x)=N_2(x)$, which satisfies $w(0)=0$.\n*   **Stabilization:**\n    *   **SUPG Term:** $\\int_{e} \\tau(x)\\, a\\, \\frac{dw}{dx}\\, r(\\phi_h)\\, dx$.\n    *   **Pointwise Residual:** $r(\\phi_h) = -\\kappa\\,\\frac{d^2 \\phi_h}{dx^2} + a\\,\\frac{d\\phi_h}{dx}$.\n    *   **Stabilization Parameter:** $\\tau(x)=\\tau_0\\,\\frac{x}{h}$ with $\\tau_0>0$.\n*   **Objective:** Compute the total stabilized elemental left-hand side for element $e=[0,h]$ using the test function $w=N_2(x)$. The expression should include the standard Galerkin terms (diffusive, advective, and the boundary term from integration by parts) plus the SUPG contribution. The final result must be a single closed-form expression in terms of $a$, $\\kappa$, $h$, $\\tau_0$, $\\phi_{\\mathrm{in}}$, and $\\phi_2$.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientifically Grounded:** The problem statement describes the application of the Streamline-Upwind/Petrov-Galerkin (SUPG) finite element method to a one-dimensional steady convection-diffusion equation. This is a standard and fundamental topic in computational fluid dynamics and numerical analysis for partial differential equations. The model and the methods are well-established and scientifically sound.\n2.  **Well-Posed:** The problem is mathematically well-defined. It provides a governing equation, boundary conditions, and a clear set of instructions for deriving and calculating a specific quantity. All necessary functions and parameters are explicitly defined.\n3.  **Objective:** The problem is stated using precise mathematical and engineering terminology. There are no subjective or ambiguous statements.\n4.  **Complete and Consistent:** All information required to perform the calculation is provided. The definitions of the shape functions, trial/test functions, and stabilization term are complete and consistent with standard literature.\n5.  **No other flaws detected:** The problem is a standard exercise in the application of FEM and is not trivial, metaphorical, or contradictory.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. The solution will be derived as requested.\n\n### Solution\n\nThe objective is to compute the total stabilized elemental contribution for the first element $e=[0,h]$. This quantity is the value of the stabilized weak form evaluated with the given trial function $\\phi_h(x)$ and test function $w(x)$. The total expression, which we denote as $T$, is the sum of the standard Galerkin contribution, $I_{G}$, and the Streamline-Upwind/Petrov-Galerkin (SUPG) contribution, $I_{SUPG}$.\n\n$$\nT = I_{G} + I_{SUPG}\n$$\n\nThe Galerkin contribution $I_G$ is obtained by multiplying the governing equation by the test function $w(x)$ and integrating over the element domain $e=[0,h]$. The problem specifies that this calculation must include the boundary terms that arise from applying integration by parts to the diffusive term.\n\n$$\nI_G = \\int_0^h w(x) \\left( - \\frac{d}{dx}\\!\\left(\\kappa\\,\\frac{d\\phi_h}{dx}\\right) + a\\,\\frac{d\\phi_h}{dx} \\right) dx\n$$\n\nApplying integration by parts to the diffusive term $\\int_0^h -w \\frac{d}{dx}(\\kappa \\frac{d\\phi_h}{dx}) dx$ yields:\n\n$$\n\\int_0^h \\kappa \\frac{d\\phi_h}{dx} \\frac{dw}{dx} dx - \\left[ w(x) \\kappa \\frac{d\\phi_h}{dx} \\right]_0^h\n$$\n\nTherefore, the full Galerkin contribution is:\n\n$$\nI_G = \\underbrace{\\int_0^h \\kappa \\frac{d\\phi_h}{dx} \\frac{dw}{dx} dx}_{\\text{Diffusive}} + \\underbrace{\\int_0^h w(x) a \\frac{d\\phi_h}{dx} dx}_{\\text{Advective}} - \\underbrace{\\left[ w(x) \\kappa \\frac{d\\phi_h}{dx} \\right]_0^h}_{\\text{Boundary}}\n$$\n\nThe SUPG contribution is given as:\n\n$$\nI_{SUPG} = \\int_0^h \\tau(x)\\, a\\, \\frac{dw}{dx}\\, r(\\phi_h)\\, dx, \\quad \\text{where } r(\\phi_h) = -\\kappa\\,\\frac{d^2 \\phi_h}{dx^2} + a\\,\\frac{d\\phi_h}{dx}\n$$\n\nWe now evaluate these terms using the provided functions for the element $e=[0,h]$.\nThe trial function is $\\phi_h(x) = \\phi_1 N_1(x) + \\phi_2 N_2(x)$. With $\\phi_1=\\phi_{\\mathrm{in}}$, $N_1(x) = 1 - x/h$, and $N_2(x) = x/h$, we have:\n\n$$\n\\phi_h(x) = \\phi_{\\mathrm{in}}(1 - \\frac{x}{h}) + \\phi_2 \\frac{x}{h}\n$$\n\nThe first and second derivatives of $\\phi_h(x)$ are:\n\n$$\n\\frac{d\\phi_h}{dx} = \\frac{\\phi_2 - \\phi_{\\mathrm{in}}}{h} \\quad (\\text{a constant})\n$$\n$$\n\\frac{d^2\\phi_h}{dx^2} = 0\n$$\n\nThe test function is $w(x) = N_2(x) = x/h$. Its derivative is:\n\n$$\n\\frac{dw}{dx} = \\frac{1}{h} \\quad (\\text{a constant})\n$$\n\nWe also note the boundary values of the test function: $w(0)=0$ and $w(h)=1$.\n\n**1. Calculation of the Galerkin Contribution ($I_G$)**\n\n*   **Diffusive Term:**\n    $$\n    \\int_0^h \\kappa \\left(\\frac{\\phi_2 - \\phi_{\\mathrm{in}}}{h}\\right) \\left(\\frac{1}{h}\\right) dx = \\frac{\\kappa (\\phi_2 - \\phi_{\\mathrm{in}})}{h^2} \\int_0^h dx = \\frac{\\kappa (\\phi_2 - \\phi_{\\mathrm{in}})}{h^2} [x]_0^h = \\frac{\\kappa (\\phi_2 - \\phi_{\\mathrm{in}})}{h}\n    $$\n*   **Advective Term:**\n    $$\n    \\int_0^h \\left(\\frac{x}{h}\\right) a \\left(\\frac{\\phi_2 - \\phi_{\\mathrm{in}}}{h}\\right) dx = \\frac{a (\\phi_2 - \\phi_{\\mathrm{in}})}{h^2} \\int_0^h x\\,dx = \\frac{a (\\phi_2 - \\phi_{\\mathrm{in}})}{h^2} \\left[\\frac{x^2}{2}\\right]_0^h = \\frac{a (\\phi_2 - \\phi_{\\mathrm{in}})}{2}\n    $$\n*   **Boundary Term:**\n    $$\n    - \\left[ w(x) \\kappa \\frac{d\\phi_h}{dx} \\right]_0^h = - \\left( w(h) \\kappa \\frac{d\\phi_h}{dx}(h) - w(0) \\kappa \\frac{d\\phi_h}{dx}(0) \\right)\n    $$\n    Since $\\frac{d\\phi_h}{dx}$ is constant, $w(0)=0$, and $w(h)=1$:\n    $$\n    - \\left( 1 \\cdot \\kappa \\frac{\\phi_2 - \\phi_{\\mathrm{in}}}{h} - 0 \\right) = - \\frac{\\kappa (\\phi_2 - \\phi_{\\mathrm{in}})}{h}\n    $$\nSumming these three parts, we find that the diffusive term and the boundary term cancel each other:\n$$\nI_G = \\frac{\\kappa (\\phi_2 - \\phi_{\\mathrm{in}})}{h} + \\frac{a (\\phi_2 - \\phi_{\\mathrm{in}})}{2} - \\frac{\\kappa (\\phi_2 - \\phi_{\\mathrm{in}})}{h} = \\frac{a}{2} (\\phi_2 - \\phi_{\\mathrm{in}})\n$$\n\n**2. Calculation of the SUPG Contribution ($I_{SUPG}$)**\n\nFirst, we evaluate the pointwise residual $r(\\phi_h)$:\n$$\nr(\\phi_h) = -\\kappa \\frac{d^2\\phi_h}{dx^2} + a \\frac{d\\phi_h}{dx} = -\\kappa(0) + a \\left(\\frac{\\phi_2 - \\phi_{\\mathrm{in}}}{h}\\right) = \\frac{a(\\phi_2 - \\phi_{\\mathrm{in}})}{h}\n$$\nThe residual is constant over the element. Now we compute the SUPG integral:\n$$\nI_{SUPG} = \\int_0^h \\tau(x)\\, a\\, \\frac{dw}{dx}\\, r(\\phi_h)\\, dx = \\int_0^h \\left(\\tau_0 \\frac{x}{h}\\right) a \\left(\\frac{1}{h}\\right) \\left(\\frac{a(\\phi_2 - \\phi_{\\mathrm{in}})}{h}\\right) dx\n$$\nWe can pull all constant factors outside the integral:\n$$\nI_{SUPG} = \\frac{\\tau_0 a^2 (\\phi_2 - \\phi_{\\mathrm{in}})}{h^3} \\int_0^h x\\,dx\n$$\nEvaluating the integral:\n$$\nI_{SUPG} = \\frac{\\tau_0 a^2 (\\phi_2 - \\phi_{\\mathrm{in}})}{h^3} \\left[\\frac{x^2}{2}\\right]_0^h = \\frac{\\tau_0 a^2 (\\phi_2 - \\phi_{\\mathrm{in}})}{h^3} \\left(\\frac{h^2}{2}\\right) = \\frac{\\tau_0 a^2}{2h} (\\phi_2 - \\phi_{\\mathrm{in}})\n$$\n\n**3. Total Stabilized Elemental Left-Hand Side**\n\nThe total expression $T$ is the sum of the Galerkin and SUPG contributions:\n$$\nT = I_G + I_{SUPG} = \\frac{a}{2} (\\phi_2 - \\phi_{\\mathrm{in}}) + \\frac{\\tau_0 a^2}{2h} (\\phi_2 - \\phi_{\\mathrm{in}})\n$$\nFactoring out the common terms provides the final closed-form expression:\n$$\nT = \\left(\\frac{a}{2} + \\frac{\\tau_0 a^2}{2h}\\right) (\\phi_2 - \\phi_{\\mathrm{in}})\n$$\nThis expression represents the complete, stabilized second equation for the first finite element.",
            "answer": "$$\\boxed{\\left(\\frac{a}{2} + \\frac{\\tau_0 a^{2}}{2h}\\right) (\\phi_2 - \\phi_{\\mathrm{in}})}$$"
        },
        {
            "introduction": "Building on the scalar case, we now advance to a system of equations governing low-Reynolds-number incompressible flow, described by the Stokes equations. This exercise  is designed to clarify how the weak formulation extends to vector-valued problems and to illuminate the physical interpretation of natural boundary conditions as traction forces. By working through the derivation, you will see how boundary terms representing physical stresses, such as pressure acting on an outlet, emerge naturally from the integration-by-parts procedure.",
            "id": "4005885",
            "problem": "Consider a two-dimensional, steady, incompressible, Newtonian flow at very low Reynolds number (creeping flow) in the context of Computational Fluid Dynamics (CFD). Let the domain be the unit square $\\Omega = (0,1)\\times(0,1)$ with boundary $\\partial \\Omega$. Denote by $\\boldsymbol{u}:\\Omega \\to \\mathbb{R}^2$ the velocity and by $p:\\Omega \\to \\mathbb{R}$ the pressure. The Cauchy stress tensor is $\\boldsymbol{\\sigma}(\\boldsymbol{u},p) = -p\\,\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$, where $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}\\right)$ and $\\mu>0$ is the dynamic viscosity. The governing equations are\n$$\n-\\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u},p) = \\boldsymbol{0}\\quad \\text{in }\\Omega,\\qquad \\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in }\\Omega.\n$$\nOn the boundary, impose a homogeneous velocity (Dirichlet) condition $\\boldsymbol{u}=\\boldsymbol{0}$ on $\\Gamma_{D} = \\partial \\Omega \\setminus \\Gamma_{N}$ and a pressure (traction) boundary condition on the right edge $\\Gamma_{N} = \\{(x,y)\\in \\partial \\Omega: x=1,\\, y\\in(0,1)\\}$ of the form\n$$\n\\boldsymbol{\\sigma}(\\boldsymbol{u},p)\\,\\boldsymbol{n} = -\\,p_{\\text{out}}(y)\\,\\boldsymbol{n}\\quad \\text{on }\\Gamma_{N},\n$$\nwhere $\\boldsymbol{n}$ is the outward unit normal and $p_{\\text{out}}(y) = 1 + y^{2}$. Assume all quantities are nondimensional.\n\n(a) Starting from the balance of linear momentum and the definition of the Cauchy stress, derive the weak (variational) form of the Stokes problem: find $(\\boldsymbol{u},p)$ in appropriate spaces such that, for all test functions $(\\boldsymbol{w},q)$ with $\\boldsymbol{w}=\\boldsymbol{0}$ on $\\Gamma_{D}$,\n$$\n\\int_{\\Omega} 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w})\\,\\mathrm{d}\\Omega - \\int_{\\Omega} p\\,\\nabla \\cdot \\boldsymbol{w}\\,\\mathrm{d}\\Omega + \\int_{\\Omega} q\\,\\nabla \\cdot \\boldsymbol{u}\\,\\mathrm{d}\\Omega = \\int_{\\Gamma_{N}} \\boldsymbol{t}\\cdot \\boldsymbol{w}\\,\\mathrm{d}S,\n$$\nand identify the traction $\\boldsymbol{t}$ implied by the given pressure boundary condition. Clearly state the resulting natural boundary contribution functional on $\\Gamma_{N}$ in terms of $p_{\\text{out}}$ and $\\boldsymbol{w}$.\n\n(b) Let the specific test function be $\\boldsymbol{w}(x,y) = \\begin{pmatrix} y(1-y) \\\\ x(1-x) \\end{pmatrix}$. Compute the scalar value of the natural boundary contribution functional evaluated at $\\boldsymbol{w}$ over $\\Gamma_{N}$, i.e.,\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) \\equiv \\int_{\\Gamma_{N}} \\boldsymbol{t}\\cdot \\boldsymbol{w}\\,\\mathrm{d}S,\n$$\nwith the outward unit normal $\\boldsymbol{n}$ on $\\Gamma_{N}$ and the given $p_{\\text{out}}(y)=1+y^{2}$. Provide your final answer as a single exact real number. Do not round. All quantities are nondimensional, so no units are required.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and all necessary information is provided. The givens are the governing Stokes equations for a two-dimensional, steady, incompressible, Newtonian flow in a unit square domain $\\Omega = (0,1)\\times(0,1)$. The momentum balance is $-\\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u},p) = \\boldsymbol{0}$ and the mass continuity is $\\nabla \\cdot \\boldsymbol{u} = 0$. The Cauchy stress tensor is $\\boldsymbol{\\sigma}(\\boldsymbol{u},p) = -p\\,\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$, with $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}\\right)$. Boundary conditions consist of homogeneous Dirichlet conditions $\\boldsymbol{u}=\\boldsymbol{0}$ on $\\Gamma_{D} = \\partial \\Omega \\setminus \\Gamma_{N}$ and a traction condition $\\boldsymbol{\\sigma}(\\boldsymbol{u},p)\\,\\boldsymbol{n} = -\\,p_{\\text{out}}(y)\\,\\boldsymbol{n}$ on the right edge $\\Gamma_{N} = \\{(x,y): x=1, y\\in(0,1)\\}$, where $p_{\\text{out}}(y) = 1 + y^{2}$. The problem is well-defined and consistent with the principles of continuum mechanics. We may proceed with the solution.\n\n(a) Derivation of the weak variational form.\n\nWe begin with the momentum equation, also known as the balance of linear momentum, $-\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}$. To derive the weak form, we multiply by a vector test function $\\boldsymbol{w}$ and integrate over the domain $\\Omega$. The test function $\\boldsymbol{w}$ must belong to a suitable function space, and for the imposition of Dirichlet boundary conditions, it is required to vanish on the Dirichlet part of the boundary, i.e., $\\boldsymbol{w} = \\boldsymbol{0}$ on $\\Gamma_D$.\n$$\n- \\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{\\sigma}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}\\Omega = \\boldsymbol{0}\n$$\nWe apply the divergence theorem, or more specifically, Green's first identity for tensor fields, which states $\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{T}) \\cdot \\boldsymbol{v} \\,\\mathrm{d}\\Omega = -\\int_{\\Omega} \\boldsymbol{T} : \\nabla \\boldsymbol{v} \\,\\mathrm{d}\\Omega + \\int_{\\partial \\Omega} (\\boldsymbol{T} \\boldsymbol{n}) \\cdot \\boldsymbol{v} \\,\\mathrm{d}S$. Setting $\\boldsymbol{T} = \\boldsymbol{\\sigma}$ and $\\boldsymbol{v} = \\boldsymbol{w}$, we obtain:\n$$\n- \\left( -\\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla\\boldsymbol{w} \\,\\mathrm{d}\\Omega + \\int_{\\partial\\Omega} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S \\right) = \\boldsymbol{0}\n$$\nThis simplifies to:\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla\\boldsymbol{w} \\,\\mathrm{d}\\Omega = \\int_{\\partial\\Omega} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S\n$$\nNext, we substitute the definition of the Cauchy stress tensor, $\\boldsymbol{\\sigma} = -p\\,\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$, into the left-hand side:\n$$\n\\int_{\\Omega} (-p\\,\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) : \\nabla\\boldsymbol{w} \\,\\mathrm{d}\\Omega = \\int_{\\Omega} -p\\,(\\boldsymbol{I} : \\nabla\\boldsymbol{w}) + 2\\mu\\,(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) : \\nabla\\boldsymbol{w}) \\,\\mathrm{d}\\Omega\n$$\nWe analyze the two terms in the integrand separately. The first term involves the double dot product of the identity tensor $\\boldsymbol{I}$ and the gradient of $\\boldsymbol{w}$, which is the trace of $\\nabla\\boldsymbol{w}$, i.e., $\\boldsymbol{I}:\\nabla\\boldsymbol{w} = \\operatorname{tr}(\\nabla\\boldsymbol{w}) = \\nabla \\cdot \\boldsymbol{w}$. The second term involves the product of the strain-rate tensor $\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$ and $\\nabla\\boldsymbol{w}$. Since $\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$ is symmetric, its double dot product with any tensor $\\nabla\\boldsymbol{w}$ is equivalent to its product with the symmetric part of that tensor, $\\boldsymbol{\\varepsilon}(\\boldsymbol{w}) = \\frac{1}{2}(\\nabla\\boldsymbol{w} + \\nabla\\boldsymbol{w}^\\top)$. The product with the skew-symmetric part is zero. Thus, $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\nabla\\boldsymbol{w} = \\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w})$.\nThe left-hand side therefore becomes:\n$$\n-\\int_{\\Omega} p\\,(\\nabla \\cdot \\boldsymbol{w}) \\,\\mathrm{d}\\Omega + \\int_{\\Omega} 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w}) \\,\\mathrm{d}\\Omega\n$$\nThe boundary integral on the right-hand side is split over the Dirichlet and Neumann boundaries:\n$$\n\\int_{\\partial\\Omega} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S = \\int_{\\Gamma_D} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S + \\int_{\\Gamma_N} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S\n$$\nBy construction, the test functions for velocity satisfy $\\boldsymbol{w} = \\boldsymbol{0}$ on $\\Gamma_D$, so the integral over $\\Gamma_D$ vanishes. On $\\Gamma_N$, we are given the traction condition $\\boldsymbol{\\sigma}\\boldsymbol{n} = -p_{\\text{out}}(y)\\boldsymbol{n}$. We define the traction vector as $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$. Thus, on $\\Gamma_N$, $\\boldsymbol{t} = -p_{\\text{out}}(y)\\boldsymbol{n}$. The boundary integral reduces to:\n$$\n\\int_{\\Gamma_N} \\boldsymbol{t} \\cdot \\boldsymbol{w} \\,\\mathrm{d}S = \\int_{\\Gamma_N} (-p_{\\text{out}}(y)\\boldsymbol{n}) \\cdot \\boldsymbol{w} \\,\\mathrm{d}S\n$$\nCombining these parts, the weak form of the momentum equation is:\n$$\n\\int_{\\Omega} 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w}) \\,\\mathrm{d}\\Omega - \\int_{\\Omega} p\\,(\\nabla \\cdot \\boldsymbol{w}) \\,\\mathrm{d}\\Omega = \\int_{\\Gamma_N} \\boldsymbol{t} \\cdot \\boldsymbol{w} \\,\\mathrm{d}S\n$$\nFinally, we incorporate the incompressibility constraint $\\nabla \\cdot \\boldsymbol{u} = 0$. In a mixed formulation, we multiply it by a scalar pressure test function, $q$, and integrate over $\\Omega$. Since $\\nabla \\cdot \\boldsymbol{u} = 0$, this yields $\\int_{\\Omega} q\\,(\\nabla \\cdot \\boldsymbol{u}) \\,\\mathrm{d}\\Omega = 0$. Adding this null term to the left-hand side gives the final weak formulation as requested:\nFind $(\\boldsymbol{u}, p)$ such that for all valid test functions $(\\boldsymbol{w}, q)$:\n$$\n\\int_{\\Omega} 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{w})\\,\\mathrm{d}\\Omega - \\int_{\\Omega} p\\,\\nabla \\cdot \\boldsymbol{w}\\,\\mathrm{d}\\Omega + \\int_{\\Omega} q\\,\\nabla \\cdot \\boldsymbol{u}\\,\\mathrm{d}\\Omega = \\int_{\\Gamma_{N}} \\boldsymbol{t}\\cdot \\boldsymbol{w}\\,\\mathrm{d}S\n$$\nThe traction $\\boldsymbol{t}$ implied by the boundary condition is $\\boldsymbol{t} = -p_{\\text{out}}(y)\\boldsymbol{n}$. The natural boundary contribution functional on $\\Gamma_N$ is the right-hand side, which is:\n$$\n\\int_{\\Gamma_{N}} (-p_{\\text{out}}(y)\\boldsymbol{n}) \\cdot \\boldsymbol{w}\\,\\mathrm{d}S\n$$\n\n(b) Computation of the natural boundary contribution functional.\n\nWe are asked to compute the value of the functional $I_{\\Gamma_{N}}(\\boldsymbol{w}) \\equiv \\int_{\\Gamma_{N}} \\boldsymbol{t}\\cdot \\boldsymbol{w}\\,\\mathrm{d}S$ for a specific function $\\boldsymbol{w}(x,y) = \\begin{pmatrix} y(1-y) \\\\ x(1-x) \\end{pmatrix}$. It is worth noting that this function does not satisfy $\\boldsymbol{w}=\\boldsymbol{0}$ on all parts of the Dirichlet boundary $\\Gamma_D$ (e.g., at $(0.5, 0)$, $\\boldsymbol{w} \\neq \\boldsymbol{0}$), and thus is not a valid test function for the variational problem. However, the evaluation of the integral for this function is a well-posed mathematical task.\n\nThe boundary $\\Gamma_N$ is the segment where $x=1$ and $y \\in (0,1)$. The outward unit normal vector on this boundary is $\\boldsymbol{n} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. The line element is $\\mathrm{d}S = \\mathrm{d}y$.\nFrom part (a), the integrand is $\\boldsymbol{t} \\cdot \\boldsymbol{w} = (-p_{\\text{out}}(y)\\boldsymbol{n}) \\cdot \\boldsymbol{w}$.\nSubstituting the given functions and vectors:\n$$\n\\boldsymbol{t} \\cdot \\boldsymbol{w} = -\\left(1+y^2\\right)\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\cdot \\begin{pmatrix} y(1-y) \\\\ x(1-x) \\end{pmatrix}\n$$\nThe dot product evaluates to:\n$$\n\\boldsymbol{t} \\cdot \\boldsymbol{w} = -(1+y^2) \\left(1 \\cdot y(1-y) + 0 \\cdot x(1-x) \\right) = -(1+y^2)y(1-y)\n$$\nThe integral is evaluated over $\\Gamma_N$, so we must set $x=1$ in the expression for $\\boldsymbol{w}$, although in this case, the $w_y$ component is multiplied by zero anyway. The function $\\boldsymbol{w}$ on $\\Gamma_N$ is $\\boldsymbol{w}(1,y) = \\begin{pmatrix} y(1-y) \\\\ 1(1-1) \\end{pmatrix} = \\begin{pmatrix} y(1-y) \\\\ 0 \\end{pmatrix}$.\nThe integrand on $\\Gamma_N$ is:\n$$\n-(1+y^2)(y-y^2) = -(y - y^2 + y^3 - y^4) = y^4 - y^3 + y^2 - y\n$$\nWe now compute the definite integral over $y$ from $0$ to $1$:\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\int_{0}^{1} (y^4 - y^3 + y^2 - y) \\,\\mathrm{d}y\n$$\nUsing the power rule for integration:\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\left[ \\frac{y^5}{5} - \\frac{y^4}{4} + \\frac{y^3}{3} - \\frac{y^2}{2} \\right]_{0}^{1}\n$$\nEvaluating the expression at the limits of integration:\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\left( \\frac{1^5}{5} - \\frac{1^4}{4} + \\frac{1^3}{3} - \\frac{1^2}{2} \\right) - \\left( 0 \\right)\n$$\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\frac{1}{5} - \\frac{1}{4} + \\frac{1}{3} - \\frac{1}{2}\n$$\nTo find the final value, we use a common denominator, which is the least common multiple of $2$, $3$, $4$, and $5$, which is $60$.\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\frac{12}{60} - \\frac{15}{60} + \\frac{20}{60} - \\frac{30}{60} = \\frac{12 - 15 + 20 - 30}{60}\n$$\n$$\nI_{\\Gamma_{N}}(\\boldsymbol{w}) = \\frac{-3 + 20 - 30}{60} = \\frac{17 - 30}{60} = \\frac{-13}{60}\n$$\nThe value of the natural boundary contribution functional for the given function $\\boldsymbol{w}$ is $-\\frac{13}{60}$.",
            "answer": "$$\n\\boxed{-\\frac{13}{60}}\n$$"
        },
        {
            "introduction": "Our final practice problem shifts focus to the distinct challenges posed by hyperbolic systems, which are fundamental to modeling high-speed, compressible flows in aerospace. For these systems, boundary conditions cannot be prescribed arbitrarily; they are strictly determined by the physics of wave propagation into and out of the computational domain. This exercise  explores the characteristic analysis of the linearized Euler equations to determine the physically correct boundary condition for a subsonic outflow, a critical step in creating non-reflecting boundaries and ensuring the stability of the numerical solution.",
            "id": "4005907",
            "problem": "Consider the linearized isentropic Euler equations for small perturbations about a uniform, steady, one-dimensional ($1$-D) mean flow relevant to Computational Fluid Dynamics (CFD) in aerospace applications. Let the mean state be characterized by constant density $\\rho_{0} > 0$, constant pressure $p_{0} > 0$, constant flow speed $u_{0} > 0$, and constant sound speed $c_{0} > 0$, with subsonic mean flow satisfying $0 < u_{0} < c_{0}$. Denote the perturbations by $p'(x,t)$ and $u'(x,t)$, assumed sufficiently smooth, and adopt the isentropic closure so that the acoustic speed satisfies $c_{0}^{2} = \\gamma p_{0} / \\rho_{0}$ with $\\gamma > 1$ the ratio of specific heats. The linearized equations for $(p',u')$ are\n$$\np'_{t} + u_{0} \\, p'_{x} + \\rho_{0} c_{0}^{2} \\, u'_{x} = 0, \\qquad\nu'_{t} + u_{0} \\, u'_{x} + \\frac{1}{\\rho_{0}} \\, p'_{x} = 0,\n$$\non the spatial interval $x \\in (0,L)$ and time $t \\ge 0$, for some fixed $L>0$. Consider a Galerkin weak formulation: choose a test function $\\varphi(x) \\in H^{1}(0,L)$ and write the weak form by multiplying the system by $\\varphi$ and integrating by parts over $(0,L)$ in the spatial variable. Focus attention on the right boundary at $x=L$, where a physically admissible characteristic boundary condition must be imposed to ensure energy stability and non-reflection for the subsonic outflow.\n\nStarting from conservation of mass and momentum, the definition of sound speed, and the hyperbolic structure of the linearized system, derive the characteristic decomposition in the $x$-direction. Using an energy method with a symmetric positive definite symmetrizer appropriate for the isentropic acoustics subsystem and the boundary normal pointing in the positive $x$-direction at $x=L$, determine which characteristic is incoming at $x=L$ when $0 < u_{0} < c_{0}$. Then, for the purpose of formulating a non-reflecting characteristic boundary condition in the weak variational form, express the incoming characteristic combination at $x=L$ as a single linear expression in the primitive variables $p'$ and $u'$.\n\nYour final answer must be that single analytic expression, with all symbols as defined above. Do not provide an inequality or an equation; provide only the explicit linear combination of $p'$ and $u'$ corresponding to the incoming characteristic at $x=L$ in the specified subsonic regime.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n**Step 1: Extracted Givens**\n-   **System**: Linearized isentropic Euler equations for small perturbations $(p', u')$.\n-   **Equations**:\n    $$\n    p'_{t} + u_{0} \\, p'_{x} + \\rho_{0} c_{0}^{2} \\, u'_{x} = 0\n    $$\n    $$\n    u'_{t} + u_{0} \\, u'_{x} + \\frac{1}{\\rho_{0}} \\, p'_{x} = 0\n    $$\n-   **Domain**: $x \\in (0,L)$ and $t \\ge 0$.\n-   **Mean State**: Uniform with constant density $\\rho_{0} > 0$, constant pressure $p_{0} > 0$, constant flow speed $u_{0} > 0$, and constant sound speed $c_{0} > 0$.\n-   **Flow Regime**: Subsonic mean flow, $0 < u_{0} < c_{0}$.\n-   **Isentropic Closure**: $c_{0}^{2} = \\gamma p_{0} / \\rho_{0}$ with $\\gamma > 1$.\n-   **Objective**: At the right boundary $x=L$, identify the incoming characteristic and express it as a linear combination of $p'$ and $u'$.\n\n**Step 2: Validation**\nThe problem is scientifically grounded, as it deals with the linearized Euler equations, a standard model in fluid dynamics and acoustics. The concepts of characteristic decomposition and non-reflecting boundary conditions are fundamental to the theory and numerical solution of hyperbolic partial differential equations. All terms are well-defined, and the problem is mathematically self-contained and objective. There are no contradictions, missing data, or scientifically unsound premises.\n\n**Step 3: Verdict**\nThe problem is valid.\n\n**Solution Derivation**\nThe provided system of partial differential equations can be expressed in matrix-vector form. Let the state vector be $\\mathbf{q} = \\begin{pmatrix} p' \\\\ u' \\end{pmatrix}$. The system is then written as:\n$$\n\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x} = \\mathbf{0}\n$$\nwhere the coefficient matrix $\\mathbf{A}$ is given by:\n$$\n\\mathbf{A} = \\begin{pmatrix} u_{0} & \\rho_{0} c_{0}^{2} \\\\ \\frac{1}{\\rho_{0}} & u_{0} \\end{pmatrix}\n$$\nThe hyperbolic nature of this system is analyzed by finding the eigenvalues and eigenvectors of the matrix $\\mathbf{A}$. The eigenvalues, denoted by $\\lambda$, represent the characteristic speeds of wave propagation. They are found by solving the characteristic equation $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = 0$, where $\\mathbf{I}$ is the identity matrix.\n$$\n\\det \\begin{pmatrix} u_{0}-\\lambda & \\rho_{0} c_{0}^{2} \\\\ \\frac{1}{\\rho_{0}} & u_{0}-\\lambda \\end{pmatrix} = 0\n$$\nExpanding the determinant gives:\n$$\n(u_{0} - \\lambda)^{2} - \\left(\\rho_{0} c_{0}^{2}\\right) \\left(\\frac{1}{\\rho_{0}}\\right) = 0\n$$\n$$\n(u_{0} - \\lambda)^{2} - c_{0}^{2} = 0\n$$\n$$\nu_{0} - \\lambda = \\pm c_{0}\n$$\nThis yields two distinct real eigenvalues, confirming the system is strictly hyperbolic:\n$$\n\\lambda_{1} = u_{0} + c_{0}\n$$\n$$\n\\lambda_{2} = u_{0} - c_{0}\n$$\nThe problem asks for the incoming characteristic at the right boundary, $x=L$. At this boundary, the outward-pointing normal vector is in the positive $x$-direction. A characteristic is defined as \"incoming\" if its corresponding wave propagates into the domain, which means it travels in the negative $x$-direction. Therefore, an incoming characteristic is associated with a negative eigenvalue, $\\lambda < 0$.\n\nWe are given that the mean flow is subsonic, i.e., $0 < u_{0} < c_{0}$. We can determine the sign of each eigenvalue under this condition:\n-   For $\\lambda_{1} = u_{0} + c_{0}$: Since $u_{0} > 0$ and $c_{0} > 0$, it follows that $\\lambda_{1} > 0$. This corresponds to an outgoing characteristic. Information associated with this wave propagates out of the domain at $x=L$.\n-   For $\\lambda_{2} = u_{0} - c_{0}$: Since $u_{0} < c_{0}$, it follows that $\\lambda_{2} < 0$. This corresponds to an incoming characteristic. Information associated with this wave propagates into the domain at $x=L$.\n\nA physically-based, non-reflecting boundary condition requires that the amplitude of any incoming characteristic be specified. The problem asks for the expression of this incoming characteristic combination in terms of the primitive variables $p'$ and $u'$. This expression is found by determining the left eigenvector $\\mathbf{l}_{2}^{T}$ corresponding to the eigenvalue $\\lambda_{2}$.\n\nLet $\\mathbf{l}_{2}^{T} = \\begin{pmatrix} l_{a} & l_{b} \\end{pmatrix}$ be the left eigenvector for $\\lambda_{2}$. It must satisfy $\\mathbf{l}_{2}^{T} \\mathbf{A} = \\lambda_{2} \\mathbf{l}_{2}^{T}$.\n$$\n\\begin{pmatrix} l_{a} & l_{b} \\end{pmatrix} \\begin{pmatrix} u_{0} & \\rho_{0} c_{0}^{2} \\\\ \\frac{1}{\\rho_{0}} & u_{0} \\end{pmatrix} = (u_{0} - c_{0}) \\begin{pmatrix} l_{a} & l_{b} \\end{pmatrix}\n$$\nThis matrix equation yields a system of two linear algebraic equations for $l_{a}$ and $l_{b}$:\n1.  $l_{a} u_{0} + l_{b} \\frac{1}{\\rho_{0}} = l_{a} (u_{0} - c_{0}) \\implies \\frac{l_{b}}{\\rho_{0}} = -l_{a} c_{0} \\implies l_{b} = - \\rho_{0} c_{0} l_{a}$\n2.  $l_{a} \\rho_{0} c_{0}^{2} + l_{b} u_{0} = l_{b} (u_{0} - c_{0}) \\implies l_{a} \\rho_{0} c_{0}^{2} = -l_{b} c_{0} \\implies l_{a} \\rho_{0} c_{0} = -l_{b}$\n\nBoth equations give the same relationship, $l_{b} = - \\rho_{0} c_{0} l_{a}$. We can choose a convenient scaling, for example, $l_{a}=1$. Then $l_{b} = -\\rho_{0} c_{0}$. The left eigenvector is:\n$$\n\\mathbf{l}_{2}^{T} = \\begin{pmatrix} 1 & -\\rho_{0} c_{0} \\end{pmatrix}\n$$\nThe characteristic variable, or \"characteristic combination,\" $W_{2}$, is obtained by projecting the state vector $\\mathbf{q}$ onto the left eigenvector $\\mathbf{l}_{2}^{T}$:\n$$\nW_{2} = \\mathbf{l}_{2}^{T} \\mathbf{q} = \\begin{pmatrix} 1 & -\\rho_{0} c_{0} \\end{pmatrix} \\begin{pmatrix} p' \\\\ u' \\end{pmatrix} = p' - \\rho_{0} c_{0} u'\n$$\nThis expression, $p' - \\rho_{0} c_{0} u'$, is the linear combination corresponding to the incoming characteristic at the subsonic outflow boundary at $x=L$. This is the quantity that must be specified to form a well-posed, non-reflecting boundary condition. The energy method mentioned in the problem statement serves as a rigorous justification for this procedure, as it identifies which characteristic modes contribute negatively to the boundary energy flux, thus requiring control via boundary conditions to ensure stability. The analysis above, based on the sign of the eigenvalues of the flux Jacobian $\\mathbf{A}$, directly identifies these modes.",
            "answer": "$$\n\\boxed{p' - \\rho_{0} c_{0} u'}\n$$"
        }
    ]
}