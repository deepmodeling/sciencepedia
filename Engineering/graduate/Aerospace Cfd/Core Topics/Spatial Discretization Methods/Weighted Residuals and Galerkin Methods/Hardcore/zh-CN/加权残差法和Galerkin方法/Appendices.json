{
    "hands_on_practices": [
        {
            "introduction": "在有限元方法中，为了系统地处理复杂几何域，我们通常将任意形状的物理单元与一个简单的标准“参考单元”关联起来。这种关联通过一个坐标映射实现，而等参单元（isoparametric element）的概念正是这一过程的核心，它使用相同的形函数来描述单元的几何形状和单元内的解。本练习将引导你为高阶弯曲单元推导这一关键映射，并计算雅可比矩阵（Jacobian matrix），它是将加权余量法中的积分从物理空间转换到参考空间的关键。",
            "id": "4006148",
            "problem": "考虑一个用于计算流体动力学 (CFD) 的空气动力学网格中的二维弯曲邻近边界单元，该方法基于有限元法 (FEM) 和Galerkin加权残差法。该单元是一个二次六节点三角形，用于表示翼型的局部弯曲部分。参考单元是参数空间中的标准单位直角三角形，其局部坐标为 $\\boldsymbol{\\xi} = (\\xi,\\eta)$，顶点位于 $(0,0)$, $(1,0)$ 和 $(0,1)$。三个顶点节点和三个边中节点在物理空间中的位置如下\n$$\n(x_1,y_1) = (0,0),\\quad (x_2,y_2) = (2.0,0.0),\\quad (x_3,y_3) = (0.0,2.0),\n$$\n$$\n(x_4,y_4) = (1.0,0.2),\\quad (x_5,y_5) = (0.7,1.3),\\quad (x_6,y_6) = (0.2,1.0),\n$$\n其中，节点 $1$, $2$, $3$ 分别是对应于参考三角形上 $(\\xi,\\eta) = (0,0)$, $(1,0)$ 和 $(0,1)$ 的顶点，而节点 $4$, $5$, $6$ 分别是对应于 $(\\xi,\\eta) = (0.5,0)$, $(0.5,0.5)$ 和 $(0,0.5)$ 的边中节点。\n\n从等参数概念的基本定义出发，即用于解的近似的多项式基与用于插值几何形状的多项式基相同，执行以下操作：\n\n1. 对此弯曲六节点三角形单元，根据定义在参考三角形上的二次拉格朗日形函数，推导其等参数映射 $\\boldsymbol{x}(\\boldsymbol{\\xi}) = (x(\\xi,\\eta),y(\\xi,\\eta))$。清晰地表达如何从节点坐标插值得到几何形状。\n\n2. 使用该映射，计算在参考三角形形心 $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的雅可比矩阵\n$$\n\\boldsymbol{J}(\\xi,\\eta) = \\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix},\n$$\n及其行列式 $J(\\xi,\\eta) = \\det \\boldsymbol{J}(\\xi,\\eta)$。\n\n3. 解释在Galerkin加权残差法下，雅可比行列式在变换弱形式积分中的作用，特别是单元 $E$ 上的局部 $L^{2}$ 内积\n$$\nI \\;=\\; \\int_{E} N_1(\\boldsymbol{x})\\,N_1(\\boldsymbol{x}) \\,\\mathrm{d}\\Omega,\n$$\n其中 $N_1$ 是与节点 $1$ 相关的单元的第一个二次形函数，$\\mathrm{d}\\Omega$ 是物理面积微分。\n\n4. 在参考三角形上使用单点求积（对线性多项式精确），通过在形心 $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处求值来近似变换后的积分，其中求积权重等于参考三角形的面积。将 $I$ 的近似值的最终答案表示为一个精确的有理数。不包含任何物理单位，也不要四舍五入；以最简分数形式给出精确值。",
            "solution": "有限元法 (FEM) 中的等参数概念将几何形状和解的近似设置在同一个多项式空间上。对于一个二次六节点三角形单元，几何形状通过二次拉格朗日形函数从参考三角形映射到物理三角形。将参考面积（重心）坐标记为 $L_1 = 1 - \\xi - \\eta$, $L_2 = \\xi$, and $L_3 = \\eta$。参考三角形上的六个二次拉格朗日形函数为\n$$\nN_1 = L_1\\,(2L_1 - 1),\\quad\nN_2 = L_2\\,(2L_2 - 1),\\quad\nN_3 = L_3\\,(2L_3 - 1),\n$$\n$$\nN_4 = 4\\,L_1\\,L_2,\\quad\nN_5 = 4\\,L_2\\,L_3,\\quad\nN_6 = 4\\,L_3\\,L_1.\n$$\n通过几何的等参数插值，从参考坐标 $\\boldsymbol{\\xi}=(\\xi,\\eta)$ 到物理坐标 $\\boldsymbol{x}=(x,y)$ 的映射为\n$$\nx(\\xi,\\eta) \\;=\\; \\sum_{i=1}^{6} N_i(\\xi,\\eta)\\,x_i,\\qquad\ny(\\xi,\\eta) \\;=\\; \\sum_{i=1}^{6} N_i(\\xi,\\eta)\\,y_i,\n$$\n其中 $(x_i,y_i)$ 是单元的物理节点坐标。\n\n该映射的雅可比矩阵为\n$$\n\\boldsymbol{J}(\\xi,\\eta) \\;=\\;\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,x_i & \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,x_i \\\\\n\\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,y_i & \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,y_i\n\\end{pmatrix}.\n$$\n我们现在计算参考三角形形心 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处形函数的导数。在形心处，重心坐标为 $L_1=L_2=L_3=\\frac{1}{3}$。形心处的形函数值为：\n$$\nN_1 = \\frac{1}{3}\\left(\\frac{2}{3} - 1\\right) = -\\frac{1}{9},\\quad\nN_2 = -\\frac{1}{9},\\quad\nN_3 = -\\frac{1}{9},\\quad\nN_4 = \\frac{4}{9},\\quad\nN_5 = \\frac{4}{9},\\quad\nN_6 = \\frac{4}{9}.\n$$\n重心坐标的导数为\n$$\n\\frac{\\partial L_1}{\\partial \\xi} = -1,\\quad \\frac{\\partial L_1}{\\partial \\eta} = -1,\\qquad\n\\frac{\\partial L_2}{\\partial \\xi} = 1,\\quad \\frac{\\partial L_2}{\\partial \\eta} = 0,\\qquad\n\\frac{\\partial L_3}{\\partial \\xi} = 0,\\quad \\frac{\\partial L_3}{\\partial \\eta} = 1.\n$$\n使用乘法法则和链式法则，在 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处形函数的导数为：\n- 对于 $N_1 = L_1(2L_1 - 1)$,\n$$\n\\frac{\\partial N_1}{\\partial \\xi} = (4 L_1 - 1)\\frac{\\partial L_1}{\\partial \\xi} = -\\frac{1}{3},\\qquad\n\\frac{\\partial N_1}{\\partial \\eta} = (4 L_1 - 1)\\frac{\\partial L_1}{\\partial \\eta} = -\\frac{1}{3}.\n$$\n- 对于 $N_2 = L_2(2L_2 - 1)$,\n$$\n\\frac{\\partial N_2}{\\partial \\xi} = (4 L_2 - 1)\\frac{\\partial L_2}{\\partial \\xi} = \\frac{1}{3},\\qquad\n\\frac{\\partial N_2}{\\partial \\eta} = 0.\n$$\n- 对于 $N_3 = L_3(2L_3 - 1)$,\n$$\n\\frac{\\partial N_3}{\\partial \\xi} = 0,\\qquad\n\\frac{\\partial N_3}{\\partial \\eta} = (4 L_3 - 1)\\frac{\\partial L_3}{\\partial \\eta} = \\frac{1}{3}.\n$$\n- 对于 $N_4 = 4 L_1 L_2$,\n$$\n\\frac{\\partial N_4}{\\partial \\xi} = 4(L_1\\frac{\\partial L_2}{\\partial \\xi} + \\frac{\\partial L_1}{\\partial \\xi}L_2) = 4(L_1 - L_2) = 0,\\qquad\n\\frac{\\partial N_4}{\\partial \\eta} = 4(L_1\\frac{\\partial L_2}{\\partial \\eta} + \\frac{\\partial L_1}{\\partial \\eta}L_2) = -4 L_2 = -\\frac{4}{3}.\n$$\n- 对于 $N_5 = 4 L_2 L_3$,\n$$\n\\frac{\\partial N_5}{\\partial \\xi} = 4(L_2\\frac{\\partial L_3}{\\partial \\xi} + \\frac{\\partial L_2}{\\partial \\xi}L_3) = 4 L_3 = \\frac{4}{3},\\qquad\n\\frac{\\partial N_5}{\\partial \\eta} = 4(L_2\\frac{\\partial L_3}{\\partial \\eta} + \\frac{\\partial L_2}{\\partial \\eta}L_3) = 4 L_2 = \\frac{4}{3}.\n$$\n- 对于 $N_6 = 4 L_3 L_1$,\n$$\n\\frac{\\partial N_6}{\\partial \\xi} = 4(L_3\\frac{\\partial L_1}{\\partial \\xi} + \\frac{\\partial L_3}{\\partial \\xi}L_1) = -4 L_3 = -\\frac{4}{3},\\qquad\n\\frac{\\partial N_6}{\\partial \\eta} = 4(L_3\\frac{\\partial L_1}{\\partial \\eta} + \\frac{\\partial L_3}{\\partial \\eta}L_1) = 4(L_1 - L_3) = 0.\n$$\n利用给定的节点坐标，我们计算形心处的雅可比矩阵各项。首先，对于 $\\frac{\\partial x}{\\partial \\xi}$：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,x_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 2 + 0\\cdot 0 + 0\\cdot 1 + \\left(\\frac{4}{3}\\right)\\cdot 0.7 + \\left(-\\frac{4}{3}\\right)\\cdot 0.2\n= \\frac{4}{3}.\n$$\n接着，对于 $\\frac{\\partial x}{\\partial \\eta}$：\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,x_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 2 + \\left(\\frac{1}{3}\\right)\\cdot 0 + \\left(-\\frac{4}{3}\\right)\\cdot 1 + \\left(\\frac{4}{3}\\right)\\cdot 0.7 + 0\\cdot 0.2\n= -\\frac{2}{5}.\n$$\n对于 $\\frac{\\partial y}{\\partial \\xi}$：\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,y_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 2 + 0\\cdot 0.2 + \\left(\\frac{4}{3}\\right)\\cdot 1.3 + \\left(-\\frac{4}{3}\\right)\\cdot 1.0\n= \\frac{2}{5}.\n$$\n对于 $\\frac{\\partial y}{\\partial \\eta}$：\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,y_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 2 + \\left(-\\frac{4}{3}\\right)\\cdot 0.2 + \\left(\\frac{4}{3}\\right)\\cdot 1.3 + 0\\cdot 1.0\n= \\frac{32}{15}.\n$$\n因此，在 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的雅可比矩阵为\n$$\n\\boldsymbol{J}\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\n=\n\\begin{pmatrix}\n\\frac{4}{3} & -\\frac{2}{5} \\\\\n\\frac{2}{5} & \\frac{32}{15}\n\\end{pmatrix},\n$$\n其行列式为\n$$\nJ\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\n= \\left(\\frac{4}{3}\\right)\\left(\\frac{32}{15}\\right) - \\left(-\\frac{2}{5}\\right)\\left(\\frac{2}{5}\\right)\n= \\frac{128}{45} + \\frac{4}{25}\n= \\frac{640 + 36}{225} = \\frac{676}{225}.\n$$\n\n在Galerkin加权残差法下，雅可比行列式在变换弱形式积分中的作用由变量替换公式给出。对于定义在弯曲物理单元 $E$ 上的任意被积函数 $g(\\boldsymbol{x})$，面积分变换到参考单元 $\\hat{E}$ 上为\n$$\n\\int_{E} g(\\boldsymbol{x})\\,\\mathrm{d}\\Omega\n=\n\\int_{\\hat{E}} g\\big(\\boldsymbol{x}(\\boldsymbol{\\xi})\\big)\\,\\big|J(\\boldsymbol{\\xi})\\big|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\n其中 $\\big|J(\\boldsymbol{\\xi})\\big| = \\det\\boldsymbol{J}(\\boldsymbol{\\xi})$ 解释了由映射引起的局部度量畸变和面积缩放。\n\n对于单元上指定的弱形式内积，\n$$\nI = \\int_{E} N_1(\\boldsymbol{x})\\,N_1(\\boldsymbol{x})\\,\\mathrm{d}\\Omega,\n$$\n在参考单元上的变换积分为\n$$\nI = \\int_{\\hat{E}} N_1(\\xi,\\eta)^2 \\,\\big|J(\\xi,\\eta)\\big|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta.\n$$\n在形心 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处使用单点求积，其权重等于参考三角形的面积，\n$$\nw = \\text{area}(\\hat{E}) = \\frac{1}{2},\n$$\n我们得到近似值\n$$\nI \\;\\approx\\; w \\; N_1\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)^{2}\\; \\bigg|J\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\\bigg|.\n$$\n我们已经计算出 $N_1\\left(\\frac{1}{3},\\frac{1}{3}\\right) = -\\frac{1}{9}$ 和 $J\\left(\\frac{1}{3},\\frac{1}{3}\\right) = \\frac{676}{225}$。因此，\n$$\nI \\;\\approx\\; \\frac{1}{2} \\left(-\\frac{1}{9}\\right)^{2} \\cdot \\frac{676}{225}\n\\;=\\;\n\\frac{1}{2}\\cdot \\frac{1}{81} \\cdot \\frac{676}{225}\n\\;=\\;\n\\frac{676}{2 \\cdot 81 \\cdot 225}\n\\;=\\;\n\\frac{676}{36450}\n\\;=\\;\n\\frac{338}{18225}.\n$$\n这是在弯曲单元上局部 $L^{2}$ 内积的指定单点求积近似的精确有理数值。",
            "answer": "$$\\boxed{\\frac{338}{18225}}$$"
        },
        {
            "introduction": "高阶有限元方法虽然能提供卓越的精度，但其代价是每个单元内部会引入大量只属于该单元的自由度（DOFs）。静态凝聚（static condensation）是一种源于加权余量原理的巧妙代数技术，它允许我们在全局组装之前，在单元级别上消除这些内部自由度。本练习将带你完整地推导凝聚方程，并通过一个具体的数值算例来实践这一过程，让你深刻理解其如何大幅减小最终需求解的全局系统规模。",
            "id": "4006100",
            "problem": "考虑一个一维稳态扩散模型，该模型可作为航空航天计算流体力学（CFD）中高阶伽辽金离散化产生的粘性扩散或压力泊松子问题的代理模型。在一个物理范围由参考区间映射而来的单元 $e$ 上，其强形式为 $-\\frac{d}{dx}\\left(\\kappa(x)\\frac{du}{dx}\\right)=s(x)$，并带有适当的边界条件。使用伽辽金加权残差原理，将强形式方程乘以一个与试探函数来自同一空间的检验函数 $w$（标准伽辽金选择），并在单元 $e$ 上进行分部积分，从而得到单元的双线性形式和线性形式，即弱形式。假设在每个单元上使用高阶多项式基，其自由度（DOF）分为两组：位于单元边界上的界面（或边界）自由度，其系数向量记为 $u_{b}$；以及严格位于单元内部的内部自由度，其系数向量记为 $u_{i}$。在组装单元级贡献后，单元代数系统呈现出如下分块结构：\n$$\n\\begin{pmatrix}\nK_{bb} & K_{bi} \\\\\nK_{ib} & K_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\nu_{b} \\\\\nu_{i}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf_{b} \\\\\nf_{i}\n\\end{pmatrix},\n$$\n其中 $K_{bb}$、$K_{bi}$、$K_{ib}$ 和 $K_{ii}$ 是源于双线性形式的单元刚度子块，$f_{b}$ 和 $f_{i}$ 是源于线性形式的相应载荷子向量。假设 $K_{ii}$ 是非奇异的，对于具有良定内部约束的标准扩散算子而言，情况确实如此。\n\n任务 A：从伽辽金弱形式和上述分块系统出发，利用加权残差原理和线性代数在单元层面消去 $u_{i}$。推导仅用 $u_{b}$ 和单元数据表示的凝聚方程。你的推导必须明确展示消元过程如何减少全局耦合自由度的数量，并识别出将 $u_b$ 映射到凝聚残差的算子。\n\n任务 B：为了使简化过程具体化，考虑一个具有以下一致且对称子块的单元（所有条目均为无量纲，并通过特征单元长度和扩散系数进行了无量纲化）：\n$$\nK_{bb}=\\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix},\\quad\nK_{bi}=\\begin{pmatrix} -1 & 0 \\\\ 0 & -1 \\end{pmatrix},\\quad\nK_{ii}=\\begin{pmatrix} 3 & 1 \\\\ 1 & 2 \\end{pmatrix}.\n$$\n假设单元载荷为零，即 $f_{b}=\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 和 $f_{i}=\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。使用任务 A 的结果，计算此单元的静态凝聚边界刚度的迹。以单个实数的形式给出你的最终答案。不要四舍五入，报告精确值。",
            "solution": "**任务 A：凝聚系统的推导**\n\n问题始于从一维扩散方程的伽辽金加权残差公式推导出的单元代数系统。该系统根据自由度的物理位置进行划分：边界（或界面）自由度（系数向量为 $u_b$）和内部自由度（系数向量为 $u_i$）。其分块矩阵形式代表两个耦合的线性方程组：\n$$\nK_{bb}u_{b} + K_{bi}u_{i} = f_{b} \\quad (1)\n$$\n$$\nK_{ib}u_{b} + K_{ii}u_{i} = f_{i} \\quad (2)\n$$\n方程（1）表示与边界自由度相关联的检验函数所对应的加权残差方程，而方程（2）则对应与内部自由度相关联的检验函数。目标是消去内部自由度 $u_i$，推导出一个只涉及边界自由度 $u_b$ 的系统。\n\n从方程（2），我们可以形式上解出 $u_i$。由于 $K_{ii}$ 是非奇异的，其逆矩阵 $K_{ii}^{-1}$ 存在。方程两边同时左乘 $K_{ii}^{-1}$，我们得到内部自由度的显式表达式：\n$$\nu_{i} = K_{ii}^{-1}(f_{i} - K_{ib}u_{b}) \\quad (3)\n$$\n这个方程表明，单元内部解的行为完全由单元边界上的解（$u_b$）和单元内部的载荷（$f_i$）所决定。\n\n接下来，我们将这个 $u_i$ 的表达式代回方程（1）：\n$$\nK_{bb}u_{b} + K_{bi} \\left[ K_{ii}^{-1}(f_{i} - K_{ib}u_{b}) \\right] = f_{b}\n$$\n重排方程，将所有包含 $u_b$ 的项收集到左边，其余项收集到右边：\n$$\nK_{bb}u_{b} - K_{bi}K_{ii}^{-1}K_{ib}u_{b} = f_{b} - K_{bi}K_{ii}^{-1}f_{i}\n$$\n提取公因子 $u_b$ 得到凝聚方程：\n$$\n(K_{bb} - K_{bi}K_{ii}^{-1}K_{ib}) u_{b} = f_{b} - K_{bi}K_{ii}^{-1}f_{i}\n$$\n这就是所求的方程。我们可以定义凝聚（或等效）刚度矩阵 $\\tilde{K}$ 和凝聚（或等效）载荷向量 $\\tilde{f}$：\n$$\n\\tilde{K} = K_{bb} - K_{bi}K_{ii}^{-1}K_{ib}\n$$\n$$\n\\tilde{f} = f_{b} - K_{bi}K_{ii}^{-1}f_{i}\n$$\n于是，凝聚系统可以紧凑地写为 $\\tilde{K}u_b = \\tilde{f}$。矩阵 $\\tilde{K}$ 是原始刚度矩阵中块 $K_{ii}$ 的舒尔补。\n\n这个过程减少了全局耦合自由度的数量，因为内部自由度 $u_i$ 只存在于单元内部，不参与相邻单元之间的耦合。通过在单元层面消去 $u_i$，我们可以只使用凝聚矩阵 $\\tilde{K}$ 来组装一个规模显著减小的全局系统，从而减少全局求解阶段的内存需求和计算成本。将 $u_b$ 映射到凝聚残差中依赖于 $u_b$ 的部分的算子，就是凝聚刚度矩阵 $\\tilde{K}$。\n\n**任务 B：凝聚刚度矩阵迹的计算**\n\n给定单元的子块：\n$$\nK_{bb}=\\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix},\\quad\nK_{bi}=\\begin{pmatrix} -1 & 0 \\\\ 0 & -1 \\end{pmatrix},\\quad\nK_{ii}=\\begin{pmatrix} 3 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\n对于对称的伽辽金公式，刚度矩阵是对称的，这意味着 $K_{ib} = K_{bi}^{T}$。由于给定的 $K_{bi}$ 是对称的，我们有 $K_{ib} = K_{bi} = -I$，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n\n首先，我们计算 $K_{ii}$ 的逆矩阵。\n其行列式为 $\\det(K_{ii}) = (3)(2) - (1)(1) = 5$。\n其逆矩阵为：\n$$\nK_{ii}^{-1} = \\frac{1}{5}\\begin{pmatrix} 2 & -1 \\\\ -1 & 3 \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{5} & -\\frac{1}{5} \\\\ -\\frac{1}{5} & \\frac{3}{5} \\end{pmatrix}\n$$\n现在我们计算凝聚刚度矩阵 $\\tilde{K} = K_{bb} - K_{bi}K_{ii}^{-1}K_{ib}$。\n由于 $K_{bi} = K_{ib} = -I$，舒尔补项变为 $S = (-I) K_{ii}^{-1} (-I) = K_{ii}^{-1}$。\n$$\nS = \\begin{pmatrix} \\frac{2}{5} & -\\frac{1}{5} \\\\ -\\frac{1}{5} & \\frac{3}{5} \\end{pmatrix}\n$$\n现在计算凝聚刚度矩阵 $\\tilde{K}$：\n$$\n\\tilde{K} = K_{bb} - S = \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} - \\begin{pmatrix} \\frac{2}{5} & -\\frac{1}{5} \\\\ -\\frac{1}{5} & \\frac{3}{5} \\end{pmatrix}\n$$\n$$\n\\tilde{K} = \\begin{pmatrix} 2 - \\frac{2}{5} & -1 - (-\\frac{1}{5}) \\\\ -1 - (-\\frac{1}{5}) & 2 - \\frac{3}{5} \\end{pmatrix}\n= \\begin{pmatrix} \\frac{8}{5} & -\\frac{4}{5} \\\\ -\\frac{4}{5} & \\frac{7}{5} \\end{pmatrix}\n$$\n最后，计算 $\\tilde{K}$ 的迹，即其对角元素之和：\n$$\n\\text{tr}(\\tilde{K}) = \\frac{8}{5} + \\frac{7}{5} = \\frac{15}{5} = 3\n$$\n此单元的静态凝聚边界刚度的迹为 $3$。载荷项为零不影响刚度矩阵 $\\tilde{K}$ 的计算。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "当我们将伽辽金法应用于流体动力学中普遍存在的非线性问题时，会遇到一个微妙但至关重要的问题，即“混淆误差”（aliasing error）。这种误差源于对非线性项的数值积分处理不当，可能导致非物理的能量增长，并最终破坏解的稳定性。本练习通过对多项式次数的分析，让你亲身体验混淆误差的来源，并探讨如“过积分”（over-integration）等有效的缓解策略。",
            "id": "4006094",
            "problem": "考虑一个代表计算流体力学中非线性对流行为的标量守恒律，该守恒律在一维周期性域 $\\Omega$ 上由 $\\partial_t u + \\partial_x f(u) = 0$ 给出，其中 $f(u) = \\tfrac{1}{2} u^2$。设近似解 $u_h(x,t)$ 位于每个单元上次数为 $p$ 的多项式空间中，并考虑一个标准的伽辽金加权残差法，其检验函数 $\\phi_i \\in \\mathcal{P}^p$，即次数至多为 $p$ 的多项式空间。通过分部积分得到的半离散弱形式为 $ \\int_{\\Omega} \\phi_i \\, \\partial_t u_h \\, dx - \\int_{\\Omega} \\partial_x \\phi_i \\, f(u_h) \\, dx = 0$，其中周期性导致边界项消失。假设体积积分使用每个单元 $Q$ 个点的高斯-勒让德求积法计算，该方法对于次数最高为 $2Q - 1$ 的多项式是精确的。\n\n请通过上述加权残差框架和多项式次数计算进行推理，解释非线性项的积分不足如何导致高阶伽辽金方法中出现混叠误差，并确定基于第一性原理的有效缓解策略。具体来说，确定非线性项中体积被积函数的多项式次数，并将其与求积精确度要求联系起来，讨论混叠在已解析和未解析尺度之间传递能量的机制，并描述过积分和精心构造的分裂形式如何抑制这些误差并提高稳定性。\n\n选择所有正确的陈述。\n\nA. 对于 $f(u) = \\tfrac{1}{2} u^2$ 和 $u_h \\in \\mathcal{P}^p$，弱形式的体积被积函数 $(-\\partial_x \\phi_i) \\, f(u_h)$ 的多项式次数最高可达 $3p - 1$，因此高斯-勒让德求积法必须满足 $2Q - 1 \\ge 3p - 1$（即 $Q \\ge \\lceil \\tfrac{3p}{2} \\rceil$）以避免非线性项的积分不足。如果 $Q$ 较小（例如，当 $p > 2$ 时，$Q = p + 1$），离散内积会失去精确性，高次内容会折叠到低阶模态上，并发生非物理的能量传递。满足 $2Q - 1 \\ge 3p - 1$ 的过积分以及分裂或斜对称形式可以恢复离散抵消特性并缓解混叠驱动的不稳定性。\n\nB. 可以通过在插值节点上计算 $f(u_h)$，然后在每个单元中移除最高的 $p$ 个模态系数来消除混叠。这必然会将格式的精度降低到一阶，但可以防止已解析尺度的能量污染；因此，这是高阶伽辽金方法中的首选方法。\n\nC. 将守恒律写成强形式，并使用精确的微分矩阵对 $\\partial_x f(u_h)$ 进行离散化，可以自动消除混叠，无论使用何种求积法，因为微分是线性操作，而线性算子不会在多项式模态之间引入非线性耦合。\n\nD. 基于两点通量函数构建的熵守恒分裂形式，与满足离散分部求和（SBP）性质的求积法和节点集一起，可以通过强制执行凸熵的离散守恒及相关稳定性来抑制混叠，即使当非线性项在其他情况下会超出朴素弱形式的求积精度时也是如此。\n\nE. 在仿射单元上（其中从参考单元的几何映射是线性的），过积分是不必要的，因为映射不会增加被积函数的次数；因此，如果对所有体积积分使用 $Q = p + 1$，无论非线性通量函数如何，都不会发生混叠。",
            "solution": "为了确定正确的陈述，我们首先分析伽辽金弱形式中非线性项的积分。被积函数为 $(\\partial_x \\phi_i) f(u_h)$。\n1.  由于近似解 $u_h$ 和检验函数 $\\phi_i$ 都在次数为 $p$ 的多项式空间 $\\mathcal{P}^p$ 中，因此检验函数的导数 $\\partial_x \\phi_i$ 的次数最高为 $p-1$。\n2.  非线性通量项 $f(u_h) = \\frac{1}{2}u_h^2$ 的次数最高为 $2p$。\n3.  因此，被积函数 $(\\partial_x \\phi_i) f(u_h)$ 的总多项式次数最高为 $(p-1) + 2p = 3p-1$。\n\n一个具有 $Q$ 个点的高斯-勒让德求积法对于次数最高为 $2Q-1$ 的多项式是精确的。为了精确计算该积分，必须满足 $2Q-1 \\ge 3p-1$，即 $Q \\ge \\lceil \\frac{3p}{2} \\rceil$。如果使用的求积点数不足（积分不足），例如当 $p>2$ 时使用通常用于线性问题的 $Q=p+1$，那么多项式中次数高于 $2Q-1$ 的部分将不会被精确积分。其能量会错误地“折叠”或“混淆”到低次模态上，破坏离散守恒性，并可能导致非物理的能量增长和数值不稳定性。\n\n基于此分析，我们评估各个选项：\n\n-   **A**: 该陈述准确地计算了被积函数的次数（$3p-1$），并推导出了正确的求积要求（$Q \\ge \\lceil \\frac{3p}{2} \\rceil$）。它正确地描述了积分不足导致混叠和能量传递的机制，并指出了“过积分”（使用足够多的求积点）和使用“分裂/斜对称形式”作为有效的缓解策略。因此，该陈述是正确的。\n\n-   **B**: 该陈述提出了一种滤波方法，但错误地声称这必然会将精度降低到一阶。设计良好的去混叠滤波器旨在保持高阶精度，因此这种说法不正确，也使其不是“首选方法”。因此，该陈述是错误的。\n\n-   **C**: 该陈述错误地认为使用强形式（配置法）可以消除混叠。混叠源于对非线性函数 $f(u_h)$ 的不完全表示，这个问题在应用微分算子之前就已经存在。无论采用强形式还是弱形式，这个问题都依然存在。因此，该陈述是错误的。\n\n-   **D**: 该陈述描述了基于熵守恒分裂形式和离散分部求和（SBP）性质的先进方法。这些方法通过在离散层面强制执行熵守恒（或耗散），确实能够抑制由混叠引起的非线性不稳定性，即使在积分不足的情况下也是如此。这是一个准确的高级数值方法描述。因此，该陈述是正确的。\n\n-   **E**: 该陈述错误地认为在仿射单元上不需要过积分。虽然仿射映射的雅可比行列式是常数，不会增加被积函数的多项式次数，但这并未解决由偏微分方程本身非线性（即 $u^2$ 项）引起的高次项问题。混叠的根本原因仍然存在。因此，该陈述是错误的。\n\n综上所述，陈述A和D是正确的。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}