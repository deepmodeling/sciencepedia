{
    "hands_on_practices": [
        {
            "introduction": "Real-world aerospace problems, such as analyzing flow over an airfoil, involve curved boundaries that must be accurately represented in a computational mesh. The isoparametric concept is a cornerstone of the finite element method that allows us to use simple, computationally convenient \"reference\" elements to model these complex curved geometries. This practice provides a concrete walk-through of this mapping process, where you will compute the Jacobian matrix and its determinant—a crucial quantity that links integrals in the physical domain to the reference domain, forming the basis of all Galerkin system computations on general meshes. ",
            "id": "4006148",
            "problem": "Consider a two-dimensional curved boundary-adjacent element in an aerodynamics mesh used for Computational Fluid Dynamics (CFD) based on the Finite Element Method (FEM) with the Galerkin weighted residual approach. The element is a quadratic six-node triangle used to represent a locally curved portion of an airfoil. The reference element is the standard unit right triangle in the parameter space with local coordinates $\\boldsymbol{\\xi} = (\\xi,\\eta)$ and vertices at $(0,0)$, $(1,0)$, and $(0,1)$. The three vertex nodes and three midside nodes are positioned in physical space at\n$$\n(x_1,y_1) = (0,0),\\quad (x_2,y_2) = (2.0,0.0),\\quad (x_3,y_3) = (0.0,2.0),\n$$\n$$\n(x_4,y_4) = (1.0,0.2),\\quad (x_5,y_5) = (0.7,1.3),\\quad (x_6,y_6) = (0.2,1.0),\n$$\nwhere nodes $1$, $2$, and $3$ are the vertices corresponding to $(\\xi,\\eta) = (0,0)$, $(1,0)$, and $(0,1)$, respectively, and nodes $4$, $5$, and $6$ are the midside nodes corresponding to $(\\xi,\\eta) = (0.5,0)$, $(0.5,0.5)$, and $(0,0.5)$, respectively, on the reference triangle.\n\nStarting from the fundamental definition of the isoparametric concept, where the same polynomial basis used for the solution approximation is used to interpolate geometry, perform the following:\n\n1. Derive the isoparametric mapping $\\boldsymbol{x}(\\boldsymbol{\\xi}) = (x(\\xi,\\eta),y(\\xi,\\eta))$ for this curved six-node triangular element in terms of quadratic Lagrange shape functions defined on the reference triangle. Clearly express how the geometry is interpolated from the nodal coordinates.\n\n2. Using the mapping, compute the Jacobian matrix \n$$\n\\boldsymbol{J}(\\xi,\\eta) = \\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix},\n$$\nand its determinant $J(\\xi,\\eta) = \\det \\boldsymbol{J}(\\xi,\\eta)$ at the centroid of the reference triangle $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$.\n\n3. Explain the role of the Jacobian determinant in transforming weak integrals under the Galerkin weighted residual method, specifically the local $L^{2}$ inner product on the element $E$,\n$$\nI \\;=\\; \\int_{E} N_1(\\boldsymbol{x})\\,N_1(\\boldsymbol{x}) \\,\\mathrm{d}\\Omega,\n$$\nwhere $N_1$ is the element’s first quadratic shape function associated with node $1$, and $\\mathrm{d}\\Omega$ is the physical area differential.\n\n4. Using one-point quadrature on the reference triangle (exact for linear polynomials), approximate the transformed integral by evaluating at the centroid $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$, with the quadrature weight equal to the area of the reference triangle. Express your final answer for the approximate value of $I$ as an exact rational number. Do not include any physical units, and do not round; provide the exact value in simplest fractional form.",
            "solution": "The isoparametric concept in the Finite Element Method (FEM) sets the geometry and the solution approximation on the same polynomial space. For a quadratic six-node triangular element, the geometry is mapped from the reference triangle to the physical triangle using the quadratic Lagrange shape functions. Denote the reference-area (barycentric) coordinates by $L_1 = 1 - \\xi - \\eta$, $L_2 = \\xi$, and $L_3 = \\eta$. The six quadratic Lagrange shape functions on the reference triangle are\n$$\nN_1 = L_1\\,(2L_1 - 1),\\quad\nN_2 = L_2\\,(2L_2 - 1),\\quad\nN_3 = L_3\\,(2L_3 - 1),\n$$\n$$\nN_4 = 4\\,L_1\\,L_2,\\quad\nN_5 = 4\\,L_2\\,L_3,\\quad\nN_6 = 4\\,L_3\\,L_1.\n$$\nBy the isoparametric interpolation of geometry, the mapping from the reference coordinates $\\boldsymbol{\\xi}=(\\xi,\\eta)$ to the physical coordinates $\\boldsymbol{x}=(x,y)$ is\n$$\nx(\\xi,\\eta) \\;=\\; \\sum_{i=1}^{6} N_i(\\xi,\\eta)\\,x_i,\\qquad\ny(\\xi,\\eta) \\;=\\; \\sum_{i=1}^{6} N_i(\\xi,\\eta)\\,y_i,\n$$\nwhere $(x_i,y_i)$ are the physical nodal coordinates of the element.\n\nThe Jacobian matrix of the mapping is\n$$\n\\boldsymbol{J}(\\xi,\\eta) \\;=\\;\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,x_i  \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,x_i \\\\\n\\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,y_i  \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,y_i\n\\end{pmatrix}.\n$$\nWe now compute the derivatives of the shape functions at the centroid of the reference triangle, $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$. At the centroid, the barycentric coordinates are $L_1=L_2=L_3=\\frac{1}{3}$. The shape function values at the centroid are:\n$$\nN_1 = \\frac{1}{3}\\left(\\frac{2}{3} - 1\\right) = -\\frac{1}{9},\\quad\nN_2 = -\\frac{1}{9},\\quad\nN_3 = -\\frac{1}{9},\\quad\nN_4 = \\frac{4}{9},\\quad\nN_5 = \\frac{4}{9},\\quad\nN_6 = \\frac{4}{9}.\n$$\nThe derivatives of the barycentric coordinates are\n$$\n\\frac{\\partial L_1}{\\partial \\xi} = -1,\\quad \\frac{\\partial L_1}{\\partial \\eta} = -1,\\qquad\n\\frac{\\partial L_2}{\\partial \\xi} = 1,\\quad \\frac{\\partial L_2}{\\partial \\eta} = 0,\\qquad\n\\frac{\\partial L_3}{\\partial \\xi} = 0,\\quad \\frac{\\partial L_3}{\\partial \\eta} = 1.\n$$\nUsing product rule and chain rule, the derivatives of the shape functions at $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ are:\n- For $N_1 = L_1(2L_1 - 1)$,\n$$\n\\frac{\\partial N_1}{\\partial \\xi} = -4 L_1 + 1 = -\\frac{1}{3},\\qquad\n\\frac{\\partial N_1}{\\partial \\eta} = -4 L_1 + 1 = -\\frac{1}{3}.\n$$\n- For $N_2 = L_2(2L_2 - 1)$,\n$$\n\\frac{\\partial N_2}{\\partial \\xi} = 4 L_2 - 1 = \\frac{1}{3},\\qquad\n\\frac{\\partial N_2}{\\partial \\eta} = 0.\n$$\n- For $N_3 = L_3(2L_3 - 1)$,\n$$\n\\frac{\\partial N_3}{\\partial \\xi} = 0,\\qquad\n\\frac{\\partial N_3}{\\partial \\eta} = 4 L_3 - 1 = \\frac{1}{3}.\n$$\n- For $N_4 = 4 L_1 L_2$,\n$$\n\\frac{\\partial N_4}{\\partial \\xi} = 4(L_1 - L_2) = 0,\\qquad\n\\frac{\\partial N_4}{\\partial \\eta} = -4 L_2 = -\\frac{4}{3}.\n$$\n- For $N_5 = 4 L_2 L_3$,\n$$\n\\frac{\\partial N_5}{\\partial \\xi} = 4 L_3 = \\frac{4}{3},\\qquad\n\\frac{\\partial N_5}{\\partial \\eta} = 4 L_2 = \\frac{4}{3}.\n$$\n- For $N_6 = 4 L_3 L_1$,\n$$\n\\frac{\\partial N_6}{\\partial \\xi} = -4 L_3 = -\\frac{4}{3},\\qquad\n\\frac{\\partial N_6}{\\partial \\eta} = 4(L_1 - L_3) = 0.\n$$\nWith the given nodal coordinates, we compute the Jacobian entries at the centroid. First, for $\\frac{\\partial x}{\\partial \\xi}$:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,x_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 2.0 + 0\\cdot 0 + 0\\cdot 1.0 + \\left(\\frac{4}{3}\\right)\\cdot 0.7 + \\left(-\\frac{4}{3}\\right)\\cdot 0.2\n= \\frac{4}{3}.\n$$\nNext, for $\\frac{\\partial x}{\\partial \\eta}$:\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,x_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 2.0 + \\left(\\frac{1}{3}\\right)\\cdot 0 + \\left(-\\frac{4}{3}\\right)\\cdot 1.0 + \\left(\\frac{4}{3}\\right)\\cdot 0.7 + 0\\cdot 0.2\n= -\\frac{2}{5}.\n$$\nFor $\\frac{\\partial y}{\\partial \\xi}$:\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,y_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 2.0 + 0\\cdot 0.2 + \\left(\\frac{4}{3}\\right)\\cdot 1.3 + \\left(-\\frac{4}{3}\\right)\\cdot 1.0\n= \\frac{2}{5}.\n$$\nFor $\\frac{\\partial y}{\\partial \\eta}$:\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,y_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 2.0 + \\left(-\\frac{4}{3}\\right)\\cdot 0.2 + \\left(\\frac{4}{3}\\right)\\cdot 1.3 + 0\\cdot 1.0\n= \\frac{32}{15}.\n$$\nThus, the Jacobian matrix at $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ is\n$$\n\\boldsymbol{J}\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\n=\n\\begin{pmatrix}\n\\frac{4}{3}  -\\frac{2}{5} \\\\\n\\frac{2}{5}  \\frac{32}{15}\n\\end{pmatrix},\n$$\nand its determinant is\n$$\nJ\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\n= \\left(\\frac{4}{3}\\right)\\left(\\frac{32}{15}\\right) - \\left(-\\frac{2}{5}\\right)\\left(\\frac{2}{5}\\right)\n= \\frac{128}{45} + \\frac{4}{25}\n= \\frac{676}{225}.\n$$\n\nThe role of the Jacobian determinant in transforming weak integrals under the Galerkin weighted residual method is given by the change-of-variables formula. For any integrand $g(\\boldsymbol{x})$ defined on the curved physical element $E$, the area integral transforms to the reference element $\\hat{E}$ as\n$$\n\\int_{E} g(\\boldsymbol{x})\\,\\mathrm{d}\\Omega\n=\n\\int_{\\hat{E}} g\\big(\\boldsymbol{x}(\\boldsymbol{\\xi})\\big)\\,\\big|J(\\boldsymbol{\\xi})\\big|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\nwhere $\\big|J(\\boldsymbol{\\xi})\\big| = \\det\\boldsymbol{J}(\\boldsymbol{\\xi})$ accounts for the local metric distortion and area scaling due to the mapping.\n\nFor the specified weak inner product on the element,\n$$\nI = \\int_{E} N_1(\\boldsymbol{x})\\,N_1(\\boldsymbol{x})\\,\\mathrm{d}\\Omega,\n$$\nthe transformed integral on the reference element is\n$$\nI = \\int_{\\hat{E}} N_1(\\xi,\\eta)^2 \\,\\big|J(\\xi,\\eta)\\big|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta.\n$$\nUsing one-point quadrature at the centroid $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$, with weight equal to the reference triangle area,\n$$\nw = \\text{area}(\\hat{E}) = \\frac{1}{2},\n$$\nwe have the approximation\n$$\nI \\;\\approx\\; w \\; N_1\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)^{2}\\; \\bigg|J\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\\bigg|.\n$$\nWe already computed $N_1\\left(\\frac{1}{3},\\frac{1}{3}\\right) = -\\frac{1}{9}$ and $J\\left(\\frac{1}{3},\\frac{1}{3}\\right) = \\frac{676}{225}$. Therefore,\n$$\nI \\;\\approx\\; \\frac{1}{2} \\left(-\\frac{1}{9}\\right)^{2} \\cdot \\frac{676}{225}\n\\;=\\;\n\\frac{1}{2}\\cdot \\frac{1}{81} \\cdot \\frac{676}{225}\n\\;=\\;\n\\frac{676}{2 \\cdot 81 \\cdot 225}\n\\;=\\;\n\\frac{676}{36450}\n\\;=\\;\n\\frac{338}{18225}.\n$$\nThis is an exact rational value for the specified one-point quadrature approximation of the local $L^{2}$ inner product over the curved element.",
            "answer": "$$\\boxed{\\frac{338}{18225}}$$"
        },
        {
            "introduction": "While high-order Galerkin methods offer superior accuracy, they achieve this by employing a large number of degrees of freedom (DOFs) within each element, many of which are purely internal and do not directly couple to neighboring elements. Static condensation is an elegant and powerful algebraic technique to eliminate these internal DOFs at the element level before assembling the global system of equations. This exercise demonstrates how to derive and apply the static condensation formula to compute the Schur complement, which acts as the effective stiffness matrix for the element's boundary DOFs, leading to a significantly smaller and more computationally efficient global problem. ",
            "id": "4006100",
            "problem": "Consider a one-dimensional steady diffusion model serving as a surrogate for viscous diffusion or pressure Poisson subproblems arising within high-order Galerkin discretizations in aerospace Computational Fluid Dynamics (CFD). On an element $e$ with physical extent mapped from a reference interval, the strong form reads $-\\frac{d}{dx}\\left(\\kappa(x)\\frac{du}{dx}\\right)=s(x)$ with suitable boundary conditions. Using the Galerkin weighted-residual principle, the weak form on element $e$ is obtained by multiplying by a test function $w$ from the same space as the trial function (standard Galerkin choice) and integrating by parts to obtain the elemental bilinear and linear forms. Let a high-order polynomial basis be used on each element, with degrees of freedom (DOFs) split into two groups: interface (or boundary) DOFs that live on the element boundaries, denoted by the vector of coefficients $u_{b}$, and interior DOFs that live strictly inside the element, denoted by $u_{i}$. After assembling the element-level contributions, the elemental algebraic system admits a block structure\n$$\n\\begin{pmatrix}\nK_{bb}  K_{bi} \\\\\nK_{ib}  K_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\nu_{b} \\\\\nu_{i}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf_{b} \\\\\nf_{i}\n\\end{pmatrix},\n$$\nwhere $K_{bb}$, $K_{bi}$, $K_{ib}$, and $K_{ii}$ are the element stiffness sub-blocks originating from the bilinear form, and $f_{b}$, $f_{i}$ are the corresponding load sub-vectors from the linear form. Assume $K_{ii}$ is nonsingular, as is the case for standard diffusion operators with well-posed interior constraints.\n\nTask A: Starting from the Galerkin weak form and the block-partitioned system above, use the weighted-residual principle and linear algebra to eliminate $u_{i}$ at the element level. Derive the condensed equation expressed solely in terms of $u_{b}$ and the elemental data. Your derivation must explicitly show how the elimination reduces the number of globally coupled DOFs and identify the operator that maps $u_{b}$ to the condensed residual.\n\nTask B: To make the reduction concrete, consider a single element with the following consistent and symmetric sub-blocks (all entries are dimensionless and have been nondimensionalized by a characteristic element length and diffusivity): \n$$\nK_{bb}=\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix},\\quad\nK_{bi}=\\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix},\\quad\nK_{ii}=\\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix}.\n$$\nAssume zero elemental forcing, $f_{b}=\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ and $f_{i}=\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$. Using your result from Task A, compute the trace of the static-condensed boundary stiffness for this element. Provide your final answer as a single real number. Do not round; report the exact value.",
            "solution": "The problem as stated is scientifically sound, well-posed, and complete. It describes the standard procedure of static condensation, a fundamental technique in the finite element method, particularly relevant for high-order discretizations where a significant number of degrees of freedom (DOFs) are internal to the element. The provided numerical data are consistent and allow for a unique solution. We shall proceed with the derivation and calculation.\n\nThe problem starts with the elemental algebraic system derived from a Galerkin weighted-residual formulation of a one-dimensional diffusion equation. This system is partitioned based on the physical location of the DOFs: boundary (or interface) DOFs, with coefficient vector $u_b$, and interior DOFs, with coefficient vector $u_i$. The block-matrix form is given as:\n$$\n\\begin{pmatrix}\nK_{bb}  K_{bi} \\\\\nK_{ib}  K_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\nu_{b} \\\\\nu_{i}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf_{b} \\\\\nf_{i}\n\\end{pmatrix}\n$$\nThis matrix equation represents two coupled systems of linear equations:\n$$\nK_{bb}u_{b} + K_{bi}u_{i} = f_{b} \\quad (1)\n$$\n$$\nK_{ib}u_{b} + K_{ii}u_{i} = f_{i} \\quad (2)\n$$\nEquation $(1)$ represents the weighted residual equations corresponding to test functions associated with the boundary DOFs, while Equation $(2)$ corresponds to test functions associated with interior DOFs.\n\n**Task A: Derivation of the Condensed System**\n\nThe objective is to eliminate the interior DOFs, $u_i$, and derive a system that involves only the boundary DOFs, $u_b$. This is achieved by using Equation $(2)$ to express $u_i$ as a function of $u_b$ and then substituting this expression into Equation $(1)$.\n\nFrom Equation $(2)$, we can formally solve for $u_i$:\n$$\nK_{ii}u_{i} = f_{i} - K_{ib}u_{b}\n$$\nThe problem states that $K_{ii}$ is nonsingular. This is a crucial property for standard elliptic problems when interior DOFs are chosen appropriately (e.g., as bubble functions that vanish on the element boundary). The nonsingularity of $K_{ii}$ guarantees the existence of its inverse, $K_{ii}^{-1}$. Pre-multiplying by $K_{ii}^{-1}$, we obtain an explicit expression for the interior DOFs:\n$$\nu_{i} = K_{ii}^{-1}(f_{i} - K_{ib}u_{b}) \\quad (3)\n$$\nThis equation shows that the behavior of the solution inside the element is fully determined by the solution at the element's boundary ($u_b$) and the forcing within the element ($f_i$).\n\nNext, we substitute this expression for $u_i$ back into Equation $(1)$:\n$$\nK_{bb}u_{b} + K_{bi} \\left[ K_{ii}^{-1}(f_{i} - K_{ib}u_{b}) \\right] = f_{b}\n$$\nWe distribute $K_{bi}$ and rearrange the equation to collect all terms involving $u_b$ on the left-hand side and all other terms, which constitute the effective source or load, on the right-hand side.\n$$\nK_{bb}u_{b} + K_{bi}K_{ii}^{-1}f_{i} - K_{bi}K_{ii}^{-1}K_{ib}u_{b} = f_{b}\n$$\n$$\nK_{bb}u_{b} - K_{bi}K_{ii}^{-1}K_{ib}u_{b} = f_{b} - K_{bi}K_{ii}^{-1}f_{i}\n$$\nFactoring out $u_b$ on the left-hand side yields the condensed equation:\n$$\n(K_{bb} - K_{bi}K_{ii}^{-1}K_{ib}) u_{b} = f_{b} - K_{bi}K_{ii}^{-1}f_{i}\n$$\nThis is the desired equation expressed solely in terms of $u_b$ and the elemental data. We can define the condensed (or effective) stiffness matrix $\\tilde{K}$ and the condensed (or effective) load vector $\\tilde{f}$:\n$$\n\\tilde{K} = K_{bb} - K_{bi}K_{ii}^{-1}K_{ib}\n$$\n$$\n\\tilde{f} = f_{b} - K_{bi}K_{ii}^{-1}f_{i}\n$$\nThe condensed system is then written compactly as $\\tilde{K}u_b = \\tilde{f}$. The matrix $\\tilde{K}$ is the Schur complement of the block $K_{ii}$ in the original stiffness matrix.\n\nThis process reduces the number of globally coupled DOFs because the interior DOFs, $u_i$, are by definition local to a single element and do not participate in the coupling between adjacent elements. The global system of equations is assembled by enforcing continuity of the solution at the element interfaces, a process that only involves the boundary DOFs, $u_b$. By eliminating $u_i$ at the element level, we can assemble a global system using only the condensed matrices $\\tilde{K}$. This results in a significantly smaller global system, reducing both memory requirements and computational cost for the global solve phase. The cost of this reduction is the upfront computation of $K_{ii}^{-1}$ and the matrix products for each element.\n\nThe condensed residual equation is $\\tilde{K} u_b - \\tilde{f} = 0$. The operator that maps $u_b$ to the condensed residual, or more specifically, the part of the residual that depends on $u_b$, is the condensed stiffness matrix $\\tilde{K} = K_{bb} - K_{bi}K_{ii}^{-1}K_{ib}$.\n\n**Task B: Calculation of the Trace of the Condensed Stiffness Matrix**\n\nWe are given the following dimensionless sub-blocks for a specific element:\n$$\nK_{bb}=\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix},\\quad\nK_{bi}=\\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix},\\quad\nK_{ii}=\\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix}\n$$\nThe problem notes that the system is symmetric. For a symmetric Galerkin formulation, the stiffness matrix is symmetric, which implies $K_{ib} = K_{bi}^{T}$. Given that $K_{bi}$ is a symmetric matrix (specifically, minus the identity matrix of size $2$), we have $K_{ib} = K_{bi}^{T} = K_{bi} = \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix}$.\n\nThe task is to compute the trace of the static-condensed boundary stiffness matrix, $\\tilde{K}$. From Task A, its definition is:\n$$\n\\tilde{K} = K_{bb} - K_{bi}K_{ii}^{-1}K_{ib}\n$$\nFirst, we must compute the inverse of $K_{ii}$. For a general $2 \\times 2$ matrix $A = \\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$, its inverse is $A^{-1} = \\frac{1}{ad-bc}\\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$.\nFor $K_{ii} = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix}$:\nThe determinant is $\\det(K_{ii}) = (3)(2) - (1)(1) = 6 - 1 = 5$.\nThe inverse is:\n$$\nK_{ii}^{-1} = \\frac{1}{5}\\begin{pmatrix} 2  -1 \\\\ -1  3 \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{5}  -\\frac{1}{5} \\\\ -\\frac{1}{5}  \\frac{3}{5} \\end{pmatrix}\n$$\nNow we compute the Schur complement term, $S = K_{bi}K_{ii}^{-1}K_{ib}$. We note that $K_{bi} = K_{ib} = -I$, where $I$ is the $2 \\times 2$ identity matrix.\n$$\nS = (-I) K_{ii}^{-1} (-I) = (-1)(-1) I K_{ii}^{-1} I = K_{ii}^{-1}\n$$\nSo, the Schur complement term is simply $K_{ii}^{-1}$:\n$$\nS = \\begin{pmatrix} \\frac{2}{5}  -\\frac{1}{5} \\\\ -\\frac{1}{5}  \\frac{3}{5} \\end{pmatrix}\n$$\nNow we can compute the condensed stiffness matrix $\\tilde{K}$:\n$$\n\\tilde{K} = K_{bb} - S = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} - \\begin{pmatrix} \\frac{2}{5}  -\\frac{1}{5} \\\\ -\\frac{1}{5}  \\frac{3}{5} \\end{pmatrix}\n$$\n$$\n\\tilde{K} = \\begin{pmatrix} 2 - \\frac{2}{5}  -1 - (-\\frac{1}{5}) \\\\ -1 - (-\\frac{1}{5})  2 - \\frac{3}{5} \\end{pmatrix}\n= \\begin{pmatrix} \\frac{10}{5} - \\frac{2}{5}  -\\frac{5}{5} + \\frac{1}{5} \\\\ -\\frac{5}{5} + \\frac{1}{5}  \\frac{10}{5} - \\frac{3}{5} \\end{pmatrix}\n= \\begin{pmatrix} \\frac{8}{5}  -\\frac{4}{5} \\\\ -\\frac{4}{5}  \\frac{7}{5} \\end{pmatrix}\n$$\nThe final step is to compute the trace of $\\tilde{K}$, which is the sum of its diagonal elements:\n$$\n\\text{tr}(\\tilde{K}) = \\frac{8}{5} + \\frac{7}{5} = \\frac{15}{5} = 3\n$$\nThe trace of the static-condensed boundary stiffness for this element is $3$. The forcing terms $f_b$ and $f_i$ being zero does not affect the calculation of the stiffness matrix $\\tilde{K}$.",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "Applying the Galerkin method to the nonlinear equations that govern fluid dynamics introduces unique stability challenges not present in linear problems. A naive application can lead to catastrophic numerical instabilities due to a phenomenon known as aliasing, where the interaction between polynomial basis functions and nonlinear terms creates spurious high-frequency content that is misrepresented by the numerical integration. This practice explores the root cause of aliasing by carefully analyzing the polynomial degrees in the weak form, revealing why exact integration of all terms is critical and introducing the advanced concepts of over-integration and split-formulations that are essential for developing robust nonlinear solvers. ",
            "id": "4006094",
            "problem": "Consider a scalar conservation law representative of nonlinear convective behavior in computational fluid dynamics, given on a one-dimensional periodic domain $\\Omega$ by $\\partial_t u + \\partial_x f(u) = 0$, where $f(u) = \\tfrac{1}{2} u^2$. Let the approximate solution $u_h(x,t)$ lie in a polynomial space of degree $p$ per element, and consider a standard Galerkin weighted residual method with test functions $\\phi_i \\in \\mathcal{P}^p$, the space of polynomials of degree at most $p$. The semi-discrete weak form obtained by integration by parts is $ \\int_{\\Omega} \\phi_i \\, \\partial_t u_h \\, dx - \\int_{\\Omega} \\partial_x \\phi_i \\, f(u_h) \\, dx = 0$, where periodicity causes the boundary term to vanish. Assume the volume integrals are evaluated using Gauss–Legendre quadrature with $Q$ points per element, which is exact for polynomials up to degree $2Q - 1$.\n\nExplain, by reasoning from the above weighted residual framework and polynomial degree counting, how under-integration of nonlinear terms can lead to aliasing errors in high-order Galerkin methods, and identify effective mitigation strategies grounded in first principles. In particular, determine the polynomial degree of the volume integrand in the nonlinear term and relate it to the quadrature exactness requirement, discuss the mechanism by which aliasing transfers energy among resolved and unresolved scales, and describe how over-integration and carefully constructed split forms can suppress these errors and improve stability.\n\nSelect all statements that are correct.\n\nA. For $f(u) = \\tfrac{1}{2} u^2$ and $u_h \\in \\mathcal{P}^p$, the weak-form volume integrand $(-\\partial_x \\phi_i) \\, f(u_h)$ has polynomial degree up to $3p - 1$, so Gauss–Legendre quadrature must satisfy $2Q - 1 \\ge 3p - 1$ (that is, $Q \\ge \\lceil \\tfrac{3p}{2} \\rceil$) to avoid under-integration of the nonlinear term. If $Q$ is smaller (for example, $Q = p + 1$ when $p  2$), the discrete inner products lose exactness, high-degree content is folded into lower modes, and non-physical energy transfer occurs. Over-integration meeting $2Q - 1 \\ge 3p - 1$ and split or skew-symmetric forms restore discrete cancellations and mitigate aliasing-driven instabilities.\n\nB. Aliasing can be eliminated by evaluating $f(u_h)$ at the interpolation nodes and then removing the top $p$ modal coefficients in every element. This necessarily reduces the scheme to first order accuracy but prevents energy contamination of resolved scales; therefore it is the preferred approach in high-order Galerkin methods.\n\nC. Writing the conservation law in strong form and discretizing $\\partial_x f(u_h)$ with exact differentiation matrices automatically eliminates aliasing regardless of quadrature, because differentiation is a linear operation and linear operators do not introduce nonlinear coupling among polynomial modes.\n\nD. Entropy-conservative split forms built from two-point flux functions, together with quadratures and nodal sets that satisfy a discrete Summation-By-Parts (SBP) property, can suppress aliasing by enforcing discrete conservation of a convex entropy and associated stability, even when nonlinearities would otherwise exceed the quadrature exactness of the naive weak form.\n\nE. On affine elements (where the geometric mapping from the reference element is linear), over-integration is unnecessary because the mapping does not increase the degree of the integrand; thus aliasing cannot occur if $Q = p + 1$ is used for all volume integrals, regardless of the nonlinear flux function.",
            "solution": "### Step 1: Extract Givens\n- **Governing Equation**: A scalar conservation law $\\partial_t u + \\partial_x f(u) = 0$ on a one-dimensional periodic domain $\\Omega$.\n- **Nonlinear Flux**: $f(u) = \\tfrac{1}{2} u^2$.\n- **Approximate Solution**: $u_h(x,t)$ is in a polynomial space of degree $p$ per element, denoted $\\mathcal{P}^p$.\n- **Test Functions**: $\\phi_i$ are also in the space $\\mathcal{P}^p$.\n- **Weak Form**: The semi-discrete weak form is given by $\\int_{\\Omega} \\phi_i \\, \\partial_t u_h \\, dx - \\int_{\\Omega} \\partial_x \\phi_i \\, f(u_h) \\, dx = 0$. The boundary term vanishes due to periodicity.\n- **Numerical Quadrature**: Volume integrals are evaluated using Gauss–Legendre quadrature with $Q$ points per element. This rule is exact for polynomials of degree up to $2Q - 1$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically grounded, well-posed, and objective.\n1.  **Scientific or Factual Soundness**: The problem describes the standard Galerkin finite element method applied to Burgers' equation, a canonical model for nonlinear hyperbolic conservation laws. The concepts of polynomial approximation spaces, weak forms derived from integration by parts, and Gauss-Legendre quadrature are all standard and foundational in numerical analysis and computational fluid dynamics. The question about aliasing due to under-integration of nonlinear terms is a central and well-studied issue in high-order methods. The setup is entirely consistent with established theory.\n2.  **Non-Formalizable or Irrelevant**: The problem is highly formal and directly relevant to the topic of weighted residuals and Galerkin methods in aerospace CFD, where high-order methods are of great interest for resolving complex flow features.\n3.  **Incomplete or Contradictory Setup**: The problem is self-contained. It provides the PDE, the form of the nonlinearity, the function spaces for the solution and test functions, the weak formulation, and the type of quadrature rule used. There are no contradictions.\n4.  **Unrealistic or Infeasible**: The setup is a standard, simplified model problem used widely in the development and analysis of numerical methods. All conditions are mathematically and computationally feasible.\n5.  **Ill-Posed or Poorly Structured**: The question is well-posed. It asks for an explanation of a known numerical phenomenon (aliasing) and an evaluation of mitigation strategies based on first principles. The terminology is precise and unambiguous within the context of numerical analysis.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The problem addresses a genuine and non-trivial challenge in high-order methods. Aliasing instability is a subtle issue that requires careful analysis of polynomial degrees and discrete operators.\n7.  **Outside Scientific Verifiability**: The claims to be evaluated are all verifiable through mathematical analysis of polynomial spaces and quadrature rules, which is standard practice in the field.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. Proceeding to solution derivation and option analysis.\n\n### Derivation and Analysis\n\nThe problem asks for an analysis of aliasing errors arising from the nonlinear term in the weak formulation. The term in question is the spatial integral, which, after integration by parts, is $\\int_{\\Omega} \\partial_x \\phi_i \\, f(u_h) \\, dx$. Let's analyze the polynomial degree of the integrand, $(\\partial_x \\phi_i) f(u_h)$.\n\n1.  The approximate solution $u_h$ is a polynomial of degree at most $p$, so $u_h \\in \\mathcal{P}^p$.\n2.  The test function $\\phi_i$ is also a polynomial of degree at most $p$, so $\\phi_i \\in \\mathcal{P}^p$.\n3.  The derivative of the test function, $\\partial_x \\phi_i$, is therefore a polynomial of degree at most $p-1$, i.e., $\\partial_x \\phi_i \\in \\mathcal{P}^{p-1}$.\n4.  The nonlinear flux function is $f(u_h) = \\frac{1}{2} u_h^2$. Since $u_h \\in \\mathcal{P}^p$, its square, $u_h^2$, is a polynomial of degree at most $2p$. Thus, $f(u_h) \\in \\mathcal{P}^{2p}$.\n5.  The integrand is the product $(\\partial_x \\phi_i) f(u_h)$. The degree of a product of polynomials is the sum of their degrees. Therefore, the degree of the integrand is at most $(p-1) + 2p = 3p-1$.\n\nFor a Gauss-Legendre quadrature with $Q$ points to evaluate this integral exactly, the rule must be exact for polynomials up to degree $3p-1$. The problem states that the rule is exact for polynomials of degree up to $2Q-1$. Thus, for exact integration, we require:\n$$ 2Q - 1 \\ge 3p - 1 $$\n$$ 2Q \\ge 3p $$\n$$ Q \\ge \\frac{3p}{2} $$\nSince $Q$ must be an integer, we need $Q \\ge \\lceil \\frac{3p}{2} \\rceil$.\n\nIf this condition is not met (i.e., if the integral is under-integrated), the numerical quadrature computes an inexact value for the integral. This inexactness means that the components of the integrand polynomial with degree higher than $2Q-1$ are not correctly accounted for. Instead, their energy is \"aliased\" or \"folded back\" onto the lower-degree polynomial modes that the quadrature can resolve. This process can be shown to break the discrete conservation properties of the scheme, often leading to a non-physical accumulation of energy and catastrophic instability.\n\nMitigation strategies fall into two main categories:\n1.  **De-aliasing by exact integration (Over-integration)**: The most straightforward approach is to simply use a sufficient number of quadrature points to satisfy the condition $Q \\ge \\lceil \\frac{3p}{2} \\rceil$. This is often called over-integration because it requires more quadrature points than needed for the linear terms (e.g., the mass matrix $\\int \\phi_i \\phi_j dx$, which only needs $Q \\ge p+1$ for exactness as the integrand is degree $2p$).\n2.  **De-aliasing by formulation (Split Forms)**: An alternative is to reformulate the nonlinear term into a \"split form\" that is mathematically equivalent in the continuous sense but has better discrete properties. For example, methods based on Summation-By-Parts (SBP) operators are constructed to mimic integration-by-parts at the discrete level. When combined with entropy-conservative fluxes, they can enforce a discrete entropy conservation law, ensuring nonlinear stability even when the nonlinear terms are formally under-integrated. This prevents the aliasing errors from causing instability.\n\nNow we evaluate each option.\n\n### Option-by-Option Analysis\n\n**A. For $f(u) = \\tfrac{1}{2} u^2$ and $u_h \\in \\mathcal{P}^p$, the weak-form volume integrand $(-\\partial_x \\phi_i) \\, f(u_h)$ has polynomial degree up to $3p - 1$, so Gauss–Legendre quadrature must satisfy $2Q - 1 \\ge 3p - 1$ (that is, $Q \\ge \\lceil \\tfrac{3p}{2} \\rceil$) to avoid under-integration of the nonlinear term. If $Q$ is smaller (for example, $Q = p + 1$ when $p  2$), the discrete inner products lose exactness, high-degree content is folded into lower modes, and non-physical energy transfer occurs. Over-integration meeting $2Q - 1 \\ge 3p - 1$ and split or skew-symmetric forms restore discrete cancellations and mitigate aliasing-driven instabilities.**\n\nThis statement is a comprehensive and accurate summary of the analysis.\n- The polynomial degree calculation, $(p-1) + 2p = 3p-1$, is correct.\n- The resulting quadrature requirement, $Q \\ge \\lceil \\frac{3p}{2} \\rceil$, is correctly derived.\n- The example check is correct: for $p2$, we have $p+1  \\frac{3p}{2}$ (as $1  p/2$), so $Q=p+1$ constitutes under-integration.\n- The description of aliasing as a \"folding\" of high-degree content into lower modes is conceptually correct.\n- It correctly identifies the two primary mitigation strategies: over-integration and split/skew-symmetric forms.\n**Verdict: Correct**\n\n**B. Aliasing can be eliminated by evaluating $f(u_h)$ at the interpolation nodes and then removing the top $p$ modal coefficients in every element. This necessarily reduces the scheme to first order accuracy but prevents energy contamination of resolved scales; therefore it is the preferred approach in high-order Galerkin methods.**\n\nThis option describes a form of a projection-based de-aliasing (filtering). The nonlinear term $f(u_h) \\in \\mathcal{P}^{2p}$ is computed, and then projected back onto the space $\\mathcal{P}^p$. While such techniques exist (e.g., the 3/2-rule in pseudospectral methods is a form of this), the claim that this *necessarily reduces the scheme to first-order accuracy* is false. A properly designed de-aliasing projection filter is intended to preserve the high order of accuracy of the spatial discretization. Reducing the scheme to first order would defeat the entire purpose of using a high-order method. Consequently, the conclusion that this is the \"preferred approach\" is also false; such a drastic loss of accuracy would make it highly undesirable.\n**Verdict: Incorrect**\n\n**C. Writing the conservation law in strong form and discretizing $\\partial_x f(u_h)$ with exact differentiation matrices automatically eliminates aliasing regardless of quadrature, because differentiation is a linear operation and linear operators do not introduce nonlinear coupling among polynomial modes.**\n\nThis statement fundamentally misunderstands the source of aliasing. Aliasing arises from the nonlinear function $f(u)$ producing high-frequency content (e.g., $u_h^2 \\in \\mathcal{P}^{2p}$) which cannot be exactly represented by the basis of the original solution space ($\\mathcal{P}^p$). Switching to a strong \"collocation\" form does not bypass this issue. In a collocation method, one computes the term $f(u_h)$ at the collocation nodes. This vector of nodal values is an incomplete representation of the full polynomial $f(u_h) \\in \\mathcal{P}^{2p}$. Applying a differentiation matrix to this aliased representation of $f(u_h)$ does not remove the aliasing error. The argument that \"differentiation is a linear operation\" is a red herring; the nonlinearity has already created the problem before the differentiation is applied.\n**Verdict: Incorrect**\n\n**D. Entropy-conservative split forms built from two-point flux functions, together with quadratures and nodal sets that satisfy a discrete Summation-By-Parts (SBP) property, can suppress aliasing by enforcing discrete conservation of a convex entropy and associated stability, even when nonlinearities would otherwise exceed the quadrature exactness of the naive weak form.**\n\nThis statement accurately describes a sophisticated and powerful class of modern high-order methods for conservation laws.\n- Entropy-conservative split forms (e.g., based on two-point fluxes developed by Tadmor and others) are designed to satisfy a discrete version of the chain rule that leads to entropy conservation.\n- SBP operators are discrete derivative operators that mimic the integration-by-parts property, which is crucial for proving statements about discrete energy or entropy conservation.\n- The combination of these two ideas (often in a Discontinuous Galerkin SBP framework) leads to schemes that are nonlinearly stable by construction. This stability is achieved by ensuring a discrete entropy is conserved (or dissipated), which prevents the unbounded energy growth characteristic of aliasing-driven instability. This works even if the quadrature rule is not sufficient for exact integration of the nonlinear terms (i.e., formal under-integration). It \"suppresses\" the ill effects of aliasing (instability), providing a robust alternative to over-integration.\n**Verdict: Correct**\n\n**E. On affine elements (where the geometric mapping from the reference element is linear), over-integration is unnecessary because the mapping does not increase the degree of the integrand; thus aliasing cannot occur if $Q = p + 1$ is used for all volume integrals, regardless of the nonlinear flux function.**\n\nThis statement contains a critical flaw in its reasoning. It is true that on affine elements, the Jacobian of the geometric transformation is constant, and thus the mapping from the reference element to the physical element does not increase the polynomial degree of the integrand. However, this is irrelevant to the degree increase caused by the *nonlinearity of the PDE itself*. As shown in the primary analysis, the integrand $(\\partial_x\\phi_i) f(u_h)$ has a degree of $3p-1$ *before* any geometric transformation is considered. A quadrature with $Q=p+1$ points is exact for polynomials of degree up to $2(p+1)-1 = 2p+1$. For any $p2$, we have $3p-1  2p+1$, meaning the quadrature is insufficient. Therefore, aliasing will still occur. The affine mapping simply means the problem isn't made worse by geometry; it doesn't solve the existing problem caused by the nonlinearity.\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}