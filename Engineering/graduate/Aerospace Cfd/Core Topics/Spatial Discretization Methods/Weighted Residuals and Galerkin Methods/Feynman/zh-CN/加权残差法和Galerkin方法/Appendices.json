{
    "hands_on_practices": [
        {
            "introduction": "在有限元方法中，为了简化计算，我们通常在规则的“参考单元”上定义基函数。然而，实际的航空航天应用，如翼型分析，涉及复杂的曲线边界。等参元的概念是一个优雅的解决方案，它使用相同的多项式（形函数）来描述单元的几何形状和单元上的解场。本练习将引导您完成将参考单元映射到物理空间中的曲线单元并计算雅可比行列式的具体步骤，这是将在物理单元上定义的积分变换到参考单元上进行计算的关键，也是构建有限元系统矩阵的基础。",
            "id": "4006148",
            "problem": "考虑一个用于计算流体力学 (CFD) 的空气动力学网格中的二维曲边边界元，该方法基于采用 Galerkin 加权余量法的有限元法 (FEM)。该单元是一个二次六节点三角形单元，用于表示翼型的局部弯曲部分。参考单元是参数空间中的标准单位直角三角形，其局部坐标为 $\\boldsymbol{\\xi} = (\\xi,\\eta)$，顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$。三个顶点节点和三个边中节点在物理空间中的位置如下：\n$$\n(x_1,y_1) = (0,0),\\quad (x_2,y_2) = (2.0,0.0),\\quad (x_3,y_3) = (0.0,2.0),\n$$\n$$\n(x_4,y_4) = (1.0,0.2),\\quad (x_5,y_5) = (0.7,1.3),\\quad (x_6,y_6) = (0.2,1.0),\n$$\n其中节点 $1$、$2$ 和 $3$ 分别是对应于参考三角形上 $(\\xi,\\eta) = (0,0)$、$(1,0)$ 和 $(0,1)$ 的顶点，而节点 $4$、$5$ 和 $6$ 分别是对应于 $(\\xi,\\eta) = (0.5,0)$、$(0.5,0.5)$ 和 $(0,0.5)$ 的边中节点。\n\n从等参概念的基本定义出发，即用于解近似的多项式基同样用于几何插值，执行以下操作：\n\n1. 对于此曲边六节点三角形单元，根据定义在参考三角形上的二次拉格朗日形函数，推导其等参映射 $\\boldsymbol{x}(\\boldsymbol{\\xi}) = (x(\\xi,\\eta),y(\\xi,\\eta))$。清晰地表达如何从节点坐标插值得到几何形状。\n\n2. 使用该映射，计算在参考三角形的形心 $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的雅可比矩阵\n$$\n\\boldsymbol{J}(\\xi,\\eta) = \\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix},\n$$\n及其行列式 $J(\\xi,\\eta) = \\det \\boldsymbol{J}(\\xi,\\eta)$。\n\n3. 解释在 Galerkin 加权余量法下，雅可比行列式在变换弱形式积分中的作用，特别是对于单元 $E$ 上的局部 $L^{2}$ 内积\n$$\nI \\;=\\; \\int_{E} N_1(\\boldsymbol{x})\\,N_1(\\boldsymbol{x}) \\,\\mathrm{d}\\Omega,\n$$\n其中 $N_1$ 是与节点 $1$ 关联的单元的第一个二次形函数，$\\mathrm{d}\\Omega$ 是物理面积微分。\n\n4. 在参考三角形上使用单点求积（对线性多项式精确），通过在形心 $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处求值来近似变换后的积分，求积权重等于参考三角形的面积。将 $I$ 的近似值的最终答案表示为一个精确的有理数。不包含任何物理单位，也不要四舍五入；以最简分数形式给出精确值。",
            "solution": "有限元法 (FEM) 中的等参概念将几何形状和解的近似置于同一多项式空间中。对于一个二次六节点三角形单元，几何形状通过二次拉格朗日形函数从参考三角形映射到物理三角形。将参考面积（重心）坐标表示为 $L_1 = 1 - \\xi - \\eta$，$L_2 = \\xi$ 和 $L_3 = \\eta$。参考三角形上的六个二次拉格朗日形函数为\n$$\nN_1 = L_1\\,(2L_1 - 1),\\quad\nN_2 = L_2\\,(2L_2 - 1),\\quad\nN_3 = L_3\\,(2L_3 - 1),\n$$\n$$\nN_4 = 4\\,L_1\\,L_2,\\quad\nN_5 = 4\\,L_2\\,L_3,\\quad\nN_6 = 4\\,L_3\\,L_1.\n$$\n通过几何的等参插值，从参考坐标 $\\boldsymbol{\\xi}=(\\xi,\\eta)$ 到物理坐标 $\\boldsymbol{x}=(x,y)$ 的映射为\n$$\nx(\\xi,\\eta) \\;=\\; \\sum_{i=1}^{6} N_i(\\xi,\\eta)\\,x_i,\\qquad\ny(\\xi,\\eta) \\;=\\; \\sum_{i=1}^{6} N_i(\\xi,\\eta)\\,y_i,\n$$\n其中 $(x_i,y_i)$ 是单元的物理节点坐标。\n\n该映射的雅可比矩阵为\n$$\n\\boldsymbol{J}(\\xi,\\eta) \\;=\\;\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,x_i & \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,x_i \\\\\n\\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,y_i & \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,y_i\n\\end{pmatrix}.\n$$\n我们现在计算参考三角形形心 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处形函数的导数。在形心处，重心坐标为 $L_1=L_2=L_3=\\frac{1}{3}$。形心处的形函数值为：\n$$\nN_1 = \\frac{1}{3}\\left(\\frac{2}{3} - 1\\right) = -\\frac{1}{9},\\quad\nN_2 = -\\frac{1}{9},\\quad\nN_3 = -\\frac{1}{9},\\quad\nN_4 = \\frac{4}{9},\\quad\nN_5 = \\frac{4}{9},\\quad\nN_6 = \\frac{4}{9}.\n$$\n重心坐标的导数为\n$$\n\\frac{\\partial L_1}{\\partial \\xi} = -1,\\quad \\frac{\\partial L_1}{\\partial \\eta} = -1,\\qquad\n\\frac{\\partial L_2}{\\partial \\xi} = 1,\\quad \\frac{\\partial L_2}{\\partial \\eta} = 0,\\qquad\n\\frac{\\partial L_3}{\\partial \\xi} = 0,\\quad \\frac{\\partial L_3}{\\partial \\eta} = 1.\n$$\n使用乘法法则和链式法则，在 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的形函数导数为：\n- 对于 $N_1 = L_1(2L_1 - 1)$，\n$$\n\\frac{\\partial N_1}{\\partial \\xi} = -4 L_1 + 1 = -\\frac{1}{3},\\qquad\n\\frac{\\partial N_1}{\\partial \\eta} = -4 L_1 + 1 = -\\frac{1}{3}.\n$$\n- 对于 $N_2 = L_2(2L_2 - 1)$，\n$$\n\\frac{\\partial N_2}{\\partial \\xi} = 4 L_2 - 1 = \\frac{1}{3},\\qquad\n\\frac{\\partial N_2}{\\partial \\eta} = 0.\n$$\n- 对于 $N_3 = L_3(2L_3 - 1)$，\n$$\n\\frac{\\partial N_3}{\\partial \\xi} = 0,\\qquad\n\\frac{\\partial N_3}{\\partial \\eta} = 4 L_3 - 1 = \\frac{1}{3}.\n$$\n- 对于 $N_4 = 4 L_1 L_2$，\n$$\n\\frac{\\partial N_4}{\\partial \\xi} = 4(L_1 - L_2) = 0,\\qquad\n\\frac{\\partial N_4}{\\partial \\eta} = -4 L_2 = -\\frac{4}{3}.\n$$\n- 对于 $N_5 = 4 L_2 L_3$，\n$$\n\\frac{\\partial N_5}{\\partial \\xi} = 4 L_3 = \\frac{4}{3},\\qquad\n\\frac{\\partial N_5}{\\partial \\eta} = 4 L_2 = \\frac{4}{3}.\n$$\n- 对于 $N_6 = 4 L_3 L_1$，\n$$\n\\frac{\\partial N_6}{\\partial \\xi} = -4 L_3 = -\\frac{4}{3},\\qquad\n\\frac{\\partial N_6}{\\partial \\eta} = 4(L_1 - L_3) = 0.\n$$\n利用给定的节点坐标，我们计算形心处的雅可比矩阵元素。首先，对于 $\\frac{\\partial x}{\\partial \\xi}$：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,x_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 2 + 0\\cdot 0 + 0\\cdot 1 + \\left(\\frac{4}{3}\\right)\\cdot 0.7 + \\left(-\\frac{4}{3}\\right)\\cdot 0.2\n= \\frac{4}{3}.\n$$\n接下来，对于 $\\frac{\\partial x}{\\partial \\eta}$：\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,x_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 2 + \\left(\\frac{1}{3}\\right)\\cdot 0 + \\left(-\\frac{4}{3}\\right)\\cdot 1 + \\left(\\frac{4}{3}\\right)\\cdot 0.7 + 0\\cdot 0.2\n= -\\frac{2}{5}.\n$$\n对于 $\\frac{\\partial y}{\\partial \\xi}$：\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi}\\,y_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 2 + 0\\cdot 0.2 + \\left(\\frac{4}{3}\\right)\\cdot 1.3 + \\left(-\\frac{4}{3}\\right)\\cdot 1.0\n= \\frac{2}{5}.\n$$\n对于 $\\frac{\\partial y}{\\partial \\eta}$：\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta}\\,y_i\n= \\left(-\\frac{1}{3}\\right)\\cdot 0 + 0\\cdot 0 + \\left(\\frac{1}{3}\\right)\\cdot 2 + \\left(-\\frac{4}{3}\\right)\\cdot 0.2 + \\left(\\frac{4}{3}\\right)\\cdot 1.3 + 0\\cdot 1.0\n= \\frac{32}{15}.\n$$\n因此，在 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的雅可比矩阵是\n$$\n\\boldsymbol{J}\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\n=\n\\begin{pmatrix}\n\\frac{4}{3} & -\\frac{2}{5} \\\\\n\\frac{2}{5} & \\frac{32}{15}\n\\end{pmatrix},\n$$\n其行列式为\n$$\nJ\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\n= \\left(\\frac{4}{3}\\right)\\left(\\frac{32}{15}\\right) - \\left(-\\frac{2}{5}\\right)\\left(\\frac{2}{5}\\right)\n= \\frac{128}{45} + \\frac{4}{25}\n= \\frac{676}{225}.\n$$\n\n在 Galerkin 加权余量法中，雅可比行列式在变换弱形式积分中的作用由变量替换公式给出。对于定义在弯曲物理单元 $E$ 上的任意被积函数 $g(\\boldsymbol{x})$，面积分变换到参考单元 $\\hat{E}$ 上，形式如下\n$$\n\\int_{E} g(\\boldsymbol{x})\\,\\mathrm{d}\\Omega\n=\n\\int_{\\hat{E}} g\\big(\\boldsymbol{x}(\\boldsymbol{\\xi})\\big)\\,\\big|J(\\boldsymbol{\\xi})\\big|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\n其中 $\\big|J(\\boldsymbol{\\xi})\\big| = \\det\\boldsymbol{J}(\\boldsymbol{\\xi})$ 表示由映射引起的局部度量畸变和面积缩放。\n\n对于单元上指定的弱内积，\n$$\nI = \\int_{E} N_1(\\boldsymbol{x})\\,N_1(\\boldsymbol{x})\\,\\mathrm{d}\\Omega,\n$$\n参考单元上的变换积分为\n$$\nI = \\int_{\\hat{E}} N_1(\\xi,\\eta)^2 \\,\\big|J(\\xi,\\eta)\\big|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta.\n$$\n使用在形心 $(\\xi,\\eta)=\\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的单点求积，权重等于参考三角形的面积，\n$$\nw = \\text{area}(\\hat{E}) = \\frac{1}{2},\n$$\n我们得到近似值\n$$\nI \\;\\approx\\; w \\; N_1\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)^{2}\\; \\bigg|J\\bigg(\\tfrac{1}{3},\\tfrac{1}{3}\\bigg)\\bigg|.\n$$\n我们已经计算出 $N_1\\left(\\frac{1}{3},\\frac{1}{3}\\right) = -\\frac{1}{9}$ 和 $J\\left(\\frac{1}{3},\\frac{1}{3}\\right) = \\frac{676}{225}$。因此，\n$$\nI \\;\\approx\\; \\frac{1}{2} \\left(\\frac{1}{9}\\right)^{2} \\cdot \\frac{676}{225}\n\\;=\\;\n\\frac{1}{2}\\cdot \\frac{1}{81} \\cdot \\frac{676}{225}\n\\;=\\;\n\\frac{676}{225 \\cdot 162}\n\\;=\\;\n\\frac{676}{36450}\n\\;=\\;\n\\frac{338}{18225}.\n$$\n这是在弯曲单元上对局部 $L^{2}$ 内积进行指定的单点求积近似所得的精确有理数值。",
            "answer": "$$\\boxed{\\frac{338}{18225}}$$"
        },
        {
            "introduction": "高阶有限元方法能够以较少的网格单元实现高精度，但代价是在每个单元内部引入了大量只与该单元相关的“内部”自由度。如果将这些自由度全部纳入全局系统，会导致计算成本急剧增加。静态凝聚是一种强大的代数技巧，它允许我们在组装全局系统之前，在单元层面预先消除这些局部自由度。通过本练习，您将推导并应用静态凝聚过程，最终得到一个只包含单元边界自由度的等效“浓缩”系统，从而显著减小需要求解的全局线性系统的规模，这是在实用CFD代码中一项至关重要的优化技术。",
            "id": "4006100",
            "problem": "考虑一个一维稳态扩散模型，该模型可作为航空航天计算流体力学 (CFD) 中高阶伽辽金离散化产生的粘性扩散或压力泊松子问题的替代模型。在一个物理范围从参考区间映射而来的单元 $e$ 上，其强形式为 $-\\frac{d}{dx}\\left(\\kappa(x)\\frac{du}{dx}\\right)=s(x)$，并附有适当的边界条件。使用伽辽金加权残差原理，通过乘以一个与试探函数来自同一空间的检验函数 $w$（标准的伽辽金选择），并在单元 $e$ 上进行分部积分，可以得到单元双线性和线性形式的弱形式。设在每个单元上使用高阶多项式基，自由度 (DOF) 分为两组：存在于单元边界上的界面（或边界）自由度，用系数向量 $u_{b}$ 表示；以及严格存在于单元内部的内部自由度，用 $u_{i}$ 表示。在组装单元级别的贡献后，单元代数系统呈现出一种分块结构\n$$\n\\begin{pmatrix}\nK_{bb} & K_{bi} \\\\\nK_{ib} & K_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\nu_{b} \\\\\nu_{i}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf_{b} \\\\\nf_{i}\n\\end{pmatrix},\n$$\n其中 $K_{bb}$、$K_{bi}$、$K_{ib}$ 和 $K_{ii}$ 是源于双线性形式的单元刚度子块，$f_{b}$ 和 $f_{i}$ 是源于线性形式的相应载荷子向量。假设 $K_{ii}$ 是非奇异的，对于具有适定内部约束的标准扩散算子来说，情况就是如此。\n\n任务 A：从伽辽金弱形式和上述分块系统出发，使用加权残差原理和线性代数在单元级别上消去 $u_{i}$。推导出仅用 $u_{b}$ 和单元数据表示的凝聚方程。你的推导必须明确展示消去过程如何减少全局耦合的自由度数量，并指出将 $u_{b}$ 映射到凝聚残差的算子。\n\n任务 B：为了使该缩减过程具体化，考虑一个具有以下一致且对称子块的单元（所有条目均为无量纲，并已通过特征单元长度和扩散系数进行了无量纲化）：\n$$\nK_{bb}=\\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix},\\quad\nK_{bi}=\\begin{pmatrix} -1 & 0 \\\\ 0 & -1 \\end{pmatrix},\\quad\nK_{ii}=\\begin{pmatrix} 3 & 1 \\\\ 1 & 2 \\end{pmatrix}.\n$$\n假设单元强迫项为零，$f_{b}=\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 且 $f_{i}=\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。使用任务 A 的结果，计算此单元的静态凝聚边界刚度的迹。请以单个实数形式提供最终答案。不要四舍五入，报告精确值。",
            "solution": "所述问题在科学上是合理的、适定的和完整的。它描述了静态凝聚的标准过程，这是有限元法中的一项基本技术，对于高阶离散化尤其重要，因为在高阶离散化中，大量的自由度 (DOF) 位于单元内部。提供的数值数据是一致的，并允许有唯一解。我们将继续进行推导和计算。\n\n问题始于从一维扩散方程的伽辽金加权残差公式推导出的单元代数系统。该系统根据自由度的物理位置进行划分：边界（或界面）自由度，其系数向量为 $u_b$；以及内部自由度，其系数向量为 $u_i$。其分块矩阵形式如下：\n$$\n\\begin{pmatrix}\nK_{bb} & K_{bi} \\\\\nK_{ib} & K_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\nu_{b} \\\\\nu_{i}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf_{b} \\\\\nf_{i}\n\\end{pmatrix}\n$$\n这个矩阵方程代表了两个耦合的线性方程组：\n$$\nK_{bb}u_{b} + K_{bi}u_{i} = f_{b} \\quad (1)\n$$\n$$\nK_{ib}u_{b} + K_{ii}u_{i} = f_{i} \\quad (2)\n$$\n方程 $(1)$ 代表了与边界自由度相关的检验函数所对应的加权残差方程，而方程 $(2)$ 则对应于与内部自由度相关的检验函数。\n\n**任务 A：凝聚系统的推导**\n\n目标是消去内部自由度 $u_i$，并推导出一个只涉及边界自由度 $u_b$ 的系统。这可以通过使用方程 $(2)$ 将 $u_i$ 表示为 $u_b$ 的函数，然后将此表达式代入方程 $(1)$ 来实现。\n\n从方程 $(2)$，我们可以正式地解出 $u_i$：\n$$\nK_{ii}u_{i} = f_{i} - K_{ib}u_{b}\n$$\n问题陈述中指出 $K_{ii}$ 是非奇异的。对于标准的椭圆问题，当内部自由度被恰当选择时（例如，选择在单元边界上为零的泡状函数），这是一个至关重要的性质。$K_{ii}$ 的非奇异性保证了其逆矩阵 $K_{ii}^{-1}$ 的存在。通过左乘 $K_{ii}^{-1}$，我们得到内部自由度的显式表达式：\n$$\nu_{i} = K_{ii}^{-1}(f_{i} - K_{ib}u_{b}) \\quad (3)\n$$\n这个方程表明，单元内部解的行为完全由单元边界上的解（$u_b$）和单元内部的强迫项（$f_i$）决定。\n\n接下来，我们将这个 $u_i$ 的表达式代回方程 $(1)$：\n$$\nK_{bb}u_{b} + K_{bi} \\left[ K_{ii}^{-1}(f_{i} - K_{ib}u_{b}) \\right] = f_{b}\n$$\n我们分配 $K_{bi}$ 并重新整理方程，将所有涉及 $u_b$ 的项收集在左侧，并将所有其他构成有效源或载荷的项放在右侧。\n$$\nK_{bb}u_{b} + K_{bi}K_{ii}^{-1}f_{i} - K_{bi}K_{ii}^{-1}K_{ib}u_{b} = f_{b}\n$$\n$$\nK_{bb}u_{b} - K_{bi}K_{ii}^{-1}K_{ib}u_{b} = f_{b} - K_{bi}K_{ii}^{-1}f_{i}\n$$\n在左侧提出公因子 $u_b$ 得到凝聚方程：\n$$\n(K_{bb} - K_{bi}K_{ii}^{-1}K_{ib}) u_{b} = f_{b} - K_{bi}K_{ii}^{-1}f_{i}\n$$\n这就是所需的仅用 $u_b$ 和单元数据表示的方程。我们可以定义凝聚（或有效）刚度矩阵 $\\tilde{K}$ 和凝聚（或有效）载荷向量 $\\tilde{f}$：\n$$\n\\tilde{K} = K_{bb} - K_{bi}K_{ii}^{-1}K_{ib}\n$$\n$$\n\\tilde{f} = f_{b} - K_{bi}K_{ii}^{-1}f_{i}\n$$\n凝聚系统随后可以紧凑地写为 $\\tilde{K}u_b = \\tilde{f}$。矩阵 $\\tilde{K}$ 是原始刚度矩阵中块 $K_{ii}$ 的舒尔补。\n\n这个过程减少了全局耦合自由度的数量，因为根据定义，内部自由度 $u_i$ 局限于单个单元，不参与相邻单元之间的耦合。全局方程组是通过在单元界面处强制解的连续性来组装的，这个过程只涉及边界自由度 $u_b$。通过在单元级别上消去 $u_i$，我们可以仅使用凝聚矩阵 $\\tilde{K}$ 来组装一个全局系统。这会产生一个显著更小的全局系统，从而减少了全局求解阶段的内存需求和计算成本。这种缩减的代价是每个单元需要预先计算 $K_{ii}^{-1}$ 和矩阵乘积。\n\n凝聚残差方程为 $\\tilde{K} u_b - \\tilde{f} = 0$。将 $u_b$ 映射到凝聚残差的算子，或者更具体地说，映射到残差中依赖于 $u_b$ 的那部分的算子，是凝聚刚度矩阵 $\\tilde{K} = K_{bb} - K_{bi}K_{ii}^{-1}K_{ib}$。\n\n**任务 B：凝聚刚度矩阵迹的计算**\n\n对于一个特定单元，我们被给予了以下无量纲子块：\n$$\nK_{bb}=\\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix},\\quad\nK_{bi}=\\begin{pmatrix} -1 & 0 \\\\ 0 & -1 \\end{pmatrix},\\quad\nK_{ii}=\\begin{pmatrix} 3 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\n问题指出该系统是对称的。对于对称的伽辽金公式，刚度矩阵是对称的，这意味着 $K_{ib} = K_{bi}^{T}$。鉴于 $K_{bi}$ 是一个对称矩阵（具体来说，是 2 阶单位矩阵的负数），我们有 $K_{ib} = K_{bi}^{T} = K_{bi} = \\begin{pmatrix} -1 & 0 \\\\ 0 & -1 \\end{pmatrix}$。\n\n任务是计算静态凝聚边界刚度矩阵 $\\tilde{K}$ 的迹。根据任务 A，其定义为：\n$$\n\\tilde{K} = K_{bb} - K_{bi}K_{ii}^{-1}K_{ib}\n$$\n首先，我们必须计算 $K_{ii}$ 的逆矩阵。对于一个通用的 $2 \\times 2$ 矩阵 $A = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$，其逆矩阵为 $A^{-1} = \\frac{1}{ad-bc}\\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$。\n对于 $K_{ii} = \\begin{pmatrix} 3 & 1 \\\\ 1 & 2 \\end{pmatrix}$：\n行列式为 $\\det(K_{ii}) = (3)(2) - (1)(1) = 6 - 1 = 5$。\n其逆矩阵为：\n$$\nK_{ii}^{-1} = \\frac{1}{5}\\begin{pmatrix} 2 & -1 \\\\ -1 & 3 \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{5} & -\\frac{1}{5} \\\\ -\\frac{1}{5} & \\frac{3}{5} \\end{pmatrix}\n$$\n现在我们计算舒尔补项，$S = K_{bi}K_{ii}^{-1}K_{ib}$。我们注意到 $K_{bi} = K_{ib} = -I$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$\nS = (-I) K_{ii}^{-1} (-I) = (-1)(-1) I K_{ii}^{-1} I = K_{ii}^{-1}\n$$\n所以，舒尔补项就是 $K_{ii}^{-1}$：\n$$\nS = \\begin{pmatrix} \\frac{2}{5} & -\\frac{1}{5} \\\\ -\\frac{1}{5} & \\frac{3}{5} \\end{pmatrix}\n$$\n现在我们可以计算凝聚刚度矩阵 $\\tilde{K}$：\n$$\n\\tilde{K} = K_{bb} - S = \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} - \\begin{pmatrix} \\frac{2}{5} & -\\frac{1}{5} \\\\ -\\frac{1}{5} & \\frac{3}{5} \\end{pmatrix}\n$$\n$$\n\\tilde{K} = \\begin{pmatrix} 2 - \\frac{2}{5} & -1 - (-\\frac{1}{5}) \\\\ -1 - (-\\frac{1}{5}) & 2 - \\frac{3}{5} \\end{pmatrix}\n= \\begin{pmatrix} \\frac{10}{5} - \\frac{2}{5} & -\\frac{5}{5} + \\frac{1}{5} \\\\ -\\frac{5}{5} + \\frac{1}{5} & \\frac{10}{5} - \\frac{3}{5} \\end{pmatrix}\n= \\begin{pmatrix} \\frac{8}{5} & -\\frac{4}{5} \\\\ -\\frac{4}{5} & \\frac{7}{5} \\end{pmatrix}\n$$\n最后一步是计算 $\\tilde{K}$ 的迹，即其对角线元素之和：\n$$\n\\text{tr}(\\tilde{K}) = \\frac{8}{5} + \\frac{7}{5} = \\frac{15}{5} = 3\n$$\n此单元的静态凝聚边界刚度的迹为 $3$。强迫项 $f_b$ 和 $f_i$ 为零不影响刚度矩阵 $\\tilde{K}$ 的计算。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "在模拟真实的流体动力学问题时，例如求解纳维-斯托克斯方程，我们必须处理非线性项（如对流项）。在离散化过程中，对这些非线性项的数值积分可能会引入难以察觉的误差，并对数值稳定性构成威胁。本练习将带您探讨一种被称为“混叠”的现象，即非线性项的不精确积分（欠积分）会导致能量在不同模式间发生非物理性的传递，最终引发计算失稳。您将通过对被积函数多项式阶数的实际分析，从根本上理解这一现象的成因，并探讨如何通过精确积分或构造特殊离散格式等策略来抑制这种不稳定性。掌握这种分析能力对于开发稳定可靠的高阶非线性求解器至关重要。",
            "id": "4006094",
            "problem": "考虑一个代表计算流体力学中非线性对流行为的标量守恒律，该守恒律在一维周期性区域 $\\Omega$ 上由 $\\partial_t u + \\partial_x f(u) = 0$ 给出，其中 $f(u) = \\tfrac{1}{2} u^2$。设近似解 $u_h(x,t)$ 位于每个单元上次数为 $p$ 的多项式空间中，并考虑一个标准的伽辽金加权残差法，其检验函数 $\\phi_i \\in \\mathcal{P}^p$，即最高次数为 $p$ 的多项式空间。通过分部积分得到的半离散弱形式为 $ \\int_{\\Omega} \\phi_i \\, \\partial_t u_h \\, dx - \\int_{\\Omega} \\partial_x \\phi_i \\, f(u_h) \\, dx = 0$，其中周期性导致边界项消失。假设体积分使用每个单元有 $Q$ 个点的高斯-勒让德求积法进行计算，该方法对最高次数为 $2Q - 1$ 的多项式是精确的。\n\n请基于上述加权残差框架和多项式次数计算进行推理，解释非线性项的积分不足如何导致高阶伽辽金方法中出现混叠误差，并确定基于第一性原理的有效缓解策略。具体而言，确定非线性项中体积分被积函数的多项式次数，并将其与求积精度要求联系起来，讨论混叠将能量在可解尺度和不可解尺度之间传递的机制，并描述过积分和精心构造的分裂形式如何抑制这些误差并提高稳定性。\n\n选择所有正确的陈述。\n\nA. 对于 $f(u) = \\tfrac{1}{2} u^2$ 和 $u_h \\in \\mathcal{P}^p$，弱形式体积分被积函数 $(-\\partial_x \\phi_i) \\, f(u_h)$ 的多项式次数最高可达 $3p - 1$，因此高斯-勒让德求积必须满足 $2Q - 1 \\ge 3p - 1$ (即 $Q \\ge \\lceil \\tfrac{3p}{2} \\rceil$) 以避免非线性项的积分不足。如果 $Q$ 较小（例如，当 $p > 2$ 时取 $Q = p + 1$），离散内积会失去精确性，高次内容被折叠到低次模态中，并发生非物理的能量传递。满足 $2Q - 1 \\ge 3p - 1$ 的过积分以及分裂或斜对称形式可以恢复离散抵消，并缓解由混叠驱动的不稳定性。\n\nB. 通过在插值节点处计算 $f(u_h)$，然后移除每个单元中最高的 $p$ 个模态系数，可以消除混叠。这必然将格式精度降低到一阶，但能防止对可解尺度的能量污染；因此，这是高阶伽辽金方法中的首选方法。\n\nC. 将守恒律写成强形式，并使用精确的微分矩阵对 $\\partial_x f(u_h)$ 进行离散，可以自动消除混叠，无论求积方法如何，因为微分是线性操作，而线性算子不会在多项式模态之间引入非线性耦合。\n\nD. 基于两点通量函数构建的熵守恒分裂形式，与满足离散分部求和（SBP）性质的求积和节点集相结合，可以通过强制执行凸熵的离散守恒及相关的稳定性来抑制混叠，即使在非线性项会超出朴素弱形式的求积精度的情况下也是如此。\n\nE. 在仿射单元上（其中从参考单元到物理单元的几何映射是线性的），过积分是不必要的，因为映射不增加被积函数的次数；因此，如果对所有体积分都使用 $Q = p + 1$，则不会发生混叠，无论非线性通量函数是什么。",
            "solution": "### 步骤 1：提取已知条件\n- **控制方程**：一维周期性区域 $\\Omega$ 上的标量守恒律 $\\partial_t u + \\partial_x f(u) = 0$。\n- **非线性通量**：$f(u) = \\tfrac{1}{2} u^2$。\n- **近似解**：$u_h(x,t)$ 位于每个单元上次数为 $p$ 的多项式空间中，记为 $\\mathcal{P}^p$。\n- **检验函数**：$\\phi_i$ 也位于空间 $\\mathcal{P}^p$ 中。\n- **弱形式**：半离散弱形式由 $\\int_{\\Omega} \\phi_i \\, \\partial_t u_h \\, dx - \\int_{\\Omega} \\partial_x \\phi_i \\, f(u_h) \\, dx = 0$ 给出。由于周期性，边界项消失。\n- **数值求积**：体积分使用每个单元有 $Q$ 个点的高斯-勒让德求积法计算。该法则对最高次数为 $2Q - 1$ 的多项式是精确的。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题陈述具有科学依据、适定且客观。\n1.  **科学或事实的可靠性**：该问题描述了应用于伯格斯方程（Burgers' equation）的标准伽辽金有限元方法，这是非线性双曲守恒律的一个典型模型。多项式近似空间、从分部积分推导出的弱形式以及高斯-勒让德求积等概念都是数值分析和计算流体力学中的标准和基础内容。关于因非线性项积分不足而引起的混叠问题，是高阶方法中一个核心且被深入研究的问题。该设置完全与已建立的理论一致。\n2.  **非形式化或不相关**：该问题高度形式化，并且与航空航天 CFD 中加权残差法和伽辽金方法的主题直接相关，高阶方法在解析复杂流动特征方面备受关注。\n3.  **不完整或矛盾的设置**：该问题是自洽的。它提供了偏微分方程、非线性的形式、解和检验函数的函数空间、弱形式以及所使用的求积法则类型。没有矛盾之处。\n4.  **不切实际或不可行**：该设置是一个在数值方法的开发和分析中广泛使用的标准简化模型问题。所有条件在数学上和计算上都是可行的。\n5.  **不适定或结构不良**：该问题是适定的。它要求解释一个已知的数值现象（混叠），并基于第一性原理评估缓解策略。在数值分析的背景下，术语是精确且无歧义的。\n6.  **伪深刻、琐碎或同义反复**：该问题探讨了高阶方法中一个真实且不容忽视的挑战。混叠不稳定性是一个微妙的问题，需要仔细分析多项式次数和离散算子。\n7.  **超出科学可验证范围**：待评估的陈述都可以通过对多项式空间和求积法则的数学分析来验证，这是该领域的标准做法。\n\n### 步骤 3：结论和行动\n问题陈述是 **有效的**。继续进行求解推导和选项分析。\n\n### 推导与分析\n\n该问题要求分析弱形式中非线性项引起的混叠误差。所讨论的项是空间积分，经过分部积分后为 $\\int_{\\Omega} \\partial_x \\phi_i \\, f(u_h) \\, dx$。让我们分析被积函数 $(\\partial_x \\phi_i) f(u_h)$ 的多项式次数。\n\n1.  近似解 $u_h$ 是一个最高次数为 $p$ 的多项式，所以 $u_h \\in \\mathcal{P}^p$。\n2.  检验函数 $\\phi_i$ 也是一个最高次数为 $p$ 的多项式，所以 $\\phi_i \\in \\mathcal{P}^p$。\n3.  因此，检验函数的导数 $\\partial_x \\phi_i$ 是一个最高次数为 $p-1$ 的多项式，即 $\\partial_x \\phi_i \\in \\mathcal{P}^{p-1}$。\n4.  非线性通量函数是 $f(u_h) = \\frac{1}{2} u_h^2$。由于 $u_h \\in \\mathcal{P}^p$，它的平方 $u_h^2$ 是一个最高次数为 $2p$ 的多项式。因此，$f(u_h) \\in \\mathcal{P}^{2p}$。\n5.  被积函数是 $(\\partial_x \\phi_i) f(u_h)$ 的乘积。多项式乘积的次数是它们次数的和。因此，被积函数的次数最高为 $(p-1) + 2p = 3p-1$。\n\n为了让具有 $Q$ 个点的高斯-勒让德求积法精确地计算这个积分，该法则必须对最高次数为 $3p-1$ 的多项式精确。问题陈述中提到，该法则对最高次数为 $2Q-1$ 的多项式是精确的。因此，为了精确积分，我们需要：\n$$ 2Q - 1 \\ge 3p - 1 $$\n$$ 2Q \\ge 3p $$\n$$ Q \\ge \\frac{3p}{2} $$\n由于 $Q$ 必须是整数，我们需要 $Q \\ge \\lceil \\frac{3p}{2} \\rceil$。\n\n如果这个条件不满足（即积分不足），数值求积会计算出一个不精确的积分值。这种不精确性意味着被积函数中次数高于 $2Q-1$ 的分量没有被正确计算。相反，它们的能量被“混叠”或“折叠回”到求积法能够解析的低次多项式模态上。可以证明，这个过程会破坏格式的离散守恒性质，通常导致能量的非物理累积和灾难性的不稳定性。\n\n缓解策略主要分为两大类：\n1.  **通过精确积分去混叠（过积分）**：最直接的方法是简单地使用足够多的求积点来满足条件 $Q \\ge \\lceil \\frac{3p}{2} \\rceil$。这通常被称为过积分，因为它需要的求积点比线性项（例如，质量矩阵 $\\int \\phi_i \\phi_j dx$，其被积函数次数为 $2p$，仅需要 $Q \\ge p+1/2$，即 $Q \\ge p+1$ 就能精确积分）所需的更多。\n2.  **通过构造格式去混叠（分裂形式）**：另一种方法是将非线性项重构成一个在连续意义上数学等价但具有更好离散性质的“分裂形式”。例如，基于分部求和（SBP）算子的方法被构造成在离散层面模拟分部积分。当与熵守恒通量结合时，它们可以强制执行离散熵守恒定律，即使在非线性项被形式上积分不足的情况下也能确保非线性稳定性。这可以防止混叠误差引起不稳定性。\n\n现在我们来评估每个选项。\n\n### 逐项分析\n\n**A. 对于 $f(u) = \\tfrac{1}{2} u^2$ 和 $u_h \\in \\mathcal{P}^p$，弱形式体积分被积函数 $(-\\partial_x \\phi_i) \\, f(u_h)$ 的多项式次数最高可达 $3p - 1$，因此高斯-勒让德求积必须满足 $2Q - 1 \\ge 3p - 1$ (即 $Q \\ge \\lceil \\tfrac{3p}{2} \\rceil$) 以避免非线性项的积分不足。如果 $Q$ 较小（例如，当 $p > 2$ 时取 $Q = p + 1$），离散内积会失去精确性，高次内容被折叠到低次模态中，并发生非物理的能量传递。满足 $2Q - 1 \\ge 3p - 1$ 的过积分以及分裂或斜对称形式可以恢复离散抵消，并缓解由混叠驱动的不稳定性。**\n\n这个陈述是对分析的全面而准确的总结。\n- 多项式次数的计算 $(p-1) + 2p = 3p-1$ 是正确的。\n- 推导出的求积要求 $Q \\ge \\lceil \\frac{3p}{2} \\rceil$ 是正确的。\n- 示例检查是正确的：对于 $p>2$，我们有 $p+1  \\frac{3p}{2}$（因为 $1  p/2$），所以 $Q=p+1$ 构成积分不足。\n- 将混叠描述为高次内容向低次模态的“折叠”在概念上是正确的。\n- 它正确地指出了两种主要的缓解策略：过积分和分裂/斜对称形式。\n**结论：正确**\n\n**B. 通过在插值节点处计算 $f(u_h)$，然后移除每个单元中最高的 $p$ 个模态系数，可以消除混叠。这必然将格式精度降低到一阶，但能防止对可解尺度的能量污染；因此，这是高阶伽辽金方法中的首选方法。**\n\n这个选项描述了一种基于投影的去混叠（滤波）形式。计算非线性项 $f(u_h) \\in \\mathcal{P}^{2p}$，然后将其投影回空间 $\\mathcal{P}^p$。虽然这类技术确实存在（例如，伪谱法中的 3/2 法则就是这种形式的一种），但“这必然将格式精度降低到一阶”这一说法是错误的。一个设计良好的去混叠投影滤波器旨在保持空间离散化的高阶精度。将格式降至一阶会完全违背使用高阶方法的初衷。因此，关于这是“首选方法”的结论也是错误的；如此剧烈的精度损失会使其非常不可取。\n**结论：不正确**\n\n**C. 将守恒律写成强形式，并使用精确的微分矩阵对 $\\partial_x f(u_h)$ 进行离散，可以自动消除混叠，无论求积方法如何，因为微分是线性操作，而线性算子不会在多项式模态之间引入非线性耦合。**\n\n这个陈述从根本上误解了混叠的来源。混叠是由于非线性函数 $f(u)$ 产生高频内容（例如，$u_h^2 \\in \\mathcal{P}^{2p}$），而这些内容无法被原始解空间（$\\mathcal{P}^p$）的基精确表示。切换到强的“配置法”形式并不能绕过这个问题。在配置法中，人们在配置节点上计算项 $f(u_h)$。这个节点值的向量是对完整多项式 $f(u_h) \\in \\mathcal{P}^{2p}$ 的不完整表示。将微分矩阵应用于 $f(u_h)$ 的这个混叠表示并不能消除混叠误差。“微分是线性操作”的论点是一个烟雾弹；在应用微分之前，非线性已经造成了问题。\n**结论：不正确**\n\n**D. 基于两点通量函数构建的熵守恒分裂形式，与满足离散分部求和（SBP）性质的求积和节点集相结合，可以通过强制执行凸熵的离散守恒及相关的稳定性来抑制混叠，即使在非线性项会超出朴素弱形式的求积精度的情况下也是如此。**\n\n这个陈述准确地描述了一类复杂而强大的现代高阶守恒律方法。\n- 熵守恒分裂形式（例如，基于 Tadmor 等人发展的两点通量）被设计用来满足一个导致熵守恒的离散版本的链式法则。\n- SBP 算子是模拟分部积分性质的离散微分算子，这对于证明关于离散能量或熵守恒的陈述至关重要。\n- 这两种思想的结合（通常在间断伽辽金 SBP 框架中）产生了通过构造保证非线性稳定的格式。这种稳定性是通过确保离散熵守恒（或耗散）来实现的，这防止了混叠驱动的不稳定性所特有的无界能量增长。即使求积法则不足以精确积分非线性项（即形式上的积分不足），这种方法也有效。它“抑制”了混叠的负面影响（不稳定性），为过积分提供了一个稳健的替代方案。\n**结论：正确**\n\n**E. 在仿射单元上（其中从参考单元到物理单元的几何映射是线性的），过积分是不必要的，因为映射不增加被积函数的次数；因此，如果对所有体积分都使用 $Q = p + 1$，则不会发生混叠，无论非线性通量函数是什么。**\n\n这个陈述的推理中存在一个关键缺陷。诚然，在仿射单元上，几何变换的雅可比行列式是常数，因此从参考单元到物理单元的映射不会增加被积函数的多项式次数。然而，这与偏微分方程本身的非线性所导致的次数增加无关。正如在主要分析中所示，被积函数 $(\\partial_x\\phi_i) f(u_h)$ 在考虑任何几何变换之前，其次数就已达到 $3p-1$。一个具有 $Q=p+1$ 个点的求积法对最高次数为 $2(p+1)-1 = 2p+1$ 的多项式是精确的。对于任何 $p2$，我们有 $3p-1  2p+1$，这意味着求积是不充分的。因此，混叠仍然会发生。仿射映射仅仅意味着几何问题没有让问题变得更糟；它并没有解决由非线性引起的现有问题。\n**结论：不正确**",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}