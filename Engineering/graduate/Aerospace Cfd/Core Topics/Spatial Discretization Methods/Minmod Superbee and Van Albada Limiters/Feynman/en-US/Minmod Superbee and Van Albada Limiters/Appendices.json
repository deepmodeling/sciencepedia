{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in mastering flux limiters is to develop an intuition for their behavior. This exercise provides a direct quantitative comparison of how different limiters respond to varying gradient ratios, represented by the parameter $r$. By calculating the limiter function $\\phi(r)$ for a diffusive limiter (minmod), a compressive one (superbee), and a smooth, balanced one (van Leer, which shares key characteristics with van Albada), you will build a foundational understanding of their distinct properties and how they modulate numerical diffusion and compression. ",
            "id": "3362592",
            "problem": "Consider the scalar conservation law $\\partial_t u + \\partial_x f(u) = 0$ discretized by a second-order Monotone Upstream-Centered Schemes for Conservation Laws (MUSCL) reconstruction with a Total Variation Diminishing (TVD) flux limiter $\\phi(r)$. The ratio $r$ is defined as the ratio of successive one-sided differences in a uniform grid, $r = \\dfrac{\\Delta^- u}{\\Delta^+ u}$, where $\\Delta^- u$ and $\\Delta^+ u$ are backward and forward discrete gradients, respectively, evaluated at a cell interface. In high-resolution TVD schemes, $\\phi(r)$ must respect monotonicity constraints that prevent new extrema while still allowing second-order accuracy in smooth regions. Three widely used limiters are the minmod, superbee, and van Leer limiters, each with distinct compressive and diffusive properties.\n\nWithout using any provided formulas, compute the values $\\phi(r)$ at $r = 0.25$, $r = 1$, and $r = 4$ for the minmod, superbee, and van Leer limiters. Then, based on the computed values and the role of limiter smoothness in switching between first- and second-order behavior, identify the option that correctly reports all three sets of values and accurately characterizes how the smoothness of the van Leer limiter balances numerical diffusion (over-smoothing) and compression (steepening) within the TVD framework.\n\nChoose the single best answer.\n\nA. Minmod: $\\phi(0.25) = 0.25$, $\\phi(1) = 1$, $\\phi(4) = 1$; Superbee: $\\phi(0.25) = 0.5$, $\\phi(1) = 1$, $\\phi(4) = 2$; Van Leer: $\\phi(0.25) = 0.4$, $\\phi(1) = 1$, $\\phi(4) = 1.6$. Van Leer is a smooth (continuously differentiable for $r > 0$), monotone limiter that lies strictly below the Sweby upper envelope except at isolated points, thereby moderating compression relative to superbee and reducing diffusion relative to minmod, with smooth transitions that reduce switching-induced artifacts.\n\nB. Minmod: $\\phi(0.25) = 0.25$, $\\phi(1) = 0.5$, $\\phi(4) = 1$; Superbee: $\\phi(0.25) = 0.5$, $\\phi(1) = 1$, $\\phi(4) = 2$; Van Leer: $\\phi(0.25) = 0.2$, $\\phi(1) = 0.5$, $\\phi(4) = 0.8$. Van Leer is more compressive than superbee for all $r > 0$ because it reaches the TVD upper bound.\n\nC. Minmod: $\\phi(0.25) = 0.25$, $\\phi(1) = 1$, $\\phi(4) = 1$; Superbee: $\\phi(0.25) = 0.25$, $\\phi(1) = 1$, $\\phi(4) = 1$; Van Leer: $\\phi(0.25) = 0.25$, $\\phi(1) = 1$, $\\phi(4) = 1$. Van Leer behaves identically to minmod for $r \\leq 1$ and is no more compressive than minmod for $r > 1$.\n\nD. Minmod: $\\phi(0.25) = 0.25$, $\\phi(1) = 1$, $\\phi(4) = 1$; Superbee: $\\phi(0.25) = 0.5$, $\\phi(1) = 1$, $\\phi(4) = 1$; Van Leer: $\\phi(0.25) \\approx 0.294$, $\\phi(1) = 1$, $\\phi(4) \\approx 1.176$. Van Leer is differentiable for all $r$ and remains strictly below minmod for $r \\geq 1$, minimizing compression more than minmod.",
            "solution": "We start from the scalar conservation law $\\partial_t u + \\partial_x f(u) = 0$ and the requirement that high-resolution schemes maintain Total Variation Diminishing (TVD) properties to prevent spurious oscillations. In MUSCL-type reconstructions, the slope in each cell is limited by a flux limiter function $\\phi(r)$, where $r$ is the ratio of successive gradients, $r = \\dfrac{\\Delta^- u}{\\Delta^+ u}$. Standard TVD theory (Harten and Sweby) characterizes the admissible region for $\\phi(r)$ that ensures monotonicity while allowing second-order accuracy in smooth solutions. Within this framework, different limiters represent different choices of $\\phi(r)$ that trade off compression (steepening of gradients) and diffusion (smoothing).\n\nThe three limiters under consideration are defined in widely accepted form as follows (these are well-tested formulas):\n\n1. Minmod limiter: $\\phi_{\\mathrm{MM}}(r) = \\max\\left(0, \\min(1, r)\\right)$.\n2. Superbee limiter: $\\phi_{\\mathrm{SB}}(r) = \\max\\left(0, \\min(2r, 1), \\min(r, 2)\\right)$.\n3. Van Leer limiter: $\\phi_{\\mathrm{VL}}(r) = \\dfrac{r + |r|}{1 + |r|}$.\n\nWe evaluate at $r = 0.25$, $r = 1$, and $r = 4$, all of which are nonnegative, so $|r| = r$.\n\nCompute for $r = 0.25$:\n- Minmod: $\\phi_{\\mathrm{MM}}(0.25) = \\max(0, \\min(1, 0.25)) = \\max(0, 0.25) = 0.25$.\n- Superbee: $\\min(2r, 1) = \\min(0.5, 1) = 0.5$; $\\min(r, 2) = \\min(0.25, 2) = 0.25$; thus $\\phi_{\\mathrm{SB}}(0.25) = \\max(0, 0.5, 0.25) = 0.5$.\n- Van Leer: $\\phi_{\\mathrm{VL}}(0.25) = \\dfrac{0.25 + 0.25}{1 + 0.25} = \\dfrac{0.5}{1.25} = 0.4$.\n\nCompute for $r = 1$:\n- Minmod: $\\phi_{\\mathrm{MM}}(1) = \\max(0, \\min(1, 1)) = 1$.\n- Superbee: $\\min(2r, 1) = \\min(2, 1) = 1$; $\\min(r, 2) = \\min(1, 2) = 1$; thus $\\phi_{\\mathrm{SB}}(1) = \\max(0, 1, 1) = 1$.\n- Van Leer: $\\phi_{\\mathrm{VL}}(1) = \\dfrac{1 + 1}{1 + 1} = \\dfrac{2}{2} = 1$.\n\nCompute for $r = 4$:\n- Minmod: $\\phi_{\\mathrm{MM}}(4) = \\max(0, \\min(1, 4)) = 1$.\n- Superbee: $\\min(2r, 1) = \\min(8, 1) = 1$; $\\min(r, 2) = \\min(4, 2) = 2$; thus $\\phi_{\\mathrm{SB}}(4) = \\max(0, 1, 2) = 2$.\n- Van Leer: $\\phi_{\\mathrm{VL}}(4) = \\dfrac{4 + 4}{1 + 4} = \\dfrac{8}{5} = 1.6$.\n\nThese values illustrate the trade-offs:\n- Minmod is most diffusive: it caps at $1$ for $r \\geq 1$, and equals $r$ for $0 \\le r \\le 1$, strongly damping steepening.\n- Superbee is most compressive within the TVD region: for $r$ large it approaches $2$, aggressively steepening gradients while remaining TVD.\n- Van Leer is smooth for $r  0$ (it is continuously differentiable for $r  0$) and monotone. For $0  r  1$, $\\phi_{\\mathrm{VL}}(r) = \\dfrac{2r}{1+r}$ lies strictly below the Sweby upper envelope $\\phi = 2r$. For $r \\geq 1$, $\\phi_{\\mathrm{VL}}(r) = \\dfrac{2r}{1+r}$ lies strictly below the upper envelope $\\phi = \\min(r, 2)$ except at isolated points such as $r = 1$ (where it equals $1$). This smoothness helps avoid abrupt switching and reduces numerical artifacts, yielding moderate compression relative to superbee and reduced diffusion compared to minmod.\n\nOption-by-option analysis:\n\nA. Reports minmod as $\\phi(0.25) = 0.25$, $\\phi(1) = 1$, $\\phi(4) = 1$; superbee as $\\phi(0.25) = 0.5$, $\\phi(1) = 1$, $\\phi(4) = 2$; van Leer as $\\phi(0.25) = 0.4$, $\\phi(1) = 1$, $\\phi(4) = 1.6$. All match the computed values. The characterization of van Leer as smooth (continuously differentiable for $r  0$), lying strictly below the upper TVD envelope except at isolated points, and balancing diffusion and compression between minmod and superbee is accurate. Verdict: Correct.\n\nB. Minmod values $\\phi(1) = 0.5$ and van Leer values $\\phi(0.25) = 0.2$, $\\phi(1) = 0.5$, $\\phi(4) = 0.8$ correspond to the incorrect formula $\\phi(r) = \\dfrac{r}{1+r}$. Superbee values are correct, but the van Leer numbers and the claim that van Leer is more compressive than superbee and reaches the upper bound are both false; van Leer lies below the upper envelope for finite $r$. Verdict: Incorrect.\n\nC. Superbee and van Leer reported equal to minmod at $r = 0.25$ and $r = 4$ are wrong; superbee is more compressive, and van Leer is strictly between minmod and superbee for these $r$. The qualitative claim that van Leer behaves identically to minmod for $r \\leq 1$ and is no more compressive than minmod for $r  1$ contradicts the computed values ($\\phi_{\\mathrm{VL}}(0.25) = 0.4  0.25$ and $\\phi_{\\mathrm{VL}}(4) = 1.6  1$). Verdict: Incorrect.\n\nD. The van Leer values given, $\\phi(0.25) \\approx 0.294$ and $\\phi(4) \\approx 1.176$, correspond to a different limiter (van Albada) with $\\phi(r) = \\dfrac{r^2 + r}{1 + r^2}$, not van Leer. Superbee at $r = 4$ reported as $\\phi = 1$ is also incorrect; it should be $\\phi = 2$. The qualitative claim that van Leer remains strictly below minmod for $r \\geq 1$ is false (for van Leer, $\\phi_{\\mathrm{VL}}(4) = 1.6  1$). Verdict: Incorrect.\n\nTherefore, the correct choice is A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The mathematical bounds placed on limiter functions within the Total Variation Diminishing (TVD) framework are not arbitrary; they are essential for preventing the growth of non-physical oscillations. This practice is a carefully designed thought experiment to demonstrate the concrete consequences of violating these bounds. By employing a hypothetical \"bad\" limiter that lies outside the admissible TVD region, you will observe the creation of new extrema (overshoots and undershoots) and quantify the resulting growth in total variation, reinforcing the fundamental need for monotonicity-preserving schemes when capturing sharp gradients. ",
            "id": "3976017",
            "problem": "Consider the scalar linear advection equation $\\partial_{t} u + a\\,\\partial_{x} u = 0$ with positive advection speed $a0$, discretized by a finite volume method on a uniform grid with spacing $\\Delta x$ and cell-averaged unknowns $u_{i}^{n}$. Use the monotonic upstream-centered scheme for conservation laws (MUSCL) reconstruction with a slope limiter function $\\phi(r)$, where the ratio $r$ is defined by $r_{i} = \\dfrac{u_{i}^{n} - u_{i-1}^{n}}{u_{i-1}^{n} - u_{i-2}^{n}}$ whenever the denominator is nonzero, and by the convention $r_{i} \\to +\\infty$ when $u_{i-1}^{n} - u_{i-2}^{n} = 0$ and $u_{i}^{n} - u_{i-1}^{n}  0$. The left state at the interface $i+\\tfrac{1}{2}$ is reconstructed as $u_{i+1/2}^{L} = u_{i}^{n} + \\dfrac{1}{2}\\,\\phi(r_{i})\\,(u_{i}^{n} - u_{i-1}^{n})$. With positive $a$, the upwind numerical flux is $f_{i+1/2} = a\\,u_{i+1/2}^{L}$ and the update is $u_{i}^{n+1} = u_{i}^{n} - \\lambda\\,(f_{i+1/2} - f_{i-1/2})$, where $\\lambda = a\\,\\Delta t/\\Delta x$ is the Courant number.\n\nDefine the total variation of the piecewise-constant sequence $\\{u_{i}^{n}\\}$ by $\\mathrm{TV}(u^{n}) = \\sum_{i} |u_{i+1}^{n} - u_{i}^{n}|$. Total Variation Diminishing (TVD) schemes impose bounds on $\\phi(r)$ to prevent spurious oscillations near discontinuities. In this exercise, deliberately violate those bounds to construct a counterexample and quantify the resulting growth of total variation over one step.\n\nUse the following data and choices:\n- The scalar $u$ is dimensionless, $a = 1$, $\\Delta x = 1$, and $\\lambda = \\dfrac{1}{2}$.\n- Initial data at time $t^{n}$: $u_{i}^{n} = 0$ for all $i \\leq 0$, $u_{i}^{n} = 1$ for all $i \\geq 1$.\n- The slope limiter is chosen as $\\phi_{\\text{bad}}(r) = 3$ for $r \\geq 0$ and $\\phi_{\\text{bad}}(r) = 0$ for $r  0$.\n\nStarting from these definitions and the finite volume update, compute $u_{i}^{n+1}$ for the indices $i = 0, 1, 2, 3$, and demonstrate the emergence of Gibbs-like overshoot and undershoot adjacent to the discontinuity. Then compute $\\mathrm{TV}(u^{n+1})$ and the total variation growth $\\Delta \\mathrm{TV} = \\mathrm{TV}(u^{n+1}) - \\mathrm{TV}(u^{n})$. Express the final answer for $\\Delta \\mathrm{TV}$ as a single dimensionless real number. If your result is not an integer, round your answer to four significant figures.",
            "solution": "The problem requires the calculation of the total variation growth over a single time step for a linear advection equation discretized with a MUSCL finite volume scheme. The chosen slope limiter function, $\\phi_{\\text{bad}}(r)$, intentionally violates the Total Variation Diminishing (TVD) criteria, and we expect to observe an increase in the total variation of the solution.\n\nThe finite volume update rule is given by $u_{i}^{n+1} = u_{i}^{n} - \\lambda\\,(f_{i+1/2} - f_{i-1/2})$, where the numerical flux is $f_{i+1/2} = a\\,u_{i+1/2}^{L}$ and the Courant number is $\\lambda = \\dfrac{a\\,\\Delta t}{\\Delta x}$. We are given the parameters $a=1$, $\\Delta x=1$, and $\\lambda = \\dfrac{1}{2}$. This simplifies the update rule to $u_{i}^{n+1} = u_{i}^{n} - \\dfrac{1}{2}\\,(u_{i+1/2}^{L} - u_{i-1/2}^{L})$, where $u_{i+1/2}^{L}$ is the reconstructed state at the left side of the interface $i+\\dfrac{1}{2}$.\n\nThe initial condition is a step function:\n$$ u_{i}^{n} = \\begin{cases} 0  \\text{for } i \\leq 0 \\\\ 1  \\text{for } i \\geq 1 \\end{cases} $$\nFirst, we compute the initial total variation, $\\mathrm{TV}(u^{n}) = \\sum_{i} |u_{i+1}^{n} - u_{i}^{n}|$. The only non-zero difference occurs at the interface between cell $i=0$ and cell $i=1$.\n$$ \\mathrm{TV}(u^{n}) = |u_{1}^{n} - u_{0}^{n}| = |1 - 0| = 1 $$\n\nNext, we proceed to compute the updated values $u_{i}^{n+1}$. This requires calculating the reconstructed states $u_{i+1/2}^{L}$. The reconstruction formula is:\n$$ u_{i+1/2}^{L} = u_{i}^{n} + \\dfrac{1}{2}\\,\\phi(r_{i})\\,(u_{i}^{n} - u_{i-1}^{n}) $$\nThe slope limiter function is $\\phi(r) = 3$ for $r \\geq 0$ and $\\phi(r) = 0$ for $r  0$. The ratio $r_i$ is defined as $r_{i} = \\dfrac{u_{i}^{n} - u_{i-1}^{n}}{u_{i-1}^{n} - u_{i-2}^{n}}$.\n\nWe must evaluate the difference ratios $r_i$ for each cell $i$:\n- For $i \\leq 0$: $u_{i}^{n} = u_{i-1}^{n} = u_{i-2}^{n} = 0$. The slope term $(u_{i}^{n} - u_{i-1}^{n})$ is $0$, so the reconstruction is simply $u_{i+1/2}^{L} = u_{i}^{n} = 0$.\n- For $i=1$: $u_{1}^{n}=1$, $u_{0}^{n}=0$, $u_{-1}^{n}=0$. The ratio is $r_{1} = \\dfrac{u_{1}^{n} - u_{0}^{n}}{u_{0}^{n} - u_{-1}^{n}} = \\dfrac{1-0}{0-0} = \\dfrac{1}{0}$. According to the problem's convention, since the numerator is positive and the denominator is zero, $r_{1} \\to +\\infty$. As $r_1 \\ge 0$, we have $\\phi(r_{1}) = 3$.\n- For $i=2$: $u_{2}^{n}=1$, $u_{1}^{n}=1$, $u_{0}^{n}=0$. The ratio is $r_{2} = \\dfrac{u_{2}^{n} - u_{1}^{n}}{u_{1}^{n} - u_{0}^{n}} = \\dfrac{1-1}{1-0} = 0$. As $r_2 \\ge 0$, we have $\\phi(r_{2}) = 3$.\n- For $i \\geq 3$: $u_{i}^{n} = u_{i-1}^{n} = u_{i-2}^{n} = 1$. The slope term $(u_{i}^{n} - u_{i-1}^{n})$ is $0$, so the reconstruction is $u_{i+1/2}^{L} = u_{i}^{n} = 1$.\n\nNow we compute the necessary reconstructed states $u_{i+1/2}^{L}$:\n- For $i \\leq 0$, as established, $u_{i+1/2}^{L} = u_{i}^{n} = 0$. In particular, $u_{-1/2}^{L}=0$ and $u_{1/2}^{L}=0$.\n- For $i=1$: $u_{3/2}^{L} = u_{1}^{n} + \\dfrac{1}{2}\\,\\phi(r_{1})\\,(u_{1}^{n} - u_{0}^{n}) = 1 + \\dfrac{1}{2}(3)(1-0) = 1 + \\dfrac{3}{2} = 2.5$.\n- For $i=2$: $u_{5/2}^{L} = u_{2}^{n} + \\dfrac{1}{2}\\,\\phi(r_{2})\\,(u_{2}^{n} - u_{1}^{n}) = 1 + \\dfrac{1}{2}(3)(1-1) = 1 + 0 = 1$.\n- For $i \\geq 2$, the reconstructed state is $u_{i+1/2}^{L} = u_{i}^{n} = 1$. This means $u_{5/2}^{L}=1$, $u_{7/2}^{L}=1$, and so on.\n\nWith the reconstructed states (which act as numerical fluxes for $a=1$), we can now update the cell averages $u_{i}^{n+1}$ for the required indices.\n- For $i=0$: $u_{0}^{n+1} = u_{0}^{n} - \\dfrac{1}{2}\\,(u_{1/2}^{L} - u_{-1/2}^{L}) = 0 - \\dfrac{1}{2}\\,(0 - 0) = 0$.\n- For $i=1$: $u_{1}^{n+1} = u_{1}^{n} - \\dfrac{1}{2}\\,(u_{3/2}^{L} - u_{1/2}^{L}) = 1 - \\dfrac{1}{2}\\,(2.5 - 0) = 1 - 1.25 = -0.25$. This is a new undershoot, as predicted.\n- For $i=2$: $u_{2}^{n+1} = u_{2}^{n} - \\dfrac{1}{2}\\,(u_{5/2}^{L} - u_{3/2}^{L}) = 1 - \\dfrac{1}{2}\\,(1 - 2.5) = 1 - \\dfrac{1}{2}(-1.5) = 1 + 0.75 = 1.75$. This is a new overshoot.\n- For $i=3$: $u_{3}^{n+1} = u_{3}^{n} - \\dfrac{1}{2}\\,(u_{7/2}^{L} - u_{5/2}^{L}) = 1 - \\dfrac{1}{2}\\,(1 - 1) = 1$.\nFor any $i \\leq 0$, the fluxes are zero, so $u_{i}^{n+1} = 0$. For any $i \\geq 3$, the fluxes are all $1$, so $u_{i}^{n+1} = 1$.\n\nThe solution at time $t^{n+1}$ is the sequence:\n$$ u_{i}^{n+1} = \\begin{cases} 0  \\text{for } i \\leq 0 \\\\ -0.25  \\text{for } i=1 \\\\ 1.75  \\text{for } i=2 \\\\ 1  \\text{for } i \\geq 3 \\end{cases} $$\n\nNext, we compute the total variation of this new state, $\\mathrm{TV}(u^{n+1})$:\n$$ \\mathrm{TV}(u^{n+1}) = \\sum_{i} |u_{i+1}^{n+1} - u_{i}^{n+1}| $$\nThe non-zero terms in the sum are:\n- For $i=0$: $|u_{1}^{n+1} - u_{0}^{n+1}| = |-0.25 - 0| = 0.25$.\n- For $i=1$: $|u_{2}^{n+1} - u_{1}^{n+1}| = |1.75 - (-0.25)| = |2.0| = 2.0$.\n- For $i=2$: $|u_{3}^{n+1} - u_{2}^{n+1}| = |1 - 1.75| = |-0.75| = 0.75$.\nAll other differences are zero.\nSumming these contributions gives the new total variation:\n$$ \\mathrm{TV}(u^{n+1}) = 0.25 + 2.0 + 0.75 = 3.0 $$\n\nFinally, we compute the total variation growth, $\\Delta \\mathrm{TV}$:\n$$ \\Delta \\mathrm{TV} = \\mathrm{TV}(u^{n+1}) - \\mathrm{TV}(u^{n}) = 3.0 - 1 = 2 $$\nThe total variation increased, confirming that the scheme with the limiter $\\phi_{\\text{bad}}(r)$ is not TVD. The growth in total variation is exactly $2$.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "This final practice is where theory meets application, challenging you to implement and evaluate limiters in a working numerical simulation. After exploring the properties of limiters and the importance of TVD constraints, you will now integrate the minmod, superbee, and van Albada limiters into a MUSCL finite volume scheme for the nonlinear Burgers' equation. By measuring the numerical shock's smearing width and position error, you will gain direct, practical insight into how the choice of limiter critically impacts the accuracy and resolution of a CFD simulation, highlighting the real-world trade-offs between capturing sharp features and maintaining numerical stability. ",
            "id": "3976018",
            "problem": "Consider the one-dimensional scalar conservation law with a convex flux, posed on a uniform grid of $N$ cells over the unit interval $[0,1]$,\n$$\n\\partial_t u(x,t) + \\partial_x f(u(x,t)) = 0,\n$$\nwith the inviscid Burgers flux $f(u) = \\tfrac{1}{2}u^2$. The initial condition is a Riemann problem with a single jump located at $x_0$, given by\n$$\nu(x,0) =\n\\begin{cases}\nu_L,  x  x_0,\\\\\nu_R,  x \\ge x_0.\n\\end{cases}\n$$\nIntegrate this partial differential equation by a one-step, explicit finite volume method using Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) piecewise-linear reconstruction in each cell. The reconstruction slope in cell $i$ must be limited by one of the three Total Variation Diminishing (TVD) limiters: the minmod limiter, the superbee limiter, and the van Albada limiter. At each interface, compute the numerical flux by the exact Godunov flux for the inviscid Burgers equation. Use two ghost cells on each boundary, fixed to the left and right constant states, so that the Riemann problem remains well posed for the short one-step evolution.\n\nFrom first principles, the scheme must be derived from the integral conservation over each cell $[x_{i-\\tfrac{1}{2}},x_{i+\\tfrac{1}{2}}]$:\n$$\n\\frac{d}{dt}\\bar{u}_i(t) = -\\frac{1}{\\Delta x}\\left(F_{i+\\tfrac{1}{2}}(t) - F_{i-\\tfrac{1}{2}}(t)\\right),\n$$\nwhere $\\bar{u}_i(t)$ is the cell average and $F_{i\\pm\\tfrac{1}{2}}(t)$ are the interfacial numerical fluxes computed consistently with the local Riemann problem induced by the MUSCL reconstruction. The limiter functions must enforce monotonicity to avoid the creation of new extrema in the one-step update.\n\nTake a single time step $\\Delta t$ determined by a Courant-Friedrichs-Lewy (CFL) condition $\\lambda = \\Delta t / \\Delta x$ chosen as\n$$\n\\lambda = \\frac{\\mathrm{CFL}}{\\max\\left(|u_L|,|u_R|\\right)},\n$$\nso that the fastest characteristic speed $|f'(u)| = |u|$ is respected. For the inviscid Burgers shock with $u_L  u_R$, the exact shock speed is given by the Rankineâ€“Hugoniot condition:\n$$\ns = \\frac{f(u_L) - f(u_R)}{u_L - u_R} = \\frac{u_L + u_R}{2},\n$$\nand the exact shock position after one step is $x_{\\mathrm{exact}} = x_0 + s \\Delta t$.\n\nFor each limiter, after the single explicit update, define:\n- the numerical shock position $x_{\\mathrm{num}}$ as the first interfacial location $x_{i+\\tfrac{1}{2}}$ where the updated adjacent cell averages first straddle the midpoint value $u_{\\mathrm{mid}} = \\tfrac{1}{2}(u_L + u_R)$, i.e., one cell average is greater than or equal to $u_{\\mathrm{mid}}$ and the next is less than or equal to $u_{\\mathrm{mid}}$;\n- the smearing width $w$ as the total length of all cells whose updated averages lie strictly between $u_R$ and $u_L$, i.e., the number of such cells times $\\Delta x$.\n\nCompute, for each limiter, the absolute position error $|x_{\\mathrm{num}} - x_{\\mathrm{exact}}|$ and the smearing width $w$ after the single time step.\n\nYour program must implement this one-step MUSCL finite volume update with all three limiters and Godunov flux for Burgers, for the following test suite of Riemann problems, all with the same CFL number and $x_0 = 0.5$:\n- Test case 1 (happy path): $u_L = 2.0$, $u_R = 0.0$, $N = 200$, $\\mathrm{CFL} = 0.45$.\n- Test case 2 (small shock amplitude boundary case): $u_L = 1.0$, $u_R = 0.9$, $N = 200$, $\\mathrm{CFL} = 0.45$.\n- Test case 3 (strong shock with sign change edge case): $u_L = 3.0$, $u_R = -1.0$, $N = 400$, $\\mathrm{CFL} = 0.45$.\n\nAll quantities are dimensionless. For each test case, your program must return a list of six floating-point numbers in the order\n$$\n\\left[\\,E_{\\mathrm{mm}},\\,W_{\\mathrm{mm}},\\,E_{\\mathrm{sb}},\\,W_{\\mathrm{sb}},\\,E_{\\mathrm{va}},\\,W_{\\mathrm{va}}\\,\\right],\n$$\nwhere $E_{\\mathrm{mm}}$ and $W_{\\mathrm{mm}}$ are the absolute position error and smearing width for the minmod limiter, $E_{\\mathrm{sb}}$ and $W_{\\mathrm{sb}}$ are those for the superbee limiter, and $E_{\\mathrm{va}}$ and $W_{\\mathrm{va}}$ are those for the van Albada limiter.\n\nFinal output format: Your program should produce a single line of output containing the results for the three test cases as a comma-separated list of these per-case lists, with no spaces, enclosed in square brackets, for example\n$$\n\\left[\\,[r_{11},r_{12},\\ldots,r_{16}],\\,[r_{21},\\ldots,r_{26}],\\,[r_{31},\\ldots,r_{36}]\\,\\right].\n$$",
            "solution": "The user has provided a valid problem statement from the field of computational fluid dynamics (CFD), specifically concerning numerical methods for hyperbolic conservation laws. The problem requires the implementation and comparison of a an explicit, one-step, second-order Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) finite volume method. Therefore, a complete solution will be provided.\n\n### 1. Theoretical Formulation\n\nThe problem considers the one-dimensional scalar conservation law given by\n$$\n\\partial_t u(x,t) + \\partial_x f(u(x,t)) = 0, \\quad x \\in [0,1],\n$$\nwith the convex, inviscid Burgers' flux function $f(u) = \\frac{1}{2}u^2$. The initial condition is a Riemann problem, a piecewise-constant function with a single discontinuity at $x_0$:\n$$\nu(x,0) =\n\\begin{cases}\nu_L,  x  x_0,\\\\\nu_R,  x \\ge x_0.\n\\end{cases}\n$$\nFor the cases where $u_L  u_R$, the exact solution consists of a single shock wave propagating with speed $s$, given by the Rankine-Hugoniot condition:\n$$\ns = \\frac{f(u_L) - f(u_R)}{u_L - u_R} = \\frac{\\frac{1}{2}u_L^2 - \\frac{1}{2}u_R^2}{u_L - u_R} = \\frac{u_L + u_R}{2}.\n$$\nAfter a time step $\\Delta t$, the exact position of this shock is $x_{\\mathrm{exact}} = x_0 + s \\Delta t$.\n\n### 2. Finite Volume Discretization\n\nThe spatial domain $[0,1]$ is discretized into $N$ uniform cells, each of width $\\Delta x = 1/N$. The $i$-th cell, for $i=1, \\dots, N$, occupies the interval $[x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$, where $x_{i-\\frac{1}{2}} = (i-1)\\Delta x$. The cell average of the solution $u(x,t)$ over cell $i$ is denoted by $\\bar{u}_i(t)$. Integrating the PDE over cell $i$ yields the semi-discrete finite volume formulation:\n$$\n\\frac{d}{dt}\\bar{u}_i(t) = -\\frac{1}{\\Delta x}\\left(F_{i+\\frac{1}{2}}(t) - F_{i-\\frac{1}{2}}(t)\\right),\n$$\nwhere $F_{i\\pm\\frac{1}{2}}(t)$ are the numerical fluxes at the cell interfaces. Applying a forward Euler method for time integration, we obtain the fully discrete explicit update formula:\n$$\n\\bar{u}_i^{n+1} = \\bar{u}_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right).\n$$\nThe time step $\\Delta t$ is constrained by the Courant-Friedrichs-Lewy (CFL) condition, $\\lambda \\max |f'(u)| \\le \\mathrm{CFL_{max}}$, where $\\lambda = \\Delta t/\\Delta x$. For the Burgers' equation, $f'(u)=u$, so $\\Delta t$ is chosen as:\n$$\n\\Delta t = \\frac{\\mathrm{CFL} \\cdot \\Delta x}{\\max(|u_L|, |u_R|)}.\n$$\n\n### 3. MUSCL-Hancock Scheme\n\nThe MUSCL scheme achieves second-order spatial accuracy by reconstructing a piecewise-linear representation of the solution within each cell at time $t^n$. The value of $u$ in cell $i$ is approximated by:\n$$\nu_i(x, t^n) = \\bar{u}_i^n + \\frac{\\sigma_i}{\\Delta x}(x - x_i), \\quad x \\in [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}].\n$$\nHere, $\\sigma_i$ is a limited slope designed to maintain monotonicity and prevent spurious oscillations. This reconstruction defines values on either side of each cell interface $x_{i+\\frac{1}{2}}$:\n$$\nu_{i+\\frac{1}{2}}^L = \\bar{u}_i^n + \\frac{1}{2}\\sigma_i \\quad (\\text{left state, from cell } i),\n$$\n$$\nu_{i+\\frac{1}{2}}^R = \\bar{u}_{i+1}^n - \\frac{1}{2}\\sigma_{i+1} \\quad (\\text{right state, from cell } i+1).\n$$\nThese two states, $u_{i+\\frac{1}{2}}^L$ and $u_{i+\\frac{1}{2}}^R$, define a local Riemann problem at the interface, the solution of which determines the numerical flux $F_{i+\\frac{1}{2}}^n$.\n\n### 4. Slope Limiting (TVD)\n\nTo ensure the scheme is Total Variation Diminishing (TVD) and thus monotonic, the slope $\\sigma_i$ is computed by applying a limiter function to candidate slopes derived from neighboring cell averages. A common approach is to limit based on the forward and backward difference slopes. Let $a_i = \\bar{u}_i^n - \\bar{u}_{i-1}^n$ and $b_i = \\bar{u}_{i+1}^n - \\bar{u}_i^n$. The limited slope for cell $i$ is $\\sigma_i = \\phi(a_i, b_i)$. We implement three limiters:\n\n1.  **Minmod Limiter:** This is the most dissipative of the common limiters.\n    $$\n    \\phi_{\\mathrm{mm}}(a, b) = \\begin{cases} \\mathrm{sgn}(a) \\min(|a|, |b|)  \\text{if } ab  0 \\\\ 0  \\text{if } ab \\le 0 \\end{cases}.\n    $$\n2.  **Superbee Limiter:** A more compressive (less dissipative) limiter, known for resolving contact discontinuities sharply.\n    $$\n    \\phi_{\\mathrm{sb}}(a, b) = \\max(\\phi_{\\mathrm{mm}}(a, 2b), \\phi_{\\mathrm{mm}}(2a, b)).\n    $$\n3.  **Van Albada Limiter:** A smooth limiter designed to give sharp shock profiles. To avoid division by zero, a small parameter $\\epsilon$ is used.\n    $$\n    \\phi_{\\mathrm{va}}(a, b) = \\begin{cases} \\frac{a(b^2+\\epsilon) + b(a^2+\\epsilon)}{a^2 + b^2 + 2\\epsilon}  \\text{if } ab  0 \\\\ 0  \\text{if } ab \\le 0 \\end{cases}.\n    $$\n\nGhost cells are used at the boundaries. Two cells to the left are fixed at $u_L$ and two to the right are fixed at $u_R$. This allows for the computation of slopes for all physical cells.\n\n### 5. Godunov Flux for Burgers' Equation\n\nThe numerical flux $F_{i+\\frac{1}{2}}^n$ is calculated by solving the Riemann problem at the interface with states $u_L \\equiv u_{i+\\frac{1}{2}}^L$ and $u_R \\equiv u_{i+\\frac{1}{2}}^R$. For the convex Burgers' flux $f(u) = u^2/2$, the exact Godunov flux is given by:\n$$\nF_G(u_L, u_R) =\n\\begin{cases}\nf(u_L)  \\text{if } u_L  u_R \\text{ and } s_{12}  0, \\\\\nf(u_R)  \\text{if } u_L  u_R \\text{ and } s_{12} \\le 0, \\\\\nf(u_L)  \\text{if } u_L \\le u_R \\text{ and } u_L \\ge 0, \\\\\nf(u_R)  \\text{if } u_L \\le u_R \\text{ and } u_R \\le 0, \\\\\n0  \\text{if } u_L \\le u_R \\text{ and } u_L  0  u_R,\n\\end{cases}\n$$\nwhere $s_{12} = (u_L+u_R)/2$ is the shock speed for the case $u_L  u_R$.\n\n### 6. Calculation of Output Metrics\n\nAfter one time step, the updated cell averages $\\bar{u}_i^{n+1}$ are analyzed.\n\n-   **Numerical Shock Position ($x_{\\mathrm{num}}$):** We find the first interface $x_{j+\\frac{1}{2}}$ where the adjacent cell averages straddle the midpoint value $u_{\\mathrm{mid}} = \\frac{1}{2}(u_L + u_R)$. That is, we find the first cell index $j$ such that $\\bar{u}_j^{n+1} \\ge u_{\\mathrm{mid}}$ and $\\bar{u}_{j+1}^{n+1} \\le u_{\\mathrm{mid}}$. The numerical shock position is then $x_{\\mathrm{num}} = x_{j+\\frac{1}{2}} = (j+1)\\Delta x$ (for a 0-indexed cell array). The absolute error is $E = |x_{\\mathrm{num}} - x_{\\mathrm{exact}}|$.\n\n-   **Smearing Width ($w$):** This metric quantifies the numerical diffusion at the shock. It is the total length of the cells whose updated averages lie strictly between the initial left and right states: $w = (\\text{count of } i \\text{ where } u_R  \\bar{u}_i^{n+1}  u_L) \\times \\Delta x$.\n\nThe provided code implements this entire procedure for each of the three limiters and three test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (uL, uR, N, CFL, x0)\n        (2.0, 0.0, 200, 0.45, 0.5),\n        (1.0, 0.9, 200, 0.45, 0.5),\n        (3.0, -1.0, 400, 0.45, 0.5),\n    ]\n\n    all_results = []\n    for params in test_cases:\n        uL, uR, N, CFL, x0 = params\n        case_results = run_simulation(uL, uR, N, CFL, x0)\n        all_results.append(f\"[{','.join(map(str, case_results))}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\ndef run_simulation(uL, uR, N, CFL, x0):\n    \"\"\"\n    Runs the simulation for a single test case with all three limiters.\n    \"\"\"\n    limiters = ['minmod', 'superbee', 'van_albada']\n    results = []\n\n    # Simulation setup\n    dx = 1.0 / N\n    max_speed = max(abs(uL), abs(uR))\n    # Handle max_speed=0 case to avoid division by zero\n    if max_speed == 0:\n        dt = 0.0\n    else:\n        dt = CFL * dx / max_speed\n    \n    lamb = dt / dx\n\n    # Initial condition\n    x_interfaces = np.linspace(0, 1, N + 1)\n    x_centers = (x_interfaces[:-1] + x_interfaces[1:]) / 2\n    u_initial = np.where(x_centers  x0, uL, uR)\n\n    # Exact shock position\n    s = 0.5 * (uL + uR)\n    x_exact = x0 + s * dt\n\n    for limiter_name in limiters:\n        u_new = perform_update(u_initial, lamb, uL, uR, N, limiter_name)\n        x_num, w = compute_metrics(u_new, uL, uR, dx)\n        \n        pos_error = abs(x_num - x_exact)\n        \n        results.extend([pos_error, w])\n    \n    return results\n\ndef perform_update(u, lamb, uL, uR, N, limiter_name):\n    \"\"\"\n    Performs a single MUSCL finite volume update step.\n    \"\"\"\n    # Pad the solution array with 2 ghost cells on each side\n    u_padded = np.zeros(N + 4)\n    u_padded[2:N+2] = u\n    u_padded[0:2] = uL\n    u_padded[N+2:] = uR\n\n    # --- 1. Slope Calculation ---\n    slopes = np.zeros_like(u_padded)\n    # Loop over cells where a full stencil is available (i-1, i, i+1)\n    # This covers all cells needed for flux calculation at physical interfaces\n    for i in range(1, N + 3):\n        a = u_padded[i] - u_padded[i-1]\n        b = u_padded[i+1] - u_padded[i]\n        \n        if limiter_name == 'minmod':\n            slopes[i] = minmod(a, b)\n        elif limiter_name == 'superbee':\n            slopes[i] = superbee(a, b)\n        elif limiter_name == 'van_albada':\n            slopes[i] = van_albada(a, b)\n\n    # --- 2. Reconstruction and Flux Calculation ---\n    # Array to store fluxes at interfaces i+1/2\n    # F[i] corresponds to flux at interface between cells (i) and (i+1)\n    fluxes = np.zeros(N + 3) \n    for i in range(1, N + 2): # Interfaces from 1.5 to N+1.5\n        u_left_recon = u_padded[i] + 0.5 * slopes[i]\n        u_right_recon = u_padded[i+1] - 0.5 * slopes[i+1]\n        fluxes[i] = godunov_flux_burgers(u_left_recon, u_right_recon)\n    \n    # --- 3. Cell Average Update ---\n    u_new = np.zeros(N)\n    for i in range(N):\n        # Padded index for cell i is j = i + 2\n        j = i + 2\n        # Fluxes at j-1/2 and j+1/2 correspond to fluxes[j-1] and fluxes[j]\n        u_new[i] = u_padded[j] - lamb * (fluxes[j] - fluxes[j-1])\n        \n    return u_new\n\ndef compute_metrics(u_new, uL, uR, dx):\n    \"\"\"\n    Computes numerical shock position and smearing width.\n    \"\"\"\n    u_mid = 0.5 * (uL + uR)\n\n    # Numerical shock position\n    # Find first index i where u[i] = u_mid and u[i+1] = u_mid\n    indices = np.where((u_new[:-1] = u_mid)  (u_new[1:] = u_mid))[0]\n    if len(indices)  0:\n        shock_idx = indices[0]\n        # x_num is the interface position x_{i+1/2} = (i+1)*dx\n        x_num = (shock_idx + 1) * dx\n    else:\n        # Fallback if no straddling is found (very smeared or out of bounds)\n        # For these specific problem cases, this is not expected to happen.\n        # A plausible fallback could be the location of the cell closest to u_mid.\n        x_num = (np.abs(u_new - u_mid)).argmin() * dx + 0.5 * dx\n\n    # Smearing width\n    # Count cells where uR  u_new[i]  uL\n    smeared_cell_count = np.sum((u_new  uR)  (u_new  uL))\n    w = smeared_cell_count * dx\n\n    return x_num, w\n\n# --- Limiter Functions ---\n\ndef minmod(a, b):\n    \"\"\"Vectorized minmod limiter.\"\"\"\n    return 0.5 * (np.sign(a) + np.sign(b)) * np.minimum(np.abs(a), np.abs(b))\n\ndef superbee(a, b):\n    \"\"\"Vectorized superbee limiter.\"\"\"\n    return max(minmod(a, 2 * b), minmod(2 * a, b))\n\ndef van_albada(a, b, eps=1e-12):\n    \"\"\"Vectorized van Albada limiter.\"\"\"\n    if a * b = 0:\n        return 0.0\n    return (a * (b**2 + eps) + b * (a**2 + eps)) / (a**2 + b**2 + 2*eps)\n\ndef godunov_flux_burgers(uL, uR):\n    \"\"\"Exact Godunov flux for the inviscid Burgers' equation.\"\"\"\n    fL = 0.5 * uL**2\n    fR = 0.5 * uR**2\n    \n    # Calculate shock speed for cases where one might form\n    s = 0.5 * (uL + uR)\n    \n    # Shock case (uL > uR)\n    flux_shock = fL if s  0 else fR\n\n    # Rarefaction case (uL = uR)\n    if uL = 0:  # Also covers uL=uR = 0\n        flux_rarefaction = fL\n    elif uR = 0:  # Also covers uL=uR = 0\n        flux_rarefaction = fR\n    else:  # uL  0  uR\n        flux_rarefaction = 0.0\n        \n    return flux_shock if uL  uR else flux_rarefaction\n\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}