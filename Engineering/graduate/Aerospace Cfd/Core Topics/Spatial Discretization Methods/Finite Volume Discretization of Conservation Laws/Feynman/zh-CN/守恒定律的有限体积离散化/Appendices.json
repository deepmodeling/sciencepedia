{
    "hands_on_practices": [
        {
            "introduction": "有限体积法的第一步是建立计算网格，它将空间划分为一系列不重叠的控制体积（或称单元）。为了离散守恒定律，我们必须精确计算每个控制体积的几何属性，即其体积和每个面的面积向量。这个练习将指导你为一个基本的四面体单元计算这些关键的几何量，这对于理解非结构网格求解器的工作原理至关重要。",
            "id": "3958977",
            "problem": "在计算流体动力学 (CFD) 中，面法向面积矢量和单元体积为守恒定律的有限体积离散化提供了所需的几何封闭性。考虑一个四面体控制体积，其顶点坐标（以米为单位）由下式给出：\n$$\\mathbf{x}_{A} = (0,\\,0,\\,0),\\quad \\mathbf{x}_{B} = (1,\\,0,\\,0),\\quad \\mathbf{x}_{C} = (0,\\,2,\\,0),\\quad \\mathbf{x}_{D} = (0,\\,0,\\,3).$$\n从几何第一性原理出发，并使用与守恒定律通量和散度定理一致的定义，计算：\n- 单元体积 $V_{i}$，\n- 四个三角形面的指向外部的面法向面积矢量 $\\mathbf{n}_{f} A_{f}$。面的标记如下：顶点 $A$ 对面的面是三角形 $(B,C,D)$，顶点 $B$ 对面是 $(A,C,D)$，顶点 $C$ 对面是 $(A,B,D)$，顶点 $D$ 对面是 $(A,B,C)$。\n\n使用以下外向方向约定：每个面上的外法线必须指向远离单元形心的方向。体积以 $\\mathrm{m}^{3}$ 表示，每个面积矢量以 $\\mathrm{m}^{2}$ 表示。将您的最终结果按以下顺序报告为单个行向量：\n$$\\left[V_{i},\\; (\\mathbf{n}A)_{BCD,x},\\;(\\mathbf{n}A)_{BCD,y},\\;(\\mathbf{n}A)_{BCD,z},\\;(\\mathbf{n}A)_{ACD,x},\\;(\\mathbf{n}A)_{ACD,y},\\;(\\mathbf{n}A)_{ACD,z},\\;(\\mathbf{n}A)_{ABD,x},\\;(\\mathbf{n}A)_{ABD,y},\\;(\\mathbf{n}A)_{ABD,z},\\;(\\mathbf{n}A)_{ABC,x},\\;(\\mathbf{n}A)_{ABC,y},\\;(\\mathbf{n}A)_{ABC,z}\\right].$$\n将报告的每个数值四舍五入到四位有效数字。",
            "solution": "用户提供了一个在计算流体动力学 (CFD) 应用背景下的有效的、适定的计算几何问题。该问题要求计算给定四面体控制体积的体积和指向外部的面法向面积矢量。\n\n四面体的顶点如下：\n$\\mathbf{x}_{A} = (0, 0, 0)$\n$\\mathbf{x}_{B} = (1, 0, 0)$\n$\\mathbf{x}_{C} = (0, 2, 0)$\n$\\mathbf{x}_{D} = (0, 0, 3)$\n\n求解过程分为两个主要部分：计算单元体积 $V_{i}$ 和计算四个面法向面积矢量 $\\mathbf{S}_{f} = \\mathbf{n}_{f} A_{f}$。\n\n首先，我们计算四面体的体积。由顶点 A、B、C、D 定义的四面体体积 V 可以使用从一个公共顶点出发的三条边的矢量标量三重积来计算。以顶点 A 为原点，我们定义边矢量：\n$\\mathbf{v}_{AB} = \\mathbf{x}_{B} - \\mathbf{x}_{A} = (1, 0, 0)$\n$\\mathbf{v}_{AC} = \\mathbf{x}_{C} - \\mathbf{x}_{A} = (0, 2, 0)$\n$\\mathbf{v}_{AD} = \\mathbf{x}_{D} - \\mathbf{x}_{A} = (0, 0, 3)$\n\n体积 $V_{i}$ 是标量三重积 $(\\mathbf{v}_{AB} \\times \\mathbf{v}_{AC}) \\cdot \\mathbf{v}_{AD}$ 绝对值的 $\\frac{1}{6}$。这等同于由这些矢量构成的矩阵行列式绝对值的 $\\frac{1}{6}$：\n$$V_{i} = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} \\right| = \\frac{1}{6} |(1)(2)(3) - 0| = \\frac{6}{6} = 1$$\n因此，单元的体积为 $V_{i} = 1\\; \\mathrm{m}^{3}$。\n\n接下来，我们计算面法向面积矢量。由顶点 $P_1, P_2, P_3$（按此顺序）定义的三角形面的面积矢量 $\\mathbf{S}$ 由叉积给出：\n$$\\mathbf{S} = \\frac{1}{2} (\\mathbf{x}_{P_2} - \\mathbf{x}_{P_1}) \\times (\\mathbf{x}_{P_3} - \\mathbf{x}_{P_1})$$\n该矢量的方向决定了法向。问题要求法向量指向单元外部。为了确定外向方向，我们首先计算四面体的形心，它总是位于体积内部。形心 $\\mathbf{x}_{\\text{cent}}$ 是顶点坐标的平均值：\n$$\\mathbf{x}_{\\text{cent}} = \\frac{1}{4}(\\mathbf{x}_{A} + \\mathbf{x}_{B} + \\mathbf{x}_{C} + \\mathbf{x}_{D}) = \\frac{1}{4} \\left( (0,0,0) + (1,0,0) + (0,2,0) + (0,0,3) \\right) = \\frac{1}{4}(1, 2, 3) = (0.25, 0.5, 0.75)$$\n如果从形心到面上任意一点的矢量 $\\mathbf{x}_{f} - \\mathbf{x}_{\\text{cent}}$ 与面积矢量 $\\mathbf{S}_{f}$ 的点积为正，则该面积矢量 $\\mathbf{S}_{f}$ 指向外部。即 $(\\mathbf{x}_{f} - \\mathbf{x}_{\\text{cent}}) \\cdot \\mathbf{S}_{f}  0$。如果点积为负，则必须将计算出的面积矢量反向。\n\n我们现在计算四个面中每一个的面积矢量。\n\n面 1：BCD (顶点 A 的对面)\n顶点：$\\mathbf{x}_{B} = (1,0,0)$，$\\mathbf{x}_{C} = (0,2,0)$，$\\mathbf{x}_{D} = (0,0,3)$。\n让我们使用顶点顺序 B、C、D 计算一个候选面积矢量 $\\mathbf{S}'_{BCD}$：\n$$\\mathbf{S}'_{BCD} = \\frac{1}{2} (\\mathbf{x}_{C} - \\mathbf{x}_{B}) \\times (\\mathbf{x}_{D} - \\mathbf{x}_{B}) = \\frac{1}{2} (-1, 2, 0) \\times (-1, 0, 3)$$\n$$\\mathbf{S}'_{BCD} = \\frac{1}{2} \\det \\begin{pmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ -1  2  0 \\\\ -1  0  3 \\end{pmatrix} = \\frac{1}{2} ( (2)(3)\\mathbf{i} - (-1)(3)\\mathbf{j} + (-1)(0 - 2)\\mathbf{k} ) = \\frac{1}{2}(6, 3, 2) = (3, 1.5, 1)$$\n为了检查其方向，我们取从形心到顶点 B 的矢量：$\\mathbf{x}_{B} - \\mathbf{x}_{\\text{cent}} = (1,0,0) - (0.25, 0.5, 0.75) = (0.75, -0.5, -0.75)$。\n点积为 $(\\mathbf{x}_{B} - \\mathbf{x}_{\\text{cent}}) \\cdot \\mathbf{S}'_{BCD} = (0.75)(3) + (-0.5)(1.5) + (-0.75)(1) = 2.25 - 0.75 - 0.75 = 0.75$。\n由于 $0.75  0$，该矢量已经指向外部。因此，$(\\mathbf{n}A)_{BCD} = (3, 1.5, 1)$。\n\n面 2：ACD (顶点 B 的对面)\n顶点：$\\mathbf{x}_{A} = (0,0,0)$，$\\mathbf{x}_{C} = (0,2,0)$，$\\mathbf{x}_{D} = (0,0,3)$。\n$$\\mathbf{S}'_{ACD} = \\frac{1}{2} (\\mathbf{x}_{C} - \\mathbf{x}_{A}) \\times (\\mathbf{x}_{D} - \\mathbf{x}_{A}) = \\frac{1}{2} (0, 2, 0) \\times (0, 0, 3) = \\frac{1}{2} (6, 0, 0) = (3, 0, 0)$$\n该面位于平面 $x=0$ 上，而形心的 x 坐标为 $0.25$。外法线必须指向 x 轴负方向。因此，计算出的矢量是向内的。我们必须将其符号反转。\n$(\\mathbf{n}A)_{ACD} = -(3, 0, 0) = (-3, 0, 0)$。\n\n面 3：ABD (顶点 C 的对面)\n顶点：$\\mathbf{x}_{A} = (0,0,0)$，$\\mathbf{x}_{B} = (1,0,0)$，$\\mathbf{x}_{D} = (0,0,3)$。\n$$\\mathbf{S}'_{ABD} = \\frac{1}{2} (\\mathbf{x}_{B} - \\mathbf{x}_{A}) \\times (\\mathbf{x}_{D} - \\mathbf{x}_{A}) = \\frac{1}{2} (1, 0, 0) \\times (0, 0, 3) = \\frac{1}{2} (0, -3, 0) = (0, -1.5, 0)$$\n该面位于平面 $y=0$ 上，而形心的 y 坐标为 $0.5$。外法线必须指向 y 轴负方向。计算出的矢量已经指向这个方向，所以它是向外的。\n$(\\mathbf{n}A)_{ABD} = (0, -1.5, 0)$。\n\n面 4：ABC (顶点 D 的对面)\n顶点：$\\mathbf{x}_{A} = (0,0,0)$，$\\mathbf{x}_{B} = (1,0,0)$，$\\mathbf{x}_{C} = (0,2,0)$。\n$$\\mathbf{S}'_{ABC} = \\frac{1}{2} (\\mathbf{x}_{B} - \\mathbf{x}_{A}) \\times (\\mathbf{x}_{C} - \\mathbf{x}_{A}) = \\frac{1}{2} (1, 0, 0) \\times (0, 2, 0) = \\frac{1}{2} (0, 0, 2) = (0, 0, 1)$$\n该面位于平面 $z=0$ 上，而形心的 z 坐标为 $0.75$。外法线必须指向 z 轴负方向。计算出的矢量是向内的，所以我们将其符号反转。\n$(\\mathbf{n}A)_{ABC} = -(0, 0, 1) = (0, 0, -1)$。\n\n作为验证，封闭体积的所有外向面积矢量的总和必须为零矢量，这是散度定理的一个要求，称为几何封闭性。\n$$\\sum_{f} \\mathbf{S}_{f} = (3, 1.5, 1) + (-3, 0, 0) + (0, -1.5, 0) + (0, 0, -1)$$\n$$\\sum_{f} \\mathbf{S}_{f} = (3-3, 1.5-1.5, 1-1) = (0, 0, 0)$$\n该条件得到满足，证实了这些矢量的正确性。\n\n最后，我们按照要求将结果组合成一个单一的行向量，并将每个条目四舍五入到四位有效数字。对于得到的整数和半整数结果，这相当于将它们格式化为三位小数。\n\n$V_{i} = 1.000$\n$(\\mathbf{n}A)_{BCD} = (3.000, 1.500, 1.000)$\n$(\\mathbf{n}A)_{ACD} = (-3.000, 0.000, 0.000)$\n$(\\mathbf{n}A)_{ABD} = (0.000, -1.500, 0.000)$\n$(\\mathbf{n}A)_{ABC} = (0.000, 0.000, -1.000)$\n\n按要求排序的最终向量是：\n$[1.000, 3.000, 1.500, 1.000, -3.000, 0.000, 0.000, 0.000, -1.500, 0.000, 0.000, 0.000, -1.000]$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.000  3.000  1.500  1.000  -3.000  0.000  0.000  0.000  -1.500  0.000  0.000  0.000  -1.000 \\end{pmatrix} } $$"
        },
        {
            "introduction": "有限体积法存储的是单元内的平均值，但通量计算发生在单元的交界面上。为了获得高于一阶的精度，我们必须将数据从单元中心重构到交界面上。这个练习展示了如何利用邻近单元的数据，通过稳健的最小二乘法来计算单元内的梯度，并利用此梯度进行线性重构。此外，它还引入了斜率限制器的关键概念，以防止重构过程产生非物理的振荡，从而保证解的稳定性。",
            "id": "3958983",
            "problem": "考虑一个计算流体动力学 (CFD) 中的二维非结构有限体积法 (FVM) 重构问题，针对一个无量纲的标量守恒量 $U$。给定两个相邻的控制体，即“左”单元 $i$ 和“右”单元 $k$，以及它们的邻近单元形心和邻近单元平均值。目标是使用基于守恒律离散化原理的加权残差最小化方法，计算最小二乘空间梯度 $\\nabla U_{i}$ 和 $\\nabla U_{k}$，然后在共享面中心处，构建线性重构的、基于面的、经过 Barth–Jespersen 限制的左右状态。\n\n已知数据如下。对于左单元 $i$，其形心位于 $\\boldsymbol{r}_{i} = (\\,0,\\,0\\,)$，单元平均值为 $U_{i} = 1.0$。其邻近单元的形心和平均值为：\n- 东侧邻居位于 $\\boldsymbol{r}_{\\mathrm{E}} = (\\,1,\\,0\\,)$，其 $U_{\\mathrm{E}} = 1.2$，\n- 北侧邻居位于 $\\boldsymbol{r}_{\\mathrm{N}} = (\\,0,\\,1\\,)$，其 $U_{\\mathrm{N}} = 0.8$，\n- 西侧邻居位于 $\\boldsymbol{r}_{\\mathrm{W}} = (\\,{-}1,\\,0\\,)$，其 $U_{\\mathrm{W}} = 0.9$，\n- 南侧邻居位于 $\\boldsymbol{r}_{\\mathrm{S}} = (\\,0,\\,{-}1\\,)$，其 $U_{\\mathrm{S}} = 1.1$。\n\n对于右单元 $k$，其形心位于 $\\boldsymbol{r}_{k} = (\\,1,\\,0\\,)$，单元平均值为 $U_{k} = 1.2$。其邻近单元的形心和平均值为：\n- 左侧邻居（即单元 $i$）位于 $\\boldsymbol{r}_{i} = (\\,0,\\,0\\,)$，其 $U_{i} = 1.0$，\n- 东侧邻居位于 $\\boldsymbol{r}_{\\mathrm{EE}} = (\\,2,\\,0\\,)$，其 $U_{\\mathrm{EE}} = 1.5$，\n- 北侧邻居位于 $\\boldsymbol{r}_{\\mathrm{N2}} = (\\,1,\\,1\\,)$，其 $U_{\\mathrm{N2}} = 1.0$，\n- 南侧邻居位于 $\\boldsymbol{r}_{\\mathrm{S2}} = (\\,1,\\,{-}1\\,)$，其 $U_{\\mathrm{S2}} = 1.3$。\n\n假设单元 $\\ell \\in \\{i,k\\}$ 处的最小二乘梯度是通过最小化加权平方残差和得到的\n$$\nJ(\\nabla U_{\\ell}) \\;=\\; \\sum_{j \\in \\mathcal{N}(\\ell)} w_{j} \\left( U_{j} - U_{\\ell} - \\nabla U_{\\ell} \\cdot (\\boldsymbol{r}_{j} - \\boldsymbol{r}_{\\ell}) \\right)^{2},\n$$\n其中邻居集合 $\\mathcal{N}(\\ell)$ 对每个单元均包含其列出的四个邻居，权重选择为距离平方的倒数 $w_{j} = 1 / \\left\\| \\boldsymbol{r}_{j} - \\boldsymbol{r}_{\\ell} \\right\\|^{2}$。共享面中心位于 $\\boldsymbol{r}_{f} = (\\,0.5,\\,0.2\\,)$。使用以下公式构建线性重构的左右面状态\n$$\nU_{L} \\;=\\; U_{i} \\;+\\; \\phi_{i}^{f} \\; \\nabla U_{i} \\cdot (\\boldsymbol{r}_{f} - \\boldsymbol{r}_{i}),\n\\qquad\nU_{R} \\;=\\; U_{k} \\;+\\; \\phi_{k}^{f} \\; \\nabla U_{k} \\cdot (\\boldsymbol{r}_{f} - \\boldsymbol{r}_{k}),\n$$\n其中对于每个单元 $\\ell \\in \\{i,k\\}$，在面上基于面的 Barth–Jespersen 限制器定义为\n$$\n\\phi_{\\ell}^{f} \\;=\\;\n\\begin{cases}\n\\min\\!\\left( 1,\\; \\dfrac{U_{\\max,\\ell} - U_{\\ell}}{\\Delta U_{\\ell}^{f}} \\right),  \\text{if } \\Delta U_{\\ell}^{f} > 0, \\\\[1.2em]\n\\min\\!\\left( 1,\\; \\dfrac{U_{\\min,\\ell} - U_{\\ell}}{\\Delta U_{\\ell}^{f}} \\right),  \\text{if } \\Delta U_{\\ell}^{f}  0, \\\\[0.6em]\n1,  \\text{if } \\Delta U_{\\ell}^{f} = 0,\n\\end{cases}\n$$\n其中 $U_{\\max,\\ell}$ 和 $U_{\\min,\\ell}$ 分别是 $\\{ U_{\\ell} \\} \\cup \\{ U_{j} : j \\in \\mathcal{N}(\\ell) \\}$ 中的最大值和最小值，并且 $\\Delta U_{\\ell}^{f} = \\nabla U_{\\ell} \\cdot (\\boldsymbol{r}_{f} - \\boldsymbol{r}_{\\ell})$。\n\n从上述定义和有限体积重构基本原理出发，计算 $\\nabla U_{i}$ 和 $\\nabla U_{k}$，然后计算 $U_{L}$ 和 $U_{R}$。报告在面中心处的左状态 $U_{L}$ 的值。将最终数值答案保留四位有效数字。最终答案无需单位（因为 $U$ 是无量纲的）。",
            "solution": "该问题要求使用有限体积法框架，计算两个控制体 $i$ 和 $k$ 之间面中心的重构左状态 $U_{L}$。这包括三个主要步骤：\n1.  计算单元 $i$ 的标量场 $U$ 的最小二乘空间梯度，记为 $\\nabla U_{i}$。\n2.  计算单元 $k$ 的最小二乘空间梯度，记为 $\\nabla U_{k}$。\n3.  使用梯度 $\\nabla U_{i}$ 在面中心线性重构 $U$ 的值，并应用 Barth–Jespersen 限制器以确保单调性。\n\n我们首先计算空间梯度。单元 $\\ell$ 的梯度 $\\nabla U_{\\ell}$ 是通过最小化加权平方残差和找到的：\n$$\nJ(\\nabla U_{\\ell}) = \\sum_{j \\in \\mathcal{N}(\\ell)} w_{j} \\left( U_{j} - U_{\\ell} - \\nabla U_{\\ell} \\cdot (\\boldsymbol{r}_{j} - \\boldsymbol{r}_{\\ell}) \\right)^{2}\n$$\n将 $J$ 对 $\\nabla U_{\\ell} = (g_x, g_y)^T$ 各分量的偏导数设为零，得到一个线性方程组 $M_{\\ell} \\nabla U_{\\ell} = \\boldsymbol{b}_{\\ell}$，其中：\n$$\nM_{\\ell} = \\begin{pmatrix} \\sum w_j (\\Delta x_j)^2  \\sum w_j \\Delta x_j \\Delta y_j \\\\ \\sum w_j \\Delta x_j \\Delta y_j  \\sum w_j (\\Delta y_j)^2 \\end{pmatrix}, \\quad \\boldsymbol{b}_{\\ell} = \\begin{pmatrix} \\sum w_j \\Delta x_j (U_j - U_{\\ell}) \\\\ \\sum w_j \\Delta y_j (U_j - U_{\\ell}) \\end{pmatrix}\n$$\n此处，$\\Delta \\boldsymbol{r}_j = \\boldsymbol{r}_{j} - \\boldsymbol{r}_{\\ell} = (\\Delta x_j, \\Delta y_j)$，权重为 $w_j = 1/\\|\\Delta \\boldsymbol{r}_j\\|^2$。\n\n首先，我们计算单元 $i$ 的梯度。\n单元 $i$ 的给定数据为：$\\boldsymbol{r}_{i} = (\\,0,\\,0\\,)$ 且 $U_{i} = 1.0$。\n邻居为：\n- 东 (E): $\\boldsymbol{r}_{\\mathrm{E}} = (\\,1,\\,0\\,)$, $U_{\\mathrm{E}} = 1.2$\n- 北 (N): $\\boldsymbol{r}_{\\mathrm{N}} = (\\,0,\\,1\\,)$, $U_{\\mathrm{N}} = 0.8$\n- 西 (W): $\\boldsymbol{r}_{\\mathrm{W}} = (\\,{-}1,\\,0\\,)$, $U_{\\mathrm{W}} = 0.9$\n- 南 (S): $\\boldsymbol{r}_{\\mathrm{S}} = (\\,0,\\,{-}1\\,)$, $U_{\\mathrm{S}} = 1.1$\n\n位移矢量 $\\Delta\\boldsymbol{r}_{ji} = \\boldsymbol{r}_{j} - \\boldsymbol{r}_{i}$ 为：\n- $\\Delta\\boldsymbol{r}_{\\mathrm{E}i} = (\\,1,\\,0\\,)$\n- $\\Delta\\boldsymbol{r}_{\\mathrm{N}i} = (\\,0,\\,1\\,)$\n- $\\Delta\\boldsymbol{r}_{\\mathrm{W}i} = (\\,{-}1,\\,0\\,)$\n- $\\Delta\\boldsymbol{r}_{\\mathrm{S}i} = (\\,0,\\,{-}1\\,)$\n\n所有邻居的距离平方 $\\|\\Delta\\boldsymbol{r}_{ji}\\|^2$ 均为 1，因此权重 $w_j = 1/\\|\\Delta\\boldsymbol{r}_{ji}\\|^2$ 也都等于 1。\n矩阵 $M_i$ 的分量为：\n- $M_{i,11} = \\sum w_j (\\Delta x_j)^2 = 1 \\cdot (1)^2 + 1 \\cdot (0)^2 + 1 \\cdot ({-}1)^2 + 1 \\cdot (0)^2 = 2$\n- $M_{i,12} = M_{i,21} = \\sum w_j \\Delta x_j \\Delta y_j = 1 \\cdot (1)(0) + 1 \\cdot (0)(1) + 1 \\cdot ({-}1)(0) + 1 \\cdot (0)({-}1) = 0$\n- $M_{i,22} = \\sum w_j (\\Delta y_j)^2 = 1 \\cdot (0)^2 + 1 \\cdot (1)^2 + 1 \\cdot (0)^2 + 1 \\cdot ({-}1)^2 = 2$\n所以，$M_i = \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}$。\n\n标量值之差 $U_j - U_i$ 为：\n- $U_{\\mathrm{E}} - U_i = 1.2 - 1.0 = 0.2$\n- $U_{\\mathrm{N}} - U_i = 0.8 - 1.0 = -0.2$\n- $U_{\\mathrm{W}} - U_i = 0.9 - 1.0 = -0.1$\n- $U_{\\mathrm{S}} - U_i = 1.1 - 1.0 = 0.1$\n\n向量 $\\boldsymbol{b}_i$ 的分量为：\n- $b_{i,1} = \\sum w_j \\Delta x_j (U_j - U_i) = 1 \\cdot (1)(0.2) + 1 \\cdot (0)({-}0.2) + 1 \\cdot ({-}1)({-}0.1) + 1 \\cdot (0)(0.1) = 0.2 + 0.1 = 0.3$\n- $b_{i,2} = \\sum w_j \\Delta y_j (U_j - U_i) = 1 \\cdot (0)(0.2) + 1 \\cdot (1)({-}0.2) + 1 \\cdot (0)({-}0.1) + 1 \\cdot ({-}1)(0.1) = -0.2 - 0.1 = -0.3$\n所以，$\\boldsymbol{b}_i = \\begin{pmatrix} 0.3 \\\\ {-}0.3 \\end{pmatrix}$。\n\n求解 $\\nabla U_i = (g_{ix}, g_{iy})^T$ 的线性系统为：\n$\\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} g_{ix} \\\\ g_{iy} \\end{pmatrix} = \\begin{pmatrix} 0.3 \\\\ {-}0.3 \\end{pmatrix}$\n解此方程得 $g_{ix} = 0.3/2 = 0.15$ 且 $g_{iy} = -0.3/2 = -0.15$。\n因此，$\\nabla U_{i} = (\\,0.15,\\,{-}0.15\\,)$。\n\n接下来，我们计算单元 $k$ 的梯度。\n单元 $k$ 的数据为：$\\boldsymbol{r}_{k} = (\\,1,\\,0\\,)$ 且 $U_{k} = 1.2$。邻居位于 $\\boldsymbol{r}_i=(\\,0,\\,0\\,)$、$\\boldsymbol{r}_{\\mathrm{EE}}=(\\,2,\\,0\\,)$、$\\boldsymbol{r}_{\\mathrm{N2}}=(\\,1,\\,1\\,)$ 和 $\\boldsymbol{r}_{\\mathrm{S2}}=(\\,1,\\,{-}1\\,)$。从 $\\boldsymbol{r}_k$ 出发的位移矢量分别为 $(\\,{-}1,\\,0\\,)$、$(\\,1,\\,0\\,)$、$(\\,0,\\,1\\,)$ 和 $(\\,0,\\,{-}1\\,)$。其几何结构与单元 $i$ 相同，所以 $M_k = M_i = \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}$。\n值的差 $U_j - U_k$ 分别为：$1.0-1.2={-}0.2$，$1.5-1.2=0.3$，$1.0-1.2={-}0.2$，$1.3-1.2=0.1$。\n向量 $\\boldsymbol{b}_k$ 为：\n- $b_{k,1} = 1 \\cdot ({-}1)({-}0.2) + 1 \\cdot (1)(0.3) + 1 \\cdot (0)({-}0.2) + 1 \\cdot (0)(0.1) = 0.2 + 0.3 = 0.5$\n- $b_{k,2} = 1 \\cdot (0)({-}0.2) + 1 \\cdot (0)(0.3) + 1 \\cdot (1)({-}0.2) + 1 \\cdot ({-}1)(0.1) = -0.2 - 0.1 = -0.3$\n求解 $\\nabla U_k = (g_{kx}, g_{ky})^T$ 的系统为 $\\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix} \\nabla U_k = \\begin{pmatrix} 0.5 \\\\ {-}0.3 \\end{pmatrix}$，得到 $\\nabla U_k = (\\,0.25,\\,{-}0.15\\,)$。\n\n现在，我们构建左状态 $U_L$。公式为 $U_{L} = U_{i} + \\phi_{i}^{f} \\nabla U_{i} \\cdot (\\boldsymbol{r}_{f} - \\boldsymbol{r}_{i})$。\n面中心为 $\\boldsymbol{r}_{f} = (\\,0.5,\\,0.2\\,)$。从单元 $i$ 的形心到面的矢量是 $\\boldsymbol{r}_{f} - \\boldsymbol{r}_{i} = (\\,0.5,\\,0.2\\,) - (\\,0,\\,0\\,) = (\\,0.5,\\,0.2\\,)$。\n在面上的未限制变化量 $\\Delta U_{i}^{f}$ 为：\n$\\Delta U_{i}^{f} = \\nabla U_{i} \\cdot (\\boldsymbol{r}_{f} - \\boldsymbol{r}_{i}) = (\\,0.15,\\,{-}0.15\\,) \\cdot (\\,0.5,\\,0.2\\,) = (0.15)(0.5) + ({-}0.15)(0.2) = 0.075 - 0.030 = 0.045$。\n\n为求得 Barth–Jespersen 限制器 $\\phi_{i}^{f}$，我们首先确定单元 $i$ 邻域内的最大值和最小值。值的集合是 $\\{U_i, U_{\\mathrm{E}}, U_{\\mathrm{N}}, U_{\\mathrm{W}}, U_{\\mathrm{S}}\\} = \\{1.0, 1.2, 0.8, 0.9, 1.1\\}$。\n所以，$U_{\\max,i} = 1.2$ 且 $U_{\\min,i} = 0.8$。\n因为 $\\Delta U_{i}^{f} = 0.045  0$，我们使用限制器的相应情形：\n$$\n\\phi_{i}^{f} = \\min\\left( 1, \\frac{U_{\\max,i} - U_{i}}{\\Delta U_{i}^{f}} \\right)\n$$\n代入数值：\n$$\n\\phi_{i}^{f} = \\min\\left( 1, \\frac{1.2 - 1.0}{0.045} \\right) = \\min\\left( 1, \\frac{0.2}{0.045} \\right) = \\min\\left( 1, \\frac{40}{9} \\right)\n$$\n由于 $\\frac{40}{9} \\approx 4.44  1$，限制器的值为 $\\phi_{i}^{f} = 1$。这意味着重构未被限制。\n\n最后，我们计算左状态 $U_L$：\n$$\nU_{L} = U_{i} + \\phi_{i}^{f} \\Delta U_{i}^{f} = 1.0 + (1)(0.045) = 1.045\n$$\n问题要求将此值保留四位有效数字。计算值 $1.045$ 已经有四位有效数字。",
            "answer": "$$\\boxed{1.045}$$"
        },
        {
            "introduction": "在单元交界面上获得了重构的“左”和“右”状态后，我们必须计算通过该面的通量。简单地对物理通量进行平均（即中心格式）对于像欧拉方程这样的双曲系统是不稳定的。我们需要一个数值通量函数（或近似黎曼求解器），它能正确地模拟波的传播，并为保证稳定性引入必要的数值耗散。这个练习将集中于应用广泛的Rusanov（或局部Lax-Friedrichs）格式来计算数值通量，这是一个实现任何现代激波捕捉有限体积法的核心技能。",
            "id": "3958926",
            "problem": "考虑一个量热完全气体的二维可压缩欧拉方程的守恒形式，其比热比为 $\\gamma$：\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\nabla \\cdot \\mathbf{F}(\\mathbf{U}) = \\mathbf{0},\n$$\n其中守恒变量矢量为 $\\mathbf{U} = [\\rho,\\ \\rho u,\\ \\rho v,\\ \\rho E]^{\\top}$，$\\rho$ 是密度，$u$ 和 $v$ 是速度分量，$E$ 是比总能。$x$ 和 $y$ 方向的无粘通量分别为 $\\mathbf{F}_x(\\mathbf{U})$ 和 $\\mathbf{F}_y(\\mathbf{U})$，对应于欧拉方程组。对于一个单位外法向量为 $\\mathbf{n} = (n_x, n_y)$ 的面，物理法向通量为 $\\mathbf{F}_n(\\mathbf{U}) = \\mathbf{F}_x(\\mathbf{U}) n_x + \\mathbf{F}_y(\\mathbf{U}) n_y$。在有限体积法中，数值通量 $\\hat{\\mathbf{F}}(\\mathbf{U}_L,\\mathbf{U}_R)\\cdot \\mathbf{n}$ 基于左、右重构状态 $\\mathbf{U}_L$ 和 $\\mathbf{U}_R$，为面上的物理法向通量提供了一个相容的近似。\n\n假设流体是空气，并建模为比热比 $\\gamma = 1.4$ 的量热完全气体。在某个特定的面上，单位外法向量为 $\\mathbf{n} = (\\cos\\theta,\\ \\sin\\theta)$，其中 $\\theta = \\pi/6$ 弧度。左、右重构的原始变量状态为：\n- 左侧：密度 $\\rho_L = 1.2$，速度分量 $u_L = 150$ 和 $v_L = 0$，压力 $p_L = 100000$。\n- 右侧：密度 $\\rho_R = 1.8$，速度分量 $u_R = 100$ 和 $v_R = 20$，压力 $p_R = 150000$。\n\n使用与面法向对齐的局部Lax–Friedrichs（LLF，也称为Rusanov）数值通量来确定穿过该面的质量通量，其定义为 $\\hat{\\mathbf{F}}(\\mathbf{U}_L,\\mathbf{U}_R)\\cdot \\mathbf{n}$ 的第一个分量。量热完全气体中的声速 $a$ 由 $a = \\sqrt{\\gamma p/\\rho}$ 给出。\n\n使用指定的数值通量和给定数据计算穿过该面的标量质量通量。将最终结果四舍五入到四位有效数字。以 $\\mathrm{kg}/(\\mathrm{m}^2\\cdot\\mathrm{s})$ 为单位表示你的答案。",
            "solution": "用户提供的问题经评估是有效的，因为它在科学上基于计算流体力学的原理，提供了所有必要信息故而是适定的，并且其表述是客观的。因此，我们可以着手进行求解。\n\n问题要求计算由局部Lax–Friedrichs（LLF）或Rusanov数值通量格式决定的穿过一个面的质量通量。对于一个单位外法向量为 $\\mathbf{n}$ 的面，LLF数值通量的一般形式为：\n$$\n\\hat{\\mathbf{F}}_n(\\mathbf{U}_L, \\mathbf{U}_R) = \\frac{1}{2} \\left[ \\mathbf{F}_n(\\mathbf{U}_L) + \\mathbf{F}_n(\\mathbf{U}_R) \\right] - \\frac{1}{2} S_{\\max} (\\mathbf{U}_R - \\mathbf{U}_L)\n$$\n此处，$\\mathbf{U}_L$ 和 $\\mathbf{U}_R$ 分别是面左侧和右侧的守恒变量的重构状态。$\\mathbf{F}_n(\\mathbf{U}) = \\mathbf{F}_x(\\mathbf{U}) n_x + \\mathbf{F}_y(\\mathbf{U}) n_y$ 是垂直于面的物理通量。$S_{\\max}$ 项表示面上的最大信号速度（波速），它提供了数值耗散。\n\n守恒变量矢量为 $\\mathbf{U} = [\\rho, \\rho u, \\rho v, \\rho E]^{\\top}$。质量通量是数值通量矢量 $\\hat{\\mathbf{F}}_n$ 的第一个分量。我们用 $(\\mathbf{V})_i$ 表示矢量 $\\mathbf{V}$ 的分量。质量通量即为 $(\\hat{\\mathbf{F}}_n)_1$。\n\n守恒变量矢量的第一个分量是 $(\\mathbf{U})_1 = \\rho$。物理通量矢量 $\\mathbf{F}_x$ 的第一个分量是 $\\rho u$，对于 $\\mathbf{F}_y$ 则是 $\\rho v$。因此，法向物理通量 $\\mathbf{F}_n$ 的第一个分量是：\n$$\n(\\mathbf{F}_n(\\mathbf{U}))_1 = (\\mathbf{F}_x(\\mathbf{U}))_1 n_x + (\\mathbf{F}_y(\\mathbf{U}))_1 n_y = \\rho u n_x + \\rho v n_y = \\rho (u n_x + v n_y) = \\rho v_n\n$$\n其中 $v_n = \\vec{v} \\cdot \\mathbf{n} = u n_x + v n_y$ 是速度矢量在面法向上的分量。\n\n于是，LLF格式的质量通量分量为：\n$$\n(\\hat{\\mathbf{F}}_n)_1 = \\frac{1}{2} \\left[ (\\mathbf{F}_n(\\mathbf{U}_L))_1 + (\\mathbf{F}_n(\\mathbf{U}_R))_1 \\right] - \\frac{1}{2} S_{\\max} ((\\mathbf{U}_R)_1 - (\\mathbf{U}_L)_1)\n$$\n$$\n(\\hat{\\mathbf{F}}_n)_1 = \\frac{1}{2} (\\rho_L v_{n,L} + \\rho_R v_{n,R}) - \\frac{1}{2} S_{\\max} (\\rho_R - \\rho_L)\n$$\n\n对于欧拉方程，最大信号速度 $S_{\\max}$ 由下式给出：\n$$\nS_{\\max} = \\max(|v_{n,L}| + a_L, |v_{n,R}| + a_R)\n$$\n其中 $a_L$ 和 $a_R$ 是左、右状态的声速。\n\n现在我们使用给定的数据逐步计算必要的量。\n比热比为 $\\gamma = 1.4$。\n面法向矢量为 $\\mathbf{n} = (n_x, n_y)$，角度为 $\\theta = \\pi/6$ 弧度。\n$$\nn_x = \\cos(\\pi/6) = \\frac{\\sqrt{3}}{2}\n$$\n$$\nn_y = \\sin(\\pi/6) = \\frac{1}{2}\n$$\n\n原始变量为：\n左侧状态：$\\rho_L = 1.2$, $u_L = 150$, $v_L = 0$, $p_L = 100000$。\n右侧状态：$\\rho_R = 1.8$, $u_R = 100$, $v_R = 20$, $p_R = 150000$。\n\n首先，我们计算法向速度 $v_{n,L}$ 和 $v_{n,R}$：\n$$\nv_{n,L} = u_L n_x + v_L n_y = (150)\\left(\\frac{\\sqrt{3}}{2}\\right) + (0)\\left(\\frac{1}{2}\\right) = 75\\sqrt{3}\n$$\n$$\nv_{n,R} = u_R n_x + v_R n_y = (100)\\left(\\frac{\\sqrt{3}}{2}\\right) + (20)\\left(\\frac{1}{2}\\right) = 50\\sqrt{3} + 10\n$$\n\n接下来，我们使用公式 $a = \\sqrt{\\gamma p/\\rho}$ 计算声速 $a_L$ 和 $a_R$：\n$$\n\\frac{p_L}{\\rho_L} = \\frac{100000}{1.2} = \\frac{250000}{3}\n$$\n$$\n\\frac{p_R}{\\rho_R} = \\frac{150000}{1.8} = \\frac{1500000}{18} = \\frac{250000}{3}\n$$\n由于 $p_L/\\rho_L = p_R/\\rho_R$，所以声速相等：$a_L = a_R$。我们将这个共同的值称为 $a_c$。\n$$\na_c = a_L = a_R = \\sqrt{\\gamma \\frac{p_L}{\\rho_L}} = \\sqrt{1.4 \\times \\frac{250000}{3}} = \\sqrt{\\frac{350000}{3}}\n$$\n\n现在我们求最大信号速度 $S_{\\max}$：\n$$\nS_{\\max} = \\max(|v_{n,L}| + a_c, |v_{n,R}| + a_c)\n$$\n我们计算法向速度的值：\n$v_{n,L} = 75\\sqrt{3} \\approx 129.90$\n$v_{n,R} = 50\\sqrt{3} + 10 \\approx 96.60$\n两者均为正。由于 $v_{n,L}  v_{n,R}$，我们有 $|v_{n,L}|  |v_{n,R}|$。因此：\n$$\nS_{\\max} = |v_{n,L}| + a_c = v_{n,L} + a_c = 75\\sqrt{3} + \\sqrt{\\frac{350000}{3}}\n$$\n\n现在我们可以整合质量通量的表达式了。\n平均物理通量项为：\n$$\n\\frac{1}{2} (\\rho_L v_{n,L} + \\rho_R v_{n,R}) = \\frac{1}{2} \\left[ 1.2 \\times (75\\sqrt{3}) + 1.8 \\times (50\\sqrt{3} + 10) \\right]\n$$\n$$\n= \\frac{1}{2} \\left[ 90\\sqrt{3} + 90\\sqrt{3} + 18 \\right] = \\frac{1}{2} [180\\sqrt{3} + 18] = 90\\sqrt{3} + 9\n$$\n耗散项为：\n$$\n\\frac{1}{2} S_{\\max} (\\rho_R - \\rho_L) = \\frac{1}{2} \\left( 75\\sqrt{3} + \\sqrt{\\frac{350000}{3}} \\right) (1.8 - 1.2)\n$$\n$$\n= \\frac{1}{2} \\left( 75\\sqrt{3} + \\sqrt{\\frac{350000}{3}} \\right) (0.6) = 0.3 \\left( 75\\sqrt{3} + \\sqrt{\\frac{350000}{3}} \\right)\n$$\n$$\n= 22.5\\sqrt{3} + 0.3\\sqrt{\\frac{350000}{3}}\n$$\n合并各项，数值质量通量为：\n$$\n(\\hat{\\mathbf{F}}_n)_1 = (90\\sqrt{3} + 9) - \\left( 22.5\\sqrt{3} + 0.3\\sqrt{\\frac{350000}{3}} \\right)\n$$\n$$\n(\\hat{\\mathbf{F}}_n)_1 = 67.5\\sqrt{3} + 9 - 0.3\\sqrt{\\frac{350000}{3}}\n$$\n现在，我们计算其数值：\n$\\sqrt{3} \\approx 1.73205$\n$\\sqrt{\\frac{350000}{3}} = \\sqrt{116666.\\overline{6}} \\approx 341.565$\n$$\n(\\hat{\\mathbf{F}}_n)_1 \\approx 67.5 \\times (1.73205) + 9 - 0.3 \\times (341.565)\n$$\n$$\n(\\hat{\\mathbf{F}}_n)_1 \\approx 116.9134 + 9 - 102.4695 = 125.9134 - 102.4695 = 23.4439\n$$\n问题要求将结果四舍五入到四位有效数字。\n计算值为 $23.4439...$。第五位有效数字是 $3$，因此我们向下舍入。\n最终结果是 $23.44$。\n根据输入量的国际单位制单位，单位默认为 $\\mathrm{kg}/(\\mathrm{m}^2\\cdot\\mathrm{s})$。",
            "answer": "$$\n\\boxed{23.44}\n$$"
        }
    ]
}