{
    "hands_on_practices": [
        {
            "introduction": "The foundation of a high-resolution scheme is its ability to achieve higher-order accuracy in smooth regions of the flow while reverting to a robust, first-order scheme near discontinuities. This exercise explores the first part of that principle by examining how various standard Total Variation Diminishing (TVD) limiters behave in an idealized smooth region represented by a constant gradient. By analyzing the case where the smoothness ratio $r=1$, you will verify a fundamental condition for second-order accuracy and see its direct impact on the numerical dissipation of the scheme .",
            "id": "3978800",
            "problem": "Consider the one-dimensional scalar conservation law $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a > 0$ on a uniform grid of cell centers $\\{x_{i}\\}$ with spacing $\\Delta x$. In a finite-volume discretization, use the Monotone Upstream-centered Schemes for Conservation Laws (MUSCL) high-resolution reconstruction to form piecewise linear states. Let the left and right reconstructed interface states at $x_{i+\\frac{1}{2}}$ be\n$$U_{i+\\frac{1}{2}}^{L} = U_{i} + \\frac{1}{2}\\,s_{i}, \\quad U_{i+\\frac{1}{2}}^{R} = U_{i+1} - \\frac{1}{2}\\,s_{i+1},$$\nwhere the limited slopes $s_{i}$ are given by $s_{i} = \\phi(r_{i})\\,(U_{i+1} - U_{i})$ with the Total Variation Diminishing (TVD) limiter argument $r_{i} = \\dfrac{U_{i} - U_{i-1}}{U_{i+1} - U_{i}}$ and limiter function $\\phi(r)$ chosen from the following well-tested TVD limiters:\n- Minmod: $\\phi_{\\mathrm{MM}}(r) = \\max\\!\\big(0, \\min(1, r)\\big)$,\n- Van Leer: $\\phi_{\\mathrm{VL}}(r) = \\dfrac{r + |r|}{1 + |r|}$,\n- Monotonized Central (MC): $\\phi_{\\mathrm{MC}}(r) = \\max\\!\\Big(0, \\min\\!\\big(2r, \\dfrac{1 + r}{2}, 2\\big)\\Big)$,\n- Superbee: $\\phi_{\\mathrm{SB}}(r) = \\max\\!\\big(0, \\min(2r, 1), \\min(r, 2)\\big)$,\n- Van Albada: $\\phi_{\\mathrm{VA}}(r) = \\dfrac{r^{2} + r}{1 + r^{2}}$.\n\nThe numerical flux is taken to be the Local Lax–Friedrichs (also known as Rusanov) flux,\n$$F_{i+\\frac{1}{2}} = \\frac{a}{2}\\,\\Big(U_{i+\\frac{1}{2}}^{L} + U_{i+\\frac{1}{2}}^{R}\\Big) - \\frac{|a|}{2}\\,\\Big(U_{i+\\frac{1}{2}}^{R} - U_{i+\\frac{1}{2}}^{L}\\Big).$$\nDefine the dissipative contribution at the interface $x_{i+\\frac{1}{2}}$ as\n$$D_{i+\\frac{1}{2}} = \\frac{|a|}{2}\\,\\big|U_{i+\\frac{1}{2}}^{R} - U_{i+\\frac{1}{2}}^{L}\\big|.$$\n\nAssume a discrete profile with constant forward and backward differences such that $U_{i+1} - U_{i} = U_{i} - U_{i-1} \\neq 0$, so that $r_{i} = 1$ and $r_{i+1} = 1$. For each limiter listed above, compare the reconstructed interface states $U_{i+\\frac{1}{2}}^{L}$ and $U_{i+\\frac{1}{2}}^{R}$ under the condition $r=1$, and compute the resulting $D_{i+\\frac{1}{2}}$.\n\nExpress the final answer as a single real number. No rounding is required, and no physical units are to be included with the final answer.",
            "solution": "The problem requires the computation of the dissipative contribution, $D_{i+\\frac{1}{2}}$, of the Local Lax-Friedrichs numerical flux for a one-dimensional scalar advection equation. The computation is to be performed under the specific condition of a piecewise linear data profile with a constant gradient, using the MUSCL high-resolution reconstruction method with several common TVD flux limiters.\n\nThe problem defines the left and right reconstructed states at the interface $x_{i+\\frac{1}{2}}$ as:\n$$U_{i+\\frac{1}{2}}^{L} = U_{i} + \\frac{1}{2}\\,s_{i}$$\n$$U_{i+\\frac{1}{2}}^{R} = U_{i+1} - \\frac{1}{2}\\,s_{i+1}$$\nThe limited slopes, $s_i$, are given by $s_{i} = \\phi(r_{i})\\,(U_{i+1} - U_{i})$, where $\\phi(r)$ is a limiter function and $r_i$ is the ratio of successive gradients:\n$$r_{i} = \\frac{U_{i} - U_{i-1}}{U_{i+1} - U_{i}}$$\nThe dissipative contribution to the flux is defined as:\n$$D_{i+\\frac{1}{2}} = \\frac{|a|}{2}\\,\\big|U_{i+\\frac{1}{2}}^{R} - U_{i+\\frac{1}{2}}^{L}\\big|$$\nwhere $a0$ is the constant advection speed, so $|a|=a$.\n\nThe key condition provided is that the discrete profile has constant forward and backward differences, such that $U_{i+1} - U_{i} = U_{i} - U_{i-1} \\neq 0$. This directly implies that the limiter argument $r_{i}$ is:\n$$r_{i} = \\frac{U_{i} - U_{i-1}}{U_{i+1} - U_{i}} = 1$$\nThe problem also states that $r_{i+1} = 1$. This is consistent with a profile having a globally constant gradient, since $r_{i+1} = \\frac{U_{i+1} - U_{i}}{U_{i+2} - U_{i+1}} = 1$ implies $U_{i+2} - U_{i+1} = U_{i+1} - U_{i}$.\n\nOur first step is to evaluate each of the specified limiter functions $\\phi(r)$ at $r=1$. This is a necessary condition for a scheme to be second-order accurate in smooth regions of the solution.\n\n1.  **Minmod Limiter:**\n    $$\\phi_{\\mathrm{MM}}(r) = \\max\\!\\big(0, \\min(1, r)\\big)$$\n    For $r=1$:\n    $$\\phi_{\\mathrm{MM}}(1) = \\max\\!\\big(0, \\min(1, 1)\\big) = \\max(0, 1) = 1$$\n\n2.  **Van Leer Limiter:**\n    $$\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}$$\n    For $r=1$:\n    $$\\phi_{\\mathrm{VL}}(1) = \\frac{1 + |1|}{1 + |1|} = \\frac{1 + 1}{1 + 1} = \\frac{2}{2} = 1$$\n\n3.  **Monotonized Central (MC) Limiter:**\n    $$\\phi_{\\mathrm{MC}}(r) = \\max\\!\\Big(0, \\min\\!\\big(2r, \\frac{1 + r}{2}, 2\\big)\\Big)$$\n    For $r=1$:\n    $$\\phi_{\\mathrm{MC}}(1) = \\max\\!\\Big(0, \\min\\!\\big(2(1), \\frac{1 + 1}{2}, 2\\big)\\Big) = \\max\\!\\big(0, \\min(2, 1, 2)\\big) = \\max(0, 1) = 1$$\n\n4.  **Superbee Limiter:**\n    $$\\phi_{\\mathrm{SB}}(r) = \\max\\!\\big(0, \\min(2r, 1), \\min(r, 2)\\big)$$\n    For $r=1$:\n    $$\\phi_{\\mathrm{SB}}(1) = \\max\\!\\big(0, \\min(2(1), 1), \\min(1, 2)\\big) = \\max\\!\\big(0, \\min(2, 1), \\min(1, 2)\\big) = \\max(0, 1, 1) = 1$$\n\n5.  **Van Albada Limiter:**\n    $$\\phi_{\\mathrm{VA}}(r) = \\frac{r^{2} + r}{1 + r^{2}}$$\n    For $r=1$:\n    $$\\phi_{\\mathrm{VA}}(1) = \\frac{1^{2} + 1}{1 + 1^{2}} = \\frac{1+1}{1+1} = \\frac{2}{2} = 1$$\n\nFor all five specified limiters, we find that $\\phi(1) = 1$. This means the result will be identical regardless of which of these limiters is chosen.\n\nNow, we compute the limited slopes $s_{i}$ and $s_{i+1}$.\nFor slope $s_{i}$:\n$$s_{i} = \\phi(r_{i})\\,(U_{i+1} - U_{i}) = \\phi(1)\\,(U_{i+1} - U_{i}) = 1 \\cdot (U_{i+1} - U_{i}) = U_{i+1} - U_{i}$$\nFor slope $s_{i+1}$, we use the condition $r_{i+1}=1$, which implies $U_{i+2}-U_{i+1} = U_{i+1}-U_i$.\n$$s_{i+1} = \\phi(r_{i+1})\\,(U_{i+2} - U_{i+1}) = \\phi(1)\\,(U_{i+1} - U_{i}) = 1 \\cdot (U_{i+1} - U_{i}) = U_{i+1} - U_{i}$$\nBoth slopes are identical and equal to the unlimited central difference gradient.\n\nNext, we substitute these slopes into the expressions for the reconstructed interface states, $U_{i+\\frac{1}{2}}^{L}$ and $U_{i+\\frac{1}{2}}^{R}$.\nFor the left state:\n$$U_{i+\\frac{1}{2}}^{L} = U_{i} + \\frac{1}{2}\\,s_{i} = U_{i} + \\frac{1}{2}\\,(U_{i+1} - U_{i}) = U_{i} - \\frac{1}{2}\\,U_{i} + \\frac{1}{2}\\,U_{i+1} = \\frac{1}{2}\\,(U_{i} + U_{i+1})$$\nFor the right state:\n$$U_{i+\\frac{1}{2}}^{R} = U_{i+1} - \\frac{1}{2}\\,s_{i+1} = U_{i+1} - \\frac{1}{2}\\,(U_{i+1} - U_{i}) = U_{i+1} - \\frac{1}{2}\\,U_{i+1} + \\frac{1}{2}\\,U_{i} = \\frac{1}{2}\\,(U_{i+1} + U_{i})$$\n\nComparing the two reconstructed states, we find:\n$$U_{i+\\frac{1}{2}}^{L} = U_{i+\\frac{1}{2}}^{R} = \\frac{1}{2}\\,(U_{i} + U_{i+1})$$\nThe reconstructed values at the interface are identical. This indicates that the piecewise linear representation of the solution is continuous at the cell interface $x_{i+\\frac{1}{2}}$. This is the expected behavior for a second-order accurate reconstruction scheme in a region of smooth, monotonic data.\n\nFinally, we compute the dissipative contribution $D_{i+\\frac{1}{2}}$ using its definition:\n$$D_{i+\\frac{1}{2}} = \\frac{|a|}{2}\\,\\big|U_{i+\\frac{1}{2}}^{R} - U_{i+\\frac{1}{2}}^{L}\\big|$$\nSubstituting the derived states:\n$$D_{i+\\frac{1}{2}} = \\frac{|a|}{2}\\,\\left|\\frac{1}{2}\\,(U_{i} + U_{i+1}) - \\frac{1}{2}\\,(U_{i} + U_{i+1})\\right| = \\frac{|a|}{2}\\,|0| = 0$$\nThe dissipative contribution at the interface is exactly zero under the given conditions for all specified limiters. This occurs because in a region of constant gradient, a TVD scheme designed for second-order accuracy reverts to a non-dissipative (or minimally dissipative) centered scheme. For the Rusanov flux, the dissipative term vanishes when the jump in the reconstructed states at the interface is zero.\n\nThe Final answer is $0$.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "While accuracy in smooth regions is essential, the defining characteristic of a shock-capturing scheme is its performance at discontinuities. The behavior of a limiter at sharp changes in gradient, where the smoothness ratio $r$ can approach infinity, determines its \"character\"—whether it tends to sharpen profiles (compressive) or smooth them out (dissipative). This practice analyzes this crucial asymptotic limit for different limiters, providing insight into why schemes like Superbee are excellent for resolving contact discontinuities, and how to ensure the scheme remains non-oscillatory .",
            "id": "3978837",
            "problem": "Consider the linear scalar advection equation $\\partial_t u + a \\,\\partial_x u = 0$ with constant speed $a0$ discretized on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$. A high-resolution Monotone Upstream-centered Schemes for Conservation Laws (MUSCL) reconstruction is used to obtain left-biased interface states for a monotone upwind numerical flux. Define the local smoothness ratio at cell $i$ by $r_i = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$, where $\\Delta^- u_i = u_i - u_{i-1}$ and $\\Delta^+ u_i = u_{i+1} - u_i$. The interface state entering the flux at $x_{i+1/2}$ is reconstructed as $u_{i+1/2}^- = u_i + \\dfrac{1}{2} \\,\\phi(r_i)\\,\\Delta^- u_i$, where $\\phi(r)$ is a slope-limiter function constrained by Total Variation Diminishing (TVD) requirements.\n\nAssume a contact-like configuration in which $u_{i+1}-u_i \\to 0^+$ while $u_i - u_{i-1}  0$ remains finite, so that $r_i \\to +\\infty$. Analyze the asymptotic behavior of $\\phi(r)$ as $r \\to \\infty$ and its effect on contact steepening and the possibility of spurious overshoots, under the conditions that the numerical flux is monotone upwind and the Courant–Friedrichs–Lewy (CFL) number $\\lambda = a\\,\\Delta t/\\Delta x$ satisfies $0\\lambda1$.\n\nWhich of the following statements are correct?\n\nA. If $\\lim_{r\\to\\infty} \\phi(r) = 2$, the limiter is maximally compressive at the upper TVD bound. In the scalar advection setting with a monotone flux and $0\\lambda1$, this sharpens contact discontinuities without producing overshoots.\n\nB. If $\\lim_{r\\to\\infty} \\phi(r) = 1$, then at the contact the reconstructed left state satisfies $u_{i+1/2}^- - u_i \\approx \\dfrac{1}{2}\\,\\Delta^- u_i$, which is less compressive than the $\\phi(\\infty)=2$ case. Under the same scalar TVD conditions, overshoots still do not occur.\n\nC. If $\\lim_{r\\to\\infty} \\phi(r) = 0$, the reconstruction becomes piecewise constant at the contact ($u_{i+1/2}^- \\approx u_i$), reducing to first-order upwind locally. This eliminates contact steepening and precludes overshoots for scalar advection with monotone flux.\n\nD. If $\\lim_{r\\to\\infty} \\phi(r)  2$, the limiter exits the TVD admissible region (e.g., the Sweby bounds), so even for scalar advection with monotone flux and $0\\lambda1$, spurious overshoots or oscillations can occur.\n\nE. If $\\lim_{r\\to\\infty} \\phi(r) = 1$, the MUSCL reconstruction becomes central differencing at the contact, which increases the likelihood of overshoots despite a monotone flux.\n\nF. If $\\lim_{r\\to\\infty} \\phi(r) = 2$, the scheme achieves second-order accuracy at the contact regardless of solution regularity and therefore produces no numerical diffusion there.",
            "solution": "The user wants a critical validation of the problem statement, followed by a detailed solution and evaluation of the provided options.\n\n### Step 1: Extract Givens\n- **Governing Equation**: Linear scalar advection equation, $\\partial_t u + a \\,\\partial_x u = 0$, with constant advection speed $a  0$.\n- **Discretization**: Uniform grid with cell spacing $\\Delta x$ and time step $\\Delta t$.\n- **Numerical Scheme**: A finite volume method using a high-resolution MUSCL (Monotone Upstream-centered Schemes for Conservation Laws) reconstruction.\n- **Numerical Flux**: A monotone upwind numerical flux is used. Given $a  0$, the flux at interface $x_{i+1/2}$ depends on a left-reconstructed state, $u_{i+1/2}^-$.\n- **Definitions**:\n    - Cell index: $i$.\n    - Forward difference: $\\Delta^+ u_i = u_{i+1} - u_i$.\n    - Backward difference: $\\Delta^- u_i = u_i - u_{i-1}$.\n    - Smoothness ratio: $r_i = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$.\n- **Reconstruction Formula**: The left-biased interface state is given by $u_{i+1/2}^- = u_i + \\dfrac{1}{2} \\,\\phi(r_i)\\,\\Delta^- u_i$.\n- **Limiter Function**: $\\phi(r)$ is a slope-limiter function.\n- **Constraint**: The scheme must be Total Variation Diminishing (TVD).\n- **CFL Condition**: The Courant–Friedrichs–Lewy number $\\lambda = a\\,\\Delta t/\\Delta x$ satisfies $0  \\lambda  1$.\n- **Scenario**: A \"contact-like\" configuration is assumed, where $u_{i+1}-u_i \\to 0^+$ and $u_i - u_{i-1}  0$ (finite). This implies $r_i \\to +\\infty$.\n- **Question**: Analyze the asymptotic behavior of $\\phi(r)$ as $r \\to \\infty$ and its effect on contact steepening and the possibility of spurious overshoots.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific or Factual Unsoundness**: The problem statement is scientifically sound. It describes a standard setup for analyzing second-order TVD schemes in computational fluid dynamics. All definitions, including the MUSCL reconstruction formula, the smoothness ratio $r_i$, and the governing equation, are standard in the field.\n2.  **Non-Formalizable or Irrelevant**: The problem is well-defined mathematically and directly relevant to the topic of high-resolution schemes.\n3.  **Incomplete or Contradictory Setup**: The problem is self-contained. It provides the governing equation, the numerical scheme's structure, the specific reconstruction formula, the properties of the flux, and the CFL condition. These are sufficient to perform the required analysis.\n4.  **Unrealistic or Infeasible**: The scenario of a \"contact-like\" configuration ($r_i \\to \\infty$) is a standard and physically meaningful case for testing the behavior of numerical schemes at local extrema or sharp changes in gradient.\n5.  **Ill-Posed or Poorly Structured**: The problem is well-posed. The analysis of limiter behavior based on TVD theory leads to a unique and meaningful conclusion for each case.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The problem requires a solid understanding of TVD theory and numerical scheme properties, particularly the role of slope limiters. It is a non-trivial question.\n7.  **Outside Scientific Verifiability**: The claims can be rigorously verified using the mathematical theory of numerical analysis for conservation laws.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. The analysis can proceed.\n\n### Solution Derivation\n\nThe problem concerns a MUSCL-type finite volume scheme for the linear advection equation. The update for the cell-average value $u_i$ is given by:\n$$ u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right) $$\nFor linear advection with $a  0$ and an upwind flux, the numerical flux is $F_{i+1/2} = a \\, u_{i+1/2}^-$. The scheme becomes:\n$$ u_i^{n+1} = u_i^n - \\lambda \\left( u_{i+1/2}^- - u_{i-1/2}^- \\right) $$\nwhere $\\lambda = a \\Delta t / \\Delta x$ is the CFL number, and the reconstructed state is $u_{i+1/2}^- = u_i + \\frac{1}{2} \\phi(r_i) \\Delta^- u_i$.\n\nA key requirement for high-resolution schemes is that they should not introduce spurious oscillations. For scalar conservation laws, this is guaranteed if the scheme is Total Variation Diminishing (TVD). For the given scheme structure (upwind flux, MUSCL reconstruction with the specified formula), the condition to be TVD for $0  \\lambda  1$ imposes bounds on the limiter function $\\phi(r)$. These bounds, famously visualized in the Sweby diagram, are:\n$$ 0 \\le \\phi(r) \\le 2 \\quad \\text{and} \\quad 0 \\le \\frac{\\phi(r)}{r} \\le 2, \\quad \\text{for } r > 0 $$\nCombining these gives the condition $0 \\le \\phi(r) \\le \\min(2, 2r)$ for $r0$.\n\nThe problem asks to analyze the behavior in a \"contact-like\" configuration where $r_i = \\frac{\\Delta^- u_i}{\\Delta^+ u_i} \\to +\\infty$. In this limit, the TVD condition $\\phi(r) \\le \\min(2, 2r)$ simplifies to $\\lim_{r\\to\\infty} \\phi(r) \\le 2$. Thus, for the scheme to be TVD in this limit, the limiter function must satisfy:\n$$ 0 \\le \\lim_{r\\to\\infty} \\phi(r) \\le 2 $$\nAny value of $\\lim_{r\\to\\infty} \\phi(r)$ outside this range will violate the TVD property and can lead to overshoots.\n\nThe value of $\\phi(r)$ also determines the character of the scheme. $\\phi(r)=0$ recovers the first-order upwind scheme, which is highly diffusive. Positive values of $\\phi(r)$ introduce an \"anti-diffusive\" flux term that counteracts numerical diffusion, leading to a higher-order, more compressive scheme that better resolves sharp features. A larger $\\phi(r)$ value (within the TVD limits) implies a more compressive (less diffusive) scheme.\n\nWe now evaluate each statement based on this framework.\n\n### Option-by-Option Analysis\n\n**A. If $\\lim_{r\\to\\infty} \\phi(r) = 2$, the limiter is maximally compressive at the upper TVD bound. In the scalar advection setting with a monotone flux and $0\\lambda1$, this sharpens contact discontinuities without producing overshoots.**\n\nThe value $\\phi(\\infty) = 2$ lies on the upper boundary of the TVD region $[0, 2]$. This represents the most aggressive anti-diffusive correction allowed while formally remaining TVD. Such limiters are termed \"compressive\" because they actively steepen profiles. At a contact discontinuity, this manifests as a sharper, less smeared representation. Because the scheme remains TVD (albeit on the boundary), it is guaranteed not to create new local extrema, meaning no overshoots for scalar linear advection. This statement is an accurate description of limiters like Superbee or van Leer in this asymptotic regime.\n**Verdict: Correct**\n\n**B. If $\\lim_{r\\to\\infty} \\phi(r) = 1$, then at the contact the reconstructed left state satisfies $u_{i+1/2}^- - u_i \\approx \\dfrac{1}{2}\\,\\Delta^- u_i$, which is less compressive than the $\\phi(\\infty)=2$ case. Under the same scalar TVD conditions, overshoots still do not occur.**\n\nIf $\\lim_{r\\to\\infty} \\phi(r) = 1$, the reconstruction is $u_{i+1/2}^- \\approx u_i + \\frac{1}{2}(1)\\Delta^- u_i$. The added correction term is $\\frac{1}{2}\\Delta^-u_i$. For the $\\phi(\\infty)=2$ case, the correction is $\\frac{1}{2}(2)\\Delta^-u_i = \\Delta^-u_i$. Since the correction term is smaller, the scheme is less compressive (i.e., more diffusive) than the maximally compressive case. The value $\\phi(\\infty) = 1$ is well within the TVD region $[0, 2]$, so the scheme is TVD and will not produce overshoots.\n**Verdict: Correct**\n\n**C. If $\\lim_{r\\to\\infty} \\phi(r) = 0$, the reconstruction becomes piecewise constant at the contact ($u_{i+1/2}^- \\approx u_i$), reducing to first-order upwind locally. This eliminates contact steepening and precludes overshoots for scalar advection with monotone flux.**\n\nIf $\\lim_{r\\to\\infty} \\phi(r) = 0$, the reconstruction formula gives $u_{i+1/2}^- \\approx u_i + \\frac{1}{2}(0)\\Delta^- u_i = u_i$. This means the value at the interface is simply the average value from the upwind cell, which is the definition of a piecewise constant data reconstruction. This reduces the scheme to the first-order upwind method. This method is known to be the most diffusive among this class of schemes, smearing discontinuities rather than steepening them (\"eliminates contact steepening\"). The first-order upwind scheme is monotone for $\\lambda \\le 1$ and therefore is TVD and cannot produce overshoots.\n**Verdict: Correct**\n\n**D. If $\\lim_{r\\to\\infty} \\phi(r)  2$, the limiter exits the TVD admissible region (e.g., the Sweby bounds), so even for scalar advection with monotone flux and $0\\lambda1$, spurious overshoots or oscillations can occur.**\n\nAs established, the TVD region for $r \\to \\infty$ is $0 \\le \\phi(\\infty) \\le 2$. If $\\lim_{r\\to\\infty} \\phi(r)  2$, the limiter function exits this region. A scheme that does not satisfy the TVD conditions is not guaranteed to prevent the growth of total variation, which can manifest as the creation of new extrema, i.e., spurious overshoots and undershoots, particularly near discontinuities. This statement is a fundamental conclusion of TVD theory.\n**Verdict: Correct**\n\n**E. If $\\lim_{r\\to\\infty} \\phi(r) = 1$, the MUSCL reconstruction becomes central differencing at the contact, which increases the likelihood of overshoots despite a monotone flux.**\n\nThe reconstruction with $\\phi(\\infty)=1$ gives $u_{i+1/2}^- \\approx u_i + \\frac{1}{2}(u_i-u_{i-1})$. This corresponds to a fully upwind slope. A reconstruction based on a central difference slope from cell $i$, $\\frac{u_{i+1}-u_{i-1}}{2\\Delta x}$, would yield $u_{i+1/2}^- = u_i + \\frac{1}{2} \\frac{u_{i+1}-u_{i-1}}{2} = u_i + \\frac{1}{4}(\\Delta^+ u_i + \\Delta^- u_i)$.\nIn our framework, this requires $\\phi(r_i)\\Delta^- u_i = \\frac{1}{2}(\\Delta^+ u_i + \\Delta^- u_i)$, so $\\phi(r_i) = \\frac{1}{2}(1 + 1/r_i)$. Thus, central differencing corresponds to $\\phi(\\infty) = 1/2$, not $1$. Furthermore, the claim that it \"increases the likelihood of overshoots\" is false, as $\\phi(\\infty)=1$ is within the TVD region, and such schemes are designed explicitly to prevent overshoots.\n**Verdict: Incorrect**\n\n**F. If $\\lim_{r\\to\\infty} \\phi(r) = 2$, the scheme achieves second-order accuracy at the contact regardless of solution regularity and therefore produces no numerical diffusion there.**\n\nThis statement contains two major flaws. First, the concept of \"order of accuracy,\" which is based on Taylor series expansions, is not applicable at a discontinuity where the solution is not smooth. Limiters are designed to locally reduce the scheme to first-order at extrema and discontinuities to ensure stability and prevent oscillations. Second, the claim of \"no numerical diffusion\" is idealistic and generally false. While compressive limiters ($\\phi(\\infty)=2$) are designed to strongly counteract numerical diffusion, they do not eliminate it entirely. Zero numerical diffusion is only possible under very specific circumstances (e.g., first-order upwind with $\\lambda=1$).\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{ABCD}$$"
        },
        {
            "introduction": "Theory and analysis culminate in implementation. This final practice challenges you to integrate the concepts of reconstruction, limiting, and time-stepping into a complete, working solver for the linear advection equation. By programming a MUSCL-based finite volume scheme to transport a smooth Gaussian pulse and systematically measuring its error across refining meshes, you will verify the scheme's theoretical second-order accuracy. This exercise provides invaluable hands-on experience in building and validating a high-resolution numerical method from first principles .",
            "id": "3978860",
            "problem": "Consider the one-dimensional linear advection equation $u_t + a\\,u_x = 0$ posed on the periodic domain $x \\in [0,L]$, with non-dimensional parameters. The initial condition is a smooth Gaussian pulse $u(x,0) = \\exp\\!\\left(-\\dfrac{(x - x_0)^2}{2\\,\\sigma^2}\\right)$, where $x_0 \\in [0,L]$ and $\\sigma  0$. The exact solution after time $T$ is $u(x,T) = u(x - a\\,T,0)$ under periodic boundary conditions. For $a = 1$ and $T = L$, the solution completes one full period and returns exactly to the initial condition, so $u(x,L) = u(x,0)$.\n\nStarting from the integral conservation form and the definition of a finite volume method on a uniform mesh with $N$ cells of width $\\Delta x = L/N$, derive a second-order accurate semi-discrete update for the cell-average $U_i(t)$ using Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) high-resolution reconstruction. Use a Total Variation Diminishing (TVD) limiter to ensure stability and non-oscillatory behavior. Close the semi-discrete system with a second-order Strong Stability Preserving Runge–Kutta (SSP RK2) time integration. The numerical flux at each cell interface must be upwind consistent with the sign of $a$.\n\nDefine the discrete $L_1$ error norm $E_{1}(N)$ and the discrete $L_2$ error norm $E_{2}(N)$ at $t=T$ for a mesh size $\\Delta x = L/N$ by\n$$\nE_{1}(N) = \\Delta x \\sum_{i=0}^{N-1} \\left| U_i(T) - U_i^{\\text{exact}}(T) \\right|,\n\\qquad\nE_{2}(N) = \\left(\\Delta x \\sum_{i=0}^{N-1} \\left( U_i(T) - U_i^{\\text{exact}}(T) \\right)^2 \\right)^{1/2},\n$$\nwhere $U_i^{\\text{exact}}(T)$ denotes the exact solution sampled as cell averages or point values at cell centers consistent with your discretization. Estimate the observed convergence rates $p_1$ and $p_2$ by fitting a straight line to $\\log(E_{1}(N))$ and $\\log(E_{2}(N))$ versus $\\log(\\Delta x)$ over a sequence of refinements, and define the rates as the negative of the fitted slopes. Verify that the rates are approximately second order on smooth data.\n\nYour task is to write a complete, runnable program that:\n- Implements a uniform finite volume discretization for $u_t + a\\,u_x = 0$ with $a = 1$ on $x \\in [0,L]$, $L = 1$, and periodic boundary conditions.\n- Uses MUSCL high-resolution piecewise-linear reconstruction with a TVD limiter to obtain left and right interface states. The limiter is parameterized by a choice among three canonical options: minmod, van Leer, and Monotonized Central (MC).\n- Advances the solution using second-order SSP RK2 to time $T = L$.\n- Computes the discrete $L_1$ and $L_2$ error norms at final time by comparing to the exact solution (which equals the initial condition for $T = L$).\n- Estimates the observed convergence rates by linear regression on $\\log$–$\\log$ data across the mesh sizes in the test suite.\n\nUse non-dimensional units throughout; no physical units are required.\n\nTest Suite:\n- Case $1$: limiter $=$ minmod, $\\text{CFL} = 0.5$, Gaussian width $\\sigma = 0.05$, $x_0 = 0.25$, mesh sizes $N \\in \\{50, 100, 200, 400\\}$.\n- Case $2$: limiter $=$ van Leer, $\\text{CFL} = 0.8$, Gaussian width $\\sigma = 0.08$, $x_0 = 0.25$, mesh sizes $N \\in \\{50, 100, 200, 400\\}$.\n- Case $3$: limiter $=$ MC, $\\text{CFL} = 0.4$, Gaussian width $\\sigma = 0.03$, $x_0 = 0.25$, mesh sizes $N \\in \\{50, 100, 200, 400\\}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case returns a two-element list $[p_1, p_2]$ of floating-point values representing the observed $L_1$ and $L_2$ convergence rates. For example, the output must be of the form $\\left[\\left[p_{1,1},p_{1,2}\\right],\\left[p_{2,1},p_{2,2}\\right],\\left[p_{3,1},p_{3,2}\\right]\\right]$.\n\nAll angles, if any, must be in radians, though none are used in this problem. Percentages are not used; whenever a fraction is needed it must be expressed as a decimal or a rational ratio.\n\nNo external input is permitted; all parameters are fixed as specified above, and the program must run to completion and print only the final results in the exact format stated.",
            "solution": "The user provides a valid, well-posed problem statement from the field of computational fluid dynamics. The task is to implement a second-order finite volume scheme for the one-dimensional linear advection equation, verify its convergence rate, and provide the implementation in a complete, runnable program. The following represents a complete, reasoned solution derived from first principles.\n\nThe governing partial differential equation is the linear advection equation:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\nwhere $u(x,t)$ is the conserved quantity, $x \\in [0,L]$ is the spatial coordinate, $t$ is time, and $a$ is the constant wave speed, given as $a=1$. The domain has length $L=1$ with periodic boundary conditions. The initial condition is a Gaussian pulse:\n$$\nu(x,0) = \\exp\\left(-\\frac{(x - x_0)^2}{2\\sigma^2}\\right)\n$$\nThe problem is to be solved up to a final time $T=L=1$. Given $a=1$ and $T=L$, the exact solution propagates exactly one period, so $u(x,T) = u(x,0)$.\n\n**1. Finite Volume Discretization**\n\nWe start from the integral form of the conservation law, obtained by integrating the PDE over a control volume, or cell, $C_i = [x_{i-1/2}, x_{i+1/2}]$ of width $\\Delta x = x_{i+1/2} - x_{i-1/2}$:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial u}{\\partial t} dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial (au)}{\\partial x} dx = 0\n$$\nDefining the cell-average of $u$ in cell $i$ as $U_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x,t) dx$, the equation becomes:\n$$\n\\frac{d U_i}{dt} + \\frac{1}{\\Delta x} \\left[ (au)_{i+1/2} - (au)_{i-1/2} \\right] = 0\n$$\nHere, $(au)_{i\\pm 1/2}$ represents the flux of $u$ at the cell interfaces $x_{i\\pm 1/2}$. In a numerical scheme, these are replaced by a numerical flux function, $F(u_L, u_R)$, which depends on the reconstructed states on the left ($u_L$) and right ($u_R$) of the interface. This gives the semi-discrete finite volume formula:\n$$\n\\frac{d U_i}{dt} = -\\frac{1}{\\Delta x} (F_{i+1/2} - F_{i-1/2})\n$$\nFor the linear advection equation with flux $f(u) = au$, the upwind numerical flux is used. Since $a=1  0$, the information propagates from left to right. The flux at any interface is determined by the state to its left:\n$$\nF_{i+1/2} = F(U_{i+1/2}^L, U_{i+1/2}^R) = a U_{i+1/2}^L\n$$\nwhere $U_{i+1/2}^L$ is the value of the solution reconstructed at the left side of the interface $x_{i+1/2}$.\n\n**2. MUSCL High-Resolution Reconstruction**\n\nTo achieve second-order spatial accuracy, we use the Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) approach. Within each cell $C_i$, the solution is approximated by a piecewise linear function:\n$$\nu(x) \\approx U_i + s_i \\frac{x - x_i}{\\Delta x} \\quad \\text{for } x \\in [x_{i-1/2}, x_{i+1/2}]\n$$\nwhere $x_i$ is the cell center and $s_i$ is a limited slope. The value at the right interface of cell $i$ (the left side of interface $x_{i+1/2}$) is then found by evaluating this reconstruction at $x = x_{i+1/2} = x_i + \\Delta x/2$:\n$$\nU_{i+1/2}^L = U_i + \\frac{s_i}{2}\n$$\nThe semi-discrete update for cell $i$ requires fluxes $F_{i+1/2}$ and $F_{i-1/2}$. The flux $F_{i-1/2}$ is determined by the reconstruction in cell $i-1$:\n$$\nF_{i-1/2} = a U_{i-1/2}^L = a \\left(U_{i-1} + \\frac{s_{i-1}}{2}\\right)\n$$\nThe full semi-discrete update is thus:\n$$\n\\frac{d U_i}{dt} = -\\frac{a}{\\Delta x} \\left[ \\left(U_i + \\frac{s_i}{2}\\right) - \\left(U_{i-1} + \\frac{s_{i-1}}{2}\\right) \\right]\n$$\n\n**3. TVD Slope Limiters**\n\nTo prevent spurious oscillations and ensure the Total Variation Diminishing (TVD) property, the slope $s_i$ is limited. The slope is computed based on the differences between neighboring cell averages: the backward difference $\\Delta_i^- = U_i - U_{i-1}$ and the forward difference $\\Delta_i^+ = U_{i+1} - U_i$. The limited slope is $s_i = \\text{limiter}(\\Delta_i^-, \\Delta_i^+)$. The problem specifies three options:\n\n- **Minmod Limiter:** This is the most dissipative limiter.\n  $$\n  s_i = \\text{minmod}(\\Delta_i^-, \\Delta_i^+) = \\begin{cases} \\text{sgn}(\\Delta_i^-) \\min(|\\Delta_i^-|, |\\Delta_i^+|)  \\text{if } \\Delta_i^- \\Delta_i^+  0 \\\\ 0  \\text{if } \\Delta_i^- \\Delta_i^+ \\le 0 \\end{cases}\n  $$\n- **Van Leer Limiter:** A smooth limiter that provides a good balance between accuracy and monotonicity.\n  $$\n  s_i = \\begin{cases} \\frac{2 \\Delta_i^- \\Delta_i^+}{\\Delta_i^- + \\Delta_i^+}  \\text{if } \\Delta_i^- \\Delta_i^+  0 \\\\ 0  \\text{if } \\Delta_i^- \\Delta_i^+ \\le 0 \\end{cases}\n  $$\n- **Monotonized Central (MC) Limiter:** This limiter is less dissipative and aims to recover a central-difference slope where possible without introducing oscillations.\n  $$\n  s_i = \\text{minmod}\\left(2\\Delta_i^-, 2\\Delta_i^+, \\frac{\\Delta_i^- + \\Delta_i^+}{2}\\right)\n  $$\n  where the multi-argument minmod function returns the argument with the smallest magnitude if all arguments have the same sign, and zero otherwise.\n\n**4. Temporal Integration: SSP Runge-Kutta 2**\n\nThe semi-discrete system is a set of ordinary differential equations of the form $\\frac{dU}{dt} = L(U)$, where $L(U)$ is the spatial operator (the right-hand side). This system is integrated in time using a second-order Strong Stability Preserving Runge-Kutta (SSP-RK2) method, also known as Heun's method.\n$$\n\\begin{aligned}\nU^{(1)} = U^n + \\Delta t \\, L(U^n) \\\\\nU^{n+1} = \\frac{1}{2} U^n + \\frac{1}{2} \\left( U^{(1)} + \\Delta t \\, L(U^{(1)}) \\right)\n\\end{aligned}\n$$\nThe time step $\\Delta t$ is determined by the Courant-Friedrichs-Lewy (CFL) condition for stability:\n$$\n\\Delta t = \\text{CFL} \\frac{\\Delta x}{|a|}\n$$\nwhere the $\\text{CFL}$ number is a user-specified parameter, required to be less than or equal to $1$ for this explicit scheme.\n\n**5. Error Analysis and Convergence Rate Estimation**\n\nThe accuracy of the numerical solution $U_i(T)$ is quantified by measuring the discrete $L_1$ and $L_2$ error norms against the exact solution $U_i^{\\text{exact}}(T) = u(x_i, T)$ evaluated at cell centers $x_i = (i+0.5)\\Delta x$.\n$$\nE_{1}(N) = \\Delta x \\sum_{i=0}^{N-1} \\left| U_i(T) - U_i^{\\text{exact}}(T) \\right|, \\quad E_{2}(N) = \\left(\\Delta x \\sum_{i=0}^{N-1} \\left( U_i(T) - U_i^{\\text{exact}}(T) \\right)^2 \\right)^{1/2}\n$$\nThe order of convergence, $p$, is defined by the relation $E \\propto (\\Delta x)^p$. Taking the logarithm gives $\\log(E) \\approx p \\log(\\Delta x) + \\text{const}$. Thus, $p$ is the slope of a log-log plot of error versus mesh size. The problem provides a specific definition for the convergence rate: the negative of the slope of a linear fit to $\\log(E)$ versus $\\log(\\Delta x)$. This convention will be strictly followed. A linear regression is performed on the data points $(\\log(\\Delta x_k), \\log(E_k))$ for a sequence of mesh refinements $N_k$, where $\\Delta x_k = L/N_k$. If $m$ is the computed slope, the rate is reported as $p = -m$. For a second-order scheme on a smooth solution, the slope $m$ is expected to be approximately 2, which would result in a reported rate of approximately -2.",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    \n    test_cases = [\n        {\"limiter\": \"minmod\", \"cfl\": 0.5, \"sigma\": 0.05, \"x0\": 0.25, \"N_list\": [50, 100, 200, 400]},\n        {\"limiter\": \"van_leer\", \"cfl\": 0.8, \"sigma\": 0.08, \"x0\": 0.25, \"N_list\": [50, 100, 200, 400]},\n        {\"limiter\": \"mc\", \"cfl\": 0.4, \"sigma\": 0.03, \"x0\": 0.25, \"N_list\": [50, 100, 200, 400]},\n    ]\n    \n    all_results = []\n    \n    for case in test_cases:\n        rates = compute_convergence_rates(case)\n        all_results.append(rates)\n\n    # Format the final output string exactly as required.\n    result_strings = [f\"[{r[0]},{r[1]}]\" for r in all_results]\n    print(f\"[{','.join(result_strings)}]\")\n\ndef compute_convergence_rates(params):\n    \"\"\"\n    Computes convergence rates for a given set of parameters over a list of mesh sizes.\n    \"\"\"\n    L = 1.0\n    errors_l1 = []\n    errors_l2 = []\n    dx_values = []\n\n    for N in params[\"N_list\"]:\n        dx = L / N\n        U_final = run_simulation(\n            N=N,\n            limiter_type=params[\"limiter\"],\n            cfl=params[\"cfl\"],\n            sigma=params[\"sigma\"],\n            x0=params[\"x0\"]\n        )\n        \n        # Cell centers\n        x = np.linspace(0.5 * dx, L - 0.5 * dx, N)\n        \n        # Exact solution at final time T=L (is the same as initial condition)\n        U_exact = np.exp(-((x - params[\"x0\"])**2) / (2 * params[\"sigma\"]**2))\n        \n        # Compute error norms\n        error_l1 = dx * np.sum(np.abs(U_final - U_exact))\n        error_l2 = np.sqrt(dx * np.sum((U_final - U_exact)**2))\n        \n        errors_l1.append(error_l1)\n        errors_l2.append(error_l2)\n        dx_values.append(dx)\n\n    # Convert to log scale for linear regression\n    log_dx = np.log(dx_values)\n    log_e1 = np.log(errors_l1)\n    log_e2 = np.log(errors_l2)\n    \n    # Fit line and get slope. Scipy's linregress is robust.\n    # The problem defines the rate as the negative of the slope of log(E) vs log(dx).\n    slope1 = linregress(log_dx, log_e1).slope\n    slope2 = linregress(log_dx, log_e2).slope\n    \n    p1 = slope1\n    p2 = slope2\n    \n    return [p1, p2]\n\ndef run_simulation(N, limiter_type, cfl, sigma, x0):\n    \"\"\"\n    Runs a single finite volume simulation.\n    \"\"\"\n    L = 1.0\n    a = 1.0\n    T = 1.0\n    \n    dx = L / N\n    dt = cfl * dx / np.abs(a)\n    num_steps = int(np.ceil(T / dt))\n    dt = T / num_steps  # Adjust dt to hit T exactly\n\n    # Initial condition at cell centers\n    x = np.linspace(0.5 * dx, L - 0.5 * dx, N)\n    U = np.exp(-((x - x0)**2) / (2 * sigma**2))\n\n    limiters = {\n        \"minmod\": minmod_limiter,\n        \"van_leer\": van_leer_limiter,\n        \"mc\": mc_limiter\n    }\n    limiter = limiters[limiter_type]\n\n    # Time integration loop (SSP-RK2)\n    for _ in range(num_steps):\n        # Stage 1\n        rhs1 = get_rhs(U, a, dx, limiter)\n        U1 = U + dt * rhs1\n        \n        # Stage 2\n        rhs2 = get_rhs(U1, a, dx, limiter)\n        U = 0.5 * U + 0.5 * (U1 + dt * rhs2)\n        \n    return U\n\ndef get_rhs(U, a, dx, limiter):\n    \"\"\"\n    Calculates the right-hand side of the semi-discrete equation dU/dt = L(U).\n    \"\"\"\n    N = len(U)\n    \n    # Apply periodic boundary conditions using np.roll for vectorization\n    U_m = np.roll(U, 1)  # U_{i-1}\n    U_p = np.roll(U, -1) # U_{i+1}\n    \n    # Compute forward and backward differences for slope calculation\n    delta_m = U - U_m\n    delta_p = U_p - U\n    \n    # Compute limited slopes for all cells\n    s = limiter(delta_m, delta_p)\n    \n    # Slopes from the cell to the left\n    s_m = np.roll(s, 1) # s_{i-1}\n    \n    # Reconstruct values at interfaces (since a0, we need the left state)\n    # Value at right-side interface of cell i: U_{i+1/2}^L\n    U_L_iphalf = U + s / 2.0\n    \n    # Fluxes at the right interface of each cell\n    F_iphalf = a * U_L_iphalf\n    \n    # Fluxes at the left interface of each cell, which is the right flux of the cell to the left\n    F_imhalf = np.roll(F_iphalf, 1)\n\n    # RHS of the semi-discrete FVM update\n    rhs = -(F_iphalf - F_imhalf) / dx\n    return rhs\n\n# --- TVD Limiter Functions ---\ndef minmod_limiter(a, b):\n    # sgn(a) and sgn(b) are +1, -1, or 0\n    # The term (np.sign(a) + np.sign(b)) / 2 is 1 if both 0, -1 if both 0, 0 otherwise\n    return (np.sign(a) + np.sign(b)) / 2.0 * np.minimum(np.abs(a), np.abs(b))\n\ndef van_leer_limiter(a, b):\n    # This limiter is harmonic mean of the slopes\n    num = 2 * a * b\n    den = a + b\n    # Create result array, default to 0\n    result = np.zeros_like(a)\n    # Mask where denominator is non-zero and signs are the same (a*b  0)\n    # Add a small epsilon to denominator to prevent division by zero in edge cases\n    mask = (a * b  0)\n    result[mask] = num[mask] / (den[mask] + 1e-12)\n    return result\n\ndef mc_limiter(a, b):\n    # Monotonized Central limiter\n    # s = minmod(2a, 2b, (a+b)/2)\n    # Implemented by chaining the two-argument minmod\n    c = (a + b) / 2.0\n    return minmod_limiter(minmod_limiter(2 * a, 2 * b), c)\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}