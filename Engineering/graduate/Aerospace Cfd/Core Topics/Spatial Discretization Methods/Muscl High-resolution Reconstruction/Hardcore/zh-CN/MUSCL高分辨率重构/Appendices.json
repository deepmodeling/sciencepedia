{
    "hands_on_practices": [
        {
            "introduction": "一个设计良好的高分辨率格式应在解的光滑区域达到高阶精度，同时在间断附近抑制振荡。本练习通过一个理想化的场景——常数梯度场，来探究MUSCL重构的核心特性。通过计算并比较不同斜率极限器在这种条件下的表现，你将亲手验证所有满足二阶精度要求的TVD极限器是如何在该场景下恢复到数值耗散为零的高精度状态的。",
            "id": "3978800",
            "problem": "考虑一维标量守恒律 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a > 0$ 为常数，定义在间距为 $\\Delta x$ 的均匀单元中心网格 $\\{x_{i}\\}$ 上。在有限体积离散中，使用守恒律的单调上游中心格式 (Monotone Upstream-centered Schemes for Conservation Laws, MUSCL) 高分辨率重构来形成分段线性状态。设在界面 $x_{i+\\frac{1}{2}}$ 处的左右重构状态为\n$$U_{i+\\frac{1}{2}}^{L} = U_{i} + \\frac{1}{2}\\,s_{i}, \\quad U_{i+\\frac{1}{2}}^{R} = U_{i+1} - \\frac{1}{2}\\,s_{i+1},$$\n其中受限斜率 $s_{i}$ 由 $s_{i} = \\phi(r_{i})\\,(U_{i+1} - U_{i})$ 给出，其中全变差递减 (Total Variation Diminishing, TVD) 限制器参数为 $r_{i} = \\dfrac{U_{i} - U_{i-1}}{U_{i+1} - U_{i}}$，限制器函数 $\\phi(r)$ 从以下经过良好测试的TVD限制器中选择：\n- Minmod: $\\phi_{\\mathrm{MM}}(r) = \\max\\!\\big(0, \\min(1, r)\\big)$,\n- Van Leer: $\\phi_{\\mathrm{VL}}(r) = \\dfrac{r + |r|}{1 + |r|}$,\n- Monotonized Central (MC): $\\phi_{\\mathrm{MC}}(r) = \\max\\!\\Big(0, \\min\\!\\big(2r, \\dfrac{1 + r}{2}, 2\\big)\\Big)$,\n- Superbee: $\\phi_{\\mathrm{SB}}(r) = \\max\\!\\big(0, \\min(2r, 1), \\min(r, 2)\\big)$,\n- Van Albada: $\\phi_{\\mathrm{VA}}(r) = \\dfrac{r^{2} + r}{1 + r^{2}}$。\n\n数值通量采用局部Lax–Friedrichs（也称为Rusanov）通量，\n$$F_{i+\\frac{1}{2}} = \\frac{a}{2}\\,\\Big(U_{i+\\frac{1}{2}}^{L} + U_{i+\\frac{1}{2}}^{R}\\Big) - \\frac{|a|}{2}\\,\\Big(U_{i+\\frac{1}{2}}^{R} - U_{i+\\frac{1}{2}}^{L}\\Big)。$$\n将在界面 $x_{i+\\frac{1}{2}}$ 处的耗散贡献定义为\n$$D_{i+\\frac{1}{2}} = \\frac{|a|}{2}\\,\\big|U_{i+\\frac{1}{2}}^{R} - U_{i+\\frac{1}{2}}^{L}\\big|。$$\n\n假设一个离散剖面具有恒定的向前和向后差分，使得 $U_{i+1} - U_{i} = U_{i} - U_{i-1} \\neq 0$，因此 $r_{i} = 1$ 且 $r_{i+1} = 1$。对于上面列出的每个限制器，在 $r=1$ 的条件下，比较重构的界面状态 $U_{i+\\frac{1}{2}}^{L}$ 和 $U_{i+\\frac{1}{2}}^{R}$，并计算得到的 $D_{i+\\frac{1}{2}}$。\n\n最终答案以单个实数表示。无需四舍五入，最终答案不包含任何物理单位。",
            "solution": "该问题要求计算一维标量平流方程的局部Lax-Friedrichs数值通量的耗散贡献 $D_{i+\\frac{1}{2}}$。此计算需在特定的条件下进行：数据剖面为分段线性且具有恒定梯度，并使用MUSCL高分辨率重构方法和几种常见的TVD通量限制器。\n\n问题将界面 $x_{i+\\frac{1}{2}}$ 处的左右重构状态定义为：\n$$U_{i+\\frac{1}{2}}^{L} = U_{i} + \\frac{1}{2}\\,s_{i}$$\n$$U_{i+\\frac{1}{2}}^{R} = U_{i+1} - \\frac{1}{2}\\,s_{i+1}$$\n受限斜率 $s_i$ 由 $s_{i} = \\phi(r_{i})\\,(U_{i+1} - U_{i})$ 给出，其中 $\\phi(r)$ 是一个限制器函数，$r_i$ 是连续梯度的比率：\n$$r_{i} = \\frac{U_{i} - U_{i-1}}{U_{i+1} - U_{i}}$$\n通量的耗散贡献定义为：\n$$D_{i+\\frac{1}{2}} = \\frac{|a|}{2}\\,\\big|U_{i+\\frac{1}{2}}^{R} - U_{i+\\frac{1}{2}}^{L}\\big|$$\n其中 $a>0$ 是恒定的平流速度，所以 $|a|=a$。\n\n提供的关键条件是离散剖面具有恒定的向前和向后差分，使得 $U_{i+1} - U_{i} = U_{i} - U_{i-1} \\neq 0$。这直接意味着限制器参数 $r_{i}$ 为：\n$$r_{i} = \\frac{U_{i} - U_{i-1}}{U_{i+1} - U_{i}} = 1$$\n问题还指出 $r_{i+1} = 1$。这与具有全局恒定梯度的剖面是一致的，因为 $r_{i+1} = \\frac{U_{i+1} - U_{i}}{U_{i+2} - U_{i+1}} = 1$ 意味着 $U_{i+2} - U_{i+1} = U_{i+1} - U_{i}$。\n\n我们的第一步是在 $r=1$ 处计算每个指定的限制器函数 $\\phi(r)$ 的值。这是格式在解的光滑区域达到二阶精度的必要条件。\n\n1.  **Minmod 限制器：**\n    $$\\phi_{\\mathrm{MM}}(r) = \\max\\!\\big(0, \\min(1, r)\\big)$$\n    对于 $r=1$：\n    $$\\phi_{\\mathrm{MM}}(1) = \\max\\!\\big(0, \\min(1, 1)\\big) = \\max(0, 1) = 1$$\n\n2.  **Van Leer 限制器：**\n    $$\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}$$\n    对于 $r=1$：\n    $$\\phi_{\\mathrm{VL}}(1) = \\frac{1 + |1|}{1 + |1|} = \\frac{1 + 1}{1 + 1} = \\frac{2}{2} = 1$$\n\n3.  **Monotonized Central (MC) 限制器：**\n    $$\\phi_{\\mathrm{MC}}(r) = \\max\\!\\Big(0, \\min\\!\\big(2r, \\frac{1 + r}{2}, 2\\big)\\Big)$$\n    对于 $r=1$：\n    $$\\phi_{\\mathrm{MC}}(1) = \\max\\!\\Big(0, \\min\\!\\big(2(1), \\frac{1 + 1}{2}, 2\\big)\\Big) = \\max\\!\\big(0, \\min(2, 1, 2)\\big) = \\max(0, 1) = 1$$\n\n4.  **Superbee 限制器：**\n    $$\\phi_{\\mathrm{SB}}(r) = \\max\\!\\big(0, \\min(2r, 1), \\min(r, 2)\\big)$$\n    对于 $r=1$：\n    $$\\phi_{\\mathrm{SB}}(1) = \\max\\!\\big(0, \\min(2(1), 1), \\min(1, 2)\\big) = \\max\\!\\big(0, \\min(2, 1), \\min(1, 2)\\big) = \\max(0, 1, 1) = 1$$\n\n5.  **Van Albada 限制器：**\n    $$\\phi_{\\mathrm{VA}}(r) = \\frac{r^{2} + r}{1 + r^{2}}$$\n    对于 $r=1$：\n    $$\\phi_{\\mathrm{VA}}(1) = \\frac{1^{2} + 1}{1 + 1^{2}} = \\frac{1+1}{1+1} = \\frac{2}{2} = 1$$\n\n对于所有五个指定的限制器，我们发现 $\\phi(1) = 1$。这意味着无论选择哪一个限制器，结果都将是相同的。\n\n现在，我们计算受限斜率 $s_{i}$ 和 $s_{i+1}$。\n对于斜率 $s_{i}$：\n$$s_{i} = \\phi(r_{i})\\,(U_{i+1} - U_{i}) = \\phi(1)\\,(U_{i+1} - U_{i}) = 1 \\cdot (U_{i+1} - U_{i}) = U_{i+1} - U_{i}$$\n对于斜率 $s_{i+1}$，我们使用条件 $r_{i+1}=1$，这意味着 $U_{i+2}-U_{i+1} = U_{i+1}-U_i$。\n$$s_{i+1} = \\phi(r_{i+1})\\,(U_{i+2} - U_{i+1}) = \\phi(1)\\,(U_{i+1} - U_{i}) = 1 \\cdot (U_{i+1} - U_{i}) = U_{i+1} - U_{i}$$\n两个斜率是相同的，等于无限制的中心差分梯度。\n\n接下来，我们将这些斜率代入重构界面状态 $U_{i+\\frac{1}{2}}^{L}$ 和 $U_{i+\\frac{1}{2}}^{R}$ 的表达式中。\n对于左侧状态：\n$$U_{i+\\frac{1}{2}}^{L} = U_{i} + \\frac{1}{2}\\,s_{i} = U_{i} + \\frac{1}{2}\\,(U_{i+1} - U_{i}) = U_{i} - \\frac{1}{2}\\,U_{i} + \\frac{1}{2}\\,U_{i+1} = \\frac{1}{2}\\,(U_{i} + U_{i+1})$$\n对于右侧状态：\n$$U_{i+\\frac{1}{2}}^{R} = U_{i+1} - \\frac{1}{2}\\,s_{i+1} = U_{i+1} - \\frac{1}{2}\\,(U_{i+1} - U_{i}) = U_{i+1} - \\frac{1}{2}\\,U_{i+1} + \\frac{1}{2}\\,U_{i} = \\frac{1}{2}\\,(U_{i+1} + U_{i})$$\n\n比较这两个重构状态，我们发现：\n$$U_{i+\\frac{1}{2}}^{L} = U_{i+\\frac{1}{2}}^{R} = \\frac{1}{2}\\,(U_{i} + U_{i+1})$$\n界面处的重构值是相同的。这表明解的分段线性表示在单元界面 $x_{i+\\frac{1}{2}}$ 处是连续的。这是二阶精度重构格式在光滑、单调数据区域的预期行为。\n\n最后，我们使用其定义计算耗散贡献 $D_{i+\\frac{1}{2}}$：\n$$D_{i+\\frac{1}{2}} = \\frac{|a|}{2}\\,\\big|U_{i+\\frac{1}{2}}^{R} - U_{i+\\frac{1}{2}}^{L}\\big|$$\n代入导出的状态：\n$$D_{i+\\frac{1}{2}} = \\frac{|a|}{2}\\,\\left|\\frac{1}{2}\\,(U_{i} + U_{i+1}) - \\frac{1}{2}\\,(U_{i} + U_{i+1})\\right| = \\frac{|a|}{2}\\,|0| = 0$$\n在给定条件下，对于所有指定的限制器，界面处的耗散贡献恰好为零。这是因为在恒定梯度区域，为达到二阶精度而设计的TVD格式会退化为一种无耗散（或最小耗散）的中心格式。对于Rusanov通量，当界面处重构状态的跳跃为零时，耗散项消失。\n\n最终答案是 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在掌握了MUSCL格式在光滑区的表现后，我们转向更具挑战性的情况：间断。斜率极限器的选择对格式如何捕捉激波和接触间断的“特性”有决定性影响。本练习将引导你分析极限器函数$\\phi(r)$在斜率比$r \\to \\infty$时的渐近行为，从而理解极限器的压缩性（compressive）或耗散性（diffusive）是如何影响间断清晰度并防止数值过冲的。",
            "id": "3978837",
            "problem": "考虑常速度 $a>0$ 的线性标量平流方程 $\\partial_t u + a \\,\\partial_x u = 0$，该方程在间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上进行离散。使用高分辨率的守恒律单调上游中心格式 (MUSCL) 重构来获得用于单调迎风数值通量的左偏界面状态。将单元 $i$ 处的局部光滑度比定义为 $r_i = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$，其中 $\\Delta^- u_i = u_i - u_{i-1}$ 且 $\\Delta^+ u_i = u_{i+1} - u_i$。进入 $x_{i+1/2}$ 处通量的界面状态被重构为 $u_{i+1/2}^- = u_i + \\dfrac{1}{2} \\,\\phi(r_i)\\,\\Delta^+ u_i$，其中 $\\phi(r)$ 是一个受总变差递减 (TVD) 要求约束的斜率限制器函数。\n\n假设一个类接触间断构型，其中 $u_{i+1}-u_i \\to 0^+$ 而 $u_i - u_{i-1} > 0$ 保持有限，因此 $r_i \\to +\\infty$。在数值通量为单调迎风且 Courant–Friedrichs–Lewy (CFL) 数 $\\lambda = a\\,\\Delta t/\\Delta x$ 满足 $0 < \\lambda < 1$ 的条件下，分析当 $r \\to \\infty$ 时 $\\phi(r)$ 的渐近行为及其对接触间断锐化和可能出现的伪过冲的影响。\n\n下列哪个陈述是正确的？\n\nA. 如果 $\\lim_{r\\to\\infty} \\phi(r) = 2$，则限制器在 TVD 上界处具有最大压缩性。在标量平流、单调通量且 $0 < \\lambda < 1$ 的设置下，这会锐化接触间断而不会产生过冲。\n\nB. 如果 $\\lim_{r\\to\\infty} \\phi(r) = 1$，则在接触间断处，重构的左状态满足 $u_{i+1/2}^- - u_i \\approx \\dfrac{1}{2}\\,\\Delta^+ u_i$，这比 $\\phi(\\infty)=2$ 的情况压缩性更小。在相同的标量 TVD 条件下，仍然不会出现过冲。\n\nC. 如果 $\\lim_{r\\to\\infty} \\phi(r) = 0$，则在接触间断处的重构变为分段常数 ($u_{i+1/2}^- \\approx u_i$)，局部退化为一阶迎风格式。这消除了接触间断锐化，并且对于具有单调通量的标量平流，可以避免过冲。\n\nD. 如果 $\\lim_{r\\to\\infty} \\phi(r) > 2$，则限制器超出了 TVD 容许区域（例如 Sweby 界），因此即使对于具有单调通量且 $0 < \\lambda < 1$ 的标量平流，也可能出现伪过冲或振荡。\n\nE. 如果 $\\lim_{r\\to\\infty} \\phi(r) = 1$，MUSCL 重构在接触间断处变为中心差分，这会增加出现过冲的可能性，尽管通量是单调的。\n\nF. 如果 $\\lim_{r\\to\\infty} \\phi(r) = 2$，则该格式在接触间断处达到二阶精度，而与解的正则性无关，因此在那里不产生数值耗散。",
            "solution": "用户需要对问题陈述进行严格验证，然后是详细的解答和对所提供选项的评估。\n\n### 第1步：提取已知条件\n- **控制方程**：线性标量平流方程 $\\partial_t u + a \\,\\partial_x u = 0$，具有恒定平流速度 $a > 0$。\n- **离散化**：均匀网格，单元间距为 $\\Delta x$，时间步长为 $\\Delta t$。\n- **数值格式**：采用高分辨率 MUSCL (守恒律单调上游中心格式) 重构的有限体积法。\n- **数值通量**：使用单调迎风数值通量。给定 $a > 0$，界面 $x_{i+1/2}$ 处的通量取决于左重构状态 $u_{i+1/2}^-$。\n- **定义**：\n    - 单元索引：$i$。\n    - 向前差分：$\\Delta^+ u_i = u_{i+1} - u_i$。\n    - 向后差分：$\\Delta^- u_i = u_i - u_{i-1}$。\n    - 光滑度比：$r_i = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$。\n- **重构公式**：左偏界面状态由 $u_{i+1/2}^- = u_i + \\dfrac{1}{2} \\,\\phi(r_i)\\,\\Delta^+ u_i$ 给出。\n- **限制器函数**：$\\phi(r)$ 是一个斜率限制器函数。\n- **约束条件**：格式必须是总变差递减 (TVD) 的。\n- **CFL 条件**：Courant–Friedrichs–Lewy 数 $\\lambda = a\\,\\Delta t/\\Delta x$ 满足 $0  < \\lambda  < 1$。\n- **情景**：假设一个“类接触间断”构型，其中 $u_{i+1}-u_i \\to 0^+$ 且 $u_i - u_{i-1} > 0$ (有限)。这意味着 $r_i \\to +\\infty$。\n- **问题**：分析当 $r \\to \\infty$ 时 $\\phi(r)$ 的渐近行为及其对接触间断锐化和可能出现的伪过冲的影响。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学或事实不健全**：问题陈述在科学上是健全的。它描述了在计算流体力学中分析二阶 TVD 格式的标准设置。所有定义，包括 MUSCL 重构公式、光滑度比 $r_i$ 和控制方程，都是该领域的标准定义。\n2.  **不可形式化或不相关**：该问题在数学上定义良好，并且与高分辨率格式的主题直接相关。\n3.  **不完整或矛盾的设置**：该问题是自洽的。它提供了控制方程、数值格式的结构、具体的重构公式、通量的性质以及 CFL 条件。这些足以进行所需的分析。\n4.  **不切实际或不可行**：一个“类接触间断”构型 ($r_i \\to \\infty$) 的情景是测试数值格式在局部极值或梯度剧变处行为的标准且具有物理意义的情况。\n5.  **不适定或结构不良**：该问题是适定的。基于 TVD 理论对限制器行为的分析，可以为每种情况得出唯一且有意义的结论。\n6.  **伪深刻、琐碎或同义反复**：该问题需要对 TVD 理论和数值格式特性，特别是斜率限制器的作用，有扎实的理解。这是一个非凡的问题。\n7.  **超出科学可验证性**：这些主张可以使用守恒律数值分析的数学理论进行严格验证。\n\n### 第3步：结论与行动\n问题陈述是**有效的**。可以继续进行分析。\n\n### 解答推导\n\n该问题涉及用于线性平流方程的 MUSCL 型有限体积格式。单元平均值 $u_i$ 的更新公式为：\n$$ u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right) $$\n对于 $a > 0$ 的线性平流和迎风通量，数值通量为 $F_{i+1/2} = a \\, u_{i+1/2}^-$。格式变为：\n$$ u_i^{n+1} = u_i^n - \\lambda \\left( u_{i+1/2}^- - u_{i-1/2}^- \\right) $$\n其中 $\\lambda = a \\Delta t / \\Delta x$ 是 CFL 数，重构状态为 $u_{i+1/2}^- = u_i + \\frac{1}{2} \\phi(r_i) \\Delta^+ u_i$。\n\n高分辨率格式的一个关键要求是它们不应引入伪振荡。对于标量守恒律，如果格式是总变差递减 (TVD) 的，这一点可以得到保证。对于给定的格式结构（迎风通量，使用指定公式的 MUSCL 重构），在 $0  < \\lambda  < 1$ 时成为 TVD 格式的条件对限制器函数 $\\phi(r)$ 施加了界限。这些界限在著名的 Sweby 图中可视化，即：\n$$ 0 \\le \\phi(r) \\le 2 \\quad \\text{且} \\quad 0 \\le \\frac{\\phi(r)}{r} \\le 2, \\quad \\text{对于 } r > 0 $$\n结合这些条件，对于 $r>0$，得到条件 $0 \\le \\phi(r) \\le \\min(2, 2r)$。\n\n该问题要求分析在“类接触间断”构型中（其中 $r_i = \\frac{\\Delta^- u_i}{\\Delta^+ u_i} \\to +\\infty$）的行为。在此极限下，TVD 条件 $\\phi(r) \\le \\min(2, 2r)$ 简化为 $\\lim_{r\\to\\infty} \\phi(r) \\le 2$。因此，为了使格式在此极限下是 TVD 的，限制器函数必须满足：\n$$ 0 \\le \\lim_{r\\to\\infty} \\phi(r) \\le 2 $$\n任何超出此范围的 $\\lim_{r\\to\\infty} \\phi(r)$ 值都将违反 TVD 属性，并可能导致过冲。\n\n$\\phi(r)$ 的值也决定了格式的特性。$\\phi(r)=0$ 恢复为一阶迎风格式，该格式具有很高的耗散性。$\\phi(r)$ 的正值引入了一个“反耗散”通量项，该项抵消了数值耗散，从而产生了一种更高阶、更具压缩性的格式，能更好地解析尖锐特征。在 TVD 限制内，较大的 $\\phi(r)$ 值意味着格式更具压缩性（耗散性更小）。\n\n### 逐项分析\n\n**A. 如果 $\\lim_{r\\to\\infty} \\phi(r) = 2$，则限制器在 TVD 上界处具有最大压缩性。在标量平流、单调通量且 $0 < \\lambda < 1$ 的设置下，这会锐化接触间断而不会产生过冲。**\n\n值 $\\phi(\\infty) = 2$ 位于 TVD 区域 $[0, 2]$ 的上边界。这代表了在形式上保持 TVD 的同时所允许的最激进的反耗散修正。此类限制器被称为“压缩性”限制器，因为它们会主动锐化剖面。在接触间断处，这表现为更清晰、更少模糊的表示。由于格式保持 TVD（尽管在边界上），保证不会产生新的局部极值，这意味着对于标量线性平流不会产生过冲。这一陈述准确描述了像 Superbee 或 van Leer 这样的限制器在这种渐近状态下的行为。\n**结论：正确**\n\n**B. 如果 $\\lim_{r\\to\\infty} \\phi(r) = 1$，则在接触间断处，重构的左状态满足 $u_{i+1/2}^- - u_i \\approx \\dfrac{1}{2}\\,\\Delta^+ u_i$，这比 $\\phi(\\infty)=2$ 的情况压缩性更小。在相同的标量 TVD 条件下，仍然不会出现过冲。**\n\n如果 $\\lim_{r\\to\\infty} \\phi(r) = 1$，则重构为 $u_{i+1/2}^- \\approx u_i + \\frac{1}{2}(1)\\Delta^+ u_i$。增加的修正项为 $\\frac{1}{2}\\Delta^+ u_i$。对于 $\\phi(\\infty)=2$ 的情况，修正项为 $\\frac{1}{2}(2)\\Delta^+ u_i = \\Delta^+ u_i$。由于修正项较小，该格式比最大压缩性情况的压缩性要小（即耗散性更大）。值 $\\phi(\\infty) = 1$ 远在 TVD 区域 $[0, 2]$ 内，因此该格式是 TVD 的，不会产生过冲。\n**结论：正确**\n\n**C. 如果 $\\lim_{r\\to\\infty} \\phi(r) = 0$，则在接触间断处的重构变为分段常数 ($u_{i+1/2}^- \\approx u_i$)，局部退化为一阶迎风格式。这消除了接触间断锐化，并且对于具有单调通量的标量平流，可以避免过冲。**\n\n如果 $\\lim_{r\\to\\infty} \\phi(r) = 0$，重构公式给出 $u_{i+1/2}^- \\approx u_i + \\frac{1}{2}(0)\\Delta^+ u_i = u_i$。这意味着界面处的值就是上游单元的平均值，这是分段常数数据重构的定义。这将格式简化为一阶迎风法。该方法是这类格式中耗散性最强的，会抹平间断而不是锐化它们（“消除了接触间断锐化”）。一阶迎风格式在 $\\lambda \\le 1$ 时是单调的，因此是 TVD 的，不会产生过冲。\n**结论：正确**\n\n**D. 如果 $\\lim_{r\\to\\infty} \\phi(r) > 2$，则限制器超出了 TVD 容许区域（例如 Sweby 界），因此即使对于具有单调通量且 $0 < \\lambda < 1$ 的标量平流，也可能出现伪过冲或振荡。**\n\n如前所述，当 $r \\to \\infty$ 时，TVD 区域为 $0 \\le \\phi(\\infty) \\le 2$。如果 $\\lim_{r\\to\\infty} \\phi(r) > 2$，限制器函数将超出此区域。不满足 TVD 条件的格式不能保证防止总变差的增长，这可能表现为新极值的产生，即伪过冲和下冲，尤其是在间断附近。这个陈述是 TVD 理论的一个基本结论。\n**结论：正确**\n\n**E. 如果 $\\lim_{r\\to\\infty} \\phi(r) = 1$，MUSCL 重构在接触间断处变为中心差分，这会增加出现过冲的可能性，尽管通量是单调的。**\n\n使用 $\\phi(\\infty)=1$ 的重构得到 $u_{i+1/2}^- \\approx u_i + \\frac{1}{2}\\Delta^+ u_i$。这对应于完全迎风的斜率。基于单元 $i$ 的中心差分斜率 $\\frac{u_{i+1}-u_{i-1}}{2\\Delta x}$ 的重构将得到 $u_{i+1/2}^- = u_i + \\frac{1}{2} \\frac{u_{i+1}-u_{i-1}}{2} = u_i + \\frac{1}{4}(\\Delta^+ u_i + \\Delta^- u_i)$。在我们的框架中，这要求 $\\phi(r_i)\\Delta^+ u_i = \\frac{1}{2}(\\Delta^+ u_i + \\Delta^- u_i)$，因此 $\\phi(r_i) = \\frac{1}{2}(1 + r_i)$。因此，中心差分对应于 $\\phi(r_i)$ 线性增长，而不是 $\\phi(\\infty) = 1$。此外，声称它“增加了出现过冲的可能性”是错误的，因为 $\\phi(\\infty)=1$ 在 TVD 区域内，而这类格式正是为了防止过冲而设计的。\n**结论：错误**\n\n**F. 如果 $\\lim_{r\\to\\infty} \\phi(r) = 2$，则该格式在接触间断处达到二阶精度，而与解的正则性无关，因此在那里不产生数值耗散。**\n\n这个陈述有两个主要缺陷。首先，“精度阶数”的概念基于泰勒级数展开，不适用于解不光滑的间断处。限制器被设计为在极值和间断处将格式局部降至一阶，以确保稳定性和防止振荡。其次，“没有数值耗散”的说法是理想化的，通常是错误的。虽然压缩性限制器 ($\\phi(\\infty)=2$) 被设计用来强烈抵消数值耗散，但它们并不能完全消除它。零数值耗散只在非常特定的情况下才可能实现（例如，$\\lambda=1$ 的一阶迎风格式）。\n**结论：错误**",
            "answer": "$$\\boxed{ABCD}$$"
        },
        {
            "introduction": "理论分析是基石，但最终的检验标准是计算实践。本练习旨在引导你完成从理论到可运行代码的完整过程，实现一个完整的MUSCL有限体积格式来求解线性对流方程。通过执行收敛性研究——一个计算流体力学中的标准验证程序——你将能够凭经验确认你的实现达到了预期的二阶精度，从而将抽象的理论概念转化为具体的计算能力。",
            "id": "3978860",
            "problem": "考虑定义在周期性域 $x \\in [0,L]$ 上的一维线性平流方程 $u_t + a\\,u_x = 0$，所有参数均为无量纲。初始条件为一个光滑的高斯脉冲 $u(x,0) = \\exp\\!\\left(-\\dfrac{(x - x_0)^2}{2\\,\\sigma^2}\\right)$，其中 $x_0 \\in [0,L]$ 且 $\\sigma > 0$。在周期性边界条件下，经过时间 $T$ 后的精确解为 $u(x,T) = u(x - a\\,T,0)$。当 $a = 1$ 和 $T = L$ 时，解完成一个完整的周期并精确地返回到初始条件，因此 $u(x,L) = u(x,0)$。\n\n从积分守恒形式和在具有 $N$ 个宽度为 $\\Delta x = L/N$ 的单元的均匀网格上定义的有限体积法出发，使用守恒律的单调上游中心格式 (Monotonic Upstream-centered Schemes for Conservation Laws, MUSCL) 高分辨率重构，推导单元平均值 $U_i(t)$ 的二阶精度半离散更新。使用全变差递减 (Total Variation Diminishing, TVD) 限制器来确保稳定性和无振荡行为。使用二阶强稳定保持龙格-库塔 (Strong Stability Preserving Runge–Kutta, SSP RK2) 时间积分来封闭该半离散系统。每个单元交界面处的数值通量必须与 $a$ 的符号迎风一致。\n\n对于网格尺寸 $\\Delta x = L/N$，在 $t=T$ 时刻的离散 $L_1$ 误差范数 $E_{1}(N)$ 和离散 $L_2$ 误差范数 $E_{2}(N)$ 定义为\n$$\nE_{1}(N) = \\Delta x \\sum_{i=0}^{N-1} \\left| U_i(T) - U_i^{\\text{exact}}(T) \\right|,\n\\qquad\nE_{2}(N) = \\left(\\Delta x \\sum_{i=0}^{N-1} \\left( U_i(T) - U_i^{\\text{exact}}(T) \\right)^2 \\right)^{1/2},\n$$\n其中 $U_i^{\\text{exact}}(T)$ 表示根据您的离散化方法，在单元中心处采样为单元平均值或点值的精确解。通过对一系列加密网格上的 $\\log(E_{1}(N))$ 和 $\\log(E_{2}(N))$ 对 $\\log(\\Delta x)$ 的关系进行直线拟合，来估计观测到的收敛阶 $p_1$ 和 $p_2$，并将收敛阶定义为拟合斜率。验证在光滑数据上，收敛阶近似为二阶。\n\n你的任务是编写一个完整、可运行的程序，该程序：\n- 为 $x \\in [0,L]$、$L = 1$ 上的方程 $u_t + a\\,u_x = 0$ ($a = 1$) 实现一个具有周期性边界条件的均匀有限体积离散化。\n- 使用带有 TVD 限制器的 MUSCL 高分辨率分段线性重构来获得左右界面状态。限制器通过在三个经典选项中选择一个来进行参数化：minmod、van Leer 和 Monotonized Central (MC)。\n- 使用二阶 SSP RK2 将解推进到时间 $T = L$。\n- 通过与精确解（当 $T = L$ 时等于初始条件）进行比较，计算最终时刻的离散 $L_1$ 和 $L_2$ 误差范数。\n- 通过对测试套件中不同网格尺寸的 $\\log$–$\\log$ 数据进行线性回归，来估计观测到的收敛阶。\n\n全程使用无量纲单位；不需要物理单位。\n\n测试套件：\n- 案例 1：限制器 = minmod，$\\text{CFL} = 0.5$，高斯脉冲宽度 $\\sigma = 0.05$，$x_0 = 0.25$，网格尺寸 $N \\in \\{50, 100, 200, 400\\}$。\n- 案例 2：限制器 = van Leer，$\\text{CFL} = 0.8$，高斯脉冲宽度 $\\sigma = 0.08$，$x_0 = 0.25$，网格尺寸 $N \\in \\{50, 100, 200, 400\\}$。\n- 案例 3：限制器 = MC，$\\text{CFL} = 0.4$，高斯脉冲宽度 $\\sigma = 0.03$，$x_0 = 0.25$，网格尺寸 $N \\in \\{50, 100, 200, 400\\}$。\n\n你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试案例返回一个包含两个浮点数值 $[p_1, p_2]$ 的列表，分别代表观测到的 $L_1$ 和 $L_2$ 收敛阶。例如，输出必须是这种形式：$\\left[\\left[p_{1,1},p_{1,2}\\right],\\left[p_{2,1},p_{2,2}\\right],\\left[p_{3,1},p_{3,2}\\right]\\right]$。\n\n所有角度（如有）必须以弧度为单位，尽管本问题中未使用角度。不使用百分比；当需要分数时，必须表示为小数或有理数比。\n\n不允许外部输入；所有参数均按上文规定固定，程序必须运行至完成，并仅以规定的确切格式打印最终结果。",
            "solution": "用户提供了一个来自计算流体动力学领域的有效且适定的问题陈述。任务是为一维线性平流方程实现一个二阶有限体积格式，验证其收敛阶，并以一个完整、可运行的程序提供实现。以下是从第一性原理推导出的一个完整、合理的解法。\n\n控制偏微分方程是线性平流方程：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\n其中 $u(x,t)$ 是守恒量，$x \\in [0,L]$ 是空间坐标，$t$ 是时间，$a$ 是恒定波速，给定为 $a=1$。区域长度为 $L=1$，具有周期性边界条件。初始条件是高斯脉冲：\n$$\nu(x,0) = \\exp\\left(-\\frac{(x - x_0)^2}{2\\sigma^2}\\right)\n$$\n问题需求解至最终时间 $T=L=1$。给定 $a=1$ 和 $T=L$，精确解恰好传播一个周期，因此 $u(x,T) = u(x,0)$。\n\n**1. 有限体积离散化**\n\n我们从守恒律的积分形式开始，该形式是通过将偏微分方程在一个控制体积（或单元）$C_i = [x_{i-1/2}, x_{i+1/2}]$（宽度为 $\\Delta x = x_{i+1/2} - x_{i-1/2}$）上积分得到的：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial u}{\\partial t} dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial (au)}{\\partial x} dx = 0\n$$\n将单元 $i$ 中 $u$ 的单元平均值定义为 $U_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x,t) dx$，方程变为：\n$$\n\\frac{d U_i}{dt} + \\frac{1}{\\Delta x} \\left[ (au)_{i+1/2} - (au)_{i-1/2} \\right] = 0\n$$\n此处，$(au)_{i\\pm 1/2}$ 表示在单元交界面 $x_{i\\pm 1/2}$ 处的 $u$ 的通量。在数值格式中，它们被一个数值通量函数 $F(u_L, u_R)$ 所取代，该函数依赖于交界面左侧 ($u_L$) 和右侧 ($u_R$) 的重构状态。这给出了半离散有限体积公式：\n$$\n\\frac{d U_i}{dt} = -\\frac{1}{\\Delta x} (F_{i+1/2} - F_{i-1/2})\n$$\n对于通量为 $f(u) = au$ 的线性平流方程，使用迎风数值通量。由于 $a=1 > 0$，信息从左向右传播。任何交界面处的通量由其左侧的状态决定：\n$$\nF_{i+1/2} = F(U_{i+1/2}^L, U_{i+1/2}^R) = a U_{i+1/2}^L\n$$\n其中 $U_{i+1/2}^L$ 是在交界面 $x_{i+1/2}$ 左侧重构的解的值。\n\n**2. MUSCL 高分辨率重构**\n\n为达到二阶空间精度，我们使用守恒律的单调上游中心格式 (MUSCL) 方法。在每个单元 $C_i$ 内，解由一个分段线性函数近似：\n$$\nu(x) \\approx U_i + s_i \\frac{x - x_i}{\\Delta x} \\quad \\text{for } x \\in [x_{i-1/2}, x_{i+1/2}]\n$$\n其中 $x_i$ 是单元中心，$s_i$ 是一个受限斜率。然后通过在 $x = x_{i+1/2} = x_i + \\Delta x/2$ 处计算此重构的值，得到单元 $i$ 右交界面（即交界面 $x_{i+1/2}$ 的左侧）的值：\n$$\nU_{i+1/2}^L = U_i + \\frac{s_i}{2}\n$$\n单元 $i$ 的半离散更新需要通量 $F_{i+1/2}$ 和 $F_{i-1/2}$。通量 $F_{i-1/2}$ 由单元 $i-1$ 中的重构决定：\n$$\nF_{i-1/2} = a U_{i-1/2}^L = a \\left(U_{i-1} + \\frac{s_{i-1}}{2}\\right)\n$$\n因此，完整的半离散更新为：\n$$\n\\frac{d U_i}{dt} = -\\frac{a}{\\Delta x} \\left[ \\left(U_i + \\frac{s_i}{2}\\right) - \\left(U_{i-1} + \\frac{s_{i-1}}{2}\\right) \\right]\n$$\n\n**3. TVD 斜率限制器**\n\n为防止伪振荡并确保全变差递减 (TVD) 属性，斜率 $s_i$ 会受到限制。该斜率基于相邻单元平均值之间的差值计算：后向差分 $\\Delta_i^- = U_i - U_{i-1}$ 和前向差分 $\\Delta_i^+ = U_{i+1} - U_i$。受限斜率为 $s_i = \\text{limiter}(\\Delta_i^-, \\Delta_i^+)$。问题指定了三个选项：\n\n- **Minmod 限制器：** 这是耗散性最强的限制器。\n  $$\n  s_i = \\text{minmod}(\\Delta_i^-, \\Delta_i^+) = \\begin{cases} \\text{sgn}(\\Delta_i^-) \\min(|\\Delta_i^-|, |\\Delta_i^+|)  \\text{if } \\Delta_i^- \\Delta_i^+ > 0 \\\\ 0  \\text{if } \\Delta_i^- \\Delta_i^+ \\le 0 \\end{cases}\n  $$\n- **Van Leer 限制器：** 一种光滑的限制器，在精度和单调性之间提供了良好的平衡。\n  $$\n  s_i = \\begin{cases} \\frac{2 \\Delta_i^- \\Delta_i^+}{\\Delta_i^- + \\Delta_i^+}  \\text{if } \\Delta_i^- \\Delta_i^+ > 0 \\\\ 0  \\text{if } \\Delta_i^- \\Delta_i^+ \\le 0 \\end{cases}\n  $$\n- **Monotonized Central (MC) 限制器：** 这种限制器耗散性较低，旨在尽可能恢复中心差分斜率而不引入振荡。\n  $$\n  s_i = \\text{minmod}\\left(2\\Delta_i^-, 2\\Delta_i^+, \\frac{\\Delta_i^- + \\Delta_i^+}{2}\\right)\n  $$\n  其中，多参数 minmod 函数在所有参数符号相同时返回绝对值最小的参数，否则返回零。\n\n**4. 时间积分：SSP Runge-Kutta 2**\n\n半离散系统是一组形式为 $\\frac{dU}{dt} = L(U)$ 的常微分方程，其中 $L(U)$ 是空间算子（右侧项）。该系统使用二阶强稳定保持龙格-库塔 (SSP-RK2) 方法进行时间积分，该方法也称为霍恩方法。\n$$\n\\begin{aligned}\nU^{(1)} = U^n + \\Delta t \\, L(U^n) \\\\\nU^{n+1} = \\frac{1}{2} U^n + \\frac{1}{2} \\left( U^{(1)} + \\Delta t \\, L(U^{(1)}) \\right)\n\\end{aligned}\n$$\n时间步长 $\\Delta t$ 由用于稳定性的 Courant-Friedrichs-Lewy (CFL) 条件确定：\n$$\n\\Delta t = \\text{CFL} \\frac{\\Delta x}{|a|}\n$$\n其中 $\\text{CFL}$ 数是一个用户指定的参数，对于这种显式格式，要求其小于或等于 $1$。\n\n**5. 误差分析与收敛阶估计**\n\n数值解 $U_i(T)$ 的精度通过测量离散 $L_1$ 和 $L_2$ 误差范数来量化，该范数是相对于在单元中心 $x_i = (i+0.5)\\Delta x$ 处求值的精确解 $U_i^{\\text{exact}}(T)$ 计算的。\n$$\nE_{1}(N) = \\Delta x \\sum_{i=0}^{N-1} \\left| U_i(T) - U_i^{\\text{exact}}(T) \\right|, \\quad E_{2}(N) = \\left(\\Delta x \\sum_{i=0}^{N-1} \\left( U_i(T) - U_i^{\\text{exact}}(T) \\right)^2 \\right)^{1/2}\n$$\n收敛阶 $p$ 由关系式 $E \\propto (\\Delta x)^p$ 定义。取对数可得 $\\log(E) \\approx p \\log(\\Delta x) + \\text{const}$。因此，$p$ 是误差与网格尺寸的对数-对数图的斜率。问题为收敛阶提供了一个特定定义：$\\log(E)$ 对 $\\log(\\Delta x)$ 的线性拟合斜率。此约定将被严格遵守。对一系列网格加密 $N_k$（其中 $\\Delta x_k = L/N_k$）的数据点 $(\\log(\\Delta x_k), \\log(E_k))$ 执行线性回归。如果计算出的斜率为 $m$，则报告的收敛阶为 $p = m$。对于光滑解上的二阶格式，斜率 $m$ 预期约为 $2$，这将导致报告的收敛阶约为 $2$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    \n    test_cases = [\n        {\"limiter\": \"minmod\", \"cfl\": 0.5, \"sigma\": 0.05, \"x0\": 0.25, \"N_list\": [50, 100, 200, 400]},\n        {\"limiter\": \"van_leer\", \"cfl\": 0.8, \"sigma\": 0.08, \"x0\": 0.25, \"N_list\": [50, 100, 200, 400]},\n        {\"limiter\": \"mc\", \"cfl\": 0.4, \"sigma\": 0.03, \"x0\": 0.25, \"N_list\": [50, 100, 200, 400]},\n    ]\n    \n    all_results = []\n    \n    for case in test_cases:\n        rates = compute_convergence_rates(case)\n        all_results.append(rates)\n\n    # Format the final output string exactly as required.\n    result_strings = [f\"[{r[0]},{r[1]}]\" for r in all_results]\n    print(f\"[{','.join(result_strings)}]\")\n\ndef compute_convergence_rates(params):\n    \"\"\"\n    Computes convergence rates for a given set of parameters over a list of mesh sizes.\n    \"\"\"\n    L = 1.0\n    errors_l1 = []\n    errors_l2 = []\n    dx_values = []\n\n    for N in params[\"N_list\"]:\n        dx = L / N\n        U_final = run_simulation(\n            N=N,\n            limiter_type=params[\"limiter\"],\n            cfl=params[\"cfl\"],\n            sigma=params[\"sigma\"],\n            x0=params[\"x0\"]\n        )\n        \n        # Cell centers\n        x = np.linspace(0.5 * dx, L - 0.5 * dx, N)\n        \n        # Exact solution at final time T=L (is the same as initial condition)\n        U_exact = np.exp(-((x - params[\"x0\"])**2) / (2 * params[\"sigma\"]**2))\n        \n        # Compute error norms\n        error_l1 = dx * np.sum(np.abs(U_final - U_exact))\n        error_l2 = np.sqrt(dx * np.sum((U_final - U_exact)**2))\n        \n        errors_l1.append(error_l1)\n        errors_l2.append(error_l2)\n        dx_values.append(dx)\n\n    # Convert to log scale for linear regression\n    log_dx = np.log(dx_values)\n    log_e1 = np.log(errors_l1)\n    log_e2 = np.log(errors_l2)\n    \n    # Fit line and get slope. Scipy's linregress is robust.\n    # The problem defines the rate as the slope of log(E) vs log(dx).\n    slope1 = linregress(log_dx, log_e1).slope\n    slope2 = linregress(log_dx, log_e2).slope\n    \n    p1 = slope1\n    p2 = slope2\n    \n    return [p1, p2]\n\ndef run_simulation(N, limiter_type, cfl, sigma, x0):\n    \"\"\"\n    Runs a single finite volume simulation.\n    \"\"\"\n    L = 1.0\n    a = 1.0\n    T = 1.0\n    \n    dx = L / N\n    dt = cfl * dx / np.abs(a)\n    num_steps = int(np.ceil(T / dt))\n    dt = T / num_steps  # Adjust dt to hit T exactly\n\n    # Initial condition at cell centers\n    x = np.linspace(0.5 * dx, L - 0.5 * dx, N)\n    U = np.exp(-((x - x0)**2) / (2 * sigma**2))\n\n    limiters = {\n        \"minmod\": minmod_limiter,\n        \"van_leer\": van_leer_limiter,\n        \"mc\": mc_limiter\n    }\n    limiter = limiters[limiter_type]\n\n    # Time integration loop (SSP-RK2)\n    for _ in range(num_steps):\n        # Stage 1\n        rhs1 = get_rhs(U, a, dx, limiter)\n        U1 = U + dt * rhs1\n        \n        # Stage 2\n        rhs2 = get_rhs(U1, a, dx, limiter)\n        U = 0.5 * U + 0.5 * (U1 + dt * rhs2)\n        \n    return U\n\ndef get_rhs(U, a, dx, limiter):\n    \"\"\"\n    Calculates the right-hand side of the semi-discrete equation dU/dt = L(U).\n    \"\"\"\n    N = len(U)\n    \n    # Apply periodic boundary conditions using np.roll for vectorization\n    U_m = np.roll(U, 1)  # U_{i-1}\n    U_p = np.roll(U, -1) # U_{i+1}\n    \n    # Compute forward and backward differences for slope calculation\n    delta_m = U - U_m\n    delta_p = U_p - U\n    \n    # Compute limited slopes for all cells\n    s = limiter(delta_m, delta_p)\n    \n    # Slopes from the cell to the left\n    s_m = np.roll(s, 1) # s_{i-1}\n    \n    # Reconstruct values at interfaces (since a>0, we need the left state)\n    # Value at right-side interface of cell i: U_{i+1/2}^L\n    U_L_iphalf = U + s / 2.0\n    \n    # Fluxes at the right interface of each cell\n    F_iphalf = a * U_L_iphalf\n    \n    # Fluxes at the left interface of each cell, which is the right flux of the cell to the left\n    F_imhalf = np.roll(F_iphalf, 1)\n\n    # RHS of the semi-discrete FVM update\n    rhs = -(F_iphalf - F_imhalf) / dx\n    return rhs\n\n# --- TVD Limiter Functions ---\ndef minmod_limiter(a, b):\n    # sgn(a) and sgn(b) are +1, -1, or 0\n    # The term (np.sign(a) + np.sign(b)) / 2 is 1 if both >0, -1 if both 0, 0 otherwise\n    return (np.sign(a) + np.sign(b)) / 2.0 * np.minimum(np.abs(a), np.abs(b))\n\ndef van_leer_limiter(a, b):\n    # This limiter is harmonic mean of the slopes\n    num = 2 * a * b\n    den = a + b\n    # Create result array, default to 0\n    result = np.zeros_like(a)\n    # Mask where denominator is non-zero and signs are the same (a*b > 0)\n    # Add a small epsilon to denominator to prevent division by zero in edge cases\n    mask = (a * b > 0)\n    result[mask] = num[mask] / (den[mask] + 1e-12)\n    return result\n\ndef mc_limiter(a, b):\n    # Monotonized Central limiter\n    # s = minmod(2a, 2b, (a+b)/2)\n    # Implemented by chaining the two-argument minmod\n    c = (a + b) / 2.0\n    return minmod_limiter(minmod_limiter(2 * a, 2 * b), c)\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}