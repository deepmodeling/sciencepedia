{
    "hands_on_practices": [
        {
            "introduction": "在有限体积法中，为了达到二阶精度，我们不仅需要单元的平均值，还需要单元内场的梯度的近似值。本练习  将指导您使用加权最小二乘法，这是一种从相邻单元数据计算该梯度的稳健技术，尤其适用于非结构网格。掌握这种计算是构建精确、灵活的CFD求解器的关键第一步。",
            "id": "3989902",
            "problem": "在计算流体力学 (CFD) 的以单元为中心的有限体积法中，标量场的二阶界面重构依赖于围绕单元中心进行泰勒级数展开所得到的局部线性近似。考虑一个标记为单元 $i$ 的非结构化三角形控制体，其中心坐标为 $\\boldsymbol{x}_i = (0, 0)$，无量纲标量场的单元平均值为 $\\phi_i = 2$。与单元 $i$ 各个面相邻的三个单元的中心和单元平均值由下式给出：\n$$\n\\boldsymbol{x}_{j_1} = (1, 0), \\quad \\phi_{j_1} = 5, \\qquad\n\\boldsymbol{x}_{j_2} = (0, 1), \\quad \\phi_{j_2} = 1, \\qquad\n\\boldsymbol{x}_{j_3} = (-1, -1), \\quad \\phi_{j_3} = 0.\n$$\n为获得一致的线性重构，通过对一阶泰勒展开式进行加权最小二乘拟合来近似单元 $i$ 处的梯度，\n$$\n\\phi(\\boldsymbol{x}_i + \\boldsymbol{r}_j) \\approx \\phi_i + \\nabla \\phi_i \\cdot \\boldsymbol{r}_j,\n$$\n其中 $\\boldsymbol{r}_j = \\boldsymbol{x}_j - \\boldsymbol{x}_i$，权重选择为 $w_j = \\frac{1}{\\|\\boldsymbol{r}_j\\|^2}$。使用这个梯度和以下线性关系式，\n$$\n\\phi_f \\approx \\phi_i + \\nabla \\phi_i \\cdot (\\boldsymbol{x}_f - \\boldsymbol{x}_i),\n$$\n重构位于单元 $i$ 某个面上的指定界面中心 $\\boldsymbol{x}_f = (0.45, -0.1)$ 处的标量值。根据给定数据明确计算重构的界面值 $\\phi_f$。最终答案以无量纲数表示，并四舍五入到四位有效数字。",
            "solution": "用户提供了一个计算流体力学（CFD）领域中定义明确的问题，具体涉及使用加权最小二乘梯度近似来重构单元界面上的标量值。该问题具有科学依据，提法恰当，并提供了求解所需的所有数据。因此，该问题是有效的。\n\n目标是计算界面中心 $\\boldsymbol{x}_f = (0.45, -0.1)$ 处的重构标量值 $\\phi_f$。这需要两步过程：\n1.  使用加权最小二乘法计算单元 $i$ 中心处的标量场梯度 $\\nabla \\phi_i$。\n2.  在一阶泰勒级数展开式中使用此梯度，将值从单元中心 $\\boldsymbol{x}_i$ 外插到界面中心 $\\boldsymbol{x}_f$。\n\n设单元 $i$ 处的梯度向量表示为 $\\nabla \\phi_i = \\boldsymbol{g} = \\begin{pmatrix} g_x \\\\ g_y \\end{pmatrix}$。相对于单元 $i$，相邻单元中心 $\\boldsymbol{x}_j$ 处的标量值 $\\phi_j$ 的一阶泰勒展开式为\n$$\n\\phi_j \\approx \\phi_i + \\nabla \\phi_i \\cdot (\\boldsymbol{x}_j - \\boldsymbol{x}_i)\n$$\n整理上式可得标量值之差的表达式：\n$$\n\\phi_j - \\phi_i \\approx \\boldsymbol{g} \\cdot \\boldsymbol{r}_j\n$$\n其中 $\\boldsymbol{r}_j = \\boldsymbol{x}_j - \\boldsymbol{x}_i$ 是从中心 $i$ 指向中心 $j$ 的向量。\n\n加权最小二乘法旨在找到梯度 $\\boldsymbol{g}$，以最小化 $N=3$ 个相邻单元集合上加权残差的平方和。需要最小化的目标函数是：\n$$\nS(g_x, g_y) = \\sum_{j=1}^{N} w_j \\left( (\\phi_j - \\phi_i) - (g_x r_{jx} + g_y r_{jy}) \\right)^2\n$$\n其中 $w_j = \\frac{1}{\\|\\boldsymbol{r}_j\\|^2}$ 是指定的权重。\n\n为最小化 $S$，我们对 $g_x$ 和 $g_y$ 求偏导数并令其为零：\n$$\n\\frac{\\partial S}{\\partial g_x} = 0, \\quad \\frac{\\partial S}{\\partial g_y} = 0\n$$\n这导出了法向方程，可以表示为矩阵形式 $A \\boldsymbol{g} = \\boldsymbol{b}$，其中：\n$$\nA = \\begin{pmatrix} \\sum_{j=1}^N w_j r_{jx}^2  \\sum_{j=1}^N w_j r_{jx} r_{jy} \\\\ \\sum_{j=1}^N w_j r_{jx} r_{jy}  \\sum_{j=1}^N w_j r_{jy}^2 \\end{pmatrix}, \\quad \\boldsymbol{b} = \\begin{pmatrix} \\sum_{j=1}^N w_j (\\phi_j - \\phi_i) r_{jx} \\\\ \\sum_{j=1}^N w_j (\\phi_j - \\phi_i) r_{jy} \\end{pmatrix}\n$$\n\n首先，我们处理给定的数据。中心单元是 $i$，其 $\\boldsymbol{x}_i = (0, 0)$ 且 $\\phi_i = 2$。令 $\\Delta\\phi_j = \\phi_j - \\phi_i$。\n\n对于相邻单元 $j_1$：\n$\\boldsymbol{x}_{j_1} = (1, 0)$, $\\phi_{j_1} = 5$。\n$\\boldsymbol{r}_{j_1} = \\boldsymbol{x}_{j_1} - \\boldsymbol{x}_i = (1, 0)$。\n$\\Delta\\phi_{j_1} = 5 - 2 = 3$。\n$\\|\\boldsymbol{r}_{j_1}\\|^2 = 1^2 + 0^2 = 1$，所以 $w_{j_1} = \\frac{1}{1} = 1$。\n\n对于相邻单元 $j_2$：\n$\\boldsymbol{x}_{j_2} = (0, 1)$, $\\phi_{j_2} = 1$。\n$\\boldsymbol{r}_{j_2} = \\boldsymbol{x}_{j_2} - \\boldsymbol{x}_i = (0, 1)$。\n$\\Delta\\phi_{j_2} = 1 - 2 = -1$。\n$\\|\\boldsymbol{r}_{j_2}\\|^2 = 0^2 + 1^2 = 1$，所以 $w_{j_2} = \\frac{1}{1} = 1$。\n\n对于相邻单元 $j_3$：\n$\\boldsymbol{x}_{j_3} = (-1, -1)$, $\\phi_{j_3} = 0$。\n$\\boldsymbol{r}_{j_3} = \\boldsymbol{x}_{j_3} - \\boldsymbol{x}_i = (-1, -1)$。\n$\\Delta\\phi_{j_3} = 0 - 2 = -2$。\n$\\|\\boldsymbol{r}_{j_3}\\|^2 = (-1)^2 + (-1)^2 = 2$，所以 $w_{j_3} = \\frac{1}{2}$。\n\n现在，我们构建矩阵 $A$：\n$A_{11} = \\sum w_j r_{jx}^2 = (1)(1^2) + (1)(0^2) + (\\frac{1}{2})(-1)^2 = 1 + 0 + \\frac{1}{2} = \\frac{3}{2}$。\n$A_{22} = \\sum w_j r_{jy}^2 = (1)(0^2) + (1)(1^2) + (\\frac{1}{2})(-1)^2 = 0 + 1 + \\frac{1}{2} = \\frac{3}{2}$。\n$A_{12} = A_{21} = \\sum w_j r_{jx} r_{jy} = (1)(1)(0) + (1)(0)(1) + (\\frac{1}{2})(-1)(-1) = 0 + 0 + \\frac{1}{2} = \\frac{1}{2}$。\n所以，矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix} \\frac{3}{2}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{3}{2} \\end{pmatrix}\n$$\n\n接下来，我们构建向量 $\\boldsymbol{b}$：\n$b_x = \\sum w_j \\Delta\\phi_j r_{jx} = (1)(3)(1) + (1)(-1)(0) + (\\frac{1}{2})(-2)(-1) = 3 + 0 + 1 = 4$。\n$b_y = \\sum w_j \\Delta\\phi_j r_{jy} = (1)(3)(0) + (1)(-1)(1) + (\\frac{1}{2})(-2)(-1) = 0 - 1 + 1 = 0$。\n所以，向量 $\\boldsymbol{b}$ 为：\n$$\n\\boldsymbol{b} = \\begin{pmatrix} 4 \\\\ 0 \\end{pmatrix}\n$$\n\n我们求解线性系统 $A \\boldsymbol{g} = \\boldsymbol{b}$：\n$$\n\\begin{pmatrix} \\frac{3}{2}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{3}{2} \\end{pmatrix} \\begin{pmatrix} g_x \\\\ g_y \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 0 \\end{pmatrix}\n$$\n这代表以下方程组：\n1.  $\\frac{3}{2}g_x + \\frac{1}{2}g_y = 4$\n2.  $\\frac{1}{2}g_x + \\frac{3}{2}g_y = 0$\n\n从第二个方程，我们得到 $g_x = -3g_y$。将此代入第一个方程：\n$\\frac{3}{2}(-3g_y) + \\frac{1}{2}g_y = 4$\n$-\\frac{9}{2}g_y + \\frac{1}{2}g_y = 4$\n$-\\frac{8}{2}g_y = 4 \\implies -4g_y = 4 \\implies g_y = -1$。\n则 $g_x = -3(-1) = 3$。\n计算出的梯度为 $\\nabla \\phi_i = \\boldsymbol{g} = \\begin{pmatrix} 3 \\\\ -1 \\end{pmatrix}$。\n\n最后，我们使用线性重构公式在界面中心 $\\boldsymbol{x}_f = (0.45, -0.1)$ 处重构值：\n$$\n\\phi_f \\approx \\phi_i + \\nabla \\phi_i \\cdot (\\boldsymbol{x}_f - \\boldsymbol{x}_i)\n$$\n由于 $\\boldsymbol{x}_i = (0, 0)$，从单元中心指向界面中心的向量是 $\\boldsymbol{x}_f - \\boldsymbol{x}_i = (0.45, -0.1)$。\n代入已知值：\n$$\n\\phi_f \\approx 2 + \\begin{pmatrix} 3 \\\\ -1 \\end{pmatrix} \\cdot \\begin{pmatrix} 0.45 \\\\ -0.1 \\end{pmatrix}\n$$\n$$\n\\phi_f \\approx 2 + (3)(0.45) + (-1)(-0.1)\n$$\n$$\n\\phi_f \\approx 2 + 1.35 + 0.1\n$$\n$$\n\\phi_f \\approx 3.45\n$$\n问题要求答案四舍五入到四位有效数字。计算的精确结果是 $3.45$。为了用四位有效数字表示该值，我们将其写为 $3.450$。",
            "answer": "$$\\boxed{3.450}$$"
        },
        {
            "introduction": "尽管线性重构能够提升格式的精度，但在解的非光滑区域（如激波或接触间断）附近，它可能会引入非物理的虚假振荡。为了抑制这些振荡并保证数值解的稳定性，引入了斜率限制器的概念，其核心思想是调整重构梯度以满足总变差不增（TVD）等条件。本练习  将让您亲手应用一个经典的限制器来计算有界的面值，从而理解在高分辨率格式的设计中，如何权衡精度与稳定性这对核心矛盾。",
            "id": "3989867",
            "problem": "考虑计算流体动力学（CFD）中的一维线性质量密度平流，该过程由标量守恒律 $ \\partial_t \\rho + a \\, \\partial_x \\rho = 0 $ 控制，其中 $ \\rho(x,t) $ 是质量密度，$ a $ 是恒定的平流速度。在均匀网格上的守恒型有限体积格式中，将宽度为 $ \\Delta x $ 的网格单元上的单元平均密度表示为 $ \\bar{\\rho}_i $。为了获得一致的数值通量所需的高分辨率、无振荡的面值，采用带有斜率限制器的分段线性重构，该限制器可强制实现总变差减小（TVD）行为。\n\n使用单调中心（MC）限制器，这是一种通过 $\\minmod$ 函数定义的TVD限制器。对于任意网格单元索引 $ i $，受限斜率 $ \\sigma_i $ 由以下公式定义：\n$$\n\\sigma_i \\;=\\; \\minmod\\!\\Bigg( \\frac{\\bar{\\rho}_{i+1}-\\bar{\\rho}_{i-1}}{2\\,\\Delta x}, \\; \\frac{2\\,(\\bar{\\rho}_{i+1}-\\bar{\\rho}_i)}{\\Delta x}, \\; \\frac{2\\,(\\bar{\\rho}_i-\\bar{\\rho}_{i-1})}{\\Delta x} \\Bigg),\n$$\n其中，三个参数的 $\\minmod$ 函数为：\n$$\n\\minmod(\\alpha,\\beta,\\gamma) \\;=\\;\n\\begin{cases}\n\\mathrm{sign}(\\alpha)\\,\\min\\!\\big(|\\alpha|,|\\beta|,|\\gamma|\\big),  \\text{if } \\mathrm{sign}(\\alpha)=\\mathrm{sign}(\\beta)=\\mathrm{sign}(\\gamma), \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n通过分段线性重构，界面 $ x_{i+1/2} $ 处的左右状态为：\n$$\n\\rho_{i+1/2}^{-} \\;=\\; \\bar{\\rho}_i + \\sigma_i\\,\\frac{\\Delta x}{2}, \n\\qquad\n\\rho_{i+1/2}^{+} \\;=\\; \\bar{\\rho}_{i+1} - \\sigma_{i+1}\\,\\frac{\\Delta x}{2}.\n$$\n\n假设均匀网格的宽度 $ \\Delta x = 0.02~\\mathrm{m} $，恒定平流速度 $ a = 240~\\mathrm{m/s} $，以及单元平均密度（单位为 $ \\mathrm{kg/m^3} $）如下：\n$$\n\\bar{\\rho}_{i-2} = 1.24, \\quad \\bar{\\rho}_{i-1} = 1.21, \\quad \\bar{\\rho}_{i} = 1.15, \\quad \\bar{\\rho}_{i+1} = 1.10, \\quad \\bar{\\rho}_{i+2} = 1.095.\n$$\n\n从守恒律和面通量的有限体积解释出发，应用MC限制器以获得受限斜率 $ \\sigma_i $ 和 $ \\sigma_{i+1} $，重构左右界面状态 $ \\rho_{i+1/2}^{-} $ 和 $ \\rho_{i+1/2}^{+} $，然后使用用于线性平流的 Godunov 迎风通量计算 $ x_{i+1/2} $ 处的质量通量：\n$$\nF_{i+1/2} \\;=\\; a \\times \n\\begin{cases}\n\\rho_{i+1/2}^{-},  \\text{if } a > 0, \\\\\n\\rho_{i+1/2}^{+},  \\text{if } a  0.\n\\end{cases}\n$$\n\n提供 $ F_{i+1/2} $ 的最终数值，单位为 $ \\mathrm{kg\\,m^{-2}\\,s^{-1}} $。将答案保留四位有效数字。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。其科学基础是计算流体动力学的原理，特别是针对守恒律的有限体积法。该问题是适定的、客观的、自洽的，并且没有矛盾或歧义。唯一解所需的所有数据和定义均已提供。因此，我们可以着手求解。\n\n目标是计算计算单元 $i$ 和 $i+1$ 之间界面 $x_{i+1/2}$ 处的数值质量通量 $F_{i+1/2}$。这需要对密度场进行高分辨率的分段线性重构，并使用单调中心（MC）限制器来确保总变差减小（TVD）特性。然后使用 Godunov 迎风格式确定通量。\n\n步骤如下：\n1.  计算单元 $i$ 的受限斜率 $\\sigma_i$。\n2.  计算单元 $i+1$ 的受限斜率 $\\sigma_{i+1}$。\n3.  分别重构界面左右两侧的密度值 $\\rho_{i+1/2}^{-}$ 和 $\\rho_{i+1/2}^{+}$。\n4.  根据平流速度 $a$ 的符号选择迎风密度。\n5.  计算质量通量 $F_{i+1/2}$。\n\n给定的数据如下：\n-   单元平均密度：$\\bar{\\rho}_{i-2} = 1.24$, $\\bar{\\rho}_{i-1} = 1.21$, $\\bar{\\rho}_{i} = 1.15$, $\\bar{\\rho}_{i+1} = 1.10$, $\\bar{\\rho}_{i+2} = 1.095$。注意所有单位均为 $\\mathrm{kg/m^3}$。\n-   单元宽度：$\\Delta x = 0.02~\\mathrm{m}$。\n-   平流速度：$a = 240~\\mathrm{m/s}$。\n\n**步骤 1：计算受限斜率 $\\sigma_i$**\n\n受限斜率 $\\sigma_i$ 由 MC 限制器定义：\n$$\n\\sigma_i = \\minmod(\\alpha_i, \\beta_i, \\gamma_i)\n$$\n其中，参数分别是中心、向前和向后差分斜率（后两者乘以因子 $2$）：\n$$\n\\alpha_i = \\frac{\\bar{\\rho}_{i+1}-\\bar{\\rho}_{i-1}}{2\\,\\Delta x}\n$$\n$$\n\\beta_i = \\frac{2\\,(\\bar{\\rho}_{i+1}-\\bar{\\rho}_i)}{\\Delta x}\n$$\n$$\n\\gamma_i = \\frac{2\\,(\\bar{\\rho}_i-\\bar{\\rho}_{i-1})}{\\Delta x}\n$$\n我们使用给定值计算每个参数：\n-   中心斜率：\n    $$\n    \\alpha_i = \\frac{1.10 - 1.21}{2 \\times 0.02} = \\frac{-0.11}{0.04} = -2.75\n    $$\n-   前向偏置斜率：\n    $$\n    \\beta_i = \\frac{2\\,(1.10 - 1.15)}{0.02} = \\frac{2\\,(-0.05)}{0.02} = -5.0\n    $$\n-   后向偏置斜率：\n    $$\n    \\gamma_i = \\frac{2\\,(1.15 - 1.21)}{0.02} = \\frac{2\\,(-0.06)}{0.02} = -6.0\n    $$\n所有三个参数，$\\alpha_i = -2.75$，$\\beta_i = -5.0$ 和 $\\gamma_i = -6.0$，均为负。因此，它们的符号相同。$\\minmod$ 函数将返回具有最小绝对值的值，并冠以共同的符号。\n$$\n\\sigma_i = \\mathrm{sign}(-2.75) \\times \\min(|\\!-\\!2.75|, |\\!-\\!5.0|, |\\!-\\!6.0|) = -1 \\times \\min(2.75, 5.0, 6.0) = -2.75\n$$\n所以，单元 $i$ 中的受限斜率为 $\\sigma_i = -2.75~\\mathrm{kg\\,m^{-4}}$。\n\n**步骤 2：计算受限斜率 $\\sigma_{i+1}$**\n\n类似地，我们计算单元 $i+1$ 中 MC 限制器的参数：\n$$\n\\alpha_{i+1} = \\frac{\\bar{\\rho}_{i+2}-\\bar{\\rho}_{i}}{2\\,\\Delta x} = \\frac{1.095 - 1.15}{2 \\times 0.02} = \\frac{-0.055}{0.04} = -1.375\n$$\n$$\n\\beta_{i+1} = \\frac{2\\,(\\bar{\\rho}_{i+2}-\\bar{\\rho}_{i+1})}{\\Delta x} = \\frac{2\\,(1.095 - 1.10)}{0.02} = \\frac{2\\,(-0.005)}{0.02} = -0.5\n$$\n$$\n\\gamma_{i+1} = \\frac{2\\,(\\bar{\\rho}_{i+1}-\\bar{\\rho}_{i})}{\\Delta x} = \\frac{2\\,(1.10 - 1.15)}{0.02} = \\frac{2\\,(-0.05)}{0.02} = -5.0\n$$\n所有三个参数，$\\alpha_{i+1} = -1.375$，$\\beta_{i+1} = -0.5$ 和 $\\gamma_{i+1} = -5.0$，均为负。它们的符号相同。\n$$\n\\sigma_{i+1} = \\mathrm{sign}(-1.375) \\times \\min(|\\!-\\!1.375|, |\\!-\\!0.5|, |\\!-\\!5.0|) = -1 \\times \\min(1.375, 0.5, 5.0) = -0.5\n$$\n单元 $i+1$ 中的受限斜率为 $\\sigma_{i+1} = -0.5~\\mathrm{kg\\,m^{-4}}$。\n\n**步骤 3：重构界面状态**\n\n使用分段线性重构公式，我们求出界面 $x_{i+1/2}$ 左右两侧的密度值：\n-   左状态（从单元 $i$ 重构）：\n    $$\n    \\rho_{i+1/2}^{-} = \\bar{\\rho}_i + \\sigma_i\\,\\frac{\\Delta x}{2} = 1.15 + (-2.75) \\times \\frac{0.02}{2} = 1.15 - 2.75 \\times 0.01 = 1.15 - 0.0275 = 1.1225~\\mathrm{kg/m^3}\n    $$\n-   右状态（从单元 $i+1$ 重构）：\n    $$\n    \\rho_{i+1/2}^{+} = \\bar{\\rho}_{i+1} - \\sigma_{i+1}\\,\\frac{\\Delta x}{2} = 1.10 - (-0.5) \\times \\frac{0.02}{2} = 1.10 + 0.5 \\times 0.01 = 1.10 + 0.005 = 1.105~\\mathrm{kg/m^3}\n    $$\n\n**步骤 4：应用 Godunov 迎风通量**\n\n线性平流的 Godunov 通量是一种迎风通量。界面处状态的选择取决于信息传播的方向，该方向由平流速度 $a$ 的符号决定。\n通量由下式给出：\n$$\nF_{i+1/2} \\;=\\; a \\times \n\\begin{cases}\n\\rho_{i+1/2}^{-},  \\text{if } a > 0, \\\\\n\\rho_{i+1/2}^{+},  \\text{if } a  0.\n\\end{cases}\n$$\n在本问题中，平流速度 $a = 240~\\mathrm{m/s}$，为正值（$a > 0$）。因此，信息从左向右传播，通量由左状态 $\\rho_{i+1/2}^{-}$ 决定。\n$$\nF_{i+1/2} = a \\times \\rho_{i+1/2}^{-}\n$$\n\n**步骤 5：最终通量计算**\n\n代入 $a$ 和 $\\rho_{i+1/2}^{-}$ 的数值：\n$$\nF_{i+1/2} = 240~\\mathrm{m/s} \\times 1.1225~\\mathrm{kg/m^3} = 269.4~\\mathrm{kg\\,m^{-2}\\,s^{-1}}\n$$\n问题要求答案保留四位有效数字。计算出的值 $269.4$ 已经有四位有效数字。",
            "answer": "$$\\boxed{269.4}$$"
        },
        {
            "introduction": "在求解如欧拉方程组这类描述真实物理过程的方程时，我们必须确保数值解始终满足基本的物理约束，例如密度和压力必须为正。然而，即便是使用了TVD限制器的高阶格式，也可能在极端情况下产生包含负密度或负压的非物理状态，导致计算中断。本练习  介绍了一种重要的保正限制器技术，它通过巧妙地混合高阶重构值与一个保证物理上有效的低阶值，来强制修复非物理状态。通过这个练习，您将学会如何为复杂的流体动力学模拟构建一个更加稳健和可靠的数值核心。",
            "id": "3989875",
            "problem": "考虑一维可压缩理想气体欧拉方程。守恒状态向量定义为 $U = (\\rho, m, E)$，其中 $\\rho$ 是质量密度， $m = \\rho u$ 是动量密度（速度为 $u$），$E$ 是总能量密度。压力 $p$ 由理想气体状态方程 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$ 给出，其中 $\\gamma$ 是比热比。在一个采用加权基本无振荡（WENO）重构的高分辨率有限体积格式中，假设一个施主单元的单元平均守恒状态为 $U^{L} = (\\rho^{L}, m^{L}, E^{L})$，并在其右侧界面上重构出一个高阶界面状态 $U^{H} = (\\rho^{H}, m^{H}, E^{H})$。为了在界面上强制保证压力和密度的正性，一个保正限制器将这些状态进行混合：\n$$\nU^{\\text{lim}}(\\theta) = \\theta\\,U^{H} + (1 - \\theta)\\,U^{L},\n$$\n其中 $0 \\le \\theta \\le 1$。$\\theta$ 的选择应在满足约束条件 $\\rho(\\theta) \\ge \\epsilon_{\\rho}$ 和 $p(\\theta) \\ge \\epsilon_{p}$ 的前提下尽可能大。这些约束在界面上使用相同的状态方程，其中下限值 $\\epsilon_{\\rho}$ 和 $\\epsilon_{p}$ 分别代表密度和压力的最小允许值。\n\n考虑空气，其比热比 $\\gamma = 1.4$。低阶状态为 $U^{L} = (\\rho^{L}, m^{L}, E^{L})$，其中 $\\rho^{L} = 1.2$ kg/m$^{3}$，$u^{L} = 300$ m/s，$p^{L} = 101325$ Pa。相关的动量和总能量为 $m^{L} = \\rho^{L} u^{L}$ 和 $E^{L} = \\dfrac{p^{L}}{\\gamma - 1} + \\dfrac{1}{2}\\rho^{L} (u^{L})^{2}$。在界面上的高阶重构状态为 $U^{H} = (\\rho^{H}, m^{H}, E^{H})$，其中 $\\rho^{H} = 0.8$ kg/m$^{3}$，$u^{H} = 900$ m/s，$E^{H} = 314000$ J/m$^{3}$。正性下限值为 $\\epsilon_{\\rho} = 10^{-6}$ kg/m$^{3}$ 和 $\\epsilon_{p} = 100$ Pa。\n\n使用上述定义并通过 $U^{\\text{lim}}(\\theta)$ 在界面上施加约束，确定最大的限制器系数 $\\theta \\in [0,1]$，以保证 $\\rho(\\theta) \\ge \\epsilon_{\\rho}$ 和 $p(\\theta) \\ge \\epsilon_{p}$。将最终的 $\\theta$ 表示为一个无量纲数，并将答案四舍五入到四位有效数字。",
            "solution": "用户希望找到一个保正有限体积格式的最大限制器系数 $\\theta$。\n\n### 步骤 1：问题验证\n问题陈述清晰、自洽地描述了计算流体动力学（CFD）中的一个场景，特别是关于在高阶格式（如加权基本无振荡（WENO））中使用的保正限制器。\n\n**已知条件：**\n-   **守恒状态向量：** $U = (\\rho, m, E)$，其中动量密度为 $m = \\rho u$，总能量密度为 $E$。\n-   **状态方程：** $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right) = (\\gamma - 1)\\left(E - \\tfrac{m^2}{2\\rho}\\right)$。\n-   **限制器公式：** $U^{\\text{lim}}(\\theta) = \\theta\\,U^{H} + (1 - \\theta)\\,U^{L}$，对于 $\\theta \\in [0, 1]$。\n-   **约束条件：** $\\rho(\\theta) \\ge \\epsilon_{\\rho}$ 和 $p(\\theta) \\ge \\epsilon_{p}$。\n-   **比热比：** $\\gamma = 1.4$。\n-   **低阶施主单元状态参数：** $\\rho^{L} = 1.2$ kg/m$^{3}$，$u^{L} = 300$ m/s，$p^{L} = 101325$ Pa。\n-   **高阶重构界面状态参数：** $\\rho^{H} = 0.8$ kg/m$^{3}$，$u^{H} = 900$ m/s，$E^{H} = 314000$ J/m$^{3}$。\n-   **正性下限值：** $\\epsilon_{\\rho} = 10^{-6}$ kg/m$^{3}$ 和 $\\epsilon_{p} = 100$ Pa。\n-   **$E^L$ 的公式：** $E^{L} = \\dfrac{p^{L}}{\\gamma - 1} + \\dfrac{1}{2}\\rho^{L} (u^{L})^{2}$。\n\n**验证：**\n1.  **科学依据：** 该问题基于可压缩欧拉方程和理想气体定律，这些是流体动力学中的基本原理。保正限制器的概念是高等计算流体动力学中处理高阶重构方法产生的非物理振荡（如负压力或负密度）的标准技术。该设定在科学上是合理的。\n2.  **适定性：** 提供了所有必要的数据和本构关系，可以唯一确定对 $\\theta$ 的约束。目标是找到一个良定义集合的最大值，这是一个适定的数学问题。\n3.  **客观性：** 该问题使用精确、客观的数学和物理术语进行陈述。\n\n**结论：** 问题有效。\n\n### 步骤 2：计算状态向量\n首先，我们计算完整的守恒状态向量 $U^L$ 和 $U^H$。\n\n**低阶状态 $U^L = (\\rho^L, m^L, E^L)$：**\n-   密度已知：$\\rho^L = 1.2$。\n-   动量密度为 $m^L = \\rho^L u^L = 1.2 \\times 300 = 360$。\n-   总能量密度为 $E^L = \\dfrac{p^L}{\\gamma - 1} + \\dfrac{1}{2}\\rho^L(u^L)^2$。\n    当 $\\gamma = 1.4$ 时，我们有 $\\gamma - 1 = 0.4$。\n    $$\n    E^L = \\frac{101325}{0.4} + \\frac{1}{2}(1.2)(300)^2 = 253312.5 + 0.6(90000) = 253312.5 + 54000 = 307312.5\n    $$\n因此，低阶状态向量为 $U^L = (1.2, 360, 307312.5)$。\n\n**高阶状态 $U^H = (\\rho^H, m^H, E^H)$：**\n-   密度已知：$\\rho^H = 0.8$。\n-   动量密度为 $m^H = \\rho^H u^H = 0.8 \\times 900 = 720$。\n-   总能量密度已知：$E^H = 314000$。\n因此，高阶状态向量为 $U^H = (0.8, 720, 314000)$。\n\n### 步骤 3：构建限制状态和约束条件\n限制状态是 $U^L$ 和 $U^H$ 之间的线性插值：\n$U^{\\text{lim}}(\\theta) = \\theta U^H + (1-\\theta) U^L = U^L + \\theta(U^H - U^L)$。\n令 $\\Delta U = U^H - U^L$。\n$\\Delta \\rho = \\rho^H - \\rho^L = 0.8 - 1.2 = -0.4$。\n$\\Delta m = m^H - m^L = 720 - 360 = 360$。\n$\\Delta E = E^H - E^L = 314000 - 307312.5 = 6687.5$。\n\n限制状态的分量为：\n$\\rho(\\theta) = \\rho^L + \\theta \\Delta \\rho = 1.2 - 0.4\\theta$\n$m(\\theta) = m^L + \\theta \\Delta m = 360 + 360\\theta$\n$E(\\theta) = E^L + \\theta \\Delta E = 307312.5 + 6687.5\\theta$\n\n现在，我们施加正性约束。\n\n**密度约束：** $\\rho(\\theta) \\ge \\epsilon_{\\rho}$\n$$\n1.2 - 0.4\\theta \\ge 10^{-6}\n$$\n$$\n1.199999 \\ge 0.4\\theta\n$$\n$$\n\\theta \\le \\frac{1.199999}{0.4} = 2.9999975\n$$\n由于 $\\theta$ 也被约束在 $[0, 1]$ 区间内，因此对于所有的 $\\theta \\in [0, 1]$，该密度约束都满足。因此，密度约束要求 $\\theta \\le 1$。\n\n**压力约束：** $p(\\theta) \\ge \\epsilon_{p}$\n压力为 $p(\\theta) = (\\gamma - 1)\\left(E(\\theta) - \\frac{m(\\theta)^2}{2\\rho(\\theta)}\\right)$。\n约束条件变为：\n$$\n(\\gamma - 1)\\left(E(\\theta) - \\frac{m(\\theta)^2}{2\\rho(\\theta)}\\right) \\ge \\epsilon_p\n$$\n由于在允许的 $\\theta$ 范围内 $\\rho(\\theta) > \\epsilon_\\rho > 0$，我们可以两边乘以 $\\rho(\\theta)$：\n$$\n(\\gamma - 1)\\left(E(\\theta)\\rho(\\theta) - \\frac{1}{2}m(\\theta)^2\\right) \\ge \\epsilon_p \\rho(\\theta)\n$$\n这可以重排为一个形如 $A\\theta^2 + B\\theta + C \\ge 0$ 的二次不等式。\n各项定义如下：\n$A = (\\gamma - 1)\\left(\\Delta E \\Delta \\rho - \\frac{1}{2}(\\Delta m)^2\\right)$\n$B = (\\gamma - 1)\\left(E^L \\Delta \\rho + \\rho^L \\Delta E - m^L \\Delta m\\right) - \\epsilon_p \\Delta \\rho$\n$C = (\\gamma - 1)\\left(E^L \\rho^L - \\frac{1}{2}(m^L)^2\\right) - \\epsilon_p \\rho^L = (p^L - \\epsilon_p)\\rho^L$\n\n让我们用给定的值计算这些系数：\n-   系数 $A$：\n    $$\n    A = 0.4 \\left( (6687.5)(-0.4) - \\frac{1}{2}(360)^2 \\right) = 0.4 \\left( -2675 - \\frac{129600}{2} \\right) = 0.4(-2675 - 64800) = 0.4(-67475) = -26990\n    $$\n-   系数 $B$：\n    $$\n    B = 0.4 \\left( (307312.5)(-0.4) + (1.2)(6687.5) - (360)(360) \\right) - (100)(-0.4)\n    $$\n    $$\n    B = 0.4(-122925 + 8025 - 129600) + 40 = 0.4(-244500) + 40 = -97800 + 40 = -97760\n    $$\n-   系数 $C$：\n    $$\n    C = (101325 - 100)(1.2) = (101225)(1.2) = 121470\n    $$\n\n压力约束是以下二次不等式：\n$$\n-26990\\theta^2 - 97760\\theta + 121470 \\ge 0\n$$\n为了求根，我们解方程 $-26990\\theta^2 - 97760\\theta + 121470 = 0$。两边除以 $-1$ 并反转不等号，得到：\n$$\n26990\\theta^2 + 97760\\theta - 121470 \\le 0\n$$\n二次方程 $a\\theta^2 + b\\theta + c = 0$（其中 $a=26990$, $b=97760$, $c=-121470$）的根可以通过二次公式 $\\theta = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求得。\n$$\n\\theta = \\frac{-97760 \\pm \\sqrt{97760^2 - 4(26990)(-121470)}}{2(26990)}\n$$\n$$\n\\theta = \\frac{-97760 \\pm \\sqrt{9556997600 + 13113541200}}{53980}\n$$\n$$\n\\theta = \\frac{-97760 \\pm \\sqrt{22670538800}}{53980} = \\frac{-97760 \\pm 150567.419}{53980}\n$$\n两个根是：\n$$\n\\theta_1 = \\frac{-97760 + 150567.419}{53980} = \\frac{52807.419}{53980} \\approx 0.97827749\n$$\n$$\n\\theta_2 = \\frac{-97760 - 150567.419}{53980} = \\frac{-248327.419}{53980} \\approx -4.60036\n$$\n由于二次函数 $26990\\theta^2 + \\dots$ 的首项系数为正（它是一个开口向上的抛物线），因此不等式在两根之间成立：$\\theta \\in [\\theta_2, \\theta_1]$。\n所以，压力约束要求 $\\theta \\in [-4.60036, 0.97827749]$。\n\n### 步骤 4：确定最终的最大 $\\theta$\n我们必须找到同时满足所有约束条件的 $\\theta$ 值：\n1.  根据问题定义：$\\theta \\in [0, 1]$。\n2.  根据密度约束：$\\theta \\in [0, 1]$。\n3.  根据压力约束：$\\theta \\in [-4.60036, 0.97827749]$。\n\n这三个区间的交集是：\n$$\n[0, 1] \\cap [-4.60036, 0.97827749] = [0, 0.97827749]\n$$\n问题要求的是在这个最终有效区间内 $\\theta$ 的最大值。\n$$\n\\theta_{\\text{max}} = 0.97827749...\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\theta_{\\text{max}} \\approx 0.9783\n$$",
            "answer": "$$\\boxed{0.9783}$$"
        }
    ]
}