{
    "hands_on_practices": [
        {
            "introduction": "我们如何量化数值格式引入的人为耗散？修正方程分析是一种强大的技术，它能揭示离散格式实际求解的等效偏微分方程。本练习将指导您为两种常见的对流格式——一阶迎风格式和高阶的QUICK格式——推导其“等效扩散系数”。通过比较两者，您将具体理解格式的精度如何与其耗散（甚至是反耗散）特性相关联 。",
            "id": "3981448",
            "problem": "航空航天计算流体动力学 (CFD) 中对流输运的模拟，通常依赖于一维线性平流方程的离散化，该方程是在均匀流场中无源标量输运的基本模型。考虑一个由一维线性平流方程 $u_t + a\\,u_x = 0$ 控制的无源标量场平流，其中对流速度 $a  0$ 为常数。设空间域在间距为 $\\Delta x$ 的均匀网格上进行离散，并使用时间步长为 $\\Delta t$ 的显式前向欧拉法进行时间推进。定义 Courant–Friedrichs–Lewy (CFL) 参数为 $C = a\\,\\Delta t/\\Delta x$。\n\n现有两种空间离散格式需要进行比较：\n\n- 对于 $a0$ 的供体单元迎风（一阶迎风）有限差分格式：网格索引 $j$ 处的更新公式为 $u_j^{n+1} = u_j^n - C\\left(u_j^n - u_{j-1}^n\\right)$。\n\n- 对于 $a0$ 的对流运动学二次上游插值 (QUICK) 有限体积格式：面值通过二次上游插值获得。在均匀网格上，$x_{j+1/2}$ 处的插值面值为 $u_{j+1/2} = -\\frac{1}{8}u_{j-1} + \\frac{3}{4}u_j + \\frac{3}{8}u_{j+1}$。然后，单元 $j$ 的通量散度近似为 $\\left(a\\,u_{j+1/2} - a\\,u_{j-1/2}\\right)/\\Delta x$，并使用显式前向欧拉法进行时间推进。\n\n使用修正方程分析方法，从连续方程 $u_t + a\\,u_x = 0$ 出发，对离散格式在空间和时间上进行一致的泰勒级数展开，为每种格式推导出形式修正方程 $u_t + a\\,u_x = \\alpha_h\\,u_{xx} + \\text{(高阶项)}$ 中的主阶等效扩散系数 $\\alpha_h$，并用 $a$、$\\Delta x$ 和 $C$ 表示。\n\n然后，对于 $a = 250\\,\\text{m/s}$，$\\Delta x = 1.5\\times 10^{-3}\\,\\text{m}$ 和 $C = 0.70$ 的情况，计算两种扩散系数 $\\alpha_h^{\\text{upwind}}$ 和 $\\alpha_h^{\\text{QUICK}}$ 的数值。将最终结果以 $\\text{m}^2/\\text{s}$ 为单位，表示为一个行矩阵 $\\begin{pmatrix}\\alpha_h^{\\text{upwind}}  \\alpha_h^{\\text{QUICK}}\\end{pmatrix}$，并将您的答案四舍五入至四位有效数字。\n\n此外，在您的推导过程中，请根据两种格式的修正方程的符号和主阶项，简要解释其所隐含的单调性和色散之间的权衡，但不要将此讨论包含在最终的数值答案中。",
            "solution": "该问题要求针对应用于一维线性平流方程 $u_t + a\\,u_x = 0$ 的一阶迎风格式和 QUICK 格式，在使用前向欧拉时间步进法时，推导其主阶等效扩散系数 $\\alpha_h$。这通过修正方程分析得以实现，该分析涉及对离散格式进行泰勒级数展开，以找到其更精确地表示的连续偏微分方程。\n\n分析的核心依赖于函数 $u(x, t)$ 在点 $(x_j, t_n)$ 附近的泰勒级数展开：\n$u_j^{n+1} = u(x_j, t_n+\\Delta t) = u_j^n + \\Delta t \\left(\\frac{\\partial u}{\\partial t}\\right)_j^n + \\frac{(\\Delta t)^2}{2!} \\left(\\frac{\\partial^2 u}{\\partial t^2}\\right)_j^n + \\frac{(\\Delta t)^3}{3!} \\left(\\frac{\\partial^3 u}{\\partial t^3}\\right)_j^n + \\dots$\n$u_{j\\pm 1}^n = u(x_j\\pm\\Delta x, t_n) = u_j^n \\pm \\Delta x \\left(\\frac{\\partial u}{\\partial x}\\right)_j^n + \\frac{(\\Delta x)^2}{2!} \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_j^n \\pm \\frac{(\\Delta x)^3}{3!} \\left(\\frac{\\partial^3 u}{\\partial x^3}\\right)_j^n + \\dots$\n\n为确保一致性，使用原始偏微分方程 $u_t = -a\\,u_x$ 将时间导数替换为空间导数。\n$\\frac{\\partial^2 u}{\\partial t^2} = \\frac{\\partial}{\\partial t}(-a\\,u_x) = -a\\,\\frac{\\partial}{\\partial x}(u_t) = -a\\,\\frac{\\partial}{\\partial x}(-a\\,u_x) = a^2\\,\\frac{\\partial^2 u}{\\partial x^2}$。\n$\\frac{\\partial^3 u}{\\partial t^3} = \\frac{\\partial}{\\partial t}(a^2\\,u_{xx}) = a^2\\,\\frac{\\partial^2}{\\partial x^2}(u_t) = a^2\\,\\frac{\\partial^2}{\\partial x^2}(-a\\,u_x) = -a^3\\,\\frac{\\partial^3 u}{\\partial x^3}$。\n此后，导数将用下标表示，例如 $u_t$、$u_{xx}$。所有展开都围绕点 $(x_j, t_n)$ 进行。\n\n**1. 一阶迎风（供体单元）格式**\n\n离散方程为 $u_j^{n+1} = u_j^n - C(u_j^n - u_{j-1}^n)$，其中 $C = a\\,\\Delta t / \\Delta x$。\n对该格式进行整理可得：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} = - \\frac{C}{\\Delta t} (u_j^n - u_{j-1}^n) = - \\frac{a}{\\Delta x} (u_j^n - u_{j-1}^n) $$\n我们将方程左侧 (LHS) 和右侧 (RHS) 展开为泰勒级数。\n\nLHS 展开：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} = u_t + \\frac{\\Delta t}{2} u_{tt} + \\frac{(\\Delta t)^2}{6} u_{ttt} + O((\\Delta t)^3) $$\n用空间导数替换时间导数：\n$$ \\text{LHS} = u_t + \\frac{\\Delta t}{2} (a^2 u_{xx}) + \\frac{(\\Delta t)^2}{6} (-a^3 u_{xxx}) + \\dots = u_t + \\frac{a^2 \\Delta t}{2} u_{xx} - \\frac{a^3 (\\Delta t)^2}{6} u_{xxx} + \\dots $$\n\nRHS 展开：\n$$ -\\frac{a}{\\Delta x} (u_j^n - u_{j-1}^n) = -\\frac{a}{\\Delta x} \\left( u - \\left[ u - \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + \\dots \\right] \\right) $$\n$$ \\text{RHS} = -\\frac{a}{\\Delta x} \\left( \\Delta x u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + \\frac{(\\Delta x)^3}{6} u_{xxx} - \\dots \\right) = -a\\,u_x + \\frac{a \\Delta x}{2} u_{xx} - \\frac{a (\\Delta x)^2}{6} u_{xxx} + \\dots $$\n\n令 LHS 与 RHS 相等：\n$$ u_t + \\frac{a^2 \\Delta t}{2} u_{xx} + \\dots = -a\\,u_x + \\frac{a \\Delta x}{2} u_{xx} + \\dots $$\n整理以匹配 $u_t + a\\,u_x = \\alpha_h u_{xx} + \\dots$ 的形式：\n$$ u_t + a\\,u_x = \\left( \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2} \\right) u_{xx} + \\text{H.O.T.} $$\n$u_{xx}$ 项的系数即为等效扩散系数 $\\alpha_h^{\\text{upwind}}$。提取公因式 $\\frac{a \\Delta x}{2}$ 并使用 $C = a \\Delta t / \\Delta x$：\n$$ \\alpha_h^{\\text{upwind}} = \\frac{a \\Delta x}{2} \\left( 1 - \\frac{a \\Delta t}{\\Delta x} \\right) = \\frac{a \\Delta x}{2} (1 - C) $$\n\n**2. 对流运动学二次上游插值 (QUICK) 格式**\n\n采用前向欧拉时间积分的 QUICK 格式为：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -\\frac{a}{\\Delta x} (u_{j+1/2} - u_{j-1/2}) $$\n面值由以下公式给出：\n$u_{j+1/2} = -\\frac{1}{8}u_{j-1} + \\frac{3}{4}u_j + \\frac{3}{8}u_{j+1}$\n$u_{j-1/2} = -\\frac{1}{8}u_{j-2} + \\frac{3}{4}u_{j-1} + \\frac{3}{8}u_{j}$\n\n首先，我们求通量差分项 $u_{j+1/2} - u_{j-1/2}$ 的泰勒展开：\n$$ u_{j+1/2} - u_{j-1/2} = \\frac{1}{8}u_{j-2} - \\left(\\frac{1}{8}+\\frac{3}{4}\\right)u_{j-1} + \\left(\\frac{3}{4}-\\frac{3}{8}\\right)u_j + \\frac{3}{8}u_{j+1} $$\n$$ u_{j+1/2} - u_{j-1/2} = \\frac{1}{8}u_{j-2} - \\frac{7}{8}u_{j-1} + \\frac{3}{8}u_j + \\frac{3}{8}u_{j+1} $$\n将每一项在 $x_j$ 附近展开：\n$u_{j-2} = u - 2\\Delta x u_x + 2(\\Delta x)^2 u_{xx} - \\frac{4}{3}(\\Delta x)^3 u_{xxx} + \\dots$\n$u_{j-1} = u - \\Delta x u_x + \\frac{1}{2}(\\Delta x)^2 u_{xx} - \\frac{1}{6}(\\Delta x)^3 u_{xxx} + \\dots$\n$u_{j+1} = u + \\Delta x u_x + \\frac{1}{2}(\\Delta x)^2 u_{xx} + \\frac{1}{6}(\\Delta x)^3 u_{xxx} + \\dots$\n\n将这些展开式代入通量差分表达式，并按导数阶数合并同类项：\n$u$ 的系数： $\\frac{1}{8} - \\frac{7}{8} + \\frac{3}{8} + \\frac{3}{8} = 0$。\n$u_x$ 的系数： $\\Delta x \\left( \\frac{1}{8}(-2) - \\frac{7}{8}(-1) + \\frac{3}{8}(1) \\right) = \\Delta x \\left( \\frac{-2+7+3}{8} \\right) = \\Delta x$。\nQUICK 空间离散格式具有三阶精度，因此 $u_{xx}$ 项必须为零。\n$u_{xx}$ 的系数： $(\\Delta x)^2 \\left( \\frac{1}{8}(2) - \\frac{7}{8}(\\frac{1}{2}) + \\frac{3}{8}(0) + \\frac{3}{8}(\\frac{1}{2}) \\right) = (\\Delta x)^2 \\left( \\frac{1}{4} - \\frac{7}{16} + \\frac{3}{16} \\right) = (\\Delta x)^2 \\left( \\frac{4-7+3}{16} \\right) = 0$。\n$u_{xxx}$ 的系数： $(\\Delta x)^3 \\left( \\frac{1}{8}\\left(-\\frac{4}{3}\\right) - \\frac{7}{8}\\left(-\\frac{1}{6}\\right) + \\frac{3}{8}\\left(\\frac{1}{6}\\right) \\right) = (\\Delta x)^3 \\left( \\frac{-8+7+3}{24} \\right) = \\frac{2}{24}(\\Delta x)^3 = \\frac{1}{12}(\\Delta x)^3$。\n\n因此，空间通量项展开为：\n$$ -\\frac{a}{\\Delta x}(u_{j+1/2} - u_{j-1/2}) = -\\frac{a}{\\Delta x}\\left( \\Delta x u_x + \\frac{(\\Delta x)^3}{12}u_{xxx} + \\dots \\right) = -a u_x - \\frac{a(\\Delta x)^2}{12}u_{xxx} + \\dots $$\nLHS 与迎风格式的情况相同：$u_t + \\frac{a^2 \\Delta t}{2} u_{xx} - \\frac{a^3 (\\Delta t)^2}{6} u_{xxx} + \\dots$。\n\n对 QUICK 格式，令 LHS 与 RHS 相等：\n$$ u_t + \\frac{a^2 \\Delta t}{2} u_{xx} + \\dots = -a u_x - \\frac{a(\\Delta x)^2}{12}u_{xxx} + \\dots $$\n整理后得到修正方程：\n$$ u_t + a\\,u_x = - \\frac{a^2 \\Delta t}{2} u_{xx} + \\left(\\frac{a^3 (\\Delta t)^2}{6} - \\frac{a(\\Delta x)^2}{12}\\right) u_{xxx} + \\text{H.O.T.} $$\n主阶误差项是由一阶时间积分引入的二阶导数项。等效扩散系数为：\n$$ \\alpha_h^{\\text{QUICK}} = - \\frac{a^2 \\Delta t}{2} $$\n用 $C = a \\Delta t / \\Delta x$ 表示：\n$$ \\alpha_h^{\\text{QUICK}} = - \\frac{a \\Delta x}{2} \\left( \\frac{a \\Delta t}{\\Delta x} \\right) = - \\frac{a \\Delta x C}{2} $$\n\n**关于单调性与色散的讨论**\n\n修正方程中的主阶误差项，即二阶空间导数项，决定了格式的数值耗散或数值扩散。\n- 对于**一阶迎风格式**，$\\alpha_h^{\\text{upwind}} = \\frac{a \\Delta x}{2}(1 - C)$。对于一个稳定的显式格式，CFL 数 $C$ 必须在 $0 \\le C \\le 1$ 的范围内。在此范围内，$\\alpha_h^{\\text{upwind}} \\ge 0$。正的扩散系数对应于数值耗散，其效果是抹平解中的陡峭梯度。此特性确保了格式是单调的（不产生新的极值或振荡），但这是以牺牲精度为代价的，因为它引入了过多的扩散。\n- 对于 **QUICK 格式**，$\\alpha_h^{\\text{QUICK}} = - \\frac{a \\Delta x C}{2}$。由于 $a  0$，$\\Delta x  0$，且通常 $C  0$，扩散系数 $\\alpha_h^{\\text{QUICK}}$ 为负。这对应于反扩散，它可以人为地使梯度变陡，更重要的是，会导致在间断或陡峭梯度附近出现非物理振荡（伪振荡）。这种单调性的丧失是为获得更高阶精度而进行的典型权衡。尽管 QUICK 的空间离散是三阶的（与迎风格式相比，其三阶色散误差项更小），但它与前向欧拉时间步进的组合使得该格式非单调。\n\n修正方程中的三阶导数项决定了数值色散，它导致解的不同波分量以不正确的、依赖于波数的速度传播，从而导致解的剖面失真。这种权衡是显而易见的：迎风格式扩散性过强但具有单调性，而 QUICK 格式的扩散性要小得多（实际上是反扩散），色散误差更小，但非单调。\n\n**3. 数值计算**\n\n给定数值：$a = 250\\,\\text{m/s}$，$\\Delta x = 1.5 \\times 10^{-3}\\,\\text{m}$，以及 $C = 0.70$。\n首先，我们计算乘积 $a \\Delta x$：\n$$ a \\Delta x = (250) \\times (1.5 \\times 10^{-3}) = 0.375\\,\\text{m}^2/\\text{s} $$\n\n现在，我们计算两个扩散系数：\n对于迎风格式：\n$$ \\alpha_h^{\\text{upwind}} = \\frac{a \\Delta x}{2}(1 - C) = \\frac{0.375}{2}(1 - 0.70) = 0.1875 \\times 0.30 = 0.05625\\,\\text{m}^2/\\text{s} $$\n对于 QUICK 格式：\n$$ \\alpha_h^{\\text{QUICK}} = - \\frac{a \\Delta x C}{2} = - \\frac{0.375 \\times 0.70}{2} = - \\frac{0.2625}{2} = -0.13125\\,\\text{m}^2/\\text{s} $$\n\n题目要求将结果四舍五入至四位有效数字。\n$\\alpha_h^{\\text{upwind}} = 0.05625$ (此值恰好有四位有效数字)。\n$\\alpha_h^{\\text{QUICK}} = -0.13125 \\approx -0.1313$ (四舍五入至四位有效数字)。\n\n最终答案应表示为行矩阵 $\\begin{pmatrix}\\alpha_h^{\\text{upwind}}  \\alpha_h^{\\text{QUICK}}\\end{pmatrix}$。\n$$ \\begin{pmatrix} 0.05625  -0.1313 \\end{pmatrix} $$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.05625  -0.1313 \\end{pmatrix} } $$"
        },
        {
            "introduction": "除了耗散作用（平滑波形）外，数值格式还会导致波以错误的速度传播，这种现象称为数值色散。冯·诺依曼分析是量化这种相位误差的主要工具。本练习将聚焦于广泛使用的二阶Lax-Wendroff格式，您将推导其复数放大因子，并确定其在长波（即小波数）极限下的主导相位误差行为，从而揭示色散误差如何依赖于波数和CFL数 。",
            "id": "3981497",
            "problem": "考虑一维线性平流方程 $u_{t} - a\\,u_{x} = 0$，其平流速度 $a0$ 为常数，该方程是航空航天计算流体力学 (CFD) 背景下无源标量输运的代表。设空间网格均匀，间距为 $\\Delta x$，时间步长为 $\\Delta t$，并定义 Courant-Friedrichs-Lewy (CFL) 数 $\\nu = a\\,\\Delta t/\\Delta x$。假设 $|\\nu| \\le 1$。使用通过时间上的泰勒展开和空间上的中心差分构建的二阶 Lax–Wendroff 格式对该方程进行离散化：\n$$\nu_{j}^{n+1} = u_{j}^{n} + \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(u_{j+1}^{n}-2\\,u_{j}^{n}+u_{j-1}^{n}\\right).\n$$\n通过考虑离散傅里叶模 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,j\\,\\theta\\right)$ 来进行 von Neumann (傅里叶) 分析，其中 $\\theta = k\\,\\Delta x$ 是与物理波数 $k$ 和网格间距 $\\Delta x$ 相关的无量纲波数。令 $G(\\theta)$ 为单个时间步长得到的复放大因子。将每时间步相位误差定义为\n$$\n\\phi_{\\mathrm{err}}(\\theta) = k\\,a\\,\\Delta t - \\arg\\!\\big(G(\\theta)\\big),\n$$\n并假设 $\\theta$ 以弧度为单位。从控制方程和给定的离散化格式出发，推导 $G(\\theta)$ 并确定在 $\\theta$ 很小（即 $\\theta \\to 0$）时 $\\phi_{\\mathrm{err}}(\\theta)$ 的主阶标度，保留渐近展开中的第一个非零项。请用 $\\nu$ 和 $\\theta$ 将最终答案表示为单个闭式解析表达式。",
            "solution": "用户在偏微分方程数值分析领域提供了一个适定且科学上合理的问题，具体涉及应用于线性平流方程的 Lax-Wendroff 格式的数值色散分析。所有必要信息均已提供，且定义一致。因此，该问题被认为是有效的，下面给出完整解法。\n\n目标是确定当无量纲波数 $\\theta$ 趋近于零时，二阶 Lax-Wendroff 格式的每时间步相位误差 $\\phi_{\\mathrm{err}}(\\theta)$ 的主阶标度。\n\n首先，我们推导该数值格式的放大因子 $G(\\theta)$。给定的格式为：\n$$\nu_{j}^{n+1} = u_{j}^{n} + \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(u_{j+1}^{n}-2\\,u_{j}^{n}+u_{j-1}^{n}\\right)\n$$\n使用 CFL 数的定义 $\\nu = a\\,\\Delta t/\\Delta x$，该格式可以写为：\n$$\nu_{j}^{n+1} = u_{j}^{n} + \\frac{\\nu}{2}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right) + \\frac{\\nu^{2}}{2}\\left(u_{j+1}^{n}-2\\,u_{j}^{n}+u_{j-1}^{n}\\right)\n$$\n我们通过代入离散傅里叶模 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$（其中 $\\theta = k\\,\\Delta x$）来进行 von Neumann 稳定性分析。空间位移表示为：\n$$\nu_{j+1}^{n} = \\hat{u}^{n}\\,\\exp(i\\,(j+1)\\,\\theta) = u_{j}^{n}\\,\\exp(i\\,\\theta)\n$$\n$$\nu_{j-1}^{n} = \\hat{u}^{n}\\,\\exp(i\\,(j-1)\\,\\theta) = u_{j}^{n}\\,\\exp(-i\\,\\theta)\n$$\n在下一个时间步，$u_{j}^{n+1} = \\hat{u}^{n+1}\\,\\exp(i\\,j\\,\\theta)$。放大因子由关系式 $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$ 定义，这意味着 $u_{j}^{n+1} = G(\\theta)\\,u_{j}^{n}$。将这些表达式代入数值格式中得到：\n$$\nG(\\theta)\\,u_{j}^{n} = u_{j}^{n} + \\frac{\\nu}{2}\\left(u_{j}^{n}\\,\\exp(i\\,\\theta)-u_{j}^{n}\\,\\exp(-i\\,\\theta)\\right) + \\frac{\\nu^{2}}{2}\\left(u_{j}^{n}\\,\\exp(i\\,\\theta)-2\\,u_{j}^{n}+u_{j}^{n}\\,\\exp(-i\\,\\theta)\\right)\n$$\n除以公因子 $u_{j}^{n}$，我们得到放大因子：\n$$\nG(\\theta) = 1 + \\frac{\\nu}{2}\\left(\\exp(i\\,\\theta)-\\exp(-i\\,\\theta)\\right) + \\frac{\\nu^{2}}{2}\\left(\\exp(i\\,\\theta)-2+\\exp(-i\\,\\theta)\\right)\n$$\n使用 Euler 恒等式 $\\exp(i\\,\\theta)-\\exp(-i\\,\\theta) = 2\\,i\\,\\sin(\\theta)$ 和 $\\exp(i\\,\\theta)+\\exp(-i\\,\\theta) = 2\\,\\cos(\\theta)$，我们简化 $G(\\theta)$：\n$$\nG(\\theta) = 1 + \\frac{\\nu}{2}\\left(2\\,i\\,\\sin(\\theta)\\right) + \\frac{\\nu^{2}}{2}\\left(2\\,\\cos(\\theta)-2\\right)\n$$\n$$\nG(\\theta) = 1 + i\\,\\nu\\,\\sin(\\theta) + \\nu^{2}\\left(\\cos(\\theta)-1\\right)\n$$\n复放大因子 $G(\\theta)$ 有一个实部 $\\mathrm{Re}(G(\\theta))$ 和一个虚部 $\\mathrm{Im}(G(\\theta))$：\n$$\n\\mathrm{Re}(G(\\theta)) = 1 + \\nu^{2}\\left(\\cos(\\theta)-1\\right)\n$$\n$$\n\\mathrm{Im}(G(\\theta)) = \\nu\\,\\sin(\\theta)\n$$\n放大因子的辐角由 $\\arg(G(\\theta)) = \\arctan\\left(\\frac{\\mathrm{Im}(G(\\theta))}{\\mathrm{Re}(G(\\theta))}\\right)$ 给出。\n$$\n\\arg(G(\\theta)) = \\arctan\\left(\\frac{\\nu\\,\\sin(\\theta)}{1 + \\nu^{2}\\left(\\cos(\\theta)-1\\right)}\\right)\n$$\n为了找到在 $\\theta$ 很小（$\\theta \\to 0$）时的主阶行为，我们使用 $\\sin(\\theta)$ 和 $\\cos(\\theta)$ 的泰勒级数展开：\n$$\n\\sin(\\theta) = \\theta - \\frac{\\theta^{3}}{6} + O(\\theta^{5})\n$$\n$$\n\\cos(\\theta) = 1 - \\frac{\\theta^{2}}{2} + \\frac{\\theta^{4}}{24} + O(\\theta^{6}) \\implies \\cos(\\theta)-1 = -\\frac{\\theta^{2}}{2} + \\frac{\\theta^{4}}{24} + O(\\theta^{6})\n$$\n将这些代入 $G(\\theta)$ 的实部和虚部的表达式中：\n$$\n\\mathrm{Im}(G(\\theta)) = \\nu\\left(\\theta - \\frac{\\theta^{3}}{6} + O(\\theta^{5})\\right)\n$$\n$$\n\\mathrm{Re}(G(\\theta)) = 1 + \\nu^{2}\\left(-\\frac{\\theta^{2}}{2} + O(\\theta^{4})\\right) = 1 - \\frac{\\nu^{2}\\,\\theta^{2}}{2} + O(\\theta^{4})\n$$\n$\\arctan$ 函数的自变量变为：\n$$\n\\frac{\\mathrm{Im}(G(\\theta))}{\\mathrm{Re}(G(\\theta))} = \\frac{\\nu\\left(\\theta - \\frac{\\theta^{3}}{6}\\right) + O(\\theta^{5})}{1 - \\frac{\\nu^{2}\\,\\theta^{2}}{2} + O(\\theta^{4})}\n$$\n使用几何级数展开 $(1-z)^{-1} = 1+z+O(z^{2})$，其中 $z=\\frac{\\nu^{2}\\,\\theta^{2}}{2}$：\n$$\n\\frac{\\mathrm{Im}(G(\\theta))}{\\mathrm{Re}(G(\\theta))} = \\left(\\nu\\,\\theta - \\frac{\\nu\\,\\theta^{3}}{6}\\right)\\left(1 + \\frac{\\nu^{2}\\,\\theta^{2}}{2}\\right) + O(\\theta^{5})\n$$\n$$\n= \\nu\\,\\theta + \\frac{\\nu^{3}\\,\\theta^{3}}{2} - \\frac{\\nu\\,\\theta^{3}}{6} + O(\\theta^{5}) = \\nu\\,\\theta + \\left(\\frac{3\\,\\nu^{3}-\\nu}{6}\\right)\\theta^{3} + O(\\theta^{5})\n$$\n令此表达式为 $X = \\nu\\,\\theta + \\frac{\\nu(3\\,\\nu^{2}-1)}{6}\\theta^{3} + O(\\theta^{5})$。对于小的 $X$，$\\arctan(X)$ 的泰勒展开为 $X - \\frac{X^{3}}{3} + O(X^{5})$。\n$$\n\\arg(G(\\theta)) = \\arctan(X) = \\left(\\nu\\,\\theta + \\frac{\\nu(3\\,\\nu^{2}-1)}{6}\\theta^{3}\\right) - \\frac{(\\nu\\,\\theta)^{3}}{3} + O(\\theta^{5})\n$$\n$$\n= \\nu\\,\\theta + \\frac{3\\,\\nu^{3}-\\nu}{6}\\theta^{3} - \\frac{\\nu^{3}}{3}\\theta^{3} + O(\\theta^{5})\n$$\n$$\n= \\nu\\,\\theta + \\frac{3\\,\\nu^{3}-\\nu-2\\,\\nu^{3}}{6}\\theta^{3} + O(\\theta^{5})\n$$\n$$\n= \\nu\\,\\theta + \\frac{\\nu^{3}-\\nu}{6}\\theta^{3} + O(\\theta^{5}) = \\nu\\,\\theta - \\frac{\\nu(1-\\nu^{2})}{6}\\theta^{3} + O(\\theta^{5})\n$$\n相位误差定义为 $\\phi_{\\mathrm{err}}(\\theta) = k\\,a\\,\\Delta t - \\arg(G(\\theta))$。项 $k\\,a\\,\\Delta t$ 表示精确解在一个时间步长内的相移。我们可以使用问题的无量纲参数重写它：\n$$\nk\\,a\\,\\Delta t = (k\\,\\Delta x)\\left(\\frac{a\\,\\Delta t}{\\Delta x}\\right) = \\theta\\,\\nu\n$$\n现在，我们计算相位误差：\n$$\n\\phi_{\\mathrm{err}}(\\theta) = \\nu\\,\\theta - \\left(\\nu\\,\\theta - \\frac{\\nu(1-\\nu^{2})}{6}\\theta^{3} + O(\\theta^{5})\\right)\n$$\n$$\n\\phi_{\\mathrm{err}}(\\theta) = \\frac{\\nu(1-\\nu^{2})}{6}\\theta^{3} - O(\\theta^{5})\n$$\n对于小 $\\theta$，相位误差的主阶项是此展开中的第一个非零项。\n\n因此，$\\phi_{\\mathrm{err}}(\\theta)$ 的主阶标度为 $\\frac{\\nu(1-\\nu^{2})}{6}\\theta^{3}$。这种对波数的三次方依赖关系是像 Lax-Wendroff 这样的二阶精度格式的色散误差的特征。",
            "answer": "$$\n\\boxed{\\frac{\\nu(1-\\nu^2)}{6}\\theta^3}\n$$"
        },
        {
            "introduction": "理论分析至关重要，但我们如何验证它在实际计算机模拟中依然成立？最后的这个练习将通过一个数值实验，将理论与实践联系起来。您将编写程序来模拟波的对流过程，通过测量正弦波的振幅衰减，并将其与冯·诺依曼分析得出的理论预测进行比较，您将亲手验证不同格式的耗散率，从而加深对理论的理解并锻炼实际编程能力 。",
            "id": "3981445",
            "problem": "考虑在长度为$L$的周期性域上的线性平流方程$u_t + a\\,u_x = 0$，其中$x$以米为单位，$t$以秒为单位，$a$是恒定的平流速度，单位为米/秒。使用与控制方程一致的构造解$u(x,t) = \\sin(\\kappa x - \\omega t)$，其中$\\kappa$是物理波数，单位为弧度/米，$\\omega$是时间频率，单位为弧度/秒。假设角度以弧度为单位。\n\n您将分析在具有$N$个点和网格间距$\\Delta x = L/N$的均匀网格上的两种显式线性有限差分格式，时间步长$\\Delta t$的选择是为了达到指定的库朗-弗里德里希斯-列维 (CFL) 数$\\sigma = a\\Delta t/\\Delta x$：\n- 对于$a  0$的一阶迎风格式。\n- 二阶Lax–Wendroff格式。\n\n使用网格上$u(x,t)$的离散实现，从$t=0$开始，对单个时间步执行以下操作：\n1. 用$x_j = j\\,\\Delta x$和整数模态数$m$（在域上的完整周期数）初始化波$u_j^0 = \\sin\\left(\\frac{2\\pi m}{L}\\,x_j\\right)$，这意味着物理波数$\\kappa = \\frac{2\\pi m}{L}$和构造角频率$\\omega = a\\,\\kappa$。\n2. 使用指定的数值格式和周期性边界条件，将解推进一个时间步，以获得$u_j^1$。\n3. 通过测量模态$m$处傅里叶分量的振幅衰减，估计每个时间步的数值耗散率。将$u_j^n$的离散傅里叶变换（使用任何一致的归一化）定义为$\\hat{u}^n(k)$，并计算每步测量的对数振幅变化为$\\Lambda_{\\text{meas}} = \\log\\left(\\left|\\hat{u}^1(m)\\right|/\\left|\\hat{u}^0(m)\\right|\\right)$。\n4. 令$G(\\theta)$表示所选格式对傅里叶模态的冯·诺依曼放大因子，其中$\\theta = \\kappa\\,\\Delta x = \\frac{2\\pi m}{N}$。计算每步的理论对数振幅变化为$\\Lambda_{\\text{theory}} = \\Re\\left[\\log G(\\theta)\\right]$。\n5. 报告每个测试用例的绝对误差$E = \\left|\\Lambda_{\\text{meas}} - \\Lambda_{\\text{theory}}\\right|$。\n\n您的程序必须实现这两种格式，为每个测试参数集执行单步更新，通过模态$m$处的离散傅里叶变换估计$\\Lambda_{\\text{meas}}$，根据冯·诺依曼分析得到的格式放大因子计算$\\Lambda_{\\text{theory}}$，并为每个案例输出绝对误差$E$。\n\n使用以下测试套件，该套件改变了格式类型、网格分辨率、波数和库朗数，以探究典型行为、近稳定性极限和高波数边缘：\n\n- 测试用例$1$：一阶迎风格式，$N=128$，$L=2\\pi$，$m=4$，$a=1$，$\\sigma=0.5$。\n- 测试用例$2$：一阶迎风格式，$N=64$，$L=2\\pi$，$m=16$，$a=1$，$\\sigma=0.5$。\n- 测试用例$3$：一阶迎风格式，$N=128$，$L=2\\pi$，$m=4$，$a=1$，$\\sigma=0.95$。\n- 测试用例$4$：二阶Lax–Wendroff格式，$N=128$，$L=2\\pi$，$m=4$，$a=1$，$\\sigma=0.5$。\n- 测试用例$5$：二阶Lax–Wendroff格式，$N=64$，$L=2\\pi$，$m=16$，$a=1$，$\\sigma=0.5$。\n- 测试用例$6$：二阶Lax–Wendroff格式，$N=128$，$L=2\\pi$，$m=4$，$a=1$，$\\sigma=0.95$。\n\n所有角度必须以弧度为单位。最终输出为无量纲实数。\n\n最终输出格式：您的程序应生成一行输出，其中包含所有六个测试用例的绝对误差，格式为用方括号括起来的逗号分隔列表（例如，$\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5,\\text{result}_6\\right]$）。每个$\\text{result}_i$必须是一个浮点数。",
            "solution": "该问题要求将冯·诺依曼稳定性分析预测的数值耗散与两种有限差分格式的直接数值模拟测量结果进行验证。我们将分析用于线性平流方程$u_t + a\\,u_x = 0$的一阶迎风格式和二阶Lax-Wendroff格式。任务的核心是确认对于周期性域上的线性常系数偏微分方程，由冯·诺依曼分析导出的放大因子$G$能够精确描述离散傅里叶模态的演化。\n\n首先，我们使用冯·诺依曼分析建立理论框架。该方法假设单个傅里叶模态是离散化方程的一个解，形式为$u_j^n = G^n e^{i j \\theta}$，其中$u_j^n$是网格点$j$和时间层$n$的数值解，$\\theta = \\kappa \\Delta x$是无量纲波数，$G$是每个时间步的复数放大因子。其模$|G(\\theta)|$表示该模态振幅的变化，量化了数值耗散（如果$|G(\\theta)|1$）或放大（如果$|G(\\theta)|1$）。\n\n待分析的两种格式是：\n1.  一阶迎风格式（对于$a0$）：\n    $$u_j^{n+1} = u_j^n - \\sigma(u_j^n - u_{j-1}^n)$$\n    其中$\\sigma = a \\Delta t / \\Delta x$是库朗数。代入傅里叶模态$u_j^n = G^n e^{i j \\theta}$得到：\n    $$G^{n+1} e^{i j \\theta} = G^n e^{i j \\theta} - \\sigma(G^n e^{i j \\theta} - G^n e^{i (j-1) \\theta})$$\n    两边同除以$G^n e^{i j \\theta}$，得到放大因子：\n    $$G_{\\text{upwind}}(\\theta) = 1 - \\sigma(1 - e^{-i\\theta})$$\n\n2.  二阶Lax-Wendroff格式：\n    $$u_j^{n+1} = u_j^n - \\frac{\\sigma}{2}(u_{j+1}^n - u_{j-1}^n) + \\frac{\\sigma^2}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)$$\n    代入傅里叶模态并使用恒等式$e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$和$e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$可得：\n    $$G_{\\text{LW}}(\\theta) = 1 - \\frac{\\sigma}{2}(e^{i\\theta} - e^{-i\\theta}) + \\frac{\\sigma^2}{2}(e^{i\\theta} - 2 + e^{-i\\theta})$$\n    $$G_{\\text{LW}}(\\theta) = 1 - i\\sigma\\sin\\theta + \\sigma^2(\\cos\\theta - 1)$$\n\n对于给定波数参数$\\theta = \\kappa \\Delta x = \\frac{2\\pi m}{N}$的模态，每步的理论对数振幅变化为$\\Lambda_{\\text{theory}} = \\Re[\\log G(\\theta)]$。由于对于任何复数$z$，$\\log(z) = \\log|z| + i \\arg(z)$，其实部就是其模的自然对数：\n$$\\Lambda_{\\text{theory}} = \\log|G(\\theta)|$$\n\n接下来，我们设计数值实验。我们在$j=0, 1, \\dots, N-1$的离散网格$x_j = j \\Delta x = j (L/N)$上，用一个纯正弦波$u_j^0 = \\sin(\\kappa x_j)$进行初始化，其中$\\kappa = 2\\pi m/L$。这个初始条件是一个实值函数，可以表示为两个复指数模态的叠加：$u_j^0 = \\frac{1}{2i}(e^{i\\kappa x_j} - e^{-i\\kappa x_j})$。它们对应于离散傅里叶空间中指数为$m$和$-m$（或$N-m$）的傅里叶模态。\n\n解通过单个时间步长$\\Delta t = \\sigma \\Delta x / a$推进，得到$u_j^1$。这是通过应用指定格式的更新规则，并使用周期性边界条件（即指数对$N$取模）来完成的。\n\n为了测量耗散，我们使用离散傅里叶变换 (DFT)，它将网格函数分解为其组成的傅里叶模态。设$\\hat{u}^n(k)$是解$u_j^n$在离散波数指数$k$处的DFT。对于线性格式，DFT系数根据放大因子演化：$\\hat{u}^1(k) = G(\\theta_k)\\hat{u}^0(k)$，其中$\\theta_k = 2\\pi k/N$。因此，我们可以直接从数值结果中测量模态$m$的放大因子大小：\n$$\\frac{|\\hat{u}^1(m)|}{|\\hat{u}^0(m)|} = |G(\\theta_m)|$$\n测得的对数振幅变化则计算为：\n$$\\Lambda_{\\text{meas}} = \\log\\left(\\frac{|\\hat{u}^1(m)|}{|\\hat{u}^0(m)|}\\right)$$\n\n最后，我们计算绝对误差$E = |\\Lambda_{\\text{meas}} - \\Lambda_{\\text{theory}}|$。由于对于此类问题（线性、常系数、周期性域），DFT和冯·诺依曼分析之间的关系是精确的，因此该误差预期接近机器浮点精度。该算法在一个Python脚本中实现，该脚本遍历给定的测试用例，为每个用例计算$E$，并报告结果。实现使用`NumPy`进行高效的数组操作，并使用`SciPy`的快速傅里叶变换(`fft`)进行谱分析。周期性边界条件通过数组滚动函数得到简洁处理。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.fft import fft\n\ndef solve():\n    \"\"\"\n    Computes the absolute error between theoretical and measured numerical dissipation\n    for finite difference schemes applied to the linear advection equation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (scheme, N, L, m, a, sigma)\n        ('upwind', 128, 2 * np.pi, 4, 1.0, 0.5),\n        ('upwind', 64, 2 * np.pi, 16, 1.0, 0.5),\n        ('upwind', 128, 2 * np.pi, 4, 1.0, 0.95),\n        ('lax-wendroff', 128, 2 * np.pi, 4, 1.0, 0.5),\n        ('lax-wendroff', 64, 2 * np.pi, 16, 1.0, 0.5),\n        ('lax-wendroff', 128, 2 * np.pi, 4, 1.0, 0.95),\n    ]\n\n    results = []\n    for case in test_cases:\n        scheme, N, L, m, a, sigma = case\n\n        # --- Theoretical Calculation ---\n        # Calculate derived parameters\n        dx = L / N\n        kappa = 2 * np.pi * m / L\n        theta = kappa * dx  # a.k.a. 2 * pi * m / N\n\n        # Calculate amplification factor G(theta)\n        if scheme == 'upwind':\n            G = 1 - sigma * (1 - np.exp(-1j * theta))\n        elif scheme == 'lax-wendroff':\n            G = 1 - 1j * sigma * np.sin(theta) + sigma**2 * (np.cos(theta) - 1)\n        else:\n            raise ValueError(\"Unknown scheme type\")\n\n        # Theoretical logarithmic amplitude change\n        # Re[log(G)] is equivalent to log|G|\n        lambda_theory = np.log(np.abs(G))\n\n        # --- Numerical Simulation and Measurement ---\n        # Set up grid and initial condition\n        x = np.arange(N) * dx\n        u0 = np.sin(kappa * x)\n\n        # Advance one time step with periodic boundary conditions\n        if scheme == 'upwind':\n            u0_jm1 = np.roll(u0, 1)\n            u1 = u0 - sigma * (u0 - u0_jm1)\n        elif scheme == 'lax-wendroff':\n            u0_jp1 = np.roll(u0, -1)\n            u0_jm1 = np.roll(u0, 1)\n            u1 = u0 - 0.5 * sigma * (u0_jp1 - u0_jm1) + \\\n                 0.5 * sigma**2 * (u0_jp1 - 2 * u0 + u0_jm1)\n\n        # Perform Discrete Fourier Transform (DFT)\n        u_hat0 = fft(u0)\n        u_hat1 = fft(u1)\n\n        # Get amplitude of mode m\n        amp0 = np.abs(u_hat0[m])\n        amp1 = np.abs(u_hat1[m])\n\n        # Measured logarithmic amplitude change\n        # A check for amp0 being non-zero is prudent in general,\n        # but not strictly necessary for the given test cases.\n        if amp0 > 1e-15:  # Use a small threshold for floating point robustness\n             lambda_meas = np.log(amp1 / amp0)\n        else:\n             # This case should not be reached with the problem's setup\n             lambda_meas = np.nan\n\n        # --- Error Calculation ---\n        error = np.abs(lambda_meas - lambda_theory)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}