{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of stability theory for linear finite difference schemes is the von Neumann analysis. This first practice provides a foundational exercise in applying this technique to the classic Lax-Friedrichs scheme . By working through this problem, you will master the essential steps of deriving an amplification factor $G(\\theta)$ and determining the famous Courant-Friedrichs-Lewy (CFL) condition, which dictates the maximum allowable time step for a stable simulation.",
            "id": "3943389",
            "problem": "Consider the linear advection equation $u_{t}+a\\,u_{x}=0$ with constant advection speed $a \\in \\mathbb{R}\\setminus\\{0\\}$ on a uniform spatial grid $x_{j}=j\\,\\Delta x$ and uniform time steps $t^{n}=n\\,\\Delta t$. The Lax–Friedrichs finite difference scheme updates the solution via\n$$\nu_{j}^{n+1}=\\tfrac{1}{2}\\left(u_{j+1}^{n}+u_{j-1}^{n}\\right)-\\tfrac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right).\n$$\nUsing a von Neumann Fourier-mode analysis with the ansatz $u_{j}^{n}=\\hat{u}^{n}\\exp\\!\\left(i\\,j\\,\\theta\\right)$, where $\\theta \\in [-\\pi,\\pi]$ is the dimensionless wave number in radians, derive the one-step amplification factor $G(\\theta)=\\hat{u}^{n+1}/\\hat{u}^{n}$ as a function of $\\theta$ and the Courant–Friedrichs–Lewy (CFL) number $C=a\\,\\Delta t/\\Delta x$. Then determine the stability requirement that ensures $|G(\\theta)|\\le 1$ for all $\\theta \\in [-\\pi,\\pi]$.\n\nFinally, provide the single closed-form expression for the maximum allowable time step $\\Delta t_{\\max}$, in seconds, in terms of $\\Delta x$ and $a$, that guarantees $|G(\\theta)|\\le 1$ for all $\\theta$. Your final answer should be only this analytic expression for $\\Delta t_{\\max}$.",
            "solution": "The problem requires the derivation of the amplification factor for the Lax–Friedrichs scheme applied to the linear advection equation, the subsequent determination of the stability criterion, and the expression for the maximum allowable time step. The problem statement is scientifically grounded, well-posed, and objective, thus it is valid.\n\nThe governing partial differential equation is the one-dimensional linear advection equation:\n$$\nu_{t} + a \\, u_{x} = 0\n$$\nwhere $a \\in \\mathbb{R}\\setminus\\{0\\}$ is a constant advection speed. The given finite difference scheme is the Lax–Friedrichs scheme on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$:\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n\nTo perform a von Neumann stability analysis, we substitute the Fourier mode ansatz $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\,j\\,\\theta)$ into the scheme. Here, $\\hat{u}^{n}$ is the amplitude of the mode at time level $n$, $j$ is the spatial index, and $\\theta = k\\,\\Delta x$ is the dimensionless wave number, where $k$ is the wave number. The terms in the scheme become:\n$$\nu_{j}^{n+1} = \\hat{u}^{n+1}\\exp(i\\,j\\,\\theta)\n$$\n$$\nu_{j+1}^{n} = \\hat{u}^{n}\\exp(i\\,(j+1)\\,\\theta) = \\hat{u}^{n}\\exp(i\\,j\\,\\theta)\\exp(i\\,\\theta)\n$$\n$$\nu_{j-1}^{n} = \\hat{u}^{n}\\exp(i\\,(j-1)\\,\\theta) = \\hat{u}^{n}\\exp(i\\,j\\,\\theta)\\exp(-i\\,\\theta)\n$$\nSubstituting these expressions into the Lax–Friedrichs scheme yields:\n$$\n\\hat{u}^{n+1}\\exp(i\\,j\\,\\theta) = \\frac{1}{2}\\left(\\hat{u}^{n}\\exp(i\\,j\\,\\theta)\\exp(i\\,\\theta) + \\hat{u}^{n}\\exp(i\\,j\\,\\theta)\\exp(-i\\,\\theta)\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(\\hat{u}^{n}\\exp(i\\,j\\,\\theta)\\exp(i\\,\\theta) - \\hat{u}^{n}\\exp(i\\,j\\,\\theta)\\exp(-i\\,\\theta)\\right)\n$$\nThe common factor $\\hat{u}^{n}\\exp(i\\,j\\,\\theta)$ can be divided out, as it is non-zero, to find the one-step amplification factor $G(\\theta) = \\hat{u}^{n+1}/\\hat{u}^{n}$:\n$$\nG(\\theta) = \\frac{1}{2}\\left(\\exp(i\\,\\theta) + \\exp(-i\\,\\theta)\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)\\right)\n$$\nUsing Euler's identities, $\\cos(\\theta) = \\frac{1}{2}(\\exp(i\\,\\theta) + \\exp(-i\\,\\theta))$ and $\\sin(\\theta) = \\frac{1}{2i}(\\exp(i\\,\\theta) - \\exp(-i\\,\\theta))$, we can simplify the expression for $G(\\theta)$:\n$$\nG(\\theta) = \\cos(\\theta) - \\frac{a\\,\\Delta t}{\\Delta x}\\left( i\\,\\sin(\\theta) \\right)\n$$\nIntroducing the Courant–Friedrichs–Lewy (CFL) number, $C = \\frac{a\\,\\Delta t}{\\Delta x}$, the amplification factor becomes:\n$$\nG(\\theta) = \\cos(\\theta) - i\\,C\\,\\sin(\\theta)\n$$\nThis is the amplification factor as a function of $\\theta$ and $C$.\n\nFor the numerical scheme to be stable, the magnitude of the amplification factor must not exceed unity for any wave number $\\theta \\in [-\\pi, \\pi]$. That is, we require $|G(\\theta)| \\le 1$. We analyze the squared magnitude:\n$$\n|G(\\theta)|^2 = |\\cos(\\theta) - i\\,C\\,\\sin(\\theta)|^2 = (\\text{Re}(G(\\theta)))^2 + (\\text{Im}(G(\\theta)))^2\n$$\n$$\n|G(\\theta)|^2 = (\\cos(\\theta))^2 + (-C\\,\\sin(\\theta))^2 = \\cos^2(\\theta) + C^2\\,\\sin^2(\\theta)\n$$\nThe stability requirement $|G(\\theta)|^2 \\le 1$ translates to:\n$$\n\\cos^2(\\theta) + C^2\\,\\sin^2(\\theta) \\le 1\n$$\nUsing the trigonometric identity $\\cos^2(\\theta) = 1 - \\sin^2(\\theta)$, we have:\n$$\n(1 - \\sin^2(\\theta)) + C^2\\,\\sin^2(\\theta) \\le 1\n$$\n$$\n1 + (C^2 - 1)\\sin^2(\\theta) \\le 1\n$$\nSubtracting $1$ from both sides gives the inequality:\n$$\n(C^2 - 1)\\sin^2(\\theta) \\le 0\n$$\nSince $\\theta \\in [-\\pi, \\pi]$, the term $\\sin^2(\\theta)$ is always non-negative, i.e., $\\sin^2(\\theta) \\ge 0$. For the inequality $(C^2 - 1)\\sin^2(\\theta) \\le 0$ to hold for all possible values of $\\theta$, the coefficient $(C^2 - 1)$ must be non-positive. If $(C^2 - 1)$ were positive, then for any $\\theta$ such that $\\sin(\\theta) \\neq 0$, the inequality would be violated. Therefore, we must have:\n$$\nC^2 - 1 \\le 0 \\implies C^2 \\le 1\n$$\nTaking the square root of both sides, we obtain the stability requirement for the Lax–Friedrichs scheme:\n$$\n|C| \\le 1\n$$\nFinally, we are asked to find the maximum allowable time step $\\Delta t_{\\max}$ that guarantees stability. We substitute the definition of the CFL number $C = \\frac{a\\,\\Delta t}{\\Delta x}$ into the stability condition:\n$$\n\\left|\\frac{a\\,\\Delta t}{\\Delta x}\\right| \\le 1\n$$\nSince $\\Delta t > 0$ and $\\Delta x > 0$, we can rewrite this as:\n$$\n\\frac{|a|\\,\\Delta t}{\\Delta x} \\le 1\n$$\nSolving for $\\Delta t$ gives:\n$$\n\\Delta t \\le \\frac{\\Delta x}{|a|}\n$$\nThe maximum allowable time step, $\\Delta t_{\\max}$, is the value that satisfies this condition with equality:\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|a|}\n$$\nThis expression provides the upper limit on the time step for any given spatial grid size $\\Delta x$ and advection speed $a$ to ensure the stability of the Lax–Friedrichs scheme.",
            "answer": "$$\\boxed{\\frac{\\Delta x}{|a|}}$$"
        },
        {
            "introduction": "While eigenvalue analysis correctly predicts the long-term fate of perturbations, it can be misleading about short-term dynamics. This exercise delves into the advanced topic of non-normal amplification, where numerical schemes can exhibit significant transient growth even when asymptotically stable . By comparing a normal and a non-normal system with identical eigenvalues, you will directly compute and quantify this effect, gaining insight into a phenomenon critical for understanding complex fluid behaviors like hydrodynamic instability.",
            "id": "3943412",
            "problem": "Consider a linear, constant-coefficient, semi-discrete system arising in Computational Fluid Dynamics (CFD), written as $\\,\\frac{d\\mathbf{y}}{dt} = \\mathbf{A}\\,\\mathbf{y}\\,$, where $\\mathbf{A} \\in \\mathbb{R}^{2 \\times 2}$ represents the spatial discretization of a dissipative linear operator (e.g., a Fourier-mode-resolved convection–diffusion operator). The one-step explicit Euler time-integration scheme advances the solution via the amplification operator $\\mathbf{G}(\\Delta t) = \\mathbf{I} + \\Delta t\\,\\mathbf{A}$.\n\nYou are asked to construct two semi-discrete schemes with identical eigenvalues but different non-normality, and then quantify their single-step transient amplification at the same time step $\\,\\Delta t\\,$:\n- Define the first scheme by the normal matrix $\\mathbf{A}_{\\mathrm{N}} = \\begin{pmatrix} -2 & 0 \\\\ 0 & -1 \\end{pmatrix}$.\n- Define the second scheme by the non-normal matrix $\\mathbf{A}_{\\mathrm{NN}} = \\mathbf{S}\\,\\mathbf{A}_{\\mathrm{N}}\\,\\mathbf{S}^{-1}$, where $\\mathbf{S} = \\begin{pmatrix} 1 & \\kappa \\\\ 0 & 1 \\end{pmatrix}$ with $\\kappa > 0$.\n\nBoth schemes share identical eigenvalues $\\,\\{-2,-1\\}\\,$ by construction, but they differ in non-normality because $\\mathbf{S}$ is not orthogonal. For the explicit Euler time step, the amplification operators are $\\mathbf{G}_{\\mathrm{N}}(\\Delta t) = \\mathbf{I} + \\Delta t\\,\\mathbf{A}_{\\mathrm{N}}$ and $\\mathbf{G}_{\\mathrm{NN}}(\\Delta t) = \\mathbf{I} + \\Delta t\\,\\mathbf{A}_{\\mathrm{NN}} = \\mathbf{S}\\,\\mathbf{G}_{\\mathrm{N}}(\\Delta t)\\,\\mathbf{S}^{-1}$.\n\nLet the time step be $\\Delta t = 0.3$ and the non-normality parameter be $\\kappa = 2$. Using the induced Euclidean operator norm (the matrix $2$-norm), compute the ratio\n$$\n\\mathcal{R} \\equiv \\frac{\\left\\|\\mathbf{G}_{\\mathrm{NN}}(\\Delta t)\\right\\|_{2}}{\\left\\|\\mathbf{G}_{\\mathrm{N}}(\\Delta t)\\right\\|_{2}} \\, ,\n$$\nand report its value. This ratio measures how much larger the single-step transient amplification of the more non-normal scheme is, compared to the normal scheme, under the same $\\Delta t$ and identical eigenvalues.\n\nRound your final answer to $4$ significant figures. The ratio is dimensionless; do not include any units.",
            "solution": "The user wants me to solve a problem in the field of numerical analysis. This is a good fit for my persona as a STEM professor.\n\n### Problem Validation\n\nI will first validate the problem statement according to the specified procedure.\n\n#### Step 1: Extract Givens\n\nThe givens are:\n- The semi-discrete system is $\\frac{d\\mathbf{y}}{dt} = \\mathbf{A}\\,\\mathbf{y}$.\n- The matrix $\\mathbf{A}$ is in $\\mathbb{R}^{2 \\times 2}$.\n- The time integration scheme is the one-step explicit Euler method.\n- The amplification operator is $\\mathbf{G}(\\Delta t) = \\mathbf{I} + \\Delta t\\,\\mathbf{A}$.\n- The normal matrix for the first scheme is $\\mathbf{A}_{\\mathrm{N}} = \\begin{pmatrix} -2 & 0 \\\\ 0 & -1 \\end{pmatrix}$.\n- The non-normal matrix for the second scheme is $\\mathbf{A}_{\\mathrm{NN}} = \\mathbf{S}\\,\\mathbf{A}_{\\mathrm{N}}\\,\\mathbf{S}^{-1}$.\n- The similarity transformation matrix is $\\mathbf{S} = \\begin{pmatrix} 1 & \\kappa \\\\ 0 & 1 \\end{pmatrix}$ with $\\kappa > 0$.\n- The amplification operator for the normal scheme is $\\mathbf{G}_{\\mathrm{N}}(\\Delta t) = \\mathbf{I} + \\Delta t\\,\\mathbf{A}_{\\mathrm{N}}$.\n- The amplification operator for the non-normal scheme is $\\mathbf{G}_{\\mathrm{NN}}(\\Delta t) = \\mathbf{I} + \\Delta t\\,\\mathbf{A}_{\\mathrm{NN}} = \\mathbf{S}\\,\\mathbf{G}_{\\mathrm{N}}(\\Delta t)\\,\\mathbf{S}^{-1}$.\n- The specific time step is $\\Delta t = 0.3$.\n- The specific non-normality parameter is $\\kappa = 2$.\n- The norm to be used is the induced Euclidean operator norm (matrix $2$-norm), denoted as $\\|\\cdot\\|_{2}$.\n- The objective is to compute the ratio $\\mathcal{R} \\equiv \\frac{\\left\\|\\mathbf{G}_{\\mathrm{NN}}(\\Delta t)\\right\\|_{2}}{\\left\\|\\mathbf{G}_{\\mathrm{N}}(\\Delta t)\\right\\|_{2}}$.\n- The final answer must be rounded to $4$ significant figures.\n\n#### Step 2: Validate Using Extracted Givens\n\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded**: The problem is a canonical example in numerical analysis and the study of stability for ordinary differential equations, accurately representing the impact of matrix non-normality on transient amplification. The concepts of amplification operators, matrix norms, and similarity transformations are fundamental in this field. The problem is scientifically sound.\n- **Well-Posed**: The problem is fully specified. All matrices, parameters ($\\Delta t$, $\\kappa$), and the norm to be used are explicitly defined. The objective is to compute a single, well-defined numerical ratio. A unique solution exists and is obtainable through direct calculation.\n- **Objective**: The problem is formulated using precise, unambiguous mathematical language and contains no subjective or opinion-based statements.\n- The problem does not exhibit any of the flaws listed in the prompt (e.g., incompleteness, contradiction, infeasibility, etc.). The construction $\\mathbf{A}_{\\mathrm{NN}} = \\mathbf{S}\\,\\mathbf{A}_{\\mathrm{N}}\\,\\mathbf{S}^{-1}$ correctly ensures that $\\mathbf{A}_{\\mathrm{N}}$ and $\\mathbf{A}_{\\mathrm{NN}}$ have identical eigenvalues, which is central to the problem's conceptual point.\n\n#### Step 3: Verdict and Action\n\nThe problem is **valid**. I will proceed with a full solution.\n\n### Solution\n\nThe objective is to compute the ratio $\\mathcal{R} = \\frac{\\left\\|\\mathbf{G}_{\\mathrm{NN}}(\\Delta t)\\right\\|_{2}}{\\left\\|\\mathbf{G}_{\\mathrm{N}}(\\Delta t)\\right\\|_{2}}$ with the given parameters $\\Delta t = 0.3$ and $\\kappa = 2$.\n\nFirst, we analyze the normal scheme. The amplification operator is $\\mathbf{G}_{\\mathrm{N}}(\\Delta t) = \\mathbf{I} + \\Delta t\\,\\mathbf{A}_{\\mathrm{N}}$.\nSubstituting the given values $\\mathbf{A}_{\\mathrm{N}} = \\begin{pmatrix} -2 & 0 \\\\ 0 & -1 \\end{pmatrix}$ and $\\Delta t = 0.3$:\n$$\n\\mathbf{G}_{\\mathrm{N}}(0.3) = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + 0.3 \\begin{pmatrix} -2 & 0 \\\\ 0 & -1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\begin{pmatrix} -0.6 & 0 \\\\ 0 & -0.3 \\end{pmatrix} = \\begin{pmatrix} 0.4 & 0 \\\\ 0 & 0.7 \\end{pmatrix}\n$$\nThe matrix $\\mathbf{G}_{\\mathrm{N}}(0.3)$ is a diagonal matrix, and therefore a normal matrix. The $2$-norm of a normal matrix is equal to its spectral radius, which is the maximum of the absolute values of its eigenvalues. The eigenvalues of $\\mathbf{G}_{\\mathrm{N}}(0.3)$ are its diagonal entries, $0.4$ and $0.7$.\nThus, the norm of $\\mathbf{G}_{\\mathrm{N}}(0.3)$ is:\n$$\n\\left\\|\\mathbf{G}_{\\mathrm{N}}(0.3)\\right\\|_{2} = \\rho(\\mathbf{G}_{\\mathrm{N}}(0.3)) = \\max(|0.4|, |0.7|) = 0.7\n$$\n\nNext, we analyze the non-normal scheme. The amplification operator is $\\mathbf{G}_{\\mathrm{NN}}(\\Delta t) = \\mathbf{S}\\,\\mathbf{G}_{\\mathrm{N}}(\\Delta t)\\,\\mathbf{S}^{-1}$.\nFirst, we construct the matrices $\\mathbf{S}$ and $\\mathbf{S}^{-1}$ for $\\kappa = 2$:\n$$\n\\mathbf{S} = \\begin{pmatrix} 1 & 2 \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe determinant of $\\mathbf{S}$ is $\\det(\\mathbf{S}) = (1)(1) - (2)(0) = 1$. The inverse is:\n$$\n\\mathbf{S}^{-1} = \\frac{1}{1} \\begin{pmatrix} 1 & -2 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & -2 \\\\ 0 & 1 \\end{pmatrix}\n$$\nNow, we compute $\\mathbf{G}_{\\mathrm{NN}}(0.3)$:\n$$\n\\mathbf{G}_{\\mathrm{NN}}(0.3) = \\mathbf{S}\\,\\mathbf{G}_{\\mathrm{N}}(0.3)\\,\\mathbf{S}^{-1} = \\begin{pmatrix} 1 & 2 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0.4 & 0 \\\\ 0 & 0.7 \\end{pmatrix} \\begin{pmatrix} 1 & -2 \\\\ 0 & 1 \\end{pmatrix}\n$$\nPerforming the matrix multiplication step-by-step:\n$$\n\\mathbf{G}_{\\mathrm{NN}}(0.3) = \\left( \\begin{pmatrix} 1 & 2 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0.4 & 0 \\\\ 0 & 0.7 \\end{pmatrix} \\right) \\begin{pmatrix} 1 & -2 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0.4 & 1.4 \\\\ 0 & 0.7 \\end{pmatrix} \\begin{pmatrix} 1 & -2 \\\\ 0 & 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{G}_{\\mathrm{NN}}(0.3) = \\begin{pmatrix} (0.4)(1) + (1.4)(0) & (0.4)(-2) + (1.4)(1) \\\\ (0)(1) + (0.7)(0) & (0)(-2) + (0.7)(1) \\end{pmatrix} = \\begin{pmatrix} 0.4 & 0.6 \\\\ 0 & 0.7 \\end{pmatrix}\n$$\nThe matrix $\\mathbf{G}_{\\mathrm{NN}}(0.3)$ is non-normal. Its $2$-norm is given by $\\|\\mathbf{G}_{\\mathrm{NN}}\\|_{2} = \\sqrt{\\lambda_{\\max}(\\mathbf{G}_{\\mathrm{NN}}^{T}\\mathbf{G}_{\\mathrm{NN}})}$, where $\\lambda_{\\max}$ is the largest eigenvalue of the matrix $\\mathbf{G}_{\\mathrm{NN}}^{T}\\mathbf{G}_{\\mathrm{NN}}$.\nFirst, we compute $\\mathbf{G}_{\\mathrm{NN}}^{T}\\mathbf{G}_{\\mathrm{NN}}$:\n$$\n\\mathbf{G}_{\\mathrm{NN}}^{T} = \\begin{pmatrix} 0.4 & 0 \\\\ 0.6 & 0.7 \\end{pmatrix}\n$$\n$$\n\\mathbf{G}_{\\mathrm{NN}}^{T}\\mathbf{G}_{\\mathrm{NN}} = \\begin{pmatrix} 0.4 & 0 \\\\ 0.6 & 0.7 \\end{pmatrix} \\begin{pmatrix} 0.4 & 0.6 \\\\ 0 & 0.7 \\end{pmatrix} = \\begin{pmatrix} 0.4^2 & (0.4)(0.6) \\\\ (0.6)(0.4) & 0.6^2 + 0.7^2 \\end{pmatrix} = \\begin{pmatrix} 0.16 & 0.24 \\\\ 0.24 & 0.36 + 0.49 \\end{pmatrix} = \\begin{pmatrix} 0.16 & 0.24 \\\\ 0.24 & 0.85 \\end{pmatrix}\n$$\nNext, we find the eigenvalues $\\lambda$ of $\\mathbf{G}_{\\mathrm{NN}}^{T}\\mathbf{G}_{\\mathrm{NN}}$ by solving the characteristic equation $\\det(\\mathbf{G}_{\\mathrm{NN}}^{T}\\mathbf{G}_{\\mathrm{NN}} - \\lambda\\mathbf{I}) = 0$.\n$$\n\\det\\begin{pmatrix} 0.16-\\lambda & 0.24 \\\\ 0.24 & 0.85-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(0.16 - \\lambda)(0.85 - \\lambda) - (0.24)^2 = 0\n$$\n$$\n\\lambda^2 - (0.16 + 0.85)\\lambda + (0.16)(0.85) - 0.0576 = 0\n$$\n$$\n\\lambda^2 - 1.01\\lambda + 0.136 - 0.0576 = 0\n$$\n$$\n\\lambda^2 - 1.01\\lambda + 0.0784 = 0\n$$\nUsing the quadratic formula $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\n\\lambda = \\frac{1.01 \\pm \\sqrt{(-1.01)^2 - 4(1)(0.0784)}}{2} = \\frac{1.01 \\pm \\sqrt{1.0201 - 0.3136}}{2} = \\frac{1.01 \\pm \\sqrt{0.7065}}{2}\n$$\nThe largest eigenvalue is $\\lambda_{\\max} = \\frac{1.01 + \\sqrt{0.7065}}{2}$.\nNumerically, $\\sqrt{0.7065} \\approx 0.8405355$.\n$$\n\\lambda_{\\max} \\approx \\frac{1.01 + 0.8405355}{2} = \\frac{1.8505355}{2} \\approx 0.92526775\n$$\nThe $2$-norm of $\\mathbf{G}_{\\mathrm{NN}}(0.3)$ is the square root of $\\lambda_{\\max}$:\n$$\n\\left\\|\\mathbf{G}_{\\mathrm{NN}}(0.3)\\right\\|_{2} = \\sqrt{\\lambda_{\\max}} \\approx \\sqrt{0.92526775} \\approx 0.9619084\n$$\nFinally, we compute the ratio $\\mathcal{R}$:\n$$\n\\mathcal{R} = \\frac{\\left\\|\\mathbf{G}_{\\mathrm{NN}}(0.3)\\right\\|_{2}}{\\left\\|\\mathbf{G}_{\\mathrm{N}}(0.3)\\right\\|_{2}} \\approx \\frac{0.9619084}{0.7} \\approx 1.3741548\n$$\nRounding the result to $4$ significant figures, we get $1.374$.",
            "answer": "$$\n\\boxed{1.374}\n$$"
        },
        {
            "introduction": "The principles of stability analysis are not merely for diagnosis; they are powerful tools for design. This hands-on problem tackles a practical challenge in incompressible flow solvers: the suppression of spurious pressure \"checkerboard\" modes that arise on collocated grids . You will use Fourier analysis to design a Laplacian smoothing filter, determining the precise smoothing coefficient $\\gamma$ that eliminates the highest-frequency numerical error while satisfying the physical constraint of non-overdamping, thereby engineering a more robust scheme.",
            "id": "3943363",
            "problem": "Consider a collocated pressure-velocity formulation in Computational Fluid Dynamics (CFD) for incompressible flow on a uniform, rectangular, two-dimensional grid with spacings $\\Delta x$ and $\\Delta y$. To suppress spurious pressure checkerboard modes without altering the low-wavenumber pressure content, a Laplacian smoothing step is applied to the pressure field as\n$$\np^{(n+1)}_{i,j} \\;=\\; p^{(n)}_{i,j} \\;+\\; \\gamma \\left[\\frac{p^{(n)}_{i+1,j} - 2\\,p^{(n)}_{i,j} + p^{(n)}_{i-1,j}}{\\Delta x^{2}} \\;+\\; \\frac{p^{(n)}_{i,j+1} - 2\\,p^{(n)}_{i,j} + p^{(n)}_{i,j-1}}{\\Delta y^{2}}\\right],\n$$\nwhere $\\gamma$ is a real, nonnegative smoothing coefficient with dimensions of area, and $n$ is a smoothing iteration index. Assume periodic boundary conditions and analyze the action of this smoothing step on Fourier pressure modes using Von Neumann analysis. Let the pressure be decomposed into plane waves of the form\n$$\np^{(n)}_{i,j} \\;=\\; \\hat{p}^{(n)} \\,\\exp\\!\\big(\\mathrm{i}(k_x\\,i\\,\\Delta x \\;+\\; k_y\\,j\\,\\Delta y)\\big),\n$$\nwhere $k_x$ and $k_y$ are the wavenumbers and all angles are to be interpreted in radians.\n\nTask A: Derive the amplification factor $G(k_x,k_y;\\gamma)$ of the smoothing operator for these Fourier modes as a function of $k_x$, $k_y$, and $\\gamma$.\n\nTask B: Define the checkerboard pressure mode as the highest-frequency alternating mode in both directions, i.e., $k_x \\,\\Delta x = \\pi$ and $k_y \\,\\Delta y = \\pi$. Impose the stabilization criterion that the checkerboard amplitude is eliminated in one smoothing step, and the non-overdamping criterion that the amplification factor for every wavenumber pair satisfies $G(k_x,k_y;\\gamma) \\ge 0$. Under these criteria, determine the smallest admissible smoothing coefficient $\\gamma_{\\min}$ that stabilizes the checkerboard without overdamping. Express $\\gamma_{\\min}$ in terms of $\\Delta x$ and $\\Delta y$.\n\nProvide the final answer as a single closed-form symbolic expression for $\\gamma_{\\min}$. Express $\\gamma_{\\min}$ in square meters. No numerical evaluation or rounding is required.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- **Governing Equation:** The pressure smoothing step is given by:\n$$\np^{(n+1)}_{i,j} \\;=\\; p^{(n)}_{i,j} \\;+\\; \\gamma \\left[\\frac{p^{(n)}_{i+1,j} - 2\\,p^{(n)}_{i,j} + p^{(n)}_{i-1,j}}{\\Delta x^{2}} \\;+\\; \\frac{p^{(n)}_{i,j+1} - 2\\,p^{(n)}_{i,j} + p^{(n)}_{i,j-1}}{\\Delta y^{2}}\\right]\n$$\n- **Grid:** Uniform, rectangular, two-dimensional grid with spacings $\\Delta x$ and $\\Delta y$.\n- **Smoothing Coefficient ($\\gamma$):** A real, nonnegative coefficient with dimensions of area.\n- **Iteration Index:** $n$.\n- **Boundary Conditions:** Periodic.\n- **Fourier Mode Decomposition:** A pressure plane wave is of the form:\n$$\np^{(n)}_{i,j} \\;=\\; \\hat{p}^{(n)} \\,\\exp\\!\\big(\\mathrm{i}(k_x\\,i\\,\\Delta x \\;+\\; k_y\\,j\\,\\Delta y)\\big)\n$$\n- **Wavenumbers:** $k_x$ and $k_y$.\n- **Task A:** Derive the amplification factor $G(k_x,k_y;\\gamma)$.\n- **Task B:**\n  - **Checkerboard Mode Definition:** $k_x \\,\\Delta x = \\pi$ and $k_y \\,\\Delta y = \\pi$.\n  - **Stabilization Criterion:** The checkerboard amplitude is eliminated in one smoothing step.\n  - **Non-overdamping Criterion:** The amplification factor for every wavenumber pair satisfies $G(k_x,k_y;\\gamma) \\ge 0$.\n  - **Objective:** Determine the smallest admissible smoothing coefficient $\\gamma_{\\min}$ in terms of $\\Delta x$ and $\\Delta y$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding:** The problem is scientifically sound. It describes a standard pressure smoothing technique used in collocated-grid formulations for incompressible CFD to damp high-frequency pressure oscillations (checkerboarding). The use of Von Neumann stability analysis is the canonical method for analyzing the behavior of finite difference schemes with respect to Fourier modes. The formulation is a discrete analogue of a diffusion or heat equation step, which is a well-understood process.\n- **Well-Posedness:** The problem is well-posed. It provides all necessary information: the numerical scheme, the form of the solution to be analyzed, and two clear, quantifiable criteria (one for stabilization, one for non-overdamping). These criteria are sufficient to determine a unique value for the requested coefficient $\\gamma_{\\min}$.\n- **Objectivity:** The problem is stated in precise, objective mathematical and physical terms. It is free from ambiguity and subjective claims.\n- **Conclusion:** All validation criteria are met. The problem is not flawed; it is a standard, well-defined problem in the field of numerical analysis for fluid dynamics.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived.\n\n### Solution Derivation\n\n**Task A: Derive the amplification factor $G(k_x,k_y;\\gamma)$**\n\nThe amplification factor $G$ is defined by the relation $p^{(n+1)} = G \\, p^{(n)}$, which for the Fourier amplitudes means $\\hat{p}^{(n+1)} = G \\, \\hat{p}^{(n)}$. We substitute the plane wave solution into the given smoothing equation.\n\nLet the Fourier mode be $p^{(n)}_{i,j} = \\hat{p}^{(n)} \\,\\exp(\\mathrm{i}(k_x i \\Delta x + k_y j \\Delta y))$.\nThe terms in the smoothing equation become:\n$p^{(n+1)}_{i,j} = \\hat{p}^{(n+1)} \\exp(\\mathrm{i}(k_x i \\Delta x + k_y j \\Delta y)) = G \\hat{p}^{(n)} \\exp(\\mathrm{i}(k_x i \\Delta x + k_y j \\Delta y))$\n$p^{(n)}_{i \\pm 1, j} = \\hat{p}^{(n)} \\exp(\\mathrm{i}(k_x (i \\pm 1) \\Delta x + k_y j \\Delta y)) = p^{(n)}_{i,j} \\exp(\\pm \\mathrm{i} k_x \\Delta x)$\n$p^{(n)}_{i, j \\pm 1} = \\hat{p}^{(n)} \\exp(\\mathrm{i}(k_x i \\Delta x + k_y (j \\pm 1) \\Delta y)) = p^{(n)}_{i,j} \\exp(\\pm \\mathrm{i} k_y \\Delta y)$\n\nSubstituting these into the smoothing equation:\n$$\nG p^{(n)}_{i,j} = p^{(n)}_{i,j} + \\gamma \\left[ \\frac{p^{(n)}_{i,j}(\\exp(\\mathrm{i}k_x\\Delta x) - 2 + \\exp(-\\mathrm{i}k_x\\Delta x))}{\\Delta x^2} + \\frac{p^{(n)}_{i,j}(\\exp(\\mathrm{i}k_y\\Delta y) - 2 + \\exp(-\\mathrm{i}k_y\\Delta y))}{\\Delta y^2} \\right]\n$$\nDividing by $p^{(n)}_{i,j}$ (which is non-zero) yields the expression for $G$:\n$$\nG = 1 + \\gamma \\left[ \\frac{\\exp(\\mathrm{i}k_x\\Delta x) + \\exp(-\\mathrm{i}k_x\\Delta x) - 2}{\\Delta x^2} + \\frac{\\exp(\\mathrm{i}k_y\\Delta y) + \\exp(-\\mathrm{i}k_y\\Delta y) - 2}{\\Delta y^2} \\right]\n$$\nUsing the Euler identity $\\cos(\\theta) = \\frac{\\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta)}{2}$, the terms in the brackets simplify:\n$$\n\\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta) - 2 = 2\\cos(\\theta) - 2 = -2(1-\\cos(\\theta))\n$$\nUsing the half-angle identity $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$, we get:\n$$\n-2(1-\\cos(\\theta)) = -4\\sin^2(\\frac{\\theta}{2})\n$$\nApplying this to our expression for $G$ with $\\theta_x = k_x\\Delta x$ and $\\theta_y = k_y\\Delta y$:\n$$\nG(k_x, k_y; \\gamma) = 1 + \\gamma \\left[ \\frac{-4\\sin^2(k_x \\Delta x / 2)}{\\Delta x^2} + \\frac{-4\\sin^2(k_y \\Delta y / 2)}{\\Delta y^2} \\right]\n$$\n$$\nG(k_x, k_y; \\gamma) = 1 - 4\\gamma \\left[ \\frac{\\sin^2(k_x \\Delta x / 2)}{\\Delta x^2} + \\frac{\\sin^2(k_y \\Delta y / 2)}{\\Delta y^2} \\right]\n$$\nThis is the amplification factor for the smoothing operator.\n\n**Task B: Determine the smallest admissible smoothing coefficient $\\gamma_{\\min}$**\n\nWe are given two criteria to determine $\\gamma_{\\min}$.\n\n**1. Stabilization Criterion:** The checkerboard mode is eliminated in one step. This implies that for this specific mode, the amplification factor must be zero, $G_{\\text{cb}} = 0$. The checkerboard mode is defined by $k_x \\Delta x = \\pi$ and $k_y \\Delta y = \\pi$.\nLet's evaluate $G$ for this mode:\n$$\n\\frac{k_x \\Delta x}{2} = \\frac{\\pi}{2} \\quad \\implies \\quad \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) = \\sin^2\\left(\\frac{\\pi}{2}\\right) = 1^2 = 1\n$$\n$$\n\\frac{k_y \\Delta y}{2} = \\frac{\\pi}{2} \\quad \\implies \\quad \\sin^2\\left(\\frac{k_y \\Delta y}{2}\\right) = \\sin^2\\left(\\frac{\\pi}{2}\\right) = 1^2 = 1\n$$\nSubstituting these into the expression for $G$:\n$$\nG_{\\text{cb}} = 1 - 4\\gamma \\left[ \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} \\right]\n$$\nSetting $G_{\\text{cb}} = 0$ to satisfy the elimination criterion:\n$$\n0 = 1 - 4\\gamma \\left[ \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} \\right]\n$$\n$$\n1 = 4\\gamma \\left( \\frac{\\Delta y^2 + \\Delta x^2}{\\Delta x^2 \\Delta y^2} \\right)\n$$\nSolving for $\\gamma$ gives the specific value required to eliminate the checkerboard mode:\n$$\n\\gamma = \\frac{\\Delta x^2 \\Delta y^2}{4(\\Delta x^2 + \\Delta y^2)}\n$$\n\n**2. Non-overdamping Criterion:** The amplification factor must be non-negative for all possible wavenumber pairs, i.e., $G(k_x, k_y; \\gamma) \\ge 0$.\n$$\n1 - 4\\gamma \\left[ \\frac{\\sin^2(k_x \\Delta x / 2)}{\\Delta x^2} + \\frac{\\sin^2(k_y \\Delta y / 2)}{\\Delta y^2} \\right] \\ge 0\n$$\n$$\n1 \\ge 4\\gamma \\left[ \\frac{\\sin^2(k_x \\Delta x / 2)}{\\Delta x^2} + \\frac{\\sin^2(k_y \\Delta y / 2)}{\\Delta y^2} \\right]\n$$\nSince $\\gamma$ is non-negative, this inequality must hold for the choice of $k_x$ and $k_y$ that maximizes the term in the brackets. The function $\\sin^2(\\theta/2)$ is always non-negative and its maximum value is $1$. This maximum occurs when $\\theta/2 = \\pi/2$ (or more generally $\\pi/2 + m\\pi$ for integer $m$), which corresponds to $\\theta = \\pi$. Thus, the term is maximized for the highest frequency modes, i.e., the checkerboard mode where $k_x \\Delta x = \\pi$ and $k_y \\Delta y = \\pi$.\nThe maximum value of the bracketed expression is:\n$$\n\\max \\left[ \\frac{\\sin^2(k_x \\Delta x / 2)}{\\Delta x^2} + \\frac{\\sin^2(k_y \\Delta y / 2)}{\\Delta y^2} \\right] = \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2}\n$$\nThe non-overdamping condition is most restrictive for this mode, requiring:\n$$\n1 \\ge 4\\gamma \\left( \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} \\right)\n$$\nThis imposes an upper bound on $\\gamma$:\n$$\n\\gamma \\le \\frac{1}{4 \\left( \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} \\right)} = \\frac{\\Delta x^2 \\Delta y^2}{4(\\Delta x^2 + \\Delta y^2)}\n$$\nThe problem asks for the smallest admissible $\\gamma_{\\min}$ that satisfies *both* the stabilization and non-overdamping criteria.\n- The stabilization criterion requires $\\gamma$ to be exactly $\\frac{\\Delta x^2 \\Delta y^2}{4(\\Delta x^2 + \\Delta y^2)}$.\n- The non-overdamping criterion requires $\\gamma$ to be less than or equal to this same value.\n\nThe only value that satisfies both constraints simultaneously is this specific value. Any smaller value of $\\gamma$ would result in $G_{\\text{cb}} > 0$, failing to eliminate the mode completely. Any larger value would result in $G_{\\text{cb}} < 0$, violating the non-overdamping criterion. Therefore, the unique admissible coefficient is:\n$$\n\\gamma_{\\min} = \\frac{\\Delta x^2 \\Delta y^2}{4(\\Delta x^2 + \\Delta y^2)}\n$$\nThe dimensions of $\\Delta x$ and $\\Delta y$ are length. The dimensions of $\\gamma_{\\min}$ are $($length$^2 \\times$ length$^2) / ($length$^2) = $ length$^2$, which is area, consistent with the problem statement. The problem asks for the answer in square meters, but since $\\Delta x$ and $\\Delta y$ are symbolic, the expression itself represents the value in the appropriate units (e.g., square meters if $\\Delta x$ and $\\Delta y$ are in meters).",
            "answer": "$$\\boxed{\\frac{\\Delta x^{2} \\Delta y^{2}}{4(\\Delta x^{2} + \\Delta y^{2})}}$$"
        }
    ]
}