{
    "hands_on_practices": [
        {
            "introduction": "To build a robust solver, we must first understand its behavior on fundamental problems. This exercise guides you through the stability and convergence analysis of pseudo-transient continuation for the classic 1D advection-diffusion equation . By deriving the stability limit for an explicit scheme and comparing the modal damping rates of explicit and implicit methods, you will gain a foundational understanding of the numerical properties that govern the performance of PTC.",
            "id": "3987768",
            "problem": "Consider the one-dimensional steady advection–diffusion equation for a passive scalar $u(x)$ with constant advection speed $a>0$ and kinematic diffusivity $\\nu>0$,\n$$\na\\,\\frac{\\partial u}{\\partial x} - \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}} = 0,\n$$\nto be solved by Pseudo-Transient Continuation (PTC), in which a pseudo-time $\\tau$ is introduced and the unsteady relaxation equation\n$$\n\\frac{\\partial u}{\\partial \\tau} + a\\,\\frac{\\partial u}{\\partial x} - \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}} = 0\n$$\nis marched to steady state. Assume a uniform grid on a periodic domain of length $L$ with $N$ equally spaced points and spacing $h = L/N$. Discretize the convective derivative with first-order upwind (backward difference for $a>0$) and the diffusive derivative with second-order central differences. Let the pseudo-time stepping be either explicit forward Euler or implicit backward Euler.\n\nStarting from these definitions and the discrete balance of fluxes, perform the following:\n\n1. Derive the explicit forward Euler update for the interior grid points and enforce the positivity of its coefficients to obtain the explicit pseudo-time Courant–Friedrichs–Lewy (CFL) constraint in terms of the dimensionless convective and diffusive pseudo-CFLs,\n$$\n\\alpha = \\frac{a\\,\\Delta \\tau}{h}, \\qquad \\mu = \\frac{\\nu\\,\\Delta \\tau}{h^{2}},\n$$\nwhere $\\Delta \\tau$ is the pseudo-time step.\n\n2. Using $L = 1.0\\,\\text{m}$, $N = 100$, $a = 50\\,\\text{m}\\,\\text{s}^{-1}$, and $\\nu = 1.0\\times 10^{-2}\\,\\text{m}^{2}\\,\\text{s}^{-1}$, compute the maximum stable explicit pseudo-time step $\\Delta \\tau_{\\text{max}}$ in seconds.\n\n3. For the implicit backward Euler scheme, analyze the modal amplification of the highest-frequency Fourier mode (wavenumber $\\xi = \\pi$) and show that backward Euler is unconditionally stable for this linear discretization. To compare convergence rates fairly, set the implicit pseudo-time step equal to a fraction $\\theta$ of the explicit stability limit, i.e., $\\Delta \\tau = \\theta\\,\\Delta \\tau_{\\text{max}}$ with $\\theta = 0.9$.\n\n4. With this choice, compute the per-step amplification factor magnitude of the highest-frequency mode for both schemes, and then report the ratio of implicit-to-explicit amplification factor magnitudes for that mode. Express the final ratio as a pure number rounded to four significant figures.\n\nYour final answer must be a single real number: the ratio of the implicit-to-explicit per-step amplification magnitudes for the highest-frequency mode, rounded to four significant figures and reported without units.",
            "solution": "We begin from the pseudo-transient relaxation equation\n$$\n\\frac{\\partial u}{\\partial \\tau} + a\\,\\frac{\\partial u}{\\partial x} - \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}} = 0,\n$$\ndiscretized on a uniform grid $x_{j} = j h$ for $j = 0,1,\\dots,N-1$ with spacing $h = L/N$ and periodic boundary conditions. For $a>0$, the first-order upwind convection and second-order central diffusion at grid point $j$ are\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{j} \\approx \\frac{u_{j} - u_{j-1}}{h}, \\qquad \\left.\\frac{\\partial^{2}u}{\\partial x^{2}}\\right|_{j} \\approx \\frac{u_{j+1} - 2 u_{j} + u_{j-1}}{h^{2}}.\n$$\n\nExplicit forward Euler in pseudo-time gives\n$$\nu_{j}^{n+1} = u_{j}^{n} + \\Delta \\tau \\left[ -\\,a\\,\\frac{u_{j}^{n} - u_{j-1}^{n}}{h} + \\nu\\,\\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{h^{2}} \\right].\n$$\nCollecting coefficients,\n$$\nu_{j}^{n+1} = \\underbrace{\\left( 1 - \\frac{a\\,\\Delta \\tau}{h} - 2\\,\\frac{\\nu\\,\\Delta \\tau}{h^{2}} \\right)}_{\\text{center weight}} u_{j}^{n}\n+ \\underbrace{\\left( \\frac{a\\,\\Delta \\tau}{h} + \\frac{\\nu\\,\\Delta \\tau}{h^{2}} \\right)}_{\\text{left weight}} u_{j-1}^{n}\n+ \\underbrace{\\left( \\frac{\\nu\\,\\Delta \\tau}{h^{2}} \\right)}_{\\text{right weight}} u_{j+1}^{n}.\n$$\nDefining the dimensionless pseudo-CFLs\n$$\n\\alpha = \\frac{a\\,\\Delta \\tau}{h}, \\qquad \\mu = \\frac{\\nu\\,\\Delta \\tau}{h^{2}},\n$$\nthe update reads\n$$\nu_{j}^{n+1} = \\left( 1 - \\alpha - 2 \\mu \\right) u_{j}^{n} + \\left( \\alpha + \\mu \\right) u_{j-1}^{n} + \\mu\\,u_{j+1}^{n}.\n$$\nA monotone explicit scheme requires nonnegative coefficients that sum to one, yielding the constraints\n$$\n\\mu \\ge 0, \\qquad \\alpha + \\mu \\ge 0, \\qquad 1 - \\alpha - 2\\mu \\ge 0.\n$$\nThus the explicit pseudo-time CFL condition is\n$$\n\\alpha + 2 \\mu \\le 1.\n$$\n\nFor the given parameters $L = 1.0\\,\\text{m}$, $N = 100$, $a = 50\\,\\text{m}\\,\\text{s}^{-1}$, and $\\nu = 1.0\\times 10^{-2}\\,\\text{m}^{2}\\,\\text{s}^{-1}$, the grid spacing is\n$$\nh = \\frac{L}{N} = \\frac{1.0}{100} = 1.0 \\times 10^{-2}\\,\\text{m}.\n$$\nSaturating the explicit stability boundary $\\alpha + 2\\mu = 1$ gives\n$$\n\\frac{a\\,\\Delta \\tau_{\\text{max}}}{h} + 2\\,\\frac{\\nu\\,\\Delta \\tau_{\\text{max}}}{h^{2}} = 1,\n$$\nso\n$$\n\\Delta \\tau_{\\text{max}} = \\frac{1}{\\dfrac{a}{h} + 2\\,\\dfrac{\\nu}{h^{2}}}.\n$$\nSubstituting values,\n$$\n\\frac{a}{h} = \\frac{50}{1.0\\times 10^{-2}} = 5.0 \\times 10^{3}\\,\\text{s}^{-1}, \\qquad \\frac{\\nu}{h^{2}} = \\frac{1.0\\times 10^{-2}}{(1.0\\times 10^{-2})^{2}} = 1.0 \\times 10^{2}\\,\\text{s}^{-1},\n$$\nhence\n$$\n\\Delta \\tau_{\\text{max}} = \\frac{1}{5.0 \\times 10^{3} + 2 \\times 1.0 \\times 10^{2}} = \\frac{1}{5.2 \\times 10^{3}} \\approx 1.923076923 \\times 10^{-4}\\,\\text{s}.\n$$\n\nWe now compare convergence rates via modal amplification. On a periodic grid, consider a Fourier mode $u_{j}^{n} = \\hat{u}^{n} \\exp(i \\xi j)$ with wavenumber $\\xi \\in [0,\\pi]$. The explicit update can be written in terms of the amplification factor $G_{\\text{exp}}(\\xi)$ as\n$$\nu_{j}^{n+1} = G_{\\text{exp}}(\\xi)\\,u_{j}^{n}, \\qquad G_{\\text{exp}}(\\xi) = 1 - \\alpha - 2\\mu + (\\alpha + \\mu)\\,\\exp(-i \\xi) + \\mu\\,\\exp(i \\xi).\n$$\nFor the highest-frequency mode $\\xi = \\pi$,\n$$\n\\exp(i \\pi) = \\exp(-i \\pi) = -1,\n$$\nso\n$$\nG_{\\text{exp}}(\\pi) = 1 - \\alpha - 2 \\mu - (\\alpha + \\mu) - \\mu = 1 - 2\\alpha - 4\\mu = 1 - 2(\\alpha + 2\\mu).\n$$\nAt a fraction $\\theta$ of the explicit limit, define\n$$\n\\theta = \\alpha + 2 \\mu, \\qquad \\Delta \\tau = \\theta\\,\\Delta \\tau_{\\text{max}}, \\qquad \\theta \\in (0,1).\n$$\nThen\n$$\nG_{\\text{exp}}(\\pi) = 1 - 2 \\theta, \\qquad |G_{\\text{exp}}(\\pi)| = |1 - 2 \\theta|.\n$$\n\nFor backward Euler applied to $\\partial u/\\partial \\tau = -L u$ with spatial discrete operator $L$, the error amplification for a mode with eigenvalue $\\lambda(\\xi)$ is\n$$\nG_{\\text{imp}}(\\xi) = \\frac{1}{1 + \\Delta \\tau\\,\\lambda(\\xi)}.\n$$\nThe discrete operator symbol for upwind convection plus central diffusion is\n$$\n\\lambda(\\xi) = \\frac{a}{h}\\left(1 - \\exp(-i \\xi)\\right) + \\frac{\\nu}{h^{2}}\\left(2 - \\exp(i \\xi) - \\exp(-i \\xi)\\right).\n$$\nAt $\\xi = \\pi$, $\\sin(\\pi) = 0$ and $\\cos(\\pi) = -1$, hence\n$$\n\\lambda(\\pi) = \\frac{a}{h}\\left(1 - (-1)\\right) + \\frac{\\nu}{h^{2}}\\left(2 - (-1) - (-1)\\right) = \\frac{2 a}{h} + \\frac{4 \\nu}{h^{2}}.\n$$\nTherefore,\n$$\n\\Delta \\tau\\,\\lambda(\\pi) = \\Delta \\tau \\left( \\frac{2 a}{h} + \\frac{4 \\nu}{h^{2}} \\right) = 2 \\alpha + 4 \\mu = 2(\\alpha + 2\\mu) = 2 \\theta,\n$$\nand the implicit amplification for the highest-frequency mode is\n$$\n|G_{\\text{imp}}(\\pi)| = \\frac{1}{1 + 2 \\theta}.\n$$\nBackward Euler is unconditionally stable because for all modes the real part of $\\lambda(\\xi)$ is nonnegative (due to upwind convection and central diffusion), and $|G_{\\text{imp}}(\\xi)| = 1/|1 + \\Delta \\tau\\,\\lambda(\\xi)| \\le 1$ for any $\\Delta \\tau > 0$.\n\nWith $\\theta = 0.9$, the explicit and implicit high-frequency amplification magnitudes are\n$$\n|G_{\\text{exp}}(\\pi)| = |1 - 2(0.9)| = |1 - 1.8| = 0.8,\n$$\n$$\n|G_{\\text{imp}}(\\pi)| = \\frac{1}{1 + 2(0.9)} = \\frac{1}{2.8} \\approx 0.357142857.\n$$\nThe requested ratio of implicit-to-explicit amplification magnitudes for the highest-frequency mode is\n$$\n\\frac{|G_{\\text{imp}}(\\pi)|}{|G_{\\text{exp}}(\\pi)|} = \\frac{1/(1 + 2 \\theta)}{|1 - 2 \\theta|} \\bigg|_{\\theta = 0.9} = \\frac{1/2.8}{0.8} = \\frac{1}{2.24} \\approx 0.446428571.\n$$\nRounded to four significant figures, this ratio is\n$$\n0.4464.\n$$\nThis quantifies that, at $90\\%$ of the explicit stability limit, the implicit backward Euler damps the highest-frequency mode approximately $0.4464$ times as much per step as the explicit forward Euler scheme, i.e., implicit achieves stronger damping per step for that mode under the same pseudo-time step fraction of the explicit limit.",
            "answer": "$$\\boxed{0.4464}$$"
        },
        {
            "introduction": "While simple pseudo-time stepping is easy to implement, its performance can be poor for the stiff systems common in CFD. This practice problem explores the theoretical underpinnings of this limitation by first proving that a scalar pseudo-mass matrix is equivalent to a simple time-rescaling . You will then quantify how convergence degrades as the system's condition number grows, providing a clear justification for the necessity of advanced preconditioning.",
            "id": "3987831",
            "problem": "In steady computational fluid dynamics (CFD), one seeks a state vector $u$ such that the discrete residual $F(u) = 0$. Pseudo-transient continuation introduces a pseudo-time $\\tau$ to regularize and accelerate convergence by augmenting the steady system to the pseudo-time initial-value problem\n$$\nM(u)\\,\\frac{du}{d\\tau} + F(u) = 0,\n$$\nwhere $M(u)$ is a positive-definite mass-like operator. Consider the following two-part task grounded in this formulation.\n\nPart A: Prove from first principles that if one chooses a scalar mass matrix $M(u) = \\gamma I$ with $\\gamma > 0$, then this choice is equivalent to a uniform rescaling of the pseudo-time. Concretely, show that there exists a change of variable $\\tilde{\\tau} = \\tilde{\\tau}(\\tau)$ such that the pseudo-transient evolution with $M(u)=\\gamma I$ is identical to the evolution obtained with $M(u)=I$ but expressed in the rescaled pseudo-time $\\tilde{\\tau}$.\n\nPart B: To analyze the effect of this choice on a highly stretched grid, consider a linearization about the steady state $u^{\\ast}$ where $F(u^{\\ast})=0$ and $J \\equiv \\left.\\frac{\\partial F}{\\partial u}\\right|_{u^{\\ast}}$ is diagonalizable with a real spectrum contained in the interval $[\\alpha,\\beta]$ with $0\\alpha\\le\\beta$. Define the error $e(\\tau) = u(\\tau) - u^{\\ast}$ so that the linearized pseudo-transient system reads\n$$\nM\\,\\frac{de}{d\\tau} + J e = 0.\n$$\nConsider a single explicit Euler pseudo-time step of size $\\Delta \\tau>0$, yielding the iteration\n$$\ne^{k+1} = \\left(I - \\Delta \\tau\\,M^{-1} J\\right)\\,e^{k}.\n$$\nAssume $M=\\gamma I$ and define $s = \\Delta \\tau/\\gamma$. Using only these assumptions and the spectral bounds $[\\alpha,\\beta]$, determine the minimal possible worst-case single-step contraction factor of this iteration, defined as\n$$\n\\rho_{\\min} \\equiv \\min_{s>0}\\;\\max_{\\lambda\\in[\\alpha,\\beta]}\\; |1 - s\\lambda|.\n$$\nGive your final answer as a closed-form analytical expression in terms of $\\alpha$ and $\\beta$ only. Explain briefly why this quantifies the suboptimality of the scalar choice $M=\\gamma I$ on highly stretched grids, where the condition number $\\kappa = \\beta/\\alpha$ is large. The final answer must be the expression for $\\rho_{\\min}$ only, with no units required.",
            "solution": "This problem is divided into two parts. Part A requires a proof concerning the role of a scalar mass matrix in pseudo-transient continuation. Part B requires the solution of a minimax problem to find the optimal single-step contraction factor for a linearized system with a scalar mass matrix.\n\nPart A: Proof of Equivalence to Time Rescaling\n\nWe are given the pseudo-transient initial-value problem:\n$$\nM(u)\\,\\frac{du}{d\\tau} + F(u) = 0\n$$\nWe are asked to consider the case where the mass matrix is a scalar multiple of the identity matrix, $M(u) = \\gamma I$, with the constant $\\gamma  0$. The equation becomes:\n$$\n\\gamma I\\,\\frac{du}{d\\tau} + F(u) = 0\n$$\nSince $I$ is the identity operator, we can write this as:\n$$\n\\gamma \\frac{du}{d\\tau} = -F(u)\n$$\nor\n$$\n\\frac{du}{d\\tau} = -\\frac{1}{\\gamma} F(u) \\quad (\\*_1)\n$$\nWe want to show that this evolution is identical to the one obtained with a mass matrix $M(u)=I$, but expressed in a rescaled pseudo-time $\\tilde{\\tau}$. The evolution equation for $M(u)=I$ is:\n$$\nI\\,\\frac{du}{d\\tilde{\\tau}} + F(u) = 0\n$$\nwhich simplifies to:\n$$\n\\frac{du}{d\\tilde{\\tau}} = -F(u) \\quad (\\*_2)\n$$\nTo show the equivalence, we propose a change of variables from $\\tau$ to $\\tilde{\\tau} = \\tilde{\\tau}(\\tau)$. Using the chain rule for differentiation, we can relate the derivatives with respect to $\\tau$ and $\\tilde{\\tau}$:\n$$\n\\frac{du}{d\\tau} = \\frac{du}{d\\tilde{\\tau}} \\frac{d\\tilde{\\tau}}{d\\tau}\n$$\nSubstituting this into equation $(\\*_1)$:\n$$\n\\frac{du}{d\\tilde{\\tau}} \\frac{d\\tilde{\\tau}}{d\\tau} = -\\frac{1}{\\gamma} F(u)\n$$\nNow, we substitute the expression for $\\frac{du}{d\\tilde{\\tau}}$ from equation $(\\*_2)$:\n$$\n(-F(u)) \\frac{d\\tilde{\\tau}}{d\\tau} = -\\frac{1}{\\gamma} F(u)\n$$\nAssuming we are not yet at the steady state solution (i.e., $F(u) \\neq 0$), we can divide both sides by $-F(u)$:\n$$\n\\frac{d\\tilde{\\tau}}{d\\tau} = \\frac{1}{\\gamma}\n$$\nThis is a simple first-order ordinary differential equation for $\\tilde{\\tau}(\\tau)$. Integrating with respect to $\\tau$ gives:\n$$\n\\tilde{\\tau}(\\tau) = \\frac{1}{\\gamma} \\tau + C\n$$\nwhere $C$ is a constant of integration. We can set $C=0$ by defining the rescaled time such that $\\tilde{\\tau}=0$ when $\\tau=0$. Thus, we find the relationship:\n$$\n\\tilde{\\tau} = \\frac{\\tau}{\\gamma}\n$$\nThis proves that the system's evolution under a scalar mass matrix $M(u) = \\gamma I$ is identical to its evolution with $M(u)=I$ when viewed in the rescaled pseudo-time $\\tilde{\\tau} = \\tau/\\gamma$. The scalar factor $\\gamma$ simply accelerates ($\\gamma  1$) or decelerates ($\\gamma  1$) the evolution along the same trajectory in the state space.\n\nPart B: Optimal Contraction Factor\n\nWe are asked to find the minimal possible worst-case single-step contraction factor for an explicit Euler iteration on the linearized system. The iteration is given by:\n$$\ne^{k+1} = \\left(I - \\Delta \\tau\\,M^{-1} J\\right)\\,e^{k}\n$$\nWith $M = \\gamma I$, its inverse is $M^{-1} = \\frac{1}{\\gamma} I$. The iteration becomes:\n$$\ne^{k+1} = \\left(I - \\frac{\\Delta \\tau}{\\gamma} J\\right)\\,e^{k}\n$$\nDefining $s = \\Delta \\tau / \\gamma$, the amplification matrix is $G = I - sJ$. The contraction factor for a single step is determined by the spectral radius of $G$. Since $J$ is diagonalizable, its eigenvectors are also the eigenvectors of $G$. If $\\lambda$ is an eigenvalue of $J$, then $1 - s\\lambda$ is an eigenvalue of $G$. The single-step contraction factor is therefore $\\max_{\\lambda} |1 - s\\lambda|$, where the maximum is taken over all eigenvalues $\\lambda$ of $J$.\n\nWe are given that the real spectrum of $J$ is contained in the interval $[\\alpha, \\beta]$, where $0  \\alpha \\le \\beta$. The worst-case contraction factor for a given $s  0$ is:\n$$\n\\rho(s) = \\max_{\\lambda \\in [\\alpha, \\beta]} |1 - s\\lambda|\n$$\nWe want to find the minimal value of this factor by choosing the optimal $s  0$:\n$$\n\\rho_{\\min} = \\min_{s0} \\rho(s) = \\min_{s0} \\max_{\\lambda \\in [\\alpha, \\beta]} |1 - s\\lambda|\n$$\nLet $f(\\lambda) = 1 - s\\lambda$. For a fixed $s  0$, this is a linear, decreasing function of $\\lambda$. Therefore, the maximum of its absolute value, $|f(\\lambda)|$, on the closed interval $[\\alpha, \\beta]$ must occur at one of the endpoints, $\\lambda = \\alpha$ or $\\lambda = \\beta$.\n$$\n\\rho(s) = \\max \\left( |1 - s\\alpha|, |1 - s\\beta| \\right)\n$$\nWe seek to find $s^*  0$ that minimizes $\\rho(s)$. This is a classic minimax problem. The minimum value of the maximum of two functions typically occurs where the functions are equal in magnitude. Let's analyze the behavior of $|1-s\\alpha|$ and $|1-s\\beta|$ as functions of $s$. The optimal value $s^*$ will balance the damping of the slowest mode (associated with $\\alpha$) and the fastest mode (associated with $\\beta$). This balance is achieved when the magnitudes of the amplification factors for these two modes are equal:\n$$\n|1 - s^*\\alpha| = |1 - s^*\\beta|\n$$\nSince $s0$ and $\\beta \\ge \\alpha  0$, we have $s\\beta \\ge s\\alpha$. For the optimal $s^*$, it must lie between $1/\\beta$ and $1/\\alpha$ to balance the amplification factors, meaning $1-s^*\\beta \\le 0$ and $1-s^*\\alpha \\ge 0$. Thus, the equality becomes:\n$$\n1 - s^*\\alpha = -(1 - s^*\\beta) = s^*\\beta - 1\n$$\nSolving for $s^*$:\n$$\n2 = s^*\\alpha + s^*\\beta = s^*(\\alpha + \\beta)\n$$\n$$\ns^* = \\frac{2}{\\alpha + \\beta}\n$$\nNow we substitute this optimal value $s^*$ back into the expression for the contraction factor to find $\\rho_{\\min}$:\n$$\n\\rho_{\\min} = |1 - s^*\\alpha| = \\left|1 - \\frac{2\\alpha}{\\alpha + \\beta}\\right| = \\left|\\frac{\\alpha + \\beta - 2\\alpha}{\\alpha + \\beta}\\right| = \\left|\\frac{\\beta - \\alpha}{\\alpha + \\beta}\\right|\n$$\nSince $\\beta \\ge \\alpha  0$, the numerator is non-negative, so we can remove the absolute value signs:\n$$\n\\rho_{\\min} = \\frac{\\beta - \\alpha}{\\beta + \\alpha}\n$$\nWe can verify this using the other endpoint:\n$$\n\\rho_{\\min} = |1 - s^*\\beta| = \\left|1 - \\frac{2\\beta}{\\alpha + \\beta}\\right| = \\left|\\frac{\\alpha + \\beta - 2\\beta}{\\alpha + \\beta}\\right| = \\left|\\frac{\\alpha - \\beta}{\\alpha + \\beta}\\right| = \\frac{\\beta - \\alpha}{\\beta + \\alpha}\n$$\nThe results match, confirming our solution.\n\nThis result quantifies the suboptimality of the scalar choice $M=\\gamma I$ for problems with large condition numbers. The condition number of the Jacobian $J$ can be defined as $\\kappa = \\beta/\\alpha$. We can express $\\rho_{\\min}$ in terms of $\\kappa$:\n$\\rho_{\\min} = \\frac{\\beta/\\alpha - 1}{\\beta/\\alpha + 1} = \\frac{\\kappa - 1}{\\kappa + 1}$.\nOn highly stretched grids, the discretization leads to Jacobian matrices that are very stiff, meaning they have a wide spectrum of eigenvalues. This results in a very large condition number, $\\kappa \\gg 1$. As $\\kappa \\to \\infty$, the optimal contraction factor $\\rho_{\\min} \\to 1$. A contraction factor close to $1$ implies extremely slow convergence of the iterative method. This demonstrates that for ill-conditioned problems, which are common in aerospace CFD, the simple choice of a scalar mass matrix (which is equivalent to a simple relaxation scheme) is highly suboptimal. An effective pre-conditioner $M$ should be chosen to approximate $J$ in some sense, such that the eigenvalues of $M^{-1}J$ are clustered, making $\\kappa$ close to $1$ and therefore $\\rho_{\\min}$ close to $0$.",
            "answer": "$$\\boxed{\\frac{\\beta - \\alpha}{\\beta + \\alpha}}$$"
        },
        {
            "introduction": "The most effective solvers adapt their strategy as the solution evolves. In this final exercise, you will step into the role of a solver designer to evaluate different adaptive algorithms for controlling the pseudo-time step, $\\Delta \\tau$, based on the behavior of the nonlinear residual . By distinguishing between robust and flawed strategies, you will develop an appreciation for the logic that enables modern CFD codes to solve complex problems efficiently and reliably.",
            "id": "3987750",
            "problem": "Consider a steady-state discretization of the compressible Navier–Stokes equations used in Computational Fluid Dynamics (CFD), written in residual form as $F(u)=0$, where $u\\in\\mathbb{R}^N$ is the vector of conservative variables and $F:\\mathbb{R}^N\\to\\mathbb{R}^N$ is the nonlinear discrete residual. Pseudo-transient continuation converts the steady problem to a pseudo-time evolution $M\\,\\dot{u} + F(u) = 0$, where $M\\in\\mathbb{R}^{N\\times N}$ is a symmetric positive definite pseudo-mass matrix. A backward-Euler discretization in pseudo-time with step size $\\Delta\\tau^n0$ and linearization of $F$ at $u^n$ leads to the linear solve\n$$\n\\left(\\frac{M}{\\Delta\\tau^n} + J(u^n)\\right)\\,\\delta u^n = -F(u^n),\n$$\nfollowed by $u^{n+1}=u^n+\\delta u^n$, where $J(u^n)=\\frac{\\partial F}{\\partial u}(u^n)$ is the Jacobian. Define the nonlinear residual sequence $r^n := F(u^n)$ and the spectral radius $\\sigma^n := \\rho\\!\\left(M^{-1}J(u^n)\\right)$. Define the pseudo-Courant–Friedrichs–Lewy (CFL) number as $C^n := \\Delta\\tau^n\\,\\sigma^n$. Assume a norm $\\|\\cdot\\|$ on $\\mathbb{R}^N$ and a monotonicity window of length $m\\in\\mathbb{N}$; we say the residual decreases monotonically on the window if $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$. \n\nStarting from the governing laws above, the monotone decrease of the residual near a fixed point is controlled by the contraction properties of the linearized pseudo-transient update. In particular, in modal analysis for commuting $M$ and $J(u^\\star)$ at a steady solution $u^\\star$, each mode evolves with factor $\\mu_i/(\\mu_i+\\Delta\\tau\\,\\lambda_i)$, where $\\mu_i0$ and $\\lambda_i$ are generalized eigenvalues of $(M,J)$. Consequently, increasing $\\Delta\\tau$ decreases this factor and accelerates convergence, while decreasing $\\Delta\\tau$ restores damping when nonlinearity or inexactness causes residual growth. To ensure stability away from the linear regime, one must also enforce an upper bound on $C^n$ so that $\\| \\Delta\\tau^n M^{-1} J(u^n)\\|$ remains strictly less than unity, which guarantees invertibility of $\\left(I + \\Delta\\tau^n M^{-1}J(u^n)\\right)$ and a bounded iteration operator through a Neumann-series argument.\n\nWhich of the following residual-based adaptive $\\Delta\\tau$ update rules both:\n(i) increases the pseudo-Courant–Friedrichs–Lewy number $C^n$ when the residual decreases monotonically over the last $m$ iterations and decreases it otherwise, and \n(ii) admits a first-principles stability justification in the sense that the linearized map remains a contraction under a uniform cap $C^n\\le \\theta$ with $0\\theta1$?\n\nAssume fixed parameters $\\alpha\\in(0,1]$, $\\beta1$, $\\gamma_{\\min}\\in(0,1)$, $\\gamma_{\\max}1$, $\\eta\\in(0,1)$, and $\\theta\\in(0,1)$.\n\nA. If $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$, set\n$$\n\\Delta\\tau^{n+1} \\leftarrow \\min\\!\\left\\{\\gamma_{\\max}\\,\\Delta\\tau^n,\\ \\Delta\\tau^n\\left(\\frac{\\|r^{n-m+1}\\|}{\\|r^{n+1}\\|}\\right)^{\\alpha}\\right\\},\n$$\nelse set\n$$\n\\Delta\\tau^{n+1} \\leftarrow \\max\\!\\left\\{\\gamma_{\\min}\\,\\Delta\\tau^n,\\ \\frac{\\Delta\\tau^n}{\\beta}\\right\\}.\n$$\nThen enforce the pseudo-Courant–Friedrichs–Lewy cap by setting\n$$\nC^{n+1} \\leftarrow \\min\\!\\left\\{\\theta,\\ \\Delta\\tau^{n+1}\\,\\sigma^{n+1}\\right\\},\\quad \\Delta\\tau^{n+1} \\leftarrow \\frac{C^{n+1}}{\\sigma^{n+1}}.\n$$\n\nB. Set $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n + \\kappa\\left(\\|r^{n+1}\\| - \\|r^{n}\\|\\right)$ for a fixed $\\kappa0$, with no spectral cap.\n\nC. If $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$, set\n$$\n\\Delta\\tau^{n+1} \\leftarrow \\min\\!\\left\\{\\gamma_{\\max}\\,\\Delta\\tau^n,\\ \\Delta\\tau^n\\left(\\frac{\\|r^{n+1}\\|}{\\|r^{n}\\|}\\right)^{\\alpha}\\right\\},\n$$\nelse set $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n/\\beta$, and do not enforce any pseudo-Courant–Friedrichs–Lewy cap.\n\nD. If $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$, keep $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n$, else set $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n/\\beta$, with the cap $C^{n+1} \\leftarrow \\min\\{\\theta,\\ \\Delta\\tau^{n+1}\\sigma^{n+1}\\}$ and $\\Delta\\tau^{n+1} \\leftarrow C^{n+1}/\\sigma^{n+1}$.\n\nSelect all options that satisfy both requirements (i) and (ii) and justify them from the base laws given above.",
            "solution": "The problem requires an evaluation of four distinct adaptive update rules for the pseudo-time step size $\\Delta\\tau^n$ used in a pseudo-transient continuation method for solving the steady-state nonlinear system $F(u)=0$. The method's iteration is given by the linear solve\n$$\n\\left(\\frac{M}{\\Delta\\tau^n} + J(u^n)\\right)\\,\\delta u^n = -F(u^n),\n$$\nfollowed by the update $u^{n+1}=u^n+\\delta u^n$. The evaluation must be based on two criteria:\n\n(i) The rule must increase the pseudo-Courant–Friedrichs–Lewy (CFL) number, $C^n := \\Delta\\tau^n\\,\\sigma^n$, when the residual norm $\\|r^n\\| = \\|F(u^n)\\|$ decreases monotonically over the last $m$ iterations, and decrease it otherwise. A rule for $\\Delta\\tau$ is interpreted as aiming to control $C^n$ under the assumption that the spectral radius $\\sigma^n := \\rho(M^{-1}J(u^n))$ varies slowly. Thus, this criterion tests whether the rule increases $\\Delta\\tau$ in the case of monotonic residual decrease and decreases $\\Delta\\tau$ otherwise.\n\n(ii) The rule must admit a stability justification based on the principle provided in the problem statement: the linearized iteration map is a contraction if a uniform cap $C^n\\le \\theta$ with $0\\theta1$ is enforced. This means the update rule must explicitly include a step that enforces such a cap on the CFL number.\n\nThe given parameters for the rules are $\\alpha\\in(0,1]$, $\\beta1$, $\\gamma_{\\min}\\in(0,1)$, $\\gamma_{\\max}1$, and $\\theta\\in(0,1)$.\n\nLet's evaluate each option against these two criteria.\n\n### Analysis of Option A\n\nThe rule is:\nIf $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$, set\n$$\n\\Delta\\tau^{n+1} \\leftarrow \\min\\!\\left\\{\\gamma_{\\max}\\,\\Delta\\tau^n,\\ \\Delta\\tau^n\\left(\\frac{\\|r^{n-m+1}\\|}{\\|r^{n+1}\\|}\\right)^{\\alpha}\\right\\},\n$$\nelse set\n$$\n\\Delta\\tau^{n+1} \\leftarrow \\max\\!\\left\\{\\gamma_{\\min}\\,\\Delta\\tau^n,\\ \\frac{\\Delta\\tau^n}{\\beta}\\right\\}.\n$$\nThen, a cap is enforced:\n$$\nC^{n+1} \\leftarrow \\min\\!\\left\\{\\theta,\\ \\Delta\\tau^{n+1}\\,\\sigma^{n+1}\\right\\},\\quad \\Delta\\tau^{n+1} \\leftarrow \\frac{C^{n+1}}{\\sigma^{n+1}}.\n$$\n\n**Evaluation of Criterion (i):**\n- **Case of monotonic decrease:** The condition is $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$.\n  1. The term $\\gamma_{\\max}\\,\\Delta\\tau^n$ implies an increase in the time step, as $\\gamma_{\\max}1$.\n  2. The term $\\Delta\\tau^n\\left(\\frac{\\|r^{n-m+1}\\|}{\\|r^{n+1}\\|}\\right)^{\\alpha}$ also implies an increase (or no change if the norms are equal). Since the residual is monotonically decreasing, $\\|r^{n-m+1}\\| \\ge \\|r^{n+1}\\|$. Given $\\alpha0$, the factor $\\left(\\frac{\\|r^{n-m+1}\\|}{\\|r^{n+1}\\|}\\right)^{\\alpha} \\ge 1$.\n  The new tentative time step is the minimum of two values, both of which are greater than or equal to $\\Delta\\tau^n$. Therefore, $\\Delta\\tau^{n+1} \\ge \\Delta\\tau^n$. This rule attempts to increase the time step, which aligns with the goal of increasing the CFL number to accelerate convergence.\n- **Case of non-monotonic decrease (`else`):**\n  1. The term $\\gamma_{\\min}\\,\\Delta\\tau^n$ implies a decrease in the time step, as $\\gamma_{\\min} \\in (0,1)$.\n  2. The term $\\frac{\\Delta\\tau^n}{\\beta}$ also implies a decrease, as $\\beta1$.\n  The new tentative time step is the maximum of two values, both of which are strictly less than $\\Delta\\tau^n$. Therefore, $\\Delta\\tau^{n+1}  \\Delta\\tau^n$. This reduces the time step to restore stability, which aligns with decreasing the CFL number.\nCriterion (i) is satisfied.\n\n**Evaluation of Criterion (ii):**\nThe rule explicitly includes a capping procedure: $C^{n+1} \\leftarrow \\min\\!\\left\\{\\theta,\\ \\Delta\\tau^{n+1}\\,\\sigma^{n+1}\\right\\}$. This directly enforces the condition $C^{n+1} \\le \\theta$. Since it is given that $\\theta \\in (0,1)$, this corresponds exactly to the stability justification outlined in the problem statement.\nCriterion (ii) is satisfied.\n\n**Verdict for Option A:** Correct.\n\n### Analysis of Option B\n\nThe rule is: Set $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n + \\kappa\\left(\\|r^{n+1}\\| - \\|r^{n}\\|\\right)$ for a fixed $\\kappa0$, with no spectral cap.\n\n**Evaluation of Criterion (i):**\n- **Case of monotonic decrease:** In this case, $\\|r^{n+1}\\| \\le \\|r^n\\|$, which implies $\\|r^{n+1}\\| - \\|r^n\\| \\le 0$. The update rule becomes $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n + (\\text{a non-positive term})$, so $\\Delta\\tau^{n+1} \\le \\Delta\\tau^n$. This rule decreases (or maintains) the time step when convergence is good, which is the opposite of the required behavior.\n- **Case of non-monotonic decrease (`else`):** In this case, $\\|r^{n+1}\\|  \\|r^n\\|$, which implies $\\|r^{n+1}\\| - \\|r^n\\|  0$. The update rule gives $\\Delta\\tau^{n+1}  \\Delta\\tau^n$. This rule increases the time step when the residual is growing, which is likely to exacerbate instability. This is the opposite of the required behavior.\nCriterion (i) is not satisfied. The logic is inverted compared to standard practice and the problem's requirement.\n\n**Evaluation of Criterion (ii):**\nThe rule is specified \"with no spectral cap\". This directly violates the requirement for an explicit cap to ensure stability as per the problem's principles.\nCriterion (ii) is not satisfied.\n\n**Verdict for Option B:** Incorrect.\n\n### Analysis of Option C\n\nThe rule is:\nIf $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$, set\n$$\n\\Delta\\tau^{n+1} \\leftarrow \\min\\!\\left\\{\\gamma_{\\max}\\,\\Delta\\tau^n,\\ \\Delta\\tau^n\\left(\\frac{\\|r^{n+1}\\|}{\\|r^{n}\\|}\\right)^{\\alpha}\\right\\},\n$$\nelse set $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n/\\beta$, and do not enforce any pseudo-Courant–Friedrichs–Lewy cap.\n\n**Evaluation of Criterion (i):**\n- **Case of monotonic decrease:**\n  1. The term $\\gamma_{\\max}\\,\\Delta\\tau^n$ implies an increase since $\\gamma_{\\max}1$.\n  2. However, the term $\\Delta\\tau^n\\left(\\frac{\\|r^{n+1}\\|}{\\|r^{n}\\|}\\right)^{\\alpha}$ implies a decrease or no change. Since $\\|r^{n+1}\\| \\le \\|r^n\\|$ and $\\alpha0$, the factor $\\left(\\frac{\\|r^{n+1}\\|}{\\|r^{n}\\|}\\right)^{\\alpha} \\le 1$.\n  The update takes the minimum of a factor greater than $1$ and a factor less than or equal to $1$. The resulting multiplier on $\\Delta\\tau^n$ will be less than or equal to $1$. Thus, $\\Delta\\tau^{n+1} \\le \\Delta\\tau^n$. This does not increase the time step as required.\n- **Case of non-monotonic decrease (`else`):** The update $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n/\\beta$ with $\\beta1$ correctly implements a decrease of the time step.\nHowever, since the rule fails for the monotonic decrease case, criterion (i) as a whole is not satisfied.\n\n**Evaluation of Criterion (ii):**\nThe rule explicitly states \"do not enforce any pseudo-Courant–Friedrichs–Lewy cap\". This violates criterion (ii).\n\n**Verdict for Option C:** Incorrect.\n\n### Analysis of Option D\n\nThe rule is:\nIf $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$, keep $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n$, else set $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n/\\beta$. This is followed by the cap $C^{n+1} \\leftarrow \\min\\{\\theta,\\ \\Delta\\tau^{n+1}\\sigma^{n+1}\\}$ and $\\Delta\\tau^{n+1} \\leftarrow C^{n+1}/\\sigma^{n+1}$.\n\n**Evaluation of Criterion (i):**\n- **Case of monotonic decrease:** The rule is $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n$. This keeps the time step constant. The criterion requires that the rule \"increases the pseudo-Courant–Friedrichs–Lewy number\". A constant time step does not constitute an increase. The goal of such adaptive schemes is to be aggressive during good convergence, which this rule is not.\n- **Case of non-monotonic decrease (`else`):** The update $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n/\\beta$ with $\\beta1$ correctly implements a decrease.\nBecause the rule does not increase the time step in the monotonic case, it fails to satisfy criterion (i).\n\n**Evaluation of Criterion (ii):**\nThe rule incorporates the capping procedure $C^{n+1} \\leftarrow \\min\\{\\theta,\\ \\Delta\\tau^{n+1}\\sigma^{n+1}\\}$, which enforces $C^{n+1} \\le \\theta$. With $\\theta \\in (0,1)$, this satisfies the stability requirement described in the problem.\nCriterion (ii) is satisfied.\n\n**Verdict for Option D:** Incorrect, because it fails criterion (i).\n\n### Final Conclusion\n\nOnly Option A satisfies both specified criteria. Its update logic correctly attempts to increase the time step during stable convergence and decrease it upon detecting instability, and it includes the prescribed explicit CFL cap for stability.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}