{
    "hands_on_practices": [
        {
            "introduction": "掌握任何数值方法的第一步是理解其稳定性和收敛特性。本练习提供了一个分析经典一维对流扩散方程的动手实践机会，你将推导显式格式的伪时间步长稳定性极限（CFL条件），并将其收敛速率与隐式格式进行比较。通过这个过程，你将对伪时间步方法在最基本层面上的工作原理建立起坚实的基础。",
            "id": "3987768",
            "problem": "考虑一个被动标量 $u(x)$ 的一维稳态对流扩散方程，其中对流速度 $a>0$ 和运动扩散系数 $\\nu>0$ 为常数，\n$$\na\\,\\frac{\\partial u}{\\partial x} - \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}} = 0,\n$$\n该方程将通过伪时间步推进法（PTC）求解。在该方法中，引入伪时间 $\\tau$，并将非稳态松弛方程\n$$\n\\frac{\\partial u}{\\partial \\tau} + a\\,\\frac{\\partial u}{\\partial x} - \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}} = 0\n$$\n推进至稳态。假设在长度为 $L$ 的周期性域上有一个均匀网格，包含 $N$ 个等距点，间距为 $h = L/N$。用一阶迎风格式（对于 $a>0$ 采用后向差分）离散对流导数，用二阶中心差分离散扩散导数。设伪时间步进为显式前向欧拉格式或隐式后向欧拉格式。\n\n从这些定义和离散通量平衡出发，执行以下操作：\n\n1. 推导内部网格点的显式前向欧拉更新式，并通过强制其系数为正来获得显式伪时间 Courant–Friedrichs–Lewy (CFL) 约束，用无量纲对流和扩散伪CFL数表示，\n$$\n\\alpha = \\frac{a\\,\\Delta \\tau}{h}, \\qquad \\mu = \\frac{\\nu\\,\\Delta \\tau}{h^{2}},\n$$\n其中 $\\Delta \\tau$ 是伪时间步长。\n\n2. 使用 $L = 1.0\\,\\text{m}$，$N = 100$，$a = 50\\,\\text{m}\\,\\text{s}^{-1}$ 以及 $\\nu = 1.0\\times 10^{-2}\\,\\text{m}^{2}\\,\\text{s}^{-1}$，计算最大稳定显式伪时间步长 $\\Delta \\tau_{\\text{max}}$（以秒为单位）。\n\n3. 对于隐式后向欧拉格式，分析最高频率傅里叶模态（波数 $\\xi = \\pi$）的模态放大，并证明对于此线性离散，后向欧拉格式是无条件稳定的。为了公平地比较收敛速率，将隐式伪时间步长设置为显式稳定性极限的一个分数 $\\theta$，即 $\\Delta \\tau = \\theta\\,\\Delta \\tau_{\\text{max}}$，其中 $\\theta = 0.9$。\n\n4. 在此选择下，计算两种格式下最高频率模态的每步放大因子模，然后报告该模态的隐式与显式放大因子模之比。将最终比值表示为一个纯数字，四舍五入到四位有效数字。\n\n你的最终答案必须是一个实数：最高频率模态的隐式与显式每步放大模之比，四舍五入到四位有效数字，并且不带单位。",
            "solution": "我们从伪时间步推进方程开始\n$$\n\\frac{\\partial u}{\\partial \\tau} + a\\,\\frac{\\partial u}{\\partial x} - \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}} = 0,\n$$\n在均匀网格 $x_{j} = j h$（其中 $j = 0,1,\\dots,N-1$）上进行离散，网格间距为 $h = L/N$，并采用周期性边界条件。对于 $a>0$，在网格点 $j$ 处的一阶迎风对流和二阶中心扩散为\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{j} \\approx \\frac{u_{j} - u_{j-1}}{h}, \\qquad \\left.\\frac{\\partial^{2}u}{\\partial x^{2}}\\right|_{j} \\approx \\frac{u_{j+1} - 2 u_{j} + u_{j-1}}{h^{2}}.\n$$\n\n伪时间上的显式前向欧拉格式给出\n$$\nu_{j}^{n+1} = u_{j}^{n} + \\Delta \\tau \\left[ -\\,a\\,\\frac{u_{j}^{n} - u_{j-1}^{n}}{h} + \\nu\\,\\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{h^{2}} \\right].\n$$\n合并系数，\n$$\nu_{j}^{n+1} = \\underbrace{\\left( 1 - \\frac{a\\,\\Delta \\tau}{h} - 2\\,\\frac{\\nu\\,\\Delta \\tau}{h^{2}} \\right)}_{\\text{中心权重}} u_{j}^{n}\n+ \\underbrace{\\left( \\frac{a\\,\\Delta \\tau}{h} + \\frac{\\nu\\,\\Delta \\tau}{h^{2}} \\right)}_{\\text{左侧权重}} u_{j-1}^{n}\n+ \\underbrace{\\left( \\frac{\\nu\\,\\Delta \\tau}{h^{2}} \\right)}_{\\text{右侧权重}} u_{j+1}^{n}.\n$$\n定义无量纲伪CFL数\n$$\n\\alpha = \\frac{a\\,\\Delta \\tau}{h}, \\qquad \\mu = \\frac{\\nu\\,\\Delta \\tau}{h^{2}},\n$$\n更新式可写作\n$$\nu_{j}^{n+1} = \\left( 1 - \\alpha - 2 \\mu \\right) u_{j}^{n} + \\left( \\alpha + \\mu \\right) u_{j-1}^{n} + \\mu\\,u_{j+1}^{n}.\n$$\n一个单调的显式格式要求系数非负且和为一，从而得到以下约束\n$$\n\\mu \\ge 0, \\qquad \\alpha + \\mu \\ge 0, \\qquad 1 - \\alpha - 2\\mu \\ge 0.\n$$\n因此，显式伪时间CFL条件为\n$$\n\\alpha + 2 \\mu \\le 1.\n$$\n\n对于给定参数 $L = 1.0\\,\\text{m}$，$N = 100$，$a = 50\\,\\text{m}\\,\\text{s}^{-1}$ 以及 $\\nu = 1.0\\times 10^{-2}\\,\\text{m}^{2}\\,\\text{s}^{-1}$，网格间距为\n$$\nh = \\frac{L}{N} = \\frac{1.0}{100} = 1.0 \\times 10^{-2}\\,\\text{m}.\n$$\n取显式稳定性边界 $\\alpha + 2\\mu = 1$ 的等号可得\n$$\n\\frac{a\\,\\Delta \\tau_{\\text{max}}}{h} + 2\\,\\frac{\\nu\\,\\Delta \\tau_{\\text{max}}}{h^{2}} = 1,\n$$\n所以\n$$\n\\Delta \\tau_{\\text{max}} = \\frac{1}{\\dfrac{a}{h} + 2\\,\\dfrac{\\nu}{h^{2}}}.\n$$\n代入数值，\n$$\n\\frac{a}{h} = \\frac{50}{1.0\\times 10^{-2}} = 5.0 \\times 10^{3}\\,\\text{s}^{-1}, \\qquad \\frac{\\nu}{h^{2}} = \\frac{1.0\\times 10^{-2}}{(1.0\\times 10^{-2})^{2}} = 1.0 \\times 10^{2}\\,\\text{s}^{-1},\n$$\n因此\n$$\n\\Delta \\tau_{\\text{max}} = \\frac{1}{5.0 \\times 10^{3} + 2 \\times 1.0 \\times 10^{2}} = \\frac{1}{5.2 \\times 10^{3}} \\approx 1.923076923 \\times 10^{-4}\\,\\text{s}.\n$$\n\n现在我们通过模态放大来比较收敛速率。在周期性网格上，考虑一个傅里叶模态 $u_{j}^{n} = \\hat{u}^{n} \\exp(i \\xi j)$，其波数为 $\\xi \\in [0,\\pi]$。显式更新式可以用放大因子 $G_{\\text{exp}}(\\xi)$ 表示为\n$$\nu_{j}^{n+1} = G_{\\text{exp}}(\\xi)\\,u_{j}^{n}, \\qquad G_{\\text{exp}}(\\xi) = 1 - \\alpha - 2\\mu + (\\alpha + \\mu)\\,\\exp(-i \\xi) + \\mu\\,\\exp(i \\xi).\n$$\n对于最高频率模态 $\\xi = \\pi$，\n$$\n\\exp(i \\pi) = \\exp(-i \\pi) = -1,\n$$\n所以\n$$\nG_{\\text{exp}}(\\pi) = 1 - \\alpha - 2 \\mu - (\\alpha + \\mu) - \\mu = 1 - 2\\alpha - 4\\mu = 1 - 2(\\alpha + 2\\mu).\n$$\n在显式极限的一个分数 $\\theta$ 处，定义\n$$\n\\theta = \\alpha + 2 \\mu, \\qquad \\Delta \\tau = \\theta\\,\\Delta \\tau_{\\text{max}}, \\qquad \\theta \\in (0,1).\n$$\n则\n$$\nG_{\\text{exp}}(\\pi) = 1 - 2 \\theta, \\qquad |G_{\\text{exp}}(\\pi)| = |1 - 2 \\theta|.\n$$\n\n对于应用于 $\\partial u/\\partial \\tau = -L u$ 的后向欧拉格式，其中 $L$ 为空间离散算子，具有特征值 $\\lambda(\\xi)$ 的模态的误差放大为\n$$\nG_{\\text{imp}}(\\xi) = \\frac{1}{1 + \\Delta \\tau\\,\\lambda(\\xi)}.\n$$\n迎风对流加中心扩散的离散算子符号为\n$$\n\\lambda(\\xi) = \\frac{a}{h}\\left(1 - \\exp(-i \\xi)\\right) + \\frac{\\nu}{h^{2}}\\left(2 - \\exp(i \\xi) - \\exp(-i \\xi)\\right).\n$$\n当 $\\xi = \\pi$ 时，$\\sin(\\pi) = 0$ 且 $\\cos(\\pi) = -1$，因此\n$$\n\\lambda(\\pi) = \\frac{a}{h}\\left(1 - (-1)\\right) + \\frac{\\nu}{h^{2}}\\left(2 - (-1) - (-1)\\right) = \\frac{2 a}{h} + \\frac{4 \\nu}{h^{2}}.\n$$\n因此，\n$$\n\\Delta \\tau\\,\\lambda(\\pi) = \\Delta \\tau \\left( \\frac{2 a}{h} + \\frac{4 \\nu}{h^{2}} \\right) = 2 \\alpha + 4 \\mu = 2(\\alpha + 2\\mu) = 2 \\theta,\n$$\n并且最高频率模态的隐式放大为\n$$\n|G_{\\text{imp}}(\\pi)| = \\frac{1}{1 + 2 \\theta}.\n$$\n后向欧拉格式是无条件稳定的，因为对于所有模态，$\\lambda(\\xi)$ 的实部都是非负的（由于迎风对流和中心扩散），并且对于任何 $\\Delta \\tau > 0$，都有 $|G_{\\text{imp}}(\\xi)| = 1/|1 + \\Delta \\tau\\,\\lambda(\\xi)| \\le 1$。\n\n当 $\\theta = 0.9$ 时，显式和隐式的高频放大模为\n$$\n|G_{\\text{exp}}(\\pi)| = |1 - 2(0.9)| = |1 - 1.8| = 0.8,\n$$\n$$\n|G_{\\text{imp}}(\\pi)| = \\frac{1}{1 + 2(0.9)} = \\frac{1}{2.8} \\approx 0.357142857.\n$$\n所要求的最高频率模态的隐式与显式放大模之比为\n$$\n\\frac{|G_{\\text{imp}}(\\pi)|}{|G_{\\text{exp}}(\\pi)|} = \\frac{1/(1 + 2 \\theta)}{|1 - 2 \\theta|} \\bigg|_{\\theta = 0.9} = \\frac{1/2.8}{0.8} = \\frac{1}{2.24} \\approx 0.446428571.\n$$\n四舍五入到四位有效数字，该比值为\n$$\n0.4464.\n$$\n这量化地说明，在显式稳定性极限的 $90\\%$ 处，隐式后向欧拉格式对最高频率模态的每步衰减作用大约是显式前向欧拉格式的 $0.4464$ 倍，即在相同的伪时间步长与显式极限之比下，隐式格式对该模态实现了更强的每步衰减。",
            "answer": "$$\\boxed{0.4464}$$"
        },
        {
            "introduction": "在掌握了基本原理之后，我们现在需要探究简单伪时间步长方法的效率及其局限性。本练习揭示，一个基本的伪时间步长实现，在数学上等价于一种简单的迭代松弛方法，其性能在求解刚性问题（例如，在拉伸网格上）时会急剧下降。通过推导最优收敛因子，你将能定量地分析这一局限性，并理解为何需要采用更高级的预处理技术（即一个非平凡的伪质量矩阵 $M$）。",
            "id": "3987831",
            "problem": "在稳态计算流体动力学 (CFD) 中，我们寻求一个状态向量 $\\;u\\;$，使得离散残差 $\\;F(u) = 0\\;$。伪时间步推进法引入一个伪时间 $\\;\\tau\\;$，通过将稳态系统扩充为伪时间初值问题来正则化并加速收敛：\n$$\nM(u)\\,\\frac{du}{d\\tau} + F(u) = 0,\n$$\n其中 $M(u)$ 是一个正定的类质量算子。考虑基于此公式的以下两部分任务。\n\nA部分：从第一性原理证明，如果选择一个标量质量矩阵 $M(u) = \\gamma I$ 且 $\\;\\gamma > 0\\;$，那么这个选择等价于对伪时间进行均匀重缩放。具体来说，证明存在一个变量替换 $\\;\\tilde{\\tau} = \\tilde{\\tau}(\\tau)\\;$，使得使用 $M(u)=\\gamma I$ 的伪瞬态演化与使用 $M(u)=I$ 但在重缩放的伪时间 $\\;\\tilde{\\tau}\\;$ 中表示的演化是相同的。\n\nB部分：为分析此选择在高度拉伸网格上的影响，考虑在稳态 $u^{\\ast}$（其中 $F(u^{\\ast})=0$）附近的线性化，并且雅可比矩阵 $J \\equiv \\left.\\frac{\\partial F}{\\partial u}\\right|_{u^{\\ast}}$ 是可对角化的，其实谱包含在区间 $\\;[\\alpha,\\beta]\\;$ 内，其中 $0  \\alpha \\le \\beta$。定义误差 $\\;e(\\tau) = u(\\tau) - u^{\\ast}\\;$，则线性化的伪瞬态系统为\n$$\nM\\,\\frac{de}{d\\tau} + J e = 0.\n$$\n考虑一个大小为 $\\;\\Delta \\tau0\\;$ 的单步显式欧拉伪时间步，得到迭代式\n$$\ne^{k+1} = \\left(I - \\Delta \\tau\\,M^{-1} J\\right)\\,e^{k}.\n$$\n假设 $M=\\gamma I$ 并定义 $s = \\Delta \\tau/\\gamma$。仅使用这些假设和谱边界 $\\;[\\alpha,\\beta]\\;$，确定此迭代的最小可能单步最坏情况收缩因子，定义为\n$$\n\\rho_{\\min} \\equiv \\min_{s0}\\;\\max_{\\lambda\\in[\\alpha,\\beta]}\\; \\left|1 - s\\,\\lambda\\right|.\n$$\n给出仅以 $\\;\\alpha\\;$ 和 $\\;\\beta\\;$ 表示的闭式解析表达式作为最终答案。简要解释为什么这量化了在条件数 $\\;\\kappa = \\beta/\\alpha\\;$ 很大的高度拉伸网格上，标量选择 $M=\\gamma I$ 的次优性。最终答案必须仅为 $\\;\\rho_{\\min}\\;$ 的表达式，无需单位。",
            "solution": "这个问题分为两部分。A部分要求证明关于标量质量矩阵在伪时间步推进法中作用的命题。B部分要求解决一个极小化极大问题，以找到具有标量质量矩阵的线性化系统的最优单步收缩因子。\n\nA部分：等价于时间重缩放的证明\n\n给定伪时间步推进法的初值问题：\n$$\nM(u)\\,\\frac{du}{d\\tau} + F(u) = 0\n$$\n我们被要求考虑质量矩阵是单位矩阵的标量倍数的情况，即 $M(u) = \\gamma I$，其中常数 $\\gamma  0$。方程变为：\n$$\n\\gamma I\\,\\frac{du}{d\\tau} + F(u) = 0\n$$\n由于 $I$ 是单位算子，我们可以将其写为：\n$$\n\\gamma \\frac{du}{d\\tau} = -F(u)\n$$\n或\n$$\n\\frac{du}{d\\tau} = -\\frac{1}{\\gamma} F(u) \\quad (*_1)\n$$\n我们想证明这个演化与使用质量矩阵 $M(u)=I$ 但在重缩放的伪时间 $\\tilde{\\tau}$ 中表示的演化是相同的。对于 $M(u)=I$，演化方程为：\n$$\nI\\,\\frac{du}{d\\tilde{\\tau}} + F(u) = 0\n$$\n简化为：\n$$\n\\frac{du}{d\\tilde{\\tau}} = -F(u) \\quad (*_2)\n$$\n为证明等价性，我们提出从 $\\tau$ 到 $\\tilde{\\tau} = \\tilde{\\tau}(\\tau)$ 的变量替换。使用微分链式法则，我们可以关联关于 $\\tau$ 和 $\\tilde{\\tau}$ 的导数：\n$$\n\\frac{du}{d\\tau} = \\frac{du}{d\\tilde{\\tau}} \\frac{d\\tilde{\\tau}}{d\\tau}\n$$\n将此代入方程 $(*_1)$：\n$$\n\\frac{du}{d\\tilde{\\tau}} \\frac{d\\tilde{\\tau}}{d\\tau} = -\\frac{1}{\\gamma} F(u)\n$$\n现在，我们从方程 $(*_2)$ 中代入 $\\frac{du}{d\\tilde{\\tau}}$ 的表达式：\n$$\n(-F(u)) \\frac{d\\tilde{\\tau}}{d\\tau} = -\\frac{1}{\\gamma} F(u)\n$$\n假设我们尚未达到稳态解（即 $F(u) \\neq 0$），我们可以将两边同除以 $-F(u)$：\n$$\n\\frac{d\\tilde{\\tau}}{d\\tau} = \\frac{1}{\\gamma}\n$$\n这是一个关于 $\\tilde{\\tau}(\\tau)$ 的简单一阶常微分方程。对 $\\tau$ 积分得到：\n$$\n\\tilde{\\tau}(\\tau) = \\frac{1}{\\gamma} \\tau + C\n$$\n其中 $C$ 是积分常数。我们可以通过定义重缩放时间在 $\\tau=0$ 时 $\\tilde{\\tau}=0$ 来设置 $C=0$。因此，我们找到关系式：\n$$\n\\tilde{\\tau} = \\frac{\\tau}{\\gamma}\n$$\n这证明了在标量质量矩阵 $M(u) = \\gamma I$ 下的系统演化，与在重缩放的伪时间 $\\tilde{\\tau} = \\tau/\\gamma$ 中观察到的使用 $M(u)=I$ 的演化是相同的。标量因子 $\\gamma$ 只是在状态空间中沿着相同的轨迹加速（$\\gamma  1$）或减速（$\\gamma  1$）演化。\n\nB部分：最优收缩因子\n\n我们被要求找到线性化系统上显式欧拉迭代的最小可能单步最坏情况收缩因子。该迭代由下式给出：\n$$\ne^{k+1} = \\left(I - \\Delta \\tau\\,M^{-1} J\\right)\\,e^{k}\n$$\n当 $M = \\gamma I$ 时，其逆为 $M^{-1} = \\frac{1}{\\gamma} I$。迭代变为：\n$$\ne^{k+1} = \\left(I - \\frac{\\Delta \\tau}{\\gamma} J\\right)\\,e^{k}\n$$\n定义 $s = \\Delta \\tau / \\gamma$，放大矩阵为 $G = I - sJ$。单步收缩因子由 $G$ 的谱半径决定。由于 $J$ 是可对角化的，其特征向量也是 $G$ 的特征向量。如果 $\\lambda$ 是 $J$ 的一个特征值，那么 $1 - s\\lambda$ 就是 $G$ 的一个特征值。因此，单步收缩因子为 $\\max_{\\lambda} |1 - s\\lambda|$，其中最大值取遍 $J$ 的所有特征值 $\\lambda$。\n\n给定 $J$ 的实谱包含在区间 $[\\alpha, \\beta]$ 内，其中 $0  \\alpha \\le \\beta$。对于给定的 $s  0$，最坏情况下的收缩因子为：\n$$\n\\rho(s) = \\max_{\\lambda \\in [\\alpha, \\beta]} |1 - s\\lambda|\n$$\n我们希望通过选择最优的 $s  0$ 来找到该因子的最小值：\n$$\n\\rho_{\\min} = \\min_{s0} \\rho(s) = \\min_{s0} \\max_{\\lambda \\in [\\alpha, \\beta]} |1 - s\\lambda|\n$$\n令 $f(\\lambda) = 1 - s\\lambda$。对于固定的 $s  0$，这是一个关于 $\\lambda$ 的线性递减函数。因此，其绝对值 $|f(\\lambda)|$ 在闭区间 $[\\alpha, \\beta]$ 上的最大值必然出现在端点之一，即 $\\lambda = \\alpha$ 或 $\\lambda = \\beta$。\n$$\n\\rho(s) = \\max \\left( |1 - s\\alpha|, |1 - s\\beta| \\right)\n$$\n我们寻求找到使 $\\rho(s)$ 最小化的 $s^*  0$。这是一个经典的极小化极大问题。两个函数最大值的最小值通常出现在两个函数幅值相等的地方。让我们分析 $|1-s\\alpha|$ 和 $|1-s\\beta|$ 作为 $s$ 的函数的行为。最优值 $s^*$ 将平衡最慢模式（与 $\\alpha$ 相关）和最快模式（与 $\\beta$ 相关）的阻尼。当这两个模式的放大因子幅值相等时，达到这种平衡：\n$$\n|1 - s^*\\alpha| = |1 - s^*\\beta|\n$$\n由于 $s0$ 且 $\\beta \\ge \\alpha  0$，我们有 $s\\beta \\ge s\\alpha$。为了平衡放大因子，最优的 $s^*$ 必须位于 $1/\\beta$ 和 $1/\\alpha$ 之间，这意味着 $1-s^*\\beta \\le 0$ 且 $1-s^*\\alpha \\ge 0$。因此，等式变为：\n$$\n1 - s^*\\alpha = -(1 - s^*\\beta) = s^*\\beta - 1\n$$\n解出 $s^*$：\n$$\n2 = s^*\\alpha + s^*\\beta = s^*(\\alpha + \\beta)\n$$\n$$\ns^* = \\frac{2}{\\alpha + \\beta}\n$$\n现在我们将这个最优值 $s^*$ 代回收缩因子的表达式，以求得 $\\rho_{\\min}$：\n$$\n\\rho_{\\min} = |1 - s^*\\alpha| = \\left|1 - \\frac{2\\alpha}{\\alpha + \\beta}\\right| = \\left|\\frac{\\alpha + \\beta - 2\\alpha}{\\alpha + \\beta}\\right| = \\left|\\frac{\\beta - \\alpha}{\\alpha + \\beta}\\right|\n$$\n由于 $\\beta \\ge \\alpha  0$，分子是非负的，所以我们可以去掉绝对值符号：\n$$\n\\rho_{\\min} = \\frac{\\beta - \\alpha}{\\beta + \\alpha}\n$$\n我们可以用另一个端点来验证：\n$$\n\\rho_{\\min} = |1 - s^*\\beta| = \\left|1 - \\frac{2\\beta}{\\alpha + \\beta}\\right| = \\left|\\frac{\\alpha + \\beta - 2\\beta}{\\alpha + \\beta}\\right| = \\left|\\frac{\\alpha - \\beta}{\\alpha + \\beta}\\right| = \\frac{\\beta - \\alpha}{\\beta + \\alpha}\n$$\n结果一致，证实了我们的解。\n\n这个结果量化了对于具有大条件数的问题，标量选择 $M=\\gamma I$ 的次优性。雅可比矩阵 $J$ 的条件数可以定义为 $\\kappa = \\beta/\\alpha$。我们可以用 $\\kappa$ 来表示 $\\rho_{\\min}$：\n$$\n\\rho_{\\min} = \\frac{\\beta/\\alpha - 1}{\\beta/\\alpha + 1} = \\frac{\\kappa - 1}{\\kappa + 1}\n$$\n在高度拉伸的网格上，离散化会导致雅可比矩阵非常刚性，意味着它们具有宽广的特征值谱。这导致了非常大的条件数，$\\kappa \\gg 1$。当 $\\kappa \\to \\infty$ 时，最优收缩因子 $\\rho_{\\min} \\to 1$。接近1的收缩因子意味着迭代方法的收敛极其缓慢。这表明，对于在航空航天CFD中常见的病态问题，选择简单的标量质量矩阵（等价于一个简单的松弛格式）是高度次优的。应该选择一个有效的预条件子 $M$ 在某种意义上近似 $J$，使得 $M^{-1}J$ 的特征值聚集在一起，从而使 $\\kappa$ 接近1，因此 $\\rho_{\\min}$ 接近0。",
            "answer": "$$\\boxed{\\frac{\\beta - \\alpha}{\\beta + \\alpha}}$$"
        },
        {
            "introduction": "理论最终需要转化为有效的实践。本练习将带你进入算法设计的领域，要求你评估不同的自适应策略，以动态调整伪时间步长 $\\Delta\\tau$ 来加速收敛。通过这一过程，你将学习到构建一个能够根据问题行为动态响应的实用、高效且稳定的求解器背后的设计原则。",
            "id": "3987750",
            "problem": "考虑计算流体力学 (CFD) 中使用的可压缩Navier–Stokes方程的稳态离散，其残差形式写作 $F(u)=0$，其中 $u\\in\\mathbb{R}^N$ 是守恒变量向量，$F:\\mathbb{R}^N\\to\\mathbb{R}^N$ 是非线性离散残差。伪时间步推进法将稳态问题转化为一个伪时间演化问题 $M\\,\\dot{u} + F(u) = 0$，其中 $M\\in\\mathbb{R}^{N\\times N}$ 是一个对称正定的伪质量矩阵。在伪时间上采用步长为 $\\Delta\\tau^n0$ 的后向欧拉离散，并在 $u^n$ 处对 $F$ 进行线性化，可得到以下线性求解：\n$$\n\\left(\\frac{M}{\\Delta\\tau^n} + J(u^n)\\right)\\,\\delta u^n = -F(u^n),\n$$\n随后进行 $u^{n+1} = u^n + \\delta u^n$ 更新，其中 $J(u^n)=\\frac{\\partial F}{\\partial u}(u^n)$ 是雅可比矩阵。定义非线性残差序列为 $r^n := F(u^n)$，谱半径为 $\\sigma^n := \\rho\\!\\left(M^{-1}J(u^n)\\right)$。定义伪Courant–Friedrichs–Lewy (CFL) 数为 $C^n := \\Delta\\tau^n\\,\\sigma^n$。假设在 $\\mathbb{R}^N$ 上有一个范数 $\\|\\cdot\\|$ 和一个长度为 $m\\in\\mathbb{N}$ 的单调性窗口；如果 $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$，我们称残差在该窗口上单调递减。\n\n从上述控制律出发，残差在不动点附近的单调递减由线性化伪瞬态更新的收缩性质控制。特别地，在稳态解 $u^\\star$ 处对可交换的 $M$ 和 $J(u^\\star)$ 进行模态分析时，每个模态以因子 $\\mu_i/(\\mu_i+\\Delta\\tau\\,\\lambda_i)$ 演化，其中 $\\mu_i0$ 和 $\\lambda_i$ 是 $(M,J)$ 的广义特征值。因此，增加 $\\Delta\\tau$ 会减小该因子并加速收敛，而当非线性或不精确性导致残差增长时，减小 $\\Delta\\tau$ 会恢复阻尼。为确保在线性区域外的稳定性，还必须对 $C^n$ 强制施加一个上界，以使 $\\|\\Delta\\tau^n M^{-1} J(u^n)\\|$ 严格小于1，这通过Neumann级数论证保证了 $\\left(I + \\Delta\\tau^n M^{-1}J(u^n)\\right)$ 的可逆性和迭代算子的有界性。\n\n以下哪种基于残差的自适应 $\\Delta\\tau$ 更新规则同时满足：\n(i) 当残差在过去 $m$ 次迭代中单调递减时，增加伪Courant–Friedrichs–Lewy数 $C^n$，否则减小它，并且\n(ii) 允许第一性原理的稳定性证明，即在线性化映射在一致上限 $C^n\\le \\theta$（其中 $0  \\theta  1$）下保持为收缩映射？\n\n假设参数 $\\alpha\\in(0,1]$, $\\beta1$, $\\gamma_{\\min}\\in(0,1)$, $\\gamma_{\\max}1$, $\\eta\\in(0,1)$ 和 $\\theta\\in(0,1)$ 为固定值。\n\nA. 如果 $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$，则设置\n$$\n\\Delta\\tau^{n+1} \\leftarrow \\min\\!\\left\\{\\gamma_{\\max}\\,\\Delta\\tau^n,\\ \\Delta\\tau^n\\left(\\frac{\\|r^{n-m+1}\\|}{\\|r^{n+1}\\|}\\right)^{\\alpha}\\right\\},\n$$\n否则设置\n$$\n\\Delta\\tau^{n+1} \\leftarrow \\max\\!\\left\\{\\gamma_{\\min}\\,\\Delta\\tau^n,\\ \\frac{\\Delta\\tau^n}{\\beta}\\right\\}.\n$$\n然后通过设置以下方式强制施加伪Courant–Friedrichs–Lewy上限\n$$\nC^{n+1} \\leftarrow \\min\\!\\left\\{\\theta,\\ \\Delta\\tau^{n+1}\\,\\sigma^{n+1}\\right\\},\\quad \\Delta\\tau^{n+1} \\leftarrow \\frac{C^{n+1}}{\\sigma^{n+1}}.\n$$\n\nB. 设置 $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n + \\kappa\\left(\\|r^{n+1}\\| - \\|r^{n}\\|\\right)$，其中 $\\kappa0$ 为固定值，无谱上限。\n\nC. 如果 $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$，则设置\n$$\n\\Delta\\tau^{n+1} \\leftarrow \\min\\!\\left\\{\\gamma_{\\max}\\,\\Delta\\tau^n,\\ \\Delta\\tau^n\\left(\\frac{\\|r^{n+1}\\|}{\\|r^{n}\\|}\\right)^{\\alpha}\\right\\},\n$$\n否则设置 $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n/\\beta$，且不强制施加任何伪Courant–Friedrichs–Lewy上限。\n\nD. 如果 $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$，保持 $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n$，否则设置 $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n/\\beta$，并使用上限 $C^{n+1} \\leftarrow \\min\\{\\theta,\\ \\Delta\\tau^{n+1}\\sigma^{n+1}\\}$ 和 $\\Delta\\tau^{n+1} \\leftarrow C^{n+1}/\\sigma^{n+1}$。\n\n选择所有满足要求 (i) 和 (ii) 的选项，并根据上面给出的基本定律进行论证。",
            "solution": "该问题要求评估四种不同的自适应更新规则，这些规则用于更新伪时间步推进法中的伪时间步长 $\\Delta\\tau^n$，该方法用于求解稳态非线性系统 $F(u)=0$。该方法的迭代由以下线性求解给出：\n$$\n\\left(\\frac{M}{\\Delta\\tau^n} + J(u^n)\\right)\\,\\delta u^n = -F(u^n),\n$$\n随后是更新 $u^{n+1}=u^n+\\delta u^n$。评估必须基于两个标准：\n\n(i) 当残差范数 $\\|r^n\\| = \\|F(u^n)\\|$ 在过去 $m$ 次迭代中单调递减时，规则必须增加伪Courant–Friedrichs–Lewy (CFL) 数 $C^n := \\Delta\\tau^n\\,\\sigma^n$，否则减小它。关于 $\\Delta\\tau$ 的规则被解释为旨在控制 $C^n$，其假设是谱半径 $\\sigma^n := \\rho(M^{-1}J(u^n))$ 变化缓慢。因此，该标准测试规则是否在残差单调递减的情况下增加 $\\Delta\\tau$，而在其他情况下减小 $\\Delta\\tau$。\n\n(ii) 规则必须能提供基于问题陈述中原理的稳定性证明：如果强制施加一个一致上限 $C^n\\le \\theta$ (其中 $0  \\theta  1$)，则线性化迭代映射是一个收缩。这意味着更新规则必须明确包含一个对CFL数强制施加此类上限的步骤。\n\n规则的给定参数为 $\\alpha\\in(0,1]$, $\\beta1$, $\\gamma_{\\min}\\in(0,1)$, $\\gamma_{\\max}1$ 和 $\\theta\\in(0,1)$。\n\n让我们根据这两个标准来评估每个选项。\n\n### 选项A的分析\n\n规则是：\n如果 $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$，则设置\n$$\n\\Delta\\tau^{n+1} \\leftarrow \\min\\!\\left\\{\\gamma_{\\max}\\,\\Delta\\tau^n,\\ \\Delta\\tau^n\\left(\\frac{\\|r^{n-m+1}\\|}{\\|r^{n+1}\\|}\\right)^{\\alpha}\\right\\},\n$$\n否则设置\n$$\n\\Delta\\tau^{n+1} \\leftarrow \\max\\!\\left\\{\\gamma_{\\min}\\,\\Delta\\tau^n,\\ \\frac{\\Delta\\tau^n}{\\beta}\\right\\}.\n$$\n然后，强制施加上限：\n$$\nC^{n+1} \\leftarrow \\min\\!\\left\\{\\theta,\\ \\Delta\\tau^{n+1}\\,\\sigma^{n+1}\\right\\},\\quad \\Delta\\tau^{n+1} \\leftarrow \\frac{C^{n+1}}{\\sigma^{n+1}}.\n$$\n\n**标准 (i) 的评估：**\n- **单调递减情况：** 条件是 $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$。\n  1. 项 $\\gamma_{\\max}\\,\\Delta\\tau^n$ 意味着时间步长的增加，因为 $\\gamma_{\\max}1$。\n  2. 项 $\\Delta\\tau^n\\left(\\frac{\\|r^{n-m+1}\\|}{\\|r^{n+1}\\|}\\right)^{\\alpha}$ 也意味着增加（如果范数相等则不改变）。由于残差是单调递减的，$\\|r^{n-m+1}\\| \\ge \\|r^{n+1}\\|$。给定 $\\alpha0$，因子 $\\left(\\frac{\\|r^{n-m+1}\\|}{\\|r^{n+1}\\|}\\right)^{\\alpha} \\ge 1$。\n  新的暂定时间步长是两个值的最小值，这两个值都大于或等于 $\\Delta\\tau^n$。因此，$\\Delta\\tau^{n+1} \\ge \\Delta\\tau^n$。该规则试图增加时间步长，这与增加CFL数以加速收敛的目标一致。\n- **非单调递减情况（`else`）：**\n  1. 项 $\\gamma_{\\min}\\,\\Delta\\tau^n$ 意味着时间步长的减小，因为 $\\gamma_{\\min} \\in (0,1)$。\n  2. 项 $\\frac{\\Delta\\tau^n}{\\beta}$ 也意味着减小，因为 $\\beta1$。\n  新的暂定时间步长是两个值的最大值，这两个值都严格小于 $\\Delta\\tau^n$。因此，$\\Delta\\tau^{n+1}  \\Delta\\tau^n$。这会减小时间步长以恢复稳定性，这与减小CFL数的目标一致。\n标准 (i) 得到满足。\n\n**标准 (ii) 的评估：**\n该规则明确包含一个上限程序：$C^{n+1} \\leftarrow \\min\\!\\left\\{\\theta,\\ \\Delta\\tau^{n+1}\\,\\sigma^{n+1}\\right\\}$。这直接强制执行了条件 $C^{n+1} \\le \\theta$。由于给定 $\\theta \\in (0,1)$，这与问题陈述中概述的稳定性证明完全对应。\n标准 (ii) 得到满足。\n\n**选项A的结论：** 正确。\n\n### 选项B的分析\n\n规则是：设置 $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n + \\kappa\\left(\\|r^{n+1}\\| - \\|r^{n}\\|\\right)$，其中 $\\kappa0$ 为固定值，无谱上限。\n\n**标准 (i) 的评估：**\n- **单调递减情况：** 在这种情况下，$\\|r^{n+1}\\| \\le \\|r^n\\|$，这意味着 $\\|r^{n+1}\\| - \\|r^n\\| \\le 0$。更新规则变为 $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n + (\\text{一个非正项})$，因此 $\\Delta\\tau^{n+1} \\le \\Delta\\tau^n$。当收敛良好时，此规则减小（或维持）时间步长，这与要求的行为相反。\n- **非单调递减情况（`else`）：** 在这种情况下，$\\|r^{n+1}\\|  \\|r^n\\|$，这意味着 $\\|r^{n+1}\\| - \\|r^n\\|  0$。更新规则给出 $\\Delta\\tau^{n+1}  \\Delta\\tau^n$。当残差增长时，此规则增加时间步长，这可能会加剧不稳定性。这与要求的行为相反。\n标准 (i) 未得到满足。与标准实践和问题要求相比，其逻辑是相反的。\n\n**标准 (ii) 的评估：**\n该规则明确指出“无谱上限”。这直接违反了根据问题原理为确保稳定性而设置明确上限的要求。\n标准 (ii) 未得到满足。\n\n**选项B的结论：** 不正确。\n\n### 选项C的分析\n\n规则是：\n如果 $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$，则设置\n$$\n\\Delta\\tau^{n+1} \\leftarrow \\min\\!\\left\\{\\gamma_{\\max}\\,\\Delta\\tau^n,\\ \\Delta\\tau^n\\left(\\frac{\\|r^{n+1}\\|}{\\|r^{n}\\|}\\right)^{\\alpha}\\right\\},\n$$\n否则设置 $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n/\\beta$，且不强制施加任何伪Courant–Friedrichs–Lewy上限。\n\n**标准 (i) 的评估：**\n- **单调递减情况：**\n  1. 项 $\\gamma_{\\max}\\,\\Delta\\tau^n$ 意味着增加，因为 $\\gamma_{\\max}1$。\n  2. 然而，项 $\\Delta\\tau^n\\left(\\frac{\\|r^{n+1}\\|}{\\|r^{n}\\|}\\right)^{\\alpha}$ 意味着减小或不变。由于 $\\|r^{n+1}\\| \\le \\|r^n\\|$ 且 $\\alpha0$，因子 $\\left(\\frac{\\|r^{n+1}\\|}{\\|r^{n}\\|}\\right)^{\\alpha} \\le 1$。\n  更新取一个大于1的因子和一个小于等于1的因子的最小值。作用于 $\\Delta\\tau^n$ 的最终乘数将小于或等于1。因此，$\\Delta\\tau^{n+1} \\le \\Delta\\tau^n$。这没有按要求增加时间步长。\n- **非单调递减情况（`else`）：** 更新 $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n/\\beta$ (其中 $\\beta1$) 正确地实现了时间步长的减小。\n然而，由于该规则在单调递减情况下失败，因此整个标准 (i) 未得到满足。\n\n**标准 (ii) 的评估：**\n该规则明确指出“不强制施加任何伪Courant–Friedrichs–Lewy上限”。这违反了标准 (ii)。\n\n**选项C的结论：** 不正确。\n\n### 选项D的分析\n\n规则是：\n如果 $\\|r^{n+1}\\|\\le \\|r^{n}\\|\\le \\cdots \\le \\|r^{n-m+1}\\|$，保持 $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n$，否则设置 $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n/\\beta$。随后是上限 $C^{n+1} \\leftarrow \\min\\{\\theta,\\ \\Delta\\tau^{n+1}\\sigma^{n+1}\\}$ 和 $\\Delta\\tau^{n+1} \\leftarrow C^{n+1}/\\sigma^{n+1}$。\n\n**标准 (i) 的评估：**\n- **单调递减情况：** 规则是 $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n$。这保持了时间步长不变。标准要求规则“增加伪Courant–Friedrichs–Lewy数”。恒定的时间步长不构成增加。这类自适应方案的目标是在收敛良好时采取激进策略，而此规则并非如此。\n- **非单调递减情况（`else`）：** 更新 $\\Delta\\tau^{n+1} \\leftarrow \\Delta\\tau^n/\\beta$ (其中 $\\beta1$) 正确地实现了减小。\n因为该规则在单调情况下不增加时间步长，所以它不满足标准 (i)。\n\n**标准 (ii) 的评估：**\n该规则包含了上限程序 $C^{n+1} \\leftarrow \\min\\{\\theta,\\ \\Delta\\tau^{n+1}\\sigma^{n+1}\\}$，它强制执行 $C^{n+1} \\le \\theta$。由于 $\\theta \\in (0,1)$，这满足了问题中描述的稳定性要求。\n标准 (ii) 得到满足。\n\n**选项D的结论：** 不正确，因为它不满足标准 (i)。\n\n### 最终结论\n\n只有选项A满足所有指定的标准。其更新逻辑在稳定收敛期间正确地尝试增加时间步长，并在检测到不稳定性时减小时间步长，并且它包含了为保证稳定性而规定的显式CFL上限。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}