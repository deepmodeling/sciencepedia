{
    "hands_on_practices": [
        {
            "introduction": "本练习将为理解伪瞬态延拓法奠定基础，我们将其应用于一个经典的一维对流-扩散模型问题。通过对显式和隐式时间步进格式进行稳定性分析，您将亲手推导 Courant–Friedrichs–Lewy (CFL) 条件，并评估不同数值方法的收敛行为。这种基础分析是在计算流体力学中开发和诊断迭代求解器的基石。",
            "id": "3987768",
            "problem": "考虑一个被动标量 $u(x)$ 的一维稳态平流-扩散方程，其中平流速度 $a>0$ 和运动扩散系数 $\\nu>0$ 均为常数，\n$$\na\\,\\frac{\\partial u}{\\partial x} - \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}} = 0,\n$$\n该方程将通过伪瞬态延拓法（PTC）求解。该方法引入一个伪时间 $\\tau$，并将非稳态松弛方程\n$$\n\\frac{\\partial u}{\\partial \\tau} + a\\,\\frac{\\partial u}{\\partial x} - \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}} = 0\n$$\n推进至稳态。假设在一个长度为 $L$ 的周期性域上使用均匀网格，该网格有 $N$ 个等距点，间距为 $h = L/N$。使用一阶迎风格式（对于 $a>0$ 为后向差分）离散化对流导数，使用二阶中心差分格式离散化扩散导数。伪时间步进可采用显式前向欧拉法或隐式后向欧拉法。\n\n从这些定义和离散通量平衡出发，执行以下操作：\n\n1. 推导内部网格点的显式前向欧拉更新式，并通过强制其系数为正来获得显式伪时间 Courant–Friedrichs–Lewy (CFL) 约束。该约束用无量纲对流和扩散伪 CFL 数表示，\n$$\n\\alpha = \\frac{a\\,\\Delta \\tau}{h}, \\qquad \\mu = \\frac{\\nu\\,\\Delta \\tau}{h^{2}},\n$$\n其中 $\\Delta \\tau$ 是伪时间步长。\n\n2. 使用 $L = 1.0\\,\\text{m}$，$N = 100$，$a = 50\\,\\text{m}\\,\\text{s}^{-1}$ 和 $\\nu = 1.0\\times 10^{-2}\\,\\text{m}^{2}\\,\\text{s}^{-1}$，计算最大稳定显式伪时间步长 $\\Delta \\tau_{\\text{max}}$（单位：秒）。\n\n3. 对于隐式后向欧拉格式，分析最高频率傅里叶模态（波数 $\\xi = \\pi$）的模态放大系数，并证明对于这种线性离散化，后向欧拉法是无条件稳定的。为了公平地比较收敛速度，将隐式伪时间步长设置为显式稳定性极限的一个分数 $\\theta$，即 $\\Delta \\tau = \\theta\\,\\Delta \\tau_{\\text{max}}$，其中 $\\theta = 0.9$。\n\n4. 在此选择下，计算两种格式下最高频率模态的每步放大因子模，然后报告该模态的隐式与显式放大因子模之比。将最终比值表示为一个纯数，并四舍五入到四位有效数字。\n\n你的最终答案必须是一个单一实数：最高频率模态的隐式与显式每步放大因子模之比，四舍五入到四位有效数字，不带单位。",
            "solution": "我们从伪瞬态松弛方程开始\n$$\n\\frac{\\partial u}{\\partial \\tau} + a\\,\\frac{\\partial u}{\\partial x} - \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}} = 0,\n$$\n该方程在均匀网格 $x_{j} = j h$（$j = 0,1,\\dots,N-1$）上离散化，网格间距为 $h = L/N$，并采用周期性边界条件。对于 $a>0$，在网格点 $j$ 处的一阶迎风对流项和二阶中心扩散项为\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{j} \\approx \\frac{u_{j} - u_{j-1}}{h}, \\qquad \\left.\\frac{\\partial^{2}u}{\\partial x^{2}}\\right|_{j} \\approx \\frac{u_{j+1} - 2 u_{j} + u_{j-1}}{h^{2}}.\n$$\n\n伪时间上的显式前向欧拉法给出\n$$\nu_{j}^{n+1} = u_{j}^{n} + \\Delta \\tau \\left[ -\\,a\\,\\frac{u_{j}^{n} - u_{j-1}^{n}}{h} + \\nu\\,\\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{h^{2}} \\right].\n$$\n合并各项系数，\n$$\nu_{j}^{n+1} = \\underbrace{\\left( 1 - \\frac{a\\,\\Delta \\tau}{h} - 2\\,\\frac{\\nu\\,\\Delta \\tau}{h^{2}} \\right)}_{\\text{中心权重}} u_{j}^{n}\n+ \\underbrace{\\left( \\frac{a\\,\\Delta \\tau}{h} + \\frac{\\nu\\,\\Delta \\tau}{h^{2}} \\right)}_{\\text{左侧权重}} u_{j-1}^{n}\n+ \\underbrace{\\left( \\frac{\\nu\\,\\Delta \\tau}{h^{2}} \\right)}_{\\text{右侧权重}} u_{j+1}^{n}.\n$$\n定义无量纲伪 CFL 数\n$$\n\\alpha = \\frac{a\\,\\Delta \\tau}{h}, \\qquad \\mu = \\frac{\\nu\\,\\Delta \\tau}{h^{2}},\n$$\n更新式可写作\n$$\nu_{j}^{n+1} = \\left( 1 - \\alpha - 2 \\mu \\right) u_{j}^{n} + \\left( \\alpha + \\mu \\right) u_{j-1}^{n} + \\mu\\,u_{j+1}^{n}.\n$$\n一个单调的显式格式要求所有系数非负且其和为一，从而得到以下约束条件\n$$\n\\mu \\ge 0, \\qquad \\alpha + \\mu \\ge 0, \\qquad 1 - \\alpha - 2\\mu \\ge 0.\n$$\n因此，显式伪时间 CFL 条件为\n$$\n\\alpha + 2 \\mu \\le 1.\n$$\n\n对于给定的参数 $L = 1.0\\,\\text{m}$，$N = 100$，$a = 50\\,\\text{m}\\,\\text{s}^{-1}$ 和 $\\nu = 1.0\\times 10^{-2}\\,\\text{m}^{2}\\,\\text{s}^{-1}$，网格间距为\n$$\nh = \\frac{L}{N} = \\frac{1.0}{100} = 1.0 \\times 10^{-2}\\,\\text{m}.\n$$\n令显式稳定性边界条件 $\\alpha + 2\\mu = 1$ 取等号，可得\n$$\n\\frac{a\\,\\Delta \\tau_{\\text{max}}}{h} + 2\\,\\frac{\\nu\\,\\Delta \\tau_{\\text{max}}}{h^{2}} = 1,\n$$\n所以\n$$\n\\Delta \\tau_{\\text{max}} = \\frac{1}{\\dfrac{a}{h} + 2\\,\\dfrac{\\nu}{h^{2}}}.\n$$\n代入数值，\n$$\n\\frac{a}{h} = \\frac{50}{1.0\\times 10^{-2}} = 5.0 \\times 10^{3}\\,\\text{s}^{-1}, \\qquad \\frac{\\nu}{h^{2}} = \\frac{1.0\\times 10^{-2}}{(1.0\\times 10^{-2})^{2}} = 1.0 \\times 10^{2}\\,\\text{s}^{-1},\n$$\n因此\n$$\n\\Delta \\tau_{\\text{max}} = \\frac{1}{5.0 \\times 10^{3} + 2 \\times 1.0 \\times 10^{2}} = \\frac{1}{5.2 \\times 10^{3}} \\approx 1.923076923 \\times 10^{-4}\\,\\text{s}.\n$$\n\n我们现在通过模态放大来比较收敛速度。在周期性网格上，考虑一个傅里叶模态 $u_{j}^{n} = \\hat{u}^{n} \\exp(i \\xi j)$，其波数为 $\\xi \\in [0,\\pi]$。显式更新式可以用放大因子 $G_{\\text{exp}}(\\xi)$ 表示为\n$$\nu_{j}^{n+1} = G_{\\text{exp}}(\\xi)\\,u_{j}^{n}, \\qquad G_{\\text{exp}}(\\xi) = 1 - \\alpha - 2\\mu + (\\alpha + \\mu)\\,\\exp(-i \\xi) + \\mu\\,\\exp(i \\xi).\n$$\n对于最高频率模态 $\\xi = \\pi$，\n$$\n\\exp(i \\pi) = \\exp(-i \\pi) = -1,\n$$\n所以\n$$\nG_{\\text{exp}}(\\pi) = 1 - \\alpha - 2 \\mu - (\\alpha + \\mu) - \\mu = 1 - 2\\alpha - 4\\mu = 1 - 2(\\alpha + 2\\mu).\n$$\n在显式稳定性极限的分数 $\\theta$ 处，定义\n$$\n\\theta = \\alpha + 2 \\mu, \\qquad \\Delta \\tau = \\theta\\,\\Delta \\tau_{\\text{max}}, \\qquad \\theta \\in (0,1).\n$$\n那么\n$$\nG_{\\text{exp}}(\\pi) = 1 - 2 \\theta, \\qquad |G_{\\text{exp}}(\\pi)| = |1 - 2 \\theta|.\n$$\n\n对于应用于 $\\partial u/\\partial \\tau = -L u$ 的后向欧拉法，其中 $L$ 是空间离散算子，具有特征值 $\\lambda(\\xi)$ 的模态的误差放大系数为\n$$\nG_{\\text{imp}}(\\xi) = \\frac{1}{1 + \\Delta \\tau\\,\\lambda(\\xi)}.\n$$\n迎风对流加中心扩散的离散算子符号为\n$$\n\\lambda(\\xi) = \\frac{a}{h}\\left(1 - \\exp(-i \\xi)\\right) + \\frac{\\nu}{h^{2}}\\left(2 - \\exp(i \\xi) - \\exp(-i \\xi)\\right).\n$$\n在 $\\xi = \\pi$ 处，$\\sin(\\pi) = 0$ 且 $\\cos(\\pi) = -1$，因此\n$$\n\\lambda(\\pi) = \\frac{a}{h}\\left(1 - (-1)\\right) + \\frac{\\nu}{h^{2}}\\left(2 - (-1) - (-1)\\right) = \\frac{2 a}{h} + \\frac{4 \\nu}{h^{2}}.\n$$\n因此，\n$$\n\\Delta \\tau\\,\\lambda(\\pi) = \\Delta \\tau \\left( \\frac{2 a}{h} + \\frac{4 \\nu}{h^{2}} \\right) = 2 \\alpha + 4 \\mu = 2(\\alpha + 2\\mu) = 2 \\theta,\n$$\n最高频率模态的隐式放大系数为\n$$\n|G_{\\text{imp}}(\\pi)| = \\frac{1}{1 + 2 \\theta}.\n$$\n后向欧拉法是无条件稳定的，因为对于所有模态，$\\lambda(\\xi)$ 的实部都是非负的（这是由迎风对流和中心扩散保证的），并且对于任何 $\\Delta \\tau > 0$，都有 $|G_{\\text{imp}}(\\xi)| = 1/|1 + \\Delta \\tau\\,\\lambda(\\xi)| \\le 1$。\n\n当 $\\theta = 0.9$ 时，显式和隐式的高频放大因子模分别为\n$$\n|G_{\\text{exp}}(\\pi)| = |1 - 2(0.9)| = |1 - 1.8| = 0.8,\n$$\n$$\n|G_{\\text{imp}}(\\pi)| = \\frac{1}{1 + 2(0.9)} = \\frac{1}{2.8} \\approx 0.357142857.\n$$\n所要求的最高频率模态的隐式与显式放大因子模之比为\n$$\n\\frac{|G_{\\text{imp}}(\\pi)|}{|G_{\\text{exp}}(\\pi)|} = \\frac{1/(1 + 2 \\theta)}{|1 - 2 \\theta|} \\bigg|_{\\theta = 0.9} = \\frac{1/2.8}{0.8} = \\frac{1}{2.24} \\approx 0.446428571.\n$$\n四舍五入到四位有效数字，该比值为\n$$\n0.4464.\n$$\n该比值远小于1，量化地说明在显式稳定性极限的 $90\\%$ 处，隐式后向欧拉格式对最高频率模态的每步阻尼效果远强于显式前向欧拉格式，因为其放大因子模更小。",
            "answer": "$$\\boxed{0.4464}$$"
        },
        {
            "introduction": "在时间步进的基础之上，本练习将深入探讨伪瞬态方法中至关重要的预处理概念。您将首先证明一个简单的标量质量矩阵等价于对伪时间的均匀缩放，然后分析其在刚性系统上的性能。该分析将揭示为何这类简单格式在处理大条件数问题（例如由拉伸网格产生的问题）时表现不佳，从而阐明了为实现高效、稳健的收敛，采用先进的、非均匀预处理的必要性。",
            "id": "3987831",
            "problem": "在稳态计算流体力学 (CFD) 中，我们寻求一个状态向量 $u$，使得离散残差 $F(u) = 0$。伪瞬态延拓引入伪时间 $\\tau$，通过将稳态系统扩充为伪时间初值问题来正则化并加速收敛\n$$\nM(u)\\,\\frac{du}{d\\tau} + F(u) = 0,\n$$\n其中 $M(u)$ 是一个正定质量类算子。基于此公式，考虑以下包含两部分的任务。\n\nA部分：从第一性原理证明，如果选择标量质量矩阵 $M(u) = \\gamma I$ 且 $\\gamma > 0$，则此选择等价于对伪时间的均匀缩放。具体来说，证明存在一个变量替换 $\\tilde{\\tau} = \\tilde{\\tau}(\\tau)$，使得使用 $M(u)=\\gamma I$ 的伪瞬态演化与使用 $M(u)=I$ 但在缩放后的伪时间 $\\tilde{\\tau}$ 中表示的演化相同。\n\nB部分：为了分析此选择在高度拉伸网格上的效果，考虑在稳态 $u^{\\ast}$（其中 $F(u^{\\ast})=0$）附近的线性化，并且雅可比矩阵 $J \\equiv \\left.\\frac{\\partial F}{\\partial u}\\right|_{u^{\\ast}}$ 是可对角化的，其实谱包含在区间 $[\\alpha,\\beta]$ 内，其中 $0  \\alpha \\le \\beta$。定义误差 $e(\\tau) = u(\\tau) - u^{\\ast}$，则线性化的伪瞬态系统可写为\n$$\nM\\,\\frac{de}{d\\tau} + J e = 0.\n$$\n考虑一个大小为 $\\Delta \\tau>0$ 的单步显式欧拉伪时间步，得到迭代格式\n$$\ne^{k+1} = \\left(I - \\Delta \\tau\\,M^{-1} J\\right)\\,e^{k}.\n$$\n假设 $M=\\gamma I$ 并定义 $s = \\Delta \\tau/\\gamma$。仅使用这些假设和谱界 $[\\alpha,\\beta]$，确定此迭代的最小可能最坏情况单步收缩因子，定义为\n$$\n\\rho_{\\min} \\equiv \\min_{s0}\\;\\max_{\\lambda\\in[\\alpha,\\beta]}\\; \\left|1 - s\\,\\lambda\\right|.\n$$\n请以仅包含 $\\alpha$ 和 $\\beta$ 的闭式解析表达式给出你的最终答案。简要解释为什么这能衡量在条件数 $\\kappa = \\beta/\\alpha$ 很大的高度拉伸网格上，选择标量质量矩阵 $M=\\gamma I$ 的次优性。最终答案必须仅为 $\\rho_{\\min}$ 的表达式，无需单位。",
            "solution": "这个问题分为两部分。A部分要求证明伪瞬态延拓中标量质量矩阵的作用。B部分要求解一个极小化极大问题，以找到具有标量质量矩阵的线性系统的最优单步收缩因子。\n\nA部分：等价于时间缩放的证明\n\n给定伪瞬态初值问题：\n$$\nM(u)\\,\\frac{du}{d\\tau} + F(u) = 0\n$$\n我们被要求考虑质量矩阵是单位矩阵的标量倍数的情况，即 $M(u) = \\gamma I$，其中常数 $\\gamma > 0$。方程变为：\n$$\n\\gamma I\\,\\frac{du}{d\\tau} + F(u) = 0\n$$\n由于 $I$ 是单位算子，我们可以将其写为：\n$$\n\\gamma \\frac{du}{d\\tau} = -F(u)\n$$\n或\n$$\n\\frac{du}{d\\tau} = -\\frac{1}{\\gamma} F(u) \\quad (*_1)\n$$\n我们想证明这个演化与使用质量矩阵 $M(u)=I$ 但在缩放后的伪时间 $\\tilde{\\tau}$ 中表示的演化是相同的。$M(u)=I$ 的演化方程是：\n$$\nI\\,\\frac{du}{d\\tilde{\\tau}} + F(u) = 0\n$$\n简化为：\n$$\n\\frac{du}{d\\tilde{\\tau}} = -F(u) \\quad (*_2)\n$$\n为了证明等价性，我们提出从 $\\tau$到 $\\tilde{\\tau} = \\tilde{\\tau}(\\tau)$ 的变量替换。使用求导的链式法则，我们可以将关于 $\\tau$ 和 $\\tilde{\\tau}$ 的导数联系起来：\n$$\n\\frac{du}{d\\tau} = \\frac{du}{d\\tilde{\\tau}} \\frac{d\\tilde{\\tau}}{d\\tau}\n$$\n将此代入方程 $(*_1)$：\n$$\n\\frac{du}{d\\tilde{\\tau}} \\frac{d\\tilde{\\tau}}{d\\tau} = -\\frac{1}{\\gamma} F(u)\n$$\n现在，我们从方程 $(*_2)$ 中代入 $\\frac{du}{d\\tilde{\\tau}}$ 的表达式：\n$$\n(-F(u)) \\frac{d\\tilde{\\tau}}{d\\tau} = -\\frac{1}{\\gamma} F(u)\n$$\n假设我们尚未达到稳态解（即 $F(u) \\neq 0$），我们可以将两边同除以 $-F(u)$：\n$$\n\\frac{d\\tilde{\\tau}}{d\\tau} = \\frac{1}{\\gamma}\n$$\n这是一个关于 $\\tilde{\\tau}(\\tau)$ 的简单一阶常微分方程。对 $\\tau$ 积分可得：\n$$\n\\tilde{\\tau}(\\tau) = \\frac{1}{\\gamma} \\tau + C\n$$\n其中 $C$ 是积分常数。我们可以通过定义缩放后的时间在 $\\tau=0$ 时 $\\tilde{\\tau}=0$ 来令 $C=0$。因此，我们得到关系式：\n$$\n\\tilde{\\tau} = \\frac{\\tau}{\\gamma}\n$$\n这证明了在标量质量矩阵 $M(u) = \\gamma I$ 下的系统演化，与在缩放后的伪时间 $\\tilde{\\tau} = \\tau/\\gamma$ 中观察到的使用 $M(u)=I$ 的演化是相同的。标量因子 $\\gamma$ 只是在状态空间中沿着相同的轨迹加速（$\\gamma  1$）或减速（$\\gamma > 1$）演化过程。\n\nB部分：最优收缩因子\n\n我们被要求找到线性系统上显式欧拉迭代的最小可能最坏情况单步收缩因子。迭代格式由下式给出：\n$$\ne^{k+1} = \\left(I - \\Delta \\tau\\,M^{-1} J\\right)\\,e^{k}\n$$\n当 $M = \\gamma I$ 时，其逆矩阵为 $M^{-1} = \\frac{1}{\\gamma} I$。迭代格式变为：\n$$\ne^{k+1} = \\left(I - \\frac{\\Delta \\tau}{\\gamma} J\\right)\\,e^{k}\n$$\n定义 $s = \\Delta \\tau / \\gamma$，则放大矩阵为 $G = I - sJ$。单步收缩因子由 $G$ 的谱半径决定。由于 $J$ 是可对角化的，它的特征向量也是 $G$ 的特征向量。如果 $\\lambda$ 是 $J$ 的一个特征值，那么 $1 - s\\lambda$ 就是 $G$ 的一个特征值。因此，单步收缩因子是 $\\max_{\\lambda} |1 - s\\lambda|$，其中最大值取自 $J$ 的所有特征值 $\\lambda$。\n\n我们已知 $J$ 的实谱包含在区间 $[\\alpha, \\beta]$ 中，其中 $0  \\alpha \\le \\beta$。对于给定的 $s > 0$，最坏情况下的收缩因子是：\n$$\n\\rho(s) = \\max_{\\lambda \\in [\\alpha, \\beta]} |1 - s\\lambda|\n$$\n我们希望通过选择最优的 $s > 0$ 来找到这个因子的最小值：\n$$\n\\rho_{\\min} = \\min_{s0} \\rho(s) = \\min_{s0} \\max_{\\lambda \\in [\\alpha, \\beta]} |1 - s\\lambda|\n$$\n令 $f(\\lambda) = 1 - s\\lambda$。对于固定的 $s > 0$，这是关于 $\\lambda$ 的线性递减函数。因此，其绝对值 $|f(\\lambda)|$ 在闭区间 $[\\alpha, \\beta]$ 上的最大值必然出现在端点 $\\lambda = \\alpha$ 或 $\\lambda = \\beta$ 处。\n$$\n\\rho(s) = \\max \\left( |1 - s\\alpha|, |1 - s\\beta| \\right)\n$$\n我们寻求找到使 $\\rho(s)$ 最小化的 $s^* > 0$。这是一个经典的极小化极大问题。两个函数最大值的最小值通常出现在这两个函数大小相等的地方。我们来分析 $|1-s\\alpha|$ 和 $|1-s\\beta|$ 作为 $s$ 的函数的行为。最优值 $s^*$ 将平衡最慢模式（与 $\\alpha$ 相关）和最快模式（与 $\\beta$ 相关）的阻尼。当这两种模式的放大因子大小相等时，就达到了这种平衡：\n$$\n|1 - s^*\\alpha| = |1 - s^*\\beta|\n$$\n因为 $s>0$ 且 $\\beta \\ge \\alpha > 0$，我们有 $s\\beta \\ge s\\alpha$。对于最优的 $s^*$，它必须位于 $1/\\beta$ 和 $1/\\alpha$ 之间以平衡放大因子，这意味着 $1-s^*\\beta \\le 0$ 且 $1-s^*\\alpha \\ge 0$。因此，等式变为：\n$$\n1 - s^*\\alpha = -(1 - s^*\\beta) = s^*\\beta - 1\n$$\n求解 $s^*$：\n$$\n2 = s^*\\alpha + s^*\\beta = s^*(\\alpha + \\beta)\n$$\n$$\ns^* = \\frac{2}{\\alpha + \\beta}\n$$\n现在我们将这个最优值 $s^*$ 代回收缩因子的表达式，以求得 $\\rho_{\\min}$：\n$$\n\\rho_{\\min} = |1 - s^*\\alpha| = \\left|1 - \\frac{2\\alpha}{\\alpha + \\beta}\\right| = \\left|\\frac{\\alpha + \\beta - 2\\alpha}{\\alpha + \\beta}\\right| = \\left|\\frac{\\beta - \\alpha}{\\alpha + \\beta}\\right|\n$$\n由于 $\\beta \\ge \\alpha > 0$，分子是非负的，所以我们可以去掉绝对值符号：\n$$\n\\rho_{\\min} = \\frac{\\beta - \\alpha}{\\beta + \\alpha}\n$$\n我们可以用另一个端点来验证这个结果：\n$$\n\\rho_{\\min} = |1 - s^*\\beta| = \\left|1 - \\frac{2\\beta}{\\alpha + \\beta}\\right| = \\left|\\frac{\\alpha + \\beta - 2\\beta}{\\alpha + \\beta}\\right| = \\left|\\frac{\\alpha - \\beta}{\\alpha + \\beta}\\right| = \\frac{\\beta - \\alpha}{\\beta + \\alpha}\n$$\n结果吻合，证实了我们的解。\n\n这个结果量化了对于具有大条件数的问题，选择标量 $M=\\gamma I$ 的次优性。雅可比矩阵 $J$ 的条件数可以定义为 $\\kappa = \\beta/\\alpha$。我们可以用 $\\kappa$ 来表示 $\\rho_{\\min}$：\n$$\n\\rho_{\\min} = \\frac{\\beta/\\alpha - 1}{\\beta/\\alpha + 1} = \\frac{\\kappa - 1}{\\kappa + 1}\n$$\n在高度拉伸的网格上，离散化会导致雅可比矩阵非常刚性，这意味着它们具有很宽的特征值谱。这导致了非常大的条件数，$\\kappa \\gg 1$。当 $\\kappa \\to \\infty$ 时，最优收缩因子 $\\rho_{\\min} \\to 1$。接近 1 的收缩因子意味着迭代方法的收敛速度极慢。这表明，对于在航空航天CFD中常见的病态问题，选择简单的标量质量矩阵（等同于简单的松弛格式）是高度次优的。应该选择一个有效的预条件子 $M$ 来在某种意义上近似 $J$，使得 $M^{-1}J$ 的特征值聚集在一起，从而使 $\\kappa$ 接近 1，因此 $\\rho_{\\min}$ 接近 0。",
            "answer": "$$\\boxed{\\frac{\\beta - \\alpha}{\\beta + \\alpha}}$$"
        },
        {
            "introduction": "最后的练习将从线性模型问题过渡到现实世界中非线性系统的复杂性，特别是可压缩欧拉方程。重点是一个关键的实际挑战：在迭代求解过程中，确保密度和压力等热力学量的物理正定性。通过分析正定性约束如何限制允许的伪时间步长，您将理解为航空航天应用设计稳健可靠的CFD求解器的一个至关重要的方面。",
            "id": "3987780",
            "problem": "考虑用于航空航天计算流体动力学 (CFD) 的、基于理想气体定律的可压缩欧拉方程的有限体积半离散格式。伪瞬态延拓 (PTC) 方法通过添加伪时间导数项来扩充稳态方程。在下标为 $i$ 的控制体（单元）中，单位体积守恒变量为 $\\mathbf{U}_i = [\\rho_i, m_{x,i}, m_{y,i}, m_{z,i}, E_i]^T$，其中 $\\rho_i$ 是密度，$\\mathbf{m}_i = \\rho_i \\mathbf{u}_i$ 是动量，$\\mathbf{u}_i$ 是速度，而 $E_i$ 是总能。理想气体压力为 $p_i = (\\gamma - 1)\\left(E_i - \\tfrac{1}{2}\\rho_i \\|\\mathbf{u}_i\\|^2\\right)$，其中比热比 $\\gamma  1$ 为常数。半离散残差 $\\mathbf{R}_i(\\mathbf{U})$ 汇集了穿过控制体各个面的净通量，包括对流和声学（可压缩性）的贡献。\n\n伪时间演化由下式决定：\n$$\n\\frac{d \\mathbf{U}_i}{d t^*} + \\mathbf{R}_i(\\mathbf{U}) = \\mathbf{0},\n$$\n其中 $t^*$ 表示伪时间。使用伪时间步长 $\\Delta \\tau$ 的显式前向欧拉更新为：\n$$\n\\mathbf{U}_i^{n+1} = \\mathbf{U}_i^{n} - \\Delta \\tau\\, \\mathbf{R}_i(\\mathbf{U}^n).\n$$\n一种半隐式更新对选定的刚性（声学）分量进行隐式处理，同时保持对流分量为显式，其目的是在不违反密度和压力正性等物理约束的情况下，放宽声学稳定性限制。\n\n保持正性要求在每个控制体中都有 $\\rho_i^{n+1}  0$ 和 $p_i^{n+1}  0$。定义标量 $a$ 的正部为 $a^+ = \\max(a,0)$。设残差分量为 $R_{\\rho,i}$（连续性）、$\\mathbf{R}_{m,i}$（动量）和 $R_{E,i}$（能量），所有分量均在当前迭代步 $\\mathbf{U}_i^{n}$ 处计算。定义单位体积内能为 $q_i = E_i - \\tfrac{1}{2}\\|\\mathbf{m}_i\\|^2/\\rho_i$，因此 $p_i = (\\gamma - 1) q_i$。\n\n从守恒形式、理想气体状态方程以及上述定义出发，推断 $\\rho_i^{n+1}  0$ 和 $p_i^{n+1}  0$ 的要求如何约束了显式前向欧拉格式和通过隐式类压力修正项来阻尼声学刚性的半隐式格式所允许的伪时间步长 $\\Delta \\tau$。然后，选择所有能正确描述在单个控制体更新中为保持正性而对 $\\Delta \\tau$ 施加的局部充分界的陈述：\n\nA. 对于显式前向欧拉更新，保证 $\\rho_i^{n+1}  0$ 和 $p_i^{n+1}  0$ 的一个局部充分界是\n$$\n\\Delta \\tau \\le \\min\\!\\left(\\frac{\\rho_i^n}{R_{\\rho,i}^+},\\ \\frac{q_i^n}{\\left(R_{E,i} - \\mathbf{u}_i^n \\cdot \\mathbf{R}_{m,i} + \\tfrac{1}{2}\\|\\mathbf{u}_i^n\\|^2 R_{\\rho,i}\\right)^+}\\right).\n$$\n\nB. 在一个对声学项进行隐式处理的半隐式更新中，将残差分裂为 $\\mathbf{R}_i = \\mathbf{R}_i^{\\text{conv}} + \\mathbf{R}_i^{\\text{ac}}$。如果隐式修正项在内能方程中产生一个正的对角项，使得 $q_i^{n+1} = \\left(q_i^{n} - \\Delta \\tau\\, S_i^{\\text{conv}}\\right)/(1 + \\Delta \\tau\\, \\beta_i)$，其中 $\\beta_i \\ge 0$ 且 $S_i^{\\text{conv}} = R_{E,i}^{\\text{conv}} - \\mathbf{u}_i^n \\cdot \\mathbf{R}_{m,i}^{\\text{conv}} + \\tfrac{1}{2}\\|\\mathbf{u}_i^n\\|^2 R_{\\rho,i}^{\\text{conv}}$，那么一个局部的充分正性界是\n$$\n\\Delta \\tau \\le \\min\\!\\left(\\frac{\\rho_i^n}{R_{\\rho,i}^+},\\ \\frac{q_i^n}{\\left(S_i^{\\text{conv}}\\right)^+}\\right).\n$$\n\nC. 一个直接基于压力的界 $\\Delta \\tau \\le \\dfrac{p_i^n}{R_{p,i}^+}$，其中 $R_{p,i} = (\\gamma - 1) R_{E,i}$，对于保持正性是充分的，因为在理想气体定律下，压力线性依赖于能量。\n\nD. 对压力的半隐式处理移除了所有正性限制，因此任何 $\\Delta \\tau  0$ 都能保持 $\\rho_i^{n+1}  0$ 和 $p_i^{n+1}  0$，而与残差无关。\n\nE. 仅强制施加基于能量的约束 $\\Delta \\tau \\le \\dfrac{E_i^n}{R_{E,i}^+}$ 就足以保证 $p_i^{n+1}  0$，因为压力是随总能单调增加的。\n\n选择所有正确选项。将正确选项的字母按字母升序连接作为最终答案。",
            "solution": "该问题要求评估在使用伪瞬态延拓 (PTC) 方法求解可压缩欧拉方程时，为了保持密度 $\\rho$ 和压力 $p$ 的正性，伪时间步长 $\\Delta \\tau$ 需要满足的充分条件。正性意味着在新的时间步 $n+1$ 时，对于所有控制体 $i$，都有 $\\rho_i^{n+1}  0$ 和 $p_i^{n+1}  0$。\n\n状态变量是单位体积的守恒量 $\\mathbf{U}_i = [\\rho_i, \\mathbf{m}_i^T, E_i]^T$。压力由理想气体定律给出，$p_i = (\\gamma - 1)\\left(E_i - \\frac{1}{2}\\rho_i \\|\\mathbf{u}_i\\|^2\\right)$，其中 $\\mathbf{u}_i = \\mathbf{m}_i/\\rho_i$ 是速度，$\\gamma  1$。使用单位体积内能 $q_i = E_i - \\frac{1}{2}\\frac{\\|\\mathbf{m}_i\\|^2}{\\rho_i}$ 会更方便，这样 $p_i = (\\gamma - 1) q_i$。由于 $\\gamma - 1  0$，条件 $p_i  0$ 等价于 $q_i  0$。\n\n这些格式基于半离散形式：\n$$ \\frac{d \\mathbf{U}_i}{d t^*} = - \\mathbf{R}_i(\\mathbf{U}) $$\n其中 $\\mathbf{R}_i = [R_{\\rho,i}, \\mathbf{R}_{m,i}^T, R_{E,i}]^T$ 是残差向量。$\\mathbf{R}_i$ 的所有分量都在当前状态 $\\mathbf{U}^n$ 下计算。\n\n我们将分析选项中描述的每种格式的正性约束。\n\n### 显式前向欧拉格式分析\n\n显式前向欧拉更新由 $\\mathbf{U}_i^{n+1} = \\mathbf{U}_i^n - \\Delta\\tau \\mathbf{R}_i$ 给出。这适用于每个分量：\n1.  $\\rho_i^{n+1} = \\rho_i^n - \\Delta\\tau R_{\\rho,i}$\n2.  $\\mathbf{m}_i^{n+1} = \\mathbf{m}_i^n - \\Delta\\tau \\mathbf{R}_{m,i}$\n3.  $E_i^{n+1} = E_i^n - \\Delta\\tau R_{E,i}$\n\n**密度正性 ($\\rho_i^{n+1}  0$):**\n从密度更新方程，我们要求 $\\rho_i^n - \\Delta\\tau R_{\\rho,i}  0$。\n如果 $R_{\\rho,i} \\le 0$，密度不会减少，因此（假设 $\\rho_i^n  0$）该不等式对任何 $\\Delta\\tau  0$ 都成立。\n如果 $R_{\\rho,i}  0$，我们必须有 $\\Delta\\tau  \\frac{\\rho_i^n}{R_{\\rho,i}}$。\n一个覆盖这两种情况的充分条件是 $\\Delta\\tau \\le \\frac{\\rho_i^n}{R_{\\rho,i}^+}$，其中 $R_{\\rho,i}^+ = \\max(R_{\\rho,i}, 0)$。如果 $R_{\\rho,i}^+ = 0$，此约束对 $\\Delta\\tau$ 不施加上界。\n\n**压力正性 ($p_i^{n+1}  0 \\iff q_i^{n+1}  0$):**\n在时间步 $n+1$ 的内能是 $q_i^{n+1} = E_i^{n+1} - \\frac{1}{2}\\frac{\\|\\mathbf{m}_i^{n+1}\\|^2}{\\rho_i^{n+1}}$。代入显式更新会得到一个关于 $\\Delta\\tau$ 的非线性表达式。一个标准技巧是关于 $\\Delta\\tau$ 线性化 $q_i$ 的更新。$q_i$ 的时间导数是：\n$$ \\frac{dq_i}{dt^*} = \\frac{dE_i}{dt^*} - \\frac{d}{dt^*}\\left(\\frac{\\|\\mathbf{m}_i\\|^2}{2\\rho_i}\\right) = \\frac{dE_i}{dt^*} - \\frac{1}{\\rho_i}\\mathbf{m}_i \\cdot \\frac{d\\mathbf{m}_i}{dt^*} + \\frac{\\|\\mathbf{m}_i\\|^2}{2\\rho_i^2}\\frac{d\\rho_i}{dt^*} $$\n代入 $\\frac{d\\mathbf{U}_i}{dt^*} = -\\mathbf{R}_i$ 和 $\\mathbf{m}_i = \\rho_i \\mathbf{u}_i$：\n$$ \\frac{dq_i}{dt^*} = -R_{E,i} - \\frac{1}{\\rho_i}(\\rho_i \\mathbf{u}_i) \\cdot (-\\mathbf{R}_{m,i}) + \\frac{\\|\\rho_i \\mathbf{u}_i\\|^2}{2\\rho_i^2}(-R_{\\rho,i}) $$\n$$ \\frac{dq_i}{dt^*} = -\\left( R_{E,i} - \\mathbf{u}_i \\cdot \\mathbf{R}_{m,i} + \\frac{1}{2}\\|\\mathbf{u}_i\\|^2 R_{\\rho,i} \\right) $$\n我们定义内能更新的源项为 $S_i = R_{E,i} - \\mathbf{u}_i \\cdot \\mathbf{R}_{m,i} + \\frac{1}{2}\\|\\mathbf{u}_i\\|^2 R_{\\rho,i}$。所有项都在状态 $n$ 处计算。\n$q_i$ 的一阶前向欧拉更新则为 $q_i^{n+1} \\approx q_i^n + \\Delta\\tau \\left.\\frac{dq_i}{dt^*}\\right|_n = q_i^n - \\Delta\\tau S_i^n$。\n为使 $q_i^{n+1}  0$，我们要求 $q_i^n - \\Delta\\tau S_i^n  0$。\n如果 $S_i^n \\le 0$，内能不减少，因此该条件对任何 $\\Delta\\tau  0$ 都成立。\n如果 $S_i^n  0$，我们必须有 $\\Delta\\tau  \\frac{q_i^n}{S_i^n}$。\n一个充分条件是 $\\Delta\\tau \\le \\frac{q_i^n}{(S_i^n)^+}$。\n\n为同时保证 $\\rho_i^{n+1}  0$ 和 $q_i^{n+1}  0$，$\\Delta\\tau$ 必须同时满足两个约束。因此，一个充分的局部界是：\n$$ \\Delta \\tau \\le \\min\\!\\left(\\frac{\\rho_i^n}{R_{\\rho,i}^+},\\ \\frac{q_i^n}{\\left(R_{E,i} - \\mathbf{u}_i^n \\cdot \\mathbf{R}_{m,i} + \\tfrac{1}{2}\\|\\mathbf{u}_i^n\\|^2 R_{\\rho,i}\\right)^+}\\right) $$\n\n### 逐项分析\n\n**A. 对于显式前向欧拉更新，保证 $\\rho_i^{n+1}  0$ 和 $p_i^{n+1}  0$ 的一个局部充分界是\n$$ \\Delta \\tau \\le \\min\\!\\left(\\frac{\\rho_i^n}{R_{\\rho,i}^+},\\ \\frac{q_i^n}{\\left(R_{E,i} - \\mathbf{u}_i^n \\cdot \\mathbf{R}_{m,i} + \\tfrac{1}{2}\\|\\mathbf{u}_i^n\\|^2 R_{\\rho,i}\\right)^+}\\right). $$**\n这个陈述与我们上面为显式前向欧拉格式推导出的界完全匹配。该推导依赖于一阶分析，这是确定此类正性局部时间步长限制的标准方法。\n**结论：正确。**\n\n**B. 在一个对声学项进行隐式处理的半隐式更新中，将残差分裂为 $\\mathbf{R}_i = \\mathbf{R}_i^{\\text{conv}} + \\mathbf{R}_i^{\\text{ac}}$。如果隐式修正项在内能方程中产生一个正的对角项，使得 $q_i^{n+1} = \\left(q_i^{n} - \\Delta \\tau\\, S_i^{\\text{conv}}\\right)/(1 + \\Delta \\tau\\, \\beta_i)$，其中 $\\beta_i \\ge 0$ 且 $S_i^{\\text{conv}} = R_{E,i}^{\\text{conv}} - \\mathbf{u}_i^n \\cdot \\mathbf{R}_{m,i}^{\\text{conv}} + \\tfrac{1}{2}\\|\\mathbf{u}_i^n\\|^2 R_{\\rho,i}^{\\text{conv}}$，那么一个局部的充分正性界是\n$$ \\Delta \\tau \\le \\min\\!\\left(\\frac{\\rho_i^n}{R_{\\rho,i}^+},\\ \\frac{q_i^n}{\\left(S_i^{\\text{conv}}\\right)^+}\\right). $$**\n让我们分析给定的信息。密度的界 $\\Delta\\tau \\le \\rho_i^n / R_{\\rho,i}^+$ 意味着一个完全显式的密度更新：$\\rho_i^{n+1} = \\rho_i^n - \\Delta\\tau R_{\\rho,i}$。尽管许多半隐式格式也会对连续性方程的一部分进行隐式处理，但我们必须根据所提供的信息来评估该陈述。假设密度更新是显式的，那么这部分的界是正确的。\n\n对于内能正性，给定的更新形式为：$q_i^{n+1} = \\frac{q_i^{n} - \\Delta \\tau\\, S_i^{\\text{conv}}}{1 + \\Delta \\tau\\, \\beta_i}$。\n为确保 $q_i^{n+1}  0$，我们需要分子为正，因为对于 $\\Delta\\tau  0$ 和 $\\beta_i \\ge 0$，分母 $1 + \\Delta \\tau \\beta_i$ 保证为正。\n条件是 $q_i^n - \\Delta \\tau S_i^{\\text{conv}}  0$。\n如果 $S_i^{\\text{conv}}  0$，这要求 $\\Delta \\tau  \\frac{q_i^n}{S_i^{\\text{conv}}}$。\n一个充分条件是 $\\Delta\\tau \\le \\frac{q_i^n}{(S_i^{\\text{conv}})^+}$。\n将此与密度约束相结合，便得到了选项中提出的确切的界。这种格式的目的是使稳定性现在由对流残差 $S_i^{\\text{conv}}$ 而不是全残差 $S_i=S_i^{\\text{conv}}+S_i^{\\text{ac}}$ 控制，这通常允许更大的$\\Delta\\tau$。该陈述从给定的前提中正确地推导出了这个界。\n**结论：正确。**\n\n**C. 一个直接基于压力的界 $\\Delta \\tau \\le \\dfrac{p_i^n}{R_{p,i}^+}$，其中 $R_{p,i} = (\\gamma - 1) R_{E,i}$，对于保持正性是充分的，因为在理想气体定律下，压力线性依赖于能量。**\n这个陈述包含两个基本错误。\n首先，“压力线性依赖于能量”的说法混淆了总能 $E_i$ 和内能 $q_i$。正确的关系是 $p_i = (\\gamma-1)q_i$。与总能的关系是 $p_i = (\\gamma - 1)(E_i - \\frac{1}{2}\\rho_i \\|\\mathbf{u}_i\\|^2)$，这不是线性的，因为 $\\rho_i$ 和 $\\mathbf{u}_i$ 也是系统的变量。\n其次，所提出的压力残差 $R_{p,i} = (\\gamma - 1) R_{E,i}$ 是不正确的。它意味着更新为 $p_i^{n+1} \\approx p_i^n - \\Delta\\tau(\\gamma-1)R_{E,i}$。压力的正确线性化更新是 $p_i^{n+1} \\approx p_i^n - \\Delta\\tau(\\gamma-1)S_i^n$，其中 $S_i^n$ 是为选项A推导出的完整源项。所提出的 $R_{p,i}$ 忽略了来自能量和连续性残差的关键贡献，这些贡献解释了动能的变化。\n**结论：不正确。**\n\n**D. 对压力的半隐式处理移除了所有正性限制，因此任何 $\\Delta \\tau  0$ 都能保持 $\\rho_i^{n+1}  0$ 和 $p_i^{n+1}  0$，而与残差无关。**\n这是一个夸大的说法。如选项B的分析所示，半隐式格式仍然有正性约束，尽管它们可能比完全显式格式的限制要小。更新的显式部分（例如，选项B中的 $S_i^{\\text{conv}}$ 项，以及通常的完全密度更新）仍然对 $\\Delta\\tau$ 施加了限制。无条件正性是一个非常强的属性，对于像欧拉方程这样的非线性系统，标准的半隐式方法通常无法实现。例如，在选项B的格式中，如果 $S_i^{\\text{conv}}$ 变得很大且为正，一个足够大的 $\\Delta\\tau$ 将会违反条件 $\\Delta\\tau  q_i^n/S_i^{\\text{conv}}$，导致负压。\n**结论：不正确。**\n\n**E. 仅强制施加基于能量的约束 $\\Delta \\tau \\le \\dfrac{E_i^n}{R_{E,i}^+}$ 就足以保证 $p_i^{n+1}  0$，因为压力是随总能单调增加的。**\n约束 $\\Delta\\tau \\le \\frac{E_i^n}{R_{E,i}^+}$ 足以确保总能保持为正，即 $E_i^{n+1}  0$。然而，正压力需要正的*内*能，$q_i^{n+1} = E_i^{n+1} - K^{n+1}  0$，其中 $K^{n+1} = \\frac{1}{2}\\frac{\\|\\mathbf{m}_i^{n+1}\\|^2}{\\rho_i^{n+1}}$ 是动能。动能 $K^{n+1}$ 完全有可能大于总能 $E_i^{n+1}$（即使 $E_i^{n+1}  0$），这将导致负的内能和压力。仅对总能的约束不能控制密度和动量的更新，因此不能保证动能项的大小。“压力随总能单调增加”的推理也是有缺陷的，因为它忽略了更新过程中动能的并发变化。\n**结论：不正确。**",
            "answer": "$$\\boxed{AB}$$"
        }
    ]
}