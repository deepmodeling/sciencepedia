## 引言
在计算流体力学（CFD）领域，高效求解描述[定常流](@entry_id:191654)动的[非线性方程组](@entry_id:178110)是核心挑战之一。尽管存在多种数值策略，但受时间演化启发的伪瞬态方法因其稳健性而备受青睐。然而，当使用统一的全局时间步长时，计算域中最小的网格单元将严重制约整体的[收敛速度](@entry_id:636873)，导致计算成本高昂。本文旨在系统性地解决这一效率瓶颈，深入探讨一种强大的[收敛加速](@entry_id:165787)技术——[局部时间步进](@entry_id:751409)（Local Time Stepping, LTS）。

通过阅读本文，您将全面掌握LTS的理论与实践。第一章**“原理与机制”**将从[伪瞬态延拓法](@entry_id:753844)入手，详细阐述LTS的核心思想，即为每个单元量身定制其最优伪时间步长，并探讨其[稳定性理论](@entry_id:149957)与关键实现陷阱。第二章**“应用与跨学科连接”**将展示LTS在航空航天、传热学及[反应流](@entry_id:190741)等领域的广泛应用，并讨论其与多重网格、[预处理](@entry_id:141204)等先进技术的协同作用。最后，第三章**“动手实践”**提供了一系列精心设计的问题，旨在帮助读者将理论知识转化为解决实际问题的能力。

现在，让我们从LTS的基本原理出发，揭示它如何突破传统方法的限制，为高效的[稳态模拟](@entry_id:755413)铺平道路。

## 原理与机制

在寻求计算流体力学（CFD）中[定常流](@entry_id:191654)问题的数值解时，一个核心挑战是如何高效地求解描述流体运动的[非线性](@entry_id:637147)[代数方程](@entry_id:272665)组。这些方程组源于对偏[微分控制](@entry_id:270911)方程（如欧拉或[纳维-斯托克斯方程](@entry_id:142275)）的[空间离散化](@entry_id:172158)。虽然牛顿法等[直接求解器](@entry_id:152789)理论上收敛速度快，但其计算成本和内存需求对于大规模问题而言往往高得令人望而却步。因此，迭代法，特别是那些受时间演化物理过程启发的伪瞬态方法，成为了一种流行且强大的替代方案。本章将深入探讨一种关键的加速技术——**[局部时间步进](@entry_id:751409)（Local Time Stepping, LTS）**的原理与机制，它通过优化迭代路径来显著加快定常解的收敛速度。

### [伪瞬态延拓法](@entry_id:753844)：从瞬态问题到定常解

[定常流](@entry_id:191654)动的控制方程在离散后形成一个大型[非线性](@entry_id:637147)[代数方程](@entry_id:272665)组，其一般形式可以写作 $\boldsymbol{R}(\boldsymbol{U}) = \boldsymbol{0}$，其中 $\boldsymbol{U}$ 是包含所有网格单元上守恒变量的全局状态向量，而 $\boldsymbol{R}(\boldsymbol{U})$ 是对应的[残差向量](@entry_id:165091)，代表了每个单元中通量的净不平衡。当流动达到定常状态时，每个控制体中的净通量为零，即[残差向量](@entry_id:165091)为零。

**[伪瞬态延拓](@entry_id:753844)（Pseudo-Transient Continuation, PTC）**方法将这个[寻根问题](@entry_id:174994)巧妙地转化为一个[伪时间](@entry_id:262363)上的“演化”问题。我们引入一个人工的[伪时间](@entry_id:262363)变量 $\tau$，并构造如下的常微分方程（ODE）系统：

$$
\frac{d \boldsymbol{U}}{d \tau} + \boldsymbol{R}(\boldsymbol{U}) = \boldsymbol{0}
$$

这个方程的[稳态解](@entry_id:200351)（当 $\frac{d \boldsymbol{U}}{d \tau} = \boldsymbol{0}$ 时）恰好就是我们所寻求的原始定常问题的解，即 $\boldsymbol{R}(\boldsymbol{U}) = \boldsymbol{0}$。因此，我们可以通过对这个伪瞬态方程进行时间积分，从一个任意的初始猜测 $\boldsymbol{U}(\tau=0)$ 出发，直到系统达到稳定状态，从而求得定常解。

理解PTC方法的关键在于区分**伪瞬态演化**与**物理瞬态演化** 。当我们求解一个真实的[非定常流](@entry_id:269993)动问题时，时间 $t$ 是物理时间，其演化路径 $\boldsymbol{U}(t)$ 描述了流场在真实时间中的变化，因此时间积分的精度至关重要。整个计算域必须使用一个统一的、由最严格的稳定性条件限制的全局时间步长 $\Delta t$ 来推进，以保证物理因果关系。

然而，在[伪瞬态延拓](@entry_id:753844)中，$\tau$ 只是一个迭代计数器或路径参数，其演化路径 $\boldsymbol{U}(\tau)$ 本身没有直接的物理意义。我们的唯一目标是尽快到达 $\boldsymbol{R}(\boldsymbol{U}) = \boldsymbol{0}$ 这个不动点。这意味着：

1.  **物理瞬态过程被舍弃**：我们不关心解从初始猜测到最终定常态的中间路径是否符合物理规律。
2.  **时间精度不再是要求**：我们不再需要精确地模拟[伪时间](@entry_id:262363)上的演化，只需要保证迭代过程稳定地走向定常解。
3.  **最终[解的唯一性](@entry_id:143619)**：只要迭代收敛，最终得到的定常解仅由 $\boldsymbol{R}(\boldsymbol{U}) = \boldsymbol{0}$ 决定，而与伪时间积分所采用的路径（即时间步长的选择）无关 。

正是这种对瞬态路径的“漠不关心”，为[局部时间步进](@entry_id:751409)（LTS）的应用打开了大门，使其成为一种强大的[收敛加速](@entry_id:165787)策略。

### 核心机制：局部稳定与时间步长计算

在[伪瞬态延拓](@entry_id:753844)的框架下，最简单的前向欧拉显式迭代格式可以写为：

$$
\boldsymbol{U}_i^{n+1} = \boldsymbol{U}_i^{n} - \frac{\Delta \tau_i}{V_i} \boldsymbol{R}_i(\boldsymbol{U}^n)
$$

其中，$\boldsymbol{U}_i^n$ 是单元 $i$ 在第 $n$ 次迭代时的[状态向量](@entry_id:154607)，$V_i$ 是单元体积，$\boldsymbol{R}_i$ 是该单元的残差（净通量），而 $\Delta \tau_i$ 是为单元 $i$ **局部**选择的[伪时间](@entry_id:262363)步长。

使用[局部时](@entry_id:194383)间步长的核心思想是：计算域中不同区域的稳定性限制是不同的。例如，在网格尺寸小、流速高的区域，[显式格式](@entry_id:1124773)的稳定性要求非常小的时间步长；而在网格尺寸大、流速低的区域，则可以安全地使用大得多的时间步长。在[全局时间步进](@entry_id:749933)中，整个计算域的推进速度被最“慢”的那个单元所拖累。[局部时间步进](@entry_id:751409)则打破了这一限制，允许每个单元 $i$ 都使用其自身允许的最大稳定时间步长 $\Delta \tau_i$ 进行演化，从而最大化每个单元的收敛速度。

这个局部的最大稳定时间步长通常由**Courant-Friedrichs-Lewy (CFL)**条件决定。对于一个有限体积单元 $i$，其时间步长受到信息（或波）穿越该单元所需时间的限制。对于一个包含多个面 $f \in \partial \Omega_i$ 的通用控制体，一个标准的LTS公式为 ：

$$
\Delta \tau_i = \text{CFL} \frac{V_i}{\sum_{f \in \partial \Omega_i} \alpha_{if} A_{if}}
$$

这里的各项定义如下：
*   $\text{CFL}$ 是一个小于等于1的常数，称为柯朗数，作为安全因子。
*   $V_i$ 是单元 $i$ 的体积（或面积，在2D中）。
*   $A_{if}$ 是单元 $i$ 的面 $f$ 的面积。
*   $\alpha_{if}$ 是通过面 $f$ 传播的信息的[特征速度](@entry_id:165394)，它通常取为通量[雅可比矩阵](@entry_id:178326) $\boldsymbol{A}_{n,if} = \frac{\partial (\boldsymbol{F} \cdot \boldsymbol{n}_f)}{\partial \boldsymbol{U}}$ 在该面法向上的谱半径，即 $\alpha_{if} = \rho(\boldsymbol{A}_{n,if})$。

这个公式的分母 $\sum_{f} \alpha_{if} A_{if}$ 可以被物理解释为离开或进入单元 $i$ 的“信息通量”的总和。因此，$\Delta \tau_i$ 正比于单元的“容量”（体积），反比于信息交换的速率。

为了更具体地理解，我们考虑无粘可压缩流动的[欧拉方程](@entry_id:177914)。此时，通过面 $f$ 的法向特征[波速](@entry_id:186208)度为 $\{u_n - a, u_n, u_n + a\}$，其中 $u_n = \boldsymbol{u} \cdot \boldsymbol{n}_f$ 是法向流速，$a$ 是声速。其[谱半径](@entry_id:138984)（[最大特征值](@entry_id:1127078)的绝对值）为 ：

$$
\alpha_{if} = \max(|u_n - a|, |u_n|, |u_n + a|) = |u_n| + a
$$

将此代入LTS公式，我们就得到了适用于[无粘流](@entry_id:273124)动的具体时间步长计算方法。在实践中，我们通常为整个计算场设定一个目标CFL数（例如0.8），然后在每次迭代（或每隔几次迭代）中，根据每个单元当前的流场状态（$u_n$ 和 $a$）计算出相应的 $\Delta \tau_i$。

我们也可以从另一个角度定义**局部CFL数** $\text{CFL}_i$ ：

$$
\text{CFL}_i = \frac{\Delta \tau_i}{V_i} \sum_{f \in \mathcal{F}(i)} \rho(\boldsymbol{A}_{n,if}) A_{if}
$$

LTS策略的目标就是为每个单元 $i$ 选择一个 $\Delta \tau_i$，使得所有单元的 $\text{CFL}_i$ 都等于一个预设的目标值，从而使每个单元都以其最大允许速率向定常解收敛。

### 扩展至[粘性流](@entry_id:136330)动

当考虑更真实的[纳维-斯托克斯方程](@entry_id:142275)时，除了对流（双曲性）项，我们还必须处理粘性（抛物性）或扩散项。粘性项引入了其自身的稳定性限制。对于一个显式格式，[扩散过程](@entry_id:268015)的时间步长限制通常与网格尺寸的平方成正比，即 $\Delta \tau_\nu \propto h^2/\nu$，其中 $h$ 是特征网格尺寸，$\nu$ 是[运动粘度](@entry_id:275614)。

因此，对于粘性流动，每个单元的[局部时](@entry_id:194383)间步长受到两个条件的共同制约：对流[CFL条件](@entry_id:178032)和粘性稳定性条件。总的[局部时](@entry_id:194383)间步长必须是两者中更严格（即更小）的那个 ：

$$
\Delta \tau_i = \min(\Delta \tau_{c,i}, \Delta \tau_{\nu,i})
$$

其中，
*   对流时间步长 $\Delta \tau_{c,i} \approx C_c \frac{h_i}{|\boldsymbol{u}_i| + a_i}$
*   粘性时间步长 $\Delta \tau_{\nu,i} \approx C_{\nu} \frac{h_i^2}{\nu_{\text{eff},i}}$

这里的 $\nu_{\text{eff},i}$ 是有效运动粘度（包括分子粘度和[湍流](@entry_id:151300)涡粘度）。在附面层等网格非常精细的区域，$h_i$ 很小，导致 $\Delta \tau_{\nu,i}$ 中的 $h_i^2$ 项变得极小，此时粘性限制往往会成为主导。正确地结合这两种限制对于保证[粘性流](@entry_id:136330)模拟的稳健性至关重要。

### 理论基础与收敛特性

[局部时间步进](@entry_id:751409)的有效性可以从[线性稳定性理论](@entry_id:270609)的角度进行更深入的分析。考虑线性化的误差传播方程，对于单元 $i$ 的误差 $\boldsymbol{e}_i^n$：

$$
\boldsymbol{e}_i^{n+1} = (\boldsymbol{I} - \Delta \tau_i J_i) \boldsymbol{e}_i^n
$$

其中 $J_i = \frac{\partial \boldsymbol{R}_i}{\partial \boldsymbol{U}_i}$ 是局部残差算子的[雅可比矩阵](@entry_id:178326)。为了使误差衰减，[迭代矩阵](@entry_id:637346) $\boldsymbol{G}_i = \boldsymbol{I} - \Delta \tau_i J_i$ 的[谱半径](@entry_id:138984)必须小于1。对于其每个特征值 $\mu_k$，必须满足 $|1 - \Delta \tau_i \mu_k| \lt 1$。

如果 $J_i$ 的特征值 $\mu_k$ 是实数且非负（这在包含[数值耗散](@entry_id:168584)的[迎风格式](@entry_id:756378)中很常见），这个条件简化为 $0 \lt \Delta \tau_i \mu_k \lt 2$。为了对所有模式都稳定，必须满足 $\Delta \tau_i \rho(J_i) \lt 2$，其中 $\rho(J_i)$ 是 $J_i$ 的谱半径。这为CFL条件提供了理论依据，即[局部时](@entry_id:194383)间步长必须受限于局部[雅可比矩阵](@entry_id:178326)[谱半径](@entry_id:138984)的倒数 。将局部CFL数定义为 $C_i = \rho(J_i) \Delta \tau_i$，稳定性条件即为 $C_i \lt 2$ 。

然而，收敛性不仅仅是局部问题。迭代的[全局收敛性](@entry_id:635436)取决于全局[迭代矩阵](@entry_id:637346) $\boldsymbol{T} = \boldsymbol{I} - \mathbf{D}\mathbf{A}$ 的谱半径，其中 $\mathbf{D}$ 是包含所有 $\Delta \tau_i$ 的[对角矩阵](@entry_id:637782)，$\mathbf{A}$ 是全局[雅可比矩阵](@entry_id:178326)。一个关键的警示是，即使每个局部的、对角块上的迭代都是**收缩映射（contractive mapping）**，由于块间耦合（非对角块）的存在，全局迭代仍有可能发散 。这意味着强烈的单元间耦合可能会破坏仅基于局部信息选择时间步长所带来的稳定性。尽管如此，在实践中，对于大多数由物理[输运过程](@entry_id:177992)主导的CFD问题，LTS通常是稳健的。根据[不动点定理](@entry_id:143811)，只要在定常解 $\boldsymbol{U}^\star$ 附近，迭代映射的[雅可比矩阵](@entry_id:178326)的[谱半径](@entry_id:138984)小于1，局部收敛性就能得到保证 。

### 关键实现问题与潜在陷阱

虽然LTS原理上很简单，但在实际代码实现中存在一些必须妥善处理的微妙之处，否则可能导致严重的数值错误。

#### A. 保持[离散守恒](@entry_id:1123819)性

[有限体积法](@entry_id:141374)的一个核心优点是其内建的[离散守恒](@entry_id:1123819)性，即在一个内部面上，离开一个单元的通量精确等于进入相邻单元的通量。然而，一种天真的LTS实现方式可能会破坏这种守恒性 。

考虑相邻单元 $i$ 和 $j$，它们共享一个面 $f$。如果它们使用不同的时间步长 $\Delta \tau_i \neq \Delta \tau_j$ 进行更新，并且在一次迭代中，单元 $i$ 的[守恒量](@entry_id:161475)变化为 $-\Delta \tau_i \Phi_f$，而单元 $j$ 的变化为 $+\Delta \tau_j \Phi_f$（其中 $\Phi_f$ 是从 $i$ 流向 $j$ 的通量），那么在面 $f$ 上的交换总量为 $(\Delta \tau_j - \Delta \tau_i)\Phi_f \neq 0$。这意味着在该内部面上凭空产生或消失了[守恒量](@entry_id:161475)，从而导致全局不守恒。

正确的守恒实现方式是采用**通量累加（flux accumulation）**方法。在这种方法中，我们不再直接用 $\Delta \tau_i$ 去乘残差，而是计算一个在时间上积分的通量。对于每个内部面 $f$，在一次宏观迭代步中，计算并累加其净通量 $\mathcal{J}_f$。然后，在更新相邻单元 $i$ 和 $j$ 的状态时，将这同一个累加通量值 $\mathcal{J}_f$ 以相反的符号分别作用于它们。这样，无论每个单元内部的子循环或时间步长如何不同，跨内部面的通量交换总是精确抵消，从而严格保证了[离散守恒](@entry_id:1123819)性 。

#### B. 保证物理可容许性（[正定性](@entry_id:149643)）

对于[可压缩流](@entry_id:747589)动，密度 $\rho$ 和压力 $p$ 必须始终为正。如果迭代过程中出现负密度或[负压](@entry_id:161198)，[物态方程](@entry_id:194191)和声速计算将变得无意义，导致计算崩溃。一个数值格式要保证**正定性（positivity-preserving）**，就需要确保在输入为物理可容许的状态时，其输出也保持在可容许集内 。

对于许多[一阶迎风格式](@entry_id:749417)，当满足某个CFL类型的条件时，单元的新状态可以表示为它自身旧状态和其邻居旧状态的一个**[凸组合](@entry_id:635830)（convex combination）**。例如，$U_i^{n+1} = \sum_k w_k U_k^n$，其中所有权重 $w_k \ge 0$ 且 $\sum_k w_k = 1$。由于物理可容许状态集是凸的，这种更新方式自然地保持了[正定性](@entry_id:149643)。这个[凸组合](@entry_id:635830)的条件通常转化为对[局部时](@entry_id:194383)间步长的限制，形式为 $\sum_{f \in \partial \Omega_i} C_{if} \leq c$，其中 $c$ 是一个通常为1的常数 。因此，为了程序的稳健性，选择的CFL数不仅要满足线性稳定性，还需满足更严格的正定性要求。

#### C. 避免伪定常态

LTS的最终目标是找到满足 $\boldsymbol{R}(\boldsymbol{U}) = \boldsymbol{0}$ 的真定常解。然而，不正确的实现可能导致迭代收敛到一个**伪定常态（spurious steady state）**，即迭代停止了（更新量趋于零），但此时的物理解残差 $\boldsymbol{R}(\boldsymbol{U}^\star)$ 并不为零 。

这种情况的根源在于，迭代的实际不动点是由代码中**被实现的残差算子** $\mathcal{R}$ 决定的，即 $\mathcal{R}(\boldsymbol{U}^\star)=\boldsymbol{0}$。如果 $\mathcal{R}$ 由于实现上的错误而与理论上的守恒残差算子 $\boldsymbol{R}$ 不同，那么它的零点也不同。

一个正确的LTS实现，其迭代格式为 $U_i^{n+1} = U_i^n - (\Delta \tau_i/V_i) R_i(u^n)$，它的不动点条件是 $R_i(u^\star)=0$，这正是我们想要的真定常解 。

导致伪定常态的常见错误包括：

*   **混合时间层级的计算**：在一个迭代步内[异步更新](@entry_id:266256)单元，导致计算某个单元的通量时，其邻居可能已经更新到了新的时间层级。这会引入一个非守恒的、依赖于更新顺序的残差算子 。
*   **非守恒的残差加权**：错误地将时间步长直接乘到通量上，而不是作用于完整的单元残差，从而破坏了内部面通量的“有借有还”的守恒特性 。

总之，[局部时间步进](@entry_id:751409)是一种功能强大但需要精细实现的[收敛加速](@entry_id:165787)技术。通过为计算域中的每个单元量身定制其伪时间步长，LTS能够显著减少达到定常解所需的迭代次数。然而，使用者必须对其理论基础和实现细节有深刻的理解，特别是要确保[离散守恒](@entry_id:1123819)性和物理可容许性得到维持，以避免得到无意义的或错误的数值解。