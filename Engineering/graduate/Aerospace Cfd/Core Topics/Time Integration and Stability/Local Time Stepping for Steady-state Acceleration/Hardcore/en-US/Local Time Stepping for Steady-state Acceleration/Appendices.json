{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of any Local Time Stepping (LTS) implementation is the ability to determine the maximum stable time step for each individual cell in a mesh. This calculation is governed by the local Courant–Friedrichs–Lewy (CFL) condition, which connects a cell's geometry and the local wave speeds to the stability of the explicit time-marching scheme. This first exercise  provides fundamental practice in deriving and applying the formula for the local time step, $ \\Delta \\tau_{i} $, for an inviscid flow on a representative unstructured mesh cell.",
            "id": "3974157",
            "problem": "In two-dimensional compressible Computational Fluid Dynamics (CFD), consider a finite-volume, explicit pseudo-time advancement used to accelerate convergence to a steady state on an unstructured grid. A single control volume (cell) with index $i$ has a polygonal boundary composed of faces indexed by $f$, each with outward unit normal, face measure, and a numerical flux computed via an upwind linearization whose Jacobian has a maximal characteristic speed magnitude along the face-normal denoted by $|\\lambda_{f}|$. The local Courant–Friedrichs–Lewy (CFL) constraint for stability of a forward-Euler pseudo-time update is enforced by selecting a cell-wise pseudo-time step $ \\Delta \\tau_{i} $.\n\nStarting from the semi-discrete finite-volume conservation form for a generic hyperbolic system and the requirement that the explicit update be stable under the spectral-radius bound of the linearized discrete operator, derive the cell-local stability restriction for $ \\Delta \\tau_{i} $ in terms of the cell volume $V_{i}$, the face measures $A_{f}$, and the face-normal characteristic speed magnitudes $|\\lambda_{f}|$. Then evaluate $ \\Delta \\tau_{i} $ for the following unstructured quadrilateral cell.\n\nThe cell vertices are ordered counterclockwise as\n- $P_{1} = (0, 0)$,\n- $P_{2} = (1.2, 0.1)$,\n- $P_{3} = (1.0, 0.9)$,\n- $P_{4} = (-0.1, 0.8)$.\n\nUse the polygon area formula to compute $V_{i}$ and the Euclidean distance between successive vertices to compute the face measures $A_{f}$ for faces $(P_{1},P_{2})$, $(P_{2},P_{3})$, $(P_{3},P_{4})$, and $(P_{4},P_{1})$, respectively. The given face-normal maximal characteristic speed magnitudes are\n- $|\\lambda_{(P_{1},P_{2})}| = 290$ $\\mathrm{m/s}$,\n- $|\\lambda_{(P_{2},P_{3})}| = 260$ $\\mathrm{m/s}$,\n- $|\\lambda_{(P_{3},P_{4})}| = 300$ $\\mathrm{m/s}$,\n- $|\\lambda_{(P_{4},P_{1})}| = 250$ $\\mathrm{m/s}$.\n\nLet the CFL number be $ \\mathrm{CFL} = 0.7 $. Compute $ \\Delta \\tau_{i} $ using the derived restriction. Express your final answer in seconds and round your numerical result to four significant figures.",
            "solution": "The problem requires two parts: first, a derivation of the local time-step restriction for an explicit finite-volume scheme on an unstructured grid, and second, the calculation of this time step for a specific quadrilateral cell.\n\n**Part 1: Derivation of the Local Time-Step Restriction**\n\nWe begin with the integral form of a system of hyperbolic conservation laws over a control volume (cell) $V_i$:\n$$ \\frac{d}{d\\tau} \\int_{V_i} \\mathbf{U} \\, dV + \\oint_{\\partial V_i} \\mathbf{F} \\cdot \\mathbf{n} \\, dA = \\mathbf{0} $$\nwhere $\\mathbf{U}$ is the vector of conserved state variables, $\\mathbf{F}$ is the flux tensor, and $\\mathbf{n}$ is the outward-pointing unit normal to the boundary $\\partial V_i$.\n\nIn a finite-volume method, we consider the cell-averaged state vector $\\mathbf{U}_i = \\frac{1}{V_i} \\int_{V_i} \\mathbf{U} \\, dV$. The semi-discrete form of the equations is obtained by approximating the boundary integral as a sum of numerical fluxes over the faces of the cell:\n$$ V_i \\frac{d\\mathbf{U}_i}{d\\tau} = - \\sum_{f \\in \\partial V_i} \\mathcal{F}_f A_f = \\mathbf{R}_i(\\mathbf{U}) $$\nHere, $V_i$ is the volume (area in 2D) of cell $i$, $A_f$ is the measure (length in 2D) of face $f$, $\\mathcal{F}_f$ is the numerical flux vector normal to face $f$, and $\\mathbf{R}_i(\\mathbf{U})$ is the discrete residual for cell $i$.\n\nFor accelerating convergence to a steady state, a pseudo-time advancement is used. A simple explicit, first-order forward Euler scheme is given by:\n$$ \\mathbf{U}_i^{n+1} = \\mathbf{U}_i^n + \\frac{\\Delta \\tau_i}{V_i} \\mathbf{R}_i(\\mathbf{U}^n) = \\mathbf{U}_i^n - \\frac{\\Delta \\tau_i}{V_i} \\sum_{f \\in \\partial V_i} \\mathcal{F}_f A_f $$\nwhere $\\Delta \\tau_i$ is the local pseudo-time step for cell $i$.\n\nThe stability of this explicit scheme is determined by the spectral radius of the iteration matrix. The numerical flux $\\mathcal{F}_f$ for an upwind-type scheme (like Roe's approximate Riemann solver) on a face $f$ separating cells $i$ and $j$ can be expressed in terms of the flux Jacobian $\\mathbf{A}_{n,f} = \\frac{\\partial(\\mathbf{F} \\cdot \\mathbf{n}_f)}{\\partial \\mathbf{U}}$ evaluated at an appropriate interface state. The stability analysis of the full system is complex. A common and practical approach is to enforce a condition based on the physical domain of dependence, often derived by considering a matrix version of the Courant–Friedrichs–Lewy (CFL) condition.\n\nThe update for $\\mathbf{U}_i$ depends on its own state and the states of its neighbors. The stability restriction on $\\Delta \\tau_i$ arises from ensuring that the coefficient matrix multiplying $\\mathbf{U}_i^n$ in the update rule does not lead to amplification of errors. The influence of neighboring cells propagates into cell $i$ at characteristic speeds. The fastest such speed normal to a face $f$ is given by $|\\lambda_f|$, which is the spectral radius of the face-normal flux Jacobian, $\\rho(\\mathbf{A}_{n,f})$.\n\nThe stability criterion for a forward Euler scheme applied to a system with a spatial operator whose spectral radius is $\\rho(\\mathbf{L}_i)$ is $\\Delta \\tau_i \\rho(\\mathbf{L}_i) \\le \\mathrm{CFL_{max}}$. For the finite-volume operator, an estimate for the spectral radius for cell $i$ is constructed from the sum of influences from all its faces:\n$$ \\rho(\\mathbf{L}_i) \\approx \\frac{1}{V_i} \\sum_{f \\in \\partial V_i} \\rho(\\mathbf{A}_{n,f}) A_f = \\frac{1}{V_i} \\sum_{f \\in \\partial V_i} |\\lambda_f| A_f $$\nThis estimate is based on the idea that in one time step, information travels a distance $|\\lambda_f|\\Delta \\tau_i$ across face $f$. The total \"flux of information\" into the cell must be limited relative to the cell's \"capacity\", which is its volume $V_i$.\n\nSubstituting this spectral radius estimate into the stability condition yields:\n$$ \\Delta \\tau_i \\left( \\frac{1}{V_i} \\sum_{f \\in \\partial V_i} |\\lambda_f| A_f \\right) \\le \\mathrm{CFL} $$\nThe problem provides a desired CFL number, so we rearrange to find the maximum permissible local time step $\\Delta \\tau_i$:\n$$ \\Delta \\tau_i \\le \\frac{\\mathrm{CFL} \\cdot V_i}{\\sum_{f \\in \\partial V_i} |\\lambda_f| A_f} $$\nTo maximize the convergence rate, the equality is used:\n$$ \\Delta \\tau_i = \\mathrm{CFL} \\frac{V_i}{\\sum_{f \\in \\partial V_i} |\\lambda_f| A_f} $$\nThis is the derived cell-local stability restriction.\n\n**Part 2: Calculation for the Specific Cell**\n\nWe apply the derived formula to the given quadrilateral cell. The required quantities are the cell area $V_i$, the face lengths $A_f$, the characteristic speeds $|\\lambda_f|$, and the CFL number.\n\n**Given Data:**\n- Vertices: $P_1 = (0, 0)$, $P_2 = (1.2, 0.1)$, $P_3 = (1.0, 0.9)$, $P_4 = (-0.1, 0.8)$.\n- Speeds: $|\\lambda_1| = |\\lambda_{(P_1,P_2)}| = 290$, $|\\lambda_2| = |\\lambda_{(P_2,P_3)}| = 260$, $|\\lambda_3| = |\\lambda_{(P_3,P_4)}| = 300$, $|\\lambda_4| = |\\lambda_{(P_4,P_1)}| = 250$.\n- CFL number: $\\mathrm{CFL} = 0.7$.\n\n**Step 1: Compute Cell Area $V_i$**\nUsing the shoelace formula for the area of a polygon with vertices $(x_1, y_1), \\dots, (x_4, y_4)$:\n$$ V_i = \\frac{1}{2} | (x_1y_2 + x_2y_3 + x_3y_4 + x_4y_1) - (y_1x_2 + y_2x_3 + y_3x_4 + y_4x_1) | $$\n$$ V_i = \\frac{1}{2} | \\left(0 \\cdot 0.1 + 1.2 \\cdot 0.9 + 1.0 \\cdot 0.8 + (-0.1) \\cdot 0\\right) - \\left(0 \\cdot 1.2 + 0.1 \\cdot 1.0 + 0.9 \\cdot (-0.1) + 0.8 \\cdot 0\\right) | $$\n$$ V_i = \\frac{1}{2} | (0 + 1.08 + 0.8 + 0) - (0 + 0.1 - 0.09 + 0) | $$\n$$ V_i = \\frac{1}{2} | 1.88 - 0.01 | = \\frac{1.87}{2} = 0.935 $$\n\n**Step 2: Compute Face Lengths $A_f$**\nThe lengths $A_f$ are the Euclidean distances between successive vertices.\n- Face 1 ($P_1 \\to P_2$): $A_1 = \\sqrt{(1.2 - 0)^2 + (0.1 - 0)^2} = \\sqrt{1.44 + 0.01} = \\sqrt{1.45}$.\n- Face 2 ($P_2 \\to P_3$): $A_2 = \\sqrt{(1.0 - 1.2)^2 + (0.9 - 0.1)^2} = \\sqrt{(-0.2)^2 + (0.8)^2} = \\sqrt{0.04 + 0.64} = \\sqrt{0.68}$.\n- Face 3 ($P_3 \\to P_4$): $A_3 = \\sqrt{(-0.1 - 1.0)^2 + (0.8 - 0.9)^2} = \\sqrt{(-1.1)^2 + (-0.1)^2} = \\sqrt{1.21 + 0.01} = \\sqrt{1.22}$.\n- Face 4 ($P_4 \\to P_1$): $A_4 = \\sqrt{(0 - (-0.1))^2 + (0 - 0.8)^2} = \\sqrt{(0.1)^2 + (-0.8)^2} = \\sqrt{0.01 + 0.64} = \\sqrt{0.65}$.\n\n**Step 3: Compute the Denominator $\\sum_{f} |\\lambda_f| A_f$**\n$$ \\sum_{f=1}^{4} |\\lambda_f| A_f = |\\lambda_1|A_1 + |\\lambda_2|A_2 + |\\lambda_3|A_3 + |\\lambda_4|A_4 $$\n$$ \\sum_{f=1}^{4} |\\lambda_f| A_f = 290\\sqrt{1.45} + 260\\sqrt{0.68} + 300\\sqrt{1.22} + 250\\sqrt{0.65} $$\nEvaluating the terms numerically:\n$$ \\sum_{f=1}^{4} |\\lambda_f| A_f \\approx 290(1.204159) + 260(0.824621) + 300(1.104536) + 250(0.806226) $$\n$$ \\sum_{f=1}^{4} |\\lambda_f| A_f \\approx 349.2061 + 214.4015 + 331.3608 + 201.5565 \\approx 1096.5249 $$\n\n**Step 4: Compute the Local Time Step $\\Delta \\tau_i$**\n$$ \\Delta \\tau_i = \\mathrm{CFL} \\frac{V_i}{\\sum_{f} |\\lambda_f| A_f} = 0.7 \\times \\frac{0.935}{1096.5249} $$\n$$ \\Delta \\tau_i \\approx 0.7 \\times 0.000852701 \\approx 0.0005968907 $$\n\n**Step 5: Round the Result**\nThe result must be rounded to four significant figures.\n$$ \\Delta \\tau_i \\approx 0.0005969 \\;\\mathrm{s} $$\nIn scientific notation, this is $5.969 \\times 10^{-4} \\;\\mathrm{s}$.",
            "answer": "$$\\boxed{5.969 \\times 10^{-4}}$$"
        },
        {
            "introduction": "Building upon the inviscid case, practical aerospace simulations must often account for viscosity, which introduces diffusive transport phenomena governed by the Navier-Stokes equations. This adds a parabolic stability constraint that is often more restrictive than the advective (hyperbolic) one, especially in fine boundary layer meshes. This problem  explores how to derive a combined, conservative time step limit that accounts for both advective and diffusive effects, a crucial skill for robustly handling viscous flows.",
            "id": "3974120",
            "problem": "Consider the two-dimensional compressible Navier–Stokes equations written in conservation form for a control volume of area $A$ with edge lengths $\\Delta x$ and $\\Delta y$. An explicit Finite Volume (FV) discretization is used with per-face numerical flux composed of an inviscid convective contribution evaluated by the Local Lax–Friedrichs (LLF, also known as Rusanov) flux and a viscous diffusive contribution evaluated by centered gradients. The inviscid LLF flux on a face with unit normal $\\boldsymbol{n}$ has a dissipation proportional to a local spectral radius $\\lambda_{f}$, where for compressible flow a standard upper bound is $\\lambda_{f} = |\\boldsymbol{u}\\cdot\\boldsymbol{n}| + a$, with $a$ the local speed of sound and $\\boldsymbol{u}$ the local velocity. The viscous fluxes involve the dynamic viscosity $\\mu$ and thermal conductivity $\\kappa$; their explicit treatment imposes a parabolic stability constraint governed by the largest diffusivity among the transported modes, here taken as $\\alpha_{\\max} = \\max\\left(\\nu, \\kappa/(\\rho c_{p})\\right)$ where $\\nu = \\mu/\\rho$ is the kinematic viscosity, $\\rho$ the density, and $c_{p}$ the specific heat at constant pressure.\n\nStarting from the semi-discrete conservation law over the cell and the explicit forward-Euler time update, use first principles of stability (requiring the update to remain a contraction under the discrete operator induced by the fluxes) to derive a conservative local explicit time-step constraint that accounts for both the advective (hyperbolic) and diffusive (parabolic) contributions. Combine the constraints so that the single tightest bound controls the step. Then, for the specific cell and state given below, compute the allowable local time step for use in Local Time Stepping (LTS) steady-state acceleration with a prescribed Courant–Friedrichs–Lewy (CFL) number:\n- Cell dimensions: $\\Delta x = 4.0 \\times 10^{-3}\\ \\text{m}$, $\\Delta y = 2.0 \\times 10^{-3}\\ \\text{m}$.\n- Local velocity components: $u = 120\\ \\text{m/s}$, $v = 30\\ \\text{m/s}$.\n- Thermodynamic and transport properties: $\\gamma = 1.4$, $R = 287\\ \\text{J/(kg K)}$, $T = 300\\ \\text{K}$, $\\rho = 0.8\\ \\text{kg/m}^{3}$, $\\mu = 1.8 \\times 10^{-5}\\ \\text{Pa s}$, $\\kappa = 0.026\\ \\text{W/(m K)}$, $c_{p} = 1005\\ \\text{J/(kg K)}$.\n- Use $a = \\sqrt{\\gamma R T}$ to evaluate the speed of sound.\n- Use $\\alpha_{\\max} = \\max\\left(\\nu,\\ \\kappa/(\\rho c_{p})\\right)$ with $\\nu = \\mu/\\rho$.\n- Prescribed Courant–Friedrichs–Lewy (CFL) number for LTS: $\\text{CFL} = 0.70$.\n\nExpress the final time step in seconds and round your answer to four significant figures.",
            "solution": "The problem requires the derivation of a local time-step constraint for a two-dimensional, compressible Navier-Stokes simulation using an explicit Finite Volume method. The final value must then be computed for a specific cell and flow state.\n\nFirst, we establish the theoretical foundation for the stability constraint. For a generic system of conservation laws discretized in space, the semi-discrete form for a given cell $i$ is:\n$$\n\\frac{d\\boldsymbol{W}_i}{d\\tau} = \\mathcal{R}(\\boldsymbol{W})\n$$\nwhere $\\boldsymbol{W}_i$ is the vector of conserved variables in cell $i$ and $\\mathcal{R}(\\boldsymbol{W})$ is the discrete residual operator, representing the net flux into the cell. For an explicit forward-Euler time integration scheme, the update is:\n$$\n\\boldsymbol{W}_i^{n+1} = \\boldsymbol{W}_i^n + \\Delta \\tau \\mathcal{R}(\\boldsymbol{W}^n)\n$$\nFor this scheme to be stable, the time step $\\Delta \\tau$ must be limited such that the update remains a contraction. This leads to a condition on the spectral radius (largest eigenvalue magnitude) $\\rho(\\boldsymbol{J}_{\\mathcal{R}})$ of the residual's Jacobian matrix, $\\boldsymbol{J}_{\\mathcal{R}}$:\n$$\n\\Delta \\tau \\le \\frac{C}{\\rho(\\boldsymbol{J}_{\\mathcal{R}})}\n$$\nwhere $C$ is a constant that depends on the specific scheme, often identified with the Courant–Friedrichs–Lewy (CFL) number for hyperbolic problems.\n\nThe residual operator $\\mathcal{R}$ is a sum of contributions from the inviscid (advective) and viscous (diffusive) fluxes. By the triangle inequality for matrix norms, the spectral radius of the combined operator's Jacobian can be conservatively bounded by the sum of the spectral radii of the individual Jacobians:\n$$\n\\rho(\\boldsymbol{J}_{\\mathcal{R}}) \\le \\rho(\\boldsymbol{J}_{\\text{adv}}) + \\rho(\\boldsymbol{J}_{\\text{diff}})\n$$\nThis allows us to construct a combined stability constraint by summing the inverse time scales associated with each physical process.\n\nLet's derive the individual constraints for a rectangular cell of area $A=\\Delta x \\Delta y$.\n\n1.  **Advective (Hyperbolic) Constraint:**\n    The advective part of the flux is discretized using the Local Lax-Friedrichs (LLF) scheme. The stability of this explicit scheme is limited by the speed at which information propagates across a cell. For a 2D Cartesian grid, the contributions from the fluxes in the x and y directions are additive in the stability constraint. The spectral radius for the 1D Euler equations with an LLF flux in the x-direction is proportional to $\\frac{\\lambda_x}{\\Delta x}$, where $\\lambda_x$ is the maximum wave speed in that direction. From the problem statement, $\\lambda_f = |\\boldsymbol{u}\\cdot\\boldsymbol{n}| + a$.\n    For the x-direction, the face normal is $\\boldsymbol{n}=(1,0)$, so $\\lambda_x = |u| + a$.\n    For the y-direction, the face normal is $\\boldsymbol{n}=(0,1)$, so $\\lambda_y = |v| + a$.\n    The combined hyperbolic spectral radius for the 2D cell is thus approximated by the sum of the 1D contributions:\n    $$\n    \\rho(\\boldsymbol{J}_{\\text{adv}}) \\approx \\frac{\\lambda_x}{\\Delta x} + \\frac{\\lambda_y}{\\Delta y} = \\frac{|u|+a}{\\Delta x} + \\frac{|v|+a}{\\Delta y}\n    $$\n    The corresponding time-step limit, incorporating the prescribed CFL number, is $\\Delta \\tau_{adv} = \\text{CFL} / \\rho(\\boldsymbol{J}_{\\text{adv}})$.\n\n2.  **Diffusive (Parabolic) Constraint:**\n    The viscous terms behave like a diffusion or heat equation. The explicit central-difference discretization of the 2D Laplacian operator $\\nabla^2$ is stable if:\n    $$\n    \\Delta \\tau \\le \\frac{1}{2 \\alpha \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right)}\n    $$\n    where $\\alpha$ is the diffusivity. The problem states this constraint is governed by the largest diffusivity among the transported modes, $\\alpha_{\\max}$. Therefore, the spectral radius of the diffusive operator is:\n    $$\n    \\rho(\\boldsymbol{J}_{\\text{diff}}) \\approx 2 \\alpha_{\\max} \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right)\n    $$\n    Note that the CFL number is a convention for hyperbolic systems and is not typically applied to this parabolic constraint in the same way. The factor of $1/2$ is inherent to the stability limit of the numerical scheme itself.\n\n3.  **Combined Constraint:**\n    Combining the two contributions, the total local time step $\\Delta \\tau_{local}$ is limited by the sum of the spectral radii:\n    $$\n    \\Delta \\tau_{local} \\le \\frac{\\text{CFL}}{\\rho(\\boldsymbol{J}_{\\text{adv}}) + \\rho(\\boldsymbol{J}_{\\text{diff}})}\n    $$\n    The problem asks for an expression combining the constraints, which this formulation does directly. We interpret the given CFL number as the scaling factor $C$ for the overall operator. A common practice in CFD solvers is to use the CFL number to scale the entire inverse time-step sum.\n    $$\n    \\Delta \\tau_{local} = \\text{CFL} \\left[ \\left( \\frac{|u|+a}{\\Delta x} + \\frac{|v|+a}{\\Delta y} \\right) + 2 \\alpha_{\\max} \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right) \\right]^{-1}\n    $$\n    This is the conservative, combined local time-step formula we will use.\n\nNow, we will compute the numerical value using the provided data.\n-   Cell dimensions: $\\Delta x = 4.0 \\times 10^{-3}\\ \\text{m}$, $\\Delta y = 2.0 \\times 10^{-3}\\ \\text{m}$.\n-   Velocity components: $u = 120\\ \\text{m/s}$, $v = 30\\ \\text{m/s}$. So $|u| = 120\\ \\text{m/s}$ and $|v| = 30\\ \\text{m/s}$.\n-   Thermodynamic and transport properties: $\\gamma = 1.4$, $R = 287\\ \\text{J/(kg K)}$, $T = 300\\ \\text{K}$, $\\rho = 0.8\\ \\text{kg/m}^{3}$, $\\mu = 1.8 \\times 10^{-5}\\ \\text{Pa s}$, $\\kappa = 0.026\\ \\text{W/(m K)}$, $c_{p} = 1005\\ \\text{J/(kg K)}$.\n-   Prescribed CFL number: $\\text{CFL} = 0.70$.\n\nFirst, we calculate the necessary intermediate quantities.\n-   **Speed of sound ($a$):**\n    $a = \\sqrt{\\gamma R T} = \\sqrt{1.4 \\times 287 \\times 300} = \\sqrt{120540} \\approx 347.1887\\ \\text{m/s}$.\n-   **Kinematic viscosity ($\\nu$):**\n    $\\nu = \\frac{\\mu}{\\rho} = \\frac{1.8 \\times 10^{-5}}{0.8} = 2.25 \\times 10^{-5}\\ \\text{m}^2/\\text{s}$.\n-   **Thermal diffusivity ($\\alpha_T$):**\n    $\\alpha_T = \\frac{\\kappa}{\\rho c_{p}} = \\frac{0.026}{0.8 \\times 1005} = \\frac{0.026}{804} \\approx 3.2338 \\times 10^{-5}\\ \\text{m}^2/\\text{s}$.\n-   **Maximum diffusivity ($\\alpha_{\\max}$):**\n    $\\alpha_{\\max} = \\max(\\nu, \\alpha_T) = \\max(2.25 \\times 10^{-5}, 3.2338 \\times 10^{-5}) = 3.2338 \\times 10^{-5}\\ \\text{m}^2/\\text{s}$.\n\nNext, we compute the two terms in the denominator of the $\\Delta \\tau_{local}$ expression.\n-   **Advective term contribution ($S_{adv}$):**\n    $$\n    S_{adv} = \\frac{|u|+a}{\\Delta x} + \\frac{|v|+a}{\\Delta y} = \\frac{120 + 347.1887}{4.0 \\times 10^{-3}} + \\frac{30 + 347.1887}{2.0 \\times 10^{-3}}\n    $$\n    $$\n    S_{adv} = \\frac{467.1887}{4.0 \\times 10^{-3}} + \\frac{377.1887}{2.0 \\times 10^{-3}} = 116797.175 + 188594.35 = 305391.525\\ \\text{s}^{-1}\n    $$\n-   **Diffusive term contribution ($S_{diff}$):**\n    $$\n    S_{diff} = 2 \\alpha_{\\max} \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right) = 2(3.2338 \\times 10^{-5}) \\left( \\frac{1}{(4.0 \\times 10^{-3})^2} + \\frac{1}{(2.0 \\times 10^{-3})^2} \\right)\n    $$\n    $$\n    S_{diff} = 6.4676 \\times 10^{-5} \\left( \\frac{1}{1.6 \\times 10^{-5}} + \\frac{1}{4.0 \\times 10^{-6}} \\right) = 6.4676 \\times 10^{-5} (62500 + 250000)\n    $$\n    $$\n    S_{diff} = 6.4676 \\times 10^{-5} (312500) = 20.21125\\ \\text{s}^{-1}\n    $$\n\nFinally, we compute the total local time step $\\Delta \\tau_{local}$.\n$$\n\\Delta \\tau_{local} = \\text{CFL} \\left[ S_{adv} + S_{diff} \\right]^{-1} = 0.70 \\left[ 305391.525 + 20.21125 \\right]^{-1}\n$$\n$$\n\\Delta \\tau_{local} = 0.70 \\left[ 305411.73625 \\right]^{-1} \\approx 0.70 \\times (3.27429 \\times 10^{-6}) \\approx 2.29200 \\times 10^{-6}\\ \\text{s}\n$$\n\nRounding the result to four significant figures as requested, we get $2.292 \\times 10^{-6}\\ \\text{s}$.",
            "answer": "$$\n\\boxed{2.292 \\times 10^{-6}}\n$$"
        },
        {
            "introduction": "While assigning a unique time step to each cell accelerates convergence, it introduces a significant challenge: ensuring the numerical scheme remains conservative. If not handled carefully, using different $ \\Delta \\tau $ values in adjacent cells can lead to a violation of mass, momentum, and energy conservation. This exercise  illuminates the algorithmic solution by demonstrating how to enforce conservation through flux balancing over a synchronized macro-step, a core concept in the practical implementation of robust LTS methods.",
            "id": "3974175",
            "problem": "Consider a one-dimensional, inviscid, linear advection of a single scalar conserved quantity $u(x,\\tau)$ governed by the conservation law $\\frac{\\partial u}{\\partial \\tau} + \\frac{\\partial}{\\partial x} \\left( a u \\right) = 0$ with constant advection speed $a > 0$. In a finite-volume discretization for Computational Fluid Dynamics (CFD), two adjacent control volumes (cells) labeled $\\mathcal{C}_1$ and $\\mathcal{C}_2$ share a single internal face of area $A_f$ with unit normal $\\boldsymbol{n}$ pointing from $\\mathcal{C}_1$ to $\\mathcal{C}_2$. The volumes of the cells are $V_1$ and $V_2$. There are no other faces or sources; thus, all exchange of the conserved quantity happens only through the shared face. The initial cell-averaged states at pseudo-time $\\tau=0$ are $u_1^0$ in $\\mathcal{C}_1$ and $u_2^0$ in $\\mathcal{C}_2$.\n\nWe adopt Local Time Stepping (LTS) for steady-state acceleration. Over a macro-step of duration $\\Delta T = 2\\tau_{step}$, the local pseudo-time step sizes are $\\Delta \\tau_1 = \\tau_{step}$ for $\\mathcal{C}_1$ and $\\Delta \\tau_2 = 2 \\tau_{step}$ for $\\mathcal{C}_2$, where $\\tau_{step} > 0$ is given. Thus the synchronization macro-step is $\\Delta T = 2 \\tau_{step}$. Within each sub-interval where a cell updates, we use a forward Euler finite-volume update and the upwind numerical flux for advection at the shared face, defined by $F_f = a\\,u_{\\text{upwind}}$, where $u_{\\text{upwind}}$ equals the state on the upwind side. Because $a>0$, the upwind side is $\\mathcal{C}_1$, so $F_f = a\\,u_1$ at the beginning of each sub-interval.\n\nTo guarantee exact conservation across the shared face under heterogeneous local time steps, the face flux contributions are matched over the macro-step: both cells use the same integrated face flux over $\\Delta T$. Specifically, let the macro-step be partitioned into the two sub-intervals $[0,\\tau_{step}]$ and $[\\tau_{step},2\\tau_{step}]$ for $\\mathcal{C}_1$, with $\\mathcal{C}_2$ updating only at $\\tau_{end}=2\\tau_{step}$. On each sub-interval, the face flux is taken to be piecewise constant and evaluated with the upwind state at the start of that sub-interval. The integrated face flux over $\\Delta T$ is then used once to update $\\mathcal{C}_2$ at $\\tau_{end}=2\\tau_{step}$, ensuring the inflow to $\\mathcal{C}_2$ equals the outflow from $\\mathcal{C}_1$.\n\nStarting from the conservation law and the finite-volume update definition, derive the conservative net updates $\\Delta u_1$ and $\\Delta u_2$ applied to the cell-averaged states of $\\mathcal{C}_1$ and $\\mathcal{C}_2$ over the macro-step $\\Delta T = 2\\tau_{step}$ under the matched face flux contributions described above. Express your final answers as closed-form analytic expressions in terms of $A_f$, $V_1$, $V_2$, $a$, $\\tau_{step}$, and $u_1^0$. You may assume that within each sub-interval, the face flux depends only on the upwind state $u_1$ and that $\\mathcal{C}_2$ does not update mid-step. Provide the pair $\\left( \\Delta u_1, \\Delta u_2 \\right)$ as your final answer. No rounding is required, and no units should be provided in the final answer.",
            "solution": "The finite-volume method applied to the conservation law $\\frac{\\partial u}{\\partial \\tau} + \\frac{\\partial (au)}{\\partial x} = 0$ for a control volume $\\mathcal{C}_i$ with volume $V_i$ yields the semi-discrete ordinary differential equation for the cell-averaged state $u_i$:\n$$ V_i \\frac{d u_i}{d\\tau} + \\sum_{f \\in \\partial \\mathcal{C}_i} F_f A_f (\\boldsymbol{v} \\cdot \\boldsymbol{n})_f = 0 $$\nFor our one-dimensional problem with a single face between $\\mathcal{C}_1$ and $\\mathcal{C}_2$, and with the normal $\\boldsymbol{n}$ pointing from $\\mathcal{C}_1$ to $\\mathcal{C}_2$, the equations for $u_1$ and $u_2$ are:\n$$ V_1 \\frac{d u_1}{d\\tau} = -F_f A_f $$\n$$ V_2 \\frac{d u_2}{d\\tau} = +F_f A_f $$\nHere, $F_f = a u_1$ since $a>0$ (upwinding) and flow is from $\\mathcal{C}_1$ to $\\mathcal{C}_2$. The forward Euler time-marching scheme for a general cell update is $u_i^{n+1} = u_i^n + \\frac{\\Delta \\tau}{V_i} (\\text{net flux into cell})$.\n\n#### Update for Cell $\\mathcal{C}_1$\n\nCell $\\mathcal{C}_1$ evolves over two sub-intervals, each of duration $\\tau_{step}$.\n\n**First sub-interval: $\\tau \\in [0, \\tau_{step}]$**\nThe update is performed with a time step $\\Delta \\tau_1 = \\tau_{step}$. The flux is constant over this interval and is determined by the state at the beginning, $\\tau=0$.\nThe state is $u_1(0) = u_1^0$.\nThe flux out of $\\mathcal{C}_1$ is $F_f A_f = (a u_1(0)) A_f = a A_f u_1^0$.\nThe state of $\\mathcal{C}_1$ at the end of this sub-interval, $\\tau=\\tau_{step}$, is:\n$$ u_1(\\tau_{step}) = u_1(0) - \\frac{\\tau_{step}}{V_1} (a A_f u_1(0)) = u_1^0 - \\frac{a A_f \\tau_{step}}{V_1} u_1^0 $$\n$$ u_1(\\tau_{step}) = u_1^0 \\left( 1 - \\frac{a A_f \\tau_{step}}{V_1} \\right) $$\n\n**Second sub-interval: $\\tau \\in [\\tau_{step}, 2\\tau_{step}]$**\nThe update is again performed with a time step $\\Delta \\tau_1 = \\tau_{step}$. The flux is determined by the state at the beginning of this interval, $\\tau=\\tau_{step}$.\nThe state is $u_1(\\tau_{step})$.\nThe flux out of $\\mathcal{C}_1$ is $F_f A_f = (a u_1(\\tau_{step})) A_f$.\nThe state of $\\mathcal{C}_1$ at the end of the macro-step, $\\tau=2\\tau_{step}$, is:\n$$ u_1(2\\tau_{step}) = u_1(\\tau_{step}) - \\frac{\\tau_{step}}{V_1} (a A_f u_1(\\tau_{step})) = u_1(\\tau_{step}) \\left( 1 - \\frac{a A_f \\tau_{step}}{V_1} \\right) $$\nSubstituting the expression for $u_1(\\tau_{step})$:\n$$ u_1(2\\tau_{step}) = \\left[ u_1^0 \\left( 1 - \\frac{a A_f \\tau_{step}}{V_1} \\right) \\right] \\left( 1 - \\frac{a A_f \\tau_{step}}{V_1} \\right) = u_1^0 \\left( 1 - \\frac{a A_f \\tau_{step}}{V_1} \\right)^2 $$\n\n**Net Update for $\\mathcal{C}_1$**\nThe net update for $u_1$ over the macro-step $\\Delta T = 2\\tau_{step}$ is $\\Delta u_1 = u_1(2\\tau_{step}) - u_1(0)$.\n$$ \\Delta u_1 = u_1^0 \\left( 1 - \\frac{a A_f \\tau_{step}}{V_1} \\right)^2 - u_1^0 = u_1^0 \\left[ \\left( 1 - \\frac{a A_f \\tau_{step}}{V_1} \\right)^2 - 1 \\right] $$\nExpanding the squared term:\n$$ \\Delta u_1 = u_1^0 \\left[ 1 - 2\\frac{a A_f \\tau_{step}}{V_1} + \\left(\\frac{a A_f \\tau_{step}}{V_1}\\right)^2 - 1 \\right] = u_1^0 \\left[ \\frac{a^2 A_f^2 \\tau_{step}^2}{V_1^2} - \\frac{2 a A_f \\tau_{step}}{V_1} \\right]$$\nFactoring out a common term gives the final expression for $\\Delta u_1$:\n$$ \\Delta u_1 = \\frac{a A_f \\tau_{step} u_1^0}{V_1} \\left( \\frac{a A_f \\tau_{step}}{V_1} - 2 \\right) $$\n\n#### Update for Cell $\\mathcal{C}_2$\n\nCell $\\mathcal{C}_2$ updates only once at $\\tau=2\\tau_{step}$ using a time step $\\Delta \\tau_2 = 2\\tau_{step}$. The conservation principle dictates that the total change in the quantity in $\\mathcal{C}_2$ must be equal to the total integrated flux into it over the macro-step $\\Delta T = 2\\tau_{step}$. This integrated flux, denoted $J$, corresponds to the total quantity that has exited $\\mathcal{C}_1$.\n\n**Integrated Flux Calculation**\nThe total flux $J$ transferred from $\\mathcal{C}_1$ to $\\mathcal{C}_2$ over $[0, 2\\tau_{step}]$ is the integral of the piecewise-constant flux function:\n$$ J = \\int_0^{2\\tau_{step}} F_f(\\tau') A_f d\\tau' = \\int_0^{\\tau_{step}} F_f(\\tau') A_f d\\tau' + \\int_{\\tau_{step}}^{2\\tau_{step}} F_f(\\tau') A_f d\\tau' $$\n- For $\\tau' \\in [0, \\tau_{step}]$, $F_f(\\tau') A_f = a A_f u_1(0) = a A_f u_1^0$.\n- For $\\tau' \\in [\\tau_{step}, 2\\tau_{step}]$, $F_f(\\tau') A_f = a A_f u_1(\\tau_{step}) = a A_f u_1^0 \\left(1 - \\frac{a A_f \\tau_{step}}{V_1}\\right)$.\n$$ J = (a A_f u_1^0) \\int_0^{\\tau_{step}} d\\tau' + \\left(a A_f u_1^0 \\left(1 - \\frac{a A_f \\tau_{step}}{V_1}\\right)\\right) \\int_{\\tau_{step}}^{2\\tau_{step}} d\\tau' $$\n$$ J = (a A_f u_1^0) \\tau_{step} + \\left(a A_f u_1^0 \\left(1 - \\frac{a A_f \\tau_{step}}{V_1}\\right)\\right) \\tau_{step} $$\nFactoring out the common term $a A_f u_1^0 \\tau_{step}$:\n$$ J = a A_f u_1^0 \\tau_{step} \\left[ 1 + \\left(1 - \\frac{a A_f \\tau_{step}}{V_1}\\right) \\right] = a A_f u_1^0 \\tau_{step} \\left( 2 - \\frac{a A_f \\tau_{step}}{V_1} \\right) $$\n\n**Net Update for $\\mathcal{C}_2$**\nThe change in the total quantity in cell $\\mathcal{C}_2$ is $V_2 \\Delta u_2 = J$. Therefore, the net update for the cell-averaged state $u_2$ is:\n$$ \\Delta u_2 = \\frac{J}{V_2} = \\frac{1}{V_2} \\left[ a A_f u_1^0 \\tau_{step} \\left( 2 - \\frac{a A_f \\tau_{step}}{V_1} \\right) \\right] $$\n$$ \\Delta u_2 = \\frac{a A_f \\tau_{step} u_1^0}{V_2} \\left( 2 - \\frac{a A_f \\tau_{step}}{V_1} \\right) $$\nThis result respects the conservation law $V_1 \\Delta u_1 + V_2 \\Delta u_2 = 0$.\n\nThe final answer is the pair $(\\Delta u_1, \\Delta u_2)$.",
            "answer": "$$ \\boxed{ \\left( \\frac{a A_f \\tau_{step} u_1^0}{V_1} \\left( \\frac{a A_f \\tau_{step}}{V_1} - 2 \\right) , \\frac{a A_f \\tau_{step} u_1^0}{V_2} \\left( 2 - \\frac{a A_f \\tau_{step}}{V_1} \\right) \\right) } $$"
        }
    ]
}