{
    "hands_on_practices": [
        {
            "introduction": "The effective application of any near-wall turbulence model begins with a critical assessment of the computational grid. The dimensionless wall distance, $y^+$, serves as the essential metric for this task, acting as a normalized coordinate that measures distance from the wall in \"viscous units.\" This exercise provides fundamental practice in calculating $y^+$ and using its value to make the crucial decision between resolving the fine-scale physics of the viscous sublayer or employing a wall function to model the logarithmic region, a choice that profoundly impacts both the accuracy and computational cost of a simulation .",
            "id": "3994879",
            "problem": "In a Computational Fluid Dynamics (CFD) simulation of fully developed, heated internal flow of air in a smooth circular duct using the realizable $k-\\varepsilon$ model within the Reynolds-Averaged Navier–Stokes (RANS) framework, you are assessing the near-wall grid adequacy at a particular axial location. From the momentum balance and the Newtonian constitutive relation at the wall, the wall shear stress determines a characteristic velocity scale, and inner (viscous) scaling leads to a non-dimensional wall distance that guides the choice of near-wall treatment. At the location of interest, the friction velocity is $u_{\\tau} = 0.41\\,\\mathrm{m/s}$. The normal distance from the wall to the centroid of the first off-wall cell is $y = 5.0 \\times 10^{-5}\\,\\mathrm{m}$. The kinematic viscosity of air at the local thermophysical state is $\\nu = 1.50 \\times 10^{-5}\\,\\mathrm{m^2/s}$. Using only fundamental definitions of wall shear stress, viscous length scale, and non-dimensionalization consistent with inner scaling for wall-bounded turbulence, compute the inner-scaled wall-normal coordinate $y^{+}$ for this cell. Then, based on established ranges of $y^{+}$ associated with viscous-sublayer resolution versus logarithmic-layer wall-function applicability in realizable $k-\\varepsilon$ closures, state which near-wall approach is appropriate and justify your choice. Round your reported value of $y^{+}$ to four significant figures. Report $y^{+}$ as a dimensionless number (no units). Your justification may reference physically meaningful ranges but should not be included in the final numeric answer.",
            "solution": "The problem is validated as self-contained, scientifically grounded, and well-posed. All necessary data are provided, and the concepts are fundamental to the field of computational fluid dynamics and turbulence modeling.\n\nThe primary task is to compute the non-dimensional wall distance, denoted as $y^{+}$, for the first computational cell adjacent to the wall. This quantity is central to determining the appropriate near-wall modeling strategy in Reynolds-Averaged Navier–Stokes (RANS) simulations.\n\nIn the theory of wall-bounded turbulent flows, the region near a solid boundary is characterized by steep gradients in flow variables. Inner scaling, or viscous scaling, is used to non-dimensionalize variables in this region. The characteristic scales are derived from the properties of the fluid at the wall.\n\nThe characteristic velocity scale is the friction velocity, $u_{\\tau}$. It is defined in terms of the wall shear stress, $\\tau_w$, and the fluid density, $\\rho$, as:\n$$u_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}$$\nThe problem provides the value of the friction velocity directly as $u_{\\tau} = 0.41\\,\\mathrm{m/s}$.\n\nThe characteristic length scale in the near-wall region is the viscous length scale, sometimes called a \"wall unit\". It is defined as:\n$$\\delta_{\\nu} = \\frac{\\nu}{u_{\\tau}}$$\nwhere $\\nu$ is the kinematic viscosity of the fluid.\n\nThe non-dimensional wall distance, $y^{+}$, is the physical normal distance from the wall, $y$, normalized by this viscous length scale, $\\delta_{\\nu}$. The defining equation for $y^{+}$ is therefore:\n$$y^{+} = \\frac{y}{\\delta_{\\nu}} = \\frac{y}{\\left(\\frac{\\nu}{u_{\\tau}}\\right)} = \\frac{y u_{\\tau}}{\\nu}$$\n\nThe problem provides the following values:\nThe normal distance from the wall to the cell centroid, $y = 5.0 \\times 10^{-5}\\,\\mathrm{m}$.\nThe friction velocity, $u_{\\tau} = 0.41\\,\\mathrm{m/s}$.\nThe kinematic viscosity, $\\nu = 1.50 \\times 10^{-5}\\,\\mathrm{m^2/s}$.\n\nSubstituting these values into the equation for $y^{+}$:\n$$y^{+} = \\frac{(5.0 \\times 10^{-5}\\,\\mathrm{m})(0.41\\,\\mathrm{m/s})}{1.50 \\times 10^{-5}\\,\\mathrm{m^2/s}}$$\nThe units cancel out, as expected for a dimensionless quantity:\n$$\\frac{[\\mathrm{m}] \\cdot [\\mathrm{m/s}]}{[\\mathrm{m^2/s}]} = \\frac{[\\mathrm{m^2/s}]}{[\\mathrm{m^2/s}]} = 1$$\n\nNow, we compute the numerical value:\n$$y^{+} = \\frac{5.0 \\times 0.41}{1.50} = \\frac{2.05}{1.50} \\approx 1.3666...$$\nThe problem requires rounding the result to four significant figures.\n$$y^{+} \\approx 1.367$$\n\nThe second part of the task is to determine the appropriate near-wall treatment based on this $y^{+}$ value. In the context of RANS turbulence models like the realizable $k-\\varepsilon$ model, there are two primary approaches for the near-wall region:\n\n$1$. **Wall-Resolving Approach (Low-Reynolds Number Modeling)**: This approach requires the computational grid to be fine enough to resolve the flow physics all the way into the viscous sublayer. The viscous sublayer is the region immediately adjacent to the wall where viscous effects dominate and the velocity profile is approximately linear. This approach is generally required when the centroid of the first off-wall cell is placed at $y^{+} \\lesssim 5$, with $y^{+} \\approx 1$ being an ideal target.\n\n$2$. **Wall-Function Approach**: This approach uses semi-empirical formulas (wall functions) to bridge the near-wall region, modeling the velocity and turbulence profiles between the wall and the first cell centroid. This avoids the high computational cost of resolving the viscous sublayer and buffer layer. This approach is valid only when the first cell centroid is placed in the fully turbulent logarithmic layer, which typically corresponds to a range of $30  y^{+}  300$.\n\nThe calculated value for the first cell is $y^{+} \\approx 1.367$. This value is well within the viscous sublayer ($y^{+} \\lesssim 5$). Therefore, a wall-function approach would be inappropriate and lead to significant errors, as the assumptions upon which wall functions are based (a logarithmic velocity profile) are not met. The correct strategy is to use a wall-resolving approach. For the realizable $k-\\varepsilon$ model, this typically means employing an \"Enhanced Wall Treatment\" or a similar two-layer model that integrates the solution through the viscous sublayer to the wall. This ensures that the high-gradient region near the wall, which governs wall shear stress and heat transfer, is accurately captured.\n\nIn summary, the calculated $y^{+}$ of approximately $1.367$ indicates that the near-wall grid is designed for resolving the viscous sublayer, and the appropriate numerical treatment is a low-Reynolds number modeling approach that does not rely on logarithmic wall functions.",
            "answer": "$$\\boxed{1.367}$$"
        },
        {
            "introduction": "Once a wall-function approach is deemed appropriate, the question becomes: how does a CFD solver actually enforce the logarithmic law of the wall? The answer lies in manipulating the eddy viscosity, $\\nu_t$, in the wall-adjacent cells to produce the desired velocity profile. This practice takes you \"under the hood\" of a RANS solver, challenging you to derive the exact expression for $\\nu_t$ that is simultaneously consistent with the log-law and the modeled turbulent shear stress, revealing the elegant mechanics that connect empirical laws to the transport equations being solved .",
            "id": "3979548",
            "problem": "Consider a steady, zero-pressure-gradient, incompressible turbulent boundary layer over a smooth flat plate, modeled using the Reynolds-Averaged Navier–Stokes (RANS) equations with the standard high-Reynolds-number two-equation closure and a wall-function treatment. The first off-wall cell center is located at a normal distance $y_{p}$ from the wall, and the mean streamwise velocity at that location is $U_{p}$. The kinematic viscosity of the fluid is $\\nu$. The wall-function assumes a logarithmic law of the wall in the inertial sublayer, with $U^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + B$, where $U^{+} = \\frac{U}{u_{\\tau}}$, $y^{+} = \\frac{y u_{\\tau}}{\\nu}$, $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$ is the friction velocity, $\\tau_{w}$ is the wall shear stress, $\\rho$ is the density, $\\kappa$ is the von Kármán constant, and $B$ is the log-law intercept. Assume the first cell lies well within the logarithmic region so that $y_{p}^{+} \\gg 30$.\n\nThe Boussinesq eddy-viscosity hypothesis models the turbulent shear stress as $\\tau_{t} = \\rho \\nu_{t} \\frac{\\partial U}{\\partial y}$, and in high-Re wall-function formulations the near-wall shear at the first off-wall location is taken to match the wall shear, $\\tau_{t}(y_{p}) \\approx \\tau_{w}$.\n\nStarting only from these definitions and widely accepted relations, and without invoking any unmentioned closure shortcuts, derive an analytic expression for the kinematic eddy viscosity $\\nu_{t,p}$ at $y_{p}$ that simultaneously satisfies:\n- the logarithmic mean profile at $y_{p}$, and\n- the equality of the modeled near-wall turbulent shear stress and the wall shear.\n\nYour derivation should proceed by first solving for the friction velocity $u_{\\tau}$ from the logarithmic relation at $y_{p}$ and then eliminating $u_{\\tau}$ using the turbulent shear-stress matching condition. If a transcendental equation arises, you may express your final result using a standard special function.\n\nExpress your final answer as a single closed-form analytic expression for $\\nu_{t,p}$ in terms of $U_{p}$, $y_{p}$, $\\nu$, $\\kappa$, and $B$. Do not evaluate numerically. If it were to be evaluated, the unit would be square meters per second, but you are not required to provide a numerical value.\n\nFinally, assess whether the resulting $\\nu_{t,p}$ is consistent with the standard equilibrium assumptions of the high-Reynolds-number $k-\\varepsilon$ model, given the model constant $C_{\\mu}$, by deriving the implied relations for $k_{p}$ and $\\varepsilon_{p}$ in the logarithmic layer, and comment on the compatibility. Your discussion does not need to produce a numerical result.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- Flow conditions: Steady, zero-pressure-gradient, incompressible turbulent boundary layer over a smooth flat plate.\n- Modeling approach: Reynolds-Averaged Navier–Stokes (RANS) with a standard high-Reynolds-number two-equation closure and a wall-function treatment.\n- First off-wall cell center location: $y_{p}$.\n- Mean streamwise velocity at $y_{p}$: $U_{p}$.\n- Fluid properties: kinematic viscosity $\\nu$, density $\\rho$.\n- Logarithmic law of the wall: $U^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + B$.\n- Dimensionless variables: $U^{+} = \\frac{U}{u_{\\tau}}$, $y^{+} = \\frac{y u_{\\tau}}{\\nu}$.\n- Friction velocity definition: $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$, where $\\tau_{w}$ is the wall shear stress.\n- Constants: $\\kappa$ (von Kármán constant), $B$ (log-law intercept).\n- Assumption: The first cell is in the logarithmic region, $y_{p}^{+} \\gg 30$.\n- Boussinesq eddy-viscosity hypothesis: $\\tau_{t} = \\rho \\nu_{t} \\frac{\\partial U}{\\partial y}$.\n- Near-wall shear stress matching condition: $\\tau_{t}(y_{p}) \\approx \\tau_{w}$.\n- High-Re $k-\\varepsilon$ model constant: $C_{\\mu}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated for validity.\n- **Scientifically Grounded**: The problem is based on the standard and well-established theory of wall functions in turbulent flow modeling using RANS, a cornerstone of computational fluid dynamics (CFD). All principles and definitions provided are standard in the field of fluid mechanics and turbulence. It is scientifically sound.\n- **Well-Posed**: The problem asks for the derivation of a specific quantity, $\\nu_{t,p}$, based on a well-defined set of equations and assumptions. The constraints are sufficient to determine a unique analytical solution. It is well-posed.\n- **Objective**: The language is precise, technical, and free of any subjective or opinion-based statements. All terms are standard engineering and physics nomenclature.\n- **Completeness and Consistency**: All necessary information ($\\nu$, $\\rho$, $U_p$, $y_p$, $\\kappa$, $B$, governing equations) is provided. The assumptions, such as the log-law holding at $y_p$ and the matching of turbulent stress to wall stress, are mutually consistent within the standard wall-function framework. The setup is complete and consistent.\n- **Realism**: The scenario models a canonical problem in CFD and is a standard idealization used for developing and analyzing turbulence models. It is physically plausible and realistic within its modeling context.\n\n### Step 3: Verdict and Action\nThe problem is valid. A detailed solution will be provided.\n\n### Derivation of the Eddy Viscosity $\\nu_{t,p}$\n\nThe derivation proceeds by satisfying two main conditions at the first off-wall grid point $y_{p}$: the logarithmic law for the mean velocity and the matching of the turbulent shear stress to the wall shear stress.\n\nThe Boussinesq hypothesis relates the turbulent shear stress $\\tau_{t}$ to the mean velocity gradient:\n$$\n\\tau_{t}(y) = \\rho \\nu_{t} \\frac{\\partial U}{\\partial y}\n$$\nThe problem states that at the point $p$, the local turbulent shear stress is assumed to be equal to the wall shear stress, $\\tau_{t}(y_p) = \\tau_w$. The wall shear stress is defined in terms of the friction velocity $u_{\\tau}$ as $\\tau_w = \\rho u_{\\tau}^2$. Combining these gives:\n$$\n\\rho \\nu_{t,p} \\left. \\frac{\\partial U}{\\partial y} \\right|_{y=y_p} = \\rho u_{\\tau}^2\n$$\nwhere $\\nu_{t,p}$ is the kinematic eddy viscosity at $y_p$. Simplifying by dividing by $\\rho$ (which is non-zero) yields:\n$$\n\\nu_{t,p} \\left. \\frac{\\partial U}{\\partial y} \\right|_{y=y_p} = u_{\\tau}^2 \\quad (*)\n$$\nThe mean velocity profile $U(y)$ in the logarithmic layer is given by:\n$$\nU(y) = u_{\\tau} \\left( \\frac{1}{\\kappa} \\ln\\left(\\frac{y u_{\\tau}}{\\nu}\\right) + B \\right)\n$$\nTo find the velocity gradient, we differentiate $U(y)$ with respect to $y$:\n$$\n\\frac{\\partial U}{\\partial y} = u_{\\tau} \\frac{\\partial}{\\partial y} \\left[ \\frac{1}{\\kappa} (\\ln(y) + \\ln(u_{\\tau}/\\nu)) + B \\right] = u_{\\tau} \\frac{1}{\\kappa y}\n$$\nEvaluating this gradient at $y = y_p$:\n$$\n\\left. \\frac{\\partial U}{\\partial y} \\right|_{y=y_p} = \\frac{u_{\\tau}}{\\kappa y_p}\n$$\nNow, substitute this gradient expression back into equation $(*)$:\n$$\n\\nu_{t,p} \\left( \\frac{u_{\\tau}}{\\kappa y_p} \\right) = u_{\\tau}^2\n$$\nFor a turbulent flow, $u_{\\tau} \\neq 0$, so we can divide by $u_{\\tau}$:\n$$\n\\nu_{t,p} = \\kappa y_{p} u_{\\tau} \\quad (**)\n$$\nThis is a standard expression for the eddy viscosity in the logarithmic layer. To obtain the final expression for $\\nu_{t,p}$ in terms of the given flow variables ($U_p, y_p, \\nu$) and constants ($\\kappa, B$), we must eliminate $u_{\\tau}$. We use the log-law evaluated at point $p$:\n$$\n\\frac{U_p}{u_{\\tau}} = \\frac{1}{\\kappa} \\ln\\left(\\frac{y_p u_{\\tau}}{\\nu}\\right) + B\n$$\nThis is a transcendental equation for $u_{\\tau}$. To solve for $u_{\\tau}$, we rearrange the equation:\n$$\n\\frac{\\kappa U_p}{u_{\\tau}} = \\ln\\left(\\frac{y_p u_{\\tau}}{\\nu}\\right) + \\kappa B = \\ln\\left(\\frac{y_p}{\\nu}\\right) + \\ln(u_{\\tau}) + \\kappa B\n$$\nLet us define a variable $X = \\frac{\\kappa U_p}{u_{\\tau}}$. This implies $u_{\\tau} = \\frac{\\kappa U_p}{X}$. Substituting this into the equation:\n$$\nX = \\ln\\left(\\frac{y_p}{\\nu} \\frac{\\kappa U_p}{X}\\right) + \\kappa B = \\ln\\left(\\frac{\\kappa y_p U_p}{\\nu}\\right) - \\ln(X) + \\kappa B\n$$\nRearranging to group terms involving $X$:\n$$\nX + \\ln(X) = \\ln\\left(\\frac{\\kappa y_p U_p}{\\nu}\\right) + \\kappa B\n$$\nThis equation is of the form $z + \\ln(z) = C$, whose solution is given by $z = W(\\exp(C))$, where $W$ is the Lambert W function. Let $C = \\ln\\left(\\frac{\\kappa y_p U_p}{\\nu}\\right) + \\kappa B$. Then:\n$$\n\\exp(C) = \\exp\\left(\\ln\\left(\\frac{\\kappa y_p U_p}{\\nu}\\right) + \\kappa B\\right) = \\exp\\left(\\ln\\left(\\frac{\\kappa y_p U_p}{\\nu}\\right)\\right) \\exp(\\kappa B) = \\frac{\\kappa y_p U_p}{\\nu} \\exp(\\kappa B)\n$$\nThe solution for $X$ is therefore:\n$$\nX = W\\left( \\frac{\\kappa y_p U_p}{\\nu} \\exp(\\kappa B) \\right)\n$$\nRecalling the definition $X = \\frac{\\kappa U_p}{u_{\\tau}}$, we can solve for $u_{\\tau}$:\n$$\nu_{\\tau} = \\frac{\\kappa U_p}{X} = \\frac{\\kappa U_p}{W\\left(\\frac{\\kappa y_p U_p}{\\nu} \\exp(\\kappa B)\\right)}\n$$\nFinally, we substitute this expression for $u_{\\tau}$ into our equation for the eddy viscosity, equation $(**)$:\n$$\n\\nu_{t,p} = \\kappa y_{p} u_{\\tau} = \\kappa y_{p} \\left( \\frac{\\kappa U_p}{W\\left(\\frac{\\kappa y_p U_p}{\\nu} \\exp(\\kappa B)\\right)} \\right)\n$$\nThis simplifies to the final analytical expression for $\\nu_{t,p}$:\n$$\n\\nu_{t,p} = \\frac{\\kappa^2 y_p U_p}{W\\left(\\frac{\\kappa y_p U_p}{\\nu} \\exp(\\kappa B)\\right)}\n$$\n\n### Assessment of Consistency with the $k$–$\\varepsilon$ Model\n\nWe now assess if this result is consistent with the standard equilibrium assumptions for the high-Reynolds-number $k-\\varepsilon$ model in the logarithmic layer. The key assumptions and definitions are:\n1.  The eddy viscosity is defined by $\\nu_t = C_{\\mu} \\frac{k^2}{\\varepsilon}$.\n2.  In the log-layer, there is local equilibrium of turbulence, meaning production ($P_k$) equals dissipation ($\\varepsilon$), i.e., $P_k \\approx \\varepsilon$.\n3.  The production of turbulent kinetic energy is given by $P_k = \\nu_t \\left(\\frac{\\partial U}{\\partial y}\\right)^2$.\n\nFrom these assumptions, we can derive the standard log-layer profiles for $k$ and $\\varepsilon$.\nCombining (2) and (3), we have $\\varepsilon \\approx \\nu_t \\left(\\frac{\\partial U}{\\partial y}\\right)^2$. Using the relations $\\nu_t = \\kappa y u_{\\tau}$ and $\\frac{\\partial U}{\\partial y} = \\frac{u_{\\tau}}{\\kappa y}$ derived previously, we find the implied profile for $\\varepsilon$:\n$$\n\\varepsilon(y) = (\\kappa y u_{\\tau}) \\left(\\frac{u_{\\tau}}{\\kappa y}\\right)^2 = (\\kappa y u_{\\tau}) \\frac{u_{\\tau}^2}{\\kappa^2 y^2} = \\frac{u_{\\tau}^3}{\\kappa y}\n$$\nThus, at point $p$, we have $\\varepsilon_p = \\frac{u_{\\tau}^3}{\\kappa y_p}$.\n\nTo find the implied profile for $k$, we use relation (1) and substitute our formulas for $\\nu_t$ and $\\varepsilon$:\n$$\n\\nu_t = C_{\\mu} \\frac{k^2}{\\varepsilon} \\implies \\kappa y u_{\\tau} = C_{\\mu} \\frac{k^2}{u_{\\tau}^3 / (\\kappa y)}\n$$\nSolving for $k^2$:\n$$\nk^2 = \\frac{(\\kappa y u_{\\tau}) (u_{\\tau}^3 / (\\kappa y))}{C_{\\mu}} = \\frac{u_{\\tau}^4}{C_{\\mu}}\n$$\nTaking the square root gives the implied profile for $k$:\n$$\nk(y) = \\frac{u_{\\tau}^2}{\\sqrt{C_{\\mu}}}\n$$\nThis shows that in the equilibrium log-layer, $k$ is constant. At point $p$, $k_p = \\frac{u_{\\tau}^2}{\\sqrt{C_{\\mu}}}$.\n\nTo check for compatibility, we can substitute these equilibrium-based expressions for $k_p$ and $\\varepsilon_p$ back into the $k-\\varepsilon$ model's definition for eddy viscosity (1):\n$$\n\\nu_{t,p} = C_{\\mu} \\frac{k_p^2}{\\varepsilon_p} = C_{\\mu} \\frac{\\left(u_{\\tau}^2 / \\sqrt{C_{\\mu}}\\right)^2}{u_{\\tau}^3 / (\\kappa y_p)} = C_{\\mu} \\frac{u_{\\tau}^4 / C_{\\mu}}{u_{\\tau}^3 / (\\kappa y_p)} = \\frac{u_{\\tau}^4}{u_{\\tau}^3} \\kappa y_p = \\kappa y_p u_{\\tau}\n$$\nThis result, $\\nu_{t,p} = \\kappa y_p u_{\\tau}$, is identical to the intermediate expression, equation $(**)$, that we derived from the problem's initial constraints (log-law profile and turbulent stress matching). This demonstrates perfect consistency. The constraints imposed by the wall function formulation are the same as those derived from the local equilibrium assumption in the logarithmic layer of the $k-\\varepsilon$ model. Therefore, the derived analytic expression for $\\nu_{t,p}$ is fully compatible with the standard high-Re $k-\\varepsilon$ model.",
            "answer": "$$\n\\boxed{\\frac{\\kappa^2 y_p U_p}{W\\left(\\frac{\\kappa y_p U_p}{\\nu} \\exp(\\kappa B)\\right)}}\n$$"
        },
        {
            "introduction": "The friction velocity, $u_{\\tau}$, is the linchpin of near-wall modeling, connecting the physical velocity at the first cell center to the universal law of the wall. Accurately determining $u_{\\tau}$ is a core computational task for any wall function. Moving from derivation to implementation, this practice guides you through the design of a complete, robust numerical algorithm to solve for $u_{\\tau}$. You will tackle real-world challenges such as creating physical initial guesses, ensuring numerical stability with safeguarded methods, and using a composite function to seamlessly handle flow regimes from the viscous sublayer to the fully turbulent log-layer .",
            "id": "3979547",
            "problem": "You are to design and implement a complete, robust algorithm to compute the friction velocity $u_{\\tau}$ at each wall-adjacent computational face in a Reynolds-averaged Navier–Stokes (RANS) solver using near-wall treatment with wall functions. The algorithm must derive from first principles and well-tested empirical relations, and must incorporate explicit under-relaxation to ensure numerical robustness across a broad range of inputs.\n\nThe starting point is the definition of friction velocity and the dimensionless wall variables. Let $u_{\\tau} = \\sqrt{\\tau_w / \\rho}$ be the friction velocity, where $\\tau_w$ is the wall shear stress and $\\rho$ is the fluid density. Define the dimensionless velocity $U^+$ and wall distance $y^+$ using the near-wall cell-center velocity magnitude $U_P$ (parallel to the wall), the wall-normal distance to the cell-center $y_P$, and the kinematic viscosity at the cell $ \\nu_P $:\n$$\nU^+ = \\frac{U_P}{u_{\\tau}}, \\qquad y^+ = \\frac{y_P u_{\\tau}}{\\nu_P}.\n$$\nFor wall-function treatment in fully turbulent flows, the mean velocity in wall units follows a universal near-wall relationship. In order to represent both the viscous sublayer and the logarithmic layer in a single continuous function, use a composite formulation that blends the linear law of the wall and the logarithmic law with a smooth transition. Let $\\kappa$ be the von Kármán constant and $B$ be the additive constant of the log law. With a dimensionless blending coefficient $\\alpha > 0$, define a blending weight\n$$\nw(y^+) = \\exp(-\\alpha y^+).\n$$\nDefine the composite velocity function $F(y^+)$ as\n$$\nF(y^+) = w(y^+)\\, y^+ + \\big(1 - w(y^+)\\big)\\left(\\frac{1}{\\kappa}\\ln(y^+) + B\\right),\n$$\nwhere $\\ln(y^+)$ is to be evaluated for $y^+ > 0$; any numerical implementation must handle extremely small $y^+$ safely. The wall-function relation to enforce at the wall-adjacent face is then the nonlinear scalar equation\n$$\n\\frac{U_P}{u_{\\tau}} = F\\!\\left(\\frac{y_P u_{\\tau}}{\\nu_P}\\right).\n$$\nYour task is to implement a robust solver for $u_{\\tau}$ given $(U_P, y_P, \\nu_P)$ and turbulence variables at the cell, specifically the turbulent kinetic energy $k_P$ and the dissipation rate $\\varepsilon_P$. You must:\n\n- Start from the above definitions and the composite near-wall relation, and argue that the scalar equation for $u_{\\tau}$ has a unique, physically meaningful solution for $U_P \\ge 0$ and $y_P > 0$ with $\\nu_P > 0$.\n- Devise a numerically stable iterative algorithm to solve for $u_{\\tau}$ that uses bracketing, a safeguarded Newton or secant step, and an explicit under-relaxation mechanism to avoid divergence. The algorithm should adaptively combine derivative-based steps and bisection to guarantee convergence.\n- Use the turbulence variables to construct a physically motivated initial guess. A widely used relation in the $k-\\varepsilon$ model is $C_{\\mu} = 0.09$, from which a reasonable initial friction velocity is $u_{\\tau,0} = C_{\\mu}^{1/4}\\sqrt{k_P}$. If $k_P$ is too small or missing, fall back to a nonzero initial guess derived from $U_P$, $y_P$, and $\\nu_P$ that is consistent with the wall law limits.\n- If $U_P = 0$, the physically consistent solution is $u_{\\tau} = 0$; your algorithm must detect and return that value without iteration.\n\nConstants to use: $\\kappa = 0.41$, $B = 5.2$, and $\\alpha = 1/11$. Your solution must be expressed in the International System of Units (SI): $U_P$ in $\\mathrm{m/s}$, $y_P$ in $\\mathrm{m}$, $\\nu_P$ in $\\mathrm{m^2/s}$, $k_P$ in $\\mathrm{m^2/s^2}$, $\\varepsilon_P$ in $\\mathrm{m^2/s^3}$, and the output friction velocity $u_{\\tau}$ in $\\mathrm{m/s}$. Report each $u_{\\tau}$ value rounded to six decimal places.\n\nImplement the algorithm in a runnable program that evaluates the following test suite of cases, each specified as $(U_P, y_P, \\nu_P, \\rho, k_P, \\varepsilon_P)$:\n\n1. $(20.0, 1.0 \\times 10^{-3}, 1.5 \\times 10^{-5}, 1.225, 2.0, 1.0)$\n2. $(0.05, 1.0 \\times 10^{-5}, 1.0 \\times 10^{-5}, 1.225, 1.0 \\times 10^{-3}, 1.0 \\times 10^{-4})$\n3. $(200.0, 2.0 \\times 10^{-3}, 1.5 \\times 10^{-5}, 1.225, 50.0, 10.0)$\n4. $(0.0, 1.0 \\times 10^{-3}, 1.5 \\times 10^{-5}, 1.225, 1.0, 1.0)$\n5. $(10.0, 1.0 \\times 10^{-3}, 1.0 \\times 10^{-4}, 1000.0, 1.0, 1.0)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"), where each result is the computed $u_{\\tau}$ in $\\mathrm{m/s}$ rounded to six decimal places. No other output is permitted.",
            "solution": "The problem as stated is valid. It is scientifically grounded in the principles of turbulent fluid dynamics, specifically near-wall modeling in Reynolds-Averaged Navier-Stokes (RANS) simulations. The formulation is mathematically well-posed and objective, providing all necessary definitions, constants, and data for a unique solution to be determined. We shall therefore proceed with the development of the required algorithm.\n\nThe core of the problem is to find the friction velocity $u_{\\tau}  0$ that satisfies the nonlinear scalar equation:\n$$\n\\frac{U_P}{u_{\\tau}} = F\\left(\\frac{y_P u_{\\tau}}{\\nu_P}\\right)\n$$\nwhere $U_P$ is the near-wall velocity, $y_P$ is the wall distance, $\\nu_P$ is the kinematic viscosity, and $F$ is the composite wall function:\n$$\nF(y^+) = \\exp(-\\alpha y^+) y^+ + \\big(1 - \\exp(-\\alpha y^+) \\big)\\left(\\frac{1}{\\kappa}\\ln(y^+) + B\\right)\n$$\nwith $y^+ = y_P u_{\\tau} / \\nu_P$. The constants are given as $\\kappa = 0.41$, $B = 5.2$, and $\\alpha = 1/11$.\n\nWe can reformulate the problem as finding the root of a residual function $g(u_{\\tau})$:\n$$\ng(u_{\\tau}) = u_{\\tau} F\\left(\\frac{y_P u_{\\tau}}{\\nu_P}\\right) - U_P = 0\n$$\n\n**1. Existence and Uniqueness of the Solution**\n\nBefore devising a numerical solver, we must demonstrate that a unique, physically meaningful solution exists for the specified conditions ($U_P \\ge 0$, $y_P > 0$, $\\nu_P > 0$).\n\nFirst, consider the trivial case where $U_P = 0$. The physical situation is a fluid at rest, which implies zero wall shear stress and thus $u_{\\tau} = \\sqrt{\\tau_w/\\rho} = 0$. The function $F(y^+)$ and the variable $y^+$ are constructed such that for any $u_{\\tau} > 0$, we have $y^+ > 0$ and $F(y^+) > 0$. Consequently, $u_{\\tau} F(y_P u_{\\tau} / \\nu_P) > 0$ for $u_{\\tau} > 0$. Therefore, the only possible solution to $g(u_{\\tau}) = 0$ when $U_P = 0$ is exactly $u_{\\tau}=0$.\n\nNow, consider the non-trivial case where $U_P > 0$. We seek a solution for $u_{\\tau} > 0$. Let us analyze the function $H(u_{\\tau}) = u_{\\tau} F(y_P u_{\\tau} / \\nu_P)$. We need to show that the equation $H(u_{\\tau}) = U_P$ has a unique positive solution.\n\n*   **Behavior at limits:**\n    *   As $u_{\\tau} \\to 0^+$, $y^+ = y_P u_{\\tau} / \\nu_P \\to 0^+$. In this limit, the composite function $F(y^+)$ behaves like the linear law of the wall, $F(y^+) \\approx y^+$.\n        $$\n        \\lim_{u_{\\tau} \\to 0^+} H(u_{\\tau}) = \\lim_{u_{\\tau} \\to 0^+} u_{\\tau} \\left(\\frac{y_P u_{\\tau}}{\\nu_P}\\right) = \\lim_{u_{\\tau} \\to 0^+} \\frac{y_P}{\\nu_P} u_{\\tau}^2 = 0\n        $$\n    *   As $u_{\\tau} \\to \\infty$, $y^+ \\to \\infty$. In this limit, the composite function $F(y^+)$ behaves like the logarithmic law of the wall, $F(y^+) \\approx \\frac{1}{\\kappa}\\ln(y^+) + B$.\n        $$\n        \\lim_{u_{\\tau} \\to \\infty} H(u_{\\tau}) = \\lim_{u_{\\tau} \\to \\infty} u_{\\tau} \\left(\\frac{1}{\\kappa}\\ln\\left(\\frac{y_P u_{\\tau}}{\\nu_P}\\right) + B\\right) = \\infty\n        $$\n\n*   **Monotonicity:** We examine the derivative of $H(u_{\\tau})$ with respect to $u_{\\tau}$. Let $c = y_P/\\nu_P$. Then $y^+ = c u_{\\tau}$. Using the chain rule:\n    $$\n    \\frac{dH}{du_{\\tau}} = \\frac{d}{du_{\\tau}} \\left[ u_{\\tau} F(c u_{\\tau}) \\right] = F(c u_{\\tau}) + u_{\\tau} F'(c u_{\\tau}) \\cdot c = F(y^+) + y^+ F'(y^+)\n    $$\n    The term $F(y^+)$ represents the dimensionless velocity profile $U^+$, which is physically required to be positive for $y^+ > 0$. The derivative $F'(y^+) = dU^+ / dy^+$ represents the gradient of this profile. For any physically realistic universal velocity profile, this gradient is also strictly positive for all $y^+ > 0$. Therefore, since $y^+ > 0$, $F(y^+) > 0$, and $F'(y^+) > 0$, it follows that $dH/du_{\\tau} > 0$ for all $u_{\\tau} > 0$.\n\nSince $H(u_{\\tau})$ is a continuous and strictly monotonically increasing function for $u_{\\tau} \\ge 0$, starting from $H(0)=0$ and approaching $\\infty$ as $u_{\\tau} \\to \\infty$, the Intermediate Value Theorem guarantees that for any given $U_P > 0$, there exists exactly one unique positive solution $u_{\\tau}$ such that $H(u_{\\tau}) = U_P$. The problem is thus well-posed.\n\n**2. Numerical Algorithm Design**\n\nWe need to design a robust iterative algorithm to find the root of $g(u_{\\tau}) = 0$. The algorithm incorporates an initial guess, a bracketing phase, and a safeguarded iterative solver with under-relaxation.\n\n*   **Initial Guess ($u_{\\tau,0}$):**\n    1.  The primary initial guess is derived from the turbulent kinetic energy $k_P$, based on the assumption of local equilibrium in the near-wall boundary layer. Using the standard $k-\\varepsilon$ model constant $C_{\\mu} = 0.09$:\n        $$\n        u_{\\tau,0} = C_{\\mu}^{1/4} \\sqrt{k_P} \\approx 0.5477 \\sqrt{k_P}\n        $$\n        This is used when $k_P$ is available and has a physically meaningful positive value.\n    2.  A fallback guess is required if $k_P$ is non-positive or unavailable. A guess consistent with the wall law limits can be derived by assuming the flow is deep in the viscous sublayer, where $U^+ = y^+$. This yields:\n        $$\n        \\frac{U_P}{u_{\\tau}} = \\frac{y_P u_{\\tau}}{\\nu_P} \\implies u_{\\tau,0} = \\sqrt{\\frac{U_P \\nu_P}{y_P}}\n        $$\n\n*   **Bracketing Strategy:**\n    To guarantee convergence, we first establish a search interval $[a, b]$ that brackets the root, i.e., $g(a) \\cdot g(b)  0$.\n    1.  We know $g(0) = -U_P  0$. We can set the lower bound $a$ to a very small positive number (e.g., $10^{-9}$) to avoid numerical issues at $u_{\\tau}=0$, ensuring $g(a)  0$.\n    2.  We evaluate $g(u_{\\tau,0})$. If $g(u_{\\tau,0})  0$, we have found a bracket $[a, u_{\\tau,0}]$.\n    3.  If $g(u_{\\tau,0}) \\le 0$, the initial guess is too low. We set the new lower bound to $u_{\\tau,0}$ and iteratively search for an upper bound by doubling the interval (e.g., $b = 2u_{\\tau,0}, 4u_{\\tau,0}, \\dots$) until we find a value $b$ for which $g(b)  0$. Themonotonicity of $H(u_{\\tau})$ guarantees such a $b$ exists.\n\n*   **Iterative Solver:**\n    A hybrid method combining the rapid convergence of the secant method with the guaranteed convergence of the bisection method is employed. This constitutes a safeguarded approach.\n    1.  Let the current bracket be $[a_k, b_k]$ and the current iterate be $u_{\\tau,k}$. A new trial value $u_{\\tau, \\text{trial}}$ is computed using the secant method:\n        $$\n        u_{\\tau, \\text{secant}} = u_{\\tau,k} - g(u_{\\tau,k}) \\frac{u_{\\tau,k} - u_{\\tau,k-1}}{g(u_{\\tau,k}) - g(u_{\\tau,k-1})}\n        $$\n    2.  **Safeguard:** We check if the secant step falls within the current bracket, i.e., $a_k  u_{\\tau, \\text{secant}}  b_k$. If it does, we accept it: $u_{\\tau, \\text{trial}} = u_{\\tau, \\text{secant}}$. If it falls outside the bracket, or if the secant denominator is close to zero, the step is deemed unsafe, and we fall back to the robust bisection method:\n        $$\n        u_{\\tau, \\text{bisect}} = \\frac{a_k + b_k}{2}\n        $$\n        In this case, we set $u_{\\tau, \\text{trial}} = u_{\\tau, \\text{bisect}}$.\n    3.  **Under-Relaxation:** To enhance stability, especially during the initial iterations of a CFD solve where fields can change drastically, an explicit under-relaxation factor $\\omega \\in (0, 1]$ is applied:\n        $$\n        u_{\\tau, k+1} = \\omega \\, u_{\\tau, \\text{trial}} + (1 - \\omega) \\, u_{\\tau, k}\n        $$\n        A typical value, such as $\\omega=0.7$, is appropriate.\n    4.  **Update Bracket:** After computing the new iterate $u_{\\tau, k+1}$, the residual $g(u_{\\tau, k+1})$ is evaluated. The bracket for the next iteration, $[a_{k+1}, b_{k+1}]$, is updated by replacing either $a_k$ or $b_k$ with $u_{\\tau, k+1}$, ensuring the root remains bracketed.\n\n*   **Convergence Criteria:** The iteration terminates when the relative change in $u_{\\tau}$ falls below a specified tolerance $\\epsilon_{\\text{rel}}$, or a maximum number of iterations is reached.\n    $$\n    \\frac{|u_{\\tau, k+1} - u_{\\tau, k}|}{|u_{\\tau,k+1}|}  \\epsilon_{\\text{rel}}\n    $$\n    A tolerance of $\\epsilon_{\\text{rel}} = 10^{-8}$ is suitable for engineering accuracy.\n\n*   **Numerical Safety:** The evaluation of $\\ln(y^+)$ requires $y^+0$. The algorithm is designed to only search for $u_\\tau0$, so this is satisfied. To prevent potential floating-point issues for extremely small $y^+$, a floor value (e.g., $10^{-12}$) is imposed on the argument of the logarithm within the implementation of $F(y^+)$, which does not affect the result as the blending correctly transitions to the linear profile $F(y^+) \\approx y^+$ in this regime.\n\nThis comprehensive algorithm provides a robust and efficient method for calculating the friction velocity, adhering to all requirements of the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\n# Global constants as defined in the problem statement\nKAPPA = 0.41\nB = 5.2\nALPHA = 1.0 / 11.0\nCMU = 0.09\n\ndef solve():\n    \"\"\"\n    Main function to solve for friction velocity for a suite of test cases.\n    \"\"\"\n\n    def F_composite(y_plus):\n        \"\"\"\n        Computes the value of the composite wall function F(y+).\n\n        Args:\n            y_plus (float): Dimensionless wall distance.\n\n        Returns:\n            float: Dimensionless velocity U+.\n        \"\"\"\n        # Safeguard against log(0) or log of a negative number. The algorithm ensures y_plus  0.\n        # A small floor value increases numerical stability for extremely small y_plus.\n        y_plus_safe = np.maximum(y_plus, 1e-12)\n        \n        # Blending weight\n        w = np.exp(-ALPHA * y_plus_safe)\n        \n        # Logarithmic law part\n        log_term = (1.0 / KAPPA) * np.log(y_plus_safe) + B\n        \n        # Composite formulation\n        return w * y_plus_safe + (1.0 - w) * log_term\n\n    def solve_utau_single_case(U_p, y_p, nu_p, rho, k_p, eps_p):\n        \"\"\"\n        Calculates the friction velocity u_tau for a single near-wall cell.\n\n        Args:\n            U_p (float): Velocity magnitude at cell center P.\n            y_p (float): Wall-normal distance from wall to cell center P.\n            nu_p (float): Kinematic viscosity at P.\n            rho (float): Density at P (unused in this formulation).\n            k_p (float): Turbulent kinetic energy at P.\n            eps_p (float): TKE dissipation rate at P (unused in this formulation).\n\n        Returns:\n            float: The calculated friction velocity u_tau.\n        \"\"\"\n        # Per problem statement, handle the trivial case of zero velocity.\n        if U_p  1e-9: # Use a tolerance for floating-point comparison\n            return 0.0\n\n        def g(utau):\n            \"\"\"Residual function g(u_tau) = u_tau * F(y^+(u_tau)) - U_p.\"\"\"\n            if utau = 0:\n                return -U_p\n            y_plus = y_p * utau / nu_p\n            return utau * F_composite(y_plus) - U_p\n\n        # --- Step 1: Initial Guess ---\n        if k_p  1e-9: # Primary guess from TKE\n            utau_guess = (CMU**0.25) * np.sqrt(k_p)\n        else: # Fallback guess from viscous sublayer assumption\n            utau_guess = np.sqrt(U_p * nu_p / y_p)\n        # Ensure the guess is a small, positive number at minimum.\n        utau_guess = np.maximum(utau_guess, 1e-6)\n\n        # --- Step 2: Bracketing ---\n        low_bound, high_bound = 1e-9, utau_guess\n        g_low, g_high = g(low_bound), g(high_bound)\n\n        if np.abs(g_high)  1e-14:\n            return high_bound\n\n        if g_high  0: # Root is bracketed by [low_bound, high_bound]\n            pass\n        else: # Initial guess is too low, expand bracket upwards\n            low_bound = high_bound\n            g_low = g_high\n            # Iteratively double the high_bound to find an upper bracket\n            for _ in range(10): # Limit search to prevent infinite loops\n                high_bound *= 2.0\n                g_high = g(high_bound)\n                if g_high  0:\n                    break\n            else:\n                # This should not be reached if the function is monotonic.\n                # As a safe exit, return the best guess so far.\n                return low_bound\n\n        # --- Step 3: Iterative Solver (Safeguarded Secant with Under-Relaxation) ---\n        max_iter = 50\n        rel_tol = 1e-8\n        omega = 0.7  # Under-relaxation factor\n\n        utau_k = high_bound\n        utau_km1 = low_bound\n        g_k = g_high\n        g_km1 = g_low\n        \n        for _ in range(max_iter):\n            # Secant step\n            if np.abs(g_k - g_km1)  1e-14: # Denominator is too small, fallback to bisection\n                utau_trial = 0.5 * (low_bound + high_bound)\n            else:\n                utau_secant = utau_k - g_k * (utau_k - utau_km1) / (g_k - g_km1)\n                \n                # Safeguard: if secant step is out of bounds, fallback to bisection\n                if utau_secant  low_bound and utau_secant  high_bound:\n                    utau_trial = utau_secant\n                else:\n                    utau_trial = 0.5 * (low_bound + high_bound)\n            \n            # Apply under-relaxation\n            utau_next = omega * utau_trial + (1.0 - omega) * utau_k\n\n            # Check for convergence\n            if np.abs(utau_next - utau_k) / (np.abs(utau_next) + 1e-12)  rel_tol:\n                utau_k = utau_next\n                break\n\n            # Update state for next iteration\n            utau_km1 = utau_k\n            g_km1 = g_k\n            utau_k = utau_next\n            g_k = g(utau_k)\n\n            # Update bracket for next iteration\n            if g_k  0:\n                high_bound = utau_k\n            else:\n                low_bound = utau_k\n        \n        return utau_k\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (U_p, y_p, nu_p, rho, k_p, eps_p)\n        (20.0, 1.0e-3, 1.5e-5, 1.225, 2.0, 1.0),\n        (0.05, 1.0e-5, 1.0e-5, 1.225, 1.0e-3, 1.0e-4),\n        (200.0, 2.0e-3, 1.5e-5, 1.225, 50.0, 10.0),\n        (0.0, 1.0e-3, 1.5e-5, 1.225, 1.0, 1.0),\n        (10.0, 1.0e-3, 1.0e-4, 1000.0, 1.0, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Main logic to calculate the result for one case.\n        result = solve_utau_single_case(*case)\n        # Format to six decimal places as required.\n        results.append(f\"{result:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}