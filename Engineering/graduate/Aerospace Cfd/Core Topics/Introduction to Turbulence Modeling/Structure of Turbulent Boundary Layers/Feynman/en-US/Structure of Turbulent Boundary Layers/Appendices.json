{
    "hands_on_practices": [
        {
            "introduction": "The canonical multi-layer structure of the turbulent boundary layer is defined by the balance between viscous and turbulent stresses. This exercise uses the foundational mixing-length model to analytically explore this balance. By deriving the ratio of viscous to turbulent shear stress, you will quantify how stress is transferred from molecular to turbulent mechanisms as you move away from the wall, solidifying your understanding of the sublayer, buffer layer, and logarithmic region .",
            "id": "3997715",
            "problem": "Consider a zero-pressure-gradient, incompressible turbulent boundary layer over a smooth flat plate at high Reynolds number, as analyzed in aerospace computational fluid dynamics (CFD). Define the inner (viscous) scaling by $u^{+} = \\bar{u}/u_{\\tau}$ and $y^{+} = y\\,u_{\\tau}/\\nu$, where $\\bar{u}$ is the mean streamwise velocity, $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$ is the friction velocity, $\\tau_{w}$ is the wall shear stress, $\\rho$ is the fluid density, and $\\nu$ is the kinematic viscosity. The mean shear stress is decomposed as $\\tau = \\tau_{v} + \\tau_{t}$ with $\\tau_{v} = \\mu\\,\\partial \\bar{u}/\\partial y$ and $\\tau_{t} = -\\rho\\,\\overline{u'v'}$, and in the inner layer the total stress is approximately constant, $\\tau \\approx \\rho\\,u_{\\tau}^{2}$. Assume the Boussinesq hypothesis with a mixing length $l = \\kappa\\,y$, where $\\kappa$ is the von Kármán constant, and use the equilibrium inner-layer assumption to model the turbulent shear as $\\tau_{t} = \\rho\\,l^{2}\\left(\\partial \\bar{u}/\\partial y\\right)^{2}$.\n\nStarting from these definitions and assumptions:\n\n1) Using inner scaling, compare the mean shear $\\partial \\bar{u}/\\partial y$ in the viscous sublayer and in the logarithmic region by deriving expressions that depend on $u_{\\tau}$, $\\nu$, $\\kappa$, $y$, and $y^{+}$.\n\n2) Derive a closed-form expression for the dimensionless viscous shear stress $\\tau_{v}^{+} = \\tau_{v}/(\\rho\\,u_{\\tau}^{2})$ as a function of $y^{+}$ and $\\kappa$ within the mixing-length equilibrium model.\n\n3) Let $R(y^{+}) = \\tau_{v}/\\tau_{t}$ be the ratio of viscous to turbulent shear stress. Using your expression from part (2) and $\\tau_{t}^{+} = 1 - \\tau_{v}^{+}$, evaluate the fractional change in $R$ across the buffer layer from $y^{+} = 5$ to $y^{+} = 30$, defined as $C = R(30)/R(5)$, with $\\kappa = 0.41$. Round your final value of $C$ to four significant figures. Express $C$ as a dimensionless number (no units).",
            "solution": "The problem is valid as it is scientifically grounded in the principles of fluid dynamics, specifically turbulent boundary layer theory. It is well-posed, objective, and provides a complete and consistent set of definitions and assumptions required for a unique solution.\n\nWe are given the following assumptions for a zero-pressure-gradient incompressible turbulent boundary layer:\n1.  The total shear stress $\\tau$ is the sum of viscous shear stress $\\tau_{v}$ and turbulent shear stress $\\tau_{t}$: $\\tau = \\tau_{v} + \\tau_{t}$.\n2.  In the inner layer, the total stress is approximately constant and equal to the wall shear stress: $\\tau \\approx \\tau_{w} = \\rho\\,u_{\\tau}^{2}$.\n3.  The viscous shear stress is given by Newton's law of viscosity: $\\tau_{v} = \\mu\\,\\frac{\\partial \\bar{u}}{\\partial y} = \\rho\\nu\\,\\frac{\\partial \\bar{u}}{\\partial y}$.\n4.  The turbulent shear stress is modeled using Prandtl's mixing length hypothesis: $\\tau_{t} = \\rho\\,l^{2}\\left(\\frac{\\partial \\bar{u}}{\\partial y}\\right)^{2}$, with the mixing length $l = \\kappa\\,y$.\n\nCombining these gives the total stress equation for the inner layer:\n$$\n\\rho\\,u_{\\tau}^{2} = \\rho\\nu\\,\\frac{\\partial \\bar{u}}{\\partial y} + \\rho\\,(\\kappa y)^{2}\\left(\\frac{\\partial \\bar{u}}{\\partial y}\\right)^{2}\n$$\n\n**1) Mean Shear in Viscous Sublayer and Logarithmic Region**\n\nTo compare the mean shear, $\\frac{\\partial \\bar{u}}{\\partial y}$, we analyze the two limiting cases of the inner layer.\n\nIn the **viscous sublayer** (as $y^{+} \\to 0$), turbulent effects are negligible, so $\\tau_{t} \\to 0$. The total stress is dominated by the viscous stress:\n$$\n\\tau \\approx \\tau_v\n$$\n$$\n\\rho\\,u_{\\tau}^{2} \\approx \\rho\\nu\\,\\frac{\\partial \\bar{u}}{\\partial y}\n$$\nSolving for the mean shear gives:\n$$\n\\frac{\\partial \\bar{u}}{\\partial y} = \\frac{u_{\\tau}^{2}}{\\nu}\n$$\nThis expression shows that the mean shear is constant in the viscous sublayer.\n\nIn the **logarithmic region** (for large $y^{+}$), viscous effects are negligible, so $\\tau_{v} \\to 0$. The total stress is dominated by the turbulent stress:\n$$\n\\tau \\approx \\tau_t\n$$\n$$\n\\rho\\,u_{\\tau}^{2} \\approx \\rho\\,(\\kappa y)^{2}\\left(\\frac{\\partial \\bar{u}}{\\partial y}\\right)^{2}\n$$\nSolving for the mean shear (and taking the positive root since $\\frac{\\partial \\bar{u}}{\\partial y}  0$ for this flow):\n$$\nu_{\\tau}^{2} \\approx (\\kappa y)^{2}\\left(\\frac{\\partial \\bar{u}}{\\partial y}\\right)^{2} \\implies u_{\\tau} \\approx \\kappa y\\,\\frac{\\partial \\bar{u}}{\\partial y}\n$$\n$$\n\\frac{\\partial \\bar{u}}{\\partial y} = \\frac{u_{\\tau}}{\\kappa y}\n$$\nThis expression shows that the mean shear varies inversely with the distance from the wall, $y$. We can also express this in terms of $y^{+}$ using the definition $y = y^{+}\\nu/u_{\\tau}$:\n$$\n\\frac{\\partial \\bar{u}}{\\partial y} = \\frac{u_{\\tau}}{\\kappa (y^{+}\\nu/u_{\\tau})} = \\frac{u_{\\tau}^{2}}{\\kappa\\nu y^{+}}\n$$\n\n**2) Expression for Dimensionless Viscous Shear Stress $\\tau_{v}^{+}$**\n\nTo find an expression for $\\tau_{v}^{+}$ valid across the entire inner layer (including the buffer layer where both stresses are important), we first non-dimensionalize the governing stress equation.\nThe fundamental equation is:\n$$\n\\rho\\,u_{\\tau}^{2} = \\rho\\nu\\,\\frac{\\partial \\bar{u}}{\\partial y} + \\rho\\,(\\kappa y)^{2}\\left(\\frac{\\partial \\bar{u}}{\\partial y}\\right)^{2}\n$$\nDivide by $\\rho\\,u_{\\tau}^{2}$:\n$$\n1 = \\frac{\\nu}{u_{\\tau}^{2}}\\frac{\\partial \\bar{u}}{\\partial y} + \\frac{(\\kappa y)^{2}}{u_{\\tau}^{2}}\\left(\\frac{\\partial \\bar{u}}{\\partial y}\\right)^{2}\n$$\nWe introduce the inner variables $u^{+} = \\bar{u}/u_{\\tau}$ and $y^{+} = y\\,u_{\\tau}/\\nu$. The mean shear gradient in inner variables is:\n$$\n\\frac{\\partial \\bar{u}}{\\partial y} = \\frac{\\partial (u_{\\tau}u^{+})}{\\partial (y^{+}\\nu/u_{\\tau})} = \\frac{u_{\\tau}}{(\\nu/u_{\\tau})}\\frac{du^{+}}{dy^{+}} = \\frac{u_{\\tau}^{2}}{\\nu}\\frac{du^{+}}{dy^{+}}\n$$\nSubstituting this into the non-dimensionalized stress equation:\n$$\n1 = \\frac{\\nu}{u_{\\tau}^{2}}\\left(\\frac{u_{\\tau}^{2}}{\\nu}\\frac{du^{+}}{dy^{+}}\\right) + \\frac{(\\kappa y)^{2}}{u_{\\tau}^{2}}\\left(\\frac{u_{\\tau}^{2}}{\\nu}\\frac{du^{+}}{dy^{+}}\\right)^{2}\n$$\nThe dimensionless viscous stress is $\\tau_{v}^{+} = \\tau_{v}/(\\rho u_{\\tau}^2)$, which simplifies to:\n$$\n\\tau_{v}^{+} = \\frac{\\rho\\nu\\,\\frac{\\partial \\bar{u}}{\\partial y}}{\\rho u_{\\tau}^2} = \\frac{\\nu}{u_{\\tau}^2}\\left(\\frac{u_{\\tau}^{2}}{\\nu}\\frac{du^{+}}{dy^{+}}\\right) = \\frac{du^{+}}{dy^{+}}\n$$\nSubstituting $y=y^+\\nu/u_\\tau$ into the second term of the stress equation:\n$$\n\\frac{(\\kappa y)^{2}}{u_{\\tau}^{2}} = \\frac{\\kappa^2 (y^+\\nu/u_\\tau)^2}{u_\\tau^2} = \\frac{\\kappa^2 (y^+)^2 \\nu^2}{u_\\tau^4}\n$$\nThe full equation becomes:\n$$\n1 = \\frac{du^{+}}{dy^{+}} + \\left(\\frac{\\kappa^2 (y^+)^2 \\nu^2}{u_\\tau^4}\\right) \\left(\\frac{u_\\tau^4}{\\nu^2}\\right) \\left(\\frac{du^{+}}{dy^{+}}\\right)^{2}\n$$\n$$\n1 = \\frac{du^{+}}{dy^{+}} + (\\kappa y^{+})^{2}\\left(\\frac{du^{+}}{dy^{+}}\\right)^{2}\n$$\nBy substituting $\\tau_v^+ = du^+/dy^+$, we get a quadratic equation for $\\tau_v^+$:\n$$\n1 = \\tau_{v}^{+} + (\\kappa y^{+})^{2}(\\tau_{v}^{+})^{2}\n$$\n$$\n(\\kappa y^{+})^{2}(\\tau_{v}^{+})^{2} + \\tau_{v}^{+} - 1 = 0\n$$\nSolving this quadratic equation for $\\tau_{v}^{+}$:\n$$\n\\tau_{v}^{+} = \\frac{-1 \\pm \\sqrt{1^{2} - 4(\\kappa y^{+})^{2}(-1)}}{2(\\kappa y^{+})^{2}} = \\frac{-1 \\pm \\sqrt{1 + 4(\\kappa y^{+})^{2}}}{2(\\kappa y^{+})^{2}}\n$$\nSince shear stress must be non-negative ($\\tau_{v}^{+} \\ge 0$), we must take the positive root.\n$$\n\\tau_{v}^{+} = \\frac{-1 + \\sqrt{1 + 4(\\kappa y^{+})^{2}}}{2(\\kappa y^{+})^{2}}\n$$\nThis is the closed-form expression for the dimensionless viscous shear stress.\n\n**3) Fractional Change in the Ratio $R(y^{+}) = \\tau_{v}/\\tau_{t}$**\n\nThe ratio of viscous to turbulent shear stress is $R(y^{+}) = \\tau_{v}/\\tau_{t}$. In dimensionless form, this is $R(y^{+}) = \\tau_{v}^{+}/\\tau_{t}^{+}$.\nFrom the total stress identity $1 = \\tau_{v}^{+} + \\tau_{t}^{+}$, we have $\\tau_{t}^{+} = 1 - \\tau_{v}^{+}$.\nTherefore, $R(y^{+}) = \\frac{\\tau_{v}^{+}}{1 - \\tau_{v}^{+}}$.\nFrom the quadratic equation derived in part (2), we can write $1 - \\tau_{v}^{+} = (\\kappa y^{+})^{2}(\\tau_{v}^{+})^{2}$.\nSubstituting this into the expression for $R(y^{+})$:\n$$\nR(y^{+}) = \\frac{\\tau_{v}^{+}}{(\\kappa y^{+})^{2}(\\tau_{v}^{+})^{2}} = \\frac{1}{(\\kappa y^{+})^{2}\\tau_{v}^{+}}\n$$\nNow, substitute the expression for $\\tau_{v}^{+}$ from part (2):\n$$\nR(y^{+}) = \\frac{1}{(\\kappa y^{+})^{2} \\left( \\frac{-1 + \\sqrt{1 + 4(\\kappa y^{+})^{2}}}{2(\\kappa y^{+})^{2}} \\right)} = \\frac{2}{-1 + \\sqrt{1 + 4(\\kappa y^{+})^{2}}}\n$$\nWe need to evaluate the fractional change $C = R(30)/R(5)$, using $\\kappa = 0.41$.\n$$\nC = \\frac{R(30)}{R(5)} = \\frac{\\frac{2}{-1 + \\sqrt{1 + 4(\\kappa \\cdot 30)^{2}}}}{\\frac{2}{-1 + \\sqrt{1 + 4(\\kappa \\cdot 5)^{2}}}} = \\frac{-1 + \\sqrt{1 + 4(\\kappa \\cdot 5)^{2}}}{-1 + \\sqrt{1 + 4(\\kappa \\cdot 30)^{2}}}\n$$\nFirst, calculate the arguments:\nFor $y^{+} = 5$: $\\kappa \\cdot 5 = 0.41 \\times 5 = 2.05$.\nFor $y^{+} = 30$: $\\kappa \\cdot 30 = 0.41 \\times 30 = 12.3$.\n\nNow substitute these values into the expression for $C$:\n$$\nC = \\frac{-1 + \\sqrt{1 + 4(2.05)^{2}}}{-1 + \\sqrt{1 + 4(12.3)^{2}}}\n$$\n$$\nC = \\frac{-1 + \\sqrt{1 + 4(4.2025)}}{-1 + \\sqrt{1 + 4(151.29)}}\n$$\n$$\nC = \\frac{-1 + \\sqrt{1 + 16.81}}{-1 + \\sqrt{1 + 605.16}}\n$$\n$$\nC = \\frac{-1 + \\sqrt{17.81}}{-1 + \\sqrt{606.16}}\n$$\n$$\nC \\approx \\frac{-1 + 4.22018957}{-1 + 24.61950446} = \\frac{3.22018957}{23.61950446} \\approx 0.1363361\n$$\nRounding to four significant figures, the result is $0.1363$.",
            "answer": "$$\n\\boxed{0.1363}\n$$"
        },
        {
            "introduction": "The Reynolds shear stress, $-\\rho\\overline{u'v'}$, is the cornerstone of RANS modeling, but as a time-averaged statistic, it hides the rich physics of turbulent momentum transport. This practice delves into the instantaneous velocity fluctuations using quadrant analysis to deconstruct the Reynolds stress into its constituent events. By calculating the contribution of powerful \"ejection\" and \"sweep\" motions, you will gain a deeper physical intuition for how turbulence sustains itself and transports momentum .",
            "id": "3997716",
            "problem": "Consider a zero-pressure-gradient turbulent boundary layer over a smooth flat plate at high Reynolds number. At the buffer layer location of peak turbulent kinetic energy production (in inner units, at $y^{+} \\approx 12$), the instantaneous streamwise and wall-normal velocity fluctuations, denoted by $u'$ and $v'$, are analyzed using quadrant analysis. Define the four quadrants $Q1$ through $Q4$ based on the signs of $(u',v')$. Starting from the Reynolds decomposition of the velocity field and the definition of Reynolds shear stress, derive how the conditional contribution of selected quadrants to $-\\overline{u'v'}$ is computed from a law-of-total-expectation partition over events.\n\nAssume the quadrants are represented by four discrete event clusters with probabilities $p_{k}$ and representative fluctuation values $(u'_{k},v'_{k})$ expressed in units of the friction velocity $u_{\\tau}$. At $y^{+} \\approx 12$, a Direct Numerical Simulation (DNS) yields the following statistically stationary quadrant clusters:\n- $Q1$ ($u'  0$, $v'  0$): $p_{1} = 0.25$, $(u'_{1},v'_{1}) = (0.20\\,u_{\\tau},\\,0.194\\,u_{\\tau})$,\n- $Q2$ ($u'  0$, $v'  0$): $p_{2} = 0.23$, $(u'_{2},v'_{2}) = (-1.20\\,u_{\\tau},\\,0.90\\,u_{\\tau})$,\n- $Q3$ ($u'  0$, $v'  0$): $p_{3} = 0.25$, $(u'_{3},v'_{3}) = (-0.608\\,u_{\\tau},\\,-0.050\\,u_{\\tau})$,\n- $Q4$ ($u'  0$, $v'  0$): $p_{4} = 0.27$, $(u'_{4},v'_{4}) = (1.40\\,u_{\\tau},\\,-0.90\\,u_{\\tau})$.\n\nUsing these data, compute the combined conditional contribution of the ejection events ($Q2$) and sweep events ($Q4$) to $-\\overline{u'v'}$ at $y^{+} \\approx 12$. Express your final answer in units of $u_{\\tau}^{2}$ and round your answer to four significant figures.",
            "solution": "The problem asks for the derivation and calculation of the combined contribution of ejection and sweep events to the kinematic Reynolds shear stress, $-\\overline{u'v'}$, in a turbulent boundary layer. The derivation starts from the definition of Reynolds shear stress and employs the law of total expectation.\n\nThe instantaneous velocity components, streamwise $u$ and wall-normal $v$, are decomposed into mean and fluctuating parts via Reynolds decomposition:\n$$u = \\overline{u} + u'$$\n$$v = \\overline{v} + v'$$\nFor a two-dimensional boundary layer, the mean wall-normal velocity $\\overline{v}$ is zero. The kinematic Reynolds shear stress, which is a component of the Reynolds stress tensor, is defined as the time-average of the product of the velocity fluctuations, specifically $-\\overline{u'v'}$. In the context of statistically stationary turbulence, the time-average operator $\\overline{(\\cdot)}$ is equivalent to the expectation operator $E[\\cdot]$ from probability theory. Therefore, we are interested in computing a contribution to the quantity $-E[u'v']$.\n\nQuadrant analysis provides a framework to partition the statistical events. The sample space of all instantaneous fluctuation pairs $(u', v')$ is divided into four mutually exclusive and exhaustive quadrants, which are discrete events $Q_k$ for $k \\in \\{1, 2, 3, 4\\}$:\n- $Q_1$: Outward interaction ($u'  0$, $v'  0$)\n- $Q_2$: Ejection ($u'  0$, $v'  0$)\n- $Q_3$: Inward interaction ($u'  0$, $v'  0$)\n- $Q_4$: Sweep ($u'  0$, $v'  0$)\n\nThe law of total expectation allows us to express the overall expected value of a random variable as a weighted sum of its conditional expectations over a partition of the sample space. Applying this law to the random variable $u'v'$ and the partition $\\{Q_1, Q_2, Q_3, Q_4\\}$:\n$$E[u'v'] = \\sum_{k=1}^{4} E[u'v' | Q_k] P(Q_k)$$\nHere, $P(Q_k)$ is the probability of the event $Q_k$, given in the problem as $p_k$. The term $E[u'v' | Q_k]$ is the conditional expectation of the product $u'v'$, given that the fluctuation pair falls within quadrant $k$.\n\nThe problem provides \"representative fluctuation values\" $(u'_k, v'_k)$ for each quadrant cluster. This implies an approximation of the conditional expectation by the product of these representative (mean) values:\n$$E[u'v' | Q_k] \\approx u'_k v'_k$$\nSubstituting this into the law of total expectation, we get an approximation for the total kinematic Reynolds shear stress:\n$$-\\overline{u'v'} = -E[u'v'] \\approx -\\sum_{k=1}^{4} (u'_k v'_k) p_k$$\nThe contribution of a specific quadrant $k$ to the total Reynolds shear stress $-\\overline{u'v'}$ is thus given by $C_k = -(u'_k v'_k) p_k$. The problem requires the computation of the combined conditional contribution of ejection ($Q_2$) and sweep ($Q_4$) events. This is the sum of their individual contributions:\n$$C_{24} = C_2 + C_4 = -(u'_2 v'_2) p_2 - (u'_4 v'_4) p_4$$\n\nWe now substitute the provided data from the Direct Numerical Simulation (DNS). The data is given in units of the friction velocity $u_{\\tau}$.\n\nFor the ejection events ($Q_2$):\n- Probability: $p_2 = 0.23$\n- Representative fluctuations: $u'_2 = -1.20\\,u_{\\tau}$ and $v'_2 = 0.90\\,u_{\\tau}$\n\nThe contribution from $Q_2$ is:\n$$C_2 = - (u'_2 v'_2) p_2 = - ((-1.20\\,u_{\\tau}) (0.90\\,u_{\\tau})) (0.23)$$\n$$C_2 = - (-1.08\\,u_{\\tau}^2) (0.23)$$\n$$C_2 = 0.2484\\,u_{\\tau}^2$$\n\nFor the sweep events ($Q_4$):\n- Probability: $p_4 = 0.27$\n- Representative fluctuations: $u'_4 = 1.40\\,u_{\\tau}$ and $v'_4 = -0.90\\,u_{\\tau}$\n\nThe contribution from $Q_4$ is:\n$$C_4 = - (u'_4 v'_4) p_4 = - ((1.40\\,u_{\\tau}) (-0.90\\,u_{\\tau})) (0.27)$$\n$$C_4 = - (-1.26\\,u_{\\tau}^2) (0.27)$$\n$$C_4 = 0.3402\\,u_{\\tau}^2$$\n\nThe combined conditional contribution from ejections and sweeps is the sum of their individual contributions:\n$$C_{24} = C_2 + C_4 = 0.2484\\,u_{\\tau}^2 + 0.3402\\,u_{\\tau}^2$$\n$$C_{24} = 0.5886\\,u_{\\tau}^2$$\n\nThe problem asks for the numerical value expressed in units of $u_{\\tau}^2$, rounded to four significant figures. The calculated value $0.5886$ already has four significant figures.",
            "answer": "$$\\boxed{0.5886}$$"
        },
        {
            "introduction": "In practical Large Eddy Simulations (LES) of high-Reynolds-number flows, resolving the near-wall region is often computationally intractable, a challenge exacerbated by complex geometries like rough surfaces. This hands-on coding practice demonstrates how our theoretical understanding of the logarithmic law can be extended with a roughness function to create a \"wall model\". You are challenged to implement this model to compute the wall shear stress, a critical skill in applied computational fluid dynamics that bridges theory with simulation practice .",
            "id": "3997686",
            "problem": "Design and implement a self-contained program that computes the wall friction velocity for a turbulent boundary layer over a rough wall using a wall-model suitable for Large Eddy Simulation (LES). The equilibrium wall-model must incorporate a roughness function and be validated against known roughness correlations for the inner-normalized roughness function $\\Delta U^+(k^+)$. Begin from the following foundational base: the incompressible momentum balance near the wall implies the existence of a friction velocity $u_\\tau$ defined by $u_\\tau = \\sqrt{\\tau_w/\\rho}$, and by definition $U^+ = U/u_\\tau$ and $y^+ = y u_\\tau/\\nu$, where $U$ is the resolved streamwise velocity at the first off-wall point, $y$ is the distance from the wall to that point, $\\nu$ is the kinematic viscosity, and $\\rho$ is the fluid density. In the inertial sublayer under equilibrium conditions, the mean profile is represented by a logarithmic law modified by a roughness function, expressed in inner (plus) variables as $U^+ = \\frac{1}{\\kappa}\\ln(y^+) + B - \\Delta U^+(k^+)$, where $k^+ = k u_\\tau/\\nu$ and $k$ is the equivalent sand-grain roughness height. The constants $\\kappa$ (von Kármán constant) and $B$ (intercept for smooth walls) are to be taken as $\\kappa = 0.41$ and $B = 5.0$.\n\nYour LES wall-model must use the following parametric roughness function:\n$$\n\\Delta U^+_{\\mathrm{model}}(k^+) = \\frac{1}{\\kappa}\\ln\\!\\left(1 + \\alpha \\max(0, k^+ - k_0^+)\\right),\n$$\nwith $k_0^+ = 5$ and $\\alpha = \\exp(-\\kappa C)$ where $C = 3.5$. This choice of $\\alpha$ ensures that for large $k^+$ the model asymptotically recovers the fully rough shift $-\\frac{1}{\\kappa}\\ln(\\alpha) = C$.\n\nFor validation, compare $\\Delta U^+_{\\mathrm{model}}(k^+)$ to a reference roughness correlation $\\Delta U^+_{\\mathrm{ref}}(k^+)$ defined piecewise as\n$$\n\\Delta U^+_{\\mathrm{ref}}(k^+) =\n\\begin{cases}\n0,  k^+ \\le 5 \\\\\n\\frac{1}{\\kappa}\\ln\\!\\left(1 + 0.26\\,(k^+ - 5)\\right),  5  k^+  100 \\\\\n\\frac{1}{\\kappa}\\ln(k^+) - 3.5,  k^+ \\ge 100\n\\end{cases}\n$$\n\nAlgorithmic task:\n- For each test case, solve the nonlinear equation\n$$\n\\frac{U}{u_\\tau} - \\frac{1}{\\kappa}\\ln\\!\\left(\\frac{y u_\\tau}{\\nu}\\right) - B + \\Delta U^+_{\\mathrm{model}}\\!\\left(\\frac{k u_\\tau}{\\nu}\\right) = 0\n$$\nfor $u_\\tau  0$ using a robust numerical method of your choice that does not rely on external input. After finding $u_\\tau$, compute the absolute validation error\n$$\nE = \\left|\\Delta U^+_{\\mathrm{model}}(k^+) - \\Delta U^+_{\\mathrm{ref}}(k^+)\\right|\n$$\nevaluated at the same $k^+ = k u_\\tau/\\nu$.\n\nUnits and outputs:\n- Express $u_\\tau$ in $\\mathrm{m/s}$.\n- Express $E$ as a dimensionless quantity.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[u_{\\tau,1},E_1,u_{\\tau,2},E_2,\\dots]$. No other text must be printed.\n\nTest suite:\nUse the following four scientifically plausible test cases that cover smooth, transitional, fully rough, and a near-wall resolution edge case. Each case is provided as $(\\rho,\\nu,U,y,k)$ with $\\rho$ in $\\mathrm{kg/m^3}$, $\\nu$ in $\\mathrm{m^2/s}$, $U$ in $\\mathrm{m/s}$, $y$ in $\\mathrm{m}$, and $k$ in $\\mathrm{m}$.\n\n- Case 1 (hydraulically smooth baseline): $(\\rho,\\nu,U,y,k) = (1.225,\\;1.5\\times 10^{-5},\\;15.0,\\;1.0\\times 10^{-3},\\;0.0)$.\n- Case 2 (transitionally rough): $(\\rho,\\nu,U,y,k) = (1.225,\\;1.5\\times 10^{-5},\\;20.0,\\;1.0\\times 10^{-3},\\;4.0\\times 10^{-4})$.\n- Case 3 (fully rough): $(\\rho,\\nu,U,y,k) = (1.225,\\;1.5\\times 10^{-5},\\;30.0,\\;5.0\\times 10^{-3},\\;2.0\\times 10^{-3})$.\n- Case 4 (near-wall resolution edge case): $(\\rho,\\nu,U,y,k) = (1.225,\\;1.5\\times 10^{-5},\\;10.0,\\;1.0\\times 10^{-5},\\;2.0\\times 10^{-4})$.\n\nYour program must compute, for each case, the friction velocity $u_\\tau$ in $\\mathrm{m/s}$ and the validation error $E$ (dimensionless), and print them in the specified final output format as a single line: $[u_{\\tau,1},E_1,u_{\\tau,2},E_2,u_{\\tau,3},E_3,u_{\\tau,4},E_4]$.\n\nAll mathematical entities in this problem are expressed in LaTeX, and angles or percentages are not involved. Ensure your numerical method is stable for the provided cases and retains scientific realism in the interpretation of the results.",
            "solution": "The problem is assessed as valid. It is scientifically grounded in the principles of turbulent boundary layer theory, well-posed as a root-finding problem, and all necessary parameters and conditions are provided unambiguously.\n\nThe overarching task is to compute the friction velocity, $u_\\tau$, for a turbulent flow over a rough surface by solving a nonlinear equation derived from the logarithmic law of the wall. This law is modified to account for wall roughness effects, a common practice in wall-modeling for Large Eddy Simulations (LES). Subsequently, the implemented roughness model is to be validated against a reference correlation by computing an error metric, $E$.\n\nThe core of the problem lies in solving the following nonlinear transcendental equation for the unknown friction velocity, $u_\\tau$:\n$$\nf(u_\\tau) = \\frac{U}{u_\\tau} - \\frac{1}{\\kappa}\\ln\\left(\\frac{y u_\\tau}{\\nu}\\right) - B + \\Delta U^+_{\\mathrm{model}}\\left(\\frac{k u_\\tau}{\\nu}\\right) = 0\n$$\nHere, $U$ is the mean streamwise velocity at the first off-wall grid point, $y$ is the wall-normal distance to that point, $\\nu$ is the kinematic viscosity of the fluid, and $k$ is the equivalent sand-grain roughness height. The constants are the von Kármán constant, $\\kappa = 0.41$, and the smooth-wall log-law intercept, $B = 5.0$.\n\nThe function $\\Delta U^+_{\\mathrm{model}}(k^+)$ represents the model for the roughness-induced velocity shift in the log-law, where $k^+ = k u_\\tau/\\nu$ is the roughness height non-dimensionalized by the viscous length scale, $\\nu/u_\\tau$. The model is given by:\n$$\n\\Delta U^+_{\\mathrm{model}}(k^+) = \\frac{1}{\\kappa}\\ln\\left(1 + \\alpha \\max(0, k^+ - k_0^+)\\right)\n$$\nThe parameters for this model are specified as $k_0^+ = 5$ and $\\alpha = \\exp(-\\kappa C)$, with $C = 3.5$. This yields $\\alpha = \\exp(-0.41 \\times 3.5) = \\exp(-1.435) \\approx 0.238115$. This model ensures that for hydraulically smooth walls ($k^+ \\le k_0^+$), the shift $\\Delta U^+$ is zero, recovering the standard smooth-wall log-law. For large $k^+$, it correctly asymptotes to the fully rough law.\n\nTo solve the equation $f(u_\\tau) = 0$, a numerical root-finding algorithm is necessary. An analysis of the function $f(u_\\tau)$ for $u_\\tau  0$ reveals that it is continuous and generally monotonic. As $u_\\tau \\to 0^+$, the term $U/u_\\tau$ dominates, and $f(u_\\tau) \\to +\\infty$. As $u_\\tau \\to \\infty$, the function approaches a finite, typically negative, value. This behavior guarantees the existence of at least one root $u_\\tau  0$ and makes the function amenable to bracket-based root-finding methods. We select Brent's method, as implemented in `scipy.optimize.root_scalar`, for its robustness and efficiency. This method requires bracketing the root, i.e., finding an interval $[a, b]$ such that $f(a)$ and $f(b)$ have opposite signs. A reliable bracket for this problem is $[u_{\\tau, \\text{low}}, u_{\\tau, \\text{high}}]$, where $u_{\\tau, \\text{low}}$ is a small positive number (e.g., $10^{-6}$ m/s) and $u_{\\tau, \\text{high}}$ can be taken as the velocity $U$, which ensures $f(u_{\\tau, \\text{low}})  0$ and $f(u_{\\tau, \\text{high}})  0$ for all provided test cases.\n\nFollowing the determination of $u_\\tau$, the validation error $E$ is calculated. This requires the specified reference roughness function, $\\Delta U^+_{\\mathrm{ref}}(k^+)$, which is defined piecewise:\n$$\n\\Delta U^+_{\\mathrm{ref}}(k^+) =\n\\begin{cases}\n0,  k^+ \\le 5 \\\\\n\\frac{1}{\\kappa}\\ln\\left(1 + 0.26\\,(k^+ - 5)\\right),  5  k^+  100 \\\\\n\\frac{1}{\\kappa}\\ln(k^+) - 3.5,  k^+ \\ge 100\n\\end{cases}\n$$\nThe absolute error $E$ is then computed as:\n$$\nE = \\left|\\Delta U^+_{\\mathrm{model}}(k^+) - \\Delta U^+_{\\mathrm{ref}}(k^+)\\right|\n$$\nwhere $k^+$ is evaluated using the numerically solved value of $u_\\tau$.\n\nThe algorithmic procedure for each test case is as follows:\n$1$. Define the physical and model constants: $\\kappa, B, \\nu, k_0^+, \\alpha$.\n$2$. For a given test case $(U, y, k)$, construct the objective function $f(u_\\tau)$.\n$3$. Employ `scipy.optimize.root_scalar` with Brent's method and the aformentioned bracket to find the root $u_\\tau$ of $f(u_\\tau)=0$.\n$4$. Calculate the resulting non-dimensional roughness height $k^+ = k u_\\tau/\\nu$.\n$5$. Evaluate both $\\Delta U^+_{\\mathrm{model}}(k^+)$ and the piecewise function $\\Delta U^+_{\\mathrm{ref}}(k^+)$.\n$6$. Compute the absolute error $E$.\n$7$. Store the pair $(u_\\tau, E)$ and repeat for all test cases.\n$8$. Finally, format the collected results into a single comma-separated string as required.\n\nThis structured approach ensures a correct and robust solution to the posed problem, providing both the desired physical quantity, $u_\\tau$, and a quantitative assessment of the model's accuracy, $E$.",
            "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Computes the wall friction velocity u_tau and a validation error E\n    for a turbulent boundary layer over a rough wall using a wall-model.\n    \"\"\"\n\n    # --- Constants and Model Parameters ---\n    # von Kármán constant\n    KAPPA = 0.41\n    # Smooth-wall log-law intercept\n    B = 5.0\n    # Roughness model parameter (threshold)\n    K0_PLUS = 5.0\n    # Roughness model parameter\n    C = 3.5\n    ALPHA = np.exp(-KAPPA * C)\n\n    # --- Test Suite ---\n    # Each case is (rho, nu, U, y, k)\n    # rho [kg/m^3], nu [m^2/s], U [m/s], y [m], k [m]\n    test_cases = [\n        (1.225, 1.5e-5, 15.0, 1.0e-3, 0.0),      # Case 1: Smooth\n        (1.225, 1.5e-5, 20.0, 1.0e-3, 4.0e-4),   # Case 2: Transitional\n        (1.225, 1.5e-5, 30.0, 5.0e-3, 2.0e-3),   # Case 3: Fully rough\n        (1.225, 1.5e-5, 10.0, 1.0e-5, 2.0e-4),   # Case 4: Near-wall edge\n    ]\n\n    results = []\n\n    # --- Helper Functions for Roughness Shifts ---\n    def delta_u_plus_model(k_plus):\n        \"\"\"Calculates the model roughness function.\"\"\"\n        if k_plus = K0_PLUS:\n            return 0.0\n        return (1.0 / KAPPA) * np.log(1.0 + ALPHA * (k_plus - K0_PLUS))\n\n    def delta_u_plus_ref(k_plus):\n        \"\"\"Calculates the reference roughness function.\"\"\"\n        if k_plus = 5.0:\n            return 0.0\n        elif 5.0  k_plus  100.0:\n            return (1.0 / KAPPA) * np.log(1.0 + 0.26 * (k_plus - 5.0))\n        else:  # k_plus = 100.0\n            return (1.0 / KAPPA) * np.log(k_plus) - 3.5\n\n    # --- Main Calculation Loop ---\n    for case in test_cases:\n        rho, nu, U, y, k = case\n\n        # Define the nonlinear equation f(u_tau) = 0 to be solved.\n        # Arguments are passed via the lambda function's closure.\n        def objective_function(u_tau):\n            if u_tau = 0:\n                return np.inf\n            y_plus = y * u_tau / nu\n            k_plus = k * u_tau / nu\n            \n            # The log-law is only valid for y+ above the viscous sublayer,\n            # but the equation is well-behaved mathematically nonetheless.\n            if y_plus = 0:\n                 return np.inf\n\n            model_shift = delta_u_plus_model(k_plus)\n            \n            return (U / u_tau) - (1.0 / KAPPA) * np.log(y_plus) - B + model_shift\n\n        # Solve for u_tau using a robust root-finding algorithm (Brent's method).\n        # A bracket is chosen from a small positive number to U.\n        # Analysis confirms f(1e-6)  0 and f(U)  0 for these cases.\n        try:\n            sol = optimize.root_scalar(\n                objective_function,\n                bracket=[1e-6, U],\n                method='brentq'\n            )\n            u_tau = sol.root\n        except ValueError:\n            # Fallback for difficult cases, though not expected here.\n            # A simple search could be used if bracketing fails.\n            u_tau = np.nan\n            E = np.nan\n            results.extend([u_tau, E])\n            continue\n\n        # Calculate k+ with the solved u_tau\n        k_plus_final = k * u_tau / nu\n\n        # Compute the model and reference shifts at the final k+\n        model_shift_final = delta_u_plus_model(k_plus_final)\n        ref_shift_final = delta_u_plus_ref(k_plus_final)\n\n        # Compute the absolute validation error\n        E = abs(model_shift_final - ref_shift_final)\n\n        results.extend([u_tau, E])\n\n    # Format the final output string exactly as specified.\n    print(f\"[{','.join(f'{val:.8f}' for val in results)}]\")\n\nsolve()\n```"
        }
    ]
}