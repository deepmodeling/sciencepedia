{
    "hands_on_practices": [
        {
            "introduction": "要理解湍流，我们必须首先了解其尺度范围的边界。能量串级模型描述了能量从大尺度向小尺度传递的过程，但这个过程在哪里结束呢？本练习将运用量纲分析这一强大工具，推导在黏性力起主导作用并将能量耗散为热量的基本尺度——即长度、时间和速度尺度。这些由 Andrey Kolmogorov 首先提出的尺度  是湍流理论的基石，对任何湍流模型都至关重要。",
            "id": "4001693",
            "problem": "在计算流体动力学 (CFD) 中，高雷诺数湍流剪切流表现出一种能量级串现象，该现象将动能从注入能量的大尺度输运至被黏性耗散能量的小尺度。在足够小尺度下局部各向同性的假设下，假定控制最小运动尺度的唯一参数是单位质量的湍动能耗散率（记为 $\\epsilon$）和运动黏度（记为 $\\nu$）。利用基于不可压缩Navier–Stokes方程的量纲齐次性和单位质量耗散率定义的量纲一致性，确定特征Kolmogorov长度尺度 $\\eta$、时间尺度 $\\tau_{\\eta}$ 和速度尺度 $u_{\\eta}$ 作为 $\\nu$ 和 $\\epsilon$ 的幂的乘积的唯一表达式（差一个纯数值常数）。你的最终答案必须是每个尺度关于 $\\epsilon$ 和 $\\nu$ 的闭式解析表达式。不要引入经验常数或任何其他参数。不需要进行数值计算，也无需四舍五入。",
            "solution": "对问题陈述进行严格审查后，确认其有效。该问题提出了一个源于湍流理论基本原理（特别是Kolmogorov 1941年的假设）的、适定的、有科学依据的问题。该问题是自洽的，提供了通过量纲分析得出唯一解所需的所有参数和约束。\n\n目标是确定湍流中最小涡（称为Kolmogorov尺度）的长度、时间和速度的特征尺度。问题假定这些尺度仅取决于运动黏度 $\\nu$ 和单位质量的平均湍动能耗散率 $\\epsilon$。推导过程将通过强制执行量纲齐次性来进行。\n\n首先，我们确定控制参数的物理量纲。令 $[L]$ 表示长度量纲，$[T]$ 表示时间量纲，$[M]$ 表示质量量纲。\n\n运动黏度 $\\nu$ 定义为动力黏度与密度的比值。其标准单位是平方米/秒 ($m^2/s$)。因此，其量纲为：\n$$[\\nu] = [L]^2 [T]^{-1}$$\n\n单位质量湍动能耗散率 $\\epsilon$ 的单位是能量/（单位时间·单位质量）。能量的量纲是质量乘以速度的平方 ($[M]([L]/[T])^2 = [M][L]^2[T]^{-2}$)。因此，单位质量的能量的量纲是 $[L]^2[T]^{-2}$。单位质量的耗散率是单位质量的能量除以时间，从而得出其量纲为：\n$$[\\epsilon] = \\frac{[L]^2 [T]^{-2}}{[T]} = [L]^2 [T]^{-3}$$\n\n在确定了控制参数的量纲之后，我们可以通过假设Kolmogorov尺度与 $\\nu$ 和 $\\epsilon$ 的幂的乘积成正比，来推导其表达式。\n\n**1. Kolmogorov长度尺度 ($\\eta$)**\nKolmogorov长度尺度 $\\eta$ 必须具有长度量纲 $[L]$。我们假设其关系式形式如下：\n$$\\eta \\propto \\nu^a \\epsilon^b$$\n其中 $a$ 和 $b$ 是待定的无量纲指数。用量纲表示，该关系式为：\n$$[L]^1 = ([\\nu])^a ([\\epsilon])^b = ([L]^2 [T]^{-1})^a ([L]^2 [T]^{-3})^b$$\n$$[L]^1 [T]^0 = [L]^{2a} [T]^{-a} [L]^{2b} [T]^{-3b} = [L]^{2a+2b} [T]^{-a-3b}$$\n为使量纲齐次性成立，方程两边各基本量纲的指数必须相等。由此可得关于 $a$ 和 $b$ 的一个二元线性方程组：\n\\begin{enumerate}\n    \\item 对于量纲 $[L]$: $1 = 2a + 2b$\n    \\item 对于量纲 $[T]$: $0 = -a - 3b$\n\\end{enumerate}\n从第二个方程，我们得到 $a = -3b$。将其代入第一个方程：\n$$1 = 2(-3b) + 2b = -6b + 2b = -4b$$\n这得到 $b = -1/4$。因此，$a = -3(-1/4) = 3/4$。\n因此，Kolmogorov长度尺度与 $\\nu^{3/4}\\epsilon^{-1/4}$ 成正比。$\\eta$ 的表达式为：\n$$\\eta = \\left(\\frac{\\nu^3}{\\epsilon}\\right)^{1/4}$$\n\n**2. Kolmogorov时间尺度 ($\\tau_{\\eta}$)**\nKolmogorov时间尺度 $\\tau_{\\eta}$ 必须具有时间量纲 $[T]$。我们假设其关系式形式如下：\n$$\\tau_{\\eta} \\propto \\nu^c \\epsilon^d$$\n量纲方程为：\n$$[T]^1 = ([\\nu])^c ([\\epsilon])^d = ([L]^2 [T]^{-1})^c ([L]^2 [T]^{-3})^d$$\n$$[L]^0 [T]^1 = [L]^{2c+2d} [T]^{-c-3d}$$\n令各量纲的指数相等：\n\\begin{enumerate}\n    \\item 对于量纲 $[L]$: $0 = 2c + 2d \\implies c = -d$\n    \\item 对于量纲 $[T]$: $1 = -c - 3d$\n\\end{enumerate}\n将 $c = -d$ 代入第二个方程：\n$$1 = -(-d) - 3d = d - 3d = -2d$$\n这得到 $d = -1/2$。因此，$c = -(-1/2) = 1/2$。\n因此，Kolmogorov时间尺度与 $\\nu^{1/2}\\epsilon^{-1/2}$ 成正比。$\\tau_{\\eta}$ 的表达式为：\n$$\\tau_{\\eta} = \\left(\\frac{\\nu}{\\epsilon}\\right)^{1/2}$$\n\n**3. Kolmogorov速度尺度 ($u_{\\eta}$)**\nKolmogorov速度尺度 $u_{\\eta}$ 必须具有速度量纲 $[L][T]^{-1}$。我们假设其关系式形式如下：\n$$u_{\\eta} \\propto \\nu^f \\epsilon^g$$\n量纲方程为：\n$$[L]^1 [T]^{-1} = ([\\nu])^f ([\\epsilon])^g = ([L]^2 [T]^{-1})^f ([L]^2 [T]^{-3})^g$$\n$$[L]^1 [T]^{-1} = [L]^{2f+2g} [T]^{-f-3g}$$\n令指数相等：\n\\begin{enumerate}\n    \\item 对于量纲 $[L]$: $1 = 2f + 2g$\n    \\item 对于量纲 $[T]$: $-1 = -f - 3g$\n\\end{enumerate}\n从第一个方程，得到 $f = (1 - 2g)/2$。将其代入第二个方程：\n$$-1 = -\\left(\\frac{1 - 2g}{2}\\right) - 3g = -\\frac{1}{2} + g - 3g = -\\frac{1}{2} - 2g$$\n$$-1 + \\frac{1}{2} = -2g \\implies -\\frac{1}{2} = -2g$$\n这得到 $g = 1/4$。因此，$f = (1 - 2(1/4))/2 = (1 - 1/2)/2 = (1/2)/2 = 1/4$。\n因此，Kolmogorov速度尺度与 $\\nu^{1/4}\\epsilon^{1/4}$ 成正比。$u_{\\eta}$ 的表达式为：\n$$u_{\\eta} = (\\nu\\epsilon)^{1/4}$$\n\n推导出的 $\\eta$、$\\tau_{\\eta}$ 和 $u_{\\eta}$ 的表达式，在相差一个数量级为1的无量纲常数的情况下是唯一的，这符合问题陈述的要求。这些是表征湍流耗散区的基本尺度。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left(\\frac{\\nu^3}{\\epsilon}\\right)^{\\frac{1}{4}} & \\left(\\frac{\\nu}{\\epsilon}\\right)^{\\frac{1}{2}} & (\\nu \\epsilon)^{\\frac{1}{4}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "能量耗散率 $\\epsilon$ 是湍流理论中的一个核心参数，但直接测量它却异常困难。本练习将展示，在各向同性湍流的假设下，我们如何推导出一个精确关系，将 $\\epsilon$ 与更易于测量的物理量——脉动速度的均方根 $u'$ 和泰勒微尺度 $\\lambda$——联系起来 。这个推导为理论模型和实验验证之间提供了一条至关重要的纽带，使我们能够根据真实的流动测量数据来估算耗散率。",
            "id": "4001685",
            "problem": "考虑一个与计算流体力学(CFD)中基于测量的模型验证相关的均匀、各向同性、不可压缩的湍流。设沿某一固定方向的纵向速度脉动分量表示为 $u(x,t)$，并设其均方根(RMS)值 $u'$ 定义为 $u' = \\sqrt{\\langle u^{2} \\rangle}$，其中尖括号表示统计定常态下的系综平均。运动粘度为 $\\nu$。泰勒微尺度 $\\lambda$ 是通过纵向两点相关函数 $R_{LL}(r) = \\langle u(x) u(x+r) \\rangle$ 在零间距处的曲率来定义的，其二阶展开式在 $r \\to 0$ 时为 $R_{LL}(r) = u'^{2}\\left(1 - \\frac{r^{2}}{2 \\lambda^{2}} + \\dots \\right)$。从不可压缩的纳维-斯托克斯方程和单位质量平均动能耗散率的定义出发，\n$$\n\\epsilon = 2 \\nu \\langle s_{ij} s_{ij} \\rangle, \\quad s_{ij} = \\frac{1}{2}\\left( \\frac{\\partial u_{i}}{\\partial x_{j}} + \\frac{\\partial u_{j}}{\\partial x_{i}} \\right),\n$$\n利用速度梯度场的均匀性和各向同性，将 $\\epsilon$ 用一维纵向速度导数的方差表示，然后通过泰勒微尺度的定义将该导数方差与 $u'$ 和 $\\lambda$ 联系起来。推导一个仅用 $u'$、$\\lambda$ 和 $\\nu$ 表示的 $\\epsilon$ 的解析表达式。将最终的 $\\epsilon$ 以国际单位制(SI)表示为 $\\mathrm{m}^{2}/\\mathrm{s}^{3}$。无需进行数值计算；请给出一个单一的闭式表达式作为最终答案。",
            "solution": "我们从不可压缩的纳维-斯托克斯动量方程及其相关的动能平衡方程开始。对于统计定常、均匀、各向同性、不可压缩的湍流，单位质量的平均动能耗散率定义为\n$$\n\\epsilon = 2 \\nu \\langle s_{ij} s_{ij} \\rangle, \\quad s_{ij} = \\frac{1}{2}\\left( \\frac{\\partial u_{i}}{\\partial x_{j}} + \\frac{\\partial u_{j}}{\\partial x_{i}} \\right),\n$$\n其中 $\\nu$ 是运动粘度，$s_{ij}$ 是对称应变率张量，$u_{i}$ 是第 $i$ 个速度分量，$x_{j}$ 是第 $j$ 个坐标。该流动是不可压缩的，因此 $\\partial u_{k}/\\partial x_{k} = 0$。\n\n利用速度梯度张量的各向同性，可以将量 $\\epsilon$ 与一维速度导数联系起来。考虑全梯度张量 $\\partial u_{i}/\\partial x_{j}$ 并将其分解为对称和反对称部分：\n$$\n\\frac{\\partial u_{i}}{\\partial x_{j}} = s_{ij} + a_{ij}, \\quad a_{ij} = \\frac{1}{2}\\left( \\frac{\\partial u_{i}}{\\partial x_{j}} - \\frac{\\partial u_{j}}{\\partial x_{i}} \\right).\n$$\n在各向同性的不可压缩流中，梯度张量的统计特性在旋转下是不变的，唯一允许的四阶各向同性张量是由克罗内克δ构建的。这些约束意味着不同梯度分量的方差之间存在固定的比率。特别地，在均匀各向同性湍流中，一个重要的恒等式是应变率的均方值与任何单个纵向速度导数的均方值成正比。我们可以将所有九个速度梯度的平方和写为\n$$\n\\left\\langle \\frac{\\partial u_{i}}{\\partial x_{j}} \\frac{\\partial u_{i}}{\\partial x_{j}} \\right\\rangle\n= \\left\\langle s_{ij} s_{ij} \\right\\rangle + \\left\\langle a_{ij} a_{ij} \\right\\rangle.\n$$\n利用不可压缩条件和各向同性，可以得到精确的恒等式\n$$\n\\epsilon = 15 \\nu \\left\\langle \\left( \\frac{\\partial u}{\\partial x} \\right)^{2} \\right\\rangle,\n$$\n其中 $u$ 表示沿任意固定方向的速度纵向分量，$x$ 是该方向上的坐标。该恒等式表明，耗散与一维纵向导数方差成正比，比例因子为 $15 \\nu$。它可以通过由 $\\delta_{ik}\\delta_{jl}$、$\\delta_{il}\\delta_{jk}$ 和 $\\delta_{ij}\\delta_{kl}$ 的组合构造各向同性四阶张量 $\\left\\langle \\partial u_{i}/\\partial x_{j} \\, \\partial u_{k}/\\partial x_{l} \\right\\rangle$，然后施加不可压缩性和对称/反对称约束来求解系数并消除交叉项，从而得出因子15。\n\n接下来，我们通过泰勒微尺度的定义将 $\\left\\langle (\\partial u/\\partial x)^{2} \\right\\rangle$ 与 $u'$ 和 $\\lambda$ 联系起来。定义纵向两点相关函数\n$$\nR_{LL}(r) = \\left\\langle u(x) u(x+r) \\right\\rangle.\n$$\n根据均匀性，对 $r$ 的微分可以移到平均值内部。一阶导数为\n$$\n\\frac{\\mathrm{d} R_{LL}}{\\mathrm{d} r}(r) = \\left\\langle u(x) \\frac{\\partial u}{\\partial x}(x+r) \\right\\rangle.\n$$\n在 $r=0$ 时，统计定常性和均匀性意味着 $\\left\\langle u \\, \\partial u/\\partial x \\right\\rangle = 0$，因此 $\\mathrm{d} R_{LL}/\\mathrm{d} r \\big|_{r=0} = 0$。二阶导数为\n$$\n\\frac{\\mathrm{d}^{2} R_{LL}}{\\mathrm{d} r^{2}}(r) = \\left\\langle u(x) \\frac{\\partial^{2} u}{\\partial x^{2}}(x+r) \\right\\rangle.\n$$\n在 $r=0$ 处求值，并在系综平均下进行分部积分（或等效地使用导数的均匀性），我们发现\n$$\n\\frac{\\mathrm{d}^{2} R_{LL}}{\\mathrm{d} r^{2}}(0) = - \\left\\langle \\left( \\frac{\\partial u}{\\partial x} \\right)^{2} \\right\\rangle.\n$$\n另一方面，根据泰勒微尺度的定义，小 $r$ 展开式为\n$$\nR_{LL}(r) = u'^{2} \\left( 1 - \\frac{r^{2}}{2 \\lambda^{2}} + \\dots \\right),\n$$\n因此\n$$\n\\frac{\\mathrm{d}^{2} R_{LL}}{\\mathrm{d} r^{2}}(0) = - \\frac{u'^{2}}{\\lambda^{2}}.\n$$\n令 $\\mathrm{d}^{2} R_{LL}/\\mathrm{d} r^{2}(0)$ 的两个表达式相等，得到\n$$\n\\left\\langle \\left( \\frac{\\partial u}{\\partial x} \\right)^{2} \\right\\rangle = \\frac{u'^{2}}{\\lambda^{2}}.\n$$\n将此结果与各向同性耗散恒等式结合，得到\n$$\n\\epsilon = 15 \\nu \\left\\langle \\left( \\frac{\\partial u}{\\partial x} \\right)^{2} \\right\\rangle = 15 \\nu \\frac{u'^{2}}{\\lambda^{2}}.\n$$\n这是一个用 $u'$、$\\lambda$ 和 $\\nu$ 表示的解析表达式，其单位为 $\\mathrm{m}^{2}/\\mathrm{s}^{3}$（因为 $\\nu$ 的单位是 $\\mathrm{m}^{2}/\\mathrm{s}$，而 $u'^{2}/\\lambda^{2}$ 的单位是 $\\mathrm{s}^{-2}$）。",
            "answer": "$$\\boxed{15\\,\\nu\\,\\frac{u'^{2}}{\\lambda^{2}}}$$"
        },
        {
            "introduction": "现在，我们将从理想化的各向同性湍流转向一个更贴近实际的工程场景：湍流槽道流，这是航空航天CFD中的一个经典案例。这项计算练习要求您实现一个简化的 Smagorinsky 大涡模拟 (LES) 模型，用以分析湍动能生成项 ($P$) 与耗散项 ($\\epsilon$) 之间的平衡关系 。通过计算并解读 $P/\\epsilon$ 的比值，您将亲身体验局部平衡的概念，并理解在靠近固体边界的非均匀流中，这种平衡是如何被打破的。",
            "id": "4001662",
            "problem": "考虑一个具有恒定密度的牛顿流体的统计定常不可压缩湍流槽道流。半槽道高度为 $h$，摩擦速度为 $u_\\tau$，运动粘度为 $\\nu$。在大涡模拟（LES）中，使用 Smagorinsky 亚格子模型，亚格子涡粘度被建模为 $\\nu_t = (C_s \\Delta)^2 \\lvert S \\rvert$，其中 $C_s$ 是 Smagorinsky 常数，$\\Delta$ 是滤波宽度，解析尺度应变率张量的模 $\\lvert S \\rvert$ 定义为 $\\lvert S \\rvert = \\sqrt{2 S_{ij} S_{ij}}$。对于一个仅有平均速度 $U(y)$ 和平均剪切的平面槽道流，其非零应变率分量为 $S_{12} = S_{21} = \\frac{1}{2} \\frac{dU}{dy}$，因此 $S_{ij} S_{ij} = \\frac{1}{2} \\left( \\frac{dU}{dy} \\right)^2$ 且 $\\lvert S \\rvert = \\left\\lvert \\frac{dU}{dy} \\right\\rvert$。\n\n对于充分发展的槽道流，精确的平均流向动量平衡表明，总剪切应力随壁面法向位置 $y$ 呈线性变化，\n$$\n\\tau_\\text{tot}(y) = \\rho u_\\tau^2 \\left( 1 - \\frac{y}{h} \\right),\n$$\n其中 $\\rho$ 是流体密度，$\\tau_\\text{tot}(y) = \\mu \\frac{dU}{dy} - \\rho \\langle u' v' \\rangle$，其中 $\\mu = \\rho \\nu$ 且 $- \\langle u' v' \\rangle$ 是雷诺剪切应力。在涡粘性 LES 封闭模型中，可以将湍流剪切应力写作 $- \\langle u' v' \\rangle \\approx \\nu_t \\frac{dU}{dy}$，因此总剪切应力变为 $\\tau_\\text{tot}(y) \\approx \\rho (\\nu + \\nu_t) \\frac{dU}{dy}$。\n\n定义单位质量的湍动能生成项为\n$$\nP(y) = - \\langle u' v' \\rangle \\frac{dU}{dy},\n$$\n总耗散项（单位质量）定义为解析尺度和亚格子尺度贡献的总和，\n$$\n\\epsilon(y) = 2 \\nu \\langle S_{ij} S_{ij} \\rangle + 2 \\nu_t \\langle S_{ij} S_{ij} \\rangle.\n$$\n在上述仅有平均剪切的近似下，这可简化为\n$$\n\\epsilon(y) = \\left( \\nu + \\nu_t \\right) \\left( \\frac{dU}{dy} \\right)^2.\n$$\n\n您的任务是仅使用上述基本关系式，计算在指定的壁面法向位置上 $P(y)/\\epsilon(y)$ 的比值分布。为确保科学真实性，通过求解代数方程，从精确的平均动量平衡和 Smagorinsky 模型中计算平均剪切 $\\frac{dU}{dy}$\n$$\n\\left( \\nu + (C_s \\Delta)^2 \\left\\lvert \\frac{dU}{dy} \\right\\rvert \\right) \\frac{dU}{dy} = u_\\tau^2 \\left( 1 - \\frac{y}{h} \\right).\n$$\n限定在下半槽道 $0 \\le y \\le h$ 内，其中 $\\frac{dU}{dy} \\ge 0$。然后计算 $\\nu_t = (C_s \\Delta)^2 \\frac{dU}{dy}$，生成项 $P(y) = \\nu_t \\left( \\frac{dU}{dy} \\right)^2$，耗散项 $\\epsilon(y) = \\left( \\nu + \\nu_t \\right) \\left( \\frac{dU}{dy} \\right)^2$，最后计算 $P(y)/\\epsilon(y) = \\nu_t / (\\nu + \\nu_t)$。尽管该比值为无量纲，但请根据湍动能收支中的非局部输运和非均匀性，来解释在近壁处和外层区域与 1 的偏差。\n\n使用壁面单位来选择采样位置：定义摩擦雷诺数 $Re_\\tau = \\frac{u_\\tau h}{\\nu}$ 和壁面单位 $y^+ = \\frac{y u_\\tau}{\\nu}$。对于每个测试用例，在下半槽道中对应于 $y^+ \\in \\{5, 30, 100, 0.9 Re_\\tau, 0.999 Re_\\tau\\}$ 的五个点上评估 $P/\\epsilon$，这些点的位置从粘性子层、对数层一直到外层并接近中心线。将最终结果表示为无量纲浮点数。\n\n您必须将此计算实现为一个完整的、可运行的程序。您的程序必须使用下面的参数集作为测试套件，为每个参数集计算指定 $y^+$ 点上所需的 $P/\\epsilon$ 值，并生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，每个元素是对应一个测试用例的五个浮点数列表，顺序与测试用例相同。\n\n测试套件参数集（在适用情况下使用物理单位）：\n- 用例 1（理想情况，中等 $Re_\\tau$，细网格滤波）：$h = 0.05$ m，$\\nu = 1.5 \\times 10^{-5}$ m$^2$/s，$C_s = 0.17$，$\\Delta/h = 0.02$，$Re_\\tau = 180$。\n- 用例 2（更大的滤波宽度）：$h = 0.05$ m，$\\nu = 1.5 \\times 10^{-5}$ m$^2$/s，$C_s = 0.17$，$\\Delta/h = 0.10$，$Re_\\tau = 180$。\n- 用例 3（更高的 $Re_\\tau$，更小的 $C_s$）：$h = 0.05$ m，$\\nu = 1.5 \\times 10^{-5}$ m$^2$/s，$C_s = 0.12$，$\\Delta/h = 0.02$，$Re_\\tau = 550$。\n- 用例 4（更高的 $Re_\\tau$，典型的 $C_s$）：$h = 0.05$ m，$\\nu = 1.5 \\times 10^{-5}$ m$^2$/s，$C_s = 0.17$，$\\Delta/h = 0.02$，$Re_\\tau = 550$。\n\n对于每个用例，计算 $u_\\tau = \\frac{Re_\\tau \\nu}{h}$ 和 $\\Delta = (\\Delta/h) \\, h$。然后，通过首先将 $y^+$ 转换为 $y/h$（通过 $y/h = y^+ / Re_\\tau$）来计算指定 $y^+$ 点的 $P/\\epsilon$。\n\n最终输出格式要求：\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，第 $i$ 个元素是第 $i$ 个测试用例的五个计算出的 $P/\\epsilon$ 值的列表，按上述规定排序。例如，输出应类似于“[[v11,v12,v13,v14,v15],[v21,v22,v23,v24,v25],...]”，其中每个 $v_{ij}$ 都是一个浮点数。",
            "solution": "当前任务是计算湍流槽道流中几个壁面法向位置 $y$ 处的湍动能生成项 $P(y)$ 与总耗散项 $\\epsilon(y)$ 的比值。分析是在使用 Smagorinsky 亚格子尺度模型的大涡模拟（LES）框架内进行的。\n\n分析的基础是针对充分发展、统计定常、不可压缩槽道流的精确平均流向动量平衡。该平衡决定了总剪切应力 $\\tau_{\\text{tot}}$ 在半槽道高度 $h$ 上呈线性变化：\n$$\n\\frac{\\tau_{\\text{tot}}(y)}{\\rho} = u_\\tau^2 \\left( 1 - \\frac{y}{h} \\right)\n$$\n其中 $\\rho$ 是恒定的流体密度，$u_\\tau$ 是摩擦速度。总应力由粘性贡献 $\\tau_{\\text{visc}} = \\mu \\frac{dU}{dy}$ 和湍流（雷诺）贡献 $\\tau_{\\text{turb}} = -\\rho \\langle u' v' \\rangle$ 组成。此处，$\\mu = \\rho\\nu$ 是动力粘度（$\\nu$ 是运动粘度），$\\frac{dU}{dy}$ 是平均速度梯度，$-\\langle u' v' \\rangle$ 是雷诺剪切应力。\n\n在 LES 的背景下，雷诺应力需要被建模。使用涡粘性假设，建模的剪切应力由 $-\\langle u' v' \\rangle \\approx \\nu_t \\frac{dU}{dy}$ 给出，其中 $\\nu_t$ 是亚格子尺度（或湍流）涡粘度。结合粘性应力和建模的湍流应力，总应力近似为：\n$$\n\\frac{\\tau_{\\text{tot}}(y)}{\\rho} \\approx (\\nu + \\nu_t) \\frac{dU}{dy}\n$$\n将精确动量平衡与建模的应力表达式相等，得到平均速度梯度的控制方程：\n$$\n(\\nu + \\nu_t) \\frac{dU}{dy} = u_\\tau^2 \\left( 1 - \\frac{y}{h} \\right)\n$$\n问题指定了涡粘度的 Smagorinsky 模型，$\\nu_t = (C_s \\Delta)^2 \\lvert S \\rvert$，其中 $C_s$ 是 Smagorinsky 常数，$\\Delta$ 是滤波宽度，$\\lvert S \\rvert$ 是解析尺度应变率张量的模。对于一维平均流 $U(y)$ 的简化情况，该模简化为 $\\lvert S \\rvert = \\left\\lvert \\frac{dU}{dy} \\right\\rvert$。对于槽道的下半部分 $y \\in [0, h]$，物理速度剖面要求 $\\frac{dU}{dy} \\ge 0$。因此，我们可以写成 $\\nu_t = (C_s \\Delta)^2 \\frac{dU}{dy}$。\n\n将 $\\nu_t$ 的这个表达式代入应力平衡方程，得到：\n$$\n\\left( \\nu + (C_s \\Delta)^2 \\frac{dU}{dy} \\right) \\frac{dU}{dy} = u_\\tau^2 \\left( 1 - \\frac{y}{h} \\right)\n$$\n让我们引入简写 $S = \\frac{dU}{dy}$ 来表示非负的平均剪切。该方程变为一个关于 $S$ 的二次方程：\n$$\n(C_s \\Delta)^2 S^2 + \\nu S - u_\\tau^2 \\left( 1 - \\frac{y}{h} \\right) = 0\n$$\n这是一个标准二次方程，形式为 $aS^2 + bS + c = 0$，其系数为 $a = (C_s \\Delta)^2$，$b = \\nu$ 和 $c = -u_\\tau^2(1 - y/h)$。对于 $S$ 来说，具有物理意义的解必须是非负的。二次公式给出：\n$$\nS = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} = \\frac{-\\nu \\pm \\sqrt{\\nu^2 + 4(C_s \\Delta)^2 u_\\tau^2 \\left(1 - \\frac{y}{h}\\right)}}{2(C_s \\Delta)^2}\n$$\n由于 $\\nu > 0$，$(C_s \\Delta)^2 > 0$，并且对于 $y \\le h$，平方根下的项大于 $\\nu^2$。为确保 $S \\ge 0$，我们必须选择正根：\n$$\nS(y) = \\frac{dU}{dy} = \\frac{-\\nu + \\sqrt{\\nu^2 + 4(C_s \\Delta)^2 u_\\tau^2 \\left(1 - \\frac{y}{h}\\right)}}{2(C_s \\Delta)^2}\n$$\n这为任意位置 $y$ 处的平均剪切提供了直接的解析表达式。\n\n我们感兴趣的量是单位质量的湍动能生成项 $P(y)$ 和单位质量的总耗散项 $\\epsilon(y)$。根据问题定义和建模假设，它们是：\n$$\nP(y) = -\\langle u' v' \\rangle \\frac{dU}{dy} \\approx \\nu_t \\left( \\frac{dU}{dy} \\right)^2\n$$\n$$\n\\epsilon(y) = (\\nu + \\nu_t) \\left( \\frac{dU}{dy} \\right)^2\n$$\n因此，所求的比值为：\n$$\n\\frac{P(y)}{\\epsilon(y)} = \\frac{\\nu_t \\left( \\frac{dU}{dy} \\right)^2}{(\\nu + \\nu_t) \\left( \\frac{dU}{dy} \\right)^2} = \\frac{\\nu_t}{\\nu + \\nu_t}\n$$\n该比值表示由亚格子尺度模型处理的总耗散部分。值为 1 表示一种局部平衡状态，此时建模的生成项完全平衡了建模的耗散项，这是许多简单湍流模型中的一个关键假设。在实际流动中，与 1 的偏差表明存在一种不平衡，这种不平衡由完整湍动能收支中的其他项（如输运和扩散）来补偿，这些项在非均匀区域（如近壁层）中尤为重要。\n\n每个测试用例的计算步骤如下：\n$1$. 对于给定的参数为 $h$、$\\nu$、$C_s$、$\\Delta/h$ 和 $Re_\\tau$ 的测试用例，首先计算导出的物理量：\n    - 摩擦速度：$u_\\tau = \\frac{Re_\\tau \\nu}{h}$\n    - 滤波宽度：$\\Delta = (\\Delta/h) h$\n$2$. 对于每个指定的壁面单位位置 $y^+ \\in \\{5, 30, 100, 0.9 Re_\\tau, 0.999 Re_\\tau\\}$：\n    - 将 $y^+$ 转换为无量纲壁面法向坐标 $y/h$：\n      $$\n      \\frac{y}{h} = \\frac{y^+ \\nu}{u_\\tau} \\frac{1}{h} = \\frac{y^+}{Re_\\tau}\n      $$\n    - 使用上面导出的解析解计算平均剪切 $S = \\frac{dU}{dy}$。\n    - 计算涡粘度 $\\nu_t = (C_s \\Delta)^2 S$。\n    - 计算最终比值 $P/\\epsilon = \\frac{\\nu_t}{\\nu + \\nu_t}$。\n$3$. 将每个测试用例的五个计算比值收集到一个列表中。\n$4$. 最终输出将是一个列表，其中包含所有四个测试用例的结果列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ratio of turbulent kinetic energy production to total dissipation\n    at specified wall-normal locations for a turbulent channel flow using the\n    Smagorinsky LES model.\n    \"\"\"\n\n    # Test suite parameter sets\n    test_cases = [\n        {\n            \"name\": \"Case 1\",\n            \"h\": 0.05,  # m\n            \"nu\": 1.5e-5,  # m^2/s\n            \"Cs\": 0.17,\n            \"Delta_h_ratio\": 0.02,\n            \"Re_tau\": 180.0\n        },\n        {\n            \"name\": \"Case 2\",\n            \"h\": 0.05,  # m\n            \"nu\": 1.5e-5,  # m^2/s\n            \"Cs\": 0.17,\n            \"Delta_h_ratio\": 0.10,\n            \"Re_tau\": 180.0\n        },\n        {\n            \"name\": \"Case 3\",\n            \"h\": 0.05,  # m\n            \"nu\": 1.5e-5,  # m^2/s\n            \"Cs\": 0.12,\n            \"Delta_h_ratio\": 0.02,\n            \"Re_tau\": 550.0\n        },\n        {\n            \"name\": \"Case 4\",\n            \"h\": 0.05,  # m\n            \"nu\": 1.5e-5,  # m^2/s\n            \"Cs\": 0.17,\n            \"Delta_h_ratio\": 0.02,\n            \"Re_tau\": 550.0\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        h = case[\"h\"]\n        nu = case[\"nu\"]\n        Cs = case[\"Cs\"]\n        Delta_h_ratio = case[\"Delta_h_ratio\"]\n        Re_tau = case[\"Re_tau\"]\n\n        # 1. Compute derived physical quantities\n        u_tau = (Re_tau * nu) / h\n        Delta = Delta_h_ratio * h\n        \n        # Pre-compute constants for the quadratic equation\n        Cs_Delta_sq = (Cs * Delta)**2\n        u_tau_sq = u_tau**2\n        \n        # 2. Define sampling points in wall units\n        y_plus_points = [5.0, 30.0, 100.0, 0.9 * Re_tau, 0.999 * Re_tau]\n        \n        case_results = []\n        for y_plus in y_plus_points:\n            # Convert y+ to y/h\n            y_h_ratio = y_plus / Re_tau\n            \n            # Right-hand side of the momentum balance equation\n            rhs = u_tau_sq * (1.0 - y_h_ratio)\n            \n            # Solve the quadratic equation for S = dU/dy\n            # (Cs_Delta_sq) * S^2 + nu * S - rhs = 0\n            a = Cs_Delta_sq\n            b = nu\n            c = -rhs\n            \n            # Use the non-negative root\n            discriminant = b**2 - 4 * a * c\n            S = (-b + np.sqrt(discriminant)) / (2 * a)\n            \n            # Calculate eddy viscosity\n            nu_t = Cs_Delta_sq * S\n            \n            # Calculate the production-to-dissipation ratio\n            ratio = nu_t / (nu + nu_t)\n            \n            case_results.append(ratio)\n        \n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The default str() for a list produces the required '[v1, v2, ...]' format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}