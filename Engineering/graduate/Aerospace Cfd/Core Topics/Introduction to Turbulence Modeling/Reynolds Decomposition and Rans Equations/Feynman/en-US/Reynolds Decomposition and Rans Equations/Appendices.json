{
    "hands_on_practices": [
        {
            "introduction": "Applying the general Reynolds-Averaged Navier-Stokes (RANS) equations to specific engineering problems often begins with simplification. This exercise guides you through the analysis of a canonical turbulent channel flow, a fundamental case in wall-bounded turbulence. By systematically applying the assumptions of a statistically steady and fully developed flow, you will derive the essential stress balance that governs the mean velocity profile, providing a foundational understanding of the interplay between pressure gradients and shear stresses. ",
            "id": "3990782",
            "problem": "Consider a statistically steady, incompressible, fully developed turbulent plane channel flow of a Newtonian fluid with constant dynamic viscosity $\\mu$ and density $\\rho$. The channel has one solid wall at $y=0$ and a symmetry plane at $y=h$ (half-channel formulation). Let the streamwise, wall-normal, and spanwise coordinates be $x$, $y$, and $z$, respectively. The mean velocity field is $\\overline{\\boldsymbol{u}} = (U(y), 0, 0)$ and the mean pressure is $\\overline{p}(x)$. The wall shear stress (mean) at $y=0$ is denoted $\\tau_{w} > 0$, which is the stress exerted by the fluid on the wall. This canonical setup is widely used in Computational Fluid Dynamics (CFD) to assess closure models for the Reynolds-Averaged Navier-Stokes (RANS) equations.\n\nStarting from the incompressible Navier–Stokes equations and using Reynolds decomposition, time averaging, and the incompressibility constraint, derive the streamwise component of the Reynolds-Averaged Navier–Stokes (RANS) momentum equation appropriate for this canonical flow. Carefully identify the origin and physical meaning of the additional term that arises from averaging the nonlinear convective acceleration. Using symmetry at $y=h$ for the fully developed channel (i.e., mean shear and mean Reynolds shear stress vanish at the symmetry plane), and the definition of $\\tau_{w}$ at the wall, reduce the resulting RANS momentum balance to a first-order ordinary differential equation in $y$ and integrate it.\n\nYour goal is to deduce a closed-form analytic expression for the constant mean streamwise pressure gradient $\\frac{\\partial \\overline{p}}{\\partial x}$ in terms of the wall shear stress $\\tau_{w}$ and the half-channel height $h$. Provide the final expression only. No numerical evaluation or rounding is required, and no physical units need be reported in the final expression.",
            "solution": "The starting point is the incompressible Navier–Stokes equations for a Newtonian fluid,\n$$\n\\frac{\\partial u_{i}}{\\partial x_{i}} = 0, \\qquad\n\\rho\\left(\\frac{\\partial u_{i}}{\\partial t} + u_{j}\\frac{\\partial u_{i}}{\\partial x_{j}}\\right) = -\\frac{\\partial p}{\\partial x_{i}} + \\mu \\frac{\\partial^{2} u_{i}}{\\partial x_{j}\\partial x_{j}}.\n$$\nWe perform the Reynolds decomposition, writing each flow variable as a mean plus a fluctuation:\n$$\nu_{i} = \\overline{u}_{i} + u_{i}', \\qquad p = \\overline{p} + p',\n$$\nand define the average (overbar) as a suitable time average under the assumption of statistical stationarity. For incompressible flow, averaging preserves the divergence-free constraint:\n$$\n\\frac{\\partial \\overline{u}_{i}}{\\partial x_{i}} = 0.\n$$\nAveraging the momentum equation and using linearity of differentiation yields\n$$\n\\rho\\left(\\frac{\\partial \\overline{u}_{i}}{\\partial t} + \\overline{u}_{j}\\frac{\\partial \\overline{u}_{i}}{\\partial x_{j}} + \\frac{\\partial \\overline{u_{i}' u_{j}'}}{\\partial x_{j}}\\right) = -\\frac{\\partial \\overline{p}}{\\partial x_{i}} + \\mu \\frac{\\partial^{2} \\overline{u}_{i}}{\\partial x_{j}\\partial x_{j}},\n$$\nwhere the term $\\rho \\,\\frac{\\partial \\overline{u_{i}' u_{j}'}}{\\partial x_{j}}$ arises from averaging the nonlinear convective term $\\rho\\, u_{j}\\frac{\\partial u_{i}}{\\partial x_{j}}$ and represents the divergence of the Reynolds stress tensor. Rewriting, the Reynolds-Averaged Navier–Stokes (RANS) momentum equation becomes\n$$\n\\rho\\,\\overline{u}_{j}\\frac{\\partial \\overline{u}_{i}}{\\partial x_{j}} = -\\frac{\\partial \\overline{p}}{\\partial x_{i}} + \\mu \\frac{\\partial^{2} \\overline{u}_{i}}{\\partial x_{j}\\partial x_{j}} - \\rho\\,\\frac{\\partial \\overline{u_{i}' u_{j}'}}{\\partial x_{j}}.\n$$\nIn the present canonical flow, the mean field is $\\overline{\\boldsymbol{u}} = (U(y), 0, 0)$, and we assume statistical steadiness, so $\\frac{\\partial \\overline{u}_{i}}{\\partial t} = 0$. Fully developed conditions imply $\\frac{\\partial}{\\partial x}(\\cdot) = 0$ and $\\frac{\\partial}{\\partial z}(\\cdot) = 0$ for mean fields, and the mean pressure varies only in $x$, i.e., $\\overline{p} = \\overline{p}(x)$.\n\nFocusing on the streamwise component $i=x$, the convective term simplifies as\n$$\n\\rho\\,\\overline{u}_{j}\\frac{\\partial \\overline{u}_{x}}{\\partial x_{j}} = \\rho\\left(\\overline{u}_{x}\\frac{\\partial \\overline{u}_{x}}{\\partial x} + \\overline{u}_{y}\\frac{\\partial \\overline{u}_{x}}{\\partial y} + \\overline{u}_{z}\\frac{\\partial \\overline{u}_{x}}{\\partial z}\\right) = \\rho\\left(U \\cdot 0 + 0 \\cdot \\frac{dU}{dy} + 0 \\cdot 0\\right) = 0,\n$$\nbecause $\\frac{\\partial U}{\\partial x} = 0$, $\\overline{u}_{y} = 0$, and $\\frac{\\partial U}{\\partial z} = 0$. The viscous term reduces to\n$$\n\\mu \\frac{\\partial^{2} \\overline{u}_{x}}{\\partial x_{j}\\partial x_{j}} = \\mu \\frac{d^{2}U}{dy^{2}}.\n$$\nThe divergence of the Reynolds stress tensor contributes only through the wall-normal derivative of the Reynolds shear stress $\\overline{u_{x}' u_{y}'} = \\overline{u'v'}$:\n$$\n-\\rho\\,\\frac{\\partial \\overline{u_{x}' u_{j}'}}{\\partial x_{j}} = -\\rho\\,\\frac{\\partial \\overline{u'v'}}{\\partial y}.\n$$\nThus, the streamwise RANS momentum balance becomes\n$$\n0 = -\\frac{\\partial \\overline{p}}{\\partial x} + \\mu \\frac{d^{2}U}{dy^{2}} - \\rho\\,\\frac{d \\,\\overline{u'v'}}{dy}.\n$$\nIt is convenient to introduce the total mean shear stress,\n$$\n\\tau_{\\text{tot}}(y) \\equiv \\mu \\frac{dU}{dy} - \\rho\\,\\overline{u'v'},\n$$\nwhich combines the viscous shear and the Reynolds shear. Differentiating $\\tau_{\\text{tot}}(y)$ with respect to $y$ and using the previous equation,\n$$\n\\frac{d \\tau_{\\text{tot}}}{dy} = \\mu \\frac{d^{2}U}{dy^{2}} - \\rho\\,\\frac{d \\,\\overline{u'v'}}{dy} = \\frac{\\partial \\overline{p}}{\\partial x}.\n$$\nThe right-hand side is independent of $y$ for a fully developed flow, so $\\frac{\\partial \\overline{p}}{\\partial x}$ is a constant. Integrating $\\frac{d \\tau_{\\text{tot}}}{dy} = \\frac{\\partial \\overline{p}}{\\partial x}$ with respect to $y$ gives\n$$\n\\tau_{\\text{tot}}(y) = y\\,\\frac{\\partial \\overline{p}}{\\partial x} + C,\n$$\nwhere $C$ is a constant of integration. We determine $C$ from symmetry at the channel centerline. At the symmetry plane $y = h$, the mean shear vanishes, $\\frac{dU}{dy}\\big|_{y=h} = 0$, and the Reynolds shear stress vanishes, $\\overline{u'v'}\\big|_{y=h} = 0$, so\n$$\n\\tau_{\\text{tot}}(h) = 0.\n$$\nTherefore,\n$$\n0 = h\\,\\frac{\\partial \\overline{p}}{\\partial x} + C \\quad \\Rightarrow \\quad C = -\\,h\\,\\frac{\\partial \\overline{p}}{\\partial x}.\n$$\nAt the wall $y=0$, the total mean shear equals the wall shear stress $\\tau_{w}$:\n$$\n\\tau_{\\text{tot}}(0) = \\tau_{w} = 0 \\cdot \\frac{\\partial \\overline{p}}{\\partial x} + C = C.\n$$\nCombining the two relations for $C$ yields\n$$\n\\tau_{w} = -\\,h\\,\\frac{\\partial \\overline{p}}{\\partial x} \\quad \\Rightarrow \\quad \\frac{\\partial \\overline{p}}{\\partial x} = -\\,\\frac{\\tau_{w}}{h}.\n$$\nThe negative sign in the relationship indicates that for a positive wall shear stress ($\\tau_w > 0$), the mean pressure $\\overline{p}$ must decrease in the streamwise direction to drive the flow.",
            "answer": "$$\\boxed{-\\frac{\\tau_{w}}{h}}$$"
        },
        {
            "introduction": "From the theoretical force balance, we now move to quantitative application to build physical intuition. This practice uses a set of realistic flow data within a turbulent channel to explore the relative contributions of viscous and turbulent stresses at a specific point in the flow. By calculating this stress partition, you will gain a tangible understanding of why modeling the Reynolds stress term—the focus of all RANS turbulence models—is critically important, especially away from the immediate vicinity of the wall. ",
            "id": "3990764",
            "problem": "A fully developed turbulent plane channel flow of air is studied within the context of Computational Fluid Dynamics (CFD). The channel has half-height $h$, and the wall-normal coordinate $y$ is measured from the lower wall at $y = 0$ to the centerline at $y = h$. The flow is steady, incompressible, and driven by a constant streamwise pressure gradient. The air properties at laboratory conditions are density $\\rho$ and dynamic viscosity $\\mu$. The instantaneous velocity and pressure fields satisfy the incompressible Navier–Stokes equations, and the velocity is decomposed according to Reynolds decomposition into a mean and a fluctuating part. Consider the following data:\n- Fluid density $\\rho = 1.20\\ \\mathrm{kg\\,m^{-3}}$,\n- Dynamic viscosity $\\mu = 1.80 \\times 10^{-5}\\ \\mathrm{Pa\\,s}$,\n- Channel half-height $h = 1.00 \\times 10^{-2}\\ \\mathrm{m}$,\n- Constant streamwise pressure gradient $\\frac{d \\overline{p}}{dx} = -1.20 \\times 10^{2}\\ \\mathrm{Pa\\,m^{-1}}$,\n- At a wall-normal location $y_{0} = 2.00 \\times 10^{-3}\\ \\mathrm{m}$, measurements yield mean velocity gradient $\\frac{d \\overline{U}}{dy}\\big|_{y_{0}} = 1.00 \\times 10^{3}\\ \\mathrm{s^{-1}}$ and Reynolds shear stress $-\\rho\\,\\overline{u'v'}\\big|_{y_{0}} = 9.42 \\times 10^{-1}\\ \\mathrm{Pa}$.\n\nStarting from the instantaneous incompressible Navier–Stokes equations and applying Reynolds decomposition, derive the one-dimensional streamwise Reynolds-Averaged Navier–Stokes equations (RANS) appropriate for a steady, fully developed plane channel flow with constant pressure gradient. From that balance, determine an expression for the total shear stress distribution across the channel and deduce the wall shear stress $\\tau_{w}$. Define the friction velocity $u_{\\tau}$ by $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$. At the location $y_{0}$, define the viscous shear $\\tau_{v}(y_{0}) = \\mu \\left( \\frac{d \\overline{U}}{dy} \\right)\\big|_{y_{0}}$, the turbulent shear $\\tau_{t}(y_{0}) = -\\rho\\,\\overline{u'v'}\\big|_{y_{0}}$, and the total shear $\\tau_{\\text{tot}}(y_{0}) = \\tau_{v}(y_{0}) + \\tau_{t}(y_{0})$. Compute the partition fraction $\\beta = \\frac{\\tau_{t}(y_{0})}{\\tau_{\\text{tot}}(y_{0})}$.\n\nReport your final answers as a row matrix containing, in order, the friction velocity and the partition fraction. Round your answers to four significant figures. Express the friction velocity in $\\mathrm{m\\,s^{-1}}$, and the partition fraction as a decimal (unitless).",
            "solution": "The instantaneous incompressible Navier–Stokes equations are subject to Reynolds decomposition, where instantaneous quantities are separated into a mean and a fluctuating part: $u_i = \\overline{U_i} + u'_i$ and $p = \\overline{p} + p'$. After substituting and time-averaging, the x-component of the RANS momentum equation is:\n$$ \\rho \\left( \\frac{\\partial \\overline{U}}{\\partial t} + \\overline{U}\\frac{\\partial \\overline{U}}{\\partial x} + \\overline{V}\\frac{\\partial \\overline{U}}{\\partial y} + \\overline{W}\\frac{\\partial \\overline{U}}{\\partial z} \\right) = -\\frac{\\partial \\overline{p}}{\\partial x} + \\mu \\nabla^2 \\overline{U} - \\rho \\left( \\frac{\\partial \\overline{u'u'}}{\\partial x} + \\frac{\\partial \\overline{u'v'}}{\\partial y} + \\frac{\\partial \\overline{u'w'}}{\\partial z} \\right) $$\nFor a steady, fully developed, plane channel flow, the following simplifications apply:\n1.  **Steady flow**: $\\frac{\\partial}{\\partial t}$ of any mean quantity is $0$.\n2.  **Fully developed flow**: $\\frac{\\partial}{\\partial x}$ of any mean velocity component or statistical quantity (like Reynolds stresses) is $0$.\n3.  **Plane flow**: The flow is statistically homogeneous in the spanwise ($z$) direction, so $\\frac{\\partial}{\\partial z}$ of any mean or statistical quantity is $0$. The mean velocity field is one-dimensional, $\\overline{\\mathbf{U}} = (\\overline{U}(y), 0, 0)$, hence $\\overline{V} = \\overline{W} = 0$.\n\nApplying these simplifications to the x-RANS equation yields:\n$$ 0 = -\\frac{d \\overline{p}}{dx} + \\mu \\frac{d^2 \\overline{U}}{dy^2} - \\rho \\frac{d \\overline{u'v'}}{dy} $$\nThe pressure gradient $\\frac{\\partial \\overline{p}}{\\partial x}$ becomes $\\frac{d \\overline{p}}{dx}$ as $\\overline{p}$ is only a function of $x$. This equation can be rewritten by grouping the stress terms:\n$$ \\frac{d}{dy} \\left( \\mu \\frac{d \\overline{U}}{dy} - \\rho \\overline{u'v'} \\right) = \\frac{d \\overline{p}}{dx} $$\nThe term in the parentheses is the total shear stress, $\\tau_{\\text{tot}}(y) = \\mu \\frac{d\\overline{U}}{dy} - \\rho\\overline{u'v'}$. This represents the sum of the mean viscous shear stress, $\\tau_v(y) = \\mu \\frac{d\\overline{U}}{dy}$, and the turbulent or Reynolds shear stress, $\\tau_t(y) = -\\rho\\overline{u'v'}$.\nThus, the simplified RANS equation shows a linear relationship for the total shear stress:\n$$ \\frac{d\\tau_{\\text{tot}}}{dy} = \\frac{d\\overline{p}}{dx} $$\nIntegrating with respect to $y$ from the centerline ($y=h$) to an arbitrary position $y$:\n$$ \\int_h^y \\frac{d\\tau_{\\text{tot}}}{dy'} dy' = \\int_h^y \\frac{d\\overline{p}}{dx} dy' $$\n$$ \\tau_{\\text{tot}}(y) - \\tau_{\\text{tot}}(h) = (y-h) \\frac{d\\overline{p}}{dx} $$\nAt the centerline ($y=h$), due to symmetry, both the mean velocity gradient $\\frac{d\\overline{U}}{dy}$ and the Reynolds shear correlation $\\overline{u'v'}$ are zero. Therefore, $\\tau_{\\text{tot}}(h) = 0$. This gives the expression for the total shear stress distribution:\n$$ \\tau_{\\text{tot}}(y) = (y-h)\\frac{d\\overline{p}}{dx} $$\nThe wall shear stress, $\\tau_w$, is the total shear stress at the lower wall ($y=0$):\n$$ \\tau_w = \\tau_{\\text{tot}}(0) = (0-h)\\frac{d\\overline{p}}{dx} = -h\\frac{d\\overline{p}}{dx} $$\nUsing the given numerical values:\n$$ \\tau_w = -(1.00 \\times 10^{-2}\\ \\mathrm{m})(-1.20 \\times 10^{2}\\ \\mathrm{Pa\\,m^{-1}}) = 1.20\\ \\mathrm{Pa} $$\nThe friction velocity $u_\\tau$ is defined as $u_\\tau = \\sqrt{\\tau_w/\\rho}$:\n$$ u_\\tau = \\sqrt{\\frac{1.20\\ \\mathrm{Pa}}{1.20\\ \\mathrm{kg\\,m^{-3}}}} = \\sqrt{1.00\\ \\mathrm{m^2\\,s^{-2}}} = 1.00\\ \\mathrm{m\\,s^{-1}} $$\nRounding to four significant figures, $u_\\tau = 1.000\\ \\mathrm{m\\,s^{-1}}$.\n\nNext, we evaluate the partition fraction $\\beta = \\frac{\\tau_t(y_0)}{\\tau_{\\text{tot}}(y_0)}$ at $y_0 = 2.00 \\times 10^{-3}\\ \\mathrm{m}$.\nThe turbulent shear stress at $y_0$ is given as $\\tau_t(y_0) = -\\rho\\,\\overline{u'v'}\\big|_{y_{0}} = 9.42 \\times 10^{-1}\\ \\mathrm{Pa} = 0.942\\ \\mathrm{Pa}$.\nThe viscous shear stress at $y_0$ is calculated from the given data:\n$$ \\tau_v(y_0) = \\mu \\left( \\frac{d \\overline{U}}{dy} \\right)\\big|_{y_{0}} = (1.80 \\times 10^{-5}\\ \\mathrm{Pa\\,s}) \\times (1.00 \\times 10^{3}\\ \\mathrm{s^{-1}}) = 1.80 \\times 10^{-2}\\ \\mathrm{Pa} = 0.0180\\ \\mathrm{Pa} $$\nThe total shear stress at $y_0$ is the sum of the viscous and turbulent components:\n$$ \\tau_{\\text{tot}}(y_0) = \\tau_v(y_0) + \\tau_t(y_0) = 0.0180\\ \\mathrm{Pa} + 0.942\\ \\mathrm{Pa} = 0.960\\ \\mathrm{Pa} $$\nThe partition fraction is then:\n$$ \\beta = \\frac{\\tau_t(y_0)}{\\tau_{\\text{tot}}(y_0)} = \\frac{0.942}{0.960} = 0.98125 $$\nRounding to four significant figures, $\\beta = 0.9813$.\n\nThe final answer comprises the friction velocity $u_\\tau$ and the partition fraction $\\beta$.\n$u_\\tau = 1.000\\ \\mathrm{m\\,s^{-1}}$\n$\\beta = 0.9813$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.000 & 0.9813\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having established the physical significance of Reynolds stresses, the central challenge becomes modeling them accurately. This practice introduces the crucial step of model calibration, demonstrating how empirical constants in closures like the mixing-length and $k$-$\\epsilon$ models are determined from data. You will learn to frame this task as a linear regression problem, providing a hands-on introduction to the data-driven techniques that underpin the development and validation of practical turbulence models. ",
            "id": "3990780",
            "problem": "Consider an incompressible turbulent shear flow such as a plane channel or boundary layer, where the mean velocity is one-dimensional in the wall-normal coordinate. Start from the instantaneous fluid momentum balance given by the Navier–Stokes equations and perform Reynolds decomposition of velocity and pressure fields, where the instantaneous velocity components are written as $u_i = \\overline{u}_i + u_i'$ and pressure as $p = \\overline{p} + p'$, with $\\overline{u}_i$ and $\\overline{p}$ being the Reynolds-averaged mean fields, and $u_i'$ and $p'$ the fluctuating fields. After applying Reynolds averaging, the Reynolds-averaged Navier–Stokes (RANS) equations introduce the Reynolds stress tensor $-\\rho \\,\\overline{u_i' u_j'}$ as an additional term in the momentum balance. In a statistically stationary, fully developed, one-dimensional mean flow with streamwise velocity component $U(y)$ and wall-normal coordinate $y$, the dominant turbulent stress is the Reynolds shear stress $-\\overline{u'v'}$.\n\nInvoke the Boussinesq eddy-viscosity hypothesis, which posits a linear relationship between the Reynolds stress and the mean strain rate, namely $-\\overline{u'v'} = \\nu_t \\, \\partial U/\\partial y$, where $\\nu_t$ is the eddy viscosity. In what follows, calibrate model constants appearing in two closures for $\\nu_t$ by casting their determination as a least-squares fit over discrete data points:\n- Mixing-length closure: $\\nu_t = \\kappa^2 \\, y^2 \\, \\lvert \\partial U/\\partial y \\rvert$. The von Kármán constant $\\kappa$ is to be calibrated.\n- Turbulent kinetic energy–dissipation closure (commonly associated with the $k$–$\\epsilon$ model): $\\nu_t = C_\\mu \\, k^2/\\epsilon$. The constant $C_\\mu$ is to be calibrated.\n\nTreat calibration as an ordinary least squares regression with zero intercept, where for each data point $i$ you model the measured quantity $-\\overline{u'v'}_i$ as a linear function of a known regressor that depends on the closure and known fields. For the mixing-length model, define the regressor $\\phi_i = y_i^2 \\, S_i \\, \\lvert S_i \\rvert$, where $S_i = \\partial U/\\partial y \\big|_{y=y_i}$, so that the model prediction is $-\\overline{u'v'}_i^{\\text{model}} = \\kappa^2 \\, \\phi_i$. For the $k$–$\\epsilon$ closure, define the regressor $\\psi_i = (k_i^2/\\epsilon_i) \\, S_i$, so that $-\\overline{u'v'}_i^{\\text{model}} = C_\\mu \\, \\psi_i$. Estimate $\\kappa^2$ and $C_\\mu$ by minimizing the sum of squared residuals over the valid data points. You must exclusively use valid points where the regressors are finite; ignore any point with $\\epsilon_i \\le 0$ or non-finite values.\n\nStarting from the Reynolds-averaged momentum equation and the Boussinesq hypothesis, derive why both closures reduce to a linear regression problem with zero intercept when expressed in terms of the chosen regressors. Then, design an algorithm that computes the least-squares slope estimates for $\\kappa^2$ and $C_\\mu$, and returns $\\kappa$ via $\\kappa = \\sqrt{\\kappa^2}$.\n\nAll quantities in the test suite are dimensionless to remove dependence on units. Implement a program that reads no input and uses the following test suite embedded within the code. For each test case, compute and return the specified calibration constant(s), rounded to five decimal places.\n\nTest Suite:\n- Case $1$ (mixing-length calibration, general case):\n  - Wall-normal locations $y$: $[\\,0.05,\\,0.10,\\,0.15,\\,0.20\\,]$.\n  - Mean shear $S = \\partial U/\\partial y$: $[\\,8.00,\\,6.00,\\,5.00,\\,4.00\\,]$.\n  - Measured $-\\overline{u'v'}$: $[\\,0.02700,\\,0.06100,\\,0.09500,\\,0.10800\\,]$.\n  - Output: $\\kappa$.\n- Case $2$ ($k$–$\\epsilon$ calibration, happy path):\n  - Turbulent kinetic energy $k$: $[\\,0.50,\\,0.60,\\,0.70\\,]$.\n  - Dissipation rate $\\epsilon$: $[\\,0.05,\\,0.06,\\,0.07\\,]$.\n  - Mean shear $S = \\partial U/\\partial y$: $[\\,5.00,\\,4.00,\\,3.00\\,]$.\n  - Measured $-\\overline{u'v'}$: $[\\,2.26000,\\,2.15000,\\,1.90000\\,]$.\n  - Output: $C_\\mu$.\n- Case $3$ (edge case coverage, includes zeros and sign changes):\n  - Mixing-length subset:\n    - Wall-normal locations $y$: $[\\,0.05,\\,0.10,\\,0.20\\,]$.\n    - Mean shear $S = \\partial U/\\partial y$: $[\\,13.50,\\,0.00,\\,-3.78\\,]$.\n    - Measured $-\\overline{u'v'}$: $[\\,0.07660,\\,0.00000,\\,-0.09610\\,]$.\n    - Output: $\\kappa$.\n  - $k$–$\\epsilon$ subset:\n    - Turbulent kinetic energy $k$: $[\\,0.40,\\,0.50,\\,0.45\\,]$.\n    - Dissipation rate $\\epsilon$: $[\\,0.05,\\,0.00,\\,0.04\\,]$.\n    - Mean shear $S = \\partial U/\\partial y$: $[\\,3.00,\\,0.00,\\,-2.00\\,]$.\n    - Measured $-\\overline{u'v'}$: $[\\,0.86400,\\,0.00000,\\,-0.91100\\,]$.\n    - Output: $C_\\mu$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\,\\text{result1},\\text{result2},\\text{result3},\\text{result4}\\,]$). Specifically, print $[\\,\\kappa_{\\text{case1}},\\,C_{\\mu,\\text{case2}},\\,\\kappa_{\\text{case3}},\\,C_{\\mu,\\text{case3}}\\,]$ with each entry rounded to five decimal places. All calculations are dimensionless.",
            "solution": "The present problem asks for the calibration of constants in two standard turbulence models, the mixing-length model and a model related to the $k$–$\\epsilon$ closure, by using provided data sets. The calibration is to be performed using an ordinary least-squares (OLS) regression with a zero intercept. The first part of the task is to derive the theoretical basis for this regression approach starting from the Boussinesq hypothesis. The second part is to implement an algorithm to compute the constants for a given test suite.\n\nThe foundation for this analysis is the Boussinesq eddy-viscosity hypothesis, which models the Reynolds shear stress, $-\\overline{u'v'}$, in a one-dimensional mean flow as being proportional to the mean velocity gradient, $\\frac{\\partial U}{\\partial y}$. The constant of proportionality is the eddy viscosity, $\\nu_t$.\n$$\n-\\overline{u'v'} = \\nu_t \\frac{\\partial U}{\\partial y}\n$$\nDifferent turbulence models provide different closures for $\\nu_t$. We will analyze the two models provided in the problem statement.\n\nThe calibration of a model constant is framed as a zero-intercept linear regression problem. In such a problem, we have a set of measurements of a dependent variable, $Y_i$, and an independent variable (or regressor), $X_i$. The model takes the form $Y_i = \\beta X_i + \\varepsilon_i$, where $\\beta$ is the unknown model coefficient to be determined, and $\\varepsilon_i$ is the error term. The OLS method finds the value of $\\beta$ that minimizes the sum of the squared residuals, $SSR = \\sum_{i} (Y_i - \\beta X_i)^2$. To find this minimum, we take the derivative of $SSR$ with respect to $\\beta$ and set it to zero:\n$$\n\\frac{d(SSR)}{d\\beta} = \\frac{d}{d\\beta} \\sum_{i} (Y_i^2 - 2\\beta X_i Y_i + \\beta^2 X_i^2) = \\sum_{i} (-2 X_i Y_i + 2\\beta X_i^2) = 0\n$$\nSolving for $\\beta$ yields the standard OLS estimator for a zero-intercept model:\n$$\n\\beta = \\frac{\\sum_{i} X_i Y_i}{\\sum_{i} X_i^2}\n$$\nWe now demonstrate how each turbulence model can be cast into this regression framework.\n\n1.  **Mixing-Length Model Calibration**:\n    The mixing-length model proposes a closure for the eddy viscosity $\\nu_t$ as:\n    $$\n    \\nu_t = l_m^2 \\left\\lvert \\frac{\\partial U}{\\partial y} \\right\\rvert\n    $$\n    where $l_m$ is the mixing length. In the near-wall region, the mixing length is often modeled as being proportional to the wall-normal distance $y$, such that $l_m = \\kappa y$. Here, $\\kappa$ is the von Kármán constant. Substituting this into the model for $\\nu_t$ gives:\n    $$\n    \\nu_t = (\\kappa y)^2 \\left\\lvert \\frac{\\partial U}{\\partial y} \\right\\rvert = \\kappa^2 y^2 \\left\\lvert \\frac{\\partial U}{\\partial y} \\right\\rvert\n    $$\n    Now, substituting this expression for $\\nu_t$ into the Boussinesq hypothesis:\n    $$\n    -\\overline{u'v'} = \\left(\\kappa^2 y^2 \\left\\lvert \\frac{\\partial U}{\\partial y} \\right\\rvert\\right) \\frac{\\partial U}{\\partial y}\n    $$\n    We can rearrange this equation to isolate the constant to be calibrated, $\\kappa^2$:\n    $$\n    -\\overline{u'v'} = \\kappa^2 \\left( y^2 \\frac{\\partial U}{\\partial y} \\left\\lvert \\frac{\\partial U}{\\partial y} \\right\\rvert \\right)\n    $$\n    This equation is now in the form $Y = \\beta X$. By making the following identifications for a set of discrete data points $i$:\n    - Dependent variable $Y_i$: The measured Reynolds shear stress, $Y_i = -\\overline{u'v'}_i$.\n    - Model coefficient $\\beta$: The squared von Kármán constant, $\\beta = \\kappa^2$.\n    - Regressor $X_i$: The quantity $X_i = \\phi_i = y_i^2 S_i \\lvert S_i \\rvert$, where $S_i = \\frac{\\partial U}{\\partial y}\\big|_{y=y_i}$.\n    \n    The calibration of $\\kappa^2$ thus becomes a linear regression problem with zero intercept. The OLS estimate is $\\kappa^2 = \\frac{\\sum \\phi_i (-\\overline{u'v'}_i)}{\\sum \\phi_i^2}$. The von Kármán constant is then found by taking the square root: $\\kappa = \\sqrt{\\kappa^2}$.\n\n2.  **$k$–$\\epsilon$ Model Constant Calibration**:\n    In the context of the standard $k$–$\\epsilon$ model, the eddy viscosity $\\nu_t$ is modeled using the turbulent kinetic energy, $k$, and its dissipation rate, $\\epsilon$:\n    $$\n    \\nu_t = C_\\mu \\frac{k^2}{\\epsilon}\n    $$\n    where $C_\\mu$ is an empirical constant. Substituting this into the Boussinesq hypothesis yields:\n    $$\n    -\\overline{u'v'} = \\left(C_\\mu \\frac{k^2}{\\epsilon}\\right) \\frac{\\partial U}{\\partial y}\n    $$\n    Rearranging to isolate the constant $C_\\mu$:\n    $$\n    -\\overline{u'v'} = C_\\mu \\left( \\frac{k^2}{\\epsilon} \\frac{\\partial U}{\\partial y} \\right)\n    $$\n    This equation is also in the form $Y = \\beta X$. We identify the terms for a set of data points $i$:\n    - Dependent variable $Y_i$: The measured Reynolds shear stress, $Y_i = -\\overline{u'v'}_i$.\n    - Model coefficient $\\beta$: The constant to be calibrated, $\\beta = C_\\mu$.\n    - Regressor $X_i$: The quantity $X_i = \\psi_i = \\frac{k_i^2}{\\epsilon_i} S_i$, where $S_i = \\frac{\\partial U}{\\partial y}\\big|_{y=y_i}$.\n    \n    The calibration of $C_\\mu$ is therefore a linear regression problem with zero intercept. The OLS estimate is $C_\\mu = \\frac{\\sum \\psi_i (-\\overline{u'v'}_i)}{\\sum \\psi_i^2}$. Critically, data points where the regressor is not well-defined, such as when $\\epsilon_i \\le 0$, must be excluded from the sums.\n\nThe algorithm to solve the problem involves implementing these OLS formulas. For each test case, we construct the regressor and the dependent variable from the provided data. We then compute the numerator and denominator sums, calculate the coefficient, and finally, for the mixing-length case, take the square root to find $\\kappa$. All calculations are performed using floating-point arithmetic, and the final results are rounded as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the calibration constants for two turbulence models\n    using ordinary least squares regression based on provided test data.\n    \"\"\"\n\n    def calibrate_kappa(y_data, s_data, tau_uv_data):\n        \"\"\"\n        Calibrates the von Kármán constant kappa using the mixing-length model.\n\n        The model is -u'v' = kappa^2 * (y^2 * S * |S|).\n        This is a linear regression Y = beta * X with zero intercept where:\n        Y = -u'v'\n        beta = kappa^2\n        X = y^2 * S * |S|\n\n        Args:\n            y_data (list): Wall-normal locations.\n            s_data (list): Mean shear rates (dU/dy).\n            tau_uv_data (list): Measured Reynolds shear stresses (-u'v').\n\n        Returns:\n            float: The calibrated von Kármán constant kappa.\n        \"\"\"\n        y = np.array(y_data, dtype=np.float64)\n        s = np.array(s_data, dtype=np.float64)\n        tau_uv = np.array(tau_uv_data, dtype=np.float64)\n\n        # Regressor X = phi\n        phi = y**2 * s * np.abs(s)\n        # Dependent variable Y = tau_uv\n        Y = tau_uv\n\n        # OLS estimate for beta = sum(X*Y) / sum(X*X)\n        numerator = np.dot(phi, Y)\n        denominator = np.dot(phi, phi)\n\n        if denominator == 0:\n            # Undefined if all regressors are zero\n            return 0.0\n\n        kappa_squared = numerator / denominator\n        \n        # kappa must be non-negative\n        if kappa_squared < 0:\n            return 0.0 # Or handle as an error, but model assumes positive kappa^2\n            \n        kappa = np.sqrt(kappa_squared)\n        return kappa\n\n    def calibrate_cmu(k_data, eps_data, s_data, tau_uv_data):\n        \"\"\"\n        Calibrates the constant C_mu from the k-epsilon model context.\n\n        The model is -u'v' = C_mu * (k^2/epsilon * S).\n        This is a linear regression Y = beta * X with zero intercept where:\n        Y = -u'v'\n        beta = C_mu\n        X = (k^2/epsilon) * S\n\n        Args:\n            k_data (list): Turbulent kinetic energies.\n            eps_data (list): Dissipation rates.\n            s_data (list): Mean shear rates (dU/dy).\n            tau_uv_data (list): Measured Reynolds shear stresses (-u'v').\n\n        Returns:\n            float: The calibrated constant C_mu.\n        \"\"\"\n        k = np.array(k_data, dtype=np.float64)\n        eps = np.array(eps_data, dtype=np.float64)\n        s = np.array(s_data, dtype=np.float64)\n        tau_uv = np.array(tau_uv_data, dtype=np.float64)\n        \n        # Filter out invalid data points where epsilon = 0\n        valid_indices = eps > 0\n        \n        k_valid = k[valid_indices]\n        eps_valid = eps[valid_indices]\n        s_valid = s[valid_indices]\n        tau_uv_valid = tau_uv[valid_indices]\n\n        if len(k_valid) == 0:\n            return 0.0 # No valid data points\n\n        # Regressor X = psi\n        psi = (k_valid**2 / eps_valid) * s_valid\n        # Dependent variable Y = tau_uv_valid\n        Y = tau_uv_valid\n        \n        # OLS estimate for beta = sum(X*Y) / sum(X*X)\n        numerator = np.dot(psi, Y)\n        denominator = np.dot(psi, psi)\n\n        if denominator == 0:\n            return 0.0\n\n        c_mu = numerator / denominator\n        return c_mu\n\n    # Test Suite Data\n    test_cases = [\n        {\n            \"type\": \"kappa\",\n            \"data\": {\n                \"y_data\": [0.05, 0.10, 0.15, 0.20],\n                \"s_data\": [8.00, 6.00, 5.00, 4.00],\n                \"tau_uv_data\": [0.02700, 0.06100, 0.09500, 0.10800],\n            }\n        },\n        {\n            \"type\": \"cmu\",\n            \"data\": {\n                \"k_data\": [0.50, 0.60, 0.70],\n                \"eps_data\": [0.05, 0.06, 0.07],\n                \"s_data\": [5.00, 4.00, 3.00],\n                \"tau_uv_data\": [2.26000, 2.15000, 1.90000],\n            }\n        },\n        {\n            \"type\": \"kappa\",\n            \"data\": {\n                \"y_data\": [0.05, 0.10, 0.20],\n                \"s_data\": [13.50, 0.00, -3.78],\n                \"tau_uv_data\": [0.07660, 0.00000, -0.09610],\n            }\n        },\n        {\n            \"type\": \"cmu\",\n            \"data\": {\n                \"k_data\": [0.40, 0.50, 0.45],\n                \"eps_data\": [0.05, 0.00, 0.04],\n                \"s_data\": [3.00, 0.00, -2.00],\n                \"tau_uv_data\": [0.86400, 0.00000, -0.91100],\n            }\n        }\n    ]\n    \n    results = []\n    for case in test_cases:\n        if case[\"type\"] == \"kappa\":\n            result = calibrate_kappa(**case[\"data\"])\n        elif case[\"type\"] == \"cmu\":\n            result = calibrate_cmu(**case[\"data\"])\n        results.append(result)\n\n    # Format the final output string as per requirements\n    formatted_results = [f\"{r:.5f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}