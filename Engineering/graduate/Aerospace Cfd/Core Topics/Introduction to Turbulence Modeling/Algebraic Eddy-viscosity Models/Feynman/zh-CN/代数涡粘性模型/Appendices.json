{
    "hands_on_practices": [
        {
            "introduction": "掌握代数涡粘模型的关键在于理解其物理起源。本练习将引导我们从Prandtl的混合长度假设这一基石出发，结合Boussinesq涡粘假设，推导出湍流边界层对数律区域中涡粘度的经典表达式。通过这个推导，你将亲身体验如何将一个物理概念（混合长度）转化为一个可用于计算流体力学（CFD）的数学模型。",
            "id": "3943005",
            "problem": "考虑两平行平板间一个统计定常、充分发展的不可压缩平面湍流槽道流，其平均速度 $U(y)$ 仅在流向，并且只依赖于法向坐标 $y$。设流体密度为 $\\rho$，运动粘度为 $\\nu$。假设采用雷诺平均纳维-斯托克斯 (RANS) 框架，并采纳 Boussinesq 涡粘性假设，其中湍流雷诺切应力 $-\\overline{u^{\\prime} v^{\\prime}}$ 被模化为 $-\\overline{u^{\\prime} v^{\\prime}} = \\nu_{t} \\, \\partial U / \\partial y$，$\\nu_{t}$ 为涡粘性系数。此外，对动量输运采纳 Prandtl 混合长度假设，并假设在对数区，混合长度 $\\ell$ 与壁面距离成线性关系，即 $\\ell = \\kappa \\, y$，其中 $\\kappa$ 是 von Kármán 常数，$y$ 是到最近壁面的距离。\n\n仅从这些模型假设和基本定义出发，并要求模化出的涡粘性系数 $ \\nu_{t}(y)$ 在槽道的两个半区内均为非负，推导涡粘性系数剖面 $ \\nu_{t}(y)$ 关于 $\\kappa$、$y$ 和平均剪切 $ \\partial U / \\partial y$ 的解析表达式。你的最终答案必须是一个单一的闭式表达式。",
            "solution": "该问题陈述被认为是有效的，因为它科学地基于经典湍流模拟的原理，是适定、客观且自洽的。所有给出的假设在壁面有界湍流的研究中都是标准的。我们现在开始推导。\n\n目标是基于所提供的假设，推导出涡粘性系数 $\\nu_{t}$ 的解析表达式。推导过程首先为雷诺切应力 $-\\overline{u^{\\prime} v^{\\prime}}$ 建立两种不同的模型，然后将它们相等以求解 $\\nu_{t}$。\n\n首先，我们考虑 Prandtl 的混合长度假设。该模型用一个特征长度尺度，即混合长度 $\\ell$，和局部平均速度梯度来表示雷诺切应力。其核心思想是，湍流的动量输运类似于分子输运，但是由宏观的流体“团块”（即涡）在混合前移动一段距离 $\\ell$ 来完成。流向速度脉动的量级 $|u^{\\prime}|$ 被假设与平均速度在这段距离上的变化成比例：\n$$\n|u^{\\prime}| \\propto \\ell \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\n该模型进一步假定，法向脉动 $v^{\\prime}$ 与 $u^{\\prime}$ 具有相同的数量级，并与之相关。这导出了 Prandtl 关于雷诺切应力量级 $\\tau_{t} = -\\rho \\overline{u^{\\prime} v^{\\prime}}$ 的模型：\n$$\n\\tau_{t} = \\rho \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}\n$$\n$\\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}$ 这一项正确地确保了切应力与平均应变率方向相反，即 $\\tau_{t}$ 与 $\\frac{\\partial U}{\\partial y}$ 的符号相同，这是湍流生成项成为平均动能耗散项的一个物理要求。该表达式可以重写为 $\\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y} = \\left(\\frac{\\partial U}{\\partial y}\\right)^2 \\text{sgn}\\left(\\frac{\\partial U}{\\partial y}\\right)$。出于我们的目的，使用运动雷诺切应力 $-\\overline{u^{\\prime} v^{\\prime}} = \\tau_{t} / \\rho$ 更为方便。将上述方程除以密度 $\\rho$ 可得：\n$$\n-\\overline{u^{\\prime} v^{\\prime}} = \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}\n$$\n\n其次，我们引用问题陈述中明确给出的 Boussinesq 涡粘性假设。该假设将雷诺应力张量模化为与平均应变率张量成线性比例，这类似于层流中的牛顿应力-应变关系。对于平面槽道流这一特殊情况，其中唯一的非零平均速度梯度是 $\\frac{\\partial U}{\\partial y}$，该假设简化为剪切分量的标量关系：\n$$\n-\\overline{u^{\\prime} v^{\\prime}} = \\nu_{t} \\frac{\\partial U}{\\partial y}\n$$\n这里，$\\nu_{t}$ 是湍流粘度或涡粘度，与分子运动粘度 $\\nu$ 不同，它不是流体本身的属性，而是流动状态的一种属性。\n\n现在，我们将雷诺切应力 $-\\overline{u^{\\prime} v^{\\prime}}$ 的两个表达式相等：\n$$\n\\nu_{t} \\frac{\\partial U}{\\partial y} = \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}\n$$\n为了求解 $\\nu_{t}$，我们可以将等式两边同时除以 $\\frac{\\partial U}{\\partial y}$。在流场中 $\\frac{\\partial U}{\\partial y} \\neq 0$ 的区域，此操作是有效的。在湍流槽道流中，除了速度剖面对称的槽道中心线外，平均剪切在任何地方都非零。在远离中心线处，我们得到：\n$$\n\\nu_{t} = \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\n\n最后一步是代入问题陈述中给出的、适用于流动对数区的混合长度 $\\ell$ 的具体形式。假设是混合长度与最近壁面的距离 $y$ 成线性关系：\n$$\n\\ell = \\kappa y\n$$\n其中 $\\kappa$ 是 von Kármán 常数。将此代入我们关于 $\\nu_{t}$ 的表达式中，可得：\n$$\n\\nu_{t}(y) = (\\kappa y)^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\n该表达式可以简化为：\n$$\n\\nu_{t}(y) = \\kappa^{2} y^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\n这就是关于给定参数的涡粘性系数剖面的解析表达式。问题规定 $\\nu_{t}(y)$ 必须是非负的。我们可以验证此条件。von Kármán 常数 $\\kappa$ 是一个正实数（约等于 $0.41$），所以 $\\kappa^{2} > 0$。壁面距离 $y$ 根据定义是非负的，所以 $y^{2} \\ge 0$。任何实数的绝对值都是非负的，所以 $\\left| \\frac{\\partial U}{\\partial y} \\right| \\ge 0$。因此，这些非负项的乘积保证是非负的，满足了约束条件。该表达式被称为零方程模型（因为它不包含湍流物理量的输运方程），是代数湍流模型中的一个基础性结果。",
            "answer": "$$\n\\boxed{\\nu_t(y) = \\kappa^{2} y^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|}\n$$"
        },
        {
            "introduction": "理论模型在应用于实际计算时，往往需要根据物理现实进行修正。基础的代数涡粘模型，如Smagorinsky模型，在近壁区域存在严重的物理缺陷，即无法正确预测涡粘度在壁面处应趋于零的行为。本实践练习要求你通过编程，不仅要复现这一缺陷，更要亲手实现van Driest阻尼函数这一经典修正方法，直观地观察其如何改善模型的近壁性能。",
            "id": "3942982",
            "problem": "考虑航空航天计算流体动力学 (CFD) 中使用的壁面束缚湍流的大涡模拟 (LES)。从雷诺分解和滤波方程中亚格子应力的 Boussinesq 涡黏性假设出发，该假设断言亚格子应力张量的偏量部分与解析尺度应变率张量成正比。使用量纲分析和核心定义来构建和分析一个代数涡黏性模型，然后修改它以符合近壁物理。\n\n您必须从第一性原理出发，完成以下任务：\n\n1. 使用 Boussinesq 涡黏性假设（即亚格子尺度应力与解析尺度应变率成正比）和基本量纲分析，推导出一个涡黏性的代数形式，该形式依赖于一个速度梯度尺度和一个长度尺度。证明涡黏性与特征滤波长度的平方和解析应变率的大小成正比。使用一个无量纲常数使该比例关系在量纲上保持一致。不要先验地假设任何特定的前置因子；要通过量纲推理推导出来。\n\n2. 对于位于 $y=0$ 处的平面壁面，其边界条件为无滑移，请根据壁面摩擦速度 $u_{\\tau}$ 的定义以及近壁湍流脉动的行为，论证为何涡黏性必须满足当 $y \\to 0$ 时 $\\nu_t \\to 0$。使用您推导的代数模型，解析地证明如果解析应变率大小 $|S|$ 在壁面处保持有限，则无阻尼代数模型预测的 $\\nu_t$ 在 $y=0$ 处不为零，因此会高估近壁的涡黏性。给出当 $y \\to 0$ 时的极限行为。\n\n3. 引入一个 van Driest 型阻尼函数 $f_d(y^+)$，该函数依赖于无量纲壁面距离 $y^+$，并强制 $f_d(0)=0$ 和当 $y^+ \\to \\infty$ 时 $f_d(y^+)\\to 1$。定义摩擦雷诺数坐标 $y^+$ 为 $y^+ = \\dfrac{y\\,u_{\\tau}}{\\nu}$，其中 $y$ 是壁面法向坐标，单位为 $\\mathrm{m}$，$u_{\\tau}$ 是摩擦速度，单位为 $\\mathrm{m/s}$，$\\nu$ 是运动黏度，单位为 $\\mathrm{m^2/s}$。使用一个由阻尼常数 $A^+$ 和控制近壁陡度的整数指数 $n$ 表征的指数型 van Driest 函数形式。您的实现必须确保阻尼后的涡黏性在 $y \\to 0$ 时恢复为 $\\nu_t \\to 0$，并在远离壁面时 $\\nu_t$ 接近无阻尼值。\n\n4. 实现一个程序，对于每个测试用例，计算：\n   - 根据您在任务 1 中的推导得出的无阻尼代数涡黏性，\n   - 无量纲壁面距离 $y^+$，\n   - van Driest 型阻尼 $f_d(y^+)$，\n   - 通过将 $f_d(y^+)$ 作为受指数 $n$ 控制的乘法因子应用于无阻尼模型而得到的阻尼涡黏性。\n\n所有涡黏性必须以 $\\mathrm{m^2/s}$ 为单位返回，并四舍五入到 $6$ 位小数。\n\n使用的定义：\n- $y^+ = \\dfrac{y\\,u_{\\tau}}{\\nu}$，其中 $y$ 单位为 $\\mathrm{m}$，$u_{\\tau}$ 单位为 $\\mathrm{m/s}$，$\\nu$ 单位为 $\\mathrm{m^2/s}$。\n- van Driest 型阻尼函数 $f_d(y^+)$ 是一个关于 $y^+$ 的指数函数，带有参数 $A^+$ 和 $n$，使得 $f_d(0)=0$ 且当 $y^+ \\to \\infty$ 时 $f_d(y^+)\\to 1$。\n\n计算用的模型参数：\n- 模型常数 $C_s$ 是无量纲的。\n- 滤波宽度 $\\Delta$ 单位为 $\\mathrm{m}$。\n- 解析应变率大小 $|S|$ 单位为 $\\mathrm{s^{-1}}$。\n- 摩擦速度 $u_{\\tau}$ 单位为 $\\mathrm{m/s}$。\n- 壁面法向距离 $y$ 单位为 $\\mathrm{m}$。\n- 运动黏度 $\\nu$ 单位为 $\\mathrm{m^2/s}$。\n- van Driest 常数 $A^+$ 是无量纲的。\n- 阻尼指数 $n$ 是一个整数。\n\n测试套件：\n为以下参数集提供输出。对于每种情况，计算并返回 $[\\nu_{t,\\mathrm{undamped}},\\,\\nu_{t,\\mathrm{damped}}]$ 对，单位为 $\\mathrm{m^2/s}$，每个值都四舍五入到 $6$ 位小数。\n\n- 情况 1 (典型的近壁湍流):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 200\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 0.001\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\n- 情况 2 (精确的壁面，展示无阻尼时的过高预测):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 200\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 0\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\n- 情况 3 (非常靠近壁面， $y^+$ 很小):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 200\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 5\\times 10^{-6}\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\n- 情况 4 (远离壁面， $y^+$ 很大：阻尼应可忽略不计):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 200\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 0.1\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\n- 情况 5 (高应变率大小敏感性):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 5000\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 0.001\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\n最终输出格式：\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表。每个元素对应一个测试用例，本身是一个形式为 $[\\nu_{t,\\mathrm{undamped}},\\nu_{t,\\mathrm{damped}}]$ 的双元素列表。例如，格式为 $[[r_1^{(u)},r_1^{(d)}],[r_2^{(u)},r_2^{(d)}],\\dots]$，其中所有 $r$ 值都四舍五入到 $6$ 位小数，并以 $\\mathrm{m^2/s}$ 表示。",
            "solution": "该问题具有科学依据，内容自洽，且定义明确。它展示了从第一性原理出发，为大涡模拟 (LES) 开发亚格子尺度湍流模型的标准（尽管简化了的）过程，这与计算流体动力学中的既定实践相符。所有必要的参数和定义都已提供，任务逻辑上是顺序的，从而导向一个唯一且可验证的解。因此，该问题是有效的。我们继续进行求解。\n\n解决方案按问题陈述中描述的四个部分呈现。\n\n**1. 代数涡黏性模型的推导**\n\n适用于 LES 的 Boussinesq 涡黏性假设假定，亚格子尺度 (SGS) 应力张量的各向异性部分 $\\tau_{ij}^{\\text{dev}}$ 与解析尺度应变率张量 $\\bar{S}_{ij}$ 呈线性正比关系。此关系表示为：\n$$\n\\tau_{ij}^{\\text{dev}} = \\tau_{ij} - \\frac{1}{3}\\tau_{kk}\\delta_{ij} = -2\\nu_t \\bar{S}_{ij}\n$$\n这里，$\\tau_{ij}$ 是 SGS 应力张量，$\\tau_{kk}$ 是其迹，$\\delta_{ij}$ 是 Kronecker delta，$\\bar{S}_{ij} = \\frac{1}{2}(\\frac{\\partial \\bar{u}_i}{\\partial x_j} + \\frac{\\partial \\bar{u}_j}{\\partial x_i})$ 是滤波（解析）速度场 $\\bar{u}_i$ 的应变率张量，$\\nu_t$ 是标量亚格子尺度涡黏性。\n\n为了构建一个 $\\nu_t$ 的模型，我们进行量纲分析。涡黏性代表了未解析的亚格子尺度对解析流动的运动学效应。其量纲为长度的平方除以时间，即 $[\\nu_t] = L^2 T^{-1}$。在 LES 中，亚格子尺度的物理是基于最小的解析尺度来建模的。从解析场中可以获得的两个基本特征尺度是：\n1. 一个特征长度尺度，即滤波宽度 $\\Delta$。其量纲为 $[\\Delta] = L$。\n2. 一个特征时间尺度，它源于解析应变率张量的大小 $|S| = (2\\bar{S}_{ij}\\bar{S}_{ij})^{1/2}$。其量纲为 $[|S|] = T^{-1}$。\n\n我们寻求 $\\Delta$ 和 $|S|$ 的一种组合，使其产生 $\\nu_t$ 的量纲。让我们假设一个形式为：\n$$\n\\nu_t \\propto \\Delta^a |S|^b\n$$\n的关系，其中 $a$ 和 $b$ 是待定指数。匹配量纲：\n$$\nL^2 T^{-1} = [L]^a [T^{-1}]^b = L^a T^{-b}\n$$\n对每个量纲的指数进行等价，得到一个由两个线性方程组成的方程组：\n对于长度 ($L$)：$a = 2$\n对于时间 ($T$)：$-b = -1 \\implies b = 1$\n\n因此，量纲分析决定了涡黏性必须具有以下形式：\n$$\n\\nu_t \\propto \\Delta^2 |S|\n$$\n为了将此比例关系转换为方程，我们引入一个无量纲的比例常数。根据 Smagorinsky 模型的惯例，此常数表示为 Smagorinsky 常数 $C_s$ 的平方。因此，代数涡黏性模型为：\n$$\n\\nu_t = C_s^2 \\Delta^2 |S|\n$$\n这是从量纲推理推导出的 Smagorinsky 模型的基本形式。\n\n**2. 无阻尼模型的近壁行为**\n\n在固体、静止的壁面附近，例如 $y=0$ 处的平面，无滑移边界条件要求所有流体速度分量都为零，即 $\\bar{u}_i(y=0) = 0$。壁面的存在物理上抑制了湍流脉动。因此，所有湍流速度脉动必须在 $y \\to 0$ 时趋于零。涡黏性 $\\nu_t$ 模拟了由这些湍流脉动引起的动量输运。由于脉动本身在壁面处被抑制，相关的输运系数也必须为零。物理上，在紧邻壁面的区域（黏性子层），动量输运由分子黏度 $\\nu$ 主导，而非湍流涡黏性。因此，任何物理上正确的模型都必须满足以下条件：\n$$\n\\lim_{y \\to 0} \\nu_t = 0\n$$\n现在让我们检验我们推导的代数模型 $\\nu_t = C_s^2 \\Delta^2 |S|$ 在 $y \\to 0$ 时的行为。\n参数 $C_s$ 和 $\\Delta$ 对于给定的模拟通常是常数（其中 $\\Delta$ 与近壁的固定网格分辨率有关）。因此，$\\nu_t$ 的行为由解析应变率大小 $|S|$ 的行为决定。对于壁面束缚的剪切流，主导的平均速度分量平行于壁面（例如 $\\bar{u}_1(y)$）。黏性子层中的速度剖面是线性的：$\\bar{u}_1(y) = \\frac{\\tau_w}{\\mu}y$，其中 $\\tau_w$ 是壁面剪切应力，$\\mu$ 是动力黏度。使用定义 $\\tau_w = \\rho u_\\tau^2$ 和 $\\nu = \\mu/\\rho$，这变成 $\\bar{u}_1(y) = \\frac{u_\\tau^2}{\\nu}y$。\n应变率张量的主导分量则为 $\\bar{S}_{12} = \\frac{1}{2} \\frac{d\\bar{u}_1}{dy} = \\frac{1}{2} \\frac{u_\\tau^2}{\\nu}$。因此，壁面处的应变率张量大小是有限且非零的：\n$$\n|S|_{y=0} = \\left| \\frac{d\\bar{u}_1}{dy} \\right|_{y=0} = \\frac{u_\\tau^2}{\\nu} \\neq 0\n$$\n由于 $|S|$ 在 $y = 0$ 处保持有限，无阻尼代数模型预测在壁面处有一个有限、非零的涡黏性：\n$$\n\\lim_{y \\to 0} \\nu_t = C_s^2 \\Delta^2 |S|_{y=0} > 0\n$$\n这与所需的物理行为相矛盾。该模型未能预测 $\\nu_t \\to 0$ 的事实表明，它高估了近壁区域的涡黏性，因此需要修正。\n\n**3. van Driest 阻尼的引入**\n\n为了强制执行正确的近壁物理，我们引入一个阻尼函数 $f_d$，它与无阻尼涡黏性相乘。阻尼后的模型为 $\\nu_{t, \\text{damped}} = f_d \\cdot \\nu_{t, \\text{undamped}}$。此函数必须依赖于与壁面的距离，通常以无量纲形式 $y^+ = \\frac{y u_\\tau}{\\nu}$ 表示。阻尼函数的必要属性是：\n- 它必须在壁面处强制执行零黏性条件：$f_d(y^+=0) = 0$。\n- 它不能改变远离壁面处的模型，因为原始公式在该处更合适：$\\lim_{y^+ \\to \\infty} f_d(y^+) = 1$。\n\n问题指定了一个指数型的 van Driest 阻尼函数 $f_d(y^+)$，由一个无量纲常数 $A^+$ 和一个整数指数 $n$ 表征。满足这些要求的函数是：\n$$\nf_d(y^+) = \\left(1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right)^n\n$$\n让我们验证它的性质。在壁面处 ($y=0 \\implies y^+=0$):\n$$\nf_d(0) = \\left(1 - \\exp(0)\\right)^n = (1 - 1)^n = 0\n$$\n远离壁面 ($y \\to \\infty \\implies y^+ \\to \\infty$):\n$$\n\\lim_{y^+ \\to \\infty} f_d(y^+) = \\left(1 - \\lim_{y^+ \\to \\infty} \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right)^n = (1 - 0)^n = 1\n$$\n该函数满足边界条件。指数 $n$ 控制函数在近壁处的陡度。对于小的 $y^+$，泰勒展开给出 $1 - \\exp(-y^+/A^+) \\approx y^+/A^+$，因此 $f_d(y^+) \\approx (y^+/A^+)^n$。这确保了 $\\nu_{t, \\text{damped}}$ 随着 $y^n$ 趋于零，提供了正确的渐近行为。\n\n**4. 模型实现**\n\n待实现的完整模型包括对每组参数进行以下计算：\n1.  计算无阻尼涡黏性：$\\nu_{t, \\text{undamped}} = C_s^2 \\Delta^2 |S|$。\n2.  计算无量纲壁面距离：$y^+ = \\dfrac{y u_\\tau}{\\nu}$。\n3.  计算 van Driest 型阻尼函数：$f_d(y^+) = \\left(1 - \\exp(-y^+/A^+)\\right)^n$。\n4.  计算阻尼涡黏性：$\\nu_{t, \\text{damped}} = \\nu_{t, \\text{undamped}} \\times f_d(y^+)$。\n\n这些公式将用于处理给定的测试套件。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes undamped and damped eddy viscosity for several test cases\n    based on an algebraic subgrid-scale model with van Driest damping.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a dictionary for clarity of parameters.\n    test_cases = [\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \n            \"y\": 0.001, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \n            \"y\": 0.0, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \n            \"y\": 5e-6, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \n            \"y\": 0.1, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 5000, \"u_tau\": 0.5, \n            \"y\": 0.001, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters for the current case\n        Cs = case[\"Cs\"]\n        Delta = case[\"Delta\"]\n        S_mag = case[\"S_mag\"]\n        u_tau = case[\"u_tau\"]\n        y = case[\"y\"]\n        nu = case[\"nu\"]\n        A_plus = case[\"A_plus\"]\n        n = case[\"n\"]\n        \n        # Task 1: Compute the undamped algebraic eddy viscosity\n        # nu_t_undamped = (Cs * Delta)^2 * |S|\n        nu_t_undamped = (Cs**2) * (Delta**2) * S_mag\n        \n        # Task 2  3: Compute the damping function f_d(y^+)\n        # First, compute the non-dimensional wall distance y_plus\n        if nu == 0:\n            # Handle division by zero, though not expected from problem data\n            y_plus = float('inf') if y > 0 else 0\n        else:\n            y_plus = (y * u_tau) / nu\n        \n        # Second, compute the van Driest damping function f_d(y^+)\n        # f_d = (1 - exp(-y+/A+))^n\n        # The exponentiation is safe due to the negative sign.\n        # np.exp handles large negative arguments by returning 0.0\n        damping_factor_base = 1 - np.exp(-y_plus / A_plus)\n        f_d = damping_factor_base**n\n\n        # Task 4: Compute the damped eddy viscosity\n        nu_t_damped = nu_t_undamped * f_d\n        \n        # Round the results to 6 decimal places as required\n        nu_t_undamped_rounded = round(nu_t_undamped, 6)\n        nu_t_damped_rounded = round(nu_t_damped, 6)\n        \n        results.append([nu_t_undamped_rounded, nu_t_damped_rounded])\n\n    # Final print statement in the exact required format.\n    # Convert list of lists to string representation.\n    result_str = \",\".join([f\"[{u},{d}]\" for u, d in results])\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一个成功的湍流模型不仅要物理上合理，还必须在数值上表现良好。代数模型由于其局部性，可能产生在空间上不光滑的涡粘场 $\\mu_t$，这会在数值求解过程中引发非物理性的振荡。本练习旨在深入探讨这一数值稳定性问题背后的机理，并分析一种先进的解决方法——亥姆霍兹型滤波器，它能够在平滑涡粘场的同时，保持模型的可实现性和对数律一致性。",
            "id": "3942970",
            "problem": "考虑一个密度 $\\rho$ 恒定、动力粘度 $\\mu$ 恒定的平面槽道流，该流动由雷诺平均纳维-斯托克斯 (RANS) 动量方程在 Boussinesq 涡粘性假设下描述。在一维壁面法向坐标 $y$ 中，平均流向速度 $u(y)$ 满足\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}y}\\left[\\left(\\mu + \\mu_t(y)\\right)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right] = -\\frac{\\mathrm{d}p}{\\mathrm{d}x},\n$$\n其中 $\\mu_t(y)$ 是由代数封闭在局部确定的代数涡粘性，而 $-\\mathrm{d}p/\\mathrm{d}x$ 是一个恒定的流向压力梯度。在平衡湍流边界层的对数律层中，平均速度满足对数律 $u^+ = \\left(1/\\kappa\\right)\\ln y^+ + B$，其中 $u^+ = u/u_\\tau$，$y^+ = y u_\\tau/\\nu$，$u_\\tau = \\sqrt{\\tau_w/\\rho}$ 是摩擦速度，$\\nu = \\mu/\\rho$，$\\kappa$ 是 von Kármán 常数，$B$ 是一个常数，$\\tau_w$ 是壁面剪切应力。与对数律的一致性意味着，在平衡对数律层中，$\\mu_t(y)$ 局部地与 $y$呈线性关系，即 $\\mu_t(y) \\propto \\rho \\kappa u_\\tau y$。\n\n要求你从第一性原理出发，分析 $\\mu_t(y)$ 的突变空间变化对离散动量平衡的影响，并确定一种 $\\mu_t$ 的平滑策略，该策略既能保持可实现性（在线性涡粘性模型下，$\\mu_t$ 的非负性和隐含的雷诺应力的有界性），又不会干扰局部的对数律一致性。在你的推理中，请使用以下基本依据：\n- 微分学的乘法法则，它意味着对于一个足够光滑的系数 $a(y)$，有 $\\frac{\\mathrm{d}}{\\mathrm{d}y}\\left[a(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right] = a(y)\\frac{\\mathrm{d}^2 u}{\\mathrm{d}y^2} + a'(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}$。\n- 均匀网格上一维变系数扩散算子的有限体积离散化结构，它在离散通量 $F_{i\\pm 1/2} = a_{i\\pm 1/2}\\left(u_{i\\pm 1} - u_i\\right)/\\Delta y$ 中使用面心系数 $a_{i\\pm 1/2}$，其中 $a(y) = \\mu + \\mu_t(y)$ 且 $\\Delta y$ 是网格间距。\n\n哪个选项正确解释了 $\\mu_t(y)$ 的突变空间变化可能在计算出的 $u(y)$ 中引入数值振荡的机制，并提出了一种能够保持可实现性和局部对数律一致性的 $\\mu_t$ 平滑滤波器？\n\nA. $\\mu_t$ 的突变跳跃会产生大的系数 $a'(y)$，在变系数扩散算子中，该系数的作用类似于一个表观对流项 $a'(y)\\,\\mathrm{d}u/\\mathrm{d}y$。当这个表观对流项在局部占主导地位并用中心差分进行离散化时，可能会出现色散振荡，特别是当相邻面上的 $a_{i+1/2}/a_{i-1/2}$ 比值高度偏斜时。一种保持可实现性和对数律一致性的平滑方法由亥姆霍兹型滤波器给出\n$$\n\\left(I - \\ell^2 \\nabla^2\\right)\\mu_t^{\\,f} = \\mu_t,\n$$\n其局部长度尺度为 $\\ell = C_\\ell \\min\\!\\left(\\kappa y,\\, C_\\Delta \\Delta\\right)$，在固壁处采用齐次 Neumann 边界条件，并进行正性投影 $\\mu_t^{\\,f} \\leftarrow \\max\\!\\left(0,\\, \\mu_t^{\\,f}\\right)$。该滤波器不改变任何局部线性的 $\\mu_t(y)$（因此保持了对数律的 $\\mu_t \\propto y$ 标度关系）并强制 $\\mu_t^{\\,f} \\geq 0$。\n\nB. 振荡的产生是因为 $\\mu_t$ 的突变变化使对流项 $\\rho u\\,\\mathrm{d}u/\\mathrm{d}x$ 失稳，导致问题变为双曲型，需要对 $\\mu_t$ 进行迎风处理。一个合适的修正是使用一个与马赫数相关的限制器对 $\\mu_t$ 进行迎风处理，并在一个5点模板上对 $\\mu_t$ 进行简单的算术平均。这种方法通过其构造保持了可实现性，并且由于平均是局部的，因此维持了对数律。\n\nC. 根本原因是当 $\\mu_t$ 快速变化时，伽利略不变性丧失，从而注入了伪动能。一个具有固定窗口大小 $L$ 的全局移动平均滤波器 $\\mu_t^{\\,f}(y) = \\left(1/L\\right)\\int_{y-L/2}^{y+L/2} \\mu_t(\\eta)\\,\\mathrm{d}\\eta$ 恢复了不变性并自动确保 $\\mu_t$ 非负，同时其全局性再现了正确的对数律标度关系。\n\nD. $\\mu_t$ 的突变变化在椭圆算子中产生刚性，但这不会引起振荡；它只会减慢收敛速度。最好的补救措施是拉普拉斯平滑 $\\mu_t^{\\,f} = \\mu_t + \\alpha \\nabla^2 \\mu_t$，其中 $\\alpha$ 为常数，并在固壁处采用 Dirichlet 边界条件 $\\mu_t^{\\,f} = 0$。这通过边界强制来保证 $\\mu_t^{\\,f} \\geq 0$，并且因为 $\\alpha$ 是常数，所以不影响近壁处的对数律标度关系。\n\n选择正确的选项。",
            "solution": "该问题在科学上是合理的，因为它准确地描述了在计算流体力学（CFD）中应用代数湍流模型时遇到的一个关键数值问题。该问题要求对变系数扩散方程的数值行为以及用于稳定该方程的高级技术有深入的理解。我们逐一分析这些选项。\n\n**选项A的分析：**\n该选项首先正确地指出了问题的根源。给定的动量方程是 $\\frac{\\mathrm{d}}{\\mathrm{d}y}\\left[a(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right] = C$，其中 $a(y) = \\mu + \\mu_t(y)$。应用微分的乘法法则，该方程可以展开为：\n$$\na(y)\\frac{\\mathrm{d}^2 u}{\\mathrm{d}y^2} + a'(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y} = C\n$$\n当涡粘性 $\\mu_t(y)$ 在空间上发生突变时，其导数 $a'(y)$ 会变得非常大。这使得 $a'(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}$ 这一项变得显著，其行为类似于一个“表观对流项”。在数值离散化（例如，使用中心差分）中，如果对流项相对于扩散项占主导地位（即网格佩克莱特数很大），就会导致非物理性的数值振荡。选项A对这一机制的解释是完全正确的。\n\n接下来，该选项提出的解决方案是一个亥姆霍兹型滤波器：$\\left(I - \\ell^2 \\nabla^2\\right)\\mu_t^{\\,f} = \\mu_t$。这是一个隐式的低通滤波器，能够有效地平滑涡粘场。该滤波器有几个关键的优良特性：\n1.  **保持线性剖面**：如果 $\\mu_t$ 是 $y$ 的线性函数（例如，$\\mu_t = C_1 y + C_2$），那么它的二阶导数 $\\nabla^2 \\mu_t$ 为零。在这种情况下，滤波器方程简化为 $\\mu_t^{\\,f} = \\mu_t$，即平滑后的场与原始场相同。由于在对数律区域，$\\mu_t \\propto y$，这个特性保证了滤波器不会干扰对数律的一致性。\n2.  **边界条件**：齐次诺伊曼（Neumann）边界条件 $(\\nabla \\mu_t^{\\,f} \\cdot \\mathbf{n} = 0)$ 是一种非侵入性的边界条件，它确保了滤波操作不会在边界处人为地引入梯度。\n3.  **可实现性**：通过显式的正性投影 $\\mu_t^{\\,f} \\leftarrow \\max(0, \\mu_t^{\\,f})$，可以强制保证平滑后的涡粘性非负，从而满足物理可实现性。\n因此，选项A的诊断和提出的解决方案都是正确且先进的。\n\n**选项B的分析：**\n该选项的解释是错误的。它将不稳定性归因于物理对流项 $\\rho u\\,\\mathrm{d}u/\\mathrm{d}x$，但在所描述的一维充分发展槽道流问题中，这个项恒为零。不稳定性源于扩散项的变系数性质。此外，对系数 $\\mu_t$ 进行“迎风处理”在概念上是错误的；迎风格式适用于被速度场输运的量，而不是应用于一个材料属性或模型系数。\n\n**选项C的分析：**\n该选项的解释也是错误的。伽利略不变性是一个重要的建模原则，但它不是造成这种特定数值振荡的直接原因。此外，一个具有固定窗口大小 $L$ 的全局移动平均滤波器虽然可以平滑数据，但窗口大小 $L$ 的选择是任意的，缺乏物理依据。它不如亥姆霍兹滤波器那样能够优雅地保持对数律所要求的线性剖面，并可能过度模糊物理特征。\n\n**选项D的分析：**\n该选项的解释存在多个错误。首先，它错误地否认了振荡的存在。其次，它提出的“拉普拉斯平滑”$\\mu_t^{\\,f} = \\mu_t + \\alpha \\nabla^2 \\mu_t$ 实际上是一种锐化操作（类似于图像处理中的“反锐化掩模”），它会加剧而不是减弱梯度的突变。一个基于扩散的平滑操作应该求解一个类似于热传导的方程，而不是简单地加上一个拉普拉斯项。最后，狄利克雷（Dirichlet）边界条件 $\\mu_t^{\\,f}=0$ 过于严苛，会人为地破坏近壁区域的模型行为，并且它不能保证在远离壁面的区域涡粘性为非负。\n\n**结论：**\n选项A对问题的物理和数值机制提供了最准确的解释，并提出了一种先进、恰当且理由充分的解决方案，该方案在解决数值问题的同时，尊重了湍流模型的关键物理约束（对数律一致性）和数值约束（可实现性）。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}