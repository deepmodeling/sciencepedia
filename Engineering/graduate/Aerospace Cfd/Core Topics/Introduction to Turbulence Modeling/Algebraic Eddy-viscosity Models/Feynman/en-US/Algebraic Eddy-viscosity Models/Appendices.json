{
    "hands_on_practices": [
        {
            "introduction": "To build a solid understanding of algebraic models, we begin with their historical and conceptual origin. This first practice returns to the foundational mixing-length hypothesis of Prandtl, one of the earliest and most intuitive frameworks for modeling turbulent shear stress. By deriving the eddy viscosity profile from this hypothesis, you will formalize the physical picture of turbulent eddies into a mathematical expression, a crucial first step in comprehending how these models are constructed. ",
            "id": "3943005",
            "problem": "Consider a statistically steady, fully developed, incompressible plane turbulent channel flow between two parallel plates, where the mean velocity is $U(y)$ in the streamwise direction and depends only on the wall-normal coordinate $y$. Let the fluid density be $\\rho$ and the kinematic viscosity be $\\nu$. Assume the Reynolds-averaged Navier–Stokes (RANS) framework and adopt the Boussinesq eddy-viscosity hypothesis, wherein the turbulent Reynolds shear stress $-\\overline{u^{\\prime} v^{\\prime}}$ is modeled as $-\\overline{u^{\\prime} v^{\\prime}} = \\nu_{t} \\, \\partial U / \\partial y$, with $\\nu_{t}$ the eddy viscosity. Further, adopt Prandtl’s mixing-length hypothesis for momentum transport, and assume that in the logarithmic region the mixing length scales linearly with the wall distance as $\\ell = \\kappa \\, y$, where $\\kappa$ is the von Kármán constant and $y$ is the distance from the nearest wall.\n\nStarting only from these modeling assumptions and fundamental definitions, and requiring that the modeled eddy viscosity $ \\nu_{t}(y)$ be nonnegative throughout both halves of the channel, derive the analytical expression for the eddy viscosity profile $ \\nu_{t}(y)$ in terms of $\\kappa$, $y$, and the mean shear $ \\partial U / \\partial y$. Your final answer must be a single closed-form expression.",
            "solution": "The objective is to derive an analytical expression for the eddy viscosity, $\\nu_{t}$, based on the provided hypotheses. The derivation begins by establishing two distinct models for the Reynolds shear stress, $-\\overline{u^{\\prime} v^{\\prime}}$, and then equating them to solve for $\\nu_{t}$.\n\nFirst, we consider Prandtl’s mixing-length hypothesis. This model provides an expression for the Reynolds shear stress in terms of a characteristic length scale, the mixing length $\\ell$, and the local mean velocity gradient. The core idea is that turbulent momentum transport is analogous to molecular transport, but with macroscopic \"lumps\" of fluid, or eddies, moving over a distance $\\ell$ before mixing. The magnitude of the streamwise velocity fluctuation, $|u^{\\prime}|$, is assumed to scale with the change in mean velocity over this distance:\n$$\n|u^{\\prime}| \\propto \\ell \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\nThe model further posits that the wall-normal fluctuation, $v^{\\prime}$, is of the same order of magnitude as $u^{\\prime}$ and is correlated with it. This leads to Prandtl's model for the magnitude of the Reynolds shear stress, $\\tau_{t} = -\\rho \\overline{u^{\\prime} v^{\\prime}}$:\n$$\n\\tau_{t} = \\rho \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}\n$$\nThe term $\\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}$ correctly ensures that the shear stress has the same sign as the strain rate, which is a physical requirement for turbulence production to be a sink of mean kinetic energy. This expression can be rewritten by noting that $\\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y} = \\left(\\frac{\\partial U}{\\partial y}\\right)^2 \\text{sgn}\\left(\\frac{\\partial U}{\\partial y}\\right)$. For our purposes, it is more convenient to use the kinematic Reynolds shear stress, $-\\overline{u^{\\prime} v^{\\prime}} = \\tau_{t} / \\rho$. Dividing the above equation by the density $\\rho$ gives:\n$$\n-\\overline{u^{\\prime} v^{\\prime}} = \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}\n$$\n\nSecond, we invoke the Boussinesq eddy-viscosity hypothesis, which is explicitly provided in the problem statement. This hypothesis models the Reynolds shear stress tensor as being linearly proportional to the mean strain rate tensor, analogous to the Newtonian stress-strain relationship for laminar flow. For the specific case of a plane channel flow where the only non-zero mean velocity gradient is $\\frac{\\partial U}{\\partial y}$, the hypothesis simplifies to a scalar relationship for the shear component:\n$$\n-\\overline{u^{\\prime} v^{\\prime}} = \\nu_{t} \\frac{\\partial U}{\\partial y}\n$$\nHere, $\\nu_{t}$ is the turbulent or eddy viscosity, which, unlike the molecular kinematic viscosity $\\nu$, is not a fluid property but a property of the flow state.\n\nNow, we equate the two expressions for the Reynolds shear stress $-\\overline{u^{\\prime} v^{\\prime}}$:\n$$\n\\nu_{t} \\frac{\\partial U}{\\partial y} = \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}\n$$\nTo solve for $\\nu_{t}$, we can divide both sides by $\\frac{\\partial U}{\\partial y}$. This operation is valid for regions of the flow where $\\frac{\\partial U}{\\partial y} \\neq 0$. In a turbulent channel flow, the mean shear is non-zero everywhere except at the channel centerline, where the velocity profile is symmetric. Away from the centerline, we obtain:\n$$\n\\nu_{t} = \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\n\nThe final step is to substitute the specific form of the mixing length, $\\ell$, as given in the problem statement for the logarithmic region of the flow. The assumption is that the mixing length scales linearly with the distance from the nearest wall, $y$:\n$$\n\\ell = \\kappa y\n$$\nwhere $\\kappa$ is the von Kármán constant. Substituting this into our expression for $\\nu_{t}$ yields:\n$$\n\\nu_{t}(y) = (\\kappa y)^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\nThis expression can be simplified to:\n$$\n\\nu_{t}(y) = \\kappa^{2} y^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\nThis is the analytical expression for the eddy viscosity profile in terms of the given parameters. The problem stipulates that $\\nu_{t}(y)$ must be nonnegative. We can verify this condition. The von Kármán constant $\\kappa$ is a positive real number (approximately $0.41$), so $\\kappa^{2} > 0$. The wall distance $y$ is, by definition, nonnegative, so $y^{2} \\ge 0$. The absolute value of any real number is nonnegative, so $\\left| \\frac{\\partial U}{\\partial y} \\right| \\ge 0$. The product of these nonnegative terms is therefore guaranteed to be nonnegative, satisfying the constraint. This expression, known as a zero-equation model (as it contains no transport equations for turbulence quantities), is a foundational result in algebraic turbulence modeling.",
            "answer": "$$\n\\boxed{\\nu_t(y) = \\kappa^{2} y^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|}\n$$"
        },
        {
            "introduction": "While simple algebraic models provide a powerful starting point, their direct application often fails in flows of practical interest, most notably near solid boundaries. This exercise confronts this critical issue within the context of Large-Eddy Simulation (LES), demonstrating how the basic Smagorinsky model over-predicts dissipation at the wall. You will then implement the famous van Driest damping function, a cornerstone of wall-modeling, to correct this unphysical behavior and gain hands-on experience in adapting theoretical models for real-world application. ",
            "id": "3942982",
            "problem": "Consider Large-Eddy Simulation (LES) of wall-bounded turbulent flow as used in aerospace Computational Fluid Dynamics (CFD). Begin from the Reynolds decomposition and the Boussinesq eddy-viscosity hypothesis for the subgrid stress in filtered equations, which asserts that the deviatoric part of the subgrid stress tensor is proportional to the resolved strain-rate tensor. Use dimensional analysis and core definitions to construct and analyze an algebraic eddy-viscosity model and then modify it to respect near-wall physics.\n\nYou must carry out the following tasks, derived from first principles:\n\n1. Using the Boussinesq eddy-viscosity hypothesis, which states that the subgrid-scale stress is proportional to the resolved strain-rate, and basic dimensional analysis, derive an algebraic form for the eddy viscosity that depends on a velocity gradient scale and a length scale. Show that the eddy viscosity is proportional to the square of a characteristic filter length and the magnitude of a resolved strain-rate. Use a dimensionless constant to make the proportionality dimensionally consistent. Do not assume any particular prefactor a priori; deduce it from dimensional reasoning.\n\n2. For a plane wall at $y=0$ with the no-slip boundary condition, argue using the definition of wall friction velocity $u_{\\tau}$ and the behavior of turbulent fluctuations near the wall, why the eddy viscosity must satisfy $\\nu_t \\to 0$ as $y \\to 0$. Using your derived algebraic model, demonstrate analytically that if the resolved strain-rate magnitude $|S|$ remains finite at the wall, then the undamped algebraic model predicts $\\nu_t$ that does not vanish at $y=0$, hence overpredicts near-wall eddy viscosity. Provide the limiting behavior as $y \\to 0$.\n\n3. Introduce a van Driest-type damping function $f_d(y^+)$ that depends on the nondimensional wall distance $y^+$ and enforces $f_d(0)=0$ and $f_d(y^+)\\to 1$ as $y^+ \\to \\infty$. Define the friction Reynolds coordinate $y^+$ by $y^+ = \\frac{y u_{\\tau}}{\\nu}$, where $y$ is the wall-normal coordinate in $\\mathrm{m}$, $u_{\\tau}$ is the friction velocity in $\\mathrm{m/s}$, and $\\nu$ is the kinematic viscosity in $\\mathrm{m^2/s}$. Use an exponential van Driest-type form characterized by a damping constant $A^+$ and an integer exponent $n$ that controls the near-wall steepness. Your implementation must ensure that the damped eddy viscosity recovers $\\nu_t \\to 0$ as $y \\to 0$ and $\\nu_t$ approaches the undamped value far from the wall.\n\n4. Implement a program that, for each test case, computes:\n   - the undamped algebraic eddy viscosity from your derivation in Task $1$,\n   - the nondimensional wall distance $y^+$,\n   - the van Driest-type damping $f_d(y^+)$,\n   - the damped eddy viscosity given by applying $f_d(y^+)$ to the undamped model as a multiplicative factor controlled by the exponent $n$.\n\nAll eddy viscosities must be returned in $\\mathrm{m^2/s}$ and rounded to $6$ decimal places.\n\nDefinitions to use:\n- $y^+ = \\frac{y u_{\\tau}}{\\nu}$ with $y$ in $\\mathrm{m}$, $u_{\\tau}$ in $\\mathrm{m/s}$, and $\\nu$ in $\\mathrm{m^2/s}$.\n- A van Driest-type damping function $f_d(y^+)$ is an exponential function of $y^+$ with parameters $A^+$ and $n$ such that $f_d(0)=0$ and $f_d(y^+)\\to 1$ as $y^+ \\to \\infty$.\n\nModel parameters for computation:\n- The model constant $C_s$ is dimensionless.\n- The filter width $\\Delta$ is in $\\mathrm{m}$.\n- The resolved strain-rate magnitude $|S|$ is in $\\mathrm{s^{-1}}$.\n- The friction velocity $u_{\\tau}$ is in $\\mathrm{m/s}$.\n- The wall-normal distance $y$ is in $\\mathrm{m}$.\n- The kinematic viscosity $\\nu$ is in $\\mathrm{m^2/s}$.\n- The van Driest constant $A^+$ is dimensionless.\n- The damping exponent $n$ is an integer.\n\nTest suite:\nProvide outputs for the following parameter sets. For each case, compute and return the pair $[\\nu_{t,\\mathrm{undamped}},\\,\\nu_{t,\\mathrm{damped}}]$ in $\\mathrm{m^2/s}$, each rounded to $6$ decimal places.\n\n- Case $1$ (typical near-wall turbulent flow):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 200\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 0.001\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\n- Case $2$ (exact wall, demonstrating overprediction without damping):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 200\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 0\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\n- Case $3$ (very near wall with small $y^+$):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 200\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 5\\times 10^{-6}\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\n- Case $4$ (far from wall, $y^+$ large: damping should be negligible):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 200\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 0.1\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\n- Case $5$ (high strain-rate magnitude sensitivity):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 5000\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 0.001\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one test case and is itself a two-element list of the form $[\\nu_{t,\\mathrm{undamped}},\\nu_{t,\\mathrm{damped}}]$. For example, the format is $[[r_1^{(u)},r_1^{(d)}],[r_2^{(u)},r_2^{(d)}],\\dots]$ with all $r$ rounded to $6$ decimal places and expressed in $\\mathrm{m^2/s}$.",
            "solution": "The solution is presented in four parts as delineated by the problem statement.\n\n**1. Derivation of the Algebraic Eddy-Viscosity Model**\n\nThe Boussinesq eddy-viscosity hypothesis, adapted for LES, posits that the anisotropic part of the subgrid-scale (SGS) stress tensor, $\\tau_{ij}^{\\text{dev}}$, is linearly proportional to the resolved-scale strain-rate tensor, $\\bar{S}_{ij}$. This relationship is expressed as:\n$$\n\\tau_{ij}^{\\text{dev}} = \\tau_{ij} - \\frac{1}{3}\\tau_{kk}\\delta_{ij} = -2\\nu_t \\bar{S}_{ij}\n$$\nHere, $\\tau_{ij}$ is the SGS stress tensor, $\\tau_{kk}$ is its trace, $\\delta_{ij}$ is the Kronecker delta, $\\bar{S}_{ij} = \\frac{1}{2}(\\frac{\\partial \\bar{u}_i}{\\partial x_j} + \\frac{\\partial \\bar{u}_j}{\\partial x_i})$ is the strain-rate tensor of the filtered (resolved) velocity field $\\bar{u}_i$, and $\\nu_t$ is the scalar subgrid-scale eddy viscosity.\n\nTo construct a model for $\\nu_t$, we perform a dimensional analysis. The eddy viscosity represents the kinematic effect of the unresolved, subgrid scales on the resolved flow. Its dimensions are length squared per unit time, $[\\nu_t] = L^2 T^{-1}$. In LES, the physics of the subgrid scales are modeled based on the smallest resolved scales. The two fundamental characteristic scales available from the resolved field are:\n1. A characteristic length scale, which is the filter width, $\\Delta$. Its dimension is $[\\Delta] = L$.\n2. A characteristic time scale, which is derived from the magnitude of the resolved strain-rate tensor, $|S| = (2\\bar{S}_{ij}\\bar{S}_{ij})^{1/2}$. Its dimension is $[|S|] = T^{-1}$.\n\nWe seek a combination of $\\Delta$ and $|S|$ that yields the dimensions of $\\nu_t$. Let us postulate a relationship of the form:\n$$\n\\nu_t \\propto \\Delta^a |S|^b\n$$\nwhere $a$ and $b$ are exponents to be determined. Matching the dimensions:\n$$\nL^2 T^{-1} = [L]^a [T^{-1}]^b = L^a T^{-b}\n$$\nEquating the exponents for each dimension yields a system of two linear equations:\nFor length ($L$): $a = 2$\nFor time ($T$): $-b = -1 \\implies b = 1$\n\nThus, dimensional analysis dictates that the eddy viscosity must be of the form:\n$$\n\\nu_t \\propto \\Delta^2 |S|\n$$\nTo convert this proportionality into an equation, we introduce a dimensionless constant of proportionality. By convention in the Smagorinsky model, this constant is denoted as the square of the Smagorinsky constant, $C_s$. Therefore, the algebraic eddy-viscosity model is:\n$$\n\\nu_t = C_s^2 \\Delta^2 |S|\n$$\nThis is the fundamental form of the Smagorinsky model, derived from dimensional reasoning.\n\n**2. Near-Wall Behavior of the Undamped Model**\n\nNear a solid, stationary wall, such as the plane at $y=0$, the no-slip boundary condition requires that all fluid velocity components vanish, i.e., $\\bar{u}_i(y=0) = 0$. The presence of the wall physically damps turbulent fluctuations. As a result, all turbulent velocity fluctuations must approach zero as $y \\to 0$. The eddy viscosity, $\\nu_t$, models the momentum transport by these turbulent fluctuations. Since the fluctuations themselves are quenched at the wall, the associated transport coefficient must also vanish. Physically, in the immediate vicinity of the wall (the viscous sublayer), momentum transport is dominated by molecular viscosity, $\\nu$, not turbulent eddy viscosity. Consequently, any physically correct model must satisfy the condition:\n$$\n\\lim_{y \\to 0} \\nu_t = 0\n$$\nLet us now examine the behavior of our derived algebraic model, $\\nu_t = C_s^2 \\Delta^2 |S|$, as $y \\to 0$.\nThe parameters $C_s$ and $\\Delta$ are typically constants for a given simulation (with $\\Delta$ being related to the fixed grid resolution near the wall). The behavior of $\\nu_t$ is therefore determined by the behavior of the resolved strain-rate magnitude, $|S|$. For a wall-bounded shear flow, the dominant mean velocity component is parallel to the wall (e.g., $\\bar{u}_1(y)$). The velocity profile in the viscous sublayer is linear: $\\bar{u}_1(y) = \\frac{\\tau_w}{\\mu}y$, where $\\tau_w$ is the wall shear stress and $\\mu$ is the dynamic viscosity. Using the definitions $\\tau_w = \\rho u_\\tau^2$ and $\\nu = \\mu/\\rho$, this becomes $\\bar{u}_1(y) = \\frac{u_\\tau^2}{\\nu}y$.\nThe dominant component of the strain-rate tensor is then $\\bar{S}_{12} = \\frac{1}{2} \\frac{d\\bar{u}_1}{dy} = \\frac{1}{2} \\frac{u_\\tau^2}{\\nu}$. The magnitude of the strain-rate tensor at the wall is therefore finite and non-zero:\n$$\n|S|_{y=0} = \\sqrt{2 \\left( \\left(\\frac{d\\bar{u}_1}{dy}\\right)^2_{y=0} \\right)} = \\left| \\frac{d\\bar{u}_1}{dy} \\right|_{y=0} = \\frac{u_\\tau^2}{\\nu} \\neq 0\n$$\nSince $|S|$ remains finite at $y = 0$, the undamped algebraic model predicts a finite, non-zero eddy viscosity at the wall:\n$$\n\\lim_{y \\to 0} \\nu_t = C_s^2 \\Delta^2 |S|_{y=0} > 0\n$$\nThis contradicts the required physical behavior. The model's failure to predict $\\nu_t \\to 0$ demonstrates its overprediction of eddy viscosity in the near-wall region, necessitating a correction.\n\n**3. Introduction of van Driest Damping**\n\nTo enforce the correct near-wall physics, we introduce a damping function, $f_d$, that multiplies the undamped eddy viscosity. The damped model is $\\nu_{t, \\text{damped}} = f_d \\cdot \\nu_{t, \\text{undamped}}$. This function must depend on the distance from the wall, typically expressed in nondimensional form as $y^+ = \\frac{y u_\\tau}{\\nu}$. The required properties of the damping function are:\n- It must enforce the zero-viscosity condition at the wall: $f_d(y^+=0) = 0$.\n- It must not alter the model far from the wall, where the original formulation is more appropriate: $\\lim_{y^+ \\to \\infty} f_d(y^+) = 1$.\n\nThe problem specifies an exponential van Driest-type damping function, $f_d(y^+)$, characterized by a dimensionless constant $A^+$ and an integer exponent $n$. A function that satisfies these requirements is:\n$$\nf_d(y^+) = \\left(1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right)^n\n$$\nLet us verify its properties. At the wall ($y=0 \\implies y^+=0$):\n$$\nf_d(0) = \\left(1 - \\exp(0)\\right)^n = (1 - 1)^n = 0\n$$\nFar from the wall ($y \\to \\infty \\implies y^+ \\to \\infty$):\n$$\n\\lim_{y^+ \\to \\infty} f_d(y^+) = \\left(1 - \\lim_{y^+ \\to \\infty} \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right)^n = (1 - 0)^n = 1\n$$\nThe function fulfills the boundary conditions. The exponent $n$ controls the steepness of the function near the wall. For small $y^+$, a Taylor expansion gives $1 - \\exp(-y^+/A^+) \\approx y^+/A^+$, so $f_d(y^+) \\approx (y^+/A^+)^n$. This ensures that $\\nu_{t, \\text{damped}}$ approaches zero as $y^n$, providing the correct asymptotic behavior.\n\n**4. Model Implementation**\n\nThe complete model to be implemented consists of the following calculations for each set of parameters:\n1.  Compute the undamped eddy viscosity: $\\nu_{t, \\text{undamped}} = C_s^2 \\Delta^2 |S|$.\n2.  Compute the nondimensional wall distance: $y^+ = \\dfrac{y u_\\tau}{\\nu}$.\n3.  Compute the van Driest-type damping function: $f_d(y^+) = \\left(1 - \\exp(-y^+/A^+)\\right)^n$.\n4.  Compute the damped eddy viscosity: $\\nu_{t, \\text{damped}} = \\nu_{t, \\text{undamped}} \\times f_d(y^+)$.\n\nThese formulas will be used to process the given test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes undamped and damped eddy viscosity for several test cases\n    based on an algebraic subgrid-scale model with van Driest damping.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a dictionary for clarity of parameters.\n    test_cases = [\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \n            \"y\": 0.001, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \n            \"y\": 0.0, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \n            \"y\": 5e-6, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \n            \"y\": 0.1, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 5000, \"u_tau\": 0.5, \n            \"y\": 0.001, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters for the current case\n        Cs = case[\"Cs\"]\n        Delta = case[\"Delta\"]\n        S_mag = case[\"S_mag\"]\n        u_tau = case[\"u_tau\"]\n        y = case[\"y\"]\n        nu = case[\"nu\"]\n        A_plus = case[\"A_plus\"]\n        n = case[\"n\"]\n        \n        # Task 1: Compute the undamped algebraic eddy viscosity\n        # nu_t_undamped = (Cs * Delta)^2 * |S|\n        nu_t_undamped = (Cs**2) * (Delta**2) * S_mag\n        \n        # Task 2 and 3: Compute the damping function f_d(y^+)\n        # First, compute the non-dimensional wall distance y_plus\n        if nu == 0:\n            # Handle division by zero, though not expected from problem data\n            y_plus = float('inf') if y > 0 else 0\n        else:\n            y_plus = (y * u_tau) / nu\n        \n        # Second, compute the van Driest damping function f_d(y^+)\n        # f_d = (1 - exp(-y+/A+))^n\n        # The exponentiation is safe due to the negative sign.\n        # np.exp handles large negative arguments by returning 0.0\n        damping_factor_base = 1 - np.exp(-y_plus / A_plus)\n        f_d = damping_factor_base**n\n\n        # Task 4: Compute the damped eddy viscosity\n        nu_t_damped = nu_t_undamped * f_d\n        \n        # Round the results to 6 decimal places as required\n        nu_t_undamped_rounded = round(nu_t_undamped, 6)\n        nu_t_damped_rounded = round(nu_t_damped, 6)\n        \n        results.append([nu_t_undamped_rounded, nu_t_damped_rounded])\n\n    # Final print statement in the exact required format.\n    # Convert list of lists to string representation.\n    result_str = \",\".join([f\"[{u},{d}]\" for u, d in results])\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice shifts our focus from model formulation to its physical consequences. Algebraic eddy-viscosity models fundamentally act as a sink of energy for the resolved scales of motion, and the model constants directly control the strength of this dissipation. Through a simplified numerical simulation of decaying isotropic turbulence, you will directly observe and quantify how varying the Smagorinsky constant, $C_s$, alters the energy spectrum and the effective Reynolds number of the flow. ",
            "id": "3942950",
            "problem": "You are to write a complete, runnable program that models decaying three-dimensional isotropic turbulence under an algebraic eddy-viscosity closure and quantifies how the Smagorinsky constant influences the dissipation range and an effective Reynolds number. Your program must numerically solve a simplified spectral decay model and report two metrics at a specified final time for a set of Smagorinsky constants. All variables are in the International System of Units (SI), and all final numerical answers must be reported in the units explicitly requested below.\n\nFundamental base and modeling assumptions:\n- Consider incompressible, isotropic turbulence with kinetic energy spectrum $E(k,t)$, where $k$ is the wavenumber magnitude and $t$ is time. The kinetic energy per unit mass is $K(t) = \\int_{0}^{\\infty} E(k,t)\\,dk$. The kinetic energy dissipation rate is $\\varepsilon(t) = 2\\,\\nu_{\\text{eff}}(t)\\int_{0}^{\\infty} k^{2} E(k,t)\\,dk$, where $\\nu_{\\text{eff}}(t)$ is the total effective kinematic viscosity.\n- Use an algebraic eddy-viscosity closure of Smagorinsky form: $\\nu_{t}(t) = (C_{s}\\,\\Delta)^{2}\\,\\lvert S \\rvert(t)$, where $C_{s}$ is the Smagorinsky constant, $\\Delta$ is a constant filter width, and $\\lvert S \\rvert(t) = \\sqrt{2\\,\\langle S_{ij}S_{ij}\\rangle(t)}$. For homogeneous isotropic turbulence, relate the mean square strain to the spectrum by $\\langle S_{ij}S_{ij}\\rangle(t) = \\int_{0}^{\\infty} k^{2} E(k,t)\\,dk$. Hence, $\\lvert S \\rvert(t) = \\sqrt{2\\int_{0}^{\\infty} k^{2} E(k,t)\\,dk}$. The total effective viscosity is $\\nu_{\\text{eff}}(t) = \\nu + \\nu_{t}(t)$, where $\\nu$ is the molecular kinematic viscosity.\n- Neglect nonlinear spectral transfer and forcing. Under this approximation, the spectral energy evolves via the dissipative balance $\\partial E/\\partial t = -\\,2\\,\\nu_{\\text{eff}}(t)\\,k^{2}\\,E(k,t)$, with $\\nu_{\\text{eff}}(t)$ depending on the instantaneous spectrum through $\\nu_{t}(t)$ as specified above. This represents a mean-field decay model consistent with energy dissipation by an algebraic eddy-viscosity.\n\nInitialization and numerical discretization:\n- Define the initial spectrum as $E(k,0) = A\\,k^{4}\\,\\exp\\!\\left[-\\,\\big(k/k_{p}\\big)^{2}\\right]$ over a finite band $k\\in[k_{\\min},k_{\\max}]$, with $E(k,0)=0$ outside this band. Choose the constant $A$ such that the initial kinetic energy is $K(0)=\\int_{k_{\\min}}^{k_{\\max}} E(k,0)\\,dk = K_{0}$. Use numerical quadrature to determine $A$.\n- Evolve $E(k,t)$ on a uniform wavenumber grid with $N_{k}$ points between $k_{\\min}$ and $k_{\\max}$ using time steps of size $\\Delta t$ from $t=0$ to $t=t_{\\text{end}}$. At each time step, update the spectrum by integrating the dissipative balance using an exponential update consistent with the instantaneous $\\nu_{\\text{eff}}(t)$ held constant over the step.\n\nMetrics to compute at final time:\n- The root-mean-square velocity is $u_{\\mathrm{rms}}(t) = \\sqrt{2K(t)/3}$, where $K(t) = \\int_{k_{\\min}}^{k_{\\max}} E(k,t)\\,dk$.\n- The integral length scale is $L(t) = \\frac{\\pi}{2\\,u_{\\mathrm{rms}}^{2}(t)} \\int_{k_{\\min}}^{k_{\\max}} \\frac{E(k,t)}{k}\\,dk$.\n- Define the effective Reynolds number as $Re_{\\mathrm{eff}}(t) = \\frac{u_{\\mathrm{rms}}(t)\\,L(t)}{\\nu_{\\mathrm{eff}}(t)}$, where $\\nu_{\\mathrm{eff}}(t)$ is as above.\n- Estimate a Kolmogorov dissipation wavenumber using the total effective viscosity at $t_{\\text{end}}$ via $k_{\\eta}(t) = \\left(\\frac{\\varepsilon(t)}{\\nu_{\\mathrm{eff}}^{3}(t)}\\right)^{1/4}$, with $\\varepsilon(t) = 2\\,\\nu_{\\mathrm{eff}}(t)\\int_{k_{\\min}}^{k_{\\max}} k^{2} E(k,t)\\,dk$.\n\nParameter values:\n- Use $K_{0} = 1.0$ (m$^{2}$/s$^{2}$), $\\nu = 1.5\\times 10^{-5}$ (m$^{2}$/s), $\\Delta = 1.0\\times 10^{-2}$ (m), $k_{p} = 10.0$ (m$^{-1}$), $k_{\\min} = 0.5$ (m$^{-1}$), $k_{\\max} = 200.0$ (m$^{-1}$), $N_{k} = 4096$, $\\Delta t = 2.0\\times 10^{-4}$ (s), and $t_{\\text{end}} = 0.02$ (s). All angles (if any) are not applicable here. All quantities are in SI units; report $k_{\\eta}$ in inverse meters (m$^{-1}$) and $Re_{\\mathrm{eff}}$ as a dimensionless number.\n\nTest suite:\n- The only varying parameter is the Smagorinsky constant $C_{s}$. Run the model for the following five cases: $C_{s}\\in\\{0.00,\\,0.10,\\,0.18,\\,0.24,\\,0.30\\}$.\n- For each case, compute at $t=t_{\\text{end}}$ the pair $(k_{\\eta},\\,Re_{\\mathrm{eff}})$ using the definitions above.\n\nRequired final output format:\n- Your program should produce a single line of output containing a comma-separated list with ten floating-point numbers corresponding to the five cases in the order given, each case contributing two numbers in the order $k_{\\eta}$ (in m$^{-1}$) then $Re_{\\mathrm{eff}}$ (dimensionless). Use decimal notation rounded to six digits after the decimal point. The output must be enclosed in square brackets. For example, an output with two cases would look like \"[keta1,Reeff1,keta2,Reeff2]\". In this problem there are five cases, so the output should contain ten numbers.\n\nScientific realism and scope:\n- This problem intentionally isolates the dissipative effect of an algebraic eddy-viscosity model on a decaying isotropic spectrum by neglecting nonlinear transfer. This controlled approximation is used to directly expose how varying $C_{s}$ modifies the dissipation range and the effective Reynolds number through $\\nu_{t}(t)$. All parameter choices are within plausible ranges for air and laboratory-scale isotropic turbulence surrogates.\n\nYour deliverable is the complete program that computes the requested outputs for the test suite exactly as specified. No user input is required or allowed.",
            "solution": "The specified spectral decay model is implemented via a numerical simulation. The algorithm proceeds as follows:\n\n1.  **Discretization and Initialization**:\n    First, the continuous wavenumber domain is discretized. A uniform grid of $N_k$ points, denoted by the vector $\\mathbf{k}$, is established over the interval $[k_{\\min}, k_{\\max}]$. The initial energy spectrum, $E(k,0)$, is then computed on this grid. The problem defines the shape of the spectrum as $E_{\\text{shape}}(k) = k^4 \\exp[-(k/k_p)^2]$. To satisfy the initial energy condition $K(0) = K_0$, we must find the normalization constant $A$. This is done by numerically integrating the shape function and scaling accordingly:\n    $$ A = \\frac{K_0}{\\int_{k_{\\min}}^{k_{\\max}} k^4 \\exp[-(k/k_p)^2] \\,dk} $$\n    The integral is approximated using the trapezoidal rule over the discrete grid $\\mathbf{k}$. The initial spectrum vector is then $\\mathbf{E}_0 = A \\cdot \\mathbf{k}^4 \\exp[-(\\mathbf{k}/k_p)^2]$, where operations are element-wise. This initial spectrum is stored and used as the starting point for each simulation case.\n\n2.  **Time Integration Loop**:\n    The simulation evolves the spectrum from $t=0$ to $t=t_{\\text{end}}$ in discrete time steps of size $\\Delta t$. The total number of steps is $\\text{round}(t_{\\text{end}} / \\Delta t)$. For each value of the Smagorinsky constant $C_s$ from the test suite, a new simulation is run, starting with the same initial spectrum $\\mathbf{E}_0$.\n    At each time step $n$, corresponding to time $t_n$, with the spectrum given by $\\mathbf{E}(t_n)$, the following steps are performed:\n    -   **Calculate Total Effective Viscosity $\\nu_{\\mathrm{eff}}(t_n)$**: This is the crucial step where the eddy-viscosity model influences the dynamics.\n        -   First, compute the integral of the second moment of the spectrum, $I_2(t_n) = \\int_{k_{\\min}}^{k_{\\max}} k^2 E(k,t_n) \\,dk$. This is approximated numerically using the trapezoidal rule: $I_2(t_n) \\approx \\text{trapz}(\\mathbf{k}^2 \\circ \\mathbf{E}(t_n), \\mathbf{k})$, where $\\circ$ denotes the element-wise product.\n        -   The magnitude of the mean strain rate tensor is then $\\lvert S \\rvert(t_n) = \\sqrt{2 I_2(t_n)}$.\n        -   The eddy viscosity is calculated: $\\nu_t(t_n) = (C_s \\Delta)^2 \\lvert S \\rvert(t_n)$.\n        -   The total effective viscosity is $\\nu_{\\mathrm{eff}}(t_n) = \\nu + \\nu_t(t_n)$.\n    -   **Update the Spectrum**: The evolution equation $\\partial E/\\partial t = -2\\nu_{\\mathrm{eff}}k^2 E$ is solved over the time step $\\Delta t$ by holding $\\nu_{\\mathrm{eff}}(t_n)$ constant. This gives the exponential update rule:\n        $$ E(k, t_{n+1}) = E(k, t_n) \\exp(-2 \\nu_{\\mathrm{eff}}(t_n) k^2 \\Delta t) $$\n        This update is applied element-wise to the spectrum vector $\\mathbf{E}(t_n)$ to obtain $\\mathbf{E}(t_{n+1})$.\n\n3.  **Calculation of Final Metrics**:\n    After the final time step, we have the spectrum at $t = t_{\\text{end}}$, denoted $\\mathbf{E}_{\\text{final}}$. From this, we compute the required metrics.\n    -   **Kinetic Energy**: $K(t_{\\text{end}}) = \\int E_{\\text{final}}(k) \\,dk$.\n    -   **RMS Velocity**: $u_{\\mathrm{rms}}(t_{\\text{end}}) = \\sqrt{2K(t_{\\text{end}})/3}$.\n    -   **Integral Length Scale**: $L(t_{\\text{end}}) = \\frac{\\pi}{2 u_{\\mathrm{rms}}^2(t_{\\text{end}})} \\int \\frac{E_{\\text{final}}(k)}{k} \\,dk$.\n    -   **Effective Viscosity**: $\\nu_{\\mathrm{eff}}(t_{\\text{end}})$ is recalculated using $\\mathbf{E}_{\\text{final}}$ for consistency.\n    -   **Effective Reynolds Number**: $Re_{\\mathrm{eff}}(t_{\\text{end}}) = \\frac{u_{\\mathrm{rms}}(t_{\\text{end}}) L(t_{\\text{end}})}{\\nu_{\\mathrm{eff}}(t_{\\text{end}})}$.\n    -   **Dissipation Rate**: $\\varepsilon(t_{\\text{end}}) = 2 \\nu_{\\mathrm{eff}}(t_{\\text{end}}) \\int k^2 E_{\\text{final}}(k) \\,dk$.\n    -   **Kolmogorov Wavenumber**: $k_{\\eta}(t_{\\text{end}}) = \\left( \\frac{\\varepsilon(t_{\\text{end}})}{\\nu_{\\mathrm{eff}}^3(t_{\\text{end}})} \\right)^{1/4}$. This simplifies to $k_{\\eta} = \\left( \\frac{2 \\int k^2 E_{\\text{final}} \\,dk}{\\nu_{\\mathrm{eff}}^2(t_{\\text{end}})} \\right)^{1/4}$.\n\n    All integrals are computed numerically via the trapezoidal rule on the grid $\\mathbf{k}$. This process is repeated for each $C_s$, and the resulting pairs $(k_{\\eta}, Re_{\\mathrm{eff}})$ are collected.\n\n4.  **Output Formatting**:\n    The collected results are formatted into a single string. Each numerical value is rounded to six decimal places. The final output is a comma-separated list of these values enclosed in square brackets, as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Numerically solves a simplified spectral decay model for isotropic turbulence\n    with an algebraic eddy-viscosity closure. Computes and reports key metrics\n    for a range of Smagorinsky constants.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [0.00, 0.10, 0.18, 0.24, 0.30]\n\n    # --- Problem Parameters ---\n    # Physical constants (SI units)\n    K0 = 1.0           # Initial kinetic energy [m^2/s^2]\n    nu = 1.5e-5        # Molecular kinematic viscosity [m^2/s]\n    Delta_filter = 1.0e-2 # Smagorinsky filter width [m]\n    kp = 10.0          # Wavenumber of peak energy [m^-1]\n\n    # Numerical parameters\n    k_min = 0.5        # Minimum wavenumber [m^-1]\n    k_max = 200.0      # Maximum wavenumber [m^-1]\n    Nk = 4096          # Number of grid points in k\n    dt = 2.0e-4        # Time step size [s]\n    t_end = 0.02       # Final time [s]\n\n    # --- Setup Grid and Initial Spectrum ---\n    # Create uniform wavenumber grid\n    k = np.linspace(k_min, k_max, Nk)\n    \n    # Define shape of the initial spectrum\n    # E(k,0) = A * k^4 * exp[-(k/kp)^2]\n    E_shape = k**4 * np.exp(-(k / kp)**2)\n    \n    # Normalize spectrum to satisfy K(0) = K0\n    # K(0) = integral(E(k,0) dk)\n    integral_E_shape = np.trapz(E_shape, k)\n    A = K0 / integral_E_shape\n    E0 = A * E_shape\n\n    results = []\n    \n    # --- Main Loop over Smagorinsky Constants ---\n    for Cs in test_cases:\n        # Reset spectrum to initial condition for each run\n        E = np.copy(E0)\n        \n        # --- Time Integration ---\n        num_steps = int(round(t_end / dt))\n        for _ in range(num_steps):\n            # Calculate the second moment of the spectrum\n            # I_2(t) = integral(k^2 * E(k,t) dk)\n            I_2 = np.trapz(k**2 * E, k)\n            if I_2  0: I_2 = 0.0 # Ensure non-negativity\n            \n            # Calculate the mean strain rate magnitude\n            # |S|(t) = sqrt(2 * I_2)\n            S_mag = np.sqrt(2.0 * I_2)\n            \n            # Calculate eddy viscosity and total effective viscosity\n            # nu_t = (Cs * Delta)^2 * |S|\n            nu_t = (Cs * Delta_filter)**2 * S_mag\n            nu_eff = nu + nu_t\n            \n            # Update spectrum using exponential decay\n            # E(t+dt) = E(t) * exp(-2 * nu_eff * k^2 * dt)\n            E = E * np.exp(-2.0 * nu_eff * k**2 * dt)\n            \n        # --- Post-processing at t_end ---\n        E_final = E\n        \n        # Calculate final integrals needed for metrics\n        K_final = np.trapz(E_final, k)\n        # I_minus_1 for integral length scale\n        I_minus_1_final = np.trapz(E_final / k, k)\n        # I_2 for dissipation-related quantities\n        I_2_final = np.trapz(k**2 * E_final, k)\n        if I_2_final  0: I_2_final = 0.0\n\n        # Calculate final metrics\n        u_rms_final = np.sqrt(2.0 * K_final / 3.0)\n\n        # Integral length scale\n        if u_rms_final**2  1e-16: # Avoid division by zero\n            L_final = 0.0\n        else:\n            L_final = (np.pi / (2.0 * u_rms_final**2)) * I_minus_1_final\n        \n        # Recalculate nu_eff at the final time for consistency\n        S_mag_final = np.sqrt(2.0 * I_2_final)\n        nu_t_final = (Cs * Delta_filter)**2 * S_mag_final\n        nu_eff_final = nu + nu_t_final\n        \n        # Effective Reynolds number\n        Re_eff_final = (u_rms_final * L_final) / nu_eff_final\n        \n        # Dissipation rate and Kolmogorov wavenumber\n        epsilon_final = 2.0 * nu_eff_final * I_2_final\n        \n        # k_eta = (epsilon / nu_eff^3)^(1/4)\n        if nu_eff_final  1e-16: # Avoid division by zero\n             k_eta_final = 0.0\n        else:\n            k_eta_final = (epsilon_final / nu_eff_final**3)**(1.0/4.0)\n\n        results.append(k_eta_final)\n        results.append(Re_eff_final)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}