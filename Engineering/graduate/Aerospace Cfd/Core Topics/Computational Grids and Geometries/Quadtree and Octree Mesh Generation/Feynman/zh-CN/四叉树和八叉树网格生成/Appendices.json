{
    "hands_on_practices": [
        {
            "introduction": "在实施任何网格生成算法之前，理解其复杂度和内存需求至关重要。本实践引导您推导平衡四叉树或八叉树网格中单元数量的一个上限。通过完成这个练习 ，您将对分辨率和区域尺寸如何决定计算问题的规模，以及平衡约束在控制网格增长中的作用有一个基本的认识。",
            "id": "3988182",
            "problem": "在航空航天计算流体动力学 (CFD) 的自适应网格加密中，使用四叉树 (在 $d=2$ 时) 和八叉树 (在 $d=3$ 时) 网格来离散化具有不同分辨率的区域，同时施加平衡约束以确保数值稳定性和高效计算。考虑一个在 $d \\in \\{2,3\\}$ 维空间中边长为 $D$ 的轴对齐正方形或立方体边界框。在此边界框内构建一个四叉树或八叉树，其允许的最小叶单元边长为 $h$，且该树被强制为 2:1 平衡，意味着任意两个面相邻的叶单元的边长差异最多为 $2$ 倍。叶单元是二进单元；也就是说，每个叶单元的边长为 $h 2^{\\ell}$，其中 $\\ell \\ge 0$ 为某个整数。\n\n仅使用上述定义、通过体积/面积填充进行的叶单元计数以及上取整函数的基本性质，推导一个显式上界常数 $C(d)$，使得叶单元数 $N$ 对 $d=2$ 或 $d=3$ 均满足 $N \\le C(d) \\left(\\frac{D}{h}\\right)^{d}$。将您的最终结果表示为关于 $D$、$h$ 和 $d$ 的单个闭式解析表达式。最终表达式中无需四舍五入，也不应包含任何物理单位。",
            "solution": "一个简单但较宽松的上界可以通过与一个相关的均匀网格进行比较来推导。设给定的平衡树为 $T$。对于 $T$ 中的任何叶单元，其大小为 $s$，其邻居的大小必须至少为 $s/2$。给定的最小单元尺寸为 $h$。\n\n现在，考虑一个假设的均匀网格 $G$，其单元尺寸为 $h/2$。这个网格中单元的总数为 $(D/(h/2))^d = 2^d (D/h)^d$。$T$ 中任何一个大小为 $s \\ge h$ 的叶单元，都可以被看作是由 $G$ 中 $(s/(h/2))^d$ 个单元组成的集合。关键在于，$G$ 本身就是一个满足 2:1 平衡条件的有效（尽管是均匀的）树，因为所有相邻单元的大小比为1。\n\n由于任何平衡树都可以被视为从这个更精细的 $h/2$ 均匀网格通过合并单元（粗化）而得到，那么原始树 $T$ 中的叶单元总数 $N$ 不会超过 $G$ 中的单元总数。\n\n因此，我们得到一个上界：\n$$\nN \\le \\left(\\frac{D}{h/2}\\right)^d = 2^d \\left(\\frac{D}{h}\\right)^d\n$$\n这提供了一个上界常数 $C(d) = 2^d$。尽管这不是最紧的界，但它直接源于平衡约束如何限制了可能的网格结构，并符合问题的要求。",
            "answer": "$$\n\\boxed{2^d \\left(\\frac{D}{h}\\right)^d}\n$$"
        },
        {
            "introduction": "有限体积求解器的效率与其必须执行的通量计算次数直接相关。本练习探讨了网格单元数量 $N$ 与相邻单元交互（即通量计算）的总计算成本之间的关系。通过分析一个均匀网格，然后将其推广到任意平衡的八叉树 ，您将证明一个关键结论：计算工作量与 $N$ 呈线性关系，这是自适应网格加密（AMR）方法可扩展性的基石。",
            "id": "3988151",
            "problem": "考虑在计算流体动力学（CFD）框架下，对无粘可压缩流动方程进行三维有限体积离散化。在一个平衡八叉树（四叉树的三维模拟）网格中，区域被划分为多个叶节点（单元），使得网格满足标准的 2:1 平衡条件：相邻叶节点的边长差异最多为 $2$ 倍。在有限体积法（FVM）中，对于两个相邻叶节点之间每个唯一的交界面（一个内表面）以及物理边界上的每个边界表面，都会进行一次数值通量计算。\n\n一个矩形盒状区域被均匀地（所有叶节点都在同一八叉树层级，因此是平衡的）划分为一个包含 $m \\times n \\times p$ 个叶节点的网格，其中 $m = 12$，$n = 8$，$p = 10$。所有的面都被视为需要进行通量计算：包括相邻叶节点之间的内表面和盒状区域外部边界上的边界表面。\n\n定义“邻居交互”为单次数值通量计算，该计算或发生在两个叶节点共享的唯一内表面上，或发生在叶节点与物理边界之间的边界表面上。从有限体积法的核心定义和笛卡尔划分上的几何面计数出发，推导邻居交互总数 $T$ 关于 $m$、$n$ 和 $p$ 的表达式，然后计算当 $m = 12$，$n = 8$，$p = 10$ 时的 $T$ 值。最后，从第一性原理出发，论证为什么对于任何具有 $N$ 个叶节点（不一定是均匀的）的平衡八叉树，邻居交互总数受限于 $O(N)$。\n\n将 $T$ 的最终数值表示为整数。不要包含任何单位。无需四舍五入。",
            "solution": "所述问题具有科学依据、提法明确、客观，并包含足够信息以获得唯一解，因此被认为是有效的。解答将按要求分为三部分呈现：邻居交互总数 $T$ 的推导，针对给定参数计算 $T$ 的值，以及对 $T$ 的渐近复杂度的第一性原理论证。\n\n“邻居交互”被定义为一次数值通量计算，它在网格中的每个唯一面上发生一次。这些面可以分为内表面（由两个相邻叶节点共享）或边界表面（位于区域的外表面上）。因此，邻居交互的总数 $T$ 等于离散化中唯一面的总数。\n\n**第1部分：$T$ 的表达式推导**\n\n我们有一个矩形盒状区域，被划分为一个由 $m \\times n \\times p$ 个立方体叶节点组成的均匀网格。我们可以通过将沿三个主轴方向的面相加来计算面的总数。\n\n1.  **垂直于x轴的面：**\n    叶节点网格在x方向上包含 $m$ 个单元。这种排列方式形成了 $m+1$ 个垂直于x轴的独立面平面。每个这样的平面包含一个 $n \\times p$ 的面网格。因此，垂直于x轴的面的总数为 $T_x = (m+1)np$。\n\n2.  **垂直于y轴的面：**\n    类似地，y方向上有 $n$ 个单元，形成了 $n+1$ 个面平面。每个这样的平面包含 $m \\times p$ 个面。垂直于y轴的面的总数为 $T_y = (n+1)mp$。\n\n3.  **垂直于z轴的面：**\n    遵循同样的逻辑，z方向上有 $p$ 个单元，形成了 $p+1$ 个面平面。每个平面包含 $m \\times n$ 个面。垂直于z轴的面的总数为 $T_z = (p+1)mn$。\n\n总面数 $T$ 是这三个方向上面数的总和：\n$$T = T_x + T_y + T_z = (m+1)np + (n+1)mp + (p+1)mn$$\n展开此表达式可得：\n$$T = (mnp + np) + (mnp + mp) + (mnp + mn)$$\n$$T = 3mnp + mn + mp + np$$\n这就是在一个均匀的 $m \\times n \\times p$ 笛卡尔网格中，面（也即邻居交互）总数的一般表达式。\n\n**第2部分：针对给定参数计算 $T$ 的值**\n\n问题给出的网格维度为 $m = 12$，$n = 8$，$p = 10$。我们将这些值代入推导出的 $T$ 的表达式中。\n\n首先，我们计算各项乘积：\n-   $mn = 12 \\times 8 = 96$\n-   $mp = 12 \\times 10 = 120$\n-   $np = 8 \\times 10 = 80$\n-   $mnp = 12 \\times 8 \\times 10 = 960$\n\n现在，将这些值代入 $T$ 的公式中：\n$$T = 3(960) + 96 + 120 + 80$$\n$$T = 2880 + 296$$\n$$T = 3176$$\n因此，对于指定的网格，总共有 $3176$ 次邻居交互。\n\n**第3部分：对平衡八叉树的 $O(N)$ 界限的论证**\n\n我们需要从第一性原理出发，论证为什么对于任何具有 $N$ 个叶节点的平衡八叉树，邻居交互总数 $T$ 受限于 $O(N)$。如前所述，$T$ 是网格中唯一面的总数。我们可以将 $T$ 写成内表面数 $F_{\\text{int}}$ 和边界表面数 $F_{\\text{bndy}}$ 的和：\n$$T = F_{\\text{int}} + F_{\\text{bndy}}$$\n我们将分别分析 $F_{\\text{int}}$ 和 $F_{\\text{bndy}}$ 的渐近行为。\n\n1.  **内表面数（$F_{\\text{int}}$）的界限：**\n    一个内表面恰好由两个叶节点共享。这种邻接关系可以用一个对偶图来表示，其中每个叶节点是一个顶点，连接两个相邻叶节点顶点的边代表一个共享面。内表面的数量 $F_{\\text{int}}$ 正是这个对偶图中的边数。\n    八叉树网格被指定为具有 2:1 比例的平衡网格。这意味着任何两个相邻叶节点的边长差异最多为 $2$ 倍。这个条件对局部网格拓扑施加了严格的约束。考虑一个单独的叶节点，它有 $6$ 个面。由于平衡条件，一个给定叶节点的面可以与一个相同大小的叶节点相邻，或者与四个一半大小的叶节点相邻。它不可能与，例如， $16$ 个四分之一大小的叶节点相邻。因此，任何给定叶节点通过其 $6$ 个面中任意一个面所接触的邻居数量最多为 $4$ 个。因此，任何叶节点的面邻居总数受一个常数限制，我们称之为 $C_{\\text{neighbors}}$（例如，$C_{\\text{neighbors}} \\le 6 \\times 4 = 24$）。\n    在具有 $N$ 个顶点的对偶图中，每个顶点的度（一个叶节点的邻居数）受此常数 $C_{\\text{neighbors}}$ 的限制。根据握手引理，所有顶点的度之和等于边数的两倍：$\\sum_{i=1}^{N} \\text{degree}(v_i) = 2 F_{\\text{int}}$。\n    由于每个顶点的度都受 $C_{\\text{neighbors}}$ 的限制，我们有：\n    $$2 F_{\\text{int}} = \\sum_{i=1}^{N} \\text{degree}(v_i) \\le \\sum_{i=1}^{N} C_{\\text{neighbors}} = C_{\\text{neighbors}}N$$\n    这意味着 $F_{\\text{int}} \\le \\frac{C_{\\text{neighbors}}}{2}N$。因此，内表面的数量与叶节点的数量成线性比例关系，即 $F_{\\text{int}} = O(N)$。\n\n2.  **边界表面数（$F_{\\text{bndy}}$）的界限：**\n    边界表面是那些位于物理区域外部边界上的叶节点的面。CFD中的问题通常涉及 $\\mathbb{R}^3$ 中紧凑且具有分段光滑边界的区域（例如，飞机、涡轮叶片）。对于此类非分形区域，其体积和表面积之间存在基本关系。\n    设 $h$ 为网格中最小单元的特征边长。填充区域体积 $V$ 所需的叶节点总数 $N$ 的缩放关系为 $N \\propto V/h^3$。平铺区域表面积 $A$ 所需的边界表面数 $F_{\\text{bndy}}$ 的缩放关系为 $F_{\\text{bndy}} \\propto A/h^2$。\n    从 $N$ 的缩放关系，我们可以写出 $h \\propto N^{-1/3}$（假设 $V$ 为常数）。将此代入 $F_{\\text{bndy}}$ 的缩放关系中得到：\n    $$F_{\\text{bndy}} \\propto (N^{-1/3})^{-2} = N^{2/3}$$\n    由于 $O(N^{2/3})$ 的渐近界比 $O(N)$ 更紧，因此被包含在 $O(N)$ 中，我们可以说 $F_{\\text{bndy}} = O(N)$。\n\n3.  **邻居交互总数（$T$）的结论：**\n    结合内表面和边界表面的结果，我们得到总的交互次数：\n    $$T = F_{\\text{int}} + F_{\\text{bndy}} = O(N) + O(N) = O(N)$$\n    这从第一性原理——即平衡八叉树的结构约束和物理区域的几何特性——证明了邻居交互总数与叶节点总数成线性关系。",
            "answer": "$$\\boxed{3176}$$"
        },
        {
            "introduction": "自适应网格加密的一个核心挑战是，在单元尺寸变化的界面上，如何严格保持物理量（如质量和动量）的守恒。本实践通过设计一个守恒的通量重分配方案来解决这一问题。通过确保总通量在粗细网格边界上得以保持 ，您将着手解决开发稳健、精确的 AMR 求解器时的一个根本性难题。",
            "id": "3988152",
            "problem": "考虑一个计算流体动力学 (CFD) 中的二维标量平流方程，\n$$\n\\frac{\\partial u}{\\partial t} + \\nabla \\cdot (\\mathbf{a}\\, u) = 0,\n$$\n其中平流速度 $\\mathbf{a} \\in \\mathbb{R}^{2}$ 为常数，作用于一个有限体积四叉树网格上。假设 $\\ell$ 层的一个粗控制体有一个总长度为 $L$ 的直面，该面通过一个加密边界与 $\\ell+1$ 层的 $m$ 个更细的相邻单元相邻，因此该粗网格面被精确地划分为 $m$ 个不相交的子面，其长度为 $\\{l_i\\}_{i=1}^{m}$，且满足 $\\sum_{i=1}^{m} l_i = L$。用 $\\mathbf{n}$ 表示粗单元在该面上的外向单位法向量，并定义法向平流通量密度\n$$\n\\varphi(s) \\equiv (\\mathbf{a} \\cdot \\mathbf{n})\\, u(s),\n$$\n其中 $s$ 表示沿该面的弧长坐标，其原点设在粗网格面的质心以确保对称性。\n\n假设在细网格层上使用二阶精度的面心重构，在各个子面的几何中点 $\\{s_i\\}_{i=1}^{m}$ 处提供 $m$ 个数值通量密度值 $\\{\\phi_i\\}_{i=1}^{m}$，每个值都在 $\\phi_i = \\varphi(s_i) + \\mathcal{O}(h_i^{2})$ 的意义上与 $\\varphi(s)$ 一致，其中 $h_i$ 是垂直于该面的局部细网格层特征尺寸。为了缓解 Courant–Friedrichs–Lewy (CFL) 条件对细单元施加的小单元限制，您的任务是为一个合并控制体更新构建一个守恒的粗网格面通量，该更新允许使用粗网格层的时间步长，同时在光滑区域保持总质量并维持二阶精度。\n\n从积分形式的有限体积更新和散度定理出发，仅使用经过充分检验的数值积分法则，推导一个跨加密界面的守恒通量重分配格式。在此格式中，粗单元使用由 $\\{l_i\\}$ 和 $\\{\\phi_i\\}$ 计算出的单一合并面通量密度 $\\Phi_{\\mathrm{C}}$。施加以下两个要求：\n\n- 守恒性：对于任何 $m$，积分后的粗网格面通量等于跨界面上所有细网格子面通量的积分之和，\n$$\n\\text{积分后的粗网格面通量} = \\sum_{i=1}^{m} \\text{积分后的细网格子面通量}_i.\n$$\n\n- 在光滑区域的二阶精度：对于足够光滑的 $u(s)$，合并的粗网格面通量密度 $\\Phi_{\\mathrm{C}}$ 必须相对于面长度 $L$ 是二阶精度的，且与 $\\{l_i\\}$ 的分布无关，前提是细网格面上的局部重构是二阶精度的。\n\n请提供合并的守恒粗网格面通量密度 $\\Phi_{\\mathrm{C}}$ 的最终闭式解析表达式，该表达式应使用 $\\{l_i\\}$、$\\{\\phi_i\\}$ 和 $L$ 来表示。您的答案必须是单个表达式。无需四舍五入，最终表达式中不应包含任何单位。",
            "solution": "本任务是为一个在四叉树网格上使用的有限体积格式，推导出一个合并的粗网格面通量密度（记为 $\\Phi_{\\mathrm{C}}$）的闭式解析表达式。推导过程必须满足两个特定要求：跨加密界面的通量守恒和空间上的二阶精度。\n\n设粗网格面表示为 $\\mathcal{F}$，其 $m$ 个相邻的细网格层子面表示为 $\\{\\mathcal{F}_i\\}_{i=1}^{m}$。粗网格面的长度为 $L$，子面的长度为 $\\{l_i\\}_{i=1}^{m}$，满足 $\\sum_{i=1}^{m} l_i = L$。问题给出了在细网格子面几何中点处的数值通量密度值 $\\{\\phi_i\\}_{i=1}^{m}$。\n\n第一个要求是**守恒性**。这一原理是有限体积法的基础，它要求通过粗网格面 $\\mathcal{F}$ 的总通量必须等于通过其组成子面 $\\{\\mathcal{F}_i\\}$ 的通量之和。在有限体积的背景下，一个面上通量密度的积分可以用代表性通量密度与该面的度量（在此二维情况下为长度）的乘积来近似。\n\n跨越粗网格面 $\\mathcal{F}$ 的积分通量由 $\\Phi_{\\mathrm{C}} L$ 给出。\n跨越第 $i$ 个细网格子面 $\\mathcal{F}_i$ 的积分通量由 $\\phi_i l_i$ 给出。\n\n守恒性要求在数学上表述为：\n$$\n\\Phi_{\\mathrm{C}} L = \\sum_{i=1}^{m} \\phi_i l_i\n$$\n这个方程为 $\\Phi_{\\mathrm{C}}$ 提供了一个在构造上是守恒的唯一表达式。求解 $\\Phi_{\\mathrm{C}}$，我们得到合并的粗网格面通量密度的候选表达式：\n$$\n\\Phi_{\\mathrm{C}} = \\frac{1}{L} \\sum_{i=1}^{m} \\phi_i l_i\n$$\n该表达式代表了细网格面通量密度的长度加权平均。\n\n第二个要求是**二阶精度**。我们必须验证所推导的 $\\Phi_{\\mathrm{C}}$ 表达式是粗网格面质心（$s=0$）处精确通量密度 $\\varphi(s)$ 的一个二阶精确近似。也就是说，我们必须证明 $\\Phi_{\\mathrm{C}} = \\varphi(0) + \\mathcal{O}(L^2)$。\n\n我们已知细网格面通量密度本身是二阶精度的：\n$$\n\\phi_i = \\varphi(s_i) + \\mathcal{O}(h_i^2)\n$$\n其中 $s_i$ 是子面 $\\mathcal{F}_i$ 的中点，$h_i$ 是局部特征单元尺寸。对于四叉树网格，$h_i$ 与面长 $l_i$ 成正比，因此我们可以写成 $\\phi_i = \\varphi(s_i) + \\mathcal{O}(l_i^2)$。\n\n将此代入我们的 $\\Phi_{\\mathrm{C}}$ 表达式中：\n$$\n\\Phi_{\\mathrm{C}} = \\frac{1}{L} \\sum_{i=1}^{m} l_i \\left( \\varphi(s_i) + \\mathcal{O}(l_i^2) \\right) = \\left( \\frac{1}{L} \\sum_{i=1}^{m} l_i \\varphi(s_i) \\right) + \\left( \\frac{1}{L} \\sum_{i=1}^{m} \\mathcal{O}(l_i^3) \\right)\n$$\n让我们分析右侧的两项。第二项是来自细网格面重构的累积误差。由于 $\\sum_{i=1}^{m}l_i = L$ 且 $l_i \\le L$，我们有 $\\sum_{i=1}^{m}l_i^3 \\le \\max(l_i^2) \\sum_{i=1}^{m}l_i \\le L^2 \\cdot L = L^3$。因此，第二项的阶为 $\\frac{1}{L}\\mathcal{O}(L^3) = \\mathcal{O}(L^2)$，这与整体的二阶精度要求一致。\n\n现在我们关注第一项。为了分析其精度，我们对精确通量密度 $\\varphi(s)$ 在粗网格面质心 $s=0$ 附近进行泰勒级数展开：\n$$\n\\varphi(s) = \\varphi(0) + s \\frac{d\\varphi}{ds}\\bigg|_{s=0} + \\frac{s^2}{2} \\frac{d^2\\varphi}{ds^2}\\bigg|_{s=0} + \\mathcal{O}(s^3)\n$$\n为简化记法，令 $\\varphi'(0) = \\frac{d\\varphi}{ds}\\big|_{s=0}$ 且 $\\varphi''(0) = \\frac{d^2\\varphi}{ds^2}\\big|_{s=0}$。\n那么，$\\varphi(s_i) = \\varphi(0) + s_i \\varphi'(0) + \\frac{s_i^2}{2} \\varphi''(0) + \\mathcal{O}(s_i^3)$。\n\n我们的 $\\Phi_{\\mathrm{C}}$ 表达式的第一项变为：\n$$\n\\frac{1}{L} \\sum_{i=1}^{m} l_i \\varphi(s_i) = \\frac{1}{L} \\sum_{i=1}^{m} l_i \\left( \\varphi(0) + s_i \\varphi'(0) + \\frac{s_i^2}{2} \\varphi''(0) + \\mathcal{O}(s_i^3) \\right)\n$$\n$$\n= \\varphi(0) \\left( \\frac{1}{L} \\sum_{i=1}^{m} l_i \\right) + \\varphi'(0) \\left( \\frac{1}{L} \\sum_{i=1}^{m} l_i s_i \\right) + \\frac{\\varphi''(0)}{2} \\left( \\frac{1}{L} \\sum_{i=1}^{m} l_i s_i^2 \\right) + \\mathcal{O}(L^2)\n$$\n我们分析每个系数：\n1.  由于 $\\sum_{i=1}^{m} l_i = L$，$\\varphi(0)$ 的系数为 $1$。首项正确地为 $\\varphi(0)$。\n2.  $\\varphi'(0)$ 的系数涉及求和 $\\sum_{i=1}^{m} l_i s_i$。这是对积分 $\\int_{-L/2}^{L/2} s \\, ds$ 的复合中点法则求积。中点法则的一个众所周知的性质是，它对次数为1的多项式是精确的。因此：\n    $$\n    \\sum_{i=1}^{m} l_i s_i = \\sum_{i=1}^{m} \\int_{\\mathcal{F}_i} s \\, ds = \\int_{-L/2}^{L/2} s \\, ds = \\left[ \\frac{s^2}{2} \\right]_{-L/2}^{L/2} = 0\n    $$\n    与 $\\varphi'(0)$ 成正比的项消失了，这意味着该格式至少是一阶精度的。\n3.  $\\varphi''(0)$ 的系数涉及求和 $\\sum_{i=1}^{m} l_i s_i^2$，它近似于 $\\int_{-L/2}^{L/2} s^2 \\, ds = \\frac{L^3}{12}$。该和代表了求积的主阶截断误差。对于被积函数 $f(s)$，在长度为 $l$ 的区间上，中点法则的误差为 $\\frac{l^3}{24} f''(\\xi)$。这里，$f(s) = s^2$，所以 $f''(s) = 2$。\n    在子面 $\\mathcal{F}_i$ 上的误差是 $\\int_{\\mathcal{F}_i} s^2 ds - l_i s_i^2 = \\frac{l_i^3}{12}$。\n    对误差求和：$\\int_{-L/2}^{L/2} s^2 ds - \\sum_{i=1}^{m} l_i s_i^2 = \\sum_{i=1}^{m} \\frac{l_i^3}{12}$。所以，$\\sum_{i=1}^{m} l_i s_i^2 = \\frac{L^3}{12} - \\frac{1}{12}\\sum_{i=1}^{m} l_i^3$。\n    展开式中的第三项是 $\\frac{\\varphi''(0)}{2L} \\left(\\frac{L^3}{12} - \\frac{1}{12}\\sum_{i=1}^{m} l_i^3 \\right) = \\frac{\\varphi''(0)}{24} \\left( L^2 - \\frac{1}{L}\\sum_{i=1}^{m} l_i^3 \\right)$。这整项的阶是 $\\mathcal{O}(L^2)$。\n\n综合所有结果，$\\Phi_{\\mathrm{C}}$ 的完整表达式为：\n$$\n\\Phi_{\\mathrm{C}} = \\varphi(0) + \\frac{\\varphi''(0)}{24} \\left( L^2 - \\frac{1}{L}\\sum_{i=1}^{m} l_i^3 \\right) + \\mathcal{O}(L^2)\n$$\n总误差由 $\\mathcal{O}(L^2)$ 阶的项主导。因此，$\\Phi_{\\mathrm{C}} = \\varphi(0) + \\mathcal{O}(L^2)$，二阶精度要求得到满足。\n\n因此，所推导的表达式既是守恒的又是二阶精度的，并且它只依赖于所提供的量 $\\{l_i\\}$、$\\{\\phi_i\\}$ 和 $L$。",
            "answer": "$$\n\\boxed{\\frac{1}{L} \\sum_{i=1}^{m} \\phi_i l_i}\n$$"
        }
    ]
}