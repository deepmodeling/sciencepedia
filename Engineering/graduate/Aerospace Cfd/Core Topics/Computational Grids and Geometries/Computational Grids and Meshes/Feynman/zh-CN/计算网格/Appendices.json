{
    "hands_on_practices": [
        {
            "introduction": "在计算流体动力学中，复杂的物理域通常通过坐标变换映射到一个简单的、结构化的计算域（如单位正方形）上进行处理。这个变换的数学特性直接决定了物理网格的质量。本练习将引导你通过一个具体的解析变换，亲手推导决定网格拉伸、扭曲和有效性的关键量——度量张量和雅可比行列式，从而深刻理解抽象数学与网格物理特性之间的联系。",
            "id": "3949279",
            "problem": "考虑一个用于计算流体动力学（CFD）的二维结构化网格映射，该映射定义在单位正方形参数域 $\\{(\\xi,\\eta)\\,|\\,\\xi\\in[0,1],\\,\\eta\\in[0,1]\\}$ 上，通过从计算坐标 $(\\xi,\\eta)$ 到物理坐标 $(x,y)$ 的平滑变换给出：\n$$x(\\xi,\\eta)=\\xi+0.2\\sin(2\\pi\\xi)\\sin(\\pi\\eta),\\qquad y(\\xi,\\eta)=\\eta+0.1\\sin(2\\pi\\eta).$$\n从曲线坐标度量和雅可比行列式的标准定义出发，即协变基矢量 $\\mathbf{g}_{\\xi}=\\partial\\mathbf{r}/\\partial\\xi$ 和 $\\mathbf{g}_{\\eta}=\\partial\\mathbf{r}/\\partial\\eta$（其中 $\\mathbf{r}=(x,y)$），以及雅可比行列式 $J(\\xi,\\eta)=\\det\\left(\\partial(x,y)/\\partial(\\xi,\\eta)\\right)$，执行以下操作：\n\n- 从第一性原理出发，推导该域上 $J(\\xi,\\eta)$ 的显式解析表达式。\n- 使用 $\\mathbf{g}_{\\xi}$ 和 $\\mathbf{g}_{\\eta}$，识别并解释 $(\\xi,\\eta)$ 中与度量引起的网格拉伸（通过 $|\\mathbf{g}_{\\xi}|$ 和 $|\\mathbf{g}_{\\eta}|$ 的变化）和非正交性（通过 $\\mathbf{g}_{\\xi}\\cdot\\mathbf{g}_{\\eta}$ 的符号和大小）相关的区域，不使用任何简化关系。\n\n最后，确定雅可比行列式 $J(\\xi,\\eta)$ 在 $\\xi,\\eta\\in[0,1]$ 上的最小值，并将该最小值以包含 $\\pi$ 的单个闭式解析表达式的形式报告。不需要四舍五入，最终报告的值中不应包含任何单位。",
            "solution": "在尝试求解之前，首先对问题进行严格验证。\n\n### 步骤 1：提取已知条件\n- 计算域： $\\{(\\xi,\\eta)\\,|\\,\\xi\\in[0,1],\\,\\eta\\in[0,1]\\}$.\n- 到物理坐标 $(x,y)$ 的变换：\n  $$x(\\xi,\\eta)=\\xi+0.2\\sin(2\\pi\\xi)\\sin(\\pi\\eta)$$\n  $$y(\\xi,\\eta)=\\eta+0.1\\sin(2\\pi\\eta)$$\n- 定义：\n  - 位置矢量： $\\mathbf{r}=(x,y)$\n  - 协变基矢量： $\\mathbf{g}_{\\xi}=\\partial\\mathbf{r}/\\partial\\xi$ 和 $\\mathbf{g}_{\\eta}=\\partial\\mathbf{r}/\\partial\\eta$\n  - 雅可比行列式： $J(\\xi,\\eta)=\\det\\left(\\partial(x,y)/\\partial(\\xi,\\eta)\\right)$\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题是微分几何和张量分析在计算流体动力学（CFD）网格生成中应用的典型练习。坐标变换、雅可比行列式和度量张量（由协变基矢量表示）等概念是该领域的基础。\n- **适定性：** 变换函数 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 是平滑且解析定义的。问题要求推导明确定义的数学量，并确定一个连续函数在紧集上的最小值，根据极值定理，该最小值保证存在。问题是自洽的，并提供了所有必要的信息。\n- **客观性：** 问题陈述精确、定量，没有主观或含糊的语言。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解题推导\n\n分析从所提供的基本定义开始。物理域中的位置矢量由 $\\mathbf{r}(\\xi,\\eta) = x(\\xi,\\eta)\\mathbf{i} + y(\\xi,\\eta)\\mathbf{j}$ 给出，其中 $\\mathbf{i}$ 和 $\\mathbf{j}$ 是标准笛卡尔基矢量。\n\n**1. 雅可比行列式 $J(\\xi,\\eta)$ 的推导**\n\n雅可比行列式定义为 $J = \\det\\left(\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}\\right) = \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta} \\frac{\\partial y}{\\partial \\xi}$。我们首先根据给定的变换方程计算所需的偏导数：\n$$x(\\xi,\\eta)=\\xi+0.2\\sin(2\\pi\\xi)\\sin(\\pi\\eta)$$\n$$y(\\xi,\\eta)=\\eta+0.1\\sin(2\\pi\\eta)$$\n\n偏导数如下：\n$$\\frac{\\partial x}{\\partial\\xi} = 1 + 0.2\\cos(2\\pi\\xi) \\cdot (2\\pi) \\sin(\\pi\\eta) = 1 + 0.4\\pi\\cos(2\\pi\\xi)\\sin(\\pi\\eta)$$\n$$\\frac{\\partial x}{\\partial\\eta} = 0.2\\sin(2\\pi\\xi) \\cdot \\pi\\cos(\\pi\\eta) = 0.2\\pi\\sin(2\\pi\\xi)\\cos(\\pi\\eta)$$\n$$\\frac{\\partial y}{\\partial\\xi} = 0$$\n$$\\frac{\\partial y}{\\partial\\eta} = 1 + 0.1\\cos(2\\pi\\eta) \\cdot (2\\pi) = 1 + 0.2\\pi\\cos(2\\pi\\eta)$$\n\n将这些代入雅可比行列式的公式中：\n$$J(\\xi,\\eta) = \\left(1 + 0.4\\pi\\cos(2\\pi\\xi)\\sin(\\pi\\eta)\\right)\\left(1 + 0.2\\pi\\cos(2\\pi\\eta)\\right) - \\left(0.2\\pi\\sin(2\\pi\\xi)\\cos(\\pi\\eta)\\right) \\cdot 0$$\n因此，雅可比行列式的显式解析表达式为：\n$$J(\\xi,\\eta) = \\left(1 + 0.4\\pi\\cos(2\\pi\\xi)\\sin(\\pi\\eta)\\right)\\left(1 + 0.2\\pi\\cos(2\\pi\\eta)\\right)$$\n\n**2. 网格拉伸与非正交性分析**\n\n协变基矢量 $\\mathbf{g}_{\\xi}$ 和 $\\mathbf{g}_{\\eta}$ 描述了物理坐标系如何相对于计算坐标系变化。它们分别与常数 $\\eta$ 和常数 $\\xi$ 的网格线相切。\n\n使用上面计算的偏导数：\n$$\\mathbf{g}_{\\xi} = \\frac{\\partial\\mathbf{r}}{\\partial\\xi} = \\left(\\frac{\\partial x}{\\partial\\xi}, \\frac{\\partial y}{\\partial\\xi}\\right) = \\left(1 + 0.4\\pi\\cos(2\\pi\\xi)\\sin(\\pi\\eta), 0\\right)$$\n$$\\mathbf{g}_{\\eta} = \\frac{\\partial\\mathbf{r}}{\\partial\\eta} = \\left(\\frac{\\partial x}{\\partial\\eta}, \\frac{\\partial y}{\\partial\\eta}\\right) = \\left(0.2\\pi\\sin(2\\pi\\xi)\\cos(\\pi\\eta), 1 + 0.2\\pi\\cos(2\\pi\\eta)\\right)$$\n\n**网格拉伸：**\n网格拉伸通过基矢量的大小 $|\\mathbf{g}_{\\xi}|$ 和 $|\\mathbf{g}_{\\eta}|$ 来量化。这些大小表示物理域中沿曲线坐标方向的局部网格间距。\n\n$\\mathbf{g}_{\\xi}$ 的大小为：\n$$|\\mathbf{g}_{\\xi}| = \\sqrt{\\left(1 + 0.4\\pi\\cos(2\\pi\\xi)\\sin(\\pi\\eta)\\right)^2 + 0^2} = |1 + 0.4\\pi\\cos(2\\pi\\xi)\\sin(\\pi\\eta)|$$\n当 $|\\mathbf{g}_{\\xi}| > 1$ 时，网格单元在 $\\xi$ 方向上被拉伸；当 $|\\mathbf{g}_{\\xi}|  1$ 时，被压缩。因为对于 $\\eta \\in [0,1]$，$\\sin(\\pi\\eta) \\ge 0$，所以当 $\\cos(2\\pi\\xi) > 0$ 时发生拉伸（$|\\mathbf{g}_{\\xi}|>1$），即对于 $\\xi \\in [0, 1/4) \\cup (3/4, 1]$。当 $\\cos(2\\pi\\xi)  0$ 时发生压缩（$|\\mathbf{g}_{\\xi}|1$），即对于 $\\xi \\in (1/4, 3/4)$。最大拉伸发生在 $(\\xi, \\eta)=(0, 1/2)$ 和 $(1, 1/2)$，而最大压缩发生在 $(\\xi, \\eta)=(1/2, 1/2)$。\n\n$\\mathbf{g}_{\\eta}$ 的大小为：\n$$|\\mathbf{g}_{\\eta}| = \\sqrt{\\left(0.2\\pi\\sin(2\\pi\\xi)\\cos(\\pi\\eta)\\right)^2 + \\left(1 + 0.2\\pi\\cos(2\\pi\\eta)\\right)^2}$$\n在 $\\eta$ 方向上的拉伸更为复杂。通常在平方根内的项取最大值时，拉伸最大，例如在 $\\cos(2\\pi\\eta)$ 为正和/或 $|\\sin(2\\pi\\xi)\\cos(\\pi\\eta)|$ 较大的区域。\n\n**非正交性：**\n非正交性由基矢量的点积来衡量。如果在一个点上 $\\mathbf{g}_{\\xi} \\cdot \\mathbf{g}_{\\eta} = 0$，则网格是正交的。\n\n$$\\mathbf{g}_{\\xi} \\cdot \\mathbf{g}_{\\eta} = \\left(1 + 0.4\\pi\\cos(2\\pi\\xi)\\sin(\\pi\\eta)\\right)\\left(0.2\\pi\\sin(2\\pi\\xi)\\cos(\\pi\\eta)\\right) + 0 \\cdot \\left(1 + 0.2\\pi\\cos(2\\pi\\eta)\\right)$$\n$$\\mathbf{g}_{\\xi} \\cdot \\mathbf{g}_{\\eta} = 0.2\\pi\\sin(2\\pi\\xi)\\cos(\\pi\\eta)\\left(1 + 0.4\\pi\\cos(2\\pi\\xi)\\sin(\\pi\\eta)\\right)$$\n当任何一个乘法项为零时，网格是正交的（$\\mathbf{g}_{\\xi} \\cdot \\mathbf{g}_{\\eta}=0$）：\n1. $\\sin(2\\pi\\xi) = 0 \\implies \\xi = 0, 1/2, 1$。这些对应于计算域的垂直边界和中心线。\n2. $\\cos(\\pi\\eta) = 0 \\implies \\eta = 1/2$。这对应于计算域的水平中心线。\n在其他所有地方，网格都是非正交的（倾斜的）。倾斜度在点积的绝对值最大处最高，这通常发生在远离这些正交线的地方，例如，在 $(\\xi, \\eta) = (1/4, 0)$ 或 $(3/4, 1)$ 附近。\n\n**3. 雅可比行列式最小值的确定**\n\n我们需要在域 $\\xi,\\eta\\in[0,1]$ 上找到 $J(\\xi,\\eta)$ 的最小值。\n$$J(\\xi,\\eta) = \\underbrace{\\left(1 + 0.4\\pi\\cos(2\\pi\\xi)\\sin(\\pi\\eta)\\right)}_{A(\\xi,\\eta)} \\underbrace{\\left(1 + 0.2\\pi\\cos(2\\pi\\eta)\\right)}_{B(\\eta)}$$\n\n首先，我们分析每个因子的范围。\n对于因子 $B(\\eta)$：由于 $\\cos(2\\pi\\eta) \\in [-1,1]$ 且 $0.2\\pi \\approx 0.628  1$，因子 $B(\\eta)$ 总是正的。其范围是 $[1-0.2\\pi, 1+0.2\\pi]$。\n对于因子 $A(\\xi,\\eta)$：在给定域内，项 $\\cos(2\\pi\\xi) \\in [-1,1]$ 且 $\\sin(\\pi\\eta) \\in [0,1]$。乘积 $\\cos(2\\pi\\xi)\\sin(\\pi\\eta)$ 的范围是从 $-1$ 到 $1$。由于 $0.4\\pi \\approx 1.257 > 1$，因子 $A(\\xi,\\eta)$ 可以是负的。其范围是 $[1-0.4\\pi, 1+0.4\\pi]$。\n\n为了找到乘积 $J = A \\cdot B$ 的最小值，我们注意到由于 $B(\\eta)$ 总是正的，$J$ 的符号由 $A(\\xi,\\eta)$ 的符号决定。$J$ 的最小值将是负的，因此我们必须寻找使 $A(\\xi,\\eta)$ 为负且尽可能小的条件。\n\n为了使 $A(\\xi,\\eta)$ 最小（即最负），我们必须使乘积 $\\cos(2\\pi\\xi)\\sin(\\pi\\eta)$ 尽可能大。由于 $\\sin(\\pi\\eta) \\ge 0$，这要求 $\\cos(2\\pi\\xi)$ 尽可能为负，即 $-1$。这发生在 $\\xi=1/2$ 处。在 $\\xi$ 的这个值下，该项变为 $-1 \\cdot \\sin(\\pi\\eta) = -\\sin(\\pi\\eta)$。为了使其最负，我们必须最大化 $\\sin(\\pi\\eta)$，即 $1$。这发生在 $\\eta=1/2$ 处。因此，因子 $A(\\xi,\\eta)$ 的最小值是 $A(1/2, 1/2) = 1 - 0.4\\pi$，在 $(\\xi,\\eta)=(1/2, 1/2)$ 处取得。\n\n现在，我们计算因子 $B(\\eta)$ 在同一点 $\\eta=1/2$ 的值：\n$B(1/2) = 1 + 0.2\\pi\\cos(2\\pi \\cdot 1/2) = 1 + 0.2\\pi\\cos(\\pi) = 1 - 0.2\\pi$。\n\n点 $(\\xi,\\eta)=(1/2, 1/2)$ 同时使 $A(\\xi,\\eta)$ 达到其最小值，并使 $B(\\eta)$ 达到其最小值。因为两个因子都被最小化（一个取其最负值，另一个取其最小正值），它们的乘积将是 $J$ 可能的最小值。\n\n因此，雅可比行列式的最小值为：\n$$J_{min} = J(1/2, 1/2) = (1 - 0.4\\pi)(1 - 0.2\\pi)$$\n展开此表达式可得：\n$$J_{min} = 1 - 0.2\\pi - 0.4\\pi + (0.4\\pi)(0.2\\pi) = 1 - 0.6\\pi + 0.08\\pi^2$$\n这就是所要求的雅可比行列式最小值的闭式解析表达式。负的雅可比行列式表示网格的局部方向发生了“翻转”（即，映射不再保持方向），这会在数值模拟中引起严重问题。",
            "answer": "$$\\boxed{1 - 0.6\\pi + 0.08\\pi^2}$$"
        },
        {
            "introduction": "有限体积法的核心在于将控制方程在每个网格单元上积分，并通过单元边界的通量来近似。一个正确编写的通量计算程序，无论网格单元形状多么不规则，都必须满足一个基本准则：对于一个常数场，其散度应精确为零。这个被称为几何守恒律（Geometric Conservation Law, GCL）的性质是任何可靠CFD求解器的基石。本实践将指导你编写一个完整的通量求和程序，并在一系列不同形状的单元上验证这一基本性质，确保你的离散算子在几何上是正确的。",
            "id": "3949241",
            "problem": "在计算流体动力学 (CFD) 的背景下，考虑一个由平面多边形面组成的三维非结构化控制体。设恒定速度场表示为 $\\boldsymbol{u}$，其分量为 $(u_x, u_y, u_z)$，单位为米/秒 (m/s)。散度 $\\nabla \\cdot \\boldsymbol{u}$ 的单位为每秒 ($\\mathrm{s}^{-1}$)。从高斯散度定理和基本矢量微积分出发，设计一个面通量循环。对于一个恒定场，该循环对任何具有平面面和外向面法向面积矢量的封闭多面体控制体，都能计算出精确为零的离散散度。你的实现必须通过对所有面上的净外向通量求和，并用控制体体积进行归一化，来计算恒定矢量场的散度。你必须从第一性原理推导出每个面和体积所需的几何量（不得在问题陈述中引用捷径或预先推导的公式），确保科学真实性以及与具体单元形状的无关性。\n\n你需要：\n- 从面顶点为每个平面多边形面构建外向的面法向面积矢量。\n- 基于控制体中心，构建一个鲁棒的面方向检查和校正机制，以确保所有面法向面积矢量一致地指向外部。\n- 使用与面相同的几何构建模块计算控制体体积。\n- 实现通量循环，并计算恒定场 $\\boldsymbol{u}$ 的离散散度。\n- 验证离散精确性（散度必须计算为零）的绝对值，且与单元形状无关，从而测试通量循环的正确性。\n\n所有空间坐标的单位为米 (m)。所有散度输出的单位必须为每秒 ($\\mathrm{s}^{-1}$)。如果内部使用角度，则必须以弧度为单位。最终输出必须是数值浮点数。\n\n测试套件：\n使用以下五个单元和恒定场：\n- 恒定速度场：$\\boldsymbol{u} = (3.2, -1.7, 0.5)$，单位 m/s。\n\n单元 1 (边长为 $2\\,\\mathrm{m}$ 的平移轴对齐立方体)：\n定义顶点\n$v_{000} = (1, 2, 3)$, $v_{100} = (3, 2, 3)$, $v_{010} = (1, 4, 3)$, $v_{110} = (3, 4, 3)$, $v_{001} = (1, 2, 5)$, $v_{101} = (3, 2, 5)$, $v_{011} = (1, 4, 5)$, $v_{111} = (3, 4, 5)$。\n面（每个面表示为顶点标签的有序列表）：\n$[v_{000}, v_{100}, v_{110}, v_{010}]$, $[v_{001}, v_{011}, v_{111}, v_{101}]$, $[v_{000}, v_{010}, v_{011}, v_{001}]$, $[v_{100}, v_{101}, v_{111}, v_{110}]$, $[v_{000}, v_{001}, v_{101}, v_{100}]$, $[v_{010}, v_{110}, v_{111}, v_{011}]$。\n\n单元 2 (均匀剪切的六面体，平面)：\n设平移矢量为 $\\boldsymbol{t} = (-2.2, 0.5, 1.1)$，$x$ 方向的顶部剪切量为 $\\Delta_x = 0.5$。定义顶点\n$b_{000} = \\boldsymbol{t} + (0.0, 0.0, 0.0)$,\n$b_{100} = \\boldsymbol{t} + (2.0, 0.0, 0.0)$,\n$b_{010} = \\boldsymbol{t} + (0.0, 1.5, 0.0)$,\n$b_{110} = \\boldsymbol{t} + (2.0, 1.5, 0.0)$,\n$b_{001} = \\boldsymbol{t} + (0.5, 0.0, 2.5)$,\n$b_{101} = \\boldsymbol{t} + (2.5, 0.0, 2.5)$,\n$b_{011} = \\boldsymbol{t} + (0.5, 1.5, 2.5)$,\n$b_{111} = \\boldsymbol{t} + (2.5, 1.5, 2.5)$。\n面：\n$[b_{000}, b_{100}, b_{110}, b_{010}]$,\n$[b_{001}, b_{011}, b_{111}, b_{101}]$,\n$[b_{000}, b_{010}, b_{011}, b_{001}]$,\n$[b_{100}, b_{101}, b_{111}, b_{110}]$,\n$[b_{000}, b_{001}, b_{101}, b_{100}]$,\n$[b_{010}, b_{110}, b_{111}, b_{011}]$。\n\n单元 3 (三角柱体，顶部平移并有轻微偏移)：\n设 $\\boldsymbol{t} = (1.0, -0.3, 4.0)$ 且 $\\boldsymbol{s} = (0.2, -0.1, 1.4)$。\n底部三角形顶点：\n$a_0 = \\boldsymbol{t} + (0.0, 0.0, 0.0)$,\n$b_0 = \\boldsymbol{t} + (1.2, 0.1, 0.0)$,\n$c_0 = \\boldsymbol{t} + (0.3, 1.1, 0.0)$。\n顶部三角形顶点：\n$a_1 = a_0 + \\boldsymbol{s}$,\n$b_1 = b_0 + \\boldsymbol{s}$,\n$c_1 = c_0 + \\boldsymbol{s}$。\n面：\n$[a_0, b_0, c_0]$,\n$[a_1, c_1, b_1]$,\n$[a_0, b_0, b_1, a_1]$,\n$[b_0, c_0, c_1, b_1]$,\n$[c_0, a_0, a_1, c_1]$。\n\n单元 4 (近简并的薄片四面体)：\n设 $\\boldsymbol{t} = (-0.7, 2.2, -1.3)$。\n顶点：\n$t_0 = \\boldsymbol{t} + (0.0, 0.0, 0.0)$,\n$t_1 = \\boldsymbol{t} + (1.0, 0.0, 0.0)$,\n$t_2 = \\boldsymbol{t} + (2.0, 0.01, 0.0)$,\n$t_3 = \\boldsymbol{t} + (1.0, 0.005, 0.001)$。\n面：\n$[t_0, t_2, t_1]$,\n$[t_0, t_1, t_3]$,\n$[t_1, t_2, t_3]$,\n$[t_2, t_0, t_3]$。\n\n单元 5 (四棱锥)：\n设 $\\boldsymbol{t} = (3.0, -1.0, 2.0)$。\n底部顶点：\n$s_0 = \\boldsymbol{t} + (0.0, 0.0, 0.0)$,\n$s_1 = \\boldsymbol{t} + (2.0, 0.0, 0.0)$,\n$s_2 = \\boldsymbol{t} + (2.0, 2.0, 0.0)$,\n$s_3 = \\boldsymbol{t} + (0.0, 2.0, 0.0)$。\n顶点：\n$s_4 = \\boldsymbol{t} + (1.0, 1.0, 1.5)$。\n面：\n$[s_0, s_1, s_2, s_3]$,\n$[s_0, s_1, s_4]$,\n$[s_1, s_2, s_4]$,\n$[s_2, s_3, s_4]$,\n$[s_3, s_0, s_4]$。\n\n答案规格：\n- 对于测试套件中的每个单元，使用你推导的几何构造，通过对所有面通量求和并用体积进行归一化，计算恒定场 $\\boldsymbol{u}$ 的离散散度的绝对值，单位为 $\\mathrm{s}^{-1}$。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如：$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$），列表中的每个条目是上述相应单元的散度绝对值，单位为 $\\mathrm{s}^{-1}$。\n\n覆盖性设计：\n- 轴对齐立方体测试了简单几何体上的理想路径。\n- 均匀剪切的六面体测试了非正交但平面的情况。\n- 三角柱体测试了带有平移的混合三角形和四边形面的情况。\n- 薄片四面体测试了近简并几何和数值鲁棒性。\n- 四棱锥测试了混合多边形类型和顶点连接性。\n\n你的解决方案必须是一个完整的、可运行的程序，实现上述要求并输出指定格式。不允许用户输入。",
            "solution": "该问题陈述是计算几何在计算流体动力学（CFD）有限体积法应用中的一个有效练习。它要求实现用于计算多面体控制体几何属性的基本算法，并使用这些算法来验证数值通量格式的一个关键特性：对恒定场的精确保持。\n\n需要验证的核心原理是高斯散度定理的一个推论。该定理指出，对于一个矢量场 $\\boldsymbol{u}$ 和一个由曲面 $\\partial V$ 包围的体积 $V$，以下关系成立：\n$$ \\int_V (\\nabla \\cdot \\boldsymbol{u}) \\, dV = \\oint_{\\partial V} \\boldsymbol{u} \\cdot d\\boldsymbol{S} $$\n在有限体积法的背景下，体积 $V$ 是一个控制体（或单元），面积分被离散化为构成单元边界 $\\partial V$ 的所有平面 $f$ 上的通量之和：\n$$ \\oint_{\\partial V} \\boldsymbol{u} \\cdot d\\boldsymbol{S} \\approx \\sum_{f \\in \\partial V} (\\boldsymbol{u}_f \\cdot \\boldsymbol{A}_f) $$\n其中 $\\boldsymbol{u}_f$ 是面上的速度，$\\boldsymbol{A}_f$ 是面的外向面积矢量。离散散度则近似为净通量除以单元体积：\n$$ (\\nabla \\cdot \\boldsymbol{u})_V \\approx \\frac{1}{V} \\sum_{f \\in \\partial V} (\\boldsymbol{u}_f \\cdot \\boldsymbol{A}_f) $$\n问题指定了一个恒定速度场 $\\boldsymbol{u}(\\boldsymbol{r}) = \\boldsymbol{u}_{\\text{const}}$。对于这样的场，其解析散度精确为零：$\\nabla \\cdot \\boldsymbol{u} = 0$。因此，体积分为零，并且根据散度定理，通过任何闭合曲面的净通量也必须为零。为了使一个离散格式对恒定场是“精确”的，其离散散度也必须为零。对于恒定场，离散通量和变为：\n$$ \\sum_{f} (\\boldsymbol{u} \\cdot \\boldsymbol{A}_f) = \\boldsymbol{u} \\cdot \\left(\\sum_{f} \\boldsymbol{A}_f\\right) $$\n任何封闭多面体的一个基本几何性质是，其所有外向面法向面积矢量的和为零矢量：\n$$ \\sum_{f} \\boldsymbol{A}_f = \\boldsymbol{0} $$\n这个“封闭”性质可以通过将散度定理应用于一个恒定矢量场（例如 $\\boldsymbol{k}=(1,0,0)$）来证明，对于该场有 $\\nabla \\cdot \\boldsymbol{k} = 0$。这导致 $\\boldsymbol{k} \\cdot (\\sum_f \\boldsymbol{A}_f) = 0$，表明矢量和的 $x$ 分量为零。对 $y$ 和 $z$ 方向的单位矢量重复此过程，可以证实该矢量和为 $\\boldsymbol{0}$。\n\n因此，对于一个恒定场，总通量必须精确为零：$\\boldsymbol{u} \\cdot \\boldsymbol{0} = 0$。因此，离散散度的计算结果应为零，其误差仅受浮点精度限制。本任务就是通过实现几何计算来验证这一性质。\n\n实现将按以下步骤进行：\n\n**1. 面法向面积矢量的计算**\n对于一个由 $n$ 个顶点 $\\boldsymbol{v}_0, \\boldsymbol{v}_1, \\dots, \\boldsymbol{v}_{n-1}$ 的有序列表定义的平面多边形，其面积矢量 $\\boldsymbol{A}_f$ 可以使用一种类似于二维鞋带公式的方法（常称为 Newell 方法）进行鲁棒计算。面积矢量的分量由以下公式给出：\n$$ A_x = \\frac{1}{2} \\sum_{i=0}^{n-1} (y_i z_{i+1} - z_i y_{i+1}) $$\n$$ A_y = \\frac{1}{2} \\sum_{i=0}^{n-1} (z_i x_{i+1} - x_i z_{i+1}) $$\n$$ A_z = \\frac{1}{2} \\sum_{i=0}^{n-1} (x_i y_{i+1} - y_i x_{i+1}) $$\n其中 $(\\boldsymbol{v}_i)_x = x_i$，索引 $i+1$ 对 $n$ 取模（即 $\\boldsymbol{v}_n = \\boldsymbol{v}_0$）。所得矢量 $\\boldsymbol{A}_f = (A_x, A_y, A_z)$ 的方向由顶点的环绕顺序通过右手定则确定。\n\n**2. 面方向校正**\n问题中提供的面的顶点排序可能不一致。因此，我们必须为所有面法向面积矢量强制采用一致的外向方向。\n   a. 通过对其所有唯一顶点的坐标求平均，计算控制体的近似几何中心 $\\boldsymbol{c}_V$。对于凸单元，该点保证位于其内部，对于一般多面体，它是一个合理的参考点。\n   b. 对每个面，通过对其顶点的坐标求平均，计算其中心 $\\boldsymbol{c}_f$。\n   c. 构造一个从单元中心指向面中心的矢量 $\\boldsymbol{d} = \\boldsymbol{c}_f - \\boldsymbol{c}_V$。\n   d. 使用初始的顶点顺序计算面法向面积矢量 $\\boldsymbol{A}_f$。\n   e. 如果点积 $\\boldsymbol{A}_f \\cdot \\boldsymbol{d}$ 为负，则表示 $\\boldsymbol{A}_f$ 指向内部。为了校正这一点，我们必须翻转其方向：$\\boldsymbol{A}_f \\leftarrow -\\boldsymbol{A}_f$。为保持后续计算（如体积计算）的一致性，面的顶点环绕顺序也必须反转。\n\n**3. 控制体体积计算**\n多面体的体积通过将其分解为多个四面体来计算。我们可以将由每个表面三角形和坐标系原点 $\\boldsymbol{O}$ 构成的四面体的带符号体积求和。\n   a. 首先，每个多边形面 $f$（其顶点已按校正后的外向顺序排列）必须被三角化。对于本问题中的凸平面多边形，从第一个顶点 $\\boldsymbol{v}_0$ 开始的简单扇形三角剖分即可。这些三角形为 $(\\boldsymbol{v}_0, \\boldsymbol{v}_i, \\boldsymbol{v}_{i+1})$，其中 $i=1, \\dots, n-2$。\n   b. 一个以 $\\boldsymbol{O}, \\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}$ 为顶点的四面体的带符号体积由标量三重积给出：$V_{\\text{tet}} = \\frac{1}{6} \\det([\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}]) = \\frac{1}{6} (\\boldsymbol{a} \\cdot (\\boldsymbol{b} \\times \\boldsymbol{c}))$。\n   c. 多面体的总体积 $V$ 是构成其边界的所有三角形所对应的带符号体积之和：\n      $$ V = \\sum_{T_j=(\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c}) \\in \\partial V} \\frac{1}{6} (\\boldsymbol{a} \\cdot (\\boldsymbol{b} \\times \\boldsymbol{c})) $$\n   该方法是鲁棒的，并且源于将散度定理应用于场 $\\boldsymbol{F}(\\boldsymbol{r})=\\boldsymbol{r}/3$。\n\n**4. 离散散度计算**\n在所有几何量都已正确计算后，最终的计算就非常直接了。\n   a. 使用恒定速度场 $\\boldsymbol{u}$ 和校正后的外向面积矢量 $\\boldsymbol{A}_f$，通过对每个面的贡献求和来计算总通量：\n      $$ \\Phi = \\sum_{f} (\\boldsymbol{u} \\cdot \\boldsymbol{A}_f) $$\n   b. 离散散度是总通量除以单元体积：\n      $$ (\\nabla \\cdot \\boldsymbol{u})_V = \\frac{\\Phi}{V} $$\n根据理论，我们预期 $(\\nabla \\cdot \\boldsymbol{u})_V$ 的值在浮点误差范围内为零。最终答案将是这个计算出的散度的绝对值。",
            "answer": "[0,0,0,0,0]"
        },
        {
            "introduction": "获得数值解仅仅是CFD分析的第一步；评估其可靠性同样至关重要。由于我们总是在离散的网格上求解，因此离散化误差是不可避免的。本练习介绍了一种系统性的验证方法——网格收敛性指数（Grid Convergence Index, GCI），它被广泛用于量化由于网格分辨率不足所引入的数值不确定度。通过处理一组在系统加密的网格上得到的模拟数据，你将学会如何计算观测到的收敛阶并估算解的误差范围，这是发表可信的计算结果所必备的一项关键技能。",
            "id": "3949223",
            "problem": "对一个对称翼型的二维外部绕流进行雷诺平均纳维-斯托克斯 (RANS) 计算，使用了一族由三套系统加密的、拓扑相似的结构化网格。设特征网格间距为 $h_1  h_2  h_3$。从每套网格中提取的积分标量（例如，阻力系数 $C_D$）分别为 $Q_1$, $Q_2$ 和 $Q_3$。数值解被认为处于渐近区域，其误差可以建模为 $Q(h) = Q_{\\text{exact}} + \\alpha h^p + \\dots$，其中 $p$ 是观测到的精度阶。\n\n问题：\n1.  给定三个解 $Q_1, Q_2, Q_3$ 和恒定的加密比 $r = h_2/h_1 = h_3/h_2$，推导出观测精度阶 $p$ 的符号表达式。\n2.  利用 Richardson 外推法，推导出基于两套最密网格的解（$Q_1, Q_2$）、加密比 $r$ 和观测精度阶 $p$ 的精确解 $Q^*$ 的符号表达式。\n3.  基于 $Q_1$ 和 $Q_2$ 的解以及安全因子 $F_s$，构建最密网格解 $Q_1$ 的网格收敛指数 (GCI) 的符号表达式。\n4.  使用以下数据，计算最密网格的 GCI，四舍五入到四位有效数字：\n    -   $h_1=0.00050, h_2=0.00100, h_3=0.00200$\n    -   $C_D(h_1)=0.02340, C_D(h_2)=0.02370, C_D(h_3)=0.02490$\n    -   $F_s=1.25$\n\n答案必须是一个数值，不带任何单位。最终答案应以四位有效数字给出。",
            "solution": "问题陈述已经过严格审查并被确定为有效。它在科学上基于数值分析和计算流体力学的原理，特别是 Richardson 外推法和网格收敛指数 (GCI)。该问题是自洽的、适定的，并且所有提供的数据都是一致且足以获得唯一解。因此，我们可以进行正式求解。\n\n问题要求基于从数值模拟中获得的标量 $Q$ 的渐近离散误差模型完成四个连续的任务：\n$$Q(h) = Q^{\\ast} + \\alpha h^{p} + \\mathcal{O}\\!\\left(h^{p+1}\\right)$$\n在此模型中，$Q(h)$ 是特征间距为 $h$ 的网格上的解，$Q^{\\ast}$ 是精确的、网格无关的解（连续介质值），$p$ 是数值格式的精度阶，$\\alpha$ 是一个与 $h$ 无关的常数。问题提供了来自三套系统加密网格的数据，其特征间距为 $h_1  h_2  h_3$，恒定加密比为 $r = h_2/h_1 = h_3/h_2$。设对应的解为 $Q_1 = Q(h_1)$、$Q_2 = Q(h_2)$ 和 $Q_3 = Q(h_3)$。\n\n**1) 观测精度阶 $p$ 的推导**\n\n假设模拟处于渐近区域，我们可以忽略高阶项，并为这三个解写出误差模型：\n$$Q_1 = Q^{\\ast} + \\alpha h_1^{p}$$\n$$Q_2 = Q^{\\ast} + \\alpha h_2^{p}$$\n$$Q_3 = Q^{\\ast} + \\alpha h_3^{p}$$\n使用恒定的加密比 $r$，我们有 $h_2 = r h_1$ 和 $h_3 = r h_2 = r^2 h_1$。将这些关系代入方程，得到：\n$$Q_1 = Q^{\\ast} + \\alpha h_1^{p}$$\n$$Q_2 = Q^{\\ast} + \\alpha (r h_1)^{p} = Q^{\\ast} + \\alpha h_1^{p} r^{p}$$\n$$Q_3 = Q^{\\ast} + \\alpha (r^2 h_1)^{p} = Q^{\\ast} + \\alpha h_1^{p} r^{2p}$$\n为了找到 $p$ 的表达式，我们通过考虑解之间的差值来消去未知量 $Q^{\\ast}$ 和 $\\alpha$：\n中等网格和最密网格上的解之差为：\n$$\\epsilon_{21} = Q_2 - Q_1 = (Q^{\\ast} + \\alpha h_1^{p} r^{p}) - (Q^{\\ast} + \\alpha h_1^{p}) = \\alpha h_1^{p} (r^{p} - 1)$$\n最粗网格和中等网格上的解之差为：\n$$\\epsilon_{32} = Q_3 - Q_2 = (Q^{\\ast} + \\alpha h_1^{p} r^{2p}) - (Q^{\\ast} + \\alpha h_1^{p} r^{p}) = \\alpha h_1^{p} r^{p} (r^{p} - 1)$$\n现在，我们求这两个差值的比值：\n$$\\frac{\\epsilon_{32}}{\\epsilon_{21}} = \\frac{Q_3 - Q_2}{Q_2 - Q_1} = \\frac{\\alpha h_1^{p} r^{p} (r^{p} - 1)}{\\alpha h_1^{p} (r^{p} - 1)} = r^{p}$$\n为了求解 $p$，我们对等式两边取自然对数：\n$$\\ln\\left(\\frac{Q_3 - Q_2}{Q_2 - Q_1}\\right) = \\ln(r^{p}) = p \\ln(r)$$\n分离出 $p$，得到所需的观测精度阶表达式：\n$$p = \\frac{\\ln\\left(\\frac{Q_3 - Q_2}{Q_2 - Q_1}\\right)}{\\ln(r)}$$\n\n**2) Richardson 外推值 $Q^{\\ast}$ 的推导**\n\n我们寻求使用来自两套最密网格的解 $Q_1$ 和 $Q_2$、加密比 $r$ 以及观测精度阶 $p$ 来估计连续介质值 $Q^{\\ast}$。\n我们再次从 $Q_1$ 和 $Q_2$ 的两个方程开始：\n$$Q_1 = Q^{\\ast} + \\alpha h_1^{p}$$\n$$Q_2 = Q^{\\ast} + \\alpha h_2^{p} = Q^{\\ast} + \\alpha (r h_1)^{p} = Q^{\\ast} + \\alpha h_1^{p} r^{p}$$\n我们的目标是消去项 $\\alpha h_1^p$。从第一个方程，我们有 $\\alpha h_1^{p} = Q_1 - Q^{\\ast}$。将其代入第二个方程得到：\n$$Q_2 = Q^{\\ast} + (Q_1 - Q^{\\ast}) r^{p}$$\n展开右边：\n$$Q_2 = Q^{\\ast} + Q_1 r^{p} - Q^{\\ast} r^{p}$$\n现在，我们求解 $Q^{\\ast}$：\n$$Q_2 - Q_1 r^{p} = Q^{\\ast}(1 - r^{p})$$\n$$Q^{\\ast} = \\frac{Q_2 - Q_1 r^{p}}{1 - r^{p}} = \\frac{Q_1 r^{p} - Q_2}{r^{p} - 1}$$\n通过在分子上加上和减去 $Q_1$，这个表达式可以重新整理成一个更常见的形式：\n$$Q^{\\ast} = \\frac{Q_1 r^{p} - Q_1 + Q_1 - Q_2}{r^{p} - 1} = \\frac{Q_1(r^{p} - 1)}{r^{p} - 1} + \\frac{Q_1 - Q_2}{r^{p} - 1}$$\n这简化为 Richardson 外推法的标准形式：\n$$Q^{\\ast} = Q_1 + \\frac{Q_1 - Q_2}{r^{p} - 1}$$\n或者，使用符号 $Q(h_1)$ 和 $Q(h_2)$：\n$$Q^{\\ast} = Q(h_1) + \\frac{Q(h_1) - Q(h_2)}{r^{p} - 1}$$\n\n**3) 网格收敛指数 (GCI) 的构建**\n\nGCI 是由离散误差引起的数值不确定度的一种度量。它基于最密网格解的误差估计。最密网格解的真实误差是 $\\mathcal{E}_1 = Q_1 - Q^{\\ast}$。使用 Richardson 外推值 $Q^{\\ast}$ 作为连续介质值的最佳估计，我们可以找到这个误差的一个近似值，记为 $\\mathcal{E}_a$：\n$$\\mathcal{E}_a = Q_1 - Q^{\\ast} \\approx Q(h_1) - \\left( Q(h_1) + \\frac{Q(h_1) - Q(h_2)}{r^{p} - 1} \\right) = - \\frac{Q(h_1) - Q(h_2)}{r^{p} - 1} = \\frac{Q(h_2) - Q(h_1)}{r^{p} - 1}$$\n问题要求将 GCI 表示为 $Q(h_1)$ 中的分数不确定度。这定义为近似相对误差的绝对值乘以一个安全因子 $F_s$。近似相对误差为 $\\mathcal{E}_a / Q(h_1)$。\n$$GCI_{\\text{fine}} = F_s \\left| \\frac{\\mathcal{E}_a}{Q(h_1)} \\right| = F_s \\left| \\frac{ (Q(h_2) - Q(h_1))/(r^{p} - 1) }{Q(h_1)} \\right|$$\n这可以写成：\n$$GCI_{\\text{fine}} = \\frac{F_s}{|r^{p} - 1|} \\left| \\frac{Q(h_2) - Q(h_1)}{Q(h_1)} \\right|$$\n考虑到对于一个收敛的方法，$r>1$ 且我们期望 $p>0$，则 $r^p - 1 > 0$，因此分母上的绝对值是不必要的。\n$$GCI_{\\text{fine}} = \\frac{F_s}{r^{p} - 1} \\left| \\frac{Q(h_1) - Q(h_2)}{Q(h_1)} \\right|$$\n这是所要求的最密网格 GCI 的公式。安全因子 $F_s=1.25$ 用于三套或更多网格表现出单调收敛的情况，正如本例所示。\n\n**4) 最密网格 GCI 的计算**\n\n我们现在将推导出的公式应用于所提供的数据。\n已知条件如下：\n网格间距：$h_1 = 0.00050$, $h_2 = 0.00100$, $h_3 = 0.00200$。\n阻力系数：$C_D(h_1) = Q_1 = 0.02340$, $C_D(h_2) = Q_2 = 0.02370$, $C_D(h_3) = Q_3 = 0.02490$。\n安全因子：$F_s = 1.25$。\n\n首先，我们计算恒定的加密比 $r$：\n$$r = \\frac{h_2}{h_1} = \\frac{0.00100}{0.00050} = 2$$\n我们用另一对进行验证：$r = h_3/h_2 = 0.00200 / 0.00100 = 2$。该比率确实是恒定的，$r=2$。\n\n接下来，我们计算观测精度阶 $p$：\n$$p = \\frac{\\ln\\left(\\frac{Q_3 - Q_2}{Q_2 - Q_1}\\right)}{\\ln(r)}$$\n解的差值是：\n$$Q_3 - Q_2 = 0.02490 - 0.02370 = 0.00120$$\n$$Q_2 - Q_1 = 0.02370 - 0.02340 = 0.00030$$\n差值的比率是：\n$$\\frac{Q_3 - Q_2}{Q_2 - Q_1} = \\frac{0.00120}{0.00030} = 4$$\n将这些值代入 $p$ 的表达式中：\n$$p = \\frac{\\ln(4)}{\\ln(2)} = \\frac{\\ln(2^2)}{\\ln(2)} = \\frac{2 \\ln(2)}{\\ln(2)} = 2$$\n观测精度阶为 $p=2$。\n\n最后，我们使用第 3 部分推导的公式计算最密网格 GCI：\n$$GCI_{\\text{fine}} = \\frac{F_s}{r^{p} - 1} \\left| \\frac{Q_1 - Q_2}{Q_1} \\right|$$\n我们代入已知值：$F_s = 1.25$，$r=2$，$p=2$，$Q_1=0.02340$ 和 $Q_2=0.02370$。\n$$r^p - 1 = 2^2 - 1 = 4 - 1 = 3$$\n相对差值项是：\n$$\\left| \\frac{Q_1 - Q_2}{Q_1} \\right| = \\left| \\frac{0.02340 - 0.02370}{0.02340} \\right| = \\left| \\frac{-0.00030}{0.02340} \\right| = \\frac{0.00030}{0.02340}$$\n现在，我们计算 GCI：\n$$GCI_{\\text{fine}} = \\frac{1.25}{3} \\times \\frac{0.00030}{0.02340} = \\frac{1.25}{3} \\times \\frac{1}{78} = \\frac{1.25}{234}$$\n进行最后的除法运算：\n$$GCI_{\\text{fine}} = 0.00534188034...$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $5, 3, 4, 1$。下一位数字是 $8$，所以我们对最后一位进行向上取整。\n$$GCI_{\\text{fine}} \\approx 0.005342$$",
            "answer": "$$\\boxed{0.005342}$$"
        }
    ]
}