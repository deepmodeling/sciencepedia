{
    "hands_on_practices": [
        {
            "introduction": "This first exercise grounds the abstract theory of curvilinear coordinates with a direct, fundamental calculation. Starting from a given mapping, you will compute the covariant base vectors and then use them to determine the components of the metric tensor, $g_{ij}$, which locally defines the geometry of the coordinate system. This practice reinforces the core definitions and provides a concrete method for assessing local properties like orthogonality .",
            "id": "3952790",
            "problem": "A structured curvilinear mapping used in Computational Fluid Dynamics (CFD) to fit a curved aerospace boundary is given by the position vector $\\mathbf{x}(\\xi,\\eta,\\zeta) = \\big(x(\\xi,\\eta,\\zeta), y(\\xi,\\eta,\\zeta), z(\\xi,\\eta,\\zeta)\\big)$ with components\n$$\nx(\\xi,\\eta,\\zeta) = \\xi + \\eta \\zeta,\\quad\ny(\\xi,\\eta,\\zeta) = \\eta + \\xi \\zeta,\\quad\nz(\\xi,\\eta,\\zeta) = \\zeta + \\xi \\eta.\n$$\nAt the computational point $(\\xi,\\eta,\\zeta) = (\\,1,\\,-2,\\,1\\,)$, use the fundamental definitions of the covariant base vectors and the metric tensor in curvilinear coordinates to compute all metric components $g_{ij}$ at that point, and determine whether the coordinate lines are mutually orthogonal there by inspecting the off-diagonal metric components. For grading, report a single scalar quantity that encodes this orthogonality check:\n$$\nS \\equiv g_{12}^{2} + g_{13}^{2} + g_{23}^{2}.\n$$\nIf $S = 0$, the coordinate system is orthogonal at the point; if $S \\neq 0$, it is not. Provide the value of $S$ as your final answer. No rounding is required.",
            "solution": "The problem is valid as it presents a well-posed, scientifically grounded question in the domain of differential geometry as applied to computational fluid dynamics. It is self-contained, objective, and free from any scientific or mathematical flaws.\n\nThe problem requires the computation of a scalar quantity, $S$, which serves as an indicator of the orthogonality of a given curvilinear coordinate system at a specific point. The curvilinear coordinates are denoted by $(\\xi, \\eta, \\zeta)$, and the Cartesian coordinates are $(x, y, z)$. The transformation from the computational space $(\\xi, \\eta, \\zeta)$ to the physical space $(x, y, z)$ is defined by the position vector $\\mathbf{x}(\\xi,\\eta,\\zeta) = x(\\xi,\\eta,\\zeta)\\mathbf{i} + y(\\xi,\\eta,\\zeta)\\mathbf{j} + z(\\xi,\\eta,\\zeta)\\mathbf{k}$, where $\\mathbf{i}$, $\\mathbf{j}$, and $\\mathbf{k}$ are the standard Cartesian basis vectors. The given component functions are:\n$$\nx(\\xi,\\eta,\\zeta) = \\xi + \\eta \\zeta\n$$\n$$\ny(\\xi,\\eta,\\zeta) = \\eta + \\xi \\zeta\n$$\n$$\nz(\\xi,\\eta,\\zeta) = \\zeta + \\xi \\eta\n$$\nThe fundamental quantities that describe the local properties of a curvilinear coordinate system are the covariant base vectors, $\\mathbf{a}_1$, $\\mathbf{a}_2$, and $\\mathbf{a}_3$. These vectors are tangent to the coordinate lines and are defined as the partial derivatives of the position vector $\\mathbf{x}$ with respect to each curvilinear coordinate. Let us denote the curvilinear coordinates as $(q^1, q^2, q^3) = (\\xi, \\eta, \\zeta)$. The covariant base vectors are:\n$$\n\\mathbf{a}_i = \\frac{\\partial \\mathbf{x}}{\\partial q^i}\n$$\nSpecifically for our system:\n$$\n\\mathbf{a}_1 = \\frac{\\partial \\mathbf{x}}{\\partial \\xi} = \\frac{\\partial x}{\\partial \\xi}\\mathbf{i} + \\frac{\\partial y}{\\partial \\xi}\\mathbf{j} + \\frac{\\partial z}{\\partial \\xi}\\mathbf{k}\n$$\n$$\n\\mathbf{a}_2 = \\frac{\\partial \\mathbf{x}}{\\partial \\eta} = \\frac{\\partial x}{\\partial \\eta}\\mathbf{i} + \\frac{\\partial y}{\\partial \\eta}\\mathbf{j} + \\frac{\\partial z}{\\partial \\eta}\\mathbf{k}\n$$\n$$\n\\mathbf{a}_3 = \\frac{\\partial \\mathbf{x}}{\\partial \\zeta} = \\frac{\\partial x}{\\partial \\zeta}\\mathbf{i} + \\frac{\\partial y}{\\partial \\zeta}\\mathbf{j} + \\frac{\\partial z}{\\partial \\zeta}\\mathbf{k}\n$$\nWe compute the necessary partial derivatives from the given transformation equations:\n$$\n\\begin{array}{ccc}\n\\frac{\\partial x}{\\partial \\xi} = 1  \\frac{\\partial x}{\\partial \\eta} = \\zeta  \\frac{\\partial x}{\\partial \\zeta} = \\eta \\\\\n\\frac{\\partial y}{\\partial \\xi} = \\zeta  \\frac{\\partial y}{\\partial \\eta} = 1  \\frac{\\partial y}{\\partial \\zeta} = \\xi \\\\\n\\frac{\\partial z}{\\partial \\xi} = \\eta  \\frac{\\partial z}{\\partial \\eta} = \\xi  \\frac{\\partial z}{\\partial \\zeta} = 1\n\\end{array}\n$$\nSubstituting these into the definitions of the base vectors, we obtain their general expressions in terms of $(\\xi, \\eta, \\zeta)$:\n$$\n\\mathbf{a}_1 = 1\\mathbf{i} + \\zeta\\mathbf{j} + \\eta\\mathbf{k} = (1, \\zeta, \\eta)\n$$\n$$\n\\mathbf{a}_2 = \\zeta\\mathbf{i} + 1\\mathbf{j} + \\xi\\mathbf{k} = (\\zeta, 1, \\xi)\n$$\n$$\n\\mathbf{a}_3 = \\eta\\mathbf{i} + \\xi\\mathbf{j} + 1\\mathbf{k} = (\\eta, \\xi, 1)\n$$\nWe are asked to evaluate these quantities at the specific computational point $(\\xi,\\eta,\\zeta) = (\\,1,\\,-2,\\,1\\,)$. Substituting these values:\n$$\n\\mathbf{a}_1(\\,1,\\,-2,\\,1\\,) = (1, 1, -2)\n$$\n$$\n\\mathbf{a}_2(\\,1,\\,-2,\\,1\\,) = (1, 1, 1)\n$$\n$$\n\\mathbf{a}_3(\\,1,\\,-2,\\,1\\,) = (-2, 1, 1)\n$$\nThe components of the covariant metric tensor, $g_{ij}$, are defined by the scalar product (dot product) of the covariant base vectors:\n$$\ng_{ij} = \\mathbf{a}_i \\cdot \\mathbf{a}_j\n$$\nA coordinate system is locally orthogonal at a point if its base vectors are mutually orthogonal at that point. This geometric condition is equivalent to the algebraic condition that the off-diagonal components of the metric tensor are zero, i.e., $g_{ij} = 0$ for all $i \\neq j$. The problem requires us to compute the quantity $S \\equiv g_{12}^{2} + g_{13}^{2} + g_{23}^{2}$, which encapsulates this orthogonality check. We proceed to calculate the necessary off-diagonal metric components at the point $(\\,1,\\,-2,\\,1\\,)$:\n$$\ng_{12} = \\mathbf{a}_1 \\cdot \\mathbf{a}_2 = (1)(1) + (1)(1) + (-2)(1) = 1 + 1 - 2 = 0\n$$\n$$\ng_{13} = \\mathbf{a}_1 \\cdot \\mathbf{a}_3 = (1)(-2) + (1)(1) + (-2)(1) = -2 + 1 - 2 = -3\n$$\n$$\ng_{23} = \\mathbf{a}_2 \\cdot \\mathbf{a}_3 = (1)(-2) + (1)(1) + (1)(1) = -2 + 1 + 1 = 0\n$$\nSince $g_{13} = -3 \\neq 0$, the coordinate system is not mutually orthogonal at the specified point. The coordinate lines corresponding to $\\xi$ and $\\zeta$ are not perpendicular to each other. Now, we compute the final scalar quantity $S$:\n$$\nS = g_{12}^{2} + g_{13}^{2} + g_{23}^{2}\n$$\nSubstituting the calculated values of the metric components:\n$$\nS = (0)^{2} + (-3)^{2} + (0)^{2} = 0 + 9 + 0 = 9\n$$\nThe value of $S$ is $9$, which is non-zero, confirming that the coordinate system is not orthogonal at the point $(\\,1,\\,-2,\\,1\\,)$.",
            "answer": "$$\n\\boxed{9}\n$$"
        },
        {
            "introduction": "Building on the direct computation of metric components, this exercise connects these mathematical objects to tangible geometric quantities essential in Computational Fluid Dynamics. You will explore how the base vectors and the Jacobian determinant, $J$, combine to define the physical area of a computational cell face. This link is critical for formulating conservative finite-volume methods, where fluxes are integrated over cell surfaces .",
            "id": "3952786",
            "problem": "In the body-fitted formulation of Computational Fluid Dynamics (CFD), curvilinear coordinates are used to map a computational domain $(\\xi,\\eta)$ into a physical plane $(x,y)$, and differential geometric constructs such as covariant base vectors and the Jacobian determinant govern the transformation of geometric measures. Consider a smooth two-dimensional mapping from computational to physical space defined by the parametric immersion $\\mathbf{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta)\\big)$, and embed it into three dimensions by the trivial extension $\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta), \\zeta\\big)$. The covariant base vectors are defined by $\\mathbf{a}_{i} = \\partial \\mathbf{X}/\\partial q^{i}$ for $q^{1}=\\xi$, $q^{2}=\\eta$, and $q^{3}=\\zeta$, and the Jacobian determinant $J$ of the transformation is defined by the scalar triple product $J = \\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times\\mathbf{a}_{3})$.\n\nStarting only from these core definitions and vector calculus, first derive the expression for the physical surface area element associated with the computational element $d\\xi\\,d\\eta$ on the surface of constant $\\zeta$, and express it in terms of $\\mathbf{a}_{1}$, $\\mathbf{a}_{2}$, and $J$. Then, for the specific smooth mapping\n$$\nx(\\xi,\\eta) = \\xi^{2} - \\eta, \\qquad y(\\xi,\\eta) = \\xi\\,\\eta,\n$$\nembedded as $\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(\\xi^{2} - \\eta,\\ \\xi\\,\\eta,\\ \\zeta\\big)$, compute the analytic expression, in closed form, for the magnitude of the surface metric factor $||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}||$ as a function of $\\xi$ and $\\eta$.\n\nExpress your final answer as a single analytic expression in terms of $\\xi$ and $\\eta$. Do not include differentials in the final answer. No rounding is required.",
            "solution": "The problem statement must first be rigorously validated.\n\n### Step 1: Extract Givens\n- Computational domain coordinates: $(\\xi,\\eta)$.\n- Physical plane coordinates: $(x,y)$.\n- 2D mapping: $\\mathbf{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta)\\big)$.\n- 3D embedding: $\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta), \\zeta\\big)$.\n- Covariant base vectors: $\\mathbf{a}_{i} = \\partial \\mathbf{X}/\\partial q^{i}$ for a coordinate system $(q^{1}, q^{2}, q^{3}) = (\\xi, \\eta, \\zeta)$.\n- Jacobian determinant: $J = \\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times\\mathbf{a}_{3})$.\n- Specific mapping function: $x(\\xi,\\eta) = \\xi^{2} - \\eta$ and $y(\\xi,\\eta) = \\xi\\,\\eta$.\n- Specific 3D embedding: $\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(\\xi^{2} - \\eta,\\ \\xi\\,\\eta,\\ \\zeta\\big)$.\n- Task 1: Derive the expression for the physical surface area element $dS$ associated with the computational element $d\\xi\\,d\\eta$ on a surface of constant $\\zeta$, in terms of $\\mathbf{a}_{1}$, $\\mathbf{a}_{2}$, and $J$.\n- Task 2: Compute the analytic expression for the magnitude of the surface metric factor, $||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}||$, as a function of $\\xi$ and $\\eta$ for the specific mapping.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being based on standard definitions from differential geometry and vector calculus as applied in the field of computational fluid dynamics. It is well-posed, providing all necessary definitions and functions to arrive at a unique solution. The language is objective and formal. The problem is self-contained, consistent, and does not violate any fundamental principles. The tasks are specific and formalizable.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A full solution will be provided.\n\n### Solution Derivation\n\nThe problem is addressed in two parts as requested.\n\n**Part 1: Derivation of the Physical Surface Area Element**\n\nA surface of constant $\\zeta$ is a two-dimensional manifold embedded in three-dimensional space, parameterized by the coordinates $\\xi$ and $\\eta$. The position vector on this surface can be written as $\\mathbf{r}(\\xi, \\eta) = \\mathbf{X}(\\xi, \\eta, \\zeta=\\text{const})$.\n\nAn infinitesimal displacement vector on this surface is given by the total differential of $\\mathbf{r}$:\n$$d\\mathbf{r} = \\frac{\\partial \\mathbf{r}}{\\partial \\xi} d\\xi + \\frac{\\partial \\mathbf{r}}{\\partial \\eta} d\\eta$$\nThe partial derivatives $\\frac{\\partial \\mathbf{r}}{\\partial \\xi}$ and $\\frac{\\partial \\mathbf{r}}{\\partial \\eta}$ represent tangent vectors to the coordinate curves $\\eta=\\text{const}$ and $\\xi=\\text{const}$, respectively, on the surface.\n\nFrom the problem's core definitions, the covariant base vectors are $\\mathbf{a}_{i} = \\frac{\\partial \\mathbf{X}}{\\partial q^{i}}$. For our coordinate system $(q^{1}, q^{2}, q^{3}) = (\\xi, \\eta, \\zeta)$, we have:\n$$ \\mathbf{a}_{1} = \\frac{\\partial \\mathbf{X}}{\\partial \\xi} \\quad \\text{and} \\quad \\mathbf{a}_{2} = \\frac{\\partial \\mathbf{X}}{\\partial \\eta} $$\nSince the $\\zeta$ component of $\\mathbf{X}$ is independent of $\\xi$ and $\\eta$, and $\\zeta$ is held constant on our surface of interest, the tangent vectors to the surface are identical to the first two covariant base vectors:\n$$ \\frac{\\partial \\mathbf{r}}{\\partial \\xi} = \\mathbf{a}_{1} \\quad \\text{and} \\quad \\frac{\\partial \\mathbf{r}}{\\partial \\eta} = \\mathbf{a}_{2} $$\nThe infinitesimal physical surface area element, $dS$, corresponds to the area of the parallelogram spanned by the two infinitesimal displacement vectors $\\mathbf{a}_{1}d\\xi$ and $\\mathbf{a}_{2}d\\eta$. The area of this parallelogram is the magnitude of the cross product of these two vectors:\n$$ dS = ||(\\mathbf{a}_{1}d\\xi) \\times (\\mathbf{a}_{2}d\\eta)|| = ||\\mathbf{a}_{1} \\times \\mathbf{a}_{2}|| d\\xi d\\eta $$\nThis expresses the surface element in terms of $\\mathbf{a}_{1}$ and $\\mathbf{a}_{2}$. Now, we must relate this to the Jacobian determinant $J$.\n\nThe Jacobian $J$ is defined as $J = \\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times\\mathbf{a}_{3})$. This is the scalar triple product, which represents the volume of the parallelepiped spanned by the three base vectors. It can also be calculated as the determinant of the matrix whose rows (or columns) are the components of the base vectors.\n\nLet's compute the base vectors for the given embedding $\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta), \\zeta\\big)$. Let $x_\\xi = \\frac{\\partial x}{\\partial \\xi}$, $y_\\eta = \\frac{\\partial y}{\\partial \\eta}$, etc.\n$$ \\mathbf{a}_{1} = \\frac{\\partial \\mathbf{X}}{\\partial \\xi} = \\left( \\frac{\\partial x}{\\partial \\xi}, \\frac{\\partial y}{\\partial \\xi}, \\frac{\\partial \\zeta}{\\partial \\xi} \\right) = (x_{\\xi}, y_{\\xi}, 0) $$\n$$ \\mathbf{a}_{2} = \\frac{\\partial \\mathbf{X}}{\\partial \\eta} = \\left( \\frac{\\partial x}{\\partial \\eta}, \\frac{\\partial y}{\\partial \\eta}, \\frac{\\partial \\zeta}{\\partial \\eta} \\right) = (x_{\\eta}, y_{\\eta}, 0) $$\n$$ \\mathbf{a}_{3} = \\frac{\\partial \\mathbf{X}}{\\partial \\zeta} = \\left( \\frac{\\partial x}{\\partial \\zeta}, \\frac{\\partial y}{\\partial \\zeta}, \\frac{\\partial \\zeta}{\\partial \\zeta} \\right) = (0, 0, 1) = \\mathbf{k} $$\nThe cross product $\\mathbf{a}_{1} \\times \\mathbf{a}_{2}$ is:\n$$ \\mathbf{a}_{1} \\times \\mathbf{a}_{2} = \\det \\begin{pmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ x_{\\xi}  y_{\\xi}  0 \\\\ x_{\\eta}  y_{\\eta}  0 \\end{pmatrix} = (x_{\\xi}y_{\\eta} - y_{\\xi}x_{\\eta})\\mathbf{k} $$\nThe Jacobian $J$ is:\n$$ J = \\mathbf{a}_{1} \\cdot (\\mathbf{a}_{2} \\times \\mathbf{a}_{3}) = \\det(\\mathbf{a}_{1}, \\mathbf{a}_{2}, \\mathbf{a}_{3}) = \\det \\begin{pmatrix} x_{\\xi}  y_{\\xi}  0 \\\\ x_{\\eta}  y_{\\eta}  0 \\\\ 0  0  1 \\end{pmatrix} = (1) \\cdot (x_{\\xi}y_{\\eta} - x_{\\eta}y_{\\xi}) = x_{\\xi}y_{\\eta} - x_{\\eta}y_{\\xi} $$\nComparing the expressions, we see that for this specific type of embedding, $\\mathbf{a}_{1} \\times \\mathbf{a}_{2} = J\\mathbf{k}$.\nThe magnitude is therefore:\n$$ ||\\mathbf{a}_{1} \\times \\mathbf{a}_{2}|| = ||J\\mathbf{k}|| = |J| \\cdot ||\\mathbf{k}|| = |J| \\cdot 1 = |J| $$\nSubstituting this back into the expression for the area element $dS$:\n$$ dS = |J| d\\xi d\\eta $$\nThis provides the required expression for the physical surface area element in terms of the Jacobian $J$, which is itself defined by $\\mathbf{a}_{1}$, $\\mathbf{a}_{2}$, and $\\mathbf{a}_{3}$.\n\n**Part 2: Calculation for the Specific Mapping**\n\nThe second task is to compute the magnitude of the surface metric factor, $||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}||$, for the specific mapping:\n$$ x(\\xi,\\eta) = \\xi^{2} - \\eta $$\n$$ y(\\xi,\\eta) = \\xi\\,\\eta $$\nFrom Part 1, we established that for the given embedding structure, $||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}|| = |J|$, where $J = x_{\\xi}y_{\\eta} - x_{\\eta}y_{\\xi}$.\n\nWe first compute the necessary partial derivatives:\n$$ x_{\\xi} = \\frac{\\partial}{\\partial \\xi}(\\xi^{2} - \\eta) = 2\\xi $$\n$$ x_{\\eta} = \\frac{\\partial}{\\partial \\eta}(\\xi^{2} - \\eta) = -1 $$\n$$ y_{\\xi} = \\frac{\\partial}{\\partial \\xi}(\\xi\\,\\eta) = \\eta $$\n$$ y_{\\eta} = \\frac{\\partial}{\\partial \\eta}(\\xi\\,\\eta) = \\xi $$\nNow, we substitute these derivatives into the expression for the Jacobian $J$:\n$$ J = x_{\\xi}y_{\\eta} - x_{\\eta}y_{\\xi} = (2\\xi)(\\xi) - (-1)(\\eta) $$\n$$ J = 2\\xi^{2} + \\eta $$\nThe magnitude of the surface metric factor is the absolute value of the Jacobian:\n$$ ||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}|| = |J| = |2\\xi^{2} + \\eta| $$\nThis is the final analytic expression for the magnitude of the surface metric factor as a function of $\\xi$ and $\\eta$.",
            "answer": "$$\n\\boxed{|2\\xi^2 + \\eta|}\n$$"
        },
        {
            "introduction": "This final practice demonstrates the full power of curvilinear coordinate transformations in a sophisticated, real-world application: the Method of Manufactured Solutions (MMS). By calculating all the necessary metric terms ($J$ and $g^{ij}$) and their derivatives for a given mapping, you will derive the precise source term needed to make a simple analytic function an exact solution to the transformed diffusion equation. This procedure is a cornerstone of modern software verification for ensuring a CFD code is implemented correctly .",
            "id": "3952766",
            "problem": "Consider the scalar isotropic diffusion equation in physical space and its strong-form transformation into general curvilinear coordinates, written as $\\partial_{i}\\left(J\\,g^{ij}\\,\\partial_{j} q\\right)=J\\,s$, where $q$ is a scalar field, $s$ is a source term, $J$ is the Jacobian determinant of the coordinate transformation, and $g^{ij}$ are the contravariant metric components. In Computational Fluid Dynamics (CFD), a rigorous grid and operator verification strategy is the Method of Manufactured Solutions (MMS), which prescribes an exact solution and deduces the corresponding forcing term.\n\nYou are given the analytic mapping from computational coordinates $(\\xi,\\eta)$ to physical coordinates $(x,y)$,\n$$\nx(\\xi,\\eta)=\\xi+a\\,\\xi\\,\\eta,\\qquad y(\\xi,\\eta)=\\eta+b\\,\\xi^{2},\n$$\nwith $a$ and $b$ being positive constants, and the manufactured solution\n$$\nq(\\xi,\\eta)=\\xi+\\eta.\n$$\nUsing first principles for curvilinear coordinate transformations, namely the definitions of the covariant base vectors $\\mathbf{a}_{\\xi}=\\partial_{\\xi}\\mathbf{r}$ and $\\mathbf{a}_{\\eta}=\\partial_{\\eta}\\mathbf{r}$ for the position vector $\\mathbf{r}=(x,y)$, the Jacobian $J=\\det\\left[\\partial(x,y)/\\partial(\\xi,\\eta)\\right]$, the contravariant base vectors $\\mathbf{a}^{i}$ defined by $\\mathbf{a}^{i}\\cdot \\mathbf{a}_{j}=\\delta^{i}_{j}$, and the contravariant metric $g^{ij}=\\mathbf{a}^{i}\\cdot \\mathbf{a}^{j}$, derive the exact analytic expression of the source term $s(\\xi,\\eta)$ that makes $q(\\xi,\\eta)$ an exact solution of $\\partial_{i}\\left(J\\,g^{ij}\\,\\partial_{j} q\\right)=J\\,s$ under the given mapping. Express your final answer as a single closed-form analytic expression in terms of $\\xi$, $\\eta$, $a$, and $b$.\n\nIn addition, outline the logically complete MMS verification plan for a curvilinear-coordinate diffusion solver: state how boundary data are imposed to be consistent with the manufactured solution, describe the computation of the discrete residual and error norms, and specify the expected order-of-accuracy assessment strategy under mesh refinement. No numerical evaluation is required. The final answer must be the analytic $s(\\xi,\\eta)$ and must not include units or numerical values.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard exercise in the application of tensor calculus to derive a source term for the Method of Manufactured Solutions, a widely used verification technique in computational physics. All necessary information is provided, and there are no internal contradictions or logical flaws. We may therefore proceed with the derivation.\n\nThe governing equation is the scalar isotropic diffusion equation in strong conservation form for general curvilinear coordinates $(\\xi^1, \\xi^2) = (\\xi, \\eta)$:\n$$\n\\partial_{i}\\left(J\\,g^{ij}\\,\\partial_{j} q\\right)=J\\,s\n$$\nwhere summation over repeated indices $i, j \\in \\{\\xi, \\eta\\}$ is implied. The source term $s$ is given by:\n$$\ns = \\frac{1}{J} \\left[ \\partial_{\\xi}\\left(J\\,(g^{\\xi\\xi}\\partial_{\\xi} q + g^{\\xi\\eta}\\partial_{\\eta} q)\\right) + \\partial_{\\eta}\\left(J\\,(g^{\\eta\\xi}\\partial_{\\xi} q + g^{\\eta\\eta}\\partial_{\\eta} q)\\right) \\right]\n$$\nThe problem requires deriving the analytical expression for $s(\\xi, \\eta)$ given the coordinate transformation and a manufactured solution.\n\nFirst, we define the position vector $\\mathbf{r}$ and compute the partial derivatives of the coordinate transformation:\n$$\n\\mathbf{r}(\\xi, \\eta) = x(\\xi, \\eta)\\mathbf{i} + y(\\xi, \\eta)\\mathbf{j} = (\\xi+a\\,\\xi\\,\\eta)\\mathbf{i} + (\\eta+b\\,\\xi^{2})\\mathbf{j}\n$$\nThe partial derivatives with respect to the computational coordinates are:\n$$\nx_{\\xi} = \\frac{\\partial x}{\\partial \\xi} = 1 + a\\eta\n\\qquad\nx_{\\eta} = \\frac{\\partial x}{\\partial \\eta} = a\\xi\n$$\n$$\ny_{\\xi} = \\frac{\\partial y}{\\partial \\xi} = 2b\\xi\n\\qquad\ny_{\\eta} = \\frac{\\partial y}{\\partial \\eta} = 1\n$$\nThe Jacobian determinant of the transformation, $J$, is calculated as:\n$$\nJ = \\det\\begin{pmatrix} x_{\\xi}  x_{\\eta} \\\\ y_{\\xi}  y_{\\eta} \\end{pmatrix} = x_{\\xi} y_{\\eta} - x_{\\eta} y_{\\xi} = (1+a\\eta)(1) - (a\\xi)(2b\\xi) = 1 + a\\eta - 2ab\\xi^2\n$$\nFor a valid one-to-one mapping, we must have $J \\neq 0$ in the domain of interest.\n\nNext, we compute the components of the covariant metric tensor $g_{ij} = \\mathbf{a}_i \\cdot \\mathbf{a}_j$, where $\\mathbf{a}_{\\xi} = (x_{\\xi}, y_{\\xi})$ and $\\mathbf{a}_{\\eta} = (x_{\\eta}, y_{\\eta})$ are the covariant base vectors.\n$$\ng_{\\xi\\xi} = \\mathbf{a}_{\\xi} \\cdot \\mathbf{a}_{\\xi} = x_{\\xi}^2 + y_{\\xi}^2 = (1+a\\eta)^2 + (2b\\xi)^2 = 1 + 2a\\eta + a^2\\eta^2 + 4b^2\\xi^2\n$$\n$$\ng_{\\eta\\eta} = \\mathbf{a}_{\\eta} \\cdot \\mathbf{a}_{\\eta} = x_{\\eta}^2 + y_{\\eta}^2 = (a\\xi)^2 + 1^2 = 1 + a^2\\xi^2\n$$\n$$\ng_{\\xi\\eta} = \\mathbf{a}_{\\xi} \\cdot \\mathbf{a}_{\\eta} = x_{\\xi}x_{\\eta} + y_{\\xi}y_{\\eta} = (1+a\\eta)(a\\xi) + (2b\\xi)(1) = a\\xi + a^2\\xi\\eta + 2b\\xi\n$$\nThe contravariant metric components $g^{ij}$ are found by inverting the covariant metric tensor matrix $[g_{ij}]$. The determinant of the covariant metric tensor is $\\det[g_{ij}] = g_{\\xi\\xi}g_{\\eta\\eta} - g_{\\xi\\eta}^2 = J^2$.\n$$\n\\begin{pmatrix} g^{\\xi\\xi}  g^{\\xi\\eta} \\\\ g^{\\eta\\xi}  g^{\\eta\\eta} \\end{pmatrix} = \\frac{1}{J^2} \\begin{pmatrix} g_{\\eta\\eta}  -g_{\\xi\\eta} \\\\ -g_{\\eta\\xi}  g_{\\xi\\xi} \\end{pmatrix}\n$$\nIt is more convenient to work with the quantities $Jg^{ij}$:\n$$\nJg^{\\xi\\xi} = \\frac{g_{\\eta\\eta}}{J} = \\frac{1 + a^2\\xi^2}{1 + a\\eta - 2ab\\xi^2}\n$$\n$$\nJg^{\\eta\\eta} = \\frac{g_{\\xi\\xi}}{J} = \\frac{1 + 2a\\eta + a^2\\eta^2 + 4b^2\\xi^2}{1 + a\\eta - 2ab\\xi^2}\n$$\n$$\nJg^{\\xi\\eta} = Jg^{\\eta\\xi} = \\frac{-g_{\\xi\\eta}}{J} = \\frac{-(a\\xi + a^2\\xi\\eta + 2b\\xi)}{1 + a\\eta - 2ab\\xi^2}\n$$\nThe manufactured solution is $q(\\xi, \\eta) = \\xi + \\eta$. Its partial derivatives are:\n$$\n\\partial_{\\xi} q = 1 \\qquad \\partial_{\\eta} q = 1\n$$\nLet the terms inside the divergence be $\\Phi^{\\xi}$ and $\\Phi^{\\eta}$:\n$$\n\\Phi^{\\xi} = J(g^{\\xi\\xi}\\partial_{\\xi} q + g^{\\xi\\eta}\\partial_{\\eta} q) = Jg^{\\xi\\xi} + Jg^{\\xi\\eta}\n$$\n$$\n\\Phi^{\\eta} = J(g^{\\eta\\xi}\\partial_{\\xi} q + g^{\\eta\\eta}\\partial_{\\eta} q) = Jg^{\\eta\\xi} + Jg^{\\eta\\eta}\n$$\nSubstituting the expressions for $Jg^{ij}$:\n$$\n\\Phi^{\\xi} = \\frac{1 + a^2\\xi^2 - (a\\xi + a^2\\xi\\eta + 2b\\xi)}{1 + a\\eta - 2ab\\xi^2}\n$$\n$$\n\\Phi^{\\eta} = \\frac{-(a\\xi + a^2\\xi\\eta + 2b\\xi) + (1 + 2a\\eta + a^2\\eta^2 + 4b^2\\xi^2)}{1 + a\\eta - 2ab\\xi^2}\n$$\nThe source term equation is $Js = \\partial_{\\xi}\\Phi^{\\xi} + \\partial_{\\eta}\\Phi^{\\eta}$. Let $D(\\xi,\\eta)=1+a\\eta-2ab\\xi^2$ be the denominator, $N_{\\xi}(\\xi,\\eta)$ be the numerator of $\\Phi^{\\xi}$, and $N_{\\eta}(\\xi,\\eta)$ be the numerator of $\\Phi^{\\eta}$.\n$$\n\\Phi^{\\xi} = \\frac{N_{\\xi}}{D}, \\qquad \\Phi^{\\eta} = \\frac{N_{\\eta}}{D}\n$$\nApplying the quotient rule for derivatives:\n$$\n\\partial_{\\xi}\\Phi^{\\xi} = \\frac{(\\partial_{\\xi}N_{\\xi})D - N_{\\xi}(\\partial_{\\xi}D)}{D^2}\n\\qquad\n\\partial_{\\eta}\\Phi^{\\eta} = \\frac{(\\partial_{\\eta}N_{\\eta})D - N_{\\eta}(\\partial_{\\eta}D)}{D^2}\n$$\nThe derivatives of the numerators and the denominator are:\n$$\n\\partial_{\\xi}N_{\\xi} = 2a^2\\xi - a - a^2\\eta - 2b\n$$\n$$\n\\partial_{\\eta}N_{\\eta} = 2a + 2a^2\\eta - a^2\\xi\n$$\n$$\n\\partial_{\\xi}D = -4ab\\xi\n\\qquad\n\\partial_{\\eta}D = a\n$$\nSumming the derivatives gives $Js = (\\partial_{\\xi}\\Phi^{\\xi} + \\partial_{\\eta}\\Phi^{\\eta})$. The numerator of $Js D^2$ is:\n$$\n\\text{Numerator} = [(\\partial_{\\xi}N_{\\xi})D - N_{\\xi}(\\partial_{\\xi}D)] + [(\\partial_{\\eta}N_{\\eta})D - N_{\\eta}(\\partial_{\\eta}D)]\n$$\n$$\n= [(\\partial_{\\xi}N_{\\xi}) + (\\partial_{\\eta}N_{\\eta})] D - N_{\\xi}(\\partial_{\\xi}D) - N_{\\eta}(\\partial_{\\eta}D)\n$$\nThe sum of the partials of the numerators:\n$$\n(\\partial_{\\xi}N_{\\xi}) + (\\partial_{\\eta}N_{\\eta}) = (2a^2\\xi - a - a^2\\eta - 2b) + (2a + 2a^2\\eta - a^2\\xi) = a^2\\xi + a + a^2\\eta - 2b\n$$\nThe remaining terms are $-N_{\\xi}(-4ab\\xi)$ and $-N_{\\eta}(a)$. After a lengthy but straightforward algebraic expansion and collection of terms, the total numerator simplifies to:\n$$\n\\text{Numerator} = 2a^3b\\xi^3 - 6a^3b\\xi^2\\eta - (6a^2b+8ab^2)\\xi^2 + 2a^3\\xi\\eta + (2a^2+6ab)\\xi - 2ab\\eta - 2b\n$$\nThus, $Js = \\frac{\\text{Numerator}}{D^2}$. Solving for $s$, we get:\n$$\ns = \\frac{1}{J} \\frac{\\text{Numerator}}{D^2} = \\frac{\\text{Numerator}}{D \\cdot D^2} = \\frac{\\text{Numerator}}{D^3}\n$$\n$$\ns(\\xi, \\eta) = \\frac{2a^3b\\xi^3 - 6a^3b\\xi^2\\eta - (6a^2b+8ab^2)\\xi^2 + 2a^3\\xi\\eta + (2a^2+6ab)\\xi - 2ab\\eta - 2b}{(1+a\\eta-2ab\\xi^2)^3}\n$$\n\nThe Method of Manufactured Solutions (MMS) verification plan for a curvilinear-coordinate diffusion solver using this source term involves the following steps:\n\n1.  **Boundary Condition Imposition**: The computational domain is defined in $(\\xi, \\eta)$ coordinates, for example, a unit square $[\\xi_1, \\xi_2] \\times [\\eta_1, \\eta_2]$. The manufactured solution $q(\\xi, \\eta) = \\xi + \\eta$ must be enforced on the boundaries of this domain. This is typically done by imposing Dirichlet boundary conditions. For any boundary node or cell face center with coordinates $(\\xi_b, \\eta_b)$, the value of the scalar field is set to $q_b = \\xi_b + \\eta_b$. This ensures that the boundary data are consistent with the exact solution.\n\n2.  **Computation of Discrete Error**: The numerical solver computes an approximate solution $q_h$ on a grid with a characteristic spacing $h$. The exact source term $s(\\xi, \\eta)$ is evaluated at the appropriate locations for the discrete scheme (e.g., cell centers for a finite-volume method) and used as input to the solver. Once the numerical solution $q_h$ is obtained, the discretization error $e_h$ is calculated by subtracting the exact solution $q_{ex}$ evaluated at the grid points/cells from the numerical solution: $e_h = q_h - q_{ex}$. To quantify the total error, various error norms are computed over the entire domain. The most common are the $L_1$, $L_2$, and $L_\\infty$ norms. For a grid with $N$ cells, the volume-weighted $L_p$ norm is:\n    $$\n    L_p(e_h) = \\left( \\frac{\\sum_{i=1}^{N} |e_{h,i}|^p V_i}{\\sum_{i=1}^{N} V_i} \\right)^{1/p}\n    $$\n    where $e_{h,i}$ is the error in cell $i$, and $V_i$ is the volume (or area in 2D) of cell $i$. In curvilinear coordinates, $V_i \\approx J_i \\Delta\\xi \\Delta\\eta$.\n\n3.  **Order-of-Accuracy Assessment**: To verify that the code is implemented correctly and achieves its theoretical order of accuracy, the simulation is run on a sequence of systematically refined meshes. For example, starting with a coarse grid of size $N \\times N$, one would generate grids of size $2N \\times 2N$, $4N \\times 4N$, and so on. Let $h_k$ denote the characteristic grid spacing for grid $k$ in the sequence (e.g., $h_k = 1/N_k$), and let $\\|e_k\\|$ be the computed error norm on that grid. If the numerical method has a theoretical order of accuracy $p$, the error is expected to behave as $\\|e_k\\| \\approx C h_k^p$ for some constant $C$. The observed order of accuracy, $p_{obs}$, can be calculated from the results on two successive grids, say with spacing $h_1$ and $h_2=h_1/r$ (where $r=2$ for doubling refinement):\n    $$\n    p_{obs} = \\frac{\\ln( \\|e_1\\| / \\|e_2\\| )}{\\ln(h_1 / h_2)} = \\frac{\\ln( \\|e_1\\| / \\|e_2\\| )}{\\ln(r)}\n    $$\n    The verification is successful if, as the mesh is refined, the observed order $p_{obs}$ asymptotes to the theoretical order $p$ of the discretization scheme.",
            "answer": "$$\n\\boxed{\\frac{2a^3b\\xi^3 - 6a^3b\\xi^2\\eta - (6a^2b+8ab^2)\\xi^2 + 2a^3\\xi\\eta + (2a^2+6ab)\\xi - 2ab\\eta - 2b}{(1+a\\eta-2ab\\xi^2)^3}}\n$$"
        }
    ]
}