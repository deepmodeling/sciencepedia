{
    "hands_on_practices": [
        {
            "introduction": "在处理曲线坐标时，首要任务是计算描述非笛卡尔坐标系局部几何特性的基本量。本练习将引导您直接从给定的坐标变换函数出发，计算协变基向量和度量张量分量 $g_{ij}$。通过计算这些项并检验坐标系在某一点的正交性，您将获得在计算流体力学（CFD）中应用张量分析的基本工具的实践经验 ()。",
            "id": "3952790",
            "problem": "在计算流体动力学 (CFD) 中，一个用于拟合弯曲航空航天边界的结构化曲线映射由位置向量 $\\mathbf{x}(\\xi,\\eta,\\zeta) = \\big(x(\\xi,\\eta,\\zeta), y(\\xi,\\eta,\\zeta), z(\\xi,\\eta,\\zeta)\\big)$ 给出，其分量为\n$$\nx(\\xi,\\eta,\\zeta) = \\xi + \\eta \\zeta,\\quad\ny(\\xi,\\eta,\\zeta) = \\eta + \\xi \\zeta,\\quad\nz(\\xi,\\eta,\\zeta) = \\zeta + \\xi \\eta.\n$$\n在计算点 $(\\xi,\\eta,\\zeta) = (\\,1,\\,-2,\\,1\\,)$ 处，使用曲线坐标中协变基向量和度量张量的基本定义，计算该点所有度量分量 $g_{ij}$，并通过检查非对角度量分量来确定坐标线在此处是否相互正交。为便于评分，请报告一个标量，该标量用于编码此正交性检查：\n$$\nS \\equiv g_{12}^{2} + g_{13}^{2} + g_{23}^{2}.\n$$\n若 $S = 0$，则坐标系在该点是正交的；若 $S \\neq 0$，则不是。请提供 $S$ 的值作为最终答案。无需四舍五入。",
            "solution": "该问题是有效的，因为它在微分几何应用于计算流体动力学领域提出了一个适定且有科学依据的问题。该问题是自洽的、客观的，并且没有任何科学或数学上的缺陷。\n\n该问题要求计算一个标量 $S$，它可作为给定曲线坐标系在特定点处正交性的一个指标。曲线坐标用 $(\\xi, \\eta, \\zeta)$ 表示，笛卡尔坐标用 $(x, y, z)$ 表示。从计算空间 $(\\xi, \\eta, \\zeta)$ 到物理空间 $(x, y, z)$ 的变换由位置向量 $\\mathbf{x}(\\xi,\\eta,\\zeta) = x(\\xi,\\eta,\\zeta)\\mathbf{i} + y(\\xi,\\eta,\\zeta)\\mathbf{j} + z(\\xi,\\eta,\\zeta)\\mathbf{k}$ 定义，其中 $\\mathbf{i}$、$\\mathbf{j}$ 和 $\\mathbf{k}$ 是标准笛卡尔基向量。给定的分量函数为：\n$$\nx(\\xi,\\eta,\\zeta) = \\xi + \\eta \\zeta\n$$\n$$\ny(\\xi,\\eta,\\zeta) = \\eta + \\xi \\zeta\n$$\n$$\nz(\\xi,\\eta,\\zeta) = \\zeta + \\xi \\eta\n$$\n描述曲线坐标系局部性质的基本量是协变基向量 $\\mathbf{g}_1$、$\\mathbf{g}_2$ 和 $\\mathbf{g}_3$。这些向量与坐标线相切，并定义为位置向量 $\\mathbf{x}$ 对每个曲线坐标的偏导数。我们将曲线坐标表示为 $(q^1, q^2, q^3) = (\\xi, \\eta, \\zeta)$。协变基向量为：\n$$\n\\mathbf{g}_i = \\frac{\\partial \\mathbf{x}}{\\partial q^i}\n$$\n对于我们的系统，具体来说：\n$$\n\\mathbf{g}_1 = \\frac{\\partial \\mathbf{x}}{\\partial \\xi} = \\frac{\\partial x}{\\partial \\xi}\\mathbf{i} + \\frac{\\partial y}{\\partial \\xi}\\mathbf{j} + \\frac{\\partial z}{\\partial \\xi}\\mathbf{k}\n$$\n$$\n\\mathbf{g}_2 = \\frac{\\partial \\mathbf{x}}{\\partial \\eta} = \\frac{\\partial x}{\\partial \\eta}\\mathbf{i} + \\frac{\\partial y}{\\partial \\eta}\\mathbf{j} + \\frac{\\partial z}{\\partial \\eta}\\mathbf{k}\n$$\n$$\n\\mathbf{g}_3 = \\frac{\\partial \\mathbf{x}}{\\partial \\zeta} = \\frac{\\partial x}{\\partial \\zeta}\\mathbf{i} + \\frac{\\partial y}{\\partial \\zeta}\\mathbf{j} + \\frac{\\partial z}{\\partial \\zeta}\\mathbf{k}\n$$\n我们根据给定的变换方程计算必要的偏导数：\n$$\n\\begin{array}{ccc}\n\\frac{\\partial x}{\\partial \\xi} = 1  \\frac{\\partial x}{\\partial \\eta} = \\zeta  \\frac{\\partial x}{\\partial \\zeta} = \\eta \\\\\n\\frac{\\partial y}{\\partial \\xi} = \\zeta  \\frac{\\partial y}{\\partial \\eta} = 1  \\frac{\\partial y}{\\partial \\zeta} = \\xi \\\\\n\\frac{\\partial z}{\\partial \\xi} = \\eta  \\frac{\\partial z}{\\partial \\eta} = \\xi  \\frac{\\partial z}{\\partial \\zeta} = 1\n\\end{array}\n$$\n将这些偏导数代入基向量的定义中，我们得到它们关于 $(\\xi, \\eta, \\zeta)$ 的一般表达式：\n$$\n\\mathbf{g}_1 = 1\\mathbf{i} + \\zeta\\mathbf{j} + \\eta\\mathbf{k} = (1, \\zeta, \\eta)\n$$\n$$\n\\mathbf{g}_2 = \\zeta\\mathbf{i} + 1\\mathbf{j} + \\xi\\mathbf{k} = (\\zeta, 1, \\xi)\n$$\n$$\n\\mathbf{g}_3 = \\eta\\mathbf{i} + \\xi\\mathbf{j} + 1\\mathbf{k} = (\\eta, \\xi, 1)\n$$\n题目要求我们在特定的计算点 $(\\xi,\\eta,\\zeta) = (\\,1,\\,-2,\\,1\\,)$ 处计算这些量。代入这些值：\n$$\n\\mathbf{g}_1(\\,1,\\,-2,\\,1\\,) = (1, 1, -2)\n$$\n$$\n\\mathbf{g}_2(\\,1,\\,-2,\\,1\\,) = (1, 1, 1)\n$$\n$$\n\\mathbf{g}_3(\\,1,\\,-2,\\,1\\,) = (-2, 1, 1)\n$$\n协变度量张量 $g_{ij}$ 的分量由协变基向量的标量积（点积）定义：\n$$\ng_{ij} = \\mathbf{g}_i \\cdot \\mathbf{g}_j\n$$\n如果一个坐标系的基向量在某一点相互正交，则该坐标系在该点是局部正交的。这个几何条件等价于一个代数条件，即度量张量的非对角分量为零，即对于所有 $i \\neq j$ 都有 $g_{ij} = 0$。问题要求我们计算量 $S \\equiv g_{12}^{2} + g_{13}^{2} + g_{23}^{2}$，它包含了这个正交性检查。我们继续计算在点 $(\\,1,\\,-2,\\,1\\,)$ 处必要的非对角度量分量：\n$$\ng_{12} = \\mathbf{g}_1 \\cdot \\mathbf{g}_2 = (1)(1) + (1)(1) + (-2)(1) = 1 + 1 - 2 = 0\n$$\n$$\ng_{13} = \\mathbf{g}_1 \\cdot \\mathbf{g}_3 = (1)(-2) + (1)(1) + (-2)(1) = -2 + 1 - 2 = -3\n$$\n$$\ng_{23} = \\mathbf{g}_2 \\cdot \\mathbf{g}_3 = (1)(-2) + (1)(1) + (1)(1) = -2 + 1 + 1 = 0\n$$\n由于 $g_{13} = -3 \\neq 0$，坐标系在指定点不是相互正交的。对应于 $\\xi$ 和 $\\zeta$ 的坐标线彼此不垂直。现在，我们计算最终的标量 $S$：\n$$\nS = g_{12}^{2} + g_{13}^{2} + g_{23}^{2}\n$$\n代入计算出的度量分量值：\n$$\nS = (0)^{2} + (-3)^{2} + (0)^{2} = 0 + 9 + 0 = 9\n$$\n$S$ 的值为 $9$，非零，这证实了坐标系在点 $(\\,1,\\,-2,\\,1\\,)$ 处不是正交的。",
            "answer": "$$\n\\boxed{9}\n$$"
        },
        {
            "introduction": "度量张量不仅能描述坐标系的局部拉伸和旋转，其在转换计算空间与物理空间之间的几何度量（如面积和体积）方面也扮演着至关重要的角色。本练习旨在探讨协变基向量、微分面积元以及变换雅可比行列式 $J$ 之间的内在联系。完成此问题将帮助您深刻理解雅可比行列式如何充当面积（或体积）的局部缩放因子，这是在复杂几何体上对控制方程进行积分的核心概念 ()。",
            "id": "3952786",
            "problem": "在计算流体动力学 (CFD) 的贴体坐标系公式化中，使用曲线坐标将计算域 $(\\xi,\\eta)$ 映射到物理平面 $(x,y)$，而诸如协变基向量和雅可比行列式等微分几何构造则控制着几何度量的变换。考虑一个从计算空间到物理空间的光滑二维映射，由参数化浸入 $\\mathbf{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta)\\big)$ 定义，并通过平凡扩张 $\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta), \\zeta\\big)$ 将其嵌入三维空间。协变基向量定义为 $\\mathbf{a}_{i} = \\partial \\mathbf{X}/\\partial q^{i}$（其中 $q^{1}=\\xi$, $q^{2}=\\eta$, $q^{3}=\\zeta$），变换的雅可比行列式 $J$ 由标量三重积 $J = \\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times\\mathbf{a}_{3})$ 定义。\n\n仅从这些核心定义和向量微积分出发，首先推导在 $\\zeta$ 为常数的曲面上，与计算元 $d\\xi\\,d\\eta$ 相关联的物理曲面面积元的表达式，并用 $\\mathbf{a}_{1}$、$\\mathbf{a}_{2}$ 和 $J$ 表示。然后，对于特定的光滑映射\n$$\nx(\\xi,\\eta) = \\xi^{2} - \\eta, \\qquad y(\\xi,\\eta) = \\xi\\,\\eta,\n$$\n嵌入为 $\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(\\xi^{2} - \\eta,\\ \\xi\\,\\eta,\\ \\zeta\\big)$，计算曲面度量因子 $||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}||$ 的模关于 $\\xi$ 和 $\\eta$ 的闭合形式解析表达式。\n\n将最终答案表示为关于 $\\xi$ 和 $\\eta$ 的单个解析表达式。最终答案中不应包含微分。无需四舍五入。",
            "solution": "首先必须严格验证问题陈述。\n\n### 第1步：提取已知条件\n- 计算域坐标：$(\\xi,\\eta)$。\n- 物理平面坐标：$(x,y)$。\n- 二维映射：$\\mathbf{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta)\\big)$。\n- 三维嵌入：$\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta), \\zeta\\big)$。\n- 协变基向量：对于坐标系 $(q^{1}, q^{2}, q^{3}) = (\\xi, \\eta, \\zeta)$，$\\mathbf{a}_{i} = \\partial \\mathbf{X}/\\partial q^{i}$。\n- 雅可比行列式：$J = \\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times\\mathbf{a}_{3})$。\n- 特定映射函数：$x(\\xi,\\eta) = \\xi^{2} - \\eta$ 和 $y(\\xi,\\eta) = \\xi\\,\\eta$。\n- 特定三维嵌入：$\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(\\xi^{2} - \\eta,\\ \\xi\\,\\eta,\\ \\zeta\\big)$。\n- 任务1：在 $\\zeta$ 为常数的曲面上，推导与计算元 $d\\xi\\,d\\eta$ 相关联的物理曲面面积元 $dS$ 的表达式，并用 $\\mathbf{a}_{1}$、$\\mathbf{a}_{2}$ 和 $J$ 表示。\n- 任务2：对于特定映射，计算曲面度量因子的模 $||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}||$ 作为 $\\xi$ 和 $\\eta$ 的函数的解析表达式。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，它基于微分几何和向量微积分在计算流体动力学领域应用的标准定义。这是一个适定问题，提供了得出唯一解所需的所有定义和函数。语言客观且正式。问题是自洽的、一致的，并且不违反任何基本原则。任务是具体的且可形式化的。\n\n### 第3步：结论与行动\n问题被认定为有效。将提供完整解答。\n\n### 解答推导\n\n按要求分两部分解决该问题。\n\n**第1部分：物理曲面面积元的推导**\n\n$\\zeta$ 为常数的曲面是一个嵌入三维空间中的二维流形，由坐标 $\\xi$ 和 $\\eta$ 参数化。此曲面上的位置向量可写作 $\\mathbf{r}(\\xi, \\eta) = \\mathbf{X}(\\xi, \\eta, \\zeta=\\text{const})$。\n\n此曲面上的无穷小位移向量由 $\\mathbf{r}$ 的全微分给出：\n$$d\\mathbf{r} = \\frac{\\partial \\mathbf{r}}{\\partial \\xi} d\\xi + \\frac{\\partial \\mathbf{r}}{\\partial \\eta} d\\eta$$\n偏导数 $\\frac{\\partial \\mathbf{r}}{\\partial \\xi}$ 和 $\\frac{\\partial \\mathbf{r}}{\\partial \\eta}$ 分别表示曲面上坐标曲线 $\\eta=\\text{const}$ 和 $\\xi=\\text{const}$ 的切向量。\n\n根据问题的核心定义，协变基向量为 $\\mathbf{a}_{i} = \\frac{\\partial \\mathbf{X}}{\\partial q^{i}}$。对于我们的坐标系 $(q^{1}, q^{2}, q^{3}) = (\\xi, \\eta, \\zeta)$，我们有：\n$$ \\mathbf{a}_{1} = \\frac{\\partial \\mathbf{X}}{\\partial \\xi} \\quad \\text{和} \\quad \\mathbf{a}_{2} = \\frac{\\partial \\mathbf{X}}{\\partial \\eta} $$\n由于 $\\mathbf{X}$ 的 $\\zeta$ 分量与 $\\xi$ 和 $\\eta$ 无关，并且在我们感兴趣的曲面上 $\\zeta$ 保持不变，因此曲面的切向量与前两个协变基向量相同：\n$$ \\frac{\\partial \\mathbf{r}}{\\partial \\xi} = \\mathbf{a}_{1} \\quad \\text{和} \\quad \\frac{\\partial \\mathbf{r}}{\\partial \\eta} = \\mathbf{a}_{2} $$\n无穷小物理曲面面积元 $dS$ 对应于由两个无穷小位移向量 $\\mathbf{a}_{1}d\\xi$ 和 $\\mathbf{a}_{2}d\\eta$ 张成的平行四边形的面积。这个平行四边形的面积是这两个向量叉积的模：\n$$ dS = ||(\\mathbf{a}_{1}d\\xi) \\times (\\mathbf{a}_{2}d\\eta)|| = ||\\mathbf{a}_{1} \\times \\mathbf{a}_{2}|| d\\xi d\\eta $$\n这就用 $\\mathbf{a}_{1}$ 和 $\\mathbf{a}_{2}$ 表示了曲面元。现在，我们必须将其与雅可比行列式 $J$ 联系起来。\n\n雅可比行列式 $J$ 定义为 $J = \\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times\\mathbf{a}_{3})$。这是标量三重积，表示由三个基向量张成的平行六面体的体积。它也可以通过以基向量的分量为行（或列）的矩阵的行列式来计算。\n\n让我们计算给定嵌入 $\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta), \\zeta\\big)$ 的基向量。令 $x_\\xi = \\frac{\\partial x}{\\partial \\xi}$，$y_\\eta = \\frac{\\partial y}{\\partial \\eta}$，依此类推。\n$$ \\mathbf{a}_{1} = \\frac{\\partial \\mathbf{X}}{\\partial \\xi} = \\left( \\frac{\\partial x}{\\partial \\xi}, \\frac{\\partial y}{\\partial \\xi}, \\frac{\\partial \\zeta}{\\partial \\xi} \\right) = (x_{\\xi}, y_{\\xi}, 0) $$\n$$ \\mathbf{a}_{2} = \\frac{\\partial \\mathbf{X}}{\\partial \\eta} = \\left( \\frac{\\partial x}{\\partial \\eta}, \\frac{\\partial y}{\\partial \\eta}, \\frac{\\partial \\zeta}{\\partial \\eta} \\right) = (x_{\\eta}, y_{\\eta}, 0) $$\n$$ \\mathbf{a}_{3} = \\frac{\\partial \\mathbf{X}}{\\partial \\zeta} = \\left( \\frac{\\partial x}{\\partial \\zeta}, \\frac{\\partial y}{\\partial \\zeta}, \\frac{\\partial \\zeta}{\\partial \\zeta} \\right) = (0, 0, 1) = \\mathbf{k} $$\n叉积 $\\mathbf{a}_{1} \\times \\mathbf{a}_{2}$ 是：\n$$ \\mathbf{a}_{1} \\times \\mathbf{a}_{2} = \\det \\begin{pmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ x_{\\xi}  y_{\\xi}  0 \\\\ x_{\\eta}  y_{\\eta}  0 \\end{pmatrix} = (x_{\\xi}y_{\\eta} - y_{\\xi}x_{\\eta})\\mathbf{k} $$\n雅可比行列式 $J$ 是：\n$$ J = \\mathbf{a}_{1} \\cdot (\\mathbf{a}_{2} \\times \\mathbf{a}_{3}) = \\det(\\mathbf{a}_{1}, \\mathbf{a}_{2}, \\mathbf{a}_{3}) = \\det \\begin{pmatrix} x_{\\xi}  y_{\\xi}  0 \\\\ x_{\\eta}  y_{\\eta}  0 \\\\ 0  0  1 \\end{pmatrix} = (1) \\cdot (x_{\\xi}y_{\\eta} - x_{\\eta}y_{\\xi}) = x_{\\xi}y_{\\eta} - x_{\\eta}y_{\\xi} $$\n比较这些表达式，我们发现对于这种特定类型的嵌入，有 $\\mathbf{a}_{1} \\times \\mathbf{a}_{2} = J\\mathbf{k}$。\n因此，其模为：\n$$ ||\\mathbf{a}_{1} \\times \\mathbf{a}_{2}|| = ||J\\mathbf{k}|| = |J| \\cdot ||\\mathbf{k}|| = |J| \\cdot 1 = |J| $$\n将此代回面积元 $dS$ 的表达式中：\n$$ dS = |J| d\\xi d\\eta $$\n这就提供了用雅可比行列式 $J$ 表示的物理曲面面积元的所需表达式，而 $J$ 本身是由 $\\mathbf{a}_{1}$、$\\mathbf{a}_{2}$ 和 $\\mathbf{a}_{3}$ 定义的。\n\n**第2部分：针对特定映射的计算**\n\n第二个任务是计算特定映射的曲面度量因子的模 $||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}||$：\n$$ x(\\xi,\\eta) = \\xi^{2} - \\eta $$\n$$ y(\\xi,\\eta) = \\xi\\,\\eta $$\n在第1部分中，我们已确定对于给定的嵌入结构，有 $||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}|| = |J|$，其中 $J = x_{\\xi}y_{\\eta} - x_{\\eta}y_{\\xi}$。\n\n我们首先计算必要的偏导数：\n$$ x_{\\xi} = \\frac{\\partial}{\\partial \\xi}(\\xi^{2} - \\eta) = 2\\xi $$\n$$ x_{\\eta} = \\frac{\\partial}{\\partial \\eta}(\\xi^{2} - \\eta) = -1 $$\n$$ y_{\\xi} = \\frac{\\partial}{\\partial \\xi}(\\xi\\,\\eta) = \\eta $$\n$$ y_{\\eta} = \\frac{\\partial}{\\partial \\eta}(\\xi\\,\\eta) = \\xi $$\n现在，我们将这些导数代入雅可比行列式 $J$ 的表达式中：\n$$ J = x_{\\xi}y_{\\eta} - x_{\\eta}y_{\\xi} = (2\\xi)(\\xi) - (-1)(\\eta) $$\n$$ J = 2\\xi^{2} + \\eta $$\n曲面度量因子的模是雅可比行列式的绝对值：\n$$ ||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}|| = |J| = |2\\xi^{2} + \\eta| $$\n这就是曲面度量因子的模作为 $\\xi$ 和 $\\eta$ 的函数的最终解析表达式。",
            "answer": "$$\n\\boxed{|2\\xi^2 + \\eta|}\n$$"
        },
        {
            "introduction": "曲线坐标的一个核心应用是在复杂域上求解偏微分方程（PDEs），而验证数值求解器是否被正确实现是一项至关重要且颇具挑战性的任务。这项高级练习将向您介绍“人造解方法”（Method of Manufactured Solutions, MMS），您需要为一个预设的解和网格变换推导出满足该PDE所必需的精确源项。这个问题将理论与实践相结合，展示了如何运用度量张量 ($g_{ij}$, $g^{ij}$, $J$) 的全套工具来为一个CFD代码创建严谨的验证算例 ()。",
            "id": "3952766",
            "problem": "考虑物理空间中的标量各向同性扩散方程及其到广义曲线坐标的强形式变换，写作 $\\partial_{i}\\!\\left(J\\,g^{ij}\\,\\partial_{j} q\\right)=J\\,s$，其中 $q$ 是一个标量场，$s$ 是一个源项，$J$ 是坐标变换的雅可比行列式，$g^{ij}$ 是逆变度量分量。在计算流体动力学 (CFD) 中，一种严谨的网格与算子验证策略是制造解法 (Method of Manufactured Solutions, MMS)，该方法指定一个精确解并推导出相应的强迫项。\n\n给定从计算坐标 $(\\xi,\\eta)$ 到物理坐标 $(x,y)$ 的解析映射，\n$$\nx(\\xi,\\eta)=\\xi+a\\,\\xi\\,\\eta,\\qquad y(\\xi,\\eta)=\\eta+b\\,\\xi^{2},\n$$\n其中 $a$ 和 $b$ 是正常数，以及制造解\n$$\nq(\\xi,\\eta)=\\xi+\\eta.\n$$\n使用曲线坐标变换的基本原理，即位置矢量 $\\mathbf{r}=(x,y)$ 的协变基向量定义 $a_{\\xi}=\\partial_{\\xi}\\mathbf{r}$ 和 $a_{\\eta}=\\partial_{\\eta}\\mathbf{r}$、雅可比行列式 $J=\\det\\!\\left[\\partial(x,y)/\\partial(\\xi,\\eta)\\right]$、由 $a^{i}\\cdot a_{j}=\\delta^{i}_{\\,j}$ 定义的逆变基向量 $a^{i}$，以及逆变度量 $g^{ij}=a^{i}\\cdot a^{j}$，推导源项 $s(\\xi,\\eta)$ 的精确解析表达式，使得 $q(\\xi,\\eta)$ 在给定映射下成为 $\\partial_{i}\\!\\left(J\\,g^{ij}\\,\\partial_{j} q\\right)=J\\,s$ 的一个精确解。将你的最终答案表示为关于 $\\xi$、$\\eta$、$a$ 和 $b$ 的单个闭式解析表达式。\n\n此外，概述一个曲线坐标扩散求解器的逻辑上完备的 MMS 验证计划：说明如何施加边界数据以与制造解保持一致，描述离散残差和误差范数的计算，并指明在网格加密下的预期精度阶评估策略。不需要进行数值评估。最终答案必须是解析的 $s(\\xi,\\eta)$，并且不得包含单位或数值。",
            "solution": "所述问题在科学上是合理的、适定的且客观的。它提出了一个将张量微积分应用于为制造解法推导源项的标准练习，制造解法是计算物理学中广泛使用的验证技术。所有必要信息均已提供，且没有内部矛盾或逻辑缺陷。因此，我们可以进行推导。\n\n控制方程是广义曲线坐标 $(\\xi^1, \\xi^2) = (\\xi, \\eta)$ 下的强守恒形式的标量各向同性扩散方程：\n$$\n\\partial_{i}\\!\\left(J\\,g^{ij}\\,\\partial_{j} q\\right)=J\\,s\n$$\n其中，暗示了对重复指标 $i, j \\in \\{\\xi, \\eta\\}$ 的求和。源项 $s$ 由下式给出：\n$$\ns = \\frac{1}{J} \\left[ \\partial_{\\xi}\\!\\left(J\\,(g^{\\xi\\xi}\\partial_{\\xi} q + g^{\\xi\\eta}\\partial_{\\eta} q)\\right) + \\partial_{\\eta}\\!\\left(J\\,(g^{\\eta\\xi}\\partial_{\\xi} q + g^{\\eta\\eta}\\partial_{\\eta} q)\\right) \\right]\n$$\n问题要求在给定坐标变换和制造解的情况下，推导 $s(\\xi, \\eta)$ 的解析表达式。\n\n首先，我们定义位置矢量 $\\mathbf{r}$ 并计算坐标变换的偏导数：\n$$\n\\mathbf{r}(\\xi, \\eta) = x(\\xi, \\eta)\\mathbf{i} + y(\\xi, \\eta)\\mathbf{j} = (\\xi+a\\,\\xi\\,\\eta)\\mathbf{i} + (\\eta+b\\,\\xi^{2})\\mathbf{j}\n$$\n关于计算坐标的偏导数是：\n$$\nx_{\\xi} = \\frac{\\partial x}{\\partial \\xi} = 1 + a\\eta\n\\qquad\nx_{\\eta} = \\frac{\\partial x}{\\partial \\eta} = a\\xi\n$$\n$$\ny_{\\xi} = \\frac{\\partial y}{\\partial \\xi} = 2b\\xi\n\\qquad\ny_{\\eta} = \\frac{\\partial y}{\\partial \\eta} = 1\n$$\n变换的雅可比行列式 $J$ 计算如下：\n$$\nJ = \\det\\begin{pmatrix} x_{\\xi}  x_{\\eta} \\\\ y_{\\xi}  y_{\\eta} \\end{pmatrix} = x_{\\xi} y_{\\eta} - x_{\\eta} y_{\\xi} = (1+a\\eta)(1) - (a\\xi)(2b\\xi) = 1 + a\\eta - 2ab\\xi^2\n$$\n对于一个有效的一一映射，我们必须在所关注的域中 $J \\neq 0$。\n\n接下来，我们计算协变度量张量 $g_{ij} = \\mathbf{a}_i \\cdot \\mathbf{a}_j$ 的分量，其中 $\\mathbf{a}_{\\xi} = (x_{\\xi}, y_{\\xi})$ 和 $\\mathbf{a}_{\\eta} = (x_{\\eta}, y_{\\eta})$ 是协变基向量。\n$$\ng_{\\xi\\xi} = \\mathbf{a}_{\\xi} \\cdot \\mathbf{a}_{\\xi} = x_{\\xi}^2 + y_{\\xi}^2 = (1+a\\eta)^2 + (2b\\xi)^2 = 1 + 2a\\eta + a^2\\eta^2 + 4b^2\\xi^2\n$$\n$$\ng_{\\eta\\eta} = \\mathbf{a}_{\\eta} \\cdot \\mathbf{a}_{\\eta} = x_{\\eta}^2 + y_{\\eta}^2 = (a\\xi)^2 + 1^2 = 1 + a^2\\xi^2\n$$\n$$\ng_{\\xi\\eta} = \\mathbf{a}_{\\xi} \\cdot \\mathbf{a}_{\\eta} = x_{\\xi}x_{\\eta} + y_{\\xi}y_{\\eta} = (1+a\\eta)(a\\xi) + (2b\\xi)(1) = a\\xi + a^2\\xi\\eta + 2b\\xi\n$$\n逆变度量分量 $g^{ij}$ 通过对协变度量张量矩阵 $[g_{ij}]$ 求逆得到。协变度量张量的行列式是 $\\det[g_{ij}] = g_{\\xi\\xi}g_{\\eta\\eta} - g_{\\xi\\eta}^2 = J^2$。\n$$\n\\begin{pmatrix} g^{\\xi\\xi}  g^{\\xi\\eta} \\\\ g^{\\eta\\xi}  g^{\\eta\\eta} \\end{pmatrix} = \\frac{1}{J^2} \\begin{pmatrix} g_{\\eta\\eta}  -g_{\\xi\\eta} \\\\ -g_{\\eta\\xi}  g_{\\xi\\xi} \\end{pmatrix}\n$$\n使用量 $Jg^{ij}$ 会更方便：\n$$\nJg^{\\xi\\xi} = \\frac{g_{\\eta\\eta}}{J} = \\frac{1 + a^2\\xi^2}{1 + a\\eta - 2ab\\xi^2}\n$$\n$$\nJg^{\\eta\\eta} = \\frac{g_{\\xi\\xi}}{J} = \\frac{1 + 2a\\eta + a^2\\eta^2 + 4b^2\\xi^2}{1 + a\\eta - 2ab\\xi^2}\n$$\n$$\nJg^{\\xi\\eta} = Jg^{\\eta\\xi} = \\frac{-g_{\\xi\\eta}}{J} = \\frac{-(a\\xi + a^2\\xi\\eta + 2b\\xi)}{1 + a\\eta - 2ab\\xi^2}\n$$\n制造解为 $q(\\xi, \\eta) = \\xi + \\eta$。其偏导数为：\n$$\n\\partial_{\\xi} q = 1 \\qquad \\partial_{\\eta} q = 1\n$$\n令散度内的项为 $\\Phi^{\\xi}$ 和 $\\Phi^{\\eta}$：\n$$\n\\Phi^{\\xi} = J(g^{\\xi\\xi}\\partial_{\\xi} q + g^{\\xi\\eta}\\partial_{\\eta} q) = Jg^{\\xi\\xi} + Jg^{\\xi\\eta}\n$$\n$$\n\\Phi^{\\eta} = J(g^{\\eta\\xi}\\partial_{\\xi} q + g^{\\eta\\eta}\\partial_{\\eta} q) = Jg^{\\eta\\xi} + Jg^{\\eta\\eta}\n$$\n代入 $Jg^{ij}$ 的表达式：\n$$\n\\Phi^{\\xi} = \\frac{1 + a^2\\xi^2 - (a\\xi + a^2\\xi\\eta + 2b\\xi)}{1 + a\\eta - 2ab\\xi^2}\n$$\n$$\n\\Phi^{\\eta} = \\frac{-(a\\xi + a^2\\xi\\eta + 2b\\xi) + (1 + 2a\\eta + a^2\\eta^2 + 4b^2\\xi^2)}{1 + a\\eta - 2ab\\xi^2}\n$$\n源项方程为 $Js = \\partial_{\\xi}\\Phi^{\\xi} + \\partial_{\\eta}\\Phi^{\\eta}$。令分母为 $D(\\xi,\\eta)=1+a\\eta-2ab\\xi^2$，$\\Phi^{\\xi}$ 的分子为 $N_{\\xi}(\\xi,\\eta)$，$\\Phi^{\\eta}$ 的分子为 $N_{\\eta}(\\xi,\\eta)$。\n$$\n\\Phi^{\\xi} = \\frac{N_{\\xi}}{D}, \\qquad \\Phi^{\\eta} = \\frac{N_{\\eta}}{D}\n$$\n应用导数的商法则：\n$$\n\\partial_{\\xi}\\Phi^{\\xi} = \\frac{(\\partial_{\\xi}N_{\\xi})D - N_{\\xi}(\\partial_{\\xi}D)}{D^2}\n\\qquad\n\\partial_{\\eta}\\Phi^{\\eta} = \\frac{(\\partial_{\\eta}N_{\\eta})D - N_{\\eta}(\\partial_{\\eta}D)}{D^2}\n$$\n分子和分母的导数是：\n$$\n\\partial_{\\xi}N_{\\xi} = 2a^2\\xi - a - a^2\\eta - 2b\n$$\n$$\n\\partial_{\\eta}N_{\\eta} = -a^2\\xi + 2a + 2a^2\\eta\n$$\n$$\n\\partial_{\\xi}D = -4ab\\xi\n\\qquad\n\\partial_{\\eta}D = a\n$$\n将导数相加得到 $Js = (\\partial_{\\xi}\\Phi^{\\xi} + \\partial_{\\eta}\\Phi^{\\eta})$。$Js D^2$ 的分子是：\n$$\n\\text{Numerator} = [(\\partial_{\\xi}N_{\\xi})D - N_{\\xi}(\\partial_{\\xi}D)] + [(\\partial_{\\eta}N_{\\eta})D - N_{\\eta}(\\partial_{\\eta}D)]\n$$\n$$\n= [(\\partial_{\\xi}N_{\\xi}) + (\\partial_{\\eta}N_{\\eta})] D - N_{\\xi}(\\partial_{\\xi}D) - N_{\\eta}(\\partial_{\\eta}D)\n$$\n分子的偏导数之和：\n$$\n(\\partial_{\\xi}N_{\\xi}) + (\\partial_{\\eta}N_{\\eta}) = (2a^2\\xi - a - a^2\\eta - 2b) + (-a^2\\xi + 2a + 2a^2\\eta) = a^2\\xi + a + a^2\\eta - 2b\n$$\n剩下的项是 $-N_{\\xi}(-4ab\\xi)$ 和 $-N_{\\eta}(a)$。经过冗长但直接的代数展开和项的合并，总分子简化为：\n$$\n\\text{Numerator} = 2a^3b\\xi^3 - 6a^3b\\xi^2\\eta - (6a^2b+8ab^2)\\xi^2 + 2a^3\\xi\\eta + (2a^2+6ab)\\xi - 2ab\\eta - 2b\n$$\n因此，$Js = \\frac{\\text{Numerator}}{D^2}$。解出 $s$，我们得到：\n$$\ns = \\frac{1}{J} \\frac{\\text{Numerator}}{D^2} = \\frac{\\text{Numerator}}{D \\cdot D^2} = \\frac{\\text{Numerator}}{D^3}\n$$\n$$\ns(\\xi, \\eta) = \\frac{2a^3b\\xi^3 - 6a^3b\\xi^2\\eta - (6a^2b+8ab^2)\\xi^2 + 2a^3\\xi\\eta + (2a^2+6ab)\\xi - 2ab\\eta - 2b}{(1+a\\eta-2ab\\xi^2)^3}\n$$\n\n使用该源项的曲线坐标扩散求解器的制造解法 (MMS) 验证计划包括以下步骤：\n\n1.  **边界条件施加**：计算域在 $(\\xi, \\eta)$ 坐标中定义，例如，一个单位正方形 $[\\xi_1, \\xi_2] \\times [\\eta_1, \\eta_2]$。制造解 $q(\\xi, \\eta) = \\xi + \\eta$ 必须在该域的边界上强制执行。这通常通过施加狄利克雷边界条件来完成。对于任何坐标为 $(\\xi_b, \\eta_b)$ 的边界节点或单元面中心，标量场的值被设置为 $q_b = \\xi_b + \\eta_b$。这确保了边界数据与精确解一致。\n\n2.  **离散误差的计算**：数值求解器在特征间距为 $h$ 的网格上计算一个近似解 $q_h$。精确源项 $s(\\xi, \\eta)$ 在离散格式的适当位置（例如，有限体积法的单元中心）进行评估，并用作求解器的输入。一旦获得数值解 $q_h$，通过从数值解中减去在网格点/单元上评估的精确解 $q_{ex}$ 来计算离散误差 $e_h$：$e_h = q_h - q_{ex}$。为了量化总误差，需要在整个域上计算各种误差范数。最常见的是 $L_1$、$L_2$ 和 $L_\\infty$ 范数。对于有 $N$ 个单元的网格，体积加权的 $L_p$ 范数为：\n    $$\n    L_p(e_h) = \\left( \\frac{\\sum_{i=1}^{N} |e_{h,i}|^p V_i}{\\sum_{i=1}^{N} V_i} \\right)^{1/p}\n    $$\n    其中 $e_{h,i}$ 是单元 $i$ 中的误差，$V_i$ 是单元 $i$ 的体积（在二维中为面积）。在曲线坐标中，$V_i \\approx J_i \\Delta\\xi \\Delta\\eta$。\n\n3.  **精度阶评估**：为验证代码实现正确并达到其理论精度阶，模拟在一系列系统性加密的网格上运行。例如，从一个大小为 $N \\times N$ 的粗网格开始，可以生成大小为 $2N \\times 2N$、$4N \\times 4N$ 等的网格。令 $h_k$ 表示序列中网格 $k$ 的特征网格间距（例如，$h_k = 1/N_k$），令 $\\|e_k\\|$ 为在该网格上计算的误差范数。如果数值方法的理论精度阶为 $p$，则误差预计表现为 $\\|e_k\\| \\approx C h_k^p$，其中 $C$ 为某个常数。观测到的精度阶 $p_{obs}$ 可以从两个连续网格的结果计算得出，例如间距为 $h_1$ 和 $h_2=h_1/r$（对于加倍加密，r=2）：\n    $$\n    p_{obs} = \\frac{\\ln( \\|e_1\\| / \\|e_2\\| )}{\\ln(h_1 / h_2)} = \\frac{\\ln( \\|e_1\\| / \\|e_2\\| )}{\\ln(r)}\n    $$\n    如果随着网格的加密，观测到的精度阶 $p_{obs}$ 渐近于离散格式的理论阶 $p$，则验证成功。",
            "answer": "$$\n\\boxed{\\frac{2a^3b\\xi^3 - 6a^3b\\xi^2\\eta - (6a^2b+8ab^2)\\xi^2 + 2a^3\\xi\\eta + (2a^2+6ab)\\xi - 2ab\\eta - 2b}{(1+a\\eta-2ab\\xi^2)^3}}\n$$"
        }
    ]
}