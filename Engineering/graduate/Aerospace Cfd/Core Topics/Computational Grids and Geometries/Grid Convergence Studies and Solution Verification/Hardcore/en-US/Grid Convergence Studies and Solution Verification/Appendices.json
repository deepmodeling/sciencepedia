{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of any grid convergence study is the use of systematically refined meshes. While defining the refinement ratio, $r$, is straightforward for structured grids, it requires a more formal approach for the unstructured meshes prevalent in complex 3D simulations. This practice introduces the concept of an effective grid spacing, $h_{\\text{eff}}$, derived from the cell count, allowing you to quantify the refinement between two unstructured grids—a crucial first step in any verification analysis .",
            "id": "3963939",
            "problem": "In Computational Fluid Dynamics (CFD), grid convergence studies in three dimensions frequently use an effective grid spacing to compare meshes of different resolutions. Consider two unstructured tetrahedral meshes that discretize the same fixed three-dimensional domain of volume $V$, with cell counts $N_1 = 2 \\times 10^{6}$ and $N_2 = 16 \\times 10^{6}$. The refinement ratio is defined as the ratio of the coarse-mesh effective spacing to the fine-mesh effective spacing, and the effective spacing for an unstructured three-dimensional mesh is understood to be based on a representative cell length derived from the mean cell volume. Using these principles, determine the refinement ratio $r$ between mesh $1$ (coarse) and mesh $2$ (fine). Express your final answer as a single real-valued number with no units. No rounding is required.",
            "solution": "The problem requires the determination of the grid refinement ratio, $r$, between two unstructured tetrahedral meshes used to discretize a fixed three-dimensional domain. The solution proceeds by first formalizing the concept of effective grid spacing based on the provided information.\n\nLet the fixed volume of the domain be denoted by $V$. The two meshes are designated as mesh $1$ (coarse) and mesh $2$ (fine). The number of cells in each mesh is given:\nCoarse mesh cell count: $N_1 = 2 \\times 10^{6}$.\nFine mesh cell count: $N_2 = 16 \\times 10^{6}$.\n\nThe problem states that the effective grid spacing for an unstructured mesh is based on a representative cell length derived from the mean cell volume. Let $\\bar{v}_i$ denote the mean cell volume for a mesh $i$ containing $N_i$ cells. The mean cell volume is the total domain volume divided by the number of cells:\n$$\\bar{v}_i = \\frac{V}{N_i}$$\nFor the two meshes in question, their mean cell volumes are:\n$$\\bar{v}_1 = \\frac{V}{N_1} \\quad \\text{and} \\quad \\bar{v}_2 = \\frac{V}{N_2}$$\n\nThe \"representative cell length\" or effective grid spacing, $h_i$, for a three-dimensional volume element is dimensionally proportional to the cube root of its volume. This is analogous to the side length of a cube having the same volume. We can thus formally define the effective grid spacing for mesh $i$ as:\n$$h_i = (\\bar{v}_i)^{1/3} = \\left(\\frac{V}{N_i}\\right)^{1/3}$$\n\nUsing this definition, we can express the effective grid spacing for the coarse and fine meshes:\nEffective spacing for the coarse mesh (mesh 1):\n$$h_1 = \\left(\\frac{V}{N_1}\\right)^{1/3}$$\nEffective spacing for the fine mesh (mesh 2):\n$$h_2 = \\left(\\frac{V}{N_2}\\right)^{1/3}$$\n\nThe refinement ratio, $r$, is defined as the ratio of the coarse-mesh effective spacing to the fine-mesh effective spacing.\n$$r = \\frac{h_1}{h_2}$$\n\nSubstituting the expressions for $h_1$ and $h_2$ into the definition of $r$:\n$$r = \\frac{\\left(\\frac{V}{N_1}\\right)^{1/3}}{\\left(\\frac{V}{N_2}\\right)^{1/3}}$$\nUsing the properties of exponents, we can simplify this expression:\n$$r = \\left( \\frac{V/N_1}{V/N_2} \\right)^{1/3}$$\nThe term for the domain volume, $V$, being a constant for both meshes, cancels out:\n$$r = \\left( \\frac{N_2}{N_1} \\right)^{1/3}$$\nThis expression shows that for a fixed domain, the refinement ratio depends only on the cube root of the ratio of the cell counts.\n\nWe are given the numerical values for $N_1$ and $N_2$:\n$$N_1 = 2 \\times 10^{6}$$\n$$N_2 = 16 \\times 10^{6}$$\nSubstituting these values into the equation for $r$:\n$$r = \\left( \\frac{16 \\times 10^{6}}{2 \\times 10^{6}} \\right)^{1/3}$$\nThe ratio of the cell counts is calculated as:\n$$\\frac{N_2}{N_1} = \\frac{16}{2} = 8$$\nTherefore, the refinement ratio is:\n$$r = (8)^{1/3} = 2$$\nThe refinement ratio $r$ is a dimensionless value of $2$. This is a common target value in grid convergence studies, as a refinement ratio of $2$ in a three-dimensional uniform refinement corresponds to halving the mesh size in each spatial direction, which results in an eight-fold ($r^3 = 2^3 = 8$) increase in the total number of cells, as observed in this problem.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "Once solutions are obtained on a sequence of three or more systematically refined grids or time steps, we can move beyond qualitative assessment to rigorous quantification. This exercise guides you through the process of using these solutions to simultaneously determine the observed order of accuracy, $p$, and an improved estimate of the continuum value via Richardson extrapolation. By applying this method to temporal discretization error, this problem highlights the versatility of the verification framework beyond spatial grids .",
            "id": "3963953",
            "problem": "A time-accurate simulation in Computational Fluid Dynamics (CFD) of a statistically stationary, turbulent external flow about an airfoil produces time-averaged drag coefficients at three uniform time steps, with a constant temporal refinement ratio. The same temporal integration scheme is used at all time steps, and the spatial discretization is held fixed and sufficiently fine so that temporal discretization error dominates. Assume the simulation is in the asymptotic regime of temporal discretization error so that the measured time-averaged drag coefficient obeys an expansion of the form\n$$\nC_{D}(\\Delta t) \\;=\\; C_{D,0} \\;+\\; K \\,\\Delta t^{p} \\;+\\; \\mathcal{O}\\!\\left(\\Delta t^{p+1}\\right),\n$$\nwhere $C_{D,0}$ is the time-step–independent value (the $\\Delta t \\to 0$ limit), $K$ is an unknown constant, and $p$ is the observed temporal order of accuracy associated with the method and the flow response.\n\nThe three measured values are\n$$\n\\Delta t_{1} = 0.01,\\quad C_{D}(\\Delta t_{1}) = 0.310;\\qquad\n\\Delta t_{2} = 0.005,\\quad C_{D}(\\Delta t_{2}) = 0.305;\\qquad\n\\Delta t_{3} = 0.0025,\\quad C_{D}(\\Delta t_{3}) = 0.3035,\n$$\nwith a constant refinement ratio $r = \\Delta t_{1}/\\Delta t_{2} = \\Delta t_{2}/\\Delta t_{3}$.\n\nStarting from the above asymptotic error representation and the definition of consistency for a time integration method derived from Taylor-series truncation arguments, eliminate the unknowns $C_{D,0}$ and $K$ to obtain an expression for the observed temporal order $p$ in terms of the measured drag values and the refinement ratio. Then, using the finest two time levels and the observed order, derive an expression for the extrapolated drag $C_{D,0}$ as $\\Delta t \\to 0$.\n\nCompute the numerical values of the observed temporal order $p$ and the extrapolated $C_{D,0}$ using the data given. Round both to four significant figures. Express your final answer as a row matrix with the first entry equal to $p$ and the second entry equal to $C_{D,0}$. No units are required for the final answer.",
            "solution": "### Solution Derivation\n\nLet the three measured drag coefficients be denoted as $C_{D,1}$, $C_{D,2}$, and $C_{D,3}$ corresponding to time steps $\\Delta t_{1}$, $\\Delta t_{2}$, and $\\Delta t_{3}$, respectively. Neglecting the higher-order terms, the asymptotic error model gives us a system of three equations:\n$$\nC_{D,1} \\approx C_{D,0} + K \\Delta t_{1}^{p} \\quad (1) \\\\\nC_{D,2} \\approx C_{D,0} + K \\Delta t_{2}^{p} \\quad (2) \\\\\nC_{D,3} \\approx C_{D,0} + K \\Delta t_{3}^{p} \\quad (3)\n$$\n\n**1. Derivation of the Observed Temporal Order, $p$**\n\nTo find an expression for $p$, we must eliminate the unknowns $C_{D,0}$ and $K$.\nFirst, eliminate $C_{D,0}$ by subtracting the equations pairwise:\n$$\nC_{D,1} - C_{D,2} \\approx K (\\Delta t_{1}^{p} - \\Delta t_{2}^{p}) \\quad (4) \\\\\nC_{D,2} - C_{D,3} \\approx K (\\Delta t_{2}^{p} - \\Delta t_{3}^{p}) \\quad (5)\n$$\nNext, eliminate $K$ by taking the ratio of equation $(4)$ to equation $(5)$:\n$$\n\\frac{C_{D,1} - C_{D,2}}{C_{D,2} - C_{D,3}} \\approx \\frac{\\Delta t_{1}^{p} - \\Delta t_{2}^{p}}{\\Delta t_{2}^{p} - \\Delta t_{3}^{p}}\n$$\nWe are given a constant refinement ratio $r$, where $\\Delta t_{1} = r \\Delta t_{2}$ and $\\Delta t_{2} = r \\Delta t_{3}$. Substituting these relationships into the right-hand side of the expression:\n$$\n\\frac{(r \\Delta t_{2})^{p} - \\Delta t_{2}^{p}}{(r \\Delta t_{3})^{p} - \\Delta t_{3}^{p}} = \\frac{r^{p} \\Delta t_{2}^{p} - \\Delta t_{2}^{p}}{r^{p} \\Delta t_{3}^{p} - \\Delta t_{3}^{p}} = \\frac{\\Delta t_{2}^{p}(r^{p} - 1)}{\\Delta t_{3}^{p}(r^{p} - 1)} = \\left(\\frac{\\Delta t_{2}}{\\Delta t_{3}}\\right)^{p} = r^{p}\n$$\nThus, we obtain the relation:\n$$\n\\frac{C_{D,1} - C_{D,2}}{C_{D,2} - C_{D,3}} \\approx r^{p}\n$$\nTo solve for $p$, we take the natural logarithm of both sides:\n$$\n\\ln\\left(\\frac{C_{D,1} - C_{D,2}}{C_{D,2} - C_{D,3}}\\right) \\approx p \\ln(r)\n$$\nThis gives the expression for the observed order of accuracy:\n$$\np \\approx \\frac{\\ln\\left(\\frac{C_{D,1} - C_{D,2}}{C_{D,2} - C_{D,3}}\\right)}{\\ln(r)}\n$$\n\n**2. Derivation of the Extrapolated Drag, $C_{D,0}$**\n\nThe problem asks for an expression for $C_{D,0}$ using the two finest time levels, which correspond to $(\\Delta t_{2}, C_{D,2})$ and $(\\Delta t_{3}, C_{D,3})$. We use equations $(2)$ and $(3)$:\n$$\nC_{D,2} \\approx C_{D,0} + K \\Delta t_{2}^{p} \\\\\nC_{D,3} \\approx C_{D,0} + K \\Delta t_{3}^{p}\n$$\nWe can eliminate $K$ to solve for $C_{D,0}$. From the second equation, we have $K \\approx (C_{D,3} - C_{D,0}) / \\Delta t_{3}^{p}$. Substituting this into the first equation:\n$$\nC_{D,2} \\approx C_{D,0} + \\frac{C_{D,3} - C_{D,0}}{\\Delta t_{3}^{p}} \\Delta t_{2}^{p} = C_{D,0} + (C_{D,3} - C_{D,0})\\left(\\frac{\\Delta t_{2}}{\\Delta t_{3}}\\right)^{p}\n$$\nUsing the refinement ratio $r = \\Delta t_{2}/\\Delta t_{3}$, we get:\n$$\nC_{D,2} \\approx C_{D,0} + (C_{D,3} - C_{D,0})r^{p}\n$$\nNow, we rearrange the terms to solve for $C_{D,0}$:\n$$\nC_{D,2} \\approx C_{D,0} + C_{D,3}r^{p} - C_{D,0}r^{p} \\\\\nC_{D,2} - C_{D,3}r^{p} \\approx C_{D,0}(1 - r^{p}) \\\\\nC_{D,0}(r^{p} - 1) \\approx C_{D,3}r^{p} - C_{D,2}\n$$\nThis yields the expression for the extrapolated value $C_{D,0}$, which is known as Richardson's extrapolation:\n$$\nC_{D,0} \\approx \\frac{r^{p} C_{D,3} - C_{D,2}}{r^{p} - 1}\n$$\n\n### Numerical Computations\n\nThe given data is:\n$C_{D,1} = 0.310$, $C_{D,2} = 0.305$, $C_{D,3} = 0.3035$.\nThe refinement ratio is $r = 2$.\n\n**1. Compute $p$**\nFirst, calculate the differences in the drag coefficients:\n$$\nC_{D,1} - C_{D,2} = 0.310 - 0.305 = 0.005 \\\\\nC_{D,2} - C_{D,3} = 0.305 - 0.3035 = 0.0015\n$$\nNow, substitute these into the expression for $p$:\n$$\np = \\frac{\\ln\\left(\\frac{0.005}{0.0015}\\right)}{\\ln(2)} = \\frac{\\ln\\left(\\frac{50}{15}\\right)}{\\ln(2)} = \\frac{\\ln\\left(\\frac{10}{3}\\right)}{\\ln(2)}\n$$\nUsing numerical values for the logarithms:\n$$\np \\approx \\frac{1.203972804}{0.6931471806} \\approx 1.73696559\n$$\nRounding to four significant figures, we get $p \\approx 1.737$.\n\n**2. Compute $C_{D,0}$**\nWe use the expression for $C_{D,0}$ with $r=2$, the calculated $p$, and the values for $C_{D,2}$ and $C_{D,3}$.\nA key observation is that $r^{p} = 2^{p} = 2^{\\ln(10/3)/\\ln(2)} = \\exp\\left(\\ln(2) \\frac{\\ln(10/3)}{\\ln(2)}\\right) = \\exp(\\ln(10/3)) = \\frac{10}{3}$.\nUsing this exact value for $r^p$ prevents intermediate rounding errors:\n$$\nC_{D,0} = \\frac{r^{p} C_{D,3} - C_{D,2}}{r^{p} - 1} = \\frac{\\frac{10}{3} C_{D,3} - C_{D,2}}{\\frac{10}{3} - 1}\n$$\nSubstitute the numerical values of the coefficients:\n$$\nC_{D,0} = \\frac{\\frac{10}{3}(0.3035) - 0.305}{\\frac{7}{3}} = \\frac{10(0.3035) - 3(0.305)}{7}\n$$\n$$\nC_{D,0} = \\frac{3.035 - 0.915}{7} = \\frac{2.12}{7}\n$$\n$$\nC_{D,0} \\approx 0.30285714\n$$\nRounding to four significant figures, we get $C_{D,0} \\approx 0.3029$.\nThe final numerical answers are $p \\approx 1.737$ and $C_{D,0} \\approx 0.3029$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.737  0.3029 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Estimating the discretization error is a key outcome of a grid study, but communicating this result requires a standardized and conservative approach. The Grid Convergence Index (GCI) serves this purpose by providing a reliable error band on the fine-grid solution. This practice focuses on calculating the GCI for a common two-grid scenario, a fundamental skill for reporting the numerical uncertainty of your CFD results with confidence .",
            "id": "3963897",
            "problem": "A high-fidelity compressible flow computation for a thin airfoil is performed using Computational Fluid Dynamics (CFD). The quantity of interest is a nondimensional integral measure denoted by $Q$, computed on a sequence of geometrically similar meshes obtained by uniform refinement characterized by a representative mesh size $h$. Assume the asymptotic discretization error model $Q(h) = Q_{\\text{exact}} + C h^{p}$ holds, where $Q_{\\text{exact}}$ is the exact value on the continuous domain, $C$ is a grid-independent constant, and $p$ is the observed order of accuracy associated with the discretization.\n\nTwo systematically refined grids are used, with refinement ratio $r = h_{2}/h_{1}$, where $h_{1}$ is the fine-grid size and $h_{2}$ is the medium-grid size. The corresponding computed values are $Q_{1}$ on the fine grid and $Q_{2}$ on the medium grid. The observed order $p$ has been obtained independently from a separate three-grid study and is treated as known here. Following the standard solution verification framework, the fine-grid Grid Convergence Index (GCI) uses a safety factor $F_{s}$ to conservatively estimate the relative discretization error on the fine grid as a fraction of $Q_{1}$.\n\nGiven $Q_{1} = 2.135$, $Q_{2} = 2.090$, $r = 2$, $p = 2.1$, and $F_{s} = 1.25$, use the asymptotic error model and Richardson extrapolation reasoning to derive the two-grid fine-grid GCI expression as a relative error estimate on the fine grid and compute $\\text{GCI}_{12}$. Express your result as a dimensionless decimal fraction of $Q_{1}$ (do not include a percent sign). Round your answer to four significant figures.",
            "solution": "The problem is to calculate the fine-grid Grid Convergence Index ($\\text{GCI}_{12}$) for a quantity of interest $Q$ computed using CFD. The problem provides a set of values from a two-grid study and assumes a known order of accuracy $p$.\n\nThe foundation of this analysis is the asymptotic discretization error model, given as:\n$$Q(h) = Q_{\\text{exact}} + C h^{p}$$\nwhere $h$ is the characteristic mesh size, $Q(h)$ is the solution on a grid of size $h$, $Q_{\\text{exact}}$ is the exact solution for $h \\to 0$, $C$ is a constant independent of the grid, and $p$ is the observed order of accuracy of the numerical scheme.\n\nFor the two grids used, the fine grid (grid 1) and the medium grid (grid 2), we can write two equations based on this model. Let $h_{1}$ and $h_{2}$ be the mesh sizes for the fine and medium grids, respectively, and let $Q_{1}$ and $Q_{2}$ be the corresponding computed values of the quantity of interest.\n$$Q_{1} = Q(h_{1}) = Q_{\\text{exact}} + C h_{1}^{p}$$\n$$Q_{2} = Q(h_{2}) = Q_{\\text{exact}} + C h_{2}^{p}$$\n\nThe problem defines a uniform grid refinement ratio $r = h_{2}/h_{1}$. We can express $h_{2}$ in terms of $h_{1}$ as $h_{2} = r h_{1}$. Substituting this into the equation for $Q_{2}$ yields:\n$$Q_{2} = Q_{\\text{exact}} + C (r h_{1})^{p} = Q_{\\text{exact}} + C h_{1}^{p} r^{p}$$\n\nThe discretization error on the fine grid is defined as $E_{1} = Q_{1} - Q_{\\text{exact}} = C h_{1}^{p}$. We can find an estimate for this error by eliminating $Q_{\\text{exact}}$ and $C$ from the system of equations. Subtracting the equation for $Q_{1}$ from the modified equation for $Q_{2}$:\n$$Q_{2} - Q_{1} = (Q_{\\text{exact}} + C h_{1}^{p} r^{p}) - (Q_{\\text{exact}} + C h_{1}^{p})$$\n$$Q_{2} - Q_{1} = C h_{1}^{p} (r^{p} - 1)$$\n\nThis allows us to solve for the term $C h_{1}^{p}$, which represents the leading-order error on the fine grid. An estimate for this error, denoted $E_{a,1}$, is:\n$$E_{a,1} = C h_{1}^{p} = \\frac{Q_{2} - Q_{1}}{r^{p} - 1}$$\n\nThe Grid Convergence Index ($\\text{GCI}$) is a standardized measure used for reporting the uncertainty of a grid convergence study. It is based on the Richardson extrapolation error estimate but includes a safety factor $F_s$ to provide a more conservative error band. The fine-grid $\\text{GCI}$ based on grids $1$ and $2$, denoted $\\text{GCI}_{12}$, is defined as the safety factor multiplied by the magnitude of the estimated *relative* error on the fine grid.\n\nThe estimated relative error on the fine grid is the absolute value of the error estimate $E_{a,1}$ divided by the absolute value of the fine-grid solution $Q_1$:\n$$\\text{Relative Error Estimate} = \\frac{|E_{a,1}|}{|Q_{1}|} = \\frac{\\left| \\frac{Q_{2} - Q_{1}}{r^{p} - 1} \\right|}{|Q_{1}|} = \\frac{|Q_{1} - Q_{2}|}{|Q_{1}|(r^{p} - 1)}$$\n\nTherefore, the formula for $\\text{GCI}_{12}$ is:\n$$\\text{GCI}_{12} = F_{s} \\times (\\text{Relative Error Estimate}) = F_{s} \\frac{|Q_{1} - Q_{2}|}{|Q_{1}|(r^{p} - 1)}$$\n\nWe are given the following values:\n- Fine-grid solution: $Q_{1} = 2.135$\n- Medium-grid solution: $Q_{2} = 2.090$\n- Grid refinement ratio: $r = 2$\n- Observed order of accuracy: $p = 2.1$\n- Safety factor: $F_{s} = 1.25$\n\nWe substitute these values into the derived formula for $\\text{GCI}_{12}$.\nFirst, we compute the necessary terms:\nThe absolute difference in solutions:\n$$|Q_{1} - Q_{2}| = |2.135 - 2.090| = 0.045$$\nThe denominator term involving the order of accuracy and refinement ratio:\n$$r^{p} - 1 = 2^{2.1} - 1 \\approx 4.28709385 - 1 = 3.28709385$$\n\nNow, we can compute $\\text{GCI}_{12}$:\n$$\\text{GCI}_{12} = 1.25 \\times \\frac{0.045}{2.135 \\times (2^{2.1} - 1)}$$\n$$\\text{GCI}_{12} \\approx 1.25 \\times \\frac{0.045}{2.135 \\times 3.28709385}$$\n$$\\text{GCI}_{12} \\approx \\frac{0.05625}{7.01794537} \\approx 0.008015159...$$\n\nThe problem asks for the result to be rounded to four significant figures. The first significant figure is $8$. The next three are $0$, $1$, and $5$. The digit following the fifth is $1$, so we round down (keep $5$ as is).\n$$\\text{GCI}_{12} \\approx 0.008015$$\nThis value represents the estimated relative error on the fine grid, with a safety factor applied, as a dimensionless fraction.",
            "answer": "$$\\boxed{0.008015}$$"
        }
    ]
}