{
    "hands_on_practices": [
        {
            "introduction": "在分析解如何随网格加密而变化之前，我们必须首先有一种精确衡量“加密”程度的方法。对于单元格是均匀立方体的结构化网格，这很简单。然而，对于航空航天CFD中常见的非结构化网格，我们需要一个基于单元格数量和体积的更稳健的定义。本实践练习  演示了如何计算有效的网格加密比 $r$，这是任何网格收敛性研究中的一个基本参数。",
            "id": "3963939",
            "problem": "在计算流体力学 (CFD) 中，三维网格收敛性研究经常使用有效网格间距来比较不同分辨率的网格。考虑两个非结构化四面体网格，它们用于离散化一个体积为 $V$ 的固定的三维域，其单元数量分别为 $N_1 = 2 \\times 10^{6}$ 和 $N_2 = 16 \\times 10^{6}$。加密比定义为粗网格有效间距与细网格有效间距之比，并且非结构化三维网格的有效间距是基于从平均单元体积导出的代表性单元长度来理解的。使用这些原则，确定网格1（粗网格）和网格2（细网格）之间的加密比 $r$。将最终答案表示为一个无单位的实数值。无需四舍五入。",
            "solution": "该问题要求确定用于离散化一个固定的三维域的两个非结构化四面体网格之间的网格加密比 $r$。解决方案首先根据所提供的信息，将有效网格间距的概念形式化。\n\n设域的固定体积为 $V$。这两个网格被指定为网格1（粗网格）和网格2（细网格）。每个网格中的单元数量给定如下：\n粗网格单元数量：$N_1 = 2 \\times 10^{6}$。\n细网格单元数量：$N_2 = 16 \\times 10^{6}$。\n\n问题指出，非结构化网格的有效网格间距是基于从平均单元体积导出的代表性单元长度。设 $\\bar{v}_i$ 表示包含 $N_i$ 个单元的网格 $i$ 的平均单元体积。平均单元体积是总域体积除以单元数量：\n$$\\bar{v}_i = \\frac{V}{N_i}$$\n对于所讨论的这两个网格，它们的平均单元体积为：\n$$\\bar{v}_1 = \\frac{V}{N_1} \\quad \\text{和} \\quad \\bar{v}_2 = \\frac{V}{N_2}$$\n\n对于三维体积元，“代表性单元长度”或有效网格间距 $h_i$ 在量纲上与其体积的立方根成正比。这类似于具有相同体积的立方体的边长。因此，我们可以将网格 $i$ 的有效网格间距正式定义为：\n$$h_i = (\\bar{v}_i)^{1/3} = \\left(\\frac{V}{N_i}\\right)^{1/3}$$\n\n使用这个定义，我们可以表达粗网格和细网格的有效网格间距：\n粗网格（网格1）的有效间距：\n$$h_1 = \\left(\\frac{V}{N_1}\\right)^{1/3}$$\n细网格（网格2）的有效间距：\n$$h_2 = \\left(\\frac{V}{N_2}\\right)^{1/3}$$\n\n加密比 $r$ 定义为粗网格有效间距与细网格有效间距之比。\n$$r = \\frac{h_1}{h_2}$$\n\n将 $h_1$ 和 $h_2$ 的表达式代入 $r$ 的定义中：\n$$r = \\frac{\\left(\\frac{V}{N_1}\\right)^{1/3}}{\\left(\\frac{V}{N_2}\\right)^{1/3}}$$\n利用指数的性质，我们可以简化这个表达式：\n$$r = \\left( \\frac{V/N_1}{V/N_2} \\right)^{1/3}$$\n域体积项 $V$ 对于两个网格都是常数，因此可以消去：\n$$r = \\left( \\frac{N_2}{N_1} \\right)^{1/3}$$\n该表达式表明，对于一个固定的域，加密比仅取决于单元数量之比的立方根。\n\n我们已知 $N_1$ 和 $N_2$ 的数值：\n$$N_1 = 2 \\times 10^{6}$$\n$$N_2 = 16 \\times 10^{6}$$\n将这些值代入 $r$ 的方程中：\n$$r = \\left( \\frac{16 \\times 10^{6}}{2 \\times 10^{6}} \\right)^{1/3}$$\n单元数量之比计算如下：\n$$\\frac{N_2}{N_1} = \\frac{16}{2} = 8$$\n因此，加密比为：\n$$r = (8)^{1/3} = 2$$\n加密比 $r$ 是一个无量纲值 $2$。这是网格收敛性研究中一个常见的目标值，因为在三维均匀加密中，加密比为 $2$ 对应于在每个空间方向上将网格尺寸减半，这导致总单元数量增加八倍（$r^3 = 2^3 = 8$），正如本问题中所观察到的。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "严谨的验证研究通常使用包含三个或更多系统性加密网格（或时间步长）的序列，这不仅是为了估计离散误差，也是为了确定仿真的“观测收敛阶” $p$。本练习  将这一概念从空间网格推广到时间离散化，展示了理查森外推法的普适性。通过分析三个具有恒定加密比的解，您将学习如何同时提取观测收敛阶和一个更精确的外插估计值。",
            "id": "3963953",
            "problem": "在计算流体力学 (CFD) 中，对绕翼型的统计定常湍流外流进行的一次时间精确模拟，在三个均匀时间步长下产生了时间平均阻力系数，并采用恒定的时间加密比。所有时间步长均使用相同的时间积分格式，空间离散保持固定且足够精细，以致时间离散误差占主导地位。假设该模拟处于时间离散误差的渐近区域，因此测得的时间平均阻力系数服从以下形式的展开式：\n$$\nC_{D}(\\Delta t) \\;=\\; C_{D,0} \\;+\\; K \\,\\Delta t^{p} \\;+\\; \\mathcal{O}\\!\\left(\\Delta t^{p+1}\\right),\n$$\n其中 $C_{D,0}$ 是与时间步长无关的值（$\\Delta t \\to 0$ 时的极限），$K$ 是一个未知常数，$p$ 是与该方法和流动响应相关的观测到的时间精度阶。\n\n三个测量值如下：\n$$\n\\Delta t_{1} = 0.01,\\quad C_{D}(\\Delta t_{1}) = 0.310;\\qquad\n\\Delta t_{2} = 0.005,\\quad C_{D}(\\Delta t_{2}) = 0.305;\\qquad\n\\Delta t_{3} = 0.0025,\\quad C_{D}(\\Delta t_{3}) = 0.3035,\n$$\n加密比恒为 $r = \\Delta t_{1}/\\Delta t_{2} = \\Delta t_{2}/\\Delta t_{3}$。\n\n从上述渐近误差表示和源自泰勒级数截断论证的时间积分方法一致性定义出发，消去未知数 $C_{D,0}$ 和 $K$，从而得到一个用测得的阻力值和加密比表示的观测时间阶 $p$ 的表达式。然后，使用最精细的两个时间层级和观测到的阶数，推导当 $\\Delta t \\to 0$ 时外推阻力 $C_{D,0}$ 的表达式。\n\n使用给定数据计算观测到的时间阶 $p$ 和外推值 $C_{D,0}$ 的数值。将两者均四舍五入到四位有效数字。将最终答案表示为一个行矩阵，其第一项等于 $p$，第二项等于 $C_{D,0}$。最终答案无需单位。",
            "solution": "### 解答推导\n\n设三个测得的阻力系数分别表示为 $C_{D,1}$、$C_{D,2}$ 和 $C_{D,3}$，对应于时间步长 $\\Delta t_{1}$、$\\Delta t_{2}$ 和 $\\Delta t_{3}$。忽略高阶项，渐近误差模型给出了一个包含三个方程的方程组：\n$$\nC_{D,1} \\approx C_{D,0} + K \\Delta t_{1}^{p} \\quad (1) \\\\\nC_{D,2} \\approx C_{D,0} + K \\Delta t_{2}^{p} \\quad (2) \\\\\nC_{D,3} \\approx C_{D,0} + K \\Delta t_{3}^{p} \\quad (3)\n$$\n\n**1. 观测到的时间阶 $p$ 的推导**\n\n为了找到 $p$ 的表达式，我们必须消去未知数 $C_{D,0}$ 和 $K$。\n首先，通过方程两两相减来消去 $C_{D,0}$：\n$$\nC_{D,1} - C_{D,2} \\approx K (\\Delta t_{1}^{p} - \\Delta t_{2}^{p}) \\quad (4) \\\\\nC_{D,2} - C_{D,3} \\approx K (\\Delta t_{2}^{p} - \\Delta t_{3}^{p}) \\quad (5)\n$$\n接下来，通过将方程(4)除以方程(5)来消去 $K$：\n$$\n\\frac{C_{D,1} - C_{D,2}}{C_{D,2} - C_{D,3}} \\approx \\frac{\\Delta t_{1}^{p} - \\Delta t_{2}^{p}}{\\Delta t_{2}^{p} - \\Delta t_{3}^{p}}\n$$\n给定一个恒定的加密比 $r$，其中 $\\Delta t_{1} = r \\Delta t_{2}$ 且 $\\Delta t_{2} = r \\Delta t_{3}$。将这些关系代入表达式的右侧：\n$$\n\\frac{(r \\Delta t_{2})^{p} - \\Delta t_{2}^{p}}{(r \\Delta t_{3})^{p} - \\Delta t_{3}^{p}} = \\frac{r^{p} \\Delta t_{2}^{p} - \\Delta t_{2}^{p}}{r^{p} \\Delta t_{3}^{p} - \\Delta t_{3}^{p}} = \\frac{\\Delta t_{2}^{p}(r^{p} - 1)}{\\Delta t_{3}^{p}(r^{p} - 1)} = \\left(\\frac{\\Delta t_{2}}{\\Delta t_{3}}\\right)^{p} = r^{p}\n$$\n因此，我们得到关系式：\n$$\n\\frac{C_{D,1} - C_{D,2}}{C_{D,2} - C_{D,3}} \\approx r^{p}\n$$\n为了求解 $p$，我们对两边取自然对数：\n$$\n\\ln\\left(\\frac{C_{D,1} - C_{D,2}}{C_{D,2} - C_{D,3}}\\right) \\approx p \\ln(r)\n$$\n这就给出了观测到的精度阶的表达式：\n$$\np \\approx \\frac{\\ln\\left(\\frac{C_{D,1} - C_{D,2}}{C_{D,2} - C_{D,3}}\\right)}{\\ln(r)}\n$$\n\n**2. 外推阻力 $C_{D,0}$ 的推导**\n\n问题要求使用最精细的两个时间层级，即 $(\\Delta t_{2}, C_{D,2})$ 和 $(\\Delta t_{3}, C_{D,3})$，来推导 $C_{D,0}$ 的表达式。我们使用方程(2)和(3)：\n$$\nC_{D,2} \\approx C_{D,0} + K \\Delta t_{2}^{p} \\\\\nC_{D,3} \\approx C_{D,0} + K \\Delta t_{3}^{p}\n$$\n我们可以消去 $K$ 来求解 $C_{D,0}$。从第二个方程，我们有 $K \\approx (C_{D,3} - C_{D,0}) / \\Delta t_{3}^{p}$。将其代入第一个方程：\n$$\nC_{D,2} \\approx C_{D,0} + \\frac{C_{D,3} - C_{D,0}}{\\Delta t_{3}^{p}} \\Delta t_{2}^{p} = C_{D,0} + (C_{D,3} - C_{D,0})\\left(\\frac{\\Delta t_{2}}{\\Delta t_{3}}\\right)^{p}\n$$\n使用加密比 $r = \\Delta t_{2}/\\Delta t_{3}$，我们得到：\n$$\nC_{D,2} \\approx C_{D,0} + (C_{D,3} - C_{D,0})r^{p}\n$$\n现在，我们重新整理各项来求解 $C_{D,0}$：\n$$\nC_{D,2} \\approx C_{D,0} + C_{D,3}r^{p} - C_{D,0}r^{p} \\\\\nC_{D,2} - C_{D,3}r^{p} \\approx C_{D,0}(1 - r^{p}) \\\\\nC_{D,0}(r^{p} - 1) \\approx C_{D,3}r^{p} - C_{D,2}\n$$\n这就得出了外推值 $C_{D,0}$ 的表达式，即所谓的Richardson外推法：\n$$\nC_{D,0} \\approx \\frac{r^{p} C_{D,3} - C_{D,2}}{r^{p} - 1}\n$$\n\n### 数值计算\n\n给定数据为：\n$C_{D,1} = 0.310$, $C_{D,2} = 0.305$, $C_{D,3} = 0.3035$。\n加密比为 $r = 2$。\n\n**1. 计算 $p$**\n首先，计算阻力系数的差值：\n$$\nC_{D,1} - C_{D,2} = 0.310 - 0.305 = 0.005 \\\\\nC_{D,2} - C_{D,3} = 0.305 - 0.3035 = 0.0015\n$$\n现在，将这些值代入 $p$ 的表达式中：\n$$\np = \\frac{\\ln\\left(\\frac{0.005}{0.0015}\\right)}{\\ln(2)} = \\frac{\\ln\\left(\\frac{50}{15}\\right)}{\\ln(2)} = \\frac{\\ln\\left(\\frac{10}{3}\\right)}{\\ln(2)}\n$$\n使用对数的数值：\n$$\np \\approx \\frac{1.203972804}{0.6931471806} \\approx 1.73696559\n$$\n四舍五入到四位有效数字，我们得到 $p \\approx 1.737$。\n\n**2. 计算 $C_{D,0}$**\n我们使用 $C_{D,0}$ 的表达式，其中 $r=2$，并代入已计算的 $p$ 以及 $C_{D,2}$ 和 $C_{D,3}$ 的值。\n一个关键的观察是 $r^{p} = 2^{p} = 2^{\\ln(10/3)/\\ln(2)} = \\exp\\left(\\ln(2) \\frac{\\ln(10/3)}{\\ln(2)}\\right) = \\exp(\\ln(10/3)) = \\frac{10}{3}$。\n使用 $r^p$ 的这个精确值可以避免中间的舍入误差：\n$$\nC_{D,0} = \\frac{r^{p} C_{D,3} - C_{D,2}}{r^{p} - 1} = \\frac{\\frac{10}{3} C_{D,3} - C_{D,2}}{\\frac{10}{3} - 1}\n$$\n代入系数的数值：\n$$\nC_{D,0} = \\frac{\\frac{10}{3}(0.3035) - 0.305}{\\frac{7}{3}} = \\frac{10(0.3035) - 3(0.305)}{7}\n$$\n$$\nC_{D,0} = \\frac{3.035 - 0.915}{7} = \\frac{2.12}{7}\n$$\n$$\nC_{D,0} \\approx 0.30285714\n$$\n四舍五入到四位有效数字，我们得到 $C_{D,0} \\approx 0.3029$。\n最终的数值答案是 $p \\approx 1.737$ 和 $C_{D,0} \\approx 0.3029$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.737  0.3029 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "当我们对离散误差有了估计之后，需要一种标准化的方法来将其报告为数值不确定度。网格收敛指数 (Grid Convergence Index, GCI) 为精细网格的解提供了一个包含安全系数 $F_s$ 的、保守的误差范围。本练习  提供了一个基于双网格研究的GCI计算的动手实践，这是一种在收敛阶 $p$ 已知或被假设的情况下很常见的情景，为您提供了量化仿真不确定性的实用工具。",
            "id": "3963897",
            "problem": "使用计算流体动力学 (CFD) 对薄翼型进行了高保真可压缩流计算。关注量是一个无量纲积分度量，记为 $Q$，它是在一系列通过均匀细化得到的几何相似网格上计算的，这些网格由一个代表性的网格尺寸 $h$ 来表征。假设渐近离散化误差模型 $Q(h) = Q_{\\text{exact}} + C h^{p}$ 成立，其中 $Q_{\\text{exact}}$ 是连续域上的精确值，$C$ 是一个与网格无关的常数，$p$ 是与离散化相关的观测精度阶。\n\n使用了两个系统细化的网格，细化比为 $r = h_{2}/h_{1}$，其中 $h_{1}$ 是细网格的尺寸，$h_{2}$ 是中等网格的尺寸。相应的计算值在细网格上为 $Q_{1}$，在中等网格上为 $Q_{2}$。观测精度阶 $p$ 已通过一个独立的三网格研究得到，在此被视为已知。遵循标准求解验证框架，细网格的网格收敛指数 (GCI) 使用一个安全因子 $F_{s}$ 来保守地估计细网格上的相对离散化误差，该误差表示为 $Q_{1}$ 的一个分数。\n\n给定 $Q_{1} = 2.135$，$Q_{2} = 2.090$，$r = 2$，$p = 2.1$ 和 $F_{s} = 1.25$，使用渐近误差模型和 Richardson 外推法原理，推导双网格细网格 GCI 表达式作为细网格上的相对误差估计，并计算 $\\text{GCI}_{12}$。将结果表示为 $Q_{1}$ 的无量纲小数分数（不要包含百分号）。将答案四舍五入到四位有效数字。",
            "solution": "本题旨在计算使用 CFD 计算得到的关注量 $Q$ 的细网格网格收敛指数 ($\\text{GCI}_{12}$)。题目提供了一组来自双网格研究的数据，并假设精度阶 $p$ 已知。\n\n此分析的基础是渐近离散化误差模型，其形式如下：\n$$Q(h) = Q_{\\text{exact}} + C h^{p}$$\n其中 $h$ 是特征网格尺寸，$Q(h)$ 是在尺寸为 $h$ 的网格上的解，$Q_{\\text{exact}}$ 是 $h \\to 0$ 时的精确解，$C$ 是一个与网格无关的常数，$p$ 是数值格式的观测精度阶。\n\n对于所使用的两个网格，即细网格（网格1）和中等网格（网格2），我们可以根据此模型写出两个方程。设 $h_{1}$ 和 $h_{2}$ 分别为细网格和中等网格的网格尺寸，设 $Q_{1}$ 和 $Q_{2}$ 为相应的关注量计算值。\n$$Q_{1} = Q(h_{1}) = Q_{\\text{exact}} + C h_{1}^{p}$$\n$$Q_{2} = Q(h_{2}) = Q_{\\text{exact}} + C h_{2}^{p}$$\n\n题目定义了均匀网格细化比 $r = h_{2}/h_{1}$。我们可以用 $h_{1}$ 来表示 $h_{2}$，即 $h_{2} = r h_{1}$。将此代入 $Q_{2}$ 的方程中得到：\n$$Q_{2} = Q_{\\text{exact}} + C (r h_{1})^{p} = Q_{\\text{exact}} + C h_{1}^{p} r^{p}$$\n\n细网格上的离散化误差定义为 $E_{1} = Q_{1} - Q_{\\text{exact}} = C h_{1}^{p}$。我们可以通过从方程组中消去 $Q_{\\text{exact}}$ 和 $C$ 来找到该误差的估计值。从修改后的 $Q_{2}$ 方程中减去 $Q_{1}$ 的方程：\n$$Q_{2} - Q_{1} = (Q_{\\text{exact}} + C h_{1}^{p} r^{p}) - (Q_{\\text{exact}} + C h_{1}^{p})$$\n$$Q_{2} - Q_{1} = C h_{1}^{p} (r^{p} - 1)$$\n\n这使我们能够求解项 $C h_{1}^{p}$，它代表了细网格上的主阶误差。该误差的估计值记为 $E_{a,1}$，为：\n$$E_{a,1} = C h_{1}^{p} = \\frac{Q_{2} - Q_{1}}{r^{p} - 1}$$\n\n网格收敛指数 (GCI) 是一个用于报告网格收敛性研究不确定度的标准化度量。它基于 Richardson 外推误差估计，但包含一个安全因子 $F_s$ 以提供更保守的误差范围。基于网格1和网格2的细网格 $\\text{GCI}$，记为 $\\text{GCI}_{12}$，定义为安全因子乘以细网格上估计的*相对*误差的绝对值。\n\n细网格上的估计相对误差是误差估计 $E_{a,1}$ 的绝对值除以细网格解 $Q_1$ 的绝对值：\n$$\\text{Relative Error Estimate} = \\frac{|E_{a,1}|}{|Q_{1}|} = \\frac{\\left| \\frac{Q_{2} - Q_{1}}{r^{p} - 1} \\right|}{|Q_{1}|} = \\frac{|Q_{1} - Q_{2}|}{|Q_{1}|(r^{p} - 1)}$$\n\n因此，$\\text{GCI}_{12}$ 的公式为：\n$$\\text{GCI}_{12} = F_{s} \\times (\\text{Relative Error Estimate}) = F_{s} \\frac{|Q_{1} - Q_{2}|}{|Q_{1}|(r^{p} - 1)}$$\n\n我们已知以下数值：\n- 细网格解：$Q_{1} = 2.135$\n- 中等网格解：$Q_{2} = 2.090$\n- 网格细化比：$r = 2$\n- 观测精度阶：$p = 2.1$\n- 安全因子：$F_{s} = 1.25$\n\n我们将这些值代入推导出的 $\\text{GCI}_{12}$ 公式中。\n首先，我们计算必要的项：\n解的绝对差：\n$$|Q_{1} - Q_{2}| = |2.135 - 2.090| = 0.045$$\n涉及精度阶和细化比的分母项：\n$$r^{p} - 1 = 2^{2.1} - 1 \\approx 4.28709385 - 1 = 3.28709385$$\n\n现在，我们可以计算 $\\text{GCI}_{12}$：\n$$\\text{GCI}_{12} = 1.25 \\times \\frac{0.045}{2.135 \\times (2^{2.1} - 1)}$$\n$$\\text{GCI}_{12} \\approx 1.25 \\times \\frac{0.045}{2.135 \\times 3.28709385}$$\n$$\\text{GCI}_{12} \\approx \\frac{0.05625}{7.01794537} \\approx 0.008015159...$$\n\n题目要求将结果四舍五入到四位有效数字。第一位有效数字是 $8$。接下来的三位是 $0$、$1$ 和 $5$。第五位后面的数字是 $1$，所以我们向下舍入（保持 $5$ 不变）。\n$$\\text{GCI}_{12} \\approx 0.008015$$\n这个值代表了在应用安全因子后，细网格上的估计相对误差，表示为一个无量纲分数。",
            "answer": "$$\\boxed{0.008015}$$"
        }
    ]
}