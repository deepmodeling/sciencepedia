{
    "hands_on_practices": [
        {
            "introduction": "在计算流体力学中，为了在复杂的几何外形上求解控制方程，我们通常会将不规则的物理网格（$x, y$ 坐标）映射到一个规则的、正交的计算空间（$\\xi, \\eta$ 坐标）。这个练习旨在通过实践，让您掌握这一核心变换的数学基础。您将从多变量微积分的基本原理出发，推导物理空间中的微分算子如何用计算空间中的算子来表示，这是在曲线网格上进行任何数值计算的先决条件 。",
            "id": "3998081",
            "problem": "在计算流体动力学（CFD）的二维结构化网格生成中，一个从坐标为 $(\\xi,\\eta)$ 的计算域到坐标为 $(x,y)$ 的物理平面的光滑一一映射由 $x = x(\\xi,\\eta)$ 和 $y = y(\\xi,\\eta)$ 定义。考虑一个在计算域上定义的标量场 $q = q(\\xi,\\eta)$，并假设所有函数都是连续可微的，且该映射的雅可比行列式不为零。\n\n任务 1 (推导)：从链式法则以及雅可比矩阵及其行列式的定义出发，推导物理空间微分算子 $\\partial/\\partial x$ 和 $\\partial/\\partial y$ 关于计算空间算子 $\\partial/\\partial \\xi$ 和 $\\partial/\\partial \\eta$ 的显式表达式。您的推导必须从第一性原理开始，即多元链式法则和雅可比矩阵及其逆矩阵的定义，并且必须证明每一步的合理性，不得引用任何预先给出的变换恒等式。\n\n任务 2 (应用)：设映射和标量场由以下公式指定\n$$\nx(\\xi,\\eta) = \\xi + \\frac{1}{5}\\,\\xi \\eta + \\frac{1}{10}\\,\\sin(\\pi \\xi)\\,\\sin(\\pi \\eta), \\quad\ny(\\xi,\\eta) = \\eta + \\frac{3}{10}\\,\\xi^{2} + \\frac{1}{10}\\,\\cos(\\pi \\xi)\\,\\sin(\\pi \\eta),\n$$\n$$\nq(\\xi,\\eta) = \\exp(\\xi \\eta) + \\xi^{3} - \\eta^{2} + \\sin(2\\pi \\xi)\\,\\cos(\\pi \\eta).\n$$\n使用您推导出的算子，计算在对应于 $(\\xi,\\eta) = \\left(\\frac{1}{2},\\frac{1}{4}\\right)$ 的物理点上，物理空间梯度的大小 $\\|\\nabla q\\|$。将 $q$ 视为无量纲。所有三角函数均使用弧度。将您的最终结果表示为以 $\\pi$ 和 $\\exp\\!\\left(\\frac{1}{8}\\right)$ 表示的精确闭式解析表达式；不要进行任何数值舍入或近似。您的最终答案必须是单个实值表达式。",
            "solution": "用户要求我解决一个由两部分组成的问题。首先，我需要推导物理空间和计算空间之间微分算子的变换关系。其次，我需要将推导出的算子应用于一个具体案例，并计算梯度的大小。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   **映射**：一个从计算域 $(\\xi, \\eta)$ 到物理平面 $(x, y)$ 的一一映射由 $x = x(\\xi, \\eta)$ 和 $y = y(\\xi, \\eta)$ 给出。\n-   **函数**：所有函数都是连续可微的。\n-   **雅可比矩阵**：该映射的雅可比行列式不为零。\n-   **标量场**：一个标量场定义为 $q = q(\\xi, \\eta)$。\n-   **任务 1**：从多元链式法则出发，推导 $\\partial/\\partial x$ 和 $\\partial/\\partial y$ 关于 $\\partial/\\partial \\xi$ 和 $\\partial/\\partial \\eta$ 的显式表达式。\n-   **任务 2 的映射**：\n    $x(\\xi,\\eta) = \\xi + \\frac{1}{5}\\,\\xi \\eta + \\frac{1}{10}\\,\\sin(\\pi \\xi)\\,\\sin(\\pi \\eta)$\n    $y(\\xi,\\eta) = \\eta + \\frac{3}{10}\\,\\xi^{2} + \\frac{1}{10}\\,\\cos(\\pi \\xi)\\,\\sin(\\pi \\eta)$\n-   **任务 2 的标量场**：\n    $q(\\xi,\\eta) = \\exp(\\xi \\eta) + \\xi^{3} - \\eta^{2} + \\sin(2\\pi \\xi)\\,\\cos(\\pi \\eta)$\n-   **任务 2 的目标**：计算在对应于 $(\\xi,\\eta) = \\left(\\frac{1}{2},\\frac{1}{4}\\right)$ 的物理点上 $\\|\\nabla q\\|$ 的大小。\n-   **约束条件**：将 $q$ 视为无量纲。所有三角函数均使用弧度。最终结果必须是精确的闭式解析表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学依据（关键）**：该问题本质上是一个向量微积分和坐标变换的数学练习。这是计算流体动力学领域，特别是结构化网格生成中的一个标准课题。这些概念基于成熟的数学原理（链式法则、雅可比矩阵、反函数定理）。该问题在科学上是合理的。\n-   **适定性**：该问题是适定的。存在一个具有非零雅可比行列式的连续可微映射，确保了逆映射在局部存在且其导数有良好定义，从而保证了变换后的算子和梯度有唯一解。\n-   **目标（关键）**：问题以精确的数学语言陈述，没有歧义或主观解释。\n\n该问题不违反任何无效性标准。这是一个定义明确的应用数学问题。\n\n**步骤 3：结论与行动**\n\n问题是**有效的**。我将进行完整解答。\n\n### 任务 1：变换微分算子的推导\n\n目标是将物理空间偏导数算子 $\\frac{\\partial}{\\partial x}$ 和 $\\frac{\\partial}{\\partial y}$ 表示为计算空间算子 $\\frac{\\partial}{\\partial \\xi}$ 和 $\\frac{\\partial}{\\partial \\eta}$ 的形式。\n\n考虑一个在物理空间中定义的标量函数 $f=f(x,y)$。通过坐标变换 $x=x(\\xi,\\eta)$ 和 $y=y(\\xi,\\eta)$，$f$ 可以被看作是计算坐标的函数，$f = f(x(\\xi,\\eta), y(\\xi,\\eta))$。\n\n根据多元链式法则，可以求出 $f$ 关于计算坐标的导数：\n$$ \\frac{\\partial f}{\\partial \\xi} = \\frac{\\partial f}{\\partial x} \\frac{\\partial x}{\\partial \\xi} + \\frac{\\partial f}{\\partial y} \\frac{\\partial y}{\\partial \\xi} $$\n$$ \\frac{\\partial f}{\\partial \\eta} = \\frac{\\partial f}{\\partial x} \\frac{\\partial x}{\\partial \\eta} + \\frac{\\partial f}{\\partial y} \\frac{\\partial y}{\\partial \\eta} $$\n\n这是一个关于未知物理空间导数 $\\frac{\\partial f}{\\partial x}$ 和 $\\frac{\\partial f}{\\partial y}$ 的二元线性方程组。我们可以将该系统写成矩阵形式。设梯度向量表示为列向量：\n$$ \\nabla_c f = \\begin{pmatrix} \\partial f/\\partial \\xi \\\\ \\partial f/\\partial \\eta \\end{pmatrix}, \\quad \\nabla_p f = \\begin{pmatrix} \\partial f/\\partial x \\\\ \\partial f/\\partial y \\end{pmatrix} $$\n链式法则方程可以写为：\n$$ \\begin{pmatrix} \\frac{\\partial f}{\\partial \\xi} \\\\ \\frac{\\partial f}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial y} \\end{pmatrix} $$\n此方程中的矩阵是从 $(\\xi,\\eta)$ 到 $(x,y)$ 变换的标准雅可比矩阵的转置。雅可比矩阵 $J$ 定义为：\n$$ J = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} $$\n因此，该系统为 $\\nabla_c f = J^T \\nabla_p f$。为了求解物理导数 $\\nabla_p f$，我们必须对矩阵 $J^T$ 求逆：\n$$ \\nabla_p f = (J^T)^{-1} \\nabla_c f $$\n转置矩阵的逆矩阵等于逆矩阵的转置，所以 $(J^T)^{-1}=(J^{-1})^T$。雅可比矩阵 $J$ 的逆矩阵为：\n$$ J^{-1} = \\frac{1}{\\det(J)} \\begin{pmatrix} \\frac{\\partial y}{\\partial \\eta}  -\\frac{\\partial x}{\\partial \\eta} \\\\ -\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\xi} \\end{pmatrix} $$\n其中雅可比行列式 $\\mathcal{J} = \\det(J)$ 为：\n$$ \\mathcal{J} = \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta} \\frac{\\partial y}{\\partial \\xi} $$\n问题陈述保证了 $\\mathcal{J}$ 不为零。\n现在，我们求 $J^{-1}$ 的转置：\n$$ (J^{-1})^T = \\frac{1}{\\mathcal{J}} \\begin{pmatrix} \\frac{\\partial y}{\\partial \\eta}  -\\frac{\\partial y}{\\partial \\xi} \\\\ -\\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial x}{\\partial \\xi} \\end{pmatrix} $$\n将此代入 $\\nabla_p f$ 的表达式中：\n$$ \\begin{pmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial y} \\end{pmatrix} = \\frac{1}{\\mathcal{J}} \\begin{pmatrix} \\frac{\\partial y}{\\partial \\eta}  -\\frac{\\partial y}{\\partial \\xi} \\\\ -\\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial x}{\\partial \\xi} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial f}{\\partial \\xi} \\\\ \\frac{\\partial f}{\\partial \\eta} \\end{pmatrix} $$\n展开此矩阵方程得到各个表达式：\n$$ \\frac{\\partial f}{\\partial x} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial y}{\\partial \\eta} \\frac{\\partial f}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi} \\frac{\\partial f}{\\partial \\eta} \\right) $$\n$$ \\frac{\\partial f}{\\partial y} = \\frac{1}{\\mathcal{J}} \\left( -\\frac{\\partial x}{\\partial \\eta} \\frac{\\partial f}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial f}{\\partial \\eta} \\right) $$\n由于这些关系对任意可微函数 $f$ 都成立，它们定义了微分算子本身的变换：\n$$ \\frac{\\partial}{\\partial x} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial y}{\\partial \\eta} \\frac{\\partial}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi} \\frac{\\partial}{\\partial \\eta} \\right) $$\n$$ \\frac{\\partial}{\\partial y} = \\frac{1}{\\mathcal{J}} \\left( -\\frac{\\partial x}{\\partial \\eta} \\frac{\\partial}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial}{\\partial \\eta} \\right) $$\n这完成了任务 1 的推导。\n\n### 任务 2：应用\n\n题目要求我们计算在点 $(\\xi, \\eta) = (1/2, 1/4)$ 处物理空间梯度的大小，即 $\\|\\nabla q\\| = \\sqrt{(\\partial q / \\partial x)^2 + (\\partial q / \\partial y)^2}$。\n\n我们首先需要计算映射函数 $x(\\xi, \\eta)$ 和 $y(\\xi, \\eta)$ 的偏导数，这些偏导数被称为度量项。设 $x_\\xi = \\partial x/\\partial \\xi$，$x_\\eta = \\partial x/\\partial \\eta$，依此类推。\n$x(\\xi,\\eta) = \\xi + \\frac{1}{5}\\xi \\eta + \\frac{1}{10}\\sin(\\pi \\xi)\\sin(\\pi \\eta)$\n$y(\\xi,\\eta) = \\eta + \\frac{3}{10}\\xi^{2} + \\frac{1}{10}\\cos(\\pi \\xi)\\sin(\\pi \\eta)$\n\n偏导数为：\n$x_\\xi = 1 + \\frac{1}{5}\\eta + \\frac{\\pi}{10}\\cos(\\pi \\xi)\\sin(\\pi \\eta)$\n$x_\\eta = \\frac{1}{5}\\xi + \\frac{\\pi}{10}\\sin(\\pi \\xi)\\cos(\\pi \\eta)$\n$y_\\xi = \\frac{3}{5}\\xi - \\frac{\\pi}{10}\\sin(\\pi \\xi)\\sin(\\pi \\eta)$\n$y_\\eta = 1 + \\frac{\\pi}{10}\\cos(\\pi \\xi)\\cos(\\pi \\eta)$\n\n在点 $(\\xi, \\eta) = (1/2, 1/4)$ 处：\n$\\pi\\xi = \\pi/2$ 且 $\\pi\\eta = \\pi/4$。\n$\\sin(\\pi/2) = 1$，$\\cos(\\pi/2) = 0$，$\\sin(\\pi/4) = \\sqrt{2}/2$，$\\cos(\\pi/4) = \\sqrt{2}/2$。\n\n计算度量项的值：\n$x_\\xi = 1 + \\frac{1}{5}(\\frac{1}{4}) + \\frac{\\pi}{10}(0)(\\frac{\\sqrt{2}}{2}) = 1 + \\frac{1}{20} = \\frac{21}{20}$\n$x_\\eta = \\frac{1}{5}(\\frac{1}{2}) + \\frac{\\pi}{10}(1)(\\frac{\\sqrt{2}}{2}) = \\frac{1}{10} + \\frac{\\pi\\sqrt{2}}{20} = \\frac{2 + \\pi\\sqrt{2}}{20}$\n$y_\\xi = \\frac{3}{5}(\\frac{1}{2}) - \\frac{\\pi}{10}(1)(\\frac{\\sqrt{2}}{2}) = \\frac{3}{10} - \\frac{\\pi\\sqrt{2}}{20} = \\frac{6 - \\pi\\sqrt{2}}{20}$\n$y_\\eta = 1 + \\frac{\\pi}{10}(0)(\\frac{\\sqrt{2}}{2}) = 1$\n\n接下来，我们计算雅可比行列式 $\\mathcal{J} = x_\\xi y_\\eta - x_\\eta y_\\xi$：\n$\\mathcal{J} = \\left(\\frac{21}{20}\\right)(1) - \\left(\\frac{2 + \\pi\\sqrt{2}}{20}\\right)\\left(\\frac{6 - \\pi\\sqrt{2}}{20}\\right) = \\frac{21}{20} - \\frac{12 - 2\\pi\\sqrt{2} + 6\\pi\\sqrt{2} - 2\\pi^2}{400}$\n$\\mathcal{J} = \\frac{420}{400} - \\frac{12 + 4\\pi\\sqrt{2} - 2\\pi^2}{400} = \\frac{408 - 4\\pi\\sqrt{2} + 2\\pi^2}{400} = \\frac{204 - 2\\pi\\sqrt{2} + \\pi^2}{200}$\n\n现在，我们计算标量场 $q(\\xi, \\eta)$ 的偏导数：\n$q(\\xi,\\eta) = \\exp(\\xi \\eta) + \\xi^{3} - \\eta^{2} + \\sin(2\\pi \\xi)\\cos(\\pi \\eta)$\n$q_\\xi = \\eta \\exp(\\xi \\eta) + 3\\xi^2 + 2\\pi \\cos(2\\pi \\xi)\\cos(\\pi \\eta)$\n$q_\\eta = \\xi \\exp(\\xi \\eta) - 2\\eta - \\pi \\sin(2\\pi \\xi)\\sin(\\pi \\eta)$\n\n在 $(\\xi, \\eta) = (1/2, 1/4)$ 处：\n$\\xi\\eta = 1/8$，$2\\pi\\xi = \\pi$。\n$\\cos(\\pi) = -1$，$\\sin(\\pi) = 0$。\n$q_\\xi = (\\frac{1}{4})\\exp(\\frac{1}{8}) + 3(\\frac{1}{2})^2 + 2\\pi\\cos(\\pi)\\cos(\\frac{\\pi}{4}) = \\frac{1}{4}\\exp(\\frac{1}{8}) + \\frac{3}{4} + 2\\pi(-1)(\\frac{\\sqrt{2}}{2}) = \\frac{1}{4}\\exp(\\frac{1}{8}) + \\frac{3}{4} - \\pi\\sqrt{2}$\n$q_\\eta = (\\frac{1}{2})\\exp(\\frac{1}{8}) - 2(\\frac{1}{4}) - \\pi\\sin(\\pi)\\sin(\\frac{\\pi}{4}) = \\frac{1}{2}\\exp(\\frac{1}{8}) - \\frac{1}{2} - 0 = \\frac{1}{2}\\exp(\\frac{1}{8}) - \\frac{1}{2}$\n\n现在我们计算物理梯度 $q_x = \\partial q/\\partial x$ 和 $q_y = \\partial q/\\partial y$：\n$q_x = \\frac{1}{\\mathcal{J}}(y_\\eta q_\\xi - y_\\xi q_\\eta)$\n$q_x = \\frac{1}{\\mathcal{J}} \\left[ (1)\\left(\\frac{1}{4}\\exp(\\frac{1}{8}) + \\frac{3}{4} - \\pi\\sqrt{2}\\right) - \\left(\\frac{6 - \\pi\\sqrt{2}}{20}\\right)\\left(\\frac{1}{2}\\exp(\\frac{1}{8}) - \\frac{1}{2}\\right) \\right]$\n$q_x = \\frac{1}{40\\mathcal{J}} \\left[ 10\\left(\\exp(\\frac{1}{8}) + 3 - 4\\pi\\sqrt{2}\\right) - (6 - \\pi\\sqrt{2})\\left(\\exp(\\frac{1}{8}) - 1\\right) \\right]$\n$q_x = \\frac{1}{40\\mathcal{J}} \\left[ (10 - 6 + \\pi\\sqrt{2})\\exp(\\frac{1}{8}) + (30 - (-1)(6 - \\pi\\sqrt{2}) - 40\\pi\\sqrt{2}) \\right]$\n$q_x = \\frac{1}{40\\mathcal{J}} \\left[ (4 + \\pi\\sqrt{2})\\exp(\\frac{1}{8}) + 36 - 41\\pi\\sqrt{2} \\right]$\n\n$q_y = \\frac{1}{\\mathcal{J}}(-x_\\eta q_\\xi + x_\\xi q_\\eta)$\n$q_y = \\frac{1}{\\mathcal{J}} \\left[ -\\left(\\frac{2+\\pi\\sqrt{2}}{20}\\right)\\left(\\frac{1}{4}\\exp(\\frac{1}{8}) + \\frac{3}{4} - \\pi\\sqrt{2}\\right) + \\left(\\frac{21}{20}\\right)\\left(\\frac{1}{2}\\exp(\\frac{1}{8}) - \\frac{1}{2}\\right) \\right]$\n$q_y = \\frac{1}{80\\mathcal{J}} \\left[ -(2+\\pi\\sqrt{2})(\\exp(\\frac{1}{8}) + 3 - 4\\pi\\sqrt{2}) + 42(\\exp(\\frac{1}{8})-1) \\right]$\n$q_y = \\frac{1}{80\\mathcal{J}} \\left[ (-2-\\pi\\sqrt{2}+42)\\exp(\\frac{1}{8}) + (-(2+\\pi\\sqrt{2})(3-4\\pi\\sqrt{2}) - 42) \\right]$\n常数项为 $-(6-8\\pi\\sqrt{2}+3\\pi\\sqrt{2}-8\\pi^2)-42 = -6+5\\pi\\sqrt{2}+8\\pi^2-42 = -48+5\\pi\\sqrt{2}+8\\pi^2$。\n$q_y = \\frac{1}{80\\mathcal{J}} \\left[ (40 - \\pi\\sqrt{2})\\exp(\\frac{1}{8}) - 48 + 5\\pi\\sqrt{2} + 8\\pi^2 \\right]$\n\n最后，我们计算 $\\|\\nabla q\\| = \\sqrt{q_x^2 + q_y^2}$。令 $k_x = (4 + \\pi\\sqrt{2})\\exp(\\frac{1}{8}) + 36 - 41\\pi\\sqrt{2}$ 且 $k_y = (40 - \\pi\\sqrt{2})\\exp(\\frac{1}{8}) - 48 + 5\\pi\\sqrt{2} + 8\\pi^2$。\n则 $q_x = \\frac{k_x}{40\\mathcal{J}}$ 且 $q_y = \\frac{k_y}{80\\mathcal{J}}$。\n$\\|\\nabla q\\|^2 = q_x^2 + q_y^2 = \\left(\\frac{k_x}{40\\mathcal{J}}\\right)^2 + \\left(\\frac{k_y}{80\\mathcal{J}}\\right)^2 = \\frac{1}{(80\\mathcal{J})^2} (4k_x^2 + k_y^2)$。\n$\\|\\nabla q\\| = \\frac{\\sqrt{4k_x^2 + k_y^2}}{80|\\mathcal{J}|}$。\n雅可比行列式 $\\mathcal{J} = \\frac{204 - 2\\pi\\sqrt{2} + \\pi^2}{200} > 0$，所以 $|\\mathcal{J}|=\\mathcal{J}$。\n$\\|\\nabla q\\| = \\frac{\\sqrt{4k_x^2 + k_y^2}}{80 \\left( \\frac{204 - 2\\pi\\sqrt{2} + \\pi^2}{200} \\right)} = \\frac{200 \\sqrt{4k_x^2 + k_y^2}}{80 (204 - 2\\pi\\sqrt{2} + \\pi^2)} = \\frac{5 \\sqrt{4k_x^2 + k_y^2}}{2 (204 - 2\\pi\\sqrt{2} + \\pi^2)}$。\n代入 $k_x$ 和 $k_y$ 的表达式，得到最终答案。",
            "answer": "$$\n\\boxed{\\frac{5\\sqrt{4\\left((4+\\pi\\sqrt{2})\\exp(\\frac{1}{8}) + 36 - 41\\pi\\sqrt{2}\\right)^{2} + \\left((40-\\pi\\sqrt{2})\\exp(\\frac{1}{8}) - 48 + 5\\pi\\sqrt{2} + 8\\pi^{2}\\right)^{2}}}{2(204 - 2\\pi\\sqrt{2} + \\pi^{2})}}\n$$"
        },
        {
            "introduction": "代数方法，特别是超限插值（TFI），因其快速且能精确控制边界而成为一种重要的结构化网格生成技术。然而，不恰当的边界定义可能导致网格线交叉或折叠，从而产生无效的网格。本练习将带您深入探讨这一问题，重点分析网格角点处的局部有效性条件 。通过推导TFI映射在角点处的雅可比行列式，您将清晰地理解边界曲线的参数化方式如何直接决定网格质量，并掌握避免网格重叠的关键准则。",
            "id": "3998085",
            "problem": "考虑一个由参数域 $(u,v) \\in [0,1] \\times [0,1]$ 定义的四边形计算网格片，该网格片通过使用由四条可微边界曲线构成的双线性混合超限插值（TFI）映射到物理平面 $\\mathbb{R}^{2}$ 中。这四条边界曲线是：$v=0$ 处的底边界 $\\boldsymbol{b}(u) = \\big(b_{x}(u), b_{y}(u)\\big)$，$v=1$ 处的顶边界 $\\boldsymbol{t}(u) = \\big(t_{x}(u), t_{y}(u)\\big)$，$u=0$ 处的左边界 $\\boldsymbol{\\ell}(v) = \\big(\\ell_{x}(v), \\ell_{y}(v)\\big)$，以及 $u=1$ 处的右边界 $\\boldsymbol{r}(v) = \\big(r_{x}(v), r_{y}(v)\\big)$。假设每条边界曲线在其参数区间上至少是二次连续可微的，并且角点在位置上是兼容的，即\n$$\n\\boldsymbol{x}_{00} = \\boldsymbol{b}(0) = \\boldsymbol{\\ell}(0), \\quad \n\\boldsymbol{x}_{10} = \\boldsymbol{b}(1) = \\boldsymbol{r}(0), \\quad\n\\boldsymbol{x}_{01} = \\boldsymbol{t}(0) = \\boldsymbol{\\ell}(1), \\quad\n\\boldsymbol{x}_{11} = \\boldsymbol{t}(1) = \\boldsymbol{r}(1).\n$$\nTFI 映射 $\\boldsymbol{x}(u,v)$ 是通过混合边界曲线和修正角点项来定义的，以恢复四条边界曲线及其共享的角点。\n\n从平面映射的雅可比矩阵的定义和反函数定理出发，根据第一性原理推导角点 $(u,v)=(0,0)$ 处的局部不重叠条件，并用边界曲线的参数化形式表示。具体来说：\n\n- 将 $\\boldsymbol{x}(u,v)$ 在 $(0,0)$ 的邻域内展开至一阶，并确定张成参数增量 $(\\mathrm{d}u,\\mathrm{d}v)$ 的局部像的两个切线方向。\n- 使用面积雅可比行列式 $J(u,v) = \\det\\left(\\frac{\\partial \\boldsymbol{x}}{\\partial (u,v)}\\right)$，用 $\\boldsymbol{b}'(0)$ 和 $\\boldsymbol{\\ell}'(0)$ 的分量表示 $J(0,0)$，其中撇号表示对边界参数求导。\n- 解释 $J(0,0)$ 的符号和非零性如何对角点处边界曲线参数化的选择施加必要约束，以避免 TFI 网格片中的重叠（折叠），并将此方向约束推广到其他三个角点。\n\n你的最终答案必须是 $J(0,0)$ 关于 $b_{x}'(0)$、$b_{y}'(0)$、$\\ell_{x}'(0)$ 和 $\\ell_{y}'(0)$ 的单个闭式解析表达式。不要提供数值近似。无需四舍五入。单位不适用，因为该表达式在映射中对于面积缩放是无量纲的。",
            "solution": "所述问题是有效的。它在科学上基于计算流体力学的一个子领域——结构化网格生成中使用的超限插值（TFI）的既定理论。该问题是适定的、客观的，并包含进行严格数学推导的充分信息。\n\n问题的核心是在计算域的一个角点处分析 TFI 映射的局部性质。对此的关键诊断工具是映射的雅可比行列式，它衡量从参数空间到物理空间局部面积和方向的变化。一个有效、不重叠的网格需要一个非奇异、保向的映射。\n\n我们首先陈述在单位正方形 $(u,v) \\in [0,1] \\times [0,1]$ 上定义的四边形网格片的双线性混合超限插值映射 $\\boldsymbol{x}(u,v)$ 的公式。该映射由两个线性投影算子（一个在 $u$ 方向，一个在 $v$ 方向）的布尔和构成。它由下式给出：\n$$\n\\boldsymbol{x}(u,v) = (1-u)\\boldsymbol{\\ell}(v) + u\\boldsymbol{r}(v) + (1-v)\\boldsymbol{b}(u) + v\\boldsymbol{t}(u) - \\boldsymbol{x}_{c}(u,v)\n$$\n其中 $\\boldsymbol{b}(u)$、$\\boldsymbol{t}(u)$、$\\boldsymbol{\\ell}(v)$ 和 $\\boldsymbol{r}(v)$ 是四条边界曲线，而 $\\boldsymbol{x}_{c}(u,v)$ 是双线性角点混合项：\n$$\n\\boldsymbol{x}_{c}(u,v) = (1-u)(1-v)\\boldsymbol{x}_{00} + u(1-v)\\boldsymbol{x}_{10} + (1-u)v\\boldsymbol{x}_{01} + uv\\boldsymbol{x}_{11}\n$$\n项 $\\boldsymbol{x}_{00}$、$\\boldsymbol{x}_{10}$、$\\boldsymbol{x}_{01}$ 和 $\\boldsymbol{x}_{11}$ 是角点，它们满足给定的兼容性条件：$\\boldsymbol{x}_{00} = \\boldsymbol{b}(0) = \\boldsymbol{\\ell}(0)$、$\\boldsymbol{x}_{10} = \\boldsymbol{b}(1) = \\boldsymbol{r}(0)$、$\\boldsymbol{x}_{01} = \\boldsymbol{t}(0) = \\boldsymbol{\\ell}(1)$ 和 $\\boldsymbol{x}_{11} = \\boldsymbol{t}(1) = \\boldsymbol{r}(1)$。\n\n为了找到映射在角点 $(u,v) = (0,0)$ 附近的行为，我们首先计算切向量 $\\frac{\\partial \\boldsymbol{x}}{\\partial u}$ 和 $\\frac{\\partial \\boldsymbol{x}}{\\partial v}$。将 $\\boldsymbol{x}(u,v)$ 的表达式对 $u$ 求导得到：\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial u} = -\\boldsymbol{\\ell}(v) + \\boldsymbol{r}(v) + (1-v)\\boldsymbol{b}'(u) + v\\boldsymbol{t}'(u) - \\frac{\\partial \\boldsymbol{x}_{c}}{\\partial u}\n$$\n其中撇号表示对曲线参数求导（例如，$\\boldsymbol{b}'(u) = \\frac{\\mathrm{d}\\boldsymbol{b}}{\\mathrm{d}u}$）。角点项的导数为：\n$$\n\\frac{\\partial \\boldsymbol{x}_{c}}{\\partial u} = -(1-v)\\boldsymbol{x}_{00} + (1-v)\\boldsymbol{x}_{10} - v\\boldsymbol{x}_{01} + v\\boldsymbol{x}_{11}\n$$\n将此代入 $\\frac{\\partial \\boldsymbol{x}}{\\partial u}$ 的表达式中得到：\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial u} = -\\boldsymbol{\\ell}(v) + \\boldsymbol{r}(v) + (1-v)\\boldsymbol{b}'(u) + v\\boldsymbol{t}'(u) + (1-v)\\boldsymbol{x}_{00} - (1-v)\\boldsymbol{x}_{10} + v\\boldsymbol{x}_{01} - v\\boldsymbol{x}_{11}\n$$\n现在，我们在角点 $(u,v)=(0,0)$ 处计算这个偏导数：\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial u}\\Big|_{(0,0)} = -\\boldsymbol{\\ell}(0) + \\boldsymbol{r}(0) + (1-0)\\boldsymbol{b}'(0) + (0)\\boldsymbol{t}'(0) + (1-0)\\boldsymbol{x}_{00} - (1-0)\\boldsymbol{x}_{10} + (0)\\boldsymbol{x}_{01} - (0)\\boldsymbol{x}_{11}\n$$\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial u}\\Big|_{(0,0)} = -\\boldsymbol{\\ell}(0) + \\boldsymbol{r}(0) + \\boldsymbol{b}'(0) + \\boldsymbol{x}_{00} - \\boldsymbol{x}_{10}\n$$\n使用角点兼容性条件 $\\boldsymbol{\\ell}(0) = \\boldsymbol{x}_{00}$ 和 $\\boldsymbol{r}(0) = \\boldsymbol{x}_{10}$，各项相消：\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial u}\\Big|_{(0,0)} = -\\boldsymbol{x}_{00} + \\boldsymbol{x}_{10} + \\boldsymbol{b}'(0) + \\boldsymbol{x}_{00} - \\boldsymbol{x}_{10} = \\boldsymbol{b}'(0)\n$$\n类似地，我们将 $\\boldsymbol{x}(u,v)$ 对 $v$ 求导：\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial v} = (1-u)\\boldsymbol{\\ell}'(v) + u\\boldsymbol{r}'(v) - \\boldsymbol{b}(u) + \\boldsymbol{t}(u) - \\frac{\\partial \\boldsymbol{x}_{c}}{\\partial v}\n$$\n其中\n$$\n\\frac{\\partial \\boldsymbol{x}_{c}}{\\partial v} = -(1-u)\\boldsymbol{x}_{00} - u\\boldsymbol{x}_{10} + (1-u)\\boldsymbol{x}_{01} + u\\boldsymbol{x}_{11}\n$$\n因此，\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial v} = (1-u)\\boldsymbol{\\ell}'(v) + u\\boldsymbol{r}'(v) - \\boldsymbol{b}(u) + \\boldsymbol{t}(u) + (1-u)\\boldsymbol{x}_{00} + u\\boldsymbol{x}_{10} - (1-u)\\boldsymbol{x}_{01} - u\\boldsymbol{x}_{11}\n$$\n在 $(u,v)=(0,0)$ 处计算：\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial v}\\Big|_{(0,0)} = (1-0)\\boldsymbol{\\ell}'(0) + (0)\\boldsymbol{r}'(0) - \\boldsymbol{b}(0) + \\boldsymbol{t}(0) + (1-0)\\boldsymbol{x}_{00} + (0)\\boldsymbol{x}_{10} - (1-0)\\boldsymbol{x}_{01} - (0)\\boldsymbol{x}_{11}\n$$\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial v}\\Big|_{(0,0)} = \\boldsymbol{\\ell}'(0) - \\boldsymbol{b}(0) + \\boldsymbol{t}(0) + \\boldsymbol{x}_{00} - \\boldsymbol{x}_{01}\n$$\n使用兼容性条件 $\\boldsymbol{b}(0) = \\boldsymbol{x}_{00}$ 和 $\\boldsymbol{t}(0) = \\boldsymbol{x}_{01}$，各项相消：\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial v}\\Big|_{(0,0)} = \\boldsymbol{\\ell}'(0) - \\boldsymbol{x}_{00} + \\boldsymbol{x}_{01} + \\boldsymbol{x}_{00} - \\boldsymbol{x}_{01} = \\boldsymbol{\\ell}'(0)\n$$\n$\\boldsymbol{x}(u,v)$ 在 $(0,0)$ 附近的一阶泰勒展开为：\n$$\n\\boldsymbol{x}(u,v) \\approx \\boldsymbol{x}(0,0) + u \\frac{\\partial \\boldsymbol{x}}{\\partial u}\\Big|_{(0,0)} + v \\frac{\\partial \\boldsymbol{x}}{\\partial v}\\Big|_{(0,0)}\n$$\n$$\n\\boldsymbol{x}(u,v) \\approx \\boldsymbol{x}_{00} + u \\boldsymbol{b}'(0) + v \\boldsymbol{\\ell}'(0)\n$$\n在 $(0,0)$ 处，张成一个无穷小参数矩形 $(\\mathrm{d}u, \\mathrm{d}v)$ 局部像的两个切线方向，恰好是相交边界曲线的切向量：$\\boldsymbol{b}'(0)$ 和 $\\boldsymbol{\\ell}'(0)$。\n\n在 $(u,v)$ 处的变换的雅可比矩阵是 $J_M(u,v) = \\left[ \\frac{\\partial \\boldsymbol{x}}{\\partial u} \\quad \\frac{\\partial \\boldsymbol{x}}{\\partial v} \\right]$。在角点 $(0,0)$ 处，这变为：\n$$\nJ_M(0,0) = \\left[ \\boldsymbol{b}'(0) \\quad \\boldsymbol{\\ell}'(0) \\right] = \\begin{pmatrix} b_{x}'(0)  \\ell_{x}'(0) \\\\ b_{y}'(0)  \\ell_{y}'(0) \\end{pmatrix}\n$$\n因此，在 $(0,0)$ 处的雅可比行列式 $J(u,v) = \\det(J_M(u,v))$ 为：\n$$\nJ(0,0) = \\det(J_M(0,0)) = \\begin{vmatrix} b_{x}'(0)  \\ell_{x}'(0) \\\\ b_{y}'(0)  \\ell_{y}'(0) \\end{vmatrix} = b_{x}'(0)\\ell_{y}'(0) - b_{y}'(0)\\ell_{x}'(0)\n$$\n这个表达式代表了由两个切向量 $\\boldsymbol{b}'(0)$ 和 $\\boldsymbol{\\ell}'(0)$ 张成的平行四边形的有向面积。\n\n$J(0,0)$ 的符号和非零性是至关重要的。根据反函数定理，映射 $\\boldsymbol{x}(u,v)$ 在 $(0,0)$ 处局部可逆的充分必要条件是 $J(0,0) \\neq 0$。\n- 如果 $J(0,0) = 0$，则切向量 $\\boldsymbol{b}'(0)$ 和 $\\boldsymbol{\\ell}'(0)$ 是共线的。这意味着该映射将参数正方形的角点塌缩成物理平面上的一条线或一个点，从而产生一个奇点，在此处网格单元面积为零。这是一个退化的网格。\n- 如果 $J(0,0) \\neq 0$，则该映射是局部一一对应的。$J(0,0)$ 的符号决定了方向。对于一个有效、不重叠的网格，雅可比行列式必须在整个域内保持相同的符号。一个常见的约定是要求对于所有 $(u,v) \\in [0,1] \\times [0,1]$ 都有 $J(u,v)  0$。\n- 因此，条件 $J(0,0)  0$，即 $b_{x}'(0)\\ell_{y}'(0) - b_{y}'(0)\\ell_{x}'(0)  0$，对角点处的边界曲线施加了几何约束。它要求从 $\\boldsymbol{b}'(0)$ 到 $\\boldsymbol{\\ell}'(0)$ 的角为正（即逆时针且小于 $\\pi$），从而确保网格线从角点发散到物理网格片的内部而不相交。\n\n这个方向约束必须在所有四个角点都成立。通过进行类似的推导，我们得到其他三个角点的雅可比行列式：\n- 在 $(u,v)=(1,0)$ 处：$J(1,0) = \\det(\\boldsymbol{b}'(1), \\boldsymbol{r}'(0)) = b_{x}'(1)r_{y}'(0) - b_{y}'(1)r_{x}'(0)  0$。\n- 在 $(u,v)=(0,1)$ 处：$J(0,1) = \\det(\\boldsymbol{\\ell}'(1), -\\boldsymbol{t}'(0)) = \\ell_{x}'(1)(-t_{y}'(0)) - \\ell_{y}'(1)(-t_{x}'(0)) = t_{x}'(0)\\ell_{y}'(1) - t_{y}'(0)\\ell_{x}'(1)  0$。\n- 在 $(u,v)=(1,1)$ 处：$J(1,1) = \\det(-\\boldsymbol{t}'(1), \\boldsymbol{r}'(1)) = (-t_{x}'(1))r_{y}'(1) - (-t_{y}'(1))r_{x}'(1) = t_{y}'(1)r_{x}'(1) - t_{x}'(1)r_{y}'(1)  0$。注意，这四个条件的方向性取决于参数化的方向。一个更一致的表述是，角点处的两个出射切向量必须形成一个正向的基底。\n\n所要求的最终答案是 $J(0,0)$ 的单个表达式。",
            "answer": "$$\n\\boxed{b_{x}'(0) \\ell_{y}'(0) - b_{y}'(0) \\ell_{x}'(0)}\n$$"
        },
        {
            "introduction": "椭圆型方法是另一种强大的结构化网格生成技术，它通过求解偏微分方程（PDEs）来生成光滑、高质量的网格。该方法的核心在于将连续的控制方程转化为计算机可以求解的离散代数方程组。本练习将引导您完成这一关键过程：使用中心差分格式离散一个通用的二阶椭圆型算子，并分析所得到的线性系统的性质 。掌握这一实践不仅能加深您对椭圆型生成器工作原理的理解，也为选择和优化求解大规模线性系统的数值算法奠定基础。",
            "id": "3998021",
            "problem": "考虑在航空航天计算流体动力学 (CFD) 中使用的椭圆网格生成方程，该方程在计算坐标 $\\xi$ 和 $\\eta$ 下的结构化计算域上建立。设物理坐标为 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$，并考虑应用于 $x$ 的一般二阶椭圆算子：\n$$\nA(\\xi,\\eta)\\,x_{\\xi\\xi}(\\xi,\\eta) + 2\\,B(\\xi,\\eta)\\,x_{\\xi\\eta}(\\xi,\\eta) + C(\\xi,\\eta)\\,x_{\\eta\\eta}(\\xi,\\eta) \\;=\\; S_x(\\xi,\\eta),\n$$\n对 $y$ 也具有相同的形式。度量相关的系数 $A$、$B$ 和 $C$ 源于网格映射，并在内部对所有 $(\\xi,\\eta)$ 满足一致椭圆性条件 $A(\\xi,\\eta)  0$、$C(\\xi,\\eta)  0$ 和 $A(\\xi,\\eta)\\,C(\\xi,\\eta) - B(\\xi,\\eta)^2  0$。假设在计算域的边界上为 $x$ 和 $y$ 指定了 Dirichlet 边界条件，因此内部值由一个线性系统确定。\n\n使用一个均匀结构化网格离散化域 $[0,1]\\times[0,1]$，该网格在每个坐标方向上包含 $n$ 个内部点（因此对于 $x$ 和 $y$ 各有 $n \\times n$ 个内部未知数），均匀间距为 $\\Delta \\xi = \\frac{1}{n+1}$ 和 $\\Delta \\eta = \\frac{1}{n+1}$。使用内部节点 $(i,j)$ 处的二阶中心有限差分，通过代入以下标准近似，推导 $x(\\xi,\\eta)$ 的算子的离散形式：\n$$\nx_{\\xi\\xi}\\big|_{i,j} \\approx \\frac{x_{i+1,j} - 2\\,x_{i,j} + x_{i-1,j}}{\\Delta \\xi^2}, \\quad\nx_{\\eta\\eta}\\big|_{i,j} \\approx \\frac{x_{i,j+1} - 2\\,x_{i,j} + x_{i,j-1}}{\\Delta \\eta^2}, \\quad\nx_{\\xi\\eta}\\big|_{i,j} \\approx \\frac{x_{i+1,j+1} - x_{i+1,j-1} - x_{i-1,j+1} + x_{i-1,j-1}}{4\\,\\Delta \\xi\\,\\Delta \\eta},\n$$\n并将 $A$、$B$、$C$ 和 $S_x$ 视为在节点 $(i,j)$ 处求值的已知系数场。为内部未知数 $\\boldsymbol{x}$ 组装得到的线性系统 $K\\,\\boldsymbol{x} = \\boldsymbol{b}$，并分析在这些假设下 $K$ 的稀疏模式和对称性。在你的分析中，从一致椭圆性和中心差分相容性出发，讨论在施加 Dirichlet 边界条件时，$K$ 成为对称正定矩阵的条件。\n\n最后，特化到系数 $A$、$B$、$C$ 为常数且所有边界上均为 Dirichlet 边界条件的情况。对于仅与 $x$ 方程相关的所得矩阵 $K$，计算 $K$ 的非零元总数的精确值，表示为 $n$ 的闭合形式函数。将最终答案表示为关于 $n$ 的单个闭合形式解析表达式，不带单位。不要进行四舍五入或近似。",
            "solution": "所述问题需要经过验证。\n\n### 步骤 1：提取已知条件\n- **控制方程**：$A(\\xi,\\eta)\\,x_{\\xi\\xi}(\\xi,\\eta) + 2\\,B(\\xi,\\eta)\\,x_{\\xi\\eta}(\\xi,\\eta) + C(\\xi,\\eta)\\,x_{\\eta\\eta}(\\xi,\\eta) = S_x(\\xi,\\eta)$，用于物理坐标 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 在计算坐标为 $\\xi$ 和 $\\eta$ 的计算域中。\n- **椭圆性条件**：$A(\\xi,\\eta)  0$，$C(\\xi,\\eta)  0$ 和 $A(\\xi,\\eta)\\,C(\\xi,\\eta) - B(\\xi,\\eta)^2  0$。\n- **区域**：计算域为 $[0,1]\\times[0,1]$。\n- **边界条件**：在计算域的边界上为 $x$ 和 $y$ 指定了 Dirichlet 边界条件。\n- **离散化**：具有 $n \\times n$ 个内部未知点的均匀结构化网格。\n- **网格间距**：$\\Delta \\xi = \\frac{1}{n+1}$ 和 $\\Delta \\eta = \\frac{1}{n+1}$。\n- **有限差分近似**：\n  - $x_{\\xi\\xi}\\big|_{i,j} \\approx \\frac{x_{i+1,j} - 2\\,x_{i,j} + x_{i-1,j}}{\\Delta \\xi^2}$\n  - $x_{\\eta\\eta}\\big|_{i,j} \\approx \\frac{x_{i,j+1} - 2\\,x_{i,j} + x_{i,j-1}}{\\Delta \\eta^2}$\n  - $x_{\\xi\\eta}\\big|_{i,j} \\approx \\frac{x_{i+1,j+1} - x_{i+1,j-1} - x_{i-1,j+1} + x_{i-1,j-1}}{4\\,\\Delta \\xi\\,\\Delta \\eta}$\n- **任务**：\n  1. 推导 $x(\\xi,\\eta)$ 算子的离散形式。\n  2. 组装线性系统 $K\\,\\boldsymbol{x} = \\boldsymbol{b}$ 并分析 $K$ 的稀疏性和对称性。\n  3. 讨论 $K$ 成为对称正定矩阵的条件。\n  4. 对于常系数 $A$、$B$、$C$，计算 $K$ 的非零元总数，作为 $n$ 的函数。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了使用标准中心有限差分对一般二阶线性椭圆偏微分方程进行离散化的过程。这是数值分析和计算流体动力学中用于椭圆网格生成的一个基本且成熟的程序。椭圆性条件是标准的并且陈述正确。该问题的所有方面在科学上和数学上都是合理的。\n- **适定性**：该问题通过一个特定的偏微分方程、边界条件、域和离散化方法进行了清晰的定义。所提问题是精确的，并能导出一组唯一的解析结果。\n- **客观性**：语言正式、精确，没有任何主观或模糊的术语。\n- **完整性和一致性**：该问题为其解答提供了所有必要信息。设置是内部一致的。\n\n### 步骤 3：结论与行动\n问题是有效的。将提供一个完整的解答。\n\n***\n\n### 离散方程的推导\n设均匀网格间距为 $h = \\Delta \\xi = \\Delta \\eta = \\frac{1}{n+1}$。我们考虑一个通用内部节点 $(i,j)$，其中 $i, j \\in \\{1, 2, \\dots, n\\}$。设 $x_{i,j}$ 表示 $x(i\\Delta\\xi, j\\Delta\\eta)$ 的离散近似，并设 $A_{i,j}$、$B_{i,j}$、$C_{i,j}$ 和 $(S_x)_{i,j}$ 是在该节点处求值的系数和源项。将给定的有限差分公式代入控制偏微分方程，得到：\n$$\nA_{i,j}\\left(\\frac{x_{i+1,j} - 2x_{i,j} + x_{i-1,j}}{h^2}\\right) + 2B_{i,j}\\left(\\frac{x_{i+1,j+1} - x_{i+1,j-1} - x_{i-1,j+1} + x_{i-1,j-1}}{4h^2}\\right) + C_{i,j}\\left(\\frac{x_{i,j+1} - 2x_{i,j} + x_{i,j-1}}{h^2}\\right) = (S_x)_{i,j}\n$$\n为了构成线性系统 $K\\boldsymbol{x}=\\boldsymbol{b}$，我们通过将所有未知 $x$ 项收集到左侧来重新排列方程。为清晰起见，两边同乘以 $h^2$：\n$$\nA_{i,j}(x_{i+1,j} - 2x_{i,j} + x_{i-1,j}) + \\frac{B_{i,j}}{2}(x_{i+1,j+1} - x_{i+1,j-1} - x_{i-1,j+1} + x_{i-1,j-1}) + C_{i,j}(x_{i,j+1} - 2x_{i,j} + x_{i,j-1}) = h^2 (S_x)_{i,j}\n$$\n按相对于 $(i,j)$ 的索引对各项进行分组：\n$$\n\\left(\\frac{B_{i,j}}{2}\\right)x_{i+1,j+1} + C_{i,j}x_{i,j+1} + \\left(-\\frac{B_{i,j}}{2}\\right)x_{i-1,j+1} + A_{i,j}x_{i+1,j} - 2(A_{i,j}+C_{i,j})x_{i,j} + A_{i,j}x_{i-1,j} + \\left(-\\frac{B_{i,j}}{2}\\right)x_{i+1,j-1} + C_{i,j}x_{i,j-1} + \\left(\\frac{B_{i,j}}{2}\\right)x_{i-1,j-1} = h^2(S_x)_{i,j}\n$$\n这是内部节点 $(i,j)$ 的离散方程。涉及索引为 $i=0, i=n+1, j=0,$ 或 $j=n+1$ 的节点的项从 Dirichlet 边界条件中是已知的，并被移到右侧，构成向量 $\\boldsymbol{b}$。\n\n### 矩阵 $K$ 的分析\n未知数向量 $\\boldsymbol{x}$ 是一个大小为 $n^2$ 的向量，包含 $i,j \\in \\{1, \\dots, n\\}$ 的值 $x_{i,j}$。一种常见的选择是字典序。\n\n**稀疏模式：**\n节点 $(i,j)$ 处的离散方程将 $x_{i,j}$ 与其 8 个直接邻居 $(i\\pm1, j)$、$(i, j\\pm1)$、$(i\\pm1, j\\pm1)$ 联系起来。这定义了一个 9 点计算模板。因此，在线性系统 $K\\boldsymbol{x}=\\boldsymbol{b}$ 中，$n^2 \\times n^2$ 矩阵 $K$ 的每一行最多有 9 个非零元（一个在对角线上，最多 8 个在非对角线上）。对于大的 $n$，非零元与总元素之比约为 $9/n^2$，当 $n$ 增大时趋近于零。因此，矩阵 $K$ 是稀疏的。如果使用字典序，$K$ 具有块三对角结构，其中每个块本身就是一个带状矩阵。如果 $B=0$，每个块是三对角的。如果 $B \\neq 0$，交叉导数项会增加两个额外的非对角线，使每个块成为五对角的。\n\n**对称性：**\n如果对于对应于节点 $(i,j)$ 和 $(k,l)$ 的任意两个全局索引 $u$ 和 $v$ 都有 $K_{uv} = K_{vu}$，则矩阵 $K$ 是对称的。这意味着节点 $(i,j)$ 方程中 $x_{k,l}$ 的系数必须等于节点 $(k,l)$ 方程中 $x_{i,j}$ 的系数。我们来检查节点 $(i,j)$ 方程中 $x_{i+1,j}$ 的系数，即 $A_{i,j}/h^2$。节点 $(i+1,j)$ 方程中 $x_{i,j}$ 的系数是 $A_{i+1,j}/h^2$（来自 $x_{(i+1)-1,j}$ 项）。为了对称，我们要求对于所有相关的 $i,j$ 都有 $A_{i,j}=A_{i+1,j}$。推而广之，$A$ 必须独立于 $\\xi$。类似地，$C$ 必须独立于 $\\eta$。对于交叉导数项，节点 $(i,j)$ 方程中 $x_{i+1,j+1}$ 的系数是 $B_{i,j}/(2h^2)$。节点 $(i+1,j+1)$ 方程中 $x_{i,j}$ 的系数是 $B_{i+1,j+1}/(2h^2)$。这要求 $B_{i,j}=B_{i+1,j+1}$。检查所有邻居对可得出结论：对于这种离散化，要使 $K$ 对称，$A$、$B$ 和 $C$ 必须是常数。如果系数是 $(\\xi, \\eta)$ 的函数，矩阵 $K$ 通常是非对称的。\n\n**正定性：**\n让我们假设对称性条件成立，即 $A, B, C$ 是常数。我们可以分析与离散算子的负相关的矩阵的正定性，我们将其记为 $-K$。对于具有 Dirichlet 边界条件的域 $[0,1]\\times[0,1]$，$-K$ 的特征值由下式给出：\n$$\n\\lambda_{k,l} = \\frac{4A}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(n+1)}\\right) + \\frac{4C}{h^2}\\sin^2\\left(\\frac{l\\pi}{2(n+1)}\\right) + \\frac{2B}{h^2}\\sin\\left(\\frac{k\\pi}{n+1}\\right)\\sin\\left(\\frac{l\\pi}{n+1}\\right)\n$$\n对于 $k, l \\in \\{1, 2, \\dots, n\\}$。设 $X = \\sin(\\frac{k\\pi h}{2})$ 和 $Y = \\sin(\\frac{l\\pi h}{2})$。使用三角恒等式，上式可以被构造成与连续算子的符号相对应的二次型。所有特征值 $\\lambda_{k,l}$ 为正的一个充分条件是连续椭圆性条件 $A0, C0$ 和 $A C - B^2  0$。在这些条件下，且系数为常数时，与离散算子相关的矩阵是（在乘以适当的符号后）对称正定的。对于我们的定义，$K$ 的对角线元素 $-2(A+C)$ 为负，而 $A,C > 0$ 意味着非对角线元素为正。这样的矩阵通常被称为具有负对角占优性，这与正定性相关。如果 $A,C>0$ 且 $|B|$ 足够小，则矩阵 $-K$ 可以被证明是对称正定的。严格的正定性要求 $A0, C0, AC-B^20$。\n\n### 常系数情况下非零元的计算\n对于常数非零系数 $A, B, C$，9点模板适用于所有内部节点。我们计算 $n^2 \\times n^2$ 矩阵 $K$ 中的非零元数量。这等价于对每个内部节点，计算其离散方程中涉及的未知节点的数量（包括其自身）。我们将 $n^2$ 个内部节点分为三类：\n1.  **角点**：内部网格的4个角点 $(1,1), (1,n), (n,1), (n,n)$。每个角点有5个邻居在边界上（已知值），3个邻居是内部未知数。因此，每个角点在其离散方程中涉及 $1$ (自身) $+ 3$ (邻居) $= 4$ 个未知数。总贡献：$4 \\times 4 = 16$。\n2.  **边节点 (非角点)**：这些是内部网格边界上但不属于角点的节点。有4条边，每条边上有 $n-2$ 个这样的节点。总共有 $4(n-2)$ 个边节点。每个边节点有3个邻居在边界上（已知值），5个邻居是内部未知数。因此，每个边节点在其方程中涉及 $1$ (自身) $+ 5$ (邻居) $= 6$ 个未知数。总贡献：$6 \\times 4(n-2) = 24(n-2)$。\n3.  **深度内部节点**：这些节点不与任何边界相邻。有 $(n-2) \\times (n-2) = (n-2)^2$ 个这样的节点。每个深度内部节点的所有8个邻居都是内部未知数。因此，每个节点在其方程中涉及 $1$ (自身) $+ 8$ (邻居) $= 9$ 个未知数。总贡献：$9 \\times (n-2)^2$。\n\n将所有贡献相加，得到非零元的总数 $N$ (对于 $n \\ge 2$)：\n$$\nN = 9(n-2)^2 + 24(n-2) + 16\n$$\n展开表达式：\n$$\nN = 9(n^2 - 4n + 4) + 24n - 48 + 16\n$$\n$$\nN = 9n^2 - 36n + 36 + 24n - 32\n$$\n$$\nN = 9n^2 - 12n + 4\n$$\n这个二次多项式可以被因式分解为：\n$$\nN = (3n - 2)^2\n$$\n这个公式也对 $n=1$ 的情况成立。当 $n=1$ 时，只有一个内部节点，它是一个角点（相对于其自身）。它有8个邻居在边界上。因此，它的方程只涉及自身，非零元数量为1。公式给出 $(3(1)-2)^2 = 1^2 = 1$。因此，该公式对所有 $n \\ge 1$ 都有效。",
            "answer": "$$\n\\boxed{(3n-2)^2}\n$$"
        }
    ]
}