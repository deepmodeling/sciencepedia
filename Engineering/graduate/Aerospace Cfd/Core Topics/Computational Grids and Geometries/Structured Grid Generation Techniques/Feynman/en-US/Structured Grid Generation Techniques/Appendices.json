{
    "hands_on_practices": [
        {
            "introduction": "Before we can generate or use a structured grid, we must master the mathematical language that connects our simple, rectangular computational domain, with coordinates $(\\xi, \\eta)$, to the complex physical domain, with coordinates $(x, y)$. This practice lays the foundation by having you derive the transformation rules for partial derivatives from first principles using the chain rule and the Jacobian matrix. Understanding this transformation is essential for converting the governing equations of fluid dynamics into a form that can be solved on the computational grid.",
            "id": "3998081",
            "problem": "In two-dimensional structured grid generation for computational fluid dynamics (CFD), a smooth, one-to-one mapping from a computational domain with coordinates $(\\xi,\\eta)$ to a physical plane with coordinates $(x,y)$ is defined by $x = x(\\xi,\\eta)$ and $y = y(\\xi,\\eta)$. Consider a scalar field $q$ defined on the computational domain as $q = q(\\xi,\\eta)$, and assume all functions are continuously differentiable and the mapping has a nonvanishing Jacobian determinant.\n\nTask 1 (derivation): Starting from the chain rule and the definitions of the Jacobian matrix and its determinant, derive explicit expressions for the physical-space differential operators $\\partial/\\partial x$ and $\\partial/\\partial y$ in terms of the computational-space operators $\\partial/\\partial \\xi$ and $\\partial/\\partial \\eta$. Your derivation must begin from first principles, namely the multivariable chain rule and the definition of the Jacobian and its inverse, and it must justify each step without invoking any pre-quoted transformation identities.\n\nTask 2 (application): Let the mapping and scalar field be specified by\n$$\nx(\\xi,\\eta) = \\xi + \\frac{1}{5}\\,\\xi \\eta + \\frac{1}{10}\\,\\sin(\\pi \\xi)\\,\\sin(\\pi \\eta), \\quad\ny(\\xi,\\eta) = \\eta + \\frac{3}{10}\\,\\xi^{2} + \\frac{1}{10}\\,\\cos(\\pi \\xi)\\,\\sin(\\pi \\eta),\n$$\n$$\nq(\\xi,\\eta) = \\exp(\\xi \\eta) + \\xi^{3} - \\eta^{2} + \\sin(2\\pi \\xi)\\,\\cos(\\pi \\eta).\n$$\nUsing your derived operators, compute the magnitude of the physical-space gradient $\\|\\nabla q\\|$ at the physical point corresponding to $(\\xi,\\eta) = \\left(\\frac{1}{2},\\frac{1}{4}\\right)$. Treat $q$ as dimensionless. All trigonometric functions use radians. Express your final result as an exact closed-form analytic expression in terms of $\\pi$ and $\\exp\\!\\left(\\frac{1}{8}\\right)$; do not perform any numerical rounding or approximation. Your final answer must be a single real-valued expression.",
            "solution": "The user wants me to solve a two-part problem. First, I need to derive the transformation for differential operators between a physical space and a computational space. Second, I need to apply these derived operators to a specific case and compute the magnitude of a gradient.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n-   **Mapping**: A one-to-one mapping from a computational domain $(\\xi, \\eta)$ to a physical plane $(x, y)$ is given by $x = x(\\xi, \\eta)$ and $y = y(\\xi, \\eta)$.\n-   **Functions**: All functions are continuously differentiable.\n-   **Jacobian**: The mapping has a nonvanishing Jacobian determinant.\n-   **Scalar Field**: A scalar field is defined as $q = q(\\xi, \\eta)$.\n-   **Task 1**: Derive explicit expressions for $\\partial/\\partial x$ and $\\partial/\\partial y$ in terms of $\\partial/\\partial \\xi$ and $\\partial/\\partial \\eta$, starting from the multivariable chain rule.\n-   **Task 2 Mapping**:\n    $x(\\xi,\\eta) = \\xi + \\frac{1}{5}\\,\\xi \\eta + \\frac{1}{10}\\,\\sin(\\pi \\xi)\\,\\sin(\\pi \\eta)$\n    $y(\\xi,\\eta) = \\eta + \\frac{3}{10}\\,\\xi^{2} + \\frac{1}{10}\\,\\cos(\\pi \\xi)\\,\\sin(\\pi \\eta)$\n-   **Task 2 Scalar Field**:\n    $q(\\xi,\\eta) = \\exp(\\xi \\eta) + \\xi^{3} - \\eta^{2} + \\sin(2\\pi \\xi)\\,\\cos(\\pi \\eta)$\n-   **Task 2 Objective**: Compute $\\|\\nabla q\\|$ at the physical point corresponding to $(\\xi,\\eta) = \\left(\\frac{1}{2},\\frac{1}{4}\\right)$.\n-   **Constraints**: Treat $q$ as dimensionless. All trigonometric functions use radians. The final result must be an exact closed-form analytic expression.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded (Critical)**: The problem is fundamentally a mathematical exercise in vector calculus and coordinate transformations. It is a standard topic in the field of computational fluid dynamics, specifically in structured grid generation. The concepts are based on well-established mathematical principles (chain rule, Jacobian matrices, inverse function theorem). The problem is scientifically sound.\n-   **Well-Posed**: The problem is well-posed. The existence of a continuously differentiable mapping with a nonvanishing Jacobian ensures that the inverse mapping exists locally and its derivatives are well-defined, guaranteeing a unique solution for the transformed operators and the gradient.\n-   **Objective (Critical)**: The problem is stated in precise mathematical language, free from ambiguity or subjective interpretation.\n\nThe problem does not violate any of the invalidity criteria. It is a well-defined problem in applied mathematics.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. I will proceed with a full solution.\n\n### Task 1: Derivation of Transformed Differential Operators\n\nThe goal is to express the physical-space partial derivative operators, $\\frac{\\partial}{\\partial x}$ and $\\frac{\\partial}{\\partial y}$, in terms of the computational-space operators, $\\frac{\\partial}{\\partial \\xi}$ and $\\frac{\\partial}{\\partial \\eta}$.\n\nConsider a scalar function $f$ that is defined in the physical space, $f=f(x,y)$. Through the coordinate transformation $x=x(\\xi,\\eta)$ and $y=y(\\xi,\\eta)$, $f$ can be viewed as a function of the computational coordinates, $f = f(x(\\xi,\\eta), y(\\xi,\\eta))$.\n\nThe derivatives of $f$ with respect to the computational coordinates can be found using the multivariable chain rule:\n$$ \\frac{\\partial f}{\\partial \\xi} = \\frac{\\partial f}{\\partial x} \\frac{\\partial x}{\\partial \\xi} + \\frac{\\partial f}{\\partial y} \\frac{\\partial y}{\\partial \\xi} $$\n$$ \\frac{\\partial f}{\\partial \\eta} = \\frac{\\partial f}{\\partial x} \\frac{\\partial x}{\\partial \\eta} + \\frac{\\partial f}{\\partial y} \\frac{\\partial y}{\\partial \\eta} $$\n\nThis is a system of two linear equations for the unknown physical-space derivatives, $\\frac{\\partial f}{\\partial x}$ and $\\frac{\\partial f}{\\partial y}$. We can write this system in matrix form. Let the gradient vectors be represented as column vectors:\n$$ \\nabla_c f = \\begin{pmatrix} \\partial f/\\partial \\xi \\\\ \\partial f/\\partial \\eta \\end{pmatrix}, \\quad \\nabla_p f = \\begin{pmatrix} \\partial f/\\partial x \\\\ \\partial f/\\partial y \\end{pmatrix} $$\nThe chain rule equations can be written as:\n$$ \\begin{pmatrix} \\frac{\\partial f}{\\partial \\xi} \\\\ \\frac{\\partial f}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial y} \\end{pmatrix} $$\nThe matrix in this equation is the transpose of the standard Jacobian matrix of the transformation from $(\\xi,\\eta)$ to $(x,y)$. The Jacobian matrix $J$ is defined as:\n$$ J = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} $$\nThus, the system is $\\nabla_c f = J^T \\nabla_p f$. To solve for the physical derivatives $\\nabla_p f$, we must invert the matrix $J^T$:\n$$ \\nabla_p f = (J^T)^{-1} \\nabla_c f $$\nThe inverse of a transpose is the transpose of the inverse, so $(J^T)^{-1}=(J^{-1})^T$. The inverse of the Jacobian matrix $J$ is:\n$$ J^{-1} = \\frac{1}{\\det(J)} \\begin{pmatrix} \\frac{\\partial y}{\\partial \\eta} & -\\frac{\\partial x}{\\partial \\eta} \\\\ -\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\xi} \\end{pmatrix} $$\nwhere the determinant of the Jacobian, $\\mathcal{J} = \\det(J)$, is:\n$$ \\mathcal{J} = \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta} \\frac{\\partial y}{\\partial \\xi} $$\nThe problem statement guarantees that $\\mathcal{J}$ is nonvanishing.\nNow, we find the transpose of $J^{-1}$:\n$$ (J^{-1})^T = \\frac{1}{\\mathcal{J}} \\begin{pmatrix} \\frac{\\partial y}{\\partial \\eta} & -\\frac{\\partial y}{\\partial \\xi} \\\\ -\\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial x}{\\partial \\xi} \\end{pmatrix} $$\nSubstituting this back into the expression for $\\nabla_p f$:\n$$ \\begin{pmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial y} \\end{pmatrix} = \\frac{1}{\\mathcal{J}} \\begin{pmatrix} \\frac{\\partial y}{\\partial \\eta} & -\\frac{\\partial y}{\\partial \\xi} \\\\ -\\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial x}{\\partial \\xi} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial f}{\\partial \\xi} \\\\ \\frac{\\partial f}{\\partial \\eta} \\end{pmatrix} $$\nExpanding this matrix equation gives the individual expressions:\n$$ \\frac{\\partial f}{\\partial x} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial y}{\\partial \\eta} \\frac{\\partial f}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi} \\frac{\\partial f}{\\partial \\eta} \\right) $$\n$$ \\frac{\\partial f}{\\partial y} = \\frac{1}{\\mathcal{J}} \\left( -\\frac{\\partial x}{\\partial \\eta} \\frac{\\partial f}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial f}{\\partial \\eta} \\right) $$\nSince these relations hold for any arbitrary differentiable function $f$, they define the transformation for the differential operators themselves:\n$$ \\frac{\\partial}{\\partial x} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial y}{\\partial \\eta} \\frac{\\partial}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi} \\frac{\\partial}{\\partial \\eta} \\right) $$\n$$ \\frac{\\partial}{\\partial y} = \\frac{1}{\\mathcal{J}} \\left( -\\frac{\\partial x}{\\partial \\eta} \\frac{\\partial}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial}{\\partial \\eta} \\right) $$\nThis completes the derivation for Task 1.\n\n### Task 2: Application\n\nWe are asked to compute the magnitude of the physical-space gradient, $\\|\\nabla q\\| = \\sqrt{(\\partial q / \\partial x)^2 + (\\partial q / \\partial y)^2}$, at the point $(\\xi, \\eta) = (1/2, 1/4)$.\n\nWe first need to compute the partial derivatives of the mapping functions $x(\\xi, \\eta)$ and $y(\\xi, \\eta)$, which are known as the metric terms. Let $x_\\xi = \\partial x/\\partial \\xi$, $x_\\eta = \\partial x/\\partial \\eta$, etc.\n$x(\\xi,\\eta) = \\xi + \\frac{1}{5}\\xi \\eta + \\frac{1}{10}\\sin(\\pi \\xi)\\sin(\\pi \\eta)$\n$y(\\xi,\\eta) = \\eta + \\frac{3}{10}\\xi^{2} + \\frac{1}{10}\\cos(\\pi \\xi)\\sin(\\pi \\eta)$\n\nThe partial derivatives are:\n$x_\\xi = 1 + \\frac{1}{5}\\eta + \\frac{\\pi}{10}\\cos(\\pi \\xi)\\sin(\\pi \\eta)$\n$x_\\eta = \\frac{1}{5}\\xi + \\frac{\\pi}{10}\\sin(\\pi \\xi)\\cos(\\pi \\eta)$\n$y_\\xi = \\frac{3}{5}\\xi - \\frac{\\pi}{10}\\sin(\\pi \\xi)\\sin(\\pi \\eta)$\n$y_\\eta = 1 + \\frac{\\pi}{10}\\cos(\\pi \\xi)\\cos(\\pi \\eta)$\n\nAt the point $(\\xi, \\eta) = (1/2, 1/4)$:\n$\\pi\\xi = \\pi/2$ and $\\pi\\eta = \\pi/4$.\n$\\sin(\\pi/2) = 1$, $\\cos(\\pi/2) = 0$, $\\sin(\\pi/4) = \\sqrt{2}/2$, $\\cos(\\pi/4) = \\sqrt{2}/2$.\n\nEvaluating the metric terms:\n$x_\\xi = 1 + \\frac{1}{5}(\\frac{1}{4}) + \\frac{\\pi}{10}(0)(\\frac{\\sqrt{2}}{2}) = 1 + \\frac{1}{20} = \\frac{21}{20}$\n$x_\\eta = \\frac{1}{5}(\\frac{1}{2}) + \\frac{\\pi}{10}(1)(\\frac{\\sqrt{2}}{2}) = \\frac{1}{10} + \\frac{\\pi\\sqrt{2}}{20} = \\frac{2 + \\pi\\sqrt{2}}{20}$\n$y_\\xi = \\frac{3}{5}(\\frac{1}{2}) - \\frac{\\pi}{10}(1)(\\frac{\\sqrt{2}}{2}) = \\frac{3}{10} - \\frac{\\pi\\sqrt{2}}{20} = \\frac{6 - \\pi\\sqrt{2}}{20}$\n$y_\\eta = 1 + \\frac{\\pi}{10}(0)(\\frac{\\sqrt{2}}{2}) = 1$\n\nNext, we compute the Jacobian determinant $\\mathcal{J} = x_\\xi y_\\eta - x_\\eta y_\\xi$:\n$\\mathcal{J} = \\left(\\frac{21}{20}\\right)(1) - \\left(\\frac{2 + \\pi\\sqrt{2}}{20}\\right)\\left(\\frac{6 - \\pi\\sqrt{2}}{20}\\right) = \\frac{21}{20} - \\frac{12 - 2\\pi\\sqrt{2} + 6\\pi\\sqrt{2} - 2\\pi^2}{400}$\n$\\mathcal{J} = \\frac{420}{400} - \\frac{12 + 4\\pi\\sqrt{2} - 2\\pi^2}{400} = \\frac{408 - 4\\pi\\sqrt{2} + 2\\pi^2}{400} = \\frac{204 - 2\\pi\\sqrt{2} + \\pi^2}{200}$\n\nNow, we compute the partial derivatives of the scalar field $q(\\xi, \\eta)$:\n$q(\\xi,\\eta) = \\exp(\\xi \\eta) + \\xi^{3} - \\eta^{2} + \\sin(2\\pi \\xi)\\cos(\\pi \\eta)$\n$q_\\xi = \\eta \\exp(\\xi \\eta) + 3\\xi^2 + 2\\pi \\cos(2\\pi \\xi)\\cos(\\pi \\eta)$\n$q_\\eta = \\xi \\exp(\\xi \\eta) - 2\\eta - \\pi \\sin(2\\pi \\xi)\\sin(\\pi \\eta)$\n\nAt $(\\xi, \\eta) = (1/2, 1/4)$:\n$\\xi\\eta = 1/8$, $2\\pi\\xi = \\pi$.\n$\\cos(\\pi) = -1$, $\\sin(\\pi) = 0$.\n$q_\\xi = (\\frac{1}{4})\\exp(\\frac{1}{8}) + 3(\\frac{1}{2})^2 + 2\\pi\\cos(\\pi)\\cos(\\frac{\\pi}{4}) = \\frac{1}{4}\\exp(\\frac{1}{8}) + \\frac{3}{4} + 2\\pi(-1)(\\frac{\\sqrt{2}}{2}) = \\frac{1}{4}\\exp(\\frac{1}{8}) + \\frac{3}{4} - \\pi\\sqrt{2}$\n$q_\\eta = (\\frac{1}{2})\\exp(\\frac{1}{8}) - 2(\\frac{1}{4}) - \\pi\\sin(\\pi)\\sin(\\frac{\\pi}{4}) = \\frac{1}{2}\\exp(\\frac{1}{8}) - \\frac{1}{2} - 0 = \\frac{1}{2}\\exp(\\frac{1}{8}) - \\frac{1}{2}$\n\nNow we compute the physical gradients $q_x = \\partial q/\\partial x$ and $q_y = \\partial q/\\partial y$:\n$q_x = \\frac{1}{\\mathcal{J}}(y_\\eta q_\\xi - y_\\xi q_\\eta)$\n$q_x = \\frac{1}{\\mathcal{J}} \\left[ (1)\\left(\\frac{1}{4}\\exp(\\frac{1}{8}) + \\frac{3}{4} - \\pi\\sqrt{2}\\right) - \\left(\\frac{6 - \\pi\\sqrt{2}}{20}\\right)\\left(\\frac{1}{2}\\exp(\\frac{1}{8}) - \\frac{1}{2}\\right) \\right]$\n$q_x = \\frac{1}{40\\mathcal{J}} \\left[ 10\\left(\\exp(\\frac{1}{8}) + 3 - 4\\pi\\sqrt{2}\\right) - (6 - \\pi\\sqrt{2})\\left(\\exp(\\frac{1}{8}) - 1\\right) \\right]$\n$q_x = \\frac{1}{40\\mathcal{J}} \\left[ (10 - 6 + \\pi\\sqrt{2})\\exp(\\frac{1}{8}) + (30 + 6 - 40\\pi\\sqrt{2} - (-\\pi\\sqrt{2})) \\right]$\n$q_x = \\frac{1}{40\\mathcal{J}} \\left[ (4 + \\pi\\sqrt{2})\\exp(\\frac{1}{8}) + 36 - 41\\pi\\sqrt{2} \\right]$\n\n$q_y = \\frac{1}{\\mathcal{J}}(-x_\\eta q_\\xi + x_\\xi q_\\eta)$\n$q_y = \\frac{1}{\\mathcal{J}} \\left[ -\\left(\\frac{2+\\pi\\sqrt{2}}{20}\\right)\\left(\\frac{1}{4}\\exp(\\frac{1}{8}) + \\frac{3}{4} - \\pi\\sqrt{2}\\right) + \\left(\\frac{21}{20}\\right)\\left(\\frac{1}{2}\\exp(\\frac{1}{8}) - \\frac{1}{2}\\right) \\right]$\n$q_y = \\frac{1}{80\\mathcal{J}} \\left[ -(2+\\pi\\sqrt{2})(\\exp(\\frac{1}{8}) + 3 - 4\\pi\\sqrt{2}) + 42(\\exp(\\frac{1}{8})-1) \\right]$\n$q_y = \\frac{1}{80\\mathcal{J}} \\left[ (-2-\\pi\\sqrt{2}+42)\\exp(\\frac{1}{8}) + (-(2+\\pi\\sqrt{2})(3-4\\pi\\sqrt{2}) - 42) \\right]$\nThe constant term is $-(6-8\\pi\\sqrt{2}+3\\pi\\sqrt{2}-8\\pi^2)-42 = -6+5\\pi\\sqrt{2}+8\\pi^2-42 = -48+5\\pi\\sqrt{2}+8\\pi^2$.\n$q_y = \\frac{1}{80\\mathcal{J}} \\left[ (40 - \\pi\\sqrt{2})\\exp(\\frac{1}{8}) - 48 + 5\\pi\\sqrt{2} + 8\\pi^2 \\right]$\n\nFinally, we compute $\\|\\nabla q\\| = \\sqrt{q_x^2 + q_y^2}$. Let $k_x = (4 + \\pi\\sqrt{2})\\exp(\\frac{1}{8}) + 36 - 41\\pi\\sqrt{2}$ and $k_y = (40 - \\pi\\sqrt{2})\\exp(\\frac{1}{8}) - 48 + 5\\pi\\sqrt{2} + 8\\pi^2$.\nThen $q_x = \\frac{k_x}{40\\mathcal{J}}$ and $q_y = \\frac{k_y}{80\\mathcal{J}}$.\n$\\|\\nabla q\\|^2 = q_x^2 + q_y^2 = \\left(\\frac{k_x}{40\\mathcal{J}}\\right)^2 + \\left(\\frac{k_y}{80\\mathcal{J}}\\right)^2 = \\frac{1}{(80\\mathcal{J})^2} (4k_x^2 + k_y^2)$.\n$\\|\\nabla q\\| = \\frac{\\sqrt{4k_x^2 + k_y^2}}{80|\\mathcal{J}|}$.\nThe Jacobian determinant $\\mathcal{J} \\approx (204 - 2(3.14)(1.41) + 9.86)/200 \\approx (204-8.85+9.86)/200 > 0$, so $|\\mathcal{J}|=\\mathcal{J}$.\n$\\|\\nabla q\\| = \\frac{\\sqrt{4k_x^2 + k_y^2}}{80 \\left( \\frac{204 - 2\\pi\\sqrt{2} + \\pi^2}{200} \\right)} = \\frac{200 \\sqrt{4k_x^2 + k_y^2}}{80 (204 - 2\\pi\\sqrt{2} + \\pi^2)} = \\frac{5 \\sqrt{4k_x^2 + k_y^2}}{2 (204 - 2\\pi\\sqrt{2} + \\pi^2)}$.\nSubstituting the expressions for $k_x$ and $k_y$ gives the final answer.",
            "answer": "$$\n\\boxed{\\frac{5\\sqrt{4\\left((4+\\pi\\sqrt{2})\\exp(\\frac{1}{8}) + 36 - 41\\pi\\sqrt{2}\\right)^{2} + \\left((40-\\pi\\sqrt{2})\\exp(\\frac{1}{8}) - 48 + 5\\pi\\sqrt{2} + 8\\pi^{2}\\right)^{2}}}{2(204 - 2\\pi\\sqrt{2} + \\pi^{2})}}\n$$"
        },
        {
            "introduction": "Transfinite Interpolation (TFI) is a powerful algebraic method for rapidly generating grids that conform precisely to complex boundaries. However, this flexibility can lead to issues like grid folding or overlapping, rendering the grid useless. This practice delves into the local properties of the TFI mapping at the grid corners, asking you to derive the condition that guarantees a valid, non-overlapping grid by analyzing the Jacobian determinant. This exercise highlights the critical link between the parameterization of boundary curves and the quality of the resulting interior grid.",
            "id": "3998085",
            "problem": "Consider a quadrilateral computational patch defined by a parameter domain $(u,v) \\in [0,1] \\times [0,1]$ and mapped into the physical plane $\\mathbb{R}^{2}$ using a bilinearly blended Transfinite Interpolation (TFI) constructed from four differentiable boundary curves: the bottom boundary $\\boldsymbol{b}(u) = \\big(b_{x}(u), b_{y}(u)\\big)$ for $v=0$, the top boundary $\\boldsymbol{t}(u) = \\big(t_{x}(u), t_{y}(u)\\big)$ for $v=1$, the left boundary $\\boldsymbol{\\ell}(v) = \\big(\\ell_{x}(v), \\ell_{y}(v)\\big)$ for $u=0$, and the right boundary $\\boldsymbol{r}(v) = \\big(r_{x}(v), r_{y}(v)\\big)$ for $u=1$. Assume each boundary curve is at least twice continuously differentiable on its parameter interval and that the corner points are positionally compatible, namely\n$$\n\\boldsymbol{x}_{00} = \\boldsymbol{b}(0) = \\boldsymbol{\\ell}(0), \\quad \n\\boldsymbol{x}_{10} = \\boldsymbol{b}(1) = \\boldsymbol{r}(0), \\quad\n\\boldsymbol{x}_{01} = \\boldsymbol{t}(0) = \\boldsymbol{\\ell}(1), \\quad\n\\boldsymbol{x}_{11} = \\boldsymbol{t}(1) = \\boldsymbol{r}(1).\n$$\nThe TFI mapping $\\boldsymbol{x}(u,v)$ is defined by blending the boundary curves and corrective corner terms to recover the four boundary curves and their shared corners.\n\nStarting from the definition of the Jacobian matrix of a planar mapping and the inverse function theorem, derive from first principles the local non-overlap condition at the corner $(u,v)=(0,0)$ in terms of the boundary curve parameterizations. In particular:\n\n- Expand $\\boldsymbol{x}(u,v)$ to first order in a neighborhood of $(0,0)$ and identify the two tangent directions that span the local image of the parameter increments $(\\mathrm{d}u,\\mathrm{d}v)$.\n- Using the area Jacobian determinant $J(u,v) = \\det\\left(\\frac{\\partial \\boldsymbol{x}}{\\partial (u,v)}\\right)$, express $J(0,0)$ in terms of the components of $\\boldsymbol{b}'(0)$ and $\\boldsymbol{\\ell}'(0)$, where the prime denotes differentiation with respect to the boundary parameter.\n- Explain how the sign and non-vanishing of $J(0,0)$ impose necessary constraints on the choices of boundary curve parameterizations at the corner to avoid overlapping (folding) in the TFI patch, and generalize the orientation constraint to the other three corners.\n\nYour final answer must be the single closed-form analytic expression for $J(0,0)$ in terms of $b_{x}'(0)$, $b_{y}'(0)$, $\\ell_{x}'(0)$, and $\\ell_{y}'(0)$. Do not provide a numerical approximation. No rounding is required. Units are not applicable because the expression is dimensionless with respect to area scaling in the mapping.",
            "solution": "The problem as stated is valid. It is scientifically grounded in the established theory of Transfinite Interpolation (TFI) used in structured grid generation, a subfield of computational fluid dynamics. The problem is well-posed, objective, and contains sufficient information for a rigorous mathematical derivation.\n\nThe core of the problem is to analyze the local properties of a TFI mapping at a corner of the computational domain. The key diagnostic tool for this is the Jacobian determinant of the mapping, which measures the local change in area and orientation from the parameter space to the physical space. A non-singular, orientation-preserving mapping is required for a valid, non-overlapping grid.\n\nWe begin by stating the formula for the bilinearly blended Transfinite Interpolation map $\\boldsymbol{x}(u,v)$ for a quadrilateral patch defined on the unit square $(u,v) \\in [0,1] \\times [0,1]$. The map is constructed as the Boolean sum of two linear projectors, one in the $u$-direction and one in the $v$-direction. It is given by:\n$$\n\\boldsymbol{x}(u,v) = (1-u)\\boldsymbol{\\ell}(v) + u\\boldsymbol{r}(v) + (1-v)\\boldsymbol{b}(u) + v\\boldsymbol{t}(u) - \\boldsymbol{x}_{c}(u,v)\n$$\nwhere $\\boldsymbol{b}(u)$, $\\boldsymbol{t}(u)$, $\\boldsymbol{\\ell}(v)$, and $\\boldsymbol{r}(v)$ are the four boundary curves, and $\\boldsymbol{x}_{c}(u,v)$ is the bilinear corner-blending term:\n$$\n\\boldsymbol{x}_{c}(u,v) = (1-u)(1-v)\\boldsymbol{x}_{00} + u(1-v)\\boldsymbol{x}_{10} + (1-u)v\\boldsymbol{x}_{01} + uv\\boldsymbol{x}_{11}\n$$\nThe terms $\\boldsymbol{x}_{00}$, $\\boldsymbol{x}_{10}$, $\\boldsymbol{x}_{01}$, and $\\boldsymbol{x}_{11}$ are the corner points, which satisfy the given compatibility conditions: $\\boldsymbol{x}_{00} = \\boldsymbol{b}(0) = \\boldsymbol{\\ell}(0)$, $\\boldsymbol{x}_{10} = \\boldsymbol{b}(1) = \\boldsymbol{r}(0)$, $\\boldsymbol{x}_{01} = \\boldsymbol{t}(0) = \\boldsymbol{\\ell}(1)$, and $\\boldsymbol{x}_{11} = \\boldsymbol{t}(1) = \\boldsymbol{r}(1)$.\n\nTo find the local behavior of the mapping near the corner $(u,v) = (0,0)$, we first compute the tangent vectors $\\frac{\\partial \\boldsymbol{x}}{\\partial u}$ and $\\frac{\\partial \\boldsymbol{x}}{\\partial v}$. Differentiating the expression for $\\boldsymbol{x}(u,v)$ with respect to $u$ yields:\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial u} = -\\boldsymbol{\\ell}(v) + \\boldsymbol{r}(v) + (1-v)\\boldsymbol{b}'(u) + v\\boldsymbol{t}'(u) - \\frac{\\partial \\boldsymbol{x}_{c}}{\\partial u}\n$$\nwhere the prime denotes differentiation with respect to the curve's parameter (e.g., $\\boldsymbol{b}'(u) = \\frac{\\mathrm{d}\\boldsymbol{b}}{\\mathrm{d}u}$). The derivative of the corner term is:\n$$\n\\frac{\\partial \\boldsymbol{x}_{c}}{\\partial u} = -(1-v)\\boldsymbol{x}_{00} + (1-v)\\boldsymbol{x}_{10} - v\\boldsymbol{x}_{01} + v\\boldsymbolx_{11}\n$$\nSubstituting this into the expression for $\\frac{\\partial \\boldsymbol{x}}{\\partial u}$ gives:\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial u} = -\\boldsymbol{\\ell}(v) + \\boldsymbol{r}(v) + (1-v)\\boldsymbol{b}'(u) + v\\boldsymbol{t}'(u) + (1-v)\\boldsymbol{x}_{00} - (1-v)\\boldsymbol{x}_{10} + v\\boldsymbol{x}_{01} - v\\boldsymbol{x}_{11}\n$$\nNow, we evaluate this partial derivative at the corner $(u,v)=(0,0)$:\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial u}\\Big|_{(0,0)} = -\\boldsymbol{\\ell}(0) + \\boldsymbol{r}(0) + \\boldsymbol{b}'(0) + \\boldsymbol{x}_{00} - \\boldsymbol{x}_{10}\n$$\nUsing the corner compatibility conditions $\\boldsymbol{\\ell}(0) = \\boldsymbol{x}_{00}$ and $\\boldsymbol{r}(0) = \\boldsymbol{x}_{10}$, the terms cancel out:\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial u}\\Big|_{(0,0)} = -\\boldsymbol{x}_{00} + \\boldsymbol{x}_{10} + \\boldsymbol{b}'(0) + \\boldsymbol{x}_{00} - \\boldsymbol{x}_{10} = \\boldsymbol{b}'(0)\n$$\nSimilarly, we differentiate $\\boldsymbol{x}(u,v)$ with respect to $v$:\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial v} = (1-u)\\boldsymbol{\\ell}'(v) + u\\boldsymbol{r}'(v) - \\boldsymbol{b}(u) + \\boldsymbol{t}(u) - \\frac{\\partial \\boldsymbol{x}_{c}}{\\partial v}\n$$\nwhere\n$$\n\\frac{\\partial \\boldsymbol{x}_{c}}{\\partial v} = -(1-u)\\boldsymbol{x}_{00} - u\\boldsymbol{x}_{10} + (1-u)\\boldsymbol{x}_{01} + u\\boldsymbol{x}_{11}\n$$\nThus,\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial v} = (1-u)\\boldsymbol{\\ell}'(v) + u\\boldsymbol{r}'(v) - \\boldsymbol{b}(u) + \\boldsymbol{t}(u) + (1-u)\\boldsymbol{x}_{00} + u\\boldsymbol{x}_{10} - (1-u)\\boldsymbol{x}_{01} - u\\boldsymbol{x}_{11}\n$$\nEvaluating at $(u,v)=(0,0)$:\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial v}\\Big|_{(0,0)} = \\boldsymbol{\\ell}'(0) - \\boldsymbol{b}(0) + \\boldsymbol{t}(0) + \\boldsymbol{x}_{00} - \\boldsymbol{x}_{01}\n$$\nUsing the compatibility conditions $\\boldsymbol{b}(0) = \\boldsymbol{x}_{00}$ and $\\boldsymbol{t}(0) = \\boldsymbol{x}_{01}$, the expression simplifies:\n$$\n\\frac{\\partial \\boldsymbol{x}}{\\partial v}\\Big|_{(0,0)} = \\boldsymbol{\\ell}'(0) - \\boldsymbol{x}_{00} + \\boldsymbol{x}_{01} + \\boldsymbol{x}_{00} - \\boldsymbol{x}_{01} = \\boldsymbol{\\ell}'(0)\n$$\nThe first-order Taylor expansion of $\\boldsymbol{x}(u,v)$ around $(0,0)$ is:\n$$\n\\boldsymbol{x}(u,v) \\approx \\boldsymbol{x}(0,0) + u \\frac{\\partial \\boldsymbol{x}}{\\partial u}\\Big|_{(0,0)} + v \\frac{\\partial \\boldsymbol{x}}{\\partial v}\\Big|_{(0,0)}\n$$\n$$\n\\boldsymbol{x}(u,v) \\approx \\boldsymbol{x}_{00} + u \\boldsymbol{b}'(0) + v \\boldsymbol{\\ell}'(0)\n$$\nThe two tangent directions that span the local image of an infinitesimal parameter rectangle $(\\mathrm{d}u, \\mathrm{d}v)$ at $(0,0)$ are precisely the tangent vectors of the intersecting boundary curves: $\\boldsymbol{b}'(0)$ and $\\boldsymbol{\\ell}'(0)$.\n\nThe Jacobian matrix of the transformation at $(u,v)$ is $J_M(u,v) = \\left[ \\frac{\\partial \\boldsymbol{x}}{\\partial u} \\quad \\frac{\\partial \\boldsymbol{x}}{\\partial v} \\right]$. At the corner $(0,0)$, this becomes:\n$$\nJ_M(0,0) = \\left[ \\boldsymbol{b}'(0) \\quad \\boldsymbol{\\ell}'(0) \\right] = \\begin{pmatrix} b_{x}'(0) & \\ell_{x}'(0) \\\\ b_{y}'(0) & \\ell_{y}'(0) \\end{pmatrix}\n$$\nThe Jacobian determinant $J(u,v) = \\det(J_M(u,v))$ at $(0,0)$ is therefore:\n$$\nJ(0,0) = \\det(J_M(0,0)) = \\begin{vmatrix} b_{x}'(0) & \\ell_{x}'(0) \\\\ b_{y}'(0) & \\ell_{y}'(0) \\end{vmatrix} = b_{x}'(0)\\ell_{y}'(0) - b_{y}'(0)\\ell_{x}'(0)\n$$\nThis expression represents the signed area of the parallelogram spanned by the two tangent vectors $\\boldsymbol{b}'(0)$ and $\\boldsymbol{\\ell}'(0)$.\n\nThe sign and non-vanishing of $J(0,0)$ are critical. According to the inverse function theorem, the mapping $\\boldsymbol{x}(u,v)$ is locally invertible at $(0,0)$ if and only if $J(0,0) \\neq 0$.\n- If $J(0,0) = 0$, the tangent vectors $\\boldsymbol{b}'(0)$ and $\\boldsymbol{\\ell}'(0)$ are collinear. This means the mapping collapses the corner of the parametric square into a line or a point in the physical plane, creating a singularity where grid cells have zero area. This is a degenerate grid.\n- If $J(0,0) \\neq 0$, the mapping is locally one-to-one. The sign of $J(0,0)$ determines the orientation. For a valid, non-overlapping grid, it is necessary that the Jacobian determinant maintains the same sign throughout the domain. A common convention is to require $J(u,v) > 0$ for all $(u,v) \\in [0,1] \\times [0,1]$.\n- Therefore, the condition $J(0,0) > 0$, or $b_{x}'(0)\\ell_{y}'(0) - b_{y}'(0)\\ell_{x}'(0) > 0$, imposes a geometric constraint on the boundary curves at the corner. It requires that the angle from $\\boldsymbol{b}'(0)$ to $\\boldsymbol{\\ell}'(0)$ be positive (i.e., counter-clockwise and less than $\\pi$), ensuring that the grid lines emanate from the corner into the interior of the physical patch without crossing.\n\nThis orientation constraint must hold at all four corners. By performing analogous derivations, we find the Jacobian determinants at the other three corners:\n- At $(u,v)=(1,0)$: $J(1,0) = \\det(\\boldsymbol{b}'(1), \\boldsymbol{r}'(0)) = b_{x}'(1)r_{y}'(0) - b_{y}'(1)r_{x}'(0) > 0$.\n- At $(u,v)=(0,1)$: $J(0,1) = \\det(\\boldsymbol{t}'(0), \\boldsymbol{\\ell}'(1)) = t_{x}'(0)\\ell_{y}'(1) - t_{y}'(0)\\ell_{x}'(1) > 0$.\n- At $(u,v)=(1,1)$: $J(1,1) = \\det(\\boldsymbol{t}'(1), \\boldsymbol{r}'(1)) = t_{x}'(1)r_{y}'(1) - t_{y}'(1)r_{x}'(1) > 0$.\nThese four conditions are necessary (but not sufficient) for the entire TFI patch to be non-overlapping.\n\nThe final answer requested is the single expression for $J(0,0)$.",
            "answer": "$$\n\\boxed{b_{x}'(0) \\ell_{y}'(0) - b_{y}'(0) \\ell_{x}'(0)}\n$$"
        },
        {
            "introduction": "A high-quality grid is only useful if the numerical scheme for the flow equations respects its geometry. A fundamental test of this is \"free-stream preservation\"â€”the ability of a solver to maintain a uniform flow without generating artificial errors. This exercise demonstrates how a seemingly plausible but inconsistent discretization scheme violates this principle, and then shows how a formulation that satisfies the discrete Geometric Conservation Law (GCL) corrects the issue. Mastering this concept is crucial for developing accurate and robust CFD solvers on curvilinear grids.",
            "id": "3998015",
            "problem": "Consider a two-dimensional curvilinear mapping from computational coordinates $(\\xi,\\eta)$ to physical coordinates $(x,y)$ used in Computational Fluid Dynamics (CFD) for a structured grid. The mapping is defined on a uniform computational grid with indices $i,j \\in \\{0,1,2,3,4\\}$ and spacing $h = \\frac{\\pi}{2}$, so that $\\xi_i = i h$ and $\\eta_j = j h$. The physical mapping is\n$$\nx(\\xi,\\eta) = \\xi + \\alpha \\sin(\\xi)\\sin(\\eta), \\quad y(\\xi,\\eta) = \\eta + \\beta \\cos(\\xi)\\sin(\\eta),\n$$\nwith $\\alpha = 0.15$ and $\\beta = 0.25$. Consider a uniform free-stream flow with constant density $\\rho$ and constant velocity components $u = U$ and $v = 0$. Focus on the discrete continuity residual at the interior cell $(i,j) = (1,1)$.\n\nPart A (demonstrate violation): Define a naive discrete scheme in which the contravariant flux components are formed at cell centers using one-sided metric approximations\n- forward difference in $\\eta$ for $y_{\\eta}$, i.e., $y_{\\eta}^{F}(i,j) = \\frac{y_{i,j+1} - y_{i,j}}{h}$,\n- backward difference in $\\xi$ for $y_{\\xi}$, i.e., $y_{\\xi}^{B}(i,j) = \\frac{y_{i,j} - y_{i-1,j}}{h}$,\nand take the discrete divergence with second-order central differences,\n$$\n\\left.\\frac{\\partial}{\\partial \\xi}(\\rho U y_{\\eta})\\right|_{(i,j)} \\approx \\rho U \\frac{y_{\\eta}^{F}(i+1,j) - y_{\\eta}^{F}(i-1,j)}{2h}, \\quad\n\\left.\\frac{\\partial}{\\partial \\eta}(-\\rho U y_{\\xi})\\right|_{(i,j)} \\approx -\\rho U \\frac{y_{\\xi}^{B}(i,j+1) - y_{\\xi}^{B}(i,j-1)}{2h}.\n$$\nUsing these, compute the dimensionless normalized discrete continuity residual\n$$\nR^{\\ast}_{\\text{naive}}(1,1) \\equiv \\frac{1}{\\rho U}\\left[\\frac{\\partial}{\\partial \\xi}(\\rho U y_{\\eta}) + \\frac{\\partial}{\\partial \\eta}(-\\rho U y_{\\xi})\\right]_{(1,1)}.\n$$\nExpress $R^{\\ast}_{\\text{naive}}(1,1)$ as a simplified analytic expression in terms of $\\beta$ and known constants and evaluate it numerically.\n\nPart B (correct using covariant/contravariant forms): Now, enforce free-stream preservation using the contravariant flux formulation with consistent central differences so that the discrete metric identities are satisfied. Specifically, define both $y_{\\eta}$ and $y_{\\xi}$ at cell centers with the same central operator,\n$$\ny_{\\eta}^{C}(i,j) = \\frac{y_{i,j+1} - y_{i,j-1}}{2h}, \\quad y_{\\xi}^{C}(i,j) = \\frac{y_{i+1,j} - y_{i-1,j}}{2h},\n$$\nand evaluate the discrete divergence again with central differences,\n$$\nR^{\\ast}_{\\text{corr}}(1,1) \\equiv \\frac{1}{\\rho U}\\left[\\frac{y_{\\eta}^{C}(i+1,j) - y_{\\eta}^{C}(i-1,j)}{2h} - \\frac{y_{\\xi}^{C}(i,j+1) - y_{\\xi}^{C}(i,j-1)}{2h}\\right]_{(1,1)}.\n$$\nReport the corrected normalized residual $R^{\\ast}_{\\text{corr}}(1,1)$ as your final answer. The corrected residual is dimensionless, so no physical units are required. No rounding instruction is needed for the final value.",
            "solution": "The problem asks for the calculation of a discrete continuity residual for a uniform free-stream flow, $(u,v)=(U,0)$, on a curvilinear grid. This exercise is designed to test the free-stream preservation property of two different finite difference schemes. A numerical scheme is said to preserve the free-stream if it can exactly represent a uniform flow field, meaning the discrete governing equations are satisfied to machine precision. For the steady, incompressible continuity equation, this requires the discrete residual to be zero.\n\nThe continuity equation in conservative form for a generic flow is $\\frac{\\partial (\\rho u)}{\\partial x} + \\frac{\\partial (\\rho v)}{\\partial y} = 0$. For a uniform flow with constant density $\\rho$ and velocity $(u, v) = (U, 0)$, this is trivially satisfied. When transformed to computational coordinates $(\\xi, \\eta)$, the continuity equation becomes\n$$\n\\frac{\\partial}{\\partial\\xi}(\\rho U y_{\\eta}) + \\frac{\\partial}{\\partial\\eta}(-\\rho U y_{\\xi}) = 0,\n$$\nwhere it is assumed the Jacobian of the transformation $J = x_\\xi y_\\eta - x_\\eta y_\\xi$ is non-zero. Since $\\rho$ and $U$ are constants, this is equivalent to the geometric conservation law (GCL), which in its continuous form is the identity\n$$\n\\frac{\\partial y_{\\eta}}{\\partial\\xi} - \\frac{\\partial y_{\\xi}}{\\partial\\eta} \\equiv y_{\\eta\\xi} - y_{\\xi\\eta} = 0\n$$\nfor any sufficiently smooth mapping $y(\\xi, \\eta)$. The problem asks to compute the normalized discrete residual, which is the discrete analogue of this expression, at the grid cell centered at $(i,j)=(1,1)$.\nThe normalized residual is defined as $R^{\\ast} \\equiv \\frac{1}{\\rho U} \\left[ \\mathcal{D}_{\\xi}(\\rho U y_{\\eta}) + \\mathcal{D}_{\\eta}(-\\rho U y_{\\xi}) \\right] = \\mathcal{D}_{\\xi}(y_{\\eta}) - \\mathcal{D}_{\\eta}(y_{\\xi})$, where $\\mathcal{D}$ represents a discrete difference operator.\n\nThe computational grid is defined by $\\xi_i = i h$ and $\\eta_j = j h$ with $h = \\frac{\\pi}{2}$. The physical coordinate $y$ at a grid point $(i,j)$ is given by $y_{i,j} = y(\\xi_i, \\eta_j) = \\eta_j + \\beta \\cos(\\xi_i)\\sin(\\eta_j)$ with $\\beta = 0.25$.\n\nPart A: Naive Discrete Scheme\n\nThe normalized residual is calculated using inconsistent differencing for the metric terms and central differencing for the divergence:\n$$\nR^{\\ast}_{\\text{naive}}(1,1) = \\frac{y_{\\eta}^{F}(2,1) - y_{\\eta}^{F}(0,1)}{2h} - \\frac{y_{\\xi}^{B}(1,2) - y_{\\xi}^{B}(1,0)}{2h}\n$$\nwhere $y_{\\eta}^{F}(i,j) = \\frac{y_{i,j+1} - y_{i,j}}{h}$ and $y_{\\xi}^{B}(i,j) = \\frac{y_{i,j} - y_{i-1,j}}{h}$.\nSubstituting the definitions of the discrete metric derivatives into the residual expression gives:\n$$\nR^{\\ast}_{\\text{naive}}(1,1) = \\frac{1}{2h} \\left( \\frac{y_{2,2} - y_{2,1}}{h} - \\frac{y_{0,2} - y_{0,1}}{h} \\right) - \\frac{1}{2h} \\left( \\frac{y_{1,2} - y_{0,2}}{h} - \\frac{y_{1,0} - y_{0,0}}{h} \\right)\n$$\n$$\nR^{\\ast}_{\\text{naive}}(1,1) = \\frac{1}{2h^2} \\left[ (y_{2,2} - y_{2,1}) - (y_{0,2} - y_{0,1}) - (y_{1,2} - y_{0,2}) + (y_{1,0} - y_{0,0}) \\right]\n$$\n$$\nR^{\\ast}_{\\text{naive}}(1,1) = \\frac{1}{2h^2} \\left[ y_{2,2} - y_{2,1} - y_{1,2} + y_{0,1} + y_{1,0} - y_{0,0} \\right]\n$$\nWe need to evaluate $y_{i,j}$ at the grid points in the stencil. We have $h = \\frac{\\pi}{2}$, so $\\xi_i = i\\frac{\\pi}{2}$ and $\\eta_j = j\\frac{\\pi}{2}$.\nThe specific values are:\n$y_{0,0} = y(0,0) = 0 + \\beta \\cos(0)\\sin(0) = 0$.\n$y_{1,0} = y(\\frac{\\pi}{2},0) = 0 + \\beta \\cos(\\frac{\\pi}{2})\\sin(0) = 0$.\n$y_{0,1} = y(0, \\frac{\\pi}{2}) = \\frac{\\pi}{2} + \\beta \\cos(0)\\sin(\\frac{\\pi}{2}) = \\frac{\\pi}{2} + \\beta$.\n$y_{2,1} = y(\\pi, \\frac{\\pi}{2}) = \\frac{\\pi}{2} + \\beta \\cos(\\pi)\\sin(\\frac{\\pi}{2}) = \\frac{\\pi}{2} - \\beta$.\n$y_{1,2} = y(\\frac{\\pi}{2}, \\pi) = \\pi + \\beta \\cos(\\frac{\\pi}{2})\\sin(\\pi) = \\pi$.\n$y_{2,2} = y(\\pi, \\pi) = \\pi + \\beta \\cos(\\pi)\\sin(\\pi) = \\pi$.\n\nSubstituting these into the expression for $R^{\\ast}_{\\text{naive}}(1,1)$:\n$$\nR^{\\ast}_{\\text{naive}}(1,1) = \\frac{1}{2(\\frac{\\pi}{2})^2} \\left[ \\pi - \\left(\\frac{\\pi}{2} - \\beta\\right) - \\pi + \\left(\\frac{\\pi}{2} + \\beta\\right) + 0 - 0 \\right]\n$$\n$$\nR^{\\ast}_{\\text{naive}}(1,1) = \\frac{1}{2(\\frac{\\pi^2}{4})} \\left[ \\pi - \\frac{\\pi}{2} + \\beta - \\pi + \\frac{\\pi}{2} + \\beta \\right]\n$$\n$$\nR^{\\ast}_{\\text{naive}}(1,1) = \\frac{2}{\\pi^2} \\left[ (\\pi - \\pi) + \\left(-\\frac{\\pi}{2} + \\frac{\\pi}{2}\\right) + (\\beta + \\beta) \\right]\n$$\n$$\nR^{\\ast}_{\\text{naive}}(1,1) = \\frac{2}{\\pi^2} [2\\beta] = \\frac{4\\beta}{\\pi^2}\n$$\nWith $\\beta = 0.25$, the analytic expression is $R^{\\ast}_{\\text{naive}}(1,1) = \\frac{4(0.25)}{\\pi^2} = \\frac{1}{\\pi^2}$.\nNumerically, this is $R^{\\ast}_{\\text{naive}}(1,1) \\approx 0.10132$. The non-zero result demonstrates that this naive scheme does not satisfy the discrete GCL and thus does not preserve the free-stream. This introduces an artificial source term into the mass conservation equation, which is a critical flaw.\n\nPart B: Corrected Scheme\n\nFor the corrected scheme, both metric derivatives and their divergences are approximated using second-order central differences. The normalized residual is:\n$$\nR^{\\ast}_{\\text{corr}}(1,1) = \\frac{y_{\\eta}^{C}(2,1) - y_{\\eta}^{C}(0,1)}{2h} - \\frac{y_{\\xi}^{C}(1,2) - y_{\\xi}^{C}(1,0)}{2h}\n$$\nwhere $y_{\\eta}^{C}(i,j) = \\frac{y_ {i,j+1} - y_ {i,j-1}}{2h}$ and $y_{\\xi}^{C}(i,j) = \\frac{y_ {i+1,j} - y_ {i-1,j}}{2h}$.\nLet us write this in terms of difference operators. Let $\\mathcal{D}_{\\xi}^{C}$ and $\\mathcal{D}_{\\eta}^{C}$ be the central difference operators in the $\\xi$ and $\\eta$ directions, respectively. The residual is the discrete analogue of $y_{\\eta\\xi} - y_{\\xi\\eta}$, which is $R^{\\ast}_{\\text{corr}} = \\mathcal{D}_{\\xi}^{C}(\\mathcal{D}_{\\eta}^{C}(y)) - \\mathcal{D}_{\\eta}^{C}(\\mathcal{D}_{\\xi}^{C}(y))$.\n\nLet's expand the first term at a generic point $(i,j)$:\n$$\n\\mathcal{D}_{\\xi}^{C}(\\mathcal{D}_{\\eta}^{C}(y))_{(i,j)} = \\frac{\\mathcal{D}_{\\eta}^{C}(y)_{i+1,j} - \\mathcal{D}_{\\eta}^{C}(y)_{i-1,j}}{2h} = \\frac{1}{2h} \\left[ \\frac{y_{i+1,j+1} - y_{i+1,j-1}}{2h} - \\frac{y_{i-1,j+1} - y_{i-1,j-1}}{2h} \\right]\n$$\n$$\n= \\frac{1}{4h^2} [y_{i+1,j+1} - y_{i+1,j-1} - y_{i-1,j+1} + y_{i-1,j-1}]\n$$\nNow, let's expand the second term:\n$$\n\\mathcal{D}_{\\eta}^{C}(\\mathcal{D}_{\\xi}^{C}(y))_{(i,j)} = \\frac{\\mathcal{D}_{\\xi}^{C}(y)_{i,j+1} - \\mathcal{D}_{\\xi}^{C}(y)_{i,j-1}}{2h} = \\frac{1}{2h} \\left[ \\frac{y_{i+1,j+1} - y_{i-1,j+1}}{2h} - \\frac{y_{i+1,j-1} - y_{i-1,j-1}}{2h} \\right]\n$$\n$$\n= \\frac{1}{4h^2} [y_{i+1,j+1} - y_{i-1,j+1} - y_{i+1,j-1} + y_{i-1,j-1}]\n$$\nThe two expressions are identical. This demonstrates that the standard second-order central difference operators commute: $\\mathcal{D}_{\\xi}^{C}\\mathcal{D}_{\\eta}^{C} = \\mathcal{D}_{\\eta}^{C}\\mathcal{D}_{\\xi}^{C}$.\n\nTherefore, the corrected normalized residual is:\n$$\nR^{\\ast}_{\\text{corr}}(1,1) = \\mathcal{D}_{\\xi}^{C}(\\mathcal{D}_{\\eta}^{C}(y))_{(1,1)} - \\mathcal{D}_{\\eta}^{C}(\\mathcal{D}_{\\xi}^{C}(y))_{(1,1)} = 0\n$$\nThis result is identically zero for any grid mapping function $y(\\xi,\\eta)$, any grid point $(i,j)$, and any grid spacing $h$. It is a direct consequence of the commutation property of the consistently applied central difference operators. This scheme satisfies the discrete GCL and correctly preserves the uniform free-stream, which is a necessary condition for a reliable CFD scheme.\n\nNote: The problem statement for Part B defines $R^{\\ast}_{\\text{corr}}(1,1)$ with an extraneous factor of $\\frac{1}{\\rho U}$. This is likely a typographical error, as a similar factor was correctly absorbed into the normalized residual $R^{\\ast}_{\\text{naive}}$ in Part A. However, since the term it multiplies is zero, this notational error does not alter the final result.\nThe final answer is the value of $R^{\\ast}_{\\text{corr}}(1,1)$.",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}