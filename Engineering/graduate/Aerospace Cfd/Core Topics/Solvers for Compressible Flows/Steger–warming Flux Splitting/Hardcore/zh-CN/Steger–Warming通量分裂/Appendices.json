{
    "hands_on_practices": [
        {
            "introduction": "将理论付诸实践的最佳方式是进行分步计算。本练习将通过一个经典的CFD测试案例——Sod激波管问题，指导您完成Steger-Warming分裂过程的核心步骤。通过从给定的初始条件计算声速、特征值（通量雅可比矩阵的本征值）以及最终的分裂通量向量，您将对该方法的基本机理建立坚实的理解。",
            "id": "3997168",
            "problem": "考虑计算流体动力学（CFD）中使用的一维无粘可压缩欧拉方程，其中理想气体的恒定比热比为 $\\gamma$。一个 Sod 激波管在时间 $t=0$ 时进行初始化，其左态为 $\\left(\\rho_L,u_L,p_L\\right)=\\left(1,0,1\\right)$，右态为 $\\left(\\rho_R,u_R,p_R\\right)=\\left(0.125,0,0.1\\right)$，且 $\\gamma=1.4$。利用控制方程和理想气体关系式的第一性原理推导，确定在 $t=0$ 时的以下物理量：\n- 声速 $a_L$ 和 $a_R$，\n- 在 $U_L$ 和 $U_R$ 处的三个特征速度（$x$方向通量雅可比矩阵的特征值），\n- Steger–Warming 通量分裂向量 $F^{+}(U_L)$ 和 $F^{-}(U_R)$。\n\n假设使用标准守恒变量形式 $U=\\left(\\rho,\\rho u,\\rho E\\right)^{\\top}$ 和理想气体状态方程，并执行与 Steger–Warming 通量分裂一致的特征（本征）分解。提供精确值（不要四舍五入）。将最终结果表示为一个单行向量，按顺序包含：\n$\\left[a_L,\\ a_R,\\ \\lambda_{-}(U_L),\\ \\lambda_{0}(U_L),\\ \\lambda_{+}(U_L),\\ \\lambda_{-}(U_R),\\ \\lambda_{0}(U_R),\\ \\lambda_{+}(U_R),\\ \\left(F^{+}(U_L)\\right)_1,\\ \\left(F^{+}(U_L)\\right)_2,\\ \\left(F^{+}(U_L)\\right)_3,\\ \\left(F^{-}(U_R)\\right)_1,\\ \\left(F^{-}(U_R)\\right)_2,\\ \\left(F^{-}(U_R)\\right)_3\\right]$。不需要单位。",
            "solution": "用户希望基于 Sod 激波管问题的给定初始条件，解决一个关于 Steger-Warming 通量分裂的问题。\n\n### 第1步：问题验证\n\n根据指定的验证标准对问题进行审查。\n\n**1. 提取的已知条件：**\n- **控制方程：** 一维无粘可压缩欧拉方程。\n- **气体模型：** 理想气体，恒定比热比 $\\gamma = 1.4$。\n- **问题设置：** Sod 激波管，时间 $t=0$。\n- **左态：** $(\\rho_L, u_L, p_L) = (1, 0, 1)$。\n- **右态：** $(\\rho_R, u_R, p_R) = (0.125, 0, 0.1)$。\n- **守恒变量：** $U = (\\rho, \\rho u, \\rho E)^{\\top}$。\n- **状态方程：** 理想气体，$p = (\\gamma - 1)(\\rho E - \\frac{1}{2}\\rho u^2)$。\n- **任务：** 使用 Steger-Warming 分裂法确定 $a_L$、$a_R$、在 $U_L$ 和 $U_R$ 处的通量雅可比矩阵的特征值，以及通量分裂向量 $F^{+}(U_L)$ 和 $F^{-}(U_R)$。\n- **输出格式：** 包含14个指定量的单行向量。\n\n**2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题牢固地植根于流体动力学的基本原理，特别是欧拉方程、理想气体物理和特征线理论。Steger–Warming 通量分裂格式是计算流体动力学（CFD）中一种标准的、有据可查的方法。所有方面都具有科学合理性。\n- **适定性：** 初始条件已完全指定，待求量是这些条件和控制方程的直接、唯一推论。该问题是适定的。\n- **客观性：** 问题使用精确、无歧义的数学和物理术语进行陈述。没有主观因素。\n- **缺陷检查清单：**\n    - 无科学或事实上的不合理之处。\n    - 与指定的 Steger-Warming 分裂主题直接相关。\n    - 设置完整且一致。\n    - 条件和数据对于激波管问题是物理上现实的。\n    - 问题结构清晰，并能导出一个唯一解。\n    - 该问题是CFD理论的一个标准的、非平凡的应用。\n    - 所有结果都是科学上可验证的。\n\n**3. 结论与行动：**\n问题有效。将提供完整解答。\n\n### 第2步：求解\n\n一维无粘可压缩流体的欧拉方程可以写成守恒形式：\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0\n$$\n其中 $U$ 是守恒变量向量，$F(U)$ 是通量向量：\n$$\nU = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}, \\quad\nF(U) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (\\rho E + p)u \\end{pmatrix}\n$$\n此处，$\\rho$ 是密度，$u$ 是速度，$p$ 是压力，$E$ 是单位质量的总能量。对于理想气体，总能量为 $E = e + \\frac{1}{2}u^2$，其中 $e$ 是比内能。状态方程由 $p = \\rho (\\gamma-1)e$ 给出，它将压力与内能联系起来。这可以用守恒变量表示为：\n$$\np = (\\gamma-1) \\left(\\rho E - \\frac{1}{2}\\rho u^2\\right)\n$$\n理想气体中的声速 $a$ 由下式给出：\n$$\na = \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\n\n**1. 声速 ($a_L$ 和 $a_R$)**\n\n给定 $t=0$ 时左（L）侧和右（R）侧状态的原始变量，以及 $\\gamma = 1.4$。\n\n对于左态：$(\\rho_L, u_L, p_L) = (1, 0, 1)$。\n声速为：\n$$\na_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times 1}{1}} = \\sqrt{1.4}\n$$\n\n对于右态：$(\\rho_R, u_R, p_R) = (0.125, 0, 0.1)$。\n声速为：\n$$\na_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times 0.1}{0.125}} = \\sqrt{\\frac{0.14}{0.125}} = \\sqrt{1.12}\n$$\n\n**2. 特征速度（特征值）**\n\n特征速度是通量雅可比矩阵 $A(U) = \\frac{\\partial F}{\\partial U}$ 的特征值。对于一维欧拉方程，这些特征值是众所周知的，由下式给出：\n$$\n\\lambda_1 = u - a, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + a\n$$\n我们将它们记为 $\\lambda_{-}$、$\\lambda_{0}$ 和 $\\lambda_{+}$。\n\n对于左态 $U_L$，有 $u_L=0$ 和 $a_L=\\sqrt{1.4}$：\n$$\n\\lambda_{-}(U_L) = u_L - a_L = 0 - \\sqrt{1.4} = -\\sqrt{1.4}\n$$\n$$\n\\lambda_{0}(U_L) = u_L = 0\n$$\n$$\n\\lambda_{+}(U_L) = u_L + a_L = 0 + \\sqrt{1.4} = \\sqrt{1.4}\n$$\n\n对于右态 $U_R$，有 $u_R=0$ 和 $a_R=\\sqrt{1.12}$：\n$$\n\\lambda_{-}(U_R) = u_R - a_R = 0 - \\sqrt{1.12} = -\\sqrt{1.12}\n$$\n$$\n\\lambda_{0}(U_R) = u_R = 0\n$$\n$$\n\\lambda_{+}(U_R) = u_R + a_R = 0 + \\sqrt{1.12} = \\sqrt{1.12}\n$$\n\n**3. Steger–Warming 通量分裂**\n\nSteger–Warming 格式将通量向量 $F$ 分裂为 $F^+$ 和 $F^-$，分别对应正特征值和负特征值。这是由于欧拉通量向量的齐次性，它允许我们写出 $F(U) = A(U)U$。雅可比矩阵 $A$ 可以对角化为 $A=S\\Lambda S^{-1}$，其中 $\\Lambda$ 是特征值的对角矩阵，$S$ 是右特征向量矩阵。通量可以分解为特征场上的和：\n$$\nF = \\sum_{i=1}^{3} \\alpha_i \\lambda_i K_i\n$$\n其中 $K_i$ 是右特征向量，$\\alpha_i$ 是缩放系数。对于一维欧拉方程，这个分解明确为：\n$$\nF = \\frac{\\rho}{2\\gamma} \\lambda_1 \\begin{pmatrix} 1 \\\\ u-a \\\\ H-ua \\end{pmatrix} + \\frac{\\rho(\\gamma-1)}{\\gamma} \\lambda_2 \\begin{pmatrix} 1 \\\\ u \\\\ u^2/2 \\end{pmatrix} + \\frac{\\rho}{2\\gamma} \\lambda_3 \\begin{pmatrix} 1 \\\\ u+a \\\\ H+ua \\end{pmatrix}\n$$\n其中 $H$ 是总焓，$H = E + p/\\rho = \\frac{a^2}{\\gamma-1} + \\frac{u^2}{2}$。\n分裂通量 $F^+$ 和 $F^-$ 分别通过对正特征值和负特征值的贡献求和得到：\n$$\nF^{+} = \\sum_{\\lambda_i > 0} (\\text{component for } \\lambda_i), \\quad F^{-} = \\sum_{\\lambda_i  0} (\\text{component for } \\lambda_i)\n$$\n注意，对于本问题，中间特征值 $\\lambda_2=u$ 在左态和右态都为零，因此我们不需要考虑它对任一分裂通量的贡献。\n\n**3a. $F^{+}(U_L)$的计算**\n\n对于左态，特征值为 $\\lambda_-(U_L)=-\\sqrt{1.4}$、$\\lambda_0(U_L)=0$ 和 $\\lambda_+(U_L)=\\sqrt{1.4}$。唯一的正特征值是 $\\lambda_+$。因此，$F^+(U_L)$ 仅包含与 $\\lambda_3=\\lambda_+$ 相关的分量：\n$$\nF^{+}(U_L) = \\frac{\\rho_L}{2\\gamma} \\lambda_+(U_L) \\begin{pmatrix} 1 \\\\ u_L+a_L \\\\ H_L+u_L a_L \\end{pmatrix}\n$$\n我们有 $\\rho_L=1$, $u_L=0$, $\\gamma=1.4$, $\\lambda_+(U_L) = a_L = \\sqrt{1.4}$。\n首先，计算 $H_L$：\n$$\nH_L = \\frac{a_L^2}{\\gamma-1} + \\frac{u_L^2}{2} = \\frac{1.4}{1.4-1} + 0 = \\frac{1.4}{0.4} = 3.5\n$$\n现在，将这些值代入 $F^+(U_L)$ 的表达式中：\n$$\nF^{+}(U_L) = \\frac{1}{2(1.4)} (\\sqrt{1.4}) \\begin{pmatrix} 1 \\\\ 0+\\sqrt{1.4} \\\\ 3.5+0 \\end{pmatrix} = \\frac{\\sqrt{1.4}}{2.8} \\begin{pmatrix} 1 \\\\ \\sqrt{1.4} \\\\ 3.5 \\end{pmatrix}\n$$\n各分量为：\n$$\n(F^{+}(U_L))_1 = \\frac{\\sqrt{1.4}}{2.8}\n$$\n$$\n(F^{+}(U_L))_2 = \\frac{\\sqrt{1.4}}{2.8} \\times \\sqrt{1.4} = \\frac{1.4}{2.8} = 0.5\n$$\n$$\n(F^{+}(U_L))_3 = \\frac{\\sqrt{1.4}}{2.8} \\times 3.5 = \\frac{3.5}{2.8}\\sqrt{1.4} = 1.25\\sqrt{1.4}\n$$\n\n**3b. $F^{-}(U_R)$的计算**\n\n对于右态，特征值为 $\\lambda_-(U_R)=-\\sqrt{1.12}$、$\\lambda_0(U_R)=0$ 和 $\\lambda_+(U_R)=\\sqrt{1.12}$。唯一的负特征值是 $\\lambda_-$。因此，$F^-(U_R)$ 仅包含与 $\\lambda_1=\\lambda_-$ 相关的分量：\n$$\nF^{-}(U_R) = \\frac{\\rho_R}{2\\gamma} \\lambda_-(U_R) \\begin{pmatrix} 1 \\\\ u_R-a_R \\\\ H_R-u_R a_R \\end{pmatrix}\n$$\n我们有 $\\rho_R=0.125$, $u_R=0$, $\\gamma=1.4$, $\\lambda_-(U_R) = -a_R = -\\sqrt{1.12}$。\n首先，计算 $H_R$：\n$$\nH_R = \\frac{a_R^2}{\\gamma-1} + \\frac{u_R^2}{2} = \\frac{1.12}{1.4-1} + 0 = \\frac{1.12}{0.4} = 2.8\n$$\n现在，将这些值代入 $F^-(U_R)$ 的表达式中：\n$$\nF^{-}(U_R) = \\frac{0.125}{2(1.4)} (-\\sqrt{1.12}) \\begin{pmatrix} 1 \\\\ 0-\\sqrt{1.12} \\\\ 2.8-0 \\end{pmatrix} = -\\frac{0.125\\sqrt{1.12}}{2.8} \\begin{pmatrix} 1 \\\\ -\\sqrt{1.12} \\\\ 2.8 \\end{pmatrix}\n$$\n各分量为：\n$$\n(F^{-}(U_R))_1 = -\\frac{0.125\\sqrt{1.12}}{2.8} = -\\frac{\\sqrt{1.12}}{22.4}\n$$\n$$\n(F^{-}(U_R))_2 = -\\frac{0.125\\sqrt{1.12}}{2.8} \\times (-\\sqrt{1.12}) = \\frac{0.125 \\times 1.12}{2.8} = 0.05\n$$\n$$\n(F^{-}(U_R))_3 = -\\frac{0.125\\sqrt{1.12}}{2.8} \\times 2.8 = -0.125\\sqrt{1.12}\n$$\n\n**4. 最终结果向量**\n\n我们按照要求将计算出的14个量组合成一个单行向量。为了精确，我们适当地使用分数和根式形式。\n$\\gamma = 1.4 = \\frac{7}{5}$。\n$a_L = \\sqrt{1.4} = \\sqrt{\\frac{7}{5}}$。\n$a_R = \\sqrt{1.12} = \\sqrt{\\frac{28}{25}} = \\frac{2\\sqrt{7}}{5}$。\n$(F^{+}(U_L))_1 = \\frac{\\sqrt{1.4}}{2.8} = \\frac{\\sqrt{7/5}}{14/5} = \\frac{\\sqrt{7}/\\sqrt{5}}{14/5} = \\frac{\\sqrt{35}}{14}$。\n$(F^{+}(U_L))_2 = 0.5 = \\frac{1}{2}$。\n$(F^{+}(U_L))_3 = 1.25\\sqrt{1.4} = \\frac{5}{4}\\sqrt{\\frac{7}{5}} = \\frac{\\sqrt{25}}{4} \\frac{\\sqrt{7}}{\\sqrt{5}} = \\frac{\\sqrt{125 \\times 7 / 25}}{4} = \\frac{\\sqrt{35}}{4}$。\n$(F^{-}(U_R))_1 = -\\frac{\\sqrt{1.12}}{22.4} = -\\frac{2\\sqrt{7}/5}{112/5} = -\\frac{2\\sqrt{7}}{112} = -\\frac{\\sqrt{7}}{56}$。\n$(F^{-}(U_R))_2 = 0.05 = \\frac{1}{20}$。\n$(F^{-}(U_R))_3 = -0.125\\sqrt{1.12} = -\\frac{1}{8}\\frac{2\\sqrt{7}}{5} = -\\frac{\\sqrt{7}}{20}$。\n\n最终的向量元素为：\n$[a_L, a_R, \\lambda_{-}(U_L), \\lambda_{0}(U_L), \\lambda_{+}(U_L), \\lambda_{-}(U_R), \\lambda_{0}(U_R), \\lambda_{+}(U_R), (F^{+}(U_L))_1, (F^{+}(U_L))_2, (F^{+}(U_L))_3, (F^{-}(U_R))_1, (F^{-}(U_R))_2, (F^{-}(U_R))_3]$\n$= [\\sqrt{\\frac{7}{5}}, \\frac{2\\sqrt{7}}{5}, -\\sqrt{\\frac{7}{5}}, 0, \\sqrt{\\frac{7}{5}}, -\\frac{2\\sqrt{7}}{5}, 0, \\frac{2\\sqrt{7}}{5}, \\frac{\\sqrt{35}}{14}, \\frac{1}{2}, \\frac{\\sqrt{35}}{4}, -\\frac{\\sqrt{7}}{56}, \\frac{1}{20}, -\\frac{\\sqrt{7}}{20}]$。\n或者，使用问题陈述中提供的精确小数值：\n$[ \\sqrt{1.4}, \\sqrt{1.12}, -\\sqrt{1.4}, 0, \\sqrt{1.4}, -\\sqrt{1.12}, 0, \\sqrt{1.12}, \\frac{\\sqrt{1.4}}{2.8}, 0.5, 1.25\\sqrt{1.4}, -\\frac{\\sqrt{1.12}}{22.4}, 0.05, -0.125\\sqrt{1.12} ]$。\n两种形式都是精确的。考虑到科学计算的性质，基于小数的根式形式很常见，并与输入值直接相关。最终答案将使用此形式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{1.4}  \\sqrt{1.12}  -\\sqrt{1.4}  0  \\sqrt{1.4}  -\\sqrt{1.12}  0  \\sqrt{1.12}  \\frac{\\sqrt{1.4}}{2.8}  0.5  1.25\\sqrt{1.4}  -\\frac{\\sqrt{1.12}}{22.4}  0.05  -0.125\\sqrt{1.12} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理解特征速度不仅是理论上的要求，它还直接影响计算的实际稳定性。这个练习将前一个练习中计算的特征值概念应用于一个关键的实际问题：为显式时间推进格式设置时间步长。通过应用Courant–Friedrichs–Lewy (CFL)条件，您将学会如何利用流场中的最大波速来确定数值模拟所允许的最大时间步长，这是确保任何CFD代码稳定运行的基石。",
            "id": "3997174",
            "problem": "考虑在计算流体力学（CFD）和 Steger–Warming 通量分裂的背景下，用于量热完全理想气体的一维欧拉方程。在时间 $t=0$ 时，位于 $x=x_{i+1/2}$ 的界面处，左右两侧的守恒状态由 $U_L$ 和 $U_R$ 给出，它们由以下原始变量构造：\n- 左侧状态：密度 $\\rho_L=1.0\\ \\mathrm{kg/m^3}$，速度 $u_L=200\\ \\mathrm{m/s}$，压力 $p_L=1.0\\times 10^{5}\\ \\mathrm{Pa}$。\n- 右侧状态：密度 $\\rho_R=0.8\\ \\mathrm{kg/m^3}$，速度 $u_R=150\\ \\mathrm{m/s}$，压力 $p_R=8.0\\times 10^{4}\\ \\mathrm{Pa}$。\n\n假设为量热完全理想气体，比热比 $\\gamma=1.4$。守恒变量为 $U=[\\rho,\\ \\rho u,\\ \\rho E]^{\\mathsf{T}}$，其中单位质量总能量 $E$ 与压力 $p$ 的关系为 $p=(\\gamma-1)\\left(\\rho E-\\tfrac{1}{2}\\rho u^2\\right)$。\n\n从欧拉方程和通量雅可比矩阵的定义出发，确定在 $t=0$ 时界面两侧的特征速度，并用它们来确定与此界面上的 Steger–Warming 通量分裂相关的最大特征速度。然后，对于一个 Courant 数 $\\mathrm{CFL}=0.5$、在间距为 $\\Delta x=0.01\\ \\mathrm{m}$ 的均匀网格上的显式有限体积更新，施加 Courant–Friedrichs–Lewy (CFL) 条件，并基于从 $U_L$ 和 $U_R$ 两者中获取的最大特征值，计算在 $t=0$ 时的最大允许时间步长 $\\Delta t$。将您的答案四舍五入到四位有效数字，并以秒为单位表示最终结果。",
            "solution": "问题需要进行验证。\n\n### 步骤 1：提取已知条件\n- 左侧状态原始变量：$\\rho_L=1.0\\ \\mathrm{kg/m^3}$，$u_L=200\\ \\mathrm{m/s}$，$p_L=1.0\\times 10^{5}\\ \\mathrm{Pa}$。\n- 右侧状态原始变量：$\\rho_R=0.8\\ \\mathrm{kg/m^3}$，$u_R=150\\ \\mathrm{m/s}$，$p_R=8.0\\times 10^{4}\\ \\mathrm{Pa}$。\n- 比热比：$\\gamma=1.4$。\n- 守恒变量向量：$U=[\\rho,\\ \\rho u,\\ \\rho E]^{\\mathsf{T}}$。\n- 将单位质量总能量 E 与压力 p 关联的状态方程：$p=(\\gamma-1)\\left(\\rho E-\\tfrac{1}{2}\\rho u^2\\right)$。\n- Courant–Friedrichs–Lewy (CFL) 条件的 Courant 数：$\\mathrm{CFL}=0.5$。\n- 均匀网格间距：$\\Delta x=0.01\\ \\mathrm{m}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于一维欧拉方程，这是流体力学中的一个基本模型。通量分裂（Steger–Warming）、特征速度（特征值）和 CFL 稳定性条件等概念在计算流体力学（CFD）领域是标准且成熟的。所提供的值对于气体流动是物理上现实的。\n- **适定性**：该问题陈述清晰，并提供了计算时间步长 $\\Delta t$ 唯一数值解所需的所有数据和方程。\n- **客观性**：该问题使用精确的、定量的语言进行表述，不含任何主观或基于观点的陈述。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整的解法。\n\n该问题要求计算应用于一维欧拉方程的显式有限体积格式的最大允许时间步长 $\\Delta t$。该时间步长受 Courant–Friedrichs–Lewy (CFL) 条件的约束，该条件确保了数值稳定性。CFL 条件关联了时间步长 $\\Delta t$、网格间距 $\\Delta x$ 和系统中信息传播的最大速度。\n\n一维欧拉方程可以写成守恒形式：\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0\n$$\n其中 $U$ 是守恒变量的向量，$F(U)$ 是通量向量。为了分析波的传播速度，系统被线性化，得到：\n$$\n\\frac{\\partial U}{\\partial t} + A(U) \\frac{\\partial U}{\\partial x} = 0\n$$\n其中 $A(U) = \\frac{\\partial F}{\\partial U}$ 是通量雅可比矩阵。给定 $A(U)$ 的特征值是系统在状态 $U$ 下的特征速度（或波速）。对于一维欧拉方程，这些特征值为：\n$$\n\\lambda_1 = u, \\quad \\lambda_2 = u+c, \\quad \\lambda_3 = u-c\n$$\n其中 $u$ 是流体速度，$c$ 是声速。对于量热完全理想气体，声速由下式给出：\n$$\nc = \\sqrt{\\gamma \\frac{p}{\\rho}}\n$$\n虽然 Steger–Warming 通量分裂使用这些特征值的符号来分裂通量向量，但显式时间积分格式的稳定性是由最快移动波的大小决定的。雅可比矩阵的谱半径 $\\rho(A) = \\max_k |\\lambda_k|$ 决定了这个速度。对于任何物理流动，$c > 0$，因此最大特征值模为：\n$$\n\\max(|\\lambda_1|, |\\lambda_2|, |\\lambda_3|) = \\max(|u|, |u+c|, |u-c|) = |u| + c\n$$\n在均匀网格上，显式方法的 CFL 条件由下式给出：\n$$\n\\mathrm{CFL} = \\frac{S_{max} \\Delta t}{\\Delta x} \\implies \\Delta t = \\mathrm{CFL} \\frac{\\Delta x}{S_{max}}\n$$\n其中 $S_{max}$ 是整个计算域上的最大波速。问题要求基于界面 $x_{i+1/2}$ 处的左右状态计算 $t=0$ 时的时间步长。因此，$S_{max}$ 必须是来自左侧和右侧状态的最快波速中的最大值。\n$$\nS_{max} = \\max(|u_L| + c_L, |u_R| + c_R)\n$$\n我们接下来计算左侧和右侧状态的声速。\n\n对于左侧状态（$L$）：\n- $\\rho_L = 1.0\\ \\mathrm{kg/m^3}$\n- $p_L = 1.0 \\times 10^5\\ \\mathrm{Pa}$\n- $u_L = 200\\ \\mathrm{m/s}$\n- $\\gamma = 1.4$\n声速为：\n$$\nc_L = \\sqrt{\\gamma \\frac{p_L}{\\rho_L}} = \\sqrt{1.4 \\times \\frac{1.0 \\times 10^5\\ \\mathrm{Pa}}{1.0\\ \\mathrm{kg/m^3}}} = \\sqrt{1.4 \\times 10^5}\\ \\mathrm{m/s} = \\sqrt{140000}\\ \\mathrm{m/s}\n$$\n\n对于右侧状态（$R$）：\n- $\\rho_R = 0.8\\ \\mathrm{kg/m^3}$\n- $p_R = 8.0 \\times 10^4\\ \\mathrm{Pa}$\n- $u_R = 150\\ \\mathrm{m/s}$\n- $\\gamma = 1.4$\n声速为：\n$$\nc_R = \\sqrt{\\gamma \\frac{p_R}{\\rho_R}} = \\sqrt{1.4 \\times \\frac{8.0 \\times 10^4\\ \\mathrm{Pa}}{0.8\\ \\mathrm{kg/m^3}}} = \\sqrt{1.4 \\times 10^5}\\ \\mathrm{m/s} = \\sqrt{140000}\\ \\mathrm{m/s}\n$$\n两种状态下的声速是相同的，$c_L = c_R = \\sqrt{140000}\\ \\mathrm{m/s} \\approx 374.1657\\ \\mathrm{m/s}$。让我们将这个共同的声速记为 $c$。\n\n现在，我们确定每一侧的最大特征速度。\n对于左侧状态，三个特征速度是 $u_L=200$, $u_L+c=200+c$, 和 $u_L-c=200-c$。最大模为：\n$$\nS_L = |u_L| + c = |200| + \\sqrt{140000} = 200 + \\sqrt{140000}\\ \\mathrm{m/s}\n$$\n\n对于右侧状态，三个特征速度是 $u_R=150$, $u_R+c=150+c$, 和 $u_R-c=150-c$。最大模为：\n$$\nS_R = |u_R| + c = |150| + \\sqrt{140000} = 150 + \\sqrt{140000}\\ \\mathrm{m/s}\n$$\n\n总的最大波速 $S_{max}$ 是 $S_L$ 和 $S_R$ 中的较大者：\n$$\nS_{max} = \\max(S_L, S_R) = \\max(200 + \\sqrt{140000}, 150 + \\sqrt{140000}) = 200 + \\sqrt{140000}\\ \\mathrm{m/s}\n$$\n数值上，$S_{max} \\approx 200 + 374.1657 = 574.1657\\ \\mathrm{m/s}$。\n\n最后，我们使用 CFL 条件来计算最大允许时间步长 $\\Delta t$。\n已知：\n- $\\mathrm{CFL} = 0.5$\n- $\\Delta x = 0.01\\ \\mathrm{m}$\n- $S_{max} = 200 + \\sqrt{140000}\\ \\mathrm{m/s}$\n$$\n\\Delta t = \\mathrm{CFL} \\frac{\\Delta x}{S_{max}} = 0.5 \\times \\frac{0.01\\ \\mathrm{m}}{200 + \\sqrt{140000}\\ \\mathrm{m/s}}\n$$\n$$\n\\Delta t = \\frac{0.005}{200 + \\sqrt{140000}}\\ \\mathrm{s} \\approx \\frac{0.005}{574.1657}\\ \\mathrm{s} \\approx 8.70822 \\times 10^{-6}\\ \\mathrm{s}\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\n\\Delta t \\approx 8.708 \\times 10^{-6}\\ \\mathrm{s}\n$$\n这是在 $t=0$ 时，使用给定参数并满足 CFL 稳定性准则所能使用的最大时间步长。",
            "answer": "$$\\boxed{8.708 \\times 10^{-6}}$$"
        },
        {
            "introduction": "任何数值方法都有其局限性，理解并修正它们是高级研究的关键。标准的Steger-Warming分裂在处理接近零的特征速度（如静止接触间断或跨音速点）时会遇到问题，可能导致非物理的膨胀激波。本练习将探讨一种称为“熵修正”的技术，通过平滑本征值的计算来增加必要的数值耗散，从而解决这一缺陷，这对于保证数值解的物理真实性至关重要。",
            "id": "3997178",
            "problem": "考虑由理想气体欧拉方程控制的一维无粘性可压缩流，其比热比为 $\\gamma$。守恒变量为 $U = [\\rho, \\rho u, \\rho E]^{\\top}$，对应的通量向量为 $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\top}$，其中 $p$ 为热力学压力，$u$ 为速度，$E$ 为比总能。雅可比矩阵 $\\partial F / \\partial U$ 有三个实特征值：$\\lambda_{1} = u - a$，$\\lambda_{2} = u$ 和 $\\lambda_{3} = u + a$，其中 $a$ 是声速。在 Steger–Warming 通量分裂中，分裂是根据特征速度的正部和负部对其进行的。在许多实现中，会应用熵修正，即用一个平滑的幅值替换 $|\\lambda|$。假设熵修正根据 $|\\lambda| \\mapsto \\sqrt{\\lambda^{2} + \\epsilon^{2}}$ 修改绝对值，其中 $\\epsilon = 0.1 a$。\n\n考虑一个马赫数 $M = u/a = 0.05$ 的均匀状态，因此 $u = 0.05 a$。关注接触模态，其特征值为 $\\lambda_{2} = u$。将未修正的正分裂速度定义为 $\\lambda_{2}^{+} = \\tfrac{1}{2}(\\lambda_{2} + |\\lambda_{2}|)$，经熵修正的正分裂速度定义为 $\\lambda_{2,\\epsilon}^{+} = \\tfrac{1}{2}(\\lambda_{2} + \\sqrt{\\lambda_{2}^{2} + \\epsilon^{2}})$。计算给定状态下的比率 $R = \\lambda_{2,\\epsilon}^{+} / \\lambda_{2}^{+}$。将最终比率表示为一个无量纲数，并四舍五入到四位有效数字。\n\n除了计算 $R$ 之外，请用文字解释与未修正的分裂相比，熵修正如何改变接触模态附近的分裂通量。解释应基于欧拉方程的基本性质和特征分解，但不要提供除上述定义之外的任何捷径公式。",
            "solution": "问题陈述经过严格验证，被认为是具有科学依据、适定且客观的。这是计算流体动力学数值方法分析中的一个标准问题，具体涉及欧拉方程的 Steger–Warming 通量向量分裂。所有必要的定义和数据均已提供，没有矛盾或模糊之处。\n\n我们的任务是计算比率 $R = \\lambda_{2,\\epsilon}^{+} / \\lambda_{2}^{+}$ 并解释熵修正的作用。\n\n首先，我们计算数值比率 $R$。\n给定状态为马赫数 $M = u/a = 0.05$ 的均匀流。这意味着流体速度为 $u = 0.05 a$。\n接触模态的特征值给定为 $\\lambda_{2} = u$。\n因此，$\\lambda_{2} = 0.05 a$。\n\n未修正的正分裂速度 $\\lambda_{2}^{+}$ 定义为：\n$$\n\\lambda_{2}^{+} = \\frac{1}{2}(\\lambda_{2} + |\\lambda_{2}|)\n$$\n由于声速 $a$ 本身是正值，$\\lambda_{2} = 0.05 a$ 也是一个正值。因此，$|\\lambda_{2}| = \\lambda_{2}$。\n将此代入定义，我们得到：\n$$\n\\lambda_{2}^{+} = \\frac{1}{2}(\\lambda_{2} + \\lambda_{2}) = \\lambda_{2} = 0.05 a\n$$\n\n经熵修正的正分裂速度 $\\lambda_{2,\\epsilon}^{+}$ 定义中应用了修正 $|\\lambda| \\mapsto \\sqrt{\\lambda^{2} + \\epsilon^{2}}$。其定义为：\n$$\n\\lambda_{2,\\epsilon}^{+} = \\frac{1}{2}(\\lambda_{2} + \\sqrt{\\lambda_{2}^{2} + \\epsilon^{2}})\n$$\n我们已知熵修正参数为 $\\epsilon = 0.1 a$。\n现在，我们将 $\\lambda_{2}$ 和 $\\epsilon$ 的值代入此表达式：\n$$\n\\lambda_{2,\\epsilon}^{+} = \\frac{1}{2}(0.05 a + \\sqrt{(0.05 a)^{2} + (0.1 a)^{2}})\n$$\n我们可以从平方根中提出因子 $a$：\n$$\n\\lambda_{2,\\epsilon}^{+} = \\frac{1}{2}(0.05 a + \\sqrt{0.0025 a^{2} + 0.01 a^{2}}) = \\frac{1}{2}(0.05 a + \\sqrt{0.0125 a^{2}})\n$$\n$$\n\\lambda_{2,\\epsilon}^{+} = \\frac{a}{2}(0.05 + \\sqrt{0.0125})\n$$\n问题要求计算比率 $R = \\lambda_{2,\\epsilon}^{+} / \\lambda_{2}^{+}$。\n$$\nR = \\frac{\\frac{a}{2}(0.05 + \\sqrt{0.0125})}{0.05 a}\n$$\n$a$ 项消掉了，留下一个无量纲比率：\n$$\nR = \\frac{0.05 + \\sqrt{0.0125}}{2 \\times 0.05} = \\frac{0.05 + \\sqrt{0.0125}}{0.1}\n$$\n为了简化数值计算，我们可以用一个基准值来表示这些参数。令 $M=0.05$，则 $u=Ma$ 且 $\\epsilon = (0.1/0.05)Ma = 2Ma$。\n于是 $\\lambda_2^+ = Ma$。\n而 $\\lambda_{2,\\epsilon}^+ = \\frac{1}{2}(Ma + \\sqrt{(Ma)^2 + (2Ma)^2}) = \\frac{1}{2}(Ma + \\sqrt{M^2a^2 + 4M^2a^2}) = \\frac{1}{2}(Ma + \\sqrt{5M^2a^2}) = \\frac{Ma}{2}(1+\\sqrt{5})$。\n该比率为：\n$$\nR = \\frac{\\frac{Ma}{2}(1+\\sqrt{5})}{Ma} = \\frac{1+\\sqrt{5}}{2}\n$$\n这是黄金比例，$\\phi$。\n现在我们计算其数值：\n$$\nR = \\frac{1 + \\sqrt{5}}{2} \\approx \\frac{1 + 2.2360679...}{2} = \\frac{3.2360679...}{2} \\approx 1.6180339...\n$$\n四舍五入到四位有效数字，我们得到 $R = 1.618$。\n\n接下来，我们提供关于熵修正的概念性解释。\n\nSteger–Warming 通量分裂方法建立在像欧拉方程这样的双曲型系统基于特征的性质之上。信息以通量雅可比矩阵的特征值给出的速度沿着特征线传播。该方法将通量向量 $F$ 分裂为分量 $F^{+}$ 和 $F^{-}$，其中 $F^{+}$ 对应于向正方向传播的信息（与正特征值相关），而 $F^{-}$ 对应于向负方向传播的信息（与负特征值相关）。这允许进行迎风离散化，从而恰当地尊重信号传播的方向并增强数值稳定性。\n\n分裂基于特征值 $\\lambda$ 的符号。未修正的分裂使用绝对值函数 $|\\lambda|$ 来分离正负贡献，例如通过 $\\lambda^{+} = \\frac{1}{2}(\\lambda + |\\lambda|)$。函数 $|\\lambda|$ 在 $\\lambda=0$ 处不可微。分裂函数的这种不光滑性是问题的根源。当一个特征值非常接近零时，例如，对于静止或缓慢移动的接触波，其中 $\\lambda_2 = u \\approx 0$，任何微小的数值扰动都可能导致其符号翻转。这种翻转会导致分裂通量的突变：与该特征相关的通量部分会突然从完全属于 $F^{-}$ 切换到完全属于 $F^{+}$。分裂通量作为流态函数的不连续行为会引入数值振荡和非物理的解，例如膨胀激波，特别是在声速点或静止接触间断处。\n\n熵修正通过用一个连续可微的近似函数，如 $\\sqrt{\\lambda^{2} + \\epsilon^{2}}$，来替换非光滑函数 $|\\lambda|$，从而解决这一病态问题。这个修正后的函数处处光滑，包括在 $\\lambda=0$ 处。对于接触模态，当 $u \\approx 0$ 时，分裂速度 $\\lambda_{2,\\epsilon}^{+}$ 和 $\\lambda_{2,\\epsilon}^{-}$ 不再为零。例如，在 $u=0$ 时，未修正的分裂给出 $\\lambda_{2}^{+} = 0$ 和 $\\lambda_2^- = 0$。相比之下，经熵修正的分裂给出 $\\lambda_{2,\\epsilon}^{+} = \\epsilon/2$ 和 $\\lambda_{2,\\epsilon}^{-} = -\\epsilon/2$。\n\n这种修正的结果是引入了数值耗散（或人工粘性）。通过确保在 $\\lambda=0$ 附近的一个小区域内 $\\lambda_{\\epsilon}^{+}$ 和 $\\lambda_{\\epsilon}^{-}$ 都不为零，该格式即使对于近乎静止的波也允许信息向两个方向“传播”或“涂抹”。这种耗散抑制了振荡，并通过平滑由不连续分裂可能引起的尖锐、非物理特征来稳定数值解。本质上，熵修正确保了当特征速度穿过零时，数值格式能平滑地从迎风偏置过渡到顺风偏置，从而恢复正确的物理行为和数值鲁棒性。",
            "answer": "$$\n\\boxed{1.618}\n$$"
        }
    ]
}