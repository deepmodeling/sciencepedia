{
    "hands_on_practices": [
        {
            "introduction": "To begin, we apply the Lax-Friedrichs flux to the inviscid Burgers' equation, a fundamental model for nonlinear wave phenomena. By comparing the result to the Godunov flux, which is derived from the exact solution of the Riemann problem, you will gain a tangible understanding of the numerical dissipation inherent in the Lax-Friedrichs scheme. This exercise  highlights the trade-off between simplicity and accuracy that is central to designing numerical methods.",
            "id": "3982038",
            "problem": "Consider the scalar conservation law for the inviscid Burgers equation in nondimensional form, given by $u_{t} + f(u)_{x} = 0$ with flux $f(u) = \\frac{u^{2}}{2}$. In a one-dimensional discontinuous Galerkin (DG) discretization with a piecewise linear polynomial per cell, interface states are reconstructed using a Total Variation Diminishing (TVD) minmod limiter to control spurious oscillations. For a particular interface $x_{i+\\frac{1}{2}}$, suppose the limited left and right reconstructed states are $u_{L} = 0.8$ and $u_{R} = -0.2$.\n\nUsing first principles for hyperbolic conservation laws and their Riemann problems:\n\n- Compute the Godunov flux at $x_{i+\\frac{1}{2}}$ by invoking the exact self-similar Riemann solution for the inviscid Burgers equation, consistent with conservation and entropy conditions.\n- Compute the Lax–Friedrichs numerical flux at $x_{i+\\frac{1}{2}}$ using the standard symmetric form with a dissipation parameter chosen as the maximum characteristic speed magnitude appropriate for the inviscid Burgers equation, i.e., $\\alpha = \\max\\!\\big(|u_{L}|, |u_{R}|\\big)$.\n\nFinally, compute the difference $F_{\\mathrm{LF}} - F_{\\mathrm{G}}$ between the Lax–Friedrichs flux and the Godunov flux at this interface. Express the final answer as a unitless number and round your answer to four significant figures.",
            "solution": "The user wants me to solve the following problem:\nConsider the scalar conservation law for the inviscid Burgers equation in nondimensional form, given by $u_{t} + f(u)_{x} = 0$ with flux $f(u) = \\frac{u^{2}}{2}$. In a one-dimensional discontinuous Galerkin (DG) discretization with a piecewise linear polynomial per cell, interface states are reconstructed using a Total Variation Diminishing (TVD) minmod limiter to control spurious oscillations. For a particular interface $x_{i+\\frac{1}{2}}$, suppose the limited left and right reconstructed states are $u_{L} = 0.8$ and $u_{R} = -0.2$.\n\nUsing first principles for hyperbolic conservation laws and their Riemann problems:\n\n- Compute the Godunov flux at $x_{i+\\frac{1}{2}}$ by invoking the exact self-similar Riemann solution for the inviscid Burgers equation, consistent with conservation and entropy conditions.\n- Compute the Lax–Friedrichs numerical flux at $x_{i+\\frac{1}{2}}$ using the standard symmetric form with a dissipation parameter chosen as the maximum characteristic speed magnitude appropriate for the inviscid Burgers equation, i.e., $\\alpha = \\max\\!\\big(|u_{L}|, |u_{R}|\\big)$.\n\nFinally, compute the difference $F_{\\mathrm{LF}} - F_{\\mathrm{G}}$ between the Lax–Friedrichs flux and the Godunov flux at this interface. Express the final answer as a unitless number and round your answer to four significant figures.\n\n### Step 1: Extract Givens\n- Conservation Law: $u_{t} + f(u)_{x} = 0$\n- Flux function: $f(u) = \\frac{u^{2}}{2}$\n- Left state at interface $x_{i+\\frac{1}{2}}$: $u_{L} = 0.8$\n- Right state at interface $x_{i+\\frac{1}{2}}$: $u_{R} = -0.2$\n- Dissipation parameter for Lax–Friedrichs flux: $\\alpha = \\max(|u_{L}|, |u_{R}|)$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard exercise in numerical methods for hyperbolic conservation laws, specifically focusing on the well-known Burgers equation. It uses established concepts like the Godunov and Lax-Friedrichs numerical fluxes, which are fundamental to the field of computational fluid dynamics. The problem is well-posed, providing all necessary information ($u_L$, $u_R$, flux function, dissipation parameter rule) to uniquely determine the required quantities. The language is objective and precise. The problem is self-contained and consistent.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\nThe problem requires a three-step calculation: first, the Godunov flux $F_{\\mathrm{G}}$; second, the Lax-Friedrichs flux $F_{\\mathrm{LF}}$; and third, their difference $F_{\\mathrm{LF}} - F_{\\mathrm{G}}$.\n\n**1. Computation of the Godunov Flux ($F_{\\mathrm{G}}$)**\n\nThe Godunov flux is determined by the exact solution to the Riemann problem at the interface. The Riemann problem for the Burgers equation is defined by the initial condition:\n$$u(x,0) = \\begin{cases} u_{L} & \\text{if } x < 0 \\\\ u_{R} & \\text{if } x > 0 \\end{cases}$$\nwith $u_{L} = 0.8$ and $u_{R} = -0.2$. The characteristic speed is given by $a(u) = f'(u) = u$.\n\nSince the characteristic speed of the left state, $a(u_{L}) = u_{L} = 0.8$, is greater than the characteristic speed of the right state, $a(u_{R}) = u_{R} = -0.2$, the characteristics will intersect, forming a shock wave. The speed of this shock, $s$, is determined by the Rankine-Hugoniot jump condition:\n$$s = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}}$$\nFor the Burgers equation, this simplifies to:\n$$s = \\frac{\\frac{1}{2}u_{R}^{2} - \\frac{1}{2}u_{L}^{2}}{u_{R} - u_{L}} = \\frac{1}{2} \\frac{(u_{R}-u_{L})(u_{R}+u_{L})}{u_{R}-u_{L}} = \\frac{u_{L} + u_{R}}{2}$$\nSubstituting the given values:\n$$s = \\frac{0.8 + (-0.2)}{2} = \\frac{0.6}{2} = 0.3$$\nWe must verify that this shock satisfies the Lax entropy condition, which states that characteristics must flow into the shock: $a(u_{L}) > s > a(u_{R})$.\n$$0.8 > 0.3 > -0.2$$\nThe condition is satisfied.\n\nThe self-similar solution to the Riemann problem is a function of $\\xi = x/t$. As the shock speed $s = 0.3$ is positive, the shock front moves to the right. For any time $t > 0$, the state at the interface location $x=0$ (i.e., $\\xi=0$) is the state to the left of the shock, which is $u_{L}$.\nTherefore, the state to be used for the Godunov flux calculation is $u_{\\mathrm{G}} = u_{L} = 0.8$.\nThe Godunov flux is then:\n$$F_{\\mathrm{G}} = f(u_{\\mathrm{G}}) = f(u_{L}) = \\frac{1}{2}u_{L}^{2} = \\frac{1}{2}(0.8)^{2} = \\frac{1}{2}(0.64) = 0.32$$\n\n**2. Computation of the Lax–Friedrichs Flux ($F_{\\mathrm{LF}}$)**\n\nThe Lax-Friedrichs numerical flux (also known as the Rusanov flux) is given by the formula:\n$$F_{\\mathrm{LF}} = \\frac{1}{2} \\left[ f(u_{L}) + f(u_{R}) - \\alpha(u_{R} - u_{L}) \\right]$$\nThe dissipation parameter $\\alpha$ is defined as the maximum magnitude of the characteristic speeds at the interface:\n$$\\alpha = \\max(|a(u_L)|, |a(u_R)|) = \\max(|u_{L}|, |u_{R}|)$$\nSubstituting the given values:\n$$\\alpha = \\max(|0.8|, |-0.2|) = \\max(0.8, 0.2) = 0.8$$\nNext, we compute the flux values for the left and right states:\n$$f(u_{L}) = \\frac{1}{2}u_{L}^{2} = \\frac{1}{2}(0.8)^{2} = 0.32$$\n$$f(u_{R}) = \\frac{1}{2}u_{R}^{2} = \\frac{1}{2}(-0.2)^{2} = \\frac{1}{2}(0.04) = 0.02$$\nNow we substitute these quantities into the Lax-Friedrichs flux formula:\n$$F_{\\mathrm{LF}} = \\frac{1}{2} \\left[ (0.32) + (0.02) - (0.8)((-0.2) - (0.8)) \\right]$$\n$$F_{\\mathrm{LF}} = \\frac{1}{2} \\left[ 0.34 - 0.8(-1.0) \\right]$$\n$$F_{\\mathrm{LF}} = \\frac{1}{2} \\left[ 0.34 + 0.8 \\right]$$\n$$F_{\\mathrm{LF}} = \\frac{1}{2} (1.14) = 0.57$$\n\n**3. Computation of the Difference**\n\nThe final step is to compute the difference between the Lax-Friedrichs flux and the Godunov flux:\n$$F_{\\mathrm{LF}} - F_{\\mathrm{G}} = 0.57 - 0.32 = 0.25$$\nThe problem requires the answer to be rounded to four significant figures. This gives $0.2500$.",
            "answer": "$$\\boxed{0.2500}$$"
        },
        {
            "introduction": "Next, we extend our analysis from a scalar equation to a system: the one-dimensional compressible Euler equations governing gas dynamics. This practice  requires you to compute the Rusanov flux (a local version of the Lax-Friedrichs flux) for a supersonic flow scenario. This will solidify your ability to apply the flux concept to a vector of conserved variables (mass, momentum, and energy) and compare its behavior to other schemes like flux-vector splitting.",
            "id": "3320859",
            "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma = 1.4$. Let an interface separate two constant states with primitive variables given by the left state $(\\rho_{L}, u_{L}, p_{L}) = (\\,1.2\\,\\text{kg}\\,\\text{m}^{-3},\\, 600\\,\\text{m}\\,\\text{s}^{-1},\\, 2.0 \\times 10^{5}\\,\\text{Pa}\\,)$ and the right state $(\\rho_{R}, u_{R}, p_{R}) = (\\,0.8\\,\\text{kg}\\,\\text{m}^{-3},\\, 700\\,\\text{m}\\,\\text{s}^{-1},\\, 1.0 \\times 10^{5}\\,\\text{Pa}\\,)$. Using first principles for flux vector splitting techniques in computational fluid dynamics, compute at this interface:\n- the mass-flux component produced by the Rusanov (local Lax–Friedrichs) numerical flux,\n- the mass-flux component produced by the Steger–Warming flux-vector splitting,\nand then form the scalar difference $\\Delta = f_{\\rho}^{\\text{Rusanov}} - f_{\\rho}^{\\text{SW}}$.\n\nYou must start from the Euler equations and their eigenstructure and use the ideal-gas relation for the speed of sound to justify each numerical flux construction before evaluating $\\Delta$ for the given states. Express the final $\\Delta$ in $\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$ and round your final answer to five significant figures.",
            "solution": "The problem requires the computation and comparison of the mass flux components from two distinct numerical flux schemes, Rusanov and Steger-Warming, at an interface between two specified fluid states. The governing equations are the one-dimensional compressible Euler equations, which can be written in conservative form as:\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial x} = 0\n$$\nwhere $\\mathbf{U}$ is the vector of conserved variables and $\\mathbf{F}$ is the flux vector. For an ideal gas, these are given by:\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad \\mathbf{F}(\\mathbf{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (E+p)u \\end{pmatrix}\n$$\nHere, $\\rho$ is the density, $u$ is the velocity, $p$ is the pressure, and $E$ is the total energy per unit volume. The total energy is related to the other variables by the equation of state for an ideal gas:\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2\n$$\nwhere $\\gamma$ is the ratio of specific heats, given as $\\gamma = 1.4$. The speed of sound, $c$, is given by:\n$$\nc = \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\nThe problem specifies two states, a left state (L) and a right state (R), at an interface.\nLeft state: $(\\rho_L, u_L, p_L) = (1.2\\,\\text{kg}\\,\\text{m}^{-3}, 600\\,\\text{m}\\,\\text{s}^{-1}, 2.0 \\times 10^{5}\\,\\text{Pa})$.\nRight state: $(\\rho_R, u_R, p_R) = (0.8\\,\\text{kg}\\,\\text{m}^{-3}, 700\\,\\text{m}\\,\\text{s}^{-1}, 1.0 \\times 10^{5}\\,\\text{Pa})$.\n\nFirst, we compute the derived quantities for each state.\n\nFor the left state (L):\nThe speed of sound is:\n$$\nc_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times (2.0 \\times 10^5)}{1.2}} = \\sqrt{\\frac{2.8 \\times 10^5}{1.2}} \\approx 483.0459\\,\\text{m}\\,\\text{s}^{-1}\n$$\nThe total energy is:\n$$\nE_L = \\frac{p_L}{\\gamma-1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{2.0 \\times 10^5}{1.4-1} + \\frac{1}{2}(1.2)(600)^2 = 5.0 \\times 10^5 + 2.16 \\times 10^5 = 7.16 \\times 10^5\\,\\text{J}\\,\\text{m}^{-3}\n$$\nThe state vector $\\mathbf{U}_L$ and flux vector $\\mathbf{F}_L$ are:\n$$\n\\mathbf{U}_L = \\begin{pmatrix} \\rho_L \\\\ \\rho_L u_L \\\\ E_L \\end{pmatrix} = \\begin{pmatrix} 1.2 \\\\ 1.2 \\times 600 \\\\ 7.16 \\times 10^5 \\end{pmatrix} = \\begin{pmatrix} 1.2 \\\\ 720 \\\\ 7.16 \\times 10^5 \\end{pmatrix}\n$$\n$$\n\\mathbf{F}_L = \\begin{pmatrix} \\rho_L u_L \\\\ \\rho_L u_L^2 + p_L \\\\ (E_L+p_L)u_L \\end{pmatrix} = \\begin{pmatrix} 720 \\\\ 1.2 \\times (600)^2 + 2.0 \\times 10^5 \\\\ (7.16 \\times 10^5 + 2.0 \\times 10^5) \\times 600 \\end{pmatrix} = \\begin{pmatrix} 720 \\\\ 6.32 \\times 10^5 \\\\ 5.496 \\times 10^8 \\end{pmatrix}\n$$\n\nFor the right state (R):\nThe speed of sound is:\n$$\nc_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times (1.0 \\times 10^5)}{0.8}} = \\sqrt{1.75 \\times 10^5} \\approx 418.3300\\,\\text{m}\\,\\text{s}^{-1}\n$$\nThe total energy is:\n$$\nE_R = \\frac{p_R}{\\gamma-1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{1.0 \\times 10^5}{1.4-1} + \\frac{1}{2}(0.8)(700)^2 = 2.5 \\times 10^5 + 1.96 \\times 10^5 = 4.46 \\times 10^5\\,\\text{J}\\,\\text{m}^{-3}\n$$\nThe state vector $\\mathbf{U}_R$ and flux vector $\\mathbf{F}_R$ are:\n$$\n\\mathbf{U}_R = \\begin{pmatrix} \\rho_R \\\\ \\rho_R u_R \\\\ E_R \\end{pmatrix} = \\begin{pmatrix} 0.8 \\\\ 0.8 \\times 700 \\\\ 4.46 \\times 10^5 \\end{pmatrix} = \\begin{pmatrix} 0.8 \\\\ 560 \\\\ 4.46 \\times 10^5 \\end{pmatrix}\n$$\n$$\n\\mathbf{F}_R = \\begin{pmatrix} \\rho_R u_R \\\\ \\rho_R u_R^2 + p_R \\\\ (E_R+p_R)u_R \\end{pmatrix} = \\begin{pmatrix} 560 \\\\ 0.8 \\times (700)^2 + 1.0 \\times 10^5 \\\\ (4.46 \\times 10^5 + 1.0 \\times 10^5) \\times 700 \\end{pmatrix} = \\begin{pmatrix} 560 \\\\ 4.92 \\times 10^5 \\\\ 3.822 \\times 10^8 \\end{pmatrix}\n$$\n\nNow we can compute the numerical fluxes.\n\n**Steger-Warming Flux-Vector Splitting**\nThe Steger-Warming scheme splits the flux vector $\\mathbf{F}$ into two parts, $\\mathbf{F}^+$ and $\\mathbf{F}^-$, based on the signs of the eigenvalues of the flux Jacobian matrix $A = \\partial \\mathbf{F} / \\partial \\mathbf{U}$. The eigenvalues of $A$ are $\\lambda_1 = u-c$, $\\lambda_2 = u$, and $\\lambda_3 = u+c$. The numerical flux at the interface is given by:\n$$\n\\mathbf{F}^{\\text{SW}} = \\mathbf{F}^+(\\mathbf{U}_L) + \\mathbf{F}^-(\\mathbf{U}_R)\n$$\nThe splitting is defined such that if all eigenvalues are positive, $\\mathbf{F}^+ = \\mathbf{F}$ and $\\mathbf{F}^- = \\mathbf{0}$. If all eigenvalues are negative, $\\mathbf{F}^+ = \\mathbf{0}$ and $\\mathbf{F}^- = \\mathbf{F}$.\nFor the left state, $u_L = 600$ and $c_L \\approx 483.05$. Since $u_L > c_L > 0$, the flow is supersonic. All eigenvalues for state L are positive:\n$\\lambda_{1,L} = u_L - c_L > 0$\n$\\lambda_{2,L} = u_L > 0$\n$\\lambda_{3,L} = u_L + c_L > 0$\nTherefore, for state L, the split fluxes are $\\mathbf{F}^+(\\mathbf{U}_L) = \\mathbf{F}_L$ and $\\mathbf{F}^-(\\mathbf{U}_L) = \\mathbf{0}$.\n\nFor the right state, $u_R = 700$ and $c_R \\approx 418.33$. Since $u_R > c_R > 0$, the flow is also supersonic. All eigenvalues for state R are positive:\n$\\lambda_{1,R} = u_R - c_R > 0$\n$\\lambda_{2,R} = u_R > 0$\n$\\lambda_{3,R} = u_R + c_R > 0$\nTherefore, for state R, the split fluxes are $\\mathbf{F}^+(\\mathbf{U}_R) = \\mathbf{F}_R$ and $\\mathbf{F}^-(\\mathbf{U}_R) = \\mathbf{0}$.\n\nSubstituting these into the formula for the interface flux:\n$$\n\\mathbf{F}^{\\text{SW}} = \\mathbf{F}^+(\\mathbf{U}_L) + \\mathbf{F}^-(\\mathbf{U}_R) = \\mathbf{F}_L + \\mathbf{0} = \\mathbf{F}_L\n$$\nThe mass-flux component, $f_{\\rho}^{\\text{SW}}$, is the first component of $\\mathbf{F}^{\\text{SW}}$, which is the first component of $\\mathbf{F}_L$:\n$$\nf_{\\rho}^{\\text{SW}} = (\\rho u)_L = 1.2 \\times 600 = 720\\,\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n\n**Rusanov (Local Lax-Friedrichs) Flux**\nThe Rusanov flux is defined as:\n$$\n\\mathbf{F}^{\\text{Rusanov}} = \\frac{1}{2}(\\mathbf{F}_L + \\mathbf{F}_R) - \\frac{S_{\\max}}{2}(\\mathbf{U}_R - \\mathbf{U}_L)\n$$\nwhere $S_{\\max}$ is the maximum local signal speed at the interface, given by:\n$$\nS_{\\max} = \\max(|u_L| + c_L, |u_R| + c_R)\n$$\nUsing the previously computed values:\n$|u_L| + c_L = 600 + 483.0459 = 1083.0459\\,\\text{m}\\,\\text{s}^{-1}$\n$|u_R| + c_R = 700 + 418.3300 = 1118.3300\\,\\text{m}\\,\\text{s}^{-1}$\nSo, $S_{\\max} = 1118.3300\\,\\text{m}\\,\\text{s}^{-1}$.\n\nWe need the mass-flux component, $f_{\\rho}^{\\text{Rusanov}}$, which is the first component of the vector $\\mathbf{F}^{\\text{Rusanov}}$:\n$$\nf_{\\rho}^{\\text{Rusanov}} = \\frac{1}{2}((\\rho u)_L + (\\rho u)_R) - \\frac{S_{\\max}}{2}(\\rho_R - \\rho_L)\n$$\nSubstituting the numerical values:\n$$\nf_{\\rho}^{\\text{Rusanov}} = \\frac{1}{2}(720 + 560) - \\frac{1118.3300}{2}(0.8 - 1.2)\n$$\n$$\nf_{\\rho}^{\\text{Rusanov}} = \\frac{1}{2}(1280) - (559.1650)( -0.4)\n$$\n$$\nf_{\\rho}^{\\text{Rusanov}} = 640 + 223.6660 = 863.6660\\,\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n\n**Difference $\\Delta$**\nFinally, we compute the difference $\\Delta = f_{\\rho}^{\\text{Rusanov}} - f_{\\rho}^{\\text{SW}}$:\n$$\n\\Delta = 863.6660 - 720 = 143.6660\\,\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\nRounding the result to five significant figures, as requested:\n$$\n\\Delta \\approx 143.67\\,\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$",
            "answer": "$$\n\\boxed{143.67}\n$$"
        },
        {
            "introduction": "While robust, the Lax-Friedrichs and Rusanov fluxes possess known limitations. This final exercise  challenges you to investigate a crucial one: the excessive smearing of contact discontinuities, which are common features in gas dynamics. By implementing and testing the Rusanov flux alongside more advanced schemes like Roe and HLLC, you will quantitatively assess their performance and appreciate why resolving such structures accurately is a key driver in the development of modern numerical fluxes.",
            "id": "3376114",
            "problem": "Consider the compressible Euler equations in conservative form for a perfect gas with ratio of specific heats $\\gamma$, written as $\\partial_t \\boldsymbol{U} + \\nabla \\cdot \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0}$ with conservative variables $\\boldsymbol{U} = [\\rho, \\rho \\boldsymbol{u}, E]^\\top$ and physical flux $\\boldsymbol{F}(\\boldsymbol{U}) = [\\rho \\boldsymbol{u}, \\rho \\boldsymbol{u} \\otimes \\boldsymbol{u} + p \\boldsymbol{I}, (E + p) \\boldsymbol{u}]$, where $\\rho$ is the density, $\\boldsymbol{u} \\in \\mathbb{R}^3$ is the velocity, $E$ is the total energy, $p$ is the pressure, and $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2} \\rho \\|\\boldsymbol{u}\\|^2\\right)$. In a Discontinuous Galerkin (DG) method, the interface coupling is effected by a numerical flux $\\widehat{\\boldsymbol{F}}_n(\\boldsymbol{U}_L, \\boldsymbol{U}_R; \\boldsymbol{n})$ acting on each face with unit normal $\\boldsymbol{n}$, approximating the normal flux $\\boldsymbol{F}_n(\\boldsymbol{U}) := \\boldsymbol{F}(\\boldsymbol{U}) \\cdot \\boldsymbol{n} = [\\rho u_n, \\rho \\boldsymbol{u} u_n + p \\boldsymbol{n}, (E + p) u_n]^\\top$, where $u_n := \\boldsymbol{u} \\cdot \\boldsymbol{n}$.\n\nA planar contact discontinuity for the Euler equations is characterized by equal pressure and equal normal velocity across the interface, but possibly different density and tangential velocity. In particular, for left and right states with $(\\rho_L, \\boldsymbol{u}_L, p_L)$ and $(\\rho_R, \\boldsymbol{u}_R, p_R)$ and a unit normal $\\boldsymbol{n}$, a planar contact discontinuity satisfies $p_L = p_R$ and $u_{n,L} = u_{n,R}$, where $u_{n,\\star} := \\boldsymbol{u}_\\star \\cdot \\boldsymbol{n}$. The exact Riemann solution across such a discontinuity yields a unique interface flux based on the upwind side with respect to the common normal velocity $u_n$: if $u_n > 0$, $\\boldsymbol{F}_{n,\\mathrm{exact}} = \\boldsymbol{F}_n(\\boldsymbol{U}_L)$; if $u_n < 0$, $\\boldsymbol{F}_{n,\\mathrm{exact}} = \\boldsymbol{F}_n(\\boldsymbol{U}_R)$; if $u_n = 0$, the interface flux is $\\boldsymbol{F}_{n,\\mathrm{exact}} = [0, p \\boldsymbol{n}, 0]^\\top$.\n\nTask: Starting from the definitions above and the Rankine–Hugoniot conditions for conservation laws, derive implementable formulas for three numerical fluxes across a face with unit normal $\\boldsymbol{n}$:\n- the local Lax–Friedrichs (Rusanov) flux, defined by a single characteristic speed bound,\n- the Roe flux constructed from the Roe linearization along $\\boldsymbol{n}$,\n- the Harten–Lax–van Leer–Contact (HLLC) flux along $\\boldsymbol{n}$.\n\nThen, for a set of test cases that isolate planar contacts with $p_L = p_R$ and $u_{n,L} = u_{n,R}$ but allow jumps in $\\rho$ and in the tangential velocity $\\boldsymbol{u}_t := \\boldsymbol{u} - u_n \\boldsymbol{n}$, compute, for each flux, the numerical interface flux $\\widehat{\\boldsymbol{F}}_n$ and compare it to the exact contact-preserving interface flux $\\boldsymbol{F}_{n,\\mathrm{exact}}$. Declare a flux to be “contact-preserving” on a given test if and only if the Euclidean norm of the flux error $\\|\\widehat{\\boldsymbol{F}}_n - \\boldsymbol{F}_{n,\\mathrm{exact}}\\|_2$ is less than or equal to a tolerance $\\varepsilon$ times $(1 + \\|\\boldsymbol{F}_{n,\\mathrm{exact}}\\|_2)$, where $\\varepsilon = 10^{-8}$.\n\nAll quantities are nondimensional. Use $\\gamma = 1.4$ in all cases. Use the following test suite, each specified by $(\\boldsymbol{n}, \\rho_L, \\boldsymbol{u}_L, p_L, \\rho_R, \\boldsymbol{u}_R, p_R)$, where $\\boldsymbol{n}$ is a unit vector and $\\boldsymbol{u}_\\star = (u_x, u_y, u_z)$:\n\n- Case A (stationary planar contact, axis-aligned normal): $\\boldsymbol{n} = (1, 0, 0)$, $\\rho_L = 1.0$, $\\boldsymbol{u}_L = (0, 0.5, 0)$, $p_L = 10^5$, $\\rho_R = 2.0$, $\\boldsymbol{u}_R = (0, -0.5, 0)$, $p_R = 10^5$.\n- Case B (moving planar contact with positive normal speed): $\\boldsymbol{n} = (1, 0, 0)$, $\\rho_L = 0.8$, $\\boldsymbol{u}_L = (100, 20, 0)$, $p_L = 10^5$, $\\rho_R = 1.2$, $\\boldsymbol{u}_R = (100, -30, 0)$, $p_R = 10^5$.\n- Case C (moving planar contact with negative normal speed): $\\boldsymbol{n} = (1, 0, 0)$, $\\rho_L = 1.5$, $\\boldsymbol{u}_L = (-50, 10, 0)$, $p_L = 10^5$, $\\rho_R = 0.7$, $\\boldsymbol{u}_R = (-50, -10, 0)$, $p_R = 10^5$.\n- Case D (oblique planar contact with positive normal speed): $\\boldsymbol{n} = \\frac{1}{\\sqrt{2}}(1, 1, 0)$, $\\rho_L = 1.0$, $\\boldsymbol{u}_L = 30 \\boldsymbol{n} + 15 \\boldsymbol{t}$, $p_L = 10^5$, $\\rho_R = 0.9$, $\\boldsymbol{u}_R = 30 \\boldsymbol{n} - 20 \\boldsymbol{t}$, $p_R = 10^5$, where $\\boldsymbol{t} = \\frac{1}{\\sqrt{2}}(1, -1, 0)$.\n\nFor each case, compute three booleans indicating whether each numerical flux (in the order Roe, Harten–Lax–van Leer–Contact, and Lax–Friedrichs) is contact-preserving according to the criterion above. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., “[result1,result2,result3,...]”), where each result is a boolean corresponding to a single flux on a single case, ordered in sequence Case A Roe, Case A Harten–Lax–van Leer–Contact, Case A Lax–Friedrichs, Case B Roe, Case B Harten–Lax–van Leer–Contact, Case B Lax–Friedrichs, and so on through Case D.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It presents a standard exercise in the analysis of numerical fluxes for hyperbolic conservation laws, specifically the compressible Euler equations. The physical model, mathematical equations, and definitions of numerical schemes (Lax-Friedrichs, Roe, HLLC) are standard in the field of computational fluid dynamics. The test cases are correctly constructed to represent planar contact discontinuities. Therefore, the problem is valid, and a solution will be provided.\n\nThe task is to derive the formulas for the Lax-Friedrichs (or Rusanov), Roe, and HLLC numerical fluxes and then to evaluate their ability to preserve contact discontinuities for the compressible Euler equations. A flux is deemed \"contact-preserving\" if the Euclidean norm of the error between the numerical flux and the exact flux for a contact wave is below a specified tolerance.\n\nLet the state vector of conservative variables be $\\boldsymbol{U} = [\\rho, \\rho u_x, \\rho u_y, \\rho u_z, E]^\\top \\in \\mathbb{R}^5$. The compressible Euler equations are given by $\\partial_t \\boldsymbol{U} + \\nabla \\cdot \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0}$. The pressure $p$ is given by the equation of state for a perfect gas, $p = (\\gamma-1)(E - \\frac{1}{2} \\rho \\|\\boldsymbol{u}\\|^2)$, where $\\gamma$ is the ratio of specific heats. The speed of sound is $c = \\sqrt{\\gamma p / \\rho}$.\n\nAt an interface with unit normal vector $\\boldsymbol{n}$, the flux is projected in the normal direction:\n$\\boldsymbol{F}_n(\\boldsymbol{U}) = \\boldsymbol{F}(\\boldsymbol{U}) \\cdot \\boldsymbol{n} = [\\rho u_n, \\rho u_x u_n + p n_x, \\rho u_y u_n + p n_y, \\rho u_z u_n + p n_z, (E+p)u_n]^\\top$, where $u_n = \\boldsymbol{u} \\cdot \\boldsymbol{n}$ is the normal velocity.\n\nA planar contact discontinuity between a left state $(\\rho_L, \\boldsymbol{u}_L, p_L)$ and a right state $(\\rho_R, \\boldsymbol{u}_R, p_R)$ is characterized by constant pressure $p_L = p_R = p$ and constant normal velocity $u_{n,L} = u_{n,R} = u_n$. The Rankine-Hugoniot condition for such a wave is $\\boldsymbol{F}_n(\\boldsymbol{U}_R) - \\boldsymbol{F}_n(\\boldsymbol{U}_L) = u_n(\\boldsymbol{U}_R - \\boldsymbol{U}_L)$. The exact flux at the interface, moving with speed $u_n$, is given by the upwind state:\n$$\n\\boldsymbol{F}_{n,\\mathrm{exact}} =\n\\begin{cases}\n    \\boldsymbol{F}_n(\\boldsymbol{U}_L) & \\text{if } u_n > 0 \\\\\n    \\boldsymbol{F}_n(\\boldsymbol{U}_R) & \\text{if } u_n < 0 \\\\\n    [0, p n_x, p n_y, p n_z, 0]^\\top & \\text{if } u_n = 0\n\\end{cases}\n$$\nWe now derive the formulas for the three requested numerical fluxes.\n\n### Derivation of Numerical Fluxes\n\n#### 1. Local Lax–Friedrichs (Rusanov) Flux\nThe local Lax–Friedrichs flux, also known as the Rusanov flux, is a simple, robust, but dissipative scheme. It is constructed by averaging the physical fluxes and adding a numerical dissipation term proportional to the jump in the conservative variables.\n$$\n\\widehat{\\boldsymbol{F}}_n^{LF}(\\boldsymbol{U}_L, \\boldsymbol{U}_R) = \\frac{1}{2} \\left[ \\boldsymbol{F}_n(\\boldsymbol{U}_L) + \\boldsymbol{F}_n(\\boldsymbol{U}_R) \\right] - \\frac{\\alpha}{2} \\left[ \\boldsymbol{U}_R - \\boldsymbol{U}_L \\right]\n$$\nThe dissipation coefficient $\\alpha$ must be an upper bound on the fastest signal speeds propagating away from the interface. The eigenvalues of the flux Jacobian $\\boldsymbol{A}_n = \\partial \\boldsymbol{F}_n / \\partial \\boldsymbol{U}$ are $\\{u_n, u_n, u_n, u_n+c, u_n-c\\}$. A suitable choice for $\\alpha$ (the Rusanov speed) is the maximum magnitude of the eigenvalues evaluated for the left and right states:\n$$\n\\alpha = \\max(|u_{n,L}| + c_L, |u_{n,R}| + c_R)\n$$\nFor a contact discontinuity, $u_{n,L} = u_{n,R} = u_n$, so $\\alpha = |u_n| + \\max(c_L, c_R)$. The flux introduces dissipation proportional to $\\alpha$, which is non-zero even if only density or tangential velocity jump. The error term for a contact with $u_n > 0$ is $\\widehat{\\boldsymbol{F}}_n^{LF} - \\boldsymbol{F}_{n,\\mathrm{exact}} = \\frac{1}{2}(u_n(\\boldsymbol{U}_R-\\boldsymbol{U}_L)) - \\frac{\\alpha}{2}(\\boldsymbol{U}_R-\\boldsymbol{U}_L) = \\frac{1}{2}(u_n - \\alpha)(\\boldsymbol{U}_R-\\boldsymbol{U}_L) = -\\frac{1}{2}\\max(c_L, c_R)(\\boldsymbol{U}_R-\\boldsymbol{U}_L)$. This error is generally non-zero, indicating that the LF/Rusanov flux is not contact-preserving.\n\n#### 2. Roe Flux\nThe Roe flux is designed to be exact for isolated discontinuities. It is defined as:\n$$\n\\widehat{\\boldsymbol{F}}_n^{Roe}(\\boldsymbol{U}_L, \\boldsymbol{U}_R) = \\frac{1}{2} \\left[ \\boldsymbol{F}_n(\\boldsymbol{U}_L) + \\boldsymbol{F}_n(\\boldsymbol{U}_R) \\right] - \\frac{1}{2} |\\hat{\\boldsymbol{A}}_n|(\\boldsymbol{U}_R - \\boldsymbol{U}_L)\n$$\nwhere $\\hat{\\boldsymbol{A}}_n = \\boldsymbol{A}_n(\\hat{\\boldsymbol{U}})$ is the flux Jacobian evaluated at a specially constructed Roe-averaged state $\\hat{\\boldsymbol{U}}$. The Roe-averaged state satisfies the property $\\boldsymbol{F}_n(\\boldsymbol{U}_R) - \\boldsymbol{F}_n(\\boldsymbol{U}_L) = \\hat{\\boldsymbol{A}}_n(\\boldsymbol{U}_R - \\boldsymbol{U}_L)$. The Roe averages for specific enthalpy $h=(E+p)/\\rho$, velocity $\\boldsymbol{u}$, and density $\\rho$ are:\n$$\n\\hat{\\rho} = \\sqrt{\\rho_L \\rho_R}, \\quad \\hat{\\boldsymbol{u}} = \\frac{\\sqrt{\\rho_L} \\boldsymbol{u}_L + \\sqrt{\\rho_R} \\boldsymbol{u}_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}, \\quad \\hat{h} = \\frac{\\sqrt{\\rho_L} h_L + \\sqrt{\\rho_R} h_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\nFor a contact discontinuity, the Rankine-Hugoniot condition gives $\\boldsymbol{F}_n(\\boldsymbol{U}_R) - \\boldsymbol{F}_n(\\boldsymbol{U}_L) = u_n(\\boldsymbol{U}_R - \\boldsymbol{U}_L)$. Combining this with the Roe property, we get $\\hat{\\boldsymbol{A}}_n(\\boldsymbol{U}_R - \\boldsymbol{U}_L) = u_n(\\boldsymbol{U}_R - \\boldsymbol{U}_L)$. This shows that for a contact, the jump vector $\\Delta\\boldsymbol{U} = \\boldsymbol{U}_R - \\boldsymbol{U}_L$ is an eigenvector of the Roe matrix $\\hat{\\boldsymbol{A}}_n$ with eigenvalue $u_n$. Also, for a contact, the Roe-averaged normal velocity is $\\hat{u}_n = \\hat{\\boldsymbol{u}} \\cdot \\boldsymbol{n} = u_n$. The dissipation term becomes:\n$$\n|\\hat{\\boldsymbol{A}}_n|(\\boldsymbol{U}_R - \\boldsymbol{U}_L) = |u_n|(\\boldsymbol{U}_R - \\boldsymbol{U}_L)\n$$\nSubstituting this into the Roe flux definition:\n$$\n\\widehat{\\boldsymbol{F}}_n^{Roe} = \\frac{1}{2} \\left[ \\boldsymbol{F}_n(\\boldsymbol{U}_L) + \\boldsymbol{F}_n(\\boldsymbol{U}_R) \\right] - \\frac{1}{2} |u_n|(\\boldsymbol{U}_R - \\boldsymbol{U}_L)\n$$\nIf $u_n > 0$, we use $|u_n| = u_n$ and $\\boldsymbol{F}_n(\\boldsymbol{U}_R) = \\boldsymbol{F}_n(\\boldsymbol{U}_L) + u_n(\\boldsymbol{U}_R - \\boldsymbol{U}_L)$:\n$\\widehat{\\boldsymbol{F}}_n^{Roe} = \\frac{1}{2}(\\boldsymbol{F}_n(\\boldsymbol{U}_L) + \\boldsymbol{F}_n(\\boldsymbol{U}_L) + u_n(\\boldsymbol{U}_R - \\boldsymbol{U}_L)) - \\frac{1}{2}u_n(\\boldsymbol{U}_R - \\boldsymbol{U}_L) = \\boldsymbol{F}_n(\\boldsymbol{U}_L)$, which is the exact flux.\nIf $u_n < 0$, we use $|u_n| = -u_n$ and $\\boldsymbol{F}_n(\\boldsymbol{U}_L) = \\boldsymbol{F}_n(\\boldsymbol{U}_R) - u_n(\\boldsymbol{U}_R - \\boldsymbol{U}_L)$:\n$\\widehat{\\boldsymbol{F}}_n^{Roe} = \\frac{1}{2}(\\boldsymbol{F}_n(\\boldsymbol{U}_R) - u_n(\\boldsymbol{U}_R - \\boldsymbol{U}_L) + \\boldsymbol{F}_n(\\boldsymbol{U}_R)) + \\frac{1}{2}u_n(\\boldsymbol{U}_R - \\boldsymbol{U}_L) = \\boldsymbol{F}_n(\\boldsymbol{U}_R)$, which is the exact flux.\nIf $u_n = 0$, the dissipation is zero, and $\\widehat{\\boldsymbol{F}}_n^{Roe} = \\frac{1}{2}(\\boldsymbol{F}_n(\\boldsymbol{U}_L) + \\boldsymbol{F}_n(\\boldsymbol{U}_R))$. Since $u_n=0$, $\\boldsymbol{F}_n(\\boldsymbol{U}_L) = \\boldsymbol{F}_n(\\boldsymbol{U}_R) = [0, p\\boldsymbol{n}, 0]^\\top$, so the Roe flux is exact.\nThus, the Roe flux is theoretically exact for contact discontinuities.\n\n#### 3. Harten–Lax–van Leer–Contact (HLLC) Flux\nThe HLLC flux is an extension of the HLL flux that reintroduces the missing contact wave structure. It assumes a Riemann fan consisting of three waves with speeds $S_L$ (leftmost), $S_M$ (middle/contact), and $S_R$ (rightmost), separating four constant states: $\\boldsymbol{U}_L, \\boldsymbol{U}_L^*, \\boldsymbol{U}_R^*, \\boldsymbol{U}_R$.\nThe wave speeds $S_L$ and $S_R$ are estimated. A common choice (Davis' estimates) is:\n$$\nS_L = \\min(u_{n,L}, u_{n,R}) - \\max(c_L, c_R), \\quad S_R = \\max(u_{n,L}, u_{n,R}) + \\max(c_L, c_R)\n$$\nThe contact speed $S_M$ is derived from the Rankine-Hugoniot conditions applied to the full system:\n$$\nS_M = \\frac{p_R - p_L + \\rho_L u_{n,L}(S_L - u_{n,L}) - \\rho_R u_{n,R}(S_R - u_{n,R})}{\\rho_L(S_L - u_{n,L}) - \\rho_R(S_R - u_{n,R})}\n$$\nFor a contact discontinuity, $p_L=p_R$ and $u_{n,L}=u_{n,R}=u_n$, which simplifies $S_M$ to:\n$$\nS_M = \\frac{\\rho_L u_n(S_L - u_n) - \\rho_R u_n(S_R - u_n)}{\\rho_L(S_L - u_n) - \\rho_R(S_R - u_n)} = u_n\n$$\nThe HLLC flux is then selected based on the location of the interface ($x/t=0$) relative to the wave speeds:\n$$\n\\widehat{\\boldsymbol{F}}_n^{HLLC} = \\begin{cases}\n    \\boldsymbol{F}_n(\\boldsymbol{U}_L) & \\text{if } 0 \\le S_L \\\\\n    \\boldsymbol{F}_L^* = \\boldsymbol{F}_n(\\boldsymbol{U}_L) + S_L(\\boldsymbol{U}_L^* - \\boldsymbol{U}_L) & \\text{if } S_L < 0 \\le S_M \\\\\n    \\boldsymbol{F}_R^* = \\boldsymbol{F}_n(\\boldsymbol{U}_R) + S_R(\\boldsymbol{U}_R^* - \\boldsymbol{U}_R) & \\text{if } S_M < 0 < S_R \\\\\n    \\boldsymbol{F}_n(\\boldsymbol{U}_R) & \\text{if } 0 \\ge S_R\n\\end{cases}\n$$\nThe intermediate states $\\boldsymbol{U}_k^*$ ($k=L,R$) are found by applying the Rankine-Hugoniot conditions across the $S_L$ and $S_R$ waves. One can show that for a contact, $\\boldsymbol{U}_L^* = \\boldsymbol{U}_L$ and $\\boldsymbol{U}_R^* = \\boldsymbol{U}_R$. Let's verify for $\\boldsymbol{U}_L^*$. The pressure and normal velocity in the star region are $p^*$ and $S_M$. For a contact, $p^* = p_L + \\rho_L(u_{n,L}-S_L)(u_{n,L}-S_M) = p_L + \\rho_L(u_n-S_L)(u_n-u_n) = p_L=p$. And $u_{n,L}^*=S_M=u_n$. The tangential velocity is unchanged, $\\boldsymbol{u}_{t,L}^*=\\boldsymbol{u}_{t,L}$. The density is $\\rho_L^* = \\rho_L \\frac{S_L-u_{n,L}}{S_L-S_M} = \\rho_L \\frac{S_L-u_n}{S_L-u_n} = \\rho_L$. Since $(\\rho_L, \\boldsymbol{u}_L, p_L)$ are identical to $(\\rho_L^*, \\boldsymbol{u}_L^*, p_L^*)$, we have $\\boldsymbol{U}_L^* = \\boldsymbol{U}_L$. Similarly, $\\boldsymbol{U}_R^* = \\boldsymbol{U}_R$.\n- If $u_n > 0$ and subsonic ($S_L < 0 < S_R$), then $S_M=u_n>0$. The flux is $\\widehat{\\boldsymbol{F}}_n^{HLLC} = \\boldsymbol{F}_L^* = \\boldsymbol{F}_n(\\boldsymbol{U}_L) + S_L(\\boldsymbol{U}_L-\\boldsymbol{U}_L) = \\boldsymbol{F}_n(\\boldsymbol{U}_L)$.\n- If $u_n < 0$ and subsonic, then $S_M=u_n<0$. The flux is $\\widehat{\\boldsymbol{F}}_n^{HLLC} = \\boldsymbol{F}_R^* = \\boldsymbol{F}_n(\\boldsymbol{U}_R) + S_R(\\boldsymbol{U}_R-\\boldsymbol{U}_R) = \\boldsymbol{F}_n(\\boldsymbol{U}_R)$.\n- If $u_n = 0$, then $S_M=0$. The flux is $\\boldsymbol{F}_L^*$ or $\\boldsymbol{F}_R^*$. Both evaluate to $[0, p\\boldsymbol{n}, 0]^\\top$.\nIn all cases, the HLLC flux matches the exact flux. Therefore, HLLC is also theoretically contact-preserving.\n\nThe following implementation will compute these fluxes for the given test cases and verify these theoretical properties numerically.\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes numerical fluxes for the Euler equations,\n    testing their contact-preserving properties.\n    \"\"\"\n    gamma = 1.4\n    epsilon = 1e-8\n\n    test_cases = [\n        # Case A\n        {'n': np.array([1.0, 0.0, 0.0]),\n         'rho_L': 1.0, 'u_L': np.array([0.0, 0.5, 0.0]), 'p_L': 1e5,\n         'rho_R': 2.0, 'u_R': np.array([0.0, -0.5, 0.0]), 'p_R': 1e5},\n        # Case B\n        {'n': np.array([1.0, 0.0, 0.0]),\n         'rho_L': 0.8, 'u_L': np.array([100.0, 20.0, 0.0]), 'p_L': 1e5,\n         'rho_R': 1.2, 'u_R': np.array([100.0, -30.0, 0.0]), 'p_R': 1e5},\n        # Case C\n        {'n': np.array([1.0, 0.0, 0.0]),\n         'rho_L': 1.5, 'u_L': np.array([-50.0, 10.0, 0.0]), 'p_L': 1e5,\n         'rho_R': 0.7, 'u_R': np.array([-50.0, -10.0, 0.0]), 'p_R': 1e5},\n        # Case D\n        {'n': np.array([1.0/np.sqrt(2), 1.0/np.sqrt(2), 0.0]),\n         'rho_L': 1.0, 'p_L': 1e5,\n         'rho_R': 0.9, 'p_R': 1e5,\n         'u_L': 30 * np.array([1.0/np.sqrt(2), 1.0/np.sqrt(2), 0.0]) + 15 * np.array([1.0/np.sqrt(2), -1.0/np.sqrt(2), 0.0]),\n         'u_R': 30 * np.array([1.0/np.sqrt(2), 1.0/np.sqrt(2), 0.0]) - 20 * np.array([1.0/np.sqrt(2), -1.0/np.sqrt(2), 0.0])\n        }\n    ]\n\n    def get_conservative_state(rho, u, p, gamma_val):\n        \"\"\"Computes conservative state U from primitive variables.\"\"\"\n        E = p / (gamma_val - 1.0) + 0.5 * rho * np.dot(u, u)\n        return np.array([rho, rho * u[0], rho * u[1], rho * u[2], E])\n\n    def get_physical_flux(rho, u, p, n, E, gamma_val):\n        \"\"\"Computes the physical flux vector F_n.\"\"\"\n        u_n = np.dot(u, n)\n        return np.array([\n            rho * u_n,\n            rho * u[0] * u_n + p * n[0],\n            rho * u[1] * u_n + p * n[1],\n            rho * u[2] * u_n + p * n[2],\n            (E + p) * u_n\n        ])\n\n    def flux_lf(U_L, U_R, F_n_L, F_n_R, u_n_L, c_L, u_n_R, c_R):\n        alpha = max(abs(u_n_L) + c_L, abs(u_n_R) + c_R)\n        return 0.5 * (F_n_L + F_n_R) - 0.5 * alpha * (U_R - U_L)\n\n    def flux_roe(U_L, U_R, F_n_L, F_n_R, u_n_L):\n        # For a contact, the Roe flux simplifies significantly\n        F_roe = 0.5 * (F_n_L + F_n_R) - 0.5 * abs(u_n_L) * (U_R - U_L)\n        return F_roe\n\n    def flux_hllc(n, rho_L, u_L, p_L, E_L, c_L, U_L, F_n_L,\n                  rho_R, u_R, p_R, E_R, c_R, U_R, F_n_R, gamma_val):\n        u_n_L = np.dot(u_L, n)\n        u_n_R = np.dot(u_R, n)\n\n        # Wave speed estimates (Davis)\n        S_L = min(u_n_L, u_n_R) - max(c_L, c_R)\n        S_R = max(u_n_L, u_n_R) + max(c_L, c_R)\n        \n        # S_M based on pressure equality in the star region\n        num = p_R - p_L + rho_L * u_n_L * (S_L - u_n_L) - rho_R * u_n_R * (S_R - u_n_R)\n        den = rho_L * (S_L - u_n_L) - rho_R * (S_R - u_n_R)\n        S_M = num / den\n\n        if S_L >= 0:\n            return F_n_L\n        elif S_R = 0:\n            return F_n_R\n        else: # S_L  0 and S_R > 0\n            if S_M >= 0:\n                p_star = p_L + rho_L * (u_n_L - S_L) * (u_n_L - S_M)\n                rho_star_L = rho_L * (S_L - u_n_L) / (S_L - S_M)\n                u_t_L = u_L - u_n_L * n\n                u_star_L = S_M * n + u_t_L\n                \n                E_star_L = (p_star / (gamma_val - 1.0)) + 0.5 * rho_star_L * np.dot(u_star_L, u_star_L)\n                U_star_L = np.array([rho_star_L, rho_star_L * u_star_L[0], rho_star_L * u_star_L[1], rho_star_L * u_star_L[2], E_star_L])\n\n                return F_n_L + S_L * (U_star_L - U_L)\n            else: # S_M  0\n                p_star = p_R + rho_R * (u_n_R - S_R) * (u_n_R - S_M)\n                rho_star_R = rho_R * (S_R - u_n_R) / (S_R - S_M)\n                u_t_R = u_R - u_n_R * n\n                u_star_R = S_M * n + u_t_R\n                \n                E_star_R = (p_star / (gamma_val - 1.0)) + 0.5 * rho_star_R * np.dot(u_star_R, u_star_R)\n                U_star_R = np.array([rho_star_R, rho_star_R * u_star_R[0], rho_star_R * u_star_R[1], rho_star_R * u_star_R[2], E_star_R])\n\n                return F_n_R + S_R * (U_star_R - U_R)\n\n    def check_preservation(F_num, F_exact, tol):\n        error_norm = np.linalg.norm(F_num - F_exact)\n        f_norm = np.linalg.norm(F_exact)\n        return error_norm = tol * (1.0 + f_norm)\n\n    results = []\n\n    for case in test_cases:\n        n = case['n']\n        rho_L, u_L, p_L = case['rho_L'], case['u_L'], case['p_L']\n        rho_R, u_R, p_R = case['rho_R'], case['u_R'], case['p_R']\n        \n        # Left state properties\n        E_L = p_L / (gamma - 1.0) + 0.5 * rho_L * np.dot(u_L, u_L)\n        U_L = get_conservative_state(rho_L, u_L, p_L, gamma)\n        c_L = np.sqrt(gamma * p_L / rho_L)\n        u_n_L = np.dot(u_L, n)\n        F_n_L = get_physical_flux(rho_L, u_L, p_L, n, E_L, gamma)\n\n        # Right state properties\n        E_R = p_R / (gamma - 1.0) + 0.5 * rho_R * np.dot(u_R, u_R)\n        U_R = get_conservative_state(rho_R, u_R, p_R, gamma)\n        c_R = np.sqrt(gamma * p_R / rho_R)\n        u_n_R = np.dot(u_R, n)\n        F_n_R = get_physical_flux(rho_R, u_R, p_R, n, E_R, gamma)\n        \n        # Exact flux for contact\n        if u_n_L > 0:\n            F_exact = F_n_L\n        elif u_n_L  0:\n            F_exact = F_n_R\n        else:\n            F_exact = np.array([0.0, p_L * n[0], p_L * n[1], p_L * n[2], 0.0])\n            \n        # Roe Flux\n        F_roe_val = flux_roe(U_L, U_R, F_n_L, F_n_R, u_n_L)\n        results.append(check_preservation(F_roe_val, F_exact, epsilon))\n\n        # HLLC Flux\n        F_hllc_val = flux_hllc(n, rho_L, u_L, p_L, E_L, c_L, U_L, F_n_L,\n                               rho_R, u_R, p_R, E_R, c_R, U_R, F_n_R, gamma)\n        results.append(check_preservation(F_hllc_val, F_exact, epsilon))\n        \n        # LF Flux\n        F_lf_val = flux_lf(U_L, U_R, F_n_L, F_n_R, u_n_L, c_L, u_n_R, c_R)\n        results.append(check_preservation(F_lf_val, F_exact, epsilon))\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```",
            "answer": "`[True,True,False,True,True,False,True,True,False,True,True,False]`"
        }
    ]
}