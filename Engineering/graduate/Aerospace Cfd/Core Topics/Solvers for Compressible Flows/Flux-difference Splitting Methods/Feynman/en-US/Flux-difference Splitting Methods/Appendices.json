{
    "hands_on_practices": [
        {
            "introduction": "Understanding complex numerical methods often begins with applying them to a simplified model. The one-dimensional linear advection equation serves as the quintessential test case for numerical schemes designed for hyperbolic conservation laws. This exercise  guides you through the fundamental process of constructing a conservative numerical scheme from the principle of flux-difference splitting, showing how it naturally leads to an upwind-biased formulation. By performing a stability analysis, you will derive the famous Courant–Friedrichs–Lewy (CFL) condition, a cornerstone of explicit time-marching methods in CFD.",
            "id": "3960627",
            "problem": "Consider the one-dimensional linear advection equation in conservative form, $\\partial_t u + \\partial_x f(u) = 0$, with $f(u) = a u$, where $a \\in \\mathbb{R}$ is a constant advection speed. Let the spatial domain be discretized on a uniform grid with nodes $x_i = i \\Delta x$ and cell averages $u_i^n \\approx \\frac{1}{\\Delta x} \\int_{x_i - \\Delta x/2}^{x_i + \\Delta x/2} u(x, t^n) \\, dx$ advanced in time with a forward Euler step of size $\\Delta t$. The goal is to construct a first-order, conservative, flux-difference splitting (FDS) central scheme that is consistent with the physical propagation of characteristics and then determine its Courant–Friedrichs–Lewy (CFL) stability limit.\n\nStarting from the finite-volume semidiscrete form $\\frac{d}{dt} u_i(t) = -\\frac{1}{\\Delta x} \\left( F_{i+1/2}(t) - F_{i-1/2}(t) \\right)$, where $F_{i+1/2}$ denotes a numerical flux at the cell interface $x_{i+1/2}$, apply a flux-difference split in the sense of flux decomposition $f(u) = f^{+}(u) + f^{-}(u)$ with monotonicity properties $d f^{+} / d u \\ge 0$ and $d f^{-} / d u \\le 0$. Assume a symmetric linear split based on a characteristic speed parameter $\\alpha \\ge 0$, of the form $f^{\\pm}(u) = \\frac{1}{2}\\left( f(u) \\pm \\alpha u \\right)$, and construct a central scheme whose numerical fluxes at interfaces are built from $f^{+}$ and $f^{-}$ using only neighboring cell values.\n\nThen, perform a von Neumann (Fourier) stability analysis for the fully discrete scheme (forward Euler in time) under periodic boundary conditions, and determine the largest time step $\\Delta t_{\\max}$ that guarantees stability in terms of $a$ and $\\Delta x$, for the choice $\\alpha = |a|$ that minimally bounds the characteristic speeds of the linear advection equation.\n\nExpress your final result for the maximal allowable time step $\\Delta t_{\\max}$ as a closed-form analytic expression. No rounding is required. Define and use the full names of any acronyms (for example, Courant–Friedrichs–Lewy (CFL)) upon first appearance.",
            "solution": "The problem requires the construction and stability analysis of a first-order, conservative, flux-difference splitting scheme for the one-dimensional linear advection equation, $\\partial_t u + \\partial_x f(u) = 0$, where the flux is given by $f(u) = a u$ for a constant advection speed $a \\in \\mathbb{R}$. The scheme is to be formulated within a finite-volume framework on a uniform grid with cell width $\\Delta x$ and advanced in time using a forward Euler method with time step $\\Delta t$.\n\nThe semi-discrete finite-volume form of the equation for the cell average $u_i(t)$ is\n$$\n\\frac{d u_i}{d t} = -\\frac{1}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right)\n$$\nwhere $F_{i+1/2}$ is the numerical flux at the interface $x_{i+1/2}$ between cell $i$ and cell $i+1$.\n\nThe problem specifies a flux-difference splitting (FDS) approach based on the decomposition of the flux $f(u)$ into positive- and negative-going parts, $f(u) = f^{+}(u) + f^{-}(u)$. These split fluxes must satisfy the monotonicity properties $d f^{+} / d u \\ge 0$ and $d f^{-} / d u \\le 0$, which ensures that they correspond to waves propagating in opposite directions. The prescribed form of the split is\n$$\nf^{\\pm}(u) = \\frac{1}{2}\\left( f(u) \\pm \\alpha u \\right)\n$$\nwith the parameter $\\alpha$ chosen as $\\alpha = |a|$. Let us verify the monotonicity conditions for this choice. The derivatives of the split fluxes with respect to $u$ are:\n$$\n\\frac{d f^{+}}{d u} = \\frac{1}{2}\\left( \\frac{d f}{d u} + \\alpha \\right) = \\frac{1}{2}(a + |a|)\n$$\n$$\n\\frac{d f^{-}}{d u} = \\frac{1}{2}\\left( \\frac{d f}{d u} - \\alpha \\right) = \\frac{1}{2}(a - |a|)\n$$\nIf $a > 0$, then $|a|=a$, so $\\frac{d f^{+}}{d u} = \\frac{1}{2}(a+a) = a > 0$ and $\\frac{d f^{-}}{d u} = \\frac{1}{2}(a-a) = 0$.\nIf $a < 0$, then $|a|=-a$, so $\\frac{d f^{+}}{d u} = \\frac{1}{2}(a-a) = 0$ and $\\frac{d f^{-}}{d u} = \\frac{1}{2}(a - (-a)) = a < 0$.\nIf $a = 0$, both derivatives are $0$.\nIn all cases, the conditions $\\frac{d f^{+}}{d u} \\ge 0$ and $\\frac{d f^{-}}{d u} \\le 0$ are satisfied. This choice for $\\alpha$ correctly separates the flux according to the sign of the characteristic speed $a$.\n\nA numerical flux consistent with this splitting is constructed based on the direction of information propagation. The positive-going flux $f^{+}$ propagates information to the right and should thus be evaluated using the state from the left cell, $u_i$. The negative-going flux $f^{-}$ propagates information to the left and should be evaluated using the state from the right cell, $u_{i+1}$. This leads to the Steger-Warming flux-vector splitting form for the numerical flux at interface $x_{i+1/2}$:\n$$\nF_{i+1/2} = f^{+}(u_i) + f^{-}(u_{i+1})\n$$\nSubstituting the expressions for $f^{\\pm}$:\n$$\nF_{i+1/2} = \\frac{1}{2}(a u_i + |a| u_i) + \\frac{1}{2}(a u_{i+1} - |a| u_{i+1}) = \\frac{1}{2}a(u_i + u_{i+1}) - \\frac{1}{2}|a|(u_{i+1} - u_i)\n$$\nThis flux can be interpreted as a central difference flux, $\\frac{1}{2}(f(u_i)+f(u_{i+1}))$, with an added numerical dissipation term, $-\\frac{1}{2}|a|(u_{i+1}-u_i)$.\n\nThe fully discrete scheme using forward Euler time integration is $u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}(F_{i+1/2}^n - F_{i-1/2}^n)$. To proceed, we express the flux difference:\n$$\nF_{i+1/2}^n - F_{i-1/2}^n = \\left[ f^{+}(u_i^n) + f^{-}(u_{i+1}^n) \\right] - \\left[ f^{+}(u_{i-1}^n) + f^{-}(u_i^n) \\right]\n$$\nUsing the definitions of $f^{\\pm}(u)$ with $\\alpha = |a|$:\n$$\nF_{i+1/2}^n - F_{i-1/2}^n = \\frac{1}{2}(a+|a|)u_i^n + \\frac{1}{2}(a-|a|)u_{i+1}^n - \\frac{1}{2}(a+|a|)u_{i-1}^n - \\frac{1}{2}(a-|a|)u_i^n\n$$\n$$\n= \\frac{1}{2}(a-|a|)u_{i+1}^n + \\frac{1}{2}[(a+|a|) - (a-|a|)]u_i^n - \\frac{1}{2}(a+|a|)u_{i-1}^n\n$$\n$$\n= \\frac{1}{2}(a-|a|)u_{i+1}^n + |a|u_i^n - \\frac{1}{2}(a+|a|)u_{i-1}^n\n$$\nIf $a > 0$, $|a|=a$, the flux difference becomes $0 \\cdot u_{i+1}^n + a u_i^n - a u_{i-1}^n = a(u_i^n - u_{i-1}^n)$.\nIf $a < 0$, $|a|=-a$, the flux difference becomes $a u_{i+1}^n - a u_i^n - 0 \\cdot u_{i-1}^n = a(u_{i+1}^n - u_i^n)$.\nThe resulting scheme is the first-order upwind scheme:\n$$\nu_i^{n+1} = \\begin{cases} u_i^n - \\frac{a \\Delta t}{\\Delta x}(u_i^n - u_{i-1}^n) & \\text{if } a > 0 \\\\ u_i^n - \\frac{a \\Delta t}{\\Delta x}(u_{i+1}^n - u_i^n) & \\text{if } a  0 \\end{cases}\n$$\nWe now perform a von Neumann stability analysis. We seek a solution of the form $u_j^n = G^n e^{I j k \\Delta x}$, where $k$ is the wavenumber, $I = \\sqrt{-1}$, and $G$ is the amplification factor. Let $\\phi = k \\Delta x$.\n\nCase $1$: $a  0$. Let the Courant number be $\\nu = \\frac{a \\Delta t}{\\Delta x}  0$.\nThe scheme is $u_i^{n+1} = u_i^n - \\nu(u_i^n - u_{i-1}^n)$. Substituting the Fourier mode:\n$$\nG^{n+1} e^{I j \\phi} = G^n e^{I j \\phi} - \\nu(G^n e^{I j \\phi} - G^n e^{I (j-1) \\phi})\n$$\nDividing by $G^n e^{I j \\phi}$ gives the amplification factor:\n$$\nG = 1 - \\nu(1 - e^{-I \\phi}) = 1 - \\nu(1 - \\cos\\phi + I\\sin\\phi) = (1 - \\nu + \\nu\\cos\\phi) - I\\nu\\sin\\phi\n$$\nThe squared magnitude of the amplification factor is:\n$$\n|G|^2 = (1 - \\nu + \\nu\\cos\\phi)^2 + (-\\nu\\sin\\phi)^2 = (1-\\nu)^2 + 2\\nu(1-\\nu)\\cos\\phi + \\nu^2\\cos^2\\phi + \\nu^2\\sin^2\\phi\n$$\n$$\n|G|^2 = 1 - 2\\nu + \\nu^2 + 2\\nu\\cos\\phi - 2\\nu^2\\cos\\phi + \\nu^2 = 1 - 2\\nu(1-\\cos\\phi) + 2\\nu^2(1-\\cos\\phi)\n$$\n$$\n|G|^2 = 1 + 2\\nu(\\nu-1)(1-\\cos\\phi)\n$$\nFor stability, we require $|G|^2 \\le 1$ for all $\\phi$. Since $1-\\cos\\phi \\ge 0$, and we know $\\nu  0$, stability requires $\\nu-1 \\le 0$, or $\\nu \\le 1$. Thus, for $a0$, we need $0  \\frac{a \\Delta t}{\\Delta x} \\le 1$.\n\nCase $2$: $a  0$. Let $\\nu = \\frac{a \\Delta t}{\\Delta x}  0$.\nThe scheme is $u_i^{n+1} = u_i^n - \\nu(u_{i+1}^n - u_i^n)$. Substituting the Fourier mode:\n$$\nG^{n+1} e^{I j \\phi} = G^n e^{I j \\phi} - \\nu(G^n e^{I (j+1) \\phi} - G^n e^{I j \\phi})\n$$\n$$\nG = 1 - \\nu(e^{I\\phi} - 1) = 1 - \\nu(\\cos\\phi - 1 + I\\sin\\phi) = (1 - \\nu(\\cos\\phi - 1)) - I\\nu\\sin\\phi\n$$\n$$\n|G|^2 = (1 + \\nu(1-\\cos\\phi))^2 + (-\\nu\\sin\\phi)^2 = 1 + 2\\nu(1-\\cos\\phi) + \\nu^2(1-\\cos\\phi)^2 + \\nu^2\\sin^2\\phi\n$$\n$$\n|G|^2 = 1 + 2\\nu(1-\\cos\\phi) + \\nu^2(1 - 2\\cos\\phi + \\cos^2\\phi + \\sin^2\\phi) = 1 + 2\\nu(1-\\cos\\phi) + 2\\nu^2(1-\\cos\\phi)\n$$\n$$\n|G|^2 = 1 + 2\\nu(\\nu+1)(1-\\cos\\phi)\n$$\nSince $1-\\cos\\phi \\ge 0$ and $\\nu  0$, stability requires $\\nu+1 \\ge 0$, or $\\nu \\ge -1$. Thus, for $a0$, we need $-1 \\le \\frac{a \\Delta t}{\\Delta x}  0$.\n\nCombining both cases, the stability condition is $-1 \\le \\frac{a \\Delta t}{\\Delta x} \\le 1$, which can be written compactly as:\n$$\n\\left| \\frac{a \\Delta t}{\\Delta x} \\right| \\le 1\n$$\nThis is the Courant–Friedrichs–Lewy (CFL) stability condition for the first-order upwind scheme. To find the largest possible time step $\\Delta t_{\\max}$ that guarantees stability, we take the equality:\n$$\n\\frac{|a| \\Delta t_{\\max}}{\\Delta x} = 1\n$$\nSolving for $\\Delta t_{\\max}$ (assuming $a \\neq 0$), we obtain:\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|a|}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\Delta x}{|a|}}\n$$"
        },
        {
            "introduction": "Moving from linear advection to the nonlinear Euler equations, Roe's flux-difference splitting scheme is a powerful and widely used tool. However, its accuracy relies on a linearization that can break down in certain scenarios, notably in transonic rarefactions, potentially leading to non-physical solutions like expansion shocks. This practice  addresses this critical issue by having you apply a Harten-style entropy fix, a small but crucial modification that adds numerical dissipation precisely where it is needed. This exercise will deepen your understanding of how to ensure the physical reliability and robustness of sophisticated numerical schemes.",
            "id": "3960583",
            "problem": "Consider the one-dimensional Euler equations for a calorically perfect gas with ratio of specific heats $\\gamma$, written in conservative form for the state vector $\\mathbf{U} = [\\rho, \\rho u, E_{tot}]^{\\top}$ and flux $\\mathbf{F}(\\mathbf{U}) = [\\rho u, \\rho u^{2} + p, u(E_{tot} + p)]^{\\top}$, where $\\rho$ is density, $u$ is velocity, $E_{tot}$ is total energy per unit volume, $p$ is pressure, and the speed of sound is $a = \\sqrt{\\gamma p / \\rho}$. A Roe flux-difference splitting at an interface uses a linearization with Roe-averaged quantities $(\\tilde{u}, \\tilde{a}, \\tilde{H})$ and the eigenstructure $\\tilde{\\lambda}_{1} = \\tilde{u} - \\tilde{a}$, $\\tilde{\\lambda}_{2} = \\tilde{u}$, $\\tilde{\\lambda}_{3} = \\tilde{u} + \\tilde{a}$, with corresponding right eigenvectors $\\mathbf{r}_{1}$, $\\mathbf{r}_{2}$, and $\\mathbf{r}_{3}$ in the conservative-variable basis. The dissipative portion of the Roe numerical flux at the interface is built from wave strengths $\\alpha_{k}$ and takes the form $-(1/2)\\sum_{k=1}^{3}|\\tilde{\\lambda}_{k}|\\,\\alpha_{k}\\,\\mathbf{r}_{k}$.\n\nIn the presence of a transonic rarefaction, the left-going acoustic eigenvalue $\\tilde{\\lambda}_{1} = \\tilde{u} - \\tilde{a}$ passes through zero, which in the unmodified Roe scheme can lead to insufficient dissipation and violation of the Second Law of Thermodynamics. To restore entropy consistency, apply the Harten entropy fix to each characteristic speed, replacing $|\\tilde{\\lambda}_{k}|$ by the modified speed $|\\tilde{\\lambda}_{k}|_{\\varepsilon}$ defined by\n$$\n|\\tilde{\\lambda}_{k}|_{\\varepsilon} =\n\\begin{cases}\n\\frac{\\tilde{\\lambda}_{k}^{2} + \\varepsilon^{2}}{2\\,\\varepsilon},  \\text{if } |\\tilde{\\lambda}_{k}|  \\varepsilon, \\\\\n|\\tilde{\\lambda}_{k}|,  \\text{otherwise},\n\\end{cases}\n$$\nwhere $\\varepsilon$ is a smoothing parameter with dimensions of speed, commonly taken as $\\varepsilon = \\kappa\\,\\tilde{a}$ for some dimensionless $\\kappa \\in (0,1)$.\n\nAssume a transonic rarefaction across the interface such that the Roe-averaged left-going acoustic speed exactly vanishes, i.e., $\\tilde{\\lambda}_{1} = \\tilde{u} - \\tilde{a} = 0$. Under the above entropy fix, compute the scalar dissipation coefficient associated with the $\\tilde{\\lambda}_{1}$ family, defined as\n$$\nD_{-} \\equiv \\frac{1}{2}\\,|\\tilde{\\lambda}_{1}|_{\\varepsilon},\n$$\nin terms of $\\varepsilon$. Then, interpret this coefficient as quantifying the increase in the dissipative contribution carried by the left-going acoustic wave to the numerical flux compared to the unmodified Roe scheme at the sonic point.\n\nExpress your final answer for $D_{-}$ in meters per second. No numerical rounding is required; provide a closed-form expression.",
            "solution": "The problem requires the calculation of the scalar dissipation coefficient $D_{-}$ associated with the left-going acoustic wave in the Roe flux-difference splitting scheme, modified by the Harten entropy fix, under the specific condition of a sonic point.\n\nFirst, we restate the key definitions and conditions provided. The Harten entropy fix modifies the absolute value of the characteristic speeds $\\tilde{\\lambda}_{k}$ as follows:\n$$\n|\\tilde{\\lambda}_{k}|_{\\varepsilon} =\n\\begin{cases}\n\\frac{\\tilde{\\lambda}_{k}^{2} + \\varepsilon^{2}}{2\\,\\varepsilon},  \\text{if } |\\tilde{\\lambda}_{k}|  \\varepsilon \\\\\n|\\tilde{\\lambda}_{k}|,  \\text{otherwise}\n\\end{cases}\n$$\nHere, $\\varepsilon$ is a small positive parameter with the dimensions of speed.\n\nThe scalar dissipation coefficient for the left-going acoustic wave ($\\tilde{\\lambda}_{1} = \\tilde{u} - \\tilde{a}$) is defined as:\n$$\nD_{-} \\equiv \\frac{1}{2}\\,|\\tilde{\\lambda}_{1}|_{\\varepsilon}\n$$\n\nThe problem specifies the condition to be analyzed: a transonic rarefaction where the Roe-averaged left-going acoustic speed vanishes exactly. This is expressed mathematically as:\n$$\n\\tilde{\\lambda}_{1} = 0\n$$\n\nTo determine which part of the piecewise definition of $|\\tilde{\\lambda}_{1}|_{\\varepsilon}$ to use, we must evaluate the condition $|\\tilde{\\lambda}_{1}|  \\varepsilon$. Substituting the given condition $\\tilde{\\lambda}_{1} = 0$, we get:\n$$\n|0|  \\varepsilon\n$$\nwhich simplifies to $0  \\varepsilon$. The parameter $\\varepsilon$ is defined as a small, positive smoothing parameter (e.g., $\\varepsilon = \\kappa\\,\\tilde{a}$ where $\\kappa \\in (0,1)$ and the speed of sound $\\tilde{a}$ is physically positive). Therefore, the condition $0  \\varepsilon$ is satisfied.\n\nWe must use the first case of the piecewise function for $|\\tilde{\\lambda}_{1}|_{\\varepsilon}$:\n$$\n|\\tilde{\\lambda}_{1}|_{\\varepsilon} = \\frac{\\tilde{\\lambda}_{1}^{2} + \\varepsilon^{2}}{2\\,\\varepsilon}\n$$\n\nNow, we substitute the given condition $\\tilde{\\lambda}_{1} = 0$ into this expression:\n$$\n|\\tilde{\\lambda}_{1}|_{\\varepsilon} = \\frac{(0)^{2} + \\varepsilon^{2}}{2\\,\\varepsilon} = \\frac{\\varepsilon^{2}}{2\\,\\varepsilon}\n$$\nSince $\\varepsilon  0$, we can simplify the fraction by dividing the numerator and denominator by $\\varepsilon$:\n$$\n|\\tilde{\\lambda}_{1}|_{\\varepsilon} = \\frac{\\varepsilon}{2}\n$$\n\nFinally, we compute the dissipation coefficient $D_{-}$ using its definition:\n$$\nD_{-} = \\frac{1}{2}\\,|\\tilde{\\lambda}_{1}|_{\\varepsilon} = \\frac{1}{2} \\left(\\frac{\\varepsilon}{2}\\right) = \\frac{\\varepsilon}{4}\n$$\nThe units of $D_{-}$ are the same as the units of $\\varepsilon$, which are dimensions of speed, i.e., meters per second in the SI system.\n\nFor interpretation, we consider the unmodified Roe scheme. The dissipative part of the numerical flux is $-(1/2)\\sum_{k=1}^{3}|\\tilde{\\lambda}_{k}|\\,\\alpha_{k}\\,\\mathbf{r}_{k}$. The coefficient multiplying the jump term for the first characteristic family is $(1/2)|\\tilde{\\lambda}_{1}|$. At the sonic point where $\\tilde{\\lambda}_{1} = 0$, this coefficient is $(1/2)|0| = 0$. This vanishing numerical dissipation is the reason the unmodified Roe scheme can produce entropy-violating solutions like expansion shocks in transonic rarefactions.\n\nThe Harten entropy fix addresses this by ensuring the dissipation never vanishes. The modified dissipation coefficient for the first family is $D_{-} = (1/2)|\\tilde{\\lambda}_{1}|_{\\varepsilon}$. At the sonic point ($\\tilde{\\lambda}_{1} = 0$), we calculated this to be $\\varepsilon/4$. This value represents the minimum level of numerical dissipation (or artificial viscosity) applied to the left-going acoustic wave, preventing its coefficient from becoming zero. This non-zero dissipation restores the correct physical behavior, enforcing the entropy condition. Thus, $D_{-} = \\varepsilon/4$ quantifies the magnitude of the corrective dissipation introduced by the Harten fix at the precise point where the standard Roe scheme fails.",
            "answer": "$$\\boxed{\\frac{\\varepsilon}{4}}$$"
        },
        {
            "introduction": "While the Roe solver is sharp in resolving discontinuities, its complexity and potential for non-physical solutions motivate the use of more robust alternatives like the Harten-Lax-van Leer (HLL) family of solvers. These schemes are simpler and inherently positivity-preserving, but often at the cost of being more dissipative. This practice  asks you to quantitatively compare the performance of the basic HLLE solver with its more refined successor, HLLC, in resolving a contact discontinuity. By calculating the spurious mass flux generated by each scheme, you will gain a practical appreciation for how numerical methods are engineered to balance robustness with accuracy for specific wave phenomena.",
            "id": "3960531",
            "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma$,\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = \\boldsymbol{0},\n$$\nwhere the conserved variables and fluxes are\n$$\n\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E_{tot} \\end{pmatrix}, \\quad\n\\boldsymbol{F}(\\boldsymbol{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(E_{tot} + p) \\end{pmatrix},\n$$\nand the equation of state closes the system via $p = (\\gamma - 1)\\left(E_{tot} - \\tfrac{1}{2}\\rho u^{2}\\right)$. In a finite-volume Godunov method in Computational Fluid Dynamics (CFD), the intercell numerical flux is obtained from a Riemann solver. Two widely used flux-difference splitting methods are the Harten-Lax-van Leer-Einfeldt (HLLE) solver and the Harten-Lax-van Leer-Contact (HLLC) solver.\n\nWe examine a near-contact Riemann problem characterized by equal velocities and nearly equal pressures but a density jump. The left and right initial states are\n$$\n(\\rho_{L}, u_{L}, p_{L}) = \\left(1.0,\\, 0,\\, 1.00000 \\times 10^{5}\\right),\n\\quad\n(\\rho_{R}, u_{R}, p_{R}) = \\left(0.125,\\, 0,\\, 1.00100 \\times 10^{5}\\right),\n$$\nwith $\\gamma = 1.4$. Let $c_{K} = \\sqrt{\\gamma p_{K}/\\rho_{K}}$ denote the local speed of sound for $K \\in \\{L, R\\}$. Use Einfeldt’s signal speed estimates for HLLE, namely the minimal and maximal wave speeds\n$$\nS_{L} = \\min\\{u_{L} - c_{L},\\, u_{R} - c_{R}\\}, \\quad S_{R} = \\max\\{u_{L} + c_{L},\\, u_{R} + c_{R}\\}.\n$$\nFor HLLC, use the standard three-wave structure including the contact wave with speed $S_{M}$ and star-region states consistent with the Rankine–Hugoniot conditions across each wave. In particular, determine the appropriate star-state density and the corresponding mass flux across the interface.\n\nDefine the contact-capturing error magnitude for a given solver as the absolute interfacial mass flux,\n$$\n\\mathcal{E} \\equiv \\left| F_{\\rho} \\right|,\n$$\nwhere $F_{\\rho}$ is the mass component of the solver’s intercell flux for the given left/right states. Compute\n$$\n\\mathcal{R} \\equiv \\frac{\\mathcal{E}_{\\mathrm{HLLE}}}{\\mathcal{E}_{\\mathrm{HLLC}}},\n$$\nfor the states above, interpreting $S_{M}$ and the star-region quantities in the standard way for HLLC.\n\nProvide your final answer for $\\mathcal{R}$ as a dimensionless number, rounded to four significant figures.",
            "solution": "The problem asks for the ratio $\\mathcal{R} = \\mathcal{E}_{\\mathrm{HLLE}} / \\mathcal{E}_{\\mathrm{HLLC}}$, where $\\mathcal{E} = |F_{\\rho}|$ is the magnitude of the interfacial mass flux for a given solver. We will compute the intercell mass flux for both the HLLE and HLLC schemes for the specified near-contact Riemann problem and then find their ratio.\n\nThe initial left ($L$) and right ($R$) states are given as:\n$(\\rho_{L}, u_{L}, p_{L}) = (1.0, 0, 1.0 \\times 10^{5})$\n$(\\rho_{R}, u_{R}, p_{R}) = (0.125, 0, 1.001 \\times 10^{5})$\nThe ratio of specific heats is $\\gamma = 1.4$. All values are in consistent SI units.\n\nFirst, we calculate the derived quantities for the left and right states.\nThe speed of sound $c$ is given by $c = \\sqrt{\\gamma p / \\rho}$.\nFor the left state:\n$$c_{L} = \\sqrt{\\frac{\\gamma p_{L}}{\\rho_{L}}} = \\sqrt{\\frac{1.4 \\times 1.0 \\times 10^{5}}{1.0}} = \\sqrt{140000} \\approx 374.1657 \\, \\mathrm{m/s}$$\nFor the right state:\n$$c_{R} = \\sqrt{\\frac{\\gamma p_{R}}{\\rho_{R}}} = \\sqrt{\\frac{1.4 \\times 1.001 \\times 10^{5}}{0.125}} = \\sqrt{1121120} \\approx 1058.8295 \\, \\mathrm{m/s}$$\n\nThe state vectors $\\boldsymbol{U} = (\\rho, \\rho u, E_{tot})^T$ and flux vectors $\\boldsymbol{F} = (\\rho u, \\rho u^2+p, u(E_{tot}+p))^T$ are determined next. The total energy per unit volume $E_{tot}$ is given by the equation of state: $E_{tot} = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$.\nFor the left state ($u_L=0$):\n$$E_{tot,L} = \\frac{p_L}{\\gamma-1} = \\frac{1.0 \\times 10^5}{1.4 - 1} = 2.5 \\times 10^5$$\n$$\\boldsymbol{U}_L = \\begin{pmatrix} 1.0 \\\\ 0 \\\\ 2.5 \\times 10^5 \\end{pmatrix}, \\quad \\boldsymbol{F}_L = \\begin{pmatrix} 0 \\\\ 1.0 \\times 10^5 \\\\ 0 \\end{pmatrix}$$\nFor the right state ($u_R=0$):\n$$E_{tot,R} = \\frac{p_R}{\\gamma-1} = \\frac{1.001 \\times 10^5}{1.4 - 1} = 2.5025 \\times 10^5$$\n$$\\boldsymbol{U}_R = \\begin{pmatrix} 0.125 \\\\ 0 \\\\ 2.5025 \\times 10^5 \\end{pmatrix}, \\quad \\boldsymbol{F}_R = \\begin{pmatrix} 0 \\\\ 1.001 \\times 10^5 \\\\ 0 \\end{pmatrix}$$\n\nNow we analyze the HLLE solver. The wave speeds are given by Einfeldt's estimates:\n$$S_L = \\min(u_L - c_L, u_R - c_R) = \\min(0 - c_L, 0 - c_R) = -\\max(c_L, c_R) = -c_R \\approx -1058.8295$$\n$$S_R = \\max(u_L + c_L, u_R + c_R) = \\max(c_L, c_R) = c_R \\approx 1058.8295$$\nThe HLLE intercell flux is given by:\n$$\\boldsymbol{F}_{\\mathrm{HLLE}} = \\frac{S_R \\boldsymbol{F}_L - S_L \\boldsymbol{F}_R + S_L S_R (\\boldsymbol{U}_R - \\boldsymbol{U}_L)}{S_R - S_L}$$\nWe are interested in the mass flux component, $F_\\rho$, which is the first component of the flux vector.\n$$F_{\\rho, \\mathrm{HLLE}} = \\frac{S_R F_{\\rho,L} - S_L F_{\\rho,R} + S_L S_R (\\rho_R - \\rho_L)}{S_R - S_L}$$\nSince $u_L=u_R=0$, the mass flux components of $\\boldsymbol{F}_L$ and $\\boldsymbol{F}_R$ are zero ($F_{\\rho,L}=F_{\\rho,R}=0$).\n$$F_{\\rho, \\mathrm{HLLE}} = \\frac{S_L S_R (\\rho_R - \\rho_L)}{S_R - S_L} = \\frac{(-c_R)(c_R)(\\rho_R - \\rho_L)}{c_R - (-c_R)} = \\frac{-c_R^2 (\\rho_R - \\rho_L)}{2c_R} = \\frac{-c_R (\\rho_R - \\rho_L)}{2}$$\nSubstituting the values:\n$$F_{\\rho, \\mathrm{HLLE}} = \\frac{-(1058.8295)(0.125 - 1.0)}{2} = \\frac{-1058.8295(-0.875)}{2} \\approx 463.2379$$\nThe contact-capturing error for HLLE is:\n$$\\mathcal{E}_{\\mathrm{HLLE}} = |F_{\\rho, \\mathrm{HLLE}}| \\approx 463.2379$$\n\nNext, we analyze the HLLC solver. The outer wave speeds $S_L$ and $S_R$ are taken to be the same as for HLLE. The HLLC method introduces a middle wave speed, $S_M$, for the contact discontinuity. The standard formula for $S_M$ is:\n$$S_M = \\frac{p_R - p_L + \\rho_L u_L(S_L - u_L) - \\rho_R u_R(S_R - u_R)}{\\rho_L(S_L - u_L) - \\rho_R(S_R - u_R)}$$\nWith $u_L=u_R=0$:\n$$S_M = \\frac{p_R - p_L}{\\rho_L S_L - \\rho_R S_R} = \\frac{1.001 \\times 10^5 - 1.0 \\times 10^5}{\\rho_L(-c_R) - \\rho_R(c_R)} = \\frac{100}{-c_R(\\rho_L + \\rho_R)}$$\n$$S_M = \\frac{100}{-1058.8295(1.0 + 0.125)} = \\frac{100}{-1191.1832} \\approx -0.083949$$\nThe wave speeds are ordered as $S_L  S_M  0  S_R$. The interface, located at $x/t=0$, falls in the region between the contact wave ($S_M$) and the rightmost wave ($S_R$). The HLLC flux is therefore given by the flux in the right star region, $\\boldsymbol{F}_R^*$. The velocity in the star regions is equal to the contact speed, so $u_R^* = S_M$. The density in the right star region is:\n$$\\rho_R^* = \\rho_R \\frac{S_R - u_R}{S_R - S_M} = \\rho_R \\frac{S_R}{S_R - S_M}$$\nThe mass flux component is thus:\n$$F_{\\rho, \\mathrm{HLLC}} = \\rho_R^* u_R^* = \\left(\\rho_R \\frac{S_R}{S_R - S_M}\\right) S_M$$\nSubstituting the values:\n$$F_{\\rho, \\mathrm{HLLC}} = (0.125) \\frac{1058.8295}{1058.8295 - (-0.083949)} (-0.083949)$$\n$$F_{\\rho, \\mathrm{HLLC}} = (0.125) \\frac{1058.8295}{1058.91345} (-0.083949) \\approx (0.125)(0.9999207)(-0.083949) \\approx -0.010493$$\nThe contact-capturing error for HLLC is:\n$$\\mathcal{E}_{\\mathrm{HLLC}} = |F_{\\rho, \\mathrm{HLLC}}| \\approx 0.010493$$\n\nFinally, we compute the ratio $\\mathcal{R}$:\n$$\\mathcal{R} = \\frac{\\mathcal{E}_{\\mathrm{HLLE}}}{\\mathcal{E}_{\\mathrm{HLLC}}} = \\frac{463.2379}{0.010493} \\approx 44151.7$$\nRounding to four significant figures, the result is $4.415 \\times 10^4$.",
            "answer": "$$\\boxed{4.415 \\times 10^4}$$"
        }
    ]
}