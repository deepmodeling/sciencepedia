{
    "hands_on_practices": [
        {
            "introduction": "本次练习将抽象的通量差分分裂概念扎根于其最简单的形式。我们将从所有双曲型系统的原型——线性平流方程入手，通过构建一个数值格式并进行稳定性分析，你将理解基于波传播方向的通量分裂如何自然地导出著名的一阶迎风格式，并掌握 Courant–Friedrichs–Lewy (CFL) 条件在确定可行时间步长中的关键作用 。",
            "id": "3960627",
            "problem": "考虑一维线性平流方程的守恒形式，$\\partial_t u + \\partial_x f(u) = 0$，其中 $f(u) = a u$，$a \\in \\mathbb{R}$ 是一个恒定的平流速度。设空间域在节点为 $x_i = i \\Delta x$ 的均匀网格上离散化，网格单元平均值 $u_i^n \\approx \\frac{1}{\\Delta x} \\int_{x_i - \\Delta x/2}^{x_i + \\Delta x/2} u(x, t^n) \\, dx$ 使用大小为 $\\Delta t$ 的前向欧拉步在时间上推进。目标是构建一个与特征的物理传播相一致的一阶、守恒、通量差分分裂 (FDS) 中心格式，然后确定其 Courant–Friedrichs–Lewy (CFL) 稳定性极限。\n\n从有限体积半离散形式 $\\frac{d}{dt} u_i(t) = -\\frac{1}{\\Delta x} \\left( F_{i+1/2}(t) - F_{i-1/2}(t) \\right)$ 出发，其中 $F_{i+1/2}$ 表示在网格单元界面 $x_{i+1/2}$ 处的数值通量，应用通量分解意义上的通量差分分裂 $f(u) = f^{+}(u) + f^{-}(u)$，其具有单调性 $d f^{+} / d u \\ge 0$ 和 $d f^{-} / d u \\le 0$。假设基于特征速度参数 $\\alpha \\ge 0$ 的对称线性分裂，形式为 $f^{\\pm}(u) = \\frac{1}{2}\\left( f(u) \\pm \\alpha u \\right)$，并构建一个中心格式，其在界面处的数值通量仅使用相邻网格单元的值由 $f^{+}$ 和 $f^{-}$ 构成。\n\n然后，在周期性边界条件下，对全离散格式（时间上为前向欧拉）进行 von Neumann (傅里叶) 稳定性分析，并确定在 $\\alpha = |a|$（该选择最小化地界定了线性平流方程的特征速度）的情况下，保证稳定性的最大时间步长 $\\Delta t_{\\max}$，用 $a$ 和 $\\Delta x$ 表示。\n\n将最大允许时间步长 $\\Delta t_{\\max}$ 的最终结果表示为闭式解析表达式。无需四舍五入。首次出现时，定义并使用任何缩略语的全名（例如，Courant–Friedrichs–Lewy (CFL)）。",
            "solution": "该问题要求为一维线性平流方程 $\\partial_t u + \\partial_x f(u) = 0$ 构建并进行稳定性分析一个一阶、守恒的通量差分分裂格式，其中通量由 $f(u) = a u$ 给出， $a \\in \\mathbb{R}$ 为恒定的平流速度。该格式将在一个单元宽度为 $\\Delta x$ 的均匀网格上以有限体积框架进行表述，并使用时间步长为 $\\Delta t$ 的前向欧拉法在时间上推进。\n\n网格单元平均值 $u_i(t)$ 方程的半离散有限体积形式为\n$$\n\\frac{d u_i}{d t} = -\\frac{1}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right)\n$$\n其中 $F_{i+1/2}$ 是在网格单元 $i$ 和 $i+1$ 之间的界面 $x_{i+1/2}$ 处的数值通量。\n\n问题指定了一种基于通量 $f(u)$ 分解为正向和反向部分 $f(u) = f^{+}(u) + f^{-}(u)$ 的通量差分分裂 (FDS) 方法。这些分裂通量必须满足单调性 $d f^{+} / d u \\ge 0$ 和 $d f^{-} / d u \\le 0$，这确保了它们对应于向相反方向传播的波。规定的分裂形式为\n$$\nf^{\\pm}(u) = \\frac{1}{2}\\left( f(u) \\pm \\alpha u \\right)\n$$\n参数 $\\alpha$ 被选择为 $\\alpha = |a|$。让我们验证此选择的单调性条件。分裂通量相对于 $u$ 的导数是：\n$$\n\\frac{d f^{+}}{d u} = \\frac{1}{2}\\left( \\frac{d f}{d u} + \\alpha \\right) = \\frac{1}{2}(a + |a|)\n$$\n$$\n\\frac{d f^{-}}{d u} = \\frac{1}{2}\\left( \\frac{d f}{d u} - \\alpha \\right) = \\frac{1}{2}(a - |a|)\n$$\n如果 $a > 0$，那么 $|a|=a$，所以 $\\frac{d f^{+}}{d u} = \\frac{1}{2}(a+a) = a > 0$ 且 $\\frac{d f^{-}}{d u} = \\frac{1}{2}(a-a) = 0$。\n如果 $a  0$，那么 $|a|=-a$，所以 $\\frac{d f^{+}}{d u} = \\frac{1}{2}(a-a) = 0$ 且 $\\frac{d f^{-}}{d u} = \\frac{1}{2}(a - (-a)) = a  0$。\n如果 $a = 0$，两个导数都为 $0$。\n在所有情况下，条件 $\\frac{d f^{+}}{d u} \\ge 0$ 和 $\\frac{d f^{-}}{d u} \\le 0$ 都得到满足。$\\alpha$ 的这种选择根据特征速度 $a$ 的符号正确地分离了通量。\n\n与这种分裂一致的数值通量是根据信息传播的方向构建的。正向通量 $f^{+}$ 将信息向右传播，因此应使用左侧网格单元的状态 $u_i$ 进行评估。反向通量 $f^{-}$ 将信息向左传播，应使用右侧网格单元的状态 $u_{i+1}$ 进行评估。这导致了在界面 $x_{i+1/2}$ 处的数值通量的 Steger-Warming 通量矢量分裂形式：\n$$\nF_{i+1/2} = f^{+}(u_i) + f^{-}(u_{i+1})\n$$\n代入 $f^{\\pm}$ 的表达式：\n$$\nF_{i+1/2} = \\frac{1}{2}(a u_i + |a| u_i) + \\frac{1}{2}(a u_{i+1} - |a| u_{i+1}) = \\frac{1}{2}a(u_i + u_{i+1}) - \\frac{1}{2}|a|(u_{i+1} - u_i)\n$$\n该通量可以解释为中心差分通量 $\\frac{1}{2}(f(u_i)+f(u_{i+1}))$，并附加了一个数值耗散项 $-\\frac{1}{2}|a|(u_{i+1}-u_i)$。\n\n使用前向欧拉时间积分的全离散格式为 $u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}(F_{i+1/2}^n - F_{i-1/2}^n)$。为了继续，我们表示通量差：\n$$\nF_{i+1/2}^n - F_{i-1/2}^n = \\left[ f^{+}(u_i^n) + f^{-}(u_{i+1}^n) \\right] - \\left[ f^{+}(u_{i-1}^n) + f^{-}(u_i^n) \\right]\n$$\n使用 $f^{\\pm}(u)$ 的定义和 $\\alpha = |a|$：\n$$\nF_{i+1/2}^n - F_{i-1/2}^n = \\frac{1}{2}(a+|a|)u_i^n + \\frac{1}{2}(a-|a|)u_{i+1}^n - \\frac{1}{2}(a+|a|)u_{i-1}^n - \\frac{1}{2}(a-|a|)u_i^n\n$$\n$$\n= \\frac{1}{2}(a-|a|)u_{i+1}^n + \\frac{1}{2}[(a+|a|) - (a-|a|)]u_i^n - \\frac{1}{2}(a+|a|)u_{i-1}^n\n$$\n$$\n= \\frac{1}{2}(a-|a|)u_{i+1}^n + |a|u_i^n - \\frac{1}{2}(a+|a|)u_{i-1}^n\n$$\n如果 $a > 0$，则 $|a|=a$，通量差变为 $0 \\cdot u_{i+1}^n + a u_i^n - a u_{i-1}^n = a(u_i^n - u_{i-1}^n)$。\n如果 $a  0$，则 $|a|=-a$，通量差变为 $a u_{i+1}^n - a u_i^n - 0 \\cdot u_{i-1}^n = a(u_{i+1}^n - u_i^n)$。\n得到的格式是一阶迎风格式：\n$$\nu_i^{n+1} = \\begin{cases} u_i^n - \\frac{a \\Delta t}{\\Delta x}(u_i^n - u_{i-1}^n)  \\text{若 } a > 0 \\\\ u_i^n - \\frac{a \\Delta t}{\\Delta x}(u_{i+1}^n - u_i^n)  \\text{若 } a  0 \\end{cases}\n$$\n我们现在进行 von Neumann 稳定性分析。我们寻找形式为 $u_j^n = G^n e^{I j k \\Delta x}$ 的解，其中 $k$ 是波数，$I = \\sqrt{-1}$，$G$ 是放大因子。令 $\\phi = k \\Delta x$。\n\n情况1：$a > 0$。令 Courant 数为 $\\nu = \\frac{a \\Delta t}{\\Delta x} > 0$。\n格式为 $u_i^{n+1} = u_i^n - \\nu(u_i^n - u_{i-1}^n)$。代入傅里叶模态：\n$$\nG^{n+1} e^{I j \\phi} = G^n e^{I j \\phi} - \\nu(G^n e^{I j \\phi} - G^n e^{I (j-1) \\phi})\n$$\n除以 $G^n e^{I j \\phi}$ 得到放大因子：\n$$\nG = 1 - \\nu(1 - e^{-I \\phi}) = 1 - \\nu(1 - \\cos\\phi + I\\sin\\phi) = (1 - \\nu + \\nu\\cos\\phi) - I\\nu\\sin\\phi\n$$\n放大因子的模的平方是：\n$$\n|G|^2 = (1 - \\nu + \\nu\\cos\\phi)^2 + (-\\nu\\sin\\phi)^2 = (1-\\nu)^2 + 2\\nu(1-\\nu)\\cos\\phi + \\nu^2\\cos^2\\phi + \\nu^2\\sin^2\\phi\n$$\n$$\n|G|^2 = 1 - 2\\nu + \\nu^2 + 2\\nu\\cos\\phi - 2\\nu^2\\cos\\phi + \\nu^2 = 1 - 2\\nu(1-\\cos\\phi) + 2\\nu^2(1-\\cos\\phi)\n$$\n$$\n|G|^2 = 1 + 2\\nu(\\nu-1)(1-\\cos\\phi)\n$$\n为了稳定性，我们要求对所有 $\\phi$ 都有 $|G|^2 \\le 1$。由于 $1-\\cos\\phi \\ge 0$，并且我们知道 $\\nu > 0$，稳定性要求 $\\nu-1 \\le 0$，即 $\\nu \\le 1$。因此，对于 $a>0$，我们需要 $0  \\frac{a \\Delta t}{\\Delta x} \\le 1$。\n\n情况2：$a  0$。令 $\\nu = \\frac{a \\Delta t}{\\Delta x}  0$。\n格式为 $u_i^{n+1} = u_i^n - \\nu(u_{i+1}^n - u_i^n)$。代入傅里叶模态：\n$$\nG^{n+1} e^{I j \\phi} = G^n e^{I j \\phi} - \\nu(G^n e^{I (j+1) \\phi} - G^n e^{I j \\phi})\n$$\n$$\nG = 1 - \\nu(e^{I\\phi} - 1) = 1 - \\nu(\\cos\\phi - 1 + I\\sin\\phi) = (1 - \\nu(\\cos\\phi - 1)) - I\\nu\\sin\\phi\n$$\n$$\n|G|^2 = (1 + \\nu(1-\\cos\\phi))^2 + (-\\nu\\sin\\phi)^2 = 1 + 2\\nu(1-\\cos\\phi) + \\nu^2(1-\\cos\\phi)^2 + \\nu^2\\sin^2\\phi\n$$\n$$\n|G|^2 = 1 + 2\\nu(1-\\cos\\phi) + \\nu^2(1 - 2\\cos\\phi + \\cos^2\\phi + \\sin^2\\phi) = 1 + 2\\nu(1-\\cos\\phi) + 2\\nu^2(1-\\cos\\phi)\n$$\n$$\n|G|^2 = 1 + 2\\nu(\\nu+1)(1-\\cos\\phi)\n$$\n由于 $1-\\cos\\phi \\ge 0$ 且 $\\nu  0$，稳定性要求 $\\nu+1 \\ge 0$，即 $\\nu \\ge -1$。因此，对于 $a0$，我们需要 $-1 \\le \\frac{a \\Delta t}{\\Delta x}  0$。\n\n综合两种情况，稳定性条件是 $-1 \\le \\frac{a \\Delta t}{\\Delta x} \\le 1$，可以紧凑地写为：\n$$\n\\left| \\frac{a \\Delta t}{\\Delta x} \\right| \\le 1\n$$\n这是一阶迎风格式的 Courant–Friedrichs–Lewy (CFL) 稳定性条件。为了找到保证稳定性的最大可能时间步长 $\\Delta t_{\\max}$，我们取等式：\n$$\n\\frac{|a| \\Delta t_{\\max}}{\\Delta x} = 1\n$$\n求解 $\\Delta t_{\\max}$（假设 $a \\neq 0$），我们得到：\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|a|}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\Delta x}{|a|}}\n$$"
        },
        {
            "introduction": "在建立了基础之后，我们现在转向一个更真实的系统：可压缩欧拉方程。本练习将分步演示 Harten–Lax–van Leer–Contact (HLLC) 近似黎曼求解器（一种强大的通量差分分裂方法）的应用。通过为一道具体的黎曼问题计算 Roe 平均量、波速和最终的通量，你将对这些先进格式在计算流体力学 (CFD) 代码中的运作方式获得具体的认识 。",
            "id": "3960650",
            "problem": "考虑用于计算流体动力学 (CFD) 的有限体积法中，在一个单元面上提出的、针对具有恒定比热比 $\\gamma$ 的量热完全气体的一维气体动力学欧拉方程的黎曼问题。界面处空气（假定为理想气体）的左右状态为：\n- 左状态：密度 $\\rho_{L} = 1.0$，速度 $u_{L} = 200$，压力 $p_{L} = 1.0 \\times 10^{5}$。\n- 右状态：密度 $\\rho_{R} = 0.5$，速度 $u_{R} = -50$，压力 $p_{R} = 8.0 \\times 10^{4}$。\n使用 $\\gamma = 1.4$，并假定界面法线与 $x$ 方向对齐，因此所有速度均为法向分量。\n\n从守恒形式的欧拉方程、理想气体关系式以及跨波的 Rankine–Hugoniot 跳跃条件出发，使用基于 Roe 平均量的 Einfeldt 波速估计来估算左右边界波速 $S_{L}$ 和 $S_{R}$，通过施加物理上正确的接触波约束来确定接触波速 $S_{M}$，然后构建 Harten–Lax–van Leer–Contact (HLLC) 近似黎曼解，以获得界面处 $x$ 动量分量的数值通量。\n\n请从第一性原理完整推导所需的中间关系式（包括 HLLC 所需的 Roe 平均值、声速、接触速度和星区密度），然后对给定状态数值计算得到的 HLLC 动量通量。将最终数值通量四舍五入至四位有效数字，并以 $\\mathrm{N/m^{2}}$ 为单位表示。",
            "solution": "该问题是有效的。这是一个计算流体动力学中的适定问题，基于已建立的科学原理（欧拉方程）和标准的数值方法（HLLC 近似黎曼求解器）。所有必要数据均已提供，所求量定义明确且可计算。\n\n一维欧拉方程的守恒形式为：\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = 0\n$$\n其中 $\\boldsymbol{U}$ 是守恒变量向量，$\\boldsymbol{F}(\\boldsymbol{U})$ 是通量向量：\n$$\n\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad \\boldsymbol{F}(\\boldsymbol{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (E+p)u \\end{pmatrix}\n$$\n这里，$\\rho$ 是密度，$u$ 是速度，$p$ 是压力，$E$ 是单位体积总能量。对于量热完全气体，总能量通过状态方程与压力相关联：\n$$\nE = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2\n$$\n其中 $\\gamma$ 是比热比。\n\nHarten–Lax–van Leer–Contact (HLLC) 求解器通过假设一个由最左波、接触波和最右波组成的三波结构来近似黎曼问题的解，其波速分别为 $S_L$、$S_M$ 和 $S_R$。这些波将区域分为四个常数状态：初始左状态 ($L$)、左星区状态 ($L*$)、右星区状态 ($R*$) 和初始右状态 ($R$)。界面 ($x/t = 0$) 处的 HLLC 数值通量由该界面所在的区域决定：\n$$\n\\boldsymbol{F}_{HLLC} =\n\\begin{cases}\n\\boldsymbol{F}_L  \\text{如果 } 0 \\le S_L \\\\\n\\boldsymbol{F}_L^*  \\text{如果 } S_L \\le 0  S_M \\\\\n\\boldsymbol{F}_R^*  \\text{如果 } S_M \\le 0  S_R \\\\\n\\boldsymbol{F}_R  \\text{如果 } S_R \\le 0\n\\end{cases}\n$$\n中间通量 $\\boldsymbol{F}_L^*$ 和 $\\boldsymbol{F}_R^*$ 是从 Rankine-Hugoniot 跳跃条件推导出来的。本问题要求计算该通量的动量分量，它对应于向量 $\\boldsymbol{F}_{HLLC}$ 的第二个分量。\n\n计算过程分为几个步骤。\n\n**步骤 1：定义初始状态并计算派生属性**\n给定的左 ($L$) 和右 ($R$) 状态为：\n$\\rho_L = 1.0 \\, \\mathrm{kg/m^3}$，$u_L = 200 \\, \\mathrm{m/s}$，$p_L = 1.0 \\times 10^5 \\, \\mathrm{Pa}$\n$\\rho_R = 0.5 \\, \\mathrm{kg/m^3}$，$u_R = -50 \\, \\mathrm{m/s}$，$p_R = 8.0 \\times 10^4 \\, \\mathrm{Pa}$\n比热比为 $\\gamma = 1.4$。\n\n首先，我们计算每个状态下的声速 $a = \\sqrt{\\gamma p / \\rho}$：\n$$\na_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times 1.0 \\times 10^5}{1.0}} = \\sqrt{140000} \\approx 374.166 \\, \\mathrm{m/s}\n$$\n$$\na_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times 8.0 \\times 10^4}{0.5}} = \\sqrt{224000} \\approx 473.286 \\, \\mathrm{m/s}\n$$\n\n**步骤 2：计算 Roe 平均量**\nEinfeldt 的波速估计依赖于 Roe 平均值。Roe 平均值的定义如下：\n$$\n\\tilde{\\rho} = \\sqrt{\\rho_L \\rho_R}\n$$\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L}u_L + \\sqrt{\\rho_R}u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho_L}H_L + \\sqrt{\\rho_R}H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\n其中 $H = (E+p)/\\rho$ 是比焓。\nRoe 平均声速 $\\tilde{a}$ 由下式给出：\n$$\n\\tilde{a} = \\sqrt{(\\gamma-1)(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2)}\n$$\n我们首先计算比焓 $H_L$ 和 $H_R$：\n$$\nH_L = \\frac{E_L+p_L}{\\rho_L} = \\frac{1}{\\rho_L}\\left(\\frac{p_L}{\\gamma-1} + \\frac{1}{2}\\rho_L u_L^2 + p_L\\right) = \\frac{\\gamma p_L}{(\\gamma-1)\\rho_L} + \\frac{1}{2}u_L^2 = \\frac{a_L^2}{\\gamma-1} + \\frac{1}{2}u_L^2\n$$\n$$\nH_L = \\frac{140000}{0.4} + \\frac{1}{2}(200)^2 = 350000 + 20000 = 370000 \\, \\mathrm{m^2/s^2}\n$$\n$$\nH_R = \\frac{a_R^2}{\\gamma-1} + \\frac{1}{2}u_R^2 = \\frac{224000}{0.4} + \\frac{1}{2}(-50)^2 = 560000 + 1250 = 561250 \\, \\mathrm{m^2/s^2}\n$$\n现在我们计算 Roe 平均值：\n$$\n\\tilde{u} = \\frac{\\sqrt{1.0}(200) + \\sqrt{0.5}(-50)}{1 + \\sqrt{0.5}} \\approx \\frac{200 - 35.355}{1.7071} \\approx 96.447 \\, \\mathrm{m/s}\n$$\n$$\n\\tilde{H} = \\frac{\\sqrt{1.0}(370000) + \\sqrt{0.5}(561250)}{1 + \\sqrt{0.5}} \\approx \\frac{370000 + 396860}{1.7071} \\approx 449218 \\, \\mathrm{m^2/s^2}\n$$\n$$\n\\tilde{a} = \\sqrt{(1.4-1)(449218 - \\frac{1}{2}(96.447)^2)} \\approx \\sqrt{0.4(449218 - 4651.1)} \\approx 421.695 \\, \\mathrm{m/s}\n$$\n\n**步骤 3：估计边界波速 $S_L$ 和 $S_R$**\n使用 Einfeldt 的估计：\n$$\nS_L = \\min(u_L - a_L, \\tilde{u} - \\tilde{a})\n$$\n$$\nS_R = \\max(u_R + a_R, \\tilde{u} + \\tilde{a})\n$$\n代入计算出的值：\n$$\nS_L = \\min(200 - 374.166, 96.447 - 421.695) = \\min(-174.166, -325.248) = -325.248 \\, \\mathrm{m/s}\n$$\n$$\nS_R = \\max(-50 + 473.286, 96.447 + 421.695) = \\max(423.286, 518.142) = 518.142 \\, \\mathrm{m/s}\n$$\n\n**步骤 4：确定接触波速 $S_M$**\nHLLC 求解器施加了速度 $u$ 和压力 $p$ 在接触间断上是常数的条件，即 $u_{L*} = u_{R*} = u_*$ 和 $p_{L*} = p_{R*} = p_*$。接触波速为 $S_M = u_*$。星区压力 $p_*$ 可以通过在左右波上应用 Rankine-Hugoniot 条件与初始状态联系起来：\n$$\np_* = p_L + \\rho_L(u_L - S_L)(u_L - S_M)\n$$\n$$\np_* = p_R + \\rho_R(u_R - S_R)(u_R - S_M)\n$$\n令这两个表达式相等并求解 $S_M$ 可得：\n$$\nS_M = \\frac{p_R - p_L + \\rho_L u_L(S_L - u_L) - \\rho_R u_R(S_R - u_R)}{\\rho_L(S_L - u_L) - \\rho_R(S_R - u_R)}\n$$\n我们计算分子和分母中的各项：\n分子：\n- $p_R - p_L = 8.0 \\times 10^4 - 1.0 \\times 10^5 = -20000$\n- $\\rho_L u_L(S_L - u_L) = 1.0 \\times 200 \\times (-325.248 - 200) = -105049.6$\n- $\\rho_R u_R(S_R - u_R) = 0.5 \\times (-50) \\times (518.142 - (-50)) = -14203.55$\n- 分子 $= -20000 - 105049.6 - (-14203.55) = -110846.05$\n\n分母：\n- $\\rho_L(S_L - u_L) = 1.0 \\times (-325.248 - 200) = -525.248$\n- $\\rho_R(S_R - u_R) = 0.5 \\times (518.142 - (-50)) = 284.071$\n- 分母 $= -525.248 - 284.071 = -809.319$\n\n$$\nS_M = \\frac{-110846.05}{-809.319} \\approx 136.964 \\, \\mathrm{m/s}\n$$\n\n**步骤 5：构建 HLLC 动量通量**\n我们有 $S_L \\approx -325.25 \\, \\mathrm{m/s}$，$S_M \\approx 136.96 \\, \\mathrm{m/s}$ 和 $S_R \\approx 518.14 \\, \\mathrm{m/s}$。由于 $S_L  0  S_M$，界面位于左星区 ($L*$)。因此 HLLC 通量为 $\\boldsymbol{F}_{HLLC} = \\boldsymbol{F}_L^*$。\n任何区域中通量的动量分量为 $(\\rho u^2 + p)$。在 $L*$ 区域中，速度为 $u_{L*} = S_M$，压力为 $p_{L*} = p_*$。密度为 $\\rho_{L*}$。因此，所求的动量通量为：\n$$\nf_{HLLC}^{(2)} = (\\rho u^2+p)_{L*} = \\rho_{L*} S_M^2 + p_*\n$$\n我们需要计算 $p_*$ 和 $\\rho_{L*}$。由于界面位于 $L*$ 区域，我们使用从左状态推导出的 $p_*$ 表达式：\n$$\np_* = p_L + \\rho_L(u_L - S_L)(u_L - S_M)\n$$\n$$\np_* = 1.0 \\times 10^5 + 1.0 \\times (200 - (-325.248)) \\times (200 - 136.964)\n$$\n$$\np_* = 1.0 \\times 10^5 + (525.248) \\times (63.036) \\approx 100000 + 33109.5 \\approx 133109.5 \\, \\text{Pa}\n$$\n密度 $\\rho_{L*}$ 由跨越左波的质量守恒跳跃条件得出：\n$$\n\\rho_{L*} = \\rho_L \\frac{S_L - u_L}{S_L - S_M}\n$$\n$$\n\\rho_{L*} = 1.0 \\times \\frac{-325.248 - 200}{-325.248 - 136.964} = \\frac{-525.248}{-462.212} \\approx 1.13637 \\, \\mathrm{kg/m^3}\n$$\n现在我们可以计算动量通量：\n$$\nf_{HLLC}^{(2)} = \\rho_{L*} S_M^2 + p_* \\approx 1.13637 \\times (136.964)^2 + 133109.5\n$$\n$$\nf_{HLLC}^{(2)} \\approx 1.13637 \\times 18759.16 + 133109.5 \\approx 21316.6 + 133109.5 = 154426.1 \\, \\mathrm{N/m^2}\n$$\n按要求四舍五入到四位有效数字，结果是 $1.544 \\times 10^5 \\, \\mathrm{N/m^2}$。\n当使用像 Einfeldt 这样的近似波速估计时，从左侧和右侧计算出的 $p_*$ 之间的微小差异是 HLLC 方法的一个已知特性。所遵循的程序，即使用从接触间断适当的一侧的状态推导出的值，是标准做法。",
            "answer": "$$\n\\boxed{1.544 \\times 10^{5}}\n$$"
        },
        {
            "introduction": "并非所有数值格式都是生而平等的。最后的这项练习将对 HLLC 求解器及其更简单的前身 Harten-Lax-van Leer-Einfeldt (HLLE) 进行对比分析，重点关注一个涉及接触间断的挑战性案例。通过量化每个格式中与数值耗散相关的误差，你将培养出一种批判性思维，从而理解计算简易性与精确解析复杂流动特征之间的权衡 。",
            "id": "3960531",
            "problem": "考虑描述一种比热比为 $\\gamma$ 的理想气体的一维可压缩欧拉方程，\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = \\boldsymbol{0},\n$$\n其中守恒变量和通量为\n$$\n\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad\n\\boldsymbol{F}(\\boldsymbol{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(E + p) \\end{pmatrix},\n$$\n且状态方程 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$ 使系统封闭。在计算流体动力学 (CFD) 的有限体积 Godunov 方法中，单元间的数值通量由黎曼求解器获得。两种广泛使用的通量差分分裂方法是 Harten-Lax-van Leer-Einfeldt (HLLE) 求解器和 Harten-Lax-van Leer-Contact (HLLC) 求解器。\n\n我们研究一个近接触黎曼问题，其特征是速度相等、压力几乎相等，但存在密度跳跃。左侧和右侧的初始状态为\n$$\n(\\rho_{L}, u_{L}, p_{L}) = \\left(1.0,\\, 0,\\, 1.00000 \\times 10^{5}\\right),\n\\quad\n(\\rho_{R}, u_{R}, p_{R}) = \\left(0.125,\\, 0,\\, 1.00100 \\times 10^{5}\\right),\n$$\n其中 $\\gamma = 1.4$。令 $c_{K} = \\sqrt{\\gamma p_{K}/\\rho_{K}}$ 表示 $K \\in \\{L, R\\}$ 时的当地声速。对 HLLE 使用 Einfeldt 的信号速度估计，即最小和最大波速\n$$\nS_{L} = \\min\\{u_{L} - c_{L},\\, u_{R} - c_{R}\\}, \\quad S_{R} = \\max\\{u_{L} + c_{L},\\, u_{R} + c_{R}\\}.\n$$\n对于 HLLC，使用标准的三波结构，包括速度为 $S_{M}$ 的接触波和与跨越每道波的 Rankine–Hugoniot 条件一致的星区状态。特别地，确定适当的星区密度以及穿过界面的相应质量通量。\n\n将给定求解器的接触捕捉误差大小定义为界面质量通量的绝对值，\n$$\n\\mathcal{E} \\equiv \\left| F_{\\rho} \\right|,\n$$\n其中 $F_{\\rho}$ 是求解器对于给定左右状态的单元间通量的质量分量。计算\n$$\n\\mathcal{R} \\equiv \\frac{\\mathcal{E}_{\\mathrm{HLLE}}}{\\mathcal{E}_{\\mathrm{HLLC}}},\n$$\n对于上述状态，以 HLLC 的标准方式解释 $S_{M}$ 和星区量。\n\n将 $\\mathcal{R}$ 的最终答案表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "该问题定义明确且科学上合理，基于计算流体动力学的基本原理以及用于一维欧拉方程的成熟的 HLLE 和 HLLC 黎曼求解器。所有必要的数据，包括初始状态、比热比以及波速估计的具体公式，均已提供。因此，该问题是有效的，并且可以构建一个完整的解决方案。\n\n问题要求计算比率 $\\mathcal{R} = \\mathcal{E}_{\\mathrm{HLLE}} / \\mathcal{E}_{\\mathrm{HLLC}}$，其中 $\\mathcal{E} = |F_{\\rho}|$ 是给定求解器的界面质量通量的大小。我们将针对指定的近接触黎曼问题，计算 HLLE 和 HLLC 两种格式的单元间质量通量，然后求出它们的比率。\n\n初始的左侧 ($L$) 和右侧 ($R$) 状态给定如下：\n$(\\rho_{L}, u_{L}, p_{L}) = (1.0, 0, 1.0 \\times 10^{5})$\n$(\\rho_{R}, u_{R}, p_{R}) = (0.125, 0, 1.001 \\times 10^{5})$\n比热比为 $\\gamma = 1.4$。所有数值均采用一致的国际单位制（SI）单位。\n\n首先，我们计算左侧和右侧状态的导出量。\n声速 $c$ 由 $c = \\sqrt{\\gamma p / \\rho}$ 给出。\n对于左侧状态：\n$$c_{L} = \\sqrt{\\frac{\\gamma p_{L}}{\\rho_{L}}} = \\sqrt{\\frac{1.4 \\times 1.0 \\times 10^{5}}{1.0}} = \\sqrt{140000} \\approx 374.1657 \\, \\mathrm{m/s}$$\n对于右侧状态：\n$$c_{R} = \\sqrt{\\frac{\\gamma p_{R}}{\\rho_{R}}} = \\sqrt{\\frac{1.4 \\times 1.001 \\times 10^{5}}{0.125}} = \\sqrt{1121120} \\approx 1058.8295 \\, \\mathrm{m/s}$$\n\n接下来确定状态向量 $\\boldsymbol{U} = (\\rho, \\rho u, E)^T$ 和通量向量 $\\boldsymbol{F} = (\\rho u, \\rho u^2+p, u(E+p))^T$。单位体积的总能量 $E$ 由状态方程给出：$E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$。\n对于左侧状态 ($u_L=0$)：\n$$E_L = \\frac{p_L}{\\gamma-1} = \\frac{1.0 \\times 10^5}{1.4 - 1} = 2.5 \\times 10^5$$\n$$\\boldsymbol{U}_L = \\begin{pmatrix} 1.0 \\\\ 0 \\\\ 2.5 \\times 10^5 \\end{pmatrix}, \\quad \\boldsymbol{F}_L = \\begin{pmatrix} 0 \\\\ 1.0 \\times 10^5 \\\\ 0 \\end{pmatrix}$$\n对于右侧状态 ($u_R=0$)：\n$$E_R = \\frac{p_R}{\\gamma-1} = \\frac{1.001 \\times 10^5}{1.4 - 1} = 2.5025 \\times 10^5$$\n$$\\boldsymbol{U}_R = \\begin{pmatrix} 0.125 \\\\ 0 \\\\ 2.5025 \\times 10^5 \\end{pmatrix}, \\quad \\boldsymbol{F}_R = \\begin{pmatrix} 0 \\\\ 1.001 \\times 10^5 \\\\ 0 \\end{pmatrix}$$\n\n现在我们分析 HLLE 求解器。波速由 Einfeldt 的估计给出：\n$$S_L = \\min(u_L - c_L, u_R - c_R) = \\min(0 - c_L, 0 - c_R) = -\\max(c_L, c_R) = -c_R \\approx -1058.8295$$\n$$S_R = \\max(u_L + c_L, u_R + c_R) = \\max(c_L, c_R) = c_R \\approx 1058.8295$$\nHLLE 单元间通量由以下公式给出：\n$$\\boldsymbol{F}_{\\mathrm{HLLE}} = \\frac{S_R \\boldsymbol{F}_L - S_L \\boldsymbol{F}_R + S_L S_R (\\boldsymbol{U}_R - \\boldsymbol{U}_L)}{S_R - S_L}$$\n我们关心的是质量通量分量 $F_\\rho$，即通量向量的第一个分量。\n$$F_{\\rho, \\mathrm{HLLE}} = \\frac{S_R F_{\\rho,L} - S_L F_{\\rho,R} + S_L S_R (\\rho_R - \\rho_L)}{S_R - S_L}$$\n由于 $u_L=u_R=0$，$\\boldsymbol{F}_L$ 和 $\\boldsymbol{F}_R$ 的质量通量分量为零 ($F_{\\rho,L}=F_{\\rho,R}=0$)。\n$$F_{\\rho, \\mathrm{HLLE}} = \\frac{S_L S_R (\\rho_R - \\rho_L)}{S_R - S_L} = \\frac{(-c_R)(c_R)(\\rho_R - \\rho_L)}{c_R - (-c_R)} = \\frac{-c_R^2 (\\rho_R - \\rho_L)}{2c_R} = \\frac{-c_R (\\rho_R - \\rho_L)}{2}$$\n代入数值：\n$$F_{\\rho, \\mathrm{HLLE}} = \\frac{-(1058.8295)(0.125 - 1.0)}{2} = \\frac{-1058.8295(-0.875)}{2} \\approx 463.2379$$\nHLLE 的接触捕捉误差为：\n$$\\mathcal{E}_{\\mathrm{HLLE}} = |F_{\\rho, \\mathrm{HLLE}}| \\approx 463.2379$$\n\n接下来，我们分析 HLLC 求解器。外部波速 $S_L$ 和 $S_R$ 与 HLLE 的相同。HLLC 方法为接触间断引入了一个中间波速 $S_M$。$S_M$ 的标准公式是：\n$$S_M = \\frac{p_R - p_L + \\rho_L u_L(S_L - u_L) - \\rho_R u_R(S_R - u_R)}{\\rho_L(S_L - u_L) - \\rho_R(S_R - u_R)}$$\n当 $u_L=u_R=0$ 时：\n$$S_M = \\frac{p_R - p_L}{\\rho_L S_L - \\rho_R S_R} = \\frac{1.001 \\times 10^5 - 1.0 \\times 10^5}{\\rho_L(-c_R) - \\rho_R(c_R)} = \\frac{100}{-c_R(\\rho_L + \\rho_R)}$$\n$$S_M = \\frac{100}{-1058.8295(1.0 + 0.125)} = \\frac{100}{-1191.1832} \\approx -0.083949$$\n波速排序为 $S_L  S_M  0  S_R$。位于 $x/t=0$ 的界面落在接触波 ($S_M$) 和最右侧波 ($S_R$) 之间的区域。因此，HLLC 通量由右星区的通量 $\\boldsymbol{F}_R^*$ 给出。\n$$\\boldsymbol{F}_{\\mathrm{HLLC}} = \\boldsymbol{F}_R^* = \\begin{pmatrix} \\rho_R^* u_R^* \\\\ \\rho_R^* (u_R^*)^2 + p^* \\\\ u_R^* (E_R^* + p^*) \\end{pmatrix}$$\n在 HLLC 模型中，星区的速度等于接触波速，因此 $u_R^* = S_M$。右星区的密度为：\n$$\\rho_R^* = \\rho_R \\frac{S_R - u_R}{S_R - S_M} = \\rho_R \\frac{S_R}{S_R - S_M}$$\n因此，质量通量分量为：\n$$F_{\\rho, \\mathrm{HLLC}} = \\rho_R^* u_R^* = \\left(\\rho_R \\frac{S_R}{S_R - S_M}\\right) S_M$$\n代入数值：\n$$F_{\\rho, \\mathrm{HLLC}} = (0.125) \\frac{1058.8295}{1058.8295 - (-0.083949)} (-0.083949)$$\n$$F_{\\rho, \\mathrm{HLLC}} = (0.125) \\frac{1058.8295}{1058.91345} (-0.083949) \\approx (0.125)(0.9999207)(-0.083949) \\approx -0.010493$$\nHLLC 的接触捕捉误差为：\n$$\\mathcal{E}_{\\mathrm{HLLC}} = |F_{\\rho, \\mathrm{HLLC}}| \\approx 0.010493$$\n\n最后，我们计算比率 $\\mathcal{R}$：\n$$\\mathcal{R} = \\frac{\\mathcal{E}_{\\mathrm{HLLE}}}{\\mathcal{E}_{\\mathrm{HLLC}}} = \\frac{463.2379}{0.010493} \\approx 44151.7$$\n四舍五入到四位有效数字，我们得到 $44150$。\n$\\mathcal{R} = 4.415 \\times 10^4$。",
            "answer": "$$\\boxed{4.415 \\times 10^4}$$"
        }
    ]
}