{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation, we begin with the simplest hyperbolic conservation law: the linear advection equation. This exercise guides you through constructing a flux-difference splitting scheme from first principles, revealing how the flux can be decomposed based on the direction of information propagation. By working through this problem , you will not only derive the classic first-order upwind scheme but also reinforce the crucial skill of performing a von Neumann stability analysis to determine the Courant–Friedrichs–Lewy (CFL) condition.",
            "id": "3960627",
            "problem": "Consider the one-dimensional linear advection equation in conservative form, $\\partial_t u + \\partial_x f(u) = 0$, with $f(u) = a u$, where $a \\in \\mathbb{R}$ is a constant advection speed. Let the spatial domain be discretized on a uniform grid with nodes $x_i = i \\Delta x$ and cell averages $u_i^n \\approx \\frac{1}{\\Delta x} \\int_{x_i - \\Delta x/2}^{x_i + \\Delta x/2} u(x, t^n) \\, dx$ advanced in time with a forward Euler step of size $\\Delta t$. The goal is to construct a first-order, conservative, flux-difference splitting (FDS) central scheme that is consistent with the physical propagation of characteristics and then determine its Courant–Friedrichs–Lewy (CFL) stability limit.\n\nStarting from the finite-volume semidiscrete form $\\frac{d}{dt} u_i(t) = -\\frac{1}{\\Delta x} \\left( F_{i+1/2}(t) - F_{i-1/2}(t) \\right)$, where $F_{i+1/2}$ denotes a numerical flux at the cell interface $x_{i+1/2}$, apply a flux-difference split in the sense of flux decomposition $f(u) = f^{+}(u) + f^{-}(u)$ with monotonicity properties $d f^{+} / d u \\ge 0$ and $d f^{-} / d u \\le 0$. Assume a symmetric linear split based on a characteristic speed parameter $\\alpha \\ge 0$, of the form $f^{\\pm}(u) = \\frac{1}{2}\\left( f(u) \\pm \\alpha u \\right)$, and construct a central scheme whose numerical fluxes at interfaces are built from $f^{+}$ and $f^{-}$ using only neighboring cell values.\n\nThen, perform a von Neumann (Fourier) stability analysis for the fully discrete scheme (forward Euler in time) under periodic boundary conditions, and determine the largest time step $\\Delta t_{\\max}$ that guarantees stability in terms of $a$ and $\\Delta x$, for the choice $\\alpha = |a|$ that minimally bounds the characteristic speeds of the linear advection equation.\n\nExpress your final result for the maximal allowable time step $\\Delta t_{\\max}$ as a closed-form analytic expression. No rounding is required. Define and use the full names of any acronyms (for example, Courant–Friedrichs–Lewy (CFL)) upon first appearance.",
            "solution": "The problem requires the construction and stability analysis of a first-order, conservative, flux-difference splitting scheme for the one-dimensional linear advection equation, $\\partial_t u + \\partial_x f(u) = 0$, where the flux is given by $f(u) = a u$ for a constant advection speed $a \\in \\mathbb{R}$. The scheme is to be formulated within a finite-volume framework on a uniform grid with cell width $\\Delta x$ and advanced in time using a forward Euler method with time step $\\Delta t$.\n\nThe semi-discrete finite-volume form of the equation for the cell average $u_i(t)$ is\n$$\n\\frac{d u_i}{d t} = -\\frac{1}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right)\n$$\nwhere $F_{i+1/2}$ is the numerical flux at the interface $x_{i+1/2}$ between cell $i$ and cell $i+1$.\n\nThe problem specifies a flux-difference splitting (FDS) approach based on the decomposition of the flux $f(u)$ into positive- and negative-going parts, $f(u) = f^{+}(u) + f^{-}(u)$. These split fluxes must satisfy the monotonicity properties $d f^{+} / d u \\ge 0$ and $d f^{-} / d u \\le 0$, which ensures that they correspond to waves propagating in opposite directions. The prescribed form of the split is\n$$\nf^{\\pm}(u) = \\frac{1}{2}\\left( f(u) \\pm \\alpha u \\right)\n$$\nwith the parameter $\\alpha$ chosen as $\\alpha = |a|$. Let us verify the monotonicity conditions for this choice. The derivatives of the split fluxes with respect to $u$ are:\n$$\n\\frac{d f^{+}}{d u} = \\frac{1}{2}\\left( \\frac{d f}{d u} + \\alpha \\right) = \\frac{1}{2}(a + |a|)\n$$\n$$\n\\frac{d f^{-}}{d u} = \\frac{1}{2}\\left( \\frac{d f}{d u} - \\alpha \\right) = \\frac{1}{2}(a - |a|)\n$$\nIf $a > 0$, then $|a|=a$, so $\\frac{d f^{+}}{d u} = \\frac{1}{2}(a+a) = a > 0$ and $\\frac{d f^{-}}{d u} = \\frac{1}{2}(a-a) = 0$.\nIf $a  0$, then $|a|=-a$, so $\\frac{d f^{+}}{d u} = \\frac{1}{2}(a-a) = 0$ and $\\frac{d f^{-}}{d u} = \\frac{1}{2}(a - (-a)) = a  0$.\nIf $a = 0$, both derivatives are $0$.\nIn all cases, the conditions $\\frac{d f^{+}}{d u} \\ge 0$ and $\\frac{d f^{-}}{d u} \\le 0$ are satisfied. This choice for $\\alpha$ correctly separates the flux according to the sign of the characteristic speed $a$.\n\nA numerical flux consistent with this splitting is constructed based on the direction of information propagation. The positive-going flux $f^{+}$ propagates information to the right and should thus be evaluated using the state from the left cell, $u_i$. The negative-going flux $f^{-}$ propagates information to the left and should be evaluated using the state from the right cell, $u_{i+1}$. This leads to the Steger-Warming flux-vector splitting form for the numerical flux at interface $x_{i+1/2}$:\n$$\nF_{i+1/2} = f^{+}(u_i) + f^{-}(u_{i+1})\n$$\nSubstituting the expressions for $f^{\\pm}$:\n$$\nF_{i+1/2} = \\frac{1}{2}(a u_i + |a| u_i) + \\frac{1}{2}(a u_{i+1} - |a| u_{i+1}) = \\frac{1}{2}a(u_i + u_{i+1}) - \\frac{1}{2}|a|(u_{i+1} - u_i)\n$$\nThis flux can be interpreted as a central difference flux, $\\frac{1}{2}(f(u_i)+f(u_{i+1}))$, with an added numerical dissipation term, $-\\frac{1}{2}|a|(u_{i+1}-u_i)$.\n\nThe fully discrete scheme using forward Euler time integration is $u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}(F_{i+1/2}^n - F_{i-1/2}^n)$. To proceed, we express the flux difference:\n$$\nF_{i+1/2}^n - F_{i-1/2}^n = \\left[ f^{+}(u_i^n) + f^{-}(u_{i+1}^n) \\right] - \\left[ f^{+}(u_{i-1}^n) + f^{-}(u_i^n) \\right]\n$$\nUsing the definitions of $f^{\\pm}(u)$ with $\\alpha = |a|$:\n$$\nF_{i+1/2}^n - F_{i-1/2}^n = \\frac{1}{2}(a+|a|)u_i^n + \\frac{1}{2}(a-|a|)u_{i+1}^n - \\frac{1}{2}(a+|a|)u_{i-1}^n - \\frac{1}{2}(a-|a|)u_i^n\n$$\n$$\n= \\frac{1}{2}(a-|a|)u_{i+1}^n + \\frac{1}{2}[(a+|a|) - (a-|a|)]u_i^n - \\frac{1}{2}(a+|a|)u_{i-1}^n\n$$\n$$\n= \\frac{1}{2}(a-|a|)u_{i+1}^n + |a|u_i^n - \\frac{1}{2}(a+|a|)u_{i-1}^n\n$$\nIf $a > 0$, $|a|=a$, the flux difference becomes $0 \\cdot u_{i+1}^n + a u_i^n - a u_{i-1}^n = a(u_i^n - u_{i-1}^n)$.\nIf $a  0$, $|a|=-a$, the flux difference becomes $a u_{i+1}^n - a u_i^n - 0 \\cdot u_{i-1}^n = a(u_{i+1}^n - u_i^n)$.\nThe resulting scheme is the first-order upwind scheme:\n$$\nu_i^{n+1} = \\begin{cases} u_i^n - \\frac{a \\Delta t}{\\Delta x}(u_i^n - u_{i-1}^n)  \\text{if } a > 0 \\\\ u_i^n - \\frac{a \\Delta t}{\\Delta x}(u_{i+1}^n - u_i^n)  \\text{if } a  0 \\end{cases}\n$$\nWe now perform a von Neumann stability analysis. We seek a solution of the form $u_j^n = G^n e^{I j k \\Delta x}$, where $k$ is the wavenumber, $I = \\sqrt{-1}$, and $G$ is the amplification factor. Let $\\phi = k \\Delta x$.\n\nCase $1$: $a > 0$. Let the Courant number be $\\nu = \\frac{a \\Delta t}{\\Delta x} > 0$.\nThe scheme is $u_i^{n+1} = u_i^n - \\nu(u_i^n - u_{i-1}^n)$. Substituting the Fourier mode:\n$$\nG^{n+1} e^{I j \\phi} = G^n e^{I j \\phi} - \\nu(G^n e^{I j \\phi} - G^n e^{I (j-1) \\phi})\n$$\nDividing by $G^n e^{I j \\phi}$ gives the amplification factor:\n$$\nG = 1 - \\nu(1 - e^{-I \\phi}) = 1 - \\nu(1 - \\cos\\phi + I\\sin\\phi) = (1 - \\nu + \\nu\\cos\\phi) - I\\nu\\sin\\phi\n$$\nThe squared magnitude of the amplification factor is:\n$$\n|G|^2 = (1 - \\nu + \\nu\\cos\\phi)^2 + (-\\nu\\sin\\phi)^2 = (1-\\nu)^2 + 2\\nu(1-\\nu)\\cos\\phi + \\nu^2\\cos^2\\phi + \\nu^2\\sin^2\\phi\n$$\n$$\n|G|^2 = 1 - 2\\nu + \\nu^2 + 2\\nu\\cos\\phi - 2\\nu^2\\cos\\phi + \\nu^2 = 1 - 2\\nu(1-\\cos\\phi) + 2\\nu^2(1-\\cos\\phi)\n$$\n$$\n|G|^2 = 1 + 2\\nu(\\nu-1)(1-\\cos\\phi)\n$$\nFor stability, we require $|G|^2 \\le 1$ for all $\\phi$. Since $1-\\cos\\phi \\ge 0$, and we know $\\nu > 0$, stability requires $\\nu-1 \\le 0$, or $\\nu \\le 1$. Thus, for $a>0$, we need $0  \\frac{a \\Delta t}{\\Delta x} \\le 1$.\n\nCase $2$: $a  0$. Let $\\nu = \\frac{a \\Delta t}{\\Delta x}  0$.\nThe scheme is $u_i^{n+1} = u_i^n - \\nu(u_{i+1}^n - u_i^n)$. Substituting the Fourier mode:\n$$\nG^{n+1} e^{I j \\phi} = G^n e^{I j \\phi} - \\nu(G^n e^{I (j+1) \\phi} - G^n e^{I j \\phi})\n$$\n$$\nG = 1 - \\nu(e^{I\\phi} - 1) = 1 - \\nu(\\cos\\phi - 1 + I\\sin\\phi) = (1 - \\nu(\\cos\\phi - 1)) - I\\nu\\sin\\phi\n$$\n$$\n|G|^2 = (1 + \\nu(1-\\cos\\phi))^2 + (-\\nu\\sin\\phi)^2 = 1 + 2\\nu(1-\\cos\\phi) + \\nu^2(1-\\cos\\phi)^2 + \\nu^2\\sin^2\\phi\n$$\n$$\n|G|^2 = 1 + 2\\nu(1-\\cos\\phi) + \\nu^2(1 - 2\\cos\\phi + \\cos^2\\phi + \\sin^2\\phi) = 1 + 2\\nu(1-\\cos\\phi) + 2\\nu^2(1-\\cos\\phi)\n$$\n$$\n|G|^2 = 1 + 2\\nu(\\nu+1)(1-\\cos\\phi)\n$$\nSince $1-\\cos\\phi \\ge 0$ and $\\nu  0$, stability requires $\\nu+1 \\ge 0$, or $\\nu \\ge -1$. Thus, for $a0$, we need $-1 \\le \\frac{a \\Delta t}{\\Delta x}  0$.\n\nCombining both cases, the stability condition is $-1 \\le \\frac{a \\Delta t}{\\Delta x} \\le 1$, which can be written compactly as:\n$$\n\\left| \\frac{a \\Delta t}{\\Delta x} \\right| \\le 1\n$$\nThis is the Courant–Friedrichs–Lewy (CFL) stability condition for the first-order upwind scheme. To find the largest possible time step $\\Delta t_{\\max}$ that guarantees stability, we take the equality:\n$$\n\\frac{|a| \\Delta t_{\\max}}{\\Delta x} = 1\n$$\nSolving for $\\Delta t_{\\max}$ (assuming $a \\neq 0$), we obtain:\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|a|}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\Delta x}{|a|}}\n$$"
        },
        {
            "introduction": "Moving from the linear model to real-world gas dynamics, this practice tackles the full one-dimensional Euler equations. Here, you will implement the Harten–Lax–van Leer–Contact (HLLC) approximate Riemann solver, a workhorse method in modern CFD known for its robustness and ability to resolve contact discontinuities. This hands-on calculation  will walk you through estimating wave speeds and constructing the intermediate states to compute the numerical flux for a challenging shock tube problem.",
            "id": "3960650",
            "problem": "Consider the one-dimensional Euler equations of gas dynamics for a calorically perfect gas with constant ratio of specific heats $\\gamma$, posed as a Riemann problem at a cell face in a finite-volume method for Computational Fluid Dynamics (CFD). The left and right states of air (assumed an ideal gas) at the interface are:\n- Left state: density $\\rho_{L} = 1.0$, velocity $u_{L} = 200$, pressure $p_{L} = 1.0 \\times 10^{5}$.\n- Right state: density $\\rho_{R} = 0.5$, velocity $u_{R} = -50$, pressure $p_{R} = 8.0 \\times 10^{4}$.\nUse $\\gamma = 1.4$ and assume the interface normal is aligned with the $x$-direction so that all velocities are normal components.\n\nStarting from the conservative form of the Euler equations, the ideal-gas relations, and the Rankine–Hugoniot jump conditions across waves, estimate the left and right bounding wave speeds $S_{L}$ and $S_{R}$ using Einfeldt’s wave-speed estimates based on Roe-averaged quantities, determine the contact wave speed $S_{M}$ by enforcing physically correct contact-wave constraints, and then construct the Harten–Lax–van Leer–Contact (HLLC) approximate Riemann solution to obtain the numerical flux for the $x$-momentum component at the interface.\n\nCarry out the full derivation from first principles of the required intermediate relations (including the Roe averages, sound speeds, contact speed, and star-region density needed by HLLC), then evaluate the resulting HLLC momentum flux numerically for the given states. Round your final numerical flux to four significant figures. Express the final flux value in $\\mathrm{N/m^{2}}$.",
            "solution": "The one-dimensional Euler equations in conservative form are given by:\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = 0\n$$\nwhere $\\boldsymbol{U}$ is the vector of conserved variables and $\\boldsymbol{F}(\\boldsymbol{U})$ is the vector of fluxes:\n$$\n\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad \\boldsymbol{F}(\\boldsymbol{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (E+p)u \\end{pmatrix}\n$$\nHere, $\\rho$ is the density, $u$ is the velocity, $p$ is the pressure, and $E$ is the total energy per unit volume. For a calorically perfect gas, the total energy is related to the pressure by the equation of state:\n$$\nE = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2\n$$\nwhere $\\gamma$ is the ratio of specific heats.\n\nThe Harten–Lax–van Leer–Contact (HLLC) solver approximates the solution to the Riemann problem by assuming a three-wave structure consisting of a leftmost wave, a contact wave, and a rightmost wave, with speeds $S_L$, $S_M$, and $S_R$, respectively. These waves separate four constant states: the initial left state ($L$), a left-star state ($L*$), a right-star state ($R*$), and the initial right state ($R$). The HLLC numerical flux at the interface ($x/t = 0$) is determined by which region this interface lies in:\n$$\n\\boldsymbol{F}_{HLLC} =\n\\begin{cases}\n\\boldsymbol{F}_L  \\text{if } 0 \\le S_L \\\\\n\\boldsymbol{F}_L^*  \\text{if } S_L \\le 0  S_M \\\\\n\\boldsymbol{F}_R^*  \\text{if } S_M \\le 0  S_R \\\\\n\\boldsymbol{F}_R  \\text{if } 0 \\ge S_R\n\\end{cases}\n$$\nThe intermediate fluxes $\\boldsymbol{F}_L^*$ and $\\boldsymbol{F}_R^*$ are derived from the Rankine-Hugoniot jump conditions. The problem requires the calculation of the momentum component of this flux, which corresponds to the second component of the vector $\\boldsymbol{F}_{HLLC}$.\n\nThe calculation proceeds in several steps.\n\n**Step 1: Define initial states and calculate derived properties**\nThe given left ($L$) and right ($R$) states are:\n$\\rho_L = 1.0 \\, \\mathrm{kg/m^3}$, $u_L = 200 \\, \\mathrm{m/s}$, $p_L = 1.0 \\times 10^5 \\, \\mathrm{Pa}$\n$\\rho_R = 0.5 \\, \\mathrm{kg/m^3}$, $u_R = -50 \\, \\mathrm{m/s}$, $p_R = 8.0 \\times 10^4 \\, \\mathrm{Pa}$\nThe ratio of specific heats is $\\gamma = 1.4$.\n\nFirst, we compute the speed of sound $a = \\sqrt{\\gamma p / \\rho}$ for each state:\n$$\na_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times 1.0 \\times 10^5}{1.0}} = \\sqrt{140000} \\approx 374.166 \\, \\mathrm{m/s}\n$$\n$$\na_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times 8.0 \\times 10^4}{0.5}} = \\sqrt{224000} \\approx 473.286 \\, \\mathrm{m/s}\n$$\n\n**Step 2: Calculate Roe-averaged quantities**\nEinfeldt's wave speed estimates rely on Roe-averaged values. The Roe averages are defined as:\n$$\n\\tilde{\\rho} = \\sqrt{\\rho_L \\rho_R}\n$$\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L}u_L + \\sqrt{\\rho_R}u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho_L}H_L + \\sqrt{\\rho_R}H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\nwhere $H = (E+p)/\\rho$ is the specific enthalpy.\nThe Roe-averaged speed of sound $\\tilde{a}$ is given by:\n$$\n\\tilde{a} = \\sqrt{(\\gamma-1)(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2)}\n$$\nWe first compute specific enthalpies $H_L$ and $H_R$:\n$$\nH_L = \\frac{E_L+p_L}{\\rho_L} = \\frac{1}{\\rho_L}\\left(\\frac{p_L}{\\gamma-1} + \\frac{1}{2}\\rho_L u_L^2 + p_L\\right) = \\frac{\\gamma p_L}{(\\gamma-1)\\rho_L} + \\frac{1}{2}u_L^2 = \\frac{a_L^2}{\\gamma-1} + \\frac{1}{2}u_L^2\n$$\n$$\nH_L = \\frac{140000}{0.4} + \\frac{1}{2}(200)^2 = 350000 + 20000 = 370000 \\, \\mathrm{m^2/s^2}\n$$\n$$\nH_R = \\frac{a_R^2}{\\gamma-1} + \\frac{1}{2}u_R^2 = \\frac{224000}{0.4} + \\frac{1}{2}(-50)^2 = 560000 + 1250 = 561250 \\, \\mathrm{m^2/s^2}\n$$\nNow we compute the Roe averages:\n$$\n\\tilde{u} = \\frac{\\sqrt{1.0}(200) + \\sqrt{0.5}(-50)}{1 + \\sqrt{0.5}} \\approx \\frac{200 - 35.355}{1.7071} \\approx 96.447 \\, \\mathrm{m/s}\n$$\n$$\n\\tilde{H} = \\frac{\\sqrt{1.0}(370000) + \\sqrt{0.5}(561250)}{1 + \\sqrt{0.5}} \\approx \\frac{370000 + 396860}{1.7071} \\approx 449218 \\, \\mathrm{m^2/s^2}\n$$\n$$\n\\tilde{a} = \\sqrt{(1.4-1)(449218 - \\frac{1}{2}(96.447)^2)} \\approx \\sqrt{0.4(449218 - 4651.1)} \\approx 421.695 \\, \\mathrm{m/s}\n$$\n\n**Step 3: Estimate bounding wave speeds $S_L$ and $S_R$**\nUsing Einfeldt's estimates:\n$$\nS_L = \\min(u_L - a_L, \\tilde{u} - \\tilde{a})\n$$\n$$\nS_R = \\max(u_R + a_R, \\tilde{u} + \\tilde{a})\n$$\nSubstituting the calculated values:\n$$\nS_L = \\min(200 - 374.166, 96.447 - 421.695) = \\min(-174.166, -325.248) = -325.248 \\, \\mathrm{m/s}\n$$\n$$\nS_R = \\max(-50 + 473.286, 96.447 + 421.695) = \\max(423.286, 518.142) = 518.142 \\, \\mathrm{m/s}\n$$\n\n**Step 4: Determine the contact wave speed $S_M$**\nThe HLLC solver enforces the conditions that the velocity $u$ and pressure $p$ are constant across the contact discontinuity, i.e., $u_{L*} = u_{R*} = u_*$ and $p_{L*} = p_{R*} = p_*$. The contact wave speed is $S_M = u_*$. The pressure in the star region, $p_*$, can be related to the initial states by applying the Rankine-Hugoniot conditions across the left and right waves:\n$$\np_* = p_L + \\rho_L(u_L - S_L)(u_L - S_M)\n$$\n$$\np_* = p_R + \\rho_R(u_R - S_R)(u_R - S_M)\n$$\nEquating these two expressions and solving for $S_M$ yields:\n$$\nS_M = \\frac{p_R - p_L + \\rho_L u_L(S_L - u_L) - \\rho_R u_R(S_R - u_R)}{\\rho_L(S_L - u_L) - \\rho_R(S_R - u_R)}\n$$\nWe compute the terms in the numerator and denominator:\nNumerator:\n- $p_R - p_L = 8.0 \\times 10^4 - 1.0 \\times 10^5 = -20000$\n- $\\rho_L u_L(S_L - u_L) = 1.0 \\times 200 \\times (-325.248 - 200) = -105049.6$\n- $\\rho_R u_R(S_R - u_R) = 0.5 \\times (-50) \\times (518.142 - (-50)) = -14203.55$\n- Numerator $= -20000 - 105049.6 - (-14203.55) = -110846.05$\n\nDenominator:\n- $\\rho_L(S_L - u_L) = 1.0 \\times (-325.248 - 200) = -525.248$\n- $\\rho_R(S_R - u_R) = 0.5 \\times (518.142 - (-50)) = 284.071$\n- Denominator $= -525.248 - 284.071 = -809.319$\n\n$$\nS_M = \\frac{-110846.05}{-809.319} \\approx 136.964 \\, \\mathrm{m/s}\n$$\n\n**Step 5: Construct the HLLC momentum flux**\nWe have $S_L \\approx -325.25 \\, \\mathrm{m/s}$, $S_M \\approx 136.96 \\, \\mathrm{m/s}$, and $S_R \\approx 518.14 \\, \\mathrm{m/s}$. Since $S_L  0  S_M$, the interface lies in the left-star ($L*$) region. The HLLC flux is thus $\\boldsymbol{F}_{HLLC} = \\boldsymbol{F}_L^*$.\nThe momentum component of the flux in any region is $(\\rho u^2 + p)$. In the $L*$ region, the velocity is $u_{L*} = S_M$ and the pressure is $p_{L*} = p_*$. The density is $\\rho_{L*}$. Thus, the desired momentum flux is:\n$$\nf_{HLLC}^{(2)} = (\\rho u^2+p)_{L*} = \\rho_{L*} S_M^2 + p_*\n$$\nWe need to calculate $p_*$ and $\\rho_{L*}$. Since the interface is in the $L*$ region, we use the expression for $p_*$ derived from the left state:\n$$\np_* = p_L + \\rho_L(u_L - S_L)(u_L - S_M)\n$$\n$$\np_* = 1.0 \\times 10^5 + 1.0 \\times (200 - (-325.248)) \\times (200 - 136.964)\n$$\n$$\np_* = 1.0 \\times 10^5 + (525.248) \\times (63.036) \\approx 100000 + 33109.5 \\approx 133109.5 \\, \\text{Pa}\n$$\nThe density $\\rho_{L*}$ is found from the mass conservation jump condition across the left wave:\n$$\n\\rho_{L*} = \\rho_L \\frac{S_L - u_L}{S_L - S_M}\n$$\n$$\n\\rho_{L*} = 1.0 \\times \\frac{-325.248 - 200}{-325.248 - 136.964} = \\frac{-525.248}{-462.212} \\approx 1.13637 \\, \\mathrm{kg/m^3}\n$$\nNow we can compute the momentum flux:\n$$\nf_{HLLC}^{(2)} = \\rho_{L*} S_M^2 + p_* \\approx 1.13637 \\times (136.964)^2 + 133109.5\n$$\n$$\nf_{HLLC}^{(2)} \\approx 1.13637 \\times 18759.16 + 133109.5 \\approx 21316.6 + 133109.5 = 154426.1 \\, \\mathrm{N/m^2}\n$$\nRounding to four significant figures as requested, the result is $1.544 \\times 10^5 \\, \\mathrm{N/m^2}$.",
            "answer": "$$\n\\boxed{1.544 \\times 10^{5}}\n$$"
        },
        {
            "introduction": "Why is the added complexity of the HLLC scheme necessary? This final practice provides the answer by directly comparing its performance against its simpler predecessor, the Harten-Lax-van Leer-Einfeldt (HLLE) scheme, for a problem dominated by a contact discontinuity. By quantifying the numerical mass flux error for both methods , you will gain a profound appreciation for how restoring the contact wave in the approximate Riemann solution drastically reduces numerical dissipation and improves simulation accuracy.",
            "id": "3960531",
            "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma$,\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = \\boldsymbol{0},\n$$\nwhere the conserved variables and fluxes are\n$$\n\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad\n\\boldsymbol{F}(\\boldsymbol{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(E + p) \\end{pmatrix},\n$$\nand the equation of state closes the system via $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$. In a finite-volume Godunov method in Computational Fluid Dynamics (CFD), the intercell numerical flux is obtained from a Riemann solver. Two widely used flux-difference splitting methods are the Harten-Lax-van Leer-Einfeldt (HLLE) solver and the Harten-Lax-van Leer-Contact (HLLC) solver.\n\nWe examine a near-contact Riemann problem characterized by equal velocities and nearly equal pressures but a density jump. The left and right initial states are\n$$\n(\\rho_{L}, u_{L}, p_{L}) = \\left(1.0,\\, 0,\\, 1.00000 \\times 10^{5}\\right),\n\\quad\n(\\rho_{R}, u_{R}, p_{R}) = \\left(0.125,\\, 0,\\, 1.00100 \\times 10^{5}\\right),\n$$\nwith $\\gamma = 1.4$. Let $c_{K} = \\sqrt{\\gamma p_{K}/\\rho_{K}}$ denote the local speed of sound for $K \\in \\{L, R\\}$. Use Einfeldt’s signal speed estimates for HLLE, namely the minimal and maximal wave speeds\n$$\nS_{L} = \\min\\{u_{L} - c_{L},\\, u_{R} - c_{R}\\}, \\quad S_{R} = \\max\\{u_{L} + c_{L},\\, u_{R} + c_{R}\\}.\n$$\nFor HLLC, use the standard three-wave structure including the contact wave with speed $S_{M}$ and star-region states consistent with the Rankine–Hugoniot conditions across each wave. In particular, determine the appropriate star-state density and the corresponding mass flux across the interface.\n\nDefine the contact-capturing error magnitude for a given solver as the absolute interfacial mass flux,\n$$\n\\mathcal{E} \\equiv \\left| F_{\\rho} \\right|,\n$$\nwhere $F_{\\rho}$ is the mass component of the solver’s intercell flux for the given left/right states. Compute\n$$\n\\mathcal{R} \\equiv \\frac{\\mathcal{E}_{\\mathrm{HLLE}}}{\\mathcal{E}_{\\mathrm{HLLC}}},\n$$\nfor the states above, interpreting $S_{M}$ and the star-region quantities in the standard way for HLLC.\n\nProvide your final answer for $\\mathcal{R}$ as a dimensionless number, rounded to four significant figures.",
            "solution": "The problem asks for the ratio $\\mathcal{R} = \\mathcal{E}_{\\mathrm{HLLE}} / \\mathcal{E}_{\\mathrm{HLLC}}$, where $\\mathcal{E} = |F_{\\rho}|$ is the magnitude of the interfacial mass flux for a given solver. We will compute the intercell mass flux for both the HLLE and HLLC schemes for the specified near-contact Riemann problem and then find their ratio.\n\nThe initial left ($L$) and right ($R$) states are given as:\n$(\\rho_{L}, u_{L}, p_{L}) = (1.0, 0, 1.0 \\times 10^{5})$\n$(\\rho_{R}, u_{R}, p_{R}) = (0.125, 0, 1.001 \\times 10^{5})$\nThe ratio of specific heats is $\\gamma = 1.4$. All values are in consistent SI units.\n\nFirst, we calculate the derived quantities for the left and right states.\nThe speed of sound $c$ is given by $c = \\sqrt{\\gamma p / \\rho}$.\nFor the left state:\n$$c_{L} = \\sqrt{\\frac{\\gamma p_{L}}{\\rho_{L}}} = \\sqrt{\\frac{1.4 \\times 1.0 \\times 10^{5}}{1.0}} = \\sqrt{140000} \\approx 374.1657 \\, \\mathrm{m/s}$$\nFor the right state:\n$$c_{R} = \\sqrt{\\frac{\\gamma p_{R}}{\\rho_{R}}} = \\sqrt{\\frac{1.4 \\times 1.001 \\times 10^{5}}{0.125}} = \\sqrt{1121120} \\approx 1058.8295 \\, \\mathrm{m/s}$$\n\nThe state vectors $\\boldsymbol{U} = (\\rho, \\rho u, E)^T$ and flux vectors $\\boldsymbol{F} = (\\rho u, \\rho u^2+p, u(E+p))^T$ are determined next. The total energy per unit volume $E$ is given by the equation of state: $E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$.\nFor the left state ($u_L=0$):\n$$E_L = \\frac{p_L}{\\gamma-1} = \\frac{1.0 \\times 10^5}{1.4 - 1} = 2.5 \\times 10^5$$\n$$\\boldsymbol{U}_L = \\begin{pmatrix} 1.0 \\\\ 0 \\\\ 2.5 \\times 10^5 \\end{pmatrix}, \\quad \\boldsymbol{F}_L = \\begin{pmatrix} 0 \\\\ 1.0 \\times 10^5 \\\\ 0 \\end{pmatrix}$$\nFor the right state ($u_R=0$):\n$$E_R = \\frac{p_R}{\\gamma-1} = \\frac{1.001 \\times 10^5}{1.4 - 1} = 2.5025 \\times 10^5$$\n$$\\boldsymbol{U}_R = \\begin{pmatrix} 0.125 \\\\ 0 \\\\ 2.5025 \\times 10^5 \\end{pmatrix}, \\quad \\boldsymbol{F}_R = \\begin{pmatrix} 0 \\\\ 1.001 \\times 10^5 \\\\ 0 \\end{pmatrix}$$\n\nNow we analyze the HLLE solver. The wave speeds are given by Einfeldt's estimates:\n$$S_L = \\min(u_L - c_L, u_R - c_R) = \\min(0 - c_L, 0 - c_R) = -\\max(c_L, c_R) = -c_R \\approx -1058.8295$$\n$$S_R = \\max(u_L + c_L, u_R + c_R) = \\max(c_L, c_R) = c_R \\approx 1058.8295$$\nThe HLLE intercell flux is given by:\n$$\\boldsymbol{F}_{\\mathrm{HLLE}} = \\frac{S_R \\boldsymbol{F}_L - S_L \\boldsymbol{F}_R + S_L S_R (\\boldsymbol{U}_R - \\boldsymbol{U}_L)}{S_R - S_L}$$\nWe are interested in the mass flux component, $F_\\rho$, which is the first component of the flux vector.\n$$F_{\\rho, \\mathrm{HLLE}} = \\frac{S_R F_{\\rho,L} - S_L F_{\\rho,R} + S_L S_R (\\rho_R - \\rho_L)}{S_R - S_L}$$\nSince $u_L=u_R=0$, the mass flux components of $\\boldsymbol{F}_L$ and $\\boldsymbol{F}_R$ are zero ($F_{\\rho,L}=F_{\\rho,R}=0$).\n$$F_{\\rho, \\mathrm{HLLE}} = \\frac{S_L S_R (\\rho_R - \\rho_L)}{S_R - S_L} = \\frac{(-c_R)(c_R)(\\rho_R - \\rho_L)}{c_R - (-c_R)} = \\frac{-c_R^2 (\\rho_R - \\rho_L)}{2c_R} = \\frac{-c_R (\\rho_R - \\rho_L)}{2}$$\nSubstituting the values:\n$$F_{\\rho, \\mathrm{HLLE}} = \\frac{-(1058.8295)(0.125 - 1.0)}{2} = \\frac{-1058.8295(-0.875)}{2} \\approx 463.2379$$\nThe contact-capturing error for HLLE is:\n$$\\mathcal{E}_{\\mathrm{HLLE}} = |F_{\\rho, \\mathrm{HLLE}}| \\approx 463.2379$$\n\nNext, we analyze the HLLC solver. The outer wave speeds $S_L$ and $S_R$ are taken to be the same as for HLLE. The HLLC method introduces a middle wave speed, $S_M$, for the contact discontinuity. The standard formula for $S_M$ is:\n$$S_M = \\frac{p_R - p_L + \\rho_L u_L(S_L - u_L) - \\rho_R u_R(S_R - u_R)}{\\rho_L(S_L - u_L) - \\rho_R(S_R - u_R)}$$\nWith $u_L=u_R=0$:\n$$S_M = \\frac{p_R - p_L}{\\rho_L S_L - \\rho_R S_R} = \\frac{1.001 \\times 10^5 - 1.0 \\times 10^5}{\\rho_L(-c_R) - \\rho_R(c_R)} = \\frac{100}{-c_R(\\rho_L + \\rho_R)}$$\n$$S_M = \\frac{100}{-1058.8295(1.0 + 0.125)} = \\frac{100}{-1191.1832} \\approx -0.083949$$\nThe wave speeds are ordered as $S_L  S_M  0  S_R$. The interface, located at $x/t=0$, falls in the region between the contact wave ($S_M$) and the rightmost wave ($S_R$). The HLLC flux is therefore given by the flux in the right star region, $\\boldsymbol{F}_R^*$.\n$$\\boldsymbol{F}_{\\mathrm{HLLC}} = \\boldsymbol{F}_R^* = \\begin{pmatrix} \\rho_R^* u_R^* \\\\ \\rho_R^* (u_R^*)^2 + p^* \\\\ u_R^* (E_R^* + p^*) \\end{pmatrix}$$\nIn the HLLC model, the velocity in the star regions is equal to the contact speed, so $u_R^* = S_M$. The density in the right star region is:\n$$\\rho_R^* = \\rho_R \\frac{S_R - u_R}{S_R - S_M} = \\rho_R \\frac{S_R}{S_R - S_M}$$\nThe mass flux component is thus:\n$$F_{\\rho, \\mathrm{HLLC}} = \\rho_R^* u_R^* = \\left(\\rho_R \\frac{S_R}{S_R - S_M}\\right) S_M$$\nSubstituting the values:\n$$F_{\\rho, \\mathrm{HLLC}} = (0.125) \\frac{1058.8295}{1058.8295 - (-0.083949)} (-0.083949)$$\n$$F_{\\rho, \\mathrm{HLLC}} = (0.125) \\frac{1058.8295}{1058.91345} (-0.083949) \\approx (0.125)(0.9999207)(-0.083949) \\approx -0.010493$$\nThe contact-capturing error for HLLC is:\n$$\\mathcal{E}_{\\mathrm{HLLC}} = |F_{\\rho, \\mathrm{HLLC}}| \\approx 0.010493$$\n\nFinally, we compute the ratio $\\mathcal{R}$:\n$$\\mathcal{R} = \\frac{\\mathcal{E}_{\\mathrm{HLLE}}}{\\mathcal{E}_{\\mathrm{HLLC}}} = \\frac{463.2379}{0.010493} \\approx 44151.7$$\nRounding to four significant figures, we get $44150$. To express this unambiguously with four significant figures, we use scientific notation: $4.415 \\times 10^4$.",
            "answer": "$$\\boxed{4.415 \\times 10^4}$$"
        }
    ]
}