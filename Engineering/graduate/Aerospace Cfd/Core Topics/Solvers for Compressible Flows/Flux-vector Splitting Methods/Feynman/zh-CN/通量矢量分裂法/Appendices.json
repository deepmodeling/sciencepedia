{
    "hands_on_practices": [
        {
            "introduction": "掌握通量矢量分裂方法不仅仅是理解其公式，更关键的是要能够分析其内在行为并解决其固有的局限性。数值扩散是一个常见的计算产物，它会人为地模糊接触间断等尖锐特征，而早期的 Steger-Warming 格式尤其容易产生这种问题。本练习  将指导您使用修正方程分析这一强大工具，从原理上推导出该数值误差的精确形式，从而将一个定性的问题转化为定量的分析，揭示该格式过度耗散的根源。",
            "id": "3960852",
            "problem": "考虑理想气体的一维可压缩欧拉方程，其守恒形式写作 $\\partial_{t}\\boldsymbol{U} + \\partial_{x}\\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0}$，其中 $\\boldsymbol{U} = [\\rho, \\rho u, \\rho E]^{\\top}$，$\\boldsymbol{F}(\\boldsymbol{U}) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\top}$，以及 $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$，$\\gamma$ 为比热比。考虑一个黎曼初始条件，该条件具有一个接触间断，满足 $p_{L} = p_{R} = p_{0}$ 和 $u_{L} = u_{R} = u_{0}$，但 $\\rho_{L} \\neq \\rho_{R}$，因此精确解是一个以速度 $u_{0}$ 对流且没有压力波的接触波。\n\n在间距为 $\\Delta x$ 的均匀网格上，应用一阶有限体积半离散格式，并在单元界面处使用 Steger–Warming 通量矢量分裂。围绕常数状态 $\\boldsymbol{U}_{0}$ 对该格式进行线性化，并将更新量投影到通量雅可比矩阵的接触（熵）特征向量上。对与接触特征向量对齐的接触场振幅，使用主阶修正方程分析（保留至 $O(\\Delta x)$ 的项），推导由于 Steger–Warming 分裂而作用在接触波上的有效数值扩散系数。将最终结果表示为以 $u_{0}$ 和 $\\Delta x$ 表示的闭式解析表达式。将您的表达式表述为有效数值粘性，单位为平方米/秒 (m$^{2}$/s)。无需四舍五入。\n\n此外，简要解释为什么与 Steger–Warming 相比，对于给定的接触间断配置 $p_{L} = p_{R}$ 和 $u_{L} = u_{R}$，平流上游分裂方法+ (AUSM+) 会减少这种扩散。您的解释应从 AUSM+ 中对流通量和压力通量的结构分离以及接触波的特征属性出发。\n\n仅提供有效数值粘性系数的单个闭式表达式作为您的最终答案。",
            "solution": "问题陈述经评估在科学上是成立的、适定的、客观且自洽的。它代表了计算流体动力学 (CFD) 领域的标准分析，并且没有明显的缺陷。因此，将提供一个解决方案。\n\n该问题要求推导接触波的有效数值扩散系数，该接触波由一阶 Steger–Warming 通量矢量分裂格式建模。将使用修正方程方法对一维欧拉方程进行分析。\n\n在间距为 $\\Delta x$ 的均匀网格上，单元 $i$ 的半离散有限体积格式由下式给出：\n$$\n\\frac{d\\boldsymbol{U}_i}{dt} = -\\frac{1}{\\Delta x} \\left( \\hat{\\boldsymbol{F}}_{i+1/2} - \\hat{\\boldsymbol{F}}_{i-1/2} \\right)\n$$\n其中 $\\boldsymbol{U}_i$ 是单元平均状态向量。对于采用 Steger–Warming 分裂的一阶格式，界面 $i+1/2$ 处的数值通量为：\n$$\n\\hat{\\boldsymbol{F}}_{i+1/2} = \\boldsymbol{F}^+(\\boldsymbol{U}_i) + \\boldsymbol{F}^-(\\boldsymbol{U}_{i+1})\n$$\n通量 $\\boldsymbol{F}^+$ 和 $\\boldsymbol{F}^-$ 分别是物理通量 $\\boldsymbol{F}$ 中与通量雅可比矩阵 $\\boldsymbol{A} = \\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{U}}$ 的正特征值和负特征值相关的部分。它们由 $\\boldsymbol{F}^{\\pm} = \\boldsymbol{A}^{\\pm}\\boldsymbol{U}$ 定义，其中 $\\boldsymbol{A}^{\\pm} = \\boldsymbol{S}\\boldsymbol{\\Lambda}^{\\pm}\\boldsymbol{S}^{-1}$，$\\boldsymbol{\\Lambda}$ 是 $\\boldsymbol{A}$ 的特征值对角矩阵，$\\boldsymbol{\\Lambda}^{\\pm}$ 包含特征值的正部和负部。\n\n将数值通量代入半离散方程，得到：\n$$\n\\frac{d\\boldsymbol{U}_i}{dt} = -\\frac{1}{\\Delta x} \\left[ \\left(\\boldsymbol{F}^+(\\boldsymbol{U}_i) + \\boldsymbol{F}^-(\\boldsymbol{U}_{i+1})\\right) - \\left(\\boldsymbol{F}^+(\\boldsymbol{U}_{i-1}) + \\boldsymbol{F}^-(\\boldsymbol{U}_{i})\\right) \\right]\n$$\n整理各项：\n$$\n\\frac{d\\boldsymbol{U}_i}{dt} = -\\frac{1}{\\Delta x} \\left[ \\left(\\boldsymbol{F}^+(\\boldsymbol{U}_i) - \\boldsymbol{F}^+(\\boldsymbol{U}_{i-1})\\right) + \\left(\\boldsymbol{F}^-(\\boldsymbol{U}_{i+1}) - \\boldsymbol{F}^-(\\boldsymbol{U}_i)\\right) \\right]\n$$\n为推导修正方程，我们对通量项在位置 $x_i$ 附近进行泰勒级数展开：\n$$\n\\boldsymbol{F}^+(\\boldsymbol{U}_{i-1}) = \\boldsymbol{F}^+(\\boldsymbol{U}_i) - \\Delta x \\frac{\\partial \\boldsymbol{F}^+}{\\partial x} \\bigg|_i + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\boldsymbol{F}^+}{\\partial x^2} \\bigg|_i - O((\\Delta x)^3)\n$$\n$$\n\\boldsymbol{F}^-(\\boldsymbol{U}_{i+1}) = \\boldsymbol{F}^-(\\boldsymbol{U}_i) + \\Delta x \\frac{\\partial \\boldsymbol{F}^-}{\\partial x} \\bigg|_i + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\boldsymbol{F}^-}{\\partial x^2} \\bigg|_i + O((\\Delta x)^3)\n$$\n将这些展开式代入格式，并用其连续对应项替换左侧的时间导数，我们得到：\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} \\approx -\\frac{1}{\\Delta x} \\left[ \\Delta x \\frac{\\partial \\boldsymbol{F}^+}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\boldsymbol{F}^+}{\\partial x^2} + \\Delta x \\frac{\\partial \\boldsymbol{F}^-}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\boldsymbol{F}^-}{\\partial x^2} \\right] + O((\\Delta x)^2)\n$$\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} \\approx -\\left(\\frac{\\partial \\boldsymbol{F}^+}{\\partial x} + \\frac{\\partial \\boldsymbol{F}^-}{\\partial x}\\right) + \\frac{\\Delta x}{2} \\left(\\frac{\\partial^2 \\boldsymbol{F}^+}{\\partial x^2} - \\frac{\\partial^2 \\boldsymbol{F}^-}{\\partial x^2}\\right)\n$$\n由于 $\\boldsymbol{F} = \\boldsymbol{F}^+ + \\boldsymbol{F}^-$，第一项是 $-\\frac{\\partial \\boldsymbol{F}}{\\partial x}$。方程变为：\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}}{\\partial x} \\approx \\frac{\\Delta x}{2} \\frac{\\partial^2}{\\partial x^2} \\left( \\boldsymbol{F}^+ - \\boldsymbol{F}^- \\right)\n$$\n这是修正偏微分方程，它包含了数值格式的主阶误差项。为分析此误差项，我们在常数状态 $\\boldsymbol{U}_0$ 附近进行线性化。在这种情况下，$\\boldsymbol{F}^{\\pm}(\\boldsymbol{U}) \\approx \\boldsymbol{A}^{\\pm}(\\boldsymbol{U}_0)\\boldsymbol{U}$，这里我们使用了欧拉通量的齐次性。\n项 $\\boldsymbol{F}^+ - \\boldsymbol{F}^-$ 可以写作 $(\\boldsymbol{A}^+ - \\boldsymbol{A}^-)\\boldsymbol{U}$。矩阵 $\\boldsymbol{A}^+ - \\boldsymbol{A}^-$ 是 $\\boldsymbol{S}(\\boldsymbol{\\Lambda}^+ - \\boldsymbol{\\Lambda}^-)\\boldsymbol{S}^{-1} = \\boldsymbol{S}|\\boldsymbol{\\Lambda}|\\boldsymbol{S}^{-1} = |\\boldsymbol{A}|$，其中 $|\\boldsymbol{A}|$ 是一个矩阵，其特征值为 $\\boldsymbol{A}$ 的特征值的绝对值。\n线性化修正方程为：\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\boldsymbol{A} \\frac{\\partial \\boldsymbol{U}}{\\partial x} = \\frac{\\Delta x}{2} |\\boldsymbol{A}| \\frac{\\partial^2 \\boldsymbol{U}}{\\partial x^2}\n$$\n右侧代表了格式的数值扩散。\n\n我们关心的是作用在接触波上的扩散。这对应于与特征值 $\\lambda_2 = u$ 相关的特征场。我们将修正方程投影到 $\\boldsymbol{A}$ 的特征向量基上。设解的扰动分解为 $\\delta \\boldsymbol{U} = \\boldsymbol{U} - \\boldsymbol{U}_0 = \\sum_{k=1}^3 \\alpha_k \\boldsymbol{r}_k$，其中 $\\boldsymbol{r}_k$ 是 $\\boldsymbol{A}$ 的右特征向量，$\\alpha_k$ 是特征变量振幅。使用对应于 $\\lambda_2 = u$ 的左特征向量 $\\boldsymbol{l}_2^{\\top}$ 对该方程进行投影，分离出 $\\alpha_2$ 的演化：\n$$\n\\boldsymbol{l}_2^{\\top} \\left( \\frac{\\partial (\\alpha_2 \\boldsymbol{r}_2)}{\\partial t} + \\boldsymbol{A} \\frac{\\partial (\\alpha_2 \\boldsymbol{r}_2)}{\\partial x} \\right) = \\boldsymbol{l}_2^{\\top} \\left( \\frac{\\Delta x}{2} |\\boldsymbol{A}| \\frac{\\partial^2 (\\alpha_2 \\boldsymbol{r}_2)}{\\partial x^2} \\right)\n$$\n假设在此线性分析中特征向量是常数，并使用性质 $\\boldsymbol{A}\\boldsymbol{r}_2 = \\lambda_2 \\boldsymbol{r}_2$ 和 $\\boldsymbol{l}_2^{\\top}\\boldsymbol{r}_2 = 1$（经过适当归一化），左侧变为：\n$$\n\\frac{\\partial \\alpha_2}{\\partial t} + \\lambda_2 \\frac{\\partial \\alpha_2}{\\partial x}\n$$\n对于右侧，我们使用 $|\\boldsymbol{A}|\\boldsymbol{r}_2 = \\boldsymbol{S}|\\boldsymbol{\\Lambda}|\\boldsymbol{S}^{-1}\\boldsymbol{r}_2 = |\\lambda_2|\\boldsymbol{r}_2$。投影得到：\n$$\n\\boldsymbol{l}_2^{\\top} \\left( \\frac{\\Delta x}{2} |\\lambda_2|\\boldsymbol{r}_2 \\frac{\\partial^2 \\alpha_2}{\\partial x^2} \\right) = \\frac{\\Delta x}{2} |\\lambda_2| \\frac{\\partial^2 \\alpha_2}{\\partial x^2}\n$$\n因此，接触波振幅的修正方程是一个对流扩散方程：\n$$\n\\frac{\\partial \\alpha_2}{\\partial t} + \\lambda_2 \\frac{\\partial \\alpha_2}{\\partial x} = \\left(\\frac{\\Delta x}{2} |\\lambda_2|\\right) \\frac{\\partial^2 \\alpha_2}{\\partial x^2}\n$$\n问题指定了一个具有均匀速度 $u_L = u_R = u_0$ 的接触间断。因此，相关的特征值是 $\\lambda_2 = u_0$。乘以二阶空间导数的项是有效数值扩散系数 $\\nu_{\\text{num}}$。\n$$\n\\nu_{\\text{num}} = \\frac{1}{2} |u_0| \\Delta x\n$$\n该表达式表明 Steger–Warming 格式引入的数值扩散与波速和网格间距成正比，这会不期望地涂抹接触间断。\n\n关于平流上游分裂方法+ (AUSM+)，其在处理接触间断时的优越性能源于其对通量矢量的物理分裂而非数学分裂。AUSM+ 通量被分为对流部分和压力部分：$\\hat{\\boldsymbol{F}} = \\hat{\\boldsymbol{F}}_c + \\hat{\\boldsymbol{P}}$。对于给定的初始条件，$p_L = p_R = p_0$ 和 $u_L = u_R = u_0$。在这种情况下，压力是连续的，流体在界面上处于机械平衡状态。AUSM+ 中的压力通量项（设计用于处理声波）变得静止，不会引入虚假的压力振荡或扩散。对于恒定速度场，对流通量项有效地简化为对被对流的量（$\\rho$ 和 $\\rho E$）的简单上游平流。这种纯上游格式是输运接触间断的精确机制，导致非常低的数值扩散。相比之下，Steger–Warming 基于特征值的分裂强制所有特征场之间发生耦合。即使没有压力波存在，基于 $\\{u-c, u, u+c\\}$ 符号的分裂也会不恰当地混合来自左右状态的信息（它们的密度不同，$\\rho_L \\neq \\rho_R$），从而产生显著的数值扩散，涂抹接触面。",
            "answer": "$$\n\\boxed{\\frac{1}{2}|u_{0}|\\Delta x}\n$$"
        },
        {
            "introduction": "分析完数值扩散之后，我们转向另一个经典问题：声速点处的“扭结”或非光滑性。在 Steger-Warming 分裂中，用于构造耗散项的绝对值函数 $|u|$ 在流动速度等于声速（即马赫数 $M=1$）时存在不可微的点，这会破坏数值格式的光滑性，进而影响隐式求解的收敛性和解的质量。本练习  将引导您推导出一个光滑的“熵修正”函数来解决这一问题，这项技术在现代计算流体力学（CFD）的数值格式设计中得到了广泛应用。",
            "id": "3960890",
            "problem": "考虑量热完全气体的一维欧拉方程，其比热比为 $\\gamma$，以守恒形式写出状态向量 $U = [\\rho, \\rho u, \\rho E]^{\\mathsf{T}}$ 和对流通量 $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\mathsf{T}}$，其中 $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$。令 $A(U) = \\partial F / \\partial U$ 表示通量雅可比矩阵，其特征分解为 $A = R \\Lambda L$，特征值为 $\\lambda_{1} = u - c$、$\\lambda_{2} = u$ 和 $\\lambda_{3} = u + c$，右特征向量为 $R$，左特征向量为 $L$，当地声速为 $c = \\sqrt{\\gamma p/\\rho}$。在 Steger–Warming 通量矢量分裂中，通过基于绝对值运算将特征值分裂为正部和负部来定义正负通量贡献，这在计算流体力学（CFD）的界面数值通量中引入了特征耗散。\n\n假设位于 $x_{i+\\tfrac{1}{2}}$ 的有限体积界面将左右状态 $U_{L}$ 和 $U_{R}$ 分开，这两个状态是均匀基态 $U_{0}$ 的小扰动。考虑使用 $A(U_{0})$ 的特征分解和特征变量，围绕 $U_{0}$ 进行线性化分析。从第一性原理出发，推导界面处 Steger–Warming 数值通量的形式，该形式为一个中心（非耗散）项与一个特征耗散项之和，其中特征耗散项由特征值的模通过绝对值运算控制。利用此结果分析与 $\\lambda_{3}$ 相关的右行声学特征在声速点附近的行为，其中 $u + c$ 穿过零点。具体来说，通过写出 $u + c = \\eta$（其中 $|\\eta| \\ll 1$）来参数化与精确声速条件的偏离，并说明绝对值 $|\\eta|$ 如何在 $\\eta = 0$ 处引入一个不可微的尖点，这表现为声场中的左右对称耗散。\n\n为避免这种不可微尖点，同时在远离声速点时保持正确的渐近行为，请提出一个连续的特征值光滑函数 $\\psi(\\lambda)$，用于在特征耗散项中替代 $|\\lambda|$。你的光滑函数必须满足以下条件：\n- 它是偶函数：$\\psi(-\\lambda) = \\psi(\\lambda)$。\n- 它是连续可微的：$\\psi \\in C^{1}(\\mathbb{R})$。\n- 在远离声速区域时，它与未光滑的模相匹配：对于给定的一个小的正常滑参数 $\\varepsilon$，当 $|\\lambda| \\ge \\varepsilon$ 时，$\\psi(\\lambda) = |\\lambda|$。\n- 在声速过渡带 $|\\lambda|  \\varepsilon$ 内，它是一个关于 $\\lambda$ 的低阶多项式，其选择应使函数值及其导数在 $\\lambda = \\pm \\varepsilon$ 处与 $|\\lambda|$ 的值相匹配。\n\n在这些约束下，推导 $\\psi(\\lambda)$ 在 $|\\lambda|  \\varepsilon$ 上的唯一二次形式，然后将其特殊化，以获得在声速条件附近右行声学特征的光滑耗散大小，即 $\\alpha(\\eta, \\varepsilon) = \\psi(\\eta)$，其中 $|\\eta|  \\varepsilon$。请以 $\\alpha(\\eta, \\varepsilon)$ 的单一闭式解析表达式的形式提供你的最终答案，该表达式适用于 Steger–Warming 特征耗散项。最终表达式无需进行数值计算，也无需单位。",
            "solution": "该问题要求推导一种光滑函数，用于对 Steger–Warming 通量矢量分裂格式中的耗散项进行正则化，尤其是在声速点附近。推导从第一性原理出发，始于数值通量的结构，最终得到所需光滑函数的具体解析形式。\n\n一维欧拉方程以守恒形式给出，状态向量为 $U = [\\rho, \\rho u, \\rho E]^{\\mathsf{T}}$，对流通量为 $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\mathsf{T}}$。通量雅可比矩阵为 $A(U) = \\partial F / \\partial U$。对于围绕均匀基态 $U_0$ 的线性化分析，雅可比矩阵 $A_0 = A(U_0)$ 被视为常数。其特征分解为 $A_0 = R_0 \\Lambda_0 L_0$，其中 $\\Lambda_0$ 是由特征值 $\\lambda_j$ 组成的对角矩阵。\n\nSteger–Warming 通量矢量分裂格式通过将雅可比矩阵分裂为与正负特征值相关的部分，来定义位于左状态 $U_L$ 和右状态 $U_R$ 之间的单元界面 $x_{i+\\frac{1}{2}}$ 处的数值通量：\n$$ F_{i+\\frac{1}{2}} = A_0^+ U_L + A_0^- U_R $$\n此处，$A_0^+ = R_0 \\Lambda_0^+ L_0$ 且 $A_0^- = R_0 \\Lambda_0^- L_0$。对角矩阵 $\\Lambda_0^+$ 和 $\\Lambda_0^-$ 分别由特征值的正部和负部构成。这些可以用绝对值函数表示：$\\lambda^+_j = \\frac{1}{2}(\\lambda_j + |\\lambda_j|)$ 和 $\\lambda^-_j = \\frac{1}{2}(\\lambda_j - |\\lambda_j|)$。因此，矩阵为 $\\Lambda_0^{\\pm} = \\frac{1}{2}(\\Lambda_0 \\pm |\\Lambda_0|)$，其中 $|\\Lambda_0|$ 是对角元素为 $|\\lambda_j|$ 的对角矩阵。\n\n将这些表达式代入数值通量公式：\n$$ F_{i+\\frac{1}{2}} = R_0 \\left(\\frac{1}{2}(\\Lambda_0 + |\\Lambda_0|)\\right) L_0 U_L + R_0 \\left(\\frac{1}{2}(\\Lambda_0 - |\\Lambda_0|)\\right) L_0 U_R $$\n通过重新整理各项，我们可以将通量分离为一个中心（非耗散）部分和一个耗散部分：\n$$ F_{i+\\frac{1}{2}} = \\frac{1}{2} R_0 \\Lambda_0 L_0 (U_L + U_R) - \\frac{1}{2} R_0 |\\Lambda_0| L_0 (U_R - U_L) $$\n认识到 $A_0 = R_0 \\Lambda_0 L_0$ 并且在线性化背景下 $F(U) \\approx A_0 U$，该表达式变为：\n$$ F_{i+\\frac{1}{2}} \\approx \\frac{1}{2}(F(U_L) + F(U_R)) - \\frac{1}{2} R_0 |\\Lambda_0| L_0 (U_R - U_L) $$\n第一项是中心通量平均，第二项是数值耗散项 $D = \\frac{1}{2} |A_0| (U_R - U_L)$，其中 $|A_0| = R_0 |\\Lambda_0| L_0$。耗散由特征值的模 $|\\lambda_j|$ 控制。\n\n问题关注右行声学特征在声速点附近的行为，其相关特征值 $\\lambda_3 = u+c$ 在此穿过零点。我们将其参数化为 $\\eta = u+c$。该特征的耗散与 $|\\eta|$ 成正比。函数 $f(\\eta)=|\\eta|$ 在 $\\eta=0$ 处有一个不可微点（一个“尖点”），这可能导致数值稳定性和光滑性问题。\n\n为解决此问题，我们寻找一个连续可微的光滑函数 $\\psi(\\lambda)$ 来替代 $|\\lambda|$。该函数必须满足以下约束条件：\n1.  它是偶函数：$\\psi(-\\lambda) = \\psi(\\lambda)$。\n2.  它是连续可微的：$\\psi \\in C^{1}(\\mathbb{R})$。\n3.  它在小区间外与 $|\\lambda|$ 匹配：对于 $|\\lambda| \\ge \\varepsilon$，$\\psi(\\lambda) = |\\lambda|$。\n4.  对于 $|\\lambda|  \\varepsilon$，它是一个二次多项式。\n\n设对于 $|\\lambda|  \\varepsilon$ 的二次多项式为 $P(\\lambda) = a\\lambda^2 + b\\lambda + c_{\\text{poly}}$。\n根据偶函数条件 (1)，奇次项的系数必须为零，所以 $b=0$。该多项式简化为：\n$$ P(\\lambda) = a\\lambda^2 + c_{\\text{poly}} $$\n为确保连续可微性（条件 2），函数值及其一阶导数必须在过渡点 $\\lambda = \\pm\\varepsilon$ 处匹配。由于偶对称性，我们只需在 $\\lambda = \\varepsilon$ 处施加匹配条件。\n根据条件 (3)，对于 $\\lambda \\ge \\varepsilon$，我们有 $\\psi(\\lambda) = |\\lambda| = \\lambda$，其导数为 $\\psi'(\\lambda) = 1$。\n\n我们通过在 $\\lambda = \\varepsilon$ 处将 $P(\\lambda)$ 及其导数与 $\\psi(\\lambda)$ 及其导数相匹配，建立一个包含两个方程的方程组：\na) 匹配函数值：\n$$ P(\\varepsilon) = \\psi(\\varepsilon) \\implies a\\varepsilon^2 + c_{\\text{poly}} = \\varepsilon $$\nb) 匹配导数值：\n$$ P'(\\lambda) = 2a\\lambda \\implies P'(\\varepsilon) = \\psi'(\\varepsilon) \\implies 2a\\varepsilon = 1 $$\n\n解此方程组求 $a$ 和 $c_{\\text{poly}}$：\n从导数匹配方程 (b)，我们求得 $a$：\n$$ a = \\frac{1}{2\\varepsilon} $$\n将 $a$ 的这个值代入函数值匹配方程 (a)：\n$$ \\left(\\frac{1}{2\\varepsilon}\\right)\\varepsilon^2 + c_{\\text{poly}} = \\varepsilon $$\n$$ \\frac{\\varepsilon}{2} + c_{\\text{poly}} = \\varepsilon $$\n解出 $c_{\\text{poly}}$：\n$$ c_{\\text{poly}} = \\varepsilon - \\frac{\\varepsilon}{2} = \\frac{\\varepsilon}{2} $$\n因此，满足 $|\\lambda|  \\varepsilon$ 条件的唯一二次多项式为：\n$$ \\psi(\\lambda) = \\frac{1}{2\\varepsilon}\\lambda^2 + \\frac{\\varepsilon}{2} $$\n这可以更紧凑地写为：\n$$ \\psi(\\lambda) = \\frac{\\lambda^2 + \\varepsilon^2}{2\\varepsilon} $$\n问题要求的是在声速条件附近右行声学特征的光滑耗散大小 $\\alpha(\\eta, \\varepsilon)$。这对应于在 $\\lambda = \\eta$（其中 $|\\eta|  \\varepsilon$）处计算 $\\psi(\\lambda)$。\n因此，最终表达式为：\n$$ \\alpha(\\eta, \\varepsilon) = \\frac{\\eta^2 + \\varepsilon^2}{2\\varepsilon} $$\n该函数是二次的，处处连续可微，并且对于 $|\\eta| \\ge \\varepsilon$ 平滑过渡到 $|\\eta|$，从而消除了声速点处有问题的尖点。",
            "answer": "$$\n\\boxed{\\frac{\\eta^{2} + \\varepsilon^{2}}{2 \\varepsilon}}\n$$"
        },
        {
            "introduction": "最后的练习将从修正缺陷转向主动设计。剪切层是另一种对数值格式提出挑战的流动结构，它涉及横向速度的变化但压力保持不变，许多简单的格式难以准确地保持其结构。本练习  将探索一种对耗散矩阵进行目标性修改的方法，并通过傅里叶分析，精确地找出消除剪切波人工阻尼所需的条件，展示如何为了更好的物理保真度而对数值格式进行工程设计。",
            "id": "3960837",
            "problem": "考虑在一维流向变化设定下，守恒形式的二维可压缩欧拉方程，\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = 0,\n$$\n其守恒变量和通量为\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho v \\\\ \\rho E \\end{pmatrix}, \n\\quad\n\\mathbf{F}(\\mathbf{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ \\rho u v \\\\ u(\\rho E + p) \\end{pmatrix},\n$$\n其中，$p$ 是热力学压力，$\\rho$ 是密度，$u$ 是流向速度，$v$ 是横向速度，$E$ 是总比能。设基态是均匀的，为 $(\\rho_{0}, u_{0}, v_{0}, p_{0})$，比热比 $\\gamma  1$，并叠加有小扰动 $\\delta \\mathbf{U}$。假设理想气体闭合关系，并围绕基态进行标准线性化。\n\nSteger–Warming 型的通量矢量分裂可以用半离散有限体积形式写为\n$$\n\\frac{d \\mathbf{U}_{i}}{dt} = -\\frac{1}{\\Delta x}\\left(\\mathbf{F}_{i+\\frac{1}{2}} - \\mathbf{F}_{i-\\frac{1}{2}}\\right),\n$$\n其数值通量为\n$$\n\\mathbf{F}_{i+\\frac{1}{2}} = \\mathbf{F}^{\\text{EC}}_{i+\\frac{1}{2}} - \\frac{1}{2}\\,\\mathbf{D}\\left(\\mathbf{U}_{i+1} - \\mathbf{U}_{i}\\right),\n$$\n其中 $\\mathbf{F}^{\\text{EC}}_{i+\\frac{1}{2}}$ 表示在界面处的任意相容的保熵中心通量，$\\mathbf{D}$ 是一个由通量矢量分裂导出的对称半正定耗散矩阵。\n\n提出一种单参数的“压力-动量再平衡”修正，其中作用于线性退化对流场（接触场和剪切场）的耗散按因子 $\\eta \\in [0,1]$ 进行缩放，而声学耗散保持不变。在均匀基态附近，这可以表示为\n$$\n\\mathbf{D}(\\eta) = \\mathbf{R}\\,\\mathrm{diag}\\!\\left(\\eta\\,|u_{0}|,\\;|u_{0}-a_{0}|,\\;|u_{0}+a_{0}|,\\;\\eta\\,|u_{0}|\\right)\\,\\mathbf{R}^{-1},\n$$\n其中 $\\mathbf{R}$ 是在基态下求值的通量雅可比矩阵 $\\partial \\mathbf{F}/\\partial \\mathbf{U}$ 的右特征向量矩阵，$a_{0}$ 是基态声速，对角线上的项根据剪切/接触和声学特征场排序。将此解释为通过中心化压力贡献并将对流（线性退化）场的迎风性按因子 $\\eta$ 减小来重新平衡动量和压力分裂。\n\n在线性的、纯剪切波形式的扰动上对该修正进行解析测试\n$$\n\\delta \\mathbf{W}(x,t) = \\begin{pmatrix} \\delta \\rho \\\\ \\delta u \\\\ \\delta v \\\\ \\delta p \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\widehat{v}\\,\\exp(\\mathrm{i} k x) \\\\ 0 \\end{pmatrix},\n$$\n其中波数 $k$ 为常数，$\\mathbf{W}$ 表示原始变量向量，平均流为 $(\\rho_{0}, u_{0}, 0, p_{0})$。在线性化下，剪切波的精确演化是以速度 $u_{0}$ 对流且无衰减。\n\n对横向动量分量的修正通量进行线性、半离散傅里叶分析，以获得剪切模态的半离散放大因子 $\\lambda(k\\Delta x;\\eta)$，并确定能够消除所有波数下剪切模态的人为阻尼的 $\\eta$ 值。将你的最终答案表示为一个无单位的实数，对应于在半离散分析中实现零人为衰减的 $\\eta$ 值。无需四舍五入。",
            "solution": "问题要求在一个修正的通量矢量分裂格式中，参数 $\\eta$ 的值，该值能消除线性化剪切波的人为阻尼。分析将在二维可压缩欧拉方程的半离散形式上进行，并假设存在一维流向变化。\n\n单元 $i$ 中守恒变量向量 $\\mathbf{U}_i$ 的控制半离散方程由下式给出：\n$$\n\\frac{d \\mathbf{U}_{i}}{dt} = -\\frac{1}{\\Delta x}\\left(\\mathbf{F}_{i+\\frac{1}{2}} - \\mathbf{F}_{i-\\frac{1}{2}}\\right)\n$$\n数值通量 $\\mathbf{F}_{i+\\frac{1}{2}}$ 定义为：\n$$\n\\mathbf{F}_{i+\\frac{1}{2}} = \\mathbf{F}^{\\text{EC}}_{i+\\frac{1}{2}} - \\frac{1}{2}\\,\\mathbf{D}(\\eta)\\left(\\mathbf{U}_{i+1} - \\mathbf{U}_{i}\\right)\n$$\n我们分析在均匀基态 $\\mathbf{U}_0$（对应于原始变量 $(\\rho_{0}, u_{0}, 0, p_{0})$）周围的小扰动 $\\delta\\mathbf{U}$ 的行为。半离散方程的线性化形式为：\n$$\n\\frac{d (\\delta\\mathbf{U}_{i})}{dt} = -\\frac{1}{\\Delta x}\\left(\\delta\\mathbf{F}_{i+\\frac{1}{2}} - \\delta\\mathbf{F}_{i-\\frac{1}{2}}\\right)\n$$\n中心通量项 $\\mathbf{F}^{\\text{EC}}_{i+\\frac{1}{2}}$ 是相容的中心格式，可以围绕基态线性化为 $\\delta\\mathbf{F}^{\\text{EC}}_{i+\\frac{1}{2}} = \\frac{1}{2}\\mathbf{A}_0(\\delta\\mathbf{U}_i + \\delta\\mathbf{U}_{i+1})$，其中 $\\mathbf{A}_0 = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{U}}|_{\\mathbf{U}_0}$ 是在基态下求值的通量雅可比矩阵。耗散矩阵 $\\mathbf{D}(\\eta)$ 在基态下求值，并表示为 $\\mathbf{D}_0(\\eta)$。线性化的数值通量扰动为：\n$$\n\\delta\\mathbf{F}_{i+\\frac{1}{2}} = \\frac{1}{2}\\mathbf{A}_0(\\delta\\mathbf{U}_i + \\delta\\mathbf{U}_{i+1}) - \\frac{1}{2}\\mathbf{D}_0(\\eta)(\\delta\\mathbf{U}_{i+1} - \\delta\\mathbf{U}_i)\n$$\n将其代入线性化演化方程得到：\n$$\n\\frac{d (\\delta\\mathbf{U}_{i})}{dt} = -\\frac{1}{\\Delta x} \\left[ \\left(\\frac{1}{2}\\mathbf{A}_0(\\delta\\mathbf{U}_i + \\delta\\mathbf{U}_{i+1}) - \\frac{1}{2}\\mathbf{D}_0(\\eta)(\\delta\\mathbf{U}_{i+1} - \\delta\\mathbf{U}_i)\\right) - \\left(\\frac{1}{2}\\mathbf{A}_0(\\delta\\mathbf{U}_{i-1} + \\delta\\mathbf{U}_{i}) - \\frac{1}{2}\\mathbf{D}_0(\\eta)(\\delta\\mathbf{U}_{i} - \\delta\\mathbf{U}_{i-1})\\right) \\right]\n$$\n整理各项可得：\n$$\n\\frac{d (\\delta\\mathbf{U}_{i})}{dt} = -\\frac{1}{2\\Delta x} \\left[ \\mathbf{A}_0(\\delta\\mathbf{U}_{i+1} - \\delta\\mathbf{U}_{i-1}) - \\mathbf{D}_0(\\eta)(\\delta\\mathbf{U}_{i+1} - 2\\delta\\mathbf{U}_i + \\delta\\mathbf{U}_{i-1}) \\right]\n$$\n我们通过代入单一模态形式 $\\delta\\mathbf{U}_j(t) = \\widehat{\\delta\\mathbf{U}}(t)\\exp(\\mathrm{i} k x_j)$（其中 $x_j = j\\Delta x$）来进行半离散傅里叶分析。令 $\\theta = k\\Delta x$ 为无量纲波数。空间差分变为：\n$\\delta\\mathbf{U}_{i+1} - \\delta\\mathbf{U}_{i-1} = (\\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta))\\widehat{\\delta\\mathbf{U}}\\exp(\\mathrm{i}kx_i) = 2\\mathrm{i}\\sin(\\theta)\\widehat{\\delta\\mathbf{U}}\\exp(\\mathrm{i}kx_i)$\n$\\delta\\mathbf{U}_{i+1} - 2\\delta\\mathbf{U}_i + \\delta\\mathbf{U}_{i-1} = (\\exp(\\mathrm{i}\\theta) - 2 + \\exp(-\\mathrm{i}\\theta))\\widehat{\\delta\\mathbf{U}}\\exp(\\mathrm{i}kx_i) = 2(\\cos(\\theta)-1)\\widehat{\\delta\\mathbf{U}}\\exp(\\mathrm{i}kx_i)$\n傅里叶幅值向量 $\\widehat{\\delta\\mathbf{U}}(t)$ 的方程变为：\n$$\n\\frac{d\\widehat{\\delta\\mathbf{U}}}{dt} = -\\frac{1}{2\\Delta x} \\left[ \\mathbf{A}_0(2\\mathrm{i}\\sin(\\theta)) - \\mathbf{D}_0(\\eta)(2(\\cos(\\theta)-1)) \\right] \\widehat{\\delta\\mathbf{U}}\n$$\n$$\n\\frac{d\\widehat{\\delta\\mathbf{U}}}{dt} = \\left[ -\\frac{\\mathrm{i}\\sin(\\theta)}{\\Delta x}\\mathbf{A}_0 + \\frac{\\cos(\\theta)-1}{\\Delta x}\\mathbf{D}_0(\\eta) \\right] \\widehat{\\delta\\mathbf{U}}\n$$\n这是一个常微分方程组 $\\frac{d\\widehat{\\delta\\mathbf{U}}}{dt} = \\mathbf{S}(\\theta, \\eta)\\widehat{\\delta\\mathbf{U}}$，其中 $\\mathbf{S}$ 是系统矩阵。解的行为由 $\\mathbf{S}$ 的特征值决定。问题指定了一个纯剪切波扰动，它对应于通量雅可比矩阵 $\\mathbf{A}_0$ 的一个特征向量。设该特征向量为 $\\mathbf{r}_{\\text{shear}}$。根据构造，$\\mathbf{D}_0(\\eta)$ 与 $\\mathbf{A}_0$ 具有相同的特征向量。\n因此，$\\mathbf{r}_{\\text{shear}}$ 也是 $\\mathbf{S}$ 的一个特征向量：\n$$\n\\mathbf{S}\\mathbf{r}_{\\text{shear}} = \\left( -\\frac{\\mathrm{i}\\sin(\\theta)}{\\Delta x}\\lambda_{\\text{A,shear}} + \\frac{\\cos(\\theta)-1}{\\Delta x}\\lambda_{\\text{D,shear}} \\right) \\mathbf{r}_{\\text{shear}}\n$$\n括号中的项是 $\\mathbf{S}$ 对应于剪切模态的特征值，我们将其记为放大因子 $\\lambda(\\theta; \\eta)$。\n$\\mathbf{A}_0$ 对应于剪切波的特征值是其对流速度，$\\lambda_{\\text{A,shear}} = u_0$。\n问题根据特征场（剪切、声学、声学和接触）的顺序，用其特征值来指定耗散矩阵 $\\mathbf{D}(\\eta)$。\n$$\n\\mathbf{D}(\\eta) = \\mathbf{R}\\,\\mathrm{diag}\\!\\left(\\eta\\,|u_{0}|,\\;|u_{0}-a_{0}|,\\;|u_{0}+a_{0}|,\\;\\eta\\,|u_{0}|\\right)\\,\\mathbf{R}^{-1}\n$$\n$\\mathbf{D}_0(\\eta)$ 对应于剪切波的特征值是对角矩阵中的第一项：$\\lambda_{\\text{D,shear}} = \\eta|u_0|$。\n将这些特征值代入放大因子的表达式中：\n$$\n\\lambda(\\theta; \\eta) = -\\frac{\\mathrm{i}\\sin(\\theta)}{\\Delta x}u_0 + \\frac{\\cos(\\theta)-1}{\\Delta x}\\eta|u_0|\n$$\n剪切波幅值的演化与 $\\exp(\\lambda t)$ 成正比。人为阻尼（或增长）由 $\\lambda$ 的实部决定。要消除阻尼，实部必须为零。\n$$\n\\mathrm{Re}(\\lambda(\\theta; \\eta)) = \\frac{\\eta|u_0|(\\cos(\\theta)-1)}{\\Delta x}\n$$\n为了消除*所有*波数的人为阻尼，该表达式对于所有 $\\theta \\in [-\\pi, \\pi]$ 都必须为零。基态速度 $u_0$ 和网格间距 $\\Delta x$ 假定为非零常数。项 $\\cos(\\theta)-1$ 对于除离散点 $\\theta = 2n\\pi$（其中 $n$ 为整数）之外的所有 $\\theta$ 都是非零的。因此，为了使条件 $\\mathrm{Re}(\\lambda(\\theta; \\eta)) = 0$ 对所有波数都成立，参数 $\\eta$ 必须为零。\n$$\n\\eta = 0\n$$\n这个结果在物理上意味着，为了防止数值格式阻尼纯剪切波，必须完全移除专门应用于该波模态的人为耗散。",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}