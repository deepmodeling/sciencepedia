{
    "hands_on_practices": [
        {
            "introduction": "The foundation of the Roe solver lies in its ability to decompose a jump in conserved variables into a set of characteristic waves. This exercise guides you through the derivation of the strengths of these waves, denoted by $\\alpha_i$. Understanding how to express these strengths in terms of jumps in primitive variables like pressure ($\\Delta p$) and velocity ($\\Delta u$) is crucial for building an intuitive and practical grasp of how the solver interprets and propagates discontinuities. ",
            "id": "3992400",
            "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma1$, written in conservation form for the conserved variables $U=(\\rho,\\rho u,E)^{\\top}$. The flux $F(U)$ follows from mass, momentum, and energy conservation, and the pressure satisfies $p=(\\gamma-1)\\left(E-\\frac{1}{2}\\rho u^{2}\\right)$. Define the specific total enthalpy $H=\\frac{E+p}{\\rho}$. In a Computational Fluid Dynamics (CFD) Roe-type approximate Riemann solver, one linearizes the flux Jacobian about the Roe average state constructed from left and right states $(\\rho_{L},u_{L},p_{L})$ and $(\\rho_{R},u_{R},p_{R})$ as follows:\n- The Roe-averaged velocity is $\\tilde{u}=\\frac{\\sqrt{\\rho_{L}}\\,u_{L}+\\sqrt{\\rho_{R}}\\,u_{R}}{\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}}$.\n- The Roe-averaged specific total enthalpy is $\\tilde{H}=\\frac{\\sqrt{\\rho_{L}}\\,H_{L}+\\sqrt{\\rho_{R}}\\,H_{R}}{\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}}$.\n- The Roe-averaged speed of sound is $\\tilde{a}=\\sqrt{(\\gamma-1)\\left(\\tilde{H}-\\frac{1}{2}\\tilde{u}^{2}\\right)}$.\n- For the purpose of linearization identities, take the Roe-averaged density as $\\tilde{\\rho}=\\sqrt{\\rho_{L}\\rho_{R}}$.\n\nLet the jump be $\\Delta U=U_{R}-U_{L}$ and denote primitive jumps evaluated at the Roe state by $\\Delta\\rho=\\rho_{R}-\\rho_{L}$, $\\Delta u=u_{R}-u_{L}$, and $\\Delta p=p_{R}-p_{L}$. The Roe linearization decomposes the conserved-variable jump as $\\Delta U=\\sum_{i=1}^{3}\\alpha_{i}r_{i}$, where $r_{i}$ are the right eigenvectors of the Roe-linearized Jacobian and $\\alpha_{i}$ are the wave strengths. Assume the standard three-wave structure with eigenvalues $\\tilde{u}-\\tilde{a}$, $\\tilde{u}$, and $\\tilde{u}+\\tilde{a}$ and the corresponding right eigenvectors in conserved variables.\n\nStarting from the governing equations and the ideal-gas thermodynamic relation, derive explicit formulas for the wave strengths $\\alpha_{1}$, $\\alpha_{2}$, and $\\alpha_{3}$ in terms of $\\Delta\\rho$, $\\Delta u$, $\\Delta p$, and the Roe-averaged quantities $\\tilde{\\rho}$ and $\\tilde{a}$. Explain the role of the pressure jump in determining the sum $\\alpha_{1}+\\alpha_{3}$. Briefly justify whether these $\\alpha_{i}$ expressions are altered when the Harten–Hyman entropy fix is applied by modifying the characteristic speeds near sonic points, without changing the eigenvectors.\n\nExpress your final answer for $(\\alpha_{1},\\alpha_{2},\\alpha_{3})$ as a single closed-form analytic expression. No numerical evaluation is required. No rounding is required. The final answer must be given as a row matrix.",
            "solution": "The problem requires the derivation of the wave strengths $\\alpha_1, \\alpha_2, \\alpha_3$ for the Roe-linearized one-dimensional Euler equations. These strengths are the coefficients in the decomposition of the jump in conserved variables, $\\Delta U$, onto the basis of right eigenvectors of the Roe-averaged Jacobian matrix.\n\nThe vector of conserved variables is $U = (\\rho, \\rho u, E)^{\\top}$. The jump in this vector between a right state ($R$) and a left state ($L$) is $\\Delta U = U_R - U_L = (\\Delta\\rho, \\Delta(\\rho u), \\Delta E)^{\\top}$. This jump is decomposed as:\n$$\n\\Delta U = \\sum_{i=1}^{3} \\alpha_i r_i\n$$\nwhere $r_i$ are the right eigenvectors of the Roe-averaged Jacobian, corresponding to the eigenvalues $\\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a}$, $\\tilde{\\lambda}_2 = \\tilde{u}$, and $\\tilde{\\lambda}_3 = \\tilde{u} + \\tilde{a}$. The standard, unscaled forms of these eigenvectors, evaluated at the Roe-averaged state $(\\tilde{\\rho}, \\tilde{u}, \\tilde{p})$, are:\n$$\nr_1 = \\begin{pmatrix} 1 \\\\ \\tilde{u}-\\tilde{a} \\\\ \\tilde{H}-\\tilde{u}\\tilde{a} \\end{pmatrix}, \\quad\nr_2 = \\begin{pmatrix} 1 \\\\ \\tilde{u} \\\\ \\frac{1}{2}\\tilde{u}^2 \\end{pmatrix}, \\quad\nr_3 = \\begin{pmatrix} 1 \\\\ \\tilde{u}+\\tilde{a} \\\\ \\tilde{H}+\\tilde{u}\\tilde{a} \\end{pmatrix}\n$$\nHere, $\\tilde{H}$ is the Roe-averaged specific total enthalpy and $\\tilde{a}$ is the Roe-averaged speed of sound, defined as $\\tilde{a}^2 = (\\gamma-1)(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2)$.\n\nSubstituting the vectors into the decomposition yields a system of three linear equations for $(\\alpha_1, \\alpha_2, \\alpha_3)$:\n$$\n\\begin{cases}\n\\Delta\\rho  = \\alpha_1 + \\alpha_2 + \\alpha_3 \\\\\n\\Delta(\\rho u)  = \\alpha_1(\\tilde{u}-\\tilde{a}) + \\alpha_2\\tilde{u} + \\alpha_3(\\tilde{u}+\\tilde{a}) \\\\\n\\Delta E  = \\alpha_1(\\tilde{H}-\\tilde{u}\\tilde{a}) + \\alpha_2\\frac{1}{2}\\tilde{u}^2 + \\alpha_3(\\tilde{H}+\\tilde{u}\\tilde{a})\n\\end{cases}\n$$\nTo solve this system, we first express the jumps in conserved variables, $\\Delta(\\rho u)$ and $\\Delta E$, in terms of the primitive variable jumps $\\Delta\\rho$, $\\Delta u$, $\\Delta p$ and the Roe-averaged quantities. The special construction of the Roe averages ensures simple relationships.\nFor the momentum jump $\\Delta(\\rho u)$:\n$$\n\\Delta(\\rho u) = \\rho_R u_R - \\rho_L u_L\n$$\nUsing the definition of the Roe-averaged velocity $\\tilde{u} = \\frac{\\sqrt{\\rho_{L}}\\,u_{L}+\\sqrt{\\rho_{R}}\\,u_{R}}{\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}}$, one can show the exact relation:\n$$\n\\Delta(\\rho u) = \\tilde{u}\\Delta\\rho + \\tilde{\\rho}\\Delta u\n$$\nwhere $\\tilde{\\rho} = \\sqrt{\\rho_L \\rho_R}$ as given in the problem statement for linearization purposes.\n\nNow, substitute this into the second equation of our system:\n$$\n\\tilde{u}\\Delta\\rho + \\tilde{\\rho}\\Delta u = \\alpha_1(\\tilde{u}-\\tilde{a}) + \\alpha_2\\tilde{u} + \\alpha_3(\\tilde{u}+\\tilde{a})\n$$\nThe terms can be rearranged:\n$$\n\\tilde{u}(\\alpha_1 + \\alpha_2 + \\alpha_3) + \\tilde{\\rho}\\Delta u = \\tilde{u}(\\alpha_1 + \\alpha_2 + \\alpha_3) - \\tilde{a}\\alpha_1 + \\tilde{a}\\alpha_3\n$$\nSubstituting $\\Delta\\rho = \\alpha_1+\\alpha_2+\\alpha_3$ from the first system equation simplifies this to:\n$$\n\\tilde{u}\\Delta\\rho + \\tilde{\\rho}\\Delta u = \\tilde{u}\\Delta\\rho - \\tilde{a}\\alpha_1 + \\tilde{a}\\alpha_3\n$$\nThis directly yields a relationship between $\\alpha_1$ and $\\alpha_3$:\n$$\n\\alpha_3 - \\alpha_1 = \\frac{\\tilde{\\rho}\\Delta u}{\\tilde{a}}\n$$\nNext, we seek a second relationship involving $\\alpha_1$ and $\\alpha_3$. This can be found by relating the jump in total energy $\\Delta E$ to the jump in pressure $\\Delta p$. The pressure is $p = (\\gamma-1)(E - \\frac{1}{2}\\rho u^2)$, which implies $\\Delta E = \\frac{\\Delta p}{\\gamma-1} + \\frac{1}{2}\\Delta(\\rho u^2)$. A key property of the Roe linearization (the \"U-property\") requires that the jump in pressure satisfies:\n$$\n\\Delta p = (\\gamma-1)\\left(\\Delta E - \\tilde{u}\\Delta(\\rho u) + \\frac{1}{2}\\tilde{u}^2\\Delta\\rho\\right)\n$$\nWe can substitute the eigenvector decomposition for the terms $\\Delta E$, $\\Delta(\\rho u)$, and $\\Delta\\rho$:\n$$\n\\frac{\\Delta p}{\\gamma-1} = \\left(\\alpha_1(\\tilde{H}-\\tilde{u}\\tilde{a}) + \\alpha_2\\frac{\\tilde{u}^2}{2} + \\alpha_3(\\tilde{H}+\\tilde{u}\\tilde{a})\\right) - \\tilde{u}\\left(\\alpha_1(\\tilde{u}-\\tilde{a}) + \\alpha_2\\tilde{u} + \\alpha_3(\\tilde{u}+\\tilde{a})\\right) + \\frac{\\tilde{u}^2}{2}\\left(\\alpha_1 + \\alpha_2 + \\alpha_3\\right)\n$$\nCollecting terms for each $\\alpha_i$:\n- For $\\alpha_1: (\\tilde{H}-\\tilde{u}\\tilde{a}) - \\tilde{u}(\\tilde{u}-\\tilde{a}) + \\frac{\\tilde{u}^2}{2} = \\tilde{H}-\\tilde{u}\\tilde{a} - \\tilde{u}^2 + \\tilde{u}\\tilde{a} + \\frac{\\tilde{u}^2}{2} = \\tilde{H}-\\frac{\\tilde{u}^2}{2} = \\frac{\\tilde{a}^2}{\\gamma-1}$\n- For $\\alpha_2: \\frac{\\tilde{u}^2}{2} - \\tilde{u}(\\tilde{u}) + \\frac{\\tilde{u}^2}{2} = 0$\n- For $\\alpha_3: (\\tilde{H}+\\tilde{u}\\tilde{a}) - \\tilde{u}(\\tilde{u}+\\tilde{a}) + \\frac{\\tilde{u}^2}{2} = \\tilde{H}+\\tilde{u}\\tilde{a} - \\tilde{u}^2 - \\tilde{u}\\tilde{a} + \\frac{\\tilde{u}^2}{2} = \\tilde{H}-\\frac{\\tilde{u}^2}{2} = \\frac{\\tilde{a}^2}{\\gamma-1}$\n\nThe equation thus simplifies to:\n$$\n\\frac{\\Delta p}{\\gamma-1} = \\alpha_1 \\frac{\\tilde{a}^2}{\\gamma-1} + \\alpha_3 \\frac{\\tilde{a}^2}{\\gamma-1}\n$$\nThis gives our second relationship:\n$$\n\\alpha_1 + \\alpha_3 = \\frac{\\Delta p}{\\tilde{a}^2}\n$$\nThis equation directly addresses the role of the pressure jump: the sum of the strengths of the two acoustic waves, $\\alpha_1 + \\alpha_3$, is directly proportional to the jump in pressure, $\\Delta p$, and inversely proportional to the square of the Roe-averaged sound speed, $\\tilde{a}^2$.\n\nWe now have a $2 \\times 2$ linear system for $\\alpha_1$ and $\\alpha_3$:\n$$\n\\begin{cases}\n\\alpha_3 + \\alpha_1 = \\frac{\\Delta p}{\\tilde{a}^2} \\\\\n\\alpha_3 - \\alpha_1 = \\frac{\\tilde{\\rho}\\Delta u}{\\tilde{a}}\n\\end{cases}\n$$\nAdding the two equations gives $2\\alpha_3 = \\frac{\\Delta p}{\\tilde{a}^2} + \\frac{\\tilde{\\rho}\\Delta u}{\\tilde{a}}$, so:\n$$\n\\alpha_3 = \\frac{1}{2\\tilde{a}^2}\\left(\\Delta p + \\tilde{\\rho}\\tilde{a}\\Delta u\\right)\n$$\nSubtracting the second equation from the first gives $2\\alpha_1 = \\frac{\\Delta p}{\\tilde{a}^2} - \\frac{\\tilde{\\rho}\\Delta u}{\\tilde{a}}$, so:\n$$\n\\alpha_1 = \\frac{1}{2\\tilde{a}^2}\\left(\\Delta p - \\tilde{\\rho}\\tilde{a}\\Delta u\\right)\n$$\nFinally, we find a_2 from the first equation of the original system: $\\alpha_2 = \\Delta\\rho - (\\alpha_1 + \\alpha_3)$. Using the sum we found earlier:\n$$\n\\alpha_2 = \\Delta\\rho - \\frac{\\Delta p}{\\tilde{a}^2}\n$$\nThis completes the derivation of the wave strengths.\n\nRegarding the Harten–Hyman entropy fix: this procedure is designed to add numerical dissipation at sonic points (where an eigenvalue $|\\tilde{\\lambda}_i|$ is close to $0$) to prevent the formation of unphysical expansion shocks. It typically works by modifying the eigenvalues used in the dissipation term of the numerical flux, for example, by replacing $|\\tilde{\\lambda}_i|$ with a function $Q(\\tilde{\\lambda}_i)$ such that $Q(\\lambda) \\geq \\delta  0$. The problem states that this modification is applied to the characteristic speeds (eigenvalues) *without changing the eigenvectors*.\n\nThe wave strengths $\\alpha_i$ are the coordinates of the jump vector $\\Delta U$ in the basis of right eigenvectors $\\{r_1, r_2, r_3\\}$. Their calculation, as demonstrated above, depends only on the components of these eigenvectors and the jump conditions, not on the corresponding eigenvalues $\\tilde{\\lambda}_i$. Since the eigenvectors are assumed to be unaltered by the entropy fix, the algebraic projection of $\\Delta U$ onto this basis remains the same. Therefore, the expressions for $\\alpha_1, \\alpha_2$, and $\\alpha_3$ are not altered by the application of such an entropy fix. The fix modifies how these wave strengths are used to compute the numerical flux, but not the strengths themselves.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2\\tilde{a}^2}(\\Delta p - \\tilde{\\rho}\\tilde{a}\\Delta u)  \\Delta\\rho - \\frac{\\Delta p}{\\tilde{a}^2}  \\frac{1}{2\\tilde{a}^2}(\\Delta p + \\tilde{\\rho}\\tilde{a}\\Delta u) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "With the theoretical components established, we now turn to a classic application: the Sod shock tube problem. This practice involves computing the specific Roe-averaged quantities at the initial discontinuity and determining the resulting wave speeds. You will then assess whether a Harten-type entropy fix is triggered, providing a concrete example of how these fixes selectively add dissipation only when necessary to ensure a physically correct solution. ",
            "id": "3992402",
            "problem": "Consider the one-dimensional Euler equations for inviscid compressible flow in computational fluid dynamics (CFD), written in conservative form with state vector $U = (\\rho, \\rho u, E)^{\\mathsf{T}}$ and flux $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\mathsf{T}}$. The initial data correspond to the Sod shock tube Riemann problem with left state $U_{L} = (\\rho_{L}, u_{L}, p_{L}) = (1.0, 0, 1.0)$ and right state $U_{R} = (\\rho_{R}, u_{R}, p_{R}) = (0.125, 0, 0.1)$ for a perfect gas with ratio of specific heats $\\gamma = 1.4$. You may use the ideal-gas relations $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$, the speed of sound $a = \\sqrt{\\gamma p / \\rho}$, and the specific total enthalpy $H = (E + p)/\\rho = \\tfrac{\\gamma}{\\gamma - 1}\\tfrac{p}{\\rho} + \\tfrac{1}{2}u^{2}$. \n\nStarting from the governing equations and these thermodynamic definitions, derive the Roe linearization for the interface between $U_{L}$ and $U_{R}$. Compute the Roe-average velocity $\\tilde{u}$, specific total enthalpy $\\tilde{H}$, and speed of sound $\\tilde{a}$. Then, construct the Roe matrix eigenvalues at the interface and the corresponding Roe flux $F_{i+1/2}^{\\mathrm{Roe}}$ by decomposing the jump $\\Delta U = U_{R} - U_{L}$ into characteristic waves using the Roe eigenstructure. Finally, implement the Harten entropy fix for the left-going acoustic field using a threshold\n$$\\delta_{1} = \\max\\!\\big(0,\\, \\lambda_{1,R} - \\lambda_{1,L}\\big),$$\nwhere $\\lambda_{1,L} = u_{L} - a_{L}$ and $\\lambda_{1,R} = u_{R} - a_{R}$ are the corresponding left/right acoustic eigenvalues computed from the physical (non-Roe) states, and apply the modified viscosity function\n$$|\\lambda|_{\\mathrm{fix}} = \\begin{cases} \\dfrac{1}{2}\\left(\\dfrac{\\lambda^2}{\\delta} + \\delta\\right),  \\text{if } |\\lambda|  \\delta \\\\ |\\lambda|,  \\text{otherwise} \\end{cases}$$\nwith $\\lambda$ equal to the Roe left-going acoustic eigenvalue at the interface. Assess whether this entropy fix alters the wave speed associated with the rarefaction fan at the initial discontinuity.\n\nReport, as your final answer, the entropy-fixed magnitude of the left-going acoustic characteristic speed at the interface. Treat all quantities as dimensionless and round your final value to four significant figures.",
            "solution": "The problem statement has been validated and is deemed valid. It is a well-posed problem in computational fluid dynamics based on established scientific principles. All necessary data and definitions are provided, and there are no internal contradictions or ambiguities.\n\nThe problem asks for the computation of the entropy-fixed magnitude of the left-going acoustic characteristic speed for the Sod shock tube problem, using the Roe linearization and a Harten-type entropy fix.\n\nThe one-dimensional Euler equations are given by $\\partial_t U + \\partial_x F(U) = 0$, with the state vector $U = (\\rho, \\rho u, E)^{\\mathsf{T}}$ and flux vector $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\mathsf{T}}$. The ratio of specific heats is $\\gamma = 1.4$. The equation of state for a perfect gas is $p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^2)$.\n\nFirst, we define the left ($L$) and right ($R$) states in terms of primitive and conserved variables.\nThe initial primitive variables are:\nLeft state: $\\rho_L = 1.0$, $u_L = 0$, $p_L = 1.0$.\nRight state: $\\rho_R = 0.125$, $u_R = 0$, $p_R = 0.1$.\n\nFrom these, we compute the total energy per unit volume, $E$, for each state:\n$E_L = \\frac{p_L}{\\gamma - 1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{1.0}{1.4 - 1} + \\frac{1}{2}(1.0)(0)^2 = \\frac{1.0}{0.4} = 2.5$.\n$E_R = \\frac{p_R}{\\gamma - 1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{0.1}{1.4 - 1} + \\frac{1}{2}(0.125)(0)^2 = \\frac{0.1}{0.4} = 0.25$.\n\nThe state vectors in conservative form are:\n$U_L = (\\rho_L, \\rho_L u_L, E_L)^{\\mathsf{T}} = (1.0, 0, 2.5)^{\\mathsf{T}}$.\n$U_R = (\\rho_R, \\rho_R u_R, E_R)^{\\mathsf{T}} = (0.125, 0, 0.25)^{\\mathsf{T}}$.\n\nNext, we compute the specific total enthalpy, $H = (E+p)/\\rho$, for each state:\n$H_L = \\frac{E_L + p_L}{\\rho_L} = \\frac{2.5 + 1.0}{1.0} = 3.5$.\n$H_R = \\frac{E_R + p_R}{\\rho_R} = \\frac{0.25 + 0.1}{0.125} = \\frac{0.35}{0.125} = 2.8$.\n\nThe Roe-averaged state is defined to satisfy the property $F_R - F_L = \\tilde{A}(U_R - U_L)$, where $\\tilde{A}$ is the Roe matrix evaluated at the Roe-averaged state. The Roe-averaged variables are computed as follows:\n$\\tilde{u} = \\frac{\\sqrt{\\rho_L}u_L + \\sqrt{\\rho_R}u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}} = \\frac{\\sqrt{1.0}(0) + \\sqrt{0.125}(0)}{\\sqrt{1.0} + \\sqrt{0.125}} = 0$.\n$\\tilde{H} = \\frac{\\sqrt{\\rho_L}H_L + \\sqrt{\\rho_R}H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}} = \\frac{\\sqrt{1.0}(3.5) + \\sqrt{0.125}(2.8)}{\\sqrt{1.0} + \\sqrt{0.125}}$.\nUsing $\\sqrt{0.125} = \\sqrt{1/8} = 1/(2\\sqrt{2}) = \\frac{\\sqrt{2}}{4}$:\n$\\tilde{H} = \\frac{3.5 + \\frac{\\sqrt{2}}{4}(2.8)}{1 + \\frac{\\sqrt{2}}{4}} = \\frac{4(3.5 + 0.7\\sqrt{2})}{4(1 + \\frac{\\sqrt{2}}{4})} = \\frac{14 + 2.8\\sqrt{2}}{4 + \\sqrt{2}}$.\nRationalizing the denominator:\n$\\tilde{H} = \\frac{14 + 2.8\\sqrt{2}}{4 + \\sqrt{2}} \\cdot \\frac{4 - \\sqrt{2}}{4 - \\sqrt{2}} = \\frac{56 - 14\\sqrt{2} + 11.2\\sqrt{2} - 2.8(2)}{16 - 2} = \\frac{50.4 - 2.8\\sqrt{2}}{14} = 3.6 - 0.2\\sqrt{2}$.\n\nThe Roe-averaged speed of sound, $\\tilde{a}$, is given by $\\tilde{a}^2 = (\\gamma - 1)(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2)$:\n$\\tilde{a}^2 = (1.4 - 1)( (3.6 - 0.2\\sqrt{2}) - \\frac{1}{2}(0)^2) = 0.4(3.6 - 0.2\\sqrt{2}) = 1.44 - 0.08\\sqrt{2}$.\n$\\tilde{a} = \\sqrt{1.44 - 0.08\\sqrt{2}}$.\n\nThe eigenvalues of the Roe matrix $\\tilde{A}$ are $\\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a}$, $\\tilde{\\lambda}_2 = \\tilde{u}$, and $\\tilde{\\lambda}_3 = \\tilde{u} + \\tilde{a}$. The left-going acoustic characteristic speed is:\n$\\tilde{\\lambda}_1 = 0 - \\sqrt{1.44 - 0.08\\sqrt{2}} = -\\sqrt{1.44 - 0.08\\sqrt{2}}$.\n\nNow we must assess if the Harten entropy fix is active. The fix is applied if $|\\tilde{\\lambda}_1|  \\delta_1$. The threshold $\\delta_1$ is defined as $\\delta_1 = \\max(0, \\lambda_{1,R} - \\lambda_{1,L})$.\nFirst, we compute the physical (non-averaged) sound speeds $a_L$ and $a_R$:\n$a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\cdot 1.0}{1.0}} = \\sqrt{1.4}$.\n$a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\cdot 0.1}{0.125}} = \\sqrt{1.4 \\cdot 0.8} = \\sqrt{1.12}$.\n\nNext, we compute the physical characteristic speeds $\\lambda_{1,L}$ and $\\lambda_{1,R}$:\n$\\lambda_{1,L} = u_L - a_L = 0 - \\sqrt{1.4} = -\\sqrt{1.4}$.\n$\\lambda_{1,R} = u_R - a_R = 0 - \\sqrt{1.12} = -\\sqrt{1.12}$.\n\nNow, we calculate the threshold $\\delta_1$:\n$\\delta_1 = \\max(0, \\lambda_{1,R} - \\lambda_{1,L}) = \\max(0, -\\sqrt{1.12} - (-\\sqrt{1.4})) = \\max(0, \\sqrt{1.4} - \\sqrt{1.12})$.\nNumerically, $\\sqrt{1.4} \\approx 1.1832$ and $\\sqrt{1.12} \\approx 1.0583$. Since $\\sqrt{1.4}  \\sqrt{1.12}$, we have:\n$\\delta_1 = \\sqrt{1.4} - \\sqrt{1.12} \\approx 0.1249$.\n\nThe entropy fix condition is $|\\tilde{\\lambda}_1|  \\delta_1$. Let's evaluate the quantities:\n$|\\tilde{\\lambda}_1| = \\sqrt{1.44 - 0.08\\sqrt{2}}$. Using $\\sqrt{2} \\approx 1.4142$:\n$|\\tilde{\\lambda}_1| \\approx \\sqrt{1.44 - 0.08(1.4142)} = \\sqrt{1.44 - 0.113136} = \\sqrt{1.326864} \\approx 1.1519$.\n\nComparing the values:\n$|\\tilde{\\lambda}_1| \\approx 1.1519$\n$\\delta_1 \\approx 0.1249$\nThe condition $|\\tilde{\\lambda}_1|  \\delta_1$ is $1.1519  0.1249$, which is false.\n\nThe Harten entropy fix is defined by the modified viscosity function:\n$|\\lambda|_{\\mathrm{fix}} = \\begin{cases} \\frac{1}{2}(\\frac{\\lambda^2}{\\delta} + \\delta),  \\text{if } |\\lambda|  \\delta, \\\\ |\\lambda|,  \\text{otherwise.} \\end{cases}$\nSince the condition $|\\tilde{\\lambda}_1|  \\delta_1$ is not met, we are in the 'otherwise' case. Thus, the entropy fix does not alter the wave speed.\nThe entropy-fixed magnitude of the left-going acoustic characteristic speed is:\n$|\\tilde{\\lambda}_1|_{\\mathrm{fix}} = |\\tilde{\\lambda}_1| = \\sqrt{1.44 - 0.08\\sqrt{2}}$.\n\nThe problem asks for this value rounded to four significant figures.\n$|\\tilde{\\lambda}_1|_{\\mathrm{fix}} = \\sqrt{1.44 - 0.08\\sqrt{2}} \\approx \\sqrt{1.44 - 0.08(1.41421356)} \\approx \\sqrt{1.44 - 0.11313708} \\approx \\sqrt{1.32686292} \\approx 1.15189536$.\n\nRounding to four significant figures, we get $1.152$.\n\nThe assessment of the entropy fix is that it does not alter the wave speed for the left-going rarefaction wave in this Sod shock tube problem. This is the expected behavior, as the fix is designed to add numerical dissipation primarily for transonic rarefactions (where an eigenvalue crosses zero), which is not the case here ($\\lambda_{1,L}$ and $\\lambda_{1,R}$ are both negative).\n\nFinal Answer Calculation:\nValue to be reported: $|\\tilde{\\lambda}_1|_{\\mathrm{fix}} = 1.15189536 \\dots$\nRounded to four significant figures: $1.152$.",
            "answer": "$$\\boxed{1.152}$$"
        },
        {
            "introduction": "While powerful, the standard Roe solver has known failure modes that can compromise the stability and physical realism of a simulation. This exercise explores one of the most critical pathologies: the generation of a non-physical Roe-averaged state, which leads to a loss of hyperbolicity. By analyzing the potential causes and evaluating established safeguards, you will develop the critical thinking needed to build robust numerical schemes that can handle challenging flow conditions like strong expansions. ",
            "id": "3992411",
            "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma$, written in conservation form for density $\\rho$, momentum $\\rho u$, and total energy $E$. The flux Jacobian associated with these equations has three real eigenvalues in a physically admissible state: $u-c$, $u$, and $u+c$, where $u$ is the fluid velocity and $c$ is the thermodynamic sound speed defined by $c^2 = \\gamma p/\\rho = (\\gamma-1)\\left(H-\\frac{1}{2}u^2\\right)$ with $p$ the pressure and $H = (E+p)/\\rho$ the total specific enthalpy. In the Roe approximate Riemann solver, a linearization is constructed at a Roe-average state $\\tilde{\\boldsymbol{U}}$ built from left and right states $(\\rho_L,u_L,p_L)$ and $(\\rho_R,u_R,p_R)$, yielding Roe-averaged velocity $\\tilde{u}$ and Roe-averaged enthalpy $\\tilde{H}$, and a Roe sound speed defined by $\\tilde{c}^2 = (\\gamma-1)\\left(\\tilde{H}-\\frac{1}{2}\\tilde{u}^2\\right)$.\n\nStarting from the Euler equations and the ideal-gas thermodynamic relations, analyze the implications for the hyperbolicity of the Roe linearization when $\\tilde{H}-\\frac{1}{2}\\tilde{u}^2$ becomes negative. Explain the physical and mathematical meaning of this condition in terms of the intermediate state generated by the Roe linearization and the resulting eigenstructure. Based on first principles and well-tested numerical analysis facts, recommend safeguards that ensure physically admissible sound speeds and maintain a robust discretization in the presence of strong rarefactions or transonic expansions.\n\nWhich of the following safeguards are scientifically justified and sufficient to maintain physical sound speeds and a robust scheme under the stated circumstance?\n\nA. Apply the Harten–Hyman entropy fix to the Roe eigenvalues near $|u| \\approx \\tilde{c}$; the entropy fix alone guarantees that $\\tilde{c}^2$ remains nonnegative for all left and right states.\n\nB. Replace the Roe flux by a positivity-preserving Harten–Lax–van Leer family flux (e.g., HLL or Harten–Lax–van Leer–Einfeldt (HLLE)) when the Roe-averaged sound speed squared becomes negative, or use a hybrid flux that falls back to HLL/HLLE under a positivity sensor; this enforces positive intermediate density and pressure and thus real sound speeds.\n\nC. Use primitive-variable reconstruction with a Total Variation Diminishing limiter and positivity-preserving time stepping to ensure the reconstructed face states have positive pressure and density; this alone guarantees that the Roe-averaged $\\tilde{c}^2$ is nonnegative.\n\nD. Increase $\\gamma$ artificially until $(\\gamma-1)\\left(\\tilde{H}-\\frac{1}{2}\\tilde{u}^2\\right)$ becomes positive; this maintains physical sound speeds without compromising conservation or consistency.\n\nE. Modify the Roe averaging to use an energy-consistent or entropy-variable-based mean (e.g., a logarithmic mean for pressure/temperature) that preserves convexity and positivity of thermodynamic variables, ensuring $\\tilde{H}-\\frac{1}{2}\\tilde{u}^2 \\ge 0$; this yields a Roe linearization with real eigenvalues while retaining the upwind character.\n\nSelect all that apply.",
            "solution": "### Analysis of the Problem\nThe hyperbolicity of the Euler equations is fundamental to their physical nature, representing the propagation of information through waves (sound waves and entropy/contact waves). The eigenvalues of the flux Jacobian, $u-c$, $u$, and $u+c$, represent the speeds of these waves. For the system to be hyperbolic, these eigenvalues must be real, which requires the sound speed $c$ to be a real number. This implies $c^2 = \\gamma p / \\rho \\ge 0$. Since $\\gamma1$ and $\\rho0$ for any physical state, this is equivalent to requiring the pressure $p \\ge 0$.\n\nThe Roe approximate Riemann solver linearizes the nonlinear Euler equations at a cell interface by introducing a matrix $\\tilde{A}(\\boldsymbol{U}_L, \\boldsymbol{U}_R)$ that has two properties:\n$1$. It is consistent with the true Jacobian: $\\tilde{A}(\\boldsymbol{U}, \\boldsymbol{U}) = A(\\boldsymbol{U})$.\n$2$. It satisfies the jump condition exactly: $\\boldsymbol{F}(\\boldsymbol{U}_R) - \\boldsymbol{F}(\\boldsymbol{U}_L) = \\tilde{A}(\\boldsymbol{U}_L, \\boldsymbol{U}_R)(\\boldsymbol{U}_R - \\boldsymbol{U}_L)$.\n\nThe eigenvalues of this Roe matrix $\\tilde{A}$ are $\\tilde{u}-\\tilde{c}$, $\\tilde{u}$, and $\\tilde{u}+\\tilde{c}$, where $\\tilde{u}$ is the Roe-averaged velocity and $\\tilde{c}$ is the Roe-averaged sound speed. For the numerical scheme to be stable and physically meaningful, this linearized system must also be hyperbolic, which means its eigenvalues must be real. This requires $\\tilde{c}^2 \\ge 0$.\n\nThe problem focuses on the condition where this fails: $\\tilde{c}^2  0$. From the definition $\\tilde{c}^2 = (\\gamma-1)\\left(\\tilde{H}-\\frac{1}{2}\\tilde{u}^2\\right)$, and noting that $\\gamma-1  0$ for any physical gas, this failure implies $\\tilde{H}-\\frac{1}{2}\\tilde{u}^2  0$.\nThe term $H - \\frac{1}{2}u^2$ for a single physical state is equal to the specific internal energy plus the pressure-density ratio: $H - \\frac{1}{2}u^2 = (e+p/\\rho+\\frac{1}{2}u^2) - \\frac{1}{2}u^2 = e + p/\\rho$. For an ideal gas, $p = (\\gamma-1)\\rho e$, so $p/\\rho = (\\gamma-1)e$. Thus, $e+p/\\rho = e+(\\gamma-1)e = \\gamma e$.\nTherefore, the condition $\\tilde{H}-\\frac{1}{2}\\tilde{u}^2  0$ signifies that the Roe-averaged state corresponds to an unphysical state with an effective negative internal energy or pressure. This occurs because the standard Roe averaging formulas, while satisfying the jump condition, do not inherently preserve the positivity of thermodynamic quantities.\n\nWhen $\\tilde{c}^2  0$, $\\tilde{c}$ becomes an imaginary number. The eigenvalues $\\tilde{u} \\pm \\tilde{c}$ become a complex conjugate pair. A system with complex eigenvalues is elliptic, not hyperbolic. Applying an upwind scheme, which relies on the signs of real eigenvalues to determine the direction of information propagation, to an elliptic system leads to a catastrophic breakdown of the method and explosive numerical instability.\n\nThe task is to identify valid safeguards against this failure.\n\n### Option-by-Option Analysis\n\n**A. Apply the Harten–Hyman entropy fix to the Roe eigenvalues near $|u| \\approx \\tilde{c}$; the entropy fix alone guarantees that $\\tilde{c}^2$ remains nonnegative for all left and right states.**\n\nThe Harten-Hyman entropy fix (or simply Harten's entropy fix) is designed to solve a different problem. The standard Roe solver can incorrectly admit non-physical \"expansion shocks\" in transonic rarefactions, where a characteristic speed passes through zero. The entropy fix adds a small amount of numerical dissipation to \"smear\" the wave, ensuring the correct, continuous expansion fan is produced. It works by modifying an eigenvalue $\\lambda$ when its magnitude $|\\lambda|$ is very small, for example, by replacing $|\\lambda|$ with a function like $\\frac{\\lambda^2+\\delta^2}{2\\delta}$ for $|\\lambda|  \\delta$, where $\\delta$ is a small parameter. This procedure presupposes that the eigenvalues are real to begin with. It does not, and cannot, prevent $\\tilde{c}^2$ from becoming negative. The statement that the entropy fix *alone* guarantees non-negative $\\tilde{c}^2$ is factually wrong.\n\n**Verdict: Incorrect.**\n\n**B. Replace the Roe flux by a positivity-preserving Harten–Lax–van Leer family flux (e.g., HLL or Harten–Lax–van Leer–Einfeldt (HLLE)) when the Roe-averaged sound speed squared becomes negative, or use a hybrid flux that falls back to HLL/HLLE under a positivity sensor; this enforces positive intermediate density and pressure and thus real sound speeds.**\n\nThis describes a widely used and effective \"hybrid scheme\" strategy. HLL-type solvers are known for their robustness. They are generally more dissipative than the Roe solver because they do not resolve all characteristic waves, but they are positivity-preserving under a suitable CFL condition. This means they can be designed to never produce negative densities or pressures from positive input data. The strategy is to use the high-resolution Roe solver by default, but to check for pathologies at each cell interface. If a sensor (such as the condition $\\tilde{c}^2  0$) detects that the Roe solver is about to fail, the scheme locally switches to a robust HLL or HLLE flux for that interface. This \"fallback\" mechanism combines the accuracy of Roe in smooth regions with the robustness of HLL in problematic regions. This is a scientifically justified, practical, and sufficient safeguard.\n\n**Verdict: Correct.**\n\n**C. Use primitive-variable reconstruction with a Total Variation Diminishing limiter and positivity-preserving time stepping to ensure the reconstructed face states have positive pressure and density; this alone guarantees that the Roe-averaged $\\tilde{c}^2$ is nonnegative.**\n\nThis option describes a collection of good practices for high-resolution finite volume schemes. Reconstructing primitive variables ($\\rho, u, p$) often leads to better behavior than reconstructing conserved variables. TVD limiters are essential for non-oscillatory shock capturing. Positivity-preserving methods for reconstruction and time-stepping are important for ensuring the cell-averaged state remains physical. However, the core of the problem lies not in the left and right states fed into the Riemann solver, but in the Roe *averaging procedure* itself. The standard Roe average can take two perfectly valid, physical states $(\\boldsymbol{U}_L, \\boldsymbol{U}_R)$ and produce an intermediate state $\\tilde{\\boldsymbol{U}}$ that is unphysical (i.e., leads to $\\tilde{c}^2  0$). Therefore, ensuring the input states are physical is a necessary but not sufficient condition. This safeguard, by itself, does not fix the flaw within the Roe averaging.\n\n**Verdict: Incorrect.**\n\n**D. Increase $\\gamma$ artificially until $(\\gamma-1)\\left(\\tilde{H}-\\frac{1}{2}\\tilde{u}^2\\right)$ becomes positive; this maintains physical sound speeds without compromising conservation or consistency.**\n\nThis proposal is fundamentally unsound from a scientific perspective. The ratio of specific heats, $\\gamma$, is a physical property of the gas being modeled (e.g., $\\gamma \\approx 1.4$ for air). Artificially modifying a physical constant constitutes a change to the governing equations themselves. While it might mathematically \"fix\" the sign of $\\tilde{c}^2$ in some cases, the resulting numerical solution would no longer be an approximation of the solution to the original physical problem. It compromises consistency with the intended partial differential equation. Conservation might be maintained for the *modified* equations, but not the original ones in a meaningful way. This is an unprincipled \"hack\" that violates the fundamental goal of simulation, which is to model physical reality.\n\n**Verdict: Incorrect.**\n\n**E. Modify the Roe averaging to use an energy-consistent or entropy-variable-based mean (e.g., a logarithmic mean for pressure/temperature) that preserves convexity and positivity of thermodynamic variables, ensuring $\\tilde{H}-\\frac{1}{2}\\tilde{u}^2 \\ge 0$; this yields a Roe linearization with real eigenvalues while retaining the upwind character.**\n\nThis approach addresses the root cause of the problem: the inadequacy of the standard algebraic Roe averaging. The failure of the Roe average is tied to its failure to respect the convex structure of the entropy function. By designing a new averaging procedure based on more fundamental physical or mathematical principles, the problem can be eliminated. Averaging based on entropy variables is known to produce physically admissible intermediate states by construction. Similarly, for an ideal gas, specific choices of logarithmic means for thermodynamic variables can be used to construct a Roe-like matrix that is guaranteed to have the property of positivity, ensuring $\\tilde{c}^2 \\ge 0$ for any two physical input states. This modification creates a solver that is both robust (always hyperbolic) and accurate (fully upwind, resolving all waves), representing a more fundamental and elegant solution than a hybrid scheme. This is a scientifically justified and sufficient safeguard.\n\n**Verdict: Correct.**",
            "answer": "$$\\boxed{BE}$$"
        }
    ]
}