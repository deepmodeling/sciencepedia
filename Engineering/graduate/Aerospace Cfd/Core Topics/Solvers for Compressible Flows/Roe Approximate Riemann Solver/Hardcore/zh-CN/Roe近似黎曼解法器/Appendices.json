{
    "hands_on_practices": [
        {
            "introduction": "Roe 求解器的精妙之处在于其独特的平均方法，该方法保证了离散的通量差可以被线性化的系统精确捕捉。本练习旨在通过直接的计算，来验证这一核心的“Roe 性质”，即 $A(\\tilde{U})\\Delta U = \\Delta F$。完成这个验证练习 ，您将不仅仅是在完成一道计算题，更是亲手揭示了为何 Roe 平均状态并非简单的算术平均，而是一种为满足特定数学条件而精心构造的结果，从而更深刻地理解该方法背后的理论基础。",
            "id": "3992129",
            "problem": "考虑用于计算流体动力学 (CFD) 的理想气体一维可压缩欧拉方程。令守恒变量矢量为 $U = (\\rho, \\rho u, \\rho E)^{\\mathsf{T}}$，其中 $\\rho$ 是密度， $u$ 是速度， $E$ 是总比能。理想气体关系式为 $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$，对应的物理通量为 $F(U) = (\\rho u,\\ \\rho u^{2} + p,\\ u(\\rho E + p))^{\\mathsf{T}}$。定义总比焓 $H = E + \\frac{p}{\\rho}$。对于 Roe 线性化，Roe 平均速度和 Roe 平均焓定义为\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_{L}}\\,u_{L} + \\sqrt{\\rho_{R}}\\,u_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}}, \n\\quad\n\\tilde{H} = \\frac{\\sqrt{\\rho_{L}}\\,H_{L} + \\sqrt{\\rho_{R}}\\,H_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}},\n$$\nRoe 平均声速满足 $\\tilde{a}^{2} = (\\gamma - 1)\\left(\\tilde{H} - \\tfrac{1}{2}\\tilde{u}^{2}\\right)$。\n\n取以下左、右状态（所有量在物理上均一致，并指向比热比 $\\gamma = \\tfrac{7}{5}$ 的同一种理想气体）：\n- 左状态：$\\rho_{L} = 4$ kg/m$^{3}$，$u_{L} = 2$ m/s，$p_{L} = 10$ Pa。\n- 右状态：$\\rho_{R} = 9$ kg/m$^{3}$，$u_{R} = 1$ m/s，$p_{R} = 20$ Pa。\n\n使用 $E = \\tfrac{p}{(\\gamma-1)\\rho} + \\tfrac{1}{2}u^{2}$ 计算 $U_{L}$ 和 $U_{R}$，然后计算 $F(U_{L})$ 和 $F(U_{R})$。使用上述 Roe 平均值，构建在 Roe 平均状态 $\\tilde{U}$（用 $(\\tilde{u}, \\tilde{H}, \\gamma)$ 表示）下求值的 $3\\times 3$ 通量雅可比矩阵 $A(\\tilde{U}) = \\frac{\\partial F}{\\partial U}\\big|_{\\tilde{U}}$。最后，计算残差矢量\n$$\nR \\equiv A(\\tilde{U})\\,(U_{R} - U_{L}) - \\big(F(U_{R}) - F(U_{L})\\big).\n$$\n\n精确计算 $R$，并将其三个分量以单个行矢量的形式给出。无需四舍五入。最终数值答案中不包含单位。",
            "solution": "用户希望在 1D 欧拉方程的背景下，为一组特定的左、右状态计算残差矢量 $R \\equiv A(\\tilde{U})\\,(U_{R} - U_{L}) - \\big(F(U_{R}) - F(U_{L})\\big)$。这个问题的核心是验证 Roe 平均矩阵是否满足性质 $A(\\tilde{U})\\Delta U = \\Delta F$，这是 Roe 近似黎曼求解器的一个基本要求。这意味着残差矢量 $R$ 应该为零矢量。我们将进行显式计算来验证这一点。\n\n比热比给定为 $\\gamma = \\frac{7}{5}$。因此，$\\gamma-1 = \\frac{2}{5}$。\n\n**步骤 1：计算状态矢量 $U_{L}$ 和 $U_{R}$**\n\n总比能 $E$ 由 $E = \\frac{p}{(\\gamma-1)\\rho} + \\frac{1}{2}u^{2}$ 给出。\n\n对于左状态 $(L)$：\n$\\rho_{L} = 4$，$u_{L} = 2$，$p_{L} = 10$。\n总比能 $E_{L}$ 为：\n$$E_{L} = \\frac{p_{L}}{(\\gamma-1)\\rho_{L}} + \\frac{1}{2}u_{L}^{2} = \\frac{10}{(\\frac{2}{5})(4)} + \\frac{1}{2}(2)^{2} = \\frac{10}{\\frac{8}{5}} + 2 = \\frac{50}{8} + 2 = \\frac{25}{4} + 2 = \\frac{33}{4}$$\n守恒变量矢量 $U_{L}$ 为：\n$$U_{L} = \\begin{pmatrix} \\rho_{L} \\\\ \\rho_{L} u_{L} \\\\ \\rho_{L} E_{L} \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 4(2) \\\\ 4(\\frac{33}{4}) \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 8 \\\\ 33 \\end{pmatrix}$$\n\n对于右状态 $(R)$：\n$\\rho_{R} = 9$，$u_{R} = 1$，$p_{R} = 20$。\n总比能 $E_{R}$ 为：\n$$E_{R} = \\frac{p_{R}}{(\\gamma-1)\\rho_{R}} + \\frac{1}{2}u_{R}^{2} = \\frac{20}{(\\frac{2}{5})(9)} + \\frac{1}{2}(1)^{2} = \\frac{20}{\\frac{18}{5}} + \\frac{1}{2} = \\frac{100}{18} + \\frac{1}{2} = \\frac{50}{9} + \\frac{1}{2} = \\frac{100+9}{18} = \\frac{109}{18}$$\n守恒变量矢量 $U_{R}$ 为：\n$$U_{R} = \\begin{pmatrix} \\rho_{R} \\\\ \\rho_{R} u_{R} \\\\ \\rho_{R} E_{R} \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 9(1) \\\\ 9(\\frac{109}{18}) \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 9 \\\\ \\frac{109}{2} \\end{pmatrix}$$\n\n**步骤 2：计算通量矢量 $F(U_{L})$ 和 $F(U_{R})$**\n\n通量矢量 $F(U)$ 由 $F(U) = (\\rho u, \\rho u^{2}+p, u(\\rho E + p))^{\\mathsf{T}}$ 给出。\n\n对于左状态 $(L)$：\n$$F(U_{L}) = \\begin{pmatrix} \\rho_{L} u_{L} \\\\ \\rho_{L} u_{L}^{2} + p_{L} \\\\ u_{L}(\\rho_{L} E_{L} + p_{L}) \\end{pmatrix} = \\begin{pmatrix} 4(2) \\\\ 4(2)^{2} + 10 \\\\ 2(33 + 10) \\end{pmatrix} = \\begin{pmatrix} 8 \\\\ 16 + 10 \\\\ 2(43) \\end{pmatrix} = \\begin{pmatrix} 8 \\\\ 26 \\\\ 86 \\end{pmatrix}$$\n\n对于右状态 $(R)$：\n$$F(U_{R}) = \\begin{pmatrix} \\rho_{R} u_{R} \\\\ \\rho_{R} u_{R}^{2} + p_{R} \\\\ u_{R}(\\rho_{R} E_{R} + p_{R}) \\end{pmatrix} = \\begin{pmatrix} 9(1) \\\\ 9(1)^{2} + 20 \\\\ 1(\\frac{109}{2} + 20) \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 9 + 20 \\\\ \\frac{109+40}{2} \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 29 \\\\ \\frac{149}{2} \\end{pmatrix}$$\n\n**步骤 3：计算差分 $\\Delta U$ 和 $\\Delta F$**\n\n$$\\Delta U = U_{R} - U_{L} = \\begin{pmatrix} 9 - 4 \\\\ 9 - 8 \\\\ \\frac{109}{2} - 33 \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 1 \\\\ \\frac{109 - 66}{2} \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 1 \\\\ \\frac{43}{2} \\end{pmatrix}$$\n$$\\Delta F = F(U_{R}) - F(U_{L}) = \\begin{pmatrix} 9 - 8 \\\\ 29 - 26 \\\\ \\frac{149}{2} - 86 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 3 \\\\ \\frac{149 - 172}{2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 3 \\\\ -\\frac{23}{2} \\end{pmatrix}$$\n\n**步骤 4：计算 Roe 平均值 $\\tilde{u}$ 和 $\\tilde{H}$**\n\n首先，使用 $H = E + \\frac{p}{\\rho}$ 计算比焓 $H_{L}$ 和 $H_{R}$。\n$$H_{L} = E_{L} + \\frac{p_{L}}{\\rho_{L}} = \\frac{33}{4} + \\frac{10}{4} = \\frac{43}{4}$$\n$$H_{R} = E_{R} + \\frac{p_{R}}{\\rho_{R}} = \\frac{109}{18} + \\frac{20}{9} = \\frac{109 + 40}{18} = \\frac{149}{18}$$\n现在，计算 Roe 平均值。我们有 $\\sqrt{\\rho_{L}} = \\sqrt{4} = 2$ 和 $\\sqrt{\\rho_{R}} = \\sqrt{9} = 3$。\n$$\\tilde{u} = \\frac{\\sqrt{\\rho_{L}}\\,u_{L} + \\sqrt{\\rho_{R}}\\,u_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} = \\frac{2(2) + 3(1)}{2+3} = \\frac{4+3}{5} = \\frac{7}{5}$$\n$$\\tilde{H} = \\frac{\\sqrt{\\rho_{L}}\\,H_{L} + \\sqrt{\\rho_{R}}\\,H_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} = \\frac{2(\\frac{43}{4}) + 3(\\frac{149}{18})}{5} = \\frac{\\frac{43}{2} + \\frac{149}{6}}{5} = \\frac{\\frac{3(43)+149}{6}}{5} = \\frac{129+149}{30} = \\frac{278}{30} = \\frac{139}{15}$$\n\n**步骤 5：构建 Roe 矩阵 $A(\\tilde{U})$**\n\n在速度为 $u$、比焓为 $H$ 的状态下求值的通量雅可比矩阵 $A(U) = \\frac{\\partial F}{\\partial U}$ 为：\n$$A(u, H) = \\begin{pmatrix} 0  1  0 \\\\ \\frac{\\gamma-3}{2}u^2  (3-\\gamma)u  \\gamma-1 \\\\ u\\left(\\frac{\\gamma-1}{2}u^2-H\\right)  H - (\\gamma-1)u^2  \\gamma u \\end{pmatrix}$$\n我们在 Roe 平均状态 $(\\tilde{u}, \\tilde{H})$ 下对此矩阵求值。我们有 $\\gamma=\\frac{7}{5}$，因此 $\\gamma-1=\\frac{2}{5}$，$3-\\gamma=\\frac{8}{5}$，以及 $\\frac{\\gamma-3}{2}=-\\frac{4}{5}$。\n让我们计算 $A(\\tilde{U}) = A(\\tilde{u}, \\tilde{H})$ 的分量：\n$A_{11} = 0$, $A_{12} = 1$, $A_{13} = 0$。\n$A_{21} = \\frac{\\gamma-3}{2}\\tilde{u}^{2} = -\\frac{4}{5}\\left(\\frac{7}{5}\\right)^{2} = -\\frac{4}{5}\\left(\\frac{49}{25}\\right) = -\\frac{196}{125}$。\n$A_{22} = (3-\\gamma)\\tilde{u} = \\frac{8}{5}\\left(\\frac{7}{5}\\right) = \\frac{56}{25}$。\n$A_{23} = \\gamma-1 = \\frac{2}{5}$。\n$A_{31} = \\tilde{u}\\left(\\frac{\\gamma-1}{2}\\tilde{u}^{2}-\\tilde{H}\\right) = \\frac{7}{5}\\left(\\frac{1}{2}\\left(\\frac{2}{5}\\right)\\left(\\frac{7}{5}\\right)^{2} - \\frac{139}{15}\\right) = \\frac{7}{5}\\left(\\frac{49}{125} - \\frac{139}{15}\\right) = \\frac{7}{5}\\left(\\frac{49 \\cdot 3 - 139 \\cdot 25}{375}\\right) = \\frac{7}{5}\\left(\\frac{147 - 3475}{375}\\right) = \\frac{7}{5}\\left(\\frac{-3328}{375}\\right) = -\\frac{23296}{1875}$。\n$A_{32} = \\tilde{H} - (\\gamma-1)\\tilde{u}^{2} = \\frac{139}{15} - \\frac{2}{5}\\left(\\frac{7}{5}\\right)^{2} = \\frac{139}{15} - \\frac{98}{125} = \\frac{139 \\cdot 25 - 98 \\cdot 3}{375} = \\frac{3475-294}{375} = \\frac{3181}{375}$。\n$A_{33} = \\gamma \\tilde{u} = \\frac{7}{5}\\left(\\frac{7}{5}\\right) = \\frac{49}{25}$。\n\n所以，Roe 矩阵为：\n$$A(\\tilde{U}) = \\begin{pmatrix} 0  1  0 \\\\ -\\frac{196}{125}  \\frac{56}{25}  \\frac{2}{5} \\\\ -\\frac{23296}{1875}  \\frac{3181}{375}  \\frac{49}{25} \\end{pmatrix}$$\n\n**步骤 6：计算残差矢量 $R$**\n\n我们逐分量地计算乘积 $A(\\tilde{U})\\Delta U$。\n第一个分量：\n$$(A(\\tilde{U})\\Delta U)_1 = (0)(5) + (1)(1) + (0)\\left(\\frac{43}{2}\\right) = 1$$\n第二个分量：\n$$(A(\\tilde{U})\\Delta U)_2 = \\left(-\\frac{196}{125}\\right)(5) + \\left(\\frac{56}{25}\\right)(1) + \\left(\\frac{2}{5}\\right)\\left(\\frac{43}{2}\\right) = -\\frac{196}{25} + \\frac{56}{25} + \\frac{43}{5} = \\frac{-196+56}{25} + \\frac{215}{25} = \\frac{-140+215}{25} = \\frac{75}{25} = 3$$\n第三个分量：\n$$(A(\\tilde{U})\\Delta U)_3 = \\left(-\\frac{23296}{1875}\\right)(5) + \\left(\\frac{3181}{375}\\right)(1) + \\left(\\frac{49}{25}\\right)\\left(\\frac{43}{2}\\right) = -\\frac{23296}{375} + \\frac{3181}{375} + \\frac{2107}{50} = \\frac{-20115}{375} + \\frac{2107}{50}$$\n为了简化第一项，我们用公因数约分分子和分母。$375 = 3 \\cdot 5^3 = 3 \\cdot 125$。$20115$ 可被 $3$ 和 $5$ 整除。$20115/15 = 1341$ 且 $375/15=25$。所以，$-\\frac{20115}{375} = -\\frac{1341}{25}$。\n$$(A(\\tilde{U})\\Delta U)_3 = -\\frac{1341}{25} + \\frac{2107}{50} = -\\frac{2682}{50} + \\frac{2107}{50} = \\frac{-575}{50} = -\\frac{115}{10} = -\\frac{23}{2}$$\n所以，我们有：\n$$A(\\tilde{U})\\Delta U = \\begin{pmatrix} 1 \\\\ 3 \\\\ -\\frac{23}{2} \\end{pmatrix}$$\n现在我们计算残差矢量 $R$：\n$$R = A(\\tilde{U})\\Delta U - \\Delta F = \\begin{pmatrix} 1 \\\\ 3 \\\\ -\\frac{23}{2} \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 3 \\\\ -\\frac{23}{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n计算证实了对于给定的状态，Roe 矩阵满足所需的性质，并且残差为零矢量。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "尽管 Roe 求解器在处理激波和接触间断方面非常精确，但它有一个众所周知的缺陷：在处理跨音速稀疏波时，它可能无法选择出符合物理现实的解，从而可能产生非物理的“膨胀激波”。本练习  将您直接置于这一失效点，并指导您如何应用一种标准的“熵修正”方法。掌握这一实践技能至关重要，因为它能确保包含声速点的数值模拟的鲁棒性和物理真实性。",
            "id": "3992160",
            "problem": "考虑在计算流体力学 (CFD) 中，作为一个黎曼问题提出的一维理想气体沿流向的可压缩欧拉方程。该气体的恒定比热容比为 $\\gamma = 1.4$。左、右状态分别为\n$\\rho_{L} = 1.0 \\,\\mathrm{kg/m^3}$，$u_{L} = 400 \\,\\mathrm{m/s}$，$p_{L} = \\dfrac{290000}{7} \\,\\mathrm{Pa}$，以及\n$\\rho_{R} = 1.0 \\,\\mathrm{kg/m^3}$，$u_{R} = 100 \\,\\mathrm{m/s}$，$p_{R} = \\dfrac{290000}{7} \\,\\mathrm{Pa}$。\n假设理想气体关系，并使用基于 Roe 平均值的标准 Roe 近似黎曼求解器线性化。将此情况视为 Roe 线性化中跨越声速点的跨音速稀疏波。\n\n从一维欧拉方程、理想气体焓和 Roe 平均态的定义出发，执行以下步骤：\n- 从给定的左右状态推导出 Roe 平均速度 $\\tilde{u}$ 和 Roe 平均总比焓 $\\tilde{H}$。\n- 由此推导出 Roe 平均声速 $\\tilde{a}$。\n- 使用 Roe 平均态，推导出在进行任何熵修正之前，沿流向的通量雅可比矩阵的三个 Roe 特征值。\n- 应用 Harten 熵修正，阈值参数为 $\\varepsilon = 120 \\,\\mathrm{m/s}$，以获得修正后的绝对特征值 $|\\lambda_{k}|_{\\varepsilon}$。对于每个特征速度 $\\lambda$，修正定义为：若 $|\\lambda|  \\varepsilon$，则 $|\\lambda|_{\\varepsilon} = \\dfrac{1}{2}\\!\\left(\\dfrac{\\lambda^{2}}{\\varepsilon} + \\varepsilon\\right)$；否则 $|\\lambda|_{\\varepsilon} = |\\lambda|$。\n- 计算修正后的总特征耗散权重，定义为 $\\sum_{k=1}^{3} |\\lambda_{k}|_{\\varepsilon}$。\n\n将最终答案以单行矩阵的形式给出，依次包含 $\\lambda_{1}$、$\\lambda_{2}$、$\\lambda_{3}$、$|\\lambda_{1}|_{\\varepsilon}$、$|\\lambda_{2}|_{\\varepsilon}$、$|\\lambda_{3}|_{\\varepsilon}$ 和 $\\sum_{k=1}^{3} |\\lambda_{k}|_{\\varepsilon}$。\n所有类速度量均以 $\\mathrm{m/s}$ 为单位表示。使用精确值，无需四舍五入。",
            "solution": "该问题要求使用 Roe 的近似黎曼求解器来分析一个特定的可压缩欧拉方程一维黎曼问题。该气体为理想气体，其恒定比热容比为 $\\gamma = 1.4$。\n\n对于理想气体，基本量是总比焓 $H$ 和声速 $a$。总比焓定义为 $H = E + \\frac{p}{\\rho}$，其中 $E = e + \\frac{1}{2}u^2$ 是总比能，$e$ 是比内能，$p$ 是压力，$\\rho$ 是密度，$u$ 是速度。对于理想气体，$e = \\frac{p}{\\rho(\\gamma-1)}$，因此焓可以表示为 $H = \\frac{\\gamma p}{\\rho(\\gamma-1)} + \\frac{1}{2}u^2$。声速由 $a^2 = \\frac{\\gamma p}{\\rho}$ 给出。利用此关系，焓也可以写成 $H = \\frac{a^2}{\\gamma-1} + \\frac{1}{2}u^2$。\n\n给定的左 ($L$) 和右 ($R$) 状态为：\n$\\rho_{L} = 1.0 \\,\\mathrm{kg/m^3}$，$u_{L} = 400 \\,\\mathrm{m/s}$，$p_{L} = \\frac{290000}{7} \\,\\mathrm{Pa}$。\n$\\rho_{R} = 1.0 \\,\\mathrm{kg/m^3}$，$u_{R} = 100 \\,\\mathrm{m/s}$，$p_{R} = \\frac{290000}{7} \\,\\mathrm{Pa}$。\n比热容比为 $\\gamma = 1.4 = \\frac{7}{5}$。\n\n首先，我们推导 Roe 平均状态变量。Roe 平均速度 $\\tilde{u}$ 由以下公式给出：\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L} u_L + \\sqrt{\\rho_R} u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\n代入给定值：\n$$\n\\tilde{u} = \\frac{\\sqrt{1.0} \\cdot 400 + \\sqrt{1.0} \\cdot 100}{\\sqrt{1.0} + \\sqrt{1.0}} = \\frac{400 + 100}{2} = 250 \\,\\mathrm{m/s}\n$$\nRoe 平均总比焓 $\\tilde{H}$ 由以下公式给出：\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho_L} H_L + \\sqrt{\\rho_R} H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\n为了计算 $\\tilde{H}$，我们首先需要确定总比焓 $H_L$ 和 $H_R$。我们从计算每个状态的声速平方开始。由于 $p_L=p_R$ 和 $\\rho_L=\\rho_R$，我们有 $a_L=a_R$。\n$$\na_L^2 = a_R^2 = \\frac{\\gamma p_L}{\\rho_L} = \\frac{1.4 \\cdot \\frac{290000}{7}}{1.0} = \\frac{\\frac{7}{5} \\cdot \\frac{290000}{7}}{1} = \\frac{290000}{5} = 58000 \\,(\\mathrm{m/s})^2\n$$\n现在我们使用 $\\gamma-1 = 1.4 - 1 = 0.4 = \\frac{2}{5}$ 计算 $H_L$ 和 $H_R$：\n$$\nH_L = \\frac{a_L^2}{\\gamma-1} + \\frac{1}{2}u_L^2 = \\frac{58000}{0.4} + \\frac{1}{2}(400)^2 = 145000 + \\frac{160000}{2} = 145000 + 80000 = 225000 \\,\\mathrm{J/kg}\n$$\n$$\nH_R = \\frac{a_R^2}{\\gamma-1} + \\frac{1}{2}u_R^2 = \\frac{58000}{0.4} + \\frac{1}{2}(100)^2 = 145000 + \\frac{10000}{2} = 145000 + 5000 = 150000 \\,\\mathrm{J/kg}\n$$\n有了 $H_L$ 和 $H_R$，我们可以计算 $\\tilde{H}$：\n$$\n\\tilde{H} = \\frac{\\sqrt{1.0} \\cdot 225000 + \\sqrt{1.0} \\cdot 150000}{\\sqrt{1.0} + \\sqrt{1.0}} = \\frac{225000 + 150000}{2} = \\frac{375000}{2} = 187500 \\,\\mathrm{J/kg}\n$$\n接下来，我们从 $\\tilde{u}$ 和 $\\tilde{H}$ 推导 Roe 平均声速 $\\tilde{a}$：\n$$\n\\tilde{a}^2 = (\\gamma-1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2\\right)\n$$\n代入计算出的值：\n$$\n\\tilde{a}^2 = (0.4)\\left(187500 - \\frac{1}{2}(250)^2\\right) = \\frac{2}{5}\\left(187500 - \\frac{62500}{2}\\right) = \\frac{2}{5}(187500 - 31250) = \\frac{2}{5}(156250) = 62500 \\,(\\mathrm{m/s})^2\n$$\n$$\n\\tilde{a} = \\sqrt{62500} = 250 \\,\\mathrm{m/s}\n$$\nRoe 通量雅可比矩阵 $\\tilde{A}$ 的特征值为 $\\lambda_1 = \\tilde{u} - \\tilde{a}$，$\\lambda_2 = \\tilde{u}$ 和 $\\lambda_3 = \\tilde{u} + \\tilde{a}$。\n$$\n\\lambda_1 = 250 - 250 = 0 \\,\\mathrm{m/s}\n$$\n$$\n\\lambda_2 = 250 \\,\\mathrm{m/s}\n$$\n$$\n\\lambda_3 = 250 + 250 = 500 \\,\\mathrm{m/s}\n$$\n题目指出这是一个跨音速稀疏波的情况，这一点由 $\\lambda_1 = 0$ 证实。这个消失的特征值需要进行熵修正，以防止出现非物理的解。我们应用 Harten 的熵修正，阈值为 $\\varepsilon = 120 \\,\\mathrm{m/s}$。修正后的绝对特征值 $|\\lambda|_\\varepsilon$ 的规则是：\n$$\n|\\lambda|_{\\varepsilon} =\n\\begin{cases}\n\\frac{1}{2}\\left(\\frac{\\lambda^2}{\\varepsilon} + \\varepsilon\\right)  \\text{if } |\\lambda|  \\varepsilon \\\\\n|\\lambda|  \\text{if } |\\lambda| \\ge \\varepsilon\n\\end{cases}\n$$\n我们对每个特征值应用此修正：\n对于 $\\lambda_1 = 0$：\n$|\\lambda_1| = 0$，小于 $\\varepsilon = 120$。\n$$\n|\\lambda_1|_{\\varepsilon} = \\frac{1}{2}\\left(\\frac{0^2}{120} + 120\\right) = \\frac{1}{2}(120) = 60 \\,\\mathrm{m/s}\n$$\n对于 $\\lambda_2 = 250$：\n$|\\lambda_2| = 250$，大于 $\\varepsilon = 120$。\n$$\n|\\lambda_2|_{\\varepsilon} = |\\lambda_2| = 250 \\,\\mathrm{m/s}\n$$\n对于 $\\lambda_3 = 500$：\n$|\\lambda_3| = 500$，大于 $\\varepsilon = 120$。\n$$\n|\\lambda_3|_{\\varepsilon} = |\\lambda_3| = 500 \\,\\mathrm{m/s}\n$$\n最后，我们计算修正后的总特征耗散权重，即修正后的绝对特征值之和：\n$$\n\\sum_{k=1}^{3} |\\lambda_{k}|_{\\varepsilon} = |\\lambda_{1}|_{\\varepsilon} + |\\lambda_{2}|_{\\varepsilon} + |\\lambda_{3}|_{\\varepsilon} = 60 + 250 + 500 = 810 \\,\\mathrm{m/s}\n$$\n所需的量为：\n$\\lambda_1 = 0 \\,\\mathrm{m/s}$\n$\\lambda_2 = 250 \\,\\mathrm{m/s}$\n$\\lambda_3 = 500 \\,\\mathrm{m/s}$\n$|\\lambda_1|_{\\varepsilon} = 60 \\,\\mathrm{m/s}$\n$|\\lambda_2|_{\\varepsilon} = 250 \\,\\mathrm{m/s}$\n$|\\lambda_3|_{\\varepsilon} = 500 \\,\\mathrm{m/s}$\n$\\sum_{k=1}^{3} |\\lambda_k|_{\\varepsilon} = 810 \\,\\mathrm{m/s}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  250  500  60  250  500  810 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "将计算流体力学求解器应用于实际问题，通常意味着需要处理源项，例如在航空航天的大气模拟中无处不在的重力。为纯守恒律设计的标准 Roe 求解器在处理这类问题时，可能无法精确维持简单的平衡态（如流体静力平衡），从而引入虚假的数值误差。本练习  通过量化一个非“平衡格式”（well-balanced scheme）所产生的非物理速度，清晰地揭示了这一陷阱，从而强调了在存在源项时进行特殊数值格式设计的必要性。",
            "id": "3992163",
            "problem": "考虑在 $x$ 轴负方向上受恒定重力加速度作用的一维可压缩欧拉方程。在有重力的情况下，质量、动量和能量守恒的控制方程为\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{bmatrix}\n\\rho \\\\\n\\rho u \\\\\nE\n\\end{bmatrix}\n+ \\frac{\\partial}{\\partial x}\n\\begin{bmatrix}\n\\rho u \\\\\n\\rho u^2 + p \\\\\nu(E + p)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n0 \\\\\n-\\rho g \\\\\n-\\rho g u\n\\end{bmatrix},\n$$\n其中 $\\rho$ 是密度，$u$ 是速度，$E$ 是单位体积的总能量，$p$ 是压力，$g$ 是恒定的重力加速度。假设为理想气体，其比热比为 $\\gamma$，特定气体常数为 $R$，因此热力学关系为 $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^2\\right)$ 和 $p = \\rho R T$（其中 $T$ 为温度）。\n\n流体静力平衡的特征是 $u(x) = 0$ 和平衡条件 $\\frac{dp}{dx} = -\\rho g$。对于温度恒为 $T$ 的等温大气，其静压剖面为\n$$\np(x) = p_0 \\exp\\left(-\\frac{x}{H}\\right), \\quad \\rho(x) = \\frac{p(x)}{R T}, \\quad u(x) = 0,\n$$\n其中标高 $H$ 由 $H = \\frac{R T}{g}$ 给出，$p_0$ 是 $x = 0$ 处的压力。\n\n在一个长度为 $L$ 的域上，使用 $N$ 个单元的均匀网格进行有限体积离散化，单元宽度为 $\\Delta x = \\frac{L}{N}$，时间步长 $\\Delta t$ 由 Courant–Friedrichs–Lewy (CFL) 条件选择。假设使用 Roe 近似黎曼求解器计算单元界面处的数值通量，通过一个显式时间步来推进解，但故意忽略重力源项（即，使用标准的 Roe 通量，不进行任何源项平衡）。这种忽略会破坏良态平衡性质，并导致对静力平衡状态的伪偏离。\n\n您的任务是实现一个程序，该程序：\n- 根据给定参数构造等温静力平衡初始条件。\n- 在均匀网格上，使用 Roe 近似黎曼求解器将一维欧拉方程的守恒状态推进一个显式有限体积时间步，其中虚拟单元由初始剖面的静力学延拓填充。\n- 在更新中不包含任何重力源项。\n- 在此单个时间步后，计算物理单元上伪速度 $|u|$ 的最大绝对值。\n\n使用以下物理和数值参数。所有量必须按其指定单位处理，答案必须以米/秒（m/s）为单位表示，并四舍五入到六位小数：\n- 情况 $1$ (一般情况)：$\\gamma = 1.4$, $R = 287$ $\\mathrm{J/(kg\\cdot K)}$, $T = 300$ $\\mathrm{K}$, $p_0 = 101325$ $\\mathrm{Pa}$, $g = 9.81$ $\\mathrm{m/s^2}$, $L = 1000$ $\\mathrm{m}$, $N = 100$, $\\mathrm{CFL} = 0.5$。\n- 情况 $2$ (粗分辨率)：与情况 1 相同，但 $N = 20$。\n- 情况 $3$ (强重力)：与情况 1 相同，但 $g = 50$ $\\mathrm{m/s^2}$。\n- 情况 $4$ (低温度)：与情况 1 相同，但 $T = 150$ $\\mathrm{K}$。\n- 情况 $5$ (高分辨率)：与情况 1 相同，但 $N = 400$。\n\n实现所需的定义：\n- 总能量为 $E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2$。\n- 声速为 $c = \\sqrt{\\gamma \\frac{p}{\\rho}}$。\n- 时间步长选择为 $\\Delta t = \\mathrm{CFL} \\frac{\\Delta x}{\\max_i(|u_i| + c_i)}$，其中最大值取自所有物理单元 $i$。\n- 每个界面处的数值通量必须是基于相邻单元的左右状态的 Roe 通量。\n- 使用一阶显式欧拉时间积分进行更新。\n\n测试套件和输出：\n- 使用上述五个参数集作为测试套件。\n- 对于每种情况，计算物理单元 $i$ 上的单步最大伪速度 $\\max_i |u_i^{n+1}|$，单位为 $\\mathrm{m/s}$，并四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按五种情况的顺序排列结果（例如，$[v_1,v_2,v_3,v_4,v_5]$），其中每个 $v_k$ 是情况 $k$ 的最大绝对速度，单位为 $\\mathrm{m/s}$。",
            "solution": "该问题是有效的。它提出了一个在计算流体动力学领域定义明确的数值实验，该实验基于欧拉方程和有限体积法的既定原理。所有必需的物理常数、初始条件和数值参数都已提供，并且没有科学上的不一致、矛盾或模糊之处。任务是量化因使用一个对带源项的系统而言非“良态平衡”的标准数值格式（Roe 求解器）而引入的误差，这是发展双曲守恒律数值方法中一个常见且重要的话题。\n\n求解过程首先离散化求解域，设置指定的初始条件，然后使用带有 Roe 近似黎曼求解器计算通量的显式有限体积法执行单时间步更新。\n\n**1. 离散化和初始条件**\n\n长度为 $L$ 的空间域被离散化为 $N$ 个均匀单元，索引为 $i = 1, \\dots, N$。每个单元的宽度为 $\\Delta x = L/N$。单元中心位于 $x_i = (i - 1/2)\\Delta x$ (对于 $i=1, \\dots, N$)。为了处理通量计算的边界条件，我们在域的每一端引入一个虚拟单元（单元 $0$ 和单元 $N+1$）。\n\n初始条件是等温大气的流体静力平衡，其特征是速度为零，压力剖面与重力平衡。每个单元中心 $x_i$ (对于 $i = 0, \\dots, N+1$) 的状态变量按如下方式初始化：\n- 给定特定气体常数 $R$、重力加速度 $g$ 和恒定温度 $T$。\n- 大气标高为 $H = \\frac{R T}{g}$。\n- 压力为 $p(x) = p_0 \\exp\\left(-\\frac{x}{H}\\right)$，其中 $p_0$ 是 $x=0$ 处的压力。\n- 密度为 $\\rho(x) = \\frac{p(x)}{R T}$。\n- 速度为 $u(x) = 0$。\n\n守恒状态向量 $\\mathbf{U}$ 有三个分量：$\\mathbf{U} = [\\rho, \\rho u, E]^T$。对于每个单元 $i$，初始状态 $\\mathbf{U}_i^n$（在时间 $n=0$ 时）为：\n- $\\rho_i = \\rho(x_i)$\n- $(\\rho u)_i = \\rho_i u(x_i) = 0$\n- $E_i = \\frac{p(x_i)}{\\gamma - 1} + \\frac{1}{2}\\rho_i u(x_i)^2 = \\frac{p(x_i)}{\\gamma - 1}$\n\n**2. 时间步计算**\n\n时间步长 $\\Delta t$ 由 Courant–Friedrichs–Lewy (CFL) 条件确定，以确保数值稳定性：\n$$ \\Delta t = \\mathrm{CFL} \\frac{\\Delta x}{\\max_i(|u_i| + c_i)} $$\n其中最大值取自所有物理单元。声速为 $c = \\sqrt{\\gamma p / \\rho}$。对于理想等温气体，这可以简化为：\n$$ c = \\sqrt{\\gamma \\frac{\\rho R T}{\\rho}} = \\sqrt{\\gamma R T} $$\n由于温度 $T$ 是恒定的，声速 $c$ 在整个域中也是恒定的。在初始时刻，$u_i = 0$ 对所有 $i$ 成立。因此，时间步长计算如下：\n$$ \\Delta t = \\mathrm{CFL} \\frac{\\Delta x}{\\sqrt{\\gamma R T}} $$\n\n**3. 有限体积更新**\n\n问题指定使用一阶显式欧拉时间积分。单元 $i$ 中的守恒变量根据以下有限体积公式从时间 $n$ 更新到 $n+1$：\n$$ \\mathbf{U}_i^{n+1} = \\mathbf{U}_i^n - \\frac{\\Delta t}{\\Delta x} \\left( \\mathbf{F}_{i+1/2} - \\mathbf{F}_{i-1/2} \\right) $$\n这里，$\\mathbf{F}_{i+1/2}$ 和 $\\mathbf{F}_{i-1/2}$ 分别是单元 $i$ 的右界面和左界面处的数值通量。关键在于，重力源项已从此更新方程中省略，而这正是产生伪速度的根源。\n\n**4. Roe 近似黎曼求解器**\n\n单元 $i$（左状态，$\\mathbf{U}_L$）和单元 $i+1$（右状态，$\\mathbf{U}_R$）之间界面处的数值通量 $\\mathbf{F}_{i+1/2}$ 使用 Roe 近似黎曼求解器计算：\n$$ \\mathbf{F}_{i+1/2} = \\frac{1}{2} \\left( \\mathbf{F}(\\mathbf{U}_L) + \\mathbf{F}(\\mathbf{U}_R) \\right) - \\frac{1}{2} \\sum_{k=1}^{3} |\\tilde{\\lambda}_k| \\tilde{\\alpha}_k \\tilde{\\mathbf{r}}_k $$\n其中 $\\mathbf{F}(\\mathbf{U}) = [\\rho u, \\rho u^2 + p, u(E + p)]^T$ 是物理通量向量。第二项表示数值耗散。\n\n为了计算耗散项，我们首先根据左右状态定义 Roe 平均量：\n- $\\tilde{\\rho} = \\sqrt{\\rho_L \\rho_R}$\n- $\\tilde{u} = \\frac{\\sqrt{\\rho_L} u_L + \\sqrt{\\rho_R} u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}$\n- 比焓：$h = (E+p)/\\rho$。Roe 平均比焓为 $\\tilde{h} = \\frac{\\sqrt{\\rho_L} h_L + \\sqrt{\\rho_R} h_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}$。\n- Roe 平均声速：$\\tilde{c} = \\sqrt{(\\gamma - 1)(\\tilde{h} - \\frac{1}{2}\\tilde{u}^2)}$。\n\n耗散项中的各项为：\n- Roe 矩阵的特征值：$\\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{c}$，$\\tilde{\\lambda}_2 = \\tilde{u}$，$\\tilde{\\lambda}_3 = \\tilde{u} + \\tilde{c}$。\n- Roe 矩阵的右特征向量：\n$$ \\tilde{\\mathbf{r}}_1 = \\begin{bmatrix} 1 \\\\ \\tilde{u}-\\tilde{c} \\\\ \\tilde{h}-\\tilde{u}\\tilde{c} \\end{bmatrix}, \\quad \\tilde{\\mathbf{r}}_2 = \\begin{bmatrix} 1 \\\\ \\tilde{u} \\\\ \\frac{1}{2}\\tilde{u}^2 \\end{bmatrix}, \\quad \\tilde{\\mathbf{r}}_3 = \\begin{bmatrix} 1 \\\\ \\tilde{u}+\\tilde{c} \\\\ \\tilde{h}+\\tilde{u}\\tilde{c} \\end{bmatrix} $$\n- 波强度 $\\tilde{\\alpha}_k$，它们是状态跳跃 $\\Delta \\mathbf{U} = \\mathbf{U}_R - \\mathbf{U}_L$ 在左特征向量上的投影。它们可以从原始变量的跳跃 $\\Delta\\rho = \\rho_R - \\rho_L$、$\\Delta u = u_R - u_L$ 和 $\\Delta p = p_R - p_L$ 计算得出：\n$$ \\tilde{\\alpha}_1 = \\frac{1}{2\\tilde{c}^2} (\\Delta p - \\tilde{\\rho}\\tilde{c}\\Delta u) $$\n$$ \\tilde{\\alpha}_2 = \\Delta \\rho - \\frac{\\Delta p}{\\tilde{c}^2} $$\n$$ \\tilde{\\alpha}_3 = \\frac{1}{2\\tilde{c}^2} (\\Delta p + \\tilde{\\rho}\\tilde{c}\\Delta u) $$\n\n该过程涉及计算所有界面 $i = 0, \\dots, N$ 的通量 $\\mathbf{F}_{i+1/2}$。\n\n**5. 伪速度的提取**\n\n单个时间步更新后，我们得到每个物理单元 $i=1, \\dots, N$ 的新状态向量 $\\mathbf{U}_i^{n+1}$。单元 $i$ 中的新密度和动量分别为 $\\rho_i^{n+1} = (\\mathbf{U}_i^{n+1})_1$ 和 $(\\rho u)_i^{n+1} = (\\mathbf{U}_i^{n+1})_2$。然后计算出新的速度：\n$$ u_i^{n+1} = \\frac{(\\rho u)_i^{n+1}}{\\rho_i^{n+1}} $$\n由于初始速度均匀为零，任何非零的 $u_i^{n+1}$ 都是由数值格式未能用（被省略的）重力源项平衡压力梯度而产生的伪速度。每种情况的最终结果是此伪速度在所有物理单元上的最大绝对值：\n$$ \\max_{i=1..N} |u_i^{n+1}| $$\n这个值量化了因缺乏良态平衡公式而在单步中引入的误差大小。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.005085  0.025340  0.025788  0.003598  0.001272 \\end{pmatrix}}\n$$"
        }
    ]
}