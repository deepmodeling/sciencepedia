{
    "hands_on_practices": [
        {
            "introduction": "In many methods for simulating incompressible flows, the velocity and pressure fields are coupled through a Poisson equation for the pressure. When applying periodic boundary conditions, a subtle but critical mathematical constraint emerges. This exercise guides you through the derivation of this solvability condition, demonstrating why the source term of the pressure Poisson equation must have a zero spatial average over the domain . Understanding this compatibility condition is fundamental to developing and using robust CFD solvers for periodic flows.",
            "id": "4000231",
            "problem": "In Computational Fluid Dynamics (CFD), consider the incompressible Navier–Stokes equations for a fluid of constant density on a triply periodic domain $\\Omega \\subset \\mathbb{R}^{3}$ with period lengths $L_{x}$, $L_{y}$, and $L_{z}$ in the $x$, $y$, and $z$ directions, respectively. Let the velocity field be $\\boldsymbol{u}(\\boldsymbol{x},t)$ and the pressure be $p(\\boldsymbol{x},t)$, and suppose all fields are spatially periodic with the same periods as the domain. In a projection or fractional-step method, a pressure Poisson equation of the form\n$$\n\\nabla^{2} p(\\boldsymbol{x},t) \\;=\\; f(\\boldsymbol{x},t)\n$$\nis obtained from the momentum and continuity equations to enforce incompressibility. The unknown $p$ is defined modulo an additive constant under periodic boundary conditions.\n\nUsing only the incompressibility constraint, the momentum equation, and the periodicity of the fields, derive the necessary and sufficient compatibility condition on the source term $f$ for this Poisson equation to be solvable under periodic boundary conditions.\n\nThen, to quantify the impact of a nonzero-mean source, consider the one-dimensional version on $\\Omega = [0,2\\pi]$ with periodic boundary conditions, and let the source be\n$$\nf(x) \\;=\\; a \\;+\\; b \\cos(x) \\;+\\; c \\cos^{2}(x),\n$$\nwhere $a$, $b$, and $c$ are constants. Determine the unique value of $a$ (expressed in closed form in terms of $b$ and $c$) that must be chosen to satisfy the compatibility condition you derived so that the periodic Poisson problem is solvable. Express your final answer as a single closed-form analytic expression with no units.",
            "solution": "The problem is presented in two parts. The first part requires the derivation of the compatibility condition for a Poisson equation on a triply periodic domain. The second part requires applying this condition to a specific one-dimensional case to find a parameter value.\n\nPart 1: Derivation of the Compatibility Condition\n\nWe are given the pressure Poisson equation on a triply periodic domain $\\Omega \\subset \\mathbb{R}^{3}$:\n$$\n\\nabla^{2} p(\\boldsymbol{x},t) = f(\\boldsymbol{x},t)\n$$\nThe domain has periods $L_{x}$, $L_{y}$, and $L_{z}$ in the $x$, $y$, and $z$ directions, respectively. The fields $p$ and $f$ are periodic with these same periods.\n\nTo derive the compatibility condition for the existence of a solution $p$, we integrate both sides of the equation over the entire domain $\\Omega$:\n$$\n\\int_{\\Omega} \\nabla^{2} p \\,dV = \\int_{\\Omega} f \\,dV\n$$\nHere, $dV$ is the infinitesimal volume element.\n\nThe left-hand side of this equation can be transformed using the divergence theorem, which states that for a vector field $\\boldsymbol{F}$, $\\int_{V} (\\boldsymbol{\\nabla} \\cdot \\boldsymbol{F}) \\,dV = \\oint_{\\partial V} \\boldsymbol{F} \\cdot \\boldsymbol{n} \\,dS$, where $\\partial V$ is the boundary of the volume $V$ and $\\boldsymbol{n}$ is the outward unit normal. We identify the Laplacian operator as the divergence of the gradient, $\\nabla^{2} p = \\boldsymbol{\\nabla} \\cdot (\\boldsymbol{\\nabla} p)$. Applying the divergence theorem with $\\boldsymbol{F} = \\boldsymbol{\\nabla} p$, we have:\n$$\n\\int_{\\Omega} \\nabla^{2} p \\,dV = \\int_{\\Omega} \\boldsymbol{\\nabla} \\cdot (\\boldsymbol{\\nabla} p) \\,dV = \\oint_{\\partial \\Omega} (\\boldsymbol{\\nabla} p) \\cdot \\boldsymbol{n} \\,dS\n$$\nThe boundary $\\partial \\Omega$ of the periodic box $\\Omega = [0, L_x] \\times [0, L_y] \\times [0, L_z]$ consists of three pairs of opposing faces (e.g., the face at $x=0$ and the face at $x=L_x$). Let's evaluate the surface integral over one such pair of faces, for instance, those perpendicular to the $x$-axis. The outward normal is $\\boldsymbol{n} = -\\boldsymbol{e}_x$ at $x=0$ and $\\boldsymbol{n} = \\boldsymbol{e}_x$ at $x=L_x$. The contribution from this pair of faces to the integral is:\n$$\n\\int_{0}^{L_z} \\int_{0}^{L_y} \\left[ (\\boldsymbol{\\nabla} p)|_{x=L_x} \\cdot \\boldsymbol{e}_x + (\\boldsymbol{\\nabla} p)|_{x=0} \\cdot (-\\boldsymbol{e}_x) \\right] dy \\,dz = \\int_{0}^{L_z} \\int_{0}^{L_y} \\left[ \\frac{\\partial p}{\\partial x}\\bigg|_{x=L_x, y, z} - \\frac{\\partial p}{\\partial x}\\bigg|_{x=0, y, z} \\right] dy \\,dz\n$$\nDue to the specified periodic boundary conditions, the pressure field $p$ and its derivatives must have the same value on opposing boundaries. Thus, for any $(y,z)$:\n$$\n\\frac{\\partial p}{\\partial x}(L_x, y, z) = \\frac{\\partial p}{\\partial x}(0, y, z)\n$$\nThis causes the integrand above to be zero everywhere, and consequently, the integral over this pair of faces is zero. The same reasoning applies to the pairs of faces in the $y$ and $z$ directions. Therefore, the entire surface integral vanishes:\n$$\n\\oint_{\\partial \\Omega} (\\boldsymbol{\\nabla} p) \\cdot \\boldsymbol{n} \\,dS = 0\n$$\nCombining our results, we have $\\int_{\\Omega} \\nabla^{2} p \\,dV = 0$. This leads directly to the compatibility condition on the source term $f$:\n$$\n\\int_{\\Omega} f(\\boldsymbol{x},t) \\,dV = 0\n$$\nThis is a necessary condition for a solution to exist. It is also a sufficient condition, a result from the Fredholm alternative. The operator $\\nabla^{2}$ with periodic boundary conditions is self-adjoint. Its null space is the set of constant functions. A solution to $\\nabla^{2}p = f$ exists if and only if $f$ is orthogonal to the null space of the adjoint operator. For the self-adjoint Laplacian, this means $f$ must be orthogonal to the constant functions, which is precisely the condition $\\int_{\\Omega} f \\cdot 1 \\,dV = 0$. This condition means that the spatial average of the source term over the domain must be zero.\n\nPart 2: Application to the One-Dimensional Case\n\nWe now consider the one-dimensional ($1$D) version of the problem on the domain $\\Omega = [0, 2\\pi]$ with periodic boundary conditions. The Poisson equation becomes:\n$$\n\\frac{d^{2}p}{dx^{2}} = f(x)\n$$\nThe source term is given as:\n$$\nf(x) = a + b \\cos(x) + c \\cos^{2}(x)\n$$\nwhere $a$, $b$, and $c$ are constants. The compatibility condition derived in Part $1$ reduces to:\n$$\n\\int_{0}^{2\\pi} f(x) \\,dx = 0\n$$\nWe substitute the expression for $f(x)$ and evaluate the integral:\n$$\n\\int_{0}^{2\\pi} \\left( a + b \\cos(x) + c \\cos^{2}(x) \\right) dx = 0\n$$\nWe can integrate term by term:\n$$\n\\int_{0}^{2\\pi} a \\,dx + \\int_{0}^{2\\pi} b \\cos(x) \\,dx + \\int_{0}^{2\\pi} c \\cos^{2}(x) \\,dx = 0\n$$\nThe first integral is:\n$$\n\\int_{0}^{2\\pi} a \\,dx = a[x]_{0}^{2\\pi} = 2\\pi a\n$$\nThe second integral is:\n$$\n\\int_{0}^{2\\pi} b \\cos(x) \\,dx = b[\\sin(x)]_{0}^{2\\pi} = b(\\sin(2\\pi) - \\sin(0)) = b(0-0) = 0\n$$\nFor the third integral, we use the trigonometric identity $\\cos^{2}(x) = \\frac{1}{2}(1 + \\cos(2x))$:\n$$\n\\int_{0}^{2\\pi} c \\cos^{2}(x) \\,dx = c \\int_{0}^{2\\pi} \\frac{1 + \\cos(2x)}{2} \\,dx = \\frac{c}{2} \\left[ x + \\frac{1}{2}\\sin(2x) \\right]_{0}^{2\\pi}\n$$\n$$\n= \\frac{c}{2} \\left[ \\left(2\\pi + \\frac{1}{2}\\sin(4\\pi)\\right) - \\left(0 + \\frac{1}{2}\\sin(0)\\right) \\right] = \\frac{c}{2} [ (2\\pi + 0) - (0 + 0) ] = c\\pi\n$$\nSubstituting these results back into the compatibility condition equation:\n$$\n2\\pi a + 0 + c\\pi = 0\n$$\nNow, we solve for $a$:\n$$\n2\\pi a = -c\\pi\n$$\n$$\na = -\\frac{c\\pi}{2\\pi} = -\\frac{c}{2}\n$$\nThus, for the periodic Poisson problem to be solvable, the constant $a$ must be equal to $-\\frac{c}{2}$. This choice ensures that the average value of the source term $f(x)$ over the period $[0, 2\\pi]$ is zero. The value of $b$ does not affect the compatibility condition because the average value of $\\cos(x)$ over a full period is zero.",
            "answer": "$$\\boxed{-\\frac{c}{2}}$$"
        },
        {
            "introduction": "Exploiting symmetry is a powerful technique in CFD for reducing computational costs, but it requires careful implementation of boundary conditions at the symmetry plane. This practice shifts our focus from periodic to reflectional symmetry, a common scenario in aerospace applications like airfoils or fuselages. By analyzing the behavior of vector and scalar quantities under reflection, you will derive the appropriate boundary conditions for mean velocity, pressure, and turbulence model variables, ensuring the numerical model correctly represents the physical symmetry of the flow .",
            "id": "4000247",
            "problem": "Consider an incompressible, statistically steady flow governed by the Reynolds-Averaged Navier–Stokes (RANS) equations within a three-dimensional domain that is mirror-symmetric with respect to the plane $y=0$. Let $\\mathbf{x} = (x,y,z)$ and define the reflection map $\\mathcal{R}:(x,y,z)\\mapsto(x,-y,z)$. The mean velocity field is $\\mathbf{U}(\\mathbf{x}) = (u(\\mathbf{x}), v(\\mathbf{x}), w(\\mathbf{x}))$, the mean pressure is $p(\\mathbf{x})$, and the turbulent kinetic energy and dissipation rate in the standard $k$–$\\epsilon$ model are $k(\\mathbf{x})$ and $\\epsilon(\\mathbf{x})$, respectively. The turbulent kinetic energy and dissipation rate are defined as $k = \\tfrac{1}{2}\\,\\overline{u_{i}'u_{i}'}$ and $\\epsilon = \\nu\\,\\overline{\\partial u_{i}'/\\partial x_{j}\\,\\partial u_{i}'/\\partial x_{j}}$, where $\\nu$ is the kinematic viscosity, an overbar denotes Reynolds averaging, primes denote fluctuations, and indices follow the Einstein summation convention. The eddy viscosity closure takes the widely used form $\\nu_{t} = C_{\\mu}\\,k^{2}/\\epsilon$ with constant $C_{\\mu} > 0$. Let the mean strain-rate tensor be $S_{ij} = \\tfrac{1}{2}\\left(\\partial U_{i}/\\partial x_{j} + \\partial U_{j}/\\partial x_{i}\\right)$, and consider the turbulence production term $P_{k}$ entering the $k$ transport equation via the contraction of the turbulent stresses with mean gradients, which in eddy-viscosity closures is proportional to $S_{ij}S_{ij}$, namely $P_{k} = 2\\,\\nu_{t}\\,S_{ij}S_{ij}$.\n\nAssume the flow, the geometry, and the boundary and forcing configurations are such that the full RANS-$k$–$\\epsilon$ system is invariant under the reflection $\\mathcal{R}$, and that the mean fields satisfy reflection symmetry at $y=0$ in the sense that scalars are even and the vector components transform according to their geometric parity under $\\mathcal{R}$. Using only the fundamental laws and core definitions stated above, and enforcing the invariance of the governing equations under $\\mathcal{R}$, derive the minimal set of symmetry-consistent boundary conditions at the plane $y=0$ for the variables $\\mathbf{U}$, $p$, $k$, and $\\epsilon$ that maintain reflection symmetry and eliminate artificial turbulence production associated with normal-tangential coupling at the symmetry plane.\n\nYour derivation must:\n- Identify the parity (even/odd under $y\\mapsto -y$) of each field component required by reflection invariance.\n- Use these parities to deduce the corresponding boundary conditions at $y=0$ in terms of the values or normal derivatives of the fields.\n- Demonstrate that, with these boundary conditions, all mixed normal–tangential mean strain components at $y=0$ vanish, so that the local symmetry does not spuriously contribute to $P_{k}$ through normal–tangential coupling.\n\nExpress your final answer as the ordered vector\n$$\\left[v|_{y=0}\\,,\\,\\frac{\\partial u}{\\partial y}\\bigg|_{y=0}\\,,\\,\\frac{\\partial w}{\\partial y}\\bigg|_{y=0}\\,,\\,\\frac{\\partial p}{\\partial y}\\bigg|_{y=0}\\,,\\,\\frac{\\partial k}{\\partial y}\\bigg|_{y=0}\\,,\\,\\frac{\\partial \\epsilon}{\\partial y}\\bigg|_{y=0}\\right],$$\nwith the normal derivative understood as $\\partial/\\partial y$ at the plane $y=0$. There is no rounding requirement. No physical units should be included in the final answer.",
            "solution": "The problem is first validated against the required criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Domain:** A three-dimensional domain, mirror-symmetric with respect to the plane $y=0$.\n- **Reflection Map:** $\\mathcal{R}:(x,y,z)\\mapsto(x,-y,z)$.\n- **Governing Equations:** Incompressible, statistically steady Reynolds-Averaged Navier–Stokes (RANS) equations.\n- **Variables:** Mean velocity $\\mathbf{U}(\\mathbf{x}) = (u(\\mathbf{x}), v(\\mathbf{x}), w(\\mathbf{x}))$, mean pressure $p(\\mathbf{x})$, turbulent kinetic energy $k(\\mathbf{x})$, and dissipation rate $\\epsilon(\\mathbf{x})$.\n- **Definitions:**\n    - Turbulent kinetic energy: $k = \\tfrac{1}{2}\\,\\overline{u_{i}'u_{i}'}$.\n    - Turbulent dissipation rate: $\\epsilon = \\nu\\,\\overline{\\partial u_{i}'/\\partial x_{j}\\,\\partial u_{i}'/\\partial x_{j}}$.\n    - Eddy viscosity: $\\nu_{t} = C_{\\mu}\\,k^{2}/\\epsilon$ with constant $C_{\\mu} > 0$.\n    - Mean strain-rate tensor: $S_{ij} = \\tfrac{1}{2}\\left(\\partial U_{i}/\\partial x_{j} + \\partial U_{j}/\\partial x_{i}\\right)$.\n    - Turbulence production: $P_{k} = 2\\,\\nu_{t}\\,S_{ij}S_{ij}$.\n- **Assumptions:**\n    - The RANS-$k$–$\\epsilon$ system is invariant under the reflection $\\mathcal{R}$.\n    - The mean fields satisfy reflection symmetry at $y=0$: scalars are even, and vector components transform according to their geometric parity under $\\mathcal{R}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is firmly rooted in the standard theory of turbulence modeling (RANS, $k$–$\\epsilon$ model) and the application of symmetry principles in fluid dynamics, a core topic in computational fluid dynamics (CFD). The definitions and concepts are standard and factually correct.\n- **Well-Posed:** The problem is well-posed. It asks for the derivation of a specific set of boundary conditions based on clearly stated symmetry assumptions. The existence of a unique, meaningful solution is expected.\n- **Objective:** The problem is stated in precise, objective, and technical language, free from ambiguity or subjective claims.\n\nThe problem does not exhibit any of the flaws listed in the validation checklist (e.g., scientific unsoundness, incompleteness, contradiction, etc.). It is a valid, formalizable problem in the specified field.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full, reasoned solution will be provided.\n\n### Solution Derivation\n\nThe derivation proceeds by first establishing the parity of each field variable based on the specified reflection symmetry, and then deducing the corresponding boundary conditions at the symmetry plane $y=0$. Finally, it is demonstrated that these conditions eliminate spurious turbulence production from normal-tangential strain coupling.\n\n**1. Parity of Field Variables**\n\nThe problem states that the flow is mirror-symmetric with respect to the plane $y=0$, with the reflection map $\\mathcal{R}:(x,y,z)\\mapsto(x,-y,z)$. It is assumed that scalars are even under this reflection, and vector components transform according to their geometric parity.\n\nLet $\\phi(\\mathbf{x})=\\phi(x,y,z)$ be a generic field.\n- A scalar field $\\phi_{scalar}$ is **even** if it is invariant under reflection: $\\phi_{scalar}(x,-y,z) = \\phi_{scalar}(x,y,z)$.\n- A vector field $\\mathbf{U}=(u,v,w)$ transforms with geometric parity. The reflection $\\mathcal{R}$ negates the $y$ coordinate while leaving $x$ and $z$ unchanged. Thus, the vector component normal to the plane of symmetry ($v$) must be odd, while the tangential components ($u, w$) must be even.\n\nApplying these rules to the variables of interest:\n- The mean pressure $p(\\mathbf{x})$, turbulent kinetic energy $k(\\mathbf{x})$, and dissipation rate $\\epsilon(\\mathbf{x})$ are scalar quantities. Therefore, they are even functions with respect to $y$:\n  $$p(x,-y,z) = p(x,y,z)$$\n  $$k(x,-y,z) = k(x,y,z)$$\n  $$\\epsilon(x,-y,z) = \\epsilon(x,y,z)$$\n- The mean velocity components have the following parities:\n  - $u(x,y,z)$ (tangential) is **even**: $u(x,-y,z) = u(x,y,z)$.\n  - $v(x,y,z)$ (normal) is **odd**: $v(x,-y,z) = -v(x,y,z)$.\n  - $w(x,y,z)$ (tangential) is **even**: $w(x,-y,z) = w(x,y,z)$.\n\n**2. Derivation of Boundary Conditions at $y=0$**\n\nBoundary conditions at the plane $y=0$ are derived from the parity properties.\n\n- For any function $\\phi_{odd}(y)$ that is odd in $y$, we have $\\phi_{odd}(-y) = -\\phi_{odd}(y)$. Evaluating at $y=0$ gives $\\phi_{odd}(0) = -\\phi_{odd}(0)$, which implies $2\\phi_{odd}(0)=0$, so $\\phi_{odd}(0)=0$.\n- For any continuously differentiable function $\\phi_{even}(y)$ that is even in $y$, we have $\\phi_{even}(-y) = \\phi_{even}(y)$. Differentiating with respect to $y$ using the chain rule gives $-\\phi_{even}'(-y) = \\phi_{even}'(y)$. This shows that the derivative $\\phi_{even}'(y)$ is an odd function. Evaluating at $y=0$ yields $-\\phi_{even}'(0) = \\phi_{even}'(0)$, which implies $2\\phi_{even}'(0)=0$, so $\\phi_{even}'(0)=0$.\n\nApplying these mathematical facts to our fields at the symmetry plane $y=0$:\n\n- **$v$ component:** $v$ is an odd function of $y$. Therefore, its value at $y=0$ must be zero.\n  $$v|_{y=0} = 0$$\n- **$u$ component:** $u$ is an even function of $y$. Therefore, its partial derivative with respect to $y$ (the normal derivative) must be an odd function of $y$, and thus zero at $y=0$.\n  $$\\frac{\\partial u}{\\partial y}\\bigg|_{y=0} = 0$$\n- **$w$ component:** $w$ is an even function of $y$. Similar to $u$, its normal derivative must be zero at $y=0$.\n  $$\\frac{\\partial w}{\\partial y}\\bigg|_{y=0} = 0$$\n- **Pressure $p$:** $p$ is a scalar and an even function of $y$. Therefore, its normal derivative must be zero at $y=0$.\n  $$\\frac{\\partial p}{\\partial y}\\bigg|_{y=0} = 0$$\n- **Turbulent kinetic energy $k$:** $k$ is a scalar and an even function of $y$. Its normal derivative must be zero at $y=0$.\n  $$\\frac{\\partial k}{\\partial y}\\bigg|_{y=0} = 0$$\n- **Dissipation rate $\\epsilon$:** $\\epsilon$ is a scalar and an even function of $y$. Its normal derivative must be zero at $y=0$.\n  $$\\frac{\\partial \\epsilon}{\\partial y}\\bigg|_{y=0} = 0$$\n\n**3. Elimination of Artificial Turbulence Production**\n\nThe production of turbulent kinetic energy, $P_k$, is given by $P_k = 2\\,\\nu_{t}\\,S_{ij}S_{ij}$, where $S_{ij}$ is the mean strain-rate tensor. We must show that the boundary conditions derived above eliminate spurious production arising from the coupling of normal ($y$-direction, index $2$) and tangential ($x,z$-directions, indices $1,3$) velocity gradients. The relevant components of the strain-rate tensor are the mixed normal-tangential terms $S_{12}$ (also $S_{xy}$) and $S_{23}$ (also $S_{yz}$).\n\nThe components are defined as:\n$$S_{12} = \\frac{1}{2}\\left(\\frac{\\partial U_1}{\\partial x_2} + \\frac{\\partial U_2}{\\partial x_1}\\right) = \\frac{1}{2}\\left(\\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\\right)$$\n$$S_{23} = \\frac{1}{2}\\left(\\frac{\\partial U_2}{\\partial x_3} + \\frac{\\partial U_3}{\\partial x_2}\\right) = \\frac{1}{2}\\left(\\frac{\\partial v}{\\partial z} + \\frac{\\partial w}{\\partial y}\\right)$$\n\nWe evaluate these components at the symmetry plane $y=0$:\nFrom the boundary conditions derived in the previous section, we have:\n$$\\frac{\\partial u}{\\partial y}\\bigg|_{y=0} = 0 \\quad \\text{and} \\quad \\frac{\\partial w}{\\partial y}\\bigg|_{y=0} = 0$$\n\nNow we must evaluate the tangential derivatives of $v$ at $y=0$. Since $v(x,y,z)$ is an odd function of $y$, we have $v(x,y,z) = -v(x,-y,z)$. Taking the partial derivative with respect to a tangential coordinate, such as $x$, yields:\n$$\\frac{\\partial v}{\\partial x}(x,y,z) = \\frac{\\partial}{\\partial x}[-v(x,-y,z)] = -\\frac{\\partial v}{\\partial x}(x,-y,z)$$\nThis shows that $\\frac{\\partial v}{\\partial x}$ is also an odd function of $y$. As established, any odd function of $y$ must be zero at $y=0$. Therefore:\n$$\\frac{\\partial v}{\\partial x}\\bigg|_{y=0} = 0$$\nBy identical reasoning for the $z$-derivative:\n$$\\frac{\\partial v}{\\partial z}\\bigg|_{y=0} = 0$$\n\nSubstituting these results into the expressions for $S_{12}$ and $S_{23}$ at $y=0$:\n$$S_{12}\\bigg|_{y=0} = \\frac{1}{2}\\left(0 + 0\\right) = 0$$\n$$S_{23}\\bigg|_{y=0} = \\frac{1}{2}\\left(0 + 0\\right) = 0$$\n\nSince the mixed normal-tangential components of the mean strain-rate tensor are identically zero at the symmetry plane, their contribution to the production term $P_k$ (which is proportional to $S_{12}^2$ and $S_{23}^2$) is also zero. This confirms that the derived symmetry boundary conditions correctly prevent the generation of artificial turbulence at the symmetry plane due to normal-tangential strain coupling.\n\nThe minimal set of symmetry-consistent boundary conditions is thus given by the values derived above. The final answer is the ordered vector of these values.\n- $v|_{y=0} = 0$\n- $\\frac{\\partial u}{\\partial y}\\big|_{y=0} = 0$\n- $\\frac{\\partial w}{\\partial y}\\big|_{y=0} = 0$\n- $\\frac{\\partial p}{\\partial y}\\big|_{y=0} = 0$\n- $\\frac{\\partial k}{\\partial y}\\big|_{y=0} = 0$\n- $\\frac{\\partial \\epsilon}{\\partial y}\\big|_{y=0} = 0$",
            "answer": "$$\n\\boxed{\n\\begin{bmatrix}\n0 & 0 & 0 & 0 & 0 & 0\n\\end{bmatrix}\n}\n$$"
        },
        {
            "introduction": "The theoretical elegance of periodic boundary conditions must be translated into accurate numerical algorithms at the discrete level. When a finite difference stencil extends across a periodic boundary, it must \"wrap around\" the domain, a process that can potentially degrade numerical accuracy. This exercise provides a hands-on analysis of a central difference scheme at a periodic interface, using Taylor series to rigorously prove that the scheme maintains its designed order of accuracy, a crucial aspect of high-fidelity simulations .",
            "id": "4000273",
            "problem": "Consider a one-dimensional, streamwise-periodic domain used in Computational Fluid Dynamics (CFD), $x \\in [0, L]$, with periodic boundary conditions $q(x+L) = q(x)$ for any sufficiently smooth scalar field $q(x)$. The domain is discretized with a uniform grid of $N$ cell centers located at $x_i = i h$ for $i \\in \\{0,1,\\dots,N-1\\}$, where $h = L/N$. At the periodic boundary, indices wrap modulo $N$, so $q_{N} \\equiv q_{0}$ and $q_{-1} \\equiv q_{N-1}$. The discrete gradient at cell $i$ is approximated by the second-order central difference stencil,\n$$\nD_h q\\big|_{i} = \\frac{q_{i+1} - q_{i-1}}{2 h},\n$$\nwith the understanding that the stencil wraps periodically near the boundary (for example, at $i=0$ one uses $q_1$ and $q_{N-1}$).\n\nStarting from the definition of the derivative and Taylor-series expansions of $q(x)$ about $x=0$, derive the leading-order truncation error term of the central difference approximation $D_h q\\big|_0$ for a general smooth $q(x)$ on this uniform periodic grid. Then, consider the Fourier mode\n$$\nq(x) = \\sin(\\alpha x),\n$$\nwith the periodicity condition $\\alpha L = 2 \\pi p$ for some integer $p$, ensuring $q(x+L) = q(x)$. Using index wrapping at the boundary, evaluate the discrete gradient $D_h q\\big|_0$ for this $q(x)$ in terms of $\\alpha$ and $h$, and use a Taylor-series expansion to express the leading-order truncation error at $x=0$ as an explicit analytic expression in $\\alpha$ and $h$.\n\nYour final answer must be a row matrix containing two entries: the discrete gradient approximation $D_h q\\big|_{0}$ and the leading-order truncation error $D_h q\\big|_{0} - q'(0)$, both expressed in terms of $\\alpha$ and $h$. No numerical evaluation is required. No units are required. Express your final answer exactly; do not round.",
            "solution": "We begin with the definition of the derivative and Taylor-series expansions for a general smooth function $q(x)$ about $x=0$. On a uniform grid with spacing $h$, the function values at neighboring points can be expanded as\n$$\nq(h) = q(0) + h q'(0) + \\frac{h^{2}}{2} q''(0) + \\frac{h^{3}}{6} q^{(3)}(0) + \\frac{h^{4}}{24} q^{(4)}(0) + \\mathcal{O}(h^{5}),\n$$\n$$\nq(-h) = q(0) - h q'(0) + \\frac{h^{2}}{2} q''(0) - \\frac{h^{3}}{6} q^{(3)}(0) + \\frac{h^{4}}{24} q^{(4)}(0) + \\mathcal{O}(h^{5}).\n$$\nIn the periodic setting, at the boundary-adjacent cell $i=0$, index wrapping gives $q_{1} = q(h)$ and $q_{N-1} = q(L - h)$. By periodicity, $q(L - h) = q(-h)$ because $q(x+L) = q(x)$ implies $q(L - h) = q(-h + L) = q(-h)$. Therefore, the second-order central difference approximation at $i=0$ is\n$$\nD_h q\\big|_{0} = \\frac{q_{1} - q_{N-1}}{2 h} = \\frac{q(h) - q(-h)}{2 h}.\n$$\nUsing the Taylor expansions,\n\\begin{align*}\nq(h) - q(-h) &= \\left[q(0) + h q'(0) + \\frac{h^{2}}{2} q''(0) + \\frac{h^{3}}{6} q^{(3)}(0) + \\frac{h^{4}}{24} q^{(4)}(0) + \\mathcal{O}(h^{5})\\right] \\\\\n&\\quad - \\left[q(0) - h q'(0) + \\frac{h^{2}}{2} q''(0) - \\frac{h^{3}}{6} q^{(3)}(0) + \\frac{h^{4}}{24} q^{(4)}(0) + \\mathcal{O}(h^{5})\\right] \\\\\n&= 2 h q'(0) + \\frac{h^{3}}{3} q^{(3)}(0) + \\mathcal{O}(h^{5}),\n\\end{align*}\nand so\n$$\nD_h q\\big|_{0} = \\frac{q(h) - q(-h)}{2 h} = q'(0) + \\frac{h^{2}}{6} q^{(3)}(0) + \\mathcal{O}(h^{4}).\n$$\nHence, the leading-order truncation error at $x=0$ is\n$$\nE_{\\text{LO}} = D_h q\\big|_{0} - q'(0) = \\frac{h^{2}}{6} q^{(3)}(0),\n$$\nwhich is second order in $h$ and demonstrates consistency, including at boundary-adjacent cells, by virtue of periodic wrapping.\n\nNext, consider the specific Fourier mode\n$$\nq(x) = \\sin(\\alpha x),\n$$\nwith $\\alpha L = 2 \\pi p$ for $p \\in \\mathbb{Z}$. The discrete values needed at $i=0$ are $q_{1} = q(h) = \\sin(\\alpha h)$ and $q_{N-1} = q(L - h)$. Using periodicity and trigonometric identities,\n\\begin{align*}\nq(L - h) &= \\sin(\\alpha (L - h)) = \\sin(\\alpha L - \\alpha h) \\\\\n&= \\sin(\\alpha L) \\cos(\\alpha h) - \\cos(\\alpha L) \\sin(\\alpha h).\n\\end{align*}\nSince $\\alpha L = 2 \\pi p$, we have $\\sin(\\alpha L) = 0$ and $\\cos(\\alpha L) = 1$, leading to\n$$\nq(L - h) = - \\sin(\\alpha h).\n$$\nTherefore, the wrapped central difference at $i=0$ is\n$$\nD_h q\\big|_{0} = \\frac{q_{1} - q_{N-1}}{2 h} = \\frac{\\sin(\\alpha h) - \\left[- \\sin(\\alpha h)\\right]}{2 h} = \\frac{\\sin(\\alpha h)}{h}.\n$$\nThe exact gradient at $x=0$ is\n$$\nq'(x) = \\alpha \\cos(\\alpha x) \\quad \\Rightarrow \\quad q'(0) = \\alpha.\n$$\nThus, the truncation error at $x=0$ is\n$$\nD_h q\\big|_{0} - q'(0) = \\frac{\\sin(\\alpha h)}{h} - \\alpha.\n$$\nTo extract the leading-order term, expand $\\sin(\\alpha h)$ for small $h$,\n$$\n\\sin(\\alpha h) = \\alpha h - \\frac{(\\alpha h)^{3}}{6} + \\frac{(\\alpha h)^{5}}{120} + \\mathcal{O}(h^{7}).\n$$\nDividing by $h$,\n$$\n\\frac{\\sin(\\alpha h)}{h} = \\alpha - \\frac{\\alpha^{3} h^{2}}{6} + \\frac{\\alpha^{5} h^{4}}{120} + \\mathcal{O}(h^{6}),\n$$\nso\n$$\nD_h q\\big|_{0} - q'(0) = - \\frac{\\alpha^{3} h^{2}}{6} + \\mathcal{O}(h^{4}).\n$$\nThis matches the general result $E_{\\text{LO}} = \\frac{h^{2}}{6} q^{(3)}(0)$ since $q^{(3)}(x) = - \\alpha^{3} \\cos(\\alpha x)$ and therefore $q^{(3)}(0) = - \\alpha^{3}$, yielding\n$$\nE_{\\text{LO}} = \\frac{h^{2}}{6} \\left(- \\alpha^{3}\\right) = - \\frac{\\alpha^{3} h^{2}}{6}.\n$$\nConsequently, the wrapped second-order central difference is consistent and second-order accurate at boundary-adjacent cells in a periodic domain, with discrete gradient symbol $\\sin(\\alpha h)/h$ and leading truncation error $- \\alpha^{3} h^{2}/6$ at $x=0$ for the chosen Fourier mode.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\sin(\\alpha h)}{h} & -\\frac{\\alpha^{3} h^{2}}{6}\\end{pmatrix}}$$"
        }
    ]
}