{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导您完成任何DSMC模拟的第一个基本步骤：建立真实气体分子与计算“模拟粒子”之间的联系。在DSMC中，由于模拟真实气体中海量的分子是不切实际的，我们使用数量少得多的模拟粒子，每个粒子代表一大群真实分子。这个练习的核心是计算“粒子权重”$W$ ，它量化了这种代表关系，并确保了宏观属性（如数密度）在模拟中得以精确保持。",
            "id": "3309131",
            "problem": "一个边长为 $L=1\\,\\mathrm{mm}$ 的立方体区域充满了均匀数密度为 $n=10^{20}\\,\\mathrm{m^{-3}}$ 的稀薄气体。该气体采用直接模拟蒙特卡洛（DSMC, Direct Simulation Monte Carlo）方法进行模拟，使用了 $N_{\\mathrm{sim}}=10^{6}$ 个模拟粒子，并采用均匀权重方案，即每个模拟粒子代表相同数量的物理分子。仅从数密度（单位体积内的物理数量）的定义以及DSMC表示前提（物理总数等于所有模拟粒子权重之和）出发，推导模拟粒子权重 $W$ 关于 $n$、$L$ 和 $N_{\\mathrm{sim}}$ 的表达式，并计算其数值。然后，对于一个覆盖该区域的、由 $100^{3}$ 个等尺寸单元格组成的均匀笛卡尔网格，在所述的均匀性假设下，估计每个单元格中模拟粒子的期望平均数，并计算其数值。将您的最终答案表示为一个行矩阵，其中首先包含 $W$ 的值，然后是每个单元格中模拟粒子的平均数。请提供精确值，不要四舍五入，最终答案中不包含单位。",
            "solution": "用户希望解决一个与直接模拟蒙特卡洛（DSMC）方法相关的问题。我将验证问题陈述，如果有效，将提供一个合理的解决方案。\n\n### 第1步：提取已知条件\n-   区域几何形状：立方体\n-   区域边长：$L=1\\,\\mathrm{mm}$\n-   气体数密度：$n=10^{20}\\,\\mathrm{m^{-3}}$（均匀）\n-   模拟粒子数：$N_{\\mathrm{sim}}=10^{6}$\n-   权重方案：均匀，粒子权重为 $W$\n-   DSMC前提：物理分子总数 = 模拟粒子权重之和\n-   计算网格：由 $100^{3}$ 个单元格组成的均匀笛卡尔网格\n-   目标1：推导 $W$ 的表达式并计算其数值。\n-   目标2：估计每个单元格中模拟粒子的期望平均数并计算其数值。\n-   最终答案格式：一个包含 $W$ 和每个单元格中模拟粒子平均数数值的行矩阵。\n\n### 第2步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n-   **科学依据**：该问题基于直接模拟蒙特卡洛方法的基本原理，这是一种用于稀薄气体流动的计算流体力学标准技术。数密度、模拟粒子和粒子权重的概念是DSMC的核心。所提供的数值对于微尺度稀薄气体模拟是物理上合理的。\n-   **适定性**：问题陈述清晰，提供了推导所求量所需的所有信息。目标明确，可以确定唯一解。\n-   **客观性**：语言精确且定量，没有主观或含糊的术语。\n-   **不完整性/矛盾**：问题是自洽的。所提供的数据充分且不矛盾。$L$ 的单位（毫米）与 $n$ 的单位（立方米分之一）之间的不匹配是一个标准的单位转换任务，而非缺陷。\n-   **不切实际/不可行**：条件是科学上合理的。$10^{20}\\,\\mathrm{m^{-3}}$ 的数密度在标准温度下约对应 $0.4\\,\\mathrm{Pa}$ 的压力，这是一种高真空条件，DSMC方法正适用于此。\n\n### 第3步：结论与行动\n问题有效。将提供完整的解决方案。\n\n### 求解推导\n问题要求推导和计算两个量：模拟粒子权重 $W$ 和每个单元格中模拟粒子的期望平均数。\n\n**第1部分：模拟粒子权重 $W$**\n\n求解从数密度 $n$ 的定义开始。在给定体积 $V$ 内，物理气体分子的总数 $N_{\\mathrm{phys}}$ 定义为：\n$$N_{\\mathrm{phys}} = n V$$\n模拟区域是一个边长为 $L$ 的立方体。其体积 $V$ 为：\n$$V = L^3$$\n因此，该区域内物理分子的总数为：\n$$N_{\\mathrm{phys}} = n L^3$$\n在计算数值之前，我们必须确保单位一致。边长给出为 $L=1\\,\\mathrm{mm}$，必须将其转换为米以匹配数密度 $n$ 的单位。\n$$L = 1\\,\\mathrm{mm} = 10^{-3}\\,\\mathrm{m}$$\n现在，我们可以用国际单位制计算体积：\n$$V = (10^{-3}\\,\\mathrm{m})^3 = 10^{-9}\\,\\mathrm{m}^3$$\n使用给定的数密度 $n=10^{20}\\,\\mathrm{m^{-3}}$，物理分子的总数为：\n$$N_{\\mathrm{phys}} = (10^{20}\\,\\mathrm{m^{-3}}) \\times (10^{-9}\\,\\mathrm{m}^3) = 10^{11}$$\n问题陈述，物理分子的总数也由所有模拟粒子的权重之和表示。由于权重方案是均匀的， $N_{\\mathrm{sim}}$ 个模拟粒子中的每一个都具有相同的权重 $W$。因此，物理分子的总数也可以表示为：\n$$N_{\\mathrm{phys}} = W \\times N_{\\mathrm{sim}}$$\n通过令 $N_{\\mathrm{phys}}$ 的两个表达式相等，我们可以推导出权重 $W$ 的表达式：\n$$W N_{\\mathrm{sim}} = n L^3$$\n求解 $W$ 得到所需的符号表达式：\n$$W = \\frac{n L^3}{N_{\\mathrm{sim}}}$$\n现在，我们代入给定的数值来计算 $W$。我们有 $n=10^{20}\\,\\mathrm{m^{-3}}$，$L=10^{-3}\\,\\mathrm{m}$ 和 $N_{\\mathrm{sim}}=10^{6}$。\n$$W = \\frac{10^{20} \\times (10^{-3})^3}{10^{6}} = \\frac{10^{20} \\times 10^{-9}}{10^{6}} = \\frac{10^{11}}{10^{6}} = 10^{5}$$\n权重 $W=10^{5}$ 是一个无量纲量，表示单个模拟粒子所代表的真实气体分子的数量。\n\n**第2部分：每个单元格中模拟粒子的平均数**\n\n问题要求计算每个单元格中模拟粒子的期望平均数。设此量为 $\\langle N_{p/c} \\rangle$。\n模拟区域被划分为一个由 $N_{\\mathrm{cells}}$ 个单元格组成的均匀笛卡尔网格。单元格总数给出为：\n$$N_{\\mathrm{cells}} = 100^{3} = (10^2)^3 = 10^6$$\n问题陈述，气体具有均匀的数密度，并使用均匀权重方案进行模拟。这意味着模拟粒子的分布在整个区域内平均而言是空间均匀的。\n因此，每个单元格中模拟粒子的期望平均数就是模拟粒子的总数 $N_{\\mathrm{sim}}$ 除以单元格的总数 $N_{\\mathrm{cells}}$。\n$$\\langle N_{p/c} \\rangle = \\frac{N_{\\mathrm{sim}}}{N_{\\mathrm{cells}}}$$\n我们已知 $N_{\\mathrm{sim}} = 10^{6}$ 并且我们已经计算出 $N_{\\mathrm{cells}} = 10^{6}$。代入这些值：\n$$\\langle N_{p/c} \\rangle = \\frac{10^{6}}{10^{6}} = 1$$\n每个单元格中模拟粒子的期望平均数为 $1$。\n\n最终答案要求一个行矩阵，其中包含 $W$ 的数值，后跟 $\\langle N_{p/c} \\rangle$ 的数值。\n第一个值是 $W = 10^5$。\n第二个值是 $\\langle N_{p/c} \\rangle = 1$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 10^{5}  1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在建立了粒子表示之后，下一步是模拟气体如何与边界相互作用，这是任何流动模拟的关键部分。本练习探讨了气体分子与壁面碰撞时发生的动量和能量交换，这是产生剪切应力和热通量等宏观现象的微观基础。通过推导和应用经典的Maxwell反射模型 ，您将深入理解如何将气体动力学理论转化为可在DSMC代码中实施的蒙特卡洛边界条件。",
            "id": "3977091",
            "problem": "一个位于 $y=0$ 的平面静止壁面，界定着占据 $y>0$ 空间的稀薄单原子气体。该气体在计算流体力学（CFD; Computational Fluid Dynamics）框架下，采用直接模拟蒙特卡洛（DSMC; Direct Simulation Monte Carlo）方法进行建模。远离壁面处，气体状态在空间上是均匀的，其数密度为 $n$，温度为 $T_{g}$，并具有沿切向 $x$ 方向的整体漂移速度 $U$。分子质量为 $m$。壁面温度为 $T_{w}$，并施加调节系数为 $\\alpha \\in [0,1]$ 的麦克斯韦反射边界条件：入射分子有 $\\alpha$ 的概率发生漫反射至壁面状态，有 $1-\\alpha$ 的概率发生镜面反射。\n\n从分子通量和麦克斯韦速度分布的动力学理论定义出发，完成以下任务：\n\n1. 推导离开壁面的漫反射分子的速度 $\\mathbf{v}'=(v'_{x},v'_{y},v'_{z})$ 的归一化概率密度 $p_{\\mathrm{diff}}(\\mathbf{v}')$，其适用范围限于 $v'_{y}>0$，并适用于 DSMC 中的抽样。假设壁面没有切向漂移。\n\n2. 对于在面积 $A$ 和时间间隔 $\\Delta t$ 内的一次实现，定义切向壁面动量交换率（沿 $x$ 方向的剪切应力）的蒙特卡洛估计量 $\\widehat{\\tau}_{x}$。该估计量使用在 $(A,\\Delta t)$ 内撞击壁面的入射分子集合及其通过调节系数为 $\\alpha$ 的麦克斯韦边界条件生成的反射速度。在所述模型假设下，你的估计量应是无偏的。\n\n3. 在给定的均匀气体状态（温度为 $T_{g}$、具有切向漂移 $U$ 的麦克斯韦分布）下，解析地计算你的估计量的期望值，并将其表示为 $n$、$m$、$k_{B}$、$T_{g}$、$U$ 和 $\\alpha$ 的闭式函数。\n\n将最终的期望剪切应力以牛顿/平方米为单位表示。无需四舍五入。",
            "solution": "该问题是有效的，因为它在科学上基于气体动力学理论，内容自洽，且提法明确。我们按问题的三个部分进行解答。\n\n### 第 1 部分：漫反射的概率密度\n\n从温度为 $T_w$ 且无切向漂移的壁面发生的漫反射意味着，反射分子被发射出的速度，是从对应于温度为 $T_w$ 的热平衡气体的半空间麦克斯韦分布中抽样得到的。这种气体的速度分布函数由下式给出\n$$\nf_{\\mathrm{eq}}(\\mathbf{v}') \\propto \\exp\\left(-\\frac{m|\\mathbf{v}'|^2}{2k_B T_w}\\right) = \\exp\\left(-\\frac{m(v_x'^2 + v_y'^2 + v_z'^2)}{2k_B T_w}\\right)\n$$\n其中 $\\mathbf{v}' = (v'_x, v'_y, v'_z)$ 是反射分子的速度， $m$ 是分子质量。\n\n具有给定速度 $\\mathbf{v}'$ 的分子从壁面发射的概率，不仅与具有该速度的分子数量成正比，还与其法向速度分量 $v'_y$ 成正比，因为具有较高法向速度的分子会更频繁地在单位时间内穿过给定区域。这是动力学理论的一个基本概念，通常称为发射的余弦定律。因此，漫反射分子的概率密度函数 (PDF) $p_{\\mathrm{diff}}(\\mathbf{v}')$ 与数通量 $v'_y f_{\\mathrm{eq}}(\\mathbf{v}')$ 成正比。定义域被限制为离开壁面的分子，因此 $v'_y  0$。未归一化的 PDF 为：\n$$\np_{\\mathrm{unnorm}}(\\mathbf{v}') = C v'_y \\exp\\left(-\\frac{m(v_x'^2 + v_y'^2 + v_z'^2)}{2k_B T_w}\\right), \\quad \\text{for } v'_y  0\n$$\n其中 $C$ 是归一化常数。为求得 $C$，我们必须强制执行 PDF 在所有可能速度上的积分为 1 的条件：\n$$\n\\int_{-\\infty}^{\\infty} dv'_x \\int_{0}^{\\infty} dv'_y \\int_{-\\infty}^{\\infty} dv'_z \\ p_{\\mathrm{diff}}(\\mathbf{v}') = 1\n$$\n我们来计算未归一化 PDF 的积分：\n$$\n\\text{Integral} = C \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m v_x'^2}{2k_B T_w}\\right) dv'_x \\int_{0}^{\\infty} v'_y \\exp\\left(-\\frac{m v_y'^2}{2k_B T_w}\\right) dv'_y \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m v_z'^2}{2k_B T_w}\\right) dv'_z\n$$\n$v'_x$ 和 $v'_z$ 上的积分是标准高斯积分：\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\frac{\\pi}{a}}\n$$\n这里，$a = \\frac{m}{2k_B T_w}$。所以，\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m v_x'^2}{2k_B T_w}\\right) dv'_x = \\sqrt{\\frac{2\\pi k_B T_w}{m}}\n$$\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m v_z'^2}{2k_B T_w}\\right) dv'_z = \\sqrt{\\frac{2\\pi k_B T_w}{m}}\n$$\n$v'_y$ 上的积分为：\n$$\n\\int_{0}^{\\infty} v'_y \\exp\\left(-\\frac{m v_y'^2}{2k_B T_w}\\right) dv'_y\n$$\n使用换元法，$u = \\frac{m v_y'^2}{2k_B T_w}$，我们得到 $du = \\frac{m v'_y}{k_B T_w} dv'_y$，或 $v'_y dv'_y = \\frac{k_B T_w}{m} du$。积分上下限变为 $0$ 到 $\\infty$。\n$$\n\\int_{0}^{\\infty} \\exp(-u) \\left(\\frac{k_B T_w}{m}\\right) du = \\frac{k_B T_w}{m} [-\\exp(-u)]_0^\\infty = \\frac{k_B T_w}{m} (0 - (-1)) = \\frac{k_B T_w}{m}\n$$\n结合这些结果，归一化积分为：\n$$\nC \\left(\\sqrt{\\frac{2\\pi k_B T_w}{m}}\\right) \\left(\\frac{k_B T_w}{m}\\right) \\left(\\sqrt{\\frac{2\\pi k_B T_w}{m}}\\right) = C \\left(\\frac{2\\pi k_B T_w}{m}\\right) \\left(\\frac{k_B T_w}{m}\\right) = C \\cdot 2\\pi \\left(\\frac{k_B T_w}{m}\\right)^2\n$$\n为使该积分等于 $1$，归一化常数必须是 $C = \\frac{1}{2\\pi} \\left(\\frac{m}{k_B T_w}\\right)^2$。\n因此，漫反射分子的归一化概率密度为：\n$$\np_{\\mathrm{diff}}(\\mathbf{v}') = \\frac{1}{2\\pi} \\left(\\frac{m}{k_B T_w}\\right)^2 v'_y \\exp\\left(-\\frac{m(v_x'^2 + v_y'^2 + v_z'^2)}{2k_B T_w}\\right), \\quad \\text{for } v'_y  0 \\text{ and } \\mathbf{v}' \\in \\mathbb{R}^3\n$$\n\n### 第 2 部分：剪切应力的蒙特卡洛估计量\n\n切向剪切应力 $\\tau_x$ 是指单位面积上转移到壁面的净 $x$ 方向动量的速率。对于一个质量为 $m$、入射速度为 $\\mathbf{v}$、反射速度为 $\\mathbf{v}'$ 的单个分子，其 $x$ 方向动量的变化是 $m(v'_x - v_x)$。根据牛顿第三定律，传递给壁面的动量是这个变化的负值，即 $m(v_x - v'_x)$。\n\n麦克斯韦反射模型规定了反射速度 $\\mathbf{v}'$：\n1.  以 $1-\\alpha$ 的概率发生镜面反射。速度分量保持不变，除了法向分量反向：$\\mathbf{v}'_{\\mathrm{spec}} = (v_x, -v_y, v_z)$。传递给壁面的动量为 $m(v_x - v_{x, \\mathrm{spec}}') = m(v_x - v_x) = 0$。\n2.  以 $\\alpha$ 的概率发生漫反射。反射速度 $\\mathbf{v}'_{\\mathrm{diff}}$ 是从第 1 部分推导的分布 $p_{\\mathrm{diff}}(\\mathbf{v}')$ 中抽取的随机样本。传递给壁面的动量为 $m(v_x - v'_{x, \\mathrm{diff}})$。\n\n在时间间隔 $\\Delta t$ 和壁面面积 $A$ 上的 DSMC 模拟中，设 $N_{\\mathrm{coll}}$ 是撞击壁面的分子总数。传递到壁面的总 $x$ 动量是每次碰撞传递的动量之和：\n$$\n\\Delta P_x = \\sum_{i=1}^{N_{\\mathrm{coll}}} m(v_{x,i} - v'_{x,i})\n$$\n其中 $v_{x,i}$ 是第 $i$ 个分子的入射切向速度， $v'_{x,i}$ 是其反射切向速度，由概率性的麦克斯韦模型确定。\n剪切应力的蒙特卡洛估计量 $\\widehat{\\tau}_x$ 是总传递动量除以面积和时间间隔：\n$$\n\\widehat{\\tau}_x = \\frac{\\Delta P_x}{A \\Delta t} = \\frac{1}{A \\Delta t} \\sum_{i=1}^{N_{\\mathrm{coll}}} m(v_{x,i} - v'_{x,i})\n$$\n这个估计量是无偏的，因为它是对应力物理定义的直接模拟。它的实现方法是：为每个入射分子 $i$ 生成一个随机数来决定是镜面反射还是漫反射，生成相应的 $v'_{x,i}$，然后将贡献求和。\n\n### 第 3 部分：期望剪切应力\n\n为了找到估计量的期望值 $E[\\widehat{\\tau}_x]$，我们计算在给定条件下的解析剪切应力 $\\tau_x$。应力是单位面积上动量传递的期望速率。这可以通过对单个粒子的动量传递进行积分来找到，并由入射粒子通量加权。\n\n速度在 $d^3\\mathbf{v}$ 内的入射粒子通量由 $|v_y| f_{\\mathrm{inc}}(\\mathbf{v}) d^3\\mathbf{v}$ 给出，其中 $f_{\\mathrm{inc}}(\\mathbf{v})$ 是气体的速度分布函数。对于一个入射速度为 $\\mathbf{v}$ 的粒子，传递到壁面的期望动量是 $m(v_x - E[v'_x|\\mathbf{v}])$。反射速度的期望值 $E[v'_x|\\mathbf{v}]$ 是：\n$$\nE[v'_x|\\mathbf{v}] = (1-\\alpha)v'_{x,\\mathrm{spec}} + \\alpha E[v'_{x,\\mathrm{diff}}]\n$$\n对于镜面反射，$v'_{x,\\mathrm{spec}} = v_x$。对于漫反射，反射速度与入射速度无关。分布 $p_{\\mathrm{diff}}$ 在 $v'_x$ 上关于 $0$ 是对称的，因此其期望值为 $E[v'_{x,\\mathrm{diff}}] = \\int v'_x p_{\\mathrm{diff}}(\\mathbf{v}')d^3\\mathbf{v}' = 0$。\n因此，$E[v'_x|\\mathbf{v}] = (1-\\alpha)v_x$。对于一个入射速度为 $\\mathbf{v}$ 的粒子，其期望动量传递为 $m(v_x - (1-\\alpha)v_x) = \\alpha m v_x$。\n\n总剪切应力是这个期望传递在所有入射速度（$v_y  0$）上的积分：\n$$\n\\tau_x = E[\\widehat{\\tau}_x] = \\int_{v_y0} (\\alpha m v_x) |v_y| f_{\\mathrm{inc}}(\\mathbf{v}) d^3\\mathbf{v}\n$$\n由于入射分子的 $v_y  0$，所以 $|v_y| = -v_y$。\n远离壁面的气体处于漂移麦克斯韦状态，其数密度为 $n$，温度为 $T_g$，漂移速度为 $\\mathbf{U} = (U,0,0)$。其分布函数是：\n$$\nf_{\\mathrm{inc}}(\\mathbf{v}) = n \\left(\\frac{m}{2\\pi k_B T_g}\\right)^{3/2} \\exp\\left(-\\frac{m((v_x-U)^2 + v_y^2 + v_z^2)}{2k_B T_g}\\right)\n$$\n将此代入 $\\tau_x$ 的积分中：\n$$\n\\tau_x = -\\alpha m \\int_{-\\infty}^{\\infty} dv_x \\int_{-\\infty}^{0} dv_y \\int_{-\\infty}^{\\infty} dv_z \\ v_x v_y f_{\\mathrm{inc}}(\\mathbf{v})\n$$\n$$\n\\tau_x = -\\alpha m n \\left(\\frac{m}{2\\pi k_B T_g}\\right)^{3/2} \\left[ \\int_{-\\infty}^{\\infty} v_x e^{-\\frac{m(v_x-U)^2}{2k_B T_g}} dv_x \\right] \\left[ \\int_{-\\infty}^{0} v_y e^{-\\frac{m v_y^2}{2k_B T_g}} dv_y \\right] \\left[ \\int_{-\\infty}^{\\infty} e^{-\\frac{m v_z^2}{2k_B T_g}} dv_z \\right]\n$$\n我们来计算这三个积分：\n1.  $v_z$ 积分：这是一个标准高斯积分，结果为 $\\sqrt{\\frac{2\\pi k_B T_g}{m}}$。\n2.  $v_y$ 积分：$\\int_{-\\infty}^{0} v_y e^{-\\frac{m v_y^2}{2k_B T_g}} dv_y$。通过换元 $u = \\frac{m v_y^2}{2k_B T_g}$，其计算结果为 $-\\frac{k_B T_g}{m}$。\n3.  $v_x$ 积分：$\\int_{-\\infty}^{\\infty} v_x e^{-\\frac{m(v_x-U)^2}{2k_B T_g}} dv_x$。令 $w = v_x-U$，则 $v_x=w+U$ 且 $dv_x=dw$。\n    $$\n    \\int_{-\\infty}^{\\infty} (w+U) e^{-\\frac{m w^2}{2k_B T_g}} dw = \\int_{-\\infty}^{\\infty} w e^{-\\frac{m w^2}{2k_B T_g}} dw + U \\int_{-\\infty}^{\\infty} e^{-\\frac{m w^2}{2k_B T_g}} dw\n    $$\n    第一项是奇函数在对称区间上的积分，结果为 $0$。第二项是 $U$ 乘以一个高斯积分。结果是 $U \\sqrt{\\frac{2\\pi k_B T_g}{m}}$。\n\n现在，我们将所有部分相乘：\n$$\n\\tau_x = -\\alpha m n \\left(\\frac{m}{2\\pi k_B T_g}\\right)^{3/2} \\left(U \\sqrt{\\frac{2\\pi k_B T_g}{m}}\\right) \\left(-\\frac{k_B T_g}{m}\\right) \\left(\\sqrt{\\frac{2\\pi k_B T_g}{m}}\\right)\n$$\n$$\n\\tau_x = \\alpha m n \\left(\\frac{m}{2\\pi k_B T_g}\\right)^{3/2} U \\left(\\frac{2\\pi k_B T_g}{m}\\right) \\left(\\frac{k_B T_g}{m}\\right)\n$$\n$$\n\\tau_x = \\alpha n U \\cdot m \\left(\\frac{m}{2\\pi k_B T_g}\\right)^{1/2} \\frac{k_B T_g}{m} = \\alpha n U \\sqrt{\\frac{m (k_B T_g)^2}{2\\pi k_B T_g}}\n$$\n$$\n\\tau_x = \\alpha n U \\sqrt{\\frac{m k_B T_g}{2\\pi}}\n$$\n单位与应力（牛顿/平方米，或帕斯卡）的单位一致。",
            "answer": "$$\n\\boxed{\\alpha n U \\sqrt{\\frac{m k_B T_g}{2\\pi}}}\n$$"
        },
        {
            "introduction": "DSMC模拟的最终目标是从模拟的微观粒子数据中提取有意义的宏观物理量。本练习将指导您完成这一“测量”过程，展示如何从粒子速度集合中计算出完整的压力张量。这个编码实践不仅能强化您对压力和应力的气体动力学定义的理解，还能揭示稀薄气体流中一个重要的非牛顿效应——法向应力差 ，这是传统连续介质模型通常无法捕捉的。",
            "id": "3988872",
            "problem": "给定一个单单元直接模拟蒙特卡洛 (DSMC) 设置，旨在从粒子速度样本中估算稀薄气体的应力张量，并通过法向应力差来量化非牛顿效应。任务是实现一个完整的程序，该程序针对几个指定的测试用例，从规定的高斯速度分布中生成粒子速度，使用动理学理论定义计算压力张量，并输出非牛顿行为的无量纲度量。\n\n从动理学理论定义开始：给定一个分布函数 $f(\\mathbf{x},\\mathbf{v},t)$ 和奇特速度 $\\mathbf{c} = \\mathbf{v} - \\mathbf{u}$，压力张量（在动理学理论中也称为应力张量）定义为\n$$\n\\mathbf{P}(\\mathbf{x},t) = \\int m\\,\\mathbf{c}\\,\\mathbf{c}^{\\top}\\,f(\\mathbf{x},\\mathbf{v},t)\\,\\mathrm{d}\\mathbf{v},\n$$\n其中 $m$ 是分子质量，$\\mathbf{u}$ 是宏观速度。在 DSMC 中，这个单元积分通过对单元内粒子求和来估计。对于体积为 $V$、包含 $N$ 个模拟粒子（其速度为 $\\{\\mathbf{v}_k\\}_{k=1}^N$）的单元，计算样本宏观速度\n$$\n\\hat{\\mathbf{u}} = \\frac{1}{N}\\sum_{k=1}^N \\mathbf{v}_k,\n$$\n奇特速度 $\\mathbf{c}_k = \\mathbf{v}_k - \\hat{\\mathbf{u}}$，以及压力张量估算量\n$$\n\\mathbf{P} = \\frac{m}{V}\\sum_{k=1}^N \\mathbf{c}_k \\mathbf{c}_k^{\\top}.\n$$\n根据 $\\mathbf{P}$，计算各向同性压力\n$$\np = \\frac{1}{3}\\,\\mathrm{tr}(\\mathbf{P}),\n$$\n和第一法向应力差\n$$\nN_1 = P_{xx} - P_{yy}.\n$$\n对于在连续介质极限下由 Navier–Stokes 本构律支配的牛顿流体，在简单剪切中法向应力差为零。在稀薄气体中，有限的克努森数（Knudsen number）效应会使速度分布偏离局部各向同性，从而可能出现 $N_1 \\neq 0$；非牛顿行为的一个无量纲指标是比率 $N_1/p$。\n\n您的程序必须：\n- 对于下面列出的每个测试用例，根据给定的参数，从均值为 $\\mathbf{u}$、协方差为 $\\Sigma$ 的多元正态分布中生成 $N$ 个粒子速度 $\\mathbf{v}_k$（单位：$\\mathrm{m/s}$）。为保证可复现性，请使用提供的随机种子。所有量必须使用以下单位：质量（$\\mathrm{kg}$），体积（$\\mathrm{m}^3$），速度（$\\mathrm{m/s}$），以及应力/压力（$\\mathrm{Pa}$）。\n- 计算 $\\hat{\\mathbf{u}}$、$\\mathbf{c}_k$、$\\mathbf{P}$、$p$ 和 $N_1$。\n- 将所有测试用例的无量纲比率 $N_1/p$ 作为包含逗号分隔的 Python 风格列表（例如，“[result1,result2,result3]”）的单行输出。\n\n根据所提供的参数 $(\\sigma_x,\\sigma_y,\\sigma_z,\\alpha)$ 按如下方式构造协方差矩阵 $\\Sigma$：\n- 对角线元素为 $\\Sigma_{xx} = \\sigma_x^2$、$\\Sigma_{yy} = \\sigma_y^2$、$\\Sigma_{zz} = \\sigma_z^2$。\n- 非对角线元素 $\\Sigma_{xy} = \\alpha\\,\\sigma_x\\,\\sigma_y$，且 $\\Sigma_{yx} = \\Sigma_{xy}$。\n- 所有其他非对角线元素均为零。\n\n测试套件（请严格使用这些值）：\n1. 案例 A（近各向同性，正常情况）：\n   - 随机种子：$123$\n   - 粒子数：$N = 5000$\n   - 分子质量：$m = 4.65\\times 10^{-26}\\,\\mathrm{kg}$\n   - 单元体积：$V = 1.0\\times 10^{-17}\\,\\mathrm{m^3}$\n   - 平均速度：$\\mathbf{u} = [50,\\,0,\\,0]\\,\\mathrm{m/s}$\n   - 协方差参数：$\\sigma_x = 300\\,\\mathrm{m/s}$、$\\sigma_y = 300\\,\\mathrm{m/s}$、$\\sigma_z = 300\\,\\mathrm{m/s}$、$\\alpha = 0$\n2. 案例 B（各向异性且带正相关，非牛顿特征）：\n   - 随机种子：$456$\n   - 粒子数：$N = 5000$\n   - 分子质量：$m = 4.65\\times 10^{-26}\\,\\mathrm{kg}$\n   - 单元体积：$V = 1.0\\times 10^{-17}\\,\\mathrm{m^3}$\n   - 平均速度：$\\mathbf{u} = [0,\\,0,\\,0]\\,\\mathrm{m/s}$\n   - 协方差参数：$\\sigma_x = 350\\,\\mathrm{m/s}$、$\\sigma_y = 250\\,\\mathrm{m/s}$、$\\sigma_z = 300\\,\\mathrm{m/s}$、$\\alpha = 0.2$\n3. 案例 C（小样本，负相关，边界情况）：\n   - 随机种子：$789$\n   - 粒子数：$N = 20$\n   - 分子质量：$m = 4.65\\times 10^{-26}\\,\\mathrm{kg}$\n   - 单元体积：$V = 1.0\\times 10^{-17}\\,\\mathrm{m^3}$\n   - 平均速度：$\\mathbf{u} = [0,\\,0,\\,0]\\,\\mathrm{m/s}$\n   - 协方差参数：$\\sigma_x = 400\\,\\mathrm{m/s}$、$\\sigma_y = 200\\,\\mathrm{m/s}$、$\\sigma_z = 300\\,\\mathrm{m/s}$、$\\alpha = -0.3$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含案例 A、B 和 C 的三个无量纲比率 $N_1/p$，格式为方括号内以逗号分隔的列表，例如，“[xA,xB,xC]”。每个条目必须是实数（浮点数）。不应打印任何其他文本。",
            "solution": "该问题是有效的，因为它在科学上基于气体动理学理论和直接模拟蒙特卡洛 (DSMC) 方法，具有适定、客观和完整的定义。解决此问题的过程涉及将所提供的公式直接应用于数值生成的数据。该解决方案围绕每个测试用例的逐步计算而设计，从生成微观粒子数据到计算宏观应力属性。\n\n主要目标是计算无量纲比率 $N_1/p$，它可作为非牛顿流体行为的指标。此计算针对单个模拟单元中稀薄气体的三种不同情况进行。整个计算过程依赖于统计力学原理，其中宏观量是从大量微观粒子的平均行为中推导出来的。\n\n第一步是通过生成粒子的统计系综来模拟气体状态。问题指定 $N$ 个粒子的速度 $\\{\\mathbf{v}_k\\}_{k=1}^N$ 从一个三维多元正态（高斯）分布 $\\mathcal{N}(\\mathbf{u}, \\Sigma)$ 中抽取。在这里，$\\mathbf{u}$ 是分布的平均速度，代表气体的宏观整体速度，而 $\\Sigma$ 是一个 $3 \\times 3$ 的协方差矩阵，描述了速度分量的热扩散和相关性。对于每个测试用例，都给定了一组特定参数 $(\\sigma_x, \\sigma_y, \\sigma_z, \\alpha)$ 来构造协方差矩阵 $\\Sigma$，如下所示：\n$$\n\\Sigma =\n\\begin{pmatrix}\n\\sigma_x^2  \\alpha \\sigma_x \\sigma_y  0 \\\\\n\\alpha \\sigma_x \\sigma_y  \\sigma_y^2  0 \\\\\n0  0  \\sigma_z^2\n\\end{pmatrix}\n$$\n对角线元素 $\\Sigma_{xx} = \\sigma_x^2$、$\\Sigma_{yy} = \\sigma_y^2$ 和 $\\Sigma_{zz} = \\sigma_z^2$ 代表了每个空间方向上的方差（与温度成正比）。非对角项 $\\Sigma_{xy} = \\alpha \\sigma_x \\sigma_y$ 引入了速度分量 $v_x$ 和 $v_y$ 之间的相关性，这对于模拟剪切效应至关重要。为保证可复现性，每个案例都使用一个特定的随机种子来初始化伪随机数生成器，从而确保对于给定的案例，生成的 $N$ 个速度向量 $\\mathbf{v}_k$ 集合是相同的。\n\n一旦生成了粒子速度 $\\{\\mathbf{v}_k\\}$，下一步就是计算气体的宏观属性。样本宏观速度 $\\hat{\\mathbf{u}}$ 计算为单个粒子速度的算术平均值：\n$$\n\\hat{\\mathbf{u}} = \\frac{1}{N}\\sum_{k=1}^N \\mathbf{v}_k\n$$\n这个 $\\hat{\\mathbf{u}}$ 是分布真实平均速度 $\\mathbf{u}$ 的一个统计估计量。由于样本大小 $N$ 是有限的，$\\hat{\\mathbf{u}}$ 通常不会与 $\\mathbf{u}$ 完全相等。\n\n在确定样本宏观速度后，我们通过从粒子的绝对速度中减去样本宏观流动速度来计算每个粒子的奇特速度 $\\mathbf{c}_k$：\n$$\n\\mathbf{c}_k = \\mathbf{v}_k - \\hat{\\mathbf{u}}\n$$\n奇特速度代表了粒子相对于气体相干运动的随机热运动。正是这些随机运动产生了压力和应力。\n\n核心量是压力张量 $\\mathbf{P}$，它是根据动理学理论中的公式，针对体积为 $V$ 的单元内的一组离散粒子进行调整后，从粒子数据中估计出来的：\n$$\n\\mathbf{P} = \\frac{m}{V}\\sum_{k=1}^N \\mathbf{c}_k \\mathbf{c}_k^{\\top}\n$$\n这里，$m$ 是单个分子的质量。项 $\\mathbf{c}_k \\mathbf{c}_k^{\\top}$ 是奇特速度向量与自身的外积，产生一个 $3 \\times 3$ 的矩阵。该操作对单元中所有 $N$ 个粒子进行求和，并按因子 $m/V$ 进行缩放。得到的张量 $\\mathbf{P}$ 的对角线元素为法向应力（$P_{xx}, P_{yy}, P_{zz}$），非对角线元素为剪切应力（$P_{xy}, P_{xz}, \\dots$）。在计算上，求和 $\\sum_{k=1}^N \\mathbf{c}_k \\mathbf{c}_k^{\\top}$ 可以通过矩阵乘法 $C^{\\top}C$ 高效执行，其中 $C$ 是一个 $N \\times 3$ 的矩阵，其行是奇特速度向量 $\\mathbf{c}_k^{\\top}$。\n\n从压力张量 $\\mathbf{P}$，我们推导出最终感兴趣的量。各向同性压力 $p$ 是法向应力的平均值，由压力张量迹的三分之一给出：\n$$\np = \\frac{1}{3}\\,\\mathrm{tr}(\\mathbf{P}) = \\frac{1}{3}(P_{xx} + P_{yy} + P_{zz})\n$$\n第一法向应力差 $N_1$ 定义为 $x$ 和 $y$ 方向上法向应力之差：\n$$\nN_1 = P_{xx} - P_{yy}\n$$\n对于简单剪切流中的牛顿流体，$N_1$ 将为零。非零的 $N_1$ 是非牛顿效应的一个关键特征，这在速度分布函数可能显著各向异性的稀薄气体流中尤为突出。\n\n最后，通过计算第一法向应力差与各向同性压力之比 $N_1/p$，得到这种非牛顿行为的无量纲指标。对三个测试用例中的每一个都计算此比率，并将结果汇编成一个列表以供输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the DSMC stress tensor estimation for all test cases.\n    \"\"\"\n\n    def calculate_n1_ratio(case_params):\n        \"\"\"\n        Calculates the non-Newtonian stress ratio N1/p for a single test case.\n\n        Args:\n            case_params (tuple): A tuple containing all parameters for the case:\n                (seed, N, m, V, u_mean, sigma_x, sigma_y, sigma_z, alpha).\n\n        Returns:\n            float: The calculated dimensionless ratio N1/p.\n        \"\"\"\n        # Step 1: Unpack parameters and initialize the random number generator\n        seed, N, m, V, u_mean, sigma_x, sigma_y, sigma_z, alpha = case_params\n        rng = np.random.default_rng(seed)\n\n        # Step 2: Construct the covariance matrix\n        cov_matrix = np.array([\n            [sigma_x**2,                alpha * sigma_x * sigma_y, 0.0],\n            [alpha * sigma_x * sigma_y, sigma_y**2,                0.0],\n            [0.0,                       0.0,                       sigma_z**2]\n        ])\n\n        # Step 3: Generate N particle velocities from the multivariate normal distribution\n        # velocities is an (N, 3) shaped array.\n        velocities = rng.multivariate_normal(mean=u_mean, cov=cov_matrix, size=N)\n\n        # Step 4: Compute the sample bulk velocity (u_hat)\n        # u_hat is a (3,) shaped array.\n        u_hat = np.mean(velocities, axis=0)\n\n        # Step 5: Compute peculiar velocities (c_k)\n        # peculiar_velocities is an (N, 3) shaped array.\n        peculiar_velocities = velocities - u_hat\n\n        # Step 6: Compute the pressure tensor (P)\n        # The summation of outer products sum(c_k * c_k^T) is efficiently\n        # calculated as C^T @ C, where C is the matrix of peculiar velocities.\n        # peculiar_velocities.T is (3, N), peculiar_velocities is (N, 3).\n        # The result is a (3, 3) matrix.\n        sum_of_outer_products = peculiar_velocities.T @ peculiar_velocities\n        pressure_tensor = (m / V) * sum_of_outer_products\n\n        # Step 7: Compute the isotropic pressure (p)\n        # p is one-third of the trace of the pressure tensor.\n        isotropic_pressure = (1.0 / 3.0) * np.trace(pressure_tensor)\n\n        # A physical system should have positive pressure. If it's zero,\n        # N1 will also be zero, so the ratio is well-defined as 0.\n        if isotropic_pressure == 0.0:\n            return 0.0\n\n        # Step 8: Compute the first normal stress difference (N1)\n        # N1 = P_xx - P_yy\n        n1 = pressure_tensor[0, 0] - pressure_tensor[1, 1]\n\n        # Step 9: Compute and return the dimensionless ratio N1/p\n        ratio = n1 / isotropic_pressure\n        return ratio\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (seed, N, m, V, u, sx, sy, sz, alpha)\n    test_cases = [\n        # Case A: near-isotropic, happy path\n        (123, 5000, 4.65e-26, 1.0e-17, np.array([50.0, 0.0, 0.0]), 300.0, 300.0, 300.0, 0.0),\n\n        # Case B: anisotropic with positive correlation\n        (456, 5000, 4.65e-26, 1.0e-17, np.array([0.0, 0.0, 0.0]), 350.0, 250.0, 300.0, 0.2),\n\n        # Case C: small sample, negative correlation\n        (789, 20, 4.65e-26, 1.0e-17, np.array([0.0, 0.0, 0.0]), 400.0, 200.0, 300.0, -0.3),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_n1_ratio(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}