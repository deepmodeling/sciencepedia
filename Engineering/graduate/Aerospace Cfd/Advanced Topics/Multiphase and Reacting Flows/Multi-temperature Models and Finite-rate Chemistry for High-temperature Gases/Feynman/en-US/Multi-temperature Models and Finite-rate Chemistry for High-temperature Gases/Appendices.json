{
    "hands_on_practices": [
        {
            "introduction": "The origin of thermal non-equilibrium lies in the finite time required for energy to distribute among internal modes after a sudden change, like passage through a shock. This exercise  examines the classic Landau-Teller model, which describes the relaxation of vibrational temperature $T_v$ towards the translational temperature $T$. By deriving the analytical solution, you will gain crucial insight into the exponential nature of this process and the physical meaning of the vibrational relaxation time $\\tau_v$.",
            "id": "3977827",
            "problem": "Consider a spatially uniform, stagnant parcel of a high-temperature diatomic gas modeled with a two-temperature framework in Computational Fluid Dynamics (CFD), where the translational-rotational temperature is denoted by $T(t)$ and the vibrational temperature is denoted by $T_{v}(t)$. Assume chemistry is frozen and ignore convection and diffusion. Let the vibrational energy per unit mass be $e_{v}(t)$ and its local thermodynamic equilibrium value with respect to the translational-rotational mode be $e_{v}^{\\ast}(T(t))$. The vibrational energy exchange between modes is described by a widely accepted linear relaxation law with a characteristic vibrational relaxation time $\\tau_{v}$:\n$$\n\\frac{d e_{v}}{d t} = \\frac{e_{v}^{\\ast}(T) - e_{v}}{\\tau_{v}} \\quad \\text{for} \\quad t \\ge 0.\n$$\nAt time $t=0$, an external impulsive heating event instantaneously raises the translational-rotational temperature from the pre-shock value $T(0^{-}) = T_{i}$ to a post-shock plateau $T(t) = T_{f}$ for all $t \\ge 0$. Assume the vibrational temperature is initially in equilibrium with the pre-shock state, $T_{v}(0^{-}) = T_{i}$. For $t \\ge 0$, take the vibrational relaxation time to be constant, $\\tau_{v} = \\text{const}$, and adopt the constant vibrational specific heat approximation $c_{v,v} = \\text{const}$ such that\n$$\ne_{v}(t) = c_{v,v} \\, T_{v}(t), \\qquad e_{v}^{\\ast}(T(t)) = c_{v,v} \\, T(t).\n$$\nStarting from the stated energy relaxation law and these definitions, derive the ordinary differential equation (ODE) governing $T_{v}(t)$ for $t \\ge 0$ and solve it analytically for the step change in $T$ at $t=0$. Use the initial condition $T_{v}(0)=T_{i}$ (corresponding to the instant just after the step in $T$). Express the final answer as a single closed-form analytical expression for $T_{v}(t)$ in terms of $t$, $T_{i}$, $T_{f}$, and $\\tau_{v}$. You do not need to include units in the expression; treat $T$ and $T_{v}$ as temperatures measured in Kelvin. No numerical evaluation is required.",
            "solution": "The problem statement is evaluated for validity before proceeding with a solution.\n\n**Step 1: Extract Givens**\nThe following information is provided in the problem statement:\n- The system is a spatially uniform, stagnant parcel of a high-temperature diatomic gas.\n- The model is a two-temperature framework with translational-rotational temperature $T(t)$ and vibrational temperature $T_v(t)$.\n- Chemistry is frozen; convection and diffusion are ignored.\n- The vibrational energy per unit mass is $e_v(t)$.\n- The local thermodynamic equilibrium vibrational energy is $e_v^{\\ast}(T(t))$.\n- The governing equation for vibrational energy relaxation for $t \\ge 0$ is:\n$$ \\frac{d e_{v}}{d t} = \\frac{e_{v}^{\\ast}(T) - e_{v}}{\\tau_{v}} $$\n- An impulsive heating event occurs at $t=0$.\n- The pre-shock translational-rotational temperature is $T(0^{-}) = T_i$.\n- The post-shock translational-rotational temperature is $T(t) = T_f$ for all $t \\ge 0$.\n- The initial condition for the vibrational temperature is $T_v(0^{-}) = T_i$.\n- The vibrational relaxation time is constant: $\\tau_v = \\text{const}$.\n- The vibrational specific heat is constant: $c_{v,v} = \\text{const}$.\n- The relationships between energy and temperature are:\n$$ e_{v}(t) = c_{v,v} \\, T_{v}(t) $$\n$$ e_{v}^{\\ast}(T(t)) = c_{v,v} \\, T(t) $$\n- The initial condition for the differential equation to be solved for $t \\ge 0$ is $T_v(0) = T_i$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-defined and scientifically grounded. It describes a classic problem in non-equilibrium gas dynamics: the relaxation of vibrational temperature in a gas parcel subjected to a sudden increase in translational temperature, as is characteristic of the region behind a normal shock wave. The governing equation is the standard Landau-Teller relaxation model. The assumptions of constant vibrational specific heat and constant relaxation time are common and valid simplifications for deriving analytical solutions. The problem is self-contained, with all necessary equations and initial conditions provided. It is a well-posed initial value problem for a first-order ordinary differential equation, which admits a unique, stable solution. The problem statement contains no scientific or factual unsoundness, no contradictions, and no ambiguities.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be derived.\n\n**Derivation of the Solution**\nThe goal is to derive and solve the ordinary differential equation (ODE) for the vibrational temperature $T_v(t)$.\n\nFirst, we substitute the given constitutive relations for $e_v$ and $e_v^{\\ast}$ into the vibrational energy relaxation equation.\nThe relaxation law is:\n$$ \\frac{d e_{v}}{d t} = \\frac{e_{v}^{\\ast}(T) - e_{v}}{\\tau_{v}} $$\nSubstituting $e_{v}(t) = c_{v,v} T_{v}(t)$ and $e_{v}^{\\ast}(T(t)) = c_{v,v} T(t)$:\n$$ \\frac{d}{dt} (c_{v,v} T_{v}) = \\frac{c_{v,v} T - c_{v,v} T_{v}}{\\tau_{v}} $$\nSince $c_{v,v}$ is a constant, it can be taken out of the time derivative and factored out on the right-hand side:\n$$ c_{v,v} \\frac{d T_{v}}{d t} = \\frac{c_{v,v} (T - T_{v})}{\\tau_{v}} $$\nDividing both sides by the non-zero constant $c_{v,v}$ yields the ODE for the vibrational temperature $T_v(t)$ in terms of the translational-rotational temperature $T(t)$:\n$$ \\frac{d T_{v}}{d t} = \\frac{T(t) - T_{v}(t)}{\\tau_{v}} $$\nThe problem specifies that for $t \\ge 0$, the translational-rotational temperature is constant at the post-shock value, $T(t) = T_f$. Substituting this into the ODE gives:\n$$ \\frac{d T_{v}}{d t} = \\frac{T_{f} - T_{v}}{\\tau_{v}} $$\nThis is a first-order linear inhomogeneous ordinary differential equation. It can be solved using the method of separation of variables. We rearrange the equation to separate the variables $T_v$ and $t$:\n$$ \\frac{d T_{v}}{T_{f} - T_{v}} = \\frac{dt}{\\tau_{v}} $$\nWe integrate both sides of the equation. The integration on the left side is with respect to $T_v$ from its initial value $T_v(0)$ to its value at a later time $T_v(t)$, and on the right side with respect to time from $0$ to $t$:\n$$ \\int_{T_{v}(0)}^{T_{v}(t)} \\frac{d T'_{v}}{T_{f} - T'_{v}} = \\int_{0}^{t} \\frac{d t'}{\\tau_{v}} $$\nThe integral on the left yields a natural logarithm:\n$$ \\left[ -\\ln(T_{f} - T'_{v}) \\right]_{T_{v}(0)}^{T_{v}(t)} = \\left[ \\frac{t'}{\\tau_{v}} \\right]_{0}^{t} $$\nUsing the initial condition $T_v(0) = T_i$:\n$$ -\\ln(T_{f} - T_{v}(t)) - (-\\ln(T_{f} - T_{i})) = \\frac{t}{\\tau_{v}} $$\n$$ \\ln(T_{f} - T_{i}) - \\ln(T_{f} - T_{v}(t)) = \\frac{t}{\\tau_{v}} $$\nUsing the property of logarithms, $\\ln(a) - \\ln(b) = \\ln(a/b)$:\n$$ \\ln\\left(\\frac{T_{f} - T_{i}}{T_{f} - T_{v}(t)}\\right) = \\frac{t}{\\tau_{v}} $$\nTo solve for $T_v(t)$, we exponentiate both sides:\n$$ \\frac{T_{f} - T_{i}}{T_{f} - T_{v}(t)} = \\exp\\left(\\frac{t}{\\tau_{v}}\\right) $$\nNow, we algebraically rearrange the equation to isolate $T_v(t)$:\n$$ T_{f} - T_{v}(t) = (T_{f} - T_{i}) \\exp\\left(-\\frac{t}{\\tau_{v}}\\right) $$\n$$ T_{v}(t) = T_{f} - (T_{f} - T_{i}) \\exp\\left(-\\frac{t}{\\tau_{v}}\\right) $$\nThis expression describes the evolution of the vibrational temperature from its initial value $T_i$ as it relaxes towards the new equilibrium temperature $T_f$ with a characteristic time scale $\\tau_v$.\nAt $t=0$, $T_v(0) = T_f - (T_f - T_i)\\exp(0) = T_f - (T_f - T_i) = T_i$, which satisfies the initial condition.\nAs $t \\to \\infty$, $T_v(t) \\to T_f - (T_f - T_i)(0) = T_f$, which is the expected equilibrium state.\nThe derived expression is the correct analytical solution.",
            "answer": "$$\\boxed{T_{f} - (T_{f} - T_{i}) \\exp\\left(-\\frac{t}{\\tau_{v}}\\right)}$$"
        },
        {
            "introduction": "In a gas where translational and vibrational temperatures differ, modeling temperature-dependent chemical reaction rates requires an 'effective temperature'. This practice  explores this critical modeling step by comparing two prominent formulations for the dissociation rate, one based on Park's model and an alternative. You will implement and evaluate these models against a validation dataset, gaining practical experience in how model choice impacts the prediction of chemical phenomena.",
            "id": "3977801",
            "problem": "Consider nitrogen dissociation in a hypersonic flow modeled with a multi-temperature approach, where translational-rotational temperature $T$ and vibrational temperature $T_v$ can differ. The dissociation rate constant $k$ is treated as a finite-rate chemical process using a modified Arrhenius law, with an effective temperature $T^{*}$ that accounts for nonequilibrium. Assume a global pseudo-first-order representation of the dissociation process into atoms, such that the rate constant has units of $\\mathrm{s}^{-1}$.\n\nFundamental base and core definitions:\n- The Arrhenius law for the dissociation rate is taken as\n$$\nk(T^{*}) \\;=\\; A \\, T^{n} \\, \\exp\\!\\left(-\\frac{E_d}{R\\,T^{*}}\\right),\n$$\nwhere $A$ is a pre-exponential factor with units of $\\mathrm{s}^{-1}$, $n$ is a dimensionless temperature exponent, $E_d$ is the molar dissociation energy with units of $\\mathrm{J/mol}$, and $R$ is the universal gas constant with units of $\\mathrm{J/(mol\\cdot K)}$. In this problem, use $A = 10^{9}\\ \\mathrm{s}^{-1}$, $n = 0$, $E_d = 9.76\\times 96485\\ \\mathrm{J/mol}$ (corresponding to $9.76\\ \\mathrm{eV}$ per molecule), and $R = 8.314\\ \\mathrm{J/(mol\\cdot K)}$.\n- The onset of dissociation is defined to occur when the characteristic dissociation timescale $\\tau_d = 1/k$ becomes smaller than a specified chemical residence time $\\tau_c$. In this problem, use $\\tau_c = 10^{-3}\\ \\mathrm{s}$ (one millisecond), so the onset condition is $k \\ge 1/\\tau_c = 10^{3}\\ \\mathrm{s}^{-1}$. The predicted onset is a boolean, with $\\text{True}$ denoting onset and $\\text{False}$ denoting no onset.\n- Park’s effective temperature model, here represented by a linear blending of $T$ and $T_v$ (a common approach, though distinct from the geometric mean model mentioned in the main text):\n$$\nT^{*}_{\\text{Park}} \\;=\\; T \\;+\\; s\\,\\big(T_v - T\\big),\n$$\nwith a constant blending coefficient $s$. In this problem, use $s = 0.5$ consistent with nitrogen dissociation modeling practices.\n- An alternative formulation inspired by more conservative vibrational weighting (e.g., Marrone–Treviño-type approaches) is represented here by a weighted harmonic mean of $T$ and $T_v$:\n$$\nT^{*}_{\\text{MT}} \\;=\\; \\left(\\frac{1-w}{T} + \\frac{w}{T_v}\\right)^{-1},\n$$\nwith a constant weight $w$. In this problem, use $w = 0.5$. This $T^{*}_{\\text{MT}}$ is always less than or equal to the corresponding weighted arithmetic mean, thus producing more conservative (later) onset predictions than $T^{*}_{\\text{Park}}$ for $T \\neq T_v$.\n\nYour task:\n- Using the constants above, implement both models, compute $k(T^{*})$, and predict onset booleans for each case.\n- Compare both models against the same validation dataset and assess which model better reproduces the observed onset of dissociation (given below).\n\nValidation dataset:\nEach test case provides $(T,\\ T_v)$ in Kelvin and the observed onset boolean $y$, where $\\text{True}$ denotes observed onset and $\\text{False}$ denotes no onset. Use the following set of eight cases:\n1. $(T = 4000\\ \\mathrm{K},\\ T_v = 4000\\ \\mathrm{K},\\ y = \\text{False})$\n2. $(T = 4000\\ \\mathrm{K},\\ T_v = 8000\\ \\mathrm{K},\\ y = \\text{False})$\n3. $(T = 6000\\ \\mathrm{K},\\ T_v = 6000\\ \\mathrm{K},\\ y = \\text{False})$\n4. $(T = 6000\\ \\mathrm{K},\\ T_v = 12000\\ \\mathrm{K},\\ y = \\text{False})$\n5. $(T = 8000\\ \\mathrm{K},\\ T_v = 8000\\ \\mathrm{K},\\ y = \\text{False})$\n6. $(T = 9000\\ \\mathrm{K},\\ T_v = 12000\\ \\mathrm{K},\\ y = \\text{True})$\n7. $(T = 10000\\ \\mathrm{K},\\ T_v = 7000\\ \\mathrm{K},\\ y = \\text{True})$\n8. $(T = 7000\\ \\mathrm{K},\\ T_v = 10000\\ \\mathrm{K},\\ y = \\text{True})$\n\nRequired outputs:\n- For each test case, compute the predicted onset booleans for Park’s model and the alternative model. Determine correctness by comparing predictions to the observed $y$.\n- Compute the total number of misclassifications (integer counts) for Park’s model and for the alternative model across all cases.\n- Determine the better model as follows: output $0$ if Park’s model has fewer misclassifications, $1$ if the alternative model has fewer misclassifications, and $2$ if they tie.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain five elements:\n1. A list of booleans of length $8$ indicating Park’s per-case correctness.\n2. A list of booleans of length $8$ indicating the alternative model’s per-case correctness.\n3. An integer: the total misclassification count for Park’s model.\n4. An integer: the total misclassification count for the alternative model.\n5. An integer: the better-model indicator defined above.\n\nFor example, your program must print a line in the exact form\n$$\n[\\,[b_1,\\dots,b_8],\\,[c_1,\\dots,c_8],\\,m_{\\text{Park}},\\,m_{\\text{MT}},\\,w\\,],\n$$\nwith no additional text. All temperatures are in Kelvin ($\\mathrm{K}$), times in seconds ($\\mathrm{s}$), and energies in $\\mathrm{J/mol}$. Angles do not appear. There are no percentages in the output.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of high-temperature gas dynamics, well-posed with a clear and complete set of definitions and data, and objective in its formulation. No inconsistencies, ambiguities, or factual errors were detected. Therefore, a complete solution is provided.\n\nThe problem requires a comparison of two multi-temperature models for predicting the onset of nitrogen dissociation. The analysis proceeds in three steps: first, we establish a quantitative criterion for the onset of dissociation; second, we apply this criterion to each of the two models for every test case; third, we evaluate the models based on their predictive accuracy against the provided validation dataset.\n\nThe dissociation rate constant $k$ is given by a modified Arrhenius law:\n$$\nk(T^{*}) \\;=\\; A \\, T^{n} \\, \\exp\\!\\left(-\\frac{E_d}{R\\,T^{*}}\\right)\n$$\nThe provided constants are:\n- Pre-exponential factor, $A = 10^9\\ \\mathrm{s}^{-1}$\n- Temperature exponent, $n = 0$\n- Molar dissociation energy, $E_d = 9.76\\times 96485\\ \\mathrm{J/mol} = 941693.6\\ \\mathrm{J/mol}$\n- Universal gas constant, $R = 8.314\\ \\mathrm{J/(mol\\cdot K)}$\n\nWith $n=0$, the temperature multiplier $T^n$ becomes $T^0 = 1$, and the rate law simplifies to:\n$$\nk(T^{*}) \\;=\\; A \\, \\exp\\!\\left(-\\frac{E_d}{R\\,T^{*}}\\right)\n$$\nThe onset of dissociation is defined to occur when the characteristic dissociation time $\\tau_d = 1/k$ is less than the chemical residence time $\\tau_c = 10^{-3}\\ \\mathrm{s}$. This condition is equivalent to the rate constant $k$ exceeding a critical value $k_{\\text{crit}}$:\n$$\nk(T^{*}) \\ge \\frac{1}{\\tau_c} = \\frac{1}{10^{-3}\\ \\mathrm{s}} = 1000\\ \\mathrm{s}^{-1}\n$$\nTo simplify the analysis, we can determine the critical effective temperature, $T^{*}_{\\text{crit}}$, at which this onset condition is met.\n$$\nk_{\\text{crit}} = A \\, \\exp\\!\\left(-\\frac{E_d}{R\\,T^{*}_{\\text{crit}}}\\right) = 10^3\\ \\mathrm{s}^{-1}\n$$\nSolving for $T^{*}_{\\text{crit}}$:\n$$\n10^3 = 10^9 \\, \\exp\\!\\left(-\\frac{E_d}{R\\,T^{*}_{\\text{crit}}}\\right)\n$$\n$$\n10^{-6} = \\exp\\!\\left(-\\frac{E_d}{R\\,T^{*}_{\\text{crit}}}\\right)\n$$\nTaking the natural logarithm of both sides:\n$$\n\\ln(10^{-6}) = -\\frac{E_d}{R\\,T^{*}_{\\text{crit}}}\n$$\n$$\n-6 \\ln(10) = -\\frac{E_d}{R\\,T^{*}_{\\text{crit}}}\n$$\n$$\nT^{*}_{\\text{crit}} = \\frac{E_d}{6 R \\ln(10)}\n$$\nSubstituting the values for $E_d$ and $R$:\n$$\nT^{*}_{\\text{crit}} = \\frac{941693.6\\ \\mathrm{J/mol}}{6 \\times 8.314\\ \\mathrm{J/(mol\\cdot K)} \\times \\ln(10)} \\approx \\frac{941693.6}{6 \\times 8.314 \\times 2.302585} \\approx 8198.2\\ \\mathrm{K}\n$$\nThus, dissociation onset is predicted if the effective temperature $T^{*}$ for a given model is greater than or equal to $8198.2\\ \\mathrm{K}$.\n\nNow we evaluate the two effective temperature models for each test case.\n\n**Model 1: Park’s Model**\nThe effective temperature is a linear blending of the translational-rotational temperature $T$ and the vibrational temperature $T_v$:\n$$\nT^{*}_{\\text{Park}} = T + s(T_v - T)\n$$\nWith the blending coefficient $s = 0.5$, this simplifies to the arithmetic mean:\n$$\nT^{*}_{\\text{Park}} = T + 0.5(T_v - T) = 0.5T + 0.5T_v = \\frac{T+T_v}{2}\n$$\n\n**Model 2: Alternative (Marrone–Treviño-type) Model**\nThe effective temperature is a weighted harmonic mean of $T$ and $T_v$:\n$$\nT^{*}_{\\text{MT}} = \\left(\\frac{1-w}{T} + \\frac{w}{T_v}\\right)^{-1}\n$$\nWith the weight $w = 0.5$, this simplifies to the harmonic mean:\n$$\nT^{*}_{\\text{MT}} = \\left(\\frac{0.5}{T} + \\frac{0.5}{T_v}\\right)^{-1} = \\left(\\frac{T_v+T}{2TT_v}\\right)^{-1} = \\frac{2TT_v}{T+T_v}\n$$\n\nThe analysis for each of the eight validation cases is as follows, using the threshold $T^{*}_{\\text{crit}} \\approx 8198.2\\ \\mathrm{K}$.\n\n**Case 1:** $(T=4000\\ \\mathrm{K}, T_v=4000\\ \\mathrm{K}, y=\\text{False})$\n$T^{*}_{\\text{Park}} = (4000+4000)/2 = 4000\\ \\mathrm{K}  T^{*}_{\\text{crit}}$. Prediction: False. Correct.\n$T^{*}_{\\text{MT}} = 2(4000)(4000)/(4000+4000) = 4000\\ \\mathrm{K}  T^{*}_{\\text{crit}}$. Prediction: False. Correct.\n\n**Case 2:** $(T=4000\\ \\mathrm{K}, T_v=8000\\ \\mathrm{K}, y=\\text{False})$\n$T^{*}_{\\text{Park}} = (4000+8000)/2 = 6000\\ \\mathrm{K}  T^{*}_{\\text{crit}}$. Prediction: False. Correct.\n$T^{*}_{\\text{MT}} = 2(4000)(8000)/(4000+8000) \\approx 5333.3\\ \\mathrm{K}  T^{*}_{\\text{crit}}$. Prediction: False. Correct.\n\n**Case 3:** $(T=6000\\ \\mathrm{K}, T_v=6000\\ \\mathrm{K}, y=\\text{False})$\n$T^{*}_{\\text{Park}} = (6000+6000)/2 = 6000\\ \\mathrm{K}  T^{*}_{\\text{crit}}$. Prediction: False. Correct.\n$T^{*}_{\\text{MT}} = 2(6000)(6000)/(6000+6000) = 6000\\ \\mathrm{K}  T^{*}_{\\text{crit}}$. Prediction: False. Correct.\n\n**Case 4:** $(T=6000\\ \\mathrm{K}, T_v=12000\\ \\mathrm{K}, y=\\text{False})$\n$T^{*}_{\\text{Park}} = (6000+12000)/2 = 9000\\ \\mathrm{K} \\ge T^{*}_{\\text{crit}}$. Prediction: True. Incorrect.\n$T^{*}_{\\text{MT}} = 2(6000)(12000)/(6000+12000) = 8000\\ \\mathrm{K}  T^{*}_{\\text{crit}}$. Prediction: False. Correct.\n\n**Case 5:** $(T=8000\\ \\mathrm{K}, T_v=8000\\ \\mathrm{K}, y=\\text{False})$\n$T^{*}_{\\text{Park}} = (8000+8000)/2 = 8000\\ \\mathrm{K}  T^{*}_{\\text{crit}}$. Prediction: False. Correct.\n$T^{*}_{\\text{MT}} = 2(8000)(8000)/(8000+8000) = 8000\\ \\mathrm{K}  T^{*}_{\\text{crit}}$. Prediction: False. Correct.\n\n**Case 6:** $(T=9000\\ \\mathrm{K}, T_v=12000\\ \\mathrm{K}, y=\\text{True})$\n$T^{*}_{\\text{Park}} = (9000+12000)/2 = 10500\\ \\mathrm{K} \\ge T^{*}_{\\text{crit}}$. Prediction: True. Correct.\n$T^{*}_{\\text{MT}} = 2(9000)(12000)/(9000+12000) \\approx 10285.7\\ \\mathrm{K} \\ge T^{*}_{\\text{crit}}$. Prediction: True. Correct.\n\n**Case 7:** $(T=10000\\ \\mathrm{K}, T_v=7000\\ \\mathrm{K}, y=\\text{True})$\n$T^{*}_{\\text{Park}} = (10000+7000)/2 = 8500\\ \\mathrm{K} \\ge T^{*}_{\\text{crit}}$. Prediction: True. Correct.\n$T^{*}_{\\text{MT}} = 2(10000)(7000)/(10000+7000) \\approx 8235.3\\ \\mathrm{K} \\ge T^{*}_{\\text{crit}}$. Prediction: True. Correct.\n\n**Case 8:** $(T=7000\\ \\mathrm{K}, T_v=10000\\ \\mathrm{K}, y=\\text{True})$\n$T^{*}_{\\text{Park}} = (7000+10000)/2 = 8500\\ \\mathrm{K} \\ge T^{*}_{\\text{crit}}$. Prediction: True. Correct.\n$T^{*}_{\\text{MT}} = 2(7000)(10000)/(7000+10000) \\approx 8235.3\\ \\mathrm{K} \\ge T^{*}_{\\text{crit}}$. Prediction: True. Correct.\n\nWe summarize the per-case correctness and total misclassifications.\n\n**Park's Model Results:**\n- Per-case correctness: [True, True, True, False, True, True, True, True]\n- Total misclassifications ($m_{\\text{Park}}$): $1$\n\n**Alternative Model Results:**\n- Per-case correctness: [True, True, True, True, True, True, True, True]\n- Total misclassifications ($m_{\\text{MT}}$): $0$\n\n**Model Comparison:**\nPark's model has $m_{\\text{Park}} = 1$ misclassification, while the alternative model has $m_{\\text{MT}} = 0$ misclassifications.\nSince $m_{\\text{MT}}  m_{\\text{Park}}$, the alternative model is better according to the problem's criteria. The indicator for the better model is $1$.\n\nThe final output values are:\n1. Park's correctness list: `[True, True, True, False, True, True, True, True]`\n2. Alternative model's correctness list: `[True, True, True, True, True, True, True, True]`\n3. Park's misclassification count: $1$\n4. Alternative model's misclassification count: $0$\n5. Better-model indicator: $1$",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nitrogen dissociation onset prediction problem for two\n    multi-temperature models and evaluates their performance.\n    \"\"\"\n    \n    # Fundamental constants and problem parameters\n    A = 1e9  # s^-1\n    n = 0.0  # dimensionless\n    E_d = 9.76 * 96485  # J/mol\n    R = 8.314  # J/(mol*K)\n    tau_c = 1e-3  # s\n    \n    # Onset condition parameters\n    k_onset = 1.0 / tau_c  # s^-1\n    \n    # Blending coefficients for the two models\n    s_park = 0.5\n    w_mt = 0.5\n    \n    # Validation dataset: (T, T_v, observed_onset)\n    test_cases = [\n        (4000.0, 4000.0, False),\n        (4000.0, 8000.0, False),\n        (6000.0, 6000.0, False),\n        (6000.0, 12000.0, False),\n        (8000.0, 8000.0, False),\n        (9000.0, 12000.0, True),\n        (10000.0, 7000.0, True),\n        (7000.0, 10000.0, True),\n    ]\n\n    # Calculate the critical effective temperature for dissociation onset.\n    # k_onset = A * exp(-E_d / (R * T_crit))\n    # ln(k_onset / A) = -E_d / (R * T_crit)\n    # T_crit = -E_d / (R * ln(k_onset / A))\n    T_crit = -E_d / (R * np.log(k_onset / A))\n\n    park_correctness = []\n    mt_correctness = []\n\n    misclass_park = 0\n    misclass_mt = 0\n\n    for case in test_cases:\n        T, T_v, y_obs = case\n\n        # Park's Model (Arithmetic Mean for s=0.5)\n        T_star_park = T + s_park * (T_v - T)\n        y_pred_park = T_star_park >= T_crit\n        is_correct_park = (y_pred_park == y_obs)\n        park_correctness.append(is_correct_park)\n        if not is_correct_park:\n            misclass_park += 1\n\n        # Alternative Model (Harmonic Mean for w=0.5)\n        # Handle T_v=0 case to avoid division by zero, though not present in test data.\n        if T == 0 or T_v == 0:\n             T_star_mt = 0.0\n        else:\n             T_star_mt = 1.0 / ((1.0 - w_mt) / T + w_mt / T_v)\n\n        y_pred_mt = T_star_mt >= T_crit\n        is_correct_mt = (y_pred_mt == y_obs)\n        mt_correctness.append(is_correct_mt)\n        if not is_correct_mt:\n            misclass_mt += 1\n            \n    # Determine the better model\n    # 0: Park's model is better\n    # 1: Alternative model is better\n    # 2: Tie\n    if misclass_park  misclass_mt:\n        better_model_indicator = 0\n    elif misclass_mt  misclass_park:\n        better_model_indicator = 1\n    else:\n        better_model_indicator = 2\n\n    # Format the final output string exactly as required.\n    # The output should be a single-line string representing a list\n    # containing two lists of booleans and three integers.\n    final_list = [park_correctness, mt_correctness, misclass_park, misclass_mt, better_model_indicator]\n    print(str(final_list))\n\nsolve()\n```"
        },
        {
            "introduction": "The coupled equations for finite-rate chemistry and energy relaxation are often mathematically 'stiff,' demanding specialized numerical techniques for stable and efficient solution. This exercise  demonstrates the point-implicit method, a cornerstone of modern CFD solvers for reacting flows. You will derive and implement a linearized backward Euler update, learning how to construct the local matrix system that overcomes the challenge of stiffness.",
            "id": "3977830",
            "problem": "Consider a multi-temperature model in Computational Fluid Dynamics (CFD) for high-temperature gases with finite-rate chemistry, where species mass fractions and the vibrational temperature are evolved locally in time using point-implicit integration. Let there be $N_s$ chemical species with mass fractions $Y_i$ for $i \\in \\{1,\\dots,N_s\\}$, mass density $\\rho$, and vibrational temperature $T_v$. Assume the following local ordinary differential equations for species mass fractions and vibrational temperature:\n$$\n\\frac{d Y_i}{dt} = \\frac{\\omega_i(Y_1,\\dots,Y_{N_s},T_v)}{\\rho}, \\quad i = 1,\\dots,N_s,\n$$\n$$\n\\rho \\, c_{v,v} \\, \\frac{d T_v}{dt} = S_v(Y_1,\\dots,Y_{N_s},T_v),\n$$\nwhere $\\omega_i$ are the finite-rate chemistry source terms for mass production and $S_v$ is the vibrational energy source term, and $c_{v,v}$ is the vibrational specific heat at constant volume.\n\nYou will construct a backward Euler, point-implicit update for the vector of unknown increments $\\Delta Y_i = Y_i^{n+1} - Y_i^n$ and $\\Delta T_v = T_v^{n+1}-T_v^n$ by linearizing the source terms at the known state $(Y^n, T_v^n)$ using a first-order Taylor expansion. Let $\\Delta t$ be the timestep. Define at time level $n$ the source values and their partial derivatives\n$$\n\\omega_i^n = \\omega_i(Y^n,T_v^n), \\quad \\left.\\frac{\\partial \\omega_i}{\\partial Y_j}\\right|_n, \\quad \\left.\\frac{\\partial \\omega_i}{\\partial T_v}\\right|_n,\n$$\n$$\nS_v^n = S_v(Y^n,T_v^n), \\quad \\left.\\frac{\\partial S_v}{\\partial Y_j}\\right|_n, \\quad \\left.\\frac{\\partial S_v}{\\partial T_v}\\right|_n.\n$$\nUsing backward Euler and linearization, derive the local linear system for the unknown increments $\\Delta Y_i$ and $\\Delta T_v$, write it in matrix form, and specify the expressions for all matrix entries and right-hand side components in terms of $\\rho$, $\\Delta t$, $c_{v,v}$, and the given source values and derivatives at time level $n$.\n\nThen implement a program that, for each provided test case, constructs and solves this local linear system to obtain the updated values $Y_i^{n+1}$ and $T_v^{n+1}$.\n\nUse the following test suite, each case specified by $(N_s, \\rho, \\Delta t, Y^n, T_v^n, \\omega^n, \\partial \\omega/\\partial Y|_n, \\partial \\omega/\\partial T_v|_n, S_v^n, \\partial S_v/\\partial Y|_n, \\partial S_v/\\partial T_v|_n, c_{v,v})$. All quantities are in International System of Units (SI); the vibrational temperature must be reported in kelvin and species mass fractions are dimensionless.\n\n- Test Case $1$ (general case):\n  - $N_s = 2$\n  - $\\rho = 0.5 \\,\\mathrm{kg/m^3}$\n  - $\\Delta t = 1.0\\times 10^{-3} \\,\\mathrm{s}$\n  - $Y^n = [0.8,\\,0.2]$\n  - $T_v^n = 7000 \\,\\mathrm{K}$\n  - $\\omega^n = [-1.0\\times 10^{-3},\\, 1.0\\times 10^{-3}] \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial Y}\\right|_n = \\begin{bmatrix} -0.2  0.2 \\\\ 0.2  -0.2 \\end{bmatrix} \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial T_v}\\right|_n = [0.0,\\,0.0] \\,\\mathrm{kg/(m^3 \\cdot s \\cdot K)}$\n  - $S_v^n = -2000 \\,\\mathrm{W/m^3}$\n  - $\\left.\\frac{\\partial S_v}{\\partial Y}\\right|_n = [100,\\,-100] \\,\\mathrm{W/(m^3)}$\n  - $\\left.\\frac{\\partial S_v}{\\partial T_v}\\right|_n = -5000 \\,\\mathrm{W/(m^3 \\cdot K)}$\n  - $c_{v,v} = 1000 \\,\\mathrm{J/(kg \\cdot K)}$\n\n- Test Case $2$ (stiff coupling):\n  - $N_s = 3$\n  - $\\rho = 0.2 \\,\\mathrm{kg/m^3}$\n  - $\\Delta t = 2.0\\times 10^{-5} \\,\\mathrm{s}$\n  - $Y^n = [0.6,\\,0.3,\\,0.1]$\n  - $T_v^n = 9000 \\,\\mathrm{K}$\n  - $\\omega^n = [-1.0\\times 10^{-2},\\, 8.0\\times 10^{-3},\\, 2.0\\times 10^{-3}] \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial Y}\\right|_n = \\begin{bmatrix} -10.0  8.0  2.0 \\\\ 10.0  -12.0  2.0 \\\\ 0.0  4.0  -4.0 \\end{bmatrix} \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial T_v}\\right|_n = [0.5,\\,-0.3,\\,-0.2] \\,\\mathrm{kg/(m^3 \\cdot s \\cdot K)}$\n  - $S_v^n = -5.0\\times 10^{5} \\,\\mathrm{W/m^3}$\n  - $\\left.\\frac{\\partial S_v}{\\partial Y}\\right|_n = [1.0\\times 10^{4},\\, -5.0\\times 10^{3},\\, 0.0] \\,\\mathrm{W/(m^3)}$\n  - $\\left.\\frac{\\partial S_v}{\\partial T_v}\\right|_n = -2.0\\times 10^{6} \\,\\mathrm{W/(m^3 \\cdot K)}$\n  - $c_{v,v} = 1500 \\,\\mathrm{J/(kg \\cdot K)}$\n\n- Test Case $3$ (edge case with zero sources and zero derivatives):\n  - $N_s = 1$\n  - $\\rho = 1.0 \\,\\mathrm{kg/m^3}$\n  - $\\Delta t = 1.0\\times 10^{-2} \\,\\mathrm{s}$\n  - $Y^n = [1.0]$\n  - $T_v^n = 3000 \\,\\mathrm{K}$\n  - $\\omega^n = [0.0] \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial Y}\\right|_n = \\begin{bmatrix} 0.0 \\end{bmatrix} \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial T_v}\\right|_n = [0.0] \\,\\mathrm{kg/(m^3 \\cdot s \\cdot K)}$\n  - $S_v^n = 0.0 \\,\\mathrm{W/m^3}$\n  - $\\left.\\frac{\\partial S_v}{\\partial Y}\\right|_n = [0.0] \\,\\mathrm{W/(m^3)}$\n  - $\\left.\\frac{\\partial S_v}{\\partial T_v}\\right|_n = 0.0 \\,\\mathrm{W/(m^3 \\cdot K)}$\n  - $c_{v,v} = 1000 \\,\\mathrm{J/(kg \\cdot K)}$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list of updated species mass fractions followed by the updated vibrational temperature. For numerical values, represent each number as a decimal float with six digits after the decimal point. For example, the output format for three cases is $[[Y_1^{n+1},\\dots,Y_{N_s}^{n+1},T_v^{n+1}], [\\dots], [\\dots]]$ with all temperatures in $\\mathrm{K}$ and mass fractions dimensionless.",
            "solution": "The problem requires the derivation and implementation of a point-implicit, backward Euler update scheme for a system of ordinary differential equations (ODEs) describing the evolution of species mass fractions and vibrational temperature in a high-temperature gas. This is a common and fundamental technique in computational fluid dynamics (CFD) for handling stiff source terms associated with chemical reactions and energy exchange.\n\nThe governing local ODEs are given by:\n$$\n\\frac{d Y_i}{dt} = \\frac{\\omega_i(Y_1,\\dots,Y_{N_s},T_v)}{\\rho}, \\quad i = 1,\\dots,N_s\n$$\n$$\n\\rho \\, c_{v,v} \\, \\frac{d T_v}{dt} = S_v(Y_1,\\dots,Y_{N_s},T_v)\n$$\nwhere $Y_i$ are the species mass fractions, $T_v$ is the vibrational temperature, $\\rho$ is the mass density, $c_{v,v}$ is the vibrational specific heat at constant volume, $\\omega_i$ are the species mass production source terms, and $S_v$ is the vibrational energy source term. The number of species is denoted by $N_s$.\n\nWe can consolidate this system into a single vector equation. Let the state vector be $\\vec{U} \\in \\mathbb{R}^{N_s+1}$ defined as $\\vec{U} = [Y_1, \\dots, Y_{N_s}, T_v]^T$. The system of ODEs can then be written compactly as $\\frac{d\\vec{U}}{dt} = \\vec{F}(\\vec{U})$, where the components of the source function $\\vec{F}$ are:\n$$\nF_i(\\vec{U}) = \\frac{\\omega_i(\\vec{U})}{\\rho} \\quad \\text{for } i \\in \\{1, \\dots, N_s\\}\n$$\n$$\nF_{N_s+1}(\\vec{U}) = \\frac{S_v(\\vec{U})}{\\rho c_{v,v}}\n$$\n\nThe backward Euler method, an first-order accurate implicit integration scheme, is used to discretize the ODE system in time:\n$$\n\\frac{\\vec{U}^{n+1} - \\vec{U}^n}{\\Delta t} = \\vec{F}(\\vec{U}^{n+1})\n$$\nwhere $\\vec{U}^n$ is the known state at the current time level $n$, $\\vec{U}^{n+1}$ is the unknown state at the new time level $n+1$, and $\\Delta t$ is the timestep.\n\nThis equation represents a system of nonlinear algebraic equations for the unknown state $\\vec{U}^{n+1}$. To solve it efficiently, we linearize the source function $\\vec{F}(\\vec{U}^{n+1})$ around the known state $\\vec{U}^n$ using a first-order Taylor series expansion:\n$$\n\\vec{F}(\\vec{U}^{n+1}) \\approx \\vec{F}(\\vec{U}^n) + \\mathbf{J}_F(\\vec{U}^n) (\\vec{U}^{n+1} - \\vec{U}^n)\n$$\nwhere $\\mathbf{J}_F(\\vec{U}^n) = \\left. \\frac{\\partial \\vec{F}}{\\partial \\vec{U}} \\right|_n$ is the Jacobian matrix of the source function $\\vec{F}$, evaluated at time level $n$. Let the unknown increment vector be $\\Delta \\vec{U} = \\vec{U}^{n+1} - \\vec{U}^n$. Substituting the linearization into the backward Euler formula yields:\n$$\n\\frac{\\Delta \\vec{U}}{\\Delta t} \\approx \\vec{F}(\\vec{U}^n) + \\mathbf{J}_F(\\vec{U}^n) \\Delta \\vec{U}\n$$\nThis is a linear system for the increment vector $\\Delta \\vec{U}$. We rearrange it into the standard form $\\mathbf{A} \\vec{x} = \\vec{b}$:\n$$\n\\left( \\frac{\\mathbf{I}}{\\Delta t} - \\mathbf{J}_F(\\vec{U}^n) \\right) \\Delta \\vec{U} = \\vec{F}(\\vec{U}^n)\n$$\nMultiplying both sides by $\\Delta t$ gives the final form of the local linear system:\n$$\n\\left( \\mathbf{I} - \\Delta t \\, \\mathbf{J}_F(\\vec{U}^n) \\right) \\Delta \\vec{U} = \\Delta t \\, \\vec{F}(\\vec{U}^n)\n$$\nwhere $\\mathbf{I}$ is the $(N_s+1) \\times (N_s+1)$ identity matrix.\n\nThe next step is to derive the explicit expressions for the entries of the system matrix and the right-hand side vector in terms of the quantities provided in the problem statement. The system matrix is $\\mathbf{A} = \\mathbf{I} - \\Delta t \\, \\mathbf{J}_F(\\vec{U}^n)$ and the right-hand side vector is $\\vec{b} = \\Delta t \\, \\vec{F}(\\vec{U}^n)$. The vector of unknowns is $\\Delta\\vec{U} = [\\Delta Y_1, \\dots, \\Delta Y_{N_s}, \\Delta T_v]^T$.\n\nFirst, we determine the components of the Jacobian matrix $\\mathbf{J}_F$ by taking the partial derivatives of the components of $\\vec{F}$:\nFor the species equations ($i \\in \\{1, \\dots, N_s\\}$):\n$$\n(\\mathbf{J}_F)_{ij} = \\frac{\\partial F_i}{\\partial Y_j} = \\frac{\\partial}{\\partial Y_j} \\left( \\frac{\\omega_i}{\\rho} \\right) = \\frac{1}{\\rho} \\frac{\\partial \\omega_i}{\\partial Y_j} \\quad \\text{for } j \\in \\{1, \\dots, N_s\\}\n$$\n$$\n(\\mathbf{J}_F)_{i, N_s+1} = \\frac{\\partial F_i}{\\partial T_v} = \\frac{\\partial}{\\partial T_v} \\left( \\frac{\\omega_i}{\\rho} \\right) = \\frac{1}{\\rho} \\frac{\\partial \\omega_i}{\\partial T_v}\n$$\nFor the vibrational energy equation (row $N_s+1$):\n$$\n(\\mathbf{J}_F)_{N_s+1, j} = \\frac{\\partial F_{N_s+1}}{\\partial Y_j} = \\frac{\\partial}{\\partial Y_j} \\left( \\frac{S_v}{\\rho c_{v,v}} \\right) = \\frac{1}{\\rho c_{v,v}} \\frac{\\partial S_v}{\\partial Y_j} \\quad \\text{for } j \\in \\{1, \\dots, N_s\\}\n$$\n$$\n(\\mathbf{J}_F)_{N_s+1, N_s+1} = \\frac{\\partial F_{N_s+1}}{\\partial T_v} = \\frac{\\partial}{\\partial T_v} \\left( \\frac{S_v}{\\rho c_{v,v}} \\right) = \\frac{1}{\\rho c_{v,v}} \\frac{\\partial S_v}{\\partial T_v}\n$$\nAll derivatives are evaluated at the known state $\\vec{U}^n$.\n\nNow we can specify the entries of the matrix $\\mathbf{A}$ and vector $\\vec{b}$.\n\n**Matrix Entries of $\\mathbf{A}$ in $\\mathbf{A} \\Delta\\vec{U} = \\vec{b}$:**\nThe matrix $\\mathbf{A}$ is of size $(N_s+1) \\times (N_s+1)$.\n\n1.  Upper-left block ($N_s \\times N_s$), for $i \\in \\{1, \\dots, N_s\\}$ and $j \\in \\{1, \\dots, N_s\\}$:\n    $$\n    A_{ij} = (\\mathbf{I} - \\Delta t \\, \\mathbf{J}_F)_{ij} = \\delta_{ij} - \\Delta t \\, (\\mathbf{J}_F)_{ij} = \\delta_{ij} - \\frac{\\Delta t}{\\rho} \\left. \\frac{\\partial \\omega_i}{\\partial Y_j} \\right|_n\n    $$\n    where $\\delta_{ij}$ is the Kronecker delta.\n\n2.  Upper-right block ($N_s \\times 1$), the column coupled with $\\Delta T_v$, for $i \\in \\{1, \\dots, N_s\\}$:\n    $$\n    A_{i, N_s+1} = -\\Delta t \\, (\\mathbf{J}_F)_{i, N_s+1} = - \\frac{\\Delta t}{\\rho} \\left. \\frac{\\partial \\omega_i}{\\partial T_v} \\right|_n\n    $$\n\n3.  Lower-left block ($1 \\times N_s$), the row for the $T_v$ equation, for $j \\in \\{1, \\dots, N_s\\}$:\n    $$\n    A_{N_s+1, j} = -\\Delta t \\, (\\mathbf{J}_F)_{N_s+1, j} = - \\frac{\\Delta t}{\\rho c_{v,v}} \\left. \\frac{\\partial S_v}{\\partial Y_j} \\right|_n\n    $$\n\n4.  Lower-right block ($1 \\times 1$), the diagonal term for the $T_v$ equation:\n    $$\n    A_{N_s+1, N_s+1} = 1 - \\Delta t \\, (\\mathbf{J}_F)_{N_s+1, N_s+1} = 1 - \\frac{\\Delta t}{\\rho c_{v,v}} \\left. \\frac{\\partial S_v}{\\partial T_v} \\right|_n\n    $$\n\n**Right-Hand Side Vector Components of $\\vec{b}$:**\nThe vector $\\vec{b}$ has $N_s+1$ components.\n\n1.  Upper part (first $N_s$ components), corresponding to species equations:\n    $$\n    b_i = \\Delta t \\, F_i(\\vec{U}^n) = \\frac{\\Delta t}{\\rho} \\, \\omega_i^n \\quad \\text{for } i \\in \\{1, \\dots, N_s\\}\n    $$\n\n2.  Lower part (last component), corresponding to the energy equation:\n    $$\n    b_{N_s+1} = \\Delta t \\, F_{N_s+1}(\\vec{U}^n) = \\frac{\\Delta t}{\\rho c_{v,v}} \\, S_v^n\n    $$\n\nAfter constructing the matrix $\\mathbf{A}$ and vector $\\vec{b}$ from the given data at time level $n$, we solve the linear system $\\mathbf{A} \\Delta\\vec{U} = \\vec{b}$ to find the increment vector $\\Delta\\vec{U} = [\\Delta Y_1, \\dots, \\Delta Y_{N_s}, \\Delta T_v]^T$.\n\nFinally, the state variables are updated to the new time level $n+1$:\n$$\nY_i^{n+1} = Y_i^n + \\Delta Y_i, \\quad i = 1, \\dots, N_s\n$$\n$$\nT_v^{n+1} = T_v^n + \\Delta T_v\n$$\nThe following program implements this procedure for the provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and solves the point-implicit linear system for each test case\n    to find the updated species mass fractions and vibrational temperature.\n    \"\"\"\n    test_cases = [\n        {\n            \"Ns\": 2,\n            \"rho\": 0.5,\n            \"dt\": 1.0e-3,\n            \"Yn\": [0.8, 0.2],\n            \"Tvn\": 7000,\n            \"omega_n\": [-1.0e-3, 1.0e-3],\n            \"d_omega_d_Y_n\": [[-0.2, 0.2], [0.2, -0.2]],\n            \"d_omega_d_Tv_n\": [0.0, 0.0],\n            \"Sv_n\": -2000,\n            \"d_Sv_d_Y_n\": [100, -100],\n            \"d_Sv_d_Tv_n\": -5000,\n            \"c_vv\": 1000,\n        },\n        {\n            \"Ns\": 3,\n            \"rho\": 0.2,\n            \"dt\": 2.0e-5,\n            \"Yn\": [0.6, 0.3, 0.1],\n            \"Tvn\": 9000,\n            \"omega_n\": [-1.0e-2, 8.0e-3, 2.0e-3],\n            \"d_omega_d_Y_n\": [[-10.0, 8.0, 2.0], [10.0, -12.0, 2.0], [0.0, 4.0, -4.0]],\n            \"d_omega_d_Tv_n\": [0.5, -0.3, -0.2],\n            \"Sv_n\": -5.0e5,\n            \"d_Sv_d_Y_n\": [1.0e4, -5.0e3, 0.0],\n            \"d_Sv_d_Tv_n\": -2.0e6,\n            \"c_vv\": 1500,\n        },\n        {\n            \"Ns\": 1,\n            \"rho\": 1.0,\n            \"dt\": 1.0e-2,\n            \"Yn\": [1.0],\n            \"Tvn\": 3000,\n            \"omega_n\": [0.0],\n            \"d_omega_d_Y_n\": [[0.0]],\n            \"d_omega_d_Tv_n\": [0.0],\n            \"Sv_n\": 0.0,\n            \"d_Sv_d_Y_n\": [0.0],\n            \"d_Sv_d_Tv_n\": 0.0,\n            \"c_vv\": 1000,\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters\n        Ns = case[\"Ns\"]\n        rho = case[\"rho\"]\n        dt = case[\"dt\"]\n        Yn = np.array(case[\"Yn\"], dtype=float)\n        Tvn = float(case[\"Tvn\"])\n        omega_n = np.array(case[\"omega_n\"], dtype=float)\n        d_omega_d_Y_n = np.array(case[\"d_omega_d_Y_n\"], dtype=float)\n        d_omega_d_Tv_n = np.array(case[\"d_omega_d_Tv_n\"], dtype=float)\n        Sv_n = float(case[\"Sv_n\"])\n        d_Sv_d_Y_n = np.array(case[\"d_Sv_d_Y_n\"], dtype=float)\n        d_Sv_d_Tv_n = float(case[\"d_Sv_d_Tv_n\"])\n        c_vv = float(case[\"c_vv\"])\n\n        # Initialize the matrix A and vector b\n        system_size = Ns + 1\n        A = np.zeros((system_size, system_size))\n        b = np.zeros(system_size)\n\n        # Populate matrix A\n        # Upper-left block (species-species coupling)\n        A[:Ns, :Ns] = np.identity(Ns) - (dt / rho) * d_omega_d_Y_n\n        # Upper-right block (species-temperature coupling)\n        A[:Ns, Ns] = - (dt / rho) * d_omega_d_Tv_n\n        # Lower-left block (temperature-species coupling)\n        A[Ns, :Ns] = - (dt / (rho * c_vv)) * d_Sv_d_Y_n\n        # Lower-right block (temperature-temperature coupling)\n        A[Ns, Ns] = 1 - (dt / (rho * c_vv)) * d_Sv_d_Tv_n\n\n        # Populate vector b\n        # Upper part (species source terms)\n        b[:Ns] = (dt / rho) * omega_n\n        # Lower part (energy source term)\n        b[Ns] = (dt / (rho * c_vv)) * Sv_n\n\n        # Solve the linear system A * delta_U = b\n        delta_U = np.linalg.solve(A, b)\n\n        # Extract increments\n        delta_Y = delta_U[:Ns]\n        delta_Tv = delta_U[Ns]\n\n        # Update the state\n        Y_np1 = Yn + delta_Y\n        Tv_np1 = Tvn + delta_Tv\n\n        # Store the result for this case\n        case_result = list(Y_np1) + [Tv_np1]\n        results.append(case_result)\n\n    # Format the final output string as per requirements\n    formatted_results = []\n    for res_list in results:\n        formatted_nums = [f\"{num:.6f}\" for num in res_list]\n        formatted_results.append(f\"[{','.join(formatted_nums)}]\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}