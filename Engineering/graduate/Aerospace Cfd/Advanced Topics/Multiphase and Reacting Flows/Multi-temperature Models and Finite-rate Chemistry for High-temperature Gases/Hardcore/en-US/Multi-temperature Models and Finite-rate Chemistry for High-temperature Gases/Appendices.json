{
    "hands_on_practices": [
        {
            "introduction": "To accurately model high-temperature flows, we must first correctly describe the thermodynamic state of the gas when it is not in thermal equilibrium. This exercise provides foundational practice in partitioning the total internal energy among the distinct translational-rotational, vibrational, and electronic modes. By calculating these energy contributions , you will develop a quantitative feel for how energy is stored in a multi-temperature plasma, a critical first step in building and interpreting CFD simulations.",
            "id": "3977839",
            "problem": "A hypersonic flow over a blunt body produces a strong shock, followed by a post-shock layer in which thermochemical nonequilibrium arises. In a multi-temperature model for high-temperature gases, the heavy-particle translational-rotational temperature $T$, the diatomic vibrational temperature $T_v$, and the electron temperature $T_e$ are distinct. Consider a spatial point in the post-shock layer of air where the heavy species are nitrogen molecules $\\mathrm{N}_2$ and oxygen atoms $\\mathrm{O}$ with mole fractions $x_{\\mathrm{N}_2} = 0.55$ and $x_{\\mathrm{O}} = 0.45$, respectively, and the free-electron mole fraction relative to the heavy-particle mole content is $\\chi_e = 0.02$. Assume the following temperatures: $T = 6000\\,\\mathrm{K}$, $T_v = 10000\\,\\mathrm{K}$, and $T_e = 12000\\,\\mathrm{K}$. The molecular masses are $M_{\\mathrm{N}_2} = 0.0280134\\,\\mathrm{kg/mol}$ and $M_{\\mathrm{O}} = 0.015999\\,\\mathrm{kg/mol}$, and the universal gas constant is $R_u = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$. The characteristic vibrational temperature for $\\mathrm{N}_2$ is $\\theta_{v,\\mathrm{N}_2} = 3395\\,\\mathrm{K}$. Neglect the electron mass in the mixture molecular weight and any rotational or vibrational contributions from monatomic $\\mathrm{O}$.\n\nStarting from the principles of statistical mechanics and thermodynamics appropriate for Computational Fluid Dynamics (CFD) of high-temperature gases, derive expressions for:\n- the specific rotational energy contribution $e_r(T)$ (per unit mass of mixture) of the diatomic species $\\mathrm{N}_2$ using the equipartition theorem for a linear rigid rotor,\n- the specific vibrational energy contribution $e_v(T_v)$ (per unit mass of mixture) for $\\mathrm{N}_2$ using the quantum harmonic oscillator model,\n- the specific electron translational energy contribution $e_e(T_e)$ (per unit mass of mixture) treating electrons as a monatomic ideal gas.\n\nUse the given composition and temperatures to compute numerical values of $e_r(T)$, $e_v(T_v)$, and $e_e(T_e)$. Then, briefly explain which of these contributions dominates in the post-shock layer and why, based on the nonequilibrium temperature distribution and composition.\n\nExpress each energy in $\\mathrm{kJ/kg}$ and round your answers to four significant figures. The final reported values must be $e_r(T)$, $e_v(T_v)$, and $e_e(T_e)$ in that order.",
            "solution": "The problem is assessed as valid as it is scientifically grounded in the principles of high-temperature gas dynamics, is well-posed with all necessary information provided, and is formulated using objective, formal language. The models and conditions described are standard in the analysis of thermochemical nonequilibrium in hypersonic flows. We proceed with the solution.\n\nThe objective is to compute the specific rotational energy $e_r(T)$, vibrational energy $e_v(T_v)$, and electron translational energy $e_e(T_e)$ per unit mass of a specified gas mixture. The solution requires calculating the mixture's composition in terms of mass and then applying the appropriate statistical mechanics models for each energy mode.\n\nFirst, we determine the properties of the mixture. The heavy-particle mixture consists of $\\mathrm{N}_2$ and $\\mathrm{O}$. The mole fractions are given as $x_{\\mathrm{N}_2} = 0.55$ and $x_{\\mathrm{O}} = 0.45$. The molar masses are $M_{\\mathrm{N}_2} = 0.0280134\\,\\mathrm{kg/mol}$ and $M_{\\mathrm{O}} = 0.015999\\,\\mathrm{kg/mol}$. The average molar mass of the heavy-particle mixture, $M_h$, is a mole-fraction-weighted average:\n$$M_h = \\sum_s x_s M_s = x_{\\mathrm{N}_2} M_{\\mathrm{N}_2} + x_{\\mathrm{O}} M_{\\mathrm{O}}$$\n$$M_h = (0.55)(0.0280134\\,\\mathrm{kg/mol}) + (0.45)(0.015999\\,\\mathrm{kg/mol})$$\n$$M_h = 0.01540737\\,\\mathrm{kg/mol} + 0.00719955\\,\\mathrm{kg/mol} = 0.02260692\\,\\mathrm{kg/mol}$$\nThe problem states to neglect the electron mass in the mixture molecular weight, so the total mixture molar mass $M_{mix}$ is taken to be $M_h$.\n\nThe specific energy contributions are requested per unit mass of the total mixture. Therefore, we need the mass fraction of the contributing species. The mass fraction of $\\mathrm{N}_2$, $Y_{\\mathrm{N}_2}$, is the ratio of the mass of $\\mathrm{N}_2$ to the total mass of heavy particles in a representative sample:\n$$Y_{\\mathrm{N}_2} = \\frac{x_{\\mathrm{N}_2} M_{\\mathrm{N}_2}}{M_h} = \\frac{0.01540737\\,\\mathrm{kg/mol}}{0.02260692\\,\\mathrm{kg/mol}} \\approx 0.6815403$$\n\nNow, we derive and compute the three energy contributions.\n\n**1. Specific Rotational Energy Contribution, $e_r(T)$**\nThe rotational energy of the diatomic species $\\mathrm{N}_2$ is modeled using the equipartition theorem for a linear rigid rotor at the heavy-particle translational-rotational temperature $T = 6000\\,\\mathrm{K}$. A linear molecule has two rotational degrees of freedom. Each degree of freedom contributes $\\frac{1}{2}k_B T$ to the average energy per molecule, where $k_B$ is the Boltzmann constant.\nThe molar rotational energy of $\\mathrm{N}_2$ is:\n$$E_{r, \\mathrm{N}_2}^{\\text{mole}} = N_A \\left( 2 \\times \\frac{1}{2} k_B T \\right) = N_A k_B T = R_u T$$\nwhere $N_A$ is the Avogadro constant and $R_u$ is the universal gas constant. The specific rotational energy of pure $\\mathrm{N}_2$ is $\\frac{R_u T}{M_{\\mathrm{N}_2}}$. The contribution to the specific energy of the mixture is this value weighted by the mass fraction of $\\mathrm{N}_2$, as monatomic $\\mathrm{O}$ has no rotational energy.\n$$e_r(T) = Y_{\\mathrm{N}_2} \\left( \\frac{R_u T}{M_{\\mathrm{N}_2}} \\right)$$\nUsing the given values:\n$$e_r(T) = (0.6815403) \\left( \\frac{(8.314462618\\,\\mathrm{J/(mol\\cdot K)})(6000\\,\\mathrm{K})}{0.0280134\\,\\mathrm{kg/mol}} \\right)$$\n$$e_r(T) \\approx 1213600\\,\\mathrm{J/kg} = 1213.6\\,\\mathrm{kJ/kg}$$\nRounding to four significant figures gives $e_r(T) = 1214\\,\\mathrm{kJ/kg}$.\n\n**2. Specific Vibrational Energy Contribution, $e_v(T_v)$**\nThe vibrational energy of $\\mathrm{N}_2$ is modeled as a quantum harmonic oscillator at the vibrational temperature $T_v = 10000\\,\\mathrm{K}$. The molar vibrational energy of $\\mathrm{N}_2$ is given by:\n$$E_{v, \\mathrm{N}_2}^{\\text{mole}} = R_u \\frac{\\theta_{v,\\mathrm{N}_2}}{\\exp\\left(\\frac{\\theta_{v,\\mathrm{N}_2}}{T_v}\\right) - 1}$$\nwhere $\\theta_{v,\\mathrm{N}_2} = 3395\\,\\mathrm{K}$ is the characteristic vibrational temperature for $\\mathrm{N}_2$. The contribution to the specific energy of the mixture is the specific vibrational energy of $\\mathrm{N}_2$ weighted by its mass fraction:\n$$e_v(T_v) = Y_{\\mathrm{N}_2} \\left( \\frac{R_u \\theta_{v,\\mathrm{N}_2}}{M_{\\mathrm{N}_2} \\left(\\exp\\left(\\frac{\\theta_{v,\\mathrm{N}_2}}{T_v}\\right) - 1\\right)} \\right)$$\nFirst, we compute the exponential term's argument: $\\frac{\\theta_{v,\\mathrm{N}_2}}{T_v} = \\frac{3395\\,\\mathrm{K}}{10000\\,\\mathrm{K}} = 0.3395$.\n$$e_v(T_v) = (0.6815403) \\left( \\frac{(8.314462618\\,\\mathrm{J/(mol\\cdot K)})(3395\\,\\mathrm{K})}{(0.0280134\\,\\mathrm{kg/mol}) (\\exp(0.3395) - 1)} \\right)$$\n$$e_v(T_v) = (0.6815403) \\left( \\frac{28227.599\\,\\mathrm{J/mol}}{(0.0280134\\,\\mathrm{kg/mol}) (1.404260 - 1)} \\right)$$\n$$e_v(T_v) \\approx 1698539\\,\\mathrm{J/kg} = 1698.539\\,\\mathrm{kJ/kg}$$\nRounding to four significant figures gives $e_v(T_v) = 1699\\,\\mathrm{kJ/kg}$.\n\n**3. Specific Electron Translational Energy Contribution, $e_e(T_e)$**\nThe electrons are treated as a monatomic ideal gas at the electron temperature $T_e = 12000\\,\\mathrm{K}$. A monatomic particle has three translational degrees of freedom. The molar translational energy of the electrons is:\n$$E_{e}^{\\text{mole}} = N_A \\left( 3 \\times \\frac{1}{2} k_B T_e \\right) = \\frac{3}{2} R_u T_e$$\nThe specific electron energy per unit mass of the mixture is the total electron energy in a sample divided by the total mass of that sample. Consider a sample containing one mole of heavy particles ($n_h = 1\\,\\mathrm{mol}$). The number of moles of electrons is $n_e = \\chi_e n_h = 0.02\\,\\mathrm{mol}$. The total mass of this sample (neglecting electron mass) is $m_{total} = n_h M_h = M_h$.\nThe total electron energy in this sample is $E_{e,total} = n_e E_{e}^{\\text{mole}} = \\chi_e \\frac{3}{2} R_u T_e$.\nThe specific energy contribution is then:\n$$e_e(T_e) = \\frac{E_{e,total}}{m_{total}} = \\frac{\\chi_e \\frac{3}{2} R_u T_e}{M_h}$$\nUsing the given values:\n$$e_e(T_e) = \\frac{(0.02) \\times \\frac{3}{2} \\times (8.314462618\\,\\mathrm{J/(mol\\cdot K)})(12000\\,\\mathrm{K})}{0.02260692\\,\\mathrm{kg/mol}}$$\n$$e_e(T_e) = \\frac{2993.2065\\,\\mathrm{J/mol}}{0.02260692\\,\\mathrm{kg/mol}} \\approx 132401\\,\\mathrm{J/kg} = 132.401\\,\\mathrm{kJ/kg}$$\nRounding to four significant figures gives $e_e(T_e) = 132.4\\,\\mathrm{kJ/kg}$.\n\n**Comparison and Explanation**\nThe computed specific energy contributions are $e_r \\approx 1214\\,\\mathrm{kJ/kg}$, $e_v \\approx 1699\\,\\mathrm{kJ/kg}$, and $e_e \\approx 132.4\\,\\mathrm{kJ/kg}$.\nThe specific vibrational energy, $e_v(T_v)$, is the dominant contribution to the internal energy partitioning considered here. This is primarily due to the very high vibrational temperature $T_v = 10000\\,\\mathrm{K}$, which is significantly greater than both the heavy-particle temperature $T = 6000\\,\\mathrm{K}$ and the characteristic vibrational temperature $\\theta_{v,\\mathrm{N}_2} = 3395\\,\\mathrm{K}$. The high value of $T_v$ indicates that the vibrational modes of $\\mathrm{N}_2$ are highly excited, storing a large amount of energy. Although the electron temperature $T_e = 12000\\,\\mathrm{K}$ is the highest, the specific electron energy contribution $e_e(T_e)$ is the smallest. This is because the specific energy is an energy per unit mass of the *mixture*. The electron mole fraction $\\chi_e=0.02$ is small, and more importantly, the molar mass of electrons is negligible compared to that of the heavy particles. Thus, while individual electrons are very energetic, their contribution to the total energy of a unit mass of the gas mixture is small because their mass is a minuscule fraction of that total mass. The rotational energy contribution is significant because of the high heavy-particle temperature $T$ and the substantial mass fraction of the diatomic species $\\mathrm{N}_2$, but it is surpassed by the highly excited vibrational energy.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1214 & 1699 & 132.4\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "With the thermodynamic state defined, the next step is to model the dynamic processes that drive the system towards equilibrium. This practice focuses on the Landau-Teller model, which describes the rate of energy exchange between the translational and vibrational modes. By deriving the analytical solution for vibrational temperature relaxation , you will gain insight into the fundamental exponential nature of this process and the concept of a characteristic relaxation time, which governs the scale of the non-equilibrium region in flows.",
            "id": "3977827",
            "problem": "Consider a spatially uniform, stagnant parcel of a high-temperature diatomic gas modeled with a two-temperature framework in Computational Fluid Dynamics (CFD), where the translational-rotational temperature is denoted by $T(t)$ and the vibrational temperature is denoted by $T_{v}(t)$. Assume chemistry is frozen and ignore convection and diffusion. Let the vibrational energy per unit mass be $e_{v}(t)$ and its local thermodynamic equilibrium value with respect to the translational-rotational mode be $e_{v}^{\\ast}(T(t))$. The vibrational energy exchange between modes is described by a widely accepted linear relaxation law with a characteristic vibrational relaxation time $\\tau_{v}$:\n$$\n\\frac{d e_{v}}{d t} = \\frac{e_{v}^{\\ast}(T) - e_{v}}{\\tau_{v}} \\quad \\text{for} \\quad t \\ge 0.\n$$\nAt time $t=0$, an external impulsive heating event instantaneously raises the translational-rotational temperature from the pre-shock value $T(0^{-}) = T_{i}$ to a post-shock plateau $T(t) = T_{f}$ for all $t \\ge 0$. Assume the vibrational temperature is initially in equilibrium with the pre-shock state, $T_{v}(0^{-}) = T_{i}$. For $t \\ge 0$, take the vibrational relaxation time to be constant, $\\tau_{v} = \\text{const}$, and adopt the constant vibrational specific heat approximation $c_{v,v} = \\text{const}$ such that\n$$\ne_{v}(t) = c_{v,v} \\, T_{v}(t), \\qquad e_{v}^{\\ast}(T(t)) = c_{v,v} \\, T(t).\n$$\nStarting from the stated energy relaxation law and these definitions, derive the ordinary differential equation (ODE) governing $T_{v}(t)$ for $t \\ge 0$ and solve it analytically for the step change in $T$ at $t=0$. Use the initial condition $T_{v}(0)=T_{i}$ (corresponding to the instant just after the step in $T$). Express the final answer as a single closed-form analytical expression for $T_{v}(t)$ in terms of $t$, $T_{i}$, $T_{f}$, and $\\tau_{v}$. You do not need to include units in the expression; treat $T$ and $T_{v}$ as temperatures measured in Kelvin. No numerical evaluation is required.",
            "solution": "The problem statement is evaluated for validity before proceeding with a solution.\n\n**Step 1: Extract Givens**\nThe following information is provided in the problem statement:\n- The system is a spatially uniform, stagnant parcel of a high-temperature diatomic gas.\n- The model is a two-temperature framework with translational-rotational temperature $T(t)$ and vibrational temperature $T_v(t)$.\n- Chemistry is frozen; convection and diffusion are ignored.\n- The vibrational energy per unit mass is $e_v(t)$.\n- The local thermodynamic equilibrium vibrational energy is $e_v^{\\ast}(T(t))$.\n- The governing equation for vibrational energy relaxation for $t \\ge 0$ is:\n$$ \\frac{d e_{v}}{d t} = \\frac{e_{v}^{\\ast}(T) - e_{v}}{\\tau_{v}} $$\n- An impulsive heating event occurs at $t=0$.\n- The pre-shock translational-rotational temperature is $T(0^{-}) = T_i$.\n- The post-shock translational-rotational temperature is $T(t) = T_f$ for all $t \\ge 0$.\n- The initial condition for the vibrational temperature is $T_v(0^{-}) = T_i$.\n- The vibrational relaxation time is constant: $\\tau_v = \\text{const}$.\n- The vibrational specific heat is constant: $c_{v,v} = \\text{const}$.\n- The relationships between energy and temperature are:\n$$ e_{v}(t) = c_{v,v} \\, T_{v}(t) $$\n$$ e_{v}^{\\ast}(T(t)) = c_{v,v} \\, T(t) $$\n- The initial condition for the differential equation to be solved for $t \\ge 0$ is $T_v(0) = T_i$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-defined and scientifically grounded. It describes a classic problem in non-equilibrium gas dynamics: the relaxation of vibrational temperature in a gas parcel subjected to a sudden increase in translational temperature, as is characteristic of the region behind a normal shock wave. The governing equation is the standard Landau-Teller relaxation model. The assumptions of constant vibrational specific heat and constant relaxation time are common and valid simplifications for deriving analytical solutions. The problem is self-contained, with all necessary equations and initial conditions provided. It is a well-posed initial value problem for a first-order ordinary differential equation, which admits a unique, stable solution. The problem statement contains no scientific or factual unsoundness, no contradictions, and no ambiguities.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be derived.\n\n**Derivation of the Solution**\nThe goal is to derive and solve the ordinary differential equation (ODE) for the vibrational temperature $T_v(t)$.\n\nFirst, we substitute the given constitutive relations for $e_v$ and $e_v^{\\ast}$ into the vibrational energy relaxation equation.\nThe relaxation law is:\n$$ \\frac{d e_{v}}{d t} = \\frac{e_{v}^{\\ast}(T) - e_{v}}{\\tau_{v}} $$\nSubstituting $e_{v}(t) = c_{v,v} T_{v}(t)$ and $e_{v}^{\\ast}(T(t)) = c_{v,v} T(t)$:\n$$ \\frac{d}{dt} (c_{v,v} T_{v}) = \\frac{c_{v,v} T - c_{v,v} T_{v}}{\\tau_{v}} $$\nSince $c_{v,v}$ is a constant, it can be taken out of the time derivative and factored out on the right-hand side:\n$$ c_{v,v} \\frac{d T_{v}}{d t} = \\frac{c_{v,v} (T - T_{v})}{\\tau_{v}} $$\nDividing both sides by the non-zero constant $c_{v,v}$ yields the ODE for the vibrational temperature $T_v(t)$ in terms of the translational-rotational temperature $T(t)$:\n$$ \\frac{d T_{v}}{d t} = \\frac{T(t) - T_{v}(t)}{\\tau_{v}} $$\nThe problem specifies that for $t \\ge 0$, the translational-rotational temperature is constant at the post-shock value, $T(t) = T_f$. Substituting this into the ODE gives:\n$$ \\frac{d T_{v}}{d t} = \\frac{T_{f} - T_{v}}{\\tau_{v}} $$\nThis is a first-order linear inhomogeneous ordinary differential equation. It can be solved using the method of separation of variables. We rearrange the equation to separate the variables $T_v$ and $t$:\n$$ \\frac{d T_{v}}{T_{f} - T_{v}} = \\frac{dt}{\\tau_{v}} $$\nWe integrate both sides of the equation. The integration on the left side is with respect to $T_v$ from its initial value $T_v(0)$ to its value at a later time $T_v(t)$, and on the right side with respect to time from $0$ to $t$:\n$$ \\int_{T_{v}(0)}^{T_{v}(t)} \\frac{d T'_{v}}{T_{f} - T'_{v}} = \\int_{0}^{t} \\frac{d t'}{\\tau_{v}} $$\nThe integral on the left yields a natural logarithm:\n$$ \\left[ -\\ln(T_{f} - T'_{v}) \\right]_{T_{v}(0)}^{T_{v}(t)} = \\left[ \\frac{t'}{\\tau_{v}} \\right]_{0}^{t} $$\nUsing the initial condition $T_v(0) = T_i$:\n$$ -\\ln(T_{f} - T_{v}(t)) - (-\\ln(T_{f} - T_{i})) = \\frac{t}{\\tau_{v}} $$\n$$ \\ln(T_{f} - T_{i}) - \\ln(T_{f} - T_{v}(t)) = \\frac{t}{\\tau_{v}} $$\nUsing the property of logarithms, $\\ln(a) - \\ln(b) = \\ln(a/b)$:\n$$ \\ln\\left(\\frac{T_{f} - T_{i}}{T_{f} - T_{v}(t)}\\right) = \\frac{t}{\\tau_{v}} $$\nTo solve for $T_v(t)$, we exponentiate both sides:\n$$ \\frac{T_{f} - T_{i}}{T_{f} - T_{v}(t)} = \\exp\\left(\\frac{t}{\\tau_{v}}\\right) $$\nNow, we algebraically rearrange the equation to isolate $T_v(t)$:\n$$ T_{f} - T_{v}(t) = (T_{f} - T_{i}) \\exp\\left(-\\frac{t}{\\tau_{v}}\\right) $$\n$$ T_{v}(t) = T_{f} - (T_{f} - T_{i}) \\exp\\left(-\\frac{t}{\\tau_{v}}\\right) $$\nThis expression describes the evolution of the vibrational temperature from its initial value $T_i$ as it relaxes towards the new equilibrium temperature $T_f$ with a characteristic time scale $\\tau_v$.\nAt $t=0$, $T_v(0) = T_f - (T_f - T_i)\\exp(0) = T_f - (T_f - T_i) = T_i$, which satisfies the initial condition.\nAs $t \\to \\infty$, $T_v(t) \\to T_f - (T_f - T_i)(0) = T_f$, which is the expected equilibrium state.\nThe derived expression is the correct analytical solution.",
            "answer": "$$\\boxed{T_{v}(t) = T_{f} - (T_{f} - T_{i}) \\exp\\left(-\\frac{t}{\\tau_{v}}\\right)}$$"
        },
        {
            "introduction": "The physics of finite-rate chemistry and multi-temperature relaxation leads to systems of equations that are numerically 'stiff,' posing a significant challenge for standard time-integration schemes. This hands-on practice bridges the gap between physical models and their computational implementation by guiding you through the construction of a point-implicit solver. Deriving the linearized system for a backward Euler update  is an essential skill, revealing the core technique used in robust CFD codes to handle stiff source terms efficiently and stably.",
            "id": "3977830",
            "problem": "Consider a multi-temperature model in Computational Fluid Dynamics (CFD) for high-temperature gases with finite-rate chemistry, where species mass fractions and the vibrational temperature are evolved locally in time using point-implicit integration. Let there be $N_s$ chemical species with mass fractions $Y_i$ for $i \\in \\{1,\\dots,N_s\\}$, mass density $\\rho$, and vibrational temperature $T_v$. Assume the following local ordinary differential equations for species mass fractions and vibrational temperature:\n$$\n\\frac{d Y_i}{dt} = \\frac{\\omega_i(Y_1,\\dots,Y_{N_s},T_v)}{\\rho}, \\quad i = 1,\\dots,N_s,\n$$\n$$\n\\rho \\, c_{v,v} \\, \\frac{d T_v}{dt} = S_v(Y_1,\\dots,Y_{N_s},T_v),\n$$\nwhere $\\omega_i$ are the finite-rate chemistry source terms for mass production and $S_v$ is the vibrational energy source term, and $c_{v,v}$ is the vibrational specific heat at constant volume.\n\nYou will construct a backward Euler, point-implicit update for the vector of unknown increments $\\Delta Y_i = Y_i^{n+1} - Y_i^n$ and $\\Delta T_v = T_v^{n+1}-T_v^n$ by linearizing the source terms at the known state $(Y^n, T_v^n)$ using a first-order Taylor expansion. Let $\\Delta t$ be the timestep. Define at time level $n$ the source values and their partial derivatives\n$$\n\\omega_i^n = \\omega_i(Y^n,T_v^n), \\quad \\left.\\frac{\\partial \\omega_i}{\\partial Y_j}\\right|_n, \\quad \\left.\\frac{\\partial \\omega_i}{\\partial T_v}\\right|_n,\n$$\n$$\nS_v^n = S_v(Y^n,T_v^n), \\quad \\left.\\frac{\\partial S_v}{\\partial Y_j}\\right|_n, \\quad \\left.\\frac{\\partial S_v}{\\partial T_v}\\right|_n.\n$$\nUsing backward Euler and linearization, derive the local linear system for the unknown increments $\\Delta Y_i$ and $\\Delta T_v$, write it in matrix form, and specify the expressions for all matrix entries and right-hand side components in terms of $\\rho$, $\\Delta t$, $c_{v,v}$, and the given source values and derivatives at time level $n$.\n\nThen implement a program that, for each provided test case, constructs and solves this local linear system to obtain the updated values $Y_i^{n+1}$ and $T_v^{n+1}$.\n\nUse the following test suite, each case specified by $(N_s, \\rho, \\Delta t, Y^n, T_v^n, \\omega^n, \\partial \\omega/\\partial Y|_n, \\partial \\omega/\\partial T_v|_n, S_v^n, \\partial S_v/\\partial Y|_n, \\partial S_v/\\partial T_v|_n, c_{v,v})$. All quantities are in International System of Units (SI); the vibrational temperature must be reported in kelvin and species mass fractions are dimensionless.\n\n- Test Case $1$ (general case):\n  - $N_s = 2$\n  - $\\rho = 0.5 \\,\\mathrm{kg/m^3}$\n  - $\\Delta t = 1.0\\times 10^{-3} \\,\\mathrm{s}$\n  - $Y^n = [0.8,\\,0.2]$\n  - $T_v^n = 7000 \\,\\mathrm{K}$\n  - $\\omega^n = [-1.0\\times 10^{-3},\\, 1.0\\times 10^{-3}] \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial Y}\\right|_n = \\begin{bmatrix} -0.2 & 0.2 \\\\ 0.2 & -0.2 \\end{bmatrix} \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial T_v}\\right|_n = [0.0,\\,0.0] \\,\\mathrm{kg/(m^3 \\cdot s \\cdot K)}$\n  - $S_v^n = -2000 \\,\\mathrm{W/m^3}$\n  - $\\left.\\frac{\\partial S_v}{\\partial Y}\\right|_n = [100,\\,-100] \\,\\mathrm{W/(m^3)}$\n  - $\\left.\\frac{\\partial S_v}{\\partial T_v}\\right|_n = -5000 \\,\\mathrm{W/(m^3 \\cdot K)}$\n  - $c_{v,v} = 1000 \\,\\mathrm{J/(kg \\cdot K)}$\n\n- Test Case $2$ (stiff coupling):\n  - $N_s = 3$\n  - $\\rho = 0.2 \\,\\mathrm{kg/m^3}$\n  - $\\Delta t = 2.0\\times 10^{-5} \\,\\mathrm{s}$\n  - $Y^n = [0.6,\\,0.3,\\,0.1]$\n  - $T_v^n = 9000 \\,\\mathrm{K}$\n  - $\\omega^n = [-1.0\\times 10^{-2},\\, 8.0\\times 10^{-3},\\, 2.0\\times 10^{-3}] \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial Y}\\right|_n = \\begin{bmatrix} -10.0 & 8.0 & 2.0 \\\\ 10.0 & -12.0 & 2.0 \\\\ 0.0 & 4.0 & -4.0 \\end{bmatrix} \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial T_v}\\right|_n = [0.5,\\,-0.3,\\,-0.2] \\,\\mathrm{kg/(m^3 \\cdot s \\cdot K)}$\n  - $S_v^n = -5.0\\times 10^{5} \\,\\mathrm{W/m^3}$\n  - $\\left.\\frac{\\partial S_v}{\\partial Y}\\right|_n = [1.0\\times 10^{4},\\, -5.0\\times 10^{3},\\, 0.0] \\,\\mathrm{W/(m^3)}$\n  - $\\left.\\frac{\\partial S_v}{\\partial T_v}\\right|_n = -2.0\\times 10^{6} \\,\\mathrm{W/(m^3 \\cdot K)}$\n  - $c_{v,v} = 1500 \\,\\mathrm{J/(kg \\cdot K)}$\n\n- Test Case $3$ (edge case with zero sources and zero derivatives):\n  - $N_s = 1$\n  - $\\rho = 1.0 \\,\\mathrm{kg/m^3}$\n  - $\\Delta t = 1.0\\times 10^{-2} \\,\\mathrm{s}$\n  - $Y^n = [1.0]$\n  - $T_v^n = 3000 \\,\\mathrm{K}$\n  - $\\omega^n = [0.0] \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial Y}\\right|_n = \\begin{bmatrix} 0.0 \\end{bmatrix} \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial T_v}\\right|_n = [0.0] \\,\\mathrm{kg/(m^3 \\cdot s \\cdot K)}$\n  - $S_v^n = 0.0 \\,\\mathrm{W/m^3}$\n  - $\\left.\\frac{\\partial S_v}{\\partial Y}\\right|_n = [0.0] \\,\\mathrm{W/(m^3)}$\n  - $\\left.\\frac{\\partial S_v}{\\partial T_v}\\right|_n = 0.0 \\,\\mathrm{W/(m^3 \\cdot K)}$\n  - $c_{v,v} = 1000 \\,\\mathrm{J/(kg \\cdot K)}$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list of updated species mass fractions followed by the updated vibrational temperature. For numerical values, represent each number as a decimal float with six digits after the decimal point. For example, the output format for three cases is $[[Y_1^{n+1},\\dots,Y_{N_s}^{n+1},T_v^{n+1}], [\\dots], [\\dots]]$ with all temperatures in $\\mathrm{K}$ and mass fractions dimensionless.",
            "solution": "The problem requires the derivation and implementation of a point-implicit, backward Euler update scheme for a system of ordinary differential equations (ODEs) describing the evolution of species mass fractions and vibrational temperature in a high-temperature gas. This is a common and fundamental technique in computational fluid dynamics (CFD) for handling stiff source terms associated with chemical reactions and energy exchange.\n\nThe governing local ODEs are given by:\n$$\n\\frac{d Y_i}{dt} = \\frac{\\omega_i(Y_1,\\dots,Y_{N_s},T_v)}{\\rho}, \\quad i = 1,\\dots,N_s\n$$\n$$\n\\rho \\, c_{v,v} \\, \\frac{d T_v}{dt} = S_v(Y_1,\\dots,Y_{N_s},T_v)\n$$\nwhere $Y_i$ are the species mass fractions, $T_v$ is the vibrational temperature, $\\rho$ is the mass density, $c_{v,v}$ is the vibrational specific heat at constant volume, $\\omega_i$ are the species mass production source terms, and $S_v$ is the vibrational energy source term. The number of species is denoted by $N_s$.\n\nWe can consolidate this system into a single vector equation. Let the state vector be $\\vec{U} \\in \\mathbb{R}^{N_s+1}$ defined as $\\vec{U} = [Y_1, \\dots, Y_{N_s}, T_v]^T$. The system of ODEs can then be written compactly as $\\frac{d\\vec{U}}{dt} = \\vec{F}(\\vec{U})$, where the components of the source function $\\vec{F}$ are:\n$$\nF_i(\\vec{U}) = \\frac{\\omega_i(\\vec{U})}{\\rho} \\quad \\text{for } i \\in \\{1, \\dots, N_s\\}\n$$\n$$\nF_{N_s+1}(\\vec{U}) = \\frac{S_v(\\vec{U})}{\\rho c_{v,v}}\n$$\n\nThe backward Euler method, an first-order accurate implicit integration scheme, is used to discretize the ODE system in time:\n$$\n\\frac{\\vec{U}^{n+1} - \\vec{U}^n}{\\Delta t} = \\vec{F}(\\vec{U}^{n+1})\n$$\nwhere $\\vec{U}^n$ is the known state at the current time level $n$, $\\vec{U}^{n+1}$ is the unknown state at the new time level $n+1$, and $\\Delta t$ is the timestep.\n\nThis equation represents a system of nonlinear algebraic equations for the unknown state $\\vec{U}^{n+1}$. To solve it efficiently, we linearize the source function $\\vec{F}(\\vec{U}^{n+1})$ around the known state $\\vec{U}^n$ using a first-order Taylor series expansion:\n$$\n\\vec{F}(\\vec{U}^{n+1}) \\approx \\vec{F}(\\vec{U}^n) + \\mathbf{J}_F(\\vec{U}^n) (\\vec{U}^{n+1} - \\vec{U}^n)\n$$\nwhere $\\mathbf{J}_F(\\vec{U}^n) = \\left. \\frac{\\partial \\vec{F}}{\\partial \\vec{U}} \\right|_n$ is the Jacobian matrix of the source function $\\vec{F}$, evaluated at time level $n$. Let the unknown increment vector be $\\Delta \\vec{U} = \\vec{U}^{n+1} - \\vec{U}^n$. Substituting the linearization into the backward Euler formula yields:\n$$\n\\frac{\\Delta \\vec{U}}{\\Delta t} \\approx \\vec{F}(\\vec{U}^n) + \\mathbf{J}_F(\\vec{U}^n) \\Delta \\vec{U}\n$$\nThis is a linear system for the increment vector $\\Delta \\vec{U}$. We rearrange it into the standard form $\\mathbf{A} \\vec{x} = \\vec{b}$:\n$$\n\\left( \\frac{\\mathbf{I}}{\\Delta t} - \\mathbf{J}_F(\\vec{U}^n) \\right) \\Delta \\vec{U} = \\vec{F}(\\vec{U}^n)\n$$\nMultiplying both sides by $\\Delta t$ gives the final form of the local linear system:\n$$\n\\left( \\mathbf{I} - \\Delta t \\, \\mathbf{J}_F(\\vec{U}^n) \\right) \\Delta \\vec{U} = \\Delta t \\, \\vec{F}(\\vec{U}^n)\n$$\nwhere $\\mathbf{I}$ is the $(N_s+1) \\times (N_s+1)$ identity matrix.\n\nThe next step is to derive the explicit expressions for the entries of the system matrix and the right-hand side vector in terms of the quantities provided in the problem statement. The system matrix is $\\mathbf{A} = \\mathbf{I} - \\Delta t \\, \\mathbf{J}_F(\\vec{U}^n)$ and the right-hand side vector is $\\vec{b} = \\Delta t \\, \\vec{F}(\\vec{U}^n)$. The vector of unknowns is $\\Delta\\vec{U} = [\\Delta Y_1, \\dots, \\Delta Y_{N_s}, \\Delta T_v]^T$.\n\nFirst, we determine the components of the Jacobian matrix $\\mathbf{J}_F$ by taking the partial derivatives of the components of $\\vec{F}$:\nFor the species equations ($i \\in \\{1, \\dots, N_s\\}$):\n$$\n(\\mathbf{J}_F)_{ij} = \\frac{\\partial F_i}{\\partial Y_j} = \\frac{\\partial}{\\partial Y_j} \\left( \\frac{\\omega_i}{\\rho} \\right) = \\frac{1}{\\rho} \\frac{\\partial \\omega_i}{\\partial Y_j} \\quad \\text{for } j \\in \\{1, \\dots, N_s\\}\n$$\n$$\n(\\mathbf{J}_F)_{i, N_s+1} = \\frac{\\partial F_i}{\\partial T_v} = \\frac{\\partial}{\\partial T_v} \\left( \\frac{\\omega_i}{\\rho} \\right) = \\frac{1}{\\rho} \\frac{\\partial \\omega_i}{\\partial T_v}\n$$\nFor the vibrational energy equation (row $N_s+1$):\n$$\n(\\mathbf{J}_F)_{N_s+1, j} = \\frac{\\partial F_{N_s+1}}{\\partial Y_j} = \\frac{\\partial}{\\partial Y_j} \\left( \\frac{S_v}{\\rho c_{v,v}} \\right) = \\frac{1}{\\rho c_{v,v}} \\frac{\\partial S_v}{\\partial Y_j} \\quad \\text{for } j \\in \\{1, \\dots, N_s\\}\n$$\n$$\n(\\mathbf{J}_F)_{N_s+1, N_s+1} = \\frac{\\partial F_{N_s+1}}{\\partial T_v} = \\frac{\\partial}{\\partial T_v} \\left( \\frac{S_v}{\\rho c_{v,v}} \\right) = \\frac{1}{\\rho c_{v,v}} \\frac{\\partial S_v}{\\partial T_v}\n$$\nAll derivatives are evaluated at the known state $\\vec{U}^n$.\n\nNow we can specify the entries of the matrix $\\mathbf{A}$ and vector $\\vec{b}$.\n\n**Matrix Entries of $\\mathbf{A}$ in $\\mathbf{A} \\Delta\\vec{U} = \\vec{b}$:**\nThe matrix $\\mathbf{A}$ is of size $(N_s+1) \\times (N_s+1)$.\n\n1.  Upper-left block ($N_s \\times N_s$), for $i \\in \\{1, \\dots, N_s\\}$ and $j \\in \\{1, \\dots, N_s\\}$:\n    $$\n    A_{ij} = (\\mathbf{I} - \\Delta t \\, \\mathbf{J}_F)_{ij} = \\delta_{ij} - \\Delta t \\, (\\mathbf{J}_F)_{ij} = \\delta_{ij} - \\frac{\\Delta t}{\\rho} \\left. \\frac{\\partial \\omega_i}{\\partial Y_j} \\right|_n\n    $$\n    where $\\delta_{ij}$ is the Kronecker delta.\n\n2.  Upper-right block ($N_s \\times 1$), the column coupled with $\\Delta T_v$, for $i \\in \\{1, \\dots, N_s\\}$:\n    $$\n    A_{i, N_s+1} = -\\Delta t \\, (\\mathbf{J}_F)_{i, N_s+1} = - \\frac{\\Delta t}{\\rho} \\left. \\frac{\\partial \\omega_i}{\\partial T_v} \\right|_n\n    $$\n\n3.  Lower-left block ($1 \\times N_s$), the row for the $T_v$ equation, for $j \\in \\{1, \\dots, N_s\\}$:\n    $$\n    A_{N_s+1, j} = -\\Delta t \\, (\\mathbf{J}_F)_{N_s+1, j} = - \\frac{\\Delta t}{\\rho c_{v,v}} \\left. \\frac{\\partial S_v}{\\partial Y_j} \\right|_n\n    $$\n\n4.  Lower-right block ($1 \\times 1$), the diagonal term for the $T_v$ equation:\n    $$\n    A_{N_s+1, N_s+1} = 1 - \\Delta t \\, (\\mathbf{J}_F)_{N_s+1, N_s+1} = 1 - \\frac{\\Delta t}{\\rho c_{v,v}} \\left. \\frac{\\partial S_v}{\\partial T_v} \\right|_n\n    $$\n\n**Right-Hand Side Vector Components of $\\vec{b}$:**\nThe vector $\\vec{b}$ has $N_s+1$ components.\n\n1.  Upper part (first $N_s$ components), corresponding to species equations:\n    $$\n    b_i = \\Delta t \\, F_i(\\vec{U}^n) = \\frac{\\Delta t}{\\rho} \\, \\omega_i^n \\quad \\text{for } i \\in \\{1, \\dots, N_s\\}\n    $$\n\n2.  Lower part (last component), corresponding to the energy equation:\n    $$\n    b_{N_s+1} = \\Delta t \\, F_{N_s+1}(\\vec{U}^n) = \\frac{\\Delta t}{\\rho c_{v,v}} \\, S_v^n\n    $$\n\nAfter constructing the matrix $\\mathbf{A}$ and vector $\\vec{b}$ from the given data at time level $n$, we solve the linear system $\\mathbf{A} \\Delta\\vec{U} = \\vec{b}$ to find the increment vector $\\Delta\\vec{U} = [\\Delta Y_1, \\dots, \\Delta Y_{N_s}, \\Delta T_v]^T$.\n\nFinally, the state variables are updated to the new time level $n+1$:\n$$\nY_i^{n+1} = Y_i^n + \\Delta Y_i, \\quad i = 1, \\dots, N_s\n$$\n$$\nT_v^{n+1} = T_v^n + \\Delta T_v\n$$\nThe following program implements this procedure for the provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and solves the point-implicit linear system for each test case\n    to find the updated species mass fractions and vibrational temperature.\n    \"\"\"\n    test_cases = [\n        {\n            \"Ns\": 2,\n            \"rho\": 0.5,\n            \"dt\": 1.0e-3,\n            \"Yn\": [0.8, 0.2],\n            \"Tvn\": 7000,\n            \"omega_n\": [-1.0e-3, 1.0e-3],\n            \"d_omega_d_Y_n\": [[-0.2, 0.2], [0.2, -0.2]],\n            \"d_omega_d_Tv_n\": [0.0, 0.0],\n            \"Sv_n\": -2000,\n            \"d_Sv_d_Y_n\": [100, -100],\n            \"d_Sv_d_Tv_n\": -5000,\n            \"c_vv\": 1000,\n        },\n        {\n            \"Ns\": 3,\n            \"rho\": 0.2,\n            \"dt\": 2.0e-5,\n            \"Yn\": [0.6, 0.3, 0.1],\n            \"Tvn\": 9000,\n            \"omega_n\": [-1.0e-2, 8.0e-3, 2.0e-3],\n            \"d_omega_d_Y_n\": [[-10.0, 8.0, 2.0], [10.0, -12.0, 2.0], [0.0, 4.0, -4.0]],\n            \"d_omega_d_Tv_n\": [0.5, -0.3, -0.2],\n            \"Sv_n\": -5.0e5,\n            \"d_Sv_d_Y_n\": [1.0e4, -5.0e3, 0.0],\n            \"d_Sv_d_Tv_n\": -2.0e6,\n            \"c_vv\": 1500,\n        },\n        {\n            \"Ns\": 1,\n            \"rho\": 1.0,\n            \"dt\": 1.0e-2,\n            \"Yn\": [1.0],\n            \"Tvn\": 3000,\n            \"omega_n\": [0.0],\n            \"d_omega_d_Y_n\": [[0.0]],\n            \"d_omega_d_Tv_n\": [0.0],\n            \"Sv_n\": 0.0,\n            \"d_Sv_d_Y_n\": [0.0],\n            \"d_Sv_d_Tv_n\": 0.0,\n            \"c_vv\": 1000,\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters\n        Ns = case[\"Ns\"]\n        rho = case[\"rho\"]\n        dt = case[\"dt\"]\n        Yn = np.array(case[\"Yn\"], dtype=float)\n        Tvn = float(case[\"Tvn\"])\n        omega_n = np.array(case[\"omega_n\"], dtype=float)\n        d_omega_d_Y_n = np.array(case[\"d_omega_d_Y_n\"], dtype=float)\n        d_omega_d_Tv_n = np.array(case[\"d_omega_d_Tv_n\"], dtype=float)\n        Sv_n = float(case[\"Sv_n\"])\n        d_Sv_d_Y_n = np.array(case[\"d_Sv_d_Y_n\"], dtype=float)\n        d_Sv_d_Tv_n = float(case[\"d_Sv_d_Tv_n\"])\n        c_vv = float(case[\"c_vv\"])\n\n        # Initialize the matrix A and vector b\n        system_size = Ns + 1\n        A = np.zeros((system_size, system_size))\n        b = np.zeros(system_size)\n\n        # Populate matrix A\n        # Upper-left block (species-species coupling)\n        A[:Ns, :Ns] = np.identity(Ns) - (dt / rho) * d_omega_d_Y_n\n        # Upper-right block (species-temperature coupling)\n        A[:Ns, Ns] = - (dt / rho) * d_omega_d_Tv_n\n        # Lower-left block (temperature-species coupling)\n        A[Ns, :Ns] = - (dt / (rho * c_vv)) * d_Sv_d_Y_n\n        # Lower-right block (temperature-temperature coupling)\n        A[Ns, Ns] = 1 - (dt / (rho * c_vv)) * d_Sv_d_Tv_n\n\n        # Populate vector b\n        # Upper part (species source terms)\n        b[:Ns] = (dt / rho) * omega_n\n        # Lower part (energy source term)\n        b[Ns] = (dt / (rho * c_vv)) * Sv_n\n\n        # Solve the linear system A * delta_U = b\n        delta_U = np.linalg.solve(A, b)\n\n        # Extract increments\n        delta_Y = delta_U[:Ns]\n        delta_Tv = delta_U[Ns]\n\n        # Update the state\n        Y_np1 = Yn + delta_Y\n        Tv_np1 = Tvn + delta_Tv\n\n        # Store the result for this case\n        case_result = list(Y_np1) + [Tv_np1]\n        results.append(case_result)\n\n    # Format the final output string as per requirements\n    formatted_results = []\n    for res_list in results:\n        formatted_nums = [f\"{num:.6f}\" for num in res_list]\n        formatted_results.append(f\"[{','.join(formatted_nums)}]\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}