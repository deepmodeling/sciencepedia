{
    "hands_on_practices": [
        {
            "introduction": "In computational models of reacting flows, kinetic mechanisms often provide parameters for forward reactions, but reverse reaction rates are equally crucial for accurately capturing the approach to chemical equilibrium. This practice illuminates the fundamental connection between chemical kinetics and thermodynamics. You will derive how the reverse rate constant, $k_r$, is determined by the forward rate constant, $k_f$, and the equilibrium constant, $K_c$, which itself is a function of the Gibbs free energy change of the reaction . This exercise is essential for building and verifying thermodynamically consistent reaction mechanisms used in advanced CFD simulations.",
            "id": "3989119",
            "problem": "An ideal-gas reacting mixture typical of Aerospace Computational Fluid Dynamics (CFD) at high temperature is considered to be spatially uniform and well-mixed, with negligible diffusive transport. Focus on the elementary reaction\n$$\\mathrm{CO} + \\mathrm{OH} \\rightleftharpoons \\mathrm{CO}_2 + \\mathrm{H},$$\nwhich is used to model finite-rate source terms in reacting flows. Assume the standard state pressure is $p^{0} = 1\\,\\text{bar}$ for all species, and ideal-gas behavior holds for the mixture.\n\nStarting from fundamental definitions of chemical potential, the Gibbs free energy, and the mass-action law, derive the relation for the concentration-based equilibrium constant $K_{c}(T)$ in terms of the standard Gibbs free energy change of reaction $\\Delta g^{0}(T)$ at temperature $T$, and use the equilibrium condition to obtain the reverse Arrhenius rate constant $k_{r}(T)$ from the forward rate constant $k_{f}(T)$.\n\nThen, at temperature $T = 2000\\,\\text{K}$, compute a numerical value for $k_{r}(T)$ using the following thermodynamic and kinetic data:\n- Standard Gibbs free energies of formation at $T = 2000\\,\\text{K}$:\n  $$g_{f,\\mathrm{CO}}^{0}(T) = -150000\\,\\text{J/mol},\\quad g_{f,\\mathrm{OH}}^{0}(T) = 30000\\,\\text{J/mol},$$\n  $$g_{f,\\mathrm{CO}_2}^{0}(T) = -360000\\,\\text{J/mol},\\quad g_{f,\\mathrm{H}}^{0}(T) = 200000\\,\\text{J/mol}.$$\n- Forward Arrhenius parameters for the reaction $\\mathrm{CO} + \\mathrm{OH} \\rightarrow \\mathrm{CO}_2 + \\mathrm{H}$:\n  $$A_{f} = 5.00 \\times 10^{7}\\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1},\\quad n_{f} = 0.0,\\quad E_{f} = 1.20 \\times 10^{4}\\,\\text{J/mol}.$$\n- Universal gas constant:\n  $$R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}.$$\n\nYour derivation should begin from the equilibrium condition expressed via chemical potentials and the definition of $\\Delta g^{0}(T)$, and proceed to the form of $K_{c}(T)$ appropriate for ideal gases. Use this to find $k_{r}(T)$ from $k_{f}(T)$. Finally, evaluate $k_{r}(2000\\,\\text{K})$ numerically.\n\nRound your final numerical answer for $k_{r}(2000\\,\\text{K})$ to four significant figures. Express the final answer in $\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is based on fundamental principles of chemical thermodynamics and kinetics. All necessary data are provided, and the problem is free of contradictions or ambiguities.\n\nThe solution proceeds in three parts as requested:\n1.  Derivation of the relation for the concentration-based equilibrium constant $K_c(T)$.\n2.  Derivation of the relation between the forward and reverse rate constants, $k_f(T)$ and $k_r(T)$.\n3.  Numerical calculation of $k_r(T)$ at $T=2000\\,\\text{K}$.\n\n**1. Derivation of the Equilibrium Constant $K_c(T)$**\n\nThe elementary reaction is:\n$$ \\mathrm{CO} + \\mathrm{OH} \\rightleftharpoons \\mathrm{CO}_2 + \\mathrm{H} $$\nThe condition for chemical equilibrium is that the change in Gibbs free energy for the reaction, $\\Delta G_r$, is zero. The change is expressed as the sum of the chemical potentials $\\mu_i$ of the species, weighted by their stoichiometric coefficients $\\nu_i$ (positive for products, negative for reactants):\n$$ \\Delta G_r = \\sum_{i} \\nu_i \\mu_i = 0 $$\nFor the given reaction, this becomes:\n$$ \\mu_{\\mathrm{CO}_2} + \\mu_{\\mathrm{H}} - \\mu_{\\mathrm{CO}} - \\mu_{\\mathrm{OH}} = 0 $$\nThe chemical potential $\\mu_i$ of a species $i$ in an ideal gas mixture is related to its standard chemical potential $\\mu_i^0(T)$ at standard pressure $p^0$ by:\n$$ \\mu_i(T, p_i) = \\mu_i^0(T) + RT \\ln\\left(\\frac{p_i}{p^0}\\right) $$\nwhere $p_i$ is the partial pressure of species $i$, $R$ is the universal gas constant, and $T$ is the temperature. The standard chemical potential $\\mu_i^0(T)$ is equivalent to the standard molar Gibbs free energy $g_i^0(T)$.\n\nSubstituting this expression for each species into the equilibrium condition:\n$$ \\left( \\mu_{\\mathrm{CO}_2}^0 + RT \\ln\\frac{p_{\\mathrm{CO}_2}}{p^0} \\right) + \\left( \\mu_{\\mathrm{H}}^0 + RT \\ln\\frac{p_{\\mathrm{H}}}{p^0} \\right) - \\left( \\mu_{\\mathrm{CO}}^0 + RT \\ln\\frac{p_{\\mathrm{CO}}}{p^0} \\right) - \\left( \\mu_{\\mathrm{OH}}^0 + RT \\ln\\frac{p_{\\mathrm{OH}}}{p^0} \\right) = 0 $$\nGrouping the standard potential terms and the logarithmic terms:\n$$ (\\mu_{\\mathrm{CO}_2}^0 + \\mu_{\\mathrm{H}}^0 - \\mu_{\\mathrm{CO}}^0 - \\mu_{\\mathrm{OH}}^0) + RT \\ln\\left( \\frac{(p_{\\mathrm{CO}_2}/p^0)(p_{\\mathrm{H}}/p^0)}{(p_{\\mathrm{CO}}/p^0)(p_{\\mathrm{OH}}/p^0)} \\right)_{\\text{eq}} = 0 $$\nThe first term is the standard Gibbs free energy change of reaction, $\\Delta g^0(T)$:\n$$ \\Delta g^0(T) = \\mu_{\\mathrm{CO}_2}^0 + \\mu_{\\mathrm{H}}^0 - \\mu_{\\mathrm{CO}}^0 - \\mu_{\\mathrm{OH}}^0 $$\nThe term inside the logarithm is the pressure-based equilibrium constant, $K_p(T)$:\n$$ K_p(T) = \\left( \\frac{(p_{\\mathrm{CO}_2}/p^0)(p_{\\mathrm{H}}/p^0)}{(p_{\\mathrm{CO}}/p^0)(p_{\\mathrm{OH}}/p^0)} \\right)_{\\text{eq}} $$\nThus, the equilibrium condition simplifies to:\n$$ \\Delta g^0(T) + RT \\ln K_p(T) = 0 \\implies K_p(T) = \\exp\\left(-\\frac{\\Delta g^0(T)}{RT}\\right) $$\nTo find the concentration-based equilibrium constant $K_c(T)$, we use the ideal gas law, $p_i = [i]RT$, where $[i]$ is the molar concentration of species $i$.\n$$ K_p(T) = \\frac{([\\mathrm{CO}_2]RT/p^0)([\\mathrm{H}]RT/p^0)}{([\\mathrm{CO}]RT/p^0)([\\mathrm{OH}]RT/p^0)} = \\frac{[\\mathrm{CO}_2][\\mathrm{H}]}{[\\mathrm{CO}][\\mathrm{OH}]} \\left(\\frac{RT}{p^0}\\right)^{(1+1)-(1+1)} $$\nThe first factor is the definition of $K_c(T)$. The exponent is the change in the number of moles of gas in the reaction, $\\Delta\\nu = (1+1)-(1+1)=0$. Therefore, for this specific reaction, the $(RT/p^0)$ term is raised to the power of $0$, which is $1$.\n$$ K_p(T) = K_c(T) \\left(\\frac{RT}{p^0}\\right)^0 = K_c(T) $$\nSo, the required relation for $K_c(T)$ is:\n$$ K_c(T) = \\exp\\left(-\\frac{\\Delta g^0(T)}{RT}\\right) $$\n\n**2. Derivation of the Reverse Rate Constant $k_r(T)$**\n\nAt chemical equilibrium, the net rate of reaction is zero, which means the forward reaction rate ($r_f$) is equal to the reverse reaction rate ($r_r$). According to the law of mass action for this elementary reaction:\n$$ r_f = k_f(T)[\\mathrm{CO}][\\mathrm{OH}] $$\n$$ r_r = k_r(T)[\\mathrm{CO}_2][\\mathrm{H}] $$\nAt equilibrium, $r_{f,\\text{eq}} = r_{r,\\text{eq}}$:\n$$ k_f(T)[\\mathrm{CO}]_{\\text{eq}}[\\mathrm{OH}]_{\\text{eq}} = k_r(T)[\\mathrm{CO}_2]_{\\text{eq}}[\\mathrm{H}]_{\\text{eq}} $$\nRearranging this equation gives:\n$$ \\frac{k_f(T)}{k_r(T)} = \\frac{[\\mathrm{CO}_2]_{\\text{eq}}[\\mathrm{H}]_{\\text{eq}}}{[\\mathrm{CO}]_{\\text{eq}}[\\mathrm{OH}]_{\\text{eq}}} $$\nThe right-hand side is the definition of the concentration-based equilibrium constant, $K_c(T)$.\n$$ \\frac{k_f(T)}{k_r(T)} = K_c(T) $$\nThus, the reverse rate constant can be expressed in terms of the forward rate constant and the equilibrium constant:\n$$ k_r(T) = \\frac{k_f(T)}{K_c(T)} $$\n\n**3. Numerical Calculation of $k_r(2000\\,\\text{K})$**\n\nFirst, we combine the derived expressions.\n$$ k_r(T) = \\frac{k_f(T)}{K_c(T)} = \\frac{k_f(T)}{\\exp\\left(-\\frac{\\Delta g^0(T)}{RT}\\right)} = k_f(T) \\exp\\left(\\frac{\\Delta g^0(T)}{RT}\\right) $$\nThe forward rate constant $k_f(T)$ is given by the modified Arrhenius equation:\n$$ k_f(T) = A_f T^{n_f} \\exp\\left(-\\frac{E_f}{RT}\\right) $$\nSubstituting this into the expression for $k_r(T)$:\n$$ k_r(T) = A_f T^{n_f} \\exp\\left(-\\frac{E_f}{RT}\\right) \\exp\\left(\\frac{\\Delta g^0(T)}{RT}\\right) = A_f T^{n_f} \\exp\\left(\\frac{\\Delta g^0(T) - E_f}{RT}\\right) $$\nNow, we evaluate this expression at $T = 2000\\,\\text{K}$ using the given data.\n\nFirst, calculate the standard Gibbs free energy change of reaction, $\\Delta g^0(T)$:\n$$ \\Delta g^0(T) = (g_{f,\\mathrm{CO}_2}^0 + g_{f,\\mathrm{H}}^0) - (g_{f,\\mathrm{CO}}^0 + g_{f,\\mathrm{OH}}^0) $$\n$$ \\Delta g^0(2000\\,\\text{K}) = (-360000 + 200000)\\,\\text{J/mol} - (-150000 + 30000)\\,\\text{J/mol} $$\n$$ \\Delta g^0(2000\\,\\text{K}) = -160000\\,\\text{J/mol} - (-120000\\,\\text{J/mol}) = -40000\\,\\text{J/mol} $$\n\nNow, use this value in the combined expression for $k_r(2000\\,\\text{K})$.\nGiven data:\n$A_f = 5.00 \\times 10^7\\,\\text{m}^3\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$\n$n_f = 0.0$\n$E_f = 1.20 \\times 10^4\\,\\text{J/mol}$\n$\\Delta g^0(2000\\,\\text{K}) = -4.00 \\times 10^4\\,\\text{J/mol}$\n$R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$\n$T = 2000\\,\\text{K}$\n\nThe term $T^{n_f} = (2000)^{0.0} = 1$.\nThe exponent term is:\n$$ \\frac{\\Delta g^0(T) - E_f}{RT} = \\frac{-40000\\,\\text{J/mol} - 12000\\,\\text{J/mol}}{(8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1})(2000\\,\\text{K})} $$\n$$ \\frac{-52000}{16628.925236} \\approx -3.1271198 $$\nNow, calculate $k_r(2000\\,\\text{K})$:\n$$ k_r(2000\\,\\text{K}) = (5.00 \\times 10^7) \\times (1) \\times \\exp(-3.1271198) $$\n$$ k_r(2000\\,\\text{K}) \\approx (5.00 \\times 10^7) \\times 0.043846603 $$\n$$ k_r(2000\\,\\text{K}) \\approx 2192330.15\\,\\text{m}^3\\,\\text{mol}^{-1}\\,\\text{s}^{-1} $$\nRounding the result to four significant figures gives:\n$$ k_r(2000\\,\\text{K}) \\approx 2.192 \\times 10^6\\,\\text{m}^3\\,\\text{mol}^{-1}\\,\\text{s}^{-1} $$\nThe units of $k_r$ are the same as $k_f$ because $K_c$ is dimensionless for this reaction ($\\Delta\\nu = 0$).",
            "answer": "$$\\boxed{2.192 \\times 10^{6}}$$"
        },
        {
            "introduction": "Nonpremixed combustion, where fuel and oxidizer enter the reaction zone separately, is a cornerstone of aerospace propulsion systems. A key parameter in designing such systems is the adiabatic flame temperature, which represents the theoretical maximum temperature achievable and dictates material constraints and performance limits. This exercise introduces the powerful mixture fraction ($Z$) concept to analyze a classic diffusion flame, guiding you through the calculation of the stoichiometric mixture fraction, $Z_{\\mathrm{st}}$, and the corresponding maximum temperature . Mastering this calculation provides a critical baseline for evaluating the impact of more complex phenomena like heat loss and finite-rate kinetics.",
            "id": "3989092",
            "problem": "Consider a steady, planar nonpremixed diffusion flame between two semi-infinite streams at ambient pressure $p = 1\\,\\mathrm{atm}$ in a Computational Fluid Dynamics (CFD) framework. The fuel stream is pure methane with mass fraction $Y_{F,\\infty} = 1$ (species $\\mathrm{CH_4}$) at temperature $T_{F,0} = 298\\,\\mathrm{K}$. The oxidizer stream is dry air at temperature $T_{O,0} = 298\\,\\mathrm{K}$ with mass fractions $Y_{\\mathrm{O_2},\\infty} = 0.233$ and $Y_{\\mathrm{N_2},\\infty} = 0.767$. Assume the overall reaction is\n$$\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O},$$\nwith standard enthalpies of formation at $T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$ given by $h_f^0(\\mathrm{CH_4}) = -74.85\\,\\mathrm{kJ/mol}$, $h_f^0(\\mathrm{CO_2}) = -393.5\\,\\mathrm{kJ/mol}$, $h_f^0(\\mathrm{H_2O(g)}) = -241.826\\,\\mathrm{kJ/mol}$, $h_f^0(\\mathrm{O_2}) = 0$, and $h_f^0(\\mathrm{N_2}) = 0$. The molecular weights are $W_{\\mathrm{CH_4}} = 16\\,\\mathrm{kg/kmol}$, $W_{\\mathrm{O_2}} = 32\\,\\mathrm{kg/kmol}$, $W_{\\mathrm{CO_2}} = 44\\,\\mathrm{kg/kmol}$, and $W_{\\mathrm{H_2O}} = 18\\,\\mathrm{kg/kmol}$.\n\nAdopt the mixture fraction concept, where the mixture fraction $Z$ represents the local mass fraction originating from the fuel stream, with $Z = 1$ in the fuel and $Z = 0$ in the oxidizer. Use conservation of elements and stoichiometry to determine the stoichiometric mixture fraction $Z_{\\mathrm{st}}$ by equating the mixed masses of fuel and oxidizer species at the local stoichiometric condition. Treat nitrogen as inert. Under the assumption of infinitely fast chemistry and adiabatic conditions, the maximum flame temperature occurs at $Z = Z_{\\mathrm{st}}$ and can be obtained by an energy balance equating the sensible enthalpy rise of products to the chemical heat release. For the burned mixture at $Z_{\\mathrm{st}}$, approximate the mixture-averaged specific heat at constant pressure by a temperature-dependent linear fit\n$$c_{p,\\mathrm{mix}}(T) = a + b\\,T,$$\nwith $a = 1.15\\,\\mathrm{kJ/(kg\\cdot K)}$ and $b = 2.0 \\times 10^{-4}\\,\\mathrm{kJ/(kg\\cdot K^2)}$, valid over $T \\in [298\\,\\mathrm{K}, 3000\\,\\mathrm{K}]$.\n\nUsing first principles (conservation of mass, elemental balances, and energy), compute the adiabatic maximum temperature $T_{\\max}$ of the diffusion flame at $Z = Z_{\\mathrm{st}}$. Express your final answer in $\\mathrm{K}$ and round to four significant figures.\n\nThen, briefly explain (no calculation required) why the actual peak temperature in high-speed reacting flows may deviate from this value due to finite-rate chemistry and heat losses in realistic aerospace configurations.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- Flow conditions: Steady, planar nonpremixed diffusion flame.\n- Pressure: $p = 1\\,\\mathrm{atm}$.\n- Fuel stream: Pure methane ($\\mathrm{CH_4}$), $Y_{F,\\infty} = 1$, $T_{F,0} = 298\\,\\mathrm{K}$.\n- Oxidizer stream: Dry air, $Y_{\\mathrm{O_2},\\infty} = 0.233$, $Y_{\\mathrm{N_2},\\infty} = 0.767$, $T_{O,0} = 298\\,\\mathrm{K}$.\n- Stoichiometry: $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$.\n- Reference temperature: $T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$.\n- Standard enthalpies of formation ($h_f^0$):\n  - $h_f^0(\\mathrm{CH_4}) = -74.85\\,\\mathrm{kJ/mol}$\n  - $h_f^0(\\mathrm{CO_2}) = -393.5\\,\\mathrm{kJ/mol}$\n  - $h_f^0(\\mathrm{H_2O(g)}) = -241.826\\,\\mathrm{kJ/mol}$\n  - $h_f^0(\\mathrm{O_2}) = 0\\,\\mathrm{kJ/mol}$\n  - $h_f^0(\\mathrm{N_2}) = 0\\,\\mathrm{kJ/mol}$\n- Molecular weights ($W$):\n  - $W_{\\mathrm{CH_4}} = 16\\,\\mathrm{kg/kmol}$\n  - $W_{\\mathrm{O_2}} = 32\\,\\mathrm{kg/kmol}$\n  - $W_{\\mathrm{CO_2}} = 44\\,\\mathrm{kg/kmol}$\n  - $W_{\\mathrm{H_2O}} = 18\\,\\mathrm{kg/kmol}$\n- Mixture fraction concept: $Z=1$ in fuel, $Z=0$ in oxidizer.\n- Assumptions: Infinitely fast chemistry, adiabatic conditions.\n- Product mixture specific heat: $c_{p,\\mathrm{mix}}(T) = a + b\\,T$, with $a = 1.15\\,\\mathrm{kJ/(kg\\cdot K)}$ and $b = 2.0 \\times 10^{-4}\\,\\mathrm{kJ/(kg\\cdot K^2)}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, representing a classic Burke-Schumann diffusion flame analysis, a fundamental topic in combustion. It is well-posed, providing all necessary thermodynamic data, boundary conditions, and a constitutive relation for specific heat to determine a unique solution for the adiabatic flame temperature. The data are consistent and physically reasonable. The problem is objective and uses standard terminology from the field of reacting flows. The question is directly relevant to the topic of *reacting flows and finite-rate chemistry* within *aerospace cfd*.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be derived.\n\n**Solution Derivation**\n\nThe computation of the adiabatic maximum temperature, $T_{\\max}$, involves three primary steps:\n1.  Determination of the stoichiometric mixture fraction, $Z_{\\mathrm{st}}$.\n2.  Calculation of the heat of reaction.\n3.  Application of the First Law of Thermodynamics (energy balance) for an adiabatic system.\n\n**1. Stoichiometric Mixture Fraction ($Z_{\\mathrm{st}}$)**\nThe stoichiometric mass ratio, $s$, is the mass of pure oxygen required to completely burn a unit mass of fuel. From the chemical reaction $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$, the molar ratio is $2$ moles of $\\mathrm{O_2}$ to $1$ mole of $\\mathrm{CH_4}$.\n$$\ns = \\frac{\\text{mass of }\\mathrm{O_2}}{\\text{mass of }\\mathrm{CH_4}} = \\frac{2 \\cdot W_{\\mathrm{O_2}}}{1 \\cdot W_{\\mathrm{CH_4}}} = \\frac{2 \\times 32\\,\\mathrm{kg/kmol}}{1 \\times 16\\,\\mathrm{kg/kmol}} = 4\n$$\nThe oxidizer stream is air, which contains oxygen with a mass fraction of $Y_{\\mathrm{O_2},\\infty} = 0.233$. Therefore, the stoichiometric air-to-fuel ratio by mass, $(A/F)_{\\mathrm{st}}$, is:\n$$\n\\left(\\frac{A}{F}\\right)_{\\mathrm{st}} = \\frac{s}{Y_{\\mathrm{O_2},\\infty}} = \\frac{4}{0.233}\n$$\nThe stoichiometric mixture fraction, $Z_{\\mathrm{st}}$, is the mass fraction of fuel in a stoichiometric mixture of fuel and air.\n$$\nZ_{\\mathrm{st}} = \\frac{m_{\\text{fuel}}}{m_{\\text{fuel}} + m_{\\text{air}}} = \\frac{1}{1 + (m_{\\text{air}}/m_{\\text{fuel}})} = \\frac{1}{1 + (A/F)_{\\mathrm{st}}}\n$$\n$$\nZ_{\\mathrm{st}} = \\frac{1}{1 + \\frac{4}{0.233}} = \\frac{0.233}{0.233 + 4} = \\frac{0.233}{4.233} \\approx 0.0550437\n$$\n\n**2. Heat of Reaction**\nThe standard heat of reaction per mole of fuel, $\\Delta H_R^0$, at the reference temperature $T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$ is calculated from the enthalpies of formation.\n$$\n\\Delta H_R^0 = \\sum_{\\text{products}} \\nu_k h_{f,k}^0 - \\sum_{\\text{reactants}} \\nu_k h_{f,k}^0\n$$\n$$\n\\Delta H_R^0 = \\left[1 \\cdot h_f^0(\\mathrm{CO_2}) + 2 \\cdot h_f^0(\\mathrm{H_2O})\\right] - \\left[1 \\cdot h_f^0(\\mathrm{CH_4}) + 2 \\cdot h_f^0(\\mathrm{O_2})\\right]\n$$\n$$\n\\Delta H_R^0 = \\left[1(-393.5) + 2(-241.826)\\right] - \\left[1(-74.85) + 2(0)\\right]\n$$\n$$\n\\Delta H_R^0 = -877.152 - (-74.85) = -802.302\\,\\mathrm{kJ/mol} \\text{ of } \\mathrm{CH_4}\n$$\nThe heat released per unit mass of fuel, $q_R$, is:\n$$\nq_R = \\frac{-\\Delta H_R^0}{W_{\\mathrm{CH_4}}} = \\frac{802.302\\,\\mathrm{kJ/mol}}{16\\,\\mathrm{kg/kmol}} = 50.143875\\,\\mathrm{kJ/g} = 5.0143875 \\times 10^7\\,\\mathrm{J/kg}\n$$\n\n**3. Adiabatic Energy Balance**\nFor an adiabatic system with reactants entering at $T_0 = T_{\\mathrm{ref}}$, the energy balance states that the heat released by the reaction equals the sensible enthalpy rise of the products. For a unit mass of the stoichiometric mixture, the mass of fuel is $Z_{\\mathrm{st}}$, and the heat released is $Z_{\\mathrm{st}} q_R$. This energy heats the products from $T_0$ to $T_{\\max}$.\n$$\n\\text{Heat Released} = \\text{Sensible Enthalpy Gain}\n$$\n$$\nZ_{\\mathrm{st}} q_R = \\int_{T_0}^{T_{\\max}} c_{p,\\mathrm{mix}}(T) \\,dT\n$$\nUsing the given linear model for the specific heat of the mixture, $c_{p,\\mathrm{mix}}(T) = a + bT$:\n$$\nZ_{\\mathrm{st}} q_R = \\int_{T_0}^{T_{\\max}} (a+bT) \\,dT = \\left[aT + \\frac{1}{2}bT^2\\right]_{T_0}^{T_{\\max}}\n$$\n$$\nZ_{\\mathrm{st}} q_R = \\left(aT_{\\max} + \\frac{1}{2}bT_{\\max}^2\\right) - \\left(aT_0 + \\frac{1}{2}bT_0^2\\right)\n$$\nThis can be rearranged into a quadratic equation for $T_{\\max}$:\n$$\n\\frac{1}{2}bT_{\\max}^2 + aT_{\\max} - \\left(Z_{\\mathrm{st}} q_R + aT_0 + \\frac{1}{2}bT_0^2\\right) = 0\n$$\nNow, we substitute the numerical values in consistent SI units ($J$, $kg$, $K$).\n- $a = 1.15 \\times 10^3\\,\\mathrm{J/(kg\\cdot K)}$\n- $b = 2.0 \\times 10^{-4} \\times 10^3 = 0.2\\,\\mathrm{J/(kg\\cdot K^2)}$\n- $T_0 = 298\\,\\mathrm{K}$\n- $Z_{\\mathrm{st}} \\approx 0.0550437$\n- $q_R = 5.0143875 \\times 10^7\\,\\mathrm{J/kg}$\n\nLet's compute the constant term in the parentheses:\n$Z_{\\mathrm{st}} q_R \\approx 0.0550437 \\times (5.0143875 \\times 10^7) \\approx 2.7600 \\times 10^6\\,\\mathrm{J/kg}$\n$aT_0 = (1.15 \\times 10^3) \\times 298 = 3.427 \\times 10^5\\,\\mathrm{J/kg}$\n$\\frac{1}{2}bT_0^2 = \\frac{1}{2}(0.2)(298)^2 = 0.1 \\times 88804 = 8880.4\\,\\mathrm{J/kg}$\n\nThe constant term is $C = (2.7600 \\times 10^6) + (3.427 \\times 10^5) + 8880.4 \\approx 3.11158 \\times 10^6\\,\\mathrm{J/kg}$.\nThe quadratic equation is:\n$$\n\\frac{1}{2}(0.2)T_{\\max}^2 + (1.15 \\times 10^3)T_{\\max} - 3.11158 \\times 10^6 = 0\n$$\n$$\n0.1 T_{\\max}^2 + 1150 T_{\\max} - 3111580 = 0\n$$\nSolving for $T_{\\max}$ using the quadratic formula, $T_{\\max} = \\frac{-B \\pm \\sqrt{B^2-4AC'}}{2A}$, where $A=0.1$, $B=1150$, and $C'=-3111580$:\n$$\nT_{\\max} = \\frac{-1150 + \\sqrt{(1150)^2 - 4(0.1)(-3111580)}}{2(0.1)}\n$$\n$$\nT_{\\max} = \\frac{-1150 + \\sqrt{1322500 + 1244632}}{0.2} = \\frac{-1150 + \\sqrt{2567132}}{0.2}\n$$\n$$\nT_{\\max} \\approx \\frac{-1150 + 1602.227}{0.2} = \\frac{452.227}{0.2} \\approx 2261.135\\,\\mathrm{K}\n$$\nRounding the result to four significant figures gives $T_{\\max} = 2261\\,\\mathrm{K}$.\n\n**Explanation of Deviations in Realistic Scenarios**\n\nThe calculated value of $T_{\\max} = 2261\\,\\mathrm{K}$ is an idealized maximum. In actual high-speed reacting flows, such as in scramjets or rocket engine combustors, the peak temperature observed is lower for two principal reasons:\n\n1.  **Finite-Rate Chemistry:** The assumption of infinitely fast chemistry (chemical equilibrium) implies that reactants are converted to products instantaneously upon mixing. In reality, chemical reactions proceed at finite rates. In high-speed flows, the fluid's residence time within the combustor can be extremely short (on the order of milliseconds), which may be insufficient for the reactions to reach completion. This state of chemical non-equilibrium means that not all chemical energy is released, resulting in a lower gas temperature compared to the equilibrium adiabatic flame temperature. The reaction zone broadens, and the maximum temperature is reduced.\n\n2.  **Heat Losses:** The calculation assumes an adiabatic system, which means no heat is exchanged with the surroundings. Any practical aerospace combustor has walls that are maintained at temperatures far below the flame temperature for structural integrity, often through active cooling. This creates large temperature gradients, leading to significant heat transfer from the hot combustion gases to the walls via convection. Furthermore, at the high temperatures involved, product species such as $\\mathrm{CO_2}$ and $\\mathrm{H_2O}$ are strong radiators, causing substantial heat loss through thermal radiation. These non-adiabatic effects remove energy from the gas, directly lowering its enthalpy and thus reducing the peak attainable temperature.",
            "answer": "$$\n\\boxed{2261}\n$$"
        },
        {
            "introduction": "A central decision in simulating high-speed reacting flows is whether to assume instantaneous chemical equilibrium or to resolve the finite-rate kinetic processes. In environments like shock layers or scramjet combustors, flow residence times can be so short that chemical reactions do not have time to complete, leading to a state of chemical non-equilibrium. This computational practice offers a direct, hands-on exploration of this critical phenomenon by having you simulate the chemical evolution of a post-shock air parcel . By integrating the finite-rate equations and comparing the result to the theoretical equilibrium state, you will gain a tangible understanding of non-equilibrium effects and how to quantify their significance.",
            "id": "3989089",
            "problem": "Consider a shock-heated parcel of air modeled as a spatially uniform, isothermal and isobaric homogeneous reactor at fixed pressure $p$ and temperature $T$. The composition is restricted to four species: molecular oxygen $\\mathrm{O_2}$, atomic oxygen $\\mathrm{O}$, molecular nitrogen $\\mathrm{N_2}$, and atomic nitrogen $\\mathrm{N}$. The chemistry is represented by two reversible elementary reactions,\n$$\\mathrm{O_2} \\rightleftharpoons 2\\mathrm{O}, \\qquad \\mathrm{N_2} \\rightleftharpoons 2\\mathrm{N}.$$\nAssume ideal-gas behavior. Let the Universal Gas Constant be $R_u$ with units $\\mathrm{J/(mol\\,K)}$. The total molar concentration is given by the ideal gas law $c_{\\mathrm{tot}} = p/(R_u T)$, in units of $\\mathrm{mol/m^3}$. Denote species mole fractions by $x_i$ and species molar concentrations by $c_i = x_i c_{\\mathrm{tot}}$. The molar production rates for reaction $r$ with forward rate $k_{f,r}(T)$ and backward rate $k_{b,r}(T)$ are computed using the law of mass action with elementary orders, yielding reaction rates\n$$r_1 = k_{f,1}(T)\\,c_{\\mathrm{O_2}} - k_{b,1}(T)\\,c_{\\mathrm{O}}^2,\\qquad r_2 = k_{f,2}(T)\\,c_{\\mathrm{N_2}} - k_{b,2}(T)\\,c_{\\mathrm{N}}^2,$$\nwith units $\\mathrm{mol/(m^3\\,s)}$. The species production rates $\\omega_i$ (with units $\\mathrm{mol/(m^3\\,s)}$) follow from stoichiometry:\n$$\\omega_{\\mathrm{O_2}} = -r_1,\\quad \\omega_{\\mathrm{O}} = 2 r_1,\\quad \\omega_{\\mathrm{N_2}} = -r_2,\\quad \\omega_{\\mathrm{N}} = 2 r_2.$$\nBecause the reactions change the total number of molecules, the constant-pressure, constant-temperature constraint implies that the total molar concentration $c_{\\mathrm{tot}}$ remains constant. The mole fraction dynamics must therefore include a normalization term that enforces $\\sum_i x_i = 1$ at all times. Starting from first principles for an ideal gas mixture under isothermal-isobaric conditions, the mole-fraction ordinary differential equation (ODE) system is\n$$\\frac{dx_i}{dt} = \\frac{1}{c_{\\mathrm{tot}}}\\left(\\omega_i - x_i \\sum_j \\omega_j\\right),$$\nfor $i \\in \\{\\mathrm{O_2}, \\mathrm{O}, \\mathrm{N_2}, \\mathrm{N}\\}$, where the summation is over all species.\n\nThe forward rate constants $k_{f,r}(T)$ are given by Arrhenius laws\n$$k_{f,r}(T) = A_r\\,T^{n_r}\\,\\exp\\!\\left(-\\frac{E_{a,r}}{R_u\\,T}\\right),$$\nwith $A_r$ in $\\mathrm{s^{-1}}$, $n_r$ unitless, and $E_{a,r}$ in $\\mathrm{J/mol}$. To ensure thermodynamic consistency through detailed balance, use equilibrium constants $K_{c,r}(T)$ (with units of $\\mathrm{mol/m^3}$) defined by a van 't Hoff relation with a specified reference temperature $T_{\\mathrm{ref}}$ and reference equilibrium constant $K_{c,r}^{\\mathrm{ref}}$,\n$$K_{c,r}(T) = K_{c,r}^{\\mathrm{ref}}\\,\\exp\\!\\left(\\frac{\\Delta H_r}{R_u}\\left(\\frac{1}{T_{\\mathrm{ref}}} - \\frac{1}{T}\\right)\\right),$$\nwhere $\\Delta H_r$ is the (assumed constant) reaction enthalpy in $\\mathrm{J/mol}$ for reaction $r$. Then define the backward rate constants by\n$$k_{b,r}(T) = \\frac{k_{f,r}(T)}{K_{c,r}(T)},$$\nso that $r_r = 0$ implies the mass-action equilibrium condition.\n\nThe equilibrium composition at the same $p$ and $T$ can be computed directly from the mass-action equilibrium relations and element conservation. For the oxygen subset, define the conserved oxygen-atom concentration $a_{\\mathrm{O}}$ by\n$$a_{\\mathrm{O}} = c_{\\mathrm{O}}^0 + 2 c_{\\mathrm{O_2}}^0,$$\nwhere the superscript $0$ denotes the initial (post-shock) concentrations. At equilibrium,\n$$c_{\\mathrm{O}}^2 = K_{c,1}(T)\\,c_{\\mathrm{O_2}},\\qquad c_{\\mathrm{O}} + 2 c_{\\mathrm{O_2}} = a_{\\mathrm{O}}.$$\nIntroducing $z = \\sqrt{c_{\\mathrm{O_2}}}$ and $b_1 = \\sqrt{K_{c,1}(T)}$, the oxygen equilibrium reduces to the quadratic\n$$2 z^2 + b_1 z - a_{\\mathrm{O}} = 0,$$\nwith the physically admissible solution\n$$z = \\frac{-b_1 + \\sqrt{b_1^2 + 8 a_{\\mathrm{O}}}}{4},\\qquad c_{\\mathrm{O_2}}^{\\mathrm{eq}} = z^2,\\qquad c_{\\mathrm{O}}^{\\mathrm{eq}} = b_1 z.$$\nAnalogous formulas hold for nitrogen with $a_{\\mathrm{N}} = c_{\\mathrm{N}}^0 + 2 c_{\\mathrm{N_2}}^0$ and $b_2 = \\sqrt{K_{c,2}(T)}$. Equilibrium mole fractions are $x_i^{\\mathrm{eq}} = c_i^{\\mathrm{eq}}/c_{\\mathrm{tot}}$.\n\nLet molecular weights be $W_{\\mathrm{O_2}} = 0.032\\,\\mathrm{kg/mol}$, $W_{\\mathrm{O}} = 0.016\\,\\mathrm{kg/mol}$, $W_{\\mathrm{N_2}} = 0.028\\,\\mathrm{kg/mol}$, $W_{\\mathrm{N}} = 0.014\\,\\mathrm{kg/mol}$, and define mixture-average molecular weight $W_{\\mathrm{mix}} = \\sum_i x_i W_i$. Mass fractions are $Y_i = x_i W_i/W_{\\mathrm{mix}}$. Define the deviation from equilibrium as the sum of absolute differences in mass fractions at the residence time $t_{\\mathrm{res}}$,\n$$\\Delta = \\sum_{i \\in \\{\\mathrm{O_2},\\mathrm{O},\\mathrm{N_2},\\mathrm{N}\\}} \\left|Y_i(t_{\\mathrm{res}}) - Y_i^{\\mathrm{eq}}\\right|,$$\nwhich is dimensionless.\n\nStarting from initial post-shock mole fractions $x_{\\mathrm{O_2}}^0$, $x_{\\mathrm{O}}^0$, $x_{\\mathrm{N_2}}^0$, $x_{\\mathrm{N}}^0$ that sum to $1$, perform the following for each test case:\n- Integrate the ODE system in time from $t=0$ to $t=t_{\\mathrm{res}}$ at constant $p$ and $T$ to obtain $x_i(t_{\\mathrm{res}})$, then compute $Y_i(t_{\\mathrm{res}})$.\n- Compute the equilibrium mole fractions $x_i^{\\mathrm{eq}}$ using the quadratic formulas and the corresponding $Y_i^{\\mathrm{eq}}$.\n- Return $\\Delta$ as defined above.\n\nUse the following numerically specified parameters, which are scientifically plausible and self-consistent for high-temperature air chemistry modeling:\n- Universal Gas Constant: $R_u = 8.314462618\\,\\mathrm{J/(mol\\,K)}$.\n- Reaction enthalpies: $\\Delta H_1 = 4.94\\times 10^5\\,\\mathrm{J/mol}$ for $\\mathrm{O_2} \\rightleftharpoons 2\\mathrm{O}$, and $\\Delta H_2 = 9.40\\times 10^5\\,\\mathrm{J/mol}$ for $\\mathrm{N_2} \\rightleftharpoons 2\\mathrm{N}$.\n- Arrhenius parameters: $A_1 = 1.0\\times 10^5\\,\\mathrm{s^{-1}}$, $n_1 = 1$, $E_{a,1} = 4.00\\times 10^5\\,\\mathrm{J/mol}$; $A_2 = 1.0\\times 10^5\\,\\mathrm{s^{-1}}$, $n_2 = 1$, $E_{a,2} = 9.40\\times 10^5\\,\\mathrm{J/mol}$.\n- Equilibrium constants at reference temperature $T_{\\mathrm{ref}} = 5000\\,\\mathrm{K}$: $K_{c,1}^{\\mathrm{ref}} = 1.0\\,\\mathrm{mol/m^3}$, $K_{c,2}^{\\mathrm{ref}} = 1.0\\times 10^{-2}\\,\\mathrm{mol/m^3}$.\n\nPhysical units for inputs are mandatory: pressure $p$ in $\\mathrm{Pa}$, temperature $T$ in $\\mathrm{K}$, time $t_{\\mathrm{res}}$ in $\\mathrm{s}$. Angles are not used. All outputs are dimensionless. Use the following test suite of five cases; each case specifies $(p,T,t_{\\mathrm{res}},x_{\\mathrm{O}}^0,x_{\\mathrm{N}}^0)$ with initial mole fractions of atomic species, and molecular initial mole fractions are $x_{\\mathrm{O_2}}^0 = 0.21 - x_{\\mathrm{O}}^0$, $x_{\\mathrm{N_2}}^0 = 0.79 - x_{\\mathrm{N}}^0$:\n1. $(1.0\\times 10^5,\\ 5000,\\ 1.0\\times 10^{-4},\\ 0.0,\\ 0.0)$\n2. $(1.0\\times 10^5,\\ 3000,\\ 1.0\\times 10^{-3},\\ 0.0,\\ 0.0)$\n3. $(5.0\\times 10^5,\\ 7000,\\ 2.0\\times 10^{-4},\\ 0.0,\\ 0.0)$\n4. $(1.0\\times 10^5,\\ 6000,\\ 1.0\\times 10^{-7},\\ 0.0,\\ 0.0)$\n5. $(1.0\\times 10^5,\\ 5000,\\ 1.0\\times 10^{-4},\\ 0.01,\\ 0.005)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"), where each \"result\" is the floating-point value of $\\Delta$ for the corresponding test case in the order given above.",
            "solution": "The problem is a well-posed exercise in chemical kinetics and ordinary differential equations (ODEs), grounded in the fundamental principles of reacting gas dynamics. It requires the simulation of a simplified high-temperature air mixture in a homogeneous reactor and a comparison of the time-evolved state to the chemical equilibrium state. All provided parameters, equations, and constraints are scientifically and mathematically consistent. The problem is therefore deemed valid.\n\nThe solution proceeds in two main parts for each test case: first, the computation of the final chemical equilibrium state, and second, the time-integration of the species mole fractions to find the state at the specified residence time. The deviation between these two states is then calculated.\n\n**1. System and State Variables**\n\nThe system is a mixture of four ideal gas species: $\\mathrm{O_2}$, $\\mathrm{O}$, $\\mathrm{N_2}$, and $\\mathrm{N}$. We can index them as $i=0, 1, 2, 3$ respectively. The state of the system is described by the set of mole fractions $\\{x_i\\}$, where $\\sum_i x_i = 1$. The reactor is held at constant pressure $p$ and temperature $T$. Under these conditions, the total molar concentration $c_{\\mathrm{tot}}$ is also constant, given by the ideal gas law:\n$$c_{\\mathrm{tot}} = \\frac{p}{R_u T}$$\nwhere $R_u = 8.314462618\\,\\mathrm{J/(mol\\,K)}$ is the universal gas constant. The molar concentration of species $i$ is $c_i = x_i c_{\\mathrm{tot}}$.\n\n**2. Chemical Kinetics Model**\n\nThe chemistry is governed by two reversible reactions:\n$$ \\mathrm{O_2} \\rightleftharpoons 2\\mathrm{O} \\quad (\\text{Reaction 1}) $$\n$$ \\mathrm{N_2} \\rightleftharpoons 2\\mathrm{N} \\quad (\\text{Reaction 2}) $$\nThe reaction rates $r_1$ and $r_2$, based on the law of mass action, are:\n$$ r_1 = k_{f,1}(T) c_{\\mathrm{O_2}} - k_{b,1}(T) c_{\\mathrm{O}}^2 $$\n$$ r_2 = k_{f,2}(T) c_{\\mathrm{N_2}} - k_{b,2}(T) c_{\\mathrm{N}}^2 $$\nThe forward rate constants $k_{f,r}(T)$ follow the Arrhenius law:\n$$ k_{f,r}(T) = A_r T^{n_r} \\exp\\left(-\\frac{E_{a,r}}{R_u T}\\right) $$\nThe backward rate constants $k_{b,r}(T)$ are determined via the principle of detailed balance, using the concentration-based equilibrium constants $K_{c,r}(T)$:\n$$ k_{b,r}(T) = \\frac{k_{f,r}(T)}{K_{c,r}(T)} $$\nThe equilibrium constants are calculated using a simplified van 't Hoff relation:\n$$ K_{c,r}(T) = K_{c,r}^{\\mathrm{ref}} \\exp\\left(\\frac{\\Delta H_r}{R_u}\\left(\\frac{1}{T_{\\mathrm{ref}}} - \\frac{1}{T}\\right)\\right) $$\nThe problem provides all necessary parameters: $A_r, n_r, E_{a,r}, \\Delta H_r, T_{\\mathrm{ref}}, K_{c,r}^{\\mathrm{ref}}$.\n\n**3. Governing ODEs for Mole Fractions**\n\nThe rate of change of molar concentration for species $i$ in an isobaric-isothermal system is $\\frac{dc_i}{dt} = \\omega_i - c_i \\frac{\\sum_j \\omega_j}{c_{\\mathrm{tot}}}$, where the species production rates $\\omega_i$ are determined by the reaction stoichiometry:\n$$ \\omega_{\\mathrm{O_2}} = -r_1, \\quad \\omega_{\\mathrm{O}} = 2r_1, \\quad \\omega_{\\mathrm{N_2}} = -r_2, \\quad \\omega_{\\mathrm{N}} = 2r_2 $$\nSince $c_{\\mathrm{tot}}$ is constant, $\\frac{dc_i}{dt} = c_{\\mathrm{tot}} \\frac{dx_i}{dt}$. Substituting this and $c_i = x_i c_{\\mathrm{tot}}$ leads to the governing ODE system for the mole fractions:\n$$ \\frac{dx_i}{dt} = \\frac{1}{c_{\\mathrm{tot}}} \\left( \\omega_i - x_i \\sum_j \\omega_j \\right) $$\nThe sum of production rates is $\\sum_j \\omega_j = (-r_1) + (2r_1) + (-r_2) + (2r_2) = r_1 + r_2$. This system of four coupled ODEs is integrated from $t=0$ to $t=t_{\\mathrm{res}}$ starting from the initial mole fractions $x_i^0$. Due to the potentially vast differences in reaction timescales, this system is typically stiff and requires a suitable numerical integrator, such as one employing Backward Differentiation Formulas (BDF) or Radau methods.\n\n**4. Equilibrium Composition Calculation**\n\nThe equilibrium composition is found by setting the reaction rates to zero ($r_1=0, r_2=0$) and enforcing element conservation. For the oxygen species, the conserved quantity is the total concentration of oxygen atoms, $a_{\\mathrm{O}}$, which remains constant throughout the process:\n$$ a_{\\mathrm{O}} = c_{\\mathrm{O}} + 2c_{\\mathrm{O_2}} = c_{\\mathrm{O}}^0 + 2c_{\\mathrm{O_2}}^0 $$\nAt equilibrium, the law of mass action gives $K_{c,1}(T) = (c_{\\mathrm{O}}^{\\mathrm{eq}})^2 / c_{\\mathrm{O_2}}^{\\mathrm{eq}}$. As derived in the problem statement, this system can be reduced to a quadratic equation for $z = \\sqrt{c_{\\mathrm{O_2}}^{\\mathrm{eq}}}$:\n$$ 2z^2 + b_1 z - a_{\\mathrm{O}} = 0, \\quad \\text{where } b_1 = \\sqrt{K_{c,1}(T)} $$\nThe physically valid solution yields the equilibrium concentrations:\n$$ z = \\frac{-b_1 + \\sqrt{b_1^2 + 8 a_{\\mathrm{O}}}}{4}, \\quad c_{\\mathrm{O_2}}^{\\mathrm{eq}} = z^2, \\quad c_{\\mathrm{O}}^{\\mathrm{eq}} = b_1 z $$\nAn identical procedure is applied to the nitrogen species to find $c_{\\mathrm{N_2}}^{\\mathrm{eq}}$ and $c_{\\mathrm{N}}^{\\mathrm{eq}}$ using the conserved nitrogen atom concentration $a_{\\mathrm{N}} = c_{\\mathrm{N}}^0 + 2c_{\\mathrm{N_2}}^0$. From these equilibrium concentrations, the equilibrium mole fractions are found via $x_i^{\\mathrm{eq}} = c_i^{\\mathrm{eq}} / c_{\\mathrm{tot}}$.\n\n**5. Final Metric Calculation**\n\nFor each test case, we perform the following steps:\n1.  Establish the initial mole fractions $x_i^0$ based on the provided $x_{\\mathrm{O}}^0$ and $x_{\\mathrm{N}}^0$.\n2.  Calculate all temperature-dependent constants ($c_{\\mathrm{tot}}, k_{f,r}, K_{c,r}, k_{b,r}$).\n3.  Calculate the equilibrium concentrations $c_i^{\\mathrm{eq}}$ and mole fractions $x_i^{\\mathrm{eq}}$. Then compute the equilibrium mass fractions $Y_i^{\\mathrm{eq}} = x_i^{\\mathrm{eq}} W_i / \\sum_j(x_j^{\\mathrm{eq}} W_j)$, where $W_i$ is the molar mass of species $i$.\n4.  Numerically integrate the ODE system from $t=0$ to $t=t_{\\mathrm{res}}$ with initial conditions $x_i^0$ to find the final mole fractions $x_i(t_{\\mathrm{res}})$.\n5.  Compute the final mass fractions $Y_i(t_{\\mathrm{res}}) = x_i(t_{\\mathrm{res}}) W_i / \\sum_j(x_j(t_{\\mathrm{res}}) W_j)$.\n6.  The final result is the deviation metric $\\Delta$, computed as the sum of absolute differences in mass fractions:\n    $$ \\Delta = \\sum_{i \\in \\{\\mathrm{O_2},\\mathrm{O},\\mathrm{N_2},\\mathrm{N}\\}} \\left|Y_i(t_{\\mathrm{res}}) - Y_i^{\\mathrm{eq}}\\right| $$\n\nThe implementation will utilize `scipy.integrate.solve_ivp` with the 'Radau' method, which is well-suited for stiff ODEs common in chemical kinetics.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the shock-heated air chemistry problem for a given set of test cases.\n    \"\"\"\n    \n    # Global Constants\n    Ru = 8.314462618  # J/(mol*K)\n    \n    # Species data: O2, O, N2, N\n    # Molecular weights (kg/mol)\n    W = np.array([0.032, 0.016, 0.028, 0.014])\n    \n    # Reaction 1: O2 <=> 2O\n    A1 = 1.0e5       # s^-1\n    n1 = 1.0\n    Ea1 = 4.00e5     # J/mol\n    dH1 = 4.94e5     # J/mol\n    Kc1_ref = 1.0    # mol/m^3\n    \n    # Reaction 2: N2 <=> 2N\n    A2 = 1.0e5       # s^-1\n    n2 = 1.0\n    Ea2 = 9.40e5     # J/mol\n    dH2 = 9.40e5     # J/mol\n    Kc2_ref = 1.0e-2 # mol/m^3\n    \n    T_ref = 5000.0   # K\n\n    test_cases = [\n        # (p [Pa], T [K], t_res [s], x_O^0, x_N^0)\n        (1.0e5, 5000.0, 1.0e-4, 0.0, 0.0),\n        (1.0e5, 3000.0, 1.0e-3, 0.0, 0.0),\n        (5.0e5, 7000.0, 2.0e-4, 0.0, 0.0),\n        (1.0e5, 6000.0, 1.0e-7, 0.0, 0.0),\n        (1.0e5, 5000.0, 1.0e-4, 0.01, 0.005)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        p, T, t_res, x_O_0, x_N_0 = case\n        \n        # Initial mole fractions\n        x0 = np.array([\n            0.21 - x_O_0,  # O2\n            x_O_0,         # O\n            0.79 - x_N_0,  # N2\n            x_N_0          # N\n        ])\n        \n        # --- Pre-computation of constants for the given T ---\n        ctot = p / (Ru * T)\n        \n        # Forward rate constants\n        kf1 = A1 * (T**n1) * np.exp(-Ea1 / (Ru * T))\n        kf2 = A2 * (T**n2) * np.exp(-Ea2 / (Ru * T))\n        \n        # Equilibrium constants\n        Kc1 = Kc1_ref * np.exp((dH1 / Ru) * (1/T_ref - 1/T))\n        Kc2 = Kc2_ref * np.exp((dH2 / Ru) * (1/T_ref - 1/T))\n        \n        # Backward rate constants\n        kb1 = kf1 / Kc1\n        kb2 = kf2 / Kc2\n        \n        # --- Equilibrium Composition Calculation ---\n        c0 = x0 * ctot\n        \n        # Oxygen\n        a_O = c0[1] + 2 * c0[0]\n        b1 = np.sqrt(Kc1)\n        z1_num = -b1 + np.sqrt(b1**2 + 8 * a_O)\n        z1 = z1_num / 4.0\n        c_O2_eq = z1**2\n        c_O_eq = b1 * z1\n        \n        # Nitrogen\n        a_N = c0[3] + 2 * c0[2]\n        b2 = np.sqrt(Kc2)\n        z2_num = -b2 + np.sqrt(b2**2 + 8 * a_N)\n        z2 = z2_num / 4.0\n        c_N2_eq = z2**2\n        c_N_eq = b2 * z2\n        \n        c_eq = np.array([c_O2_eq, c_O_eq, c_N2_eq, c_N_eq])\n        x_eq = c_eq / ctot\n        \n        W_mix_eq = np.sum(x_eq * W)\n        Y_eq = (x_eq * W) / W_mix_eq\n        \n        # --- ODE Integration ---\n        def ode_system(t, x):\n            # x_i must not become negative due to numerical error\n            x = np.maximum(x, 0)\n            x /= np.sum(x)\n            \n            c = x * ctot\n            c_O2, c_O, c_N2, c_N = c\n            \n            # Reaction rates\n            r1 = kf1 * c_O2 - kb1 * c_O**2\n            r2 = kf2 * c_N2 - kb2 * c_N**2\n            \n            # Species production rates\n            omega_O2 = -r1\n            omega_O = 2 * r1\n            omega_N2 = -r2\n            omega_N = 2 * r2\n            \n            omega = np.array([omega_O2, omega_O, omega_N2, omega_N])\n            omega_sum = r1 + r2\n            \n            dxdt = (omega - x * omega_sum) / ctot\n            return dxdt\n            \n        sol = solve_ivp(ode_system, [0, t_res], x0, method='Radau', atol=1e-12, rtol=1e-8)\n        \n        x_res = sol.y[:, -1]\n        \n        # --- Final Deviation Calculation ---\n        W_mix_res = np.sum(x_res * W)\n        Y_res = (x_res * W) / W_mix_res\n        \n        delta = np.sum(np.abs(Y_res - Y_eq))\n        results.append(delta)\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}