{
    "hands_on_practices": [
        {
            "introduction": "几何守恒律（GCL）本质上是关于移动控制体积运动学的声明。这项练习提供了一个直接的实践机会，通过计算一个具体的三维单元格的体积变化率，来验证 GCL 的微分形式 $\\dot{V} = \\sum_f \\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f$。这个基础计算将有助于巩固对 GCL 核心物理意义的理解。",
            "id": "3962113",
            "problem": "考虑在几何守恒律 (GCL) 下，计算流体动力学 (CFD) 中的一个移动的六面体控制体积。其顶点标记为 $\\mathbf{x}_{i}(t)$（$i=1,\\dots,8$），在时间 $t=0$ 时，它们构成一个与坐标轴对齐的长方体，边长分别为 $L_{x}=2$ 米、$L_{y}=3$ 米和 $L_{z}=4$ 米。具体而言，在 $t=0$ 时的顶点位置为\n$$\n\\mathbf{x}_{1}=(0,0,0),\\quad \\mathbf{x}_{2}=(2,0,0),\\quad \\mathbf{x}_{3}=(2,3,0),\\quad \\mathbf{x}_{4}=(0,3,0),\n$$\n$$\n\\mathbf{x}_{5}=(0,0,4),\\quad \\mathbf{x}_{6}=(2,0,4),\\quad \\mathbf{x}_{7}=(2,3,4),\\quad \\mathbf{x}_{8}=(0,3,4).\n$$\n这些顶点以在空间中呈仿射关系的网格速度移动，在 $t=0$ 时由下式给出：\n$$\n\\mathbf{v}_{i}=\\mathbf{b}+\\alpha\\,\\mathbf{x}_{i},\\qquad \\mathbf{b}=(0.2,-0.1,0.05)\\ \\text{m/s},\\quad \\alpha=0.05\\ \\text{s}^{-1}.\n$$\n面被视为向外定向。对于六个四边形面中的每一个，使用将面剖分为两个三角形的方法，在面上选择一个固定的局部参考顶点，并通过相关的三角形面积矢量的叉积构造，来构建在 $t=0$ 时的定向面积矢量 $\\mathbf{A}_{f}(0)$。然后，仅使用顶点速度和这些面面积矢量，从第一性原理推导由此移动网格的 GCL 运动学所蕴含的控制体积时间导数 $\\dot{V}(0)$。\n\n以立方米/秒为单位表示您最终的 $\\dot{V}(0)$。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题是适定的，有科学依据且内部一致，是一个有效的计算流体动力学问题。我们将进行完整推导。\n\n一个控制体积 $V(t)$ 的时间导数，其边界面 $\\partial V(t)$ 以网格速度场 $\\mathbf{v}_g(\\mathbf{x},t)$ 移动，由几何守恒律 (GCL) 给出。GCL 的积分形式表明，体积的变化率等于网格速度通过该体积边界的通量：\n$$ \\frac{dV}{dt} = \\int_{\\partial V} \\mathbf{v}_g \\cdot d\\mathbf{A} $$\n对于一个离散的六面体控制体积，该积分变为对其六个面（由索引 $f$ 表示）的求和：\n$$ \\dot{V}(t) = \\frac{dV}{dt} = \\sum_{f=1}^{6} \\int_{A_f} \\mathbf{v}_g(\\mathbf{x}, t) \\cdot d\\mathbf{A}_f $$\n其中 $A_f$ 是面 $f$ 的面积，$d\\mathbf{A}_f$ 是指向外部的微分面积矢量。\n\n问题指定了在时间 $t=0$ 时的仿射网格速度场：\n$$ \\mathbf{v}_g(\\mathbf{x}) = \\mathbf{b} + \\alpha \\mathbf{x} $$\n其中 $\\mathbf{b} = (0.2, -0.1, 0.05) \\, \\text{m/s}$ 和 $\\alpha = 0.05 \\, \\text{s}^{-1}$ 是常数。\n\n将速度场代入单个面 $f$ 的通量表达式中：\n$$ \\int_{A_f} \\mathbf{v}_g \\cdot d\\mathbf{A}_f = \\int_{A_f} (\\mathbf{b} + \\alpha \\mathbf{x}) \\cdot d\\mathbf{A}_f = \\int_{A_f} \\mathbf{b} \\cdot d\\mathbf{A}_f + \\int_{A_f} \\alpha \\mathbf{x} \\cdot d\\mathbf{A}_f $$\n由于 $\\mathbf{b}$ 和 $\\alpha$ 是常数，我们可以将它们移到积分符号外：\n$$ \\int_{A_f} \\mathbf{v}_g \\cdot d\\mathbf{A}_f = \\mathbf{b} \\cdot \\int_{A_f} d\\mathbf{A}_f + \\alpha \\int_{A_f} \\mathbf{x} \\cdot d\\mathbf{A}_f $$\n第一个积分就是面面积矢量，$\\mathbf{A}_f = \\int_{A_f} d\\mathbf{A}_f$。\n对于第二个积分，我们注意到在 $t=0$ 时，六面体的每个面都是一个平面四边形。对于一个平面，$d\\mathbf{A}_f = \\mathbf{n}_f dA_f$，其中 $\\mathbf{n}_f$ 是常数单位法向量。面心的位置矢量定义为 $\\mathbf{x}_{c,f} = \\frac{1}{|A_f|} \\int_{A_f} \\mathbf{x} \\, dA_f$。该积分变为：\n$$ \\int_{A_f} \\mathbf{x} \\cdot d\\mathbf{A}_f = \\int_{A_f} (\\mathbf{x} \\cdot \\mathbf{n}_f) \\, dA_f $$\n对于一个平面，项 $\\mathbf{x} \\cdot \\mathbf{n}_f$ 对于面上所有的点 $\\mathbf{x}$ 都是一个常数。设这个常数为 $d_f$。因此，$d_f = \\mathbf{x}_{c,f} \\cdot \\mathbf{n}_f$。该积分简化为：\n$$ (\\mathbf{x}_{c,f} \\cdot \\mathbf{n}_f) \\int_{A_f} dA_f = (\\mathbf{x}_{c,f} \\cdot \\mathbf{n}_f) |A_f| = \\mathbf{x}_{c,f} \\cdot (|A_f| \\mathbf{n}_f) = \\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f $$\n因此，通过单个面的通量可以精确地表示为：\n$$ \\int_{A_f} \\mathbf{v}_g \\cdot d\\mathbf{A}_f = \\mathbf{b} \\cdot \\mathbf{A}_f + \\alpha (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f) = (\\mathbf{b} + \\alpha \\mathbf{x}_{c,f}) \\cdot \\mathbf{A}_f $$\n对所有六个面求和，以求得总体积变化率：\n$$ \\dot{V}(0) = \\sum_{f=1}^{6} (\\mathbf{b} \\cdot \\mathbf{A}_f + \\alpha (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f)) = \\mathbf{b} \\cdot \\left(\\sum_{f=1}^{6} \\mathbf{A}_f\\right) + \\alpha \\sum_{f=1}^{6} (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f) $$\n对于任何闭合体积，指向外部的面面积矢量的总和为零，即 $\\sum_{f=1}^{6} \\mathbf{A}_f = \\mathbf{0}$。这意味着速度场中的纯平移部分 $\\mathbf{b}$ 不对体积变化产生贡献。$\\dot{V}(0)$ 的表达式简化为：\n$$ \\dot{V}(0) = \\alpha \\sum_{f=1}^{6} (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f) $$\n我们现在计算在 $t=0$ 时六面体所需的几何量。边长为 $L_x=2$ 米、$L_y=3$ 米和 $L_z=4$ 米。\n\n1.  **面 1 (底面, $z=0$):**\n    顶点 $\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_3, \\mathbf{x}_4$。外法线方向为 $-z$ 方向。\n    $\\mathbf{A}_1 = (0, 0, -L_x L_y) = (0, 0, -6) \\, \\text{m}^2$。\n    面心 $\\mathbf{x}_{c,1} = (\\frac{L_x}{2}, \\frac{L_y}{2}, 0) = (1, 1.5, 0) \\, \\text{m}$。\n    $\\mathbf{x}_{c,1} \\cdot \\mathbf{A}_1 = (1, 1.5, 0) \\cdot (0, 0, -6) = 0$。\n\n2.  **面 2 (顶面, $z=L_z=4$):**\n    顶点 $\\mathbf{x}_5, \\mathbf{x}_6, \\mathbf{x}_7, \\mathbf{x}_8$。外法线方向为 $+z$ 方向。\n    $\\mathbf{A}_2 = (0, 0, L_x L_y) = (0, 0, 6) \\, \\text{m}^2$。\n    面心 $\\mathbf{x}_{c,2} = (\\frac{L_x}{2}, \\frac{L_y}{2}, L_z) = (1, 1.5, 4) \\, \\text{m}$。\n    $\\mathbf{x}_{c,2} \\cdot \\mathbf{A}_2 = (1, 1.5, 4) \\cdot (0, 0, 6) = 4 \\times 6 = 24 \\, \\text{m}^3$。\n\n3.  **面 3 (后面, $y=0$):**\n    顶点 $\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_6, \\mathbf{x}_5$。外法线方向为 $-y$ 方向。\n    $\\mathbf{A}_3 = (0, -L_x L_z, 0) = (0, -8, 0) \\, \\text{m}^2$。\n    面心 $\\mathbf{x}_{c,3} = (\\frac{L_x}{2}, 0, \\frac{L_z}{2}) = (1, 0, 2) \\, \\text{m}$。\n    $\\mathbf{x}_{c,3} \\cdot \\mathbf{A}_3 = (1, 0, 2) \\cdot (0, -8, 0) = 0$。\n\n4.  **面 4 (前面, $y=L_y=3$):**\n    顶点 $\\mathbf{x}_4, \\mathbf{x}_3, \\mathbf{x}_7, \\mathbf{x}_8$。外法线方向为 $+y$ 方向。\n    $\\mathbf{A}_4 = (0, L_x L_z, 0) = (0, 8, 0) \\, \\text{m}^2$。\n    面心 $\\mathbf{x}_{c,4} = (\\frac{L_x}{2}, L_y, \\frac{L_z}{2}) = (1, 3, 2) \\, \\text{m}$。\n    $\\mathbf{x}_{c,4} \\cdot \\mathbf{A}_4 = (1, 3, 2) \\cdot (0, 8, 0) = 3 \\times 8 = 24 \\, \\text{m}^3$。\n\n5.  **面 5 (左面, $x=0$):**\n    顶点 $\\mathbf{x}_1, \\mathbf{x}_4, \\mathbf{x}_8, \\mathbf{x}_5$。外法线方向为 $-x$ 方向。\n    $\\mathbf{A}_5 = (-L_y L_z, 0, 0) = (-12, 0, 0) \\, \\text{m}^2$。\n    面心 $\\mathbf{x}_{c,5} = (0, \\frac{L_y}{2}, \\frac{L_z}{2}) = (0, 1.5, 2) \\, \\text{m}$。\n    $\\mathbf{x}_{c,5} \\cdot \\mathbf{A}_5 = (0, 1.5, 2) \\cdot (-12, 0, 0) = 0$。\n\n6.  **面 6 (右面, $x=L_x=2$):**\n    顶点 $\\mathbf{x}_2, \\mathbf{x}_3, \\mathbf{x}_7, \\mathbf{x}_6$。外法线方向为 $+x$ 方向。\n    $\\mathbf{A}_6 = (L_y L_z, 0, 0) = (12, 0, 0) \\, \\text{m}^2$。\n    按照要求，我们可以通过三角剖分来验证这个面积矢量，例如，使用以 $\\mathbf{x}_2=(2,0,0)$ 为参考点的三角形 $(2,3,7)$ 和 $(2,7,6)$。总面积矢量为 $\\frac{1}{2}(\\vec{\\mathbf{x}_2\\mathbf{x}_3} \\times \\vec{\\mathbf{x}_2\\mathbf{x}_7}) + \\frac{1}{2}(\\vec{\\mathbf{x}_2\\mathbf{x}_7} \\times \\vec{\\mathbf{x}_2\\mathbf{x}_6}) = \\frac{1}{2}(12,0,0) + \\frac{1}{2}(12,0,0) = (12,0,0)$，这是正确的。\n    面心 $\\mathbf{x}_{c,6} = (L_x, \\frac{L_y}{2}, \\frac{L_z}{2}) = (2, 1.5, 2) \\, \\text{m}$。\n    $\\mathbf{x}_{c,6} \\cdot \\mathbf{A}_6 = (2, 1.5, 2) \\cdot (12, 0, 0) = 2 \\times 12 = 24 \\, \\text{m}^3$。\n\n现在，我们将点积求和：\n$$ \\sum_{f=1}^{6} (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f) = 0 + 24 + 0 + 24 + 0 + 24 = 72 \\, \\text{m}^3 $$\n最后，我们通过乘以 $\\alpha$ 来计算 $\\dot{V}(0)$：\n$$ \\dot{V}(0) = \\alpha \\times 72 \\, \\text{m}^3 = 0.05 \\, \\text{s}^{-1} \\times 72 \\, \\text{m}^3 = 3.6 \\, \\text{m}^3/\\text{s} $$\n在 $t=0$ 时控制体积的时间导数是 $3.6 \\, \\text{m}^3/\\text{s}$。四舍五入到四位有效数字得到 $3.600 \\, \\text{m}^3/\\text{s}$。\n\n这个结果可以使用散度定理对速度场进行验证。$\\nabla \\cdot \\mathbf{v}_g = \\nabla \\cdot (\\mathbf{b} + \\alpha \\mathbf{x}) = \\nabla \\cdot \\mathbf{b} + \\alpha (\\nabla \\cdot \\mathbf{x}) = 0 + \\alpha(1+1+1) = 3\\alpha$。由于散度是常数，$\\dot{V} = \\int_V \\nabla \\cdot \\mathbf{v}_g dV = (3\\alpha) V_0$。初始体积为 $V_0 = 2 \\times 3 \\times 4 = 24 \\, \\text{m}^3$。因此，$\\dot{V}(0) = 3 \\times 0.05 \\times 24 = 0.15 \\times 24 = 3.6 \\, \\text{m}^3/\\text{s}$，这证实了我们逐面计算的结果。",
            "answer": "$$\n\\boxed{3.600}\n$$"
        },
        {
            "introduction": "在将连续的控制方程应用于数值求解器时，必须将其离散化。此练习的核心在于确保几何守恒律（GCL）的离散化精度与整个数值格式的精度相匹配。您将通过推导，揭示为实现高保真CFD中常见的二阶时间精度，几何量（如面矢量和网格速度）必须如何进行时间离散。这项实践对于正确实现任意拉格朗日-欧拉（ALE）方法至关重要。",
            "id": "3962139",
            "problem": "考虑在移动网格上，任意拉格朗日-欧拉 (ALE) 框架中可压缩流的三维有限体积离散化。设一个体积为 $V(t)$ 的控制体（单元）$C(t)$ 由一组平面 $f \\in \\mathcal{F}(t)$ 界定，每个平面具有定向面面积矢量 $\\boldsymbol{A}_f(t)$ 和面心位置 $\\boldsymbol{x}_f(t)$。面 $f$ 处的网格速度定义为 $\\boldsymbol{v}_{g,f}(t) = \\frac{d \\boldsymbol{x}_f}{dt}(t)$。守恒变量的离散更新采用单步 $\\theta$ 方法，使用单一时间步长 $\\Delta t = t^{n+1} - t^{n}$ 进行时间推进，其中基于面的几何量和通量在中间时刻 $t^{n+\\theta} = t^{n} + \\theta \\,\\Delta t$ 进行评估。\n\n几何守恒律 (GCL) 要求，在离散化后，均匀守恒态在网格运动下保持精确均匀。从应用于移动控制体 $C(t)$ 上的标量场 $\\phi(\\boldsymbol{x},t) \\equiv 1$ 的雷诺输运定理出发，并仅使用运动学定义和标准时间离散化原理，推导参数 $\\theta$ 以及面面积矢量 $\\boldsymbol{A}_f$ 和网格速度 $\\boldsymbol{v}_{g,f}$ 必须如何随时间进行评估的条件，以使得：\n- 将控制体体积变化与网格速度通量等同的时间离散恒等式满足时间二阶精度，并且\n- 该格式在单个时间步内以二阶时间精度保持均匀态。\n\n您的最终答案必须是一个单一的闭式解析表达式，包含参数 $\\theta$ 的值以及在所需时间层上 $\\boldsymbol{A}_f$ 和 $\\boldsymbol{v}_{g,f}$ 的二阶相容的计算方式。无需进行数值取整，最终表达式中不应包含任何物理单位。使用 LaTeX 的 $\\mathrm{pmatrix}$ 环境，将最终表达式的多个分量表示为单个行矩阵。",
            "solution": "该问题要求推导在使用单步 $\\theta$ 方法的移动网格有限体积格式中，实现二阶精度几何守恒律 (GCL) 的条件。\n\n出发点是针对体积为 $V(t)$、边界为 $\\partial C(t)$ 的任意移动控制体 $C(t)$ 的雷诺输运定理。对于一个标量场 $\\phi(\\boldsymbol{x}, t)$，该定理表述为：\n$$\n\\frac{d}{dt} \\int_{C(t)} \\phi \\, dV = \\int_{C(t)} \\frac{\\partial \\phi}{\\partial t} \\, dV + \\oint_{\\partial C(t)} \\phi \\, \\boldsymbol{v}_g \\cdot d\\boldsymbol{A}\n$$\n其中 $\\boldsymbol{v}_g$ 是边界 $\\partial C(t)$ 的速度，而 $d\\boldsymbol{A}$ 是指向外部的微分面积矢量。\n\n通过设置标量场 $\\phi \\equiv 1$ 可以得到几何守恒律。在这种情况下，$\\phi$ 在空间和时间上都是常数，因此 $\\frac{\\partial \\phi}{\\partial t} = 0$。$\\phi$ 在体积 $C(t)$ 上的积分就是体积 $V(t)$。因此，雷诺输运定理简化为一个纯运动学恒等式：\n$$\n\\frac{dV(t)}{dt} = \\oint_{\\partial C(t)} \\boldsymbol{v}_g \\cdot d\\boldsymbol{A}\n$$\n这是 GCL 的连续形式。它表示单元体积的变化率等于网格速度通过单元边界的通量。\n\n对于有限体积离散化，控制体 $C(t)$ 是一个由一组平面 $f$ 界定的单元。面积分被替换为对所有面的求和：\n$$\n\\frac{dV(t)}{dt} = \\sum_{f \\in \\mathcal{F}(t)} \\boldsymbol{v}_{g,f}(t) \\cdot \\boldsymbol{A}_f(t)\n$$\n其中 $\\boldsymbol{v}_{g,f}(t)$ 是面 $f$ 的面心处的网格速度，$\\boldsymbol{A}_f(t)$ 是面 $f$ 的定向面积矢量。\n\n问题指出，该方程使用单步 $\\theta$ 方法进行时间离散化，各物理量在中间时刻 $t^{n+\\theta} = t^n + \\theta \\Delta t$ 进行评估。因此，GCL 的离散形式为：\n$$\n\\frac{V^{n+1} - V^n}{\\Delta t} = \\sum_{f} \\left( \\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f \\right)^{n+\\theta}\n$$\n其中上标 $n$ 和 $n+1$ 分别表示在时刻 $t^n$ 和 $t^{n+1} = t^n + \\Delta t$ 的评估值。左边的项代表体积的时间导数，右边的项代表网格速度的通量。为了使 GCL 满足二阶时间精度，此方程的误差必须为 $O(\\Delta t^2)$ 阶。\n\n让我们使用在时间 $t^{n+\\theta}$ 附近的泰勒级数展开来分析方程的两边。\n左手边 (LHS) 是时间导数 $\\frac{dV}{dt}$ 的一个近似。让我们在 $t^{n+\\theta}$ 附近展开 $V^{n+1}$ 和 $V^n$：\n$$\nV^{n+1} = V(t^{n+\\theta} + (1-\\theta)\\Delta t) = V^{n+\\theta} + (1-\\theta)\\Delta t \\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{((1-\\theta)\\Delta t)^2}{2} \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^3)\n$$\n$$\nV^{n} = V(t^{n+\\theta} - \\theta\\Delta t) = V^{n+\\theta} - \\theta\\Delta t \\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{(-\\theta\\Delta t)^2}{2} \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^3)\n$$\n从第一个展开式中减去第二个展开式，然后除以 $\\Delta t$：\n$$\n\\frac{V^{n+1} - V^{n}}{\\Delta t} = \\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{(1-\\theta)^2 - \\theta^2}{2} \\Delta t \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^2)\n$$\n$$\n\\frac{V^{n+1} - V^{n}}{\\Delta t} = \\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{1-2\\theta}{2} \\Delta t \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^2)\n$$\n离散 GCL 的右手边 (RHS) 根据定义是在 $t^{n+\\theta}$ 处评估的网格速度通量：\n$$\n\\text{RHS} = \\sum_{f} \\left( \\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f \\right)^{n+\\theta} = \\left( \\oint_{\\partial C} \\boldsymbol{v}_g \\cdot d\\boldsymbol{A} \\right)^{n+\\theta}\n$$\n根据连续 GCL，这等于 $\\left(\\frac{dV}{dt}\\right)^{n+\\theta}$。\n将 LHS 的展开式与 RHS 等同起来：\n$$\n\\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{1-2\\theta}{2} \\Delta t \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^2) = \\left(\\frac{dV}{dt}\\right)^{n+\\theta}\n$$\n为了使该等式在 $O(\\Delta t^2)$ 误差下成立，一阶误差项（与 $\\Delta t$ 成正比）必须为零。假设在一般网格运动中 $\\frac{d^2V}{dt^2} \\neq 0$，我们要求：\n$$\n\\frac{1-2\\theta}{2} = 0 \\implies \\theta = \\frac{1}{2}\n$$\n这确定了时间积分必须是中心差分（等效于 Crank-Nicolson 方法）才能实现二阶时间精度。因此，评估时间为 $t^{n+1/2}$。\n\n接下来，我们必须确定几何量 $\\boldsymbol{v}_{g,f}$ 和 $\\boldsymbol{A}_f$ 在 $t^{n+1/2}$ 时刻应如何评估以保持二阶精度。该格式要求评估乘积 $(\\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f)^{n+1/2}$。我们需要利用 $t^n$ 和 $t^{n+1}$ 时刻的信息，找到 $\\boldsymbol{v}_{g,f}^{n+1/2}$ 和 $\\boldsymbol{A}_f^{n+1/2}$ 的表达式，使得它们的乘积是 $(\\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f)$ 在 $t^{n+1/2}$ 时刻的二阶精度近似。\n\n让我们考虑网格速度 $\\boldsymbol{v}_{g,f} = \\frac{d\\boldsymbol{x}_f}{dt}$。在中间时刻 $t^{n+1/2}$ 处速度的一个二阶精度的中心差分近似由下式给出：\n$$\n\\boldsymbol{v}_{g,f}^{n+1/2} = \\frac{\\boldsymbol{x}_f^{n+1} - \\boldsymbol{x}_f^{n}}{\\Delta t}\n$$\n为验证其精度，我们在 $t^{n+1/2}$ 附近展开 $\\boldsymbol{x}_f^{n+1}$ 和 $\\boldsymbol{x}_f^{n}$：\n$$\n\\boldsymbol{x}_f^{n+1} = \\boldsymbol{x}_f^{n+1/2} + \\frac{\\Delta t}{2} \\dot{\\boldsymbol{x}}_f^{n+1/2} + \\frac{(\\Delta t/2)^2}{2!} \\ddot{\\boldsymbol{x}}_f^{n+1/2} + O(\\Delta t^3)\n$$\n$$\n\\boldsymbol{x}_f^{n} = \\boldsymbol{x}_f^{n+1/2} - \\frac{\\Delta t}{2} \\dot{\\boldsymbol{x}}_f^{n+1/2} + \\frac{(\\Delta t/2)^2}{2!} \\ddot{\\boldsymbol{x}}_f^{n+1/2} - O(\\Delta t^3)\n$$\n$$\n\\frac{\\boldsymbol{x}_f^{n+1} - \\boldsymbol{x}_f^{n}}{\\Delta t} = \\dot{\\boldsymbol{x}}_f^{n+1/2} + O(\\Delta t^2) = \\boldsymbol{v}_{g,f}(t^{n+1/2}) + O(\\Delta t^2)\n$$\n此近似确实是二阶精度的。\n\n对于面面积矢量 $\\boldsymbol{A}_f$，在 $t^{n+1/2}$ 处的一个自然的二阶近似是其在 $t^n$ 和 $t^{n+1}$ 处值的算术平均：\n$$\n\\boldsymbol{A}_f^{n+1/2} = \\frac{\\boldsymbol{A}_f^n + \\boldsymbol{A}_f^{n+1}}{2}\n$$\n此近似的误差为 $O(\\Delta t^2)$：\n$$\n\\frac{\\boldsymbol{A}_f^n + \\boldsymbol{A}_f^{n+1}}{2} = \\frac{1}{2}\\left[\\left(\\boldsymbol{A}_f^{n+1/2} \\!-\\! \\frac{\\Delta t}{2} \\dot{\\boldsymbol{A}}_f^{n+1/2} \\!+\\! O(\\Delta t^2)\\right) \\!+\\! \\left(\\boldsymbol{A}_f^{n+1/2} \\!+\\! \\frac{\\Delta t}{2} \\dot{\\boldsymbol{A}}_f^{n+1/2} \\!+\\! O(\\Delta t^2)\\right)\\right] = \\boldsymbol{A}_f(t^{n+1/2}) + O(\\Delta t^2)\n$$\n\n根据这些定义，近似值的乘积也是二阶精度的：\n$$\n\\boldsymbol{v}_{g,f}^{n+1/2} \\cdot \\boldsymbol{A}_f^{n+1/2} = (\\boldsymbol{v}_{g,f}(t^{n+1/2}) + O(\\Delta t^2)) \\cdot (\\boldsymbol{A}_f(t^{n+1/2}) + O(\\Delta t^2)) = (\\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f)^{n+1/2} + O(\\Delta t^2)\n$$\n因此，离散 GCL 方程以二阶精度得到满足。\n\n问题的第二部分要求该格式能以二阶精度保持均匀态。对于具有均匀守恒态矢量 $\\boldsymbol{U}_{const}$ 的流动，单元 $C$ 的离散化控制方程为：\n$$\n\\frac{\\boldsymbol{U}_{C}^{n+1}V^{n+1} - \\boldsymbol{U}_{C}^{n}V^{n}}{\\Delta t} + \\sum_{f} \\boldsymbol{\\mathcal{F}}_f^{n+1/2} = 0\n$$\n如果对所有单元都有 $\\boldsymbol{U}_{C}^n = \\boldsymbol{U}_{const}$，那么为了保持该状态，我们必须有 $\\boldsymbol{U}_{C}^{n+1} = \\boldsymbol{U}_{const}$。方程变为：\n$$\n\\boldsymbol{U}_{const} \\left(\\frac{V^{n+1} - V^{n}}{\\Delta t}\\right) + \\sum_{f} \\boldsymbol{\\mathcal{F}}_f^{n+1/2} = 0\n$$\n对于均匀态，物理通量在所有面上都是恒定的，数值通量 $\\boldsymbol{\\mathcal{F}}_f$ 也得以简化。例如，对于欧拉方程，通量为 $\\boldsymbol{F}(\\boldsymbol{U}) - \\boldsymbol{U} (\\boldsymbol{v}_{g,f})^T$。对于均匀态，这导致了一个关于几何项的条件。物理通量在一个闭合单元上的离散总和为零，$\\sum_f \\boldsymbol{F}(\\boldsymbol{U}_{const}) \\cdot \\boldsymbol{A}_f^{n+1/2} = \\boldsymbol{F}(\\boldsymbol{U}_{const}) \\cdot (\\sum_f \\boldsymbol{A}_f^{n+1/2}) = 0$。余下的项给出：\n$$\n\\boldsymbol{U}_{const} \\left(\\frac{V^{n+1} - V^{n}}{\\Delta t}\\right) - \\sum_{f} \\boldsymbol{U}_{const} (\\boldsymbol{v}_{g,f}^{n+1/2})^T \\boldsymbol{A}_f^{n+1/2} = 0\n$$\n提出公因子 $\\boldsymbol{U}_{const}$ 后，恰好得到离散的 GCL：\n$$\n\\frac{V^{n+1} - V^{n}}{\\Delta t} - \\sum_{f} \\boldsymbol{v}_{g,f}^{n+1/2} \\cdot \\boldsymbol{A}_f^{n+1/2} = 0\n$$\n因此，满足二阶精度的 GCL 是以二阶精度保持均匀态的充分必要条件。\n\n总之，三个必需的条件是：\n1.  时间积分参数必须是 $\\theta = 1/2$。\n2.  中间时刻的面面积矢量必须计算为算术平均值：$\\boldsymbol{A}_f^{n+1/2} = \\frac{\\boldsymbol{A}_f^n + \\boldsymbol{A}_f^{n+1}}{2}$。\n3.  中间时刻的面网格速度必须使用面心位置的中心差分来计算：$\\boldsymbol{v}_{g,f}^{n+1/2} = \\frac{\\boldsymbol{x}_f^{n+1} - \\boldsymbol{x}_f^n}{\\Delta t}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}  \\frac{\\boldsymbol{A}_f^{n} + \\boldsymbol{A}_f^{n+1}}{2}  \\frac{\\boldsymbol{x}_f^{n+1} - \\boldsymbol{x}_f^{n}}{\\Delta t}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论推导的最终检验在于实践。这项最终的动手实践将理论与实际后果联系起来，要求您编写一个完整的数值实验。您将通过一个精心设计的网格运动，故意违反几何守恒律，并亲眼观察这种看似抽象的数值误差如何在一个均匀流场中产生虚假的压力振荡。这个练习将深刻地揭示在任何ALE代码中严格遵守GCL的绝对必要性。",
            "id": "3962168",
            "problem": "您的任务是构建一个自洽的数值实验，以揭示几何守恒律 (GCL) 在计算流体力学 (CFD) 的移动网格任意拉格朗日-欧拉 (ALE) 格式中的必要性。从移动网格守恒律的基本控制体形式出发，推导并实现一个最小的一维有限体积更新方法，该方法需能展示控制体变化与网格对流通量之间的不一致性如何在均匀流中产生伪压力振荡。您的程序必须是一个完整的、可运行的实现。\n\n您必须使用的基础是移动控制体上的积分守恒律和理想气体状态方程：\n- 积分守恒律：对于守恒状态向量 $U$ 和物理通量 $F$，在具有边界 $\\partial \\Omega(t)$ 和外向单位法向量 $\\boldsymbol{n}$ 的控制体 $\\Omega(t)$ 上，任意拉格朗日-欧拉 (ALE) 形式的守恒律表述为\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega(t)} U \\,\\mathrm{d}\\Omega + \\oint_{\\partial \\Omega(t)} \\left(F - U \\,\\boldsymbol{w}\\right)\\cdot \\boldsymbol{n} \\,\\mathrm{d}S = 0,\n$$\n其中 $\\boldsymbol{w}$ 是网格速度。\n- 几何守恒律 (GCL)：控制体体积的时间变化率必须满足\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left|\\Omega(t)\\right| = \\oint_{\\partial \\Omega(t)} \\boldsymbol{w}\\cdot \\boldsymbol{n}\\,\\mathrm{d}S,\n$$\n从而保证均匀解在网格运动下得以保持。\n- 理想气体状态方程：对于比热比 $\\gamma$、密度 $\\rho$、速度 $u$、比总能 $E$ 以及比内能 $e = E - \\tfrac{1}{2}u^2$，压力为\n$$\np = (\\gamma - 1)\\,\\rho\\,e.\n$$\n\n您必须设计一个构造的一维网格运动和一个均匀初始状态，使得任何对离散GCL的违背都表现为伪压力振荡。在一维移动网格上，为守恒变量实现一个一阶、单元中心的有限体积更新方法，并假设初始流场是均匀的且物理通量为零。其关键思想是，对于物理通量为零的均匀状态 $U$，更新格式简化为控制体变化与网格对流项之间的平衡。如果这两者在离散上不一致（即违背GCL），该格式将对 $U$ 引入一个非零的更新，通过理想气体关系表现为伪压力变化。\n\n为面位置 $x_i(t)$（单位：米）构造一个正弦网格运动：\n$$\nx_i(t) = x_i(0) + A\\,\\sin\\!\\left(\\omega\\,t + \\phi_i\\right),\n$$\n其中 $A$ 是振幅（单位：米），$\\omega$ 是角频率（单位：弧度/秒），$\\phi_i = \\beta\\,i$ 是由面索引 $i$ 决定的相位移（单位：弧度）。那么，面速度为\n$$\nw_i(t) = \\frac{\\mathrm{d}x_i}{\\mathrm{d}t} = A\\,\\omega\\,\\cos\\!\\left(\\omega\\,t + \\phi_i\\right).\n$$\n\n设初始域为 $[0,L]$，包含 $N$ 个均匀单元，面索引为 $i=0,\\dots,N$，单元索引为 $j=0,\\dots,N-1$。初始面位置为 $x_i(0) = i\\,\\Delta x$，其中 $\\Delta x = L/N$。初始均匀状态为静止理想气体，其密度为 $\\rho_0$（单位：千克/立方米），速度为 $u_0 = 0$（单位：米/秒），压力为 $p_0$（单位：帕斯卡）。初始比内能 $e_0$（单位：焦耳/千克）必须满足 $p_0 = (\\gamma - 1)\\,\\rho_0\\,e_0$。\n\n构建一个时间步长为 $\\Delta t$ 秒的离散更新格式。在时间 $t_n = n\\,\\Delta t$ 时，定义单元体积为 $V_j^n = x_{j+1}(t_n) - x_j(t_n)$，在交错时间点 $t_n^\\star = t_n + \\theta\\,\\Delta t$ 的网格速度为 $w_i^\\star = w_i(t_n^\\star)$，其中 $\\theta \\in [0,1]$ 指定了网格对流项的时间交错方式。离散的网格对流体积变化为\n$$\n\\Delta V_j^{\\mathrm{flux}} = \\Delta t\\,\\left( w_{j+1}^\\star - w_j^\\star \\right).\n$$\n\n您必须实现两种更新模式：\n- GCL相容模式：使用与网格对流项一致的控制体进行更新，$V_j^{n+1,\\mathrm{used}} = V_j^n + \\Delta V_j^{\\mathrm{flux}}$。\n- GCL违背模式：使用精确的几何体积 $V_j^{n+1,\\mathrm{used}} = V_j^{n+1} = x_{j+1}(t_{n+1}) - x_j(t_{n+1})$，但仍使用交错时间点 $t_n^\\star$ 的速度计算 $\\Delta V_j^{\\mathrm{flux}}$。此时，离散GCL残差为\n$$\n\\varepsilon_j^n = V_j^{n+1,\\mathrm{used}} - \\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right).\n$$\n\n对于均匀状态 $U$ 和零物理通量，在所使用的控制体上对守恒变量（质量、动量和能量密度）的有限体积更新，简化为按GCL残差引起的比例进行缩放。具体来说，对每个单元有\n$$\nU_j^{n+1} = U_j^n \\left( 1 - \\frac{\\varepsilon_j^n}{V_j^{n+1,\\mathrm{used}}} \\right),\n$$\n此更新保持 $u=0$ 不变，但对 $\\rho$ 和 $\\rho E$ 进行相同的缩放，从而通过 $p = (\\gamma - 1)\\,\\rho\\,e_0$（其中 $e_0$ 为常数）引起压力变化。因此，任何非零的 $\\varepsilon_j^n$ 都会表现为伪压力振荡。\n\n您的程序必须：\n- 实现面运动，并根据构造的运动精确计算 $x_i(t_n)$ 和 $x_i(t_{n+1})$。\n- 在交错时间点 $t_n^\\star$ 计算 $w_i^\\star$ 以及基于通量的离散体积变化 $\\Delta V_j^{\\mathrm{flux}}$。\n- 根据所选模式（GCL相容或GCL违背）使用 $V_j^{n+1,\\mathrm{used}}$ 更新守恒变量。\n- 跟踪所有单元和所有时间步的压力偏差 $|p_j^n - p_0|$。\n- 计算以下诊断指标：\n  1. 所有单元和时间内的最大绝对压力偏差（单位：帕斯卡）。\n  2. 所有单元和时间内的均方根压力偏差（单位：帕斯卡）。\n  3. 所有单元和时间内的最大绝对GCL残差（单位：米）。\n\n角度量必须以弧度表示。所有物理单位必须与国际单位制 (SI) 一致：米 ($\\mathrm{m}$)、秒 ($\\mathrm{s}$)、千克 ($\\mathrm{kg}$) 和帕斯卡 ($\\mathrm{Pa}$)。\n\n使用以下参数集测试套件来检验不同的行为：\n- 情况 A (正常路径，相容): $N=20$, $L=1.0\\,\\mathrm{m}$, $A=0.01\\,\\mathrm{m}$, $\\omega=20.0\\,\\mathrm{rad/s}$, $\\Delta t=0.005\\,\\mathrm{s}$, $N_t=200$ 个时间步, $\\beta=0.3\\,\\mathrm{rad}$, $\\theta=0.5$, 相容模式。\n- 情况 B (违背，振荡): 与情况 A 相同，但为GCL违背模式。\n- 情况 C (边界情况，静态网格): $N=20$, $L=1.0\\,\\mathrm{m}$, $A=0.0\\,\\mathrm{m}$, $\\omega=20.0\\,\\mathrm{rad/s}$, $\\Delta t=0.005\\,\\mathrm{s}$, $N_t=200$, $\\beta=0.3\\,\\mathrm{rad}$, $\\theta=0.5$, GCL违背模式。\n- 情况 D (边界情况，更高频率): $N=20$, $L=1.0\\,\\mathrm{m}$, $A=0.01\\,\\mathrm{m}$, $\\omega=100.0\\,\\mathrm{rad/s}$, $\\Delta t=0.002\\,\\mathrm{s}$, $N_t=300$, $\\beta=0.3\\,\\mathrm{rad}$, $\\theta=0.5$, GCL违背模式。\n\n假设理想气体参数为 $\\gamma = 1.4$，初始状态为 $\\rho_0 = 1.0\\,\\mathrm{kg/m^3}$、$u_0 = 0.0\\,\\mathrm{m/s}$、$p_0 = 100000.0\\,\\mathrm{Pa}$，并选择 $e_0$ 以满足 $p_0 = (\\gamma - 1)\\,\\rho_0\\,e_0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中每个案例的结果本身是一个包含三个浮点数的列表，顺序为[最大绝对压力偏差, 均方根压力偏差, 最大绝对GCL残差]，分别对应情况 A、B、C 和 D。例如：“[[a1,b1,c1],[a2,b2,c2],[a3,b3,c3],[a4,b4,c4]]”。不得打印任何其他文本。",
            "solution": "我们从任意拉格朗日-欧拉 (ALE) 框架中移动控制体上的积分守恒律开始。对于一个守恒状态向量 $U$ 和物理通量 $F$，在一个含时控制体 $\\Omega(t)$（其边界为 $\\partial \\Omega(t)$）上的积分定律是\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega(t)} U \\,\\mathrm{d}\\Omega + \\oint_{\\partial \\Omega(t)} \\left(F - U \\,\\boldsymbol{w}\\right)\\cdot \\boldsymbol{n} \\,\\mathrm{d}S = 0,\n$$\n其中 $\\boldsymbol{w}$ 是网格速度，$\\boldsymbol{n}$ 是边界上的外向法向量。网格对流项 $-U\\,\\boldsymbol{w}$ 强制了均匀状态在网格运动下的不变性，前提是控制体变化和网格对流在离散上是一致的。\n\n几何守恒律 (GCL) 是要求\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left|\\Omega(t)\\right| = \\oint_{\\partial \\Omega(t)} \\boldsymbol{w}\\cdot \\boldsymbol{n}\\,\\mathrm{d}S,\n$$\n它保证了体积变化与穿过边界的净法向网格速度相匹配。在有限体积的背景下，其离散对应形式是：更新后的控制体必须与用于网格对流通量的交错网格速度相一致。\n\n我们考虑一个一维网格，其面位于位置 $x_i(t)$，单元由 $j$ 索引。所构造的运动\n$$\nx_i(t) = x_i(0) + A\\,\\sin\\!\\left(\\omega\\,t + \\phi_i\\right),\\quad \\phi_i = \\beta\\,i,\n$$\n具有面速度\n$$\nw_i(t) = \\frac{\\mathrm{d}x_i}{\\mathrm{d}t} = A\\,\\omega\\,\\cos\\!\\left(\\omega\\,t + \\phi_i\\right).\n$$\n设初始域为 $[0,L]$，有 $N$ 个均匀单元，面位置为 $x_i(0) = i\\,\\Delta x$，其中 $\\Delta x = L/N$。在时间 $t_n = n\\,\\Delta t$ 时，单元体积为 $V_j^n = x_{j+1}(t_n) - x_j(t_n)$。设在交错时间点 $t_n^\\star = t_n + \\theta\\,\\Delta t$ 的网格速度为 $w_i^\\star = w_i(t_n^\\star)$，其中 $\\theta \\in [0,1]$。\n\n与使用交错速度的一阶显式有限体积法相一致的、基于通量的离散体积变化为\n$$\n\\Delta V_j^{\\mathrm{flux}} = \\Delta t\\left( w_{j+1}^\\star - w_j^\\star \\right).\n$$\nGCL相容的更新必须使用控制体\n$$\nV_j^{n+1,\\mathrm{used}} = V_j^n + \\Delta V_j^{\\mathrm{flux}}.\n$$\n如果转而使用一个不一致的控制体，例如精确的几何体积 $V_j^{n+1} = x_{j+1}(t_{n+1}) - x_j(t_{n+1})$，同时保留由 $w^\\star$ 计算的交错网格对流项，则离散GCL残差变为\n$$\n\\varepsilon_j^n = V_j^{n+1,\\mathrm{used}} - \\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right),\n$$\n由于在一个时间步内 $w$ 的时间变化以及跨面的相位差，该残差在相容模式下恒为零，而在违背模式下通常非零。\n\n考虑可压缩欧拉方程的一个均匀初始状态：常数密度 $\\rho_0$、速度 $u_0 = 0$ 和压力 $p_0$，比内能 $e_0$ 满足 $p_0 = (\\gamma - 1)\\,\\rho_0\\,e_0$。对于均匀的 $U$ 和零物理通量 $F=0$，有限体积更新简化为网格对流通量和控制体变化之间的平衡。将一维ALE定律在单元 $j$ 上从 $t_n$ 到 $t_{n+1}$ 进行积分，并使用所选的 $V_j^{n+1,\\mathrm{used}}$，可得到单元积分守恒变量的更新公式：\n$$\nU_j^{n+1}\\,V_j^{n+1,\\mathrm{used}} = U_j^n\\,V_j^n - \\Delta t\\left[ \\left(F - U\\,w\\right)_{j+1/2} - \\left(F - U\\,w\\right)_{j-1/2} \\right].\n$$\n在均匀 $U$ 和零物理通量 $F=0$ 的条件下，右侧简化为\n$$\nU_j^{n+1}\\,V_j^{n+1,\\mathrm{used}} = U_j^n\\,V_j^n + \\Delta t\\,U\\,\\left( w_{j+1}^\\star - w_j^\\star \\right) = U_j^n\\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right).\n$$\n因此，\n$$\nU_j^{n+1} = U_j^n \\frac{V_j^n + \\Delta V_j^{\\mathrm{flux}}}{V_j^{n+1,\\mathrm{used}}}\n= U_j^n\\left(1 - \\frac{\\varepsilon_j^n}{V_j^{n+1,\\mathrm{used}}}\\right).\n$$\n这表明，任何非零的 $\\varepsilon_j^n$ 会同等地缩放所有守恒分量。特别地，速度 $u$ 保持为零，因为 $\\rho$ 和 $\\rho u$ 都按相同的因子缩放；而单位质量的比总能 $E$ 保持不变，因为 $\\rho E$ 和 $\\rho$ 的缩放比例相同。因此，由理想气体状态方程 $p_j^n = (\\gamma - 1)\\,\\rho_j^n\\,e_0$ 计算的压力，对GCL残差引起的密度缩放做出线性响应。任何非零的 $\\varepsilon_j^n$ 都会产生伪压力振荡，即使物理上的解应保持均匀。\n\n算法设计：\n- 初始化网格面 $x_i(0)$、单元体积 $V_j^0$ 以及均匀状态 $(\\rho_0,u_0=0,p_0,e_0)$，其中 $e_0 = p_0/((\\gamma-1)\\rho_0)$。\n- 对于每个时间步 $n$：\n  - 根据给定的 $(A,\\omega,\\beta)$ 从构造的运动 $x_i(t)$ 中精确计算 $x_i(t_n)$ 和 $x_i(t_{n+1})$，确保单位正确：位置单位为米，时间单位为秒，角度单位为弧度。\n  - 在 $t_n^\\star$ 计算交错网格速度 $w_i^\\star = A\\,\\omega\\,\\cos(\\omega(t_n+\\theta\\Delta t)+\\phi_i)$。\n  - 计算 $V_j^n = x_{j+1}(t_n) - x_j(t_n)$ 和 $V_j^{n+1} = x_{j+1}(t_{n+1}) - x_j(t_{n+1})$。\n  - 计算 $\\Delta V_j^{\\mathrm{flux}} = \\Delta t\\left( w_{j+1}^\\star - w_j^\\star \\right)$。\n  - 设置 $V_j^{n+1,\\mathrm{used}} = V_j^n + \\Delta V_j^{\\mathrm{flux}}$ (GCL相容模式) 或 $V_j^{n+1,\\mathrm{used}} = V_j^{n+1}$ (GCL违背模式)。\n  - 计算 $\\varepsilon_j^n = V_j^{n+1,\\mathrm{used}} - \\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right)$。\n  - 更新 $\\rho_j^{n+1} = \\rho_j^n\\left(1 - \\varepsilon_j^n/V_j^{n+1,\\mathrm{used}}\\right)$；保持 $u_j^{n+1}=0$ 和 $e_0$ 不变；计算 $p_j^{n+1} = (\\gamma - 1)\\,\\rho_j^{n+1}\\,e_0$。\n  - 记录绝对压力偏差 $|p_j^{n+1} - p_0|$ 和残差 $|\\varepsilon_j^n|$。\n- 在所有步骤结束后，计算：\n  - 所有 $j,n$ 中的最大绝对压力偏差（单位：帕斯卡）。\n  - 均方根 (RMS) 压力偏差 $\\sqrt{\\frac{1}{N\\,N_t}\\sum_{n=1}^{N_t}\\sum_{j=0}^{N-1}(p_j^n - p_0)^2}$（单位：帕斯卡）。\n  - 最大绝对GCL残差 $\\max_{j,n}|\\varepsilon_j^n|$（单位：米）。\n\n边界情况分析与预期：\n- 在GCL相容模式下，根据构造 $\\varepsilon_j^n=0$，因此对于所有 $n$，$\\rho_j^n$ 和 $p_j^n$ 始终等于 $\\rho_0$ 和 $p_0$。所以最大和均方根压力偏差在浮点舍入误差范围内均为零。\n- 在GCL违背模式下，当网格运动非零 ($A0$) 且 $w^\\star$ 随时间变化时，$\\varepsilon_j^n$ 通常非零，从而产生非零的压力偏差。其量级随着 $\\omega$ 的增加和时间步的累积而增长。\n- 在静态网格的边界情况 ($A=0$)下，$w^\\star=0$ 且 $x_i(t)$ 是常数，因此 $\\Delta V_j^{\\mathrm{flux}}=0$ 且 $V_j^{n+1}=V_j^n$，这意味着即使在违背模式下 $\\varepsilon_j^n=0$。压力偏差保持为零。\n\n您的程序必须实现问题陈述中指定的四个测试用例，并输出单行结果，该行包含一个由四个列表组成的列表，每个内部列表包含三个浮点数：$[\\text{最大绝对压力偏差 (Pa)}, \\text{均方根压力偏差 (Pa)}, \\text{最大绝对GCL残差 (m)}]$，顺序为情况 A、情况 B、情况 C、情况 D。不应打印任何其他文本。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_case(N, L, A, omega, dt, Nt, beta, theta, compliant,\n             gamma=1.4, rho0=1.0, p0=100000.0):\n    # Derived initial quantities\n    e0 = p0 / ((gamma - 1.0) * rho0)  # specific internal energy [J/kg]\n    # Face indices 0..N\n    i_faces = np.arange(N + 1, dtype=np.int64)\n    # Initial face positions [m]\n    x0 = i_faces * (L / N)\n    # Phase per face [rad]\n    phi = beta * i_faces\n\n    # Storage for diagnostics\n    max_abs_pressure_dev = 0.0\n    sum_sq_pressure_dev = 0.0\n    max_abs_gcl_residual = 0.0\n    count = 0\n\n    # Initialize density per cell [kg/m^3]\n    rho = np.full(N, rho0, dtype=np.float64)\n\n    # Time loop\n    for n in range(Nt):\n        t_n = n * dt\n        t_np1 = (n + 1) * dt\n        t_star = t_n + theta * dt\n\n        # Analytic face positions at t_n and t_{n+1}\n        x_n = x0 + A * np.sin(omega * t_n + phi)         # [m]\n        x_np1 = x0 + A * np.sin(omega * t_np1 + phi)     # [m]\n\n        # Staged mesh velocities at t_star\n        w_star = A * omega * np.cos(omega * t_star + phi)  # [m/s]\n\n        # Cell volumes at t_n and t_{n+1}\n        V_n = x_n[1:] - x_n[:-1]          # [m]\n        V_np1 = x_np1[1:] - x_np1[:-1]    # [m]\n\n        # Flux-based discrete volume change\n        dV_flux = dt * (w_star[1:] - w_star[:-1])  # [m]\n\n        # Used control volume at n+1\n        if compliant:\n            V_used_np1 = V_n + dV_flux\n        else:\n            V_used_np1 = V_np1\n\n        # GCL residual epsilon\n        epsilon = V_used_np1 - (V_n + dV_flux)  # [m]\n\n        # Update density using multiplicative factor\n        # Factor = 1 - epsilon / V_used_np1\n        # Guard against division by tiny V_used_np1 (should not happen if motion is mild)\n        factor = 1.0 - np.divide(epsilon, V_used_np1, where=(V_used_np1 != 0.0))\n\n        rho *= factor  # [kg/m^3]\n\n        # Pressure from ideal gas with constant e0\n        p = (gamma - 1.0) * rho * e0  # [Pa]\n\n        # Diagnostics\n        abs_dev = np.abs(p - p0)\n        max_abs_pressure_dev = max(max_abs_pressure_dev, float(np.max(abs_dev)))\n        max_abs_gcl_residual = max(max_abs_gcl_residual, float(np.max(np.abs(epsilon))))\n        sum_sq_pressure_dev += float(np.sum(abs_dev**2))\n        count += N\n\n    # RMS pressure deviation over all cells and time steps\n    rms_pressure_dev = np.sqrt(sum_sq_pressure_dev / count) if count > 0 else 0.0\n\n    return [max_abs_pressure_dev, rms_pressure_dev, max_abs_gcl_residual]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: GCL compliant, happy path\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.01, \"omega\": 20.0, \"dt\": 0.005, \"Nt\": 200, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": True},\n        # Case B: GCL violation, oscillations expected\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.01, \"omega\": 20.0, \"dt\": 0.005, \"Nt\": 200, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": False},\n        # Case C: Static grid edge case (A=0), violation mode but zero motion\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.0,  \"omega\": 20.0, \"dt\": 0.005, \"Nt\": 200, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": False},\n        # Case D: Higher frequency, violation mode\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.01, \"omega\": 100.0, \"dt\": 0.002, \"Nt\": 300, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": False},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_case(**case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Each result is a list of three floats; we print the overall list of lists.\n    # Ensure plain Python list formatting.\n    print(f\"[{','.join([str(res) for res in results])}]\")\n\nsolve()\n```"
        }
    ]
}