{
    "hands_on_practices": [
        {
            "introduction": "几何守恒律 (Geometric Conservation Law, GCL) 的核心在于将控制体的体积变化与网格边界的运动联系起来。本练习旨在通过一个具体的三维六面体单元，帮助你动手计算其瞬时体积变化率，从而巩固 GCL 的基本概念。通过直接应用网格速度和面元矢量，你将深入理解这一守恒律的几何本质。",
            "id": "3962113",
            "problem": "考虑计算流体动力学 (CFD) 中遵循几何守恒律 (GCL) 的单个移动六面体控制体积。顶点标记为 $\\mathbf{x}_{i}(t)$（其中 $i=1,\\dots,8$），在时间 $t=0$ 时，它们形成一个与坐标轴对齐的长方体，边长分别为 $L_{x}=2$ 米、$L_{y}=3$ 米和 $L_{z}=4$ 米。具体来说，在 $t=0$ 时的顶点位置为\n$$\n\\mathbf{x}_{1}=(0,0,0),\\quad \\mathbf{x}_{2}=(2,0,0),\\quad \\mathbf{x}_{3}=(2,3,0),\\quad \\mathbf{x}_{4}=(0,3,0),\n$$\n$$\n\\mathbf{x}_{5}=(0,0,4),\\quad \\mathbf{x}_{6}=(2,0,4),\\quad \\mathbf{x}_{7}=(2,3,4),\\quad \\mathbf{x}_{8}=(0,3,4).\n$$\n顶点以空间仿射的网格速度移动，在 $t=0$ 时由下式给出：\n$$\n\\mathbf{v}_{i}=\\mathbf{b}+\\alpha\\,\\mathbf{x}_{i},\\qquad \\mathbf{b}=(0.2,-0.1,0.05)\\ \\text{m/s},\\quad \\alpha=0.05\\ \\text{s}^{-1}.\n$$\n面取外向方向。对于六个四边形面中的每一个，在 $t=0$ 时，使用将面三角化为两个三角形（在面上有固定的局部参考顶点）的方法，以及相关的三角形面积矢量的叉积构造，来构建定向面积矢量 $\\mathbf{A}_{f}(0)$。然后，仅使用顶点速度和这些面面积矢量，从第一性原理推导由该移动网格的 GCL 运动学所蕴含的控制体积的时间导数 $\\dot{V}(0)$。\n\n以立方米/秒为单位表示您最终的 $\\dot{V}(0)$。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题是良定的、有科学依据且内部一致的，这使其成为计算流体动力学中的一个有效问题。我们将进行完整推导。\n\n对于一个边界为 $\\partial V(t)$、以网格速度场 $\\mathbf{v}_g(\\mathbf{x},t)$ 移动的控制体积 $V(t)$，其时间导数由几何守恒律 (GCL) 给出。GCL 的积分形式指出，体积的变化率等于网格速度通过该体积边界的通量：\n$$ \\frac{dV}{dt} = \\int_{\\partial V} \\mathbf{v}_g \\cdot d\\mathbf{A} $$\n对于一个离散的六面体控制体积，该积分变为对其六个面（用下标 $f$ 表示）的求和：\n$$ \\dot{V}(t) = \\frac{dV}{dt} = \\sum_{f=1}^{6} \\int_{A_f} \\mathbf{v}_g(\\mathbf{x}, t) \\cdot d\\mathbf{A}_f $$\n其中 $A_f$ 是面 $f$ 的面积，$d\\mathbf{A}_f$ 是指向外部的面积微元矢量。\n\n问题指定了在时间 $t=0$ 时的仿射网格速度场：\n$$ \\mathbf{v}_g(\\mathbf{x}) = \\mathbf{b} + \\alpha \\mathbf{x} $$\n其中 $\\mathbf{b} = (0.2, -0.1, 0.05) \\, \\text{m/s}$ 和 $\\alpha = 0.05 \\, \\text{s}^{-1}$ 是常数。\n\n将速度场代入单个面 $f$ 的通量表达式中：\n$$ \\int_{A_f} \\mathbf{v}_g \\cdot d\\mathbf{A}_f = \\int_{A_f} (\\mathbf{b} + \\alpha \\mathbf{x}) \\cdot d\\mathbf{A}_f = \\int_{A_f} \\mathbf{b} \\cdot d\\mathbf{A}_f + \\int_{A_f} \\alpha \\mathbf{x} \\cdot d\\mathbf{A}_f $$\n由于 $\\mathbf{b}$ 和 $\\alpha$ 是常数，我们可以将它们移到积分符号外面：\n$$ \\int_{A_f} \\mathbf{v}_g \\cdot d\\mathbf{A}_f = \\mathbf{b} \\cdot \\int_{A_f} d\\mathbf{A}_f + \\alpha \\int_{A_f} \\mathbf{x} \\cdot d\\mathbf{A}_f $$\n第一个积分就是面面积矢量，$\\mathbf{A}_f = \\int_{A_f} d\\mathbf{A}_f$。\n对于第二个积分，我们注意到在 $t=0$ 时，六面体的每个面都是一个平面四边形。对于一个平面，$d\\mathbf{A}_f = \\mathbf{n}_f dA_f$，其中 $\\mathbf{n}_f$ 是恒定的单位法向矢量。面心的位置矢量定义为 $\\mathbf{x}_{c,f} = \\frac{1}{|A_f|} \\int_{A_f} \\mathbf{x} \\, dA_f$。该积分变为：\n$$ \\int_{A_f} \\mathbf{x} \\cdot d\\mathbf{A}_f = \\int_{A_f} (\\mathbf{x} \\cdot \\mathbf{n}_f) \\, dA_f $$\n对于一个平面，对于面上所有的点 $\\mathbf{x}$，项 $\\mathbf{x} \\cdot \\mathbf{n}_f$ 是一个常数。设这个常数为 $d_f$。因此，$d_f = \\mathbf{x}_{c,f} \\cdot \\mathbf{n}_f$。该积分简化为：\n$$ (\\mathbf{x}_{c,f} \\cdot \\mathbf{n}_f) \\int_{A_f} dA_f = (\\mathbf{x}_{c,f} \\cdot \\mathbf{n}_f) |A_f| = \\mathbf{x}_{c,f} \\cdot (|A_f| \\mathbf{n}_f) = \\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f $$\n因此，通过单个面的通量精确地由下式给出：\n$$ \\int_{A_f} \\mathbf{v}_g \\cdot d\\mathbf{A}_f = \\mathbf{b} \\cdot \\mathbf{A}_f + \\alpha (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f) = (\\mathbf{b} + \\alpha \\mathbf{x}_{c,f}) \\cdot \\mathbf{A}_f $$\n对所有六个面求和，以求得总体积变化率：\n$$ \\dot{V}(0) = \\sum_{f=1}^{6} (\\mathbf{b} \\cdot \\mathbf{A}_f + \\alpha (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f)) = \\mathbf{b} \\cdot \\left(\\sum_{f=1}^{6} \\mathbf{A}_f\\right) + \\alpha \\sum_{f=1}^{6} (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f) $$\n对于任何闭合体积，指向外部的面面积矢量之和为零，即 $\\sum_{f=1}^{6} \\mathbf{A}_f = \\mathbf{0}$。这意味着速度场的纯平移部分 $\\mathbf{b}$ 对体积变化没有贡献。$\\dot{V}(0)$ 的表达式简化为：\n$$ \\dot{V}(0) = \\alpha \\sum_{f=1}^{6} (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f) $$\n我们现在计算在 $t=0$ 时六面体所需的几何量。边长分别为 $L_x=2$ 米、$L_y=3$ 米和 $L_z=4$ 米。\n\n1.  **面 1 (底面, $z=0$):**\n    顶点 $\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_3, \\mathbf{x}_4$。外法线方向为 $-z$ 方向。\n    $\\mathbf{A}_1 = (0, 0, -L_x L_y) = (0, 0, -6) \\, \\text{m}^2$。\n    形心 $\\mathbf{x}_{c,1} = (\\frac{L_x}{2}, \\frac{L_y}{2}, 0) = (1, 1.5, 0) \\, \\text{m}$。\n    $\\mathbf{x}_{c,1} \\cdot \\mathbf{A}_1 = (1, 1.5, 0) \\cdot (0, 0, -6) = 0$。\n\n2.  **面 2 (顶面, $z=L_z=4$):**\n    顶点 $\\mathbf{x}_5, \\mathbf{x}_6, \\mathbf{x}_7, \\mathbf{x}_8$。外法线方向为 $+z$ 方向。\n    $\\mathbf{A}_2 = (0, 0, L_x L_y) = (0, 0, 6) \\, \\text{m}^2$。\n    形心 $\\mathbf{x}_{c,2} = (\\frac{L_x}{2}, \\frac{L_y}{2}, L_z) = (1, 1.5, 4) \\, \\text{m}$。\n    $\\mathbf{x}_{c,2} \\cdot \\mathbf{A}_2 = (1, 1.5, 4) \\cdot (0, 0, 6) = 4 \\times 6 = 24 \\, \\text{m}^3$。\n\n3.  **面 3 (后面, $y=0$):**\n    顶点 $\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_6, \\mathbf{x}_5$。外法线方向为 $-y$ 方向。\n    $\\mathbf{A}_3 = (0, -L_x L_z, 0) = (0, -8, 0) \\, \\text{m}^2$。\n    形心 $\\mathbf{x}_{c,3} = (\\frac{L_x}{2}, 0, \\frac{L_z}{2}) = (1, 0, 2) \\, \\text{m}$。\n    $\\mathbf{x}_{c,3} \\cdot \\mathbf{A}_3 = (1, 0, 2) \\cdot (0, -8, 0) = 0$。\n\n4.  **面 4 (前面, $y=L_y=3$):**\n    顶点 $\\mathbf{x}_4, \\mathbf{x}_3, \\mathbf{x}_7, \\mathbf{x}_8$。外法线方向为 $+y$ 方向。\n    $\\mathbf{A}_4 = (0, L_x L_z, 0) = (0, 8, 0) \\, \\text{m}^2$。\n    形心 $\\mathbf{x}_{c,4} = (\\frac{L_x}{2}, L_y, \\frac{L_z}{2}) = (1, 3, 2) \\, \\text{m}$。\n    $\\mathbf{x}_{c,4} \\cdot \\mathbf{A}_4 = (1, 3, 2) \\cdot (0, 8, 0) = 3 \\times 8 = 24 \\, \\text{m}^3$。\n\n5.  **面 5 (左面, $x=0$):**\n    顶点 $\\mathbf{x}_1, \\mathbf{x}_4, \\mathbf{x}_8, \\mathbf{x}_5$。外法线方向为 $-x$ 方向。\n    $\\mathbf{A}_5 = (-L_y L_z, 0, 0) = (-12, 0, 0) \\, \\text{m}^2$。\n    形心 $\\mathbf{x}_{c,5} = (0, \\frac{L_y}{2}, \\frac{L_z}{2}) = (0, 1.5, 2) \\, \\text{m}$。\n    $\\mathbf{x}_{c,5} \\cdot \\mathbf{A}_5 = (0, 1.5, 2) \\cdot (-12, 0, 0) = 0$。\n\n6.  **面 6 (右面, $x=L_x=2$):**\n    顶点 $\\mathbf{x}_2, \\mathbf{x}_3, \\mathbf{x}_7, \\mathbf{x}_6$。外法线方向为 $+x$ 方向。\n    $\\mathbf{A}_6 = (L_y L_z, 0, 0) = (12, 0, 0) \\, \\text{m}^2$。\n    按照要求，我们可以通过三角剖分来验证这个面积矢量，例如，使用以 $\\mathbf{x}_2=(2,0,0)$ 为参考点的三角形 $(2,3,7)$ 和 $(2,7,6)$。$\\vec{\\mathbf{x}_2\\mathbf{x}_3}=(0,3,0)$，$\\vec{\\mathbf{x}_2\\mathbf{x}_7}=(0,3,4)$，$\\vec{\\mathbf{x}_2\\mathbf{x}_6}=(0,0,4)$。总面积矢量为 $\\frac{1}{2}(\\vec{\\mathbf{x}_2\\mathbf{x}_3} \\times \\vec{\\mathbf{x}_2\\mathbf{x}_7}) + \\frac{1}{2}(\\vec{\\mathbf{x}_2\\mathbf{x}_7} \\times \\vec{\\mathbf{x}_2\\mathbf{x}_6}) = \\frac{1}{2}(12,0,0) + \\frac{1}{2}(12,0,0) = (12,0,0)$，这是正确的。\n    形心 $\\mathbf{x}_{c,6} = (L_x, \\frac{L_y}{2}, \\frac{L_z}{2}) = (2, 1.5, 2) \\, \\text{m}$。\n    $\\mathbf{x}_{c,6} \\cdot \\mathbf{A}_6 = (2, 1.5, 2) \\cdot (12, 0, 0) = 2 \\times 12 = 24 \\, \\text{m}^3$。\n\n现在，我们对点积求和：\n$$ \\sum_{f=1}^{6} (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f) = 0 + 24 + 0 + 24 + 0 + 24 = 72 \\, \\text{m}^3 $$\n最后，我们通过乘以 $\\alpha$ 来计算 $\\dot{V}(0)$：\n$$ \\dot{V}(0) = \\alpha \\times 72 \\, \\text{m}^3 = 0.05 \\, \\text{s}^{-1} \\times 72 \\, \\text{m}^3 = 3.6 \\, \\text{m}^3/\\text{s} $$\n在 $t=0$ 时控制体积的时间导数是 $3.6 \\, \\text{m}^3/\\text{s}$。四舍五入到四位有效数字得到 $3.600 \\, \\text{m}^3/\\text{s}$。\n\n这个结果可以使用散度定理对速度场进行验证。$\\nabla \\cdot \\mathbf{v}_g = \\nabla \\cdot (\\mathbf{b} + \\alpha \\mathbf{x}) = \\nabla \\cdot \\mathbf{b} + \\alpha (\\nabla \\cdot \\mathbf{x}) = 0 + \\alpha(1+1+1) = 3\\alpha$。由于散度是恒定的，$\\dot{V} = \\int_V \\nabla \\cdot \\mathbf{v}_g dV = (3\\alpha) V_0$。初始体积为 $V_0 = 2 \\times 3 \\times 4 = 24 \\, \\text{m}^3$。因此，$\\dot{V}(0) = 3 \\times 0.05 \\times 24 = 0.15 \\times 24 = 3.6 \\, \\text{m}^3/\\text{s}$，这证实了我们逐个面计算的结果。",
            "answer": "$$\n\\boxed{3.600}\n$$"
        },
        {
            "introduction": "在计算流体动力学的数值模拟中，将连续的物理定律离散化是关键步骤，而离散化的方式直接决定了计算的精度。本练习将引导你从连续的 GCL 过渡到离散的数值格式，通过分析一个在时间层级上存在不匹配的常见实现错误，揭示其对自由来流保持问题的影响。理解这种不一致性为何会破坏数值格式的精度，对于开发高精度的任意拉格朗日-欧拉 (Arbitrary Lagrangian-Eulerian, ALE) 求解器至关重要。",
            "id": "3962131",
            "problem": "考虑计算流体动力学 (CFD) 中用于移动网格的有限体积任意拉格朗日-欧拉 (ALE) 方法。设一个控制体的面以 $f$ 为索引，每个面具有随时间变化的定向面积矢量 $\\boldsymbol{A}_f(t)$ 和面网格速度 $\\boldsymbol{v}_{g,f}(t)$。均匀的自由来流状态为 $\\boldsymbol{U}_\\infty$，在空间和时间上是恒定的。控制移动控制体的连续几何恒等式源于将雷诺输运定理应用于指示函数。全局需要采用二阶中点时间积分，但网格度量的计算方式如下：$\\boldsymbol{A}_f$ 滞后在时间层 $n$（即使用 $\\boldsymbol{A}_f^n$），而 $\\boldsymbol{v}_{g,f}$ 中心化在时间层 $n+\\tfrac{1}{2}$（即使用 $\\boldsymbol{v}_{g,f}^{n+\\tfrac{1}{2}}$）。假设 $\\boldsymbol{A}_f(t)$ 和 $\\boldsymbol{v}_{g,f}(t)$ 是时间的光滑函数，并且对于均匀的 $\\boldsymbol{U}_\\infty$，物理通量采用与中点时间积分一致的离散化方法。\n\n在几何守恒律 (GCL) 下，下列哪个陈述最能描述这种 $\\boldsymbol{A}_f$–$\\boldsymbol{v}_{g,f}$ 时间层不匹配对自由来流守恒的影响？\n\nA. 当 $\\boldsymbol{A}_f$ 滞后到 $n$ 且 $\\boldsymbol{v}_{g,f}$ 中心化在 $n+\\tfrac{1}{2}$ 时，对于任意光滑的网格运动，自由来流守恒在时间上保持二阶精度。\n\nB. 将 $\\boldsymbol{A}_f$ 滞后到 $n$ 同时将 $\\boldsymbol{v}_{g,f}$ 中心化在 $n+\\tfrac{1}{2}$ 会产生一个量级为 $\\mathcal{O}(\\Delta t)$ 的非零离散几何残差，该残差与 $\\sum_f \\left(\\dfrac{\\mathrm{d}\\boldsymbol{A}_f}{\\mathrm{d}t}\\right)^{n+\\tfrac{1}{2}} \\cdot \\boldsymbol{v}_{g,f}^{n+\\tfrac{1}{2}}$ 成正比，因此通常会破坏自由来流守恒。\n\nC. 只有当 $\\boldsymbol{A}_f$ 不随时间变化时（例如在网格的纯刚性平移下），才能保持自由来流守恒；否则，守恒性将丧失。\n\nD. 由所述滞后导致的任何对自由来流守恒的违反仅限于边界控制体，并在内部抵消。",
            "solution": "用户希望一位严谨细致的 STEM 领域教授来验证所提供的问题陈述，然后找出解决方案。\n\n### 第1步：提取已知条件\n- **方法**: 计算流体动力学(CFD)中用于移动网格的有限体积任意拉格朗日-欧拉(ALE)方法。\n- **控制体面**: 以 $f$ 为索引。\n- **面面积矢量**: $\\boldsymbol{A}_f(t)$，随时间变化且有方向。\n- **面网格速度**: $\\boldsymbol{v}_{g,f}(t)$，随时间变化。\n- **自由来流状态**: $\\boldsymbol{U}_\\infty$，在空间和时间上恒定。\n- **期望的时间积分**: 二阶中点法则。\n- **网格度量离散化**:\n  - 面面积矢量滞后: $\\boldsymbol{A}_f^n$ (在时间层 $n$ 求值)。\n  - 面网格速度中心化: $\\boldsymbol{v}_{g,f}^{n+\\tfrac{1}{2}}$ (在时间层 $n+\\tfrac{1}{2}$ 求值)。\n- **假设**:\n  - $\\boldsymbol{A}_f(t)$ 和 $\\boldsymbol{v}_{g,f}(t)$ 是时间的光滑函数。\n  - 对于均匀的 $\\boldsymbol{U}_\\infty$，物理通量采用与中点时间积分一致的离散化方法。\n- **问题**: 在几何守恒律(GCL)下，描述 $\\boldsymbol{A}_f$–$\\boldsymbol{v}_{g,f}$ 时间层不匹配对自由来流守恒的影响。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据充分**: 该问题牢固地植根于 CFD 数值方法的成熟领域，特别是关于任意拉格朗日-欧拉方法和几何守恒律。这些是在移动或变形网格上进行精确模拟的标准和关键概念。\n2.  **良定的**: 问题陈述清晰。它要求对一个特定的、明确定义的数值离散化选择所产生的后果进行分析。该问题可以通过截断误差分析得到唯一且可确定的答案。\n3.  **客观的**: 语言技术性强、精确，没有任何主观或模糊的术语。\n4.  **完整性和一致性**: 问题提供了进行分析所需的所有必要信息（离散化方案、所需精度、物理背景）。没有内部矛盾。\n5.  **真实性**: 所描述的场景——几何量求值中的时间层不匹配——是 ALE 方案实现中的一个常见陷阱和实际数值误差的来源。\n\n### 第3步：结论与行动\n问题陈述是**有效的**。这是一个来自计算流体动力学领域的、良定的、科学上合理的问题。我将继续进行求解推导。\n\n### 推导\n核心原理是几何守恒律 (GCL)，它源于将雷诺输运定理应用于一个标量场为1的控制体 $V_i(t)$。GCL 的积分形式为：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V_i(t)} 1 \\, \\mathrm{d}V = \\oint_{\\partial V_i(t)} \\boldsymbol{v}_g \\cdot \\mathrm{d}\\boldsymbol{A}\n$$\n对于一个面以 $f$ 为索引的单一控制体，这变为：\n$$\n\\frac{\\mathrm{d}V_i}{\\mathrm{d}t} = \\sum_f \\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f\n$$\n自由来流守恒要求均匀流场 $\\boldsymbol{U} = \\boldsymbol{U}_\\infty$ 在数值格式下保持不变。对于移动体积上守恒律的积分形式，\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_{V_i} \\boldsymbol{U} \\, \\mathrm{d}V + \\sum_f (\\boldsymbol{F}_c)_f = 0\n$$\n其中 $(\\boldsymbol{F}_c)_f$ 是通过面 $f$ 的对流通量。对于 ALE 方法，此通量为 $\\boldsymbol{F}(\\boldsymbol{U}) - \\boldsymbol{U}(\\boldsymbol{v}_g^T)$ 与面积矢量点积。对于均匀状态 $\\boldsymbol{U}_\\infty$，这变为：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}(\\boldsymbol{U}_\\infty V_i) + \\sum_f (\\boldsymbol{F}_\\infty - \\boldsymbol{U}_\\infty (\\boldsymbol{v}_{g,f}^T)) \\cdot \\boldsymbol{A}_f = 0\n$$\n由于 $\\boldsymbol{U}_\\infty$ 和 $\\boldsymbol{F}_\\infty = \\boldsymbol{F}(\\boldsymbol{U}_\\infty)$ 是常数，我们可以将它们提取出来：\n$$\n\\boldsymbol{U}_\\infty \\frac{\\mathrm{d}V_i}{\\mathrm{d}t} + \\boldsymbol{F}_\\infty \\cdot \\sum_f \\boldsymbol{A}_f - \\boldsymbol{U}_\\infty \\sum_f (\\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f) = 0\n$$\n对于封闭的控制体，面积矢量之和为零，$\\sum_f \\boldsymbol{A}_f = \\boldsymbol{0}$。因此，方程简化为：\n$$\n\\boldsymbol{U}_\\infty \\left( \\frac{\\mathrm{d}V_i}{\\mathrm{d}t} - \\sum_f \\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f \\right) = 0\n$$\n这表明自由来流守恒取决于 GCL 的满足情况。数值格式必须满足 GCL 的离散模拟，其精度阶数应与整体格式的精度阶数相同。\n\n问题要求一个二阶精度的中点时间积分格式。因此，GCL 必须满足到二阶精度。将 GCL 从时间 $t^n$ 积分到 $t^{n+1}$ 得到：\n$$\nV_i^{n+1} - V_i^n = \\int_{t^n}^{t^{n+1}} \\left( \\sum_f \\boldsymbol{v}_{g,f}(t) \\cdot \\boldsymbol{A}_f(t) \\right) \\mathrm{d}t\n$$\n此关系的二阶精度（中点法则）离散化为：\n$$\n\\frac{V_i^{n+1} - V_i^n}{\\Delta t} - \\sum_f (\\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f)^{n+\\frac{1}{2}} = \\mathcal{O}(\\Delta t^2)\n$$\n这里，体积变化 $V_i^{n+1} - V_i^n$ 的计算方式也必须与面扫掠体积相一致。一个二阶一致的定义是 $V_i^{n+1} - V_i^n = \\Delta t \\sum_f (\\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f)^{n+\\tfrac{1}{2}} + \\mathcal{O}(\\Delta t^3)$。\n\n问题指定了扫掠体积总和的不匹配离散化：\n$$\n\\text{Swept Volume Flux} = \\sum_f \\boldsymbol{v}_{g,f}^{n+\\frac{1}{2}} \\cdot \\boldsymbol{A}_f^n\n$$\n此格式的离散几何残差 $R_G$ 为：\n$$\nR_G = \\frac{V_i^{n+1} - V_i^n}{\\Delta t} - \\sum_f \\boldsymbol{v}_{g,f}^{n+\\frac{1}{2}} \\cdot \\boldsymbol{A}_f^n\n$$\n代入二阶精度的体积变化：\n$$\nR_G = \\left( \\sum_f (\\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f)^{n+\\frac{1}{2}} + \\mathcal{O}(\\Delta t^2) \\right) - \\sum_f \\boldsymbol{v}_{g,f}^{n+\\frac{1}{2}} \\cdot \\boldsymbol{A}_f^n\n$$\n$$\nR_G = \\sum_f \\boldsymbol{v}_{g,f}^{n+\\frac{1}{2}} \\cdot \\boldsymbol{A}_f^{n+\\frac{1}{2}} - \\sum_f \\boldsymbol{v}_{g,f}^{n+\\frac{1}{2}} \\cdot \\boldsymbol{A}_f^n + \\mathcal{O}(\\Delta t^2)\n$$\n$$\nR_G = \\sum_f \\boldsymbol{v}_{g,f}^{n+\\frac{1}{2}} \\cdot (\\boldsymbol{A}_f^{n+\\frac{1}{2}} - \\boldsymbol{A}_f^n) + \\mathcal{O}(\\Delta t^2)\n$$\n为了分析项 $(\\boldsymbol{A}_f^{n+\\frac{1}{2}} - \\boldsymbol{A}_f^n)$，我们使用 $\\boldsymbol{A}_f^n = \\boldsymbol{A}_f(t^{n+\\frac{1}{2}} - \\frac{\\Delta t}{2})$ 在 $t^{n+\\frac{1}{2}}$ 附近的泰勒级数展开：\n$$\n\\boldsymbol{A}_f^n = \\boldsymbol{A}_f^{n+\\frac{1}{2}} - \\frac{\\Delta t}{2} \\left(\\frac{\\mathrm{d}\\boldsymbol{A}_f}{\\mathrm{d}t}\\right)^{n+\\frac{1}{2}} + \\mathcal{O}(\\Delta t^2)\n$$\n因此，差值为：\n$$\n\\boldsymbol{A}_f^{n+\\frac{1}{2}} - \\boldsymbol{A}_f^n = \\frac{\\Delta t}{2} \\left(\\frac{\\mathrm{d}\\boldsymbol{A}_f}{\\mathrm{d}t}\\right)^{n+\\frac{1}{2}} + \\mathcal{O}(\\Delta t^2)\n$$\n将此代入残差 $R_G$ 的表达式：\n$$\nR_G = \\sum_f \\boldsymbol{v}_{g,f}^{n+\\frac{1}{2}} \\cdot \\left( \\frac{\\Delta t}{2} \\left(\\frac{\\mathrm{d}\\boldsymbol{A}_f}{\\mathrm{d}t}\\right)^{n+\\frac{1}{2}} \\right) + \\mathcal{O}(\\Delta t^2)\n$$\n$$\nR_G = \\frac{\\Delta t}{2} \\sum_f \\left(\\frac{\\mathrm{d}\\boldsymbol{A}_f}{\\mathrm{d}t}\\right)^{n+\\frac{1}{2}} \\cdot \\boldsymbol{v}_{g,f}^{n+\\frac{1}{2}} + \\mathcal{O}(\\Delta t^2)\n$$\n残差 $R_G$ 是 $\\mathcal{O}(\\Delta t)$ 阶的。在满足 GCL 时的一阶误差会导致自由来流守恒的一阶误差，从而破坏了整个方案预期的二阶精度。\n\n### 逐项分析\n\n**A. 当 $\\boldsymbol{A}_f$ 滞后到 $n$ 且 $\\boldsymbol{v}_{g,f}$ 中心化在 $n+\\tfrac{1}{2}$ 时，对于任意光滑的网格运动，自由来流守恒在时间上保持二阶精度。**\n- **分析**: 上述推导表明，几何残差是 $\\mathcal{O}(\\Delta t)$ 阶，而不是 $\\mathcal{O}(\\Delta t^2)$ 阶。GCL 中的这个一阶误差将自由来流守恒的精度降低到一阶。因此，对于任意网格运动，该陈述是错误的。\n- **结论**: 错误。\n\n**B. 将 $\\boldsymbol{A}_f$ 滞后到 $n$ 同时将 $\\boldsymbol{v}_{g,f}$ 中心化在 $n+\\tfrac{1}{2}$ 会产生一个量级为 $\\mathcal{O}(\\Delta t)$ 的非零离散几何残差，该残差与 $\\sum_f \\left(\\dfrac{\\mathrm{d}\\boldsymbol{A}_f}{\\mathrm{d}t}\\right)^{n+\\tfrac{1}{2}} \\cdot \\boldsymbol{v}_{g,f}^{n+\\tfrac{1}{2}}$ 成正比，因此通常会破坏自由来流守恒。**\n- **分析**: 该陈述与我们的推导结果完全吻合。几何残差确实是 $\\mathcal{O}(\\Delta t)$ 阶，并且与所述的求和项成正比。这个非零残差直接意味着 GCL 在一阶上被违反，这反过来又意味着自由来流守恒没有保持到所需的精度。\n- **结论**: 正确。\n\n**C. 只有当 $\\boldsymbol{A}_f$ 不随时间变化时（例如在网格的纯刚性平移下），才能保持自由来流守恒；否则，守恒性将丧失。**\n- **分析**: 如果几何残差 $R_G$ 为零（达到格式的阶数），则自由来流守恒得以保持。从推导的表达式来看，如果对每个控制体都有 $\\sum_f (\\frac{\\mathrm{d}\\boldsymbol{A}_f}{\\mathrm{d}t})^{n+\\frac{1}{2}} \\cdot \\boldsymbol{v}_{g,f}^{n+\\frac{1}{2}} = 0$，则 $R_G$ 为零。一个充分条件是对于所有面 $\\frac{\\mathrm{d}\\boldsymbol{A}_f}{\\mathrm{d}t} = \\boldsymbol{0}$，这意味着 $\\boldsymbol{A}_f$ 不随时间变化。这对于网格的纯刚性平移是成立的。在这种情况下，时间层不匹配是无关紧要的，因为 $\\boldsymbol{A}_f^n = \\boldsymbol{A}_f^{n+\\frac{1}{2}}$。对于涉及旋转或变形的一般运动，$\\frac{\\mathrm{d}\\boldsymbol{A}_f}{\\mathrm{d}t} \\neq \\boldsymbol{0}$，并且对于任意单元，面上求和通常不可能为零。因此，$\\boldsymbol{A}_f$ 必须不随时间变化是保证守恒的唯一实际途径。该陈述是对实际后果的正确描述。\n- **结论**: 正确。\n\n**D. 由所述滞后导致的任何对自由来流守恒的违反仅限于边界控制体，并在内部抵消。**\n- **分析**: 几何残差 $R_G$ 是为任意控制体 $V_i$ 推导的。误差源局限于任何几何形状正在变化（$\\frac{\\mathrm{d}\\boldsymbol{A}_f}{\\mathrm{d}t} \\neq \\boldsymbol{0}$）且面在移动（$\\boldsymbol{v}_{g,f} \\neq \\boldsymbol{0}$）的单元。在典型的变形网格问题中，内部单元和边界单元一样会发生变形。没有数学依据表明误差只存在于域边界或在内部会系统性地抵消。\n- **结论**: 错误。\n\n选项 B 和 C 都对影响给出了正确的描述。选项 B 描述了误差的数学性质，而选项 C 描述了格式成功或失败的物理条件。两者都是有效且互补的陈述。",
            "answer": "$$\\boxed{BC}$$"
        },
        {
            "introduction": "理论分析揭示了违背 GCL 会降低精度，但其具体物理后果是什么？本练习将理论付诸实践。你将通过编写一个简短的程序，在一个本应保持均匀的流场中，亲眼观察到因 GCL 违背而产生的伪压力振荡。这个实践将让你深刻体会到，满足 GCL 并非只是一个数学上的约束，而是确保仿真结果物理可靠性的基本要求。",
            "id": "3962168",
            "problem": "您的任务是构建一个自洽的数值实验，以揭示在计算流体动力学（CFD）的移动网格任意拉格朗日-欧拉（ALE）格式中，几何守恒律（GCL）的必要性。从移动网格守恒律的基本控制体形式出发，推导并实现一个最小的一维有限体积更新，该更新能够演示控制体变化与网格平流通量之间的不一致性如何在均匀流场中产生虚假的压力振荡。您的程序必须是一个完整、可运行的实现。\n\n您必须使用的基础是移动控制体上的积分守恒律和理想气体状态方程：\n- 积分守恒律：对于一个守恒状态向量 $U$ 和物理通量 $F$，在一个边界为 $\\partial \\Omega(t)$、外向单位法向量为 $\\boldsymbol{n}$ 的控制体 $\\Omega(t)$ 上，任意拉格朗日-欧拉（ALE）形式的守恒律表述为\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega(t)} U \\,\\mathrm{d}\\Omega + \\oint_{\\partial \\Omega(t)} \\left(F - U \\,\\boldsymbol{w}\\right)\\cdot \\boldsymbol{n} \\,\\mathrm{d}S = 0,\n$$\n其中 $\\boldsymbol{w}$ 是网格速度。\n- 几何守恒律（GCL）：控制体的时间变化率必须满足\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left|\\Omega(t)\\right| = \\oint_{\\partial \\Omega(t)} \\boldsymbol{w}\\cdot \\boldsymbol{n}\\,\\mathrm{d}S,\n$$\n从而使得均匀解在网格运动下得以保持。\n- 理想气体状态方程：设比热比为 $\\gamma$，密度为 $\\rho$，速度为 $u$，比总能为 $E$，比内能为 $e = E - \\tfrac{1}{2}u^2$，则压力为\n$$\np = (\\gamma - 1)\\,\\rho\\,e.\n$$\n\n您必须设计一个一维网格运动和一个均匀初始状态，使得任何对离散GCL的违背都表现为虚假的压力振荡。在具有移动面的一维网格上，实现一个守恒变量的一阶、单元中心有限体积更新，并假设初始流场是均匀的且物理通量为零。关键思想是，对于物理通量为零的均匀状态 $U$，更新步骤简化为控制体变化与网格平流项之间的平衡。如果这两者在离散上不一致（即违背GCL），那么格式将对 $U$ 引入一个非零更新，通过理想气体关系式表现为虚假的压力变化。\n\n为以米为单位的面位置 $x_i(t)$ 设计一个正弦网格运动：\n$$\nx_i(t) = x_i(0) + A\\,\\sin\\!\\left(\\omega\\,t + \\phi_i\\right),\n$$\n其中 $A$ 是振幅（单位：米），$\\omega$ 是角频率（单位：弧度/秒），$\\phi_i = \\beta\\,i$ 是按面 $i$ 索引的相位移（单位：弧度）。则面速度为\n$$\nw_i(t) = \\frac{\\mathrm{d}x_i}{\\mathrm{d}t} = A\\,\\omega\\,\\cos\\!\\left(\\omega\\,t + \\phi_i\\right).\n$$\n\n设初始域为 $[0,L]$，包含 $N$ 个均匀单元，面索引为 $i=0,\\dots,N$，单元索引为 $j=0,\\dots,N-1$。初始面位置为 $x_i(0) = i\\,\\Delta x$，其中 $\\Delta x = L/N$。初始均匀状态为静止的理想气体，密度为 $\\rho_0$（单位：千克/立方米），速度为 $u_0 = 0$（单位：米/秒），压力为 $p_0$（单位：帕斯卡）。初始比内能 $e_0$（单位：焦耳/千克）必须满足 $p_0 = (\\gamma - 1)\\,\\rho_0\\,e_0$。\n\n构建一个时间步长为 $\\Delta t$ 秒的离散更新。在时间 $t_n = n\\,\\Delta t$ 时，定义单元体积为 $V_j^n = x_{j+1}(t_n) - x_j(t_n)$，在 $t_n^\\star = t_n + \\theta\\,\\Delta t$ 时的阶段性网格速度为 $w_i^\\star = w_i(t_n^\\star)$，其中 $\\theta \\in [0,1]$ 指定了网格平流项的时间阶段。离散的网格平流体积变化为\n$$\n\\Delta V_j^{\\mathrm{flux}} = \\Delta t\\,\\left( w_{j+1}^\\star - w_j^\\star \\right).\n$$\n\n您必须实现两种更新模式：\n- 符合GCL的模式：使用控制体进行更新 $V_j^{n+1,\\mathrm{used}} = V_j^n + \\Delta V_j^{\\mathrm{flux}}$，这与网格平流项一致。\n- 违背GCL的模式：使用精确的几何体积 $V_j^{n+1,\\mathrm{used}} = V_j^{n+1} = x_{j+1}(t_{n+1}) - x_j(t_{n+1})$，但仍然使用在 $t_n^\\star$ 时的阶段性速度计算 $\\Delta V_j^{\\mathrm{flux}}$。此时的离散GCL残差为\n$$\n\\varepsilon_j^n = V_j^{n+1,\\mathrm{used}} - \\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right).\n$$\n\n对于均匀状态 $U$ 和零物理通量，在所使用的控制体上对守恒变量（质量、动量和能量密度）的有限体积更新简化为按GCL残差引起的比率进行缩放。具体来说，对于每个单元，\n$$\nU_j^{n+1} = U_j^n \\left( 1 - \\frac{\\varepsilon_j^n}{V_j^{n+1,\\mathrm{used}}} \\right),\n$$\n这会保持 $u=0$ 不变，但会同等地缩放 $\\rho$ 和 $\\rho E$，从而在 $e_0$ 保持不变的情况下通过 $p = (\\gamma - 1)\\,\\rho\\,e_0$ 引起压力变化。因此，任何非零的 $\\varepsilon_j^n$ 都会表现为虚假的压力振荡。\n\n您的程序必须：\n- 根据设计的运动精确实现面运动并计算 $x_i(t_n)$ 和 $x_i(t_{n+1})$。\n- 在阶段性时间 $t_n^\\star$ 计算 $w_i^\\star$ 和基于通量的离散体积变化 $\\Delta V_j^{\\mathrm{flux}}$。\n- 根据所选模式（符合GCL或违背GCL），使用 $V_j^{n+1,\\mathrm{used}}$ 更新守恒变量。\n- 在所有单元和时间步上追踪压力偏差 $|p_j^n - p_0|$。\n- 计算诊断指标：\n  1. 在所有单元和时间上的最大绝对压力偏差（单位：帕斯卡）。\n  2. 在所有单元和时间上的均方根压力偏差（单位：帕斯卡）。\n  3. 在所有单元和时间上的最大绝对GCL残差（单位：米）。\n\n角度量必须以弧度表示。所有物理单位必须与国际单位制（SI）一致：米（$\\mathrm{m}$）、秒（$\\mathrm{s}$）、千克（$\\mathrm{kg}$）和帕斯卡（$\\mathrm{Pa}$）。\n\n使用以下参数集测试套件来检验不同的行为：\n- 情况A（正常情况，符合GCL）：$N=20$, $L=1.0\\,\\mathrm{m}$, $A=0.01\\,\\mathrm{m}$, $\\omega=20.0\\,\\mathrm{rad/s}$, $\\Delta t=0.005\\,\\mathrm{s}$, $N_t=200$ 个时间步, $\\beta=0.3\\,\\mathrm{rad}$, $\\theta=0.5$, 符合模式。\n- 情况B（违背GCL，产生振荡）：与情况A相同，但为违背GCL的模式。\n- 情况C（边界情况，静态网格）：$N=20$, $L=1.0\\,\\mathrm{m}$, $A=0.0\\,\\mathrm{m}$, $\\omega=20.0\\,\\mathrm{rad/s}$, $\\Delta t=0.005\\,\\mathrm{s}$, $N_t=200$, $\\beta=0.3\\,\\mathrm{rad}$, $\\theta=0.5$, 违背GCL的模式。\n- 情况D（边界情况，更高频率）：$N=20$, $L=1.0\\,\\mathrm{m}$, $A=0.01\\,\\mathrm{m}$, $\\omega=100.0\\,\\mathrm{rad/s}$, $\\Delta t=0.002\\,\\mathrm{s}$, $N_t=300$, $\\beta=0.3\\,\\mathrm{rad}$, $\\theta=0.5$, 违背GCL的模式。\n\n假设理想气体参数为 $\\gamma = 1.4$，初始状态为 $\\rho_0 = 1.0\\,\\mathrm{kg/m^3}$，$u_0 = 0.0\\,\\mathrm{m/s}$，$p_0 = 100000.0\\,\\mathrm{Pa}$，并选择 $e_0$ 以满足 $p_0 = (\\gamma - 1)\\,\\rho_0\\,e_0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素本身也是一个包含三个浮点数的列表，按顺序为[最大绝对压力偏差, 均方根压力偏差, 最大绝对GCL残差]，分别对应情况A、B、C和D。例如：“[[a1,b1,c1],[a2,b2,c2],[a3,b3,c3],[a4,b4,c4]]”。不得打印任何其他文本。",
            "solution": "我们从任意拉格朗日-欧拉（ALE）框架中移动控制体上的积分守恒律开始。对于一个守恒状态向量 $U$ 和物理通量 $F$，在边界为 $\\partial \\Omega(t)$ 的随时间变化的控制体 $\\Omega(t)$ 上的积分定律为\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega(t)} U \\,\\mathrm{d}\\Omega + \\oint_{\\partial \\Omega(t)} \\left(F - U \\,\\boldsymbol{w}\\right)\\cdot \\boldsymbol{n} \\,\\mathrm{d}S = 0,\n$$\n其中 $\\boldsymbol{w}$ 是网格速度，$\\boldsymbol{n}$ 是边界上的外向法向量。网格平流项 $-U\\,\\boldsymbol{w}$ 保证了均匀状态在网格运动下的不变性，前提是控制体变化和网格平流在离散上是一致的。\n\n几何守恒律（GCL）是以下要求\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left|\\Omega(t)\\right| = \\oint_{\\partial \\Omega(t)} \\boldsymbol{w}\\cdot \\boldsymbol{n}\\,\\mathrm{d}S,\n$$\n这保证了体积变化与穿过边界的净法向网格速度相匹配。在有限体积的背景下，其离散形式要求更新后的控制体必须与网格平流通量中使用的阶段性网格速度保持一致。\n\n我们考虑一个一维网格，其面位于位置 $x_i(t)$，单元由 $j$ 索引。设计的运动\n$$\nx_i(t) = x_i(0) + A\\,\\sin\\!\\left(\\omega\\,t + \\phi_i\\right),\\quad \\phi_i = \\beta\\,i,\n$$\n具有面速度\n$$\nw_i(t) = \\frac{\\mathrm{d}x_i}{\\mathrm{d}t} = A\\,\\omega\\,\\cos\\!\\left(\\omega\\,t + \\phi_i\\right).\n$$\n设初始域为 $[0,L]$，有 $N$ 个均匀单元，面位置为 $x_i(0) = i\\,\\Delta x$，其中 $\\Delta x = L/N$。在时间 $t_n = n\\,\\Delta t$ 时，单元体积为 $V_j^n = x_{j+1}(t_n) - x_j(t_n)$。设在 $t_n^\\star = t_n + \\theta\\,\\Delta t$ 时的阶段性网格速度为 $w_i^\\star = w_i(t_n^\\star)$，其中 $\\theta \\in [0,1]$。\n\n与使用阶段性速度的一阶显式有限体积方法相一致的、基于通量的离散体积变化为\n$$\n\\Delta V_j^{\\mathrm{flux}} = \\Delta t\\left( w_{j+1}^\\star - w_j^\\star \\right).\n$$\n符合GCL的更新必须使用控制体\n$$\nV_j^{n+1,\\mathrm{used}} = V_j^n + \\Delta V_j^{\\mathrm{flux}}.\n$$\n如果转而使用不一致的控制体，例如精确的几何体积 $V_j^{n+1} = x_{j+1}(t_{n+1}) - x_j(t_{n+1})$，同时保留由 $w^\\star$ 计算的阶段性网格平流项，则离散GCL残差变为\n$$\n\\varepsilon_j^n = V_j^{n+1,\\mathrm{used}} - \\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right),\n$$\n在符合GCL的模式下，该残差恒等于零；而在违背GCL的模式下，由于在一个时间步内 $w$ 的时间变化以及跨面的相位差，该残差通常非零。\n\n考虑可压缩欧拉方程的均匀初始状态：密度 $\\rho_0$、速度 $u_0 = 0$ 和压力 $p_0$ 均为常数，比内能 $e_0$ 满足 $p_0 = (\\gamma - 1)\\,\\rho_0\\,e_0$。对于均匀的 $U$ 和零物理通量，有限体积更新简化为网格平流通量和控制体变化之间的平衡。将一维ALE定律在单元 $j$ 上从 $t_n$ 到 $t_{n+1}$ 进行积分，并使用所选的 $V_j^{n+1,\\mathrm{used}}$，可得到单元积分守恒变量的更新式：\n$$\nU_j^{n+1}\\,V_j^{n+1,\\mathrm{used}} = U_j^n\\,V_j^n - \\Delta t\\left[ \\left(F - U\\,w\\right)_{j+1/2} - \\left(F - U\\,w\\right)_{j-1/2} \\right].\n$$\n当 $U$ 均匀且物理通量 $F=0$ 时，右侧简化为\n$$\nU_j^{n+1}\\,V_j^{n+1,\\mathrm{used}} = U_j^n\\,V_j^n + \\Delta t\\,U\\,\\left( w_{j+1}^\\star - w_j^\\star \\right) = U_j^n\\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right).\n$$\n因此，\n$$\nU_j^{n+1} = U_j^n \\frac{V_j^n + \\Delta V_j^{\\mathrm{flux}}}{V_j^{n+1,\\mathrm{used}}}\n= U_j^n\\left(1 - \\frac{\\varepsilon_j^n}{V_j^{n+1,\\mathrm{used}}}\\right).\n$$\n这表明任何非零的 $\\varepsilon_j^n$ 都会对所有守恒分量进行等比例缩放。特别是，速度 $u$ 保持为零，因为 $\\rho$ 和 $\\rho u$ 都按相同因子缩放；而单位质量的比总能 $E$ 保持不变，因为 $\\rho E$ 和 $\\rho$ 同等缩放。因此，由理想气体状态方程计算出的压力\n$$\np_j^n = (\\gamma - 1)\\,\\rho_j^n\\,e_0\n$$\n会对由GCL残差引起的密度缩放做出线性响应。任何非零的 $\\varepsilon_j^n$ 都会产生虚假的压力振荡，即使物理上解应保持均匀。\n\n算法设计：\n- 初始化网格面 $x_i(0)$、单元体积 $V_j^0$ 以及均匀状态 $(\\rho_0,u_0=0,p_0,e_0)$，其中 $e_0 = p_0/((\\gamma-1)\\rho_0)$。\n- 对每个时间步 $n$：\n  - 根据给定的 $(A,\\omega,\\beta)$ 从设计的运动 $x_i(t)$ 精确计算 $x_i(t_n)$ 和 $x_i(t_{n+1})$，确保单位正确：位置单位为米，时间单位为秒，角度单位为弧度。\n  - 在 $t_n^\\star$ 时计算阶段性网格速度 $w_i^\\star = A\\,\\omega\\,\\cos(\\omega(t_n+\\theta\\Delta t)+\\phi_i)$。\n  - 计算 $V_j^n = x_{j+1}(t_n) - x_j(t_n)$ 和 $V_j^{n+1} = x_{j+1}(t_{n+1}) - x_j(t_{n+1})$。\n  - 计算 $\\Delta V_j^{\\mathrm{flux}} = \\Delta t\\left( w_{j+1}^\\star - w_j^\\star \\right)$。\n  - 设置 $V_j^{n+1,\\mathrm{used}} = V_j^n + \\Delta V_j^{\\mathrm{flux}}$（符合GCL模式）或 $V_j^{n+1,\\mathrm{used}} = V_j^{n+1}$（违背GCL模式）。\n  - 计算 $\\varepsilon_j^n = V_j^{n+1,\\mathrm{used}} - \\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right)$。\n  - 更新 $\\rho_j^{n+1} = \\rho_j^n\\left(1 - \\varepsilon_j^n/V_j^{n+1,\\mathrm{used}}\\right)$；保持 $u_j^{n+1}=0$ 和 $e_0$ 不变；计算 $p_j^{n+1} = (\\gamma - 1)\\,\\rho_j^{n+1}\\,e_0$。\n  - 记录绝对压力偏差 $|p_j^{n+1} - p_0|$ 和残差 $|\\varepsilon_j^n|$。\n- 在所有时间步结束后，计算：\n  - 在所有 $j,n$ 上的最大绝对压力偏差（单位：帕斯卡）。\n  - 均方根（RMS）压力偏差 $\\sqrt{\\frac{1}{N\\,N_t}\\sum_{n=1}^{N_t}\\sum_{j=0}^{N-1}(p_j^n - p_0)^2}$（单位：帕斯卡）。\n  - 最大绝对GCL残差 $\\max_{j,n}|\\varepsilon_j^n|$（单位：米）。\n\n边界情况分析与预期结果：\n- 在符合GCL的模式下，根据构造 $\\varepsilon_j^n=0$，因此对于所有 $n$，$\\rho_j^n$ 和 $p_j^n$ 保持等于 $\\rho_0$ 和 $p_0$，所以最大和均方根压力偏差在浮点舍入误差范围内都为零。\n- 在违背GCL的模式下，如果网格运动非零（$A>0$）且 $w^\\star$ 随时间变化，则 $\\varepsilon_j^n$ 通常非零，从而产生非零的压力偏差。其量级随着 $\\omega$ 的增加和累积的时间步数而增长。\n- 在静态网格的边界情况（$A=0$）下，$w^\\star=0$ 且 $x_i(t)$ 为常数，因此 $\\Delta V_j^{\\mathrm{flux}}=0$ 且 $V_j^{n+1}=V_j^n$，这意味着即使在违背GCL的模式下 $\\varepsilon_j^n=0$。压力偏差保持为零。\n\n您的程序必须实现问题陈述中指定的四个测试用例，并输出单行，其中包含一个包含四个列表的列表，每个内部列表包含三个浮点数：$[\\text{最大绝对压力偏差 (Pa)}, \\text{均方根压力偏差 (Pa)}, \\text{最大绝对GCL残差 (m)}]$，按情况A、B、C、D的顺序排列。不应打印任何其他文本。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_case(N, L, A, omega, dt, Nt, beta, theta, compliant,\n             gamma=1.4, rho0=1.0, p0=100000.0):\n    # Derived initial quantities\n    e0 = p0 / ((gamma - 1.0) * rho0)  # specific internal energy [J/kg]\n    # Face indices 0..N\n    i_faces = np.arange(N + 1, dtype=np.int64)\n    # Initial face positions [m]\n    x0 = i_faces * (L / N)\n    # Phase per face [rad]\n    phi = beta * i_faces\n\n    # Storage for diagnostics\n    max_abs_pressure_dev = 0.0\n    sum_sq_pressure_dev = 0.0\n    max_abs_gcl_residual = 0.0\n    count = 0\n\n    # Initialize density per cell [kg/m^3]\n    rho = np.full(N, rho0, dtype=np.float64)\n\n    # Time loop\n    for n in range(Nt):\n        t_n = n * dt\n        t_np1 = (n + 1) * dt\n        t_star = t_n + theta * dt\n\n        # Analytic face positions at t_n and t_{n+1}\n        x_n = x0 + A * np.sin(omega * t_n + phi)         # [m]\n        x_np1 = x0 + A * np.sin(omega * t_np1 + phi)     # [m]\n\n        # Staged mesh velocities at t_star\n        w_star = A * omega * np.cos(omega * t_star + phi)  # [m/s]\n\n        # Cell volumes at t_n and t_{n+1}\n        V_n = x_n[1:] - x_n[:-1]          # [m]\n        V_np1 = x_np1[1:] - x_np1[:-1]    # [m]\n\n        # Flux-based discrete volume change\n        dV_flux = dt * (w_star[1:] - w_star[:-1])  # [m]\n\n        # Used control volume at n+1\n        if compliant:\n            V_used_np1 = V_n + dV_flux\n        else:\n            V_used_np1 = V_np1\n\n        # GCL residual epsilon\n        epsilon = V_used_np1 - (V_n + dV_flux)  # [m]\n\n        # Update density using multiplicative factor\n        # Factor = 1 - epsilon / V_used_np1\n        # Guard against division by tiny V_used_np1 (should not happen if motion is mild)\n        factor = 1.0 - np.divide(epsilon, V_used_np1, where=(V_used_np1 != 0.0))\n\n        rho *= factor  # [kg/m^3]\n\n        # Pressure from ideal gas with constant e0\n        p = (gamma - 1.0) * rho * e0  # [Pa]\n\n        # Diagnostics\n        abs_dev = np.abs(p - p0)\n        max_abs_pressure_dev = max(max_abs_pressure_dev, float(np.max(abs_dev)))\n        max_abs_gcl_residual = max(max_abs_gcl_residual, float(np.max(np.abs(epsilon))))\n        sum_sq_pressure_dev += float(np.sum(abs_dev**2))\n        count += N\n\n    # RMS pressure deviation over all cells and time steps\n    rms_pressure_dev = np.sqrt(sum_sq_pressure_dev / count) if count > 0 else 0.0\n\n    return [max_abs_pressure_dev, rms_pressure_dev, max_abs_gcl_residual]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: GCL compliant, happy path\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.01, \"omega\": 20.0, \"dt\": 0.005, \"Nt\": 200, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": True},\n        # Case B: GCL violation, oscillations expected\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.01, \"omega\": 20.0, \"dt\": 0.005, \"Nt\": 200, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": False},\n        # Case C: Static grid edge case (A=0), violation mode but zero motion\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.0,  \"omega\": 20.0, \"dt\": 0.005, \"Nt\": 200, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": False},\n        # Case D: Higher frequency, violation mode\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.01, \"omega\": 100.0, \"dt\": 0.002, \"Nt\": 300, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": False},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_case(**case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Each result is a list of three floats; we print the overall list of lists.\n    # Ensure plain Python list formatting.\n    print(f\"[{','.join([str(res) for res in results])}]\")\n\nsolve()\n```"
        }
    ]
}