{
    "hands_on_practices": [
        {
            "introduction": "在任何有效的移动网格模拟中，几何守恒律（GCL）都是基石，它确保了单元体积的变化率能被其边界的运动精确地解释。本练习 () 提供了一种具体的方法，通过一个简单的二维单元来验证这一关系。通过这个实践，您将把抽象的雷诺输运定理与一个实用的数值公式联系起来。",
            "id": "3977453",
            "problem": "考虑计算流体动力学（CFD）中使用的二维非定常网格中的一个平面三角形控制体积（单元）。该三角形具有逆时针排序的顶点，其位置为 $\\boldsymbol{A}=(x_A,y_A)$、$\\boldsymbol{B}=(x_B,y_B)$ 和 $\\boldsymbol{C}=(x_C,y_C)$，这些顶点的网格点速度由 $\\boldsymbol{w}_A=(u_A,v_A)$、$\\boldsymbol{w}_B=(u_B,v_B)$ 和 $\\boldsymbol{w}_C=(u_C,v_C)$ 给出。假设每条直边上的网格速度在其端点顶点速度之间随弧长线性变化。设每条边上的外向单位法向量是明确定义的，并且在该直边上是恒定的。\n\n从雷诺输运定理和基本运动学出发，推导单元面积的瞬时变化率与沿单元边界积分的网格速度外法向分量之间的关系。利用此关系，在线性边速度假设下，用已知的边几何量和顶点速度（一种“边扫掠”）来获得面积时间导数的精确表达式。\n\n然后，对于具有顶点坐标 $\\boldsymbol{A}=(0,0)$、$\\boldsymbol{B}=(2,0)$ 和 $\\boldsymbol{C}=(0,3)$，以及顶点速度 $\\boldsymbol{w}_A=(0.5,-0.2)$、$\\boldsymbol{w}_B=(0.1,0.3)$ 和 $\\boldsymbol{w}_C=(-0.4,0.0)$（单位为米/秒）的特定三角形，用两种方法计算瞬时面积时间导数：(i) 在给定的线性假设下，精确计算每条边上的边界扫掠积分，以及 (ii) 使用顶点速度对有向多边形面积关于时间进行微分。确认这两个值相等，以证明几何守恒律（GCL）。\n\n提供单元面积瞬时变化率的最终数值。将您的答案四舍五入到四位有效数字。以平方米/秒为单位表示最终速率。",
            "solution": "该问题要求推导和验证二维变形三角形单元的几何守恒律（GCL）。GCL规定，控制体积的几何度量（二维中的面积，三维中的体积）的变化率必须等于边界速度的积分通量。我们将首先从基本原理推导这一关系，然后将其应用于一个具体的数值案例。\n\n第一步是建立面积变化率与其边界速度之间的一般运动学关系。这是雷诺输运定理对于一个具有边界 $\\partial A(t)$ 的移动控制区域 $A(t)$ 的直接应用。该定理指出，对于一个标量场 $f(\\boldsymbol{r}, t)$，其在 $A(t)$ 上积分的全时间导数由下式给出：\n$$ \\frac{d}{dt} \\int_{A(t)} f \\, dA = \\int_{A(t)} \\frac{\\partial f}{\\partial t} \\, dA + \\oint_{\\partial A(t)} f (\\boldsymbol{w} \\cdot \\boldsymbol{n}) \\, ds $$\n其中 $\\boldsymbol{w}$ 是边界的速度，$\\boldsymbol{n}$ 是边界的外向单位法向量，$ds$ 是沿边界的微分弧长。\n\n为了求出面积本身的变化率，我们选择标量场为单位1，即 $f=1$。$f=1$ 在面积 $A(t)$ 上的积分就是面积 $A$。\n$$ \\int_{A(t)} 1 \\cdot dA = A(t) $$\n因此，雷诺输运定理的左边变成 $\\frac{d}{dt}A(t)$，或简写为 $\\frac{dA}{dt}$。\n\n在右边，第一项涉及 $f=1$ 的偏时间导数，该导数为零：\n$$ \\int_{A(t)} \\frac{\\partial (1)}{\\partial t} \\, dA = \\int_{A(t)} 0 \\, dA = 0 $$\n第二项，即边界积分，变为：\n$$ \\oint_{\\partial A(t)} 1 \\cdot (\\boldsymbol{w} \\cdot \\boldsymbol{n}) \\, ds = \\oint_{\\partial A(t)} (\\boldsymbol{w} \\cdot \\boldsymbol{n}) \\, ds $$\n令左右两边相等，我们得到面积变化率的基本运动学表达式：\n$$ \\frac{dA}{dt} = \\oint_{\\partial A(t)} (\\boldsymbol{w} \\cdot \\boldsymbol{n}) \\, ds $$\n该方程表明，面积变化率是垂直于边界的边界速度通量在整个边界上的积分。\n\n接下来，我们对给定的具有顶点 $\\boldsymbol{A}$、$\\boldsymbol{B}$ 和 $\\boldsymbol{C}$ 的三角形单元计算此边值积分。边界 $\\partial A$ 由三条直边组成：$\\boldsymbol{AB}$、$\\boldsymbol{BC}$ 和 $\\boldsymbol{CA}$。因此，该积分是三个线积分之和：\n$$ \\frac{dA}{dt} = \\int_{AB} (\\boldsymbol{w} \\cdot \\boldsymbol{n}_{AB}) \\, ds + \\int_{BC} (\\boldsymbol{w} \\cdot \\boldsymbol{n}_{BC}) \\, ds + \\int_{CA} (\\boldsymbol{w} \\cdot \\boldsymbol{n}_{CA}) \\, ds $$\n问题陈述，网格速度 $\\boldsymbol{w}$ 沿每条边线性变化。我们考虑一条从顶点 $\\boldsymbol{P}_1$ 到顶点 $\\boldsymbol{P}_2$ 的通用边，其长度为 $L$，顶点速度为 $\\boldsymbol{w}_1$ 和 $\\boldsymbol{w}_2$。设 $s$ 为沿边的弧长，从 $\\boldsymbol{P}_1$ 处的 $s=0$ 到 $\\boldsymbol{P}_2$ 处的 $s=L$。速度的线性插值为：\n$$ \\boldsymbol{w}(s) = \\boldsymbol{w}_1 \\left(1 - \\frac{s}{L}\\right) + \\boldsymbol{w}_2 \\left(\\frac{s}{L}\\right) $$\n外向单位法向量 $\\boldsymbol{n}$ 在直边上是恒定的。该边对面积变化率的贡献为：\n$$ \\int_0^L \\left[ \\boldsymbol{w}_1 \\left(1 - \\frac{s}{L}\\right) + \\boldsymbol{w}_2 \\left(\\frac{s}{L}\\right) \\right] \\cdot \\boldsymbol{n} \\, ds $$\n由于 $\\boldsymbol{w}_1$、$\\boldsymbol{w}_2$ 和 $\\boldsymbol{n}$ 相对于 $s$ 是常数，我们可以重排积分：\n$$ (\\boldsymbol{w}_1 \\cdot \\boldsymbol{n}) \\int_0^L \\left(1 - \\frac{s}{L}\\right) ds + (\\boldsymbol{w}_2 \\cdot \\boldsymbol{n}) \\int_0^L \\frac{s}{L} \\, ds $$\n计算这两个简单积分：\n$$ \\int_0^L \\left(1 - \\frac{s}{L}\\right) ds = \\left[s - \\frac{s^2}{2L}\\right]_0^L = L - \\frac{L^2}{2L} = \\frac{L}{2} $$\n$$ \\int_0^L \\frac{s}{L} \\, ds = \\left[\\frac{s^2}{2L}\\right]_0^L = \\frac{L^2}{2L} = \\frac{L}{2} $$\n将这些结果代回，一条边的贡献为：\n$$ (\\boldsymbol{w}_1 \\cdot \\boldsymbol{n}) \\frac{L}{2} + (\\boldsymbol{w}_2 \\cdot \\boldsymbol{n}) \\frac{L}{2} = \\frac{L}{2} (\\boldsymbol{w}_1 + \\boldsymbol{w}_2) \\cdot \\boldsymbol{n} $$\n这个结果很直观：一条边扫过的面积变化率是其长度乘以其端点法向速度分量的平均值。单元面积的总变化率是所有三条边的这些“边扫掠”项的总和：\n$$ \\frac{dA}{dt} = \\frac{L_{AB}}{2}(\\boldsymbol{w}_A + \\boldsymbol{w}_B) \\cdot \\boldsymbol{n}_{AB} + \\frac{L_{BC}}{2}(\\boldsymbol{w}_B + \\boldsymbol{w}_C) \\cdot \\boldsymbol{n}_{BC} + \\frac{L_{CA}}{2}(\\boldsymbol{w}_C + \\boldsymbol{w}_A) \\cdot \\boldsymbol{n}_{CA} $$\n这就是我们将用于方法(i)计算的表达式。\n\n现在，我们对给定的三角形执行两种指定的计算。\n顶点为 $\\boldsymbol{A}=(0,0)$、$\\boldsymbol{B}=(2,0)$、$\\boldsymbol{C}=(0,3)$。\n顶点速度为 $\\boldsymbol{w}_A=(0.5,-0.2)$、$\\boldsymbol{w}_B=(0.1,0.3)$ 和 $\\boldsymbol{w}_C=(-0.4,0.0)$，单位为 m/s。\n\n(i) 通过边界扫掠积分计算：\n我们需要每条边的几何属性。顶点是按逆时针顺序排列的。对于一条从 $(x_1, y_1)$ 到 $(x_2, y_2)$ 的边，其边向量为 $(\\Delta x, \\Delta y) = (x_2-x_1, y_2-y_1)$，外向法向量与 $(\\Delta y, -\\Delta x)$ 成正比。\n\n边 $\\boldsymbol{AB}$：从 $\\boldsymbol{A}=(0,0)$ 到 $\\boldsymbol{B}=(2,0)$。\n边向量 $\\vec{AB} = (2,0)$。长度 $L_{AB} = \\sqrt{2^2+0^2}=2$。\n外向法向量与 $(0,-2)$ 成正比。单位法向量为 $\\boldsymbol{n}_{AB}=(0,-1)$。\n速度项为 $\\frac{1}{2}(\\boldsymbol{w}_A + \\boldsymbol{w}_B) = \\frac{1}{2}((0.5, -0.2) + (0.1, 0.3)) = \\frac{1}{2}(0.6, 0.1) = (0.3, 0.05)$。\n贡献：$L_{AB} \\left( \\frac{\\boldsymbol{w}_A + \\boldsymbol{w}_B}{2} \\cdot \\boldsymbol{n}_{AB} \\right) = 2 \\cdot ((0.3, 0.05) \\cdot (0,-1)) = 2 \\cdot (0 - 0.05) = -0.1$。\n\n边 $\\boldsymbol{BC}$：从 $\\boldsymbol{B}=(2,0)$ 到 $\\boldsymbol{C}=(0,3)$。\n边向量 $\\vec{BC} = (-2,3)$。长度 $L_{BC} = \\sqrt{(-2)^2+3^2}=\\sqrt{13}$。\n外向法向量与 $(3, -(-2))=(3,2)$ 成正比。单位法向量为 $\\boldsymbol{n}_{BC}=\\frac{1}{\\sqrt{13}}(3,2)$。\n速度项为 $\\frac{1}{2}(\\boldsymbol{w}_B + \\boldsymbol{w}_C) = \\frac{1}{2}((0.1, 0.3) + (-0.4, 0.0)) = \\frac{1}{2}(-0.3, 0.3) = (-0.15, 0.15)$。\n贡献：$L_{BC} \\left( \\frac{\\boldsymbol{w}_B + \\boldsymbol{w}_C}{2} \\cdot \\boldsymbol{n}_{BC} \\right) = \\sqrt{13} \\cdot ((-0.15, 0.15) \\cdot \\frac{1}{\\sqrt{13}}(3,2)) = (-0.15)(3) + (0.15)(2) = -0.45 + 0.30 = -0.15$。\n\n边 $\\boldsymbol{CA}$：从 $\\boldsymbol{C}=(0,3)$ 到 $\\boldsymbol{A}=(0,0)$。\n边向量 $\\vec{CA} = (0,-3)$。长度 $L_{CA} = \\sqrt{0^2+(-3)^2}=3$。\n外向法向量与 $(-3, -0)=(-3,0)$ 成正比。单位法向量为 $\\boldsymbol{n}_{CA}=(-1,0)$。\n速度项为 $\\frac{1}{2}(\\boldsymbol{w}_C + \\boldsymbol{w}_A) = \\frac{1}{2}((-0.4, 0.0) + (0.5, -0.2)) = \\frac{1}{2}(0.1, -0.2) = (0.05, -0.1)$。\n贡献：$L_{CA} \\left( \\frac{\\boldsymbol{w}_C + \\boldsymbol{w}_A}{2} \\cdot \\boldsymbol{n}_{CA} \\right) = 3 \\cdot ((0.05, -0.1) \\cdot (-1,0)) = 3 \\cdot (-0.05 + 0) = -0.15$。\n\n总面积变化率是各项贡献之和：\n$$ \\frac{dA}{dt} = -0.1 - 0.15 - 0.15 = -0.4 \\, \\text{m}^2/\\text{s} $$\n\n(ii) 通过对面积公式求导计算：\n具有顶点 $(x_A, y_A)$、$(x_B, y_B)$ 和 $(x_C, y_C)$ 的三角形面积可以用鞋带公式计算。对于逆时针排序，公式为：\n$$ A = \\frac{1}{2} \\left[ (x_A y_B - x_B y_A) + (x_B y_C - x_C y_B) + (x_C y_A - x_A y_C) \\right] $$\n坐标是时间的函数。对时间 $t$ 求导，并使用 $\\dot{x}=u$ 和 $\\dot{y}=v$：\n$$ \\frac{dA}{dt} = \\frac{1}{2} \\left[ (\\dot{x}_A y_B + x_A \\dot{y}_B - \\dot{x}_B y_A - x_B \\dot{y}_A) + (\\dot{x}_B y_C + x_B \\dot{y}_C - \\dot{x}_C y_B - x_C \\dot{y}_B) + (\\dot{x}_C y_A + x_C \\dot{y}_A - \\dot{x}_A y_C - x_A \\dot{y}_C) \\right] $$\n$$ \\frac{dA}{dt} = \\frac{1}{2} \\left[ (u_A y_B + x_A v_B - u_B y_A - x_B v_A) + (u_B y_C + x_B v_C - u_C y_B - x_C v_B) + (u_C y_A + x_C v_A - u_A y_C - x_A v_C) \\right] $$\n按速度分量分组各项：\n$$ \\frac{dA}{dt} = \\frac{1}{2} \\left[ u_A(y_B - y_C) + u_B(y_C - y_A) + u_C(y_A - y_B) + v_A(x_C - x_B) + v_B(x_A - x_C) + v_C(x_B - x_A) \\right] $$\n现在我们代入给定的数值：\n$\\boldsymbol{A}=(0,0)$、$\\boldsymbol{B}=(2,0)$、$\\boldsymbol{C}=(0,3)$。\n$\\boldsymbol{w}_A=(0.5,-0.2)$、$\\boldsymbol{w}_B=(0.1,0.3)$、$\\boldsymbol{w}_C=(-0.4,0.0)$。\n$$ \\frac{dA}{dt} = \\frac{1}{2} [ 0.5(0-3) + 0.1(3-0) + (-0.4)(0-0) + (-0.2)(0-2) + 0.3(0-0) + 0.0(2-0) ] $$\n$$ \\frac{dA}{dt} = \\frac{1}{2} [ 0.5(-3) + 0.1(3) + 0 + (-0.2)(-2) + 0 + 0 ] $$\n$$ \\frac{dA}{dt} = \\frac{1}{2} [ -1.5 + 0.3 + 0.4 ] $$\n$$ \\frac{dA}{dt} = \\frac{1}{2} [ -0.8 ] = -0.4 \\, \\text{m}^2/\\text{s} $$\n\n两种计算方法得到相同的结果，$\\frac{dA}{dt} = -0.4 \\, \\text{m}^2/\\text{s}$。这种相等关系在边上速度线性变化的假设下，数值上验证了给定移动三角形单元的几何守恒律（GCL）。单元面积的瞬时变化率为负，表明该三角形正在收缩。四舍五入到四位有效数字，结果为 $-0.4000$。",
            "answer": "$$ \\boxed{-0.4000} $$"
        },
        {
            "introduction": "移动网格时存在着单元扭曲或翻转的风险，这会导致模拟崩溃。本练习 () 探讨了网格变换的雅可比行列式如何作为体积变化的局部度量，以及其正性对于维持有效网格拓扑为何至关重要。通过推导一个特定变形下的条件，您将深入理解网格运动所受到的数学约束。",
            "id": "3977458",
            "problem": "在计算流体动力学（CFD）中使用的任意拉格朗日-欧拉（ALE）网格运动中，一个具有坐标 $\\mathbf{x} \\in \\Omega \\subset \\mathbb{R}^{3}$ 的参考构型通过 $\\boldsymbol{\\Phi}(\\mathbf{x}) = \\mathbf{x} + \\mathbf{d}(\\mathbf{x})$ 映射到一个变形构型，其中位移场 $\\mathbf{d} : \\Omega \\to \\mathbb{R}^{3}$ 是连续可微的。考虑立方体 $\\Omega = (0,L)^{3}$（其中 $L > 0$）以及可分离的三角函数位移\n$$\n\\mathbf{d}(\\mathbf{x}) = \\begin{pmatrix}\nA \\sin\\!\\big(\\pi x_{1}/L\\big) \\\\\nA \\sin\\!\\big(\\pi x_{2}/L\\big) \\\\\nA \\sin\\!\\big(\\pi x_{3}/L\\big)\n\\end{pmatrix},\n$$\n其中 $A \\in \\mathbb{R}$ 是一个具有长度物理量纲的振幅参数。从体积分的变量替换定理和 $\\boldsymbol{\\Phi}$ 的雅可比矩阵的定义出发，执行以下操作：\n\n1. 根据 $\\boldsymbol{\\Phi}$ 的雅可比矩阵推导局部体积比 $J(\\mathbf{x})$，并将其表示为 $J(\\mathbf{x}) = \\det\\!\\big(\\mathbf{I} + \\nabla \\mathbf{d}(\\mathbf{x})\\big)$ 的形式，其中 $\\mathbf{I}$ 是单位张量，$\\nabla \\mathbf{d}$ 是位移梯度。\n\n2. 对于给定的 $\\mathbf{d}(\\mathbf{x})$，在 $\\Omega$ 上显式计算 $J(\\mathbf{x})$。\n\n3. 从矩阵分析的基本原理出发，推导一个关于 $\\nabla \\mathbf{d}(\\mathbf{x})$ 特征值的条件，以保证局部体积处处为正，即对于所有 $\\mathbf{x} \\in \\Omega$ 都有 $J(\\mathbf{x}) > 0$。然后，利用此条件，对于任意连续可微的 $\\mathbf{d}$，得出一个形式为 $\\|\\nabla \\mathbf{d}(\\mathbf{x})\\|_{2}  c$（其中 $c$ 为一合适的常数）的普遍充分条件，以确保 $J(\\mathbf{x}) > 0$ 处处成立。\n\n4. 将您的结果应用于给定的 $\\mathbf{d}(\\mathbf{x})$，并确定最大振幅 $A_{\\max}$，使得对于所有 $\\mathbf{x} \\in \\Omega$ 都有 $J(\\mathbf{x}) > 0$。以 $L$ 的精确表达式形式给出 $A_{\\max}$。\n\n将 $A_{\\max}$ 的最终答案以米为单位表示，且不要进行四舍五入。",
            "solution": "**第1部分：局部体积比的推导**\n\n从参考构型坐标 $\\mathbf{x}$ 到变形构型坐标 $\\boldsymbol{\\Phi}(\\mathbf{x})$ 的映射由 $\\boldsymbol{\\Phi}(\\mathbf{x}) = \\mathbf{x} + \\mathbf{d}(\\mathbf{x})$ 给出。局部体积的变化由该变换的雅可比行列式表征。将无穷小线元从参考构型映射到变形构型的张量是变形梯度张量 $\\mathbf{F}$，定义为：\n$$\n\\mathbf{F}(\\mathbf{x}) = \\nabla_{\\mathbf{x}} \\boldsymbol{\\Phi}(\\mathbf{x})\n$$\n其分量形式为 $F_{ij} = \\frac{\\partial \\Phi_i}{\\partial x_j}$。代入 $\\boldsymbol{\\Phi}$ 的定义：\n$$\nF_{ij} = \\frac{\\partial}{\\partial x_j} (x_i + d_i(\\mathbf{x})) = \\frac{\\partial x_i}{\\partial x_j} + \\frac{\\partial d_i}{\\partial x_j}\n$$\n项 $\\frac{\\partial x_i}{\\partial x_j}$ 是克罗内克δ函数 $\\delta_{ij}$，即单位张量 $\\mathbf{I}$ 的分量表示。项 $\\frac{\\partial d_i}{\\partial x_j}$ 是位移梯度张量 $\\nabla \\mathbf{d}(\\mathbf{x})$ 的分量表示。因此，用张量表示法：\n$$\n\\mathbf{F}(\\mathbf{x}) = \\mathbf{I} + \\nabla \\mathbf{d}(\\mathbf{x})\n$$\n体积分的变量替换定理指出，变形构型中的无穷小体积元 $dV$ 与参考构型中相应的无穷小体积元 $dV_0$ 的关系如下：\n$$\ndV = J(\\mathbf{x}) dV_0\n$$\n其中 $J(\\mathbf{x})$ 是局部体积比，定义为变形梯度张量的行列式：\n$$\nJ(\\mathbf{x}) = \\det(\\mathbf{F}(\\mathbf{x}))\n$$\n代入 $\\mathbf{F}(\\mathbf{x})$ 的表达式，我们得到所需的形式：\n$$\nJ(\\mathbf{x}) = \\det(\\mathbf{I} + \\nabla \\mathbf{d}(\\mathbf{x}))\n$$\n\n**第2部分：$J(\\mathbf{x})$ 的显式计算**\n\n给定的位移场为 $\\mathbf{d}(\\mathbf{x}) = (d_1, d_2, d_3)^T$，其中 $d_1 = A \\sin(\\pi x_1/L)$，$d_2 = A \\sin(\\pi x_2/L)$，$d_3 = A \\sin(\\pi x_3/L)$。我们必须首先计算位移梯度张量 $\\nabla \\mathbf{d}$，其分量为 $(\\nabla \\mathbf{d})_{ij} = \\frac{\\partial d_i}{\\partial x_j}$。\n\n偏导数是：\n$$\n\\frac{\\partial d_1}{\\partial x_1} = \\frac{\\partial}{\\partial x_1} \\left( A \\sin\\left(\\frac{\\pi x_1}{L}\\right) \\right) = A \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x_1}{L}\\right)\n$$\n$$\n\\frac{\\partial d_1}{\\partial x_2} = 0, \\quad \\frac{\\partial d_1}{\\partial x_3} = 0\n$$\n类似地，对于 $d_2$ 和 $d_3$：\n$$\n\\frac{\\partial d_2}{\\partial x_2} = A \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x_2}{L}\\right), \\quad \\frac{\\partial d_2}{\\partial x_1} = 0, \\quad \\frac{\\partial d_2}{\\partial x_3} = 0\n$$\n$$\n\\frac{\\partial d_3}{\\partial x_3} = A \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x_3}{L}\\right), \\quad \\frac{\\partial d_3}{\\partial x_1} = 0, \\quad \\frac{\\partial d_3}{\\partial x_2} = 0\n$$\n因此，位移梯度张量 $\\nabla \\mathbf{d}$ 是一个对角矩阵：\n$$\n\\nabla \\mathbf{d}(\\mathbf{x}) = \\begin{pmatrix}\nA \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x_1}{L}\\right) & 0 & 0 \\\\\n0 & A \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x_2}{L}\\right) & 0 \\\\\n0 & 0 & A \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x_3}{L}\\right)\n\\end{pmatrix}\n$$\n变形梯度为 $\\mathbf{F} = \\mathbf{I} + \\nabla \\mathbf{d}$：\n$$\n\\mathbf{F}(\\mathbf{x}) = \\begin{pmatrix}\n1 + A \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x_1}{L}\\right) & 0 & 0 \\\\\n0 & 1 + A \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x_2}{L}\\right) & 0 \\\\\n0 & 0 & 1 + A \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x_3}{L}\\right)\n\\end{pmatrix}\n$$\n雅可比行列式 $J(\\mathbf{x})$ 是这个对角矩阵的行列式，即其对角元素的乘积：\n$$\nJ(\\mathbf{x}) = \\left(1 + A \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x_1}{L}\\right)\\right) \\left(1 + A \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x_2}{L}\\right)\\right) \\left(1 + A \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x_3}{L}\\right)\\right)\n$$\n\n**第3部分：严格正体积的条件**\n\n根据线性代数，矩阵 $\\mathbf{M}$ 的行列式是其特征值 $\\lambda_i(\\mathbf{M})$ 的乘积。对于矩阵 $\\mathbf{I} + \\nabla \\mathbf{d}$，其特征值为 $1 + \\lambda_i(\\nabla \\mathbf{d})$，其中 $\\lambda_i(\\nabla \\mathbf{d})$ 是 $\\nabla \\mathbf{d}$ 的特征值。因此，\n$$\nJ(\\mathbf{x}) = \\det(\\mathbf{I} + \\nabla\\mathbf{d}(\\mathbf{x})) = \\prod_{i=1}^{3} (1 + \\lambda_i(\\nabla\\mathbf{d}(\\mathbf{x})))\n$$\n位移场是连续可微的，这意味着特征值 $\\lambda_i$ 随 $\\mathbf{x}$ 和振幅 $A$ 连续变化。从 $A=0$ 开始，我们有 $\\mathbf{d}=\\mathbf{0}$，$\\nabla \\mathbf{d}=\\mathbf{0}$，所有 $\\lambda_i=0$，且 $J=1$。要使 $J(\\mathbf{x})$ 变为非正（即 $\\le 0$），至少有一个因子 $(1 + \\lambda_i)$ 必须变为非正。如果一个特征值 $\\lambda_i$ 是复数，它会以共轭对 $\\lambda, \\bar{\\lambda}$ 的形式出现。对应的因子乘积 $(1+\\lambda)(1+\\bar{\\lambda})$ 总是正的（除非 $\\lambda=-1$，这是实数）。因此，只有当一个实特征值 $\\lambda_r$ 变得小于或等于 $-1$ 时，$J(\\mathbf{x})$ 才能变为非正。\n确保 $J(\\mathbf{x})>0$ 的一个充分必要条件是，对于 $\\nabla \\mathbf{d}(\\mathbf{x})$ 的所有实特征值 $\\lambda_r$，我们必须有 $1+\\lambda_r > 0$，即 $\\lambda_r > -1$。\n\n为了获得一个基于矩阵范数的普遍充分条件，我们使用以下性质：对于矩阵 $\\mathbf{M}$ 的任意实特征值 $\\lambda_r$，我们有 $|\\lambda_r| \\le \\rho(\\mathbf{M}) \\le \\|\\mathbf{M}\\|_k$，其中 $k$ 是任意诱导矩阵范数，$\\rho$ 是谱半径。特别地，对于谱范数（2-范数），我们有 $-\\|\\mathbf{M}\\|_2 \\le \\lambda_r \\le \\|\\mathbf{M}\\|_2$。\n将此应用于 $\\nabla \\mathbf{d}(\\mathbf{x})$：\n$$\n-\\|\\nabla \\mathbf{d}(\\mathbf{x})\\|_2 \\le \\lambda_r(\\nabla \\mathbf{d}(\\mathbf{x}))\n$$\n如果我们施加条件 $\\|\\nabla \\mathbf{d}(\\mathbf{x})\\|_2 < 1$，则可以得出 $\\lambda_r(\\nabla \\mathbf{d}(\\mathbf{x})) > -1$。这也确保了对于任何复特征值 $\\lambda = a+ib$，$|\\lambda|<1$，这意味着 $|a|<1$，因此 $1+a>0$，从而保持行列式为正。因此，确保 $J(\\mathbf{x})>0$ 的一个普遍充分条件是 $\\|\\nabla \\mathbf{d}(\\mathbf{x})\\|_{2} < c$，常数 $c=1$。\n\n**第4部分：最大振幅 $A_{max}$ 的确定**\n\n我们将充分必要条件 $\\lambda_i > -1$ 应用于我们的特定情况。由于矩阵 $\\nabla \\mathbf{d}(\\mathbf{x})$ 是对角的，其特征值就是其对角线上的元素：\n$$\n\\lambda_i(\\mathbf{x}) = A \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x_i}{L}\\right) \\quad \\text{for } i=1,2,3\n$$\n问题要求对于所有 $\\mathbf{x} \\in \\Omega = (0,L)^3$ 都有 $J(\\mathbf{x}) > 0$。这等价于要求 $J(\\mathbf{x})$ 表达式中的每个因子对于所有 $\\mathbf{x} \\in \\Omega$ 都为正。\n$$\n1 + A \\frac{\\pi}{L} \\cos\\left(\\frac{\\pi x_i}{L}\\right) > 0 \\quad \\text{for } x_i \\in (0,L)\n$$\n这对于 $i=1,2,3$ 都必须成立。我们来分析单个分量的不等式。令 $\\theta_i = \\pi x_i / L$。对于 $x_i \\in (0,L)$，我们有 $\\theta_i \\in (0,\\pi)$，因此 $\\cos(\\theta_i) \\in (-1,1)$。\n\n情况1：$A > 0$。当 $\\cos(\\theta_i)$ 取最负值时，表达式 $1 + A \\frac{\\pi}{L} \\cos(\\theta_i)$ 最小。在 $(0,\\pi)$ 上 $\\cos(\\theta_i)$ 的下确界是 $-1$。为了对所有 $\\theta_i \\in (0,\\pi)$ 保持正性，该表达式在此下确界处的值必须为非负。\n$$\n1 + A \\frac{\\pi}{L} (-1) \\ge 0 \\implies 1 \\ge A \\frac{\\pi}{L} \\implies A \\le \\frac{L}{\\pi}\n$$\n如果 $A = L/\\pi$，因子为 $1 + \\cos(\\theta_i)$。对于 $\\theta_i \\in (0,\\pi)$，$\\cos(\\theta_i) > -1$，所以 $1 + \\cos(\\theta_i) > 0$。因此，$A=L/\\pi$ 是一个有效的振幅。\n\n情况2：$A < 0$。令 $A = -|A|$。当 $\\cos(\\theta_i)$ 取最正值时，表达式 $1 - |A| \\frac{\\pi}{L} \\cos(\\theta_i)$ 最小。在 $(0,\\pi)$ 上 $\\cos(\\theta_i)$ 的上确界是 $1$。条件变为：\n$$\n1 - |A| \\frac{\\pi}{L} (1) \\ge 0 \\implies 1 \\ge |A| \\frac{\\pi}{L} \\implies |A| \\le \\frac{L}{\\pi}\n$$\n由于 $A = -|A|$，这意味着 $A \\ge -L/\\pi$。\n结合两种情况，使得对所有 $\\mathbf{x} \\in \\Omega$ 都有 $J(\\mathbf{x}) > 0$ 的 $A$ 的完整范围是 $[-L/\\pi, L/\\pi]$。\n\n问题要求的是最大振幅 $A_{max}$。这意味着在允许范围内的 $A$ 的最大正值。\n因此，最大振幅是 $A_{max} = L/\\pi$。量 $A$ 和 $L$ 都具有长度的量纲。",
            "answer": "$$\\boxed{\\frac{L}{\\pi}}$$"
        },
        {
            "introduction": "建立了一个有效的移动网格后，我们必须理解这种运动如何影响其上求解的控制方程的数值稳定性。本练习 () 将指导您在ALE框架下，为一个简单的对流方程推导类似CFL的时间步长约束。您将看到流体与网格之间的相对速度如何决定了显式格式保持稳定所允许的最大时间步长。",
            "id": "3977423",
            "problem": "考虑在计算流体力学 (CFD) 中使用的移动网格上，对无源标量场 $\\phi(x,t)$ 进行一维任意拉格朗日-欧拉 (ALE) 有限体积离散化。移动网格遵循几何守恒律 (GCL)，惯性参考系下的流体速度为 $u$，网格速度为 $w$，当前时刻的单元尺寸为 $\\Delta x$。在惯性参考系中，该标量场满足守恒律 $\\partial \\phi / \\partial t + \\partial (u \\phi) / \\partial x = 0$。在 ALE 参考系中，对流通量由 $f_{\\mathrm{ALE}}(\\phi) = (u - w)\\,\\phi$ 给出。在一个当前测度为 $J = \\Delta x$ 的控制体上的半离散有限体积平衡方程为 $\\mathrm{d}(J \\phi_i)/\\mathrm{d}t = -\\left(F_{i+1/2} - F_{i-1/2}\\right)$，其中 $F_{i\\pm 1/2}$ 是在单元界面上计算的数值通量。时间积分采用显式前向欧拉法。\n\n假设数值通量是应用于 ALE 对流通量的 Rusanov（局部 Lax–Friedrichs）通量，即在界面 $i+1/2$ 处，\n$$\n\\hat{f}_{i+1/2} = \\frac{1}{2}\\left(f_{\\mathrm{ALE}}(\\phi_{i}^{R}) + f_{\\mathrm{ALE}}(\\phi_{i+1}^{L})\\right) - \\frac{1}{2}\\,\\alpha_{i+1/2}\\left(\\phi_{i+1}^{L} - \\phi_{i}^{R}\\right),\n$$\n其中 $\\phi_{i}^{R}$ 和 $\\phi_{i+1}^{L}$ 是从相邻单元重构的界面左右状态，$\\alpha_{i+1/2}$ 是耗散参数，等于 $f_{\\mathrm{ALE}}$ 关于 $\\phi$ 的雅可比矩阵在局部评估的谱半径。对于线性 ALE 平流输运通量 $f_{\\mathrm{ALE}}(\\phi) = (u - w)\\,\\phi$，该谱半径为 $|u - w|$。\n\n从守恒律、ALE 通量定义以及单调两点数值通量的性质出发，推导时间步长 $\\Delta t$ 应满足的条件，以确保前向欧拉更新是相邻状态的凸组合（从而使格式在单调性框架下非线性稳定）。然后，根据以下局部数值计算最大允许时间步长：$u = 350$ $\\mathrm{m/s}$，$w = 30$ $\\mathrm{m/s}$，$\\Delta x = 2.5 \\times 10^{-3}$ $\\mathrm{m}$。最终答案以秒为单位，并四舍五入到四位有效数字。",
            "solution": "出发点是 ALE 参考系中的半离散有限体积守恒律：\n$$\n\\frac{\\mathrm{d}(J_i \\phi_i)}{\\mathrm{d}t} = -(\\hat{f}_{i+1/2} - \\hat{f}_{i-1/2})\n$$\n其中 $J_i = \\Delta x_i$ 是单元 $i$ 的测度，$\\hat{f}$ 是数值通量。应用前向欧拉法进行时间积分，得到：\n$$\n\\frac{(J_i \\phi_i)^{n+1} - (J_i \\phi_i)^n}{\\Delta t} = -(\\hat{f}_{i+1/2}^n - \\hat{f}_{i-1/2}^n)\n$$\n这里，上标 $n$ 表示时间层 $t^n$。为了推导时间步长 $\\Delta t$ 的局部稳定性条件，我们进行局部分析。这个标准程序假设在单元 $i$ 的紧邻区域内，网格和流动属性是均匀的。因此，网格速度是均匀的，$w_{i+1/2} = w_{i-1/2}$，这意味着单元尺寸不发生变化，即 $\\Delta x_i^{n+1} = \\Delta x_i^n = \\Delta x$。这种简化与问题为 $u$、$w$ 和 $\\Delta x$ 提供单一恒定值是一致的。\n\n在此假设下，GCL 被平凡地满足，更新方程简化为：\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{\\Delta t}{\\Delta x}(\\hat{f}_{i+1/2}^n - \\hat{f}_{i-1/2}^n)\n$$\n问题要求此更新是相邻状态的凸组合。这意味着更新后的状态 $\\phi_i^{n+1}$ 必须可以表示为：\n$$\n\\phi_i^{n+1} = C_{i-1}\\phi_{i-1}^n + C_i\\phi_i^n + C_{i+1}\\phi_{i+1}^n\n$$\n其中系数为非负 $C_k \\ge 0$，且总和为一，$\\sum_k C_k = 1$。\n\n我们现在代入 Rusanov 通量的具体形式。令 $c = u - w$ 为相对平流速度。ALE 通量为 $f_{\\mathrm{ALE}}(\\phi) = c\\phi$。对于一阶格式，我们使用 $\\phi_i^R = \\phi_i$ 和 $\\phi_{i+1}^L = \\phi_{i+1}$。在界面 $i+1/2$ 处的 Rusanov 通量为：\n$$\n\\hat{f}_{i+1/2} = \\frac{1}{2}(f_{\\mathrm{ALE}}(\\phi_i) + f_{\\mathrm{ALE}}(\\phi_{i+1})) - \\frac{1}{2}|c|(\\phi_{i+1} - \\phi_i)\n$$\n$$\n\\hat{f}_{i+1/2} = \\frac{1}{2}(c\\phi_i + c\\phi_{i+1}) - \\frac{1}{2}|c|(\\phi_{i+1} - \\phi_i)\n$$\n这是一个单调的两点通量。我们可以收集关于 $\\phi_i$ 和 $\\phi_{i+1}$ 的项：\n$$\n\\hat{f}_{i+1/2} = \\phi_i \\left(\\frac{c+|c|}{2}\\right) + \\phi_{i+1} \\left(\\frac{c-|c|}{2}\\right)\n$$\n在界面 $i-1/2$ 处的通量通过移动下标得到：\n$$\n\\hat{f}_{i-1/2} = \\phi_{i-1} \\left(\\frac{c+|c|}{2}\\right) + \\phi_i \\left(\\frac{c-|c|}{2}\\right)\n$$\n现在，我们计算通量差 $\\hat{f}_{i+1/2} - \\hat{f}_{i-1/2}$：\n$$\n\\hat{f}_{i+1/2} - \\hat{f}_{i-1/2} = \\left[ \\phi_i \\left(\\frac{c+|c|}{2}\\right) + \\phi_{i+1} \\left(\\frac{c-|c|}{2}\\right) \\right] - \\left[ \\phi_{i-1} \\left(\\frac{c+|c|}{2}\\right) + \\phi_i \\left(\\frac{c-|c|}{2}\\right) \\right]\n$$\n根据 $\\phi_j$ 收集各项：\n$$\n\\hat{f}_{i+1/2} - \\hat{f}_{i-1/2} = - \\phi_{i-1} \\left(\\frac{c+|c|}{2}\\right) + \\phi_i \\left(\\frac{c+|c|}{2} - \\frac{c-|c|}{2}\\right) + \\phi_{i+1} \\left(\\frac{c-|c|}{2}\\right)\n$$\n$$\n\\hat{f}_{i+1/2} - \\hat{f}_{i-1/2} = - \\left(\\frac{c+|c|}{2}\\right) \\phi_{i-1} + |c|\\phi_i + \\left(\\frac{c-|c|}{2}\\right) \\phi_{i+1}\n$$\n将此通量差代回更新方程（在右侧省略上标 $n$）：\n$$\n\\phi_i^{n+1} = \\phi_i - \\frac{\\Delta t}{\\Delta x} \\left[ - \\left(\\frac{c+|c|}{2}\\right) \\phi_{i-1} + |c|\\phi_i + \\left(\\frac{c-|c|}{2}\\right) \\phi_{i+1} \\right]\n$$\n重新整理以匹配凸组合形式：\n$$\n\\phi_i^{n+1} = \\left(\\frac{\\Delta t}{\\Delta x} \\frac{c+|c|}{2}\\right) \\phi_{i-1} + \\left(1 - \\frac{\\Delta t|c|}{\\Delta x}\\right) \\phi_i + \\left(-\\frac{\\Delta t}{\\Delta x} \\frac{c-|c|}{2}\\right) \\phi_{i+1}\n$$\n这些系数是：\n$C_{i-1} = \\frac{\\Delta t}{\\Delta x} \\frac{c+|c|}{2}$\n$C_i = 1 - \\frac{\\Delta t|c|}{\\Delta x}$\n$C_{i+1} = \\frac{\\Delta t}{\\Delta x} \\frac{|c|-c}{2}$\n\n我们检查凸组合的条件。首先，系数之和：\n$$\n\\sum_k C_k = C_{i-1} + C_i + C_{i+1} = \\frac{\\Delta t}{\\Delta x}\\left(\\frac{c+|c|}{2}\\right) + 1 - \\frac{\\Delta t|c|}{\\Delta x} + \\frac{\\Delta t}{\\Delta x}\\left(\\frac{|c|-c}{2}\\right)\n$$\n$$\n\\sum_k C_k = 1 + \\frac{\\Delta t}{\\Delta x} \\left( \\frac{c+|c|+|c|-c}{2} - |c| \\right) = 1 + \\frac{\\Delta t}{\\Delta x} \\left( \\frac{2|c|}{2} - |c| \\right) = 1 + \\frac{\\Delta t}{\\Delta x} (|c| - |c|) = 1\n$$\n和为 $1$，符合要求。接下来，我们要求所有系数都为非负。\n1. $C_{i-1} \\ge 0$: $\\frac{\\Delta t}{\\Delta x} \\frac{c+|c|}{2} \\ge 0$。这总是成立的，因为 $c+|c|$ 要么是 $2c > 0$（当 $c>0$ 时），要么是 $0$（当 $c \\le 0$ 时），并且 $\\Delta t, \\Delta x > 0$。\n2. $C_{i+1} \\ge 0$: $\\frac{\\Delta t}{\\Delta x} \\frac{|c|-c}{2} \\ge 0$。这总是成立的，因为 $|c|-c$ 要么是 $0$（当 $c \\ge 0$ 时），要么是 $-2c > 0$（当 $c < 0$ 时）。\n3. $C_i \\ge 0$: $1 - \\frac{\\Delta t|c|}{\\Delta x} \\ge 0$。这给出了稳定性条件：\n$$\n\\frac{\\Delta t |c|}{\\Delta x} \\le 1 \\implies \\Delta t \\le \\frac{\\Delta x}{|c|}\n$$\n代入 $c=u-w$，这是将 Rusanov 通量应用于 ALE 框架中线性平流的一般结果，我们得到条件：\n$$\n\\Delta t \\le \\frac{\\Delta x}{|u - w|}\n$$\n因此，最大允许时间步长为 $\\Delta t_{\\mathrm{max}} = \\frac{\\Delta x}{|u-w|}$。\n\n现在，我们计算数值。\n已知：\n$u = 350 \\, \\mathrm{m/s}$\n$w = 30 \\, \\mathrm{m/s}$\n$\\Delta x = 2.5 \\times 10^{-3} \\, \\mathrm{m}$\n\n相对速度为 $|u - w| = |350 - 30| = 320 \\, \\mathrm{m/s}$。\n最大时间步长为：\n$$\n\\Delta t_{\\mathrm{max}} = \\frac{2.5 \\times 10^{-3} \\, \\mathrm{m}}{320 \\, \\mathrm{m/s}} = \\frac{2.5}{320} \\times 10^{-3} \\, \\mathrm{s}\n$$\n$$\n\\Delta t_{\\mathrm{max}} = 0.0078125 \\times 10^{-3} \\, \\mathrm{s} = 7.8125 \\times 10^{-6} \\, \\mathrm{s}\n$$\n问题要求四舍五入到四位有效数字。第五位有效数字是 $5$，所以我们将第四位数字向上取整。\n$$\n\\Delta t_{\\mathrm{max}} \\approx 7.813 \\times 10^{-6} \\, \\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{7.813 \\times 10^{-6}}\n$$"
        }
    ]
}