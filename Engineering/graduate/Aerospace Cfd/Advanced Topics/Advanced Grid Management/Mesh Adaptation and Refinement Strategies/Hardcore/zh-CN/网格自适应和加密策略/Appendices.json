{
    "hands_on_practices": [
        {
            "introduction": "在计算流体动力学中，一项基本任务是验证我们的计算结果是否可靠，即它们不应过分依赖于网格的分辨率。网格收敛指数（Grid Convergence Index, GCI）是一种用于量化离散误差的标准化方法，它构成了任何严谨的CFD验证与确认（Verification and Validation, V&V）程序的核心。本练习的目标是应用Richardson外推法来估计观测到的精度阶数 $p$ 并计算GCI ()。掌握这项技能对于评估数值解的质量和建立对模拟预测的信心至关重要。",
            "id": "3975807",
            "problem": "在计算流体力学 (CFD) 中，对一个可压缩无粘性翼型进行计算，该计算使用了三套连续加密的结构化网格，其网格间距分别为 $h_1 > h_2 > h_3$，且加密比为常数 $r = h_1/h_2 = h_2/h_3$。对于一个标量目标量 (QoI) $Q$，你分别在这些网格上获得了网格收敛解 $Q_1$、$Q_2$ 和 $Q_3$。假设解处于渐近区域，且离散误差服从主阶模型 $Q(h) = Q^{\\ast} + K h^{p} + \\mathcal{O}(h^{p+1})$，其中 $Q^{\\ast}$ 是精确的目标量，$K$ 是一个非零常数，$p$ 是观测到的精度阶数。这三套网格的解序列是单调且同号的。\n\n给定数据 $Q_1 = 0.142$，$Q_2 = 0.138$，$Q_3 = 0.1365$ 和 $r = 2$。仅使用这些数据和渐近误差模型：\n\n1. 从第一性原理出发，推导一个公式，利用三套网格的数据和常数加密比 $r$ 来估计观测到的阶数 $p$，然后计算其数值。\n2. 使用相同的渐近模型，推导用 $Q_3$、$Q_2$、$r$ 和 $p$ 表示 $Q^{\\ast}$ 的双网格 Richardson 外推表达式，并计算外推值 $Q_{\\text{ext}}$。\n3. 概述计算网格对 $(h_3, h_2)$ 的细网格收敛指数 (GCI) 的标准步骤，包括安全因子 $F_s$ 的选择和作用，然后使用 $F_s = 1.25$ 计算 $\\text{GCI}_{32}$ 的数值。将 $\\text{GCI}_{32}$ 表示为一个无量纲小数。\n\n将 $p$ 的数值和 $\\text{GCI}_{32}$ 的数值都四舍五入到四位有效数字。按顺序 $\\left(p, \\text{GCI}_{32}\\right)$ 以两个数的形式提供你的最终答案。",
            "solution": "对问题陈述进行验证。\n\n### 第 1 步：提取已知条件\n- 在计算流体力学 (CFD) 中的可压缩无粘性翼型计算。\n- 三套连续加密的结构化网格，网格间距为 $h_1 > h_2 > h_3$。\n- 恒定的加密比 $r = h_1/h_2 = h_2/h_3$。\n- 标量目标量 (QoI) $Q$ 的网格收敛解：$Q_1$、$Q_2$ 和 $Q_3$。\n- 渐近误差模型：$Q(h) = Q^{\\ast} + K h^{p} + \\mathcal{O}(h^{p+1})$，其中 $Q^{\\ast}$ 是精确的目标量，$K$ 是非零常数，$p$ 是观测到的精度阶数。\n- 三套网格的解序列是单调且同号的。\n- 给定数据：$Q_1 = 0.142$，$Q_2 = 0.138$，$Q_3 = 0.1365$，以及 $r = 2$。\n- 任务：\n  1. 推导并计算观测到的阶数 $p$。\n  2. 推导 $Q^{\\ast}$ 的 Richardson 外推表达式并计算其值 $Q_{\\text{ext}}$。\n  3. 概述计算网格收敛指数 $\\text{GCI}_{32}$ 的步骤并使用安全因子 $F_s = 1.25$ 进行计算。\n- 四舍五入要求：$p$ 和 $\\text{GCI}_{32}$ 保留四位有效数字。\n- 最终答案格式：一个包含 $p$ 和 $\\text{GCI}_{32}$ 数值的行矩阵。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据：** 该问题描述了 CFD 中一个标准的、被广泛接受的验证和确认程序，即基于 Richardson 外推的网格收敛指数 (GCI) 方法。渐近误差模型是该方法的基本假设。该程序在科学文献中有详细记载（例如，Roache、Celik 等人的著作）。\n- **适定性：** 该问题提供了唯一确定所需量（$p$ 和 $\\text{GCI}_{32}$）的所有必要数据（$Q_1, Q_2, Q_3, r, F_s$）。数据满足收敛单调性的条件（$0.142 > 0.138 > 0.1365$），这是该方法标准应用的先决条件。\n- **客观性：** 问题以精确、技术性的语言陈述，没有主观性或歧义。\n\n### 第 3 步：结论和行动\n该问题具有科学合理性、适定性、客观性和完整性。这是数值方法和计算流体力学领域一个有效的问题。我将继续进行求解。\n\n解答需要执行问题陈述中指定的三个任务。\n\n**1. 观测精度阶数 $p$ 的推导与计算**\n\n假设解处于渐近区域，其中误差由主导项决定。误差模型由 $Q(h) \\approx Q^{\\ast} + K h^{p}$ 给出。我们可以为三套网格写出这个表达式：\n$$Q_1 \\approx Q^{\\ast} + K h_1^{p}$$\n$$Q_2 \\approx Q^{\\ast} + K h_2^{p}$$\n$$Q_3 \\approx Q^{\\ast} + K h_3^{p}$$\n为了消除未知的精确解 $Q^{\\ast}$，我们计算连续网格上解的差值：\n$$Q_1 - Q_2 \\approx K (h_1^p - h_2^p)$$\n$$Q_2 - Q_3 \\approx K (h_2^p - h_3^p)$$\n接下来，我们取这些差值的比率以消除未知常数 $K$：\n$$\\frac{Q_1 - Q_2}{Q_2 - Q_3} \\approx \\frac{h_1^p - h_2^p}{h_2^p - h_3^p}$$\n使用恒定的网格加密比 $r = h_1/h_2 = h_2/h_3$，我们可以用 $h_2$ 表示 $h_1$ 和 $h_3$：$h_1 = r h_2$ 和 $h_3 = h_2/r$。将这些代入比率中：\n$$\\frac{Q_1 - Q_2}{Q_2 - Q_3} \\approx \\frac{(r h_2)^p - h_2^p}{h_2^p - (h_2/r)^p} = \\frac{h_2^p (r^p - 1)}{h_2^p (1 - r^{-p})} = \\frac{r^p - 1}{(r^p - 1)/r^p} = r^p$$\n这就得到了 $p$ 的公式。为了求解 $p$，我们对两边取自然对数：\n$$\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right) \\approx p \\ln(r)$$\n因此，推导出的观测精度阶数公式为：\n$$p \\approx \\frac{\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right)}{\\ln(r)}$$\n现在，我们代入给定的数值：$Q_1 = 0.142$，$Q_2 = 0.138$，$Q_3 = 0.1365$，以及 $r = 2$。\n$$p \\approx \\frac{\\ln\\left(\\frac{0.142 - 0.138}{0.138 - 0.1365}\\right)}{\\ln(2)} = \\frac{\\ln\\left(\\frac{0.004}{0.0015}\\right)}{\\ln(2)} = \\frac{\\ln(8/3)}{\\ln(2)}$$\n计算数值：\n$$p \\approx \\frac{0.980829253}{0.693147181} \\approx 1.415037499$$\n四舍五入到四位有效数字，我们得到 $p \\approx 1.415$。\n\n**2. Richardson 外推值 $Q_{\\text{ext}}$ 的推导与计算**\n\n我们使用两套最细网格的解 $Q_2$ 和 $Q_3$ 来求外推值，记为 $Q_{\\text{ext}}$。该模型给出：\n$$Q_2 \\approx Q_{\\text{ext}} + K h_2^{p}$$\n$$Q_3 \\approx Q_{\\text{ext}} + K h_3^{p}$$\n使用 $h_2 = r h_3$，第一个方程变为 $Q_2 \\approx Q_{\\text{ext}} + K (r h_3)^{p} = Q_{\\text{ext}} + K r^p h_3^p$。为消除 $K$，我们将第二个方程乘以 $r^p$：\n$$r^p Q_3 \\approx r^p Q_{\\text{ext}} + K r^p h_3^p$$\n从此式中减去 $Q_2$ 的表达式，得到：\n$$r^p Q_3 - Q_2 \\approx (r^p Q_{\\text{ext}} - Q_{\\text{ext}}) = Q_{\\text{ext}}(r^p - 1)$$\n求解 $Q_{\\text{ext}}$，我们推导出双网格 Richardson 外推公式：\n$$Q_{\\text{ext}} = \\frac{r^p Q_3 - Q_2}{r^p - 1}$$\n这可以重写以显示对细网格解的修正：\n$$Q_{\\text{ext}} = Q_3 + \\frac{Q_3 - Q_2}{r^p - 1}$$\n我们使用上一步得到的精确比率 $r^p = 8/3$，以及 $Q_2 = 0.138$ 和 $Q_3 = 0.1365$ 来计算 $Q_{\\text{ext}}$ 的数值：\n$$Q_{\\text{ext}} = 0.1365 + \\frac{0.1365 - 0.138}{(8/3) - 1} = 0.1365 + \\frac{-0.0015}{5/3} = 0.1365 - (0.0015 \\times \\frac{3}{5}) = 0.1365 - 0.0009 = 0.1356$$\n所以，外推值为 $Q_{\\text{ext}} = 0.1356$。\n\n**3. 网格收敛指数 ($\\text{GCI}_{32}$)**\n\n网格收敛指数 (GCI) 提供了一种衡量由离散误差引起的细网格解不确定性的方法。计算网格对 $(h_3, h_2)$ 的细网格 GCI（记为 $\\text{GCI}_{32}$）的标准步骤如下：\n- **步骤 A：** 使用三套网格的解数据计算表观精度阶数 $p$。这已在第 1 部分完成。\n- **步骤 B：** 计算两套最细网格解 $Q_2$ 和 $Q_3$ 之间的相对差异。标准公式通过细网格解进行归一化：\n  $$e_{a,32} = \\left| \\frac{Q_3 - Q_2}{Q_3} \\right|$$\n- **步骤 C：** 应用 GCI 公式，该公式将此相对差异乘以一个因子，该因子包括安全因子 $F_s$ 和加密比 $r$ 的 $p$ 次方：\n  $$\\text{GCI}_{32} = \\frac{F_s |e_{a,32}|}{r^p - 1} = \\frac{F_s}{r^p - 1} \\left| \\frac{Q_3 - Q_2}{Q_3} \\right|$$\n安全因子 $F_s$ 考虑了解可能不完全处于渐近区域的情况。当观测到的阶数 $p$ 接近格式的理论阶数时，推荐使用 $F_s = 1.25$；当 $p$ 未能很好地确定或变化显著时，则使用 $F_s=3$。此处给定 $F_s=1.25$。\n\n现在我们使用给定的数据和中间结果计算 $\\text{GCI}_{32}$ 的数值：\n$F_s = 1.25$，$r^p = 8/3$，$Q_2 = 0.138$，$Q_3 = 0.1365$。\n$$\\text{GCI}_{32} = \\frac{1.25}{(8/3) - 1} \\left| \\frac{0.1365 - 0.138}{0.1365} \\right| = \\frac{1.25}{5/3} \\left| \\frac{-0.0015}{0.1365} \\right|$$\n$$\\text{GCI}_{32} = (1.25 \\times \\frac{3}{5}) \\left(\\frac{0.0015}{0.1365}\\right) = 0.75 \\times \\frac{15}{1365} = 0.75 \\times \\frac{1}{91}$$\n计算最终数值：\n$$\\text{GCI}_{32} \\approx 0.00824175824$$\n作为一个无量纲小数，并四舍五入到四位有效数字，我们得到 $\\text{GCI}_{32} \\approx 0.008242$。这个值意味着细网格解 $Q_3$ 的估计不确定性约为 $0.82\\%$。\n\n最终要求的值是 $p$ 和 $\\text{GCI}_{32}$，四舍五入到四位有效数字。\n$p \\approx 1.415$\n$\\text{GCI}_{32} \\approx 0.008242$",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.415  0.008242 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在自适应网格细化（AMR）中，仅仅减小误差是不够的；我们还必须确保细化过程本身尊重控制方程的物理原理。对于守恒律（如欧拉方程），这意味着在网格变化时必须严格保持质量、动量和能量等守恒量。本练习通过一个具体的计算案例，揭示了在网格自适应循环中使用非守恒插值方案所带来的严重后果 ()。通过量化由此产生的质量损失，您将深刻理解为何守恒重映（conservative remap）是任何用于求解守恒律的有效AMR策略中不可或缺的组成部分。",
            "id": "3975819",
            "problem": "考虑计算流体动力学（CFD）中的一维标量平流，其由守恒律 $\\partial q/\\partial t + a\\,\\partial q/\\partial x = 0$ 在域 $x \\in [0,1]$ 上控制，其中 $a>0$。在适当的边界处理下，全局质量 $M(t) = \\int_{0}^{1} q(x,t)\\,dx$ 在平流作用下是不变的。您将通过比较非守恒插值与守恒重映，使用一个标准的标量平流测试场，来检验网格自适应循环对这种不变性的影响。\n\n设初始条件为方帽函数场 $q(x,0) = 1$（当 $x \\in [0.05,0.28]$）且在其他地方 $q(x,0) = 0$。初始计算网格是一个包含 $N_{c} = 4$ 个单元的均匀粗网格，每个单元的宽度为 $h_{c} = 0.25$，单元中心位于 $x_{1} = 0.125$、$x_{2} = 0.375$、$x_{3} = 0.625$ 和 $x_{4} = 0.875$。定义一个自适应循环为：将每个粗网格单元细化为两个相等的细网格单元（每个宽度为 $h_{f} = h_{c}/2$），执行从粗网格表示到细网格表示的网格间插值，然后立即粗化回到原始的粗网格表示，不进行任何时间推进。\n\n使用以下网格间传递规则：\n\n- 非守恒插值：通过在相邻粗网格单元中心之间对 $q$ 进行线性插值，构造一个分段线性函数。在物理边界上，为插值施加狄利克雷值 $q(0) = 0$ 和 $q(1) = 0$。将一个粗网格单元的每个细半单元上的值定义为该线性插值函数在该半单元上的平均积分（即，使用插值函数在每个细半单元上的精确积分）。当粗化回去时，将粗网格单元的值定义为其两个细半单元的平均值（即，细网格表示在粗网格单元上的 $L^{1}$ 平均）。\n\n- 守恒重映：通过将每个粗网格单元的质量精确地细分到其两个细半单元中，从粗网格转移到细网格，使得细半单元质量之和等于原始粗网格单元质量。当粗化回去时，使用两个细半单元的精确平均值，以使粗网格单元质量保持不变。\n\n从守恒的第一性原理出发，计算经过一个自适应循环后，由非守恒插值引入的总质量的带符号分数变化，定义为\n$$\\Delta = \\frac{M_{\\text{after}} - M_{\\text{before}}}{M_{\\text{before}}}.$$\n将您的答案四舍五入到四位有效数字，并以不带单位的小数形式表示。此外，在质量变化方面，将其与守恒重映进行定性比较，但最终答案只提供 $\\Delta$ 的数值。",
            "solution": "问题要求在使用非守恒插值方案的一个网格自适应循环后，总质量的带符号分数变化 $\\Delta$。该循环包括将粗网格细化为细网格，非守恒地传递数据，然后粗化回原始网格。\n\n首先，我们必须确定系统在粗网格上的初始状态。初始条件是一个方帽函数：\n$$q(x,0) = \\begin{cases} 1  \\text{if } x \\in [0.05, 0.28] \\\\ 0  \\text{otherwise} \\end{cases}$$\n系统中的总质量 $M_{\\text{before}}$ 是此函数在域 $x \\in [0, 1]$ 上的积分：\n$$M_{\\text{before}} = \\int_{0}^{1} q(x,0) \\,dx = \\int_{0.05}^{0.28} 1 \\,dx = 0.28 - 0.05 = 0.23$$\n初始计算网格是一个包含 $N_c = 4$ 个单元的均匀粗网格，每个单元的宽度为 $h_c = 0.25$。单元边界位于 $x = \\{0, 0.25, 0.5, 0.75, 1.0\\}$。单元中心位于 $x_1 = 0.125$，$x_2 = 0.375$，$x_3 = 0.625$ 和 $x_4 = 0.875$。\n\n单元 $i$ 的单元平均值，记作 $Q_i$，定义为 $Q_i = \\frac{1}{h_c} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x,0) \\,dx$。\n对于单元 1 ($x \\in [0, 0.25]$)：\n$$Q_1 = \\frac{1}{0.25} \\int_{0}^{0.25} q(x,0) \\,dx = \\frac{1}{0.25} \\int_{0.05}^{0.25} 1 \\,dx = \\frac{0.25 - 0.05}{0.25} = \\frac{0.20}{0.25} = 0.8$$\n对于单元 2 ($x \\in [0.25, 0.5]$)：\n$$Q_2 = \\frac{1}{0.25} \\int_{0.25}^{0.5} q(x,0) \\,dx = \\frac{1}{0.25} \\int_{0.25}^{0.28} 1 \\,dx = \\frac{0.28 - 0.25}{0.25} = \\frac{0.03}{0.25} = 0.12$$\n对于单元 3 ($x \\in [0.5, 0.75]$) 和单元 4 ($x \\in [0.75, 1.0]$)，$q(x,0)$ 的积分为零，所以 $Q_3 = 0$ 且 $Q_4 = 0$。\n初始粗网格表示是单元平均值向量 $Q_c = (0.8, 0.12, 0, 0)$。离散总质量为 $\\sum_{i=1}^{4} Q_i h_c = (0.8 + 0.12 + 0 + 0) \\times 0.25 = 0.92 \\times 0.25 = 0.23$，这与 $M_{\\text{before}}$ 正确匹配。\n\n自适应循环开始于将每个粗网格单元细化为两个宽度为 $h_f = h_c/2 = 0.125$ 的细网格单元。这创建了一个包含 $N_f = 8$ 个单元的细网格。\n接下来，我们执行非守恒插值。构造一个分段线性函数 $q_{PL}(x)$，连接粗网格单元中心的值。问题指定了狄利克雷边界条件 $q(0)=0$ 和 $q(1)=0$。这给了我们以下要连接的点：\n$P_0 = (0, 0)$\n$P_1 = (x_1, Q_1) = (0.125, 0.8)$\n$P_2 = (x_2, Q_2) = (0.375, 0.12)$\n$P_3 = (x_3, Q_3) = (0.625, 0)$\n$P_4 = (x_4, Q_4) = (0.875, 0)$\n$P_5 = (1, 0)$\n\n每个细网格单元中的值 $Q_{f,j}$ 是 $q_{PL}(x)$ 在该细网格单元域上的平均积分。由于 $q_{PL}(x)$ 在每个线段上是线性的，因此在该线段内任何区间上的平均值是函数在该区间端点处值的算术平均值。\n细网格单元索引为 $j=1, \\dots, 8$：\n- **细网格单元 1 和 2 (在粗网格单元 1 内)：** 它们位于线性段 $P_0P_1$ 和 $P_1P_2$ 中。\n  - 细网格单元 1 ($j=1$, $x \\in [0, 0.125]$)：这是线段 $P_0P_1$ 的域。端点处的值为 $q_{PL}(0)=0$ 和 $q_{PL}(0.125)=0.8$。\n    $$Q_{f,1} = \\frac{q_{PL}(0) + q_{PL}(0.125)}{2} = \\frac{0 + 0.8}{2} = 0.4$$\n  - 细网格单元 2 ($j=2$, $x \\in [0.125, 0.25]$)：这是线段 $P_1P_2$ 的一部分。我们需要 $q_{PL}(x)$ 在 $x=0.25$ 处的值。\n    线段 $P_1P_2$ 的斜率为 $m_{12} = \\frac{0.12 - 0.8}{0.375 - 0.125} = \\frac{-0.68}{0.25} = -2.72$。\n    $q_{PL}(0.25) = Q_1 + m_{12}(0.25 - x_1) = 0.8 + (-2.72)(0.25 - 0.125) = 0.8 - 0.34 = 0.46$。\n    端点处的值为 $q_{PL}(0.125)=0.8$ 和 $q_{PL}(0.25)=0.46$。\n    $$Q_{f,2} = \\frac{q_{PL}(0.125) + q_{PL}(0.25)}{2} = \\frac{0.8 + 0.46}{2} = 0.63$$\n- **细网格单元 3 和 4 (在粗网格单元 2 内)：** 它们位于线段 $P_1P_2$ 和 $P_2P_3$ 中。\n  - 细网格单元 3 ($j=3$, $x \\in [0.25, 0.375]$)：这是线段 $P_1P_2$ 的剩余部分。值为 $q_{PL}(0.25)=0.46$ 和 $q_{PL}(0.375)=0.12$。\n    $$Q_{f,3} = \\frac{q_{PL}(0.25) + q_{PL}(0.375)}{2} = \\frac{0.46 + 0.12}{2} = 0.29$$\n  - 细网格单元 4 ($j=4$, $x \\in [0.375, 0.5]$)：这是线段 $P_2P_3$ 的一部分。我们需要 $q_{PL}(0.5)$。\n    线段 $P_2P_3$ 的斜率为 $m_{23} = \\frac{0 - 0.12}{0.625 - 0.375} = \\frac{-0.12}{0.25} = -0.48$。\n    $q_{PL}(0.5) = Q_2 + m_{23}(0.5 - x_2) = 0.12 + (-0.48)(0.5 - 0.375) = 0.12 - 0.06 = 0.06$。\n    值为 $q_{PL}(0.375)=0.12$ 和 $q_{PL}(0.5)=0.06$。\n    $$Q_{f,4} = \\frac{q_{PL}(0.375) + q_{PL}(0.5)}{2} = \\frac{0.12 + 0.06}{2} = 0.09$$\n- **细网格单元 5 和 6 (在粗网格单元 3 内)：** 它们位于线段 $P_2P_3$ 和 $P_3P_4$ 中。\n  - 细网格单元 5 ($j=5$, $x \\in [0.5, 0.625]$)：这是线段 $P_2P_3$ 的剩余部分。值为 $q_{PL}(0.5)=0.06$ 和 $q_{PL}(0.625)=0$。\n    $$Q_{f,5} = \\frac{q_{PL}(0.5) + q_{PL}(0.625)}{2} = \\frac{0.06 + 0}{2} = 0.03$$\n  - 细网格单元 6 ($j=6$, $x \\in [0.625, 0.75]$)：线段 $P_3P_4$ 在直线 $y=0$ 上。所以 $Q_{f,6}=0$。\n- **细网格单元 7 和 8 (在粗网格单元 4 内)：** 线段 $P_3P_4$ 和 $P_4P_5$ 在直线 $y=0$ 上。所以 $Q_{f,7}=0$ 且 $Q_{f,8}=0$。\n\n细网格表示为 $Q_f = (0.4, 0.63, 0.29, 0.09, 0.03, 0, 0, 0)$。\n细网格上的总质量 $M_{\\text{fine}}$ 是每个细网格单元中质量的总和：\n$$M_{\\text{fine}} = \\sum_{j=1}^{8} Q_{f,j} h_f = 0.125 \\times (0.4 + 0.63 + 0.29 + 0.09 + 0.03 + 0 + 0 + 0) = 0.125 \\times 1.44 = 0.18$$\n这个插值步骤是非守恒的，因为 $M_{\\text{fine}} = 0.18 \\neq M_{\\text{before}} = 0.23$。\n\n该循环的最后一步是粗化回原始网格。新的粗网格单元值 $Q'_i$ 是其两个组成细网格单元值的平均值。\n$Q'_1 = \\frac{Q_{f,1} + Q_{f,2}}{2} = \\frac{0.4 + 0.63}{2} = 0.515$\n$Q'_2 = \\frac{Q_{f,3} + Q_{f,4}}{2} = \\frac{0.29 + 0.09}{2} = 0.19$\n$Q'_3 = \\frac{Q_{f,5} + Q_{f,6}}{2} = \\frac{0.03 + 0}{2} = 0.015$\n$Q'_4 = \\frac{Q_{f,7} + Q_{f,8}}{2} = \\frac{0 + 0}{2} = 0$\n最终的粗网格表示为 $Q'_c = (0.515, 0.19, 0.015, 0)$。\n循环后的总质量 $M_{\\text{after}}$ 是：\n$$M_{\\text{after}} = \\sum_{i=1}^{4} Q'_i h_c = 0.25 \\times (0.515 + 0.19 + 0.015 + 0) = 0.25 \\times 0.72 = 0.18$$\n正如预期的那样，粗化步骤（简单的平均）相对于细网格表示是守恒的，所以 $M_{\\text{after}} = M_{\\text{fine}}$。\n\n最后，我们计算总质量的带符号分数变化 $\\Delta$：\n$$\\Delta = \\frac{M_{\\text{after}} - M_{\\text{before}}}{M_{\\text{before}}} = \\frac{0.18 - 0.23}{0.23} = \\frac{-0.05}{0.23} \\approx -0.2173913...$$\n四舍五入到四位有效数字，我们得到 $\\Delta \\approx -0.2174$。\n\n为了进行定性比较，守恒重映旨在防止这种质量变化。在守恒方案中，每个粗网格单元中的总质量将被精确地分配给其子细网格单元，在细化过程中保持质量守恒。同样，粗化过程会汇总子单元的质量，也保持质量守恒。因此，对于守恒重映，$M_{\\text{after}} = M_{\\text{before}}$，分数变化 $\\Delta$ 将恰好为 $0$。相比之下，非守恒线性插值造成了超过 $21\\%$ 的质量损失。",
            "answer": "$$\\boxed{-0.2174}$$"
        },
        {
            "introduction": "掌握了验证方法和守恒的重要性之后，我们便可以将注意力转向效率问题：如何以最小的计算成本达到目标精度？网格细化主要有两种途径：通过减小单元尺寸（$h$-细化）或通过提高近似多项式的阶数（$p$-细化）。本练习将对比这两种基本策略在求解一个光滑流场问题时的性能 ()。通过建立误差和计算成本的模型，您将进行一次成本效益分析，从而揭示高阶方法在特定情况下的巨大潜力，并学会如何为特定问题选择最优的细化路径。",
            "id": "3975808",
            "problem": "考虑一个二维等熵涡，使用高阶间断伽辽金 (DG) 方法求解可压缩欧拉方程，该涡在边长为 $L=1$ 的方形域上以恒定速度对流。初始均匀网格使用 $N_{x}=N_{y}=16$ 个张量积四边形单元，基础单元尺寸为 $h_{0}=L/N_{x}=0.0625$，共有 $N_{0}=N_{x}N_{y}=256$ 个单元。解在所有时间内都是光滑且解析的。您将比较两种加密策略，以在固定的结束时间 $T=1$ 内达到目标时空 $L^{2}$ 误差容限 $e_{\\mathrm{tol}}=10^{-6}$：\n\n- 策略 $\\mathrm{(p)}$：在保持 $h=h_{0}$ 不变的情况下，均匀增加多项式阶数 $p$。\n- 策略 $\\mathrm{(h)}$：在保持 $p=p_{f}$ 固定的情况下，将每个单元均匀地分裂为四个子单元，共进行 $L$ 次（在每一层级的每个坐标方向上二等分）。\n\n对于双曲系统上的显式 DG 方法，假设存在以下经过充分检验的建模关系：\n- 对于光滑解析解，在固定 $h$ 的情况下进行 p-加密，$L^{2}$ 误差随 $p$呈指数衰减：$e_{p}(p)=\\alpha\\,\\exp(-\\beta p)$，其中 $\\alpha=2.0\\times 10^{-2}$，$\\beta=0.9$。\n- 对于固定 $p_{f}$ 的情况进行 h-加密，$L^{2}$ 误差随 $h$呈代数衰减：$e_{h}(h)=\\eta\\,h^{p_{f}+1}$，其中 $\\eta=5.0$，$p_{f}=2$。\n- 稳定时间步长满足 Courant–Friedrichs–Lewy (CFL) 关系 $\\Delta t=\\mathrm{CFL}\\,\\dfrac{h}{a\\,(p+1)^{2}}$，其中对流速度 $a=1$，$\\mathrm{CFL}=0.5$，因此达到时间 $T$ 所需的时间步数为 $n_{t}=\\dfrac{T}{\\Delta t}=\\dfrac{a\\,T\\,(p+1)^{2}}{\\mathrm{CFL}\\,h}$。\n- 每个单元在每个时间步内的浮点运算量按 $c_{e}(p)=\\gamma\\,(p+1)^{3}$ 比例缩放，其中 $\\gamma=2.0\\times 10^{5}$。\n- 对于四边形上的张量积 DG 基，每个单元的自由度 (DoF) 为 $N_{e}(p)=(p+1)^{2}\\,m$，其中 $m=4$ 是可压缩欧拉方程中守恒变量的数量。\n\n在 h-加密策略中，$L$ 层均匀分裂得到 $h=h_{0}/2^{L}$ 和 $N=N_{0}\\,4^{L}$ 个单元。在 p-加密策略中，$h=h_{0}$ 且 $N=N_{0}$。\n\n任务：\n1. 使用误差模型，确定策略 $\\mathrm{(p)}$ 中为确保 $e_{p}(p)\\leq e_{\\mathrm{tol}}$ 所需的最小整数多项式阶数 $p$，以及策略 $\\mathrm{(h)}$ 中为确保 $e_{h}(h)\\leq e_{\\mathrm{tol}}$ 所需的最小整数加密层级 $L$。\n2. 对于每种策略，在其满足任务1的最小配置下，计算：\n   - 总自由度数 $N_{\\mathrm{DoF}}=N\\,N_{e}(p)$。\n   - 时间步数 $n_{t}$。\n   - 将解推进到时间 $T$ 所需的总浮点运算次数，定义为 $W=N\\,n_{t}\\,c_{e}(p)$。\n   - 每自由度的运算量 $w_{\\mathrm{DoF}}=W/N_{\\mathrm{DoF}}$。\n3. 选择以最小总计算成本 $W$ 达到目标精度的策略，并报告该最小总成本。\n\n将最终的最小计算成本以 $10^{9}$ 次浮点运算 (FLOPs) 为单位表示。将您的答案四舍五入到四位有效数字。",
            "solution": "首先对用户提供的问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n问题提供了以下数据、定义和模型：\n- 区域：方形，边长 $L=1$。\n- 初始网格：$N_{x}=N_{y}=16$ 个四边形单元。\n- 初始单元数：$N_{0}=N_{x}N_{y}=256$。\n- 基础单元尺寸：$h_{0}=L/N_{x}=1/16=0.0625$。\n- 控制方程：可压缩欧拉方程。\n- 流动特性：等熵涡，光滑且解析的解。\n- 数值方法：间断伽辽金 (DG)。\n- 模拟结束时间：$T=1$。\n- 目标误差容限：$e_{\\mathrm{tol}}=10^{-6}$。\n\n**策略 $\\mathrm{(p)}$ (p-加密):**\n- 多项式阶数 $p$ 增加。\n- 网格尺寸：$h=h_{0}$ (恒定)。\n- 单元数：$N=N_{0}$ (恒定)。\n- 误差模型：$e_{p}(p)=\\alpha\\,\\exp(-\\beta p)$，其中 $\\alpha=2.0\\times 10^{-2}$，$\\beta=0.9$。\n\n**策略 $\\mathrm{(h)}$ (h-加密):**\n- 多项式阶数：$p=p_{f}=2$ (固定)。\n- 均匀加密层级：$L$。\n- 网格尺寸：$h=h_{0}/2^{L}$。\n- 单元数：$N=N_{0}\\,4^{L}$。\n- 误差模型：$e_{h}(h)=\\eta\\,h^{p_{f}+1}$，其中 $\\eta=5.0$。\n\n**通用模型：**\n- 稳定时间步长：$\\Delta t=\\mathrm{CFL}\\,\\dfrac{h}{a\\,(p+1)^{2}}$。\n- 常数：$\\mathrm{CFL}=0.5$，对流速度 $a=1$。\n- 时间步数：$n_{t}=\\dfrac{T}{\\Delta t}=\\dfrac{a\\,T\\,(p+1)^{2}}{\\mathrm{CFL}\\,h}$。\n- 每单元每步运算量：$c_{e}(p)=\\gamma\\,(p+1)^{3}$，其中 $\\gamma=2.0\\times 10^{5}$。\n- 每单元自由度 (DoF)：$N_{e}(p)=(p+1)^{2}\\,m$，其中 $m=4$。\n\n**任务：**\n1. 确定策略 $\\mathrm{(p)}$ 满足误差容限所需的最小整数 $p$ 和策略 $\\mathrm{(h)}$ 所需的最小整数 $L$。\n2. 对每种策略，计算总自由度 ($N_{\\mathrm{DoF}}$)、时间步数 ($n_{t}$)、总运算量 ($W$) 和每自由度运算量 ($w_{\\mathrm{DoF}}$)。\n3. 选择总运算量 $W$ 最小的策略，并以 $10^9$ FLOPs 为单位报告该值，四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题是偏微分方程数值分析中的一个标准练习，特别是在计算流体动力学领域。对于 p-加密（光滑解呈指数衰减）和 h-加密（代数衰减，速率为 $p+1$）的误差衰减模型，在 DG 方法中已有理论依据。计算成本的缩放比例和 CFL 条件也代表了显式 DG 格式的典型特征。该问题在科学上是合理的。\n- **适定性：** 提供了所有必要的参数和方程。任务定义明确，并可根据所提供的模型得出唯一的一组结果。\n- **客观性：** 问题以精确、定量的术语陈述，没有主观性语言。\n- **完整性与一致性：** 问题是自洽的，没有矛盾。给定的值是一致的（例如，$h_{0} = 1/16 = 0.0625$）。\n- **现实性：** 该设置描述了一个常见的基准问题（对流涡），模型参数对于此类模拟是合理的。\n\n### 步骤 3：结论与行动\n该问题是有效的，因为它具有科学依据、适定、客观且内部一致。我们可以继续进行求解。\n\n### 任务 1：确定最小加密参数\n**策略 $\\mathrm{(p)}$：最小多项式阶数 $p$**\n我们必须找到满足 $e_{p}(p) \\leq e_{\\mathrm{tol}}$ 的最小整数 $p$。\n$$ \\alpha\\,\\exp(-\\beta p) \\leq e_{\\mathrm{tol}} $$\n代入给定值：\n$$ (2.0 \\times 10^{-2}) \\exp(-0.9 p) \\leq 10^{-6} $$\n$$ \\exp(-0.9 p) \\leq \\frac{10^{-6}}{2.0 \\times 10^{-2}} = 5.0 \\times 10^{-5} $$\n对两边取自然对数：\n$$ -0.9 p \\leq \\ln(5.0 \\times 10^{-5}) $$\n$$ p \\geq -\\frac{\\ln(5.0 \\times 10^{-5})}{0.9} $$\n使用 $\\ln(5.0 \\times 10^{-5}) \\approx -9.9034875$：\n$$ p \\geq -\\frac{-9.9034875}{0.9} \\approx 11.003875 $$\n由于 $p$ 必须是整数，所需的最小多项式阶数为 $p_{\\min}=12$。\n\n**策略 $\\mathrm{(h)}$：最小加密层级 $L$**\n我们必须找到满足 $e_{h}(h) \\leq e_{\\mathrm{tol}}$ 的最小整数 $L$。多项式阶数固定为 $p_f=2$。单元尺寸为 $h = h_0 / 2^L$。\n$$ \\eta\\,h^{p_{f}+1} \\leq e_{\\mathrm{tol}} $$\n代入给定值：\n$$ 5.0\\,h^{2+1} \\leq 10^{-6} $$\n$$ h^{3} \\leq \\frac{10^{-6}}{5.0} = 2.0 \\times 10^{-7} $$\n$$ h \\leq (2.0 \\times 10^{-7})^{1/3} \\approx 0.005848 \\; \\mathrm{m} $$\n现在，我们将其与加密层级 $L$ 联系起来：\n$$ \\frac{h_{0}}{2^{L}} \\leq 0.005848 $$\n$$ \\frac{0.0625}{2^{L}} \\leq 0.005848 $$\n$$ 2^{L} \\geq \\frac{0.0625}{0.005848} \\approx 10.6875 $$\n我们必须找到满足此条件的最小整数 $L$。对于 $L=3$，$2^3=8$，不满足条件。对于 $L=4$，$2^4=16$，满足条件。因此，所需的最小加密层级为 $L_{\\min}=4$。\n\n### 任务 2：计算性能指标\n**策略 $\\mathrm{(p)}$，$p=12$**\n- 参数：$p=12$, $h=h_{0}=0.0625$, $N=N_{0}=256$。\n- 总自由度：$N_{\\mathrm{DoF}, p} = N\\,N_{e}(p) = N_{0}(p+1)^{2}m = 256(12+1)^{2}(4) = 1024(13)^{2} = 1024(169) = 173056$。\n- 时间步数：$n_{t, p} = \\dfrac{a\\,T\\,(p+1)^{2}}{\\mathrm{CFL}\\,h} = \\dfrac{(1)(1)(12+1)^{2}}{(0.5)(0.0625)} = \\dfrac{169}{0.03125} = 5408$。\n- 总运算量：$W_{p} = N\\,n_{t, p}\\,c_{e}(p) = N_{0}\\,n_{t, p}\\,\\gamma(p+1)^{3} = 256(5408)(2.0 \\times 10^{5})(12+1)^{3} = 256(5408)(2.0 \\times 10^{5})(2197)$。\n$W_{p} = 6.083264512 \\times 10^{14}$ FLOPs。\n- 每自由度运算量：$w_{\\mathrm{DoF}, p} = W_{p} / N_{\\mathrm{DoF}, p} = \\dfrac{6.08326 \\times 10^{14}}{173056} \\approx 3.5152 \\times 10^{9}$ FLOPs/DoF。\n\n**策略 $\\mathrm{(h)}$，$L=4$**\n- 参数：$p=p_{f}=2$, $L=4$。\n- 单元数：$N = N_{0}\\,4^{L} = 256 \\cdot 4^4 = 256 \\cdot 256 = 65536$。\n- 单元尺寸：$h = h_{0}/2^{L} = 0.0625/2^4 = 0.0625/16 = 0.00390625$。\n- 总自由度：$N_{\\mathrm{DoF}, h} = N\\,N_{e}(p_{f}) = N(p_f+1)^{2}m = 65536(2+1)^{2}(4) = 65536(9)(4) = 2359296$。\n- 时间步数：$n_{t, h} = \\dfrac{a\\,T\\,(p_f+1)^{2}}{\\mathrm{CFL}\\,h} = \\dfrac{(1)(1)(2+1)^{2}}{(0.5)(0.00390625)} = \\dfrac{9}{0.001953125} = 4608$。\n- 总运算量：$W_{h} = N\\,n_{t, h}\\,c_{e}(p_f) = N\\,n_{t, h}\\,\\gamma(p_f+1)^{3} = 65536(4608)(2.0 \\times 10^{5})(2+1)^{3} = 65536(4608)(2.0 \\times 10^{5})(27)$。\n$W_{h} = 1.6307453952 \\times 10^{15}$ FLOPs。\n- 每自由度运算量：$w_{\\mathrm{DoF}, h} = W_{h} / N_{\\mathrm{DoF}, h} = \\dfrac{1.63075 \\times 10^{15}}{2359296} \\approx 6.912 \\times 10^{8}$ FLOPs/DoF。\n\n### 任务 3：选择成本最低的策略\n为找到最高效的策略，我们比较总计算成本 $W_{p}$ 和 $W_{h}$。\n$$ W_{p} \\approx 6.083 \\times 10^{14} \\text{ FLOPs} $$\n$$ W_{h} \\approx 1.631 \\times 10^{15} \\text{ FLOPs} $$\n由于 $W_{p} < W_{h}$，对于这个光滑问题，p-加密策略在达到所需精度方面的计算成本更低，这与高阶方法的理论相符。\n\n最小总成本为 $W_{\\min} = W_{p} = 6.083264512 \\times 10^{14}$ FLOPs。\n问题要求将此成本以 $10^9$ FLOPs (GFLOPs) 为单位表示，并四舍五入到四位有效数字。\n$$ \\text{以 GFLOPs 为单位的成本} = \\frac{W_{\\min}}{10^9} = \\frac{6.083264512 \\times 10^{14}}{10^9} = 6.083264512 \\times 10^{5} $$\n该值为 $608326.4512$。四舍五入到四位有效数字得到 $608300$，即 $6.083 \\times 10^5$。",
            "answer": "$$\\boxed{6.083 \\times 10^{5}}$$"
        }
    ]
}