{
    "hands_on_practices": [
        {
            "introduction": "To master refinement techniques, we must first understand the errors they are designed to control. This practice delves into the fundamental error characteristics of numerical schemes by analyzing the simplest non-trivial case: the linear advection equation. By performing a Fourier analysis, you will derive the analytical expressions for numerical dispersion and dissipation, gaining a concrete understanding of how a scheme can alter a wave's speed and amplitude as a function of its wavelength and the mesh properties.",
            "id": "3964562",
            "problem": "Consider the one-dimensional linear advection equation in a periodic domain,\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,\n$$\nwhere $a>0$ is a constant advection speed. The equation is discretized in space using a spectral element formulation on a uniform mesh of elements of size $h$, where within each element a polynomial of degree $p$ is used. For inter-element coupling, use an upwind numerical flux. To connect with Fourier analysis of wave propagation, assume the solution is represented on the element grid by modal values at element centers.\n\nSpecialize the analysis to the piecewise-constant case $p=0$ (which is the lowest-order spectral element or discontinuous Galerkin approximation) with uniform element size $h$ and upwind numerical flux. In this case, the semi-discrete scheme for a positive advection speed $a$ can be written for element-indexed values $u_j(t)$ at positions $x_j = j h$ as\n$$\n\\frac{d u_j}{d t} = -\\frac{a}{h} \\left( u_j - u_{j-1} \\right).\n$$\nPerform a Fourier or von Neumann analysis by considering a discrete Fourier mode $u_j(t) = \\hat{u}(t) \\exp(i k x_j)$ with wavenumber $k$, and derive the semi-discrete dispersion relation. From this dispersion relation, define:\n- the numerical phase speed $c_{\\mathrm{num}}(k)$ via $-\\Im(\\lambda(k)) = c_{\\mathrm{num}}(k)\\,k$, where $\\lambda(k)$ is the eigenvalue of the semi-discrete operator acting on the Fourier mode, and\n- the numerical dissipation rate $d_{\\mathrm{num}}(k)$ via $d_{\\mathrm{num}}(k) = -\\Re(\\lambda(k))$.\n\nCompute these dispersion and dissipation characteristics as explicit functions of the element size $h$ and the wavenumber $k$. Then interpret the trade-off between $h$-refinement (reducing $h$) and $p$-refinement (increasing $p$) by discussing how the leading-order dispersion and dissipation behaviors change with $p$ for small nondimensional wavenumber $k h$.\n\nYour final answer must be a single closed-form analytical expression for the ratio of the numerical phase speed to the exact phase speed, $c_{\\mathrm{num}}(k)/a$, expressed as a function of the nondimensional quantity $k h$. No numerical evaluation is required. Do not include units in the final answer. All angles are dimensionless in this context. If you make any small-$k h$ expansions during your reasoning, keep constants in symbolic form and avoid numerical substitution unless absolutely necessary for clarity. The final boxed answer must be the requested ratio in exact analytic form.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n-   **Governing Equation**: The one-dimensional linear advection equation is $\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$, with a constant advection speed $a>0$.\n-   **Domain**: Periodic.\n-   **Discretization Method**: A spectral element formulation with polynomials of degree $p$ on a uniform mesh of elements of size $h$.\n-   **Inter-element Flux**: Upwind numerical flux.\n-   **Special Case for Analysis**: Piecewise-constant approximation ($p=0$) with uniform element size $h$.\n-   **Semi-discrete Scheme**: For element-indexed values $u_j(t)$ at positions $x_j = j h$, the scheme is given as $\\frac{d u_j}{d t} = -\\frac{a}{h} \\left( u_j - u_{j-1} \\right)$.\n-   **Analysis Method**: Fourier or von Neumann analysis using a discrete Fourier mode $u_j(t) = \\hat{u}(t) \\exp(i k x_j)$ with wavenumber $k$.\n-   **Definitions**:\n    -   $\\lambda(k)$ is the eigenvalue of the semi-discrete operator acting on the Fourier mode.\n    -   Numerical phase speed $c_{\\mathrm{num}}(k)$ is defined by $-\\Im(\\lambda(k)) = c_{\\mathrm{num}}(k)\\,k$.\n    -   Numerical dissipation rate $d_{\\mathrm{num}}(k)$ is defined by $d_{\\mathrm{num}}(k) = -\\Re(\\lambda(k))$.\n-   **Task**:\n    1.  Compute $c_{\\mathrm{num}}(k)$ and $d_{\\mathrm{num}}(k)$ as explicit functions of $h$ and $k$.\n    2.  Interpret the trade-off between $h$-refinement and $p$-refinement by discussing leading-order dispersion and dissipation for small $kh$.\n    3.  The final answer must be the ratio $c_{\\mathrm{num}}(k)/a$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is a standard, fundamental exercise in the numerical analysis of partial differential equations, specifically analyzing the properties of the first-order upwind scheme for the linear advection equation. It is firmly based on established mathematical principles.\n-   **Well-Posed**: The problem is clearly stated, providing the exact semi-discrete equation to be analyzed and unambiguous definitions for the quantities to be derived. A unique solution exists.\n-   **Objective**: The language is precise, technical, and free of any subjectivity or ambiguity.\n-   **Completeness**: All necessary information (the semi-discrete equation, the Fourier mode form, and definitions) is provided.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, objective, and self-contained. A full solution will be provided.\n\nThe analysis begins with the given semi-discrete equation for the element-averaged value $u_j(t)$:\n$$\n\\frac{d u_j}{d t} = -\\frac{a}{h} \\left( u_j - u_{j-1} \\right)\n$$\nWe perform a von Neumann stability analysis by substituting the discrete Fourier mode, $u_j(t) = \\hat{u}(t) \\exp(i k x_j)$, where $x_j = j h$. The temporal derivative on the left-hand side becomes:\n$$\n\\frac{d}{dt} \\left( \\hat{u}(t) \\exp(i k j h) \\right) = \\frac{d\\hat{u}}{dt} \\exp(i k j h)\n$$\nThe right-hand side becomes:\n$$\n-\\frac{a}{h} \\left( \\hat{u}(t) \\exp(i k j h) - \\hat{u}(t) \\exp(i k (j-1) h) \\right)\n$$\nEquating the two sides and dividing by the common factor $\\exp(i k j h)$ yields an ordinary differential equation for the modal amplitude $\\hat{u}(t)$:\n$$\n\\frac{d\\hat{u}}{dt} = -\\frac{a}{h} \\left( \\hat{u}(t) - \\hat{u}(t) \\exp(-i k h) \\right) = \\left[ -\\frac{a}{h} \\left( 1 - \\exp(-i k h) \\right) \\right] \\hat{u}(t)\n$$\nThis equation is of the form $\\frac{d\\hat{u}}{dt} = \\lambda(k) \\hat{u}$. The eigenvalue $\\lambda(k)$ of the semi-discrete operator is therefore:\n$$\n\\lambda(k) = -\\frac{a}{h} \\left( 1 - \\exp(-i k h) \\right)\n$$\nTo find the real and imaginary parts of $\\lambda(k)$, we use Euler's formula, $\\exp(-i\\theta) = \\cos(\\theta) - i\\sin(\\theta)$:\n$$\n\\lambda(k) = -\\frac{a}{h} \\left( 1 - (\\cos(kh) - i\\sin(kh)) \\right) = -\\frac{a}{h} (1 - \\cos(kh)) - i \\frac{a}{h} \\sin(kh)\n$$\nFrom this, we identify the real and imaginary parts:\n$$\n\\Re(\\lambda(k)) = -\\frac{a}{h} (1 - \\cos(kh))\n$$\n$$\n\\Im(\\lambda(k)) = -\\frac{a}{h} \\sin(kh)\n$$\nUsing the definitions provided in the problem, we can now compute the numerical dissipation rate and phase speed. The numerical dissipation rate $d_{\\mathrm{num}}(k)$ is:\n$$\nd_{\\mathrm{num}}(k) = -\\Re(\\lambda(k)) = - \\left( -\\frac{a}{h} (1 - \\cos(kh)) \\right) = \\frac{a}{h} (1 - \\cos(kh))\n$$\nThe numerical phase speed $c_{\\mathrm{num}}(k)$ is defined by the relation $-\\Im(\\lambda(k)) = c_{\\mathrm{num}}(k)\\,k$. Substituting the expression for $\\Im(\\lambda(k))$:\n$$\n- \\left( -\\frac{a}{h} \\sin(kh) \\right) = c_{\\mathrm{num}}(k)\\,k\n$$\n$$\n\\frac{a}{h} \\sin(kh) = c_{\\mathrm{num}}(k)\\,k\n$$\nSolving for $c_{\\mathrm{num}}(k)$ gives:\n$$\nc_{\\mathrm{num}}(k) = \\frac{a \\sin(kh)}{kh}\n$$\nThe exact phase speed for the continuous advection equation $\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$ is the constant $a$. The ratio of the numerical phase speed to the exact phase speed is therefore:\n$$\n\\frac{c_{\\mathrm{num}}(k)}{a} = \\frac{\\frac{a \\sin(kh)}{kh}}{a} = \\frac{\\sin(kh)}{kh}\n$$\nThis provides the required analytical expression.\n\nFor the interpretation of the h-p tradeoff, we analyze the behavior of the derived quantities for small nondimensional wavenumbers $kh \\ll 1$. We use Taylor series expansions for $\\sin(x)$ and $\\cos(x)$:\nFor the phase speed ratio:\n$$\n\\frac{c_{\\mathrm{num}}(k)}{a} = \\frac{kh - \\frac{(kh)^3}{3!} + O((kh)^5)}{kh} = 1 - \\frac{(kh)^2}{6} + O((kh)^4)\n$$\nThe numerical dispersion error, $c_{\\mathrm{num}}(k) - a$, is approximately $-a \\frac{(kh)^2}{6}$. This error is of order $O(h^2)$ and causes waves to travel slower than the exact speed, a phenomenon known as phase lag.\nFor the dissipation rate:\n$$\nd_{\\mathrm{num}}(k) = \\frac{a}{h} \\left( 1 - \\left[1 - \\frac{(kh)^2}{2!} + O((kh)^4)\\right] \\right) = \\frac{a}{h} \\left( \\frac{k^2 h^2}{2} - O(k^4 h^4) \\right) = \\frac{ak^2h}{2} + O(h^3)\n$$\nThe numerical dissipation is of order $O(h)$. Since the leading error term for the scheme is the $O(h)$ dissipative term, the $p=0$ scheme (first-order upwind) is first-order accurate.\n\nThe trade-off between $h$-refinement and $p$-refinement can be interpreted by generalizing from this $p=0$ case.\n1.  **Order of Accuracy**: For a general discontinuous Galerkin or spectral element scheme of polynomial order $p$, the overall order of accuracy is $p+1$. For the analyzed case, $p=0$, the scheme is first-order accurate, which is consistent. Increasing $p$ to $p=1$ (linear elements) yields a second-order scheme, and so on.\n2.  **Convergence**:\n    -   **$h$-refinement**: For a fixed polynomial order $p$, reducing the element size $h$ reduces the numerical error. The error converges to zero algebraically, proportional to $h^{p+1}$. This is a robust but potentially slow way to improve accuracy.\n    -   **$p$-refinement**: For a fixed mesh (fixed $h$), increasing the polynomial order $p$ also reduces the error. For problems with smooth solutions, this convergence is exponential, meaning the error decreases much more rapidly than with $h$-refinement. This makes $p$-refinement highly efficient for such problems.\n3.  **Error Character**: A crucial aspect of the trade-off is the nature of the leading error term, which alternates with $p$ for upwind-flux-based schemes.\n    -   For even $p$ (e.g., $p=0, 2, ...$), the leading error term is dissipative (proportional to an even derivative, like $\\frac{\\partial^2 u}{\\partial x^2}$ for $p=0$). These schemes numerically damp waves, particularly high-frequency ones, which can smear sharp gradients but prevent spurious oscillations.\n    -   For odd $p$ (e.g., $p=1, 3, ...$), the leading error term is dispersive (proportional to an odd derivative, like $\\frac{\\partial^3 u}{\\partial x^3}$ for $p=1$). These schemes do not add numerical damping at the leading order and are better at preserving wave amplitudes, but they can introduce non-physical oscillations (Gibbs phenomena) near discontinuities or sharp gradients.\n\nIn summary, $h$-refinement offers predictable algebraic error reduction, while $p$-refinement offers much faster exponential convergence for smooth solutions. The choice between them involves a trade-off between convergence rate and the character of the numerical error (dissipative vs. dispersive), which changes with the polynomial order $p$.",
            "answer": "$$\n\\boxed{\\frac{\\sin(kh)}{kh}}\n$$"
        },
        {
            "introduction": "Theoretical error estimates are indispensable, but a CFD practitioner must also be able to verify them empirically. This exercise simulates a common scenario in code verification: analyzing data from a numerical experiment to determine the actual convergence rates of a high-order method. By interpreting log-log plots of error versus mesh size ($h$) and semi-log plots of error versus polynomial degree ($p$), you will learn to confirm expected convergence behavior and diagnose common issues like error saturation or contamination from other numerical processes.",
            "id": "3964568",
            "problem": "A research group in Aerospace Computational Fluid Dynamics (CFD) is verifying a high-order Galerkin Finite Element Method (FEM) implementation for a two-dimensional compressible laminar flow using the Method of Manufactured Solutions (MMS), with a smooth manufactured solution $u(\\mathbf{x})$ known analytically. They measure the global $L^2$ error $||e|| = \\left( \\int_{\\Omega} |u - u_h|^2 \\, d\\Omega \\right)^{1/2}$ for two refinement studies:\n\n(1) $h$-refinement at fixed polynomial degree $p = 2$: three quasi-uniform meshes with characteristic sizes $h_1 = 0.2$, $h_2 = 0.1$, $h_3 = 0.05$ yield measured $L^2$ errors $E_1 = 1.60 \\times 10^{-3}$, $E_2 = 2.00 \\times 10^{-4}$, $E_3 = 3.20 \\times 10^{-5}$.\n\n(2) $p$-refinement at fixed mesh $h = 0.05$: four polynomial degrees $p_1 = 1$, $p_2 = 2$, $p_3 = 3$, $p_4 = 4$ yield measured $L^2$ errors $E_{p_1} = 4.00 \\times 10^{-3}$, $E_{p_2} = 1.20 \\times 10^{-3}$, $E_{p_3} = 3.90 \\times 10^{-4}$, $E_{p_4} = 2.80 \\times 10^{-4}$. Immediately prior to the final $p$-refinement point, the mesh was moved (an $r$-refinement step) to cluster nodes in a boundary layer, and the solution was conservatively remapped from the old to the new mesh using linear interpolation.\n\nThe group computes empirical convergence rates by least-squares fitting $y = \\log ||e||$ versus $x = \\log h$ for the $h$-refinement, and $y = \\log ||e||$ versus $x = p$ for the $p$-refinement. Based on these procedures and the fundamental error-behavior facts for smooth manufactured solutions and high-order Galerkin FEMs, choose all correct statements:\n\nA. The least-squares slope of $y$ versus $x = \\log h$ for the $h$-refinement data is approximately $2.82$, which is close to the ideal $p+1$ rate for $p = 2$; the sub-asymptotic deficit is plausibly explained by an $h$-independent transfer error that becomes non-negligible on the finest mesh.\n\nB. The least-squares slope of $y$ versus $x = \\log h$ is approximately $2.00$, proving the quadratic polynomial degree $p = 2$ produces only second-order accuracy in the $L^2$ norm.\n\nC. The least-squares slope of $y$ versus $x = p$ is approximately $-0.91$, which indicates algebraic $p$-convergence of order $O(p^{-0.91})$; the slight degradation from ideal behavior is solely due to round-off error.\n\nD. The deviation of the $p = 4$ point from the $p$-refinement trend is plausibly explained by conservative remapping during $r$-refinement, which injects an $h$-independent transfer error that contaminates the subsequent $p$-refinement assessment unless transfer is disabled.\n\nE. Using $\\log_{10}$ instead of the natural logarithm for the fits changes the slopes and invalidates the rate interpretation, because the log base affects the estimated exponent.\n\nSelect all that apply.",
            "solution": "This problem requires analyzing two sets of numerical error data to assess convergence behavior and diagnose potential issues. The problem is well-posed and scientifically sound, based on standard code verification practices.\n\n### Fundamental Principles\n- **$h$-refinement Convergence**: For a smooth solution, a Galerkin Finite Element Method with polynomials of degree $p$ is expected to have an $L^2$ error that converges as $O(h^{p+1})$. On a log-log plot of error versus $h$, this corresponds to a straight line with a slope of $p+1$.\n- **$p$-refinement Convergence**: For a smooth solution, $p$-refinement should yield exponential convergence, where the error behaves as $O(\\exp(-cp))$ for some constant $c>0$. On a semi-log plot of error versus $p$, this corresponds to a straight line with a negative slope.\n- **Error Contamination**: The total measured error is the sum of various error sources, including discretization error, geometry error, quadrature error, and transfer/interpolation error from mesh changes. If one source of error does not decrease as fast as the discretization error during refinement, it can become dominant and cause the observed convergence rate to \"saturate\" or stall.\n\n### Option-by-Option Analysis\n\n**A. The least-squares slope of $y$ versus $x = \\log h$ for the $h$-refinement data is approximately $2.82$, which is close to the ideal $p+1$ rate for $p = 2$; the sub-asymptotic deficit is plausibly explained by an $h$-independent transfer error that becomes non-negligible on the finest mesh.**\n\nFirst, we calculate the observed order of convergence between successive points.\n- Between $h_1=0.2$ and $h_2=0.1$: Rate = $\\log(E_1/E_2) / \\log(h_1/h_2) = \\log(1.60\\text{e-}3 / 2.00\\text{e-}4) / \\log(0.2/0.1) = \\log(8) / \\log(2) = 3.0$.\n- Between $h_2=0.1$ and $h_3=0.05$: Rate = $\\log(E_2/E_3) / \\log(h_2/h_3) = \\log(2.00\\text{e-}4 / 3.20\\text{e-}5) / \\log(0.1/0.05) = \\log(6.25) / \\log(2) \\approx 2.64$.\nThe ideal convergence rate for $p=2$ is $p+1 = 3$. The rate is initially ideal but then degrades. A least-squares fit over all three points will yield a slope between 2.64 and 3.0 (the value 2.82 is a reasonable result of such a fit). The drop in the convergence rate on the finest mesh is a classic sign of the error approaching an \"error floor\" from another source that doesn't decrease with $h$ (or decreases more slowly). An $h$-independent transfer error from a previous step (as mentioned in the $p$-refinement setup) is a plausible cause for such a floor. Therefore, this statement is **Correct**.\n\n**B. The least-squares slope of $y$ versus $x = \\log h$ is approximately $2.00$, proving the quadratic polynomial degree $p = 2$ produces only second-order accuracy in the $L^2$ norm.**\n\nAs calculated above, the observed rate is close to 3, not 2. A rate of 2.0 would be expected for $p=1$, not $p=2$. This statement is factually incorrect based on the data. Therefore, this statement is **Incorrect**.\n\n**C. The least-squares slope of $y$ versus $x = p$ is approximately $-0.91$, which indicates algebraic $p$-convergence of order $O(p^{-0.91})$; the slight degradation from ideal behavior is solely due to round-off error.**\n\nThis statement has two major flaws. First, a linear fit of $\\log(||e||)$ versus $p$ is used to measure *exponential* convergence, not algebraic. The slope of such a fit is related to the constant in the exponent, not the power of an algebraic decay. Second, the data shows a significant stall at $p=4$ ($E_{p_3} = 3.9\\text{e-}4$, $E_{p_4} = 2.8\\text{e-}4$). This is far too large to be round-off error, which typically occurs at machine precision levels (e.g., $10^{-15}$). The true cause is the error contamination from the linear interpolation used in the remapping step, as described in the problem statement. Therefore, this statement is **Incorrect**.\n\n**D. The deviation of the $p = 4$ point from the $p$-refinement trend is plausibly explained by conservative remapping during $r$-refinement, which injects an $h$-independent transfer error that contaminates the subsequent $p$-refinement assessment unless transfer is disabled.**\n\nThe $p$-refinement study shows the error decreasing rapidly from $p=1$ to $p=3$, consistent with exponential convergence. However, from $p=3$ to $p=4$, the error reduction is minimal. The problem states that a solution was remapped using linear interpolation. Linear interpolation has an error that scales as $O(h^2)$. Since the $p$-refinement study is done on a fixed mesh ($h=0.05$), this remapping introduces an error that is independent of $p$. As $p$ increases, the discretization error from the FEM solver drops exponentially, and eventually, the total error becomes dominated by the constant transfer error from the remapping. This perfectly explains the observed error saturation. Therefore, this statement is **Correct**.\n\n**E. Using $\\log_{10}$ instead of the natural logarithm for the fits changes the slopes and invalidates the rate interpretation, because the log base affects the estimated exponent.**\n\nFor a log-log plot (used for $h$-refinement), the slope is independent of the logarithm base. This is because $\\log_b(x) = \\ln(x) / \\ln(b)$. The slope is $\\Delta(\\log_b y) / \\Delta(\\log_b x) = [\\Delta(\\ln y)/\\ln b] / [\\Delta(\\ln x)/\\ln b] = \\Delta(\\ln y) / \\Delta(\\ln x)$. For a semi-log plot (used for $p$-refinement), the slope does change with the base, but the interpretation is not invalidated; one can still determine if the convergence is exponential and can recover the rate with the correct scaling factor. The fundamental conclusion about the type of convergence is unchanged. Therefore, this statement is **Incorrect**.\n\n### Conclusion\nStatements A and D provide correct and plausible interpretations of the provided data based on standard principles of numerical analysis and code verification.",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "The pursuit of accuracy through mesh refinement does not come for free; it has profound implications for computational cost, largely driven by stability constraints. This practice explores the direct link between spatial discretization choices and the stability of explicit time-marching schemes, governed by the Courant–Friedrichs–Lewy (CFL) condition. By deriving and applying the CFL constraint for a high-order method, you will quantify how both $h$-refinement and $p$-refinement can severely restrict the stable time step, reinforcing the fundamental trade-offs in designing an efficient and accurate simulation strategy.",
            "id": "3964587",
            "problem": "Consider the inviscid compressible Euler equations governing the conservation of mass, momentum, and energy in a gas, written in conservation form as $\\partial_{t} \\mathbf{U} + \\nabla \\cdot \\mathbf{F}(\\mathbf{U}) = \\mathbf{0}$, where $\\mathbf{U}$ denotes the vector of conserved variables and $\\mathbf{F}(\\mathbf{U})$ denotes the corresponding flux tensor. Let the equations be discretized in space using a high-order discontinuous polynomial approximation of degree $p$ on each element $K$ of a conforming mesh, and assume an explicit Runge–Kutta time integration scheme with stability limit characterized by a positive constant $C$. For each element $K$, define the characteristic mesh size $h_{K}$, and let the maximum characteristic wave speed of the hyperbolic system be denoted by $\\lambda_{\\max,K}$, defined by the maximum over directions of the absolute value of the eigenvalues of the flux Jacobian projected along a unit normal. The Courant–Friedrichs–Lewy (CFL) condition for stability of explicit time-marching requires the discrete numerical domain of dependence to contain the partial differential equation domain of dependence.\n\nTask 1: Starting from the linearized hyperbolic character of the Euler equations and using a standard inverse estimate for polynomials of degree $p$ on element $K$, together with the requirement that the stability region of the explicit time integrator bounds the spectral radius of the semi-discrete spatial operator, derive a sufficient stability constraint on the time step of the form $\\Delta t \\le C \\min_{K} \\frac{h_{K}}{(2p+1)\\lambda_{\\max,K}}$. Clearly state the assumptions that lead to the factor $(2p+1)$ and the appearance of $\\lambda_{\\max,K}$.\n\nTask 2: Consider a two-dimensional uniform flow of air with velocity magnitude $|u| = 200$ m/s at temperature $T = 300$ K. Assume a calorically perfect gas with ratio of specific heats $\\gamma = 1.4$ and specific gas constant $R = 287$ J/(kg·K), so that the sound speed is $c = \\sqrt{\\gamma R T}$. For the compressible Euler system, take the maximum characteristic speed on each element as $\\lambda_{\\max,K} = |u| + c$. On a triangular mesh, three representative elements have sizes $h_{K_{1}} = 0.010$ m, $h_{K_{2}} = 0.008$ m, and $h_{K_{3}} = 0.012$ m. Let the polynomial degree be $p = 3$ and the explicit Runge–Kutta stability constant be $C = 0.5$. Compute the largest globally stable time step $\\Delta t_{\\max}$ implied by the derived constraint. Express the final time step in microseconds and round your answer to four significant figures.\n\nTask 3: Briefly explain, based on the derived constraint, how $h$-refinement (decreasing $h_{K}$) and $p$-refinement (increasing $p$) jointly restrict the allowable time step in compressible Computational Fluid Dynamics (CFD), and qualitatively comment on how $r$-refinement (mesh movement) can indirectly influence the bound through changes in local $h_{K}$ and directional wave speeds.",
            "solution": "This problem is addressed in three parts: a theoretical derivation of a stability constraint, a numerical application of this constraint, and a conceptual discussion of mesh refinement strategies.\n\n**Task 1: Derivation of the Stability Constraint**\n\nWe begin with the semi-discretized form of the governing partial differential equation, which can be written as a system of ordinary differential equations (ODEs) in time:\n$$\n\\frac{d\\mathbf{U}_h}{dt} = \\mathcal{L}_h(\\mathbf{U}_h)\n$$\nwhere $\\mathbf{U}_h$ is the vector of all discrete degrees of freedom for the polynomial solution on the mesh, and $\\mathcal{L}_h$ is the semi-discrete spatial operator representing the discontinuous Galerkin (DG) approximation to $-\\nabla \\cdot \\mathbf{F}$.\n\nFor an explicit time integration scheme, such as a Runge-Kutta method, stability requires that the time step $\\Delta t$ scaled by the spectral radius $\\rho(\\mathcal{L}_h)$ of the spatial operator lies within the stability region of the ODE solver. For hyperbolic problems, the eigenvalues of $\\mathcal{L}_h$ are predominantly imaginary. The stability condition can be expressed as:\n$$\n\\Delta t \\cdot \\rho(\\mathcal{L}_h) \\le C\n$$\nwhere $C$ is a constant that depends on the extent of the stability region of the chosen explicit Runge-Kutta scheme along the imaginary axis. Rearranging this gives a constraint on the time step:\n$$\n\\Delta t \\le \\frac{C}{\\rho(\\mathcal{L}_h)}\n$$\nThe global spatial operator $\\mathcal{L}_h$ couples all elements in the mesh. Its spectral radius is determined by the \"most restrictive\" element, i.e., the element that imposes the tightest constraint. Therefore, we can bound the global spectral radius by the maximum of the local spectral radii, and the stability constraint becomes a minimum over all elements $K$:\n$$\n\\Delta t \\le C \\min_{K} \\frac{1}{\\rho(\\mathcal{L}_{h,K})}\n$$\nwhere $\\rho(\\mathcal{L}_{h,K})$ is the spectral radius of the operator associated with element $K$.\n\nThe next step is to estimate $\\rho(\\mathcal{L}_{h,K})$. For the nonlinear Euler equations, we perform a local linearization. On each element $K$, the behavior of the system is governed by the eigenvalues of the flux Jacobians. The maximum characteristic wave speed, $\\lambda_{\\max,K}$, represents the fastest speed at which information can propagate locally. The spectral radius of the spatial operator on an element is directly proportional to this wave speed and inversely proportional to the characteristic size of the element, $h_K$. The polynomial degree $p$ of the approximation also enters the relation.\n\nA critical step is to determine the dependence on $p$. The spatial operator involves derivatives of the polynomial basis functions. An inverse estimate for polynomials of degree $p$ on an element $K$ relates the norm of a polynomial's derivative to the norm of the polynomial itself, and it introduces a dependence on $p$ and $h_K$. A typical inverse inequality states that for a polynomial $v_p \\in P^p(K)$, $\\|\\nabla v_p\\|_{L^2(K)} \\le C_{inv} h_K^{-1} \\|v_p\\|_{L^2(K)}$, where the constant $C_{inv}$ scales as $p^2$. This suggests that the spectral radius should scale as $\\rho(\\mathcal{L}_{h,K}) \\propto \\frac{\\lambda_{\\max,K} p^2}{h_K}$.\n\nHowever, the problem requires deriving a form with a $(2p+1)$ factor. This specific factor arises from a more detailed spectral analysis of the DG operator for a one-dimensional linear advection equation, $u_t + \\lambda u_x = 0$, when an upwind numerical flux is used at the element interfaces. This analysis, often performed via Fourier methods or by examining the explicit matrix form of the operator using a Legendre polynomial basis, yields the following precise result for the spectral radius:\n$$\n\\rho(\\mathcal{L}_{h,K}) = \\frac{(2p+1)\\lambda}{h_K}\n$$\nThe primary assumptions leading to this form are:\n1.  **Linearization**: The nonlinear system is analyzed locally as a linear advection problem, where $\\lambda$ is replaced by the maximum characteristic wave speed $\\lambda_{\\max,K}$, which is the maximum absolute value of the eigenvalues of the flux Jacobian, maximized over all spatial directions.\n2.  **Upwind Flux**: An upwind numerical flux is used to compute the flux at element interfaces. Different flux formulations (e.g., central flux) lead to different spectral radii and thus different stability constraints.\n3.  **One-Dimensional Model**: The analysis is based on a one-dimensional model problem, and the result is generalized to multiple dimensions by using the minimum element size $h_K$ and the maximum wave speed $\\lambda_{\\max,K}$ across the entire mesh, representing a worst-case scenario.\n\nSubstituting this expression for the spectral radius into the stability condition gives the desired result:\n$$\n\\Delta t \\le C \\min_{K} \\frac{h_{K}}{(2p+1)\\lambda_{\\max,K}}\n$$\nThis is a sufficient condition for stability.\n\n**Task 2: Calculation of the Maximum Stable Time Step**\n\nFirst, we calculate the physical properties of the gas. The speed of sound $c$ is given by:\n$$\nc = \\sqrt{\\gamma R T}\n$$\nSubstituting the given values:\n$$\nc = \\sqrt{1.4 \\times 287 \\frac{\\text{J}}{\\text{kg·K}} \\times 300 \\text{ K}} = \\sqrt{120540} \\frac{\\text{m}}{\\text{s}} \\approx 347.1887 \\frac{\\text{m}}{\\text{s}}\n$$\nNext, we calculate the maximum characteristic wave speed, which for this problem is assumed to be constant across the domain:\n$$\n\\lambda_{\\max,K} = \\lambda_{\\max} = |u| + c = 200 \\frac{\\text{m}}{\\text{s}} + 347.1887 \\frac{\\text{m}}{\\text{s}} = 547.1887 \\frac{\\text{m}}{\\text{s}}\n$$\nThe stability constraint is $\\Delta t \\le C \\min_{K} \\frac{h_{K}}{(2p+1)\\lambda_{\\max}}$. The largest globally stable time step, $\\Delta t_{\\max}$, is achieved when equality holds for the most restrictive element. This corresponds to the minimum value of $h_K$.\n$$\nh_{\\min} = \\min(h_{K_{1}}, h_{K_{2}}, h_{K_{3}}) = \\min(0.010 \\text{ m}, 0.008 \\text{ m}, 0.012 \\text{ m}) = 0.008 \\text{ m}\n$$\nThe polynomial degree is $p=3$, so the factor $(2p+1)$ is:\n$$\n2p+1 = 2(3)+1 = 7\n$$\nThe stability constant is given as $C=0.5$. We can now compute $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = C \\frac{h_{\\min}}{(2p+1)\\lambda_{\\max}} = 0.5 \\times \\frac{0.008 \\text{ m}}{7 \\times 547.1887 \\frac{\\text{m}}{\\text{s}}}\n$$\n$$\n\\Delta t_{\\max} = \\frac{0.004}{3830.3209} \\text{ s} \\approx 1.044298 \\times 10^{-6} \\text{ s}\n$$\nThe problem requires the answer in microseconds ($\\mu$s), where $1 \\text{ s} = 10^6 \\mu\\text{s}$.\n$$\n\\Delta t_{\\max} \\approx 1.044298 \\mu\\text{s}\n$$\nRounding to four significant figures, we get:\n$$\n\\Delta t_{\\max} = 1.044 \\mu\\text{s}\n$$\n\n**Task 3: Explanation of Refinement Strategies**\n\nThe derived stability constraint, $\\Delta t \\le C \\min_{K} \\frac{h_{K}}{(2p+1)\\lambda_{\\max,K}}$, clearly shows how different mesh refinement strategies impact the allowable time step for explicit methods.\n\n**$h$-refinement**: This strategy involves reducing the element size $h_K$ to increase spatial resolution, particularly in regions with high solution gradients. According to the formula, the maximum allowable time step $\\Delta t$ is directly proportional to $h_K$. Therefore, decreasing $h_K$ (i.e., refining the mesh) directly leads to a smaller permissible $\\Delta t$. This linear dependence means that doubling the mesh resolution in each direction (halving $h_K$) requires halving the time step to maintain stability, significantly increasing the total number of time steps required to simulate a given physical time.\n\n**$p$-refinement**: This strategy involves increasing the polynomial degree $p$ within elements to achieve higher-order accuracy. The formula shows that $\\Delta t$ is inversely proportional to the factor $(2p+1)$. As $p$ increases, $(2p+1)$ increases, causing the allowable $\\Delta t$ to decrease. While not as severe as the $p^2$ scaling suggested by basic inverse estimates, this still imposes a significant penalty. For example, moving from $p=1$ to $p=3$ reduces the time step by a factor of $(2 \\cdot 1+1)/(2 \\cdot 3+1) = 3/7$. Thus, achieving higher accuracy via $p$-refinement also comes at the cost of a reduced stable time step. Jointly, $h$- and $p$-refinement severely constrain $\\Delta t$, making explicit schemes computationally expensive for high-fidelity simulations.\n\n**$r$-refinement**: This strategy involves repositioning mesh vertices (mesh movement) without changing the number of elements or their connectivity. Its influence on the time step is indirect but significant, acting through the term $\\min_{K} \\frac{h_{K}}{\\lambda_{\\max,K}}$. An effective $r$-refinement algorithm moves nodes to regions where higher resolution is needed. This might mean decreasing $h_K$ in some areas (e.g., near shocks or boundary layers), which would tend to lower the global $\\Delta t$. However, a sophisticated $r$-refinement strategy can also optimize element shapes and sizes. For example, it might aim to equilibrate a local error indicator across the mesh. Since the time step constraint is often related to local error, such a strategy can be designed to make the quantity $\\frac{h_{K}}{(2p+1)\\lambda_{\\max,K}}$ more uniform across all elements. By doing so, it raises the minimum value of this term compared to a fixed mesh with a similar number of elements, thereby maximizing the global stable time step $\\Delta t$ for a given overall accuracy. Furthermore, by stretching elements to align with anisotropic flow features, $r$-refinement can change the local characteristic length scale $h_K$ and how it relates to the directional wave speeds that contribute to $\\lambda_{\\max,K}$, further influencing the stability bound.",
            "answer": "$$\\boxed{1.044}$$"
        }
    ]
}