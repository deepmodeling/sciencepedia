{
    "hands_on_practices": [
        {
            "introduction": "标准的中心差分格式虽然在处理扩散主导问题时表现良好，但在对流主导的流动中常常会引入非物理的数值振荡。本练习将引导你使用泰勒级数展开进行修正方程分析，揭示离散格式实际求解的“修正方程”。通过这个过程，你将能够识别出导致非物理行为的误差项，从而深刻理解为何需要引入稳定化方法。",
            "id": "3999758",
            "problem": "在高雷诺数的航空航天计算流体动力学 (CFD) 中，沿流线的对流主导输运可以局部地由稳态一维对流扩散方程来建模：\n$$\na\\,\\frac{du}{dx} - \\nu\\,\\frac{d^{2}u}{dx^{2}} = 0,\n$$\n其中 $a0$ 是恒定对流速度，$\\nu0$ 是运动粘度。考虑一个间距为 $h0$ 的均匀网格，以及在节点 $x_i$ 处的标准二阶中心差分离散格式，\n$$\n\\mathcal{L}_h[u]_i \\equiv a\\,\\frac{u_{i+1}-u_{i-1}}{2h} \\;-\\; \\nu\\,\\frac{u_{i+1}-2u_i+u_{i-1}}{h^{2}} \\;=\\; 0,\n$$\n其中 $u_i \\approx u(x_i)$。通过将 $u_{i\\pm 1}$ 的泰勒展开式代入 $\\mathcal{L}_h[u]_i$ 并收集直至 $h^{2}$ 阶的项，使用 $u(x)$ 在 $x_i$ 点的泰勒级数展开来构建网格函数所满足的形式化修正微分方程。将修正方程写成以下典范形式：\n$$\na\\,\\frac{du}{dx} \\;-\\; \\nu\\,\\frac{d^{2}u}{dx^{2}} \\;+\\; C_{\\text{disp}}\\,\\frac{d^{3}u}{dx^{3}} \\;+\\; C_{\\text{diss}}\\,\\frac{d^{4}u}{dx^{4}} \\;=\\; 0 \\;+\\; \\mathcal{O}(h^{4}),\n$$\n其中 $C_{\\text{disp}}$ 和 $C_{\\text{diss}}$ 分别是主阶色散和耗散误差系数。在此对流扩散算子的背景下，奇数阶导数修正项被识别为色散项，偶数阶导数修正项被识别为耗散项。该分析强调了在对流主导区域中使用流线迎风/彼得罗夫-伽辽金 (SUPG) 稳定化的必要性。\n\n请以 $a$、$\\nu$ 和 $h$ 的闭式解析表达式形式给出有序对 $\\left(C_{\\text{disp}},\\,C_{\\text{diss}}\\right)$。不需要数值近似，也不需要四舍五入。将最终答案表示为行矩阵 $\\begin{pmatrix} C_{\\text{disp}}  C_{\\text{diss}} \\end{pmatrix}$。",
            "solution": "用户要求我确定一维稳态对流扩散方程的标准中心差分离散格式的主阶色散和耗散误差系数。这可以通过推导修正微分方程来实现。\n\n问题陈述提供了一维稳态对流扩散方程：\n$$\na\\,\\frac{du}{dx} - \\nu\\,\\frac{d^{2}u}{dx^{2}} = 0\n$$\n其中 $a0$ 是恒定对流速度，$\\nu0$ 是运动粘度。\n\n在间距为 $h$ 的均匀网格上，节点 $x_i$ 处的给定二阶中心差分离散格式为：\n$$\n\\mathcal{L}_h[u]_i \\equiv a\\,\\frac{u_{i+1}-u_{i-1}}{2h} \\;-\\; \\nu\\,\\frac{u_{i+1}-2u_i+u_{i-1}}{h^{2}} \\;=\\; 0\n$$\n其中 $u_i$ 是 $u(x_i)$ 的数值近似。\n\n为了找到修正微分方程，我们对网格函数值 $u_{i+1}$ 和 $u_{i-1}$ 在点 $x_i$ 周围进行泰勒级数展开。$u(x_{i \\pm 1}) = u(x_i \\pm h)$ 的展开式为：\n$$\nu_{i+1} = u(x_i+h) = u_i + h\\frac{du}{dx} + \\frac{h^2}{2!}\\frac{d^2u}{dx^2} + \\frac{h^3}{3!}\\frac{d^3u}{dx^3} + \\frac{h^4}{4!}\\frac{d^4u}{dx^4} + \\frac{h^5}{5!}\\frac{d^5u}{dx^5} + \\mathcal{O}(h^6)\n$$\n$$\nu_{i-1} = u(x_i-h) = u_i - h\\frac{du}{dx} + \\frac{h^2}{2!}\\frac{d^2u}{dx^2} - \\frac{h^3}{3!}\\frac{d^3u}{dx^3} + \\frac{h^4}{4!}\\frac{d^4u}{dx^4} - \\frac{h^5}{5!}\\frac{d^5u}{dx^5} + \\mathcal{O}(h^6)\n$$\n所有导数均在 $x=x_i$ 处求值。\n\n首先，我们分析离散对流项，它使用中心差分来近似一阶导数。我们求出 $u_{i+1}-u_{i-1}$ 的表达式：\n$$\nu_{i+1} - u_{i-1} = \\left(u_i + h\\frac{du}{dx} + \\frac{h^2}{2}\\frac{d^2u}{dx^2} + \\frac{h^3}{6}\\frac{d^3u}{dx^3} + \\dots\\right) - \\left(u_i - h\\frac{du}{dx} + \\frac{h^2}{2}\\frac{d^2u}{dx^2} - \\frac{h^3}{6}\\frac{d^3u}{dx^3} + \\dots\\right)\n$$\n$$\nu_{i+1} - u_{i-1} = 2h\\frac{du}{dx} + 2\\frac{h^3}{6}\\frac{d^3u}{dx^3} + \\mathcal{O}(h^5) = 2h\\frac{du}{dx} + \\frac{h^3}{3}\\frac{d^3u}{dx^3} + \\mathcal{O}(h^5)\n$$\n两边除以 $2h$，我们得到离散一阶导数算子的泰勒级数：\n$$\n\\frac{u_{i+1}-u_{i-1}}{2h} = \\frac{du}{dx} + \\frac{h^2}{6}\\frac{d^3u}{dx^3} + \\mathcal{O}(h^4)\n$$\n\n接下来，我们分析离散扩散项，它使用中心差分来近似二阶导数。我们首先通过对 $u_{i+1}$ 和 $u_{i-1}$求和来找到 $u_{i+1}-2u_i+u_{i-1}$ 的表达式：\n$$\nu_{i+1} + u_{i-1} = \\left(u_i + h\\frac{du}{dx} + \\frac{h^2}{2}\\frac{d^2u}{dx^2} + \\dots\\right) + \\left(u_i - h\\frac{du}{dx} + \\frac{h^2}{2}\\frac{d^2u}{dx^2} - \\dots\\right)\n$$\n$$\nu_{i+1} + u_{i-1} = 2u_i + 2\\frac{h^2}{2}\\frac{d^2u}{dx^2} + 2\\frac{h^4}{24}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^6) = 2u_i + h^2\\frac{d^2u}{dx^2} + \\frac{h^4}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^6)\n$$\n从这个和中减去 $2u_i$ 得到：\n$$\nu_{i+1}-2u_i+u_{i-1} = h^2\\frac{d^2u}{dx^2} + \\frac{h^4}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^6)\n$$\n两边除以 $h^2$，我们得到离散二阶导数算子的泰勒级数：\n$$\n\\frac{u_{i+1}-2u_i+u_{i-1}}{h^2} = \\frac{d^2u}{dx^2} + \\frac{h^2}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^4)\n$$\n\n现在，我们将这些展开式代回到离散方程 $\\mathcal{L}_h[u]_i = 0$ 中：\n$$\na\\left(\\frac{du}{dx} + \\frac{h^2}{6}\\frac{d^3u}{dx^3} + \\mathcal{O}(h^4)\\right) - \\nu\\left(\\frac{d^2u}{dx^2} + \\frac{h^2}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^4)\\right) = 0\n$$\n展开并合并同类项，得到修正微分方程：\n$$\na\\frac{du}{dx} - \\nu\\frac{d^2u}{dx^2} + a\\frac{h^2}{6}\\frac{d^3u}{dx^3} - \\nu\\frac{h^2}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^4) = 0\n$$\n问题将该方程的典范形式指定为：\n$$\na\\,\\frac{du}{dx} \\;-\\; \\nu\\,\\frac{d^{2}u}{dx^{2}} \\;+\\; C_{\\text{disp}}\\,\\frac{d^{3}u}{dx^{3}} \\;+\\; C_{\\text{diss}}\\,\\frac{d^{4}u}{dx^{4}} \\;=\\; 0 \\;+\\; \\mathcal{O}(h^{4})\n$$\n通过将推导出的修正方程与典范形式进行比较，我们可以确定系数 $C_{\\text{disp}}$ 和 $C_{\\text{diss}}$。\n\n三阶导数项 $\\frac{d^3u}{dx^3}$ 的系数是主阶色散误差系数：\n$$\nC_{\\text{disp}} = a\\frac{h^2}{6}\n$$\n四阶导数项 $\\frac{d^4u}{dx^4}$ 的系数是主阶耗散误差系数：\n$$\nC_{\\text{diss}} = -\\nu\\frac{h^2}{12}\n$$\n因此，有序对为 $\\left(a\\frac{h^2}{6}, -\\nu\\frac{h^2}{12}\\right)$。这必须以行矩阵的形式提供。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{ah^{2}}{6}  -\\frac{\\nu h^{2}}{12}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "SUPG方法通过增加一个基于方程残差的稳定项来修正数值误差。本练习将分步指导你推导在二维问题中，这个稳定项在单元层面的具体形式。掌握这个推导是理解并能在有限元程序中实现SUPG方法的基石，同时也能让你了解如何在实际工程问题中考虑数值积分的精度要求。",
            "id": "3999763",
            "problem": "考虑在有界域 $\\Omega \\subset \\mathbb{R}^{2}$（其边界为 $\\partial \\Omega$）上，一个被输运的标量场 $\\phi$ 的稳态二维对流-扩散方程，\n$$\n\\boldsymbol{u} \\cdot \\nabla \\phi - \\nabla \\cdot \\left( \\kappa \\nabla \\phi \\right) = 0 \\quad \\text{in} \\ \\Omega,\n$$\n其中速度 $\\boldsymbol{u} = \\left( u_{x}, u_{y} \\right)$ 和扩散系数 $\\kappa  0$ 均为常数。假设在边界 $\\partial \\Omega$ 上为齐次狄利克雷边界条件。设 $\\{ N_{i} \\}_{i=1}^{3}$ 表示单个三角形有限元 $\\Omega_{e}$ 上的标准线性形函数，该单元的节点位于 $(0,0)$、$(L,0)$ 和 $(0,H)$，其中 $L0$ 且 $H0$，面积为 $A = \\frac{L H}{2}$。\n\n流线迎风/彼得罗夫-伽辽金 (SUPG) 方法是一种基于残差的稳定化技术。在 SUPG 格式中，通过一个稳定化参数 $\\tau  0$ 沿着流线方向进行方向加权，从而丰富了检验空间，这为代数系统矩阵产生了一个额外的单元级贡献，该贡献取决于控制微分算子的残差。\n\n从强形式和加权残差法原理出发，利用有限元插值和积分的基本定义，在上述假设下，推导此线性三角形单元的单元级 SUPG 贡献矩阵 $K^{\\mathrm{SUPG}} \\in \\mathbb{R}^{3 \\times 3}$。你的推导必须从控制方程和残差的定义开始，通过带有 SUPG 检验函数扩充的弱形式进行，并明确使用 $\\Omega_{e}$ 上线性形函数的性质。\n\n然后，确定在以下条件下，为精确积分 SUPG 残差项，基于三角形的数值积分法则所需的最小多项式精确度要求：\n- 常系数（$\\boldsymbol{u}$ 和 $\\kappa$ 为常数），\n- $\\Omega_{e}$ 内线性变化的系数（即 $\\boldsymbol{u}$ 和 $\\kappa$ 在 $x$ 和 $y$ 方向上至多呈线性变化）。\n\n最后，对于节点位于 $(0,0)$、$(L,0)$、$(0,H)$ 且 $\\boldsymbol{u}$ 和 $\\kappa$ 如上所述为常数的特定单元，计算 $K^{\\mathrm{SUPG}}$ 的 Frobenius 范数的平方，其定义为\n$$\n\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} \\left( K^{\\mathrm{SUPG}}_{ij} \\right)^{2},\n$$\n并将其表示为关于 $\\tau$、$L$、$H$、$u_{x}$ 和 $u_{y}$ 的单一闭式解析表达式。你的最终答案应为这个单一的解析表达式。不需要进行数值计算，最终答案中也不应包含物理单位。",
            "solution": "首先根据既定准则对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 控制方程：稳态二维对流-扩散方程，$\\boldsymbol{u} \\cdot \\nabla \\phi - \\nabla \\cdot \\left( \\kappa \\nabla \\phi \\right) = 0$，在有界域 $\\Omega \\subset \\mathbb{R}^{2}$ 中。\n- 系数：速度 $\\boldsymbol{u} = (u_x, u_y)$ 为常数，扩散系数 $\\kappa  0$ 为常数。\n- 边界条件：在 $\\partial \\Omega$ 上为齐次狄利克雷边界条件。\n- 有限元：单个线性三角形单元 $\\Omega_e$，节点位于 $(0,0)$、$(L,0)$ 和 $(0,H)$，其中 $L0$ 且 $H0$。单元面积为 $A = \\frac{LH}{2}$。\n- 形函数：$\\{N_i\\}_{i=1}^3$ 是该三角形单元的标准线性形函数。\n- 数值方法：流线迎风/彼得罗夫-伽辽金 (SUPG) 方法，稳定化参数为 $\\tau  0$。\n- 任务：\n  1. 推导单元级 SUPG 贡献矩阵 $K^{\\mathrm{SUPG}} \\in \\mathbb{R}^{3 \\times 3}$。\n  2. 确定两种情况下数值积分的最小多项式精确度：(a) 常系数，(b) 线性变化的系数。\n  3. 对于常系数情况，计算 Frobenius 范数的平方 $\\| K^{\\mathrm{SUPG}} \\|_{F}^{2}$，并表示为关于 $\\tau$、$L$、$H$、$u_x$ 和 $u_y$ 的闭式表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学性：** 该问题是计算流体力学（CFD）领域中有限元法（FEM）的一个标准推导。对流-扩散方程、线性三角形单元和 SUPG 方法都是基本概念。该问题在科学上是合理的。\n- **适定性：** 这些任务是基于所提供的先验信息进行的清晰定义的数学推导。问题的所有部分都存在唯一的解析解。\n- **客观性：** 语言是形式化、精确且标准的数学和工程用语，不含任何主观性。\n- **完整性与一致性：** 提供了所有必要信息（控制方程、单元几何、基函数、方法定义）。信息之间没有矛盾。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整解答。\n\n### 推导与求解\n\n解答按照问题陈述的要求分为三个部分。\n\n**第 1 部分：SUPG 贡献矩阵 $K^{\\mathrm{SUPG}}$ 的推导**\n\n稳态对流-扩散方程的强形式为：\n$$\n\\mathcal{L}(\\phi) \\equiv \\boldsymbol{u} \\cdot \\nabla \\phi - \\nabla \\cdot (\\kappa \\nabla \\phi) = 0\n$$\n在有限元法中，单元 $\\Omega_e$ 内的未知场 $\\phi$ 通过 $\\phi_h = \\sum_{j=1}^{3} \\phi_j N_j(x,y)$ 进行近似，其中 $\\phi_j$ 是节点值，$N_j$ 是线性形函数。此近似下方程的残差为 $R(\\phi_h) = \\mathcal{L}(\\phi_h)$。\n\n标准 Galerkin 方法对检验函数 $w_h$ 和试探函数 $\\phi_h$ 使用相同的空间。SUPG 方法修改了检验函数，以在流线方向引入人工扩散。对应于节点 $i$ 的 SUPG 检验函数 $w_i^{\\mathrm{SUPG}}$ 为：\n$$\nw_i^{\\mathrm{SUPG}} = N_i + \\tau (\\boldsymbol{u} \\cdot \\nabla N_i)\n$$\n其中 $N_i$ 是标准 Galerkin 检验函数，第二项是 Petrov-Galerkin 附加项，$\\tau$ 是稳定化参数。\n\nSUPG 方法在单元 $\\Omega_e$ 上的弱形式为：\n$$\n\\int_{\\Omega_e} w_i^{\\mathrm{SUPG}} R(\\phi_h) d\\Omega = 0 \\quad \\text{for } i=1,2,3\n$$\n代入 $w_i^{\\mathrm{SUPG}}$ 和 $R(\\phi_h)$ 的表达式：\n$$\n\\int_{\\Omega_e} (N_i + \\tau (\\boldsymbol{u} \\cdot \\nabla N_i)) (\\boldsymbol{u} \\cdot \\nabla \\phi_h - \\nabla \\cdot (\\kappa \\nabla \\phi_h)) d\\Omega = 0\n$$\n这可以分解为标准 Galerkin 部分和 SUPG 贡献部分：\n$$\n\\int_{\\Omega_e} N_i R(\\phi_h) d\\Omega + \\int_{\\Omega_e} \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) R(\\phi_h) d\\Omega = 0\n$$\n对单元刚度矩阵的 SUPG 贡献 $K^{\\mathrm{SUPG}}$ 来自第二项。我们来分析线性单元的残差项 $R(\\phi_h)$。近似为 $\\phi_h = \\sum_{j=1}^{3} \\phi_j N_j$。对于节点为 $1:(0,0)$、$2:(L,0)$、$3:(0,H)$ 的指定三角形，其形函数为：\n$$\nN_1(x,y) = 1 - \\frac{x}{L} - \\frac{y}{H}, \\quad N_2(x,y) = \\frac{x}{L}, \\quad N_3(x,y) = \\frac{y}{H}\n$$\n它们的梯度是常向量：\n$$\n\\nabla N_1 = \\begin{pmatrix} -1/L \\\\ -1/H \\end{pmatrix}, \\quad \\nabla N_2 = \\begin{pmatrix} 1/L \\\\ 0 \\end{pmatrix}, \\quad \\nabla N_3 = \\begin{pmatrix} 0 \\\\ 1/H \\end{pmatrix}\n$$\n任何线性形函数的拉普拉斯算子都是 $\\nabla^2 N_j = \\nabla \\cdot (\\nabla N_j) = 0$，因为其梯度是常数。在扩散系数 $\\kappa$ 为常数的情况下，残差的扩散部分变为：\n$$\n\\nabla \\cdot (\\kappa \\nabla \\phi_h) = \\kappa \\nabla^2 \\phi_h = \\kappa \\sum_{j=1}^{3} \\phi_j \\nabla^2 N_j = 0\n$$\n因此，对于线性单元和常系数，残差简化为对流部分：\n$$\nR(\\phi_h) = \\boldsymbol{u} \\cdot \\nabla \\phi_h = \\boldsymbol{u} \\cdot \\sum_{j=1}^{3} \\phi_j \\nabla N_j = \\sum_{j=1}^{3} \\phi_j (\\boldsymbol{u} \\cdot \\nabla N_j)\n$$\n对第 $i$ 个方程的弱形式的 SUPG 贡献为：\n$$\n\\int_{\\Omega_e} \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) \\left( \\sum_{j=1}^{3} \\phi_j (\\boldsymbol{u} \\cdot \\nabla N_j) \\right) d\\Omega = \\sum_{j=1}^{3} \\phi_j \\left[ \\int_{\\Omega_e} \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j) d\\Omega \\right]\n$$\n方括号中的项是 SUPG 贡献矩阵 $K^{\\mathrm{SUPG}}$ 的第 $(i,j)$ 个元 $K^{\\mathrm{SUPG}}_{ij}$：\n$$\nK^{\\mathrm{SUPG}}_{ij} = \\int_{\\Omega_e} \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j) d\\Omega\n$$\n由于 $\\boldsymbol{u}$、$\\tau$ 是常数，$\\nabla N_i$ 是常向量，因此被积函数在单元 $\\Omega_e$ 上是常数。积分就是被积函数乘以单元面积 $A$：\n$$\nK^{\\mathrm{SUPG}}_{ij} = \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j) \\int_{\\Omega_e} d\\Omega = \\tau A (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j)\n$$\n这就是 SUPG 贡献矩阵各项的所求表达式。\n\n**第 2 部分：积分精确度要求**\n\n我们需要确定 SUPG 项被积函数的多项式次数，这决定了数值积分法则要精确积分该项所需的精度。被积函数为 $I_{ij} = \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) R(\\phi_h, N_j)$，其中 $R(\\phi_h, N_j) = \\boldsymbol{u} \\cdot \\nabla N_j - \\nabla \\cdot (\\kappa \\nabla N_j)$。形函数 $N_i$ 是线性的（1 次多项式），所以它们的梯度 $\\nabla N_i$ 是常数（0 次多项式）。\n\n- **情况 1：常系数**\n  $\\boldsymbol{u}$、$\\kappa$ 和 $\\tau$ 是常数（0 次）。\n  - 项 $\\boldsymbol{u} \\cdot \\nabla N_i$ 是常数的乘积，因此是常数（0 次）。\n  - 项 $\\boldsymbol{u} \\cdot \\nabla N_j$ 也是常数（0 次）。\n  - 项 $\\nabla \\cdot (\\kappa \\nabla N_j) = \\kappa \\nabla^2 N_j = 0$，如前所述。\n  - 被积函数 $I_{ij} = \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j)$ 是常数的乘积，所以它是一个常数（0 次多项式）。\n  - 因此，为了精确积分 SUPG 项，数值积分法则必须对 0 次多项式精确。单点积分法则就足够了。\n\n- **情况 2：线性变化的系数**\n  $\\boldsymbol{u}$ 和 $\\kappa$ 在单元上呈线性变化（1 次多项式）。我们假设 $\\tau$ 在单元上为常数（例如，在形心处取值），这是标准做法。\n  - 项 $\\boldsymbol{u} \\cdot \\nabla N_i$ 是一个线性函数 $\\boldsymbol{u}(x,y)$ 和一个常向量 $\\nabla N_i$ 的乘积。结果是一个线性多项式（1 次）。\n  - 类似地，$\\boldsymbol{u} \\cdot \\nabla N_j$ 是一个线性多项式（1 次）。\n  - 考虑项 $\\nabla \\cdot (\\kappa \\nabla N_j)$。$\\nabla N_j$ 是一个常向量，比如说 $\\boldsymbol{c}_j = (c_{jx}, c_{jy})$。$\\kappa(x,y)$ 是一个线性函数，$\\kappa(x,y) = a_0 + a_1 x + a_2 y$。那么 $\\kappa \\nabla N_j = (\\kappa(x,y) c_{jx}, \\kappa(x,y) c_{jy})$。\n  - 它的散度是 $\\nabla \\cdot (\\kappa \\nabla N_j) = \\frac{\\partial}{\\partial x}(\\kappa c_{jx}) + \\frac{\\partial}{\\partial y}(\\kappa c_{jy}) = c_{jx} \\frac{\\partial \\kappa}{\\partial x} + c_{jy} \\frac{\\partial \\kappa}{\\partial y}$。\n  - 由于 $\\kappa$ 是线性的，其偏导数 $\\frac{\\partial \\kappa}{\\partial x} = a_1$ 和 $\\frac{\\partial \\kappa}{\\partial y} = a_2$ 是常数。因此，$\\nabla \\cdot (\\kappa \\nabla N_j)$ 是一个常数（0 次）。\n  - 被积函数是 $I_{ij} = \\underbrace{\\tau}_{\\text{0 次}} \\underbrace{(\\boldsymbol{u} \\cdot \\nabla N_i)}_{\\text{1 次}} (\\underbrace{\\boldsymbol{u} \\cdot \\nabla N_j}_{\\text{1 次}} - \\underbrace{\\nabla \\cdot (\\kappa \\nabla N_j)}_{\\text{0 次}})$。\n  - 括号中的项是一个 1 次多项式。整个被积函数是一个 1 次多项式与另一个 1 次多项式的乘积，结果是一个 2 次多项式。\n  - 因此，为了精确积分 SUPG 项，数值积分法则必须对 2 次多项式精确。\n\n**第 3 部分：$K^{\\mathrm{SUPG}}$ 的 Frobenius 范数的平方**\n\n对于常系数情况，我们有 $K^{\\mathrm{SUPG}}_{ij} = \\tau A (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j)$。我们定义一个标量 $g_k = \\boldsymbol{u} \\cdot \\nabla N_k$。那么 $K^{\\mathrm{SUPG}}_{ij} = \\tau A g_i g_j$。用向量表示法，如果 $\\boldsymbol{g} = (g_1, g_2, g_3)^T$，那么 $K^{\\mathrm{SUPG}} = \\tau A \\boldsymbol{g} \\boldsymbol{g}^T$。\n\nFrobenius 范数的平方为 $\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} (K^{\\mathrm{SUPG}}_{ij})^2$。\n$$\n\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} (\\tau A g_i g_j)^2 = (\\tau A)^2 \\sum_{i=1}^{3} \\sum_{j=1}^{3} g_i^2 g_j^2\n$$\n这个双重求和可以进行因式分解：\n$$\n\\sum_{i=1}^{3} \\sum_{j=1}^{3} g_i^2 g_j^2 = \\left( \\sum_{i=1}^{3} g_i^2 \\right) \\left( \\sum_{j=1}^{3} g_j^2 \\right) = \\left( \\sum_{k=1}^{3} g_k^2 \\right)^2\n$$\n所以，$\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = (\\tau A)^2 \\left( \\sum_{k=1}^{3} g_k^2 \\right)^2$。\n\n现在我们计算 $k=1,2,3$ 时 $g_k = \\boldsymbol{u} \\cdot \\nabla N_k$ 的值：\n$$\n\\boldsymbol{u} = \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix}, \\quad \\nabla N_1 = \\begin{pmatrix} -1/L \\\\ -1/H \\end{pmatrix}, \\quad \\nabla N_2 = \\begin{pmatrix} 1/L \\\\ 0 \\end{pmatrix}, \\quad \\nabla N_3 = \\begin{pmatrix} 0 \\\\ 1/H \\end{pmatrix}\n$$\n$$\ng_1 = \\boldsymbol{u} \\cdot \\nabla N_1 = u_x(-\\frac{1}{L}) + u_y(-\\frac{1}{H}) = -\\frac{u_x}{L} - \\frac{u_y}{H}\n$$\n$$\ng_2 = \\boldsymbol{u} \\cdot \\nabla N_2 = u_x(\\frac{1}{L}) + u_y(0) = \\frac{u_x}{L}\n$$\n$$\ng_3 = \\boldsymbol{u} \\cdot \\nabla N_3 = u_x(0) + u_y(\\frac{1}{H}) = \\frac{u_y}{H}\n$$\n接下来，我们计算它们的平方和 $\\sum_{k=1}^{3} g_k^2$：\n$$\n\\sum_{k=1}^{3} g_k^2 = g_1^2 + g_2^2 + g_3^2 = \\left(-\\frac{u_x}{L} - \\frac{u_y}{H}\\right)^2 + \\left(\\frac{u_x}{L}\\right)^2 + \\left(\\frac{u_y}{H}\\right)^2\n$$\n$$\n= \\left(\\frac{u_x^2}{L^2} + 2\\frac{u_x u_y}{LH} + \\frac{u_y^2}{H^2}\\right) + \\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} = 2\\frac{u_x^2}{L^2} + 2\\frac{u_y^2}{H^2} + 2\\frac{u_x u_y}{LH}\n$$\n$$\n\\sum_{k=1}^{3} g_k^2 = 2\\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right)\n$$\n最后，我们将此代入 Frobenius 范数平方的表达式中。回顾一下，单元面积为 $A = \\frac{LH}{2}$。\n$$\n\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\left(\\tau \\frac{LH}{2}\\right)^2 \\left[ 2\\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right) \\right]^2\n$$\n$$\n= \\tau^2 \\frac{L^2 H^2}{4} \\cdot 4 \\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right)^2\n$$\n$$\n= \\tau^2 L^2 H^2 \\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right)^2\n$$\n为了得到更紧凑的形式，我们可以将因子 $L^2 H^2$ 移到平方内部：\n$$\n\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\tau^2 \\left[ LH \\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right) \\right]^2\n$$\n$$\n= \\tau^2 \\left( \\frac{H}{L}u_x^2 + \\frac{L}{H}u_y^2 + u_x u_y \\right)^2\n$$\n这就是 SUPG 贡献矩阵的 Frobenius 范数平方的最终闭式表达式。",
            "answer": "$$\n\\boxed{\\tau^{2} \\left( \\frac{H}{L}u_{x}^{2} + \\frac{L}{H}u_{y}^{2} + u_{x} u_{y} \\right)^{2}}\n$$"
        },
        {
            "introduction": "SUPG方法能有效抑制数值振荡，但其代价是引入了会模糊解中尖锐特征的人工数值黏性。本练习旨在量化这一效应，你将推导SUPG方法的等效黏性系数，并将其与另一种先进方法——间断伽辽金（DG）格式的数值黏性进行比较。这有助于深入理解不同数值方法在精度和稳定性之间的权衡，并通过编写代码来验证你的理论分析。",
            "id": "3999705",
            "problem": "考虑一维线性平流方程，该方程模拟了具有恒定速度和压力的可压缩流中的接触间断的传播，作为可压缩欧拉方程中接触波的替代模型：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,\n$$\n其黎曼型初始条件由空间中一点的跳跃和两侧的恒定状态组成。设平流速度为常数 $a \\in \\mathbb{R}$ 且 $a \\neq 0$。将接触间断视为以速度 $a$ 对流的急剧跳跃。\n\n从加权残差法和流线迎风/彼得罗夫-伽辽金 (SUPG) 方法（Streamline-Upwind Petrov-Galerkin (SUPG)）的定义出发，其中检验函数沿流线方向受到扰动，推导 SUPG 方法在由连续分片线性元组成的均匀网格上为一维情况引入的附加双线性贡献的形式。将所添加的算子表示为等效于流线方向上的扩散算子的形式，并根据平流速度 $a$ 和一个单位为时间的稳定化参数 $\\tau$ 来确定有效扩散系数 $k_{\\mathrm{SUPG}}$。你可以假设稳定化参数 $\\tau$ 是均匀的，并且网格是拟均匀的，单元尺寸为 $h$，但你不能先验地假设 $\\tau$ 的特定公式。\n\n独立地，考虑在单元尺寸为 $h$ 的均匀网格上，对相同的线性平流方程使用半离散间断伽辽金 (DG) 方法（Discontinuous Galerkin (DG)），该方法采用分片常数试探函数（零次多项式）和迎风数值通量。进行二阶精度以内的修正方程分析，以获得一个等效的平流扩散方程，并根据 $a$ 和 $h$ 确定有效扩散系数 $k_{\\mathrm{DG}}$。\n\n利用一维平流扩散方程\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = k \\frac{\\partial^2 u}{\\partial x^2}\n$$\n的基本解，证明初始的阶跃间断会演变成一个以速度 $a$ 对流的光滑误差函数剖面，并推导“十到九十”过渡厚度 $\\Delta_{10\\text{–}90}$ 的显式表达式，该厚度定义为解达到跳跃值的 $10$ 百分比和 $90$ 百分比时所处位置之间的空间距离。将 $\\Delta_{10\\text{–}90}$ 表示为扩散系数 $k$ 和时间 $t$ 的函数。然后，使用你得到的 $k_{\\mathrm{SUPG}}$ 和 $k_{\\mathrm{DG}}$ 的表达式，获得比率\n$$\nR \\equiv \\frac{\\Delta_{10\\text{–}90}^{\\mathrm{SUPG}}}{\\Delta_{10\\text{–}90}^{\\mathrm{DG}}}\n$$\n的闭式表达式，该表达式仅含 $a$、 $h$ 和 $\\tau$。清晰地陈述推导过程中使用的所有假设。\n\n你的任务是编写一个完整的、可运行的程序，为以下测试套件计算该比率 $R$。在每个测试用例中，参数以 $(a, h, t, \\tau)$ 的形式给出，其中 $a$ 是平流速度（单位为 $\\mathrm{m/s}$），$h$ 是均匀单元尺寸（单位为 $\\mathrm{m}$），$t$ 是物理时间（单位为 $\\mathrm{s}$），$\\tau$ 是 SUPG 稳定化参数（单位为 $\\mathrm{s}$）。尽管中间量厚度 $\\Delta_{10\\text{–}90}$ 依赖于 $t$ 并且单位为米，但比率 $R$ 是无量纲的。对于数值计算，请使用标准科学库中反误差函数的精确值；不要用手写的近似值替换它。\n\n- 测试用例 1（基准相等）：$(a, h, t, \\tau) = (1.0, 0.01, 0.1, 0.01/(2 \\cdot 1.0))$。\n- 测试用例 2（SUPG 欠稳定）：$(a, h, t, \\tau) = (1.0, 0.01, 0.1, 0.01/(4 \\cdot 1.0))$。\n- 测试用例 3（参数缩放，相等）：$(a, h, t, \\tau) = (2.0, 0.02, 0.05, 0.02/(2 \\cdot 2.0))$。\n- 测试用例 4（无 SUPG 稳定化）：$(a, h, t, \\tau) = (1.5, 0.012, 0.08, 0.0)$。\n\n程序要求：\n- 使用你推导的表达式为每个测试用例计算比率 $R$。\n- 当中间量带有单位时，保持量纲一致性，并将 $a$ 视为 $\\mathrm{m/s}$，$h$ 视为 $\\mathrm{m}$，$t$ 视为 $\\mathrm{s}$，$\\tau$ 视为 $\\mathrm{s}$。最终报告的值是无量纲比率 $R$。\n- 将每个报告的 $R$ 值四舍五入到六位小数。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，结果的顺序与上面列出的测试用例的顺序相同。例如，输出必须类似于“[r1,r2,r3,r4]”，其中每个“ri”是测试用例 $i$ 的 $R$ 值的四舍五入浮点数。",
            "solution": "该问题要求通过多步推导，来求解一维线性平流方程的两种不同数值格式——流线迎风 Petrov-Galerkin (SUPG) 和间断 Galerkin (DG)——所产生的数值扩散效应之比。推导过程分为四个部分：SUPG 分析、DG 分析、扩散对间断的物理涂抹效应推导，以及最终比率的计算。\n\n### 第一部分：SUPG 人工扩散\n\n一维线性平流方程为：\n$$ \\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0 $$\n标准 Galerkin 有限元法从一个有限维空间 $V_h$（此处为连续分片线性函数空间）中寻找一个解 $u_h$，使得对于所有检验函数 $v_h \\in V_h$：\n$$ \\int_{\\Omega} v_h \\left( \\frac{\\partial u_h}{\\partial t} + a \\frac{\\partial u_h}{\\partial x} \\right) d\\Omega = 0 $$\nSUPG 方法修改了检验函数 $v_h$ 为 $w_h$，在流线方向上增加了一个扰动以增强稳定性。对于给定方程，流线算子为 $a \\frac{d}{dx}$。SUPG 检验函数定义为：\n$$ w_h = v_h + \\tau \\left( a \\frac{dv_h}{dx} \\right) $$\n其中 $\\tau$ 是一个单位为时间的稳定化参数。SUPG 格式是寻找 $u_h \\in V_h$，使得对于所有 $v_h \\in V_h$：\n$$ \\int_{\\Omega} w_h \\left( \\frac{\\partial u_h}{\\partial t} + a \\frac{\\partial u_h}{\\partial x} \\right) d\\Omega_e = 0 $$\n这通常是在逐个单元的基础上建立的，即 $\\sum_e \\int_{\\Omega_e} \\dots = 0$。代入 $w_h$ 的表达式：\n$$ \\sum_e \\int_{\\Omega_e} \\left( v_h + \\tau a \\frac{dv_h}{dx} \\right) \\left( \\frac{\\partial u_h}{\\partial t} + a \\frac{\\partial u_h}{\\partial x} \\right) dx = 0 $$\n展开此表达式得到标准 Galerkin 项和附加的稳定化项：\n$$ \\underbrace{\\sum_e \\int_{\\Omega_e} v_h \\left( \\frac{\\partial u_h}{\\partial t} + a \\frac{\\partial u_h}{\\partial x} \\right) dx}_{\\text{Galerkin 项}} + \\underbrace{\\sum_e \\int_{\\Omega_e} \\left( \\tau a \\frac{dv_h}{dx} \\right) \\left( \\frac{\\partial u_h}{\\partial t} + a \\frac{\\partial u_h}{\\partial x} \\right) dx}_{\\text{SUPG 稳定化项}} = 0 $$\n问题要求识别出等效于扩散算子的附加贡献。扩散算子 $-k \\frac{\\partial^2 u}{\\partial x^2}$ 的弱形式是通过乘以一个检验函数 $v_h$ 并分部积分得到的：\n$$ \\int_{\\Omega} v_h \\left(-k \\frac{\\partial^2 u_h}{\\partial x^2}\\right) dx = \\int_{\\Omega} k \\frac{dv_h}{dx} \\frac{\\partial u_h}{\\partial x} dx - \\text{边界项} $$\n因此，与扩散相关的双线性形式为 $\\int k \\frac{dv_h}{dx} \\frac{\\partial u_h}{\\partial x} dx$。\n\n我们来考察 SUPG 稳定化项。它可以分为两部分：\n$$ \\sum_e \\int_{\\Omega_e} \\tau a \\frac{dv_h}{dx} \\frac{\\partial u_h}{\\partial t} dx + \\sum_e \\int_{\\Omega_e} \\tau a^2 \\frac{dv_h}{dx} \\frac{\\partial u_h}{\\partial x} dx $$\n第二部分 $\\int_{\\Omega} \\tau a^2 \\frac{dv_h}{dx} \\frac{\\partial u_h}{\\partial x} dx$（由于 $\\tau$ 和 $a$ 是常数，我们可以将其写为在整个域 $\\Omega$ 上的积分）具有与扩散算子弱形式完全相同的形式。通过将此项与扩散算子的弱形式进行比较，我们可以确定有效 SUPG 扩散系数 $k_{\\mathrm{SUPG}}$ 为：\n$$ k_{\\mathrm{SUPG}} = \\tau a^2 $$\n其单位为 $[\\tau][a]^2 = \\mathrm{s} \\cdot (\\mathrm{m/s})^2 = \\mathrm{m}^2/\\mathrm{s}$，这正是扩散系数的正确单位。\n\n### 第二部分：DG 人工扩散\n\n对于采用分片常数基函数 ($P_0$) 的间断伽辽金 (DG) 方法，解 $u_h$ 在每个尺寸为 $h$ 的单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 中表示为一个常数值 $u_j(t)$。在单元 $I_j$ 上的半离散格式为：\n$$ \\int_{I_j} \\frac{\\partial u_h}{\\partial t} dx + \\int_{I_j} a \\frac{\\partial u_h}{\\partial x} dx = 0 $$\n$$ h \\frac{du_j}{dt} + a \\left[ u_h(x_{j+1/2}) - u_h(x_{j-1/2}) \\right] = 0 $$\n单元边界处的不连续值被数值通量 $a\\hat{u}$ 所取代。使用迎风通量，界面处的通量由上游单元的值确定。\n如果 $a  0$，流向为从左到右。$x_{j-1/2}$ 处的通量取决于 $u_{j-1}$，$x_{j+1/2}$ 处的通量取决于 $u_j$。格式为：\n$$ h \\frac{du_j}{dt} + a u_j - a u_{j-1} = 0 \\implies \\frac{du_j}{dt} = -\\frac{a}{h}(u_j - u_{j-1}) $$\n这是一阶迎风有限差分格式。为了找到修正方程，我们对 $u_{j-1}$ 在 $x_j$ 附近进行泰勒级数展开：\n$$ u_{j-1} = u(x_j-h, t) = u_j - h \\frac{\\partial u}{\\partial x}\\bigg|_{j} + \\frac{h^2}{2} \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{j} - O(h^3) $$\n将此代入格式中：\n$$ \\frac{\\partial u}{\\partial t}\\bigg|_j = -\\frac{a}{h} \\left( u_j - \\left[ u_j - h \\frac{\\partial u}{\\partial x}\\bigg|_{j} + \\frac{h^2}{2} \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{j} - \\dots \\right] \\right) $$\n$$ \\frac{\\partial u}{\\partial t}\\bigg|_j = -\\frac{a}{h} \\left( h \\frac{\\partial u}{\\partial x}\\bigg|_j - \\frac{h^2}{2} \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{j} + O(h^3) \\right) $$\n$$ \\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = \\frac{ah}{2} \\frac{\\partial^2 u}{\\partial x^2} + O(h^2) $$\n如果 $a  0$，迎风格式为 $\\frac{du_j}{dt} = -\\frac{a}{h}(u_{j+1} - u_j)$，类似的分析会得到一个扩散项 $-\\frac{ah}{2} \\frac{\\partial^2 u}{\\partial x^2}$。\n两种情况都可以使用 $a$ 的绝对值来合并，因为数值扩散必须是正的。修正方程为：\n$$ \\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = \\frac{|a|h}{2} \\frac{\\partial^2 u}{\\partial x^2} + O(h^2) $$\n由此，我们确定有效 DG 扩散系数 $k_{\\mathrm{DG}}$ 为：\n$$ k_{\\mathrm{DG}} = \\frac{|a|h}{2} $$\n\n### 第三部分：间断的展宽与过渡厚度\n\n问题要求分析阶跃间断在平流扩散方程下的演化：\n$$ \\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = k \\frac{\\partial^2 u}{\\partial x^2} $$\n初始条件是从状态 $u_L$到 $u_R$ 的一个阶跃。通过变换到移动坐标系 $x' = x - at$，方程变为标准扩散方程 $\\frac{\\partial v}{\\partial t} = k \\frac{\\partial^2 v}{\\partial x'^2}$，其中 $v(x',t) = u(x,t)$。对于阶跃初始条件，扩散方程的解由误差函数 $\\mathrm{erf}$ 给出。变换回原始坐标，解为：\n$$ u(x, t) = \\frac{u_L + u_R}{2} + \\frac{u_R - u_L}{2} \\mathrm{erf}\\left(\\frac{x - at}{\\sqrt{4kt}}\\right) $$\n这表明初始的急剧跳跃演变成一个中心位于 $x=at$ 的光滑剖面，并随时间展宽。\n为了找到十到九十过渡厚度 $\\Delta_{10\\text{–}90}$，我们寻找空间位置 $x_{10}$ 和 $x_{90}$，在这些位置解分别达到总跳跃的 $10\\%$ 和 $90\\%$。我们将跳跃从 $0$ 归一化到 $1$（即 $u_L=0, u_R=1$）。解为 $u(x,t) = \\frac{1}{2}\\left(1 + \\mathrm{erf}\\left(\\frac{x - at}{\\sqrt{4kt}}\\right)\\right)$。\n对于 $u = 0.9$：\n$$ 0.9 = \\frac{1}{2}\\left(1 + \\mathrm{erf}\\left(\\frac{x_{90} - at}{\\sqrt{4kt}}\\right)\\right) \\implies \\mathrm{erf}\\left(\\frac{x_{90} - at}{\\sqrt{4kt}}\\right) = 0.8 $$\n$$ x_{90} = at + \\sqrt{4kt} \\cdot \\mathrm{erf}^{-1}(0.8) $$\n对于 $u = 0.1$：\n$$ 0.1 = \\frac{1}{2}\\left(1 + \\mathrm{erf}\\left(\\frac{x_{10} - at}{\\sqrt{4kt}}\\right)\\right) \\implies \\mathrm{erf}\\left(\\frac{x_{10} - at}{\\sqrt{4kt}}\\right) = -0.8 $$\n$$ x_{10} = at + \\sqrt{4kt} \\cdot \\mathrm{erf}^{-1}(-0.8) $$\n厚度为 $\\Delta_{10\\text{–}90} = x_{90} - x_{10}$。由于 $\\mathrm{erf}^{-1}$ 是一个奇函数，所以 $\\mathrm{erf}^{-1}(-0.8) = -\\mathrm{erf}^{-1}(0.8)$。\n$$ \\Delta_{10\\text{–}90} = \\sqrt{4kt} \\left( \\mathrm{erf}^{-1}(0.8) - \\mathrm{erf}^{-1}(-0.8) \\right) = \\sqrt{4kt} \\cdot 2 \\cdot \\mathrm{erf}^{-1}(0.8) $$\n$$ \\Delta_{10\\text{–}90} = 4 \\cdot \\mathrm{erf}^{-1}(0.8) \\sqrt{kt} $$\n厚度与扩散系数 $k$ 和时间 $t$ 的平方根成正比。令 $C = 4 \\cdot \\mathrm{erf}^{-1}(0.8)$，这是一个常数。则 $\\Delta_{10\\text{–}90} = C\\sqrt{kt}$。\n\n### 第四部分：过渡厚度之比\n\n我们现在可以使用 SUPG 和 DG 各自的有效扩散系数来表示它们的过渡厚度：\n$$ \\Delta_{10\\text{–}90}^{\\mathrm{SUPG}} = C \\sqrt{k_{\\mathrm{SUPG}} t} = C \\sqrt{(\\tau a^2) t} = C |a| \\sqrt{\\tau t} $$\n$$ \\Delta_{10\\text{–}90}^{\\mathrm{DG}} = C \\sqrt{k_{\\mathrm{DG}} t} = C \\sqrt{\\left(\\frac{|a|h}{2}\\right) t} = C \\sqrt{\\frac{|a|ht}{2}} $$\n比率 $R$ 定义为 $R \\equiv \\frac{\\Delta_{10\\text{–}90}^{\\mathrm{SUPG}}}{\\Delta_{10\\text{–}90}^{\\mathrm{DG}}}$。\n$$ R = \\frac{C |a| \\sqrt{\\tau t}}{C \\sqrt{\\frac{|a|ht}{2}}} = \\frac{|a| \\sqrt{\\tau}}{\\sqrt{\\frac{|a|h}{2}}} = |a| \\sqrt{\\frac{2\\tau}{|a|h}} = \\sqrt{\\frac{a^2 \\cdot 2\\tau}{|a|h}} = \\sqrt{\\frac{2|a|\\tau}{h}} $$\n这是比率 $R$ 的最终闭式表达式。它依赖于平流速度 $a$、单元尺寸 $h$ 和稳定化参数 $\\tau$，但与时间 $t$ 无关。\n\n**假设总结：**\n$1$. SUPG 格式的数值扩散主要由其在弱形式下与扩散算子结构上相同的项所主导。\n$2$. 半离散 DG 格式的行为可由其修正方程精确描述，该方程在二阶导数项处截断。\n$3$. 两种格式中数值扩散层的厚度，都可以用从相应平流扩散方程推导出的解析厚度来建模。\n\n最终需要实现的公式是 $R = \\sqrt{\\frac{2|a|\\tau}{h}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are used. scipy was only conceptually needed for the derivation.\n\ndef solve():\n    \"\"\"\n    Computes the ratio R of SUPG to DG transition thicknesses for a series of test cases.\n    The derived formula for the ratio is R = sqrt(2 * |a| * tau / h).\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (a, h, t, tau), where t is unused in the final ratio.\n    test_cases = [\n        # (a, h, t, tau)\n        (1.0, 0.01, 0.1, 0.01 / (2.0 * 1.0)),      # Test case 1\n        (1.0, 0.01, 0.1, 0.01 / (4.0 * 1.0)),      # Test case 2\n        (2.0, 0.02, 0.05, 0.02 / (2.0 * 2.0)),     # Test case 3\n        (1.5, 0.012, 0.08, 0.0),                  # Test case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        a, h, t, tau = case\n        \n        # Guard against division by zero, although h>0 is assumed for a valid mesh.\n        if h == 0:\n            # This case indicates an invalid physical setup.\n            # The ratio would be undefined or infinite.\n            result = np.nan\n        else:\n            # The derived expression for the ratio R is sqrt(2*|a|*tau/h).\n            # The physical time 't' cancels out and is not needed for the calculation.\n            # We use np.abs(a) to be fully general, as derived.\n            result = np.sqrt(2 * np.abs(a) * tau / h)\n            \n        results.append(result)\n\n    # Format the results to exactly six decimal places as required.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}