{
    "hands_on_practices": [
        {
            "introduction": "要掌握间断伽辽金（DG）方法，第一步是深刻理解其核心——数值通量。本练习将通过一个基础但至关重要的问题来帮助你建立这种理解。我们将针对非线性的伯格斯方程（Burgers' equation），直接计算并比较两种代表性的数值通量：基于精确黎曼问题解的戈杜诺夫（Godunov）通量，以及更为简单但耗散性更强的拉克斯-弗里德里希斯（Lax-Friedrichs）通量。通过这个练习，你将亲手量化不同通量函数引入的人工耗散，从而为选择和设计更高级的数值格式打下坚实的直觉基础。",
            "id": "3982038",
            "problem": "考虑无量纲形式的无粘性伯格斯方程的标量守恒律，$u_t + f(u)_x = 0$，其通量为 $f(u) = \\frac{u^{2}}{2}$。在一个一维间断伽辽金 (DG) 离散中，每个单元采用分片线性多项式，界面状态通过使用全变差递减 (TVD) minmod 限制器进行重构，以控制伪振荡。对于一个特定的界面 $x_{i+\\frac{1}{2}}$，假设限制后的左右重构状态分别为 $u_{L} = 0.8$ 和 $u_{R} = -0.2$。\n\n根据双曲守恒律及其黎曼问题的第一性原理：\n\n- 通过调用与守恒和熵条件一致的无粘性伯格斯方程的精确自相似黎曼解，计算 $x_{i+\\frac{1}{2}}$ 处的 Godunov 通量。\n- 使用标准对称形式计算 $x_{i+\\frac{1}{2}}$ 处的 Lax–Friedrichs 数值通量，其中耗散参数选择为适用于无粘性伯格斯方程的最大特征速度大小，即 $\\alpha = \\max\\!\\big(|u_{L}|, |u_{R}|\\big)$。\n\n最后，计算该界面上 Lax–Friedrichs 通量与 Godunov 通量之差 $F_{\\mathrm{LF}} - F_{\\mathrm{G}}$。将最终答案表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "用户希望我解决以下问题：\n考虑无量纲形式的无粘性伯格斯方程的标量守恒律，$u_t + f(u)_x = 0$，其通量为 $f(u) = \\frac{u^{2}}{2}$。在一个一维间断伽辽金 (DG) 离散中，每个单元采用分片线性多项式，界面状态通过使用全变差递减 (TVD) minmod 限制器进行重构，以控制伪振荡。对于一个特定的界面 $x_{i+\\frac{1}{2}}$，假设限制后的左右重构状态分别为 $u_{L} = 0.8$ 和 $u_{R} = -0.2$。\n\n根据双曲守恒律及其黎曼问题的第一性原理：\n\n- 通过调用与守恒和熵条件一致的无粘性伯格斯方程的精确自相似黎曼解，计算 $x_{i+\\frac{1}{2}}$ 处的 Godunov 通量。\n- 使用标准对称形式计算 $x_{i+\\frac{1}{2}}$ 处的 Lax–Friedrichs 数值通量，其中耗散参数选择为适用于无粘性伯格斯方程的最大特征速度大小，即 $\\alpha = \\max\\!\\big(|u_{L}|, |u_{R}|\\big)$。\n\n最后，计算该界面上 Lax–Friedrichs 通量与 Godunov 通量之差 $F_{\\mathrm{LF}} - F_{\\mathrm{G}}$。将最终答案表示为一个无量纲数，并四舍五入到四位有效数字。\n\n### 步骤 1：提取给定条件\n- 守恒律：$u_t + f(u)_x = 0$\n- 通量函数：$f(u) = \\frac{u^{2}}{2}$\n- 界面 $x_{i+\\frac{1}{2}}$ 处的左状态：$u_{L} = 0.8$\n- 界面 $x_{i+\\frac{1}{2}}$ 处的右状态：$u_{R} = -0.2$\n- Lax–Friedrichs 通量的耗散参数：$\\alpha = \\max(|u_{L}|, |u_{R}|)$\n\n### 步骤 2：使用提取的给定条件进行验证\n该问题具有科学依据，是双曲守恒律数值方法的标准练习，特别关注著名的伯格斯方程。它使用了诸如 Godunov 和 Lax-Friedrichs 数值通量等既定概念，这些是计算流体动力学领域的基础。该问题是适定的，提供了唯一确定所需量的所有必要信息（$u_L$、$u_R$、通量函数、耗散参数规则）。语言客观而精确。问题是自洽且一致的。\n\n### 步骤 3：结论与行动\n该问题有效。将提供解答。\n\n该问题需要三步计算：首先，Godunov 通量 $F_{\\mathrm{G}}$；其次，Lax-Friedrichs 通量 $F_{\\mathrm{LF}}$；第三，它们的差值 $F_{\\mathrm{LF}} - F_{\\mathrm{G}}$。\n\n**1. Godunov 通量（$F_{\\mathrm{G}}$）的计算**\n\nGodunov 通量由界面处黎曼问题的精确解确定。伯格斯方程的黎曼问题由初始条件定义：\n$$u(x,0) = \\begin{cases} u_{L}  \\text{if } x  0 \\\\ u_{R}  \\text{if } x > 0 \\end{cases}$$\n其中 $u_{L} = 0.8$ 且 $u_{R} = -0.2$。特征速度由 $a(u) = f'(u) = u$ 给出。\n\n由于左状态的特征速度 $a(u_{L}) = u_{L} = 0.8$ 大于右状态的特征速度 $a(u_{R}) = u_{R} = -0.2$，特征线将会相交，形成一个激波。这个激波的速度 $s$ 由 Rankine-Hugoniot 跳跃条件确定：\n$$s = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}}$$\n对于伯格斯方程，这简化为：\n$$s = \\frac{\\frac{1}{2}u_{R}^{2} - \\frac{1}{2}u_{L}^{2}}{u_{R} - u_{L}} = \\frac{1}{2} \\frac{(u_{R}-u_{L})(u_{R}+u_{L})}{u_{R}-u_{L}} = \\frac{u_{L} + u_{R}}{2}$$\n代入给定值：\n$$s = \\frac{0.8 + (-0.2)}{2} = \\frac{0.6}{2} = 0.3$$\n我们必须验证该激波满足 Lax 熵条件，该条件指出特征线必须流入激波：$a(u_{L}) > s > a(u_{R})$。\n$$0.8 > 0.3 > -0.2$$\n条件得到满足。\n\n黎曼问题的自相似解是 $\\xi = x/t$ 的函数。由于激波速度 $s = 0.3$ 是正的，激波波前向右移动。对于任何时间 $t > 0$，界面位置 $x=0$（即 $\\xi=0$）处的状态是激波左侧的状态，即 $u_{L}$。\n因此，用于计算 Godunov 通量的状态是 $u_{\\mathrm{G}} = u_{L} = 0.8$。\n于是 Godunov 通量为：\n$$F_{\\mathrm{G}} = f(u_{\\mathrm{G}}) = f(u_{L}) = \\frac{1}{2}u_{L}^{2} = \\frac{1}{2}(0.8)^{2} = \\frac{1}{2}(0.64) = 0.32$$\n\n**2. Lax–Friedrichs 通量（$F_{\\mathrm{LF}}$）的计算**\n\nLax-Friedrichs 数值通量（也称为 Rusanov 通量）由以下公式给出：\n$$F_{\\mathrm{LF}} = \\frac{1}{2} \\left[ f(u_{L}) + f(u_{R}) - \\alpha(u_{R} - u_{L}) \\right]$$\n耗散参数 $\\alpha$ 定义为界面处特征速度的最大绝对值：\n$$\\alpha = \\max(|a(u_L)|, |a(u_R)|) = \\max(|u_{L}|, |u_{R}|)$$\n代入给定值：\n$$\\alpha = \\max(|0.8|, |-0.2|) = \\max(0.8, 0.2) = 0.8$$\n接下来，我们计算左右状态的通量值：\n$$f(u_{L}) = \\frac{1}{2}u_{L}^{2} = \\frac{1}{2}(0.8)^{2} = 0.32$$\n$$f(u_{R}) = \\frac{1}{2}u_{R}^{2} = \\frac{1}{2}(-0.2)^{2} = \\frac{1}{2}(0.04) = 0.02$$\n现在我们将这些量代入 Lax-Friedrichs 通量公式：\n$$F_{\\mathrm{LF}} = \\frac{1}{2} \\left[ (0.32) + (0.02) - (0.8)((-0.2) - (0.8)) \\right]$$\n$$F_{\\mathrm{LF}} = \\frac{1}{2} \\left[ 0.34 - 0.8(-1.0) \\right]$$\n$$F_{\\mathrm{LF}} = \\frac{1}{2} \\left[ 0.34 + 0.8 \\right]$$\n$$F_{\\mathrm{LF}} = \\frac{1}{2} (1.14) = 0.57$$\n\n**3. 计算差值**\n\n最后一步是计算 Lax-Friedrichs 通量与 Godunov 通量之间的差值：\n$$F_{\\mathrm{LF}} - F_{\\mathrm{G}} = 0.57 - 0.32 = 0.25$$\n问题要求答案四舍五入到四位有效数字。这得到 $0.2500$。",
            "answer": "$$\\boxed{0.2500}$$"
        },
        {
            "introduction": "在掌握了基本通量的计算之后，下一步是分析和比较在更复杂的流体动力学系统（如欧拉方程）中各种实用通量的性能。不同的物理现象（如激波、接触间断和稀疏波）以不同的方式传播，而数值通量的设计直接决定了其精确捕捉这些现象的能力。本练习引导你深入研究一个关键问题：不同近似黎曼求解器（包括Roe、HLL、HLLC和Rusanov格式）如何处理接触间断。通过线性化分析，你将揭示这些格式对接触间断所引入的数值耗散，从而理解为什么像HLLC这样的高级格式在需要精确捕捉物质界面的多相流或燃烧问题中至关重要。",
            "id": "3982046",
            "problem": "考虑量热完全气体的一维欧拉方程的守恒形式，其状态向量为 $U = (\\rho, \\rho u, E)^{\\top}$，通量为 $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\top}$，状态方程为 $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right)$，其中 $\\gamma$ 是比热比。设均匀基态为 $U_{0} = (\\rho_{0}, 0, E_{0})^{\\top}$，具有恒定的压力 $p_{0}$ 和声速 $a_{0} = \\sqrt{\\gamma p_{0}/\\rho_{0}}$。我们分析该守恒律的间断伽辽金 (DG) 格式中的单个界面，其外法线与 $x$ 方向对齐。\n\n关注界面上一个纯接触模态的小振幅间断，其左右状态定义为 $U_{L} = U_{0}$ 和 $U_{R} = U_{0} + \\varepsilon r_{c}$，其中 $0  \\varepsilon \\ll 1$，而 $r_{c}$ 是与线性退化场（接触/熵波）相关的通量雅可比矩阵的特征向量。对于给定的 $u_{0} = 0$ 和恒定 $p_{0}$ 的均匀基态，这个接触模态扰动在守恒变量中可以选择为 $r_{c} = (1, 0, 0)^{\\top}$，对应于压力和速度连续的密度跳跃。\n\n对以下每种近似黎曼求解器，围绕 $U_{0}$ 线性化界面数值通量：\n- Roe 近似黎曼求解器 (Roe)，\n- Harten–Lax–van Leer (HLL)，\n- Harten–Lax–van Leer–Contact (HLLC)，\n- Rusanov（也称为局部 Lax–Friedrichs）。\n\n对于每个求解器，将线性化中的主导阶耗散贡献定义为乘以跳跃 $(U_{R} - U_{L})$ 的矩阵项，并将其投影到接触特征向量 $r_{c}$ 上（$r_c$ 被归一化，使其密度分量为1）。从此投影中，提取接触模态的标量等效耗散系数 $\\nu$，并报告无量纲量 $\\hat{\\nu} = \\nu / a_{0}$。\n\n计算并以单行矩阵的形式提供 $\\hat{\\nu}$ 的四个值，顺序为 (Roe, HLL, HLLC, Rusanov)。最终答案必须是一个闭式解析表达式。无需四舍五-入，且量 $\\hat{\\nu}$ 是无量纲的，因此不使用物理单位。",
            "solution": "用户要求我严格验证一个问题，如果问题有效，则对其进行求解。该问题涉及在一维欧拉方程中，四种常见近似黎曼求解器对于纯接触波间断的数值耗散。\n\n### 问题验证\n\n在尝试任何求解之前，对问题进行严格的验证程序。\n\n**步骤 1：提取给定条件**\n-   **控制律**：一维欧拉方程的守恒形式。\n    -   状态向量：$U = (\\rho, \\rho u, E)^{\\top}$。\n    -   通量向量：$F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\top}$。\n    -   状态方程（量热完全气体）：$p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^{2})$。\n-   **基态**：一个均匀状态 $U_{0} = (\\rho_{0}, 0, E_{0})^{\\top}$。该状态具有恒定的压力 $p_{0}$ 和声速 $a_{0} = \\sqrt{\\gamma p_{0}/\\rho_{0}}$。\n-   **界面扰动**：一个纯接触模态的小振幅间断。\n    -   左状态：$U_{L} = U_{0}$。\n    -   右状态：$U_{R} = U_{0} + \\varepsilon r_{c}$，其中 $0  \\varepsilon \\ll 1$。\n    -   对于 $u_0=0$ 的基态的接触特征向量：$r_{c} = (1, 0, 0)^{\\top}$。这表示密度（$\\rho$）存在跳跃，而速度（$u$）和压力（$p$）没有跳跃。\n-   **任务**：\n    1.  围绕基态 $U_{0}$ 线性化四种指定求解器的数值通量。\n    2.  对每种求解器，识别主导阶耗散矩阵项。\n    3.  将此项投影到接触特征向量 $r_c$ 上。\n    4.  从投影中，提取接触模态的标量耗散系数 $\\nu$。\n    5.  报告无量纲量 $\\hat{\\nu} = \\nu / a_{0}$。\n-   **待分析的求解器**：Roe、Harten-Lax-van Leer (HLL)、Harten-Lax-van Leer-Contact (HLLC) 和 Rusanov (Local Lax-Friedrichs)。\n-   **要求输出**：一个单行矩阵，按 (Roe, HLL, HLLC, Rusanov) 的顺序包含 $\\hat{\\nu}$ 的四个值。\n\n**步骤 2：使用提取的给定条件进行验证**\n-   **科学基础**：该问题牢固地植根于双曲守恒律数值方法的既定理论，这是计算流体动力学 (CFD) 的核心课题。欧拉方程、黎曼求解器和波分析都是标准概念。\n-   **适定性**：问题是适定的。它明确了控制方程、基态、扰动的精确形式、要执行的分析以及输出的确切形式。待计算的量可以从所提供的信息中唯一确定。\n-   **客观性**：问题以精确、客观、技术性的语言陈述，没有任何主观性或歧义。\n-   **一致性检查**：对于 $u_0 = 0$ 的基态，所选的接触特征向量 $r_c = (1, 0, 0)^{\\top}$ 对应于 $U_L = (\\rho_0, 0, E_0)^{\\top}$ 和 $U_R = (\\rho_0+\\varepsilon, 0, E_0)^{\\top}$。根据状态方程，$p_L = (\\gamma-1)E_0$ 和 $p_R = (\\gamma-1)E_0$，因此 $p_L=p_R$。速度为 $u_L=0/\\rho_0=0$ 和 $u_R=0/(\\rho_0+\\varepsilon)=0$。因此，速度和压力在跳跃处是连续的，这正确地定义了一个接触间断。设置是完全一致的。\n\n不存在科学缺陷、矛盾或歧义。问题有效。\n\n**步骤 3：结论与行动**\n问题被判定为**有效**。将提供完整解答。\n\n### 解答\n\n单侧界面的数值通量 $\\mathcal{F}$ 的一般形式可以表示为中心部分和耗散部分：\n$$ \\mathcal{F}(U_L, U_R) = \\frac{1}{2}(F(U_L) + F(U_R)) - \\frac{1}{2}D_{\\text{num}}(U_L, U_R)(U_R - U_L) $$\n其中 $D_{\\text{num}}$ 是数值耗散矩阵。题目要求我们围绕基态 $U_0$ 线性化此通量。对于给定的微小扰动 $U_L=U_0$ 和 $U_R = U_0 + \\varepsilon r_c$，耗散矩阵可以近似为其在基态处的值，$\\bar{D}_{\\text{num}} = D_{\\text{num}}(U_0, U_0)$。\n\n问题通过将耗散项投影到接触特征向量 $r_c$ 上来定义标量耗散系数 $\\nu$。耗散项为 $-\\frac{1}{2}\\bar{D}_{\\text{num}}(U_R-U_L) = -\\frac{\\varepsilon}{2}\\bar{D}_{\\text{num}}r_c$。设此向量为 $d$。它在 $r_c$ 上的投影是 $\\text{proj}_{r_c}(d) = \\frac{d \\cdot r_c}{r_c \\cdot r_c}r_c$。问题要求从此投影中提取 $\\nu$。这意味着耗散对接触模态的作用被建模为 $-\\nu(U_R-U_L)$。将此与投影相等表明，$\\nu$ 是算子 $\\frac{1}{2}\\bar{D}_{\\text{num}}$ 对应于特征向量 $r_c$ 的特征值。\n$$ \\frac{1}{2}\\bar{D}_{\\text{num}} r_c = \\nu r_c $$\n这是因为对于所有考虑的格式，$r_c$ 都是线性化耗散矩阵 $\\bar{D}_{\\text{num}}$ 的一个特征向量。\n\n首先，我们确定在基态 $U_0 = (\\rho_0, 0, E_0)^\\top$ 处的通量雅可比矩阵 $A(U) = \\frac{\\partial F}{\\partial U}$。在 $u=U_2/U_1=0$ 处的计算得出：\n$$ A_0 = A(U_0) = \\begin{pmatrix} 0  1  0 \\\\ 0  0  \\gamma-1 \\\\ 0  a_0^2/(\\gamma-1)  0 \\end{pmatrix} $$\n$A_0$ 的特征值是 $\\det(A_0-\\lambda I) = -\\lambda(\\lambda^2 - a_0^2) = 0$ 的根，即 $\\lambda_1=0$，$\\lambda_2=a_0$ 和 $\\lambda_3=-a_0$。这些对应于波速 $\\{u_0, u_0+a_0, u_0-a_0\\}$。特征值 $\\lambda_1=0$ 的右特征向量通过求解 $A_0 r = 0$ 找到，得到 $r=(1, 0, 0)^\\top$（除去一个缩放因子）。这证实了给定的 $r_c$ 确实是正确的接触特征向量。\n\n我们现在分析每种格式，以找到其 $\\bar{D}_{\\text{num}}$ 和相应的特征值 $\\nu$。\n\n**1. Roe 近似黎曼求解器**\nRoe 求解器的耗散矩阵由 $|A(\\tilde{U})|$ 给出，其中 $\\tilde{U}$ 是 Roe 平均状态。对于微小扰动，$\\tilde{U} \\approx U_0$。因此，线性化耗散矩阵是 $\\bar{D}_{\\text{Roe}} = |A(U_0)| = |A_0|$。矩阵 $|A_0|$ 与 $A_0$ 有相同的特征向量，但其特征值是 $A_0$ 特征值的绝对值。\n接触特征向量 $r_c$ 对应于 $A_0$ 的特征值 $\\lambda_1 = 0$。因此，它也是 $|A_0|$ 的特征向量，特征值为 $|\\lambda_1| = |0| = 0$。\n耗散算子是 $\\frac{1}{2}|A_0|$。将其作用于 $r_c$：\n$$ \\frac{1}{2}\\bar{D}_{\\text{Roe}}r_c = \\frac{1}{2}|A_0|r_c = \\frac{1}{2}(0)r_c = 0 \\cdot r_c $$\n所以，标量耗散系数是 $\\nu_{\\text{Roe}} = 0$。无量纲系数是 $\\hat{\\nu}_{\\text{Roe}} = \\nu_{\\text{Roe}} / a_0 = 0$。\n\n**2. Harten-Lax-van Leer (HLL) 求解器**\nHLL 数值通量为 $\\mathcal{F}_{\\text{HLL}} = \\frac{s_R F_L - s_L F_R + s_L s_R (U_R - U_L)}{s_R - s_L}$，其中 $s_L$ 和 $s_R$ 是信号速度估计。对于 $u_0=0$ 的基态 $U_0$，标准选择是 $s_L = u_0 - a_0 = -a_0$ 和 $s_R = u_0 + a_0 = a_0$。将这些代入通量公式并简化：\n$$ \\mathcal{F}_{\\text{HLL}} = \\frac{a_0 F_L - (-a_0) F_R + (-a_0)(a_0)(U_R - U_L)}{a_0 - (-a_0)} = \\frac{a_0(F_L + F_R) - a_0^2(U_R - U_L)}{2a_0} $$\n$$ \\mathcal{F}_{\\text{HLL}} = \\frac{1}{2}(F_L + F_R) - \\frac{a_0}{2}(U_R - U_L) $$\n与一般形式相比，数值耗散矩阵是 $\\bar{D}_{\\text{HLL}} = a_0 I$，其中 $I$ 是单位矩阵。任何向量都是单位矩阵的特征向量，特征值为 1。\n$$ \\frac{1}{2}\\bar{D}_{\\text{HLL}}r_c = \\frac{1}{2}(a_0 I)r_c = \\frac{a_0}{2}r_c $$\n标量耗散系数是 $\\nu_{\\text{HLL}} = \\frac{a_0}{2}$。无量纲系数是 $\\hat{\\nu}_{\\text{HLL}} = \\nu_{\\text{HLL}} / a_0 = \\frac{1}{2}$。\n\n**3. Harten-Lax-van Leer-Contact (HLLC) 求解器**\nHLLC 求解器被专门设计用于识别并精确解析孤立的接触间断。指定的界面条件是一个纯粹的、静止的（$u_0=0$）接触波。对于这样的波，黎曼问题的精确解由左状态 $U_L$ 和右状态 $U_R$ 组成，它们被以速度 $u=0$ 传播的接触波分开。界面处的通量恰好是 $F(U_L) = F(U_R) = F(U_0)$。\nHLLC 格式再现了这个精确通量，因此 $\\mathcal{F}_{\\text{HLLC}}(U_L, U_R) = F(U_0)$。\n通量的中心部分是 $\\frac{1}{2}(F_L + F_R) = \\frac{1}{2}(F(U_0) + F(U_0 + \\varepsilon r_c))$。\n我们围绕 $U_0$ 线性化 $F(U_R)$：$F(U_R) \\approx F(U_0) + A_0 (U_R-U_0) = F_0 + \\varepsilon A_0 r_c$。\n由于 $A_0 r_c = 0$，我们有一阶精度下 $F(U_R) \\approx F(U_0)$。\n所以，$\\frac{1}{2}(F_L + F_R) \\approx \\frac{1}{2}(F_0 + F_0) = F_0$。\n将 HLLC 通量与一般形式相等：\n$$ F_0 = \\frac{1}{2}(F_L + F_R) - \\frac{1}{2}\\bar{D}_{\\text{HLLC}}(U_R - U_L) \\approx F_0 - \\frac{1}{2}\\bar{D}_{\\text{HLLC}}(U_R - U_L) $$\n这意味着耗散项为零。因此，$\\bar{D}_{\\text{HLLC}}$ 作用于 $r_c$ 得到零。\n$$ \\frac{1}{2}\\bar{D}_{\\text{HLLC}}r_c = 0 \\cdot r_c $$\n标量耗散系数是 $\\nu_{\\text{HLLC}} = 0$。无量纲系数是 $\\hat{\\nu}_{\\text{HLLC}} = 0$。\n\n**4. Rusanov (局部 Lax-Friedrichs) 求解器**\nRusanov 通量由 $\\mathcal{F}_{\\text{LLF}} = \\frac{1}{2}(F_L + F_R) - \\frac{S_{\\text{max}}}{2}(U_R - U_L)$ 给出，其中 $S_{\\text{max}}$ 是最大绝对波速，$S_{\\text{max}} = \\max(|u_L|+a_L, |u_R|+a_R)$。\n在界面处，我们有：\n-   $U_L = U_0$：$|u_L|+a_L = |0|+a_0 = a_0$。\n-   $U_R = (\\rho_0+\\varepsilon, 0, E_0)^\\top$：$|u_R|=0$。声速为 $a_R = \\sqrt{\\gamma p_0/\\rho_R} = \\sqrt{\\gamma p_0/(\\rho_0+\\varepsilon)}$。由于 $\\varepsilon>0$，$\\rho_R > \\rho_0$，所以 $a_R  a_0$。\n最大绝对波速为 $S_{\\text{max}} = \\max(a_0, a_R) = a_0$。\nRusanov 通量变为：\n$$ \\mathcal{F}_{\\text{LLF}} = \\frac{1}{2}(F_L + F_R) - \\frac{a_0}{2}(U_R - U_L) $$\n此表达式与在这些条件下为 HLL 求解器推导的表达式相同。因此，分析是相同的。线性化耗散矩阵是 $\\bar{D}_{\\text{Rusanov}} = a_0 I$，相应的耗散系数是 $\\nu_{\\text{Rusanov}} = \\frac{a_0}{2}$。\n无量纲系数是 $\\hat{\\nu}_{\\text{Rusanov}} = \\nu_{\\text{Rusanov}} / a_0 = \\frac{1}{2}$。\n\n**结果总结**\n计算出的接触模态的无量纲标量耗散系数为：\n-   $\\hat{\\nu}_{\\text{Roe}} = 0$\n-   $\\hat{\\nu}_{\\text{HLL}} = \\frac{1}{2}$\n-   $\\hat{\\nu}_{\\text{HLLC}} = 0$\n-   $\\hat{\\nu}_{\\text{Rusanov}} = \\frac{1}{2}$\n\n最终答案是这些值按指定顺序组成的行矩阵。",
            "answer": "$$ \\boxed{\n\\begin{pmatrix}\n0  \\frac{1}{2}  0  \\frac{1}{2}\n\\end{pmatrix}\n} $$"
        },
        {
            "introduction": "理论分析和手工计算是理解数值格式的基石，但最终我们需要将这些概念整合到一个可工作的计算程序中。本综合性编程练习旨在让你体验一个完整的DG求解器的构建流程。你将为一个简单的线性平流方程实现空间离散、时间积分和解的限制器，这三者是DG方法不可或缺的组成部分。通过结合使用拉克斯-弗里德里希斯通量、强稳定性保持（SSP）龙格-库塔时间积分以及TVB（总变差有界）限制器，本练习将揭示这些模块之间复杂的相互作用，特别是在处理间断时，限制器如何与时间积分方案协同工作以确保解的物理真实性和稳定性。",
            "id": "3982050",
            "problem": "考虑一维标量线性平流方程 $u_t + a u_x = 0$，定义在周期性区域 $x \\in [0,1]$ 上，其中平流速度 $a \\in \\mathbb{R}$ 为常数。使用间断伽辽金 (DG) 方法在包含 $N$ 个单元的均匀网格上进行离散，每个单元的长度为 $h = 1/N$。在每个单元上，用参考坐标 $\\xi \\in [-1,1]$ 上的勒让德基中的 $p=2$ 次多项式来表示 $u$：$P_0(\\xi)=1$，$P_1(\\xi)=\\xi$，$P_2(\\xi)=\\frac{1}{2}(3\\xi^2-1)$。设单元 $j$ 上的系数为 $\\mathbf{c}_j = (c_{j,0}, c_{j,1}, c_{j,2})$，因此 $u_j(\\xi) = c_{j,0} P_0(\\xi) + c_{j,1} P_1(\\xi) + c_{j,2} P_2(\\xi)$，并注意单元平均值为 $\\bar{u}_j = c_{j,0}$。\n\n在单元交界面处使用 Lax–Friedrichs (也称 Rusanov) 数值通量，\n$$\nF^*(u_L,u_R) = \\frac{1}{2}\\left(a u_L + a u_R\\right) - \\frac{1}{2}\\alpha (u_R - u_L), \\quad \\alpha = |a|,\n$$\n其中 $u_L$ 和 $u_R$ 分别是来自左侧和右侧单元的交界面迹。经过分部积分后，单元 $j$ 上的半离散 DG 弱残差形式为\n$$\n\\mathbf{M} \\, \\frac{d \\mathbf{c}_j}{dt} = \\mathbf{V}_j(u) + \\mathbf{B}_j(u),\n$$\n其中对角质量矩阵为\n$$\n\\mathbf{M} = \\mathrm{diag}\\left(h, \\frac{h}{3}, \\frac{h}{5}\\right),\n$$\n体积项为\n$$\n\\mathbf{V}_j(u) = a \\begin{bmatrix} 0 \\\\ 2 c_{j,0} \\\\ 2 c_{j,1} \\end{bmatrix},\n$$\n边界项为\n$$\n\\mathbf{B}_j(u) = \\begin{bmatrix} F_L - F_R \\\\ -F_L - F_R \\\\ F_L - F_R \\end{bmatrix},\n$$\n其中 $F_L = F^*(u_{j-1}^+, u_j^-)$，$F_R = F^*(u_j^+, u_{j+1}^-)$，以及交界面迹 $u_j^- = c_{j,0} - c_{j,1} + c_{j,2}$ (在 $\\xi=-1$ 处)，$u_j^+ = c_{j,0} + c_{j,1} + c_{j,2}$ (在 $\\xi=+1$ 处)。状态 $u$ 处的半离散残差定义为 $\\mathbf{r}_j(u) = \\mathbf{M}^{-1}\\left(\\mathbf{V}_j(u) + \\mathbf{B}_j(u)\\right)$，全局残差范数为\n$$\n\\|R(u)\\|_2 = \\left(\\sum_{j=0}^{N-1} \\sum_{i=0}^{2} r_{j,i}(u)^2\\right)^{1/2}.\n$$\n\n使用强稳定性保持 (SSP) 三阶龙格-库塔方法推进解，时间步长 $\\Delta t = \\mathrm{CFL} \\cdot h / |a|$，其中 $\\mathrm{CFL} > 0$ 是一个给定数。其阶段为\n$$\nu^{(1)} = u^n + \\Delta t \\, R(u^n), \\quad u^{(2)} = \\frac{3}{4} u^n + \\frac{1}{4}\\left(u^{(1)} + \\Delta t \\, R(u^{(1)})\\right), \\quad u^{(3)} = \\frac{1}{3} u^n + \\frac{2}{3}\\left(u^{(2)} + \\Delta t \\, R(u^{(2)})\\right).\n$$\n\n在每个阶段 $u^{(k)}$ 之后，应用一个带有参数 $M \\ge 0$ 的总变差有界 (TVB) 限制器来限制高阶内容并抑制伪振荡：\n- 对每个单元 $j$，使用周期性索引计算相邻单元的平均值 $\\bar{u}_{j-1}$、$\\bar{u}_j$、$\\bar{u}_{j+1}$。\n- 通过设置 $c_{j,2}^{\\mathrm{new}} = c_{j,2}$ (如果 $|c_{j,2}| \\le M h^2$) 或 $c_{j,2}^{\\mathrm{new}} = 0$ (其他情况) 来限制二次项系数 $c_{j,2}$。\n- 使用修正的 minmod 函数限制一次项系数 $c_{j,1}$，\n$$\ns_1 = c_{j,1}, \\quad s_2 = \\frac{1}{2}(\\bar{u}_{j+1} - \\bar{u}_j), \\quad s_3 = \\frac{1}{2}(\\bar{u}_j - \\bar{u}_{j-1}),\n$$\n$$\n\\operatorname{minmod}(s_1, s_2, s_3) = \\begin{cases}\n\\operatorname{sign}(s_1) \\min(|s_1|,|s_2|,|s_3|),  \\text{如果 } \\operatorname{sign}(s_1)=\\operatorname{sign}(s_2)=\\operatorname{sign}(s_3),\\\\\n0,  \\text{其他情况},\n\\end{cases}\n$$\n并且\n$$\nc_{j,1}^{\\mathrm{new}} = \n\\begin{cases}\nc_{j,1},  \\text{如果 } |c_{j,1}| \\le M h^2,\\\\\n\\operatorname{minmod}(s_1, s_2, s_3),  \\text{其他情况}.\n\\end{cases}\n$$\n保持单元平均值 $c_{j,0}$ 不变。此限制器是一个标准的、适用于勒让德基的层级 TVB minmod 限制器，并在每个 SSP 阶段后逐单元应用。\n\n你的任务是实现上述指定的 DG 残差、SSP 龙格-库塔阶段和 TVB 限制器，然后计算在限制后的阶段解 $u^{(1)}$、$u^{(2)}$ 和 $u^{(3)}$ 处的残差范数。对每个测试用例，确定残差范数序列是否单调非增，即\n$$\n\\|R(u^{(1)})\\|_2 \\ge \\|R(u^{(2)})\\|_2 \\ge \\|R(u^{(3)})\\|_2,\n$$\n并计算比率 $\\rho = \\|R(u^{(3)})\\|_2 / \\|R(u^{(1)})\\|_2$，约定如果 $\\|R(u^{(1)})\\|_2 = 0$，则设置 $\\rho = \\|R(u^{(3)})\\|_2$。\n\n使用以下参数值和初始条件的测试套件：\n- 测试用例 1 (常规路径，间断点)：$N=80$，$a=1$，$\\mathrm{CFL}=0.1$，$M=0.0$，初始条件 $u_0(x) = 1$ (对于 $x  0.5$) 和 $u_0(x) = 0$ (其他情况)。\n- 测试用例 2 (边界情况，常数状态)：$N=60$，$a=1$，$\\mathrm{CFL}=0.1$，$M=0.0$，初始条件 $u_0(x) = 0.5$ (常数)。\n- 测试用例 3 (边缘情况，高频平滑内容)：$N=40$，$a=1$，$\\mathrm{CFL}=0.1$，$M=0.0$，初始条件 $u_0(x) = \\sin(10 \\pi x) + 0.5 \\sin(20 \\pi x)$，其中角度以弧度为单位。\n\n所有变量均为无量纲；不需要物理单位。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[\\text{monotone}_1, \\rho_1, \\text{monotone}_2, \\rho_2, \\text{monotone}_3, \\rho_3]$，其中每个 $\\text{monotone}_i$ 是一个布尔值，每个 $\\rho_i$ 是一个保留六位小数的浮点数。",
            "solution": "用户提供的问题是偏微分方程数值分析领域中一个明确定义的任务，具体关注于一维线性平流方程的间断伽辽金 (DG) 方法。该问题在科学上是合理的，内部是一致的，并包含了构建唯一解所需的所有信息。数值方案的各个组成部分——包括使用勒让德基的 DG 空间离散、Lax-Friedrichs 数值通量、三阶强稳定性保持 (SSP) 龙格-库塔时间积分以及总变差有界 (TVB) 限制器——都是标准的并且被正确地指定。该问题是有效的，我将继续提供完整解法。\n\n解决这个问题的总体方法是实现指定的 DG 方案，然后将其应用于给定的测试用例，执行一个时间步。解法的核心在于精确实现三个主要部分：初始条件的投影、半离散残差的计算，以及时间步进器与限制器的结合应用。\n\n首先，我们为每个测试用例建立计算网格和参数。定义域 $[0,1]$ 被离散为 $N$ 个均匀单元，每个单元宽度为 $h=1/N$。单元中心为 $x_j = (j+0.5)h$，其中 $j=0, \\dots, N-1$。系统的状态由每个单元上的一组系数 $\\mathbf{c}_j = (c_{j,0}, c_{j,1}, c_{j,2})$ 描述，对应于多项式基 $P_0, P_1, P_2$。初始状态 $\\mathbf{c}^n$ 是通过将给定的初始条件函数 $u_0(x)$ 投影到每个单元上的勒让德基上获得的。系数的计算公式源于 $L^2$-投影：\n$$\nc_{j,k} = \\frac{\\int_{x_j-h/2}^{x_j+h/2} u_0(x) P_k\\left(\\frac{x-x_j}{h/2}\\right) dx}{\\int_{x_j-h/2}^{x_j+h/2} P_k^2\\left(\\frac{x-x_j}{h/2}\\right) dx}\n$$\n通过变量代换到参考单元 $\\xi = \\frac{x-x_j}{h/2}$，并利用正交性 $\\int_{-1}^1 P_k(\\xi)P_m(\\xi)d\\xi = \\frac{2}{2k+1}\\delta_{km}$，上式简化为：\n$$\nc_{j,k} = \\frac{2k+1}{2} \\int_{-1}^1 u_0\\left(x_j + \\frac{h}{2}\\xi\\right) P_k(\\xi) d\\xi\n$$\n为了确保精度，特别是对于超越函数和不连续的初始条件，这些积分需要进行数值计算。\n\n其次，我们实现一个函数来计算给定状态 $u$（由其系数 $\\mathbf{c}$ 表示）的半离散残差 $\\mathbf{r}(u)$。单元 $j$ 的残差 $\\mathbf{r}_j$ 由 $\\mathbf{r}_j = \\mathbf{M}^{-1}(\\mathbf{V}_j + \\mathbf{B}_j)$ 给出。这需要几个子步骤：\n1.  计算解多项式在单元边界 $\\xi = \\pm 1$ 处的迹值：\n    -   $u_j^- = u_j(\\xi=-1) = c_{j,0} - c_{j,1} + c_{j,2}$\n    -   $u_j^+ = u_j(\\xi=1) = c_{j,0} + c_{j,1} + c_{j,2}$\n2.  利用周期性边界条件，确定数值通量所需的相邻单元迹值：$u_{j-1}^+$ 和 $u_{j+1}^-$。\n3.  计算单元 $j$ 左右边界处的数值通量：\n    -   $F_L = F^*(u_{j-1}^+, u_j^-)$\n    -   $F_R = F^*(u_j^+, u_{j+1}^-)$\n    其中 $F^*(u_L, u_R) = \\frac{1}{2}(a u_L + a u_R) - \\frac{1}{2}|a|(u_R - u_L)$。\n4.  使用提供的公式组装体积项 $\\mathbf{V}_j$ 和边界项 $\\mathbf{B}_j$。\n5.  将这些项组合，通过乘以逆质量矩阵 $\\mathbf{M}^{-1} = \\mathrm{diag}(1/h, 3/h, 5/h)$，求得单元的完整残差 $\\mathbf{r}_j$。\n为了效率，这个过程对所有 $N$ 个单元同时以矢量化方式实现。\n\n第三，我们实现 SSP 龙格-库塔时间步进过程与 TVB 限制器的结合。关键细节是，限制器在每个阶段之后应用，并且后续阶段的计算使用*限制后的*状态。对于从 $u^n$ 到 $u^{n+1}$ 的一个时间步：\n1.  **阶段 1**:\n    -   计算初始残差：$R(u^n)$。\n    -   计算未限制的阶段解：$u^{(1)}_{\\text{unlim}} = u^n + \\Delta t R(u^n)$。\n    -   应用 TVB 限制器得到限制后的阶段解：$u^{(1)} = \\text{limiter}(u^{(1)}_{\\text{unlim}})$。\n    -   计算并存储第一个残差范数：$\\|R(u^{(1)})\\|_2$。\n2.  **阶段 2**:\n    -   计算限制后状态的残差：$R(u^{(1)})$。\n    -   计算未限制的阶段解：$u^{(2)}_{\\text{unlim}} = \\frac{3}{4} u^n + \\frac{1}{4}(u^{(1)} + \\Delta t R(u^{(1)}))$。\n    -   应用 TVB 限制器：$u^{(2)} = \\text{limiter}(u^{(2)}_{\\text{unlim}})$。\n    -   计算并存储第二个残差范数：$\\|R(u^{(2)})\\|_2$。\n3.  **阶段 3**:\n    -   计算残差：$R(u^{(2)})$。\n    -   计算未限制的阶段解：$u^{(3)}_{\\text{unlim}} = \\frac{1}{3} u^n + \\frac{2}{3}(u^{(2)} + \\Delta t R(u^{(2)}))$。\n    -   应用 TVB 限制器：$u^{(3)} = \\text{limiter}(u^{(3)}_{\\text{unlim}})$。这是最终状态 $u^{n+1}$。\n    -   计算并存储第三个残差范数：$\\|R(u^{(3)})\\|_2$。\n\nTVB 限制器本身是逐单元应用的。对于每个单元 $j$，它可能修改高阶系数 $c_{j,1}$ 和 $c_{j,2}$ 以控制振荡，同时保持单元平均值 $c_{j,0}$ 不变。对于指定的参数值 $M=0$，该限制器变为 TVD 型限制器：二次项系数 $c_{j,2}$ 总是被置零，而一次项系数 $c_{j,1}$ 总是受到 minmod 函数的约束，该函数将其值与根据相邻单元平均值估算的斜率进行比较。minmod 函数的实现是鲁棒且矢量化的。\n\n最后，对于每个测试用例，我们分析计算出的残差范数序列 $(\\|R(u^{(1)})\\|_2, \\|R(u^{(2)})\\|_2, \\|R(u^{(3)})\\|_2)$，确定它是否单调非增，并根据指定的规则计算比率 $\\rho = \\|R(u^{(3)})\\|_2 / \\|R(u^{(1)})\\|_2$。然后将这些结果格式化为所需的输出字符串。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    主函数，用于解决给定测试用例的 DG 问题。\n    \"\"\"\n\n    class DGSolver:\n        \"\"\"\n        实现指定的间断伽辽金求解器。\n        \"\"\"\n        def __init__(self, N, a, CFL, M, u0_func):\n            self.N = N\n            self.a = a\n            self.CFL = CFL\n            self.M = M\n            self.u0_func = u0_func\n\n            self.h = 1.0 / self.N\n            self.dt = self.CFL * self.h / abs(self.a)\n            self.alpha = abs(self.a)\n            \n            # 勒让德多项式及其在 xi = +/- 1 处的值\n            self.P = [lambda xi: 1.0, lambda xi: xi, lambda xi: 0.5 * (3 * xi**2 - 1)]\n            self.P_minus1 = np.array([p(-1.0) for p in self.P]) # [1, -1, 1]\n            self.P_plus1 = np.array([p(1.0) for p in self.P])   # [1, 1, 1]\n\n            # 逆质量矩阵的对角线\n            self.M_inv_diag = np.array([1.0/self.h, 3.0/self.h, 5.0/self.h])\n\n            self.c0 = self._project_initial_conditions()\n\n        def _project_initial_conditions(self):\n            \"\"\"将初始条件函数投影到勒让德基上。\"\"\"\n            c = np.zeros((self.N, 3))\n            x_centers = (np.arange(self.N) + 0.5) * self.h\n            \n            for j in range(self.N):\n                xj = x_centers[j]\n                for k in range(3):\n                    integrand = lambda xi: self.u0_func(xj + 0.5 * self.h * xi) * self.P[k](xi)\n                    \n                    # 对于不连续的初始条件，如果间断点在积分区间内，则指明该点\n                    points = []\n                    if self.u0_func.__name__ == 'u0_case1':\n                        # 将间断点从 [0,1] 变换到 [-1,1]\n                        if (xj - 0.5 * self.h)  0.5  (xj + 0.5 * self.h):\n                            xi_disc = (0.5 - xj) / (0.5 * self.h)\n                            points.append(xi_disc)\n                    \n                    integral_val, _ = quad(integrand, -1.0, 1.0, points=points)\n                    c[j, k] = (2 * k + 1) / 2.0 * integral_val\n            return c\n\n        @staticmethod\n        def _minmod(s1, s2, s3):\n            \"\"\"矢量化的 minmod 函数。\"\"\"\n            # 堆叠以便于进行符号和绝对值操作\n            S = np.stack([s1, s2, s3], axis=0)\n            signs = np.sign(S)\n            \n            # 标记所有符号相同（且非零）的位置\n            mask = (signs[0,:] == signs[1,:])  (signs[1,:] == signs[2,:])\n            \n            result = np.zeros_like(s1)\n            min_abs_S = np.min(np.abs(S), axis=0)\n            \n            # 仅在符号匹配处应用 minmod 逻辑\n            result[mask] = signs[0, mask] * min_abs_S[mask]\n            return result\n\n        def _apply_limiter(self, c):\n            \"\"\"对系数应用 TVB 限制器。\"\"\"\n            c_limited = c.copy()\n            Mh2 = self.M * self.h**2\n\n            # 限制二次项系数 c_2\n            mask_c2 = np.abs(c[:, 2]) > Mh2\n            c_limited[mask_c2, 2] = 0.0\n\n            # 限制一次项系数 c_1\n            # 获取相邻单元的平均值\n            u_bar = c[:, 0]\n            u_bar_left = np.roll(u_bar, 1)\n            u_bar_right = np.roll(u_bar, -1)\n\n            s1 = c[:, 1]\n            s2 = 0.5 * (u_bar_right - u_bar)\n            s3 = 0.5 * (u_bar - u_bar_left)\n\n            c1_minmod = self._minmod(s1, s2, s3)\n            \n            mask_c1 = np.abs(c[:, 1]) > Mh2\n            c_limited[mask_c1, 1] = c1_minmod[mask_c1]\n\n            return c_limited\n\n        def _calculate_residual(self, c):\n            \"\"\"计算半离散残差 R(u)。\"\"\"\n            \n            # 计算所有单元在 xi=+/-1 处的迹\n            u_minus = c @ self.P_minus1 # u_j^-\n            u_plus = c @ self.P_plus1   # u_j^+\n\n            # 获取周期性边界条件下的相邻单元迹\n            u_left_neighbor_plus = np.roll(u_plus, 1)  # u_{j-1}^+\n            u_right_neighbor_minus = np.roll(u_minus, -1) # u_{j+1}^-\n\n            # 数值通量 F^*(u_L, u_R) = 0.5*(a*u_L + a*u_R) - 0.5*alpha*(u_R - u_L)\n            # 单元 j 左侧界面的通量：F_L = F^*(u_{j-1}^+, u_j^-)\n            F_L = 0.5 * (self.a * u_left_neighbor_plus + self.a * u_minus) - \\\n                  0.5 * self.alpha * (u_minus - u_left_neighbor_plus)\n\n            # 单元 j 右侧界面的通量：F_R = F^*(u_j^+, u_{j+1}^-)\n            F_R = 0.5 * (self.a * u_plus + self.a * u_right_neighbor_minus) - \\\n                  0.5 * self.alpha * (u_right_neighbor_minus - u_plus)\n\n            # 体积项 V = a * [0, 2*c0, 2*c1]^T\n            V = np.zeros_like(c)\n            V[:, 1] = self.a * 2 * c[:, 0]\n            V[:, 2] = self.a * 2 * c[:, 1]\n            \n            # 边界项 B = [F_L-F_R, -F_L-F_R, F_L-F_R]^T\n            B = np.zeros_like(c)\n            B[:, 0] = F_L - F_R\n            B[:, 1] = -F_L - F_R\n            B[:, 2] = F_L - F_R\n\n            # 残差 r = M_inv * (V + B)\n            r = self.M_inv_diag * (V + B)\n            return r\n\n        def run_ssp_step(self):\n            \"\"\"执行一个 SSP-RK3 步骤并返回所需的残差范数。\"\"\"\n            u_n = self.c0\n            \n            # 阶段 1\n            R_n = self._calculate_residual(u_n)\n            u1_unlim = u_n + self.dt * R_n\n            u1 = self._apply_limiter(u1_unlim)\n            R_u1 = self._calculate_residual(u1)\n            norm_R1 = np.linalg.norm(R_u1)\n            \n            # 阶段 2\n            u2_unlim = 0.75 * u_n + 0.25 * (u1 + self.dt * R_u1)\n            u2 = self._apply_limiter(u2_unlim)\n            R_u2 = self._calculate_residual(u2)\n            norm_R2 = np.linalg.norm(R_u2)\n            \n            # 阶段 3\n            u3_unlim = (1.0/3.0) * u_n + (2.0/3.0) * (u2 + self.dt * R_u2)\n            u3 = self._apply_limiter(u3_unlim)\n            R_u3 = self._calculate_residual(u3)\n            norm_R3 = np.linalg.norm(R_u3)\n            \n            return norm_R1, norm_R2, norm_R3\n\n    # 定义初始条件\n    def u0_case1(x):\n        return 1.0 if x % 1.0  0.5 else 0.0\n\n    def u0_case2(x):\n        return 0.5\n    \n    def u0_case3(x):\n        return np.sin(10 * np.pi * x) + 0.5 * np.sin(20 * np.pi * x)\n\n    test_cases = [\n        {'N': 80, 'a': 1.0, 'CFL': 0.1, 'M': 0.0, 'u0_func': u0_case1},\n        {'N': 60, 'a': 1.0, 'CFL': 0.1, 'M': 0.0, 'u0_func': u0_case2},\n        {'N': 40, 'a': 1.0, 'CFL': 0.1, 'M': 0.0, 'u0_func': u0_case3},\n    ]\n\n    results = []\n    for params in test_cases:\n        solver = DGSolver(**params)\n        norm1, norm2, norm3 = solver.run_ssp_step()\n\n        # 检查单调性\n        # 对浮点数比较使用一个小的容差\n        tol = 1e-12\n        is_monotone = (norm1 >= norm2 - tol) and (norm2 >= norm3 - tol)\n        \n        # 计算比率 rho\n        if abs(norm1)  1e-14: # 问题约定的除零情况\n            rho = norm3\n        else:\n            rho = norm3 / norm1\n        \n        results.append(str(is_monotone))\n        results.append(f\"{rho:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}