{
    "hands_on_practices": [
        {
            "introduction": "Modified wavenumber analysis is the primary tool for quantifying how a numerical scheme distorts the propagation of waves. This first exercise  serves as a fundamental starting point, where you will apply the core definition to two of the most common stencils used in CFD: the second- and fourth-order central differences. By calculating their performance at the grid's resolution limit, you will uncover a critical limitation shared by these schemes.",
            "id": "3976409",
            "problem": "A one-dimensional, spatially periodic scalar field in Computational Fluid Dynamics (CFD) is sampled on a uniform grid with spacing $\\Delta x$. To analyze the dispersion characteristics of discrete spatial differentiation operators using modified wavenumber analysis, consider the action of two centered finite-difference stencils that approximate the first spatial derivative $\\partial u/\\partial x$ at interior grid points:\n- Second-order centered difference: $D^{(2)} u_{j} = \\left(u_{j+1} - u_{j-1}\\right)/(2 \\Delta x)$.\n- Fourth-order centered difference: $D^{(4)} u_{j} = \\left(-u_{j+2} + 8 u_{j+1} - 8 u_{j-1} + u_{j-2}\\right)/(12 \\Delta x)$.\n\nLet a discrete Fourier mode be $u_{j} = \\exp\\!\\left(i \\kappa j\\right)$, where the nondimensional wavenumber is $\\kappa = k \\Delta x$ and $k$ is the physical wavenumber. The modified wavenumber $\\tilde{k}(\\kappa)$ is defined by the relation $D u_{j} = i \\tilde{k}(\\kappa)\\, u_{j}$ for each stencil $D$ acting on $u_{j}$.\n\nStarting from this definition and the stencils above, and using only fundamental sampling arguments and Fourier mode properties as the base, do the following:\n1) Determine the Nyquist wavenumber $k_{N}$ for the grid. Justify your result based on the minimum sampling requirement for a resolvable sinusoid. Report $k_{N}$ symbolically in terms of $\\Delta x$.\n2) Evaluate the phase error magnitude at the nondimensional Nyquist mode $\\kappa = \\pi$, defined as $\\left|\\operatorname{Re}\\tilde{k}(\\kappa) - k\\right|/k$, for each stencil. Here $\\operatorname{Re}\\tilde{k}$ denotes the real part of $\\tilde{k}$. Express each phase error as an exact number without rounding.\n\nExpress your final answer as a single row matrix $\\left[k_{N}, E_{2}, E_{4}\\right]$, where $E_{2}$ and $E_{4}$ are the phase error magnitudes at $\\kappa=\\pi$ for the second-order and fourth-order centered stencils, respectively. No rounding is required. The quantity $\\kappa$ is dimensionless, and $k_{N}$ must be reported symbolically in terms of $\\Delta x$. The phase error magnitudes are dimensionless.",
            "solution": "The problem requires a two-part analysis of discrete differentiation operators on a uniform grid: first, the determination of the Nyquist wavenumber, and second, the calculation of the phase error for two specific finite-difference stencils at the Nyquist limit.\n\nPart 1: Determination of the Nyquist Wavenumber, $k_N$\n\nThe Nyquist-Shannon sampling theorem is the fundamental principle governing the resolution of a continuous signal sampled at discrete intervals. For a spatially periodic signal, the theorem dictates that a sinusoidal component with a given wavelength, $\\lambda$, can be unambiguously resolved only if the sampling rate is greater than twice its frequency. In the spatial domain, this means we must have at least two sample points per wavelength.\n\nGiven a uniform grid with spacing $\\Delta x$, the minimum sampling condition to resolve a wave of wavenumber $k = 2\\pi/\\lambda$ is:\n$$2 \\Delta x \\le \\lambda$$\nSubstituting $\\lambda = 2\\pi/k$ into the inequality gives:\n$$2 \\Delta x \\le \\frac{2\\pi}{k}$$\n$$k \\Delta x \\le \\pi$$\nThis inequality defines the range of wavenumbers that can be resolved by the grid. The maximum resolvable wavenumber is the Nyquist wavenumber, $k_N$, which corresponds to the case of exactly two sample points per wavelength. This occurs at the upper limit of the inequality:\n$$k_N \\Delta x = \\pi$$\nSolving for $k_N$ gives the Nyquist wavenumber in terms of the grid spacing $\\Delta x$:\n$$k_N = \\frac{\\pi}{\\Delta x}$$\nThe corresponding nondimensional wavenumber is $\\kappa_N = k_N \\Delta x = \\pi$, which represents the highest frequency mode the grid can resolve.\n\nPart 2: Modified Wavenumber Analysis and Phase Error Evaluation\n\nThe modified wavenumber, $\\tilde{k}(\\kappa)$, characterizes how a numerical differentiation scheme acts on a Fourier mode. It is defined by the relation $D u_j = i \\tilde{k}(\\kappa) u_j$, where $u_j = \\exp(i \\kappa j)$ is a discrete Fourier mode, $\\kappa = k \\Delta x$ is the nondimensional wavenumber, and $D$ is the differentiation operator. The exact first derivative of the continuous counterpart, $u(x) = \\exp(ikx)$, is $\\partial u/\\partial x = iku$. The modified wavenumber $\\tilde{k}$ is the numerical scheme's analogue to the exact wavenumber $k$.\n\nWe will now derive the modified wavenumber for each specified stencil.\n\nFor the second-order centered difference stencil, $D^{(2)} u_j = \\frac{u_{j+1} - u_{j-1}}{2 \\Delta x}$:\nWe apply this operator to the mode $u_j = \\exp(i \\kappa j)$.\n$$D^{(2)} u_j = \\frac{\\exp(i \\kappa (j+1)) - \\exp(i \\kappa (j-1))}{2 \\Delta x}$$\nFactoring out $u_j = \\exp(i \\kappa j)$:\n$$D^{(2)} u_j = \\frac{\\exp(i \\kappa j) (\\exp(i \\kappa) - \\exp(-i \\kappa))}{2 \\Delta x} = u_j \\frac{\\exp(i \\kappa) - \\exp(-i \\kappa)}{2 \\Delta x}$$\nUsing Euler's formula, $\\sin(\\theta) = (\\exp(i\\theta) - \\exp(-i\\theta))/(2i)$, we have $\\exp(i\\kappa) - \\exp(-i\\kappa) = 2i\\sin(\\kappa)$.\n$$D^{(2)} u_j = u_j \\frac{2i\\sin(\\kappa)}{2 \\Delta x} = i \\left( \\frac{\\sin(\\kappa)}{\\Delta x} \\right) u_j$$\nBy comparing this with the definition $D^{(2)} u_j = i \\tilde{k}^{(2)}(\\kappa) u_j$, we identify the modified wavenumber for the second-order scheme:\n$$\\tilde{k}^{(2)}(\\kappa) = \\frac{\\sin(\\kappa)}{\\Delta x}$$\n\nFor the fourth-order centered difference stencil, $D^{(4)} u_j = \\frac{-u_{j+2} + 8 u_{j+1} - 8 u_{j-1} + u_{j-2}}{12 \\Delta x}$:\nApplying this operator to $u_j$:\n$$D^{(4)} u_j = \\frac{-\\exp(i \\kappa (j+2)) + 8\\exp(i \\kappa (j+1)) - 8\\exp(i \\kappa (j-1)) + \\exp(i \\kappa (j-2))}{12 \\Delta x}$$\nFactoring out $u_j = \\exp(i \\kappa j)$:\n$$D^{(4)} u_j = u_j \\frac{-\\exp(i 2\\kappa) + 8\\exp(i \\kappa) - 8\\exp(-i \\kappa) + \\exp(-i 2\\kappa)}{12 \\Delta x}$$\nGrouping terms:\n$$D^{(4)} u_j = u_j \\frac{8(\\exp(i \\kappa) - \\exp(-i \\kappa)) - (\\exp(i 2\\kappa) - \\exp(-i 2\\kappa))}{12 \\Delta x}$$\nUsing the identity $2i\\sin(n\\theta) = \\exp(in\\theta) - \\exp(-in\\theta)$:\n$$D^{(4)} u_j = u_j \\frac{8(2i\\sin(\\kappa)) - (2i\\sin(2\\kappa))}{12 \\Delta x} = i \\left( \\frac{16\\sin(\\kappa) - 2\\sin(2\\kappa)}{12 \\Delta x} \\right) u_j$$\nSimplifying the expression:\n$$D^{(4)} u_j = i \\left( \\frac{8\\sin(\\kappa) - \\sin(2\\kappa)}{6 \\Delta x} \\right) u_j$$\nBy comparing this with the definition $D^{(4)} u_j = i \\tilde{k}^{(4)}(\\kappa) u_j$, we identify the modified wavenumber for the fourth-order scheme:\n$$\\tilde{k}^{(4)}(\\kappa) = \\frac{8\\sin(\\kappa) - \\sin(2\\kappa)}{6 \\Delta x}$$\n\nNow, we evaluate the phase error magnitude at the nondimensional Nyquist mode, $\\kappa = \\pi$. The phase error magnitude is defined as $E = |\\operatorname{Re}\\tilde{k}(\\kappa) - k|/k$. At $\\kappa=\\pi$, the exact wavenumber is the Nyquist wavenumber, $k = k_N = \\pi/\\Delta x$. For both centered-difference stencils, the derived modified wavenumbers $\\tilde{k}^{(2)}$ and $\\tilde{k}^{(4)}$ are purely real functions, so $\\operatorname{Re}\\tilde{k} = \\tilde{k}$.\n\nFor the second-order stencil, the phase error $E_2$ at $\\kappa = \\pi$ is:\nFirst, we evaluate the modified wavenumber:\n$$\\tilde{k}^{(2)}(\\pi) = \\frac{\\sin(\\pi)}{\\Delta x} = \\frac{0}{\\Delta x} = 0$$\nThen we calculate the error:\n$$E_2 = \\frac{|\\tilde{k}^{(2)}(\\pi) - k_N|}{k_N} = \\frac{|0 - \\pi/\\Delta x|}{\\pi/\\Delta x} = \\frac{\\pi/\\Delta x}{\\pi/\\Delta x} = 1$$\n\nFor the fourth-order stencil, the phase error $E_4$ at $\\kappa = \\pi$ is:\nFirst, we evaluate the modified wavenumber:\n$$\\tilde{k}^{(4)}(\\pi) = \\frac{8\\sin(\\pi) - \\sin(2\\pi)}{6 \\Delta x} = \\frac{8(0) - 0}{6 \\Delta x} = 0$$\nThen we calculate the error:\n$$E_4 = \\frac{|\\tilde{k}^{(4)}(\\pi) - k_N|}{k_N} = \\frac{|0 - \\pi/\\Delta x|}{\\pi/\\Delta x} = \\frac{\\pi/\\Delta x}{\\pi/\\Delta x} = 1$$\nBoth stencils yield a modified wavenumber of zero for the $2\\Delta x$ wave (the mode at $\\kappa=\\pi$), meaning they fail to detect any gradient for the highest resolvable frequency. This results in a phase error of $100\\%$ for both schemes.\n\nThe final answer is the row matrix $\\left[k_{N}, E_{2}, E_{4}\\right]$, where $k_N = \\pi/\\Delta x$, $E_2 = 1$, and $E_4 = 1$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\pi}{\\Delta x}  1  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having seen how numerical schemes introduce error, a natural question arises: can a scheme ever be perfectly accurate for a non-trivial wave? This exercise  challenges you to explore this question by rigorously determining for which wavenumbers the popular fourth-order central difference scheme exhibits precisely zero dispersion error. The solution requires a careful analytical argument that reveals a deep property about the nature of such schemes.",
            "id": "3976448",
            "problem": "Consider the one-dimensional linear advection equation $\\partial u/\\partial t + a\\,\\partial u/\\partial x = 0$ on a periodic domain, where $a$ is a constant transport speed. Discretize space on a uniform grid with spacing $\\Delta x$ and denote the grid function by $u_{j}(t) \\equiv u(x_{j},t)$ with $x_{j} = j\\,\\Delta x$. Approximate the spatial derivative using the fourth-order central finite difference stencil defined by\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=x_{j}} \\approx \\frac{-\\,u_{j+2} + 8\\,u_{j+1} - 8\\,u_{j-1} + u_{j-2}}{12\\,\\Delta x}.\n$$\nPerform a modified wavenumber analysis in the sense of Computational Fluid Dynamics (CFD): assume a single Fourier mode $u_{j}(t) = \\hat{u}(t)\\,\\exp\\!\\left(i\\,\\kappa\\,j\\right)$ with real, dimensionless wavenumber $\\kappa \\equiv k\\,\\Delta x \\in [-\\pi,\\pi]$, where $k$ is the physical wavenumber, and all angles are measured in radians. Define the normalized modified wavenumber $\\tilde{\\kappa}(\\kappa)$ through the discrete symbol by the relation\n$$\n\\frac{-\\,u_{j+2} + 8\\,u_{j+1} - 8\\,u_{j-1} + u_{j-2}}{12\\,\\Delta x} = i\\,\\frac{\\tilde{\\kappa}(\\kappa)}{\\Delta x}\\,u_{j}.\n$$\nUsing only the above definitions, trigonometric identities, and basic calculus, derive $\\tilde{\\kappa}(\\kappa)$ and determine all $\\kappa \\in [-\\pi,\\pi]$ (in radians) for which the fourth-order central difference yields zero dispersion error, in the precise sense that $\\operatorname{Re}\\tilde{k}(\\kappa) = k$, where $\\tilde{k}(\\kappa) \\equiv \\tilde{\\kappa}(\\kappa)/\\Delta x$ and $k \\equiv \\kappa/\\Delta x$. Your final answer must be the set of such $\\kappa$ collapsed to a single representative value if it is a singleton. Provide a rigorous mathematical justification for your conclusion. The final answer must be a single real number or a single closed-form analytic expression, with no units and in radians. No rounding is required.",
            "solution": "The task is to perform a modified wavenumber analysis for a given fourth-order finite difference scheme and find the specific wavenumbers for which the scheme exhibits zero dispersion error.\n\nFirst, we derive the expression for the normalized modified wavenumber $\\tilde{\\kappa}(\\kappa)$. The analysis begins with the definition provided in the problem statement, which relates the finite difference operator to the symbol of the differentiation operator in Fourier space:\n$$\n\\frac{-\\,u_{j+2} + 8\\,u_{j+1} - 8\\,u_{j-1} + u_{j-2}}{12\\,\\Delta x} = i\\,\\frac{\\tilde{\\kappa}(\\kappa)}{\\Delta x}\\,u_{j}\n$$\nWe substitute the single Fourier mode ansatz, $u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,\\kappa\\,j)$, into the left-hand side of the equation. The terms in the stencil can be expressed relative to $u_j$:\n$u_{j+n} = \\hat{u}(t)\\,\\exp(i\\,\\kappa\\,(j+n)) = \\hat{u}(t)\\,\\exp(i\\,\\kappa\\,j)\\,\\exp(i\\,\\kappa\\,n) = u_j\\,\\exp(i\\,\\kappa\\,n)$.\nApplying this to each term in the numerator of the finite difference operator yields:\n\\begin{itemize}\n    \\item $u_{j+2} = u_j\\,\\exp(i\\,2\\,\\kappa)$\n    \\item $u_{j+1} = u_j\\,\\exp(i\\,\\kappa)$\n    \\item $u_{j-1} = u_j\\,\\exp(-i\\,\\kappa)$\n    \\item $u_{j-2} = u_j\\,\\exp(-i\\,2\\,\\kappa)$\n\\end{itemize}\nSubstituting these into the defining relation:\n$$\n\\frac{-\\,u_j\\,\\exp(i\\,2\\,\\kappa) + 8\\,u_j\\,\\exp(i\\,\\kappa) - 8\\,u_j\\,\\exp(-i\\,\\kappa) + u_j\\,\\exp(-i\\,2\\,\\kappa)}{12\\,\\Delta x} = i\\,\\frac{\\tilde{\\kappa}(\\kappa)}{\\Delta x}\\,u_{j}\n$$\nWe can cancel the common factor $u_j$ (which is non-zero for a non-trivial mode) and the grid spacing $\\Delta x$ from both sides:\n$$\n\\frac{-\\,\\exp(i\\,2\\,\\kappa) + 8\\,\\exp(i\\,\\kappa) - 8\\,\\exp(-i\\,\\kappa) + \\exp(-i\\,2\\,\\kappa)}{12} = i\\,\\tilde{\\kappa}(\\kappa)\n$$\nThe terms can be grouped using Euler's identity, $\\sin(\\theta) = \\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2\\,i}$:\n\\begin{itemize}\n    \\item $\\exp(i\\,\\kappa) - \\exp(-i\\,\\kappa) = 2\\,i\\,\\sin(\\kappa)$\n    \\item $\\exp(i\\,2\\,\\kappa) - \\exp(-i\\,2\\,\\kappa) = 2\\,i\\,\\sin(2\\,\\kappa)$\n\\end{itemize}\nSubstituting these into the equation:\n$$\n\\frac{-(\\exp(i\\,2\\,\\kappa) - \\exp(-i\\,2\\,\\kappa)) + 8\\,(\\exp(i\\,\\kappa) - \\exp(-i\\,\\kappa))}{12} = i\\,\\tilde{\\kappa}(\\kappa)\n$$\n$$\n\\frac{-\\,2\\,i\\,\\sin(2\\,\\kappa) + 8\\,(2\\,i\\,\\sin(\\kappa))}{12} = i\\,\\tilde{\\kappa}(\\kappa)\n$$\n$$\n\\frac{i\\,(16\\,\\sin(\\kappa) - 2\\,\\sin(2\\,\\kappa))}{12} = i\\,\\tilde{\\kappa}(\\kappa)\n$$\nDividing by $i$, we obtain the expression for the normalized modified wavenumber:\n$$\n\\tilde{\\kappa}(\\kappa) = \\frac{16\\,\\sin(\\kappa) - 2\\,\\sin(2\\,\\kappa)}{12} = \\frac{8\\,\\sin(\\kappa) - \\sin(2\\,\\kappa)}{6}\n$$\nThis expression is purely real for any real dimensionless wavenumber $\\kappa$.\n\nNext, we must find all values of $\\kappa \\in [-\\pi,\\pi]$ for which the dispersion error is zero. The condition for zero dispersion error is given as $\\operatorname{Re}\\tilde{k}(\\kappa) = k$. We have the definitions $\\tilde{k}(\\kappa) = \\tilde{\\kappa}(\\kappa)/\\Delta x$ and $k = \\kappa/\\Delta x$.\nSubstituting these into the condition gives:\n$$\n\\operatorname{Re}\\left(\\frac{\\tilde{\\kappa}(\\kappa)}{\\Delta x}\\right) = \\frac{\\kappa}{\\Delta x}\n$$\nSince $\\Delta x$ is a real constant, this simplifies to:\n$$\n\\operatorname{Re}(\\tilde{\\kappa}(\\kappa)) = \\kappa\n$$\nAs we established that $\\tilde{\\kappa}(\\kappa)$ is purely real for real $\\kappa$, its real part is itself, i.e., $\\operatorname{Re}(\\tilde{\\kappa}(\\kappa)) = \\tilde{\\kappa}(\\kappa)$. The condition thus becomes:\n$$\n\\tilde{\\kappa}(\\kappa) = \\kappa\n$$\nSubstituting our derived expression for $\\tilde{\\kappa}(\\kappa)$:\n$$\n\\frac{8\\,\\sin(\\kappa) - \\sin(2\\,\\kappa)}{6} = \\kappa\n$$\nTo find the solutions for $\\kappa$, we can analyze the roots of the function $f(\\kappa)$ defined as:\n$$\nf(\\kappa) = 8\\,\\sin(\\kappa) - \\sin(2\\,\\kappa) - 6\\,\\kappa\n$$\nWe seek $\\kappa \\in [-\\pi,\\pi]$ such that $f(\\kappa) = 0$.\n\nFirst, we test for a trivial solution. For $\\kappa = 0$:\n$$\nf(0) = 8\\,\\sin(0) - \\sin(0) - 6\\,(0) = 8\\,(0) - 0 - 0 = 0\n$$\nThus, $\\kappa = 0$ is a solution.\n\nTo determine if other solutions exist, we analyze the monotonicity of $f(\\kappa)$ by examining its first derivative, $f'(\\kappa)$:\n$$\nf'(\\kappa) = \\frac{d}{d\\kappa}\\left(8\\,\\sin(\\kappa) - \\sin(2\\,\\kappa) - 6\\,\\kappa\\right) = 8\\,\\cos(\\kappa) - 2\\,\\cos(2\\,\\kappa) - 6\n$$\nUsing the double-angle identity for cosine, $\\cos(2\\,\\kappa) = 2\\,\\cos^2(\\kappa) - 1$:\n$$\nf'(\\kappa) = 8\\,\\cos(\\kappa) - 2\\,(2\\,\\cos^2(\\kappa) - 1) - 6\n$$\n$$\nf'(\\kappa) = 8\\,\\cos(\\kappa) - 4\\,\\cos^2(\\kappa) + 2 - 6\n$$\n$$\nf'(\\kappa) = -4\\,\\cos^2(\\kappa) + 8\\,\\cos(\\kappa) - 4\n$$\nFactoring out $-4$:\n$$\nf'(\\kappa) = -4\\,(\\cos^2(\\kappa) - 2\\,\\cos(\\kappa) + 1)\n$$\nThe expression in the parenthesis is a perfect square, $(\\cos(\\kappa) - 1)^2$. So, the derivative is:\n$$\nf'(\\kappa) = -4\\,(\\cos(\\kappa) - 1)^2\n$$\nFor any real $\\kappa$, the term $(\\cos(\\kappa) - 1)^2$ is always non-negative. Therefore, $f'(\\kappa) \\le 0$ for all $\\kappa$. This means that $f(\\kappa)$ is a monotonically non-increasing function.\n\nWe now check where the derivative is exactly zero. $f'(\\kappa) = 0$ if and only if $(\\cos(\\kappa) - 1)^2 = 0$, which implies $\\cos(\\kappa) = 1$. In the specified interval $\\kappa \\in [-\\pi, \\pi]$, this occurs only at $\\kappa = 0$.\nFor any $\\kappa \\in [-\\pi, \\pi]$ where $\\kappa \\ne 0$, we have $\\cos(\\kappa)  1$, which means $(\\cos(\\kappa) - 1)^2  0$, and thus $f'(\\kappa)  0$.\n\nThis implies that $f(\\kappa)$ is strictly decreasing on the intervals $[-\\pi, 0)$ and $(0, \\pi]$. Since we have found that $f(0) = 0$, and the function is strictly decreasing away from $\\kappa = 0$, there can be no other roots.\nFor any $\\kappa_1 \\in (0, \\pi]$, we must have $f(\\kappa_1)  f(0) = 0$.\nFor any $\\kappa_2 \\in [-\\pi, 0)$, we must have $f(\\kappa_2)  f(0) = 0$.\nTherefore, the only value of $\\kappa$ in the interval $[-\\pi, \\pi]$ for which $f(\\kappa) = 0$ is $\\kappa = 0$.\n\nThe set of wavenumbers for which there is zero dispersion error is the singleton set $\\{0\\}$. As requested, this is collapsed to a single representative value.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "This final practice transitions from analyzing pre-defined schemes to the engineering task of creating new ones. In this comprehensive exercise , you will act as a methods developer, using the principles of modified wavenumber analysis to design an optimized finite-difference stencil by minimizing its integrated error. You will then assess the practicality of your design by performing a sensitivity study, a crucial step in developing robust numerical tools for real-world applications.",
            "id": "3976394",
            "problem": "You are to perform a sensitivity study of optimized symmetric explicit finite-difference stencil coefficients for the first spatial derivative using modified wavenumber analysis, a tool widely used in Computational Fluid Dynamics (CFD). Consider a linear, shift-invariant, symmetric, explicit stencil of radius $M$ that approximates $\\frac{\\partial f}{\\partial x}$ at grid point $i$ by\n$$\n\\left.\\frac{\\partial f}{\\partial x}\\right|_{x_i} \\approx \\frac{1}{\\Delta x}\\sum_{m=1}^{M} c_m \\left(f_{i+m} - f_{i-m}\\right),\n$$\nwhere $\\Delta x$ is the grid spacing in meters, and $\\{c_m\\}_{m=1}^{M}$ are dimensionless stencil coefficients. For a pure Fourier mode $f(x) = e^{i k x}$ with angular wavenumber $k$ in radians per meter, the discrete derivative has a modified nondimensional wavenumber $\\tilde{\\kappa}(\\kappa)$ defined by\n$$\n\\tilde{\\kappa}(\\kappa) = 2 \\sum_{m=1}^{M} c_m \\sin(m \\kappa),\n$$\nwhere $\\kappa = k \\Delta x$ is the nondimensional wavenumber in radians. The exact nondimensional wavenumber is $\\kappa$. The scheme is consistent if and only if\n$$\n2\\sum_{m=1}^{M} m c_m = 1.\n$$\n\nDefine an optimization problem for a given physical target cutoff wavenumber $k_c$ (in radians per meter) and grid spacing $\\Delta x$ (in meters). Let $K = k_c \\Delta x$ denote the nondimensional cutoff in radians. Choose coefficients $\\{c_m\\}$ to minimize the integrated squared dispersion error over the band $[0,K]$,\n$$\n\\mathcal{E}(\\mathbf{c};K) = \\int_{0}^{K} \\left(\\tilde{\\kappa}(\\kappa) - \\kappa \\right)^2 \\, \\mathrm{d}\\kappa,\n$$\nsubject to the linear consistency constraint $2\\sum_{m=1}^{M} m c_m = 1$. Assume $M=3$ fixed for all computations.\n\nTasks to implement:\n1. Starting from Fourier analysis of linear shift-invariant operators and the definition of $\\tilde{\\kappa}(\\kappa)$, derive the quadratic form of $\\mathcal{E}(\\mathbf{c};K)$ in terms of $\\mathbf{c}$, identifying the symmetric positive semidefinite matrix of inner products and the linear term that depends on $K$. Use exact analytic integration over $\\kappa \\in [0,K]$ and enforce the consistency constraint via a Lagrange multiplier. Your algorithm must solve the resulting Karush–Kuhn–Tucker (KKT) linear system to obtain the optimal $\\mathbf{c}(K)$.\n2. Define the sensitivity of the optimized coefficients to changes in the nondimensional cutoff $K$ by the relative $2$-norm sensitivity\n$$\nS(K) = \\frac{\\left\\|\\frac{\\mathrm{d}\\mathbf{c}}{\\mathrm{d}K}\\right\\|_2}{\\left\\|\\mathbf{c}\\right\\|_2} \\, K,\n$$\napproximated numerically by a central finite difference with a symmetric perturbation $\\delta K$,\n$$\n\\frac{\\mathrm{d}\\mathbf{c}}{\\mathrm{d}K} \\approx \\frac{\\mathbf{c}(K+\\delta K) - \\mathbf{c}(K-\\delta K)}{2 \\, \\delta K},\n$$\nwhere you must choose $\\delta K = \\max\\left(10^{-6}, 10^{-3} K\\right)$.\n3. Define a robustness decision rule as follows: the optimized stencil at a given $K$ is robust if and only if $S(K) \\leq T$, with a fixed threshold $T = 0.5$.\n4. Implement all computations in a single program and apply them to the following test suite. Each test case provides $(k_c, \\Delta x)$, where $k_c$ is in radians per meter and $\\Delta x$ is in meters:\n   - Case $1$: $k_c = 20$, $\\Delta x = 0.005$.\n   - Case $2$: $k_c = 100$, $\\Delta x = 0.005$.\n   - Case $3$: $k_c = 250$, $\\Delta x = 0.01$.\n   - Case $4$: $k_c = 300$, $\\Delta x = 0.01$.\n   For each case, compute $K = k_c \\Delta x$ in radians, the optimized coefficients for $M=3$, the sensitivity $S(K)$, and the robustness flag using the rule above.\n\nAngle unit requirement: treat all wavenumber angles $\\kappa$ and $K$ in radians.\n\nFinal output format:\n- Your program must produce a single line of output containing a Python-style list with one entry per test case, in the same order as listed. Each entry must itself be a list of two elements: the sensitivity as a float rounded to six decimal places, and the robustness decision as a boolean. For example, a valid output with two cases looks like\n`\"[ [0.123456,True],[0.654321,False] ]\"` though your program must print the values corresponding to the four specified cases above.\n\nNotes:\n- There are no other units required in the output because the sensitivity $S(K)$ is dimensionless and the robustness flag is a boolean.\n- Ensure your implementation is general with respect to $K$ and uses the exact analytic integrals for the quadratic form.",
            "solution": "Herein, we derive the solution for optimizing and analyzing the sensitivity of finite-difference coefficients. The stencil radius is fixed at $M=3$. The coefficients are denoted by the vector $\\mathbf{c} = [c_1, c_2, c_3]^T$.\n\nThe core of the problem is to minimize the integrated squared dispersion error,\n$$\n\\mathcal{E}(\\mathbf{c};K) = \\int_{0}^{K} \\left(\\tilde{\\kappa}(\\kappa) - \\kappa \\right)^2 \\, \\mathrm{d}\\kappa,\n$$\nsubject to the consistency constraint $2\\sum_{m=1}^{3} m c_m = 1$. The modified nondimensional wavenumber is $\\tilde{\\kappa}(\\kappa) = 2 \\sum_{m=1}^{3} c_m \\sin(m \\kappa)$.\n\nFirst, we expand the integrand to express $\\mathcal{E}$ as a quadratic function of the coefficients $\\mathbf{c}$:\n$$\n\\mathcal{E}(\\mathbf{c};K) = \\int_{0}^{K} \\left[ \\left(2 \\sum_{m=1}^{3} c_m \\sin(m \\kappa)\\right)^2 - 4\\kappa \\sum_{m=1}^{3} c_m \\sin(m \\kappa) + \\kappa^2 \\right] \\, \\mathrm{d}\\kappa.\n$$\nExpanding the sums and interchanging summation and integration yields the quadratic form:\n$$\n\\mathcal{E}(\\mathbf{c};K) = \\sum_{m=1}^{3} \\sum_{n=1}^{3} c_m c_n \\left( 4 \\int_{0}^{K} \\sin(m\\kappa)\\sin(n\\kappa) \\, \\mathrm{d}\\kappa \\right) - \\sum_{m=1}^{3} c_m \\left( 4 \\int_{0}^{K} \\kappa \\sin(m\\kappa) \\, \\mathrm{d}\\kappa \\right) + \\int_{0}^{K} \\kappa^2 \\, \\mathrm{d}\\kappa.\n$$\nThis can be written in matrix-vector notation as $\\mathcal{E}(\\mathbf{c}) = \\mathbf{c}^T \\mathbf{A} \\mathbf{c} - \\mathbf{b}^T \\mathbf{c} + d$, where the constant term $d$ does not affect the optimization. The components of the symmetric matrix $\\mathbf{A}(K)$ and the vector $\\mathbf{b}(K)$ are defined by the integrals.\n\nThe entries $A_{mn}$ of the $3 \\times 3$ matrix $\\mathbf{A}$ are given by $A_{mn} = 4 \\int_{0}^{K} \\sin(m\\kappa)\\sin(n\\kappa) \\, \\mathrm{d}\\kappa$. Using the trigonometric identity $\\sin(\\alpha)\\sin(\\beta) = \\frac{1}{2}[\\cos(\\alpha-\\beta) - \\cos(\\alpha+\\beta)]$, we find the analytic integral:\nFor $m=n$:\n$$\nA_{mm} = 4 \\int_{0}^{K} \\sin^2(m\\kappa) \\, \\mathrm{d}\\kappa = 2 \\int_{0}^{K} (1 - \\cos(2m\\kappa)) \\, \\mathrm{d}\\kappa = 2 \\left[\\kappa - \\frac{\\sin(2m\\kappa)}{2m}\\right]_0^K = 2K - \\frac{\\sin(2mK)}{m}.\n$$\nFor $m \\neq n$:\n$$\nA_{mn} = 2 \\int_{0}^{K} (\\cos((m-n)\\kappa) - \\cos((m+n)\\kappa)) \\, \\mathrm{d}\\kappa = 2 \\left[\\frac{\\sin((m-n)\\kappa)}{m-n} - \\frac{\\sin((m+n)\\kappa)}{m+n}\\right]_0^K = 2 \\left(\\frac{\\sin((m-n)K)}{m-n} - \\frac{\\sin((m+n)K)}{m+n}\\right).\n$$\n\nThe entries $b_m$ of the vector $\\mathbf{b}$ are given by $b_m = 4 \\int_{0}^{K} \\kappa\\sin(m\\kappa) \\, \\mathrm{d}\\kappa$. Using integration by parts, we find:\n$$\nb_m = 4 \\left[\\frac{\\sin(m\\kappa)}{m^2} - \\frac{\\kappa\\cos(m\\kappa)}{m}\\right]_0^K = 4\\left(\\frac{\\sin(mK)}{m^2} - \\frac{K\\cos(mK)}{m}\\right).\n$$\n\nThe optimization problem is a constrained quadratic minimization:\nMinimize $f(\\mathbf{c}) = \\mathbf{c}^T \\mathbf{A} \\mathbf{c} - \\mathbf{b}^T \\mathbf{c}$ subject to $\\mathbf{g}^T \\mathbf{c} = 1$, where the constraint vector is $\\mathbf{g} = [2, 4, 6]^T$.\nWe solve this using the method of Lagrange multipliers. The Lagrangian is $\\mathcal{L}(\\mathbf{c}, \\mu) = \\mathbf{c}^T \\mathbf{A} \\mathbf{c} - \\mathbf{b}^T \\mathbf{c} + \\mu (\\mathbf{g}^T \\mathbf{c} - 1)$. The Karush-Kuhn-Tucker (KKT) conditions are obtained by setting the gradients to zero:\n$$\n\\nabla_{\\mathbf{c}} \\mathcal{L} = 2\\mathbf{A}\\mathbf{c} - \\mathbf{b} + \\mu \\mathbf{g} = \\mathbf{0}\n$$\n$$\n\\nabla_{\\mu} \\mathcal{L} = \\mathbf{g}^T\\mathbf{c} - 1 = 0\n$$\nThis can be expressed as a single $(M+1) \\times (M+1)$ block matrix system:\n$$\n\\begin{pmatrix}\n2\\mathbf{A}  \\mathbf{g} \\\\\n\\mathbf{g}^T  0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{c} \\\\\n\\mu\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{b} \\\\\n1\n\\end{pmatrix}\n$$\nThis $4 \\times 4$ linear system is solved numerically for the augmented vector $[\\mathbf{c}, \\mu]^T$ to find the optimal coefficients $\\mathbf{c}(K)$ for a given nondimensional cutoff $K$.\n\nThe sensitivity $S(K)$ of the coefficients to changes in $K$ is defined as:\n$$\nS(K) = \\frac{\\left\\|\\frac{\\mathrm{d}\\mathbf{c}}{\\mathrm{d}K}\\right\\|_2}{\\left\\|\\mathbf{c}\\right\\|_2} \\, K.\n$$\nThe derivative $\\frac{\\mathrm{d}\\mathbf{c}}{\\mathrm{d}K}$ is approximated using a second-order central finite difference scheme:\n$$\n\\frac{\\mathrm{d}\\mathbf{c}}{\\mathrm{d}K} \\approx \\frac{\\mathbf{c}(K+\\delta K) - \\mathbf{c}(K-\\delta K)}{2 \\, \\delta K},\n$$\nwith a specified step size $\\delta K = \\max(10^{-6}, 10^{-3} K)$. This requires computing the optimal coefficients $\\mathbf{c}$ at three points: $K$, $K+\\delta K$, and $K-\\delta K$.\n\nThe robustness of the stencil at a given $K$ is determined by a simple threshold rule: the stencil is robust if and only if its sensitivity $S(K)$ is less than or equal to a threshold $T=0.5$.\n\nThe overall algorithmic design for each test case $(k_c, \\Delta x)$ is as follows:\n1.  Calculate the nondimensional cutoff wavenumber $K = k_c \\Delta x$.\n2.  Determine the perturbation step size $\\delta K = \\max(10^{-6}, 10^{-3} K)$.\n3.  Implement a function that, for any given $K$, constructs the KKT matrix and right-hand side vector using the analytical formulas for $\\mathbf{A}(K)$ and $\\mathbf{b}(K)$, and solves the system to return the optimal coefficient vector $\\mathbf{c}(K)$.\n4.  Call this function three times to obtain $\\mathbf{c}(K)$, $\\mathbf{c}(K+\\delta K)$, and $\\mathbf{c}(K-\\delta K)$.\n5.  Compute the numerical derivative $\\frac{\\mathrm{d}\\mathbf{c}}{\\mathrm{d}K}$ using the finite difference formula.\n6.  Calculate the L2-norms of the derivative vector and the central coefficient vector $\\mathbf{c}(K)$.\n7.  Compute the sensitivity $S(K)$ using its definition.\n8.  Compare $S(K)$ with the threshold $T=0.5$ to determine the boolean robustness flag.\n9.  Format the resulting sensitivity and robustness flag into the required output format.",
            "answer": "```\n[[0.000306,True],[0.040209,True],[1.401828,False],[3.587884,False]]\n```"
        }
    ]
}