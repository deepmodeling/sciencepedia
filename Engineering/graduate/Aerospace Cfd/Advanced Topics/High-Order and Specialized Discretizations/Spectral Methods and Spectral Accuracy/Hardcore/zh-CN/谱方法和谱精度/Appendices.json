{
    "hands_on_practices": [
        {
            "introduction": "为了真正领会谱方法的威力，我们从一个基础练习开始。通过分析周期域上的简单线性平流方程，你将从第一性原理出发构建一个傅里叶伪谱格式。本练习的目标是推导出其离散色散关系，这将揭示一个非凡的性质：对于所有可解的波数，数值格式都能以精确的物理速度传播波，从而不引入任何相位误差。这项练习  揭示了谱方法“谱精度”的根源，并解释了为何它在模拟波传播现象时表现卓越。",
            "id": "3995720",
            "problem": "在航空航天计算流体力学 (CFD) 中，由均匀对流引起的被动标量输运通过线性平流方程 $u_{t} + c\\,u_{x} = 0$ 进行建模。该方程描述了在域 $[0,2\\pi]$ 上具有周期性边界条件的空间周期场 $u(x,t)$，其中平流速度 $c>0$ 为常数。考虑在 $N$ 个等距配置点 $x_{j} = \\frac{2\\pi j}{N}$ (其中 $j=0,1,\\dots,N-1$) 上构造傅里叶伪谱法。其中，空间导数的计算方法是：将节点值映射到傅里叶空间，对所有可分辨模式应用精确的谱微分，然后映射回物理空间。\n\n从 $[0,2\\pi]$ 上周期函数的基本定义以及复傅里叶模式作为微分算子本征函数的性质出发，为节点值 $u_{j}(t) \\equiv u(x_{j},t)$ 构造半离散傅里叶伪谱格式，不引入任何时间离散化。然后，通过分析单个可分辨的离散傅里叶模式的演化，确定精确的离散色散关系，表示为角频率 $\\omega_{h}$ 关于整数空间波数 $\\kappa$ 和速度 $c$ 的函数。\n\n请以 $\\omega_{h}$ 关于 $\\kappa$ 和 $c$ 的单个闭式表达式的形式提供您的最终答案。无需四舍五入，且表达式中不包含任何物理单位。",
            "solution": "该问题陈述经核实具有科学依据、适定且客观。它代表了使用谱方法进行偏微分方程数值分析的一个基本练习。因此，我们可以着手求解。\n\n该问题要求两件事：首先，为线性平流方程构造半离散傅里叶伪谱格式；其次，确定该格式的离散色散关系。\n\n控制方程是线性平流方程：\n$$\nu_{t} + c\\,u_{x} = 0\n$$\n其中 $u(x,t)$ 是在域 $x \\in [0, 2\\pi]$ 上的空间周期函数，而 $c>0$ 是恒定的平流速度。\n\n傅里叶伪谱法使用 $N$ 个等距配置点 $x_{j} = \\frac{2\\pi j}{N}$（其中 $j=0, 1, \\dots, N-1$）将空间域离散化。在这些点上的解表示为 $u_{j}(t) \\equiv u(x_{j},t)$。该方法的核心是使用离散傅里叶变换 (DFT) 将物理空间节点值 $\\{u_{j}(t)\\}$ 与一组有限的傅里叶系数 $\\{\\hat{u}_{\\kappa}(t)\\}$ 联系起来。\n\n在这些网格点上定义的函数可以用有限傅里叶级数表示，也称为离散傅里叶展开或插值函数：\n$$\nu_{j}(t) = \\sum_{\\kappa \\in K} \\hat{u}_{\\kappa}(t) \\exp(i\\kappa x_{j})\n$$\n其中 $K$ 是可分辨的整数波数的集合。对于偶数个点 $N$，该集合通常选择为 $K = \\{-\\frac{N}{2}, \\dots, \\frac{N}{2}-1\\}$。傅里叶系数 $\\hat{u}_{\\kappa}(t)$ 由正向 DFT 给出：\n$$\n\\hat{u}_{\\kappa}(t) = \\frac{1}{N} \\sum_{j=0}^{N-1} u_{j}(t) \\exp(-i\\kappa x_{j})\n$$\n\n问题陈述指出，空间导数 $u_{x}$ 是通过在傅里叶空间中应用精确的谱微分来计算的。该过程包括三个步骤：\n1.  使用 DFT 将节点值 $u_{j}(t)$ 变换为其傅里叶系数 $\\hat{u}_{\\kappa}(t)$。\n2.  单个傅里叶模式 $\\exp(i\\kappa x)$ 的精确导数是 $(i\\kappa)\\exp(i\\kappa x)$。因此，谱空间中的微分对应于将每个傅里叶系数 $\\hat{u}_{\\kappa}(t)$ 乘以其对应的因子 $i\\kappa$。设导数的傅里叶系数为 $\\widehat{(u_{x})}_{\\kappa}$。那么，对于每个可分辨模式 $\\kappa \\in K$，我们有：\n    $$\n    \\widehat{(u_{x})}_{\\kappa}(t) = i\\kappa \\, \\hat{u}_{\\kappa}(t)\n    $$\n3.  使用逆 DFT 将新的系数 $\\widehat{(u_{x})}_{\\kappa}(t)$ 变换回物理空间，以获得导数的节点值，我们将其表示为 $(u_{x})_{j}$：\n    $$\n    (u_{x})_{j} \\equiv \\frac{\\partial u}{\\partial x}\\bigg|_{x=x_j} \\approx \\sum_{\\kappa \\in K} \\widehat{(u_{x})}_{\\kappa}(t) \\exp(i\\kappa x_{j}) = \\sum_{\\kappa \\in K} (i\\kappa \\, \\hat{u}_{\\kappa}(t)) \\exp(i\\kappa x_{j})\n    $$\n\n这就完成了空间导数近似的构造。通过将此近似代入每个配置点 $x_{j}$ 处的控制偏微分方程，形成半离散格式：\n$$\n\\frac{d u_{j}(t)}{dt} + c (u_{x})_{j} = 0\n$$\n代入 $(u_{x})_{j}$ 的表达式：\n$$\n\\frac{d u_{j}(t)}{dt} + c \\sum_{\\kappa \\in K} (i\\kappa \\, \\hat{u}_{\\kappa}(t)) \\exp(i\\kappa x_{j}) = 0, \\quad \\text{for } j=0, 1, \\dots, N-1\n$$\n这是一个关于节点值 $u_{j}(t)$ 的 $N$ 个耦合常微分方程(ODEs)组。这就是半离散傅里叶伪谱格式。\n\n接下来，我们通过分析单个可分辨的离散傅里叶模式的演化来确定离散色散关系。让我们假设解是具有整数波数 $\\kappa_{0} \\in K$ 的单个模式：\n$$\nu_{j}(t) = A(t) \\exp(i\\kappa_{0} x_{j})\n$$\n其中 $A(t)$ 是随时间变化的振幅。为了继续进行，我们可以完全在傅里叶空间中进行分析，这简化了分析过程。将 DFT 应用于半离散 ODE 系统可以使方程解耦。傅里叶系数 $\\hat{u}_{\\kappa}(t)$ 的时间导数是：\n$$\n\\frac{d\\hat{u}_{\\kappa}(t)}{dt} = \\frac{1}{N} \\sum_{j=0}^{N-1} \\frac{du_{j}(t)}{dt} \\exp(-i\\kappa x_{j})\n$$\n代入 $\\frac{du_{j}(t)}{dt} = -c(u_{x})_{j}$：\n$$\n\\frac{d\\hat{u}_{\\kappa}(t)}{dt} = -c \\left( \\frac{1}{N} \\sum_{j=0}^{N-1} (u_{x})_{j} \\exp(-i\\kappa x_{j}) \\right)\n$$\n根据定义，括号中的项是 $(u_{x})_{j}$ 的正向 DFT，也就是傅里叶系数 $\\widehat{(u_{x})}_{\\kappa}(t)$。因此，傅里叶空间中的 ODE 系统为：\n$$\n\\frac{d\\hat{u}_{\\kappa}(t)}{dt} = -c \\, \\widehat{(u_{x})}_{\\kappa}(t)\n$$\n使用关系式 $\\widehat{(u_{x})}_{\\kappa}(t) = i\\kappa \\, \\hat{u}_{\\kappa}(t)$，我们为每个傅里叶系数获得一个解耦的 ODE：\n$$\n\\frac{d\\hat{u}_{\\kappa}(t)}{dt} = -c (i\\kappa) \\hat{u}_{\\kappa}(t) = -ic\\kappa \\, \\hat{u}_{\\kappa}(t)\n$$\n这个方程描述了波数为 $\\kappa$ 的傅里叶模式振幅的演化。此 ODE 的解为：\n$$\n\\hat{u}_{\\kappa}(t) = \\hat{u}_{\\kappa}(0) \\exp(-ic\\kappa t)\n$$\n一个一般的离散平面波解写为 $u_{j}(t) \\propto \\exp(i(\\kappa x_{j} - \\omega_{h} t))$ 的形式，其中 $\\omega_{h}$ 是离散角频率。相应傅里叶系数的时间演化是 $\\hat{u}_{\\kappa}(t) \\propto \\exp(-i\\omega_{h} t)$。\n\n通过将这种一般形式与我们导出的解 $\\hat{u}_{\\kappa}(t) = \\hat{u}_{\\kappa}(0) \\exp(-ic\\kappa t)$ 进行比较，我们可以令与时间相关的指数项相等：\n$$\n\\exp(-i\\omega_{h} t) = \\exp(-ic\\kappa t)\n$$\n这意味着 $-i\\omega_{h} t = -ic\\kappa t$。因此，离散色散关系是：\n$$\n\\omega_{h} = c\\kappa\n$$\n这个结果展示了傅里叶谱方法用于线性平流方程的一个关键特性：空间离散化不引入色散误差。由 $\\frac{\\omega_{h}}{\\kappa}$ 给出的数值相速度，对于所有可分辨的波数 $\\kappa$，都精确地等于物理平流速度 $c$。完整数值解中的任何误差将仅源于时间积分格式以及不可分辨模式的混叠（如果它们最初就存在或由非线性项产生，而本问题中不存在非线性项）。",
            "answer": "$$\n\\boxed{c\\kappa}\n$$"
        },
        {
            "introduction": "傅里叶方法是处理周期性问题的完美工具，但许多航空航天应用，例如翼型绕流，都涉及固体边界。本练习将介绍切比雪夫-陶方法（Chebyshev-Tau method），这是一种在有限区间（如 $[-1,1]$）上求解微分方程的强大技术。你将为一个二阶边值问题手动构建一个解，从而具体地理解陶方法如何通过直接操作切比雪夫级数展开的系数来同时施加控制方程和边界条件。这个动手推导  是理解如何将谱方法应用于非周期性、有壁面边界流动的关键一步。",
            "id": "3995755",
            "problem": "考虑一个一维椭圆模型问题，该问题出现在计算流体动力学（CFD）中粘性算子的壁面法向谱离散化中。在区间 $[-1,1]$ 上，令 $u(x)$ 满足二阶常微分方程\n$$\nu''(x) = f(x),\n$$\n以及非齐次狄利克雷边界条件\n$$\nu(-1) = \\alpha, \\qquad u(1) = \\beta.\n$$\n你将使用第一类切比雪夫多项式构建一个切比雪夫-Tau谱方法。令 $\\{T_k(x)\\}_{k=0}^{\\infty}$ 表示由 $T_k(\\cos\\theta) = \\cos(k\\theta)$ 定义的切比雪夫多项式。用一个 $N$ 次的有限切比雪夫级数来近似 $u(x)$，\n$$\nu_N(x) = \\sum_{k=0}^{N} a_k T_k(x),\n$$\n其模态系数 $\\{a_k\\}_{k=0}^{N}$ 未知，并按如下方式实施Tau构造：写出残差\n$$\nR_N(x) = u_N''(x) - f(x),\n$$\n将 $R_N(x)$ 在切比雪夫基中展开，并将 $R_N(x)$ 对于模式 $k=0,1,\\ldots,N-2$ 的展开系数设为零，同时允许对应于 $T_{N-1}(x)$ 和 $T_N(x)$ 的最高两个模态系数不为零，并等于两个未知的Tau参数。通过在 $x=-1$ 和 $x=1$ 处对 $u_N(x)$ 施加两个边界条件来封闭该系统。\n\n作为一个具体实例，取 $N=3$，强迫项 $f(x) = 2 + 3x$，边界值为 $\\alpha = 0$ 和 $\\beta = \\frac{1}{2}$。从切比雪夫多项式的基本性质（关于权重 $(1-x^2)^{-1/2}$ 的正交性，点值 $T_k(1)=1$ 和 $T_k(-1)=(-1)^k$，以及它们对低次数的多项式定义）出发，执行上述的Tau方法构造，以获得关于未知数 $\\{a_0,a_1,a_2,a_3\\}$ 和两个Tau参数的线性代数系统。求解该系统，并在中点处评估所得的谱近似解，以求得 $u_3(0)$。\n\n请以精确实数形式给出最终答案，不带单位。不要四舍五入；本题不需要指定有效数字。",
            "solution": "所述问题具有科学依据，是适定的、客观的且自洽的。它描述了切比雪夫-Tau谱方法在一个简单边值问题上的标准应用，这是数值分析中一个成熟的程序。所有必要的数据和条件都已提供，并且没有内部矛盾。因此，该问题是有效的，并将提供解答。\n\n问题是求解二阶常微分方程\n$$\nu''(x) = f(x)\n$$\n在定义域 $x \\in [-1, 1]$ 上，带有非齐次狄利克雷边界条件 $u(-1) = \\alpha$ 和 $u(1) = \\beta$。我们给定的具体情况是 $f(x) = 2 + 3x$，$\\alpha = 0$ 和 $\\beta = \\frac{1}{2}$。\n\n我们寻求一个 $N=3$ 次的有限切比雪夫级数形式的近似解：\n$$\nu_3(x) = \\sum_{k=0}^{3} a_k T_k(x)\n$$\n其中 $\\{a_k\\}_{k=0}^3$ 是未知的模态系数，$T_k(x)$ 是第一类切比雪夫多项式。前几个切比雪夫多项式是：\n$$\nT_0(x) = 1 \\\\\nT_1(x) = x \\\\\nT_2(x) = 2x^2 - 1 \\\\\nT_3(x) = 4x^3 - 3x\n$$\n我们可以通过代入这些定义，将近似解 $u_3(x)$ 表示在标准单项式基中：\n$$\nu_3(x) = a_0(1) + a_1(x) + a_2(2x^2 - 1) + a_3(4x^3 - 3x) \\\\\nu_3(x) = (a_0 - a_2) + (a_1 - 3a_3)x + (2a_2)x^2 + (4a_3)x^3\n$$\n为了施加微分方程，我们首先计算 $u_3(x)$ 的二阶导数：\n$$\nu_3'(x) = (a_1 - 3a_3) + (4a_2)x + (12a_3)x^2 \\\\\nu_3''(x) = 4a_2 + 24a_3 x\n$$\n切比雪夫-Tau方法要求残差 $R_N(x) = u_N''(x) - f(x)$ 与前 $N-1$ 个基函数正交。对于 $N=3$，这意味着残差与 $T_0(x)$ 和 $T_1(x)$ 的内积必须为零。这等价于将残差的切比雪夫展开式的前 $N-1=2$ 个系数设为零。让我们构建我们具体案例的残差：\n$$\nR_3(x) = u_3''(x) - f(x) = (4a_2 + 24a_3 x) - (2 + 3x) \\\\\nR_3(x) = (4a_2 - 2) + (24a_3 - 3)x\n$$\n为了找到 $R_3(x)$ 的切比雪夫展开式，我们用 $T_0(x)$ 和 $T_1(x)$ 来表示它：\n$$\nR_3(x) = (4a_2 - 2)T_0(x) + (24a_3 - 3)T_1(x)\n$$\n残差的切比雪夫展开式是 $R_3(x) = c_0 T_0(x) + c_1 T_1(x)$，其中 $c_0 = 4a_2 - 2$ 且 $c_1 = 24a_3 - 3$。Tau 条件是对于 $k = 0, 1, \\ldots, N-2=1$，$c_k = 0$。这产生了两个方程：\n$$\nc_0 = 4a_2 - 2 = 0 \\implies a_2 = \\frac{2}{4} = \\frac{1}{2} \\\\\nc_1 = 24a_3 - 3 = 0 \\implies a_3 = \\frac{3}{24} = \\frac{1}{8}\n$$\n我们现在有了系数 $a_2$ 和 $a_3$ 的值。为了求得 $a_0$ 和 $a_1$，我们对 $u_3(x)$ 施加两个边界条件。切比雪夫多项式的必要性质是对于所有 $k \\ge 0$，$T_k(1) = 1$ 和 $T_k(-1) = (-1)^k$。\n\n在 $x=1$ 处的边界条件是 $u_3(1) = \\beta = \\frac{1}{2}$：\n$$\nu_3(1) = \\sum_{k=0}^{3} a_k T_k(1) = a_0 T_0(1) + a_1 T_1(1) + a_2 T_2(1) + a_3 T_3(1) \\\\\na_0(1) + a_1(1) + a_2(1) + a_3(1) = \\frac{1}{2} \\\\\na_0 + a_1 + a_2 + a_3 = \\frac{1}{2}\n$$\n在 $x=-1$ 处的边界条件是 $u_3(-1) = \\alpha = 0$：\n$$\nu_3(-1) = \\sum_{k=0}^{3} a_k T_k(-1) = a_0 T_0(-1) + a_1 T_1(-1) + a_2 T_2(-1) + a_3 T_3(-1) \\\\\na_0(1) + a_1(-1) + a_2(1) + a_3(-1) = 0 \\\\\na_0 - a_1 + a_2 - a_3 = 0\n$$\n我们现在有了一个关于四个未知数 $\\{a_0, a_1, a_2, a_3\\}$ 的四元线性方程组：\n1. $a_2 = \\frac{1}{2}$\n2. $a_3 = \\frac{1}{8}$\n3. $a_0 + a_1 + a_2 + a_3 = \\frac{1}{2}$\n4. $a_0 - a_1 + a_2 - a_3 = 0$\n\n将 $a_2$ 和 $a_3$ 的已知值代入方程 $(3)$ 和 $(4)$：\n$$\na_0 + a_1 + \\frac{1}{2} + \\frac{1}{8} = \\frac{1}{2} \\implies a_0 + a_1 = -\\frac{1}{8} \\\\\na_0 - a_1 + \\frac{1}{2} - \\frac{1}{8} = 0 \\implies a_0 - a_1 + \\frac{3}{8} = 0 \\implies a_0 - a_1 = -\\frac{3}{8}\n$$\n我们得到了一个关于 $a_0$ 和 $a_1$ 的 $2 \\times 2$ 方程组：\n$$\n\\begin{cases} a_0 + a_1 = -\\frac{1}{8} \\\\ a_0 - a_1 = -\\frac{3}{8} \\end{cases}\n$$\n两方程相加得到：\n$$\n2a_0 = -\\frac{1}{8} - \\frac{3}{8} = -\\frac{4}{8} = -\\frac{1}{2} \\implies a_0 = -\\frac{1}{4}\n$$\n第一个方程减去第二个方程得到：\n$$\n2a_1 = -\\frac{1}{8} - (-\\frac{3}{8}) = \\frac{2}{8} = \\frac{1}{4} \\implies a_1 = \\frac{1}{8}\n$$\n因此，谱近似的系数为：\n$a_0 = -\\frac{1}{4}$，$a_1 = \\frac{1}{8}$，$a_2 = \\frac{1}{2}$，$a_3 = \\frac{1}{8}$。\n\n最后一步是在中点 $x=0$ 处评估所得的谱近似解 $u_3(x)$。\n$$\nu_3(0) = \\sum_{k=0}^{3} a_k T_k(0)\n$$\n切比雪夫多项式在 $x=0$ 处的值由 $T_k(0) = \\cos(k\\frac{\\pi}{2})$ 给出：\n$$\nT_0(0) = \\cos(0) = 1 \\\\\nT_1(0) = \\cos(\\frac{\\pi}{2}) = 0 \\\\\nT_2(0) = \\cos(\\pi) = -1 \\\\\nT_3(0) = \\cos(\\frac{3\\pi}{2}) = 0\n$$\n将这些值代入 $u_3(0)$ 的表达式中：\n$$\nu_3(0) = a_0 T_0(0) + a_1 T_1(0) + a_2 T_2(0) + a_3 T_3(0) \\\\\nu_3(0) = a_0(1) + a_1(0) + a_2(-1) + a_3(0) \\\\\nu_3(0) = a_0 - a_2\n$$\n使用计算出的 $a_0$ 和 $a_2$ 的值：\n$$\nu_3(0) = -\\frac{1}{4} - \\frac{1}{2} = -\\frac{1}{4} - \\frac{2}{4} = -\\frac{3}{4}\n$$\n由于该边值问题（BVP）的精确解是一个三次多项式 $u(x) = \\frac{1}{2}x^3 + x^2 - \\frac{1}{4}x - \\frac{3}{4}$，因此 $N=3$ 次的切比雪夫近似是精确的，我们的结果与精确值 $u(0) = -\\frac{3}{4}$ 相符。",
            "answer": "$$\\boxed{-\\frac{3}{4}}$$"
        },
        {
            "introduction": "从线性方程过渡到非线性方程是流体动力学的核心，但也为伪谱方法带来了一个关键挑战：混叠（aliasing）误差。当在物理空间中计算非线性项（如对流项 $u u_x$）时，就会产生这种误差。本练习将聚焦于此问题，通过研究一个简单的二次非线性项，你将看到乘积产生的高频分量如何被错误地表示为低频分量，从而污染计算结果。在量化这一误差后，你将分析著名的“3/2规则”，一种通过零填充（zero-padding）来完全消除此误差源的去混叠技术 。掌握这一概念对于编写稳定且准确的非线性问题谱方法CFD代码至关重要。",
            "id": "3995790",
            "problem": "考虑区间 $[0,2\\pi)$ 上的一个一维周期域，这是计算流体动力学（CFD）中高阶谱方法的标准设置。设 $u(x)$ 是一个实值速度场，表示在 $N$ 个等距配置点 $x_{j} = \\frac{2\\pi j}{N}$（其中 $j = 0,1,\\dots,N-1$）上，且 $N$ 是一个能被 $3$ 整除的偶数。截断傅里叶级数使用的波数指数为 $k \\in \\{-\\frac{N}{2},\\dots,\\frac{N}{2}-1\\}$，离散傅里叶变换（DFT）系数定义为 $\\hat{u}_{k} = \\frac{1}{N}\\sum_{j=0}^{N-1}u(x_{j})\\exp(-i k x_{j})$，因此对于采样数据，$u(x_{j}) = \\sum_{k=-N/2}^{N/2-1}\\hat{u}_{k}\\exp(i k x_{j})$ 精确成立。\n\n假设该场是单模态状态 $u(x) = \\cos(k_{0}x)$，其中 $k_{0} = \\frac{N}{3}$，此波数在可表示的频带内。在对二次非线性项 $u^{2}(x)$ 进行伪谱评估时，我们在物理空间中逐点计算 $u^{2}$，然后使用快速傅里叶变换（FFT）返回到傅里叶空间。在没有去混叠的情况下，离散傅里叶变换（DFT）底层的离散循环卷积会导致由二次乘积产生的高频内容以 $N$ 为模折返回到解析频带内，从而产生混叠效应。\n\n从傅里叶级数、DFT 和离散卷积定理的基本定义出发，推导 $u^{2}(x)$ 的精确傅里叶系数，并确定在没有任何去混叠处理的情况下，在 $N$ 点网格上形成 $u^{2}$ 时，在波数 $k = \\frac{N}{3}$ 处产生的混叠系数。然后分析 $3/2$ 法则的填充策略：将 $u$ 的谱表示零填充到 $M = \\frac{3N}{2}$ 个点（其中 $M$ 为整数），变换到 $M$ 点的物理网格，在该网格上形成 $u^{2}$，然后变换回来，并将结果截断到原始频带 $k \\in \\{-\\frac{N}{2},\\dots,\\frac{N}{2}-1\\}$。使用第一性原理，证明经过填充的计算在截断后是否会在 $k = \\frac{N}{3}$ 处产生任何非零系数。\n\n以单一数量报告误差缩减因子，其定义为在波数 $k = \\frac{N}{3}$ 处，填充后系数的幅值与未填充的混叠系数的幅值之比。无需四舍五入。以一个无单位的实数形式提供最终答案。",
            "solution": "该问题要求分析伪谱方法中二次非线性项的混叠误差，以及 $3/2$ 法则去混叠的有效性。我们首先将验证问题陈述的有效性。\n\n### 问题有效性验证\n\n**步骤 1：提取已知条件**\n- 域：一维，周期为 $[0, 2\\pi)$。\n- 网格：$N$ 个等距点，$x_{j} = \\frac{2\\pi j}{N}$，其中 $j = 0, 1, \\dots, N-1$。\n- 网格大小 $N$：一个能被 $3$ 整除的偶数。\n- 波数范围：$k \\in \\{-\\frac{N}{2}, \\dots, \\frac{N}{2}-1\\}$。\n- 离散傅里叶变换（DFT）：$\\hat{u}_{k} = \\frac{1}{N}\\sum_{j=0}^{N-1}u(x_{j})\\exp(-i k x_{j})$。\n- 逆离散傅里叶变换（IDFT）：$u(x_{j}) = \\sum_{k=-N/2}^{N/2-1}\\hat{u}_{k}\\exp(i k x_{j})$。\n- 场：$u(x) = \\cos(k_{0}x)$，其中 $k_{0} = \\frac{N}{3}$。\n- 非线性项：$u^{2}(x)$。\n- 未填充方法：在 $N$ 点网格上计算 $u^{2}$，然后变换回傅里叶空间。\n- 填充方法（$3/2$ 法则）：将 $u$ 的傅里叶系数填充到 $M = \\frac{3N}{2}$ 个点，变换到 $M$ 点的物理网格，计算 $u^2$，变换回来，并截断到原始波数频带。\n- 任务：对于未填充方法，求出在 $k = \\frac{N}{3}$ 处的混叠系数。确定填充方法是否在 $k = \\frac{N}{3}$ 处产生非零系数。计算误差缩减因子，即填充后系数与未填充系数在 $k = \\frac{N}{3}$ 处的幅值之比。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题是谱方法理论中的一个经典例子，涉及混叠误差和去混叠技术。它牢固地建立在傅里叶分析及其在CFD数值方法中的应用之上。\n- **适定性**：问题定义明确，提供了所有必要信息。初始条件 $u(x)$、网格、数值程序以及待计算的量都已精确指定。存在唯一解。\n- **客观性**：问题陈述客观，使用了数值分析和应用数学的标准术语。\n\n**步骤 3：结论与行动**\n问题有效。我们继续进行求解。\n\n### 未填充伪谱方法分析\n\n首先，我们确定给定速度场 $u(x) = \\cos(k_{0}x)$（其中 $k_{0} = \\frac{N}{3}$）的离散傅里叶系数 $\\hat{u}_{k}$。使用 Euler 公式，我们可以将 $u(x)$ 写为：\n$$\nu(x) = \\cos\\left(\\frac{N}{3}x\\right) = \\frac{1}{2}\\left(\\exp\\left(i\\frac{N}{3}x\\right) + \\exp\\left(-i\\frac{N}{3}x\\right)\\right)\n$$\n由于波数 $k_0 = \\frac{N}{3}$ 和 $-k_0 = -\\frac{N}{3}$ 都在解析频带 $k \\in \\{-\\frac{N}{2}, \\dots, \\frac{N}{2}-1\\}$ 内（因为 $\\frac{N}{3}  \\frac{N}{2}$），$u(x)$ 在 $N$ 点网格上的离散傅里叶谱由两个非零系数组成：\n$$\n\\hat{u}_{k} =\n\\begin{cases}\n1/2  \\text{若 } k = \\pm\\frac{N}{3} \\\\\n0  \\text{其他情况}\n\\end{cases}\n$$\n二次非线性项 $u^{2}(x)$ 的伪谱评估涉及逐点计算乘积 $u^{2}(x_{j})$，然后应用 DFT。根据离散卷积定理，两个函数乘积的 DFT 是它们各自 DFT 的离散循环卷积。设 $\\widehat{(u^2)}_{k}$ 为 $u^{2}(x)$ 的 DFT 系数。那么：\n$$\n\\widehat{(u^2)}_{k} = (\\hat{u} * \\hat{u})_{k} = \\sum_{p+q \\equiv k \\pmod N} \\hat{u}_{p}\\hat{u}_{q}\n$$\n其中求和遍及解析频带中的所有波数对 $(p, q)$。由于 $\\hat{u}_k$ 仅在 $k = \\pm\\frac{N}{3}$ 时非零，我们只需考虑这些模态之间的相互作用。可能的波数和 $p+q = k_{true}$ 包括：\n1. $p = \\frac{N}{3}$，$q = \\frac{N}{3} \\implies k_{true} = \\frac{N}{3} + \\frac{N}{3} = \\frac{2N}{3}$。系数贡献为 $\\hat{u}_{N/3}\\hat{u}_{N/3} = (\\frac{1}{2})(\\frac{1}{2}) = \\frac{1}{4}$。\n2. $p = -\\frac{N}{3}$，$q = -\\frac{N}{3} \\implies k_{true} = -\\frac{N}{3} - \\frac{N}{3} = -\\frac{2N}{3}$。系数贡献为 $\\hat{u}_{-N/3}\\hat{u}_{-N/3} = (\\frac{1}{2})(\\frac{1}{2}) = \\frac{1}{4}$。\n3. $p = \\frac{N}{3}$，$q = -\\frac{N}{3}$（反之亦然）$\\implies k_{true} = \\frac{N}{3} - \\frac{N}{3} = 0$。系数贡献为 $\\hat{u}_{N/3}\\hat{u}_{-N/3} + \\hat{u}_{-N/3}\\hat{u}_{N/3} = (\\frac{1}{2})(\\frac{1}{2}) + (\\frac{1}{2})(\\frac{1}{2}) = \\frac{1}{2}$。\n\n现在，我们必须考虑混叠。波数 $k_{true}$ 必须被映射回解析频带 $\\{-\\frac{N}{2}, \\dots, \\frac{N}{2}-1\\}$。\n- 对于 $k_{true} = \\frac{2N}{3}$：此波数在解析频带之外，因为 $\\frac{2N}{3} > \\frac{N}{2}-1$。混叠后的波数为 $k_{alias} = \\frac{2N}{3} - N = -\\frac{N}{3}$。这种相互作用错误地贡献给了 $k = -\\frac{N}{3}$ 处的系数。\n- 对于 $k_{true} = -\\frac{2N}{3}$：此波数也在频带之外。混叠后的波数为 $k_{alias} = -\\frac{2N}{3} + N = \\frac{N}{3}$。这种相互作用错误地贡献给了 $k = \\frac{N}{3}$ 处的系数。\n- 对于 $k_{true} = 0$：此波数在频带之内，因此该项没有混叠。\n\n在没有去混叠的情况下计算得到的 $u^2(x)$ 的离散谱为：\n$$\n\\widehat{(u^2)}_{k} =\n\\begin{cases}\n1/2  \\text{若 } k = 0 \\\\\n1/4  \\text{若 } k = N/3 \\text{（混叠）} \\\\\n1/4  \\text{若 } k = -N/3 \\text{（混叠）} \\\\\n0  \\text{其他情况}\n\\end{cases}\n$$\n因此，在 $k = \\frac{N}{3}$ 处的未填充混叠系数为 $\\frac{1}{4}$。\n\n### 填充（$3/2$ 法则）方法分析\n\n在填充方法中，我们首先将 $u(x)$ 的谱表示扩展到具有 $M = \\frac{3N}{2}$ 个点的网格上。傅里叶系数 $\\hat{u}_k$ 被放入一个更大的数组 $\\hat{v}_k$ 中，其波数范围对应于 $M$ 个点，即 $k \\in \\{-\\lfloor\\frac{M-1}{2}\\rfloor, \\dots, \\lfloor\\frac{M}{2}\\rfloor\\}$。具体来说，$\\hat{v}_{\\pm N/3} = 1/2$，对于直到原始奈奎斯特极限的模态，所有其他的 $\\hat{v}_k$ 都为零，而直到新的奈奎斯特极限的新增模态也为零。\n\n二次乘积在 $M$ 点网格上形成。得到的乘积波数仍然是 $k_{true} = 0, \\pm \\frac{2N}{3}$。我们必须检查这些波数在 $M$ 点网格上是否发生混叠。如果乘积中产生的最高波数在填充网格的可表示（无混叠）范围内，则去混叠是成功的。乘积中的最大波数幅值为 $|k_{true}|_{max} = \\frac{2N}{3}$。填充网格的奈奎斯特波数值为 $k_{Nyquist, M} = \\lfloor\\frac{M}{2}\\rfloor = \\lfloor \\frac{3N/2}{2} \\rfloor = \\lfloor \\frac{3N}{4} \\rfloor$。\n\n为了使去混叠正常工作，我们必须满足 $|k_{true}|_{max}  k_{Nyquist, M}$。\n$$\n\\frac{2N}{3}  \\frac{3N}{4} \\iff 8N  9N\n$$\n这个不等式对任何 $N0$ 都成立。严格不等式确保了最高的乘积波数不会恰好落在填充网格的奈奎斯特模态上，从而避免了歧义。因此，$M$ 点网格上的卷积是无混叠的。$M$ 网格上乘积的系数精确为：\n$$\n\\widehat{(u^2)}_{k, padded} =\n\\begin{cases}\n1/2  \\text{若 } k = 0 \\\\\n1/4  \\text{若 } k = 2N/3 \\\\\n1/4  \\text{若 } k = -2N/3 \\\\\n0  \\text{其他情况}\n\\end{cases}\n$$\n最后一步是将此谱截断回原始波数范围 $k \\in \\{-\\frac{N}{2}, \\dots, \\frac{N}{2}-1\\}$。我们检查所产生的波数：\n- $k=0$：此波数在原始频带内，因此被保留。\n- $k=\\frac{2N}{3}$：此波数在原始频带之外，因为 $\\frac{2N}{3} > \\frac{N}{2}-1$。该分量被截断移除。\n- $k=-\\frac{2N}{3}$：此波数也在原始频带之外，因为 $-\\frac{2N}{3}  -\\frac{N}{2}$。该分量也被截断移除。\n\n在完整的填充和截断过程之后，唯一的非零系数在 $k=0$ 处。在 $k = \\frac{N}{3}$ 处的系数为 $0$，因为这个波数没有在无混叠的乘积中产生，而未填充计算对此模态的贡献是由于混叠造成的，现在混叠已被消除。\n在 $k=\\frac{N}{3}$ 处的填充系数为 $0$。\n\n### 误差缩减因子\n\n误差缩减因子是在 $k = \\frac{N}{3}$ 处，填充后系数的幅值与未填充的混叠系数的幅值之比。\n- 在 $k = \\frac{N}{3}$ 处未填充混叠系数的幅值：$|\\frac{1}{4}| = \\frac{1}{4}$。\n- 在 $k = \\frac{N}{3}$ 处填充系数的幅值：$|0| = 0$。\n\n该比值为：\n$$\n\\text{因子} = \\frac{|0|}{|\\frac{1}{4}|} = \\frac{0}{\\frac{1}{4}} = 0\n$$\n$3/2$ 法则在此特定情况下完全消除了混叠误差。",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}