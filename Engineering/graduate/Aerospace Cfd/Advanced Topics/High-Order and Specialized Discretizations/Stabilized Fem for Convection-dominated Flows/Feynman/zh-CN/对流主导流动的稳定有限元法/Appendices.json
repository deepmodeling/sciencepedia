{
    "hands_on_practices": [
        {
            "introduction": "在我们深入研究稳定化方法的具体细节之前，我们必须首先牢固掌握对流主导问题的基本物理和数学特性。这个思想实验旨在巩固你对偏微分方程适定性（well-posedness）的理解，特别是信息如何沿特征线传播，以及这如何决定了边界条件的正确施加方式。通过分析对流-扩散方程在佩克莱数（Péclet number）$Pe_h \\gg 1$的极限情况下的行为，你将能够辨明为何标准边界条件处理方式会失效，并确定一个数学上合理的变分框架的基础。",
            "id": "3996497",
            "problem": "考虑一个定义在有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^d$ 上的稳态标量对流-扩散方程，其单位外法向量为 $\\boldsymbol{n}$：\n$$\n- \\varepsilon \\, \\Delta u + \\boldsymbol{b} \\cdot \\nabla u = f \\quad \\text{in } \\Omega,\n$$\n其中 $\\varepsilon > 0$ 是分子扩散率，$\\boldsymbol{b} \\in [L^\\infty(\\Omega)]^d$ 是一个给定的速度场（假设 $\\nabla \\cdot \\boldsymbol{b} \\in L^\\infty(\\Omega)$），$f \\in L^2(\\Omega)$ 是一个源项。将边界的流入和流出部分定义为\n$$\n\\Gamma^- := \\{ x \\in \\partial \\Omega \\,:\\, \\boldsymbol{b}(x) \\cdot \\boldsymbol{n}(x)  0 \\}, \\qquad\n\\Gamma^+ := \\{ x \\in \\partial \\Omega \\,:\\, \\boldsymbol{b}(x) \\cdot \\boldsymbol{n}(x) > 0 \\}.\n$$\n令局部单元尺度的佩克莱数为\n$$\nPe_h := \\frac{\\|\\boldsymbol{b}\\|_{\\infty} \\, h}{2 \\varepsilon},\n$$\n其中 $h$ 表示一个代表性的网格尺寸。在航空航天计算流体动力学 (CFD) 中稳定化有限元方法 (FEM) 的应用中，$Pe_h \\gg 1$ 的情况很常见，并被称为对流占优。\n\n从基本守恒律的观点和算子 $\\boldsymbol{b} \\cdot \\nabla (\\cdot)$ 的输运特性出发，解释当对流占优时，$\\Gamma^-$ 和 $\\Gamma^+$ 的分类如何决定一个适定问题需要哪些边界数据。然后，在 $Pe_h \\gg 1$ 的条件下，为建立一个数学上合理的弱形式，构建适当的容许解空间，并精确说明迹是在 $\\Gamma^-$ 和/或 $\\Gamma^+$ 上给定，以及需要什么样的内部正则性。你的回答应基于算子的特性和变分结构；不要假设任何特定的稳定化格式。\n\n在对流占优情况下，以下哪个陈述最准确地描述了流入边界条件对问题适定性的作用以及正确的容许解空间？\n\nA. 因为对于任何 $\\varepsilon > 0$，扩散算子 $- \\varepsilon \\Delta$ 都是椭圆的，所以为了问题的适定性，必须在整个边界 $\\partial \\Omega$ 上给定狄利克雷条件；无论 $Pe_h$ 的大小如何，容许解空间都是 $H^1_0(\\Omega)$。\n\nB. 边界数据必须在流入边界 $\\Gamma^-$ 上给定，而流出边界 $\\Gamma^+$ 不应带有狄利克雷约束；对于 $Pe_h \\gg 1$，当 $\\varepsilon > 0$ 很小时，适当的变分空间是 $V := \\{ v \\in H^1(\\Omega) \\,:\\, v = g \\text{ on } \\Gamma^- \\}$，并且在极限情况 $\\varepsilon \\to 0$（纯平流）下，是图空间 $G := \\{ v \\in L^2(\\Omega) \\,:\\, \\boldsymbol{b} \\cdot \\nabla v \\in L^2(\\Omega), \\, v|_{\\Gamma^-} = g \\}$，其中流出边界通过自然边界项处理。\n\nC. 为防止边界层，在 $\\Gamma^-$ 上施加诺伊曼边界条件，在 $\\Gamma^+$ 上施加狄利克雷条件；容许解空间是 $H^1(\\Omega)$，其迹在 $\\Gamma^+$ 上固定，且与 $Pe_h$ 无关。\n\nD. 在对流占优的流动中，稳定化方法消除了对任何边界条件的需求；即使当 $\\varepsilon \\to 0$ 时，容许解空间也是 $L^2(\\Omega)$，没有任何迹限制。\n\nE. 由于对流均匀地输运信息，当 $Pe_h \\gg 1$ 时，周期性边界条件是唯一适定的选择；容许解空间是 $H^1(\\Omega)$ 的周期性子空间，并且此选择与 $\\partial \\Omega$ 上 $\\boldsymbol{b} \\cdot \\boldsymbol{n}$ 的符号无关。",
            "solution": "该问题陈述是偏微分方程数值分析领域中一个有效且适定的问题，具体涉及对流占优的对流-扩散问题的处理。所有术语都是标准的且定义精确，问题针对的是该学科中的一个核心概念点。\n\n控制方程是稳态标量对流-扩散方程：\n$$\n- \\varepsilon \\, \\Delta u + \\boldsymbol{b} \\cdot \\nabla u = f \\quad \\text{in } \\Omega\n$$\n这个偏微分算子 $L(u) = - \\varepsilon \\, \\Delta u + \\boldsymbol{b} \\cdot \\nabla u$ 由一个二阶椭圆扩散项 $-\\varepsilon \\Delta u$ 和一个一阶双曲对流（或平流/输运）项 $\\boldsymbol{b} \\cdot \\nabla u$ 组成。方程及其解的性质关键取决于这两项的相对大小。这由佩克莱数 $Pe_h = \\frac{\\|\\boldsymbol{b}\\|_{\\infty} \\, h}{2 \\varepsilon}$ 来量化。我们关心的是对流占优的情况，即 $Pe_h \\gg 1$，这对应于扩散率 $\\varepsilon$ 相对于对流 $\\|\\boldsymbol{b}\\|$ 较小的情况。\n\n这是一个奇异摄动问题。当 $\\varepsilon \\to 0$ 时，最高阶导数项消失，方程的性质从椭圆型变为双曲型。极限方程是一阶输运方程：\n$$\n\\boldsymbol{b} \\cdot \\nabla u = f\n$$\n一阶双曲方程的理论由特征线法主导。信息沿着特征曲线传播，这些曲线是速度场 $\\boldsymbol{b}$ 的积分曲线。为了使有界域 $\\Omega$ 上的问题适定，必须在特征线进入域的点上指定边界条件。这正是流入边界的定义，即 $\\Gamma^- := \\{ x \\in \\partial \\Omega \\,:\\, \\boldsymbol{b}(x) \\cdot \\boldsymbol{n}(x)  0 \\}$。流出边界 $\\Gamma^+ := \\{ x \\in \\partial \\Omega \\,:\\, \\boldsymbol{b}(x) \\cdot \\boldsymbol{n}(x) > 0 \\}$ 上的解由解从流入边界的演化所决定，不能被狄利克雷条件从外部约束。在 $\\Gamma^+$ 上施加狄利克雷条件通常会过度约束问题，并导致尖锐的、非物理的边界层。\n\n对于任何微小但严格为正的 $\\varepsilon > 0$，方程仍然是二阶椭圆型。项 $-\\varepsilon \\Delta u$ 的存在确保了弱解属于索博列夫空间 $H^1(\\Omega)$。然而，在对流占优的情况下，数学公式必须尊重底层的双曲物理特性，才能有意义并引导出稳定的数值方法。因此，适当的边界条件是在流入边界 $\\Gamma^-$ 上的本质（狄利克雷）条件。流出边界 $\\Gamma^+$ 上的条件应该是从弱形式中产生的自然边界条件，例如在对扩散项进行分部积分时出现的齐次诺伊曼条件 $\\varepsilon \\frac{\\partial u}{\\partial n} = 0$。\n\n对于在 $\\Gamma^-$ 上具有非齐次狄利克雷数据 $g$ 的问题，其容许解空间（试验空间）是 $H^1(\\Omega)$ 中满足此条件的函数的仿射子空间。即，$V_g = \\{ v \\in H^1(\\Omega) \\,:\\, v = g \\text{ on } \\Gamma^- \\}$。\n\n在极限情况 $\\varepsilon=0$ 下，$H^1(\\Omega)$ 的正则性不再得到保证。最小的泛函分析设置要求解 $u$ 在 $L^2(\\Omega)$ 中，并且其方向导数 $\\boldsymbol{b} \\cdot \\nabla u$ 也在 $L^2(\\Omega)$ 中。这导致了算子 $\\boldsymbol{b} \\cdot \\nabla (\\cdot)$ 的“图空间”，即 $G := \\{ v \\in L^2(\\Omega) \\,:\\, \\boldsymbol{b} \\cdot \\nabla v \\in L^2(\\Omega) \\}$。适用于该空间的迹定理允许在流入边界上施加狄利克雷数据 $v|_{\\Gamma^-} = g$。\n\n现在我们基于此分析来评估给出的选项。\n\nA. 因为对于任何 $\\varepsilon > 0$，扩散算子 $- \\varepsilon \\Delta$ 都是椭圆的，所以为了问题的适定性，必须在整个边界 $\\partial \\Omega$ 上给定狄利克雷条件；无论 $Pe_h$ 的大小如何，容许解空间都是 $H^1_0(\\Omega)$。\n该陈述忽略了问题的奇异摄动性质以及在 $Pe_h \\gg 1$ 时占主导地位的双曲特性。虽然一个二阶椭圆问题需要在整个边界 $\\partial\\Omega$ 上施加边界条件，但在流出边界 $\\Gamma^+$ 上施加狄利克雷条件对于输运占优的流动在物理上是不正确的，并且是数值不稳定性和非物理边界层的来源。“无论 $Pe_h$ 的大小如何”这一说法是根本错误的。空间 $H^1_0(\\Omega)$ 是针对整个边界上齐次边界条件的特例，不具有普遍性。**不正确**。\n\nB. 边界数据必须在流入边界 $\\Gamma^-$ 上给定，而流出边界 $\\Gamma^+$ 不应带有狄利克雷约束；对于 $Pe_h \\gg 1$，当 $\\varepsilon > 0$ 很小时，适当的变分空间是 $V := \\{ v \\in H^1(\\Omega) \\,:\\, v = g \\text{ on } \\Gamma^- \\}$，并且在极限情况 $\\varepsilon \\to 0$（纯平流）下，是图空间 $G := \\{ v \\in L^2(\\Omega) \\,:\\, \\boldsymbol{b} \\cdot \\nabla v \\in L^2(\\Omega), \\, v|_{\\Gamma^-} = g \\}$，其中流出边界通过自然边界项处理。\n该陈述与对问题的正确物理和数学理解完全一致。它正确地指出了在流入边界 $\\Gamma^-$ 上预先给定数据的作用，以及需要避免在流出边界 $\\Gamma^+$ 上施加狄利克雷条件。它正确地确定了当 $\\varepsilon$ 微小但为正时的适当函数空间 $V$，以及纯平流极限 $\\varepsilon \\to 0$ 下的适当图空间 $G$。提及流出边界的“自然边界项”在弱形式的背景下也是正确的。**正确**。\n\nC. 为防止边界层，在 $\\Gamma^-$ 上施加诺伊曼边界条件，在 $\\Gamma^+$ 上施加狄利克雷条件；容许解空间是 $H^1(\\Omega)$，其迹在 $\\Gamma^+$ 上固定，且与 $Pe_h$ 无关。\n该陈述规定的边界条件方式与信息的物理输运方向完全相反。在流出边界 $\\Gamma^+$ 上施加狄利克雷条件是产生伪边界层的主要原因，而不是防止它们的方法。边界数据必须在流入边界 $\\Gamma^-$ 提供。声称此选择“与 $Pe_h$ 无关”也是错误的。**不正确**。\n\nD. 在对流占优的流动中，稳定化方法消除了对任何边界条件的需求；即使当 $\\varepsilon \\to 0$ 时，容许解空间也是 $L^2(\\Omega)$，没有任何迹限制。\n这反映了对偏微分方程理论和数值稳定化方法的深度误解。边界条件的要求源于连续偏微分方程问题需要适定（有唯一解）的需要。数值稳定化技术（例如 SUPG/GLS）被添加到离散（FEM）公式中，以克服标准伽辽金方法在此情况下出现的不稳定性；它们不会改变原始问题的边界条件要求。一个没有边界条件的边值问题是病态的。**不正确**。\n\nE. 由于对流均匀地输运信息，当 $Pe_h \\gg 1$ 时，周期性边界条件是唯一适定的选择；容许解空间是 $H^1(\\Omega)$ 的周期性子空间，并且此选择与 $\\partial \\Omega$ 上 $\\boldsymbol{b} \\cdot \\boldsymbol{n}$ 的符号无关。\n周期性边界条件仅适用于具有特定周期性几何形状和流场的问题（例如，模拟通道中的流动或平均意义上周期性的湍流）。对于一个一般的有界域 $\\Omega$，它们不是一个通用或“唯一”的选择。此外，流入和流出边界之间的区别（这取决于 $\\boldsymbol{b} \\cdot \\boldsymbol{n}$ 的符号）对于建立一个适定问题至关重要。此选项错误地否定了这种区别。**不正确**。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "在建立了对流主导问题的理论基础后，现在是时候通过一个具体的计算来将理论付诸实践了。本练习将指导你为一个简化的 一维模型问题构建并求解一个稳定化的有限元系统，该系统采用了流线迎风/皮特洛夫-伽辽金 (SUPG) 方法。通过直接比较两种看似合理的流出边界条件——“无为”(do-nothing)自然边界条件和能量稳定的迎风边界条件——你将量化地看到，在对流主导的情况下，一个微小的弱形式修正在解的精度上会产生多么显著的影响。",
            "id": "3996494",
            "problem": "考虑一个无量纲形式的被动标量的稳态一维平流-扩散方程，\n$$-k\\,u_{xx} + a\\,u_{x} = 0,$$\n作用于区间 $x \\in [0,2h]$ 上，其中平流速度 $a0$ 和扩散系数 $k0$ 为正常数，入流狄利克雷条件为 $u(0)=1$。网格由两个均匀的有限元组成，节点分别为 $x_{0}=0$、$x_{1}=h$ 和 $x_{2}=2h$。使用标准的线性有限元方法（FEM），并采用流线迎风/皮特洛夫-伽辽金（SUPG）稳定化方法，其中稳定化测试函数为 $v + \\tau\\,a\\,v_{x}$，并且在高单元佩克莱数情况下，稳定化参数取为 $\\tau = h/(2a)$。设单元佩克莱数定义为 $Pe_{h} = a h / (2 k)$。\n\n建立弱形式，为未知节点值 $u_{1} = u(h)$ 和 $u_{2} = u(2h)$ 组装二乘二的线性系统，并比较在 $x=2h$ 处的以下两种出流边界条件处理方式：\n- 无为出流：对扩散项使用自然边界条件（在 $x=2h$ 处无额外的边界贡献项）。\n- 能量稳定出流：用相容的上风出流边界项 $\\int_{x=2h} a\\,u\\,v\\,\\mathrm{d}s$ 增强弱形式（在一维情况下，此项贡献为 $a\\,u(2h)\\,v(2h)$）。\n\n将相对出流误差定义为\n$$E_{\\mathrm{out}}(Pe_{h}) = 1 - \\frac{u_{2}^{\\mathrm{ES}}}{u_{2}^{\\mathrm{DN}}},$$\n其中 $u_{2}^{\\mathrm{ES}}$ 和 $u_{2}^{\\mathrm{DN}}$ 分别是在能量稳定和无为出流处理下计算出的出流节点值。计算渐近极限\n$$\\lim_{Pe_{h} \\to \\infty} E_{\\mathrm{out}}(Pe_{h}).$$\n将最终答案表示为无量纲数。无需四舍五入；给出精确值。",
            "solution": "用户要求我分析一维稳态平流-扩散方程的一个特定有限元方法（FEM）设置。我将首先验证问题的有效性，如果有效，则进行详细推导。\n\n### 第1步：提取已知条件\n- **控制方程**：$-k\\,u_{xx} + a\\,u_{x} = 0$，适用于 $x \\in [0, 2h]$。\n- **参数**：平流速度 $a > 0$，扩散系数 $k > 0$。\n- **边界条件**：入流狄利克雷条件 $u(0)=1$。\n- **网格**：两个均匀的线性有限元，节点位于 $x_{0}=0$、$x_{1}=h$ 和 $x_{2}=2h$。未知数为节点值 $u_{1}=u(h)$ 和 $u_{2}=u(2h)$。\n- **有限元格式**：标准线性有限元方法，采用流线-上风 Petrov-Galerkin（SUPG）稳定化。\n- **稳定化测试函数**：$w = v + \\tau\\,a\\,v_{x}$。\n- **稳定化参数**：$\\tau = h/(2a)$（适用于高单元佩克莱数情况）。\n- **单元佩克莱数**：$Pe_{h} = a h / (2 k)$。\n- **在 $x=2h$ 处要比较的出流条件**：\n    1.  **无为（DN）**：使用分部积分中扩散项产生的自然边界条件。\n    2.  **能量稳定（ES）**：用项 $a\\,u(2h)\\,v(2h)$ 增强弱形式。\n- **待计算量**：相对出流误差 $E_{\\mathrm{out}}(Pe_{h}) = 1 - \\frac{u_{2}^{\\mathrm{ES}}}{u_{2}^{\\mathrm{DN}}}$ 在 $Pe_{h} \\to \\infty$ 时的渐近极限。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学基础**：该问题描述了一种用于流体动力学基本模型方程（平流-扩散）的标准数值方法（SUPG-FEM）。所有概念在计算科学与工程领域都是公认的。该问题具有科学合理性。\n2.  **适定的**：问题陈述清晰，包含了组装和求解所得线性代数系统所需的所有信息。目标是计算一个明确定义的特定极限。该问题是适定的。\n3.  **客观性**：语言精确，没有主观论断。数值方法和误差度量的定义是明确的。该问题是客观的。\n4.  **完备性和一致性**：问题提供了偏微分方程（PDE）、域、边界条件、网格、基函数（由“线性有限元”隐含）以及稳定化和出流条件的具体格式。没有矛盾之处。\n\n### 第3步：结论与行动\n问题有效。我现在开始进行求解。\n\n### 推导\n该问题要求建立并求解由稳态一维平流-扩散方程的特定SUPG-FEM离散化所产生的离散方程组。\n\n**1. 弱形式**\n\n我们从PDE的残差开始：$R(u) = a\\,u_{x} - k\\,u_{xx}$。SUPG弱形式为 $\\int_{0}^{2h} R(u) w \\, dx = 0$，其中测试函数为 $w = v + \\tau a v_x$。\n$$ \\int_{0}^{2h} (a u_x - k u_{xx}) (v + \\tau a v_x) \\, dx = 0 $$\n展开此式得到标准的Galerkin项和稳定化项：\n$$ \\int_{0}^{2h} (a u_x - k u_{xx}) v \\, dx + \\int_{0}^{2h} (a u_x - k u_{xx}) (\\tau a v_x) \\, dx = 0 $$\n我们对二阶导数项进行分部积分：$\\int (-k u_{xx}) v \\, dx = \\int k u_x v_x \\, dx - [k u_x v]$。\n弱形式变为：\n$$ \\int_{0}^{2h} (k u_x v_x + a u_x v) \\, dx - [k u_x v]_{0}^{2h} + \\int_{0}^{2h} \\tau a v_x (a u_x - k u_{xx}) \\, dx = 0 $$\n对于分片线性近似 $u_h$，二阶导数 $u_{hxx}$ 在每个单元内为零。因此，离散解 $u_h$ 和测试函数 $v_h$ 的弱形式为：\n$$ \\sum_{e} \\int_{\\Omega_e} (k u_{hx} v_{hx} + a u_{hx} v_h + \\tau a^2 u_{hx} v_{hx}) \\, dx - [k u_{hx} v_h]_{0}^{2h} = \\text{边界条件项} $$\n我们定义一个稳定化扩散系数 $k_{stab} = k + \\tau a^2$。双线性形式为：\n$$ B(u_h, v_h) = \\int_{0}^{2h} (k_{stab} u_{hx} v_{hx} + a u_{hx} v_h) \\, dx $$\n当 $\\tau = h/(2a)$ 时，我们得到 $k_{stab} = k + \\frac{h}{2a}a^2 = k + \\frac{ah}{2}$。\n\n**2. 单元矩阵公式**\n\n让我们在一个长度为 $h$、节点为A和B的通用单元上求单元刚度矩阵。局部近似为 $u_h(x) = u_A N_A(x) + u_B N_B(x)$。线性基函数的导数为 $N_{Ax} = -1/h$ 和 $N_{Bx} = 1/h$。\n单元矩阵的项为 $K^e_{ij} = \\int_{x_A}^{x_B} (k_{stab} N_{ix} N_{jx} + a N_{jx} N_i) \\, dx$。\n经过标准计算，单元矩阵为：\n$$ \\mathbf{K}^e = \\begin{pmatrix} \\frac{k_{stab}}{h} - \\frac{a}{2}  -\\frac{k_{stab}}{h} + \\frac{a}{2} \\\\ -\\frac{k_{stab}}{h} - \\frac{a}{2}  \\frac{k_{stab}}{h} + \\frac{a}{2} \\end{pmatrix} $$\n代入 $k_{stab} = k + ah/2$，我们发现 $k_{stab}/h = k/h + a/2$。单元矩阵简化为：\n$$ \\mathbf{K}^e = \\begin{pmatrix} \\frac{k}{h}  -\\frac{k}{h} \\\\ -\\frac{k}{h} - a  \\frac{k}{h} + a \\end{pmatrix} $$\n该矩阵对于两个单元 $\\Omega_1 = [0, h]$ 和 $\\Omega_2 = [h, 2h]$ 是相同的。\n\n**3. 全局系统组装**\n\n未知数是 $u_1$ 和 $u_2$，因为 $u_0=1$ 是给定的狄利克雷条件。我们为测试函数 $v_h = N_1$ 和 $v_h = N_2$ 组装方程。\n\n- **方程1（对于 $v_h = N_1$）：**\n该方程接收来自单元1（节点1是局部第二个节点）和单元2（节点1是局部第一个节点）的贡献。\n来自 $\\Omega_1$ 的贡献：$[K^e_{21} \\quad K^e_{22}] \\begin{pmatrix} u_0 \\\\ u_1 \\end{pmatrix} = (-\\frac{k}{h}-a)u_0 + (\\frac{k}{h}+a)u_1$。\n来自 $\\Omega_2$ 的贡献：$[K^e_{11} \\quad K^e_{12}] \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = (\\frac{k}{h})u_1 + (-\\frac{k}{h})u_2$。\n将贡献相加并将已知项移到右侧（RHS），其中 $u_0=1$：\n$(\\frac{k}{h}+a)u_1 + (\\frac{k}{h})u_1 + (-\\frac{k}{h})u_2 = (\\frac{k}{h}+a)u_0 = \\frac{k}{h}+a$。\n$$ \\left(\\frac{2k}{h} + a\\right)u_1 - \\frac{k}{h}u_2 = \\frac{k}{h} + a $$\n\n- **方程2（对于 $v_h = N_2$）：**\n该方程只接收来自单元2的贡献。\n来自 $\\Omega_2$ 的贡献：$[K^e_{21} \\quad K^e_{22}] \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = (-\\frac{k}{h}-a)u_1 + (\\frac{k}{h}+a)u_2$。\n组装后的方程为：\n$$ \\left(-\\frac{k}{h} - a\\right)u_1 + \\left(\\frac{k}{h} + a\\right)u_2 = 0 $$\n\n这些方程必须由分部积分产生的边界项和任何指定的出流处理来修正。扩散通量的分部积分项（IBP）是 $-[k u_{hx} v_h]_{0}^{2h}$。由于对于 $v_h \\in \\{N_1, N_2\\}$ 有 $v_h(0)=0$ 并且 $v_1(2h)=0$，此项仅影响方程2，此时有 $v_2(2h)=1$。其贡献为 $-k u_{hx}(2h)$。在 $\\Omega_2$ 上近似导数，我们得到 $u_{hx}(2h) \\approx (u_2 - u_1)/h$。因此，我们必须从方程2的左侧减去 $\\frac{k}{h}(u_2 - u_1)$。\n\n**4. 无为（DN）出流条件**\n\n对于DN情况，我们包含来自IBP的自然边界项。\n方程1不变：\n(1) $\\left(\\frac{2k}{h} + a\\right)u_1 - \\frac{k}{h}u_2 = \\frac{k}{h} + a$\n方程2变为：\n$\\left(-\\frac{k}{h} - a\\right)u_1 + \\left(\\frac{k}{h} + a\\right)u_2 - \\frac{k}{h}(u_2 - u_1) = 0$\n$\\left(-\\frac{k}{h} - a + \\frac{k}{h}\\right)u_1 + \\left(\\frac{k}{h} + a - \\frac{k}{h}\\right)u_2 = 0$\n(2) $-a u_1 + a u_2 = 0 \\implies u_1 = u_2$。\n\n将 $u_2=u_1$ 代入方程(1)：\n$\\left(\\frac{2k}{h} + a\\right)u_1 - \\frac{k}{h}u_1 = \\frac{k}{h} + a$\n$\\left(\\frac{k}{h} + a\\right)u_1 = \\frac{k}{h} + a \\implies u_1 = 1$。\n因此，$u_{2}^{\\mathrm{DN}} = u_1 = 1$。\n\n**5. 能量稳定（ES）出流条件**\n\n对于ES情况，我们用项 $a u(2h) v(2h)$ 增强弱形式。离散地，这会在左侧（LHS）增加 $a u_2 v_h(2h)$。对于 $v_h=N_1$ 该项为零，对于 $v_h=N_2$ 该项为 $a u_2$。\n所以，方程1与DN情况相同。对于方程2，我们在DN方程(2)的左侧加上 $a u_2$。\n(1) $\\left(\\frac{2k}{h} + a\\right)u_1 - \\frac{k}{h}u_2 = \\frac{k}{h} + a$\n(2) $-a u_1 + a u_2 + a u_2 = 0 \\implies -a u_1 + 2a u_2 = 0 \\implies u_1 = 2u_2$。\n\n将 $u_1 = 2u_2$ 代入方程(1)：\n$\\left(\\frac{2k}{h} + a\\right)(2u_2) - \\frac{k}{h}u_2 = \\frac{k}{h} + a$\n$u_2 \\left( 2\\left(\\frac{2k}{h} + a\\right) - \\frac{k}{h} \\right) = \\frac{k}{h} + a$\n$u_2 \\left( \\frac{4k}{h} + 2a - \\frac{k}{h} \\right) = \\frac{k}{h} + a$\n$u_2 \\left( \\frac{3k}{h} + 2a \\right) = \\frac{k}{h} + a$\n$u_{2}^{\\mathrm{ES}} = \\frac{\\frac{k}{h} + a}{\\frac{3k}{h} + 2a}$。\n\n**6. 相对误差的渐近极限**\n\n相对出流误差定义为 $E_{\\mathrm{out}}(Pe_{h}) = 1 - \\frac{u_{2}^{\\mathrm{ES}}}{u_{2}^{\\mathrm{DN}}}$。\n代入推导出的值：\n$$ E_{\\mathrm{out}}(Pe_{h}) = 1 - \\frac{\\frac{\\frac{k}{h} + a}{\\frac{3k}{h} + 2a}}{1} = 1 - \\frac{\\frac{k}{h} + a}{\\frac{3k}{h} + 2a} $$\n$$ E_{\\mathrm{out}}(Pe_{h}) = \\frac{(\\frac{3k}{h} + 2a) - (\\frac{k}{h} + a)}{\\frac{3k}{h} + 2a} = \\frac{\\frac{2k}{h} + a}{\\frac{3k}{h} + 2a} $$\n我们需要计算 $Pe_{h} = \\frac{ah}{2k} \\to \\infty$ 时的极限。这等价于让比率 $\\frac{k}{ah} \\to 0$。让我们将 $E_{\\mathrm{out}}$ 的分子和分母同除以 $a$：\n$$ E_{\\mathrm{out}}(Pe_{h}) = \\frac{2\\frac{k}{ah} + 1}{3\\frac{k}{ah} + 2} $$\n单元佩克莱数是 $Pe_h = \\frac{ah}{2k}$，所以 $\\frac{k}{ah} = \\frac{1}{2 Pe_h}$。\n$$ E_{\\mathrm{out}}(Pe_{h}) = \\frac{2(\\frac{1}{2 Pe_h}) + 1}{3(\\frac{1}{2 Pe_h}) + 2} = \\frac{\\frac{1}{Pe_h} + 1}{\\frac{3}{2Pe_h} + 2} $$\n现在，我们取 $Pe_h \\to \\infty$ 的极限：\n$$ \\lim_{Pe_{h} \\to \\infty} E_{\\mathrm{out}}(Pe_{h}) = \\lim_{Pe_{h} \\to \\infty} \\frac{\\frac{1}{Pe_h} + 1}{\\frac{3}{2Pe_h} + 2} = \\frac{0 + 1}{0 + 2} = \\frac{1}{2} $$\n相对出流误差的渐近极限是 $\\frac{1}{2}$。",
            "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$"
        },
        {
            "introduction": "对于许多工程应用，我们的最终目标不仅仅是获得一个看起来合理的解，而是要精确地预测某个特定的工程输出量，例如翼型的升力或阻力。本高级练习探讨了稳定化格式的一个微妙但至关重要的特性：伴随一致性（adjoint consistency），以及它如何影响目标泛函的计算精度。通过分析一个故意设计的伴随不一致的SUPG方法，你将推导出该方法对输出量引入的系统性偏差，并理解为了恢复精度需要进行何种修正，这对于面向目标自适应和优化设计至关重要。",
            "id": "3996444",
            "problem": "考虑一个稳态一维对流扩散模型问题，该问题代表了航空航天计算流体力学（CFD）中输出驱动的目标量：求解域 $[0,1]$ 上的函数 $u(x)$，满足 $a\\,\\frac{d u}{d x}(x) - \\nu\\,\\frac{d^{2} u}{d x^{2}}(x) = s(x)$，并带有入流狄利克雷边界条件 $u(0) = 1$ 和出流自然边界条件 $-\\nu\\,\\frac{d u}{d x}(1) = 0$。此处 $a  0$ 是对流速度，$\\nu  0$ 是扩散系数，$s(x)$ 是一个源项。其弱形式为：求 $u \\in H^{1}(0,1)$ 且 $u(0)=1$，使得对于所有满足 $w(0)=0$ 的测试函数 $w \\in H^{1}(0,1)$，都有 $\\int_{0}^{1} \\left( a\\,u'(x)\\,w(x) + \\nu\\,u'(x)\\,w'(x) \\right)\\,dx = \\int_{0}^{1} s(x)\\,w(x)\\,dx + \\left( -\\nu\\,u'(1) \\right)\\,w(1)$。考虑一个使用流线迎风/皮特洛夫-伽辽金（SUPG）思想的稳定化有限元方法：对于单个单元 $[0,1]$ 上的连续分片线性空间中的试探函数 $u_{h}$ 和测试函数 $w_{h}$，通过内部稳定项 $\\int_{0}^{1} \\tau\\,\\left( a\\,u'_{h}(x) - s(x) \\right)\\,a\\,w'_{h}(x)\\,dx$ 来增广弱形式，其中 $\\tau0$ 是一个常数稳定化参数。此格式有意在残差中省略了 $-\\nu\\,u''$ 的贡献，从而失去了伴随一致性。\n\n令目标量（泛函）为 $J(u) = u(1)$，它可作为在出流边界上测量的某个输出（例如，阻力）的代理。在相同的有限元空间中定义离散伴随 $z_{h}$，要求离散双线性形式 $B_{h}(v_{h},z_{h})$ 对所有测试空间中的 $v_{h}$ 满足 $B_{h}(v_{h},z_{h}) = J(v_{h})$，其中 $B_{h}$ 是由上述离散化导出的稳定化双线性形式。在 $[0,1]$ 上使用单个线性单元，节点基函数为 $N_{1}(x) = 1-x$ 和 $N_{2}(x) = x$，并强制施加入流本质边界条件 $u_{h}(0) = 1$，则测试空间由 $N_{2}$ 张成。\n\n1.  从控制方程和边界数据出发，选择制造源 $s(x) = (a - \\nu)\\,\\exp(x)$ 并推导满足 $u(0) = 1$ 和 $-\\nu\\,u'(1) = 0$ 的精确解 $u(x)$。然后计算 $u'(0)$ 和 $u'(1)$。\n\n2.  推导此单单元稳定化方法的离散双线性形式 $B_{h}(v_{h},w_{h})$，并计算标量 $B_{h}(N_{2},N_{2})$。\n\n3.  使用离散伴随的定义，证明 $z_{h}(x) = \\alpha\\,N_{2}(x)$，其中 $\\alpha = 1/B_{h}(N_{2},N_{2})$，并且由伴随一致性缺失引起的输出偏差为 $b = \\int_{0}^{1} \\tau\\,\\nu\\,a\\,u''(x)\\,z'_{h}(x)\\,dx$。将 $b$ 化简为包含 $u'(0)$ 和 $u'(1)$ 的闭式形式。\n\n4.  在此设定下，为恢复 $J(u)$ 的伴随一致性提出所需的最小修正，并解释该修正的物理诠释。\n\n最后，对参数 $a = 5$，$\\nu = 0.02$ 和 $\\tau = 0.1$ 数值计算偏差 $b$。将 $b$ 的最终答案表示为四舍五入到四位有效数字的小数，不带单位。",
            "solution": "用户想要解决一个关于对流扩散方程的稳定化有限元方法的多部分问题。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n-   **控制方程**：在域 $[0,1]$ 上，$a\\,\\frac{d u}{d x}(x) - \\nu\\,\\frac{d^{2} u}{d x^{2}}(x) = s(x)$。\n-   **参数**：对流速度 $a > 0$，扩散系数 $\\nu > 0$。\n-   **边界条件**：$u(0) = 1$（入流狄利克雷），$-\\nu\\,\\frac{d u}{d x}(1) = 0$（出流自然）。\n-   **弱形式**：求 $u \\in H^{1}(0,1)$ 且 $u(0)=1$，使得对于所有满足 $w(0)=0$ 的测试函数 $w \\in H^{1}(0,1)$，都有 $\\int_{0}^{1} \\left( a\\,u'(x)\\,w(x) + \\nu\\,u'(x)\\,w'(x) \\right)\\,dx = \\int_{0}^{1} s(x)\\,w(x)\\,dx + \\left( -\\nu\\,u'(1) \\right)\\,w(1)$。\n-   **稳定化方法**：在单个单元 $[0,1]$ 上的流线迎风/皮特洛夫-伽辽金 (SUPG) 格式。\n-   **稳定项**：$\\int_{0}^{1} \\tau\\,\\left( a\\,u'_{h}(x) - s(x) \\right)\\,a\\,w'_{h}(x)\\,dx$，其中 $\\tau0$ 是一个常数稳定化参数。该项的残差中有意省略了 $-\\nu\\,u''$。\n-   **有限元空间**：在单个单元 $[0,1]$ 上的连续分片线性空间。\n-   **基函数**：节点基函数 $N_{1}(x) = 1-x$ 和 $N_{2}(x) = x$。\n-   **试探/测试空间**：试探函数 $u_h$ 和测试函数 $w_h$。由于强制施加 $u_h(0)=1$，变分的测试空间由 $N_2(x)$ 张成。\n-   **目标量**：$J(u) = u(1)$。\n-   **离散伴随定义**：$z_h$ 由 $B_{h}(v_{h},z_{h}) = J(v_{h})$ 定义，适用于测试空间中的所有 $v_{h}$，其中 $B_h$ 是稳定化双线性形式。\n-   **第1部分任务**：当 $s(x) = (a - \\nu)\\,\\exp(x)$ 时，推导精确解 $u(x)$ 并计算 $u'(0)$ 和 $u'(1)$。\n-   **第2部分任务**：推导离散双线性形式 $B_{h}(v_{h},w_{h})$ 并计算 $B_{h}(N_{2},N_{2})$。\n-   **第3部分任务**：证明 $z_{h}(x) = \\alpha\\,N_{2}(x)$，其中 $\\alpha = 1/B_{h}(N_{2},N_{2})$，并将偏差 $b = \\int_{0}^{1} \\tau\\,\\nu\\,a\\,u''(x)\\,z'_{h}(x)\\,dx$ 化简为闭式形式。\n-   **第4部分任务**：为恢复 $J(u)$ 的伴随一致性提出并解释最小修正。\n-   **最终任务**：当 $a = 5$，$\\nu = 0.02$，$\\tau = 0.1$ 时，数值计算偏差 $b$。\n\n**第2步：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题是偏微分方程数值分析中的一个标准练习，特别关注对流主导流动的稳定化有限元方法（FEM）。SUPG、伴随一致性和目标导向误差估计等概念是计算流体力学（CFD）的核心课题。该问题的设置在科学上和数学上是合理的。\n-   **适定性**：问题清晰地分为四个相继的部分，最终进行数值计算。每个部分都定义明确，并建立在前一部分的基础上，导向一个唯一且有意义的解。\n-   **客观性**：语言正式、精确、明确，使用了数学和有限元方法的标准术语。没有主观或基于观点的陈述。\n-   **完整性和一致性**：提供了所有必要的组成部分：偏微分方程、定义域、边界条件、弱形式（标准的和稳定化的）、基函数以及任务所需的定义。在稳定化残差中故意省略扩散项是该问题设置的一个关键特征，旨在探讨伴随不一致性的概念，而不是一个缺陷。\n\n**第3步：结论和行动**\n\n问题是有效的。这是一个适定、自洽且在科学上合理的关于稳定化有限元方法理论的练习。我现在将进行求解。\n\n### 解答\n\n**第1部分：精确解**\n\n控制微分方程为 $a\\,u' - \\nu\\,u'' = s(x)$。给定源项 $s(x) = (a - \\nu)\\,\\exp(x)$，方程为：\n$$\n\\nu\\,u'' - a\\,u' = -(a - \\nu)\\,\\exp(x)\n$$\n这是一个二阶线性常微分方程。通解是齐次解 $u_c(x)$ 和一个特解 $u_p(x)$ 的和。\n\n齐次部分（$\\nu\\,r^2 - a\\,r = 0$）的特征方程是 $r(\\nu\\,r - a) = 0$，其根为 $r_1 = 0$ 和 $r_2 = a/\\nu$。补解为：\n$$\nu_c(x) = C_1 + C_2\\,\\exp\\left(\\frac{a}{\\nu}x\\right)\n$$\n对于特解，我们使用待定系数法，并假设解的形式为 $u_p(x) = A\\,\\exp(x)$。将其代入常微分方程得到：\n$$\n\\nu\\,(A\\,\\exp(x)) - a\\,(A\\,\\exp(x)) = -(a - \\nu)\\,\\exp(x)\n$$\n$$\nA(\\nu - a)\\,\\exp(x) = -(a - \\nu)\\,\\exp(x)\n$$\n这意味着 $A(\\nu - a) = \\nu - a$，所以 $A = 1$。特解是 $u_p(x) = \\exp(x)$。\n\n通解是 $u(x) = C_1 + C_2\\,\\exp(\\frac{a}{\\nu}x) + \\exp(x)$。我们根据边界条件确定常数 $C_1$ 和 $C_2$。\n第一个边界条件是 $u(0) = 1$：\n$$\nu(0) = C_1 + C_2\\,\\exp(0) + \\exp(0) = C_1 + C_2 + 1 = 1 \\implies C_1 + C_2 = 0 \\implies C_1 = -C_2\n$$\n第二个边界条件是 $-\\nu\\,u'(1) = 0$，因为 $\\nu0$，这意味着 $u'(1) = 0$。通解的导数为：\n$$\nu'(x) = \\frac{a}{\\nu}C_2\\,\\exp\\left(\\frac{a}{\\nu}x\\right) + \\exp(x)\n$$\n在 $x=1$ 处应用该条件：\n$$\nu'(1) = \\frac{a}{\\nu}C_2\\,\\exp\\left(\\frac{a}{\\nu}\\right) + \\exp(1) = 0 \\implies C_2 = -\\frac{\\nu}{a}\\,\\exp(1)\\,\\exp\\left(-\\frac{a}{\\nu}\\right) = -\\frac{\\nu}{a}\\,\\exp\\left(1 - \\frac{a}{\\nu}\\right)\n$$\n于是，$C_1 = -C_2 = \\frac{\\nu}{a}\\,\\exp(1 - \\frac{a}{\\nu})$。\n将常数代回，精确解为：\n$$\nu(x) = \\exp(x) + \\frac{\\nu}{a}\\,\\exp\\left(1 - \\frac{a}{\\nu}\\right) - \\frac{\\nu}{a}\\,\\exp\\left(1 - \\frac{a}{\\nu}\\right)\\exp\\left(\\frac{a}{\\nu}x\\right)\n$$\n$$\nu(x) = \\exp(x) + \\frac{\\nu}{a}\\,\\exp\\left(1 - \\frac{a}{\\nu}\\right)\\left(1 - \\exp\\left(\\frac{a}{\\nu}x\\right)\\right)\n$$\n现在我们计算所需的导数。导数为：\n$$\nu'(x) = \\exp(x) + \\frac{\\nu}{a}\\,\\exp\\left(1 - \\frac{a}{\\nu}\\right)\\left(-\\frac{a}{\\nu}\\exp\\left(\\frac{a}{\\nu}x\\right)\\right) = \\exp(x) - \\exp\\left(1 - \\frac{a}{\\nu}\\right)\\exp\\left(\\frac{a}{\\nu}x\\right)\n$$\n$$\nu'(x) = \\exp(x) - \\exp\\left(1 - \\frac{a}{\\nu} + \\frac{a}{\\nu}x\\right)\n$$\n在 $x=0$ 处：\n$$\nu'(0) = \\exp(0) - \\exp\\left(1 - \\frac{a}{\\nu}\\right) = 1 - \\exp\\left(1 - \\frac{a}{\\nu}\\right)\n$$\n在 $x=1$ 处：\n$$\nu'(1) = \\exp(1) - \\exp\\left(1 - \\frac{a}{\\nu} + \\frac{a}{\\nu}\\right) = \\exp(1) - \\exp(1) = 0\n$$\n结果 $u'(1)=0$ 证实了边界条件的正确应用。\n\n**第2部分：离散双线性形式**\n\n稳定化弱形式是求 $u_h$ 使得对于所有 $w_h$：\n$$\n\\int_{0}^{1} \\left( a\\,u'_{h}w_{h} + \\nu\\,u'_{h}w'_{h} \\right)dx + \\int_{0}^{1} \\tau\\,\\left( a\\,u'_{h} - s \\right)\\,a\\,w'_{h}dx = \\int_{0}^{1} s\\,w_{h}dx\n$$\n我们重新整理这个方程，将涉及未知量 $u_h$ 的项（左手边）与已知项（右手边）分开。\n双线性形式 $B_{h}(u_h, w_h)$ 收集了所有对 $u_h$ 线性的项。\n$$\nB_{h}(u_h, w_h) = \\int_{0}^{1} \\left( a\\,u'_{h}w_{h} + \\nu\\,u'_{h}w'_{h} \\right)dx + \\int_{0}^{1} \\tau\\,(a\\,u'_{h})(a\\,w'_{h})dx\n$$\n合并含有 $u'_h w'_h$ 的项：\n$$\nB_{h}(v_{h}, w_{h}) = \\int_{0}^{1} \\left( a\\,v'_{h}w_{h} + (\\nu + a^2 \\tau) v'_{h}w'_{h} \\right) dx\n$$\n题目要求我们计算 $B_{h}(N_{2}, N_{2})$。为此，我们设 $v_h = N_2(x) = x$ 和 $w_h = N_2(x) = x$。其导数为 $v'_h = N'_2(x) = 1$ 和 $w'_h = N'_2(x) = 1$。\n$$\nB_{h}(N_{2}, N_{2}) = \\int_{0}^{1} \\left( a(1)(x) + (\\nu + a^2 \\tau) (1)(1) \\right) dx = \\int_{0}^{1} (ax + \\nu + a^2\\tau) dx\n$$\n$$\nB_{h}(N_{2}, N_{2}) = \\left[ a\\frac{x^2}{2} + (\\nu + a^2\\tau)x \\right]_0^1 = \\left( a\\frac{1}{2} + \\nu + a^2\\tau \\right) - 0 = \\frac{a}{2} + \\nu + a^2\\tau\n$$\n\n**第3部分：伴随解和偏差项**\n\n离散伴随 $z_h$ 由 $B_{h}(v_{h}, z_{h}) = J(v_{h})$ 定义，适用于测试空间中的所有 $v_h$。测试空间由 $N_2(x)$ 张成，所以我们只需要考虑 $v_h = N_2(x)$。伴随解 $z_h$ 必须满足齐次本质边界条件 $z_h(0)=0$，所以它必须具有形式 $z_h(x) = \\alpha N_2(x)$，其中 $\\alpha$ 是某个常数。泛函为 $J(v_h) = v_h(1)$。\n对于 $v_h = N_2(x)$，我们有 $J(N_2) = N_2(1) = 1$。\n定义 $z_h$ 的方程变为：\n$$\nB_{h}(N_2, \\alpha N_2) = J(N_2) \\implies \\alpha B_{h}(N_2, N_2) = 1\n$$\n解出 $\\alpha$：\n$$\n\\alpha = \\frac{1}{B_{h}(N_{2}, N_{2})} = \\frac{1}{\\frac{a}{2} + \\nu + a^2\\tau}\n$$\n这证实了 $z_h(x) = \\alpha N_2(x)$，其中 $\\alpha$ 如上所述。\n\n由于伴随不一致性导致的偏差项由 $b = \\int_{0}^{1} \\tau\\,\\nu\\,a\\,u''(x)\\,z'_{h}(x)\\,dx$ 给出。\n我们有 $z_h(x) = \\alpha x$，所以其导数 $z'_h(x) = \\alpha$ 是一个常数。\n$$\nb = \\int_{0}^{1} \\tau\\,\\nu\\,a\\,u''(x)\\,\\alpha\\,dx = \\alpha\\tau\\nu a \\int_{0}^{1} u''(x)\\,dx\n$$\n二阶导数的积分使用微积分基本定理计算：\n$$\n\\int_{0}^{1} u''(x)\\,dx = [u'(x)]_0^1 = u'(1) - u'(0)\n$$\n将此代入 $b$ 的表达式中：\n$$\nb = \\alpha\\tau\\nu a (u'(1) - u'(0))\n$$\n现在，我们代入 $\\alpha$、$u'(1)$ 和 $u'(0)$ 的表达式：\n$$\nb = \\left(\\frac{1}{\\frac{a}{2} + \\nu + a^2\\tau}\\right) \\tau\\nu a \\left(0 - \\left(1 - \\exp\\left(1 - \\frac{a}{\\nu}\\right)\\right)\\right)\n$$\n$$\nb = -\\frac{\\tau\\nu a}{\\frac{a}{2} + \\nu + a^2\\tau} \\left(1 - \\exp\\left(1 - \\frac{a}{\\nu}\\right)\\right) = \\frac{\\tau\\nu a}{\\frac{a}{2} + \\nu + a^2\\tau} \\left(\\exp\\left(1 - \\frac{a}{\\nu}\\right) - 1\\right)\n$$\n这是偏差 $b$ 所需的闭式形式。\n\n**第4部分：伴随一致性的修正**\n\n伴随一致性之所以丧失，是因为稳定项 $\\int_{0}^{1} \\tau\\,( a\\,u'_{h} - s )\\,a\\,w'_{h}\\,dx$ 使用了真实微分方程残差 $R(u) = a u' - \\nu u'' - s$ 的不完整表示。该格式省略了扩散项 $-\\nu u''$。\n\n为了恢复伴随一致性，稳定项必须基于完整的残差。最小的修正是将省略项的贡献加回到格式中。要添加到弱形式中的修正项是：\n$$\nC(u_h, w_h) = \\int_{0}^{1} \\tau\\,(-\\nu\\,u_h'')\\,a\\,w'_h\\,dx\n$$\n对于 $C^0$ 分片线性函数的有限元空间，二阶导数 $u_h''$ 在单元内部没有很好的定义（它为零），但在节点处会产生狄拉克δ分布。为了正确处理这一点，修正项在单元域 $K=[0,1]$ 上进行分部积分：\n$$\nC(u_h, w_h) = \\int_{0}^{1} \\tau a \\nu u'_h (w'_h)' dx - [\\tau a \\nu u'_h w'_h]_0^1\n$$\n由于 $w_h$ 是单元上的线性多项式，其一阶导数 $w'_h$ 是常数，其二阶导数 $(w'_h)'$ 是零。因此，积分消失。修正项简化为边界项：\n$$\nC(u_h, w_h) = -[\\tau a \\nu u'_h w'_h]_0^1\n$$\n这是为恢复伴随一致性而需要添加到双线性形式 $B_h(u_h,w_h)$ 中的最小修正。这种修正后的方法是伽辽金/最小二乘（GLS）方法的一种形式。\n\n**物理诠释：** 标准的SUPG稳定化方法纯粹在流线方向上增加了由参数 $\\tau a^2$ 调节大小的人工扩散，以抑制振荡。不一致的格式仅基于残差的对流部分来计算这种扩散的需求。修正项将物理扩散（$\\nu$）的影响重新引入到稳定化中。它在物理扩散和流线方向的人工扩散之间建立了耦合。这确保了稳定化的量对问题的完整物理特性（由单元佩克莱数表示）敏感，而不仅仅是对流输运，从而得到一个更准确、更鲁棒的数值格式。\n\n**偏差的最终数值计算**\n\n我们对给定的参数计算偏差 $b$：$a = 5$，$\\nu = 0.02$，$\\tau = 0.1$。\n$b$ 的表达式为：\n$$\nb = \\frac{\\tau\\nu a}{\\frac{a}{2} + \\nu + a^2\\tau} \\left(\\exp\\left(1 - \\frac{a}{\\nu}\\right) - 1\\right)\n$$\n首先，我们计算各个部分：\n-   $\\tau\\nu a = (0.1)(0.02)(5) = 0.01$\n-   $\\frac{a}{2} + \\nu + a^2\\tau = \\frac{5}{2} + 0.02 + (5^2)(0.1) = 2.5 + 0.02 + (25)(0.1) = 2.5 + 0.02 + 2.5 = 5.02$\n-   $1 - \\frac{a}{\\nu} = 1 - \\frac{5}{0.02} = 1 - 250 = -249$\n-   $\\exp(1 - \\frac{a}{\\nu}) - 1 = \\exp(-249) - 1$。项 $\\exp(-249)$ 是一个极度接近于零的数。在实际计算中，$\\exp(-249) - 1 \\approx -1$。\n\n将这些值代入 $b$ 的表达式中：\n$$\nb \\approx \\frac{0.01}{5.02} \\times (-1) = -0.00199203187...\n$$\n将结果四舍五入到四位有效数字得到 $-0.001992$。",
            "answer": "$$\\boxed{-0.001992}$$"
        }
    ]
}