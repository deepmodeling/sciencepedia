{
    "hands_on_practices": [
        {
            "introduction": "The stability of a numerical scheme is paramount for obtaining physically meaningful results. This first practice provides a foundational exercise in stability analysis, focusing on the explicit forward Euler time-stepping method applied to the heat equation . By directly analyzing the coefficients of the discretized update formula, you will derive the classic time step constraint required to guarantee that the numerical solution does not grow unboundedly and that an initially non-negative quantity, like a concentration, remains non-negative. This exercise is essential for understanding the limitations of explicit methods and the origins of their conditional stability.",
            "id": "3955314",
            "problem": "In Computational Fluid Dynamics (CFD) for aerospace applications, the diffusion of a passive scalar transported by molecular diffusion alone is governed by a parabolic Partial Differential Equation (PDE). Consider the one-dimensional diffusion equation\n$$\nu_{t}=\\nu\\,u_{xx}\n$$\non the spatial interval $$[0,L]$$ with homogeneous Dirichlet boundary conditions\n$$\nu(0,t)=0,\\quad u(L,t)=0,\n$$\nand nonnegative initial data\n$$\nu(x,0)\\ge 0 \\quad \\text{for all } x\\in[0,L].\n$$\nLet the spatial domain be discretized on a uniform grid $$x_{i}=i\\,h$$ with $$i\\in\\{0,1,\\dots,N\\}$$ and $$h=L/N$$, and denote the grid function at time level $$t^{n}=n\\,\\Delta t$$ by $$u_{i}^{n}\\approx u(x_{i},t^{n})$$. Use a second-order central difference approximation for $$u_{xx}$$ in space and the explicit forward Euler method in time to produce a fully discrete scheme for the interior nodes $$i\\in\\{1,2,\\dots,N-1\\}$$, while enforcing the boundary conditions as $$u_{0}^{n}=0$$ and $$u_{N}^{n}=0$$ for all $$n$$.\n\nBy requiring that the fully discrete solution preserves both:\n- a discrete maximum principle in the $$\\ell^{\\infty}$$ norm (that is, the discrete $$\\ell^{\\infty}$$ norm does not increase in time), and\n- nonnegativity for all subsequent time levels $$n\\ge 1$$ whenever the initial data are nonnegative,\n\nderive the sharp upper bound on the time step $$\\Delta t$$ in terms of the kinematic diffusivity $$\\nu$$ and the grid spacing $$h$$ that ensures both properties. Show that your condition is both necessary and sufficient under the stated discretization and boundary enforcement.\n\nExpress your final result as a single closed-form analytic expression in terms of $$\\nu$$ and $$h$$ only. Do not include units in your final expression. Interpret $$\\nu$$ in square meters per second and $$h$$ in meters so that $$\\Delta t$$ is in seconds.",
            "solution": "The problem requires the derivation of the sharp upper bound on the time step $\\Delta t$ for a numerical scheme applied to the one-dimensional diffusion equation, such that the scheme preserves nonnegativity and a discrete maximum principle.\n\nThe governing partial differential equation (PDE) is the one-dimensional diffusion equation:\n$$\nu_{t}=\\nu\\,u_{xx}\n$$\non the domain $x \\in [0, L]$, with homogeneous Dirichlet boundary conditions $u(0,t)=0$ and $u(L,t)=0$, and a nonnegative initial condition $u(x,0) \\ge 0$.\n\nFirst, we formulate the fully discrete numerical scheme. The spatial domain $[0,L]$ is discretized with a uniform grid $x_i = i h$ for $i \\in \\{0, 1, \\dots, N\\}$, where $h=L/N$. The time domain is discretized by time levels $t^n = n \\Delta t$. The numerical solution at grid point $(x_i, t^n)$ is denoted by $u_i^n$.\n\nThe time derivative $u_t$ is approximated using the explicit forward Euler method:\n$$\nu_t(x_i, t^n) \\approx \\frac{u_i^{n+1} - u_i^n}{\\Delta t}\n$$\n\nThe second spatial derivative $u_{xx}$ is approximated using a second-order central difference scheme:\n$$\nu_{xx}(x_i, t^n) \\approx \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2}\n$$\n\nSubstituting these approximations into the PDE gives the scheme for the interior nodes $i \\in \\{1, 2, \\dots, N-1\\}$:\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\nu \\left( \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} \\right)\n$$\n\nSolving for the solution at the next time step, $u_i^{n+1}$:\n$$\nu_i^{n+1} = u_i^n + \\frac{\\nu \\Delta t}{h^2} (u_{i+1}^n - 2u_i^n + u_{i-1}^n)\n$$\n\nLet's define the dimensionless parameter $s = \\frac{\\nu \\Delta t}{h^2}$, which is often called the mesh Fourier number or numerical diffusion number. The update equation can be rewritten by collecting terms at time level $n$:\n$$\nu_i^{n+1} = u_i^n + s u_{i+1}^n - 2s u_i^n + s u_{i-1}^n\n$$\n$$\nu_i^{n+1} = s u_{i-1}^n + (1 - 2s) u_i^n + s u_{i+1}^n\n$$\nThis is the update rule for the interior nodes. The boundary conditions are enforced as $u_0^n = 0$ and $u_N^n = 0$ for all time levels $n \\ge 0$.\n\nNow, we analyze the two required properties to find the condition on $s$, and thus on $\\Delta t$.\n\n**1. Nonnegativity Preservation**\n\nWe require that if $u_i^n \\ge 0$ for all $i \\in \\{0, 1, \\dots, N\\}$, then $u_i^{n+1} \\ge 0$ for all $i$. By induction, this will ensure nonnegativity for all time, given $u_i^0 \\ge 0$.\n\nThe update rule expresses $u_i^{n+1}$ as a linear combination of values at time level $n$: $u_{i-1}^n$, $u_i^n$, and $u_{i+1}^n$. If we assume $u_j^n \\ge 0$ for all $j$, then a sufficient condition to ensure $u_i^{n+1} \\ge 0$ is that all coefficients in the linear combination are non-negative.\nThe coefficients are $s$, $(1-2s)$, and $s$.\nSince $\\nu > 0$, $\\Delta t > 0$, and $h > 0$, the parameter $s = \\frac{\\nu \\Delta t}{h^2}$ is always positive.\nThe only remaining condition is for the coefficient of $u_i^n$:\n$$\n1 - 2s \\ge 0 \\implies 2s \\le 1 \\implies s \\le \\frac{1}{2}\n$$\nAt the boundaries, $u_0^{n+1}=0$ and $u_N^{n+1}=0$, which are non-negative.\nTherefore, the condition $s \\le \\frac{1}{2}$ is **sufficient** for nonnegativity preservation.\n\nTo show this condition is also **necessary**, we must show that if $s > \\frac{1}{2}$, there exists a non-negative initial condition $u_i^0 \\ge 0$ for which the scheme produces a negative value at the next time step. Consider an initial condition with a single non-zero value at an interior node $k \\in \\{1, \\dots, N-1\\}$, such as $u_k^0 = 1$ and $u_i^0 = 0$ for all $i \\ne k$. This initial condition is non-negative. Applying the scheme for one time step, we find the value at node $k$:\n$$\nu_k^1 = s u_{k-1}^0 + (1-2s) u_k^0 + s u_{k+1}^0 = s(0) + (1-2s)(1) + s(0) = 1 - 2s\n$$\nIf $s > \\frac{1}{2}$, then $2s>1$, and $1-2s  0$. Thus, $u_k^1  0$, which violates the nonnegativity requirement. Therefore, the condition $s \\le \\frac{1}{2}$ is both necessary and sufficient for nonnegativity preservation.\n\n**2. Discrete Maximum Principle**\n\nThe discrete maximum principle (in the $\\ell^{\\infty}$ norm) states that the maximum absolute value of the solution does not grow in time: $\\|u^{n+1}\\|_{\\infty} \\le \\|u^n\\|_{\\infty}$, where $\\|u^n\\|_{\\infty} = \\max_{i} |u_i^n|$. Let $M^n = \\|u^n\\|_{\\infty}$.\n\nLet's analyze the update rule under the condition $s \\le \\frac{1}{2}$.\n$$\n|u_i^{n+1}| = |s u_{i-1}^n + (1 - 2s) u_i^n + s u_{i+1}^n|\n$$\nUsing the triangle inequality:\n$$\n|u_i^{n+1}| \\le |s u_{i-1}^n| + |(1 - 2s) u_i^n| + |s u_{i+1}^n| = |s||u_{i-1}^n| + |1 - 2s||u_i^n| + |s||u_{i+1}^n|\n$$\nSince we established that $0  s \\le \\frac{1}{2}$, the coefficients $s$ and $(1-2s)$ are non-negative. So, $|s| = s$ and $|1-2s| = 1-2s$.\n$$\n|u_i^{n+1}| \\le s|u_{i-1}^n| + (1 - 2s)|u_i^n| + s|u_{i+1}^n|\n$$\nBy definition of the maximum norm, $|u_j^n| \\le M^n$ for all $j$. Substituting this into the inequality:\n$$\n|u_i^{n+1}| \\le s M^n + (1 - 2s) M^n + s M^n = (s + 1 - 2s + s) M^n = M^n\n$$\nThis result, $|u_i^{n+1}| \\le M^n$, holds for all interior nodes $i$. For the boundary nodes, $|u_0^{n+1}|=0 \\le M^n$ and $|u_N^{n+1}|=0 \\le M^n$ (assuming a non-trivial initial condition where $M^n > 0$).\nSince $|u_i^{n+1}| \\le M^n$ for all $i \\in \\{0, 1, \\dots, N\\}$, we can conclude that $\\max_i |u_i^{n+1}| \\le M^n$. This is precisely $\\|u^{n+1}\\|_{\\infty} \\le \\|u^n\\|_{\\infty}$. Thus, the condition $s \\le \\frac{1}{2}$ is **sufficient** for the discrete maximum principle to hold.\n\nTo show that the condition is also **necessary** for the discrete maximum principle, we again construct a counterexample for the case $s > \\frac{1}{2}$. The principle must hold for any initial data. Consider an oscillatory initial condition, such as $u_i^0 = (-1)^i$ for $i \\in \\{1, \\dots, N-1\\}$, with $u_0^0=0, u_N^0=0$. The maximum norm of this initial data is $\\|u^0\\|_{\\infty}=1$. Let's examine an interior node $k$ where $u_k^0 = 1$. Its neighbors will be $u_{k-1}^0 = -1$ and $u_{k+1}^0 = -1$.\nThe value at this node at the next time step is:\n$$\nu_k^1 = s u_{k-1}^0 + (1-2s) u_k^0 + s u_{k+1}^0 = s(-1) + (1-2s)(1) + s(-1) = -s + 1 - 2s - s = 1 - 4s\n$$\nIf $s > \\frac{1}{2}$, then $4s > 2$, which implies $1-4s  -1$.\nThe absolute value is $|u_k^1| = |1-4s| = 4s - 1$. Since $s > \\frac{1}{2}$, we have $4s-1 > 4(\\frac{1}{2})-1 = 1$.\nSo, $|u_k^1| > 1 = \\|u^0\\|_{\\infty}$. This means $\\|u^1\\|_{\\infty} > \\|u^0\\|_{\\infty}$, which violates the discrete maximum principle. Therefore, the condition $s \\le \\frac{1}{2}$ is also **necessary**.\n\n**Conclusion**\n\nBoth nonnegativity preservation and the discrete maximum principle require the condition $s \\le \\frac{1}{2}$, and this condition is both necessary and sufficient for each property. The problem asks for the sharp upper bound on $\\Delta t$ that ensures both. This bound is found by setting $s$ to its maximum allowed value:\n$$\ns = \\frac{\\nu \\Delta t}{h^2} = \\frac{1}{2}\n$$\nSolving for $\\Delta t$:\n$$\n\\Delta t = \\frac{h^2}{2\\nu}\n$$\nThe condition that guarantees both properties is $\\Delta t \\le \\frac{h^2}{2\\nu}$. The sharp upper bound is the equality case.",
            "answer": "$$\n\\boxed{\\frac{h^2}{2\\nu}}\n$$"
        },
        {
            "introduction": "A common misconception is that using an unconditionally stable time integration method, such as backward Euler, automatically guarantees a well-behaved, bounded solution. This exercise serves as a powerful counterexample to that notion, demonstrating that the properties of the spatial discretization are equally critical . You will investigate an advection-diffusion problem where a standard centered-difference scheme for the advection term fails to produce a system matrix with the necessary structure to enforce the Discrete Maximum Principle (DMP), leading to non-physical oscillations, even with an A-stable time integrator. This practice highlights the crucial interplay between spatial and temporal schemes and the importance of ensuring the fully discrete operator satisfies the M-matrix property.",
            "id": "3955271",
            "problem": "Consider one-dimensional transient advection–diffusion of a bounded scalar in aerospace Computational Fluid Dynamics (CFD), modeled on the spatial interval $x \\in [0,3]$ with Dirichlet boundary conditions $u(0,t)=0$ and $u(3,t)=1$. The governing equation is\n$$\n\\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} = D \\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\nwhere $U$ is the uniform advection speed and $D$ is the molecular diffusivity. Discretize the spatial domain on a uniform grid with nodes at $x=0,1,2,3$ so that the interior unknowns are $u_{1}(t)=u(1,t)$ and $u_{2}(t)=u(2,t)$, with grid spacing $\\Delta x = 1$. Use second-order centered finite differences for both the first and second spatial derivatives. Denote the semi-discrete system in the form $\\dot{\\boldsymbol{u}} = \\boldsymbol{A}\\boldsymbol{u} + \\boldsymbol{f}$ after enforcing the Dirichlet boundary conditions at $x=0$ and $x=3$.\n\nAdvance this system in time using the backward Euler method, which is known to be absolutely stable (A-stable), with time step $\\Delta t = 4$. Take $U=-1$ and $D=0.1$ (both in consistent SI units), and an initial interior state $u_{1}^{n}=u_{2}^{n}=\\frac{1}{2}$. Using only these inputs and the stated discretizations, carry out one backward Euler step to compute $\\boldsymbol{u}^{n+1}$ from the linear system\n$$\n\\left(\\boldsymbol{I} - \\Delta t\\,\\boldsymbol{A}\\right)\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t\\,\\boldsymbol{f}.\n$$\nThen, evaluate the violation of the Discrete Maximum Principle (DMP) by computing the maximum overshoot above the upper boundary value $1$,\n$$\n\\max\\left\\{\\max\\left(u_{1}^{n+1},u_{2}^{n+1}\\right) - 1,\\;0\\right\\}.\n$$\nExpress your final answer as a single exact value (no units). No rounding is required. This construction should serve as a counterexample demonstrating that an A-stable method can fail to preserve a DMP when paired with a non-monotone spatial discretization lacking an M-matrix structure.",
            "solution": "The problem asks us to compute the solution after one backward Euler step for a one-dimensional advection-diffusion equation and to quantify the violation of the discrete maximum principle.\n\n**1. Formulate the Semi-Discrete System**\n\nThe governing equation is:\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^{2} u}{\\partial x^{2}} - U \\frac{\\partial u}{\\partial x}\n$$\nWe discretize the spatial derivatives at the interior nodes $x_1=1$ and $x_2=2$ using second-order centered differences with $\\Delta x=1$. The boundary conditions are $u_0=u(0,t)=0$ and $u_3=u(3,t)=1$.\n\nFor node $i=1$:\n$$\n\\frac{du_1}{dt} = D \\left(\\frac{u_2 - 2u_1 + u_0}{(\\Delta x)^2}\\right) - U \\left(\\frac{u_2 - u_0}{2\\Delta x}\\right)\n$$\nSubstituting $u_0=0$ and $\\Delta x=1$:\n$$\n\\frac{du_1}{dt} = D(u_2 - 2u_1) - U \\frac{u_2}{2} = (-2D)u_1 + \\left(D - \\frac{U}{2}\\right)u_2\n$$\n\nFor node $i=2$:\n$$\n\\frac{du_2}{dt} = D \\left(\\frac{u_3 - 2u_2 + u_1}{(\\Delta x)^2}\\right) - U \\left(\\frac{u_3 - u_1}{2\\Delta x}\\right)\n$$\nSubstituting $u_3=1$ and $\\Delta x=1$:\n$$\n\\frac{du_2}{dt} = D(1 - 2u_2 + u_1) - U \\frac{1 - u_1}{2} = (D + \\frac{U}{2})u_1 - 2Du_2 + \\left(D - \\frac{U}{2}\\right)\n$$\n\nThis gives the semi-discrete system $\\dot{\\boldsymbol{u}} = \\boldsymbol{A}\\boldsymbol{u} + \\boldsymbol{f}$ with $\\boldsymbol{u} = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$:\n$$\n\\boldsymbol{A} = \\begin{pmatrix} -2D  D - \\frac{U}{2} \\\\ D + \\frac{U}{2}  -2D \\end{pmatrix}, \\quad \\boldsymbol{f} = \\begin{pmatrix} 0 \\\\ D - \\frac{U}{2} \\end{pmatrix}\n$$\n\n**2. Substitute Parameters**\n\nGiven $U=-1$, $D=0.1$, and $\\Delta t = 4$:\n$$\n-2D = -0.2 = -\\frac{1}{5}\n$$\n$$\nD - \\frac{U}{2} = 0.1 - \\frac{-1}{2} = 0.6 = \\frac{3}{5}\n$$\n$$\nD + \\frac{U}{2} = 0.1 + \\frac{-1}{2} = -0.4 = -\\frac{2}{5}\n$$\nThe system matrices become:\n$$\n\\boldsymbol{A} = \\begin{pmatrix} -1/5  3/5 \\\\ -2/5  -1/5 \\end{pmatrix}, \\quad \\boldsymbol{f} = \\begin{pmatrix} 0 \\\\ 3/5 \\end{pmatrix}\n$$\nNote that the positive off-diagonal entry $A_{12}=3/5$ means $\\boldsymbol{A}$ is not a Z-matrix, and therefore cannot be an M-matrix, which foreshadows a violation of the DMP.\n\n**3. Construct and Solve the Backward Euler System**\n\nThe backward Euler method gives the linear system:\n$$\n\\left(\\boldsymbol{I} - \\Delta t\\,\\boldsymbol{A}\\right)\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t\\,\\boldsymbol{f}\n$$\nThe left-hand side matrix is:\n$$\n\\boldsymbol{I} - \\Delta t\\,\\boldsymbol{A} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - 4 \\begin{pmatrix} -1/5  3/5 \\\\ -2/5  -1/5 \\end{pmatrix} = \\begin{pmatrix} 1+4/5  -12/5 \\\\ 8/5  1+4/5 \\end{pmatrix} = \\begin{pmatrix} 9/5  -12/5 \\\\ 8/5  9/5 \\end{pmatrix}\n$$\nThe right-hand side vector, with $\\boldsymbol{u}^n = \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix}$, is:\n$$\n\\boldsymbol{u}^{n} + \\Delta t\\,\\boldsymbol{f} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix} + 4 \\begin{pmatrix} 0 \\\\ 3/5 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 1/2 + 12/5 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 5/10 + 24/10 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 29/10 \\end{pmatrix}\n$$\nThe system to solve is:\n$$\n\\begin{pmatrix} 9/5  -12/5 \\\\ 8/5  9/5 \\end{pmatrix} \\begin{pmatrix} u_1^{n+1} \\\\ u_2^{n+1} \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 29/10 \\end{pmatrix}\n$$\nThe determinant of the coefficient matrix is $\\det = (9/5)(9/5) - (-12/5)(8/5) = (81+96)/25 = 177/25$.\nSolving for $\\boldsymbol{u}^{n+1}$ using the inverse matrix:\n$$\n\\begin{pmatrix} u_1^{n+1} \\\\ u_2^{n+1} \\end{pmatrix} = \\frac{25}{177} \\begin{pmatrix} 9/5  12/5 \\\\ -8/5  9/5 \\end{pmatrix} \\begin{pmatrix} 1/2 \\\\ 29/10 \\end{pmatrix} = \\frac{25}{177} \\begin{pmatrix} (9/10) + (348/50) \\\\ (-8/10) + (261/50) \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} u_1^{n+1} \\\\ u_2^{n+1} \\end{pmatrix} = \\frac{25}{177} \\begin{pmatrix} (45+348)/50 \\\\ (-40+261)/50 \\end{pmatrix} = \\frac{25}{177} \\begin{pmatrix} 393/50 \\\\ 221/50 \\end{pmatrix} = \\frac{1}{177 \\cdot 2} \\begin{pmatrix} 393 \\\\ 221 \\end{pmatrix}\n$$\nSince $393 = 3 \\cdot 131$ and $177 = 3 \\cdot 59$:\n$$\nu_1^{n+1} = \\frac{393}{354} = \\frac{131}{118}\n$$\nSince $221 = 13 \\cdot 17$ and $354 = 2 \\cdot 3 \\cdot 59$:\n$$\nu_2^{n+1} = \\frac{221}{354}\n$$\n\n**4. Evaluate DMP Violation**\n\nThe solution vector is $\\boldsymbol{u}^{n+1} = \\begin{pmatrix} 131/118 \\\\ 221/354 \\end{pmatrix}$. The physical bounds of the problem are set by the initial and boundary conditions, which lie in the range $[0,1]$.\nWe check if the new solution exceeds the upper bound of 1:\n$$\nu_1^{n+1} = \\frac{131}{118} > 1\n$$\n$$\nu_2^{n+1} = \\frac{221}{354}  1\n$$\nThe maximum value at the interior is $u_1^{n+1} = 131/118$. The overshoot above the boundary maximum of 1 is:\n$$\n\\text{Overshoot} = u_1^{n+1} - 1 = \\frac{131}{118} - 1 = \\frac{131 - 118}{118} = \\frac{13}{118}\n$$\nThe required quantity is $\\max\\left\\{\\max\\left(u_{1}^{n+1},u_{2}^{n+1}\\right) - 1,\\;0\\right\\} = \\max\\left\\{\\frac{13}{118}, 0\\right\\} = \\frac{13}{118}$.\n\nThis non-zero overshoot demonstrates the violation of the Discrete Maximum Principle.",
            "answer": "$$\\boxed{\\frac{13}{118}}$$"
        },
        {
            "introduction": "Moving beyond the analysis of individual coefficients, this practice delves into the deeper algebraic foundations of the Discrete Maximum Principle. By examining a steady-state diffusion-reaction equation, you will connect the DMP to the concept of matrix monotonicity and the spectral properties of the discrete operator . This exercise requires you to determine how a reaction term affects the system's positive-definiteness and, consequently, its satisfaction of the DMP. Successfully completing this problem will provide you with a more powerful, abstract framework for analyzing and designing numerical schemes that preserve essential physical bounds.",
            "id": "3955293",
            "problem": "In a simplified one-dimensional model motivated by Computational Fluid Dynamics (CFD) in aerospace applications, consider the steady diffusion–reaction balance for a scalar transported species along a wall-normal line segment of length $L$, with constant molecular diffusivity $\\kappa0$ and a linearized reaction source $\\alpha u$. On the continuous level, the operator is $-\\frac{d}{dx}\\left(\\kappa \\frac{du}{dx}\\right)+\\alpha u$. Discretize the interval $[0,L]$ with $N$ interior nodes using a uniform grid with spacing $h=L/(N+1)$ and impose Dirichlet data $u(0)=\\bar{u}_0$, $u(L)=\\bar{u}_L$. Use the standard second-order central difference to approximate the diffusion term at interior nodes. This produces a linear system $A(\\alpha)\\, \\mathbf{u}=\\mathbf{b}$ for the interior unknowns $\\mathbf{u}\\in\\mathbb{R}^N$, where the coefficient matrix $A(\\alpha)$ is real, symmetric, and tridiagonal.\n\nStarting from fundamental definitions of the discrete maximum principle (DMP) and matrix monotonicity, and without assuming any pre-stated spectral formulas, do the following:\n- Establish, from first principles, why adding a nonnegative reaction coefficient $\\alpha\\ge 0$ to the standard diffusion discretization preserves the DMP on any uniform grid, independently of $h$ and $N$.\n- Determine the sharp threshold $\\alpha_{\\star}$ (which may be negative) such that the DMP holds for all right-hand sides and Dirichlet boundary data if and only if $\\alpha\\alpha_{\\star}$, and fails in general if $\\alpha\\alpha_{\\star}$. Your reasoning should connect the DMP to inverse positivity of $A(\\alpha)$ and the spectral properties of the discrete diffusion operator.\n\nProvide your final answer as a single closed-form expression for $\\alpha_{\\star}$ in terms of $\\kappa$, $h$, and $N$. Do not include units in the final answer. No numerical rounding is required; give an exact symbolic expression. Express the final answer as an analytic expression.",
            "solution": "The problem asks for an analysis of the discrete maximum principle (DMP) for a one-dimensional steady diffusion-reaction equation. We will first validate the problem, then proceed to the solution, which consists of two parts: showing the DMP holds for non-negative reaction coefficient $\\alpha$, and finding the sharp threshold $\\alpha_{\\star}$ for which the DMP holds if and only if $\\alpha > \\alpha_{\\star}$.\n\nThe continuous problem is given by the operator $-\\frac{d}{dx}\\left(\\kappa \\frac{du}{dx}\\right)+\\alpha u = f(x)$ on the interval $[0,L]$ with Dirichlet boundary conditions $u(0)=\\bar{u}_0$ and $u(L)=\\bar{u}_L$. The domain is discretized with $N$ interior nodes $x_i = ih$ for $i=1, \\dots, N$, and boundary nodes $x_0=0$ and $x_{N+1}=L$. The grid spacing is $h=L/(N+1)$.\n\nWe approximate the second derivative using a standard second-order central difference scheme:\n$$ \\frac{d^2u}{dx^2}\\bigg|_{x=x_i} \\approx \\frac{u(x_{i+1}) - 2u(x_i) + u(x_{i-1})}{h^2} = \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} $$\nSubstituting this into the governing equation at an interior node $x_i$, we obtain the discrete equation:\n$$ -\\kappa \\left( \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} \\right) + \\alpha u_i = f_i $$\nThis can be rearranged to define the discrete operator $(L_h u)_i$:\n$$ (L_h u)_i = \\frac{-\\kappa}{h^2} u_{i-1} + \\left(\\frac{2\\kappa}{h^2} + \\alpha\\right) u_i + \\frac{-\\kappa}{h^2} u_{i+1} = f_i $$\nThis set of $N$ linear equations for the interior unknowns $\\mathbf{u} = [u_1, u_2, \\dots, u_N]^T$ forms the system $A(\\alpha)\\mathbf{u} = \\mathbf{b}$. The matrix $A(\\alpha)$ is an $N \\times N$ real, symmetric, tridiagonal matrix. Its diagonal entries are $(A(\\alpha))_{ii} = \\frac{2\\kappa}{h^2} + \\alpha$, and its off-diagonal entries are $(A(\\alpha))_{i,i\\pm 1} = -\\frac{\\kappa}{h^2}$. The right-hand side vector $\\mathbf{b}$ incorporates the source term $\\mathbf{f}=[f_1, \\dots, f_N]^T$ and the boundary conditions. For $i=1$, the equation is $(\\frac{2\\kappa}{h^2} + \\alpha)u_1 - \\frac{\\kappa}{h^2}u_2 = f_1 + \\frac{\\kappa}{h^2}\\bar{u}_0$. For $i=N$, it is $-\\frac{\\kappa}{h^2}u_{N-1} + (\\frac{2\\kappa}{h^2} + \\alpha)u_N = f_N + \\frac{\\kappa}{h^2}\\bar{u}_L$.\n\nPart 1: Preservation of the DMP for $\\alpha \\ge 0$.\nThe discrete maximum principle states that if the source term is non-positive, the maximum of the solution cannot occur at an interior point unless the solution is constant. More formally for our operator, if $(L_h u)_i \\le 0$ for all interior nodes $i=1, \\dots, N$, then the maximum of the discrete solution $\\{u_i\\}_{i=0}^{N+1}$ must be attained on the boundary. That is, $\\max_{0 \\le i \\le N+1} u_i \\le \\max(\\bar{u}_0, \\bar{u}_L)$, assuming the maximum is non-negative.\n\nTo prove this from first principles, let us assume for contradiction that the maximum value of $u_i$ occurs at an interior node $k \\in \\{1, \\dots, N\\}$. Let this maximum be $u_k$. By definition of a maximum, $u_k \\ge u_{k-1}$ and $u_k \\ge u_{k+1}$.\nLet's analyze the discrete operator $(L_h u)_k$ at this point:\n$$ (L_h u)_k = \\left(\\frac{2\\kappa}{h^2} + \\alpha\\right) u_k - \\frac{\\kappa}{h^2} u_{k-1} - \\frac{\\kappa}{h^2} u_{k+1} $$\nWe can rewrite this as:\n$$ (L_h u)_k = \\frac{\\kappa}{h^2} (u_k - u_{k-1}) + \\frac{\\kappa}{h^2} (u_k - u_{k+1}) + \\alpha u_k $$\nBy our assumption, $(u_k - u_{k-1}) \\ge 0$ and $(u_k - u_{k+1}) \\ge 0$. Since $\\kappa > 0$ and $h > 0$, the first two terms are non-negative.\nNow, consider the case where $\\alpha \\ge 0$.\nIf $u_k > 0$, then $\\alpha u_k \\ge 0$. If the maximum is strict (i.e., $u_k > u_{k-1}$ or $u_k > u_{k+1}$), then at least one of the first two terms is strictly positive, which implies $(L_h u)_k > 0$. This contradicts the condition that $(L_h u)_i \\le 0$ for all $i$.\nIf the maximum is not strict (e.g., $u_k = u_{k-1}$), the argument can be extended to the connected set of nodes where the maximum is attained, until a boundary or a point with a smaller value is reached. The core conclusion holds: a non-negative maximum cannot be sustained in the interior if the source term is non-positive.\nIf the maximum value $u_k \\le 0$, then the proposition $\\max u_i \\le \\max(\\bar{u}_0, \\bar{u}_L)$ holds trivially if the boundary data is non-negative. More generally, if $(L_h u)_i \\le 0$ for all $i$, a positive maximum cannot occur in the interior. The maximum must therefore be attained at the boundary or be less than or equal to $0$. This implies $\\max_{1 \\le i \\le N} u_i \\le \\max(0, \\bar{u}_0, \\bar{u}_L)$. This argument depends only on the non-negativity of $\\kappa$ and $\\alpha$, and not on the specific values of $h$ or $N$.\n\nPart 2: The sharp threshold $\\alpha_{\\star}$.\nThe DMP is intimately connected to the concept of M-matrices and inverse positivity. A matrix $A$ is an M-matrix if its off-diagonal entries are non-positive ($A_{ij} \\le 0$ for $i \\ne j$), and its inverse is non-negative ($A^{-1} \\ge 0$, element-wise). A matrix with non-positive off-diagonal entries is called a Z-matrix.\nOur matrix $A(\\alpha)$ is a Z-matrix, as its off-diagonal entries are $-\\kappa/h^2 \\le 0$. For a Z-matrix, the property of being an M-matrix (and thus inverse-positive) is equivalent to several other conditions. Since $A(\\alpha)$ is also symmetric, the condition simplifies greatly: a symmetric Z-matrix is an M-matrix if and only if it is positive definite.\nThe DMP holds for all right-hand sides and boundary data if and only if $A(\\alpha)$ is an M-matrix. Therefore, we need to find the condition on $\\alpha$ that makes $A(\\alpha)$ positive definite. A symmetric matrix is positive definite if and only if all of its eigenvalues are strictly positive.\n\nThe matrix $A(\\alpha)$ can be written as $A(\\alpha) = A_0 + \\alpha I$, where $I$ is the $N \\times N$ identity matrix and $A_0$ is the matrix corresponding to the pure diffusion case ($\\alpha=0$):\n$$ A_0 = \\frac{\\kappa}{h^2} \\begin{pmatrix} 2  -1    0 \\\\ -1  2  -1   \\\\  \\ddots  \\ddots  \\ddots  \\\\   -1  2  -1 \\\\ 0    -1  2 \\end{pmatrix} $$\nIf $\\mu_k$ are the eigenvalues of $A_0$, then the eigenvalues of $A(\\alpha)$ are $\\lambda_k = \\mu_k + \\alpha$ for $k=1, \\dots, N$.\nFor $A(\\alpha)$ to be positive definite, we require $\\lambda_k > 0$ for all $k$.\n$$ \\mu_k + \\alpha > 0 \\quad \\forall k=1, \\dots, N $$\nThis is equivalent to the condition $\\alpha > -\\mu_k$ for all $k$, which simplifies to:\n$$ \\alpha > \\max_{k} (-\\mu_k) = - \\min_{k} (\\mu_k) = -\\lambda_{\\min}(A_0) $$\nThe sharp threshold $\\alpha_{\\star}$ is therefore the negative of the smallest eigenvalue of the discrete diffusion operator matrix $A_0$.\n\nWe must now find the eigenvalues of $A_0$. The eigenvalues of the tridiagonal matrix $T_N$ with diagonal entries of $2$ and off-diagonal entries of $-1$ are well-known:\n$$ \\nu_k(T_N) = 2 - 2\\cos\\left(\\frac{k\\pi}{N+1}\\right) \\quad \\text{for } k=1, \\dots, N. $$\nThe matrix $A_0$ is simply $\\frac{\\kappa}{h^2} T_N$. Thus, its eigenvalues $\\mu_k$ are:\n$$ \\mu_k = \\frac{\\kappa}{h^2} \\left( 2 - 2\\cos\\left(\\frac{k\\pi}{N+1}\\right) \\right) $$\nUsing the half-angle trigonometric identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we can rewrite the eigenvalues as:\n$$ \\mu_k = \\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right) \\quad \\text{for } k=1, \\dots, N. $$\nTo find the minimum eigenvalue, $\\lambda_{\\min}(A_0)$, we must find the minimum of $\\mu_k$ over $k=1, \\dots, N$. The function $\\sin^2(x)$ is positive and monotonically increasing for $x \\in (0, \\pi/2]$. The argument $\\frac{k\\pi}{2(N+1)}$ lies in the interval $(0, \\pi/2)$. Therefore, the minimum value is achieved for the smallest value of $k$, which is $k=1$.\n$$ \\lambda_{\\min}(A_0) = \\mu_1 = \\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{\\pi}{2(N+1)}\\right) $$\nThe DMP holds if and only if $\\alpha > -\\lambda_{\\min}(A_0)$. The sharp threshold $\\alpha_{\\star}$ is the value at which this condition transitions.\n$$ \\alpha_{\\star} = -\\lambda_{\\min}(A_0) = -\\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{\\pi}{2(N+1)}\\right) $$\nIf $\\alpha  \\alpha_{\\star}$, the smallest eigenvalue of $A(\\alpha)$ is negative, so the matrix is not positive definite and not an M-matrix, and a counterexample to the DMP can be constructed. If $\\alpha = \\alpha_{\\star}$, the matrix is singular, and the DMP is not well-defined. Thus, the condition for the DMP to hold is strictly $\\alpha > \\alpha_{\\star}$.",
            "answer": "$$ \\boxed{-\\frac{4\\kappa}{h^2}\\sin^2\\left(\\frac{\\pi}{2(N+1)}\\right)} $$"
        }
    ]
}