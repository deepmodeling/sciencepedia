{
    "hands_on_practices": [
        {
            "introduction": "要理解离散最大值原理（DMP），最经典的起点是分析显式时间积分格式。本练习将通过对标准的一维热传导方程进行分析，推导出一个严格的稳定性判据。通过这个过程，你将亲手计算出为保证数值解的有界性和非负性，显式欧拉格式所允许的最大时间步长，从而深刻理解时间步、网格尺寸和物理扩散系数之间的内在联系。",
            "id": "3955314",
            "problem": "在用于航空航天应用的计算流体动力学 (CFD) 中，仅由分子扩散输运的被动标量的扩散由一个抛物型偏微分方程 (PDE) 控制。考虑一维扩散方程\n$$\nu_{t}=\\nu\\,u_{xx}\n$$\n该方程定义在空间区间 $[0,L]$ 上，并带有齐次 Dirichlet 边界条件\n$$\nu(0,t)=0,\\quad u(L,t)=0,\n$$\n以及非负的初始数据\n$$\nu(x,0)\\ge 0 \\quad \\text{对于所有 } x\\in[0,L].\n$$\n设空间域在均匀网格 $x_{i}=i\\,h$ 上离散，其中 $i\\in\\{0,1,\\dots,N\\}$ 且 $h=L/N$。将在时间层 $t^{n}=n\\,\\Delta t$ 的网格函数表示为 $u_{i}^{n}\\approx u(x_{i},t^{n})$。空间上对 $u_{xx}$ 使用二阶中心差分近似，时间上使用显式前向 Euler 方法，为内部节点 $i\\in\\{1,2,\\dots,N-1\\}$ 建立一个全离散格式，同时将边界条件强制设置为 $u_{0}^{n}=0$ 和 $u_{N}^{n}=0$ 对所有 $n$ 成立。\n\n通过要求全离散解同时保持以下两个性质：\n- $$\\ell^{\\infty}$$ 范数下的离散极值原理（即，离散 $$\\ell^{\\infty}$$ 范数不随时间增加），以及\n- 当初始数据非负时，在所有后续时间层 $$n\\ge 1$$ 保持非负性，\n\n推导确保这两个性质成立的时间步长 $$\\Delta t$$ 关于运动扩散系数 $$\\nu$$ 和网格间距 $$h$$ 的精确上界。证明在所述的离散化和边界强制条件下，你得到的条件是充分且必要的。\n\n将你的最终结果表示为仅含 $$\\nu$$ 和 $$h$$ 的单个闭式解析表达式。最终表达式中不要包含单位。将 $$\\nu$$ 的单位理解为平方米/秒，$$h$$ 的单位理解为米，这样 $$\\Delta t$$ 的单位就是秒。",
            "solution": "该问题要求推导应用于一维扩散方程的数值格式的时间步长 $\\Delta t$ 的精确上界，以使该格式保持非负性和离散极值原理。\n\n控制偏微分方程 (PDE) 是一维扩散方程：\n$$\nu_{t}=\\nu\\,u_{xx}\n$$\n定义在区域 $x \\in [0, L]$上，具有齐次 Dirichlet 边界条件 $u(0,t)=0$ 和 $u(L,t)=0$，以及非负初始条件 $u(x,0) \\ge 0$。\n\n首先，我们构建全离散数值格式。空间域 $[0,L]$ 在均匀网格 $x_i = i h$（其中 $i \\in \\{0, 1, \\dots, N\\}$，$h=L/N$）上进行离散。时间域通过时间层 $t^n = n \\Delta t$ 进行离散。在网格点 $(x_i, t^n)$ 处的数值解记为 $u_i^n$。\n\n时间导数 $u_t$ 使用显式前向 Euler 方法近似：\n$$\nu_t(x_i, t^n) \\approx \\frac{u_i^{n+1} - u_i^n}{\\Delta t}\n$$\n\n空间二阶导数 $u_{xx}$ 使用二阶中心差分格式近似：\n$$\nu_{xx}(x_i, t^n) \\approx \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2}\n$$\n\n将这些近似代入 PDE，得到内部节点 $i \\in \\{1, 2, \\dots, N-1\\}$ 的格式：\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\nu \\left( \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} \\right)\n$$\n\n求解下一时间步的解 $u_i^{n+1}$：\n$$\nu_i^{n+1} = u_i^n + \\frac{\\nu \\Delta t}{h^2} (u_{i+1}^n - 2u_i^n + u_{i-1}^n)\n$$\n\n我们定义无量纲参数 $s = \\frac{\\nu \\Delta t}{h^2}$，该参数常被称为网格傅里叶数或数值扩散数。通过收集时间层 $n$ 的项，可以重写更新方程：\n$$\nu_i^{n+1} = u_i^n + s u_{i+1}^n - 2s u_i^n + s u_{i-1}^n\n$$\n$$\nu_i^{n+1} = s u_{i-1}^n + (1 - 2s) u_i^n + s u_{i+1}^n\n$$\n这是内部节点的更新规则。边界条件被强制设置为 $u_0^n = 0$ 和 $u_N^n = 0$ 对所有时间层 $n \\ge 0$ 成立。\n\n现在，我们分析所要求的两个性质，以找到对 $s$ 的条件，并由此得到对 $\\Delta t$ 的条件。\n\n**1. 非负性保持**\n\n我们要求，如果对所有 $i \\in \\{0, 1, \\dots, N\\}$ 都有 $u_i^n \\ge 0$，那么对所有 $i$ 都有 $u_i^{n+1} \\ge 0$。通过归纳法，在给定 $u_i^0 \\ge 0$ 的情况下，这将确保所有时间的非负性。\n\n更新规则将 $u_i^{n+1}$ 表示为时间层 $n$ 处的值 $u_{i-1}^n$、$u_i^n$ 和 $u_{i+1}^n$ 的线性组合。如果我们假设对所有 $j$ 都有 $u_j^n \\ge 0$，那么确保 $u_i^{n+1} \\ge 0$ 的一个充分条件是该线性组合中的所有系数都非负。\n这些系数是 $s$、$(1-2s)$ 和 $s$。\n因为 $\\nu > 0$、$\\Delta t > 0$ 且 $h > 0$，参数 $s = \\frac{\\nu \\Delta t}{h^2}$ 总是正的。\n唯一剩下的条件是针对 $u_i^n$ 的系数：\n$$\n1 - 2s \\ge 0 \\implies 2s \\le 1 \\implies s \\le \\frac{1}{2}\n$$\n在边界处，$u_0^{n+1}=0$ 和 $u_N^{n+1}=0$，它们是非负的。\n因此，条件 $s \\le \\frac{1}{2}$ 是保持非负性的**充分**条件。\n\n为了证明这个条件也是**必要**的，我们必须证明如果 $s > \\frac{1}{2}$，则存在一个非负初始条件 $u_i^0 \\ge 0$，使得格式在下一时间步产生一个负值。考虑一个在内部节点 $k \\in \\{1, \\dots, N-1\\}$ 处有单个非零值的初始条件，例如 $u_k^0 = 1$ 且对所有 $i \\ne k$ 都有 $u_i^0 = 0$。这个初始条件是非负的。将该格式应用一个时间步，我们得到节点 $k$ 处的值：\n$$\nu_k^1 = s u_{k-1}^0 + (1-2s) u_k^0 + s u_{k+1}^0 = s(0) + (1-2s)(1) + s(0) = 1 - 2s\n$$\n如果 $s > \\frac{1}{2}$，那么 $2s>1$，且 $1-2s  0$。因此 $u_k^1  0$，这违反了非负性要求。所以，条件 $s \\le \\frac{1}{2}$ 是保持非负性的充分必要条件。\n\n**2. 离散极值原理**\n\n离散极值原理（在 $\\ell^{\\infty}$ 范数下）指出，解的绝对值的最大值不随时间增长：$\\|u^{n+1}\\|_{\\infty} \\le \\|u^n\\|_{\\infty}$，其中 $\\|u^n\\|_{\\infty} = \\max_{i} |u_i^n|$。令 $M^n = \\|u^n\\|_{\\infty}$。\n\n我们在条件 $s \\le \\frac{1}{2}$ 下分析更新规则。\n$$\n|u_i^{n+1}| = |s u_{i-1}^n + (1 - 2s) u_i^n + s u_{i+1}^n|\n$$\n使用三角不等式：\n$$\n|u_i^{n+1}| \\le |s u_{i-1}^n| + |(1 - 2s) u_i^n| + |s u_{i+1}^n| = |s||u_{i-1}^n| + |1 - 2s||u_i^n| + |s||u_{i+1}^n|\n$$\n因为我们已经确定 $0  s \\le \\frac{1}{2}$，所以系数 $s$ 和 $(1-2s)$ 都是非负的。因此， $|s| = s$ 且 $|1-2s| = 1-2s$。\n$$\n|u_i^{n+1}| \\le s|u_{i-1}^n| + (1 - 2s)|u_i^n| + s|u_{i+1}^n|\n$$\n根据最大范数的定义，对所有 $j$ 都有 $|u_j^n| \\le M^n$。将此代入不等式：\n$$\n|u_i^{n+1}| \\le s M^n + (1 - 2s) M^n + s M^n = (s + 1 - 2s + s) M^n = M^n\n$$\n这个结果 $|u_i^{n+1}| \\le M^n$ 对所有内部节点 $i$ 都成立。对于边界节点，有 $|u_0^{n+1}|=0 \\le M^n$ 和 $|u_N^{n+1}|=0 \\le M^n$（假设初始条件非平凡，即 $M^n  0$）。\n由于对所有 $i \\in \\{0, 1, \\dots, N\\}$ 都有 $|u_i^{n+1}| \\le M^n$，我们可以得出结论 $\\max_i |u_i^{n+1}| \\le M^n$。这正是 $\\|u^{n+1}\\|_{\\infty} \\le \\|u^n\\|_{\\infty}$。因此，条件 $s \\le \\frac{1}{2}$ 是离散极值原理成立的**充分**条件。\n\n为了证明该条件对于离散极值原理也是**必要**的，我们再次为 $s  \\frac{1}{2}$ 的情况构造一个反例。该原理必须对任何初始数据都成立。考虑一个振荡初始条件，例如对 $i \\in \\{1, \\dots, N-1\\}$ 有 $u_i^0 = (-1)^i$，且 $u_0^0=0, u_N^0=0$。此初始数据的最大范数为 $\\|u^0\\|_{\\infty}=1$。我们考察一个内部节点 $k$ 使得 $u_k^0 = 1$。其相邻节点将是 $u_{k-1}^0 = -1$ 和 $u_{k+1}^0 = -1$。\n下一时间步该节点的值为：\n$$\nu_k^1 = s u_{k-1}^0 + (1-2s) u_k^0 + s u_{k+1}^0 = s(-1) + (1-2s)(1) + s(-1) = -s + 1 - 2s - s = 1 - 4s\n$$\n如果 $s  \\frac{1}{2}$，那么 $4s  2$，这意味着 $1-4s  -1$。其绝对值为 $|u_k^1| = |1-4s| = 4s - 1$。由于 $s  \\frac{1}{2}$，我们有 $4s-1  4(\\frac{1}{2})-1 = 1$。\n所以 $|u_k^1|  1 = \\|u^0\\|_{\\infty}$。这意味着 $\\|u^1\\|_{\\infty}  \\|u^0\\|_{\\infty}$，这违反了离散极值原理。因此，条件 $s \\le \\frac{1}{2}$ 也是**必要**的。\n\n**结论**\n\n保持非负性和离散极值原理都需要条件 $s \\le \\frac{1}{2}$，并且该条件对每个性质都是充分且必要的。问题要求推导确保这两个性质成立的时间步长 $\\Delta t$ 的精确上界。通过将 $s$ 设置为其允许的最大值可以找到此上界：\n$$\ns = \\frac{\\nu \\Delta t}{h^2} = \\frac{1}{2}\n$$\n求解 $\\Delta t$：\n$$\n\\Delta t = \\frac{h^2}{2\\nu}\n$$\n保证这两个性质的条件是 $\\Delta t \\le \\frac{h^2}{2\\nu}$。精确上界是等号成立的情况。",
            "answer": "$$\n\\boxed{\\frac{h^2}{2\\nu}}\n$$"
        },
        {
            "introduction": "满足离散最大值原理不仅取决于内部网格点的离散格式，边界条件的实施同样至关重要，而且这恰恰是实际编程中常见的陷阱。本练习将通过一个诺伊曼（Neumann）边界条件的例子，向你展示一个看似合理但“不恰当”的离散方法是如何破坏保证DMP所需的M-矩阵结构的。更重要的是，你将学习如何通过构建一个基于通量守恒的“修正”格式来恢复这一关键属性，这对于开发稳健的计算流体力学（CFD）求解器至关重要。",
            "id": "3955278",
            "problem": "考虑在平板中被动标量的稳态一维扩散，这是航空航天计算流体力学 (CFD) 中壁面有界输运的一个典型模型。设标量场为 $u(x)$，定义在区间 $x \\in [0,L]$ 上，扩散系数 $k0$ 为常数。控制方程为稳态扩散方程 $-\\frac{d}{dx}\\left(k \\frac{du}{dx}\\right)=0$。在左边界施加 Neumann 边界条件，指定通过 $x=0$ 的向外扩散通量为 $q$，即 $k\\,u_{x}(0)=q$；在右边界施加 Dirichlet 边界条件，$u(L)=0$。使用具有 $N+1$ 个节点的均匀网格对区间进行离散化，$x_i = i h$，$i=0,1,\\dots,N$，其中 $h=L/N$。在内部节点 $i=1,2,\\dots,N-1$ 上，使用基于此节点网格的标准二阶中心差分来离散化扩散算子。\n\n您将分析 Neumann 边界封闭如何影响系统矩阵的符号结构以及离散极值原理 (DMP) 的满足情况。回顾一下，对于标量扩散问题，线性系统 $A \\mathbf{u}=\\mathbf{b}$ 满足 DMP 的一个充分代数条件是 $A$ 是一个 M-矩阵，其非对角项非正，对角项为正。对于当前的标量扩散离散格式，这简化为要求矩阵逐行满足非对角系数 $\\le 0$ 且对角系数 $0$。\n\n(a) 通过使用不恰当的单边差分 $u_{x}(0)\\approx \\frac{u_1-u_0}{h}$ 来施加 Neumann 边界条件，构建与左边界 $x=0$ 相关的代数行。将边界方程除以 $h$，以获得与 $k/h^2$ 单位一致的系数，从而使用与内部方程相同的量纲尺度，将此边界行写成 $a_{00} u_0 + a_{01} u_1 = b_0$ 的形式。确定 $a_{00}$ 和 $a_{01}$ 的符号，并简要解释为什么该行会违反 M-矩阵的非对角项符号要求，从而破坏 DMP。\n\n(b) 通过在邻近 $x=0$ 的半网格单元上实施通量平衡，为左边界推导一个修正的、保守的边界模板：左侧面的扩散通量等于给定的 $q$，节点 0 和 1 之间的右侧面扩散通量由中心差分近似。将得到的代数边界行写成 $a_{00}^{(c)} u_0 + a_{01}^{(c)} u_1 = b_0^{(c)}$ 的形式，并确定 $a_{00}^{(c)}$ 和 $a_{01}^{(c)}$ 的符号，证明该行恢复了 M-矩阵结构所要求的非对角项非正性。\n\n(c) 考虑一个混合边界行族，它是由 (a) 部分中除以 $h$ 后的不恰当缩放行和 (b) 部分中的保守行通过凸组合得到的。将混合行定义为\n$$\n\\theta\\left[\\frac{k}{h^2}(u_1-u_0)=\\frac{q}{h}\\right] + (1-\\theta)\\left[\\frac{k}{h^2}(u_0 - u_1)=\\frac{q}{h}\\right],\n$$\n其中混合权重 $\\theta \\in [0,1]$。将其化为 $a_{00}(\\theta) u_0 + a_{01}(\\theta) u_1 = b_0(\\theta)$ 的形式，并确定最大值 $\\theta^\\star$，使得混合边界行在左边界处保持 M-矩阵的非对角项符号条件，即 $a_{01}(\\theta)\\le 0$。您的最终答案 $\\theta^\\star$ 应为一个无单位的精确数。无需四舍五入。",
            "solution": "该问题要求对稳态一维扩散方程的边界条件离散化进行三部分分析。中心主题是满足离散极值原理 (DMP) 的代数条件，这依赖于系统矩阵是一个 M-矩阵。一个充分条件是矩阵具有正的对角项 ($a_{ii}0$) 和非正的非对角项 ($a_{ij}\\le 0$ 对所有 $i \\ne j$)。\n\n(a) 我们被要求使用一阶单边向前差分近似 $u_{x}(0)\\approx \\frac{u_1-u_0}{h}$ 来离散化 Neumann 边界条件 $k\\,u_{x}(0)=q$，其中 $u_i = u(x_i)$。将此近似代入边界条件得到：\n$$\nk \\left(\\frac{u_1 - u_0}{h}\\right) = q\n$$\n问题指定该方程应使用与内部方程一致的量纲尺度来书写。在节点 $i$ 处，$-\\frac{d}{dx}(k\\frac{du}{dx})=0$ 的标准内部离散格式为 $\\frac{k}{h^2}(-u_{i-1} + 2u_i - u_{i+1})=0$，其中系数的单位为 $k/h^2$。为达到此尺度，我们将边界方程除以 $h$：\n$$\n\\frac{k}{h^2} (u_1 - u_0) = \\frac{q}{h}\n$$\n将其整理为 $a_{00} u_0 + a_{01} u_1 = b_0$ 的形式，我们得到：\n$$\n-\\frac{k}{h^2} u_0 + \\frac{k}{h^2} u_1 = \\frac{q}{h}\n$$\n由此，我们确定系统矩阵第一行 ($i=0$) 的系数：\n- $a_{00} = -\\frac{k}{h^2}$\n- $a_{01} = \\frac{k}{h^2}$\n- $b_0 = \\frac{q}{h}$\n\n由于扩散系数 $k0$ 且网格间距 $h0$，我们有 $k/h^2  0$。因此，非对角系数的符号为 $a_{01}  0$。这违反了 M-矩阵要求非对角项必须为非正 ($a_{ij} \\le 0$ 对所有 $i \\neq j$) 的规定。这个正的非对角项会阻止系统矩阵成为 M-矩阵，从而可能破坏 DMP。此外，对角项 $a_{00} = -k/h^2  0$ 也违反了对角项必须为正的条件。\n\n(b) 接下来，我们通过在邻近边界的控制体 (CV) 上进行通量平衡来推导一个保守的模板。该控制体是一个长度为 $h/2$ 的半网格单元，即区间 $[0, h/2]$。对于没有源项的稳态问题，将控制方程在该控制体上积分，得到其各个表面通量的平衡：\n$$\n\\int_0^{h/2} -\\frac{d}{dx}\\left(k \\frac{du}{dx}\\right) dx = 0 \\implies \\left[-k \\frac{du}{dx}\\right]_0^{h/2} = 0\n$$\n这等价于声明进入控制体的通量等于流出控制体的通量。问题指出，左侧面的扩散通量等于给定的 $q$。这被解释为在 $x=0$ 处*进入*控制体的通量，即 $q$。在右侧面 ($x=h/2$) *流出*控制体的通量使用节点 0 和 1 之间的中心差分来近似：\n$$\n\\text{流出通量} = -k u_x\\left(\\frac{h}{2}\\right) \\approx -k \\frac{u_1 - u_0}{h} = k \\frac{u_0 - u_1}{h}\n$$\n因此通量平衡为：流入通量 = 流出通量。\n$$\nq = k \\frac{u_0-u_1}{h}\n$$\n为匹配内部方程的尺度，我们将其除以 $h$：\n$$\n\\frac{k}{h^2}(u_0 - u_1) = \\frac{q}{h}\n$$\n将其写成 $a_{00}^{(c)} u_0 + a_{01}^{(c)} u_1 = b_0^{(c)}$ 的形式得到：\n$$\n\\frac{k}{h^2} u_0 - \\frac{k}{h^2} u_1 = \\frac{q}{h}\n$$\n系数为：\n- $a_{00}^{(c)} = \\frac{k}{h^2}$\n- $a_{01}^{(c)} = -\\frac{k}{h^2}$\n- $b_0^{(c)} = \\frac{q}{h}$\n\n由于 $k/h^2  0$，对角系数 $a_{00}^{(c)}$ 为正，非对角系数 $a_{01}^{(c)}$ 为负。这两个符号都与 M-矩阵的要求（$a_{ii}0$ 且 $a_{ij}\\le 0$ 对所有 $i \\ne j$）一致。这种保守的公式恢复了边界行所期望的符号结构。\n\n(c) 我们得到一个混合边界行，它是由 (a) 部分的缩放后的不恰当行和 (b) 部分的保守行通过凸组合形成的：\n$$\n\\theta\\left[\\frac{k}{h^2}(u_1-u_0)=\\frac{q}{h}\\right] + (1-\\theta)\\left[\\frac{k}{h^2}(u_0 - u_1)=\\frac{q}{h}\\right]\n$$\n其中 $\\theta \\in [0,1]$。我们需要找到最大的 $\\theta^\\star$，使得非对角系数 $a_{01}(\\theta)$ 为非正。首先，我们展开并按 $u_0$ 和 $u_1$ 对各项进行分组：\n$$\n\\theta\\left(-\\frac{k}{h^2}u_0 + \\frac{k}{h^2}u_1\\right) + (1-\\theta)\\left(\\frac{k}{h^2}u_0 - \\frac{k}{h^2}u_1\\right) = \\theta\\frac{q}{h} + (1-\\theta)\\frac{q}{h}\n$$\n等式右边简化为 $b_0(\\theta) = (\\theta + 1 - \\theta)\\frac{q}{h} = \\frac{q}{h}$。$u_0$ 的系数为：\n$$\na_{00}(\\theta) = \\theta\\left(-\\frac{k}{h^2}\\right) + (1-\\theta)\\left(\\frac{k}{h^2}\\right) = \\frac{k}{h^2}(-\\theta + 1 - \\theta) = \\frac{k}{h^2}(1-2\\theta)\n$$\n$u_1$ 的系数为：\n$$\na_{01}(\\theta) = \\theta\\left(\\frac{k}{h^2}\\right) + (1-\\theta)\\left(-\\frac{k}{h^2}\\right) = \\frac{k}{h^2}(\\theta - (1-\\theta)) = \\frac{k}{h^2}(\\theta - 1 + \\theta) = \\frac{k}{h^2}(2\\theta-1)\n$$\n问题要求保持 M-矩阵性质的非对角项符号条件。这意味着我们必须有 $a_{01}(\\theta) \\le 0$：\n$$\n\\frac{k}{h^2}(2\\theta-1) \\le 0\n$$\n由于 $k/h^2  0$，我们可以用该项去除不等式，而无需改变不等号的方向：\n$$\n2\\theta - 1 \\le 0\n$$\n$$\n2\\theta \\le 1\n$$\n$$\n\\theta \\le \\frac{1}{2}\n$$\n混合因子 $\\theta$ 被限制在区间 $[0,1]$ 内。因此，条件 $\\theta \\le \\frac{1}{2}$ 是约束因子。满足此条件的最大 $\\theta$ 值为 $\\theta^\\star = \\frac{1}{2}$。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "当我们在控制方程中加入源项（如化学反应）时，对离散最大值原理的分析需要更为深刻的工具。本练习将引导你超越简单的系数符号检查，转向对离散算子谱特性（即特征值）的分析。你将从第一性原理出发，证明为何非负的反应项有助于保持DMP，并推导出当反应项为负（即“汇”项）时，保证DMP所必须满足的精确阈值，从而将DMP与算子矩阵的逆正性及正定性紧密联系起来。",
            "id": "3955293",
            "problem": "在一个受航空航天应用中计算流体力学（CFD）启发的简化一维模型中，考虑沿长度为 $L$ 的壁面法向线段上标量输运物质的稳态扩散-反应平衡，其中分子扩散系数 $\\kappa0$ 为常数，反应源为线性化的 $\\alpha u$。在连续层面上，算子为 $-\\frac{d}{dx}\\left(\\kappa \\frac{du}{dx}\\right)+\\alpha u$。使用 $N$ 个内部节点和间距为 $h=L/(N+1)$ 的均匀网格对区间 $[0,L]$ 进行离散化，并施加狄利克雷数据 $u(0)=\\bar{u}_0$ 和 $u(L)=\\bar{u}_L$。使用标准的二阶中心差分来近似内部节点处的扩散项。这将为内部未知量 $\\mathbf{u}\\in\\mathbb{R}^N$ 产生一个线性系统 $A(\\alpha)\\, \\mathbf{u}=\\mathbf{b}$，其中系数矩阵 $A(\\alpha)$ 是实对称三对角矩阵。\n\n从离散极值原理（DMP）和矩阵单调性的基本定义出发，并且不假设任何预先给定的谱公式，完成以下任务：\n- 从第一性原理出发，证明为何在标准扩散离散格式中添加一个非负反应系数 $\\alpha\\ge 0$ 可以在任何均匀网格上保持离散极值原理，且与 $h$ 和 $N$ 无关。\n- 确定一个精确阈值 $\\alpha_{\\star}$（该值可能为负），使得对于所有右端项和狄利克雷边界数据，离散极值原理成立的充要条件是 $\\alpha\\alpha_{\\star}$，并且在 $\\alpha\\alpha_{\\star}$ 的情况下通常不成立。你的推理过程应将离散极值原理与 $A(\\alpha)$ 的逆正性以及离散扩散算子的谱性质联系起来。\n\n以 $\\kappa$、$h$ 和 $N$ 的单个闭式表达式形式给出 $\\alpha_{\\star}$ 的最终答案。最终答案中不要包含单位。无需进行数值四舍五入；给出精确的符号表达式。将最终答案表示为解析表达式。",
            "solution": "该问题要求对一维稳态扩散-反应方程的离散极值原理（DMP）进行分析。我们将首先验证问题，然后进行求解。求解过程包括两个部分：证明对于非负反应系数 $\\alpha$，DMP 成立；以及找到精确阈值 $\\alpha_{\\star}$，使得 DMP 成立的充要条件是 $\\alpha  \\alpha_{\\star}$。\n\n连续问题由算子 $-\\frac{d}{dx}\\left(\\kappa \\frac{du}{dx}\\right)+\\alpha u = f(x)$ 在区间 $[0,L]$ 上给出，边界条件为狄利克雷边界条件 $u(0)=\\bar{u}_0$ 和 $u(L)=\\bar{u}_L$。区域被离散化为 $N$ 个内部节点 $x_i = ih$（其中 $i=1, \\dots, N$）和边界节点 $x_0=0$ 和 $x_{N+1}=L$。网格间距为 $h=L/(N+1)$。\n\n我们使用标准二阶中心差分格式来近似二阶导数：\n$$ \\frac{d^2u}{dx^2}\\bigg|_{x=x_i} \\approx \\frac{u(x_{i+1}) - 2u(x_i) + u(x_{i-1})}{h^2} = \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} $$\n将此代入内部节点 $x_i$ 处的控制方程，我们得到离散方程：\n$$ -\\kappa \\left( \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} \\right) + \\alpha u_i = f_i $$\n这可以重新整理以定义离散算子 $(L_h u)_i$：\n$$ (L_h u)_i = \\frac{-\\kappa}{h^2} u_{i-1} + \\left(\\frac{2\\kappa}{h^2} + \\alpha\\right) u_i + \\frac{-\\kappa}{h^2} u_{i+1} = f_i $$\n这组关于内部未知量 $\\mathbf{u} = [u_1, u_2, \\dots, u_N]^T$ 的 $N$ 个线性方程组成了系统 $A(\\alpha)\\mathbf{u} = \\mathbf{b}$。矩阵 $A(\\alpha)$ 是一个 $N \\times N$ 的实对称三对角矩阵。其对角线元素为 $(A(\\alpha))_{ii} = \\frac{2\\kappa}{h^2} + \\alpha$，其非对角线元素为 $(A(\\alpha))_{i,i\\pm 1} = -\\frac{\\kappa}{h^2}$。右端向量 $\\mathbf{b}$ 包含了源项 $\\mathbf{f}=[f_1, \\dots, f_N]^T$ 和边界条件。对于 $i=1$，方程为 $(\\frac{2\\kappa}{h^2} + \\alpha)u_1 - \\frac{\\kappa}{h^2}u_2 = f_1 + \\frac{\\kappa}{h^2}\\bar{u}_0$。对于 $i=N$，方程为 $-\\frac{\\kappa}{h^2}u_{N-1} + (\\frac{2\\kappa}{h^2} + \\alpha)u_N = f_N + \\frac{\\kappa}{h^2}\\bar{u}_L$。\n\n第一部分：对于 $\\alpha \\ge 0$ 时 DMP 的保持。\n离散极值原理指出，如果源项非正，那么解的最大值不能出现在内部点，除非解是常数。对于我们的算子，更正式地表述为，如果对所有内部节点 $i=1, \\dots, N$ 都有 $(L_h u)_i \\le 0$，那么离散解 $\\{u_i\\}_{i=0}^{N+1}$ 的最大值必须在边界上达到。也就是说，$\\max_{0 \\le i \\le N+1} u_i \\le \\max(\\bar{u}_0, \\bar{u}_L)$，假设最大值为非负。\n\n为了从第一性原理证明这一点，我们使用反证法，假设 $u_i$ 的最大值出现在内部节点 $k \\in \\{1, \\dots, N\\}$。设这个最大值为 $u_k$。根据最大值的定义，有 $u_k \\ge u_{k-1}$ 和 $u_k \\ge u_{k+1}$。\n让我们分析在该点处的离散算子 $(L_h u)_k$：\n$$ (L_h u)_k = \\left(\\frac{2\\kappa}{h^2} + \\alpha\\right) u_k - \\frac{\\kappa}{h^2} u_{k-1} - \\frac{\\kappa}{h^2} u_{k+1} $$\n我们可以将其重写为：\n$$ (L_h u)_k = \\frac{\\kappa}{h^2} (u_k - u_{k-1}) + \\frac{\\kappa}{h^2} (u_k - u_{k+1}) + \\alpha u_k $$\n根据我们的假设，$(u_k - u_{k-1}) \\ge 0$ 且 $(u_k - u_{k+1}) \\ge 0$。由于 $\\kappa  0$ 且 $h  0$，前两项是非负的。\n现在，考虑 $\\alpha \\ge 0$ 的情况。\n如果 $u_k  0$，则 $\\alpha u_k \\ge 0$。如果最大值是严格的（即 $u_k  u_{k-1}$ 或 $u_k  u_{k+1}$），那么前两项中至少有一项是严格正的，这意味着 $(L_h u)_k  0$。这与所有 $i$ 都满足 $(L_h u)_i \\le 0$ 的条件相矛盾。\n如果最大值不是严格的（例如 $u_k = u_{k-1}$），则可以将论证扩展到达到最大值的相连节点集合，直到达到边界或值较小的点。核心结论仍然成立：如果源项为非正，则非负最大值不能在内部维持。\n如果最大值 $u_k \\le 0$，那么在边界数据为非负的情况下，命题 $\\max u_i \\le \\max(\\bar{u}_0, \\bar{u}_L)$ 显然成立。更一般地，如果对所有 $i$ 都有 $(L_h u)_i \\le 0$，则正的最大值不能出现在内部。因此，最大值必须在边界处达到，或者小于等于 0。这意味着 $\\max_{1 \\le i \\le N} u_i \\le \\max(0, \\bar{u}_0, \\bar{u}_L)$。这个论证只依赖于 $\\kappa$ 和 $\\alpha$ 的非负性，而与 $h$ 或 $N$ 的具体值无关。\n\n第二部分：精确阈值 $\\alpha_{\\star}$。\nDMP 与 M-矩阵和逆正性的概念密切相关。如果一个矩阵 $A$ 的非对角线元素非正（对于 $i \\ne j$，$A_{ij} \\le 0$），并且其逆矩阵非负（$A^{-1} \\ge 0$，逐元素），则称该矩阵为 M-矩阵。非对角线元素非正的矩阵称为 Z-矩阵。\n我们的矩阵 $A(\\alpha)$ 是一个 Z-矩阵，因为它的非对角线元素为 $-\\kappa/h^2 \\le 0$。对于一个 Z-矩阵，其成为 M-矩阵（并因此具有逆正性）的性质等价于其他几个条件。由于 $A(\\alpha)$ 也是对称的，这个条件大大简化：一个对称的 Z-矩阵是 M-矩阵的充要条件是它是正定的。\n对于所有的右端项和边界数据，DMP 成立的充要条件是 $A(\\alpha)$ 是一个 M-矩阵。因此，我们需要找到使 $A(\\alpha)$ 正定的关于 $\\alpha$ 的条件。一个对称矩阵是正定的，其充要条件是它的所有特征值都严格为正。\n\n矩阵 $A(\\alpha)$ 可以写成 $A(\\alpha) = A_0 + \\alpha I$，其中 $I$ 是 $N \\times N$ 的单位矩阵，$A_0$ 是对应于纯扩散情况（$\\alpha=0$）的矩阵：\n$$ A_0 = \\frac{\\kappa}{h^2} \\begin{pmatrix} 2  -1    0 \\\\ -1  2  -1   \\\\   \\ddots  \\ddots  \\ddots  \\\\    -1  2  -1 \\\\ 0     -1  2 \\end{pmatrix} $$\n如果 $\\mu_k$ 是 $A_0$ 的特征值，那么 $A(\\alpha)$ 的特征值是 $\\lambda_k = \\mu_k + \\alpha$，其中 $k=1, \\dots, N$。\n为了使 $A(\\alpha)$ 是正定的，我们需要对所有的 $k$ 都有 $\\lambda_k  0$。\n$$ \\mu_k + \\alpha  0 \\quad \\forall k=1, \\dots, N $$\n这等价于对所有 $k$ 都有 $\\alpha  -\\mu_k$ 的条件，可以简化为：\n$$ \\alpha  \\max_{k} (-\\mu_k) = - \\min_{k} (\\mu_k) = -\\lambda_{\\min}(A_0) $$\n因此，精确阈值 $\\alpha_{\\star}$ 是离散扩散算子矩阵 $A_0$ 的最小特征值的相反数。\n\n我们现在必须求出 $A_0$ 的特征值。对角线元素为 $2$、非对角线元素为 $-1$ 的三对角矩阵 $T_N$ 的特征值是众所周知的：\n$$ \\nu_k(T_N) = 2 - 2\\cos\\left(\\frac{k\\pi}{N+1}\\right) \\quad \\text{for } k=1, \\dots, N. $$\n矩阵 $A_0$ 就是 $\\frac{\\kappa}{h^2} T_N$。因此，它的特征值 $\\mu_k$ 是：\n$$ \\mu_k = \\frac{\\kappa}{h^2} \\left( 2 - 2\\cos\\left(\\frac{k\\pi}{N+1}\\right) \\right) $$\n使用半角三角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们可以将特征值重写为：\n$$ \\mu_k = \\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right) \\quad \\text{for } k=1, \\dots, N. $$\n为了找到最小特征值 $\\lambda_{\\min}(A_0)$，我们必须找到在 $k=1, \\dots, N$ 范围内 $\\mu_k$ 的最小值。函数 $\\sin^2(x)$ 在 $x \\in (0, \\pi/2]$ 上是正的且单调递增。自变量 $\\frac{k\\pi}{2(N+1)}$ 位于区间 $(0, \\pi/2)$ 内。因此，当 $k$ 取最小值，即 $k=1$ 时，达到最小值。\n$$ \\lambda_{\\min}(A_0) = \\mu_1 = \\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{\\pi}{2(N+1)}\\right) $$\nDMP 成立的充要条件是 $\\alpha  -\\lambda_{\\min}(A_0)$。精确阈值 $\\alpha_{\\star}$ 是该条件发生转变的值。\n$$ \\alpha_{\\star} = -\\lambda_{\\min}(A_0) = -\\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{\\pi}{2(N+1)}\\right) $$\n如果 $\\alpha  \\alpha_{\\star}$，$A(\\alpha)$ 的最小特征值为负，因此该矩阵不是正定的，也不是 M-矩阵，可以构造出 DMP 的反例。如果 $\\alpha = \\alpha_{\\star}$，该矩阵是奇异的，DMP 没有明确定义。因此，DMP 成立的条件是严格的 $\\alpha  \\alpha_{\\star}$。",
            "answer": "$$ \\boxed{-\\frac{4\\kappa}{h^2}\\sin^2\\left(\\frac{\\pi}{2(N+1)}\\right)} $$"
        }
    ]
}