{
    "hands_on_practices": [
        {
            "introduction": "This first exercise explores the behavior of the foundational Lax-Friedrichs scheme, a classic first-order method. By analyzing its effect on a simple sinusoidal wave, you will quantify the scheme's inherent numerical dissipation. This practice provides a concrete link between the theoretical amplification factor derived from von Neumann stability analysis and the practical consequences for solution quality, namely the reduction in amplitude and Total Variation .",
            "id": "3976760",
            "problem": "Consider one-dimensional linear advection of a passive scalar in Computational Fluid Dynamics (CFD), governed by the scalar conservation law $u_{t} + a\\,u_{x} = 0$, where $a$ is a constant advection speed. On a uniform grid $x_{i} = i\\,\\Delta x$ with periodic boundary conditions, consider the conservative update using the Lax–Friedrichs numerical flux. Let the time step be $\\Delta t$, and define the Courant number $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$, with $|\\lambda| \\leq 1$. The initial condition is prescribed as a sinusoid $u_{i}^{0} = \\sin(k\\,x_{i})$, where $k$ is a real wavenumber compatible with the periodic domain.\n\nDefine the discrete total variation $TV_{d}^{n}$ at time level $n$ by $TV_{d}^{n} = \\sum_{i} \\left|u_{i+1}^{n} - u_{i}^{n}\\right|$, with periodic indexing. Using only the scalar conservation law, the definition of the Lax–Friedrichs numerical flux, and the definition of discrete total variation, derive from first principles a closed-form expression for the magnitude of the amplification factor of the Fourier mode with wavenumber $k$ after one Lax–Friedrichs time step, and then use it to obtain:\n\n1. The amplitude reduction factor of the sinusoid after one time step, relative to its initial amplitude.\n2. The discrete total variation reduction factor $TV_{d}^{1}/TV_{d}^{0}$ after one time step.\n\nExpress both quantities in terms of $k$, $\\Delta x$, and $\\lambda$. Your final answer must be a single analytical expression containing both quantities as a row matrix. No numerical rounding is required, and no units are needed.",
            "solution": "The problem requires the derivation of two quantities related to the Lax–Friedrichs scheme for the one-dimensional linear advection equation: the amplitude reduction factor for a sinusoidal initial condition and the discrete total variation reduction factor, both after one time step.\n\nFirst, we must derive the finite difference stencil for the Lax–Friedrichs scheme and its corresponding amplification factor.\n\nThe scalar conservation law is given as $u_t + a u_x = 0$. In conservative form, this is $u_t + F(u)_x = 0$, where the flux is $F(u) = a u$.\nThe conservative finite difference update on a uniform grid is:\n$$u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right)$$\nwhere $u_i^n$ is the solution at grid point $x_i = i \\Delta x$ and time $t^n = n \\Delta t$, and $F_{i+1/2}$ is the numerical flux at the interface between cells $i$ and $i+1$.\n\nThe Lax–Friedrichs numerical flux is defined as:\n$$F_{i+1/2}^{LF} = \\frac{1}{2} \\left[ F(u_i^n) + F(u_{i+1}^n) \\right] - \\frac{1}{2} \\frac{\\Delta x}{\\Delta t} \\left( u_{i+1}^n - u_i^n \\right)$$\nSubstituting $F(u) = a u$:\n$$F_{i+1/2}^{LF} = \\frac{a}{2} \\left( u_i^n + u_{i+1}^n \\right) - \\frac{1}{2} \\frac{\\Delta x}{\\Delta t} \\left( u_{i+1}^n - u_i^n \\right)$$\nSimilarly, the flux at the $i-1/2$ interface is:\n$$F_{i-1/2}^{LF} = \\frac{a}{2} \\left( u_{i-1}^n + u_i^n \\right) - \\frac{1}{2} \\frac{\\Delta x}{\\Delta t} \\left( u_i^n - u_{i-1}^n \\right)$$\n\nSubstituting these fluxes into the conservative update equation:\n$$u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left[ \\left(\\frac{a}{2}(u_i^n + u_{i+1}^n) - \\frac{\\Delta x}{2\\Delta t}(u_{i+1}^n - u_i^n)\\right) - \\left(\\frac{a}{2}(u_{i-1}^n + u_i^n) - \\frac{\\Delta x}{2\\Delta t}(u_i^n - u_{i-1}^n)\\right) \\right]$$\nLet's group the terms. The advective part contribution is:\n$$-\\frac{\\Delta t}{\\Delta x} \\left[ \\frac{a}{2}(u_{i+1}^n - u_{i-1}^n) \\right] = -\\frac{a \\Delta t}{2 \\Delta x} (u_{i+1}^n - u_{i-1}^n) = -\\frac{\\lambda}{2} (u_{i+1}^n - u_{i-1}^n)$$\nwhere $\\lambda = \\frac{a \\Delta t}{\\Delta x}$ is the Courant number.\nThe dissipative part contribution is:\n$$-\\frac{\\Delta t}{\\Delta x} \\left[ -\\frac{\\Delta x}{2\\Delta t}(u_{i+1}^n - 2u_i^n + u_{i-1}^n) \\right] = \\frac{1}{2} (u_{i+1}^n - 2u_i^n + u_{i-1}^n)$$\nCombining all terms:\n$$u_i^{n+1} = u_i^n - \\frac{\\lambda}{2} (u_{i+1}^n - u_{i-1}^n) + \\frac{1}{2} (u_{i+1}^n - 2u_i^n + u_{i-1}^n)$$\n$$u_i^{n+1} = u_i^n(1 - 1) + u_{i-1}^n \\left(\\frac{\\lambda}{2} + \\frac{1}{2}\\right) + u_{i+1}^n \\left(-\\frac{\\lambda}{2} + \\frac{1}{2}\\right)$$\nThis simplifies to the Lax–Friedrichs stencil:\n$$u_i^{n+1} = \\frac{1+\\lambda}{2} u_{i-1}^n + \\frac{1-\\lambda}{2} u_{i+1}^n$$\nNote that this can also be seen as a central difference in space applied to a time-averaged value at the previous time step, i.e., $\\frac{u_i^{n+1} - \\frac{1}{2}(u_{i+1}^n + u_{i-1}^n)}{\\Delta t} + a \\frac{u_{i+1}^n - u_{i-1}^n}{2\\Delta x} = 0$, which rearranges to the same stencil.\n\nTo find the amplification factor, we perform a von Neumann stability analysis. We consider a single Fourier mode $u_i^n = \\hat{u}^n(k) e^{I k x_i}$, where $I = \\sqrt{-1}$ is the imaginary unit and $k$ is the wavenumber. The solution at the next time step is $u_i^{n+1} = G(k) \\hat{u}^n(k) e^{I k x_i}$, where $G(k)$ is the amplification factor. Substituting these into the stencil:\n$$G(k) \\hat{u}^n e^{I k x_i} = \\frac{1+\\lambda}{2} \\hat{u}^n e^{I k x_{i-1}} + \\frac{1-\\lambda}{2} \\hat{u}^n e^{I k x_{i+1}}$$\nUsing $x_{j} = j \\Delta x$ and dividing by $\\hat{u}^n e^{I k i \\Delta x}$:\n$$G(k) = \\frac{1+\\lambda}{2} e^{-I k \\Delta x} + \\frac{1-\\lambda}{2} e^{I k \\Delta x}$$\nUsing Euler's formula, $e^{I\\theta} = \\cos\\theta + I\\sin\\theta$:\n$$G(k) = \\frac{1+\\lambda}{2} (\\cos(k\\Delta x) - I\\sin(k\\Delta x)) + \\frac{1-\\lambda}{2} (\\cos(k\\Delta x) + I\\sin(k\\Delta x))$$\nGrouping real and imaginary parts:\n$$G(k) = \\cos(k\\Delta x) \\left( \\frac{1+\\lambda}{2} + \\frac{1-\\lambda}{2} \\right) + I\\sin(k\\Delta x) \\left( -\\frac{1+\\lambda}{2} + \\frac{1-\\lambda}{2} \\right)$$\n$$G(k) = \\cos(k\\Delta x) - I \\lambda \\sin(k\\Delta x)$$\nThe magnitude of the amplification factor is:\n$$|G(k)| = \\sqrt{(\\cos(k\\Delta x))^2 + (-\\lambda \\sin(k\\Delta x))^2} = \\sqrt{\\cos^2(k\\Delta x) + \\lambda^2 \\sin^2(k\\Delta x)}$$\nUsing the identity $\\cos^2\\theta = 1 - \\sin^2\\theta$, we can write this more compactly:\n$$|G(k)| = \\sqrt{1 - \\sin^2(k\\Delta x) + \\lambda^2 \\sin^2(k\\Delta x)} = \\sqrt{1 - (1-\\lambda^2)\\sin^2(k\\Delta x)}$$\nThis is the derived expression for the magnitude of the amplification factor.\n\n**1. Amplitude Reduction Factor**\nThe initial condition is $u_i^0 = \\sin(k x_i)$. We can express this using complex exponentials:\n$$u_i^0 = \\frac{e^{I k x_i} - e^{-I k x_i}}{2I}$$\nThis is a superposition of two modes with wavenumbers $k$ and $-k$. After one time step, each mode is multiplied by its respective amplification factor, $G(k)$ and $G(-k)$.\n$$u_i^1 = \\frac{G(k) e^{I k x_i} - G(-k) e^{-I k x_i}}{2I}$$\nWe note that $G(-k) = \\cos(-k\\Delta x) - I\\lambda\\sin(-k\\Delta x) = \\cos(k\\Delta x) + I\\lambda\\sin(k\\Delta x) = G(k)^*$, the complex conjugate of $G(k)$.\nLet $G(k) = |G(k)| e^{-I\\phi_k}$, where $\\phi_k = \\arctan(\\lambda \\tan(k\\Delta x))$ is the phase shift. Then $G(-k) = |G(k)| e^{I\\phi_k}$.\nSubstituting these into the expression for $u_i^1$:\n$$u_i^1 = \\frac{|G(k)| e^{-I\\phi_k} e^{I k x_i} - |G(k)| e^{I\\phi_k} e^{-I k x_i}}{2I} = |G(k)| \\frac{e^{I(kx_i - \\phi_k)} - e^{-I(kx_i - \\phi_k)}}{2I}$$\n$$u_i^1 = |G(k)| \\sin(k x_i - \\phi_k)$$\nThe initial amplitude of the sinusoid $u_i^0$ is $1$. The amplitude after one time step is $|G(k)|$.\nThe amplitude reduction factor is the ratio of the final amplitude to the initial amplitude, which is $\\frac{|G(k)|}{1} = |G(k)|$.\nSo, the amplitude reduction factor is $\\sqrt{1 - (1-\\lambda^2)\\sin^2(k\\Delta x)}$.\n\n**2. Discrete Total Variation Reduction Factor**\nThe discrete total variation at time level $n$ is $TV_d^n = \\sum_i |u_{i+1}^n - u_i^n|$. We need to find the ratio $TV_d^1/TV_d^0$.\n\nFor $n=0$: $u_i^0 = \\sin(k x_i) = \\sin(k i \\Delta x)$.\nThe difference is $u_{i+1}^0 - u_i^0 = \\sin(k(i+1)\\Delta x) - \\sin(ki\\Delta x)$.\nUsing the identity $\\sin(A) - \\sin(B) = 2\\cos(\\frac{A+B}{2})\\sin(\\frac{A-B}{2})$:\n$$u_{i+1}^0 - u_i^0 = 2\\cos\\left(k(i+\\frac{1}{2})\\Delta x\\right) \\sin\\left(\\frac{k\\Delta x}{2}\\right)$$\nThe total variation is:\n$$TV_d^0 = \\sum_i \\left| 2\\cos\\left(k(i+\\frac{1}{2})\\Delta x\\right) \\sin\\left(\\frac{k\\Delta x}{2}\\right) \\right| = 2\\left|\\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right| \\sum_i \\left|\\cos\\left(k(i+\\frac{1}{2})\\Delta x\\right)\\right|$$\n\nFor $n=1$: $u_i^1 = |G(k)| \\sin(k x_i - \\phi_k)$.\nThe difference is $u_{i+1}^1 - u_i^1 = |G(k)|[\\sin(k(i+1)\\Delta x - \\phi_k) - \\sin(ki\\Delta x - \\phi_k)]$.\nUsing the same identity:\n$$u_{i+1}^1 - u_i^1 = |G(k)| \\left[ 2\\cos\\left(k(i+\\frac{1}{2})\\Delta x - \\phi_k\\right) \\sin\\left(\\frac{k\\Delta x}{2}\\right) \\right]$$\nThe total variation is:\n$$TV_d^1 = \\sum_i \\left| |G(k)| 2\\cos\\left(k(i+\\frac{1}{2})\\Delta x - \\phi_k\\right) \\sin\\left(\\frac{k\\Delta x}{2}\\right) \\right|$$\n$$TV_d^1 = |G(k)| \\cdot 2\\left|\\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right| \\sum_i \\left|\\cos\\left(k(i+\\frac{1}{2})\\Delta x - \\phi_k\\right)\\right|$$\nThe summation is over a full periodic domain. The term $\\phi_k$ represents a constant phase shift. For a periodic function summed over a full period, a constant phase shift does not change the value of the sum. Therefore:\n$$\\sum_i \\left|\\cos\\left(k(i+\\frac{1}{2})\\Delta x - \\phi_k\\right)\\right| = \\sum_i \\left|\\cos\\left(k(i+\\frac{1}{2})\\Delta x\\right)\\right|$$\nNow we compute the ratio $TV_d^1/TV_d^0$:\n$$\\frac{TV_d^1}{TV_d^0} = \\frac{|G(k)| \\cdot 2\\left|\\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right| \\sum_i \\left|\\cos\\left(k(i+\\frac{1}{2})\\Delta x\\right)\\right|}{2\\left|\\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right| \\sum_i \\left|\\cos\\left(k(i+\\frac{1}{2})\\Delta x\\right)\\right|} = |G(k)|$$\nThe discrete total variation reduction factor is also equal to the magnitude of the amplification factor, $|G(k)|$.\n\nBoth quantities are equal to the same expression: $\\sqrt{1 - (1-\\lambda^2)\\sin^2(k\\Delta x)}$. We present them as a row matrix as requested.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\sqrt{1 - (1-\\lambda^{2})\\sin^{2}(k\\Delta x)}  \\sqrt{1 - (1-\\lambda^{2})\\sin^{2}(k\\Delta x)} \\end{pmatrix} } $$"
        },
        {
            "introduction": "Moving from first-order to higher-order methods introduces a new set of challenges related to stability and physical realism. This problem demonstrates why limiters are an essential component of modern shock-capturing schemes. By calculating the evolution of a step discontinuity using a second-order MUSCL scheme with an unlimited slope, you will directly observe its failure to preserve monotonicity, leading to the creation of non-physical overshoots .",
            "id": "3976722",
            "problem": "Consider the one-dimensional scalar linear advection equation $u_t + a\\,u_x = 0$ with constant advection speed $a  0$ on a uniform grid of spacing $\\Delta x$ in a Computational Fluid Dynamics (CFD) setting relevant to aerospace applications. A finite volume method uses a first-order explicit Euler time update and Monotone Upstream-centered Schemes for Conservation Laws (MUSCL) reconstruction with an unlimited linear slope. Specifically, denote the cell average in cell $i$ at time level $n$ by $u_i^n$, the Courant–Friedrichs–Lewy (CFL) number by $\\nu = a\\,\\Delta t/\\Delta x$, and the MUSCL unlimited central slope by $s_i = \\dfrac{u_{i+1}^n - u_{i-1}^n}{2}$. The left state at interface $i+\\tfrac{1}{2}$ is reconstructed as $u_{i+\\tfrac{1}{2}}^{-} = u_i^n + \\dfrac{1}{2}s_i$. With the upwind numerical flux $F_{i+\\tfrac{1}{2}} = a\\,u_{i+\\tfrac{1}{2}}^{-}$ for $a0$, the finite volume update is $u_i^{n+1} = u_i^n - \\nu\\left(u_{i+\\tfrac{1}{2}}^{-} - u_{i-\\tfrac{1}{2}}^{-}\\right)$.\n\nInitialize a single discontinuity with left and right constant states\n$$\nu_i^0 = \\begin{cases}\nU_L,  i \\le 0, \\\\\nU_R,  i \\ge 1,\n\\end{cases}\n$$\nwhere $U_L  U_R$ and both are finite real constants. Assume $0  \\nu  1$.\n\nDefine the overshoot amplitude at the first time step near the discontinuity as the positive amount by which the updated value in the leftmost cell adjacent to the interface exceeds the left state, namely $A_{\\text{over}} = \\max\\{0,\\,u_0^{1} - U_L\\}$.\n\nStarting from the conservation law, the finite volume update with upwind flux, and the MUSCL unlimited slope reconstruction stated above, derive the failure of monotonicity and compute the exact closed-form expression for $A_{\\text{over}}$ as a function of $\\nu$, $U_L$, and $U_R$. Express your final answer as a single analytical expression. No rounding is required and no units should be included in the final expression.",
            "solution": "The problem requires the derivation of the failure of monotonicity and the calculation of the overshoot amplitude for a specific finite volume scheme applied to the linear advection equation. The scheme is a second-order MUSCL reconstruction with an unlimited central slope, combined with a first-order explicit Euler time update and an upwind flux.\n\nThe one-dimensional scalar linear advection equation is given by\n$$u_t + a\\,u_x = 0$$\nwhere the advection speed $a  0$ is a constant. The finite volume update for the cell average $u_i^n$ in cell $i$ at time level $n$ is\n$$u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right)$$\nThe numerical flux $F_{i+\\frac{1}{2}}$ is calculated using an upwind scheme, which for $a  0$ means we take the state from the left of the interface, $u_{i+\\frac{1}{2}}^{-}$. The flux function for the linear advection equation is $F(u)=au$. Thus, the numerical flux is $F_{i+\\frac{1}{2}} = a\\,u_{i+\\frac{1}{2}}^{-}$. Substituting this into the update formula and using the Courant–Friedrichs–Lewy (CFL) number $\\nu = a\\,\\Delta t/\\Delta x$, we recover the update formula provided in the problem statement:\n$$u_i^{n+1} = u_i^n - \\nu\\left(u_{i+\\frac{1}{2}}^{-} - u_{i-\\frac{1}{2}}^{-}\\right)$$\nThe state $u_{i+\\frac{1}{2}}^{-}$ is obtained from a MUSCL reconstruction within cell $i$. With an unlimited linear slope, the value at the right boundary of cell $i$ (left side of interface $i+\\frac{1}{2}$) is given by\n$$u_{i+\\frac{1}{2}}^{-} = u_i^n + \\frac{1}{2}s_i^n$$\nwhere the slope $s_i^n$ is computed using a central difference:\n$$s_i^n = \\frac{u_{i+1}^n - u_{i-1}^n}{2}$$\nWe are asked to find the overshoot amplitude $A_{\\text{over}} = \\max\\{0, u_0^{1} - U_L\\}$ after the first time step, starting from the initial condition of a step discontinuity:\n$$\nu_i^0 = \\begin{cases}\nU_L,  i \\le 0, \\\\\nU_R,  i \\ge 1,\n\\end{cases}\n$$\nwith $U_L  U_R$.\n\nLet's compute the value of $u_0^1$. The update for cell $i=0$ is:\n$$u_0^1 = u_0^0 - \\nu\\left(u_{\\frac{1}{2}}^{-} - u_{-\\frac{1}{2}}^{-}\\right)$$\nWe need to determine the reconstructed interface states $u_{\\frac{1}{2}}^{-}$ and $u_{-\\frac{1}{2}}^{-}$ at time level $n=0$.\n\nFirst, we compute the required slopes at $n=0$:\nThe slope in cell $i=0$ is $s_0^0$:\n$$s_0^0 = \\frac{u_1^0 - u_{-1}^0}{2}$$\nUsing the initial condition, $u_1^0 = U_R$ and $u_{-1}^0 = U_L$.\n$$s_0^0 = \\frac{U_R - U_L}{2}$$\nThe slope in cell $i=-1$ is $s_{-1}^0$:\n$$s_{-1}^0 = \\frac{u_0^0 - u_{-2}^0}{2}$$\nUsing the initial condition, $u_0^0 = U_L$ and $u_{-2}^0 = U_L$.\n$$s_{-1}^0 = \\frac{U_L - U_L}{2} = 0$$\n\nNow, we can find the reconstructed states at the interfaces:\nThe state $u_{\\frac{1}{2}}^{-}$ is reconstructed from cell $i=0$:\n$$u_{\\frac{1}{2}}^{-} = u_0^0 + \\frac{1}{2}s_0^0 = U_L + \\frac{1}{2}\\left(\\frac{U_R - U_L}{2}\\right) = U_L + \\frac{U_R - U_L}{4}$$\nThe state $u_{-\\frac{1}{2}}^{-}$ is reconstructed from cell $i=-1$:\n$$u_{-\\frac{1}{2}}^{-} = u_{-1}^0 + \\frac{1}{2}s_{-1}^0 = U_L + \\frac{1}{2}(0) = U_L$$\n\nSubstitute these interface states back into the update equation for $u_0^1$:\n$$u_0^1 = u_0^0 - \\nu\\left( \\left(U_L + \\frac{U_R - U_L}{4}\\right) - U_L \\right)$$\nSince $u_0^0 = U_L$, this simplifies to:\n$$u_0^1 = U_L - \\nu\\left(\\frac{U_R - U_L}{4}\\right)$$\n\nNow we analyze this result to demonstrate the failure of monotonicity. A scheme is monotone if it does not introduce new extrema. The stencil for updating cell $i=0$ involves values from cells $i=-2, -1, 0, 1$. The initial values are $u_{-2}^0=U_L$, $u_{-1}^0=U_L$, $u_0^0=U_L$, and $u_1^0=U_R$. Given $U_L  U_R$, the maximum value in the neighborhood is $U_L$. Monotonicity requires $u_0^1 \\le U_L$. Let's check this condition:\n$$u_0^1 - U_L = -\\nu\\left(\\frac{U_R - U_L}{4}\\right)$$\nWe can rewrite the term in the parenthesis as $-(U_L - U_R)$.\n$$u_0^1 - U_L = -\\nu\\left(\\frac{-(U_L - U_R)}{4}\\right) = \\frac{\\nu(U_L - U_R)}{4}$$\nWe are given that $\\nu  0$ and $U_L  U_R$. This implies that $(U_L - U_R)  0$. Therefore, the product $\\frac{\\nu(U_L - U_R)}{4}$ is strictly positive.\n$$u_0^1 - U_L  0 \\implies u_0^1  U_L$$\nThe updated value in cell $0$ exceeds the initial maximum value in its neighborhood. This creation of a new local maximum is a clear violation of the monotonicity principle, demonstrating the failure of monotonicity for this scheme. This phenomenon is known as an overshoot.\n\nFinally, we compute the overshoot amplitude, defined as $A_{\\text{over}} = \\max\\{0, u_0^1 - U_L\\}$.\nSince we have just shown that $u_0^1 - U_L  0$, the $\\max$ function is redundant, and we have:\n$$A_{\\text{over}} = u_0^1 - U_L$$\nSubstituting the expression we found for $u_0^1-U_L$:\n$$A_{\\text{over}} = \\frac{\\nu(U_L - U_R)}{4}$$\nThis is the closed-form expression for the overshoot amplitude at the first time step.",
            "answer": "$$\n\\boxed{\\frac{\\nu(U_L - U_R)}{4}}\n$$"
        },
        {
            "introduction": "Having established the need for limiters, we now investigate what constitutes a \"good\" limiter. This exercise asks you to work with a deliberately chosen \"bad\" flux limiter that falls outside the permissible Total Variation Diminishing (TVD) region defined by the Sweby conditions. By performing a step-by-step calculation on a simple test case, you will witness firsthand how violating these conditions leads to an increase in total variation and the generation of new extrema, reinforcing the theoretical framework required for designing robust, non-oscillatory schemes .",
            "id": "3976741",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a  0$. In a finite-volume discretization on a uniform grid with spacing $\\Delta x$, define the numerical flux at interface $x_{i+1/2}$ using a Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL)-type piecewise linear reconstruction with a flux limiter $\\phi(r)$ as follows. For $a  0$, the left state at the interface $x_{i+1/2}$ is\n$$\nu_{i+1/2}^{-} = u_{i} + \\frac{1}{2}\\,\\phi(r_{i})\\,(u_{i} - u_{i-1}),\n$$\nwhere the ratio of consecutive slopes is\n$$\nr_{i} = \\frac{u_{i} - u_{i-1}}{u_{i+1} - u_{i}},\n$$\nwhenever the denominator is nonzero, and the upwind numerical flux is $F_{i+1/2} = a\\,u_{i+1/2}^{-}$. The update over one explicit Euler time step $\\Delta t$ is\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda\\,(F_{i+1/2}^{n} - F_{i-1/2}^{n}), \\quad \\lambda \\equiv \\frac{a\\,\\Delta t}{\\Delta x}.\n$$\nLet the domain be periodic with $N=3$ cells, indexed $i \\in \\{0,1,2\\}$, and with periodic wrap $u_{-1} \\equiv u_{2}$ and $u_{3} \\equiv u_{0}$. Define the Discrete Total Variation $TV_{d}$ on the periodic grid by\n$$\nTV_{d}(u) = \\sum_{i=0}^{N-1} \\left|u_{i+1} - u_{i}\\right|, \\quad u_{N} \\equiv u_{0}.\n$$\nIn Total Variation Diminishing (TVD) theory, the Sweby conditions constrain $\\phi(r)$ so that the scheme does not create new extrema and does not increase $TV_{d}$. In this problem, deliberately violate those conditions by choosing the limiter\n$$\n\\phi_{\\text{bad}}(r) = 3 \\quad \\text{for all real } r.\n$$\nTake $a = 1$, a Courant–Friedrichs–Lewy (CFL) number $\\lambda = \\frac{1}{2}$, and initial cell averages\n$$\nu_{0}^{n} = 0, \\quad u_{1}^{n} = 1, \\quad u_{2}^{n} = 2.\n$$\nStarting from the fundamental conservative update and the definitions above, do the following:\n1. Explain concisely, by reference to the TVD framework and the Sweby constraints, why $\\phi_{\\text{bad}}(r)$ violates the TVD admissible region.\n2. Compute $u_{i+1/2}^{-}$ for $i \\in \\{0,1,2\\}$, the corresponding fluxes $F_{i+1/2}$, and the updated cell averages $u_{i}^{n+1}$.\n3. Compute $TV_{d}(u^{n})$ and $TV_{d}(u^{n+1})$ and demonstrate that the update produces new extrema.\n4. Report the single scalar quantity $\\Delta TV_{d} \\equiv TV_{d}(u^{n+1}) - TV_{d}(u^{n})$ as your final answer. Express your final answer in exact form; no rounding is required.",
            "solution": "The user has provided a problem statement regarding a numerical scheme for the one-dimensional linear advection equation. The task is to analyze the properties of a specific, non-Total Variation Diminishing (TVD) scheme.\n\n### Step 1: Extract Givens\n- **Governing Equation**: $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a  0$.\n- **Discretization**: Finite-volume method on a uniform grid with spacing $\\Delta x$.\n- **Reconstruction**: Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) piecewise linear reconstruction. The left state at interface $x_{i+1/2}$ for $a  0$ is $u_{i+1/2}^{-} = u_{i} + \\frac{1}{2}\\,\\phi(r_{i})\\,(u_{i} - u_{i-1})$.\n- **Slope Ratio**: $r_{i} = \\frac{u_{i} - u_{i-1}}{u_{i+1} - u_{i}}$.\n- **Numerical Flux**: Upwind flux $F_{i+1/2} = a\\,u_{i+1/2}^{-}$.\n- **Time Integration**: Explicit Euler with update formula $u_{i}^{n+1} = u_{i}^{n} - \\lambda\\,(F_{i+1/2}^{n} - F_{i-1/2}^{n})$, where $\\lambda \\equiv \\frac{a\\,\\Delta t}{\\Delta x}$.\n- **Domain**: Periodic with $N=3$ cells, indexed $i \\in \\{0,1,2\\}$.\n- **Periodic Boundary Conditions**: $u_{-1} \\equiv u_{2}$ and $u_{3} \\equiv u_{0}$.\n- **Total Variation Definition**: $TV_{d}(u) = \\sum_{i=0}^{N-1} |u_{i+1} - u_{i}|$, with $u_{N} \\equiv u_{0}$.\n- **Flux Limiter**: $\\phi_{\\text{bad}}(r) = 3$ for all real $r$.\n- **Constants**: $a = 1$, $\\lambda = \\frac{1}{2}$.\n- **Initial Conditions**: $u_{0}^{n} = 0$, $u_{1}^{n} = 1$, $u_{2}^{n} = 2$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the established theory of numerical methods for hyperbolic conservation laws. It poses a well-defined computational exercise to demonstrate the consequences of violating the TVD conditions. All necessary givens are provided, and there are no internal contradictions. The language is objective and formal. The use of a \"bad\" limiter is a standard pedagogical tool to illustrate the importance of the TVD constraints. The problem is therefore deemed **valid**.\n\n### Step 3: Solution\nThe problem asks for four tasks to be completed.\n\n**1. Violation of TVD Conditions**\n\nA numerical scheme is TVD if the total variation of the discrete solution does not increase with time, i.e., $TV_{d}(u^{n+1}) \\le TV_{d}(u^{n})$. For a MUSCL-type scheme with an explicit Euler time step, the conditions on the flux limiter $\\phi(r)$ to ensure the scheme is TVD are formulated in the Sweby diagram. For the given scheme with $a0$, the sufficient conditions on $\\phi(r)$ for $r0$ and Courant number $\\lambda$ are:\n$$0 \\leq \\phi(r) \\leq 2$$\n$$0 \\leq \\frac{\\phi(r)}{r} \\leq \\frac{2}{\\lambda}$$\nThe given limiter is $\\phi_{\\text{bad}}(r) = 3$ for all values of $r$. This directly violates the first condition, $0 \\leq \\phi(r) \\leq 2$. A value of $\\phi(r)  2$ corresponds to an excessively anti-diffusive (or compressive) reconstruction, which tends to steepen gradients in an uncontrolled manner, leading to spurious oscillations and the creation of new extrema. This violates the core principle of a TVD scheme, which is to prevent such non-physical behavior.\n\n**2. Computation of Updated Cell Averages**\n\nWe are given $a = 1$, $\\lambda = \\frac{1}{2}$, and the initial state $u^{n} = (u_0^n, u_1^n, u_2^n) = (0, 1, 2)$. The periodic boundary conditions imply $u_{-1}^n = u_2^n = 2$ and $u_3^n = u_0^n = 0$. The flux limiter is $\\phi(r) = 3$.\n\nWe first compute the slope ratios $r_i$ for $i \\in \\{0, 1, 2\\}$:\n- For $i=0$: $r_0 = \\frac{u_0^n - u_{-1}^n}{u_1^n - u_0^n} = \\frac{0 - 2}{1 - 0} = -2$.\n- For $i=1$: $r_1 = \\frac{u_1^n - u_0^n}{u_2^n - u_1^n} = \\frac{1 - 0}{2 - 1} = 1$.\n- For $i=2$: $r_2 = \\frac{u_2^n - u_1^n}{u_3^n - u_2^n} = \\frac{2 - 1}{0 - 2} = -\\frac{1}{2}$.\n\nNext, we calculate the reconstructed states $u_{i+1/2}^{-}$ at the cell interfaces:\n- For $i=0$: $u_{1/2}^{-} = u_0^n + \\frac{1}{2}\\phi(r_0)(u_0^n - u_{-1}^n) = 0 + \\frac{1}{2}(3)(0 - 2) = -3$.\n- For $i=1$: $u_{3/2}^{-} = u_1^n + \\frac{1}{2}\\phi(r_1)(u_1^n - u_0^n) = 1 + \\frac{1}{2}(3)(1 - 0) = 1 + \\frac{3}{2} = \\frac{5}{2}$.\n- For $i=2$: $u_{5/2}^{-} = u_2^n + \\frac{1}{2}\\phi(r_2)(u_2^n - u_1^n) = 2 + \\frac{1}{2}(3)(2 - 1) = 2 + \\frac{3}{2} = \\frac{7}{2}$.\n\nThe numerical fluxes are $F_{i+1/2} = a u_{i+1/2}^{-} = 1 \\cdot u_{i+1/2}^{-}$.\n- $F_{1/2} = -3$.\n- $F_{3/2} = \\frac{5}{2}$.\n- $F_{5/2} = \\frac{7}{2}$.\nBy periodicity, the flux at interface $x_{-1/2}$ is equal to the flux at $x_{5/2}$, so $F_{-1/2} = F_{5/2} = \\frac{7}{2}$.\n\nNow, we update the cell averages using $u_{i}^{n+1} = u_{i}^{n} - \\lambda(F_{i+1/2} - F_{i-1/2})$ with $\\lambda = \\frac{1}{2}$:\n- For $i=0$: $u_0^{n+1} = u_0^n - \\frac{1}{2}(F_{1/2} - F_{-1/2}) = 0 - \\frac{1}{2}(-3 - \\frac{7}{2}) = -\\frac{1}{2}(-\\frac{13}{2}) = \\frac{13}{4}$.\n- For $i=1$: $u_1^{n+1} = u_1^n - \\frac{1}{2}(F_{3/2} - F_{1/2}) = 1 - \\frac{1}{2}(\\frac{5}{2} - (-3)) = 1 - \\frac{1}{2}(\\frac{11}{2}) = 1 - \\frac{11}{4} = -\\frac{7}{4}$.\n- For $i=2$: $u_2^{n+1} = u_2^n - \\frac{1}{2}(F_{5/2} - F_{3/2}) = 2 - \\frac{1}{2}(\\frac{7}{2} - \\frac{5}{2}) = 2 - \\frac{1}{2}(1) = \\frac{3}{2} = \\frac{6}{4}$.\nThe updated state is $u^{n+1} = (\\frac{13}{4}, -\\frac{7}{4}, \\frac{6}{4})$.\n\n**3. Total Variation and New Extrema**\n\nFirst, we compute the Total Variation of the initial state $u^{n} = (0, 1, 2)$:\n$$TV_{d}(u^{n}) = |u_1^n - u_0^n| + |u_2^n - u_1^n| + |u_0^n - u_2^n| = |1-0| + |2-1| + |0-2| = 1 + 1 + 2 = 4.$$\nNext, we compute the Total Variation of the updated state $u^{n+1} = (\\frac{13}{4}, -\\frac{7}{4}, \\frac{6}{4})$:\n$$\n\\begin{aligned}\nTV_{d}(u^{n+1}) = |u_1^{n+1} - u_0^{n+1}| + |u_2^{n+1} - u_1^{n+1}| + |u_0^{n+1} - u_2^{n+1}| \\\\\n= \\left|-\\frac{7}{4} - \\frac{13}{4}\\right| + \\left|\\frac{6}{4} - \\left(-\\frac{7}{4}\\right)\\right| + \\left|\\frac{13}{4} - \\frac{6}{4}\\right| \\\\\n= \\left|-\\frac{20}{4}\\right| + \\left|\\frac{13}{4}\\right| + \\left|\\frac{7}{4}\\right| \\\\\n= 5 + \\frac{13}{4} + \\frac{7}{4} = 5 + \\frac{20}{4} = 5 + 5 = 10.\n\\end{aligned}\n$$\nThe total variation has increased from $TV_{d}(u^{n}) = 4$ to $TV_{d}(u^{n+1}) = 10$, confirming the scheme is not TVD.\n\nA TVD scheme also satisfies a maximum principle, meaning it does not create new global extrema. The range of the initial data is $[\\min(u^n), \\max(u^n)] = [0, 2]$. The range of the updated solution is $[\\min(u^{n+1}), \\max(u^{n+1})] = [-\\frac{7}{4}, \\frac{13}{4}] = [-1.75, 3.25]$. Since the new maximum $u_0^{n+1} = 3.25$ is greater than the initial maximum of $2$, and the new minimum $u_1^{n+1} = -1.75$ is less than the initial minimum of $0$, the scheme has created new extrema, which is a characteristic failure of a non-TVD scheme.\n\n**4. Change in Total Variation**\n\nThe change in the Discrete Total Variation is calculated as:\n$$\\Delta TV_{d} = TV_{d}(u^{n+1}) - TV_{d}(u^{n}) = 10 - 4 = 6.$$",
            "answer": "$$\n\\boxed{6}\n$$"
        }
    ]
}