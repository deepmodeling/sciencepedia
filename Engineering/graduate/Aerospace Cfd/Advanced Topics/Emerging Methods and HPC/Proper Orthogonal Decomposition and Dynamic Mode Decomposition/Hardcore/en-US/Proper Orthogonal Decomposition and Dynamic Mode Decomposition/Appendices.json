{
    "hands_on_practices": [
        {
            "introduction": "Proper Orthogonal Decomposition (POD) provides a basis that is optimal for capturing data variance, or \"energy.\" However, the very definition of energy is flexible and depends on the chosen inner product. This exercise explores how a physically-motivated weighted inner product can produce a more meaningful set of basis vectors compared to a standard Euclidean inner product, especially when dealing with state variables of different physical significance . This practice is invaluable for learning to tailor the POD method to the specific physics of interest, ensuring that the resulting reduced-order model captures the most relevant dynamics.",
            "id": "3987525",
            "problem": "Consider a reduced two-component state extracted from a compressible flow simulation in aerospace Computational Fluid Dynamics (CFD). The state at time index $k$ is $x_{k} \\in \\mathbb{R}^{2}$ with components $x_{k} = \\begin{pmatrix} c_{k} \\\\ u'_{k} \\end{pmatrix}$, where $c_{k}$ represents a passive scalar concentration fluctuation driven by injection and $u'_{k}$ represents the streamwise velocity fluctuation. You are given four snapshots,\n$$\nx_{1} = \\begin{pmatrix} 4 \\\\ 0 \\end{pmatrix},\\quad\nx_{2} = \\begin{pmatrix} -4 \\\\ 0 \\end{pmatrix},\\quad\nx_{3} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix},\\quad\nx_{4} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}.\n$$\nThe number of snapshots is $n = 4$. The passive scalar component has larger variance than the velocity component in these data, but kinetic energy is physically associated with $u'_{k}$ rather than $c_{k}$.\n\nDefine two inner products on $\\mathbb{R}^{2}$:\n- The Euclidean inner product $\\langle a, b \\rangle = a^{\\top} b$.\n- The energy-weighted inner product $\\langle a, b \\rangle_{W} = a^{\\top} W b$ with $W = \\operatorname{diag}(\\alpha, 1)$ and $\\alpha = 0.01$, which downweights the passive scalar in proportion to its lack of physical relevance to kinetic energy.\n\nStarting from the definition of Proper Orthogonal Decomposition (POD) as the problem of finding directions that maximize the mean-square projection of the data subject to orthonormality in the chosen inner product, derive the leading POD mode under the Euclidean inner product and under the energy-weighted inner product. Then explain, from first principles, how and why the choice of inner product reorders the leading POD modes in this example, and discuss the implications this has for model reduction and for interpreting modes relative to Dynamic Mode Decomposition (DMD) (define the acronym and its core aim before discussing).\n\nReport the components of the leading POD modes as a single dimensionless row vector\n$$\n\\left((\\phi^{\\mathrm{E}}_{1})_{1},\\;(\\phi^{\\mathrm{E}}_{1})_{2},\\;(\\phi^{\\mathrm{W}}_{1})_{1},\\;(\\phi^{\\mathrm{W}}_{1})_{2}\\right),\n$$\nwhere $\\phi^{\\mathrm{E}}_{1}$ is the leading POD mode under the Euclidean inner product and $\\phi^{\\mathrm{W}}_{1}$ is the leading POD mode under the energy-weighted inner product. No rounding is required.",
            "solution": "The user wants me to solve a problem related to Proper Orthogonal Decomposition (POD) in the context of aerospace CFD.\n\nHere's my plan:\n1.  **Validate the Problem**: I'll meticulously check the problem statement against my internal validation criteria.\n    *   **Step 1: Extract Givens**: I will list all the provided data and definitions verbatim.\n        *   State vector: $x_{k} \\in \\mathbb{R}^{2}$, $x_{k} = \\begin{pmatrix} c_{k} \\\\ u'_{k} \\end{pmatrix}$.\n        *   Four snapshots: $x_{1} = \\begin{pmatrix} 4 \\\\ 0 \\end{pmatrix}$, $x_{2} = \\begin{pmatrix} -4 \\\\ 0 \\end{pmatrix}$, $x_{3} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$, $x_{4} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\n        *   Number of snapshots: $n = 4$.\n        *   Euclidean inner product: $\\langle a, b \\rangle = a^{\\top} b$.\n        *   Energy-weighted inner product: $\\langle a, b \\rangle_{W} = a^{\\top} W b$.\n        *   Weight matrix: $W = \\operatorname{diag}(\\alpha, 1)$ with $\\alpha = 0.01$.\n        *   Goal: Find the leading POD modes for both inner products, explain the reordering, and discuss implications for model reduction and DMD.\n        *   Final Answer Format: A row vector with 4 components.\n    *   **Step 2: Validate Using Extracted Givens**:\n        *   **Scientifically Grounded?**: Yes. The problem is a standard application of POD to a simplified state vector from CFD. POD is a well-established technique in fluid dynamics. The use of a weighted inner product to emphasize physically relevant quantities (like kinetic energy) is a common and sound practice.\n        *   **Well-Posed?**: Yes. The problem is clearly defined. Finding the leading POD mode is equivalent to finding the leading eigenvector of the correlation matrix, which is a standard linear algebra problem. With the given data, a unique solution exists (up to a sign, which is standard for eigenvectors).\n        *   **Objective?**: Yes. The language is precise and mathematical. No subjective claims.\n        *   **Completeness?**: Yes. All necessary data (snapshots, inner products) are provided.\n        *   **Consistency?**: Yes. No contradictions in the given data or definitions.\n        *   **Realism?**: While simplified, the setup is a plausible toy model for real-world CFD data analysis. The values are reasonable.\n        *   **Trivial?**: No. It requires understanding the definition of POD, how it connects to the correlation matrix and its eigenvectors, and how changing the inner product affects this calculation. It also asks for a conceptual explanation.\n    *   **Step 3: Verdict and Action**: The problem is valid. I will proceed with the solution.\n\n2.  **Solve the Problem**:\n    *   **Part 1: Define POD**: I'll start by formally stating the POD problem as an optimization problem and showing its connection to the eigenvalue problem of the correlation matrix.\n        *   POD seeks a set of orthonormal basis vectors $\\{\\phi_j\\}$ that are optimal in the sense of maximizing the averaged projection of the data onto these vectors.\n        *   The leading POD mode $\\phi_1$ maximizes $\\frac{1}{n} \\sum_{k=1}^{n} |\\langle x_k, \\phi_1 \\rangle|^2$ subject to $\\|\\phi_1\\|^2 = \\langle \\phi_1, \\phi_1 \\rangle = 1$.\n        *   This is equivalent to finding the eigenvector corresponding to the largest eigenvalue of the correlation matrix $C = \\frac{1}{n} \\sum_{k=1}^{n} x_k x_k^\\top$. The method of snapshots uses the matrix $K_{ij} = x_i^\\top x_j$. The POD modes are then linear combinations of the snapshots. For a low-dimensional state space like $\\mathbb{R}^2$, it's more direct to compute the spatial correlation matrix $C = \\frac{1}{n} X X^\\top$, where $X = [x_1, x_2, x_3, x_4]$. The eigenvectors of $C$ are the POD modes. The eigenvalues of $C$ represent the mean energy captured by each mode.\n\n    *   **Part 2: Euclidean Inner Product Case**:\n        *   The inner product is $\\langle a, b \\rangle = a^\\top b$. The norm is $\\|\\phi\\|^2 = \\phi^\\top \\phi$.\n        *   The data matrix is $X = \\begin{pmatrix} 4  -4  3  0 \\\\ 0  0  0  1 \\end{pmatrix}$.\n        *   The correlation matrix is $C_E = \\frac{1}{n} X X^\\top$. I don't need the $\\frac{1}{n}$ factor to find the eigenvectors, as it just scales the eigenvalues. Let's compute $X X^\\top$.\n        *   $X X^\\top = \\begin{pmatrix} 4  -4  3  0 \\\\ 0  0  0  1 \\end{pmatrix} \\begin{pmatrix} 4  0 \\\\ -4  0 \\\\ 3  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} (4^2 + (-4)^2 + 3^2 + 0^2)  (4 \\cdot 0 + (-4) \\cdot 0 + 3 \\cdot 0 + 0 \\cdot 1) \\\\ (0 \\cdot 4 + 0 \\cdot (-4) + 0 \\cdot 3 + 1 \\cdot 0)  (0^2 + 0^2 + 0^2 + 1^2) \\end{pmatrix}$\n        *   $X X^\\top = \\begin{pmatrix} 16 + 16 + 9  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 41  0 \\\\ 0  1 \\end{pmatrix}$.\n        *   This is a diagonal matrix. The eigenvalues are $\\lambda_1 = 41$ and $\\lambda_2 = 1$. The corresponding eigenvectors are the standard basis vectors.\n        *   The leading eigenvalue is $\\lambda_1 = 41$. The corresponding eigenvector is $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\n        *   I must normalize it with respect to the Euclidean norm. $\\|\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\\| = \\sqrt{1^2 + 0^2} = 1$. It's already normalized.\n        *   So, the leading POD mode for the Euclidean case is $\\phi^{\\mathrm{E}}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\n        *   This makes sense. The data has a huge variance in the first component ($c_k$) and very little in the second ($u'_k$). So the direction of maximum variance is the $c_k$ axis.\n\n    *   **Part 3: Weighted Inner Product Case**:\n        *   The inner product is $\\langle a, b \\rangle_W = a^\\top W b$. The norm is $\\|\\phi\\|_W^2 = \\phi^\\top W \\phi = 1$.\n        *   The POD problem is to maximize $\\frac{1}{n} \\sum_{k=1}^n |\\langle x_k, \\phi \\rangle_W|^2$ subject to $\\|\\phi\\|_W^2 = 1$.\n        *   Let's use a change of coordinates. Let $y = W^{1/2} x$ and $\\psi = W^{1/2} \\phi$.\n        *   The weighted inner product becomes $\\langle x, \\phi \\rangle_W = x^\\top W \\phi = (W^{1/2} x)^\\top (W^{1/2} \\phi) = y^\\top \\psi = \\langle y, \\psi \\rangle_E$.\n        *   The normalization condition becomes $\\|\\phi\\|_W^2 = \\phi^\\top W \\phi = \\psi^\\top \\psi = \\|\\psi\\|_E^2 = 1$.\n        *   The POD problem in the transformed coordinates is to maximize the variance of the projected transformed data $y_k$:\n            Maximize $\\frac{1}{n}\\sum_k |\\langle y_k, \\psi \\rangle_E|^2$ subject to $\\|\\psi\\|_E^2 = 1$.\n        *   This is the standard Euclidean POD problem for the transformed data $y_k = W^{1/2} x_k$.\n        *   The solution is that $\\psi$ are the eigenvectors of the correlation matrix of the $y_k$ data: $C_y = \\frac{1}{n} \\sum_k y_k y_k^\\top$.\n        *   $C_y = W^{1/2} \\left(\\frac{1}{n} \\sum_k x_k x_k^\\top \\right) W^{1/2} = W^{1/2} C_E W^{1/2}$.\n        *   Let's calculate this matrix. $W = \\begin{pmatrix} \\alpha  0 \\\\ 0  1 \\end{pmatrix}$ with $\\alpha = 0.01$.\n        *   $W^{1/2} = \\begin{pmatrix} \\sqrt{\\alpha}  0 \\\\ 0  1 \\end{pmatrix}$.\n        *   We previously found $n C_E = X X^\\top = \\begin{pmatrix} 41  0 \\\\ 0  1 \\end{pmatrix}$.\n        *   $n C_y = W^{1/2} (X X^\\top) W^{1/2} = \\begin{pmatrix} \\sqrt{\\alpha}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 41  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} \\sqrt{\\alpha}  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\sqrt{\\alpha}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 41\\sqrt{\\alpha}  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 41\\alpha  0 \\\\ 0  1 \\end{pmatrix}$.\n        *   $n C_y = \\begin{pmatrix} 41 \\times 0.01  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0.41  0 \\\\ 0  1 \\end{pmatrix}$.\n        *   This is again a diagonal matrix. The eigenvalues are $\\lambda'_1 = 1$ and $\\lambda'_2 = 0.41$.\n        *   The leading eigenvalue is $\\lambda'_1 = 1$. The corresponding eigenvector (the leading $\\psi$ mode) is $\\psi_1 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$. This vector is already normalized in Euclidean norm.\n        *   Now I need to transform back to the original coordinates to find $\\phi^{\\mathrm{W}}_{1}$.\n        *   $\\psi_1 = W^{1/2} \\phi^{\\mathrm{W}}_{1} \\implies \\phi^{\\mathrm{W}}_{1} = W^{-1/2} \\psi_1$.\n        *   $W^{-1/2} = \\begin{pmatrix} 1/\\sqrt{\\alpha}  0 \\\\ 0  1 \\end{pmatrix}$.\n        *   $\\phi^{\\mathrm{W}}_{1} = \\begin{pmatrix} 1/\\sqrt{\\alpha}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\n        *   Let me double-check the normalization. The mode $\\phi^{\\mathrm{W}}_{1}$ must be normalized in the weighted norm: $\\|\\phi^{\\mathrm{W}}_{1}\\|_W^2 = 1$.\n        *   $(\\phi^{\\mathrm{W}}_{1})^\\top W \\phi^{\\mathrm{W}}_{1} = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} \\alpha  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = 1$. The normalization is correct.\n        *   So, the leading POD mode for the weighted case is $\\phi^{\\mathrm{W}}_{1} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\n\n    *   **Summary of results**:\n        *   Euclidean: $\\phi^{\\mathrm{E}}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\n        *   Weighted: $\\phi^{\\mathrm{W}}_{1} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\n\n    *   **Part 4: Explanation and Discussion**:\n        *   The choice of inner product defines the \"energy\" that POD maximizes. The Euclidean inner product treats all vector components equally. Since the scalar component $c_k$ has much higher variance ($41$) than the velocity component ($1$), the leading Euclidean POD mode aligns with the $c_k$ direction.\n        *   The weighted inner product downweights the contribution of $c_k$ to the total energy by a factor of $\\alpha=0.01$. The weighted energy contribution of the first component becomes $41 \\times 0.01 = 0.41$, which is now less than the weighted energy of the second component ($1$). Consequently, POD prioritizes the velocity direction, making it the leading mode.\n        *   For model reduction, using the Euclidean inner product would lead to a model that captures the passive scalar dynamics but ignores the kinetic energy. The weighted inner product produces a model that captures the physically more significant kinetic energy dynamics.\n        *   Dynamic Mode Decomposition (DMD) finds modes with coherent temporal evolution (a single frequency and growth rate). Using a physically-motivated inner product in POD can help align its energy-ranked modes with the dynamically important modes found by DMD, leading to a more consistent physical interpretation across analysis methods.\n\n3.  **Final Assembly**:\n    *   The final answer is a row vector with 4 components: $((\\phi^{\\mathrm{E}}_{1})_{1}, (\\phi^{\\mathrm{E}}_{1})_{2}, (\\phi^{\\mathrm{W}}_{1})_{1}, (\\phi^{\\mathrm{W}}_{1})_{2})$.\n    *   From my calculations:\n        *   $\\phi^{\\mathrm{E}}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\implies (\\phi^{\\mathrm{E}}_{1})_{1}=1, (\\phi^{\\mathrm{E}}_{1})_{2}=0$.\n        *   $\\phi^{\\mathrm{W}}_{1} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\implies (\\phi^{\\mathrm{W}}_{1})_{1}=0, (\\phi^{\\mathrm{W}}_{1})_{2}=1$.\n    *   So the final vector is $(1, 0, 0, 1)$.\n    *   I will put this into the required `pmatrix` format in the final answer box. `\\begin{pmatrix} 1  0  0  1 \\end{pmatrix}`.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  0  0  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on the concept of tailored inner products, this problem provides a concrete computational exercise for performing POD with a weighted norm. In many computational fluid dynamics (CFD) applications, simulations are performed on non-uniform meshes, meaning different points in the domain represent different physical volumes or areas. This practice demonstrates how to correctly account for this using a weight matrix $M$ in the POD procedure, guiding you through the calculation of modal energy content via the method of snapshots .",
            "id": "3987548",
            "problem": "A high-fidelity computational fluid dynamics dataset for a two-dimensional compressible flow over a thin airfoil was reduced to two dominant fluctuation snapshots of the pressure field after subtracting the mean. The spatial discretization uses a nonuniform mesh, and the energy of a field $u \\in \\mathbb{R}^{m}$ is measured by the symmetric positive-definite matrix $M \\in \\mathbb{R}^{m \\times m}$ via the $M$-inner product $\\langle u, v \\rangle_{M} = u^{\\top} M v$ and the induced $M$-norm $\\|u\\|_{M} = \\sqrt{u^{\\top} M u}$. The proper orthogonal decomposition (POD) seeks modes that optimally capture snapshot energy in this weighted sense.\n\nConsider the following reduced setting in which the spatial dimension is $m = 2$ and the number of snapshots is $n = 2$. The mesh-weight matrix and the snapshot matrix are\n$$\nM = \\begin{pmatrix}\n4  0 \\\\\n0  1\n\\end{pmatrix}, \\qquad\nX = \\begin{pmatrix}\n1  1 \\\\\n0  2\n\\end{pmatrix},\n$$\nwhere the columns of $X$ are the two pressure fluctuation snapshots.\n\nUsing only the definitions of the $M$-inner product and the induced $M$-norm as the energetic measure, compute the singular values $\\sigma_{i}$ that characterize the POD under the $M$-inner product, and quantify the energy captured by each POD mode as $E_{i} = \\sigma_{i}^{2} / \\sum_{j=1}^{n} \\sigma_{j}^{2}$. Report only the fraction of energy captured by the leading POD mode, expressed as a single reduced exact analytic expression. Do not round your final result.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Field**: Aerospace computational fluid dynamics (CFD).\n- **Techniques**: Proper orthogonal decomposition (POD).\n- **Data**: Two fluctuation snapshots of a pressure field.\n- **State Space Dimension**: $m=2$.\n- **Number of Snapshots**: $n=2$.\n- **Weight Matrix**: A symmetric positive-definite matrix $M = \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix} \\in \\mathbb{R}^{m \\times m}$.\n- **Inner Product**: The $M$-inner product is defined as $\\langle u, v \\rangle_{M} = u^{\\top} M v$ for vectors $u, v \\in \\mathbb{R}^{m}$.\n- **Norm**: The induced $M$-norm is $\\|u\\|_{M} = \\sqrt{u^{\\top} M u}$.\n- **Snapshot Matrix**: The data is given by the columns of the matrix $X = \\begin{pmatrix} 1  1 \\\\ 0  2 \\end{pmatrix} \\in \\mathbb{R}^{m \\times n}$.\n- **Objective**: Compute the fraction of energy captured by the leading POD mode, defined as $E_{1} = \\sigma_{1}^{2} / \\sum_{j=1}^{n} \\sigma_{j}^{2}$, where $\\sigma_i$ are the singular values of the system under the $M$-inner product, ordered such that $\\sigma_1 \\ge \\sigma_2 \\ge \\dots$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a well-defined mathematical exercise in linear algebra, specifically concerning generalized singular value decomposition, framed within the standard context of Proper Orthogonal Decomposition (POD) as used in fluid dynamics. The use of a weighted inner product via a mass or mesh matrix ($M$) is a standard technique for analyzing data from non-uniform computational grids. The provided matrix $M$ is symmetric and its eigenvalues ($4$ and $1$) are positive, confirming it is positive-definite and thus suitable for defining a valid inner product. The dimensions of the matrices $M$ and $X$ are consistent. The problem is self-contained, objective, and scientifically sound.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe Proper Orthogonal Decomposition (POD) seeks a set of orthonormal basis vectors (modes) $\\{\\phi_i\\}$ that optimally capture the energy of a given set of data snapshots $\\{x_k\\}$. In this problem, the energy is defined by the $M$-norm, and thus the modes must be orthonormal with respect to the $M$-inner product, i.e., $\\langle \\phi_i, \\phi_j \\rangle_M = \\delta_{ij}$.\n\nThe singular values $\\sigma_i$ associated with this weighted POD problem are found by solving an eigenvalue problem. The method of snapshots, which is computationally efficient when the number of snapshots $n$ is smaller than the spatial dimension $m$, provides a general route to these values. Here $m=n=2$, but the method is still directly applicable. It involves constructing an $n \\times n$ temporal correlation matrix $K$, where the entries are the inner products of the snapshot vectors:\n$$\nK_{ij} = \\langle x_i, x_j \\rangle_M\n$$\nHere, $x_i$ and $x_j$ are the $i$-th and $j$-th columns of the snapshot matrix $X$. The entire matrix $K$ can be computed as:\n$$\nK = X^{\\top} M X\n$$\nThe eigenvalues $\\lambda_i$ of this matrix $K$ are the squared singular values of the weighted system, i.e., $\\lambda_i = \\sigma_i^2$. The total energy contained in the snapshots is the sum of these eigenvalues, which is also the trace of $K$.\n\nFirst, we compute the matrix $K$ using the given matrices $M$ and $X$:\n$$\nM = \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix}, \\qquad X = \\begin{pmatrix} 1  1 \\\\ 0  2 \\end{pmatrix}\n$$\nThe transpose of $X$ is $X^{\\top} = \\begin{pmatrix} 1  0 \\\\ 1  2 \\end{pmatrix}$.\n$$\nK = X^{\\top} M X = \\begin{pmatrix} 1  0 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 0  2 \\end{pmatrix}\n$$\nPerforming the multiplication from left to right:\n$$\nK = \\left( \\begin{pmatrix} 1  0 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix} \\right) \\begin{pmatrix} 1  1 \\\\ 0  2 \\end{pmatrix} = \\begin{pmatrix} 4  0 \\\\ 4  2 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 0  2 \\end{pmatrix}\n$$\n$$\nK = \\begin{pmatrix} (4)(1) + (0)(0)  (4)(1) + (0)(2) \\\\ (4)(1) + (2)(0)  (4)(1) + (2)(2) \\end{pmatrix} = \\begin{pmatrix} 4  4 \\\\ 4  8 \\end{pmatrix}\n$$\nNext, we find the eigenvalues $\\lambda$ of $K$ by solving the characteristic equation $\\det(K - \\lambda I) = 0$, where $I$ is the $2 \\times 2$ identity matrix.\n$$\n\\det\\begin{pmatrix} 4 - \\lambda  4 \\\\ 4  8 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(4 - \\lambda)(8 - \\lambda) - (4)(4) = 0\n$$\n$$\n32 - 8\\lambda - 4\\lambda + \\lambda^2 - 16 = 0\n$$\n$$\n\\lambda^2 - 12\\lambda + 16 = 0\n$$\nWe solve this quadratic equation for $\\lambda$ using the quadratic formula $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\n\\lambda = \\frac{12 \\pm \\sqrt{(-12)^2 - 4(1)(16)}}{2} = \\frac{12 \\pm \\sqrt{144 - 64}}{2} = \\frac{12 \\pm \\sqrt{80}}{2}\n$$\nThe term $\\sqrt{80}$ can be simplified as $\\sqrt{16 \\times 5} = 4\\sqrt{5}$.\n$$\n\\lambda = \\frac{12 \\pm 4\\sqrt{5}}{2} = 6 \\pm 2\\sqrt{5}\n$$\nThe two eigenvalues are $\\lambda_1 = 6 + 2\\sqrt{5}$ and $\\lambda_2 = 6 - 2\\sqrt{5}$. These are the squared singular values, $\\sigma_1^2$ and $\\sigma_2^2$. The leading mode corresponds to the larger eigenvalue, so we have:\n$$\n\\sigma_1^2 = 6 + 2\\sqrt{5}\n$$\n$$\n\\sigma_2^2 = 6 - 2\\sqrt{5}\n$$\nThe problem asks for the fraction of energy captured by the leading POD mode, which is given by the formula $E_1 = \\sigma_1^2 / \\sum_{j=1}^n \\sigma_j^2$. The sum of the squared singular values is the total energy, which is the sum of the eigenvalues:\n$$\n\\sum_{j=1}^{2} \\sigma_j^2 = \\sigma_1^2 + \\sigma_2^2 = (6 + 2\\sqrt{5}) + (6 - 2\\sqrt{5}) = 12\n$$\nThis sum is also equal to the trace of $K$, $\\text{tr}(K) = 4 + 8 = 12$, which serves as a consistency check.\nNow, we can compute the energy fraction for the leading mode:\n$$\nE_1 = \\frac{\\sigma_1^2}{\\sigma_1^2 + \\sigma_2^2} = \\frac{6 + 2\\sqrt{5}}{12}\n$$\nFinally, we simplify this expression by factoring out a $2$ from the numerator:\n$$\nE_1 = \\frac{2(3 + \\sqrt{5})}{12} = \\frac{3 + \\sqrt{5}}{6}\n$$\nThis is the final reduced exact analytic expression for the fraction of energy captured by the leading POD mode.",
            "answer": "$$\n\\boxed{\\frac{3 + \\sqrt{5}}{6}}\n$$"
        },
        {
            "introduction": "While POD identifies modes based on energy, Dynamic Mode Decomposition (DMD) identifies modes associated with coherent temporal patterns, each characterized by a single frequency and growth or decay rate. DMD computes eigenvalues $\\lambda$ of a discrete-time operator that approximates the system's evolution. This exercise focuses on the crucial final step of DMD analysis: translating these complex eigenvalues into physically interpretable quantities—the continuous-time growth/decay rate $\\sigma$ and oscillation frequency $f$ . Mastering this translation is key to diagnosing stability and identifying dominant frequencies in the system under study.",
            "id": "3987563",
            "problem": "An unsteady separated flow past a pitching airfoil is simulated using the incompressible Navier–Stokes equations in a high-fidelity Computational Fluid Dynamics (CFD) solver. A sequence of velocity-field snapshots is collected at uniform sampling interval $\\Delta t$ from a statistically stationary regime. The snapshots are assembled into a snapshot matrix in the spirit of Proper Orthogonal Decomposition (POD), and a Dynamic Mode Decomposition (DMD) is performed to approximate the one-step linear flow map that advances the state by $\\Delta t$.\n\nAssume the flow evolution over short times is well-approximated by a linear operator advancing the state according to a discrete-time map derived from the continuous-time dynamics, and that DMD computes eigenvalues $\\lambda$ of this map. Consider three dominant DMD modes whose eigenvalues, extracted from the CFD snapshot sequence sampled at $\\Delta t = 0.005$ $\\mathrm{s}$, are\n$$\n\\lambda_{1} = 1.02 \\exp(i\\,0.40),\\quad\n\\lambda_{2} = 0.98 \\exp(i\\,2.30),\\quad\n\\lambda_{3} = 0.995 \\exp(-i\\,0.05),\n$$\nwhere $i$ denotes the imaginary unit and each complex argument is taken in the principal range $(-\\pi,\\pi]$.\n\nStarting from the definition of the discrete-time flow map and its relationship to the continuous-time generator of the dynamics, translate each DMD eigenvalue $\\lambda_{j}$ to its corresponding continuous-time exponential growth or decay rate $\\sigma_{j}$ (in $\\mathrm{s}^{-1}$) and signed oscillation frequency $f_{j}$ (in $\\mathrm{Hz}$). Use the principal branch of the complex logarithm in this translation. Then, interpret for each mode whether the dynamics is unstable, neutrally stable, or damped based on the sign of $\\sigma_{j}$, and whether it is oscillatory and at what signed frequency.\n\nRound all reported numerical values for $\\sigma_{j}$ and $f_{j}$ to four significant figures. Express frequencies in $\\mathrm{Hz}$ and growth/decay rates in $\\mathrm{s}^{-1}$. Your final answer must provide, in order, the six numbers $\\sigma_{1}, f_{1}, \\sigma_{2}, f_{2}, \\sigma_{3}, f_{3}$.",
            "solution": "The problem requires the translation of discrete-time eigenvalues from a Dynamic Mode Decomposition (DMD) analysis into continuous-time dynamic characteristics: the exponential growth/decay rate $\\sigma_j$ and the signed oscillation frequency $f_j$.\n\nLet the state of the fluid flow at discrete time instances $t_k = k \\Delta t$ be represented by a vector $x_k$. The DMD algorithm seeks to find a linear operator, represented by a matrix $F$, that best approximates the evolution of the state from one snapshot to the next, such that $x_{k+1} \\approx F x_k$. The eigenvalues $\\lambda_j$ provided in the problem are the eigenvalues of this discrete-time operator $F$.\n\nThe underlying assumption is that the flow dynamics can be modeled by a continuous-time linear system of the form $\\frac{dx}{dt} = Ax$, where $A$ is a time-invariant linear operator. The solution to this system is $x(t) = \\exp(At) x(0)$. The discrete-time map $F$ is therefore the exponentiation of the continuous-time generator $A$ over the time step $\\Delta t$, i.e., $F = \\exp(A \\Delta t)$.\n\nThe relationship between the eigenvalues $\\lambda_j$ of $F$ and the eigenvalues $\\omega_j$ of $A$ is given by $\\lambda_j = \\exp(\\omega_j \\Delta t)$. To find the continuous-time eigenvalues $\\omega_j$, we take the natural logarithm of this equation. The problem specifies using the principal branch of the complex logarithm.\n$$\n\\ln(\\lambda_j) = \\ln(\\exp(\\omega_j \\Delta t)) = \\omega_j \\Delta t\n$$\nThus, the continuous-time eigenvalues are given by:\n$$\n\\omega_j = \\frac{\\ln(\\lambda_j)}{\\Delta t}\n$$\nEach eigenvalue $\\omega_j$ is a complex number that can be expressed in terms of its real and imaginary parts: $\\omega_j = \\sigma_j + i \\Omega_j$. The real part, $\\sigma_j$, is the exponential growth rate (if $\\sigma_j > 0$) or decay rate (if $\\sigma_j  0$). The imaginary part, $\\Omega_j$, is the angular frequency in radians per unit time. The problem asks for the signed oscillation frequency $f_j$ in Hertz, which is related to $\\Omega_j$ by $\\Omega_j = 2\\pi f_j$.\n\nTo perform the calculation, we first express the DMD eigenvalue $\\lambda_j$ in polar form, $\\lambda_j = |\\lambda_j| \\exp(i\\theta_j)$, where $\\theta_j$ is the principal argument. The principal logarithm is then $\\ln(\\lambda_j) = \\ln(|\\lambda_j|) + i\\theta_j$. Substituting this into the expression for $\\omega_j$:\n$$\n\\omega_j = \\sigma_j + i(2\\pi f_j) = \\frac{\\ln(|\\lambda_j|) + i\\theta_j}{\\Delta t} = \\frac{\\ln(|\\lambda_j|)}{\\Delta t} + i \\frac{\\theta_j}{\\Delta t}\n$$\nBy equating the real and imaginary parts, we obtain the formulas for $\\sigma_j$ and $f_j$:\n$$\n\\sigma_j = \\frac{\\ln(|\\lambda_j|)}{\\Delta t} \\quad (\\text{in } \\mathrm{s}^{-1})\n$$\n$$\nf_j = \\frac{\\theta_j}{2\\pi \\Delta t} \\quad (\\text{in } \\mathrm{Hz})\n$$\nThe problem provides the sampling interval $\\Delta t = 0.005 \\mathrm{ s}$ and three DMD eigenvalues. We now process each one.\n\nFor Mode 1: $\\lambda_{1} = 1.02 \\exp(i\\,0.40)$.\nThe magnitude is $|\\lambda_1| = 1.02$ and the argument is $\\theta_1 = 0.40$ radians.\nThe growth rate is:\n$$\n\\sigma_1 = \\frac{\\ln(1.02)}{0.005} \\approx \\frac{0.0198026}{0.005} \\approx 3.96052 \\mathrm{ s}^{-1}\n$$\nRounded to four significant figures, $\\sigma_1 = 3.961 \\mathrm{ s}^{-1}$.\nSince $|\\lambda_1| = 1.02 > 1$, which corresponds to $\\sigma_1 > 0$, this mode is unstable. Its amplitude grows exponentially over time.\nThe frequency is:\n$$\nf_1 = \\frac{0.40}{2\\pi (0.005)} = \\frac{0.40}{0.01\\pi} \\approx 12.7324 \\mathrm{ Hz}\n$$\nRounded to four significant figures, $f_1 = 12.73 \\mathrm{ Hz}$.\nThe mode is oscillatory with a frequency of approximately $12.73 \\mathrm{ Hz}$.\n\nFor Mode 2: $\\lambda_{2} = 0.98 \\exp(i\\,2.30)$.\nThe magnitude is $|\\lambda_2| = 0.98$ and the argument is $\\theta_2 = 2.30$ radians.\nThe growth/decay rate is:\n$$\n\\sigma_2 = \\frac{\\ln(0.98)}{0.005} \\approx \\frac{-0.0202027}{0.005} \\approx -4.04054 \\mathrm{ s}^{-1}\n$$\nRounded to four significant figures, $\\sigma_2 = -4.041 \\mathrm{ s}^{-1}$.\nSince $|\\lambda_2| = 0.98  1$, which corresponds to $\\sigma_2  0$, this mode is stable and damped. Its amplitude decays exponentially over time.\nThe frequency is:\n$$\nf_2 = \\frac{2.30}{2\\pi (0.005)} = \\frac{2.30}{0.01\\pi} \\approx 73.2051 \\mathrm{ Hz}\n$$\nRounded to four significant figures, $f_2 = 73.21 \\mathrm{ Hz}$.\nThe mode is oscillatory with a frequency of approximately $73.21 \\mathrm{ Hz}$.\n\nFor Mode 3: $\\lambda_{3} = 0.995 \\exp(-i\\,0.05)$.\nThe magnitude is $|\\lambda_3| = 0.995$ and the argument is $\\theta_3 = -0.05$ radians.\nThe growth/decay rate is:\n$$\n\\sigma_3 = \\frac{\\ln(0.995)}{0.005} \\approx \\frac{-0.0050125}{0.005} \\approx -1.0025 \\mathrm{ s}^{-1}\n$$\nRounded to four significant figures, $\\sigma_3 = -1.003 \\mathrm{ s}^{-1}$.\nSince $|\\lambda_3| = 0.995  1$, which corresponds to $\\sigma_3  0$, this mode is also stable and damped, though its decay is slower than that of Mode 2.\nThe frequency is:\n$$\nf_3 = \\frac{-0.05}{2\\pi (0.005)} = \\frac{-0.05}{0.01\\pi} \\approx -1.59155 \\mathrm{ Hz}\n$$\nRounded to four significant figures, $f_3 = -1.592 \\mathrm{ Hz}$.\nThe mode is oscillatory with a signed frequency of approximately $-1.592 \\mathrm{ Hz}$. The negative sign indicates the direction of rotation in the complex plane, which can be related to the direction of propagation of the modal structure in physical space.\n\nThe six requested values are $\\sigma_1$, $f_1$, $\\sigma_2$, $f_2$, $\\sigma_3$, and $f_3$.\n$\\sigma_1 = 3.961 \\mathrm{ s}^{-1}$\n$f_1 = 12.73 \\mathrm{ Hz}$\n$\\sigma_2 = -4.041 \\mathrm{ s}^{-1}$\n$f_2 = 73.21 \\mathrm{ Hz}$\n$\\sigma_3 = -1.003 \\mathrm{ s}^{-1}$\n$f_3 = -1.592 \\mathrm{ Hz}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 3.961  12.73  -4.041  73.21  -1.003  -1.592 \\end{pmatrix}}\n$$"
        }
    ]
}