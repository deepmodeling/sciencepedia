{
    "hands_on_practices": [
        {
            "introduction": "Modern ML models often construct the Reynolds stress anisotropy tensor, $b_{ij}$, from a basis of tensors built from the mean flow gradients. This exercise provides a concrete, hands-on calculation of this process, starting from a simple shear flow and assembling the final anisotropy tensor from its constituent parts . Mastering this forward pass is essential for understanding the inner workings of state-of-the-art, tensor-basis turbulence closures.",
            "id": "3974965",
            "problem": "Consider a steady, incompressible, plane shear flow representative of an aerospace boundary layer subregion, with mean velocity field specified by $U_{1}(x_{j}) = \\dot{\\gamma}\\, y$, $U_{2}(x_{j}) = 0$, and $U_{3}(x_{j}) = 0$, where $x_{1} = x$, $x_{2} = y$, and $x_{3} = z$. The Reynolds stress anisotropy tensor $b_{ij}$ is defined via $b_{ij} = \\tau_{ij}/(2k) - \\delta_{ij}/3$, where $\\tau_{ij}$ are the Reynolds stresses and $k$ is the turbulent kinetic energy. In a tensor-basis machine-learning closure, the anisotropy is modeled as a contraction of invariant tensor bases constructed from the mean strain-rate and rotation-rate tensors, with\n$$\nb_{ij} = \\sum_{m=1}^{3} \\theta_{m}\\, T^{(m)}_{ij},\n$$\nwhere the first three basis tensors are\n$$\nT^{(1)}_{ij} = \\tilde{S}_{ij}, \\quad T^{(2)}_{ij} = \\tilde{S}_{ik}\\tilde{R}_{kj} - \\tilde{R}_{ik}\\tilde{S}_{kj}, \\quad T^{(3)}_{ij} = \\tilde{S}_{ik}\\tilde{S}_{kj} - \\frac{1}{3}\\,\\operatorname{tr}(\\tilde{S}^{2})\\,\\delta_{ij}.\n$$\nHere, $\\tilde{S}_{ij} = T\\, S_{ij}$ and $\\tilde{R}_{ij} = T\\, R_{ij}$ are the non-dimensionalized mean strain-rate and rotation-rate tensors, respectively, using the turbulent time scale $T = k/\\epsilon$, with $\\epsilon$ the dissipation rate. The kinematic tensors are defined by\n$$\nS_{ij} = \\frac{1}{2}\\left(\\frac{\\partial U_{i}}{\\partial x_{j}} + \\frac{\\partial U_{j}}{\\partial x_{i}}\\right), \\quad R_{ij} = \\frac{1}{2}\\left(\\frac{\\partial U_{i}}{\\partial x_{j}} - \\frac{\\partial U_{j}}{\\partial x_{i}}\\right).\n$$\n\nLet the shear rate, turbulent kinetic energy, and dissipation be given by $\\dot{\\gamma} = 500\\,\\mathrm{s}^{-1}$, $k = 0.5\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$, and $\\epsilon = 100\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-3}$, so that $T = k/\\epsilon$. Let the machine-learned scalar coefficients be fixed at the state of interest as $\\theta_{1} = -\\frac{2}{25}$, $\\theta_{2} = \\frac{1}{50}$, and $\\theta_{3} = \\frac{11}{100}$.\n\nUsing these definitions and values, compute the predicted $b_{ij}$, and then determine the largest eigenvalue $\\lambda_{\\max}$ of $b_{ij}$ as a closed-form analytical expression. Provide the final answer as an exact expression; do not round.",
            "solution": "The user-provided problem is a well-defined exercise in the field of computational fluid dynamics, specifically concerning Reynolds-averaged Navier-Stokes (RANS) turbulence modeling with machine learning closures. All provided definitions, such as the mean velocity field, Reynolds stress anisotropy tensor, tensor bases, and kinematic tensors, are standard in the turbulence modeling literature. The numerical values are physically plausible, and the task is a straightforward, albeit detailed, calculation. The problem is self-contained, scientifically grounded, and well-posed. Therefore, the problem is deemed valid and a full solution can be constructed.\n\nThe first step is to compute the mean velocity gradient tensor, $\\frac{\\partial U_i}{\\partial x_j}$, from the given mean velocity field $U_1 = \\dot{\\gamma} y$, $U_2 = 0$, $U_3 = 0$. In index notation, this is $U_1(x_2) = \\dot{\\gamma} x_2$. The only non-zero component of the gradient is $\\frac{\\partial U_1}{\\partial x_2} = \\dot{\\gamma}$. The velocity gradient tensor, $\\nabla\\mathbf{U}$, is therefore:\n$$\n\\frac{\\partial U_i}{\\partial x_j} = \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n\nNext, we calculate the mean strain-rate tensor, $S_{ij}$, and the mean rotation-rate tensor, $R_{ij}$:\n$$\nS_{ij} = \\frac{1}{2}\\left(\\frac{\\partial U_{i}}{\\partial x_{j}} + \\frac{\\partial U_{j}}{\\partial x_{i}}\\right)\n\\quad \\implies \\quad\nS = \\frac{1}{2} \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ \\dot{\\gamma} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & \\frac{\\dot{\\gamma}}{2} & 0 \\\\ \\frac{\\dot{\\gamma}}{2} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n$$\nR_{ij} = \\frac{1}{2}\\left(\\frac{\\partial U_{i}}{\\partial x_{j}} - \\frac{\\partial U_{j}}{\\partial x_{i}}\\right)\n\\quad \\implies \\quad\nR = \\frac{1}{2} \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ -\\dot{\\gamma} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & \\frac{\\dot{\\gamma}}{2} & 0 \\\\ -\\frac{\\dot{\\gamma}}{2} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n\nThe tensors are non-dimensionalized using the turbulent time scale, $T = k/\\epsilon$. Using the given values $\\dot{\\gamma} = 500\\,\\mathrm{s}^{-1}$, $k = 0.5\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$, and $\\epsilon = 100\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-3}$:\n$T = \\frac{k}{\\epsilon} = \\frac{0.5}{100} = 0.005\\,\\mathrm{s}$\nThe non-dimensional tensors are $\\tilde{S}_{ij} = T S_{ij}$ and $\\tilde{R}_{ij} = T R_{ij}$. Let's define a parameter $\\alpha = \\frac{T\\dot{\\gamma}}{2}$ for convenience.\n$\\alpha = \\frac{(0.005\\,\\mathrm{s})(500\\,\\mathrm{s}^{-1})}{2} = \\frac{2.5}{2} = 1.25 = \\frac{5}{4}$\nThe non-dimensional tensors can be written in terms of $\\alpha$:\n$$\n\\tilde{S} = \\begin{pmatrix} 0 & \\alpha & 0 \\\\ \\alpha & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}, \\quad \\tilde{R} = \\begin{pmatrix} 0 & \\alpha & 0 \\\\ -\\alpha & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n\nNow, we construct the three tensor bases $T^{(m)}_{ij}$:\n1.  $T^{(1)}_{ij} = \\tilde{S}_{ij}$:\n    $$\n    T^{(1)} = \\begin{pmatrix} 0 & \\alpha & 0 \\\\ \\alpha & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n    $$\n2.  $T^{(2)}_{ij} = \\tilde{S}_{ik}\\tilde{R}_{kj} - \\tilde{R}_{ik}\\tilde{S}_{kj}$:\n    $$\n    \\tilde{S}\\tilde{R} = \\begin{pmatrix} 0 & \\alpha & 0 \\\\ \\alpha & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & \\alpha & 0 \\\\ -\\alpha & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} -\\alpha^2 & 0 & 0 \\\\ 0 & \\alpha^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n    $$\n    $$\n    \\tilde{R}\\tilde{S} = \\begin{pmatrix} 0 & \\alpha & 0 \\\\ -\\alpha & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & \\alpha & 0 \\\\ \\alpha & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} \\alpha^2 & 0 & 0 \\\\ 0 & -\\alpha^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n    $$\n    $$\n    T^{(2)} = \\tilde{S}\\tilde{R} - \\tilde{R}\\tilde{S} = \\begin{pmatrix} -2\\alpha^2 & 0 & 0 \\\\ 0 & 2\\alpha^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n    $$\n3.  $T^{(3)}_{ij} = \\tilde{S}_{ik}\\tilde{S}_{kj} - \\frac{1}{3}\\operatorname{tr}(\\tilde{S}^2)\\delta_{ij}$:\n    $$\n    \\tilde{S}^2 = \\tilde{S}\\tilde{S} = \\begin{pmatrix} 0 & \\alpha & 0 \\\\ \\alpha & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & \\alpha & 0 \\\\ \\alpha & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} \\alpha^2 & 0 & 0 \\\\ 0 & \\alpha^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n    $$\n    The trace is $\\operatorname{tr}(\\tilde{S}^2) = \\alpha^2 + \\alpha^2 + 0 = 2\\alpha^2$.\n    $$\n    T^{(3)} = \\begin{pmatrix} \\alpha^2 & 0 & 0 \\\\ 0 & \\alpha^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} - \\frac{2\\alpha^2}{3}\\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{\\alpha^2}{3} & 0 & 0 \\\\ 0 & \\frac{\\alpha^2}{3} & 0 \\\\ 0 & 0 & -\\frac{2\\alpha^2}{3} \\end{pmatrix}\n    $$\n\nNext, we assemble the anisotropy tensor $b_{ij} = \\sum_{m=1}^{3} \\theta_{m}\\, T^{(m)}_{ij}$ using the given coefficients $\\theta_{1} = -2/25$, $\\theta_{2} = 1/50$, and $\\theta_{3} = 11/100$.\n$$\nb = \\theta_{1}T^{(1)} + \\theta_{2}T^{(2)} + \\theta_{3}T^{(3)}\n$$\n$$\nb = \\theta_1 \\begin{pmatrix} 0 & \\alpha & 0 \\\\ \\alpha & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\theta_2 \\begin{pmatrix} -2\\alpha^2 & 0 & 0 \\\\ 0 & 2\\alpha^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\theta_3 \\begin{pmatrix} \\frac{\\alpha^2}{3} & 0 & 0 \\\\ 0 & \\frac{\\alpha^2}{3} & 0 \\\\ 0 & 0 & -\\frac{2\\alpha^2}{3} \\end{pmatrix}\n$$\nCombining these gives the matrix for $b_{ij}$:\n$$\nb = \\begin{pmatrix} -2\\theta_2\\alpha^2 + \\frac{\\theta_3\\alpha^2}{3} & \\theta_1\\alpha & 0 \\\\ \\theta_1\\alpha & 2\\theta_2\\alpha^2 + \\frac{\\theta_3\\alpha^2}{3} & 0 \\\\ 0 & 0 & -\\frac{2\\theta_3\\alpha^2}{3} \\end{pmatrix}\n$$\nThe tensor $b_{ij}$ is block-diagonal. One eigenvalue is immediately apparent from the $(3,3)$ component:\n$$\n\\lambda_3 = -\\frac{2\\theta_3\\alpha^2}{3}\n$$\nThe other two eigenvalues, $\\lambda_1$ and $\\lambda_2$, are the eigenvalues of the upper-left $2\\times2$ block matrix. For a general $2\\times2$ symmetric matrix $\\begin{pmatrix} a & c \\\\ c & b \\end{pmatrix}$, the eigenvalues are $\\lambda = \\frac{a+b}{2} \\pm \\sqrt{\\left(\\frac{a-b}{2}\\right)^2 + c^2}$.\nLet $a = (-2\\theta_2 + \\frac{\\theta_3}{3})\\alpha^2$, $b = (2\\theta_2 + \\frac{\\theta_3}{3})\\alpha^2$, and $c = \\theta_1\\alpha$.\n$$\n\\frac{a+b}{2} = \\frac{1}{2} \\left( \\frac{2\\theta_3\\alpha^2}{3} \\right) = \\frac{\\theta_3\\alpha^2}{3}\n$$\n$$\n\\frac{a-b}{2} = \\frac{1}{2} \\left( -4\\theta_2\\alpha^2 \\right) = -2\\theta_2\\alpha^2\n$$\nSo the other two eigenvalues are:\n$$\n\\lambda_{1,2} = \\frac{\\theta_3\\alpha^2}{3} \\pm \\sqrt{(-2\\theta_2\\alpha^2)^2 + (\\theta_1\\alpha)^2} = \\frac{\\theta_3\\alpha^2}{3} \\pm \\sqrt{4\\theta_2^2\\alpha^4 + \\theta_1^2\\alpha^2}\n$$\nSince $\\alpha > 0$, we can factor out $\\alpha$ from the square root:\n$$\n\\lambda_{1,2} = \\frac{\\theta_3\\alpha^2}{3} \\pm \\alpha\\sqrt{4\\theta_2^2\\alpha^2 + \\theta_1^2}\n$$\nThe three eigenvalues are:\n$$\n\\lambda_1 = \\frac{\\theta_3\\alpha^2}{3} + \\alpha\\sqrt{4\\theta_2^2\\alpha^2 + \\theta_1^2}\n$$\n$$\n\\lambda_2 = \\frac{\\theta_3\\alpha^2}{3} - \\alpha\\sqrt{4\\theta_2^2\\alpha^2 + \\theta_1^2}\n$$\n$$\n\\lambda_3 = -\\frac{2\\theta_3\\alpha^2}{3}\n$$\nNow, substitute the numerical values: $\\alpha = 5/4$, $\\alpha^2 = 25/16$, $\\theta_1 = -2/25$, $\\theta_2 = 1/50$, $\\theta_3 = 11/100$.\nThe term under the square root is:\n$$\n4\\theta_2^2\\alpha^2 + \\theta_1^2 = 4\\left(\\frac{1}{50}\\right)^2\\left(\\frac{25}{16}\\right) + \\left(-\\frac{2}{25}\\right)^2 = 4\\left(\\frac{1}{2500}\\right)\\left(\\frac{25}{16}\\right) + \\frac{4}{625} = \\frac{100}{40000} + \\frac{4}{625} = \\frac{1}{400} + \\frac{4}{625}\n$$\nThe least common denominator of $400=16\\times25$ and $625=25\\times25$ is $16\\times625=10000$.\n$$\n\\frac{1}{400} + \\frac{4}{625} = \\frac{25}{10000} + \\frac{64}{10000} = \\frac{89}{10000}\n$$\nThe radical term is:\n$$\n\\alpha\\sqrt{4\\theta_2^2\\alpha^2 + \\theta_1^2} = \\frac{5}{4}\\sqrt{\\frac{89}{10000}} = \\frac{5}{4}\\frac{\\sqrt{89}}{100} = \\frac{\\sqrt{89}}{80}\n$$\nThe first term in the expression for $\\lambda_{1,2}$ is:\n$$\n\\frac{\\theta_3\\alpha^2}{3} = \\frac{(11/100)(25/16)}{3} = \\frac{11/(4\\times16)}{3} = \\frac{11}{64 \\times 3} = \\frac{11}{192}\n$$\nThe eigenvalues are:\n$$\n\\lambda_1 = \\frac{11}{192} + \\frac{\\sqrt{89}}{80}\n$$\n$$\n\\lambda_2 = \\frac{11}{192} - \\frac{\\sqrt{89}}{80}\n$$\n$$\n\\lambda_3 = -2\\left(\\frac{\\theta_3\\alpha^2}{3}\\right) = -2\\left(\\frac{11}{192}\\right) = -\\frac{22}{192} = -\\frac{11}{96}\n$$\nTo find the largest eigenvalue, we compare them.\n$\\lambda_1$ is positive.\nFor $\\lambda_2$, we compare $11/192$ and $\\sqrt{89}/80$. Since $9 < \\sqrt{89} < 10$, $\\sqrt{89}/80 \\approx 9.4/80 \\approx 0.1175$. And $11/192 \\approx 11/200 = 0.055$. Since $\\sqrt{89}/80 > 11/192$, $\\lambda_2$ is negative.\n$\\lambda_3 = -11/96 = -0.1145...$ is also negative.\nTherefore, the largest eigenvalue is $\\lambda_{\\max} = \\lambda_1$.\nTo write the final answer in the required form, we find a common denominator for $192 = 3 \\times 64$ and $80 = 5 \\times 16$. The least common multiple is $3 \\times 5 \\times 64 = 960$.\n$$\n\\lambda_{\\max} = \\frac{11}{192} + \\frac{\\sqrt{89}}{80} = \\frac{11 \\times 5}{192 \\times 5} + \\frac{\\sqrt{89} \\times 12}{80 \\times 12} = \\frac{55}{960} + \\frac{12\\sqrt{89}}{960} = \\frac{55 + 12\\sqrt{89}}{960}\n$$",
            "answer": "$$\\boxed{\\frac{55 + 12\\sqrt{89}}{960}}$$"
        },
        {
            "introduction": "A raw prediction from an ML model is not guaranteed to represent a physically possible turbulence state. This practice addresses the critical concept of \"realizability,\" which imposes strict mathematical constraints on the eigenvalues of the Reynolds stress tensor . You will implement an algorithm to diagnose violations of realizability and project an invalid prediction onto the nearest physically permissible state, a fundamental technique for building robust and reliable ML closures.",
            "id": "3974973",
            "problem": "Consider a fully developed turbulent plane channel flow within the context of Computational Fluid Dynamics (CFD), and suppose a Machine Learning (ML) model predicts the Reynolds stress anisotropy tensor $b_{ij}$ at several wall-normal locations, represented by the non-dimensional wall coordinate $y^+$. The Reynolds stress anisotropy is defined from the Reynolds stress tensor $R_{ij}$ and the turbulent kinetic energy $k$ by the normalization $r_{ij} = R_{ij}/(2k)$ and the anisotropy relation $b_{ij} = r_{ij} - \\frac{1}{3}\\delta_{ij}$. A physically realizable Reynolds stress tensor must be symmetric positive semi-definite and thus its normalization $r_{ij}$ must be symmetric positive semi-definite with unit trace. Equivalently, the eigenvalues of $r_{ij}$ must be nonnegative and sum to $1$, and the eigenvalues $\\lambda_i$ of $b_{ij}$ must satisfy $\\lambda_i + \\frac{1}{3} \\ge 0$ with $\\sum_i \\lambda_i = 0$. \n\nYour task is to implement a program that, for each provided ML-predicted $b_{ij}$ at a given $y^+$, performs the following steps:\n\n1. Compute the symmetric part of the predicted tensor, $b^{\\mathrm{sym}} = \\frac{1}{2}(b + b^\\top)$.\n2. Compute the eigen-decomposition of $b^{\\mathrm{sym}}$, yielding eigenvalues $\\lambda_i$ and an orthonormal eigenvector matrix $Q$.\n3. Convert the eigenvalues to the normalized stress eigenvalues $r_i = \\lambda_i + \\frac{1}{3}$.\n4. Test realizability by checking whether $r_i \\ge 0$ for all $i$ and $\\sum_i r_i = 1$ within a small numerical tolerance.\n5. If the test fails, enforce a minimal regularization by replacing $r_i$ with the nearest (in Euclidean norm) vector on the probability simplex $\\{ \\mathbf{x} \\in \\mathbb{R}^3 \\mid x_i \\ge 0, \\sum_i x_i = 1 \\}$, and then reconstruct a regularized anisotropy $b^{\\mathrm{reg}} = Q \\operatorname{diag}(r^{\\mathrm{proj}} - \\frac{1}{3}\\mathbf{1}) Q^\\top$.\n6. Report the magnitude of the minimal regularization as the Frobenius norm $\\|b^{\\mathrm{sym}} - b^{\\mathrm{reg}}\\|_F$ for each test case. This value must be a nonnegative real number and equals $0$ when the original prediction is realizable.\n\nUse the following test suite, which covers a typical case, boundary conditions, asymmetry and trace errors, and strong unrealizability. Each test case specifies $y^+$ (dimensionless) and the predicted anisotropy matrix $b_{ij}$:\n\n- Case $1$: \n$$\ny^+ = 15, \\quad \n\\mathbf{b}^{(1)} = \n\\begin{bmatrix}\n-0.10 & 0.02 & 0.00 \\\\\n0.02 & -0.08 & 0.01 \\\\\n0.00 & 0.01 & 0.18\n\\end{bmatrix}.\n$$\n\n- Case $2$ (asymmetry and trace error):\n$$\ny^+ = 5, \\quad\n\\mathbf{b}^{(2)} = \n\\begin{bmatrix}\n-0.20 & 0.07 & -0.03 \\\\\n0.02 & -0.15 & 0.06 \\\\\n0.04 & -0.01 & 0.31\n\\end{bmatrix}.\n$$\n\n- Case $3$ (strong unrealizability with an eigenvalue larger than $\\frac{2}{3}$):\n$$\ny^+ = 1, \\quad\n\\mathbf{b}^{(3)} = \n\\begin{bmatrix}\n0.80 & 0.00 & 0.00 \\\\\n0.00 & -0.20 & 0.00 \\\\\n0.00 & 0.00 & -0.60\n\\end{bmatrix}.\n$$\n\n- Case $4$ (unrealizability with a negative normalized stress eigenvalue):\n$$\ny^+ = 300, \\quad\n\\mathbf{b}^{(4)} = \n\\begin{bmatrix}\n-0.40 & 0.00 & 0.00 \\\\\n0.00 & 0.20 & 0.00 \\\\\n0.00 & 0.00 & 0.20\n\\end{bmatrix}.\n$$\n\n- Case $5$ (small trace error):\n$$\ny^+ = 30, \\quad\n\\mathbf{b}^{(5)} = \n\\begin{bmatrix}\n-0.05 & 0.00 & 0.00 \\\\\n0.00 & -0.02 & 0.00 \\\\\n0.00 & 0.00 & 0.09\n\\end{bmatrix}.\n$$\n\nAll computations are dimensionless; no physical units need to be reported. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The $i$-th entry must be the Frobenius norm $\\|b^{\\mathrm{sym}} - b^{\\mathrm{reg}}\\|_F$ for Case $i$, expressed as a floating-point number.",
            "solution": "The problem presented is scientifically well-posed and provides a clear, algorithmically defined task rooted in the fundamental principles of turbulence modeling for Computational Fluid Dynamics (CFD). It requires the validation and, if necessary, regularization of a machine-learning-predicted Reynolds stress anisotropy tensor, $\\mathbf{b}$, to ensure physical realizability. The procedure is based on the spectral properties of the tensor and projection onto a valid parameter space. The problem is valid and a solution will be provided.\n\nThe core physical constraint is that the Reynolds stress tensor, $R_{ij}$, must be symmetric and positive semi-definite. This property translates to its normalized form, $r_{ij} = R_{ij}/(2k)$, where $k$ is the turbulent kinetic energy. The tensor $r_{ij}$ must also be symmetric and positive semi-definite, and additionally, its trace must be unity, i.e., $\\mathrm{tr}(\\mathbf{r})=1$. The eigenvalues of a positive semi-definite matrix are non-negative. Therefore, the eigenvalues of $\\mathbf{r}$, which we denote as a vector $\\mathbf{r}_{\\lambda} = (r_1, r_2, r_3)$, must satisfy $r_i \\ge 0$ for all $i$ and $\\sum_i r_i = 1$. This means the vector of eigenvalues must lie on the standard 2-simplex, $\\Delta^2 = \\{ \\mathbf{x} \\in \\mathbb{R}^3 \\mid x_i \\ge 0, \\sum_i x_i = 1 \\}$.\n\nThe anisotropy tensor $\\mathbf{b}$ is defined as the deviatoric (traceless) part of $\\mathbf{r}$:\n$$\nb_{ij} = r_{ij} - \\frac{1}{3}\\delta_{ij}\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta. An eigen-decomposition of $\\mathbf{r}$ and $\\mathbf{b}$ shows that if the eigenvalues of $\\mathbf{b}$ are $\\lambda_i$, then the eigenvalues of $\\mathbf{r}$ are $r_i = \\lambda_i + \\frac{1}{3}$. The realizability conditions on $r_i$ thus impose constraints on the eigenvalues of $\\mathbf{b}$:\n1.  Positivity: $r_i = \\lambda_i + \\frac{1}{3} \\ge 0 \\implies \\lambda_i \\ge -\\frac{1}{3}$.\n2.  Unit Trace of $\\mathbf{r}$: $\\sum_i r_i = \\sum_i(\\lambda_i + \\frac{1}{3}) = (\\sum_i \\lambda_i) + 1 = 1$. This implies that the anisotropy tensor $\\mathbf{b}$ must be traceless: $\\mathrm{tr}(\\mathbf{b}) = \\sum_i \\lambda_i = 0$.\n\nFor each ML-predicted tensor $\\mathbf{b}^{\\mathrm{pred}}$, we follow the specified procedure:\n\n**Step 1: Symmetrization**\nAn ML model's prediction may not be perfectly symmetric. As the physical Reynolds stress tensor is symmetric, we first extract the symmetric part of the prediction:\n$$\n\\mathbf{b}^{\\mathrm{sym}} = \\frac{1}{2} (\\mathbf{b}^{\\mathrm{pred}} + (\\mathbf{b}^{\\mathrm{pred}})^\\top)\n$$\nThis ensures that the tensor has real eigenvalues and an orthonormal basis of eigenvectors.\n\n**Step 2: Eigen-decomposition**\nWe compute the eigenvalues $\\lambda_i$ and the corresponding orthonormal eigenvector matrix $Q$ of $\\mathbf{b}^{\\mathrm{sym}}$:\n$$\n\\mathbf{b}^{\\mathrm{sym}} = Q \\Lambda Q^\\top\n$$\nwhere $\\Lambda = \\mathrm{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$.\n\n**Step 3: Conversion to Normalized Stress Eigenvalues**\nThe eigenvalues of the corresponding normalized Reynolds stress tensor $\\mathbf{r}$ are calculated as:\n$$\nr_i = \\lambda_i + \\frac{1}{3}\n$$\nWe denote the vector of these eigenvalues as $\\mathbf{r}_{\\lambda} = (r_1, r_2, r_3)$.\n\n**Step 4: Realizability Test**\nWe check if the tensor is realizable by testing if the vector $\\mathbf{r}_{\\lambda}$ lies on the simplex $\\Delta^2$, within a small numerical tolerance $\\epsilon$:\n1.  Positivity: $r_i \\ge 0$ for all $i=1,2,3$.\n2.  Trace: $|\\sum_i r_i - 1| = |\\mathrm{tr}(\\mathbf{b}^{\\mathrm{sym}})| \\le \\epsilon$.\n\nIf both conditions are met, the predicted tensor is realizable, and the required regularization magnitude is $0$.\n\n**Step 5: Regularization via Simplex Projection**\nIf the realizability test fails, we find the closest point to $\\mathbf{r}_{\\lambda}$ on the simplex $\\Delta^2$. This is a Euclidean norm projection problem. The projected vector, $\\mathbf{r}_{\\lambda}^{\\mathrm{proj}}$, is computed using a standard efficient algorithm. Let $\\mathbf{y} = \\mathbf{r}_{\\lambda}$. First, sort $\\mathbf{y}$ in descending order to get $y_{(1)} \\ge y_{(2)} \\ge y_{(3)}$. Then find $\\rho = \\max \\{ j \\in \\{1, 2, 3\\} \\mid y_{(j)} - \\frac{1}{j}(\\sum_{k=1}^j y_{(k)} - 1) > 0 \\}$. The projection threshold $\\theta$ is then $\\theta = \\frac{1}{\\rho}(\\sum_{k=1}^\\rho y_{(k)} - 1)$. Finally, the components of the projected vector are $r_i^{\\mathrm{proj}} = \\max(r_i - \\theta, 0)$.\n\nA new, realizable anisotropy tensor $\\mathbf{b}^{\\mathrm{reg}}$ is implicitly defined by these new eigenvalues. Its eigenvalues are $\\lambda_i^{\\mathrm{reg}} = r_i^{\\mathrm{proj}} - \\frac{1}{3}$, and it is reconstructed using the original eigenvectors:\n$$\n\\mathbf{b}^{\\mathrm{reg}} = Q \\operatorname{diag}(\\mathbf{r}_{\\lambda}^{\\mathrm{proj}} - \\frac{1}{3}\\mathbf{1}) Q^\\top\n$$\n\n**Step 6: Report Regularization Magnitude**\nThe magnitude of the regularization is the Frobenius norm of the difference between the symmetric prediction and its realizable counterpart:\n$$\n\\|\\mathbf{b}^{\\mathrm{sym}} - \\mathbf{b}^{\\mathrm{reg}}\\|_F = \\| Q \\Lambda Q^\\top - Q \\Lambda^{\\mathrm{reg}} Q^\\top \\|_F\n$$\nDue to the unitary invariance of the Frobenius norm, this simplifies to:\n$$\n\\| \\Lambda - \\Lambda^{\\mathrm{reg}} \\|_F = \\sqrt{\\sum_{i=1}^3 (\\lambda_i - \\lambda_i^{\\mathrm{reg}})^2}\n$$\nSubstituting the definitions of the eigenvalues:\n$$\n\\lambda_i - \\lambda_i^{\\mathrm{reg}} = \\left(r_i - \\frac{1}{3}\\right) - \\left(r_i^{\\mathrm{proj}} - \\frac{1}{3}\\right) = r_i - r_i^{\\mathrm{proj}}\n$$\nThus, the regularization magnitude is simply the Euclidean distance between the original vector of stress eigenvalues and its projection onto the simplex:\n$$\n\\|\\mathbf{b}^{\\mathrm{sym}} - \\mathbf{b}^{\\mathrm{reg}}\\|_F = \\sqrt{\\sum_{i=1}^3 (r_i - r_i^{\\mathrm{proj}})^2} = \\| \\mathbf{r}_{\\lambda} - \\mathbf{r}_{\\lambda}^{\\mathrm{proj}} \\|_2\n$$\nThis simplified calculation is implemented for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef project_to_simplex(y):\n    \"\"\"\n    Projects a vector y onto the probability simplex.\n\n    This implementation uses the algorithm described in:\n    Duchi, J., Shalev-Shwartz, S., Singer, Y., & Chandra, T. (2008).\n    Efficient projections onto the L1-ball and simplex for learning.\n    \"\"\"\n    y = np.asarray(y)\n    d = len(y)\n    \n    # Sort y in descending order\n    y_sorted = np.sort(y)[::-1]\n    \n    # Cumulative sum of the sorted vector\n    y_cumsum = np.cumsum(y_sorted)\n    \n    # Find rho, the largest index j s.t. y_j - 1/j * (sum_{i=1 to j} y_i - 1) > 0\n    k_indices = np.arange(1, d + 1)\n    \n    # The condition array will be True for indices that satisfy the inequality\n    condition = y_sorted - (1 / k_indices) * (y_cumsum - 1) > 0\n    \n    if np.any(condition):\n        rho = np.max(k_indices[condition])\n    else:\n        # This case is unlikely with typical inputs but included for robustness\n        # It implies all elements of y are non-positive after initial adjustments\n        # and sum to less than 1.\n        # Projecting to the closest vertex (e.g., [1, 0, 0, ...]) based on max y\n        x = np.zeros_like(y)\n        x[np.argmax(y)] = 1.0\n        return x\n\n    # Calculate the threshold theta\n    theta = (y_cumsum[rho - 1] - 1) / rho\n    \n    # Apply the threshold to get the projection\n    x = np.maximum(y - theta, 0)\n    \n    return x\n\ndef calculate_regularization_norm(b_pred, tolerance=1e-9):\n    \"\"\"\n    Calculates the Frobenius norm of the minimal regularization for a predicted\n    anisotropy tensor b_pred to make it physically realizable.\n    \"\"\"\n    # Step 1: Compute the symmetric part of the predicted tensor\n    b_sym = 0.5 * (b_pred + b_pred.T)\n    \n    # Step 2: Compute the eigen-decomposition of b_sym\n    # np.linalg.eigh is used for symmetric matrices\n    lambdas, _ = np.linalg.eigh(b_sym)\n    \n    # Step 3: Convert eigenvalues to normalized stress eigenvalues\n    r_eigenvalues = lambdas + 1.0 / 3.0\n    \n    # Step 4: Test realizability\n    is_positive = np.all(r_eigenvalues >= -tolerance)\n    trace_is_one = np.isclose(np.sum(r_eigenvalues), 1.0, atol=tolerance)\n    \n    if is_positive and trace_is_one:\n        # The tensor is realizable, no regularization needed.\n        return 0.0\n    else:\n        # Step 5: Enforce minimal regularization by projection\n        r_projected = project_to_simplex(r_eigenvalues)\n        \n        # Step 6: Report the magnitude of the regularization\n        # This is the Euclidean norm between original and projected r eigenvalues\n        frobenius_norm = np.linalg.norm(r_eigenvalues - r_projected)\n        return frobenius_norm\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        np.array([\n            [-0.10, 0.02, 0.00],\n            [0.02, -0.08, 0.01],\n            [0.00, 0.01, 0.18]\n        ]),\n        # Case 2\n        np.array([\n            [-0.20, 0.07, -0.03],\n            [0.02, -0.15, 0.06],\n            [0.04, -0.01, 0.31]\n        ]),\n        # Case 3\n        np.array([\n            [0.80, 0.00, 0.00],\n            [0.00, -0.20, 0.00],\n            [0.00, 0.00, -0.60]\n        ]),\n        # Case 4\n        np.array([\n            [-0.40, 0.00, 0.00],\n            [0.00, 0.20, 0.00],\n            [0.00, 0.00, 0.20]\n        ]),\n        # Case 5\n        np.array([\n            [-0.05, 0.00, 0.00],\n            [0.00, -0.02, 0.00],\n            [0.00, 0.00, 0.09]\n        ])\n    ]\n\n    results = []\n    for b_matrix in test_cases:\n        norm = calculate_regularization_norm(b_matrix)\n        results.append(f\"{norm:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The fundamental goal of a turbulence closure is to provide a Reynolds stress tensor that satisfies the Reynolds-Averaged Navier-Stokes (RANS) equations for a given mean flow. This practice provides a direct and quantitative test of this closure by calculating the momentum equation residualsâ€”the imbalance that results when a model's prediction is substituted into the governing equations . Evaluating this residual is a cornerstone of *a posteriori* model validation, revealing how well a model respects the underlying physics of fluid motion.",
            "id": "3974989",
            "problem": "Consider a steady, two-dimensional, incompressible turbulent boundary layer over a flat plate in the streamwise coordinate $x$ and wall-normal coordinate $y$, with constant density $\\rho$ and dynamic viscosity $\\mu$. The mean velocity field is given by $\\overline{\\boldsymbol{u}}(x,y) = (\\overline{u}(y), \\overline{v}(y))$ with $\\overline{u}(y) = U_{\\infty}\\left(1 - \\exp(-\\beta y)\\right)$ and $\\overline{v}(y) = 0$. The mean pressure gradient is known and given by $\\partial_{x}\\overline{p} = 0$ and $\\partial_{y}\\overline{p} = 0$. A learned turbulence closure model provides a modeled Reynolds stress tensor $\\tau_{ij}^{(m)}(x,y)$ with only the shear component nonzero, $\\tau_{xy}^{(m)}(y) = -\\rho\\,C\\,U_{\\infty}^{2}\\exp(-\\beta y)$, and $\\tau_{xx}^{(m)}(x,y) = 0$, $\\tau_{yy}^{(m)}(x,y) = 0$. Here, $U_{\\infty}$, $\\beta$, and $C$ are positive constants. The domain is the rectangle $\\Omega = \\{(x,y): 0 \\le x \\le L,\\;0 \\le y \\le H\\}$.\n\nStarting from the Reynolds-Averaged Navier-Stokes (RANS) momentum equations for incompressible flow,\n$$\n\\rho\\left(\\overline{u}\\,\\partial_{x}\\overline{u} + \\overline{v}\\,\\partial_{y}\\overline{u}\\right) = -\\partial_{x}\\overline{p} + \\mu\\left(\\partial_{xx}\\overline{u} + \\partial_{yy}\\overline{u}\\right) - \\partial_{x}\\tau_{xx}^{(m)} - \\partial_{y}\\tau_{xy}^{(m)},\n$$\n$$\n\\rho\\left(\\overline{u}\\,\\partial_{x}\\overline{v} + \\overline{v}\\,\\partial_{y}\\overline{v}\\right) = -\\partial_{y}\\overline{p} + \\mu\\left(\\partial_{xx}\\overline{v} + \\partial_{yy}\\overline{v}\\right) - \\partial_{x}\\tau_{xy}^{(m)} - \\partial_{y}\\tau_{yy}^{(m)},\n$$\nassemble the residual vector of the RANS momentum balance,\n$$\n\\boldsymbol{R}(x,y) = \\left(R_{x}(x,y),\\,R_{y}(x,y)\\right),\n$$\ndefined by moving all terms to the left-hand side, that is,\n$$\nR_{x} = -\\partial_{x}\\overline{p} + \\mu\\left(\\partial_{xx}\\overline{u} + \\partial_{yy}\\overline{u}\\right) - \\partial_{x}\\tau_{xx}^{(m)} - \\partial_{y}\\tau_{xy}^{(m)} - \\rho\\left(\\overline{u}\\,\\partial_{x}\\overline{u} + \\overline{v}\\,\\partial_{y}\\overline{u}\\right),\n$$\n$$\nR_{y} = -\\partial_{y}\\overline{p} + \\mu\\left(\\partial_{xx}\\overline{v} + \\partial_{yy}\\overline{v}\\right) - \\partial_{x}\\tau_{xy}^{(m)} - \\partial_{y}\\tau_{yy}^{(m)} - \\rho\\left(\\overline{u}\\,\\partial_{x}\\overline{v} + \\overline{v}\\,\\partial_{y}\\overline{v}\\right).\n$$\nQuantify the residual imbalance by the area-normalized root-mean-square (RMS) norm over the domain $\\Omega$,\n$$\n\\|\\boldsymbol{R}\\|_{2} = \\left(\\frac{1}{|\\Omega|}\\int_{0}^{L}\\int_{0}^{H}\\left(R_{x}^{2}(x,y) + R_{y}^{2}(x,y)\\right)\\,\\mathrm{d}y\\,\\mathrm{d}x\\right)^{\\frac{1}{2}},\n$$\nwhere $|\\Omega| = L H$.\n\nUse the provided parameter values: $\\rho = 1.2 \\, \\mathrm{kg/m^3}$, $\\mu = 1.8 \\times 10^{-5} \\, \\mathrm{Pa \\cdot s}$, $U_{\\infty} = 50 \\, \\mathrm{m/s}$, $\\beta = 100 \\, \\mathrm{m^{-1}}$, $C = 0.002$, $L = 1.0 \\, \\mathrm{m}$, and $H = 0.05 \\, \\mathrm{m}$. Round your final answer to four significant figures and express the residual norm in $\\mathrm{N/m^3}$.",
            "solution": "The problem requires the calculation of the area-normalized root-mean-square (RMS) norm of the residual of the Reynolds-Averaged Navier-Stokes (RANS) momentum equations for a given set of flow fields and a modeled Reynolds stress tensor.\n\nThe given mean velocity field is $\\overline{\\boldsymbol{u}}(x,y) = (\\overline{u}(y), \\overline{v}(y))$, with components:\n$$\n\\overline{u}(y) = U_{\\infty}\\left(1 - \\exp(-\\beta y)\\right)\n$$\n$$\n\\overline{v}(y) = 0\n$$\nThe mean pressure gradients are given as zero:\n$$\n\\partial_{x}\\overline{p} = 0, \\quad \\partial_{y}\\overline{p} = 0\n$$\nThe modeled Reynolds stress tensor $\\tau_{ij}^{(m)}$ has only one non-zero component:\n$$\n\\tau_{xy}^{(m)}(y) = -\\rho\\,C\\,U_{\\infty}^{2}\\exp(-\\beta y)\n$$\nwith $\\tau_{xx}^{(m)} = 0$ and $\\tau_{yy}^{(m)} = 0$.\n\nThe residuals of the $x$- and $y$-momentum RANS equations are defined as:\n$$\nR_{x} = -\\partial_{x}\\overline{p} + \\mu\\left(\\partial_{xx}\\overline{u} + \\partial_{yy}\\overline{u}\\right) - \\partial_{x}\\tau_{xx}^{(m)} - \\partial_{y}\\tau_{xy}^{(m)} - \\rho\\left(\\overline{u}\\,\\partial_{x}\\overline{u} + \\overline{v}\\,\\partial_{y}\\overline{u}\\right)\n$$\n$$\nR_{y} = -\\partial_{y}\\overline{p} + \\mu\\left(\\partial_{xx}\\overline{v} + \\partial_{yy}\\overline{v}\\right) - \\partial_{x}\\tau_{xy}^{(m)} - \\partial_{y}\\tau_{yy}^{(m)} - \\rho\\left(\\overline{u}\\,\\partial_{x}\\overline{v} + \\overline{v}\\,\\partial_{y}\\overline{v}\\right)\n$$\nOur first step is to compute each term in these residual expressions.\n\nFor the $x$-momentum residual, $R_x$:\nThe convective terms are: Since $\\overline{u}$ depends only on $y$, $\\partial_{x}\\overline{u} = 0$. Also, $\\overline{v}=0$. Therefore, the convective acceleration is zero:\n$$\n\\rho\\left(\\overline{u}\\,\\partial_{x}\\overline{u} + \\overline{v}\\,\\partial_{y}\\overline{u}\\right) = \\rho\\left(\\overline{u}(y) \\cdot 0 + 0 \\cdot \\partial_{y}\\overline{u}(y)\\right) = 0\n$$\nThe pressure gradient term is given: $\\partial_{x}\\overline{p} = 0$.\nThe viscous terms are: Since $\\overline{u}$ depends only on $y$, $\\partial_{xx}\\overline{u} = 0$. We compute the second derivative with respect to $y$:\n$$\n\\partial_{y}\\overline{u} = \\frac{d}{dy}\\left[U_{\\infty}\\left(1 - \\exp(-\\beta y)\\right)\\right] = U_{\\infty}\\beta\\exp(-\\beta y)\n$$\n$$\n\\partial_{yy}\\overline{u} = \\frac{d}{dy}\\left[U_{\\infty}\\beta\\exp(-\\beta y)\\right] = -U_{\\infty}\\beta^2\\exp(-\\beta y)\n$$\nSo the viscous term is $\\mu\\left(\\partial_{xx}\\overline{u} + \\partial_{yy}\\overline{u}\\right) = -\\mu U_{\\infty}\\beta^2\\exp(-\\beta y)$.\nThe Reynolds stress terms are: $\\tau_{xx}^{(m)} = 0$, so $\\partial_{x}\\tau_{xx}^{(m)} = 0$. For $\\tau_{xy}^{(m)}(y)$, we compute the derivative with respect to $y$:\n$$\n\\partial_{y}\\tau_{xy}^{(m)} = \\frac{d}{dy}\\left[-\\rho\\,C\\,U_{\\infty}^{2}\\exp(-\\beta y)\\right] = \\rho\\,C\\,U_{\\infty}^{2}\\beta\\exp(-\\beta y)\n$$\nAssembling all non-zero terms for $R_x$:\n$$\nR_{x}(y) = 0 + \\left(-\\mu U_{\\infty}\\beta^2\\exp(-\\beta y)\\right) - 0 - \\left(\\rho\\,C\\,U_{\\infty}^{2}\\beta\\exp(-\\beta y)\\right) - 0\n$$\n$$\nR_{x}(y) = -U_{\\infty}\\beta\\exp(-\\beta y)\\left(\\mu\\beta + \\rho C U_{\\infty}\\right)\n$$\nNote that $R_x$ is a function of $y$ only.\n\nFor the $y$-momentum residual, $R_y$:\nThe convective terms are: Since $\\overline{v}=0$, all its derivatives are zero ($\\partial_x\\overline{v}=0, \\partial_y\\overline{v}=0, \\partial_{xx}\\overline{v}=0, \\partial_{yy}\\overline{v}=0$).\n$$\n\\rho\\left(\\overline{u}\\,\\partial_{x}\\overline{v} + \\overline{v}\\,\\partial_{y}\\overline{v}\\right) = 0\n$$\nThe pressure gradient term is given: $\\partial_{y}\\overline{p} = 0$.\nThe viscous terms are zero: $\\mu\\left(\\partial_{xx}\\overline{v} + \\partial_{yy}\\overline{v}\\right) = \\mu(0+0) = 0$.\nThe Reynolds stress terms are: $\\tau_{xy}^{(m)}$ depends only on $y$, so $\\partial_{x}\\tau_{xy}^{(m)} = 0$. And $\\tau_{yy}^{(m)}=0$, so $\\partial_{y}\\tau_{yy}^{(m)}=0$.\nTherefore, all terms in the $R_y$ expression are zero:\n$$\nR_{y}(x,y) = 0\n$$\n\nNow we compute the area-normalized RMS norm of the residual vector $\\boldsymbol{R} = (R_x, R_y)$:\n$$\n\\|\\boldsymbol{R}\\|_{2} = \\left(\\frac{1}{|\\Omega|}\\int_{0}^{L}\\int_{0}^{H}\\left(R_{x}^{2}(y) + R_{y}^{2}(y)\\right)\\,\\mathrm{d}y\\,\\mathrm{d}x\\right)^{\\frac{1}{2}}\n$$\nSince $R_y=0$ and $|\\Omega| = LH$, the expression simplifies to:\n$$\n\\|\\boldsymbol{R}\\|_{2} = \\left(\\frac{1}{LH}\\int_{0}^{L}\\int_{0}^{H} R_{x}^{2}(y)\\,\\mathrm{d}y\\,\\mathrm{d}x\\right)^{\\frac{1}{2}}\n$$\nSince $R_x(y)$ does not depend on $x$, the integral over $x$ from $0$ to $L$ is simply multiplication by $L$:\n$$\n\\|\\boldsymbol{R}\\|_{2} = \\left(\\frac{L}{LH}\\int_{0}^{H} R_{x}^{2}(y)\\,\\mathrm{d}y\\right)^{\\frac{1}{2}} = \\left(\\frac{1}{H}\\int_{0}^{H} R_{x}^{2}(y)\\,\\mathrm{d}y\\right)^{\\frac{1}{2}}\n$$\nLet's compute the integral of $R_x^2(y)$:\n$$\nR_{x}^{2}(y) = \\left[-U_{\\infty}\\beta\\exp(-\\beta y)\\left(\\mu\\beta + \\rho C U_{\\infty}\\right)\\right]^2 = U_{\\infty}^2\\beta^2\\left(\\mu\\beta + \\rho C U_{\\infty}\\right)^2 \\exp(-2\\beta y)\n$$\nThe term $A = U_{\\infty}^2\\beta^2\\left(\\mu\\beta + \\rho C U_{\\infty}\\right)^2$ is a constant.\n$$\n\\int_{0}^{H} R_{x}^{2}(y)\\,\\mathrm{d}y = A \\int_{0}^{H} \\exp(-2\\beta y)\\,\\mathrm{d}y = A \\left[\\frac{\\exp(-2\\beta y)}{-2\\beta}\\right]_{0}^{H} = A \\left(\\frac{\\exp(-2\\beta H) - \\exp(0)}{-2\\beta}\\right) = A \\frac{1 - \\exp(-2\\beta H)}{2\\beta}\n$$\nSubstituting this back into the expression for $\\|\\boldsymbol{R}\\|_{2}^2$:\n$$\n\\|\\boldsymbol{R}\\|_{2}^2 = \\frac{1}{H} \\left(U_{\\infty}^2\\beta^2\\left(\\mu\\beta + \\rho C U_{\\infty}\\right)^2 \\frac{1 - \\exp(-2\\beta H)}{2\\beta}\\right)\n$$\n$$\n\\|\\boldsymbol{R}\\|_{2}^2 = \\frac{U_{\\infty}^2\\beta\\left(\\mu\\beta + \\rho C U_{\\infty}\\right)^2}{2H} \\left(1 - \\exp(-2\\beta H)\\right)\n$$\nTaking the square root, and noting that all constants are positive:\n$$\n\\|\\boldsymbol{R}\\|_{2} = U_{\\infty}\\left(\\mu\\beta + \\rho C U_{\\infty}\\right) \\sqrt{\\frac{\\beta}{2H}\\left(1 - \\exp(-2\\beta H)\\right)}\n$$\nNow, we substitute the numerical values: $\\rho = 1.2\\,\\mathrm{kg/m^3}$, $\\mu = 1.8\\times 10^{-5}\\,\\mathrm{Pa \\cdot s}$, $U_{\\infty} = 50\\,\\mathrm{m/s}$, $\\beta = 100\\,\\mathrm{m^{-1}}$, $C = 0.002$, $H = 0.05\\,\\mathrm{m}$.\n\nFirst, we calculate the terms in the parentheses:\n$$\n\\mu\\beta = (1.8 \\times 10^{-5}) \\times 100 = 1.8 \\times 10^{-3}\n$$\n$$\n\\rho C U_{\\infty} = 1.2 \\times 0.002 \\times 50 = 0.12\n$$\n$$\n\\mu\\beta + \\rho C U_{\\infty} = 0.0018 + 0.12 = 0.1218\n$$\nNext, we calculate the term under the square root. The exponent is:\n$$\n-2\\beta H = -2 \\times 100 \\times 0.05 = -10\n$$\nThe term under the square root is:\n$$\n\\frac{\\beta}{2H}\\left(1 - \\exp(-2\\beta H)\\right) = \\frac{100}{2 \\times 0.05}\\left(1 - \\exp(-10)\\right) = 1000\\left(1 - \\exp(-10)\\right)\n$$\nNow, we combine all parts:\n$$\n\\|\\boldsymbol{R}\\|_{2} = 50 \\times 0.1218 \\times \\sqrt{1000\\left(1 - \\exp(-10)\\right)}\n$$\n$$\n\\|\\boldsymbol{R}\\|_{2} = 6.09 \\times \\sqrt{1000(1 - 4.53999 \\times 10^{-5})}\n$$\n$$\n\\|\\boldsymbol{R}\\|_{2} = 6.09 \\times \\sqrt{999.954600}\n$$\n$$\n\\|\\boldsymbol{R}\\|_{2} = 6.09 \\times 31.622058756\n$$\n$ \\|\\boldsymbol{R}\\|_{2} \\approx 192.5783378 \\,\\mathrm{N/m^3} $\nRounding to four significant figures, we get $192.6$.\nThe units were verified during the derivation. The RANS equations represent a force balance per unit volume, so the residual has units of $\\mathrm{N/m^3}$. The RMS norm retains these units.",
            "answer": "$$\n\\boxed{192.6}\n$$"
        }
    ]
}