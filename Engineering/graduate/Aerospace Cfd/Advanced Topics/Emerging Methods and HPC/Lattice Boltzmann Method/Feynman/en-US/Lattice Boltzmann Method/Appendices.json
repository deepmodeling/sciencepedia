{
    "hands_on_practices": [
        {
            "introduction": "This first exercise is designed to build your intuition for the core mechanics of the Lattice Boltzmann Method. By manually performing a single 'collide-and-stream' time step, you will directly engage with the evolution of the particle distribution functions. This practice specifically illuminates the fundamental property of mass and momentum conservation within the BGK collision operator, revealing how this principle governs the behavior of macroscopic fields under specific initial conditions .",
            "id": "3820128",
            "problem": "Consider a single-relaxation-time Bhatnagar–Gross–Krook (BGK) Lattice Boltzmann Method (LBM) on the standard two-dimensional nine-velocity lattice (D2Q9). The discrete velocities are\n$$\n\\mathbf{c}_0 = (0,0),\\quad\n\\mathbf{c}_1 = (1,0),\\quad\n\\mathbf{c}_2 = (0,1),\\quad\n\\mathbf{c}_3 = (-1,0),\\quad\n\\mathbf{c}_4 = (0,-1),\\quad\n\\mathbf{c}_5 = (1,1),\\quad\n\\mathbf{c}_6 = (-1,1),\\quad\n\\mathbf{c}_7 = (-1,-1),\\quad\n\\mathbf{c}_8 = (1,-1),\n$$\nwith weights\n$$\nw_0 = \\frac{4}{9},\\quad w_1=w_2=w_3=w_4=\\frac{1}{9},\\quad w_5=w_6=w_7=w_8=\\frac{1}{36}.\n$$\nAssume lattice units with $\\,\\Delta x = \\Delta t = 1\\,$, so the lattice speed is $\\,c=1\\,$ and the isothermal speed of sound satisfies $\\,c_s^2 = \\frac{1}{3}\\,$. The discrete Boltzmann equation with the BGK collision operator is\n$$\nf_i(\\mathbf{x}+\\mathbf{c}_i\\Delta t, t+\\Delta t) - f_i(\\mathbf{x},t) = -\\frac{\\Delta t}{\\tau}\\left[f_i(\\mathbf{x},t) - f_i^{\\mathrm{eq}}(\\rho,\\mathbf{u})\\right],\n$$\nwhere $\\,\\tau\\,$ is the relaxation time and $\\,f_i^{\\mathrm{eq}}(\\rho,\\mathbf{u})\\,$ is the second-order equilibrium distribution given by\n$$\nf_i^{\\mathrm{eq}}(\\rho,\\mathbf{u}) = w_i\\,\\rho\\left[1 + \\frac{\\mathbf{c}_i\\cdot\\mathbf{u}}{c_s^2} + \\frac{(\\mathbf{c}_i\\cdot\\mathbf{u})^2}{2\\,c_s^4} - \\frac{\\mathbf{u}\\cdot\\mathbf{u}}{2\\,c_s^2}\\right].\n$$\nThe macroscopic density and velocity are defined by the zeroth and first moments,\n$$\n\\rho(\\mathbf{x},t) = \\sum_{i=0}^{8} f_i(\\mathbf{x},t),\\qquad \\rho(\\mathbf{x},t)\\,\\mathbf{u}(\\mathbf{x},t) = \\sum_{i=0}^{8} f_i(\\mathbf{x},t)\\,\\mathbf{c}_i.\n$$\nLet the relaxation time be $\\,\\tau = 1\\,$ so that $\\,\\omega := \\Delta t/\\tau = 1\\,$. Consider a spatially uniform initial condition across the lattice at time $\\,t_0\\,$, so the following distribution values apply at every lattice node:\n$$\n\\begin{aligned}\n&f_0(\\mathbf{x},t_0) = 0.4415778,\\quad f_1(\\mathbf{x},t_0) = 0.1490944,\\quad f_2(\\mathbf{x},t_0) = 0.0920111,\\\\\n&f_3(\\mathbf{x},t_0) = 0.0790944,\\quad f_4(\\mathbf{x},t_0) = 0.1306778,\\quad f_5(\\mathbf{x},t_0) = 0.0334528,\\\\\n&f_6(\\mathbf{x},t_0) = 0.0116528,\\quad f_7(\\mathbf{x},t_0) = 0.0241194,\\quad f_8(\\mathbf{x},t_0) = 0.0383194.\n\\end{aligned}\n$$\nPerform one full collide–stream time step to obtain $\\,f_i(\\mathbf{x},t_0+\\Delta t)\\,$ at a node. Then update the macroscopic fields $\\,\\rho(\\mathbf{x},t_0+\\Delta t)\\,$ and $\\,\\mathbf{u}(\\mathbf{x},t_0+\\Delta t)\\,$ at that node. Express the final answer as a row matrix containing $\\,\\rho,\\,u_x,\\,u_y\\,$ in lattice units, and round your entries to six significant figures.",
            "solution": "The objective is to determine the macroscopic density $\\rho$ and velocity $\\mathbf{u} = (u_x, u_y)$ at a lattice node at time $t_0+\\Delta t$, after performing one full time step of the Lattice Boltzmann Method (LBM), starting from a given initial state at time $t_0$.\n\nThe LBM algorithm for a single time step consists of two sequential processes: collision and streaming. The evolution of the discrete distribution functions $f_i(\\mathbf{x},t)$ is described by the discrete Boltzmann equation with the BGK collision operator:\n$$ f_i(\\mathbf{x}+\\mathbf{c}_i\\Delta t, t+\\Delta t) = f_i(\\mathbf{x},t) - \\frac{\\Delta t}{\\tau}\\left[f_i(\\mathbf{x},t) - f_i^{\\mathrm{eq}}(\\rho,\\mathbf{u})\\right] $$\nThis equation can be conceptually split. First, a local collision step at each node $\\mathbf{x}$ calculates the post-collision state, denoted $f_i^*(\\mathbf{x}, t)$:\n$$ f_i^*(\\mathbf{x}, t) = f_i(\\mathbf{x},t) - \\frac{\\Delta t}{\\tau}\\left[f_i(\\mathbf{x},t) - f_i^{\\mathrm{eq}}(\\rho(\\mathbf{x},t),\\mathbf{u}(\\mathbf{x},t))\\right] $$\nSecond, a streaming (or propagation) step follows, where the post-collision populations move to adjacent nodes according to their discrete velocities:\n$$ f_i(\\mathbf{x}+\\mathbf{c}_i\\Delta t, t+\\Delta t) = f_i^*(\\mathbf{x}, t) $$\nTo find the populations $f_i$ at a node $\\mathbf{x}$ at the new time $t_0+\\Delta t$, we must gather the post-collision populations from the neighboring nodes at the previous time $t_0$. This can be expressed as:\n$$ f_i(\\mathbf{x}, t_0+\\Delta t) = f_i^*(\\mathbf{x}-\\mathbf{c}_i\\Delta t, t_0) $$\nThe problem states that the initial condition at time $t_0$ is spatially uniform. This means that the initial distribution functions $f_i(\\mathbf{x}, t_0)$ have the same values at every lattice node $\\mathbf{x}$. Let us denote these uniform initial values as $f_i(t_0)$.\n\nAs a direct consequence of this uniformity, the initial macroscopic fields, density $\\rho(t_0)$ and velocity $\\mathbf{u}(t_0)$, are also constant across the entire lattice. They are calculated from the moments of the initial distributions:\n$$ \\rho(t_0) = \\sum_{i=0}^{8} f_i(t_0) $$\n$$ \\rho(t_0)\\mathbf{u}(t_0) = \\sum_{i=0}^{8} f_i(t_0)\\mathbf{c}_i $$\nSince the collision step is purely local, and the inputs to it ($f_i(t_0)$, $\\rho(t_0)$, and $\\mathbf{u}(t_0)$) are uniform, the post-collision populations $f_i^*(t_0)$ must also be spatially uniform.\n\nWith $f_i^*(t_0)$ being uniform, the streaming step simplifies significantly. The value of $f_i^*(\\mathbf{x}-\\mathbf{c}_i\\Delta t, t_0)$ is the same regardless of the position $\\mathbf{x}-\\mathbf{c}_i\\Delta t$, and is equal to the constant value $f_i^*(t_0)$. Therefore, the populations at any node $\\mathbf{x}$ at the next time step are:\n$$ f_i(\\mathbf{x}, t_0+\\Delta t) = f_i^*(t_0) $$\nThe new macroscopic fields at time $t_0+\\Delta t$ are the moments of these new populations:\n$$ \\rho(\\mathbf{x}, t_0+\\Delta t) = \\sum_{i=0}^{8} f_i(\\mathbf{x}, t_0+\\Delta t) = \\sum_{i=0}^{8} f_i^*(t_0) $$\n$$ \\rho(\\mathbf{x}, t_0+\\Delta t)\\mathbf{u}(\\mathbf{x}, t_0+\\Delta t) = \\sum_{i=0}^{8} f_i(\\mathbf{x}, t_0+\\Delta t)\\mathbf{c}_i = \\sum_{i=0}^{8} f_i^*(t_0)\\mathbf{c}_i $$\nA fundamental property of the BGK collision operator is that it conserves mass and momentum locally. This means the zeroth and first moments of the post-collision distributions are identical to those of the pre-collision distributions:\n$$ \\sum_{i=0}^{8} f_i^*(t_0) = \\sum_{i=0}^{8} f_i(t_0) = \\rho(t_0) $$\n$$ \\sum_{i=0}^{8} f_i^*(t_0)\\mathbf{c}_i = \\sum_{i=0}^{8} f_i(t_0)\\mathbf{c}_i = \\rho(t_0)\\mathbf{u}(t_0) $$\nThis conservation property holds for any value of the relaxation time $\\tau$.\n\nCombining these facts, we find that the macroscopic fields at time $t_0+\\Delta t$ are identical to those at time $t_0$:\n$$ \\rho(t_0+\\Delta t) = \\rho(t_0) $$\n$$ \\rho(t_0+\\Delta t)\\mathbf{u}(t_0+\\Delta t) = \\rho(t_0)\\mathbf{u}(t_0) $$\nSince the density is non-zero, this implies $\\mathbf{u}(t_0+\\Delta t) = \\mathbf{u}(t_0)$.\nTherefore, for a spatially uniform system, the macroscopic fields are stationary. The problem reduces to calculating the macroscopic fields from the given initial distributions $f_i(t_0)$.\n\nThe initial distributions are:\n$f_0(t_0) = 0.4415778$, $f_1(t_0) = 0.1490944$, $f_2(t_0) = 0.0920111$, $f_3(t_0) = 0.0790944$, $f_4(t_0) = 0.1306778$, $f_5(t_0) = 0.0334528$, $f_6(t_0) = 0.0116528$, $f_7(t_0) = 0.0241194$, $f_8(t_0) = 0.0383194$.\n\nFirst, we calculate the initial density $\\rho(t_0)$:\n$$ \\rho(t_0) = \\sum_{i=0}^{8} f_i(t_0) = 0.4415778 + 0.1490944 + 0.0920111 + 0.0790944 + 0.1306778 + 0.0334528 + 0.0116528 + 0.0241194 + 0.0383194 $$\n$$ \\rho(t_0) = 0.9999999 $$\nNext, we calculate the initial momentum $\\rho(t_0)\\mathbf{u}(t_0) = (\\rho u_x, \\rho u_y)$:\nThe $x$-component of the momentum is:\n$$ \\rho u_x(t_0) = \\sum_{i=0}^{8} f_i(t_0)c_{ix} = f_1 - f_3 + f_5 - f_6 - f_7 + f_8 $$\n$$ \\rho u_x(t_0) = 0.1490944 - 0.0790944 + 0.0334528 - 0.0116528 - 0.0241194 + 0.0383194 $$\n$$ \\rho u_x(t_0) = 0.1060000 $$\nThe $y$-component of the momentum is:\n$$ \\rho u_y(t_0) = \\sum_{i=0}^{8} f_i(t_0)c_{iy} = f_2 - f_4 + f_5 + f_6 - f_7 - f_8 $$\n$$ \\rho u_y(t_0) = 0.0920111 - 0.1306778 + 0.0334528 + 0.0116528 - 0.0241194 - 0.0383194 $$\n$$ \\rho u_y(t_0) = -0.0559999 $$\nFrom these values, we determine the initial macroscopic fields. As $\\rho(t_0) = 0.9999999 \\approx 1.0$, we have:\n$$ u_x(t_0) = \\frac{0.1060000}{0.9999999} \\approx 0.1060000 $$\n$$ u_y(t_0) = \\frac{-0.0559999}{0.9999999} \\approx -0.0559999 $$\nAs established, these macroscopic values are unchanged after one time step. The problem requires the answer to be rounded to six significant figures.\n$\\rho(t_0+\\Delta t) = 0.9999999 \\approx 1.00000$\n$u_x(t_0+\\Delta t) = 0.1060000 \\approx 0.106000$\n$u_y(t_0+\\Delta t) = -0.0559999 \\approx -0.0560000$\n\nThe requested result is the row matrix containing $(\\rho, u_x, u_y)$ at time $t_0+\\Delta t$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.00000 & 0.106000 & -0.0560000 \\end{pmatrix} } $$"
        },
        {
            "introduction": "A key task in any simulation is to connect the model's parameters to the physical reality it aims to represent. In LBM, this means relating the microscopic relaxation time, $\\tau$, to the macroscopic kinematic viscosity, $\\nu$. This exercise guides you through the foundational Chapman-Enskog expansion, the theoretical bridge that allows us to recover the Navier-Stokes equations from the discrete Boltzmann equation and correctly parameterize our simulations .",
            "id": "3971752",
            "problem": "Consider the single-relaxation-time Bhatnagar–Gross–Krook (BGK) Lattice Boltzmann Method (LBM) applied to incompressible flow on the three-dimensional, nineteen-velocity discrete set $D3Q19$ used in aerospace Computational Fluid Dynamics (CFD). The discrete velocities are constructed so that streaming advances populations by one lattice spacing per time step along each discrete direction, and the second-order isotropy of the equilibrium ensures a lattice sound speed squared $c_{s}^{2}$ consistent with the $D3Q19$ quadrature. You are given a physical kinematic viscosity $ \\nu_{phys} $ (with units of $L^{2}/T$), a lattice spacing $ \\Delta x $ (with units of $L$), and a time step $ \\Delta t $ (with units of $T$). \n\nStarting from the kinetic transport equation with a BGK collision operator, the definition of macroscopic moments, and the Newtonian constitutive relation for viscous stress, perform a Chapman–Enskog expansion to recover the Navier–Stokes equations in the hydrodynamic limit for the $D3Q19$ lattice. From this derivation, obtain the analytic expression for the relaxation time $ \\tau $ required for the discrete model to reproduce the target physical viscosity $ \\nu_{phys} $ on the given lattice characterized by $ \\Delta x $ and $ \\Delta t $. Use the $D3Q19$ value $ c_{s}^{2} = 1/3 $. Present your final answer as a single closed-form expression for $ \\tau $.\n\nAdditionally, based on the same derivation, identify the leading numerical constraints on $ \\tau $, $ \\Delta x $, and $ \\Delta t $ that ensure the method remains dissipative and accurate in the low-Mach-number limit. Your commentary on constraints must be supported by the scaling that emerges from the hydrodynamic limit, but the final reported answer must remain the single expression for $ \\tau $. No numerical substitution is required. Express the final answer without units.",
            "solution": "The objective is to derive the relationship between the single relaxation time $\\tau$ of the Bhatnagar–Gross–Krook (BGK) model and the physical kinematic viscosity $\\nu_{phys}$ for a $D3Q19$ lattice. This is achieved by recovering the macroscopic Navier–Stokes equations from the discrete lattice Boltzmann equation via a Chapman–Enskog expansion.\n\nWe begin with the discrete lattice Boltzmann equation (LBE) with the BGK collision operator. For clarity, we will first perform the derivation in lattice units, where the lattice spacing $\\Delta x = 1$ and the time step $\\Delta t = 1$. The discrete particle velocities are then denoted by $\\mathbf{e}_i$, and the speed of light on the lattice is $c=1$. The LBE is:\n$$ f_i(\\mathbf{x} + \\mathbf{e}_i, t+1) - f_i(\\mathbf{x}, t) = -\\frac{1}{\\tau} [f_i(\\mathbf{x}, t) - f_i^{eq}(\\mathbf{x}, t)] $$\nwhere $f_i$ is the particle distribution function along the $i$-th direction, $\\mathbf{x}$ and $t$ are lattice coordinates and time, and $\\tau$ is the dimensionless relaxation time. The equilibrium distribution function, $f_i^{eq}$, for low-Mach-number flows is a second-order expansion in the macroscopic velocity $\\mathbf{u}$:\n$$ f_i^{eq} = w_i \\rho \\left( 1 + \\frac{\\mathbf{e}_i \\cdot \\mathbf{u}}{c_s^2} + \\frac{(\\mathbf{e}_i \\cdot \\mathbf{u})^2}{2c_s^4} - \\frac{\\mathbf{u}^2}{2c_s^2} \\right) $$\nHere, $w_i$ are the $D3Q19$ lattice weights, $\\rho$ is the macroscopic density, and $c_s$ is the lattice speed of sound, given as $c_s^2 = 1/3$. The macroscopic density and momentum are moments of the distribution functions:\n$$ \\rho = \\sum_i f_i = \\sum_i f_i^{eq} $$\n$$ \\rho \\mathbf{u} = \\sum_i f_i \\mathbf{e}_i = \\sum_i f_i^{eq} $$\nThe BGK collision operator conserves mass and momentum, which implies $\\sum_i (f_i - f_i^{eq}) = 0$ and $\\sum_i \\mathbf{e}_i (f_i - f_i^{eq}) = 0$.\n\nTo recover the macroscopic equations, we perform a Chapman–Enskog expansion. We introduce a small parameter $\\epsilon$ (proportional to the Knudsen and Mach numbers) and assume that the distribution function and the time and space derivatives can be expanded in multiple scales:\n- $f_i = f_i^{(0)} + \\epsilon f_i^{(1)} + \\epsilon^2 f_i^{(2)} + \\mathcal{O}(\\epsilon^3)$\n- $\\partial_t = \\epsilon \\partial_{t_1} + \\epsilon^2 \\partial_{t_2}$\n- $\\nabla = \\epsilon \\nabla_1$\n\nWe first Taylor-expand the discrete LBE in the time step (which is $1$ in lattice units):\n$$ (\\partial_t + \\mathbf{e}_i \\cdot \\nabla)f_i + \\frac{1}{2}(\\partial_t + \\mathbf{e}_i \\cdot \\nabla)^2 f_i + \\mathcal{O}(\\Delta t^3) = -\\frac{1}{\\tau}(f_i - f_i^{eq}) $$\nBy convention of the Chapman-Enskog procedure, we enforce that the macroscopic variables are fully captured by the equilibrium distribution, meaning $f_i^{(0)} = f_i^{eq}$ and the non-equilibrium parts have zero contribution to mass and momentum: $\\sum_i f_i^{(k)}=0$ and $\\sum_i \\mathbf{e}_i f_i^{(k)}=0$ for $k \\ge 1$.\n\nSubstituting the multi-scale expansions into the Taylor-expanded LBE and collecting terms by powers of $\\epsilon$:\n\nOrder $\\epsilon^1$:\n$$ (\\partial_{t_1} + \\mathbf{e}_i \\cdot \\nabla_1) f_i^{(0)} = -\\frac{1}{\\tau} f_i^{(1)} $$\nThis gives an expression for the first-order non-equilibrium distribution:\n$$ f_i^{(1)} = -\\tau (\\partial_{t_1} + e_{i\\alpha} \\partial_{1\\alpha}) f_i^{(0)} $$\n\nOrder $\\epsilon^2$:\n$$ \\partial_{t_2} f_i^{(0)} + (\\partial_{t_1} + \\mathbf{e}_i \\cdot \\nabla_1) f_i^{(1)} + \\frac{1}{2}(\\partial_{t_1} + \\mathbf{e}_i \\cdot \\nabla_1)^2 f_i^{(0)} = -\\frac{1}{\\tau} f_i^{(2)} $$\nSubstituting the expression for $f_i^{(1)}$ into the second term:\n$$ \\partial_{t_2} f_i^{(0)} - \\tau (\\partial_{t_1} + \\mathbf{e}_i \\cdot \\nabla_1)^2 f_i^{(0)} + \\frac{1}{2}(\\partial_{t_1} + \\mathbf{e}_i \\cdot \\nabla_1)^2 f_i^{(0)} = -\\frac{1}{\\tau} f_i^{(2)} $$\nThis simplifies to:\n$$ \\partial_{t_2} f_i^{(0)} - \\left(\\tau - \\frac{1}{2}\\right) (\\partial_{t_1} + e_{i\\alpha} \\partial_{1\\alpha})^2 f_i^{(0)} = -\\frac{1}{\\tau} f_i^{(2)} $$\nNow, we take moments of these scaled equations to find the macroscopic governing equations. Taking moments of the $\\mathcal{O}(\\epsilon^1)$ equation yields the compressible Euler equations (mass and momentum conservation at the first time scale). The momentum equation at this scale is:\n$$ \\partial_{t_1}(\\rho u_\\beta) + \\partial_{1\\alpha} \\Pi_{\\alpha\\beta}^{(0)} = 0 $$\nwhere $\\Pi_{\\alpha\\beta}^{(0)} = \\sum_i e_{i\\alpha}e_{i\\beta} f_i^{(0)} = \\rho u_\\alpha u_\\beta + p \\delta_{\\alpha\\beta}$ is the equilibrium momentum flux tensor, and pressure $p = \\rho c_s^2$.\n\nTo find the viscous term, we take the first moment (multiply by $e_{i\\beta}$ and sum over $i$) of the $\\mathcal{O}(\\epsilon^2)$ equation. The term $\\sum_i e_{i\\beta} f_i^{(2)}$ on the right-hand side is zero due to the conservation constraint.\n$$ \\sum_i e_{i\\beta} \\left[ \\partial_{t_2} f_i^{(0)} - \\left(\\tau - \\frac{1}{2}\\right) (\\partial_{t_1} + e_{i\\alpha} \\partial_{1\\alpha})^2 f_i^{(0)} \\right] = 0 $$\n$$ \\partial_{t_2}(\\rho u_\\beta) - \\left(\\tau - \\frac{1}{2}\\right) \\sum_i e_{i\\beta} (\\partial_{t_1} + e_{i\\alpha} \\partial_{1\\alpha})^2 f_i^{(0)} = 0 $$\nThe second term contains the viscous contribution. In the low-Mach-number limit, time derivatives are of higher order in Mach number than spatial derivatives, so we approximate $(\\partial_{t_1} + e_{i\\alpha} \\partial_{1\\alpha})^2 \\approx (e_{i\\alpha} \\partial_{1\\alpha})^2$. The term becomes:\n$$ \\partial_{1\\gamma} \\partial_{1\\delta} \\sum_i e_{i\\beta} e_{i\\gamma} e_{i\\delta} f_i^{(0)} $$\nThis is a derivative of the third-order moment of the equilibrium distribution. For low Mach numbers, $\\sum_i e_{i\\beta} e_{i\\gamma} e_{i\\delta} f_i^{(0)} \\approx \\rho c_s^2 (u_\\beta \\delta_{\\gamma\\delta} + u_\\gamma \\delta_{\\beta\\delta} + u_\\delta \\delta_{\\beta\\gamma})$.\nApplying the derivatives and assuming an incompressible fluid ($\\nabla \\cdot \\mathbf{u} = 0$), this term evaluates to $\\rho c_s^2 \\nabla_1^2 u_\\beta$. The momentum equation at the $\\mathcal{O}(\\epsilon^2)$ scale is then:\n$$ \\partial_{t_2}(\\rho u_\\beta) = \\left(\\tau - \\frac{1}{2}\\right) \\rho c_s^2 \\nabla_1^2 u_\\beta $$\nCombining the momentum equations from scales $\\epsilon^1$ and $\\epsilon^2$ and reverting to physical-scale derivatives ($\\partial_t, \\nabla$):\n$$ \\partial_t(\\rho u_\\beta) + \\partial_\\alpha(\\rho u_\\alpha u_\\beta) = -\\partial_\\beta p + \\rho c_s^2 \\left(\\tau - \\frac{1}{2}\\right) \\nabla^2 u_\\beta $$\nThis is the incompressible Navier–Stokes equation:\n$$ \\rho(\\partial_t u_\\beta + u_\\alpha \\partial_\\alpha u_\\beta) = -\\partial_\\beta p + \\mu \\nabla^2 u_\\beta $$\nwhere $\\mu$ is the dynamic viscosity. Dividing by $\\rho$ gives the equation in terms of kinematic viscosity $\\nu = \\mu/\\rho$:\n$$ \\partial_t u_\\beta + u_\\alpha \\partial_\\alpha u_\\beta = -\\frac{1}{\\rho}\\partial_\\beta p + \\nu \\nabla^2 u_\\beta $$\nBy comparing the viscous terms, we identify the kinematic viscosity in lattice units:\n$$ \\nu_{latt} = c_s^2 \\left(\\tau - \\frac{1}{2}\\right) $$\nThis expression relates the dimensionless parameters of the lattice simulation. To find the physical viscosity $\\nu_{phys}$, we must introduce the physical lattice spacing $\\Delta x$ and time step $\\Delta t$. Kinematic viscosity has units of $[L^2/T]$. The conversion factor from lattice units to physical units is:\n$$ \\nu_{phys} = \\nu_{latt} \\frac{\\Delta x^2}{\\Delta t} $$\nSubstituting the expression for $\\nu_{latt}$ and the given value $c_s^2 = 1/3$:\n$$ \\nu_{phys} = \\frac{1}{3} \\left(\\tau - \\frac{1}{2}\\right) \\frac{\\Delta x^2}{\\Delta t} $$\nSolving this equation for the relaxation time $\\tau$ yields the desired expression:\n$$ 3 \\frac{\\nu_{phys} \\Delta t}{\\Delta x^2} = \\tau - \\frac{1}{2} $$\n$$ \\tau = 3 \\frac{\\nu_{phys} \\Delta t}{\\Delta x^2} + \\frac{1}{2} $$\n\nBased on this derivation, we can identify two critical constraints.\nFirst, for the method to be physically dissipative and numerically stable, the lattice viscosity must be positive, $\\nu_{latt} > 0$. Since $c_s^2 > 0$, this implies a fundamental constraint on the relaxation time:\n$$ \\tau > \\frac{1}{2} $$\nSecond, the Chapman-Enskog expansion is valid only in the hydrodynamic limit, where the mean free path is much smaller than characteristic flow lengths. In LBM, the mean free path is proportional to $\\nu_{latt} \\propto (\\tau - 1/2)$. A large value of $\\tau$ implies a departure from this limit, leading to inaccuracies. Therefore, $\\tau$ must be kept on the order of unity, e.g., $\\tau  2$. This imposes a constraint on the choice of grid parameters:\n$$ \\frac{\\nu_{phys} \\Delta t}{\\Delta x^2} = \\frac{1}{3}\\left(\\tau - \\frac{1}{2}\\right) = \\mathcal{O}(1) $$\nThis is the diffusive scaling of LBM, which requires that as the grid is refined ($\\Delta x \\to 0$), the time step must be decreased quadratically ($\\Delta t \\propto \\Delta x^2$) to maintain a constant $\\tau$. This must be balanced with the advective scaling constraint, $\\Delta t \\propto \\Delta x$, required to keep the Mach number low and control compressibility errors.",
            "answer": "$$\\boxed{3 \\frac{\\nu_{phys} \\Delta t}{\\Delta x^2} + \\frac{1}{2}}$$"
        },
        {
            "introduction": "While the LBM operates naturally on Cartesian grids, real-world engineering problems often involve complex, curved boundaries. This exercise tackles the practical issue of implementing a no-slip wall condition for a curved surface using the simple, yet common, bounce-back rule. By analyzing the resulting flow, you will learn to quantify the numerical error introduced by this geometric approximation, developing a critical skill in evaluating the accuracy of simulation results .",
            "id": "3820150",
            "problem": "In the lattice Boltzmann method (LBM), specifically the single-relaxation-time Bhatnagar–Gross–Krook (BGK) formulation on a uniform Cartesian grid with spacing $\\Delta x$, a common wall treatment is the simple on-site bounce-back rule, which enforces a no-slip boundary condition by reflecting populations at the first layer of solid nodes. For straight walls aligned with the grid, this rule enforces the no-slip condition at an effective boundary located midway between the last fluid node and the first solid node along lattice links. For curved walls represented by a stair-stepped approximation on the grid, this mid-link placement leads to a geometric offset between the true wall and the effective hydrodynamic wall.\n\nConsider steady, incompressible, creeping circular Couette flow in two dimensions between two concentric cylinders of radii $R_i$ and $R_o$ with $R_i  R_o$, where the inner cylinder rotates at angular velocity $\\Omega$ and the outer cylinder is stationary. Assume the curved inner boundary is approximated on the Cartesian grid by a stair-stepped contour and that the hydrodynamic no-slip location enforced by bounce-back is displaced outward, along the local wall normal, by a distance $\\delta_n$ relative to the true inner wall. Treat the leading-order displacement as $\\delta_n = \\Delta x/2$, consistent with the mid-link location, and assume $R_i \\gg \\Delta x$ so that local curvature over a grid cell is small and a first-order Taylor expansion is valid.\n\nUsing only (i) the local first-order Taylor expansion of the tangential velocity in the wall-fixed frame and (ii) the steady Stokes-flow solution for circular Couette flow in an annulus, derive the leading-order slip velocity error at the true inner wall due to this geometric offset when simple bounce-back is used. Define the slip velocity error as the tangential fluid velocity at the true wall in the frame moving with the inner wall (so that perfect no-slip would give zero).\n\nExpress your final result as a single closed-form analytic expression in terms of $\\Delta x$, $R_i$, $R_o$, and $\\Omega$. Do not insert numerical values. If the parameters are given in International System of Units (SI), the slip velocity has the units of velocity (e.g., meters per second), but do not include units in your final boxed expression. Do not round; provide the exact symbolic expression.",
            "solution": "The objective is to find the leading-order slip velocity error at the true inner wall ($r=R_i$) due to the geometric offset of the simple bounce-back boundary condition.\n\nLet $u_{\\theta}(r)$ be the tangential fluid velocity in the lab frame. The inner cylinder at radius $R_i$ rotates with angular velocity $\\Omega$, so its surface velocity is $R_i \\Omega$. The outer cylinder at $R_o$ is stationary.\n\nThe slip velocity error, $u_{slip}$, is defined as the fluid velocity at the true wall radius $r=R_i$ relative to the wall's own velocity:\n$$u_{slip} = u_{\\theta}(R_i) - R_i \\Omega$$\nA perfect no-slip condition would yield $u_{slip}=0$.\n\nThe simple on-site bounce-back rule enforces the no-slip condition not at the true wall location $R_i$, but at an effective hydrodynamic boundary located approximately at $R_{eff} = R_i + \\delta_n$, where $\\delta_n = \\Delta x/2$. At this effective boundary, the LBM simulation enforces the velocity of the true wall. So, the boundary condition imposed by the simulation is:\n$$u_{\\theta}(R_{eff}) = R_i \\Omega$$\n\nTo find the velocity at the true wall, $u_{\\theta}(R_i)$, we perform a first-order Taylor expansion of the velocity profile around the effective boundary location $R_{eff}$:\n$$u_{\\theta}(R_i) \\approx u_{\\theta}(R_{eff}) + (R_i - R_{eff}) \\left. \\frac{d u_{\\theta}}{dr} \\right|_{r=R_{eff}}$$\nSubstituting $R_i - R_{eff} = -\\delta_n = -\\Delta x/2$ and $u_{\\theta}(R_{eff}) = R_i \\Omega$:\n$$u_{\\theta}(R_i) \\approx R_i \\Omega - \\delta_n \\left. \\frac{d u_{\\theta}}{dr} \\right|_{r=R_{eff}}$$\n\nNow we can calculate the slip velocity error:\n$$u_{slip} = u_{\\theta}(R_i) - R_i \\Omega \\approx \\left( R_i \\Omega - \\delta_n \\left. \\frac{d u_{\\theta}}{dr} \\right|_{r=R_{eff}} \\right) - R_i \\Omega = -\\delta_n \\left. \\frac{d u_{\\theta}}{dr} \\right|_{r=R_{eff}}$$\nFor a leading-order analysis where $\\delta_n$ is small, we can approximate the gradient at $R_{eff}$ with the gradient at $R_i$:\n$$u_{slip} \\approx -\\delta_n \\left. \\frac{d u_{\\theta}}{dr} \\right|_{r=R_i}$$\n\nThe next step is to find the analytical solution for the velocity profile, $u_{\\theta}(r)$, for steady, incompressible, creeping circular Couette flow. The governing equation is the Stokes equation for this geometry, which simplifies to $\\nabla^2 u_{\\theta} - u_{\\theta}/r^2 = 0$. The general solution is of the form:\n$$u_{\\theta}(r) = Ar + \\frac{B}{r}$$\nWe determine the constants $A$ and $B$ using the physical boundary conditions:\n1.  At the inner wall ($r=R_i$): $u_{\\theta}(R_i) = R_i \\Omega \\implies A R_i + \\frac{B}{R_i} = R_i \\Omega$\n2.  At the outer wall ($r=R_o$): $u_{\\theta}(R_o) = 0 \\implies A R_o + \\frac{B}{R_o} = 0 \\implies B = -A R_o^2$\n\nSubstitute the expression for $B$ into the first condition:\n$$A R_i - \\frac{A R_o^2}{R_i} = R_i \\Omega \\implies A(R_i^2 - R_o^2) = R_i^2 \\Omega$$\nSolving for $A$:\n$$A = \\frac{\\Omega R_i^2}{R_i^2 - R_o^2} = -\\Omega \\frac{R_i^2}{R_o^2 - R_i^2}$$\n\nNow we need the velocity gradient, $\\frac{d u_{\\theta}}{dr}$:\n$$\\frac{d u_{\\theta}}{dr} = A - \\frac{B}{r^2} = A - \\frac{-A R_o^2}{r^2} = A \\left( 1 + \\frac{R_o^2}{r^2} \\right)$$\nEvaluate the gradient at the inner wall, $r=R_i$:\n$$\\left. \\frac{d u_{\\theta}}{dr} \\right|_{r=R_i} = A \\left( 1 + \\frac{R_o^2}{R_i^2} \\right) = A \\frac{R_i^2 + R_o^2}{R_i^2}$$\nSubstituting the expression for $A$:\n$$\\left. \\frac{d u_{\\theta}}{dr} \\right|_{r=R_i} = \\left(\\frac{\\Omega R_i^2}{R_i^2 - R_o^2}\\right) \\frac{R_i^2 + R_o^2}{R_i^2} = \\Omega \\frac{R_i^2 + R_o^2}{R_i^2 - R_o^2}$$\n\nFinally, substitute this gradient into the expression for the slip velocity error:\n$$u_{slip} \\approx -\\delta_n \\left( \\Omega \\frac{R_i^2 + R_o^2}{R_i^2 - R_o^2} \\right) = \\delta_n \\Omega \\frac{R_i^2 + R_o^2}{R_o^2 - R_i^2}$$\nWith the given displacement $\\delta_n = \\Delta x/2$, we get the final result:\n$$u_{slip} = \\frac{\\Delta x}{2} \\Omega \\frac{R_o^2 + R_i^2}{R_o^2 - R_i^2}$$",
            "answer": "$$\\boxed{\\frac{\\Delta x}{2} \\Omega \\frac{R_o^{2} + R_i^{2}}{R_o^{2} - R_i^{2}}}$$"
        }
    ]
}