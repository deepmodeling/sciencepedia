{
    "hands_on_practices": [
        {
            "introduction": "This exercise grounds our study in the foundational principles of aeroacoustics by tackling the famous Lighthill's eighth-power law. By applying dimensional analysis to the quadrupole source term in the Lighthill Acoustic Analogy, you will derive the scaling relationship between a turbulent jet's speed and its radiated acoustic power. This practice is essential for understanding the physical origin of jet noise and highlights the predictive power of acoustic analogies in capturing complex fluid-dynamic phenomena. ",
            "id": "3940990",
            "problem": "Consider a high Reynolds number, subsonic turbulent jet in a quiescent medium of ambient density $\\rho_{0}$ and sound speed $c_{0}$. The jet has a characteristic mean flow speed $U$ and an energy-containing length scale $L$. Assume the compact-source limit for the energy-containing turbulence, in the sense that the acoustic wavelength associated with the dominant source frequencies is large compared with $L$, with a Strouhal number $\\mathrm{St} \\equiv \\omega L/U$ of order unity. Using the Lighthill Acoustic Analogy (LAA), model the dominant acoustic source as the quadrupole arising from the divergence of the Reynolds stress, represented by the source term $\\partial_{ij}(\\rho u_{i} u_{j})$ in the inhomogeneous acoustic wave equation. By dimensional analysis grounded in this framework, derive the far-field scaling of the total radiated acoustic power $W$ in terms of $\\rho_{0}$, $c_{0}$, $U$, and $L$, and then express your final result explicitly in terms of Mach number $M \\equiv U/c_{0}$. You may neglect dimensionless constants of order unity and assume statistical isotropy of the turbulence. Report the power scaling in Watts (SI units). The final answer must be a single closed-form analytic expression in $\\rho_{0}$, $c_{0}$, $L$, and $M$; do not provide intermediate equations as the final answer.",
            "solution": "The problem requires the derivation of the scaling law for the total radiated acoustic power, $W$, from a high Reynolds number, subsonic turbulent jet. The derivation will be based on a dimensional analysis of the Lighthill Acoustic Analogy (LAA).\n\nThe Lighthill Acoustic Analogy recasts the exact Navier-Stokes equations into an inhomogeneous wave equation for the acoustic pressure perturbation, $p' = p - p_0$. In an unbounded quiescent medium, this equation is:\n$$\n\\frac{1}{c_0^2}\\frac{\\partial^2 p'}{\\partial t^2} - \\nabla^2 p' = \\frac{\\partial^2 T_{ij}}{\\partial x_i \\partial x_j}\n$$\nwhere $c_0$ is the ambient speed of sound, and $T_{ij}$ is the Lighthill stress tensor. For a high Reynolds number flow with no external body forces or heat sources, this tensor is well approximated by the Reynolds stress term, $T_{ij} \\approx \\rho u_i u_j$. The problem statement directs us to model the dominant source using this term, specifically $\\partial_{ij}(\\rho u_i u_j)$. For a subsonic jet, density fluctuations within the turbulent flow are small compared to the ambient density $\\rho_0$, so we can further approximate $T_{ij} \\approx \\rho_0 u_i u_j$. The source term on the right-hand side is thus a quadrupole source.\n\nThe solution to the inhomogeneous wave equation in the far field (where the distance to the observer, $r = |\\mathbf{x}|$, is much larger than the source dimension $L$) can be found using a Green's function approach. For a compact source, which is assumed in the problem statement (acoustic wavelength $\\lambda \\gg L$), the far-field pressure perturbation is given by:\n$$\np'(\\mathbf{x}, t) \\approx \\frac{1}{4\\pi c_0^2 r} \\frac{x_i x_j}{r^2} \\frac{\\partial^2}{\\partial t^2} \\int_V T_{ij}(\\mathbf{y}, t - r/c_0) dV(\\mathbf{y})\n$$\nwhere the integral is over the source volume $V$.\n\nWe now perform a dimensional analysis to determine the scaling of $p'$.\nThe characteristic velocity fluctuations in the turbulent jet scale with the mean flow speed, $U$. Therefore, the Lighthill stress tensor scales as:\n$$\nT_{ij} \\sim \\rho_0 U^2\n$$\nThe source volume, characterized by the energy-containing length scale $L$, scales as $V \\sim L^3$. The integral of the stress tensor over this volume thus scales as:\n$$\n\\int_V T_{ij} dV \\sim (\\rho_0 U^2) L^3\n$$\nThe characteristic frequency of the energy-containing turbulent eddies, $\\omega$, is related to the velocity $U$ and length scale $L$. The problem states that the Strouhal number, $\\mathrm{St} \\equiv \\omega L/U$, is of order unity. This implies that the characteristic frequency scales as $\\omega \\sim U/L$. The second time derivative in the pressure expression, therefore, scales as:\n$$\n\\frac{\\partial^2}{\\partial t^2} \\sim \\omega^2 \\sim \\left(\\frac{U}{L}\\right)^2\n$$\nSubstituting these scalings into the expression for the far-field pressure perturbation $p'$ (and neglecting dimensionless constants like $4\\pi$ and geometric factors like $x_i x_j/r^2$, which are of order unity when averaged over all directions), we obtain:\n$$\np' \\sim \\frac{1}{c_0^2 r} \\left(\\frac{U}{L}\\right)^2 (\\rho_0 U^2 L^3) = \\frac{\\rho_0 U^4 L}{c_0^2 r}\n$$\nThe acoustic intensity, $I$, is the time-averaged acoustic energy flux per unit area. It is given by $I = \\frac{\\overline{p'^2}}{\\rho_0 c_0}$. The time average of the squared pressure perturbation, $\\overline{p'^2}$, scales as the square of the characteristic pressure perturbation amplitude, $(p')^2$:\n$$\nI \\sim \\frac{(p')^2}{\\rho_0 c_0} \\sim \\frac{1}{\\rho_0 c_0} \\left( \\frac{\\rho_0 U^4 L}{c_0^2 r} \\right)^2 = \\frac{\\rho_0^2 U^8 L^2}{\\rho_0 c_0 c_0^4 r^2} = \\frac{\\rho_0 U^8 L^2}{c_0^5 r^2}\n$$\nThe total radiated acoustic power, $W$, is found by integrating the intensity $I$ over the surface of a large sphere of radius $r$. The surface area of this sphere is $4\\pi r^2$. The integration accounts for the directional dependence of the radiation, but for scaling purposes, we can simply multiply the characteristic intensity by the surface area, which scales as $r^2$.\n$$\nW = \\int_{S} I dS \\sim I \\times r^2 \\sim \\left(\\frac{\\rho_0 U^8 L^2}{c_0^5 r^2}\\right) r^2 = \\frac{\\rho_0 U^8 L^2}{c_0^5}\n$$\nThis is the celebrated Lighthill's eighth-power law, which states that the acoustic power radiated by a turbulent jet scales with the eighth power of the jet velocity.\n\nThe final step is to express this scaling in terms of the jet Mach number, $M \\equiv U/c_0$. We substitute $U = M c_0$ into the expression for $W$:\n$$\nW \\sim \\frac{\\rho_0 (M c_0)^8 L^2}{c_0^5} = \\frac{\\rho_0 M^8 c_0^8 L^2}{c_0^5} = \\rho_0 c_0^3 L^2 M^8\n$$\nAs the problem requires us to neglect dimensionless constants of order unity, this scaling relation represents the final expression for the total radiated acoustic power. The units are consistent with power (Watts in the SI system), as can be verified by dimensional analysis: $[\\rho_0 c_0^3 L^2] = (\\frac{M_{mass}}{L_{len}^3}) (\\frac{L_{len}}{T_{time}})^3 (L_{len}^2) = \\frac{M_{mass} L_{len}^2}{T_{time}^3}$, which are the dimensions of power (Energy/Time).",
            "answer": "$$\\boxed{\\rho_{0} c_{0}^{3} L^{2} M^{8}}$$"
        },
        {
            "introduction": "Moving from physical theory to computational practice, we address the critical issue of numerical fidelity in simulating acoustic waves. This exercise guides you through an analysis of the dissipative and dispersive errors introduced by a common time-integration scheme, requiring you to calculate the minimum spatial resolution, or Points Per Wavelength ($N_{\\lambda}$), needed to maintain a specified level of accuracy. Mastering this concept is fundamental for designing and executing reliable Computational Aeroacoustics (CAA) simulations that you can trust. ",
            "id": "3940980",
            "problem": "Consider one-dimensional propagation of a narrowband plane acoustic wave in a uniform, inviscid, isentropic medium described by the linearized Euler equations. Let the wave have angular frequency $\\omega$ and wavenumber $k$, with sound speed $c$ so that $\\omega = c k$. Assume numerical simulation using a Fourier pseudospectral spatial discretization (so that spatial differentiation is exact for resolved wavenumbers) and classical fourth-order Runge–Kutta (RK4) time integration with a fixed Courant–Friedrichs–Lewy (CFL) number $\\lambda = c \\Delta t / \\Delta x = 0.5$. Define the Points Per Wavelength (PPW) by $N_{\\lambda} = \\lambda_{w}/\\Delta x$, where $\\lambda_{w} = 2\\pi/k$ is the physical wavelength.\n\nAssume the only source of amplitude error is time integration, and quantify the Sound Pressure Level (SPL) error solely by the amplitude ratio between the numerically propagated wave and the exact plane wave after a propagation distance of $50$ wavelengths. Require that the magnitude of the SPL error be less than $1$ decibel, i.e., the amplitude ratio $A$ after propagation satisfies $20 \\log_{10}(A)$ in absolute value less than $1$ decibel.\n\nUnder these assumptions, determine the minimum PPW, $N_{\\lambda,\\min}$, required to ensure the SPL error criterion is met over a distance of $50$ wavelengths. Express your final answer as a single real number. Round your answer to three significant figures.",
            "solution": "The problem requires determining the minimum Points Per Wavelength ($N_{\\lambda}$) for a numerical simulation of a one-dimensional acoustic wave to keep the Sound Pressure Level (SPL) error below a certain threshold. The simulation uses a Fourier pseudospectral method for spatial discretization and a classical fourth-order Runge–Kutta (RK4) scheme for time integration.\n\nThe propagation of a single plane wave component in a linearized, inviscid, isentropic medium is governed by the advection equation:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\nwhere $u$ is a perturbation quantity (like pressure or velocity), and $c$ is the speed of sound. A plane wave solution has the form $u(x,t) = \\hat{u} \\exp(i(kx - \\omega t))$, where $\\omega=ck$.\n\nThe problem states that the spatial discretization is a Fourier pseudospectral method, which is assumed to be exact for resolved wavenumbers. This means that for a single Fourier mode $\\exp(ikx)$, the spatial derivative operator is exactly represented. The semi-discretized equation for the time evolution of the Fourier coefficient $\\hat{u}(t)$ is:\n$$\n\\frac{d\\hat{u}}{dt} = -ick\\hat{u} = -i\\omega\\hat{u}\n$$\nThis is an ordinary differential equation of the form $\\frac{dy}{dt} = \\Lambda y$, with $y(t) = \\hat{u}(t)$ and $\\Lambda = -i\\omega$.\n\nThis ODE is solved numerically using the RK4 method. The numerical solution after one time step $\\Delta t$ is related to the solution at the previous step by an amplification factor $G$:\n$$\n\\hat{u}^{n+1} = G(\\Lambda \\Delta t) \\hat{u}^n\n$$\nThe amplification factor for the RK4 scheme is given by the first five terms of the Taylor series of the exponential function:\n$$\nG(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!}\n$$\nIn our case, the argument $z$ is $z = \\Lambda \\Delta t = -i\\omega \\Delta t$. Let's define $\\alpha = \\omega \\Delta t$. So, $z = -i\\alpha$.\n\nThe amplitude of the numerical wave is multiplied by the magnitude of the amplification factor, $|G(-i\\alpha)|$, at each time step. We need to express $\\alpha$ in terms of the specified parameters: the CFL number $\\lambda = c \\Delta t / \\Delta x$ and the Points Per Wavelength $N_{\\lambda} = \\lambda_w / \\Delta x$, where $\\lambda_w = 2\\pi/k$ is the wavelength.\n\nFrom the definitions, we can write:\n$\\omega = ck = c \\frac{2\\pi}{\\lambda_w}$\n$\\Delta t = \\frac{\\lambda \\Delta x}{c} = \\frac{\\lambda}{c} \\frac{\\lambda_w}{N_\\lambda}$\n\nTherefore, the non-dimensional frequency $\\alpha$ is:\n$$\n\\alpha = \\omega \\Delta t = \\left(c \\frac{2\\pi}{\\lambda_w}\\right) \\left(\\frac{\\lambda}{c} \\frac{\\lambda_w}{N_\\lambda}\\right) = \\frac{2\\pi\\lambda}{N_\\lambda}\n$$\nThe problem specifies $\\lambda = 0.5$, so $\\alpha = \\pi/N_\\lambda$.\n\nThe amplitude error is solely due to time integration, so we analyze the magnitude of $G(-i\\alpha)$.\n$$\nG(-i\\alpha) = 1 - i\\alpha - \\frac{\\alpha^2}{2} + i\\frac{\\alpha^3}{6} + \\frac{\\alpha^4}{24} = \\left(1 - \\frac{\\alpha^2}{2} + \\frac{\\alpha^4}{24}\\right) - i\\left(\\alpha - \\frac{\\alpha^3}{6}\\right)\n$$\nThe magnitude squared is:\n$$\n|G(-i\\alpha)|^2 = \\left(1 - \\frac{\\alpha^2}{2} + \\frac{\\alpha^4}{24}\\right)^2 + \\left(\\alpha - \\frac{\\alpha^3}{6}\\right)^2\n$$\nExpanding this and collecting terms up to $O(\\alpha^8)$:\n$$\n|G(-i\\alpha)|^2 = \\left(1 - \\alpha^2 + \\frac{\\alpha^4}{3} - \\frac{\\alpha^6}{24} + \\dots\\right) + \\left(\\alpha^2 - \\frac{\\alpha^4}{3} + \\frac{\\alpha^6}{36}\\right)\n= 1 - \\left(\\frac{1}{24} - \\frac{1}{36}\\right)\\alpha^6 + O(\\alpha^8) = 1 - \\frac{\\alpha^6}{72} + O(\\alpha^8)\n$$\nThe RK4 scheme is dissipative, as $|G(-i\\alpha)|  1$ for $\\alpha \\neq 0$. For small $\\alpha$, the magnitude is approximately:\n$$\n|G(-i\\alpha)| \\approx \\sqrt{1 - \\frac{\\alpha^6}{72}} \\approx 1 - \\frac{\\alpha^6}{144}\n$$\nThe wave propagates for a distance of $L = 50 \\lambda_w$. The total time of propagation is $T_{prop} = L/c = 50\\lambda_w/c$. The number of time steps, $N_{steps}$, is:\n$$\nN_{steps} = \\frac{T_{prop}}{\\Delta t} = \\frac{50\\lambda_w/c}{\\lambda \\Delta x / c} = \\frac{50\\lambda_w}{\\lambda (\\lambda_w / N_\\lambda)} = \\frac{50 N_\\lambda}{\\lambda}\n$$\nWith $\\lambda = 0.5$, we have $N_{steps} = 100 N_\\lambda$.\n\nThe total amplitude ratio $A$ after $N_{steps}$ is the amplification per step raised to the power of the number of steps:\n$$\nA = |G(-i\\alpha)|^{N_{steps}}\n$$\nThe SPL error requirement is $|20 \\log_{10}(A)|  1$. Since the scheme is dissipative, $A  1$ and $\\log_{10}(A)  0$. The constraint simplifies to:\n$$\n-1  20 \\log_{10}(A) \\implies -\\frac{1}{20}  \\log_{10}(A) \\implies A  10^{-1/20}\n$$\nWe can now form the inequality to find the minimum $N_\\lambda$:\n$$\n|G(-i\\alpha)|^{N_{steps}}  10^{-1/20}\n$$\nTaking the natural logarithm of both sides:\n$$\nN_{steps} \\ln(|G(-i\\alpha)|)  -\\frac{1}{20}\\ln(10)\n$$\nUsing the approximation $\\ln(|G|) \\approx \\ln(1 - \\frac{\\alpha^6}{144}) \\approx -\\frac{\\alpha^6}{144}$ for small $\\alpha$:\n$$\n(100 N_\\lambda) \\left(-\\frac{\\alpha^6}{144}\\right)  -\\frac{\\ln(10)}{20}\n$$\nMultiplying by $-1$ reverses the inequality:\n$$\n\\frac{100 N_\\lambda \\alpha^6}{144}  \\frac{\\ln(10)}{20}\n$$\nSubstitute $\\alpha = \\pi/N_\\lambda$:\n$$\n\\frac{100 N_\\lambda}{144} \\left(\\frac{\\pi}{N_\\lambda}\\right)^6  \\frac{\\ln(10)}{20} \\implies \\frac{100 \\pi^6}{144 N_\\lambda^5}  \\frac{\\ln(10)}{20}\n$$\nNow, we solve for $N_\\lambda$:\n$$\nN_\\lambda^5  \\frac{100 \\pi^6}{144} \\cdot \\frac{20}{\\ln(10)} = \\frac{2000 \\pi^6}{144 \\ln(10)} = \\frac{125 \\pi^6}{9 \\ln(10)}\n$$\n$$\nN_{\\lambda}  \\left(\\frac{125 \\pi^6}{9 \\ln(10)}\\right)^{1/5}\n$$\nWe compute the numerical value:\n$$\n\\pi \\approx 3.14159, \\quad \\ln(10) \\approx 2.30259\n$$\n$$\n\\pi^6 \\approx 961.389\n$$\n$$\nN_{\\lambda}  \\left(\\frac{125 \\times 961.389}{9 \\times 2.30259}\\right)^{1/5} \\approx \\left(\\frac{120173.6}{20.7233}\\right)^{1/5} \\approx (5799.3)^{1/5}\n$$\n$$\nN_{\\lambda}  5.65839...\n$$\nThe minimum required Points Per Wavelength must be greater than this value. Rounding to three significant figures, we get $N_{\\lambda, \\min} = 5.66$.",
            "answer": "$$\\boxed{5.66}$$"
        },
        {
            "introduction": "This final practice synthesizes our knowledge into a complete, end-to-end computational workflow, mirroring how far-field noise is predicted in industrial applications. You will implement an aeroacoustic post-processing pipeline based on the Ffowcs Williams–Hawkings (FW-H) analogy, tackling practical challenges such as filtering non-acoustic hydrodynamic fluctuations and correctly implementing the retarded-time transformation. This hands-on exercise provides invaluable experience in converting raw fluid simulation data into a meaningful acoustic prediction. ",
            "id": "3940991",
            "problem": "A Ffowcs Williams–Hawkings (FW-H) acoustic analogy post-processing pipeline is to be designed to compute far-field, one-sided power spectral densities from synthetic Large Eddy Simulation (LES) surface data that contains both acoustic and hydrodynamic contributions. The pipeline must include explicit filtering of hydrodynamic pressure using convective alignment and synchronization with retarded-time evaluation inherent to FW-H surface integrals. The computational task is to implement the following physically consistent steps, framed purely in mathematical terms, for each specified test case:\n\n1. Define a circular, permeable FW-H control surface of radius $a$ lying in the $x$-$y$ plane and centered at the origin. Discretize the surface as $N_s$ points uniformly distributed by angle, with point locations $\\mathbf{y}_i = \\left(a \\cos \\theta_i, a \\sin \\theta_i, 0\\right)$ and outward normals $\\mathbf{n}_i = \\left(\\cos \\theta_i, \\sin \\theta_i, 0\\right)$, where $\\theta_i = 2\\pi i/N_s$ for $i = 0,1,\\ldots,N_s-1$.\n\n2. Generate synthetic LES surface pressure signals $p_s(\\mathbf{y}_i,t)$ for each surface point. Let the acoustic plane-wave part propagate along the $+x$ direction at the speed of sound $c_0$, and let the hydrodynamic convective part propagate along $+x$ at the convection speed $U$ (with $U  c_0$ in general). Define the projection coordinate $s(\\mathbf{y}_i) = \\hat{\\mathbf{e}}_x \\cdot \\mathbf{y}_i = a \\cos \\theta_i$. The signal for each point is\n$$\np_s(\\mathbf{y}_i,t) = A_a \\cos\\left(2\\pi f_a \\left(t - \\frac{s(\\mathbf{y}_i)}{c_0}\\right)\\right) + A_h \\cos\\left(2\\pi f_h \\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right)\\right) + \\eta_i(t),\n$$\nwhere $A_a$ is the acoustic amplitude in Pascals, $f_a$ is the acoustic frequency in Hertz, $A_h$ is the hydrodynamic amplitude in Pascals, $f_h$ is the hydrodynamic frequency in Hertz, and $\\eta_i(t)$ is zero-mean additive stochastic noise with amplitude specified in Pascals. The sampling rate is $f_s$ in Hertz, and the duration is $T$ in seconds. The speed of sound is $c_0$ in meters per second.\n\n3. Construct a hydrodynamic pressure estimate by convective alignment across the surface and subtract it to filter the hydrodynamic content. Define the convectively aligned signals\n$$\nq_i(t) = p_s(\\mathbf{y}_i,\\, t + s(\\mathbf{y}_i)/U),\n$$\nand the surface-average aligned signal\n$$\n\\overline{q}(t) = \\frac{1}{N_s} \\sum_{i=0}^{N_s-1} q_i(t).\n$$\nThen define the hydrodynamic estimate at each point by de-aligning\n$$\n\\widehat{p}_h(\\mathbf{y}_i,t) = \\overline{q}\\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right),\n$$\nand construct the filtered pressure\n$$\np_f(\\mathbf{y}_i,t) = p_s(\\mathbf{y}_i,t) - \\widehat{p}_h(\\mathbf{y}_i,t).\n$$\nAll time shifts are to be evaluated by linear interpolation in time. This procedure aims to remove components convecting approximately at speed $U$ while retaining components traveling near $c_0$.\n\n4. Compute the FW-H far-field proxy pressure at a fixed observer location $\\mathbf{x}_o$ by retarded-time synchronization. For each surface point $\\mathbf{y}_i$, compute the acoustic retarded time\n$$\nt_r^{(i)}(t) = t - \\frac{R_i}{c_0}, \\quad R_i = \\|\\mathbf{x}_o - \\mathbf{y}_i\\|.\n$$\nApproximate the loading-only porous FW-H contribution by a discretized, dimensionless-weighted sum that preserves pressure units, using\n$$\np'(\\mathbf{x}_o,t) \\approx \\sum_{i=0}^{N_s-1} w_i \\, p_f\\left(\\mathbf{y}_i,\\, t_r^{(i)}(t)\\right),\n$$\nwith\n$$\nw_i = \\frac{R_{\\mathrm{ref}}}{4\\pi R_i N_s},\n$$\nwhere $R_{\\mathrm{ref}}$ is a fixed reference length set to $1\\,\\mathrm{m}$ to keep the summation dimensionless. The retarded-time synchronization is realized by linear interpolation of $p_f(\\mathbf{y}_i,t)$ at $t_r^{(i)}(t)$.\n\n5. Compute the one-sided power spectral density (PSD) $S_{p'p'}(f)$ of $p'(\\mathbf{x}_o,t)$ using a Hann window $w(t)$ and the Fast Fourier Transform (FFT). If $x[n]$ is the sampled signal, $w[n]$ is the window, $X[k]$ is the discrete Fourier transform of $w[n] x[n]$, $f_s$ is the sampling frequency, $N$ is the number of samples, and $U_w = \\frac{1}{N}\\sum_{n=0}^{N-1} w[n]^2$ is the window power, then the single-sided PSD is defined for frequencies $f_k = k f_s/N$ by\n$$\nS_{p'p'}(f_k) = \\begin{cases}\n\\frac{1}{f_s N U_w} |X[0]|^2,  k = 0 \\\\[6pt]\n\\frac{2}{f_s N U_w} |X[k]|^2,  1 \\le k \\le \\frac{N}{2}-1 \\\\[6pt]\n\\frac{1}{f_s N U_w} |X[N/2]|^2,  k = \\frac{N}{2} \\text{ when } N \\text{ even.}\n\\end{cases}\n$$\nReport $S_{p'p'}(f)$ at the acoustic frequency $f_a$ and at the hydrodynamic frequency $f_h$ by taking the FFT bin closest to each target.\n\nAll physical answers must be expressed in Pascals squared per Hertz ($\\mathrm{Pa}^2/\\mathrm{Hz}$). Angles are to be in radians. When you report numerical values, round each to six decimal digits.\n\nTest Suite:\n- Case 1 (general case):\n  - $N_s = 64$, $a = 0.5\\,\\mathrm{m}$, $\\mathbf{x}_o = (10.0,0.0,0.0)\\,\\mathrm{m}$,\n  - $f_a = 800\\,\\mathrm{Hz}$, $A_a = 1.0\\,\\mathrm{Pa}$,\n  - $f_h = 200\\,\\mathrm{Hz}$, $A_h = 2.0\\,\\mathrm{Pa}$,\n  - $U = 100.0\\,\\mathrm{m/s}$, $c_0 = 340.0\\,\\mathrm{m/s}$,\n  - noise amplitude $A_n = 0.05\\,\\mathrm{Pa}$,\n  - $f_s = 20000\\,\\mathrm{Hz}$, $T = 0.5\\,\\mathrm{s}$.\n\n- Case 2 (no hydrodynamic content):\n  - $N_s = 64$, $a = 0.5\\,\\mathrm{m}$, $\\mathbf{x}_o = (10.0,0.0,0.0)\\,\\mathrm{m}$,\n  - $f_a = 800\\,\\mathrm{Hz}$, $A_a = 1.0\\,\\mathrm{Pa}$,\n  - $f_h = 200\\,\\mathrm{Hz}$, $A_h = 0.0\\,\\mathrm{Pa}$,\n  - $U = 100.0\\,\\mathrm{m/s}$, $c_0 = 340.0\\,\\mathrm{m/s}$,\n  - noise amplitude $A_n = 0.05\\,\\mathrm{Pa}$,\n  - $f_s = 20000\\,\\mathrm{Hz}$, $T = 0.5\\,\\mathrm{s}$.\n\n- Case 3 (near-sonic convection):\n  - $N_s = 64$, $a = 0.5\\,\\mathrm{m}$, $\\mathbf{x}_o = (10.0,0.0,0.0)\\,\\mathrm{m}$,\n  - $f_a = 800\\,\\mathrm{Hz}$, $A_a = 1.0\\,\\mathrm{Pa}$,\n  - $f_h = 200\\,\\mathrm{Hz}$, $A_h = 2.0\\,\\mathrm{Pa}$,\n  - $U = 320.0\\,\\mathrm{m/s}$, $c_0 = 340.0\\,\\mathrm{m/s}$,\n  - noise amplitude $A_n = 0.05\\,\\mathrm{Pa}$,\n  - $f_s = 20000\\,\\mathrm{Hz}$, $T = 0.5\\,\\mathrm{s}$.\n\n- Case 4 (sparse surface sampling and smaller aperture):\n  - $N_s = 8$, $a = 0.1\\,\\mathrm{m}$, $\\mathbf{x}_o = (5.0,0.0,0.0)\\,\\mathrm{m}$,\n  - $f_a = 1200\\,\\mathrm{Hz}$, $A_a = 1.0\\,\\mathrm{Pa}$,\n  - $f_h = 300\\,\\mathrm{Hz}$, $A_h = 2.0\\,\\mathrm{Pa}$,\n  - $U = 150.0\\,\\mathrm{m/s}$, $c_0 = 340.0\\,\\mathrm{m/s}$,\n  - noise amplitude $A_n = 0.05\\,\\mathrm{Pa}$,\n  - $f_s = 20000\\,\\mathrm{Hz}$, $T = 0.5\\,\\mathrm{s}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, report two values in $\\mathrm{Pa}^2/\\mathrm{Hz}$ rounded to six decimals: first $S_{p'p'}(f_a)$, then $S_{p'p'}(f_h)$. The aggregate output should therefore contain eight numbers in total, in the order of Cases 1 through 4, for a total format\n$$\n[\\;S_{p'p'}(f_a)_{\\text{Case 1}},\\,S_{p'p'}(f_h)_{\\text{Case 1}},\\,S_{p'p'}(f_a)_{\\text{Case 2}},\\,S_{p'p'}(f_h)_{\\text{Case 2}},\\,S_{p'p'}(f_a)_{\\text{Case 3}},\\,S_{p'p'}(f_h)_{\\text{Case 3}},\\,S_{p'p'}(f_a)_{\\text{Case 4}},\\,S_{p'p'}(f_h)_{\\text{Case 4}}\\;].\n$$",
            "solution": "The problem requires the implementation of a computational pipeline for post-processing synthetic aeroacoustic data. This pipeline simulates the Ffowcs Williams–Hawkings (FW-H) method, including a crucial pre-processing step to filter out non-propagating hydrodynamic pressure fluctuations from the source data. The solution is structured by meticulously following the prescribed mathematical and algorithmic steps.\n\nFirst, we establish the computational domain and generate the source signals. A circular, permeable control surface of radius $a$ is defined in the $x$-$y$ plane, centered at the origin. This surface is discretized into $N_s$ points with locations given by $\\mathbf{y}_i = (a \\cos\\theta_i, a \\sin\\theta_i, 0)$ for $i = 0, 1, \\ldots, N_s-1$, where $\\theta_i = 2\\pi i/N_s$. The outward normal vector at each point is $\\mathbf{n}_i = (\\cos\\theta_i, \\sin\\theta_i, 0)$.\n\nFor each point $\\mathbf{y}_i$, a synthetic pressure signal $p_s(\\mathbf{y}_i,t)$ is generated over a duration $T$ with a sampling rate $f_s$. The number of time samples is $N = \\lfloor T f_s \\rfloor$. The signal is composed of an acoustic plane wave, a hydrodynamic convective disturbance, and additive stochastic noise. The acoustic wave propagates at the speed of sound $c_0$, while the hydrodynamic component convects at a different speed $U$. Both are defined to propagate in the $+x$ direction. The signal at each surface point $\\mathbf{y}_i$ is given by:\n$$\np_s(\\mathbf{y}_i,t) = A_a \\cos\\left(2\\pi f_a \\left(t - \\frac{s(\\mathbf{y}_i)}{c_0}\\right)\\right) + A_h \\cos\\left(2\\pi f_h \\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right)\\right) + \\eta_i(t)\n$$\nHere, $s(\\mathbf{y}_i) = \\hat{\\mathbf{e}}_x \\cdot \\mathbf{y}_i = a \\cos\\theta_i$ is the projection of the point's position onto the direction of propagation. $A_a$ and $f_a$ are the acoustic amplitude and frequency, $A_h$ and $f_h$ are the hydrodynamic amplitude and frequency, and $\\eta_i(t)$ is zero-mean stochastic noise with a specified amplitude $A_n$. For computational reproducibility, the noise is generated from a uniform distribution on $[-A_n, A_n]$ using a fixed random seed.\n\nThe second major step is to filter the hydrodynamic pressure component. This is achieved through a technique of convective alignment and subtraction. For each surface point $\\mathbf{y}_i$, the signal $p_s$ is time-shifted to align events that convect at speed $U$:\n$$\nq_i(t) = p_s\\left(\\mathbf{y}_i, t + \\frac{s(\\mathbf{y}_i)}{U}\\right)\n$$\nSubstituting the expression for $p_s$, the hydrodynamic part of $q_i(t)$ becomes $A_h \\cos(2\\pi f_h t)$, which is now synchronized across all surface points, independent of their position $s(\\mathbf{y}_i)$. The acoustic part, however, remains dependent on $s(\\mathbf{y}_i)$, as its phase is related to $c_0$. By averaging these aligned signals over the entire surface, the spatially incoherent acoustic and noise components are attenuated, while the coherent hydrodynamic component is preserved:\n$$\n\\overline{q}(t) = \\frac{1}{N_s} \\sum_{i=0}^{N_s-1} q_i(t) \\approx A_h \\cos(2\\pi f_h t)\n$$\nThis surface-averaged signal $\\overline{q}(t)$ serves as an estimate of the isolated hydrodynamic fluctuation at a reference location ($s=0$). This estimate is then time-shifted back to each point's original frame to construct the hydrodynamic pressure field estimate:\n$$\n\\widehat{p}_h(\\mathbf{y}_i,t) = \\overline{q}\\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right)\n$$\nFinally, this estimate is subtracted from the original signal to yield the filtered pressure, which ideally contains only the acoustic signal and residual noise:\n$$\np_f(\\mathbf{y}_i,t) = p_s(\\mathbf{y}_i,t) - \\widehat{p}_h(\\mathbf{y}_i,t)\n$$\nAll required time-shifts are performed numerically using linear interpolation on the discrete time-series data.\n\nThe third step is to compute the far-field observer pressure $p'(\\mathbf{x}_o,t)$ using a simplified, porous FW-H integral formulation. This involves summing the contributions from all surface points, with each contribution evaluated at its specific retarded time. The retarded time $t_r^{(i)}$ for a signal from point $\\mathbf{y}_i$ to be received at observer location $\\mathbf{x}_o$ at time $t$ is:\n$$\nt_r^{(i)}(t) = t - \\frac{R_i}{c_0}, \\quad \\text{where} \\quad R_i = \\|\\mathbf{x}_o - \\mathbf{y}_i\\|\n$$\nThe far-field proxy pressure is then a weighted sum of the filtered pressures evaluated at their respective retarded times:\n$$\np'(\\mathbf{x}_o,t) \\approx \\sum_{i=0}^{N_s-1} w_i \\, p_f\\left(\\mathbf{y}_i,\\, t_r^{(i)}(t)\\right)\n$$\nThe weights $w_i$ are given by $w_i = \\frac{R_{\\mathrm{ref}}}{4\\pi R_i N_s}$, where $R_{\\mathrm{ref}}=1\\,\\mathrm{m}$ is a reference length. This summation is performed by interpolating each filtered signal $p_f(\\mathbf{y}_i, t)$ at the required retarded time samples $t_r^{(i)}(t)$.\n\nThe final step is to analyze the frequency content of the resulting observer pressure signal $p'(\\mathbf{x}_o,t)$ by computing its one-sided power spectral density (PSD), $S_{p'p'}(f)$. The signal, of length $N$, is first multiplied by a Hann window $w[n]$ to reduce spectral leakage. The discrete Fourier transform (DFT), $X[k]$, of the windowed signal is computed. The one-sided PSD is then calculated according to the formula:\n$$\nS_{p'p'}(f_k) = \\begin{cases}\n\\frac{1}{f_s N U_w} |X[0]|^2,  k = 0 \\\\[6pt]\n\\frac{2}{f_s N U_w} |X[k]|^2,  1 \\le k \\le N/2 - 1 \\\\[6pt]\n\\frac{1}{f_s N U_w} |X[N/2]|^2,  k = N/2 \\text{ (for even } N\\text{)}\n\\end{cases}\n$$\nwhere $f_k = k f_s/N$ are the discrete frequencies and $U_w = \\frac{1}{N}\\sum_{n=0}^{N-1} w[n]^2$ is the window power correction factor. The PSD values are reported at the frequency bins closest to the designated acoustic frequency $f_a$ and hydrodynamic frequency $f_h$.\n\nThis entire procedure is encapsulated in a Python script. Vectorized `numpy` operations are used for efficiency, while loops are employed for steps involving non-uniform time shifts across surface points (filtering and retarded-time evaluation). All interpolations are handled by `numpy.interp`. The script iterates through the provided test cases, calculates the two requested PSD values for each, and formats the output as a single list of rounded decimal numbers.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef process_case(Ns, a, xo, fa, Aa, fh, Ah, U, c0, An, fs, T):\n    \"\"\"\n    Implements the full aeroacoustic post-processing pipeline for a single test case.\n    \"\"\"\n    # Set seed for reproducibility of noise. Using a combination of inputs to\n    # ensure noise is different per case but reproducible for the same case.\n    # A simple seed like 0 is sufficient, but this is more robust if case parameters were permuted.\n    seed_val = Ns + int(a*10) + int(xo[0]) + int(fa) + int(fh)\n    np.random.seed(seed_val)\n\n    # Step 1: Define a circular, permeable FW-H control surface and time array\n    N = int(T * fs)\n    t = np.linspace(0, T, N, endpoint=False)\n    dt = T / N\n\n    theta_i = 2 * np.pi * np.arange(Ns) / Ns\n    y_i = np.zeros((Ns, 3))\n    y_i[:, 0] = a * np.cos(theta_i)\n    y_i[:, 1] = a * np.sin(theta_i)\n    \n    # Step 2: Generate synthetic LES surface pressure signals\n    s_i = y_i[:, 0]  # Projection coordinate s(y_i) = x-component\n    \n    # Use broadcasting for efficient signal generation\n    t_grid = t[np.newaxis, :]\n    s_grid = s_i[:, np.newaxis]\n\n    acoustic_part = Aa * np.cos(2 * np.pi * fa * (t_grid - s_grid / c0))\n    hydro_part = Ah * np.cos(2 * np.pi * fh * (t_grid - s_grid / U))\n    noise_part = np.random.uniform(-An, An, size=(Ns, N))\n    \n    p_s = acoustic_part + hydro_part + noise_part\n    \n    # Step 3: Construct a hydrodynamic pressure estimate and filter\n    q = np.zeros_like(p_s)\n    for i in range(Ns):\n        t_aligned = t + s_i[i] / U\n        # Interpolate p_s at aligned times. Extrapolate with 0.\n        q[i, :] = np.interp(t_aligned, t, p_s[i, :], left=0.0, right=0.0)\n        \n    q_bar = np.mean(q, axis=0)\n    \n    p_h_hat = np.zeros_like(p_s)\n    for i in range(Ns):\n        t_dealigned = t - s_i[i] / U\n        # Interpolate q_bar at de-aligned times. Extrapolate with 0.\n        p_h_hat[i, :] = np.interp(t_dealigned, t, q_bar, left=0.0, right=0.0)\n        \n    p_f = p_s - p_h_hat\n    \n    # Step 4: Compute the FW-H far-field proxy pressure\n    xo_vec = np.array(xo)\n    R_i = np.linalg.norm(xo_vec - y_i, axis=1)\n    \n    R_ref = 1.0\n    w_i = R_ref / (4 * np.pi * R_i * Ns)\n    \n    p_prime = np.zeros(N)\n    for i in range(Ns):\n        t_r = t - R_i[i] / c0\n        p_f_retarded = np.interp(t_r, t, p_f[i, :], left=0.0, right=0.0)\n        p_prime += w_i[i] * p_f_retarded\n        \n    # Step 5: Compute the one-sided power spectral density (PSD)\n    x = p_prime\n    win = np.hanning(N)\n    # Window power correction factor\n    Uw = np.mean(win**2)\n    \n    x_w = x * win\n    X = np.fft.fft(x_w)\n    \n    freqs = np.fft.fftfreq(N, d=dt)\n    \n    psd = np.abs(X)**2 / (fs * N * Uw)\n    \n    # Correct for one-sided PSD, handling N even or odd\n    psd_one_sided = psd[:N//2 + 1]\n    freqs_one_sided = freqs[:N//2 + 1]\n    \n    # Double the power for non-DC and non-Nyquist frequencies\n    if N % 2 == 0:\n        psd_one_sided[1:-1] *= 2\n    else: # N is odd\n        psd_one_sided[1:] *= 2\n\n    # Find PSD values at frequencies closest to fa and fh\n    idx_fa = np.argmin(np.abs(freqs_one_sided - fa))\n    S_fa = psd_one_sided[idx_fa]\n    \n    idx_fh = np.argmin(np.abs(freqs_one_sided - fh))\n    S_fh = psd_one_sided[idx_fh]\n    \n    return S_fa, S_fh\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general case)\n        {'Ns': 64, 'a': 0.5, 'xo': (10.0, 0.0, 0.0), 'fa': 800, 'Aa': 1.0, \n         'fh': 200, 'Ah': 2.0, 'U': 100.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n        # Case 2 (no hydrodynamic content)\n        {'Ns': 64, 'a': 0.5, 'xo': (10.0, 0.0, 0.0), 'fa': 800, 'Aa': 1.0, \n         'fh': 200, 'Ah': 0.0, 'U': 100.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n        # Case 3 (near-sonic convection)\n        {'Ns': 64, 'a': 0.5, 'xo': (10.0, 0.0, 0.0), 'fa': 800, 'Aa': 1.0, \n         'fh': 200, 'Ah': 2.0, 'U': 320.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n        # Case 4 (sparse surface sampling and smaller aperture)\n        {'Ns': 8, 'a': 0.1, 'xo': (5.0, 0.0, 0.0), 'fa': 1200, 'Aa': 1.0, \n         'fh': 300, 'Ah': 2.0, 'U': 150.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n    ]\n\n    results = []\n    for case in test_cases:\n        S_fa, S_fh = process_case(**case)\n        results.append(round(S_fa, 6))\n        results.append(round(S_fh, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}