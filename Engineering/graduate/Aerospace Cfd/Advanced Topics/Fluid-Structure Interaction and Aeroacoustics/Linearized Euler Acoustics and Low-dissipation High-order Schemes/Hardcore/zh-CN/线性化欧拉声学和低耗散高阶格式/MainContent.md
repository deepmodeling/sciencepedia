## 引言
在航空航天领域，精确预测和控制噪声是飞行器设计的关键挑战之一。计算航空声学（CAA）应运而生，旨在通过[数值模拟](@entry_id:146043)来理解声波的产生与传播机制。然而，声波作为一种能量微弱的波动现象，对[数值模拟](@entry_id:146043)方法提出了极为苛刻的要求。传统的[计算流体动力学](@entry_id:142614)（CFD）方法通常为捕捉激波等强[非线性](@entry_id:637147)现象而设计，其固有的[数值耗散](@entry_id:168584)会轻易淹没微弱的声学信号，导致模拟结果失真。这一根本矛盾构成了计算航空声学领域的核心知识鸿沟：如何开发既能保持高阶精度又能将非物理性耗散降至最低的数值格式？

本文旨在系统性地解决这一问题。我们将带领读者深入探索专为声学模拟设计的数值世界。在第一章“原理与机制”中，我们将从物理和数学层面推导[线性化欧拉方程](@entry_id:1127259)（LEE），并揭示为何低耗散和低色散对于忠实再现声波至关重要。随后，在第二章“应用与跨学科联系”中，我们将展示这些理论原理如何转化为实用的计算技术，例如[无反射边界条件](@entry_id:1128822)和[数值滤波](@entry_id:1128966)，并探讨其与主流[CFD方法](@entry_id:747237)的深刻联系与区别。最后，在第三章“动手实践”部分，读者将有机会通过具体的编程练习，将理论知识付诸实践，亲手构建并验证一个高保真度的声学模拟求解器。通过这三章的学习，您将建立起对高保真波动模拟的坚实理解，掌握应对计算航空声学挑战的核心工具。

## 原理与机制

本章在前一章介绍的背景基础上，深入探讨[线性声学](@entry_id:1127264)模型的物理原理和数学构造，并阐述精确模拟声波传播所需的专用数值方法的内在机制。我们将从控制方程的推导开始，分析其基本假设和波动特性，然后过渡到[数值离散化](@entry_id:752782)所面临的核心挑战，特别是对低耗散[高阶格式](@entry_id:150564)的需求。本章旨在为后续章节中具体的数值格式设计与实现提供坚实的理论基础。

### [线性声学](@entry_id:1127264)控制方程

计算航空声学（Computational Aeroacoustics, CAA）的许多问题都涉及在均匀或缓慢变化的背景流场中传播的微小振幅声扰动。在这种情况下，完全[非线性](@entry_id:637147)的欧拉方程或[纳维-斯托克斯方程](@entry_id:142275)可以被简化，从而得到一个更易于分析和求解的线性系统。这个系统被称为**[线性化欧拉方程](@entry_id:1127259)（Linearized Euler Equations, LEE）**。

#### 方程的推导与物理假设

我们从无粘、[可压缩流](@entry_id:747589)动的欧拉方程出发，该方程描述了质量、动量和能量的守恒。考虑一个状态量 $q$（如密度 $\rho$、速度 $\mathbf{U}$ 或压力 $p$），并将其分解为一个定常或缓变的背景流（基流）$q_0$ 和一个微小的扰动量 $q'$：

$q(\mathbf{x}, t) = q_0(\mathbf{x}, t) + q'(\mathbf{x}, t)$，其中 $|q'| \ll |q_0|$。

为简单起见，我们考虑一个均匀的背景流，其密度 $\rho_0$、速度 $\mathbf{U}_0$ 和压力 $p_0$ 均为常数。将上述分解代入[非线性](@entry_id:637147)的[欧拉方程](@entry_id:177914)，并忽略所有包含两个或更多扰动量乘积的高阶项（例如 $\rho' \mathbf{U}'$），我们便可以得到一组关于扰动量的[线性偏微分方程](@entry_id:172517)。以[原始变量](@entry_id:753733) $(\rho', \mathbf{U}', p')$ 表示，这组方程为 ：

质量方程：
$$
\frac{\partial \rho'}{\partial t} + \mathbf{U}_0 \cdot \nabla \rho' + \rho_0 \nabla \cdot \mathbf{U}' = 0
$$

[动量方程](@entry_id:197225)：
$$
\frac{\partial \mathbf{U}'}{\partial t} + (\mathbf{U}_0 \cdot \nabla) \mathbf{U}' + \frac{1}{\rho_0} \nabla p' = 0
$$

这组方程的推导基于两个核心的物理假设：

1.  **微小扰动假设**：扰动的幅度远小于背景流的量值。这保证了忽略高阶项的线性化过程是有效的。

2.  **无粘、绝热假设**：与完全[欧拉方程](@entry_id:177914)一样，LEE 忽略了流体的粘性效应和[热传导](@entry_id:143509)效应。这一简化的合理性是理解低耗散数值方法必要性的关键。对于声波传播问题，我们可以通过标度分析来论证。考虑一个频率为 $\omega$、波数为 $k$ 的平面声波，其波长为 $\lambda = 2\pi/k$。流体中的粘性耗散和[热传导](@entry_id:143509)耗散分别与动量扩散（以运动粘度 $\nu$ 为特征）和热扩散（以[热扩散率](@entry_id:144337) $\alpha$ 为特征）有关。这些扩散项在动量和能量方程中表现为二阶空间导数，其量级为 $\nu k^2$ 和 $\alpha k^2$。而声波的惯性项或时间变化项的量级为 $\omega$。对于声波，我们有 $\omega \approx c_0 k$（其中 $c_0$ 是声速）。因此，要忽略粘性和[热传导](@entry_id:143509)，必须满足以下条件 ：
    $$
    \nu k^2 \ll c_0 k \quad \text{以及} \quad \alpha k^2 \ll c_0 k
    $$
    这两个条件可以重写为基于波长的**雷诺数** ($Re_\lambda$) 和**[佩克莱数](@entry_id:141791)** ($Pe_\lambda$) 远大于1：
    $$
    Re_\lambda = \frac{c_0 \lambda}{\nu} \gg 1 \quad \text{以及} \quad Pe_\lambda = \frac{c_0 \lambda}{\alpha} \gg 1
    $$
    在大多数航空声学[远场](@entry_id:269288)传播问题中，空气的粘度和[热导](@entry_id:189019)率很小，而声波的波长相对较大（或频率不是极高），因此这两个条件通常是满足的。这意味着在传播路径上，物理耗散本身是微不足道的。这一结论直接引出了计算航空声学的核心数值挑战：既然物理模型本身忽略了耗散，那么用于求解该模型的数值格式自身引入的**[数值耗散](@entry_id:168584)（numerical dissipation）**也必须极小，否则数值误差将淹没真实的物理现象，导致声波幅度的错误衰减。

#### [热力学](@entry_id:172368)封闭与声速

上述的质量和动量方程包含了三个未知变量 $(\rho', \mathbf{U}', p')$，因此需要一个额外的方程来封闭该系统。这个封闭关系来自于[热力学](@entry_id:172368)。对于由微小扰动引起的快速过程，流体微团来不及与周围环境进行热量交换，因此可以假定过程是**等熵的（isentropic）**。

对于理想气体，[等熵过程](@entry_id:137496)遵循 $p/\rho^\gamma = \text{const}$ 的关系，其中 $\gamma$ 是比热比。声速 $c$ 被定义为在等[熵条件](@entry_id:166346)下压力对密度的[偏导数](@entry_id:146280)开方，即 $c^2 = (\partial p / \partial \rho)_s$。基于等熵关系，我们可以推导出声速的表达式 ：
$$
c^2 = \frac{\partial}{\partial \rho} (K \rho^\gamma) = K \gamma \rho^{\gamma-1} = \left(\frac{p}{\rho^\gamma}\right) \gamma \rho^{\gamma-1} = \frac{\gamma p}{\rho}
$$
将等熵关系 $p(\rho) = p_0 + p'$ 对基准态 $\rho_0$ 进行一阶泰勒展开，我们得到扰动量之间的关系：
$$
p' = \left(\frac{\partial p}{\partial \rho}\right)_{s,0} \rho' = c_0^2 \rho'
$$
其中 $c_0^2 = \gamma p_0 / \rho_0$ 是背景流场中的声速。这个代数关系 $p' = c_0^2 \rho'$ 就是我们寻求的封闭方程。

等熵假设还有一个更深层次的含义。根据[热力学基本关系](@entry_id:144320)（吉布斯关系），$Tds = de + pd(1/\rho)$，对于[等熵过程](@entry_id:137496) $ds=0$。对于[理想气体](@entry_id:200096) $de = c_v dT$。这意味着扰动量之间存在确定的代数关系。可以证明，温度扰动 $T'$ 并不是一个独立的变量，而是可以由密度扰动 $\rho'$ 或压力扰动 $p'$ 诊断出来 ：
$$
\frac{T'}{T_0} = (\gamma-1)\frac{\rho'}{\rho_0} = \frac{\gamma-1}{\gamma}\frac{p'}{p_0}
$$
这表明，在等熵[线性声学](@entry_id:1127264)模型中，能量方程是冗余的。我们可以仅求解质量和动量方程，并利用代数关系得到压力和温度，从而极大地简化了问题。

### 变量表示与波动结构

LEE 方程组可以有不同的变量表示形式，并且其解揭示了不同类型的波动模式。

#### [原始变量](@entry_id:753733)与[守恒变量](@entry_id:747720)

我们在前面推导了以**[原始变量](@entry_id:753733)（primitive variables）** $(\rho', \mathbf{U}', p')$ 表示的 LEE。然而，大多数现代[CFD求解器](@entry_id:747244)都是为求解[守恒形式](@entry_id:1122899)的欧拉方程而设计的，其变量为**[守恒变量](@entry_id:747720)（conservative variables）** $(\rho, \mathbf{m}, E)$，其中 $\mathbf{m} = \rho \mathbf{U}$ 是[动量密度](@entry_id:271360)，$E$ 是总能量密度。

为了分析标准[CFD格式](@entry_id:1122230)在声学问题上的表现，我们需要建立原始扰动变量与守恒扰动变量之间的关系。守恒扰动量定义为 $\rho' = \rho - \rho_0$，$\mathbf{m}' = \mathbf{m} - \mathbf{m}_0$，以及 $E' = E - E_0$。通过对[守恒变量](@entry_id:747720)的定义进行线性化，我们可以找到从原始扰动向量 $(\rho', u', v', w', p')^T$ 到守恒扰动向量 $(\rho', m'_x, m'_y, m'_z, E')^T$ 的[线性映射](@entry_id:185132)。这个映射由一个 $5 \times 5$ 的[雅可比矩阵](@entry_id:178326)表示 ：
$$
\begin{pmatrix} \rho' \\ m'_x \\ m'_y \\ m'_z \\ E' \end{pmatrix} = 
\begin{pmatrix}
1 & 0 & 0 & 0 & 0 \\
U_{0x} & \rho_0 & 0 & 0 & 0 \\
U_{0y} & 0 & \rho_0 & 0 & 0 \\
U_{0z} & 0 & 0 & \rho_0 & 0 \\
\frac{1}{2}|\mathbf{U}_0|^2 & \rho_0 U_{0x} & \rho_0 U_{0y} & \rho_0 U_{0z} & \frac{1}{\gamma-1}
\end{pmatrix}
\begin{pmatrix} \rho' \\ u' \\ v' \\ w' \\ p' \end{pmatrix}
$$
其中 $\mathbf{U}_0=(U_{0x}, U_{0y}, U_{0z})$ 是背景流速度。这个矩阵对于在[原始变量](@entry_id:753733)和[守恒变量](@entry_id:747720)之间进行[特征分解](@entry_id:181333)和格式转换至关重要。

#### 声学模态与涡模态

LEE 的解包含哪些类型的波？为了回答这个问题，我们采用**傅里叶分析（Fourier analysis）**，假设解具有[平面波](@entry_id:189798)形式，如 $q'(\mathbf{x}, t) = \hat{q} e^{i(\mathbf{k} \cdot \mathbf{x} - \omega t)}$，其中 $\hat{q}$ 是振幅，$\mathbf{k}$ 是波向量，$\omega$ 是[角频率](@entry_id:261565)。将此形式代入 LEE 方程组，微分算子 $\partial/\partial t$ 变为 $-i\omega$，$\nabla$ 变为 $i\mathbf{k}$，从而将[偏微分方程组](@entry_id:172573)转化为关于振幅的[代数方程](@entry_id:272665)组。

通过分析这个代数系统，我们发现在无粘线性化框架下，扰动可以被精确地分解为几种基本模态。以二维流动为例，我们可以将速度扰动 $\hat{\mathbf{u}}$ 分解为沿[波向量](@entry_id:178620) $\mathbf{k}$ 方向的**纵向分量** $\hat{u}_\parallel$ 和垂直于 $\mathbf{k}$ 的**横向分量** $\hat{\mathbf{u}}_\perp$。分析表明，这两种分量对应着完全不同性质的物理模式 ：

1.  **声学模态（Acoustic Modes）**：这种模态的运动是纯纵向的（$\hat{\mathbf{u}}_\perp = 0$），即流体质点振动方向与波传播方向平行。它伴随着压力和密度的波动（$\hat{p} \neq 0, \hat{\rho} \neq 0$），本质上是[压缩波](@entry_id:747596)。其[色散关系](@entry_id:140395)为 $\omega = \mathbf{U}_0 \cdot \mathbf{k} \pm c_0 |\mathbf{k}|$，描述了声波以声速 $c_0$ 相对于背景流 $\mathbf{U}_0$ 传播。

2.  **涡模态（Vorticity Mode）**：这种模态的运动是纯横向的（$\hat{u}_\parallel = 0$），即流体[质点](@entry_id:186768)振动方向与波传播方向垂直。它不产生任何压力或密度波动（$\hat{p} = 0, \hat{\rho} = 0$），因此是不可压缩的，并且是“沉默的”（非声学的）。其[色散关系](@entry_id:140395)为 $\omega = \mathbf{U}_0 \cdot \mathbf{k}$，表明涡模态仅仅是被背景流平流输运，自身不传播。

在三维情况下，还存在一个额外的熵模态（如果放弃等熵假设），它也遵循平流规律。这个分解揭示了一个深刻的物理事实：在[线性化欧拉方程](@entry_id:1127259)的框架内，只有可压缩的、纵向的运动才能产生声波。

### [数值离散化](@entry_id:752782)的原理与挑战

将连续的 LEE 方程组转化为可在计算机上求解的离散方程组，引入了新的误差来源，即[截断误差](@entry_id:140949)。为精确模拟声波，必须理解并控制这些误差。

#### [数值耗散](@entry_id:168584)与[数值色散](@entry_id:145368)

数值格式的[截断误差](@entry_id:140949)可以分为两类，它们对波的传播有不同的影响。通过**[修正方程](@entry_id:173454)分析（modified equation analysis）**，我们可以将离散格式所实际求解的[偏微分](@entry_id:194612)方程展开。这个修正方程等于原始的[偏微分](@entry_id:194612)方程，外加一系列[高阶导数](@entry_id:140882)项，这些项就是[截断误差](@entry_id:140949)。

分析表明，这些误差项的导数阶次决定了其物理效应 ：

*   **偶数阶导数项（如 $\partial^2/\partial x^2, \partial^4/\partial x^4$）**：这些项在数学上类似于物理扩散或耗散项。它们主要导致波的**幅度衰减**，这种效应被称为**[数值耗散](@entry_id:168584)（numerical dissipation）**。一个稳定的数值格式必须具有耗散性，或者其耗散项被精确控制以防止能量无界增长。对于[声学模](@entry_id:263916)拟，必须将[数值耗散](@entry_id:168584)降到最低。

*   **奇数阶导数项（如 $\partial^3/\partial x^3, \partial^5/\partial x^5$）**：这些项主要影响波的**传播速度**，使其依赖于波数（或频率）。这导致不同频率的波以不同的速度传播，从而使波包变形。这种效应被称为**[数值色散](@entry_id:145368)（numerical dispersion）**。

一个理想的声学计算格式应该同时具有低耗散和低色散的特性。

#### [低耗散格式](@entry_id:1127470)的设计原则

如何设计一个[数值耗散](@entry_id:168584)尽可能小的格式？我们以空间导数 $\partial/\partial x$ 的近似为例。一个[有限差分格式](@entry_id:749361)可以表示为对周围网格点值的卷积。其傅里叶符号 $D(k\Delta x)$ 描述了该离散算子对波数为 $k$ 的平面波的作用。

为了实现零[数值耗散](@entry_id:168584)（即纯色散格式），需要满足两个条件 ：

1.  **[半离散系统](@entry_id:754680)是能量守恒的**：这意味着空间离散算子的符号必须是纯虚数。对于一阶导数的[有限差分格式](@entry_id:749361)，这要求其差分系数是反对称的（例如，[中心差分格式](@entry_id:1122205)）。一个反对称的算子在数学上是反自伴的，它不会改变解的[能量范数](@entry_id:274966)。

2.  **[时间积分方法](@entry_id:136323)是[酉性](@entry_id:138773)的（unitary）**：这意味着时间离散格式在作用于纯虚数特征值时，其[放大因子](@entry_id:144315)的模长必须恒等于1。满足这一条件的常见[时间积分方法](@entry_id:136323)包括[梯形法则](@entry_id:145375)（Crank-Nicolson）和在稳定性极限内的蛙跳格式（Leapfrog）。

满足这两个条件的格式，例如采用反对称中心差分和[蛙跳格式](@entry_id:163462)的组合，在理论上是无耗散的，其误差完全表现为色散。

### 高阶格式：设计策略与常见陷阱

为了同时实现低耗散和低色散，研究人员开发了多种高阶格式。然而，将为其他CFD领域（如激波捕捉）设计的标准[高阶格式](@entry_id:150564)直接应用于声学问题，往往会遇到意想不到的困难。

#### [色散关系](@entry_id:140395)保持（DRP）格式

**色散关系保持（Dispersion-Relation-Preserving, DRP）**格式是一类专门为波动问题设计的优化格式。其核心思想不是单纯追求[泰勒展开](@entry_id:145057)的阶数，而是在一个给定的波数范围内，使离散格式的色散关系 $\omega_{\text{numerical}}(k)$ 尽可能地接近真实的物理色散关系 $\omega(k) = ck$ 。

DRP 格式的设计流程通常包括：
1.  选择一个反对称的[中心差分](@entry_id:173198) stencil 结构。
2.  通过求解一个优化问题来确定差分系数，该优化问题旨在最小化数值相速度与物理相速度在目标波数带内的[积分误差](@entry_id:171351)。
3.  将优化后的空间格式与一个同样经过优化的低色散、低耗散[时间积分格式](@entry_id:165373)（如优化的多步[龙格-库塔法](@entry_id:140014)）相结合。
4.  通过冯·诺依曼分析和数值实验（如传播宽带[高斯波包](@entry_id:151158)）来验证格式的性能。

#### 陷阱一：WENO 等[激波捕捉格式](@entry_id:754789)的滥用

加权本质无振荡（Weighted Essentially Non-Oscillatory, WENO）格式是CFD中用于模拟含激波流动的极其成功的格式。它们通过[非线性](@entry_id:637147)加权机制，在光滑区域实现高阶精度，在激波附近自动切换到低阶耗散格式以避免振荡。然而，这种[非线性](@entry_id:637147)机制对声学模拟是“致命的”。

问题出在其**光滑度指示子（smoothness indicators）** $\beta_k$ 的设计上。对于一个振幅为 $\delta$ 的光滑正弦波，$\beta_k$ 的量级为 $\mathcal{O}(\delta^2)$。[WENO格式](@entry_id:1134046)的[非线性权重](@entry_id:752658)的计算公式大致为 $\omega_k \propto d_k / (\epsilon + \beta_k)^p$。当 $\beta_k$ 远大于小参数 $\epsilon$ 时，权重 $\omega_k$ 中包含的 $\delta$ 因子在分子分母间被完全约掉。这意味着，无论声波振幅 $\delta$ 多么小，[WENO格式](@entry_id:1134046)的权重都会偏离最优线性权重，从而引入一个与振幅无关的[数值耗散](@entry_id:168584)。对于微小的声波而言，这种固定的耗散会造成巨大的相对误差，导致声波被迅速、非物理地衰减掉 。

#### 陷阱二：[混叠误差](@entry_id:637691)的敏感性

**混叠（Aliasing）** 是离散信号处理中的一个基本现象。当在一个离散网格[上采样](@entry_id:275608)一个连续信号时，高于奈奎斯特（Nyquist）波数 $k_{Nyquist} = \pi/\Delta x$ 的高频分量会被错误地表示为低于该波数的低频分量。两个连续波数 $k$ 和 $k'$ 如果满足 $k' = k + 2\pi m / \Delta x$（其中 $m$ 为整数），它们在网格上的采样值将完全相同 。

在流体模拟中，即使初始场是光滑的，方程中的[非线性](@entry_id:637147)项（如对流项 $\mathbf{U} \cdot \nabla \mathbf{U}$）也会不断地通过模态间的相互作用产生新的、更高频率的[谐波](@entry_id:181533)。当这些新产生的谐波的波数超过奈奎斯特波数时，它们就会发生[混叠](@entry_id:146322)，“折叠”回可分辨的波数范围内，形成虚假的低频信号。

低耗散高阶格式对此问题尤为敏感。原因在于：
*   **高耗散格式**（如[一阶迎风格式](@entry_id:749417)）对高波数分量具有强烈的阻尼效应。即使[非线性](@entry_id:637147)项产生了高频内容，这些内容在被混叠之前就已被格式自身的耗散所衰减。
*   **[低耗散格式](@entry_id:1127470)**被设计用来精确地传播所有可分辨的波数。它们无法区分“真实”的物理波和由混叠产生的“虚假”波。因此，它们会忠实地传播这些虚假的、被污染的能量，导致其在模拟中持续存在并累积，最终破坏整个解的精度。

因此，在使用低耗散[高阶格式](@entry_id:150564)进行[非线性](@entry_id:637147)模拟时，必须采用特殊的**[去混叠](@entry_id:748248)（de-aliasing）**技术或引入足够的[人工耗散](@entry_id:746522)来控制这些高频不稳定性。