{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of unsteady aerodynamics is understanding when the flow can be simplified as a series of steady states versus when its time-history is crucial. The reduced frequency, $k$, provides a quantitative answer by comparing the timescale of the body's motion to the time it takes for fluid to travel across it. This exercise guides you through deriving this fundamental parameter from first principles and applying it to a practical hypersonic flight scenario, developing your ability to justify the choice between complex unsteady models and efficient quasi-steady approximations. ",
            "id": "3948910",
            "problem": "A thin hypersonic control surface with semi-chord length $b$ undergoes a small-amplitude harmonic pitch oscillation in a uniform, inviscid, compressible flow. Treat the gas as a calorically perfect ideal gas with specific heat ratio $\\gamma$ and gas constant $R$. The uniform stream has freestream Mach number $M_\\infty$ and temperature $T_\\infty$, and the control surface oscillates at frequency $f$ (with angular frequency $\\omega = 2\\pi f$). In linearized inviscid unsteady aerodynamics, identify the nondimensional unsteadiness parameter that emerges from nondimensionalizing time by the convective transit time across the semi-chord, and compute its value for the following conditions:\n- $b = 0.20\\ \\mathrm{m}$,\n- $M_\\infty = 8$,\n- $\\gamma = 1.4$,\n- $R = 287\\ \\mathrm{J/(kg\\cdot K)}$,\n- $T_\\infty = 220\\ \\mathrm{K}$,\n- $f = 50\\ \\mathrm{Hz}$.\n\nAssume the freestream speed of sound is $a_\\infty = \\sqrt{\\gamma R T_\\infty}$ and the flow speed is $U_\\infty = M_\\infty a_\\infty$. Using first principles, derive the appropriate nondimensional unsteadiness parameter from the governing equations and nondimensionalization, then evaluate it numerically with the given data. Based on its magnitude, argue whether quasi-steady hypersonic piston theory provides an adequate approximation in a coupled Computational Fluid Dynamics (CFD) aeroelastic analysis. Express the final numerical value as a dimensionless number, and round your answer to four significant figures.",
            "solution": "The problem asks for the derivation and calculation of a key nondimensional parameter in unsteady aerodynamics, its numerical evaluation for a given hypersonic flight condition, and an assessment of the validity of a simplified aerodynamic theory based on this parameter's magnitude.\n\nFirst, the problem is validated.\n\n**Step 1: Extract Givens**\n- `semi-chord length`: $b$\n- `small-amplitude harmonic pitch oscillation`\n- `uniform, inviscid, compressible flow`\n- `calorically perfect ideal gas`\n- `specific heat ratio`: $\\gamma$\n- `gas constant`: $R$\n- `freestream Mach number`: $M_\\infty$\n- `freestream temperature`: $T_\\infty$\n- `oscillation frequency`: $f$\n- `angular frequency`: $\\omega = 2\\pi f$\n- `Nondimensionalization of time`: by the convective transit time across the semi-chord.\n- `Given values`:\n    - $b = 0.20\\ \\mathrm{m}$\n    - $M_\\infty = 8$\n    - $\\gamma = 1.4$\n    - $R = 287\\ \\mathrm{J/(kg\\cdot K)}$\n    - $T_\\infty = 220\\ \\mathrm{K}$\n    - $f = 50\\ \\mathrm{Hz}$\n- `Assumed formulas`:\n    - $a_\\infty = \\sqrt{\\gamma R T_\\infty}$\n    - $U_\\infty = M_\\infty a_\\infty$\n\n**Step 2  3: Validate and Verdict**\nThe problem is scientifically grounded in the established principles of linearized unsteady aerodynamics and compressible flow. All terms are clearly defined, and the provided data are physically consistent and sufficient for a unique solution. The problem is well-posed, objective, and non-trivial, requiring both derivation and numerical application of a fundamental concept. The problem is therefore **valid**.\n\n**Solution Derivation**\n\nThe governing equations for unsteady, inviscid, compressible flow (the Euler equations) contain both time-derivative terms ($\\frac{\\partial}{\\partial t}$) and convective terms (e.g., $\\mathbf{u} \\cdot \\nabla$). To identify the relevant nondimensional parameters, we nondimensionalize these equations.\n\nLet the reference length be the semi-chord, $b$, and the reference velocity be the freestream velocity, $U_\\infty$. The reference time is defined by the problem as the convective transit time across the semi-chord, which is $t_{ref} = \\frac{b}{U_\\infty}$.\n\nWe define the nondimensional variables (denoted by a bar) as:\n- Nondimensional time: $\\tau = \\frac{t}{t_{ref}} = \\frac{t U_\\infty}{b}$\n- Nondimensional spatial coordinates: e.g., $\\bar{x} = \\frac{x}{b}$\n\nThe chain rule is used to transform the derivatives:\n$$ \\frac{\\partial}{\\partial t} = \\frac{\\partial \\tau}{\\partial t} \\frac{\\partial}{\\partial \\tau} = \\frac{U_\\infty}{b} \\frac{\\partial}{\\partial \\tau} $$\n$$ \\frac{\\partial}{\\partial x} = \\frac{\\partial \\bar{x}}{\\partial x} \\frac{\\partial}{\\partial \\bar{x}} = \\frac{1}{b} \\frac{\\partial}{\\partial \\bar{x}} $$\nA convective term in the governing equations, such as the one in the momentum equation, has the form $U_\\infty \\frac{\\partial}{\\partial x}$. In nondimensional form, this becomes:\n$$ U_\\infty \\frac{\\partial}{\\partial x} = U_\\infty \\left( \\frac{1}{b} \\frac{\\partial}{\\partial \\bar{x}} \\right) = \\frac{U_\\infty}{b} \\frac{\\partial}{\\partial \\bar{x}} $$\nThe problem states that the control surface undergoes harmonic oscillation at an angular frequency $\\omega$. This implies that the flow variables have a time dependence of the form $e^{i \\omega t}$. When we substitute the nondimensional time $\\tau$ into this expression, we get:\n$$ e^{i \\omega t} = e^{i \\omega (b\\tau / U_\\infty)} = e^{i (\\omega b / U_\\infty) \\tau} $$\nThe time derivative of a variable $q$ that varies harmonically as $q \\propto e^{i \\omega t}$ is $\\frac{\\partial q}{\\partial t} = i\\omega q$.\n\nWhen the governing equations are nondimensionalized, the unsteady term $\\frac{\\partial}{\\partial t}$ carries a factor of $\\frac{U_\\infty}{b}$ and the harmonic time dependence introduces a factor of $i \\omega$. More formally, the nondimensional representation of the time derivative operator applied to a harmonic function becomes:\n$$ \\frac{\\partial}{\\partial t} \\rightarrow \\frac{U_\\infty}{b} \\frac{\\partial}{\\partial \\tau} \\rightarrow \\frac{U_\\infty}{b} \\left( i \\frac{\\omega b}{U_\\infty} \\right) = i\\omega $$\nThe ratio of the characteristic timescale of the flow transit ($t_{ref} = b/U_\\infty$) to the characteristic timescale of the oscillation ($T_{osc} = 1/f = 2\\pi/\\omega$) governs the degree of unsteadiness. The nondimensional parameter that emerges from this analysis is the coefficient of $\\tau$ in the exponent, which is defined as the reduced frequency, $k$.\n$$ k = \\frac{\\omega b}{U_\\infty} $$\nThis parameter represents the ratio of the convective time to the oscillation period (up to a factor of $2\\pi$). It is the fundamental parameter that quantifies the level of unsteadiness in an aerodynamic flow.\n\n**Numerical Calculation**\n\nWe are given the necessary values to compute $k$.\n1.  Calculate the freestream speed of sound, $a_\\infty$:\n    $$ a_\\infty = \\sqrt{\\gamma R T_\\infty} $$\n    With $\\gamma = 1.4$, $R = 287\\ \\mathrm{J/(kg\\cdot K)}$, and $T_\\infty = 220\\ \\mathrm{K}$:\n    $$ a_\\infty = \\sqrt{1.4 \\times 287 \\times 220} = \\sqrt{88396}\\ \\mathrm{m/s} \\approx 297.3146\\ \\mathrm{m/s} $$\n\n2.  Calculate the freestream velocity, $U_\\infty$:\n    $$ U_\\infty = M_\\infty a_\\infty $$\n    With $M_\\infty = 8$:\n    $$ U_\\infty = 8 \\times \\sqrt{88396}\\ \\mathrm{m/s} \\approx 2378.517\\ \\mathrm{m/s} $$\n\n3.  Calculate the angular frequency, $\\omega$:\n    $$ \\omega = 2\\pi f $$\n    With $f = 50\\ \\mathrm{Hz}$:\n    $$ \\omega = 2\\pi(50) = 100\\pi\\ \\mathrm{rad/s} $$\n\n4.  Calculate the reduced frequency, $k$:\n    $$ k = \\frac{\\omega b}{U_\\infty} $$\n    With $b = 0.20\\ \\mathrm{m}$:\n    $$ k = \\frac{(100\\pi)(0.20)}{8 \\sqrt{88396}} = \\frac{20\\pi}{8 \\sqrt{88396}} = \\frac{2.5\\pi}{\\sqrt{88396}} $$\n    $$ k \\approx \\frac{2.5 \\times 3.14159265}{297.314648} \\approx 0.0264163 $$\n    Rounding to four significant figures, the value is $0.02642$.\n\n**Physical Interpretation**\n\nThe reduced frequency $k \\approx 0.02642$ is a very small number ($k \\ll 1$). The reduced frequency compares the time it takes for a fluid particle to travel over the characteristic length (the semi-chord $b$) with the period of the oscillation. A small value of $k$ signifies that the oscillation period is much longer than the flow transit time. In this case, the flow field has sufficient time to adjust almost instantaneously to the changes in the control surface's orientation.\n\nHypersonic piston theory is an approximation used for high-Mach-number flows. Its *quasi-steady* form calculates aerodynamic pressure based solely on the instantaneous local downwash (i.e., the component of surface velocity normal to the freestream), neglecting any time-history or \"memory\" effects of the flow. This quasi-steady assumption is valid precisely when the unsteadiness is low, as indicated by a small reduced frequency.\n\nSince the calculated reduced frequency $k \\approx 0.02642$ is significantly less than unity (and typically below the common threshold of $k \\approx 0.05$ where unsteady effects start to become noticeable), the flow can be considered quasi-steady. Therefore, using the simpler quasi-steady hypersonic piston theory would be an adequate approximation for calculating the aerodynamic loads in a coupled CFD-based aeroelastic analysis for this specific flight condition. Unsteady effects, while present, would be of a small order compared to the quasi-steady loads.",
            "answer": "$$\n\\boxed{0.02642}\n$$"
        },
        {
            "introduction": "When coupling fluid and structural solvers, a common and flexible approach is a partitioned, or 'loosely-coupled,' scheme. However, these methods can suffer from severe numerical instabilities, particularly when the fluid is dense compared to the structure. This practice uncovers the physical origin of this problem—the 'added mass' effect—by first having you derive the inertial force exerted by an accelerating fluid and then demonstrating how a naive numerical scheme can fail spectacularly. Mastering this concept  is essential for designing stable and reliable fluid-structure interaction simulations.",
            "id": "3948884",
            "problem": "A rigid, symmetric, zero-thickness flat plate of chord length $c$ and very large span executes small-amplitude heave motion $y(t)$ in an incompressible, inviscid, irrotational fluid of density $\\rho$. Treat the problem as two-dimensional with per-unit-span quantities. The structure is modeled as a single heave degree-of-freedom with structural mass per unit span $m_{s}$ and linear stiffness per unit span $k$. The fluid motion is governed by the incompressible, inviscid Euler equations, and under the assumptions of irrotational flow and small-amplitude motion, admits a velocity potential $\\phi$ satisfying $\\nabla^{2} \\phi = 0$, the linearized kinematic condition of no-penetration on the plate, and the linearized unsteady Bernoulli relation $p = -\\rho \\frac{\\partial \\phi}{\\partial t} + \\text{const}$ for the pressure $p$.\n\n1) Starting from the potential flow formulation $\\nabla^{2} \\phi = 0$, the no-penetration condition on the flat plate, and the linearized unsteady Bernoulli relation, derive the hydrodynamic added mass per unit span $m_{a}$ for the heave motion of the flat plate in terms of the semi-chord $b = c/2$ and the fluid density $\\rho$.\n\n2) Using Newton’s second law for the structure and the result of part (1), write the exact continuous coupled equation of motion for $y(t)$, identifying the total inertial term.\n\n3) Consider now a loosely coupled explicit predictor for the fluid-structure interaction in which, at a given instant $t$, one first predicts the structural acceleration by temporarily neglecting the fluid inertial force, obtaining the predictor $a_{\\text{pred}}(t) = -\\left(k/m_{s}\\right) y(t)$. The fluid inertial force is then evaluated as $f_{f}(t) = -m_{a} \\, a_{\\text{pred}}(t)$ and applied to correct the structural acceleration via $m_{s} \\, \\ddot{y}(t) = -k \\, y(t) + f_{f}(t)$. Starting from Newton’s second law and this predictor-corrector closure, derive the resulting closed-loop continuous-time equation for $y(t)$ and the corresponding effective natural frequency in terms of $\\omega_{0}^{2} = k/m_{s}$ and the mass ratio $\\mu = m_{a}/m_{s}$. State the condition on $\\mu$ for bounded oscillations.\n\n4) Imposing the condition from part (3) to ensure bounded oscillations of the loosely coupled scheme, determine the maximum chord $c_{\\max}$ that permits bounded oscillations, expressed as a closed-form analytic expression in terms of $m_{s}$ and $\\rho$. Express $c_{\\max}$ in meters.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained. The concepts presented are fundamental to the fields of potential flow theory and computational aeroelasticity. I will now proceed with the solution to the four parts requested.\n\n1) Derivation of the hydrodynamic added mass per unit span, $m_a$.\n\nThe problem considers a two-dimensional flat plate of chord $c$ located on the $x$-axis between $x=-b$ and $x=b$, where $b=c/2$ is the semi-chord. The plate executes a small-amplitude heave motion $y(t)$ in an incompressible, inviscid, irrotational fluid of density $\\rho$. The fluid motion is described by a velocity potential $\\phi$ that satisfies Laplace's equation, $\\nabla^2 \\phi = 0$.\n\nThe linearized kinematic boundary condition on the plate requires that the fluid velocity normal to the surface equals the surface velocity. For small heave motion, this condition is applied on the mean position of the plate, $y=0$:\n$$\n\\frac{\\partial \\phi}{\\partial y} \\bigg|_{y=0} = \\dot{y}(t) \\quad \\text{for } x \\in [-b, b]\n$$\nThe solution to Laplace's equation with this boundary condition yields a velocity potential that is anti-symmetric with respect to the $y=0$ plane. On the upper ($y=0^+$) and lower ($y=0^-$) surfaces of the plate, the potential is given by:\n$$\n\\phi_u(x,t) = \\phi(x, 0^+, t) = -\\dot{y}(t) \\sqrt{b^2 - x^2}\n$$\n$$\n\\phi_l(x,t) = \\phi(x, 0^-, t) = +\\dot{y}(t) \\sqrt{b^2 - x^2}\n$$\nThe pressure $p$ in the fluid is given by the linearized, unsteady Bernoulli relation, $p = -\\rho \\frac{\\partial \\phi}{\\partial t}$. The pressure on the upper and lower surfaces is therefore:\n$$\np_u(x,t) = -\\rho \\frac{\\partial \\phi_u}{\\partial t} = -\\rho \\frac{\\partial}{\\partial t} \\left(-\\dot{y}(t)\\sqrt{b^2-x^2}\\right) = \\rho \\ddot{y}(t) \\sqrt{b^2 - x^2}\n$$\n$$\np_l(x,t) = -\\rho \\frac{\\partial \\phi_l}{\\partial t} = -\\rho \\frac{\\partial}{\\partial t} \\left(+\\dot{y}(t)\\sqrt{b^2-x^2}\\right) = -\\rho \\ddot{y}(t) \\sqrt{b^2 - x^2}\n$$\nThe net hydrodynamic force per unit span, $F_a$, exerted by the fluid on the plate in the positive $y$-direction is the integral of the pressure difference across the chord:\n$$\nF_a = \\int_{-b}^{b} (p_l(x,t) - p_u(x,t)) \\, dx = \\int_{-b}^{b} \\left(-\\rho \\ddot{y}(t) \\sqrt{b^2-x^2} - \\rho \\ddot{y}(t) \\sqrt{b^2-x^2}\\right) \\, dx\n$$\n$$\nF_a = -2\\rho \\ddot{y}(t) \\int_{-b}^{b} \\sqrt{b^2-x^2} \\, dx\n$$\nThe definite integral represents the area of a semicircle of radius $b$, which is $\\frac{1}{2}\\pi b^2$. Substituting this value:\n$$\nF_a = -2\\rho \\ddot{y}(t) \\left(\\frac{\\pi b^2}{2}\\right) = -(\\rho \\pi b^2) \\ddot{y}(t)\n$$\nThis hydrodynamic force is directly proportional to the structural acceleration $\\ddot{y}(t)$. This type of inertial force is characterized by an added mass, $m_a$, such that $F_a = -m_a \\ddot{y}(t)$. By comparing the expressions, we identify the added mass per unit span as:\n$$\nm_a = \\rho \\pi b^2\n$$\n\n2) Derivation of the exact continuous coupled equation of motion.\n\nThe equation of motion for the structural system is given by Newton's second law. The total force per unit span acting on the structure is the sum of the structural spring force, $F_k = -k y(t)$, and the hydrodynamic force, $F_a = -m_a \\ddot{y}(t)$. The equation for the structural mass per unit span $m_s$ is:\n$$\nm_s \\ddot{y}(t) = \\sum F_y = F_k + F_a = -k y(t) - m_a \\ddot{y}(t)\n$$\nRearranging the terms to the standard form for a second-order linear ordinary differential equation gives the coupled equation of motion:\n$$\nm_s \\ddot{y}(t) + m_a \\ddot{y}(t) + k y(t) = 0\n$$\n$$\n(m_s + m_a) \\ddot{y}(t) + k y(t) = 0\n$$\nThis is the exact continuous coupled equation of motion for the fluid-structure system under the given assumptions. The total inertial term is $(m_s + m_a) \\ddot{y}(t)$, where the total effective mass is the sum of the structural mass $m_s$ and the hydrodynamic added mass $m_a$.\n\n3) Analysis of the loosely coupled predictor-corrector scheme.\n\nThe problem defines a specific loosely coupled explicit scheme. We follow the steps to derive the resultant continuous-time equation.\nFirst, the structural acceleration is predicted by neglecting fluid forces:\n$$\na_{\\text{pred}}(t) = -\\frac{k}{m_s} y(t)\n$$\nNext, the fluid inertial force is calculated using this predicted acceleration:\n$$\nf_f(t) = -m_a a_{\\text{pred}}(t) = -m_a \\left(-\\frac{k}{m_s} y(t)\\right) = \\frac{m_a k}{m_s} y(t)\n$$\nFinally, this fluid force is applied to the structure to correct the acceleration, yielding the overall equation of motion for the numerical scheme:\n$$\nm_s \\ddot{y}(t) = -k y(t) + f_f(t)\n$$\nSubstituting the expression for $f_f(t)$:\n$$\nm_s \\ddot{y}(t) = -k y(t) + \\frac{m_a k}{m_s} y(t)\n$$\nRearranging into a single closed-loop equation for $y(t)$:\n$$\nm_s \\ddot{y}(t) + k y(t) - \\frac{m_a k}{m_s} y(t) = 0\n$$\n$$\nm_s \\ddot{y}(t) + k \\left(1 - \\frac{m_a}{m_s}\\right) y(t) = 0\n$$\nWe introduce the vacuum natural frequency squared, $\\omega_0^2 = k/m_s$, and the mass ratio, $\\mu = m_a/m_s$. Dividing the equation by $m_s$ yields the requested form:\n$$\n\\ddot{y}(t) + \\frac{k}{m_s} \\left(1 - \\frac{m_a}{m_s}\\right) y(t) = 0\n$$\n$$\n\\ddot{y}(t) + \\omega_0^2 (1 - \\mu) y(t) = 0\n$$\nThis is the equation of a simple harmonic oscillator with an effective natural frequency squared of $\\omega_{\\text{eff}}^2 = \\omega_0^2 (1 - \\mu)$. For the motion to be bounded (i.e., stable sinusoidal oscillations), the coefficient of the $y(t)$ term must be non-negative. If this coefficient were negative, the solution would involve real exponentials, leading to unbounded growth. Thus, the condition for bounded oscillations is:\n$$\n\\omega_{\\text{eff}}^2 \\geq 0 \\implies \\omega_0^2 (1 - \\mu) \\geq 0\n$$\nSince $\\omega_0^2 = k/m_s > 0$ for any physical system, the stability condition simplifies to:\n$$\n1 - \\mu \\geq 0 \\quad \\text{or} \\quad \\mu \\leq 1\n$$\nThe mass ratio must be less than or equal to one for the scheme to produce bounded oscillations.\n\n4) Determination of the maximum chord length, $c_{\\max}$.\n\nThe condition for bounded oscillations derived in part $3$ is $\\mu \\leq 1$, which translates to $m_a/m_s \\leq 1$, or $m_a \\leq m_s$.\nFrom part $1$, we have the expression for the added mass per unit span, $m_a = \\rho \\pi b^2$. Given that the semi-chord is $b = c/2$, we can write $m_a$ in terms of the chord $c$:\n$$\nm_a = \\rho \\pi \\left(\\frac{c}{2}\\right)^2 = \\frac{\\rho \\pi c^2}{4}\n$$\nSubstituting this into the stability condition:\n$$\n\\frac{\\rho \\pi c^2}{4} \\leq m_s\n$$\nThe maximum chord length, $c_{\\max}$, that permits bounded oscillations is found at the limit of this inequality:\n$$\n\\frac{\\rho \\pi c_{\\max}^2}{4} = m_s\n$$\nWe solve this equation for $c_{\\max}$:\n$$\nc_{\\max}^2 = \\frac{4 m_s}{\\rho \\pi}\n$$\n$$\nc_{\\max} = \\sqrt{\\frac{4 m_s}{\\rho \\pi}} = 2 \\sqrt{\\frac{m_s}{\\rho \\pi}}\n$$\nThis closed-form analytic expression gives the maximum allowable chord length in terms of the structural mass per unit span $m_s$ and the fluid density $\\rho$. The expression is dimensionally consistent and provides a result with units of length (meters in SI units).",
            "answer": "$$\n\\boxed{2 \\sqrt{\\frac{m_s}{\\rho \\pi}}}\n$$"
        },
        {
            "introduction": "Building upon the challenges of partitioned schemes, this practice moves from analysis to design and implementation. You are tasked with constructing a more sophisticated, symmetric staggered time-integration scheme, a method designed to enhance stability and reduce the 'splitting error' inherent in partitioned approaches. By implementing this algorithm and quantifying its performance against a fully-coupled monolithic solution, you will gain direct, hands-on experience in the verification and validation of computational aeroelasticity tools, a critical skill for any advanced practitioner in the field. ",
            "id": "3948890",
            "problem": "You are to design, analyze, and implement a staggered time-integration sequence for a linearized fluid-structure interaction model representative of computational aeroelasticity within Computational Fluid Dynamics (CFD). The goal is to minimize the splitting error attributable to partitioned time stepping and to quantify this error by comparison against a monolithic implicit scheme on a benchmark case.\n\nConsider a reduced-order, linearized aeroelastic model composed of a structural subsystem with one translational degree of freedom and an unsteady aerodynamic lag state. Let the structural displacement be $s(t)$, its velocity be $v(t) = \\dfrac{ds}{dt}$, and the aerodynamic lag state be $f(t)$. The system is governed by a linear Ordinary Differential Equation (ODE) of the form\n$$\n\\frac{d}{dt}\\begin{bmatrix} s \\\\ v \\\\ f \\end{bmatrix}\n=\nA \\begin{bmatrix} s \\\\ v \\\\ f \\end{bmatrix},\n$$\nwhere the matrix $A$ is built from the following physically meaningful linear relations derived from Newton's Second Law and a first-order aerodynamic lag model:\n- Structural dynamics: \n$$\nm \\, \\frac{d^2 s}{dt^2} + c \\, \\frac{ds}{dt} + k \\, s = L,\n$$\nwhere $m$ is mass, $c$ is damping, $k$ is stiffness, and $L$ is a linearized lift.\n- Linear unsteady aerodynamic model with a single lag state:\n$$\n\\tau \\, \\frac{df}{dt} = - f + a_1 \\, s + a_2 \\, \\frac{ds}{dt},\n$$\nand lift\n$$\nL = b_0 \\, f + b_1 \\, \\frac{ds}{dt} + b_2 \\, s.\n$$\nAssume non-dimensionalization such that $m = 1$. The corresponding state-space system matrix $A$ in the state ordering $x = [s, v, f]^T$ is\n$$\nA = \\begin{bmatrix}\n0  1  0 \\\\\n-(k - b_2)  -(c - b_1)  b_0 \\\\\na_1/\\tau  a_2/\\tau  -1/\\tau\n\\end{bmatrix}.\n$$\n\nUse the parameter values\n$$\nm = 1, \\quad c = 0.05, \\quad k = 1.0, \\quad b_0 = 0.8, \\quad b_1 = 0.2, \\quad b_2 = 0.0, \\quad a_1 = 0.5, \\quad a_2 = 0.1, \\quad \\tau = 0.2.\n$$\nUse the initial condition\n$$\ns(0) = 0.1, \\quad v(0) = 0.0, \\quad f(0) = 0.0,\n$$\nand a final time\n$$\nT = 5.0.\n$$\n\nTask 1 (Monolithic implicit reference): Starting from the general Backward Euler integration principle applied to linear ODEs, derive and implement the fully coupled implicit time-stepping update for the entire state $x$, advancing from $t_n$ to $t_{n+1} = t_n + \\Delta t$. This monolithic implicit scheme serves as the reference solution.\n\nTask 2 (Staggered scheme design): Partition the system into a structural subsystem with state $x_S = [s, v]^T$ and a fluid subsystem with state $x_F = [f]$. Let the block-partition of $A$ be\n$$\n\\frac{d}{dt} \\begin{bmatrix} x_S \\\\ x_F \\end{bmatrix}\n=\n\\begin{bmatrix}\nA_{SS}  A_{SF} \\\\\nA_{FS}  A_{FF}\n\\end{bmatrix}\n\\begin{bmatrix} x_S \\\\ x_F \\end{bmatrix}.\n$$\nDesign a symmetric staggered Gauss–Seidel sequence over each time step of size $\\Delta t$ that minimizes splitting error by symmetry:\n- advance the fluid subsystem by a half step while holding the structural state constant over that half step,\n- then advance the structural subsystem by a full step while holding the fluid state constant over that full step,\n- then advance the fluid subsystem by the remaining half step while holding the updated structural state constant over that half step.\n\nWithin each substep, use Backward Euler on the active subsystem while treating the other subsystem as frozen. Clearly formulate the resulting algebraic updates implied by this design, starting from the definitions above, without invoking any black-box formulas.\n\nTask 3 (Error quantification): For each prescribed time step $\\Delta t$, compute the splitting error at $t = T$ as the Euclidean norm of the difference between the staggered solution and the monolithic implicit reference solution:\n$$\nE(\\Delta t) = \\left\\| x_{\\text{staggered}}(T;\\Delta t) - x_{\\text{monolithic}}(T;\\Delta t) \\right\\|_2.\n$$\nUse this to quantify the splitting error.\n\nTest suite. Run the above for the following five cases, which together probe a coarse step, moderate steps, a fine step, and a decoupled edge case:\n- Case $1$: $\\Delta t = 0.5$, with the parameters as given above.\n- Case $2$: $\\Delta t = 0.25$, with the parameters as given above.\n- Case $3$: $\\Delta t = 0.10$, with the parameters as given above.\n- Case $4$: $\\Delta t = 0.05$, with the parameters as given above.\n- Case $5$ (decoupled edge case): $\\Delta t = 0.10$, with $b_0 = 0$, $a_1 = 0$, $a_2 = 0$ and all other parameters as given above.\n\nAll quantities are non-dimensional; no physical units are required. Angles do not appear. Percentages are not used.\n\nRequired program output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Cases $1$ through $5$, for example\n$$\n[\\;E(\\Delta t_1),E(\\Delta t_2),E(\\Delta t_3),E(\\Delta t_4),E(\\Delta t_5)\\;].\n$$",
            "solution": "The problem requires the design and analysis of a staggered time integration scheme for a linearized aeroelastic model, and the quantification of its splitting error against a monolithic implicit scheme. The model is a system of linear ordinary differential equations (ODEs), $\\frac{d}{dt}x = Ax$.\n\nFirst, the system matrix $A$ is constructed using the provided parameters. The physical parameters for the base case are $m=1$, $c=0.05$, $k=1.0$, $b_0=0.8$, $b_1=0.2$, $b_2=0.0$, $a_1=0.5$, $a_2=0.1$, and $\\tau=0.2$. With $m=1$, the state-space matrix $A$ for the state vector $x = [s, v, f]^T$ is:\n$$\nA = \\begin{bmatrix}\n0  1  0 \\\\\n-(k - b_2)  -(c - b_1)  b_0 \\\\\na_1/\\tau  a_2/\\tau  -1/\\tau\n\\end{bmatrix}\n= \\begin{bmatrix}\n0  1  0 \\\\\n-(1.0 - 0.0)  -(0.05 - 0.2)  0.8 \\\\\n0.5/0.2  0.1/0.2  -1/0.2\n\\end{bmatrix}\n= \\begin{bmatrix}\n0  1  0 \\\\\n-1  0.15  0.8 \\\\\n2.5  0.5  -5\n\\end{bmatrix}\n$$\nThe initial condition is $x(0) = [s(0), v(0), f(0)]^T = [0.1, 0.0, 0.0]^T$, and the simulations run until a final time of $T=5.0$.\n\n### Task 1: Monolithic Implicit Reference Scheme\n\nThe monolithic scheme solves the entire system simultaneously. We apply the Backward Euler method to the ODE system $\\frac{d}{dt}x = Ax$. The time derivative is approximated at the new time level $t_{n+1} = t_n + \\Delta t$:\n$$\n\\frac{x^{n+1} - x^n}{\\Delta t} = A x^{n+1}\n$$\nwhere $x^n$ is the state at time $t_n$ and $x^{n+1}$ is the state at $t_{n+1}$. To find the update rule, we rearrange the equation to solve for $x^{n+1}$:\n$$\nx^{n+1} - \\Delta t A x^{n+1} = x^n\n$$\n$$\n(I - \\Delta t A) x^{n+1} = x^n\n$$\nwhere $I$ is the $3 \\times 3$ identity matrix. The state at the next time step is thus found by solving this linear system:\n$$\nx^{n+1} = (I - \\Delta t A)^{-1} x^n\n$$\nThis update is applied iteratively, starting from $x(0)$, for $N = T/\\Delta t$ steps to find the state $x_{\\text{monolithic}}(T)$. The matrix $(I - \\Delta t A)^{-1}$ is computed once and reused for all time steps.\n\n### Task 2: Staggered Gauss-Seidel Scheme Design\n\nThe system is partitioned into a structural subsystem $x_S = [s, v]^T$ and a fluid subsystem $x_F = [f]$. The system matrix $A$ is correspondingly partitioned:\n$$\nA = \\begin{bmatrix} A_{SS}  A_{SF} \\\\ A_{FS}  A_{FF} \\end{bmatrix}\n$$\nUsing the base parameters, the submatrices are:\n$$\nA_{SS} = \\begin{bmatrix} 0  1 \\\\ -1  0.15 \\end{bmatrix}, \\quad\nA_{SF} = \\begin{bmatrix} 0 \\\\ 0.8 \\end{bmatrix}, \\quad\nA_{FS} = \\begin{bmatrix} 2.5  0.5 \\end{bmatrix}, \\quad\nA_{FF} = \\begin{bmatrix} -5 \\end{bmatrix}\n$$\nThe specified symmetric staggered sequence over a time step $\\Delta t$ from $t_n$ to $t_{n+1}$ consists of three substeps:\n\n**Substep 1: Advance Fluid by a half step ($\\Delta t/2$)**\n\nThe fluid state $x_F$ is advanced from $t_n$ to $t_n + \\Delta t/2$, while treating the structural state $x_S$ as fixed at its value at $t_n$, denoted $x_S^n$. The Backward Euler discretization of $\\frac{d}{dt}x_F = A_{FF} x_F + A_{FS} x_S$ over a step of size $\\Delta t / 2$ is:\n$$\n\\frac{x_F^{n+1/2} - x_F^n}{\\Delta t/2} = A_{FF} x_F^{n+1/2} + A_{FS} x_S^n\n$$\nSolving for the intermediate fluid state $x_F^{n+1/2}$:\n$$\n(I_F - \\frac{\\Delta t}{2} A_{FF}) x_F^{n+1/2} = x_F^n + \\frac{\\Delta t}{2} A_{FS} x_S^n\n$$\n$$\nx_F^{n+1/2} = (I_F - \\frac{\\Delta t}{2} A_{FF})^{-1} \\left( x_F^n + \\frac{\\Delta t}{2} A_{FS} x_S^n \\right)\n$$\nwhere $I_F$ is the $1 \\times 1$ identity.\n\n**Substep 2: Advance Structure by a full step ($\\Delta t$)**\n\nThe structural state $x_S$ is advanced from $t_n$ to $t_{n+1}$, while treating the fluid state $x_F$ as fixed at its updated intermediate value, $x_F^{n+1/2}$. The Backward Euler discretization of $\\frac{d}{dt}x_S = A_{SS} x_S + A_{SF} x_F$ over a step of size $\\Delta t$ is:\n$$\n\\frac{x_S^{n+1} - x_S^n}{\\Delta t} = A_{SS} x_S^{n+1} + A_{SF} x_F^{n+1/2}\n$$\nSolving for the new structural state $x_S^{n+1}$:\n$$\n(I_S - \\Delta t A_{SS}) x_S^{n+1} = x_S^n + \\Delta t A_{SF} x_F^{n+1/2}\n$$\n$$\nx_S^{n+1} = (I_S - \\Delta t A_{SS})^{-1} \\left( x_S^n + \\Delta t A_{SF} x_F^{n+1/2} \\right)\n$$\nwhere $I_S$ is the $2 \\times 2$ identity.\n\n**Substep 3: Advance Fluid by the remaining half step ($\\Delta t/2$)**\n\nFinally, the fluid state is advanced from its intermediate value $x_F^{n+1/2}$ to its final value $x_F^{n+1}$ at $t_{n+1}$. This substep uses the newly computed structural state $x_S^{n+1}$ as the fixed coupling term.\n$$\n\\frac{x_F^{n+1} - x_F^{n+1/2}}{\\Delta t/2} = A_{FF} x_F^{n+1} + A_{FS} x_S^{n+1}\n$$\nSolving for the final fluid state $x_F^{n+1}$:\n$$\n(I_F - \\frac{\\Delta t}{2} A_{FF}) x_F^{n+1} = x_F^{n+1/2} + \\frac{\\Delta t}{2} A_{FS} x_S^{n+1}\n$$\n$$\nx_F^{n+1} = (I_F - \\frac{\\Delta t}{2} A_{FF})^{-1} \\left( x_F^{n+1/2} + \\frac{\\Delta t}{2} A_{FS} x_S^{n+1} \\right)\n$$\nThe state at the end of the time step is $x^{n+1}$ formed by combining $x_S^{n+1}$ and $x_F^{n+1}$. This sequence is repeated for $N = T/\\Delta t$ steps to obtain $x_{\\text{staggered}}(T)$.\n\n### Task 3: Error Quantification\n\nThe splitting error for a given time step $\\Delta t$ is calculated as the Euclidean norm of the difference between the final state vectors from the two schemes:\n$$\nE(\\Delta t) = \\| x_{\\text{staggered}}(T;\\Delta t) - x_{\\text{monolithic}}(T;\\Delta t) \\|_2\n$$\nThis calculation is performed for all five test cases. For the decoupled case (Case 5), the coupling matrices $A_{SF}$ and $A_{FS}$ are zero matrices. Consequently, the physical subsystems are uncoupled. However, the splitting error is not identically zero. This is because the sequence of numerical operations for the fluid subsystem in the staggered scheme, $(I_F - \\frac{\\Delta t}{2} A_{FF})^{-1}$ applied twice, is not algebraically identical to the single monolithic operator $(I_F - \\Delta t A_{FF})^{-1}$. This difference in the numerical propagators for the uncoupled component leads to a small but non-zero splitting error.\n\nThe implementation calculates the final states for both monolithic and staggered schemes for each test case, computes the norm of their difference, and formats the results as requested.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the aeroelastic problem by comparing monolithic and staggered\n    time integration schemes and quantifying the splitting error.\n    \"\"\"\n\n    def run_simulations_and_get_error(params, dt, T, x0):\n        \"\"\"\n        Runs both monolithic and staggered simulations for a given case\n        and returns the splitting error.\n        \n        Args:\n            params (tuple): A tuple of physical parameters (m, c, k, ...).\n            dt (float): The time step size.\n            T (float): The final simulation time.\n            x0 (np.ndarray): The initial state vector, shape (3,1).\n        \n        Returns:\n            float: The computed splitting error E(dt).\n        \"\"\"\n        m, c, k, b0, b1, b2, a1, a2, tau = params\n\n        # Ensure tau is not zero to avoid division by zero\n        if tau == 0:\n            raise ValueError(\"Parameter tau cannot be zero.\")\n\n        # Construct the full system matrix A\n        A = np.array([\n            [0, 1, 0],\n            [-(k - b2), -(c - b1), b0],\n            [a1 / tau, a2 / tau, -1 / tau]\n        ], dtype=float)\n\n        num_steps = int(round(T / dt))\n\n        # --- Monolithic Implicit Simulation ---\n        I_3 = np.identity(3)\n        mono_update_matrix = np.linalg.inv(I_3 - dt * A)\n        \n        x_mono = np.copy(x0)\n        for _ in range(num_steps):\n            x_mono = mono_update_matrix @ x_mono\n\n        # --- Staggered Gauss-Seidel Simulation ---\n        A_SS = A[0:2, 0:2]\n        A_SF = A[0:2, 2:3]\n        A_FS = A[2:3, 0:2]\n        A_FF = A[2:3, 2:3]\n\n        I_2 = np.identity(2)\n        I_1 = np.identity(1)\n        \n        # Precompute matrix inverses for the staggered scheme\n        stag_fluid_inv = np.linalg.inv(I_1 - (dt / 2.0) * A_FF)\n        stag_struct_inv = np.linalg.inv(I_2 - dt * A_SS)\n\n        x_stag = np.copy(x0)\n        for _ in range(num_steps):\n            x_S_n = x_stag[0:2, :]\n            x_F_n = x_stag[2:3, :]\n\n            # 1. Fluid half-step\n            rhs_f1 = x_F_n + (dt / 2.0) * (A_FS @ x_S_n)\n            x_F_half = stag_fluid_inv @ rhs_f1\n\n            # 2. Structure full-step\n            rhs_s = x_S_n + dt * (A_SF @ x_F_half)\n            x_S_np1 = stag_struct_inv @ rhs_s\n\n            # 3. Fluid second half-step\n            rhs_f2 = x_F_half + (dt / 2.0) * (A_FS @ x_S_np1)\n            x_F_np1 = stag_fluid_inv @ rhs_f2\n            \n            x_stag = np.vstack((x_S_np1, x_F_np1))\n        \n        # --- Error Quantification ---\n        error = np.linalg.norm(x_stag - x_mono)\n        return error\n\n    # Define common parameters and initial conditions\n    base_params = (1.0, 0.05, 1.0, 0.8, 0.2, 0.0, 0.5, 0.1, 0.2)\n    decoupled_params = (1.0, 0.05, 1.0, 0.0, 0.2, 0.0, 0.0, 0.0, 0.2)\n    x0 = np.array([[0.1], [0.0], [0.0]], dtype=float)\n    T_final = 5.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'dt': 0.5, 'params': base_params},   # Case 1\n        {'dt': 0.25, 'params': base_params},  # Case 2\n        {'dt': 0.10, 'params': base_params},  # Case 3\n        {'dt': 0.05, 'params': base_params},  # Case 4\n        {'dt': 0.10, 'params': decoupled_params} # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        result = run_simulations_and_get_error(case['params'], case['dt'], T_final, x0)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}