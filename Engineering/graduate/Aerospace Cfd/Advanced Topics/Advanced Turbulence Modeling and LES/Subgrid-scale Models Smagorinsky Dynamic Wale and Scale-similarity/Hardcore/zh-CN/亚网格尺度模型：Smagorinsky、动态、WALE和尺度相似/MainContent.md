## 引言
[大涡模拟](@entry_id:153702)（Large-Eddy Simulation, LES）作为一种在计算精度与成本之间取得精妙平衡的湍流模拟技术，已成为[计算流体动力学](@entry_id:142614)（CFD）研究与工程应用中的重要支柱。LES的核心思想在于，直接解析对流动起主导作用的大尺度涡结构，而将影响较小但数量庞大的小尺度涡结构（即亚格子尺度，SGS）的效应通过模型来封闭。因此，[亚格子尺度模型](@entry_id:272550)的选择与构建，直接决定了LES模拟的物理保真度和预测准确性，构成了该方法论的基石与挑战。

本文旨在为读者提供一个关于主流[SGS模型](@entry_id:754720)的系统性深度指南，以填补从基础理论到高级应用之间的知识鸿沟。我们将系统地梳理从经典到前沿的各类[SGS模型](@entry_id:754720)，揭示其背后的物理思想与数学机制。

在“原理与机制”一章中，我们将追溯亚格子应力的起源，深入剖析作为封闭基础的[涡粘性假设](@entry_id:1124144)，并详细阐述[Smagorinsky模型](@entry_id:276289)、[WALE模型](@entry_id:1133933)、动态模型以及[尺度相似性模型](@entry_id:1131262)的构造、优缺点及内在联系。随后的“应用与跨学科连接”一章，将把这些理论模型置于航空航天、燃烧学、地球物理学等真实场景中，探讨它们在面对[近壁湍流](@entry_id:194167)、激波、[多物理场耦合](@entry_id:171389)等复杂现象时的适应性与挑战。最后，“动手实践”部分将通过精心设计的计算问题，帮助读者将理论知识转化为解决实际问题的能力。通过这一结构化的学习路径，本文将引导您深入理解SGS模型的世界，为您的学术研究和工程实践奠定坚实的基础。

## 原理与机制

在大涡模拟（Large-Eddy Simulation, LES）中，通过对纳维-斯托克斯（Navier-Stokes）方程进行[空间滤波](@entry_id:202429)，我们将流场分解为可解的大尺度运动和需要模化的亚格子尺度（subgrid-scale, SGS）运动。这种分解引入了未经封闭的项，其物理效应必须通过[亚格子尺度模型](@entry_id:272550)来[参数化](@entry_id:265163)。本章旨在深入探讨这些模型的基本原理和内在机制，从亚格子应力的起源，到[涡粘性假设](@entry_id:1124144)的建立，再到各类先进模型的具体构造与优缺点。

### 亚格子尺度应力的起源及其作用

对[不可压缩流](@entry_id:140301)动的[纳维-斯托克斯方程](@entry_id:142275)应用空间滤波（用上划线 $\bar{(\cdot)}$ 表示）是 LES 的出发点。当滤波算子作用于[非线性](@entry_id:637147)的对流项 $\overline{u_i u_j}$ 时，由于滤波与乘积运算通常不可交换（即 $\overline{u_i u_j} \neq \bar{u}_i \bar{u}_j$），一个未知的相关项便产生了。为了描述这种差异，我们定义了 **亚格子尺度应力张量 (subgrid-scale stress tensor)**：

$$
\tau_{ij} = \overline{u_i u_j} - \bar{u}_i \bar{u}_j
$$

这个对称的[二阶张量](@entry_id:199780) $\tau_{ij}$ 物理上代表了未解析的小尺度脉动对已解析的大尺度流[场动量](@entry_id:267786)的输运效应。将 $\overline{u_i u_j} = \bar{u}_i \bar{u}_j + \tau_{ij}$ 代入滤波后的[动量方程](@entry_id:197225)，我们得到：

$$
\frac{\partial \bar{u}_i}{\partial t} + \frac{\partial (\bar{u}_i \bar{u}_j)}{\partial x_j} = -\frac{1}{\rho}\frac{\partial \bar{p}}{\partial x_i} + \nu \frac{\partial^2 \bar{u}_i}{\partial x_j \partial x_j} - \frac{\partial \tau_{ij}}{\partial x_j}
$$

上式表明，亚格子[应力的散度](@entry_id:185633) $-\frac{\partial \tau_{ij}}{\partial x_j}$ 如同一种额外的体积力，作用于可解尺度流场，体现了小尺度[涡对](@entry_id:199153)大尺度涡的力学影响 。

与任何[二阶张量](@entry_id:199780)一样，$\tau_{ij}$ 可以分解为其 **各向同性 (isotropic)** 部分和 **偏（或各向异性）(deviatoric)** 部分：

$$
\tau_{ij} = \tau_{ij}^{d} + \frac{1}{3}\tau_{kk}\delta_{ij}
$$

其中，$\tau_{ij}^{d}$ 是[偏应力张量](@entry_id:267642)，满足 $\text{tr}(\tau^d) = 0$。迹 $\tau_{kk} = \overline{u_k u_k} - \bar{u}_k \bar{u}_k$ 并非为零；实际上，亚格子动能 $k_{sgs} = \frac{1}{2}\tau_{kk}$ 是一个关键的物理量，代表了未解析尺度中所含的动能。在不可压缩流的[动量方程](@entry_id:197225)中，各向同性部分的散度 $\frac{1}{3}\frac{\partial \tau_{kk}}{\partial x_i}$ 可以与压力梯度项合并，形成一个修正后的滤波压力 $P^* = \bar{p} + \frac{1}{3}\rho\tau_{kk}$ 的梯度 。因此，SGS 建模的核心挑战通常在于对[偏应力张量](@entry_id:267642) $\tau_{ij}^{d}$ 进行封闭。

亚格子应力的另一个关键作用体现在可解尺度动能的收支平衡中。通过推导可解尺度动能 $k_{res} = \frac{1}{2}\bar{u}_i\bar{u}_i$ 的[输运方程](@entry_id:174281)，可以识别出与 SGS 效应相关的能量转移项 。该项，通常被称为 **SGS 耗散 (SGS dissipation)** 或 **SGS 产生 (SGS production)**，定义为：

$$
\Pi = -\tau_{ij} \bar{S}_{ij}
$$

其中 $\bar{S}_{ij} = \frac{1}{2}(\frac{\partial \bar{u}_i}{\partial x_j} + \frac{\partial \bar{u}_j}{\partial x_i})$ 是 **可解尺度[应变率张量](@entry_id:266108) (resolved-scale strain-rate tensor)**。这一项描述了可解尺度通过应变场对亚格子应力做功的速率。如果 $\Pi > 0$，表示能量从可解尺度流向亚格子尺度，这对应于[湍流](@entry_id:151300)中经典的 **正向能量级串 (forward energy cascade)**。如果 $\Pi  0$，则表示能量从亚格子尺度返回到可解尺度，这一过程被称为 **能量反传 (backscatter)**。一个物理上完备的 SGS 模型应该能够准确地描述这种能量交换。

### [涡粘性假设](@entry_id:1124144)：一种基础性的封闭策略

由于 $\tau_{ij}$ 的精确形式未知，我们需要一个封闭模型将其与可解尺度量 $\bar{u}_i$ 联系起来。最广泛应用的封闭策略是 **[涡粘性假设](@entry_id:1124144) (eddy-viscosity hypothesis)**，它借鉴了分子粘性[应力与应变率](@entry_id:263123)之间的线性关系（[牛顿流体](@entry_id:263796)本构关系）。该假设将 SGS [偏应力张量](@entry_id:267642)与可解尺度应变率张量联系起来：

$$
\tau_{ij}^{d} = -2\nu_t \bar{S}_{ij}
$$

其中，$\nu_t$ 是一个标量，称为 **亚格子涡粘性系数 (SGS eddy viscosity)**，它本身需要被模化。这个模型形式简洁且具有良好的物理直觉：小尺度涡的动量输运效应类似于增加了流体的有效粘性。

任何物理上合理的 SGS 模型都必须满足一些基本的不变性要求 。
1.  **伽利略不变性 (Galilean Invariance)**：模型预测的 SGS 应力不应随参考系的匀速平移而改变。这意味着模型不能直接依赖于可解速度场 $\bar{u}_i$ 本身，而应依赖于其梯度，因为速度梯度在伽利略变换下是不变的。
2.  **坐标[旋转不变性](@entry_id:137644) (Frame-Rotation Invariance/Objectivity)**：本构关系的形式不应依赖于观察者坐标系的刚性旋转。这要求模型必须由 **客观张量 (objective tensors)**（如 $\bar{S}_{ij}$ 和旋转率张量 $\bar{\Omega}_{ij}$）和 **客观标量 (objective scalars)** 构建。涡粘性系数 $\nu_t$ 必须是一个客观标量，这意味着它只能由 $\bar{S}_{ij}$ 和 $\bar{\Omega}_{ij}$ 的[标量不变量](@entry_id:193787)（如 $\bar{S}_{mn}\bar{S}_{mn}$）构成。

基于这些原则，一个诸如 $\tau_{ij} \propto \frac{\partial \bar{u}_i}{\partial x_j}$ 的模型是无效的，因为它不保证对称性；一个诸如 $\tau_{ij}^{d} \propto \bar{\Omega}_{ij}$ 的模型也是无效的，因为它将[对称张量与反对称张量](@entry_id:194720)等同起来 。

[涡粘性假设](@entry_id:1124144)对能量级串有直接影响。将 $\tau_{ij}^{d} = -2\nu_t \bar{S}_{ij}$ 代入 SGS 耗散的表达式（对于[不可压缩流](@entry_id:140301)，$\tau_{ij}\bar{S}_{ij} = \tau_{ij}^d \bar{S}_{ij}$），我们得到：

$$
\Pi = -(-2\nu_t \bar{S}_{ij}) \bar{S}_{ij} = 2\nu_t \bar{S}_{ij}\bar{S}_{ij}
$$

由于 $\bar{S}_{ij}\bar{S}_{ij} \ge 0$ 恒成立，只要涡粘性系数 $\nu_t$ 被模化为非负值（$\nu_t \ge 0$），SGS 耗散 $\Pi$ 就将永远是非负的。这意味着这类模型本质上是纯耗散的，它们只能描述从大尺度到小尺度的能量正向传递，而无法捕捉物理上存在的能量反传现象 。

### Smagorinsky 模型：与 Kolmogorov 理论的联系

最经典的[涡粘性模型](@entry_id:1124145)是 **Smagorinsky 模型**。它为涡粘性系数 $\nu_t$ 提供了一个具体的代数表达式。该模型的推导精妙地将 LES 滤波尺度与 Kolmogorov 的[湍流](@entry_id:151300)[惯性子区](@entry_id:273327)理论联系起来 。

推导的核心思想是 **[局部平衡假设](@entry_id:182180) (local equilibrium assumption)**，即在滤波尺度 $\Delta$ 上，SGS 能量的产生率 $\Pi$ 与[湍流](@entry_id:151300)能量的平均[耗散率](@entry_id:748577) $\epsilon$ 相平衡，即 $\Pi \approx \epsilon$。结合[涡粘性模型](@entry_id:1124145)的能量耗散公式，我们有 $2\nu_t |\bar{S}|^2 \approx \epsilon$，其中 $|\bar{S}| = \sqrt{2\bar{S}_{ij}\bar{S}_{ij}}$ 是应变率张量的大小。

另一方面，根据 Kolmogorov 的[惯性子区](@entry_id:273327)[标度律](@entry_id:266186)，与尺度 $\ell$ 相关的特征应变率大小为 $\epsilon^{1/3}\ell^{-2/3}$。在 LES 中，最主要的应变来自于最小的可解尺度，即滤波尺度 $\Delta$。因此，我们可以估计 $|\bar{S}| \sim \epsilon^{1/3}\Delta^{-2/3}$。将此关系代入局部平衡表达式中求解 $\epsilon$，再代回，可以反解出 $\nu_t$：

$$
\nu_t \sim \frac{\epsilon}{|\bar{S}|^2} \sim \frac{(|\bar{S}| \Delta^{2/3})^3}{|\bar{S}|^2} = |\bar{S}| \Delta^2
$$

引入一个无量纲常数 $C_s$（Smagorinsky 常数），我们便得到了 Smagorinsky 模型的[标准形式](@entry_id:153058)：

$$
\nu_t = (C_s \Delta)^2 |\bar{S}|
$$

这个形式与基于[混合长度理论](@entry_id:752030)的物理直觉 $\nu_t \sim u' l$ 完全一致。若取特征长度为 $l=\Delta$，[特征速度](@entry_id:165394)为 $u' \sim (\epsilon \Delta)^{1/3}$，则 $\nu_t \sim \Delta (\epsilon\Delta)^{1/3} = \epsilon^{1/3}\Delta^{4/3}$。将 Smagorinsky 模型代入此关系，$\nu_t = (C_s\Delta)^2 |\bar{S}| \sim \Delta^2 (\epsilon^{1/3}\Delta^{-2/3}) = \epsilon^{1/3}\Delta^{4/3}$，两者完美自洽 。

然而，尽管 Smagorinsky 模型理论优美且应用广泛，它有两个众所周知的严重缺陷。

**1. [近壁区](@entry_id:1128462)行为不当**：在靠近无滑移壁面的区域，[湍流](@entry_id:151300)脉动必须消失。对近壁流动的[运动学分析](@entry_id:1126917)表明，真实的[湍流](@entry_id:151300)应力（如雷诺剪应力 $-\overline{u'v'}$）随着与壁面距离 $y$ 的三次方 ($y^3$) 趋于零。为了使[涡粘性模型](@entry_id:1124145) $\tau_{12}^{sgs} \approx -2\nu_t \bar{S}_{12}$ 与此行为一致，考虑到近壁处平均剪切率 $\bar{S}_{12}$ 接近一个有限的非零常数，涡粘性系数 $\nu_t$ 必须满足 $\nu_t \sim \mathcal{O}(y^3)$ 的[标度律](@entry_id:266186) 。然而，标准的 Smagorinsky 模型（假设滤波宽度 $\Delta$ 不随 $y$ 变化）预测 $\nu_t \propto |\bar{S}| \sim \mathcal{O}(y^0)$，即在壁面上产生一个错误的有限粘性。这迫使研究者必须引入诸如 van Driest [阻尼函数](@entry_id:1123370)之类的特设 (ad-hoc) 修正来强制 $\nu_t$ 在壁面处归零。

**2. 强制的应力-应变对准**：作为一个各向同性[涡粘性模型](@entry_id:1124145)，Smagorinsky 模型设定 $\tau_{ij}^d$ 与 $\bar{S}_{ij}$ 成正比。这在几何上意味着，模化出的 SGS 应力张量的[主轴](@entry_id:172691)方向必须与可解尺度应变率张量的[主轴](@entry_id:172691)方向完全一致。然而，对真实[湍流](@entry_id:151300)数据的分析表明，这两个张量的[主轴](@entry_id:172691)之间存在显著的错位 (misalignment)，这反映了[湍流](@entry_id:151300)结构的复杂性。所有各向同性[涡粘性模型](@entry_id:1124145)，通过其本构形式，都无法捕捉这种重要的物理特性 。

### 先进[涡粘性模型](@entry_id:1124145)：应对局限性

为了克服 Smagorinsky 模型的缺陷，研究者们发展了多种更为先进的[涡粘性模型](@entry_id:1124145)。

#### WALE 模型

**壁面自适应局部涡粘性 (Wall-Adapting Local Eddy-viscosity, WALE)** 模型旨在修正 Smagorinsky 模型在近壁区的错误行为，且无需引入特设的[阻尼函数](@entry_id:1123370) 。其核心思想是构造一个对流场旋转敏感的涡粘性系数。

WALE 模型同样采用 $\tau_{ij}^d = -2\nu_t \bar{S}_{ij}$ 的形式，但其 $\nu_t$ 的构造极为巧妙。它基于[速度梯度张量](@entry_id:270928) $g_{ij} = \partial \bar{u}_i / \partial x_j$ 的平方的对称无迹部分：

$$
S_{ij}^d = \frac{1}{2}(g_{ik}g_{kj} + g_{jk}g_{ki}) - \frac{1}{3}\delta_{ij} g_{lk}g_{lk}
$$

这个张量 $S_{ij}^d$ 结合了[应变率](@entry_id:154778) $S_{ij}$ 和旋转率 $\Omega_{ij}$ 的信息，因为可以证明 $\frac{1}{2}(g_{ik}g_{kj} + g_{jk}g_{ki}) = S_{ik}S_{kj} + \Omega_{ik}\Omega_{kj}$ 。涡粘性系数 $\nu_t$ 被构造成与 $S_{ij}^d$ 的不变量成正比，当且仅当 $S_{ij}^d$ 不为零时，$\nu_t$ 才不为零。

WALE 模型的精妙之处在于 $S_{ij}^d$ 在不同[流态](@entry_id:152820)下的表现。
- 在**纯平面[剪切流](@entry_id:266817)**中（如[近壁区](@entry_id:1128462)的线性子层，$\bar{u}=(ay, 0)$），[速度梯度张量](@entry_id:270928) $g$ 是幂零的（$g^2 = 0$），这直接导致 $S_{ij}^d = 0$。
- 在**纯二维[刚体](@entry_id:1131033)旋转**中（$\bar{\mathbf{u}} = \boldsymbol{\omega} \times \mathbf{r}$），[速度梯度张量](@entry_id:270928)的平方 $g^2$ 是一个[各向同性张量](@entry_id:195105)（$g^2 = -\omega^2 \delta$），其无迹部分 $S_{ij}^d$ 也精确为零 。

由于近壁流既是强[剪切流](@entry_id:266817)，又缺少三维涡旋结构，WALE 模型的 $\nu_t$ 能自动地、正确地以 $\mathcal{O}(y^3)$ 的方式趋于零，从而解决了 Smagorinsky 模型的近壁问题。尽管如此，WALE 仍然是一个各向同性[涡粘性模型](@entry_id:1124145)，因此它仍然强制应力与应变主轴对准，无法解决前述的第二类局限性 。

#### 动态模型

**动态模型 (dynamic models)** 提供了一种截然不同的改进思路。它不再预设模型常数（如 $C_s$），而是利用流场在不同尺度上的信息来“动态地”计算它。该过程引入一个比网格滤波 $\bar{(\cdot)}$ 更宽的 **测试滤波 (test filter)** $\hat{(\cdot)}$。通过应用这两种滤波，可以得到一个在理论上精确的代数关系式，即 **Germano 恒等式**。

这个恒等式将可解尺度上的量与两个不同尺度的 SGS 模型联系起来。通过假设模型形式在网格尺度和测试尺度之间保持不变（即所谓的尺度不变性），就可以为模型系数（如 $C_s^2$）导出一个代数方程。解出这个方程，就可以得到一个随空间和时间变化的系数 $C_s^2(\mathbf{x}, t)$ 。

动态程序带来了两个革命性的变化：
1.  它能自动为不同类型的流（如层流、[剪切流](@entry_id:266817)、[自由湍流](@entry_id:194275)）和流动的不同区域（如[近壁区](@entry_id:1128462)、[对数律区](@entry_id:264342)）确定合适的模型系数。例如，在近壁区，动态程序能自动给出趋于零的系数，从而正确地“关闭”模型。
2.  计算出的系数 $C_s^2$ 可以是**负值**。负的 $C_s^2$ 意味着负的涡粘性 $\nu_t$，这使得模型能够描述能量反传（$\Pi  0$）。

然而，负的 $\nu_t$ 是一把双刃剑。虽然它在物理上是可取的，但在数值上却可能导致灾难。动量方程中的总粘性项为 $(\nu + \nu_t)\nabla^2 \bar{u}_i$。如果 $\nu_t$ 的负值过大，使得总有效粘性 $\nu_{eff} = \nu + \nu_t$ 变为负，那么扩散项就会变成“反扩散”项，导致数值解的无界增长和崩溃 。

因此，动态模型的实际应用必须辅以稳定化策略。一些常见的策略包括：
- **硬性截断 (Hard Clipping)**：简单地将负的 $C_s^2$ 设为零。这种方法虽然能保证稳定，但完全抛弃了模型预测的能量反传物理，是一种不推荐的特设修正。
- **下限限制 (Lower Bounding)**：允许 $C_s^2$ 为负，但限制其大小，保证总有效粘性非负，即 $\nu + \nu_t \ge 0$。这是一种务实的折衷，保留了部分能量反传，同时确保了[数值稳定性](@entry_id:175146)。
- **拉格朗日平均 (Lagrangian Averaging)**：不直接使用瞬时、局地的 $C_s^2$ 值，而是在流体[质点](@entry_id:186768)的路径上进行[时间平均](@entry_id:267915)。这种方法能有效平滑掉系数场中剧烈的、非物理的振荡，同时保留了在统计意义上的能量反传，特别适用于[非均匀流](@entry_id:262867)。

值得注意的是，动态程序虽然改进了涡粘性的大小和符号，但并未改变模型的本构形式，因此它依然属于各向同性[涡粘性模型](@entry_id:1124145)，无法解决应力-应变错位的问题 。

### [尺度相似性模型](@entry_id:1131262)：一种结构性方法

**[尺度相似性模型](@entry_id:1131262) (scale-similarity models)** 提供了一种与[涡粘性假设](@entry_id:1124144)完全不同的建模哲学。其核心思想是 **[尺度相似性](@entry_id:754548)假设**，即最大尺度的亚格子运动（尺度略小于 $\Delta$）在结构上应与最小尺度的可解运动（尺度略大于 $\Delta$）相似。

基于此，Bardina 提出了一个模型，用可解尺度速度场构建的应力来近似真实的 SGS 应力。具体而言，它使用在测试滤波尺度上定义的 **Leonard 应力** $L_{ij} = \widehat{\bar{u}_i \bar{u}_j} - \hat{\bar{u}}_i \hat{\bar{u}}_j$ 来模化 SGS 应力：

$$
\tau_{ij}^{\text{B}} \approx C_B L_{ij}
$$

其中 $C_B$ 是一个模型常数 。

[尺度相似性模型](@entry_id:1131262)具有显著的优点：
- **结构准确性**：由于 $\tau_{ij}^{\text{B}}$ 是由速度的二次乘积直接构造的，它不是 $\bar{S}_{ij}$ 的标量倍数。因此，它能够很好地预测真实 SGS 应力的各向异性，并能再现应力与应变主轴之间的错位 。
- **內禀的能量反传**：模型产生的 SGS 耗散 $\Pi = -C_B L_{ij}\bar{S}_{ij}$ 的符号是不确定的，取决于 $L_{ij}$ 和 $\bar{S}_{ij}$ 之间的局部相关性。这使得模型能够自然地描述能量反传。

然而，其最大的缺点是 **耗散不足**。纯粹的[尺度相似性模型](@entry_id:1131262)通常无法提供足够的[能量耗散](@entry_id:147406)来吸收从大尺度级串下来的能量，从而导致能量在网格[截断尺度](@entry_id:748127)附近堆积，引发数值不稳定。

为了扬长避短，最成功的应用方式是 **混合模型 (mixed models)**。它将具有良好结构特性的[尺度相似性](@entry_id:754548)项与提供稳定耗散的涡粘性项结合起来：

$$
\tau_{ij}^{\text{mix}} = \tau_{ij}^{\text{sim}} - 2\nu_t \bar{S}_{ij}
$$

其中 $\tau_{ij}^{\text{sim}}$ 是[尺度相似性](@entry_id:754548)部分，而 $\nu_t$ 通常由动态程序确定。这种混合方法结合了两种模型的优点：[尺度相似性](@entry_id:754548)部分负责准确描述应力结构和能量反传，而动态涡粘性部分则确保了整体模型的[数值鲁棒性](@entry_id:188030)和正确的平均耗散水平 。

例如，考虑一个[混合模型](@entry_id:266571)，其 SGS 产生由涡粘性部分 $P_{EV}$ 和[尺度相似性](@entry_id:754548)部分 $P_{SS}$ 构成。在某一点，即使[尺度相似性](@entry_id:754548)部分预测了显著的能量反传（$P_{SS}  0$），耗散性的涡粘性部分（$P_{EV} > 0$）仍然可以保证总的能量传递是净耗散的（$P_{SGS} = P_{EV} + P_{SS} > 0$），从而维持模拟的稳定 。