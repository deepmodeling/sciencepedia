## 引言
在航空航天等领域，高雷诺数[湍流](@entry_id:151300)是普遍存在的现象，对飞行器的性能与安全至关重要。精确预测这些流动，特别是涉及大规模分离的[复杂流动](@entry_id:747569)，是计算流体力学（CFD）面临的核心挑战。一方面，直接数值模拟（DNS）或壁面解析大涡模拟（LES）因其对计算资源的极端要求而难以应用于工程实际；另一方面，计算成本低廉的[雷诺平均](@entry_id:754341)Navier-Stokes（RANS）方法在处理大规模非定常[分离流](@entry_id:754694)时，其精度往往不足。这一在精度与效率之间的巨大鸿沟，催生了[混合RANS-LES方法](@entry_id:750434)的发展。

[分离涡模拟](@entry_id:1123593)（Detached Eddy Simulation, DES）正是为了解决这一难题而提出的一种开创性方法。它巧妙地结合了RANS和LES的优点，旨在以可行的计算成本捕捉控制流动动态的关键非定常结构。本文将系统地引导读者深入理解DES方法的全貌。在第一章“**原理与机制**”中，我们将从[湍流](@entry_id:151300)尺[度理论](@entry_id:636058)出发，剖析DES诞生的动机，详细阐释其从DES97到DDES和IDDES的演进脉络、核心数学构造以及关键缺陷与改进。随后的“**应用与跨学科联系**”一章将通过航空航天、流体工程乃至生物力学等领域的丰富实例，展示DES在解决前沿问题中的强大能力与实践策略。最后，通过“**动手实践**”部分提供的具体问题，读者将有机会检验并巩固对DES核心概念的理解。通过本次学习，您将掌握这一先进湍流模拟工具的理论精髓与应用之道。

## 原理与机制

### 尺度分离问题与[混合方法](@entry_id:163463)的理论基础

在高雷诺数（$Re$）的航空航天流动中，[湍流](@entry_id:151300)现象是普遍存在的，其特点是跨越多个数量级的时空尺度。理解这些尺度之间的关系是发展有效计算流体力学（CFD）方法的关键。[湍流](@entry_id:151300)能量串级理论，特别是 Kolmogorov 的经典唯象理论，为我们提供了分析这一问题的基本框架。

[湍流](@entry_id:151300)中的能量主要由大尺度涡（积分尺度，$L$）从平均流中获取。这些大尺度涡是不稳定的，它们会破碎成更小的涡，并将能量传递下去。这个过程逐级进行，直到能量到达一个足够小的尺度，即 **Kolmogorov 微尺度**（$\eta$），在这个尺度上，粘性效应变得占主导地位，湍动能最终被耗散为内能。在[高雷诺数流](@entry_id:1126089)动中，一个关键的假设是，在[惯性子区](@entry_id:273327)（即尺度远小于 $L$ 但远大于 $\eta$ 的范围），能量[传递率](@entry_id:756124) $\varepsilon$ 在尺度间近似恒定。对于一个[特征速度](@entry_id:165394)为 $U$、特征长度为 $L$ 的宏观流动，单位质量的[平均能量](@entry_id:145892)[耗散率](@entry_id:748577)可尺度分析为 $\varepsilon \sim U^3/L$。

基于此，Kolmogorov 推导出 $\eta$ 与宏观流动参数的关系。已知 $\eta$ 的定义为 $\eta = (\nu^3/\varepsilon)^{1/4}$，其中 $\nu$ 是流体的运动粘度。将 $\varepsilon$ 的尺度关系代入，我们可以得到 $\eta$ 与雷诺数 $Re = UL/\nu$ 的关系：
$$
\frac{\eta}{L} \sim \left( \frac{\nu^3 L}{U^3 L^4} \right)^{1/4} = \left( \left( \frac{\nu}{UL} \right)^3 \right)^{1/4} = (Re^{-3})^{1/4} = Re^{-3/4}
$$
这个 $Re^{-3/4}$ 的 scaling 律揭示了一个严峻的计算挑战 。对于典型的航空航天应用，例如飞机巡航，雷诺数 $Re$ 远大于 $10^6$。以 $Re = 10^7$ 为例，Kolmogorov 尺度与流动特征尺度的比值为 $\eta/L \sim (10^7)^{-3/4} \approx 10^{-5.25}$，这意味着最小的[湍流](@entry_id:151300)涡尺度比飞机本身小五个数量级以上。

[直接数值模拟](@entry_id:149543)（DNS）的目标是解析从 $L$ 到 $\eta$ 的所有[湍流](@entry_id:151300)尺度，其所需的网格点数 $N$ 大致与 $(L/\eta)^3$ 成正比，即 $N \sim (Re^{3/4})^3 = Re^{9/4}$。对于 $Re = 10^7$，这需要 $10^{15}$ 以上的网格点，远远超出了当前及可预见的未来计算能力。即使是旨在解析附着边界层内主要含能涡的[壁面解析大涡模拟](@entry_id:1133937)（Wall-Resolved LES, [WRLES](@entry_id:1133937)），由于[近壁区](@entry_id:1128462)[湍流](@entry_id:151300)结构的尺度同样非常小，其计算代价也常常令人望而却步。

另一方面，对于一个拥有 $N$ 个控制体的三维计算网格，其能够解析的最小尺度由网格间距 $\Delta$ 决定。对于均匀网格，$\Delta$ 与总网格数的关系为 $\Delta \sim L N^{-1/3}$。对于目前最先进的全机气动计算所使用的网格规模（$N \sim 10^8$ 到 $10^9$），可实现的最小解析尺度与特征长度之比为 $\Delta/L \sim (10^9)^{-1/3} = 10^{-3}$。

对比物理需求与计算能力，我们发现 $\eta \ll \Delta$。这意味着在可行的计算成本下，我们无法解析所有[湍流](@entry_id:151300)尺度，特别是近壁区的耗散尺度。这一根本性的尺度分离问题正是 **混合 RANS-LES 方法** 发展的原动力。其核心思想是：在流动中尺度差异极大的不同区域采用不同的建模策略。
*   在靠近壁面的附着边界层内，[湍流](@entry_id:151300)尺度极小，计算成本高昂，因此采用 **雷诺平均 Navier-Stokes (RANS)** 方法。RANS 对所有[湍流](@entry_id:151300)脉动进行模化，只求解统计平均后的流场，计算成本低廉。
*   在远离壁面的区域，特别是存在大尺度流场分离的区域（如尾流区、[失速](@entry_id:186882)[翼型](@entry_id:195951)后的分离区），[湍流](@entry_id:151300)的主要含能结构尺度较大（与几何特征尺寸相当），网格足以解析它们。在这些区域，采用 **大涡模拟 (LES)** 方法，直接计算这些大尺度非定常涡的运动，而只对小于网格尺度的亚格子尺度涡进行模化。

**[分离涡模拟](@entry_id:1123593) (Detached Eddy Simulation, DES)** 正是实现这一思想的开创性方法。

### [分离涡模拟](@entry_id:1123593)（DES）的基本原理与工作模式

DES 的设计初衷是成为一种能够根据流动区域特性，在 RANS 和 LES 两种模式间自动切换的统一模型 。

*   **RANS 模式**：在附着边界层内，DES 旨在像一个标准的 RANS 模型一样工作。在这里，[计算网格](@entry_id:168560)通常在壁面法向很密，但在流向和展向较粗。DES 的构造使其能够识别这种近壁环境，并采用 RANS 的封闭方式。这意味着模型的目标是求解定常或非定常的平均流场（$\bar{u}_i$），而整个[湍流](@entry_id:151300)谱的能量，包括边界层内的大尺度含能涡，都通过[雷诺应力模型](@entry_id:198103)（例如，基于[涡粘性假设](@entry_id:1124144)的 $\tau_{ij}^{R} = - \rho \overline{u_i' u_j'}$）被“模化”掉。

*   **LES 模式**：当流动进入大尺度非定常区域，如[翼型](@entry_id:195951)失速后的大面积分离区或钝体尾流，DES 会切换到 LES 模式。在这里，流体运动被分解为通过网格过滤得到的解析尺度部分（$\tilde{u}_i$）和亚格子尺度部分（$u_i^{\mathrm{sgs}}$）。模拟直接计算大尺度涡的瞬时运动，这些涡的尺度大于当地的网格过滤器宽度 $\Delta$。而小于 $\Delta$ 的小尺度涡的影响则通过亚格子应力模型（$\tau_{ij}^{\mathrm{sgs}}$）来模化。因此，在 LES 区域，DES 能够捕捉到控制流动动态的关键非定常结构。

将 DES 与另一种主流的[混合方法](@entry_id:163463)——**壁面模化大涡模拟 (Wall-Modeled LES, [WMLES](@entry_id:1133936))**——进行对比，有助于进一步廓清其本质 。WMLES 的哲学是，在整个计算域中都求解 LES（滤波后的）方程，但它回避了直接解析[近壁区](@entry_id:1128462)的成本。它通过在壁面处应用一个“[壁面模型](@entry_id:756612)”而非传统的[无滑移边界条件](@entry_id:186229)来实现这一点。该壁面模型根据外层 LES 流场的信息来估算[壁面剪切应力](@entry_id:263108)，并将其作为边界条件反馈给 LES 求解器。因此，[WMLES](@entry_id:1133936) 是一个场外耦合（LES + [壁面边界条件](@entry_id:756608)）的策略。相比之下，DES 是一个场内混合（in-field hybrid）的策略：它是一个单一的[湍流模型](@entry_id:190404)方程，其自身的项会根据局部流场和网格信息改变形式，从而在附着边界层内表现为 RANS 模型，在分离区表现为 LES 的[亚格子模型](@entry_id:755588)。

### DES 的核心机制：DES97 公式

DES 的 RANS-LES 切换是如何通过一个统一的数学公式实现的呢？最初的 DES97 方法  是在 Spalart-Allmaras (SA) RANS 模型的基础上提出的，这个例子最能清晰地阐明其核心机制。

SA 模型是一个求解输运方程的[单方程模型](@entry_id:275708)，其求解变量 $\tilde{\nu}$ 与涡粘性 $\nu_t$ 相关。标准 SA 模型的[输运方程](@entry_id:174281)可以概括为：
$$
\frac{D\tilde{\nu}}{Dt} = \text{生成项} - \text{破坏项} + \text{扩散项}
$$
其中，**破坏项** 对模型的长度尺度最为敏感，其形式正比于 $(\tilde{\nu}/d)^2$，这里的 $d$ 是到最近壁面的距离。在附着边界层的[对数律区](@entry_id:264342)，当生成与破坏达到平衡时，这个以 $d$ 为基础的破坏项能够确保涡粘性具有正确的近壁行为，从而得到正确的速度剖面。可以说，$d$ 在这里充当了 RANS 模型的[湍流](@entry_id:151300)长度尺度。

DES97 的革命性思想就是修改这个长度尺度。它定义了一个新的 DES 长度尺度 $d_{DES}$：
$$
d_{DES} = \min(d, C_{DES}\Delta)
$$
其中，$C_{DES}$ 是一个校准常数（对于 SA 模型通常为 $0.65$），$\Delta$ 是一个代表当地网格尺度的量。在各向异性网格中，$\Delta$ 被定义为网格单元在三个方向上的最大边长，即 $\Delta = \max(\Delta_x, \Delta_y, \Delta_z)$。

然后，DES97 **仅将 SA 模型破坏项中的 $d$ 替换为 $d_{DES}$**。这个简单的替换就构建了一个巧妙的开关：

*   **[近壁区](@entry_id:1128462) (RANS 模式)**：在附着边界层内部，壁面距离 $d$ 很小。如果网格设计得当（即流向和展向网格较粗），通常会有 $d \lt C_{DES}\Delta$。此时，$d_{DES} = \min(d, C_{DES}\Delta) = d$。模型方程恢复为原始的 SA RANS 形式，其长度尺度由壁面距离 $d$ 控制。

*   **远场/分离区 (LES 模式)**：在远离壁面的区域或大[尺度分离](@entry_id:270204)区，$d$ 的值很大。如果网格在这些区域被加密以解析非定常结构，通常会有 $C_{DES}\Delta \lt d$。此时，$d_{DES} = \min(d, C_{DES}\Delta) = C_{DES}\Delta$。模型的破坏项变为正比于 $(\tilde{\nu}/(C_{DES}\Delta))^2$。这使得 SA 方程的行为从一个 RANS 模型转变为一个亚格子尺度（SGS）模型，其涡粘性的长度尺度与网格尺度 $\Delta$ 成正比。这正是 LES 中 SGS 模型所需要的特性。

通过这个依赖于壁面距离和网格尺度的 $\min$ 函数，DES97 在一个统一的方程框架内实现了 RANS 和 LES 行为的自动切换。

### 基本缺陷：模化应力耗失（MSD）与“灰色区域”

尽管 DES97 的设计非常巧妙，但它很快暴露出一个严重的缺陷，即 **模化应力耗失 (Modeled-Stress Depletion, MSD)**，有时也被称为[网格诱导分离](@entry_id:750057) (Grid-Induced Separation, GIS) 。

这个问题的根源在于 DES97 的切换开关过于简单，它只依赖于几何量 $d$ 和 $\Delta$ 的比较。问题发生的典型场景是在一个附着边界层内，为了提高边界层内部的解析精度，工程师可能会加密流向和展向的网格。这可能导致在一个仍然是附着边界层的区域（物理上应该是 RANS 模式），网格尺度 $\Delta$ 变得比当地的壁面距离 $d$ 还要小，即满足了 $C_{DES}\Delta  d$ 的条件。

根据 DES97 的定义，此时模型会错误地从 RANS 模式切换到 LES 模式。这意味着模型的长度尺度从 $d$ 骤降至 $C_{DES}\Delta$。由于涡粘性 $\nu_t$ 近似与长度尺度的平方成正比（$\nu_t \sim l^2$），涡粘性会急剧减小。这种由模型产生的[雷诺应力](@entry_id:263788)的急剧下降就是“模化应力耗失”。

关键在于，虽然模型切换到了 LES 模式，但触发这个切换的网格（所谓的“RANS 网格”）通常在时间步长和所有三个空间方向上，仍然不足以精细到能够解析出真实的三维[湍流](@entry_id:151300)脉动。因此，模化应力的损失没有得到“解析雷诺应力”（即由解析的脉动速度产生的应力）的补偿。总的剪切应力（粘性应力 + 模化应力 + 解析应力）出现了一个“窟窿”，低于维持边界层抵抗[逆压梯度](@entry_id:276169)所需的物理值。其后果是，模拟中的边界层可能会在完全非物理的位置发生提前分离。

我们可以通过一个思想实验来更清晰地理解这个问题 。假设在一个附着边界层内，DES97 模拟处于一个临界状态或已经进入了错误的 LES 模式（$C_{DES}\Delta \le d$）。如果我们将网格在各个方向上均匀加密一倍（$\Delta \to \Delta/2$），DES97 的长度尺度 $l$ 会减半（$l \to C_{DES}\Delta/2$）。由于 $\nu_t \propto l^2$，涡粘性（以及模化剪切应力）会骤降至原来的四分之一！这种对网格加密的病态敏感性，即“网格越密，结果越差”，是 MSD 的典型特征，也是 DES97 亟待解决的问题。这个发生 MSD 的区域常被称为“灰色区域”。

### 改进方案：[延迟分离涡模拟](@entry_id:1123514)（DDES）与“屏蔽”机制

为了解决 MSD 问题，**[延迟分离涡模拟](@entry_id:1123514) (Delayed DES, DDES)** 被提了出来  。其核心思想是“延迟”向 LES 模式的切换，确保在整个附着边界层内，模型都强制保持在 RANS 模式，无论网格加密到何种程度。

DDES 通过引入一个更智能的长度尺度 $d_{DDES}$ 和一个“[屏蔽函数](@entry_id:1131563)” $f_d$ 来实现这一目标。其[标准形式](@entry_id:153058)为：
$$
d_{DDES} = d - f_d \max(0, d - C_{DES}\Delta)
$$
这里的关键是**[屏蔽函数](@entry_id:1131563) $f_d$**。它是一个根据局部流场信息计算出的标量，其值在 0 和 1 之间变化，作用如同一个流场“传感器”：
*   在附着边界层内部，$f_d$ 被设计为趋近于 **0**。
*   在[流动分离](@entry_id:143331)区或自由[剪切层](@entry_id:274623)中，$f_d$ 被设计为趋近于 **1**。

$f_d$ 通常由一个[无量纲参数](@entry_id:169335) $r_d$ 构造而来，该参数能够区分边界层流和[自由剪切流](@entry_id:271682)（例如，通过比较当地涡量和[应变率张量](@entry_id:266108)不变量）。一个典型的构造形式是 $f_d = 1 - \tanh((\alpha r_d)^m)$，其中 $\alpha$ 和 $m$ 是常数。当 $r_d$ 在边界层内很大时，$f_d \to 0$；当 $r_d$ 在分离区很小时，$f_d \to 1$。

现在我们来分析 DDES 长度尺度的行为：

*   **在附着边界层内**：由于 $f_d \approx 0$，DDES 长度尺度变为 $d_{DDES} \approx d - 0 \cdot \max(0, d - C_{DES}\Delta) = d$。模型长度尺度被强制为 RANS 的壁面距离 $d$，从而“屏蔽”了网格尺度 $\Delta$ 的影响。无论网格如何加密，模型都稳定地保持在 RANS 模式，MSD 问题得以解决。

*   **在分离区**：由于 $f_d \approx 1$，DDES 长度尺度变为 $d_{DDES} \approx d - \max(0, d - C_{DES}\Delta)$。这在数学上等价于 $\min(d, C_{DES}\Delta)$。因此，在分离区，DDES 恢复了 DES97 的行为，允许向 LES 模式的切换，以解析大尺度非定常涡。

回到之前的思想实验 ，在 DDES 中，如果在附着边界层内将网格加密一倍，由于[屏蔽机制](@entry_id:159141)的存在，$l_{DDES}$ 始终约等于 $d$，因此模化应力基本保持不变。DDES 对[网格加密](@entry_id:168565)表现出鲁棒性，解决了 DES97 的核心缺陷。

### 进一步发展：改进的 DES (IDDES) 与 WMLES 分支

DDES 成功地保护了附着边界层，但它也带来了一个新的限制：即使用户在边界层内部署了足以进行 LES 的精细网格，DDES 的屏蔽功能也会阻止模型切换到 LES 模式，迫使其停留在 RANS 模式，这浪费了网格的解析能力。

为了解决这个问题，**改进的[延迟分离涡模拟](@entry_id:1123514) (Improved DDES, IDDES)** 被开发出来 。IDDES 的目标是成为一个功能更全面的[混合方法](@entry_id:163463)，它将 DDES 的鲁棒性与壁面模化 LES ([WMLES](@entry_id:1133936)) 的高分辨率能力结合起来。

IDDES 的核心是在 DDES 的框架内引入了一个 **[WMLES](@entry_id:1133936) 分支**。其工作逻辑如下：

1.  **保留 DDES 屏蔽**：IDDES 保留了 DDES 的屏蔽函数和长度尺度公式作为其基础，这为在粗糙或不确定网格上的 RANS 行为提供了“安全网”，防止了 MSD 的发生。

2.  **增加 [WMLES](@entry_id:1133936) 能力**：IDDES 增加了一个额外的逻辑判断。它会持续监测近壁区的网格分辨率是否足够精细，以至于可以支撑起一个壁面模化的 LES。这个判断通常通过一个“[对数律区](@entry_id:264342)一致性指标”来实现，该指标检查当地网格尺度 $\Delta$ 等参数是否满足 [WMLES](@entry_id:1133936) 的要求。

3.  **条件性切换**：
    *   如果一致性指标显示网格**不足以**支持 WMLES，IDDES 就完[全等](@entry_id:273198)同于 DDES，在附着边界层内执行 RANS 模式。
    *   如果一致性指标显示网格**足以**支持 [WMLES](@entry_id:1133936)，IDDES 会激活其 [WMLES](@entry_id:1133936) 分支。它会平滑地将其[湍流](@entry_id:151300)长度尺度从 RANS 的壁面距离 $d$ 过渡到与网格尺度 $\Delta$ 相关的 LES 尺度。这使得模拟能够在[近壁区](@entry_id:1128462)解析出[湍流](@entry_id:151300)结构，从而获得比 RANS 更精确的结果。

因此，IDDES 不再是简单的 RANS/LES 混合体，而是一个能够根据局部网格和流动条件，在 RANS、DES 和 [WMLES](@entry_id:1133936) 三种模式之间灵活切换的多功能工具，代表了 DES 方法家族的一个重要进步。

### 实践考量：数值格式的隐式效应

DES 系列方法的成功不仅取决于湍流模型的数学公式，还高度依赖于所使用的数值离散格式 。在任何尺度解析模拟（包括 DES 的 LES 模式）中，数值格式的[截断误差](@entry_id:140949)并非总是可以忽略的。

实际上，数值格式，特别是对流项的离散格式，其本身就扮演了一个 **隐式亚格子模型 (implicit subgrid model)** 的角色。其主要效应是 **[数值耗散](@entry_id:168584)**，即离散化过程会从流场中移除能量。这种能量移除在波数空间是选择性的，通常对网格所能表示的最高波数（即最小尺度）的波最为强烈。

因此，一个 DES 模拟中总的亚格子效应是 **显式模型**（如 SA-DES 方程提供的涡粘性）和 **隐式模型**（即[数值耗散](@entry_id:168584)）的总和。为了获得物理上可靠的结果，这两者之间必须保持一致性：

*   理想情况下，总耗散应该足够强，以防止能量在网格截断波数附近发生非物理的“堆积”（**energy pile-up**），这种堆积会导致数值不稳定。
*   同时，总耗散也不能过强，或者作用在过大的尺度上（即过低的波数）。否则，数值格式会过度耗散本应被解析的大尺度含能涡，这种情况被称为“过耗散”或“双重过滤”（即被显式模型和隐式模型同时过度过滤）。

一个定量的一致性判据是，通过[修正方程](@entry_id:173454)分析等方法得到的有效[数值粘性](@entry_id:142854) $\nu_{\text{num}}(k)$，应该主要集中在接近网格截止波数 $k_c \approx \pi/\Delta$ 的区域，而对于 $k \ll k_c$ 的区域影响甚微。如果数值格式的耗散在低波数区过大，它会污染解析的[惯性子区](@entry_id:273327)，从而破坏 DES 模拟的保真度。

总而言之，要成功应用 DES 类方法，不仅需要选择合适的模型（如 DDES 或 IDDES），还必须配合使用低耗散、高阶的数值格式，以确保数值误差不会掩盖或破坏模型旨在解析的物理过程。