{
    "hands_on_practices": [
        {
            "introduction": "Before tackling complex systems, it is essential to understand the fundamental building block: the nonlinear residual for a single control volume. This first exercise guides you through the process of constructing this residual from first principles for the Euler equations using a common numerical flux. By explicitly deriving the residual and its linearization about a uniform state, you will reinforce the connection between the physics of conservation laws and the algebraic structure that numerical solvers must address. ",
            "id": "3973376",
            "problem": "Consider the compressible Euler equations in one spatial dimension for an ideal gas with ratio of specific heats $\\gamma$. Let the conservative state vector be $U = (\\rho, \\rho u, \\rho E)^{\\mathsf{T}}$, where $\\rho$ is density, $u$ is velocity, and $E$ is specific total energy. The pressure is given by the ideal-gas relation $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$. The physical flux function is $F(U) = \\left(\\rho u, \\rho u^{2} + p, u(\\rho E + p)\\right)^{\\mathsf{T}}$. On a uniform mesh of cells indexed by $i$ with spacing $\\Delta x$, define the semi-discrete finite-volume residual for cell $i$ as $R_{i}(U) = \\frac{1}{\\Delta x}\\left(\\hat{F}_{i+\\tfrac{1}{2}} - \\hat{F}_{i-\\tfrac{1}{2}}\\right)$, where $\\hat{F}_{i+\\tfrac{1}{2}}$ is a consistent numerical flux computed from left and right states at the interface $i+\\tfrac{1}{2}$. Use the Local Lax–Friedrichs (LLF) upwind numerical flux for the Euler equations, defined for an interface with left state $U_{L}$ and right state $U_{R}$ by\n$$\n\\hat{F}(U_{L}, U_{R}) = \\frac{1}{2}\\left(F(U_{L}) + F(U_{R})\\right) - \\frac{1}{2}\\alpha(U_{L}, U_{R})\\left(U_{R} - U_{L}\\right),\n$$\nwhere $\\alpha(U_{L}, U_{R})$ is any upper bound on the spectral radius of the flux Jacobian evaluated at $(U_{L}, U_{R})$, for example $\\alpha(U_{L}, U_{R}) = \\max\\left(|u_{L}| + a_{L}, |u_{R}| + a_{R}\\right)$ with sound speed $a = \\sqrt{\\gamma p / \\rho}$. \n\nTasks:\n- Starting from conservation form and the LLF flux definition, write $R_{i}(U)$ explicitly in terms of $(U_{i-1}, U_{i}, U_{i+1})$, $F(\\cdot)$, and $\\alpha(\\cdot,\\cdot)$ on the uniform mesh.\n- Perform a first-order linearization of $R_{i}(U)$ about a uniform constant state $U^{\\ast}$ (i.e., $U_{j} \\equiv U^{\\ast}$ for all $j$), assuming the dissipation coefficient is frozen at its constant value $\\alpha^{\\ast} = \\alpha(U^{\\ast}, U^{\\ast})$. Denote the physical flux Jacobian at $U^{\\ast}$ by $A^{\\ast} = \\partial F/\\partial U \\big|_{U^{\\ast}}$. Derive the block tridiagonal Jacobian contributions $\\partial R_{i}/\\partial U_{i-1}$, $\\partial R_{i}/\\partial U_{i}$, and $\\partial R_{i}/\\partial U_{i+1}$ in terms of $A^{\\ast}$, $\\alpha^{\\ast}$, and $\\Delta x$, and verify the discrete conservation property for constant perturbations.\n- Evaluate $R_{i}(U^{\\ast})$ for the uniform constant state $U^{\\ast}$, and provide the result as a single $3$-component row matrix using the $\\mathrm{pmatrix}$ environment. \n\nNo numerical substitution is required. This problem is situated within Computational Fluid Dynamics (CFD) practice and aims to connect conservation laws to linearization of nonlinear residuals. Your final answer must be the evaluated residual vector $R_{i}(U^{\\ast})$ expressed symbolically as requested, with no units.",
            "solution": "The problem presents three tasks concerning the semi-discrete finite-volume residual for the one-dimensional compressible Euler equations. We will address each task sequentially.\n\n**Task 1: Explicit form of the residual $R_i(U)$**\n\nThe semi-discrete residual for a cell indexed by $i$ on a uniform mesh with spacing $\\Delta x$ is defined as:\n$$\nR_{i}(U) = \\frac{1}{\\Delta x}\\left(\\hat{F}_{i+\\tfrac{1}{2}} - \\hat{F}_{i-\\tfrac{1}{2}}\\right)\n$$\nFor a first-order spatial scheme, the numerical flux $\\hat{F}_{i+\\frac{1}{2}}$ at the interface between cells $i$ and $i+1$ is a function of the cell-average states $U_i$ and $U_{i+1}$. Similarly, the flux $\\hat{F}_{i-\\frac{1}{2}}$ at the interface between cells $i-1$ and $i$ is a function of $U_{i-1}$ and $U_i$.\n\nThe provided Local Lax–Friedrichs (LLF) numerical flux is defined as:\n$$\n\\hat{F}(U_{L}, U_{R}) = \\frac{1}{2}\\left(F(U_{L}) + F(U_{R})\\right) - \\frac{1}{2}\\alpha(U_{L}, U_{R})\\left(U_{R} - U_{L}\\right)\n$$\nwhere $F(\\cdot)$ is the physical flux function and $\\alpha(\\cdot, \\cdot)$ is a dissipation coefficient.\n\nFor the interface at $i+\\frac{1}{2}$, the left and right states are $U_L = U_i$ and $U_R = U_{i+1}$. The corresponding numerical flux is:\n$$\n\\hat{F}_{i+\\tfrac{1}{2}} = \\hat{F}(U_i, U_{i+1}) = \\frac{1}{2}\\left(F(U_i) + F(U_{i+1})\\right) - \\frac{1}{2}\\alpha(U_i, U_{i+1})\\left(U_{i+1} - U_i\\right)\n$$\nFor the interface at $i-\\frac{1}{2}$, the left and right states are $U_L = U_{i-1}$ and $U_R = U_i$. The corresponding numerical flux is:\n$$\n\\hat{F}_{i-\\tfrac{1}{2}} = \\hat{F}(U_{i-1}, U_i) = \\frac{1}{2}\\left(F(U_{i-1}) + F(U_i)\\right) - \\frac{1}{2}\\alpha(U_{i-1}, U_i)\\left(U_i - U_{i-1}\\right)\n$$\nSubstituting these expressions into the definition of the residual $R_i(U)$, we obtain its explicit form as a function of the states in the three-cell stencil $(U_{i-1}, U_i, U_{i+1})$:\n$$\nR_{i}(U) = \\frac{1}{\\Delta x} \\left[ \\left(\\frac{1}{2}\\left(F(U_i) + F(U_{i+1})\\right) - \\frac{1}{2}\\alpha(U_i, U_{i+1})\\left(U_{i+1} - U_i\\right)\\right) - \\left(\\frac{1}{2}\\left(F(U_{i-1}) + F(U_i)\\right) - \\frac{1}{2}\\alpha(U_{i-1}, U_i)\\left(U_i - U_{i-1}\\right)\\right) \\right]\n$$\nThis expression can be simplified by collecting terms:\n$$\nR_{i}(U) = \\frac{F(U_{i+1}) - F(U_{i-1})}{2\\Delta x} - \\frac{1}{2\\Delta x} \\left[ \\alpha(U_i, U_{i+1})\\left(U_{i+1} - U_i\\right) - \\alpha(U_{i-1}, U_i)\\left(U_i - U_{i-1}\\right) \\right]\n$$\n\n**Task 2: Linearization of $R_i(U)$ and verification of conservation**\n\nWe now linearize $R_i(U)$ about a uniform constant state $U^*$, where $U_j \\equiv U^*$ for all cell indices $j$. The problem specifies that the dissipation coefficient $\\alpha$ should be \"frozen\" at its constant value for this uniform state: $\\alpha(U_L, U_R) \\approx \\alpha(U^*, U^*) \\equiv \\alpha^*$. This means derivatives of $\\alpha$ are not considered. Let $A^* = \\frac{\\partial F}{\\partial U}\\big|_{U^*}$ be the physical flux Jacobian at state $U^*$.\n\nUnder the frozen-coefficient approximation, the residual expression simplifies to:\n$$\nR_{i}(U) \\approx \\frac{1}{2\\Delta x} \\left[ F(U_{i+1}) - F(U_{i-1}) - \\alpha^*\\left((U_{i+1} - U_i) - (U_i - U_{i-1})\\right) \\right]\n$$\n$$\nR_{i}(U) \\approx \\frac{1}{2\\Delta x} \\left[ F(U_{i+1}) - F(U_{i-1}) - \\alpha^*\\left(U_{i+1} - 2U_i + U_{i-1}\\right) \\right]\n$$\nWe compute the partial derivatives of $R_i$ with respect to $U_{i-1}$, $U_i$, and $U_{i+1}$ by differentiating the simplified expression. For this, we use the identity $\\frac{\\partial F(U_j)}{\\partial U_k}\\big|_{U^*} = \\delta_{jk} A^*$, where $\\delta_{jk}$ is the Kronecker delta.\n\nThe Jacobian contribution from $U_{i-1}$ is:\n$$\n\\frac{\\partial R_i}{\\partial U_{i-1}}\\bigg|_{U^*} = \\frac{\\partial}{\\partial U_{i-1}} \\left( \\frac{1}{2\\Delta x} \\left[ -F(U_{i-1}) - \\alpha^*U_{i-1} \\right] \\right) = \\frac{1}{2\\Delta x} \\left[ -A^* - \\alpha^* I \\right]\n$$\nwhere $I$ is the $3 \\times 3$ identity matrix.\n\nThe Jacobian contribution from $U_{i+1}$ is:\n$$\n\\frac{\\partial R_i}{\\partial U_{i+1}}\\bigg|_{U^*} = \\frac{\\partial}{\\partial U_{i+1}} \\left( \\frac{1}{2\\Delta x} \\left[ F(U_{i+1}) - \\alpha^*U_{i+1} \\right] \\right) = \\frac{1}{2\\Delta x} \\left[ A^* - \\alpha^* I \\right]\n$$\nThe Jacobian contribution from $U_{i}$ is:\n$$\n\\frac{\\partial R_i}{\\partial U_{i}}\\bigg|_{U^*} = \\frac{\\partial}{\\partial U_{i}} \\left( \\frac{1}{2\\Delta x} \\left[ 2\\alpha^* U_i \\right] \\right) = \\frac{1}{2\\Delta x} \\left[ 2\\alpha^* I \\right] = \\frac{\\alpha^*}{\\Delta x} I\n$$\nTo verify the discrete conservation property for constant perturbations, we sum the Jacobian contributions for cell $i$ over its stencil:\n$$\n\\sum_{j} \\frac{\\partial R_i}{\\partial U_j} = \\frac{\\partial R_i}{\\partial U_{i-1}} + \\frac{\\partial R_i}{\\partial U_i} + \\frac{\\partial R_i}{\\partial U_{i+1}}\n$$\n$$\n= \\frac{1}{2\\Delta x} \\left( -A^* - \\alpha^* I \\right) + \\frac{\\alpha^*}{\\Delta x} I + \\frac{1}{2\\Delta x} \\left( A^* - \\alpha^* I \\right)\n$$\n$$\n= \\frac{1}{2\\Delta x} \\left[ -A^* - \\alpha^* I + 2\\alpha^* I + A^* - \\alpha^* I \\right]\n$$\n$$\n= \\frac{1}{2\\Delta x} \\left[ (-A^* + A^*) + (-\\alpha^* + 2\\alpha^* - \\alpha^*)I \\right] = 0\n$$\nThe sum is the zero matrix, which confirms the discrete conservation property.\n\n**Task 3: Evaluation of $R_i(U^*)$**\n\nFinally, we evaluate the residual $R_i(U)$ for the uniform constant state $U^*$, where $U_{j} = U^*$ for $j \\in \\{i-1, i, i+1\\}$.\nWe start with the definition:\n$$\nR_i(U^*) = \\frac{1}{\\Delta x}\\left(\\hat{F}_{i+\\tfrac{1}{2}} - \\hat{F}_{i-\\tfrac{1}{2}}\\right)\n$$\nThe numerical flux at interface $i+\\frac{1}{2}$ has identical left and right states, $U_L=U_R=U^*$:\n$$\n\\hat{F}_{i+\\tfrac{1}{2}} = \\hat{F}(U^*, U^*) = \\frac{1}{2}\\left(F(U^*) + F(U^*)\\right) - \\frac{1}{2}\\alpha(U^*, U^*)\\left(U^* - U^*\\right)\n$$\n$$\n\\hat{F}_{i+\\tfrac{1}{2}} = \\frac{1}{2}\\left(2F(U^*)\\right) - 0 = F(U^*)\n$$\nThis is the consistency property of the numerical flux: $\\hat{F}(U, U) = F(U)$.\nBy the same logic, the numerical flux at interface $i-\\frac{1}{2}$ is also $F(U^*)$:\n$$\n\\hat{F}_{i-\\tfrac{1}{2}} = \\hat{F}(U^*, U^*) = F(U^*)\n$$\nSubstituting these back into the residual expression:\n$$\nR_i(U^*) = \\frac{1}{\\Delta x} \\left[ F(U^*) - F(U^*) \\right] = \\frac{1}{\\Delta x} (0) = 0\n$$\nThe result is the zero vector of dimension $3$. This is a fundamental consistency requirement known as freestream preservation: a uniform flow must yield a zero residual, indicating it is a steady-state solution of the discrete equations. The result, expressed as a $3$-component row matrix, is $(0, 0, 0)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "CFD solvers operate on systems of thousands or millions of coupled equations, not single cells in isolation. This practice scales up our perspective by asking you to assemble the complete Jacobian matrix for a small, periodic system, a common model for stability analysis. By computing the eigenvalues of this global Jacobian, you will gain direct insight into how local linearization choices influence the spectral properties of the entire system, which governs the performance of many implicit and explicit solvers. ",
            "id": "3973400",
            "problem": "Consider the one-dimensional non-viscous Euler equations for an ideal gas with ratio of specific heats $\\gamma = 1.4$, discretized on a uniform three-cell periodic mesh in Computational Fluid Dynamics (CFD). Let the conservative state in cell $i$ be $Q_{i} = (\\rho_{i}, \\rho_{i} u_{i}, \\rho_{i} E_{i})^{\\mathsf{T}}$, and define the inviscid residual in each cell by the finite-volume divergence of interface fluxes,\n$$\nR_{i} = F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}},\n$$\nwhere $F_{i+\\frac{1}{2}}$ is the numerical flux at the interface between cells $i$ and $i+1$. Assume the numerical flux is the Roe approximate Riemann solver flux constructed from a Roe linearization evaluated at the Roe-averaged state. The Roe flux between any two states $Q_{L}$ and $Q_{R}$ is defined by\n$$\nF(Q_{L}, Q_{R}) = \\frac{1}{2}\\left(F(Q_{L}) + F(Q_{R})\\right) - \\frac{1}{2} \\left|A(\\tilde{Q})\\right| \\left(Q_{R}-Q_{L}\\right),\n$$\nwhere $A(\\tilde{Q})$ is the flux-Jacobian of the one-dimensional Euler equations evaluated at the Roe-averaged state $\\tilde{Q}$, and $\\left|A(\\tilde{Q})\\right|$ denotes the matrix obtained by replacing the eigenvalues of $A(\\tilde{Q})$ by their absolute values via a similarity transform. The mesh is periodic with three cells ($i = 1, 2, 3$), so interfaces are $i+\\frac{1}{2}$ modulo $3$.\n\nAssume a uniform non-dimensional free-stream with speed of sound $a_{\\infty} = 1$, Mach number $M_{\\infty} = 0.5$, density $\\rho_{\\infty} = 1$, and pressure $p_{\\infty} = \\frac{1}{\\gamma}$ so that $u_{\\infty} = M_{\\infty} a_{\\infty} = 0.5$ and $a_{\\infty} = \\sqrt{\\gamma p_{\\infty}/\\rho_{\\infty}} = 1$. All three cells are initialized at this uniform state, so $Q_{1} = Q_{2} = Q_{3} = Q_{\\infty}$, and all Roe averages at all interfaces equal $Q_{\\infty}$.\n\nUsing the above physical base, assemble the exact Jacobian matrix $J \\in \\mathbb{R}^{9 \\times 9}$ of the residual vector $R = (R_{1}^{\\mathsf{T}}, R_{2}^{\\mathsf{T}}, R_{3}^{\\mathsf{T}})^{\\mathsf{T}}$ with respect to the global conservative state vector $Q = (Q_{1}^{\\mathsf{T}}, Q_{2}^{\\mathsf{T}}, Q_{3}^{\\mathsf{T}})^{\\mathsf{T}}$, evaluated at the uniform free-stream state $Q_{\\infty}$. Compute the eigenvalues of $J$ by exploiting the periodic structure of the three-cell mesh and the characteristic decomposition of the Roe matrix for the one-dimensional Euler equations.\n\nFinally, report the spectral radius of $J$ (the maximum absolute value among all eigenvalues of $J$) for this configuration. Express your final answer as a single closed-form analytic expression, non-dimensional, with no rounding.",
            "solution": "The global Jacobian matrix $J$ of the residual vector $R = (R_1^{\\mathsf{T}}, R_2^{\\mathsf{T}}, R_3^{\\mathsf{T}})^{\\mathsf{T}}$ with respect to the state vector $Q = (Q_1^{\\mathsf{T}}, Q_2^{\\mathsf{T}}, Q_3^{\\mathsf{T}})^{\\mathsf{T}}$ has a $3 \\times 3$ block structure. The block $J_{ij} = \\partial R_i / \\partial Q_j$ is a $3 \\times 3$ matrix.\n\n**1. Jacobian Block Structure**\nThe residual for cell $i$ is $R_i = F(Q_i, Q_{i+1}) - F(Q_{i-1}, Q_i)$, considering the periodic mesh. We need the partial derivatives of the Roe flux $F(Q_L, Q_R)$ with respect to $Q_L$ and $Q_R$, evaluated at the uniform state where $Q_L=Q_R=Q_\\infty$. Let $A = A(Q_\\infty)$ be the Euler flux Jacobian at this state. The derivatives of the Roe flux are:\n$$\nB_L = \\frac{\\partial F}{\\partial Q_L} \\bigg|_{Q_\\infty} = \\frac{1}{2}(A + |A|)\n$$\n$$\nB_R = \\frac{\\partial F}{\\partial Q_R} \\bigg|_{Q_\\infty} = \\frac{1}{2}(A - |A|)\n$$\nThe Jacobian blocks are then:\n$$\n\\frac{\\partial R_i}{\\partial Q_i} = \\frac{\\partial F(Q_i, Q_{i+1})}{\\partial Q_i} - \\frac{\\partial F(Q_{i-1}, Q_i)}{\\partial Q_i} = B_L - B_R = |A|\n$$\n$$\n\\frac{\\partial R_i}{\\partial Q_{i+1}} = \\frac{\\partial F(Q_i, Q_{i+1})}{\\partial Q_{i+1}} = B_R\n$$\n$$\n\\frac{\\partial R_i}{\\partial Q_{i-1}} = -\\frac{\\partial F(Q_{i-1}, Q_i)}{\\partial Q_{i-1}} = -B_L\n$$\nDue to the periodic boundary conditions, the global Jacobian $J$ is a block circulant matrix:\n$$\nJ = \\begin{pmatrix}\n|A| & B_R & -B_L \\\\\n-B_L & |A| & B_R \\\\\nB_R & -B_L & |A|\n\\end{pmatrix}\n$$\n\n**2. Eigenvalue Analysis**\nThe eigenvalues of an $N \\times N$ block-circulant matrix are the eigenvalues of the $N$ smaller matrices $\\hat{J}_k$ formed by a block discrete Fourier transform: $\\hat{J}_k = C_0 + \\omega^k C_1 + \\dots + \\omega^{(N-1)k} C_{N-1}$ where $\\omega = e^{i2\\pi/N}$. For our $N=3$ case:\n$$\n\\hat{J}_k = (|A|) + \\omega^k (B_R) + \\omega^{2k} (-B_L), \\quad k=0, 1, 2\n$$\nThe eigenvalues of $J$ are the union of the eigenvalues of $\\hat{J}_0, \\hat{J}_1, \\hat{J}_2$. Let $\\lambda_A$ be an eigenvalue of $A$. Since $A$, $|A|$, $B_L$, and $B_R$ are all functions of $A$, they share the same eigenvectors. Their corresponding eigenvalues are $\\lambda_A$, $|\\lambda_A|$, $\\frac{1}{2}(\\lambda_A + |\\lambda_A|)$, and $\\frac{1}{2}(\\lambda_A - |\\lambda_A|)$.\nThe eigenvalues of each $\\hat{J}_k$, denoted $\\lambda(\\hat{J}_k)$, are:\n$$\n\\lambda(\\hat{J}_k) = |\\lambda_A| + \\omega^k \\frac{1}{2}(\\lambda_A - |\\lambda_A|) - \\omega^{2k} \\frac{1}{2}(\\lambda_A + |\\lambda_A|)\n$$\n$$\n\\lambda(\\hat{J}_k) = |\\lambda_A|\\left(1 - \\frac{\\omega^k}{2} - \\frac{\\omega^{2k}}{2}\\right) + \\lambda_A\\left(\\frac{\\omega^k}{2} - \\frac{\\omega^{2k}}{2}\\right)\n$$\n\n- For $k=0$ ($\\omega^0=1$):\n$\\lambda(\\hat{J}_0) = |\\lambda_A|(1 - \\frac{1}{2} - \\frac{1}{2}) + \\lambda_A(\\frac{1}{2} - \\frac{1}{2}) = 0$. All eigenvalues are zero.\n\n- For $k=1$ ($\\omega, \\omega^2$):\n$\\lambda(\\hat{J}_1) = |\\lambda_A|(1 - \\frac{\\omega}{2} - \\frac{\\omega^2}{2}) + \\lambda_A(\\frac{\\omega - \\omega^2}{2})$.\nUsing $1+\\omega+\\omega^2=0$, we get $1 = -\\omega-\\omega^2$. So $1 - \\frac{\\omega}{2} - \\frac{\\omega^2}{2} = 1 - \\frac{1}{2}(\\omega+\\omega^2) = 1 - \\frac{1}{2}(-1) = \\frac{3}{2}$.\nAlso, $\\omega = e^{i2\\pi/3} = -\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}$, so $\\omega-\\omega^2 = i\\sqrt{3}$.\n$$\n\\lambda(\\hat{J}_1) = \\frac{3}{2}|\\lambda_A| + i\\frac{\\sqrt{3}}{2}\\lambda_A\n$$\n- For $k=2$ ($\\omega^2, \\omega^4=\\omega$): $\\hat{J}_2$ is the complex conjugate of $\\hat{J}_1$, so its eigenvalues are the conjugates of those for $\\hat{J}_1$.\n\n**3. Spectral Radius Calculation**\nThe magnitude of the non-zero eigenvalues is:\n$$\n|\\lambda(\\hat{J}_1)| = \\left|\\frac{3}{2}|\\lambda_A| + i\\frac{\\sqrt{3}}{2}\\lambda_A\\right| = \\sqrt{\\left(\\frac{3}{2}|\\lambda_A|\\right)^2 + \\left(\\frac{\\sqrt{3}}{2}\\lambda_A\\right)^2}\n$$\nSince the eigenvalues $\\lambda_A$ of the 1D Euler flux Jacobian are real, $\\lambda_A^2 = |\\lambda_A|^2$.\n$$\n|\\lambda(\\hat{J}_1)| = \\sqrt{\\frac{9}{4}|\\lambda_A|^2 + \\frac{3}{4}\\lambda_A^2} = \\sqrt{\\frac{12}{4}|\\lambda_A|^2} = \\sqrt{3|\\lambda_A|^2} = \\sqrt{3}|\\lambda_A|\n$$\nThe eigenvalues of the 1D Euler flux Jacobian are $\\lambda_A \\in \\{u, u+a, u-a\\}$. For the given state, $u_\\infty=0.5$ and $a_\\infty=1$.\n$$\n\\lambda_A \\in \\{0.5, 0.5+1, 0.5-1\\} = \\{0.5, 1.5, -0.5\\}\n$$\nThe spectral radius of $A$ is $\\rho(A) = \\max|\\lambda_A| = 1.5$.\nThe spectral radius of the full Jacobian $J$ is the maximum magnitude of its eigenvalues:\n$$\n\\rho(J) = \\max |\\lambda(J)| = \\max(\\sqrt{3}|\\lambda_A|) = \\sqrt{3} \\max|\\lambda_A| = \\sqrt{3} \\rho(A)\n$$\n$$\n\\rho(J) = \\sqrt{3} \\times 1.5 = \\frac{3\\sqrt{3}}{2}\n$$",
            "answer": "$$\\boxed{\\frac{3\\sqrt{3}}{2}}$$"
        },
        {
            "introduction": "The ultimate test of a linearization is its performance within a Newton-type solver. This computational exercise explores the direct relationship between the accuracy of the Jacobian and the convergence rate of the solution. By implementing a Newton solver for a model transonic flow problem and comparing the results using exact, approximate, and frozen Jacobians, you will quantify the theoretical trade-offs and observe the classic shift from quadratic to linear convergence. ",
            "id": "3973418",
            "problem": "Consider steady, inviscid, isentropic, compressible flow along a thin streamtube wrapped around an airfoil in a transonic regime. In Computational Fluid Dynamics (CFD), the discretized residual for such a flow can be constructed from the area–Mach number relation obtained from conservation of mass and isentropic thermodynamics. Starting from the fundamental laws, conservation of mass for a steady one-dimensional streamtube implies that $ \\rho U A = \\text{constant} $, where $ \\rho $ is the density, $ U $ is the axial velocity, and $ A $ is the local cross-sectional area. Under isentropic conditions, the pressure–density relation $ p/\\rho^\\gamma = \\text{constant} $ holds, where $ \\gamma $ is the ratio of specific heats. Combining these yields the compressible area–Mach relation,\n$$\n\\frac{A}{A^\\ast}(M) \\;=\\; \\frac{1}{M}\\left(\\frac{2}{\\gamma+1}\\left(1+\\frac{\\gamma-1}{2}M^2\\right)\\right)^{\\frac{\\gamma+1}{2(\\gamma-1)}},\n$$\nwhere $ M $ is the Mach number and $ A^\\ast $ is the sonic area. This relation is valid for $ M > 0 $ and has a minimum at $ M = 1 $ with $ A/A^\\ast = 1 $, producing two branches (subsonic and supersonic) for $ A/A^\\ast > 1 $. In a transonic airfoil case, a smooth field of Mach numbers $ M(s) $ along the surface coordinate $ s \\in [0,1] $ will cross near $ M \\approx 1 $.\n\nDefine the nonlinear residual for a vector of nodal Mach numbers $ \\mathbf{m} = (m_1,\\dots,m_N) $ at uniformly spaced nodes $ s_i \\in [0,1] $ as\n$$\nR_i(\\mathbf{m}) \\;=\\; \\frac{A}{A^\\ast}(m_i) \\;-\\; \\frac{A}{A^\\ast}(M_{\\text{true}}(s_i)),\n$$\nwhere $ M_{\\text{true}}(s) $ is a prescribed smooth transonic target field,\n$$\nM_{\\text{true}}(s) \\;=\\; 0.8 \\;+\\; 0.4 \\exp\\!\\left(-\\frac{(s-0.6)^2}{(0.05)^2}\\right),\n$$\nand $ \\gamma = 1.4 $. By construction, the exact solution of $ R_i(\\mathbf{m})=0 $ is $ m_i = M_{\\text{true}}(s_i) $. Let the initial guess be\n$$\nm_i^{(0)} \\;=\\; M_{\\text{true}}(s_i) \\;+\\; \\delta \\sin(2\\pi s_i), \\quad \\delta = 0.02.\n$$\n\nNewton’s method updates $ \\mathbf{m}^{(k+1)} = \\mathbf{m}^{(k)} - \\mathbf{J}(\\mathbf{m}^{(k)})^{-1}\\mathbf{R}(\\mathbf{m}^{(k)}) $, where $ \\mathbf{J} $ is the Jacobian matrix with entries $ J_{ij} = \\partial R_i / \\partial m_j $. Because $ R_i $ depends only on $ m_i $, $ \\mathbf{J} $ is diagonal with $ J_{ii} = \\frac{d}{dM}\\left(\\frac{A}{A^\\ast}(M)\\right)\\big|_{M=m_i} $. The linearization accuracy can be varied by replacing the exact derivative with approximations:\n- Exact Jacobian: $ J_{ii} = \\left(\\frac{A}{A^\\ast}\\right)^\\prime(m_i^{(k)}) $.\n- Finite-difference Jacobian: $ J_{ii} \\approx \\dfrac{\\frac{A}{A^\\ast}(m_i^{(k)}+\\epsilon) - \\frac{A}{A^\\ast}(m_i^{(k)})}{\\epsilon} $ with specified $ \\epsilon > 0 $.\n- Frozen Jacobian: $ J_{ii} $ is computed once at $ m_i^{(0)} $ and held fixed for all iterations.\n\nDefine the global error at iteration $ k $ as the infinity norm\n$$\ne^{(k)} \\;=\\; \\left\\|\\mathbf{m}^{(k)} - \\mathbf{M}_{\\text{true}}\\right\\|_\\infty.\n$$\nEstimate the observed convergence rate $ p $ using three consecutive errors via\n$$\np \\;\\approx\\; \\frac{\\ln\\!\\left(e^{(k+1)}/e^{(k)}\\right)}{\\ln\\!\\left(e^{(k)}/e^{(k-1)}\\right)},\n$$\ncomputed from the last three iterations after a fixed number of total iterations.\n\nYour task is to implement a program that:\n1. Constructs $ N = 200 $ nodes $ s_i $ uniformly in $ [0,1] $.\n2. Builds $ M_{\\text{true}}(s_i) $, the residual $ R_i(\\mathbf{m}) $, and initializes $ \\mathbf{m}^{(0)} $ as above.\n3. Runs Newton iterations for a fixed number of iterations (use $ 8 $ iterations) using each of the following Jacobian linearization strategies:\n   - Exact Jacobian.\n   - Finite-difference Jacobian with $ \\epsilon = 10^{-6} $.\n   - Finite-difference Jacobian with $ \\epsilon = 10^{-3} $.\n   - Frozen Jacobian taken from the initial guess.\n4. For each strategy, computes the observed convergence rate $ p $ using the last three errors $ e^{(k)} $.\n5. Aggregates the four $ p $ values into a single list.\n\nTest Suite:\n- Case $ 1 $: Exact Jacobian.\n- Case $ 2 $: Finite-difference Jacobian with $ \\epsilon = 10^{-6} $.\n- Case $ 3 $: Finite-difference Jacobian with $ \\epsilon = 10^{-3} $.\n- Case $ 4 $: Frozen Jacobian from the initial guess.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $ [p_1,p_2,p_3,p_4] $). All numbers in the output must be plain floating-point values without units. No physical units are required for this problem, and all quantities are dimensionless. Angles do not appear in this problem, and no percentages are used.",
            "solution": "The problem addresses the numerical solution of a nonlinear system of equations arising from the discretization of a fluid dynamics problem. Specifically, it concerns finding the Mach number distribution $\\mathbf{m}$ that satisfies a set of algebraic equations $\\mathbf{R}(\\mathbf{m}) = \\mathbf{0}$.\n\n**1. Physical and Mathematical Foundation**\nThe core of the problem is the isentropic area-Mach number relation for one-dimensional compressible flow:\n$$ \\frac{A}{A^\\ast}(M) = \\frac{1}{M}\\left(\\frac{2}{\\gamma+1}\\left(1+\\frac{\\gamma-1}{2}M^2\\right)\\right)^{\\frac{\\gamma+1}{2(\\gamma-1)}} $$\nThis equation connects the local flow Mach number $M$ to the ratio of the local streamtube area $A$ to the sonic area $A^\\ast$. The problem defines a nonlinear residual vector $\\mathbf{R}$ for a set of $N$ discrete points along a spatial coordinate $s$. The $i$-th component of the residual is:\n$$ R_i(\\mathbf{m}) = \\frac{A}{A^\\ast}(m_i) - \\frac{A}{A^\\ast}(M_{\\text{true}}(s_i)) $$\nHere, $\\mathbf{m} = \\{m_i\\}_{i=1}^N$ is the vector of unknown nodal Mach numbers. The term $\\frac{A}{A^\\ast}(M_{\\text{true}}(s_i))$ represents the area ratio corresponding to a known, exact solution, $\\mathbf{M}_{\\text{true}}$. The goal is to solve the system $\\mathbf{R}(\\mathbf{m}) = \\mathbf{0}$, whose solution by construction is $m_i = M_{\\text{true}}(s_i)$.\n\n**2. Numerical Method: Newton-Raphson**\nNewton's method is an iterative algorithm for finding the roots of a system of nonlinear equations. Given an initial guess $\\mathbf{m}^{(k)}$, the next iterate $\\mathbf{m}^{(k+1)}$ is found by solving the linear system that arises from a first-order Taylor expansion of the residual around $\\mathbf{m}^{(k)}$:\n$$ \\mathbf{R}(\\mathbf{m}^{(k+1)}) \\approx \\mathbf{R}(\\mathbf{m}^{(k)}) + \\mathbf{J}(\\mathbf{m}^{(k)})(\\mathbf{m}^{(k+1)} - \\mathbf{m}^{(k)}) = \\mathbf{0} $$\nThis leads to the update formula:\n$$ \\mathbf{m}^{(k+1)} = \\mathbf{m}^{(k)} - \\mathbf{J}(\\mathbf{m}^{(k)})^{-1}\\mathbf{R}(\\mathbf{m}^{(k)}) $$\nThe matrix $\\mathbf{J}$ is the Jacobian of the residual vector, with entries $J_{ij} = \\partial R_i / \\partial m_j$. In this problem, $R_i$ depends only on $m_i$, making the Jacobian a diagonal matrix. The diagonal entries are:\n$$ J_{ii} = \\frac{\\partial R_i}{\\partial m_i} = \\frac{d}{dM}\\left(\\frac{A}{A^\\ast}(M)\\right)\\bigg|_{M=m_i} $$\nAnalytically, this derivative is found to be:\n$$ \\left(\\frac{A}{A^\\ast}\\right)'(M) = \\frac{A}{A^\\ast}(M) \\frac{M^2-1}{M\\left(1+\\frac{\\gamma-1}{2}M^2\\right)} $$\n\n**3. Jacobian Linearization Strategies and Convergence**\nThe core of the investigation lies in how the Jacobian $\\mathbf{J}$ is computed, as this significantly impacts the convergence rate and computational cost. The problem evaluates four strategies:\n- **Exact Jacobian**: Using the analytical derivative provides the most accurate linearization. For simple roots, Newton's method with an exact Jacobian exhibits quadratic convergence ($p=2$).\n- **Finite-Difference Jacobian**: Approximating the derivative introduces an error of order $O(\\epsilon)$. This typically degrades the convergence to linear ($p=1$), where the error reduction per step becomes constant.\n- **Frozen Jacobian**: Computing the Jacobian only once at the initial guess and reusing it converts Newton's method into a quasi-Newton (or chord) method. This avoids the cost of re-evaluating the Jacobian but also reduces the convergence rate to linear ($p=1$).\n\n**4. The Transonic Singularity ($M=1$)**\nA critical physical and numerical feature of this problem is that the flow passes through $M=1$. At $M=1$, the derivative $(A/A^\\ast)'(M)$ is zero. For a Newton iteration converging to a root $m^*$ where the derivative $J(m^*)$ is non-zero, the convergence is quadratic. However, if $J(m^*) = 0$, the root is not simple, and the convergence degenerates to linear with a rate factor of $0.5$, meaning the observed convergence rate $p$ becomes $1$. In this problem, the true solution $\\mathbf{M}_{\\text{true}}$ includes points where $M_{\\text{true}}(s_i) \\approx 1$. The global error, defined by the infinity norm $e^{(k)} = \\max_i |m_i^{(k)} - M_{\\text{true}}(s_i)|$, will be dominated by the error at the nodes that converge most slowly. Since the nodes near $M=1$ exhibit linear convergence even with the exact Jacobian, the overall observed convergence rate $p$ for the \"Exact Jacobian\" case is expected to be close to $1$, not $2$. The other strategies are inherently linear, so they are also expected to yield $p \\approx 1$. The implementation will calculate these observed rates.\n\n**5. Implementation**\nThe solution is implemented in Python using the `numpy` library. The code first defines the physical functions and their derivatives. It then iterates through each of the four Jacobian strategies, performing 8 Newton steps for each. After the iterations, it computes the observed convergence rate $p$ for each strategy using the infinity norm of the error from the last three iterations. A key detail in the implementation is the regularization of the Jacobian to avoid division by zero when a nodal Mach number is very close to 1, which reflects a practical consideration in real CFD codes.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nonlinear residual problem for transonic flow using Newton's method\n    with different Jacobian approximations and computes the observed convergence rates.\n    \"\"\"\n    \n    # --- 1. Problem Setup ---\n    N = 200\n    GAMMA = 1.4\n    DELTA = 0.02\n    NUM_ITER = 8\n    \n    # Spatial domain discretization\n    s = np.linspace(0, 1, N)\n\n    # --- 2. Core Physical and Mathematical Functions ---\n    \n    def A_A_star(M, gamma=GAMMA):\n        \"\"\"\n        Calculates the compressible area-Mach number relation A/A*.\n        Vectorized to operate on numpy arrays.\n        \"\"\"\n        M_safe = np.maximum(M, 1e-9)\n\n        gp1 = gamma + 1.0\n        gm1 = gamma - 1.0\n        \n        term1 = 2.0 / gp1\n        term2 = 1.0 + (gm1 / 2.0) * M_safe**2\n        exponent = gp1 / (2.0 * gm1)\n        \n        return (1.0 / M_safe) * (term1 * term2)**exponent\n\n    def dA_A_star_dM(M, gamma=GAMMA):\n        \"\"\"\n        Calculates the exact derivative of the A/A* function with respect to M.\n        Vectorized to operate on numpy arrays.\n        \"\"\"\n        M_safe = np.maximum(M, 1e-9)\n\n        gm1 = gamma - 1.0\n        \n        val_A_A_star = A_A_star(M_safe, gamma)\n        \n        numerator = M_safe**2 - 1.0\n        denominator = M_safe * (1.0 + (gm1 / 2.0) * M_safe**2)\n        \n        denominator[np.abs(denominator)  1e-12] = 1e-12\n        \n        return val_A_A_star * (numerator / denominator)\n\n    def M_true_func(s_val):\n        \"\"\"\n        Calculates the prescribed true Mach number distribution.\n        \"\"\"\n        return 0.8 + 0.4 * np.exp(-((s_val - 0.6)**2) / (0.05**2))\n\n    # Static computations\n    M_true = M_true_func(s)\n    m0 = M_true + DELTA * np.sin(2 * np.pi * s)\n    A_A_star_true = A_A_star(M_true)\n\n    # --- 3. Strategies and Solver ---\n    \n    strategies = [\n        {'type': 'exact'},\n        {'type': 'fd', 'epsilon': 1e-6},\n        {'type': 'fd', 'epsilon': 1e-3},\n        {'type': 'frozen'}\n    ]\n    \n    convergence_rates = []\n\n    for strategy in strategies:\n        m = m0.copy()\n        errors = []\n\n        initial_error = np.linalg.norm(m - M_true, ord=np.inf)\n        errors.append(initial_error)\n        \n        if strategy['type'] == 'frozen':\n            J_frozen = dA_A_star_dM(m)\n            J_frozen[np.abs(J_frozen)  1e-12] = 1e-12\n\n        for _ in range(NUM_ITER):\n            R = A_A_star(m) - A_A_star_true\n            \n            if strategy['type'] == 'exact':\n                J = dA_A_star_dM(m)\n            elif strategy['type'] == 'fd':\n                epsilon = strategy['epsilon']\n                J = (A_A_star(m + epsilon) - A_A_star(m)) / epsilon\n            elif strategy['type'] == 'frozen':\n                J = J_frozen\n            \n            J[np.abs(J)  1e-12] = 1e-12\n\n            delta_m = -R / J\n            m = m + delta_m\n            \n            error = np.linalg.norm(m - M_true, ord=np.inf)\n            errors.append(error)\n\n        # --- 4. Convergence Rate Calculation ---\n        # p = log(e_{k+1}/e_k) / log(e_k/e_{k-1}) with k=7.\n        e_k_minus_1 = errors[6] \n        e_k = errors[7]         \n        e_k_plus_1 = errors[8]\n        \n        log_term_num = np.log(e_k_plus_1 / e_k) if e_k > 0 and e_k_plus_1 > 0 else -np.inf\n        log_term_den = np.log(e_k / e_k_minus_1) if e_k_minus_1 > 0 and e_k > 0 else -np.inf\n\n        if np.abs(log_term_den)  1e-9:\n            p = 1.0 \n        else:\n            p = log_term_num / log_term_den\n\n        convergence_rates.append(p)\n\n    # --- 5. Output ---\n    result_str = \",\".join([f\"{rate:.8f}\" for rate in convergence_rates])\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        }
    ]
}