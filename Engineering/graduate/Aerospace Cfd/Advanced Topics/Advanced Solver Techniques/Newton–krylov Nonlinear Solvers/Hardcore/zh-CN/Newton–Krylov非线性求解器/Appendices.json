{
    "hands_on_practices": [
        {
            "introduction": "非精确牛顿法（Inexact Newton method）的“非精确”之处在于其内部的线性系统求解过程是迭代且有容差的，而非一步到位。本练习聚焦于如何智能地控制这一求解精度，您将应用经典的 Eisenstat–Walker 策略来动态调整克里洛夫子空间求解器的收敛判据（即所谓的“强制项” $\\eta_k$）。通过该练习 ，您将理解如何平衡内外迭代的计算开销，从而设计出既能保证快速收敛又避免不必要计算的高效求解器。",
            "id": "3979960",
            "problem": "在应用于航空航天构型的稳态雷诺平均纳维-斯托克斯 (Reynolds-averaged Navier–Stokes) 残差方程 $F(u) = 0$ 的牛顿-克雷洛夫 (Newton–Krylov) 方法中，非线性迭代 $k$ 处的线性子问题根据非精确牛顿条件\n$$\n\\|F(u_k) + J(u_k) s_k\\| \\le \\eta_k \\,\\|F(u_k)\\|,\n$$\n被非精确地求解，其中 $J(u_k)$ 是当前迭代点 $u_k$ 处的雅可比矩阵，$s_k$ 是计算出的步长，$\\eta_k \\in [0,1)$ 是一个强迫参数，它自适应地控制克雷洛夫 (Krylov) 子空间线性求解的精度。采用一种自适应策略，其中 $\\eta_k$ 的选择基于连续非线性迭代中易于获得的残差范数，使用 Eisenstat–Walker II 方法。\n\n给定以下在迭代 $k-1$ 和 $k$ 的数据：\n- 非线性残差范数满足 $\\|F(u_{k-1})\\| = 3.2 \\times 10^{-2}$ 和 $\\|F(u_k)\\| = 1.6 \\times 10^{-2}$。\n- Eisenstat–Walker II 控制参数为 $\\gamma = 0.9$ 和 $\\alpha = 1.5$。\n- 施加了安全措施，使得 $\\eta_k \\in [\\eta_{\\min}, \\eta_{\\max}]$，其中 $\\eta_{\\min} = 1.0 \\times 10^{-4}$ 且 $\\eta_{\\max} = 0.9$。\n\n从上述非精确牛顿定义出发，并根据强迫参数应在非线性残差下降不快时放宽、在残差趋于零时收紧的原则，仅使用给定的残差范数和参数，根据 Eisenstat–Walker II 策略确定自适应的 $\\eta_k$，并应用给定的安全措施。当非线性残差在迭代过程中停滞或增加时，基于稳定性考虑，简要说明您所应用的任何安全措施的理由。\n\n将 $\\eta_k$ 的最终数值报告为单个实数，四舍五入到四位有效数字。不需要单位。",
            "solution": "该问题要求使用 Eisenstat–Walker II 策略确定非精确牛顿-克雷洛夫方法的自适应强迫参数 $\\eta_k$。我们首先验证问题陈述。\n\n### 第 1 步：提取已知条件\n- 待求解的非线性系统是稳态雷诺平均纳维-斯托克斯 (RANS) 残差方程，记为 $F(u) = 0$。\n- 非线性迭代 $k$ 处的非精确牛顿条件为 $\\|F(u_k) + J(u_k) s_k\\| \\le \\eta_k \\,\\|F(u_k)\\|$，其中 $u_k$ 是当前状态，$J(u_k)$ 是雅可比矩阵，$s_k$ 是更新步长，$\\eta_k \\in [0,1)$ 是强迫参数。\n- 选择 $\\eta_k$ 的自适应策略是 Eisenstat–Walker II 方法。\n- 迭代 $k-1$ 处的非线性残差范数为 $\\|F(u_{k-1})\\| = 3.2 \\times 10^{-2}$。\n- 迭代 $k$ 处的非线性残差范数为 $\\|F(u_k)\\| = 1.6 \\times 10^{-2}$。\n- Eisenstat–Walker II 控制参数 $\\gamma$ 为 $0.9$。\n- Eisenstat–Walker II 控制参数 $\\alpha$ 为 $1.5$。\n- 施加了安全措施，使得 $\\eta_k$ 必须位于区间 $[\\eta_{\\min}, \\eta_{\\max}]$ 内。\n- 最小安全值为 $\\eta_{\\min} = 1.0 \\times 10^{-4}$。\n- 最大安全值为 $\\eta_{\\max} = 0.9$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于计算流体力学（CFD）数值方法这一成熟领域。牛顿-克雷洛夫方法、RANS 方程以及 Eisenstat–Walker 自适应强迫策略是科学计算中标准的、严格定义的概念。所有方面均符合数值分析的基本原则。\n- **适定性**：该问题是适定的。它提供了计算 $\\eta_k$ 唯一值所需的所有数值和明确定义的算法（Eisenstat–Walker II）。\n- **客观性**：问题陈述使用了相关领域精确、客观和标准的术语。没有主观或模糊的陈述。\n\n### 第 3 步：结论与行动\n问题有效。我们开始求解。\n\nEisenstat–Walker II 策略的核心是根据观测到的非线性收敛速率，调整由 $\\eta_k$ 表示的线性求解的容差。该策略的一个常用公式如下，它使用连续非线性残差范数的比率作为收敛因子的代理：\n$$\n\\eta_k^{\\text{EW}} = \\gamma \\left( \\frac{\\|F(u_k)\\|}{\\|F(u_{k-1})\\|} \\right)^\\alpha\n$$\n这个公式调整 $\\eta_k$ 的方式是：如果非线性残差迅速减小（即比率 $\\|F(u_k)\\|/\\|F(u_{k-1})\\|$ 很小），则可以更精确地求解线性系统（较小的 $\\eta_k$）以维持超线性收敛。相反，如果非线性收敛缓慢（比率接近 $1$），则放宽线性求解的容差（较大的 $\\eta_k$）以避免浪费计算资源。\n\n我们已知以下数值：\n- $\\|F(u_k)\\| = 1.6 \\times 10^{-2}$\n- $\\|F(u_{k-1})\\| = 3.2 \\times 10^{-2}$\n- $\\gamma = 0.9$\n- $\\alpha = 1.5$\n\n首先，我们计算连续非线性残差范数的比率：\n$$\n\\frac{\\|F(u_k)\\|}{\\|F(u_{k-1})\\|} = \\frac{1.6 \\times 10^{-2}}{3.2 \\times 10^{-2}} = 0.5\n$$\n现在，我们将这个比率和给定的参数代入 Eisenstat–Walker 公式，计算建议的强迫项，我们将其记为 $\\eta_k^{\\text{EW}}$：\n$$\n\\eta_k^{\\text{EW}} = (0.9) \\times (0.5)^{1.5}\n$$\n我们可以计算这个表达式：\n$$\n(0.5)^{1.5} = (0.5)^{1} \\times (0.5)^{0.5} = 0.5 \\times \\sqrt{0.5} = 0.5 \\times \\frac{1}{\\sqrt{2}} = \\frac{1}{2\\sqrt{2}} = \\frac{\\sqrt{2}}{4}\n$$\n数值上，$\\frac{\\sqrt{2}}{4} \\approx \\frac{1.41421356}{4} \\approx 0.35355339$。\n因此，\n$$\n\\eta_k^{\\text{EW}} \\approx 0.9 \\times 0.35355339 \\approx 0.31819805\n$$\n下一步是应用安全措施。问题指出 $\\eta_k$ 必须在 $[\\eta_{\\min}, \\eta_{\\max}]$ 范围内，其中 $\\eta_{\\min} = 1.0 \\times 10^{-4} = 0.0001$ 且 $\\eta_{\\max} = 0.9$。$\\eta_k$ 的最终值通过将计算出的值 $\\eta_k^{\\text{EW}}$ 限定在此范围内来确定：\n$$\n\\eta_k = \\min(\\max(\\eta_k^{\\text{EW}}, \\eta_{\\min}), \\eta_{\\max})\n$$\n代入我们计算出的值：\n$$\n\\eta_k = \\min(\\max(0.31819805, 0.0001), 0.9)\n$$\n由于 $0.31819805 > 0.0001$，内部的 $\\max$ 函数求得 $0.31819805$。\n$$\n\\eta_k = \\min(0.31819805, 0.9)\n$$\n由于 $0.31819805  0.9$，最终值为：\n$$\n\\eta_k \\approx 0.31819805\n$$\n问题还要求对安全措施进行简要说明。在本次具体计算中，残差正在减小（$0.5  1$），因此主要考虑的安全措施是 $\\eta_{\\min}$ 和 $\\eta_{\\max}$。如果非线性残差停滞或增加，即 $\\|F(u_k)\\| \\ge \\|F(u_{k-1})\\|$，则比率将 $\\ge 1$。在这种情况下，$\\eta_k^{\\text{EW}}$ 的原始公式可能会产生一个大于 $\\gamma$ 的值，甚至可能大于 $1$。$\\eta_k \\ge 1$ 的值违反了非精确牛顿方法的收敛条件。因此，安全措施 $\\eta_k \\le \\eta_{\\max}$ 对稳定性至关重要。当收敛停滞时，将 $\\eta_k$ 设置为一个较高的值（如 $\\eta_{\\max}=0.9$）是一种标准做法；当非线性函数的底层线性模型效果不佳时，这可以防止在精确的线性求解上浪费计算资源，并依赖于全局化方法（例如，线搜索）来恢复收敛。在我们的案例中，这个安全措施并非以纠正的方式被触发，而仅仅是作为一个上限，我们计算出的值远低于此上限。安全措施 $\\eta_{\\min}$ 防止了对线性系统的过度求解，因为这在非线性收敛速度上的增益微不足道，却会耗费大量计算资源，尤其是在接近机器精度时。\n\n问题要求将 $\\eta_k$ 的最终数值四舍五入到四位有效数字。\n将 $0.31819805$ 四舍五入到四位有效数字得到 $0.3182$。",
            "answer": "$$\n\\boxed{0.3182}\n$$"
        },
        {
            "introduction": "在掌握了求解器内部的运作机制后，一个自然的问题是我们如何从理论上预估其整体性能。本练习将牛顿法二次收敛的抽象理论与一个可预测的模型联系起来，让您能够估算达到目标精度所需的总牛顿迭代次数。通过推导并应用该迭代次数的计算公式 ，您将学会如何根据问题的收敛特性来评估求解器的效率，并理解网格密度等因素如何影响实际的计算性能。",
            "id": "3979912",
            "problem": "考虑一个航空航天计算流体力学 (CFD) 求解器中可压缩 Navier–Stokes 方程的稳态离散化，这会得到一个非线性残差映射 $F:\\mathbb{R}^{m}\\rightarrow\\mathbb{R}^{m}$，其目标是 $F(u^{\\star})=0$。Newton–Krylov 方法通过使用 Krylov 子空间法近似求解 $F$ 在 $u_{k}$ 处的线性化来构造迭代项 $u_{k+1}$，并且，在精确内部求解以及对雅可比矩阵的标准光滑性和可逆性假设下，表现出局部二次收敛。假设在 $u^{\\star}$ 附近，残差范数的局部行为可以由单个收缩常数控制，并且所有需要的导数都存在且局部 Lipschitz 连续，同时雅可比矩阵在 $u^{\\star}$ 处可逆。\n\n从 Newton 法的定义和这些正则性假设出发，推导出一个关于最小 Newton 步数 $N$ 的界，该界需确保 $\\|F(u_{N})\\|\\leq \\tau$。该界应以初始残差 $r_{0}=\\|F(u_{0})\\|_2$、容差 $\\tau$ 以及一个局部二次收缩常数 $\\gamma\\in(0,1)$ 表示，此常数捕捉了雅可比矩阵可逆性和 Lipschitz 连续性在将误差收缩转化为残差收缩过程中的影响。然后，使用推导出的界，为两种 CFD 网格计算 $N$：\n\n- 粗网格: $r_{0,\\mathrm{c}}=1.5\\times 10^{-1}$ 且 $\\gamma_{\\mathrm{c}}=8.0\\times 10^{-1}$。\n- 细网格: $r_{0,\\mathrm{f}}=2.0\\times 10^{-1}$ 且 $\\gamma_{\\mathrm{f}}=1.0\\times 10^{-1}$。\n\n残差容差为 $\\tau=1.0\\times 10^{-10}$，并且对于所有 $k\\leq N$，迭代项都在二次收敛域内。作为参考，在生产 CFD 运行中观察到的经验 Newton 步数为：粗网格上 $N_{\\mathrm{obs,c}}=5$，细网格上 $N_{\\mathrm{obs,f}}=3$。以行矩阵形式报告 $(N_{\\mathrm{c}},N_{\\mathrm{f}})$ 的理论最小整数界。除了选择界所蕴含的最小整数外，不需要进行其他舍入。最终答案必须是一个计算结果。",
            "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 一个由稳态 CFD 离散化得到的非线性残差映射 $F:\\mathbb{R}^{m}\\rightarrow\\mathbb{R}^{m}$。\n- 目标是找到 $u^{\\star}$ 使得 $F(u^{\\star})=0$。\n- 方法是 Newton–Krylov 法，假设其表现出局部二次收敛。\n- 残差范数 $\\|F(u)\\|$ 的局部行为由一个单一的二次收缩常数 $\\gamma$ 控制。\n- 假设所有必要的导数都存在，局部 Lipschitz 连续，并且在 $u^{\\star}$ 处的雅可比矩阵是可逆的。\n- 目标是推导最小 Newton 步数 $N$ 的一个界，以确保 $\\|F(u_{N})\\| \\leq \\tau$。\n- 推导的输入是初始残差范数 $r_0 = \\|F(u_0)\\|$、容差 $\\tau$ 和收缩常数 $\\gamma$。\n- 假设所考虑的所有步骤中，迭代项都在二次收敛域内。\n- 粗网格 (c) 数据：$r_{0,\\mathrm{c}}=1.5\\times 10^{-1}$，$\\gamma_{\\mathrm{c}}=8.0\\times 10^{-1}$。\n- 细网格 (f) 数据：$r_{0,\\mathrm{f}}=2.0\\times 10^{-1}$，$\\gamma_{\\mathrm{f}}=1.0\\times 10^{-1}$。\n- 残差容差：$\\tau=1.0\\times 10^{-10}$。\n- 要求输出：$(N_{\\mathrm{c}}, N_{\\mathrm{f}})$ 的最小整数界，以行矩阵形式表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，描述了 Newton 法的局部收敛性分析，这是数值分析中的一个基本课题。诸如存在单一常数 $\\gamma$ 来模拟残差范数的二次收敛等假设，是此类分析中使用的标准简化。该问题是适定的，提供了推导界和计算所需值的所有必要信息。它不是不完整或矛盾的；“迭代项在二次收敛域内”的条件意味着初始状态已足够接近解，使得二次模型适用。该问题是客观的，并使用了偏微分方程数值方法领域的精确术语。\n\n### 步骤 3：结论与行动\n问题被判定为有效。将提供完整解答。\n\n问题要求我们首先推导出一个通用公式，用于计算将残差范数减小到指定容差 $\\tau$ 所需的最小 Newton 迭代次数 $N$。推导的核心依赖于所给出的二次收敛模型。\n\n令 $r_{k} = \\|F(u_{k})\\|$ 表示第 $k$ 次迭代时的残差范数。问题指出，收敛由一个常数 $\\gamma$ 进行二次控制，这可以表示为以下不等式：\n$$r_{k+1} \\leq \\gamma r_{k}^{2}$$\n为了继续，我们寻求一个用初始残差 $r_{0}$ 表示 $r_{k}$ 的非递归表达式。一种常用技术是缩放该不等式。我们定义一个缩放后的残差 $s_{k} = \\gamma r_{k}$。将不等式两边乘以 $\\gamma$ 得到：\n$$\\gamma r_{k+1} \\leq \\gamma (\\gamma r_{k}^{2})$$\n$$s_{k+1} \\leq (\\gamma r_{k})^{2} = s_{k}^{2}$$\n这个简化的递推关系 $s_{k+1} \\leq s_{k}^{2}$ 可以通过重复应用来展开：\n$$s_{1} \\leq s_{0}^{2}$$\n$$s_{2} \\leq s_{1}^{2} \\leq (s_{0}^{2})^{2} = s_{0}^{4} = s_{0}^{2^{2}}$$\n$$s_{3} \\leq s_{2}^{2} \\leq (s_{0}^{4})^{2} = s_{0}^{8} = s_{0}^{2^{3}}$$\n通过归纳法，我们得到第 $k$ 个缩放残差的通用公式：\n$$s_{k} \\leq s_{0}^{2^{k}}$$\n为保证收敛，缩放后的初始残差必须满足 $s_{0}  1$，这等价于 $\\gamma r_{0}  1$。这与迭代项在二次收敛域内的假设是一致的。\n\n将 $r_{k} = s_{k}/\\gamma$ 和 $r_{0} = s_{0}/\\gamma$ 代回，我们恢复未缩放残差范数的界：\n$$\\gamma r_{k} \\leq (\\gamma r_{0})^{2^{k}}$$\n$$r_{k} \\leq \\frac{1}{\\gamma} (\\gamma r_{0})^{2^{k}}$$\n我们需要找到最小的整数 $N$ 使得 $r_{N} \\leq \\tau$。我们将这个条件应用于我们推导出的界：\n$$\\frac{1}{\\gamma}(\\gamma r_{0})^{2^{N}} \\leq \\tau$$\n为了求解 $N$，我们首先分离出含有指数的项：\n$$(\\gamma r_{0})^{2^{N}} \\leq \\gamma \\tau$$\n对两边取自然对数，我们得到：\n$$2^{N} \\ln(\\gamma r_{0}) \\leq \\ln(\\gamma \\tau)$$\n因为收敛要求 $\\gamma r_{0}  1$，所以项 $\\ln(\\gamma r_{0})$ 是负数。因此，用它相除会反转不等号：\n$$2^{N} \\geq \\frac{\\ln(\\gamma \\tau)}{\\ln(\\gamma r_{0})}$$\n利用对数的性质，这可以写成一个更直观的形式：\n$$2^{N} \\geq \\frac{-\\ln(1/(\\gamma \\tau))}{-\\ln(1/(\\gamma r_{0}))} = \\frac{\\ln(1/(\\gamma \\tau))}{\\ln(1/(\\gamma r_{0}))}$$\n为了求解 $N$，我们对两边取以 2 为底的对数：\n$$N \\geq \\log_{2}\\left(\\frac{\\ln(1/(\\gamma \\tau))}{\\ln(1/(\\gamma r_{0}))}\\right)$$\n由于 $N$ 必须是整数，最小步数是右侧表达式的向上取整：\n$$N = \\left\\lceil \\log_{2}\\left(\\frac{\\ln(1/(\\gamma \\tau))}{\\ln(1/(\\gamma r_{0}))}\\right) \\right\\rceil$$\n我们现在将此公式应用于两个指定的情况。\n\n对于粗网格（下标 'c'）：\n给定参数为 $r_{0,\\mathrm{c}} = 1.5 \\times 10^{-1}$，$\\gamma_{\\mathrm{c}} = 8.0 \\times 10^{-1}$，以及 $\\tau = 1.0 \\times 10^{-10}$。\n首先，我们计算必要的中间乘积：\n$$\\gamma_{\\mathrm{c}} r_{0,\\mathrm{c}} = (8.0 \\times 10^{-1}) (1.5 \\times 10^{-1}) = 0.12$$\n$$\\gamma_{\\mathrm{c}} \\tau = (8.0 \\times 10^{-1}) (1.0 \\times 10^{-10}) = 8.0 \\times 10^{-11}$$\n$\\log_{2}$ 函数的参数是：\n$$\\frac{\\ln(1/(\\gamma_{\\mathrm{c}} \\tau))}{\\ln(1/(\\gamma_{\\mathrm{c}} r_{0,\\mathrm{c}}))} = \\frac{\\ln(1/(8.0 \\times 10^{-11}))}{\\ln(1/0.12)} \\approx \\frac{23.24906}{2.12026} \\approx 10.9651$$\n最小步数 $N_{\\mathrm{c}}$ 是：\n$$N_{\\mathrm{c}} = \\lceil \\log_{2}(10.9651) \\rceil = \\left\\lceil \\frac{\\ln(10.9651)}{\\ln(2)} \\right\\rceil \\approx \\lceil 3.4546 \\rceil = 4$$\n\n对于细网格（下标 'f'）：\n给定参数为 $r_{0,\\mathrm{f}} = 2.0 \\times 10^{-1}$，$\\gamma_{\\mathrm{f}} = 1.0 \\times 10^{-1}$，以及 $\\tau = 1.0 \\times 10^{-10}$。\n首先，我们计算必要的中间乘积：\n$$\\gamma_{\\mathrm{f}} r_{0,\\mathrm{f}} = (1.0 \\times 10^{-1}) (2.0 \\times 10^{-1}) = 0.02$$\n$$\\gamma_{\\mathrm{f}} \\tau = (1.0 \\times 10^{-1}) (1.0 \\times 10^{-10}) = 1.0 \\times 10^{-11}$$\n$\\log_{2}$ 函数的参数是：\n$$\\frac{\\ln(1/(\\gamma_{\\mathrm{f}} \\tau))}{\\ln(1/(\\gamma_{\\mathrm{f}} r_{0,\\mathrm{f}}))} = \\frac{\\ln(1/(1.0 \\times 10^{-11}))}{\\ln(1/0.02)} = \\frac{\\ln(10^{11})}{\\ln(50)} \\approx \\frac{25.32843}{3.91202} \\approx 6.4745$$\n最小步数 $N_{\\mathrm{f}}$ 是：\n$$N_{\\mathrm{f}} = \\lceil \\log_{2}(6.4745) \\rceil = \\left\\lceil \\frac{\\ln(6.4745)}{\\ln(2)} \\right\\rceil \\approx \\lceil 2.6948 \\rceil = 3$$\n理论上，粗网格和细网格所需的最小整数 Newton 步数分别为 4 和 3。结果应以行矩阵 $(N_{\\mathrm{c}}, N_{\\mathrm{f}})$ 的形式提供。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4  3 \\end{pmatrix}}\n$$"
        }
    ]
}