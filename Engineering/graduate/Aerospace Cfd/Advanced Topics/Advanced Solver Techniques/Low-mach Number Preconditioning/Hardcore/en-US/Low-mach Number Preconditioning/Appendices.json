{
    "hands_on_practices": [
        {
            "introduction": "The fundamental challenge in simulating low-Mach number flows with compressible solvers is the numerical stiffness caused by the vast disparity between convective and acoustic speeds. This practice guides you through deriving a simple yet effective preconditioning function from first principles, based on essential design criteria such as steady-state invariance and eigenvalue equalization at low Mach numbers . Mastering this derivation provides a foundational understanding of how preconditioning works to rescale the system's dynamics for efficient convergence.",
            "id": "3974443",
            "problem": "Consider the one-dimensional compressible Euler equations in conservative form for an ideal gas, which provide the foundation of Computational Fluid Dynamics (CFD) analysis of inviscid flows:\n$$\n\\frac{\\partial \\boldsymbol{Q}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0},\n$$\nwhere $\\boldsymbol{Q} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}$, $\\boldsymbol{F}(\\boldsymbol{Q}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(\\rho E + p) \\end{pmatrix}$, and the equation of state is $p = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^{2}\\right)$. The sound speed is $a = \\sqrt{\\gamma p / \\rho}$ and the Mach number is $M = |u|/a$. Low-Mach number preconditioning modifies the pseudo-time evolution used in steady computations by replacing the physical time derivative with a preconditioned pseudo-time derivative:\n$$\n\\boldsymbol{\\Gamma}^{-1}(M)\\,\\frac{\\partial \\boldsymbol{Q}}{\\partial \\tau} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0},\n$$\nwhere $\\boldsymbol{\\Gamma}(M)$ is a symmetric positive definite matrix that depends on the local Mach number $M$ and acts only on the pseudo-time derivative.\n\nStarting from the Euler equations and the ideal gas law, linearize about a uniform base state $(\\rho_{0}, u_{0}, p_{0})$ with $M \\in (0,1]$. Assume a scalar low-Mach preconditioning that effectively rescales the compressibility in the continuity-pressure coupling so that, in the linearized, preconditioned system, the pseudo-acoustic speed becomes $\\sqrt{\\alpha(M)}\\,a$ for some smooth scalar function $\\alpha(M)$, while the spatial flux Jacobian is left unmodified. Impose the following requirements:\n1. Steady-state invariance: the set of steady solutions of the preconditioned pseudo-time system must coincide with the steady solutions of the original Euler equations.\n2. Low-Mach equalization: in the limit $M \\to 0$, the largest characteristic speed magnitude governing the pseudo-time marching must scale as $\\mathcal{O}(|u_{0}|)$ (not $\\mathcal{O}(a)$).\n3. High-Mach consistency: as $M \\to 1$, the preconditioned system must recover the original acoustic scaling.\n\nUnder these constraints, derive a closed-form analytic expression for $\\alpha(M)$ in terms of the Mach number $M$ that satisfies all three conditions, and provide that expression as your final answer. The final answer must be a single analytic expression. No rounding is required and the answer is dimensionless.",
            "solution": "The user wants to derive a closed-form analytic expression for a scalar function $\\alpha(M)$ used in a low-Mach number preconditioning scheme for the one-dimensional Euler equations. The function $\\alpha(M)$ must satisfy three specific requirements.\n\nThe starting point is the one-dimensional compressible Euler equations in pseudo-time, preconditioned for low-Mach number computations:\n$$ \\boldsymbol{\\Gamma}^{-1}(M)\\,\\frac{\\partial \\boldsymbol{Q}}{\\partial \\tau} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0} $$\nHere, $\\boldsymbol{Q}$ is the vector of conserved variables, $\\boldsymbol{F}(\\boldsymbol{Q})$ is the flux vector, $\\tau$ is the pseudo-time, and $\\boldsymbol{\\Gamma}(M)$ is the preconditioning matrix. For steady-state computations, the system is evolved in pseudo-time until the term $\\partial \\boldsymbol{Q} / \\partial \\tau$ vanishes.\n\nThe characteristic speeds of this hyperbolic system govern the propagation of information in the pseudo-time domain $(\\tau, x)$. These speeds, denoted by $\\lambda'_p$, are the eigenvalues of the matrix product $\\boldsymbol{\\Gamma}(M)\\boldsymbol{A}(\\boldsymbol{Q})$, where $\\boldsymbol{A} = \\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{Q}}$ is the flux Jacobian of the original Euler equations.\n\nThe eigenvalues of the unpreconditioned flux Jacobian $\\boldsymbol{A}$ are well-known to be $\\{u, u+a, u-a\\}$, where $u$ is the fluid velocity and $a$ is the speed of sound. These correspond to one convective wave (entropy and vorticity) and two acoustic waves.\n\nThe problem states that the preconditioning scheme is designed such that \"the pseudo-acoustic speed becomes $\\sqrt{\\alpha(M)}a$\". In the context of characteristic analysis, the acoustic speeds are the propagation speeds of sound waves relative to the moving fluid, which are $\\pm a$ in the original system. The most direct interpretation of the problem statement is that the preconditioned system modifies these relative speeds to $\\pm \\sqrt{\\alpha(M)}a$. Assuming the convective speed $u$ remains the reference for the acoustic waves, the eigenvalues of the preconditioned system matrix $\\boldsymbol{\\Gamma A}$ are:\n$$ \\{\\lambda'_{p}\\} = \\{ u, u + \\sqrt{\\alpha(M)}a, u - \\sqrt{\\alpha(M)}a \\} $$\nWe will now use the three given requirements to determine the form of $\\alpha(M)$.\n\n1.  **Steady-state invariance:** The first requirement is that the steady solutions of the preconditioned system must be the same as those of the original Euler equations. At steady state, the pseudo-time derivative term is zero: $\\frac{\\partial \\boldsymbol{Q}}{\\partial \\tau} = \\boldsymbol{0}$. The preconditioned system reduces to $\\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0}$. This is identical to the steady-state form of the original Euler equations. This condition is satisfied by the structure of the preconditioned system, provided the preconditioning matrix $\\boldsymbol{\\Gamma}(M)$ is invertible (which is guaranteed as it is given to be positive definite). Thus, this requirement imposes no further constraints on the function $\\alpha(M)$.\n\n2.  **Low-Mach equalization:** The second requirement dictates the behavior of the system in the low-Mach number limit, $M \\to 0$. It states that the largest characteristic speed magnitude, $\\max_p |\\lambda'_p|$, must scale as $\\mathcal{O}(|u_0|)$. This is the core of low-Mach preconditioning: it aims to rescale the disparate characteristic speeds ($|u|$ and $|u \\pm a|$) to be of the same order of magnitude, thereby removing the stiffness associated with the large ratio $a/|u| = 1/M$.\n\n    The magnitudes of the preconditioned eigenvalues are $|u|$ and $|u \\pm \\sqrt{\\alpha(M)}a|$. The largest of these is generally $|u| + \\sqrt{\\alpha(M)}a$.\n    We require this largest magnitude to scale with $|u|$ as $M \\to 0$:\n    $$ |u| + \\sqrt{\\alpha(M)}a = \\mathcal{O}(|u|) $$\n    Since $|u|$ already scales as $\\mathcal{O}(|u|)$, this condition imposes a constraint on the second term:\n    $$ \\sqrt{\\alpha(M)}a = \\mathcal{O}(|u|) $$\n    Dividing by the sound speed $a$ (which is a finite, non-zero constant in the base state), we get:\n    $$ \\sqrt{\\alpha(M)} = \\mathcal{O}\\left(\\frac{|u|}{a}\\right) = \\mathcal{O}(M) $$\n    This implies that for small $M$, the function $\\alpha(M)$ must have the asymptotic behavior $\\alpha(M) \\sim k M^2$ for some dimensionless constant $k$ of order unity.\n\n3.  **High-Mach consistency:** The third requirement is that as the Mach number approaches unity ($M \\to 1$), the preconditioned system must recover the original acoustic scaling. This means the characteristic speeds of the preconditioned system must approach those of the original Euler equations.\n    $$ u \\pm \\sqrt{\\alpha(M)}a \\to u \\pm a \\quad \\text{as } M \\to 1 $$\n    This implies that $\\sqrt{\\alpha(M)} \\to 1$ as $M \\to 1$, which leads to the condition:\n    $$ \\alpha(M) \\to 1 \\quad \\text{as } M \\to 1 $$\n\nFinally, we must synthesize a single, smooth, closed-form analytic expression for $\\alpha(M)$ that satisfies the derived conditions for $M \\in (0, 1]$:\n- Condition from Requirement 2: $\\alpha(M) \\sim k M^2$ as $M \\to 0$.\n- Condition from Requirement 3: $\\alpha(1) = 1$.\n\nLet us seek the simplest possible analytic function that satisfies these constraints. A simple choice consistent with the low-Mach scaling is a power-law form, $\\alpha(M) = C M^n$. From the low-Mach condition, we must have the exponent $n=2$, so the form is $\\alpha(M) = C M^2$. Now, applying the high-Mach condition at $M=1$:\n$$ \\alpha(1) = C \\cdot (1)^2 = C $$\nFrom the requirement $\\alpha(1)=1$, we find that the constant $C$ must be $1$.\nThis leads to the unique simple solution:\n$$ \\alpha(M) = M^2 $$\nThis function is analytic and therefore smooth for all $M$. It satisfies the low-Mach requirement by setting the pseudo-acoustic speeds to $u \\pm Ma = u \\pm |u|$, ensuring all characteristic speed magnitudes scale with $|u|$. It satisfies the high-Mach consistency requirement, as for $M=1$, $\\alpha(1)=1^2=1$, correctly recovering the original acoustic speeds.",
            "answer": "$$\\boxed{M^{2}}$$"
        },
        {
            "introduction": "Once a preconditioning strategy is formulated, it is crucial to quantify its effectiveness. This exercise focuses on analyzing the performance gains by calculating two key metrics: the spectral condition number, which measures the clustering of eigenvalues, and the resulting increase in the maximum stable time step for an explicit scheme . By working through this analysis, you will develop a concrete appreciation for how manipulating the system's eigenvalues translates directly into accelerated solver performance.",
            "id": "3974411",
            "problem": "Consider the one-dimensional, non-dimensionalized compressible Euler equations linearized about a uniform base flow of Mach number $M>0$ with reference sound speed scaled to $a=1$ and base velocity $u=M$. The linearized system can be written in quasi-linear form as $\\partial_t \\mathbf{q} + \\mathbf{A} \\, \\partial_x \\mathbf{q} = 0$, where $\\mathbf{A}$ is the flux Jacobian. The characteristic speeds (eigenvalues of $\\mathbf{A}$) are $u$, $u+a$, and $u-a$. In a density-based steady solver that uses pseudo-time marching, a left preconditioning matrix $\\mathbf{P}$ is applied to the time derivative to alleviate low-Mach stiffness, yielding the preconditioned pseudo-time system $\\mathbf{P}\\,\\partial_t \\mathbf{q} + \\mathbf{A} \\, \\partial_x \\mathbf{q} = 0$, or equivalently $\\partial_t \\mathbf{q} + \\mathbf{A}_p \\,\\partial_x \\mathbf{q}=0$ with $\\mathbf{A}_p = \\mathbf{P}^{-1}\\mathbf{A}$. Suppose the preconditioner is designed to leave the convective mode unchanged while scaling the acoustic modes so that the modified acoustic speed is $\\tilde{a}=\\sqrt{\\beta}\\,M$, where the parameter $\\beta$ satisfies $0<\\beta<1$.\n\nUsing only the above physical setup and standard properties of the one-dimensional Euler characteristics, derive from first principles:\n\n- The spectral condition number $\\kappa$ of the preconditioned Jacobian $\\mathbf{A}_p$, defined as the ratio of the largest to the smallest strictly positive magnitude among the characteristic speeds of $\\mathbf{A}_p$.\n- The ratio $R$ of the maximum stable explicit time step under forward Euler for the preconditioned pseudo-time system to that of the unpreconditioned physical-time system, assuming a uniform grid of spacing $\\Delta x$ and a fixed Courant-Friedrichs-Lewy (CFL) number $\\text{CFL}_0$ applied consistently in both cases. Use the standard explicit stability bound $\\Delta t_{\\max} = \\text{CFL}_0 \\, \\Delta x / \\lambda_{\\max}$, where $\\lambda_{\\max}$ is the largest magnitude characteristic speed.\n\nProvide your final answer as a single row matrix containing the two closed-form expressions $(\\kappa, R)$ in terms of $M$ and $\\beta$. All variables are non-dimensional, so no physical units are required. Do not substitute numerical values. Do not round; provide exact symbolic expressions.",
            "solution": "The problem requires the derivation of two quantities related to the preconditioning of the one-dimensional compressible Euler equations: the spectral condition number $\\kappa$ of the preconditioned Jacobian $\\mathbf{A}_p$, and the ratio $R$ of the maximum stable explicit time steps for the preconditioned and unpreconditioned systems. The derivation will proceed from the given properties of the systems.\n\nFirst, let us establish the characteristic speeds (eigenvalues) for both the unpreconditioned and preconditioned systems.\n\nThe unpreconditioned system is given by $\\partial_t \\mathbf{q} + \\mathbf{A} \\, \\partial_x \\mathbf{q} = 0$. The problem states that the base flow has a velocity $u=M$ and the reference sound speed is $a=1$, where $M>0$ is the Mach number. The characteristic speeds, which are the eigenvalues of the flux Jacobian $\\mathbf{A}$, are given as $\\{u, u+a, u-a\\}$. Substituting the given values, the set of eigenvalues for the unpreconditioned system, denoted by $\\Lambda$, is:\n$$\n\\Lambda = \\{ M, M+1, M-1 \\}\n$$\n\nThe preconditioned system is $\\partial_t \\mathbf{q} + \\mathbf{A}_p \\,\\partial_x \\mathbf{q}=0$, where $\\mathbf{A}_p = \\mathbf{P}^{-1}\\mathbf{A}$. The problem specifies how the preconditioner $\\mathbf{P}$ alters the eigenvalues. Let the eigenvalues of $\\mathbf{A}_p$ be denoted by $\\Lambda_p$.\n1.  The convective mode is unchanged. The eigenvalue corresponding to the convective mode in the original system is $u=M$. Therefore, one eigenvalue of $\\mathbf{A}_p$ is $M$.\n2.  The acoustic modes are scaled such that the modified acoustic speed is $\\tilde{a} = \\sqrt{\\beta}\\,M$, where $0 < \\beta < 1$. The original acoustic modes correspond to eigenvalues $u \\pm a$. The preconditioned acoustic eigenvalues are thus $u \\pm \\tilde{a}$. Substituting $u=M$ and $\\tilde{a}$, we get $M \\pm \\sqrt{\\beta}\\,M$.\n\nSo, the set of eigenvalues for the preconditioned system, $\\Lambda_p$, is:\n$$\n\\Lambda_p = \\{ M, M + \\sqrt{\\beta}\\,M, M - \\sqrt{\\beta}\\,M \\} = \\{ M, M(1+\\sqrt{\\beta}), M(1-\\sqrt{\\beta}) \\}\n$$\n\nNow we can proceed to derive the two required quantities.\n\n1.  **Derivation of the Spectral Condition Number $\\kappa$**\n\nThe spectral condition number $\\kappa$ of the preconditioned Jacobian $\\mathbf{A}_p$ is defined as the ratio of the largest to the smallest strictly positive magnitude among its characteristic speeds.\n$$\n\\kappa = \\frac{\\max(|\\lambda_p| \\text{ for } \\lambda_p \\in \\Lambda_p)}{\\min(|\\lambda_p| > 0 \\text{ for } \\lambda_p \\in \\Lambda_p)}\n$$\nWe need to find the magnitudes of the eigenvalues in $\\Lambda_p$. Since $M > 0$ and $0 < \\beta < 1$, we have $0 < \\sqrt{\\beta} < 1$.\nThis implies:\n- $|\\lambda_{p,1}| = |M| = M$\n- $|\\lambda_{p,2}| = |M(1+\\sqrt{\\beta})| = M(1+\\sqrt{\\beta})$, since $1+\\sqrt{\\beta} > 0$.\n- $|\\lambda_{p,3}| = |M(1-\\sqrt{\\beta})| = M(1-\\sqrt{\\beta})$, since $1-\\sqrt{\\beta} > 0$.\n\nAll eigenvalues are strictly positive. We now find the maximum and minimum of these magnitudes.\nLet's compare the three values: $M$, $M(1+\\sqrt{\\beta})$, and $M(1-\\sqrt{\\beta})$.\nSince $\\sqrt{\\beta} > 0$, we have $M\\sqrt{\\beta} > 0$.\n- $M(1+\\sqrt{\\beta}) = M + M\\sqrt{\\beta} > M$.\n- $M(1-\\sqrt{\\beta}) = M - M\\sqrt{\\beta} < M$.\nThus, the maximum and minimum magnitude eigenvalues are:\n$$\n\\max(|\\lambda_p|) = M(1+\\sqrt{\\beta})\n$$\n$$\n\\min(|\\lambda_p|) = M(1-\\sqrt{\\beta})\n$$\nSubstituting these into the definition of $\\kappa$:\n$$\n\\kappa = \\frac{M(1+\\sqrt{\\beta})}{M(1-\\sqrt{\\beta})} = \\frac{1+\\sqrt{\\beta}}{1-\\sqrt{\\beta}}\n$$\n\n2.  **Derivation of the Time Step Ratio $R$**\n\nThe ratio $R$ is defined as $R = \\frac{\\Delta t_{\\text{max, precond}}}{\\Delta t_{\\text{max, unprecond}}}$. The maximum stable time step for an explicit method is given by the CFL condition: $\\Delta t_{\\max} = \\text{CFL}_0 \\, \\Delta x / \\lambda_{\\max}$, where $\\lambda_{\\max}$ is the largest magnitude of the characteristic speeds of the system. The terms $\\text{CFL}_0$ and $\\Delta x$ are constant for both systems.\nTherefore, the ratio $R$ can be written as:\n$$\nR = \\frac{\\frac{\\text{CFL}_0 \\, \\Delta x}{\\lambda_{\\max, \\text{precond}}}}{\\frac{\\text{CFL}_0 \\, \\Delta x}{\\lambda_{\\max, \\text{unprecond}}}} = \\frac{\\lambda_{\\max, \\text{unprecond}}}{\\lambda_{\\max, \\text{precond}}}\n$$\n\nFirst, we find $\\lambda_{\\max, \\text{unprecond}}$, the largest eigenvalue magnitude for the unpreconditioned system. The eigenvalues are $\\{M, M+1, M-1\\}$. Their magnitudes are $\\{|M|, |M+1|, |M-1|\\}$. Since $M>0$, we have $|M|=M$ and $|M+1|=M+1$.\n- If $0 < M < 1$, the magnitudes are $\\{M, M+1, 1-M\\}$. Comparing them, $M+1>M$ and $M+1 > 1-M$ (since $2M>0$). So, $\\lambda_{\\max, \\text{unprecond}} = M+1$.\n- If $M \\ge 1$, the magnitudes are $\\{M, M+1, M-1\\}$. Clearly, $\\lambda_{\\max, \\text{unprecond}} = M+1$.\nIn all cases for $M>0$, the largest eigenvalue magnitude is:\n$$\n\\lambda_{\\max, \\text{unprecond}} = M+1\n$$\n\nNext, we find $\\lambda_{\\max, \\text{precond}}$, the largest eigenvalue magnitude for the preconditioned system. As determined in the derivation of $\\kappa$, the eigenvalues are $\\{M, M(1+\\sqrt{\\beta}), M(1-\\sqrt{\\beta})\\}$, and their magnitudes are the same since they are all positive. The largest among them is:\n$$\n\\lambda_{\\max, \\text{precond}} = M(1+\\sqrt{\\beta})\n$$\n\nFinally, we compute the ratio $R$:\n$$\nR = \\frac{\\lambda_{\\max, \\text{unprecond}}}{\\lambda_{\\max, \\text{precond}}} = \\frac{M+1}{M(1+\\sqrt{\\beta})}\n$$\n\nThe two derived quantities are $\\kappa = \\frac{1+\\sqrt{\\beta}}{1-\\sqrt{\\beta}}$ and $R = \\frac{M+1}{M(1+\\sqrt{\\beta})}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1+\\sqrt{\\beta}}{1-\\sqrt{\\beta}} & \\frac{M+1}{M(1+\\sqrt{\\beta})} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "In modern CFD solvers, preconditioning is often coupled with advanced time-stepping strategies like dual-time stepping for unsteady problems. This practice places you in the context of such a solver, challenging you to determine the optimal pseudo-time step for the inner iterations of a preconditioned system . This problem bridges the gap between the theory of eigenvalue modification and the practical art of tuning a numerical solver for robust and rapid convergence.",
            "id": "3974413",
            "problem": "Aerospace Computational Fluid Dynamics (CFD) solvers for low Mach number flows often combine low-Mach preconditioning with dual-time stepping to handle the stiffness of the compressible equations. Consider the one-dimensional linearized compressible Euler equations about a uniform state with density $\\rho_{0}$, velocity $U_{0}$, pressure $p_{0}$, and speed of sound $a_{0}$, under small perturbations and spatially periodic boundary conditions. Let a uniform grid of spacing $\\Delta x$ be used with a centered differencing spatial discretization that is second order accurate in space. In dual-time stepping, the physical time derivative is discretized by first-order backward differencing over a time step $\\Delta t$, and the resulting nonlinear algebraic system is marched to convergence in a pseudo-time $\\tau$ using explicit forward Euler updates with step $\\Delta \\tau$.\n\nTo ameliorate the low-Mach number stiffness, a standard low-Mach preconditioning is applied that left-multiplies the time derivative operator by a matrix $\\mathbf{P}(\\beta)$ whose effect on the characteristic acoustic speeds is to scale them by $\\sqrt{\\beta}$. For low Mach number $M = U_{0}/a_{0} \\ll 1$, take $\\beta = M^{2}$. Assume plane-wave perturbations of the form $\\exp(i k x)$ and that the wavenumber is bounded by the discrete grid, $|k| \\le k_{\\max}$, with $k_{\\max} = \\pi/\\Delta x$ for the second-order centered difference stencil. The preconditioned characteristic phase speeds are then $U_{0}$ (entropy/vorticity) and $U_{0} \\pm a_{0}\\sqrt{\\beta}$ (acoustic). Under the backward Euler physical-time discretization and linearization about the uniform state, the pseudo-time error $\\varepsilon(\\tau)$ of a single Fourier mode satisfies a scalar ordinary differential equation\n$$\n\\frac{\\partial \\varepsilon}{\\partial \\tau} = -\\left(\\frac{1}{\\Delta t} + i\\,k\\,\\lambda\\right)\\,\\varepsilon,\n$$\nwhere $\\lambda$ is the phase speed of a characteristic family. The explicit forward Euler pseudo-time update for the linearized inner iteration is\n$$\n\\varepsilon^{m+1} = \\left(1 - \\Delta \\tau \\left(\\frac{1}{\\Delta t} + i\\,k\\,\\lambda\\right)\\right)\\varepsilon^{m}.\n$$\nDefine the per-iteration amplification factor magnitude for a mode with frequency $\\omega = k\\,\\lambda$ as\n$$\nG(\\Delta \\tau;\\,\\alpha,\\omega) = \\left|1 - \\Delta \\tau \\left(\\alpha + i\\,\\omega\\right)\\right|, \\quad \\alpha \\equiv \\frac{1}{\\Delta t}.\n$$\nFor robust convergence of the inner iterations across all resolved modes and characteristic families, choose $\\Delta \\tau$ to minimize the worst-case amplification factor at the largest resolvable frequency $\\omega_{\\max}$ corresponding to the fastest preconditioned characteristic family and $k_{\\max}$. That is, choose $\\Delta \\tau$ that minimizes $G(\\Delta \\tau;\\,\\alpha,\\omega_{\\max})$ with\n$$\n\\omega_{\\max} = k_{\\max}\\,\\max\\!\\left(\\left|U_{0}\\right|,\\,\\left|U_{0} + a_{0}\\sqrt{\\beta}\\right|,\\,\\left|U_{0} - a_{0}\\sqrt{\\beta}\\right|\\right).\n$$\n\nGiven the following physically consistent parameters:\n- Low Mach number flow with $U_{0} = 15$ in $\\mathrm{m\\,s^{-1}}$ and $a_{0} = 300$ in $\\mathrm{m\\,s^{-1}}$,\n- Grid spacing $\\Delta x = 0.01$ in $\\mathrm{m}$,\n- Convective Courant–Friedrichs–Lewy (CFL) number set to $C_{c} = U_{0}\\,\\Delta t/\\Delta x = 2$ to fix $\\Delta t$,\n\nderive from first principles the value of the pseudo-time step $\\Delta \\tau^{\\star}$ that minimizes $G(\\Delta \\tau;\\,\\alpha,\\omega_{\\max})$ as defined above, using the preconditioning choice $\\beta = M^{2}$ with $M = U_{0}/a_{0}$. Then compute the numerical value of $\\Delta \\tau^{\\star}$ for the given data. Round your final numerical answer to four significant figures. Express the final pseudo-time step in seconds.",
            "solution": "We begin from the linearized one-dimensional compressible Euler equations about a uniform state. Under small perturbations and Fourier decomposition with plane waves of the form $\\exp(i k x)$, the spatially continuous characteristics propagate with speeds $U_{0}$ (entropy/vorticity) and $U_{0} \\pm a_{0}$ (acoustic). On a uniform grid with second-order centered differencing, the resolvable wavenumber is bounded by $|k| \\le k_{\\max}$, where for the Nyquist limit $k_{\\max} = \\pi/\\Delta x$.\n\nLow Mach number stiffness arises because for $M = U_{0}/a_{0} \\ll 1$, the acoustic speeds are much larger than the advective speed $U_{0}$. Low-Mach preconditioning modifies the time derivative operator by a matrix $\\mathbf{P}(\\beta)$ that scales the acoustic eigenvalues such that the effective acoustic speeds are $U_{0} \\pm a_{0}\\sqrt{\\beta}$ while leaving the entropy/vorticity speed $U_{0}$ unchanged. A common choice for alleviating stiffness is $\\beta = M^{2}$; then $a_{0}\\sqrt{\\beta} = a_{0} M = U_{0}$, so the preconditioned acoustic speeds become $U_{0} \\pm U_{0}$, namely $0$ and $2U_{0}$, and the entropy/vorticity speed remains $U_{0}$. The largest magnitude among these characteristic speeds is thus\n$$\n\\max\\!\\left(\\left|U_{0}\\right|,\\,\\left|U_{0} + a_{0}\\sqrt{\\beta}\\right|,\\,\\left|U_{0} - a_{0}\\sqrt{\\beta}\\right|\\right) = \\max\\!\\left(\\left|U_{0}\\right|,\\,\\left|2U_{0}\\right|,\\,\\left|0\\right|\\right) = 2\\left|U_{0}\\right|.\n$$\n\nIn dual-time stepping, the physical time derivative is discretized by a first-order backward difference over $\\Delta t$, which after linearization about the uniform state contributes a real positive shift to the spectrum equal to $\\alpha = 1/\\Delta t$. The inner iteration in pseudo-time $\\tau$ is modeled by explicit forward Euler:\n$$\n\\varepsilon^{m+1} = \\left(1 - \\Delta \\tau (\\alpha + i \\omega)\\right) \\varepsilon^{m},\n$$\nwhere for a Fourier mode with wavenumber $k$ and characteristic phase speed $\\lambda$, the angular frequency is $\\omega = k\\,\\lambda$. The per-iteration amplification factor magnitude is\n$$\nG(\\Delta \\tau;\\,\\alpha,\\omega) = \\left|1 - \\Delta \\tau (\\alpha + i \\omega)\\right| = \\sqrt{(1 - \\alpha \\Delta \\tau)^{2} + (\\omega \\Delta \\tau)^{2}}.\n$$\n\nWe wish to choose $\\Delta \\tau$ to minimize the worst-case $G$ at the largest resolvable angular frequency $\\omega_{\\max}$, which occurs at $|k| = k_{\\max}$ with the fastest preconditioned characteristic speed (as derived above, magnitude $2|U_{0}|$). Therefore,\n$$\n\\omega_{\\max} = k_{\\max}\\,\\cdot 2|U_{0}| = \\frac{\\pi}{\\Delta x}\\,2|U_{0}| = \\frac{2\\pi |U_{0}|}{\\Delta x}.\n$$\n\nFor fixed $\\alpha$ and $\\omega_{\\max}$, minimizing $G(\\Delta \\tau;\\,\\alpha,\\omega_{\\max})$ over $\\Delta \\tau > 0$ is equivalent to minimizing its square,\n$$\n\\Phi(\\Delta \\tau) \\equiv (1 - \\alpha \\Delta \\tau)^{2} + (\\omega_{\\max} \\Delta \\tau)^{2}.\n$$\nCompute the derivative with respect to $\\Delta \\tau$ and set it to zero:\n$$\n\\frac{d\\Phi}{d\\Delta \\tau} = 2(1 - \\alpha \\Delta \\tau)(-\\alpha) + 2 \\omega_{\\max}^{2} \\Delta \\tau = 0.\n$$\nRearranging,\n$$\n-\\alpha (1 - \\alpha \\Delta \\tau) + \\omega_{\\max}^{2} \\Delta \\tau = 0 \\quad \\Rightarrow \\quad -\\alpha + \\alpha^{2} \\Delta \\tau + \\omega_{\\max}^{2} \\Delta \\tau = 0.\n$$\nThus,\n$$\n\\Delta \\tau^{\\star} = \\frac{\\alpha}{\\alpha^{2} + \\omega_{\\max}^{2}}.\n$$\nThis critical point is a global minimizer because $\\Phi$ is a strictly convex quadratic in $\\Delta \\tau$.\n\nWe now evaluate the parameters from the given data:\n\n1. The Mach number is $M = U_{0}/a_{0} = 15/300 = 0.05 \\ll 1$, so the preconditioning choice $\\beta = M^{2}$ is justified.\n\n2. The physical time step $\\Delta t$ is set by the convective Courant–Friedrichs–Lewy number $C_{c} = U_{0}\\,\\Delta t/\\Delta x = 2$, hence\n$$\n\\Delta t = \\frac{C_{c}\\,\\Delta x}{U_{0}} = \\frac{2 \\cdot 0.01}{15} = \\frac{0.02}{15} \\ \\mathrm{s}.\n$$\nTherefore,\n$$\n\\alpha = \\frac{1}{\\Delta t} = \\frac{15}{0.02} = 750 \\ \\mathrm{s^{-1}}.\n$$\n\n3. The maximum angular frequency under the preconditioned fastest characteristic and the grid bound is\n$$\n\\omega_{\\max} = \\frac{2\\pi U_{0}}{\\Delta x} = \\frac{2\\pi \\cdot 15}{0.01} = 3000\\pi \\ \\mathrm{s^{-1}}.\n$$\n\nSubstitute these into the optimal pseudo-time step expression:\n$$\n\\Delta \\tau^{\\star} = \\frac{\\alpha}{\\alpha^{2} + \\omega_{\\max}^{2}} = \\frac{750}{750^{2} + (3000\\pi)^{2}}.\n$$\nCompute the denominator symbolically using $\\pi^{2}$ to maintain accuracy:\n$$\n750^{2} = 562{,}500, \\quad (3000\\pi)^{2} = 9{,}000{,}000\\,\\pi^{2}.\n$$\nThus,\n$$\n\\Delta \\tau^{\\star} = \\frac{750}{562{,}500 + 9{,}000{,}000\\,\\pi^{2}}.\n$$\nFor a numerical value,\n$$\n\\pi^{2} \\approx 9.869604401, \\quad 9{,}000{,}000\\,\\pi^{2} \\approx 88{,}826{,}439.609, \\quad \\alpha^{2} + \\omega_{\\max}^{2} \\approx 89{,}388{,}939.610,\n$$\nso\n$$\n\\Delta \\tau^{\\star} \\approx \\frac{750}{89{,}388{,}939.610} \\ \\mathrm{s} \\approx 8.390 \\times 10^{-6} \\ \\mathrm{s}.\n$$\n\nRounded to four significant figures and expressed in seconds as requested, the optimal pseudo-time step is $8.390 \\times 10^{-6}$ in $\\mathrm{s}$.",
            "answer": "$$\\boxed{8.390 \\times 10^{-6}}$$"
        }
    ]
}