{
    "hands_on_practices": [
        {
            "introduction": "To appreciate the necessity of advanced absorption techniques like Perfectly Matched Layers, it is crucial to first understand the behavior of waves at simple, non-absorbing boundaries. This exercise examines the fundamental case of a wave encountering a perfectly rigid wall. By deriving the reflection coefficient, you will quantify the problem of spurious reflections and see how they create standing waves, a phenomenon that PMLs are specifically designed to eliminate in computational simulations. ",
            "id": "3984419",
            "problem": "Consider the one-dimensional linear acoustic wave equation $u_{tt} = c^{2} u_{xx}$ on the half-line $x \\in [0,\\infty)$, where $u(x,t)$ is the acoustic velocity potential, $t$ is time, and $c$ is the constant sound speed. The boundary at $x=0$ represents a perfectly rigid wall, which imposes the Neumann boundary condition $u_{x}(0,t)=0$. In aerospace computational fluid dynamics (CFD), truncating an unbounded domain without introducing spurious reflections is a central concern; a rigid-wall boundary is known to reflect waves and thus does not model an absorbing boundary such as a Perfectly Matched Layer (PML).\n\nAssume a time-harmonic plane wave solution exists in the domain. Let an incident plane wave propagating toward the boundary be represented by $u_{i}(x,t) = A \\exp\\!\\left(i(-k x - \\omega t)\\right)$ and a reflected plane wave propagating away from the boundary be represented by $u_{r}(x,t) = B \\exp\\!\\left(i(k x - \\omega t)\\right)$, with $k>0$ and $\\omega>0$ satisfying the dispersion relation appropriate for $u_{tt} = c^{2} u_{xx}$. The total field is $u(x,t) = u_{i}(x,t) + u_{r}(x,t)$. Define the complex reflection coefficient $R$ as the ratio of reflected to incident complex amplitudes, $R = B/A$.\n\nStarting only from the specified governing equation, the boundary condition, and the plane wave forms above, derive the exact expression for the reflection coefficient $R$ at the rigid-wall boundary and interpret qualitatively the resulting standing-wave pattern in $x \\ge 0$. Report the final answer as the exact complex number for $R$. No rounding is required, and no units are needed in the final answer.",
            "solution": "The starting point is the one-dimensional linear acoustic wave equation $u_{tt} = c^{2} u_{xx}$. We seek time-harmonic plane wave solutions of the form $u(x,t) = \\Re\\{U(x) \\exp(i \\omega t)\\}$, but it is convenient to work with complex exponentials for algebraic simplicity. For a plane wave ansatz $u(x,t) = \\exp\\!\\left(i(k x - \\omega t)\\right)$, substituting into $u_{tt} = c^{2} u_{xx}$ yields\n\n$$\n\\frac{\\partial^{2}}{\\partial t^{2}} \\exp\\!\\left(i(k x - \\omega t)\\right) = c^{2} \\frac{\\partial^{2}}{\\partial x^{2}} \\exp\\!\\left(i(k x - \\omega t)\\right).\n$$\n\nEvaluating derivatives gives\n\n$$\n(-\\omega^{2}) \\exp\\!\\left(i(k x - \\omega t)\\right) = c^{2} (-k^{2}) \\exp\\!\\left(i(k x - \\omega t)\\right),\n$$\n\nwhich simplifies to the dispersion relation\n\n$$\n\\omega^{2} = c^{2} k^{2}.\n$$\n\nFor $k>0$ and $\\omega>0$, this establishes that the wave equation is nondispersive with $\\omega = c k$ for rightward propagation and $\\omega = c k$ for leftward propagation as well, distinguished by the sign of $k$ in the phase.\n\nIn the half-line $x \\ge 0$ with a boundary at $x=0$, a leftward-propagating incident wave approaching the boundary can be written as\n\n$$\nu_{i}(x,t) = A \\exp\\!\\left(i(-k x - \\omega t)\\right),\n$$\n\nand the reflected rightward-propagating wave as\n\n$$\nu_{r}(x,t) = B \\exp\\!\\left(i(k x - \\omega t)\\right),\n$$\n\nwhere $A$ and $B$ are complex amplitudes and $k>0$. The total field is then\n\n$$\nu(x,t) = u_{i}(x,t) + u_{r}(x,t) = A \\exp\\!\\left(i(-k x - \\omega t)\\right) + B \\exp\\!\\left(i(k x - \\omega t)\\right).\n$$\n\nImposing the rigid-wall Neumann boundary condition $u_{x}(0,t) = 0$ determines the reflection coefficient. Compute the spatial derivative:\n\n$$\nu_{x}(x,t) = \\frac{\\partial}{\\partial x}\\left[A \\exp\\!\\left(i(-k x - \\omega t)\\right) + B \\exp\\!\\left(i(k x - \\omega t)\\right)\\right]\n= A \\left(-i k\\right) \\exp\\!\\left(i(-k x - \\omega t)\\right) + B \\left(i k\\right) \\exp\\!\\left(i(k x - \\omega t)\\right).\n$$\n\nEvaluate at $x=0$:\n\n$$\nu_{x}(0,t) = (-i k) A \\exp\\!\\left(-i \\omega t\\right) + (i k) B \\exp\\!\\left(-i \\omega t\\right) = i k \\exp\\!\\left(-i \\omega t\\right)\\left(B - A\\right).\n$$\n\nThe Neumann boundary condition requires $u_{x}(0,t)=0$ for all $t$, hence\n\n$$\ni k \\exp\\!\\left(-i \\omega t\\right)\\left(B - A\\right) = 0 \\quad \\Rightarrow \\quad B - A = 0 \\quad \\Rightarrow \\quad B = A.\n$$\n\nBy the definition $R = B/A$, it follows immediately that\n\n$$\nR = \\frac{B}{A} = 1.\n$$\n\nThis result has a clear physical interpretation. A rigid-wall (Neumann) boundary reflects an incident acoustic plane wave with unit magnitude and zero phase shift relative to the incident wave. The total field forms a standing wave. To see this explicitly, substitute $B=A$ into $u(x,t)$:\n\n$$\nu(x,t) = A \\exp\\!\\left(-i \\omega t\\right)\\left[\\exp\\!\\left(-i k x\\right) + \\exp\\!\\left(i k x\\right)\\right] = 2 A \\exp\\!\\left(-i \\omega t\\right) \\cos(k x).\n$$\n\nThus, the spatial structure is proportional to $\\cos(k x)$, with antinodes at positions $x = n \\pi / k$ for integer $n \\ge 0$ and nodes at positions where $\\cos(k x) = 0$, that is $x = (2 n + 1)\\pi/(2 k)$ for integer $n \\ge 0$. In the context of aerospace computational fluid dynamics, this perfect reflection (with $|R|=1$) exemplifies how a non-absorbing truncation (rigid-wall boundary) can produce strong standing waves. By contrast, a Perfectly Matched Layer is designed so that the effective reflection coefficient $R$ is approximately zero across a broad range of frequencies and incidence angles, thereby suppressing standing-wave interference in truncated computational domains.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Before the widespread adoption of PMLs, simpler methods known as Absorbing Boundary Conditions (ABCs) were developed to mitigate wave reflections. This practice explores the effectiveness of a first-order ABC, a classic approach designed to absorb waves arriving at a normal angle. By analyzing how the reflection coefficient changes with the angle of incidence, you will uncover the primary limitation of these local ABCs and understand why they are insufficient for the complex wave fields often encountered in aeroacoustics. ",
            "id": "3984406",
            "problem": "Consider aeroacoustic wave propagation in a two-dimensional (2D) half-space domain $\\{(x,y) \\in \\mathbb{R}^2 : x \\le 0\\}$ filled with a homogeneous quiescent medium of constant sound speed $c$. The scalar acoustic pressure perturbation $u(x,y,t)$ satisfies the linear wave equation $u_{tt} = c^2 (u_{xx} + u_{yy})$. A plane boundary is located at $x=0$ and is intended to serve as an outflow boundary for waves exiting the computational domain. To model wave absorption, the boundary imposes a first-order Engquist–Majda Absorbing Boundary Condition (ABC) of the form $u_t + c\\,u_x = 0$ at $x=0$.\n\nA time-harmonic plane wave of angular frequency $\\omega$ and wave vector $(k_x,k_y)$, with $k = \\sqrt{k_x^2 + k_y^2}$ and dispersion $\\omega = c\\,k$, impinges obliquely on the boundary from the interior (i.e., it propagates toward increasing $x$ so that $k_x > 0$). The incident field is\n$$\nu^{\\mathrm{inc}}(x,y,t) = \\exp\\!\\big(i(k_x x + k_y y - \\omega t)\\big),\n$$\nand the reflected field has the form\n$$\nu^{\\mathrm{ref}}(x,y,t) = R\\,\\exp\\!\\big(i(-k_x x + k_y y - \\omega t)\\big),\n$$\nwhere $R$ is the complex-valued reflection coefficient (amplitude ratio) generated by the boundary. Define the incidence angle $\\theta \\in [0,\\pi/2)$ with respect to the boundary normal (the $+x$ direction) by $k_x = k \\cos\\theta$ and $k_y = k \\sin\\theta$, and take $\\theta$ in radians.\n\nStarting from the governing wave equation and the stated boundary condition, and without invoking any pre-derived boundary reflection formulas, derive the closed-form dependence of the reflection coefficient $R$ on the incidence angle $\\theta$. Express your final answer as a single analytic expression $R(\\theta)$ in terms of $\\theta$. No rounding is required. The reflection coefficient is dimensionless; do not include units in your final expression.",
            "solution": "The total acoustic pressure field, $u(x,y,t)$, is the linear superposition of the incident and reflected waves:\n$$\nu(x,y,t) = u^{\\mathrm{inc}}(x,y,t) + u^{\\mathrm{ref}}(x,y,t)\n$$\nSubstituting the given expressions for the incident and reflected fields yields:\n$$\nu(x,y,t) = \\exp\\!\\big(i(k_x x + k_y y - \\omega t)\\big) + R\\,\\exp\\!\\big(i(-k_x x + k_y y - \\omega t)\\big)\n$$\nThis total field $u$ must satisfy the first-order Engquist–Majda absorbing boundary condition at the boundary $x=0$:\n$$\n\\frac{\\partial u}{\\partial t} + c\\frac{\\partial u}{\\partial x} = 0 \\quad \\text{at } x=0\n$$\nTo apply this condition, we first compute the required partial derivatives of $u(x,y,t)$. The partial derivative with respect to time $t$ is:\n$$\n\\frac{\\partial u}{\\partial t} = (-i\\omega)\\exp\\!\\big(i(k_x x + k_y y - \\omega t)\\big) + R(-i\\omega)\\exp\\!\\big(i(-k_x x + k_y y - \\omega t)\\big)\n$$\nThe partial derivative with respect to position $x$ is:\n$$\n\\frac{\\partial u}{\\partial x} = (ik_x)\\exp\\!\\big(i(k_x x + k_y y - \\omega t)\\big) + R(-ik_x)\\exp\\!\\big(i(-k_x x + k_y y - \\omega t)\\big)\n$$\nNow, we evaluate these derivatives at the boundary $x=0$:\n$$\n\\left.\\frac{\\partial u}{\\partial t}\\right|_{x=0} = -i\\omega (1+R) \\exp\\!\\big(i(k_y y - \\omega t)\\big)\n$$\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=0} = ik_x (1-R) \\exp\\!\\big(i(k_y y - \\omega t)\\big)\n$$\nWe substitute these expressions into the boundary condition equation:\n$$\n-i\\omega (1+R) \\exp\\!\\big(i(k_y y - \\omega t)\\big) + c \\left[ ik_x (1-R) \\exp\\!\\big(i(k_y y - \\omega t)\\big) \\right] = 0\n$$\nSince the term $\\exp\\!\\big(i(k_y y - \\omega t)\\big)$ is non-zero, we can divide the entire equation by it. We can also divide by the common factor $i$:\n$$\n-\\omega (1+R) + c k_x (1-R) = 0\n$$\nNow, we solve this algebraic equation for the reflection coefficient $R$:\n$$\nc k_x - \\omega = R(\\omega + c k_x)\n$$\n$$\nR = \\frac{c k_x - \\omega}{c k_x + \\omega}\n$$\nThe problem requires the answer to be expressed in terms of the incidence angle $\\theta$. We use the given relations $k_x = k \\cos\\theta$ and the dispersion relation $\\omega = c k$. Substituting these into the expression for $R$:\n$$\nR(\\theta) = \\frac{c (k \\cos\\theta) - (c k)}{c (k \\cos\\theta) + (c k)} = \\frac{c k (\\cos\\theta - 1)}{c k (\\cos\\theta + 1)}\n$$\n$$\nR(\\theta) = \\frac{\\cos\\theta - 1}{\\cos\\theta + 1}\n$$\nThis is the closed-form expression for the reflection coefficient $R$ as a function of the incidence angle $\\theta$. The boundary condition is perfectly absorbing ($R=0$) only for normal incidence ($\\theta = 0$, $\\cos\\theta=1$), where $R(0) = 0$. For any other angle $\\theta \\neq 0$, there is a non-zero reflection.",
            "answer": "$$\n\\boxed{\\frac{\\cos\\theta - 1}{\\cos\\theta + 1}}\n$$"
        },
        {
            "introduction": "Modern computational fluid dynamics solvers often implement PMLs in the time domain using an elegant technique known as the Auxiliary Differential Equation (ADE) formulation. This hands-on coding exercise takes you into the computational core of an ADE PML, focusing on a single memory variable that models the layer's absorptive properties. By deriving and numerically verifying the system's impulse response, you will confirm the essential properties of causality and exponential decay that make the ADE PML an effective and stable tool for wave absorption. ",
            "id": "3984392",
            "problem": "You are given a one-dimensional, linear, time-invariant auxiliary differential equation Perfectly Matched Layer (ADE PML) model used to absorb outgoing waves in computational domains for Computational Fluid Dynamics (CFD) in aerospace applications. In the time domain, the ADE PML introduces a memory variable that models the complex-frequency-shifted coordinate stretching. Consider the scalar memory variable governed by the ordinary differential equation $\\frac{d \\psi(t)}{d t} + (\\alpha + \\sigma)\\, \\psi(t) = \\sigma\\, f(t)$, where $\\psi(t)$ is the auxiliary field, $f(t)$ is an input excitation, $\\alpha \\ge 0$ and $\\sigma \\ge 0$ are parameters in units of $\\mathrm{s}^{-1}$ that arise from the complex frequency shift and conductivity of the layer, respectively. The input for this problem is an impulse, $f(t) = \\delta(t)$, where $\\delta(t)$ is the Dirac delta distribution, and the initial condition is $\\psi(0^{-}) = 0$.\n\nStarting only from the above differential equation, the definition of the Dirac delta, the Laplace transform, and the properties of linear time-invariant systems, you must analyze the impulse response $h(t)$ of the ADE PML subsystem and confirm two properties:\n1. Causality: $h(t) = 0$ for all $t < 0$.\n2. Exponential decay with a rate governed by $\\alpha$ and $\\sigma$.\n\nYour task is to implement a program that:\n- Computes the impulse response $h(t)$ on a uniform time grid that includes negative and positive times.\n- Verifies causality numerically by checking that $h(t)$ is exactly $0$ for $t < 0$ on the grid.\n- Estimates the decay rate by fitting $\\log\\left(h(t)/h(0^{+})\\right)$ versus $t$ for $t > 0$ using least squares, where $h(0^{+})$ is the right-sided limit of $h(t)$ at $t=0$.\n- Compares the estimated decay rate to the theoretical rate implied by the governing equation.\n- Handles the trivial case where the impulse response is identically zero.\n\nUse the following test suite of parameter pairs $(\\alpha,\\sigma)$, all in $\\mathrm{s}^{-1}$:\n- Case $1$: $(\\alpha,\\sigma) = (50, 100)$.\n- Case $2$: $(\\alpha,\\sigma) = (0, 10)$.\n- Case $3$: $(\\alpha,\\sigma) = (10, 0)$.\n- Case $4$: $(\\alpha,\\sigma) = (0, 0)$.\n- Case $5$: $(\\alpha,\\sigma) = (1, 2)$.\n\nConstruct a uniform time grid $t \\in [t_{\\min}, t_{\\max}]$ with $t_{\\min} = -0.01\\,\\mathrm{s}$, $t_{\\max} = 1.0\\,\\mathrm{s}$, and time step $\\Delta t = 10^{-3}\\,\\mathrm{s}$. Treat the decay rates in units of $\\mathrm{s}^{-1}$ and express them as floating-point numbers. For each test case, your program must output a list containing:\n- A boolean indicating whether the response is causal on the sampled grid.\n- A boolean indicating whether the numerically estimated decay rate matches the theoretical rate within a relative tolerance of $0.01$ (i.e., $1 \\times 10^{-2}$) when the response is nontrivial; for a trivial zero response, this boolean must be true if both the measured and theoretical rates are $0$.\n- The measured decay rate in $\\mathrm{s}^{-1}$.\n- The theoretical decay rate in $\\mathrm{s}^{-1}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list in the order described above. For example, the output format must be\n$$[\\,[\\text{bool},\\text{bool},\\text{float},\\text{float}],\\ldots\\,],$$\nwith no additional text. All computations must be deterministic and reproducible without user input.",
            "solution": "### Analytical Solution and System Properties\n\nBy definition, the impulse response $h(t)$ is the solution $\\psi(t)$ to the governing equation when the input is $f(t) = \\delta(t)$ and the system starts from rest, i.e., $h(t)=0$ for $t<0$. The differential equation for the impulse response is:\n$$ \\frac{d h(t)}{d t} + (\\alpha + \\sigma)\\, h(t) = \\sigma\\, \\delta(t) $$\nwith the initial condition $h(0^{-}) = 0$.\n\nWe solve this equation using the Laplace transform, denoted by $\\mathcal{L}\\{\\cdot\\}$. Let $H(s) = \\mathcal{L}\\{h(t)\\}$. Using the properties of the Laplace transform, specifically $\\mathcal{L}\\{\\frac{dh}{dt}\\} = s H(s) - h(0^{-})$ and $\\mathcal{L}\\{\\delta(t)\\} = 1$, we transform the differential equation into an algebraic equation in the complex frequency domain $s$:\n$$ s H(s) + (\\alpha + \\sigma) H(s) = \\sigma $$\nSolving for the transfer function $H(s)$:\n$$ H(s) = \\frac{\\sigma}{s + (\\alpha + \\sigma)} $$\nTo find the impulse response $h(t)$ in the time domain, we compute the inverse Laplace transform of $H(s)$. We use the standard transform pair $\\mathcal{L}^{-1}\\left\\{\\frac{1}{s+a}\\right\\} = e^{-at} u(t)$, where $u(t)$ is the Heaviside step function.\n$$ h(t) = \\sigma \\, \\mathcal{L}^{-1}\\left\\{ \\frac{1}{s + (\\alpha + \\sigma)} \\right\\} = \\sigma e^{-(\\alpha + \\sigma)t} u(t) $$\n\n**1. Causality**\nThe presence of the Heaviside function $u(t)$ in the solution explicitly enforces the property that $h(t) = 0$ for all $t < 0$. This confirms that the system is causal.\n\n**2. Exponential Decay**\nFor $t > 0$, the impulse response simplifies to $h(t) = \\sigma e^{-(\\alpha + \\sigma)t}$. This is an exponential decay with a **theoretical decay rate** of:\n$$ k_{th} = \\alpha + \\sigma $$\nThe constraints $\\alpha \\ge 0$ and $\\sigma \\ge 0$ ensure that the decay rate $k_{th} \\ge 0$, guaranteeing stability. If $\\sigma = 0$, the impulse response $h(t)$ is identically zero.\n\n### Numerical Verification Scheme\n\nThe program will implement the following for each parameter pair $(\\alpha, \\sigma)$.\n\n**1. Impulse Response Computation:** The analytical solution $h(t) = \\sigma e^{-(\\alpha + \\sigma)t} u(t)$ is evaluated on the specified time grid.\n\n**2. Causality Check:** The program verifies that all computed values of $h(t)$ for $t < 0$ are exactly zero.\n\n**3. Decay Rate Estimation:**\nThe decay rate is estimated by fitting a model to the computed response for $t > 0$. We analyze the logarithm of the normalized response:\n$$ y(t) = \\log\\left(\\frac{h(t)}{h(0^{+})}\\right) = \\log\\left( \\frac{\\sigma e^{-(\\alpha + \\sigma)t}}{\\sigma} \\right) = -(\\alpha + \\sigma)t $$\nThis shows that $y(t)$ is a linear function of $t$ with a slope $m = -(\\alpha + \\sigma)$. The estimated decay rate is $k_{est} = -m$. Numerically, for $\\sigma > 0$, we perform a linear least-squares fit for the model $y = mt$ on the data points $(t_i, y_i)$ where $t_i>0$ and $y_i=\\log(h(t_i)/\\sigma)$. The measured decay rate is $k_{est} = -m$. For the trivial case $\\sigma = 0$, $h(t)$ is zero, so the measured rate is set to $0$.\n\n**4. Rate Comparison:**\nThe measured decay rate $k_{est}$ is compared against the theoretical rate $k_{th} = \\alpha + \\sigma$.\n- If $k_{th} > 0$, the rates match if the relative error $\\frac{|k_{est} - k_{th}|}{k_{th}} \\le 0.01$.\n- If $k_{th} = 0$ (which only happens for $\\alpha=0, \\sigma=0$), the rates match if $k_{est}$ is also $0$. For the case $\\sigma=0, \\alpha>0$, the theoretical rate is $\\alpha$ while the measured rate is $0$, so they do not match.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the impulse response of an ADE PML subsystem for given parameters.\n    For each test case, it computes the impulse response, verifies causality,\n    estimates the decay rate numerically, and compares it to the theoretical rate.\n    \"\"\"\n    # Define problem constants\n    t_min = -0.01\n    t_max = 1.0\n    dt = 0.001\n    rel_tol = 1e-2\n\n    # Construct the time grid\n    # Use round to prevent floating point inaccuracies in num_points calculation\n    num_points = int(round((t_max - t_min) / dt)) + 1\n    t = np.linspace(t_min, t_max, num_points)\n\n    # Define the test suite of parameter pairs (alpha, sigma)\n    test_cases = [\n        (50.0, 100.0),\n        (0.0, 10.0),\n        (10.0, 0.0),\n        (0.0, 0.0),\n        (1.0, 2.0)\n    ]\n\n    all_results = []\n    for alpha, sigma in test_cases:\n        # Theoretical decay rate is k = alpha + sigma\n        k_th = alpha + sigma\n\n        # Compute the analytical impulse response h(t) = sigma * exp(-(alpha+sigma)t) * u(t)\n        # where u(t) is the Heaviside step function.\n        h = np.zeros_like(t, dtype=float)\n        t_non_negative_mask = (t >= 0)\n        t_non_negative = t[t_non_negative_mask]\n        \n        # Only compute exponentiation if sigma is not zero\n        if sigma != 0:\n            h[t_non_negative_mask] = sigma * np.exp(-k_th * t_non_negative)\n\n        # Verify causality: h(t) must be 0 for t  0.\n        is_causal = np.all(h[t  0] == 0.0)\n\n        # Estimate the decay rate by fitting log(h(t)/h(0+)) vs t for t > 0.\n        # h(0+) = sigma. The model is log(h(t)/sigma) = -k*t, a line through the origin.\n        measured_rate = 0.0\n        rate_matches = False\n\n        if sigma == 0:\n            # Trivial zero response case\n            measured_rate = 0.0\n            # Per problem spec, match is True iff both measured and theoretical rates are 0.\n            # a measured_rate of 0 is assigned for this case.\n            # We compare with the theoretical rate k_th = alpha + 0 = alpha.\n            if k_th == 0.0:\n                rate_matches = True\n            else:\n                rate_matches = False\n        else: # Non-trivial response case (sigma > 0)\n            t_fit = t[t > 0]\n            h_fit = h[t > 0]\n            \n            # Ensure there are points to fit. This should always be true for the given grid.\n            if t_fit.size > 0:\n                # The model is y = m*t, where y=log(h/sigma) and m = -k_est\n                y_fit = np.log(h_fit / sigma)\n                \n                # Use np.linalg.lstsq to find the slope m.\n                # A needs to be a column vector for lstsq.\n                A = t_fit[:, np.newaxis]\n                \n                # Solve the least-squares problem A*m = y_fit\n                m_solution, _, _, _ = np.linalg.lstsq(A, y_fit, rcond=None)\n                slope = m_solution[0]\n                \n                measured_rate = -slope\n\n                # Compare the measured rate to the theoretical rate\n                if k_th == 0.0: \n                    # This case does not occur for sigma>0 with problem constraints (alpha>=0)\n                    # But for robustness, we use an absolute comparison.\n                    if np.isclose(measured_rate, 0.0, atol=rel_tol):\n                        rate_matches = True\n                else:\n                    # Use relative tolerance for non-zero theoretical rates\n                    if abs(measured_rate - k_th) / k_th = rel_tol:\n                        rate_matches = True\n            # else branch for t_fit.size == 0 is not needed for this problem's grid.\n\n        # Append results for the current test case\n        all_results.append([is_causal, rate_matches, measured_rate, k_th])\n\n    # Format the final output string as a list of lists.\n    # Booleans are converted to their standard string representations 'True' or 'False'.\n    # Floats are formatted to a consistent precision.\n    result_strings = []\n    for c, m, r, t_val in all_results:\n        result_strings.append(f\"[{str(c).lower()},{str(m).lower()},{r:.7f},{t_val:.7f}]\")\n    \n    # Print the final output in the exact required format.\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        }
    ]
}