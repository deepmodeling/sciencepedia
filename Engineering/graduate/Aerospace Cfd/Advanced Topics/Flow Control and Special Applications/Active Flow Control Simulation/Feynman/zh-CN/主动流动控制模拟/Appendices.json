{
    "hands_on_practices": [
        {
            "introduction": "在进行流动控制之前，我们必须能在仿真中精确地表示作动器的影响。本练习将演示如何使用简化的边界条件来模拟合成射流，并利用广为接受的动量系数 $C_\\mu$ 来量化其强度。这构成了物理作动器与其数值实现之间的基本联系。",
            "id": "3941259",
            "problem": "考虑一个在计算流体动力学(CFD)模拟中，平嵌于高升力翼型表面的合成射流作动器(SJA)。该作动器被建模为一个施加在面积为 $A_{j}$ 的狭缝上的时变周期性壁面法向速度边界条件，其在狭缝上具有空间均匀的速度剖面，且在一个驱动周期内平均质量通量为零。具体而言，狭缝处的壁面法向速度被规定为 $v_{j}(t) = V_{a}\\sin(\\omega t)$，其中 $V_{a}$ 是峰值振幅，$\\omega$ 是角频率。外部自由流是均匀的，速度为 $U_{\\infty}$，密度为 $\\rho_{\\infty}$，并选择了与受控表面相关的空气动力学参考面积 $S$。射流流体密度为 $\\rho_{j}$。假设作动器仅在吹气半周期内（即当 $v_{j}(t) > 0$ 时）产生向外的射流，而在另一半的吸气周期内不向外部流场注入动量。\n\n从应用于跨越狭缝的扁平pillbox控制体的线性动量雷诺输运定理(RTT)出发，并使用通量的第一性原理定义，推导在一个驱动周期内输入到外部流场中的时间平均向外动量，用 $\\rho_{j}$、$A_{j}$ 和 $v_{j}(t)$ 表示。利用此结果，将无量纲动量系数 $C_{\\mu}$ 定义为时间平均向外动量输入与自由流动压标量乘以 $S$ 的比值，并为给定的正弦驱动导出 $C_{\\mu}$ 关于 $\\rho_{j}$、$\\rho_{\\infty}$、$U_{\\infty}$、$A_{j}$、$S$ 和 $V_{a}$ 的封闭形式表达式。然后，对于空气，当 $\\rho_{\\infty} = \\rho_{j} = $ $1.2$ kg/m$^{3}$，自由流速度 $U_{\\infty} = $ $30$ m/s，狭缝面积 $A_{j} = $ $5.0 \\times 10^{-5}$ m$^{2}$，驱动振幅 $V_{a} = $ $100$ m/s，参考面积 $S = $ $0.10$ m$^{2}$ 时，计算 $C_{\\mu}$ 的数值。将最终答案表示为无量纲数，并四舍五入至四位有效数字。",
            "solution": "首先验证问题，以确保其具有科学依据、良态且客观。\n\n### 步骤 1：提取已知条件\n- **作动器模型**：合成射流作动器(SJA)，具有时变周期性壁面法向速度边界条件。\n- **狭缝面积**：$A_{j}$。\n- **速度剖面**：在狭缝上空间均匀。\n- **驱动速度**：$v_{j}(t) = V_{a}\\sin(\\omega t)$。\n- **峰值速度**：$V_{a}$。\n- **角频率**：$\\omega$。\n- **平均质量通量**：在一个驱动周期内为零。\n- **动量输入条件**：仅在吹气半周期内（$v_{j}(t) > 0$）产生向外的动量。吸气半周期不注入动量。\n- **自由流速度**：$U_{\\infty}$。\n- **自由流密度**：$\\rho_{\\infty}$。\n- **射流流体密度**：$\\rho_{j}$。\n- **空气动力学参考面积**：$S$。\n- **任务**：\n    1. 推导在一个驱动周期 $T$ 内的时间平均向外动量输入。\n    2. 将无量纲动量系数 $C_{\\mu}$ 定义为时间平均向外动量输入与自由流动压标量乘以 $S$ 的比值。\n    3. 获得 $C_{\\mu}$ 的封闭形式表达式。\n    4. 根据给定数据计算 $C_{\\mu}$ 的数值。\n- **数值数据**：\n    - $\\rho_{\\infty} = \\rho_{j} = 1.2$ kg/m$^{3}$。\n    - $U_{\\infty} = 30$ m/s。\n    - $A_{j} = 5.0 \\times 10^{-5}$ m$^{2}$。\n    - $V_{a} = 100$ m/s。\n    - $S = 0.10$ m$^{2}$。\n- **取整要求**：最终数值答案必须四舍五入至四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，采用了流体动力学的标准原理，如雷诺输运定理、动量通量和无量纲分析（动量系数 $C_{\\mu}$）。将合成射流作动器建模为正弦速度边界条件是计算流体动力学(CFD)中一种常见且有效的简化方法。该问题是良态的，提供了所有必要的定义、变量和数值，以得出一个唯一的解。语言客观且精确。SJA的零净质量通量特性与仅基于吹气冲程定义 $C_{\\mu}$ 之间的区别，是航空航天领域用于表征作动器向外部流场赋予动量能力的一种标准约定。所有数值对于典型的低速空气动力学应用都是物理上合理的。该问题不违反任何无效性标准。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解答推导\n第一步是推导输入到流场中的时间平均向外动量。瞬时动量通量是质量流率与射流速度的乘积。狭缝的质量流率 $\\dot{m}(t)$ 由 $\\dot{m}(t) = \\rho_{j} A_{j} v_{j}(t)$ 给出，其中速度剖面在狭缝面积 $A_{j}$上被假设为均匀的。瞬时动量输入率（动量通量）$\\dot{M}(t)$ 则为：\n$$\n\\dot{M}(t) = \\dot{m}(t) v_{j}(t) = \\left(\\rho_{j} A_{j} v_{j}(t)\\right) v_{j}(t) = \\rho_{j} A_{j} \\left[v_{j}(t)\\right]^{2}\n$$\n代入给定的正弦速度函数 $v_{j}(t) = V_{a}\\sin(\\omega t)$：\n$$\n\\dot{M}(t) = \\rho_{j} A_{j} \\left(V_{a}\\sin(\\omega t)\\right)^{2} = \\rho_{j} A_{j} V_{a}^{2} \\sin^{2}(\\omega t)\n$$\n问题指明，仅在吹气半周期内，即当 $v_{j}(t) > 0$ 时，才有动量输入到外部流场。对于函数 $\\sin(\\omega t)$，这对应于时间区间 $t \\in [0, T/2]$，其中 $T = 2\\pi/\\omega$ 是驱动周期。在吸气半周期 $t \\in (T/2, T]$ 内，动量输入被认为是零。\n\n时间平均向外动量输入（我们记为 $\\bar{M}$）是在一个完整周期 $T$ 内的总动量输入除以周期本身。\n$$\n\\bar{M} = \\frac{1}{T} \\int_{0}^{T} \\dot{M}_{\\text{outward}}(t) \\, dt\n$$\n根据问题陈述，这变为：\n$$\n\\bar{M} = \\frac{1}{T} \\left[ \\int_{0}^{T/2} \\rho_{j} A_{j} V_{a}^{2} \\sin^{2}(\\omega t) \\, dt + \\int_{T/2}^{T} 0 \\, dt \\right] = \\frac{\\rho_{j} A_{j} V_{a}^{2}}{T} \\int_{0}^{T/2} \\sin^{2}(\\omega t) \\, dt\n$$\n为计算该积分，我们使用三角恒等式 $\\sin^{2}(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$：\n$$\n\\int_{0}^{T/2} \\sin^{2}(\\omega t) \\, dt = \\int_{0}^{T/2} \\frac{1 - \\cos(2\\omega t)}{2} \\, dt = \\frac{1}{2} \\left[ t - \\frac{\\sin(2\\omega t)}{2\\omega} \\right]_{0}^{T/2}\n$$\n代入积分上下限：\n$$\n\\frac{1}{2} \\left[ \\left(\\frac{T}{2} - \\frac{\\sin(2\\omega(T/2))}{2\\omega}\\right) - \\left(0 - \\frac{\\sin(0)}{2\\omega}\\right) \\right]\n$$\n由于 $T=2\\pi/\\omega$，正弦函数的参数变为 $2\\omega(T/2) = \\omega T = 2\\pi$。因为 $\\sin(2\\pi)=0$ 且 $\\sin(0)=0$，该积分简化为：\n$$\n\\frac{1}{2} \\left[ \\frac{T}{2} - 0 \\right] = \\frac{T}{4}\n$$\n将此结果代回 $\\bar{M}$ 的表达式中：\n$$\n\\bar{M} = \\frac{\\rho_{j} A_{j} V_{a}^{2}}{T} \\left( \\frac{T}{4} \\right) = \\frac{1}{4} \\rho_{j} A_{j} V_{a}^{2}\n$$\n这就是时间平均向外动量输入。\n\n接下来，我们定义无量纲动量系数 $C_{\\mu}$。问题将其定义为时间平均向外动量输入与自由流动压标量（即自由流动压 $q_{\\infty} = \\frac{1}{2}\\rho_{\\infty}U_{\\infty}^{2}$ 与参考面积 $S$ 的乘积）之比。\n$$\nC_{\\mu} = \\frac{\\bar{M}}{q_{\\infty} S} = \\frac{\\bar{M}}{\\frac{1}{2} \\rho_{\\infty} U_{\\infty}^{2} S}\n$$\n代入我们推导出的 $\\bar{M}$ 表达式：\n$$\nC_{\\mu} = \\frac{\\frac{1}{4} \\rho_{j} A_{j} V_{a}^{2}}{\\frac{1}{2} \\rho_{\\infty} U_{\\infty}^{2} S} = \\frac{1}{2} \\frac{\\rho_{j} A_{j} V_{a}^{2}}{\\rho_{\\infty} S U_{\\infty}^{2}}\n$$\n这就是 $C_{\\mu}$ 的封闭形式表达式。\n\n最后，我们使用所提供的数据计算 $C_{\\mu}$ 的数值：\n$\\rho_{j} = 1.2$ kg/m$^{3}$\n$\\rho_{\\infty} = 1.2$ kg/m$^{3}$\n$A_{j} = 5.0 \\times 10^{-5}$ m$^{2}$\n$V_{a} = 100$ m/s\n$U_{\\infty} = 30$ m/s\n$S = 0.10$ m$^{2}$\n\n将这些值代入 $C_{\\mu}$ 的表达式中：\n$$\nC_{\\mu} = \\frac{1}{2} \\frac{(1.2) \\cdot (5.0 \\times 10^{-5}) \\cdot (100)^{2}}{(1.2) \\cdot (0.10) \\cdot (30)^{2}}\n$$\n由于 $\\rho_{j} = \\rho_{\\infty}$，密度项相互抵消。\n$$\nC_{\\mu} = \\frac{1}{2} \\frac{(5.0 \\times 10^{-5}) \\cdot (10000)}{(0.10) \\cdot (900)}\n$$\n$$\nC_{\\mu} = \\frac{1}{2} \\frac{5.0 \\times 10^{-1}}{90} = \\frac{0.5}{180} = \\frac{1}{360}\n$$\n将此分数转换为小数：\n$$\nC_{\\mu} = 0.002777...\n$$\n问题要求答案四舍五入至四位有效数字。\n$$\nC_{\\mu} \\approx 0.002778\n$$\n这也可以用科学记数法表示为 $2.778 \\times 10^{-3}$。",
            "answer": "$$\n\\boxed{2.778 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "对于控制设计和优化而言，全尺寸的CFD仿真通常计算成本过高。本练习介绍“本征正交分解”（Proper Orthogonal Decomposition, POD），这是一种从仿真数据中提取能量占主导地位的流动结构并构建低维“降阶模型”（Reduced-Order Model, ROM）的强大技术。通过这个实践，你将完整地走过从生成数据到构建和评估ROM的全过程。",
            "id": "3941255",
            "problem": "给定一个受控的、线性化的不可压缩流模型，用于表示通道中基流的一维流向扰动。扰动场 $q(x,t)$ 的控制动力学由带有局部体力控制输入的线性平流-扩散方程以连续形式建模\n$$\n\\frac{\\partial q}{\\partial t} = \\nu \\frac{\\partial^2 q}{\\partial x^2} - U \\frac{\\partial q}{\\partial x} + b(x) \\, u(t),\n$$\n其中 $x \\in [0,L_x]$ 且具有周期性边界条件，$U$ 是均匀基流速度，$\\nu$ 是运动粘度，$b(x)$ 是空间控制输入分布，$u(t)$ 是标量控制信号。空间域被均匀离散为 $N$ 个点，间距为 $\\Delta x = L_x/N$，从而得到半离散线性系统\n$$\n\\frac{d \\mathbf{q}}{d t} = \\mathbf{L} \\mathbf{q} + \\mathbf{B} \\, u(t),\n$$\n其中 $\\mathbf{q}(t) \\in \\mathbb{R}^N$，$\\mathbf{L} \\in \\mathbb{R}^{N \\times N}$ 是离散的平流-扩散算子，使用二阶中心差分构建扩散项，使用中心差分和周期性环绕构建平流项，$\\mathbf{B} \\in \\mathbb{R}^N$ 是与 $b(x)$ 对应的离散化控制输入分布。通过在规定的控制信号 $u(t)$ 下对全阶模型进行数值积分，将一组 $K$ 个时间索引的快照组合成矩阵 $\\mathbf{Q} \\in \\mathbb{R}^{N \\times K}$ 的列。\n\n为了构建能量最优的低维子空间，通过对角权重矩阵 $\\mathbf{W} \\in \\mathbb{R}^{N \\times N}$（其对角项为正，例如，近似域上的求积权重）定义加权内积，以及相应的范数 $\\|\\mathbf{v}\\|_{\\mathbf{W}}^2 = \\mathbf{v}^\\top \\mathbf{W} \\mathbf{v}$。本征正交分解（POD）寻求一个由 $\\boldsymbol{\\Phi} \\in \\mathbb{R}^{N \\times r}$ 的列张成的 $r$ 维子空间，该子空间在 $\\mathbf{W}$-加权范数下最小化快照的均方重构误差，并满足 $\\mathbf{W}$-正交归一性约束，即 $\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\boldsymbol{\\Phi} = \\mathbf{I}_r$。降阶坐标通过状态在子空间上的投影来定义，即 $ \\mathbf{a}(t) = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{q}(t)$，其中 $\\mathbf{a}(t) \\in \\mathbb{R}^r$。降阶动力系统是全阶动力学在POD子空间上的伽辽金投影，从而得到一个带有控制输入 $u(t)$ 的低维系统。\n\n您的任务是：\n1. 从连续平流-扩散模型出发，使用二阶中心差分方案构建扩散项，使用中心差分方案和周期性边界条件构建平流项，从而构造离散算子 $\\mathbf{L}$。并将 $\\mathbf{B}$ 构造为一个以指定位置为中心、标准差以空间单位给出的局部高斯体力分布。\n2. 使用显式欧拉时间步进法模拟半离散系统，为指定的控制函数 $u(t)$ 生成 $K$ 个快照 $\\mathbf{Q} = [\\mathbf{q}(t_1), \\ldots, \\mathbf{q}(t_K)]$，初始条件为 $\\mathbf{q}(0) = \\mathbf{0}$。使用大小为 $\\Delta t$ 的均匀时间步。\n3. 从 $\\mathbf{Q}$ 计算秩为 $r$ 的 $\\mathbf{W}$-加权POD模态 $\\boldsymbol{\\Phi}$，并强制满足 $\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\boldsymbol{\\Phi} = \\mathbf{I}_r$。\n4. 定义降阶坐标 $\\mathbf{a}(t) = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{q}(t)$，并通过将全阶线性动力学投影到POD子空间上，推导形式为\n$$\n\\frac{d \\mathbf{a}}{dt} = \\mathbf{A}_r \\mathbf{a} + \\mathbf{B}_r \\, u(t),\n$$\n的降阶模型。提供 $\\mathbf{A}_r$ 和 $\\mathbf{B}_r$ 关于 $\\boldsymbol{\\Phi}$、$\\mathbf{W}$、$\\mathbf{L}$ 和 $\\mathbf{B}$ 的显式构造。\n5. 量化两个指标：秩为 $r$ 的POD近似所保留的能量分数，定义为前 $r$ 个快照奇异值平方和与所有快照奇异值平方总和的比率（这是一个无量纲小数）；以及投影闭合残差，定义为\n$$\n\\mathcal{R} = \\frac{\\|(\\mathbf{I} - \\mathbf{P}_{\\mathbf{W}})\\mathbf{L}\\boldsymbol{\\Phi}\\|_F}{\\|\\mathbf{L}\\boldsymbol{\\Phi}\\|_F},\n\\quad \\text{其中} \\quad \\mathbf{P}_{\\mathbf{W}} = \\boldsymbol{\\Phi} \\boldsymbol{\\Phi}^\\top \\mathbf{W},\n$$\n其中 $\\|\\cdot\\|_F$ 表示弗罗贝尼乌斯范数。此残差是一个无量纲小数。\n\n在所有模拟中使用以下固定的物理和数值参数：\n- 域名长度 $L_x = 1$ 米，网格点数 $N = 64$，粘度 $\\nu = 0.01$ 米$^2$/秒，基流 $U = 1$ 米/秒，高斯控制中心 $x_c = 0.25$ 米，高斯标准差 $\\sigma = 0.05$ 米，时间步长 $\\Delta t = 0.002$ 秒，最终时间 $T = 0.5$ 秒，以及初始条件 $\\mathbf{q}(0) = \\mathbf{0}$。\n- 控制信号 $u(t)$ 是分段常数：当 $0 \\le t < 0.25$ 秒时，$u(t) = 1$；当 $0.25 \\le t \\le 0.5$ 秒时，$u(t) = -1$。\n- 在每个时间步都使用快照，因此 $K = T/\\Delta t$。\n\n权重矩阵 $\\mathbf{W}$ 和秩 $r$ 根据以下测试套件变化：\n- 测试用例 1 (顺利路径，低秩): $\\mathbf{W}$ 是均匀求积权重 $\\mathbf{W} = \\Delta x \\, \\mathbf{I}_N$，秩 $r = 1$。\n- 测试用例 2 (增加秩): $\\mathbf{W}$ 是均匀求积权重 $\\mathbf{W} = \\Delta x \\, \\mathbf{I}_N$，秩 $r = 5$。\n- 测试用例 3 (非均匀权重边缘情况): $\\mathbf{W}$ 的对角项为 $W_{ii} = \\Delta x \\left(1 + 0.3 \\cos(2\\pi x_i/L_x)\\right)$，秩 $r = 15$，其中 $x_i$ 是网格点坐标。\n\n您的程序必须为每个测试用例计算保留的能量分数（无量纲小数）和投影闭合残差（无量纲小数）。最终输出必须是单行，包含一个用方括号括起来的逗号分隔列表，顺序如下\n$$\n[\\text{energy}_1,\\text{residual}_1,\\text{energy}_2,\\text{residual}_2,\\text{energy}_3,\\text{residual}_3],\n$$\n其中每个条目都表示为小数值。输出中不需要单位，因为所有要求的指标都是无量纲的。",
            "solution": "用户提供的问题经过严格审查并确定为有效。它在流体动力学和线性系统理论的原理上具有科学依据，问题适定且目标明确，并提供了一套完整且一致的参数。该任务要求应用标准数值方法（有限差分、时间积分）和数据驱动的模型降阶技术（本征正交分解），这些都是计算科学与工程中的核心概念。\n\n解决方案是按照问题陈述中概述的五个任务构建的。\n\n### 步骤 1：控制方程的离散化\n\n给定的连续偏微分方程（PDE）是：\n$$\n\\frac{\\partial q}{\\partial t} = \\nu \\frac{\\partial^2 q}{\\partial x^2} - U \\frac{\\partial q}{\\partial x} + b(x) \\, u(t)\n$$\n空间域 $x \\in [0, L_x]$ 被离散为 $N$ 个均匀间隔的点 $x_i = i \\Delta x$（对于 $i = 0, 1, \\dots, N-1$），其中网格间距为 $\\Delta x = L_x / N$。扰动场 $q(x, t)$ 由一个向量 $\\mathbf{q}(t) \\in \\mathbb{R}^N$ 表示，其中 $(\\mathbf{q})_i = q(x_i, t)$。\n\n空间导数使用具有周期性边界条件的二阶有限差分格式进行近似。\n\n扩散项 $\\nu \\frac{\\partial^2 q}{\\partial x^2}$ 使用二阶中心差分格式进行离散化：\n$$\n\\nu \\frac{\\partial^2 q}{\\partial x^2}\\bigg|_{x_i} \\approx \\nu \\frac{q(x_{i+1}, t) - 2q(x_i, t) + q(x_{i-1}, t)}{(\\Delta x)^2}\n$$\n平流项 $-U \\frac{\\partial q}{\\partial x}$ 使用二阶中心差分格式进行离散化：\n$$\n-U \\frac{\\partial q}{\\partial x}\\bigg|_{x_i} \\approx -U \\frac{q(x_{i+1}, t) - q(x_{i-1}, t)}{2 \\Delta x}\n$$\n结合这些离散化方法，离散算子 $\\mathbf{L} \\mathbf{q}$ 的第 $i$ 个分量是：\n$$\n(\\mathbf{L} \\mathbf{q})_i = \\left(\\frac{\\nu}{(\\Delta x)^2} + \\frac{U}{2 \\Delta x}\\right) q_{i-1} - \\frac{2\\nu}{(\\Delta x)^2} q_i + \\left(\\frac{\\nu}{(\\Delta x)^2} - \\frac{U}{2 \\Delta x}\\right) q_{i+1}\n$$\n其中索引对 $N$ 取模以强制执行周期性。这定义了循环矩阵 $\\mathbf{L} \\in \\mathbb{R}^{N \\times N}$ 的元素。\n\n控制输入分布 $b(x)$ 是一个局部高斯函数。相应的离散向量 $\\mathbf{B} \\in \\mathbb{R}^N$ 的分量为：\n$$\nB_i = b(x_i) = \\exp\\left(-\\frac{(x_i - x_c)^2}{2\\sigma^2}\\right)\n$$\n这导致了半离散线性时不变系统：\n$$\n\\frac{d \\mathbf{q}}{dt} = \\mathbf{L} \\mathbf{q} + \\mathbf{B} u(t)\n$$\n\n### 步骤 2：通过时间积分生成快照\n\n半离散系统使用显式欧拉方法进行时间积分，从零初始条件 $\\mathbf{q}(0) = \\mathbf{0}$ 开始。在时间步 $k$ 处状态向量的更新规则是：\n$$\n\\mathbf{q}(t_{k+1}) = \\mathbf{q}(t_k) + \\Delta t \\left( \\mathbf{L} \\mathbf{q}(t_k) + \\mathbf{B} u(t_k) \\right)\n$$\n其中 $t_k = k \\Delta t$。控制信号 $u(t)$ 如指定为分段常数。我们通过存储从 $t_1 = \\Delta t$ 到 $t_K = T$ 的每个时间步的状态向量来生成 $K = T/\\Delta t$ 个快照。这些向量构成了快照矩阵 $\\mathbf{Q} = [\\mathbf{q}(t_1), \\mathbf{q}(t_2), \\dots, \\mathbf{q}(t_K)] \\in \\mathbb{R}^{N \\times K}$ 的列。\n\n### 步骤 3：加权本征正交分解 (POD)\n\nPOD的目标是找到一个 $r$ 维基 $\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_1, \\dots, \\boldsymbol{\\phi}_r] \\in \\mathbb{R}^{N \\times r}$，它关于 $\\mathbf{W}$-加权内积是正交归一的（$\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\boldsymbol{\\Phi} = \\mathbf{I}_r$），并且最小化快照的平均投影误差。\n\n这个优化问题通过对加权快照矩阵进行奇异值分解 (SVD) 来解决。设 $\\mathbf{W}^{1/2}$ 是一个对角矩阵，其元素是 $\\mathbf{W}$ 对角元素的平方根。我们构建加权快照矩阵 $\\tilde{\\mathbf{Q}} = \\mathbf{W}^{1/2} \\mathbf{Q}$ 并计算其 SVD：\n$$\n\\tilde{\\mathbf{Q}} = \\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^\\top\n$$\n其中 $\\mathbf{U} \\in \\mathbb{R}^{N \\times \\min(N,K)}$ 具有正交归一的列，$\\boldsymbol{\\Sigma} \\in \\mathbb{R}^{\\min(N,K) \\times \\min(N,K)}$ 是奇异值 $\\sigma_i \\geq 0$ 的对角矩阵，$\\mathbf{V} \\in \\mathbb{R}^{K \\times \\min(N,K)}$ 具有正交归一的列。\n\n最优基 $\\boldsymbol{\\Phi}$ 的列，也称为POD模态，是通过对前 $r$ 个左奇异向量（$\\mathbf{U}$ 的列）进行逆加权得到的：\n$$\n\\boldsymbol{\\Phi} = (\\mathbf{W}^{1/2})^{-1} \\mathbf{U}_r\n$$\n其中 $\\mathbf{U}_r$ 包含 $\\mathbf{U}$ 的前 $r$ 列。所得到的模态保证是 $\\mathbf{W}$-正交归一的。\n\n### 步骤 4：伽辽金投影和降阶模型 (ROM)\n\n降阶模型 (ROM) 是通过将全阶动力学投影到由POD模态张成的子空间上得到的。我们将状态近似为POD模态的线性组合：$\\mathbf{q}(t) \\approx \\boldsymbol{\\Phi} \\mathbf{a}(t)$，其中 $\\mathbf{a}(t) \\in \\mathbb{R}^r$ 是降阶坐标的向量。\n\n将此拟设代入半离散系统会产生一个残差：\n$$\n\\mathbf{R}(t) = \\boldsymbol{\\Phi} \\frac{d\\mathbf{a}}{dt} - (\\mathbf{L} \\boldsymbol{\\Phi} \\mathbf{a} + \\mathbf{B} u(t))\n$$\n伽辽金投影要求此残差在 $\\mathbf{W}$-加权内积下与基函数正交，即 $\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{R}(t) = \\mathbf{0}$。\n$$\n\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\left( \\boldsymbol{\\Phi} \\frac{d\\mathbf{a}}{dt} \\right) = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\left( \\mathbf{L} \\boldsymbol{\\Phi} \\mathbf{a} + \\mathbf{B} u(t) \\right)\n$$\n利用 $\\mathbf{W}$-正交归一性 $\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\boldsymbol{\\Phi} = \\mathbf{I}_r$，我们得到ROM：\n$$\n\\frac{d\\mathbf{a}}{dt} = \\left(\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{L} \\boldsymbol{\\Phi}\\right) \\mathbf{a}(t) + \\left(\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{B}\\right) u(t)\n$$\n这具有 $\\frac{d \\mathbf{a}}{dt} = \\mathbf{A}_r \\mathbf{a} + \\mathbf{B}_r u(t)$ 的形式，降阶系统矩阵定义为：\n$$\n\\mathbf{A}_r = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{L} \\boldsymbol{\\Phi} \\in \\mathbb{R}^{r \\times r}\n$$\n$$\n\\mathbf{B}_r = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{B} \\in \\mathbb{R}^{r}\n$$\n\n### 步骤 5：性能指标的计算\n\n计算两个指标来评估降阶基的质量。\n\n**保留能量分数**：加权快照矩阵 $\\tilde{\\mathbf{Q}}$ 的奇异值平方 $\\sigma_i^2$ 对应于每个模态捕获的“能量”（方差）。秩为 $r$ 的近似保留的总能量分数为：\n$$\nE_r = \\frac{\\sum_{i=1}^r \\sigma_i^2}{\\sum_{j=1}^{\\min(N,K)} \\sigma_j^2}\n$$\n\n**投影闭合残差**：该指标量化了POD子空间在动力学算子 $\\mathbf{L}$ 作用下的闭合程度。在 $\\mathbf{W}$-范数下，到POD子空间上的投影算子是 $\\mathbf{P}_{\\mathbf{W}} = \\boldsymbol{\\Phi} \\boldsymbol{\\Phi}^\\top \\mathbf{W}$。残差定义为 $\\mathbf{L}\\boldsymbol{\\Phi}$ 中位于POD子空间之外的分量的弗罗贝尼乌斯范数，并由 $\\mathbf{L}\\boldsymbol{\\Phi}$ 的范数进行归一化：\n$$\n\\mathcal{R} = \\frac{\\|(\\mathbf{I} - \\mathbf{P}_{\\mathbf{W}})\\mathbf{L}\\boldsymbol{\\Phi}\\|_F}{\\|\\mathbf{L}\\boldsymbol{\\Phi}\\|_F}\n$$\n一个小的残差表明模态的动力学很好地包含在它们所张成的子空间内，这意味着伽辽金投影将是准确的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of building and evaluating a reduced-order model for a\n    linearized 1D advection-diffusion equation.\n    \"\"\"\n    # Fixed physical and numerical parameters\n    Lx = 1.0  # Domain length\n    N = 64  # Number of grid points\n    nu = 0.01  # Kinematic viscosity\n    U = 1.0  # Base flow speed\n    xc = 0.25  # Gaussian control center\n    sigma = 0.05  # Gaussian standard deviation\n    dt = 0.002  # Time step\n    T = 0.5  # Final time\n\n    # Derived parameters\n    dx = Lx / N\n    x = np.linspace(0, Lx, N, endpoint=False)\n    num_steps = int(T / dt)\n    K = num_steps\n\n    # --- Step 1: Construct discrete operators L and B ---\n    L = np.zeros((N, N))\n    # Coefficients based on central difference schemes\n    c_diff = nu / dx**2\n    c_adv = U / (2 * dx)\n    for i in range(N):\n        L[i, i] = -2.0 * c_diff\n        L[i, (i + 1) % N] = c_diff - c_adv\n        L[i, (i - 1 + N) % N] = c_diff + c_adv\n    \n    B = np.exp(-((x - xc)**2) / (2 * sigma**2))\n\n    # --- Step 2: Generate snapshots Q ---\n    q = np.zeros(N)\n    Q = np.zeros((N, K))\n    for k in range(num_steps):\n        time = k * dt\n        u_val = 1.0 if time  0.25 else -1.0\n        \n        # Explicit Euler step\n        q = q + dt * (L @ q + B * u_val)\n        Q[:, k] = q\n\n    # Define test cases\n    test_cases = [\n        {'type': 'uniform', 'r': 1},\n        {'type': 'uniform', 'r': 5},\n        {'type': 'cosine', 'r': 15}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        r = case['r']\n\n        # --- Construct weight matrix W for the current test case ---\n        if case['type'] == 'uniform':\n            W_diag = np.full(N, dx)\n        elif case['type'] == 'cosine':\n            W_diag = dx * (1.0 + 0.3 * np.cos(2 * np.pi * x / Lx))\n        \n        W = np.diag(W_diag)\n        W_sqrt_diag = np.sqrt(W_diag)\n        W_inv_sqrt_diag = 1.0 / W_sqrt_diag\n        W_sqrt = np.diag(W_sqrt_diag)\n        W_inv_sqrt = np.diag(W_inv_sqrt_diag)\n\n        # --- Step 3: Compute weighted POD modes Phi ---\n        Q_tilde = W_sqrt @ Q\n        # Use full_matrices=False for efficiency\n        U_svd, s, _ = np.linalg.svd(Q_tilde, full_matrices=False)\n        \n        # Truncate to rank r\n        Ur = U_svd[:, :r]\n        Phi = W_inv_sqrt @ Ur\n\n        # --- Step 5: Compute metrics ---\n        # Retained Energy Fraction\n        energy_fraction = np.sum(s[:r]**2) / np.sum(s**2)\n\n        # Projection Closure Residual\n        LPhi = L @ Phi\n        P_W = Phi @ Phi.T @ W\n        I = np.identity(N)\n        \n        residual_matrix = (I - P_W) @ LPhi\n        \n        norm_numerator = np.linalg.norm(residual_matrix, 'fro')\n        norm_denominator = np.linalg.norm(LPhi, 'fro')\n        \n        closure_residual = norm_numerator / norm_denominator\n\n        results.extend([energy_fraction, closure_residual])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{val:.10f}' for val in results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "拥有了能够预测流动响应的模型后，我们便可以设计高效的控制策略。本练习利用预解算子（resolvent operator）的概念来分析系统的频率响应，从而识别出流动对控制输入最为敏感的频率。通过最大化这个预解算子增益，你将确定最优的周期性激励频率，以最小的作动代价实现最大的控制效果。",
            "id": "3941258",
            "problem": "一个中等雷诺数的二维不可压缩翼型流通过周期性的法向壁面驱动进行控制。该流动由一个线性时不变降阶系统建模，该系统通过对平均流周围的线性化Navier–Stokes方程进行求解，并投影到主导的振荡剪切层模态上得到。该降阶模型捕捉了与主动流动控制相关的主导放大机制，其状态空间形式由下式给出\n$$\n\\frac{d}{dt}\\mathbf{q}(t) = \\mathbf{A}\\,\\mathbf{q}(t) + \\mathbf{B}\\,f(t), \\qquad y(t) = \\mathbf{C}\\,\\mathbf{q}(t),\n$$\n其中 $\\mathbf{q}(t) \\in \\mathbb{R}^{2}$ 是状态， $f(t) \\in \\mathbb{R}$ 是驱动输入， $y(t) \\in \\mathbb{R}$ 是一个标量输出，用于衡量剪切层动能的一个代理量。矩阵为\n$$\n\\mathbf{A} = \\begin{pmatrix}\n0  1 \\\\\n- \\omega_{n}^{2}  -2\\zeta\\,\\omega_{n}\n\\end{pmatrix}, \\quad\n\\mathbf{B} = \\begin{pmatrix}\n0 \\\\\nb\n\\end{pmatrix}, \\quad\n\\mathbf{C} = \\begin{pmatrix}\n1  0\n\\end{pmatrix},\n$$\n其中自然频率 $\\omega_{n} = 1.50$ (弧度/对流时间单位)，阻尼比 $\\zeta = 0.25$。驱动增益为 $b = 1$。驱动是周期性的，$f(t) = \\Re\\{\\hat{f}\\,\\exp(i\\omega t)\\}$，并受到均方根幅值约束 $|\\hat{f}| \\le f_{0}$，其中 $f_{0} = 0.05$ (已通过自由流速度和特征长度进行无量纲化)。\n\n从线性化模型和预解算子的定义出发，推导输入-输出预解映射，并将预解增益表示为频率响应的最大奇异值。然后，设计驱动以在驱动幅值约束下最大化预解增益，并确定最优驱动频率。使用对流时间尺度 $T_{c} = L/U_{\\infty}$，以使频率以弧度/对流时间单位表示。将最终数值答案四舍五入至四位有效数字。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n**步骤1：提取已知条件**\n问题提供了一个用于翼型流动的线性时不变(LTI)降阶模型：\n状态空间方程：\n$$ \\frac{d}{dt}\\mathbf{q}(t) = \\mathbf{A}\\,\\mathbf{q}(t) + \\mathbf{B}\\,f(t) $$\n$$ y(t) = \\mathbf{C}\\,\\mathbf{q}(t) $$\n状态向量：$\\mathbf{q}(t) \\in \\mathbb{R}^{2}$\n输入：$f(t) \\in \\mathbb{R}$\n输出：$y(t) \\in \\mathbb{R}$\n状态矩阵：\n$$ \\mathbf{A} = \\begin{pmatrix} 0  1 \\\\ - \\omega_{n}^{2}  -2\\zeta\\,\\omega_{n} \\end{pmatrix} $$\n输入矩阵：\n$$ \\mathbf{B} = \\begin{pmatrix} 0 \\\\ b \\end{pmatrix} $$\n输出矩阵：\n$$ \\mathbf{C} = \\begin{pmatrix} 1  0 \\end{pmatrix} $$\n模型参数：\n自然频率：$\\omega_{n} = 1.50$ 弧度/对流时间单位。\n阻尼比：$\\zeta = 0.25$。\n驱动增益：$b = 1$。\n驱动形式：$f(t) = \\Re\\{\\hat{f}\\,\\exp(i\\omega t)\\}$。\n驱动约束：$|\\hat{f}| \\le f_{0}$，其中 $f_{0} = 0.05$。\n\n**步骤2：使用提取的已知条件进行验证**\n根据预定义标准对问题进行评估：\n- **科学依据**：所提供的模型是一个标准的二阶线性微分方程，代表一个阻尼谐振子。这是一个用于描述许多物理系统线性响应的典范模型，包括流体动力学中的剪切层不稳定性，而这通常是主动流动控制策略的目标。使用预解分析来研究线性化Navier-Stokes方程的输入-输出频率响应是现代流体力学中一种成熟且强大的技术。在此背景下，所有参数都具有明确的物理释义。该问题是科学合理的。\n- **适定性**：问题要求推导一个特定量（预解增益），然后在给定约束下针对一个参数（驱动频率）对其进行优化。数学结构清晰，目标明确。预期会有一个唯一解。该问题是适定的。\n- **客观性**：问题使用精确的数学和工程术语陈述。没有主观、模糊或基于观点的陈述。\n\n**步骤3：结论与行动**\n该问题被认为是**有效的**，因为它是科学合理的、适定的、客观的且自洽的。可以继续求解过程。\n\n**求解推导**\n\n主要目标是找到最优驱动频率 $\\omega$，以最大化由预解增益量化的系统响应。\n\n**1. 输入-输出预解映射（频率响应）的推导**\n我们从LTI状态空间模型开始：\n$$ \\frac{d}{dt}\\mathbf{q}(t) = \\mathbf{A}\\,\\mathbf{q}(t) + \\mathbf{B}\\,f(t) $$\n$$ y(t) = \\mathbf{C}\\,\\mathbf{q}(t) $$\n对于周期性驱动 $f(t) = \\Re\\{\\hat{f}\\,\\exp(i\\omega t)\\}$，线性系统的稳态响应也是具有相同频率的周期性响应。因此，我们可以将状态和输出向量用它们的复振幅（相量）表示为 $\\mathbf{q}(t) = \\Re\\{\\hat{\\mathbf{q}}\\,\\exp(i\\omega t)\\}$ 和 $y(t) = \\Re\\{\\hat{y}\\,\\exp(i\\omega t)\\}$。将这些代入状态方程可得：\n$$ \\frac{d}{dt} \\Re\\{\\hat{\\mathbf{q}}\\,\\exp(i\\omega t)\\} = \\mathbf{A}\\,\\Re\\{\\hat{\\mathbf{q}}\\,\\exp(i\\omega t)\\} + \\mathbf{B}\\,\\Re\\{\\hat{f}\\,\\exp(i\\omega t)\\} $$\n利用微分和矩阵乘法是线性算子的性质，我们可以将实部算子移到外面，并处理复数量：\n$$ \\Re\\{i\\omega\\,\\hat{\\mathbf{q}}\\,\\exp(i\\omega t)\\} = \\Re\\{(\\mathbf{A}\\,\\hat{\\mathbf{q}} + \\mathbf{B}\\,\\hat{f})\\,\\exp(i\\omega t)\\} $$\n该等式必须对所有时间 $t$ 成立，这意味着复振幅相等：\n$$ i\\omega\\,\\hat{\\mathbf{q}} = \\mathbf{A}\\,\\hat{\\mathbf{q}} + \\mathbf{B}\\,\\hat{f} $$\n重新整理以求解状态响应幅值 $\\hat{\\mathbf{q}}$ 可得：\n$$ (i\\omega\\,\\mathbf{I} - \\mathbf{A})\\,\\hat{\\mathbf{q}} = \\mathbf{B}\\,\\hat{f} $$\n$$ \\hat{\\mathbf{q}} = (i\\omega\\,\\mathbf{I} - \\mathbf{A})^{-1}\\,\\mathbf{B}\\,\\hat{f} $$\n算子 $(i\\omega\\,\\mathbf{I} - \\mathbf{A})^{-1}$ 是矩阵 $\\mathbf{A}$ 在虚轴上求值的预解式。输出幅值 $\\hat{y}$ 则由下式给出：\n$$ \\hat{y} = \\mathbf{C}\\,\\hat{\\mathbf{q}} = \\mathbf{C}\\,(i\\omega\\,\\mathbf{I} - \\mathbf{A})^{-1}\\,\\mathbf{B}\\,\\hat{f} $$\n标量复函数 $H(i\\omega) = \\mathbf{C}\\,(i\\omega\\,\\mathbf{I} - \\mathbf{A})^{-1}\\,\\mathbf{B}$ 是系统的传递函数或频率响应。它表示驱动幅值 $\\hat{f}$ 和输出幅值 $\\hat{y}$ 之间的输入-输出预解映射。\n\n**2. 预解增益的公式**\n预解增益 $\\sigma(\\omega)$ 定义为频率响应算子 $H(i\\omega)$ 的最大奇异值。对于像本题这样的单输入单输出 (SISO) 系统，$H(i\\omega)$ 是一个标量（对于每个 $\\omega$ 都是一个复数）。标量的奇异值就是其模。因此，预解增益为：\n$$ \\sigma(\\omega) = |H(i\\omega)| $$\n我们现在显式计算 $H(i\\omega)$。首先，我们构建矩阵 $(i\\omega\\,\\mathbf{I} - \\mathbf{A})$：\n$$ i\\omega\\,\\mathbf{I} - \\mathbf{A} = \\begin{pmatrix} i\\omega  0 \\\\ 0  i\\omega \\end{pmatrix} - \\begin{pmatrix} 0  1 \\\\ -\\omega_{n}^{2}  -2\\zeta\\omega_{n} \\end{pmatrix} = \\begin{pmatrix} i\\omega  -1 \\\\ \\omega_{n}^{2}  i\\omega + 2\\zeta\\omega_{n} \\end{pmatrix} $$\n该矩阵的行列式是：\n$$ \\det(i\\omega\\,\\mathbf{I} - \\mathbf{A}) = (i\\omega)(i\\omega + 2\\zeta\\omega_{n}) - (-1)(\\omega_{n}^{2}) = -\\omega^{2} + i(2\\zeta\\omega_{n}\\omega) + \\omega_{n}^{2} $$\n其逆矩阵为：\n$$ (i\\omega\\,\\mathbf{I} - \\mathbf{A})^{-1} = \\frac{1}{(\\omega_{n}^{2} - \\omega^{2}) + i(2\\zeta\\omega_{n}\\omega)} \\begin{pmatrix} i\\omega + 2\\zeta\\omega_{n}  1 \\\\ -\\omega_{n}^{2}  i\\omega \\end{pmatrix} $$\n现在，我们可以计算 $H(i\\omega)$：\n$$ H(i\\omega) = \\mathbf{C}\\,(i\\omega\\,\\mathbf{I} - \\mathbf{A})^{-1}\\,\\mathbf{B} = \\frac{1}{(\\omega_{n}^{2} - \\omega^{2}) + i(2\\zeta\\omega_{n}\\omega)} \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} i\\omega + 2\\zeta\\omega_{n}  1 \\\\ -\\omega_{n}^{2}  i\\omega \\end{pmatrix} \\begin{pmatrix} 0 \\\\ b \\end{pmatrix} $$\n$$ H(i\\omega) = \\frac{1}{(\\omega_{n}^{2} - \\omega^{2}) + i(2\\zeta\\omega_{n}\\omega)} \\begin{pmatrix} i\\omega + 2\\zeta\\omega_{n}  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ b \\end{pmatrix} $$\n$$ H(i\\omega) = \\frac{b}{(\\omega_{n}^{2} - \\omega^{2}) + i(2\\zeta\\omega_{n}\\omega)} $$\n预解增益是此表达式的模：\n$$ \\sigma(\\omega) = |H(i\\omega)| = \\frac{|b|}{\\sqrt{(\\omega_{n}^{2} - \\omega^{2})^{2} + (2\\zeta\\omega_{n}\\omega)^{2}}} $$\n\n**3. 最优驱动的设计**\n问题要求设计驱动以最大化预解增益。驱动设计包括选择其幅值 $\\hat{f}$ 和频率 $\\omega$。输出幅值为 $|\\hat{y}| = \\sigma(\\omega)|\\hat{f}|$。在约束 $|\\hat{f}| \\le f_0$ 下，通过选择可能的最大输入幅值 $|\\hat{f}| = f_0$ 来最大化输出幅值。\n主要任务是找到使 $\\sigma(\\omega)$ 最大化的频率 $\\omega_{opt}$。最大化 $\\sigma(\\omega)$ 等同于最小化分母的平方，我们将其表示为 $D(\\omega)$：\n$$ D(\\omega) = (\\omega_{n}^{2} - \\omega^{2})^{2} + (2\\zeta\\omega_{n}\\omega)^{2} $$\n为了找到最小值，我们计算 $D(\\omega)$ 关于 $\\omega$ 的导数并将其设为零。\n$$ \\frac{dD}{d\\omega} = 2(\\omega_{n}^{2} - \\omega^{2})(-2\\omega) + 2(2\\zeta\\omega_{n}\\omega)(2\\zeta\\omega_{n}) = 0 $$\n$$ -4\\omega(\\omega_{n}^{2} - \\omega^{2}) + 8\\zeta^{2}\\omega_{n}^{2}\\omega = 0 $$\n对于 $\\omega \\neq 0$ 的非平凡解，我们可以除以 $4\\omega$：\n$$ -(\\omega_{n}^{2} - \\omega^{2}) + 2\\zeta^{2}\\omega_{n}^{2} = 0 $$\n$$ \\omega^{2} - \\omega_{n}^{2} + 2\\zeta^{2}\\omega_{n}^{2} = 0 $$\n$$ \\omega^{2} = \\omega_{n}^{2} - 2\\zeta^{2}\\omega_{n}^{2} = \\omega_{n}^{2}(1 - 2\\zeta^{2}) $$\n因此，最优频率，即共振频率 $\\omega_r$，为：\n$$ \\omega_{opt} = \\omega_{n}\\sqrt{1 - 2\\zeta^{2}} $$\n这个实值最优频率仅在 $1 - 2\\zeta^{2} \\ge 0$ 时存在，即 $\\zeta \\le \\frac{1}{\\sqrt{2}}$。\n\n**4. 数值计算**\n我们将给定值 $\\omega_{n} = 1.50$ 和 $\\zeta = 0.25$ 代入 $\\omega_{opt}$ 的表达式。\n首先，我们检查共振条件：\n$$ \\zeta = 0.25  \\frac{1}{\\sqrt{2}} \\approx 0.7071 $$\n条件得到满足，因此存在一个明显的共振峰。\n现在我们计算最优频率的值：\n$$ \\omega_{opt} = 1.50 \\times \\sqrt{1 - 2(0.25)^{2}} $$\n$$ \\omega_{opt} = 1.50 \\times \\sqrt{1 - 2(0.0625)} $$\n$$ \\omega_{opt} = 1.50 \\times \\sqrt{1 - 0.125} $$\n$$ \\omega_{opt} = 1.50 \\times \\sqrt{0.875} $$\n$$ \\omega_{opt} \\approx 1.50 \\times 0.93541434669 $$\n$$ \\omega_{opt} \\approx 1.4031215200 $$\n将结果四舍五入到四位有效数字，我们得到：\n$$ \\omega_{opt} \\approx 1.403 $$\n最优驱动频率是 $1.403$ 弧度/对流时间单位。",
            "answer": "$$\\boxed{1.403}$$"
        }
    ]
}