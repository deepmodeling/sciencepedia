{
    "hands_on_practices": [
        {
            "introduction": "A critical first step in any active flow control simulation is to precisely define and quantify the actuator's input to the flow. The dimensionless momentum coefficient, $C_\\mu$, serves as the standard metric for characterizing the strength of momentum-based actuators like synthetic jets. This exercise provides hands-on practice in deriving $C_\\mu$ from first principles, starting with the instantaneous momentum flux and time-averaging it over an actuation cycle, a fundamental skill for setting up and interpreting AFC simulations .",
            "id": "3941259",
            "problem": "Consider a Synthetic Jet Actuator (SJA) embedded flush on the surface of a high-lift airfoil section in a Computational Fluid Dynamics (CFD) simulation. The actuator is modeled as a time-periodic wall-normal velocity boundary condition applied over a slot of area $A_{j}$, with a spatially uniform profile across the slot and zero mean mass flux over one actuation period. Specifically, the wall-normal velocity at the slot is prescribed as $v_{j}(t) = V_{a}\\sin(\\omega t)$, where $V_{a}$ is the peak amplitude and $\\omega$ is the angular frequency. The external freestream is uniform with speed $U_{\\infty}$, density $\\rho_{\\infty}$, and a chosen aerodynamic reference area $S$ associated with the controlled surface patch. The jet fluid density is $\\rho_{j}$. Assume the actuator produces an outward jet only during the blowing half-cycle (i.e., when $v_{j}(t) > 0$), and that suction during the other half-cycle does not inject momentum into the external flow.\n\nStarting from the Reynolds Transport Theorem (RTT) for linear momentum applied to a pillbox control volume that straddles the slot and using first-principles definitions of fluxes, derive the time-averaged outward momentum input to the external flow over one actuation period in terms of $\\rho_{j}$, $A_{j}$, and $v_{j}(t)$. Using this result, define the dimensionless momentum coefficient $C_{\\mu}$ as the ratio of the time-averaged outward momentum input to the freestream dynamic pressure scale times $S$, and obtain a closed-form expression for $C_{\\mu}$ in terms of $\\rho_{j}$, $\\rho_{\\infty}$, $U_{\\infty}$, $A_{j}$, $S$, and $V_{a}$ for the given sinusoidal actuation. Then, for air with $\\rho_{\\infty} = \\rho_{j} = 1.2$ kg/m$^3$, freestream speed $U_{\\infty} = 30$ m/s, slot area $A_{j} = 5.0 \\times 10^{-5}$ m$^2$, actuation amplitude $V_{a} = 100$ m/s, and reference area $S = 0.10$ m$^2$, compute the numerical value of $C_{\\mu}$. Express the final answer as a dimensionless number and round your answer to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Actuator Model**: Synthetic Jet Actuator (SJA) with a time-periodic wall-normal velocity boundary condition.\n- **Slot Area**: $A_{j}$.\n- **Velocity Profile**: Spatially uniform across the slot.\n- **Actuation Velocity**: $v_{j}(t) = V_{a}\\sin(\\omega t)$.\n- **Peak Velocity**: $V_{a}$.\n- **Angular Frequency**: $\\omega$.\n- **Mean Mass Flux**: Zero over one actuation period.\n- **Momentum Input Condition**: Outward momentum is produced only during the blowing half-cycle, where $v_{j}(t)  0$. Suction half-cycle injects no momentum.\n- **Freestream Speed**: $U_{\\infty}$.\n- **Freestream Density**: $\\rho_{\\infty}$.\n- **Jet Fluid Density**: $\\rho_{j}$.\n- **Aerodynamic Reference Area**: $S$.\n- **Task**:\n    1. Derive the time-averaged outward momentum input over one actuation period, $T$.\n    2. Define the dimensionless momentum coefficient $C_{\\mu}$ as the ratio of the time-averaged outward momentum input to the freestream dynamic pressure scale times $S$.\n    3. Obtain a closed-form expression for $C_{\\mu}$.\n    4. Compute the numerical value of $C_{\\mu}$ for the given data.\n- **Numerical Data**:\n    - $\\rho_{\\infty} = \\rho_{j} = 1.2$ kg/m$^3$.\n    - $U_{\\infty} = 30$ m/s.\n    - $A_{j} = 5.0 \\times 10^{-5}$ m$^2$.\n    - $V_{a} = 100$ m/s.\n    - $S = 0.10$ m$^2$.\n- **Rounding Requirement**: The final numerical answer must be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, employing standard principles of fluid dynamics such as the Reynolds Transport Theorem, momentum flux, and dimensionless analysis (momentum coefficient $C_{\\mu}$). The model of a synthetic jet actuator as a sinusoidal velocity boundary condition is a common and valid simplification in computational fluid dynamics (CFD). The problem is well-posed, providing all necessary definitions, variables, and numerical values to arrive at a unique solution. The language is objective and precise. The distinction between the zero-net-mass-flux nature of an SJA and the definition of $C_{\\mu}$ based only on the blowing stroke is a standard convention in the aerospace field for characterizing the actuator's momentum-imparting capability to the external flow. All numerical values are physically plausible for a typical low-speed aerodynamic application. The problem does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe first step is to derive the time-averaged outward momentum input to the flow. The instantaneous momentum flux is the product of the mass flow rate and the velocity of the jet. The mass flow rate, $\\dot{m}(t)$, from the slot is given by $\\dot{m}(t) = \\rho_{j} A_{j} v_{j}(t)$, where the velocity profile is assumed uniform across the slot area $A_{j}$. The instantaneous rate of momentum input (momentum flux), $\\dot{M}(t)$, is then:\n$$\n\\dot{M}(t) = \\dot{m}(t) v_{j}(t) = \\left(\\rho_{j} A_{j} v_{j}(t)\\right) v_{j}(t) = \\rho_{j} A_{j} \\left[v_{j}(t)\\right]^{2}\n$$\nSubstituting the given sinusoidal velocity function, $v_{j}(t) = V_{a}\\sin(\\omega t)$:\n$$\n\\dot{M}(t) = \\rho_{j} A_{j} \\left(V_{a}\\sin(\\omega t)\\right)^{2} = \\rho_{j} A_{j} V_{a}^{2} \\sin^{2}(\\omega t)\n$$\nThe problem specifies that momentum is input to the external flow only during the blowing half-cycle, i.e., when $v_{j}(t)  0$. For the function $\\sin(\\omega t)$, this corresponds to the time interval $t \\in [0, T/2]$, where $T = 2\\pi/\\omega$ is the actuation period. During the suction half-cycle, $t \\in (T/2, T]$, the momentum input is considered zero.\n\nThe time-averaged outward momentum input, which we denote as $\\bar{M}$, is the total momentum input over one full period $T$, divided by the period itself.\n$$\n\\bar{M} = \\frac{1}{T} \\int_{0}^{T} \\dot{M}_{\\text{outward}}(t) \\, dt\n$$\nBased on the problem statement, this becomes:\n$$\n\\bar{M} = \\frac{1}{T} \\left[ \\int_{0}^{T/2} \\rho_{j} A_{j} V_{a}^{2} \\sin^{2}(\\omega t) \\, dt + \\int_{T/2}^{T} 0 \\, dt \\right] = \\frac{\\rho_{j} A_{j} V_{a}^{2}}{T} \\int_{0}^{T/2} \\sin^{2}(\\omega t) \\, dt\n$$\nTo evaluate the integral, we use the trigonometric identity $\\sin^{2}(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$:\n$$\n\\int_{0}^{T/2} \\sin^{2}(\\omega t) \\, dt = \\int_{0}^{T/2} \\frac{1 - \\cos(2\\omega t)}{2} \\, dt = \\frac{1}{2} \\left[ t - \\frac{\\sin(2\\omega t)}{2\\omega} \\right]_{0}^{T/2}\n$$\nSubstituting the limits of integration:\n$$\n\\frac{1}{2} \\left[ \\left(\\frac{T}{2} - \\frac{\\sin(2\\omega(T/2))}{2\\omega}\\right) - \\left(0 - \\frac{\\sin(0)}{2\\omega}\\right) \\right]\n$$\nSince $T=2\\pi/\\omega$, the argument of the sine function becomes $2\\omega(T/2) = \\omega T = 2\\pi$. As $\\sin(2\\pi)=0$ and $\\sin(0)=0$, the integral simplifies to:\n$$\n\\frac{1}{2} \\left[ \\frac{T}{2} - 0 \\right] = \\frac{T}{4}\n$$\nSubstituting this result back into the expression for $\\bar{M}$:\n$$\n\\bar{M} = \\frac{\\rho_{j} A_{j} V_{a}^{2}}{T} \\left( \\frac{T}{4} \\right) = \\frac{1}{4} \\rho_{j} A_{j} V_{a}^{2}\n$$\nThis is the time-averaged outward momentum input.\n\nNext, we define the dimensionless momentum coefficient, $C_{\\mu}$. The problem defines it as the ratio of the time-averaged outward momentum input to the freestream momentum scale, which is the product of the freestream dynamic pressure, $q_{\\infty} = \\frac{1}{2}\\rho_{\\infty}U_{\\infty}^{2}$, and the reference area, $S$.\n$$\nC_{\\mu} = \\frac{\\bar{M}}{q_{\\infty} S} = \\frac{\\bar{M}}{\\frac{1}{2} \\rho_{\\infty} U_{\\infty}^{2} S}\n$$\nSubstituting our derived expression for $\\bar{M}$:\n$$\nC_{\\mu} = \\frac{\\frac{1}{4} \\rho_{j} A_{j} V_{a}^{2}}{\\frac{1}{2} \\rho_{\\infty} U_{\\infty}^{2} S} = \\frac{1}{2} \\frac{\\rho_{j} A_{j} V_{a}^{2}}{\\rho_{\\infty} S U_{\\infty}^{2}}\n$$\nThis is the closed-form expression for $C_{\\mu}$.\n\nFinally, we compute the numerical value of $C_{\\mu}$ using the provided data:\n$\\rho_{j} = 1.2$ kg/m$^3$\n$\\rho_{\\infty} = 1.2$ kg/m$^3$\n$A_{j} = 5.0 \\times 10^{-5}$ m$^2$\n$V_{a} = 100$ m/s\n$U_{\\infty} = 30$ m/s\n$S = 0.10$ m$^2$\n\nSubstituting these values into the expression for $C_{\\mu}$:\n$$\nC_{\\mu} = \\frac{1}{2} \\frac{(1.2) \\cdot (5.0 \\times 10^{-5}) \\cdot (100)^{2}}{(1.2) \\cdot (0.10) \\cdot (30)^{2}}\n$$\nSince $\\rho_{j} = \\rho_{\\infty}$, the density terms cancel.\n$$\nC_{\\mu} = \\frac{1}{2} \\frac{(5.0 \\times 10^{-5}) \\cdot (10000)}{(0.10) \\cdot (900)}\n$$\n$$\nC_{\\mu} = \\frac{1}{2} \\frac{5.0 \\times 10^{-1}}{90} = \\frac{0.5}{180} = \\frac{1}{360}\n$$\nConverting this fraction to a decimal:\n$$\nC_{\\mu} = 0.002777...\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nC_{\\mu} \\approx 0.002778\n$$\nThis can also be expressed in scientific notation as $2.778 \\times 10^{-3}$.",
            "answer": "$$\n\\boxed{2.778 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "High-fidelity simulations of controlled flows generate vast datasets, from which it is often challenging to extract the core underlying dynamics. Proper Orthogonal Decomposition (POD) is a powerful data-driven technique for identifying the most energetic coherent structures from a series of flow snapshots. This practice guides you through the essential steps of applying POD to simulation data to construct a computationally efficient reduced-order model (ROM), a cornerstone of modern flow analysis and control design .",
            "id": "3941255",
            "problem": "You are given a controlled, linearized incompressible flow model intended to represent a one-dimensional streamwise perturbation of a base flow in a channel. The governing dynamics for the perturbation field $q(x,t)$ are modeled in continuous form by the linear advection–diffusion equation with a localized body-force control input\n$$\n\\frac{\\partial q}{\\partial t} = \\nu \\frac{\\partial^2 q}{\\partial x^2} - U \\frac{\\partial q}{\\partial x} + b(x) \\, u(t),\n$$\nwhere $x \\in [0,L_x]$ with periodic boundary conditions, $U$ is the uniform base flow speed, $\\nu$ is the kinematic viscosity, $b(x)$ is the spatial control input distribution, and $u(t)$ is the scalar control signal. The spatial domain is discretized uniformly into $N$ points with spacing $\\Delta x = L_x/N$, yielding the semi-discrete linear system\n$$\n\\frac{d \\mathbf{q}}{d t} = \\mathbf{L} \\mathbf{q} + \\mathbf{B} \\, u(t),\n$$\nwhere $\\mathbf{q}(t) \\in \\mathbb{R}^N$, $\\mathbf{L} \\in \\mathbb{R}^{N \\times N}$ is the discrete advection–diffusion operator constructed using second-order central differences for diffusion and central differences for advection with periodic wrap, and $\\mathbf{B} \\in \\mathbb{R}^N$ is the discretized control input distribution corresponding to $b(x)$. A set of $K$ time-indexed snapshots is assembled as columns of the matrix $\\mathbf{Q} \\in \\mathbb{R}^{N \\times K}$ by numerically integrating the full-order model under a prescribed control signal $u(t)$.\n\nTo construct an energy-optimal low-dimensional subspace, define the weighted inner product via the diagonal weight matrix $\\mathbf{W} \\in \\mathbb{R}^{N \\times N}$ with positive entries (for example, approximating quadrature weights over the domain), and the corresponding norm $\\|\\mathbf{v}\\|_{\\mathbf{W}}^2 = \\mathbf{v}^\\top \\mathbf{W} \\mathbf{v}$. Proper Orthogonal Decomposition (POD) seeks an $r$-dimensional subspace spanned by columns of $\\boldsymbol{\\Phi} \\in \\mathbb{R}^{N \\times r}$ that minimizes the mean-squared reconstruction error of the snapshots in the $\\mathbf{W}$-weighted norm, with the constraint of $\\mathbf{W}$-orthonormality, i.e., $\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\boldsymbol{\\Phi} = \\mathbf{I}_r$. The reduced coordinates are defined by the projection of the state onto the subspace via $ \\mathbf{a}(t) = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{q}(t)$, where $\\mathbf{a}(t) \\in \\mathbb{R}^r$. The reduced-order dynamical system is the Galerkin projection of the full-order dynamics onto the POD subspace, yielding a low-dimensional system with control input $u(t)$.\n\nYour task is to:\n1. Starting from the continuous advection–diffusion model, construct the discrete operator $\\mathbf{L}$ using a second-order central difference scheme for diffusion and a central difference scheme for advection with periodic boundary conditions, and construct $\\mathbf{B}$ as a localized Gaussian body-force distribution centered at a specified location with standard deviation given in spatial units.\n2. Simulate the semi-discrete system using explicit Euler time-stepping to generate $K$ snapshots $\\mathbf{Q} = [\\mathbf{q}(t_1), \\ldots, \\mathbf{q}(t_K)]$ for a specified control function $u(t)$, with $\\mathbf{q}(0) = \\mathbf{0}$. Use uniform time steps of size $\\Delta t$.\n3. Compute the $\\mathbf{W}$-weighted POD modes $\\boldsymbol{\\Phi}$ of rank $r$ from $\\mathbf{Q}$, and enforce $\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\boldsymbol{\\Phi} = \\mathbf{I}_r$.\n4. Define the reduced-order coordinates $\\mathbf{a}(t) = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{q}(t)$ and derive the reduced-order model of the form\n$$\n\\frac{d \\mathbf{a}}{dt} = \\mathbf{A}_r \\mathbf{a} + \\mathbf{B}_r \\, u(t),\n$$\nby projecting the full-order linear dynamics onto the POD subspace. Provide the explicit construction of $\\mathbf{A}_r$ and $\\mathbf{B}_r$ in terms of $\\boldsymbol{\\Phi}$, $\\mathbf{W}$, $\\mathbf{L}$, and $\\mathbf{B}$.\n5. Quantify two metrics: the retained energy fraction of the rank-$r$ POD approximation defined as the ratio of the sum of the leading $r$ snapshot singular values squared to the total sum of snapshot singular values squared (this is a dimensionless decimal), and the projection closure residual defined as\n$$\n\\mathcal{R} = \\frac{\\|(\\mathbf{I} - \\mathbf{P}_{\\mathbf{W}})\\mathbf{L}\\boldsymbol{\\Phi}\\|_F}{\\|\\mathbf{L}\\boldsymbol{\\Phi}\\|_F},\n\\quad \\text{with} \\quad \\mathbf{P}_{\\mathbf{W}} = \\boldsymbol{\\Phi} \\boldsymbol{\\Phi}^\\top \\mathbf{W},\n$$\nwhere $\\|\\cdot\\|_F$ denotes the Frobenius norm. This residual is a dimensionless decimal.\n\nUse the following fixed physical and numerical parameters in all simulations:\n- Domain length $L_x = 1$ m, number of grid points $N = 64$, viscosity $\\nu = 0.01$ m$^2$/s, base flow $U = 1$ m/s, Gaussian control center $x_c = 0.25$ m, Gaussian standard deviation $\\sigma = 0.05$ m, time step $\\Delta t = 0.002$ s, final time $T = 0.5$ s, and initial condition $\\mathbf{q}(0) = \\mathbf{0}$.\n- Control signal $u(t)$ is piecewise constant: $u(t) = 1$ for $0 \\le t  0.25$ seconds, and $u(t) = -1$ for $0.25 \\le t \\le 0.5$ seconds.\n- Use snapshots at every time step, so $K = T/\\Delta t$.\n\nThe weight matrix $\\mathbf{W}$ and rank $r$ vary according to the following test suite:\n- Test case 1 (happy path, low rank): $\\mathbf{W}$ is uniform quadrature weights $\\mathbf{W} = \\Delta x \\, \\mathbf{I}_N$, rank $r = 1$.\n- Test case 2 (increased rank): $\\mathbf{W}$ is uniform quadrature weights $\\mathbf{W} = \\Delta x \\, \\mathbf{I}_N$, rank $r = 5$.\n- Test case 3 (non-uniform weights edge case): $\\mathbf{W}$ has entries $W_{ii} = \\Delta x \\left(1 + 0.3 \\cos(2\\pi x_i/L_x)\\right)$, rank $r = 15$, where $x_i$ are the grid point coordinates.\n\nYour program must compute, for each test case, the retained energy fraction (dimensionless decimal) and the projection closure residual (dimensionless decimal). The final output must be a single line containing a comma-separated list enclosed in square brackets in the order\n$$\n[\\text{energy}_1,\\text{residual}_1,\\text{energy}_2,\\text{residual}_2,\\text{energy}_3,\\text{residual}_3],\n$$\nwith each entry expressed as a decimal number. No units are required in the output because all requested metrics are dimensionless.",
            "solution": "The user-provided problem is critically reviewed and determined to be valid. It is scientifically grounded in the principles of fluid dynamics and linear systems theory, well-posed with a clear objective, and provides a complete and consistent set of parameters. The task demands the application of standard numerical methods (finite differences, time integration) and data-driven model reduction techniques (Proper Orthogonal Decomposition), which are staple concepts in computational science and engineering.\n\nThe solution is constructed by following the five tasks outlined in the problem statement.\n\n### Step 1: Discretization of the Governing Equation\n\nThe given continuous partial differential equation (PDE) is:\n$$\n\\frac{\\partial q}{\\partial t} = \\nu \\frac{\\partial^2 q}{\\partial x^2} - U \\frac{\\partial q}{\\partial x} + b(x) \\, u(t)\n$$\nThe spatial domain $x \\in [0, L_x]$ is discretized into $N$ uniformly spaced points $x_i = i \\Delta x$ for $i = 0, 1, \\dots, N-1$, where the grid spacing is $\\Delta x = L_x / N$. The perturbation field $q(x, t)$ is represented by a vector $\\mathbf{q}(t) \\in \\mathbb{R}^N$ where $(\\mathbf{q})_i = q(x_i, t)$.\n\nThe spatial derivatives are approximated using second-order finite difference schemes with periodic boundary conditions.\n\nThe diffusion term $\\nu \\frac{\\partial^2 q}{\\partial x^2}$ is discretized using a second-order central difference scheme:\n$$\n\\nu \\frac{\\partial^2 q}{\\partial x^2}\\bigg|_{x_i} \\approx \\nu \\frac{q(x_{i+1}, t) - 2q(x_i, t) + q(x_{i-1}, t)}{(\\Delta x)^2}\n$$\nThe advection term $-U \\frac{\\partial q}{\\partial x}$ is discretized using a second-order central difference scheme:\n$$\n-U \\frac{\\partial q}{\\partial x}\\bigg|_{x_i} \\approx -U \\frac{q(x_{i+1}, t) - q(x_{i-1}, t)}{2 \\Delta x}\n$$\nCombining these discretizations, the $i$-th component of the discretized operator $\\mathbf{L} \\mathbf{q}$ is:\n$$\n(\\mathbf{L} \\mathbf{q})_i = \\left(\\frac{\\nu}{(\\Delta x)^2} + \\frac{U}{2 \\Delta x}\\right) q_{i-1} - \\frac{2\\nu}{(\\Delta x)^2} q_i + \\left(\\frac{\\nu}{(\\Delta x)^2} - \\frac{U}{2 \\Delta x}\\right) q_{i+1}\n$$\nwhere indices are taken modulo $N$ to enforce periodicity. This defines the entries of the circulant matrix $\\mathbf{L} \\in \\mathbb{R}^{N \\times N}$.\n\nThe control input distribution $b(x)$ is a localized Gaussian function. The corresponding discrete vector $\\mathbf{B} \\in \\mathbb{R}^N$ has components:\n$$\nB_i = b(x_i) = \\exp\\left(-\\frac{(x_i - x_c)^2}{2\\sigma^2}\\right)\n$$\nThis leads to the semi-discrete linear time-invariant system:\n$$\n\\frac{d \\mathbf{q}}{dt} = \\mathbf{L} \\mathbf{q} + \\mathbf{B} u(t)\n$$\n\n### Step 2: Snapshot Generation via Time Integration\n\nThe semi-discrete system is integrated in time using the explicit Euler method, starting from the zero initial condition $\\mathbf{q}(0) = \\mathbf{0}$. The update rule for the state vector at time step $k$ is:\n$$\n\\mathbf{q}(t_{k+1}) = \\mathbf{q}(t_k) + \\Delta t \\left( \\mathbf{L} \\mathbf{q}(t_k) + \\mathbf{B} u(t_k) \\right)\n$$\nwhere $t_k = k \\Delta t$. The control signal $u(t)$ is piecewise constant as specified. We generate $K = T/\\Delta t$ snapshots by storing the state vector at each time step from $t_1 = \\Delta t$ to $t_K = T$. These vectors form the columns of the snapshot matrix $\\mathbf{Q} = [\\mathbf{q}(t_1), \\mathbf{q}(t_2), \\dots, \\mathbf{q}(t_K)] \\in \\mathbb{R}^{N \\times K}$.\n\n### Step 3: Weighted Proper Orthogonal Decomposition (POD)\n\nThe goal of POD is to find an $r$-dimensional basis $\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_1, \\dots, \\boldsymbol{\\phi}_r] \\in \\mathbb{R}^{N \\times r}$ that is orthonormal with respect to the $\\mathbf{W}$-weighted inner product ($\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\boldsymbol{\\Phi} = \\mathbf{I}_r$) and minimizes the average projection error of the snapshots.\n\nThis optimization problem is solved via the Singular Value Decomposition (SVD) of a weighted snapshot matrix. Let $\\mathbf{W}^{1/2}$ be the diagonal matrix whose entries are the square roots of the diagonal entries of $\\mathbf{W}$. We form the weighted snapshot matrix $\\tilde{\\mathbf{Q}} = \\mathbf{W}^{1/2} \\mathbf{Q}$ and compute its SVD:\n$$\n\\tilde{\\mathbf{Q}} = \\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^\\top\n$$\nwhere $\\mathbf{U} \\in \\mathbb{R}^{N \\times \\min(N,K)}$ has orthonormal columns, $\\boldsymbol{\\Sigma} \\in \\mathbb{R}^{\\min(N,K) \\times \\min(N,K)}$ is a diagonal matrix of singular values $\\sigma_i \\geq 0$, and $\\mathbf{V} \\in \\mathbb{R}^{K \\times \\min(N,K)}$ has orthonormal columns.\n\nThe columns of the optimal basis $\\boldsymbol{\\Phi}$, known as the POD modes, are obtained from the leading $r$ left singular vectors (columns of $\\mathbf{U}$) by reversing the weighting:\n$$\n\\boldsymbol{\\Phi} = (\\mathbf{W}^{1/2})^{-1} \\mathbf{U}_r\n$$\nwhere $\\mathbf{U}_r$ contains the first $r$ columns of $\\mathbf{U}$. The resulting modes are guaranteed to be $\\mathbf{W}$-orthonormal.\n\n### Step 4: Galerkin Projection and Reduced-Order Model (ROM)\n\nA reduced-order model (ROM) is obtained by projecting the full-order dynamics onto the subspace spanned by the POD modes. We approximate the state as a linear combination of the POD modes: $\\mathbf{q}(t) \\approx \\boldsymbol{\\Phi} \\mathbf{a}(t)$, where $\\mathbf{a}(t) \\in \\mathbb{R}^r$ is the vector of reduced coordinates.\n\nSubstituting this ansatz into the semi-discrete system yields a residual:\n$$\n\\mathbf{R}(t) = \\boldsymbol{\\Phi} \\frac{d\\mathbf{a}}{dt} - (\\mathbf{L} \\boldsymbol{\\Phi} \\mathbf{a} + \\mathbf{B} u(t))\n$$\nGalerkin projection requires this residual to be orthogonal to the basis functions in the $\\mathbf{W}$-weighted inner product, i.e., $\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{R}(t) = \\mathbf{0}$.\n$$\n\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\left( \\boldsymbol{\\Phi} \\frac{d\\mathbf{a}}{dt} \\right) = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\left( \\mathbf{L} \\boldsymbol{\\Phi} \\mathbf{a} + \\mathbf{B} u(t) \\right)\n$$\nUsing the $\\mathbf{W}$-orthonormality property, $\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\boldsymbol{\\Phi} = \\mathbf{I}_r$, we obtain the ROM:\n$$\n\\frac{d\\mathbf{a}}{dt} = \\left(\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{L} \\boldsymbol{\\Phi}\\right) \\mathbf{a}(t) + \\left(\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{B}\\right) u(t)\n$$\nThis is of the form $\\frac{d \\mathbf{a}}{dt} = \\mathbf{A}_r \\mathbf{a} + \\mathbf{B}_r u(t)$, with the reduced-order system matrices defined as:\n$$\n\\mathbf{A}_r = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{L} \\boldsymbol{\\Phi} \\in \\mathbb{R}^{r \\times r}\n$$\n$$\n\\mathbf{B}_r = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{B} \\in \\mathbb{R}^{r}\n$$\n\n### Step 5: Calculation of Performance Metrics\n\nTwo metrics are computed to evaluate the quality of the reduced-order basis.\n\n**Retained Energy Fraction**: The squared singular values $\\sigma_i^2$ of the weighted snapshot matrix $\\tilde{\\mathbf{Q}}$ correspond to the \"energy\" (variance) captured by each mode. The fraction of total energy retained by the rank-$r$ approximation is:\n$$\nE_r = \\frac{\\sum_{i=1}^r \\sigma_i^2}{\\sum_{j=1}^{\\min(N,K)} \\sigma_j^2}\n$$\n\n**Projection Closure Residual**: This metric quantifies how well the POD subspace is closed under the action of the dynamics operator $\\mathbf{L}$. The projection operator onto the POD subspace in the $\\mathbf{W}$-norm is $\\mathbf{P}_{\\mathbf{W}} = \\boldsymbol{\\Phi} \\boldsymbol{\\Phi}^\\top \\mathbf{W}$. The residual is defined as the Frobenius norm of the component of $\\mathbf{L}\\boldsymbol{\\Phi}$ that lies outside the POD subspace, normalized by the norm of $\\mathbf{L}\\boldsymbol{\\Phi}$:\n$$\n\\mathcal{R} = \\frac{\\|(\\mathbf{I} - \\mathbf{P}_{\\mathbf{W}})\\mathbf{L}\\boldsymbol{\\Phi}\\|_F}{\\|\\mathbf{L}\\boldsymbol{\\Phi}\\|_F}\n$$\nA small residual indicates that the dynamics of the modes are well-contained within the subspace they span, suggesting that the Galerkin projection will be accurate.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of building and evaluating a reduced-order model for a\n    linearized 1D advection-diffusion equation.\n    \"\"\"\n    # Fixed physical and numerical parameters\n    Lx = 1.0  # Domain length\n    N = 64  # Number of grid points\n    nu = 0.01  # Kinematic viscosity\n    U = 1.0  # Base flow speed\n    xc = 0.25  # Gaussian control center\n    sigma = 0.05  # Gaussian standard deviation\n    dt = 0.002  # Time step\n    T = 0.5  # Final time\n\n    # Derived parameters\n    dx = Lx / N\n    x = np.linspace(0, Lx, N, endpoint=False)\n    num_steps = int(T / dt)\n    K = num_steps\n\n    # --- Step 1: Construct discrete operators L and B ---\n    L = np.zeros((N, N))\n    # Coefficients based on central difference schemes\n    c_diff = nu / dx**2\n    c_adv = U / (2 * dx)\n    for i in range(N):\n        L[i, i] = -2.0 * c_diff\n        L[i, (i + 1) % N] = c_diff - c_adv\n        L[i, (i - 1 + N) % N] = c_diff + c_adv\n    \n    B = np.exp(-((x - xc)**2) / (2 * sigma**2))\n\n    # --- Step 2: Generate snapshots Q ---\n    q = np.zeros(N)\n    Q = np.zeros((N, K))\n    for k in range(num_steps):\n        time = k * dt\n        u_val = 1.0 if time  0.25 else -1.0\n        \n        # Explicit Euler step\n        q = q + dt * (L @ q + B * u_val)\n        Q[:, k] = q\n\n    # Define test cases\n    test_cases = [\n        {'type': 'uniform', 'r': 1},\n        {'type': 'uniform', 'r': 5},\n        {'type': 'cosine', 'r': 15}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        r = case['r']\n\n        # --- Construct weight matrix W for the current test case ---\n        if case['type'] == 'uniform':\n            W_diag = np.full(N, dx)\n        elif case['type'] == 'cosine':\n            W_diag = dx * (1.0 + 0.3 * np.cos(2 * np.pi * x / Lx))\n        \n        W = np.diag(W_diag)\n        W_sqrt_diag = np.sqrt(W_diag)\n        W_inv_sqrt_diag = 1.0 / W_sqrt_diag\n        W_sqrt = np.diag(W_sqrt_diag)\n        W_inv_sqrt = np.diag(W_inv_sqrt_diag)\n\n        # --- Step 3: Compute weighted POD modes Phi ---\n        Q_tilde = W_sqrt @ Q\n        # Use full_matrices=False for efficiency\n        U_svd, s, _ = np.linalg.svd(Q_tilde, full_matrices=False)\n        \n        # Truncate to rank r\n        Ur = U_svd[:, :r]\n        Phi = W_inv_sqrt @ Ur\n\n        # --- Step 5: Compute metrics ---\n        # Retained Energy Fraction\n        energy_fraction = np.sum(s[:r]**2) / np.sum(s**2)\n\n        # Projection Closure Residual\n        LPhi = L @ Phi\n        P_W = Phi @ Phi.T @ W\n        I = np.identity(N)\n        \n        residual_matrix = (I - P_W) @ LPhi\n        \n        norm_numerator = np.linalg.norm(residual_matrix, 'fro')\n        norm_denominator = np.linalg.norm(LPhi, 'fro')\n        \n        closure_residual = norm_numerator / norm_denominator\n\n        results.extend([energy_fraction, closure_residual])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{val:.10f}' for val in results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Once a predictive model of the flow's response is established, such as a reduced-order model, we can transition from mere simulation to systematic control design. This exercise introduces resolvent analysis, a powerful frequency-domain framework for identifying which external inputs are most effectively amplified by the flow dynamics. By determining the forcing frequency that maximizes the system's resolvent gain, you will learn how to design an optimal periodic control strategy, which is the central goal in many practical active flow control applications .",
            "id": "3941258",
            "problem": "A two-dimensional incompressible airfoil flow at moderate Reynolds number is controlled using periodic wall-normal actuation. The flow is modeled by a linear time-invariant reduced-order system obtained from the linearized Navier–Stokes equations around the mean flow and a projection onto the leading oscillatory shear-layer mode. The reduced-order model captures the dominant amplification mechanism relevant to active flow control and is given in state-space form by\n$$\n\\frac{d}{dt}\\mathbf{q}(t) = \\mathbf{A}\\,\\mathbf{q}(t) + \\mathbf{B}\\,f(t), \\qquad y(t) = \\mathbf{C}\\,\\mathbf{q}(t),\n$$\nwhere $\\mathbf{q}(t) \\in \\mathbb{R}^{2}$ is the state, $f(t) \\in \\mathbb{R}$ is the actuation input, and $y(t) \\in \\mathbb{R}$ is a scalar output measuring a shear-layer kinetic energy proxy. The matrices are\n$$\n\\mathbf{A} = \\begin{pmatrix}\n0  1 \\\\\n- \\omega_{n}^{2}  -2\\zeta\\,\\omega_{n}\n\\end{pmatrix}, \\quad\n\\mathbf{B} = \\begin{pmatrix}\n0 \\\\\nb\n\\end{pmatrix}, \\quad\n\\mathbf{C} = \\begin{pmatrix}\n1  0\n\\end{pmatrix},\n$$\nwith natural frequency $\\omega_{n} = 1.50$ (radians per convective time unit) and damping ratio $\\zeta = 0.25$. The actuation gain is $b = 1$. The actuation is periodic, $f(t) = \\Re\\{\\hat{f}\\,\\exp(i\\omega t)\\}$, and is subject to a root-mean-square amplitude constraint $|\\hat{f}| \\le f_{0}$ with $f_{0} = 0.05$ (non-dimensionalized by free-stream velocity and characteristic length).\n\nStarting from the linearized model and the definition of the resolvent operator, derive the input-output resolvent mapping and formulate the resolvent gain as the largest singular value of the frequency response. Then, design the forcing to maximize the resolvent gain subject to the actuation amplitude constraint and determine the optimal forcing frequency. Use the convective time scale $T_{c} = L/U_{\\infty}$ so that the frequency is expressed in radians per convective time unit. Round your final numerical answer to four significant figures.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n**Step 1: Extract Givens**\nThe problem provides a linear time-invariant (LTI) reduced-order model for an airfoil flow:\nState-space equations:\n$$ \\frac{d}{dt}\\mathbf{q}(t) = \\mathbf{A}\\,\\mathbf{q}(t) + \\mathbf{B}\\,f(t) $$\n$$ y(t) = \\mathbf{C}\\,\\mathbf{q}(t) $$\nState vector: $\\mathbf{q}(t) \\in \\mathbb{R}^{2}$\nInput: $f(t) \\in \\mathbb{R}$\nOutput: $y(t) \\in \\mathbb{R}$\nState matrix:\n$$ \\mathbf{A} = \\begin{pmatrix} 0  1 \\\\ - \\omega_{n}^{2}  -2\\zeta\\,\\omega_{n} \\end{pmatrix} $$\nInput matrix:\n$$ \\mathbf{B} = \\begin{pmatrix} 0 \\\\ b \\end{pmatrix} $$\nOutput matrix:\n$$ \\mathbf{C} = \\begin{pmatrix} 1  0 \\end{pmatrix} $$\nModel parameters:\nNatural frequency: $\\omega_{n} = 1.50$ radians per convective time unit.\nDamping ratio: $\\zeta = 0.25$.\nActuation gain: $b = 1$.\nActuation form: $f(t) = \\Re\\{\\hat{f}\\,\\exp(i\\omega t)\\}$.\nActuation constraint: $|\\hat{f}| \\le f_{0}$, where $f_{0} = 0.05$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated based on the predefined criteria:\n- **Scientifically Grounded**: The model provided is a standard second-order linear differential equation, which represents a damped harmonic oscillator. This is a canonical model for describing the linear response of many physical systems, including shear-layer instabilities in fluid dynamics, which are often targeted by active flow control strategies. The use of resolvent analysis to study the input-output frequency response of linearized Navier-Stokes equations is a well-established and powerful technique in modern fluid mechanics. All parameters have clear physical interpretations within this context. The problem is scientifically sound.\n- **Well-Posed**: The problem asks to derive a specific quantity (the resolvent gain) and then optimize it with respect to a parameter (the forcing frequency) under a given constraint. The mathematical structure is clear, and the objective is well-defined. A unique solution is expected. The problem is well-posed.\n- **Objective**: The problem is stated using precise mathematical and engineering terminology. There are no subjective, ambiguous, or opinion-based statements.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid** as it is scientifically grounded, well-posed, objective, and self-contained. The solution process may proceed.\n\n**Solution Derivation**\n\nThe primary objective is to find the optimal forcing frequency $\\omega$ that maximizes the system's response, which is quantified by the resolvent gain.\n\n**1. Derivation of the Input-Output Resolvent Mapping (Frequency Response)**\nWe begin with the LTI state-space model:\n$$ \\frac{d}{dt}\\mathbf{q}(t) = \\mathbf{A}\\,\\mathbf{q}(t) + \\mathbf{B}\\,f(t) $$\n$$ y(t) = \\mathbf{C}\\,\\mathbf{q}(t) $$\nFor a periodic forcing $f(t) = \\Re\\{\\hat{f}\\,\\exp(i\\omega t)\\}$, the steady-state response of a linear system is also periodic with the same frequency. We can thus write the state and output vectors in terms of their complex amplitudes (phasors) as $\\mathbf{q}(t) = \\Re\\{\\hat{\\mathbf{q}}\\,\\exp(i\\omega t)\\}$ and $y(t) = \\Re\\{\\hat{y}\\,\\exp(i\\omega t)\\}$. Substituting these into the state equation yields:\n$$ \\frac{d}{dt} \\Re\\{\\hat{\\mathbf{q}}\\,\\exp(i\\omega t)\\} = \\mathbf{A}\\,\\Re\\{\\hat{\\mathbf{q}}\\,\\exp(i\\omega t)\\} + \\mathbf{B}\\,\\Re\\{\\hat{f}\\,\\exp(i\\omega t)\\} $$\nUsing the property that differentiation and matrix multiplication are linear operators, we can move the real part operator outside and work with the complex quantities:\n$$ \\Re\\{i\\omega\\,\\hat{\\mathbf{q}}\\,\\exp(i\\omega t)\\} = \\Re\\{(\\mathbf{A}\\,\\hat{\\mathbf{q}} + \\mathbf{B}\\,\\hat{f})\\,\\exp(i\\omega t)\\} $$\nThis equality must hold for all time $t$, which implies the equality of the complex amplitudes:\n$$ i\\omega\\,\\hat{\\mathbf{q}} = \\mathbf{A}\\,\\hat{\\mathbf{q}} + \\mathbf{B}\\,\\hat{f} $$\nRearranging to solve for the state response amplitude $\\hat{\\mathbf{q}}$ gives:\n$$ (i\\omega\\,\\mathbf{I} - \\mathbf{A})\\,\\hat{\\mathbf{q}} = \\mathbf{B}\\,\\hat{f} $$\n$$ \\hat{\\mathbf{q}} = (i\\omega\\,\\mathbf{I} - \\mathbf{A})^{-1}\\,\\mathbf{B}\\,\\hat{f} $$\nThe operator $(i\\omega\\,\\mathbf{I} - \\mathbf{A})^{-1}$ is the resolvent of the matrix $\\mathbf{A}$ evaluated on the imaginary axis. The output amplitude $\\hat{y}$ is then given by:\n$$ \\hat{y} = \\mathbf{C}\\,\\hat{\\mathbf{q}} = \\mathbf{C}\\,(i\\omega\\,\\mathbf{I} - \\mathbf{A})^{-1}\\,\\mathbf{B}\\,\\hat{f} $$\nThe scalar complex function $H(i\\omega) = \\mathbf{C}\\,(i\\omega\\,\\mathbf{I} - \\mathbf{A})^{-1}\\,\\mathbf{B}$ is the system's transfer function or frequency response. It represents the input-output resolvent mapping between the forcing amplitude $\\hat{f}$ and the output amplitude $\\hat{y}$.\n\n**2. Formulation of the Resolvent Gain**\nThe resolvent gain, $\\sigma(\\omega)$, is defined as the largest singular value of the frequency response operator $H(i\\omega)$. For a single-input, single-output (SISO) system like this one, $H(i\\omega)$ is a scalar (a complex number for each $\\omega$). The singular value of a scalar is simply its magnitude. Therefore, the resolvent gain is:\n$$ \\sigma(\\omega) = |H(i\\omega)| $$\nWe now compute $H(i\\omega)$ explicitly. First, we form the matrix $(i\\omega\\,\\mathbf{I} - \\mathbf{A})$:\n$$ i\\omega\\,\\mathbf{I} - \\mathbf{A} = \\begin{pmatrix} i\\omega  0 \\\\ 0  i\\omega \\end{pmatrix} - \\begin{pmatrix} 0  1 \\\\ -\\omega_{n}^{2}  -2\\zeta\\omega_{n} \\end{pmatrix} = \\begin{pmatrix} i\\omega  -1 \\\\ \\omega_{n}^{2}  i\\omega + 2\\zeta\\omega_{n} \\end{pmatrix} $$\nThe determinant of this matrix is:\n$$ \\det(i\\omega\\,\\mathbf{I} - \\mathbf{A}) = (i\\omega)(i\\omega + 2\\zeta\\omega_{n}) - (-1)(\\omega_{n}^{2}) = -\\omega^{2} + i(2\\zeta\\omega_{n}\\omega) + \\omega_{n}^{2} $$\nThe inverse is:\n$$ (i\\omega\\,\\mathbf{I} - \\mathbf{A})^{-1} = \\frac{1}{(\\omega_{n}^{2} - \\omega^{2}) + i(2\\zeta\\omega_{n}\\omega)} \\begin{pmatrix} i\\omega + 2\\zeta\\omega_{n}  1 \\\\ -\\omega_{n}^{2}  i\\omega \\end{pmatrix} $$\nNow, we can compute $H(i\\omega)$:\n$$ H(i\\omega) = \\mathbf{C}\\,(i\\omega\\,\\mathbf{I} - \\mathbf{A})^{-1}\\,\\mathbf{B} = \\frac{1}{(\\omega_{n}^{2} - \\omega^{2}) + i(2\\zeta\\omega_{n}\\omega)} \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} i\\omega + 2\\zeta\\omega_{n}  1 \\\\ -\\omega_{n}^{2}  i\\omega \\end{pmatrix} \\begin{pmatrix} 0 \\\\ b \\end{pmatrix} $$\n$$ H(i\\omega) = \\frac{1}{(\\omega_{n}^{2} - \\omega^{2}) + i(2\\zeta\\omega_{n}\\omega)} \\begin{pmatrix} i\\omega + 2\\zeta\\omega_{n}  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ b \\end{pmatrix} $$\n$$ H(i\\omega) = \\frac{b}{(\\omega_{n}^{2} - \\omega^{2}) + i(2\\zeta\\omega_{n}\\omega)} $$\nThe resolvent gain is the magnitude of this expression:\n$$ \\sigma(\\omega) = |H(i\\omega)| = \\frac{|b|}{\\sqrt{(\\omega_{n}^{2} - \\omega^{2})^{2} + (2\\zeta\\omega_{n}\\omega)^{2}}} $$\n\n**3. Design of the Optimal Forcing**\nThe problem asks to design the forcing to maximize the resolvent gain. The forcing consists of choosing its amplitude $\\hat{f}$ and frequency $\\omega$. The output amplitude is $|\\hat{y}| = \\sigma(\\omega)|\\hat{f}|$. Given the constraint $|\\hat{f}| \\le f_0$, the output amplitude is maximized by choosing the largest possible input amplitude, $|\\hat{f}| = f_0$.\nThe main task is to find the frequency $\\omega_{opt}$ that maximizes $\\sigma(\\omega)$. Maximizing $\\sigma(\\omega)$ is equivalent to minimizing the squared denominator, which we denote as $D(\\omega)$:\n$$ D(\\omega) = (\\omega_{n}^{2} - \\omega^{2})^{2} + (2\\zeta\\omega_{n}\\omega)^{2} $$\nTo find the minimum, we compute the derivative of $D(\\omega)$ with respect to $\\omega$ and set it to zero.\n$$ \\frac{dD}{d\\omega} = 2(\\omega_{n}^{2} - \\omega^{2})(-2\\omega) + 2(2\\zeta\\omega_{n}\\omega)(2\\zeta\\omega_{n}) = 0 $$\n$$ -4\\omega(\\omega_{n}^{2} - \\omega^{2}) + 8\\zeta^{2}\\omega_{n}^{2}\\omega = 0 $$\nFor a non-trivial solution where $\\omega \\neq 0$, we can divide by $4\\omega$:\n$$ -(\\omega_{n}^{2} - \\omega^{2}) + 2\\zeta^{2}\\omega_{n}^{2} = 0 $$\n$$ \\omega^{2} - \\omega_{n}^{2} + 2\\zeta^{2}\\omega_{n}^{2} = 0 $$\n$$ \\omega^{2} = \\omega_{n}^{2} - 2\\zeta^{2}\\omega_{n}^{2} = \\omega_{n}^{2}(1 - 2\\zeta^{2}) $$\nThe optimal frequency, known as the resonance frequency $\\omega_r$, is therefore:\n$$ \\omega_{opt} = \\omega_{n}\\sqrt{1 - 2\\zeta^{2}} $$\nThis real-valued optimal frequency exists only if $1 - 2\\zeta^{2} \\ge 0$, which implies $\\zeta \\le \\frac{1}{\\sqrt{2}}$.\n\n**4. Numerical Calculation**\nWe substitute the given values $\\omega_{n} = 1.50$ and $\\zeta = 0.25$ into the expression for $\\omega_{opt}$.\nFirst, we check the condition for resonance:\n$$ \\zeta = 0.25  \\frac{1}{\\sqrt{2}} \\approx 0.7071 $$\nThe condition is satisfied, so a distinct resonance peak exists.\nNow we compute the value of the optimal frequency:\n$$ \\omega_{opt} = 1.50 \\times \\sqrt{1 - 2(0.25)^{2}} $$\n$$ \\omega_{opt} = 1.50 \\times \\sqrt{1 - 2(0.0625)} $$\n$$ \\omega_{opt} = 1.50 \\times \\sqrt{1 - 0.125} $$\n$$ \\omega_{opt} = 1.50 \\times \\sqrt{0.875} $$\n$$ \\omega_{opt} \\approx 1.50 \\times 0.93541434669 $$\n$$ \\omega_{opt} \\approx 1.4031215200 $$\nRounding the result to four significant figures, we get:\n$$ \\omega_{opt} \\approx 1.403 $$\nThe optimal forcing frequency is $1.403$ radians per convective time unit.",
            "answer": "$$\\boxed{1.403}$$"
        }
    ]
}