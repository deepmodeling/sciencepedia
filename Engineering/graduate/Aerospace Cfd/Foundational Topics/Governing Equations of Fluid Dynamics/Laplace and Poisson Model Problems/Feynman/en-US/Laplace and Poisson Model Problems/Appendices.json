{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex numerical schemes, it is crucial to understand the analytical structure of solutions to the governing equations. This practice revisits the fundamental method of separation of variables to derive an exact, infinite series solution for the Laplace equation on a simple rectangular domain. Mastering this technique provides not only a benchmark for verifying numerical codes but also deepens the intuition for how boundary conditions dictate the behavior of the potential field throughout the domain .",
            "id": "3971038",
            "problem": "Consider a canonical model elliptic boundary-value problem that arises in Computational Fluid Dynamics (CFD) when analyzing elliptic operators used for pressure or potential correction in incompressible flow solvers, or when simplifying steady heat conduction in a thin plate. Let a rectangular domain be defined by $0 < x < L$ and $0 < y < H$. The scalar field $\\phi(x,y)$ is governed by the Laplace equation\n$$\n\\nabla^{2} \\phi \\equiv \\frac{\\partial^{2} \\phi}{\\partial x^{2}} + \\frac{\\partial^{2} \\phi}{\\partial y^{2}} = 0,\n$$\nwith homogeneous Dirichlet boundary conditions on three sides,\n$$\n\\phi(0,y) = 0,\\quad \\phi(L,y) = 0,\\quad \\phi(x,0) = 0,\n$$\nand a prescribed nonhomogeneous Dirichlet boundary condition on the fourth side,\n$$\n\\phi(x,H) = \\Phi_{0}\\,\\frac{x}{L},\n$$\nwhere $\\Phi_{0}$ is a constant amplitude. Assume $\\phi$ is the velocity potential measured in $\\mathrm{m^{2}/s}$ and the lengths $L$ and $H$ are measured in $\\mathrm{m}$. You will provide a symbolic expression for $\\phi(x,y)$; do not include units in the final boxed expression.\n\nStarting from fundamental principles, use separation of variables to construct the appropriate eigenfunctions that satisfy the homogeneous Dirichlet conditions, enforce the remaining boundary condition by expanding $\\phi(x,H)$ in the corresponding orthogonal basis, and derive the eigenfunction expansion coefficients from the given boundary data. Provide the final closed-form eigenfunction expansion for $\\phi(x,y)$ valid in $0 < x < L$, $0 < y < H$.",
            "solution": "The problem as stated is a well-posed, canonical elliptic boundary-value problem. It is scientifically grounded, self-contained, and free of contradictions. The governing equation is the Laplace equation, a fundamental PDE in mathematical physics, and the boundary conditions are clearly specified, making the problem solvable by standard methods. We may proceed with the solution.\n\nThe problem is to solve the two-dimensional Laplace equation for a scalar field $\\phi(x,y)$ on a rectangular domain,\n$$\n\\frac{\\partial^{2} \\phi}{\\partial x^{2}} + \\frac{\\partial^{2} \\phi}{\\partial y^{2}} = 0, \\quad \\text{for } 0 < x < L, \\ 0 < y < H\n$$\nsubject to the boundary conditions:\n$$\n\\phi(0,y) = 0 \\\\\n\\phi(L,y) = 0 \\\\\n\\phi(x,0) = 0 \\\\\n\\phi(x,H) = \\Phi_{0}\\,\\frac{x}{L}\n$$\n\nWe will use the method of separation of variables. We assume a solution of the form $\\phi(x,y) = X(x)Y(y)$. Substituting this into the Laplace equation gives:\n$$\nX''(x)Y(y) + X(x)Y''(y) = 0\n$$\nwhere primes denote differentiation with respect to the function's argument. For a non-trivial solution, we can divide by $X(x)Y(y)$ to separate the variables:\n$$\n\\frac{X''(x)}{X(x)} = -\\frac{Y''(y)}{Y(y)}\n$$\nSince the left side is a function of $x$ only and the right side is a function of $y$ only, both must be equal to a constant. We shall call this separation constant $-\\lambda$.\nThis yields two ordinary differential equations (ODEs):\n$$\nX''(x) + \\lambda X(x) = 0 \\\\\nY''(y) - \\lambda Y(y) = 0\n$$\n\nWe apply the homogeneous boundary conditions. Three of the four conditions are homogeneous.\nFrom $\\phi(0,y) = X(0)Y(y) = 0$, we require $X(0) = 0$ for a non-trivial solution.\nFrom $\\phi(L,y) = X(L)Y(y) = 0$, we require $X(L) = 0$.\nFrom $\\phi(x,0) = X(x)Y(0) = 0$, we require $Y(0) = 0$.\n\nFirst, we solve the Sturm-Liouville problem for $X(x)$ with the homogeneous boundary conditions:\n$$\nX''(x) + \\lambda X(x) = 0, \\quad X(0)=0, \\quad X(L)=0\n$$\nWe analyze the possible values of the eigenvalue $\\lambda$.\nCase 1: $\\lambda < 0$. Let $\\lambda = -k^2$ for some $k > 0$. The ODE becomes $X'' - k^2 X = 0$, with general solution $X(x) = A\\cosh(kx) + B\\sinh(kx)$. Applying the boundary conditions: $X(0) = A = 0$. Then $X(L) = B\\sinh(kL) = 0$. Since $L>0$ and $k>0$, $\\sinh(kL) \\neq 0$, so $B$ must be $0$. This leads to the trivial solution $X(x)=0$, so there are no negative eigenvalues.\nCase 2: $\\lambda = 0$. The ODE becomes $X'' = 0$, with general solution $X(x) = Ax + B$. Applying the boundary conditions: $X(0) = B = 0$. Then $X(L) = AL = 0$. Since $L \\neq 0$, $A$ must be $0$. This also leads to the trivial solution, so $\\lambda=0$ is not an eigenvalue.\nCase 3: $\\lambda > 0$. Let $\\lambda = k^2$ for some $k > 0$. The ODE is $X'' + k^2 X = 0$, with general solution $X(x) = A\\cos(kx) + B\\sin(kx)$. Applying the boundary conditions: $X(0) = A = 0$. Then $X(L) = B\\sin(kL) = 0$. For a non-trivial solution, we must have $B \\neq 0$, which requires $\\sin(kL)=0$. This condition is met when $kL = n\\pi$ for any integer $n$. Since $k > 0$, we take $n = 1, 2, 3, \\ldots$.\nThe eigenvalues are therefore $\\lambda_n = k_n^2 = \\left(\\frac{n\\pi}{L}\\right)^2$ for $n=1, 2, 3, \\ldots$.\nThe corresponding eigenfunctions, up to a multiplicative constant, are $X_n(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)$.\n\nNow we solve the ODE for $Y(y)$ using these eigenvalues:\n$$\nY''(y) - \\lambda_n Y(y) = 0 \\implies Y'' - \\left(\\frac{n\\pi}{L}\\right)^2 Y = 0\n$$\nThe general solution for $Y_n(y)$ is $Y_n(y) = C_n \\cosh\\left(\\frac{n\\pi y}{L}\\right) + D_n \\sinh\\left(\\frac{n\\pi y}{L}\\right)$.\nApplying the homogeneous boundary condition $Y(0)=0$:\n$$\nY_n(0) = C_n \\cosh(0) + D_n \\sinh(0) = C_n \\cdot 1 + D_n \\cdot 0 = C_n = 0\n$$\nThus, the solution for $Y_n(y)$ is of the form $Y_n(y) = D_n \\sinh\\left(\\frac{n\\pi y}{L}\\right)$.\n\nBy the principle of superposition, the general solution for $\\phi(x,y)$ is an infinite series of the product solutions $\\phi_n(x,y) = X_n(x)Y_n(y)$:\n$$\n\\phi(x,y) = \\sum_{n=1}^{\\infty} D_n \\sin\\left(\\frac{n\\pi x}{L}\\right) \\sinh\\left(\\frac{n\\pi y}{L}\\right)\n$$\nwhere the coefficients $D_n$ are to be determined from the remaining nonhomogeneous boundary condition.\n\nWe apply the condition at $y=H$: $\\phi(x,H) = \\Phi_{0}\\frac{x}{L}$.\n$$\n\\Phi_{0}\\frac{x}{L} = \\sum_{n=1}^{\\infty} D_n \\sin\\left(\\frac{n\\pi x}{L}\\right) \\sinh\\left(\\frac{n\\pi H}{L}\\right) = \\sum_{n=1}^{\\infty} b_n \\sin\\left(\\frac{n\\pi x}{L}\\right)\n$$\nThis is a Fourier sine series for the function $f(x) = \\Phi_{0}\\frac{x}{L}$ on the interval $[0, L]$. The coefficients $b_n = D_n \\sinh\\left(\\frac{n\\pi H}{L}\\right)$ are given by the standard formula:\n$$\nb_n = \\frac{2}{L} \\int_0^L f(x) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{2}{L} \\int_0^L \\left(\\Phi_{0}\\frac{x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx\n$$\n$$\nb_n = \\frac{2\\Phi_0}{L^2} \\int_0^L x \\sin\\left(\\frac{n\\pi x}{L}\\right) dx\n$$\nWe evaluate the integral using integration by parts, $\\int u \\, dv = uv - \\int v \\, du$, with $u=x$ and $dv = \\sin\\left(\\frac{n\\pi x}{L}\\right)dx$. This gives $du=dx$ and $v = -\\frac{L}{n\\pi}\\cos\\left(\\frac{n\\pi x}{L}\\right)$.\n$$\n\\int_0^L x \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\left[ -x \\frac{L}{n\\pi} \\cos\\left(\\frac{n\\pi x}{L}\\right) \\right]_0^L - \\int_0^L \\left(-\\frac{L}{n\\pi} \\cos\\left(\\frac{n\\pi x}{L}\\right)\\right) dx\n$$\n$$\n= \\left( -L \\frac{L}{n\\pi} \\cos(n\\pi) - 0 \\right) + \\frac{L}{n\\pi} \\int_0^L \\cos\\left(\\frac{n\\pi x}{L}\\right) dx\n$$\n$$\n= -\\frac{L^2}{n\\pi} (-1)^n + \\frac{L}{n\\pi} \\left[ \\frac{L}{n\\pi} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\right]_0^L\n$$\n$$\n= \\frac{L^2}{n\\pi} (-1)^{n+1} + \\frac{L^2}{(n\\pi)^2} (\\sin(n\\pi) - \\sin(0)) = \\frac{L^2}{n\\pi} (-1)^{n+1}\n$$\nSubstituting this result back into the expression for $b_n$:\n$$\nb_n = \\frac{2\\Phi_0}{L^2} \\left(\\frac{L^2}{n\\pi} (-1)^{n+1}\\right) = \\frac{2\\Phi_0}{n\\pi} (-1)^{n+1}\n$$\nNow we solve for the coefficients $D_n$:\n$$\nD_n = \\frac{b_n}{\\sinh\\left(\\frac{n\\pi H}{L}\\right)} = \\frac{2\\Phi_0 (-1)^{n+1}}{n\\pi\\sinh\\left(\\frac{n\\pi H}{L}\\right)}\n$$\nFinally, substituting these coefficients back into the general solution for $\\phi(x,y)$, we obtain the complete eigenfunction expansion:\n$$\n\\phi(x,y) = \\sum_{n=1}^{\\infty} \\frac{2\\Phi_0 (-1)^{n+1}}{n\\pi\\sinh\\left(\\frac{n\\pi H}{L}\\right)} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\sinh\\left(\\frac{n\\pi y}{L}\\right)\n$$\nThis can be written more tidily as:\n$$\n\\phi(x,y) = \\frac{2\\Phi_0}{\\pi} \\sum_{n=1}^{\\infty} \\frac{(-1)^{n+1}}{n} \\frac{\\sinh\\left(\\frac{n\\pi y}{L}\\right)}{\\sinh\\left(\\frac{n\\pi H}{L}\\right)} \\sin\\left(\\frac{n\\pi x}{L}\\right)\n$$\nThis expression is the final solution for the scalar field $\\phi(x,y)$ within the specified domain and boundary conditions.",
            "answer": "$$\\boxed{\\frac{2\\Phi_0}{\\pi} \\sum_{n=1}^{\\infty} \\frac{(-1)^{n+1}}{n} \\frac{\\sinh\\left(\\frac{n\\pi y}{L}\\right)}{\\sinh\\left(\\frac{n\\pi H}{L}\\right)} \\sin\\left(\\frac{n\\pi x}{L}\\right)}$$"
        },
        {
            "introduction": "Moving from the continuous to the discrete world, we must ensure our numerical methods preserve the physical properties of the original equation. This exercise explores a crucial aspect of the Finite Element Method (FEM): the connection between mesh quality and the Discrete Maximum Principle (DMP), which dictates that in the absence of sources, extrema should occur on the boundaries. You will derive the stiffness matrix coefficient for a general triangular mesh and discover how specific geometric configurations, such as obtuse angles, can lead to a violation of the DMP, potentially producing non-physical oscillations in a simulation .",
            "id": "3971023",
            "problem": "Consider the homogeneous Laplace model problem for steady heat conduction in two spatial dimensions, a canonical diffusion-only benchmark in Computational Fluid Dynamics (CFD): find a scalar potential $u(\\mathbf{x})$ such that $-\\nabla \\cdot (k \\nabla u) = 0$ in a polygonal domain, with isotropic and constant conductivity $k=1$ and prescribed Dirichlet boundary data. Discretize the weak form by the Galerkin Finite Element Method (FEM) using continuous, piecewise linear (affine) shape functions on a conforming triangulation. Focus attention on an interior edge connecting two vertices $i$ and $j$ shared by exactly two adjacent triangles. Let the angles opposite this interior edge in the two triangles be denoted $\\alpha$ and $\\beta$, respectively.\n\nIn meshes that are close to orthogonal and acute, the resulting discrete operator has a stencil that satisfies the properties of a monotone matrix (often called an \"M-matrix\"), which ensures a Discrete Maximum Principle (DMP): interior extrema cannot exceed boundary extrema when there is no internal source. However, highly skewed or obtuse elements can break these properties.\n\nStarting from the weak form and the definition of the element stiffness entries as $a_{pq}^{(e)} = \\int_{\\Omega_e}\\nabla N_p \\cdot \\nabla N_q \\,\\mathrm{d}A$, where $N_p$ are the local linear shape functions on triangle $\\Omega_e$, derive the expression for the global off-diagonal stiffness entry $a_{ij}$ associated with the interior edge shared by the two triangles in terms of the angles $\\alpha$ and $\\beta$. Then, consider the specific highly skewed configuration with opposite angles $\\alpha=120^\\circ$ and $\\beta=80^\\circ$ and compute the numerical value of $a_{ij}$ for this edge. Based on its sign, briefly explain whether this coefficient violates the non-positivity requirement for off-diagonals in an M-matrix, thereby providing a counterexample to the DMP.\n\nExpress your final answer as the single real-valued number equal to $a_{ij}$ for the given angles. Round your answer to five significant figures. Angles are specified in degrees, and trigonometric functions must be evaluated consistently in radians or degrees as appropriate for exact values; the final reported number must be dimensionless.",
            "solution": "The problem is valid as it is scientifically grounded in the theory of the Finite Element Method (FEM) for elliptic partial differential equations, is well-posed, objective, and internally consistent.\n\nWe are asked to derive the expression for an off-diagonal entry of the global stiffness matrix, $a_{ij}$, for the Laplace equation discretized with linear finite elements, and then to evaluate it for a specific geometric configuration. The governing equation is the homogeneous Laplace equation with unit conductivity, $-\\nabla^2 u = 0$.\n\nThe Galerkin FEM formulation for this problem leads to a system of linear equations $\\mathbf{A}\\mathbf{u} = \\mathbf{f}$. The entries of the global stiffness matrix $\\mathbf{A}$ are given by $a_{pq} = \\int_{\\Omega} \\nabla N_p \\cdot \\nabla N_q \\, \\mathrm{d}A$, where $N_p$ and $N_q$ are the global, piecewise linear basis functions (also known as \"hat\" functions).\n\nThe entry $a_{ij}$ for $i \\neq j$ receives contributions only from elements that contain both nodes $i$ and $j$. In this problem, we consider an interior edge connecting vertices $i$ and $j$, which is shared by exactly two adjacent triangles, which we denote $\\Omega_1$ and $\\Omega_2$. The global stiffness entry is thus the sum of the local contributions from these two elements:\n$$a_{ij} = a_{ij}^{(1)} + a_{ij}^{(2)}$$\nwhere $a_{ij}^{(e)} = \\int_{\\Omega_e} \\nabla N_i \\cdot \\nabla N_j \\, \\mathrm{d}A$ for $e \\in \\{1, 2\\}$.\n\nWithin a single linear triangular element $\\Omega_e$, the basis functions $N_i$ and $N_j$ are linear, which implies their gradients $\\nabla N_i$ and $\\nabla N_j$ are constant vectors. The integral simplifies to:\n$$a_{ij}^{(e)} = (\\nabla N_i|_{\\Omega_e} \\cdot \\nabla N_j|_{\\Omega_e}) \\cdot \\text{Area}(\\Omega_e)$$\n\nA standard result in FEM theory provides a formula for the local stiffness matrix entries for a triangular element. For an off-diagonal entry corresponding to nodes $i$ and $j$, the contribution is related to the cotangent of the angle opposite the edge $(i, j)$. Let the vertices of a triangle be $i$, $j$, and $k$, and let $\\gamma_k$ be the interior angle at vertex $k$. The local stiffness entry is derived as follows:\nThe gradients of the linear basis functions (barycentric coordinates) $\\lambda_i$ and $\\lambda_j$ are given by $\\nabla \\lambda_i = \\frac{1}{2A}(\\mathbf{x}_k - \\mathbf{x}_j)^{\\perp}$ and $\\nabla \\lambda_j = \\frac{1}{2A}(\\mathbf{x}_i - \\mathbf{x}_k)^{\\perp}$, where $A$ is the triangle area and $\\mathbf{v}^{\\perp}$ is the vector $\\mathbf{v}$ rotated by $+90^\\circ$.\nThe dot product of the gradients is:\n$$\\nabla N_i \\cdot \\nabla N_j = \\frac{1}{4A^2} \\left( (\\mathbf{x}_k - \\mathbf{x}_j) \\cdot (\\mathbf{x}_i - \\mathbf{x}_k) \\right)$$\nThe vector dot product $(\\mathbf{x}_k - \\mathbf{x}_j) \\cdot (\\mathbf{x}_i - \\mathbf{x}_k)$ can be expressed as $-l_{jk} l_{ik} \\cos(\\gamma_k)$, where $l_{jk}$ and $l_{ik}$ are the lengths of the edges connecting to vertex $k$. The area of the triangle is $A = \\frac{1}{2} l_{jk} l_{ik} \\sin(\\gamma_k)$.\nSubstituting these into the expression for $a_{ij}^{(e)}$:\n$$a_{ij}^{(e)} = (\\nabla N_i \\cdot \\nabla N_j) A = \\frac{-l_{jk} l_{ik} \\cos(\\gamma_k)}{4A^2} A = \\frac{-l_{jk} l_{ik} \\cos(\\gamma_k)}{4A}$$\n$$a_{ij}^{(e)} = \\frac{-l_{jk} l_{ik} \\cos(\\gamma_k)}{4 \\left( \\frac{1}{2} l_{jk} l_{ik} \\sin(\\gamma_k) \\right)} = -\\frac{1}{2} \\frac{\\cos(\\gamma_k)}{\\sin(\\gamma_k)} = -\\frac{1}{2}\\cot(\\gamma_k)$$\n\nFor the first triangle, $\\Omega_1$, the angle opposite the edge $(i,j)$ is given as $\\alpha$. Thus, its contribution to the global stiffness entry is:\n$$a_{ij}^{(1)} = -\\frac{1}{2}\\cot(\\alpha)$$\nFor the second triangle, $\\Omega_2$, the angle opposite the edge $(i,j)$ is given as $\\beta$. Its contribution is:\n$$a_{ij}^{(2)} = -\\frac{1}{2}\\cot(\\beta)$$\nThe total global off-diagonal stiffness entry $a_{ij}$ is the sum of these two contributions:\n$$a_{ij} = a_{ij}^{(1)} + a_{ij}^{(2)} = -\\frac{1}{2}\\cot(\\alpha) - \\frac{1}{2}\\cot(\\beta) = -\\frac{1}{2}(\\cot(\\alpha) + \\cot(\\beta))$$\nThis is the general expression for the off-diagonal entry associated with an interior edge.\n\nNow, we must compute the numerical value for the specific case where $\\alpha = 120^\\circ$ and $\\beta = 80^\\circ$. The angles must be handled by the cotangent function, which typically operates in radians, but the values for standard degree measures are well-defined.\n$$a_{ij} = -\\frac{1}{2}(\\cot(120^\\circ) + \\cot(80^\\circ))$$\nWe evaluate the trigonometric functions:\n$\\cot(120^\\circ) = \\cot(180^\\circ - 60^\\circ) = -\\cot(60^\\circ) = -\\frac{1}{\\sqrt{3}} \\approx -0.57735027$\n$\\cot(80^\\circ) \\approx 0.17632698$\n\nSubstituting these values into the expression for $a_{ij}$:\n$$a_{ij} = -\\frac{1}{2}(-0.57735027 + 0.17632698)$$\n$$a_{ij} = -\\frac{1}{2}(-0.40102329)$$\n$$a_{ij} \\approx 0.200511645$$\n\nRounding the result to five significant figures gives:\n$$a_{ij} \\approx 0.20051$$\n\nFor the discrete operator to satisfy a Discrete Maximum Principle (DMP), the resulting system matrix is often required to be an M-matrix. A key property of an M-matrix (or more fundamentally, a Z-matrix) is that all its off-diagonal entries must be non-positive, i.e., $a_{ij} \\le 0$ for all $i \\neq j$.\nIn our case, the computed value is $a_{ij} \\approx 0.20051$, which is a positive number. This violates the non-positivity requirement for off-diagonal entries. This specific configuration, which involves an obtuse angle ($\\alpha = 120^\\circ > 90^\\circ$), provides a counterexample where the standard Galerkin FEM discretization does not produce an M-matrix, and therefore the DMP is not guaranteed. The condition for non-positivity, from our derived formula, is $\\cot(\\alpha) + \\cot(\\beta) \\ge 0$. This is guaranteed if $\\alpha + \\beta \\le 180^\\circ$ (the Delaunay condition), but it is violated here since $120^\\circ + 80^\\circ = 200^\\circ > 180^\\circ$.",
            "answer": "$$\\boxed{0.20051}$$"
        },
        {
            "introduction": "After discretizing a PDE, we are left with a large system of linear equations that must be solved efficiently. This final practice investigates the performance of iterative solvers, which are the workhorses of modern CFD. Using Local Fourier Analysis (LFA), you will analyze the error-smoothing properties of the weighted Jacobi method, a foundational iterative scheme. The goal is to determine the optimal relaxation parameter $\\omega$ that most effectively damps high-frequency error components, a critical concept for designing powerful multigrid solvers .",
            "id": "3971025",
            "problem": "Consider a model elliptic subproblem that arises in Aerospace Computational Fluid Dynamics (CFD) when solving for an irrotational, incompressible potential flow, where the scalar potential $u$ satisfies the Laplace equation $\\Delta u = 0$ in a square domain. Discretize the negative Laplacian $-\\Delta$ on a uniform two-dimensional Cartesian grid with spacing $h$ using the standard five-point finite difference stencil to obtain a linear system $A u = f$. Let the diagonal of $A$ be denoted by $D$, and consider the weighted Jacobi relaxation defined by\n$$\nu^{(k+1)} \\;=\\; u^{(k)} \\;+\\; \\omega D^{-1} \\bigl(f - A u^{(k)}\\bigr),\n$$\nwhere $\\omega \\in (0,2)$ is the relaxation parameter and $k$ is the iteration count.\n\nTo study the smoothing property relevant to multigrid methods, perform a Local Fourier Analysis (LFA) on the error-propagation operator for periodic boundary conditions. Assume the error $e^{(k)}$ can be decomposed into discrete Fourier modes $e_{i,j}^{(k)} = \\exp\\!\\bigl(i(\\theta_1 i + \\theta_2 j)\\bigr)$, with wave numbers $(\\theta_1,\\theta_2) \\in [-\\pi,\\pi]^{2}$. Define the high-frequency set $\\mathcal{H}$ as those modes that are oscillatory in both directions relative to a coarsening by a factor of $2$, namely\n$$\n\\mathcal{H} \\;=\\; \\Bigl\\{(\\theta_1,\\theta_2) \\in [-\\pi,\\pi]^2 \\,:\\, |\\theta_1| \\in \\bigl[\\tfrac{\\pi}{2},\\pi\\bigr] \\text{ and } |\\theta_2| \\in \\bigl[\\tfrac{\\pi}{2},\\pi\\bigr]\\Bigr\\}.\n$$\nStarting from the finite-difference definition of $A$ and the weighted Jacobi iteration, derive the Fourier symbol of the error-propagation operator and show how its magnitude over $\\mathcal{H}$ depends on $\\omega$. Then, determine the value of the relaxation parameter $\\omega$ that minimizes the spectral radius of the error-propagation operator restricted to $\\mathcal{H}$, that is, the worst-case damping factor over the high-frequency modes. Give the final value of $\\omega$ as an exact number. Do not round.",
            "solution": "The problem requires finding the optimal relaxation parameter $\\omega$ for a weighted Jacobi iteration that minimizes the damping of high-frequency error modes. This analysis will be performed using Local Fourier Analysis (LFA).\n\nFirst, we establish the operator $A$ by discretizing the negative Laplacian, $-\\Delta$, on a uniform Cartesian grid with spacing $h$. The standard five-point finite difference stencil at a grid point $(i,j)$ is:\n$$\n(-\\Delta u)_{i,j} \\approx -\\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h^2} - \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h^2}\n$$\nThe action of the discrete operator $A$ on a grid function $u$ is therefore:\n$$\n(A u)_{i,j} = \\frac{1}{h^2} \\bigl(4 u_{i,j} - u_{i+1,j} - u_{i-1,j} - u_{i,j+1} - u_{i,j-1}\\bigr)\n$$\nThe weighted Jacobi iteration is given by $u^{(k+1)} = u^{(k)} + \\omega D^{-1} (f - A u^{(k)})$. The exact solution $u^*$ satisfies $A u^* = f$. Let the error at iteration $k$ be $e^{(k)} = u^{(k)} - u^*$. Subtracting $u^*$ from the iteration formula, we obtain the error propagation equation:\n$$\nu^{(k+1)} - u^* = u^{(k)} - u^* + \\omega D^{-1} (A u^* - A u^{(k)})\n$$\n$$\ne^{(k+1)} = e^{(k)} - \\omega D^{-1} A (u^{(k)} - u^*) = e^{(k)} - \\omega D^{-1} A e^{(k)}\n$$\n$$\ne^{(k+1)} = (I - \\omega D^{-1} A) e^{(k)}\n$$\nThe error propagation operator is $S = I - \\omega D^{-1} A$.\n\nIn LFA, we analyze the action of this operator on a single discrete Fourier mode, $e_{i,j} = \\exp(i(\\theta_1 i + \\theta_2 j))$, where $i$ is the imaginary unit and $(\\theta_1, \\theta_2) \\in [-\\pi, \\pi]^2$ are the wave numbers. The effect of a linear, shift-invariant operator on such a mode is to multiply it by a scalar, known as the Fourier symbol or amplification factor.\nFirst, we find the symbol of $A$, denoted $\\hat{A}(\\theta_1, \\theta_2)$. Applying $A$ to the Fourier mode:\n$$\n(A e)_{i,j} = \\frac{1}{h^2} \\bigl(4 e_{i,j} - e^{i\\theta_1}e_{i,j} - e^{-i\\theta_1}e_{i,j} - e^{i\\theta_2}e_{i,j} - e^{-i\\theta_2}e_{i,j}\\bigr)\n$$\n$$\n(A e)_{i,j} = \\frac{1}{h^2} \\bigl(4 - (e^{i\\theta_1} + e^{-i\\theta_1}) - (e^{i\\theta_2} + e^{-i\\theta_2})\\bigr) e_{i,j} = \\frac{1}{h^2} (4 - 2\\cos(\\theta_1) - 2\\cos(\\theta_2)) e_{i,j}\n$$\nUsing the identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, the symbol of $A$ is:\n$$\n\\hat{A}(\\theta_1, \\theta_2) = \\frac{2}{h^2} \\bigl((1-\\cos(\\theta_1)) + (1-\\cos(\\theta_2))\\bigr) = \\frac{4}{h^2} \\left(\\sin^2\\left(\\frac{\\theta_1}{2}\\right) + \\sin^2\\left(\\frac{\\theta_2}{2}\\right)\\right)\n$$\nThe operator $D$ is the diagonal of $A$. From the stencil, the coefficient of $u_{i,j}$ is $4/h^2$. Hence, $D$ is a scalar multiplication operator, $(D u)_{i,j} = \\frac{4}{h^2} u_{i,j}$. Its symbol is a constant, $\\hat{D} = 4/h^2$, and the symbol of its inverse is $\\hat{D}^{-1} = h^2/4$.\n\nThe symbol of the error propagation operator $S$, denoted $\\hat{S}(\\theta_1, \\theta_2)$, is the amplification factor for the mode $(\\theta_1, \\theta_2)$:\n$$\n\\hat{S}(\\theta_1, \\theta_2) = 1 - \\omega \\hat{D}^{-1} \\hat{A}(\\theta_1, \\theta_2) = 1 - \\omega \\frac{h^2}{4} \\cdot \\frac{4}{h^2} \\left(\\sin^2\\left(\\frac{\\theta_1}{2}\\right) + \\sin^2\\left(\\frac{\\theta_2}{2}\\right)\\right)\n$$\n$$\n\\hat{S}(\\theta_1, \\theta_2) = 1 - \\omega \\left(\\sin^2\\left(\\frac{\\theta_1}{2}\\right) + \\sin^2\\left(\\frac{\\theta_2}{2}\\right)\\right)\n$$\nWe need to minimize the worst-case amplification factor (smoothing factor) over the specified high-frequency set $\\mathcal{H}$. This quantity is the spectral radius of $S$ restricted to $\\mathcal{H}$:\n$$\n\\mu(\\omega) = \\max_{(\\theta_1, \\theta_2) \\in \\mathcal{H}} |\\hat{S}(\\theta_1, \\theta_2)|\n$$\nThe set of high frequencies is given as $\\mathcal{H} = \\{(\\theta_1, \\theta_2) \\in [-\\pi, \\pi]^2 : |\\theta_1| \\in [\\frac{\\pi}{2}, \\pi] \\text{ and } |\\theta_2| \\in [\\frac{\\pi}{2}, \\pi]\\}$.\nLet $C(\\theta_1, \\theta_2) = \\sin^2(\\frac{\\theta_1}{2}) + \\sin^2(\\frac{\\theta_2}{2})$. We need to find the range of $C(\\theta_1, \\theta_2)$ for $(\\theta_1, \\theta_2) \\in \\mathcal{H}$.\nIf $|\\theta_1| \\in [\\frac{\\pi}{2}, \\pi]$, then $|\\frac{\\theta_1}{2}| \\in [\\frac{\\pi}{4}, \\frac{\\pi}{2}]$. In this interval, $\\sin^2(|\\frac{\\theta_1}{2}|)$ is monotonically increasing. Its minimum value is $\\sin^2(\\frac{\\pi}{4}) = (\\frac{1}{\\sqrt{2}})^2 = \\frac{1}{2}$, and its maximum is $\\sin^2(\\frac{\\pi}{2}) = 1^2 = 1$. The same holds for the $\\theta_2$ term.\nThus, for $(\\theta_1, \\theta_2) \\in \\mathcal{H}$, the term $\\sin^2(\\frac{\\theta_1}{2})$ ranges in $[\\frac{1}{2}, 1]$, and so does $\\sin^2(\\frac{\\theta_2}{2})$.\nThe sum $C(\\theta_1, \\theta_2)$ therefore ranges over the interval:\n$$\nC_{\\min} = \\frac{1}{2} + \\frac{1}{2} = 1\n$$\n$$\nC_{\\max} = 1 + 1 = 2\n$$\nSo, $C(\\theta_1, \\theta_2) \\in [1, 2]$ for all modes in $\\mathcal{H}$.\nWe want to find $\\omega \\in (0, 2)$ that minimizes:\n$$\n\\mu(\\omega) = \\max_{C \\in [1, 2]} |1 - \\omega C|\n$$\nThe function $g(C) = 1 - \\omega C$ is linear in $C$. For a fixed $\\omega > 0$, the maximum of $|g(C)|$ on the interval $[1, 2]$ must occur at the endpoints, $C=1$ or $C=2$.\nTherefore, we need to minimize:\n$$\n\\mu(\\omega) = \\max\\bigl(|1 - \\omega \\cdot 1|, |1 - \\omega \\cdot 2|\\bigr) = \\max\\bigl(|1 - \\omega|, |1 - 2\\omega|\\bigr)\n$$\nThis is a classic minimax problem. The minimum of the maximum of two functions is typically found where the functions are equal. We set the magnitudes equal to find the optimal $\\omega$:\n$$\n|1 - \\omega| = |1 - 2\\omega|\n$$\nThis equation has two solutions:\n1. $1 - \\omega = 1 - 2\\omega \\implies \\omega = 0$. This is outside the specified interval $\\omega \\in (0, 2)$ and corresponds to no relaxation.\n2. $1 - \\omega = -(1 - 2\\omega) = 2\\omega - 1$. This yields $2 = 3\\omega$, so $\\omega = \\frac{2}{3}$.\n\nThis value $\\omega = \\frac{2}{3}$ is within the interval $(0, 2)$. To confirm this is the minimum, we can analyze $\\mu(\\omega)$. For $\\omega < \\frac{2}{3}$, $\\mu(\\omega)$ is a decreasing function of $\\omega$, while for $\\omega > \\frac{2}{3}$, it is an increasing function. Thus, the minimum is indeed achieved at $\\omega = \\frac{2}{3}$.\nAt this optimal value, the smoothing factor is $\\mu(\\frac{2}{3}) = |1 - \\frac{2}{3}| = |1 - 2\\cdot\\frac{2}{3}| = \\frac{1}{3}$.\n\nThe value of the relaxation parameter $\\omega$ that minimizes the spectral radius of the error-propagation operator restricted to $\\mathcal{H}$ is $\\frac{2}{3}$.",
            "answer": "$$\n\\boxed{\\frac{2}{3}}\n$$"
        }
    ]
}