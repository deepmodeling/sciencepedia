## 引言
在[计算流体动力学](@entry_id:142614)（CFD）的宏伟蓝图中，流体运动的控制方程是设计和分析的核心。这些方程可以被表述为两种基本形式：守恒形式与[非守恒形式](@entry_id:1128837)。虽然在理论上它们描述的是同一套物理定律，但这种数学表达上的差异，尤其是在面对航空航天领域常见的激波、[接触间断](@entry_id:194702)等不连续现象时，会引发截然不同的数值行为和物理结果。许多初学者和从业者常常困惑于何时以及为何必须采用守恒形式，以及这种选择背后深刻的物理和数学原理。本文旨在系统性地填补这一知识鸿沟，为读者构建一个关于控制方程形式的坚实理论框架。

在接下来的内容中，我们将分三步深入探索这一主题。首先，在“原理与机制”一章中，我们将从第一性原理出发，剖析守恒与[非守恒形式](@entry_id:1128837)的数学定义，阐明它们在光滑流场中的等价性，并通过[弱解](@entry_id:161732)和[Rankine-Hugoniot条件](@entry_id:181986)揭示它们在间断处的根本区别。接着，在“应用与跨学科联系”一章中，我们将视野扩展到真实世界的复杂流动，展示[守恒形式](@entry_id:1122899)如何成为模拟[湍流](@entry_id:151300)、化学[反应流](@entry_id:190741)乃至[磁流体动力学](@entry_id:264274)的基石，并探讨非守恒现象在物理模型中的角色。最后，通过“动手实践”部分，你将有机会通过具体的编程练习，亲身体验和验证这些理论概念在数值计算中的重要性。

让我们首先进入第一章，深入探讨这两种方程形式的内在原理与核心机制。

## 原理与机制

在[计算流体动力学](@entry_id:142614)（CFD）中，流体运动的控制方程可以以多种数学形式表述。其中最重要和最根本的区别在于**[守恒形式](@entry_id:1122899)（conservation form）**与**[非守恒形式](@entry_id:1128837)（nonconservation form）**。这两种形式在处理光滑、连续的流场时是等价的，但在航空航天领域常见的激波等间断现象存在时，它们的行为则截然不同。理解这两种形式的差异、它们的物理基础以及对数值解法的影响，对于开发和应用能够精确模拟[复杂流动](@entry_id:747569)的CFD工具至关重要。本章将深入探讨这些原理与机制。

### 守恒形式与[非守恒形式](@entry_id:1128837)：基本定义

[流体动力](@entry_id:750449)学的基本定律——质量、动量和能量守恒——本质上是积分形式的平衡律。它们描述了一个固定的控制体积内物理量的变化率等于通过其边界的通量。这些积分定律是推导[微分](@entry_id:158422)方程的基础。

**[守恒形式](@entry_id:1122899)**的[偏微分](@entry_id:194612)方程是这些积分平衡律最直接的局部化表达。对于一个由状态向量 $U$ 描述的系统，其守恒形式的控制方程通常写作：
$$
\frac{\partial U}{\partial t} + \nabla \cdot F(U) = S(U)
$$
在这里，$U$ 是单位体积内的**[守恒量](@entry_id:161475)**向量（例如质量密度、[动量密度](@entry_id:271360)、能量密度），$F(U)$ 是这些[守恒量](@entry_id:161475)通过单位面积的**通量（flux）**张量，$S(U)$ 是**源项（source term）**，代表单位体积内[守恒量](@entry_id:161475)的生成或耗散。方程的核心特征是，除了源项外，[状态向量](@entry_id:154607)的时间变化完全由其通量的散度决定。

以三维无粘可压缩理想气体的**[欧拉方程](@entry_id:177914)（Euler equations）**为例，这是一个典型的守恒律系统。其[状态向量](@entry_id:154607) $U$ 和笛卡尔坐标下的通量向量 $F_i$ ($i=1,2,3$) 定义如下 ：
$$
U = \begin{pmatrix} \rho \\ \rho \mathbf{u} \\ \rho E \end{pmatrix}, \quad F_i = \begin{pmatrix} \rho u_i \\ \rho \mathbf{u} u_i + p \mathbf{e}_i \\ (\rho E + p) u_i \end{pmatrix}
$$
其中，$\rho$ 是密度，$\mathbf{u}=(u_1, u_2, u_3)$ 是速度向量，$p$ 是压力，$E = e + \frac{1}{2}|\mathbf{u}|^2$ 是单位质量的总能量（$e$ 为内能），$\mathbf{e}_i$ 是第 $i$ 个坐标方向的[单位向量](@entry_id:165907)。状态向量 $U$ 的分量分别是单位体积的质量、动量和总能量。通量向量 $F_i$ 的分量则描述了这些[守恒量](@entry_id:161475)在 $i$ 方向上的[对流输运](@entry_id:149512)，以及由压力产生的[动量通量](@entry_id:199796)（压力本身）和能量通量（压力做功）。

与此相对，**[非守恒形式](@entry_id:1128837)**的方程将空间导数项展开，使其不再表现为一个通量的散度。它通常被写成一种准[线性形式](@entry_id:276136)：
$$
\frac{\partial U}{\partial t} + A(U) \nabla U = S(U)
$$
其中 $A(U)$ 是一个依赖于状态 $U$ 的矩阵。这种形式直接描述了物理量（通常是**[原始变量](@entry_id:753733)（primitive variables）**，如密度 $\rho$、速度 $\mathbf{u}$ 和压力 $p$）随流体质点运动时的变化。

再次以[欧拉方程](@entry_id:177914)为例，通过一系列数学变换，可以将其从[守恒形式](@entry_id:1122899)转化为以[原始变量](@entry_id:753733) $(\rho, \mathbf{u}, p)$ 表示的[非守恒形式](@entry_id:1128837) ：
$$
\begin{align*}
\frac{\partial \rho}{\partial t} + \mathbf{u} \cdot \nabla \rho + \rho \nabla \cdot \mathbf{u} = 0 \\
\frac{\partial \mathbf{u}}{\partial t} + (\mathbf{u} \cdot \nabla)\mathbf{u} + \frac{1}{\rho} \nabla p = \mathbf{0} \\
\frac{\partial p}{\partial t} + \mathbf{u} \cdot \nabla p + \gamma p \nabla \cdot \mathbf{u} = 0
\end{align*}
$$
这里，$\gamma$ 是比热比。这些方程明确地展示了对流输运项（如 $\mathbf{u} \cdot \nabla \rho$）和局部变化源（如压力梯度项 $\nabla p$ 和膨胀/压缩项 $\nabla \cdot \mathbf{u}$）。左侧两项组合起来可以写成物质导数 $\frac{D}{Dt} = \frac{\partial}{\partial t} + \mathbf{u} \cdot \nabla$，描述了跟随流体[质点](@entry_id:186768)运动时物理量的变化率。

### 两种形式的关系：光滑解的等价性与间断处的失效

从表面上看，这两种形式只是同一组物理定律的不同数学表达。对于光滑、连续可微的解，它们确实是等价的。

#### 光滑解的等价性

如果解向量 $U$ 是连续可微的，我们可以对守恒形式中的[通量散度](@entry_id:1125154)项 $\nabla \cdot F(U)$ 应用[链式法则](@entry_id:190743)：
$$
\nabla \cdot F(U) = \left( \frac{\partial F}{\partial U} \right) \nabla U
$$
其中 $\frac{\partial F}{\partial U}$ 是通量 $F$ 相对于[守恒量](@entry_id:161475) $U$ 的[雅可比矩阵](@entry_id:178326)。如果我们定义[非守恒形式](@entry_id:1128837)中的矩阵 $A(U)$ 正是这个[雅可比矩阵](@entry_id:178326)，即 $A(U) = \frac{\partial F}{\partial U}$，那么两种形式在每一点上都是完[全等](@entry_id:273198)价的 。这种等价性意味着，在没有激波或其他间断的流场区域，无论我们求解哪种形式的方程，得到的解都将描述相同的物理过程。

#### 间断处的失效：[弱解](@entry_id:161732)与[Rankine-Hugoniot条件](@entry_id:181986)

然而，在航空航天应用中，流场往往包含激波、[接触间断](@entry_id:194702)等不连续现象。在这些间断面上，解的导数是未定义的，因此上述基于[链式法则](@entry_id:190743)的等价性不再成立。这正是两种形式的根本区别所在，也是守恒形式为何如此重要的原因。

为了处理间断解，我们需要引入**[弱解](@entry_id:161732)（weak solution）**的概念。[弱解](@entry_id:161732)不再要求方程在每一点都成立，而是要求其在一个积分意义下成立。这是通过将原方程与一个任意的光滑“[测试函数](@entry_id:166589)” $\varphi$ 相乘，并在整个时空域上积分得到的。通过分部积分，可以将[微分算子](@entry_id:140145)从可能不连续的解 $u$ 转移到光滑的[测试函数](@entry_id:166589) $\varphi$ 上，从而避免处理未定义的导数 。
$$
\int_{0}^{\infty} \int_{\mathbb{R}} \left( u \frac{\partial \varphi}{\partial t} + f(u) \frac{\partial \varphi}{\partial x} \right) dx dt + \int_{\mathbb{R}} u(x,0) \varphi(x,0) dx = 0
$$
这个积分方程对所有满足条件的[测试函数](@entry_id:166589) $\varphi$ 都必须成立。

当我们将这个[弱解](@entry_id:161732)的定义应用于[守恒形式](@entry_id:1122899)的方程时，可以推导出一个跨越间断的普适关系，即**[Rankine-Hugoniot跳跃条件](@entry_id:139267)（Rankine-Hugoniot jump condition）**。这个条件直接源于[积分守恒律](@entry_id:202878)，它要求在穿过间断时，通量的跳跃量必须与[守恒量](@entry_id:161475)的跳跃量[相平衡](@entry_id:136822)。对于一个以速度 $s$ 移动的一维间断，该条件为 ：
$$
s [U] = [F(U)]
$$
其中 $[G] = G_R - G_L$ 表示量 $G$ 跨越间断从左侧（L）到右侧（R）的跳跃。这个关系式是代数的，它唯一地确定了给定左右两边状态 $U_L$ 和 $U_R$ 下间断的[传播速度](@entry_id:189384) $s$。

相比之下，[非守恒形式](@entry_id:1128837) $\partial_t u + A(u) \partial_x u = 0$ 在间断处遇到了根本性的困难。项 $A(u) \partial_x u$ 涉及到[不连续函数](@entry_id:143848) $A(u)$ 与一个奇异（类狄拉克 $\delta$ 函数）导数 $\partial_x u$ 的乘积，这个乘积在[分布理论](@entry_id:186499)中没有唯一定义。尝试从中推导跳跃条件会导致结果依赖于在[状态空间](@entry_id:160914)中连接 $U_L$ 和 $U_R$ 的具体路径 。这意味着[非守恒形式](@entry_id:1128837)无法给出唯一的、物理上正确的激[波速](@entry_id:186208)度，其[弱解](@entry_id:161732)是病态的 。

#### 一个决定性的反例：伯格斯方程

一维无粘**[伯格斯方程](@entry_id:1121935)（Burgers' equation）**提供了一个清晰的例子，无可辩驳地展示了两种形式在间断解上的差异 。

[守恒形式](@entry_id:1122899)为：
$$
\frac{\partial u}{\partial t} + \frac{\partial}{\partial x} \left( \frac{1}{2}u^2 \right) = 0
$$
这里，$U=u$，$F(u) = \frac{1}{2}u^2$。应用[Rankine-Hugoniot条件](@entry_id:181986)，我们得到激[波速](@entry_id:186208)度 $s_{\text{cons}}$：
$$
s_{\text{cons}} = \frac{[F(u)]}{[u]} = \frac{\frac{1}{2}u_R^2 - \frac{1}{2}u_L^2}{u_R - u_L} = \frac{1}{2}(u_L + u_R)
$$
激[波速](@entry_id:186208)度是左右状态的[算术平均值](@entry_id:165355)。

[非守恒形式](@entry_id:1128837)（或称平流形式）为：
$$
\frac{\partial u}{\partial t} + u \frac{\partial u}{\partial x} = 0
$$
对于光滑解，这与[守恒形式](@entry_id:1122899)等价。但对于间断解，如前所述，$u \frac{\partial u}{\partial x}$ 的定义是模糊的。如果我们采用某种特定的规则，例如，在间断处使用右侧的状态值 $u_R$ 来定义这个乘积，推导出的激[波速](@entry_id:186208)度将是 $s_{\text{adv}} = u_R$。

考虑一个初始条件为 $u_L=2$ 和 $u_R=-1$ 的激波问题。根据[守恒形式](@entry_id:1122899)，激波速度为 $s_{\text{cons}} = \frac{1}{2}(2 + (-1)) = 0.5$。而根据我们假设的[非守恒形式](@entry_id:1128837)规则，激[波速](@entry_id:186208)度为 $s_{\text{adv}} = -1$。在时间 $t=2$ 时，由[守恒形式](@entry_id:1122899)预测的激波位置在 $x=1$，而[非守恒形式](@entry_id:1128837)预测的位置在 $x=-2$。两者相差甚远！这个例子鲜明地说明，只有[守恒形式](@entry_id:1122899)才能给出唯一的、物理上正确的激波传播行为。

### 物理内涵的深化：何为“守恒”？

“守恒”一词具有深刻的物理意义。一个物理量是守恒的，意味着在一个孤立系统内其总量保持不变。对于一个开放的控制体积，该量的总变化率必须精确等于通过其边界的净通量。

总能量是一个[守恒量](@entry_id:161475)。然而，总能量的组成部分——内能和动能——自身并非[守恒量](@entry_id:161475)。它们可以在流场内部相互转化。我们可以通过从总[能量守恒方程](@entry_id:748978)中减去动能方程来推导内能的演化方程 。动能方程本身可以通过将动量方程与速度向量做点积得到。经过一番推导，我们得到的内能方程（以 $\rho e$ 为变量）形式如下：
$$
\frac{\partial (\rho e)}{\partial t} + \nabla \cdot (\rho e \mathbf{u}) = -p \nabla \cdot \mathbf{u} + \dots
$$
右侧的 $-p \nabla \cdot \mathbf{u}$ 项代表了压[力场](@entry_id:147325)对流体微元做功（或流体微元对外做功）的功率密度。当流体被压缩（$\nabla \cdot \mathbf{u} \lt 0$）时，压力做正功，内能增加；当流体膨胀（$\nabla \cdot \mathbf{u} \gt 0$）时，内能转化为对外做功，内能减少。这个项是一个**源项**，它不能被写成某个通量的[散度形式](@entry_id:748608)。正是这个源项的存在，意味着内能 $\rho e$ 本身并不满足一个纯粹的守恒定律。它与动能之间存在着能量交换。只有将内能和动能加在一起形成总能量 $\rho E$，这个内部能量交换项才会相互抵消，使得[总能量方程](@entry_id:1133263)能够写成一个纯粹的[守恒形式](@entry_id:1122899)。

### 数值方法的核心：[离散守恒](@entry_id:1123819)性

控制方程的守恒性质对数值解法具有决定性的影响，特别是在**[有限体积法](@entry_id:141374)（Finite Volume Method, FVM）**中。[有限体积法](@entry_id:141374)是求解守恒律方程最自然、最流行的方法之一。

FVM 的核心思想是直接对积分形式的守恒律进行离散。整个计算域被划分为一系列不重叠的控制体积（或称网格单元）。在一个单元 $K_i$ 内，守恒律的离散形式为：
$$
V_i \frac{d U_i}{d t} + \sum_{j \in N(i)} H_{ij} = V_i S_i
$$
其中，$U_i$ 是单元 $i$ 内[守恒量](@entry_id:161475)的平均值，$V_i$ 是单元体积，$S_i$ 是单元内的平均源项。关键在于 $H_{ij}$，它代表了通过单元 $i$ 和相邻单元 $j$ 之间共享界面 $f_{ij}$ 的**数值通量（numerical flux）**。

一个有限体积格式的**[离散守恒](@entry_id:1123819)性（discrete conservation）**，体现在其数值通量的构造上。为了保证守恒，数值通量必须满足以下条件 ：
$$
H_{ij} = -H_{ji}
$$
这个条件意味着，从单元 $i$ 流出到单元 $j$ 的量，必须精确地等于从单元 $j$ 视角看的、流入自身的量。换句话说，在内部界面上没有物理量的凭空产生或消失。当我们将多个相邻单元的离散方程相加时，所有内部界面的通量项都会成对抵消，最终得到的总变化量仅取决于这个单元块最外围边界上的通量。这正是对宏观[积分守恒律](@entry_id:202878)的[完美模拟](@entry_id:753337)。

这一特性至关重要。根据 **Lax-Wendroff 定理**，如果一个守恒的数值格式收敛，那么它的极限解一定是原[偏微分](@entry_id:194612)方程的一个[弱解](@entry_id:161732) 。这意味着，一个设计良好的[守恒格式](@entry_id:747714)，在[网格加密](@entry_id:168565)的极限下，能够自动地捕捉到具有正确[传播速度](@entry_id:189384)和强度的激波。这解释了为何在需要进行激波捕捉的空气动力学计算中，[守恒格式](@entry_id:747714)（特别是[有限体积法](@entry_id:141374)）占据了主导地位。

此外，[守恒格式](@entry_id:747714)在处理复杂几何时也表现出优越性。例如，在[曲线坐标系](@entry_id:172561)下，非守恒的差分格式可能由于对[网格度量](@entry_id:751908)项的离散不一致而无法精确保持[均匀流](@entry_id:272775)（即“自由来流保持”问题），而满足**[几何守恒律](@entry_id:170384)（Geometric Conservation Law, GCL）**的有限体积格式则能避免此问题 。即使在存在[悬挂节点](@entry_id:149024)的[非协调网格](@entry_id:752550)上，通过精心处理界面通量，[离散守恒](@entry_id:1123819)性依然可以被严格保证 。

### 超越基本守恒：[熵条件](@entry_id:166346)与[解的唯一性](@entry_id:143619)

仅仅满足[Rankine-Hugoniot跳跃条件](@entry_id:139267)，还不足以保证我们得到物理上唯一正确的解。[弱解](@entry_id:161732)的框架可能允许出现违反[热力学](@entry_id:172368)第二定律的“非物理”解，例如在自然界中不会自行产生的膨胀激波。

为了从数学上排除这些非物理解，必须引入一个额外的判据，即**熵条件（entropy condition）** 。[熵条件](@entry_id:166346)是[热力学](@entry_id:172368)第二定律的数学体现，即在绝热过程中，熵永不减少。对于激波这样的不可逆过程，熵必须增加。

对于光滑解，熵也满足一个守恒律。但对于包含激波的[弱解](@entry_id:161732)，这个守恒律被放宽为一个不等式：
$$
\frac{\partial \eta(u)}{\partial t} + \frac{\partial q(u)}{\partial x} \le 0
$$
这里 $\eta(u)$ 是一个任意的凸函数，称为**熵函数**，$q(u)$ 是其对应的**熵通量**。对于[标量守恒律](@entry_id:754532)，为了确保[解的唯一性](@entry_id:143619)，这个[熵不等式](@entry_id:184404)必须对所有可能的凸熵函数都成立。

S. N. Kruzhkov 的工作为这一思想提供了严格的数学框架 。他证明，通过要求解对一族特定的熵函数 $\eta_k(u) = |u-k|$（其中 $k$ 是任意实常数）都满足[熵不等式](@entry_id:184404)，就可以保证弱[解的唯一性](@entry_id:143619)。这一族条件非常强大，它能导出一个**$L^1$收缩原理**，即任意两个熵解之间的 $L^1$ 距离随时间推移是单调不减的，这直接保证了给定初始条件的[解的唯一性](@entry_id:143619)。对于凸通量函数，这个复杂的Kruzhkov条件可以简化为更为直观的Lax激波可接受条件：激[波前](@entry_id:197956)后的[特征速度](@entry_id:165394)必须都指向激波，即 $f'(u_L) > s > f'(u_R)$。

在数值方法层面，诸如[单调格式](@entry_id:752159)等许多优秀的[激波捕捉格式](@entry_id:754789)，其内禀的[数值耗散](@entry_id:168584)机制恰好能保证其满足一个离散形式的熵条件。这使得它们在收敛时能够自动收敛到那个唯一的、物理上正确的熵解，这也是它们在CFD中如此可靠的深层原因 。

### 前沿课题：本征非[守恒系统](@entry_id:167760)的处理

尽管[守恒形式](@entry_id:1122899)在流[体力](@entry_id:174230)学中占据核心地位，但在某些领域，如多相流、非弹性力学等，物理模型本身可能无法写成一个完整的[守恒形式](@entry_id:1122899)。这些系统被称为**本征非[守恒系统](@entry_id:167760)（intrinsically nonconservative systems）**。

对于这类系统，我们必须直面非守恒乘积的模糊性问题。现代数学理论，如 Dal Maso-LeFloch-Murat (DLM) 理论，指出这[类方程](@entry_id:144428)的定义必须补充一个“路径族” $\Phi$ 的规定，该路径族明确了在[状态空间](@entry_id:160914)中如何穿过间断 。激波的跳跃条件将依赖于这条路径的积分，从而变得唯一。

那么，如何选择物理上正确的路径呢？一种重要的方法是**[粘性正则化](@entry_id:756533)（viscous regularization）**。许多非[守恒系统](@entry_id:167760)可以看作是包含粘性或扩散项的更完整模型的[零粘性](@entry_id:176712)极限。在粘性模型中，激波是一个光滑的过渡层（[行波解](@entry_id:272909)），这个过渡层的剖面在[状态空间](@entry_id:160914)中描绘出一条唯一的路径。取粘性系数趋于零的极限，所得到的路径就被认为是物理上合理的规范路径 。

为了数值求解这类系统，研究人员发展了**路径[守恒格式](@entry_id:747714)（path-conservative schemes）**。这类格式被特殊设计，使其在离散层面能够与预先选定的路径 $\Phi$ 保持一致，从而确保了数值解向着由该路径所定义的、唯一的[弱解](@entry_id:161732)收敛。这代表了CFD理论与[数值分析](@entry_id:142637)在处理更复杂物理模型方面的前沿进展。