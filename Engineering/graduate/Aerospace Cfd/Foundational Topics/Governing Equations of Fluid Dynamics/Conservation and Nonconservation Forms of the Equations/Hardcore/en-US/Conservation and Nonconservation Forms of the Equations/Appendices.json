{
    "hands_on_practices": [
        {
            "introduction": "Understanding the distinction between conservation and nonconservation forms begins with analyzing their most critical difference: the ability to correctly capture discontinuities. This exercise uses the inviscid Burgers' equation as a simplified model to demonstrate a fundamental principle. By deriving the shock speed from both the conservative (integral) form and a plausible nonconservative advective form, you will analytically prove why only the former guarantees the physically correct shock propagation speed dictated by the Rankine-Hugoniot conditions .",
            "id": "3949772",
            "problem": "Consider the one-dimensional inviscid Burgers equation, used as a scalar model for advective transport in the inviscid compressible Euler equations, given in conservation form by $u_{t} + \\partial_{x}\\left(\\frac{1}{2} u^{2}\\right) = 0$. In the context of Computational Fluid Dynamics (CFD), shocks arise for Riemann initial data $u(x,0) = u_{L}$ for $x < 0$ and $u(x,0) = u_{R}$ for $x > 0$ with $u_{L} > u_{R}$. \n\n1. Starting from the integral conservation law and the definition of weak solutions, derive the shock speed $s_{c}$ for the conservation-form Burgers equation by applying the jump condition that follows from the Rankine–Hugoniot analysis of $\\partial_{t}\\int_{x_{1}}^{x_{2}} u \\, dx + \\left[\\frac{1}{2}u^{2}\\right]_{x_{1}}^{x_{2}} = 0$ to a traveling discontinuity at $x_{s}(t)$.\n\n2. Now consider a semi-discrete finite-volume discretization of the nonconservative advective form $u_{t} + u \\, u_{x} = 0$ on a uniform grid with spacing $\\Delta x$, which approximates the nonconservative product at cell interfaces by the bilinear form\n$$\n\\frac{d u_{i}}{dt} + \\frac{1}{\\Delta x}\\left[\\widehat{a}_{i+\\frac{1}{2}}\\left(u_{i+1} - u_{i}\\right) - \\widehat{a}_{i-\\frac{1}{2}}\\left(u_{i} - u_{i-1}\\right)\\right] = 0, \n$$\nwhere the interfacial advective coefficient is prescribed by a biased linear average\n$$\n\\widehat{a}_{i+\\frac{1}{2}} = \\alpha \\, u_{i} + \\left(1 - \\alpha\\right) u_{i+1}, \\quad \\text{with } \\alpha \\in [0,1].\n$$\nApplying a jump-condition analysis consistent with the theory of nonconservative products for a single moving discontinuity located at a grid interface between constant states $u_{L}$ (left) and $u_{R}$ (right), derive the shock speed predicted by this nonconservative scheme, denoted $s_{nc}$, as a function of $\\alpha$, $u_{L}$, and $u_{R}$.\n\n3. Using your results from parts $1$ and $2$, provide the closed-form symbolic expression for the discrepancy between the nonconservative and conservative shock speeds, $s_{nc} - s_{c}$, as a function of $\\alpha$, $u_{L}$, and $u_{R}$. Express your final answer as a single analytic expression without numerical evaluation.",
            "solution": "The problem is divided into three parts. First, we derive the shock speed for the conservative form of the one-dimensional inviscid Burgers' equation. Second, we derive the shock speed for a specific nonconservative finite-volume discretization. Third, we compute the difference between these two speeds.\n\nPart 1: Derivation of the conservative shock speed, $s_{c}$.\nThe one-dimensional inviscid Burgers' equation in conservation form is given by\n$$ u_{t} + \\partial_{x}\\left( f(u) \\right) = 0, \\quad \\text{where } f(u) = \\frac{1}{2} u^{2} $$\nThe integral form of this conservation law over a fixed spatial domain $[x_1, x_2]$ is\n$$ \\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\, dx + f(u(x_2,t)) - f(u(x_1,t)) = 0 $$\nWe analyze a weak solution in the form of a single discontinuity (a shock) traveling at a constant speed $s_{c}$. The position of the shock is $x_s(t) = s_{c}t$. The solution is piecewise constant, given the Riemann initial data:\n$$ u(x,t) = \\begin{cases} u_{L} & \\text{if } x < x_s(t) \\\\ u_{R} & \\text{if } x > x_s(t) \\end{cases} $$\nLet our control volume $[x_1, x_2]$ be fixed such that the shock is initially inside it and remains inside for some time. We can evaluate the integral:\n$$ \\int_{x_{1}}^{x_{2}} u(x,t) \\, dx = \\int_{x_{1}}^{x_s(t)} u_{L} \\, dx + \\int_{x_s(t)}^{x_{2}} u_{R} \\, dx = u_{L}(x_s(t) - x_1) + u_{R}(x_2 - x_s(t)) $$\nNow, we differentiate this expression with respect to time $t$. The terms $u_L x_1$ and $u_R x_2$ are constant and their derivatives are zero.\n$$ \\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\, dx = u_{L} \\frac{dx_s}{dt} - u_{R} \\frac{dx_s}{dt} = (u_{L} - u_{R}) s_{c} $$\nThe flux term in the integral conservation law is $f(u(x_2,t)) - f(u(x_1,t))$. Since $x_1$ is to the left of the shock and $x_2$ is to the right, we have $u(x_1,t) = u_{L}$ and $u(x_2,t) = u_{R}$. The flux difference is therefore\n$$ f(u_R) - f(u_L) = \\frac{1}{2}u_{R}^{2} - \\frac{1}{2}u_{L}^{2} $$\nSubstituting these results back into the integral conservation law, we get\n$$ (u_{L} - u_{R}) s_{c} + \\left( \\frac{1}{2}u_{R}^{2} - \\frac{1}{2}u_{L}^{2} \\right) = 0 $$\nThis can be rearranged to the standard Rankine-Hugoniot jump condition $s_{c}[u] = [f(u)]$, where $[q] = q_R - q_L$.\n$$ s_{c}(u_{R} - u_{L}) = f(u_{R}) - f(u_L) = \\frac{1}{2}u_{R}^{2} - \\frac{1}{2}u_{L}^{2} $$\nSince a shock exists, $u_{L} \\neq u_{R}$, and we can divide by $(u_R - u_L)$.\n$$ s_{c} = \\frac{\\frac{1}{2}(u_{R}^{2} - u_{L}^{2})}{u_{R} - u_{L}} = \\frac{\\frac{1}{2}(u_{R} - u_{L})(u_{R} + u_L)}{u_{R} - u_{L}} $$\nThis yields the conservative shock speed:\n$$ s_{c} = \\frac{1}{2}(u_{L} + u_{R}) $$\n\nPart 2: Derivation of the nonconservative shock speed, $s_{nc}$.\nWe are given the nonconservative advective form of the equation, $u_{t} + u u_{x} = 0$, discretized as:\n$$ \\frac{d u_{i}}{dt} + \\frac{1}{\\Delta x}\\left[\\widehat{a}_{i+\\frac{1}{2}}\\left(u_{i+1} - u_{i}\\right) - \\widehat{a}_{i-\\frac{1}{2}}\\left(u_{i} - u_{i-1}\\right)\\right] = 0 $$\nwith the interfacial advective coefficient $\\widehat{a}_{i+\\frac{1}{2}} = \\alpha u_{i} + (1 - \\alpha) u_{i+1}$.\nThe product $u u_x$ is a nonconservative product. The weak solution, and specifically the speed of a discontinuity, depends on the path taken in state space between the left and right states. A numerical scheme for a nonconservative equation implicitly defines this path and, consequently, the shock speed. In this finite-volume-like scheme, the term $\\widehat{a}_{i+\\frac{1}{2}}$ represents the numerical advection speed at the interface between cell $i$ and cell $i+1$. The speed of a discontinuity propagating across this interface is determined by this numerically defined velocity.\nFor a single, sharp discontinuity located at the interface $i+\\frac{1}{2}$, a jump-condition analysis consistent with the theory of nonconservative products identifies the shock speed $s_{nc}$ with the interface velocity $\\widehat{a}_{i+\\frac{1}{2}}$. The states on the left and right of this interface are $u_i = u_L$ and $u_{i+1} = u_R$, respectively.\nTherefore, the shock speed predicted by this nonconservative scheme is:\n$$ s_{nc} = \\widehat{a}_{i+\\frac{1}{2}} \\rvert_{u_i=u_L, u_{i+1}=u_R} $$\nSubstituting the definition of $\\widehat{a}_{i+\\frac{1}{2}}$:\n$$ s_{nc} = \\alpha u_{L} + (1 - \\alpha) u_{R} $$\nThis result shows that the shock speed is a linear interpolation of the left and right states, with the weighting controlled by the parameter $\\alpha$.\n\nPart 3: Discrepancy between nonconservative and conservative shock speeds.\nWe now compute the difference $s_{nc} - s_{c}$ using the expressions derived in the previous parts.\n$$ s_{nc} - s_{c} = \\left[ \\alpha u_{L} + (1 - \\alpha) u_{R} \\right] - \\left[ \\frac{1}{2}(u_{L} + u_{R}) \\right] $$\nWe group the terms multiplying $u_L$ and $u_R$:\n$$ s_{nc} - s_{c} = \\left( \\alpha - \\frac{1}{2} \\right) u_{L} + \\left( 1 - \\alpha - \\frac{1}{2} \\right) u_{R} $$\n$$ s_{nc} - s_{c} = \\left( \\alpha - \\frac{1}{2} \\right) u_{L} + \\left( \\frac{1}{2} - \\alpha \\right) u_{R} $$\nFactoring out the common term $(\\alpha - \\frac{1}{2})$:\n$$ s_{nc} - s_{c} = \\left( \\alpha - \\frac{1}{2} \\right) u_{L} - \\left( \\alpha - \\frac{1}{2} \\right) u_{R} $$\nThis gives the final closed-form expression for the discrepancy:\n$$ s_{nc} - s_{c} = \\left(\\alpha - \\frac{1}{2}\\right)(u_{L} - u_{R}) $$\nThis result demonstrates that the nonconservative scheme yields the correct shock speed only if $\\alpha = \\frac{1}{2}$. For any other value of $\\alpha \\in [0,1]$, the scheme will produce a shock propagating at an incorrect speed, with the error being proportional to the strength of the shock, $(u_L - u_R)$, and the bias parameter $\\alpha$.",
            "answer": "$$ \\boxed{\\left(\\alpha - \\frac{1}{2}\\right)(u_{L} - u_{R})} $$"
        },
        {
            "introduction": "While the conservation form of the governing equations is essential, its numerical implementation on practical curvilinear meshes presents a new challenge: the Geometric Conservation Law (GCL). This exercise demonstrates how an inconsistent discretization of the coordinate transformation metric terms can introduce spurious source terms, causing the scheme to fail the fundamental test of preserving a uniform freestream flow. By diagnosing this failure, you will then construct a discretely conservative metric evaluation, a critical skill for developing robust CFD solvers on generalized grids .",
            "id": "3949765",
            "problem": "Consider the two-dimensional compressible Euler equations on a static curvilinear mesh defined by a smooth one-to-one mapping from computational coordinates $(\\xi,\\eta)$ to physical coordinates $(x(\\xi,\\eta), y(\\xi,\\eta))$. Let the conservative variables be $\\boldsymbol{Q} = [\\rho, \\rho u, \\rho v, \\rho E]^T$, where $\\rho$ is density, $u$ and $v$ are velocity components, and $E$ is specific total energy. The mass conservation equation in Cartesian coordinates is $\\partial \\rho/\\partial t + \\partial(\\rho u)/\\partial x + \\partial(\\rho v)/\\partial y = 0$. Define the Jacobian $J = x_{\\xi} y_{\\eta} - x_{\\eta} y_{\\xi}$, where subscripts denote partial derivatives.\n\nOn the curvilinear mesh, the conservative form of the continuity equation can be obtained by change of variables and written as $\\partial (J \\rho)/\\partial t + \\partial \\mathcal{F}^{\\xi}/\\partial \\xi + \\partial \\mathcal{F}^{\\eta}/\\partial \\eta = 0$, where the transformed fluxes are $\\mathcal{F}^{\\xi} = \\rho U^{\\xi}$ and $\\mathcal{F}^{\\eta} = \\rho U^{\\eta}$ with contravariant velocity components $U^{\\xi} = u \\, (J \\xi_{x}) + v \\, (J \\xi_{y})$ and $U^{\\eta} = u \\, (J \\eta_{x}) + v \\, (J \\eta_{y})$. Here $J \\xi_{x}$, $J \\xi_{y}$, $J \\eta_{x}$, and $J \\eta_{y}$ are the Jacobian-weighted contravariant metric components.\n\nAssume a uniform free stream with constant $(\\rho_{\\infty}, u_{\\infty}, v_{\\infty}, E_{\\infty})$ on a uniform grid, and discretize spatial derivatives using linear, constant-coefficient operators $D_{\\xi}$ and $D_{\\eta}$ acting on nodal values. Suppose the metrics are evaluated nonconservatively using potentially different operators $\\widehat{D}_{\\xi}$ and $\\widehat{D}_{\\eta}$ and a Jacobian $\\widehat{J}$, via the chain-rule-like nodal formulas $ \\xi_{x}^{\\mathrm{nc}} = (\\widehat{D}_{\\eta} y)/\\widehat{J}$, $\\xi_{y}^{\\mathrm{nc}} = -(\\widehat{D}_{\\eta} x)/\\widehat{J}$, $\\eta_{x}^{\\mathrm{nc}} = -(\\widehat{D}_{\\xi} y)/\\widehat{J}$, and $\\eta_{y}^{\\mathrm{nc}} = (\\widehat{D}_{\\xi} x)/\\widehat{J}$. The transformed flux divergence is then discretized as $D_{\\xi}(\\rho_{\\infty} U^{\\xi}_{\\mathrm{nc}}) + D_{\\eta}(\\rho_{\\infty} U^{\\eta}_{\\mathrm{nc}})$ with $U^{\\xi}_{\\mathrm{nc}} = u_{\\infty} \\, (J \\xi_{x}^{\\mathrm{nc}}) + v_{\\infty} \\, (J \\xi_{y}^{\\mathrm{nc}})$ and $U^{\\eta}_{\\mathrm{nc}} = u_{\\infty} \\, (J \\eta_{x}^{\\mathrm{nc}}) + v_{\\infty} \\, (J \\eta_{y}^{\\mathrm{nc}})$.\n\nStarting from the physical conservation law and the above discrete transformation, derive an expression for the discrete free-stream residual of the continuity equation under this nonconservative metric evaluation. Show explicitly how it depends on the discrete failure of the metric identities and on the mismatch between $D_{\\xi}, D_{\\eta}$ and $\\widehat{D}_{\\xi}, \\widehat{D}_{\\eta}$, and explain why this causes loss of free-stream preservation.\n\nThen, propose a strictly conservative metric evaluation for $J \\xi_{x}$, $J \\xi_{y}$, $J \\eta_{x}$, and $J \\eta_{y}$ in terms of the coordinate functions and the same discrete operators $D_{\\xi}$ and $D_{\\eta}$ used in the flux divergence, such that the discrete metric identities are satisfied and the uniform free stream is preserved. Express your proposed conservative Jacobian-weighted contravariant metrics as a single row matrix in the order $(J \\xi_{x}, J \\xi_{y}, J \\eta_{x}, J \\eta_{y})$. The final answer must be a single closed-form analytical expression. No units are required.",
            "solution": "This problem addresses the critical concept of free-stream preservation in the numerical solution of the compressible Euler equations on curvilinear grids. This property, which is a specific manifestation of the Geometric Conservation Law (GCL), requires that a numerical scheme be able to exactly preserve a uniform flow field, which is a trivial solution of the continuous governing equations. Failure to do so introduces spurious source terms that contaminate the entire numerical solution. The analysis hinges on the discrete analogs of the metric identities that arise from the transformation of coordinates.\n\nFirst, we will analyze the given nonconservative discretization to derive the free-stream residual. Then, based on this analysis, we will construct a conservative metric evaluation that guarantees the residual is identically zero.\n\nThe continuity equation in physical Cartesian coordinates $(x,y)$ is given by\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial(\\rho u)}{\\partial x} + \\frac{\\partial(\\rho v)}{\\partial y} = 0\n$$\nFor a uniform free stream, the variables $(\\rho_{\\infty}, u_{\\infty}, v_{\\infty})$ are constant in both space and time. Consequently, all partial derivatives are zero, and the equation is trivially satisfied. The challenge is to ensure this property is maintained after discretization on a curvilinear grid.\n\nThe discrete form of the continuity equation's spatial derivative terms for a uniform free stream is given as the residual $R$:\n$$\nR = D_{\\xi}(\\rho_{\\infty} U^{\\xi}_{\\mathrm{nc}}) + D_{\\eta}(\\rho_{\\infty} U^{\\eta}_{\\mathrm{nc}})\n$$\nwhere $D_{\\xi}$ and $D_{\\eta}$ are the discrete operators used for the flux divergence. Since the free-stream state $(\\rho_{\\infty}, u_{\\infty}, v_{\\infty})$ is constant, we can factor it out of the discrete operators:\n$$\nR = \\rho_{\\infty} \\left[ D_{\\xi}(U^{\\xi}_{\\mathrm{nc}}) + D_{\\eta}(U^{\\eta}_{\\mathrm{nc}}) \\right]\n$$\nThe nonconservative contravariant velocities are given by\n$$\nU^{\\xi}_{\\mathrm{nc}} = u_{\\infty} (J \\xi_{x})_{\\mathrm{nc}} + v_{\\infty} (J \\xi_{y})_{\\mathrm{nc}}\n$$\n$$\nU^{\\eta}_{\\mathrm{nc}} = u_{\\infty} (J \\eta_{x})_{\\mathrm{nc}} + v_{\\infty} (J \\eta_{y})_{\\mathrm{nc}}\n$$\nThe problem statement defines the nonconservative metrics in a slightly convoluted manner. It defines $\\xi_{x}^{\\mathrm{nc}} = (\\widehat{D}_{\\eta} y)/\\widehat{J}$ and then uses the term $J \\xi_{x}^{\\mathrm{nc}}$ in the flux. This introduces an ambiguous ratio of Jacobians, $J/\\widehat{J}$. The standard formulation of this problem, which we will adopt for a tractable analysis, assumes the nonconservative Jacobian-weighted metrics are defined directly by discretizing the continuous identities $J\\xi_x=y_\\eta$, $J\\xi_y=-x_\\eta$, etc., using a separate set of operators, $\\widehat{D}_{\\xi}$ and $\\widehat{D}_{\\eta}$. These definitions are:\n$$\n(J \\xi_{x})_{\\mathrm{nc}} = \\widehat{D}_{\\eta} y\n$$\n$$\n(J \\xi_{y})_{\\mathrm{nc}} = -\\widehat{D}_{\\eta} x\n$$\n$$\n(J \\eta_{x})_{\\mathrm{nc}} = -\\widehat{D}_{\\xi} y\n$$\n$$\n(J \\eta_{y})_{\\mathrm{nc}} = \\widehat{D}_{\\xi} x\n$$\nSubstituting these into the expression for the residual $R$:\n$$\nR = \\rho_{\\infty} \\left[ D_{\\xi} \\left( u_{\\infty} (\\widehat{D}_{\\eta} y) + v_{\\infty} (-\\widehat{D}_{\\eta} x) \\right) + D_{\\eta} \\left( u_{\\infty} (-\\widehat{D}_{\\xi} y) + v_{\\infty} (\\widehat{D}_{\\xi} x) \\right) \\right]\n$$\nSince $u_{\\infty}$ and $v_{\\infty}$ are constants, they can also be factored out:\n$$\nR = \\rho_{\\infty} u_{\\infty} \\left[ D_{\\xi}(\\widehat{D}_{\\eta} y) + D_{\\eta}(-\\widehat{D}_{\\xi} y) \\right] + \\rho_{\\infty} v_{\\infty} \\left[ D_{\\xi}(-\\widehat{D}_{\\eta} x) + D_{\\eta}(\\widehat{D}_{\\xi} x) \\right]\n$$\nRearranging the terms yields the final expression for the discrete free-stream residual:\n$$\nR = \\rho_{\\infty} u_{\\infty} \\left( D_{\\xi} \\widehat{D}_{\\eta} y - D_{\\eta} \\widehat{D}_{\\xi} y \\right) - \\rho_{\\infty} v_{\\infty} \\left( D_{\\xi} \\widehat{D}_{\\eta} x - D_{\\eta} \\widehat{D}_{\\xi} x \\right)\n$$\nThis residual is, in general, non-zero. The loss of free-stream preservation arises for two primary reasons explicitly shown in this expression:\n1.  **Mismatch between discrete operators**: The expression involves operators $D_{\\xi}$ and $D_{\\eta}$ for the flux divergence, and $\\widehat{D}_{\\xi}$ and $\\widehat{D}_{\\eta}$ for the metric calculations. If $D_{\\xi} \\neq \\widehat{D}_{\\xi}$ or $D_{\\eta} \\neq \\widehat{D}_{\\eta}$, there is no mathematical basis to expect cancellation of the terms. The discrete operations are not consistently applied.\n2.  **Discrete failure of the metric identities**: Even if the operators are matched (i.e., $\\widehat{D}_{\\xi} = D_{\\xi}$ and $\\widehat{D}_{\\eta} = D_{\\eta}$), the residual becomes $R = \\rho_{\\infty} u_{\\infty} (D_{\\xi} D_{\\eta} - D_{\\eta} D_{\\xi})y - \\rho_{\\infty} v_{\\infty} (D_{\\xi} D_{\\eta} - D_{\\eta} D_{\\xi})x$. This is non-zero if the discrete operators $D_{\\xi}$ and $D_{\\eta}$ do not commute, i.e., $[D_{\\xi}, D_{\\eta}] \\equiv D_{\\xi}D_{\\eta} - D_{\\eta}D_{\\xi} \\neq 0$. In the continuous case, the corresponding metric identities, e.g., $\\partial_{\\xi}(y_{\\eta}) + \\partial_{\\eta}(-y_{\\xi}) = y_{\\eta\\xi} - y_{\\xi\\eta} = 0$, rely on the equality of mixed partial derivatives (Schwarz's theorem). General discrete difference operators do not commute, so their discrete analog is not automatically satisfied. This non-zero residual acts as a numerical source term, violating the GCL.\n\nTo ensure free-stream preservation, the residual $R$ must be identically zero for any uniform free-stream state $(\\rho_{\\infty}, u_{\\infty}, v_{\\infty})$. This means the coefficients of $u_{\\infty}$ and $v_{\\infty}$ in the residual expression must independently be zero. This requires that the Jacobian-weighted metric components $(J\\xi_x, J\\xi_y, J\\eta_x, J\\eta_y)$ satisfy the discrete metric identities (or GCL):\n$$\nD_{\\xi}(J\\xi_x) + D_{\\eta}(J\\eta_x) = 0\n$$\n$$\nD_{\\xi}(J\\xi_y) + D_{\\eta}(J\\eta_y) = 0\n$$\nThe crucial step is to define the metric terms in such a way that these discrete identities are satisfied *by construction*. This is achieved by using the *same* discrete operators, $D_{\\xi}$ and $D_{\\eta}$, for both the metric calculations and the flux divergence. We propose the following conservative metric evaluation by directly discretizing the continuous relations $J\\xi_x = y_{\\eta}$, $J\\xi_y = -x_{\\eta}$, etc.:\n$$\n(J \\xi_x)_{\\mathrm{cons}} = D_{\\eta} y\n$$\n$$\n(J \\xi_y)_{\\mathrm{cons}} = -D_{\\eta} x\n$$\n$$\n(J \\eta_x)_{\\mathrm{cons}} = -D_{\\xi} y\n$$\n$$\n(J \\eta_y)_{\\mathrm{cons}} = D_{\\xi} x\n$$\nLet us substitute these definitions into the discrete metric identities to verify their validity.\nFor the first identity:\n$$\nD_{\\xi}((J\\xi_x)_{\\mathrm{cons}}) + D_{\\eta}((J\\eta_x)_{\\mathrm{cons}}) = D_{\\xi}(D_{\\eta} y) + D_{\\eta}(-D_{\\xi} y) = (D_{\\xi}D_{\\eta} - D_{\\eta}D_{\\xi})y\n$$\nFor the second identity:\n$$\nD_{\\xi}((J\\xi_y)_{\\mathrm{cons}}) + D_{\\eta}((J\\eta_y)_{\\mathrm{cons}}) = D_{\\xi}(-D_{\\eta} x) + D_{\\eta}(D_{\\xi} x) = (-D_{\\xi}D_{\\eta} + D_{\\eta}D_{\\xi})x = -(D_{\\xi}D_{\\eta} - D_{\\eta}D_{\\xi})x\n$$\nThe expressions are zero if and only if the operators $D_{\\xi}$ and $D_{\\eta}$ commute. The problem states that the operators are \"linear, constant-coefficient\" and act on a \"uniform grid.\" Let a general 1D linear constant-coefficient operator be defined by a stencil $c_k$: $D_{\\xi} f_{i,j} = \\sum_k c_k f_{i+k, j}$. Similarly, $D_{\\eta} f_{i,j} = \\sum_l c'_l f_{i, j+l}$. Applying these operators in sequence:\n$$\n(D_{\\xi} D_{\\eta}) f_{i,j} = D_{\\xi} \\left( \\sum_l c'_l f_{i, j+l} \\right) = \\sum_k c_k \\left( \\sum_l c'_l f_{i+k, j+l} \\right) = \\sum_{k,l} c_k c'_l f_{i+k, j+l}\n$$\n$$\n(D_{\\eta} D_{\\xi}) f_{i,j} = D_{\\eta} \\left( \\sum_k c_k f_{i+k, j} \\right) = \\sum_l c'_l \\left( \\sum_k c_k f_{i+k, j+l} \\right) = \\sum_{k,l} c'_l c_k f_{i+k, j+l}\n$$\nSince scalar multiplication is commutative ($c_k c'_l = c'_l c_k$), we have $D_{\\xi} D_{\\eta} = D_{\\eta} D_{\\xi}$. The conditions specified in the problem statement guarantee that the operators commute. Therefore, the proposed metric definitions satisfy the discrete metric identities and ensure that the free-stream residual is identically zero. This is the strictly conservative metric evaluation required.\n\nThe proposed Jacobian-weighted contravariant metric components that satisfy the GCL are thus given by the application of the flux divergence operators $D_\\xi$ and $D_\\eta$ to the physical coordinate functions $x$ and $y$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nD_{\\eta} y & -D_{\\eta} x & -D_{\\xi} y & D_{\\xi} x\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A formally conservative scheme is necessary but not always sufficient for robustly simulating complex flows, such as high-speed flow over a blunt body. This problem addresses the 'carbuncle phenomenon,' a notorious numerical instability that can arise even with conservative methods, leading to a catastrophic failure of the shock-capturing capability. This exercise challenges you to analyze the root cause—insufficient transverse dissipation in one-dimensional Riemann solvers—and to evaluate advanced, conservative strategies designed to cure this multi-dimensional pathology .",
            "id": "3949779",
            "problem": "A two-dimensional finite volume discretization of the compressible Euler equations is employed for inviscid flow over a blunt body at high supersonic Mach number. Assume a Cartesian mesh with cells indexed by $(i,j)$ and piecewise constant states per cell. The conserved state vector is $\\boldsymbol{U} = [\\rho, \\rho u, \\rho v, \\rho E]^{\\top}$, with fluxes $\\boldsymbol{F}(\\boldsymbol{U})$ in the $x$-direction and $\\boldsymbol{G}(\\boldsymbol{U})$ in the $y$-direction. The governing equations in conservation form are\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} + \\frac{\\partial \\boldsymbol{G}(\\boldsymbol{U})}{\\partial y} = \\boldsymbol{0}.\n$$\nA conservative finite volume update for cell $(i,j)$ reads\n$$\n\\boldsymbol{U}_{i,j}^{n+1} = \\boldsymbol{U}_{i,j}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(\\widehat{\\boldsymbol{F}}_{i+\\frac{1}{2},j} - \\widehat{\\boldsymbol{F}}_{i-\\frac{1}{2},j}\\right) - \\frac{\\Delta t}{\\Delta y}\\left(\\widehat{\\boldsymbol{G}}_{i,j+\\frac{1}{2}} - \\widehat{\\boldsymbol{G}}_{i,j-\\frac{1}{2}}\\right),\n$$\nwhere $\\widehat{\\boldsymbol{F}}$ and $\\widehat{\\boldsymbol{G}}$ are consistent numerical fluxes built from local left and right states. For a stationary, grid-aligned shock, discrete conservation implies that the shock speed and jump satisfy the Rankine–Hugoniot conditions in the normal direction $\\boldsymbol{n}$:\n$$\ns\\,[\\boldsymbol{U}] = [\\boldsymbol{F}_n(\\boldsymbol{U})], \\quad \\boldsymbol{F}_n(\\boldsymbol{U}) = n_x\\,\\boldsymbol{F}(\\boldsymbol{U}) + n_y\\,\\boldsymbol{G}(\\boldsymbol{U}),\n$$\nwith $[\\cdot]$ denoting the jump across the shock and $s$ the shock speed.\n\nIn practice, certain approximate Riemann solvers and limiter choices can produce the carbuncle phenomenon near strong, grid-aligned shocks: a spurious bulge and odd-even decoupling caused by insufficient transverse dissipation and excessive alignment of numerical dissipation with the computational grid. You are asked to evaluate several proposed modifications aimed at ameliorating the carbuncle while maintaining conservation and correct shock propagation.\n\nWhich of the following strategies are both conservative (i.e., they preserve the discrete divergence form of the update and consistency of $\\widehat{\\boldsymbol{F}}$, $\\widehat{\\boldsymbol{G}}$) and are known to reduce the carbuncle in strong shock computations?\n\nA. Replace a Roe-type linearized flux with a two-wave Harten–Lax–van Leer (HLL or HLLE) flux and augment it by a rotated Riemann solver that aligns dissipation with an estimated local shock normal $\\boldsymbol{n}$ computed from $\\nabla p$, thereby increasing transverse dissipation while preserving the flux-difference form.\n\nB. Add an explicit pressure-smoothing step by introducing a cell-centered artificial pressure diffusion term as a source exclusively in the momentum equations between flux updates, tuned by a shock sensor to damp odd-even decoupling.\n\nC. Apply a Total Variation Diminishing (TVD) limiter only in the streamwise direction (parallel to the shock normal), leaving transverse reconstruction unlimited, without changing the numerical flux functions.\n\nD. Augment a Roe-type flux with matrix artificial viscosity constructed from the full eigenstructure to add dissipative terms proportional to the spectral radius in both $x$ and $y$ directions within the numerical fluxes, designed to be entropy-compatible and maintaining conservation through modified interface fluxes.\n\nE. Introduce low-Mach preconditioning in shock regions to modify the characteristic speeds and increase numerical dissipation, assuming the same flux-difference form is kept.\n\nSelect all that apply. Justify your selections by reasoning from the conservation form of the equations, the Rankine–Hugoniot jump conditions, and the mechanisms by which carbuncle arises and is suppressed via multidimensional dissipation in approximate Riemann solvers within Computational Fluid Dynamics (CFD).",
            "solution": "The \"carbuncle phenomenon\" is a numerical instability that manifests as a spurious, unphysical bulge on a captured shock wave, particularly when the shock is strong and aligned with the computational grid. The fundamental cause is the failure of one-dimensional approximate Riemann solvers, applied dimension-by-dimension, to provide adequate dissipation in the direction transverse to the shock. This allows non-physical oscillations, such as odd-even decoupling, to grow. A valid remedy must be both **conservative** (preserving the discrete conservation form) and **effective** (introducing the necessary multi-dimensional dissipation).\n\nWe evaluate each option against these criteria:\n\n*   **A. Replace a Roe-type flux with an HLL-type flux and augment with a rotated Riemann solver:** This method is **correct**. It is conservative by construction, as a rotated Riemann solver still produces a single, consistent numerical flux at the cell interface. It is also highly effective. HLL-family fluxes are inherently more robust than Roe's solver for strong shocks, and rotating the solver to align with the physical shock normal (estimated from $\\nabla p$) introduces the necessary dissipation in the transverse direction, directly curing the instability.\n\n*   **B. Add an explicit pressure-smoothing step as a source term:** This method is **incorrect**. Adding a source term, especially one that only affects the momentum equations, breaks the conservation form of the coupled system. It is a non-conservative \"fix\" that violates the conservation of total energy.\n\n*   **C. Apply a TVD limiter only in the streamwise direction:** This method is **incorrect**. The carbuncle is caused by a *lack* of transverse dissipation. Removing the limiter (and its associated dissipation) in the transverse direction is counter-productive and would likely exacerbate the instability.\n\n*   **D. Augment a Roe-type flux with matrix artificial viscosity (MAV):** This method is **correct**. MAV is designed to be incorporated directly into the dissipation term of the numerical flux, making it fully conservative. It cures the carbuncle by ensuring that the dissipation matrix provides sufficient damping for all wave families, especially in the transverse direction where dissipation from a standard Roe scheme can vanish for grid-aligned shocks.\n\n*   **E. Introduce low-Mach preconditioning:** This method is **incorrect**. Low-Mach preconditioning is a technique for the *low Mach number* (nearly incompressible) regime. Applying it to a *high supersonic* flow with a strong shock is a fundamental misapplication of the method and would corrupt the physics of wave propagation.\n\nTherefore, strategies A and D are both conservative and known to be effective cures for the carbuncle phenomenon.",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}