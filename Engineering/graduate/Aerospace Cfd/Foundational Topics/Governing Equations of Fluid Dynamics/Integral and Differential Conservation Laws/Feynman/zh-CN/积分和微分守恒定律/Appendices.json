{
    "hands_on_practices": [
        {
            "introduction": "激波是超音速流动中的基本间断现象。这项练习将演示如何通过直接应用质量、动量和能量的积分守恒定律，推导出著名的朗金-雨果关系式，该关系式描述了流体性质穿过激波时的跳跃变化。完成这一推导 ，有助于深刻理解这些基本原理是如何支配气体动力学中最为剧烈的现象的。",
            "id": "3968210",
            "problem": "考虑一个厚度可忽略的、在无粘量热完全气体中的定常平面正激波，其比热比 $\\gamma$ 为常数。激波在惯性参考系中静止，上游状态（$1$）是均匀的，其速度为 $u_1$，密度为 $\\rho_1$，压力为 $p_1$，温度为 $T_1$。下游状态（$2$）是均匀的，其速度为 $u_2$，密度为 $\\rho_2$，压力为 $p_2$，温度为 $T_2$。该气体遵循理想气体状态方程 $p = \\rho R T$，其中 $R$ 是比气体常数，热力学焓为 $h = c_p T$，且 $c_p = \\gamma R / (\\gamma - 1)$。上游马赫数为 $M_1 = u_1 / a_1$，其中 $a_1 = \\sqrt{\\gamma R T_1}$ 是上游声速。假设穿过激波没有热量添加，也没有轴功。\n\n从应用于包围激波的固定控制体的质量、动量和能量的欧拉方程积分形式出发，通过利用平面对称性和定常状态将其简化为跳跃条件，推导连接上游和下游状态的朗金-雨果关系。消去中间变量，得到以下无量纲比值的闭式表达式，这些表达式应完全用 $M_1$ 和 $\\gamma$ 表示：\n- 密度比 $\\rho_2 / \\rho_1$，\n- 压力比 $p_2 / p_1$，\n- 温度比 $T_2 / T_1$。\n\n将最终结果表示为关于 $M_1$ 和 $\\gamma$ 的单行矩阵 $\\begin{pmatrix} \\rho_2 / \\rho_1 & p_2 / p_1 & T_2 / T_1 \\end{pmatrix}$。不需要单位。请提供精确的解析表达式，不要进行近似或四舍五入。",
            "solution": "该问题陈述是气体动力学中的一个标准推导，具有科学依据、适定、客观且完整。因此，它被认为是有效的。我们开始进行推导。\n\n分析始于固定控制体 $V$（其表面为 $S$）的欧拉方程的积分形式。对于定常流（$\\frac{\\partial}{\\partial t} = 0$），这些守恒定律是：\n质量守恒：\n$$ \\oint_S \\rho \\mathbf{u} \\cdot \\mathbf{n} \\, dS = 0 $$\n动量守恒：\n$$ \\oint_S (\\rho \\mathbf{u} (\\mathbf{u} \\cdot \\mathbf{n}) + p \\mathbf{n}) \\, dS = 0 $$\n能量守恒：\n$$ \\oint_S \\rho H_t \\mathbf{u} \\cdot \\mathbf{n} \\, dS = 0 $$\n其中 $\\rho$ 是密度，$\\mathbf{u}$ 是速度矢量，$\\mathbf{n}$ 是指向表面 $S$ 外部的单位法向量，$p$ 是压力，$H_t$ 是总比焓，定义为 $H_t = h + \\frac{1}{2}|\\mathbf{u}|^2$。\n\n我们将这些定律应用于一个包围平面正激波的薄矩形盒状控制体。流动是沿x轴的一维流动，因此 $\\mathbf{u} = u \\hat{\\mathbf{i}}$。该控制体有两个垂直于流动的面，面积均为 $A$，一个位于上游（状态 $1$），另一个位于下游（状态 $2$）。其他面与流动方向平行，因此通过它们的通量为零。问题陈述指出，在上游和下游面上，各属性是均匀的。\n\n对于上游面（1），$\\mathbf{n} = -\\hat{\\mathbf{i}}$，所以 $\\mathbf{u} \\cdot \\mathbf{n} = -u_1$。\n对于下游面（2），$\\mathbf{n} = +\\hat{\\mathbf{i}}$，所以 $\\mathbf{u} \\cdot \\mathbf{n} = u_2$。\n\n将这些条件应用于积分定律，可将其简化为跨越激波的代数跳跃条件：\n质量：\n$$ -\\rho_1 u_1 A + \\rho_2 u_2 A = 0 \\implies \\rho_1 u_1 = \\rho_2 u_2 $$\n动量：\n$$ -(\\rho_1 u_1^2 + p_1) A + (\\rho_2 u_2^2 + p_2) A = 0 \\implies p_1 + \\rho_1 u_1^2 = p_2 + \\rho_2 u_2^2 $$\n能量：\n$$ -(\\rho_1 u_1 H_{t1}) A + (\\rho_2 u_2 H_{t2}) A = 0 \\implies \\rho_1 u_1 H_{t1} = \\rho_2 u_2 H_{t2} $$\n利用质量守恒的结果，能量方程简化为总焓在激波前后守恒的表述：\n$$ H_{t1} = H_{t2} \\implies h_1 + \\frac{1}{2}u_1^2 = h_2 + \\frac{1}{2}u_2^2 $$\n\n我们得到三个基本的朗金-雨果跳跃条件：\n1.  $\\rho_1 u_1 = \\rho_2 u_2$\n2.  $p_1 + \\rho_1 u_1^2 = p_2 + \\rho_2 u_2^2$\n3.  $h_1 + \\frac{1}{2}u_1^2 = h_2 + \\frac{1}{2}u_2^2$\n\n现在我们使用给定的量热完全气体的热力学关系来处理这些方程：$h = c_p T = \\frac{\\gamma R}{\\gamma-1}T = \\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho}$，以及声速的定义 $a = \\sqrt{\\gamma R T} = \\sqrt{\\gamma p / \\rho}$。上游马赫数为 $M_1 = u_1/a_1$。\n\n由动量方程（2）可得：\n$$ p_2 - p_1 = \\rho_1 u_1^2 - \\rho_2 u_2^2 $$\n利用质量守恒（1），我们可以写出 $\\rho_2 u_2^2 = (\\rho_2 u_2)u_2 = (\\rho_1 u_1)u_2$：\n$$ p_2 - p_1 = \\rho_1 u_1 u_1 - (\\rho_1 u_1) u_2 = \\rho_1 u_1 (u_1 - u_2) $$\n同样由（1）可得，$u_2 = \\frac{\\rho_1}{\\rho_2} u_1$。将此式代入前一个方程，得到压力比和密度比之间的关系：\n$$ p_2 - p_1 = \\rho_1 u_1 (u_1 - \\frac{\\rho_1}{\\rho_2} u_1) = \\rho_1 u_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) $$\n两边同除以 $p_1$ 并使用定义 $a_1^2 = \\gamma p_1 / \\rho_1$，我们有：\n$$ \\frac{p_2}{p_1} - 1 = \\frac{\\rho_1 u_1^2}{p_1} \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) = \\frac{\\gamma u_1^2}{a_1^2} \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) = \\gamma M_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) $$\n我们将其标记为方程（A）：\n$$ \\frac{p_2}{p_1} = 1 + \\gamma M_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) $$\n\n接下来，我们使用能量方程（3），代入 $h = \\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho}$：\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} + \\frac{1}{2}u_1^2 = \\frac{\\gamma}{\\gamma-1}\\frac{p_2}{\\rho_2} + \\frac{1}{2}u_2^2 $$\n整理可得：\n$$ \\frac{\\gamma}{\\gamma-1} \\left(\\frac{p_2}{\\rho_2} - \\frac{p_1}{\\rho_1}\\right) = \\frac{1}{2}(u_1^2 - u_2^2) = \\frac{1}{2}u_1^2\\left(1 - \\left(\\frac{u_2}{u_1}\\right)^2\\right) $$\n根据质量守恒，使用 $u_2/u_1 = \\rho_1/\\rho_2$：\n$$ \\frac{\\gamma}{\\gamma-1} \\left(\\frac{p_2}{\\rho_2} - \\frac{p_1}{\\rho_1}\\right) = \\frac{1}{2}u_1^2\\left(1 - \\left(\\frac{\\rho_1}{\\rho_2}\\right)^2\\right) $$\n将整个方程除以 $\\frac{p_1}{\\rho_1} = \\frac{a_1^2}{\\gamma}$：\n$$ \\frac{\\gamma}{\\gamma-1} \\left(\\frac{p_2}{p_1}\\frac{\\rho_1}{\\rho_2} - 1\\right) = \\frac{1}{2}\\frac{u_1^2}{p_1/\\rho_1} \\left(1 - \\left(\\frac{\\rho_1}{\\rho_2}\\right)^2\\right) = \\frac{1}{2}\\frac{\\gamma u_1^2}{a_1^2} \\left(1 - \\left(\\frac{\\rho_1}{\\rho_2}\\right)^2\\right) $$\n$$ \\frac{1}{\\gamma-1} \\left(\\frac{p_2}{p_1}\\frac{\\rho_1}{\\rho_2} - 1\\right) = \\frac{1}{2} M_1^2 \\left(1 - \\left(\\frac{\\rho_1}{\\rho_2}\\right)^2\\right) $$\n我们将其标记为方程（B）。现在我们求解由方程（A）和（B）组成的方程组，以求出比值 $\\rho_2/\\rho_1$ 和 $p_2/p_1$。将方程（A）代入方程（B）：\n$$ \\frac{1}{\\gamma-1} \\left[ \\left(1 + \\gamma M_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right)\\right)\\frac{\\rho_1}{\\rho_2} - 1 \\right] = \\frac{1}{2} M_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right)\\left(1 + \\frac{\\rho_1}{\\rho_2}\\right) $$\n为简化代数运算，令 $x = \\rho_1/\\rho_2$。一个物理上存在的激波要求 $x \\neq 1$。\n$$ \\frac{1}{\\gamma-1} \\left[ (1 + \\gamma M_1^2 (1-x))x - 1 \\right] = \\frac{1}{2} M_1^2 (1-x^2) $$\n$$ \\frac{1}{\\gamma-1} \\left[ x + \\gamma M_1^2 (x-x^2) - 1 \\right] = \\frac{1}{2} M_1^2 (1-x)(1+x) $$\n$$ \\frac{1}{\\gamma-1} \\left[ -(1-x) + \\gamma M_1^2 x(1-x) \\right] = \\frac{1}{2} M_1^2 (1-x)(1+x) $$\n由于 $x \\neq 1$，我们可以两边同除以 $(1-x)$：\n$$ \\frac{1}{\\gamma-1} \\left[ -1 + \\gamma M_1^2 x \\right] = \\frac{1}{2} M_1^2 (1+x) $$\n两边同乘以 $2(\\gamma-1)$：\n$$ -2 + 2\\gamma M_1^2 x = (\\gamma-1)M_1^2(1+x) $$\n$$ -2 + 2\\gamma M_1^2 x = (\\gamma-1)M_1^2 + (\\gamma-1)M_1^2 x $$\n合并含 $x$ 的项：\n$$ x [2\\gamma M_1^2 - (\\gamma-1)M_1^2] = 2 + (\\gamma-1)M_1^2 $$\n$$ x [(\\gamma+1)M_1^2] = 2 + (\\gamma-1)M_1^2 $$\n$$ x = \\frac{\\rho_1}{\\rho_2} = \\frac{(\\gamma-1)M_1^2 + 2}{(\\gamma+1)M_1^2} $$\n将此表达式取倒数，得到密度比：\n$$ \\frac{\\rho_2}{\\rho_1} = \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2 + 2} $$\n\n现在，将此结果代回方程（A）以求出压力比：\n$$ \\frac{p_2}{p_1} = 1 + \\gamma M_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) = 1 + \\gamma M_1^2 \\left(1 - \\frac{(\\gamma-1)M_1^2 + 2}{(\\gamma+1)M_1^2}\\right) $$\n$$ \\frac{p_2}{p_1} = 1 + \\gamma M_1^2 \\left(\\frac{(\\gamma+1)M_1^2 - ((\\gamma-1)M_1^2 + 2)}{(\\gamma+1)M_1^2}\\right) $$\n$$ \\frac{p_2}{p_1} = 1 + \\gamma M_1^2 \\left(\\frac{2M_1^2 - 2}{(\\gamma+1)M_1^2}\\right) = 1 + \\frac{2\\gamma(M_1^2 - 1)}{\\gamma+1} $$\n通分合并各项：\n$$ \\frac{p_2}{p_1} = \\frac{(\\gamma+1) + 2\\gamma(M_1^2 - 1)}{\\gamma+1} = \\frac{\\gamma+1 + 2\\gamma M_1^2 - 2\\gamma}{\\gamma+1} $$\n$$ \\frac{p_2}{p_1} = \\frac{2\\gamma M_1^2 - (\\gamma-1)}{\\gamma+1} $$\n\n最后，使用理想气体定律 $p = \\rho R T$ 求出温度比，该定律意味着 $\\frac{T_2}{T_1} = \\frac{p_2}{p_1} \\frac{\\rho_1}{\\rho_2}$：\n$$ \\frac{T_2}{T_1} = \\left(\\frac{2\\gamma M_1^2 - (\\gamma-1)}{\\gamma+1}\\right) \\left(\\frac{(\\gamma-1)M_1^2 + 2}{(\\gamma+1)M_1^2}\\right) $$\n这可以写成一个单独的分数：\n$$ \\frac{T_2}{T_1} = \\frac{\\left(2\\gamma M_1^2 - (\\gamma-1)\\right)\\left((\\gamma-1)M_1^2 + 2\\right)}{(\\gamma+1)^2 M_1^2} $$\n\n这三个表达式给出了穿过正激波的密度、压力和温度的下游与上游之比，它们仅是上游马赫数 $M_1$ 和比热比 $\\gamma$ 的函数。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2 + 2} & \\frac{2\\gamma M_1^2 - (\\gamma-1)}{\\gamma+1} & \\frac{(2\\gamma M_1^2 - (\\gamma-1))((\\gamma-1)M_1^2 + 2)}{(\\gamma+1)^2 M_1^2} \\end{pmatrix}} $$"
        },
        {
            "introduction": "当我们将连续的守恒定律转化为数值算法时，一些看似微小的选择可能会带来巨大的影响。虽然对于光滑流动，欧拉方程的微分形式和积分形式是等价的，但这种等价性在激波处会失效。这个思想实验  要求你分析为何一个“非守恒”的数值格式——尽管看似合理——在处理激波问题时会得出物理上完全错误的解，从而强调了在计算流体力学(CFD)中坚持使用守恒形式的必要性。",
            "id": "3968234",
            "problem": "考虑标量无粘伯格斯方程，这是计算流体动力学（CFD, Computational Fluid Dynamics）中使用的一个典型的非线性平流定律：\n$$\n\\partial_t u + \\partial_x \\left(\\tfrac{1}{2} u^2 \\right) = 0,\n$$\n该方程设置在间距为 $\\Delta x$、节点位置为 $x_i$ 的均匀网格上。设初始数据为具有单个间断的黎曼阶跃，\n$$\nu(x,0) = \\begin{cases}\nu_L, & x  0,\\\\\nu_R,  x > 0,\n\\end{cases}\n$$\n其中 $u_L > u_R \\ge 0$，以形成激波。一个在节点上逐点强制执行微分形式 $\\partial_t u + u\\,\\partial_x u = 0$ 的离散格式，可能无法强制执行跨间断的积分守恒。您的任务是确定一个具体的离散化和配置作为反例：它产生一个在所有节点上都满足逐点微分形式的离散解，但却违反了跨激波的积分守恒（例如，当物理上正确的解需要运动时，它却产生了错误的激波速度或一个静止的间断）。\n\n从移动控制体上的控制积分守恒原理及其相关的朗金-雨果跳跃条件出发，并利用这些基本原理来推断哪个选项提供了一个有效的反例。所有数值和物理参数必须在科学上是一致的。\n\n哪个选项正确地构造了这样一个反例？\n\nA. 使用非守恒的、微分形式的、迎风有限差分格式\n$$\n\\frac{d}{dt} u_i + u_i\\,D_x u_i = 0,\n$$\n其中单边导数为\n$$\nD_x u_i = \n\\begin{cases}\n\\dfrac{u_i - u_{i-1}}{\\Delta x},  u_i > 0,\\\\\n\\dfrac{u_{i+1} - u_i}{\\Delta x},  u_i  0,\\\\\n0,  u_i = 0,\n\\end{cases}\n$$\n并选择 $u_L = 1, u_R = 0$，使间断精确地对齐在节点 $i=0$ 和 $i=1$ 之间的面 $x_{1/2}$ 上，即：\n$$\nu_i(0) = \\begin{cases}\n1,  i \\le 0,\\\\\n0,  i \\ge 1.\n\\end{cases}\n$$\n对于此配置，每个节点上的离散残差均为零，因此该格式允许存在一个静止的间断，尽管物理上正确的积分跳跃条件要求一个非零的激波速度。\n\nB. 使用守恒的有限体积半离散格式\n$$\n\\frac{d}{dt} \\bar{u}_i + \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x} = 0,\n$$\n其中使用一个一致的单调数值通量 $F_{i+1/2} = F\\!\\left(u_L^{i+1/2},u_R^{i+1/2}\\right)$，该通量通过精确或近似的黎曼解从面上的左右状态计算得出，并设置 $u_L = 1, u_R = 0$，间断初始位于 $x_{1/2}$。该格式能产生积分跳跃条件所要求的激波运动。\n\nC. 使用微分形式的非守恒中心差分离散化\n$$\n\\frac{d}{dt} u_i + u_i\\,\\frac{u_{i+1} - u_{i-1}}{2\\Delta x} = 0,\n$$\n使用 $u_L = 1, u_R = 0$，并将间断精确地放置在节点 $i=0$ 上，因此 $u_0(0)$ 在连续统中未定义，但在数值上被赋予 $u_L$ 或 $u_R$。中心差分格式必然会耦合间断两侧的值，从而在跳跃附近产生非零残差。\n\nD. 使用守恒通量梯度的节点有限差分离散化\n$$\n\\frac{d}{dt} u_i + \\frac{\\tfrac{1}{2}u_{i+1}^2 - \\tfrac{1}{2}u_{i-1}^2}{2\\Delta x} = 0,\n$$\n使用 $u_L = 1, u_R = 0$，且间断位于 $x_{1/2}$。跳跃附近的节点更新不为零，推动间断前进，这与积分跳跃条件一致。\n\n选择真正展示了一个非守恒离散化在逐点满足微分形式的同时，又违反了跨激波积分平衡的选项。",
            "solution": "问题陈述的解析和验证如下。\n\n### 第一步：提取已知条件\n-   **控制方程（守恒形式）**：$\\partial_t u + \\partial_x \\left(\\tfrac{1}{2} u^2 \\right) = 0$，即标量无粘伯格斯方程。\n-   **控制方程（非守恒形式）**：$\\partial_t u + u\\,\\partial_x u = 0$。\n-   **网格**：均匀，间距 $\\Delta x$，节点位置 $x_i$。\n-   **初始条件**：一个黎曼问题（阶跃间断），定义为\n    $$\n    u(x,0) = \\begin{cases}\n    u_L,  x  0,\\\\\n    u_R,  x > 0,\n    \\end{cases}\n    $$\n-   **激波条件**：$u_L > u_R \\ge 0$，这确保了形成的是激波，而不是稀疏波。\n-   **任务**：确定一个数值格式和初始数据配置，作为特定类型的反例。\n-   **反例定义**：该格式必须 (1) 离散化非守恒微分形式，(2) 在所有节点上逐点满足此微分形式（意味着一个时间导数为零的定常解），以及 (3) 违反积分守恒定律，例如产生不正确的激波速度。\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于无粘伯格斯方程，这是流体动力学和应用数学中一个基础且被广泛研究的非线性偏微分方程。它正确地区分了守恒形式和非守恒形式，这是处理带间断（激波）解的一个关键概念。使用朗金-雨果条件来确定正确的激波速度是标准且正确的。所有概念都是双曲守恒律理论及其在CFD中数值解的核心。该问题在科学上是合理的。\n2.  **适定性**：该问题要求从一系列选项中找出一个特定的配置，以展示某些数值格式的一种已知失效模式。这种失效的标准被清晰而精确地定义。任务是明确的，并且基于既定理论有唯一的正确答案。\n3.  **客观性**：问题以数值分析和CFD中常见的精确技术语言陈述。它没有歧义、主观性或非科学的主张。\n\n### 第三步：结论与行动\n问题陈述是有效的。它提出了一个清晰、适定且科学正确的问题。现在开始解题过程。\n\n### 从第一性原理推导\n控制系统的基本原理是守恒定律的积分形式。对于任何控制体 $[x_a, x_b]$，该体积内 $u$ 的总量的变化率等于穿过其边界的净通量：\n$$\n\\frac{d}{dt} \\int_{x_a}^{x_b} u(x,t) \\, dx = F(u(x_a,t)) - F(u(x_b,t))\n$$\n其中 $F(u) = \\frac{1}{2}u^2$ 是伯格斯方程的通量函数。\n\n对于以速度 $s = dx_s/dt$ 传播的间断解（激波），该积分原理导出朗金-雨果（R-H）跳跃条件，该条件将激波速度与间断两侧的状态（$u_L$ 和 $u_R$）联系起来：\n$$\ns = \\frac{F(u_R) - F(u_L)}{u_R - u_L}\n$$\n对于伯格斯方程，这变为：\n$$\ns = \\frac{\\frac{1}{2}u_R^2 - \\frac{1}{2}u_L^2}{u_R - u_L} = \\frac{\\frac{1}{2}(u_R - u_L)(u_R + u_L)}{u_R - u_L} = \\frac{u_L + u_R}{2}\n$$\n问题指定使用初始值如 $u_L=1$ 和 $u_R=0$。对于这些值，物理上正确的激波速度是：\n$$\ns = \\frac{1 + 0}{2} = \\frac{1}{2}\n$$\n一个物理上正确的数值解必须捕捉到一个以速度 $s=1/2$ 向右传播的激波。而所要求的反例，则是一个能产生静止激波（$s=0$）的格式，同时表面上满足逐点微分方程 $\\partial_t u + u \\partial_x u = 0$。一个定常解对应于时间导数项为零，这意味着对于初始数据，离散空间算子在所有网格点上的计算结果必须为零。\n\n我们现在将分析每个选项，看它是否构造了这样一个反例。\n\n### 逐项分析\n\n**A. 使用非守恒的、微分形式的、迎风有限差分格式...**\n\n-   **格式**：$\\frac{d}{dt} u_i + u_i\\,D_x u_i = 0$，其中 $D_x u_i$ 是一个单边迎风偏置的差分算子。这离散化了非守恒形式 $\\partial_t u + u \\partial_x u = 0$。\n-   **初始数据**：$u_L = 1$, $u_R = 0$。间断被放置在单元面 $x_{1/2}$ 上，所以节点值为 $i \\le 0$ 时 $u_i = 1$，$i \\ge 1$ 时 $u_i = 0$。\n-   **分析**：我们必须检查离散空间残差 $R_i = u_i D_x u_i$ 是否对所有节点 $i$ 都为零。如果是，那么对所有 $i$ 都有 $\\frac{d}{dt} u_i = -R_i = 0$，离散解是定常的。\n    -   对于任何 $i \\le 0$ 的节点：$u_i = 1$ 且 $u_{i-1} = 1$。因为 $u_i = 1 > 0$，迎风格式为 $D_x u_i = \\frac{u_i - u_{i-1}}{\\Delta x} = \\frac{1 - 1}{\\Delta x} = 0$。残差为 $R_i = u_i D_x u_i = 1 \\cdot 0 = 0$。\n    -   在节点 $i=0$ 处：$u_0 = 1$ 且 $u_{-1} = 1$。因为 $u_0 = 1 > 0$，格式为 $D_x u_0 = \\frac{u_0 - u_{-1}}{\\Delta x} = \\frac{1 - 1}{\\Delta x} = 0$。残差为 $R_0 = u_0 D_x u_0 = 1 \\cdot 0 = 0$。\n    -   在节点 $i=1$ 处：$u_1 = 0$。根据格式的定义，如果 $u_i = 0$，则 $D_x u_i = 0$。残差为 $R_1 = u_1 D_x u_1 = 0 \\cdot 0 = 0$。\n    -   对于任何 $i > 1$ 的节点：$u_i = 0$。同样，$D_x u_i = 0$，残差为 $R_i = u_i D_x u_i = 0 \\cdot 0 = 0$。\n-   **结论**：对于这个特定配置，每个节点上的离散残差恒为零。这意味着该格式接受静止阶跃剖面作为一个精确的、不随时间变化的解。数值激波速度为 $s_{\\text{num}} = 0$。这直接与要求激波速度为 $s = 1/2$ 的 R-H 条件相矛盾。因此，这个离散化非守恒形式的格式，在离散意义上逐点满足了微分方程，但未能维持跨间断的积分守恒定律。\n\n**结论：正确**。此选项提供了所要求的完美反例。\n\n**B. 使用守恒的有限体积半离散格式...**\n\n-   **格式**：$\\frac{d}{dt} \\bar{u}_i + \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x} = 0$。根据定义，这是一个守恒格式。\n-   **分析**：Lax-Wendroff 定理指出，如果一个守恒形式的数值格式收敛，它将收敛到偏微分方程的一个弱解，该弱解能正确满足跳跃条件。守恒格式被专门设计用来确保总量 $\\sum_i u_i \\Delta x$ 是守恒的（在边界通量之外），这反过来又导致了正确的激波速度。该选项正确地指出，这样的格式将产生正确的激波运动。\n-   **结论**：这描述了一种能正确工作的方法，而不是一种会失败的方法。它不是一个反例。\n\n**结论：不正确**。\n\n**C. 使用非守恒中心差分离散化...**\n\n-   **格式**：$\\frac{d}{dt} u_i + u_i\\,\\frac{u_{i+1} - u_{i-1}}{2\\Delta x} = 0$。这是一个使用中心差分计算空间导数的非守恒格式。\n-   **初始数据**：间断被放置*在*一个节点上，即 $i=0$。我们来测试配置 $u_{i0}=1, u_0=1, u_{i>0}=0$。\n-   **分析**：我们检查跳跃附近的残差 $R_i = u_i\\,\\frac{u_{i+1} - u_{i-1}}{2\\Delta x}$。\n    -   在节点 $i=0$ 处：$u_{-1}=1, u_0=1, u_1=0$。残差为 $R_0 = 1 \\cdot \\frac{0 - 1}{2\\Delta x} = -\\frac{1}{2\\Delta x}$。这是非零的。\n-   **结论**：由于节点 $i=0$ 处的残差不为零，所以 $\\frac{d}{dt} u_0 \\neq 0$，解不是定常的。该格式不满足对于给定的初始剖面在每个节点上都有消失的残差这一条件。因此，它没有展示出接受一个错误的、定常解的特定失效模式。\n\n**结论：不正确**。\n\n**D. 使用守恒通量梯度的节点有限差分离散化...**\n\n-   **格式**：$\\frac{d}{dt} u_i + \\frac{\\tfrac{1}{2}u_{i+1}^2 - \\tfrac{1}{2}u_{i-1}^2}{2\\Delta x} = 0$。这可以写成 $\\frac{d}{dt} u_i + \\frac{F(u_{i+1}) - F(u_{i-1})}{2\\Delta x} = 0$。这是一个著名的*守恒*有限差分格式。而问题要求的是基于*非守恒*离散化的反例。\n-   **分析**：这个格式离散化了守恒形式 $\\partial_t u + \\partial_x F(u) = 0$。与格式 B 类似，由于它是守恒的，它应该能正确捕捉激波动力学（忽略稳定性问题，因为这个特定的中心格式是不稳定的）。选项本身就指出，更新项非零并推动间断前进，这是正确的物理行为，而不是一种失效。\n-   **结论**：这是一个守恒格式，而不是所要求的非守恒格式。此外，它不会产生一个静止的、不正确的解。因此，它在两个方面都不符合指定反例的要求。\n\n**结论：不正确**。\n\n最终评估确认，只有选项 A 正确地构造了一个满足所要求反例所有条件的场景：一个非守恒格式，它产生一个离散的定常解（逐点满足微分形式），而这个解在物理上是不正确的，因为它违反了积分守恒定律（错误的激波速度）。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "一个可靠的CFD求解器必须遵守基本的物理守恒定律。这项动手编程练习  将指导你实现一个全局守恒监视器，这是验证模拟结果完整性的关键工具。通过对整个计算域上的时间积分守恒定律进行数值评估，你可以量化模拟在多大程度上保持了质量、动量和能量的守恒，这是代码验证和质量保证中至关重要的一步。",
            "id": "3968178",
            "problem": "设计并实现一个程序，使用时间积分的积分守恒律来监测三维矩形控制体积内可压缩无粘性流体的全局质量、动量和总能量守恒。控制体积为整个计算域。你的程序必须仅使用守恒变量的基本定义、通过每个边界面（face）的无粘性欧拉通量以及指定的体积源，来计算两个快照之间单个时间步长上的时间积分平衡。\n\n从一个控制体积 $V$（其边界为 $\\partial V$）上带有体积源 $S$ 的守恒状态向量 $U$ 的积分守恒律开始：\n$$\n\\frac{d}{dt}\\int_V U \\, dV + \\int_{\\partial V} \\mathcal{F}(U)\\cdot \\hat{n} \\, dS = \\int_V S \\, dV,\n$$\n其中 $\\hat{n}$ 是外向单位法向量，$\\mathcal{F}(U)\\cdot \\hat{n}$ 是无粘性欧拉通量与外向法向量的点积。在时间区间 $[t_0,t_1]$ 上进行时间积分，得到精确的时间积分表达式\n$$\n\\left(\\int_V U \\, dV\\right)\\Big|_{t_1} - \\left(\\int_V U \\, dV\\right)\\Big|_{t_0} + \\int_{t_0}^{t_1}\\int_{\\partial V} \\mathcal{F}(U)\\cdot \\hat{n} \\, dS\\, dt = \\int_{t_0}^{t_1}\\int_V S \\, dV\\, dt.\n$$\n使用 $t_0$ 和 $t_1$ 时刻的数据，通过梯形法则来近似这两个时间积分。将全局残差向量 $R$（分量分别对应质量、三个动量分量和总能量）定义为\n$$\nR \\equiv \\left(Q_1 - Q_0\\right) + \\Delta t \\, \\overline{\\Phi} - \\Delta t \\, \\overline{\\Sigma},\n$$\n其中 $Q_k = \\int_V U(\\cdot,t_k)\\, dV$，$\\overline{\\Phi}$ 是所有面上时间平均的净向外表面通量，$\\overline{\\Sigma}$ 是在 $V$ 上积分的时间平均体积源，且 $\\Delta t = t_1 - t_0$。对于面积为 $A$、外向法向量为 $\\hat{n}=(n_x,n_y,n_z)$、在时刻 $t$ 的原始状态为 $(\\rho,u,v,w,p)$ 的面，使用理想气体状态方程的无粘性欧拉通量：\n- 定义 $u_n = u n_x + v n_y + w n_z$，\n- 定义比总能 $E = e + \\tfrac{1}{2}(u^2+v^2+w^2)$，其中 $e = \\dfrac{p}{(\\gamma-1)\\rho}$ 且比热比 $\\gamma$ 为常数，\n- 那么单位面积的通量向量为\n$$\n\\mathcal{F}(U)\\cdot \\hat{n} =\n\\begin{bmatrix}\n\\rho u_n \\\\\n\\rho u u_n + p n_x \\\\\n\\rho v u_n + p n_y \\\\\n\\rho w u_n + p n_z \\\\\n(\\rho E + p) u_n\n\\end{bmatrix}.\n$$\n对于每个面，计算 $t_0$ 和 $t_1$ 时刻的 $\\mathcal{F}$，进行时间平均，乘以面的面积 $A$，然后对所有面求和得到 $\\overline{\\Phi}$。对于体积源，给定单位体积的源向量 $S(\\cdot,t_0)$ 和 $S(\\cdot,t_1)$；将它们进行时间平均并乘以 $V$ 以获得 $\\overline{\\Sigma}$。\n\n根据内部状态计算每个时刻的全局积分守恒量为\n$$\nQ = \\int_V\n\\begin{bmatrix}\n\\rho \\\\\n\\rho u \\\\\n\\rho v \\\\\n\\rho w \\\\\n\\rho E\n\\end{bmatrix}\n\\, dV =\nV \\,\n\\begin{bmatrix}\n\\rho \\\\\n\\rho u \\\\\n\\rho v \\\\\n\\rho w \\\\\n\\rho E\n\\end{bmatrix},\n$$\n其中 $E$ 如上文所述从原始状态计算得出。\n\n为 $R$ 定义一个分量归一化误差，每个分量使用一个尺度因子\n$$\ns_i = \\max\\left( |Q_{0,i}|, |Q_{1,i}|, |\\Delta t\\, \\overline{\\Phi}_i|, |\\Delta t\\, \\overline{\\Sigma}_i|, 1 \\right),\n$$\n以及相对误差 $e_i = \\dfrac{|R_i|}{s_i}$。如果对于所有五个分量 $i$，\n$$\n|R_i| \\le \\tau_{\\text{abs}} \\quad \\text{or} \\quad e_i \\le \\tau_{\\text{rel}}\n$$\n都满足，则该案例被视为可接受。使用容差 $\\tau_{\\text{abs}} = 10^{-9}$ 和 $\\tau_{\\text{rel}} = 10^{-12}$。\n\n为以下三个科学上一致的测试案例实现此监测器。所有单位均为国际单位制 (SI)。不涉及角度单位。气体常数比为 $\\gamma = 1.4$。计算域是一个矩形盒子，尺寸为 $L_x=1.0\\,\\text{m}$，$L_y=0.5\\,\\text{m}$，$L_z=0.25\\,\\text{m}$，体积为 $V=L_x L_y L_z$，有六个平面：\n- $x=0$ 处的面：外向法向量 $\\hat{n}=(-1,0,0)$，面积 $A=L_y L_z$，\n- $x=L_x$ 处的面：外向法向量 $\\hat{n}=(1,0,0)$，面积 $A=L_y L_z$，\n- $y=0$ 处的面：外向法向量 $\\hat{n}=(0,-1,0)$，面积 $A=L_x L_z$，\n- $y=L_y$ 处的面：外向法向量 $\\hat{n}=(0,1,0)$，面积 $A=L_x L_z$，\n- $z=0$ 处的面：外向法向量 $\\hat{n}=(0,0,-1)$，面积 $A=L_x L_y$，\n- $z=L_z$ 处的面：外向法向量 $\\hat{n}=(0,0,1)$，面积 $A=L_x L_y$。\n\n对于下面的每个测试案例，$t_0$ 和 $t_1$ 时刻的内部原始状态是空间均匀的，并且提供了 $t_0$ 和 $t_1$ 时刻的边界面原始状态。体积源向量以单位体积的形式给出，为 $S = [S_{\\text{mass}}, S_{m_x}, S_{m_y}, S_{m_z}, S_E]$。\n\n测试套件：\n- 案例1（密封盒子，静态流体）：\n  - $\\Delta t = 0.1$，\n  - $t_0$ 和 $t_1$ 时刻的内部状态：$\\rho=1.2$，$u=0$，$v=0$，$w=0$，$p=101325$，\n  - $t_0$ 和 $t_1$ 时刻的边界面：与内部相同，代表绝热固壁（法向速度为零意味着对流质量和能量通量为零；压力项自动包含在内），\n  - $t_0$ 和 $t_1$ 时刻的源：$S=[0,0,0,0,0]$。\n- 案例2（x面开放、y面和z面滑移的稳定均匀通流）：\n  - $\\Delta t = 0.05$，\n  - $t_0$ 和 $t_1$ 时刻的内部状态：$\\rho=1.0$，$u=100$，$v=0$，$w=0$，$p=100000$，\n  - $t_0$ 和 $t_1$ 时刻的边界面：\n    - $x=0$ 和 $x=L_x$ 面的状态：与内部相同（开放边界），\n    - $y=0$、$y=L_y$、$z=0$、$z=L_z$ 面的状态：与内部相同（滑移壁面，由于 $\\hat{n}$ 与y或z方向垂直，法向速度为零），\n  - $t_0$ 和 $t_1$ 时刻的源：$S=[0,0,0,0,0]$。\n- 案例3（带均匀体积加热的密封盒子）：\n  - $\\Delta t = 0.02$，\n  - $t_0$ 时刻的内部状态：$\\rho=0.9$，$u=0$，$v=0$，$w=0$，$p=100000$，\n  - $t_0$ 和 $t_1$ 时刻的体积能量源：$S_E = 1000$，所有其他源分量为零，所以 $S=[0,0,0,0,1000]$，\n  - $t_1$ 时刻的内部状态：$\\rho=0.9$，$u=0$，$v=0$，$w=0$，$p = 100000 + (\\gamma-1) S_E \\Delta t$，\n  - $t_0$ 和 $t_1$ 时刻的边界面：与内部相同，代表绝热固壁。\n\n你的程序必须：\n1. 对于每个案例，通过梯形法则计算 $Q_0$、$Q_1$、时间平均的净向外边界通量 $\\overline{\\Phi}$ 以及时间平均的源积分 $\\overline{\\Sigma}$。\n2. 计算残差向量 $R$ 和分量归一化误差。\n3. 对于每个案例，返回一个布尔值，指示所有五个分量是否都满足容差标准 $|R_i| \\le \\tau_{\\text{abs}}$ 或 $|R_i|/s_i \\le \\tau_{\\text{rel}}$。\n\n最终输出格式：\n你的程序应生成单行输出，包含测试案例的三个布尔结果，形式为方括号内以逗号分隔的列表，例如，“[True,False,True]”。不应打印任何其他文本。\n\n所有物理参数必须以 SI 单位进行解释。输出不需要物理单位；仅需要布尔结果。",
            "solution": "该问题要求为三维矩形控制体积内的可压缩无粘性欧拉方程实现一个全局守恒监测器。守恒的验证是通过检查一个数值计算出的残差是否在指定容差范围内来进行的，该残差代表了时间积分守恒律中的不平衡量。该解决方案涉及直接应用问题陈述中提供的定义和数值近似方案。\n\n基本原理是在一个带有边界 $\\partial V$ 的控制体积 $V$ 内，对于一个守恒量向量 $U$ 的积分形式守恒律：\n$$\n\\frac{d}{dt}\\int_V U \\, dV + \\oint_{\\partial V} \\mathcal{F}(U)\\cdot \\hat{n} \\, dS = \\int_V S \\, dV\n$$\n在这里，$\\mathcal{F}(U)\\cdot \\hat{n}$ 是 $U$ 穿过带有外向法向量 $\\hat{n}$ 的边界的通量，$S$ 是一个体积源项。对于欧拉方程，状态向量 $U$ 和无粘性通量向量 $\\mathcal{F}(U)\\cdot \\hat{n}$ 是用原始变量来定义的：密度 $\\rho$、速度分量 $(u, v, w)$ 和压力 $p$。状态向量 $U$ 由下式给出：\n$$\nU = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ \\rho v \\\\ \\rho w \\\\ \\rho E \\end{bmatrix}\n$$\n其中 $\\rho E$ 是单位体积的总能量。对于理想气体，比总能 $E$ 是比内能 $e$ 和比动能之和：\n$$\nE = e + \\frac{1}{2}(u^2 + v^2 + w^2) = \\frac{p}{(\\gamma-1)\\rho} + \\frac{1}{2}(u^2 + v^2 + w^2)\n$$\n其中 $\\gamma$ 是比热比。\n\n通过一个外向法向量为 $\\hat{n} = (n_x, n_y, n_z)$ 的表面时，$U$ 的通量由下式给出：\n$$\n\\mathcal{F}(U)\\cdot \\hat{n} =\n\\begin{bmatrix}\n\\rho u_n \\\\\n\\rho u u_n + p n_x \\\\\n\\rho v u_n + p n_y \\\\\n\\rho w u_n + p n_z \\\\\n(\\rho E + p) u_n\n\\end{bmatrix}\n$$\n其中 $u_n = u n_x + v n_y + w n_z$ 是垂直于表面的速度分量。\n\n为了在一个时间步长 $\\Delta t = t_1 - t_0$ 上验证守恒，我们将守恒律从 $t_0$ 到 $t_1$ 进行时间积分：\n$$\n\\left(\\int_V U \\, dV\\right)\\Big|_{t_1} - \\left(\\int_V U \\, dV\\right)\\Big|_{t_0} + \\int_{t_0}^{t_1}\\left(\\oint_{\\partial V} \\mathcal{F}(U)\\cdot \\hat{n} \\, dS\\right) dt = \\int_{t_0}^{t_1}\\left(\\int_V S \\, dV\\right) dt\n$$\n令 $Q(t) = \\int_V U(\\cdot, t) \\, dV$ 为体积内守恒量的总量。由于问题指定内部流体状态是空间均匀的，该积分简化为 $Q(t) = U(t) \\cdot V$。方程变为：\n$$\nQ_1 - Q_0 + \\int_{t_0}^{t_1} \\Phi(t) \\, dt = \\int_{t_0}^{t_1} \\Sigma(t) \\, dt\n$$\n其中 $\\Phi(t) = \\oint_{\\partial V} \\mathcal{F}(U)\\cdot \\hat{n} \\, dS$ 是在时刻 $t$ 穿过整个边界 $\\partial V$ 的净向外通量，而 $\\Sigma(t) = \\int_V S \\, dV$ 是积分源项。问题陈述说明域是一个矩形盒子，所以 $\\Phi(t)$ 的面积分是六个平面的总和：$\\Phi(t) = \\sum_{j=1}^{6} (\\mathcal{F}_j \\cdot \\hat{n}_j) A_j$，其中通量 $\\mathcal{F}_j$ 是使用为面 $j$ 提供的状态来评估的。同样地，由于源 $S$ 是均匀的，$\\Sigma(t) = S(t) \\cdot V$。\n\n时间积分使用梯形法则进行近似：\n$$\n\\int_{t_0}^{t_1} f(t) \\, dt \\approx \\frac{f(t_0) + f(t_1)}{2} \\Delta t\n$$\n将此应用于通量项和源项，得到：\n$$\n\\int_{t_0}^{t_1} \\Phi(t) \\, dt \\approx \\frac{\\Phi_0 + \\Phi_1}{2} \\Delta t \\equiv \\overline{\\Phi} \\Delta t\n$$\n$$\n\\int_{t_0}^{t_1} \\Sigma(t) \\, dt \\approx \\frac{\\Sigma_0 + \\Sigma_1}{2} \\Delta t \\equiv \\overline{\\Sigma} \\Delta t\n$$\n残差向量 $R$ 被定义为这个离散化方程中的不平衡量：\n$$\nR \\equiv (Q_1 - Q_0) + \\Delta t \\, \\overline{\\Phi} - \\Delta t \\, \\overline{\\Sigma}\n$$\n对于与梯形法则一致的欧拉方程的精确解，此残差应为零。对于给定的测试案例，它们被构造为解析精确解（静态流体、稳定流和均匀加热），残差 $R$ 应在机器精度内为零。\n\n将要实现的算法，对于每个测试案例，将执行以下操作：\n1.  定义几何形状：体积 $V$ 和六个面及其面积 $A_j$ 和法向量 $\\hat{n}_j$。\n2.  使用提供的 $t_0$ 和 $t_1$ 时刻的内部原始状态 $(\\rho, u, v, w, p)$，计算积分守恒量 $Q_0$ 和 $Q_1$。这需要首先计算每个时刻的比总能 $E$。\n3.  计算时间平均净通量 $\\overline{\\Phi}$。这包括： a. 对于六个面中的每一个，使用提供的 $t_0$ 和 $t_1$ 时刻的边界原始状态，计算通量向量 $\\mathcal{F}_0 \\cdot \\hat{n}$ 和 $\\mathcal{F}_1 \\cdot \\hat{n}$。b. 将每个通量向量乘以相应的面面积，以获得在每个时刻通过该面的总通量。c. 将所有六个面的通量相加，得到总净通量向量 $\\Phi_0$ 和 $\\Phi_1$。d. 计算时间平均值 $\\overline{\\Phi} = (\\Phi_0 + \\Phi_1) / 2$。\n4.  计算时间平均积分源 $\\overline{\\Sigma}$。对于均匀的单位体积源 $S_0$ 和 $S_1$，这等于 $\\overline{\\Sigma} = V \\cdot (S_0 + S_1) / 2$。\n5.  计算五分量残差向量 $R = (Q_1 - Q_0) + \\Delta t \\overline{\\Phi} - \\Delta t \\overline{\\Sigma}$。\n6.  对于残差的每个分量 $i$，检查接受标准。这需要计算一个归一化尺度因子 $s_i$：\n    $$\n    s_i = \\max\\left( |Q_{0,i}|, |Q_{1,i}|, |\\Delta t\\, \\overline{\\Phi}_i|, |\\Delta t\\, \\overline{\\Sigma}_i|, 1.0 \\right)\n    $$\n    如果一个分量满足 $|R_i| \\le \\tau_{\\text{abs}}$ 或 $|R_i|/s_i \\le \\tau_{\\text{rel}}$，则该分量是可接受的，其中 $\\tau_{\\text{abs}} = 10^{-9}$ 且 $\\tau_{\\text{rel}} = 10^{-12}$。如果所有五个分量都可接受，则该案例通过。\n\n此过程将系统地应用于三个指定的测试案例。鉴于这些案例的构造方式，解析残差预计为零，因此数值检查应通过，所有案例的结果都为 `True`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the global conservation monitoring problem for three test cases.\n    \"\"\"\n\n    # Global constants\n    GAMMA = 1.4\n    TAU_ABS = 1e-9\n    TAU_REL = 1e-12\n\n    # Domain geometry\n    LX, LY, LZ = 1.0, 0.5, 0.25\n    V = LX * LY * LZ\n    \n    faces = [\n        {'name': 'x=0',   'normal': np.array([-1.0, 0.0, 0.0]), 'area': LY * LZ},\n        {'name': 'x=Lx',  'normal': np.array([1.0, 0.0, 0.0]),  'area': LY * LZ},\n        {'name': 'y=0',   'normal': np.array([0.0, -1.0, 0.0]), 'area': LX * LZ},\n        {'name': 'y=Ly',  'normal': np.array([0.0, 1.0, 0.0]),  'area': LX * LZ},\n        {'name': 'z=0',   'normal': np.array([0.0, 0.0, -1.0]), 'area': LX * LY},\n        {'name': 'z=Lz',  'normal': np.array([0.0, 0.0, 1.0]),  'area': LX * LY},\n    ]\n\n    # Test case definitions\n    test_cases = [\n        # Case 1: Sealed box, static fluid\n        {\n            'delta_t': 0.1,\n            'interior': {\n                't0': {'rho': 1.2, 'u': 0.0, 'v': 0.0, 'w': 0.0, 'p': 101325.0},\n                't1': {'rho': 1.2, 'u': 0.0, 'v': 0.0, 'w': 0.0, 'p': 101325.0},\n            },\n            'boundary': { # State for each face is specified\n                't0': {'rho': 1.2, 'u': 0.0, 'v': 0.0, 'w': 0.0, 'p': 101325.0},\n                't1': {'rho': 1.2, 'u': 0.0, 'v': 0.0, 'w': 0.0, 'p': 101325.0},\n            },\n            'source': {\n                't0': np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n                't1': np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n            },\n        },\n        # Case 2: Steady uniform throughflow\n        {\n            'delta_t': 0.05,\n            'interior': {\n                't0': {'rho': 1.0, 'u': 100.0, 'v': 0.0, 'w': 0.0, 'p': 100000.0},\n                't1': {'rho': 1.0, 'u': 100.0, 'v': 0.0, 'w': 0.0, 'p': 100000.0},\n            },\n            'boundary': {\n                't0': {'rho': 1.0, 'u': 100.0, 'v': 0.0, 'w': 0.0, 'p': 100000.0},\n                't1': {'rho': 1.0, 'u': 100.0, 'v': 0.0, 'w': 0.0, 'p': 100000.0},\n            },\n            'source': {\n                't0': np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n                't1': np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n            },\n        },\n        # Case 3: Sealed box, uniform heating\n        {\n            'delta_t': 0.02,\n            'interior': {\n                't0': {'rho': 0.9, 'u': 0.0, 'v': 0.0, 'w': 0.0, 'p': 100000.0},\n                't1': {\n                    'rho': 0.9,\n                    'u': 0.0,\n                    'v': 0.0,\n                    'w': 0.0,\n                    'p': 100000.0 + (GAMMA - 1) * 1000.0 * 0.02,\n                },\n            },\n            'boundary': { # Boundary state follows interior state\n                't0': {'rho': 0.9, 'u': 0.0, 'v': 0.0, 'w': 0.0, 'p': 100000.0},\n                't1': {\n                    'rho': 0.9,\n                    'u': 0.0,\n                    'v': 0.0,\n                    'w': 0.0,\n                    'p': 100000.0 + (GAMMA - 1) * 1000.0 * 0.02,\n                },\n            },\n            'source': {\n                't0': np.array([0.0, 0.0, 0.0, 0.0, 1000.0]),\n                't1': np.array([0.0, 0.0, 0.0, 0.0, 1000.0]),\n            },\n        },\n    ]\n\n    def compute_E(rho, u, v, w, p):\n        # Computes specific total energy\n        if rho == 0: return 0.0\n        e_internal = p / ((GAMMA - 1) * rho)\n        e_kinetic = 0.5 * (u**2 + v**2 + w**2)\n        return e_internal + e_kinetic\n\n    def compute_Q(state, V):\n        # Computes integrated conserved variables Q = U * V\n        rho, u, v, w, p = state['rho'], state['u'], state['v'], state['w'], state['p']\n        E_spec = compute_E(rho, u, v, w, p)\n        U = np.array([rho, rho * u, rho * v, rho * w, rho * E_spec])\n        return U * V\n\n    def compute_flux(state, normal):\n        # Computes inviscid Euler flux vector F dot n\n        rho, u, v, w, p = state['rho'], state['u'], state['v'], state['w'], state['p']\n        nx, ny, nz = normal[0], normal[1], normal[2]\n\n        vel = np.array([u, v, w])\n        u_n = np.dot(vel, normal)\n\n        E_spec = compute_E(rho, u, v, w, p)\n        \n        flux = np.zeros(5)\n        flux[0] = rho * u_n\n        flux[1] = rho * u * u_n + p * nx\n        flux[2] = rho * v * u_n + p * ny\n        flux[3] = rho * w * u_n + p * nz\n        flux[4] = (rho * E_spec + p) * u_n\n        return flux\n\n    results = []\n    for case in test_cases:\n        dt = case['delta_t']\n\n        # Compute Q0 and Q1\n        Q0 = compute_Q(case['interior']['t0'], V)\n        Q1 = compute_Q(case['interior']['t1'], V)\n\n        # Compute net fluxes Phi_0 and Phi_1\n        Phi0 = np.zeros(5)\n        Phi1 = np.zeros(5)\n        \n        # State on boundary face is uniform for each case\n        b_state_t0 = case['boundary']['t0']\n        b_state_t1 = case['boundary']['t1']\n        \n        for face in faces:\n            flux0 = compute_flux(b_state_t0, face['normal'])\n            flux1 = compute_flux(b_state_t1, face['normal'])\n            Phi0 += flux0 * face['area']\n            Phi1 += flux1 * face['area']\n\n        # Compute time-averaged net flux\n        Phi_bar = 0.5 * (Phi0 + Phi1)\n\n        # Compute time-averaged integrated source\n        S0, S1 = case['source']['t0'], case['source']['t1']\n        Sigma_bar = V * 0.5 * (S0 + S1)\n\n        # Compute residual\n        R = (Q1 - Q0) + dt * Phi_bar - dt * Sigma_bar\n\n        # Check acceptance criterion\n        case_passes = True\n        \n        dt_Phi_bar = dt * Phi_bar\n        dt_Sigma_bar = dt * Sigma_bar\n        \n        for i in range(5):\n            s_i = max(abs(Q0[i]), abs(Q1[i]), abs(dt_Phi_bar[i]), abs(dt_Sigma_bar[i]), 1.0)\n            \n            abs_err = abs(R[i])\n            rel_err = abs_err / s_i if s_i != 0 else 0\n            \n            if not (abs_err = TAU_ABS or rel_err = TAU_REL):\n                case_passes = False\n                break\n        \n        results.append(case_passes)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}