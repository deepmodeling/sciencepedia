{
    "hands_on_practices": [
        {
            "introduction": "The integral conservation laws are the bedrock of fluid dynamics, providing the most fundamental description of flows, especially those containing discontinuities like shock waves. This practice challenges you to connect this abstract foundation to a concrete physical phenomenon by applying the integral form of the Euler equations to a control volume enclosing a normal shock. By executing this derivation, you will obtain the celebrated Rankine–Hugoniot relations, providing exact algebraic connections between the fluid properties across the discontinuity and solidifying your understanding of how integral laws govern discontinuous solutions. ",
            "id": "3968210",
            "problem": "Consider a steady, planar, normal shock of negligible thickness in an inviscid, calorically perfect gas with constant ratio of specific heats $\\gamma$. The shock is at rest in the inertial frame, and the upstream state ($1$) is uniform with velocity $u_1$, density $\\rho_1$, pressure $p_1$, and temperature $T_1$. The downstream state ($2$) is uniform with velocity $u_2$, density $\\rho_2$, pressure $p_2$, and temperature $T_2$. The gas obeys the ideal-gas equation of state $p = \\rho R T$, where $R$ is the specific gas constant, and the thermodynamic enthalpy is $h = c_p T$ with $c_p = \\gamma R / (\\gamma - 1)$. The upstream Mach number is $M_1 = u_1 / a_1$, where $a_1 = \\sqrt{\\gamma R T_1}$ is the upstream speed of sound. Assume no heat addition and no shaft work across the shock.\n\nStarting from the integral forms of the Euler equations for mass, momentum, and energy applied to a fixed control volume enclosing the shock, and reducing them to jump conditions by invoking the planar symmetry and steady state, derive the Rankine–Hugoniot relations that connect the upstream and downstream states. Eliminate intermediate variables to obtain closed-form expressions for the following dimensionless ratios entirely in terms of $M_1$ and $\\gamma$:\n- the density ratio $\\rho_2 / \\rho_1$,\n- the pressure ratio $p_2 / p_1$,\n- the temperature ratio $T_2 / T_1$.\n\nExpress your final result as a single row matrix $\\begin{pmatrix} \\rho_2 / \\rho_1 \\;  \\; p_2 / p_1 \\;  \\; T_2 / T_1 \\end{pmatrix}$ in terms of $M_1$ and $\\gamma$. No units are required. Provide exact analytic expressions; do not approximate or round.",
            "solution": "The problem statement is a standard derivation in gas dynamics and is scientifically grounded, well-posed, objective, and complete. It is therefore deemed valid. We proceed with the derivation.\n\nThe analysis begins with the integral form of the Euler equations for a fixed control volume $V$ with surface $S$. For a steady flow ($\\frac{\\partial}{\\partial t} = 0$), these conservation laws are:\nMass conservation:\n$$ \\oint_S \\rho \\mathbf{u} \\cdot \\mathbf{n} \\, dS = 0 $$\nMomentum conservation:\n$$ \\oint_S (\\rho \\mathbf{u} (\\mathbf{u} \\cdot \\mathbf{n}) + p \\mathbf{n}) \\, dS = 0 $$\nEnergy conservation:\n$$ \\oint_S \\rho H_t \\mathbf{u} \\cdot \\mathbf{n} \\, dS = 0 $$\nwhere $\\rho$ is the density, $\\mathbf{u}$ is the velocity vector, $\\mathbf{n}$ is the outward-pointing unit normal to the surface $S$, $p$ is the pressure, and $H_t$ is the total specific enthalpy, defined as $H_t = h + \\frac{1}{2}|\\mathbf{u}|^2$.\n\nWe apply these laws to a control volume that is a thin rectangular box enclosing the planar normal shock. The flow is one-dimensional along the x-axis, so $\\mathbf{u} = u \\hat{\\mathbf{i}}$. The control volume has two faces of area $A$ perpendicular to the flow, one upstream (state $1$) and one downstream (state $2$). The other faces are parallel to the flow, so the flux through them is zero. The problem states that the properties are uniform on the upstream and downstream faces.\n\nFor the upstream face (1), $\\mathbf{n} = -\\hat{\\mathbf{i}}$, so $\\mathbf{u} \\cdot \\mathbf{n} = -u_1$.\nFor the downstream face (2), $\\mathbf{n} = +\\hat{\\mathbf{i}}$, so $\\mathbf{u} \\cdot \\mathbf{n} = u_2$.\n\nApplying these conditions to the integral laws reduces them to algebraic jump conditions across the shock:\nMass:\n$$ -\\rho_1 u_1 A + \\rho_2 u_2 A = 0 \\implies \\rho_1 u_1 = \\rho_2 u_2 $$\nMomentum:\n$$ -(\\rho_1 u_1^2 + p_1) A + (\\rho_2 u_2^2 + p_2) A = 0 \\implies p_1 + \\rho_1 u_1^2 = p_2 + \\rho_2 u_2^2 $$\nEnergy:\n$$ -(\\rho_1 u_1 H_{t1}) A + (\\rho_2 u_2 H_{t2}) A = 0 \\implies \\rho_1 u_1 H_{t1} = \\rho_2 u_2 H_{t2} $$\nUsing the mass conservation result, the energy equation simplifies to the statement that total enthalpy is conserved across the shock:\n$$ H_{t1} = H_{t2} \\implies h_1 + \\frac{1}{2}u_1^2 = h_2 + \\frac{1}{2}u_2^2 $$\n\nWe have three fundamental Rankine-Hugoniot jump conditions:\n1.  $\\rho_1 u_1 = \\rho_2 u_2$\n2.  $p_1 + \\rho_1 u_1^2 = p_2 + \\rho_2 u_2^2$\n3.  $h_1 + \\frac{1}{2}u_1^2 = h_2 + \\frac{1}{2}u_2^2$\n\nWe now manipulate these equations using the given thermodynamic relations for a calorically perfect gas: $h = c_p T = \\frac{\\gamma R}{\\gamma-1}T = \\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho}$ and the definition of the speed of sound $a = \\sqrt{\\gamma R T} = \\sqrt{\\gamma p / \\rho}$. The upstream Mach number is $M_1 = u_1/a_1$.\n\nFrom the momentum equation (2):\n$$ p_2 - p_1 = \\rho_1 u_1^2 - \\rho_2 u_2^2 $$\nUsing mass conservation (1), we can write $\\rho_2 u_2^2 = (\\rho_2 u_2)u_2 = (\\rho_1 u_1)u_2$:\n$$ p_2 - p_1 = \\rho_1 u_1 u_1 - (\\rho_1 u_1) u_2 = \\rho_1 u_1 (u_1 - u_2) $$\nAlso from (1), $u_2 = \\frac{\\rho_1}{\\rho_2} u_1$. Substituting this into the previous equation gives a relation between the pressure and density ratios:\n$$ p_2 - p_1 = \\rho_1 u_1 (u_1 - \\frac{\\rho_1}{\\rho_2} u_1) = \\rho_1 u_1^2 (1 - \\frac{\\rho_1}{\\rho_2}) $$\nDividing by $p_1$ and using the definition $a_1^2 = \\gamma p_1 / \\rho_1$, we have:\n$$ \\frac{p_2}{p_1} - 1 = \\frac{\\rho_1 u_1^2}{p_1} \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) = \\frac{\\gamma u_1^2}{a_1^2} \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) = \\gamma M_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) $$\nLet's label this as Eq. (A):\n$$ \\frac{p_2}{p_1} = 1 + \\gamma M_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) $$\n\nNext, we use the energy equation (3), substituting $h = \\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho}$:\n$$ \\frac{\\gamma}{\\gamma-1}\\frac{p_1}{\\rho_1} + \\frac{1}{2}u_1^2 = \\frac{\\gamma}{\\gamma-1}\\frac{p_2}{\\rho_2} + \\frac{1}{2}u_2^2 $$\nRearranging gives:\n$$ \\frac{\\gamma}{\\gamma-1} \\left(\\frac{p_2}{\\rho_2} - \\frac{p_1}{\\rho_1}\\right) = \\frac{1}{2}(u_1^2 - u_2^2) = \\frac{1}{2}u_1^2\\left(1 - \\left(\\frac{u_2}{u_1}\\right)^2\\right) $$\nUsing $u_2/u_1 = \\rho_1/\\rho_2$ from mass conservation:\n$$ \\frac{\\gamma}{\\gamma-1} \\left(\\frac{p_2}{\\rho_2} - \\frac{p_1}{\\rho_1}\\right) = \\frac{1}{2}u_1^2\\left(1 - \\left(\\frac{\\rho_1}{\\rho_2}\\right)^2\\right) $$\nDivide the entire equation by $\\frac{p_1}{\\rho_1} = \\frac{a_1^2}{\\gamma}$:\n$$ \\frac{\\gamma}{\\gamma-1} \\left(\\frac{p_2}{p_1}\\frac{\\rho_1}{\\rho_2} - 1\\right) = \\frac{1}{2}\\frac{u_1^2}{p_1/\\rho_1} \\left(1 - \\left(\\frac{\\rho_1}{\\rho_2}\\right)^2\\right) = \\frac{1}{2}\\frac{\\gamma u_1^2}{a_1^2} \\left(1 - \\left(\\frac{\\rho_1}{\\rho_2}\\right)^2\\right) $$\n$$ \\frac{1}{\\gamma-1} \\left(\\frac{p_2}{p_1}\\frac{\\rho_1}{\\rho_2} - 1\\right) = \\frac{1}{2} M_1^2 \\left(1 - \\left(\\frac{\\rho_1}{\\rho_2}\\right)^2\\right) $$\nLet's label this as Eq. (B). Now we solve the system of two equations, (A) and (B), for the ratios $\\rho_2/\\rho_1$ and $p_2/p_1$. Substitute Eq. (A) into Eq. (B):\n$$ \\frac{1}{\\gamma-1} \\left[ \\left(1 + \\gamma M_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right)\\right)\\frac{\\rho_1}{\\rho_2} - 1 \\right] = \\frac{1}{2} M_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right)\\left(1 + \\frac{\\rho_1}{\\rho_2}\\right) $$\nLet $x = \\rho_1/\\rho_2$ for algebraic simplicity. A physical shock requires $x \\neq 1$.\n$$ \\frac{1}{\\gamma-1} \\left[ (1 + \\gamma M_1^2 (1-x))x - 1 \\right] = \\frac{1}{2} M_1^2 (1-x^2) $$\n$$ \\frac{1}{\\gamma-1} \\left[ x + \\gamma M_1^2 (x-x^2) - 1 \\right] = \\frac{1}{2} M_1^2 (1-x)(1+x) $$\n$$ \\frac{1}{\\gamma-1} \\left[ -(1-x) + \\gamma M_1^2 x(1-x) \\right] = \\frac{1}{2} M_1^2 (1-x)(1+x) $$\nSince $x \\neq 1$, we can divide by $(1-x)$:\n$$ \\frac{1}{\\gamma-1} \\left[ -1 + \\gamma M_1^2 x \\right] = \\frac{1}{2} M_1^2 (1+x) $$\nMultiply by $2(\\gamma-1)$:\n$$ -2 + 2\\gamma M_1^2 x = (\\gamma-1)M_1^2(1+x) $$\n$$ -2 + 2\\gamma M_1^2 x = (\\gamma-1)M_1^2 + (\\gamma-1)M_1^2 x $$\nGroup terms with $x$:\n$$ x [2\\gamma M_1^2 - (\\gamma-1)M_1^2] = 2 + (\\gamma-1)M_1^2 $$\n$$ x [(\\gamma+1)M_1^2] = 2 + (\\gamma-1)M_1^2 $$\n$$ x = \\frac{\\rho_1}{\\rho_2} = \\frac{(\\gamma-1)M_1^2 + 2}{(\\gamma+1)M_1^2} $$\nInverting this expression yields the density ratio:\n$$ \\frac{\\rho_2}{\\rho_1} = \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2 + 2} $$\n\nNow, substitute this result back into Eq. (A) to find the pressure ratio:\n$$ \\frac{p_2}{p_1} = 1 + \\gamma M_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) = 1 + \\gamma M_1^2 \\left(1 - \\frac{(\\gamma-1)M_1^2 + 2}{(\\gamma+1)M_1^2}\\right) $$\n$$ \\frac{p_2}{p_1} = 1 + \\gamma M_1^2 \\left(\\frac{(\\gamma+1)M_1^2 - ((\\gamma-1)M_1^2 + 2)}{(\\gamma+1)M_1^2}\\right) $$\n$$ \\frac{p_2}{p_1} = 1 + \\gamma M_1^2 \\left(\\frac{2M_1^2 - 2}{(\\gamma+1)M_1^2}\\right) = 1 + \\frac{2\\gamma(M_1^2 - 1)}{\\gamma+1} $$\nCombining the terms over a common denominator:\n$$ \\frac{p_2}{p_1} = \\frac{(\\gamma+1) + 2\\gamma(M_1^2 - 1)}{\\gamma+1} = \\frac{\\gamma+1 + 2\\gamma M_1^2 - 2\\gamma}{\\gamma+1} $$\n$$ \\frac{p_2}{p_1} = \\frac{2\\gamma M_1^2 - (\\gamma-1)}{\\gamma+1} $$\n\nFinally, the temperature ratio is found using the ideal gas law, $p = \\rho R T$, which implies $\\frac{T_2}{T_1} = \\frac{p_2}{p_1} \\frac{\\rho_1}{\\rho_2}$:\n$$ \\frac{T_2}{T_1} = \\left(\\frac{2\\gamma M_1^2 - (\\gamma-1)}{\\gamma+1}\\right) \\left(\\frac{(\\gamma-1)M_1^2 + 2}{(\\gamma+1)M_1^2}\\right) $$\nThis can be written as a single fraction:\n$$ \\frac{T_2}{T_1} = \\frac{\\left(2\\gamma M_1^2 - (\\gamma-1)\\right)\\left((\\gamma-1)M_1^2 + 2\\right)}{(\\gamma+1)^2 M_1^2} $$\n\nThese three expressions give the downstream-to-upstream ratios for density, pressure, and temperature across a normal shock as functions of only the upstream Mach number $M_1$ and the ratio of specific heats $\\gamma$.",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2 + 2}  \\frac{2\\gamma M_1^2 - (\\gamma-1)}{\\gamma+1}  \\frac{(2\\gamma M_1^2 - (\\gamma-1))((\\gamma-1)M_1^2 + 2)}{(\\gamma+1)^2 M_1^2} \\end{pmatrix}} $$"
        },
        {
            "introduction": "A crucial insight in the numerical solution of conservation laws is that the mathematical equivalence between the integral and differential forms holds only for smooth, continuous solutions. This equivalence breaks down at shocks, and a numerical scheme must be based on the correct form to yield physically valid results. This exercise asks you to analyze a classic counterexample using the Burgers' equation, where a seemingly plausible scheme based on the nonconservative differential form fails to predict the correct shock motion. Completing this analysis will provide a definitive, hands-on understanding of why the conservative form of the equations is non-negotiable for shock-capturing CFD. ",
            "id": "3968234",
            "problem": "Consider the scalar, inviscid Burgers' equation, a canonical nonlinear advection law used in computational fluid dynamics (CFD):\n$$\n\\partial_t u + \\partial_x \\left(\\tfrac{1}{2} u^2 \\right) = 0,\n$$\nposed on a uniform grid with spacing $\\Delta x$ and nodal locations $x_i$. Let the initial data be a Riemann step with a single discontinuity,\n$$\nu(x,0) = \\begin{cases}\nu_L,  x  0,\\\\\nu_R,  x  0,\n\\end{cases}\n$$\nwith $u_L > u_R \\ge 0$ so that a shock forms. A discrete scheme that enforces the differential form $\\partial_t u + u\\,\\partial_x u = 0$ pointwise at nodes may not enforce the integral conservation across discontinuities. Your task is to identify a concrete discretization-and-configuration that serves as a counterexample: it yields a discrete solution that satisfies the pointwise differential form at all nodes, yet it violates the integral conservation across the shock (for example, by producing the wrong shock speed or a stationary discontinuity when the physically correct solution requires motion).\n\nStart from the governing integral conservation principle over a moving control volume and its associated Rankine–Hugoniot jump condition, and use these fundamentals to reason which option provides a valid counterexample. All numerical and physical parameters must be scientifically consistent.\n\nWhich option correctly constructs such a counterexample?\n\nA. Use the nonconservative, differential-form, upwind finite-difference scheme\n$$\n\\frac{d}{dt} u_i + u_i\\,D_x u_i = 0,\n$$\nwith the one-sided derivative\n$$\nD_x u_i = \n\\begin{cases}\n\\frac{u_i - u_{i-1}}{\\Delta x},  u_i  0, \\\\[6pt]\n\\frac{u_{i+1} - u_i}{\\Delta x},  u_i  0, \\\\[6pt]\n0,  u_i = 0,\n\\end{cases}\n$$\nand choose $u_L = 1$, $u_R = 0$, with the discontinuity aligned exactly at the face $x_{1/2}$ between nodes $i=0$ and $i=1$, i.e.,\n$$\nu_i(0) = \\begin{cases}\n1,  i \\le 0,\\\\\n0,  i \\ge 1.\n\\end{cases}\n$$\nFor this configuration, the discrete residual at every node vanishes, so the scheme admits a stationary discontinuity, even though the physically correct integral jump condition requires a nonzero shock speed.\n\nB. Use a conservative finite-volume semi-discrete scheme\n$$\n\\frac{d}{dt} \\bar{u}_i + \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x} = 0,\n$$\nwith a consistent monotone numerical flux $F_{i+1/2} = F\\!\\left(u_L^{i+1/2},u_R^{i+1/2}\\right)$ computed from left and right states at faces via exact or approximate Riemann solutions, and set $u_L = 1$, $u_R = 0$ with the discontinuity initially at $x_{1/2}$. The scheme produces the shock motion demanded by the integral jump condition.\n\nC. Use the nonconservative central-difference discretization of the differential form\n$$\n\\frac{d}{dt} u_i + u_i\\,\\frac{u_{i+1} - u_{i-1}}{2\\Delta x} = 0,\n$$\nwith $u_L = 1$, $u_R = 0$, and place the discontinuity exactly at node $i=0$ so that $u_0(0)$ is undefined in the continuum but assigned numerically either $u_L$ or $u_R$. The central stencil necessarily couples values from opposite sides of the discontinuity, producing nonzero residuals near the jump.\n\nD. Use a nodal finite-difference discretization of the conservative flux gradient\n$$\n\\frac{d}{dt} u_i + \\frac{\\tfrac{1}{2}u_{i+1}^2 - \\tfrac{1}{2}u_{i-1}^2}{2\\Delta x} = 0,\n$$\nwith $u_L = 1$, $u_R = 0$, and the discontinuity at $x_{1/2}$. The nodal update near the jump is nonzero, advancing the discontinuity, consistent with the integral jump condition.\n\nSelect the option that truly demonstrates a nonconservative discretization satisfying the differential form pointwise while violating the integral balance across the shock.",
            "solution": "The problem statement is parsed and validated as follows.\n\n### Step 1: Extract Givens\n-   **Governing Equation (Conservative Form)**: $\\partial_t u + \\partial_x \\left(\\tfrac{1}{2} u^2 \\right) = 0$, the scalar, inviscid Burgers' equation.\n-   **Governing Equation (Nonconservative Form)**: $\\partial_t u + u\\,\\partial_x u = 0$.\n-   **Grid**: Uniform, spacing $\\Delta x$, nodal locations $x_i$.\n-   **Initial Condition**: A Riemann problem (step-discontinuity) defined by\n    $$\n    u(x,0) = \\begin{cases}\n    u_L,  x  0,\\\\\n    u_R,  x  0,\n    \\end{cases}\n    $$\n-   **Shock Condition**: $u_L  u_R \\ge 0$, which ensures the formation of a shock wave, not a rarefaction wave.\n-   **Task**: Identify a numerical scheme and initial data configuration that serves as a specific type of counterexample.\n-   **Counterexample Definition**: The scheme must (1) discretize the nonconservative differential form, (2) satisfy this differential form pointwise at all nodes (implying a stationary solution where time derivatives are zero), and (3) violate the integral conservation law, for instance by yielding an incorrect shock speed.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is based on the inviscid Burgers equation, a fundamental and widely studied nonlinear partial differential equation in fluid dynamics and applied mathematics. It correctly distinguishes between the conservative and nonconservative forms, a critical concept for solutions with discontinuities (shocks). The use of the Rankine–Hugoniot condition to determine the correct shock speed is standard and correct. All concepts are central to the theory of hyperbolic conservation laws and their numerical solution in CFD. The problem is scientifically sound.\n2.  **Well-Posed**: The problem asks to identify, from a list of options, a specific configuration that demonstrates a known failure mode of certain numerical schemes. The criteria for this failure are clearly and precisely defined. The task is unambiguous and has a single correct answer based on established theory.\n3.  **Objective**: The problem is stated in precise, technical language common to numerical analysis and CFD. It is free from ambiguity, subjectivity, or non-scientific claims.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It presents a clear, well-posed, and scientifically correct question. The solution process will now proceed.\n\n### Derivation from First Principles\nThe fundamental principle governing the system is the integral form of the conservation law. For any control volume $[x_a, x_b]$, the rate of change of the total quantity of $u$ within the volume is equal to the net flux across its boundaries:\n$$\n\\frac{d}{dt} \\int_{x_a}^{x_b} u(x,t) \\, dx = F(u(x_a,t)) - F(u(x_b,t))\n$$\nwhere $F(u) = \\frac{1}{2}u^2$ is the flux function for Burgers' equation.\n\nFor a discontinuous solution (a shock) propagating with speed $s = dx_s/dt$, this integral principle yields the Rankine–Hugoniot (R-H) jump condition, which relates the shock speed to the states on either side of the discontinuity ($u_L$ and $u_R$):\n$$\ns = \\frac{F(u_R) - F(u_L)}{u_R - u_L}\n$$\nFor Burgers' equation, this becomes:\n$$\ns = \\frac{\\frac{1}{2}u_R^2 - \\frac{1}{2}u_L^2}{u_R - u_L} = \\frac{\\frac{1}{2}(u_R - u_L)(u_R + u_L)}{u_R - u_L} = \\frac{u_L + u_R}{2}\n$$\nThe problem specifies using initial values like $u_L=1$ and $u_R=0$. For these values, the physically correct shock speed is:\n$$\ns = \\frac{1 + 0}{2} = \\frac{1}{2}\n$$\nA physically correct numerical solution must capture a shock propagating to the right with speed $s=1/2$. A counterexample, as requested, would be a scheme that produces a stationary shock ($s=0$) while appearing to satisfy the pointwise differential equation $\\partial_t u + u \\partial_x u = 0$. A stationary solution corresponds to the time derivative term being zero, which implies the discrete spatial operator must evaluate to zero at all grid points for the initial data.\n\nWe will now analyze each option to see if it constructs such a counterexample.\n\n### Option-by-Option Analysis\n\n**A. Use the nonconservative, differential-form, upwind finite-difference scheme...**\n\n-   **Scheme**: $\\frac{d}{dt} u_i + u_i\\,D_x u_i = 0$, where $D_x u_i$ is a one-sided upwind-biased difference operator. This discretizes the nonconservative form $\\partial_t u + u \\partial_x u = 0$.\n-   **Initial Data**: $u_L = 1$, $u_R = 0$. The discontinuity is placed at the cell face $x_{1/2}$, so the nodal values are $u_i = 1$ for $i \\le 0$ and $u_i = 0$ for $i \\ge 1$.\n-   **Analysis**: We must check if the discrete spatial residual, $R_i = u_i D_x u_i$, is zero for all nodes $i$. If so, then $\\frac{d}{dt} u_i = -R_i = 0$ for all $i$, and the discrete solution is stationary.\n    -   For any node $i$ with $i  0$: $u_i = 1$ and $u_{i-1} = 1$. Since $u_i = 1  0$, the upwind stencil is $D_x u_i = \\frac{u_i - u_{i-1}}{\\Delta x} = \\frac{1 - 1}{\\Delta x} = 0$. The residual is $R_i = u_i D_x u_i = 1 \\cdot 0 = 0$.\n    -   At node $i=0$: $u_0 = 1$ and $u_{-1} = 1$. Since $u_0 = 1  0$, the stencil is $D_x u_0 = \\frac{u_0 - u_{-1}}{\\Delta x} = \\frac{1 - 1}{\\Delta x} = 0$. The residual is $R_0 = u_0 D_x u_0 = 1 \\cdot 0 = 0$.\n    -   At node $i=1$: $u_1 = 0$. According to the scheme's definition, if $u_i = 0$, then $D_x u_i = 0$. The residual is $R_1 = u_1 D_x u_1 = 0 \\cdot 0 = 0$.\n    -   For any node $i  1$: $u_i = 0$. Again, $D_x u_i = 0$, and the residual is $R_i = u_i D_x u_i = 0 \\cdot 0 = 0$.\n-   **Conclusion**: For this specific configuration, the discrete residual is identically zero at every node. This means the scheme admits the stationary step profile as an exact, time-invariant solution. The numerical shock speed is $s_{\\text{num}} = 0$. This directly contradicts the R-H condition which demands a shock speed of $s = 1/2$. Therefore, this scheme, which discretizes the nonconservative form, satisfies the differential equation pointwise (in a discrete sense) but fails to uphold the integral conservation law across the discontinuity.\n\n**Verdict: Correct**. This option provides a perfect counterexample as required.\n\n**B. Use a conservative finite-volume semi-discrete scheme...**\n\n-   **Scheme**: $\\frac{d}{dt} \\bar{u}_i + \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x} = 0$. This is, by definition, a conservative scheme.\n-   **Analysis**: The Lax-Wendroff theorem states that if a numerical scheme in conservation form converges, it converges to a weak solution of the PDE, which correctly satisfies the jump conditions. Conservative schemes are specifically designed to ensure that the total quantity $\\sum_i u_i \\Delta x$ is conserved (up to boundary fluxes), which in turn leads to the correct shock speeds. The option correctly states that such a scheme will produce the proper shock motion.\n-   **Conclusion**: This describes a method that works correctly, not one that fails. It is not a counterexample.\n\n**Verdict: Incorrect**.\n\n**C. Use the nonconservative central-difference discretization...**\n\n-   **Scheme**: $\\frac{d}{dt} u_i + u_i\\,\\frac{u_{i+1} - u_{i-1}}{2\\Delta x} = 0$. This is a nonconservative scheme using a central difference for the spatial derivative.\n-   **Initial Data**: The discontinuity is placed *at* a node, $i=0$. Let's test the configuration $u_{i0}=1$, $u_0=1$, $u_{i0}=0$.\n-   **Analysis**: We check the residual $R_i = u_i\\,\\frac{u_{i+1} - u_{i-1}}{2\\Delta x}$ near the jump.\n    -   At node $i=0$: $u_{-1}=1$, $u_0=1$, $u_1=0$. The residual is $R_0 = 1 \\cdot \\frac{0 - 1}{2\\Delta x} = -\\frac{1}{2\\Delta x}$. This is nonzero.\n-   **Conclusion**: Since the residual at node $i=0$ is nonzero, $\\frac{d}{dt} u_0 \\neq 0$, and the solution is not stationary. The scheme does not satisfy the condition of having a vanishing residual at every node for the given initial profile. Therefore, it does not demonstrate the specific failure mode of admitting a wrong, stationary solution.\n\n**Verdict: Incorrect**.\n\n**D. Use a nodal finite-difference discretization of the conservative flux gradient...**\n\n-   **Scheme**: $\\frac{d}{dt} u_i + \\frac{\\tfrac{1}{2}u_{i+1}^2 - \\tfrac{1}{2}u_{i-1}^2}{2\\Delta x} = 0$. This can be written as $\\frac{d}{dt} u_i + \\frac{F(u_{i+1}) - F(u_{i-1})}{2\\Delta x} = 0$. This is a well-known *conservative* finite difference scheme. The problem asks for a counterexample based on a *nonconservative* discretization.\n-   **Analysis**: This scheme discretizes the conservative form $\\partial_t u + \\partial_x F(u) = 0$. Like scheme B, because it is conservative, it is expected to capture the shock dynamics correctly (ignoring stability issues, as this particular central scheme is unstable). The option itself states that the update is nonzero and advances the discontinuity, which is the correct physical behavior, not a failure.\n-   **Conclusion**: This is a conservative scheme, not a nonconservative one as required. Furthermore, it does not produce a stationary, incorrect solution. It therefore fails on two counts to be the specified counterexample.\n\n**Verdict: Incorrect**.\n\nFinal evaluation confirms that only Option A correctly constructs a scenario that satisfies all the conditions for the requested counterexample: a nonconservative scheme that produces a discrete stationary solution (pointwise differential form satisfied), which is physically incorrect as it violates the integral conservation law (wrong shock speed).",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "In any practical CFD simulation, errors arising from discretization, numerical approximation, and finite-precision arithmetic can potentially violate the fundamental conservation principles the simulation is meant to uphold. Therefore, a key skill for any CFD practitioner is the ability to verify that a code is correctly conserving mass, momentum, and energy. This hands-on coding practice guides you through the implementation of a global conservation monitor, a utility that performs a \"conservation audit\" by rigorously checking the balance between the change in conserved quantities, the fluxes through the domain boundaries, and any sources. Mastering this practice provides you with an essential tool for code validation and debugging. ",
            "id": "3968178",
            "problem": "Design and implement a program that monitors global conservation of mass, momentum, and total energy for a compressible inviscid fluid in a three-dimensional rectangular control volume using the time-integrated integral conservation laws. The control volume is the entire computational domain. Your program must compute the time-integrated balance over a single time step between two snapshots, using only the fundamental definitions of the conserved variables, the inviscid Euler flux through each boundary face, and prescribed volumetric sources.\n\nStart from the integral conservation law for a conserved state vector $U$ with volumetric source $S$ over a control volume $V$ with boundary $\\partial V$:\n$$\n\\frac{d}{dt}\\int_V U \\, dV + \\int_{\\partial V} \\mathcal{F}(U)\\cdot \\hat{n} \\, dS = \\int_V S \\, dV,\n$$\nwhere $\\hat{n}$ is the outward unit normal and $\\mathcal{F}(U)\\cdot \\hat{n}$ is the inviscid Euler flux dotted with the outward normal. Integrate in time over an interval $[t_0,t_1]$ to obtain the exact time-integrated statement\n$$\n\\left(\\int_V U \\, dV\\right)\\Big|_{t_1} - \\left(\\int_V U \\, dV\\right)\\Big|_{t_0} + \\int_{t_0}^{t_1}\\int_{\\partial V} \\mathcal{F}(U)\\cdot \\hat{n} \\, dS\\, dt = \\int_{t_0}^{t_1}\\int_V S \\, dV\\, dt.\n$$\nApproximate the two time integrals with the trapezoidal rule using data at $t_0$ and $t_1$. Define the global residual vector $R$ (one component each for mass, the three momentum components, and total energy) as\n$$\nR \\equiv \\left(Q_1 - Q_0\\right) + \\Delta t \\, \\overline{\\Phi} - \\Delta t \\, \\overline{\\Sigma},\n$$\nwhere $Q_k = \\int_V U(\\cdot,t_k)\\, dV$, $\\overline{\\Phi}$ is the time-averaged net outward surface flux over all faces, $\\overline{\\Sigma}$ is the time-averaged volumetric source integrated over $V$, and $\\Delta t = t_1 - t_0$. Use the inviscid Euler flux with perfect gas equation of state for the flux through a face with area $A$, outward normal $\\hat{n}=(n_x,n_y,n_z)$, and primitive state $(\\rho,u,v,w,p)$ at time $t$:\n- Define $u_n = u n_x + v n_y + w n_z$,\n- Define specific total energy $E = e + \\tfrac{1}{2}(u^2+v^2+w^2)$ with $e = \\dfrac{p}{(\\gamma-1)\\rho}$ and constant ratio of specific heats $\\gamma$,\n- Then the per-unit-area flux vector is\n$$\n\\mathcal{F}(U)\\cdot \\hat{n} =\n\\begin{bmatrix}\n\\rho u_n \\\\\n\\rho u u_n + p n_x \\\\\n\\rho v u_n + p n_y \\\\\n\\rho w u_n + p n_z \\\\\n(\\rho E + p) u_n\n\\end{bmatrix}.\n$$\nFor each face, compute $\\mathcal{F}$ at $t_0$ and $t_1$, average in time, multiply by the face area $A$, and sum over all faces to get $\\overline{\\Phi}$. For volumetric sources, you are given per-volume source vectors $S(\\cdot,t_0)$ and $S(\\cdot,t_1)$; average them in time and multiply by $V$ to obtain $\\overline{\\Sigma}$.\n\nCompute the global integrated conserved quantities at each time from the interior state as\n$$\nQ = \\int_V\n\\begin{bmatrix}\n\\rho \\\\\n\\rho u \\\\\n\\rho v \\\\\n\\rho w \\\\\n\\rho E\n\\end{bmatrix}\n\\, dV =\nV \\,\n\\begin{bmatrix}\n\\rho \\\\\n\\rho u \\\\\n\\rho v \\\\\n\\rho w \\\\\n\\rho E\n\\end{bmatrix},\n$$\nwhere $E$ is computed from the primitive state as above.\n\nDefine a componentwise normalized error for $R$ using a scale for each component\n$$\ns_i = \\max\\left( |Q_{0,i}|, |Q_{1,i}|, |\\Delta t\\, \\overline{\\Phi}_i|, |\\Delta t\\, \\overline{\\Sigma}_i|, 1 \\right),\n$$\nand the relative error $e_i = \\dfrac{|R_i|}{s_i}$. A case is deemed acceptable if for all five components $i$,\n$$\n|R_i| \\le \\tau_{\\text{abs}} \\quad \\text{or} \\quad e_i \\le \\tau_{\\text{rel}}.\n$$\nUse tolerances $\\tau_{\\text{abs}} = 10^{-9}$ and $\\tau_{\\text{rel}} = 10^{-12}$.\n\nImplement this monitor for the following three scientifically consistent test cases. All units are International System of Units (SI). No angle units are involved. Gas constant ratio is $\\gamma = 1.4$. The computational domain is a rectangular box with dimensions $L_x=1.0\\,\\text{m}$, $L_y=0.5\\,\\text{m}$, $L_z=0.25\\,\\text{m}$, volume $V=L_x L_y L_z$, and six planar faces:\n- Face at $x=0$: outward normal $\\hat{n}=(-1,0,0)$, area $A=L_y L_z$,\n- Face at $x=L_x$: outward normal $\\hat{n}=(1,0,0)$, area $A=L_y L_z$,\n- Face at $y=0$: outward normal $\\hat{n}=(0,-1,0)$, area $A=L_x L_z$,\n- Face at $y=L_y$: outward normal $\\hat{n}=(0,1,0)$, area $A=L_x L_z$,\n- Face at $z=0$: outward normal $\\hat{n}=(0,0,-1)$, area $A=L_x L_y$,\n- Face at $z=L_z$: outward normal $\\hat{n}=(0,0,1)$, area $A=L_x L_y$.\n\nFor each test case below, the interior primitive state at $t_0$ and $t_1$ is spatially uniform, and the boundary face primitive states at $t_0$ and $t_1$ are provided. Volumetric source vectors are given per unit volume as $S = [S_{\\text{mass}}, S_{m_x}, S_{m_y}, S_{m_z}, S_E]$.\n\nTest Suite:\n- Case 1 (sealed box, static fluid):\n  - $\\Delta t = 0.1$,\n  - Interior at $t_0$ and $t_1$: $\\rho=1.2$, $u=0$, $v=0$, $w=0$, $p=101325$,\n  - Boundary faces at $t_0$ and $t_1$: same as interior, representing adiabatic solid walls (zero normal velocity implies zero convective mass and energy flux; pressure terms are included automatically),\n  - Sources at $t_0$ and $t_1$: $S=[0,0,0,0,0]$.\n- Case 2 (steady uniform throughflow with open x-faces, slip on y- and z-faces):\n  - $\\Delta t = 0.05$,\n  - Interior at $t_0$ and $t_1$: $\\rho=1.0$, $u=100$, $v=0$, $w=0$, $p=100000$,\n  - Boundary faces at $t_0$ and $t_1$:\n    - $x=0$ and $x=L_x$ faces: same as interior (open boundaries),\n    - $y=0$, $y=L_y$, $z=0$, $z=L_z$ faces: same as interior (slip walls with zero normal velocity because $\\hat{n}$ is normal to $y$ or $z$),\n  - Sources at $t_0$ and $t_1$: $S=[0,0,0,0,0]$.\n- Case 3 (sealed box with uniform volumetric heating):\n  - $\\Delta t = 0.02$,\n  - Interior at $t_0$: $\\rho=0.9$, $u=0$, $v=0$, $w=0$, $p=100000$,\n  - Volumetric energy source at $t_0$ and $t_1$: $S_E = 1000$, and all other source components zero, so $S=[0,0,0,0,1000]$,\n  - Interior at $t_1$: $\\rho=0.9$, $u=0$, $v=0$, $w=0$, $p = 100000 + (\\gamma-1) S_E \\Delta t$,\n  - Boundary faces at $t_0$ and $t_1$: same as interior, representing adiabatic solid walls.\n\nYour program must:\n1. Compute $Q_0$, $Q_1$, the time-averaged net outward boundary flux $\\overline{\\Phi}$ via the trapezoidal rule, and the time-averaged source integral $\\overline{\\Sigma}$ for each case.\n2. Compute the residual vector $R$ and the componentwise normalized errors.\n3. For each case, return a boolean indicating whether all five components satisfy the tolerance criterion $|R_i| \\le \\tau_{\\text{abs}}$ or $|R_i|/s_i \\le \\tau_{\\text{rel}}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the three boolean results for the test cases, as a comma-separated list enclosed in square brackets, for example, \"[True,False,True]\". No other text should be printed.\n\nAll physical parameters must be interpreted in SI units. No output requires physical units; only boolean results are required.",
            "solution": "The problem requires the implementation of a global conservation monitor for the compressible inviscid Euler equations in a three-dimensional rectangular control volume. The validation of conservation is performed by checking if a numerically computed residual, representing the imbalance in the time-integrated conservation law, is within specified tolerances. The solution involves a direct application of the definitions and numerical approximation schemes provided in the problem statement.\n\nThe fundamental principle is the integral form of the conservation laws for a conserved quantity vector $U$ within a control volume $V$ with boundary $\\partial V$:\n$$\n\\frac{d}{dt}\\int_V U \\, dV + \\oint_{\\partial V} \\mathcal{F}(U)\\cdot \\hat{n} \\, dS = \\int_V S \\, dV\n$$\nHere, $\\mathcal{F}(U)\\cdot \\hat{n}$ is the flux of $U$ across the boundary with outward normal $\\hat{n}$, and $S$ is a volumetric source term. For the Euler equations, the state vector $U$ and the inviscid flux vector $\\mathcal{F}(U)\\cdot \\hat{n}$ are defined in terms of the primitive variables: density $\\rho$, velocity components $(u, v, w)$, and pressure $p$. The state vector $U$ is given by:\n$$\nU = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ \\rho v \\\\ \\rho w \\\\ \\rho E \\end{bmatrix}\n$$\nwhere $\\rho E$ is the total energy per unit volume. The specific total energy $E$ for a perfect gas is the sum of specific internal energy $e$ and specific kinetic energy:\n$$\nE = e + \\frac{1}{2}(u^2 + v^2 + w^2) = \\frac{p}{(\\gamma-1)\\rho} + \\frac{1}{2}(u^2 + v^2 + w^2)\n$$\nwith $\\gamma$ being the ratio of specific heats.\n\nThe flux of $U$ through a surface with outward normal $\\hat{n} = (n_x, n_y, n_z)$ is given by:\n$$\n\\mathcal{F}(U)\\cdot \\hat{n} =\n\\begin{bmatrix}\n\\rho u_n \\\\\n\\rho u u_n + p n_x \\\\\n\\rho v u_n + p n_y \\\\\n\\rho w u_n + p n_z \\\\\n(\\rho E + p) u_n\n\\end{bmatrix}\n$$\nwhere $u_n = u n_x + v n_y + w n_z$ is the component of the velocity normal to the surface.\n\nTo verify conservation over a time step $\\Delta t = t_1 - t_0$, we integrate the conservation law in time from $t_0$ to $t_1$:\n$$\n\\left(\\int_V U \\, dV\\right)\\Big|_{t_1} - \\left(\\int_V U \\, dV\\right)\\Big|_{t_0} + \\int_{t_0}^{t_1}\\left(\\oint_{\\partial V} \\mathcal{F}(U)\\cdot \\hat{n} \\, dS\\right) dt = \\int_{t_0}^{t_1}\\left(\\int_V S \\, dV\\right) dt\n$$\nLet $Q(t) = \\int_V U(\\cdot, t) \\, dV$ be the total amount of the conserved quantity in the volume. Since the problem specifies that the interior fluid state is spatially uniform, this integral simplifies to $Q(t) = U(t) \\cdot V$. The equation becomes:\n$$\nQ_1 - Q_0 + \\int_{t_0}^{t_1} \\Phi(t) \\, dt = \\int_{t_0}^{t_1} \\Sigma(t) \\, dt\n$$\nwhere $\\Phi(t) = \\oint_{\\partial V} \\mathcal{F}(U)\\cdot \\hat{n} \\, dS$ is the net outward flux across the entire boundary $\\partial V$ at time $t$, and $\\Sigma(t) = \\int_V S \\, dV$ is the integrated source term. The problem states that the domain is a rectangular box, so the surface integral for $\\Phi(t)$ is a sum over the six planar faces: $\\Phi(t) = \\sum_{j=1}^{6} (\\mathcal{F}_j \\cdot \\hat{n}_j) A_j$, where the flux $\\mathcal{F}_j$ is evaluated using the state provided for face $j$. Similarly, since the source $S$ is uniform, $\\Sigma(t) = S(t) \\cdot V$.\n\nThe time integrals are approximated using the trapezoidal rule:\n$$\n\\int_{t_0}^{t_1} f(t) \\, dt \\approx \\frac{f(t_0) + f(t_1)}{2} \\Delta t\n$$\nApplying this to the flux and source terms yields:\n$$\n\\int_{t_0}^{t_1} \\Phi(t) \\, dt \\approx \\frac{\\Phi_0 + \\Phi_1}{2} \\Delta t \\equiv \\overline{\\Phi} \\Delta t\n$$\n$$\n\\int_{t_0}^{t_1} \\Sigma(t) \\, dt \\approx \\frac{\\Sigma_0 + \\Sigma_1}{2} \\Delta t \\equiv \\overline{\\Sigma} \\Delta t\n$$\nThe residual vector $R$ is defined as the imbalance in this discretized equation:\n$$\nR \\equiv (Q_1 - Q_0) + \\Delta t \\, \\overline{\\Phi} - \\Delta t \\, \\overline{\\Sigma}\n$$\nFor an exact solution to the Euler equations that is consistent with the trapezoidal rule, this residual would be zero. For the given test cases, which are constructed to be analytically exact solutions (static fluid, steady flow, and uniform heating), the residual $R$ should be zero to within machine precision.\n\nThe algorithm to be implemented will, for each test case:\n1.  Define the geometry: Volume $V$ and the six faces with their areas $A_j$ and normals $\\hat{n}_j$.\n2.  Using the provided interior primitive states $(\\rho, u, v, w, p)$ at $t_0$ and $t_1$, compute the integrated conserved quantities $Q_0$ and $Q_1$. This requires first calculating the specific total energy $E$ at each time.\n3.  Compute the time-averaged net flux $\\overline{\\Phi}$. This involves:\n    a. For each of the six faces, using the provided boundary primitive states at $t_0$ and $t_1$, calculate the flux vectors $\\mathcal{F}_0 \\cdot \\hat{n}$ and $\\mathcal{F}_1 \\cdot \\hat{n}$.\n    b. Multiply each flux vector by the corresponding face area to get the total flux through that face at each time.\n    c. Sum the fluxes from all six faces to get the total net flux vectors $\\Phi_0$ and $\\Phi_1$.\n    d. Compute the time average $\\overline{\\Phi} = (\\Phi_0 + \\Phi_1) / 2$.\n4.  Compute the time-averaged integrated source $\\overline{\\Sigma}$. With uniform per-volume sources $S_0$ and $S_1$, this is $\\overline{\\Sigma} = V \\cdot (S_0 + S_1) / 2$.\n5.  Calculate the five-component residual vector $R = (Q_1 - Q_0) + \\Delta t \\overline{\\Phi} - \\Delta t \\overline{\\Sigma}$.\n6.  For each component $i$ of the residual, check the acceptance criterion. This requires computing a normalization scale $s_i$:\n    $$\n    s_i = \\max\\left( |Q_{0,i}|, |Q_{1,i}|, |\\Delta t\\, \\overline{\\Phi}_i|, |\\Delta t\\, \\overline{\\Sigma}_i|, 1.0 \\right)\n    $$\n    A component is acceptable if $|R_i| \\le \\tau_{\\text{abs}}$ or $|R_i|/s_i \\le \\tau_{\\text{rel}}$, with $\\tau_{\\text{abs}} = 10^{-9}$ and $\\tau_{\\text{rel}} = 10^{-12}$. The case passes if all five components are acceptable.\n\nThis procedure will be systematically applied to the three specified test cases. Given the construction of these cases, the analytical residual is expected to be zero, so the numerical check should pass, resulting in `True` for all cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the global conservation monitoring problem for three test cases.\n    \"\"\"\n\n    # Global constants\n    GAMMA = 1.4\n    TAU_ABS = 1e-9\n    TAU_REL = 1e-12\n\n    # Domain geometry\n    LX, LY, LZ = 1.0, 0.5, 0.25\n    V = LX * LY * LZ\n    \n    faces = [\n        {'name': 'x=0',   'normal': np.array([-1.0, 0.0, 0.0]), 'area': LY * LZ},\n        {'name': 'x=Lx',  'normal': np.array([1.0, 0.0, 0.0]),  'area': LY * LZ},\n        {'name': 'y=0',   'normal': np.array([0.0, -1.0, 0.0]), 'area': LX * LZ},\n        {'name': 'y=Ly',  'normal': np.array([0.0, 1.0, 0.0]),  'area': LX * LZ},\n        {'name': 'z=0',   'normal': np.array([0.0, 0.0, -1.0]), 'area': LX * LY},\n        {'name': 'z=Lz',  'normal': np.array([0.0, 0.0, 1.0]),  'area': LX * LY},\n    ]\n\n    # Test case definitions\n    test_cases = [\n        # Case 1: Sealed box, static fluid\n        {\n            'delta_t': 0.1,\n            'interior': {\n                't0': {'rho': 1.2, 'u': 0.0, 'v': 0.0, 'w': 0.0, 'p': 101325.0},\n                't1': {'rho': 1.2, 'u': 0.0, 'v': 0.0, 'w': 0.0, 'p': 101325.0},\n            },\n            'boundary': { # State for each face is specified\n                't0': {'rho': 1.2, 'u': 0.0, 'v': 0.0, 'w': 0.0, 'p': 101325.0},\n                't1': {'rho': 1.2, 'u': 0.0, 'v': 0.0, 'w': 0.0, 'p': 101325.0},\n            },\n            'source': {\n                't0': np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n                't1': np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n            },\n        },\n        # Case 2: Steady uniform throughflow\n        {\n            'delta_t': 0.05,\n            'interior': {\n                't0': {'rho': 1.0, 'u': 100.0, 'v': 0.0, 'w': 0.0, 'p': 100000.0},\n                't1': {'rho': 1.0, 'u': 100.0, 'v': 0.0, 'w': 0.0, 'p': 100000.0},\n            },\n            'boundary': {\n                't0': {'rho': 1.0, 'u': 100.0, 'v': 0.0, 'w': 0.0, 'p': 100000.0},\n                't1': {'rho': 1.0, 'u': 100.0, 'v': 0.0, 'w': 0.0, 'p': 100000.0},\n            },\n            'source': {\n                't0': np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n                't1': np.array([0.0, 0.0, 0.0, 0.0, 0.0]),\n            },\n        },\n        # Case 3: Sealed box, uniform heating\n        {\n            'delta_t': 0.02,\n            'interior': {\n                't0': {'rho': 0.9, 'u': 0.0, 'v': 0.0, 'w': 0.0, 'p': 100000.0},\n                't1': {\n                    'rho': 0.9,\n                    'u': 0.0,\n                    'v': 0.0,\n                    'w': 0.0,\n                    'p': 100000.0 + (GAMMA - 1) * 1000.0 * 0.02,\n                },\n            },\n            'boundary': { # Boundary state follows interior state\n                't0': {'rho': 0.9, 'u': 0.0, 'v': 0.0, 'w': 0.0, 'p': 100000.0},\n                't1': {\n                    'rho': 0.9,\n                    'u': 0.0,\n                    'v': 0.0,\n                    'w': 0.0,\n                    'p': 100000.0 + (GAMMA - 1) * 1000.0 * 0.02,\n                },\n            },\n            'source': {\n                't0': np.array([0.0, 0.0, 0.0, 0.0, 1000.0]),\n                't1': np.array([0.0, 0.0, 0.0, 0.0, 1000.0]),\n            },\n        },\n    ]\n\n    def compute_E(rho, u, v, w, p):\n        # Computes specific total energy\n        if rho == 0: return 0.0\n        e_internal = p / ((GAMMA - 1) * rho)\n        e_kinetic = 0.5 * (u**2 + v**2 + w**2)\n        return e_internal + e_kinetic\n\n    def compute_Q(state, V):\n        # Computes integrated conserved variables Q = U * V\n        rho, u, v, w, p = state['rho'], state['u'], state['v'], state['w'], state['p']\n        E_spec = compute_E(rho, u, v, w, p)\n        U = np.array([rho, rho * u, rho * v, rho * w, rho * E_spec])\n        return U * V\n\n    def compute_flux(state, normal):\n        # Computes inviscid Euler flux vector F dot n\n        rho, u, v, w, p = state['rho'], state['u'], state['v'], state['w'], state['p']\n        nx, ny, nz = normal[0], normal[1], normal[2]\n\n        vel = np.array([u, v, w])\n        u_n = np.dot(vel, normal)\n\n        E_spec = compute_E(rho, u, v, w, p)\n        \n        flux = np.zeros(5)\n        flux[0] = rho * u_n\n        flux[1] = rho * u * u_n + p * nx\n        flux[2] = rho * v * u_n + p * ny\n        flux[3] = rho * w * u_n + p * nz\n        flux[4] = (rho * E_spec + p) * u_n\n        return flux\n\n    results = []\n    for case in test_cases:\n        dt = case['delta_t']\n\n        # Compute Q0 and Q1\n        Q0 = compute_Q(case['interior']['t0'], V)\n        Q1 = compute_Q(case['interior']['t1'], V)\n\n        # Compute net fluxes Phi_0 and Phi_1\n        Phi0 = np.zeros(5)\n        Phi1 = np.zeros(5)\n        \n        # State on boundary face is uniform for each case\n        b_state_t0 = case['boundary']['t0']\n        b_state_t1 = case['boundary']['t1']\n        \n        for face in faces:\n            flux0 = compute_flux(b_state_t0, face['normal'])\n            flux1 = compute_flux(b_state_t1, face['normal'])\n            Phi0 += flux0 * face['area']\n            Phi1 += flux1 * face['area']\n\n        # Compute time-averaged net flux\n        Phi_bar = 0.5 * (Phi0 + Phi1)\n\n        # Compute time-averaged integrated source\n        S0, S1 = case['source']['t0'], case['source']['t1']\n        Sigma_bar = V * 0.5 * (S0 + S1)\n\n        # Compute residual\n        R = (Q1 - Q0) + dt * Phi_bar - dt * Sigma_bar\n\n        # Check acceptance criterion\n        case_passes = True\n        \n        dt_Phi_bar = dt * Phi_bar\n        dt_Sigma_bar = dt * Sigma_bar\n        \n        for i in range(5):\n            s_i = max(abs(Q0[i]), abs(Q1[i]), abs(dt_Phi_bar[i]), abs(dt_Sigma_bar[i]), 1.0)\n            \n            abs_err = abs(R[i])\n            rel_err = abs_err / s_i if s_i != 0 else 0\n            \n            if not (abs_err = TAU_ABS or rel_err = TAU_REL):\n                case_passes = False\n                break\n        \n        results.append(case_passes)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}