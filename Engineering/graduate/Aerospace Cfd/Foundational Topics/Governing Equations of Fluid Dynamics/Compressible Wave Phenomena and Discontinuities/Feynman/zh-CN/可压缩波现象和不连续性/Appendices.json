{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在提供应用朗金-雨贡纽关系的基础实践。通过从跨越间断面的质量守恒原理出发，您将推导并应用激波速度的计算公式。激波速度是连接激波上游和下游状态的基本参数，掌握这一技能对于分析和预测可压缩流中的激波现象至关重要。",
            "id": "3948139",
            "problem": "在计算流体动力学（CFD）中，通常使用无粘一维欧拉方程来模拟气体中的一维平面压缩激波。考虑一个激波分隔开两种均匀定常状态，分别表示为左侧状态 $\\left(\\rho_{L}, u_{L}, p_{L}\\right)$ 和右侧状态 $\\left(\\rho_{R}, u_{R}, p_{R}\\right)$，其中 $\\rho$ 是密度，$u$ 是实验室坐标系中的流速，$p$ 是热力学压力。该间断（激波）以未知的激波速度 $s$ 沿 $x$ 轴正方向传播。左侧状态代表上游流，右侧状态代表下游流。假设在激波固定坐标系中间断是平面的且定常的，并且流动是无粘、绝热的，没有体积力。\n\n从跨越移动间断的质量守恒积分形式出发，利用垂直于激波的质量通量 $m$ 是连续的这一事实，其在激波两侧由 $m = \\rho \\left(u - s\\right)$ 给出。推导仅用 $\\rho_{L}$、$u_{L}$、$\\rho_{R}$ 和 $u_{R}$ 表示的激波速度 $s$ 的显式解析表达式。然后，对以下给定的左、右数值状态计算 $s$：\n- $\\rho_{L} = 1.1~\\mathrm{kg/m^{3}}$, $u_{L} = 80~\\mathrm{m/s}$, $p_{L} = 1.00 \\times 10^{5}~\\mathrm{Pa}$,\n- $\\rho_{R} = 3.5~\\mathrm{kg/m^{3}}$, $u_{R} = 260~\\mathrm{m/s}$, $p_{R} = 1.51975 \\times 10^{5}~\\mathrm{Pa}$。\n\n将最终的激波速度数值答案以 $\\mathrm{m/s}$ 为单位表示，并四舍五入到四位有效数字。您必须提供一个单一的最终数字作为您的答案。",
            "solution": "该问题要求推导激波速度 $s$ 的解析表达式，并随后进行数值计算。推导从跨越移动间断的质量守恒原理开始。\n\n问题陈述了垂直于激波的质量通量 $m$ 是连续的。质量通量在实验室坐标系中相对于移动激波定义为 $m = \\rho(u-s)$，其中 $\\rho$ 是密度，$u$ 是实验室坐标系中的流体速度，$s$ 是激波的传播速度。跨越激波的质量通量连续性意味着 $m$ 的值在间断的上游（左侧，下标 $L$）和下游（右侧，下标 $R$）两侧是相同的。\n\n这给出了控制关系：\n$$m_{L} = m_{R}$$\n代入给定的质量通量表达式，我们得到：\n$$\\rho_{L} (u_{L} - s) = \\rho_{R} (u_{R} - s)$$\n\n这个方程是朗金-雨贡纽关系式之一，特别是针对质量守恒的关系式。为了求出激波速度 $s$ 的显式表达式，我们必须对这个方程进行代数整理。首先，我们展开方程的两边：\n$$\\rho_{L} u_{L} - \\rho_{L} s = \\rho_{R} u_{R} - \\rho_{R} s$$\n\n接下来，我们将所有包含未知变量 $s$ 的项聚集到方程的一边，所有其他项聚集到另一边。\n$$\\rho_{R} s - \\rho_{L} s = \\rho_{R} u_{R} - \\rho_{L} u_{L}$$\n\n我们可以从左边的项中提出因子 $s$：\n$$s (\\rho_{R} - \\rho_{L}) = \\rho_{R} u_{R} - \\rho_{L} u_{L}$$\n\n最后，我们通过除以 $(\\rho_{R} - \\rho_{L})$ 项来分离出 $s$。这是允许的，因为对于激波，存在密度跳跃，所以 $\\rho_{R} \\neq \\rho_{L}$。具体来说，对于压缩激波，$\\rho_{R} > \\rho_{L}$，所以分母不为零。\n$$s = \\frac{\\rho_{R} u_{R} - \\rho_{L} u_{L}}{\\rho_{R} - \\rho_{L}}$$\n\n这就是所要求的仅用 $\\rho_{L}$、$u_{L}$、$\\rho_{R}$ 和 $u_{R}$ 表示的激波速度 $s$ 的显式解析表达式。请注意，根据问题陈述，此特定推导不需要压力值 $p_L$ 和 $p_R$。\n\n现在，我们使用提供的数值来计算这个表达式：\n- $\\rho_{L} = 1.1~\\mathrm{kg/m^{3}}$\n- $u_{L} = 80~\\mathrm{m/s}$\n- $\\rho_{R} = 3.5~\\mathrm{kg/m^{3}}$\n- $u_{R} = 260~\\mathrm{m/s}$\n\n我们首先计算表达式的分子，它代表动量通量 $\\rho u$ 的差值：\n$$\\rho_{R} u_{R} - \\rho_{L} u_{L} = (3.5)(260) - (1.1)(80)$$\n$$\\rho_{R} u_{R} - \\rho_{L} u_{L} = 910 - 88 = 822~\\mathrm{kg/(m^2 \\cdot s)}$$\n\n接下来，我们计算分母，即密度的变化：\n$$\\rho_{R} - \\rho_{L} = 3.5 - 1.1 = 2.4~\\mathrm{kg/m^3}$$\n\n现在我们可以计算激波速度 $s$：\n$$s = \\frac{822}{2.4} = 342.5~\\mathrm{m/s}$$\n\n问题要求最终答案四舍五入到四位有效数字。计算值 $342.5$ 已经恰好是四位有效数字。因此，不需要进一步的四舍五入。\n激波速度为 $s = 342.5~\\mathrm{m/s}$。正号表示激波沿 $x$ 轴正方向传播，与问题描述一致。",
            "answer": "$$\\boxed{342.5}$$"
        },
        {
            "introduction": "黎曼问题是理解波现象和构建现代数值格式的基石。本问题展示了一个特殊情况——一个纯粹的接触间断面，它考验您能否认识到初始压力和速度的无差异会消除非线性的激波和稀疏波。解决这个问题将加深您对欧拉方程解中不同波类型背后物理驱动因素的理解。",
            "id": "3948142",
            "problem": "考虑量热完全气体的一维可压缩欧拉方程，其比热比 $\\gamma$ 为常数，写成关于密度 $\\rho$、动量 $\\rho u$ 和总能量 $\\rho E$ 的守恒律形式，\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix}\n\\rho \\\\\n\\rho u \\\\\n\\rho E\n\\end{pmatrix}\n+\n\\frac{\\partial}{\\partial x}\n\\begin{pmatrix}\n\\rho u \\\\\n\\rho u^{2} + p \\\\\nu(\\rho E + p)\n\\end{pmatrix}\n= \\mathbf{0},\n$$\n并带有理想气体封闭关系 $p = (\\gamma-1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$。\n\n提出一个黎曼问题，其初始数据为\n$$\n(\\rho, u, p)(x,0) =\n\\begin{cases}\n(\\rho_{L},\\, u_{L},\\, p_{L}),  x  0, \\\\\n(\\rho_{R},\\, u_{R},\\, p_{R}),  x > 0,\n\\end{cases}\n$$\n对于一种 $\\gamma = 1.4$ 的气体。左态为 $\\rho_{L} = 1.5 \\,\\text{kg}\\,\\text{m}^{-3}$，$u_{L} = 2.30 \\times 10^{2} \\,\\text{m}\\,\\text{s}^{-1}$，$p_{L} = 1.20 \\times 10^{5} \\,\\text{Pa}$，右态为 $\\rho_{R} = 0.30 \\,\\text{kg}\\,\\text{m}^{-3}$，$u_{R} = 2.30 \\times 10^{2} \\,\\text{m}\\,\\text{s}^{-1}$，$p_{R} = 1.20 \\times 10^{5} \\,\\text{Pa}$。因此，两侧的压力和速度相等，而密度不同。\n\n使用从可压缩欧拉方程和相关波族推导出的精确黎曼求解器结构，确定共同的中间态速度 $u^{*}$、共同的中间态压力 $p^{*}$ 以及接触间断传播的接触波速度 $S_{c}$。速度值以 $\\text{m}\\,\\text{s}^{-1}$ 表示，压力以 $\\text{Pa}$ 表示。将所有报告的量四舍五入到四位有效数字。最终答案必须以单行矩阵的形式提供，按顺序包含 $u^{*}$、$p^{*}$ 和 $S_{c}$。",
            "solution": "该问题提出了一个针对量热完全气体的一维可压缩欧拉方程的黎曼问题。初始状态由两个均匀区域组成，一个左态 $(L)$ 和一个右态 $(R)$，在 $x=0$ 处由一个间断隔开。控制方程为\n$$\n\\frac{\\partial}{\\partial t} \\mathbf{U} + \\frac{\\partial}{\\partial x} \\mathbf{F}(\\mathbf{U}) = \\mathbf{0},\n$$\n其中状态向量 $\\mathbf{U}$ 和通量向量 $\\mathbf{F}(\\mathbf{U})$ 为\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}, \\quad \\mathbf{F}(\\mathbf{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(\\rho E + p) \\end{pmatrix}.\n$$\n该系统由量热完全气体的状态方程 $p = (\\gamma-1)(\\rho E - \\frac{1}{2}\\rho u^{2})$ 封闭，其中比热比给定为 $\\gamma = 1.4$。\n\n在时间 $t=0$ 时的初始条件为\n$$\n(\\rho, u, p)(x,0) =\n\\begin{cases}\n(\\rho_{L},\\, u_{L},\\, p_{L}) = (1.5, 2.30 \\times 10^{2}, 1.20 \\times 10^{5}),  x  0, \\\\\n(\\rho_{R},\\, u_{R},\\, p_{R}) = (0.30, 2.30 \\times 10^{2}, 1.20 \\times 10^{5}),  x > 0,\n\\end{cases}\n$$\n其中单位为国际单位制。\n\n黎曼问题的解是自相似的，仅依赖于变量 $\\xi = x/t$。解的结构由一组从原点传播的波组成，这些波分隔开常数状态的区域。对于欧拉方程，通用解包含一个左行波、一个接触间断和一个右行波。这些波将初始的左态和右态与两个中间态分开，分别表示为左星态 $(\\rho_{L}^{*}, u_{L}^{*}, p_{L}^{*})$ 和右星态 $(\\rho_{R}^{*}, u_{R}^{*}, p_{R}^{*})$。\n\n穿过接触间断时，压力和速度是连续的。这为中间态提供了关键的匹配条件：\n$$\nu_{L}^{*} = u_{R}^{*} \\equiv u^{*}\n$$\n$$\np_{L}^{*} = p_{R}^{*} \\equiv p^{*}\n$$\n然而，密度在接触面上通常是不连续的，即 $\\rho_{L}^{*} \\neq \\rho_{R}^{*}$。接触间断以等于当地流体速度的速度 $S_{c}$ 传播，即 $S_{c} = u^{*}$。\n\n左行波和右行波可以是激波或稀疏波。波的类型由其两端的压力变化决定。中间态速度 $u^{*}$ 和压力 $p^{*}$ 是通过适当的波关系将初始态 $(L)$ 和 $(R)$ 连接到它们各自的星态，然后应用匹配条件来找到的。\n\n让我们分析所提供的具体初始数据。一个关键的观察是，初始速度和压力都相等：\n$$\nu_{L} = u_{R} = 2.30 \\times 10^{2} \\,\\text{m}\\,\\text{s}^{-1}\n$$\n$$\np_{L} = p_{R} = 1.20 \\times 10^{5} \\,\\text{Pa}\n$$\n非线性波（激波和稀疏波）是由相邻状态之间的压力和速度差异产生的。星区的速度 $u^{*}$ 是星区压力 $p^{*}$ 和初始状态数据的函数。对于左侧，$u_{L}^{*} = f(p^{*}, \\rho_{L}, u_{L}, p_{L})$，对于右侧，$u_{R}^{*} = g(p^{*}, \\rho_{R}, u_{R}, p_{R})$。目标是找到一个 $p^{*}$ 使得 $u_{L}^{*} = u_{R}^{*}$。\n\n让我们提出了一个试探解，其中中间压力 $p^{*}$ 等于初始压力，即 $p^{*} = p_{L} = p_{R}$。\n对于左波，如果 $p^{*} = p_{L}$，则没有压力跳跃。这对应于一个零强度的波。因此，所有流动性质在该“波”的两侧保持不变。这意味着：\n$$\np_{L}^{*} = p_{L}\n$$\n$$\nu_{L}^{*} = u_{L}\n$$\n类似地，对于右波，如果 $p^{*} = p_{R}$，则没有压力跳跃，且该波强度为零。这意味着：\n$$\np_{R}^{*} = p_{R}\n$$\n$$\nu_{R}^{*} = u_{R}\n$$\n现在，我们必须检查这个试探解是否满足穿过接触间断的匹配条件。压力匹配条件是 $p_{L}^{*} = p_{R}^{*}$。由于 $p_{L} = p_{R}$，我们的解 $p_{L}^{*} = p_{L}$ 和 $p_{R}^{*} = p_{R}$ 平凡地满足了此条件。因此，共同的中间压力为 $p^{*} = p_{L} = p_{R}$。\n\n速度匹配条件是 $u_{L}^{*} = u_{R}^{*}$。使用我们推导出的结果，这变成了 $u_{L} = u_{R}$。问题陈述中提供了初始速度确实相等。因此，这个条件也得到了满足。共同的中间速度为 $u^{*} = u_{L} = u_{R}$。\n\n所提出的解是自洽的，并满足所有必要条件。得到的波系结构是左行波和右行波强度为零，意味着它们不存在。唯一剩下的特征是接触间断，它将初始密度为 $\\rho_{L}$ 的气体与初始密度为 $\\rho_{R}$ 的气体分开。这种在密度（以及因此在温度和熵）上的间断，而压力或速度没有变化，正是接触间断的定义。\n\n因此，$x=0$ 处的初始跳跃本身就是一个接触间断。系统的时间演化就是这个接触面随流动的传播。接触间断的速度 $S_{c}$ 等于恒定的流体速度 $u^{*}$。\n\n因此，中间态和波速的值为：\n$p^{*} = p_{L} = 1.20 \\times 10^{5} \\,\\text{Pa}$\n$u^{*} = u_{L} = 2.30 \\times 10^{2} \\,\\text{m}\\,\\text{s}^{-1}$\n$S_{c} = u^{*} = 2.30 \\times 10^{2} \\,\\text{m}\\,\\text{s}^{-1}$\n\n问题要求将这些量四舍五入到四位有效数字。\n$p^{*} = 1.200 \\times 10^{5} \\,\\text{Pa}$\n$u^{*} = 2.300 \\times 10^{2} \\,\\text{m}\\,\\text{s}^{-1}$\n$S_{c} = 2.300 \\times 10^{2} \\,\\text{m}\\,\\text{s}^{-1}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.300 \\times 10^{2}  1.200 \\times 10^{5}  2.300 \\times 10^{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从解析解到计算方法的跨越，本实践将指导您构建 Roe 近似黎曼求解器，这是现代计算流体力学的核心工具之一。您将定义 Roe 平均状态，并利用线性化系统的特征结构来建立迎风数值通量，从而将物理波传播理论与其实际应用联系起来。这项练习对于培养针对双曲守恒律的高级数值算法设计技能至关重要。",
            "id": "3948194",
            "problem": "你的任务是为理想气体的一维可压缩欧拉方程构建一个 Roe 线性化黎曼求解器，并用它来计算指定左右状态下跨界面的数值通量。构建过程必须从基本守恒律和理想气体状态方程出发，并通过在 Roe 平均状态下推导通量雅可比矩阵的适当线性化来进行。具体来说，你必须：\n\n1. 从质量、动量和能量守恒的一维欧拉方程开始，其守恒变量向量为 $\\,\\mathbf{Q} = [\\rho,\\, \\rho u,\\, \\rho E]^\\top\\,$，通量向量为 $\\,\\mathbf{F}(\\mathbf{Q}) = [\\rho u,\\, \\rho u^2 + p,\\, u(\\rho E + p)]^\\top\\,$，其中 $\\,\\rho\\,$ 是密度，$\\,u\\,$ 是速度，$\\,p\\,$ 是压力，$\\,E\\,$ 是比总能。理想气体状态方程为 $\\,p = (\\gamma - 1)\\rho e\\,$，其中 $\\,e\\,$ 是比内能，比总能 $\\,E = e + \\tfrac{1}{2}u^2\\,$。假设 $\\,\\gamma  1\\,$ 为常数。\n\n2. 通过适当地对左右状态进行加权来定义 Roe 平均状态，使得在 Roe 平均变量下评估的雅可比矩阵 $\\,\\tilde{\\mathbf{A}} = \\partial \\mathbf{F}/\\partial \\mathbf{Q}\\,$ 具有包含三个不同波的实本征结构。Roe 平均变量必须包括速度 $\\,\\tilde{u}\\,$、总焓 $\\,\\tilde{H}\\,$ 和声速 $\\,\\tilde{a}\\,$，这些变量需与理想气体关系以及线性化保持 Rankine–Hugoniot 跳跃条件的要求一致地推导出来。\n\n3. 推导在 Roe 状态下雅可比矩阵 $\\,\\tilde{\\mathbf{A}}\\,$ 的本征结构（特征值和右特征向量）。特征值必须可识别为 $\\,\\tilde{u} - \\tilde{a}\\,$、$\\,\\tilde{u}\\,$ 和 $\\,\\tilde{u} + \\tilde{a}\\,$，分别对应左行声波、接触（熵）波和右行声波。解释迎风机制：每个特征值的符号决定了相应特征族的信息传播方向，并且必须据此构造数值耗散。包括一个熵修正，用于在特征值大小接近零的声速点附近对耗散进行正则化。\n\n4. 使用推导出的 Roe 线性化和迎风原理，实现一个计算程序，用于在给定左右原始状态 $\\,(\\rho_L, u_L, p_L)\\,$ 和 $\\,(\\rho_R, u_R, p_R)\\,$ 以及 $\\,\\gamma\\,$ 的情况下，评估界面处的 Roe 数值通量 $\\,\\mathbf{F}_{\\text{Roe}}\\,$。输出必须是数值通量向量分量 $\\,\\mathbf{F}_{\\text{Roe}} = [F_{\\rho}, F_{\\rho u}, F_{\\rho E}]^\\top\\,$，其中 $\\,F_{\\rho}\\,$ 是质量通量，单位为 $\\mathrm{kg/(m^2\\cdot s)}$，$\\,F_{\\rho u}\\,$ 是动量通量，单位为 $\\mathrm{N/m^2}$，$\\,F_{\\rho E}\\,$ 是能量通量，单位为 $\\mathrm{W/m^2}$。所有计算必须使用国际单位制（SI）。\n\n你的程序必须为以下测试用例套件评估 Roe 数值通量（每个用例指定 $\\,\\rho_L\\,$ 单位为 $\\mathrm{kg/m^3}$，$\\,u_L\\,$ 单位为 $\\mathrm{m/s}$，$\\,p_L\\,$ 单位为 $\\mathrm{Pa}$，$\\,\\rho_R\\,$ 单位为 $\\mathrm{kg/m^3}$，$\\,u_R\\,$ 单位为 $\\mathrm{m/s}$，$\\,p_R\\,$ 单位为 $\\mathrm{Pa}$，以及无量纲的 $\\,\\gamma\\,$）：\n\n- 用例 1（超音速右行，所有特征值为正）：$\\,\\rho_L = 1.0\\,$, $\\,u_L = 800.0\\,$, $\\,p_L = 100000.0\\,$; $\\,\\rho_R = 0.8\\,$, $\\,u_R = 700.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n- 用例 2（跨音速混合，一个声学族改变符号）：$\\,\\rho_L = 1.0\\,$, $\\,u_L = 300.0\\,$, $\\,p_L = 100000.0\\,$; $\\,\\rho_R = 1.0\\,$, $\\,u_R = 0.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n- 用例 3（强压力跳跃，静止界面）：$\\,\\rho_L = 5.0\\,$, $\\,u_L = 0.0\\,$, $\\,p_L = 500000.0\\,$; $\\,\\rho_R = 1.0\\,$, $\\,u_R = 0.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n- 用例 4（接触间断，压力和速度相等）：$\\,\\rho_L = 2.0\\,$, $\\,u_L = 100.0\\,$, $\\,p_L = 100000.0\\,$; $\\,\\rho_R = 1.0\\,$, $\\,u_R = 100.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n\n实现一个熵修正，通过分段函数 $\\,\\phi(|\\lambda|) = |\\lambda|\\,$（如果 $\\,|\\lambda| \\ge \\delta\\,$）和 $\\,\\phi(|\\lambda|) = \\tfrac{1}{2}\\left(\\tfrac{\\lambda^2}{\\delta} + \\delta\\right)\\,$（如果 $\\,|\\lambda|  \\delta\\,$）来修改任意特征值 $\\,\\lambda\\,$ 的绝对值 $\\,|\\lambda|\\,$，其中 $\\,\\delta = \\varepsilon \\tilde{a}\\,$ 且 $\\,\\varepsilon = 0.1\\,.$ 使用单位为 $\\mathrm{m/s}$ 的 $\\,\\delta\\,$.\n\n你的程序应生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表。将每个用例的通量向量表示为包含三个浮点数的子列表 $[F_{\\rho}, F_{\\rho u}, F_{\\rho E}]$，不带空格，并将四个子列表聚合成一个外部列表。例如，输出格式必须类似于 $\\,[[f_{11},f_{12},f_{13}],[f_{21},f_{22},f_{23}],[f_{31},f_{32},f_{33}],[f_{41},f_{42},f_{43}]]\\,$，其中每个 $\\,f_{ij}\\,$ 是一个浮点数。数值必须使用上述指定的质量、动量和能量通量的单位。",
            "solution": "该任务是为一维可压缩欧拉方程构建 Roe 线性化黎曼求解器，并用它来计算给定左右状态下界面处的数值通量。推导从基本方程开始，逐步进行到最终的数值通量公式，包括 Roe 平均过程、本征结构分析和熵修正。\n\n一维欧拉方程的守恒形式如下：\n$$\n\\frac{\\partial \\mathbf{Q}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{Q})}{\\partial x} = \\mathbf{0}\n$$\n其中 $\\mathbf{Q}$ 是守恒变量向量，$\\mathbf{F}(\\mathbf{Q})$ 是通量向量：\n$$\n\\mathbf{Q} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}, \\quad \\mathbf{F}(\\mathbf{Q}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(\\rho E + p) \\end{pmatrix}\n$$\n这里，$\\rho$ 是密度，$u$ 是速度，$p$ 是压力，$E$ 是比总能。对于理想气体，压力 $p$ 通过状态方程与比内能 $e$ 相关联：\n$$\np = (\\gamma - 1)\\rho e\n$$\n其中 $\\gamma$ 是恒定的比热比。比总能 $E$ 是比内能和比动能之和：\n$$\nE = e + \\frac{1}{2}u^2\n$$\n根据这些关系，我们可以用原始变量 $(\\rho, u, p)$ 或守恒变量 $\\mathbf{Q}$ 来表示压力 $p$ 和总焓 $H$：\n$$\np = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^2\\right)\n$$\n$$\nH = E + \\frac{p}{\\rho} = e + \\frac{1}{2}u^2 + \\frac{p}{\\rho} = \\frac{\\gamma p}{(\\gamma-1)\\rho} + \\frac{1}{2}u^2\n$$\n\nRoe 求解器基于寻找一个矩阵 $\\tilde{\\mathbf{A}}(\\mathbf{Q}_L, \\mathbf{Q}_R)$，该矩阵是通量雅可比矩阵 $\\mathbf{A}(\\mathbf{Q}) = \\partial\\mathbf{F}/\\partial\\mathbf{Q}$ 的一致线性化。该矩阵必须满足三个性质：\n1.  对于任何状态 $\\mathbf{Q}_L, \\mathbf{Q}_R$，它都是双曲型的，意味着它有一整套实特征值和线性无关的特征向量。\n2.  它与雅可比矩阵是一致的，即 $\\tilde{\\mathbf{A}}(\\mathbf{Q}, \\mathbf{Q}) = \\mathbf{A}(\\mathbf{Q})$。\n3.  它满足跨间断的 Rankine-Hugoniot 跳跃条件：$\\mathbf{F}(\\mathbf{Q}_R) - \\mathbf{F}(\\mathbf{Q}_L) = \\tilde{\\mathbf{A}}(\\mathbf{Q}_R - \\mathbf{Q}_L)$。\n\n这样的矩阵可以通过在一个特殊定义的“Roe 平均”状态下评估雅可比矩阵 $\\mathbf{A}(\\mathbf{Q})$ 来构建。对于理想气体的欧拉方程，Roe 平均值为：\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L}u_L + \\sqrt{\\rho_R}u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho_L}H_L + \\sqrt{\\rho_R}H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\n从 Roe 平均总焓 $\\tilde{H}$ 和速度 $\\tilde{u}$，我们可以定义一个一致的 Roe 平均声速 $\\tilde{a}$：\n$$\n\\tilde{a}^2 = (\\gamma - 1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2\\right)\n$$\nRoe 矩阵 $\\tilde{\\mathbf{A}}$ 是用原始变量表示并在此 Roe 平均状态 $(\\tilde{u}, \\tilde{H}, \\tilde{a})$ 下评估的通量雅可比矩阵 $\\mathbf{A}$。雅可比矩阵为：\n$$\n\\mathbf{A} = \\begin{pmatrix} 0  1  0 \\\\ \\frac{\\gamma-3}{2}u^2  (3-\\gamma)u  \\gamma-1 \\\\ u\\left(\\frac{\\gamma-1}{2}u^2 - H\\right)  H - (\\gamma-1)u^2  \\gamma u \\end{pmatrix}\n$$\n在此 Roe 状态下评估得到 $\\tilde{\\mathbf{A}} = \\mathbf{A}(\\tilde{u}, \\tilde{H})$。\n\n$\\tilde{\\mathbf{A}}$ 的本征结构是求解器的核心。特征值为：\n$$\n\\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a}, \\quad \\tilde{\\lambda}_2 = \\tilde{u}, \\quad \\tilde{\\lambda}_3 = \\tilde{u} + \\tilde{a}\n$$\n这些特征值分别对应左行声波、接触（熵）波和右行声波的速度。这些特征值的符号表示每个特征族的信息传播方向。\n相应的右特征向量为：\n$$\n\\tilde{\\mathbf{k}}_1 = \\begin{pmatrix} 1 \\\\ \\tilde{u}-\\tilde{a} \\\\ \\tilde{H}-\\tilde{u}\\tilde{a} \\end{pmatrix}, \\quad \\tilde{\\mathbf{k}}_2 = \\begin{pmatrix} 1 \\\\ \\tilde{u} \\\\ \\frac{1}{2}\\tilde{u}^2 \\end{pmatrix}, \\quad \\tilde{\\mathbf{k}}_3 = \\begin{pmatrix} 1 \\\\ \\tilde{u}+\\tilde{a} \\\\ \\tilde{H}+\\tilde{u}\\tilde{a} \\end{pmatrix}\n$$\n守恒变量的跳跃量 $\\Delta \\mathbf{Q} = \\mathbf{Q}_R - \\mathbf{Q}_L$ 可以投影到这个特征向量基上：\n$$\n\\Delta \\mathbf{Q} = \\sum_{i=1}^3 \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i\n$$\n其中 $\\tilde{\\alpha}_i$ 是波强度。求解这个 $3 \\times 3$ 系统得到 $\\tilde{\\alpha}_i$：\n$$\n\\tilde{\\alpha}_2 = \\frac{\\gamma-1}{\\tilde{a}^2} \\left[ (\\tilde{H}-\\tilde{u}^2)\\Delta\\rho + \\tilde{u}\\Delta(\\rho u) - \\Delta(\\rho E) \\right]\n$$\n$$\n\\tilde{\\alpha}_1 = \\frac{1}{2} \\left[ (\\Delta\\rho - \\tilde{\\alpha}_2) + \\frac{\\tilde{u}\\Delta\\rho - \\Delta(\\rho u)}{\\tilde{a}} \\right]\n$$\n$$\n\\tilde{\\alpha}_3 = \\frac{1}{2} \\left[ (\\Delta\\rho - \\tilde{\\alpha}_2) - \\frac{\\tilde{u}\\Delta\\rho - \\Delta(\\rho u)}{\\tilde{a}} \\right]\n$$\n其中 $\\Delta\\rho = \\rho_R - \\rho_L$, $\\Delta(\\rho u) = (\\rho u)_R - (\\rho u)_L$, $\\Delta(\\rho E) = (\\rho E)_R - (\\rho E)_L$。\n\nRoe 数值通量 $\\mathbf{F}_{\\text{Roe}}$ 是一种 Godunov 型通量，它基于特征值的符号引入了迎风特性。它被计算为左右通量的平均值加上一个考虑了黎曼问题解的波结构的耗散项：\n$$\n\\mathbf{F}_{\\text{Roe}} = \\frac{1}{2}(\\mathbf{F}_L + \\mathbf{F}_R) - \\frac{1}{2} |\\tilde{\\mathbf{A}}|(\\mathbf{Q}_R - \\mathbf{Q}_L)\n$$\n耗散项 $|\\tilde{\\mathbf{A}}|(\\mathbf{Q}_R - \\mathbf{Q}_L)$ 使用特征分解进行计算：\n$$\n|\\tilde{\\mathbf{A}}|(\\mathbf{Q}_R - \\mathbf{Q}_L) = \\sum_{i=1}^3 |\\tilde{\\lambda}_i| \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i\n$$\n这导出了 Roe 通量的最终表达式：\n$$\n\\mathbf{F}_{\\text{Roe}} = \\frac{1}{2}(\\mathbf{F}_L + \\mathbf{F}_R) - \\frac{1}{2} \\sum_{i=1}^3 |\\tilde{\\lambda}_i| \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i\n$$\n\nRoe 求解器的一个关键问题是，对于跨音速稀疏波，当特征值 $\\tilde{\\lambda}_i$ 穿过零时，无法添加足够的耗散。这可能导致违反熵增的膨胀激波。为了解决这个问题，应用了“熵修正”，即修改绝对值函数 $|\\lambda|$。按照规定，我们将 $|\\lambda|$ 替换为函数 $\\phi(|\\lambda|)$：\n$$\n\\phi(|\\lambda|) = \\begin{cases} |\\lambda|  \\text{if } |\\lambda| \\ge \\delta \\\\ \\frac{1}{2}\\left(\\frac{\\lambda^2}{\\delta} + \\delta\\right)  \\text{if } |\\lambda|  \\delta \\end{cases}\n$$\n其中 $\\delta = \\varepsilon \\tilde{a}$ 是一个小的正常数阈值，$\\varepsilon = 0.1$。因此，耗散项被修改为 $\\sum_{i=1}^3 \\phi(|\\tilde{\\lambda}_i|) \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i$，确保在声速点处有严格为正的耗散量。\n\n给定左右原始状态 $(\\rho_L, u_L, p_L)$, $(\\rho_R, u_R, p_R)$ 和 $\\gamma$，寻找 $\\mathbf{F}_{\\text{Roe}}$ 的计算步骤如下：\n1.  计算派生量（$E_L, H_L, E_R, H_R$），并构建状态向量 $\\mathbf{Q}_L, \\mathbf{Q}_R$ 和通量向量 $\\mathbf{F}_L, \\mathbf{F}_R$。\n2.  计算 Roe 平均变量 $\\tilde{u}$, $\\tilde{H}$ 和 $\\tilde{a}$。\n3.  计算守恒变量的跳跃量 $\\Delta\\rho$, $\\Delta(\\rho u)$, $\\Delta(\\rho E)$。\n4.  确定波强度 $\\tilde{\\alpha}_1, \\tilde{\\alpha}_2, \\tilde{\\alpha}_3$。\n5.  找到特征值 $\\tilde{\\lambda}_1, \\tilde{\\lambda}_2, \\tilde{\\lambda}_3$ 和右特征向量 $\\tilde{\\mathbf{k}}_1, \\tilde{\\mathbf{k}}_2, \\tilde{\\mathbf{k}}_3$。\n6.  对每个 $|\\tilde{\\lambda}_i|$ 应用熵修正以得到 $\\phi(|\\tilde{\\lambda}_i|)$。\n7.  通过对每个波的贡献求和来计算总耗散向量：$\\sum_{i=1}^3 \\phi(|\\tilde{\\lambda}_i|) \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i$。\n8.  组装最终的 Roe 通量向量 $\\mathbf{F}_{\\text{Roe}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are permitted.\n\ndef solve():\n    \"\"\"\n    Constructs and applies Roe's linearized Riemann solver for the 1D Euler equations.\n    \"\"\"\n\n    def compute_roe_flux(rho_L, u_L, p_L, rho_R, u_R, p_R, gamma, epsilon=0.1):\n        \"\"\"\n        Computes the Roe numerical flux for the 1D Euler equations.\n\n        Args:\n            rho_L, u_L, p_L: Primitive variables (density, velocity, pressure) for the left state.\n            rho_R, u_R, p_R: Primitive variables for the right state.\n            gamma: Ratio of specific heats.\n            epsilon: Parameter for the entropy fix.\n\n        Returns:\n            A numpy array representing the Roe flux vector [F_rho, F_rho_u, F_rho_E].\n        \"\"\"\n        # 1. Compute derived quantities and state/flux vectors\n        # Left state\n        e_L = p_L / ((gamma - 1.0) * rho_L)\n        E_L = e_L + 0.5 * u_L**2\n        H_L = E_L + p_L / rho_L\n        Q_L = np.array([rho_L, rho_L * u_L, rho_L * E_L])\n        F_L = np.array([rho_L * u_L, rho_L * u_L**2 + p_L, u_L * (rho_L * E_L + p_L)])\n\n        # Right state\n        e_R = p_R / ((gamma - 1.0) * rho_R)\n        E_R = e_R + 0.5 * u_R**2\n        H_R = E_R + p_R / rho_R\n        Q_R = np.array([rho_R, rho_R * u_R, rho_R * E_R])\n        F_R = np.array([rho_R * u_R, rho_R * u_R**2 + p_R, u_R * (rho_R * E_R + p_R)])\n\n        # 2. Compute Roe-averaged state\n        sqrt_rho_L = np.sqrt(rho_L)\n        sqrt_rho_R = np.sqrt(rho_R)\n        \n        u_tilde = (sqrt_rho_L * u_L + sqrt_rho_R * u_R) / (sqrt_rho_L + sqrt_rho_R)\n        H_tilde = (sqrt_rho_L * H_L + sqrt_rho_R * H_R) / (sqrt_rho_L + sqrt_rho_R)\n        \n        # Handle potential for negative value due to floating point arithmetic\n        a_sq_tilde_val = (gamma - 1.0) * (H_tilde - 0.5 * u_tilde**2)\n        if a_sq_tilde_val  0:\n            # This case indicates unphysical input states for the perfect gas model.\n            # A more robust implementation might average sound speed directly.\n            # For well-posed problems, this should not occur.\n            # We take the average of squared sound speeds as a fallback.\n            a_L_sq = gamma * p_L / rho_L\n            a_R_sq = gamma * p_R / rho_R\n            a_sq_tilde = 0.5 * (a_L_sq + a_R_sq)\n        else:\n            a_sq_tilde = a_sq_tilde_val\n\n        a_tilde = np.sqrt(a_sq_tilde)\n\n        # 3. Compute jumps in conserved variables\n        delta_Q = Q_R - Q_L\n        delta_rho = delta_Q[0]\n        delta_rho_u = delta_Q[1]\n        delta_rho_E = delta_Q[2]\n        \n        # 4. Compute wave strengths\n        # Note: A direct implementation of the formulas can be sensitive to\n        # floating point errors, especially if a_tilde is small.\n        # This implementation follows the direct derivation.\n        \n        # Strength of the entropy wave (lambda = u_tilde)\n        alpha_2 = (gamma - 1.0) / a_sq_tilde * \\\n                  ((H_tilde - u_tilde**2) * delta_rho + u_tilde * delta_rho_u - delta_rho_E)\n        \n        # Strength of acoustic waves (lambda = u_tilde +- a_tilde)\n        term_in_paren = (u_tilde * delta_rho - delta_rho_u) / a_tilde\n        alpha_1 = 0.5 * (delta_rho - alpha_2 - term_in_paren)\n        alpha_3 = 0.5 * (delta_rho - alpha_2 + term_in_paren)\n\n        # Alternative for alpha_3 to reduce dependency\n        # alpha_3 = delta_rho - alpha_1 - alpha_2\n\n        # 5. Compute eigenvalues and eigenvectors\n        lambdas = np.array([u_tilde - a_tilde, u_tilde, u_tilde + a_tilde])\n        alphas = np.array([alpha_1, alpha_2, alpha_3])\n        \n        k1 = np.array([1.0, u_tilde - a_tilde, H_tilde - u_tilde * a_tilde])\n        k2 = np.array([1.0, u_tilde, 0.5 * u_tilde**2])\n        k3 = np.array([1.0, u_tilde + a_tilde, H_tilde + u_tilde * a_tilde])\n        \n        eigenvectors = [k1, k2, k3]\n\n        # 6. Apply entropy fix\n        delta = epsilon * a_tilde\n        phi_lambdas = np.zeros_like(lambdas)\n        for i, lam in enumerate(lambdas):\n            abs_lam = np.abs(lam)\n            if abs_lam  delta:\n                phi_lambdas[i] = 0.5 * (lam**2 / delta + delta)\n            else:\n                phi_lambdas[i] = abs_lam\n\n        # 7. Compute numerical dissipation term\n        dissipation = np.zeros(3)\n        for i in range(3):\n            dissipation += phi_lambdas[i] * alphas[i] * eigenvectors[i]\n\n        # 8. Assemble the final Roe flux\n        F_roe = 0.5 * (F_L + F_R) - 0.5 * dissipation\n        return F_roe\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Supersonic right-going\n        (1.0, 800.0, 100000.0, 0.8, 700.0, 100000.0, 1.4),\n        # Case 2: Transonic mixed\n        (1.0, 300.0, 100000.0, 1.0, 0.0, 100000.0, 1.4),\n        # Case 3: Strong pressure jump (Sod-like)\n        (5.0, 0.0, 500000.0, 1.0, 0.0, 100000.0, 1.4),\n        # Case 4: Contact discontinuity\n        (2.0, 100.0, 100000.0, 1.0, 100.0, 100000.0, 1.4),\n    ]\n\n    results = []\n    for case in test_cases:\n        rho_L, u_L, p_L, rho_R, u_R, p_R, gamma = case\n        flux_vector = compute_roe_flux(rho_L, u_L, p_L, rho_R, u_R, p_R, gamma)\n        results.append([flux_vector[0], flux_vector[1], flux_vector[2]])\n\n    # Final print statement in the exact required format.\n    # Format: [[f11,f12,f13],[f21,f22,f23],...]\n    sublist_strings = [f\"[{v[0]},{v[1]},{v[2]}]\" for v in results]\n    final_output = f\"[{','.join(sublist_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}