{
    "hands_on_practices": [
        {
            "introduction": "Understanding compressible wave phenomena begins with the fundamental conservation laws that govern discontinuities. This first practice grounds your understanding in the Rankine-Hugoniot relations by focusing on the principle of mass conservation. By deriving the shock speed from the continuity of mass flux across a discontinuity, you will connect the integral form of the Euler equations to a practical algebraic tool essential for analyzing and quantifying shock waves. ",
            "id": "3948139",
            "problem": "A one-dimensional, planar compressive shock in a gas is modeled using the inviscid one-dimensional Euler equations, as is standard in Computational Fluid Dynamics (CFD). Consider a shock separating two uniform constant states, denoted by the left state $\\left(\\rho_{L}, u_{L}, p_{L}\\right)$ and the right state $\\left(\\rho_{R}, u_{R}, p_{R}\\right)$, where $\\rho$ is density, $u$ is the flow velocity in the laboratory frame, and $p$ is the thermodynamic pressure. The discontinuity (shock) propagates in the positive $x$-direction with an unknown shock speed $s$. The left state represents the upstream flow into which the shock propagates, and the right state represents the downstream flow. Assume the discontinuity is planar and steady in the shock-attached frame, and that the flow is inviscid and adiabatic with no body forces.\n\nStarting from the integral form of conservation of mass across a moving discontinuity, use the fact that the mass flux $m$ normal to the shock is continuous and is given by $m = \\rho \\left(u - s\\right)$ on each side of the shock. Derive an explicit analytical expression for the shock speed $s$ in terms of $\\rho_{L}$, $u_{L}$, $\\rho_{R}$, and $u_{R}$ only. Then, evaluate $s$ for the following physically consistent left and right states representing a strong shock in air:\n- $\\rho_{L} = 1.2~\\mathrm{kg/m^{3}}$, $u_{L} = 0~\\mathrm{m/s}$, $p_{L} = 1.0 \\times 10^{5}~\\mathrm{Pa}$,\n- $\\rho_{R} = 4.7~\\mathrm{kg/m^{3}}$, $u_{R} = 755~\\mathrm{m/s}$, $p_{R} = 1.03 \\times 10^{6}~\\mathrm{Pa}$.\n\nExpress your final numerical answer for the shock speed in $\\mathrm{m/s}$ and round your answer to four significant figures. You must provide a single final number as your answer.",
            "solution": "The problem requires the derivation of an analytical expression for the shock speed, $s$, and its subsequent numerical evaluation. The derivation starts from the principle of mass conservation across a moving discontinuity.\n\nThe problem states that the mass flux, $m$, normal to the shock is continuous. The mass flux is defined in the laboratory frame relative to the moving shock as $m = \\rho(u-s)$, where $\\rho$ is the density, $u$ is the fluid velocity in the laboratory frame, and $s$ is the shock's propagation speed. The continuity of mass flux across the shock means that the value of $m$ is the same on the upstream (left, subscript $L$) and downstream (right, subscript $R$) sides of the discontinuity.\n\nThis gives the governing relation:\n$$m_{L} = m_{R}$$\nSubstituting the given expression for mass flux, we have:\n$$\\rho_{L} (u_{L} - s) = \\rho_{R} (u_{R} - s)$$\n\nThis equation is one of the Rankine-Hugoniot relations, specifically the one for mass conservation. To find an explicit expression for the shock speed $s$, we must rearrange this equation algebraically. First, we expand both sides of the equation:\n$$\\rho_{L} u_{L} - \\rho_{L} s = \\rho_{R} u_{R} - \\rho_{R} s$$\n\nNext, we gather all terms containing the unknown variable $s$ on one side of the equation and all other terms on the other side.\n$$\\rho_{R} s - \\rho_{L} s = \\rho_{R} u_{R} - \\rho_{L} u_{L}$$\n\nWe can factor out $s$ from the terms on the left-hand side:\n$$s (\\rho_{R} - \\rho_{L}) = \\rho_{R} u_{R} - \\rho_{L} u_{L}$$\n\nFinally, we isolate $s$ by dividing by the term $(\\rho_{R} - \\rho_{L})$. This is permissible as for a shock, there is a density jump, so $\\rho_{R} \\neq \\rho_{L}$. Specifically, for a compressive shock, $\\rho_{R} > \\rho_{L}$, so the denominator is non-zero.\n$$s = \\frac{\\rho_{R} u_{R} - \\rho_{L} u_{L}}{\\rho_{R} - \\rho_{L}}$$\n\nThis is the required explicit analytical expression for the shock speed $s$ in terms of $\\rho_{L}$, $u_{L}$, $\\rho_{R}$, and $u_{R}$. Note that the pressure values, $p_L$ and $p_R$, are not required for this specific derivation, as per the problem statement.\n\nNow, we evaluate this expression using the provided numerical values:\n- $\\rho_{L} = 1.2~\\mathrm{kg/m^{3}}$\n- $u_{L} = 0~\\mathrm{m/s}$\n- $\\rho_{R} = 4.7~\\mathrm{kg/m^{3}}$\n- $u_{R} = 755~\\mathrm{m/s}$\n\nWe first compute the numerator of the expression, which represents the difference in momentum flux, $\\rho u$:\n$$\\rho_{R} u_{R} - \\rho_{L} u_{L} = (4.7)(755) - (1.2)(0)$$\n$$\\rho_{R} u_{R} - \\rho_{L} u_{L} = 3548.5 - 0 = 3548.5~\\mathrm{kg/(m^2 \\cdot s)}$$\n\nNext, we compute the denominator, which is the change in density:\n$$\\rho_{R} - \\rho_{L} = 4.7 - 1.2 = 3.5~\\mathrm{kg/m^3}$$\n\nNow we can calculate the shock speed $s$:\n$$s = \\frac{3548.5}{3.5} \\approx 1013.85714~\\mathrm{m/s}$$\n\nThe problem requires the final answer to be rounded to four significant figures.\n$s \\approx 1014~\\mathrm{m/s}$.\nThe positive sign indicates that the shock is propagating in the positive $x$-direction, consistent with the problem description.",
            "answer": "$$\\boxed{1014}$$"
        },
        {
            "introduction": "Building on the properties of a single discontinuity, we now explore how multiple waves interact in the classic Riemann problem. This exercise presents a special case designed to isolate one of the three fundamental wave types: the contact discontinuity. By analyzing a scenario where initial pressures and velocities are equal, you are challenged to deduce the resulting wave pattern, thereby gaining a deeper insight into the physical conditions that generate contact surfaces versus shock or rarefaction waves. ",
            "id": "3948142",
            "problem": "Consider the one-dimensional compressible Euler equations for a calorically perfect gas with constant ratio of specific heats $\\gamma$, written in conservation-law form for density $\\rho$, momentum $\\rho u$, and total energy $\\rho E$,\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix}\n\\rho \\\\\n\\rho u \\\\\n\\rho E\n\\end{pmatrix}\n+\n\\frac{\\partial}{\\partial x}\n\\begin{pmatrix}\n\\rho u \\\\\n\\rho u^{2} + p \\\\\nu(\\rho E + p)\n\\end{pmatrix}\n= \\mathbf{0},\n$$\nwith the ideal-gas closure $p = (\\gamma-1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$.\n\nA Riemann problem is posed with initial data\n$$\n(\\rho, u, p)(x,0) =\n\\begin{cases}\n(\\rho_{L},\\, u_{L},\\, p_{L}),  x  0, \\\\\n(\\rho_{R},\\, u_{R},\\, p_{R}),  x  0,\n\\end{cases}\n$$\nfor a gas with $\\gamma = 1.4$. The left state is $\\rho_{L} = 1.5 \\,\\text{kg}\\,\\text{m}^{-3}$, $u_{L} = 2.30 \\times 10^{2} \\,\\text{m}\\,\\text{s}^{-1}$, $p_{L} = 1.20 \\times 10^{5} \\,\\text{Pa}$, and the right state is $\\rho_{R} = 0.30 \\,\\text{kg}\\,\\text{m}^{-3}$, $u_{R} = 2.30 \\times 10^{2} \\,\\text{m}\\,\\text{s}^{-1}$, $p_{R} = 1.20 \\times 10^{5} \\,\\text{Pa}$. Thus, the pressures and velocities are equal on both sides, while the densities differ.\n\nUsing the exact Riemann solver structure derived from the compressible Euler equations and the associated wave families, determine the common intermediate-state velocity $u^{*}$, the common intermediate-state pressure $p^{*}$, and the contact wave speed $S_{c}$ at which the contact discontinuity propagates. Express the velocity values in $\\text{m}\\,\\text{s}^{-1}$ and the pressure in $\\text{Pa}$. Round all reported quantities to four significant figures. The final answer must be provided as a single row matrix containing, in order, $u^{*}$, $p^{*}$, and $S_{c}$.",
            "solution": "The problem presents a Riemann problem for the one-dimensional compressible Euler equations for a calorically perfect gas. The initial state consists of two uniform regions, a left state $(L)$ and a right state $(R)$, separated by a discontinuity at $x=0$. The governing equations are\n$$\n\\frac{\\partial}{\\partial t} \\mathbf{U} + \\frac{\\partial}{\\partial x} \\mathbf{F}(\\mathbf{U}) = \\mathbf{0},\n$$\nwhere the state vector $\\mathbf{U}$ and flux vector $\\mathbf{F}(\\mathbf{U})$ are\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}, \\quad \\mathbf{F}(\\mathbf{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(\\rho E + p) \\end{pmatrix}.\n$$\nThe system is closed by the equation of state for a calorically perfect gas, $p = (\\gamma-1)(\\rho E - \\frac{1}{2}\\rho u^{2})$, with the ratio of specific heats given as $\\gamma = 1.4$.\n\nThe initial conditions at time $t=0$ are\n$$\n(\\rho, u, p)(x,0) =\n\\begin{cases}\n(\\rho_{L},\\, u_{L},\\, p_{L}) = (1.5, 2.30 \\times 10^{2}, 1.20 \\times 10^{5}),  x  0, \\\\\n(\\rho_{R},\\, u_{R},\\, p_{R}) = (0.30, 2.30 \\times 10^{2}, 1.20 \\times 10^{5}),  x  0,\n\\end{cases}\n$$\nwhere units are in the SI system.\n\nThe solution to the Riemann problem is self-similar, depending only on the variable $\\xi = x/t$. The solution structure consists of a set of waves propagating from the origin, separating regions of constant state. For the Euler equations, the generic solution involves a left-propagating wave, a contact discontinuity, and a right-propagating wave. These waves separate the initial left and right states from two intermediate states, denoted as the left-star state $(\\rho_{L}^{*}, u_{L}^{*}, p_{L}^{*})$ and the right-star state $(\\rho_{R}^{*}, u_{R}^{*}, p_{R}^{*})$.\n\nAcross the contact discontinuity, pressure and velocity are continuous. This yields the crucial matching conditions for the intermediate states:\n$$\nu_{L}^{*} = u_{R}^{*} \\equiv u^{*}\n$$\n$$\np_{L}^{*} = p_{R}^{*} \\equiv p^{*}\n$$\nThe density, however, is generally discontinuous across a contact surface, i.e., $\\rho_{L}^{*} \\neq \\rho_{R}^{*}$. The contact discontinuity propagates at a speed $S_{c}$ equal to the local fluid velocity, $S_{c} = u^{*}$.\n\nThe left- and right-propagating waves can be either shock waves or rarefaction waves. The type of wave is determined by the pressure change across it. The intermediate-state velocity $u^{*}$ and pressure $p^{*}$ are found by connecting the initial states $(L)$ and $(R)$ to their respective star states through the appropriate wave relations and then applying the matching conditions.\n\nLet's analyze the specific initial data provided. A key observation is that both the initial velocities and pressures are equal:\n$$\nu_{L} = u_{R} = 2.30 \\times 10^{2} \\,\\text{m}\\,\\text{s}^{-1}\n$$\n$$\np_{L} = p_{R} = 1.20 \\times 10^{5} \\,\\text{Pa}\n$$\nThe non-linear waves (shocks and rarefactions) are generated by differences in pressure and velocity between adjacent states. The velocity in the star region, $u^{*}$, is a function of the star pressure, $p^{*}$, and the initial state data. For the left side, $u_{L}^{*} = f(p^{*}, \\rho_{L}, u_{L}, p_{L})$, and for the right side, $u_{R}^{*} = g(p^{*}, \\rho_{R}, u_{R}, p_{R})$. The goal is to find a $p^{*}$ such that $u_{L}^{*} = u_{R}^{*}$.\n\nLet us propose a trial solution where the intermediate pressure $p^{*}$ is equal to the initial pressures, $p^{*} = p_{L} = p_{R}$.\nFor the left wave, if $p^{*} = p_{L}$, there is no pressure jump. This corresponds to a wave of zero strength. Consequently, all flow properties remain unchanged across this \"wave\". This implies:\n$$\np_{L}^{*} = p_{L}\n$$\n$$\nu_{L}^{*} = u_{L}\n$$\nSimilarly, for the right wave, if $p^{*} = p_{R}$, there is no pressure jump, and the wave has zero strength. This implies:\n$$\np_{R}^{*} = p_{R}\n$$\n$$\nu_{R}^{*} = u_{R}\n$$\nNow, we must check if this trial solution satisfies the matching conditions across the contact discontinuity. The pressure matching condition is $p_{L}^{*} = p_{R}^{*}$. Since $p_{L} = p_{R}$, our solution $p_{L}^{*} = p_{L}$ and $p_{R}^{*} = p_{R}$ satisfies this trivially. The common intermediate pressure is thus $p^{*} = p_{L} = p_{R}$.\n\nThe velocity matching condition is $u_{L}^{*} = u_{R}^{*}$. Using our derived consequences, this becomes $u_{L} = u_{R}$. The problem statement provides that the initial velocities are indeed equal. Therefore, this condition is also satisfied. The common intermediate velocity is $u^{*} = u_{L} = u_{R}$.\n\nThe proposed solution is self-consistent and satisfies all necessary conditions. The resulting wave pattern is one where the left- and right-propagating waves have zero strength, meaning they do not exist. The only feature that remains is the contact discontinuity, which separates the gas with initial density $\\rho_{L}$ from the gas with initial density $\\rho_{R}$. This discontinuity in density (and consequently in temperature and entropy), without a change in pressure or velocity, is precisely the definition of a contact discontinuity.\n\nThe initial jump at $x=0$ is therefore itself a contact discontinuity. The time evolution of the system is simply the propagation of this contact surface with the flow. The speed of the contact discontinuity, $S_{c}$, is equal to the constant fluid velocity $u^{*}$.\n\nThe values for the intermediate state and wave speed are therefore:\n$p^{*} = p_{L} = 1.20 \\times 10^{5} \\,\\text{Pa}$\n$u^{*} = u_{L} = 2.30 \\times 10^{2} \\,\\text{m}\\,\\text{s}^{-1}$\n$S_{c} = u^{*} = 2.30 \\times 10^{2} \\,\\text{m}\\,\\text{s}^{-1}$\n\nThe problem requires rounding these quantities to four significant figures.\n$p^{*} = 1.200 \\times 10^{5} \\,\\text{Pa}$\n$u^{*} = 2.300 \\times 10^{2} \\,\\text{m}\\,\\text{s}^{-1}$\n$S_{c} = 2.300 \\times 10^{2} \\,\\text{m}\\,\\text{s}^{-1}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.300 \\times 10^{2}  1.200 \\times 10^{5}  2.300 \\times 10^{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The final practice bridges the gap between theory and modern computational fluid dynamics (CFD) by tasking you with the construction of a Roe's linearized Riemann solver. This powerful shock-capturing technique approximates the complex wave structure of the Euler equations using a single matrix evaluated at a carefully constructed \"Roe-averaged\" state. By deriving the solver's eigenstructure and implementing the upwinded numerical flux, you will translate the physical theory of characteristic waves into a robust and widely used computational algorithm. ",
            "id": "3948194",
            "problem": "You are tasked with constructing a Roe’s linearized Riemann solver for the one-dimensional compressible Euler equations of a perfect gas, and to use it to compute numerical fluxes across an interface for specified left and right states. The construction must start from the fundamental conservation laws and the perfect-gas equation of state, and proceed by deriving an appropriate linearization of the flux Jacobian at a Roe-averaged state. Specifically, you must:\n\n1. Begin from the one-dimensional Euler equations for mass, momentum, and energy conservation, with conserved variable vector $\\,\\mathbf{Q} = [\\rho,\\, \\rho u,\\, \\rho E]^\\top\\,$ and flux vector $\\,\\mathbf{F}(\\mathbf{Q}) = [\\rho u,\\, \\rho u^2 + p,\\, u(\\rho E + p)]^\\top\\,$, where $\\,\\rho\\,$ is density, $\\,u\\,$ is velocity, $\\,p\\,$ is pressure, and $\\,E\\,$ is the specific total energy. The perfect-gas equation of state is $\\,p = (\\gamma - 1)\\rho e\\,$, with specific internal energy $\\,e\\,$, and specific total energy $\\,E = e + \\tfrac{1}{2}u^2\\,$. Assume $\\,\\gamma  1\\,$ constant.\n\n2. Define a Roe-averaged state by appropriately weighting the left and right states such that the Jacobian matrix $\\,\\tilde{\\mathbf{A}} = \\partial \\mathbf{F}/\\partial \\mathbf{Q}\\,$ evaluated at the Roe-averaged variables has a real eigenstructure with three distinct waves. The Roe-averaged variables must include a velocity $\\,\\tilde{u}\\,$, a total enthalpy $\\,\\tilde{H}\\,$, and a sound speed $\\,\\tilde{a}\\,$ derived consistently from the perfect-gas relations and the requirement that the linearization preserves the Rankine–Hugoniot jump conditions.\n\n3. Derive the eigenstructure (eigenvalues and right eigenvectors) of the Jacobian $\\,\\tilde{\\mathbf{A}}\\,$ at the Roe state. The eigenvalues must be identifiable as $\\,\\tilde{u} - \\tilde{a}\\,$, $\\,\\tilde{u}\\,$, and $\\,\\tilde{u} + \\tilde{a}\\,$, corresponding to left-going acoustic, contact (entropy), and right-going acoustic waves. Explain the upwinding mechanism: the sign of each eigenvalue determines the direction of information propagation for the corresponding characteristic family, and numerical dissipation must be constructed accordingly. Include an entropy fix that regularizes the dissipation near sonic points where an eigenvalue magnitude approaches zero.\n\n4. Using the derived Roe linearization and upwinding principle, implement a computational routine to evaluate the Roe numerical flux $\\,\\mathbf{F}_{\\text{Roe}}\\,$ at an interface given left and right primitive states $\\,(\\rho_L, u_L, p_L)\\,$ and $\\,(\\rho_R, u_R, p_R)\\,$ along with $\\,\\gamma\\,$. The output must be the numerical flux vector components $\\,\\mathbf{F}_{\\text{Roe}} = [F_{\\rho}, F_{\\rho u}, F_{\\rho E}]^\\top\\,$, where $\\,F_{\\rho}\\,$ is the mass flux in $\\mathrm{kg/(m^2\\cdot s)}$, $\\,F_{\\rho u}\\,$ is the momentum flux in $\\mathrm{N/m^2}$, and $\\,F_{\\rho E}\\,$ is the energy flux in $\\mathrm{W/m^2}$. All calculations must be in International System of Units (SI).\n\nYour program must evaluate the Roe numerical flux for the following test suite of cases (each case specifies $\\,\\rho_L\\,$ in $\\mathrm{kg/m^3}$, $\\,u_L\\,$ in $\\mathrm{m/s}$, $\\,p_L\\,$ in $\\mathrm{Pa}$, $\\,\\rho_R\\,$ in $\\mathrm{kg/m^3}$, $\\,u_R\\,$ in $\\mathrm{m/s}$, $\\,p_R\\,$ in $\\mathrm{Pa}$, and $\\,\\gamma\\,$ dimensionless):\n\n- Case 1 (Supersonic right-going, all eigenvalues positive): $\\,\\rho_L = 1.0\\,$, $\\,u_L = 800.0\\,$, $\\,p_L = 100000.0\\,$; $\\,\\rho_R = 0.8\\,$, $\\,u_R = 700.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n- Case 2 (Transonic mixed, one acoustic family changes sign): $\\,\\rho_L = 1.0\\,$, $\\,u_L = 300.0\\,$, $\\,p_L = 100000.0\\,$; $\\,\\rho_R = 1.0\\,$, $\\,u_R = 0.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n- Case 3 (Strong pressure jump, stationary interface): $\\,\\rho_L = 5.0\\,$, $\\,u_L = 0.0\\,$, $\\,p_L = 500000.0\\,$; $\\,\\rho_R = 1.0\\,$, $\\,u_R = 0.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n- Case 4 (Contact discontinuity, equal pressure and velocity): $\\,\\rho_L = 2.0\\,$, $\\,u_L = 100.0\\,$, $\\,p_L = 100000.0\\,$; $\\,\\rho_R = 1.0\\,$, $\\,u_R = 100.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n\nImplement an entropy fix that modifies the absolute value $\\,|\\lambda|\\,$ of any eigenvalue $\\,\\lambda\\,$ via the piecewise function $\\,\\phi(|\\lambda|) = |\\lambda|\\,$ if $\\,|\\lambda| \\ge \\delta\\,$ and $\\,\\phi(|\\lambda|) = \\tfrac{1}{2}\\left(\\tfrac{\\lambda^2}{\\delta} + \\delta\\right)\\,$ if $\\,|\\lambda|  \\delta\\,$, where $\\,\\delta = \\varepsilon \\tilde{a}\\,$ and $\\,\\varepsilon = 0.1\\,$. Use $\\,\\delta\\,$ with units of $\\mathrm{m/s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Represent each case’s flux vector as a sublist of three floats $[F_{\\rho}, F_{\\rho u}, F_{\\rho E}]$ with no spaces, and aggregate the four sublists into a single outer list. For example, the output format must be like $\\,[[f_{11},f_{12},f_{13}],[f_{21},f_{22},f_{23}],[f_{31},f_{32},f_{33}],[f_{41},f_{42},f_{43}]]\\,$, where each $\\,f_{ij}\\,$ is a float. The numerical values must be in the units specified above for mass, momentum, and energy fluxes, respectively.",
            "solution": "The task is to construct Roe's linearized Riemann solver for the one-dimensional compressible Euler equations and use it to compute the numerical flux at an interface for given left and right states. The derivation begins with the fundamental equations and proceeds to the final numerical flux formula, including the Roe-averaging procedure, eigenstructure analysis, and an entropy fix.\n\nThe one-dimensional Euler equations in conservation form are given by:\n$$\n\\frac{\\partial \\mathbf{Q}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{Q})}{\\partial x} = \\mathbf{0}\n$$\nwhere $\\mathbf{Q}$ is the vector of conserved variables and $\\mathbf{F}(\\mathbf{Q})$ is the flux vector:\n$$\n\\mathbf{Q} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}, \\quad \\mathbf{F}(\\mathbf{Q}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(\\rho E + p) \\end{pmatrix}\n$$\nHere, $\\rho$ is the density, $u$ is the velocity, $p$ is the pressure, and $E$ is the specific total energy. For a perfect gas, the pressure is related to the specific internal energy $e$ by the equation of state:\n$$\np = (\\gamma - 1)\\rho e\n$$\nwhere $\\gamma$ is the constant ratio of specific heats. The specific total energy $E$ is the sum of specific internal and kinetic energies:\n$$\nE = e + \\frac{1}{2}u^2\n$$\nFrom these relations, we can express pressure $p$ and total enthalpy $H$ in terms of primitive variables $(\\rho, u, p)$ or conserved variables $\\mathbf{Q}$:\n$$\np = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^2\\right)\n$$\n$$\nH = E + \\frac{p}{\\rho} = e + \\frac{1}{2}u^2 + \\frac{p}{\\rho} = \\frac{\\gamma p}{(\\gamma-1)\\rho} + \\frac{1}{2}u^2\n$$\n\nThe Roe solver is based on finding a matrix $\\tilde{\\mathbf{A}}(\\mathbf{Q}_L, \\mathbf{Q}_R)$ that is a consistent linearization of the flux Jacobian $\\mathbf{A}(\\mathbf{Q}) = \\partial\\mathbf{F}/\\partial\\mathbf{Q}$. This matrix must satisfy three properties:\n1.  It is hyperbolic for any states $\\mathbf{Q}_L, \\mathbf{Q}_R$, meaning it has a full set of real eigenvalues and linearly independent eigenvectors.\n2.  It is consistent with the Jacobian, i.e., $\\tilde{\\mathbf{A}}(\\mathbf{Q}, \\mathbf{Q}) = \\mathbf{A}(\\mathbf{Q})$.\n3.  It satisfies the Rankine-Hugoniot jump condition across a discontinuity: $\\mathbf{F}(\\mathbf{Q}_R) - \\mathbf{F}(\\mathbf{Q}_L) = \\tilde{\\mathbf{A}}(\\mathbf{Q}_R - \\mathbf{Q}_L)$.\n\nSuch a matrix can be constructed by evaluating the Jacobian $\\mathbf{A}(\\mathbf{Q})$ at a specially defined \"Roe-averaged\" state. For the Euler equations with a perfect gas, the Roe averages are:\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L}u_L + \\sqrt{\\rho_R}u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho_L}H_L + \\sqrt{\\rho_R}H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\nFrom the Roe-averaged total enthalpy $\\tilde{H}$ and velocity $\\tilde{u}$, we can define a consistent Roe-averaged sound speed $\\tilde{a}$:\n$$\n\\tilde{a}^2 = (\\gamma - 1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2\\right)\n$$\nThe Roe matrix $\\tilde{\\mathbf{A}}$ is the flux Jacobian $\\mathbf{A}$ expressed in terms of primitive variables and evaluated at this Roe-averaged state $(\\tilde{u}, \\tilde{H}, \\tilde{a})$. The Jacobian matrix is:\n$$\n\\mathbf{A} = \\begin{pmatrix} 0  1  0 \\\\ \\frac{\\gamma-3}{2}u^2  (3-\\gamma)u  \\gamma-1 \\\\ u\\left(\\frac{\\gamma-1}{2}u^2 - H\\right)  H - (\\gamma-1)u^2  \\gamma u \\end{pmatrix}\n$$\nEvaluating this at the Roe state gives $\\tilde{\\mathbf{A}} = \\mathbf{A}(\\tilde{u}, \\tilde{H})$.\n\nThe eigenstructure of $\\tilde{\\mathbf{A}}$ is central to the solver. The eigenvalues are:\n$$\n\\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a}, \\quad \\tilde{\\lambda}_2 = \\tilde{u}, \\quad \\tilde{\\lambda}_3 = \\tilde{u} + \\tilde{a}\n$$\nThese eigenvalues correspond to the speeds of a left-going acoustic wave, a contact (entropy) wave, and a right-going acoustic wave, respectively. The signs of these eigenvalues indicate the direction of information propagation for each characteristic family.\nThe corresponding right eigenvectors are:\n$$\n\\tilde{\\mathbf{k}}_1 = \\begin{pmatrix} 1 \\\\ \\tilde{u}-\\tilde{a} \\\\ \\tilde{H}-\\tilde{u}\\tilde{a} \\end{pmatrix}, \\quad \\tilde{\\mathbf{k}}_2 = \\begin{pmatrix} 1 \\\\ \\tilde{u} \\\\ \\frac{1}{2}\\tilde{u}^2 \\end{pmatrix}, \\quad \\tilde{\\mathbf{k}}_3 = \\begin{pmatrix} 1 \\\\ \\tilde{u}+\\tilde{a} \\\\ \\tilde{H}+\\tilde{u}\\tilde{a} \\end{pmatrix}\n$$\nThe jump in conserved variables, $\\Delta \\mathbf{Q} = \\mathbf{Q}_R - \\mathbf{Q}_L$, can be projected onto this eigenvector basis:\n$$\n\\Delta \\mathbf{Q} = \\sum_{i=1}^3 \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i\n$$\nwhere $\\tilde{\\alpha}_i$ are the wave strengths. Solving this $3 \\times 3$ system for $\\tilde{\\alpha}_i$ yields:\n$$\n\\tilde{\\alpha}_2 = \\frac{\\gamma-1}{\\tilde{a}^2} \\left[ (\\tilde{H}-\\tilde{u}^2)\\Delta\\rho + \\tilde{u}\\Delta(\\rho u) - \\Delta(\\rho E) \\right]\n$$\n$$\n\\tilde{\\alpha}_1 = \\frac{1}{2} \\left[ (\\Delta\\rho - \\tilde{\\alpha}_2) + \\frac{\\tilde{u}\\Delta\\rho - \\Delta(\\rho u)}{\\tilde{a}} \\right]\n$$\n$$\n\\tilde{\\alpha}_3 = \\frac{1}{2} \\left[ (\\Delta\\rho - \\tilde{\\alpha}_2) - \\frac{\\tilde{u}\\Delta\\rho - \\Delta(\\rho u)}{\\tilde{a}} \\right]\n$$\nwhere $\\Delta\\rho = \\rho_R - \\rho_L$, $\\Delta(\\rho u) = (\\rho u)_R - (\\rho u)_L$, and $\\Delta(\\rho E) = (\\rho E)_R - (\\rho E)_L$.\n\nThe Roe numerical flux, $\\mathbf{F}_{\\text{Roe}}$, is a Godunov-type flux that incorporates upwinding based on the signs of the eigenvalues. It is calculated as the average of the left and right fluxes plus a dissipation term that accounts for the wave structure of the Riemann problem solution:\n$$\n\\mathbf{F}_{\\text{Roe}} = \\frac{1}{2}(\\mathbf{F}_L + \\mathbf{F}_R) - \\frac{1}{2} |\\tilde{\\mathbf{A}}|(\\mathbf{Q}_R - \\mathbf{Q}_L)\n$$\nThe dissipation term $|\\tilde{\\mathbf{A}}|(\\mathbf{Q}_R - \\mathbf{Q}_L)$ is computed using the eigen-decomposition:\n$$\n|\\tilde{\\mathbf{A}}|(\\mathbf{Q}_R - \\mathbf{Q}_L) = \\sum_{i=1}^3 |\\tilde{\\lambda}_i| \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i\n$$\nThis leads to the final expression for the Roe flux:\n$$\n\\mathbf{F}_{\\text{Roe}} = \\frac{1}{2}(\\mathbf{F}_L + \\mathbf{F}_R) - \\frac{1}{2} \\sum_{i=1}^3 |\\tilde{\\lambda}_i| \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i\n$$\n\nA critical issue with the Roe solver is the failure to add sufficient dissipation for transonic rarefaction waves, where an eigenvalue $\\tilde{\\lambda}_i$ can pass through zero. This can lead to entropy-violating expansion shocks. To remedy this, an \"entropy fix\" is applied by modifying the absolute value function $|\\lambda|$. As specified, we replace $|\\lambda|$ with a function $\\phi(|\\lambda|)$:\n$$\n\\phi(|\\lambda|) = \\begin{cases} |\\lambda|  \\text{if } |\\lambda| \\ge \\delta \\\\ \\frac{1}{2}\\left(\\frac{\\lambda^2}{\\delta} + \\delta\\right)  \\text{if } |\\lambda|  \\delta \\end{cases}\n$$\nwhere $\\delta = \\varepsilon \\tilde{a}$ is a small positive threshold, with $\\varepsilon = 0.1$. The dissipation term is thus modified to $\\sum_{i=1}^3 \\phi(|\\tilde{\\lambda}_i|) \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i$, ensuring a strictly positive amount of dissipation at sonic points.\n\nThe computational procedure to find $\\mathbf{F}_{\\text{Roe}}$ given left/right primitive states $(\\rho_L, u_L, p_L)$, $(\\rho_R, u_R, p_R)$ and $\\gamma$ is:\n1.  Calculate derived quantities ($E_L, H_L, E_R, H_R$) and form the state vectors $\\mathbf{Q}_L, \\mathbf{Q}_R$ and flux vectors $\\mathbf{F}_L, \\mathbf{F}_R$.\n2.  Compute the Roe-averaged variables $\\tilde{u}$, $\\tilde{H}$, and $\\tilde{a}$.\n3.  Calculate the jumps in conserved variables $\\Delta\\rho$, $\\Delta(\\rho u)$, $\\Delta(\\rho E)$.\n4.  Determine the wave strengths $\\tilde{\\alpha}_1, \\tilde{\\alpha}_2, \\tilde{\\alpha}_3$.\n5.  Find the eigenvalues $\\tilde{\\lambda}_1, \\tilde{\\lambda}_2, \\tilde{\\lambda}_3$ and the right eigenvectors $\\tilde{\\mathbf{k}}_1, \\tilde{\\mathbf{k}}_2, \\tilde{\\mathbf{k}}_3$.\n6.  Apply the entropy fix to each $|\\tilde{\\lambda}_i|$ to get $\\phi(|\\tilde{\\lambda}_i|)$.\n7.  Compute the total dissipation vector by summing the contributions from each wave: $\\sum_{i=1}^3 \\phi(|\\tilde{\\lambda}_i|) \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i$.\n8.  Assemble the final Roe flux vector $\\mathbf{F}_{\\text{Roe}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are permitted.\n\ndef solve():\n    \"\"\"\n    Constructs and applies Roe's linearized Riemann solver for the 1D Euler equations.\n    \"\"\"\n\n    def compute_roe_flux(rho_L, u_L, p_L, rho_R, u_R, p_R, gamma, epsilon=0.1):\n        \"\"\"\n        Computes the Roe numerical flux for the 1D Euler equations.\n\n        Args:\n            rho_L, u_L, p_L: Primitive variables (density, velocity, pressure) for the left state.\n            rho_R, u_R, p_R: Primitive variables for the right state.\n            gamma: Ratio of specific heats.\n            epsilon: Parameter for the entropy fix.\n\n        Returns:\n            A numpy array representing the Roe flux vector [F_rho, F_rho_u, F_rho_E].\n        \"\"\"\n        # 1. Compute derived quantities and state/flux vectors\n        # Left state\n        e_L = p_L / ((gamma - 1.0) * rho_L)\n        E_L = e_L + 0.5 * u_L**2\n        H_L = E_L + p_L / rho_L\n        Q_L = np.array([rho_L, rho_L * u_L, rho_L * E_L])\n        F_L = np.array([rho_L * u_L, rho_L * u_L**2 + p_L, u_L * (rho_L * E_L + p_L)])\n\n        # Right state\n        e_R = p_R / ((gamma - 1.0) * rho_R)\n        E_R = e_R + 0.5 * u_R**2\n        H_R = E_R + p_R / rho_R\n        Q_R = np.array([rho_R, rho_R * u_R, rho_R * E_R])\n        F_R = np.array([rho_R * u_R, rho_R * u_R**2 + p_R, u_R * (rho_R * E_R + p_R)])\n\n        # 2. Compute Roe-averaged state\n        sqrt_rho_L = np.sqrt(rho_L)\n        sqrt_rho_R = np.sqrt(rho_R)\n        \n        u_tilde = (sqrt_rho_L * u_L + sqrt_rho_R * u_R) / (sqrt_rho_L + sqrt_rho_R)\n        H_tilde = (sqrt_rho_L * H_L + sqrt_rho_R * H_R) / (sqrt_rho_L + sqrt_rho_R)\n        \n        # Handle potential for negative value due to floating point arithmetic\n        a_sq_tilde_val = (gamma - 1.0) * (H_tilde - 0.5 * u_tilde**2)\n        if a_sq_tilde_val  0:\n            # This case indicates unphysical input states for the perfect gas model.\n            # A more robust implementation might average sound speed directly.\n            # For well-posed problems, this should not occur.\n            # We take the average of squared sound speeds as a fallback.\n            a_L_sq = gamma * p_L / rho_L\n            a_R_sq = gamma * p_R / rho_R\n            a_sq_tilde = 0.5 * (a_L_sq + a_R_sq)\n        else:\n            a_sq_tilde = a_sq_tilde_val\n\n        a_tilde = np.sqrt(a_sq_tilde)\n\n        # 3. Compute jumps in conserved variables\n        delta_Q = Q_R - Q_L\n        delta_rho = delta_Q[0]\n        delta_rho_u = delta_Q[1]\n        delta_rho_E = delta_Q[2]\n        \n        # 4. Compute wave strengths\n        # Note: A direct implementation of the formulas can be sensitive to\n        # floating point errors, especially if a_tilde is small.\n        # This implementation follows the direct derivation.\n        \n        # Strength of the entropy wave (lambda = u_tilde)\n        alpha_2 = (gamma - 1.0) / a_sq_tilde * \\\n                  ((H_tilde - u_tilde**2) * delta_rho + u_tilde * delta_rho_u - delta_rho_E)\n        \n        # Strength of acoustic waves (lambda = u_tilde +- a_tilde)\n        term_in_paren = (u_tilde * delta_rho - delta_rho_u) / a_tilde\n        alpha_1 = 0.5 * (delta_rho - alpha_2 + term_in_paren)\n        alpha_3 = 0.5 * (delta_rho - alpha_2 - term_in_paren)\n\n        # Alternative for alpha_3 to reduce dependency\n        # alpha_3 = delta_rho - alpha_1 - alpha_2\n\n        # 5. Compute eigenvalues and eigenvectors\n        lambdas = np.array([u_tilde - a_tilde, u_tilde, u_tilde + a_tilde])\n        alphas = np.array([alpha_1, alpha_2, alpha_3])\n        \n        k1 = np.array([1.0, u_tilde - a_tilde, H_tilde - u_tilde * a_tilde])\n        k2 = np.array([1.0, u_tilde, 0.5 * u_tilde**2])\n        k3 = np.array([1.0, u_tilde + a_tilde, H_tilde + u_tilde * a_tilde])\n        \n        eigenvectors = [k1, k2, k3]\n\n        # 6. Apply entropy fix\n        delta = epsilon * a_tilde\n        phi_lambdas = np.zeros_like(lambdas)\n        for i, lam in enumerate(lambdas):\n            abs_lam = np.abs(lam)\n            if abs_lam  delta:\n                phi_lambdas[i] = 0.5 * (lam**2 / delta + delta)\n            else:\n                phi_lambdas[i] = abs_lam\n\n        # 7. Compute numerical dissipation term\n        dissipation = np.zeros(3)\n        for i in range(3):\n            dissipation += phi_lambdas[i] * alphas[i] * eigenvectors[i]\n\n        # 8. Assemble the final Roe flux\n        F_roe = 0.5 * (F_L + F_R) - 0.5 * dissipation\n        return F_roe\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Supersonic right-going\n        (1.0, 800.0, 100000.0, 0.8, 700.0, 100000.0, 1.4),\n        # Case 2: Transonic mixed\n        (1.0, 300.0, 100000.0, 1.0, 0.0, 100000.0, 1.4),\n        # Case 3: Strong pressure jump (Sod-like)\n        (5.0, 0.0, 500000.0, 1.0, 0.0, 100000.0, 1.4),\n        # Case 4: Contact discontinuity\n        (2.0, 100.0, 100000.0, 1.0, 100.0, 100000.0, 1.4),\n    ]\n\n    results = []\n    for case in test_cases:\n        rho_L, u_L, p_L, rho_R, u_R, p_R, gamma = case\n        flux_vector = compute_roe_flux(rho_L, u_L, p_L, rho_R, u_R, p_R, gamma)\n        results.append([flux_vector[0], flux_vector[1], flux_vector[2]])\n\n    # Final print statement in the exact required format.\n    # Format: [[f11,f12,f13],[f21,f22,f23],...]\n    sublist_strings = [f\"[{v[0]},{v[1]},{v[2]}]\" for v in results]\n    final_output = f\"[{','.join(sublist_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}