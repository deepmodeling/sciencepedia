{
    "hands_on_practices": [
        {
            "introduction": "理解可压缩波现象的第一步是量化其最基本属性之一：激波的传播速度。本练习将引导你从质量守恒这一基本物理原理出发，推导出一个移动激波速度的表达式。通过这个实践，你将掌握如何利用激波两侧的流体状态来确定激波本身的运动学特性，这是分析和模拟激波动力学的基础。",
            "id": "3948139",
            "problem": "气体中的一维平面压缩激波采用无粘一维欧拉方程进行建模，这是计算流体力学 (CFD) 中的标准方法。考虑一个激波分隔了两个均匀定常状态，分别表示为左侧状态 $\\left(\\rho_{L}, u_{L}, p_{L}\\right)$ 和右侧状态 $\\left(\\rho_{R}, u_{R}, p_{R}\\right)$，其中 $\\rho$ 是密度，$u$ 是实验室坐标系中的流速，$p$ 是热力学压力。该间断（激波）以未知的激波速度 $s$ 沿正 $x$ 方向传播。左侧状态代表上游流，右侧状态代表下游流。假设在激波固定坐标系中间断是平面定常的，并且流动是无粘、绝热的，且无体积力。\n\n从跨越移动间断的质量守恒积分形式出发，利用垂直于激波的质量通量 $m$ 是连续的这一事实，其在激波两侧由 $m = \\rho \\left(u - s\\right)$ 给出。推导出仅用 $\\rho_{L}$、$u_{L}$、$\\rho_{R}$ 和 $u_{R}$ 表示的激波速度 $s$ 的显式解析表达式。然后，对以下给定的左右两侧状态数值，计算 $s$ 的值：\n- $\\rho_{L} = 1.1~\\mathrm{kg/m^{3}}$，$u_{L} = 80~\\mathrm{m/s}$，$p_{L} = 1.00 \\times 10^{5}~\\mathrm{Pa}$，\n- $\\rho_{R} = 3.5~\\mathrm{kg/m^{3}}$，$u_{R} = 260~\\mathrm{m/s}$，$p_{R} = 1.51975 \\times 10^{5}~\\mathrm{Pa}$。\n\n将激波速度的最终数值答案以 $\\mathrm{m/s}$ 为单位表示，并四舍五入到四位有效数字。您必须提供一个最终的单一数字作为答案。",
            "solution": "该问题要求推导激波速度 $s$ 的解析表达式，并随后进行数值计算。推导从跨越移动间断的质量守恒原理开始。\n\n问题陈述，垂直于激波的质量通量 $m$ 是连续的。在实验室坐标系中，相对于移动激波的质量通量定义为 $m = \\rho(u-s)$，其中 $\\rho$ 是密度，$u$ 是实验室坐标系中的流体速度，$s$ 是激波的传播速度。跨越激波的质量通量连续性意味着，在间断的上游（左侧，下标 $L$）和下游（右侧，下标 $R$）两侧，$m$ 的值是相同的。\n\n这给出了控制关系式：\n$$m_{L} = m_{R}$$\n代入给定的质量通量表达式，我们得到：\n$$\\rho_{L} (u_{L} - s) = \\rho_{R} (u_{R} - s)$$\n\n这个方程是朗金-雨贡纽关系式之一，特别是关于质量守恒的关系式。为了求出激波速度 $s$ 的显式表达式，我们必须对该方程进行代数重排。首先，我们展开方程的两边：\n$$\\rho_{L} u_{L} - \\rho_{L} s = \\rho_{R} u_{R} - \\rho_{R} s$$\n\n接下来，我们将所有包含未知变量 $s$ 的项集中到方程的一边，将所有其他项集中到另一边。\n$$\\rho_{R} s - \\rho_{L} s = \\rho_{R} u_{R} - \\rho_{L} u_{L}$$\n\n我们可以从左边的项中提出因子 $s$：\n$$s (\\rho_{R} - \\rho_{L}) = \\rho_{R} u_{R} - \\rho_{L} u_{L}$$\n\n最后，我们通过除以 $(\\rho_{R} - \\rho_{L})$ 来分离出 $s$。这是允许的，因为对于激波，存在密度跳跃，所以 $\\rho_{R} \\neq \\rho_{L}$。具体来说，对于压缩激波，$\\rho_{R} > \\rho_{L}$，因此分母不为零。\n$$s = \\frac{\\rho_{R} u_{R} - \\rho_{L} u_{L}}{\\rho_{R} - \\rho_{L}}$$\n\n这就是所要求的，仅用 $\\rho_{L}$、$u_{L}$、$\\rho_{R}$ 和 $u_{R}$ 表示的激波速度 $s$ 的显式解析表达式。注意，根据问题陈述，此特定推导不需要压力值 $p_L$ 和 $p_R$。\n\n现在，我们使用提供的数值来计算这个表达式：\n- $\\rho_{L} = 1.1~\\mathrm{kg/m^{3}}$\n- $u_{L} = 80~\\mathrm{m/s}$\n- $\\rho_{R} = 3.5~\\mathrm{kg/m^{3}}$\n- $u_{R} = 260~\\mathrm{m/s}$\n\n我们首先计算表达式的分子，它代表动量通量 $\\rho u$ 的差值：\n$$\\rho_{R} u_{R} - \\rho_{L} u_{L} = (3.5)(260) - (1.1)(80)$$\n$$\\rho_{R} u_{R} - \\rho_{L} u_{L} = 910 - 88 = 822~\\mathrm{kg/(m^2 \\cdot s)}$$\n\n接下来，我们计算分母，即密度的变化量：\n$$\\rho_{R} - \\rho_{L} = 3.5 - 1.1 = 2.4~\\mathrm{kg/m^3}$$\n\n现在我们可以计算激波速度 $s$：\n$$s = \\frac{822}{2.4} = 342.5~\\mathrm{m/s}$$\n\n问题要求最终答案四舍五入到四位有效数字。计算出的值 $342.5$ 已经恰好是四位有效数字。因此，不需要进一步的舍入。\n激波速度为 $s = 342.5~\\mathrm{m/s}$。正号表示激波沿正 $x$ 方向传播，与问题描述一致。",
            "answer": "$$\\boxed{342.5}$$"
        },
        {
            "introduction": "在计算流体动力学中，处理激波等间断有两种主要方法。本练习聚焦于“激波装配”法，即将激波显式地处理为一个移动的边界。你将从积分形式的守恒律出发，为这个移动边界推导完整的跳跃条件，并将这些关系付诸实践，编写一个程序来耦合激波两侧的解。这个练习将加深你对Rankine-Hugoniot关系在移动坐标系下应用的理解，并为你提供一种精确处理间断的强大数值工具。",
            "id": "3948183",
            "problem": "考虑在计算流体动力学（CFD）的背景下，一种用于无粘、可压缩、理想气体流动的一维、平面激波拟合（shock-fitting）公式。激波被视为一个具有指定法向速度的移动边界，其两侧的内部流场解通过跨越间断的守恒定律耦合。从应用于跨越间断的薄时空控制体的质量、动量和能量的积分守恒陈述出发，推导在实验室坐标系下，移动激波上游和下游紧邻状态之间的跳跃条件。\n\n您必须从一个有效的基础出发：欧拉方程的积分形式（质量、动量和能量守恒）和理想气体状态方程，这些方程是为边界以给定法向速度移动的微分控制面表达的。在推导过程中，不要使用或假设任何预先推导出的跳跃关系作为捷径。阐明激波运动学如何进入耦合，以及流体相对于激波的法向速度分量如何出现在通量中。\n\n一旦推导出跳跃条件，将其在一个程序中实现。对于每个给定的测试用例，该程序接收上游热力学状态和法向速度，以及激波法向速度，并返回实验室坐标系下的下游热力学状态和速度。假设一种理想气体，其特征在于比热比和特定气体常数。如果相对于激波的上游法向马赫数不严格为超音速，则将该界面视为一个消失的间断，并返回未改变的上游状态，但仍需报告根据相对运动计算的质量通量。\n\n在您的推导和实现中定义所有变量。使用以下约定：\n- 令上游状态为 $(p_1, T_1, \\rho_1, u_1)$，其中 $p_1$ 是压力，$T_1$ 是温度，$\\rho_1$ 是密度，$u_1$ 是垂直于激波的流体速度，所有量均在实验室坐标系中测量。\n- 令激波法向速度在实验室坐标系中为 $V_s$；正的 $V_s$ 表示激波沿法向正方向移动。\n- 令比热比为 $\\gamma$，特定气体常数为 $R$。\n- 令下游状态为 $(p_2, T_2, \\rho_2, u_2)$，在实验室坐标系中。\n- 令穿过激波的单位面积质量通量为 $\\dot{m}$（有符号），单位质量的熵变为 $\\Delta s = s_2 - s_1$。\n\n单位和数值要求：\n- 压力必须以帕斯卡（Pa）表示。\n- 温度必须以开尔文（K）表示。\n- 密度必须以千克每立方米（kg/m$^3$）表示。\n- 速度必须以米每秒（m/s）表示。\n- 熵变必须以焦耳每千克开尔文（J/(kg·K)）表示。\n- 单位面积质量通量必须以千克每平方米秒（kg/(m$^2$·s)）表示。\n- 对任何角度均使用弧度，尽管在此一维设定中不需要角度。\n- 报告所有数值输出，四舍五入到六位小数。\n\n测试套件：\n对于所有测试用例，使用 $\\gamma = 1.4$ 和 $R = 287$ J/(kg·K)。对于每个测试用例，计算并返回列表 $[p_2,\\ \\rho_2,\\ u_2,\\ \\Delta s,\\ \\dot{m}]$，使用指定的单位。\n\n- 测试用例 1 (正常情况，激波向前移动):\n  - $p_1 = 101325$ Pa, $T_1 = 300$ K, $u_1 = 600$ m/s, $V_s = 100$ m/s.\n- 测试用例 2 (静止激波，强压缩):\n  - $p_1 = 50000$ Pa, $T_1 = 250$ K, $u_1 = 800$ m/s, $V_s = 0$ m/s.\n- 测试用例 3 (激波向上游移动，中等压缩):\n  - $p_1 = 200000$ Pa, $T_1 = 350$ K, $u_1 = 500$ m/s, $V_s = -50$ m/s.\n- 测试用例 4 (相对于激波的上游接近音速，弱压缩):\n  - $p_1 = 90000$ Pa, $T_1 = 300$ K, $u_1 = 350$ m/s, $V_s = 0$ m/s.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个元素对应一个测试用例，并且本身必须是 $[p_2,\\ \\rho_2,\\ u_2,\\ \\Delta s,\\ \\dot{m}]$ 形式的列表，所有条目四舍五入到六位小数，例如：\n$[[p_{2,1},\\rho_{2,1},u_{2,1},\\Delta s_1,\\dot{m}_1],[p_{2,2},\\rho_{2,2},u_{2,2},\\Delta s_2,\\dot{m}_2],\\ldots]$。",
            "solution": "我们考虑一种一维、平面、无粘、可压缩的理想气体流动，其中激波被视为一个移动边界。跨越激波的内部解的耦合源于应用于跨越间断的薄控制体的守恒定律。设激波面有一个从上游侧 $1$ 指向下游侧 $2$ 的单位法向量，并设实验室坐标系中的激波法向速度为 $V_s$。在实验室坐标系中，激波两侧垂直于激波的流体速度分别为 $u_1$ 和 $u_2$。热力学状态分别为 $(p_1, T_1, \\rho_1)$ 和 $(p_2, T_2, \\rho_2)$。气体是理想气体，比热比为 $\\gamma$，特定气体常数为 $R$。我们用 $h$ 表示比焓，用 $a = \\sqrt{\\gamma R T}$ 表示声速。\n\n1. 基础：移动控制面的积分守恒定律。\n\n将跨激波的跳跃算子定义为 $[f] = f_2 - f_1$，其中 $f$ 是分别在紧邻下游和上游评估的任意量。考虑一个薄的“药盒”形控制体，它包围了一部分激波表面，其边界沿法线以局部速度 $V_s$ 移动。将质量、动量和能量的积分形式守恒定律应用于此控制体，并令其厚度趋于零，可得到以下无粘流动的关系式（忽略体力以及跨越无穷薄表面的热传导）：\n\n- 质量守恒（相对于移动表面的法向质量通量的连续性）：\n$$\n[\\rho (u_n - V_s)] = 0,\n$$\n其中 $u_n$ 是实验室坐标系中流体速度的法向分量。\n\n- 法向动量守恒（法向动量通量与压力的平衡）：\n$$\n[\\rho (u_n - V_s) u_n + p] = 0.\n$$\n\n- 平面无粘激波的切向动量守恒（理想化激波上无剪切应力及切向速度的连续性）：\n$$\n[\\rho (u_n - V_s) u_t] = 0, \\quad \\text{以及对于正激波, } [u_t] = 0,\n$$\n其中 $u_t$ 表示切向分量。在严格的一维正激波中，两侧都有 $u_t = 0$。\n\n- 能量守恒（相对于移动表面的总焓通量的连续性）：\n$$\n\\left[ \\rho (u_n - V_s)\\left(h + \\tfrac{1}{2} u^2 \\right) \\right] = 0.\n$$\n\n这些关系式与实验室坐标系中激波的绝对速度无关；它们是通过在控制面项中考虑移动边界，在随激波坐标系下推导出来的。\n\n2. 相对运动与随激波坐标系解释。\n\n引入相对于激波的法向速度：\n$$\nw_1 = u_1 - V_s, \\quad w_2 = u_2 - V_s.\n$$\n质量守恒跳跃条件变为\n$$\n\\rho_1 w_1 = \\rho_2 w_2 = \\dot{m},\n$$\n其中 $\\dot{m}$ 是穿过激波的单位面积质量通量（有符号，向下游方向为正）。法向动量条件为\n$$\n\\rho_1 w_1 u_1 + p_1 = \\rho_2 w_2 u_2 + p_2,\n$$\n能量条件变为\n$$\n\\rho_1 w_1 \\left(h_1 + \\tfrac{1}{2} u_1^2 \\right) = \\rho_2 w_2 \\left(h_2 + \\tfrac{1}{2} u_2^2 \\right).\n$$\n在随激波坐标系中，激波是静止的，通量取决于 $w_1$ 和 $w_2$ 而不是 $u_1$ 和 $u_2$。使用 $u_i = V_s + w_i$，动量条件可以重写为\n$$\n\\rho_1 w_1 (V_s + w_1) + p_1 = \\rho_2 w_2 (V_s + w_2) + p_2.\n$$\n因为 $\\rho_1 w_1 = \\rho_2 w_2$，含有 $V_s$ 的项相互抵消，得到以相对速度表示的熟悉的静止激波动量条件：\n$$\np_2 - p_1 = \\dot{m} (w_1 - w_2).\n$$\n类似地，能量条件（在使用理想气体关系 $h = c_p T$ 和 $c_p = \\gamma R / (\\gamma - 1)$ 并进行代数运算后）简化为相对运动中静止激波的总焓通量连续性：\n$$\nh_1 + \\tfrac{1}{2} w_1^2 = h_2 + \\tfrac{1}{2} w_2^2.\n$$\n\n3. 针对理想气体和正激波的跳跃条件。\n\n对于理想气体，状态方程为 $p = \\rho R T$，声速为 $a = \\sqrt{\\gamma R T}$。定义上游相对法向马赫数\n$$\nM_1 = \\frac{|w_1|}{a_1}, \\quad a_1 = \\sqrt{\\gamma R T_1}.\n$$\n对于压缩正激波，我们需要 $M_1 > 1$。在此条件下，朗金-雨贡纽（Rankine–Hugoniot）关系式给出了以 $M_1$ 和 $\\gamma$ 表示的经典的下游与上游之比：\n- 密度比：\n$$\n\\frac{\\rho_2}{\\rho_1} = \\frac{(\\gamma + 1) M_1^2}{(\\gamma - 1) M_1^2 + 2}.\n$$\n- 压力比：\n$$\n\\frac{p_2}{p_1} = 1 + \\frac{2 \\gamma}{\\gamma + 1} \\left(M_1^2 - 1\\right).\n$$\n- 温度比可从理想气体定律得出：\n$$\n\\frac{T_2}{T_1} = \\frac{p_2/p_1}{\\rho_2/\\rho_1}.\n$$\n相对运动中的质量守恒提供了\n$$\nw_2 = w_1 \\frac{\\rho_1}{\\rho_2},\n$$\n然后下游实验室坐标系速度为\n$$\nu_2 = V_s + w_2.\n$$\n跨越激波的单位质量熵变为（对于理想气体）\n$$\n\\Delta s = s_2 - s_1 = c_p \\ln\\left(\\frac{T_2}{T_1}\\right) - R \\ln\\left(\\frac{p_2}{p_1}\\right),\n$$\n其中 $c_p = \\frac{\\gamma R}{\\gamma - 1}$。\n\n如果 $M_1 \\leq 1$，则无法形成压缩正激波。在激波拟合算法中，该间断会退化。在此极限下，一种一致的处理方法是返回未改变的上游状态：$p_2 = p_1$，$\\rho_2 = \\rho_1$，$T_2 = T_1$ 和 $u_2 = u_1$，熵变设为 $\\Delta s = 0$。质量通量仍然由相对运动明确定义：\n$$\n\\dot{m} = \\rho_1 w_1 = \\rho_1 (u_1 - V_s),\n$$\n即使在间断消失的极限情况下，它也作为界面运动的运动学耦合量。\n\n4. 程序的算法设计。\n\n- 每个测试用例的输入参数：$\\gamma$，$R$，$p_1$，$T_1$，$u_1$，$V_s$。\n- 通过理想气体定律计算上游密度：\n$$\n\\rho_1 = \\frac{p_1}{R T_1}.\n$$\n- 计算上游声速：\n$$\na_1 = \\sqrt{\\gamma R T_1}.\n$$\n- 计算上游相对法向速度：\n$$\nw_1 = u_1 - V_s.\n$$\n- 计算上游相对马赫数：\n$$\nM_1 = \\frac{|w_1|}{a_1}.\n$$\n- 如果 $M_1 \\leq 1$，设置 $p_2 = p_1$，$\\rho_2 = \\rho_1$，$T_2 = T_1$，$u_2 = u_1$，$\\Delta s = 0$，以及 $\\dot{m} = \\rho_1 w_1$。\n- 如果 $M_1 > 1$，通过上述跳跃条件计算下游比率，然后：\n  - $\\rho_2 = \\rho_1 \\times (\\rho_2/\\rho_1)$,\n  - $p_2 = p_1 \\times (p_2/p_1)$,\n  - $T_2 = T_1 \\times (T_2/T_1)$,\n  - $w_2 = w_1 \\times (\\rho_1/\\rho_2)$,\n  - $u_2 = V_s + w_2$,\n  - $c_p = \\gamma R / (\\gamma - 1)$,\n  - $\\Delta s = c_p \\ln(T_2/T_1) - R \\ln(p_2/p_1)$,\n  - $\\dot{m} = \\rho_1 w_1$.\n\n最后，为每个测试用例报告列表 $[p_2,\\ \\rho_2,\\ u_2,\\ \\Delta s,\\ \\dot{m}]$，四舍五入到六位小数，并聚合成一个按指定格式的单一括号列表。\n\n这个过程体现了一种激波拟合方法：激波是一个速度为 $V_s$ 的移动边界，两侧的内部解是受跳跃条件约束的欧拉解，运动学耦合通过相对法向速度 $w$ 和质量通量 $\\dot{m}$ 发生。移动边界的特性仅通过 $w = u - V_s$ 进入，而下游实验室坐标系速度的重构 $u_2 = V_s + w_2$ 确保了随激波坐标系分析与实验室坐标系之间的一致性。",
            "answer": "[[228236.437171,2.069485,384.269974,15.540166,588.303310],[310937.500000,3.315789,241.250000,103.352825,627.453303],[497260.416667,2.836034,364.729730,49.043510,314.194725],[91684.090680,1.059293,345.362228,0.004944,365.853659]]"
        },
        {
            "introduction": "与激波装配法相对的是更为普遍的“激波捕捉”法，它允许数值格式在不显式追踪间断位置的情况下自动形成激波。这种方法的核心是构造一个智能的数值通量，而Roe格式的黎曼求解器正是其中的典范。本练习将指导你构建一个完整的Roe求解器，从推导Roe平均状态和通量雅可比矩阵的特征结构，到理解基于特征值符号的迎风机制，并最终实现一个包含熵修正的数值通量函数。这个实践是掌握现代有限体积法的关键一步，它揭示了如何将波的物理传播特性融入到数值离散格式中。",
            "id": "3948194",
            "problem": "您的任务是为一维可压缩理想气体欧拉方程构建一个 Roe 线性化黎曼求解器，并用它计算给定左右状态下界面上的数值通量。构建过程必须从基本守恒定律和理想气体状态方程开始，并通过推导在 Roe 平均状态下通量雅可比矩阵的适当线性化来进行。具体来说，您必须：\n\n1. 从质量、动量和能量守恒的一维欧拉方程开始，其守恒变量向量为 $\\,\\mathbf{Q} = [\\rho,\\, \\rho u,\\, \\rho E]^\\top\\,$，通量向量为 $\\,\\mathbf{F}(\\mathbf{Q}) = [\\rho u,\\, \\rho u^2 + p,\\, u(\\rho E + p)]^\\top\\,$，其中 $\\,\\rho\\,$ 是密度，$\\,u\\,$ 是速度，$\\,p\\,$ 是压力，$\\,E\\,$ 是比总能。理想气体状态方程为 $\\,p = (\\gamma - 1)\\rho e\\,$，其中 $\\,e\\,$ 为比内能，比总能为 $\\,E = e + \\tfrac{1}{2}u^2\\,$。假设 $\\,\\gamma  1\\,$ 为常数。\n\n2. 通过适当地对左右状态进行加权来定义一个 Roe 平均状态，使得在 Roe 平均变量下评估的雅可比矩阵 $\\,\\tilde{\\mathbf{A}} = \\partial \\mathbf{F}/\\partial \\mathbf{Q}\\,$ 具有一个包含三个不同波的实特征结构。Roe 平均变量必须包括速度 $\\,\\tilde{u}\\,$、总焓 $\\,\\tilde{H}\\,$ 和声速 $\\,\\tilde{a}\\,$，这些变量需要根据理想气体关系和线性化必须保持 Rankine–Hugoniot 跳跃条件的要求来一致地推导。\n\n3. 推导在 Roe 状态下雅可比矩阵 $\\,\\tilde{\\mathbf{A}}\\,$ 的特征结构（特征值和右特征向量）。特征值必须可识别为 $\\,\\tilde{u} - \\tilde{a}\\,$、$\\,\\tilde{u}\\,$ 和 $\\,\\tilde{u} + \\tilde{a}\\,$，分别对应于左行声波、接触（熵）波和右行声波。解释迎风机制：每个特征值的符号决定了相应特征族的信息传播方向，并且必须据此构建数值耗散。包含一个熵修正，用于在特征值大小接近零的声速点附近对耗散进行正则化。\n\n4. 使用推导出的 Roe 线性化和迎风原理，实现一个计算程序，以在给定左右原始状态 $\\,(\\rho_L, u_L, p_L)\\,$ 和 $\\,(\\rho_R, u_R, p_R)\\,$ 以及 $\\,\\gamma\\,$ 的情况下，评估界面处的 Roe 数值通量 $\\,\\mathbf{F}_{\\text{Roe}}\\,$。输出必须是数值通量向量分量 $\\,\\mathbf{F}_{\\text{Roe}} = [F_{\\rho}, F_{\\rho u}, F_{\\rho E}]^\\top\\,$，其中 $\\,F_{\\rho}\\,$ 是质量通量，单位为 $\\mathrm{kg/(m^2\\cdot s)}$，$\\,F_{\\rho u}\\,$ 是动量通量，单位为 $\\mathrm{N/m^2}$，$\\,F_{\\rho E}\\,$ 是能量通量，单位为 $\\mathrm{W/m^2}$。所有计算必须使用国际单位制 (SI)。\n\n您的程序必须为以下测试案例集评估 Roe 数值通量（每个案例指定 $\\,\\rho_L\\,$ (单位 $\\mathrm{kg/m^3}$), $\\,u_L\\,$ (单位 $\\mathrm{m/s}$), $\\,p_L\\,$ (单位 $\\mathrm{Pa}$), $\\,\\rho_R\\,$ (单位 $\\mathrm{kg/m^3}$), $\\,u_R\\,$ (单位 $\\mathrm{m/s}$), $\\,p_R\\,$ (单位 $\\mathrm{Pa}$), 和无量纲的 $\\,\\gamma\\,$）：\n\n- 案例 1 (超音速右行，所有特征值为正)：$\\,\\rho_L = 1.0\\,$, $\\,u_L = 800.0\\,$, $\\,p_L = 100000.0\\,$; $\\,\\rho_R = 0.8\\,$, $\\,u_R = 700.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n- 案例 2 (跨音速混合，一个声波族符号改变)：$\\,\\rho_L = 1.0\\,$, $\\,u_L = 300.0\\,$, $\\,p_L = 100000.0\\,$; $\\,\\rho_R = 1.0\\,$, $\\,u_R = 0.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n- 案例 3 (强压力跳跃，静止界面)：$\\,\\rho_L = 5.0\\,$, $\\,u_L = 0.0\\,$, $\\,p_L = 500000.0\\,$; $\\,\\rho_R = 1.0\\,$, $\\,u_R = 0.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n- 案例 4 (接触间断，压力和速度相等)：$\\,\\rho_L = 2.0\\,$, $\\,u_L = 100.0\\,$, $\\,p_L = 100000.0\\,$; $\\,\\rho_R = 1.0\\,$, $\\,u_R = 100.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n\n实现一个熵修正，通过分段函数 $\\,\\phi(|\\lambda|) = |\\lambda|\\,$ (若 $\\,|\\lambda| \\ge \\delta\\,$) 和 $\\,\\phi(|\\lambda|) = \\tfrac{1}{2}\\left(\\tfrac{\\lambda^2}{\\delta} + \\delta\\right)\\,$ (若 $\\,|\\lambda|  \\delta\\,$) 来修改任意特征值 $\\,\\lambda\\,$ 的绝对值 $\\,|\\lambda|\\,$，其中 $\\,\\delta = \\varepsilon \\tilde{a}\\,$ 且 $\\,\\varepsilon = 0.1\\,$。使用单位为 $\\mathrm{m/s}$ 的 $\\,\\delta\\,$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。将每个案例的通量向量表示为三个浮点数的子列表 $[F_{\\rho}, F_{\\rho u}, F_{\\rho E}]$，不带空格，并将四个子列表聚合到一个外部列表中。例如，输出格式必须类似于 $\\,[[f_{11},f_{12},f_{13}],[f_{21},f_{22},f_{23}],[f_{31},f_{32},f_{33}],[f_{41},f_{42},f_{43}]]\\,$，其中每个 $\\,f_{ij}\\,$ 是一个浮点数。数值必须分别采用上述指定的质量、动量和能量通量的单位。",
            "solution": "任务是为一维可压缩欧拉方程构建 Roe 线性化黎曼求解器，并用其计算给定左右状态下界面处的数值通量。推导从基本方程开始，逐步得到最终的数值通量公式，包括 Roe 平均过程、特征结构分析和熵修正。\n\n一维欧拉方程的守恒形式如下：\n$$\n\\frac{\\partial \\mathbf{Q}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{Q})}{\\partial x} = \\mathbf{0}\n$$\n其中 $\\mathbf{Q}$ 是守恒变量向量，$\\mathbf{F}(\\mathbf{Q})$ 是通量向量：\n$$\n\\mathbf{Q} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}, \\quad \\mathbf{F}(\\mathbf{Q}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(\\rho E + p) \\end{pmatrix}\n$$\n这里，$\\rho$ 是密度，$u$ 是速度，$p$ 是压力，$E$ 是比总能。对于理想气体，压力通过状态方程与比内能 $e$ 相关：\n$$\np = (\\gamma - 1)\\rho e\n$$\n其中 $\\gamma$ 是恒定的比热比。比总能 $E$ 是比内能和比动能之和：\n$$\nE = e + \\frac{1}{2}u^2\n$$\n根据这些关系，我们可以用原始变量 $(\\rho, u, p)$ 或守恒变量 $\\mathbf{Q}$ 来表示压力 $p$ 和总焓 $H$：\n$$\np = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^2\\right)\n$$\n$$\nH = E + \\frac{p}{\\rho} = e + \\frac{1}{2}u^2 + \\frac{p}{\\rho} = \\frac{\\gamma p}{(\\gamma-1)\\rho} + \\frac{1}{2}u^2\n$$\n\nRoe 求解器基于寻找一个矩阵 $\\tilde{\\mathbf{A}}(\\mathbf{Q}_L, \\mathbf{Q}_R)$，该矩阵是通量雅可比矩阵 $\\mathbf{A}(\\mathbf{Q}) = \\partial\\mathbf{F}/\\partial\\mathbf{Q}$ 的一个一致线性化。该矩阵必须满足三个性质：\n1.  对于任何状态 $\\mathbf{Q}_L, \\mathbf{Q}_R$，它都是双曲的，这意味着它有一套完整的实特征值和线性无关的特征向量。\n2.  它与雅可比矩阵一致，即 $\\tilde{\\mathbf{A}}(\\mathbf{Q}, \\mathbf{Q}) = \\mathbf{A}(\\mathbf{Q})$。\n3.  它满足跨间断的 Rankine-Hugoniot 跳跃条件：$\\mathbf{F}(\\mathbf{Q}_R) - \\mathbf{F}(\\mathbf{Q}_L) = \\tilde{\\mathbf{A}}(\\mathbf{Q}_R - \\mathbf{Q}_L)$。\n\n这样的矩阵可以通过在一个特殊定义的“Roe 平均”状态下评估雅可比矩阵 $\\mathbf{A}(\\mathbf{Q})$ 来构造。对于理想气体的欧拉方程，Roe 平均值为：\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L}u_L + \\sqrt{\\rho_R}u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho_L}H_L + \\sqrt{\\rho_R}H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\n由 Roe 平均总焓 $\\tilde{H}$ 和速度 $\\tilde{u}$，我们可以定义一个一致的 Roe 平均声速 $\\tilde{a}$：\n$$\n\\tilde{a}^2 = (\\gamma - 1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2\\right)\n$$\nRoe 矩阵 $\\tilde{\\mathbf{A}}$ 是以原始变量表示并在该 Roe 平均状态 $(\\tilde{u}, \\tilde{H}, \\tilde{a})$ 下评估的通量雅可比矩阵 $\\mathbf{A}$。该雅可比矩阵为：\n$$\n\\mathbf{A} = \\begin{pmatrix} 0  1  0 \\\\ \\frac{\\gamma-3}{2}u^2  (3-\\gamma)u  \\gamma-1 \\\\ u\\left(\\frac{\\gamma-1}{2}u^2 - H\\right)  H - (\\gamma-1)u^2  \\gamma u \\end{pmatrix}\n$$\n在 Roe 状态下评估此矩阵可得 $\\tilde{\\mathbf{A}} = \\mathbf{A}(\\tilde{u}, \\tilde{H})$。\n\n$\\tilde{\\mathbf{A}}$ 的特征结构是求解器的核心。其特征值为：\n$$\n\\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a}, \\quad \\tilde{\\lambda}_2 = \\tilde{u}, \\quad \\tilde{\\lambda}_3 = \\tilde{u} + \\tilde{a}\n$$\n这些特征值分别对应左行声波、接触（熵）波和右行声波的速度。这些特征值的符号表示每个特征族的信息传播方向。\n对应的右特征向量为：\n$$\n\\tilde{\\mathbf{k}}_1 = \\begin{pmatrix} 1 \\\\ \\tilde{u}-\\tilde{a} \\\\ \\tilde{H}-\\tilde{u}\\tilde{a} \\end{pmatrix}, \\quad \\tilde{\\mathbf{k}}_2 = \\begin{pmatrix} 1 \\\\ \\tilde{u} \\\\ \\frac{1}{2}\\tilde{u}^2 \\end{pmatrix}, \\quad \\tilde{\\mathbf{k}}_3 = \\begin{pmatrix} 1 \\\\ \\tilde{u}+\\tilde{a} \\\\ \\tilde{H}+\\tilde{u}\\tilde{a} \\end{pmatrix}\n$$\n守恒变量的跳跃量 $\\Delta \\mathbf{Q} = \\mathbf{Q}_R - \\mathbf{Q}_L$ 可以投影到这个特征向量基上：\n$$\n\\Delta \\mathbf{Q} = \\sum_{i=1}^3 \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i\n$$\n其中 $\\tilde{\\alpha}_i$ 是波强度。求解这个 $3 \\times 3$ 系统以得到 $\\tilde{\\alpha}_i$ 的解为：\n$$\n\\tilde{\\alpha}_2 = \\frac{\\gamma-1}{\\tilde{a}^2} \\left[ (\\tilde{H}-\\tilde{u}^2)\\Delta\\rho + \\tilde{u}\\Delta(\\rho u) - \\Delta(\\rho E) \\right]\n$$\n$$\n\\tilde{\\alpha}_1 = \\frac{1}{2} \\left[ (\\Delta\\rho - \\tilde{\\alpha}_2) - \\frac{\\tilde{u}\\Delta\\rho - \\Delta(\\rho u)}{\\tilde{a}} \\right]\n$$\n$$\n\\tilde{\\alpha}_3 = \\frac{1}{2} \\left[ (\\Delta\\rho - \\tilde{\\alpha}_2) + \\frac{\\tilde{u}\\Delta\\rho - \\Delta(\\rho u)}{\\tilde{a}} \\right]\n$$\n其中 $\\Delta\\rho = \\rho_R - \\rho_L$, $\\Delta(\\rho u) = (\\rho u)_R - (\\rho u)_L$, $\\Delta(\\rho E) = (\\rho E)_R - (\\rho E)_L$。\n\nRoe 数值通量 $\\mathbf{F}_{\\text{Roe}}$ 是一种 Godunov 型通量，它根据特征值的符号引入了迎风格式。它的计算方法是左右通量的平均值，加上一个考虑了黎曼问题解的波结构的耗散项：\n$$\n\\mathbf{F}_{\\text{Roe}} = \\frac{1}{2}(\\mathbf{F}_L + \\mathbf{F}_R) - \\frac{1}{2} |\\tilde{\\mathbf{A}}|(\\mathbf{Q}_R - \\mathbf{Q}_L)\n$$\n耗散项 $|\\tilde{\\mathbf{A}}|(\\mathbf{Q}_R - \\mathbf{Q}_L)$ 使用特征分解来计算：\n$$\n|\\tilde{\\mathbf{A}}|(\\mathbf{Q}_R - \\mathbf{Q}_L) = \\sum_{i=1}^3 |\\tilde{\\lambda}_i| \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i\n$$\n这导出了 Roe 通量的最终表达式：\n$$\n\\mathbf{F}_{\\text{Roe}} = \\frac{1}{2}(\\mathbf{F}_L + \\mathbf{F}_R) - \\frac{1}{2} \\sum_{i=1}^3 |\\tilde{\\lambda}_i| \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i\n$$\n\nRoe 求解器的一个关键问题是，对于跨音速稀疏波，当一个特征值 $\\tilde{\\lambda}_i$ 穿过零时，未能增加足够的耗散。这可能导致违反熵条件的膨胀激波。为修正此问题，通过修改绝对值函数 $|\\lambda|$ 来应用“熵修正”。按照规定，我们将 $|\\lambda|$ 替换为函数 $\\phi(|\\lambda|)$：\n$$\n\\phi(|\\lambda|) = \\begin{cases} |\\lambda|  \\text{if } |\\lambda| \\ge \\delta \\\\ \\frac{1}{2}\\left(\\frac{\\lambda^2}{\\delta} + \\delta\\right)  \\text{if } |\\lambda|  \\delta \\end{cases}\n$$\n其中 $\\delta = \\varepsilon \\tilde{a}$ 是一个小的正阈值，$\\varepsilon = 0.1$。因此，耗散项被修改为 $\\sum_{i=1}^3 \\phi(|\\tilde{\\lambda}_i|) \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i$，确保在声速点有严格为正的耗散。\n\n在给定左右原始状态 $(\\rho_L, u_L, p_L)$、$(\\rho_R, u_R, p_R)$ 和 $\\gamma$ 的情况下，寻找 $\\mathbf{F}_{\\text{Roe}}$ 的计算步骤如下：\n1.  计算派生量（$E_L, H_L, E_R, H_R$）并构成状态向量 $\\mathbf{Q}_L, \\mathbf{Q}_R$ 和通量向量 $\\mathbf{F}_L, \\mathbf{F}_R$。\n2.  计算 Roe 平均变量 $\\tilde{u}$、$\\tilde{H}$ 和 $\\tilde{a}$。\n3.  计算守恒变量的跳跃量 $\\Delta\\rho$、$\\Delta(\\rho u)$、$\\Delta(\\rho E)$。\n4.  确定波强度 $\\tilde{\\alpha}_1, \\tilde{\\alpha}_2, \\tilde{\\alpha}_3$。\n5.  找到特征值 $\\tilde{\\lambda}_1, \\tilde{\\lambda}_2, \\tilde{\\lambda}_3$ 和右特征向量 $\\tilde{\\mathbf{k}}_1, \\tilde{\\mathbf{k}}_2, \\tilde{\\mathbf{k}}_3$。\n6.  对每个 $|\\tilde{\\lambda}_i|$ 应用熵修正以得到 $\\phi(|\\tilde{\\lambda}_i|)$。\n7.  通过对每个波的贡献求和来计算总耗散向量：$\\sum_{i=1}^3 \\phi(|\\tilde{\\lambda}_i|) \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i$。\n8.  组装最终的 Roe 通量向量 $\\mathbf{F}_{\\text{Roe}}$。",
            "answer": "[[800.0,740000.0,536000000.0],[150.0,45000.0,15750000.0],[141421.3562373095,0.0,35355339.05932738],[200.0,120000.0,36000000.0]]"
        }
    ]
}