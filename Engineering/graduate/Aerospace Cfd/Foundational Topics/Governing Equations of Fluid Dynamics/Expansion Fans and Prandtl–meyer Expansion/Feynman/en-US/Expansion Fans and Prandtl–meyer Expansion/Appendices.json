{
    "hands_on_practices": [
        {
            "introduction": "Mastery of computational methods begins with a firm grasp of the underlying analytical theory. This practice reinforces the foundations of compressible flow by challenging you to derive the governing equations for two classic scenarios: quasi-one-dimensional nozzle flow and a two-dimensional Prandtl–Meyer expansion. By deriving the area-Mach relation and the Prandtl–Meyer function from first principles, you will solidify your understanding of how isentropic acceleration is modeled in different dimensions .",
            "id": "3957820",
            "problem": "A steady, inviscid, adiabatic, quasi-one-dimensional nozzle accelerates a calorically perfect gas (ratio of specific heats $\\gamma$ constant) from a sonic throat to a supersonic exit. The upstream stagnation state is uniform, and the flow is isentropic. The throat is choked so that the Mach number at the throat is $M^{*} = 1$ and the throat area is $A^{*}$. The exit-to-throat area ratio is specified as $A_{e}/A^{*} = \\dfrac{27}{16}$. The gas is air modeled as a calorically perfect gas with $\\gamma = 1.4$.\n\nTask 1: Starting only from the steady conservation laws, the ideal-gas equation of state, and isentropic relations for a calorically perfect gas, derive the area–Mach relation for quasi-one-dimensional isentropic flow, and use it to determine the supersonic exit Mach number $M_{e}$ corresponding to $A_{e}/A^{*} = \\dfrac{27}{16}$.\n\nTask 2: Now consider a planar simple expansion fan governed by the Prandtl–Meyer (PM) theory that turns a uniform upstream flow at $M=1$ to the same supersonic Mach number $M_{e}$ found in Task 1. Starting from the steady, inviscid, isentropic, irrotational two-dimensional equations and the simple-wave compatibility, derive the Prandtl–Meyer function $\\nu(M)$ and compute the required wall turning angle $\\theta = \\nu(M_{e}) - \\nu(1)$ to achieve $M_{e}$.\n\nExpress the final answer as the single turning angle $\\theta$ in degrees, and round to four significant figures. Do not report any intermediate values as part of the final answer.",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Flow conditions (Task 1):** Steady, inviscid, adiabatic, quasi-one-dimensional, isentropic.\n- **Flow conditions (Task 2):** Steady, inviscid, isentropic, irrotational, two-dimensional, simple expansion fan.\n- **Gas model:** Calorically perfect gas.\n- **Ratio of specific heats:** $\\gamma = 1.4$.\n- **Nozzle geometry:** Choked throat with Mach number $M^{*} = 1$ at area $A^{*}$. Exit-to-throat area ratio $A_{e}/A^{*} = \\frac{27}{16}$.\n- **Expansion fan conditions:** Uniform upstream flow at Mach number $M=1$. The flow accelerates to the supersonic Mach number $M_e$ found in Task 1.\n- **Derivations required:**\n    1. Area–Mach relation for quasi-one-dimensional isentropic flow, starting from conservation laws, ideal-gas equation of state, and isentropic relations.\n    2. Prandtl–Meyer function $\\nu(M)$, starting from 2D equations and simple-wave compatibility.\n- **Final output:** The required wall turning angle $\\theta = \\nu(M_e) - \\nu(1)$ in degrees, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific or Factual Unsoundness:** The problem is based on the standard and well-established theories of quasi-one-dimensional isentropic flow and two-dimensional Prandtl–Meyer expansion waves, which are cornerstones of compressible aerodynamics. There are no violations of scientific principles.\n2.  **Non-Formalizable or Irrelevant:** The problem is a standard exercise in compressible flow theory, directly related to the topics of expansion fans and nozzle flow.\n3.  **Incomplete or Contradictory Setup:** The problem provides all necessary information. The area ratio $A_e/A^* = \\frac{27}{16} > 1$ allows for a supersonic solution, as requested. All parameters ($\\gamma$, area ratio) are specified.\n4.  **Unrealistic or Infeasible:** All given values and physical conditions are realistic and commonly encountered in aerospace engineering problems.\n5.  **Ill-Posed or Poorly Structured:** The area-Mach number relation is a double-valued function of Mach number for a given area ratio ($>1$), yielding one subsonic and one supersonic solution. The problem explicitly asks for the *supersonic* exit Mach number, which makes the solution unique. The structure is logical, using the result of the first task as input for the second.\n6.  **Pseudo-Profound, Trivial, or Tautological:** The required derivations are fundamental and non-trivial, demanding a firm grasp of compressible flow theory. The problem is a legitimate test of understanding.\n7.  **Outside Scientific Verifiability:** The problem and its solution are entirely within the realm of standard, verifiable gas dynamics theory.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, and objective. It is deemed **valid**. A full solution will be provided.\n\n### Task 1: Derivation of the Area–Mach Relation and Calculation of $M_e$\n\nWe begin with the conservation of mass for a steady, quasi-one-dimensional flow:\n$$ \\dot{m} = \\rho u A = \\text{constant} $$\nwhere $\\rho$ is the density, $u$ is the flow speed, and $A$ is the cross-sectional area.\nFor an isentropic flow of a calorically perfect gas, the stagnation properties (denoted by subscript $0$) are constant. The local properties can be related to the stagnation properties and the local Mach number $M$ as follows:\nThe relation between stagnation and static temperature is derived from the energy equation, $h_0 = h + \\frac{1}{2}u^2$, which for a calorically perfect gas ($h=c_p T$) becomes $c_p T_0 = c_p T + \\frac{1}{2}u^2$. Using $u=Ma$ and $a^2=\\gamma R T = (\\gamma-1)c_p T$, we get:\n$$ \\frac{T_0}{T} = 1 + \\frac{\\gamma-1}{2} M^2 $$\nFor an isentropic process, $p/\\rho^\\gamma = \\text{constant}$, which leads to:\n$$ \\frac{p_0}{p} = \\left(\\frac{T_0}{T}\\right)^{\\frac{\\gamma}{\\gamma-1}} = \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{\\frac{\\gamma}{\\gamma-1}} $$\n$$ \\frac{\\rho_0}{\\rho} = \\left(\\frac{T_0}{T}\\right)^{\\frac{1}{\\gamma-1}} = \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{\\frac{1}{\\gamma-1}} $$\nThe local velocity $u$ can be expressed as:\n$$ u = M a = M \\sqrt{\\gamma R T} = M \\sqrt{\\gamma R T_0} \\sqrt{\\frac{T}{T_0}} = M a_0 \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-1/2} $$\nSubstituting the expressions for $\\rho$ and $u$ into the mass flow rate equation:\n$$ \\dot{m} = A \\left[ \\rho_0 \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{1}{\\gamma-1}} \\right] \\left[ M a_0 \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-1/2} \\right] $$\nCombining the exponents gives:\n$$ \\dot{m} = A \\rho_0 a_0 M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{1}{2} \\left( \\frac{2}{\\gamma-1} + 1 \\right)} = A \\rho_0 a_0 M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} $$\nSince $\\dot{m}$, $\\rho_0$, and $a_0$ are constant throughout the nozzle, we can write:\n$$ \\frac{\\dot{m}}{\\rho_0 a_0} = A M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} = \\text{constant} $$\nThe throat is choked, meaning the Mach number at the minimum area $A=A^*$ is $M=1$. Applying the above relation at the throat:\n$$ \\frac{\\dot{m}}{\\rho_0 a_0} = A^* (1) \\left(1 + \\frac{\\gamma-1}{2} (1)^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} = A^* \\left(\\frac{\\gamma+1}{2}\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} $$\nBy equating the general expression for the mass flow group with its value at the throat, we can find the area ratio $A/A^*$:\n$$ A M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} = A^* \\left(\\frac{\\gamma+1}{2}\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} $$\nRearranging for the area ratio, we obtain the area–Mach relation:\n$$ \\frac{A}{A^*} = \\frac{1}{M} \\left[ \\frac{1 + \\frac{\\gamma-1}{2} M^2}{\\frac{\\gamma+1}{2}} \\right]^{\\frac{\\gamma+1}{2(\\gamma-1)}} $$\nThis completes the derivation for Task 1.\n\nNow, we must find the supersonic exit Mach number $M_e$ for $A_e/A^* = \\frac{27}{16}$ and $\\gamma=1.4$.\n$$ \\frac{\\gamma+1}{2(\\gamma-1)} = \\frac{1.4+1}{2(1.4-1)} = \\frac{2.4}{0.8} = 3 $$\n$$ \\frac{\\gamma-1}{2} = \\frac{1.4-1}{2} = 0.2 $$\n$$ \\frac{\\gamma+1}{2} = \\frac{1.4+1}{2} = 1.2 $$\nSubstituting these values into the area-Mach relation:\n$$ \\frac{A_e}{A^*} = \\frac{1}{M_e} \\left[ \\frac{1 + 0.2 M_e^2}{1.2} \\right]^3 = \\frac{27}{16} $$\n$$ \\frac{27}{16} = \\frac{1}{M_e} \\left[ \\frac{5}{6} (1 + 0.2 M_e^2) \\right]^3 $$\nThis is a nonlinear algebraic equation for $M_e$. We seek a supersonic root ($M_e > 1$). Let us test an integer value, such as $M_e=2$:\n$$ \\frac{1}{2} \\left[ \\frac{5}{6} (1 + 0.2(2^2)) \\right]^3 = \\frac{1}{2} \\left[ \\frac{5}{6} (1 + 0.8) \\right]^3 = \\frac{1}{2} \\left[ \\frac{5}{6} (1.8) \\right]^3 = \\frac{1}{2} [1.5]^3 = \\frac{1}{2} [3.375] = 1.6875 $$\nSince $\\frac{27}{16} = 1.6875$, the supersonic exit Mach number is exactly $M_e=2$.\n\n### Task 2: Derivation of the Prandtl–Meyer Function and Calculation of $\\theta$\n\nFor a steady, inviscid, irrotational, 2D supersonic flow, the flow properties can change across characteristic lines. An expansion fan is composed of a continuous set of C+ characteristics originating from a single point. The compatibility relation along a C+ characteristic is:\n$$ d\\theta - \\frac{du}{u \\tan\\mu} = 0 $$\nwhere $\\theta$ is the flow deflection angle and $\\mu = \\arcsin(1/M)$ is the Mach angle. Rearranging for $d\\theta$ and using $\\tan\\mu = (\\sqrt{M^2-1})^{-1}$:\n$$ d\\theta = \\frac{du}{u \\tan\\mu} = \\sqrt{M^2-1} \\frac{du}{u} $$\nTo integrate this, we must express $du/u$ in terms of $M$. From the energy equation, we have $T_0/T = 1 + \\frac{\\gamma-1}{2}M^2$. Differentiating this logarithmically:\n$$ -\\frac{dT}{T} = \\frac{(\\gamma-1) M dM}{1 + \\frac{\\gamma-1}{2}M^2} $$\nAlso, we have $u = M a = M \\sqrt{\\gamma R T}$. Differentiating this logarithmically yields $2 \\frac{du}{u} = 2 \\frac{dM}{M} + \\frac{dT}{T}$. Substituting for $dT/T$:\n$$ 2 \\frac{du}{u} = 2 \\frac{dM}{M} - \\frac{(\\gamma-1) M^2}{1 + \\frac{\\gamma-1}{2}M^2} \\frac{dM}{M} = \\left( 2 - \\frac{(\\gamma-1)M^2}{1 + \\frac{\\gamma-1}{2}M^2} \\right) \\frac{dM}{M} = \\left( \\frac{2 + (\\gamma-1)M^2 - (\\gamma-1)M^2}{1 + \\frac{\\gamma-1}{2}M^2} \\right) \\frac{dM}{M} $$\n$$ \\frac{du}{u} = \\frac{1}{1 + \\frac{\\gamma-1}{2}M^2} \\frac{dM}{M} $$\nSubstituting this into the expression for $d\\theta$:\n$$ d\\theta = \\frac{\\sqrt{M^2-1}}{M(1 + \\frac{\\gamma-1}{2}M^2)} dM $$\nThe Prandtl–Meyer function $\\nu(M)$ represents the angle through which a flow turns from $M=1$ to a given Mach number $M$. We obtain it by integrating $d\\theta$ from $M=1$ to $M$:\n$$ \\nu(M) = \\int_1^M \\frac{\\sqrt{M'^2-1}}{M'(1 + \\frac{\\gamma-1}{2}M'^2)} dM' $$\nLet $y^2 = M'^2 - 1$. Then $M'^2 = y^2+1$ and $M'dM' = ydy$. The integral becomes:\n$$ \\nu(M) = \\int_0^{\\sqrt{M^2-1}} \\frac{y}{M'^2 \\left(1 + \\frac{\\gamma-1}{2}M'^2\\right)} (M'dM') = \\int_0^{\\sqrt{M^2-1}} \\frac{y^2 dy}{(y^2+1)\\left(1 + \\frac{\\gamma-1}{2}(y^2+1)\\right)} $$\n$$ = \\int_0^{\\sqrt{M^2-1}} \\frac{2y^2 dy}{(y^2+1)((\\gamma-1)y^2 + \\gamma+1)} $$\nUsing partial fraction decomposition:\n$$ \\frac{2y^2}{(y^2+1)((\\gamma-1)y^2 + \\gamma+1)} = \\frac{\\gamma+1}{(\\gamma-1)y^2 + \\gamma+1} - \\frac{1}{y^2+1} $$\nWe find:\n$$ \\nu(M) = \\int_0^{\\sqrt{M^2-1}} \\left( \\frac{\\gamma+1}{(\\gamma-1)y^2 + \\gamma+1} - \\frac{1}{y^2+1} \\right) dy $$\n$$ \\nu(M) = \\left[ \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(y\\sqrt{\\frac{\\gamma-1}{\\gamma+1}}\\right) - \\arctan(y) \\right]_0^{\\sqrt{M^2-1}} $$\nSubstituting back $y=\\sqrt{M^2-1}$ and evaluating at the limits yields the Prandtl-Meyer function:\n$$ \\nu(M) = \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(\\sqrt{\\frac{\\gamma-1}{\\gamma+1}(M^2-1)}\\right) - \\arctan\\left(\\sqrt{M^2-1}\\right) $$\nThis completes the derivation for Task 2.\n\nThe required turning angle is $\\theta = \\nu(M_e) - \\nu(1)$. Since the initial Mach number is $M=1$, we have $\\nu(1) = 0$. Thus, $\\theta = \\nu(M_e)$. We use $M_e=2$ and $\\gamma=1.4$.\n$$ \\frac{\\gamma+1}{\\gamma-1} = \\frac{2.4}{0.4} = 6 $$\n$$ \\theta = \\nu(2) = \\sqrt{6} \\arctan\\left(\\sqrt{\\frac{1}{6}(2^2-1)}\\right) - \\arctan\\left(\\sqrt{2^2-1}\\right) $$\n$$ \\theta = \\sqrt{6} \\arctan\\left(\\sqrt{\\frac{3}{6}}\\right) - \\arctan(\\sqrt{3}) $$\n$$ \\theta = \\sqrt{6} \\arctan\\left(\\frac{1}{\\sqrt{2}}\\right) - \\arctan(\\sqrt{3}) $$\nThe calculations must be done using radians.\n$$ \\arctan(\\sqrt{3}) = \\frac{\\pi}{3} $$\n$$ \\arctan\\left(\\frac{1}{\\sqrt{2}}\\right) \\approx \\arctan(0.707107) \\approx 0.615480 \\text{ rad} $$\n$$ \\sqrt{6} \\approx 2.44949 $$\n$$ \\theta \\approx (2.44949)(0.615480) - \\frac{\\pi}{3} \\approx 1.507616 - 1.047198 \\approx 0.460418 \\text{ rad} $$\nConverting to degrees:\n$$ \\theta_{\\text{deg}} = 0.460418 \\times \\frac{180}{\\pi} \\approx 26.3795^\\circ $$\nRounding to four significant figures, the turning angle is $26.38^\\circ$.",
            "answer": "$$\\boxed{26.38}$$"
        },
        {
            "introduction": "A reliable simulation requires more than just running a solver; it demands rigorous verification against known solutions. This exercise puts you in the role of a CFD method developer, tasking you with designing a complete verification test case for a Prandtl–Meyer expansion . You will need to consider optimal grid design, appropriate boundary conditions, and quantitative error metrics, translating theoretical knowledge into a blueprint for a high-fidelity numerical experiment.",
            "id": "3957812",
            "problem": "A two-dimensional, steady, inviscid, calorically perfect gas with constant ratio of specific heats $\\gamma$ experiences an isentropic Prandtl–Meyer expansion around a sharp convex wall corner. Design a grid-aligned Computational Fluid Dynamics (CFD) test case and define quantitative error metrics to assess the numerical accuracy of the flow turning angle and Mach number distributions across the expansion fan.\n\nAssume the following physically realistic baseline parameters for air: $\\gamma = 1.4$, gas constant $R = 287\\,\\mathrm{J/(kg\\cdot K)}$, upstream uniform supersonic inflow Mach number $M_1 = 2.5$, upstream static pressure $p_1 = 101325\\,\\mathrm{Pa}$, upstream static temperature $T_1 = 300\\,\\mathrm{K}$, and a wall turning (deflection) angle $\\delta = 10^\\circ$. The upstream flow is aligned with the upstream wall, and the downstream wall is rotated by the angle $\\delta$ about the corner.\n\nStart from the compressible Euler equations together with the definition of isentropic expansions and the fact that the centered expansion around a convex corner admits a self-similar solution. On this basis, specify:\n\n- A domain and grid construction that is aligned with the expansion geometry so that the theoretical solution depends on a single self-similar variable associated with the polar angle from the corner.\n- Boundary conditions consistent with a centered expansion fan emanating from the corner.\n- A mathematically precise procedure to obtain the theoretical flow turning angle distribution and Mach number distribution across the fan as functions of the appropriate similarity variable.\n- Quantitative error metrics designed to compare the numerical angle and Mach number distributions against the theoretical distributions over the fan, with clear definitions of any norms, sampling procedures, and weighting.\n\nWhich of the following option sets provides a scientifically consistent and complete design and correctly defined distribution error metrics?\n\nA. Use a polar wedge domain centered at the corner with radial coordinate $r \\in [r_{\\min}, r_{\\max}] = [0.01\\,\\mathrm{m}, 1.0\\,\\mathrm{m}]$ and polar angle $\\phi \\in [0, \\delta]$, where the walls coincide with the rays $\\phi = 0$ (upstream wall) and $\\phi = \\delta$ (downstream wall). Employ a structured grid aligned with $(r,\\phi)$, e.g., $N_r = 200$, $N_\\phi = 180$, so that grid lines of constant $\\phi$ coincide with self-similar rays of the expansion fan. Impose slip-wall boundary conditions on $\\phi=0$ and $\\phi=\\delta$, supersonic outflow at $r=r_{\\max}$, and prescribe the state at $r=r_{\\min}$ by the exact upstream uniform state for $\\phi=0$ and by the exact self-similar solution for $0\\phi\\le\\delta$ to avoid singular behavior at the corner while maintaining a centered fan. Define the theoretical distributions by the self-similar mapping $\\theta(\\phi) = \\phi$ (flow turning angle relative to the upstream direction) and $M(\\phi)$ obtained by inverting the Prandtl–Meyer relation $\\nu(M(\\phi)) - \\nu(M_1) = \\phi$ for $\\phi \\in [0, \\delta]$. To compare with numerics, sample along a circular arc at fixed $r^\\star$ (e.g., $r^\\star = 0.8\\,\\mathrm{m}$) and compute the discrete distributions $\\theta_{\\mathrm{num}}(\\phi_i) = \\arctan(v(\\phi_i,r^\\star)/u(\\phi_i,r^\\star))$ and $M_{\\mathrm{num}}(\\phi_i) = \\sqrt{u^2+v^2}/a$, where $a = \\sqrt{\\gamma R T}$ is the local speed of sound reconstructed isentropically from the numerical state. Define distribution error norms over the fan,\n$$\nE_{\\theta,2} = \\left(\\frac{1}{\\delta} \\int_{0}^{\\delta} \\big[\\theta_{\\mathrm{num}}(\\phi) - \\theta(\\phi)\\big]^2 \\,\\mathrm{d}\\phi\\right)^{1/2}, \\quad\nE_{\\theta,\\infty} = \\max_{\\phi \\in [0,\\delta]} \\big|\\theta_{\\mathrm{num}}(\\phi) - \\theta(\\phi)\\big|,\n$$\nand\n$$\nE_{M,2} = \\left(\\frac{1}{\\delta} \\int_{0}^{\\delta} \\big[M_{\\mathrm{num}}(\\phi) - M(\\phi)\\big]^2 \\,\\mathrm{d}\\phi\\right)^{1/2}, \\quad\nE_{M,\\infty} = \\max_{\\phi \\in [0,\\delta]} \\big|M_{\\mathrm{num}}(\\phi) - M(\\phi)\\big|.\n$$\nIn discrete form on a uniform $\\phi$ grid these integrals become sums with $\\Delta \\phi = \\delta/N_\\phi$. Optionally, define area-weighted field errors over the sector by integrating with weight $r$ over $(r,\\phi)$, recognizing that polar cell area scales as $r\\,\\Delta r\\,\\Delta \\phi$.\n\nB. Use a Cartesian rectangular domain with the lower wall along $y=0$ and a downstream wall obtained by a staircase approximation to $y = (\\tan \\delta) x$. Apply no-slip walls, subsonic inflow at the left boundary with $M_1=2.5$, and subsonic pressure outlet at the right boundary. Treat the expansion fan as a shock and define the angle and Mach number error by differences measured only at the downstream wall: $E_{\\theta} = |\\theta_{\\mathrm{num}}(x=L) - \\delta|$ and $E_M = |M_{\\mathrm{num}}(x=L) - M_2|$, where $M_2$ is estimated by a normal-shock relation.\n\nC. Use a polar wedge domain as in option A but assume the Mach angle $\\mu(\\phi) = \\arcsin(1/M)$ is constant across the fan and equal to the upstream Mach angle $\\mu_1 = \\arcsin(1/M_1)$. Define angle errors by $E_{\\theta,2} = (\\delta^{-1}\\int_0^\\delta [\\mu_{\\mathrm{num}}(\\phi) - \\mu_1]^2\\,\\mathrm{d}\\phi)^{1/2}$ and Mach errors by $E_{M,2} = (\\delta^{-1}\\int_0^\\delta [M_{\\mathrm{num}}(\\phi) - M_1]^2\\,\\mathrm{d}\\phi)^{1/2}$, sampling along the centerline $\\phi = \\delta/2$ only.\n\nD. Use a body-fitted curvilinear grid that aligns with the upstream and downstream walls, with supersonic inflow at the left boundary and slip walls. Define the theoretical angle distribution as $\\theta(\\phi) = \\delta$ everywhere and the theoretical Mach distribution as $M(\\phi) = M_1$ everywhere. Compute errors by an unweighted average along the downstream wall alone: $E_{\\theta} = \\frac{1}{L}\\int_0^L |\\theta_{\\mathrm{num}}(s) - \\delta|\\,\\mathrm{d}s$ and $E_M = \\frac{1}{L}\\int_0^L |M_{\\mathrm{num}}(s) - M_1|\\,\\mathrm{d}s$, where $s$ is wall arclength and $L$ is wall length.\n\nSelect the correct option.",
            "solution": "The user wants a critical validation of a problem statement concerning the design of a Computational Fluid Dynamics (CFD) test case for a Prandtl–Meyer expansion, followed by a full solution and evaluation of the given options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n-   **Flow Model**: 2D, steady, inviscid, calorically perfect gas.\n-   **Gas Properties**: Ratio of specific heats $\\gamma = 1.4$, gas constant $R = 287\\,\\mathrm{J/(kg\\cdot K)}$.\n-   **Upstream Flow Conditions**: Uniform supersonic inflow Mach number $M_1 = 2.5$, static pressure $p_1 = 101325\\,\\mathrm{Pa}$, static temperature $T_1 = 300\\,\\mathrm{K}$.\n-   **Geometry**: Sharp convex wall corner with a total turning angle $\\delta = 10^\\circ$.\n-   **Governing Principles**: Compressible Euler equations, isentropic expansion, self-similar solution for a centered expansion.\n-   **Task**: Specify a grid-aligned CFD test case design including:\n    1.  Domain and grid construction.\n    2.  Consistent boundary conditions.\n    3.  A precise procedure for obtaining the theoretical flow turning angle and Mach number distributions.\n    4.  Quantitative error metrics for comparing numerical results to the theory.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded**: The problem is built upon the well-established theory of Prandtl–Meyer expansion, a cornerstone of compressible gas dynamics. All specified parameters ($\\gamma=1.4$ for air, $M_1=2.5$, etc.) are physically realistic. The premise of a self-similar solution for a centered expansion fan is a known theoretical result for inviscid flow. The maximum possible turning angle for $M_1=2.5$ is $\\nu_{\\max} - \\nu(2.5) \\approx 91.3^\\circ$, which is much greater than the specified turning angle $\\delta=10^\\circ$. Thus, the expansion is physically realizable. The problem is scientifically sound.\n-   **Well-Posed**: The problem asks for the design of a verification test case, not for a single numerical answer. The information provided is sufficient to formulate such a design. The underlying physical problem has a unique, stable, and meaningful solution.\n-   **Objective**: The problem is stated in precise, technical language, free from ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. It is scientifically sound, well-posed, and objective, providing a clear basis for designing a CFD verification study. I will now proceed with the solution derivation and option analysis.\n\n### Derivation of the Correct Test Case Design\n\nA high-quality CFD verification test case should, where possible, leverage known properties of the exact solution to minimize sources of error unrelated to the discretization of the governing equations.\n\n1.  **Coordinate System and Domain**: The Prandtl–Meyer expansion is a self-similar flow, meaning flow properties like Mach number $M$, pressure $p$, and density $\\rho$ are constant along rays emanating from the corner. The flow angle $\\theta$ is also a function of the polar angle $\\phi$ only. This self-similarity makes a polar coordinate system $(r, \\phi)$ centered at the corner the natural choice. A grid constructed on these coordinates will be aligned with the solution's iso-lines of $M$, $p$, etc., which is optimal for numerical accuracy. The domain should be a sector of an annulus, e.g., $r \\in [r_{\\min}, r_{\\max}]$ and an appropriate angular range $[\\phi_1, \\phi_2]$, to avoid the singularity at $r=0$.\n\n2.  **Theoretical Distributions**: The core of the Prandtl–Meyer theory relates the flow turning angle $\\theta$ to the Mach number $M$ via the Prandtl–Meyer function $\\nu(M)$:\n    $$ \\nu(M) = \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(\\sqrt{\\frac{\\gamma-1}{\\gamma+1}(M^2-1)}\\right) - \\arctan\\left(\\sqrt{M^2-1}\\right) $$\n    For a flow turning from an initial state $(M_1, \\theta_1)$ to a new state $(M, \\theta)$, the relation is $\\theta - \\theta_1 = \\nu(M) - \\nu(M_1)$.\n    The rays of constant properties are also the characteristic lines (Mach waves) of the flow. The angle of a Mach wave $\\phi$ is related to the local flow angle $\\theta$ and local Mach angle $\\mu = \\arcsin(1/M)$ by $\\phi = \\theta + \\mu$.\n    For verification purposes, it is common to use a simplified or \"manufactured\" solution that retains the essential physics. A valid approach is to define the test case such that the flow turning angle $\\theta$ is identical to the polar angle $\\phi$, i.e., $\\theta(\\phi) = \\phi$, over a specified angular domain, say $\\phi \\in [0, \\delta]$. This creates a well-defined theoretical flow field to test against. With this definition, the theoretical Mach number distribution $M(\\phi)$ is given implicitly by the relation:\n    $$ \\nu(M(\\phi)) - \\nu(M_1) = \\phi, \\quad \\text{for } \\phi \\in [0, \\delta] $$\n    This equation must be solved (e.g., via a numerical root-finder) for $M$ at each angle $\\phi$.\n\n3.  **Boundary Conditions**: For a domain $r \\in [r_{\\min}, r_{\\max}]$ and $\\phi \\in [0, \\delta]$, the following conditions are appropriate for an inviscid supersonic flow simulation based on the manufactured solution:\n    -   **Inflow ($r=r_{\\min}$)**: The exact theoretical solution for all flow variables (pressure, density, velocity components) derived from the distributions $\\theta(\\phi)=\\phi$ and $M(\\phi)$ should be prescribed. This method, often called the Method of Exact Solutions (MES), directly feeds the known solution into the domain.\n    -   **Outflow ($r=r_{\\max}$)**: Since the flow is supersonic everywhere in the expansion fan, a supersonic outflow boundary condition (e.g., zero-gradient extrapolation of all variables) is appropriate, as no information can propagate upstream from the boundary.\n    -   **Side Boundaries ($\\phi=0, \\phi=\\delta$ for the domain)**: In the context of the MES setup on a sector, these are also inflow/outflow boundaries. The exact theoretical solution should be prescribed along these boundaries as well. The mention of \"slip walls\" can be confusing; while the physical problem involves walls, this verification test case is better served by prescribing the known solution on all inflow boundaries of the computational sector.\n\n4.  **Error Metrics**: To quantify the accuracy of a numerical solution ($M_{\\mathrm{num}}$, $\\theta_{\\mathrm{num}}$), it must be compared to the theoretical solution ($M_{\\mathrm{th}}$, $\\theta_{\\mathrm{th}}$). A standard procedure is:\n    -   Sample the numerical solution along a path where the theoretical solution is known. A circular arc at a constant radius $r^\\star$ (where $r_{\\min}  r^\\star  r_{\\max}$) is an ideal choice, as the theoretical solution is independent of $r$.\n    -   At a set of points $\\{\\phi_i\\}$ along the arc, extract the numerical velocity components $(u_i, v_i)$ and temperature $T_i$.\n    -   Calculate the numerical distributions: $\\theta_{\\mathrm{num}}(\\phi_i) = \\arctan(v_i/u_i)$ and $M_{\\mathrm{num}}(\\phi_i) = \\sqrt{u_i^2+v_i^2} / \\sqrt{\\gamma R T_i}$.\n    -   Compute standard error norms, such as the normalized $L_2$ (RMS) norm and the $L_\\infty$ (maximum) norm, to measure the discrepancy. For a quantity $f$ over the range $\\phi \\in [0, \\delta]$:\n        $$ E_{f,2} = \\left(\\frac{1}{\\delta} \\int_{0}^{\\delta} [f_{\\mathrm{num}}(\\phi) - f_{\\mathrm{th}}(\\phi)]^2 \\,\\mathrm{d}\\phi\\right)^{1/2} $$\n        $$ E_{f,\\infty} = \\max_{\\phi \\in [0,\\delta]} |f_{\\mathrm{num}}(\\phi) - f_{\\mathrm{th}}(\\phi)| $$\n    -   The integrals are approximated by numerical quadrature (e.g., trapezoidal rule) using the discrete data points. Area-weighted norms that integrate over the full $(r, \\phi)$ domain are also a valid and often more robust alternative.\n\n### Option-by-Option Analysis\n\n**Option A**\n-   **Domain/Grid**: Proposes a polar wedge domain with a structured grid aligned with $(r, \\phi)$. This is optimal, as it aligns the grid with the self-similar rays of the theoretical solution.\n-   **Boundary Conditions**: Correctly suggests prescribing the exact self-similar solution at the inflow boundary $r=r_{\\min}$ to avoid the corner singularity and provide a clean test (Method of Exact Solutions). The mention of \"slip-wall\" conditions on the side boundaries is slightly ambiguous for an MES setup but does not invalidate the overall correct approach.\n-   **Theoretical Distributions**: Defines the theoretical solution with $\\theta(\\phi) = \\phi$ and determines $M(\\phi)$ by inverting the Prandtl–Meyer relation $\\nu(M(\\phi)) - \\nu(M_1) = \\phi$. This is a valid and common way to construct a \"manufactured\" but physically relevant theoretical solution for verification.\n-   **Error Metrics**: Defines the standard $L_2$ and $L_\\infty$ norms for both angle and Mach number distributions, sampled along a circular arc. The mathematical expressions for the norms are correct. The suggestion of discrete sums and area-weighting is also correct and shows a thorough understanding of verification procedures.\n-   **Verdict**: **Correct**. This option presents a scientifically consistent, complete, and sophisticated design for a CFD verification test case, accurately reflecting best practices.\n\n**Option B**\n-   **Domain/Grid**: Proposes a Cartesian grid with a \"staircase approximation\" for the wall. This is a poor choice for a precision verification study as it is not grid-aligned with the fan geometry and introduces geometric errors.\n-   **Boundary Conditions**: Contains multiple fundamental errors. It specifies \"no-slip walls\" for an *inviscid* problem. It states \"subsonic inflow at the left boundary with $M_1=2.5$,\" a direct contradiction as $M_1=2.5$ is supersonic. It also specifies a \"subsonic pressure outlet\" for a supersonic flow.\n-   **Theoretical Basis**: Fundamentally misunderstands the physics by treating the expansion fan \"as a shock\" and using a \"normal-shock relation.\" Expansions and shocks are opposite phenomena.\n-   **Error Metrics**: The metrics are impoverished, checking only at the downstream wall and failing to assess the solution's accuracy across the fan.\n-   **Verdict**: **Incorrect**. This option is flawed in every aspect, demonstrating a profound misunderstanding of both the physics and CFD principles.\n\n**Option C**\n-   **Theoretical Basis**: Falsely assumes the Mach angle $\\mu$ is constant across the fan. In reality, as the flow expands, Mach number $M$ increases, and thus the Mach angle $\\mu=\\arcsin(1/M)$ must decrease.\n-   **Error Metrics**: The metrics are ill-conceived. It mislabels a Mach angle error as a \"angle error\". It compares the Mach number throughout the fan to the constant upstream value $M_1$, which is incorrect since the Mach number must increase. Sampling only along the centerline is insufficient to verify the distribution.\n-   **Verdict**: **Incorrect**. This option is based on invalid physical assumptions and uses improperly defined error metrics.\n\n**Option D**\n-   **Theoretical Distributions**: Proposes that the flow angle is a constant $\\theta(\\phi) = \\delta$ and the Mach number is a constant $M(\\phi)=M_1$ \"everywhere\". This is completely wrong. In a Prandtl–Meyer expansion, both the flow angle and Mach number vary continuously and smoothly across the expansion fan.\n-   **Error Metrics**: The metric is inadequate as it only considers the state along the downstream wall, failing to verify the solution within the fan itself, which is the region of interest.\n-   **Verdict**: **Incorrect**. This option uses a theoretical model that fundamentally contradicts the physics of a supersonic expansion.\n\nBased on this analysis, Option A is the only one that provides a scientifically consistent, rigorous, and complete design for the specified CFD verification task.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The final step in mastering a physical model is often to implement it in code. This practice guides you through the process of programming a characteristic-based boundary condition for a supersonic flow turning a convex corner, which is the mechanism that generates a Prandtl-Meyer fan in a numerical simulation . By implementing the solution from the ground up, including the numerical inversion of the Prandtl–Meyer function, you will gain a deep, practical understanding of how these theoretical concepts are applied in CFD solvers.",
            "id": "3957858",
            "problem": "Consider a two-dimensional, steady, inviscid, compressible flow of a calorically perfect gas characterized by a constant ratio of specific heats, denoted by $\\gamma$. A uniform supersonic stream approaches a straight slip wall aligned with the $x$-axis and encounters a sharp convex corner that deflects the wall by a constant angle $\\delta$ (a positive turn measured from the incoming wall orientation). The upstream state is uniform with Mach number $M_1$ and flow angle $\\theta_1 = 0$ relative to the incoming wall. You must implement a characteristic-based boundary condition at the slip wall that enforces the convex turn consistently with the compatibility relations of the steady two-dimensional Euler equations.\n\nFundamental base to use:\n- The flow is an inviscid, compressible, calorically perfect gas; pressure $p$, density $\\rho$, and velocity vector $\\mathbf{u}$ satisfy the steady Euler equations.\n- For supersonic flow, the equations admit characteristic families that carry compatibility relations involving the local flow angle $\\theta$ and a monotonic function of Mach number $M$ associated with centered expansions.\n- The slip-wall boundary enforces zero normal velocity at the wall and the flow must be tangent to the wall, so the local flow angle equals the local wall angle.\n\nTasks:\n1. From the characteristic form of the steady two-dimensional Euler equations for a calorically perfect gas, derive the centered expansion relations that connect the local flow turning angle $\\theta$ to the change in local Mach number $M$ via a monotonically increasing function of $M$ for supersonic states. Use these relations to define a wall boundary condition at a convex corner that correctly enforces tangency and the convex turn.\n2. Implement a program that constructs the self-similar centered expansion fan produced by the convex corner using a discrete set of rays. For a given number of rays $N$, define a uniform partition of the wall turn from $\\theta = 0$ to $\\theta = \\delta$ (with $\\theta$ measured in degrees). Let $\\nu(M;\\gamma)$ denote the monotonic function of $M$ appearing in the centered expansion relation. For each ray angle $\\theta_i$, compute the local Mach number $M_i$ by solving the centered expansion condition implied by the correct characteristic-based slip wall boundary condition.\n3. To illustrate the effect of the correct characteristic-based boundary condition on the computed fan structure, compare the correct centered expansion result against a naive slip-wall treatment that enforces tangency but does not apply characteristic compatibility (i.e., it keeps $\\theta = 0$ for all rays, leading to $M = M_1$ everywhere). For each case, quantify:\n   - The exit Mach number at the end of the turn $M_{\\mathrm{exit}}$ with the correct boundary condition.\n   - The exit Mach number with the naive slip-wall treatment (which equals $M_1$).\n   - The maximum absolute discrepancy in Mach number across the ray set between the correct and naive treatments, $\\max_i |M_i^{\\mathrm{correct}} - M_1|$.\n   - The angles of the characteristics at the fan exit for the correct solution: $\\alpha_+ = \\theta_{\\mathrm{exit}} + \\mu(M_{\\mathrm{exit}})$ and $\\alpha_- = \\theta_{\\mathrm{exit}} - \\mu(M_{\\mathrm{exit}})$, where $\\mu(M)$ is the Mach angle defined by $\\mu(M) = \\arcsin(1/M)$.\n\nAngle units:\n- All angles (the wall turn $\\delta$, the ray angles $\\theta_i$, the Prandtl–Meyer function $\\nu(M;\\gamma)$, and the Mach angle $\\mu(M)$) must be treated and reported in degrees.\n\nNumerical requirements:\n- The function $\\nu(M;\\gamma)$ is strictly increasing for $M \\geq 1$ and $\\nu(1;\\gamma) = 0$. For any given $\\delta > 0$, the exit Mach number $M_{\\mathrm{exit}}$ satisfies $\\nu(M_{\\mathrm{exit}};\\gamma) = \\nu(M_1;\\gamma) + \\delta$. Your implementation must solve this equation numerically for $M_{\\mathrm{exit}}$ and similarly for each ray angle $\\theta_i$.\n- Use robust root bracketing and bisection (or an equivalent monotone method) to solve for Mach numbers from target values of $\\nu$. Do not assume closed-form inverses.\n\nTest suite:\nImplement your program to evaluate the following five parameter sets. For each, use the given number of rays $N$:\n- Case A: $\\gamma = 1.4$, $M_1 = 2.0$, $\\delta = 10.0$ degrees, $N = 50$.\n- Case B: $\\gamma = 1.4$, $M_1 = 2.0$, $\\delta = 60.0$ degrees, $N = 80$.\n- Case C: $\\gamma = 1.4$, $M_1 = 1.05$, $\\delta = 5.0$ degrees, $N = 30$.\n- Case D: $\\gamma = 1.6666667$, $M_1 = 3.0$, $\\delta = 20.0$ degrees, $N = 60$.\n- Case E: $\\gamma = 1.4$, $M_1 = 1.5$, $\\delta = 110.0$ degrees, $N = 90$.\n\nOutput specification:\n- For each case, compute and collect the following five quantities in order:\n  1. $M_{\\mathrm{exit}}$ for the correct characteristic-based boundary condition.\n  2. $M_{\\mathrm{exit}}$ for the naive slip-wall treatment (which equals $M_1$).\n  3. $\\max_i |M_i^{\\mathrm{correct}} - M_1|$ over the $N$ rays.\n  4. $\\alpha_+$ at the exit for the correct solution, in degrees.\n  5. $\\alpha_-$ at the exit for the correct solution, in degrees.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one case and is itself a bracketed comma-separated list of the five quantities in the order specified. For example: \"[[a_1,a_2,a_3,a_4,a_5],[b_1,b_2,b_3,b_4,b_5],...]\" where each $a_i$, $b_i$, etc. is a float formatted to six decimal places.",
            "solution": "The user's request is to solve a fluid dynamics problem concerning the supersonic flow over a convex corner, which generates a Prandtl–Meyer expansion fan. The problem is scientifically grounded, well-posed, and all necessary parameters and conditions are provided. Therefore, the problem is valid.\n\n### 1. Theoretical Foundation: Prandtl–Meyer Expansion\n\nThe problem describes a two-dimensional, steady, inviscid, compressible flow. Such flows are governed by the Euler equations. For supersonic flow ($M > 1$), these equations are hyperbolic and can be analyzed using the method of characteristics. The characteristic lines represent paths along which information propagates. For this type of flow, there are two families of characteristics, denoted $C_+$ and $C_-$. Along these characteristics, certain quantities known as Riemann invariants remain constant.\n\nThe Riemann invariants for a 2D isentropic flow of a calorically perfect gas are given by:\n$$\nJ_+ = \\theta + \\nu(M; \\gamma)\n$$\n$$\nJ_- = \\theta - \\nu(M; \\gamma)\n$$\nwhere $\\theta$ is the local flow deflection angle, $M$ is the local Mach number, $\\gamma$ is the ratio of specific heats, and $\\nu(M; \\gamma)$ is the Prandtl–Meyer function.\n\nA centered expansion fan, which forms at a sharp convex corner, is a type of 'simple wave'. In a simple wave, one family of characteristics consists of straight lines, and the corresponding Riemann invariant is constant throughout the entire flow field affected by the wave. For a convex corner turning the flow away from itself (a right-running wave system), the $C_-$ characteristics are straight lines originating from the corner, and the Riemann invariant $J_-$ is constant everywhere.\n\nThe upstream flow is uniform with Mach number $M_1$ and flow angle $\\theta_1 = 0$. We can evaluate the constant value of $J_-$ in this region:\n$$\nJ_- = \\theta_1 - \\nu(M_1; \\gamma) = 0 - \\nu(M_1; \\gamma) = -\\nu(M_1; \\gamma)\n$$\nSince $J_-$ is constant throughout the expansion fan and the region downstream, the following relationship holds for any point $(\\theta, M)$ within the fan:\n$$\n\\theta - \\nu(M; \\gamma) = -\\nu(M_1; \\gamma)\n$$\nRearranging this gives the fundamental equation for Prandtl–Meyer expansion:\n$$\n\\nu(M; \\gamma) = \\nu(M_1; \\gamma) + \\theta\n$$\nThis equation establishes a direct relationship between the local flow turning angle $\\theta$ and the resulting local Mach number $M$. As the flow turns (i.e., $\\theta$ increases from $0$ to the final wall angle $\\delta$), the Mach number $M$ must also increase.\n\n### 2. Governing Functions and Boundary Conditions\n\n**Prandtl–Meyer Function:**\nThe Prandtl–Meyer function $\\nu(M; \\gamma)$ is derived by integrating the compatibility relation along a characteristic. Its standard form is:\n$$\n\\nu(M; \\gamma) = \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(\\sqrt{\\frac{\\gamma-1}{\\gamma+1}(M^2-1)}\\right) - \\arctan(\\sqrt{M^2-1})\n$$\nThis function gives the angle (in radians) through which a sonic flow ($M=1$, where $\\nu(1;\\gamma)=0$) must turn to reach a supersonic Mach number $M$. As stipulated, all angle calculations will be performed in degrees.\n\n**Mach Angle:**\nThe Mach angle, $\\mu$, is the angle between a Mach wave and the local flow direction. It is defined as:\n$$\n\\mu(M) = \\arcsin\\left(\\frac{1}{M}\\right)\n$$\nThe characteristic lines $C_+$ and $C_-$ make angles $\\theta + \\mu(M)$ and $\\theta - \\mu(M)$ with a fixed reference axis, respectively.\n\n**Correct Characteristic-Based Slip-Wall Boundary Condition:**\nThe physical boundary condition at an impermeable wall (a slip wall) is that the flow must be tangent to the wall surface. This means the local flow angle $\\theta$ must equal the local wall angle.\n- At the start of the turn, the wall angle is $0$, so $\\theta = 0$.\n- For any intermediate ray corresponding to a partial turn $\\theta_i$, the flow at the wall must have turned by $\\theta_i$.\n- At the end of the corner, the wall is deflected by $\\delta$, so the exit flow angle is $\\theta_{\\mathrm{exit}} = \\delta$.\n\nApplying the fundamental expansion relation, the Mach number $M_{\\mathrm{exit}}$ at the end of the turn is found by solving:\n$$\n\\nu(M_{\\mathrm{exit}}; \\gamma) = \\nu(M_1; \\gamma) + \\delta\n$$\n\n**Naive Slip-Wall Treatment:**\nThe problem defines a \"naive\" treatment for comparison. This treatment incorrectly assumes the flow does not turn ($\\theta=0$) and thus no expansion occurs, leading to a constant Mach number $M = M_1$ everywhere. This violates the tangency condition at the deflected wall and serves as a baseline to highlight the importance of the correct characteristic-based boundary condition.\n\n### 3. Numerical Solution Algorithm\n\nThe problem requires a numerical implementation to compute the flow properties for a given set of test cases.\n\n1.  **Inverse Prandtl–Meyer Function:** The equation $\\nu(M; \\gamma) = C$ must be solved for $M$. Since $\\nu(M; \\gamma)$ is a strictly monotonic function for $M \\ge 1$, this can be reliably done using a numerical root-finding algorithm. A bracketing method like bisection or Brent's method is suitable. We define an objective function $f(M) = \\nu(M; \\gamma) - C$ and find the root $M$ for which $f(M)=0$ within a bracket $[1, M_{\\mathrm{upper}}]$, where $M_{\\mathrm{upper}}$ is a sufficiently large Mach number (e.g., $100$).\n\n2.  **Processing Each Test Case:** For each set of parameters $(\\gamma, M_1, \\delta, N)$:\n    a. Calculate the initial Prandtl–Meyer angle $\\nu_1 = \\nu(M_1; \\gamma)$.\n    b. Compute the required five output quantities:\n        i. **$M_{\\mathrm{exit}}$ (Correct):** Calculate the target exit angle $\\nu_{\\mathrm{exit}} = \\nu_1 + \\delta$. Solve for $M_{\\mathrm{exit}}$ using the numerical root-finder.\n        ii. **$M_{\\mathrm{exit}}$ (Naive):** This is simply $M_1$.\n        iii. **Maximum Mach Discrepancy:**\n            - Create an array of $N$ ray angles $\\theta_i$ uniformly distributed from $0$ to $\\delta$.\n            - For each $\\theta_i$, calculate the target $\\nu_i = \\nu_1 + \\theta_i$.\n            - Solve for the corresponding Mach number $M_i^{\\mathrm{correct}}$.\n            - The maximum discrepancy is $\\max_{i} |M_i^{\\mathrm{correct}} - M_1|$. Since $M$ increases monotonically with $\\theta$, this will be equal to $M_{\\mathrm{exit}} - M_1$.\n        iv. **Exit Characteristic Angle $\\alpha_+$:** Calculate the exit Mach angle $\\mu_{\\mathrm{exit}} = \\arcsin(1/M_{\\mathrm{exit}})$ in degrees. Then, $\\alpha_+ = \\delta + \\mu_{\\mathrm{exit}}$.\n        v. **Exit Characteristic Angle $\\alpha_-$:** Similarly, $\\alpha_- = \\delta - \\mu_{\\mathrm{exit}}$.\n\n3.  **Output Formatting:** The results for all test cases are collected and formatted into a single string representing a nested list, with each numerical value formatted to six decimal places, as specified in the problem statement.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the Prandtl-Meyer expansion fan problem for a series of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (gamma, M1, delta, N)\n        (1.4, 2.0, 10.0, 50),\n        (1.4, 2.0, 60.0, 80),\n        (1.4, 1.05, 5.0, 30),\n        (1.6666667, 3.0, 20.0, 60),\n        (1.4, 1.5, 110.0, 90),\n    ]\n\n    def prandtl_meyer(M, gamma):\n        \"\"\"\n        Calculates the Prandtl-Meyer function nu(M, gamma) in degrees.\n        Returns 0 for M = 1.\n        \"\"\"\n        if M = 1.0:\n            return 0.0\n        \n        # Using np.float128 for gamma to handle the fraction 5/3 accurately\n        g = np.float128(gamma)\n        \n        term1_sqrt_arg = (g - 1) / (g + 1) * (M**2 - 1)\n        term1 = np.sqrt((g + 1) / (g - 1)) * np.arctan(np.sqrt(term1_sqrt_arg))\n        \n        term2_sqrt_arg = M**2 - 1\n        term2 = np.arctan(np.sqrt(term2_sqrt_arg))\n        \n        # Result is in radians, convert to degrees\n        return (term1 - term2) * 180.0 / np.pi\n\n    def mach_from_nu(nu_target_deg, gamma):\n        \"\"\"\n        Solves for Mach number M given the Prandtl-Meyer angle nu in degrees.\n        Uses Brent's method for root finding.\n        \"\"\"\n        if nu_target_deg = 0:\n            return 1.0\n        \n        # Define the objective function for the root finder\n        def root_func(M):\n            return prandtl_meyer(M, gamma) - nu_target_deg\n        \n        # Find an upper bound for M that gives nu > nu_target_deg\n        m_upper = 2.0\n        # Check against theoretical max nu to avoid infinite loop\n        nu_max = (np.sqrt((gamma + 1) / (gamma - 1)) - 1) * 90.0\n        if nu_target_deg > nu_max:\n            raise ValueError(f\"Target nu {nu_target_deg} exceeds max possible nu {nu_max} for gamma={gamma}\")\n        \n        while prandtl_meyer(m_upper, gamma)  nu_target_deg:\n            m_upper *= 2.0\n        \n        # Brent's method is efficient and robust for a monotonic function.\n        # It's a valid \"equivalent monotone method\" to bisection.\n        try:\n            M_sol = brentq(root_func, 1.0, m_upper, xtol=1e-12, rtol=1e-12)\n            return M_sol\n        except ValueError:\n            # This can happen if root_func(1.0) and root_func(m_upper) have the same sign,\n            # which indicates an issue with the bracketing or target value.\n             raise ValueError(\"Root finding failed. Check input values.\")\n\n    def mach_angle(M):\n        \"\"\"\n        Calculates the Mach angle mu(M) in degrees.\n        \"\"\"\n        if M = 1.0:\n            return 90.0\n        return np.arcsin(1.0 / M) * 180.0 / np.pi\n\n    all_results_str = []\n    \n    for case in test_cases:\n        gamma, M1, delta, N = case\n        \n        # 1. M_exit for the correct characteristic-based boundary condition.\n        nu_1 = prandtl_meyer(M1, gamma)\n        nu_exit_target = nu_1 + delta\n        M_exit_correct = mach_from_nu(nu_exit_target, gamma)\n        \n        # 2. M_exit for the naive slip-wall treatment (equals M1).\n        M_exit_naive = M1\n        \n        # 3. Maximum absolute discrepancy in Mach number.\n        # This occurs at the maximum turning angle, delta.\n        # Since expansion occurs, M_exit_correct > M1.\n        max_discrepancy = M_exit_correct - M1\n        \n        # 4. Characteristic angle alpha+ at the exit (correct solution).\n        mu_exit = mach_angle(M_exit_correct)\n        alpha_plus = delta + mu_exit\n        \n        # 5. Characteristic angle alpha- at the exit (correct solution).\n        alpha_minus = delta - mu_exit\n        \n        case_results = [\n            M_exit_correct,\n            M_exit_naive,\n            max_discrepancy,\n            alpha_plus,\n            alpha_minus\n        ]\n        \n        case_str = f\"[{','.join(f'{val:.6f}' for val in case_results)}]\"\n        all_results_str.append(case_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```"
        }
    ]
}