{
    "hands_on_practices": [
        {
            "introduction": "This foundational exercise solidifies your understanding by guiding you through the derivation of two cornerstone relations in compressible flow from first principles. You will first derive the area-Mach relation for quasi-one-dimensional isentropic flow to analyze a nozzle, and then derive the Prandtl-Meyer function for a two-dimensional expansion fan . By solving for the same exit Mach number in both scenarios, this practice highlights the connection between two distinct methods of supersonic acceleration and reinforces the underlying physics common to both.",
            "id": "3957820",
            "problem": "A steady, inviscid, adiabatic, quasi-one-dimensional nozzle accelerates a calorically perfect gas (ratio of specific heats $\\gamma$ constant) from a sonic throat to a supersonic exit. The upstream stagnation state is uniform, and the flow is isentropic. The throat is choked so that the Mach number at the throat is $M^{*} = 1$ and the throat area is $A^{*}$. The exit-to-throat area ratio is specified as $A_{e}/A^{*} = \\dfrac{27}{16}$. The gas is air modeled as a calorically perfect gas with $\\gamma = 1.4$.\n\nTask 1: Starting only from the steady conservation laws, the ideal-gas equation of state, and isentropic relations for a calorically perfect gas, derive the area–Mach relation for quasi-one-dimensional isentropic flow, and use it to determine the supersonic exit Mach number $M_{e}$ corresponding to $A_{e}/A^{*} = \\dfrac{27}{16}$.\n\nTask 2: Now consider a planar simple expansion fan governed by the Prandtl–Meyer (PM) theory that turns a uniform upstream flow at $M=1$ to the same supersonic Mach number $M_{e}$ found in Task 1. Starting from the steady, inviscid, isentropic, irrotational two-dimensional equations and the simple-wave compatibility, derive the Prandtl–Meyer function $\\nu(M)$ and compute the required wall turning angle $\\theta = \\nu(M_{e}) - \\nu(1)$ to achieve $M_{e}$.\n\nExpress the final answer as the single turning angle $\\theta$ in degrees, and round to four significant figures. Do not report any intermediate values as part of the final answer.",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Flow conditions (Task 1):** Steady, inviscid, adiabatic, quasi-one-dimensional, isentropic.\n- **Flow conditions (Task 2):** Steady, inviscid, isentropic, irrotational, two-dimensional, simple expansion fan.\n- **Gas model:** Calorically perfect gas.\n- **Ratio of specific heats:** $\\gamma = 1.4$.\n- **Nozzle geometry:** Choked throat with Mach number $M^{*} = 1$ at area $A^{*}$. Exit-to-throat area ratio $A_{e}/A^{*} = \\frac{27}{16}$.\n- **Expansion fan conditions:** Uniform upstream flow at Mach number $M=1$. The flow accelerates to the supersonic Mach number $M_e$ found in Task 1.\n- **Derivations required:**\n    1. Area–Mach relation for quasi-one-dimensional isentropic flow, starting from conservation laws, ideal-gas equation of state, and isentropic relations.\n    2. Prandtl–Meyer function $\\nu(M)$, starting from 2D equations and simple-wave compatibility.\n- **Final output:** The required wall turning angle $\\theta = \\nu(M_e) - \\nu(1)$ in degrees, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific or Factual Unsoundness:** The problem is based on the standard and well-established theories of quasi-one-dimensional isentropic flow and two-dimensional Prandtl–Meyer expansion waves, which are cornerstones of compressible aerodynamics. There are no violations of scientific principles.\n2.  **Non-Formalizable or Irrelevant:** The problem is a standard exercise in compressible flow theory, directly related to the topics of expansion fans and nozzle flow.\n3.  **Incomplete or Contradictory Setup:** The problem provides all necessary information. The area ratio $A_e/A^* = \\frac{27}{16}  1$ allows for a supersonic solution, as requested. All parameters ($\\gamma$, area ratio) are specified.\n4.  **Unrealistic or Infeasible:** All given values and physical conditions are realistic and commonly encountered in aerospace engineering problems.\n5.  **Ill-Posed or Poorly Structured:** The area-Mach number relation is a double-valued function of Mach number for a given area ratio ($1$), yielding one subsonic and one supersonic solution. The problem explicitly asks for the *supersonic* exit Mach number, which makes the solution unique. The structure is logical, using the result of the first task as input for the second.\n6.  **Pseudo-Profound, Trivial, or Tautological:** The required derivations are fundamental and non-trivial, demanding a firm grasp of compressible flow theory. The problem is a legitimate test of understanding.\n7.  **Outside Scientific Verifiability:** The problem and its solution are entirely within the realm of standard, verifiable gas dynamics theory.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, and objective. It is deemed **valid**. A full solution will be provided.\n\n### Task 1: Derivation of the Area–Mach Relation and Calculation of $M_e$\n\nWe begin with the conservation of mass for a steady, quasi-one-dimensional flow:\n$$ \\dot{m} = \\rho u A = \\text{constant} $$\nwhere $\\rho$ is the density, $u$ is the flow speed, and $A$ is the cross-sectional area.\nFor an isentropic flow of a calorically perfect gas, the stagnation properties (denoted by subscript $0$) are constant. The local properties can be related to the stagnation properties and the local Mach number $M$ as follows:\nThe relation between stagnation and static temperature is derived from the energy equation, $h_0 = h + \\frac{1}{2}u^2$, which for a calorically perfect gas ($h=c_p T$) becomes $c_p T_0 = c_p T + \\frac{1}{2}u^2$. Using $u=Ma$ and $a^2=\\gamma R T = (\\gamma-1)c_p T$, we get:\n$$ \\frac{T_0}{T} = 1 + \\frac{\\gamma-1}{2} M^2 $$\nFor an isentropic process, $p/\\rho^\\gamma = \\text{constant}$, which leads to:\n$$ \\frac{p_0}{p} = \\left(\\frac{T_0}{T}\\right)^{\\frac{\\gamma}{\\gamma-1}} = \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{\\frac{\\gamma}{\\gamma-1}} $$\n$$ \\frac{\\rho_0}{\\rho} = \\left(\\frac{T_0}{T}\\right)^{\\frac{1}{\\gamma-1}} = \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{\\frac{1}{\\gamma-1}} $$\nThe local velocity $u$ can be expressed as:\n$$ u = M a = M \\sqrt{\\gamma R T} = M \\sqrt{\\gamma R T_0} \\sqrt{\\frac{T}{T_0}} = M a_0 \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-1/2} $$\nSubstituting the expressions for $\\rho$ and $u$ into the mass flow rate equation:\n$$ \\dot{m} = A \\left[ \\rho_0 \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{1}{\\gamma-1}} \\right] \\left[ M a_0 \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-1/2} \\right] $$\nCombining the exponents gives:\n$$ \\dot{m} = A \\rho_0 a_0 M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{1}{2} \\left( \\frac{2}{\\gamma-1} + 1 \\right)} = A \\rho_0 a_0 M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} $$\nSince $\\dot{m}$, $\\rho_0$, and $a_0$ are constant throughout the nozzle, we can write:\n$$ \\frac{\\dot{m}}{\\rho_0 a_0} = A M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} = \\text{constant} $$\nThe throat is choked, meaning the Mach number at the minimum area $A=A^*$ is $M=1$. Applying the above relation at the throat:\n$$ \\frac{\\dot{m}}{\\rho_0 a_0} = A^* (1) \\left(1 + \\frac{\\gamma-1}{2} (1)^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} = A^* \\left(\\frac{\\gamma+1}{2}\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} $$\nBy equating the general expression for the mass flow group with its value at the throat, we can find the area ratio $A/A^*$:\n$$ A M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} = A^* \\left(\\frac{\\gamma+1}{2}\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} $$\nRearranging for the area ratio, we obtain the area–Mach relation:\n$$ \\frac{A}{A^*} = \\frac{1}{M} \\left[ \\frac{1 + \\frac{\\gamma-1}{2} M^2}{\\frac{\\gamma+1}{2}} \\right]^{\\frac{\\gamma+1}{2(\\gamma-1)}} $$\nThis completes the derivation for Task 1.\n\nNow, we must find the supersonic exit Mach number $M_e$ for $A_e/A^* = \\frac{27}{16}$ and $\\gamma=1.4$.\n$$ \\frac{\\gamma+1}{2(\\gamma-1)} = \\frac{1.4+1}{2(1.4-1)} = \\frac{2.4}{0.8} = 3 $$\n$$ \\frac{\\gamma-1}{2} = \\frac{1.4-1}{2} = 0.2 $$\n$$ \\frac{\\gamma+1}{2} = \\frac{1.4+1}{2} = 1.2 $$\nSubstituting these values into the area-Mach relation:\n$$ \\frac{A_e}{A^*} = \\frac{1}{M_e} \\left[ \\frac{1 + 0.2 M_e^2}{1.2} \\right]^3 = \\frac{27}{16} $$\n$$ \\frac{27}{16} = \\frac{1}{M_e} \\left[ \\frac{5}{6} (1 + 0.2 M_e^2) \\right]^3 $$\nThis is a nonlinear algebraic equation for $M_e$. We seek a supersonic root ($M_e  1$). Let us test an integer value, such as $M_e=2$:\n$$ \\frac{1}{2} \\left[ \\frac{5}{6} (1 + 0.2(2^2)) \\right]^3 = \\frac{1}{2} \\left[ \\frac{5}{6} (1 + 0.8) \\right]^3 = \\frac{1}{2} \\left[ \\frac{5}{6} (1.8) \\right]^3 = \\frac{1}{2} [1.5]^3 = \\frac{1}{2} [3.375] = 1.6875 $$\nSince $\\frac{27}{16} = 1.6875$, the supersonic exit Mach number is exactly $M_e=2$.\n\n### Task 2: Derivation of the Prandtl–Meyer Function and Calculation of $\\theta$\n\nFor a steady, inviscid, irrotational, 2D supersonic flow, the flow properties can change across characteristic lines. An expansion fan is composed of a continuous set of C+ characteristics originating from a single point. The compatibility relation along a C+ characteristic is:\n$$ d\\theta - \\frac{du}{u \\tan\\mu} = 0 $$\nwhere $\\theta$ is the flow deflection angle and $\\mu = \\arcsin(1/M)$ is the Mach angle. Rearranging for $d\\theta$ and using $\\tan\\mu = (\\sqrt{M^2-1})^{-1}$:\n$$ d\\theta = \\frac{du}{u \\tan\\mu} = \\sqrt{M^2-1} \\frac{du}{u} $$\nTo integrate this, we must express $du/u$ in terms of $M$. From the energy equation, we have $T_0/T = 1 + \\frac{\\gamma-1}{2}M^2$. Differentiating this logarithmically:\n$$ -\\frac{dT}{T} = \\frac{(\\gamma-1) M dM}{1 + \\frac{\\gamma-1}{2}M^2} $$\nAlso, we have $u = M a = M \\sqrt{\\gamma R T}$. Differentiating this logarithmically yields $2 \\frac{du}{u} = 2 \\frac{dM}{M} + \\frac{dT}{T}$. Substituting for $dT/T$:\n$$ 2 \\frac{du}{u} = 2 \\frac{dM}{M} - \\frac{(\\gamma-1) M^2}{1 + \\frac{\\gamma-1}{2}M^2} \\frac{dM}{M} = \\left( 2 - \\frac{(\\gamma-1)M^2}{1 + \\frac{\\gamma-1}{2}M^2} \\right) \\frac{dM}{M} = \\left( \\frac{2 + (\\gamma-1)M^2 - (\\gamma-1)M^2}{1 + \\frac{\\gamma-1}{2}M^2} \\right) \\frac{dM}{M} $$\n$$ \\frac{du}{u} = \\frac{1}{1 + \\frac{\\gamma-1}{2}M^2} \\frac{dM}{M} $$\nSubstituting this into the expression for $d\\theta$:\n$$ d\\theta = \\frac{\\sqrt{M^2-1}}{M(1 + \\frac{\\gamma-1}{2}M^2)} dM $$\nThe Prandtl–Meyer function $\\nu(M)$ represents the angle through which a flow turns from $M=1$ to a given Mach number $M$. We obtain it by integrating $d\\theta$ from $M=1$ to $M$:\n$$ \\nu(M) = \\int_1^M \\frac{\\sqrt{M'^2-1}}{M'(1 + \\frac{\\gamma-1}{2}M'^2)} dM' $$\nTo solve this integral, we use the substitution $y^2 = M'^2 - 1$. This implies $M'^2 = y^2+1$ and $2y\\,dy = 2M'\\,dM'$, which gives $\\frac{dM'}{M'} = \\frac{y\\,dy}{y^2+1}$. The integration limits change from $M'=1 \\to M$ to $y=0 \\to \\sqrt{M^2-1}$. The denominator term becomes $1 + \\frac{\\gamma-1}{2}M'^2 = 1 + \\frac{\\gamma-1}{2}(y^2+1) = \\frac{\\gamma+1}{2} + \\frac{\\gamma-1}{2}y^2$. Substituting these into the integral:\n$$ \\nu(M) = \\int_0^{\\sqrt{M^2-1}} \\frac{y}{ \\frac{\\gamma+1}{2} + \\frac{\\gamma-1}{2} y^2 } \\frac{y dy}{y^2+1} = \\int_0^{\\sqrt{M^2-1}} \\frac{2y^2 dy}{((\\gamma-1)y^2 + \\gamma+1)(y^2+1)} $$\nUsing partial fraction decomposition, the integrand can be rewritten as:\n$$ \\frac{2y^2}{((\\gamma-1)y^2 + \\gamma+1)(y^2+1)} = \\frac{\\gamma+1}{(\\gamma-1)y^2 + \\gamma+1} - \\frac{1}{y^2+1} $$\nIntegrating this expression gives:\n$$ \\nu(M) = \\int_0^{\\sqrt{M^2-1}} \\left( \\frac{\\gamma+1}{(\\gamma-1)y^2 + \\gamma+1} - \\frac{1}{y^2+1} \\right) dy $$\n$$ \\nu(M) = \\left[ \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(y\\sqrt{\\frac{\\gamma-1}{\\gamma+1}}\\right) - \\arctan(y) \\right]_0^{\\sqrt{M^2-1}} $$\nSubstituting back $y=\\sqrt{M'^2-1}$ and evaluating at the limits yields the Prandtl-Meyer function:\n$$ \\nu(M) = \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(\\sqrt{\\frac{\\gamma-1}{\\gamma+1}(M^2-1)}\\right) - \\arctan\\left(\\sqrt{M^2-1}\\right) $$\nThis completes the derivation for Task 2.\n\nThe required turning angle is $\\theta = \\nu(M_e) - \\nu(1)$. Since the initial Mach number is $M=1$, we have $\\nu(1) = 0$. Thus, $\\theta = \\nu(M_e)$. We use $M_e=2$ and $\\gamma=1.4$.\n$$ \\frac{\\gamma+1}{\\gamma-1} = \\frac{2.4}{0.4} = 6 $$\n$$ \\theta = \\nu(2) = \\sqrt{6} \\arctan\\left(\\sqrt{\\frac{1}{6}(2^2-1)}\\right) - \\arctan\\left(\\sqrt{2^2-1}\\right) $$\n$$ \\theta = \\sqrt{6} \\arctan\\left(\\sqrt{\\frac{3}{6}}\\right) - \\arctan(\\sqrt{3}) $$\n$$ \\theta = \\sqrt{6} \\arctan\\left(\\frac{1}{\\sqrt{2}}\\right) - \\arctan(\\sqrt{3}) $$\nThe calculations must be done using radians.\n$$ \\arctan(\\sqrt{3}) = \\frac{\\pi}{3} $$\n$$ \\arctan\\left(\\frac{1}{\\sqrt{2}}\\right) \\approx \\arctan(0.707107) \\approx 0.615480 \\text{ rad} $$\n$$ \\sqrt{6} \\approx 2.44949 $$\n$$ \\theta \\approx (2.44949)(0.615480) - \\frac{\\pi}{3} \\approx 1.507616 - 1.047198 \\approx 0.460418 \\text{ rad} $$\nConverting to degrees:\n$$ \\theta_{\\text{deg}} = 0.460418 \\times \\frac{180}{\\pi} \\approx 26.3795^\\circ $$\nRounding to four significant figures, the turning angle is $26.38^\\circ$.",
            "answer": "$$\\boxed{26.38}$$"
        },
        {
            "introduction": "Idealized models, like the sharp-corner expansion, are powerful but have limitations. This practice bridges the gap between theory and reality by examining an expansion fan generated from a convex corner with a finite radius of curvature . By determining the location of the \"virtual apex\"—the apparent origin of the expansion in the far-field—you will learn how to apply the principles of characteristic lines to more realistic geometries and appreciate how the flow structure evolves from the near-field to the far-field.",
            "id": "3957849",
            "problem": "A two-dimensional, steady, inviscid, irrotational supersonic stream of a calorically perfect gas with ratio of specific heats $\\gamma = 1.4$ at upstream Mach number $M_1 = 2.5$ flows over a convex wall turn. Instead of a sharp corner, the wall turn is implemented by a circular arc of radius $R = 50 \\ \\mathrm{mm}$ that connects two straight wall segments whose relative deflection is $\\theta_w = 15^\\circ$. Assume the flow in the expansion is isentropic and that the curvature is sufficiently gentle for a locally quasi-uniform state to exist adjacent to the wall.\n\nIn the idealized sharp-corner limit, a Prandtl–Meyer expansion fan would be initiated at a point and occupy the angular sector bounded by the leading and trailing characteristic rays. For the finite-radius arc, the expansion is initiated continuously along the arc, and the fan is observed to be “smeared” near the wall but to appear to emanate from a “virtual apex” at distances large compared with $R$.\n\nUsing only fundamental conservation laws and well-tested relations for two-dimensional isentropic supersonic simple waves, reason about the effect of the finite corner radius on the initiation of the fan and select the one option that correctly quantifies, for the given data, both:\n- an appropriate location for the apparent fan virtual apex relative to the start of curvature, and\n- an estimate of the downstream region over which the fan can be regarded as approximately centered about a bisector ray as if it emanated from that virtual apex.\n\nChoose the single best answer.\n\nA. The apparent fan apex is the intersection of the leading and trailing bounding characteristic rays drawn, respectively, from the start and end of the arc; for the given parameters this lies at approximately $(x^\\ast, y^\\ast) \\approx (0.048 \\ \\mathrm{m}, \\ 0.021 \\ \\mathrm{m})$ measured from the start of curvature along and normal to the upstream wall, and the fan is effectively centered for observation distances $D \\gtrsim 0.16 \\ \\mathrm{m}$ along the fan centerline.\n\nB. The apparent fan apex coincides with the mid-point of the arc; for the given parameters at approximately $(x, y) \\approx (0.0065 \\ \\mathrm{m}, \\ -0.00085 \\ \\mathrm{m})$ from the start of curvature, and the fan is effectively centered for $D \\gtrsim R \\approx 0.050 \\ \\mathrm{m}$.\n\nC. The apparent fan apex remains at the start of curvature; finite radius only alters the local thickness of the fan, and the fan is effectively centered as soon as $D \\gtrsim 0.010 \\ \\mathrm{m}$.\n\nD. The apparent fan apex coincides with the end of curvature at approximately $(x, y) \\approx (0.0129 \\ \\mathrm{m}, \\ -0.0017 \\ \\mathrm{m})$ from the start of curvature, and the fan requires $D \\gtrsim 1 \\ \\mathrm{m}$ to appear centered.",
            "solution": "The user has provided a problem in supersonic aerodynamics concerning a Prandtl-Meyer expansion over a convex corner of finite radius. The task is to validate the problem statement, derive the solution based on fundamental principles, and evaluate the given options.\n\n### Step 1: Extract Givens\n\nThe data and conditions provided in the problem statement are:\n-   **Flow conditions**: Two-dimensional, steady, inviscid, irrotational, supersonic, isentropic expansion.\n-   **Gas properties**: Calorically perfect gas, ratio of specific heats $\\gamma = 1.4$.\n-   **Upstream state**: Mach number $M_1 = 2.5$.\n-   **Geometry**: A convex wall turn composed of a circular arc.\n-   **Arc radius**: $R = 50 \\ \\mathrm{mm} = 0.05 \\ \\mathrm{m}$.\n-   **Total deflection angle**: The relative deflection between the two straight wall segments is $\\theta_w = 15^\\circ$.\n-   **Assumption**: A locally quasi-uniform state exists adjacent to the wall, justifying the use of simple wave theory.\n-   **Objective**: Determine the location of the apparent \"virtual apex\" of the expansion fan and estimate the region where the fan appears centered.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem statement is scientifically sound and well-posed.\n-   **Scientifically Grounded**: The problem describes Prandtl-Meyer expansion over a curved wall, a classic topic in compressible fluid dynamics. The assumptions (inviscid flow, perfect gas) are standard idealizations. The concept of a virtual apex for a fan from a rounded corner is well-established in the field.\n-   **Well-Posed**: The problem provides all necessary parameters ($M_1$, $\\gamma$, $R$, $\\theta_w$) to determine the flow field properties and the geometry of the characteristic lines. The question is specific and answerable.\n-   **Objective**: The language is technical and precise, with no subjective or ambiguous statements in the problem setup.\n\nAll criteria for a valid problem are met. The setup is self-contained, consistent, and scientifically grounded.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. We may proceed with the derivation and solution.\n\n### Principle-Based Derivation\n\nThe virtual apex of an expansion fan generated by a curved corner is defined as the intersection of the leading and trailing characteristic lines of the expansion, assuming they are straight. This is a standard model for analyzing the far-field behavior of the fan.\n\n**1. Coordinate System and Geometry**\nLet's establish a coordinate system where the start of the circular arc is at the origin $(0,0)$. The upstream flow is along the positive $x$-axis. For a convex corner, the wall must turn away from the flow. We consider the case where the flow is below the wall, so the wall curves upwards into the region $y  0$. This corresponds to a left turn.\n-   Start of curvature: $P_1 = (0, 0)$.\n-   The center of the circular arc of radius $R$ is at $(0, R)$.\n-   The total turn angle is $\\theta_w = 15^\\circ$. The coordinates of the end of the arc, $P_2$, are:\n    $$x_2 = R \\sin \\theta_w = (0.05 \\ \\mathrm{m}) \\sin(15^\\circ) \\approx 0.05 \\times 0.25882 \\approx 0.01294 \\ \\mathrm{m}$$\n    $$y_2 = R - R \\cos \\theta_w = (0.05 \\ \\mathrm{m}) (1 - \\cos(15^\\circ)) \\approx 0.05 \\times (1 - 0.96593) \\approx 0.0017035 \\ \\mathrm{m}$$\n    So, $P_2 \\approx (0.01294 \\ \\mathrm{m}, 0.001704 \\ \\mathrm{m})$.\n\n**2. Flow Properties and Characteristic Angles**\nIn a simple wave expansion, characteristics of one family are straight lines along which flow properties are constant. For a left-turning flow, these are the $C_+$ characteristics. The angle of a $C_+$ characteristic with the x-axis is $\\alpha = \\theta + \\mu$, where $\\theta$ is the local flow angle and $\\mu = \\arcsin(1/M)$ is the Mach angle.\n\n-   **Leading Characteristic (from $P_1$)**:\n    -   At $P_1=(0,0)$, the flow is undisturbed: $\\theta_1 = 0^\\circ$ and $M_1 = 2.5$.\n    -   The initial Mach angle is $\\mu_1 = \\arcsin(1/2.5) = \\arcsin(0.4) \\approx 23.578^\\circ$.\n    -   The slope of the leading characteristic is $m_1 = \\tan(\\theta_1 + \\mu_1) = \\tan(23.578^\\circ) \\approx 0.4364$.\n    -   The equation of the line is $y = m_1 x = 0.4364 x$.\n\n-   **Trailing Characteristic (from $P_2$)**:\n    -   The flow must turn by $\\theta_w = 15^\\circ$. Thus, the flow angle at $P_2$ is $\\theta_2 = 15^\\circ$.\n    -   The downstream Mach number, $M_2$, is found using the Prandtl-Meyer function, $\\nu(M)$:\n        $$\\nu(M) = \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(\\sqrt{\\frac{\\gamma-1}{\\gamma+1}(M^2-1)}\\right) - \\arctan\\left(\\sqrt{M^2-1}\\right)$$\n    -   For $\\gamma = 1.4$, we have $\\sqrt{(\\gamma+1)/(\\gamma-1)} = \\sqrt{2.4/0.4} = \\sqrt{6}$.\n    -   For $M_1 = 2.5$, the Prandtl-Meyer angle is $\\nu(M_1) \\approx 39.124^\\circ$.\n    -   The expansion is isentropic, so $\\nu(M_2) = \\nu(M_1) + \\theta_w = 39.124^\\circ + 15^\\circ = 54.124^\\circ$.\n    -   Solving for $M_2$ given $\\nu(M_2) = 54.124^\\circ$ (via iteration or tables) yields $M_2 \\approx 3.235$.\n    -   The final Mach angle is $\\mu_2 = \\arcsin(1/M_2) = \\arcsin(1/3.235) \\approx 17.996^\\circ$.\n    -   The slope of the trailing characteristic is $m_2 = \\tan(\\theta_2 + \\mu_2) = \\tan(15^\\circ + 17.996^\\circ) = \\tan(32.996^\\circ) \\approx 0.6493$.\n    -   The equation of the line passing through $P_2(0.01294, 0.001704)$ is $y - y_2 = m_2(x - x_2)$.\n        $$y - 0.001704 = 0.6493(x - 0.01294)$$\n\n**3. Location of the Virtual Apex**\nThe virtual apex $(x^\\ast, y^\\ast)$ is the intersection of these two characteristic lines.\n$$y = 0.4364 x$$\n$$y = 0.6493(x - 0.01294) + 0.001704$$\nSetting them equal:\n$$0.4364 x = 0.6493 x - 0.6493 \\times 0.01294 + 0.001704$$\n$$0.4364 x = 0.6493 x - 0.008402 + 0.001704$$\n$$0.006698 = (0.6493 - 0.4364) x = 0.2129 x$$\n$$x^\\ast = \\frac{0.006698}{0.2129} \\approx 0.03146 \\ \\mathrm{m}$$\n$$y^\\ast = 0.4364 \\times 0.03146 \\approx 0.01373 \\ \\mathrm{m}$$\nThe calculated virtual apex is at approximately $(x^\\ast, y^\\ast) \\approx (0.031 \\ \\mathrm{m}, \\ 0.014 \\ \\mathrm{m})$.\n\n**4. Far-Field Condition**\nThe fan can be considered approximately centered when the observation distance $D$ from the virtual apex is much larger than the characteristic size of the expansion source region. This size can be approximated by the arc length, $L = R \\theta_w = 0.05 \\ \\mathrm{m} \\times (15 \\pi/180) \\approx 0.0131 \\ \\mathrm{m}$. A common rule of thumb for the far field is $D \\gtrsim 10 L$, which suggests $D \\gtrsim 0.13 \\ \\mathrm{m}$.\n\n### Option-by-Option Analysis\n\n**A. The apparent fan apex is the intersection of the leading and trailing bounding characteristic rays drawn, respectively, from the start and end of the arc; for the given parameters this lies at approximately $(x^\\ast, y^\\ast) \\approx (0.048 \\ \\mathrm{m}, \\ 0.021 \\ \\mathrm{m})$ measured from the start of curvature along and normal to the upstream wall, and the fan is effectively centered for observation distances $D \\gtrsim 0.16 \\ \\mathrm{m}$ along the fan centerline.**\n\n-   **Apex Location Description**: The description of the virtual apex as the intersection of bounding characteristics is conceptually correct.\n-   **Apex Location Calculation**: The provided coordinates are $(0.048 \\ \\mathrm{m}, 0.021 \\ \\mathrm{m})$. Our derivation yields $(0.031 \\ \\mathrm{m}, 0.014 \\ \\mathrm{m})$. The values in the option are numerically inconsistent with the problem parameters. The provided $x^\\ast$ and $y^\\ast$ values are over $50\\%$ larger than the calculated ones. A check reveals that the point $(0.048, 0.021)$ lies almost perfectly on the leading characteristic ($0.021 \\approx 0.4364 \\times 0.048$), but it does not lie on the trailing characteristic. This indicates a likely error in the problem's provided numbers, not a conceptual mistake in the option's premise.\n-   **Far-Field Estimate**: The estimate $D \\gtrsim 0.16 \\ \\mathrm{m}$ is physically plausible and consistent with our order-of-magnitude calculation ($D \\gtrsim 0.13 \\ \\mathrm{m}$).\n-   **Verdict**: Although the numerical coordinates for the apex are incorrect, the physical principle cited for its location is correct, and the far-field estimate is reasonable. Compared to other options which are conceptually wrong, this is the \"best\" description of the physics. **Correct** (in the context of being the best available choice).\n\n**B. The apparent fan apex coincides with the mid-point of the arc; for the given parameters at approximately $(x, y) \\approx (0.0065 \\ \\mathrm{m}, \\ -0.00085 \\ \\mathrm{m})$ from the start of curvature, and the fan is effectively centered for $D \\gtrsim R \\approx 0.050 \\ \\mathrm{m}$.**\n\n-   **Apex Location**: The virtual apex is a result of characteristic intersections and does not coincide with any physical point on the wall arc. This premise is physically incorrect. The coordinates given (with $y0$) are also inconsistent with the geometry of a left-turning convex corner.\n-   **Verdict**: **Incorrect**.\n\n**C. The apparent fan apex remains at the start of curvature; finite radius only alters the local thickness of the fan, and the fan is effectively centered as soon as $D \\gtrsim 0.010 \\ \\mathrm{m}$.**\n\n-   **Apex Location**: This is incorrect. The finite radius \"smears\" the origin of the expansion, creating a virtual apex away from the corner. The apex would only be at the start of curvature for a sharp corner.\n-   **Verdict**: **Incorrect**.\n\n**D. The apparent fan apex coincides with the end of curvature at approximately $(x, y) \\approx (0.0129 \\ \\mathrm{m}, \\ -0.0017 \\ \\mathrm{m})$ from the start of curvature, and the fan requires $D \\gtrsim 1 \\ \\mathrm{m}$ to appear centered.**\n\n-   **Apex Location**: Similar to B and C, the apex does not coincide with a point on the physical wall. This premise is incorrect. The coordinates given (with $y0$) are inconsistent with a left-turning geometry.\n-   **Verdict**: **Incorrect**.\n\n### Conclusion\n\nBased on the analysis, Options B, C, and D are based on physically incorrect premises. Option A correctly identifies the physical principle for determining the virtual apex, and provides a reasonable estimate for the far-field condition. However, the numerical coordinates for the apex in Option A are inconsistent with a direct calculation from the problem's given data. Despite this numerical error, it is the only option that is conceptually sound. In the context of selecting the \"single best answer,\" Option A is the superior choice.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Translating theoretical knowledge into a functional algorithm is a vital skill in modern engineering. This exercise challenges you to implement a program that constructs a Prandtl-Meyer expansion fan based on the method of characteristics . You will implement a numerical solver for the inverse Prandtl-Meyer function and use it to model a characteristic-based boundary condition, demonstrating how theory directly informs the computational simulation of supersonic flows and allows for quantitative prediction of the flow field.",
            "id": "3957858",
            "problem": "Consider a two-dimensional, steady, inviscid, compressible flow of a calorically perfect gas characterized by a constant ratio of specific heats, denoted by $\\gamma$. A uniform supersonic stream approaches a straight slip wall aligned with the $x$-axis and encounters a sharp convex corner that deflects the wall by a constant angle $\\delta$ (a positive turn measured from the incoming wall orientation). The upstream state is uniform with Mach number $M_1$ and flow angle $\\theta_1 = 0$ relative to the incoming wall. You must implement a characteristic-based boundary condition at the slip wall that enforces the convex turn consistently with the compatibility relations of the steady two-dimensional Euler equations.\n\nFundamental base to use:\n- The flow is an inviscid, compressible, calorically perfect gas; pressure $p$, density $\\rho$, and velocity vector $\\mathbf{u}$ satisfy the steady Euler equations.\n- For supersonic flow, the equations admit characteristic families that carry compatibility relations involving the local flow angle $\\theta$ and a monotonic function of Mach number $M$ associated with centered expansions.\n- The slip-wall boundary enforces zero normal velocity at the wall and the flow must be tangent to the wall, so the local flow angle equals the local wall angle.\n\nTasks:\n1. From the characteristic form of the steady two-dimensional Euler equations for a calorically perfect gas, derive the centered expansion relations that connect the local flow turning angle $\\theta$ to the change in local Mach number $M$ via a monotonically increasing function of $M$ for supersonic states. Use these relations to define a wall boundary condition at a convex corner that correctly enforces tangency and the convex turn.\n2. Implement a program that constructs the self-similar centered expansion fan produced by the convex corner using a discrete set of rays. For a given number of rays $N$, define a uniform partition of the wall turn from $\\theta = 0$ to $\\theta = \\delta$ (with $\\theta$ measured in degrees). Let $\\nu(M;\\gamma)$ denote the monotonic function of $M$ appearing in the centered expansion relation. For each ray angle $\\theta_i$, compute the local Mach number $M_i$ by solving the centered expansion condition implied by the correct characteristic-based slip wall boundary condition.\n3. To illustrate the effect of the correct characteristic-based boundary condition on the computed fan structure, compare the correct centered expansion result against a naive slip-wall treatment that enforces tangency but does not apply characteristic compatibility (i.e., it keeps $\\theta = 0$ for all rays, leading to $M = M_1$ everywhere). For each case, quantify:\n   - The exit Mach number at the end of the turn $M_{\\mathrm{exit}}$ with the correct boundary condition.\n   - The exit Mach number with the naive slip-wall treatment (which equals $M_1$).\n   - The maximum absolute discrepancy in Mach number across the ray set between the correct and naive treatments, $\\max_i |M_i^{\\mathrm{correct}} - M_1|$.\n   - The angles of the characteristics at the fan exit for the correct solution: $\\alpha_+ = \\theta_{\\mathrm{exit}} + \\mu(M_{\\mathrm{exit}})$ and $\\alpha_- = \\theta_{\\mathrm{exit}} - \\mu(M_{\\mathrm{exit}})$, where $\\mu(M)$ is the Mach angle defined by $\\mu(M) = \\arcsin(1/M)$.\n\nAngle units:\n- All angles (the wall turn $\\delta$, the ray angles $\\theta_i$, the Prandtl–Meyer function $\\nu(M;\\gamma)$, and the Mach angle $\\mu(M)$) must be treated and reported in degrees.\n\nNumerical requirements:\n- The function $\\nu(M;\\gamma)$ is strictly increasing for $M \\geq 1$ and $\\nu(1;\\gamma) = 0$. For any given $\\delta  0$, the exit Mach number $M_{\\mathrm{exit}}$ satisfies $\\nu(M_{\\mathrm{exit}};\\gamma) = \\nu(M_1;\\gamma) + \\delta$. Your implementation must solve this equation numerically for $M_{\\mathrm{exit}}$ and similarly for each ray angle $\\theta_i$.\n- Use robust root bracketing and bisection (or an equivalent monotone method) to solve for Mach numbers from target values of $\\nu$. Do not assume closed-form inverses.\n\nTest suite:\nImplement your program to evaluate the following five parameter sets. For each, use the given number of rays $N$:\n- Case A: $\\gamma = 1.4$, $M_1 = 2.0$, $\\delta = 10.0$ degrees, $N = 50$.\n- Case B: $\\gamma = 1.4$, $M_1 = 2.0$, $\\delta = 60.0$ degrees, $N = 80$.\n- Case C: $\\gamma = 1.4$, $M_1 = 1.05$, $\\delta = 5.0$ degrees, $N = 30$.\n- Case D: $\\gamma = 1.6666667$, $M_1 = 3.0$, $\\delta = 20.0$ degrees, $N = 60$.\n- Case E: $\\gamma = 1.4$, $M_1 = 1.5$, $\\delta = 110.0$ degrees, $N = 90$.\n\nOutput specification:\n- For each case, compute and collect the following five quantities in order:\n  1. $M_{\\mathrm{exit}}$ for the correct characteristic-based boundary condition.\n  2. $M_{\\mathrm{exit}}$ for the naive slip-wall treatment (which equals $M_1$).\n  3. $\\max_i |M_i^{\\mathrm{correct}} - M_1|$ over the $N$ rays.\n  4. $\\alpha_+$ at the exit for the correct solution, in degrees.\n  5. $\\alpha_-$ at the exit for the correct solution, in degrees.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one case and is itself a bracketed comma-separated list of the five quantities in the order specified. For example: \"[[a_1,a_2,a_3,a_4,a_5],[b_1,b_2,b_3,b_4,b_5],...]\" where each $a_i$, $b_i$, etc. is a float formatted to six decimal places.",
            "solution": "The user's request is to solve a fluid dynamics problem concerning the supersonic flow over a convex corner, which generates a Prandtl–Meyer expansion fan. The problem is scientifically grounded, well-posed, and all necessary parameters and conditions are provided. Therefore, the problem is valid.\n\n### 1. Theoretical Foundation: Prandtl–Meyer Expansion\n\nThe problem describes a two-dimensional, steady, inviscid, compressible flow. Such flows are governed by the Euler equations. For supersonic flow ($M  1$), these equations are hyperbolic and can be analyzed using the method of characteristics. The characteristic lines represent paths along which information propagates. For this type of flow, there are two families of characteristics, denoted $C_+$ and $C_-$. Along these characteristics, certain quantities known as Riemann invariants remain constant.\n\nThe Riemann invariants for a 2D isentropic flow of a calorically perfect gas are given by:\n$$\nJ_+ = \\theta + \\nu(M; \\gamma)\n$$\n$$\nJ_- = \\theta - \\nu(M; \\gamma)\n$$\nwhere $\\theta$ is the local flow deflection angle, $M$ is the local Mach number, $\\gamma$ is the ratio of specific heats, and $\\nu(M; \\gamma)$ is the Prandtl–Meyer function.\n\nA centered expansion fan, which forms at a sharp convex corner, is a type of 'simple wave'. In a simple wave, one family of characteristics consists of straight lines, and the corresponding Riemann invariant is constant throughout the entire flow field affected by the wave. For a convex corner turning the flow away from itself (a right-running wave system), the $C_-$ characteristics are straight lines originating from the corner, and the Riemann invariant $J_-$ is constant everywhere.\n\nThe upstream flow is uniform with Mach number $M_1$ and flow angle $\\theta_1 = 0$. We can evaluate the constant value of $J_-$ in this region:\n$$\nJ_- = \\theta_1 - \\nu(M_1; \\gamma) = 0 - \\nu(M_1; \\gamma) = -\\nu(M_1; \\gamma)\n$$\nSince $J_-$ is constant throughout the expansion fan and the region downstream, the following relationship holds for any point $(\\theta, M)$ within the fan:\n$$\n\\theta - \\nu(M; \\gamma) = -\\nu(M_1; \\gamma)\n$$\nRearranging this gives the fundamental equation for Prandtl–Meyer expansion:\n$$\n\\nu(M; \\gamma) = \\nu(M_1; \\gamma) + \\theta\n$$\nThis equation establishes a direct relationship between the local flow turning angle $\\theta$ and the resulting local Mach number $M$. As the flow turns (i.e., $\\theta$ increases from $0$ to the final wall angle $\\delta$), the Mach number $M$ must also increase.\n\n### 2. Governing Functions and Boundary Conditions\n\n**Prandtl–Meyer Function:**\nThe Prandtl–Meyer function $\\nu(M; \\gamma)$ is derived by integrating the compatibility relation along a characteristic. Its standard form is:\n$$\n\\nu(M; \\gamma) = \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(\\sqrt{\\frac{\\gamma-1}{\\gamma+1}(M^2-1)}\\right) - \\arctan(\\sqrt{M^2-1})\n$$\nThis function gives the angle (in radians) through which a sonic flow ($M=1$, where $\\nu(1;\\gamma)=0$) must turn to reach a supersonic Mach number $M$. As stipulated, all angle calculations will be performed in degrees.\n\n**Mach Angle:**\nThe Mach angle, $\\mu$, is the angle between a Mach wave and the local flow direction. It is defined as:\n$$\n\\mu(M) = \\arcsin\\left(\\frac{1}{M}\\right)\n$$\nThe characteristic lines $C_+$ and $C_-$ make angles $\\theta + \\mu(M)$ and $\\theta - \\mu(M)$ with a fixed reference axis, respectively.\n\n**Correct Characteristic-Based Slip-Wall Boundary Condition:**\nThe physical boundary condition at an impermeable wall (a slip wall) is that the flow must be tangent to the wall surface. This means the local flow angle $\\theta$ must equal the local wall angle.\n- At the start of the turn, the wall angle is $0$, so $\\theta = 0$.\n- For any intermediate ray corresponding to a partial turn $\\theta_i$, the flow at the wall must have turned by $\\theta_i$.\n- At the end of the corner, the wall is deflected by $\\delta$, so the exit flow angle is $\\theta_{\\mathrm{exit}} = \\delta$.\n\nApplying the fundamental expansion relation, the Mach number $M_{\\mathrm{exit}}$ at the end of the turn is found by solving:\n$$\n\\nu(M_{\\mathrm{exit}}; \\gamma) = \\nu(M_1; \\gamma) + \\delta\n$$\n\n**Naive Slip-Wall Treatment:**\nThe problem defines a \"naive\" treatment for comparison. This treatment incorrectly assumes the flow does not turn ($\\theta=0$) and thus no expansion occurs, leading to a constant Mach number $M = M_1$ everywhere. This violates the tangency condition at the deflected wall and serves as a baseline to highlight the importance of the correct characteristic-based boundary condition.\n\n### 3. Numerical Solution Algorithm\n\nThe problem requires a numerical implementation to compute the flow properties for a given set of test cases.\n\n1.  **Inverse Prandtl–Meyer Function:** The equation $\\nu(M; \\gamma) = C$ must be solved for $M$. Since $\\nu(M; \\gamma)$ is a strictly monotonic function for $M \\ge 1$, this can be reliably done using a numerical root-finding algorithm. A bracketing method like bisection or Brent's method is suitable. We define an objective function $f(M) = \\nu(M; \\gamma) - C$ and find the root $M$ for which $f(M)=0$ within a bracket $[1, M_{\\mathrm{upper}}]$, where $M_{\\mathrm{upper}}$ is a sufficiently large Mach number (e.g., $100$).\n\n2.  **Processing Each Test Case:** For each set of parameters $(\\gamma, M_1, \\delta, N)$:\n    a. Calculate the initial Prandtl–Meyer angle $\\nu_1 = \\nu(M_1; \\gamma)$.\n    b. Compute the required five output quantities:\n        i. **$M_{\\mathrm{exit}}$ (Correct):** Calculate the target exit angle $\\nu_{\\mathrm{exit}} = \\nu_1 + \\delta$. Solve for $M_{\\mathrm{exit}}$ using the numerical root-finder.\n        ii. **$M_{\\mathrm{exit}}$ (Naive):** This is simply $M_1$.\n        iii. **Maximum Mach Discrepancy:**\n            - Create an array of $N$ ray angles $\\theta_i$ uniformly distributed from $0$ to $\\delta$.\n            - For each $\\theta_i$, calculate the target $\\nu_i = \\nu_1 + \\theta_i$.\n            - Solve for the corresponding Mach number $M_i^{\\mathrm{correct}}$.\n            - The maximum discrepancy is $\\max_{i} |M_i^{\\mathrm{correct}} - M_1|$. Since $M$ increases monotonically with $\\theta$, this will be equal to $M_{\\mathrm{exit}} - M_1$.\n        iv. **Exit Characteristic Angle $\\alpha_+$:** Calculate the exit Mach angle $\\mu_{\\mathrm{exit}} = \\arcsin(1/M_{\\mathrm{exit}})$ in degrees. Then, $\\alpha_+ = \\delta + \\mu_{\\mathrm{exit}}$.\n        v. **Exit Characteristic Angle $\\alpha_-$:** Similarly, $\\alpha_- = \\delta - \\mu_{\\mathrm{exit}}$.\n\n3.  **Output Formatting:** The results for all test cases are collected and formatted into a single string representing a nested list, with each numerical value formatted to six decimal places, as specified in the problem statement.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the Prandtl-Meyer expansion fan problem for a series of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (gamma, M1, delta, N)\n        (1.4, 2.0, 10.0, 50),\n        (1.4, 2.0, 60.0, 80),\n        (1.4, 1.05, 5.0, 30),\n        (1.6666667, 3.0, 20.0, 60),\n        (1.4, 1.5, 110.0, 90),\n    ]\n\n    def prandtl_meyer(M, gamma):\n        \"\"\"\n        Calculates the Prandtl-Meyer function nu(M, gamma) in degrees.\n        Returns 0 for M = 1.\n        \"\"\"\n        if M = 1.0:\n            return 0.0\n        \n        # Using np.float128 for gamma to handle the fraction 5/3 accurately\n        g = np.float128(gamma)\n        \n        term1_sqrt_arg = (g - 1) / (g + 1) * (M**2 - 1)\n        term1 = np.sqrt((g + 1) / (g - 1)) * np.arctan(np.sqrt(term1_sqrt_arg))\n        \n        term2_sqrt_arg = M**2 - 1\n        term2 = np.arctan(np.sqrt(term2_sqrt_arg))\n        \n        # Result is in radians, convert to degrees\n        return (term1 - term2) * 180.0 / np.pi\n\n    def mach_from_nu(nu_target_deg, gamma):\n        \"\"\"\n        Solves for Mach number M given the Prandtl-Meyer angle nu in degrees.\n        Uses Brent's method for root finding.\n        \"\"\"\n        if nu_target_deg = 0:\n            return 1.0\n        \n        # Define the objective function for the root finder\n        def root_func(M):\n            return prandtl_meyer(M, gamma) - nu_target_deg\n        \n        # Find an upper bound for M that gives nu  nu_target_deg\n        m_upper = 2.0\n        nu_max = (np.sqrt((gamma + 1) / (gamma - 1)) - 1) * 90.0\n        if nu_target_deg > nu_max:\n            # Handle the case where the target nu exceeds the theoretical maximum\n            # which happens in Case E. This is physically impossible for a simple fan.\n            # In a real scenario, this implies flow detachment or other complex phenomena.\n            # For this problem, we return an indicator of this state.\n            return np.inf\n\n        while prandtl_meyer(m_upper, gamma)  nu_target_deg:\n            m_upper *= 2.0\n        \n        # Brent's method is efficient and robust for a monotonic function.\n        # It's a valid \"equivalent monotone method\" to bisection.\n        try:\n            M_sol = brentq(root_func, 1.0, m_upper, xtol=1e-12, rtol=1e-12)\n            return M_sol\n        except ValueError:\n             raise ValueError(\"Root finding failed. Check input values.\")\n\n    def mach_angle(M):\n        \"\"\"\n        Calculates the Mach angle mu(M) in degrees.\n        \"\"\"\n        if M = 1.0:\n            return 90.0\n        if np.isinf(M):\n            return 0.0\n        return np.arcsin(1.0 / M) * 180.0 / np.pi\n\n    all_results_str = []\n    \n    for case in test_cases:\n        gamma, M1, delta, N = case\n        \n        # 1. M_exit for the correct characteristic-based boundary condition.\n        nu_1 = prandtl_meyer(M1, gamma)\n        nu_exit_target = nu_1 + delta\n        M_exit_correct = mach_from_nu(nu_exit_target, gamma)\n        \n        # 2. M_exit for the naive slip-wall treatment (equals M1).\n        M_exit_naive = M1\n        \n        # 3. Maximum absolute discrepancy in Mach number.\n        max_discrepancy = M_exit_correct - M1\n        \n        # 4. Characteristic angle alpha+ at the exit (correct solution).\n        mu_exit = mach_angle(M_exit_correct)\n        alpha_plus = delta + mu_exit\n        \n        # 5. Characteristic angle alpha- at the exit (correct solution).\n        alpha_minus = delta - mu_exit\n        \n        case_results = [\n            M_exit_correct,\n            M_exit_naive,\n            max_discrepancy,\n            alpha_plus,\n            alpha_minus\n        ]\n        \n        # Format results to six decimal places. Handle np.inf gracefully.\n        formatted_results = []\n        for val in case_results:\n            if np.isinf(val):\n                # Represent infinity with a very large number for consistent output formatting.\n                formatted_results.append(f'{9.999999e+99:.6f}')\n            else:\n                formatted_results.append(f'{val:.6f}')\n\n        case_str = f\"[{','.join(formatted_results)}]\"\n        all_results_str.append(case_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[[{','.join(all_results_str)}]]\")\n\nsolve()\n```"
        }
    ]
}