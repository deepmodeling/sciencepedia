{
    "hands_on_practices": [
        {
            "introduction": "为了真正掌握普朗特-迈耶膨胀理论，我们必须从基本守恒定律出发，推导出核心关系式。这项实践旨在通过从头开始推导面积-马赫数关系和普朗特-迈耶函数，来巩固您的基础知识。通过将准一维喷管流动与二维膨胀扇进行比较，您将更深刻地理解，不同的物理过程如何能够实现相同的出口马赫数。",
            "id": "3957820",
            "problem": "一个稳态、无粘、绝热的准一维喷管将一种量热完全气体（比热比 $\\gamma$ 为常数）从声速喉道加速到超声速出口。上游滞止状态是均匀的，且流动是等熵的。喉道发生壅塞，因此喉道处的马赫数为 $M^{*} = 1$，喉道面积为 $A^{*}$。出口与喉道的面积比指定为 $A_{e}/A^{*} = \\dfrac{27}{16}$。该气体为空气，建模为量热完全气体，其 $\\gamma = 1.4$。\n\n任务1：仅从稳态守恒律、理想气体状态方程和量热完全气体的等熵关系式出发，推导准一维等熵流的面积-马赫数关系式，并用它来确定与 $A_{e}/A^{*} = \\dfrac{27}{16}$ 对应的超声速出口马赫数 $M_{e}$。\n\n任务2：现在考虑一个由 Prandtl–Meyer (PM) 理论支配的平面简单膨胀扇，它将马赫数为 $M=1$ 的均匀上游来流转向至任务1中求得的相同超声速马赫数 $M_{e}$。从稳态、无粘、等熵、无旋的二维方程和简单波相容性出发，推导 Prandtl–Meyer 函数 $\\nu(M)$，并计算达到 $M_{e}$ 所需的壁面转角 $\\theta = \\nu(M_{e}) - \\nu(1)$。\n\n将最终答案表示为单个转角 $\\theta$（以度为单位），并四舍五入到四位有效数字。不要将任何中间值作为最终答案的一部分报告。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- **流动条件（任务1）：** 稳态、无粘、绝热、准一维、等熵。\n- **流动条件（任务2）：** 稳态、无粘、等熵、无旋、二维、简单膨胀扇。\n- **气体模型：** 量热完全气体。\n- **比热比：** $\\gamma = 1.4$。\n- **喷管几何形状：** 壅塞喉道，在面积 $A^{*}$ 处马赫数为 $M^{*} = 1$。出口与喉道的面积比为 $A_{e}/A^{*} = \\frac{27}{16}$。\n- **膨胀扇条件：** 均匀上游来流马赫数为 $M=1$。流动加速到任务1中求得的超声速马赫数 $M_e$。\n- **要求推导：**\n    1. 准一维等熵流的面积-马赫数关系式，从守恒律、理想气体状态方程和等熵关系式出发。\n    2. Prandtl–Meyer 函数 $\\nu(M)$，从二维方程和简单波相容性出发。\n- **最终输出：** 所需的壁面转角 $\\theta = \\nu(M_e) - \\nu(1)$，以度为单位，并四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学或事实上的不健全性：** 该问题基于准一维等熵流和二维 Prandtl–Meyer 膨胀波的标准且成熟的理论，这些是可压缩空气动力学的基石。没有违反科学原理之处。\n2.  **无法形式化或不相关：** 该问题是可压缩流动理论中的一个标准练习，与膨胀扇和喷管流的主题直接相关。\n3.  **不完整或矛盾的设置：** 问题提供了所有必要的信息。面积比 $A_e/A^* = \\frac{27}{16} > 1$ 允许如题目所要求的超声速解。所有参数（$\\gamma$，面积比）都已指定。\n4.  **不切实际或不可行：** 所有给定的值和物理条件都是现实的，并且在航空航天工程问题中很常见。\n5.  **不适定或结构不良：** 对于给定的面积比（$1$），面积-马赫数关系式是马赫数的双值函数，会产生一个亚声速解和一个超声速解。问题明确要求*超声速*出口马赫数，这使得解是唯一的。其结构是合乎逻辑的，将第一个任务的结果用作第二个任务的输入。\n6.  **伪深刻、琐碎或同义反复：** 所需的推导是基础且不平凡的，要求对可压缩流动理论有牢固的掌握。该问题是对理解能力的合理测试。\n7.  **超出科学可验证性范围：** 该问题及其解完全在标准、可验证的气体动力学理论范畴内。\n\n### 第3步：结论与行动\n该问题有科学依据、适定且客观。它被认为是**有效的**。将提供完整解答。\n\n### 任务1：面积-马赫数关系式的推导与 $M_e$ 的计算\n\n我们从稳态准一维流动的质量守恒开始：\n$$ \\dot{m} = \\rho u A = \\text{常数} $$\n其中 $\\rho$ 是密度，$u$ 是流速，$A$ 是横截面积。\n对于量热完全气体的等熵流，滞止性质（用下标 $0$ 表示）是恒定的。当地性质可以与滞止性质和当地马赫数 $M$ 关联如下：\n滞止温度和静温之间的关系由能量方程 $h_0 = h + \\frac{1}{2}u^2$ 推导得出，对于量热完全气体（$h=c_p T$），该方程变为 $c_p T_0 = c_p T + \\frac{1}{2}u^2$。使用 $u=Ma$ 和 $a^2=\\gamma R T = (\\gamma-1)c_p T$，我们得到：\n$$ \\frac{T_0}{T} = 1 + \\frac{\\gamma-1}{2} M^2 $$\n对于等熵过程，$p/\\rho^\\gamma = \\text{常数}$，这导致：\n$$ \\frac{p_0}{p} = \\left(\\frac{T_0}{T}\\right)^{\\frac{\\gamma}{\\gamma-1}} = \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{\\frac{\\gamma}{\\gamma-1}} $$\n$$ \\frac{\\rho_0}{\\rho} = \\left(\\frac{T_0}{T}\\right)^{\\frac{1}{\\gamma-1}} = \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{\\frac{1}{\\gamma-1}} $$\n当地速度 $u$ 可以表示为：\n$$ u = M a = M \\sqrt{\\gamma R T} = M \\sqrt{\\gamma R T_0} \\sqrt{\\frac{T}{T_0}} = M a_0 \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-1/2} $$\n将 $\\rho$ 和 $u$ 的表达式代入质量流量方程：\n$$ \\dot{m} = A \\left[ \\rho_0 \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{1}{\\gamma-1}} \\right] \\left[ M a_0 \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-1/2} \\right] $$\n合并指数得到：\n$$ \\dot{m} = A \\rho_0 a_0 M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{1}{2} \\left( \\frac{2}{\\gamma-1} + 1 \\right)} = A \\rho_0 a_0 M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} $$\n由于 $\\dot{m}$、$\\rho_0$ 和 $a_0$ 在整个喷管中是常数，我们可以写出：\n$$ \\frac{\\dot{m}}{\\rho_0 a_0} = A M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} = \\text{常数} $$\n喉道是壅塞的，意味着在最小面积 $A=A^*$ 处的马赫数为 $M=1$。将上述关系式应用于喉道：\n$$ \\frac{\\dot{m}}{\\rho_0 a_0} = A^* (1) \\left(1 + \\frac{\\gamma-1}{2} (1)^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} = A^* \\left(\\frac{\\gamma+1}{2}\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} $$\n通过将质量流组的一般表达式与其在喉道处的值相等，我们可以求出面积比 $A/A^*$：\n$$ A M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} = A^* \\left(\\frac{\\gamma+1}{2}\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} $$\n对面积比进行整理，我们得到面积-马赫数关系式：\n$$ \\frac{A}{A^*} = \\frac{1}{M} \\left[ \\frac{1 + \\frac{\\gamma-1}{2} M^2}{\\frac{\\gamma+1}{2}} \\right]^{\\frac{\\gamma+1}{2(\\gamma-1)}} $$\n这就完成了任务1的推导。\n\n现在，我们必须为 $A_e/A^* = \\frac{27}{16}$ 和 $\\gamma=1.4$ 求出超声速出口马赫数 $M_e$。\n$$ \\frac{\\gamma+1}{2(\\gamma-1)} = \\frac{1.4+1}{2(1.4-1)} = \\frac{2.4}{0.8} = 3 $$\n$$ \\frac{\\gamma-1}{2} = \\frac{1.4-1}{2} = 0.2 $$\n$$ \\frac{\\gamma+1}{2} = \\frac{1.4+1}{2} = 1.2 $$\n将这些值代入面积-马赫数关系式：\n$$ \\frac{A_e}{A^*} = \\frac{1}{M_e} \\left[ \\frac{1 + 0.2 M_e^2}{1.2} \\right]^3 = \\frac{27}{16} $$\n$$ \\frac{27}{16} = \\frac{1}{M_e} \\left[ \\frac{5}{6} (1 + 0.2 M_e^2) \\right]^3 $$\n这是一个关于 $M_e$ 的非线性代数方程。我们寻求一个超声速根（$M_e > 1$）。让我们测试一个整数值，例如 $M_e=2$：\n$$ \\frac{1}{2} \\left[ \\frac{5}{6} (1 + 0.2(2^2)) \\right]^3 = \\frac{1}{2} \\left[ \\frac{5}{6} (1 + 0.8) \\right]^3 = \\frac{1}{2} \\left[ \\frac{5}{6} (1.8) \\right]^3 = \\frac{1}{2} [1.5]^3 = \\frac{1}{2} [3.375] = 1.6875 $$\n由于 $\\frac{27}{16} = 1.6875$，超声速出口马赫数恰好是 $M_e=2$。\n\n### 任务2：Prandtl–Meyer 函数的推导与 $\\theta$ 的计算\n\n对于稳态、无粘、无旋的二维超声速流，流动性质可以跨特征线变化。一个膨胀扇由一组源于单一点的连续的 C- 特征线组成。对于穿过无穷小马赫波的流动，流动偏转角 $d\\theta$ 与速度 $u$ 的关系为：\n$$ d\\theta = \\sqrt{M^2-1} \\frac{du}{u} $$\n为了积分这个式子，我们必须用 $M$ 来表示 $du/u$。对于等熵流，能量方程 $T_0 = T(1 + \\frac{\\gamma-1}{2}M^2)$ 恒定。对其进行对数微分：\n$$ -\\frac{dT}{T} = \\frac{(\\gamma-1) M dM}{1 + \\frac{\\gamma-1}{2}M^2} $$\n此外，我们有 $u = M a = M \\sqrt{\\gamma R T}$。对其进行对数微分得到 $2 \\frac{du}{u} = 2 \\frac{dM}{M} + \\frac{dT}{T}$。代入 $dT/T$：\n$$ 2 \\frac{du}{u} = 2 \\frac{dM}{M} - \\frac{(\\gamma-1) M^2}{1 + \\frac{\\gamma-1}{2}M^2} \\frac{dM}{M} = \\left( 2 - \\frac{(\\gamma-1)M^2}{1 + \\frac{\\gamma-1}{2}M^2} \\right) \\frac{dM}{M} = \\left( \\frac{2 + (\\gamma-1)M^2 - (\\gamma-1)M^2}{1 + \\frac{\\gamma-1}{2}M^2} \\right) \\frac{dM}{M} $$\n$$ \\frac{du}{u} = \\frac{1}{1 + \\frac{\\gamma-1}{2}M^2} \\frac{dM}{M} $$\n将此式代入 $d\\theta$ 的表达式中：\n$$ d\\theta = \\frac{\\sqrt{M^2-1}}{M(1 + \\frac{\\gamma-1}{2}M^2)} dM $$\nPrandtl–Meyer 函数 $\\nu(M)$ 表示气流从 $M=1$ 转向到给定马赫数 $M$ 所经过的角度。我们通过将 $d\\theta$ 从 $M=1$ 积分到 $M$ 来得到它：\n$$ \\nu(M) = \\int_1^M \\frac{\\sqrt{M'^2-1}}{M'(1 + \\frac{\\gamma-1}{2}M'^2)} dM' $$\n为了求解该积分，我们进行变量代换。令 $y^2 = M'^2 - 1$，因此 $M'^2 = y^2+1$ 且 $M'dM' = ydy$。积分的上下限从 $M'=1, M$ 变为 $y=0, \\sqrt{M^2-1}$。被积函数可重写为：\n$$ \\frac{\\sqrt{M'^2-1}}{M'(1 + \\frac{\\gamma-1}{2}M'^2)} dM' = \\frac{y}{(y^2+1)(1+\\frac{\\gamma-1}{2}(y^2+1))} ydy = \\frac{2y^2 dy}{(y^2+1)((\\gamma-1)y^2 + \\gamma+1)} $$\n因此，积分变为：\n$$ \\nu(M) = \\int_0^{\\sqrt{M^2-1}} \\frac{2y^2 dy}{(y^2+1)((\\gamma-1)y^2 + \\gamma+1)} $$\n使用部分分式分解 $\\frac{2y^2}{(y^2+1)((\\gamma-1)y^2 + \\gamma+1)} = \\frac{C}{y^2+1} + \\frac{D}{(\\gamma-1)y^2 + \\gamma+1}$，我们求得 $C=-1$ 和 $D=\\gamma+1$。\n$$ \\nu(M) = \\int_0^{\\sqrt{M^2-1}} \\left( \\frac{\\gamma+1}{(\\gamma-1)y^2 + \\gamma+1} - \\frac{1}{y^2+1} \\right) dy $$\n$$ \\nu(M) = \\left[ \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(y\\sqrt{\\frac{\\gamma-1}{\\gamma+1}}\\right) - \\arctan(y) \\right]_0^{\\sqrt{M^2-1}} $$\n代回 $y=\\sqrt{M'^2-1}$ 并在积分上下限处求值，得到 Prandtl-Meyer 函数：\n$$ \\nu(M) = \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(\\sqrt{\\frac{\\gamma-1}{\\gamma+1}(M^2-1)}\\right) - \\arctan\\left(\\sqrt{M^2-1}\\right) $$\n这就完成了任务2的推导。\n\n所需的转角为 $\\theta = \\nu(M_e) - \\nu(1)$。由于初始马赫数为 $M=1$，我们有 $\\nu(1) = 0$。因此，$\\theta = \\nu(M_e)$。我们使用 $M_e=2$ 和 $\\gamma=1.4$。\n$$ \\frac{\\gamma+1}{\\gamma-1} = \\frac{2.4}{0.4} = 6 $$\n$$ \\theta = \\nu(2) = \\sqrt{6} \\arctan\\left(\\sqrt{\\frac{1}{6}(2^2-1)}\\right) - \\arctan\\left(\\sqrt{2^2-1}\\right) $$\n$$ \\theta = \\sqrt{6} \\arctan\\left(\\sqrt{\\frac{3}{6}}\\right) - \\arctan(\\sqrt{3}) $$\n$$ \\theta = \\sqrt{6} \\arctan\\left(\\frac{1}{\\sqrt{2}}\\right) - \\arctan(\\sqrt{3}) $$\n计算必须使用弧度。\n$$ \\arctan(\\sqrt{3}) = \\frac{\\pi}{3} $$\n$$ \\arctan\\left(\\frac{1}{\\sqrt{2}}\\right) \\approx \\arctan(0.707107) \\approx 0.615480 \\text{ rad} $$\n$$ \\sqrt{6} \\approx 2.44949 $$\n$$ \\theta \\approx (2.44949)(0.615480) - \\frac{\\pi}{3} \\approx 1.507616 - 1.047198 \\approx 0.460418 \\text{ rad} $$\n转换为度：\n$$ \\theta_{\\text{deg}} = 0.460418 \\times \\frac{180}{\\pi} \\approx 26.3795^\\circ $$\n四舍五入到四位有效数字，转角为 $26.38^\\circ$。",
            "answer": "$$\\boxed{26.38}$$"
        },
        {
            "introduction": "推导出普朗特-迈耶函数后，下一步是深入理解其内在属性和参数依赖性。本练习将引导您分析该函数与马赫数及气体性质（特别是比热比 $\\gamma$）之间的关系。这项实践有助于培养您的分析思维能力，并让您洞察膨胀转角所受到的物理限制。",
            "id": "3957868",
            "problem": "考虑一个稳定、无粘、绝热、无旋的平面（$2$维）超音速流动，气体为量热完全气体，其比热比 $\\gamma$ 为常数。在计算流体动力学（CFD）的背景下，对于一个初始马赫数 $M_11$ 的均匀上游来流，附体 Prandtl–Meyer 膨胀波的简单波描述可以从可压缩欧拉方程和等熵热力学关系中推导得出。流体绕凸角偏转一个角度 $\\theta0$ 的过程，由一个从马赫数到流动转角函数（通常表示为 Prandtl-Meyer 函数 $\\nu(M)$）的单调映射所描述，该函数的微分产生于控制双曲型系统的特征相容性。\n\n仅利用这些基础（可压缩欧拉方程、等熵关系以及超音速简单波的特征行为），确定 $\\nu(M)$ 的性质如何依赖于比热比 $\\gamma$，以及从给定的 $M_1$ 出发，最大允许附体偏转角如何依赖于 $\\gamma$。选择所有正确的陈述。\n\nA. 对于任何固定的 $\\gamma1$，函数 $\\nu(M)$ 在 $M\\ge 1$ 上是严格递增的，满足 $\\nu(1)=0$，并且有一个有限的极限 $\\nu(\\infty)$，由 $\\nu(\\infty)=\\dfrac{\\pi}{2}\\!\\left(\\sqrt{\\dfrac{\\gamma+1}{\\gamma-1}}-1\\right)$ 给出。因此，从 $M_1$ 开始的最大附体偏转角为 $\\theta_{\\max}=\\nu(\\infty)-\\nu(M_1)$，该值随着 $\\gamma$ 的增加而减小。\n\nB. 对于任何固定的 $\\gamma1$，函数 $\\nu(M)$ 随着 $M$ 的增加而减小，并且 $\\nu(\\infty)=0$。因此，最大附体偏转角随着 $\\gamma$ 的增加而增加。\n\nC. Prandtl–Meyer 函数 $\\nu(M)$ 与 $\\gamma$ 无关，因此从 $M_1$ 开始的最大偏转角仅依赖于 $M_1$。\n\nD. 对于单原子气体，其 $\\gamma=\\dfrac{5}{3}$，我们有 $\\nu(\\infty)=\\dfrac{\\pi}{2}$；而对于双原子气体，其 $\\gamma=1.4$，我们有 $\\nu(\\infty)\\approx 2.277\\,\\text{rad}$。因此，对于相同的上游马赫数 $M_11$，当 $\\gamma=1.4$ 时的最大附体偏转角比 $\\gamma=\\dfrac{5}{3}$ 时更大。\n\nE. 在极限 $\\gamma\\to 1^{+}$ 时，量 $\\nu(\\infty)\\to\\infty$；而在极限 $\\gamma\\to\\infty$ 时，我们有 $\\nu(\\infty)\\to 0$。因此，从给定的 $M_1$ 开始的最大附体偏转角在 $\\gamma\\to 1^{+}$ 时变得任意大，而在 $\\gamma\\to\\infty$ 时趋于零。",
            "solution": "用户要求我根据严格的协议验证问题陈述，如果有效，则基于第一性原理提供详细的解决方案，并评估所有给定的选项。\n\n### 问题验证\n\n**第一步：提取已知条件**\n问题陈述提供了以下信息：\n- 流动背景：稳定、无粘、绝热、无旋、平面（$2$维）超音速流动。\n- 气体性质：量热完全气体，比热比 $\\gamma$ 为常数。\n- 初始条件：均匀上游状态，马赫数 $M_1  1$。\n- 几何形状：流体绕凸角偏转一个角度 $\\theta  0$。\n- 理论模型：Prandtl-Meyer 膨胀波，被描述为可压缩欧拉方程和等熵热力学关系的简单波解。\n- 函数关系：存在一个从马赫数 $M$ 到流动转角函数 $\\nu(M)$ 的单调映射，其微分来自特征相容性。\n- 问题：确定 $\\nu(M)$ 的性质如何依赖于 $\\gamma$，以及从给定的 $M_1$ 出发，最大允许附体偏转角如何依赖于 $\\gamma$。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于超音速气体动力学中经典且完善的 Prandtl-Meyer 膨胀理论。该理论是理想气体欧拉方程的直接推论，也是航空航天工程的基石之一。前提具有科学合理性。\n- **良定的**：该问题是良定的。它要求确定一个函数 $\\nu(M, \\gamma)$ 的性质和参数依赖性，该函数可以从给定的物理和数学框架中唯一地推导出来。\n- **客观的**：该问题使用了流体动力学中的精确、标准术语（例如，“无粘”、“绝热”、“量热完全气体”）。语言是客观的，没有歧义或主观论断。\n- **检查缺陷**：\n  1. **科学/事实不健全**：无。\n  2. **不可形式化/不相关**：该问题可直接形式化，并且是膨胀扇主题的核心。\n  3. **不完整/矛盾的设置**：设置是完整的，提供了推导 Prandtl-Meyer 函数所需的所有假设（稳定、无粘、等熵等）。\n  4. **不切实际/不可行**：该模型是一种理想化，但在物理上是现实的，并广泛用于超音速流的分析。\n  5. **不适定/结构不良**：该问题结构良好，可得出唯一解。\n  6. **伪深刻/琐碎**：推导需要可压缩流和微积分的实质性知识，使其不琐碎。\n  7. **超出科学可验证性**：该理论在数学上是可推导的，并且在实验上是可验证的。\n\n**第三步：结论与行动**\n问题陈述是**有效的**。其设置是自洽的、有科学依据的、并且是良定的。我现在将继续推导解决方案。\n\n### 推导与求解\n\n该问题描述了超音速流中的一个简单膨胀波（Prandtl-Meyer 扇）。在此类波中，流动性质沿着一族特征线（马赫波）发生变化，而在另一族特征线上保持不变。流动角度的无穷小变化 $d\\theta$ 与流速变化 $V$ 之间的关系由垂直于局部马赫线的速度变化几何形状决定。马赫线相对于局部流动方向的角度是马赫角，$\\mu = \\arcsin(1/M)$。性质发生变化的特征线上的相容关系为：\n$$d\\theta = \\sqrt{M^2-1} \\frac{dV}{V}$$\n这里，$d\\theta$ 表示流动的增量转角。按照惯例，Prandtl-Meyer 函数 $\\nu(M)$ 定义为从转角为零的参考状态开始的该转角的积分。该参考状态选择为 $M=1$，此时 $\\sqrt{M^2-1}=0$。因此，转角为 $\\theta = \\nu(M_2) - \\nu(M_1)$。\n\n为了仅用马赫数 $M$ 来表示 $d\\nu \\equiv d\\theta$，我们必须将 $dV/V$ 与 $dM/M$ 联系起来。对于等熵流，滞止温度 $T_0$ 是恒定的：\n$$T_0 = T \\left(1 + \\frac{\\gamma-1}{2} M^2\\right) = \\text{constant}$$\n局部声速为 $a = \\sqrt{\\gamma R T}$。流速为 $V = M a$。代入 $T$：\n$$V^2 = M^2 a^2 = M^2 \\gamma R T = M^2 \\gamma R \\frac{T_0}{1 + \\frac{\\gamma-1}{2} M^2}$$\n由于 $\\gamma$、$R$ 和 $T_0$ 是常数，我们可以写成 $V^2 = C \\frac{M^2}{1 + \\frac{\\gamma-1}{2} M^2}$，其中 $C = \\gamma R T_0$。取自然对数并对 $M$ 微分：\n$$2 \\ln V = \\ln C + 2 \\ln M - \\ln\\left(1 + \\frac{\\gamma-1}{2} M^2\\right)$$\n$$\\frac{2}{V} \\frac{dV}{dM} = \\frac{2}{M} - \\frac{(\\gamma-1) M}{1 + \\frac{\\gamma-1}{2} M^2}$$\n$$\\frac{dV}{V} = \\left(\\frac{1}{M} - \\frac{\\frac{\\gamma-1}{2} M}{1 + \\frac{\\gamma-1}{2} M^2}\\right) dM = \\frac{(1 + \\frac{\\gamma-1}{2} M^2) - \\frac{\\gamma-1}{2} M^2}{M(1 + \\frac{\\gamma-1}{2} M^2)} dM$$\n$$\\frac{dV}{V} = \\frac{1}{M(1 + \\frac{\\gamma-1}{2} M^2)} dM$$\n将此代入 $d\\nu$ 的表达式中：\n$$d\\nu = \\frac{\\sqrt{M^2-1}}{M(1 + \\frac{\\gamma-1}{2} M^2)} dM$$\nPrandtl-Meyer 函数 $\\nu(M)$ 通过将此表达式从 $M=1$（其中定义 $\\nu(1)=0$）积分到任意 $M \\ge 1$ 来得到：\n$$\\nu(M) = \\int_1^M \\frac{\\sqrt{\\xi^2-1}}{\\xi\\left(1 + \\frac{\\gamma-1}{2} \\xi^2\\right)} d\\xi$$\n该积分可以解析求解。结果是：\n$$\\nu(M) = \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(\\sqrt{\\frac{\\gamma-1}{\\gamma+1}(M^2-1)}\\right) - \\arctan\\left(\\sqrt{M^2-1}\\right)$$\n\n**$\\nu(M)$ 和 $\\theta_{\\max}$ 的性质**\n\n1.  **单调性和初始值**：对于 $M1$，被积函数 $d\\nu/dM$ 严格为正。因此，$\\nu(M)$ 是 $M$ 的严格递增函数（对于 $M1$）。在 $M=1$ 时，被积函数为零，根据定义，$\\nu(1)=0$。\n\n2.  **最大值 $\\nu(\\infty)$**：我们可以通过取 $M \\to \\infty$ 的极限来找到函数的最大可能值。在此极限下，两个反正切函数的自变量都趋于无穷大。由于 $\\lim_{x\\to\\infty} \\arctan(x) = \\pi/2$，我们有：\n$$\\nu(\\infty) = \\lim_{M\\to\\infty} \\nu(M) = \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\left(\\frac{\\pi}{2}\\right) - \\frac{\\pi}{2} = \\frac{\\pi}{2}\\left(\\sqrt{\\frac{\\gamma+1}{\\gamma-1}} - 1\\right)$$\n对于任何 $\\gamma1$，这是一个有限的正值。\n\n3.  **最大附体偏转角 $\\theta_{\\max}$**：从初始马赫数 $M_1$ 膨胀的最大偏转角 $\\theta_{\\max}$ 发生在流体膨胀到最大可能马赫数 $M_2 \\to \\infty$（膨胀到真空）时。\n$$\\theta_{\\max} = \\nu(\\infty) - \\nu(M_1)$$\n\n4.  **对 $\\gamma$ 的依赖性**：\n    让我们分析 $\\nu(\\infty)$ 对 $\\gamma$ 的依赖性。项 $g(\\gamma) = \\sqrt{(\\gamma+1)/(\\gamma-1)}$ 是 $\\gamma$ 的严格递减函数（对于 $\\gamma1$），因为它的导数是 $g'(\\gamma) = -\\sqrt{(\\gamma-1)/(\\gamma+1)} / (\\gamma-1)^2  0$。因此，$\\nu(\\infty)$ 是 $\\gamma$ 的严格递减函数。\n    更详细的分析表明，对于任何固定的 $M  1$，$\\nu(M, \\gamma)$ 也是 $\\gamma$ 的严格递减函数。$\\theta_{\\max} = \\nu(\\infty, \\gamma) - \\nu(M_1, \\gamma)$ 关于 $\\gamma$ 的导数可以被证明是负的。因此，对于给定的初始马赫数 $M_1$，最大附体偏转角 $\\theta_{\\max}$ 随着 $\\gamma$ 的增加而减小。\n\n### 逐项分析\n\n**A. 对于任何固定的 $\\gamma1$，函数 $\\nu(M)$ 在 $M\\ge 1$ 上是严格递增的，满足 $\\nu(1)=0$，并且有一个有限的极限 $\\nu(\\infty)$，由 $\\nu(\\infty)=\\dfrac{\\pi}{2}\\!\\left(\\sqrt{\\dfrac{\\gamma+1}{\\gamma-1}}-1\\right)$ 给出。因此，从 $M_1$ 开始的最大附体偏转角为 $\\theta_{\\max}=\\nu(\\infty)-\\nu(M_1)$，该值随着 $\\gamma$ 的增加而减小。**\n- $\\nu(M)$ 对于 $M1$ 是严格递增的，且 $\\nu'(1)=0$；“在 $M \\ge 1$ 上严格递增”的说法是一种常见的、略有不精确但可接受的描述。**正确**。\n- $\\nu(1)=0$。**正确**。\n- $\\nu(\\infty)$ 的公式与推导完全一致。**正确**。\n- $\\theta_{\\max}$ 的定义是正确的。**正确**。\n- $\\theta_{\\max}$ 随着 $\\gamma$ 增加而减小的结论是正确的，如一般性分析所示。**正确**。\n由于此陈述的每个部分都是正确的，因此整个陈述是正确的。\n**结论：正确**\n\n**B. 对于任何固定的 $\\gamma1$，函数 $\\nu(M)$ 随着 $M$ 的增加而减小，并且 $\\nu(\\infty)=0$。因此，最大附体偏转角随着 $\\gamma$ 的增加而增加。**\n- `$\\nu(M)$ 随着 $M$ 的增加而减小`：这是错误的。我们证明了它是一个递增函数。\n- `$\\nu(\\infty)=0$`：这是错误的。我们推导出了一个有限的、非零的值。\n- `最大附体偏转角随着 $\\gamma$ 的增加而增加`：这是错误的。它减小。\n该陈述在所有方面都是错误的。\n**结论：不正确**\n\n**C. Prandtl–Meyer 函数 $\\nu(M)$ 与 $\\gamma$ 无关，因此从 $M_1$ 开始的最大偏转角仅依赖于 $M_1$。**\n- `$\\nu(M)$ 与 $\\gamma$ 无关`：这是错误的。推导出的 $\\nu(M)$ 公式明确包含 $\\gamma$。\n因此结论也是错误的。\n**结论：不正确**\n\n**D. 对于单原子气体，其 $\\gamma=\\dfrac{5}{3}$，我们有 $\\nu(\\infty)=\\dfrac{\\pi}{2}$；而对于双原子气体，其 $\\gamma=1.4$，我们有 $\\nu(\\infty)\\approx 2.277\\,\\text{rad}$。因此，对于相同的上游马赫数 $M_11$，当 $\\gamma=1.4$ 时的最大附体偏转角比 $\\gamma=\\dfrac{5}{3}$ 时更大。**\n- 对于 $\\gamma = 5/3$：\n  $\\nu(\\infty) = \\dfrac{\\pi}{2}\\left(\\sqrt{\\dfrac{5/3+1}{5/3-1}} - 1\\right) = \\dfrac{\\pi}{2}\\left(\\sqrt{\\dfrac{8/3}{2/3}} - 1\\right) = \\dfrac{\\pi}{2}\\left(\\sqrt{4} - 1\\right) = \\dfrac{\\pi}{2}$。这是正确的。\n- 对于 $\\gamma = 1.4$：\n  $\\nu(\\infty) = \\dfrac{\\pi}{2}\\left(\\sqrt{\\dfrac{1.4+1}{1.4-1}} - 1\\right) = \\dfrac{\\pi}{2}\\left(\\sqrt{\\dfrac{2.4}{0.4}} - 1\\right) = \\dfrac{\\pi}{2}\\left(\\sqrt{6} - 1\\right)$。\n  使用 $\\pi \\approx 3.14159$ 和 $\\sqrt{6} \\approx 2.44949$，我们得到 $\\nu(\\infty) \\approx \\dfrac{3.14159}{2}(2.44949 - 1) \\approx 1.5708 \\times 1.44949 \\approx 2.2769$ rad。数值 $2.277\\,\\text{rad}$ 是正确的。\n- `因此，... 当 $\\gamma=1.4$ 时的最大附体偏转角比 $\\gamma=\\dfrac{5}{3}$ 时更大`：我们已经确定 $\\theta_{\\max}$ 随着 $\\gamma$ 的增加而减小。由于 $1.4  5/3 \\approx 1.667$，因此 $\\theta_{\\max}(\\gamma=1.4) > \\theta_{\\max}(\\gamma=5/3)$。该结论在逻辑上是合理的，并且与我们的推导一致。\n整个陈述是正确的。\n**结论：正确**\n\n**E. 在极限 $\\gamma\\to 1^{+}$ 时，量 $\\nu(\\infty)\\to\\infty$；而在极限 $\\gamma\\to\\infty$ 时，我们有 $\\nu(\\infty)\\to 0$。因此，从给定的 $M_1$ 开始的最大附体偏转角在 $\\gamma\\to 1^{+}$ 时变得任意大，而在 $\\gamma\\to\\infty$ 时趋于零。**\n- 极限 $\\gamma\\to 1^{+}$：\n  $\\lim_{\\gamma\\to 1^{+}} \\nu(\\infty) = \\lim_{\\gamma\\to 1^{+}} \\dfrac{\\pi}{2}\\left(\\sqrt{\\dfrac{\\gamma+1}{\\gamma-1}} - 1\\right)$。项 $\\dfrac{\\gamma+1}{\\gamma-1} \\to \\dfrac{2}{0^+} \\to +\\infty$。因此，$\\nu(\\infty) \\to \\infty$。这是正确的。\n- 极限 $\\gamma\\to \\infty$：\n  $\\lim_{\\gamma\\to\\infty} \\nu(\\infty) = \\lim_{\\gamma\\to\\infty} \\dfrac{\\pi}{2}\\left(\\sqrt{\\dfrac{1+1/\\gamma}{1-1/\\gamma}} - 1\\right) = \\dfrac{\\pi}{2}(\\sqrt{1}-1) = 0$。这是正确的。\n- 对 $\\theta_{\\max}$ 的结论：我们必须在这些极限下检查 $\\nu(M_1)$。\n  当 $\\gamma\\to 1^{+}$ 时，更仔细的分析表明 $\\lim_{\\gamma\\to 1^{+}} \\nu(M_1,\\gamma) = \\sqrt{M_1^2-1} - \\arctan(\\sqrt{M_1^2-1})$，这是一个有限值。因此，$\\theta_{\\max} = \\nu(\\infty) - \\nu(M_1) \\to \\infty - (\\text{有限值}) \\to \\infty$。这是正确的。\n  当 $\\gamma\\to \\infty$ 时，可以证明 $\\lim_{\\gamma\\to\\infty} \\nu(M_1, \\gamma) = 0$。因此，$\\theta_{\\max} = \\nu(\\infty) - \\nu(M_1) \\to 0 - 0 = 0$。这是正确的。\n整个陈述是正确的。\n**结论：正确**",
            "answer": "$$\\boxed{ADE}$$"
        },
        {
            "introduction": "现代航空航天工程高度依赖计算工具，将理论转化为可执行的算法是工程师的核心技能之一。这项最终实践要求您编写一个程序来模拟普朗特-迈耶膨胀扇，从而将理论与应用联系起来。通过分步实现该理论的算法，您不仅能巩固所学知识，还能亲身体验基于特征线的边界条件在实际计算中是如何应用的。",
            "id": "3957858",
            "problem": "考虑一个二维、定常、无粘、可压缩的量热完全气体流动，其特征是具有恒定的比热比，记为 $\\gamma$。一股均匀的超音速流接近一个与 $x$ 轴对齐的直线滑移壁面，并遇到一个尖锐的凸角，该凸角使壁面偏转一个恒定的角度 $\\delta$（从上游壁面方向测量的正向转角）。上游状态是均匀的，相对于来流壁面，马赫数为 $M_1$，流动角为 $\\theta_1 = 0$。您必须在滑移壁面处实现一个基于特征线的边界条件，该边界条件能与定常二维欧拉方程的相容性关系一致地施加凸角转折。\n\n使用的基本原理：\n- 流动是无粘、可压缩的量热完全气体；压力 $p$、密度 $\\rho$ 和速度矢量 $\\mathbf{u}$ 满足定常欧拉方程。\n- 对于超音速流，这些方程存在特征线族，其承载的相容性关系涉及局部流动角 $\\theta$ 和一个与中心膨胀相关的马赫数 $M$ 的单调函数。\n- 滑移壁面边界条件强制壁面处的法向速度为零，且流动必须与壁面相切，因此局部流动角等于局部壁面角。\n\n任务：\n1. 从量热完全气体的定常二维欧拉方程的特征线形式出发，推导连接局部流动转角 $\\theta$ 与局部马赫数 $M$ 变化的中心膨胀关系，该关系通过一个关于超音速状态下 $M$ 的单调递增函数实现。使用这些关系来定义凸角处的壁面边界条件，以正确施加切向流动和凸角转折。\n2. 实现一个程序，使用一组离散的射线来构建由凸角产生的自相似中心膨胀扇。对于给定的射线数量 $N$，将壁面转角从 $\\theta = 0$ 到 $\\theta = \\delta$（其中 $\\theta$ 以度为单位）进行均匀划分。令 $\\nu(M;\\gamma)$ 表示出现在中心膨胀关系中的关于 $M$ 的单调函数。对于每个射线角 $\\theta_i$，通过求解由正确的基于特征线的滑移壁面边界条件所蕴含的中心膨胀条件，计算局部马赫数 $M_i$。\n3. 为说明正确的基于特征线的边界条件对计算出的膨胀扇结构的影响，将正确的中心膨胀结果与一种简化的滑移壁面处理方法进行比较，该简化方法仅施加切向条件但未应用特征线相容性（即，对所有射线保持 $\\theta = 0$，导致处处 $M = M_1$）。对每种情况，量化以下指标：\n   - 在正确边界条件下，转角结束处的出口马赫数 $M_{\\mathrm{exit}}$。\n   - 在简化的滑移壁面处理方法下，出口马赫数（其值等于 $M_1$）。\n   - 在正确处理方法和简化处理方法之间，整个射线集上的马赫数最大绝对偏差，$\\max_i |M_i^{\\mathrm{correct}} - M_1|$。\n   - 对于正确解，在膨胀扇出口处的特征线角度：$\\alpha_+ = \\theta_{\\mathrm{exit}} + \\mu(M_{\\mathrm{exit}})$ 和 $\\alpha_- = \\theta_{\\mathrm{exit}} - \\mu(M_{\\mathrm{exit}})$，其中 $\\mu(M)$ 是马赫角，定义为 $\\mu(M) = \\arcsin(1/M)$。\n\n角度单位：\n- 所有角度（壁面转角 $\\delta$、射线角 $\\theta_i$、Prandtl–Meyer 函数 $\\nu(M;\\gamma)$ 和马赫角 $\\mu(M)$）都必须以度为单位进行处理和报告。\n\n数值要求：\n- 函数 $\\nu(M;\\gamma)$ 在 $M \\geq 1$ 时是严格递增的，且 $\\nu(1;\\gamma) = 0$。对于任何给定的 $\\delta  0$，出口马赫数 $M_{\\mathrm{exit}}$ 满足 $\\nu(M_{\\mathrm{exit}};\\gamma) = \\nu(M_1;\\gamma) + \\delta$。您的实现必须为 $M_{\\mathrm{exit}}$ 以及每个射线角 $\\theta_i$ 数值求解此方程。\n- 使用稳健的区间套根和二分法（或等效的单调方法）从 $\\nu$ 的目标值求解马赫数。不要假定存在闭式反函数。\n\n测试套件：\n实现您的程序以评估以下五组参数。对于每组参数，使用给定的射线数量 $N$：\n- 情况 A: $\\gamma = 1.4$, $M_1 = 2.0$, $\\delta = 10.0$ 度, $N = 50$。\n- 情况 B: $\\gamma = 1.4$, $M_1 = 2.0$, $\\delta = 60.0$ 度, $N = 80$。\n- 情况 C: $\\gamma = 1.4$, $M_1 = 1.05$, $\\delta = 5.0$ 度, $N = 30$。\n- 情况 D: $\\gamma = 1.6666667$, $M_1 = 3.0$, $\\delta = 20.0$ 度, $N = 60$。\n- 情况 E: $\\gamma = 1.4$, $M_1 = 1.5$, $\\delta = 110.0$ 度, $N = 90$。\n\n输出规范：\n- 对于每种情况，按顺序计算并收集以下五个量：\n  1. 正确的基于特征线的边界条件下的 $M_{\\mathrm{exit}}$。\n  2. 简化的滑移壁面处理方法下的 $M_{\\mathrm{exit}}$（其值等于 $M_1$）。\n  3. 在 $N$ 条射线上 $\\max_i |M_i^{\\mathrm{correct}} - M_1|$ 的值。\n  4. 正确解在出口处的 $\\alpha_+$，以度为单位。\n  5. 正确解在出口处的 $\\alpha_-$，以度为单位。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一种情况，其本身也是一个用方括号括起来的逗号分隔列表，包含按指定顺序排列的五个量。例如：“[[a_1,a_2,a_3,a_4,a_5],[b_1,b_2,b_3,b_4,b_5],...]”，其中每个 $a_i$、$b_i$ 等是格式化为六位小数的浮点数。",
            "solution": "用户的请求是解决一个关于超音速流绕过凸角的流体动力学问题，该过程会产生一个 Prandtl–Meyer 膨胀扇。该问题具有科学依据，提法明确，并提供了所有必要的参数和条件。因此，该问题是有效的。\n\n### 1. 理论基础：Prandtl–Meyer 膨胀\n\n该问题描述了一个二维、定常、无粘、可压缩的流动。此类流动由欧拉方程控制。对于超音速流（$M > 1$），这些方程是双曲型的，可以使用特征线法进行分析。特征线代表信息传播的路径。对于这类流动，存在两个特征线族，分别表示为 $C_+$ 和 $C_-$。沿着这些特征线，被称为黎曼不变量的某些量保持不变。\n\n对于量热完全气体的二维等熵流，黎曼不变量由下式给出：\n$$\nJ_+ = \\theta + \\nu(M; \\gamma)\n$$\n$$\nJ_- = \\theta - \\nu(M; \\gamma)\n$$\n其中 $\\theta$ 是局部流动偏转角，$M$ 是局部马赫数，$\\gamma$ 是比热比，$\\nu(M; \\gamma)$ 是 Prandtl–Meyer 函数。\n\n在尖锐凸角处形成的中心膨胀扇是一种“简单波”。在简单波中，一个特征线族由直线组成，相应的黎曼不变量在受波影响的整个流场中保持不变。对于使流动偏离自身的凸角（一个右行波系），$C_-$ 特征线是源于该角的直线，并且黎曼不变量 $J_-$ 在各处都恒定。\n\n上游流动是均匀的，马赫数为 $M_1$，流动角为 $\\theta_1 = 0$。我们可以在此区域计算 $J_-$ 的恒定值：\n$$\nJ_- = \\theta_1 - \\nu(M_1; \\gamma) = 0 - \\nu(M_1; \\gamma) = -\\nu(M_1; \\gamma)\n$$\n由于 $J_-$ 在整个膨胀扇及下游区域内都是恒定的，因此对于扇内的任意点 $(\\theta, M)$，以下关系成立：\n$$\n\\theta - \\nu(M; \\gamma) = -\\nu(M_1; \\gamma)\n$$\n重新整理可得 Prandtl–Meyer 膨胀的基本方程：\n$$\n\\nu(M; \\gamma) = \\nu(M_1; \\gamma) + \\theta\n$$\n该方程建立了局部流动转角 $\\theta$ 与由此产生的局部马赫数 $M$ 之间的直接关系。随着流动转向（即 $\\theta$ 从 $0$ 增加到最终壁面角 $\\delta$），马赫数 $M$ 也必须增加。\n\n### 2. 控制函数与边界条件\n\n**Prandtl–Meyer 函数：**\nPrandtl–Meyer 函数 $\\nu(M; \\gamma)$ 是通过沿一条特征线积分相容性关系推导出来的。其标准形式为：\n$$\n\\nu(M; \\gamma) = \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(\\sqrt{\\frac{\\gamma-1}{\\gamma+1}(M^2-1)}\\right) - \\arctan(\\sqrt{M^2-1})\n$$\n此函数给出了一个声速流（$M=1$，此时 $\\nu(1;\\gamma)=0$）必须转过的角度（以弧度为单位）才能达到超音速马赫数 $M$。根据规定，所有角度计算都将以度为单位进行。\n\n**马赫角：**\n马赫角 $\\mu$ 是马赫波与局部流动方向之间的夹角。其定义为：\n$$\n\\mu(M) = \\arcsin\\left(\\frac{1}{M}\\right)\n$$\n$C_+$ 和 $C_-$ 特征线分别与固定参考轴形成 $\\theta + \\mu(M)$ 和 $\\theta - \\mu(M)$ 的角度。\n\n**正确的基于特征线的滑移壁面边界条件：**\n在不可穿透壁面（滑移壁面）上的物理边界条件是流动必须与壁面相切。这意味着局部流动角 $\\theta$ 必须等于局部壁面角。\n- 在转角开始处，壁面角为 $0$，因此 $\\theta = 0$。\n- 对于对应于部分转角 $\\theta_i$ 的任何中间射线，壁面处的流动必须已转过 $\\theta_i$。\n- 在转角末端，壁面偏转了 $\\delta$，因此出口流动角为 $\\theta_{\\mathrm{exit}} = \\delta$。\n\n应用基本膨胀关系，转角结束处的马赫数 $M_{\\mathrm{exit}}$ 可通过求解以下方程得到：\n$$\n\\nu(M_{\\mathrm{exit}}; \\gamma) = \\nu(M_1; \\gamma) + \\delta\n$$\n\n**简化的滑移壁面处理方法：**\n为了进行比较，问题定义了一种“简化”处理方法。这种处理方法错误地假设流动不发生转折（$\\theta=0$），因此不发生膨胀，导致各处马赫数恒为 $M = M_1$。这违反了偏转壁面上的切向条件，并作为一个基准，用以突显正确的基于特征线的边界条件的重要性。\n\n### 3. 数值求解算法\n\n该问题要求通过数值实现来计算给定测试用例集的流动属性。\n\n1.  **反 Prandtl–Meyer 函数：** 必须求解方程 $\\nu(M; \\gamma) = C$ 以得到 $M$。由于 $\\nu(M; \\gamma)$ 在 $M \\ge 1$ 时是严格单调函数，因此可以使用数值求根算法可靠地完成此任务。像二分法或 Brent 方法这样的区间法是合适的。我们定义一个目标函数 $f(M) = \\nu(M; \\gamma) - C$，并在一个区间 $[1, M_{\\mathrm{upper}}]$ 内找到使 $f(M)=0$ 的根 $M$，其中 $M_{\\mathrm{upper}}$ 是一个足够大的马赫数（例如 $100$）。\n\n2.  **处理每个测试用例：** 对于每组参数 $(\\gamma, M_1, \\delta, N)$：\n    a. 计算初始 Prandtl–Meyer 角 $\\nu_1 = \\nu(M_1; \\gamma)$。\n    b. 计算所需的五个输出量：\n        i. **$M_{\\mathrm{exit}}$ (正确解):** 计算目标出口角 $\\nu_{\\mathrm{exit}} = \\nu_1 + \\delta$。使用数值求根器求解 $M_{\\mathrm{exit}}$。\n        ii. **$M_{\\mathrm{exit}}$ (简化解):** 其值就是 $M_1$。\n        iii. **最大马赫数偏差：** 创建一个包含 $N$ 个射线角的数组 $\\theta_i$，这些角度在 $0$ 到 $\\delta$ 之间均匀分布。对于每个 $\\theta_i$，计算目标 $\\nu_i = \\nu_1 + \\theta_i$。求解相应的马赫数 $M_i^{\\mathrm{correct}}$。最大偏差为 $\\max_{i} |M_i^{\\mathrm{correct}} - M_1|$。由于 $M$ 随 $\\theta$ 单调增加，该值将等于 $M_{\\mathrm{exit}} - M_1$。\n        iv. **出口特征线角 $\\alpha_+$:** 以度为单位计算出口马赫角 $\\mu_{\\mathrm{exit}} = \\arcsin(1/M_{\\mathrm{exit}})$。然后，$\\alpha_+ = \\delta + \\mu_{\\mathrm{exit}}$。\n        v. **出口特征线角 $\\alpha_-$:** 类似地，$\\alpha_- = \\delta - \\mu_{\\mathrm{exit}}$。\n\n3.  **输出格式化：** 将所有测试用例的结果收集并格式化为表示嵌套列表的单个字符串，其中每个数值都按照问题陈述中的规定格式化为六位小数。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the Prandtl-Meyer expansion fan problem for a series of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (gamma, M1, delta, N)\n        (1.4, 2.0, 10.0, 50),\n        (1.4, 2.0, 60.0, 80),\n        (1.4, 1.05, 5.0, 30),\n        (1.6666667, 3.0, 20.0, 60),\n        (1.4, 1.5, 110.0, 90),\n    ]\n\n    def prandtl_meyer(M, gamma):\n        \"\"\"\n        Calculates the Prandtl-Meyer function nu(M, gamma) in degrees.\n        Returns 0 for M = 1.\n        \"\"\"\n        if M == 1.0:\n            return 0.0\n        \n        # Using np.float128 for gamma to handle the fraction 5/3 accurately\n        g = np.float128(gamma)\n        \n        term1_sqrt_arg = (g - 1) / (g + 1) * (M**2 - 1)\n        term1 = np.sqrt((g + 1) / (g - 1)) * np.arctan(np.sqrt(term1_sqrt_arg))\n        \n        term2_sqrt_arg = M**2 - 1\n        term2 = np.arctan(np.sqrt(term2_sqrt_arg))\n        \n        # Result is in radians, convert to degrees\n        return (term1 - term2) * 180.0 / np.pi\n\n    def mach_from_nu(nu_target_deg, gamma):\n        \"\"\"\n        Solves for Mach number M given the Prandtl-Meyer angle nu in degrees.\n        Uses Brent's method for root finding.\n        \"\"\"\n        if nu_target_deg == 0.0:\n            return 1.0\n        \n        # Define the objective function for the root finder\n        def root_func(M):\n            return prandtl_meyer(M, gamma) - nu_target_deg\n        \n        # Find an upper bound for M that gives nu > nu_target_deg\n        m_upper = 2.0\n        while prandtl_meyer(m_upper, gamma)  nu_target_deg:\n            # Check against theoretical max nu to avoid infinite loop\n            nu_max = (np.sqrt((gamma + 1) / (gamma - 1)) - 1) * 90.0\n            if nu_target_deg > nu_max:\n                raise ValueError(f\"Target nu {nu_target_deg} exceeds max possible nu {nu_max} for gamma={gamma}\")\n            m_upper *= 2.0\n        \n        # Brent's method is efficient and robust for a monotonic function.\n        # It's a valid \"equivalent monotone method\" to bisection.\n        try:\n            M_sol = brentq(root_func, 1.0, m_upper, xtol=1e-12, rtol=1e-12)\n            return M_sol\n        except ValueError:\n            # This can happen if root_func(1.0) and root_func(m_upper) have the same sign,\n            # which indicates an issue with the bracketing or target value.\n            # E.g., nu_target_deg > nu_max.\n             raise ValueError(\"Root finding failed. Check input values.\")\n\n    def mach_angle(M):\n        \"\"\"\n        Calculates the Mach angle mu(M) in degrees.\n        \"\"\"\n        if M = 1.0:\n            return 90.0 # By convention or as a limit\n        return np.arcsin(1.0 / M) * 180.0 / np.pi\n\n    all_results_str = []\n    \n    for case in test_cases:\n        gamma, M1, delta, N = case\n        \n        # 1. M_exit for the correct characteristic-based boundary condition.\n        nu_1 = prandtl_meyer(M1, gamma)\n        nu_exit_target = nu_1 + delta\n        try:\n            M_exit_correct = mach_from_nu(nu_exit_target, gamma)\n            \n            # 2. M_exit for the naive slip-wall treatment (equals M1).\n            M_exit_naive = M1\n            \n            # 3. Maximum absolute discrepancy in Mach number.\n            # This occurs at the maximum turning angle, delta.\n            # So, the max discrepancy is |M_exit_correct - M1|.\n            # Since expansion occurs, M_exit_correct > M1.\n            max_discrepancy = M_exit_correct - M1\n            \n            # 4. Characteristic angle alpha+ at the exit (correct solution).\n            mu_exit = mach_angle(M_exit_correct)\n            alpha_plus = delta + mu_exit\n            \n            # 5. Characteristic angle alpha- at the exit (correct solution).\n            alpha_minus = delta - mu_exit\n\n            case_results = [\n                M_exit_correct,\n                M_exit_naive,\n                max_discrepancy,\n                alpha_plus,\n                alpha_minus\n            ]\n\n        except ValueError: # Handle cases where expansion to vacuum occurs\n            nu_max = (np.sqrt((gamma + 1) / (gamma - 1)) - 1) * 90.0\n            # For this problem, we treat it as an error, but in a real sim, it's vacuum\n            case_results = [float('inf'), M1, float('inf'), float('nan'), float('nan')]\n\n\n        case_str = f\"[{','.join(f'{val:.6f}' for val in case_results)}]\"\n        all_results_str.append(case_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```"
        }
    ]
}