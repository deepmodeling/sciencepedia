{
    "hands_on_practices": [
        {
            "introduction": "To truly appreciate the distinction between calorically and thermally perfect gas models, we must first understand the physical mechanism driving the temperature dependence of specific heat. This practice delves into the statistical mechanics origin of this phenomenon, focusing on how quantum-mechanical vibrational modes of molecules become excited at high temperatures. By deriving the vibrational contribution to the specific heat, $C_p(T)$, from first principles, you will develop a quantitative criterion for when the simpler calorically perfect gas model ceases to be accurate, justifying the need for the more complex thermally perfect model in high-enthalpy flows .",
            "id": "3946399",
            "problem": "Aerospace Computational Fluid Dynamics (CFD) models often adopt the calorically perfect gas approximation, in which the constant-pressure specific heat $C_p$ is taken to be independent of temperature and fixed by a subset of thermally active degrees of freedom. In contrast, the thermally perfect gas model allows $C_p(T)$ to vary with temperature as additional internal modes become excited. Consider a rigid-rotor, harmonic-oscillator, ideal-gas model of a diatomic species with one vibrational mode characterized by a vibrational temperature $T_\\mathrm{vib}$. Assume that translational and rotational modes are fully excited so that, under the calorically perfect assumption, the baseline constant $C_p$ is $C_{p,0} = \\frac{7}{2} R$, where $R$ is the universal gas constant.\n\nStarting from first principles, use the canonical partition function for a quantum harmonic oscillator, the thermodynamic definition of molar internal energy $U(T)$ via $U = -R T^2 \\left(\\partial \\ln Q/\\partial T\\right)$ for an ideal gas, and the definitions $C_v(T) = \\left(\\partial U/\\partial T\\right)_V$ and $C_p(T) = C_v(T) + R$ for an ideal gas, to derive the vibrational contribution $C_{p,\\mathrm{vib}}(T)$ as a function of the ratio $T/T_\\mathrm{vib}$. Then, by comparing $C_{p,\\mathrm{vib}}(T)$ to the calorically perfect baseline $C_{p,0}$, determine a practical criterion stated in terms of $T/T_\\mathrm{vib}$ for when neglecting vibrational contributions leads to a relative error larger than $5\\%$ in $C_p$. Choose the single best threshold among the following options.\n\n- A. $T/T_\\mathrm{vib} \\gtrsim 0.2$\n- B. $T/T_\\mathrm{vib} \\gtrsim 0.5$\n- C. $T/T_\\mathrm{vib} \\gtrsim 1.0$\n- D. $T/T_\\mathrm{vib} \\gtrsim 0.05$",
            "solution": "We begin with a rigid-rotor, harmonic-oscillator, ideal-gas model for a diatomic molecule. The vibrational degrees of freedom are treated as a quantum harmonic oscillator with energy levels $\\epsilon_n = \\left(n+\\frac{1}{2}\\right) k_B T_\\mathrm{vib}$, where $k_B$ is the Boltzmann constant and $T_\\mathrm{vib} = \\frac{h \\nu}{k_B}$ is the characteristic vibrational temperature (with $h$ the Planck constant and $\\nu$ the vibrational frequency). The single-mode vibrational partition function is\n$$\nq_\\mathrm{vib}(T) = \\frac{\\exp\\!\\left(-\\frac{T_\\mathrm{vib}}{2T}\\right)}{1 - \\exp\\!\\left(-\\frac{T_\\mathrm{vib}}{T}\\right)} \\, .\n$$\nFor an ideal gas, the molar internal energy is\n$$\nU(T) = - R T^2 \\frac{\\partial \\ln Q}{\\partial T} \\, ,\n$$\nand the vibrational contribution to the molar internal energy (for one mode) follows from $q_\\mathrm{vib}(T)$ as\n$$\nU_\\mathrm{vib}(T) = R T_\\mathrm{vib} \\left[ \\frac{1}{2} + \\frac{1}{\\exp\\!\\left(\\frac{T_\\mathrm{vib}}{T}\\right) - 1} \\right] \\, .\n$$\nThe vibrational contribution to the constant-volume specific heat is then\n$$\nC_{v,\\mathrm{vib}}(T) = \\left( \\frac{\\partial U_\\mathrm{vib}}{\\partial T} \\right)_V = R \\left( \\frac{T_\\mathrm{vib}}{T} \\right)^2 \\frac{\\exp\\!\\left(\\frac{T_\\mathrm{vib}}{T}\\right)}{\\left[ \\exp\\!\\left(\\frac{T_\\mathrm{vib}}{T}\\right) - 1 \\right]^2} \\, .\n$$\nFor an ideal gas, the constant-pressure specific heat satisfies\n$$\nC_p(T) = C_v(T) + R \\, .\n$$\nBecause the $+R$ term arises from $H = U + R T$ and is independent of vibrational excitation, the vibrational contribution to $C_p$ equals the vibrational contribution to $C_v$, namely\n$$\nC_{p,\\mathrm{vib}}(T) = C_{v,\\mathrm{vib}}(T) = R \\left( \\frac{T_\\mathrm{vib}}{T} \\right)^2 \\frac{\\exp\\!\\left(\\frac{T_\\mathrm{vib}}{T}\\right)}{\\left[ \\exp\\!\\left(\\frac{T_\\mathrm{vib}}{T}\\right) - 1 \\right]^2} \\, .\n$$\n\nWe now construct a criterion for when neglecting vibrational contributions introduces a relative error larger than $5\\%$ in $C_p$ relative to the calorically perfect baseline $C_{p,0} = \\frac{7}{2} R$. Define the relative error as\n$$\n\\delta(T) \\equiv \\frac{C_{p,\\mathrm{vib}}(T)}{C_{p,0}} = \\frac{2}{7} \\left( \\frac{T_\\mathrm{vib}}{T} \\right)^2 \\frac{\\exp\\!\\left(\\frac{T_\\mathrm{vib}}{T}\\right)}{\\left[ \\exp\\!\\left(\\frac{T_\\mathrm{vib}}{T}\\right) - 1 \\right]^2} \\, .\n$$\nWe set the threshold by solving $\\delta(T) = 0.05$ for the dimensionless ratio $T/T_\\mathrm{vib}$. Let $x \\equiv \\frac{T_\\mathrm{vib}}{T}$ so that $x = \\frac{1}{(T/T_\\mathrm{vib})}$. The condition becomes\n$$\n\\frac{2}{7} \\, \\frac{x^2 \\exp(x)}{\\left[ \\exp(x) - 1 \\right]^2} = 0.05 \\quad \\Longrightarrow \\quad \\frac{x^2 \\exp(x)}{\\left[ \\exp(x) - 1 \\right]^2} = 0.175 \\, .\n$$\nWe evaluate the left-hand side for several values of $x$ to locate the threshold.\n\n- For $x = 4$, $\\exp(4) \\approx 54.598$, $\\exp(4) - 1 \\approx 53.598$, so\n$$\n\\frac{x^2 \\exp(x)}{[\\exp(x) - 1]^2} \\approx \\frac{16 \\cdot 54.598}{(53.598)^2} \\approx \\frac{873.568}{2872.78} \\approx 0.304 \\, ,\n$$\nwhich yields\n$$\n\\delta \\approx \\frac{2}{7} \\cdot 0.304 \\approx 0.0869 \\quad \\text{(i.e., } 8.69\\% \\text{)} \\, .\n$$\n\n- For $x = 5$, $\\exp(5) \\approx 148.413$, $\\exp(5) - 1 \\approx 147.413$, so\n$$\n\\frac{x^2 \\exp(x)}{[\\exp(x) - 1]^2} \\approx \\frac{25 \\cdot 148.413}{(147.413)^2} \\approx \\frac{3710.325}{21721.7} \\approx 0.1708 \\, ,\n$$\nwhich yields\n$$\n\\delta \\approx \\frac{2}{7} \\cdot 0.1708 \\approx 0.0488 \\quad \\text{(i.e., } 4.88\\% \\text{)} \\, .\n$$\n\nThe target value $0.175$ lies between the values at $x = 4$ and $x = 5$, and the equality $\\delta = 0.05$ is closely met near $x \\approx 5$. Therefore,\n$$\nx^\\star \\approx 5 \\quad \\Rightarrow \\quad \\frac{T_\\mathrm{vib}}{T} \\approx 5 \\quad \\Rightarrow \\quad \\frac{T}{T_\\mathrm{vib}} \\approx 0.2 \\, .\n$$\nThis establishes a practical criterion: when $\\frac{T}{T_\\mathrm{vib}} \\gtrsim 0.2$, the vibrational contribution to $C_p$ exceeds $5\\%$ of the calorically perfect baseline for a rigid-rotor diatomic, and the calorically perfect assumption introduces a large error by the stated metric.\n\nWe now analyze each option.\n\n- Option A: $T/T_\\mathrm{vib} \\gtrsim 0.2$. Using the derivation above, the $5\\%$ threshold occurs at approximately $\\frac{T}{T_\\mathrm{vib}} \\approx 0.2$. This matches the criterion, so this option is Correct.\n\n- Option B: $T/T_\\mathrm{vib} \\gtrsim 0.5$. This is overly conservative. At $\\frac{T}{T_\\mathrm{vib}} = 0.5$ (i.e., $x = 2$), we find\n$$\n\\frac{x^2 \\exp(x)}{[\\exp(x)-1]^2} \\approx \\frac{4 \\cdot 7.389}{6.389^2} \\approx \\frac{29.556}{40.83} \\approx 0.724 \\, ,\n$$\nso\n$$\n\\delta \\approx \\frac{2}{7} \\cdot 0.724 \\approx 0.206 \\quad \\text{(i.e., } 20.6\\% \\text{)} \\, ,\n$$\nwhich already far exceeds $5\\%$. Hence the criterion is met much earlier than $0.5$, making this option Incorrect.\n\n- Option C: $T/T_\\mathrm{vib} \\gtrsim 1.0$. This is even more conservative. At $\\frac{T}{T_\\mathrm{vib}} = 1.0$ (i.e., $x = 1$),\n$$\n\\frac{x^2 \\exp(x)}{[\\exp(x)-1]^2} \\approx \\frac{1 \\cdot 2.718}{1.718^2} \\approx \\frac{2.718}{2.952} \\approx 0.921 \\, ,\n$$\nso\n$$\n\\delta \\approx \\frac{2}{7} \\cdot 0.921 \\approx 0.263 \\quad \\text{(i.e., } 26.3\\% \\text{)} \\, ,\n$$\nwhich again vastly exceeds $5\\%$. Thus this option is Incorrect.\n\n- Option D: $T/T_\\mathrm{vib} \\gtrsim 0.05$. This is too aggressive. At $\\frac{T}{T_\\mathrm{vib}} = 0.05$ (i.e., $x = 20$), the factor\n$$\n\\frac{x^2 \\exp(x)}{[\\exp(x)-1]^2}\n$$\nis extremely small. Using $\\exp(20) \\approx 4.85 \\times 10^8$, we have\n$$\n\\frac{x^2 \\exp(x)}{[\\exp(x)-1]^2} \\approx \\frac{400 \\cdot 4.85 \\times 10^8}{(4.85 \\times 10^8)^2} \\approx \\frac{1.94 \\times 10^{11}}{2.35 \\times 10^{17}} \\approx 8.3 \\times 10^{-7} \\, ,\n$$\nso\n$$\n\\delta \\approx \\frac{2}{7} \\cdot 8.3 \\times 10^{-7} \\approx 2.4 \\times 10^{-7} \\, ,\n$$\nwhich is negligible compared to $5\\%$. Therefore this option is Incorrect.\n\nThe correct threshold consistent with a $5\\%$ relative error criterion is $\\frac{T}{T_\\mathrm{vib}} \\gtrsim 0.2$, corresponding to Option A.\n\nIn practical aerospace CFD, this criterion aligns with familiar values. For example, molecular nitrogen has $T_\\mathrm{vib} \\approx 3390 \\, \\mathrm{K}$; applying the criterion suggests that around $T \\gtrsim 0.2 \\times 3390 \\, \\mathrm{K} \\approx 678 \\, \\mathrm{K}$, vibrational contributions begin to exceed $5\\%$ of the calorically perfect baseline $C_p$, and thermally perfect modeling becomes advisable for accurate energy accounting.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Moving from idealized physical models to engineering practice, this exercise introduces the NASA seven-coefficient polynomials, a widely adopted standard in aerospace CFD for representing the thermodynamic properties of gas mixtures like air. While these polynomials are empirical fits to experimental data, they are carefully constructed to preserve fundamental thermodynamic laws. This practice will guide you through using these polynomials to calculate key properties and, critically, to verify that they satisfy Mayer's relation, $C_p(T) - C_v(T) = R$, demonstrating the built-in consistency of these essential engineering tools .",
            "id": "3946385",
            "problem": "A stationary, constant-composition, ideal-gas model is used for dry atmospheric air in a Computational Fluid Dynamics (CFD) context to compare the calorically perfect and thermally perfect gas assumptions. In a calorically perfect gas, the specific heats are constant, whereas in a thermally perfect gas, the specific heats depend on temperature due to internal mode excitation. Assume air is an ideal gas with temperature-dependent thermodynamic properties represented by the National Aeronautics and Space Administration (NASA) seven-coefficient polynomials over two temperature intervals and constant mixture molecular weight. Let the universal molar gas constant be $R_{\\mathrm{u}} = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$, and the mixture molar mass of air be $\\overline{M} = 2.896546 \\times 10^{-2} \\ \\mathrm{kg \\ mol^{-1}}$, so that the mass-specific gas constant is $R = R_{\\mathrm{u}} / \\overline{M}$.\n\nThe NASA polynomial coefficients for air are given for two temperature ranges:\n\nFor $200 \\le T \\le 1000 \\ \\mathrm{K}$ (low-temperature interval):\n- $a_{1}^{\\mathrm{L}} = 3.16826710$, $a_{2}^{\\mathrm{L}} = -1.63965942 \\times 10^{-3}$, $a_{3}^{\\mathrm{L}} = 2.21435474 \\times 10^{-6}$, $a_{4}^{\\mathrm{L}} = -1.53116000 \\times 10^{-9}$, $a_{5}^{\\mathrm{L}} = 4.65993000 \\times 10^{-13}$, $a_{6}^{\\mathrm{L}} = -1.24007897 \\times 10^{3}$, $a_{7}^{\\mathrm{L}} = 5.40484100$.\n\nFor $1000 < T \\le 6000 \\ \\mathrm{K}$ (high-temperature interval):\n- $a_{1}^{\\mathrm{H}} = 2.56942000$, $a_{2}^{\\mathrm{H}} = -8.59740900 \\times 10^{-5}$, $a_{3}^{\\mathrm{H}} = 4.19484589 \\times 10^{-8}$, $a_{4}^{\\mathrm{H}} = -1.00177799 \\times 10^{-11}$, $a_{5}^{\\mathrm{H}} = 1.22833691 \\times 10^{-15}$, $a_{6}^{\\mathrm{H}} = -1.35578163 \\times 10^{3}$, $a_{7}^{\\mathrm{H}} = 9.15344100$.\n\nUse the standard NASA seven-coefficient polynomial representation for thermally perfect ideal gases to:\n1. Derive expressions for the mass-specific heat at constant pressure $C_{p}(T)$, mass-specific enthalpy $h(T)$, and mass-specific entropy $s(T)$ based on the appropriate coefficient set for each temperature interval. Clearly state how you select the coefficient set at each temperature.\n2. Using the ideal-gas identity $h(T) = u(T) + R T$ and the definitions $C_{p}(T) = \\mathrm{d}h/\\mathrm{d}T$ and $C_{v}(T) = \\mathrm{d}u/\\mathrm{d}T$, derive $C_{p}(T) - C_{v}(T)$ and discuss its significance for calorically perfect versus thermally perfect gas models.\n3. Evaluate, at the temperatures $T \\in \\{300, 1000, 3000\\} \\ \\mathrm{K}$, the residual\n$$r(T) = \\left[C_{p}(T) - C_{v}(T)\\right] - R$$\nusing the thermally perfect model with the given coefficients and report the maximum absolute value over the set $\\{300, 1000, 3000\\}$.\n\nExpress the final reported maximum absolute residual in $\\mathrm{J \\ kg^{-1} \\ K^{-1}}$ and round your answer to four significant figures.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Model**: Stationary, constant-composition, ideal-gas model for dry atmospheric air.\n- **Comparison**: Calorically perfect vs. thermally perfect gas assumptions.\n- **Gas Properties**: Assumed to be an ideal gas with temperature-dependent properties given by NASA seven-coefficient polynomials.\n- **Constants**:\n  - Universal molar gas constant, $R_{\\mathrm{u}} = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$.\n  - Mixture molar mass of air, $\\overline{M} = 2.896546 \\times 10^{-2} \\ \\mathrm{kg \\ mol^{-1}}$.\n- **Derived Constant**: Mass-specific gas constant, $R = R_{\\mathrm{u}} / \\overline{M}$.\n- **NASA Coefficients (Low-Temperature, $200 \\le T \\le 1000 \\ \\mathrm{K}$)**:\n  - $a_{1}^{\\mathrm{L}} = 3.16826710$\n  - $a_{2}^{\\mathrm{L}} = -1.63965942 \\times 10^{-3}$\n  - $a_{3}^{\\mathrm{L}} = 2.21435474 \\times 10^{-6}$\n  - $a_{4}^{\\mathrm{L}} = -1.53116000 \\times 10^{-9}$\n  - $a_{5}^{\\mathrm{L}} = 4.65993000 \\times 10^{-13}$\n  - $a_{6}^{\\mathrm{L}} = -1.24007897 \\times 10^{3}$\n  - $a_{7}^{\\mathrm{L}} = 5.40484100$\n- **NASA Coefficients (High-Temperature, $1000 < T \\le 6000 \\ \\mathrm{K}$)**:\n  - $a_{1}^{\\mathrm{H}} = 2.56942000$\n  - $a_{2}^{\\mathrm{H}} = -8.59740900 \\times 10^{-5}$\n  - $a_{3}^{\\mathrm{H}} = 4.19484589 \\times 10^{-8}$\n  - $a_{4}^{\\mathrm{H}} = -1.00177799 \\times 10^{-11}$\n  - $a_{5}^{\\mathrm{H}} = 1.22833691 \\times 10^{-15}$\n  - $a_{6}^{\\mathrm{H}} = -1.35578163 \\times 10^{3}$\n  - $a_{7}^{\\mathrm{H}} = 9.15344100$\n- **Tasks**:\n  1. Derive expressions for mass-specific $C_{p}(T)$, $h(T)$, and $s(T)$.\n  2. Derive $C_{p}(T) - C_{v}(T)$ from specified identities and discuss its significance.\n  3. Evaluate the residual $r(T) = [C_{p}(T) - C_{v}(T)] - R$ at $T \\in \\{300, 1000, 3000\\} \\ \\mathrm{K}$ and report the maximum absolute value.\n- **Identities**: $h(T) = u(T) + R T$, $C_{p}(T) = \\mathrm{d}h/\\mathrm{d}T$, $C_{v}(T) = \\mathrm{d}u/\\mathrm{d}T$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n- **Scientifically Grounded**: The problem is based on the ideal gas model and the NASA 7-coefficient polynomial representation for thermodynamic properties. These are standard, well-established models in thermodynamics and aerospace engineering. The values for $R_{\\mathrm{u}}$ and $\\overline{M}$ are standard and correct. The problem is scientifically sound.\n- **Well-Posed**: The tasks are clearly defined. The required inputs (coefficients, constants, temperatures) are all provided. The requested derivations and evaluation lead to a unique, meaningful solution.\n- **Objective**: The problem is stated in precise, quantitative, and unbiased language.\n- **Completeness and Consistency**: The problem is self-contained. The polynomial coefficients are provided for the relevant temperature ranges. The use of \"standard NASA seven-coefficient polynomial representation\" refers to a unique and well-known set of equations, making the problem unambiguous. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a well-posed problem grounded in established principles of thermodynamics and computational fluid dynamics. The solution process may proceed.\n\n---\n\n### Solution\n\nThe solution is developed by sequentially addressing the three tasks specified in the problem statement. First, the mass-specific gas constant for air is calculated as $R = R_{\\mathrm{u}} / \\overline{M}$.\n\n**1. Expressions for Thermodynamic Properties**\n\nThe standard NASA 7-coefficient polynomial formulation provides non-dimensional forms for molar specific heat capacity at constant pressure $(\\overline{C_{p}})$, molar enthalpy $(\\overline{h})$, and molar entropy $(\\overline{s})$. To obtain the mass-specific properties $C_{p}(T)$, $h(T)$, and $s(T)$, we use the mass-specific gas constant $R$.\n\nThe selection of the coefficient set depends on the temperature $T$. For a given temperature $T$, if $200 \\ \\mathrm{K} \\le T \\le 1000 \\ \\mathrm{K}$, the low-temperature coefficients $\\{ a_i^{\\mathrm{L}} \\}$ are used. If $1000 \\ \\mathrm{K} < T \\le 6000 \\ \\mathrm{K}$, the high-temperature coefficients $\\{ a_i^{\\mathrm{H}} \\}$ are used. Let $\\{a_i\\}$ represent the appropriate set for a given $T$.\n\nThe mass-specific heat at constant pressure, $C_{p}(T)$, is given by:\n$$ \\frac{C_p(T)}{R} = a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 $$\n$$ C_p(T) = R \\left( a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 \\right) $$\n\nThe mass-specific enthalpy, $h(T)$, is given by:\n$$ \\frac{h(T)}{RT} = a_1 + \\frac{a_2}{2} T + \\frac{a_3}{3} T^2 + \\frac{a_4}{4} T^3 + \\frac{a_5}{5} T^4 + \\frac{a_6}{T} $$\n$$ h(T) = RT \\left( a_1 + \\frac{a_2}{2} T + \\frac{a_3}{3} T^2 + \\frac{a_4}{4} T^3 + \\frac{a_5}{5} T^4 + \\frac{a_6}{T} \\right) = R \\left( a_1 T + \\frac{a_2}{2} T^2 + \\frac{a_3}{3} T^3 + \\frac{a_4}{4} T^4 + \\frac{a_5}{5} T^5 + a_6 \\right) $$\nThe forms for $C_p(T)$ and $h(T)$ are thermodynamically consistent, as $C_p(T) = \\mathrm{d}h/\\mathrm{d}T$.\n\nThe mass-specific entropy at standard pressure, $s(T)$, is given by:\n$$ \\frac{s(T)}{R} = a_1 \\ln(T) + a_2 T + \\frac{a_3}{2} T^2 + \\frac{a_4}{3} T^3 + \\frac{a_5}{4} T^4 + a_7 $$\n$$ s(T) = R \\left( a_1 \\ln(T) + a_2 T + \\frac{a_3}{2} T^2 + \\frac{a_4}{3} T^3 + \\frac{a_5}{4} T^4 + a_7 \\right) $$\n\n**2. Derivation of $C_{p}(T) - C_{v}(T)$**\n\nThis derivation begins with the definition of enthalpy for an ideal gas, which is provided:\n$$ h(T) = u(T) + RT $$\nHere, $u(T)$ is the mass-specific internal energy, and both $h$ and $u$ are functions of temperature only for an ideal gas. We differentiate this expression with respect to temperature $T$:\n$$ \\frac{\\mathrm{d}h(T)}{\\mathrm{d}T} = \\frac{\\mathrm{d}u(T)}{\\mathrm{d}T} + \\frac{\\mathrm{d}(RT)}{\\mathrm{d}T} $$\nSince $R$ is a constant, $\\mathrm{d}(RT)/\\mathrm{d}T = R$. The derivatives of enthalpy and internal energy are, by definition, the mass-specific heat capacities at constant pressure and constant volume, respectively:\n$$ C_p(T) = \\frac{\\mathrm{d}h(T)}{\\mathrm{d}T} \\quad \\text{and} \\quad C_v(T) = \\frac{\\mathrm{d}u(T)}{\\mathrm{d}T} $$\nSubstituting these definitions into the differentiated equation yields:\n$$ C_p(T) = C_v(T) + R $$\nRearranging this gives the desired relation:\n$$ C_p(T) - C_v(T) = R $$\nThis result is known as Mayer's relation for an ideal gas.\n\n**Significance:**\nThis relation is a fundamental consequence of the ideal gas model. Its significance in the context of the problem is that it holds true regardless of whether the gas is calorically perfect or thermally perfect.\n- For a **calorically perfect gas**, $C_p$ and $C_v$ are defined as constants. Their difference is necessarily the constant $R$.\n- For a **thermally perfect gas**, $C_p(T)$ and $C_v(T)$ are functions of temperature. However, their difference remains constant and equal to $R$. This is because the variation with temperature is the same for both specific heats. The physical reason is that for an ideal gas, internal energy and enthalpy changes are solely due to temperature changes, and the $p V$ term in enthalpy (here, $RT$) directly links the difference between $C_p$ and $C_v$ to the gas constant $R$. The NASA polynomial model is constructed to be consistent with this fundamental thermodynamic law.\n\n**3. Evaluation of the Residual $r(T)$**\n\nThe residual is defined as:\n$$ r(T) = [C_p(T) - C_v(T)] - R $$\nFrom the analytical derivation in Part 2, we established that for any ideal gas, including one described by the NASA polynomials, $C_p(T) - C_v(T) = R$.\n\nTo confirm this using the polynomial forms, we can derive an expression for $C_v(T)$ directly.\nFrom Part 2, $C_v(T) = C_p(T) - R$. Using the polynomial for $C_p(T)$ from Part 1:\n$$ C_v(T) = R \\left( a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 \\right) - R $$\n$$ C_v(T) = R \\left( (a_1 - 1) + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 \\right) $$\nNow, let's substitute this expression for $C_v(T)$ and the one for $C_p(T)$ into the residual definition:\n$$ r(T) = \\left[ R \\left( \\sum_{i=1}^{5} a_i T^{i-1} \\right) - \\left( R \\left( \\sum_{i=1}^{5} a_i T^{i-1} \\right) - R \\right) \\right] - R $$\nSimplifying the expression in the brackets:\n$$ r(T) = [ R - R ] = 0 $$\nThis result is purely analytical and does not depend on the specific values of the coefficients $\\{a_i\\}$ or the temperature $T$. The structure of the NASA polynomial model is intentionally designed to be consistent with Mayer's relation, $C_p - C_v = R$. Therefore, the residual $r(T)$ is analytically equal to zero for all temperatures for which the ideal gas model is valid.\n\nConsequently, for the specified temperatures:\n- At $T = 300 \\ \\mathrm{K}$, $r(300) = 0 \\ \\mathrm{J \\ kg^{-1} \\ K^{-1}}$.\n- At $T = 1000 \\ \\mathrm{K}$, $r(1000) = 0 \\ \\mathrm{J \\ kg^{-1} \\ K^{-1}}$.\n- At $T = 3000 \\ \\mathrm{K}$, $r(3000) = 0 \\ \\mathrm{J \\ kg^{-1} \\ K^{-1}}$.\n\nThe maximum absolute value of the residual over the set $\\{300, 1000, 3000\\}$ is therefore exactly $0$.\nThe problem requests the answer to be rounded to four significant figures. An exact value of zero can be represented in this format as $0.0000$.",
            "answer": "$$\\boxed{0.0000}$$"
        },
        {
            "introduction": "The theoretical choice between a calorically and thermally perfect gas model has direct and important consequences for the algorithms used in a CFD solver. This hands-on coding practice tackles one of the most fundamental procedures in any finite-volume code: the conversion from conservative variables (e.g., momentum density, total energy density) to primitive variables (e.g., velocity, pressure, temperature). You will implement this conversion for both gas models and discover the stark algorithmic difference—a simple algebraic inversion for the calorically perfect case versus an iterative, numerical root-finding procedure required for the thermally perfect model .",
            "id": "3946469",
            "problem": "You are tasked with implementing conservative-to-primitive variable conversion for the compressible Euler equations in Computational Fluid Dynamics (CFD) for an ideal gas, carefully distinguishing the calorically perfect gas model from the thermally perfect gas model. Begin from the foundational definitions and laws, without shortcuts.\n\nThe conservative variables are mass density $\\rho$, momentum density vector $\\mathbf{m} = (m_x, m_y, m_z)$, and total energy density $\\rho E$. The primitive variables are mass density $\\rho$, velocity vector $\\mathbf{u}$, pressure $p$, and temperature $T$. The ideal gas law relates pressure to density and temperature by $p = \\rho R T$, where $R$ is the specific gas constant.\n\nThe specific total energy $E$ (energy per unit mass) is the sum of specific internal energy $e(T)$ and specific kinetic energy. The specific internal energy is defined by the integral\n$$\ne(T) = \\int_{0}^{T} C_v(\\theta)\\, d\\theta,\n$$\nwhere $C_v(T)$ is the temperature-dependent specific heat at constant volume. In a calorically perfect gas, $C_v(T)$ is constant; in a thermally perfect gas, $C_v(T)$ varies with temperature. From first principles, recovering $T$ from $\\rho E$ requires: computing $\\mathbf{u}$ from momentum and density, computing the specific total energy $E = (\\rho E)/\\rho$, computing specific kinetic energy $\\frac{1}{2} |\\mathbf{u}|^2$, obtaining the specific internal energy $e = E - \\frac{1}{2} |\\mathbf{u}|^2$, and then inverting $e(T)$ to find $T$. For a calorically perfect gas, this inversion is algebraic. For a thermally perfect gas, this inversion is a one-dimensional root-finding problem due to the integral definition and the functional form of $C_v(T)$.\n\nYour program must implement both models:\n- Calorically perfect gas with constant $C_v(T) = \\bar{C}_v$.\n- Thermally perfect gas with $C_v(T) = a + b T + c T^2$, with $a$, $b$, $c$ given.\n\nFor all computations, use:\n- Specific gas constant $R = 287$ J/(kg·K).\n- Calorically perfect constant $\\bar{C}_v = 718$ J/(kg·K).\n- Thermally perfect coefficients $a = 700$ J/(kg·K), $b = 0.1$ J/(kg·K$^2$), $c = 10^{-4}$ J/(kg·K$^3$).\n\nYou must:\n1. Derive the temperature $T$ from the conservative variables by first principles as explained above, for both the calorically perfect and thermally perfect gas models.\n2. Use a robust bracketed root-finding method to invert $e(T)$ for the thermally perfect gas model. Monotonicity of $e(T)$ over physically relevant temperatures ensures a unique solution.\n3. Compute the corresponding pressure via $p = \\rho R T$ internally (no need to output it).\n\nPhysical units:\n- Report all temperatures in Kelvin (K).\n- All velocities are in meters per second (m/s).\n- All densities are in kilograms per cubic meter (kg/m$^3$).\n- All energies are in joules per cubic meter (J/m$^3$) for $\\rho E$ and joules per kilogram (J/kg) for specific energies.\n\nTest Suite:\nImplement your solution for the following five test cases, each case provided as $(\\rho, m_x, m_y, m_z, \\rho E)$ with units $(\\mathrm{kg/m^3}, \\mathrm{kg/(m^2\\cdot s)}, \\mathrm{kg/(m^2\\cdot s)}, \\mathrm{kg/(m^2\\cdot s)}, \\mathrm{J/m^3})$. These cases span a range of physical regimes:\n- Case $1$ (happy path, moderate speed, high temperature target under thermally perfect model): $(\\rho, m_x, m_y, m_z, \\rho E) = (1.0, 300.0, 0.0, 0.0, 828333.3333333334)$.\n- Case $2$ (near-boundary with low temperature, nonzero kinetic energy): $(\\rho, m_x, m_y, m_z, \\rho E) = (0.5, 50.0, 0.0, 0.0, 6002.516666666667)$.\n- Case $3$ (high internal energy, zero velocity): $(\\rho, m_x, m_y, m_z, \\rho E) = (1.2, 0.0, 0.0, 0.0, 2239999.9999999995)$.\n- Case $4$ (multi-dimensional velocity, moderate internal energy): $(\\rho, m_x, m_y, m_z, \\rho E) = (0.8, 160.0, 120.0, 40.0, 513253.3333333334)$.\n- Case $5$ (kinetic-energy-dominated regime, moderate temperature): $(\\rho, m_x, m_y, m_z, \\rho E) = (1.225, 1225.0, 0.0, 0.0, 876365.0)$.\n\nOutput specification:\n- For each test case, compute two temperatures: first under the calorically perfect model, then under the thermally perfect model.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, flattened in the order\n$$\n[T_{cp}^{(1)}, T_{tp}^{(1)}, T_{cp}^{(2)}, T_{tp}^{(2)}, T_{cp}^{(3)}, T_{tp}^{(3)}, T_{cp}^{(4)}, T_{tp}^{(4)}, T_{cp}^{(5)}, T_{tp}^{(5)}],\n$$\nwhere $T_{cp}^{(i)}$ denotes the calorically perfect temperature for case $i$, and $T_{tp}^{(i)}$ denotes the thermally perfect temperature for case $i$. Express each temperature in Kelvin, as real-valued floats.",
            "solution": "The problem statement has been rigorously validated and is determined to be sound. It is scientifically grounded in the principles of thermodynamics and fluid mechanics, well-posed with a unique and stable solution path, and specified with objective, unambiguous data and instructions. The task is to implement a conservative-to-primitive variable conversion for the compressible Euler equations, specifically to compute temperature $T$ from the conservative state vector $(\\rho, m_x, m_y, m_z, \\rho E)$ for an ideal gas under two different models for specific heat: calorically perfect and thermally perfect.\n\nThe procedure begins with the calculation of specific internal energy, $e$, which is model-independent. The conservative variables are mass density $\\rho$, the momentum density vector $\\mathbf{m} = (\\rho u_x, \\rho u_y, \\rho u_z)$, and the total energy per unit volume $\\rho E$.\n\nFirst, the velocity vector $\\mathbf{u} = (u_x, u_y, u_z)$ is recovered from the momentum density and mass density:\n$$\n\\mathbf{u} = \\frac{\\mathbf{m}}{\\rho}\n$$\nThe specific kinetic energy, $e_k$, which is the kinetic energy per unit mass, is then calculated as:\n$$\ne_k = \\frac{1}{2} |\\mathbf{u}|^2 = \\frac{1}{2} (u_x^2 + u_y^2 + u_z^2)\n$$\nThe specific total energy, $E$ (total energy per unit mass), is found by dividing the total energy density by the mass density:\n$$\nE = \\frac{\\rho E}{\\rho}\n$$\nThe specific total energy is the sum of specific internal energy $e$ and specific kinetic energy $e_k$. Therefore, we can isolate the specific internal energy:\n$$\ne = E - e_k\n$$\nThis value of $e$ represents the portion of the total energy associated with the thermal state of the gas. The final step, finding the temperature $T$ from $e$, depends on the gas model.\n\n**Model 1: Calorically Perfect Gas**\n\nIn a calorically perfect gas, the specific heat at constant volume, $C_v$, is assumed to be a constant, denoted as $\\bar{C}_v$. The problem specifies $\\bar{C}_v = 718 \\, \\text{J/(kg·K)}$. The specific internal energy is defined as $e(T) = \\int_{0}^{T} C_v(\\theta) \\, d\\theta$. For this model, the integral becomes:\n$$\ne(T) = \\int_{0}^{T} \\bar{C}_v \\, d\\theta = \\bar{C}_v T\n$$\nInverting this linear relationship to find the temperature $T_{cp}$ is a simple algebraic operation:\n$$\nT_{cp} = \\frac{e}{\\bar{C}_v}\n$$\n\n**Model 2: Thermally Perfect Gas**\n\nIn a thermally perfect gas, $C_v$ is a function of temperature, $C_v(T)$. The problem provides a quadratic model: $C_v(T) = a + b T + c T^2$, with given coefficients $a = 700 \\, \\text{J/(kg·K)}$, $b = 0.1 \\, \\text{J/(kg·K}^2\\text{)}$, and $c = 10^{-4} \\, \\text{J/(kg·K}^3\\text{)}$. The specific internal energy is found by integrating this expression:\n$$\ne(T) = \\int_{0}^{T} (a + b \\theta + c \\theta^2) \\, d\\theta = a T + \\frac{b}{2} T^2 + \\frac{c}{3} T^3\n$$\nTo find the temperature $T_{tp}$ from a known value of $e$, we must solve the following cubic equation for $T$:\n$$\na T + \\frac{b}{2} T^2 + \\frac{c}{3} T^3 - e = 0\n$$\nThis is a one-dimensional root-finding problem. We define a function $f(T) = (a T + \\frac{b}{2} T^2 + \\frac{c}{3} T^3) - e$. We seek the root $T$ such that $f(T)=0$. The derivative of $e(T)$ with respect to $T$ is $e'(T) = C_v(T)$. Since the coefficients $a, b, c$ are positive, $C_v(T)$ is strictly positive for any physical temperature $T > 0$. This ensures that $e(T)$ is a strictly monotonic function, guaranteeing a unique positive root for any $e > 0$. A robust bracketed root-finding method, such as the Brent-Dekker method, is ideal for this task. We establish a search bracket $[T_{min}, T_{max}]$ (e.g., $[1 \\, \\text{K}, 10000 \\, \\text{K}]$) that is certain to contain the root and over which the function changes sign.\n\nThe implementation will process each test case by first calculating the specific internal energy $e$, then applying the distinct inversion formula for the calorically perfect model and the numerical root-finding procedure for the thermally perfect model. The results for all test cases are then collected and formatted as specified.",
            "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Computes temperature from conservative variables for calorically and thermally\n    perfect gas models.\n    \"\"\"\n    # Define physical and model constants\n    R = 287.0  # Specific gas constant in J/(kg·K)\n    Cv_cp = 718.0  # Specific heat for calorically perfect gas in J/(kg·K)\n    a_tp = 700.0  # Coefficient a for thermally perfect C_v in J/(kg·K)\n    b_tp = 0.1  # Coefficient b for thermally perfect C_v in J/(kg·K^2)\n    c_tp = 1e-4  # Coefficient c for thermally perfect C_v in J/(kg·K^3)\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (rho, m_x, m_y, m_z, rhoE)\n    test_cases = [\n        (1.0, 300.0, 0.0, 0.0, 828333.3333333334),\n        (0.5, 50.0, 0.0, 0.0, 6002.516666666667),\n        (1.2, 0.0, 0.0, 0.0, 2239999.9999999995),\n        (0.8, 160.0, 120.0, 40.0, 513253.3333333334),\n        (1.225, 1225.0, 0.0, 0.0, 876365.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        rho, mx, my, mz, rhoE = case\n\n        # Step 1: Compute velocity vector components\n        ux = mx / rho\n        uy = my / rho\n        uz = mz / rho\n\n        # Step 2: Compute specific kinetic energy (per unit mass)\n        e_kinetic = 0.5 * (ux**2 + uy**2 + uz**2)\n\n        # Step 3: Compute specific total energy (per unit mass)\n        E_total = rhoE / rho\n\n        # Step 4: Compute specific internal energy (per unit mass)\n        e_internal = E_total - e_kinetic\n        \n        # Guard against non-physical negative internal energy, though not expected here.\n        if e_internal <= 0:\n            T_cp = 0.0\n            T_tp = 0.0\n        else:\n            # --- Calorically Perfect Gas Model ---\n            # Invert e = Cv_cp * T to find temperature\n            T_cp = e_internal / Cv_cp\n\n            # --- Thermally Perfect Gas Model ---\n            # Define the function whose root we need to find: f(T) = e(T) - e_internal\n            def f_tp(T, e_target):\n                \"\"\"\n                Represents the equation e(T) - e_target = 0 for the thermally perfect gas.\n                e(T) = a*T + (b/2)*T^2 + (c/3)*T^3\n                \"\"\"\n                return (a_tp * T + (b_tp / 2.0) * T**2 + (c_tp / 3.0) * T**3) - e_target\n\n            # Set a wide bracket for the root-finding algorithm to ensure robustness.\n            # Physical temperatures are in Kelvin, so T > 0.\n            T_min_bracket = 1.0\n            T_max_bracket = 10000.0\n\n            # Use SciPy's Brent's method for robust and fast root-finding.\n            # The function e(T) is monotonic for T>0, so a unique root is guaranteed\n            # if the bracket contains it.\n            try:\n                T_tp = optimize.brentq(f_tp, T_min_bracket, T_max_bracket, args=(e_internal,))\n            except ValueError:\n                # This error occurs if f(a) and f(b) have the same sign, meaning\n                # the root is not bracketed. This is not expected for the given problem.\n                T_tp = float('nan')\n\n        results.extend([T_cp, T_tp])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}