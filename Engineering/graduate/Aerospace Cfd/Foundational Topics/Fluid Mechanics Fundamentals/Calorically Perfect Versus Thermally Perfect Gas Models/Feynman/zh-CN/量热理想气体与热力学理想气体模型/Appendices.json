{
    "hands_on_practices": [
        {
            "introduction": "我们对气体模型的实践探索始于计算热力学性质这项基本任务。在真实的航空航天应用中，通常使用诸如NASA 7系数多项式之类的标准化数据，以精确模拟气体的比热容如何随温度变化。第一个练习  将指导您使用这些多项式计算空气的性质，为热完全气体模型的实际应用提供一个具体示例，并验证其是否遵循理想气体基本关系 $C_p(T) - C_v(T) = R$。",
            "id": "3946385",
            "problem": "在计算流体动力学 (CFD) 背景下，使用一个稳态、恒定组分的理想气体模型来研究干燥大气，以比较量热完全气体和热完全气体的假设。在量热完全气体中，比热是恒定的；而在热完全气体中，由于内能模式的激发，比热随温度变化。假设空气是一种理想气体，其随温度变化的热力学性质由美国国家航空航天局 (NASA) 的七系数多项式在两个温度区间上表示，且混合物摩尔质量恒定。设普适摩尔气体常数为 $R_{\\mathrm{u}} = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$，空气的混合物摩尔质量为 $\\overline{M} = 2.896546 \\times 10^{-2} \\ \\mathrm{kg \\ mol^{-1}}$，因此质量比气体常数为 $R = R_{\\mathrm{u}} / \\overline{M}$。\n\n空气的 NASA 多项式系数在两个温度范围内给出：\n\n对于 $200 \\le T \\le 1000 \\ \\mathrm{K}$ (低温区间)：\n- $a_{1}^{\\mathrm{L}} = 3.16826710$， $a_{2}^{\\mathrm{L}} = -1.63965942 \\times 10^{-3}$， $a_{3}^{\\mathrm{L}} = 2.21435474 \\times 10^{-6}$， $a_{4}^{\\mathrm{L}} = -1.53116000 \\times 10^{-9}$， $a_{5}^{\\mathrm{L}} = 4.65993000 \\times 10^{-13}$， $a_{6}^{\\mathrm{L}} = -1.24007897 \\times 10^{3}$， $a_{7}^{\\mathrm{L}} = 5.40484100$。\n\n对于 $1000  T \\le 6000 \\ \\mathrm{K}$ (高温区间)：\n- $a_{1}^{\\mathrm{H}} = 2.56942000$， $a_{2}^{\\mathrm{H}} = -8.59740900 \\times 10^{-5}$， $a_{3}^{\\mathrm{H}} = 4.19484589 \\times 10^{-8}$， $a_{4}^{\\mathrm{H}} = -1.00177799 \\times 10^{-11}$， $a_{5}^{\\mathrm{H}} = 1.22833691 \\times 10^{-15}$， $a_{6}^{\\mathrm{H}} = -1.35578163 \\times 10^{3}$， $a_{7}^{\\mathrm{H}} = 9.15344100$。\n\n使用针对热完全理想气体的标准 NASA 七系数多项式表示法来：\n1. 基于每个温度区间的相应系数集，推导定压质量比热 $C_{p}(T)$、质量比焓 $h(T)$ 和质量比熵 $s(T)$ 的表达式。清楚地说明在每个温度下如何选择系数集。\n2. 使用理想气体恒等式 $h(T) = u(T) + R T$ 以及定义 $C_{p}(T) = \\mathrm{d}h/\\mathrm{d}T$ 和 $C_{v}(T) = \\mathrm{d}u/\\mathrm{d}T$，推导 $C_{p}(T) - C_{v}(T)$，并讨论其对于量热完全气体模型与热完全气体模型的意义。\n3. 使用热完全模型和给定的系数，在温度 $T \\in \\{300, 1000, 3000\\} \\ \\mathrm{K}$ 下计算残差\n$$r(T) = \\left[C_{p}(T) - C_{v}(T)\\right] - R$$\n并报告在集合 $\\{300, 1000, 3000\\}$ 上的最大绝对值。\n\n将最终报告的最大绝对残差以 $\\mathrm{J \\ kg^{-1} \\ K^{-1}}$ 为单位表示，并将您的答案四舍五入到四位有效数字。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 第 1 步：提取已知条件\n- **模型**：用于干燥大气的稳态、恒定组分、理想气体模型。\n- **比较**：量热完全气体与热完全气体的假设。\n- **气体性质**：假设为理想气体，其随温度变化的性质由 NASA 七系数多项式给出。\n- **常数**：\n  - 普适摩尔气体常数，$R_{\\mathrm{u}} = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$。\n  - 空气的混合物摩尔质量，$\\overline{M} = 2.896546 \\times 10^{-2} \\ \\mathrm{kg \\ mol^{-1}}$。\n- **派生常数**：质量比气体常数，$R = R_{\\mathrm{u}} / \\overline{M}$。\n- **NASA 系数 (低温, $200 \\le T \\le 1000 \\ \\mathrm{K}$)**:\n  - $a_{1}^{\\mathrm{L}} = 3.16826710$\n  - $a_{2}^{\\mathrm{L}} = -1.63965942 \\times 10^{-3}$\n  - $a_{3}^{\\mathrm{L}} = 2.21435474 \\times 10^{-6}$\n  - $a_{4}^{\\mathrm{L}} = -1.53116000 \\times 10^{-9}$\n  - $a_{5}^{\\mathrm{L}} = 4.65993000 \\times 10^{-13}$\n  - $a_{6}^{\\mathrm{L}} = -1.24007897 \\times 10^{3}$\n  - $a_{7}^{\\mathrm{L}} = 5.40484100$\n- **NASA 系数 (高温, $1000  T \\le 6000 \\ \\mathrm{K}$)**:\n  - $a_{1}^{\\mathrm{H}} = 2.56942000$\n  - $a_{2}^{\\mathrm{H}} = -8.59740900 \\times 10^{-5}$\n  - $a_{3}^{\\mathrm{H}} = 4.19484589 \\times 10^{-8}$\n  - $a_{4}^{\\mathrm{H}} = -1.00177799 \\times 10^{-11}$\n  - $a_{5}^{\\mathrm{H}} = 1.22833691 \\times 10^{-15}$\n  - $a_{6}^{\\mathrm{H}} = -1.35578163 \\times 10^{3}$\n  - $a_{7}^{\\mathrm{H}} = 9.15344100$\n- **任务**：\n  1. 推导质量比 $C_{p}(T)$、$h(T)$ 和 $s(T)$ 的表达式。\n  2. 根据指定的恒等式推导 $C_{p}(T) - C_{v}(T)$ 并讨论其意义。\n  3. 在 $T \\in \\{300, 1000, 3000\\} \\ \\mathrm{K}$ 计算残差 $r(T) = [C_{p}(T) - C_{v}(T)] - R$ 并报告最大绝对值。\n- **恒等式**：$h(T) = u(T) + R T$，$C_{p}(T) = \\mathrm{d}h/\\mathrm{d}T$，$C_{v}(T) = \\mathrm{d}u/\\mathrm{d}T$。\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题的有效性进行评估。\n- **科学依据**：该问题基于理想气体模型和用于热力学性质的 NASA 7 系数多项式表示法。这些是热力学和航空航天工程中标准的、成熟的模型。$R_{\\mathrm{u}}$ 和 $\\overline{M}$ 的值是标准且正确的。该问题具有科学合理性。\n- **适定性**：任务定义明确。所需的输入（系数、常数、温度）均已提供。所要求的推导和评估会得出一个唯一的、有意义的解。\n- **客观性**：问题以精确、定量和无偏见的语言陈述。\n- **完整性和一致性**：问题是自洽的。为相关温度范围提供了多项式系数。“标准 NASA 七系数多项式表示法”的提法指向一组唯一的、众所周知的方程组，使问题明确无歧义。内部没有矛盾。\n\n### 第 3 步：结论与行动\n该问题被判定为 **有效**。这是一个基于热力学和计算流体动力学既定原理的适定问题。可以继续求解过程。\n\n---\n\n### 解答\n\n通过依次解决问题陈述中指定的三个任务来展开解答。首先，计算空气的质量比气体常数 $R = R_{\\mathrm{u}} / \\overline{M}$。\n\n**1. 热力学性质的表达式**\n\n标准的 NASA 7 系数多项式公式提供了定压摩尔比热 $(\\overline{C_{p}})$、摩尔焓 $(\\overline{h})$ 和摩尔熵 $(\\overline{s})$ 的无量纲形式。为了获得质量比性质 $C_{p}(T)$、$h(T)$ 和 $s(T)$，我们使用质量比气体常数 $R$。\n\n系数集的选择取决于温度 $T$。对于给定的温度 $T$，如果 $200 \\ \\mathrm{K} \\le T \\le 1000 \\ \\mathrm{K}$，则使用低温系数 $\\{ a_i^{\\mathrm{L}} \\}$。如果 $1000 \\ \\mathrm{K}  T \\le 6000 \\ \\mathrm{K}$，则使用高温系数 $\\{ a_i^{\\mathrm{H}} \\}$。令 $\\{a_i\\}$ 表示给定 $T$ 的相应系数集。\n\n定压质量比热 $C_{p}(T)$ 由下式给出：\n$$ \\frac{C_p(T)}{R} = a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 $$\n$$ C_p(T) = R \\left( a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 \\right) $$\n\n质量比焓 $h(T)$ 由下式给出：\n$$ \\frac{h(T)}{RT} = a_1 + \\frac{a_2}{2} T + \\frac{a_3}{3} T^2 + \\frac{a_4}{4} T^3 + \\frac{a_5}{5} T^4 + \\frac{a_6}{T} $$\n$$ h(T) = RT \\left( a_1 + \\frac{a_2}{2} T + \\frac{a_3}{3} T^2 + \\frac{a_4}{4} T^3 + \\frac{a_5}{5} T^4 + \\frac{a_6}{T} \\right) = R \\left( a_1 T + \\frac{a_2}{2} T^2 + \\frac{a_3}{3} T^3 + \\frac{a_4}{4} T^4 + \\frac{a_5}{5} T^5 + a_6 \\right) $$\n$C_p(T)$ 和 $h(T)$ 的形式在热力学上是一致的，因为 $C_p(T) = \\mathrm{d}h/\\mathrm{d}T$。\n\n标准压力下的质量比熵 $s(T)$ 由下式给出：\n$$ \\frac{s(T)}{R} = a_1 \\ln(T) + a_2 T + \\frac{a_3}{2} T^2 + \\frac{a_4}{3} T^3 + \\frac{a_5}{4} T^4 + a_7 $$\n$$ s(T) = R \\left( a_1 \\ln(T) + a_2 T + \\frac{a_3}{2} T^2 + \\frac{a_4}{3} T^3 + \\frac{a_5}{4} T^4 + a_7 \\right) $$\n\n**2. $C_{p}(T) - C_{v}(T)$ 的推导**\n\n该推导从理想气体的焓的定义开始，该定义已给出：\n$$ h(T) = u(T) + RT $$\n此处，$u(T)$ 是质量比内能，对于理想气体，$h$ 和 $u$ 都仅是温度的函数。我们对该表达式关于温度 $T$ 求导：\n$$ \\frac{\\mathrm{d}h(T)}{\\mathrm{d}T} = \\frac{\\mathrm{d}u(T)}{\\mathrm{d}T} + \\frac{\\mathrm{d}(RT)}{\\mathrm{d}T} $$\n由于 $R$ 是一个常数，$\\mathrm{d}(RT)/\\mathrm{d}T = R$。根据定义，焓和内能的导数分别是定压质量比热和定容质量比热：\n$$ C_p(T) = \\frac{\\mathrm{d}h(T)}{\\mathrm{d}T} \\quad \\text{和} \\quad C_v(T) = \\frac{\\mathrm{d}u(T)}{\\mathrm{d}T} $$\n将这些定义代入微分后的方程，得到：\n$$ C_p(T) = C_v(T) + R $$\n重新整理可得所需的关系式：\n$$ C_p(T) - C_v(T) = R $$\n这个结果被称为理想气体的迈耶关系式。\n\n**意义：**\n这个关系是理想气体模型的一个基本推论。它在本问题背景下的意义在于，无论气体是量热完全的还是热完全的，该关系都成立。\n- 对于**量热完全气体**，$C_p$ 和 $C_v$ 被定义为常数。它们的差必然是常数 $R$。\n- 对于**热完全气体**，$C_p(T)$ 和 $C_v(T)$ 是温度的函数。然而，它们的差保持为常数且等于 $R$。这是因为两种比热随温度的变化是相同的。物理原因是，对于理想气体，内能和焓的变化完全由温度变化引起，而焓中的 $p V$ 项（此处为 $RT$）直接将 $C_p$ 和 $C_v$ 之间的差与气体常数 $R$ 联系起来。NASA 多项式模型的构建与这个基本热力学定律是一致的。\n\n**3. 残差 $r(T)$ 的计算**\n\n残差定义为：\n$$ r(T) = [C_p(T) - C_v(T)] - R $$\n从第 2 部分的解析推导中，我们确定对于任何理想气体，包括由 NASA 多项式描述的气体，$C_p(T) - C_v(T) = R$。\n\n为了用多项式形式验证这一点，我们可以直接推导 $C_v(T)$ 的表达式。\n从第 2 部分可知，$C_v(T) = C_p(T) - R$。使用第 1 部分中 $C_p(T)$ 的多项式：\n$$ C_v(T) = R \\left( a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 \\right) - R $$\n$$ C_v(T) = R \\left( (a_1 - 1) + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 \\right) $$\n现在，我们将 $C_v(T)$ 的表达式和 $C_p(T)$ 的表达式代入残差的定义中：\n$$ r(T) = \\left[ R \\left( \\sum_{i=1}^{5} a_i T^{i-1} \\right) - \\left( R \\left( \\sum_{i=1}^{5} a_i T^{i-1} \\right) - R \\right) \\right] - R $$\n简化括号中的表达式：\n$$ r(T) = [ R ] - R = 0 $$\n这个结果是纯解析的，不依赖于系数 $\\{a_i\\}$ 的具体值或温度 $T$。NASA 多项式模型的结构被有意设计成与迈耶关系式 $C_p - C_v = R$ 一致。因此，对于理想气体模型有效的所有温度，残差 $r(T)$ 在解析上恒等于零。\n\n因此，对于指定的温度：\n- 在 $T = 300 \\ \\mathrm{K}$ 时，$r(300) = 0 \\ \\mathrm{J \\ kg^{-1} \\ K^{-1}}$。\n- 在 $T = 1000 \\ \\mathrm{K}$ 时，$r(1000) = 0 \\ \\mathrm{J \\ kg^{-1} \\ K^{-1}}$。\n- 在 $T = 3000 \\ \\mathrm{K}$ 时，$r(3000) = 0 \\ \\mathrm{J \\ kg^{-1} \\ K^{-1}}$。\n\n因此，在集合 $\\{300, 1000, 3000\\}$ 上，残差的最大绝对值恰好为 $0$。\n问题要求将答案四舍五入到四位有效数字。精确值零可以以此格式表示为 $0.0000$。",
            "answer": "$$\\boxed{0.0000}$$"
        },
        {
            "introduction": "了解了*如何*计算随温度变化的比热后，理解*为何*以及*何时*需要这种复杂性至关重要。量热完全气体模型虽然简单，但在高温下会失效，因为此时分子振动等内能模式被激活。本练习  深入探讨了这种现象的统计力学根源，要求您量化由量热完全假设引入的误差，并基于特征振动温度 $T_\\mathrm{vib}$ 建立一个实用的温度阈值，以判断何时必须使用热完全模型。",
            "id": "3946399",
            "problem": "航空航天计算流体动力学（CFD）模型通常采用量热完全气体近似，其中定压比热 $C_p$ 被视为与温度无关，并由一部分热激活的自由度固定。相比之下，热完全气体模型允许 $C_p(T)$ 随着额外内能模式被激发而随温度变化。考虑一个双原子物质的刚性转子、谐振子、理想气体模型，其具有一个振动模式，特征振动温度为 $T_\\mathrm{vib}$。假设平动和转动模式已完全激发，因此在量热完全假设下，基准常数 $C_p$ 为 $C_{p,0} = \\frac{7}{2} R$，其中 $R$ 是普适气体常数。\n\n从第一性原理出发，使用量子谐振子的正则配分函数、通过 $U = -R T^2 \\left(\\partial \\ln Q/\\partial T\\right)$ 给出的理想气体摩尔内能 $U(T)$ 的热力学定义，以及理想气体的定义 $C_v(T) = \\left(\\partial U/\\partial T\\right)_V$ 和 $C_p(T) = C_v(T) + R$，推导出振动贡献 $C_{p,\\mathrm{vib}}(T)$ 作为比率 $T/T_\\mathrm{vib}$ 的函数。然后，通过将 $C_{p,\\mathrm{vib}}(T)$ 与量热完全基准 $C_{p,0}$进行比较，确定一个以 $T/T_\\mathrm{vib}$ 表示的实用判据，用于判断何时忽略振动贡献会导致 $C_p$ 的相对误差大于 $5\\%$。在下列选项中选择唯一的最佳阈值。\n\n- A. $T/T_\\mathrm{vib} \\gtrsim 0.2$\n\n- B. $T/T_\\mathrm{vib} \\gtrsim 0.5$\n\n- C. $T/T_\\mathrm{vib} \\gtrsim 1.0$\n\n- D. $T/T_\\mathrm{vib} \\gtrsim 0.05$",
            "solution": "我们从双原子分子的刚性转子、谐振子、理想气体模型开始。振动自由度被视为一个量子谐振子，其能级为 $\\epsilon_n = \\left(n+\\frac{1}{2}\\right) k_B T_\\mathrm{vib}$，其中 $k_B$ 是玻尔兹曼常数，$T_\\mathrm{vib} = \\frac{h \\nu}{k_B}$ 是特征振动温度（$h$ 是普朗克常数，$\\nu$ 是振动频率）。单模振动配分函数为\n$$\nq_\\mathrm{vib}(T) = \\frac{\\exp\\!\\left(-\\frac{T_\\mathrm{vib}}{2T}\\right)}{1 - \\exp\\!\\left(-\\frac{T_\\mathrm{vib}}{T}\\right)} \\, .\n$$\n对于理想气体，摩尔内能为\n$$\nU(T) = - R T^2 \\frac{\\partial \\ln Q}{\\partial T} \\, ,\n$$\n摩尔内能的振动贡献（对于一个模式）可由 $q_\\mathrm{vib}(T)$ 推得\n$$\nU_\\mathrm{vib}(T) = R T_\\mathrm{vib} \\left[ \\frac{1}{2} + \\frac{1}{\\exp\\!\\left(\\frac{T_\\mathrm{vib}}{T}\\right) - 1} \\right] \\, .\n$$\n于是，对定容比热的振动贡献为\n$$\nC_{v,\\mathrm{vib}}(T) = \\left( \\frac{\\partial U_\\mathrm{vib}}{\\partial T} \\right)_V = R \\left( \\frac{T_\\mathrm{vib}}{T} \\right)^2 \\frac{\\exp\\!\\left(\\frac{T_\\mathrm{vib}}{T}\\right)}{\\left[ \\exp\\!\\left(\\frac{T_\\mathrm{vib}}{T}\\right) - 1 \\right]^2} \\, .\n$$\n对于理想气体，定压比热满足\n$$\nC_p(T) = C_v(T) + R \\, .\n$$\n因为 $+R$ 项源于 $H = U + R T$ 并且与振动激发无关，所以对 $C_p$ 的振动贡献等于对 $C_v$ 的振动贡献，即\n$$\nC_{p,\\mathrm{vib}}(T) = C_{v,\\mathrm{vib}}(T) = R \\left( \\frac{T_\\mathrm{vib}}{T} \\right)^2 \\frac{\\exp\\!\\left(\\frac{T_\\mathrm{vib}}{T}\\right)}{\\left[ \\exp\\!\\left(\\frac{T_\\mathrm{vib}}{T}\\right) - 1 \\right]^2} \\, .\n$$\n\n我们现在构建一个判据，用于判断何时忽略振动贡献会导致 $C_p$ 相对于量热完全基准 $C_{p,0} = \\frac{7}{2} R$ 的相对误差大于 $5\\%$。将相对误差定义为\n$$\n\\delta(T) \\equiv \\frac{C_{p,\\mathrm{vib}}(T)}{C_{p,0}} = \\frac{2}{7} \\left( \\frac{T_\\mathrm{vib}}{T} \\right)^2 \\frac{\\exp\\!\\left(\\frac{T_\\mathrm{vib}}{T}\\right)}{\\left[ \\exp\\!\\left(\\frac{T_\\mathrm{vib}}{T}\\right) - 1 \\right]^2} \\, .\n$$\n我们通过求解 $\\delta(T) = 0.05$ 来确定无量纲比率 $T/T_\\mathrm{vib}$ 的阈值。令 $x \\equiv \\frac{T_\\mathrm{vib}}{T}$，则 $x = \\frac{1}{(T/T_\\mathrm{vib})}$。条件变为\n$$\n\\frac{2}{7} \\, \\frac{x^2 \\exp(x)}{\\left[ \\exp(x) - 1 \\right]^2} = 0.05 \\quad \\Longrightarrow \\quad \\frac{x^2 \\exp(x)}{\\left[ \\exp(x) - 1 \\right]^2} = 0.175 \\, .\n$$\n我们计算左侧在几个 $x$ 值处的结果来定位阈值。\n\n- 当 $x = 4$ 时，$\\exp(4) \\approx 54.598$，$\\exp(4) - 1 \\approx 53.598$，所以\n$$\n\\frac{x^2 \\exp(x)}{[\\exp(x) - 1]^2} \\approx \\frac{16 \\cdot 54.598}{(53.598)^2} \\approx \\frac{873.568}{2872.78} \\approx 0.304 \\, ,\n$$\n这得到\n$$\n\\delta \\approx \\frac{2}{7} \\cdot 0.304 \\approx 0.0869 \\quad \\text{(即 } 8.69\\% \\text{)} \\, .\n$$\n\n- 当 $x = 5$ 时，$\\exp(5) \\approx 148.413$，$\\exp(5) - 1 \\approx 147.413$，所以\n$$\n\\frac{x^2 \\exp(x)}{[\\exp(x) - 1]^2} \\approx \\frac{25 \\cdot 148.413}{(147.413)^2} \\approx \\frac{3710.325}{21721.7} \\approx 0.1708 \\, ,\n$$\n这得到\n$$\n\\delta \\approx \\frac{2}{7} \\cdot 0.1708 \\approx 0.0488 \\quad \\text{(即 } 4.88\\% \\text{)} \\, .\n$$\n\n目标值 $0.175$ 位于 $x = 4$ 和 $x = 5$ 时的值之间，并且等式 $\\delta = 0.05$ 在 $x \\approx 5$ 附近近似成立。因此，\n$$\nx^\\star \\approx 5 \\quad \\Rightarrow \\quad \\frac{T_\\mathrm{vib}}{T} \\approx 5 \\quad \\Rightarrow \\quad \\frac{T}{T_\\mathrm{vib}} \\approx 0.2 \\, .\n$$\n这建立了一个实用判据：当 $\\frac{T}{T_\\mathrm{vib}} \\gtrsim 0.2$ 时，对于刚性转子双原子分子，$C_p$ 的振动贡献超过量热完全基准的 $5\\%$，根据所述度量标准，量热完全假设会引入较大误差。\n\n我们现在分析每个选项。\n\n- 选项 A：$T/T_\\mathrm{vib} \\gtrsim 0.2$。根据以上推导，$5\\%$ 的阈值出现在大约 $\\frac{T}{T_\\mathrm{vib}} \\approx 0.2$ 处。这与判据相符，所以此选项正确。\n\n- 选项 B：$T/T_\\mathrm{vib} \\gtrsim 0.5$。这过于保守。在 $\\frac{T}{T_\\mathrm{vib}} = 0.5$（即 $x = 2$）时，我们发现\n$$\n\\frac{x^2 \\exp(x)}{[\\exp(x)-1]^2} \\approx \\frac{4 \\cdot 7.389}{6.389^2} \\approx \\frac{29.556}{40.83} \\approx 0.724 \\, ,\n$$\n所以\n$$\n\\delta \\approx \\frac{2}{7} \\cdot 0.724 \\approx 0.206 \\quad \\text{(即 } 20.6\\% \\text{)} \\, ,\n$$\n这已远超过 $5\\%$。因此，判据在远早于 $0.5$ 时就已满足，使得此选项不正确。\n\n- 选项 C：$T/T_\\mathrm{vib} \\gtrsim 1.0$。这更加保守。在 $\\frac{T}{T_\\mathrm{vib}} = 1.0$（即 $x = 1$）时，\n$$\n\\frac{x^2 \\exp(x)}{[\\exp(x)-1]^2} \\approx \\frac{1 \\cdot 2.718}{1.718^2} \\approx \\frac{2.718}{2.952} \\approx 0.921 \\, ,\n$$\n所以\n$$\n\\delta \\approx \\frac{2}{7} \\cdot 0.921 \\approx 0.263 \\quad \\text{(即 } 26.3\\% \\text{)} \\, ,\n$$\n这也极大地超过了 $5\\%$。因此此选项不正确。\n\n- 选项 D：$T/T_\\mathrm{vib} \\gtrsim 0.05$。这过于激进。在 $\\frac{T}{T_\\mathrm{vib}} = 0.05$（即 $x = 20$）时，因子\n$$\n\\frac{x^2 \\exp(x)}{[\\exp(x)-1]^2}\n$$\n极小。使用 $\\exp(20) \\approx 4.85 \\times 10^8$，我们有\n$$\n\\frac{x^2 \\exp(x)}{[\\exp(x)-1]^2} \\approx \\frac{400 \\cdot 4.85 \\times 10^8}{(4.85 \\times 10^8)^2} \\approx \\frac{1.94 \\times 10^{11}}{2.35 \\times 10^{17}} \\approx 8.3 \\times 10^{-7} \\, ,\n$$\n所以\n$$\n\\delta \\approx \\frac{2}{7} \\cdot 8.3 \\times 10^{-7} \\approx 2.4 \\times 10^{-7} \\, ,\n$$\n与 $5\\%$ 相比可以忽略不计。因此此选项不正确。\n\n与 $5\\%$ 相对误差判据一致的正确阈值是 $\\frac{T}{T_\\mathrm{vib}} \\gtrsim 0.2$，对应于选项 A。\n\n在实际的航空航天CFD中，该判据与常见值一致。例如，氮分子的 $T_\\mathrm{vib} \\approx 3390 \\, \\mathrm{K}$；应用该判据表明，在 $T \\gtrsim 0.2 \\times 3390 \\, \\mathrm{K} \\approx 678 \\, \\mathrm{K}$ 左右，振动贡献开始超过量热完全基准 $C_p$ 的 $5\\%$，为了精确的能量计算，建议使用热完全气体模型。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "这些模型的最终考验在于它们在计算流体动力学（CFD）求解器中的实现。任何现代激波捕捉格式的一个关键步骤，都是将守恒变量（如动量和总能量密度）转换回原始变量（如压力和温度）。这最后一个练习  要求您为量热完全和热完全两种气体模型实现这一转换，直接对比前者的代数简洁性与后者所需的数值求根过程，从而突显选择更精确物理模型所带来的计算影响。",
            "id": "3946469",
            "problem": "您的任务是为计算流体动力学（CFD）中的可压缩欧拉方程实现从守恒变量到原始变量的转换，此转换针对理想气体，并需仔细区分量热完全气体模型和热完全气体模型。请从基本定义和定律出发，不要使用简化方法。\n\n守恒变量为质量密度 $\\rho$、动量密度矢量 $\\mathbf{m} = (m_x, m_y, m_z)$ 和总能量密度 $\\rho E$。原始变量为质量密度 $\\rho$、速度矢量 $\\mathbf{u}$、压力 $p$ 和温度 $T$。理想气体定律通过 $p = \\rho R T$ 将压力、密度和温度关联起来，其中 $R$ 是比气体常数。\n\n比总能 $E$（单位质量的能量）是比内能 $e(T)$ 和比动能之和。比内能由以下积分定义：\n$$\ne(T) = \\int_{0}^{T} C_v(\\theta)\\, d\\theta,\n$$\n其中 $C_v(T)$ 是随温度变化的定容比热。在量热完全气体中，$C_v(T)$ 是常数；在热完全气体中，$C_v(T)$ 随温度变化。根据第一性原理，从 $\\rho E$ 中恢复 $T$ 需要：根据动量和密度计算 $\\mathbf{u}$，计算比总能 $E = (\\rho E)/\\rho$，计算比动能 $\\frac{1}{2} |\\mathbf{u}|^2$，获得比内能 $e = E - \\frac{1}{2} |\\mathbf{u}|^2$，然后反解 $e(T)$ 以求得 $T$。对于量热完全气体，此反解过程是代数运算。对于热完全气体，由于积分定义和 $C_v(T)$ 的函数形式，此反解过程是一个一维求根问题。\n\n您的程序必须实现以下两种模型：\n- 量热完全气体，具有恒定的 $C_v(T) = \\bar{C}_v$。\n- 热完全气体，其中 $C_v(T) = a + b T + c T^2$，系数 $a$、$b$、$c$ 已给定。\n\n所有计算均使用：\n- 比气体常数 $R = 287$ J/(kg·K)。\n- 量热完全气体常数 $\\bar{C}_v = 718$ J/(kg·K)。\n- 热完全气体系数 $a = 700$ J/(kg·K)，$b = 0.1$ J/(kg·K$^2$)，$c = 10^{-4}$ J/(kg·K$^3$)。\n\n您必须：\n1. 对于量热完全气体和热完全气体模型，均按上述第一性原理从守恒变量推导出温度 $T$。\n2. 对于热完全气体模型，使用一个稳健的区间求根方法来反解 $e(T)$。在物理相关温度范围内，$e(T)$ 的单调性确保了唯一解的存在。\n3. 在内部通过 $p = \\rho R T$ 计算相应的压力（无需输出）。\n\n物理单位：\n- 所有温度以开尔文（K）报告。\n- 所有速度单位为米/秒（m/s）。\n- 所有密度单位为千克/立方米（kg/m$^3$）。\n- 所有能量单位，对于 $\\rho E$ 为焦耳/立方米（J/m$^3$），对于比能为焦耳/千克（J/kg）。\n\n测试套件：\n为以下五个测试用例实现您的解决方案，每个用例以 $(\\rho, m_x, m_y, m_z, \\rho E)$ 的形式提供，单位为 $(\\mathrm{kg/m^3}, \\mathrm{kg/(m^2\\cdot s)}, \\mathrm{kg/(m^2\\cdot s)}, \\mathrm{kg/(m^2\\cdot s)}, \\mathrm{J/m^3})$。这些案例涵盖了一系列物理状态：\n- 案例1（正常路径，中等速度，热完全模型下目标温度高）：$(\\rho, m_x, m_y, m_z, \\rho E) = (1.0, 300.0, 0.0, 0.0, 828333.3333333334)$。\n- 案例2（接近边界，低温，非零动能）：$(\\rho, m_x, m_y, m_z, \\rho E) = (0.5, 50.0, 0.0, 0.0, 6002.516666666667)$。\n- 案例3（高内能，零速度）：$(\\rho, m_x, m_y, m_z, \\rho E) = (1.2, 0.0, 0.0, 0.0, 2239999.9999999995)$。\n- 案例4（多维速度，中等内能）：$(\\rho, m_x, m_y, m_z, \\rho E) = (0.8, 160.0, 120.0, 40.0, 513253.3333333334)$。\n- 案例5（动能主导状态，中等温度）：$(\\rho, m_x, m_y, m_z, \\rho E) = (1.225, 1225.0, 0.0, 0.0, 876365.0)$。\n\n输出规范：\n- 对每个测试用例，计算两个温度：首先在量热完全模型下，然后在热完全模型下。\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，按以下顺序展开：\n$$\n[T_{cp}^{(1)}, T_{tp}^{(1)}, T_{cp}^{(2)}, T_{tp}^{(2)}, T_{cp}^{(3)}, T_{tp}^{(3)}, T_{cp}^{(4)}, T_{tp}^{(4)}, T_{cp}^{(5)}, T_{tp}^{(5)}],\n$$\n其中 $T_{cp}^{(i)}$ 表示案例 $i$ 的量热完全气体温度，$T_{tp}^{(i)}$ 表示案例 $i$ 的热完全气体温度。每个温度都以开尔文为单位，表示为实值浮点数。",
            "solution": "问题陈述已经过严格验证，并被确定为是合理的。它在科学上基于热力学和流体力学原理，问题定义良好，具有唯一且稳定的求解路径，并提供了客观、明确的数据和指令。任务是实现可压缩欧拉方程的守恒变量到原始变量的转换，具体而言，是在量热完全和热完全两种不同的比热模型下，根据理想气体的守恒状态矢量 $(\\rho, m_x, m_y, m_z, \\rho E)$ 计算温度 $T$。\n\n该过程始于计算比内能 $e$，这一步与模型无关。守恒变量是质量密度 $\\rho$、动量密度矢量 $\\mathbf{m} = (\\rho u_x, \\rho u_y, \\rho u_z)$ 和单位体积的总能量 $\\rho E$。\n\n首先，从动量密度和质量密度中恢复速度矢量 $\\mathbf{u} = (u_x, u_y, u_z)$：\n$$\n\\mathbf{u} = \\frac{\\mathbf{m}}{\\rho}\n$$\n接着，计算比动能 $e_k$（单位质量的动能）：\n$$\ne_k = \\frac{1}{2} |\\mathbf{u}|^2 = \\frac{1}{2} (u_x^2 + u_y^2 + u_z^2)\n$$\n比总能 $E$（单位质量的总能量）通过总能量密度除以质量密度得到：\n$$\nE = \\frac{\\rho E}{\\rho}\n$$\n比总能是比内能 $e$ 和比动能 $e_k$ 的和。因此，我们可以分离出比内能：\n$$\ne = E - e_k\n$$\n这个 $e$ 值代表了总能量中与气体热状态相关的部分。最后一步，即从 $e$ 求出温度 $T$，则取决于气体模型。\n\n**模型1：量热完全气体**\n\n在量热完全气体中，定容比热 $C_v$ 被假定为一个常数，记为 $\\bar{C}_v$。问题指定 $\\bar{C}_v = 718 \\, \\text{J/(kg·K)}$。比内能定义为 $e(T) = \\int_{0}^{T} C_v(\\theta) \\, d\\theta$。对于此模型，该积分为：\n$$\ne(T) = \\int_{0}^{T} \\bar{C}_v \\, d\\theta = \\bar{C}_v T\n$$\n反解这个线性关系以求得温度 $T_{cp}$ 是一个简单的代数运算：\n$$\nT_{cp} = \\frac{e}{\\bar{C}_v}\n$$\n\n**模型2：热完全气体**\n\n在热完全气体中，$C_v$ 是温度的函数，即 $C_v(T)$。问题提供了一个二次模型：$C_v(T) = a + b T + c T^2$，并给定了系数 $a = 700 \\, \\text{J/(kg·K)}$, $b = 0.1 \\, \\text{J/(kg·K}^2\\text{)}$ 和 $c = 10^{-4} \\, \\text{J/(kg·K}^3\\text{)}$。通过对此表达式积分可得到比内能：\n$$\ne(T) = \\int_{0}^{T} (a + b \\theta + c \\theta^2) \\, d\\theta = a T + \\frac{b}{2} T^2 + \\frac{c}{3} T^3\n$$\n为了从已知的 $e$ 值求出温度 $T_{tp}$，我们必须求解以下关于 $T$ 的三次方程：\n$$\na T + \\frac{b}{2} T^2 + \\frac{c}{3} T^3 - e = 0\n$$\n这是一个一维求根问题。我们定义一个函数 $f(T) = (a T + \\frac{b}{2} T^2 + \\frac{c}{3} T^3) - e$。我们寻找使 $f(T)=0$ 的根 $T$。$e(T)$ 对 $T$ 的导数是 $e'(T) = C_v(T)$。由于系数 $a, b, c$ 均为正，对于任何物理温度 $T > 0$，$C_v(T)$ 都严格为正。这确保了 $e(T)$ 是一个严格单调的函数，从而保证对于任何 $e > 0$ 都存在唯一的正根。一个稳健的区间求根方法，例如布伦特-德克尔方法（Brent-Dekker method），是完成此任务的理想选择。我们建立一个搜索区间 $[T_{min}, T_{max}]$（例如 $[1 \\, \\text{K}, 10000 \\, \\text{K}]$），该区间确定包含根，并且函数在该区间两端异号。\n\n具体实现将处理每个测试用例，首先计算比内能 $e$，然后对量热完全气体模型应用其独特的反解公式，对热完全气体模型应用数值求根程序。所有测试用例的结果随后被收集并按规定格式化。\n\n```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Computes temperature from conservative variables for calorically and thermally\n    perfect gas models.\n    \"\"\"\n    # Define physical and model constants\n    R = 287.0  # Specific gas constant in J/(kg·K)\n    Cv_cp = 718.0  # Specific heat for calorically perfect gas in J/(kg·K)\n    a_tp = 700.0  # Coefficient a for thermally perfect C_v in J/(kg·K)\n    b_tp = 0.1  # Coefficient b for thermally perfect C_v in J/(kg·K^2)\n    c_tp = 1e-4  # Coefficient c for thermally perfect C_v in J/(kg·K^3)\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (rho, m_x, m_y, m_z, rhoE)\n    test_cases = [\n        (1.0, 300.0, 0.0, 0.0, 828333.3333333334),\n        (0.5, 50.0, 0.0, 0.0, 6002.516666666667),\n        (1.2, 0.0, 0.0, 0.0, 2239999.9999999995),\n        (0.8, 160.0, 120.0, 40.0, 513253.3333333334),\n        (1.225, 1225.0, 0.0, 0.0, 876365.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        rho, mx, my, mz, rhoE = case\n\n        # Step 1: Compute velocity vector components\n        ux = mx / rho\n        uy = my / rho\n        uz = mz / rho\n\n        # Step 2: Compute specific kinetic energy (per unit mass)\n        e_kinetic = 0.5 * (ux**2 + uy**2 + uz**2)\n\n        # Step 3: Compute specific total energy (per unit mass)\n        E_total = rhoE / rho\n\n        # Step 4: Compute specific internal energy (per unit mass)\n        e_internal = E_total - e_kinetic\n        \n        # Guard against non-physical negative internal energy.\n        if e_internal = 0:\n            T_cp = 0.0\n            T_tp = 0.0\n        else:\n            # --- Calorically Perfect Gas Model ---\n            # Invert e = Cv_cp * T to find temperature\n            T_cp = e_internal / Cv_cp\n\n            # --- Thermally Perfect Gas Model ---\n            # Define the function whose root we need to find: f(T) = e(T) - e_internal\n            def f_tp(T, e_target):\n                \"\"\"\n                Represents the equation e(T) - e_target = 0 for the thermally perfect gas.\n                e(T) = a*T + (b/2)*T^2 + (c/3)*T^3\n                \"\"\"\n                return (a_tp * T + (b_tp / 2.0) * T**2 + (c_tp / 3.0) * T**3) - e_target\n\n            # Set a wide bracket for the root-finding algorithm to ensure robustness.\n            # Physical temperatures are in Kelvin, so T > 0.\n            T_min_bracket = 1.0\n            T_max_bracket = 10000.0\n\n            # Use SciPy's Brent's method for robust and fast root-finding.\n            # The function e(T) is monotonic for T>0, so a unique root is guaranteed\n            # if the bracket contains it.\n            try:\n                T_tp = optimize.brentq(f_tp, T_min_bracket, T_max_bracket, args=(e_internal,))\n            except ValueError:\n                # This error occurs if f(a) and f(b) have the same sign, meaning\n                # the root is not bracketed. This is not expected for the given problem.\n                T_tp = float('nan')\n\n        results.extend([T_cp, T_tp])\n\n    return f\"[{','.join(map(str, results))}]\"\n\n# The final answer is the output of this script.\n# print(solve())\n```",
            "answer": "[1090.9935004637883,1000.0,9.756314066852367,10.0,2599.8143001392756,2000.0,848.2822656545961,800.0,300.0,300.0]"
        }
    ]
}