{
    "hands_on_practices": [
        {
            "introduction": "A fundamental skill is deriving a particle's path from a given velocity field, which connects the Lagrangian and Eulerian perspectives. This exercise provides practice by having you analytically determine the trajectory of a particle within a steady, rotational flow field. Solving this problem reinforces how a particle's time-dependent position is governed by the spatial structure of the Eulerian velocity .",
            "id": "1769254",
            "problem": "In a microfluidic device, a steady, two-dimensional fluid flow is established to create a miniature vortex. The Eulerian velocity field of this flow in the $xy$-plane is given by $\\vec{v}(x, y) = -\\Omega y \\hat{i} + \\Omega x \\hat{j}$, where $\\Omega$ is a positive constant representing the angular frequency of the fluid's rigid-body-like rotation, and $\\hat{i}$ and $\\hat{j}$ are the unit vectors in the $x$ and $y$ directions, respectively. A small, neutrally buoyant particle is released into this flow and is assumed to act as a passive tracer, meaning its velocity is always identical to the local fluid velocity. At time $t=0$, the particle is located at the initial position $(x_0, y_0) = (L, 0)$, where $L$ is a positive constant.\n\nDetermine the Lagrangian position of the particle, given by its coordinates $(x(t), y(t))$, for any time $t \\geq 0$. Express your answer as a pair of functions for $x(t)$ and $y(t)$ in terms of $L$, $\\Omega$, and $t$.",
            "solution": "Because the particle is a passive tracer, its velocity equals the local fluid velocity. Therefore its Lagrangian coordinates satisfy the system\n$$\\frac{dx}{dt}=-\\Omega y,\\qquad \\frac{dy}{dt}=\\Omega x,$$\nwith initial conditions $x(0)=L$ and $y(0)=0$.\n\nDifferentiate the first equation with respect to $t$ and use the second equation to eliminate $y$:\n$$\\frac{d^{2}x}{dt^{2}}=-\\Omega \\frac{dy}{dt}=-\\Omega(\\Omega x)=-\\Omega^{2}x.$$\nThis is the harmonic oscillator equation with general solution\n$$x(t)=A\\cos(\\Omega t)+B\\sin(\\Omega t).$$\nApply $x(0)=L$ to obtain $A=L$. Next, compute $\\frac{dx}{dt}$:\n$$\\frac{dx}{dt}=-A\\Omega \\sin(\\Omega t)+B\\Omega \\cos(\\Omega t).$$\nUsing $\\frac{dx}{dt}=-\\Omega y$ and $y(0)=0$ gives $\\frac{dx}{dt}\\big|_{t=0}=0$, hence\n$$0=\\frac{dx}{dt}\\big|_{t=0}=B\\Omega \\quad \\Rightarrow \\quad B=0.$$\nThus,\n$$x(t)=L\\cos(\\Omega t).$$\nFrom $\\frac{dy}{dt}=\\Omega x$ and $y(0)=0$,\n$$y(t)=\\int_{0}^{t}\\Omega x(s)\\,ds=\\int_{0}^{t}\\Omega L\\cos(\\Omega s)\\,ds=L\\sin(\\Omega t).$$\nA direct check shows $\\frac{dx}{dt}=-\\Omega y$ and $\\frac{dy}{dt}=\\Omega x$ are satisfied, so the solution is consistent.\n\nTherefore, the Lagrangian position is $\\big(x(t),y(t)\\big)=\\big(L\\cos(\\Omega t),\\,L\\sin(\\Omega t)\\big)$.",
            "answer": "$$\\boxed{\\begin{pmatrix}L\\cos(\\Omega t)  L\\sin(\\Omega t)\\end{pmatrix}}$$"
        },
        {
            "introduction": "While pathlines and streamlines are identical in steady flows, this equivalence breaks down dramatically in unsteady conditions, where a third concept—the streakline—also becomes distinct. This problem challenges you to analytically derive the streakline for a time-dependent pulsating jet, forcing a clear distinction between the trajectory of a single particle (pathline), the instantaneous flow direction (streamline), and the locus of particles released from a single point (streakline). Mastering these distinctions is critical for accurately interpreting flow visualization data in complex, time-varying flows .",
            "id": "4086832",
            "problem": "Consider an incompressible, Newtonian, two-dimensional pulsating jet issuing from a point source at the origin $\\left(x,y\\right)=\\left(0,0\\right)$ into an otherwise quiescent fluid. The Eulerian velocity field is spatially uniform and time-dependent, given by\n$$\nu\\left(x,y,t\\right)=U_{0}\\left[1+\\epsilon \\sin\\left(\\omega t\\right)\\right],\\qquad v\\left(x,y,t\\right)=V_{0}\\cos\\left(\\omega t\\right),\n$$\nwhere $U_{0}0$ is a constant mean axial speed, $0\\epsilon1$ is a nondimensional pulsation amplitude, $\\omega0$ is a pulsation angular frequency, and $V_{0}\\ge 0$ is a constant lateral oscillation amplitude arising from periodic nozzle flapping. Assume the dye is injected continuously at the origin for all $t\\ge 0$.\n\nStarting from first principles of the Lagrangian and Eulerian descriptions of flow, namely that the Lagrangian trajectory $\\left(x\\left(t\\right),y\\left(t\\right)\\right)$ of a fluid particle satisfies\n$$\n\\frac{dx}{dt}=u\\left(x\\left(t\\right),y\\left(t\\right),t\\right),\\qquad \\frac{dy}{dt}=v\\left(x\\left(t\\right),y\\left(t\\right),t\\right),\n$$\nand that an instantaneous Eulerian streamline at time $t^{\\ast}$ is a curve $\\left(x\\left(s\\right),y\\left(s\\right)\\right)$ whose tangent aligns with the velocity at that instant, satisfying\n$$\n\\frac{dy}{dx}=\\frac{v\\left(x,y,t^{\\ast}\\right)}{u\\left(x,y,t^{\\ast}\\right)},\n$$\nperform the following:\n\n- Construct the streakline at observation time $t0$ released from the origin, parameterized by the release time $\\tau\\in\\left[0,t\\right]$, and derive its closed-form expression in terms of $U_{0}$, $\\epsilon$, $\\omega$, $V_{0}$, $t$, and $\\tau$.\n- In your derivation, clearly articulate how the shape of this streakline differs from the pathline of a single fluid particle released at a fixed time and from the instantaneous Eulerian streamline at the same observation time.\n- Express the final streakline as a single parametric vector-valued analytic expression $\\left(x_{s}\\left(\\tau;t\\right),y_{s}\\left(\\tau;t\\right)\\right)$.\n\nNo numerical evaluation is required. Provide your final answer as the single analytic expression for the streakline coordinates. Do not include units. The explanatory comparison of shapes should be included in your solution but not in the final answer.",
            "solution": "The core of the problem is to distinguish between and derive the mathematical expressions for different flow visualization constructs: pathlines, streaklines, and streamlines, in an unsteady velocity field.\n\nA streakline at an observation time $t$ is the locus of all fluid particles that have passed through a specific point (here, the origin $\\left(0,0\\right)$) at some prior time $\\tau$, where $0 \\le \\tau \\le t$. To find the streakline, we must first determine the pathline of a generic particle released from the origin.\n\nLet a fluid particle be released from the origin $\\left(x_0, y_0\\right) = \\left(0,0\\right)$ at time $\\tau$. Its trajectory, or pathline, is given by the position vector $\\mathbf{x}_p(t'; \\tau) = \\left(x_p(t'; \\tau), y_p(t'; \\tau)\\right)$ for times $t' \\ge \\tau$. This trajectory is found by integrating the velocity field with respect to time. The governing ordinary differential equations (ODEs) are given as:\n$$\n\\frac{dx_p}{dt'} = u\\left(x_p, y_p, t'\\right) = U_{0}\\left[1+\\epsilon \\sin\\left(\\omega t'\\right)\\right]\n$$\n$$\n\\frac{dy_p}{dt'} = v\\left(x_p, y_p, t'\\right) = V_{0}\\cos\\left(\\omega t'\\right)\n$$\nwith the initial condition that the particle is at the origin at its release time $\\tau$:\n$$\nx_p(\\tau; \\tau) = 0, \\qquad y_p(\\tau; \\tau) = 0.\n$$\nA crucial feature of the given velocity field is its spatial uniformity; $u$ and $v$ are functions of time $t'$ only. This simplifies the integration, as the velocity of the particle depends only on the instant in time, not its position.\n\nWe integrate the ODEs from the release time $\\tau$ to a later time $t'$:\nFor the $x$-coordinate of the pathline:\n$$\nx_p(t'; \\tau) = \\int_{\\tau}^{t'} U_{0}\\left[1+\\epsilon \\sin\\left(\\omega s\\right)\\right] ds\n$$\n$$\nx_p(t'; \\tau) = U_{0} \\left[s - \\frac{\\epsilon}{\\omega}\\cos(\\omega s)\\right]_{\\tau}^{t'}\n$$\n$$\nx_p(t'; \\tau) = U_{0} \\left[ \\left(t' - \\frac{\\epsilon}{\\omega}\\cos(\\omega t')\\right) - \\left(\\tau - \\frac{\\epsilon}{\\omega}\\cos(\\omega \\tau)\\right) \\right]\n$$\n$$\nx_p(t'; \\tau) = U_{0} \\left( t' - \\tau - \\frac{\\epsilon}{\\omega} \\left[ \\cos(\\omega t') - \\cos(\\omega \\tau) \\right] \\right)\n$$\nFor the $y$-coordinate of the pathline:\n$$\ny_p(t'; \\tau) = \\int_{\\tau}^{t'} V_{0}\\cos\\left(\\omega s\\right) ds\n$$\n$$\ny_p(t'; \\tau) = V_{0} \\left[\\frac{1}{\\omega}\\sin(\\omega s)\\right]_{\\tau}^{t'}\n$$\n$$\ny_p(t'; \\tau) = \\frac{V_{0}}{\\omega} \\left[ \\sin(\\omega t') - \\sin(\\omega \\tau) \\right]\n$$\nThese two equations describe the pathline of a particle released from the origin at time $\\tau$, parameterized by the observation time $t' \\ge \\tau$.\n\nNow, we construct the streakline. The streakline at a specific observation time $t$ is the collection of positions of all particles that were released from the origin at any time $\\tau$ in the interval $\\left[0, t\\right]$. To find the equation for the streakline, we fix the observation time $t'$ to $t$ in the pathline equations and treat the release time $\\tau$ as the parameter for the curve. Thus, the streakline $\\left(x_s(\\tau; t), y_s(\\tau; t)\\right)$ is parameterized by $\\tau \\in \\left[0, t\\right]$.\n\nSetting $t' = t$ in the pathline equations yields the streakline coordinates:\n$$\nx_s(\\tau; t) = U_{0} \\left( t - \\tau - \\frac{\\epsilon}{\\omega} \\left[ \\cos(\\omega t) - \\cos(\\omega \\tau) \\right] \\right)\n$$\n$$\ny_s(\\tau; t) = \\frac{V_{0}}{\\omega} \\left[ \\sin(\\omega t) - \\sin(\\omega \\tau) \\right]\n$$\nThis is the closed-form expression for the streakline at observation time $t$.\n\nAs required, we now articulate the difference between this streakline and both a pathline and a streamline.\n1.  **Pathline**: The pathline is the trajectory of a *single* fluid particle over time. For example, for a particle released at $\\tau=0$, its pathline is given by $\\left(x_p(t'; 0), y_p(t'; 0)\\right)$ where $t'$ is the variable time parameter. A pathline is a time-history of one particle's position.\n2.  **Streakline**: The streakline is an *instantaneous* snapshot at time $t$ showing the positions of *many* different particles, distinguished by their release time $\\tau$. It is a spatial curve formed by all particles that have passed through the origin.\n3.  **Streamline**: A streamline is an *instantaneous* curve that is everywhere tangent to the velocity vector field at a fixed moment in time, say $t^*$. The equation for a streamline is given by integrating $\\frac{dy}{dx} = \\frac{v(x,y,t^*)}{u(x,y,t^*)}$. For this problem:\n    $$\n    \\frac{dy}{dx} = \\frac{V_{0}\\cos\\left(\\omega t^*\\right)}{U_{0}\\left[1+\\epsilon \\sin\\left(\\omega t^*\\right)\\right]}\n    $$\n    Since the right-hand side is a constant for a given $t^*$, the streamlines are a family of straight lines. The streamline passing through the origin $\\left(0,0\\right)$ at time $t^*$ is the line $y = \\left(\\frac{v(t^*)}{u(t^*)}\\right) x$.\n\nIn summary, for this unsteady flow:\n-   A **streamline** at time $t$ is a straight line through the origin whose slope changes with time.\n-   A **pathline** is the generally curved path traced by an individual fluid particle over a period of time.\n-   A **streakline** is the generally curved shape of the \"dye\" or \"smoke\" filament at a single instant $t$, composed of particles released at different past times.\n\nBecause the velocity field is time-dependent (unsteady), these three curves are distinct. They would only coincide if the flow were steady (i.e., if $\\epsilon=0$ and $V_0=0$). The derived expression for the streakline is a complex parametric curve, clearly different from the straight-line shape of the instantaneous streamlines.\n\nThe final answer is the vector-valued expression for the streakline coordinates.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nU_{0} \\left( t - \\tau - \\frac{\\epsilon}{\\omega} \\left( \\cos(\\omega t) - \\cos(\\omega \\tau) \\right) \\right)  \\frac{V_{0}}{\\omega} \\left( \\sin(\\omega t) - \\sin(\\omega \\tau) \\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "We now transition from analytical exercises to computational practice, the cornerstone of modern CFD. This problem asks you to numerically investigate the motion of a particle in a highly unsteady flow field representing a moving shock wave. By comparing the true Lagrangian pathline with a trajectory based on a 'frozen' Eulerian field, you will quantify the significant errors that can arise from applying steady-flow assumptions to unsteady phenomena, a crucial lesson in aerospace applications .",
            "id": "3957480",
            "problem": "You are given a one-dimensional, time-dependent velocity field representing a smoothed, translating shock wave. The field is specified by the function $$v(x,t) = u_R + \\frac{u_L - u_R}{2}\\left(1 - \\tanh\\left(\\frac{x - x_s(t)}{\\epsilon}\\right)\\right)$$ with the shock position $$x_s(t) = x_{s0} + s\\,t$$ where $x$ is position in meters, $t$ is time in seconds, $u_L$ is the upstream velocity in meters per second, $u_R$ is the downstream velocity in meters per second, $s$ is the shock speed in meters per second, $\\epsilon$ is the shock thickness in meters, and $x_{s0}$ is the initial shock position in meters. This profile transitions smoothly from $u_L$ upstream to $u_R$ downstream across a thickness of order $\\epsilon$ and propagates at speed $s$.\n\nYour task is to numerically generate and compare the Lagrangian pathline and an Eulerian frozen-field streamline-based trajectory originating from the same seed position at an initial time. For an initial position $x_0$ at initial time $t_0$, define:\n- The Lagrangian pathline $x_{\\mathrm{p}}(t)$ as the solution of the ordinary differential equation $$\\frac{dx}{dt} = v(x,t), \\quad x(t_0) = x_0.$$\n- The Eulerian frozen-field trajectory $x_{\\mathrm{f}}(t)$ as the solution of the ordinary differential equation $$\\frac{dx}{dt} = v(x,t_0), \\quad x(t_0) = x_0,$$ which advances the particle under the instantaneous velocity field at $t_0$ held fixed in time. In steadily varying flows this trajectory coincides with the streamline-based prediction.\n\nYou must compute the discrepancy at a specified final time $t_1$ given by the absolute separation $$D = \\left|x_{\\mathrm{p}}(t_1) - x_{\\mathrm{f}}(t_1)\\right|.$$ The numerical integration must use a deterministic, explicit fourth-order Runge–Kutta (RK) method with a fixed time step chosen based on a physically motivated criterion to adequately resolve shock motion and steep gradients. All distances must be reported in meters.\n\nImplement the following for each test case:\n1. Define the velocity field parameters $u_L$, $u_R$, $s$, $\\epsilon$, $x_{s0}$, and initial–final times $t_0$, $t_1$, and the seed position $x_0$.\n2. Integrate the two ordinary differential equations for $x_{\\mathrm{p}}(t)$ and $x_{\\mathrm{f}}(t)$ from $t=t_0$ to $t=t_1$.\n3. Compute the discrepancy $D$ in meters.\n4. Return the discrepancy as a floating-point number, computed to at least six decimal places.\n\nUse the following test suite of parameter values (all quantities are in the units specified above):\n- Case $1$: $u_L = 600$, $u_R = 200$, $s = 400$, $\\epsilon = 0.05$, $x_{s0} = 0$, $t_0 = 0$, $t_1 = 0.002$, $x_0 = -0.02$.\n- Case $2$: $u_L = 600$, $u_R = 200$, $s = 400$, $\\epsilon = 0.005$, $x_{s0} = 0$, $t_0 = 0$, $t_1 = 0.002$, $x_0 = -0.01$.\n- Case $3$: $u_L = 600$, $u_R = 200$, $s = 400$, $\\epsilon = 0.05$, $x_{s0} = 0$, $t_0 = 0$, $t_1 = 0.002$, $x_0 = 0.05$.\n- Case $4$: $u_L = 600$, $u_R = 200$, $s = 0$, $\\epsilon = 0.05$, $x_{s0} = 0$, $t_0 = 0$, $t_1 = 0.002$, $x_0 = -0.02$.\n- Case $5$: $u_L = 500$, $u_R = 150$, $s = -300$, $\\epsilon = 0.02$, $x_{s0} = 0.1$, $t_0 = 0$, $t_1 = 0.003$, $x_0 = 0.12$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above, for example, $$[D_1,D_2,D_3,D_4,D_5]$$ where each $D_i$ is a floating-point number in meters with at least six decimal places accuracy. Angles are not used in this problem. Percentages are not used in this problem. The output must be unitless numerically but corresponds to meters as specified.",
            "solution": "The core distinction between the Eulerian and Lagrangian descriptions of flow arises from the way one accounts for time dependence in the velocity field. In the Lagrangian description, a material point moves with the local velocity, which mathematically is encoded by the ordinary differential equation $$\\frac{dx}{dt} = v(x,t),$$ subject to an initial condition $x(t_0) = x_0$. This equation is a statement of kinematics: the velocity $v$ is the time derivative of the particle position. In the Eulerian description, one focuses on the velocity field at fixed times, and a streamline is the curve that is everywhere tangent to the instantaneous velocity field. In two or more spatial dimensions, the streamline at time $t_0$ satisfies a spatial differential equation with respect to an arclength parameter, but in one dimension the streamline degenerates to a trivial notion. To compare with a trajectory, a common Eulerian proxy is the frozen-field assumption, where one advances the particle using the velocity field held fixed at $t_0$, resulting in the ordinary differential equation $$\\frac{dx}{dt} = v(x,t_0), \\quad x(t_0) = x_0.$$\n\nIn unsteady flows, especially those with waves or shocks, the frozen-field trajectory generally deviates from the true pathline because the material derivative introduces contributions from explicit time dependence. The material derivative of the velocity is given by $$\\frac{D v}{D t} = \\frac{\\partial v}{\\partial t} + v \\frac{\\partial v}{\\partial x},$$ and when $\\partial v / \\partial t \\neq 0$ due to a moving shock, the pathline incorporates the wave propagation dynamics, whereas the frozen-field trajectory does not. In the present setup, the one-dimensional velocity field is specified by $$v(x,t) = u_R + \\frac{u_L - u_R}{2}\\left(1 - \\tanh\\left(\\frac{x - x_s(t)}{\\epsilon}\\right)\\right), \\quad x_s(t) = x_{s0} + s\\,t.$$ This is a smooth traveling wave that transitions from $u_L$ to $u_R$ across a thickness of order $\\epsilon$ and translates at speed $s$. When $s \\neq 0$, the explicit time dependence is large where the gradient is steep, that is near $x \\approx x_s(t)$, and discrepancies between the Lagrangian pathline and the frozen-field trajectory are expected to be significant.\n\nAlgorithmic design follows from these principles. For each test case, we compute two trajectories starting at $x(t_0) = x_0$:\n- The Lagrangian pathline $x_{\\mathrm{p}}(t)$ by numerically integrating $$\\frac{dx}{dt} = f_{\\mathrm{p}}(x,t) := v(x,t),$$\n- The Eulerian frozen-field trajectory $x_{\\mathrm{f}}(t)$ by numerically integrating $$\\frac{dx}{dt} = f_{\\mathrm{f}}(x,t) := v(x,t_0),$$ which is a non-autonomous equation reduced to an autonomous one because the right-hand side is time-independent.\n\nA robust, explicit integrator is the classical fourth-order Runge–Kutta method (Runge–Kutta (RK)), which advances the solution from $t$ to $t+\\Delta t$ by computing staged slopes $$\\begin{aligned} \nk_1 = f(x,t),\\\\\nk_2 = f\\!\\left(x + \\frac{\\Delta t}{2}k_1,\\, t + \\frac{\\Delta t}{2}\\right),\\\\\nk_3 = f\\!\\left(x + \\frac{\\Delta t}{2}k_2,\\, t + \\frac{\\Delta t}{2}\\right),\\\\\nk_4 = f\\!\\left(x + \\Delta t\\,k_3,\\, t + \\Delta t\\right),\n\\end{aligned}$$ and updating $$x \\leftarrow x + \\frac{\\Delta t}{6}\\left(k_1 + 2 k_2 + 2 k_3 + k_4\\right).$$ For the frozen-field trajectory $f_{\\mathrm{f}}$ there is no explicit time dependence, so $k_2$, $k_3$, and $k_4$ evaluate $f$ at the same fixed time-level field $v(\\cdot,t_0)$.\n\nTo ensure resolution of steep gradients near the shock, the time step $\\Delta t$ should be chosen consistent with a Courant–Friedrichs–Lewy (CFL) type criterion that limits the spatial advance per step relative to the shock thickness. A simple deterministic choice is $$\\Delta t = \\min\\left(\\Delta t_{\\mathrm{base}},\\, C \\frac{\\epsilon}{U_{\\max}}\\right),$$ where $\\Delta t_{\\mathrm{base}}$ is a small baseline step, $C$ is a safety coefficient, and $U_{\\max}$ is a bound on characteristic speeds, which can be taken as $$U_{\\max} = \\max\\left(\\left|u_L\\right|,\\,\\left|u_R\\right|,\\,\\left|s\\right|\\right).$$ This selection ensures that the particle does not cross a significant fraction of the shock thickness in one step, thus controlling local truncation error and enabling accurate capture of the shock-induced time dependence. We use a fixed $\\Delta t$ for each case to maintain determinism.\n\nFor each test case, we integrate from $t=t_0$ to $t=t_1$ using the above RK scheme for both $x_{\\mathrm{p}}(t)$ and $x_{\\mathrm{f}}(t)$ and compute the discrepancy $$D = \\left|x_{\\mathrm{p}}(t_1) - x_{\\mathrm{f}}(t_1)\\right|.$$ The output is a list $\\left[D_1, D_2, D_3, D_4, D_5\\right]$ in meters. Interpretation of the discrepancies is grounded in wave propagation: when $s \\neq 0$ and $\\epsilon$ is small, the velocity field changes rapidly near $x_s(t)$, causing $\\partial v/\\partial t$ to be significant and the Lagrangian pathline to differ substantially from a trajectory generated by freezing the field at $t_0$. Conversely, a stationary shock with $s=0$ reduces explicit time dependence, which should yield much smaller discrepancies. Seeds placed far downstream of the shock transition also experience weaker gradients and correspondingly smaller differences.\n\nThe provided test suite explores these facets:\n- Case $1$ is a \"happy path\" with a moderate thickness $\\epsilon$ and a right-moving shock, with the seed upstream; discrepancy is expected to be noticeable.\n- Case $2$ tightens the shock thickness $\\epsilon$, increasing gradients and amplifying the discrepancy.\n- Case $3$ places the seed downstream, where gradients are weaker and discrepancy should be smaller relative to upstream placement.\n- Case $4$ sets a stationary shock with $s=0$, acting as a boundary case where the frozen-field and Lagrangian evolutions should be closer.\n- Case $5$ considers a left-moving shock ($s0$) with different upstream and downstream speeds, acting as an edge case testing the sign of shock propagation and sensitivity near the shock.\n\nAll computed values are distances expressed in meters, as required. The final program deterministically integrates these cases and prints a single line in the prescribed format.",
            "answer": "```python\nimport numpy as np\n\n# Velocity field for a smoothed moving shock:\n# v(x,t) = u_R + 0.5*(u_L - u_R) * (1 - tanh((x - x_s(t))/epsilon))\n# with x_s(t) = x_s0 + s * t\ndef velocity(x, t, params):\n    u_L = params[\"u_L\"]\n    u_R = params[\"u_R\"]\n    s = params[\"s\"]\n    eps = params[\"epsilon\"]\n    x_s0 = params[\"x_s0\"]\n    x_s_t = x_s0 + s * t\n    xi = (x - x_s_t) / eps\n    return u_R + 0.5 * (u_L - u_R) * (1.0 - np.tanh(xi))\n\n# Classical explicit RK4 step for dx/dt = f(x,t)\ndef rk4_step(f, x, t, dt):\n    k1 = f(x, t)\n    k2 = f(x + 0.5 * dt * k1, t + 0.5 * dt)\n    k3 = f(x + 0.5 * dt * k2, t + 0.5 * dt)\n    k4 = f(x + dt * k3, t + dt)\n    return x + (dt / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n\n# Integrate from t0 to t1 with fixed dt using RK4\ndef integrate_pathline(x0, t0, t1, params, dt):\n    # f(x,t) = v(x,t)\n    def f(x, t):\n        return velocity(x, t, params)\n    x = x0\n    t = t0\n    # number of steps with adjustment for final step\n    total_time = t1 - t0\n    if total_time = 0.0:\n        return x0\n    n_steps = int(np.floor(total_time / dt))\n    remainder = total_time - n_steps * dt\n    for _ in range(n_steps):\n        x = rk4_step(f, x, t, dt)\n        t += dt\n    if remainder > 0.0:\n        x = rk4_step(f, x, t, remainder)\n        t += remainder\n    return x\n\ndef integrate_frozen(x0, t0, t1, params, dt):\n    # f_frozen(x) = v(x, t0), held fixed in time\n    def f(x, t):\n        # ignore t in evaluation, but keep signature for RK4\n        return velocity(x, t0, params)\n    x = x0\n    t = t0\n    total_time = t1 - t0\n    if total_time = 0.0:\n        return x0\n    n_steps = int(np.floor(total_time / dt))\n    remainder = total_time - n_steps * dt\n    for _ in range(n_steps):\n        x = rk4_step(f, x, t, dt)\n        t += dt\n    if remainder > 0.0:\n        x = rk4_step(f, x, t, remainder)\n        t += remainder\n    return x\n\ndef choose_dt(params, dt_base=1e-5, safety=0.2):\n    # CFL-like choice: dt = min(dt_base, safety * epsilon / Umax)\n    u_L = abs(params[\"u_L\"])\n    u_R = abs(params[\"u_R\"])\n    s = abs(params[\"s\"])\n    eps = params[\"epsilon\"]\n    Umax = max(u_L, u_R, s, 1e-12)\n    return min(dt_base, safety * eps / Umax)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a dict with fields as specified.\n    test_cases = [\n        # Case 1\n        {\n            \"u_L\": 600.0, \"u_R\": 200.0, \"s\": 400.0, \"epsilon\": 0.05,\n            \"x_s0\": 0.0, \"t0\": 0.0, \"t1\": 0.002, \"x0\": -0.02\n        },\n        # Case 2\n        {\n            \"u_L\": 600.0, \"u_R\": 200.0, \"s\": 400.0, \"epsilon\": 0.005,\n            \"x_s0\": 0.0, \"t0\": 0.0, \"t1\": 0.002, \"x0\": -0.01\n        },\n        # Case 3\n        {\n            \"u_L\": 600.0, \"u_R\": 200.0, \"s\": 400.0, \"epsilon\": 0.05,\n            \"x_s0\": 0.0, \"t0\": 0.0, \"t1\": 0.002, \"x0\": 0.05\n        },\n        # Case 4\n        {\n            \"u_L\": 600.0, \"u_R\": 200.0, \"s\": 0.0, \"epsilon\": 0.05,\n            \"x_s0\": 0.0, \"t0\": 0.0, \"t1\": 0.002, \"x0\": -0.02\n        },\n        # Case 5\n        {\n            \"u_L\": 500.0, \"u_R\": 150.0, \"s\": -300.0, \"epsilon\": 0.02,\n            \"x_s0\": 0.1, \"t0\": 0.0, \"t1\": 0.003, \"x0\": 0.12\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Choose a deterministic dt per case based on epsilon and speeds.\n        dt = choose_dt(case, dt_base=1e-5, safety=0.2)\n        x_p = integrate_pathline(case[\"x0\"], case[\"t0\"], case[\"t1\"], case, dt)\n        x_f = integrate_frozen(case[\"x0\"], case[\"t0\"], case[\"t1\"], case, dt)\n        D = abs(x_p - x_f)  # discrepancy in meters\n        results.append(f\"{D:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}