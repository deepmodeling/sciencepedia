{
    "hands_on_practices": [
        {
            "introduction": "为了从根本上理解CFL条件，我们首先从最简单的一维线性平流问题入手。这个练习将CFL条件追溯到其核心——因果关系原理。它要求我们从“依赖域”这一基本概念出发，推导出显式格式的时间步长限制，从而揭示出著名的Courant数 $C$ 的物理本质，即物理信息传播速度与数值信息传播速度之比。通过这个基础练习 ，你将建立起对CFL条件为何是数值稳定性的必要条件的直观认识。",
            "id": "3952418",
            "problem": "考虑无粘可压缩流中小扰动的一维双曲输运，其由线性平流方程 $\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$ 建模。这里，$u(x,t)$ 代表一个守恒的输运量，$a$ 是一个与信息传播相关的恒定特征速度。在一个间距为 $\\Delta x$ 的均匀网格上，采用显式单步守恒有限体积法，一个时间步内的数值更新仅使用紧邻的上游状态和局部状态（最近邻格式）。在这种情况下，为了保证稳定性，Courant–Friedrichs–Lewy (CFL) 条件要求库朗数 $C$ 满足 $C \\le 1$。\n\n从控制方程和信息传播的特征线解释出发，为所述的显式最近邻格式推导保证稳定性的最大允许时间步长 $\\Delta t_{\\max}$ 的界限，将 $\\Delta t_{\\max}$ 表示为 $a$ 和 $\\Delta x$ 的闭式解形式，且不使用任何快捷公式。然后，使用具体参数 $a = 460\\,\\mathrm{m/s}$ 和 $\\Delta x = 0.035\\,\\mathrm{m}$ 计算 $\\Delta t_{\\max}$。将您的数值结果四舍五入到四位有效数字，并以秒为单位表示最终答案。最后，从计算流体动力学 (CFD) 中信息传播的角度，对该界限提供一个简洁的物理解释，并说明它如何将物理依赖域与数值依赖域联系起来。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、适定且客观的。它包含一套完整且一致的给定条件，可以进行逻辑严谨的求解。\n\n该问题要求针对一个特定的数值格式推导最大允许时间步长 $\\Delta t_{\\max}$，对该界限进行数值计算，并基于 Courant–Friedrichs–Lewy (CFL) 条件给出物理解释。\n\n控制方程是一维线性平流方程：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\n其中 $u(x,t)$ 是输运量，$a$ 是恒定的传播速度。\n\n这是一个双曲型偏微分方程。其解可以通过分析特征线来理解。特征线是 $(x,t)$ 平面中的一条路径，在该路径上解 $u$ 是恒定的。这些曲线的斜率由 $\\frac{dx}{dt} = a$ 给出。对其积分可得到特征线的方程：$x - at = \\text{constant}$。这意味着点 $(x_p, t_p)$ 处的解 $u$ 的值由其在较早时刻 $t_0  t_p$ 位于点 $x_0 = x_p - a(t_p - t_0)$ 的值确定。相对于时间切片 $t_0$，点 $x_0$ 构成了点 $(x_p, t_p)$ 的*物理依赖域*。\n\n现在，我们考虑数值离散化。我们有一个空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格。一个网格点表示为 $(x_i, t_n)$，其中 $x_i = i\\Delta x$ 且 $t_n = n\\Delta t$。该数值格式是显式的，意味着在时间 $t_{n+1} = t_n + \\Delta t$ 的解是使用时间 $t_n$ 的已知值计算的。问题陈述该格式使用最近邻格式，涉及局部状态 ($x_i$) 和紧邻的上游状态。\n\n“上游”方向取决于传播速度 $a$ 的符号。\n情况 1：$a > 0$。信息沿 $x$ 轴正方向传播。流动方向从左到右。相对于单元 $i$ 的上游单元是单元 $i-1$。因此，用于计算更新值 $u_i^{n+1}$（即 $u(x_i, t_{n+1})$ 的近似值）的数值格式使用了值 $u_{i-1}^n$ 和 $u_i^n$。在时间 $t_n$ 影响点 $(x_i, t_{n+1})$ 处解的网格点集合是 $\\{x_{i-1}, x_i\\}$。与这些点对应的连续区间 $[x_{i-1}, x_i]$ 即为*数值依赖域*。\n\nCourant–Friedrichs–Lewy (CFL) 条件是双曲型偏微分方程显式数值方法稳定性的一个必要条件。它指出，为使数值解稳定并收敛到真实解，偏微分方程的物理依赖域必须被包含在数值格式的数值依赖域之内。\n\n对我们的问题而言，这意味着在时间 $t_n$ 决定了点 $(x_i, t_{n+1})$ 处真实解的物理点 $x_0 = x_i - a\\Delta t$ 必须位于数值依赖域 $[x_{i-1}, x_i]$ 之内。\n在数学上，这表示为：\n$$\nx_{i-1} \\le x_i - a\\Delta t \\le x_i\n$$\n代入 $x_{i-1} = x_i - \\Delta x$，我们得到：\n$$\nx_i - \\Delta x \\le x_i - a\\Delta t \\le x_i\n$$\n这个不等式可以分为两部分：\n1. $x_i - a\\Delta t \\le x_i \\implies -a\\Delta t \\le 0 \\implies a\\Delta t \\ge 0$。因为 $a > 0$ 且 $\\Delta t > 0$，这个条件总是满足的。\n2. $x_i - \\Delta x \\le x_i - a\\Delta t \\implies -\\Delta x \\le -a\\Delta t$。两边乘以 $-1$ 并反转不等号，得到 $a\\Delta t \\le \\Delta x$。\n\n这就导出了关于时间步长的稳定性约束：\n$$\n\\Delta t \\le \\frac{\\Delta x}{a}\n$$\n尽管问题没有要求，但如果我们考虑情况 2：$a  0$，信息将沿 $x$ 轴负方向传播，上游邻居将位于 $x_{i+1}$。数值依赖域将是 $[x_i, x_{i+1}]$。CFL 条件将是 $x_i \\le x_i - a\\Delta t \\le x_{i+1}$，可简化为 $\\Delta t \\le \\frac{\\Delta x}{-a} = \\frac{\\Delta x}{|a|}$。\n因此，对于任何非零的 $a$，一般条件是 $\\Delta t \\le \\frac{\\Delta x}{|a|}$。\n\n问题将库朗数定义为 $C \\le 1$。库朗数的定义是 $C = \\frac{|a| \\Delta t}{\\Delta x}$。我们推导出的条件 $\\Delta t \\le \\frac{\\Delta x}{|a|}$ 等价于 $\\frac{|a| \\Delta t}{\\Delta x} \\le 1$，即 $C \\le 1$，这是一致的。\n\n最大允许时间步长 $\\Delta t_{\\max}$ 是在该条件极限处满足的 $\\Delta t$ 值：\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|a|}\n$$\n鉴于问题给出的 $a$ 是正值，我们可以写成：\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{a}\n$$\n这就完成了最大允许时间步长闭式表达式的推导。\n\n接下来，我们用给定的参数 $a = 460\\,\\mathrm{m/s}$ 和 $\\Delta x = 0.035\\,\\mathrm{m}$ 来计算 $\\Delta t_{\\max}$。\n$$\n\\Delta t_{\\max} = \\frac{0.035\\,\\mathrm{m}}{460\\,\\mathrm{m/s}}\n$$\n$$\n\\Delta t_{\\max} = 0.000076086956... \\,\\mathrm{s}\n$$\n问题要求将数值结果四舍五入到四位有效数字。\n$$\n\\Delta t_{\\max} \\approx 0.00007609 \\,\\mathrm{s}\n$$\n用科学记数法表示，即为 $7.609 \\times 10^{-5}\\,\\mathrm{s}$。\n\n最后，我们提供物理解释。\n量 $\\tau = \\frac{\\Delta x}{a}$ 代表了一个以速度 $a$ 传播的物理扰动传播一个网格单元宽度 $\\Delta x$ 所需的时间。因此，稳定性条件 $\\Delta t \\le \\Delta t_{\\max} = \\frac{\\Delta x}{a}$ 有一个清晰的物理意义：数值时间步长 $\\Delta t$ 必须小于或等于信息物理上传播一个网格单元所需的时间。如果时间步长大于这个值（$\\Delta t > \\frac{\\Delta x}{a}$），一个扰动可能在一个单元内产生，并在一个时间步内传播过下一个单元的节点。一个只使用相邻单元信息来更新节点的显式最近邻格式将完全错过这个信息。数值算法将试图在无法获取实际决定未来状态的物理数据的情况下计算该点的未来状态，从而导致误差的快速、无界增长，即数值不稳定性。\n\n这通过物理依赖域和数值依赖域之间的关系得以形式化。如上所述，CFL 条件要求物理依赖域（在时间 $t_n$ 的点 $x_i - a\\Delta t$）必须被包含在数值格式的依赖域（对于 $a>0$，在时间 $t_n$ 的区间 $[x_{i-1}, x_i]$）之内。这确保了数值方法能够获取所有必要的物理信息来正确计算解的演化。本质上，CFL 条件保证了数值信息的传播速度（$\\frac{\\Delta x}{\\Delta t}$）至少与物理信息的传播速度（$a$）一样快。",
            "answer": "$$ \\boxed{7.609 \\times 10^{-5}} $$"
        },
        {
            "introduction": "在掌握了线性标量问题的基本原理后，我们将注意力转向在航空航天领域中更为实际的欧拉方程组。与单一传播速度的简单平流不同，可压缩流体中的信息是通过具有不同速度的波（即特征波）传播的。为了维持数值稳定性，时间步长必须受到最快的波速，即$|u|+c$的限制。这个练习  旨在让你将CFL条件应用于双曲方程组，这需要根据给定的热力学状态计算局部声速和流速，是进行真实气体动力学模拟的关键一步。",
            "id": "3952482",
            "problem": "直管道中的一维无粘性可压缩气流，在均匀网格上使用显式有限体积法进行时间推进。在某个特定的单元中心，测得当地马赫数为 $M = 2.3$，静温为 $T = 700\\,\\mathrm{K}$，网格间距为 $\\Delta x = 2.5\\times 10^{-3}\\,\\mathrm{m}$。该气体可被视为量热完全气体，其比热比为 $\\gamma = 1.4$，特定气体常数为 $R = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$。库朗-弗里德里希斯-列维（Courant–Friedrichs–Lewy，CFL）数设置为 $\\nu = 0.8$。从一维可压缩欧拉方程出发，并根据数值依赖域必须包含物理依赖域的要求，确定在此位置为保持显式更新的稳定性所允许的最大时间步长 $\\Delta t$。使用马赫数的定义 $M = |u|/c$ 和理想气体声速关系式 $c^2 = \\gamma R T$。以微秒为单位表示你最终的 $\\Delta t$，并将答案四舍五入到四位有效数字。",
            "solution": "首先验证问题陈述，以确保其科学基础坚实、提法恰当且信息完整。\n\n**第一步：提取已知条件**\n- 流动类型：一维无粘性可压缩气流\n- 数值方法：均匀网格上的显式有限体积法\n- 当地马赫数：$M = 2.3$\n- 静温：$T = 700\\,\\mathrm{K}$\n- 网格间距：$\\Delta x = 2.5\\times 10^{-3}\\,\\mathrm{m}$\n- 气体模型：量热完全气体\n- 比热比：$\\gamma = 1.4$\n- 特定气体常数：$R = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n- 库朗-弗里德里希斯-列维（Courant–Friedrichs–Lewy, CFL）数：$\\nu = 0.8$\n- 控制方程：一维可压缩欧拉方程\n- 稳定性原则：数值依赖域必须包含物理依赖域。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它涉及库朗-弗里德里希斯-列维（CFL）稳定性条件，这是求解双曲型偏微分方程（如航空航天CFD中使用的欧拉方程）数值解的一个基本概念。所提供的温度、马赫数、网格间距和气体属性值对于高速可压缩流动场景是物理上现实的。问题提法恰当，提供了计算时间步长所需的所有必要数据。术语精确客观，没有矛盾或含糊之处。\n\n**第三步：结论与行动**\n问题被判定为有效。将推导解答。\n\n该问题要求确定由库朗-弗里德里希斯-列维（CFL）条件控制的显式数值格式所允许的最大时间步长 $\\Delta t$。CFL条件是应用于双曲型偏微分方程的显式时间积分方法的必要稳定性判据。它确保了网格点的数值依赖域包含物理依赖域。\n\n对于一维欧拉方程，代表信息传播速度的特征速度由系统雅可比矩阵的特征值给出。这些特征值为 $\\lambda_1 = u$、$\\lambda_2 = u+c$ 和 $\\lambda_3 = u-c$，其中 $u$ 是流体速度，$c$ 是当地声速。信息在域中传播的最快速度是这些特征速度的最大绝对值，即 $\\max\\left(|\\lambda_i|\\right) = |u| + c$。\n\nCFL条件指出，在单个时间步长 $\\Delta t$ 内，移动最快的波传播的距离必须小于或等于网格间距 $\\Delta x$。这表示为：\n$$ (|u|+c)\\Delta t \\le \\Delta x $$\n库朗数，或CFL数，$\\nu$，定义为该距离与网格间距之比：\n$$ \\nu = \\frac{(|u|+c)\\Delta t}{\\Delta x} $$\n为保证稳定性，CFL数必须小于或等于一个与格式相关的极限值，对于一维问题，该值通常为 $\\nu \\le 1$。问题指定使用一个实际的CFL数 $\\nu = 0.8$。通过将表达式设为等式，可以找到允许的最大时间步长 $\\Delta t$：\n$$ \\Delta t = \\frac{\\nu \\Delta x}{|u|+c} $$\n为了计算 $\\Delta t$，我们必须首先确定当地声速 $c$ 和流体速度大小 $|u|$ 的值。\n\n首先，我们使用所提供的理想气体关系式计算声速 $c$：\n$$ c = \\sqrt{\\gamma R T} $$\n代入给定值：$\\gamma = 1.4$，$R = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$ 和 $T = 700\\,\\mathrm{K}$。\n$$ c = \\sqrt{1.4 \\times 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} \\times 700\\,\\mathrm{K}} = \\sqrt{281260\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}} $$\n$$ c \\approx 530.3395\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\n接下来，我们使用马赫数的定义 $M = |u|/c$ 计算流体速度大小 $|u|$：\n$$ |u| = M \\times c $$\n代入给定的马赫数 $M = 2.3$ 和计算出的声速 $c$：\n$$ |u| = 2.3 \\times 530.3395\\,\\mathrm{m}\\,\\mathrm{s}^{-1} \\approx 1219.7809\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\n现在我们可以将 $|u|$、$c$、$\\nu$ 和 $\\Delta x$ 的值代入 $\\Delta t$ 的方程中。也可以通过注意到 $|u|+c = Mc+c = c(M+1)$ 来进行更直接的符号代换：\n$$ \\Delta t = \\frac{\\nu \\Delta x}{c(M+1)} $$\n将给定的数值代入此表达式：\n- $\\nu = 0.8$\n- $\\Delta x = 2.5 \\times 10^{-3}\\,\\mathrm{m}$\n- $M = 2.3$\n- $c \\approx 530.3395\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n$$ \\Delta t = \\frac{0.8 \\times (2.5 \\times 10^{-3}\\,\\mathrm{m})}{(530.3395\\,\\mathrm{m}\\,\\mathrm{s}^{-1})(2.3+1)} = \\frac{2.0 \\times 10^{-3}\\,\\mathrm{m}}{(530.3395\\,\\mathrm{m}\\,\\mathrm{s}^{-1})(3.3)} $$\n$$ \\Delta t = \\frac{2.0 \\times 10^{-3}\\,\\mathrm{m}}{1750.1204\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} \\approx 1.142779 \\times 10^{-6}\\,\\mathrm{s} $$\n问题要求以微秒（$\\mu\\mathrm{s}$）为单位表示答案，并四舍五入到四位有效数字。\n$$ 1\\,\\mathrm{s} = 10^6\\,\\mu\\mathrm{s} $$\n$$ \\Delta t \\approx (1.142779 \\times 10^{-6}) \\times 10^6\\,\\mu\\mathrm{s} = 1.142779\\,\\mu\\mathrm{s} $$\n四舍五入到四位有效数字，我们得到：\n$$ \\Delta t \\approx 1.143\\,\\mu\\mathrm{s} $$\n这是在指定位置为保持显式数值更新的稳定性所允许的最大时间步长。",
            "answer": "$$\n\\boxed{1.143}\n$$"
        },
        {
            "introduction": "真实的航空航天流动几乎总是涉及粘性效应，这引入了一种性质截然不同的稳定性约束。与依赖于$1/\\Delta x$的对流项不同，由粘性等物理过程产生的扩散项的时间步长限制与$1/(\\Delta x)^2$成正比。这个练习  揭示了在CFD实践中一个至关重要且常常起决定性作用的限制，特别是在使用高深宽比网格解析边界层时。通过分析这个问题，你将理解为何显式格式在求解壁面解析的粘性流问题时计算成本会急剧增加，并认识到发展隐式格式等高级算法的必要性。",
            "id": "3952452",
            "problem": "考虑一个用于求解可压缩纳维-斯托克斯方程的显式时间推进计算流体动力学(CFD)求解器，其中粘性项采用二阶中心差分格式，时间积分采用前向欧拉法。\n\n重点关注由扩散的 Courant–Friedrichs–Lewy (CFL) 条件所引申出的粘性稳定性约束。假设动力粘度 $\\mu$ 和密度 $\\rho$ 为常数，因此运动粘度为 $\\nu = \\mu / \\rho$。忽略热扩散以及粘度的任何空间变化。\n\n给定一个光滑壁面附近的边界层解析、高度各向异性的网格。设局部正交坐标为 $n$ (壁面法向)、$s$ (流向) 和 $z$ (展向)。在壁面附近，网格间距为：\n- $\\Delta n_{\\mathrm{w}} = 1.0 \\times 10^{-6}\\ \\mathrm{m}$，\n- $\\Delta s_{\\mathrm{w}} = 1.0 \\times 10^{-3}\\ \\mathrm{m}$，\n- $\\Delta z_{\\mathrm{w}} = 5.0 \\times 10^{-4}\\ \\mathrm{m}$。\n\n在外层，远离壁面的区域，网格间距为：\n- $\\Delta n_{\\mathrm{o}} = 5.0 \\times 10^{-4}\\ \\mathrm{m}$，\n- $\\Delta s_{\\mathrm{o}} = 2.0 \\times 10^{-2}\\ \\mathrm{m}$，\n- $\\Delta z_{\\mathrm{o}} = 1.0 \\times 10^{-2}\\ \\mathrm{m}$。\n\n空气物性（假定在关心区域内是均匀的）为：\n- $\\mu = 1.8 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}$，\n- $\\rho = 1.2\\ \\mathrm{kg/m^3}$。\n\n从动量控制方程中的扩散项及其在笛卡尔网格上的半离散形式出发，使用 von Neumann 稳定性分析，推导在前向欧拉时间积分下，一般各向异性网格 $(\\Delta n, \\Delta s, \\Delta z)$ 上的显式粘性时间步长约束。然后，利用给定的数值，计算壁面处的最大稳定粘性时间步长 $\\Delta t_{\\mathrm{visc},\\mathrm{w}}$ 和外层的最大稳定粘性时间步长 $\\Delta t_{\\mathrm{visc},\\mathrm{o}}$。最后，计算比值\n$$R = \\frac{\\Delta t_{\\mathrm{visc},\\mathrm{w}}}{\\Delta t_{\\mathrm{visc},\\mathrm{o}}}.$$\n\n根据你的推导，从物理上解释为什么在具有极端宽高比的边界层解析网格中，壁面附近的粘性 CFL 约束特别严苛。\n\n将 $R$ 的最终数值答案四舍五入到四位有效数字。最终答案以纯数（无量纲）形式表示。",
            "solution": "首先验证问题，以确保其科学上合理、适定，并包含获得唯一解所需的所有信息。给定的参数、物理常数和数值方法在计算流体动力学领域是标准的，因此该问题是有效的。我们可以继续进行求解。\n\n任务是为一个显式求解器推导粘性时间步长约束，并将其应用于计算网格的两个不同区域。分析始于一个代表动量粘性扩散的模型偏微分方程。对于恒定的运动粘度 $\\nu$，速度分量 $\\phi$ 的动量方程粘性项可以用三维线性扩散方程来建模：\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\nu \\nabla^2 \\phi = \\nu \\left( \\frac{\\partial^2 \\phi}{\\partial n^2} + \\frac{\\partial^2 \\phi}{\\partial s^2} + \\frac{\\partial^2 \\phi}{\\partial z^2} \\right)\n$$\n此处，$(n, s, z)$ 被视为一个局部正交坐标系。\n\n问题指定了时间积分采用前向欧拉法，空间导数采用二阶中心差分。设 $\\phi_{i,j,k}^m$ 表示在网格点 $(i\\Delta n, j\\Delta s, k\\Delta z)$ 和时间层 $m \\Delta t$ 处 $\\phi$ 的值。该方程的离散形式为：\n$$\n\\frac{\\phi_{i,j,k}^{m+1} - \\phi_{i,j,k}^m}{\\Delta t} = \\nu \\left( \\frac{\\phi_{i+1,j,k}^m - 2\\phi_{i,j,k}^m + \\phi_{i-1,j,k}^m}{(\\Delta n)^2} + \\frac{\\phi_{i,j+1,k}^m - 2\\phi_{i,j,k}^m + \\phi_{i,j-1,k}^m}{(\\Delta s)^2} + \\frac{\\phi_{i,j,k+1}^m - 2\\phi_{i,j,k}^m + \\phi_{i,j,k-1}^m}{(\\Delta z)^2} \\right)\n$$\n\n为了分析该格式的稳定性，我们进行 von Neumann 稳定性分析。我们考虑数值误差的单个傅里叶模态的演化，表示为：\n$$\n\\phi_{i,j,k}^m = G^m \\exp(I(i\\theta_n + j\\theta_s + k\\theta_z))\n$$\n其中 $I = \\sqrt{-1}$，$G$ 是每个时间步的放大因子，$\\theta_n = k_n \\Delta n$, $\\theta_s = k_s \\Delta s$, $\\theta_z = k_z \\Delta z$ 是对应于波数 $k_n, k_s, k_z$ 的相角。将此代入离散方程，并除以公共的指数项，得到放大因子 $G = \\phi^{m+1}/\\phi^m$ 的表达式：\n$$\n\\frac{G - 1}{\\Delta t} = \\nu \\left( \\frac{\\exp(I\\theta_n) - 2 + \\exp(-I\\theta_n)}{(\\Delta n)^2} + \\frac{\\exp(I\\theta_s) - 2 + \\exp(-I\\theta_s)}{(\\Delta s)^2} + \\frac{\\exp(I\\theta_z) - 2 + \\exp(-I\\theta_z)}{(\\Delta z)^2} \\right)\n$$\n使用恒等式 $\\exp(I\\theta) + \\exp(-I\\theta) = 2\\cos(\\theta)$，我们简化表达式：\n$$\nG - 1 = 2\\nu \\Delta t \\left( \\frac{\\cos(\\theta_n) - 1}{(\\Delta n)^2} + \\frac{\\cos(\\theta_s) - 1}{(\\Delta s)^2} + \\frac{\\cos(\\theta_z) - 1}{(\\Delta z)^2} \\right)\n$$\n进一步使用三角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们得到：\n$$\nG = 1 - 4\\nu \\Delta t \\left( \\frac{\\sin^2(\\theta_n/2)}{(\\Delta n)^2} + \\frac{\\sin^2(\\theta_s/2)}{(\\Delta s)^2} + \\frac{\\sin^2(\\theta_z/2)}{(\\Delta z)^2} \\right)\n$$\n为使数值格式稳定，对于任何可能的傅里叶模态，放大因子的模都不能超过1，即 $|G| \\le 1$。由于 $G$ 是实数，且从1中减去的项总是非负的，因此 $G \\le 1$ 总是满足的。稳定性条件因此简化为 $G \\ge -1$：\n$$\n1 - 4\\nu \\Delta t \\left( \\frac{\\sin^2(\\theta_n/2)}{(\\Delta n)^2} + \\frac{\\sin^2(\\theta_s/2)}{(\\Delta s)^2} + \\frac{\\sin^2(\\theta_z/2)}{(\\Delta z)^2} \\right) \\ge -1\n$$\n$$\n2 \\ge 4\\nu \\Delta t \\left( \\frac{\\sin^2(\\theta_n/2)}{(\\Delta n)^2} + \\frac{\\sin^2(\\theta_s/2)}{(\\Delta s)^2} + \\frac{\\sin^2(\\theta_z/2)}{(\\Delta z)^2} \\right)\n$$\n整理以求解 $\\Delta t$：\n$$\n\\Delta t \\le \\frac{1}{2\\nu \\left( \\frac{\\sin^2(\\theta_n/2)}{(\\Delta n)^2} + \\frac{\\sin^2(\\theta_s/2)}{(\\Delta s)^2} + \\frac{\\sin^2(\\theta_z/2)}{(\\Delta z)^2} \\right)}\n$$\n这个不等式必须对所有相角 $\\theta_n, \\theta_s, \\theta_z \\in [-\\pi, \\pi]$ 都成立。对 $\\Delta t$ 最严格的条件出现在分母最大化时。这种情况发生在网格上可解析的最高频率模态下，即 $\\theta_n = \\theta_s = \\theta_z = \\pi$，此时 $\\sin^2(\\pi/2) = 1$。这导出了最终的粘性时间步长约束：\n$$\n\\Delta t_{\\mathrm{visc}} \\le \\frac{1}{2\\nu \\left( \\frac{1}{(\\Delta n)^2} + \\frac{1}{(\\Delta s)^2} + \\frac{1}{(\\Delta z)^2} \\right)}\n$$\n\n现在我们将此公式应用于给定的数据。首先，我们计算运动粘度 $\\nu$：\n$\\mu = 1.8 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}$\n$\\rho = 1.2\\ \\mathrm{kg/m^3}$\n$$\n\\nu = \\frac{\\mu}{\\rho} = \\frac{1.8 \\times 10^{-5}\\ \\mathrm{kg/(m \\cdot s)}}{1.2\\ \\mathrm{kg/m^3}} = 1.5 \\times 10^{-5}\\ \\mathrm{m^2/s}\n$$\n设求和项为 $S = \\frac{1}{(\\Delta n)^2} + \\frac{1}{(\\Delta s)^2} + \\frac{1}{(\\Delta z)^2}$。那么 $\\Delta t_{\\mathrm{visc}} = \\frac{1}{2\\nu S}$。\n\n对于壁面附近区域：\n$\\Delta n_{\\mathrm{w}} = 1.0 \\times 10^{-6}\\ \\mathrm{m}$\n$\\Delta s_{\\mathrm{w}} = 1.0 \\times 10^{-3}\\ \\mathrm{m}$\n$\\Delta z_{\\mathrm{w}} = 5.0 \\times 10^{-4}\\ \\mathrm{m}$\n$$\nS_{\\mathrm{w}} = \\frac{1}{(1.0 \\times 10^{-6})^2} + \\frac{1}{(1.0 \\times 10^{-3})^2} + \\frac{1}{(5.0 \\times 10^{-4})^2} \\\\\nS_{\\mathrm{w}} = 1.0 \\times 10^{12} + 1.0 \\times 10^{6} + 4.0 \\times 10^{6} = 1,000,005,000,000\\ \\mathrm{m^{-2}}\n$$\n$$\n\\Delta t_{\\mathrm{visc},\\mathrm{w}} = \\frac{1}{2(1.5 \\times 10^{-5}) (1.000005 \\times 10^{12})} = \\frac{1}{3.000015 \\times 10^7} \\approx 3.33 \\times 10^{-8}\\ \\mathrm{s}\n$$\n对于外层：\n$\\Delta n_{\\mathrm{o}} = 5.0 \\times 10^{-4}\\ \\mathrm{m}$\n$\\Delta s_{\\mathrm{o}} = 2.0 \\times 10^{-2}\\ \\mathrm{m}$\n$\\Delta z_{\\mathrm{o}} = 1.0 \\times 10^{-2}\\ \\mathrm{m}$\n$$\nS_{\\mathrm{o}} = \\frac{1}{(5.0 \\times 10^{-4})^2} + \\frac{1}{(2.0 \\times 10^{-2})^2} + \\frac{1}{(1.0 \\times 10^{-2})^2} \\\\\nS_{\\mathrm{o}} = 4.0 \\times 10^{6} + 2500 + 10000 = 4,012,500\\ \\mathrm{m^{-2}}\n$$\n$$\n\\Delta t_{\\mathrm{visc},\\mathrm{o}} = \\frac{1}{2(1.5 \\times 10^{-5}) (4.0125 \\times 10^{6})} = \\frac{1}{120.375} \\approx 8.307 \\times 10^{-3}\\ \\mathrm{s}\n$$\n所要求的比值 $R$ 是：\n$$\nR = \\frac{\\Delta t_{\\mathrm{visc},\\mathrm{w}}}{\\Delta t_{\\mathrm{visc},\\mathrm{o}}} = \\frac{1/(2\\nu S_{\\mathrm{w}})}{1/(2\\nu S_{\\mathrm{o}})} = \\frac{S_{\\mathrm{o}}}{S_{\\mathrm{w}}}\n$$\n$$\nR = \\frac{4,012,500}{1,000,005,000,000} = 4.01248... \\times 10^{-6}\n$$\n四舍五入到四位有效数字，我们得到 $R = 4.012 \\times 10^{-6}$。\n\n壁面附近粘性 CFL 约束严苛性的物理解释在于所推导出的 $\\Delta t_{\\mathrm{visc}}$ 公式。最大允许时间步长与网格间距平方倒数之和成反比，即 $\\Delta t_{\\mathrm{visc}} \\propto \\left(\\sum_i \\frac{1}{\\Delta x_i^2}\\right)^{-1}$。在高度各向异性的边界层网格上，为了解析薄的粘性子层，壁面法向的网格尺寸 $\\Delta n$ 被设置得极小。在本问题中，$\\Delta n_{\\mathrm{w}} = 1.0 \\times 10^{-6}\\ \\mathrm{m}$，而 $\\Delta s_{\\mathrm{w}}$ 和 $\\Delta z_{\\mathrm{w}}$ 要大几个数量级。$\\frac{1}{(\\Delta n_{\\mathrm{w}})^2} = 10^{12}\\ \\mathrm{m^{-2}}$ 这一项比求和中的其他项（$\\frac{1}{(\\Delta s_{\\mathrm{w}})^2} = 10^6\\ \\mathrm{m^{-2}}$ 和 $\\frac{1}{(\\Delta z_{\\mathrm{w}})^2} = 4 \\times 10^6\\ \\mathrm{m^{-2}}$）大六个数量级。因此，该求和完全由最小的网格间距主导，该约束近似为：\n$$\n\\Delta t_{\\mathrm{visc}} \\approx \\frac{(\\Delta n_{\\mathrm{min}})^2}{2\\nu}\n$$\n对网格间距的平方依赖关系意味着，将网格间距减半会使最大稳定时间步长减小为原来的四分之一。对于壁面解析所需的极小 $\\Delta n$ 来说，这会导致一个严苛得令人望而却步的小时间步长。从物理上讲，稳定性要求时间步长足够小，以便能够解析信息在最小网格单元上的扩散过程。由于扩散时间尺度与长度的平方成正比，极小的 $\\Delta n$ 施加了严格的时间约束，使得显式格式对于壁面解析模拟来说计算成本非常高昂。",
            "answer": "$$\n\\boxed{4.012 \\times 10^{-6}}\n$$"
        }
    ]
}